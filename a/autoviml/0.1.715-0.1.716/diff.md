# Comparing `tmp/autoviml-0.1.715.tar.gz` & `tmp/autoviml-0.1.716.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "autoviml-0.1.715.tar", last modified: Wed May 17 13:03:35 2023, max compression
+gzip compressed data, was "autoviml-0.1.716.tar", last modified: Sun May 21 22:48:37 2023, max compression
```

## Comparing `autoviml-0.1.715.tar` & `autoviml-0.1.716.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
-00000210: 3631 352e 3839 3532 3238 390a 0000 0000  615.8952289.....
+00000200: 3238 206d 7469 6d65 3d31 3638 3437 3039  28 mtime=1684709
+00000210: 3331 372e 3332 3536 3532 340a 0000 0000  317.3256524.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00000410: 2f00 0000 0000 0000 0000 0000 0000 0000  /...............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00000490: 3030 3000 3031 3331 3132 0020 3500 0000  000.013112. 5...
+00000490: 3030 3000 3031 3331 3133 0020 3500 0000  000.013113. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -98,16 +98,16 @@
 00000610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00000690: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00000680: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00000690: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
 000006a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
-00000810: 3631 352e 3839 3532 3238 390a 0000 0000  615.8952289.....
+00000800: 3237 206d 7469 6d65 3d31 3638 3437 3039  27 mtime=1684709
+00000810: 3331 372e 3334 3132 3737 0a00 0000 0000  317.341277......
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -154,24 +154,24 @@
 00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00000a10: 2f50 4b47 2d49 4e46 4f00 0000 0000 0000  /PKG-INFO.......
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000a80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
-00000a90: 3030 3000 3031 3432 3234 0020 3000 0000  000.014224. 0...
+00000a90: 3030 3000 3031 3432 3235 0020 3000 0000  000.014225. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -189,15 +189,15 @@
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000c10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
 00000c20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00000c30: 312e 3731 350a 5375 6d6d 6172 793a 2041  1.715.Summary: A
+00000c30: 312e 3731 360a 5375 6d6d 6172 793a 2041  1.716.Summary: A
 00000c40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
 00000c50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
 00000c60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
 00000c70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
 00000c80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
 00000c90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 00000ca0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
@@ -1210,24 +1210,24 @@
 00004b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00004c10: 2f52 4541 444d 452e 6d64 0000 0000 0000  /README.md......
 00004c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00004c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00004c80: 3030 3331 3535 3600 3030 3030 3030 3030  0031556.00000000
-00004c90: 3030 3000 3031 3434 3036 0020 3000 0000  000.014406. 0...
+00004c90: 3030 3000 3031 3434 3037 0020 3000 0000  000.014407. 0...
 00004ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -2082,16 +2082,16 @@
 00008210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00008270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00008280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00008290: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
+00008280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00008290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000082a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -2106,16 +2106,16 @@
 00008390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008400: 3237 206d 7469 6d65 3d31 3638 3433 3238  27 mtime=1684328
-00008410: 3631 352e 3732 3539 3638 0a00 0000 0000  615.725968......
+00008400: 3238 206d 7469 6d65 3d31 3638 3437 3039  28 mtime=1684709
+00008410: 3331 372e 3230 3036 3534 350a 0000 0000  317.2006545.....
 00008420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2138,24 +2138,24 @@
 00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00008610: 2f61 7574 6f76 696d 6c2f 0000 0000 0000  /autoviml/......
 00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008680: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00008690: 3030 3000 3031 3437 3532 0020 3500 0000  000.014752. 5...
+00008690: 3030 3000 3031 3437 3533 0020 3500 0000  000.014753. 5...
 000086a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -2234,24 +2234,24 @@
 00008b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00008c10: 2f61 7574 6f76 696d 6c2f 4175 746f 5f4e  /autoviml/Auto_N
 00008c20: 4c50 2e70 7900 0000 0000 0000 0000 0000  LP.py...........
 00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008c80: 3033 3232 3137 3200 3030 3030 3030 3030  0322172.00000000
-00008c90: 3030 3000 3031 3637 3537 0020 3000 0000  000.016757. 0...
+00008c90: 3030 3000 3031 3637 3630 0020 3000 0000  000.016760. 0...
 00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -9050,16 +9050,16 @@
 00023590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023600: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00023610: 3334 382e 300a 0000 0000 0000 0000 0000  348.0...........
+00023600: 3232 206d 7469 6d65 3d31 3638 3437 3036  22 mtime=1684706
+00023610: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
 00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9082,24 +9082,24 @@
 00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00023810: 2f61 7574 6f76 696d 6c2f 4175 746f 5f56  /autoviml/Auto_V
 00023820: 694d 4c2e 7079 0000 0000 0000 0000 0000  iML.py..........
 00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00023870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00023880: 3132 3234 3431 3600 3030 3030 3030 3030  1224416.00000000
-00023890: 3030 3000 3031 3731 3430 0020 3000 0000  000.017140. 0...
+00023880: 3132 3237 3136 3300 3030 3030 3030 3030  1227163.00000000
+00023890: 3030 3000 3031 3731 3433 0020 3000 0000  000.017143. 0...
 000238a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -15094,22536 +15094,22536 @@
 0003af50: 6573 7469 6d61 746f 725f 7374 7269 6e67  estimator_string
 0003af60: 203d 2027 6573 7469 6d61 746f 725f 5f27   = 'estimator__'
 0003af70: 0d0a 2020 2020 6966 2068 7970 6572 5f70  ..    if hyper_p
 0003af80: 6172 616d 2069 7320 6e6f 7420 4e6f 6e65  aram is not None
 0003af90: 3a0d 0a20 2020 2020 2020 2069 6620 6879  :..        if hy
 0003afa0: 7065 725f 7061 7261 6d2e 6c6f 7765 7228  per_param.lower(
 0003afb0: 2920 3d3d 2027 6368 6169 6e27 3a0d 0a20  ) == 'chain':.. 
-0003afc0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0003afd0: 6174 6f72 5f73 7472 696e 6720 3d20 2762  ator_string = 'b
-0003afe0: 6173 655f 6573 7469 6d61 746f 725f 5f27  ase_estimator__'
-0003aff0: 0d0a 2020 2020 2323 2320 2020 5365 7474  ..    ###   Sett
-0003b000: 696e 6720 7570 2074 6865 2045 7374 696d  ing up the Estim
-0003b010: 6174 6f72 7320 666f 7220 5369 6e67 6c65  ators for Single
-0003b020: 204c 6162 656c 2061 6e64 204d 756c 7469   Label and Multi
-0003b030: 204c 6162 656c 2074 6172 6765 7473 206f   Label targets o
-0003b040: 6e6c 790d 0a20 2020 2069 6620 6d6f 6465  nly..    if mode
-0003b050: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-0003b060: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0003b070: 6d65 7472 6963 735f 6c69 7374 203d 205b  metrics_list = [
-0003b080: 276e 6567 5f6d 6561 6e5f 6162 736f 6c75  'neg_mean_absolu
-0003b090: 7465 5f65 7272 6f72 2720 2c27 6e65 675f  te_error' ,'neg_
-0003b0a0: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-0003b0b0: 6f72 272c 0d0a 2020 2020 2020 2020 2027  or',..         '
-0003b0c0: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
-0003b0d0: 5f6c 6f67 5f65 7272 6f72 272c 276e 6567  _log_error','neg
-0003b0e0: 5f6d 6564 6961 6e5f 6162 736f 6c75 7465  _median_absolute
-0003b0f0: 5f65 7272 6f72 275d 0d0a 2020 2020 2020  _error']..      
-0003b100: 2020 6576 616c 5f6d 6574 7269 6320 3d20    eval_metric = 
-0003b110: 2272 6d73 6522 0d0a 2020 2020 2020 2020  "rmse"..        
-0003b120: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
-0003b130: 6574 6572 203d 3d20 276e 6567 5f6d 6561  eter == 'neg_mea
-0003b140: 6e5f 6162 736f 6c75 7465 5f65 7272 6f72  n_absolute_error
-0003b150: 2720 6f72 2073 636f 7269 6e67 5f70 6172  ' or scoring_par
-0003b160: 616d 6574 6572 203d 3d27 6d61 6527 3a0d  ameter =='mae':.
-0003b170: 0a20 2020 2020 2020 2020 2020 206d 6561  .            mea
-0003b180: 655f 7363 6f72 6572 203d 206d 616b 655f  e_scorer = make_
-0003b190: 7363 6f72 6572 2867 696e 695f 6d65 6165  scorer(gini_meae
-0003b1a0: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
-0003b1b0: 7465 723d 4661 6c73 6529 0d0a 2020 2020  ter=False)..    
-0003b1c0: 2020 2020 2020 2020 7363 6f72 6572 203d          scorer =
-0003b1d0: 206d 6561 655f 7363 6f72 6572 0d0a 2020   meae_scorer..  
-0003b1e0: 2020 2020 2020 656c 6966 2073 636f 7269        elif scori
-0003b1f0: 6e67 5f70 6172 616d 6574 6572 203d 3d20  ng_parameter == 
-0003b200: 276e 6567 5f6d 6561 6e5f 7371 7561 7265  'neg_mean_square
-0003b210: 645f 6572 726f 7227 206f 7220 7363 6f72  d_error' or scor
-0003b220: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-0003b230: 276d 7365 273a 0d0a 2020 2020 2020 2020  'mse':..        
-0003b240: 2020 2020 6d73 655f 7363 6f72 6572 203d      mse_scorer =
-0003b250: 206d 616b 655f 7363 6f72 6572 2867 696e   make_scorer(gin
-0003b260: 695f 6d73 652c 2067 7265 6174 6572 5f69  i_mse, greater_i
-0003b270: 735f 6265 7474 6572 3d46 616c 7365 290d  s_better=False).
-0003b280: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-0003b290: 7265 7220 3d20 6d73 655f 7363 6f72 6572  rer = mse_scorer
-0003b2a0: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
-0003b2b0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003b2c0: 203d 3d20 276e 6567 5f6d 6561 6e5f 7371   == 'neg_mean_sq
-0003b2d0: 7561 7265 645f 6c6f 675f 6572 726f 7227  uared_log_error'
-0003b2e0: 206f 7220 7363 6f72 696e 675f 7061 7261   or scoring_para
-0003b2f0: 6d65 7465 7220 3d3d 2027 6c6f 675f 6572  meter == 'log_er
-0003b300: 726f 7227 3a0d 0a20 2020 2020 2020 2020  ror':..         
-0003b310: 2020 206d 736c 655f 7363 6f72 6572 203d     msle_scorer =
-0003b320: 206d 616b 655f 7363 6f72 6572 2867 696e   make_scorer(gin
-0003b330: 695f 6d73 6c65 2c20 6772 6561 7465 725f  i_msle, greater_
-0003b340: 6973 5f62 6574 7465 723d 4661 6c73 6529  is_better=False)
-0003b350: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0003b360: 696e 7428 2720 2020 204c 6f67 2045 7272  int('    Log Err
-0003b370: 6f72 2069 7320 6e6f 7420 7265 636f 6d6d  or is not recomm
-0003b380: 656e 6465 6420 7369 6e63 6520 7072 6564  ended since pred
-0003b390: 6963 7465 6420 7661 6c75 6573 206d 6967  icted values mig
-0003b3a0: 6874 2062 6520 6e65 6761 7469 7665 2061  ht be negative a
-0003b3b0: 6e64 2065 7272 6f72 2729 0d0a 2020 2020  nd error')..    
-0003b3c0: 2020 2020 2020 2020 726d 7365 5f73 636f          rmse_sco
-0003b3d0: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
-0003b3e0: 7228 6769 6e69 5f72 6d73 652c 2067 7265  r(gini_rmse, gre
-0003b3f0: 6174 6572 5f69 735f 6265 7474 6572 3d46  ater_is_better=F
-0003b400: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-0003b410: 2020 2073 636f 7265 7220 3d20 726d 7365     scorer = rmse
-0003b420: 5f73 636f 7265 720d 0a20 2020 2020 2020  _scorer..       
-0003b430: 2065 6c69 6620 7363 6f72 696e 675f 7061   elif scoring_pa
-0003b440: 7261 6d65 7465 7220 3d3d 2027 6e65 675f  rameter == 'neg_
-0003b450: 6d65 6469 616e 5f61 6273 6f6c 7574 655f  median_absolute_
-0003b460: 6572 726f 7227 206f 7220 7363 6f72 696e  error' or scorin
-0003b470: 675f 7061 7261 6d65 7465 7220 3d3d 2027  g_parameter == '
-0003b480: 6d65 6469 616e 5f65 7272 6f72 273a 0d0a  median_error':..
-0003b490: 2020 2020 2020 2020 2020 2020 6d61 655f              mae_
-0003b4a0: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
-0003b4b0: 6f72 6572 2867 696e 695f 6d61 652c 2067  orer(gini_mae, g
-0003b4c0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-0003b4d0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-0003b4e0: 2020 2020 2073 636f 7265 7220 3d20 6d61       scorer = ma
-0003b4f0: 655f 7363 6f72 6572 0d0a 2020 2020 2020  e_scorer..      
-0003b500: 2020 656c 6966 2073 636f 7269 6e67 5f70    elif scoring_p
-0003b510: 6172 616d 6574 6572 203d 3d27 726d 7365  arameter =='rmse
-0003b520: 2720 6f72 2073 636f 7269 6e67 5f70 6172  ' or scoring_par
-0003b530: 616d 6574 6572 203d 3d20 2772 6f6f 745f  ameter == 'root_
-0003b540: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-0003b550: 6f72 273a 0d0a 2020 2020 2020 2020 2020  or':..          
-0003b560: 2020 726d 7365 5f73 636f 7265 7220 3d20    rmse_scorer = 
-0003b570: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-0003b580: 5f72 6d73 652c 2067 7265 6174 6572 5f69  _rmse, greater_i
-0003b590: 735f 6265 7474 6572 3d46 616c 7365 290d  s_better=False).
-0003b5a0: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-0003b5b0: 7265 7220 3d20 726d 7365 5f73 636f 7265  rer = rmse_score
-0003b5c0: 720d 0a20 2020 2020 2020 2065 6c73 653a  r..        else:
-0003b5d0: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
-0003b5e0: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
-0003b5f0: 3d20 2772 6d73 6527 0d0a 2020 2020 2020  = 'rmse'..      
-0003b600: 2020 2020 2020 726d 7365 5f73 636f 7265        rmse_score
-0003b610: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-0003b620: 6769 6e69 5f72 6d73 652c 2067 7265 6174  gini_rmse, great
-0003b630: 6572 5f69 735f 6265 7474 6572 3d46 616c  er_is_better=Fal
-0003b640: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-0003b650: 2073 636f 7265 7220 3d20 726d 7365 5f73   scorer = rmse_s
-0003b660: 636f 7265 720d 0a20 2020 2020 2020 2023  corer..        #
-0003b670: 2323 2320 2020 2020 2048 5950 4552 2050  ###      HYPER P
-0003b680: 4152 414d 4554 4552 5320 464f 5220 5245  ARAMETERS FOR RE
-0003b690: 4752 4553 5349 4f4e 2054 554e 494e 4720  GRESSION TUNING 
-0003b6a0: 4152 4520 5345 5455 5020 4845 5245 2020  ARE SETUP HERE  
-0003b6b0: 2020 2020 2323 230d 0a20 2020 2020 2020      ###..       
-0003b6c0: 2069 6620 6879 7065 725f 7061 7261 6d20   if hyper_param 
-0003b6d0: 3d3d 2027 4753 273a 0d0a 2020 2020 2020  == 'GS':..      
-0003b6e0: 2020 2020 2020 725f 7061 7261 6d73 203d        r_params =
-0003b6f0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-0003b700: 2020 2020 2020 2020 2246 6f72 6573 7473          "Forests
-0003b710: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
-0003b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b730: 2020 226e 5f65 7374 696d 6174 6f72 7322    "n_estimators"
-0003b740: 203a 206e 702e 6c69 6e73 7061 6365 2831   : np.linspace(1
-0003b750: 3030 2c20 6d61 785f 6573 7469 6d73 2c20  00, max_estims, 
-0003b760: 6e5f 7374 6570 732c 2064 7479 7065 203d  n_steps, dtype =
-0003b770: 2022 696e 7422 292c 0d0a 2020 2020 2020   "int"),..      
+0003afc0: 2020 2020 2020 2020 2020 2023 2323 2044             ### D
+0003afd0: 6f6e 2774 2063 6861 6e67 6520 7468 6973  on't change this
+0003afe0: 2120 5468 616e 6b73 6675 6c6c 7920 696e  ! Thanksfully in
+0003aff0: 2070 7265 7620 616e 6420 6e65 7720 7665   prev and new ve
+0003b000: 7273 696f 6e73 206f 6620 736b 6c65 6172  rsions of sklear
+0003b010: 6e2c 2069 7473 2720 7468 6520 7361 6d65  n, its' the same
+0003b020: 210d 0a20 2020 2020 2020 2020 2020 2065  !..            e
+0003b030: 7374 696d 6174 6f72 5f73 7472 696e 6720  stimator_string 
+0003b040: 3d20 2762 6173 655f 6573 7469 6d61 746f  = 'base_estimato
+0003b050: 725f 5f27 0d0a 2020 2020 2323 2320 2020  r__'..    ###   
+0003b060: 5365 7474 696e 6720 7570 2074 6865 2045  Setting up the E
+0003b070: 7374 696d 6174 6f72 7320 666f 7220 5369  stimators for Si
+0003b080: 6e67 6c65 204c 6162 656c 2061 6e64 204d  ngle Label and M
+0003b090: 756c 7469 204c 6162 656c 2074 6172 6765  ulti Label targe
+0003b0a0: 7473 206f 6e6c 790d 0a20 2020 2069 6620  ts only..    if 
+0003b0b0: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+0003b0c0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+0003b0d0: 2020 2020 6d65 7472 6963 735f 6c69 7374      metrics_list
+0003b0e0: 203d 205b 276e 6567 5f6d 6561 6e5f 6162   = ['neg_mean_ab
+0003b0f0: 736f 6c75 7465 5f65 7272 6f72 2720 2c27  solute_error' ,'
+0003b100: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
+0003b110: 5f65 7272 6f72 272c 0d0a 2020 2020 2020  _error',..      
+0003b120: 2020 2027 6e65 675f 6d65 616e 5f73 7175     'neg_mean_squ
+0003b130: 6172 6564 5f6c 6f67 5f65 7272 6f72 272c  ared_log_error',
+0003b140: 276e 6567 5f6d 6564 6961 6e5f 6162 736f  'neg_median_abso
+0003b150: 6c75 7465 5f65 7272 6f72 275d 0d0a 2020  lute_error']..  
+0003b160: 2020 2020 2020 6576 616c 5f6d 6574 7269        eval_metri
+0003b170: 6320 3d20 2272 6d73 6522 0d0a 2020 2020  c = "rmse"..    
+0003b180: 2020 2020 6966 2073 636f 7269 6e67 5f70      if scoring_p
+0003b190: 6172 616d 6574 6572 203d 3d20 276e 6567  arameter == 'neg
+0003b1a0: 5f6d 6561 6e5f 6162 736f 6c75 7465 5f65  _mean_absolute_e
+0003b1b0: 7272 6f72 2720 6f72 2073 636f 7269 6e67  rror' or scoring
+0003b1c0: 5f70 6172 616d 6574 6572 203d 3d27 6d61  _parameter =='ma
+0003b1d0: 6527 3a0d 0a20 2020 2020 2020 2020 2020  e':..           
+0003b1e0: 206d 6561 655f 7363 6f72 6572 203d 206d   meae_scorer = m
+0003b1f0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+0003b200: 6d65 6165 2c20 6772 6561 7465 725f 6973  meae, greater_is
+0003b210: 5f62 6574 7465 723d 4661 6c73 6529 0d0a  _better=False)..
+0003b220: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+0003b230: 6572 203d 206d 6561 655f 7363 6f72 6572  er = meae_scorer
+0003b240: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
+0003b250: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+0003b260: 203d 3d20 276e 6567 5f6d 6561 6e5f 7371   == 'neg_mean_sq
+0003b270: 7561 7265 645f 6572 726f 7227 206f 7220  uared_error' or 
+0003b280: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+0003b290: 7220 3d3d 276d 7365 273a 0d0a 2020 2020  r =='mse':..    
+0003b2a0: 2020 2020 2020 2020 6d73 655f 7363 6f72          mse_scor
+0003b2b0: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+0003b2c0: 2867 696e 695f 6d73 652c 2067 7265 6174  (gini_mse, great
+0003b2d0: 6572 5f69 735f 6265 7474 6572 3d46 616c  er_is_better=Fal
+0003b2e0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+0003b2f0: 2073 636f 7265 7220 3d20 6d73 655f 7363   scorer = mse_sc
+0003b300: 6f72 6572 0d0a 2020 2020 2020 2020 656c  orer..        el
+0003b310: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+0003b320: 6574 6572 203d 3d20 276e 6567 5f6d 6561  eter == 'neg_mea
+0003b330: 6e5f 7371 7561 7265 645f 6c6f 675f 6572  n_squared_log_er
+0003b340: 726f 7227 206f 7220 7363 6f72 696e 675f  ror' or scoring_
+0003b350: 7061 7261 6d65 7465 7220 3d3d 2027 6c6f  parameter == 'lo
+0003b360: 675f 6572 726f 7227 3a0d 0a20 2020 2020  g_error':..     
+0003b370: 2020 2020 2020 206d 736c 655f 7363 6f72         msle_scor
+0003b380: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+0003b390: 2867 696e 695f 6d73 6c65 2c20 6772 6561  (gini_msle, grea
+0003b3a0: 7465 725f 6973 5f62 6574 7465 723d 4661  ter_is_better=Fa
+0003b3b0: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
+0003b3c0: 2020 7072 696e 7428 2720 2020 204c 6f67    print('    Log
+0003b3d0: 2045 7272 6f72 2069 7320 6e6f 7420 7265   Error is not re
+0003b3e0: 636f 6d6d 656e 6465 6420 7369 6e63 6520  commended since 
+0003b3f0: 7072 6564 6963 7465 6420 7661 6c75 6573  predicted values
+0003b400: 206d 6967 6874 2062 6520 6e65 6761 7469   might be negati
+0003b410: 7665 2061 6e64 2065 7272 6f72 2729 0d0a  ve and error')..
+0003b420: 2020 2020 2020 2020 2020 2020 726d 7365              rmse
+0003b430: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+0003b440: 636f 7265 7228 6769 6e69 5f72 6d73 652c  corer(gini_rmse,
+0003b450: 2067 7265 6174 6572 5f69 735f 6265 7474   greater_is_bett
+0003b460: 6572 3d46 616c 7365 290d 0a20 2020 2020  er=False)..     
+0003b470: 2020 2020 2020 2073 636f 7265 7220 3d20         scorer = 
+0003b480: 726d 7365 5f73 636f 7265 720d 0a20 2020  rmse_scorer..   
+0003b490: 2020 2020 2065 6c69 6620 7363 6f72 696e       elif scorin
+0003b4a0: 675f 7061 7261 6d65 7465 7220 3d3d 2027  g_parameter == '
+0003b4b0: 6e65 675f 6d65 6469 616e 5f61 6273 6f6c  neg_median_absol
+0003b4c0: 7574 655f 6572 726f 7227 206f 7220 7363  ute_error' or sc
+0003b4d0: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
+0003b4e0: 3d3d 2027 6d65 6469 616e 5f65 7272 6f72  == 'median_error
+0003b4f0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0003b500: 6d61 655f 7363 6f72 6572 203d 206d 616b  mae_scorer = mak
+0003b510: 655f 7363 6f72 6572 2867 696e 695f 6d61  e_scorer(gini_ma
+0003b520: 652c 2067 7265 6174 6572 5f69 735f 6265  e, greater_is_be
+0003b530: 7474 6572 3d46 616c 7365 290d 0a20 2020  tter=False)..   
+0003b540: 2020 2020 2020 2020 2073 636f 7265 7220           scorer 
+0003b550: 3d20 6d61 655f 7363 6f72 6572 0d0a 2020  = mae_scorer..  
+0003b560: 2020 2020 2020 656c 6966 2073 636f 7269        elif scori
+0003b570: 6e67 5f70 6172 616d 6574 6572 203d 3d27  ng_parameter =='
+0003b580: 726d 7365 2720 6f72 2073 636f 7269 6e67  rmse' or scoring
+0003b590: 5f70 6172 616d 6574 6572 203d 3d20 2772  _parameter == 'r
+0003b5a0: 6f6f 745f 6d65 616e 5f73 7175 6172 6564  oot_mean_squared
+0003b5b0: 5f65 7272 6f72 273a 0d0a 2020 2020 2020  _error':..      
+0003b5c0: 2020 2020 2020 726d 7365 5f73 636f 7265        rmse_score
+0003b5d0: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
+0003b5e0: 6769 6e69 5f72 6d73 652c 2067 7265 6174  gini_rmse, great
+0003b5f0: 6572 5f69 735f 6265 7474 6572 3d46 616c  er_is_better=Fal
+0003b600: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+0003b610: 2073 636f 7265 7220 3d20 726d 7365 5f73   scorer = rmse_s
+0003b620: 636f 7265 720d 0a20 2020 2020 2020 2065  corer..        e
+0003b630: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003b640: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+0003b650: 7465 7220 3d20 2772 6d73 6527 0d0a 2020  ter = 'rmse'..  
+0003b660: 2020 2020 2020 2020 2020 726d 7365 5f73            rmse_s
+0003b670: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+0003b680: 7265 7228 6769 6e69 5f72 6d73 652c 2067  rer(gini_rmse, g
+0003b690: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+0003b6a0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+0003b6b0: 2020 2020 2073 636f 7265 7220 3d20 726d       scorer = rm
+0003b6c0: 7365 5f73 636f 7265 720d 0a20 2020 2020  se_scorer..     
+0003b6d0: 2020 2023 2323 2320 2020 2020 2048 5950     ####      HYP
+0003b6e0: 4552 2050 4152 414d 4554 4552 5320 464f  ER PARAMETERS FO
+0003b6f0: 5220 5245 4752 4553 5349 4f4e 2054 554e  R REGRESSION TUN
+0003b700: 494e 4720 4152 4520 5345 5455 5020 4845  ING ARE SETUP HE
+0003b710: 5245 2020 2020 2020 2323 230d 0a20 2020  RE      ###..   
+0003b720: 2020 2020 2069 6620 6879 7065 725f 7061       if hyper_pa
+0003b730: 7261 6d20 3d3d 2027 4753 273a 0d0a 2020  ram == 'GS':..  
+0003b740: 2020 2020 2020 2020 2020 725f 7061 7261            r_para
+0003b750: 6d73 203d 207b 0d0a 2020 2020 2020 2020  ms = {..        
+0003b760: 2020 2020 2020 2020 2020 2020 2246 6f72              "For
+0003b770: 6573 7473 223a 207b 0d0a 2020 2020 2020  ests": {..      
 0003b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b790: 2020 2020 2020 226d 6178 5f64 6570 7468        "max_depth
-0003b7a0: 223a 205b 332c 2035 2c20 6d61 785f 6465  ": [3, 5, max_de
-0003b7b0: 7074 685d 2c0d 0a20 2020 2020 2020 2020  pth],..         
-0003b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b7d0: 2020 2023 2263 7269 7465 7269 6f6e 2220     #"criterion" 
-0003b7e0: 3a20 5b27 6d73 6527 2c27 6d61 6527 5d2c  : ['mse','mae'],
-0003b7f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b800: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0003b810: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b820: 2020 2020 2020 224c 696e 6561 7222 3a20        "Linear": 
-0003b830: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-0003b840: 2020 2020 2020 2020 2020 2023 2761 6c70             #'alp
-0003b850: 6861 273a 206e 702e 6c6f 6773 7061 6365  ha': np.logspace
-0003b860: 282d 352c 3329 2c0d 0a20 2020 2020 2020  (-5,3),..       
-0003b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b880: 2027 6570 7369 6c6f 6e27 3a20 5b30 2c20   'epsilon': [0, 
-0003b890: 302e 3031 2c20 302e 3036 2c20 302e 312c  0.01, 0.06, 0.1,
-0003b8a0: 2030 2e33 2c20 302e 352c 2030 2e38 5d2c   0.3, 0.5, 0.8],
-0003b8b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b8c0: 2020 2020 2020 2020 2020 2743 273a 205b            'C': [
-0003b8d0: 302e 3031 2c20 302e 312c 312c 312e 352c  0.01, 0.1,1,1.5,
-0003b8e0: 2031 302c 3130 305d 0d0a 2020 2020 2020   10,100]..      
-0003b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b900: 2020 2020 2020 7d2c 0d0a 2020 2020 2020        },..      
-0003b910: 2020 2020 2020 2020 2020 2020 2020 2258                "X
-0003b920: 4742 6f6f 7374 223a 207b 0d0a 2020 2020  GBoost": {..    
-0003b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b950: 276c 6561 726e 696e 675f 7261 7465 273a  'learning_rate':
-0003b960: 205b 302e 312c 302e 332c 302e 355d 2c0d   [0.1,0.3,0.5],.
-0003b970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b990: 2020 2020 2027 6761 6d6d 6127 3a20 6e70       'gamma': np
-0003b9a0: 2e6c 696e 7370 6163 6528 302c 2033 322c  .linspace(0, 32,
-0003b9b0: 3729 2e61 7374 7970 6528 696e 7429 2c0d  7).astype(int),.
-0003b9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b9e0: 2020 2020 2022 6d61 785f 6465 7074 6822       "max_depth"
-0003b9f0: 3a20 5b33 2c20 352c 206d 6178 5f64 6570  : [3, 5, max_dep
-0003ba00: 7468 5d2c 0d0a 2020 2020 2020 2020 2020  th],..          
-0003ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ba20: 2020 7d2c 0d0a 2020 2020 2020 2020 2020    },..          
-0003ba30: 2020 2020 2020 2020 2020 2243 6174 426f            "CatBo
-0003ba40: 6f73 7422 3a20 7b0d 0a20 2020 2020 2020  ost": {..       
-0003ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ba60: 2020 2020 2027 6c65 6172 6e69 6e67 5f72       'learning_r
-0003ba70: 6174 6527 3a20 6e70 2e6c 6f67 7370 6163  ate': np.logspac
-0003ba80: 6528 416c 7068 615f 6d69 6e2c 416c 7068  e(Alpha_min,Alph
-0003ba90: 615f 6d61 782c 3430 292c 0d0a 2020 2020  a_max,40),..    
-0003baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bab0: 2020 2020 2020 2020 7d2c 0d0a 2020 2020          },..    
-0003bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bad0: 224d 756c 7469 5f4c 6162 656c 223a 207b  "Multi_Label": {
-0003bae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003baf0: 2020 2020 2020 2020 2020 2020 2020 224c                "L
-0003bb00: 696e 6561 7222 3a20 7b0d 0a20 2020 2020  inear": {..     
-0003bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb20: 2020 2020 2020 2023 6573 7469 6d61 746f         #estimato
-0003bb30: 725f 7374 7269 6e67 2b27 4327 3a20 5b31  r_string+'C': [1
-0003bb40: 652d 332c 2031 652d 322c 2031 652d 312c  e-3, 1e-2, 1e-1,
-0003bb50: 2031 6530 2c20 3165 312c 2031 6532 2c20   1e0, 1e1, 1e2, 
-0003bb60: 3165 335d 0d0a 2020 2020 2020 2020 2020  1e3]..          
+0003b790: 2020 2020 2020 226e 5f65 7374 696d 6174        "n_estimat
+0003b7a0: 6f72 7322 203a 206e 702e 6c69 6e73 7061  ors" : np.linspa
+0003b7b0: 6365 2831 3030 2c20 6d61 785f 6573 7469  ce(100, max_esti
+0003b7c0: 6d73 2c20 6e5f 7374 6570 732c 2064 7479  ms, n_steps, dty
+0003b7d0: 7065 203d 2022 696e 7422 292c 0d0a 2020  pe = "int"),..  
+0003b7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b7f0: 2020 2020 2020 2020 2020 226d 6178 5f64            "max_d
+0003b800: 6570 7468 223a 205b 332c 2035 2c20 6d61  epth": [3, 5, ma
+0003b810: 785f 6465 7074 685d 2c0d 0a20 2020 2020  x_depth],..     
+0003b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b830: 2020 2020 2020 2023 2263 7269 7465 7269         #"criteri
+0003b840: 6f6e 2220 3a20 5b27 6d73 6527 2c27 6d61  on" : ['mse','ma
+0003b850: 6527 5d2c 0d0a 2020 2020 2020 2020 2020  e'],..          
+0003b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b870: 2020 7d2c 0d0a 2020 2020 2020 2020 2020    },..          
+0003b880: 2020 2020 2020 2020 2020 224c 696e 6561            "Linea
+0003b890: 7222 3a20 7b0d 0a20 2020 2020 2020 2020  r": {..         
+0003b8a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003b8b0: 2761 6c70 6861 273a 206e 702e 6c6f 6773  'alpha': np.logs
+0003b8c0: 7061 6365 282d 352c 3329 2c0d 0a20 2020  pace(-5,3),..   
+0003b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b8e0: 2020 2020 2027 6570 7369 6c6f 6e27 3a20       'epsilon': 
+0003b8f0: 5b30 2c20 302e 3031 2c20 302e 3036 2c20  [0, 0.01, 0.06, 
+0003b900: 302e 312c 2030 2e33 2c20 302e 352c 2030  0.1, 0.3, 0.5, 0
+0003b910: 2e38 5d2c 0d0a 2020 2020 2020 2020 2020  .8],..          
+0003b920: 2020 2020 2020 2020 2020 2020 2020 2743                'C
+0003b930: 273a 205b 302e 3031 2c20 302e 312c 312c  ': [0.01, 0.1,1,
+0003b940: 312e 352c 2031 302c 3130 305d 0d0a 2020  1.5, 10,100]..  
+0003b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b960: 2020 2020 2020 2020 2020 7d2c 0d0a 2020            },..  
+0003b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b980: 2020 2258 4742 6f6f 7374 223a 207b 0d0a    "XGBoost": {..
+0003b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b9b0: 2020 2020 276c 6561 726e 696e 675f 7261      'learning_ra
+0003b9c0: 7465 273a 205b 302e 312c 302e 332c 302e  te': [0.1,0.3,0.
+0003b9d0: 355d 2c0d 0a20 2020 2020 2020 2020 2020  5],..           
+0003b9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b9f0: 2020 2020 2020 2020 2027 6761 6d6d 6127           'gamma'
+0003ba00: 3a20 6e70 2e6c 696e 7370 6163 6528 302c  : np.linspace(0,
+0003ba10: 2033 322c 3729 2e61 7374 7970 6528 696e   32,7).astype(in
+0003ba20: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
+0003ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ba40: 2020 2020 2020 2020 2022 6d61 785f 6465           "max_de
+0003ba50: 7074 6822 3a20 5b33 2c20 352c 206d 6178  pth": [3, 5, max
+0003ba60: 5f64 6570 7468 5d2c 0d0a 2020 2020 2020  _depth],..      
+0003ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ba80: 2020 2020 2020 7d2c 0d0a 2020 2020 2020        },..      
+0003ba90: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+0003baa0: 6174 426f 6f73 7422 3a20 7b0d 0a20 2020  atBoost": {..   
+0003bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bac0: 2020 2020 2020 2020 2027 6c65 6172 6e69           'learni
+0003bad0: 6e67 5f72 6174 6527 3a20 6e70 2e6c 6f67  ng_rate': np.log
+0003bae0: 7370 6163 6528 416c 7068 615f 6d69 6e2c  space(Alpha_min,
+0003baf0: 416c 7068 615f 6d61 782c 3430 292c 0d0a  Alpha_max,40),..
+0003bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bb10: 2020 2020 2020 2020 2020 2020 7d2c 0d0a              },..
+0003bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bb30: 2020 2020 224d 756c 7469 5f4c 6162 656c      "Multi_Label
+0003bb40: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
+0003bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bb60: 2020 224c 696e 6561 7222 3a20 7b0d 0a20    "Linear": {.. 
 0003bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb80: 2020 6573 7469 6d61 746f 725f 7374 7269    estimator_stri
-0003bb90: 6e67 2b27 6e5f 6e65 6967 6862 6f72 7327  ng+'n_neighbors'
-0003bba0: 3a20 5b31 2c33 2c35 2c37 2c31 315d 0d0a  : [1,3,5,7,11]..
-0003bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bbd0: 2020 2020 7d2c 0d0a 2020 2020 2020 2020      },..        
-0003bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bbf0: 2020 2020 2246 6f72 6573 7473 223a 207b      "Forests": {
-0003bc00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003bc10: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0003bc20: 2323 204e 6f20 6573 7469 6d61 746f 7220  ## No estimator 
-0003bc30: 7374 7269 6e67 2066 6f72 2052 616e 646f  string for Rando
-0003bc40: 6d20 466f 7265 7374 7320 7369 6e63 6520  m Forests since 
-0003bc50: 6974 2069 7320 616c 7265 6164 7920 4d75  it is already Mu
-0003bc60: 6c74 692d 4c61 6265 6c0d 0a20 2020 2020  lti-Label..     
+0003bb80: 2020 2020 2020 2020 2020 2023 6573 7469             #esti
+0003bb90: 6d61 746f 725f 7374 7269 6e67 2b27 4327  mator_string+'C'
+0003bba0: 3a20 5b31 652d 332c 2031 652d 322c 2031  : [1e-3, 1e-2, 1
+0003bbb0: 652d 312c 2031 6530 2c20 3165 312c 2031  e-1, 1e0, 1e1, 1
+0003bbc0: 6532 2c20 3165 335d 0d0a 2020 2020 2020  e2, 1e3]..      
+0003bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bbe0: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+0003bbf0: 7374 7269 6e67 2b27 6e5f 6e65 6967 6862  string+'n_neighb
+0003bc00: 6f72 7327 3a20 5b31 2c33 2c35 2c37 2c31  ors': [1,3,5,7,1
+0003bc10: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+0003bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bc30: 2020 2020 2020 2020 7d2c 0d0a 2020 2020          },..    
+0003bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bc50: 2020 2020 2020 2020 2246 6f72 6573 7473          "Forests
+0003bc60: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
 0003bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bc80: 2020 2020 2020 2027 6e5f 6573 7469 6d61         'n_estima
-0003bc90: 746f 7273 273a 2020 6e70 2e6c 696e 7370  tors':  np.linsp
-0003bca0: 6163 6528 3130 302c 206d 6178 5f65 7374  ace(100, max_est
-0003bcb0: 696d 732c 206e 5f73 7465 7073 2c20 6474  ims, n_steps, dt
-0003bcc0: 7970 6520 3d20 2269 6e74 2229 2c0d 0a20  ype = "int"),.. 
+0003bc80: 2020 2323 2323 204e 6f20 6573 7469 6d61    #### No estima
+0003bc90: 746f 7220 7374 7269 6e67 2066 6f72 2052  tor string for R
+0003bca0: 616e 646f 6d20 466f 7265 7374 7320 7369  andom Forests si
+0003bcb0: 6e63 6520 6974 2069 7320 616c 7265 6164  nce it is alread
+0003bcc0: 7920 4d75 6c74 692d 4c61 6265 6c0d 0a20  y Multi-Label.. 
 0003bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bce0: 2020 2020 2020 2020 2020 207d 2c0d 0a20             },.. 
-0003bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bd00: 2020 2020 2020 2020 2020 2022 5847 426f             "XGBo
-0003bd10: 6f73 7422 3a20 7b0d 0a20 2020 2020 2020  ost": {..       
-0003bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bd30: 2020 2020 2065 7374 696d 6174 6f72 5f73       estimator_s
-0003bd40: 7472 696e 672b 276e 5f65 7374 696d 6174  tring+'n_estimat
-0003bd50: 6f72 7327 3a20 206e 702e 6c69 6e73 7061  ors':  np.linspa
-0003bd60: 6365 2831 3030 2c20 6d61 785f 6573 7469  ce(100, max_esti
-0003bd70: 6d73 2c20 6e5f 7374 6570 732c 2064 7479  ms, n_steps, dty
-0003bd80: 7065 203d 2022 696e 7422 292c 0d0a 2020  pe = "int"),..  
-0003bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bda0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0003bdb0: 746f 725f 7374 7269 6e67 2b27 6c65 6172  tor_string+'lear
-0003bdc0: 6e69 6e67 5f72 6174 6527 3a20 6e70 2e6c  ning_rate': np.l
-0003bdd0: 696e 7370 6163 6528 302e 312c 302e 352c  inspace(0.1,0.5,
-0003bde0: 3529 2c0d 0a20 2020 2020 2020 2020 2020  5),..           
-0003bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be00: 2065 7374 696d 6174 6f72 5f73 7472 696e   estimator_strin
-0003be10: 672b 2767 616d 6d61 273a 206e 702e 6c69  g+'gamma': np.li
-0003be20: 6e73 7061 6365 2830 2c20 3332 2c37 292e  nspace(0, 32,7).
-0003be30: 6173 7479 7065 2869 6e74 292c 0d0a 2020  astype(int),..  
-0003be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be50: 2020 2020 2020 2020 2020 7d2c 0d0a 2020            },..  
-0003be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be70: 2020 2020 2020 2020 2020 2243 6174 426f            "CatBo
-0003be80: 6f73 7422 3a20 7b0d 0a20 2020 2020 2020  ost": {..       
-0003be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bea0: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-0003beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bec0: 7d0d 0a20 2020 2020 2020 2020 2020 2020  }..             
-0003bed0: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-0003bee0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0003bef0: 2020 2020 2069 6d70 6f72 7420 7363 6970       import scip
-0003bf00: 7920 6173 2073 700d 0a20 2020 2020 2020  y as sp..       
-0003bf10: 2020 2020 2072 5f70 6172 616d 7320 3d20       r_params = 
-0003bf20: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-0003bf30: 2020 2020 2020 2022 466f 7265 7374 7322         "Forests"
-0003bf40: 3a20 7b0d 0a20 2020 2020 2020 2020 2020  : {..           
-0003bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf60: 276e 5f65 7374 696d 6174 6f72 7327 3a20  'n_estimators': 
-0003bf70: 7370 2e73 7461 7473 2e72 616e 6469 6e74  sp.stats.randint
-0003bf80: 2831 3030 2c6d 6178 5f65 7374 696d 7329  (100,max_estims)
-0003bf90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003bfa0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003bfb0: 6d61 785f 6465 7074 6822 3a20 7370 2e73  max_depth": sp.s
-0003bfc0: 7461 7473 2e72 616e 6469 6e74 2833 2c20  tats.randint(3, 
-0003bfd0: 6d61 785f 6465 7074 6829 2c0d 0a20 2020  max_depth),..   
-0003bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bff0: 2020 2020 2020 2020 2022 6d69 6e5f 7361           "min_sa
-0003c000: 6d70 6c65 735f 6c65 6166 223a 2073 702e  mples_leaf": sp.
-0003c010: 7374 6174 732e 7261 6e64 696e 7428 322c  stats.randint(2,
-0003c020: 2032 3029 2c0d 0a20 2020 2020 2020 2020   20),..         
-0003c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c040: 2020 2023 2263 7269 7465 7269 6f6e 2220     #"criterion" 
-0003c050: 3a20 5b27 6d73 6527 2c27 6d61 6527 5d2c  : ['mse','mae'],
-0003c060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c070: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0003c080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c090: 2020 2020 2020 224c 696e 6561 7222 3a20        "Linear": 
-0003c0a0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-0003c0b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003c0c0: 2761 6c70 6861 273a 2073 702e 7374 6174  'alpha': sp.stat
-0003c0d0: 732e 756e 6966 6f72 6d28 7363 616c 653d  s.uniform(scale=
-0003c0e0: 3130 3030 292c 0d0a 2020 2020 2020 2020  1000),..        
-0003c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c100: 2020 2020 2765 7073 696c 6f6e 273a 2073      'epsilon': s
-0003c110: 702e 7374 6174 732e 756e 6966 6f72 6d28  p.stats.uniform(
-0003c120: 7363 616c 653d 3129 2c0d 0a20 2020 2020  scale=1),..     
-0003c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c140: 2020 2020 2020 2027 4327 3a20 7370 2e73         'C': sp.s
-0003c150: 7461 7473 2e75 6e69 666f 726d 2873 6361  tats.uniform(sca
-0003c160: 6c65 3d31 3030 290d 0a20 2020 2020 2020  le=100)..       
-0003c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c180: 2020 2020 207d 2c0d 0a20 2020 2020 2020       },..       
-0003c190: 2020 2020 2020 2020 2020 2020 2022 5847               "XG
-0003c1a0: 426f 6f73 7422 3a20 207b 0d0a 2020 2020  Boost":  {..    
-0003c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c1c0: 2020 2020 2020 2020 276c 6561 726e 696e          'learnin
-0003c1d0: 675f 7261 7465 273a 2073 702e 7374 6174  g_rate': sp.stat
-0003c1e0: 732e 756e 6966 6f72 6d28 7363 616c 653d  s.uniform(scale=
-0003c1f0: 3129 2c0d 0a20 2020 2020 2020 2020 2020  1),..           
-0003c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c210: 2027 6761 6d6d 6127 3a20 7370 2e73 7461   'gamma': sp.sta
-0003c220: 7473 2e72 616e 6469 6e74 2830 2c20 3332  ts.randint(0, 32
-0003c230: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0003c240: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0003c250: 6e5f 6573 7469 6d61 746f 7273 273a 2073  n_estimators': s
-0003c260: 702e 7374 6174 732e 7261 6e64 696e 7428  p.stats.randint(
-0003c270: 3130 302c 6d61 785f 6573 7469 6d73 292c  100,max_estims),
-0003c280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c290: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-0003c2a0: 6178 5f64 6570 7468 223a 2073 702e 7374  ax_depth": sp.st
-0003c2b0: 6174 732e 7261 6e64 696e 7428 332c 206d  ats.randint(3, m
-0003c2c0: 6178 5f64 6570 7468 292c 0d0a 2020 2020  ax_depth),..    
-0003c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c2e0: 2020 2020 2020 2020 2020 2020 7d2c 0d0a              },..
+0003bce0: 2020 2020 2020 2020 2020 2027 6e5f 6573             'n_es
+0003bcf0: 7469 6d61 746f 7273 273a 2020 6e70 2e6c  timators':  np.l
+0003bd00: 696e 7370 6163 6528 3130 302c 206d 6178  inspace(100, max
+0003bd10: 5f65 7374 696d 732c 206e 5f73 7465 7073  _estims, n_steps
+0003bd20: 2c20 6474 7970 6520 3d20 2269 6e74 2229  , dtype = "int")
+0003bd30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003bd40: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0003bd50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003bd60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003bd70: 5847 426f 6f73 7422 3a20 7b0d 0a20 2020  XGBoost": {..   
+0003bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bd90: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0003bda0: 6f72 5f73 7472 696e 672b 276e 5f65 7374  or_string+'n_est
+0003bdb0: 696d 6174 6f72 7327 3a20 206e 702e 6c69  imators':  np.li
+0003bdc0: 6e73 7061 6365 2831 3030 2c20 6d61 785f  nspace(100, max_
+0003bdd0: 6573 7469 6d73 2c20 6e5f 7374 6570 732c  estims, n_steps,
+0003bde0: 2064 7479 7065 203d 2022 696e 7422 292c   dtype = "int"),
+0003bdf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003be00: 2020 2020 2020 2020 2020 2020 2020 6573                es
+0003be10: 7469 6d61 746f 725f 7374 7269 6e67 2b27  timator_string+'
+0003be20: 6c65 6172 6e69 6e67 5f72 6174 6527 3a20  learning_rate': 
+0003be30: 6e70 2e6c 696e 7370 6163 6528 302e 312c  np.linspace(0.1,
+0003be40: 302e 352c 3529 2c0d 0a20 2020 2020 2020  0.5,5),..       
+0003be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003be60: 2020 2020 2065 7374 696d 6174 6f72 5f73       estimator_s
+0003be70: 7472 696e 672b 2767 616d 6d61 273a 206e  tring+'gamma': n
+0003be80: 702e 6c69 6e73 7061 6365 2830 2c20 3332  p.linspace(0, 32
+0003be90: 2c37 292e 6173 7479 7065 2869 6e74 292c  ,7).astype(int),
+0003bea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003beb0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+0003bec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003bed0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+0003bee0: 6174 426f 6f73 7422 3a20 7b0d 0a20 2020  atBoost": {..   
+0003bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bf00: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+0003bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bf20: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
+0003bf30: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
+0003bf40: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0003bf50: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+0003bf60: 7363 6970 7920 6173 2073 700d 0a20 2020  scipy as sp..   
+0003bf70: 2020 2020 2020 2020 2072 5f70 6172 616d           r_param
+0003bf80: 7320 3d20 7b0d 0a20 2020 2020 2020 2020  s = {..         
+0003bf90: 2020 2020 2020 2020 2020 2022 466f 7265             "Fore
+0003bfa0: 7374 7322 3a20 7b0d 0a20 2020 2020 2020  sts": {..       
+0003bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bfc0: 2020 2020 276e 5f65 7374 696d 6174 6f72      'n_estimator
+0003bfd0: 7327 3a20 7370 2e73 7461 7473 2e72 616e  s': sp.stats.ran
+0003bfe0: 6469 6e74 2831 3030 2c6d 6178 5f65 7374  dint(100,max_est
+0003bff0: 696d 7329 2c0d 0a20 2020 2020 2020 2020  ims),..         
+0003c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c010: 2020 2022 6d61 785f 6465 7074 6822 3a20     "max_depth": 
+0003c020: 7370 2e73 7461 7473 2e72 616e 6469 6e74  sp.stats.randint
+0003c030: 2833 2c20 6d61 785f 6465 7074 6829 2c0d  (3, max_depth),.
+0003c040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c050: 2020 2020 2020 2020 2020 2020 2022 6d69               "mi
+0003c060: 6e5f 7361 6d70 6c65 735f 6c65 6166 223a  n_samples_leaf":
+0003c070: 2073 702e 7374 6174 732e 7261 6e64 696e   sp.stats.randin
+0003c080: 7428 322c 2032 3029 2c0d 0a20 2020 2020  t(2, 20),..     
+0003c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c0a0: 2020 2020 2020 2023 2263 7269 7465 7269         #"criteri
+0003c0b0: 6f6e 2220 3a20 5b27 6d73 6527 2c27 6d61  on" : ['mse','ma
+0003c0c0: 6527 5d2c 0d0a 2020 2020 2020 2020 2020  e'],..          
+0003c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c0e0: 2020 7d2c 0d0a 2020 2020 2020 2020 2020    },..          
+0003c0f0: 2020 2020 2020 2020 2020 224c 696e 6561            "Linea
+0003c100: 7222 3a20 7b0d 0a20 2020 2020 2020 2020  r": {..         
+0003c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c120: 2020 2023 2761 6c70 6861 273a 2073 702e     #'alpha': sp.
+0003c130: 7374 6174 732e 756e 6966 6f72 6d28 7363  stats.uniform(sc
+0003c140: 616c 653d 3130 3030 292c 0d0a 2020 2020  ale=1000),..    
+0003c150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c160: 2020 2020 2020 2020 2765 7073 696c 6f6e          'epsilon
+0003c170: 273a 2073 702e 7374 6174 732e 756e 6966  ': sp.stats.unif
+0003c180: 6f72 6d28 7363 616c 653d 3129 2c0d 0a20  orm(scale=1),.. 
+0003c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1a0: 2020 2020 2020 2020 2020 2027 4327 3a20             'C': 
+0003c1b0: 7370 2e73 7461 7473 2e75 6e69 666f 726d  sp.stats.uniform
+0003c1c0: 2873 6361 6c65 3d31 3030 290d 0a20 2020  (scale=100)..   
+0003c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1e0: 2020 2020 2020 2020 207d 2c0d 0a20 2020           },..   
+0003c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c200: 2022 5847 426f 6f73 7422 3a20 207b 0d0a   "XGBoost":  {..
+0003c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c220: 2020 2020 2020 2020 2020 2020 276c 6561              'lea
+0003c230: 726e 696e 675f 7261 7465 273a 2073 702e  rning_rate': sp.
+0003c240: 7374 6174 732e 756e 6966 6f72 6d28 7363  stats.uniform(sc
+0003c250: 616c 653d 3129 2c0d 0a20 2020 2020 2020  ale=1),..       
+0003c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c270: 2020 2020 2027 6761 6d6d 6127 3a20 7370       'gamma': sp
+0003c280: 2e73 7461 7473 2e72 616e 6469 6e74 2830  .stats.randint(0
+0003c290: 2c20 3332 292c 0d0a 2020 2020 2020 2020  , 32),..        
+0003c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c2b0: 2020 2027 6e5f 6573 7469 6d61 746f 7273     'n_estimators
+0003c2c0: 273a 2073 702e 7374 6174 732e 7261 6e64  ': sp.stats.rand
+0003c2d0: 696e 7428 3130 302c 6d61 785f 6573 7469  int(100,max_esti
+0003c2e0: 6d73 292c 0d0a 2020 2020 2020 2020 2020  ms),..          
 0003c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c300: 2020 2020 2243 6174 426f 6f73 7422 3a20      "CatBoost": 
-0003c310: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-0003c320: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0003c330: 6c65 6172 6e69 6e67 5f72 6174 6527 3a20  learning_rate': 
-0003c340: 6e70 2e6c 6f67 7370 6163 6528 416c 7068  np.logspace(Alph
-0003c350: 615f 6d69 6e2c 416c 7068 615f 6d61 782c  a_min,Alpha_max,
-0003c360: 3430 292c 0d0a 2020 2020 2020 2020 2020  40),..          
-0003c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c380: 2020 7d2c 0d0a 2020 2020 2020 2020 2020    },..          
-0003c390: 2020 2020 2020 2020 2020 224d 756c 7469            "Multi
-0003c3a0: 5f4c 6162 656c 223a 207b 0d0a 2020 2020  _Label": {..    
-0003c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c3c0: 2020 2020 224c 696e 6561 7222 3a20 7b0d      "Linear": {.
-0003c3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c3e0: 2020 2020 2020 2020 2020 2020 2023 6573               #es
-0003c3f0: 7469 6d61 746f 725f 7374 7269 6e67 2b27  timator_string+'
-0003c400: 4327 3a20 7370 2e73 7461 7473 2e75 6e69  C': sp.stats.uni
-0003c410: 666f 726d 2873 6361 6c65 3d31 290d 0a20  form(scale=1).. 
-0003c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c430: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0003c440: 6174 6f72 5f73 7472 696e 672b 276e 5f6e  ator_string+'n_n
-0003c450: 6569 6768 626f 7273 273a 2073 702e 7374  eighbors': sp.st
-0003c460: 6174 732e 7261 6e64 696e 7428 312c 6d61  ats.randint(1,ma
-0003c470: 785f 6e65 6967 6862 6f72 7329 0d0a 2020  x_neighbors)..  
-0003c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c490: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0003c4a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c4b0: 2020 2020 2020 2020 2020 2246 6f72 6573            "Fores
-0003c4c0: 7473 223a 207b 0d0a 2020 2020 2020 2020  ts": {..        
-0003c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4e0: 2020 2020 2365 7374 696d 6174 6f72 5f73      #estimator_s
-0003c4f0: 7472 696e 672b 275f 5f6e 5f65 7374 696d  tring+'__n_estim
-0003c500: 6174 6f72 7327 3a20 7370 2e73 7461 7473  ators': sp.stats
-0003c510: 2e72 616e 6469 6e74 2831 3030 2c6d 6178  .randint(100,max
-0003c520: 5f65 7374 696d 7329 0d0a 2020 2020 2020  _estims)..      
+0003c300: 2020 226d 6178 5f64 6570 7468 223a 2073    "max_depth": s
+0003c310: 702e 7374 6174 732e 7261 6e64 696e 7428  p.stats.randint(
+0003c320: 332c 206d 6178 5f64 6570 7468 292c 0d0a  3, max_depth),..
+0003c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c350: 7d2c 0d0a 2020 2020 2020 2020 2020 2020  },..            
+0003c360: 2020 2020 2020 2020 2243 6174 426f 6f73          "CatBoos
+0003c370: 7422 3a20 7b0d 0a20 2020 2020 2020 2020  t": {..         
+0003c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c390: 2020 2027 6c65 6172 6e69 6e67 5f72 6174     'learning_rat
+0003c3a0: 6527 3a20 6e70 2e6c 6f67 7370 6163 6528  e': np.logspace(
+0003c3b0: 416c 7068 615f 6d69 6e2c 416c 7068 615f  Alpha_min,Alpha_
+0003c3c0: 6d61 782c 3430 292c 0d0a 2020 2020 2020  max,40),..      
+0003c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c3e0: 2020 2020 2020 7d2c 0d0a 2020 2020 2020        },..      
+0003c3f0: 2020 2020 2020 2020 2020 2020 2020 224d                "M
+0003c400: 756c 7469 5f4c 6162 656c 223a 207b 0d0a  ulti_Label": {..
+0003c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c420: 2020 2020 2020 2020 224c 696e 6561 7222          "Linear"
+0003c430: 3a20 7b0d 0a20 2020 2020 2020 2020 2020  : {..           
+0003c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c450: 2023 6573 7469 6d61 746f 725f 7374 7269   #estimator_stri
+0003c460: 6e67 2b27 4327 3a20 7370 2e73 7461 7473  ng+'C': sp.stats
+0003c470: 2e75 6e69 666f 726d 2873 6361 6c65 3d31  .uniform(scale=1
+0003c480: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003c490: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003c4a0: 7374 696d 6174 6f72 5f73 7472 696e 672b  stimator_string+
+0003c4b0: 276e 5f6e 6569 6768 626f 7273 273a 2073  'n_neighbors': s
+0003c4c0: 702e 7374 6174 732e 7261 6e64 696e 7428  p.stats.randint(
+0003c4d0: 312c 6d61 785f 6e65 6967 6862 6f72 7329  1,max_neighbors)
+0003c4e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c500: 2020 7d2c 0d0a 2020 2020 2020 2020 2020    },..          
+0003c510: 2020 2020 2020 2020 2020 2020 2020 2246                "F
+0003c520: 6f72 6573 7473 223a 207b 0d0a 2020 2020  orests": {..    
 0003c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c540: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
-0003c550: 7374 7269 6e67 2b27 6e5f 6573 7469 6d61  string+'n_estima
-0003c560: 746f 7273 273a 2073 702e 7374 6174 732e  tors': sp.stats.
-0003c570: 7261 6e64 696e 7428 3130 302c 6d61 785f  randint(100,max_
-0003c580: 6573 7469 6d73 290d 0a20 2020 2020 2020  estims)..       
+0003c540: 2020 2020 2020 2020 2365 7374 696d 6174          #estimat
+0003c550: 6f72 5f73 7472 696e 672b 275f 5f6e 5f65  or_string+'__n_e
+0003c560: 7374 696d 6174 6f72 7327 3a20 7370 2e73  stimators': sp.s
+0003c570: 7461 7473 2e72 616e 6469 6e74 2831 3030  tats.randint(100
+0003c580: 2c6d 6178 5f65 7374 696d 7329 0d0a 2020  ,max_estims)..  
 0003c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5a0: 2020 2020 2020 2020 207d 2c0d 0a20 2020           },..   
-0003c5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5c0: 2020 2020 2022 5847 426f 6f73 7422 3a20       "XGBoost": 
-0003c5d0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-0003c5e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003c5f0: 7374 696d 6174 6f72 5f73 7472 696e 672b  stimator_string+
-0003c600: 276c 6561 726e 696e 675f 7261 7465 273a  'learning_rate':
-0003c610: 2073 702e 7374 6174 732e 756e 6966 6f72   sp.stats.unifor
-0003c620: 6d28 7363 616c 653d 3129 2c0d 0a20 2020  m(scale=1),..   
-0003c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c640: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0003c650: 725f 7374 7269 6e67 2b27 6e5f 6573 7469  r_string+'n_esti
-0003c660: 6d61 746f 7273 273a 2073 702e 7374 6174  mators': sp.stat
-0003c670: 732e 7261 6e64 696e 7428 3130 302c 6d61  s.randint(100,ma
-0003c680: 785f 6573 7469 6d73 292c 0d0a 2020 2020  x_estims),..    
-0003c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c6a0: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0003c6b0: 5f73 7472 696e 672b 2767 616d 6d61 273a  _string+'gamma':
-0003c6c0: 2073 702e 7374 6174 732e 7261 6e64 696e   sp.stats.randin
-0003c6d0: 7428 302c 2033 3229 2c0d 0a20 2020 2020  t(0, 32),..     
-0003c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c6f0: 2020 2020 2020 2020 2020 207d 2c0d 0a20             },.. 
-0003c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c710: 2020 2020 2020 2022 4361 7442 6f6f 7374         "CatBoost
-0003c720: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
-0003c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c740: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-0003c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c760: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-0003c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c780: 7d0d 0a20 2020 2020 2020 2069 6620 426f  }..        if Bo
-0003c790: 6f73 7469 6e67 5f46 6c61 673a 0d0a 2020  osting_Flag:..  
-0003c7a0: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-0003c7b0: 656c 5f6e 616d 652e 6c6f 7765 7228 2920  el_name.lower() 
-0003c7c0: 3d3d 2027 6361 7462 6f6f 7374 273a 0d0a  == 'catboost':..
+0003c5a0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0003c5b0: 746f 725f 7374 7269 6e67 2b27 6e5f 6573  tor_string+'n_es
+0003c5c0: 7469 6d61 746f 7273 273a 2073 702e 7374  timators': sp.st
+0003c5d0: 6174 732e 7261 6e64 696e 7428 3130 302c  ats.randint(100,
+0003c5e0: 6d61 785f 6573 7469 6d73 290d 0a20 2020  max_estims)..   
+0003c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c600: 2020 2020 2020 2020 2020 2020 207d 2c0d               },.
+0003c610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c620: 2020 2020 2020 2020 2022 5847 426f 6f73           "XGBoos
+0003c630: 7422 3a20 7b0d 0a20 2020 2020 2020 2020  t": {..         
+0003c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c650: 2020 2065 7374 696d 6174 6f72 5f73 7472     estimator_str
+0003c660: 696e 672b 276c 6561 726e 696e 675f 7261  ing+'learning_ra
+0003c670: 7465 273a 2073 702e 7374 6174 732e 756e  te': sp.stats.un
+0003c680: 6966 6f72 6d28 7363 616c 653d 3129 2c0d  iform(scale=1),.
+0003c690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c6a0: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+0003c6b0: 6d61 746f 725f 7374 7269 6e67 2b27 6e5f  mator_string+'n_
+0003c6c0: 6573 7469 6d61 746f 7273 273a 2073 702e  estimators': sp.
+0003c6d0: 7374 6174 732e 7261 6e64 696e 7428 3130  stats.randint(10
+0003c6e0: 302c 6d61 785f 6573 7469 6d73 292c 0d0a  0,max_estims),..
+0003c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c700: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0003c710: 6174 6f72 5f73 7472 696e 672b 2767 616d  ator_string+'gam
+0003c720: 6d61 273a 2073 702e 7374 6174 732e 7261  ma': sp.stats.ra
+0003c730: 6e64 696e 7428 302c 2033 3229 2c0d 0a20  ndint(0, 32),.. 
+0003c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c750: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0003c760: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003c770: 2020 2020 2020 2020 2020 2022 4361 7442             "CatB
+0003c780: 6f6f 7374 223a 207b 0d0a 2020 2020 2020  oost": {..      
+0003c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c7a0: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
+0003c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c7c0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
 0003c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7e0: 7867 626d 203d 2043 6174 426f 6f73 7452  xgbm = CatBoostR
-0003c7f0: 6567 7265 7373 6f72 2876 6572 626f 7365  egressor(verbose
-0003c800: 3d31 2c69 7465 7261 7469 6f6e 733d 6d61  =1,iterations=ma
-0003c810: 785f 6573 7469 6d73 2c72 616e 646f 6d5f  x_estims,random_
-0003c820: 7374 6174 653d 3939 2c0d 0a20 2020 2020  state=99,..     
-0003c830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c840: 2020 206f 6e65 5f68 6f74 5f6d 6178 5f73     one_hot_max_s
-0003c850: 697a 653d 6f6e 655f 686f 745f 7369 7a65  ize=one_hot_size
-0003c860: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003c870: 2020 2020 2020 2020 2020 206c 6f73 735f             loss_
-0003c880: 6675 6e63 7469 6f6e 3d6c 6f73 735f 6675  function=loss_fu
-0003c890: 6e63 7469 6f6e 2c20 6576 616c 5f6d 6574  nction, eval_met
-0003c8a0: 7269 633d 6361 7462 6f6f 7374 5f73 636f  ric=catboost_sco
-0003c8b0: 7269 6e67 2c0d 0a20 2020 2020 2020 2020  ring,..         
-0003c8c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003c8d0: 7562 7361 6d70 6c65 3d30 2e37 2c62 6f6f  ubsample=0.7,boo
-0003c8e0: 7473 7472 6170 5f74 7970 653d 2742 6572  tstrap_type='Ber
-0003c8f0: 6e6f 756c 6c69 272c 0d0a 2020 2020 2020  noulli',..      
-0003c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c910: 2020 6d65 7472 6963 5f70 6572 696f 6420    metric_period 
-0003c920: 3d20 3530 302c 0d0a 2020 2020 2020 2020  = 500,..        
-0003c930: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003c940: 6172 6c79 5f73 746f 7070 696e 675f 726f  arly_stopping_ro
-0003c950: 756e 6473 3d32 3030 302c 626f 6f73 7469  unds=2000,boosti
-0003c960: 6e67 5f74 7970 653d 2750 6c61 696e 2729  ng_type='Plain')
-0003c970: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003c980: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003c990: 2020 2020 206f 626a 6563 7469 7665 203d       objective =
-0003c9a0: 2027 7265 673a 7371 7561 7265 6465 7272   'reg:squarederr
-0003c9b0: 6f72 270d 0a20 2020 2020 2020 2020 2020  or'..           
-0003c9c0: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
-0003c9d0: 6265 6c20 3d3d 2027 4d75 6c74 695f 4c61  bel == 'Multi_La
-0003c9e0: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
-0003c9f0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-0003ca00: 2046 6f72 206d 756c 7469 2d6c 6162 656c   For multi-label
-0003ca10: 2c20 6974 2069 7320 6265 7474 6572 2074  , it is better t
-0003ca20: 6f20 6b65 6570 2074 6865 2058 4742 6f6f  o keep the XGBoo
-0003ca30: 7374 2073 696d 706c 6520 2323 2323 2323  st simple ######
-0003ca40: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-0003ca50: 2020 2020 2020 2020 2020 7867 626d 203d            xgbm =
-0003ca60: 2058 4742 5265 6772 6573 736f 7228 6261   XGBRegressor(ba
-0003ca70: 7365 5f73 636f 7265 3d30 2e35 2c20 626f  se_score=0.5, bo
-0003ca80: 6f73 7465 723d 2767 6274 7265 6527 2c20  oster='gbtree', 
-0003ca90: 6e5f 6573 7469 6d61 746f 7273 3d32 3030  n_estimators=200
-0003caa0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003cab0: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
-0003cac0: 733d 2d31 2c20 6e74 6872 6561 643d 2d31  s=-1, nthread=-1
-0003cad0: 2c20 6f62 6a65 6374 6976 653d 6f62 6a65  , objective=obje
-0003cae0: 6374 6976 652c 2072 616e 646f 6d5f 7374  ctive, random_st
-0003caf0: 6174 653d 312c 0d0a 2020 2020 2020 2020  ate=1,..        
-0003cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb10: 7365 6564 3d31 290d 0a20 2020 2020 2020  seed=1)..       
-0003cb20: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0003cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb40: 2020 2020 2323 2323 2320 466f 7220 5369      ##### For Si
-0003cb50: 6e67 6c65 2d6c 6162 656c 2c20 6974 2069  ngle-label, it i
-0003cb60: 7320 6265 7474 6572 2074 6f20 6b65 6570  s better to keep
-0003cb70: 2074 6865 2058 4742 6f6f 7374 2063 6f6d   the XGBoost com
-0003cb80: 706c 6578 2023 2323 2323 2323 2323 230d  plex ##########.
-0003cb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cba0: 2020 2020 2078 6762 6d20 3d20 5847 4252       xgbm = XGBR
-0003cbb0: 6567 7265 7373 6f72 2820 6e5f 6573 7469  egressor( n_esti
-0003cbc0: 6d61 746f 7273 3d31 3030 2c73 7562 7361  mators=100,subsa
-0003cbd0: 6d70 6c65 3d73 7562 7361 6d70 6c65 2c6f  mple=subsample,o
-0003cbe0: 626a 6563 7469 7665 3d6f 626a 6563 7469  bjective=objecti
-0003cbf0: 7665 2c0d 0a20 2020 2020 2020 2020 2020  ve,..           
-0003cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc20: 2062 6f6f 7374 6572 3d27 6762 7472 6565   booster='gbtree
-0003cc30: 272c 206c 6561 726e 696e 675f 7261 7465  ', learning_rate
-0003cc40: 3d30 2e31 2c6e 7468 7265 6164 3d2d 312c  =0.1,nthread=-1,
-0003cc50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c7e0: 2020 2020 7d0d 0a20 2020 2020 2020 2069      }..        i
+0003c7f0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
+0003c800: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0003c810: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
+0003c820: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
+0003c830: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0003c840: 2020 2020 7867 626d 203d 2043 6174 426f      xgbm = CatBo
+0003c850: 6f73 7452 6567 7265 7373 6f72 2876 6572  ostRegressor(ver
+0003c860: 626f 7365 3d31 2c69 7465 7261 7469 6f6e  bose=1,iteration
+0003c870: 733d 6d61 785f 6573 7469 6d73 2c72 616e  s=max_estims,ran
+0003c880: 646f 6d5f 7374 6174 653d 3939 2c0d 0a20  dom_state=99,.. 
+0003c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c8a0: 2020 2020 2020 206f 6e65 5f68 6f74 5f6d         one_hot_m
+0003c8b0: 6178 5f73 697a 653d 6f6e 655f 686f 745f  ax_size=one_hot_
+0003c8c0: 7369 7a65 2c0d 0a20 2020 2020 2020 2020  size,..         
+0003c8d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003c8e0: 6f73 735f 6675 6e63 7469 6f6e 3d6c 6f73  oss_function=los
+0003c8f0: 735f 6675 6e63 7469 6f6e 2c20 6576 616c  s_function, eval
+0003c900: 5f6d 6574 7269 633d 6361 7462 6f6f 7374  _metric=catboost
+0003c910: 5f73 636f 7269 6e67 2c0d 0a20 2020 2020  _scoring,..     
+0003c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c930: 2020 2073 7562 7361 6d70 6c65 3d30 2e37     subsample=0.7
+0003c940: 2c62 6f6f 7473 7472 6170 5f74 7970 653d  ,bootstrap_type=
+0003c950: 2742 6572 6e6f 756c 6c69 272c 0d0a 2020  'Bernoulli',..  
+0003c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c970: 2020 2020 2020 6d65 7472 6963 5f70 6572        metric_per
+0003c980: 696f 6420 3d20 3530 302c 0d0a 2020 2020  iod = 500,..    
+0003c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c9a0: 2020 2065 6172 6c79 5f73 746f 7070 696e     early_stoppin
+0003c9b0: 675f 726f 756e 6473 3d32 3030 302c 626f  g_rounds=2000,bo
+0003c9c0: 6f73 7469 6e67 5f74 7970 653d 2750 6c61  osting_type='Pla
+0003c9d0: 696e 2729 0d0a 2020 2020 2020 2020 2020  in')..          
+0003c9e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0003c9f0: 2020 2020 2020 2020 206f 626a 6563 7469           objecti
+0003ca00: 7665 203d 2027 7265 673a 7371 7561 7265  ve = 'reg:square
+0003ca10: 6465 7272 6f72 270d 0a20 2020 2020 2020  derror'..       
+0003ca20: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+0003ca30: 6c5f 6c61 6265 6c20 3d3d 2027 4d75 6c74  l_label == 'Mult
+0003ca40: 695f 4c61 6265 6c27 3a0d 0a20 2020 2020  i_Label':..     
+0003ca50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003ca60: 2323 2323 2046 6f72 206d 756c 7469 2d6c  #### For multi-l
+0003ca70: 6162 656c 2c20 6974 2069 7320 6265 7474  abel, it is bett
+0003ca80: 6572 2074 6f20 6b65 6570 2074 6865 2058  er to keep the X
+0003ca90: 4742 6f6f 7374 2073 696d 706c 6520 2323  GBoost simple ##
+0003caa0: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+0003cab0: 2020 2020 2020 2020 2020 2020 2020 7867                xg
+0003cac0: 626d 203d 2058 4742 5265 6772 6573 736f  bm = XGBRegresso
+0003cad0: 7228 6261 7365 5f73 636f 7265 3d30 2e35  r(base_score=0.5
+0003cae0: 2c20 626f 6f73 7465 723d 2767 6274 7265  , booster='gbtre
+0003caf0: 6527 2c20 6e5f 6573 7469 6d61 746f 7273  e', n_estimators
+0003cb00: 3d32 3030 2c0d 0a20 2020 2020 2020 2020  =200,..         
+0003cb10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0003cb20: 5f6a 6f62 733d 2d31 2c20 6e74 6872 6561  _jobs=-1, nthrea
+0003cb30: 643d 2d31 2c20 6f62 6a65 6374 6976 653d  d=-1, objective=
+0003cb40: 6f62 6a65 6374 6976 652c 2072 616e 646f  objective, rando
+0003cb50: 6d5f 7374 6174 653d 312c 0d0a 2020 2020  m_state=1,..    
+0003cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cb70: 2020 2020 7365 6564 3d31 290d 0a20 2020      seed=1)..   
+0003cb80: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003cb90: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0003cba0: 2020 2020 2020 2020 2323 2323 2320 466f          ##### Fo
+0003cbb0: 7220 5369 6e67 6c65 2d6c 6162 656c 2c20  r Single-label, 
+0003cbc0: 6974 2069 7320 6265 7474 6572 2074 6f20  it is better to 
+0003cbd0: 6b65 6570 2074 6865 2058 4742 6f6f 7374  keep the XGBoost
+0003cbe0: 2063 6f6d 706c 6578 2023 2323 2323 2323   complex #######
+0003cbf0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0003cc00: 2020 2020 2020 2020 2078 6762 6d20 3d20           xgbm = 
+0003cc10: 5847 4252 6567 7265 7373 6f72 2820 6e5f  XGBRegressor( n_
+0003cc20: 6573 7469 6d61 746f 7273 3d31 3030 2c73  estimators=100,s
+0003cc30: 7562 7361 6d70 6c65 3d73 7562 7361 6d70  ubsample=subsamp
+0003cc40: 6c65 2c6f 626a 6563 7469 7665 3d6f 626a  le,objective=obj
+0003cc50: 6563 7469 7665 2c0d 0a20 2020 2020 2020  ective,..       
 0003cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc70: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0003cc80: 6c73 616d 706c 655f 6279 7472 6565 3d63  lsample_bytree=c
-0003cc90: 6f6c 5f73 7562 5f73 616d 706c 652c 7265  ol_sub_sample,re
-0003cca0: 675f 616c 7068 613d 302e 352c 2072 6567  g_alpha=0.5, reg
-0003ccb0: 5f6c 616d 6264 613d 302e 352c 0d0a 2020  _lambda=0.5,..  
+0003cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cc80: 2020 2020 2062 6f6f 7374 6572 3d27 6762       booster='gb
+0003cc90: 7472 6565 272c 206c 6561 726e 696e 675f  tree', learning_
+0003cca0: 7261 7465 3d30 2e31 2c6e 7468 7265 6164  rate=0.1,nthread
+0003ccb0: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
 0003ccc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cce0: 2020 2020 2020 2020 2020 2067 616d 6d61             gamma
-0003ccf0: 3d31 2c20 7365 6564 3d31 2c6e 5f6a 6f62  =1, seed=1,n_job
-0003cd00: 733d 2d31 2c72 616e 646f 6d5f 7374 6174  s=-1,random_stat
-0003cd10: 653d 3129 0d0a 2020 2020 2020 2020 2020  e=1)..          
-0003cd20: 2020 2020 2020 2020 2020 7867 626d 2e73            xgbm.s
-0003cd30: 6574 5f70 6172 616d 7328 2a2a 7061 7261  et_params(**para
-0003cd40: 6d29 0d0a 2020 2020 2020 2020 656c 6966  m)..        elif
-0003cd50: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
-0003cd60: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-0003cd70: 2020 2020 2023 7867 626d 203d 204c 6173       #xgbm = Las
-0003cd80: 736f 286d 6178 5f69 7465 723d 6d61 785f  so(max_iter=max_
-0003cd90: 6974 6572 2c72 616e 646f 6d5f 7374 6174  iter,random_stat
-0003cda0: 653d 7365 6564 290d 0a20 2020 2020 2020  e=seed)..       
-0003cdb0: 2020 2020 2023 7867 626d 203d 204c 6173       #xgbm = Las
-0003cdc0: 736f 286d 6178 5f69 7465 723d 6d61 785f  so(max_iter=max_
-0003cdd0: 6974 6572 2c72 616e 646f 6d5f 7374 6174  iter,random_stat
-0003cde0: 653d 7365 6564 290d 0a20 2020 2020 2020  e=seed)..       
-0003cdf0: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
-0003ce00: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
-0003ce10: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-0003ce20: 2020 2020 2020 2020 7867 626d 203d 204c          xgbm = L
-0003ce30: 696e 6561 7253 5652 2865 7073 696c 6f6e  inearSVR(epsilon
-0003ce40: 3d30 2e30 2c20 746f 6c3d 302e 3030 312c  =0.0, tol=0.001,
-0003ce50: 2043 3d31 2e30 2c6d 6178 5f69 7465 723d   C=1.0,max_iter=
-0003ce60: 6d61 785f 6974 6572 2c20 7261 6e64 6f6d  max_iter, random
-0003ce70: 5f73 7461 7465 3d73 6565 6429 0d0a 2020  _state=seed)..  
-0003ce80: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0003ce90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cea0: 2078 6762 6d20 3d20 4b4e 6569 6768 626f   xgbm = KNeighbo
-0003ceb0: 7273 5265 6772 6573 736f 7228 6e5f 6e65  rsRegressor(n_ne
-0003cec0: 6967 6862 6f72 733d 352c 2077 6569 6768  ighbors=5, weigh
-0003ced0: 7473 203d 2027 6469 7374 616e 6365 2729  ts = 'distance')
-0003cee0: 2023 2323 2064 6f6e 2774 2075 7365 206e   ### don't use n
-0003cef0: 5f6a 6f62 733d 2d31 2067 6976 6573 2065  _jobs=-1 gives e
-0003cf00: 7272 6f72 2121 0d0a 2020 2020 2020 2020  rror!!..        
-0003cf10: 2020 2020 2020 2020 2323 2323 206e 5f6a          #### n_j
-0003cf20: 6f62 7320 3d20 4e6f 6e65 2069 6e20 6361  obs = None in ca
-0003cf30: 7365 206f 6620 4b4e 4e20 7369 6e63 6520  se of KNN since 
-0003cf40: 6974 2067 6976 6573 2065 7272 6f72 2069  it gives error i
-0003cf50: 6620 796f 7520 7573 6520 2d31 2061 6e79  f you use -1 any
-0003cf60: 7768 6572 6520 696e 2074 6865 2070 726f  where in the pro
-0003cf70: 6365 7373 0d0a 2020 2020 2020 2020 2020  cess..          
-0003cf80: 2020 2020 2020 6e5f 6a6f 6273 203d 204e        n_jobs = N
-0003cf90: 6f6e 650d 0a20 2020 2020 2020 2065 6c73  one..        els
-0003cfa0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0003cfb0: 7867 626d 203d 2052 616e 646f 6d46 6f72  xgbm = RandomFor
-0003cfc0: 6573 7452 6567 7265 7373 6f72 280d 0a20  estRegressor(.. 
-0003cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cfe0: 2020 2020 2020 2020 2020 202a 2a7b 0d0a             **{..
-0003cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d000: 2020 2020 2020 2020 2020 2020 2762 6f6f              'boo
-0003d010: 7473 7472 6170 273a 2062 6f6f 7473 7472  tstrap': bootstr
-0003d020: 6170 2c20 276e 5f6a 6f62 7327 3a20 2d31  ap, 'n_jobs': -1
-0003d030: 2c20 2777 6172 6d5f 7374 6172 7427 3a20  , 'warm_start': 
-0003d040: 7761 726d 5f73 7461 7274 2c0d 0a20 2020  warm_start,..   
-0003d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d060: 2020 2020 2020 2020 2027 7261 6e64 6f6d           'random
-0003d070: 5f73 7461 7465 273a 7365 6564 2c27 6d69  _state':seed,'mi
-0003d080: 6e5f 7361 6d70 6c65 735f 6c65 6166 273a  n_samples_leaf':
-0003d090: 322c 0d0a 2020 2020 2020 2020 2020 2020  2,..            
-0003d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d0b0: 276d 6178 5f66 6561 7475 7265 7327 3a20  'max_features': 
-0003d0c0: 2273 7172 7422 0d0a 2020 2020 2020 2020  "sqrt"..        
-0003d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d0e0: 2020 2020 7d29 0d0a 2020 2020 656c 7365      })..    else
-0003d0f0: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
-0003d100: 5468 6973 2069 7320 666f 7220 4269 6e61  This is for Bina
-0003d110: 7279 2043 6c61 7373 6966 6963 6174 696f  ry Classificatio
-0003d120: 6e20 2323 2323 2323 2323 2323 2323 2323  n ##############
-0003d130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003d140: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
-0003d150: 7320 3d20 6c61 6265 6c5f 6469 6374 5b65  s = label_dict[e
-0003d160: 6163 685f 7461 7267 6574 5d5b 2763 6c61  ach_target]['cla
-0003d170: 7373 6573 275d 0d0a 2020 2020 2020 2020  sses']..        
-0003d180: 6d65 7472 6963 735f 6c69 7374 203d 205b  metrics_list = [
-0003d190: 2761 6363 7572 6163 795f 7363 6f72 6527  'accuracy_score'
-0003d1a0: 2c27 726f 635f 6175 635f 7363 6f72 6527  ,'roc_auc_score'
-0003d1b0: 2c27 6c6f 676c 6f73 7327 2c20 2770 7265  ,'logloss', 'pre
-0003d1c0: 6369 7369 6f6e 272c 2772 6563 616c 6c27  cision','recall'
-0003d1d0: 2c27 6631 275d 0d0a 2020 2020 2020 2020  ,'f1']..        
-0003d1e0: 2320 4372 6561 7465 2072 6567 756c 6172  # Create regular
-0003d1f0: 697a 6174 696f 6e20 6879 7065 7270 6172  ization hyperpar
-0003d200: 616d 6574 6572 2064 6973 7472 6962 7574  ameter distribut
-0003d210: 696f 6e20 7769 7468 2035 3020 4320 7661  ion with 50 C va
-0003d220: 6c75 6573 2023 2323 230d 0a20 2020 2020  lues ####..     
-0003d230: 2020 2069 6620 6879 7065 725f 7061 7261     if hyper_para
-0003d240: 6d20 3d3d 2027 4753 273a 0d0a 2020 2020  m == 'GS':..    
-0003d250: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
-0003d260: 5b27 5847 426f 6f73 7427 5d20 3d20 7b0d  ['XGBoost'] = {.
-0003d270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d290: 2020 2020 2027 6c65 6172 6e69 6e67 5f72       'learning_r
-0003d2a0: 6174 6527 3a20 6e70 2e6c 696e 7370 6163  ate': np.linspac
-0003d2b0: 6528 302e 312c 302e 352c 3529 2c0d 0a20  e(0.1,0.5,5),.. 
-0003d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d2e0: 2020 2027 6761 6d6d 6127 3a20 6e70 2e6c     'gamma': np.l
-0003d2f0: 696e 7370 6163 6528 302c 2033 322c 3729  inspace(0, 32,7)
-0003d300: 2e61 7374 7970 6528 696e 7429 2c0d 0a20  .astype(int),.. 
-0003d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d330: 2020 2022 6d61 785f 6465 7074 6822 3a20     "max_depth": 
-0003d340: 5b33 2c20 352c 206d 6178 5f64 6570 7468  [3, 5, max_depth
-0003d350: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0003d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d370: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
-0003d380: 2020 2063 5f70 6172 616d 735b 2243 6174     c_params["Cat
-0003d390: 426f 6f73 7422 5d20 3d20 7b0d 0a20 2020  Boost"] = {..   
-0003d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3b0: 2020 2020 2020 2020 2027 6c65 6172 6e69           'learni
-0003d3c0: 6e67 5f72 6174 6527 3a20 6e70 2e6c 6f67  ng_rate': np.log
-0003d3d0: 7370 6163 6528 416c 7068 615f 6d69 6e2c  space(Alpha_min,
-0003d3e0: 416c 7068 615f 6d61 782c 3430 292c 0d0a  Alpha_max,40),..
-0003d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d400: 2020 2020 2020 2020 2020 2020 7d0d 0a20              }.. 
-0003d410: 2020 2020 2020 2020 2020 2069 6620 496d             if Im
-0003d420: 6261 6c61 6e63 6564 5f46 6c61 673a 0d0a  balanced_Flag:..
-0003d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d440: 635f 7061 7261 6d73 5b27 4c69 6e65 6172  c_params['Linear
-0003d450: 275d 203d 207b 0d0a 2020 2020 2020 2020  '] = {..        
+0003cce0: 2020 636f 6c73 616d 706c 655f 6279 7472    colsample_bytr
+0003ccf0: 6565 3d63 6f6c 5f73 7562 5f73 616d 706c  ee=col_sub_sampl
+0003cd00: 652c 7265 675f 616c 7068 613d 302e 352c  e,reg_alpha=0.5,
+0003cd10: 2072 6567 5f6c 616d 6264 613d 302e 352c   reg_lambda=0.5,
+0003cd20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd40: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0003cd50: 616d 6d61 3d31 2c20 7365 6564 3d31 2c6e  amma=1, seed=1,n
+0003cd60: 5f6a 6f62 733d 2d31 2c72 616e 646f 6d5f  _jobs=-1,random_
+0003cd70: 7374 6174 653d 3129 0d0a 2020 2020 2020  state=1)..      
+0003cd80: 2020 2020 2020 2020 2020 2020 2020 7867                xg
+0003cd90: 626d 2e73 6574 5f70 6172 616d 7328 2a2a  bm.set_params(**
+0003cda0: 7061 7261 6d29 0d0a 2020 2020 2020 2020  param)..        
+0003cdb0: 656c 6966 2042 6f6f 7374 696e 675f 466c  elif Boosting_Fl
+0003cdc0: 6167 2069 7320 4e6f 6e65 3a0d 0a20 2020  ag is None:..   
+0003cdd0: 2020 2020 2020 2020 2023 7867 626d 203d           #xgbm =
+0003cde0: 204c 6173 736f 286d 6178 5f69 7465 723d   Lasso(max_iter=
+0003cdf0: 6d61 785f 6974 6572 2c72 616e 646f 6d5f  max_iter,random_
+0003ce00: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
+0003ce10: 2020 2020 2020 2020 2023 7867 626d 203d           #xgbm =
+0003ce20: 204c 6173 736f 286d 6178 5f69 7465 723d   Lasso(max_iter=
+0003ce30: 6d61 785f 6974 6572 2c72 616e 646f 6d5f  max_iter,random_
+0003ce40: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
+0003ce50: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+0003ce60: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+0003ce70: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+0003ce80: 2020 2020 2020 2020 2020 2020 7867 626d              xgbm
+0003ce90: 203d 204c 696e 6561 7253 5652 2865 7073   = LinearSVR(eps
+0003cea0: 696c 6f6e 3d30 2e30 2c20 746f 6c3d 302e  ilon=0.0, tol=0.
+0003ceb0: 3030 312c 2043 3d31 2e30 2c6d 6178 5f69  001, C=1.0,max_i
+0003cec0: 7465 723d 6d61 785f 6974 6572 2c20 7261  ter=max_iter, ra
+0003ced0: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
+0003cee0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003cef0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003cf00: 2020 2020 2078 6762 6d20 3d20 4b4e 6569       xgbm = KNei
+0003cf10: 6768 626f 7273 5265 6772 6573 736f 7228  ghborsRegressor(
+0003cf20: 6e5f 6e65 6967 6862 6f72 733d 352c 2077  n_neighbors=5, w
+0003cf30: 6569 6768 7473 203d 2027 6469 7374 616e  eights = 'distan
+0003cf40: 6365 2729 2023 2323 2064 6f6e 2774 2075  ce') ### don't u
+0003cf50: 7365 206e 5f6a 6f62 733d 2d31 2067 6976  se n_jobs=-1 giv
+0003cf60: 6573 2065 7272 6f72 2121 0d0a 2020 2020  es error!!..    
+0003cf70: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+0003cf80: 206e 5f6a 6f62 7320 3d20 4e6f 6e65 2069   n_jobs = None i
+0003cf90: 6e20 6361 7365 206f 6620 4b4e 4e20 7369  n case of KNN si
+0003cfa0: 6e63 6520 6974 2067 6976 6573 2065 7272  nce it gives err
+0003cfb0: 6f72 2069 6620 796f 7520 7573 6520 2d31  or if you use -1
+0003cfc0: 2061 6e79 7768 6572 6520 696e 2074 6865   anywhere in the
+0003cfd0: 2070 726f 6365 7373 0d0a 2020 2020 2020   process..      
+0003cfe0: 2020 2020 2020 2020 2020 6e5f 6a6f 6273            n_jobs
+0003cff0: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
+0003d000: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0003d010: 2020 2020 7867 626d 203d 2052 616e 646f      xgbm = Rando
+0003d020: 6d46 6f72 6573 7452 6567 7265 7373 6f72  mForestRegressor
+0003d030: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0003d040: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0003d050: 2a7b 0d0a 2020 2020 2020 2020 2020 2020  *{..            
+0003d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d070: 2762 6f6f 7473 7472 6170 273a 2062 6f6f  'bootstrap': boo
+0003d080: 7473 7472 6170 2c20 276e 5f6a 6f62 7327  tstrap, 'n_jobs'
+0003d090: 3a20 2d31 2c20 2777 6172 6d5f 7374 6172  : -1, 'warm_star
+0003d0a0: 7427 3a20 7761 726d 5f73 7461 7274 2c0d  t': warm_start,.
+0003d0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d0c0: 2020 2020 2020 2020 2020 2020 2027 7261               'ra
+0003d0d0: 6e64 6f6d 5f73 7461 7465 273a 7365 6564  ndom_state':seed
+0003d0e0: 2c27 6d69 6e5f 7361 6d70 6c65 735f 6c65  ,'min_samples_le
+0003d0f0: 6166 273a 322c 0d0a 2020 2020 2020 2020  af':2,..        
+0003d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d110: 2020 2020 276d 6178 5f66 6561 7475 7265      'max_feature
+0003d120: 7327 3a20 2273 7172 7422 0d0a 2020 2020  s': "sqrt"..    
+0003d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d140: 2020 2020 2020 2020 7d29 0d0a 2020 2020          })..    
+0003d150: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
+0003d160: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
+0003d170: 4269 6e61 7279 2043 6c61 7373 6966 6963  Binary Classific
+0003d180: 6174 696f 6e20 2323 2323 2323 2323 2323  ation ##########
+0003d190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003d1a0: 2323 2323 0d0a 2020 2020 2020 2020 636c  ####..        cl
+0003d1b0: 6173 7365 7320 3d20 6c61 6265 6c5f 6469  asses = label_di
+0003d1c0: 6374 5b65 6163 685f 7461 7267 6574 5d5b  ct[each_target][
+0003d1d0: 2763 6c61 7373 6573 275d 0d0a 2020 2020  'classes']..    
+0003d1e0: 2020 2020 6d65 7472 6963 735f 6c69 7374      metrics_list
+0003d1f0: 203d 205b 2761 6363 7572 6163 795f 7363   = ['accuracy_sc
+0003d200: 6f72 6527 2c27 726f 635f 6175 635f 7363  ore','roc_auc_sc
+0003d210: 6f72 6527 2c27 6c6f 676c 6f73 7327 2c20  ore','logloss', 
+0003d220: 2770 7265 6369 7369 6f6e 272c 2772 6563  'precision','rec
+0003d230: 616c 6c27 2c27 6631 275d 0d0a 2020 2020  all','f1']..    
+0003d240: 2020 2020 2320 4372 6561 7465 2072 6567      # Create reg
+0003d250: 756c 6172 697a 6174 696f 6e20 6879 7065  ularization hype
+0003d260: 7270 6172 616d 6574 6572 2064 6973 7472  rparameter distr
+0003d270: 6962 7574 696f 6e20 7769 7468 2035 3020  ibution with 50 
+0003d280: 4320 7661 6c75 6573 2023 2323 230d 0a20  C values ####.. 
+0003d290: 2020 2020 2020 2069 6620 6879 7065 725f         if hyper_
+0003d2a0: 7061 7261 6d20 3d3d 2027 4753 273a 0d0a  param == 'GS':..
+0003d2b0: 2020 2020 2020 2020 2020 2020 635f 7061              c_pa
+0003d2c0: 7261 6d73 5b27 5847 426f 6f73 7427 5d20  rams['XGBoost'] 
+0003d2d0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+0003d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d2f0: 2020 2020 2020 2020 2027 6c65 6172 6e69           'learni
+0003d300: 6e67 5f72 6174 6527 3a20 6e70 2e6c 696e  ng_rate': np.lin
+0003d310: 7370 6163 6528 302e 312c 302e 352c 3529  space(0.1,0.5,5)
+0003d320: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d340: 2020 2020 2020 2027 6761 6d6d 6127 3a20         'gamma': 
+0003d350: 6e70 2e6c 696e 7370 6163 6528 302c 2033  np.linspace(0, 3
+0003d360: 322c 3729 2e61 7374 7970 6528 696e 7429  2,7).astype(int)
+0003d370: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d390: 2020 2020 2020 2022 6d61 785f 6465 7074         "max_dept
+0003d3a0: 6822 3a20 5b33 2c20 352c 206d 6178 5f64  h": [3, 5, max_d
+0003d3b0: 6570 7468 5d2c 0d0a 2020 2020 2020 2020  epth],..        
+0003d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d3d0: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
+0003d3e0: 2020 2020 2020 2063 5f70 6172 616d 735b         c_params[
+0003d3f0: 2243 6174 426f 6f73 7422 5d20 3d20 7b0d  "CatBoost"] = {.
+0003d400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d410: 2020 2020 2020 2020 2020 2020 2027 6c65               'le
+0003d420: 6172 6e69 6e67 5f72 6174 6527 3a20 6e70  arning_rate': np
+0003d430: 2e6c 6f67 7370 6163 6528 416c 7068 615f  .logspace(Alpha_
+0003d440: 6d69 6e2c 416c 7068 615f 6d61 782c 3430  min,Alpha_max,40
+0003d450: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
 0003d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d470: 2020 2020 2020 2020 2743 273a 2043 732c          'C': Cs,
-0003d480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d490: 2020 2020 2020 2020 2020 2020 2020 2773                's
-0003d4a0: 6f6c 7665 7227 203a 2073 6f6c 7665 7273  olver' : solvers
-0003d4b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003d4c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0003d4d0: 7065 6e61 6c74 7927 203a 2070 656e 616c  penalty' : penal
-0003d4e0: 7469 6573 2c0d 0a20 2020 2020 2020 2020  ties,..         
+0003d470: 7d0d 0a20 2020 2020 2020 2020 2020 2069  }..            i
+0003d480: 6620 496d 6261 6c61 6e63 6564 5f46 6c61  f Imbalanced_Fla
+0003d490: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+0003d4a0: 2020 2020 635f 7061 7261 6d73 5b27 4c69      c_params['Li
+0003d4b0: 6e65 6172 275d 203d 207b 0d0a 2020 2020  near'] = {..    
+0003d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d4d0: 2020 2020 2020 2020 2020 2020 2743 273a              'C':
+0003d4e0: 2043 732c 0d0a 2020 2020 2020 2020 2020   Cs,..          
 0003d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d500: 2020 2027 636c 6173 735f 7765 6967 6874     'class_weight
-0003d510: 273a 5b4e 6f6e 652c 2027 6261 6c61 6e63  ':[None, 'balanc
-0003d520: 6564 275d 2c0d 0a20 2020 2020 2020 2020  ed'],..         
-0003d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d540: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-0003d550: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0003d560: 2020 2020 2020 2020 2020 2020 2063 5f70               c_p
-0003d570: 6172 616d 735b 274c 696e 6561 7227 5d20  arams['Linear'] 
-0003d580: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+0003d500: 2020 2773 6f6c 7665 7227 203a 2073 6f6c    'solver' : sol
+0003d510: 7665 7273 2c0d 0a20 2020 2020 2020 2020  vers,..         
+0003d520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d530: 2020 2027 7065 6e61 6c74 7927 203a 2070     'penalty' : p
+0003d540: 656e 616c 7469 6573 2c0d 0a20 2020 2020  enalties,..     
+0003d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d560: 2020 2020 2020 2027 636c 6173 735f 7765         'class_we
+0003d570: 6967 6874 273a 5b4e 6f6e 652c 2027 6261  ight':[None, 'ba
+0003d580: 6c61 6e63 6564 275d 2c0d 0a20 2020 2020  lanced'],..     
 0003d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d5a0: 2020 2020 2027 4327 3a20 4373 2c0d 0a20       'C': Cs,.. 
-0003d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d5c0: 2020 2020 2020 2020 2020 2027 636c 6173             'clas
-0003d5d0: 735f 7765 6967 6874 273a 5b4e 6f6e 652c  s_weight':[None,
-0003d5e0: 2027 6261 6c61 6e63 6564 275d 2c0d 0a20   'balanced'],.. 
+0003d5a0: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
+0003d5b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0003d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d5d0: 2063 5f70 6172 616d 735b 274c 696e 6561   c_params['Linea
+0003d5e0: 7227 5d20 3d20 7b0d 0a20 2020 2020 2020  r'] = {..       
 0003d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d600: 2020 2020 2020 2020 2020 2027 7065 6e61             'pena
-0003d610: 6c74 7927 203a 2070 656e 616c 7469 6573  lty' : penalties
-0003d620: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d640: 2020 2027 736f 6c76 6572 2720 3a20 736f     'solver' : so
-0003d650: 6c76 6572 732c 0d0a 2020 2020 2020 2020  lvers,..        
-0003d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d670: 2020 2020 2020 2020 2020 2020 7d0d 0a20              }.. 
-0003d680: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
-0003d690: 616d 735b 2246 6f72 6573 7473 225d 203d  ams["Forests"] =
-0003d6a0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-0003d6b0: 2020 2020 2323 2323 2320 4920 6861 7665      ##### I have
-0003d6c0: 2073 656c 6563 7465 6420 7468 6573 6520   selected these 
-0003d6d0: 746f 2061 766f 6964 204f 7665 7266 6974  to avoid Overfit
-0003d6e0: 7469 6e67 2077 6869 6368 2069 7320 6120  ting which is a 
-0003d6f0: 7072 6f62 6c65 6d20 666f 7220 736d 616c  problem for smal
-0003d700: 6c20 6461 7461 2073 6574 730d 0a20 2020  l data sets..   
-0003d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d720: 2020 2020 2020 2020 2022 6e5f 6573 7469           "n_esti
-0003d730: 6d61 746f 7273 2220 3a20 6e70 2e6c 696e  mators" : np.lin
-0003d740: 7370 6163 6528 3130 302c 206d 6178 5f65  space(100, max_e
-0003d750: 7374 696d 732c 206e 5f73 7465 7073 2c20  stims, n_steps, 
-0003d760: 6474 7970 6520 3d20 2269 6e74 2229 2c0d  dtype = "int"),.
+0003d600: 2020 2020 2020 2020 2027 4327 3a20 4373           'C': Cs
+0003d610: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003d620: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0003d630: 636c 6173 735f 7765 6967 6874 273a 5b4e  class_weight':[N
+0003d640: 6f6e 652c 2027 6261 6c61 6e63 6564 275d  one, 'balanced']
+0003d650: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003d660: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0003d670: 7065 6e61 6c74 7927 203a 2070 656e 616c  penalty' : penal
+0003d680: 7469 6573 2c0d 0a20 2020 2020 2020 2020  ties,..         
+0003d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d6a0: 2020 2020 2020 2027 736f 6c76 6572 2720         'solver' 
+0003d6b0: 3a20 736f 6c76 6572 732c 0d0a 2020 2020  : solvers,..    
+0003d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d6e0: 7d0d 0a20 2020 2020 2020 2020 2020 2063  }..            c
+0003d6f0: 5f70 6172 616d 735b 2246 6f72 6573 7473  _params["Forests
+0003d700: 225d 203d 207b 0d0a 2020 2020 2020 2020  "] = {..        
+0003d710: 2020 2020 2020 2020 2323 2323 2320 4920          ##### I 
+0003d720: 6861 7665 2073 656c 6563 7465 6420 7468  have selected th
+0003d730: 6573 6520 746f 2061 766f 6964 204f 7665  ese to avoid Ove
+0003d740: 7266 6974 7469 6e67 2077 6869 6368 2069  rfitting which i
+0003d750: 7320 6120 7072 6f62 6c65 6d20 666f 7220  s a problem for 
+0003d760: 736d 616c 6c20 6461 7461 2073 6574 730d  small data sets.
 0003d770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d790: 2022 6d61 785f 6465 7074 6822 3a20 5b33   "max_depth": [3
-0003d7a0: 2c20 352c 206d 6178 5f64 6570 7468 5d2c  , 5, max_depth],
-0003d7b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d7d0: 2020 2327 6d61 785f 6665 6174 7572 6573    #'max_features
-0003d7e0: 273a 205b 312c 322c 352c 206d 6178 5f66  ': [1,2,5, max_f
-0003d7f0: 6561 7475 7265 735d 2c0d 0a20 2020 2020  eatures],..     
-0003d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d810: 2020 2020 2020 2020 2020 2023 2263 7269             #"cri
-0003d820: 7465 7269 6f6e 223a 5b27 6769 6e69 272c  terion":['gini',
-0003d830: 2765 6e74 726f 7079 275d 2c0d 0a20 2020  'entropy'],..   
-0003d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d860: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-0003d870: 2020 2020 635f 7061 7261 6d73 5b22 4d75      c_params["Mu
-0003d880: 6c74 695f 4c61 6265 6c22 5d20 3d20 7b0d  lti_Label"] = {.
-0003d890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d8a0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0003d8b0: 6f72 5f73 7472 696e 672b 2743 273a 205b  or_string+'C': [
-0003d8c0: 3165 2d33 2c20 3165 2d32 2c20 3165 2d31  1e-3, 1e-2, 1e-1
-0003d8d0: 2c20 3165 302c 2031 6531 2c20 3165 322c  , 1e0, 1e1, 1e2,
-0003d8e0: 2031 6533 5d0d 0a20 2020 2020 2020 2020   1e3]..         
-0003d8f0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0003d900: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0003d910: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0003d920: 6f72 7420 7363 6970 7920 6173 2073 700d  ort scipy as sp.
-0003d930: 0a20 2020 2020 2020 2020 2020 2063 5f70  .            c_p
-0003d940: 6172 616d 735b 2758 4742 6f6f 7374 275d  arams['XGBoost']
-0003d950: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
-0003d960: 2020 2020 2020 2020 2020 276c 6561 726e            'learn
-0003d970: 696e 675f 7261 7465 273a 2073 702e 7374  ing_rate': sp.st
-0003d980: 6174 732e 756e 6966 6f72 6d28 7363 616c  ats.uniform(scal
-0003d990: 653d 3129 2c0d 0a20 2020 2020 2020 2020  e=1),..         
-0003d9a0: 2020 2020 2020 2020 2020 2027 6761 6d6d             'gamm
-0003d9b0: 6127 3a20 7370 2e73 7461 7473 2e72 616e  a': sp.stats.ran
-0003d9c0: 6469 6e74 2830 2c20 3332 292c 0d0a 2020  dint(0, 32),..  
-0003d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d9e0: 2027 6e5f 6573 7469 6d61 746f 7273 273a   'n_estimators':
-0003d9f0: 2073 702e 7374 6174 732e 7261 6e64 696e   sp.stats.randin
-0003da00: 7428 3130 302c 6d61 785f 6573 7469 6d73  t(100,max_estims
-0003da10: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0003da20: 2020 2020 2020 2020 226d 6178 5f64 6570          "max_dep
-0003da30: 7468 223a 2073 702e 7374 6174 732e 7261  th": sp.stats.ra
-0003da40: 6e64 696e 7428 332c 206d 6178 5f64 6570  ndint(3, max_dep
-0003da50: 7468 292c 0d0a 2020 2020 2020 2020 2020  th),..          
-0003da60: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
-0003da70: 2020 2020 2020 2063 5f70 6172 616d 735b         c_params[
-0003da80: 2243 6174 426f 6f73 7422 5d20 3d20 7b0d  "CatBoost"] = {.
-0003da90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003daa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dab0: 2027 6c65 6172 6e69 6e67 5f72 6174 6527   'learning_rate'
-0003dac0: 3a20 7370 2e73 7461 7473 2e75 6e69 666f  : sp.stats.unifo
-0003dad0: 726d 2873 6361 6c65 3d31 292c 0d0a 2020  rm(scale=1),..  
-0003dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003daf0: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
-0003db00: 2020 2020 2020 2020 2069 6620 496d 6261           if Imba
-0003db10: 6c61 6e63 6564 5f46 6c61 673a 0d0a 2020  lanced_Flag:..  
-0003db20: 2020 2020 2020 2020 2020 2020 2020 635f                c_
-0003db30: 7061 7261 6d73 5b27 4c69 6e65 6172 275d  params['Linear']
-0003db40: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
-0003db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003db60: 2020 2020 2020 2743 273a 2073 702e 7374        'C': sp.st
-0003db70: 6174 732e 756e 6966 6f72 6d2e 7276 7328  ats.uniform.rvs(
-0003db80: 6c6f 633d 302e 3031 2c73 6361 6c65 3d31  loc=0.01,scale=1
-0003db90: 302c 7369 7a65 3d31 3030 3029 2c0d 0a20  0,size=1000),.. 
-0003dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dbb0: 2020 2020 2020 2020 2020 2027 736f 6c76             'solv
-0003dbc0: 6572 2720 3a20 736f 6c76 6572 732c 0d0a  er' : solvers,..
-0003dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dbe0: 2020 2020 2020 2020 2020 2020 2770 656e              'pen
-0003dbf0: 616c 7479 2720 3a20 7065 6e61 6c74 6965  alty' : penaltie
-0003dc00: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-0003dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc20: 2327 636c 6173 735f 7765 6967 6874 273a  #'class_weight':
-0003dc30: 5b4e 6f6e 652c 2027 6261 6c61 6e63 6564  [None, 'balanced
-0003dc40: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
-0003dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc60: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-0003dc70: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0003dc80: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
-0003dc90: 616d 735b 274c 696e 6561 7227 5d20 3d20  ams['Linear'] = 
-0003dca0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
+0003d780: 2020 2020 2020 2020 2020 2020 2022 6e5f               "n_
+0003d790: 6573 7469 6d61 746f 7273 2220 3a20 6e70  estimators" : np
+0003d7a0: 2e6c 696e 7370 6163 6528 3130 302c 206d  .linspace(100, m
+0003d7b0: 6178 5f65 7374 696d 732c 206e 5f73 7465  ax_estims, n_ste
+0003d7c0: 7073 2c20 6474 7970 6520 3d20 2269 6e74  ps, dtype = "int
+0003d7d0: 2229 2c0d 0a20 2020 2020 2020 2020 2020  "),..           
+0003d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d7f0: 2020 2020 2022 6d61 785f 6465 7074 6822       "max_depth"
+0003d800: 3a20 5b33 2c20 352c 206d 6178 5f64 6570  : [3, 5, max_dep
+0003d810: 7468 5d2c 0d0a 2020 2020 2020 2020 2020  th],..          
+0003d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d830: 2020 2020 2020 2327 6d61 785f 6665 6174        #'max_feat
+0003d840: 7572 6573 273a 205b 312c 322c 352c 206d  ures': [1,2,5, m
+0003d850: 6178 5f66 6561 7475 7265 735d 2c0d 0a20  ax_features],.. 
+0003d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d870: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003d880: 2263 7269 7465 7269 6f6e 223a 5b27 6769  "criterion":['gi
+0003d890: 6e69 272c 2765 6e74 726f 7079 275d 2c0d  ni','entropy'],.
+0003d8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d8c0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+0003d8d0: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
+0003d8e0: 5b22 4d75 6c74 695f 4c61 6265 6c22 5d20  ["Multi_Label"] 
+0003d8f0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+0003d900: 2020 2020 2020 2020 2020 2020 2065 7374               est
+0003d910: 696d 6174 6f72 5f73 7472 696e 672b 2743  imator_string+'C
+0003d920: 273a 205b 3165 2d33 2c20 3165 2d32 2c20  ': [1e-3, 1e-2, 
+0003d930: 3165 2d31 2c20 3165 302c 2031 6531 2c20  1e-1, 1e0, 1e1, 
+0003d940: 3165 322c 2031 6533 5d0d 0a20 2020 2020  1e2, 1e3]..     
+0003d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d960: 2020 207d 0d0a 2020 2020 2020 2020 656c     }..        el
+0003d970: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003d980: 2069 6d70 6f72 7420 7363 6970 7920 6173   import scipy as
+0003d990: 2073 700d 0a20 2020 2020 2020 2020 2020   sp..           
+0003d9a0: 2063 5f70 6172 616d 735b 2758 4742 6f6f   c_params['XGBoo
+0003d9b0: 7374 275d 203d 207b 0d0a 2020 2020 2020  st'] = {..      
+0003d9c0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+0003d9d0: 6561 726e 696e 675f 7261 7465 273a 2073  earning_rate': s
+0003d9e0: 702e 7374 6174 732e 756e 6966 6f72 6d28  p.stats.uniform(
+0003d9f0: 7363 616c 653d 3129 2c0d 0a20 2020 2020  scale=1),..     
+0003da00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0003da10: 6761 6d6d 6127 3a20 7370 2e73 7461 7473  gamma': sp.stats
+0003da20: 2e72 616e 6469 6e74 2830 2c20 3332 292c  .randint(0, 32),
+0003da30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003da40: 2020 2020 2027 6e5f 6573 7469 6d61 746f       'n_estimato
+0003da50: 7273 273a 2073 702e 7374 6174 732e 7261  rs': sp.stats.ra
+0003da60: 6e64 696e 7428 3130 302c 6d61 785f 6573  ndint(100,max_es
+0003da70: 7469 6d73 292c 0d0a 2020 2020 2020 2020  tims),..        
+0003da80: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+0003da90: 5f64 6570 7468 223a 2073 702e 7374 6174  _depth": sp.stat
+0003daa0: 732e 7261 6e64 696e 7428 332c 206d 6178  s.randint(3, max
+0003dab0: 5f64 6570 7468 292c 0d0a 2020 2020 2020  _depth),..      
+0003dac0: 2020 2020 2020 2020 2020 2020 7d0d 0a20              }.. 
+0003dad0: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
+0003dae0: 616d 735b 2243 6174 426f 6f73 7422 5d20  ams["CatBoost"] 
+0003daf0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+0003db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003db10: 2020 2020 2027 6c65 6172 6e69 6e67 5f72       'learning_r
+0003db20: 6174 6527 3a20 7370 2e73 7461 7473 2e75  ate': sp.stats.u
+0003db30: 6e69 666f 726d 2873 6361 6c65 3d31 292c  niform(scale=1),
+0003db40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003db50: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
+0003db60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003db70: 496d 6261 6c61 6e63 6564 5f46 6c61 673a  Imbalanced_Flag:
+0003db80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003db90: 2020 635f 7061 7261 6d73 5b27 4c69 6e65    c_params['Line
+0003dba0: 6172 275d 203d 207b 0d0a 2020 2020 2020  ar'] = {..      
+0003dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dbc0: 2020 2020 2020 2020 2020 2743 273a 2073            'C': s
+0003dbd0: 702e 7374 6174 732e 756e 6966 6f72 6d2e  p.stats.uniform.
+0003dbe0: 7276 7328 6c6f 633d 302e 3031 2c73 6361  rvs(loc=0.01,sca
+0003dbf0: 6c65 3d31 302c 7369 7a65 3d31 3030 3029  le=10,size=1000)
+0003dc00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003dc10: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0003dc20: 736f 6c76 6572 2720 3a20 736f 6c76 6572  solver' : solver
+0003dc30: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+0003dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dc50: 2770 656e 616c 7479 2720 3a20 7065 6e61  'penalty' : pena
+0003dc60: 6c74 6965 732c 0d0a 2020 2020 2020 2020  lties,..        
+0003dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dc80: 2020 2020 2327 636c 6173 735f 7765 6967      #'class_weig
+0003dc90: 6874 273a 5b4e 6f6e 652c 2027 6261 6c61  ht':[None, 'bala
+0003dca0: 6e63 6564 275d 2c0d 0a20 2020 2020 2020  nced'],..       
 0003dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dcc0: 2020 2027 4327 3a20 7370 2e73 7461 7473     'C': sp.stats
-0003dcd0: 2e75 6e69 666f 726d 2e72 7673 286c 6f63  .uniform.rvs(loc
-0003dce0: 3d30 2e30 312c 7363 616c 653d 3130 2c73  =0.01,scale=10,s
-0003dcf0: 697a 653d 3130 3030 292c 0d0a 2020 2020  ize=1000),..    
-0003dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd10: 2020 2020 2020 2020 2020 2020 2770 656e              'pen
-0003dd20: 616c 7479 2720 3a20 7065 6e61 6c74 6965  alty' : penaltie
-0003dd30: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-0003dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd50: 2020 2020 2773 6f6c 7665 7227 203a 2073      'solver' : s
-0003dd60: 6f6c 7665 7273 2c0d 0a20 2020 2020 2020  olvers,..       
+0003dcc0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+0003dcd0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0003dce0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003dcf0: 5f70 6172 616d 735b 274c 696e 6561 7227  _params['Linear'
+0003dd00: 5d20 3d20 7b0d 0a20 2020 2020 2020 2020  ] = {..         
+0003dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dd20: 2020 2020 2020 2027 4327 3a20 7370 2e73         'C': sp.s
+0003dd30: 7461 7473 2e75 6e69 666f 726d 2e72 7673  tats.uniform.rvs
+0003dd40: 286c 6f63 3d30 2e30 312c 7363 616c 653d  (loc=0.01,scale=
+0003dd50: 3130 2c73 697a 653d 3130 3030 292c 0d0a  10,size=1000),..
+0003dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd80: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
-0003dd90: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
-0003dda0: 5b22 466f 7265 7374 7322 5d20 3d20 7b0d  ["Forests"] = {.
-0003ddb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ddc0: 2023 2323 2323 2049 2068 6176 6520 7365   ##### I have se
-0003ddd0: 6c65 6374 6564 2074 6865 7365 2074 6f20  lected these to 
-0003dde0: 6176 6f69 6420 4f76 6572 6669 7474 696e  avoid Overfittin
-0003ddf0: 6720 7768 6963 6820 6973 2061 2070 726f  g which is a pro
-0003de00: 626c 656d 2066 6f72 2073 6d61 6c6c 2064  blem for small d
-0003de10: 6174 6120 7365 7473 0d0a 2020 2020 2020  ata sets..      
-0003de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003de30: 2020 2020 2020 2020 2027 6e5f 6573 7469           'n_esti
-0003de40: 6d61 746f 7273 273a 2073 702e 7374 6174  mators': sp.stat
-0003de50: 732e 7261 6e64 696e 7428 3130 302c 6d61  s.randint(100,ma
-0003de60: 785f 6573 7469 6d73 292c 0d0a 2020 2020  x_estims),..    
-0003de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003de80: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-0003de90: 5f64 6570 7468 223a 2073 702e 7374 6174  _depth": sp.stat
-0003dea0: 732e 7261 6e64 696e 7428 332c 206d 6178  s.randint(3, max
-0003deb0: 5f64 6570 7468 292c 0d0a 2020 2020 2020  _depth),..      
-0003dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ded0: 2020 2020 2020 2020 2020 226d 696e 5f73            "min_s
-0003dee0: 616d 706c 6573 5f6c 6561 6622 3a20 7370  amples_leaf": sp
-0003def0: 2e73 7461 7473 2e72 616e 6469 6e74 2832  .stats.randint(2
-0003df00: 2c20 3230 292c 0d0a 2020 2020 2020 2020  , 20),..        
-0003df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df20: 2020 2020 2020 2020 2322 6372 6974 6572          #"criter
-0003df30: 696f 6e22 3a5b 2767 696e 6927 2c27 656e  ion":['gini','en
-0003df40: 7472 6f70 7927 5d2c 0d0a 2020 2020 2020  tropy'],..      
-0003df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df60: 2020 2020 2020 2020 2020 2327 6d61 785f            #'max_
-0003df70: 6665 6174 7572 6573 273a 205b 276c 6f67  features': ['log
-0003df80: 272c 2022 7371 7274 225d 202c 0d0a 2020  ', "sqrt"] ,..  
-0003df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dfa0: 2020 2020 2020 2020 2020 2020 2020 2327                #'
-0003dfb0: 636c 6173 735f 7765 6967 6874 273a 5b4e  class_weight':[N
-0003dfc0: 6f6e 652c 2762 616c 616e 6365 6427 5d0d  one,'balanced'].
-0003dfd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dff0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
-0003e000: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
-0003e010: 5b22 4d75 6c74 695f 4c61 6265 6c22 5d20  ["Multi_Label"] 
-0003e020: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
-0003e030: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0003e040: 2074 6869 7320 6973 2074 6865 2062 6573   this is the bes
-0003e050: 7420 7061 7261 6d73 2066 6f72 206c 6f67  t params for log
-0003e060: 6973 7469 6320 7265 6772 6573 7369 6f6e  istic regression
-0003e070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e080: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0003e090: 746f 725f 7374 7269 6e67 2b27 4327 3a20  tor_string+'C': 
-0003e0a0: 7370 2e73 7461 7473 2e75 6e69 666f 726d  sp.stats.uniform
-0003e0b0: 2e72 7673 286c 6f63 3d30 2e30 312c 7363  .rvs(loc=0.01,sc
-0003e0c0: 616c 653d 3130 2c73 697a 653d 3130 3030  ale=10,size=1000
-0003e0d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003e0e0: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
-0003e0f0: 2020 2020 2020 2320 4372 6561 7465 2072        # Create r
-0003e100: 6567 756c 6172 697a 6174 696f 6e20 6879  egularization hy
-0003e110: 7065 7270 6172 616d 6574 6572 2064 6973  perparameter dis
-0003e120: 7472 6962 7574 696f 6e20 7573 696e 6720  tribution using 
-0003e130: 756e 6966 6f72 6d20 6469 7374 7269 6275  uniform distribu
-0003e140: 7469 6f6e 0d0a 2020 2020 2020 2020 6966  tion..        if
-0003e150: 206c 656e 2863 6c61 7373 6573 2920 3d3d   len(classes) ==
-0003e160: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
-0003e170: 206f 626a 6563 7469 7665 203d 2027 6269   objective = 'bi
-0003e180: 6e61 7279 3a6c 6f67 6973 7469 6327 0d0a  nary:logistic'..
-0003e190: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0003e1a0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003e1b0: 203d 3d20 2761 6363 7572 6163 7927 206f   == 'accuracy' o
-0003e1c0: 7220 7363 6f72 696e 675f 7061 7261 6d65  r scoring_parame
-0003e1d0: 7465 7220 3d3d 2027 6163 6375 7261 6379  ter == 'accuracy
-0003e1e0: 5f73 636f 7265 273a 0d0a 2020 2020 2020  _score':..      
-0003e1f0: 2020 2020 2020 2020 2020 6163 6375 7261            accura
-0003e200: 6379 5f73 636f 7265 7220 3d20 6d61 6b65  cy_scorer = make
-0003e210: 5f73 636f 7265 7228 6769 6e69 5f61 6363  _scorer(gini_acc
-0003e220: 7572 6163 792c 2067 7265 6174 6572 5f69  uracy, greater_i
-0003e230: 735f 6265 7474 6572 3d54 7275 652c 206e  s_better=True, n
-0003e240: 6565 6473 5f70 726f 6261 3d46 616c 7365  eeds_proba=False
-0003e250: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003e260: 2020 2073 636f 7265 7220 3d61 6363 7572     scorer =accur
-0003e270: 6163 795f 7363 6f72 6572 0d0a 2020 2020  acy_scorer..    
-0003e280: 2020 2020 2020 2020 656c 6966 2073 636f          elif sco
-0003e290: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
-0003e2a0: 3d20 2767 696e 6927 3a0d 0a20 2020 2020  = 'gini':..     
-0003e2b0: 2020 2020 2020 2020 2020 2067 696e 695f             gini_
-0003e2c0: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
-0003e2d0: 6f72 6572 2867 696e 695f 736b 6c65 6172  orer(gini_sklear
-0003e2e0: 6e2c 2067 7265 6174 6572 5f69 735f 6265  n, greater_is_be
-0003e2f0: 7474 6572 3d46 616c 7365 2c20 6e65 6564  tter=False, need
-0003e300: 735f 7072 6f62 613d 5472 7565 290d 0a20  s_proba=True).. 
-0003e310: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003e320: 636f 7265 7220 3d67 696e 695f 7363 6f72  corer =gini_scor
-0003e330: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
-0003e340: 656c 6966 2073 636f 7269 6e67 5f70 6172  elif scoring_par
-0003e350: 616d 6574 6572 203d 3d20 2761 7563 2720  ameter == 'auc' 
-0003e360: 6f72 2073 636f 7269 6e67 5f70 6172 616d  or scoring_param
-0003e370: 6574 6572 203d 3d20 2772 6f63 5f61 7563  eter == 'roc_auc
-0003e380: 2720 6f72 2073 636f 7269 6e67 5f70 6172  ' or scoring_par
-0003e390: 616d 6574 6572 203d 3d20 2772 6f63 5f61  ameter == 'roc_a
-0003e3a0: 7563 5f73 636f 7265 273a 0d0a 2020 2020  uc_score':..    
-0003e3b0: 2020 2020 2020 2020 2020 2020 726f 635f              roc_
-0003e3c0: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
-0003e3d0: 6f72 6572 2867 696e 695f 726f 632c 2067  orer(gini_roc, g
-0003e3e0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-0003e3f0: 3d54 7275 652c 206e 6565 6473 5f74 6872  =True, needs_thr
-0003e400: 6573 686f 6c64 3d54 7275 6529 0d0a 2020  eshold=True)..  
-0003e410: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0003e420: 6f72 6572 203d 726f 635f 7363 6f72 6572  orer =roc_scorer
-0003e430: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003e440: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
-0003e450: 6574 6572 2069 6e20 5b27 6c6f 675f 6c6f  eter in ['log_lo
-0003e460: 7373 272c 276c 6f67 6c6f 7373 272c 276e  ss','logloss','n
-0003e470: 6567 5f6c 6f67 5f6c 6f73 7327 2c27 6c6f  eg_log_loss','lo
-0003e480: 672d 6c6f 7373 275d 3a0d 0a20 2020 2020  g-loss']:..     
-0003e490: 2020 2020 2020 2020 2020 2073 636f 7269             scori
-0003e4a0: 6e67 5f70 6172 616d 6574 6572 203d 2027  ng_parameter = '
-0003e4b0: 6e65 675f 6c6f 675f 6c6f 7373 270d 0a20  neg_log_loss'.. 
-0003e4c0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003e4d0: 6f67 6c6f 7373 5f73 636f 7265 7220 3d20  ogloss_scorer = 
-0003e4e0: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-0003e4f0: 5f6c 6f67 5f6c 6f73 732c 2067 7265 6174  _log_loss, great
-0003e500: 6572 5f69 735f 6265 7474 6572 3d46 616c  er_is_better=Fal
-0003e510: 7365 2c20 6e65 6564 735f 7072 6f62 613d  se, needs_proba=
-0003e520: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-0003e530: 2020 2020 2020 2020 7363 6f72 6572 203d          scorer =
-0003e540: 6c6f 676c 6f73 735f 7363 6f72 6572 0d0a  logloss_scorer..
-0003e550: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0003e560: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-0003e570: 6572 3d3d 2762 616c 616e 6365 645f 6163  er=='balanced_ac
-0003e580: 6375 7261 6379 2720 6f72 2073 636f 7269  curacy' or scori
-0003e590: 6e67 5f70 6172 616d 6574 6572 3d3d 2762  ng_parameter=='b
-0003e5a0: 616c 616e 6365 642d 6163 6375 7261 6379  alanced-accuracy
-0003e5b0: 2720 6f72 2073 636f 7269 6e67 5f70 6172  ' or scoring_par
-0003e5c0: 616d 6574 6572 3d3d 2761 7665 7261 6765  ameter=='average
-0003e5d0: 5f61 6363 7572 6163 7927 3a0d 0a20 2020  _accuracy':..   
-0003e5e0: 2020 2020 2020 2020 2020 2020 2062 616c               bal
-0003e5f0: 5f61 6363 7572 6163 795f 7363 6f72 6572  _accuracy_scorer
-0003e600: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
-0003e610: 696e 695f 6261 6c5f 6163 6375 7261 6379  ini_bal_accuracy
-0003e620: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
-0003e630: 7465 723d 5472 7565 2c0d 0a20 2020 2020  ter=True,..     
-0003e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e670: 2020 2020 2020 2020 2020 2020 206e 6565               nee
-0003e680: 6473 5f70 726f 6261 3d46 616c 7365 290d  ds_proba=False).
-0003e690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e6a0: 2073 636f 7265 7220 3d20 6261 6c5f 6163   scorer = bal_ac
-0003e6b0: 6375 7261 6379 5f73 636f 7265 720d 0a20  curacy_scorer.. 
-0003e6c0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0003e6d0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-0003e6e0: 7220 3d3d 2027 7072 6563 6973 696f 6e27  r == 'precision'
-0003e6f0: 206f 7220 7363 6f72 696e 675f 7061 7261   or scoring_para
-0003e700: 6d65 7465 7220 3d3d 2027 7072 6563 6973  meter == 'precis
-0003e710: 696f 6e5f 7363 6f72 6527 3a0d 0a20 2020  ion_score':..   
-0003e720: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-0003e730: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
-0003e740: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-0003e750: 5f70 7265 6369 7369 6f6e 2c20 6772 6561  _precision, grea
-0003e760: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-0003e770: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-0003e780: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0003e790: 2020 2020 2020 2020 2020 2020 706f 735f              pos_
-0003e7a0: 6c61 6265 6c3d 7261 7265 5f63 6c61 7373  label=rare_class
-0003e7b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003e7c0: 2020 2073 636f 7265 7220 3d70 7265 6369     scorer =preci
-0003e7d0: 7369 6f6e 5f73 636f 7265 720d 0a20 2020  sion_scorer..   
-0003e7e0: 2020 2020 2020 2020 2065 6c69 6620 7363           elif sc
-0003e7f0: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
-0003e800: 3d3d 2027 7265 6361 6c6c 2720 6f72 2073  == 'recall' or s
-0003e810: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003e820: 203d 3d20 2772 6563 616c 6c5f 7363 6f72   == 'recall_scor
-0003e830: 6527 3a0d 0a20 2020 2020 2020 2020 2020  e':..           
-0003e840: 2020 2020 2072 6563 616c 6c5f 7363 6f72       recall_scor
-0003e850: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-0003e860: 2867 696e 695f 7265 6361 6c6c 2c20 6772  (gini_recall, gr
-0003e870: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
-0003e880: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
-0003e890: 613d 4661 6c73 652c 0d0a 2020 2020 2020  a=False,..      
-0003e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e8b0: 2020 706f 735f 6c61 6265 6c3d 7261 7265    pos_label=rare
-0003e8c0: 5f63 6c61 7373 290d 0a20 2020 2020 2020  _class)..       
-0003e8d0: 2020 2020 2020 2020 2073 636f 7265 7220           scorer 
-0003e8e0: 3d72 6563 616c 6c5f 7363 6f72 6572 0d0a  =recall_scorer..
-0003e8f0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0003e900: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-0003e910: 6572 203d 3d20 2766 3127 206f 7220 7363  er == 'f1' or sc
-0003e920: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
-0003e930: 3d3d 2027 6631 5f73 636f 7265 273a 0d0a  == 'f1_score':..
-0003e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e950: 6631 5f73 636f 7265 7220 3d20 6d61 6b65  f1_scorer = make
-0003e960: 5f73 636f 7265 7228 6769 6e69 5f66 312c  _scorer(gini_f1,
-0003e970: 2067 7265 6174 6572 5f69 735f 6265 7474   greater_is_bett
-0003e980: 6572 3d54 7275 652c 206e 6565 6473 5f70  er=True, needs_p
-0003e990: 726f 6261 3d46 616c 7365 2c0d 0a20 2020  roba=False,..   
-0003e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e9b0: 2020 2020 2070 6f73 5f6c 6162 656c 3d72       pos_label=r
-0003e9c0: 6172 655f 636c 6173 7329 0d0a 2020 2020  are_class)..    
-0003e9d0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-0003e9e0: 6572 203d 6631 5f73 636f 7265 720d 0a20  er =f1_scorer.. 
-0003e9f0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0003ea00: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-0003ea10: 7220 3d3d 2027 6632 2720 6f72 2073 636f  r == 'f2' or sco
-0003ea20: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
-0003ea30: 3d20 2766 325f 7363 6f72 6527 3a0d 0a20  = 'f2_score':.. 
-0003ea40: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0003ea50: 325f 7363 6f72 6572 203d 206d 616b 655f  2_scorer = make_
-0003ea60: 7363 6f72 6572 2866 325f 6d65 6173 7572  scorer(f2_measur
-0003ea70: 652c 2067 7265 6174 6572 5f69 735f 6265  e, greater_is_be
-0003ea80: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-0003ea90: 5f70 726f 6261 3d46 616c 7365 290d 0a20  _proba=False).. 
-0003eaa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003eab0: 636f 7265 7220 3d66 325f 7363 6f72 6572  corer =f2_scorer
-0003eac0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003ead0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003eae0: 2020 2020 206c 6f67 6c6f 7373 5f73 636f       logloss_sco
-0003eaf0: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
-0003eb00: 7228 6769 6e69 5f6c 6f67 5f6c 6f73 732c  r(gini_log_loss,
-0003eb10: 2067 7265 6174 6572 5f69 735f 6265 7474   greater_is_bett
-0003eb20: 6572 3d46 616c 7365 2c20 6e65 6564 735f  er=False, needs_
-0003eb30: 7072 6f62 613d 4661 6c73 6529 0d0a 2020  proba=False)..  
-0003eb40: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0003eb50: 6f72 6572 203d 6c6f 676c 6f73 735f 7363  orer =logloss_sc
-0003eb60: 6f72 6572 0d0a 2020 2020 2020 2020 2020  orer..          
-0003eb70: 2020 2020 2020 2366 315f 7363 6f72 6572        #f1_scorer
-0003eb80: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
-0003eb90: 696e 695f 6631 2c20 6772 6561 7465 725f  ini_f1, greater_
-0003eba0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-0003ebb0: 6e65 6564 735f 7072 6f62 613d 4661 6c73  needs_proba=Fals
-0003ebc0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0003ebd0: 2020 2020 2320 2020 2020 2020 2070 6f73      #        pos
-0003ebe0: 5f6c 6162 656c 3d72 6172 655f 636c 6173  _label=rare_clas
-0003ebf0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-0003ec00: 2020 2020 2373 636f 7265 7220 3d20 6631      #scorer = f1
-0003ec10: 5f73 636f 7265 720d 0a20 2020 2020 2020  _scorer..       
-0003ec20: 2020 2020 2023 2323 2044 4f20 4e4f 5420       ### DO NOT 
-0003ec30: 5553 4520 4e55 4d20 434c 4153 5320 5749  USE NUM CLASS WI
-0003ec40: 5448 2042 494e 4152 5920 434c 4153 5349  TH BINARY CLASSI
-0003ec50: 4649 4341 5449 4f4e 2023 2323 2323 230d  FICATION ######.
-0003ec60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003ec70: 426f 6f73 7469 6e67 5f46 6c61 673a 0d0a  Boosting_Flag:..
-0003ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec90: 6966 206d 6f64 656c 5f6e 616d 652e 6c6f  if model_name.lo
-0003eca0: 7765 7228 2920 3d3d 2027 6361 7462 6f6f  wer() == 'catboo
-0003ecb0: 7374 273a 0d0a 2020 2020 2020 2020 2020  st':..          
-0003ecc0: 2020 2020 2020 2020 2020 7867 626d 203d            xgbm =
-0003ecd0: 2020 4361 7442 6f6f 7374 436c 6173 7369    CatBoostClassi
-0003ece0: 6669 6572 2876 6572 626f 7365 3d31 2c69  fier(verbose=1,i
-0003ecf0: 7465 7261 7469 6f6e 733d 6d61 785f 6573  terations=max_es
-0003ed00: 7469 6d73 2c0d 0a20 2020 2020 2020 2020  tims,..         
-0003ed10: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0003ed20: 616e 646f 6d5f 7374 6174 653d 3939 2c6f  andom_state=99,o
-0003ed30: 6e65 5f68 6f74 5f6d 6178 5f73 697a 653d  ne_hot_max_size=
-0003ed40: 6f6e 655f 686f 745f 7369 7a65 2c0d 0a20  one_hot_size,.. 
-0003ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed60: 2020 2020 2020 206c 6f73 735f 6675 6e63         loss_func
-0003ed70: 7469 6f6e 3d6c 6f73 735f 6675 6e63 7469  tion=loss_functi
-0003ed80: 6f6e 2c20 6576 616c 5f6d 6574 7269 633d  on, eval_metric=
-0003ed90: 6361 7462 6f6f 7374 5f73 636f 7269 6e67  catboost_scoring
-0003eda0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003edb0: 2020 2020 2020 2020 2020 2073 7562 7361             subsa
-0003edc0: 6d70 6c65 3d73 7562 7361 6d70 6c65 2c62  mple=subsample,b
-0003edd0: 6f6f 7473 7472 6170 5f74 7970 653d 2742  ootstrap_type='B
-0003ede0: 6572 6e6f 756c 6c69 272c 0d0a 2020 2020  ernoulli',..    
-0003edf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee00: 2020 2020 6d65 7472 6963 5f70 6572 696f      metric_perio
-0003ee10: 6420 3d20 3530 302c 0d0a 2020 2020 2020  d = 500,..      
-0003ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee30: 2065 6172 6c79 5f73 746f 7070 696e 675f   early_stopping_
-0003ee40: 726f 756e 6473 3d32 3030 302c 626f 6f73  rounds=2000,boos
-0003ee50: 7469 6e67 5f74 7970 653d 2750 6c61 696e  ting_type='Plain
-0003ee60: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0003ee70: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0003ee80: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0003ee90: 6762 6d20 3d20 5847 4243 6c61 7373 6966  gbm = XGBClassif
-0003eea0: 6965 7228 6261 7365 5f73 636f 7265 3d30  ier(base_score=0
-0003eeb0: 2e35 2c20 626f 6f73 7465 723d 2767 6274  .5, booster='gbt
-0003eec0: 7265 6527 2c20 7375 6273 616d 706c 653d  ree', subsample=
-0003eed0: 7375 6273 616d 706c 652c 0d0a 2020 2020  subsample,..    
+0003dd80: 2770 656e 616c 7479 2720 3a20 7065 6e61  'penalty' : pena
+0003dd90: 6c74 6965 732c 0d0a 2020 2020 2020 2020  lties,..        
+0003dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ddb0: 2020 2020 2020 2020 2773 6f6c 7665 7227          'solver'
+0003ddc0: 203a 2073 6f6c 7665 7273 2c0d 0a20 2020   : solvers,..   
+0003ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dde0: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
+0003ddf0: 2020 2020 2020 2020 2020 2020 635f 7061              c_pa
+0003de00: 7261 6d73 5b22 466f 7265 7374 7322 5d20  rams["Forests"] 
+0003de10: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+0003de20: 2020 2020 2023 2323 2323 2049 2068 6176       ##### I hav
+0003de30: 6520 7365 6c65 6374 6564 2074 6865 7365  e selected these
+0003de40: 2074 6f20 6176 6f69 6420 4f76 6572 6669   to avoid Overfi
+0003de50: 7474 696e 6720 7768 6963 6820 6973 2061  tting which is a
+0003de60: 2070 726f 626c 656d 2066 6f72 2073 6d61   problem for sma
+0003de70: 6c6c 2064 6174 6120 7365 7473 0d0a 2020  ll data sets..  
+0003de80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de90: 2020 2020 2020 2020 2020 2020 2027 6e5f               'n_
+0003dea0: 6573 7469 6d61 746f 7273 273a 2073 702e  estimators': sp.
+0003deb0: 7374 6174 732e 7261 6e64 696e 7428 3130  stats.randint(10
+0003dec0: 302c 6d61 785f 6573 7469 6d73 292c 0d0a  0,max_estims),..
+0003ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003def0: 226d 6178 5f64 6570 7468 223a 2073 702e  "max_depth": sp.
+0003df00: 7374 6174 732e 7261 6e64 696e 7428 332c  stats.randint(3,
+0003df10: 206d 6178 5f64 6570 7468 292c 0d0a 2020   max_depth),..  
+0003df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df30: 2020 2020 2020 2020 2020 2020 2020 226d                "m
+0003df40: 696e 5f73 616d 706c 6573 5f6c 6561 6622  in_samples_leaf"
+0003df50: 3a20 7370 2e73 7461 7473 2e72 616e 6469  : sp.stats.randi
+0003df60: 6e74 2832 2c20 3230 292c 0d0a 2020 2020  nt(2, 20),..    
+0003df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df80: 2020 2020 2020 2020 2020 2020 2322 6372              #"cr
+0003df90: 6974 6572 696f 6e22 3a5b 2767 696e 6927  iterion":['gini'
+0003dfa0: 2c27 656e 7472 6f70 7927 5d2c 0d0a 2020  ,'entropy'],..  
+0003dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dfc0: 2020 2020 2020 2020 2020 2020 2020 2327                #'
+0003dfd0: 6d61 785f 6665 6174 7572 6573 273a 205b  max_features': [
+0003dfe0: 276c 6f67 272c 2022 7371 7274 225d 202c  'log', "sqrt"] ,
+0003dff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003e000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e010: 2020 2327 636c 6173 735f 7765 6967 6874    #'class_weight
+0003e020: 273a 5b4e 6f6e 652c 2762 616c 616e 6365  ':[None,'balance
+0003e030: 6427 5d0d 0a20 2020 2020 2020 2020 2020  d']..           
+0003e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e050: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
+0003e060: 2020 2020 2020 2020 2020 2020 635f 7061              c_pa
+0003e070: 7261 6d73 5b22 4d75 6c74 695f 4c61 6265  rams["Multi_Labe
+0003e080: 6c22 5d20 3d20 7b0d 0a20 2020 2020 2020  l"] = {..       
+0003e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e0a0: 2023 2323 2074 6869 7320 6973 2074 6865   ### this is the
+0003e0b0: 2062 6573 7420 7061 7261 6d73 2066 6f72   best params for
+0003e0c0: 206c 6f67 6973 7469 6320 7265 6772 6573   logistic regres
+0003e0d0: 7369 6f6e 0d0a 2020 2020 2020 2020 2020  sion..          
+0003e0e0: 2020 2020 2020 2020 2020 2020 2020 6573                es
+0003e0f0: 7469 6d61 746f 725f 7374 7269 6e67 2b27  timator_string+'
+0003e100: 4327 3a20 7370 2e73 7461 7473 2e75 6e69  C': sp.stats.uni
+0003e110: 666f 726d 2e72 7673 286c 6f63 3d30 2e30  form.rvs(loc=0.0
+0003e120: 312c 7363 616c 653d 3130 2c73 697a 653d  1,scale=10,size=
+0003e130: 3130 3030 290d 0a20 2020 2020 2020 2020  1000)..         
+0003e140: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0003e150: 0d0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
+0003e160: 7465 2072 6567 756c 6172 697a 6174 696f  te regularizatio
+0003e170: 6e20 6879 7065 7270 6172 616d 6574 6572  n hyperparameter
+0003e180: 2064 6973 7472 6962 7574 696f 6e20 7573   distribution us
+0003e190: 696e 6720 756e 6966 6f72 6d20 6469 7374  ing uniform dist
+0003e1a0: 7269 6275 7469 6f6e 0d0a 2020 2020 2020  ribution..      
+0003e1b0: 2020 6966 206c 656e 2863 6c61 7373 6573    if len(classes
+0003e1c0: 2920 3d3d 2032 3a0d 0a20 2020 2020 2020  ) == 2:..       
+0003e1d0: 2020 2020 206f 626a 6563 7469 7665 203d       objective =
+0003e1e0: 2027 6269 6e61 7279 3a6c 6f67 6973 7469   'binary:logisti
+0003e1f0: 6327 0d0a 2020 2020 2020 2020 2020 2020  c'..            
+0003e200: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+0003e210: 6574 6572 203d 3d20 2761 6363 7572 6163  eter == 'accurac
+0003e220: 7927 206f 7220 7363 6f72 696e 675f 7061  y' or scoring_pa
+0003e230: 7261 6d65 7465 7220 3d3d 2027 6163 6375  rameter == 'accu
+0003e240: 7261 6379 5f73 636f 7265 273a 0d0a 2020  racy_score':..  
+0003e250: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+0003e260: 6375 7261 6379 5f73 636f 7265 7220 3d20  curacy_scorer = 
+0003e270: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+0003e280: 5f61 6363 7572 6163 792c 2067 7265 6174  _accuracy, great
+0003e290: 6572 5f69 735f 6265 7474 6572 3d54 7275  er_is_better=Tru
+0003e2a0: 652c 206e 6565 6473 5f70 726f 6261 3d46  e, needs_proba=F
+0003e2b0: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
+0003e2c0: 2020 2020 2020 2073 636f 7265 7220 3d61         scorer =a
+0003e2d0: 6363 7572 6163 795f 7363 6f72 6572 0d0a  ccuracy_scorer..
+0003e2e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0003e2f0: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+0003e300: 6572 203d 3d20 2767 696e 6927 3a0d 0a20  er == 'gini':.. 
+0003e310: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0003e320: 696e 695f 7363 6f72 6572 203d 206d 616b  ini_scorer = mak
+0003e330: 655f 7363 6f72 6572 2867 696e 695f 736b  e_scorer(gini_sk
+0003e340: 6c65 6172 6e2c 2067 7265 6174 6572 5f69  learn, greater_i
+0003e350: 735f 6265 7474 6572 3d46 616c 7365 2c20  s_better=False, 
+0003e360: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
+0003e370: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003e380: 2020 2073 636f 7265 7220 3d67 696e 695f     scorer =gini_
+0003e390: 7363 6f72 6572 0d0a 2020 2020 2020 2020  scorer..        
+0003e3a0: 2020 2020 656c 6966 2073 636f 7269 6e67      elif scoring
+0003e3b0: 5f70 6172 616d 6574 6572 203d 3d20 2761  _parameter == 'a
+0003e3c0: 7563 2720 6f72 2073 636f 7269 6e67 5f70  uc' or scoring_p
+0003e3d0: 6172 616d 6574 6572 203d 3d20 2772 6f63  arameter == 'roc
+0003e3e0: 5f61 7563 2720 6f72 2073 636f 7269 6e67  _auc' or scoring
+0003e3f0: 5f70 6172 616d 6574 6572 203d 3d20 2772  _parameter == 'r
+0003e400: 6f63 5f61 7563 5f73 636f 7265 273a 0d0a  oc_auc_score':..
+0003e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e420: 726f 635f 7363 6f72 6572 203d 206d 616b  roc_scorer = mak
+0003e430: 655f 7363 6f72 6572 2867 696e 695f 726f  e_scorer(gini_ro
+0003e440: 632c 2067 7265 6174 6572 5f69 735f 6265  c, greater_is_be
+0003e450: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+0003e460: 5f74 6872 6573 686f 6c64 3d54 7275 6529  _threshold=True)
+0003e470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003e480: 2020 7363 6f72 6572 203d 726f 635f 7363    scorer =roc_sc
+0003e490: 6f72 6572 0d0a 2020 2020 2020 2020 2020  orer..          
+0003e4a0: 2020 656c 6966 2073 636f 7269 6e67 5f70    elif scoring_p
+0003e4b0: 6172 616d 6574 6572 2069 6e20 5b27 6c6f  arameter in ['lo
+0003e4c0: 675f 6c6f 7373 272c 276c 6f67 6c6f 7373  g_loss','logloss
+0003e4d0: 272c 276e 6567 5f6c 6f67 5f6c 6f73 7327  ','neg_log_loss'
+0003e4e0: 2c27 6c6f 672d 6c6f 7373 275d 3a0d 0a20  ,'log-loss']:.. 
+0003e4f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003e500: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+0003e510: 203d 2027 6e65 675f 6c6f 675f 6c6f 7373   = 'neg_log_loss
+0003e520: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+0003e530: 2020 206c 6f67 6c6f 7373 5f73 636f 7265     logloss_score
+0003e540: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
+0003e550: 6769 6e69 5f6c 6f67 5f6c 6f73 732c 2067  gini_log_loss, g
+0003e560: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+0003e570: 3d46 616c 7365 2c20 6e65 6564 735f 7072  =False, needs_pr
+0003e580: 6f62 613d 4661 6c73 6529 0d0a 2020 2020  oba=False)..    
+0003e590: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+0003e5a0: 6572 203d 6c6f 676c 6f73 735f 7363 6f72  er =logloss_scor
+0003e5b0: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
+0003e5c0: 656c 6966 2073 636f 7269 6e67 5f70 6172  elif scoring_par
+0003e5d0: 616d 6574 6572 3d3d 2762 616c 616e 6365  ameter=='balance
+0003e5e0: 645f 6163 6375 7261 6379 2720 6f72 2073  d_accuracy' or s
+0003e5f0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+0003e600: 3d3d 2762 616c 616e 6365 642d 6163 6375  =='balanced-accu
+0003e610: 7261 6379 2720 6f72 2073 636f 7269 6e67  racy' or scoring
+0003e620: 5f70 6172 616d 6574 6572 3d3d 2761 7665  _parameter=='ave
+0003e630: 7261 6765 5f61 6363 7572 6163 7927 3a0d  rage_accuracy':.
+0003e640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e650: 2062 616c 5f61 6363 7572 6163 795f 7363   bal_accuracy_sc
+0003e660: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
+0003e670: 6572 2867 696e 695f 6261 6c5f 6163 6375  er(gini_bal_accu
+0003e680: 7261 6379 2c20 6772 6561 7465 725f 6973  racy, greater_is
+0003e690: 5f62 6574 7465 723d 5472 7565 2c0d 0a20  _better=True,.. 
+0003e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6e0: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
+0003e6f0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+0003e700: 2020 2020 2073 636f 7265 7220 3d20 6261       scorer = ba
+0003e710: 6c5f 6163 6375 7261 6379 5f73 636f 7265  l_accuracy_score
+0003e720: 720d 0a20 2020 2020 2020 2020 2020 2065  r..            e
+0003e730: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
+0003e740: 6d65 7465 7220 3d3d 2027 7072 6563 6973  meter == 'precis
+0003e750: 696f 6e27 206f 7220 7363 6f72 696e 675f  ion' or scoring_
+0003e760: 7061 7261 6d65 7465 7220 3d3d 2027 7072  parameter == 'pr
+0003e770: 6563 6973 696f 6e5f 7363 6f72 6527 3a0d  ecision_score':.
+0003e780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e790: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
+0003e7a0: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
+0003e7b0: 6769 6e69 5f70 7265 6369 7369 6f6e 2c20  gini_precision, 
+0003e7c0: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+0003e7d0: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+0003e7e0: 6f62 613d 4661 6c73 652c 0d0a 2020 2020  oba=False,..    
+0003e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e800: 706f 735f 6c61 6265 6c3d 7261 7265 5f63  pos_label=rare_c
+0003e810: 6c61 7373 290d 0a20 2020 2020 2020 2020  lass)..         
+0003e820: 2020 2020 2020 2073 636f 7265 7220 3d70         scorer =p
+0003e830: 7265 6369 7369 6f6e 5f73 636f 7265 720d  recision_scorer.
+0003e840: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0003e850: 6620 7363 6f72 696e 675f 7061 7261 6d65  f scoring_parame
+0003e860: 7465 7220 3d3d 2027 7265 6361 6c6c 2720  ter == 'recall' 
+0003e870: 6f72 2073 636f 7269 6e67 5f70 6172 616d  or scoring_param
+0003e880: 6574 6572 203d 3d20 2772 6563 616c 6c5f  eter == 'recall_
+0003e890: 7363 6f72 6527 3a0d 0a20 2020 2020 2020  score':..       
+0003e8a0: 2020 2020 2020 2020 2072 6563 616c 6c5f           recall_
+0003e8b0: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
+0003e8c0: 6f72 6572 2867 696e 695f 7265 6361 6c6c  orer(gini_recall
+0003e8d0: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
+0003e8e0: 7465 723d 5472 7565 2c20 6e65 6564 735f  ter=True, needs_
+0003e8f0: 7072 6f62 613d 4661 6c73 652c 0d0a 2020  proba=False,..  
+0003e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e910: 2020 2020 2020 706f 735f 6c61 6265 6c3d        pos_label=
+0003e920: 7261 7265 5f63 6c61 7373 290d 0a20 2020  rare_class)..   
+0003e930: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0003e940: 7265 7220 3d72 6563 616c 6c5f 7363 6f72  rer =recall_scor
+0003e950: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
+0003e960: 656c 6966 2073 636f 7269 6e67 5f70 6172  elif scoring_par
+0003e970: 616d 6574 6572 203d 3d20 2766 3127 206f  ameter == 'f1' o
+0003e980: 7220 7363 6f72 696e 675f 7061 7261 6d65  r scoring_parame
+0003e990: 7465 7220 3d3d 2027 6631 5f73 636f 7265  ter == 'f1_score
+0003e9a0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0003e9b0: 2020 2020 6631 5f73 636f 7265 7220 3d20      f1_scorer = 
+0003e9c0: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+0003e9d0: 5f66 312c 2067 7265 6174 6572 5f69 735f  _f1, greater_is_
+0003e9e0: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
+0003e9f0: 6473 5f70 726f 6261 3d46 616c 7365 2c0d  ds_proba=False,.
+0003ea00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ea10: 2020 2020 2020 2020 2070 6f73 5f6c 6162           pos_lab
+0003ea20: 656c 3d72 6172 655f 636c 6173 7329 0d0a  el=rare_class)..
+0003ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea40: 7363 6f72 6572 203d 6631 5f73 636f 7265  scorer =f1_score
+0003ea50: 720d 0a20 2020 2020 2020 2020 2020 2065  r..            e
+0003ea60: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
+0003ea70: 6d65 7465 7220 3d3d 2027 6632 2720 6f72  meter == 'f2' or
+0003ea80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+0003ea90: 6572 203d 3d20 2766 325f 7363 6f72 6527  er == 'f2_score'
+0003eaa0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003eab0: 2020 2066 325f 7363 6f72 6572 203d 206d     f2_scorer = m
+0003eac0: 616b 655f 7363 6f72 6572 2866 325f 6d65  ake_scorer(f2_me
+0003ead0: 6173 7572 652c 2067 7265 6174 6572 5f69  asure, greater_i
+0003eae0: 735f 6265 7474 6572 3d54 7275 652c 206e  s_better=True, n
+0003eaf0: 6565 6473 5f70 726f 6261 3d46 616c 7365  eeds_proba=False
+0003eb00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003eb10: 2020 2073 636f 7265 7220 3d66 325f 7363     scorer =f2_sc
+0003eb20: 6f72 6572 0d0a 2020 2020 2020 2020 2020  orer..          
+0003eb30: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0003eb40: 2020 2020 2020 2020 206c 6f67 6c6f 7373           logloss
+0003eb50: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+0003eb60: 636f 7265 7228 6769 6e69 5f6c 6f67 5f6c  corer(gini_log_l
+0003eb70: 6f73 732c 2067 7265 6174 6572 5f69 735f  oss, greater_is_
+0003eb80: 6265 7474 6572 3d46 616c 7365 2c20 6e65  better=False, ne
+0003eb90: 6564 735f 7072 6f62 613d 4661 6c73 6529  eds_proba=False)
+0003eba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ebb0: 2020 7363 6f72 6572 203d 6c6f 676c 6f73    scorer =loglos
+0003ebc0: 735f 7363 6f72 6572 0d0a 2020 2020 2020  s_scorer..      
+0003ebd0: 2020 2020 2020 2020 2020 2366 315f 7363            #f1_sc
+0003ebe0: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
+0003ebf0: 6572 2867 696e 695f 6631 2c20 6772 6561  er(gini_f1, grea
+0003ec00: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+0003ec10: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+0003ec20: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+0003ec30: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+0003ec40: 2070 6f73 5f6c 6162 656c 3d72 6172 655f   pos_label=rare_
+0003ec50: 636c 6173 7329 0d0a 2020 2020 2020 2020  class)..        
+0003ec60: 2020 2020 2020 2020 2373 636f 7265 7220          #scorer 
+0003ec70: 3d20 6631 5f73 636f 7265 720d 0a20 2020  = f1_scorer..   
+0003ec80: 2020 2020 2020 2020 2023 2323 2044 4f20           ### DO 
+0003ec90: 4e4f 5420 5553 4520 4e55 4d20 434c 4153  NOT USE NUM CLAS
+0003eca0: 5320 5749 5448 2042 494e 4152 5920 434c  S WITH BINARY CL
+0003ecb0: 4153 5349 4649 4341 5449 4f4e 2023 2323  ASSIFICATION ###
+0003ecc0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0003ecd0: 2069 6620 426f 6f73 7469 6e67 5f46 6c61   if Boosting_Fla
+0003ece0: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+0003ecf0: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
+0003ed00: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
+0003ed10: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
+0003ed20: 2020 2020 2020 2020 2020 2020 2020 7867                xg
+0003ed30: 626d 203d 2020 4361 7442 6f6f 7374 436c  bm =  CatBoostCl
+0003ed40: 6173 7369 6669 6572 2876 6572 626f 7365  assifier(verbose
+0003ed50: 3d30 2c69 7465 7261 7469 6f6e 733d 6d61  =0,iterations=ma
+0003ed60: 785f 6573 7469 6d73 2c0d 0a20 2020 2020  x_estims,..     
+0003ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed80: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+0003ed90: 3939 2c6f 6e65 5f68 6f74 5f6d 6178 5f73  99,one_hot_max_s
+0003eda0: 697a 653d 6f6e 655f 686f 745f 7369 7a65  ize=one_hot_size
+0003edb0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003edc0: 2020 2020 2020 2020 2020 206c 6f73 735f             loss_
+0003edd0: 6675 6e63 7469 6f6e 3d6c 6f73 735f 6675  function=loss_fu
+0003ede0: 6e63 7469 6f6e 2c20 6576 616c 5f6d 6574  nction, eval_met
+0003edf0: 7269 633d 6361 7462 6f6f 7374 5f73 636f  ric=catboost_sco
+0003ee00: 7269 6e67 2c0d 0a20 2020 2020 2020 2020  ring,..         
+0003ee10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003ee20: 7562 7361 6d70 6c65 3d73 7562 7361 6d70  ubsample=subsamp
+0003ee30: 6c65 2c62 6f6f 7473 7472 6170 5f74 7970  le,bootstrap_typ
+0003ee40: 653d 2742 6572 6e6f 756c 6c69 272c 0d0a  e='Bernoulli',..
+0003ee50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee60: 2020 2020 2020 2020 6d65 7472 6963 5f70          metric_p
+0003ee70: 6572 696f 6420 3d20 3530 302c 0d0a 2020  eriod = 500,..  
+0003ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee90: 2020 2020 2065 6172 6c79 5f73 746f 7070       early_stopp
+0003eea0: 696e 675f 726f 756e 6473 3d32 3030 302c  ing_rounds=2000,
+0003eeb0: 626f 6f73 7469 6e67 5f74 7970 653d 2750  boosting_type='P
+0003eec0: 6c61 696e 2729 0d0a 2020 2020 2020 2020  lain')..        
+0003eed0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
 0003eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eef0: 2020 2020 636f 6c73 616d 706c 655f 6279      colsample_by
-0003ef00: 7472 6565 3d63 6f6c 5f73 7562 5f73 616d  tree=col_sub_sam
-0003ef10: 706c 652c 6761 6d6d 613d 312c 206c 6561  ple,gamma=1, lea
-0003ef20: 726e 696e 675f 7261 7465 3d30 2e31 2c20  rning_rate=0.1, 
-0003ef30: 6d61 785f 6465 6c74 615f 7374 6570 3d30  max_delta_step=0
-0003ef40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003ef50: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-0003ef60: 6570 7468 3d6d 6178 5f64 6570 7468 2c20  epth=max_depth, 
-0003ef70: 6d69 6e5f 6368 696c 645f 7765 6967 6874  min_child_weight
-0003ef80: 3d31 2c20 6d69 7373 696e 673d 2d39 3939  =1, missing=-999
-0003ef90: 2c20 6e5f 6573 7469 6d61 746f 7273 3d32  , n_estimators=2
-0003efa0: 3030 2c0d 0a20 2020 2020 2020 2020 2020  00,..           
-0003efb0: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
-0003efc0: 6f62 733d 6e5f 6a6f 6273 2c20 6e74 6872  obs=n_jobs, nthr
-0003efd0: 6561 643d 6e5f 6a6f 6273 2c20 6f62 6a65  ead=n_jobs, obje
-0003efe0: 6374 6976 653d 6f62 6a65 6374 6976 652c  ctive=objective,
-0003eff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003f000: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-0003f010: 5f73 7461 7465 3d31 2c20 7265 675f 616c  _state=1, reg_al
-0003f020: 7068 613d 302e 352c 2072 6567 5f6c 616d  pha=0.5, reg_lam
-0003f030: 6264 613d 302e 352c 2075 7365 5f6c 6162  bda=0.5, use_lab
-0003f040: 656c 5f65 6e63 6f64 6572 3d46 616c 7365  el_encoder=False
-0003f050: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003f060: 2020 2020 2020 2020 2020 2073 6565 643d             seed=
-0003f070: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0003f080: 2020 2020 2020 2020 7867 626d 2e73 6574          xgbm.set
-0003f090: 5f70 6172 616d 7328 2a2a 7061 7261 6d29  _params(**param)
-0003f0a0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003f0b0: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
-0003f0c0: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-0003f0d0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-0003f0e0: 4920 6861 7665 2073 6574 2074 6865 2056  I have set the V
-0003f0f0: 6572 626f 7365 2074 6f20 6265 2046 616c  erbose to be Fal
-0003f100: 7365 2068 6572 6520 7369 6e63 6520 6974  se here since it
-0003f110: 2070 726f 6475 6365 7320 746f 6f20 6d75   produces too mu
-0003f120: 6368 206f 7574 7075 7420 2323 230d 0a20  ch output ###.. 
+0003eef0: 2020 2078 6762 6d20 3d20 5847 4243 6c61     xgbm = XGBCla
+0003ef00: 7373 6966 6965 7228 6261 7365 5f73 636f  ssifier(base_sco
+0003ef10: 7265 3d30 2e35 2c20 626f 6f73 7465 723d  re=0.5, booster=
+0003ef20: 2767 6274 7265 6527 2c20 7375 6273 616d  'gbtree', subsam
+0003ef30: 706c 653d 7375 6273 616d 706c 652c 0d0a  ple=subsample,..
+0003ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef50: 2020 2020 2020 2020 636f 6c73 616d 706c          colsampl
+0003ef60: 655f 6279 7472 6565 3d63 6f6c 5f73 7562  e_bytree=col_sub
+0003ef70: 5f73 616d 706c 652c 6761 6d6d 613d 312c  _sample,gamma=1,
+0003ef80: 206c 6561 726e 696e 675f 7261 7465 3d30   learning_rate=0
+0003ef90: 2e31 2c20 6d61 785f 6465 6c74 615f 7374  .1, max_delta_st
+0003efa0: 6570 3d30 2c0d 0a20 2020 2020 2020 2020  ep=0,..         
+0003efb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0003efc0: 6178 5f64 6570 7468 3d6d 6178 5f64 6570  ax_depth=max_dep
+0003efd0: 7468 2c20 6d69 6e5f 6368 696c 645f 7765  th, min_child_we
+0003efe0: 6967 6874 3d31 2c20 6d69 7373 696e 673d  ight=1, missing=
+0003eff0: 2d39 3939 2c20 6e5f 6573 7469 6d61 746f  -999, n_estimato
+0003f000: 7273 3d32 3030 2c0d 0a20 2020 2020 2020  rs=200,..       
+0003f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f020: 206e 5f6a 6f62 733d 6e5f 6a6f 6273 2c20   n_jobs=n_jobs, 
+0003f030: 6e74 6872 6561 643d 6e5f 6a6f 6273 2c20  nthread=n_jobs, 
+0003f040: 6f62 6a65 6374 6976 653d 6f62 6a65 6374  objective=object
+0003f050: 6976 652c 0d0a 2020 2020 2020 2020 2020  ive,..          
+0003f060: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0003f070: 6e64 6f6d 5f73 7461 7465 3d31 2c20 7265  ndom_state=1, re
+0003f080: 675f 616c 7068 613d 302e 352c 2072 6567  g_alpha=0.5, reg
+0003f090: 5f6c 616d 6264 613d 302e 352c 2075 7365  _lambda=0.5, use
+0003f0a0: 5f6c 6162 656c 5f65 6e63 6f64 6572 3d46  _label_encoder=F
+0003f0b0: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
+0003f0c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003f0d0: 6565 643d 3129 0d0a 2020 2020 2020 2020  eed=1)..        
+0003f0e0: 2020 2020 2020 2020 2020 2020 7867 626d              xgbm
+0003f0f0: 2e73 6574 5f70 6172 616d 7328 2a2a 7061  .set_params(**pa
+0003f100: 7261 6d29 0d0a 2020 2020 2020 2020 2020  ram)..          
+0003f110: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+0003f120: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
 0003f130: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003f140: 7867 626d 203d 204c 6f67 6973 7469 6352  xgbm = LogisticR
-0003f150: 6567 7265 7373 696f 6e28 7261 6e64 6f6d  egression(random
-0003f160: 5f73 7461 7465 3d73 6565 642c 7665 7262  _state=seed,verb
-0003f170: 6f73 653d 4661 6c73 652c 736f 6c76 6572  ose=False,solver
-0003f180: 3d73 6f6c 7665 722c 0d0a 2020 2020 2020  =solver,..      
-0003f190: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-0003f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f1b0: 2020 2020 2020 2066 6974 5f69 6e74 6572         fit_inter
-0003f1c0: 6365 7074 3d54 7275 652c 2074 6f6c 3d74  cept=True, tol=t
-0003f1d0: 6f6c 6572 616e 6365 2c0d 0a20 2020 2020  olerance,..     
-0003f1e0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-0003f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f200: 2020 2020 2077 6172 6d5f 7374 6172 743d       warm_start=
-0003f210: 7761 726d 5f73 7461 7274 2c20 6d61 785f  warm_start, max_
-0003f220: 6974 6572 3d6d 6178 5f69 7465 7229 0d0a  iter=max_iter)..
-0003f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f240: 7867 626d 203d 204c 6f67 6973 7469 6352  xgbm = LogisticR
-0003f250: 6567 7265 7373 696f 6e28 7261 6e64 6f6d  egression(random
-0003f260: 5f73 7461 7465 3d73 6565 642c 7665 7262  _state=seed,verb
-0003f270: 6f73 653d 4661 6c73 652c 6e5f 6a6f 6273  ose=False,n_jobs
-0003f280: 3d2d 312c 746f 6c3d 302e 3031 2c0d 0a20  =-1,tol=0.01,.. 
-0003f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2b0: 2020 2020 2020 2020 2020 2020 7761 726d              warm
-0003f2c0: 5f73 7461 7274 3d46 616c 7365 2c20 6d61  _start=False, ma
-0003f2d0: 785f 6974 6572 3d6d 6178 5f69 7465 7229  x_iter=max_iter)
-0003f2e0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003f2f0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003f300: 2020 2020 2078 6762 6d20 3d20 5261 6e64       xgbm = Rand
-0003f310: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
-0003f320: 6572 280d 0a20 2020 2020 2020 2020 2020  er(..           
-0003f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f340: 202a 2a7b 0d0a 2020 2020 2020 2020 2020   **{..          
-0003f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f360: 2020 2762 6f6f 7473 7472 6170 273a 2062    'bootstrap': b
-0003f370: 6f6f 7473 7472 6170 2c20 276e 5f6a 6f62  ootstrap, 'n_job
-0003f380: 7327 3a20 2d31 2c20 2777 6172 6d5f 7374  s': -1, 'warm_st
-0003f390: 6172 7427 3a20 7761 726d 5f73 7461 7274  art': warm_start
-0003f3a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0003f3c0: 7261 6e64 6f6d 5f73 7461 7465 273a 7365  random_state':se
-0003f3d0: 6564 2c27 6d69 6e5f 7361 6d70 6c65 735f  ed,'min_samples_
-0003f3e0: 6c65 6166 273a 322c 276f 6f62 5f73 636f  leaf':2,'oob_sco
-0003f3f0: 7265 273a 5472 7565 2c0d 0a20 2020 2020  re':True,..     
-0003f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f410: 2020 2020 2020 2027 6d61 785f 6665 6174         'max_feat
-0003f420: 7572 6573 273a 2022 7371 7274 222c 2027  ures': "sqrt", '
-0003f430: 6e5f 6573 7469 6d61 746f 7273 273a 2032  n_estimators': 2
-0003f440: 3030 0d0a 2020 2020 2020 2020 2020 2020  00..            
-0003f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f460: 7d29 0d0a 2020 2020 2020 2020 656c 7365  })..        else
-0003f470: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0003f480: 2323 2323 2020 2054 6869 7320 6973 2066  ####   This is f
-0003f490: 6f72 204d 554c 5449 2043 6c61 7373 6966  or MULTI Classif
-0003f4a0: 6963 6174 696f 6e20 2323 2323 2323 2323  ication ########
-0003f4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0003f4c0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0003f4d0: 6f62 6a65 6374 6976 6520 3d20 276d 756c  objective = 'mul
-0003f4e0: 7469 3a73 6f66 746d 6178 270d 0a20 2020  ti:softmax'..   
-0003f4f0: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
-0003f500: 7472 6963 203d 2022 6d6c 6f67 6c6f 7373  tric = "mlogloss
-0003f510: 220d 0a20 2020 2020 2020 2020 2020 2069  "..            i
-0003f520: 6620 7363 6f72 696e 675f 7061 7261 6d65  f scoring_parame
-0003f530: 7465 7220 3d3d 2027 6769 6e69 273a 0d0a  ter == 'gini':..
-0003f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f550: 6769 6e69 5f73 636f 7265 7220 3d20 6d61  gini_scorer = ma
-0003f560: 6b65 5f73 636f 7265 7228 6769 6e69 5f73  ke_scorer(gini_s
-0003f570: 6b6c 6561 726e 2c20 6772 6561 7465 725f  klearn, greater_
-0003f580: 6973 5f62 6574 7465 723d 4661 6c73 652c  is_better=False,
-0003f590: 206e 6565 6473 5f70 726f 6261 3d54 7275   needs_proba=Tru
-0003f5a0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0003f5b0: 2020 2020 7363 6f72 6572 203d 2067 696e      scorer = gin
-0003f5c0: 695f 7363 6f72 6572 0d0a 2020 2020 2020  i_scorer..      
-0003f5d0: 2020 2020 2020 656c 6966 2073 636f 7269        elif scori
-0003f5e0: 6e67 5f70 6172 616d 6574 6572 3d3d 2762  ng_parameter=='b
-0003f5f0: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-0003f600: 2720 6f72 2073 636f 7269 6e67 5f70 6172  ' or scoring_par
-0003f610: 616d 6574 6572 3d3d 2762 616c 616e 6365  ameter=='balance
-0003f620: 642d 6163 6375 7261 6379 2720 6f72 2073  d-accuracy' or s
-0003f630: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003f640: 3d3d 2761 7665 7261 6765 5f61 6363 7572  =='average_accur
-0003f650: 6163 7927 3a0d 0a20 2020 2020 2020 2020  acy':..         
-0003f660: 2020 2020 2020 2062 616c 5f61 6363 7572         bal_accur
-0003f670: 6163 795f 7363 6f72 6572 203d 206d 616b  acy_scorer = mak
-0003f680: 655f 7363 6f72 6572 2867 696e 695f 6261  e_scorer(gini_ba
-0003f690: 6c5f 6163 6375 7261 6379 2c20 6772 6561  l_accuracy, grea
-0003f6a0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-0003f6b0: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
-0003f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6f0: 2020 2020 2020 206e 6565 6473 5f70 726f         needs_pro
-0003f700: 6261 3d46 616c 7365 290d 0a20 2020 2020  ba=False)..     
-0003f710: 2020 2020 2020 2020 2020 2073 636f 7265             score
-0003f720: 7220 3d20 6261 6c5f 6163 6375 7261 6379  r = bal_accuracy
-0003f730: 5f73 636f 7265 720d 0a20 2020 2020 2020  _scorer..       
-0003f740: 2020 2020 2065 6c69 6620 7363 6f72 696e       elif scorin
-0003f750: 675f 7061 7261 6d65 7465 7220 3d3d 2027  g_parameter == '
-0003f760: 726f 635f 6175 6327 206f 7220 7363 6f72  roc_auc' or scor
-0003f770: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-0003f780: 2027 726f 635f 6175 635f 7363 6f72 6527   'roc_auc_score'
-0003f790: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003f7a0: 2020 2072 6f63 5f61 7563 5f73 636f 7265     roc_auc_score
-0003f7b0: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-0003f7c0: 6769 6e69 5f73 6b6c 6561 726e 2c20 6772  gini_sklearn, gr
-0003f7d0: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
-0003f7e0: 4661 6c73 652c 206e 6565 6473 5f70 726f  False, needs_pro
-0003f7f0: 6261 3d54 7275 6529 0d0a 2020 2020 2020  ba=True)..      
-0003f800: 2020 2020 2020 2020 2020 7363 6f72 6572            scorer
-0003f810: 203d 2072 6f63 5f61 7563 5f73 636f 7265   = roc_auc_score
-0003f820: 720d 0a20 2020 2020 2020 2020 2020 2065  r..            e
-0003f830: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
-0003f840: 6d65 7465 7220 3d3d 2027 6176 6572 6167  meter == 'averag
-0003f850: 655f 7072 6563 6973 696f 6e27 206f 7220  e_precision' or 
-0003f860: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-0003f870: 7220 3d3d 2027 6d65 616e 5f70 7265 6369  r == 'mean_preci
-0003f880: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0003f890: 2020 2020 2020 2020 6176 6572 6167 655f          average_
-0003f8a0: 7072 6563 6973 696f 6e5f 7363 6f72 6572  precision_scorer
-0003f8b0: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
-0003f8c0: 696e 695f 6176 6572 6167 655f 7072 6563  ini_average_prec
-0003f8d0: 6973 696f 6e2c 0d0a 2020 2020 2020 2020  ision,..        
-0003f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f900: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0003f910: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-0003f920: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
-0003f930: 6261 3d54 7275 6529 0d0a 2020 2020 2020  ba=True)..      
-0003f940: 2020 2020 2020 2020 2020 7363 6f72 6572            scorer
-0003f950: 203d 2061 7665 7261 6765 5f70 7265 6369   = average_preci
-0003f960: 7369 6f6e 5f73 636f 7265 720d 0a20 2020  sion_scorer..   
-0003f970: 2020 2020 2020 2020 2065 6c69 6620 7363           elif sc
-0003f980: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
-0003f990: 3d3d 2027 7361 6d70 6c65 735f 7072 6563  == 'samples_prec
-0003f9a0: 6973 696f 6e27 3a0d 0a20 2020 2020 2020  ision':..       
-0003f9b0: 2020 2020 2020 2020 2073 616d 706c 6573           samples
-0003f9c0: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-0003f9d0: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-0003f9e0: 6769 6e69 5f73 616d 706c 6573 5f70 7265  gini_samples_pre
-0003f9f0: 6369 7369 6f6e 2c0d 0a20 2020 2020 2020  cision,..       
-0003fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa30: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-0003fa40: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
-0003fa50: 6f62 613d 5472 7565 290d 0a20 2020 2020  oba=True)..     
-0003fa60: 2020 2020 2020 2020 2020 2073 636f 7265             score
-0003fa70: 7220 3d20 7361 6d70 6c65 735f 7072 6563  r = samples_prec
-0003fa80: 6973 696f 6e5f 7363 6f72 6572 0d0a 2020  ision_scorer..  
-0003fa90: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0003faa0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003fab0: 203d 3d20 2777 6569 6768 7465 645f 7072   == 'weighted_pr
-0003fac0: 6563 6973 696f 6e27 206f 7220 7363 6f72  ecision' or scor
-0003fad0: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-0003fae0: 2027 7765 6967 6874 6564 2d70 7265 6369   'weighted-preci
-0003faf0: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0003fb00: 2020 2020 2020 2020 7765 6967 6874 6564          weighted
-0003fb10: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-0003fb20: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-0003fb30: 6769 6e69 5f77 6569 6768 7465 645f 7072  gini_weighted_pr
-0003fb40: 6563 6973 696f 6e2c 0d0a 2020 2020 2020  ecision,..      
-0003fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb80: 2020 6772 6561 7465 725f 6973 5f62 6574    greater_is_bet
-0003fb90: 7465 723d 5472 7565 2c20 6e65 6564 735f  ter=True, needs_
-0003fba0: 7072 6f62 613d 5472 7565 290d 0a20 2020  proba=True)..   
-0003fbb0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-0003fbc0: 7265 7220 3d20 7765 6967 6874 6564 5f70  rer = weighted_p
-0003fbd0: 7265 6369 7369 6f6e 5f73 636f 7265 720d  recision_scorer.
-0003fbe0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0003fbf0: 6620 7363 6f72 696e 675f 7061 7261 6d65  f scoring_parame
-0003fc00: 7465 7220 3d3d 2027 6d61 6372 6f5f 7072  ter == 'macro_pr
-0003fc10: 6563 6973 696f 6e27 3a0d 0a20 2020 2020  ecision':..     
-0003fc20: 2020 2020 2020 2020 2020 206d 6163 726f             macro
-0003fc30: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-0003fc40: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-0003fc50: 6769 6e69 5f6d 6163 726f 5f70 7265 6369  gini_macro_preci
-0003fc60: 7369 6f6e 2c0d 0a20 2020 2020 2020 2020  sion,..         
-0003fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc90: 2020 2020 2020 2020 2020 2020 6772 6561              grea
-0003fca0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-0003fcb0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-0003fcc0: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
-0003fcd0: 2020 2020 2020 2073 636f 7265 7220 3d20         scorer = 
-0003fce0: 6d61 6372 6f5f 7072 6563 6973 696f 6e5f  macro_precision_
-0003fcf0: 7363 6f72 6572 0d0a 2020 2020 2020 2020  scorer..        
-0003fd00: 2020 2020 656c 6966 2073 636f 7269 6e67      elif scoring
-0003fd10: 5f70 6172 616d 6574 6572 203d 3d20 276d  _parameter == 'm
-0003fd20: 6963 726f 5f70 7265 6369 7369 6f6e 273a  icro_precision':
-0003fd30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003fd40: 2020 7363 6f72 6572 203d 206d 6963 726f    scorer = micro
-0003fd50: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-0003fd60: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
-0003fd70: 2020 206d 6963 726f 5f70 7265 6369 7369     micro_precisi
-0003fd80: 6f6e 5f73 636f 7265 7220 3d20 6d61 6b65  on_scorer = make
-0003fd90: 5f73 636f 7265 7228 6769 6e69 5f6d 6963  _scorer(gini_mic
-0003fda0: 726f 5f70 7265 6369 7369 6f6e 2c0d 0a20  ro_precision,.. 
-0003fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fde0: 2020 2020 6772 6561 7465 725f 6973 5f62      greater_is_b
-0003fdf0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-0003fe00: 735f 7072 6f62 613d 5472 7565 290d 0a0d  s_proba=True)...
-0003fe10: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0003fe20: 6620 7363 6f72 696e 675f 7061 7261 6d65  f scoring_parame
-0003fe30: 7465 7220 3d3d 2027 7361 6d70 6c65 735f  ter == 'samples_
-0003fe40: 7265 6361 6c6c 273a 0d0a 2020 2020 2020  recall':..      
-0003fe50: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-0003fe60: 735f 7265 6361 6c6c 5f73 636f 7265 7220  s_recall_scorer 
-0003fe70: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-0003fe80: 6e69 5f73 616d 706c 6573 5f72 6563 616c  ni_samples_recal
-0003fe90: 6c2c 2067 7265 6174 6572 5f69 735f 6265  l, greater_is_be
-0003fea0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-0003feb0: 5f70 726f 6261 3d54 7275 6529 0d0a 2020  _proba=True)..  
-0003fec0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0003fed0: 6f72 6572 203d 2073 616d 706c 6573 5f72  orer = samples_r
-0003fee0: 6563 616c 6c5f 7363 6f72 6572 0d0a 2020  ecall_scorer..  
-0003fef0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0003ff00: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-0003ff10: 203d 3d20 2777 6569 6768 7465 645f 7265   == 'weighted_re
-0003ff20: 6361 6c6c 2720 6f72 2073 636f 7269 6e67  call' or scoring
-0003ff30: 5f70 6172 616d 6574 6572 203d 3d20 2777  _parameter == 'w
-0003ff40: 6569 6768 7465 642d 7265 6361 6c6c 273a  eighted-recall':
-0003ff50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ff60: 2020 7765 6967 6874 6564 5f72 6563 616c    weighted_recal
-0003ff70: 6c5f 7363 6f72 6572 203d 206d 616b 655f  l_scorer = make_
-0003ff80: 7363 6f72 6572 2867 696e 695f 7765 6967  scorer(gini_weig
-0003ff90: 6874 6564 5f72 6563 616c 6c2c 0d0a 2020  hted_recall,..  
-0003ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ffd0: 2020 2067 7265 6174 6572 5f69 735f 6265     greater_is_be
-0003ffe0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-0003fff0: 5f70 726f 6261 3d54 7275 6529 0d0a 2020  _proba=True)..  
-00040000: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-00040010: 6f72 6572 203d 2077 6569 6768 7465 645f  orer = weighted_
-00040020: 7265 6361 6c6c 5f73 636f 7265 720d 0a20  recall_scorer.. 
-00040030: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00040040: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00040050: 7220 3d3d 2027 6d61 6372 6f5f 7265 6361  r == 'macro_reca
-00040060: 6c6c 273a 0d0a 2020 2020 2020 2020 2020  ll':..          
-00040070: 2020 2020 2020 6d61 6372 6f5f 7265 6361        macro_reca
-00040080: 6c6c 5f73 636f 7265 7220 3d20 6d61 6b65  ll_scorer = make
-00040090: 5f73 636f 7265 7228 6769 6e69 5f6d 6163  _scorer(gini_mac
-000400a0: 726f 5f72 6563 616c 6c2c 0d0a 2020 2020  ro_recall,..    
-000400b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400d0: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-000400e0: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
-000400f0: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
-00040100: 613d 5472 7565 290d 0a20 2020 2020 2020  a=True)..       
-00040110: 2020 2020 2020 2020 2073 636f 7265 7220           scorer 
-00040120: 3d20 6d61 6372 6f5f 7265 6361 6c6c 5f73  = macro_recall_s
-00040130: 636f 7265 720d 0a20 2020 2020 2020 2020  corer..         
-00040140: 2020 2065 6c69 6620 7363 6f72 696e 675f     elif scoring_
-00040150: 7061 7261 6d65 7465 7220 3d3d 2027 6d69  parameter == 'mi
-00040160: 6372 6f5f 7265 6361 6c6c 273a 0d0a 2020  cro_recall':..  
-00040170: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-00040180: 6372 6f5f 7265 6361 6c6c 5f73 636f 7265  cro_recall_score
-00040190: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-000401a0: 6769 6e69 5f6d 6963 726f 5f72 6563 616c  gini_micro_recal
-000401b0: 6c2c 2067 7265 6174 6572 5f69 735f 6265  l, greater_is_be
-000401c0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-000401d0: 5f70 726f 6261 3d54 7275 6529 0d0a 2020  _proba=True)..  
-000401e0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-000401f0: 6f72 6572 203d 206d 6963 726f 5f72 6563  orer = micro_rec
-00040200: 616c 6c5f 7363 6f72 6572 0d0a 0d0a 2020  all_scorer....  
-00040210: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00040220: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-00040230: 203d 3d20 2773 616d 706c 6573 5f66 3127   == 'samples_f1'
-00040240: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00040250: 2020 2073 616d 706c 6573 5f66 315f 7363     samples_f1_sc
-00040260: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
-00040270: 6572 2867 696e 695f 7361 6d70 6c65 735f  er(gini_samples_
-00040280: 6631 2c0d 0a20 2020 2020 2020 2020 2020  f1,..           
-00040290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402b0: 2020 2020 2067 7265 6174 6572 5f69 735f       greater_is_
-000402c0: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
-000402d0: 6473 5f70 726f 6261 3d54 7275 6529 0d0a  ds_proba=True)..
-000402e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402f0: 7363 6f72 6572 203d 2073 616d 706c 6573  scorer = samples
-00040300: 5f66 315f 7363 6f72 6572 0d0a 2020 2020  _f1_scorer..    
-00040310: 2020 2020 2020 2020 656c 6966 2073 636f          elif sco
-00040320: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
-00040330: 3d20 2777 6569 6768 7465 645f 6631 2720  = 'weighted_f1' 
-00040340: 6f72 2073 636f 7269 6e67 5f70 6172 616d  or scoring_param
-00040350: 6574 6572 203d 3d20 2777 6569 6768 7465  eter == 'weighte
-00040360: 642d 6631 273a 0d0a 2020 2020 2020 2020  d-f1':..        
-00040370: 2020 2020 2020 2020 7765 6967 6874 6564          weighted
-00040380: 5f66 315f 7363 6f72 6572 203d 206d 616b  _f1_scorer = mak
-00040390: 655f 7363 6f72 6572 2867 696e 695f 7765  e_scorer(gini_we
-000403a0: 6967 6874 6564 5f66 312c 0d0a 2020 2020  ighted_f1,..    
-000403b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000403c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000403d0: 2020 2020 2020 2020 2020 2020 2067 7265               gre
-000403e0: 6174 6572 5f69 735f 6265 7474 6572 3d54  ater_is_better=T
-000403f0: 7275 652c 206e 6565 6473 5f70 726f 6261  rue, needs_proba
-00040400: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-00040410: 2020 2020 2020 2020 7363 6f72 6572 203d          scorer =
-00040420: 2077 6569 6768 7465 645f 6631 5f73 636f   weighted_f1_sco
-00040430: 7265 720d 0a20 2020 2020 2020 2020 2020  rer..           
-00040440: 2065 6c69 6620 7363 6f72 696e 675f 7061   elif scoring_pa
-00040450: 7261 6d65 7465 7220 3d3d 2027 6d61 6372  rameter == 'macr
-00040460: 6f5f 6631 273a 0d0a 2020 2020 2020 2020  o_f1':..        
-00040470: 2020 2020 2020 2020 6d61 6372 6f5f 6631          macro_f1
-00040480: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-00040490: 636f 7265 7228 6769 6e69 5f6d 6163 726f  corer(gini_macro
-000404a0: 5f66 312c 0d0a 2020 2020 2020 2020 2020  _f1,..          
-000404b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000404c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000404d0: 2020 2020 6772 6561 7465 725f 6973 5f62      greater_is_b
-000404e0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-000404f0: 735f 7072 6f62 613d 5472 7565 290d 0a20  s_proba=True).. 
-00040500: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00040510: 636f 7265 7220 3d20 6d61 6372 6f5f 6631  corer = macro_f1
-00040520: 5f73 636f 7265 720d 0a20 2020 2020 2020  _scorer..       
-00040530: 2020 2020 2065 6c69 6620 7363 6f72 696e       elif scorin
-00040540: 675f 7061 7261 6d65 7465 7220 3d3d 2027  g_parameter == '
-00040550: 6d69 6372 6f5f 6631 273a 0d0a 2020 2020  micro_f1':..    
-00040560: 2020 2020 2020 2020 2020 2020 6d69 6372              micr
-00040570: 6f5f 6631 5f73 636f 7265 7220 3d20 6d61  o_f1_scorer = ma
-00040580: 6b65 5f73 636f 7265 7228 6769 6e69 5f6d  ke_scorer(gini_m
-00040590: 6963 726f 5f66 312c 0d0a 2020 2020 2020  icro_f1,..      
-000405a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405c0: 2020 2020 2020 2020 6772 6561 7465 725f          greater_
-000405d0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-000405e0: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
-000405f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00040600: 2020 2073 636f 7265 7220 3d20 6d69 6372     scorer = micr
-00040610: 6f5f 6631 5f73 636f 7265 720d 0a20 2020  o_f1_scorer..   
-00040620: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00040630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040640: 7765 6967 6874 6564 5f66 315f 7363 6f72  weighted_f1_scor
-00040650: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-00040660: 2867 696e 695f 7765 6967 6874 6564 5f66  (gini_weighted_f
-00040670: 312c 0d0a 2020 2020 2020 2020 2020 2020  1,..            
-00040680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000406a0: 2020 2020 2067 7265 6174 6572 5f69 735f       greater_is_
-000406b0: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
-000406c0: 6473 5f70 726f 6261 3d54 7275 6529 0d0a  ds_proba=True)..
-000406d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000406e0: 7363 6f72 6572 203d 2077 6569 6768 7465  scorer = weighte
-000406f0: 645f 6631 5f73 636f 7265 720d 0a20 2020  d_f1_scorer..   
-00040700: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-00040710: 7363 6970 7920 6173 2073 700d 0a20 2020  scipy as sp..   
-00040720: 2020 2020 2020 2020 2069 6620 6879 7065           if hype
-00040730: 725f 7061 7261 6d20 3d3d 2027 4753 273a  r_param == 'GS':
-00040740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040750: 2020 635f 7061 7261 6d73 5b27 5847 426f    c_params['XGBo
-00040760: 6f73 7427 5d20 3d20 7b0d 0a20 2020 2020  ost'] = {..     
-00040770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040780: 2020 2020 2020 2020 2020 2027 6c65 6172             'lear
-00040790: 6e69 6e67 5f72 6174 6527 3a20 6e70 2e6c  ning_rate': np.l
-000407a0: 696e 7370 6163 6528 302e 312c 302e 352c  inspace(0.1,0.5,
-000407b0: 3529 2c0d 0a20 2020 2020 2020 2020 2020  5),..           
-000407c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000407d0: 2020 2020 2027 6761 6d6d 6127 3a20 6e70       'gamma': np
-000407e0: 2e6c 696e 7370 6163 6528 302c 2033 322c  .linspace(0, 32,
-000407f0: 3729 2e61 7374 7970 6528 696e 7429 2c0d  7).astype(int),.
-00040800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040820: 2022 6e5f 6573 7469 6d61 746f 7273 223a   "n_estimators":
-00040830: 206e 702e 6c69 6e73 7061 6365 2831 3030   np.linspace(100
-00040840: 2c20 6d61 785f 6573 7469 6d73 2c20 3329  , max_estims, 3)
-00040850: 2e61 7374 7970 6528 696e 7429 2c0d 0a20  .astype(int),.. 
-00040860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040870: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
-00040880: 2020 2020 2020 2020 2020 2020 2020 635f                c_
-00040890: 7061 7261 6d73 5b22 4361 7442 6f6f 7374  params["CatBoost
-000408a0: 225d 203d 207b 0d0a 2020 2020 2020 2020  "] = {..        
-000408b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000408c0: 2020 2020 2020 2020 276c 6561 726e 696e          'learnin
-000408d0: 675f 7261 7465 273a 206e 702e 6c6f 6773  g_rate': np.logs
-000408e0: 7061 6365 2841 6c70 6861 5f6d 696e 2c41  pace(Alpha_min,A
-000408f0: 6c70 6861 5f6d 6178 2c34 3029 2c0d 0a20  lpha_max,40),.. 
-00040900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040910: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00040920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040930: 2020 6966 2049 6d62 616c 616e 6365 645f    if Imbalanced_
-00040940: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-00040950: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
-00040960: 616d 735b 274c 696e 6561 7227 5d20 3d20  ams['Linear'] = 
-00040970: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-00040980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040990: 2020 2027 4327 3a20 4373 2c0d 0a20 2020     'C': Cs,..   
-000409a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409b0: 2020 2020 2020 2020 2027 636c 6173 735f           'class_
-000409c0: 7765 6967 6874 273a 5b4e 6f6e 652c 2027  weight':[None, '
-000409d0: 6261 6c61 6e63 6564 275d 2c0d 0a20 2020  balanced'],..   
+0003f140: 2323 2320 4920 6861 7665 2073 6574 2074  ### I have set t
+0003f150: 6865 2056 6572 626f 7365 2074 6f20 6265  he Verbose to be
+0003f160: 2046 616c 7365 2068 6572 6520 7369 6e63   False here sinc
+0003f170: 6520 6974 2070 726f 6475 6365 7320 746f  e it produces to
+0003f180: 6f20 6d75 6368 206f 7574 7075 7420 2323  o much output ##
+0003f190: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+0003f1a0: 2020 2023 7867 626d 203d 204c 6f67 6973     #xgbm = Logis
+0003f1b0: 7469 6352 6567 7265 7373 696f 6e28 7261  ticRegression(ra
+0003f1c0: 6e64 6f6d 5f73 7461 7465 3d73 6565 642c  ndom_state=seed,
+0003f1d0: 7665 7262 6f73 653d 4661 6c73 652c 736f  verbose=False,so
+0003f1e0: 6c76 6572 3d73 6f6c 7665 722c 0d0a 2020  lver=solver,..  
+0003f1f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0003f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f210: 2020 2020 2020 2020 2020 2066 6974 5f69             fit_i
+0003f220: 6e74 6572 6365 7074 3d54 7275 652c 2074  ntercept=True, t
+0003f230: 6f6c 3d74 6f6c 6572 616e 6365 2c0d 0a20  ol=tolerance,.. 
+0003f240: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f260: 2020 2020 2020 2020 2077 6172 6d5f 7374           warm_st
+0003f270: 6172 743d 7761 726d 5f73 7461 7274 2c20  art=warm_start, 
+0003f280: 6d61 785f 6974 6572 3d6d 6178 5f69 7465  max_iter=max_ite
+0003f290: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
+0003f2a0: 2020 2020 7867 626d 203d 204c 6f67 6973      xgbm = Logis
+0003f2b0: 7469 6352 6567 7265 7373 696f 6e28 7261  ticRegression(ra
+0003f2c0: 6e64 6f6d 5f73 7461 7465 3d73 6565 642c  ndom_state=seed,
+0003f2d0: 7665 7262 6f73 653d 4661 6c73 652c 6e5f  verbose=False,n_
+0003f2e0: 6a6f 6273 3d2d 312c 746f 6c3d 302e 3031  jobs=-1,tol=0.01
+0003f2f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f320: 7761 726d 5f73 7461 7274 3d46 616c 7365  warm_start=False
+0003f330: 2c20 6d61 785f 6974 6572 3d6d 6178 5f69  , max_iter=max_i
+0003f340: 7465 7229 0d0a 2020 2020 2020 2020 2020  ter)..          
+0003f350: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0003f360: 2020 2020 2020 2020 2078 6762 6d20 3d20           xgbm = 
+0003f370: 5261 6e64 6f6d 466f 7265 7374 436c 6173  RandomForestClas
+0003f380: 7369 6669 6572 280d 0a20 2020 2020 2020  sifier(..       
+0003f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f3a0: 2020 2020 202a 2a7b 0d0a 2020 2020 2020       **{..      
+0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f3c0: 2020 2020 2020 2762 6f6f 7473 7472 6170        'bootstrap
+0003f3d0: 273a 2062 6f6f 7473 7472 6170 2c20 276e  ': bootstrap, 'n
+0003f3e0: 5f6a 6f62 7327 3a20 2d31 2c20 2777 6172  _jobs': -1, 'war
+0003f3f0: 6d5f 7374 6172 7427 3a20 7761 726d 5f73  m_start': warm_s
+0003f400: 7461 7274 2c0d 0a20 2020 2020 2020 2020  tart,..         
+0003f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f420: 2020 2027 7261 6e64 6f6d 5f73 7461 7465     'random_state
+0003f430: 273a 7365 6564 2c27 6d69 6e5f 7361 6d70  ':seed,'min_samp
+0003f440: 6c65 735f 6c65 6166 273a 322c 276f 6f62  les_leaf':2,'oob
+0003f450: 5f73 636f 7265 273a 5472 7565 2c0d 0a20  _score':True,.. 
+0003f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f470: 2020 2020 2020 2020 2020 2027 6d61 785f             'max_
+0003f480: 6665 6174 7572 6573 273a 2022 7371 7274  features': "sqrt
+0003f490: 222c 2027 6e5f 6573 7469 6d61 746f 7273  ", 'n_estimators
+0003f4a0: 273a 2032 3030 0d0a 2020 2020 2020 2020  ': 200..        
+0003f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4c0: 2020 2020 7d29 0d0a 2020 2020 2020 2020      })..        
+0003f4d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0003f4e0: 2020 2023 2323 2323 2020 2054 6869 7320     #####   This 
+0003f4f0: 6973 2066 6f72 204d 554c 5449 2043 6c61  is for MULTI Cla
+0003f500: 7373 6966 6963 6174 696f 6e20 2323 2323  ssification ####
+0003f510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0003f520: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+0003f530: 2020 2020 6f62 6a65 6374 6976 6520 3d20      objective = 
+0003f540: 276d 756c 7469 3a73 6f66 746d 6178 270d  'multi:softmax'.
+0003f550: 0a20 2020 2020 2020 2020 2020 2065 7661  .            eva
+0003f560: 6c5f 6d65 7472 6963 203d 2022 6d6c 6f67  l_metric = "mlog
+0003f570: 6c6f 7373 220d 0a20 2020 2020 2020 2020  loss"..         
+0003f580: 2020 2069 6620 7363 6f72 696e 675f 7061     if scoring_pa
+0003f590: 7261 6d65 7465 7220 3d3d 2027 6769 6e69  rameter == 'gini
+0003f5a0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0003f5b0: 2020 2020 6769 6e69 5f73 636f 7265 7220      gini_scorer 
+0003f5c0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+0003f5d0: 6e69 5f73 6b6c 6561 726e 2c20 6772 6561  ni_sklearn, grea
+0003f5e0: 7465 725f 6973 5f62 6574 7465 723d 4661  ter_is_better=Fa
+0003f5f0: 6c73 652c 206e 6565 6473 5f70 726f 6261  lse, needs_proba
+0003f600: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+0003f610: 2020 2020 2020 2020 7363 6f72 6572 203d          scorer =
+0003f620: 2067 696e 695f 7363 6f72 6572 0d0a 2020   gini_scorer..  
+0003f630: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+0003f640: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+0003f650: 3d3d 2762 616c 616e 6365 645f 6163 6375  =='balanced_accu
+0003f660: 7261 6379 2720 6f72 2073 636f 7269 6e67  racy' or scoring
+0003f670: 5f70 6172 616d 6574 6572 3d3d 2762 616c  _parameter=='bal
+0003f680: 616e 6365 642d 6163 6375 7261 6379 2720  anced-accuracy' 
+0003f690: 6f72 2073 636f 7269 6e67 5f70 6172 616d  or scoring_param
+0003f6a0: 6574 6572 3d3d 2761 7665 7261 6765 5f61  eter=='average_a
+0003f6b0: 6363 7572 6163 7927 3a0d 0a20 2020 2020  ccuracy':..     
+0003f6c0: 2020 2020 2020 2020 2020 2062 616c 5f61             bal_a
+0003f6d0: 6363 7572 6163 795f 7363 6f72 6572 203d  ccuracy_scorer =
+0003f6e0: 206d 616b 655f 7363 6f72 6572 2867 696e   make_scorer(gin
+0003f6f0: 695f 6261 6c5f 6163 6375 7261 6379 2c20  i_bal_accuracy, 
+0003f700: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+0003f710: 723d 5472 7565 2c0d 0a20 2020 2020 2020  r=True,..       
+0003f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f750: 2020 2020 2020 2020 2020 206e 6565 6473             needs
+0003f760: 5f70 726f 6261 3d46 616c 7365 290d 0a20  _proba=False).. 
+0003f770: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003f780: 636f 7265 7220 3d20 6261 6c5f 6163 6375  corer = bal_accu
+0003f790: 7261 6379 5f73 636f 7265 720d 0a20 2020  racy_scorer..   
+0003f7a0: 2020 2020 2020 2020 2065 6c69 6620 7363           elif sc
+0003f7b0: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
+0003f7c0: 3d3d 2027 726f 635f 6175 6327 206f 7220  == 'roc_auc' or 
+0003f7d0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+0003f7e0: 7220 3d3d 2027 726f 635f 6175 635f 7363  r == 'roc_auc_sc
+0003f7f0: 6f72 6527 3a0d 0a20 2020 2020 2020 2020  ore':..         
+0003f800: 2020 2020 2020 2072 6f63 5f61 7563 5f73         roc_auc_s
+0003f810: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+0003f820: 7265 7228 6769 6e69 5f73 6b6c 6561 726e  rer(gini_sklearn
+0003f830: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
+0003f840: 7465 723d 4661 6c73 652c 206e 6565 6473  ter=False, needs
+0003f850: 5f70 726f 6261 3d54 7275 6529 0d0a 2020  _proba=True)..  
+0003f860: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0003f870: 6f72 6572 203d 2072 6f63 5f61 7563 5f73  orer = roc_auc_s
+0003f880: 636f 7265 720d 0a20 2020 2020 2020 2020  corer..         
+0003f890: 2020 2065 6c69 6620 7363 6f72 696e 675f     elif scoring_
+0003f8a0: 7061 7261 6d65 7465 7220 3d3d 2027 6176  parameter == 'av
+0003f8b0: 6572 6167 655f 7072 6563 6973 696f 6e27  erage_precision'
+0003f8c0: 206f 7220 7363 6f72 696e 675f 7061 7261   or scoring_para
+0003f8d0: 6d65 7465 7220 3d3d 2027 6d65 616e 5f70  meter == 'mean_p
+0003f8e0: 7265 6369 7369 6f6e 273a 0d0a 2020 2020  recision':..    
+0003f8f0: 2020 2020 2020 2020 2020 2020 6176 6572              aver
+0003f900: 6167 655f 7072 6563 6973 696f 6e5f 7363  age_precision_sc
+0003f910: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
+0003f920: 6572 2867 696e 695f 6176 6572 6167 655f  er(gini_average_
+0003f930: 7072 6563 6973 696f 6e2c 0d0a 2020 2020  precision,..    
+0003f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f970: 2020 2067 7265 6174 6572 5f69 735f 6265     greater_is_be
+0003f980: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+0003f990: 5f70 726f 6261 3d54 7275 6529 0d0a 2020  _proba=True)..  
+0003f9a0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0003f9b0: 6f72 6572 203d 2061 7665 7261 6765 5f70  orer = average_p
+0003f9c0: 7265 6369 7369 6f6e 5f73 636f 7265 720d  recision_scorer.
+0003f9d0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0003f9e0: 6620 7363 6f72 696e 675f 7061 7261 6d65  f scoring_parame
+0003f9f0: 7465 7220 3d3d 2027 7361 6d70 6c65 735f  ter == 'samples_
+0003fa00: 7072 6563 6973 696f 6e27 3a0d 0a20 2020  precision':..   
+0003fa10: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+0003fa20: 706c 6573 5f70 7265 6369 7369 6f6e 5f73  ples_precision_s
+0003fa30: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+0003fa40: 7265 7228 6769 6e69 5f73 616d 706c 6573  rer(gini_samples
+0003fa50: 5f70 7265 6369 7369 6f6e 2c0d 0a20 2020  _precision,..   
+0003fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa90: 2020 2020 6772 6561 7465 725f 6973 5f62      greater_is_b
+0003faa0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
+0003fab0: 735f 7072 6f62 613d 5472 7565 290d 0a20  s_proba=True).. 
+0003fac0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003fad0: 636f 7265 7220 3d20 7361 6d70 6c65 735f  corer = samples_
+0003fae0: 7072 6563 6973 696f 6e5f 7363 6f72 6572  precision_scorer
+0003faf0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003fb00: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+0003fb10: 6574 6572 203d 3d20 2777 6569 6768 7465  eter == 'weighte
+0003fb20: 645f 7072 6563 6973 696f 6e27 206f 7220  d_precision' or 
+0003fb30: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+0003fb40: 7220 3d3d 2027 7765 6967 6874 6564 2d70  r == 'weighted-p
+0003fb50: 7265 6369 7369 6f6e 273a 0d0a 2020 2020  recision':..    
+0003fb60: 2020 2020 2020 2020 2020 2020 7765 6967              weig
+0003fb70: 6874 6564 5f70 7265 6369 7369 6f6e 5f73  hted_precision_s
+0003fb80: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+0003fb90: 7265 7228 6769 6e69 5f77 6569 6768 7465  rer(gini_weighte
+0003fba0: 645f 7072 6563 6973 696f 6e2c 0d0a 2020  d_precision,..  
+0003fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbe0: 2020 2020 2020 6772 6561 7465 725f 6973        greater_is
+0003fbf0: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
+0003fc00: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
+0003fc10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fc20: 2073 636f 7265 7220 3d20 7765 6967 6874   scorer = weight
+0003fc30: 6564 5f70 7265 6369 7369 6f6e 5f73 636f  ed_precision_sco
+0003fc40: 7265 720d 0a20 2020 2020 2020 2020 2020  rer..           
+0003fc50: 2065 6c69 6620 7363 6f72 696e 675f 7061   elif scoring_pa
+0003fc60: 7261 6d65 7465 7220 3d3d 2027 6d61 6372  rameter == 'macr
+0003fc70: 6f5f 7072 6563 6973 696f 6e27 3a0d 0a20  o_precision':.. 
+0003fc80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0003fc90: 6163 726f 5f70 7265 6369 7369 6f6e 5f73  acro_precision_s
+0003fca0: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+0003fcb0: 7265 7228 6769 6e69 5f6d 6163 726f 5f70  rer(gini_macro_p
+0003fcc0: 7265 6369 7369 6f6e 2c0d 0a20 2020 2020  recision,..     
+0003fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd00: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+0003fd10: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+0003fd20: 6f62 613d 5472 7565 290d 0a20 2020 2020  oba=True)..     
+0003fd30: 2020 2020 2020 2020 2020 2073 636f 7265             score
+0003fd40: 7220 3d20 6d61 6372 6f5f 7072 6563 6973  r = macro_precis
+0003fd50: 696f 6e5f 7363 6f72 6572 0d0a 2020 2020  ion_scorer..    
+0003fd60: 2020 2020 2020 2020 656c 6966 2073 636f          elif sco
+0003fd70: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
+0003fd80: 3d20 276d 6963 726f 5f70 7265 6369 7369  = 'micro_precisi
+0003fd90: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
+0003fda0: 2020 2020 2020 7363 6f72 6572 203d 206d        scorer = m
+0003fdb0: 6963 726f 5f70 7265 6369 7369 6f6e 5f73  icro_precision_s
+0003fdc0: 636f 7265 720d 0a20 2020 2020 2020 2020  corer..         
+0003fdd0: 2020 2020 2020 206d 6963 726f 5f70 7265         micro_pre
+0003fde0: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
+0003fdf0: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+0003fe00: 5f6d 6963 726f 5f70 7265 6369 7369 6f6e  _micro_precision
+0003fe10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe40: 2020 2020 2020 2020 6772 6561 7465 725f          greater_
+0003fe50: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+0003fe60: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
+0003fe70: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0003fe80: 2065 6c69 6620 7363 6f72 696e 675f 7061   elif scoring_pa
+0003fe90: 7261 6d65 7465 7220 3d3d 2027 7361 6d70  rameter == 'samp
+0003fea0: 6c65 735f 7265 6361 6c6c 273a 0d0a 2020  les_recall':..  
+0003feb0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+0003fec0: 6d70 6c65 735f 7265 6361 6c6c 5f73 636f  mples_recall_sco
+0003fed0: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
+0003fee0: 7228 6769 6e69 5f73 616d 706c 6573 5f72  r(gini_samples_r
+0003fef0: 6563 616c 6c2c 2067 7265 6174 6572 5f69  ecall, greater_i
+0003ff00: 735f 6265 7474 6572 3d54 7275 652c 206e  s_better=True, n
+0003ff10: 6565 6473 5f70 726f 6261 3d54 7275 6529  eeds_proba=True)
+0003ff20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ff30: 2020 7363 6f72 6572 203d 2073 616d 706c    scorer = sampl
+0003ff40: 6573 5f72 6563 616c 6c5f 7363 6f72 6572  es_recall_scorer
+0003ff50: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003ff60: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+0003ff70: 6574 6572 203d 3d20 2777 6569 6768 7465  eter == 'weighte
+0003ff80: 645f 7265 6361 6c6c 2720 6f72 2073 636f  d_recall' or sco
+0003ff90: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
+0003ffa0: 3d20 2777 6569 6768 7465 642d 7265 6361  = 'weighted-reca
+0003ffb0: 6c6c 273a 0d0a 2020 2020 2020 2020 2020  ll':..          
+0003ffc0: 2020 2020 2020 7765 6967 6874 6564 5f72        weighted_r
+0003ffd0: 6563 616c 6c5f 7363 6f72 6572 203d 206d  ecall_scorer = m
+0003ffe0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+0003fff0: 7765 6967 6874 6564 5f72 6563 616c 6c2c  weighted_recall,
+00040000: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00040010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040030: 2020 2020 2020 2067 7265 6174 6572 5f69         greater_i
+00040040: 735f 6265 7474 6572 3d54 7275 652c 206e  s_better=True, n
+00040050: 6565 6473 5f70 726f 6261 3d54 7275 6529  eeds_proba=True)
+00040060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00040070: 2020 7363 6f72 6572 203d 2077 6569 6768    scorer = weigh
+00040080: 7465 645f 7265 6361 6c6c 5f73 636f 7265  ted_recall_score
+00040090: 720d 0a20 2020 2020 2020 2020 2020 2065  r..            e
+000400a0: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
+000400b0: 6d65 7465 7220 3d3d 2027 6d61 6372 6f5f  meter == 'macro_
+000400c0: 7265 6361 6c6c 273a 0d0a 2020 2020 2020  recall':..      
+000400d0: 2020 2020 2020 2020 2020 6d61 6372 6f5f            macro_
+000400e0: 7265 6361 6c6c 5f73 636f 7265 7220 3d20  recall_scorer = 
+000400f0: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+00040100: 5f6d 6163 726f 5f72 6563 616c 6c2c 0d0a  _macro_recall,..
+00040110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040140: 2020 6772 6561 7465 725f 6973 5f62 6574    greater_is_bet
+00040150: 7465 723d 5472 7565 2c20 6e65 6564 735f  ter=True, needs_
+00040160: 7072 6f62 613d 5472 7565 290d 0a20 2020  proba=True)..   
+00040170: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+00040180: 7265 7220 3d20 6d61 6372 6f5f 7265 6361  rer = macro_reca
+00040190: 6c6c 5f73 636f 7265 720d 0a20 2020 2020  ll_scorer..     
+000401a0: 2020 2020 2020 2065 6c69 6620 7363 6f72         elif scor
+000401b0: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
+000401c0: 2027 6d69 6372 6f5f 7265 6361 6c6c 273a   'micro_recall':
+000401d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000401e0: 2020 6d69 6372 6f5f 7265 6361 6c6c 5f73    micro_recall_s
+000401f0: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+00040200: 7265 7228 6769 6e69 5f6d 6963 726f 5f72  rer(gini_micro_r
+00040210: 6563 616c 6c2c 2067 7265 6174 6572 5f69  ecall, greater_i
+00040220: 735f 6265 7474 6572 3d54 7275 652c 206e  s_better=True, n
+00040230: 6565 6473 5f70 726f 6261 3d54 7275 6529  eeds_proba=True)
+00040240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00040250: 2020 7363 6f72 6572 203d 206d 6963 726f    scorer = micro
+00040260: 5f72 6563 616c 6c5f 7363 6f72 6572 0d0a  _recall_scorer..
+00040270: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00040280: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+00040290: 6574 6572 203d 3d20 2773 616d 706c 6573  eter == 'samples
+000402a0: 5f66 3127 3a0d 0a20 2020 2020 2020 2020  _f1':..         
+000402b0: 2020 2020 2020 2073 616d 706c 6573 5f66         samples_f
+000402c0: 315f 7363 6f72 6572 203d 206d 616b 655f  1_scorer = make_
+000402d0: 7363 6f72 6572 2867 696e 695f 7361 6d70  scorer(gini_samp
+000402e0: 6c65 735f 6631 2c0d 0a20 2020 2020 2020  les_f1,..       
+000402f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040310: 2020 2020 2020 2020 2067 7265 6174 6572           greater
+00040320: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00040330: 206e 6565 6473 5f70 726f 6261 3d54 7275   needs_proba=Tru
+00040340: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00040350: 2020 2020 7363 6f72 6572 203d 2073 616d      scorer = sam
+00040360: 706c 6573 5f66 315f 7363 6f72 6572 0d0a  ples_f1_scorer..
+00040370: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00040380: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00040390: 6572 203d 3d20 2777 6569 6768 7465 645f  er == 'weighted_
+000403a0: 6631 2720 6f72 2073 636f 7269 6e67 5f70  f1' or scoring_p
+000403b0: 6172 616d 6574 6572 203d 3d20 2777 6569  arameter == 'wei
+000403c0: 6768 7465 642d 6631 273a 0d0a 2020 2020  ghted-f1':..    
+000403d0: 2020 2020 2020 2020 2020 2020 7765 6967              weig
+000403e0: 6874 6564 5f66 315f 7363 6f72 6572 203d  hted_f1_scorer =
+000403f0: 206d 616b 655f 7363 6f72 6572 2867 696e   make_scorer(gin
+00040400: 695f 7765 6967 6874 6564 5f66 312c 0d0a  i_weighted_f1,..
+00040410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040440: 2067 7265 6174 6572 5f69 735f 6265 7474   greater_is_bett
+00040450: 6572 3d54 7275 652c 206e 6565 6473 5f70  er=True, needs_p
+00040460: 726f 6261 3d54 7275 6529 0d0a 2020 2020  roba=True)..    
+00040470: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+00040480: 6572 203d 2077 6569 6768 7465 645f 6631  er = weighted_f1
+00040490: 5f73 636f 7265 720d 0a20 2020 2020 2020  _scorer..       
+000404a0: 2020 2020 2065 6c69 6620 7363 6f72 696e       elif scorin
+000404b0: 675f 7061 7261 6d65 7465 7220 3d3d 2027  g_parameter == '
+000404c0: 6d61 6372 6f5f 6631 273a 0d0a 2020 2020  macro_f1':..    
+000404d0: 2020 2020 2020 2020 2020 2020 6d61 6372              macr
+000404e0: 6f5f 6631 5f73 636f 7265 7220 3d20 6d61  o_f1_scorer = ma
+000404f0: 6b65 5f73 636f 7265 7228 6769 6e69 5f6d  ke_scorer(gini_m
+00040500: 6163 726f 5f66 312c 0d0a 2020 2020 2020  acro_f1,..      
+00040510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040530: 2020 2020 2020 2020 6772 6561 7465 725f          greater_
+00040540: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+00040550: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
+00040560: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00040570: 2020 2073 636f 7265 7220 3d20 6d61 6372     scorer = macr
+00040580: 6f5f 6631 5f73 636f 7265 720d 0a20 2020  o_f1_scorer..   
+00040590: 2020 2020 2020 2020 2065 6c69 6620 7363           elif sc
+000405a0: 6f72 696e 675f 7061 7261 6d65 7465 7220  oring_parameter 
+000405b0: 3d3d 2027 6d69 6372 6f5f 6631 273a 0d0a  == 'micro_f1':..
+000405c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405d0: 6d69 6372 6f5f 6631 5f73 636f 7265 7220  micro_f1_scorer 
+000405e0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+000405f0: 6e69 5f6d 6963 726f 5f66 312c 0d0a 2020  ni_micro_f1,..  
+00040600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040620: 2020 2020 2020 2020 2020 2020 6772 6561              grea
+00040630: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00040640: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00040650: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
+00040660: 2020 2020 2020 2073 636f 7265 7220 3d20         scorer = 
+00040670: 6d69 6372 6f5f 6631 5f73 636f 7265 720d  micro_f1_scorer.
+00040680: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00040690: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000406a0: 2020 2020 7765 6967 6874 6564 5f66 315f      weighted_f1_
+000406b0: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
+000406c0: 6f72 6572 2867 696e 695f 7765 6967 6874  orer(gini_weight
+000406d0: 6564 5f66 312c 0d0a 2020 2020 2020 2020  ed_f1,..        
+000406e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000406f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040700: 2020 2020 2020 2020 2067 7265 6174 6572           greater
+00040710: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00040720: 206e 6565 6473 5f70 726f 6261 3d54 7275   needs_proba=Tru
+00040730: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00040740: 2020 2020 7363 6f72 6572 203d 2077 6569      scorer = wei
+00040750: 6768 7465 645f 6631 5f73 636f 7265 720d  ghted_f1_scorer.
+00040760: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+00040770: 6f72 7420 7363 6970 7920 6173 2073 700d  ort scipy as sp.
+00040780: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00040790: 6879 7065 725f 7061 7261 6d20 3d3d 2027  hyper_param == '
+000407a0: 4753 273a 0d0a 2020 2020 2020 2020 2020  GS':..          
+000407b0: 2020 2020 2020 635f 7061 7261 6d73 5b27        c_params['
+000407c0: 5847 426f 6f73 7427 5d20 3d20 7b0d 0a20  XGBoost'] = {.. 
+000407d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000407e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000407f0: 6c65 6172 6e69 6e67 5f72 6174 6527 3a20  learning_rate': 
+00040800: 6e70 2e6c 696e 7370 6163 6528 302e 312c  np.linspace(0.1,
+00040810: 302e 352c 3529 2c0d 0a20 2020 2020 2020  0.5,5),..       
+00040820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040830: 2020 2020 2020 2020 2027 6761 6d6d 6127           'gamma'
+00040840: 3a20 6e70 2e6c 696e 7370 6163 6528 302c  : np.linspace(0,
+00040850: 2033 322c 3729 2e61 7374 7970 6528 696e   32,7).astype(in
+00040860: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
+00040870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040880: 2020 2020 2022 6e5f 6573 7469 6d61 746f       "n_estimato
+00040890: 7273 223a 206e 702e 6c69 6e73 7061 6365  rs": np.linspace
+000408a0: 2831 3030 2c20 6d61 785f 6573 7469 6d73  (100, max_estims
+000408b0: 2c20 3329 2e61 7374 7970 6528 696e 7429  , 3).astype(int)
+000408c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000408d0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+000408e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000408f0: 2020 635f 7061 7261 6d73 5b22 4361 7442    c_params["CatB
+00040900: 6f6f 7374 225d 203d 207b 0d0a 2020 2020  oost"] = {..    
+00040910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040920: 2020 2020 2020 2020 2020 2020 276c 6561              'lea
+00040930: 726e 696e 675f 7261 7465 273a 206e 702e  rning_rate': np.
+00040940: 6c6f 6773 7061 6365 2841 6c70 6861 5f6d  logspace(Alpha_m
+00040950: 696e 2c41 6c70 6861 5f6d 6178 2c34 3029  in,Alpha_max,40)
+00040960: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00040970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040980: 2020 207d 0d0a 2020 2020 2020 2020 2020     }..          
+00040990: 2020 2020 2020 6966 2049 6d62 616c 616e        if Imbalan
+000409a0: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
+000409b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000409c0: 5f70 6172 616d 735b 274c 696e 6561 7227  _params['Linear'
+000409d0: 5d20 3d20 7b0d 0a20 2020 2020 2020 2020  ] = {..         
 000409e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409f0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
-00040a00: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00040a10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00040a20: 2020 2020 2020 2063 5f70 6172 616d 735b         c_params[
-00040a30: 274c 696e 6561 7227 5d20 3d20 7b0d 0a20  'Linear'] = {.. 
-00040a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00040a60: 4327 3a20 4373 2c0d 0a20 2020 2020 2020  C': Cs,..       
-00040a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a80: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
-00040a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040aa0: 635f 7061 7261 6d73 5b22 466f 7265 7374  c_params["Forest
-00040ab0: 7322 5d20 3d20 7b0d 0a20 2020 2020 2020  s"] = {..       
-00040ac0: 2020 2020 2020 2020 2023 2323 2323 2049           ##### I
-00040ad0: 2068 6176 6520 7365 6c65 6374 6564 2074   have selected t
-00040ae0: 6865 7365 2074 6f20 6176 6f69 6420 4f76  hese to avoid Ov
-00040af0: 6572 6669 7474 696e 6720 7768 6963 6820  erfitting which 
-00040b00: 6973 2061 2070 726f 626c 656d 2066 6f72  is a problem for
-00040b10: 2073 6d61 6c6c 2064 6174 6120 7365 7473   small data sets
-00040b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040b30: 2020 2020 2020 2020 2020 226e 5f65 7374            "n_est
-00040b40: 696d 6174 6f72 7322 203a 206e 702e 6c69  imators" : np.li
-00040b50: 6e73 7061 6365 2831 3030 2c20 6d61 785f  nspace(100, max_
-00040b60: 6573 7469 6d73 2c20 6e5f 7374 6570 732c  estims, n_steps,
-00040b70: 2064 7479 7065 203d 2022 696e 7422 292c   dtype = "int"),
-00040b80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040b90: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-00040ba0: 6178 5f64 6570 7468 223a 205b 332c 2035  ax_depth": [3, 5
-00040bb0: 2c20 6d61 785f 6465 7074 685d 2c0d 0a20  , max_depth],.. 
-00040bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040bd0: 2020 2020 2020 2020 2020 2023 2263 7269             #"cri
-00040be0: 7465 7269 6f6e 223a 5b27 6769 6e69 272c  terion":['gini',
-00040bf0: 2765 6e74 726f 7079 275d 2c0d 0a20 2020  'entropy'],..   
-00040c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c20: 207d 0d0a 2020 2020 2020 2020 2020 2020   }..            
-00040c30: 2020 2020 635f 7061 7261 6d73 5b22 4d75      c_params["Mu
-00040c40: 6c74 695f 4c61 6265 6c22 5d20 3d20 7b0d  lti_Label"] = {.
-00040c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040c60: 2020 2020 2020 2020 2020 2020 2027 6573               'es
-00040c70: 7469 6d61 746f 725f 5f43 273a 205b 3165  timator__C': [1e
-00040c80: 2d33 2c20 3165 2d32 2c20 3165 2d31 2c20  -3, 1e-2, 1e-1, 
-00040c90: 3165 302c 2031 6531 2c20 3165 322c 2031  1e0, 1e1, 1e2, 1
-00040ca0: 6533 5d0d 0a20 2020 2020 2020 2020 2020  e3]..           
-00040cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040cc0: 207d 0d0a 2020 2020 2020 2020 2020 2020   }..            
-00040cd0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00040ce0: 2020 2020 2020 2069 6d70 6f72 7420 7363         import sc
-00040cf0: 6970 7920 6173 2073 700d 0a20 2020 2020  ipy as sp..     
-00040d00: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
-00040d10: 616d 735b 2758 4742 6f6f 7374 275d 203d  ams['XGBoost'] =
-00040d20: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-00040d30: 2020 2020 2020 2020 2020 2020 276c 6561              'lea
-00040d40: 726e 696e 675f 7261 7465 273a 2073 702e  rning_rate': sp.
-00040d50: 7374 6174 732e 756e 6966 6f72 6d28 7363  stats.uniform(sc
-00040d60: 616c 653d 3129 2c0d 0a20 2020 2020 2020  ale=1),..       
-00040d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d80: 2027 6761 6d6d 6127 3a20 7370 2e73 7461   'gamma': sp.sta
-00040d90: 7473 2e72 616e 6469 6e74 2830 2c20 3332  ts.randint(0, 32
-00040da0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00040db0: 2020 2020 2020 2020 2020 2027 6e5f 6573             'n_es
-00040dc0: 7469 6d61 746f 7273 273a 2073 702e 7374  timators': sp.st
-00040dd0: 6174 732e 7261 6e64 696e 7428 3130 302c  ats.randint(100,
-00040de0: 206d 6178 5f65 7374 696d 7329 2c0d 0a20   max_estims),.. 
-00040df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040e00: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-00040e10: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
-00040e20: 5b27 4361 7442 6f6f 7374 275d 203d 207b  ['CatBoost'] = {
-00040e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040e40: 2020 2020 2020 2020 2020 276c 6561 726e            'learn
-00040e50: 696e 675f 7261 7465 273a 2073 702e 7374  ing_rate': sp.st
-00040e60: 6174 732e 756e 6966 6f72 6d28 7363 616c  ats.uniform(scal
-00040e70: 653d 3129 2c0d 0a20 2020 2020 2020 2020  e=1),..         
-00040e80: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00040e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040ea0: 2020 6966 2049 6d62 616c 616e 6365 645f    if Imbalanced_
-00040eb0: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-00040ec0: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
-00040ed0: 616d 735b 274c 696e 6561 7227 5d20 3d20  ams['Linear'] = 
-00040ee0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-00040ef0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00040f00: 4327 3a20 7370 2e73 7461 7473 2e75 6e69  C': sp.stats.uni
-00040f10: 666f 726d 2873 6361 6c65 3d31 3030 292c  form(scale=100),
-00040f20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040f30: 2020 2020 2020 2020 2020 2020 2020 2763                'c
-00040f40: 6c61 7373 5f77 6569 6768 7427 3a5b 4e6f  lass_weight':[No
-00040f50: 6e65 2c20 2762 616c 616e 6365 6427 5d2c  ne, 'balanced'],
-00040f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040f70: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
-00040f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040f90: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00040fa0: 2020 2020 2020 2020 2020 2020 635f 7061              c_pa
-00040fb0: 7261 6d73 5b27 4c69 6e65 6172 275d 203d  rams['Linear'] =
-00040fc0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
+000409f0: 2020 2020 2020 2027 4327 3a20 4373 2c0d         'C': Cs,.
+00040a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040a10: 2020 2020 2020 2020 2020 2020 2027 636c               'cl
+00040a20: 6173 735f 7765 6967 6874 273a 5b4e 6f6e  ass_weight':[Non
+00040a30: 652c 2027 6261 6c61 6e63 6564 275d 2c0d  e, 'balanced'],.
+00040a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040a50: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
+00040a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00040a80: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
+00040a90: 616d 735b 274c 696e 6561 7227 5d20 3d20  ams['Linear'] = 
+00040aa0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
+00040ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ac0: 2020 2027 4327 3a20 4373 2c0d 0a20 2020     'C': Cs,..   
+00040ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040af0: 207d 0d0a 2020 2020 2020 2020 2020 2020   }..            
+00040b00: 2020 2020 635f 7061 7261 6d73 5b22 466f      c_params["Fo
+00040b10: 7265 7374 7322 5d20 3d20 7b0d 0a20 2020  rests"] = {..   
+00040b20: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00040b30: 2323 2049 2068 6176 6520 7365 6c65 6374  ## I have select
+00040b40: 6564 2074 6865 7365 2074 6f20 6176 6f69  ed these to avoi
+00040b50: 6420 4f76 6572 6669 7474 696e 6720 7768  d Overfitting wh
+00040b60: 6963 6820 6973 2061 2070 726f 626c 656d  ich is a problem
+00040b70: 2066 6f72 2073 6d61 6c6c 2064 6174 6120   for small data 
+00040b80: 7365 7473 0d0a 2020 2020 2020 2020 2020  sets..          
+00040b90: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00040ba0: 5f65 7374 696d 6174 6f72 7322 203a 206e  _estimators" : n
+00040bb0: 702e 6c69 6e73 7061 6365 2831 3030 2c20  p.linspace(100, 
+00040bc0: 6d61 785f 6573 7469 6d73 2c20 6e5f 7374  max_estims, n_st
+00040bd0: 6570 732c 2064 7479 7065 203d 2022 696e  eps, dtype = "in
+00040be0: 7422 292c 0d0a 2020 2020 2020 2020 2020  t"),..          
+00040bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c00: 2020 226d 6178 5f64 6570 7468 223a 205b    "max_depth": [
+00040c10: 332c 2035 2c20 6d61 785f 6465 7074 685d  3, 5, max_depth]
+00040c20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00040c30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00040c40: 2263 7269 7465 7269 6f6e 223a 5b27 6769  "criterion":['gi
+00040c50: 6e69 272c 2765 6e74 726f 7079 275d 2c0d  ni','entropy'],.
+00040c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c80: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
+00040c90: 2020 2020 2020 2020 635f 7061 7261 6d73          c_params
+00040ca0: 5b22 4d75 6c74 695f 4c61 6265 6c22 5d20  ["Multi_Label"] 
+00040cb0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+00040cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040cd0: 2027 6573 7469 6d61 746f 725f 5f43 273a   'estimator__C':
+00040ce0: 205b 3165 2d33 2c20 3165 2d32 2c20 3165   [1e-3, 1e-2, 1e
+00040cf0: 2d31 2c20 3165 302c 2031 6531 2c20 3165  -1, 1e0, 1e1, 1e
+00040d00: 322c 2031 6533 5d0d 0a20 2020 2020 2020  2, 1e3]..       
+00040d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d20: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
+00040d30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00040d40: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00040d50: 7420 7363 6970 7920 6173 2073 700d 0a20  t scipy as sp.. 
+00040d60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00040d70: 5f70 6172 616d 735b 2758 4742 6f6f 7374  _params['XGBoost
+00040d80: 275d 203d 207b 0d0a 2020 2020 2020 2020  '] = {..        
+00040d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040da0: 276c 6561 726e 696e 675f 7261 7465 273a  'learning_rate':
+00040db0: 2073 702e 7374 6174 732e 756e 6966 6f72   sp.stats.unifor
+00040dc0: 6d28 7363 616c 653d 3129 2c0d 0a20 2020  m(scale=1),..   
+00040dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040de0: 2020 2020 2027 6761 6d6d 6127 3a20 7370       'gamma': sp
+00040df0: 2e73 7461 7473 2e72 616e 6469 6e74 2830  .stats.randint(0
+00040e00: 2c20 3332 292c 0d0a 2020 2020 2020 2020  , 32),..        
+00040e10: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00040e20: 6e5f 6573 7469 6d61 746f 7273 273a 2073  n_estimators': s
+00040e30: 702e 7374 6174 732e 7261 6e64 696e 7428  p.stats.randint(
+00040e40: 3130 302c 206d 6178 5f65 7374 696d 7329  100, max_estims)
+00040e50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00040e60: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+00040e70: 2020 2020 2020 2020 2020 2020 635f 7061              c_pa
+00040e80: 7261 6d73 5b27 4361 7442 6f6f 7374 275d  rams['CatBoost']
+00040e90: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
+00040ea0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+00040eb0: 6561 726e 696e 675f 7261 7465 273a 2073  earning_rate': s
+00040ec0: 702e 7374 6174 732e 756e 6966 6f72 6d28  p.stats.uniform(
+00040ed0: 7363 616c 653d 3129 2c0d 0a20 2020 2020  scale=1),..     
+00040ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ef0: 2020 207d 0d0a 2020 2020 2020 2020 2020     }..          
+00040f00: 2020 2020 2020 6966 2049 6d62 616c 616e        if Imbalan
+00040f10: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
+00040f20: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00040f30: 5f70 6172 616d 735b 274c 696e 6561 7227  _params['Linear'
+00040f40: 5d20 3d20 7b0d 0a20 2020 2020 2020 2020  ] = {..         
+00040f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f60: 2020 2027 4327 3a20 7370 2e73 7461 7473     'C': sp.stats
+00040f70: 2e75 6e69 666f 726d 2873 6361 6c65 3d31  .uniform(scale=1
+00040f80: 3030 292c 0d0a 2020 2020 2020 2020 2020  00),..          
+00040f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fa0: 2020 2763 6c61 7373 5f77 6569 6768 7427    'class_weight'
+00040fb0: 3a5b 4e6f 6e65 2c20 2762 616c 616e 6365  :[None, 'balance
+00040fc0: 6427 5d2c 0d0a 2020 2020 2020 2020 2020  d'],..          
 00040fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040fe0: 2743 273a 2073 702e 7374 6174 732e 756e  'C': sp.stats.un
-00040ff0: 6966 6f72 6d28 7363 616c 653d 3130 3029  iform(scale=100)
-00041000: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00041010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041020: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-00041030: 2020 2020 2020 2020 2020 635f 7061 7261            c_para
-00041040: 6d73 5b22 466f 7265 7374 7322 5d20 3d20  ms["Forests"] = 
-00041050: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-00041060: 2020 2023 2323 2323 2020 2049 2068 6176     #####   I hav
-00041070: 6520 7365 7420 7468 6573 6520 746f 2061  e set these to a
-00041080: 766f 6964 204f 7665 7246 6974 7469 6e67  void OverFitting
-00041090: 2077 6869 6368 2069 7320 6120 7072 6f62   which is a prob
-000410a0: 6c65 6d20 666f 7220 736d 616c 6c20 6461  lem for small da
-000410b0: 7461 2073 6574 7320 2323 230d 0a20 2020  ta sets ###..   
-000410c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000410d0: 2020 2020 2020 2020 276e 5f65 7374 696d          'n_estim
-000410e0: 6174 6f72 7327 3a20 7370 2e73 7461 7473  ators': sp.stats
-000410f0: 2e72 616e 6469 6e74 2831 3030 2c6d 6178  .randint(100,max
-00041100: 5f65 7374 696d 7329 2c0d 0a20 2020 2020  _estims),..     
-00041110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041120: 2020 2020 2020 2022 6d61 785f 6465 7074         "max_dept
-00041130: 6822 3a20 7370 2e73 7461 7473 2e72 616e  h": sp.stats.ran
-00041140: 6469 6e74 2833 2c20 6d61 785f 6465 7074  dint(3, max_dept
-00041150: 6829 2c0d 0a20 2020 2020 2020 2020 2020  h),..           
-00041160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041170: 2022 6d69 6e5f 7361 6d70 6c65 735f 6c65   "min_samples_le
-00041180: 6166 223a 2073 702e 7374 6174 732e 7261  af": sp.stats.ra
-00041190: 6e64 696e 7428 322c 2032 3029 2c0d 0a20  ndint(2, 20),.. 
-000411a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000411b0: 2020 2020 2020 2020 2020 2023 2263 7269             #"cri
-000411c0: 7465 7269 6f6e 223a 5b27 6769 6e69 272c  terion":['gini',
-000411d0: 2765 6e74 726f 7079 275d 2c0d 0a20 2020  'entropy'],..   
-000411e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000411f0: 2020 2020 2020 2020 2023 2763 6c61 7373           #'class
-00041200: 5f77 6569 6768 7427 3a5b 4e6f 6e65 2c27  _weight':[None,'
-00041210: 6261 6c61 6e63 6564 275d 0d0a 2020 2020  balanced']..    
-00041220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041240: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
-00041250: 2020 2020 2020 2063 5f70 6172 616d 735b         c_params[
-00041260: 224d 756c 7469 5f4c 6162 656c 225d 203d  "Multi_Label"] =
-00041270: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
+00040fe0: 2020 7d0d 0a20 2020 2020 2020 2020 2020    }..           
+00040ff0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00041000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041010: 635f 7061 7261 6d73 5b27 4c69 6e65 6172  c_params['Linear
+00041020: 275d 203d 207b 0d0a 2020 2020 2020 2020  '] = {..        
+00041030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041040: 2020 2020 2743 273a 2073 702e 7374 6174      'C': sp.stat
+00041050: 732e 756e 6966 6f72 6d28 7363 616c 653d  s.uniform(scale=
+00041060: 3130 3029 2c0d 0a20 2020 2020 2020 2020  100),..         
+00041070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041080: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
+00041090: 2020 2020 2020 2020 2020 2020 2020 635f                c_
+000410a0: 7061 7261 6d73 5b22 466f 7265 7374 7322  params["Forests"
+000410b0: 5d20 3d20 7b0d 0a20 2020 2020 2020 2020  ] = {..         
+000410c0: 2020 2020 2020 2023 2323 2323 2020 2049         #####   I
+000410d0: 2068 6176 6520 7365 7420 7468 6573 6520   have set these 
+000410e0: 746f 2061 766f 6964 204f 7665 7246 6974  to avoid OverFit
+000410f0: 7469 6e67 2077 6869 6368 2069 7320 6120  ting which is a 
+00041100: 7072 6f62 6c65 6d20 666f 7220 736d 616c  problem for smal
+00041110: 6c20 6461 7461 2073 6574 7320 2323 230d  l data sets ###.
+00041120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041130: 2020 2020 2020 2020 2020 2020 276e 5f65              'n_e
+00041140: 7374 696d 6174 6f72 7327 3a20 7370 2e73  stimators': sp.s
+00041150: 7461 7473 2e72 616e 6469 6e74 2831 3030  tats.randint(100
+00041160: 2c6d 6178 5f65 7374 696d 7329 2c0d 0a20  ,max_estims),.. 
+00041170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041180: 2020 2020 2020 2020 2020 2022 6d61 785f             "max_
+00041190: 6465 7074 6822 3a20 7370 2e73 7461 7473  depth": sp.stats
+000411a0: 2e72 616e 6469 6e74 2833 2c20 6d61 785f  .randint(3, max_
+000411b0: 6465 7074 6829 2c0d 0a20 2020 2020 2020  depth),..       
+000411c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411d0: 2020 2020 2022 6d69 6e5f 7361 6d70 6c65       "min_sample
+000411e0: 735f 6c65 6166 223a 2073 702e 7374 6174  s_leaf": sp.stat
+000411f0: 732e 7261 6e64 696e 7428 322c 2032 3029  s.randint(2, 20)
+00041200: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00041210: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00041220: 2263 7269 7465 7269 6f6e 223a 5b27 6769  "criterion":['gi
+00041230: 6e69 272c 2765 6e74 726f 7079 275d 2c0d  ni','entropy'],.
+00041240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041250: 2020 2020 2020 2020 2020 2020 2023 2763               #'c
+00041260: 6c61 7373 5f77 6569 6768 7427 3a5b 4e6f  lass_weight':[No
+00041270: 6e65 2c27 6261 6c61 6e63 6564 275d 0d0a  ne,'balanced']..
 00041280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041290: 2323 2320 7468 6973 2069 7320 7468 6520  ### this is the 
-000412a0: 6265 7374 2070 6172 616d 7320 666f 7220  best params for 
-000412b0: 6c6f 6769 7374 6963 2072 6567 7265 7373  logistic regress
-000412c0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-000412d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000412e0: 2065 7374 696d 6174 6f72 5f73 7472 696e   estimator_strin
-000412f0: 672b 2743 273a 2073 702e 7374 6174 732e  g+'C': sp.stats.
-00041300: 756e 6966 6f72 6d2e 7276 7328 6c6f 633d  uniform.rvs(loc=
-00041310: 302e 3031 2c73 6361 6c65 3d31 302c 7369  0.01,scale=10,si
-00041320: 7a65 3d31 3030 3029 0d0a 2020 2020 2020  ze=1000)..      
+00041290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000412a0: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
+000412b0: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
+000412c0: 616d 735b 224d 756c 7469 5f4c 6162 656c  ams["Multi_Label
+000412d0: 225d 203d 207b 0d0a 2020 2020 2020 2020  "] = {..        
+000412e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000412f0: 2020 2020 2323 2320 7468 6973 2069 7320      ### this is 
+00041300: 7468 6520 6265 7374 2070 6172 616d 7320  the best params 
+00041310: 666f 7220 6c6f 6769 7374 6963 2072 6567  for logistic reg
+00041320: 7265 7373 696f 6e0d 0a20 2020 2020 2020  ression..       
 00041330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041340: 2020 7d0d 0a20 2020 2020 2020 2020 2020    }..           
-00041350: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00041360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00041390: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-000413a0: 2020 6966 2042 6f6f 7374 696e 675f 466c    if Boosting_Fl
-000413b0: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
-000413c0: 2020 2020 2023 2043 7265 6174 6520 7265       # Create re
-000413d0: 6775 6c61 7269 7a61 7469 6f6e 2068 7970  gularization hyp
-000413e0: 6572 7061 7261 6d65 7465 7220 6469 7374  erparameter dist
-000413f0: 7269 6275 7469 6f6e 2075 7369 6e67 2075  ribution using u
-00041400: 6e69 666f 726d 2064 6973 7472 6962 7574  niform distribut
-00041410: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-00041420: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
-00041430: 6d65 2e6c 6f77 6572 2829 203d 3d20 2763  me.lower() == 'c
-00041440: 6174 626f 6f73 7427 3a0d 0a20 2020 2020  atboost':..     
-00041450: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00041460: 6762 6d20 3d20 2043 6174 426f 6f73 7443  gbm =  CatBoostC
-00041470: 6c61 7373 6966 6965 7228 7665 7262 6f73  lassifier(verbos
-00041480: 653d 312c 6974 6572 6174 696f 6e73 3d6d  e=1,iterations=m
-00041490: 6178 5f65 7374 696d 732c 0d0a 2020 2020  ax_estims,..    
-000414a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000414b0: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-000414c0: 7461 7465 3d39 392c 6f6e 655f 686f 745f  tate=99,one_hot_
-000414d0: 6d61 785f 7369 7a65 3d6f 6e65 5f68 6f74  max_size=one_hot
-000414e0: 5f73 697a 652c 0d0a 2020 2020 2020 2020  _size,..        
-000414f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041500: 2020 2020 6c6f 7373 5f66 756e 6374 696f      loss_functio
-00041510: 6e3d 6c6f 7373 5f66 756e 6374 696f 6e2c  n=loss_function,
-00041520: 2065 7661 6c5f 6d65 7472 6963 3d63 6174   eval_metric=cat
-00041530: 626f 6f73 745f 7363 6f72 696e 672c 0d0a  boost_scoring,..
-00041540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041550: 2020 2020 2020 2020 2020 2020 7375 6273              subs
-00041560: 616d 706c 653d 7375 6273 616d 706c 652c  ample=subsample,
-00041570: 626f 6f74 7374 7261 705f 7479 7065 3d27  bootstrap_type='
-00041580: 4265 726e 6f75 6c6c 6927 2c0d 0a20 2020  Bernoulli',..   
-00041590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000415a0: 2020 2020 2020 2020 206d 6574 7269 635f           metric_
-000415b0: 7065 7269 6f64 203d 2035 3030 2c0d 0a20  period = 500,.. 
-000415c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000415d0: 2020 2020 2020 2020 2020 6561 726c 795f            early_
-000415e0: 7374 6f70 7069 6e67 5f72 6f75 6e64 733d  stopping_rounds=
-000415f0: 3230 3030 2c62 6f6f 7374 696e 675f 7479  2000,boosting_ty
-00041600: 7065 3d27 506c 6169 6e27 290d 0a20 2020  pe='Plain')..   
-00041610: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00041620: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00041630: 2020 2020 2020 2020 2378 6762 6d20 3d20          #xgbm = 
-00041640: 5847 4243 6c61 7373 6966 6965 7228 6261  XGBClassifier(ba
-00041650: 7365 5f73 636f 7265 3d30 2e35 2c20 626f  se_score=0.5, bo
-00041660: 6f73 7465 723d 2767 6274 7265 6527 2c20  oster='gbtree', 
-00041670: 7375 6273 616d 706c 653d 7375 6273 616d  subsample=subsam
-00041680: 706c 652c 0d0a 2020 2020 2020 2020 2020  ple,..          
-00041690: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-000416a0: 2020 2020 2020 2063 6f6c 7361 6d70 6c65         colsample
-000416b0: 5f62 7974 7265 653d 636f 6c5f 7375 625f  _bytree=col_sub_
-000416c0: 7361 6d70 6c65 2c20 6761 6d6d 613d 312c  sample, gamma=1,
-000416d0: 206c 6561 726e 696e 675f 7261 7465 3d30   learning_rate=0
-000416e0: 2e31 2c20 6d61 785f 6465 6c74 615f 7374  .1, max_delta_st
-000416f0: 6570 3d30 2c0d 0a20 2020 2020 2020 2020  ep=0,..         
-00041700: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-00041710: 6d61 785f 6465 7074 683d 6d61 785f 6465  max_depth=max_de
-00041720: 7074 682c 206d 696e 5f63 6869 6c64 5f77  pth, min_child_w
-00041730: 6569 6768 743d 312c 206d 6973 7369 6e67  eight=1, missing
-00041740: 3d2d 3939 392c 206e 5f65 7374 696d 6174  =-999, n_estimat
-00041750: 6f72 733d 3230 302c 0d0a 2020 2020 2020  ors=200,..      
-00041760: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00041770: 2020 206e 5f6a 6f62 733d 2d31 2c20 6e74     n_jobs=-1, nt
-00041780: 6872 6561 643d 2d31 2c20 6f62 6a65 6374  hread=-1, object
-00041790: 6976 653d 6f62 6a65 6374 6976 652c 0d0a  ive=objective,..
-000417a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000417b0: 2020 2020 2320 2020 2072 616e 646f 6d5f      #    random_
-000417c0: 7374 6174 653d 312c 2072 6567 5f61 6c70  state=1, reg_alp
-000417d0: 6861 3d30 2e35 2c20 7265 675f 6c61 6d62  ha=0.5, reg_lamb
-000417e0: 6461 3d30 2e35 2c0d 0a20 2020 2020 2020  da=0.5,..       
-000417f0: 2020 2020 2020 2020 2020 2020 2023 2020               #  
-00041800: 2020 6e75 6d5f 636c 6173 733d 206c 656e    num_class= len
-00041810: 2863 6c61 7373 6573 292c 0d0a 2020 2020  (classes),..    
-00041820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041830: 2320 2020 2073 6565 643d 3129 0d0a 2020  #    seed=1)..  
-00041840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041850: 2020 2378 6762 6d2e 7365 745f 7061 7261    #xgbm.set_para
-00041860: 6d73 282a 2a70 6172 616d 290d 0a20 2020  ms(**param)..   
-00041870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041880: 2069 6620 6d6f 6465 6c5f 6c61 6265 6c20   if model_label 
-00041890: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
-000418a0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-000418b0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-000418c0: 2046 6f75 6e64 2058 4742 2074 6f6f 2073   Found XGB too s
-000418d0: 6c6f 7720 666f 7220 6d75 6c74 692d 636c  low for multi-cl
-000418e0: 6173 7320 2d20 6865 6e63 6520 6265 7474  ass - hence bett
-000418f0: 6572 2074 6f20 7573 6520 4f6e 6520 5673  er to use One Vs
-00041900: 2052 6573 7420 6167 6169 6e73 7420 6974   Rest against it
-00041910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041920: 2020 2020 2020 2020 2020 7867 626d 203d            xgbm =
-00041930: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
-00041940: 6669 6572 2865 7374 696d 6174 6f72 3d58  fier(estimator=X
-00041950: 4742 436c 6173 7369 6669 6572 2862 6f6f  GBClassifier(boo
-00041960: 7374 6572 3d27 6762 7472 6565 272c 2075  ster='gbtree', u
-00041970: 7365 5f6c 6162 656c 5f65 6e63 6f64 6572  se_label_encoder
-00041980: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
-00041990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419b0: 2020 2020 2020 2020 206e 5f65 7374 696d           n_estim
-000419c0: 6174 6f72 733d 3230 302c 7261 6e64 6f6d  ators=200,random
-000419d0: 5f73 7461 7465 3d39 392c 6e74 6872 6561  _state=99,nthrea
-000419e0: 643d 6e5f 6a6f 6273 2c0d 0a20 2020 2020  d=n_jobs,..     
+00041340: 2020 2020 2065 7374 696d 6174 6f72 5f73       estimator_s
+00041350: 7472 696e 672b 2743 273a 2073 702e 7374  tring+'C': sp.st
+00041360: 6174 732e 756e 6966 6f72 6d2e 7276 7328  ats.uniform.rvs(
+00041370: 6c6f 633d 302e 3031 2c73 6361 6c65 3d31  loc=0.01,scale=1
+00041380: 302c 7369 7a65 3d31 3030 3029 0d0a 2020  0,size=1000)..  
+00041390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000413a0: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
+000413b0: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+000413c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000413d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000413e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000413f0: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+00041400: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
+00041410: 675f 466c 6167 3a0d 0a20 2020 2020 2020  g_Flag:..       
+00041420: 2020 2020 2020 2020 2023 2043 7265 6174           # Creat
+00041430: 6520 7265 6775 6c61 7269 7a61 7469 6f6e  e regularization
+00041440: 2068 7970 6572 7061 7261 6d65 7465 7220   hyperparameter 
+00041450: 6469 7374 7269 6275 7469 6f6e 2075 7369  distribution usi
+00041460: 6e67 2075 6e69 666f 726d 2064 6973 7472  ng uniform distr
+00041470: 6962 7574 696f 6e0d 0a20 2020 2020 2020  ibution..       
+00041480: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00041490: 6c5f 6e61 6d65 2e6c 6f77 6572 2829 203d  l_name.lower() =
+000414a0: 3d20 2763 6174 626f 6f73 7427 3a0d 0a20  = 'catboost':.. 
+000414b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000414c0: 2020 2078 6762 6d20 3d20 2043 6174 426f     xgbm =  CatBo
+000414d0: 6f73 7443 6c61 7373 6966 6965 7228 7665  ostClassifier(ve
+000414e0: 7262 6f73 653d 302c 6974 6572 6174 696f  rbose=0,iteratio
+000414f0: 6e73 3d6d 6178 5f65 7374 696d 732c 0d0a  ns=max_estims,..
+00041500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041510: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+00041520: 6f6d 5f73 7461 7465 3d39 392c 6f6e 655f  om_state=99,one_
+00041530: 686f 745f 6d61 785f 7369 7a65 3d6f 6e65  hot_max_size=one
+00041540: 5f68 6f74 5f73 697a 652c 0d0a 2020 2020  _hot_size,..    
+00041550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041560: 2020 2020 2020 2020 6c6f 7373 5f66 756e          loss_fun
+00041570: 6374 696f 6e3d 6c6f 7373 5f66 756e 6374  ction=loss_funct
+00041580: 696f 6e2c 2065 7661 6c5f 6d65 7472 6963  ion, eval_metric
+00041590: 3d63 6174 626f 6f73 745f 7363 6f72 696e  =catboost_scorin
+000415a0: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
+000415b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000415c0: 7375 6273 616d 706c 653d 7375 6273 616d  subsample=subsam
+000415d0: 706c 652c 626f 6f74 7374 7261 705f 7479  ple,bootstrap_ty
+000415e0: 7065 3d27 4265 726e 6f75 6c6c 6927 2c0d  pe='Bernoulli',.
+000415f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041600: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00041610: 7269 635f 7065 7269 6f64 203d 2035 3030  ric_period = 500
+00041620: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00041630: 2020 2020 2020 2020 2020 2020 2020 6561                ea
+00041640: 726c 795f 7374 6f70 7069 6e67 5f72 6f75  rly_stopping_rou
+00041650: 6e64 733d 3130 3030 2c62 6f6f 7374 696e  nds=1000,boostin
+00041660: 675f 7479 7065 3d27 506c 6169 6e27 290d  g_type='Plain').
+00041670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041680: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00041690: 2020 2020 2020 2020 2020 2020 2378 6762              #xgb
+000416a0: 6d20 3d20 5847 4243 6c61 7373 6966 6965  m = XGBClassifie
+000416b0: 7228 6261 7365 5f73 636f 7265 3d30 2e35  r(base_score=0.5
+000416c0: 2c20 626f 6f73 7465 723d 2767 6274 7265  , booster='gbtre
+000416d0: 6527 2c20 7375 6273 616d 706c 653d 7375  e', subsample=su
+000416e0: 6273 616d 706c 652c 0d0a 2020 2020 2020  bsample,..      
+000416f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00041700: 2020 2020 2020 2020 2020 2063 6f6c 7361             colsa
+00041710: 6d70 6c65 5f62 7974 7265 653d 636f 6c5f  mple_bytree=col_
+00041720: 7375 625f 7361 6d70 6c65 2c20 6761 6d6d  sub_sample, gamm
+00041730: 613d 312c 206c 6561 726e 696e 675f 7261  a=1, learning_ra
+00041740: 7465 3d30 2e31 2c20 6d61 785f 6465 6c74  te=0.1, max_delt
+00041750: 615f 7374 6570 3d30 2c0d 0a20 2020 2020  a_step=0,..     
+00041760: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00041770: 2020 2020 6d61 785f 6465 7074 683d 6d61      max_depth=ma
+00041780: 785f 6465 7074 682c 206d 696e 5f63 6869  x_depth, min_chi
+00041790: 6c64 5f77 6569 6768 743d 312c 206d 6973  ld_weight=1, mis
+000417a0: 7369 6e67 3d2d 3939 392c 206e 5f65 7374  sing=-999, n_est
+000417b0: 696d 6174 6f72 733d 3230 302c 0d0a 2020  imators=200,..  
+000417c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000417d0: 2020 2320 2020 206e 5f6a 6f62 733d 2d31    #    n_jobs=-1
+000417e0: 2c20 6e74 6872 6561 643d 2d31 2c20 6f62  , nthread=-1, ob
+000417f0: 6a65 6374 6976 653d 6f62 6a65 6374 6976  jective=objectiv
+00041800: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00041810: 2020 2020 2020 2020 2320 2020 2072 616e          #    ran
+00041820: 646f 6d5f 7374 6174 653d 312c 2072 6567  dom_state=1, reg
+00041830: 5f61 6c70 6861 3d30 2e35 2c20 7265 675f  _alpha=0.5, reg_
+00041840: 6c61 6d62 6461 3d30 2e35 2c0d 0a20 2020  lambda=0.5,..   
+00041850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041860: 2023 2020 2020 6e75 6d5f 636c 6173 733d   #    num_class=
+00041870: 206c 656e 2863 6c61 7373 6573 292c 0d0a   len(classes),..
+00041880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041890: 2020 2020 2320 2020 2073 6565 643d 3129      #    seed=1)
+000418a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000418b0: 2020 2020 2020 2378 6762 6d2e 7365 745f        #xgbm.set_
+000418c0: 7061 7261 6d73 282a 2a70 6172 616d 290d  params(**param).
+000418d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000418e0: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
+000418f0: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
+00041900: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
+00041910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041920: 2323 2323 2046 6f75 6e64 2058 4742 2074  #### Found XGB t
+00041930: 6f6f 2073 6c6f 7720 666f 7220 6d75 6c74  oo slow for mult
+00041940: 692d 636c 6173 7320 2d20 6865 6e63 6520  i-class - hence 
+00041950: 6265 7474 6572 2074 6f20 7573 6520 4f6e  better to use On
+00041960: 6520 5673 2052 6573 7420 6167 6169 6e73  e Vs Rest agains
+00041970: 7420 6974 0d0a 2020 2020 2020 2020 2020  t it..          
+00041980: 2020 2020 2020 2020 2020 2020 2020 7867                xg
+00041990: 626d 203d 204f 6e65 5673 5265 7374 436c  bm = OneVsRestCl
+000419a0: 6173 7369 6669 6572 2865 7374 696d 6174  assifier(estimat
+000419b0: 6f72 3d58 4742 436c 6173 7369 6669 6572  or=XGBClassifier
+000419c0: 2862 6f6f 7374 6572 3d27 6762 7472 6565  (booster='gbtree
+000419d0: 272c 2075 7365 5f6c 6162 656c 5f65 6e63  ', use_label_enc
+000419e0: 6f64 6572 3d46 616c 7365 2c0d 0a20 2020  oder=False,..   
 000419f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00041a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a10: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
-00041a20: 733d 6e5f 6a6f 6273 290d 0a20 2020 2020  s=n_jobs)..     
-00041a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a50: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00041a60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041a70: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00041a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a90: 2020 2020 2023 2323 2054 6869 7320 7769       ### This wi
-00041aa0: 6c6c 2062 6520 6175 746f 6d61 7469 6361  ll be automatica
-00041ab0: 6c6c 7920 7772 6170 7065 6420 6172 6f75  lly wrapped arou
-00041ac0: 6e64 2062 7920 6120 4d75 6c74 694f 7574  nd by a MultiOut
-00041ad0: 7075 7443 6c61 7373 6966 6965 7220 6c61  putClassifier la
-00041ae0: 7465 7220 2323 230d 0a20 2020 2020 2020  ter ###..       
-00041af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041b00: 2058 4742 436c 6173 7369 6669 6572 2862   XGBClassifier(b
-00041b10: 6f6f 7374 6572 3d27 6762 7472 6565 272c  ooster='gbtree',
-00041b20: 2075 7365 5f6c 6162 656c 5f65 6e63 6f64   use_label_encod
-00041b30: 6572 3d46 616c 7365 2c0d 0a20 2020 2020  er=False,..     
-00041b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a10: 2020 2020 2020 2020 2020 2020 206e 5f65               n_e
+00041a20: 7374 696d 6174 6f72 733d 3230 302c 7261  stimators=200,ra
+00041a30: 6e64 6f6d 5f73 7461 7465 3d39 392c 6e74  ndom_state=99,nt
+00041a40: 6872 6561 643d 6e5f 6a6f 6273 2c0d 0a20  hread=n_jobs,.. 
+00041a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00041a80: 5f6a 6f62 733d 6e5f 6a6f 6273 290d 0a20  _jobs=n_jobs).. 
+00041a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ac0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+00041ad0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00041ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041af0: 2020 2020 2020 2020 2023 2323 2054 6869           ### Thi
+00041b00: 7320 7769 6c6c 2062 6520 6175 746f 6d61  s will be automa
+00041b10: 7469 6361 6c6c 7920 7772 6170 7065 6420  tically wrapped 
+00041b20: 6172 6f75 6e64 2062 7920 6120 4d75 6c74  around by a Mult
+00041b30: 694f 7574 7075 7443 6c61 7373 6966 6965  iOutputClassifie
+00041b40: 7220 6c61 7465 7220 2323 230d 0a20 2020  r later ###..   
 00041b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041b60: 2020 2020 2020 2020 2020 206e 5f65 7374             n_est
-00041b70: 696d 6174 6f72 733d 3230 302c 7261 6e64  imators=200,rand
-00041b80: 6f6d 5f73 7461 7465 3d39 392c 6e74 6872  om_state=99,nthr
-00041b90: 6561 643d 6e5f 6a6f 6273 2c0d 0a20 2020  ead=n_jobs,..   
+00041b60: 2020 2020 2058 4742 436c 6173 7369 6669       XGBClassifi
+00041b70: 6572 2862 6f6f 7374 6572 3d27 6762 7472  er(booster='gbtr
+00041b80: 6565 272c 2075 7365 5f6c 6162 656c 5f65  ee', use_label_e
+00041b90: 6e63 6f64 6572 3d46 616c 7365 2c0d 0a20  ncoder=False,.. 
 00041ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00041bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041bc0: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
-00041bd0: 6f62 733d 6e5f 6a6f 6273 290d 0a20 2020  obs=n_jobs)..   
-00041be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041bf0: 2069 6620 6879 7065 725f 7061 7261 6d20   if hyper_param 
-00041c00: 3d3d 2027 4753 273a 0d0a 2020 2020 2020  == 'GS':..      
+00041bc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00041bd0: 5f65 7374 696d 6174 6f72 733d 3230 302c  _estimators=200,
+00041be0: 7261 6e64 6f6d 5f73 7461 7465 3d39 392c  random_state=99,
+00041bf0: 6e74 6872 6561 643d 6e5f 6a6f 6273 2c0d  nthread=n_jobs,.
+00041c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00041c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c20: 2020 635f 7061 7261 6d73 203d 207b 0d0a    c_params = {..
-00041c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c50: 2020 2020 2258 4742 6f6f 7374 223a 207b      "XGBoost": {
-00041c60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041c30: 206e 5f6a 6f62 733d 6e5f 6a6f 6273 290d   n_jobs=n_jobs).
+00041c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041c50: 2020 2020 2069 6620 6879 7065 725f 7061       if hyper_pa
+00041c60: 7261 6d20 3d3d 2027 4753 273a 0d0a 2020  ram == 'GS':..  
 00041c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c80: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
-00041c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041c80: 2020 2020 2020 635f 7061 7261 6d73 203d        c_params =
+00041c90: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
 00041ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041cb0: 207d 0d0a 2020 2020 2020 2020 2020 2020   }..            
-00041cc0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00041cb0: 2020 2020 2020 2020 2258 4742 6f6f 7374          "XGBoost
+00041cc0: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
 00041cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041ce0: 2020 2020 2020 2063 5f70 6172 616d 7320         c_params 
-00041cf0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+00041ce0: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
+00041cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00041d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d10: 2020 2020 2020 2020 2022 5847 426f 6f73           "XGBoos
-00041d20: 7422 3a20 7b0d 0a20 2020 2020 2020 2020  t": {..         
-00041d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d40: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
-00041d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d60: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
-00041d70: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00041d80: 6620 426f 6f73 7469 6e67 5f46 6c61 6720  f Boosting_Flag 
-00041d90: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00041da0: 2020 2020 2020 2020 2020 2323 2323 2049            #### I
-00041db0: 2068 6176 6520 7365 7420 7468 6520 5665   have set the Ve
-00041dc0: 7262 6f73 6520 746f 2062 6520 4661 6c73  rbose to be Fals
-00041dd0: 6520 6865 7265 2073 696e 6365 2069 7420  e here since it 
-00041de0: 7072 6f64 7563 6573 2074 6f6f 206d 7563  produces too muc
-00041df0: 6820 6f75 7470 7574 2023 2323 0d0a 2020  h output ###..  
-00041e00: 2020 2020 2020 2020 2020 2020 2020 7867                xg
-00041e10: 626d 203d 204c 6f67 6973 7469 6352 6567  bm = LogisticReg
-00041e20: 7265 7373 696f 6e28 7261 6e64 6f6d 5f73  ression(random_s
-00041e30: 7461 7465 3d73 6565 642c 7665 7262 6f73  tate=seed,verbos
-00041e40: 653d 4661 6c73 652c 6e5f 6a6f 6273 3d2d  e=False,n_jobs=-
-00041e50: 312c 736f 6c76 6572 3d73 6f6c 7665 722c  1,solver=solver,
+00041d10: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
+00041d20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00041d30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00041d40: 2020 2020 2020 2020 2020 2063 5f70 6172             c_par
+00041d50: 616d 7320 3d20 7b0d 0a20 2020 2020 2020  ams = {..       
+00041d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041d70: 2020 2020 2020 2020 2020 2020 2022 5847               "XG
+00041d80: 426f 6f73 7422 3a20 7b0d 0a20 2020 2020  Boost": {..     
+00041d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041da0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00041db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041dd0: 2020 7d0d 0a20 2020 2020 2020 2020 2020    }..           
+00041de0: 2065 6c69 6620 426f 6f73 7469 6e67 5f46   elif Boosting_F
+00041df0: 6c61 6720 6973 204e 6f6e 653a 0d0a 2020  lag is None:..  
+00041e00: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00041e10: 2323 2049 2068 6176 6520 7365 7420 7468  ## I have set th
+00041e20: 6520 5665 7262 6f73 6520 746f 2062 6520  e Verbose to be 
+00041e30: 4661 6c73 6520 6865 7265 2073 696e 6365  False here since
+00041e40: 2069 7420 7072 6f64 7563 6573 2074 6f6f   it produces too
+00041e50: 206d 7563 6820 6f75 7470 7574 2023 2323   much output ###
 00041e60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e80: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-00041e90: 745f 696e 7465 7263 6570 743d 5472 7565  t_intercept=True
-00041ea0: 2c20 746f 6c3d 746f 6c65 7261 6e63 652c  , tol=tolerance,
-00041eb0: 206d 756c 7469 5f63 6c61 7373 3d27 6f76   multi_class='ov
-00041ec0: 7227 2c0d 0a20 2020 2020 2020 2020 2020  r',..           
+00041e70: 2020 7867 626d 203d 204c 6f67 6973 7469    xgbm = Logisti
+00041e80: 6352 6567 7265 7373 696f 6e28 7261 6e64  cRegression(rand
+00041e90: 6f6d 5f73 7461 7465 3d73 6565 642c 7665  om_state=seed,ve
+00041ea0: 7262 6f73 653d 4661 6c73 652c 6e5f 6a6f  rbose=False,n_jo
+00041eb0: 6273 3d2d 312c 736f 6c76 6572 3d73 6f6c  bs=-1,solver=sol
+00041ec0: 7665 722c 0d0a 2020 2020 2020 2020 2020  ver,..          
 00041ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041ee0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00041ef0: 6178 5f69 7465 723d 3130 3030 302c 2077  ax_iter=10000, w
-00041f00: 6172 6d5f 7374 6172 743d 4661 6c73 652c  arm_start=False,
-00041f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f30: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00041f40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00041f50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041f60: 2020 7867 626d 203d 2052 616e 646f 6d46    xgbm = RandomF
-00041f70: 6f72 6573 7443 6c61 7373 6966 6965 7228  orestClassifier(
-00041f80: 626f 6f74 7374 7261 703d 626f 6f74 7374  bootstrap=bootst
-00041f90: 7261 702c 206f 6f62 5f73 636f 7265 3d54  rap, oob_score=T
-00041fa0: 7275 652c 7761 726d 5f73 7461 7274 3d77  rue,warm_start=w
-00041fb0: 6172 6d5f 7374 6172 742c 0d0a 2020 2020  arm_start,..    
-00041fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041fe0: 2020 2020 6e5f 6573 7469 6d61 746f 7273      n_estimators
-00041ff0: 3d32 3030 2c6d 6178 5f64 6570 7468 3d4e  =200,max_depth=N
-00042000: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00042010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042020: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-00042030: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-00042040: 2c6d 6178 5f66 6561 7475 7265 733d 2761  ,max_features='a
-00042050: 7574 6f27 2c0d 0a20 2020 2020 2020 2020  uto',..         
-00042060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042070: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-00042080: 646f 6d5f 7374 6174 653d 7365 6564 2c6e  dom_state=seed,n
-00042090: 5f6a 6f62 733d 2d31 290d 0a20 2020 2023  _jobs=-1)..    #
-000420a0: 2323 2320 4e45 5854 204c 494e 4520 4953  ### NEXT LINE IS
-000420b0: 204e 4545 4445 4420 544f 2047 4554 204d   NEEDED TO GET M
-000420c0: 4f44 454c 5320 4142 4f56 4520 494e 544f  ODELS ABOVE INTO
-000420d0: 2041 2057 5241 5050 4552 0d0a 2020 2020   A WRAPPER..    
-000420e0: 2323 2320 2057 5241 5050 4552 2049 5320  ###  WRAPPER IS 
-000420f0: 5448 4953 204d 554c 5449 5f4c 4142 454c  THIS MULTI_LABEL
-00042100: 2046 4f52 4d41 542e 2053 4f20 4c45 4156   FORMAT. SO LEAV
-00042110: 4520 4954 2041 4c4f 4e45 202d 2041 532d  E IT ALONE - AS-
-00042120: 4953 2021 2121 0d0a 2020 2020 2323 2323  IS !!!..    ####
-00042130: 2323 2320 4e6f 7720 7765 2061 6464 2061  ### Now we add a
-00042140: 6e6f 7468 6572 2077 7261 7070 6572 2066  nother wrapper f
-00042150: 6f72 204d 756c 7469 2d4f 7574 7075 7420  or Multi-Output 
-00042160: 5072 6f62 6c65 6d73 2023 2323 2323 2323  Problems #######
-00042170: 2323 2323 2323 230d 0a20 2020 2023 2323  #######..    ###
-00042180: 2320 444f 4e27 5420 4d4f 4449 4659 2054  # DON'T MODIFY T
-00042190: 4845 204e 4558 5420 4c49 4e45 2121 2120  HE NEXT LINE!!! 
-000421a0: 4954 204d 4159 2041 5050 4541 5220 5354  IT MAY APPEAR ST
-000421b0: 5550 4944 2042 5554 2049 5420 4953 204e  UPID BUT IT IS N
-000421c0: 4545 4445 4420 544f 2047 4554 204d 4f44  EEDED TO GET MOD
-000421d0: 454c 5320 4142 4f56 450d 0a20 2020 2023  ELS ABOVE..    #
-000421e0: 2323 2020 494e 544f 2054 4849 5320 4d55  ##  INTO THIS MU
-000421f0: 4c54 495f 4c41 4245 4c20 464f 524d 4154  LTI_LABEL FORMAT
-00042200: 2e20 534f 204c 4541 5645 2049 5420 414c  . SO LEAVE IT AL
-00042210: 4f4e 4520 2d20 4153 2d49 5320 2121 210d  ONE - AS-IS !!!.
-00042220: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
-00042230: 6265 6c20 213d 2027 5369 6e67 6c65 5f4c  bel != 'Single_L
-00042240: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-00042250: 2323 2323 2046 6f72 204d 756c 7469 2d4c  #### For Multi-L
-00042260: 6162 656c 2050 726f 626c 656d 7320 3d20  abel Problems = 
-00042270: 796f 7520 6861 7665 2074 6f20 6368 616e  you have to chan
-00042280: 6765 2074 6865 206d 6f64 656c 2074 6f20  ge the model to 
-00042290: 6120 6d75 6c74 692d 6f75 7470 7574 206d  a multi-output m
-000422a0: 6f64 656c 0d0a 2020 2020 2020 2020 6966  odel..        if
-000422b0: 2063 6861 696e 5f66 6c61 673a 0d0a 2020   chain_flag:..  
-000422c0: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-000422d0: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
-000422e0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
-000422f0: 2020 2020 2020 2020 2023 2323 2052 6567           ### Reg
-00042300: 7265 7373 6f72 2043 6861 696e 2061 2073  ressor Chain a s
-00042310: 7461 636b 696e 6720 616c 676f 7269 7468  tacking algorith
-00042320: 6d20 2d20 6974 2070 7265 6469 6374 7320  m - it predicts 
-00042330: 6f6e 6520 7461 7267 6574 2061 6e64 0d0a  one target and..
-00042340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042350: 2323 2320 2075 7365 7320 6974 2074 6f20  ###  uses it to 
-00042360: 7072 6564 6963 7420 6f74 6865 7220 7461  predict other ta
-00042370: 7267 6574 7320 696e 2061 2064 6169 7379  rgets in a daisy
-00042380: 2063 6861 696e 2e20 4e65 6174 210d 0a20   chain. Neat!.. 
-00042390: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-000423a0: 6762 6d20 3d20 5265 6772 6573 736f 7243  gbm = RegressorC
-000423b0: 6861 696e 2878 6762 6d2c 206f 7264 6572  hain(xgbm, order
-000423c0: 3d20 6e70 2e61 7261 6e67 6528 6c65 6e28  = np.arange(len(
-000423d0: 7461 7267 6574 2929 2e74 6f6c 6973 7428  target)).tolist(
-000423e0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-000423f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042400: 7261 6e64 6f6d 5f73 7461 7465 3d39 3929  random_state=99)
-00042410: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00042420: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00042430: 2020 2020 2078 6762 6d20 3d20 436c 6173       xgbm = Clas
-00042440: 7369 6669 6572 4368 6169 6e28 7867 626d  sifierChain(xgbm
-00042450: 2c20 6f72 6465 723d 206e 702e 6172 616e  , order= np.aran
-00042460: 6765 286c 656e 2874 6172 6765 7429 292e  ge(len(target)).
-00042470: 746f 6c69 7374 2829 2c0d 0a20 2020 2020  tolist(),..     
-00042480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042490: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
-000424a0: 6174 653d 3939 290d 0a20 2020 2020 2020  ate=99)..       
-000424b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000424c0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-000424d0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-000424e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000424f0: 2020 2023 2323 2054 6869 7320 7365 656d     ### This seem
-00042500: 7320 746f 2077 6f72 6b20 6265 7374 2066  s to work best f
-00042510: 6f72 2058 4742 5265 6772 6573 736f 7220  or XGBRegressor 
-00042520: 616e 6420 4361 7442 6f6f 7374 5265 6772  and CatBoostRegr
-00042530: 6573 736f 7220 6f6e 6c79 2023 2323 230d  essor only ####.
-00042540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042550: 2078 6762 6d20 3d20 4d75 6c74 694f 7574   xgbm = MultiOut
-00042560: 7075 7452 6567 7265 7373 6f72 2878 6762  putRegressor(xgb
-00042570: 6d2c 206e 5f6a 6f62 733d 6e5f 6a6f 6273  m, n_jobs=n_jobs
-00042580: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00042590: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000425a0: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
-000425b0: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
-000425c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000425d0: 2020 2020 2023 2323 2323 2054 6869 7320       ##### This 
-000425e0: 6973 2066 6f72 204d 756c 7469 2d4c 6162  is for Multi-Lab
-000425f0: 656c 3a20 426f 7468 2042 696e 6172 7920  el: Both Binary 
-00042600: 616e 6420 4d75 6c74 692d 636c 6173 7320  and Multi-class 
-00042610: 436c 6173 7369 6669 6361 7469 6f6e 2023  Classification #
-00042620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00042630: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-00042640: 2020 2020 2020 2020 2020 2078 6762 6d20             xgbm 
-00042650: 3d20 4f6e 6556 7352 6573 7443 6c61 7373  = OneVsRestClass
-00042660: 6966 6965 7228 6573 7469 6d61 746f 723d  ifier(estimator=
-00042670: 7867 626d 290d 0a20 2020 2020 2020 2020  xgbm)..         
-00042680: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
-00042690: 426f 6f73 7469 6e67 5f46 6c61 673a 0d0a  Boosting_Flag:..
-000426a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000426b0: 2020 2020 2323 2320 5261 6e64 6f6d 466f      ### RandomFo
-000426c0: 7265 7374 2069 7320 6120 7370 6563 6961  rest is a specia
-000426d0: 6c20 6d6f 6465 6c3a 2077 6520 6361 6e20  l model: we can 
-000426e0: 7573 6520 7468 6520 6d6f 6465 6c20 6173  use the model as
-000426f0: 2069 733a 2052 4652 2069 7320 4d75 6c74   is: RFR is Mult
-00042700: 6920 4f75 7470 7574 2120 2323 230d 0a20  i Output! ###.. 
-00042710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042720: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00042730: 2020 5573 696e 6720 2573 206d 6f64 656c    Using %s model
-00042740: 2066 6f72 206d 756c 7469 2d6f 7574 7075   for multi-outpu
-00042750: 7420 7072 6f63 6573 7369 6e67 2e2e 2e20  t processing... 
-00042760: 2720 256d 6f64 656c 5f6e 616d 6529 0d0a  ' %model_name)..
-00042770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042780: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00042790: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-000427a0: 2054 6869 7320 6973 2066 6f72 204d 756c   This is for Mul
-000427b0: 7469 2d4c 6162 656c 3a20 426f 7468 2042  ti-Label: Both B
-000427c0: 696e 6172 7920 616e 6420 4d75 6c74 692d  inary and Multi-
-000427d0: 636c 6173 7320 436c 6173 7369 6669 6361  class Classifica
-000427e0: 7469 6f6e 2023 2323 2323 2323 2323 2323  tion ###########
-000427f0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00042800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042810: 2078 6762 6d20 3d20 4f6e 6556 7352 6573   xgbm = OneVsRes
-00042820: 7443 6c61 7373 6966 6965 7228 6573 7469  tClassifier(esti
-00042830: 6d61 746f 723d 7867 626d 290d 0a20 2020  mator=xgbm)..   
-00042840: 2020 2020 2070 7269 6e74 2827 5573 696e       print('Usin
-00042850: 6720 4d75 6c74 692d 4c61 6265 6c20 2573  g Multi-Label %s
-00042860: 206d 6f64 656c 2720 2528 7374 7228 7867   model' %(str(xg
-00042870: 626d 292e 7370 6c69 7428 2228 2229 5b30  bm).split("(")[0
-00042880: 5d29 290d 0a20 2020 2065 6c73 653a 0d0a  ]))..    else:..
-00042890: 2020 2020 2020 2020 2323 2323 204e 6f77          #### Now
-000428a0: 2069 6e20 736f 6d65 2063 6173 6573 2074   in some cases t
-000428b0: 6865 2049 6d62 616c 616e 6365 6420 466c  he Imbalanced Fl
-000428c0: 6167 2069 7320 7365 742e 2059 4f75 2063  ag is set. YOu c
-000428d0: 616e 2069 6e73 6572 7420 5350 4520 6865  an insert SPE he
-000428e0: 7265 2023 2323 0d0a 2020 2020 2020 2020  re ###..        
-000428f0: 6966 2049 6d62 616c 616e 6365 645f 466c  if Imbalanced_Fl
-00042900: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
-00042910: 2072 6620 3d20 5261 6e64 6f6d 466f 7265   rf = RandomFore
-00042920: 7374 436c 6173 7369 6669 6572 286e 5f65  stClassifier(n_e
-00042930: 7374 696d 6174 6f72 733d 3130 302c 2072  stimators=100, r
-00042940: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
-00042950: 0a20 2020 2020 2020 2020 2020 2078 6762  .            xgb
-00042960: 6d20 3d20 5365 6c66 5061 6365 6445 6e73  m = SelfPacedEns
-00042970: 656d 626c 6543 6c61 7373 6966 6965 7228  embleClassifier(
-00042980: 6573 7469 6d61 746f 723d 7266 2c20 6e5f  estimator=rf, n_
-00042990: 6a6f 6273 3d2d 312c 2073 6f66 745f 7265  jobs=-1, soft_re
-000429a0: 7361 6d70 6c65 5f66 6c61 673d 5472 7565  sample_flag=True
-000429b0: 290d 0a20 2020 2020 2020 2020 2020 2068  )..            h
-000429c0: 7970 6572 5f70 6172 616d 203d 2027 496d  yper_param = 'Im
-000429d0: 6227 0d0a 2020 2020 2020 2020 2020 2020  b'..            
-000429e0: 6d6f 6465 6c5f 6e61 6d65 203d 2027 5350  model_name = 'SP
-000429f0: 4527 0d0a 2020 2020 2020 2020 2020 2020  E'..            
-00042a00: 426f 6f73 7469 6e67 5f46 6c61 6720 3d20  Boosting_Flag = 
-00042a10: 2046 616c 7365 0d0a 2020 2020 2323 2323   False..    ####
-00042a20: 2323 2020 204e 6f77 2064 6f20 5261 6e64  ##   Now do Rand
-00042a30: 6f6d 697a 6564 5365 6172 6368 4356 2020  omizedSearchCV  
-00042a40: 7573 696e 6720 2320 4561 726c 792d 7374  using # Early-st
-00042a50: 6f70 7069 6e67 2023 2323 2323 2323 2323  opping #########
-00042a60: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
-00042a70: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-00042a80: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-00042a90: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-00042aa0: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-00042ab0: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
-00042ac0: 2020 2023 7363 6f72 6546 756e 6374 696f     #scoreFunctio
-00042ad0: 6e20 3d20 7b22 6d73 6522 3a20 226e 6567  n = {"mse": "neg
-00042ae0: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
-00042af0: 726f 7222 2c20 226d 6165 223a 2022 6e65  ror", "mae": "ne
-00042b00: 675f 6d65 616e 5f61 6273 6f6c 7574 655f  g_mean_absolute_
-00042b10: 6572 726f 7222 7d0d 0a20 2020 2020 2020  error"}..       
-00042b20: 2020 2020 2023 2323 2320 4920 6861 7665       #### I have
-00042b30: 2073 6574 2074 6865 2056 6572 626f 7365   set the Verbose
-00042b40: 2074 6f20 6265 2046 616c 7365 2068 6572   to be False her
-00042b50: 6520 7369 6e63 6520 6974 2070 726f 6475  e since it produ
-00042b60: 6365 7320 746f 6f20 6d75 6368 206f 7574  ces too much out
-00042b70: 7075 7420 2323 230d 0a20 2020 2020 2020  put ###..       
-00042b80: 2020 2020 2069 6620 6879 7065 725f 7061       if hyper_pa
-00042b90: 7261 6d20 3d3d 2027 4753 273a 0d0a 2020  ram == 'GS':..  
-00042ba0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00042bb0: 2323 2049 2068 6176 6520 7365 7420 7468  ## I have set th
-00042bc0: 6520 5665 7262 6f73 6520 746f 2062 6520  e Verbose to be 
-00042bd0: 4661 6c73 6520 6865 7265 2073 696e 6365  False here since
-00042be0: 2069 7420 7072 6f64 7563 6573 2074 6f6f   it produces too
-00042bf0: 206d 7563 6820 6f75 7470 7574 2023 2323   much output ###
-00042c00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00042c10: 2020 6773 203d 2047 7269 6453 6561 7263    gs = GridSearc
-00042c20: 6843 5628 7867 626d 2c70 6172 616d 5f67  hCV(xgbm,param_g
-00042c30: 7269 643d 725f 7061 7261 6d73 5b6d 6f64  rid=r_params[mod
-00042c40: 656c 5f6e 616d 655d 2c0d 0a20 2020 2020  el_name],..     
-00042c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c70: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-00042c80: 6720 3d20 7363 6f72 6572 2c0d 0a20 2020  g = scorer,..   
+00041ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ef0: 2020 6669 745f 696e 7465 7263 6570 743d    fit_intercept=
+00041f00: 5472 7565 2c20 746f 6c3d 746f 6c65 7261  True, tol=tolera
+00041f10: 6e63 652c 206d 756c 7469 5f63 6c61 7373  nce, multi_class
+00041f20: 3d27 6f76 7227 2c0d 0a20 2020 2020 2020  ='ovr',..       
+00041f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f50: 2020 206d 6178 5f69 7465 723d 3130 3030     max_iter=1000
+00041f60: 302c 2077 6172 6d5f 7374 6172 743d 4661  0, warm_start=Fa
+00041f70: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+00041f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041fa0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00041fb0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00041fc0: 2020 2020 2020 7867 626d 203d 2052 616e        xgbm = Ran
+00041fd0: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
+00041fe0: 6965 7228 626f 6f74 7374 7261 703d 626f  ier(bootstrap=bo
+00041ff0: 6f74 7374 7261 702c 206f 6f62 5f73 636f  otstrap, oob_sco
+00042000: 7265 3d54 7275 652c 7761 726d 5f73 7461  re=True,warm_sta
+00042010: 7274 3d77 6172 6d5f 7374 6172 742c 0d0a  rt=warm_start,..
+00042020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042040: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
+00042050: 746f 7273 3d32 3030 2c6d 6178 5f64 6570  tors=200,max_dep
+00042060: 7468 3d4e 6f6e 652c 0d0a 2020 2020 2020  th=None,..      
+00042070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042090: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
+000420a0: 6166 3d32 2c6d 6178 5f66 6561 7475 7265  af=2,max_feature
+000420b0: 733d 2761 7574 6f27 2c0d 0a20 2020 2020  s='auto',..     
+000420c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000420d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000420e0: 2072 616e 646f 6d5f 7374 6174 653d 7365   random_state=se
+000420f0: 6564 2c6e 5f6a 6f62 733d 2d31 290d 0a20  ed,n_jobs=-1).. 
+00042100: 2020 2023 2323 2320 4e45 5854 204c 494e     #### NEXT LIN
+00042110: 4520 4953 204e 4545 4445 4420 544f 2047  E IS NEEDED TO G
+00042120: 4554 204d 4f44 454c 5320 4142 4f56 4520  ET MODELS ABOVE 
+00042130: 494e 544f 2041 2057 5241 5050 4552 0d0a  INTO A WRAPPER..
+00042140: 2020 2020 2323 2320 2057 5241 5050 4552      ###  WRAPPER
+00042150: 2049 5320 5448 4953 204d 554c 5449 5f4c   IS THIS MULTI_L
+00042160: 4142 454c 2046 4f52 4d41 542e 2053 4f20  ABEL FORMAT. SO 
+00042170: 4c45 4156 4520 4954 2041 4c4f 4e45 202d  LEAVE IT ALONE -
+00042180: 2041 532d 4953 2021 2121 0d0a 2020 2020   AS-IS !!!..    
+00042190: 2323 2323 2323 2320 4e6f 7720 7765 2061  ####### Now we a
+000421a0: 6464 2061 6e6f 7468 6572 2077 7261 7070  dd another wrapp
+000421b0: 6572 2066 6f72 204d 756c 7469 2d4f 7574  er for Multi-Out
+000421c0: 7075 7420 5072 6f62 6c65 6d73 2023 2323  put Problems ###
+000421d0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+000421e0: 2023 2323 2320 444f 4e27 5420 4d4f 4449   #### DON'T MODI
+000421f0: 4659 2054 4845 204e 4558 5420 4c49 4e45  FY THE NEXT LINE
+00042200: 2121 2120 4954 204d 4159 2041 5050 4541  !!! IT MAY APPEA
+00042210: 5220 5354 5550 4944 2042 5554 2049 5420  R STUPID BUT IT 
+00042220: 4953 204e 4545 4445 4420 544f 2047 4554  IS NEEDED TO GET
+00042230: 204d 4f44 454c 5320 4142 4f56 450d 0a20   MODELS ABOVE.. 
+00042240: 2020 2023 2323 2020 494e 544f 2054 4849     ###  INTO THI
+00042250: 5320 4d55 4c54 495f 4c41 4245 4c20 464f  S MULTI_LABEL FO
+00042260: 524d 4154 2e20 534f 204c 4541 5645 2049  RMAT. SO LEAVE I
+00042270: 5420 414c 4f4e 4520 2d20 4153 2d49 5320  T ALONE - AS-IS 
+00042280: 2121 210d 0a20 2020 2069 6620 6d6f 6465  !!!..    if mode
+00042290: 6c5f 6c61 6265 6c20 213d 2027 5369 6e67  l_label != 'Sing
+000422a0: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+000422b0: 2020 2020 2323 2323 2046 6f72 204d 756c      #### For Mul
+000422c0: 7469 2d4c 6162 656c 2050 726f 626c 656d  ti-Label Problem
+000422d0: 7320 3d20 796f 7520 6861 7665 2074 6f20  s = you have to 
+000422e0: 6368 616e 6765 2074 6865 206d 6f64 656c  change the model
+000422f0: 2074 6f20 6120 6d75 6c74 692d 6f75 7470   to a multi-outp
+00042300: 7574 206d 6f64 656c 0d0a 2020 2020 2020  ut model..      
+00042310: 2020 6966 2063 6861 696e 5f66 6c61 673a    if chain_flag:
+00042320: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00042330: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+00042340: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00042350: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00042360: 2052 6567 7265 7373 6f72 2043 6861 696e   Regressor Chain
+00042370: 2061 2073 7461 636b 696e 6720 616c 676f   a stacking algo
+00042380: 7269 7468 6d20 2d20 6974 2070 7265 6469  rithm - it predi
+00042390: 6374 7320 6f6e 6520 7461 7267 6574 2061  cts one target a
+000423a0: 6e64 0d0a 2020 2020 2020 2020 2020 2020  nd..            
+000423b0: 2020 2020 2323 2320 2075 7365 7320 6974      ###  uses it
+000423c0: 2074 6f20 7072 6564 6963 7420 6f74 6865   to predict othe
+000423d0: 7220 7461 7267 6574 7320 696e 2061 2064  r targets in a d
+000423e0: 6169 7379 2063 6861 696e 2e20 4e65 6174  aisy chain. Neat
+000423f0: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+00042400: 2020 2078 6762 6d20 3d20 5265 6772 6573     xgbm = Regres
+00042410: 736f 7243 6861 696e 2878 6762 6d2c 206f  sorChain(xgbm, o
+00042420: 7264 6572 3d20 6e70 2e61 7261 6e67 6528  rder= np.arange(
+00042430: 6c65 6e28 7461 7267 6574 2929 2e74 6f6c  len(target)).tol
+00042440: 6973 7428 292c 0d0a 2020 2020 2020 2020  ist(),..        
+00042450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042460: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00042470: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
+00042480: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00042490: 2020 2020 2020 2020 2078 6762 6d20 3d20           xgbm = 
+000424a0: 436c 6173 7369 6669 6572 4368 6169 6e28  ClassifierChain(
+000424b0: 7867 626d 2c20 6f72 6465 723d 206e 702e  xgbm, order= np.
+000424c0: 6172 616e 6765 286c 656e 2874 6172 6765  arange(len(targe
+000424d0: 7429 292e 746f 6c69 7374 2829 2c0d 0a20  t)).tolist(),.. 
+000424e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000424f0: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00042500: 6d5f 7374 6174 653d 3939 290d 0a20 2020  m_state=99)..   
+00042510: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00042520: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00042530: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
+00042540: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+00042550: 2020 2020 2020 2023 2323 2054 6869 7320         ### This 
+00042560: 7365 656d 7320 746f 2077 6f72 6b20 6265  seems to work be
+00042570: 7374 2066 6f72 2058 4742 5265 6772 6573  st for XGBRegres
+00042580: 736f 7220 616e 6420 4361 7442 6f6f 7374  sor and CatBoost
+00042590: 5265 6772 6573 736f 7220 6f6e 6c79 2023  Regressor only #
+000425a0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+000425b0: 2020 2020 2078 6762 6d20 3d20 4d75 6c74       xgbm = Mult
+000425c0: 694f 7574 7075 7452 6567 7265 7373 6f72  iOutputRegressor
+000425d0: 2878 6762 6d2c 206e 5f6a 6f62 733d 6e5f  (xgbm, n_jobs=n_
+000425e0: 6a6f 6273 290d 0a20 2020 2020 2020 2020  jobs)..         
+000425f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00042600: 2020 2020 2020 2020 2020 6966 2042 6f6f            if Boo
+00042610: 7374 696e 675f 466c 6167 2069 7320 4e6f  sting_Flag is No
+00042620: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00042630: 2020 2020 2020 2020 2023 2323 2323 2054           ##### T
+00042640: 6869 7320 6973 2066 6f72 204d 756c 7469  his is for Multi
+00042650: 2d4c 6162 656c 3a20 426f 7468 2042 696e  -Label: Both Bin
+00042660: 6172 7920 616e 6420 4d75 6c74 692d 636c  ary and Multi-cl
+00042670: 6173 7320 436c 6173 7369 6669 6361 7469  ass Classificati
+00042680: 6f6e 2023 2323 2323 2323 2323 2323 2323  on #############
+00042690: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+000426a0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+000426b0: 6762 6d20 3d20 4f6e 6556 7352 6573 7443  gbm = OneVsRestC
+000426c0: 6c61 7373 6966 6965 7228 6573 7469 6d61  lassifier(estima
+000426d0: 746f 723d 7867 626d 290d 0a20 2020 2020  tor=xgbm)..     
+000426e0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000426f0: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
+00042700: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00042710: 2020 2020 2020 2020 2323 2320 5261 6e64          ### Rand
+00042720: 6f6d 466f 7265 7374 2069 7320 6120 7370  omForest is a sp
+00042730: 6563 6961 6c20 6d6f 6465 6c3a 2077 6520  ecial model: we 
+00042740: 6361 6e20 7573 6520 7468 6520 6d6f 6465  can use the mode
+00042750: 6c20 6173 2069 733a 2052 4652 2069 7320  l as is: RFR is 
+00042760: 4d75 6c74 6920 4f75 7470 7574 2120 2323  Multi Output! ##
+00042770: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+00042780: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00042790: 2827 2020 2020 5573 696e 6720 2573 206d  ('    Using %s m
+000427a0: 6f64 656c 2066 6f72 206d 756c 7469 2d6f  odel for multi-o
+000427b0: 7574 7075 7420 7072 6f63 6573 7369 6e67  utput processing
+000427c0: 2e2e 2e20 2720 256d 6f64 656c 5f6e 616d  ... ' %model_nam
+000427d0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+000427e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000427f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00042800: 2323 2323 2054 6869 7320 6973 2066 6f72  #### This is for
+00042810: 204d 756c 7469 2d4c 6162 656c 3a20 426f   Multi-Label: Bo
+00042820: 7468 2042 696e 6172 7920 616e 6420 4d75  th Binary and Mu
+00042830: 6c74 692d 636c 6173 7320 436c 6173 7369  lti-class Classi
+00042840: 6669 6361 7469 6f6e 2023 2323 2323 2323  fication #######
+00042850: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00042860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042870: 2020 2020 2078 6762 6d20 3d20 4f6e 6556       xgbm = OneV
+00042880: 7352 6573 7443 6c61 7373 6966 6965 7228  sRestClassifier(
+00042890: 6573 7469 6d61 746f 723d 7867 626d 290d  estimator=xgbm).
+000428a0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+000428b0: 5573 696e 6720 4d75 6c74 692d 4c61 6265  Using Multi-Labe
+000428c0: 6c20 2573 206d 6f64 656c 2720 2528 7374  l %s model' %(st
+000428d0: 7228 7867 626d 292e 7370 6c69 7428 2228  r(xgbm).split("(
+000428e0: 2229 5b30 5d29 290d 0a20 2020 2065 6c73  ")[0]))..    els
+000428f0: 653a 0d0a 2020 2020 2020 2020 2323 2323  e:..        ####
+00042900: 204e 6f77 2069 6e20 736f 6d65 2063 6173   Now in some cas
+00042910: 6573 2074 6865 2049 6d62 616c 616e 6365  es the Imbalance
+00042920: 6420 466c 6167 2069 7320 7365 742e 2059  d Flag is set. Y
+00042930: 4f75 2063 616e 2069 6e73 6572 7420 5350  Ou can insert SP
+00042940: 4520 6865 7265 2023 2323 0d0a 2020 2020  E here ###..    
+00042950: 2020 2020 7072 696e 7428 2720 2020 2020      print('     
+00042960: 4861 6e64 6c69 6e67 2049 6d62 616c 616e  Handling Imbalan
+00042970: 6365 6420 666c 6167 2e2e 2e27 290d 0a20  ced flag...').. 
+00042980: 2020 2023 2323 2323 2320 2020 4e6f 7720     ######   Now 
+00042990: 646f 2052 616e 646f 6d69 7a65 6453 6561  do RandomizedSea
+000429a0: 7263 6843 5620 2075 7369 6e67 2023 2045  rchCV  using # E
+000429b0: 6172 6c79 2d73 746f 7070 696e 6720 2323  arly-stopping ##
+000429c0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+000429d0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+000429e0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+000429f0: 3a0d 0a20 2020 2020 2020 2069 6620 6d6f  :..        if mo
+00042a00: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
+00042a10: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
+00042a20: 2020 2020 2020 2020 2020 2373 636f 7265            #score
+00042a30: 4675 6e63 7469 6f6e 203d 207b 226d 7365  Function = {"mse
+00042a40: 223a 2022 6e65 675f 6d65 616e 5f73 7175  ": "neg_mean_squ
+00042a50: 6172 6564 5f65 7272 6f72 222c 2022 6d61  ared_error", "ma
+00042a60: 6522 3a20 226e 6567 5f6d 6561 6e5f 6162  e": "neg_mean_ab
+00042a70: 736f 6c75 7465 5f65 7272 6f72 227d 0d0a  solute_error"}..
+00042a80: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00042a90: 2049 2068 6176 6520 7365 7420 7468 6520   I have set the 
+00042aa0: 5665 7262 6f73 6520 746f 2062 6520 4661  Verbose to be Fa
+00042ab0: 6c73 6520 6865 7265 2073 696e 6365 2069  lse here since i
+00042ac0: 7420 7072 6f64 7563 6573 2074 6f6f 206d  t produces too m
+00042ad0: 7563 6820 6f75 7470 7574 2023 2323 0d0a  uch output ###..
+00042ae0: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+00042af0: 7970 6572 5f70 6172 616d 203d 3d20 2747  yper_param == 'G
+00042b00: 5327 3a0d 0a20 2020 2020 2020 2020 2020  S':..           
+00042b10: 2020 2020 2023 2323 2320 4920 6861 7665       #### I have
+00042b20: 2073 6574 2074 6865 2056 6572 626f 7365   set the Verbose
+00042b30: 2074 6f20 6265 2046 616c 7365 2068 6572   to be False her
+00042b40: 6520 7369 6e63 6520 6974 2070 726f 6475  e since it produ
+00042b50: 6365 7320 746f 6f20 6d75 6368 206f 7574  ces too much out
+00042b60: 7075 7420 2323 230d 0a20 2020 2020 2020  put ###..       
+00042b70: 2020 2020 2020 2020 2067 7320 3d20 4772           gs = Gr
+00042b80: 6964 5365 6172 6368 4356 2878 6762 6d2c  idSearchCV(xgbm,
+00042b90: 7061 7261 6d5f 6772 6964 3d72 5f70 6172  param_grid=r_par
+00042ba0: 616d 735b 6d6f 6465 6c5f 6e61 6d65 5d2c  ams[model_name],
+00042bb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042be0: 2073 636f 7269 6e67 203d 2073 636f 7265   scoring = score
+00042bf0: 722c 0d0a 2020 2020 2020 2020 2020 2020  r,..            
+00042c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042c20: 2020 2063 7620 3d20 7363 762c 0d0a 2020     cv = scv,..  
+00042c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042c50: 2020 2020 2020 2020 2020 2020 2072 6566               ref
+00042c60: 6974 203d 2072 6566 6974 5f6d 6574 7269  it = refit_metri
+00042c70: 632c 0d0a 2020 2020 2020 2020 2020 2020  c,..            
+00042c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042cb0: 2020 2020 2020 2020 2020 2020 6376 203d              cv =
-00042cc0: 2073 6376 2c0d 0a20 2020 2020 2020 2020   scv,..         
+00042ca0: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
+00042cb0: 7363 6f72 6520 3d20 5472 7565 2c0d 0a20  score = True,.. 
+00042cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042cf0: 2020 2020 2020 7265 6669 7420 3d20 7265        refit = re
-00042d00: 6669 745f 6d65 7472 6963 2c0d 0a20 2020  fit_metric,..   
+00042ce0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+00042cf0: 6a6f 6273 3d6e 5f6a 6f62 732c 0d0a 2020  jobs=n_jobs,..  
+00042d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00042d40: 726e 5f74 7261 696e 5f73 636f 7265 203d  rn_train_score =
-00042d50: 2054 7275 652c 0d0a 2020 2020 2020 2020   True,..        
-00042d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d80: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
-00042d90: 6a6f 6273 2c0d 0a20 2020 2020 2020 2020  jobs,..         
+00042d20: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+00042d30: 7262 6f73 653d 3029 0d0a 2020 2020 2020  rbose=0)..      
+00042d40: 2020 2020 2020 656c 6966 2068 7970 6572        elif hyper
+00042d50: 5f70 6172 616d 203d 3d20 2752 5327 3a0d  _param == 'RS':.
+00042d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042d70: 2067 7320 3d20 5261 6e64 6f6d 697a 6564   gs = Randomized
+00042d80: 5365 6172 6368 4356 2878 6762 6d2c 0d0a  SearchCV(xgbm,..
+00042d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042dc0: 2020 2020 2020 2076 6572 626f 7365 3d30         verbose=0
-00042dd0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00042de0: 6c69 6620 6879 7065 725f 7061 7261 6d20  lif hyper_param 
-00042df0: 3d3d 2027 5253 273a 0d0a 2020 2020 2020  == 'RS':..      
-00042e00: 2020 2020 2020 2020 2020 6773 203d 2052            gs = R
-00042e10: 616e 646f 6d69 7a65 6453 6561 7263 6843  andomizedSearchC
-00042e20: 5628 7867 626d 2c0d 0a20 2020 2020 2020  V(xgbm,..       
+00042db0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00042dc0: 6172 616d 5f64 6973 7472 6962 7574 696f  aram_distributio
+00042dd0: 6e73 203d 2072 5f70 6172 616d 735b 6d6f  ns = r_params[mo
+00042de0: 6465 6c5f 6e61 6d65 5d2c 0d0a 2020 2020  del_name],..    
+00042df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042e10: 2020 2020 2020 2020 2020 206e 5f69 7465             n_ite
+00042e20: 7220 3d20 6e6f 5f69 7465 722c 0d0a 2020  r = no_iter,..  
 00042e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042e50: 2020 2020 2020 2020 7061 7261 6d5f 6469          param_di
-00042e60: 7374 7269 6275 7469 6f6e 7320 3d20 725f  stributions = r_
-00042e70: 7061 7261 6d73 5b6d 6f64 656c 5f6e 616d  params[model_nam
-00042e80: 655d 2c0d 0a20 2020 2020 2020 2020 2020  e],..           
-00042e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042eb0: 2020 2020 6e5f 6974 6572 203d 206e 6f5f      n_iter = no_
-00042ec0: 6974 6572 2c0d 0a20 2020 2020 2020 2020  iter,..         
+00042e50: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+00042e60: 7269 6e67 203d 2073 636f 7265 722c 0d0a  ring = scorer,..
+00042e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042e90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00042ea0: 6566 6974 203d 2072 6566 6974 5f6d 6574  efit = refit_met
+00042eb0: 7269 632c 0d0a 2020 2020 2020 2020 2020  ric,..          
+00042ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ef0: 2020 2020 2020 7363 6f72 696e 6720 3d20        scoring = 
-00042f00: 7363 6f72 6572 2c0d 0a20 2020 2020 2020  scorer,..       
+00042ee0: 2020 2020 2072 6574 7572 6e5f 7472 6169       return_trai
+00042ef0: 6e5f 7363 6f72 6520 3d20 5472 7565 2c0d  n_score = True,.
+00042f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00042f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f30: 2020 2020 2020 2020 7265 6669 7420 3d20          refit = 
-00042f40: 7265 6669 745f 6d65 7472 6963 2c0d 0a20  refit_metric,.. 
+00042f30: 7261 6e64 6f6d 5f73 7461 7465 203d 2073  random_state = s
+00042f40: 6565 642c 0d0a 2020 2020 2020 2020 2020  eed,..          
 00042f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f70: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00042f80: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-00042f90: 203d 2054 7275 652c 0d0a 2020 2020 2020   = True,..      
-00042fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042fc0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-00042fd0: 7374 6174 6520 3d20 7365 6564 2c0d 0a20  state = seed,.. 
-00042fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043000: 2020 2020 2020 2020 2020 2020 2020 6376                cv
-00043010: 203d 2073 6376 2c0d 0a20 2020 2020 2020   = scv,..       
-00043020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043040: 2020 2020 2020 2020 6e5f 6a6f 6273 3d6e          n_jobs=n
-00043050: 5f6a 6f62 732c 0d0a 2020 2020 2020 2020  _jobs,..        
-00043060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043080: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
-00043090: 3d20 3029 0d0a 2020 2020 2020 2020 2020  = 0)..          
-000430a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000430b0: 2020 2020 2020 2020 2023 2323 2320 4361           #### Ca
-000430c0: 7442 6f6f 7374 2064 6f65 7320 6e6f 7420  tBoost does not 
-000430d0: 6e65 6564 2048 7970 6572 2050 6172 616d  need Hyper Param
-000430e0: 6574 6572 2074 756e 696e 6720 3d3e 2069  eter tuning => i
-000430f0: 7427 7320 6772 6561 7420 6f75 7420 6f66  t's great out of
-00043100: 2074 6865 2062 6f78 210d 0a20 2020 2020   the box!..     
-00043110: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
-00043120: 636f 7079 2e64 6565 7063 6f70 7928 7867  copy.deepcopy(xg
-00043130: 626d 290d 0a20 2020 2020 2020 2065 6c73  bm)..        els
-00043140: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00043150: 2323 2323 2046 6f72 204d 756c 7469 6c61  #### For Multila
-00043160: 6265 6c20 5265 6772 6573 736f 7273 2079  bel Regressors y
-00043170: 6f75 206e 6565 6420 746f 2064 6f20 736f  ou need to do so
-00043180: 6d65 2068 7970 6572 2070 6172 616d 6574  me hyper paramet
-00043190: 6572 2074 756e 696e 6720 6275 7420 6e6f  er tuning but no
-000431a0: 7420 746f 6f20 6d75 6368 2120 2023 2323  t too much!  ###
-000431b0: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
-000431c0: 2323 2320 4265 7474 6572 2074 6f20 7265  ### Better to re
-000431d0: 6475 6365 2074 6865 206e 756d 6265 7220  duce the number 
-000431e0: 6f66 2069 7465 7261 7469 6f6e 7320 616e  of iterations an
-000431f0: 6420 6e6f 2068 7970 6572 2d70 6172 616d  d no hyper-param
-00043200: 2073 6561 7263 6869 6e67 2073 696e 6365   searching since
-00043210: 2069 7420 7461 6b65 7320 746f 6f20 6c6f   it takes too lo
-00043220: 6e67 2023 2323 2323 2323 2323 0d0a 2020  ng #########..  
-00043230: 2020 2020 2020 2020 2020 2373 636f 7265            #score
-00043240: 7220 3d20 276e 6567 5f6d 6561 6e5f 7371  r = 'neg_mean_sq
-00043250: 7561 7265 645f 6572 726f 7227 0d0a 2020  uared_error'..  
-00043260: 2020 2020 2020 2020 2020 6e6f 5f69 7465            no_ite
-00043270: 7220 3d20 350d 0a20 2020 2020 2020 2020  r = 5..         
-00043280: 2020 2069 6620 6879 7065 725f 7061 7261     if hyper_para
-00043290: 6d20 3d3d 2027 4753 273a 0d0a 2020 2020  m == 'GS':..    
-000432a0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-000432b0: 2049 2068 6176 6520 7365 7420 7468 6520   I have set the 
-000432c0: 5665 7262 6f73 6520 746f 2062 6520 4661  Verbose to be Fa
-000432d0: 6c73 6520 6865 7265 2073 696e 6365 2069  lse here since i
-000432e0: 7420 7072 6f64 7563 6573 2074 6f6f 206d  t produces too m
-000432f0: 7563 6820 6f75 7470 7574 2023 2323 0d0a  uch output ###..
+00042f70: 2020 2020 2063 7620 3d20 7363 762c 0d0a       cv = scv,..
+00042f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042fa0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00042fb0: 5f6a 6f62 733d 6e5f 6a6f 6273 2c0d 0a20  _jobs=n_jobs,.. 
+00042fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042fe0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00042ff0: 6572 626f 7365 203d 2030 290d 0a20 2020  erbose = 0)..   
+00043000: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00043010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043020: 2323 2323 2043 6174 426f 6f73 7420 646f  #### CatBoost do
+00043030: 6573 206e 6f74 206e 6565 6420 4879 7065  es not need Hype
+00043040: 7220 5061 7261 6d65 7465 7220 7475 6e69  r Parameter tuni
+00043050: 6e67 203d 3e20 6974 2773 2067 7265 6174  ng => it's great
+00043060: 206f 7574 206f 6620 7468 6520 626f 7821   out of the box!
+00043070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00043080: 2020 6773 203d 2063 6f70 792e 6465 6570    gs = copy.deep
+00043090: 636f 7079 2878 6762 6d29 0d0a 2020 2020  copy(xgbm)..    
+000430a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000430b0: 2020 2020 2020 2023 2323 2320 466f 7220         #### For 
+000430c0: 4d75 6c74 696c 6162 656c 2052 6567 7265  Multilabel Regre
+000430d0: 7373 6f72 7320 796f 7520 6e65 6564 2074  ssors you need t
+000430e0: 6f20 646f 2073 6f6d 6520 6879 7065 7220  o do some hyper 
+000430f0: 7061 7261 6d65 7465 7220 7475 6e69 6e67  parameter tuning
+00043100: 2062 7574 206e 6f74 2074 6f6f 206d 7563   but not too muc
+00043110: 6821 2020 2323 2323 0d0a 2020 2020 2020  h!  ####..      
+00043120: 2020 2020 2020 2323 2323 2042 6574 7465        #### Bette
+00043130: 7220 746f 2072 6564 7563 6520 7468 6520  r to reduce the 
+00043140: 6e75 6d62 6572 206f 6620 6974 6572 6174  number of iterat
+00043150: 696f 6e73 2061 6e64 206e 6f20 6879 7065  ions and no hype
+00043160: 722d 7061 7261 6d20 7365 6172 6368 696e  r-param searchin
+00043170: 6720 7369 6e63 6520 6974 2074 616b 6573  g since it takes
+00043180: 2074 6f6f 206c 6f6e 6720 2323 2323 2323   too long ######
+00043190: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+000431a0: 2023 7363 6f72 6572 203d 2027 6e65 675f   #scorer = 'neg_
+000431b0: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+000431c0: 6f72 270d 0a20 2020 2020 2020 2020 2020  or'..           
+000431d0: 206e 6f5f 6974 6572 203d 2035 0d0a 2020   no_iter = 5..  
+000431e0: 2020 2020 2020 2020 2020 6966 2068 7970            if hyp
+000431f0: 6572 5f70 6172 616d 203d 3d20 2747 5327  er_param == 'GS'
+00043200: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00043210: 2020 2023 2323 2320 4920 6861 7665 2073     #### I have s
+00043220: 6574 2074 6865 2056 6572 626f 7365 2074  et the Verbose t
+00043230: 6f20 6265 2046 616c 7365 2068 6572 6520  o be False here 
+00043240: 7369 6e63 6520 6974 2070 726f 6475 6365  since it produce
+00043250: 7320 746f 6f20 6d75 6368 206f 7574 7075  s too much outpu
+00043260: 7420 2323 230d 0a20 2020 2020 2020 2020  t ###..         
+00043270: 2020 2020 2020 2067 7320 3d20 4772 6964         gs = Grid
+00043280: 5365 6172 6368 4356 2878 6762 6d2c 7061  SearchCV(xgbm,pa
+00043290: 7261 6d5f 6772 6964 3d72 5f70 6172 616d  ram_grid=r_param
+000432a0: 735b 6d6f 6465 6c5f 6c61 6265 6c5d 5b6d  s[model_label][m
+000432b0: 6f64 656c 5f6e 616d 655d 2c0d 0a20 2020  odel_name],..   
+000432c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000432d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000432e0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+000432f0: 696e 6720 3d20 7363 6f72 6572 2c0d 0a20  ing = scorer,.. 
 00043300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043310: 6773 203d 2047 7269 6453 6561 7263 6843  gs = GridSearchC
-00043320: 5628 7867 626d 2c70 6172 616d 5f67 7269  V(xgbm,param_gri
-00043330: 643d 725f 7061 7261 6d73 5b6d 6f64 656c  d=r_params[model
-00043340: 5f6c 6162 656c 5d5b 6d6f 6465 6c5f 6e61  _label][model_na
-00043350: 6d65 5d2c 0d0a 2020 2020 2020 2020 2020  me],..          
-00043360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043380: 2020 2020 2073 636f 7269 6e67 203d 2073       scoring = s
-00043390: 636f 7265 722c 0d0a 2020 2020 2020 2020  corer,..        
-000433a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000433b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000433c0: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
-000433d0: 6a6f 6273 2c0d 0a20 2020 2020 2020 2020  jobs,..         
-000433e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000433f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043400: 2020 2020 2020 6376 203d 2073 6376 2c0d        cv = scv,.
-00043410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043320: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+00043330: 6a6f 6273 3d6e 5f6a 6f62 732c 0d0a 2020  jobs=n_jobs,..  
+00043340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043360: 2020 2020 2020 2020 2020 2020 2063 7620               cv 
+00043370: 3d20 7363 762c 0d0a 2020 2020 2020 2020  = scv,..        
+00043380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000433a0: 2020 2020 2020 2072 6566 6974 203d 2072         refit = r
+000433b0: 6566 6974 5f6d 6574 7269 632c 0d0a 2020  efit_metric,..  
+000433c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000433d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000433e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000433f0: 7572 6e5f 7472 6169 6e5f 7363 6f72 6520  urn_train_score 
+00043400: 3d20 5472 7565 2c0d 0a20 2020 2020 2020  = True,..       
+00043410: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043440: 7265 6669 7420 3d20 7265 6669 745f 6d65  refit = refit_me
-00043450: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
-00043460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043480: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-00043490: 696e 5f73 636f 7265 203d 2054 7275 652c  in_score = True,
-000434a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00043430: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+00043440: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
+00043450: 2065 6c69 6620 6879 7065 725f 7061 7261   elif hyper_para
+00043460: 6d20 3d3d 2027 5253 273a 0d0a 2020 2020  m == 'RS':..    
+00043470: 2020 2020 2020 2020 2020 2020 6773 203d              gs =
+00043480: 2052 616e 646f 6d69 7a65 6453 6561 7263   RandomizedSearc
+00043490: 6843 5628 7867 626d 2c0d 0a20 2020 2020  hCV(xgbm,..     
+000434a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000434b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000434c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000434d0: 2020 7665 7262 6f73 653d 3029 0d0a 2020    verbose=0)..  
-000434e0: 2020 2020 2020 2020 2020 656c 6966 2068            elif h
-000434f0: 7970 6572 5f70 6172 616d 203d 3d20 2752  yper_param == 'R
-00043500: 5327 3a0d 0a20 2020 2020 2020 2020 2020  S':..           
-00043510: 2020 2020 2067 7320 3d20 5261 6e64 6f6d       gs = Random
-00043520: 697a 6564 5365 6172 6368 4356 2878 6762  izedSearchCV(xgb
-00043530: 6d2c 0d0a 2020 2020 2020 2020 2020 2020  m,..            
-00043540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000434c0: 2020 2020 2020 2020 2020 7061 7261 6d5f            param_
+000434d0: 6469 7374 7269 6275 7469 6f6e 7320 3d20  distributions = 
+000434e0: 725f 7061 7261 6d73 5b6d 6f64 656c 5f6c  r_params[model_l
+000434f0: 6162 656c 5d5b 6d6f 6465 6c5f 6e61 6d65  abel][model_name
+00043500: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00043510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043530: 2020 206e 5f69 7465 7220 3d20 6e6f 5f69     n_iter = no_i
+00043540: 7465 722c 0d0a 2020 2020 2020 2020 2020  ter,..          
 00043550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043560: 2020 2070 6172 616d 5f64 6973 7472 6962     param_distrib
-00043570: 7574 696f 6e73 203d 2072 5f70 6172 616d  utions = r_param
-00043580: 735b 6d6f 6465 6c5f 6c61 6265 6c5d 5b6d  s[model_label][m
-00043590: 6f64 656c 5f6e 616d 655d 2c0d 0a20 2020  odel_name],..   
+00043560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043570: 2020 2020 2073 636f 7269 6e67 203d 2073       scoring = s
+00043580: 636f 7265 722c 0d0a 2020 2020 2020 2020  corer,..        
+00043590: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000435a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435c0: 2020 2020 2020 2020 2020 2020 6e5f 6974              n_it
-000435d0: 6572 203d 206e 6f5f 6974 6572 2c0d 0a20  er = no_iter,.. 
+000435b0: 2020 2020 2020 2072 6566 6974 203d 2072         refit = r
+000435c0: 6566 6974 5f6d 6574 7269 632c 0d0a 2020  efit_metric,..  
+000435d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000435e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043600: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-00043610: 6f72 696e 6720 3d20 7363 6f72 6572 2c0d  oring = scorer,.
-00043620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000435f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00043600: 7572 6e5f 7472 6169 6e5f 7363 6f72 6520  urn_train_score 
+00043610: 3d20 5472 7565 2c0d 0a20 2020 2020 2020  = True,..       
+00043620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043650: 7265 6669 7420 3d20 7265 6669 745f 6d65  refit = refit_me
-00043660: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
+00043640: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+00043650: 7461 7465 203d 2073 6565 642c 0d0a 2020  tate = seed,..  
+00043660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043690: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
-000436a0: 696e 5f73 636f 7265 203d 2054 7275 652c  in_score = True,
-000436b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000436c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000436d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000436e0: 2072 616e 646f 6d5f 7374 6174 6520 3d20   random_state = 
-000436f0: 7365 6564 2c0d 0a20 2020 2020 2020 2020  seed,..         
-00043700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043720: 2020 2020 2020 6376 203d 2073 6376 2c0d        cv = scv,.
-00043730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043760: 6e5f 6a6f 6273 3d6e 5f6a 6f62 732c 0d0a  n_jobs=n_jobs,..
-00043770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000437a0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
-000437b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-000437c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000437d0: 2023 2323 2320 4361 7442 6f6f 7374 2064   #### CatBoost d
-000437e0: 6f65 7320 6e6f 7420 6e65 6564 2048 7970  oes not need Hyp
-000437f0: 6572 2050 6172 616d 6574 6572 2074 756e  er Parameter tun
-00043800: 696e 6720 3d3e 2069 7427 7320 6772 6561  ing => it's grea
-00043810: 7420 6f75 7420 6f66 2074 6865 2062 6f78  t out of the box
-00043820: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-00043830: 2020 2067 7320 3d20 636f 7079 2e64 6565     gs = copy.dee
-00043840: 7063 6f70 7928 7867 626d 290d 0a20 2020  pcopy(xgbm)..   
-00043850: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00043860: 2323 2323 2323 2320 5468 6973 2069 7320  ####### This is 
-00043870: 666f 7220 436c 6173 7369 6669 6361 7469  for Classificati
-00043880: 6f6e 2050 726f 626c 656d 7320 2323 2323  on Problems ####
-00043890: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-000438a0: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
-000438b0: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
-000438c0: 656c 273a 0d0a 2020 2020 2020 2020 2020  el':..          
-000438d0: 2020 6966 2068 7970 6572 5f70 6172 616d    if hyper_param
-000438e0: 203d 3d20 2747 5327 3a0d 0a20 2020 2020   == 'GS':..     
-000438f0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00043900: 4920 6861 7665 2073 6574 2074 6865 2056  I have set the V
-00043910: 6572 626f 7365 2074 6f20 6265 2046 616c  erbose to be Fal
-00043920: 7365 2068 6572 6520 7369 6e63 6520 6974  se here since it
-00043930: 2070 726f 6475 6365 7320 746f 6f20 6d75   produces too mu
-00043940: 6368 206f 7574 7075 7420 2323 230d 0a20  ch output ###.. 
-00043950: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00043960: 7320 3d20 4772 6964 5365 6172 6368 4356  s = GridSearchCV
-00043970: 2878 6762 6d2c 7061 7261 6d5f 6772 6964  (xgbm,param_grid
-00043980: 3d63 5f70 6172 616d 735b 6d6f 6465 6c5f  =c_params[model_
-00043990: 6e61 6d65 5d2c 0d0a 2020 2020 2020 2020  name],..        
+00043680: 2020 2020 2020 2020 2020 2020 2063 7620               cv 
+00043690: 3d20 7363 762c 0d0a 2020 2020 2020 2020  = scv,..        
+000436a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000436b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000436c0: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
+000436d0: 6a6f 6273 2c0d 0a20 2020 2020 2020 2020  jobs,..         
+000436e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000436f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043700: 2020 2020 2020 2076 6572 626f 7365 203d         verbose =
+00043710: 2030 290d 0a20 2020 2020 2020 2020 2020   0)..           
+00043720: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00043730: 2020 2020 2020 2020 2323 2323 2043 6174          #### Cat
+00043740: 426f 6f73 7420 646f 6573 206e 6f74 206e  Boost does not n
+00043750: 6565 6420 4879 7065 7220 5061 7261 6d65  eed Hyper Parame
+00043760: 7465 7220 7475 6e69 6e67 203d 3e20 6974  ter tuning => it
+00043770: 2773 2067 7265 6174 206f 7574 206f 6620  's great out of 
+00043780: 7468 6520 626f 7821 0d0a 2020 2020 2020  the box!..      
+00043790: 2020 2020 2020 2020 2020 6773 203d 2063            gs = c
+000437a0: 6f70 792e 6465 6570 636f 7079 2878 6762  opy.deepcopy(xgb
+000437b0: 6d29 0d0a 2020 2020 656c 7365 3a0d 0a20  m)..    else:.. 
+000437c0: 2020 2020 2020 2023 2323 2323 2323 2054         ####### T
+000437d0: 6869 7320 6973 2066 6f72 2043 6c61 7373  his is for Class
+000437e0: 6966 6963 6174 696f 6e20 5072 6f62 6c65  ification Proble
+000437f0: 6d73 2023 2323 2323 2323 2323 2323 2323  ms #############
+00043800: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+00043810: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
+00043820: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
+00043830: 2020 2020 2020 2020 2069 6620 6879 7065           if hype
+00043840: 725f 7061 7261 6d20 3d3d 2027 4753 273a  r_param == 'GS':
+00043850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00043860: 2020 2323 2323 2049 2068 6176 6520 7365    #### I have se
+00043870: 7420 7468 6520 5665 7262 6f73 6520 746f  t the Verbose to
+00043880: 2062 6520 4661 6c73 6520 6865 7265 2073   be False here s
+00043890: 696e 6365 2069 7420 7072 6f64 7563 6573  ince it produces
+000438a0: 2074 6f6f 206d 7563 6820 6f75 7470 7574   too much output
+000438b0: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
+000438c0: 2020 2020 2020 6773 203d 2047 7269 6453        gs = GridS
+000438d0: 6561 7263 6843 5628 7867 626d 2c70 6172  earchCV(xgbm,par
+000438e0: 616d 5f67 7269 643d 635f 7061 7261 6d73  am_grid=c_params
+000438f0: 5b6d 6f64 656c 5f6e 616d 655d 2c0d 0a20  [model_name],.. 
+00043900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043920: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00043930: 6f72 696e 6720 3d20 7363 6f72 6572 2c0d  oring = scorer,.
+00043940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043970: 7265 7475 726e 5f74 7261 696e 5f73 636f  return_train_sco
+00043980: 7265 203d 2054 7275 652c 0d0a 2020 2020  re = True,..    
+00043990: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000439a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000439b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000439c0: 2020 2020 2020 2073 636f 7269 6e67 203d         scoring =
-000439d0: 2073 636f 7265 722c 0d0a 2020 2020 2020   scorer,..      
+000439b0: 2020 2020 2020 2020 2020 206e 5f6a 6f62             n_job
+000439c0: 733d 6e5f 6a6f 6273 2c0d 0a20 2020 2020  s=n_jobs,..     
+000439d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000439e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000439f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a00: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-00043a10: 7472 6169 6e5f 7363 6f72 6520 3d20 5472  train_score = Tr
-00043a20: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+000439f0: 2020 2020 2020 2020 2020 7265 6669 7420            refit 
+00043a00: 3d20 7265 6669 745f 6d65 7472 6963 2c0d  = refit_metric,.
+00043a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a50: 2020 2020 6e5f 6a6f 6273 3d6e 5f6a 6f62      n_jobs=n_job
-00043a60: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-00043a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a90: 2020 2072 6566 6974 203d 2072 6566 6974     refit = refit
-00043aa0: 5f6d 6574 7269 632c 0d0a 2020 2020 2020  _metric,..      
-00043ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ad0: 2020 2020 2020 2020 2063 7620 3d20 7363           cv = sc
-00043ae0: 762c 0d0a 2020 2020 2020 2020 2020 2020  v,..            
-00043af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043b10: 2020 2020 7665 7262 6f73 653d 3029 0d0a      verbose=0)..
-00043b20: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00043b30: 2068 7970 6572 5f70 6172 616d 203d 3d20   hyper_param == 
-00043b40: 2752 5327 3a0d 0a20 2020 2020 2020 2020  'RS':..         
-00043b50: 2020 2020 2020 2023 2323 2320 4920 6861         #### I ha
-00043b60: 7665 2073 6574 2074 6865 2056 6572 626f  ve set the Verbo
-00043b70: 7365 2074 6f20 6265 2046 616c 7365 2068  se to be False h
-00043b80: 6572 6520 7369 6e63 6520 6974 2070 726f  ere since it pro
-00043b90: 6475 6365 7320 746f 6f20 6d75 6368 206f  duces too much o
-00043ba0: 7574 7075 7420 2323 230d 0a20 2020 2020  utput ###..     
-00043bb0: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
-00043bc0: 5261 6e64 6f6d 697a 6564 5365 6172 6368  RandomizedSearch
-00043bd0: 4356 2878 6762 6d2c 0d0a 2020 2020 2020  CV(xgbm,..      
+00043a40: 6376 203d 2073 6376 2c0d 0a20 2020 2020  cv = scv,..     
+00043a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043a70: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
+00043a80: 7365 3d30 290d 0a20 2020 2020 2020 2020  se=0)..         
+00043a90: 2020 2065 6c69 6620 6879 7065 725f 7061     elif hyper_pa
+00043aa0: 7261 6d20 3d3d 2027 5253 273a 0d0a 2020  ram == 'RS':..  
+00043ab0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00043ac0: 2323 2049 2068 6176 6520 7365 7420 7468  ## I have set th
+00043ad0: 6520 5665 7262 6f73 6520 746f 2062 6520  e Verbose to be 
+00043ae0: 4661 6c73 6520 6865 7265 2073 696e 6365  False here since
+00043af0: 2069 7420 7072 6f64 7563 6573 2074 6f6f   it produces too
+00043b00: 206d 7563 6820 6f75 7470 7574 2023 2323   much output ###
+00043b10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00043b20: 2020 6773 203d 2052 616e 646f 6d69 7a65    gs = Randomize
+00043b30: 6453 6561 7263 6843 5628 7867 626d 2c0d  dSearchCV(xgbm,.
+00043b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b70: 7061 7261 6d5f 6469 7374 7269 6275 7469  param_distributi
+00043b80: 6f6e 7320 3d20 635f 7061 7261 6d73 5b6d  ons = c_params[m
+00043b90: 6f64 656c 5f6e 616d 655d 2c0d 0a20 2020  odel_name],..   
+00043ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043bc0: 2020 2020 2020 2020 2020 2020 6e5f 6974              n_it
+00043bd0: 6572 203d 206e 6f5f 6974 6572 2c0d 0a20  er = no_iter,.. 
 00043be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c00: 2020 2020 2020 2020 2070 6172 616d 5f64           param_d
-00043c10: 6973 7472 6962 7574 696f 6e73 203d 2063  istributions = c
-00043c20: 5f70 6172 616d 735b 6d6f 6465 6c5f 6e61  _params[model_na
-00043c30: 6d65 5d2c 0d0a 2020 2020 2020 2020 2020  me],..          
+00043c00: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00043c10: 6f72 696e 6720 3d20 7363 6f72 6572 2c0d  oring = scorer,.
+00043c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c60: 2020 2020 206e 5f69 7465 7220 3d20 6e6f       n_iter = no
-00043c70: 5f69 7465 722c 0d0a 2020 2020 2020 2020  _iter,..        
+00043c50: 7265 6669 7420 3d20 7265 6669 745f 6d65  refit = refit_me
+00043c60: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
+00043c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ca0: 2020 2020 2020 2073 636f 7269 6e67 203d         scoring =
-00043cb0: 2073 636f 7265 722c 0d0a 2020 2020 2020   scorer,..      
+00043c90: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
+00043ca0: 696e 5f73 636f 7265 203d 2054 7275 652c  in_score = True,
+00043cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00043cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ce0: 2020 2020 2020 2020 2072 6566 6974 203d           refit =
-00043cf0: 2072 6566 6974 5f6d 6574 7269 632c 0d0a   refit_metric,..
+00043ce0: 2072 616e 646f 6d5f 7374 6174 6520 3d20   random_state = 
+00043cf0: 7365 6564 2c0d 0a20 2020 2020 2020 2020  seed,..         
 00043d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00043d30: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
-00043d40: 6520 3d20 5472 7565 2c0d 0a20 2020 2020  e = True,..     
+00043d20: 2020 2020 2020 6e5f 6a6f 6273 3d6e 5f6a        n_jobs=n_j
+00043d30: 6f62 732c 0d0a 2020 2020 2020 2020 2020  obs,..          
+00043d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d70: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-00043d80: 5f73 7461 7465 203d 2073 6565 642c 0d0a  _state = seed,..
+00043d60: 2020 2020 2063 7620 3d20 7363 762c 0d0a       cv = scv,..
+00043d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043db0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00043dc0: 5f6a 6f62 733d 6e5f 6a6f 6273 2c0d 0a20  _jobs=n_jobs,.. 
-00043dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043df0: 2020 2020 2020 2020 2020 2020 2020 6376                cv
-00043e00: 203d 2073 6376 2c0d 0a20 2020 2020 2020   = scv,..       
-00043e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e30: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-00043e40: 203d 2030 290d 0a20 2020 2020 2020 2020   = 0)..         
-00043e50: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00043e60: 2020 2020 2020 2020 2020 2323 2323 2043            #### C
-00043e70: 6174 426f 6f73 7420 646f 6573 206e 6f74  atBoost does not
-00043e80: 206e 6565 6420 4879 7065 7220 5061 7261   need Hyper Para
-00043e90: 6d65 7465 7220 7475 6e69 6e67 203d 3e20  meter tuning => 
-00043ea0: 6974 2773 2067 7265 6174 206f 7574 206f  it's great out o
-00043eb0: 6620 7468 6520 626f 7821 0d0a 2020 2020  f the box!..    
-00043ec0: 2020 2020 2020 2020 2020 2020 6773 203d              gs =
-00043ed0: 2063 6f70 792e 6465 6570 636f 7079 2878   copy.deepcopy(x
-00043ee0: 6762 6d29 0d0a 2020 2020 2020 2020 656c  gbm)..        el
-00043ef0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00043f00: 2023 2320 466f 7220 6d75 6c74 692d 6c61   ## For multi-la
-00043f10: 6265 6c20 7072 6f62 6c65 6d73 2c20 796f  bel problems, yo
-00043f20: 7520 6361 6e27 7420 646f 2047 7269 6453  u can't do GridS
-00043f30: 6561 7263 6820 6f72 2052 616e 646f 6d69  earch or Randomi
-00043f40: 7a65 6453 6561 7263 6820 7369 6e63 6520  zedSearch since 
-00043f50: 6974 2077 696c 6c20 7461 6b65 2074 6f6f  it will take too
-00043f60: 206c 6f6e 670d 0a20 2020 2020 2020 2020   long..         
-00043f70: 2020 2067 7320 3d20 636f 7079 2e64 6565     gs = copy.dee
-00043f80: 7063 6f70 7928 7867 626d 290d 0a20 2020  pcopy(xgbm)..   
-00043f90: 2023 7472 6169 6e73 2061 6e64 206f 7074   #trains and opt
-00043fa0: 696d 697a 6573 2074 6865 206d 6f64 656c  imizes the model
-00043fb0: 2023 2323 2323 2323 2323 0d0a 2020 2020   #########..    
-00043fc0: 6576 616c 5f73 6574 203d 205b 2858 5f74  eval_set = [(X_t
-00043fd0: 7261 696e 2c79 5f74 7261 696e 292c 2858  rain,y_train),(X
-00043fe0: 5f63 762c 795f 6376 295d 0d0a 2020 2020  _cv,y_cv)]..    
-00043ff0: 7072 696e 7428 2746 696e 6469 6e67 2042  print('Finding B
-00044000: 6573 7420 4d6f 6465 6c20 616e 6420 4879  est Model and Hy
-00044010: 7065 7220 5061 7261 6d65 7465 7273 2066  per Parameters f
-00044020: 6f72 2025 7320 6d6f 6465 6c2e 2e2e 2720  or %s model...' 
-00044030: 256d 6f64 656c 5f6e 616d 6529 0d0a 2020  %model_name)..  
-00044040: 2020 2323 2323 2320 4865 7265 2069 7320    ##### Here is 
-00044050: 7768 6572 6520 7765 2070 7574 2074 6865  where we put the
-00044060: 2070 6172 745f 7472 6169 6e20 616e 6420   part_train and 
-00044070: 7061 7274 5f63 7620 746f 6765 7468 6572  part_cv together
-00044080: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
-00044090: 2020 6966 206d 6f64 656c 7479 7065 2021    if modeltype !
-000440a0: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-000440b0: 0a20 2020 2020 2020 2023 2323 2044 6f20  .        ### Do 
-000440c0: 7468 6973 206f 6e6c 7920 666f 7220 4269  this only for Bi
-000440d0: 6e61 7279 2043 6c61 7373 6573 2061 6e64  nary Classes and
-000440e0: 204d 756c 7469 2d43 6c61 7373 6573 2c20   Multi-Classes, 
-000440f0: 626f 7468 2061 7265 206f 6b61 790d 0a20  both are okay.. 
-00044100: 2020 2020 2020 2062 6173 656c 696e 655f         baseline_
-00044110: 6163 6375 203d 2031 2d28 7472 6169 6e5b  accu = 1-(train[
-00044120: 6561 6368 5f74 6172 6765 745d 2e76 616c  each_target].val
-00044130: 7565 5f63 6f75 6e74 7328 3129 2e73 6f72  ue_counts(1).sor
-00044140: 745f 7661 6c75 6573 2829 295b 7261 7265  t_values())[rare
-00044150: 5f63 6c61 7373 5d0d 0a20 2020 2020 2020  _class]..       
-00044160: 2070 7269 6e74 2827 2020 2020 4261 7365   print('    Base
-00044170: 6c69 6e65 2041 6363 7572 6163 7920 4e65  line Accuracy Ne
-00044180: 6564 6564 2066 6f72 204d 6f64 656c 203d  eded for Model =
-00044190: 2025 302e 3266 2525 2720 2528 6261 7365   %0.2f%%' %(base
-000441a0: 6c69 6e65 5f61 6363 752a 3130 3029 290d  line_accu*100)).
-000441b0: 0a20 2020 2070 7269 6e74 2827 2020 2020  .    print('    
-000441c0: 4350 5520 436f 756e 7420 3d20 2573 2069  CPU Count = %s i
-000441d0: 6e20 7468 6973 2064 6576 6963 6527 2025  n this device' %
-000441e0: 4350 555f 636f 756e 7429 0d0a 2020 2020  CPU_count)..    
-000441f0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-00044200: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-00044210: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
-00044220: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
-00044230: 2020 2020 2020 6966 206d 6f64 656c 5f6e        if model_n
-00044240: 616d 652e 6c6f 7765 7228 2920 3d3d 2027  ame.lower() == '
-00044250: 6361 7462 6f6f 7374 273a 0d0a 2020 2020  catboost':..    
-00044260: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00044270: 5f64 696d 203d 2064 6174 615f 6469 6d2a  _dim = data_dim*
-00044280: 6f6e 655f 686f 745f 7369 7a65 2f6c 656e  one_hot_size/len
-00044290: 2870 7265 6473 290d 0a20 2020 2020 2020  (preds)..       
-000442a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-000442b0: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
-000442c0: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
-000442d0: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
-000442e0: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
-000442f0: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
-00044300: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
-00044310: 2874 6172 6765 7429 2f28 3330 3030 3030  (target)/(300000
-00044320: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
-00044330: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00044340: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00044350: 2020 2020 7072 696e 7428 2755 7369 6e67      print('Using
-00044360: 2025 7320 4d6f 6465 6c2c 2045 7374 696d   %s Model, Estim
-00044370: 6174 6564 2054 7261 696e 696e 6720 7469  ated Training ti
-00044380: 6d65 203d 2025 302e 3366 206d 696e 7327  me = %0.3f mins'
-00044390: 2025 286d 6f64 656c 5f6e 616d 652c 6461   %(model_name,da
-000443a0: 7461 5f64 696d 2a6d 6178 5f63 6c61 7373  ta_dim*max_class
-000443b0: 5f6c 656e 6774 682a 6c65 6e28 7461 7267  _length*len(targ
-000443c0: 6574 292f 2835 3030 3030 2e2a 4350 555f  et)/(50000.*CPU_
-000443d0: 636f 756e 7429 2929 0d0a 2020 2020 2020  count)))..      
-000443e0: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
-000443f0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-00044400: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00044410: 2827 5573 696e 6720 2573 204d 6f64 656c  ('Using %s Model
-00044420: 2c20 4573 7469 6d61 7465 6420 5472 6169  , Estimated Trai
-00044430: 6e69 6e67 2074 696d 6520 3d20 2530 2e33  ning time = %0.3
-00044440: 6620 6d69 6e73 2720 2528 6d6f 6465 6c5f  f mins' %(model_
-00044450: 6e61 6d65 2c64 6174 615f 6469 6d2a 6d61  name,data_dim*ma
-00044460: 785f 636c 6173 735f 6c65 6e67 7468 2a6c  x_class_length*l
-00044470: 656e 2874 6172 6765 7429 2f28 3830 3030  en(target)/(8000
-00044480: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
-00044490: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000444a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000444b0: 7428 2755 7369 6e67 2025 7320 4d6f 6465  t('Using %s Mode
-000444c0: 6c2c 2045 7374 696d 6174 6564 2054 7261  l, Estimated Tra
-000444d0: 696e 696e 6720 7469 6d65 203d 2025 302e  ining time = %0.
-000444e0: 3366 206d 696e 7327 2025 286d 6f64 656c  3f mins' %(model
-000444f0: 5f6e 616d 652c 6461 7461 5f64 696d 2a6d  _name,data_dim*m
-00044500: 6178 5f63 6c61 7373 5f6c 656e 6774 682a  ax_class_length*
-00044510: 6c65 6e28 7461 7267 6574 292f 2834 3030  len(target)/(400
-00044520: 3030 2e2a 4350 555f 636f 756e 7429 2929  00.*CPU_count)))
-00044530: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00044540: 2020 2020 2023 2323 2323 2054 6869 7320       ##### This 
-00044550: 6973 2066 6f72 2063 6c61 7373 6966 6963  is for classific
-00044560: 6174 696f 6e20 7768 6963 6820 6469 6666  ation which diff
-00044570: 6572 7320 666f 7220 4772 6964 5365 6172  ers for GridSear
-00044580: 6368 2076 7320 5261 6e64 6f6d 697a 6564  ch vs Randomized
-00044590: 5365 6172 6368 2023 2323 2323 2323 2323  Search #########
-000445a0: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
-000445b0: 6620 6879 7065 725f 7061 7261 6d20 3d3d  f hyper_param ==
-000445c0: 2027 4753 273a 0d0a 2020 2020 2020 2020   'GS':..        
-000445d0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-000445e0: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-000445f0: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
-00044600: 6e61 6d65 2e6c 6f77 6572 2829 203d 3d20  name.lower() == 
-00044610: 2763 6174 626f 6f73 7427 3a0d 0a20 2020  'catboost':..   
-00044620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044630: 2064 6174 615f 6469 6d20 3d20 6461 7461   data_dim = data
-00044640: 5f64 696d 2a6f 6e65 5f68 6f74 5f73 697a  _dim*one_hot_siz
-00044650: 652f 6c65 6e28 7072 6564 7329 0d0a 2020  e/len(preds)..  
-00044660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044670: 2020 7072 696e 7428 2755 7369 6e67 2025    print('Using %
-00044680: 7320 4d6f 6465 6c2c 2045 7374 696d 6174  s Model, Estimat
-00044690: 6564 2054 7261 696e 696e 6720 7469 6d65  ed Training time
-000446a0: 203d 2025 302e 3366 206d 696e 7327 2025   = %0.3f mins' %
-000446b0: 286d 6f64 656c 5f6e 616d 652c 6461 7461  (model_name,data
-000446c0: 5f64 696d 2a6d 6178 5f63 6c61 7373 5f6c  _dim*max_class_l
-000446d0: 656e 6774 682a 6c65 6e28 7461 7267 6574  ength*len(target
-000446e0: 292f 2833 3030 3030 302e 2a43 5055 5f63  )/(300000.*CPU_c
-000446f0: 6f75 6e74 2929 290d 0a20 2020 2020 2020  ount)))..       
-00044700: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00044710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044720: 2020 2020 7072 696e 7428 2755 7369 6e67      print('Using
-00044730: 2025 7320 4d6f 6465 6c2c 2045 7374 696d   %s Model, Estim
-00044740: 6174 6564 2054 7261 696e 696e 6720 7469  ated Training ti
-00044750: 6d65 203d 2025 302e 3366 206d 696e 7327  me = %0.3f mins'
-00044760: 2025 286d 6f64 656c 5f6e 616d 652c 6461   %(model_name,da
-00044770: 7461 5f64 696d 2a28 6d61 785f 636c 6173  ta_dim*(max_clas
-00044780: 735f 6c65 6e67 7468 2a2a 3229 2a6c 656e  s_length**2)*len
-00044790: 2874 6172 6765 7429 2f28 3130 3030 3030  (target)/(100000
-000447a0: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
-000447b0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000447c0: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
-000447d0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-000447e0: 2020 2020 2020 2020 2023 2323 2320 4120           #### A 
-000447f0: 4c69 6e65 6172 206d 6f64 656c 2069 7320  Linear model is 
-00044800: 7573 7561 6c6c 7920 7468 6520 6661 7374  usually the fast
-00044810: 6573 7420 2323 2323 2323 2323 2323 230d  est ###########.
-00044820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044830: 2070 7269 6e74 2827 5573 696e 6720 2573   print('Using %s
-00044840: 204d 6f64 656c 2c20 4573 7469 6d61 7465   Model, Estimate
-00044850: 6420 5472 6169 6e69 6e67 2074 696d 6520  d Training time 
-00044860: 3d20 2530 2e33 6620 6d69 6e73 2720 2528  = %0.3f mins' %(
-00044870: 6d6f 6465 6c5f 6e61 6d65 2c64 6174 615f  model_name,data_
-00044880: 6469 6d2a 6d61 785f 636c 6173 735f 6c65  dim*max_class_le
-00044890: 6e67 7468 2a6c 656e 2874 6172 6765 7429  ngth*len(target)
-000448a0: 2f28 3530 3030 302e 2a43 5055 5f63 6f75  /(50000.*CPU_cou
-000448b0: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
-000448c0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000448d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000448e0: 2755 7369 6e67 2025 7320 4d6f 6465 6c2c  'Using %s Model,
-000448f0: 2045 7374 696d 6174 6564 2054 7261 696e   Estimated Train
-00044900: 696e 6720 7469 6d65 203d 2025 302e 3366  ing time = %0.3f
-00044910: 206d 696e 7327 2025 286d 6f64 656c 5f6e   mins' %(model_n
-00044920: 616d 652c 6461 7461 5f64 696d 2a6d 6178  ame,data_dim*max
-00044930: 5f63 6c61 7373 5f6c 656e 6774 682a 6c65  _class_length*le
-00044940: 6e28 7461 7267 6574 292f 2831 3630 3030  n(target)/(16000
-00044950: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
-00044960: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00044970: 2020 2020 2020 2020 2020 2069 6620 426f             if Bo
-00044980: 6f73 7469 6e67 5f46 6c61 673a 0d0a 2020  osting_Flag:..  
-00044990: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000449a0: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
-000449b0: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
-000449c0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-000449d0: 2020 2020 2020 2020 6461 7461 5f64 696d          data_dim
-000449e0: 203d 2064 6174 615f 6469 6d2a 6f6e 655f   = data_dim*one_
-000449f0: 686f 745f 7369 7a65 2f6c 656e 2870 7265  hot_size/len(pre
-00044a00: 6473 290d 0a20 2020 2020 2020 2020 2020  ds)..           
-00044a10: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00044a20: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
-00044a30: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
-00044a40: 6e67 2074 696d 6520 3d20 2530 2e32 6620  ng time = %0.2f 
-00044a50: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
-00044a60: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
-00044a70: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
-00044a80: 2874 6172 6765 7429 2f28 3330 3030 3030  (target)/(300000
-00044a90: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
-00044aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044ab0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00044ac0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00044ad0: 7428 2755 7369 6e67 2025 7320 4d6f 6465  t('Using %s Mode
-00044ae0: 6c2c 2045 7374 696d 6174 6564 2054 7261  l, Estimated Tra
-00044af0: 696e 696e 6720 7469 6d65 203d 2025 302e  ining time = %0.
-00044b00: 3266 206d 696e 7327 2025 286d 6f64 656c  2f mins' %(model
-00044b10: 5f6e 616d 652c 6461 7461 5f64 696d 2a28  _name,data_dim*(
-00044b20: 6d61 785f 636c 6173 735f 6c65 6e67 7468  max_class_length
-00044b30: 292a 6c65 6e28 7461 7267 6574 292a 2a32  )*len(target)**2
-00044b40: 2f28 3430 3030 302e 2a43 5055 5f63 6f75  /(40000.*CPU_cou
-00044b50: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
-00044b60: 2020 2065 6c69 6620 426f 6f73 7469 6e67     elif Boosting
-00044b70: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
-00044b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044b90: 7072 696e 7428 2755 7369 6e67 2025 7320  print('Using %s 
-00044ba0: 4d6f 6465 6c2c 2045 7374 696d 6174 6564  Model, Estimated
-00044bb0: 2054 7261 696e 696e 6720 7469 6d65 203d   Training time =
-00044bc0: 2025 302e 3266 206d 696e 7327 2025 286d   %0.2f mins' %(m
-00044bd0: 6f64 656c 5f6e 616d 652c 6461 7461 5f64  odel_name,data_d
-00044be0: 696d 2a6d 6178 5f63 6c61 7373 5f6c 656e  im*max_class_len
-00044bf0: 6774 682a 6c65 6e28 7461 7267 6574 292f  gth*len(target)/
-00044c00: 2831 3030 3030 302e 2a43 5055 5f63 6f75  (100000.*CPU_cou
-00044c10: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
-00044c20: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00044c30: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00044c40: 2755 7369 6e67 2025 7320 4d6f 6465 6c2c  'Using %s Model,
-00044c50: 2045 7374 696d 6174 6564 2054 7261 696e   Estimated Train
-00044c60: 696e 6720 7469 6d65 203d 2025 302e 3266  ing time = %0.2f
-00044c70: 206d 696e 7327 2025 286d 6f64 656c 5f6e   mins' %(model_n
-00044c80: 616d 652c 6461 7461 5f64 696d 2a6d 6178  ame,data_dim*max
-00044c90: 5f63 6c61 7373 5f6c 656e 6774 682a 6c65  _class_length*le
-00044ca0: 6e28 7461 7267 6574 292f 2832 3530 3030  n(target)/(25000
-00044cb0: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
-00044cc0: 2020 2020 2323 2323 2320 5369 6e63 6520      ##### Since 
-00044cd0: 7765 2061 7265 2075 7369 6e67 204d 756c  we are using Mul
-00044ce0: 7469 706c 6520 4d6f 6465 6c73 2065 6163  tiple Models eac
-00044cf0: 6820 7769 7468 2069 7473 206f 776e 2071  h with its own q
-00044d00: 7569 726b 732c 2077 6520 6861 7665 2074  uirks, we have t
-00044d10: 6f20 6d61 6b65 2073 7572 6520 6974 2069  o make sure it i
-00044d20: 7320 646f 6e65 2074 6869 7320 7761 790d  s done this way.
-00044d30: 0a20 2020 2023 2323 2323 2023 2323 2323  .    ##### #####
-00044d40: 2323 2323 2323 2320 2020 2020 2054 5241  #######      TRA
-00044d50: 494e 494e 4720 4d4f 4445 4c20 4649 5253  INING MODEL FIRS
-00044d60: 5420 5449 4d45 2057 4954 4820 585f 5452  T TIME WITH X_TR
-00044d70: 4149 4e20 414e 4420 5445 5354 494e 4720  AIN AND TESTING 
-00044d80: 4f4e 2058 5f43 5620 2323 2323 2323 2323  ON X_CV ########
-00044d90: 2323 2323 0d0a 2020 2020 6d6f 6465 6c5f  ####..    model_
-00044da0: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
-00044db0: 652e 7469 6d65 2829 0d0a 2020 2020 2323  e.time()..    ##
+00043da0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
+00043db0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00043dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043dd0: 2023 2323 2320 4361 7442 6f6f 7374 2064   #### CatBoost d
+00043de0: 6f65 7320 6e6f 7420 6e65 6564 2048 7970  oes not need Hyp
+00043df0: 6572 2050 6172 616d 6574 6572 2074 756e  er Parameter tun
+00043e00: 696e 6720 3d3e 2069 7427 7320 6772 6561  ing => it's grea
+00043e10: 7420 6f75 7420 6f66 2074 6865 2062 6f78  t out of the box
+00043e20: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+00043e30: 2020 2067 7320 3d20 636f 7079 2e64 6565     gs = copy.dee
+00043e40: 7063 6f70 7928 7867 626d 290d 0a20 2020  pcopy(xgbm)..   
+00043e50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00043e60: 2020 2020 2020 2020 2323 2046 6f72 206d          ## For m
+00043e70: 756c 7469 2d6c 6162 656c 2070 726f 626c  ulti-label probl
+00043e80: 656d 732c 2079 6f75 2063 616e 2774 2064  ems, you can't d
+00043e90: 6f20 4772 6964 5365 6172 6368 206f 7220  o GridSearch or 
+00043ea0: 5261 6e64 6f6d 697a 6564 5365 6172 6368  RandomizedSearch
+00043eb0: 2073 696e 6365 2069 7420 7769 6c6c 2074   since it will t
+00043ec0: 616b 6520 746f 6f20 6c6f 6e67 0d0a 2020  ake too long..  
+00043ed0: 2020 2020 2020 2020 2020 6773 203d 2063            gs = c
+00043ee0: 6f70 792e 6465 6570 636f 7079 2878 6762  opy.deepcopy(xgb
+00043ef0: 6d29 0d0a 2020 2020 2374 7261 696e 7320  m)..    #trains 
+00043f00: 616e 6420 6f70 7469 6d69 7a65 7320 7468  and optimizes th
+00043f10: 6520 6d6f 6465 6c20 2323 2323 2323 2323  e model ########
+00043f20: 230d 0a20 2020 2065 7661 6c5f 7365 7420  #..    eval_set 
+00043f30: 3d20 5b28 585f 7472 6169 6e2c 795f 7472  = [(X_train,y_tr
+00043f40: 6169 6e29 2c28 585f 6376 2c79 5f63 7629  ain),(X_cv,y_cv)
+00043f50: 5d0d 0a20 2020 2070 7269 6e74 2827 4669  ]..    print('Fi
+00043f60: 6e64 696e 6720 4265 7374 204d 6f64 656c  nding Best Model
+00043f70: 2061 6e64 2048 7970 6572 2050 6172 616d   and Hyper Param
+00043f80: 6574 6572 7320 666f 7220 2573 206d 6f64  eters for %s mod
+00043f90: 656c 2e2e 2e27 2025 6d6f 6465 6c5f 6e61  el...' %model_na
+00043fa0: 6d65 290d 0a20 2020 2023 2323 2323 2048  me)..    ##### H
+00043fb0: 6572 6520 6973 2077 6865 7265 2077 6520  ere is where we 
+00043fc0: 7075 7420 7468 6520 7061 7274 5f74 7261  put the part_tra
+00043fd0: 696e 2061 6e64 2070 6172 745f 6376 2074  in and part_cv t
+00043fe0: 6f67 6574 6865 7220 2323 2323 2323 2323  ogether ########
+00043ff0: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
+00044000: 6c74 7970 6520 213d 2027 5265 6772 6573  ltype != 'Regres
+00044010: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+00044020: 2323 2320 446f 2074 6869 7320 6f6e 6c79  ### Do this only
+00044030: 2066 6f72 2042 696e 6172 7920 436c 6173   for Binary Clas
+00044040: 7365 7320 616e 6420 4d75 6c74 692d 436c  ses and Multi-Cl
+00044050: 6173 7365 732c 2062 6f74 6820 6172 6520  asses, both are 
+00044060: 6f6b 6179 0d0a 2020 2020 2020 2020 6261  okay..        ba
+00044070: 7365 6c69 6e65 5f61 6363 7520 3d20 312d  seline_accu = 1-
+00044080: 2874 7261 696e 5b65 6163 685f 7461 7267  (train[each_targ
+00044090: 6574 5d2e 7661 6c75 655f 636f 756e 7473  et].value_counts
+000440a0: 2831 292e 736f 7274 5f76 616c 7565 7328  (1).sort_values(
+000440b0: 2929 5b72 6172 655f 636c 6173 735d 0d0a  ))[rare_class]..
+000440c0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+000440d0: 2020 2042 6173 656c 696e 6520 4163 6375     Baseline Accu
+000440e0: 7261 6379 204e 6565 6465 6420 666f 7220  racy Needed for 
+000440f0: 4d6f 6465 6c20 3d20 2530 2e32 6625 2527  Model = %0.2f%%'
+00044100: 2025 2862 6173 656c 696e 655f 6163 6375   %(baseline_accu
+00044110: 2a31 3030 2929 0d0a 2020 2020 7072 696e  *100))..    prin
+00044120: 7428 2720 2020 2043 5055 2043 6f75 6e74  t('    CPU Count
+00044130: 203d 2025 7320 696e 2074 6869 7320 6465   = %s in this de
+00044140: 7669 6365 2720 2543 5055 5f63 6f75 6e74  vice' %CPU_count
+00044150: 290d 0a20 2020 2069 6620 6d6f 6465 6c74  )..    if modelt
+00044160: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
+00044170: 6f6e 273a 0d0a 2020 2020 2020 2020 6966  on':..        if
+00044180: 2042 6f6f 7374 696e 675f 466c 6167 3a0d   Boosting_Flag:.
+00044190: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000441a0: 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77 6572  model_name.lower
+000441b0: 2829 203d 3d20 2763 6174 626f 6f73 7427  () == 'catboost'
+000441c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000441d0: 2020 2064 6174 615f 6469 6d20 3d20 6461     data_dim = da
+000441e0: 7461 5f64 696d 2a6f 6e65 5f68 6f74 5f73  ta_dim*one_hot_s
+000441f0: 697a 652f 6c65 6e28 7072 6564 7329 0d0a  ize/len(preds)..
+00044200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044210: 7072 696e 7428 2755 7369 6e67 2025 7320  print('Using %s 
+00044220: 4d6f 6465 6c2c 2045 7374 696d 6174 6564  Model, Estimated
+00044230: 2054 7261 696e 696e 6720 7469 6d65 203d   Training time =
+00044240: 2025 302e 3366 206d 696e 7327 2025 286d   %0.3f mins' %(m
+00044250: 6f64 656c 5f6e 616d 652c 6461 7461 5f64  odel_name,data_d
+00044260: 696d 2a6d 6178 5f63 6c61 7373 5f6c 656e  im*max_class_len
+00044270: 6774 682a 6c65 6e28 7461 7267 6574 292f  gth*len(target)/
+00044280: 2833 3030 3030 3030 2e2a 4350 555f 636f  (3000000.*CPU_co
+00044290: 756e 7429 2929 0d0a 2020 2020 2020 2020  unt)))..        
+000442a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000442b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000442c0: 2827 5573 696e 6720 2573 204d 6f64 656c  ('Using %s Model
+000442d0: 2c20 4573 7469 6d61 7465 6420 5472 6169  , Estimated Trai
+000442e0: 6e69 6e67 2074 696d 6520 3d20 2530 2e33  ning time = %0.3
+000442f0: 6620 6d69 6e73 2720 2528 6d6f 6465 6c5f  f mins' %(model_
+00044300: 6e61 6d65 2c64 6174 615f 6469 6d2a 6d61  name,data_dim*ma
+00044310: 785f 636c 6173 735f 6c65 6e67 7468 2a6c  x_class_length*l
+00044320: 656e 2874 6172 6765 7429 2f28 3530 3030  en(target)/(5000
+00044330: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
+00044340: 0a20 2020 2020 2020 2065 6c69 6620 426f  .        elif Bo
+00044350: 6f73 7469 6e67 5f46 6c61 6720 6973 204e  osting_Flag is N
+00044360: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00044370: 2020 7072 696e 7428 2755 7369 6e67 2025    print('Using %
+00044380: 7320 4d6f 6465 6c2c 2045 7374 696d 6174  s Model, Estimat
+00044390: 6564 2054 7261 696e 696e 6720 7469 6d65  ed Training time
+000443a0: 203d 2025 302e 3366 206d 696e 7327 2025   = %0.3f mins' %
+000443b0: 286d 6f64 656c 5f6e 616d 652c 6461 7461  (model_name,data
+000443c0: 5f64 696d 2a6d 6178 5f63 6c61 7373 5f6c  _dim*max_class_l
+000443d0: 656e 6774 682a 6c65 6e28 7461 7267 6574  ength*len(target
+000443e0: 292f 2838 3030 3030 2e2a 4350 555f 636f  )/(80000.*CPU_co
+000443f0: 756e 7429 2929 0d0a 2020 2020 2020 2020  unt)))..        
+00044400: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00044410: 2020 2070 7269 6e74 2827 5573 696e 6720     print('Using 
+00044420: 2573 204d 6f64 656c 2c20 4573 7469 6d61  %s Model, Estima
+00044430: 7465 6420 5472 6169 6e69 6e67 2074 696d  ted Training tim
+00044440: 6520 3d20 2530 2e33 6620 6d69 6e73 2720  e = %0.3f mins' 
+00044450: 2528 6d6f 6465 6c5f 6e61 6d65 2c64 6174  %(model_name,dat
+00044460: 615f 6469 6d2a 6d61 785f 636c 6173 735f  a_dim*max_class_
+00044470: 6c65 6e67 7468 2a6c 656e 2874 6172 6765  length*len(targe
+00044480: 7429 2f28 3430 3030 302e 2a43 5055 5f63  t)/(40000.*CPU_c
+00044490: 6f75 6e74 2929 290d 0a20 2020 2065 6c73  ount)))..    els
+000444a0: 653a 0d0a 2020 2020 2020 2020 2323 2323  e:..        ####
+000444b0: 2320 5468 6973 2069 7320 666f 7220 636c  # This is for cl
+000444c0: 6173 7369 6669 6361 7469 6f6e 2077 6869  assification whi
+000444d0: 6368 2064 6966 6665 7273 2066 6f72 2047  ch differs for G
+000444e0: 7269 6453 6561 7263 6820 7673 2052 616e  ridSearch vs Ran
+000444f0: 646f 6d69 7a65 6453 6561 7263 6820 2323  domizedSearch ##
+00044500: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00044510: 2020 2020 2020 6966 2068 7970 6572 5f70        if hyper_p
+00044520: 6172 616d 203d 3d20 2747 5327 3a0d 0a20  aram == 'GS':.. 
+00044530: 2020 2020 2020 2020 2020 2069 6620 426f             if Bo
+00044540: 6f73 7469 6e67 5f46 6c61 673a 0d0a 2020  osting_Flag:..  
+00044550: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00044560: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
+00044570: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
+00044580: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00044590: 2020 2020 2020 2020 6461 7461 5f64 696d          data_dim
+000445a0: 203d 2064 6174 615f 6469 6d2a 6f6e 655f   = data_dim*one_
+000445b0: 686f 745f 7369 7a65 2f6c 656e 2870 7265  hot_size/len(pre
+000445c0: 6473 290d 0a20 2020 2020 2020 2020 2020  ds)..           
+000445d0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000445e0: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
+000445f0: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
+00044600: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
+00044610: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
+00044620: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
+00044630: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
+00044640: 2874 6172 6765 7429 2f28 3330 3030 3030  (target)/(300000
+00044650: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
+00044660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044670: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00044680: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00044690: 7428 2755 7369 6e67 2025 7320 4d6f 6465  t('Using %s Mode
+000446a0: 6c2c 2045 7374 696d 6174 6564 2054 7261  l, Estimated Tra
+000446b0: 696e 696e 6720 7469 6d65 203d 2025 302e  ining time = %0.
+000446c0: 3366 206d 696e 7327 2025 286d 6f64 656c  3f mins' %(model
+000446d0: 5f6e 616d 652c 6461 7461 5f64 696d 2a28  _name,data_dim*(
+000446e0: 6d61 785f 636c 6173 735f 6c65 6e67 7468  max_class_length
+000446f0: 2a2a 3229 2a6c 656e 2874 6172 6765 7429  **2)*len(target)
+00044700: 2f28 3130 3030 3030 2e2a 4350 555f 636f  /(100000.*CPU_co
+00044710: 756e 7429 2929 0d0a 2020 2020 2020 2020  unt)))..        
+00044720: 2020 2020 656c 6966 2042 6f6f 7374 696e      elif Boostin
+00044730: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
+00044740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044750: 2023 2323 2320 4120 4c69 6e65 6172 206d   #### A Linear m
+00044760: 6f64 656c 2069 7320 7573 7561 6c6c 7920  odel is usually 
+00044770: 7468 6520 6661 7374 6573 7420 2323 2323  the fastest ####
+00044780: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00044790: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000447a0: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
+000447b0: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
+000447c0: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
+000447d0: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
+000447e0: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
+000447f0: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
+00044800: 2874 6172 6765 7429 2f28 3530 3030 302e  (target)/(50000.
+00044810: 2a43 5055 5f63 6f75 6e74 2929 290d 0a20  *CPU_count))).. 
+00044820: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00044830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00044840: 2020 7072 696e 7428 2755 7369 6e67 2025    print('Using %
+00044850: 7320 4d6f 6465 6c2c 2045 7374 696d 6174  s Model, Estimat
+00044860: 6564 2054 7261 696e 696e 6720 7469 6d65  ed Training time
+00044870: 203d 2025 302e 3366 206d 696e 7327 2025   = %0.3f mins' %
+00044880: 286d 6f64 656c 5f6e 616d 652c 6461 7461  (model_name,data
+00044890: 5f64 696d 2a6d 6178 5f63 6c61 7373 5f6c  _dim*max_class_l
+000448a0: 656e 6774 682a 6c65 6e28 7461 7267 6574  ength*len(target
+000448b0: 292f 2831 3630 3030 2e2a 4350 555f 636f  )/(16000.*CPU_co
+000448c0: 756e 7429 2929 0d0a 2020 2020 2020 2020  unt)))..        
+000448d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000448e0: 2020 2069 6620 426f 6f73 7469 6e67 5f46     if Boosting_F
+000448f0: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
+00044900: 2020 2020 2020 6966 206d 6f64 656c 5f6e        if model_n
+00044910: 616d 652e 6c6f 7765 7228 2920 3d3d 2027  ame.lower() == '
+00044920: 6361 7462 6f6f 7374 273a 0d0a 2020 2020  catboost':..    
+00044930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044940: 6461 7461 5f64 696d 203d 2064 6174 615f  data_dim = data_
+00044950: 6469 6d2a 6f6e 655f 686f 745f 7369 7a65  dim*one_hot_size
+00044960: 2f6c 656e 2870 7265 6473 290d 0a20 2020  /len(preds)..   
+00044970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044980: 2070 7269 6e74 2827 5573 696e 6720 2573   print('Using %s
+00044990: 204d 6f64 656c 2c20 4573 7469 6d61 7465   Model, Estimate
+000449a0: 6420 5472 6169 6e69 6e67 2074 696d 6520  d Training time 
+000449b0: 3d20 2530 2e32 6620 6d69 6e73 2720 2528  = %0.2f mins' %(
+000449c0: 6d6f 6465 6c5f 6e61 6d65 2c64 6174 615f  model_name,data_
+000449d0: 6469 6d2a 6d61 785f 636c 6173 735f 6c65  dim*max_class_le
+000449e0: 6e67 7468 2a6c 656e 2874 6172 6765 7429  ngth*len(target)
+000449f0: 2f28 3330 3030 3030 302e 2a43 5055 5f63  /(3000000.*CPU_c
+00044a00: 6f75 6e74 2929 290d 0a20 2020 2020 2020  ount)))..       
+00044a10: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00044a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044a30: 2020 2020 7072 696e 7428 2755 7369 6e67      print('Using
+00044a40: 2025 7320 4d6f 6465 6c2c 2045 7374 696d   %s Model, Estim
+00044a50: 6174 6564 2054 7261 696e 696e 6720 7469  ated Training ti
+00044a60: 6d65 203d 2025 302e 3266 206d 696e 7327  me = %0.2f mins'
+00044a70: 2025 286d 6f64 656c 5f6e 616d 652c 6461   %(model_name,da
+00044a80: 7461 5f64 696d 2a28 6d61 785f 636c 6173  ta_dim*(max_clas
+00044a90: 735f 6c65 6e67 7468 292a 6c65 6e28 7461  s_length)*len(ta
+00044aa0: 7267 6574 292a 2a32 2f28 3430 3030 302e  rget)**2/(40000.
+00044ab0: 2a43 5055 5f63 6f75 6e74 2929 290d 0a20  *CPU_count))).. 
+00044ac0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00044ad0: 426f 6f73 7469 6e67 5f46 6c61 6720 6973  Boosting_Flag is
+00044ae0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00044af0: 2020 2020 2020 2020 2323 2320 5468 6973          ### This
+00044b00: 2069 7320 666f 7220 6120 6c69 6e65 6172   is for a linear
+00044b10: 206d 6f64 656c 0d0a 2020 2020 2020 2020   model..        
+00044b20: 2020 2020 2020 2020 7072 696e 7428 2755          print('U
+00044b30: 7369 6e67 2025 7320 4d6f 6465 6c2c 2045  sing %s Model, E
+00044b40: 7374 696d 6174 6564 2054 7261 696e 696e  stimated Trainin
+00044b50: 6720 7469 6d65 203d 2025 302e 3266 206d  g time = %0.2f m
+00044b60: 696e 7327 2025 286d 6f64 656c 5f6e 616d  ins' %(model_nam
+00044b70: 652c 6461 7461 5f64 696d 2a6d 6178 5f63  e,data_dim*max_c
+00044b80: 6c61 7373 5f6c 656e 6774 682a 6c65 6e28  lass_length*len(
+00044b90: 7461 7267 6574 292f 2831 3030 3030 302e  target)/(100000.
+00044ba0: 2a43 5055 5f63 6f75 6e74 2929 290d 0a20  *CPU_count))).. 
+00044bb0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00044bc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00044bd0: 2020 2323 2320 5468 6973 2069 7320 666f    ### This is fo
+00044be0: 7220 6120 666f 7265 7374 7320 6d6f 6465  r a forests mode
+00044bf0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00044c00: 2020 2070 7269 6e74 2827 5573 696e 6720     print('Using 
+00044c10: 2573 204d 6f64 656c 2c20 4573 7469 6d61  %s Model, Estima
+00044c20: 7465 6420 5472 6169 6e69 6e67 2074 696d  ted Training tim
+00044c30: 6520 3d20 2530 2e32 6620 6d69 6e73 2720  e = %0.2f mins' 
+00044c40: 2528 6d6f 6465 6c5f 6e61 6d65 2c64 6174  %(model_name,dat
+00044c50: 615f 6469 6d2a 6d61 785f 636c 6173 735f  a_dim*max_class_
+00044c60: 6c65 6e67 7468 2a30 2e32 352a 6c65 6e28  length*0.25*len(
+00044c70: 7461 7267 6574 292f 2832 3530 3030 2e2a  target)/(25000.*
+00044c80: 4350 555f 636f 756e 7429 2929 0d0a 2020  CPU_count)))..  
+00044c90: 2020 2323 2323 2320 5369 6e63 6520 7765    ##### Since we
+00044ca0: 2061 7265 2075 7369 6e67 204d 756c 7469   are using Multi
+00044cb0: 706c 6520 4d6f 6465 6c73 2065 6163 6820  ple Models each 
+00044cc0: 7769 7468 2069 7473 206f 776e 2071 7569  with its own qui
+00044cd0: 726b 732c 2077 6520 6861 7665 2074 6f20  rks, we have to 
+00044ce0: 6d61 6b65 2073 7572 6520 6974 2069 7320  make sure it is 
+00044cf0: 646f 6e65 2074 6869 7320 7761 790d 0a20  done this way.. 
+00044d00: 2020 2023 2323 2323 2023 2323 2323 2323     ##### #######
+00044d10: 2323 2323 2320 2020 2020 2054 5241 494e  #####      TRAIN
+00044d20: 494e 4720 4d4f 4445 4c20 4649 5253 5420  ING MODEL FIRST 
+00044d30: 5449 4d45 2057 4954 4820 585f 5452 4149  TIME WITH X_TRAI
+00044d40: 4e20 414e 4420 5445 5354 494e 4720 4f4e  N AND TESTING ON
+00044d50: 2058 5f43 5620 2323 2323 2323 2323 2323   X_CV ##########
+00044d60: 2323 0d0a 2020 2020 6d6f 6465 6c5f 7374  ##..    model_st
+00044d70: 6172 745f 7469 6d65 203d 2074 696d 652e  art_time = time.
+00044d80: 7469 6d65 2829 0d0a 2020 2020 2323 2323  time()..    ####
+00044d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044e00: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00044e10: 2323 2323 2320 2020 4245 2056 4552 5920  #####   BE VERY 
-00044e20: 4341 5245 4655 4c20 4142 4f55 5420 4d4f  CAREFUL ABOUT MO
-00044e30: 4449 4659 494e 4720 5448 4953 2053 4543  DIFYING THIS SEC
-00044e40: 5449 4f4e 204a 5553 5420 4245 4341 5553  TION JUST BECAUS
-00044e50: 4520 2323 2323 2323 2323 2323 0d0a 2020  E ##########..  
-00044e60: 2020 2323 2323 2020 2020 4954 2041 5050    ####    IT APP
-00044e70: 4541 5253 204c 494b 4520 4455 504c 4943  EARS LIKE DUPLIC
-00044e80: 4154 4544 2043 4f44 4521 2120 2049 5420  ATED CODE!!  IT 
-00044e90: 4953 204e 4f54 2021 2120 2020 2020 2020  IS NOT !!       
-00044ea0: 2023 2323 2323 2323 2323 2323 2323 0d0a   #############..
-00044eb0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00044ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044f00: 0d0a 2020 2020 2323 2323 2320 5468 6973  ..    ##### This
-00044f10: 2069 7320 7768 6572 6520 796f 7520 7374   is where you st
-00044f20: 6172 7420 7472 6169 6e69 6e67 2074 6865  art training the
-00044f30: 206d 6f64 656c 2066 6f72 2046 4952 5354   model for FIRST
-00044f40: 2054 494d 4520 2023 2323 2323 2323 2323   TIME  #########
-00044f50: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
-00044f60: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00044f70: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-00044f80: 2020 2020 6966 2049 6d62 616c 616e 6365      if Imbalance
-00044f90: 645f 466c 6167 3a0d 0a20 2020 2020 2020  d_Flag:..       
-00044fa0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00044fb0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00044fc0: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
-00044fd0: 2323 2323 2020 496d 6261 6c61 6e63 6564  ####  Imbalanced
-00044fe0: 204d 6f64 656c 2054 7261 696e 696e 6720   Model Training 
-00044ff0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00045000: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-00045010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045020: 2070 7269 6e74 2827 496d 6261 6c61 6e63   print('Imbalanc
-00045030: 6564 2054 7261 696e 696e 6720 7573 696e  ed Training usin
-00045040: 6720 534d 4f54 4520 5261 7265 2043 6c61  g SMOTE Rare Cla
-00045050: 7373 204f 7665 7273 616d 706c 696e 6720  ss Oversampling 
-00045060: 6d65 7468 6f64 2e2e 2e27 290d 0a20 2020  method...')..   
-00045070: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00045080: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-00045090: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-000450a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000450b0: 2323 2320 5369 6e63 6520 7261 7265 2063  ### Since rare c
-000450c0: 6c61 7373 2069 7320 6e65 6564 6564 2069  lass is needed i
-000450d0: 6e20 7468 6520 6e65 7874 2073 7465 702c  n the next step,
-000450e0: 206a 7573 7420 7365 7474 696e 6720 7468   just setting th
-000450f0: 6520 7261 7265 5f63 6c61 7373 2061 7320  e rare_class as 
-00045100: 6172 7469 6669 6369 616c 6c79 2030 2e0d  artificially 0..
-00045110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045120: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
-00045130: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-00045140: 2020 2020 2023 2323 2053 696e 6365 2069       ### Since i
-00045150: 7420 6973 2061 2073 696e 676c 6520 6c61  t is a single la
-00045160: 6265 6c20 7072 6f62 6c65 6d2c 2077 6520  bel problem, we 
-00045170: 7573 6520 6561 6368 5f74 6172 6765 7420  use each_target 
-00045180: 696e 7374 6561 6420 6f66 2074 6172 6765  instead of targe
-00045190: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-000451a0: 2020 2023 2323 2020 2041 6c73 6f20 646f     ###   Also do
-000451b0: 206e 6f74 2075 7365 2074 6865 2047 7269   not use the Gri
-000451c0: 6453 6561 7263 6843 5620 6d6f 6465 6c20  dSearchCV model 
-000451d0: 4753 2068 6572 6520 7369 6e63 6520 534d  GS here since SM
-000451e0: 4f54 4520 6361 6e6e 6f74 2077 6f72 6b20  OTE cannot work 
-000451f0: 7769 7468 2069 740d 0a20 2020 2020 2020  with it..       
-00045200: 2020 2020 2020 2020 2023 2323 2075 7365           ### use
-00045210: 2074 6865 2062 6173 6520 6d6f 6465 6c20   the base model 
-00045220: 7472 6169 6e65 6420 7769 7468 2053 4d4f  trained with SMO
-00045230: 5445 2e0d 0a20 2020 2020 2020 2020 2020  TE...           
-00045240: 2020 2020 206d 6f64 656c 203d 2074 7261       model = tra
-00045250: 696e 696e 675f 7769 7468 5f53 4d4f 5445  ining_with_SMOTE
-00045260: 2858 5f74 7261 696e 2c79 5f74 7261 696e  (X_train,y_train
-00045270: 2c65 6163 685f 7461 7267 6574 2c65 7661  ,each_target,eva
-00045280: 6c5f 7365 742c 2078 6762 6d2c 0d0a 2020  l_set, xgbm,..  
-00045290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000452a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000452b0: 2020 2020 2042 6f6f 7374 696e 675f 466c       Boosting_Fl
-000452c0: 6167 2c20 6576 616c 5f6d 6574 7269 632c  ag, eval_metric,
-000452d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000452e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000452f0: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
-00045300: 7065 2c20 6d6f 6465 6c5f 6e61 6d65 2c20  pe, model_name, 
-00045310: 7472 6169 6e69 6e67 3d54 7275 652c 0d0a  training=True,..
-00045320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045340: 2020 2020 2020 206d 696e 6f72 6974 795f         minority_
-00045350: 636c 6173 733d 7261 7265 5f63 6c61 7373  class=rare_class
-00045360: 2c69 6d70 5f63 6174 733d 696d 705f 6361  ,imp_cats=imp_ca
-00045370: 7473 2c0d 0a20 2020 2020 2020 2020 2020  ts,..           
-00045380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045390: 2020 2020 2020 2020 2020 2020 6361 6c69              cali
-000453a0: 6272 6174 6f72 5f66 6c61 673d 6361 6c69  brator_flag=cali
-000453b0: 6272 6174 6f72 5f66 6c61 672c 0d0a 2020  brator_flag,..  
-000453c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453e0: 2020 2020 2047 5055 5f65 7869 7374 733d       GPU_exists=
-000453f0: 4750 555f 6578 6973 7473 2c20 7061 7261  GPU_exists, para
-00045400: 6d73 203d 2063 7075 5f70 6172 616d 732c  ms = cpu_params,
-00045410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045430: 2020 2020 2020 2020 206d 6f64 656c 5f6c           model_l
-00045440: 6162 656c 3d6d 6f64 656c 5f6c 6162 656c  abel=model_label
-00045450: 2c20 7665 7262 6f73 653d 7665 7262 6f73  , verbose=verbos
-00045460: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00045470: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00045480: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00045490: 5472 6169 6e69 6e67 206d 6f64 656c 2066  Training model f
-000454a0: 6972 7374 2074 696d 6520 7769 7468 2053  irst time with S
-000454b0: 4d4f 5445 2065 7272 6f72 696e 672e 2043  MOTE erroring. C
-000454c0: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
-000454d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000454e0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
-000454f0: 3d20 2046 616c 7365 0d0a 2020 2020 2020  =  False..      
-00045500: 2020 2020 2020 2020 2020 6265 7374 5f73            best_s
-00045510: 636f 7265 203d 2030 0d0a 2020 2020 2323  core = 0..    ##
-00045520: 2323 2323 2323 2320 2020 494d 504f 5254  #######   IMPORT
-00045530: 414e 5420 2020 2049 4d50 4f52 5441 4e54  ANT    IMPORTANT
-00045540: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00045550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045560: 2323 2323 2323 0d0a 2020 2020 2323 2020  ######..    ##  
-00045570: 2054 686f 7567 6820 7468 6973 206e 6578   Though this nex
-00045580: 7420 7374 6570 206c 6f6f 6b73 206c 696b  t step looks lik
-00045590: 6520 6974 2069 7320 6120 436f 6469 6e67  e it is a Coding
-000455a0: 204d 6973 7461 6b65 2c20 646f 6e27 7420   Mistake, don't 
-000455b0: 6368 616e 6765 2069 7421 0d0a 2020 2020  change it!..    
-000455c0: 2323 2020 2054 6869 7320 6973 2066 6f72  ##   This is for
-000455d0: 2063 6173 6520 7768 656e 2049 6d62 616c   case when Imbal
-000455e0: 616e 6365 6420 7769 7468 2043 6c61 7373  anced with Class
-000455f0: 6966 6963 6174 696f 6e20 7375 6363 6565  ification succee
-00045600: 6473 2c0d 0a20 2020 2023 2320 2020 7468  ds,..    ##   th
-00045610: 6973 206e 6578 7420 7374 6570 2069 7320  is next step is 
-00045620: 736b 6970 7065 6420 2323 0d0a 2020 2020  skipped ##..    
+00044dd0: 2323 2323 2323 2323 0d0a 2020 2020 2323  ########..    ##
+00044de0: 2323 2320 2020 4245 2056 4552 5920 4341  ###   BE VERY CA
+00044df0: 5245 4655 4c20 4142 4f55 5420 4d4f 4449  REFUL ABOUT MODI
+00044e00: 4659 494e 4720 5448 4953 2053 4543 5449  FYING THIS SECTI
+00044e10: 4f4e 204a 5553 5420 4245 4341 5553 4520  ON JUST BECAUSE 
+00044e20: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00044e30: 2323 2323 2020 2020 4954 2041 5050 4541  ####    IT APPEA
+00044e40: 5253 204c 494b 4520 4455 504c 4943 4154  RS LIKE DUPLICAT
+00044e50: 4544 2043 4f44 4521 2120 2049 5420 4953  ED CODE!!  IT IS
+00044e60: 204e 4f54 2021 2120 2020 2020 2020 2023   NOT !!        #
+00044e70: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00044e80: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00044e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044ec0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00044ed0: 2020 2020 2323 2323 2320 5468 6973 2069      ##### This i
+00044ee0: 7320 7768 6572 6520 796f 7520 7374 6172  s where you star
+00044ef0: 7420 7472 6169 6e69 6e67 2074 6865 206d  t training the m
+00044f00: 6f64 656c 2066 6f72 2046 4952 5354 2054  odel for FIRST T
+00044f10: 494d 4520 2023 2323 2323 2323 2323 2323  IME  ###########
+00044f20: 230d 0a20 2020 2069 6620 6d6f 6465 6c5f  #..    if model_
+00044f30: 6c61 6265 6c20 3d3d 2027 5369 6e67 6c65  label == 'Single
+00044f40: 5f4c 6162 656c 273a 0d0a 2020 2020 2020  _Label':..      
+00044f50: 2020 6966 2049 6d62 616c 616e 6365 645f    if Imbalanced_
+00044f60: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
+00044f70: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00044f80: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00044f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044fa0: 2323 2020 496d 6261 6c61 6e63 6564 204d  ##  Imbalanced M
+00044fb0: 6f64 656c 2054 7261 696e 696e 6720 2023  odel Training  #
+00044fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00044fd0: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+00044fe0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00044ff0: 7072 696e 7428 2749 6d62 616c 616e 6365  print('Imbalance
+00045000: 6420 5472 6169 6e69 6e67 2075 7369 6e67  d Training using
+00045010: 2053 4d4f 5445 2052 6172 6520 436c 6173   SMOTE Rare Clas
+00045020: 7320 4f76 6572 7361 6d70 6c69 6e67 206d  s Oversampling m
+00045030: 6574 686f 642e 2e2e 2729 0d0a 2020 2020  ethod...')..    
+00045040: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00045050: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
+00045060: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
+00045070: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00045080: 2323 2053 696e 6365 2072 6172 6520 636c  ## Since rare cl
+00045090: 6173 7320 6973 206e 6565 6465 6420 696e  ass is needed in
+000450a0: 2074 6865 206e 6578 7420 7374 6570 2c20   the next step, 
+000450b0: 6a75 7374 2073 6574 7469 6e67 2074 6865  just setting the
+000450c0: 2072 6172 655f 636c 6173 7320 6173 2061   rare_class as a
+000450d0: 7274 6966 6963 6961 6c6c 7920 302e 0d0a  rtificially 0...
+000450e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000450f0: 2020 2020 7261 7265 5f63 6c61 7373 203d      rare_class =
+00045100: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+00045110: 2020 2020 2323 2320 5369 6e63 6520 6974      ### Since it
+00045120: 2069 7320 6120 7369 6e67 6c65 206c 6162   is a single lab
+00045130: 656c 2070 726f 626c 656d 2c20 7765 2075  el problem, we u
+00045140: 7365 2065 6163 685f 7461 7267 6574 2069  se each_target i
+00045150: 6e73 7465 6164 206f 6620 7461 7267 6574  nstead of target
+00045160: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00045170: 2020 2323 2320 2020 416c 736f 2064 6f20    ###   Also do 
+00045180: 6e6f 7420 7573 6520 7468 6520 4772 6964  not use the Grid
+00045190: 5365 6172 6368 4356 206d 6f64 656c 2047  SearchCV model G
+000451a0: 5320 6865 7265 2073 696e 6365 2053 4d4f  S here since SMO
+000451b0: 5445 2063 616e 6e6f 7420 776f 726b 2077  TE cannot work w
+000451c0: 6974 6820 6974 0d0a 2020 2020 2020 2020  ith it..        
+000451d0: 2020 2020 2020 2020 2323 2320 7573 6520          ### use 
+000451e0: 7468 6520 6261 7365 206d 6f64 656c 2074  the base model t
+000451f0: 7261 696e 6564 2077 6974 6820 534d 4f54  rained with SMOT
+00045200: 452e 0d0a 2020 2020 2020 2020 2020 2020  E...            
+00045210: 2020 2020 6d6f 6465 6c20 3d20 7472 6169      model = trai
+00045220: 6e69 6e67 5f77 6974 685f 534d 4f54 4528  ning_with_SMOTE(
+00045230: 585f 7472 6169 6e2c 795f 7472 6169 6e2c  X_train,y_train,
+00045240: 6561 6368 5f74 6172 6765 742c 6576 616c  each_target,eval
+00045250: 5f73 6574 2c20 7867 626d 2c0d 0a20 2020  _set, xgbm,..   
+00045260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045280: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00045290: 672c 2065 7661 6c5f 6d65 7472 6963 2c0d  g, eval_metric,.
+000452a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000452b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000452c0: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+000452d0: 652c 206d 6f64 656c 5f6e 616d 652c 2074  e, model_name, t
+000452e0: 7261 696e 696e 673d 5472 7565 2c0d 0a20  raining=True,.. 
+000452f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045310: 2020 2020 2020 6d69 6e6f 7269 7479 5f63        minority_c
+00045320: 6c61 7373 3d72 6172 655f 636c 6173 732c  lass=rare_class,
+00045330: 696d 705f 6361 7473 3d69 6d70 5f63 6174  imp_cats=imp_cat
+00045340: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00045350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045360: 2020 2020 2020 2020 2020 2063 616c 6962             calib
+00045370: 7261 746f 725f 666c 6167 3d63 616c 6962  rator_flag=calib
+00045380: 7261 746f 725f 666c 6167 2c0d 0a20 2020  rator_flag,..   
+00045390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000453a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000453b0: 2020 2020 4750 555f 6578 6973 7473 3d47      GPU_exists=G
+000453c0: 5055 5f65 7869 7374 732c 2070 6172 616d  PU_exists, param
+000453d0: 7320 3d20 6370 755f 7061 7261 6d73 2c0d  s = cpu_params,.
+000453e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000453f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045400: 2020 2020 2020 2020 6d6f 6465 6c5f 6c61          model_la
+00045410: 6265 6c3d 6d6f 6465 6c5f 6c61 6265 6c2c  bel=model_label,
+00045420: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
+00045430: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00045440: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00045450: 2020 2020 2020 2020 7072 696e 7428 2754          print('T
+00045460: 7261 696e 696e 6720 6d6f 6465 6c20 6669  raining model fi
+00045470: 7273 7420 7469 6d65 2077 6974 6820 534d  rst time with SM
+00045480: 4f54 4520 6572 726f 7269 6e67 2e20 436f  OTE erroring. Co
+00045490: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a20  ntinuing...').. 
+000454a0: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+000454b0: 6d62 616c 616e 6365 645f 466c 6167 203d  mbalanced_Flag =
+000454c0: 2020 4661 6c73 650d 0a20 2020 2020 2020    False..       
+000454d0: 2020 2020 2020 2020 2062 6573 745f 7363           best_sc
+000454e0: 6f72 6520 3d20 300d 0a20 2020 2023 2323  ore = 0..    ###
+000454f0: 2323 2323 2323 2020 2049 4d50 4f52 5441  ######   IMPORTA
+00045500: 4e54 2020 2020 494d 504f 5254 414e 5420  NT    IMPORTANT 
+00045510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045530: 2323 2323 230d 0a20 2020 2023 2320 2020  #####..    ##   
+00045540: 5468 6f75 6768 2074 6869 7320 6e65 7874  Though this next
+00045550: 2073 7465 7020 6c6f 6f6b 7320 6c69 6b65   step looks like
+00045560: 2069 7420 6973 2061 2043 6f64 696e 6720   it is a Coding 
+00045570: 4d69 7374 616b 652c 2064 6f6e 2774 2063  Mistake, don't c
+00045580: 6861 6e67 6520 6974 210d 0a20 2020 2023  hange it!..    #
+00045590: 2320 2020 5468 6973 2069 7320 666f 7220  #   This is for 
+000455a0: 6361 7365 2077 6865 6e20 496d 6261 6c61  case when Imbala
+000455b0: 6e63 6564 2077 6974 6820 436c 6173 7369  nced with Classi
+000455c0: 6669 6361 7469 6f6e 2073 7563 6365 6564  fication succeed
+000455d0: 732c 0d0a 2020 2020 2323 2020 2074 6869  s,..    ##   thi
+000455e0: 7320 6e65 7874 2073 7465 7020 6973 2073  s next step is s
+000455f0: 6b69 7070 6564 2023 230d 0a20 2020 2023  kipped ##..    #
+00045600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00045620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00045630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045670: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
-00045680: 2323 2054 6865 206d 6f64 656c 2062 6c6f  ## The model blo
-00045690: 7773 2075 7020 7768 656e 2079 6f75 2075  ws up when you u
-000456a0: 7365 2061 7665 7261 6765 2d70 7265 6369  se average-preci
-000456b0: 7369 6f6e 2069 6e20 4d75 6c74 692d 436c  sion in Multi-Cl
-000456c0: 6173 7365 7320 2d3e 206e 6565 6473 2063  asses -> needs c
-000456d0: 6865 636b 696e 6721 0d0a 2020 2020 0d0a  hecking!..    ..
-000456e0: 2020 2020 6966 206e 6f74 2049 6d62 616c      if not Imbal
-000456f0: 616e 6365 645f 466c 6167 3a0d 0a20 2020  anced_Flag:..   
-00045700: 2020 2020 2023 2323 2320 5468 6973 2069       #### This i
-00045710: 7320 666f 7220 626f 7468 2072 6567 756c  s for both regul
-00045720: 6172 2052 6567 7265 7373 696f 6e20 616e  ar Regression an
-00045730: 6420 7265 6775 6c61 7220 436c 6173 7369  d regular Classi
-00045740: 6669 6361 7469 6f6e 204d 6f64 656c 2054  fication Model T
-00045750: 7261 696e 696e 672e 2049 7420 6973 206e  raining. It is n
-00045760: 6f74 2061 204d 6973 7461 6b65 2023 2323  ot a Mistake ###
-00045770: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00045780: 2020 2020 2323 2320 496e 2063 6173 6520      ### In case 
-00045790: 496d 6261 6c61 6e63 6564 2074 7261 696e  Imbalanced train
-000457a0: 696e 6720 6661 696c 732c 2074 6869 7320  ing fails, this 
-000457b0: 6d65 7468 6f64 2069 7320 616c 736f 2074  method is also t
-000457c0: 7269 6564 2e20 5468 6174 2773 2077 6879  ried. That's why
-000457d0: 2077 6520 7465 7374 2074 6865 2046 6c61   we test the Fla
-000457e0: 6720 6865 7265 2121 2020 2323 2323 2323  g here!!  ######
-000457f0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-00045800: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-00045810: 2020 206d 6f64 656c 203d 2063 6f70 792e     model = copy.
-00045820: 6465 6570 636f 7079 2867 7329 0d0a 2020  deepcopy(gs)..  
-00045830: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00045840: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
-00045850: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
-00045860: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00045870: 426f 6f73 7469 6e67 5f46 6c61 673a 0d0a  Boosting_Flag:..
+00045640: 2323 2323 2323 2323 0d0a 2020 2020 2323  ########..    ##
+00045650: 2320 5468 6520 6d6f 6465 6c20 626c 6f77  # The model blow
+00045660: 7320 7570 2077 6865 6e20 796f 7520 7573  s up when you us
+00045670: 6520 6176 6572 6167 652d 7072 6563 6973  e average-precis
+00045680: 696f 6e20 696e 204d 756c 7469 2d43 6c61  ion in Multi-Cla
+00045690: 7373 6573 202d 3e20 6e65 6564 7320 6368  sses -> needs ch
+000456a0: 6563 6b69 6e67 210d 0a20 2020 200d 0a20  ecking!..    .. 
+000456b0: 2020 2069 6620 6e6f 7420 496d 6261 6c61     if not Imbala
+000456c0: 6e63 6564 5f46 6c61 673a 0d0a 2020 2020  nced_Flag:..    
+000456d0: 2020 2020 2323 2323 2054 6869 7320 6973      #### This is
+000456e0: 2066 6f72 2062 6f74 6820 7265 6775 6c61   for both regula
+000456f0: 7220 5265 6772 6573 7369 6f6e 2061 6e64  r Regression and
+00045700: 2072 6567 756c 6172 2043 6c61 7373 6966   regular Classif
+00045710: 6963 6174 696f 6e20 4d6f 6465 6c20 5472  ication Model Tr
+00045720: 6169 6e69 6e67 2e20 4974 2069 7320 6e6f  aining. It is no
+00045730: 7420 6120 4d69 7374 616b 6520 2323 2323  t a Mistake ####
+00045740: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00045750: 2020 2023 2323 2049 6e20 6361 7365 2049     ### In case I
+00045760: 6d62 616c 616e 6365 6420 7472 6169 6e69  mbalanced traini
+00045770: 6e67 2066 6169 6c73 2c20 7468 6973 206d  ng fails, this m
+00045780: 6574 686f 6420 6973 2061 6c73 6f20 7472  ethod is also tr
+00045790: 6965 642e 2054 6861 7427 7320 7768 7920  ied. That's why 
+000457a0: 7765 2074 6573 7420 7468 6520 466c 6167  we test the Flag
+000457b0: 2068 6572 6521 2120 2023 2323 2323 2323   here!!  #######
+000457c0: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+000457d0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000457e0: 2020 6d6f 6465 6c20 3d20 636f 7079 2e64    model = copy.d
+000457f0: 6565 7063 6f70 7928 6773 290d 0a20 2020  eepcopy(gs)..   
+00045800: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00045810: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00045820: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+00045830: 2020 2020 2020 2020 2020 2020 6966 2042              if B
+00045840: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00045850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045860: 2020 2069 6620 6d6f 6465 6c5f 6e61 6d65     if model_name
+00045870: 203d 3d20 2758 4742 6f6f 7374 273a 0d0a   == 'XGBoost':..
 00045880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045890: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
-000458a0: 6520 3d3d 2027 5847 426f 6f73 7427 3a0d  e == 'XGBoost':.
-000458b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000458c0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-000458d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000458e0: 2020 2020 2020 2020 2020 2069 6620 206d             if  m
-000458f0: 6f64 656c 7479 7065 203d 3d20 274d 756c  odeltype == 'Mul
-00045900: 7469 5f43 6c61 7373 6966 6963 6174 696f  ti_Classificatio
-00045910: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
+00045890: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+000458a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000458b0: 2020 2020 2020 2020 2020 6966 2020 6d6f            if  mo
+000458c0: 6465 6c74 7970 6520 3d3d 2027 4d75 6c74  deltype == 'Mult
+000458d0: 695f 436c 6173 7369 6669 6361 7469 6f6e  i_Classification
+000458e0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+000458f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045900: 2020 2020 6d6f 6465 6c2e 6669 7428 585f      model.fit(X_
+00045910: 7472 6169 6e2c 795f 7472 6169 6e29 0d0a  train,y_train)..
 00045920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045930: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
-00045940: 5f74 7261 696e 2c79 5f74 7261 696e 290d  _train,y_train).
-00045950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045960: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00045970: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00045980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045990: 2020 2020 2323 2323 2053 6574 2074 6865      #### Set the
-000459a0: 2056 6572 626f 7365 2074 6f20 3020 7369   Verbose to 0 si
-000459b0: 6e63 6520 7765 2064 6f6e 2774 2077 616e  nce we don't wan
-000459c0: 7420 746f 6f20 6d75 6368 206f 7574 7075  t too much outpu
-000459d0: 7420 2323 0d0a 2020 2020 2020 2020 2020  t ##..          
-000459e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000459f0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
-00045a00: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-00045a10: 2c20 6561 726c 795f 7374 6f70 7069 6e67  , early_stopping
-00045a20: 5f72 6f75 6e64 733d 6561 726c 795f 7374  _rounds=early_st
-00045a30: 6f70 7069 6e67 2c0d 0a20 2020 2020 2020  opping,..       
-00045a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a60: 2065 7661 6c5f 6d65 7472 6963 3d65 7661   eval_metric=eva
-00045a70: 6c5f 6d65 7472 6963 2c65 7661 6c5f 7365  l_metric,eval_se
-00045a80: 743d 6576 616c 5f73 6574 2c76 6572 626f  t=eval_set,verbo
-00045a90: 7365 3d30 290d 0a20 2020 2020 2020 2020  se=0)..         
-00045aa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00045ab0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00045ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ad0: 2020 2020 2323 2323 204f 6e20 436f 6c61      #### On Cola
-00045ae0: 622c 2065 7665 6e20 7468 6f75 6768 2047  b, even though G
-00045af0: 5055 2065 7869 7374 732c 206d 616e 7920  PU exists, many 
-00045b00: 7065 6f70 6c65 2064 6f6e 2774 2074 7572  people don't tur
-00045b10: 6e20 6974 206f 6e2e 0d0a 2020 2020 2020  n it on...      
-00045b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b30: 2020 2020 2020 2323 2323 2020 496e 2074        ####  In t
-00045b40: 6861 7420 6361 7365 2c20 5847 426f 6f73  hat case, XGBoos
-00045b50: 7420 626c 6f77 7320 7570 2077 6865 6e20  t blows up when 
-00045b60: 6770 755f 7072 6564 6963 746f 7220 6973  gpu_predictor is
-00045b70: 2075 7365 642e 0d0a 2020 2020 2020 2020   used...        
-00045b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b90: 2020 2020 2323 2323 2020 5468 6973 2069      ####  This i
-00045ba0: 7320 746f 2074 7572 6e20 6974 2062 6163  s to turn it bac
-00045bb0: 6b20 746f 2063 7075 5f70 7265 6469 6374  k to cpu_predict
-00045bc0: 6f72 2069 6e20 6361 7365 2047 5055 2065  or in case GPU e
-00045bd0: 7272 6f72 7321 0d0a 2020 2020 2020 2020  rrors!..        
+00045930: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00045940: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00045950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045960: 2020 2023 2323 2320 5365 7420 7468 6520     #### Set the 
+00045970: 5665 7262 6f73 6520 746f 2030 2073 696e  Verbose to 0 sin
+00045980: 6365 2077 6520 646f 6e27 7420 7761 6e74  ce we don't want
+00045990: 2074 6f6f 206d 7563 6820 6f75 7470 7574   too much output
+000459a0: 2023 230d 0a20 2020 2020 2020 2020 2020   ##..           
+000459b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000459c0: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
+000459d0: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+000459e0: 2065 6172 6c79 5f73 746f 7070 696e 675f   early_stopping_
+000459f0: 726f 756e 6473 3d65 6172 6c79 5f73 746f  rounds=early_sto
+00045a00: 7070 696e 672c 0d0a 2020 2020 2020 2020  pping,..        
+00045a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045a30: 6576 616c 5f6d 6574 7269 633d 6576 616c  eval_metric=eval
+00045a40: 5f6d 6574 7269 632c 6576 616c 5f73 6574  _metric,eval_set
+00045a50: 3d65 7661 6c5f 7365 742c 7665 7262 6f73  =eval_set,verbos
+00045a60: 653d 3029 0d0a 2020 2020 2020 2020 2020  e=0)..          
+00045a70: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00045a80: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00045a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045aa0: 2020 2023 2323 2320 4f6e 2043 6f6c 6162     #### On Colab
+00045ab0: 2c20 6576 656e 2074 686f 7567 6820 4750  , even though GP
+00045ac0: 5520 6578 6973 7473 2c20 6d61 6e79 2070  U exists, many p
+00045ad0: 656f 706c 6520 646f 6e27 7420 7475 726e  eople don't turn
+00045ae0: 2069 7420 6f6e 2e0d 0a20 2020 2020 2020   it on...       
+00045af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045b00: 2020 2020 2023 2323 2320 2049 6e20 7468       ####  In th
+00045b10: 6174 2063 6173 652c 2058 4742 6f6f 7374  at case, XGBoost
+00045b20: 2062 6c6f 7773 2075 7020 7768 656e 2067   blows up when g
+00045b30: 7075 5f70 7265 6469 6374 6f72 2069 7320  pu_predictor is 
+00045b40: 7573 6564 2e0d 0a20 2020 2020 2020 2020  used...         
+00045b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045b60: 2020 2023 2323 2320 2054 6869 7320 6973     ####  This is
+00045b70: 2074 6f20 7475 726e 2069 7420 6261 636b   to turn it back
+00045b80: 2074 6f20 6370 755f 7072 6564 6963 746f   to cpu_predicto
+00045b90: 7220 696e 2063 6173 6520 4750 5520 6572  r in case GPU er
+00045ba0: 726f 7273 210d 0a20 2020 2020 2020 2020  rors!..         
+00045bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045bc0: 2020 2069 6620 4750 555f 6578 6973 7473     if GPU_exists
+00045bd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
 00045be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045bf0: 2020 2020 6966 2047 5055 5f65 7869 7374      if GPU_exist
-00045c00: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00045c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c20: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
-00045c30: 3a20 4750 5520 6578 6973 7473 2062 7574  : GPU exists but
-00045c40: 2069 7420 6973 206e 6f74 2074 7572 6e65   it is not turne
-00045c50: 6420 6f6e 2e20 5573 696e 6720 4350 5520  d on. Using CPU 
-00045c60: 666f 7220 7072 6564 6963 7469 6f6e 732e  for predictions.
-00045c70: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-00045c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c90: 2020 2020 2020 6d6f 6465 6c2e 6573 7469        model.esti
-00045ca0: 6d61 746f 722e 7365 745f 7061 7261 6d73  mator.set_params
-00045cb0: 282a 2a63 7075 5f70 6172 616d 7329 0d0a  (**cpu_params)..
-00045cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ce0: 6966 2020 6d6f 6465 6c74 7970 6520 3d3d  if  modeltype ==
-00045cf0: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
-00045d00: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
-00045d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d20: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00045d30: 6465 6c2e 6669 7428 585f 7472 6169 6e2c  del.fit(X_train,
-00045d40: 795f 7472 6169 6e29 0d0a 2020 2020 2020  y_train)..      
+00045bf0: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
+00045c00: 2047 5055 2065 7869 7374 7320 6275 7420   GPU exists but 
+00045c10: 6974 2069 7320 6e6f 7420 7475 726e 6564  it is not turned
+00045c20: 206f 6e2e 2055 7369 6e67 2043 5055 2066   on. Using CPU f
+00045c30: 6f72 2070 7265 6469 6374 696f 6e73 2e2e  or predictions..
+00045c40: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+00045c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045c60: 2020 2020 206d 6f64 656c 2e65 7374 696d       model.estim
+00045c70: 6174 6f72 2e73 6574 5f70 6172 616d 7328  ator.set_params(
+00045c80: 2a2a 6370 755f 7061 7261 6d73 290d 0a20  **cpu_params).. 
+00045c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045ca0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00045cb0: 6620 206d 6f64 656c 7479 7065 203d 3d20  f  modeltype == 
+00045cc0: 274d 756c 7469 5f43 6c61 7373 6966 6963  'Multi_Classific
+00045cd0: 6174 696f 6e27 3a0d 0a20 2020 2020 2020  ation':..       
+00045ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045cf0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+00045d00: 656c 2e66 6974 2858 5f74 7261 696e 2c79  el.fit(X_train,y
+00045d10: 5f74 7261 696e 290d 0a20 2020 2020 2020  _train)..       
+00045d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045d30: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00045d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00045d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d60: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00045d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d90: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
-00045da0: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
-00045db0: 6561 726c 795f 7374 6f70 7069 6e67 5f72  early_stopping_r
-00045dc0: 6f75 6e64 733d 6561 726c 795f 7374 6f70  ounds=early_stop
-00045dd0: 7069 6e67 2c0d 0a20 2020 2020 2020 2020  ping,..         
-00045de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045df0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00045e00: 7661 6c5f 6d65 7472 6963 3d65 7661 6c5f  val_metric=eval_
-00045e10: 6d65 7472 6963 2c65 7661 6c5f 7365 743d  metric,eval_set=
-00045e20: 6576 616c 5f73 6574 2c76 6572 626f 7365  eval_set,verbose
-00045e30: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-00045e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00045e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e70: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00045e80: 6c2e 6669 7428 585f 7472 6169 6e2c 795f  l.fit(X_train,y_
-00045e90: 7472 6169 6e29 0d0a 2020 2020 2020 2020  train)..        
-00045ea0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00045eb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00045ec0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-00045ed0: 2054 6869 7320 6973 2066 6f72 2043 6174   This is for Cat
-00045ee0: 626f 6f73 7420 2323 2323 2323 2323 2323  boost ##########
-00045ef0: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-00045f00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00045f10: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-00045f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f30: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
-00045f40: 696e 2c20 795f 7472 6169 6e2c 2063 6174  in, y_train, cat
-00045f50: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
-00045f60: 7473 2c0d 0a20 2020 2020 2020 2020 2020  ts,..           
-00045f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f80: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-00045f90: 6c5f 7365 743d 2858 5f63 762c 795f 6376  l_set=(X_cv,y_cv
-00045fa0: 292c 2075 7365 5f62 6573 745f 6d6f 6465  ), use_best_mode
-00045fb0: 6c3d 5472 7565 2c20 706c 6f74 3d54 7275  l=True, plot=Tru
-00045fc0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00045fd0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00045fe0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00045ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046000: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
-00046010: 696e 2c20 795f 7472 6169 6e2c 2063 6174  in, y_train, cat
-00046020: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
-00046030: 7473 2c20 7573 655f 6265 7374 5f6d 6f64  ts, use_best_mod
-00046040: 656c 3d46 616c 7365 2c20 706c 6f74 3d46  el=False, plot=F
-00046050: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-00046060: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00046070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046080: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
-00046090: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
-000460a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000460b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000460c0: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
-000460d0: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
-000460e0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-000460f0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00046100: 7428 2754 7261 696e 696e 6720 7265 6775  t('Training regu
-00046110: 6c61 7220 6d6f 6465 6c20 6669 7273 7420  lar model first 
-00046120: 7469 6d65 2069 7320 4572 726f 7269 6e67  time is Erroring
-00046130: 3a20 4368 6563 6b20 6966 2079 6f75 7220  : Check if your 
-00046140: 496e 7075 7420 6973 2063 6f72 7265 6374  Input is correct
-00046150: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
-00046160: 2020 2072 6574 7572 6e0d 0a20 2020 2065     return..    e
-00046170: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
-00046180: 2323 2054 6869 7320 6973 2066 6f72 2049  ## This is for I
-00046190: 6d62 616c 616e 6365 6420 5472 6169 6e69  mbalanced Traini
-000461a0: 6e67 2066 6f72 204d 756c 7469 2d4c 6162  ng for Multi-Lab
-000461b0: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
-000461c0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
-000461d0: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-000461e0: 274d 756c 7469 5f4c 6162 656c 273a 0d0a  'Multi_Label':..
-000461f0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00046200: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
-00046210: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
-00046220: 2020 2020 2020 2020 2020 2023 2323 2053             ### S
-00046230: 696e 6365 2072 6172 6520 636c 6173 7320  ince rare class 
-00046240: 6973 206e 6565 6465 6420 696e 2074 6865  is needed in the
-00046250: 206e 6578 7420 7374 6570 2c20 6a75 7374   next step, just
-00046260: 2073 6574 7469 6e67 2074 6865 2072 6172   setting the rar
-00046270: 655f 636c 6173 7320 6173 2061 7274 6966  e_class as artif
-00046280: 6963 6961 6c6c 7920 302e 0d0a 2020 2020  icially 0...    
-00046290: 2020 2020 2020 2020 2020 2020 7261 7265              rare
-000462a0: 5f63 6c61 7373 203d 2030 0d0a 2020 2020  _class = 0..    
-000462b0: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
-000462c0: 7472 6169 6e69 6e67 5f77 6974 685f 534d  training_with_SM
-000462d0: 4f54 4528 585f 7472 6169 6e2c 795f 7472  OTE(X_train,y_tr
-000462e0: 6169 6e2c 6561 6368 5f74 6172 6765 742c  ain,each_target,
-000462f0: 6576 616c 5f73 6574 2c20 7867 626d 2c0d  eval_set, xgbm,.
-00046300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046320: 2020 2020 2020 2020 2020 2020 426f 6f73              Boos
-00046330: 7469 6e67 5f46 6c61 672c 2065 7661 6c5f  ting_Flag, eval_
-00046340: 6d65 7472 6963 2c0d 0a20 2020 2020 2020  metric,..       
-00046350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046370: 2020 2020 6d6f 6465 6c74 7970 652c 206d      modeltype, m
-00046380: 6f64 656c 5f6e 616d 652c 2074 7261 696e  odel_name, train
-00046390: 696e 673d 5472 7565 2c0d 0a20 2020 2020  ing=True,..     
-000463a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000463b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000463c0: 2020 2020 2020 6d69 6e6f 7269 7479 5f63        minority_c
-000463d0: 6c61 7373 3d72 6172 655f 636c 6173 732c  lass=rare_class,
-000463e0: 696d 705f 6361 7473 3d69 6d70 5f63 6174  imp_cats=imp_cat
-000463f0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-00046400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046410: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00046420: 616c 6962 7261 746f 725f 666c 6167 3d63  alibrator_flag=c
-00046430: 616c 6962 7261 746f 725f 666c 6167 2c0d  alibrator_flag,.
-00046440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046460: 2020 2020 2020 2020 2020 2020 4750 555f              GPU_
-00046470: 6578 6973 7473 3d47 5055 5f65 7869 7374  exists=GPU_exist
-00046480: 732c 2070 6172 616d 7320 3d20 6370 755f  s, params = cpu_
-00046490: 7061 7261 6d73 2c0d 0a20 2020 2020 2020  params,..       
-000464a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000464b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000464c0: 2020 2020 6d6f 6465 6c5f 6c61 6265 6c3d      model_label=
-000464d0: 6d6f 6465 6c5f 6c61 6265 6c2c 2076 6572  model_label, ver
-000464e0: 626f 7365 3d76 6572 626f 7365 290d 0a20  bose=verbose).. 
-000464f0: 2020 2023 2323 2323 2323 2323 2323 2020     ###########  
-00046500: 2046 4952 5354 2054 494d 4520 4d4f 4445   FIRST TIME MODE
-00046510: 4c20 5452 4149 4e49 4e47 2043 4f4d 504c  L TRAINING COMPL
-00046520: 4554 4544 2023 2323 2323 2323 2323 2323  ETED ###########
-00046530: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00046540: 0a20 2020 2023 2320 2020 5452 4149 4e49  .    ##   TRAINI
-00046550: 4e47 204f 4620 4d4f 4445 4c53 2043 4f4d  NG OF MODELS COM
-00046560: 504c 4554 4544 2e20 4e4f 5720 4745 5420  PLETED. NOW GET 
-00046570: 4d45 5452 4943 5320 6f6e 2043 5620 4441  METRICS on CV DA
-00046580: 5441 2023 2323 2323 2323 2323 2323 2323  TA #############
-00046590: 2323 0d0a 2020 2020 7072 696e 7428 2720  ##..    print(' 
-000465a0: 2020 2041 6374 7561 6c20 7472 6169 6e69     Actual traini
-000465b0: 6e67 2074 696d 6520 2869 6e20 7365 636f  ng time (in seco
-000465c0: 6e64 7329 3a20 2530 2e30 6627 2025 2874  nds): %0.0f' %(t
-000465d0: 696d 652e 7469 6d65 2829 2d6d 6f64 656c  ime.time()-model
-000465e0: 5f73 7461 7274 5f74 696d 6529 290d 0a20  _start_time)).. 
-000465f0: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
-00046600: 2323 2323 2320 2025 7320 204d 204f 2044  #####  %s  M O D
-00046610: 2045 204c 2020 2052 2045 2053 2055 204c   E L   R E S U L
-00046620: 2054 2053 2023 2323 2323 2323 2323 2323   T S ###########
-00046630: 2323 2323 2323 2720 256d 6f64 656c 5f6c  ######' %model_l
-00046640: 6162 656c 290d 0a20 2020 2074 7279 3a0d  abel)..    try:.
-00046650: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-00046660: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00046670: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-00046680: 2020 2020 2020 2020 6966 2068 7970 6572          if hyper
-00046690: 5f70 6172 616d 203d 3d20 2752 5327 206f  _param == 'RS' o
-000466a0: 7220 6879 7065 725f 7061 7261 6d20 3d3d  r hyper_param ==
-000466b0: 2027 4753 273a 0d0a 2020 2020 2020 2020   'GS':..        
-000466c0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-000466d0: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
-000466e0: 696f 6e27 2061 6e64 2049 6d62 616c 616e  ion' and Imbalan
-000466f0: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
-00046700: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00046710: 2323 2049 6620 796f 7520 7573 6520 534d  ## If you use SM
-00046720: 4f54 452c 2074 6865 6e20 6e6f 2047 7269  OTE, then no Gri
-00046730: 6453 6561 7263 6843 5620 6973 2064 6f6e  dSearchCV is don
-00046740: 652e 2048 656e 6365 206e 6f20 6265 7374  e. Hence no best
-00046750: 5f73 636f 7265 5f0d 0a20 2020 2020 2020  _score_..       
-00046760: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-00046770: 745f 7363 6f72 6520 3d20 300d 0a20 2020  t_score = 0..   
-00046780: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00046790: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000467a0: 2020 2020 2020 2020 6265 7374 5f73 636f          best_sco
-000467b0: 7265 203d 206d 6f64 656c 2e62 6573 745f  re = model.best_
-000467c0: 7363 6f72 655f 0d0a 2020 2020 2020 2020  score_..        
-000467d0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-000467e0: 6461 7469 6f6e 5f6d 6574 7269 6320 3d20  dation_metric = 
-000467f0: 636f 7079 2e64 6565 7063 6f70 7928 7363  copy.deepcopy(sc
-00046800: 6f72 696e 675f 7061 7261 6d65 7465 7229  oring_parameter)
-00046810: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00046820: 6966 2068 7970 6572 5f70 6172 616d 2069  if hyper_param i
-00046830: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-00046840: 2020 2020 2020 2020 2076 616c 5f6b 6579           val_key
-00046850: 7320 3d20 6c69 7374 286d 6f64 656c 2e62  s = list(model.b
-00046860: 6573 745f 7363 6f72 655f 2e6b 6579 7328  est_score_.keys(
-00046870: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00046880: 2020 2020 6966 2027 7661 6c69 6461 7469      if 'validati
-00046890: 6f6e 2720 696e 2076 616c 5f6b 6579 733a  on' in val_keys:
-000468a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000468b0: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
-000468c0: 5f6d 6574 7269 6320 3d20 6c69 7374 286d  _metric = list(m
-000468d0: 6f64 656c 2e62 6573 745f 7363 6f72 655f  odel.best_score_
-000468e0: 5b27 7661 6c69 6461 7469 6f6e 275d 2e6b  ['validation'].k
-000468f0: 6579 7328 2929 5b30 5d0d 0a20 2020 2020  eys())[0]..     
-00046900: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00046910: 6573 745f 7363 6f72 6520 3d20 6d6f 6465  est_score = mode
-00046920: 6c2e 6265 7374 5f73 636f 7265 5f5b 2776  l.best_score_['v
-00046930: 616c 6964 6174 696f 6e27 5d5b 7661 6c69  alidation'][vali
-00046940: 6461 7469 6f6e 5f6d 6574 7269 635d 0d0a  dation_metric]..
-00046950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046960: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00046970: 2020 2020 2020 2020 2020 2076 616c 6964             valid
-00046980: 6174 696f 6e5f 6d65 7472 6963 203d 206c  ation_metric = l
-00046990: 6973 7428 6d6f 6465 6c2e 6265 7374 5f73  ist(model.best_s
-000469a0: 636f 7265 5f5b 276c 6561 726e 275d 2e6b  core_['learn'].k
-000469b0: 6579 7328 2929 5b30 5d0d 0a20 2020 2020  eys())[0]..     
-000469c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-000469d0: 6573 745f 7363 6f72 6520 3d20 6d6f 6465  est_score = mode
-000469e0: 6c2e 6265 7374 5f73 636f 7265 5f5b 276c  l.best_score_['l
-000469f0: 6561 726e 275d 5b76 616c 6964 6174 696f  earn'][validatio
-00046a00: 6e5f 6d65 7472 6963 5d0d 0a20 2020 2020  n_metric]..     
-00046a10: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00046a20: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00046a30: 2054 6869 7320 6170 706c 6965 7320 6f6e   This applies on
-00046a40: 6c79 2074 6f20 5350 4520 636c 6173 7369  ly to SPE classi
-00046a50: 6669 6572 2023 2323 2323 2323 230d 0a20  fier ########.. 
-00046a60: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00046a70: 616c 6964 6174 696f 6e5f 6d65 7472 6963  alidation_metric
-00046a80: 203d 2027 4261 6c61 6e63 6564 2041 6363   = 'Balanced Acc
-00046a90: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
-00046aa0: 2020 2020 2020 2020 6265 7374 5f73 636f          best_sco
-00046ab0: 7265 203d 2062 616c 616e 6365 645f 6163  re = balanced_ac
-00046ac0: 6375 7261 6379 5f73 636f 7265 2879 5f63  curacy_score(y_c
-00046ad0: 762c 206d 6f64 656c 2e70 7265 6469 6374  v, model.predict
-00046ae0: 2858 5f63 7629 290d 0a20 2020 2065 7863  (X_cv))..    exc
-00046af0: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
-00046b00: 696e 7428 2745 7272 6f72 3a20 4e6f 7420  int('Error: Not 
-00046b10: 6162 6c65 2074 6f20 7072 696e 7420 7661  able to print va
-00046b20: 6c69 6461 7469 6f6e 206d 6574 7269 6373  lidation metrics
-00046b30: 2e20 436f 6e74 696e 7569 6e67 2e2e 2e27  . Continuing...'
-00046b40: 290d 0a20 2020 2020 2020 2062 6573 745f  )..        best_
-00046b50: 7363 6f72 6520 3d20 300d 0a20 2020 2069  score = 0..    i
-00046b60: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-00046b70: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
-00046b80: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
-00046b90: 656c 7479 7065 2021 3d20 2752 6567 7265  eltype != 'Regre
-00046ba0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
-00046bb0: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00046bc0: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
-00046bd0: 436c 6173 7369 6669 6361 7469 6f6e 204f  Classification O
-00046be0: 6e6c 7920 2121 2023 2323 2323 2323 2323  nly !! #########
-00046bf0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00046c00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00046c10: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00046c20: 7220 696e 205b 276c 6f67 6c6f 7373 272c  r in ['logloss',
-00046c30: 276e 6567 5f6c 6f67 5f6c 6f73 7327 2c27  'neg_log_loss','
-00046c40: 6c6f 675f 6c6f 7373 272c 276c 6f67 2d6c  log_loss','log-l
-00046c50: 6f73 7327 2c27 275d 3a0d 0a20 2020 2020  oss','']:..     
-00046c60: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00046c70: 2827 7b7d 2d66 6f6c 6420 4372 6f73 7320  ('{}-fold Cross 
-00046c80: 5661 6c69 6461 7469 6f6e 207b 7d20 3d20  Validation {} = 
-00046c90: 7b7d 272e 666f 726d 6174 286e 5f73 706c  {}'.format(n_spl
-00046ca0: 6974 732c 2027 6c6f 676c 6f73 7327 2c20  its, 'logloss', 
-00046cb0: 6265 7374 5f73 636f 7265 2929 0d0a 2020  best_score))..  
-00046cc0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00046cd0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-00046ce0: 2069 6e20 5b27 6163 6375 7261 6379 272c   in ['accuracy',
-00046cf0: 2762 616c 616e 6365 642d 6163 6375 7261  'balanced-accura
-00046d00: 6379 272c 2762 616c 616e 6365 645f 6163  cy','balanced_ac
-00046d10: 6375 7261 6379 272c 2772 6f63 5f61 7563  curacy','roc_auc
-00046d20: 272c 2772 6f63 2d61 7563 272c 0d0a 2020  ','roc-auc',..  
-00046d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046d50: 2020 2020 2027 6631 272c 2770 7265 6369       'f1','preci
-00046d60: 7369 6f6e 272c 2772 6563 616c 6c27 2c27  sion','recall','
-00046d70: 6176 6572 6167 652d 7072 6563 6973 696f  average-precisio
-00046d80: 6e27 2c27 6176 6572 6167 655f 7072 6563  n','average_prec
-00046d90: 6973 696f 6e27 2c0d 0a20 2020 2020 2020  ision',..       
-00046da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046db0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00046dc0: 7765 6967 6874 6564 5f66 3127 2c27 7765  weighted_f1','we
-00046dd0: 6967 6874 6564 2d66 3127 2c27 4155 4327  ighted-f1','AUC'
-00046de0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-00046df0: 2020 2020 7072 696e 7428 2725 642d 666f      print('%d-fo
-00046e00: 6c64 2043 726f 7373 2056 616c 6964 6174  ld Cross Validat
-00046e10: 696f 6e20 2025 7320 3d20 2530 2e31 6625  ion  %s = %0.1f%
-00046e20: 2527 2025 286e 5f73 706c 6974 732c 7363  %' %(n_splits,sc
-00046e30: 6f72 696e 675f 7061 7261 6d65 7465 722c  oring_parameter,
-00046e40: 2062 6573 745f 7363 6f72 652a 3130 3029   best_score*100)
-00046e50: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00046e60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00046e70: 2020 2020 2020 7072 696e 7428 2725 642d        print('%d-
-00046e80: 666f 6c64 2043 726f 7373 2056 616c 6964  fold Cross Valid
-00046e90: 6174 696f 6e20 2025 7320 3d20 2530 2e31  ation  %s = %0.1
-00046ea0: 6627 2025 286e 5f73 706c 6974 732c 7661  f' %(n_splits,va
-00046eb0: 6c69 6461 7469 6f6e 5f6d 6574 7269 632c  lidation_metric,
-00046ec0: 2062 6573 745f 7363 6f72 6529 290d 0a20   best_score)).. 
-00046ed0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00046ee0: 2020 2020 2020 2020 2020 2323 2323 2323            ######
-00046ef0: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
-00046f00: 5265 6772 6573 7369 6f6e 206f 6e6c 7920  Regression only 
-00046f10: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00046f20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00046f30: 6265 7374 5f73 636f 7265 203c 2030 3a0d  best_score < 0:.
-00046f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046f50: 2062 6573 745f 7363 6f72 6520 3d20 6265   best_score = be
-00046f60: 7374 5f73 636f 7265 2a2d 310d 0a20 2020  st_score*-1..   
-00046f70: 2020 2020 2020 2020 2069 6620 7363 6f72           if scor
-00046f80: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-00046f90: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
-00046fa0: 2020 2020 2020 7072 696e 7428 2725 642d        print('%d-
-00046fb0: 666f 6c64 2043 726f 7373 2056 616c 6964  fold Cross Valid
-00046fc0: 6174 696f 6e20 2573 2053 636f 7265 203d  ation %s Score =
-00046fd0: 2025 302e 3466 2720 2528 6e5f 7370 6c69   %0.4f' %(n_spli
-00046fe0: 7473 2c27 524d 5345 272c 2062 6573 745f  ts,'RMSE', best_
-00046ff0: 7363 6f72 6529 290d 0a20 2020 2020 2020  score))..       
-00047000: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00047010: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00047020: 7428 2725 642d 666f 6c64 2043 726f 7373  t('%d-fold Cross
-00047030: 2056 616c 6964 6174 696f 6e20 2573 2053   Validation %s S
-00047040: 636f 7265 203d 2025 302e 3466 2720 2528  core = %0.4f' %(
-00047050: 6e5f 7370 6c69 7473 2c76 616c 6964 6174  n_splits,validat
-00047060: 696f 6e5f 6d65 7472 6963 2c20 6265 7374  ion_metric, best
+00045d60: 2020 2020 6d6f 6465 6c2e 6669 7428 585f      model.fit(X_
+00045d70: 7472 6169 6e2c 795f 7472 6169 6e2c 2065  train,y_train, e
+00045d80: 6172 6c79 5f73 746f 7070 696e 675f 726f  arly_stopping_ro
+00045d90: 756e 6473 3d65 6172 6c79 5f73 746f 7070  unds=early_stopp
+00045da0: 696e 672c 0d0a 2020 2020 2020 2020 2020  ing,..          
+00045db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045dc0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00045dd0: 616c 5f6d 6574 7269 633d 6576 616c 5f6d  al_metric=eval_m
+00045de0: 6574 7269 632c 6576 616c 5f73 6574 3d65  etric,eval_set=e
+00045df0: 7661 6c5f 7365 742c 7665 7262 6f73 653d  val_set,verbose=
+00045e00: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+00045e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045e20: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00045e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045e40: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00045e50: 2e66 6974 2858 5f74 7261 696e 2c79 5f74  .fit(X_train,y_t
+00045e60: 7261 696e 290d 0a20 2020 2020 2020 2020  rain)..         
+00045e70: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00045e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00045e90: 2020 2020 2020 2020 2020 2323 2323 2320            ##### 
+00045ea0: 5468 6973 2069 7320 666f 7220 4361 7462  This is for Catb
+00045eb0: 6f6f 7374 2023 2323 2323 2323 2323 2323  oost ###########
+00045ec0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00045ed0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00045ee0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00045ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f00: 6d6f 6465 6c2e 6669 7428 585f 7472 6169  model.fit(X_trai
+00045f10: 6e2c 2079 5f74 7261 696e 2c20 6361 745f  n, y_train, cat_
+00045f20: 6665 6174 7572 6573 3d69 6d70 5f63 6174  features=imp_cat
+00045f30: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00045f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f50: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+00045f60: 5f73 6574 3d28 585f 6376 2c79 5f63 7629  _set=(X_cv,y_cv)
+00045f70: 2c20 7573 655f 6265 7374 5f6d 6f64 656c  , use_best_model
+00045f80: 3d54 7275 652c 2070 6c6f 743d 5472 7565  =True, plot=True
+00045f90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00045fa0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00045fb0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00045fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045fd0: 6d6f 6465 6c2e 6669 7428 585f 7472 6169  model.fit(X_trai
+00045fe0: 6e2c 2079 5f74 7261 696e 2c20 6361 745f  n, y_train, cat_
+00045ff0: 6665 6174 7572 6573 3d69 6d70 5f63 6174  features=imp_cat
+00046000: 732c 2075 7365 5f62 6573 745f 6d6f 6465  s, use_best_mode
+00046010: 6c3d 4661 6c73 652c 2070 6c6f 743d 4661  l=False, plot=Fa
+00046020: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
+00046030: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00046040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046050: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
+00046060: 696e 2c20 795f 7472 6169 6e29 0d0a 2020  in, y_train)..  
+00046070: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00046080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00046090: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
+000460a0: 696e 2c20 795f 7472 6169 6e29 0d0a 2020  in, y_train)..  
+000460b0: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+000460c0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000460d0: 2827 5472 6169 6e69 6e67 2072 6567 756c  ('Training regul
+000460e0: 6172 206d 6f64 656c 2066 6972 7374 2074  ar model first t
+000460f0: 696d 6520 6973 2045 7272 6f72 696e 673a  ime is Erroring:
+00046100: 2043 6865 636b 2069 6620 796f 7572 2049   Check if your I
+00046110: 6e70 7574 2069 7320 636f 7272 6563 742e  nput is correct.
+00046120: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
+00046130: 2020 7265 7475 726e 0d0a 2020 2020 656c    return..    el
+00046140: 7365 3a0d 0a20 2020 2020 2020 2023 2323  se:..        ###
+00046150: 2320 5468 6973 2069 7320 666f 7220 496d  # This is for Im
+00046160: 6261 6c61 6e63 6564 2054 7261 696e 696e  balanced Trainin
+00046170: 6720 666f 7220 4d75 6c74 692d 4c61 6265  g for Multi-Labe
+00046180: 6c20 7072 6f62 6c65 6d73 2023 2323 2323  l problems #####
+00046190: 2323 230d 0a20 2020 2020 2020 2069 6620  ###..        if 
+000461a0: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
+000461b0: 4d75 6c74 695f 4c61 6265 6c27 3a0d 0a20  Multi_Label':.. 
+000461c0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+000461d0: 6465 6c74 7970 6520 3d3d 2027 5265 6772  deltype == 'Regr
+000461e0: 6573 7369 6f6e 273a 0d0a 2020 2020 2020  ession':..      
+000461f0: 2020 2020 2020 2020 2020 2323 2320 5369            ### Si
+00046200: 6e63 6520 7261 7265 2063 6c61 7373 2069  nce rare class i
+00046210: 7320 6e65 6564 6564 2069 6e20 7468 6520  s needed in the 
+00046220: 6e65 7874 2073 7465 702c 206a 7573 7420  next step, just 
+00046230: 7365 7474 696e 6720 7468 6520 7261 7265  setting the rare
+00046240: 5f63 6c61 7373 2061 7320 6172 7469 6669  _class as artifi
+00046250: 6369 616c 6c79 2030 2e0d 0a20 2020 2020  cially 0...     
+00046260: 2020 2020 2020 2020 2020 2072 6172 655f             rare_
+00046270: 636c 6173 7320 3d20 300d 0a20 2020 2020  class = 0..     
+00046280: 2020 2020 2020 206d 6f64 656c 203d 2074         model = t
+00046290: 7261 696e 696e 675f 7769 7468 5f53 4d4f  raining_with_SMO
+000462a0: 5445 2858 5f74 7261 696e 2c79 5f74 7261  TE(X_train,y_tra
+000462b0: 696e 2c65 6163 685f 7461 7267 6574 2c65  in,each_target,e
+000462c0: 7661 6c5f 7365 742c 2078 6762 6d2c 0d0a  val_set, xgbm,..
+000462d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000462e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000462f0: 2020 2020 2020 2020 2020 2042 6f6f 7374             Boost
+00046300: 696e 675f 466c 6167 2c20 6576 616c 5f6d  ing_Flag, eval_m
+00046310: 6574 7269 632c 0d0a 2020 2020 2020 2020  etric,..        
+00046320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046340: 2020 206d 6f64 656c 7479 7065 2c20 6d6f     modeltype, mo
+00046350: 6465 6c5f 6e61 6d65 2c20 7472 6169 6e69  del_name, traini
+00046360: 6e67 3d54 7275 652c 0d0a 2020 2020 2020  ng=True,..      
+00046370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046390: 2020 2020 206d 696e 6f72 6974 795f 636c       minority_cl
+000463a0: 6173 733d 7261 7265 5f63 6c61 7373 2c69  ass=rare_class,i
+000463b0: 6d70 5f63 6174 733d 696d 705f 6361 7473  mp_cats=imp_cats
+000463c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000463d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000463e0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+000463f0: 6c69 6272 6174 6f72 5f66 6c61 673d 6361  librator_flag=ca
+00046400: 6c69 6272 6174 6f72 5f66 6c61 672c 0d0a  librator_flag,..
+00046410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046430: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
+00046440: 7869 7374 733d 4750 555f 6578 6973 7473  xists=GPU_exists
+00046450: 2c20 7061 7261 6d73 203d 2063 7075 5f70  , params = cpu_p
+00046460: 6172 616d 732c 0d0a 2020 2020 2020 2020  arams,..        
+00046470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046490: 2020 206d 6f64 656c 5f6c 6162 656c 3d6d     model_label=m
+000464a0: 6f64 656c 5f6c 6162 656c 2c20 7665 7262  odel_label, verb
+000464b0: 6f73 653d 7665 7262 6f73 6529 0d0a 2020  ose=verbose)..  
+000464c0: 2020 2323 2323 2323 2323 2323 2320 2020    ###########   
+000464d0: 4649 5253 5420 5449 4d45 204d 4f44 454c  FIRST TIME MODEL
+000464e0: 2054 5241 494e 494e 4720 434f 4d50 4c45   TRAINING COMPLE
+000464f0: 5445 4420 2323 2323 2323 2323 2323 2323  TED ############
+00046500: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00046510: 2020 2020 2323 2020 2054 5241 494e 494e      ##   TRAININ
+00046520: 4720 4f46 204d 4f44 454c 5320 434f 4d50  G OF MODELS COMP
+00046530: 4c45 5445 442e 204e 4f57 2047 4554 204d  LETED. NOW GET M
+00046540: 4554 5249 4353 206f 6e20 4356 2044 4154  ETRICS on CV DAT
+00046550: 4120 2323 2323 2323 2323 2323 2323 2323  A ##############
+00046560: 230d 0a20 2020 2070 7269 6e74 2827 2020  #..    print('  
+00046570: 2020 4163 7475 616c 2074 7261 696e 696e    Actual trainin
+00046580: 6720 7469 6d65 2028 696e 2073 6563 6f6e  g time (in secon
+00046590: 6473 293a 2025 302e 3066 2720 2528 7469  ds): %0.0f' %(ti
+000465a0: 6d65 2e74 696d 6528 292d 6d6f 6465 6c5f  me.time()-model_
+000465b0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
+000465c0: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+000465d0: 2323 2323 2020 2573 2020 4d20 4f20 4420  ####  %s  M O D 
+000465e0: 4520 4c20 2020 5220 4520 5320 5520 4c20  E L   R E S U L 
+000465f0: 5420 5320 2323 2323 2323 2323 2323 2323  T S ############
+00046600: 2323 2323 2327 2025 6d6f 6465 6c5f 6c61  #####' %model_la
+00046610: 6265 6c29 0d0a 2020 2020 7472 793a 0d0a  bel)..    try:..
+00046620: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00046630: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
+00046640: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
+00046650: 2020 2020 2020 2069 6620 6879 7065 725f         if hyper_
+00046660: 7061 7261 6d20 3d3d 2027 5253 2720 6f72  param == 'RS' or
+00046670: 2068 7970 6572 5f70 6172 616d 203d 3d20   hyper_param == 
+00046680: 2747 5327 3a0d 0a20 2020 2020 2020 2020  'GS':..         
+00046690: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
+000466a0: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
+000466b0: 6f6e 2720 616e 6420 496d 6261 6c61 6e63  on' and Imbalanc
+000466c0: 6564 5f46 6c61 673a 0d0a 2020 2020 2020  ed_Flag:..      
+000466d0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+000466e0: 2320 4966 2079 6f75 2075 7365 2053 4d4f  # If you use SMO
+000466f0: 5445 2c20 7468 656e 206e 6f20 4772 6964  TE, then no Grid
+00046700: 5365 6172 6368 4356 2069 7320 646f 6e65  SearchCV is done
+00046710: 2e20 4865 6e63 6520 6e6f 2062 6573 745f  . Hence no best_
+00046720: 7363 6f72 655f 0d0a 2020 2020 2020 2020  score_..        
+00046730: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00046740: 5f73 636f 7265 203d 2030 0d0a 2020 2020  _score = 0..    
+00046750: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00046760: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00046770: 2020 2020 2020 2062 6573 745f 7363 6f72         best_scor
+00046780: 6520 3d20 6d6f 6465 6c2e 6265 7374 5f73  e = model.best_s
+00046790: 636f 7265 5f0d 0a20 2020 2020 2020 2020  core_..         
+000467a0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+000467b0: 6174 696f 6e5f 6d65 7472 6963 203d 2063  ation_metric = c
+000467c0: 6f70 792e 6465 6570 636f 7079 2873 636f  opy.deepcopy(sco
+000467d0: 7269 6e67 5f70 6172 616d 6574 6572 290d  ring_parameter).
+000467e0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+000467f0: 6620 6879 7065 725f 7061 7261 6d20 6973  f hyper_param is
+00046800: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00046810: 2020 2020 2020 2020 6966 2049 6d62 616c          if Imbal
+00046820: 616e 6365 645f 466c 6167 3a0d 0a20 2020  anced_Flag:..   
+00046830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046840: 2023 2320 7468 6572 6520 6973 206e 6f20   ## there is no 
+00046850: 6265 7374 5f73 636f 7265 2073 696e 6365  best_score since
+00046860: 2047 7269 6453 6561 7263 6843 5620 6973   GridSearchCV is
+00046870: 206e 6f74 2075 7365 640d 0a20 2020 2020   not used..     
+00046880: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00046890: 6573 745f 7363 6f72 6520 3d20 300d 0a20  est_score = 0.. 
+000468a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000468b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000468c0: 2020 2020 2020 2020 2020 7661 6c5f 6b65            val_ke
+000468d0: 7973 203d 206c 6973 7428 6d6f 6465 6c2e  ys = list(model.
+000468e0: 6265 7374 5f73 636f 7265 5f2e 6b65 7973  best_score_.keys
+000468f0: 2829 290d 0a20 2020 2020 2020 2020 2020  ())..           
+00046900: 2020 2020 2069 6620 2776 616c 6964 6174       if 'validat
+00046910: 696f 6e27 2069 6e20 7661 6c5f 6b65 7973  ion' in val_keys
+00046920: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00046930: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
+00046940: 6e5f 6d65 7472 6963 203d 206c 6973 7428  n_metric = list(
+00046950: 6d6f 6465 6c2e 6265 7374 5f73 636f 7265  model.best_score
+00046960: 5f5b 2776 616c 6964 6174 696f 6e27 5d2e  _['validation'].
+00046970: 6b65 7973 2829 295b 305d 0d0a 2020 2020  keys())[0]..    
+00046980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046990: 6265 7374 5f73 636f 7265 203d 206d 6f64  best_score = mod
+000469a0: 656c 2e62 6573 745f 7363 6f72 655f 5b27  el.best_score_['
+000469b0: 7661 6c69 6461 7469 6f6e 275d 5b76 616c  validation'][val
+000469c0: 6964 6174 696f 6e5f 6d65 7472 6963 5d0d  idation_metric].
+000469d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000469e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000469f0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00046a00: 6461 7469 6f6e 5f6d 6574 7269 6320 3d20  dation_metric = 
+00046a10: 6c69 7374 286d 6f64 656c 2e62 6573 745f  list(model.best_
+00046a20: 7363 6f72 655f 5b27 6c65 6172 6e27 5d2e  score_['learn'].
+00046a30: 6b65 7973 2829 295b 305d 0d0a 2020 2020  keys())[0]..    
+00046a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046a50: 6265 7374 5f73 636f 7265 203d 206d 6f64  best_score = mod
+00046a60: 656c 2e62 6573 745f 7363 6f72 655f 5b27  el.best_score_['
+00046a70: 6c65 6172 6e27 5d5b 7661 6c69 6461 7469  learn'][validati
+00046a80: 6f6e 5f6d 6574 7269 635d 0d0a 2020 2020  on_metric]..    
+00046a90: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00046aa0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00046ab0: 2320 5468 6973 2061 7070 6c69 6573 206f  # This applies o
+00046ac0: 6e6c 7920 746f 2053 5045 2063 6c61 7373  nly to SPE class
+00046ad0: 6966 6965 7220 2323 2323 2323 2323 0d0a  ifier ########..
+00046ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046af0: 7661 6c69 6461 7469 6f6e 5f6d 6574 7269  validation_metri
+00046b00: 6320 3d20 2742 616c 616e 6365 6420 4163  c = 'Balanced Ac
+00046b10: 6375 7261 6379 270d 0a20 2020 2020 2020  curacy'..       
+00046b20: 2020 2020 2020 2020 2062 6573 745f 7363           best_sc
+00046b30: 6f72 6520 3d20 6261 6c61 6e63 6564 5f61  ore = balanced_a
+00046b40: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+00046b50: 6376 2c20 6d6f 6465 6c2e 7072 6564 6963  cv, model.predic
+00046b60: 7428 585f 6376 2929 0d0a 2020 2020 6578  t(X_cv))..    ex
+00046b70: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
+00046b80: 7269 6e74 2827 4572 726f 723a 204e 6f74  rint('Error: Not
+00046b90: 2061 626c 6520 746f 2070 7269 6e74 2076   able to print v
+00046ba0: 616c 6964 6174 696f 6e20 6d65 7472 6963  alidation metric
+00046bb0: 732e 2043 6f6e 7469 6e75 696e 672e 2e2e  s. Continuing...
+00046bc0: 2729 0d0a 2020 2020 2020 2020 6265 7374  ')..        best
+00046bd0: 5f73 636f 7265 203d 2030 0d0a 2020 2020  _score = 0..    
+00046be0: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
+00046bf0: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
+00046c00: 3a0d 0a20 2020 2020 2020 2069 6620 6d6f  :..        if mo
+00046c10: 6465 6c74 7970 6520 213d 2027 5265 6772  deltype != 'Regr
+00046c20: 6573 7369 6f6e 273a 0d0a 2020 2020 2020  ession':..      
+00046c30: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+00046c40: 2323 2323 2054 6869 7320 6973 2066 6f72  #### This is for
+00046c50: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
+00046c60: 4f6e 6c79 2021 2120 2323 2323 2323 2323  Only !! ########
+00046c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00046c80: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00046c90: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00046ca0: 6572 2069 6e20 5b27 6c6f 676c 6f73 7327  er in ['logloss'
+00046cb0: 2c27 6e65 675f 6c6f 675f 6c6f 7373 272c  ,'neg_log_loss',
+00046cc0: 276c 6f67 5f6c 6f73 7327 2c27 6c6f 672d  'log_loss','log-
+00046cd0: 6c6f 7373 272c 2727 5d3a 0d0a 2020 2020  loss','']:..    
+00046ce0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00046cf0: 7428 277b 7d2d 666f 6c64 2043 726f 7373  t('{}-fold Cross
+00046d00: 2056 616c 6964 6174 696f 6e20 7b7d 203d   Validation {} =
+00046d10: 207b 7d27 2e66 6f72 6d61 7428 6e5f 7370   {}'.format(n_sp
+00046d20: 6c69 7473 2c20 276c 6f67 6c6f 7373 272c  lits, 'logloss',
+00046d30: 2062 6573 745f 7363 6f72 6529 290d 0a20   best_score)).. 
+00046d40: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00046d50: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+00046d60: 7220 696e 205b 2761 6363 7572 6163 7927  r in ['accuracy'
+00046d70: 2c27 6261 6c61 6e63 6564 2d61 6363 7572  ,'balanced-accur
+00046d80: 6163 7927 2c27 6261 6c61 6e63 6564 5f61  acy','balanced_a
+00046d90: 6363 7572 6163 7927 2c27 726f 635f 6175  ccuracy','roc_au
+00046da0: 6327 2c27 726f 632d 6175 6327 2c0d 0a20  c','roc-auc',.. 
+00046db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046dd0: 2020 2020 2020 2766 3127 2c27 7072 6563        'f1','prec
+00046de0: 6973 696f 6e27 2c27 7265 6361 6c6c 272c  ision','recall',
+00046df0: 2761 7665 7261 6765 2d70 7265 6369 7369  'average-precisi
+00046e00: 6f6e 272c 2761 7665 7261 6765 5f70 7265  on','average_pre
+00046e10: 6369 7369 6f6e 272c 0d0a 2020 2020 2020  cision',..      
+00046e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046e40: 2777 6569 6768 7465 645f 6631 272c 2777  'weighted_f1','w
+00046e50: 6569 6768 7465 642d 6631 272c 2741 5543  eighted-f1','AUC
+00046e60: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
+00046e70: 2020 2020 2070 7269 6e74 2827 2564 2d66       print('%d-f
+00046e80: 6f6c 6420 4372 6f73 7320 5661 6c69 6461  old Cross Valida
+00046e90: 7469 6f6e 2020 2573 203d 2025 302e 3166  tion  %s = %0.1f
+00046ea0: 2525 2720 2528 6e5f 7370 6c69 7473 2c73  %%' %(n_splits,s
+00046eb0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+00046ec0: 2c20 6265 7374 5f73 636f 7265 2a31 3030  , best_score*100
+00046ed0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00046ee0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00046ef0: 2020 2020 2020 2070 7269 6e74 2827 2564         print('%d
+00046f00: 2d66 6f6c 6420 4372 6f73 7320 5661 6c69  -fold Cross Vali
+00046f10: 6461 7469 6f6e 2020 2573 203d 2025 302e  dation  %s = %0.
+00046f20: 3166 2720 2528 6e5f 7370 6c69 7473 2c76  1f' %(n_splits,v
+00046f30: 616c 6964 6174 696f 6e5f 6d65 7472 6963  alidation_metric
+00046f40: 2c20 6265 7374 5f73 636f 7265 2929 0d0a  , best_score))..
+00046f50: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00046f60: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+00046f70: 2323 2323 2054 6869 7320 6973 2066 6f72  #### This is for
+00046f80: 2052 6567 7265 7373 696f 6e20 6f6e 6c79   Regression only
+00046f90: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00046fa0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00046fb0: 2062 6573 745f 7363 6f72 6520 3c20 303a   best_score < 0:
+00046fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00046fd0: 2020 6265 7374 5f73 636f 7265 203d 2062    best_score = b
+00046fe0: 6573 745f 7363 6f72 652a 2d31 0d0a 2020  est_score*-1..  
+00046ff0: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
+00047000: 7269 6e67 5f70 6172 616d 6574 6572 203d  ring_parameter =
+00047010: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
+00047020: 2020 2020 2020 2070 7269 6e74 2827 2564         print('%d
+00047030: 2d66 6f6c 6420 4372 6f73 7320 5661 6c69  -fold Cross Vali
+00047040: 6461 7469 6f6e 2025 7320 5363 6f72 6520  dation %s Score 
+00047050: 3d20 2530 2e34 6627 2025 286e 5f73 706c  = %0.4f' %(n_spl
+00047060: 6974 732c 2752 4d53 4527 2c20 6265 7374  its,'RMSE', best
 00047070: 5f73 636f 7265 2929 0d0a 2020 2020 2020  _score))..      
-00047080: 2020 2323 2323 2057 6520 6e6f 7720 6e65    #### We now ne
-00047090: 6564 2074 6f20 7365 7420 7468 6520 4265  ed to set the Be
-000470a0: 7374 2050 6172 616d 6574 6572 732c 2046  st Parameters, F
-000470b0: 6974 2074 6865 204d 6f64 656c 206f 6e20  it the Model on 
-000470c0: 4675 6c6c 2058 5f74 7261 696e 2061 6e64  Full X_train and
-000470d0: 2050 7265 6469 6374 206f 6e20 585f 6376   Predict on X_cv
-000470e0: 0d0a 2020 2020 2020 2020 2323 2320 4669  ..        ### Fi
-000470f0: 6e64 2077 6861 7420 7468 6520 6f72 6465  nd what the orde
-00047100: 7220 6f66 2062 6573 7420 7061 7261 6d73  r of best params
-00047110: 2061 7265 2061 6e64 2073 6574 2074 6865   are and set the
-00047120: 2073 616d 6520 6173 2074 6865 206f 7269   same as the ori
-00047130: 6769 6e61 6c20 6d6f 6465 6c20 2323 230d  ginal model ###.
-00047140: 0a20 2020 2020 2020 2069 6620 6879 7065  .        if hype
-00047150: 725f 7061 7261 6d20 3d3d 2027 5253 2720  r_param == 'RS' 
-00047160: 6f72 2068 7970 6572 5f70 6172 616d 203d  or hyper_param =
-00047170: 3d20 2747 5327 3a0d 0a20 2020 2020 2020  = 'GS':..       
-00047180: 2020 2020 2069 6620 6e6f 7420 496d 6261       if not Imba
-00047190: 6c61 6e63 6564 5f46 6c61 673a 0d0a 2020  lanced_Flag:..  
-000471a0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-000471b0: 7374 5f70 6172 616d 733d 206d 6f64 656c  st_params= model
-000471c0: 2e62 6573 745f 7061 7261 6d73 5f0d 0a20  .best_params_.. 
-000471d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000471e0: 7269 6e74 2827 2020 2020 4265 7374 2050  rint('    Best P
-000471f0: 6172 616d 6574 6572 7320 666f 7220 4d6f  arameters for Mo
-00047200: 6465 6c20 3d20 2573 2720 256d 6f64 656c  del = %s' %model
-00047210: 2e62 6573 745f 7061 7261 6d73 5f29 0d0a  .best_params_)..
-00047220: 2020 2020 2020 2020 656c 6966 2068 7970          elif hyp
-00047230: 6572 5f70 6172 616d 2069 7320 4e6f 6e65  er_param is None
-00047240: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00047250: 2323 2320 4361 7442 6f6f 7374 2064 6f65  ### CatBoost doe
-00047260: 7320 6e6f 7420 6e65 6564 2048 7970 6572  s not need Hyper
-00047270: 2050 6172 616d 6574 6572 2074 756e 696e   Parameter tunin
-00047280: 6720 3d3e 2069 7427 7320 6772 6561 7420  g => it's great 
-00047290: 6f75 7420 6f66 2074 6865 2062 6f78 210d  out of the box!.
-000472a0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-000472b0: 2320 4361 7442 6f6f 7374 2064 6f65 7320  # CatBoost does 
-000472c0: 6e6f 7420 6e65 6564 2074 6f6f 206d 616e  not need too man
-000472d0: 7920 6974 6572 6174 696f 6e73 2e20 4a75  y iterations. Ju
-000472e0: 7374 206d 616b 6520 7375 7265 2079 6f75  st make sure you
-000472f0: 2073 6574 2074 6865 2069 7465 7261 7469   set the iterati
-00047300: 6f6e 7320 6c6f 7720 6166 7465 7220 7468  ons low after th
-00047310: 6520 6669 7273 7420 7469 6d65 210d 0a20  e first time!.. 
-00047320: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00047330: 7420 496d 6261 6c61 6e63 6564 5f46 6c61  t Imbalanced_Fla
-00047340: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-00047350: 2020 2020 6966 206d 6f64 656c 2e67 6574      if model.get
-00047360: 5f62 6573 745f 6974 6572 6174 696f 6e28  _best_iteration(
-00047370: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
-00047380: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00047390: 2049 6e20 736f 6d65 2073 6d61 6c6c 2064   In some small d
-000473a0: 6174 6120 7365 7473 2c20 7468 6520 6e75  ata sets, the nu
-000473b0: 6d62 6572 206f 6620 6974 6572 6174 696f  mber of iteratio
-000473c0: 6e73 2062 6563 6f6d 6573 207a 6572 6f2c  ns becomes zero,
-000473d0: 2068 656e 6365 2077 6520 7365 7420 6974   hence we set it
-000473e0: 2061 7320 6120 6465 6661 756c 7420 6e75   as a default nu
-000473f0: 6d62 6572 0d0a 2020 2020 2020 2020 2020  mber..          
-00047400: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
-00047410: 6172 616d 7320 3d20 6469 6374 287a 6970  arams = dict(zip
-00047420: 285b 2769 7465 7261 7469 6f6e 7327 2c27  (['iterations','
-00047430: 6c65 6172 6e69 6e67 5f72 6174 6527 5d2c  learning_rate'],
-00047440: 5b31 3030 302c 6d6f 6465 6c2e 6765 745f  [1000,model.get_
-00047450: 616c 6c5f 7061 7261 6d73 2829 5b27 6c65  all_params()['le
-00047460: 6172 6e69 6e67 5f72 6174 6527 5d5d 2929  arning_rate']]))
-00047470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00047480: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00047490: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-000474a0: 745f 7061 7261 6d73 203d 2064 6963 7428  t_params = dict(
-000474b0: 7a69 7028 5b27 6974 6572 6174 696f 6e73  zip(['iterations
-000474c0: 272c 276c 6561 726e 696e 675f 7261 7465  ','learning_rate
-000474d0: 275d 2c5b 6d6f 6465 6c2e 6765 745f 6265  '],[model.get_be
-000474e0: 7374 5f69 7465 7261 7469 6f6e 2829 2c6d  st_iteration(),m
-000474f0: 6f64 656c 2e67 6574 5f61 6c6c 5f70 6172  odel.get_all_par
-00047500: 616d 7328 295b 276c 6561 726e 696e 675f  ams()['learning_
-00047510: 7261 7465 275d 5d29 290d 0a20 2020 2020  rate']]))..     
-00047520: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00047530: 2827 2020 2020 2573 2042 6573 7420 5061  ('    %s Best Pa
-00047540: 7261 6d65 7465 7273 2066 6f72 204d 6f64  rameters for Mod
-00047550: 656c 3a20 4974 6572 6174 696f 6e73 203d  el: Iterations =
-00047560: 2025 732c 206c 6561 726e 696e 675f 7261   %s, learning_ra
-00047570: 7465 203d 2025 302e 3266 2720 2528 0d0a  te = %0.2f' %(..
-00047580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000475a0: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2c20      model_name, 
-000475b0: 6d6f 6465 6c2e 6765 745f 6265 7374 5f69  model.get_best_i
-000475c0: 7465 7261 7469 6f6e 2829 2c20 6d6f 6465  teration(), mode
-000475d0: 6c2e 6765 745f 616c 6c5f 7061 7261 6d73  l.get_all_params
-000475e0: 2829 5b27 6c65 6172 6e69 6e67 5f72 6174  ()['learning_rat
-000475f0: 6527 5d29 290d 0a20 2020 2020 2020 2020  e']))..         
-00047600: 2020 2065 6c69 6620 496d 6261 6c61 6e63     elif Imbalanc
-00047610: 6564 5f46 6c61 6720 616e 6420 6d6f 6465  ed_Flag and mode
-00047620: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-00047630: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-00047640: 2020 2020 2020 2020 2323 2074 6869 7320          ## this 
-00047650: 6d65 616e 7320 7265 6772 6573 7369 6f6e  means regression
-00047660: 2072 6573 616d 706c 6572 2069 7320 6265   resampler is be
-00047670: 696e 6720 7573 6564 0d0a 2020 2020 2020  ing used..      
-00047680: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00047690: 656c 2e67 6574 5f62 6573 745f 6974 6572  el.get_best_iter
-000476a0: 6174 696f 6e28 2920 3d3d 2030 3a0d 0a20  ation() == 0:.. 
-000476b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000476c0: 2020 2023 2323 2049 6e20 736f 6d65 2073     ### In some s
-000476d0: 6d61 6c6c 2064 6174 6120 7365 7473 2c20  mall data sets, 
-000476e0: 7468 6520 6e75 6d62 6572 206f 6620 6974  the number of it
-000476f0: 6572 6174 696f 6e73 2062 6563 6f6d 6573  erations becomes
-00047700: 207a 6572 6f2c 2068 656e 6365 2077 6520   zero, hence we 
-00047710: 7365 7420 6974 2061 7320 6120 6465 6661  set it as a defa
-00047720: 756c 7420 6e75 6d62 6572 0d0a 2020 2020  ult number..    
+00047080: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00047090: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000470a0: 6e74 2827 2564 2d66 6f6c 6420 4372 6f73  nt('%d-fold Cros
+000470b0: 7320 5661 6c69 6461 7469 6f6e 2025 7320  s Validation %s 
+000470c0: 5363 6f72 6520 3d20 2530 2e34 6627 2025  Score = %0.4f' %
+000470d0: 286e 5f73 706c 6974 732c 7661 6c69 6461  (n_splits,valida
+000470e0: 7469 6f6e 5f6d 6574 7269 632c 2062 6573  tion_metric, bes
+000470f0: 745f 7363 6f72 6529 290d 0a20 2020 2020  t_score))..     
+00047100: 2020 2023 2323 2320 5765 206e 6f77 206e     #### We now n
+00047110: 6565 6420 746f 2073 6574 2074 6865 2042  eed to set the B
+00047120: 6573 7420 5061 7261 6d65 7465 7273 2c20  est Parameters, 
+00047130: 4669 7420 7468 6520 4d6f 6465 6c20 6f6e  Fit the Model on
+00047140: 2046 756c 6c20 585f 7472 6169 6e20 616e   Full X_train an
+00047150: 6420 5072 6564 6963 7420 6f6e 2058 5f63  d Predict on X_c
+00047160: 760d 0a20 2020 2020 2020 2023 2323 2046  v..        ### F
+00047170: 696e 6420 7768 6174 2074 6865 206f 7264  ind what the ord
+00047180: 6572 206f 6620 6265 7374 2070 6172 616d  er of best param
+00047190: 7320 6172 6520 616e 6420 7365 7420 7468  s are and set th
+000471a0: 6520 7361 6d65 2061 7320 7468 6520 6f72  e same as the or
+000471b0: 6967 696e 616c 206d 6f64 656c 2023 2323  iginal model ###
+000471c0: 0d0a 2020 2020 2020 2020 6966 2068 7970  ..        if hyp
+000471d0: 6572 5f70 6172 616d 203d 3d20 2752 5327  er_param == 'RS'
+000471e0: 206f 7220 6879 7065 725f 7061 7261 6d20   or hyper_param 
+000471f0: 3d3d 2027 4753 273a 0d0a 2020 2020 2020  == 'GS':..      
+00047200: 2020 2020 2020 6966 206e 6f74 2049 6d62        if not Imb
+00047210: 616c 616e 6365 645f 466c 6167 3a0d 0a20  alanced_Flag:.. 
+00047220: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00047230: 6573 745f 7061 7261 6d73 3d20 6d6f 6465  est_params= mode
+00047240: 6c2e 6265 7374 5f70 6172 616d 735f 0d0a  l.best_params_..
+00047250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047260: 7072 696e 7428 2720 2020 2042 6573 7420  print('    Best 
+00047270: 5061 7261 6d65 7465 7273 2066 6f72 204d  Parameters for M
+00047280: 6f64 656c 203d 2025 7327 2025 6d6f 6465  odel = %s' %mode
+00047290: 6c2e 6265 7374 5f70 6172 616d 735f 290d  l.best_params_).
+000472a0: 0a20 2020 2020 2020 2065 6c69 6620 6879  .        elif hy
+000472b0: 7065 725f 7061 7261 6d20 6973 204e 6f6e  per_param is Non
+000472c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000472d0: 2323 2323 2043 6174 426f 6f73 7420 646f  #### CatBoost do
+000472e0: 6573 206e 6f74 206e 6565 6420 4879 7065  es not need Hype
+000472f0: 7220 5061 7261 6d65 7465 7220 7475 6e69  r Parameter tuni
+00047300: 6e67 203d 3e20 6974 2773 2067 7265 6174  ng => it's great
+00047310: 206f 7574 206f 6620 7468 6520 626f 7821   out of the box!
+00047320: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00047330: 2323 2043 6174 426f 6f73 7420 646f 6573  ## CatBoost does
+00047340: 206e 6f74 206e 6565 6420 746f 6f20 6d61   not need too ma
+00047350: 6e79 2069 7465 7261 7469 6f6e 732e 204a  ny iterations. J
+00047360: 7573 7420 6d61 6b65 2073 7572 6520 796f  ust make sure yo
+00047370: 7520 7365 7420 7468 6520 6974 6572 6174  u set the iterat
+00047380: 696f 6e73 206c 6f77 2061 6674 6572 2074  ions low after t
+00047390: 6865 2066 6972 7374 2074 696d 6521 0d0a  he first time!..
+000473a0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000473b0: 6f74 2049 6d62 616c 616e 6365 645f 466c  ot Imbalanced_Fl
+000473c0: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
+000473d0: 2020 2020 2069 6620 6d6f 6465 6c2e 6765       if model.ge
+000473e0: 745f 6265 7374 5f69 7465 7261 7469 6f6e  t_best_iteration
+000473f0: 2829 203d 3d20 303a 0d0a 2020 2020 2020  () == 0:..      
+00047400: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00047410: 2320 496e 2073 6f6d 6520 736d 616c 6c20  # In some small 
+00047420: 6461 7461 2073 6574 732c 2074 6865 206e  data sets, the n
+00047430: 756d 6265 7220 6f66 2069 7465 7261 7469  umber of iterati
+00047440: 6f6e 7320 6265 636f 6d65 7320 7a65 726f  ons becomes zero
+00047450: 2c20 6865 6e63 6520 7765 2073 6574 2069  , hence we set i
+00047460: 7420 6173 2061 2064 6566 6175 6c74 206e  t as a default n
+00047470: 756d 6265 720d 0a20 2020 2020 2020 2020  umber..         
+00047480: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00047490: 7061 7261 6d73 203d 2064 6963 7428 7a69  params = dict(zi
+000474a0: 7028 5b27 6974 6572 6174 696f 6e73 272c  p(['iterations',
+000474b0: 276c 6561 726e 696e 675f 7261 7465 275d  'learning_rate']
+000474c0: 2c5b 3130 3030 2c6d 6f64 656c 2e67 6574  ,[1000,model.get
+000474d0: 5f61 6c6c 5f70 6172 616d 7328 295b 276c  _all_params()['l
+000474e0: 6561 726e 696e 675f 7261 7465 275d 5d29  earning_rate']])
+000474f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00047500: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00047510: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00047520: 7374 5f70 6172 616d 7320 3d20 6469 6374  st_params = dict
+00047530: 287a 6970 285b 2769 7465 7261 7469 6f6e  (zip(['iteration
+00047540: 7327 2c27 6c65 6172 6e69 6e67 5f72 6174  s','learning_rat
+00047550: 6527 5d2c 5b6d 6f64 656c 2e67 6574 5f62  e'],[model.get_b
+00047560: 6573 745f 6974 6572 6174 696f 6e28 292c  est_iteration(),
+00047570: 6d6f 6465 6c2e 6765 745f 616c 6c5f 7061  model.get_all_pa
+00047580: 7261 6d73 2829 5b27 6c65 6172 6e69 6e67  rams()['learning
+00047590: 5f72 6174 6527 5d5d 2929 0d0a 2020 2020  _rate']]))..    
+000475a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000475b0: 7428 2720 2020 2025 7320 4265 7374 2050  t('    %s Best P
+000475c0: 6172 616d 6574 6572 7320 666f 7220 4d6f  arameters for Mo
+000475d0: 6465 6c3a 2049 7465 7261 7469 6f6e 7320  del: Iterations 
+000475e0: 3d20 2573 2c20 6c65 6172 6e69 6e67 5f72  = %s, learning_r
+000475f0: 6174 6520 3d20 2530 2e32 6627 2025 280d  ate = %0.2f' %(.
+00047600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047620: 2020 2020 206d 6f64 656c 5f6e 616d 652c       model_name,
+00047630: 206d 6f64 656c 2e67 6574 5f62 6573 745f   model.get_best_
+00047640: 6974 6572 6174 696f 6e28 292c 206d 6f64  iteration(), mod
+00047650: 656c 2e67 6574 5f61 6c6c 5f70 6172 616d  el.get_all_param
+00047660: 7328 295b 276c 6561 726e 696e 675f 7261  s()['learning_ra
+00047670: 7465 275d 2929 0d0a 2020 2020 2020 2020  te']))..        
+00047680: 2020 2020 656c 6966 2049 6d62 616c 616e      elif Imbalan
+00047690: 6365 645f 466c 6167 2061 6e64 206d 6f64  ced_Flag and mod
+000476a0: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
+000476b0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
+000476c0: 2020 2020 2020 2020 2023 2320 7468 6973           ## this
+000476d0: 206d 6561 6e73 2072 6567 7265 7373 696f   means regressio
+000476e0: 6e20 7265 7361 6d70 6c65 7220 6973 2062  n resampler is b
+000476f0: 6569 6e67 2075 7365 640d 0a20 2020 2020  eing used..     
+00047700: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+00047710: 6465 6c2e 6765 745f 6265 7374 5f69 7465  del.get_best_ite
+00047720: 7261 7469 6f6e 2829 203d 3d20 303a 0d0a  ration() == 0:..
 00047730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047740: 6265 7374 5f70 6172 616d 7320 3d20 6469  best_params = di
-00047750: 6374 287a 6970 285b 2769 7465 7261 7469  ct(zip(['iterati
-00047760: 6f6e 7327 2c27 6c65 6172 6e69 6e67 5f72  ons','learning_r
-00047770: 6174 6527 5d2c 5b31 3030 302c 6d6f 6465  ate'],[1000,mode
-00047780: 6c2e 6765 745f 616c 6c5f 7061 7261 6d73  l.get_all_params
-00047790: 2829 5b27 6c65 6172 6e69 6e67 5f72 6174  ()['learning_rat
-000477a0: 6527 5d5d 2929 0d0a 2020 2020 2020 2020  e']]))..        
-000477b0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000477c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000477d0: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
-000477e0: 2064 6963 7428 7a69 7028 5b27 6974 6572   dict(zip(['iter
-000477f0: 6174 696f 6e73 272c 276c 6561 726e 696e  ations','learnin
-00047800: 675f 7261 7465 275d 2c5b 6d6f 6465 6c2e  g_rate'],[model.
-00047810: 6765 745f 6265 7374 5f69 7465 7261 7469  get_best_iterati
-00047820: 6f6e 2829 2c6d 6f64 656c 2e67 6574 5f61  on(),model.get_a
-00047830: 6c6c 5f70 6172 616d 7328 295b 276c 6561  ll_params()['lea
-00047840: 726e 696e 675f 7261 7465 275d 5d29 290d  rning_rate']])).
-00047850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047860: 2070 7269 6e74 2827 2020 2020 2573 2042   print('    %s B
-00047870: 6573 7420 5061 7261 6d65 7465 7273 2066  est Parameters f
-00047880: 6f72 204d 6f64 656c 3a20 4974 6572 6174  or Model: Iterat
-00047890: 696f 6e73 203d 2025 732c 206c 6561 726e  ions = %s, learn
-000478a0: 696e 675f 7261 7465 203d 2025 302e 3266  ing_rate = %0.2f
-000478b0: 2720 2528 0d0a 2020 2020 2020 2020 2020  ' %(..          
-000478c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000478d0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-000478e0: 6e61 6d65 2c20 6d6f 6465 6c2e 6765 745f  name, model.get_
-000478f0: 6265 7374 5f69 7465 7261 7469 6f6e 2829  best_iteration()
-00047900: 2c20 6d6f 6465 6c2e 6765 745f 616c 6c5f  , model.get_all_
-00047910: 7061 7261 6d73 2829 5b27 6c65 6172 6e69  params()['learni
-00047920: 6e67 5f72 6174 6527 5d29 290d 0a20 2020  ng_rate']))..   
-00047930: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00047740: 2020 2020 2323 2320 496e 2073 6f6d 6520      ### In some 
+00047750: 736d 616c 6c20 6461 7461 2073 6574 732c  small data sets,
+00047760: 2074 6865 206e 756d 6265 7220 6f66 2069   the number of i
+00047770: 7465 7261 7469 6f6e 7320 6265 636f 6d65  terations become
+00047780: 7320 7a65 726f 2c20 6865 6e63 6520 7765  s zero, hence we
+00047790: 2073 6574 2069 7420 6173 2061 2064 6566   set it as a def
+000477a0: 6175 6c74 206e 756d 6265 720d 0a20 2020  ault number..   
+000477b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000477c0: 2062 6573 745f 7061 7261 6d73 203d 2064   best_params = d
+000477d0: 6963 7428 7a69 7028 5b27 6974 6572 6174  ict(zip(['iterat
+000477e0: 696f 6e73 272c 276c 6561 726e 696e 675f  ions','learning_
+000477f0: 7261 7465 275d 2c5b 3130 3030 2c6d 6f64  rate'],[1000,mod
+00047800: 656c 2e67 6574 5f61 6c6c 5f70 6172 616d  el.get_all_param
+00047810: 7328 295b 276c 6561 726e 696e 675f 7261  s()['learning_ra
+00047820: 7465 275d 5d29 290d 0a20 2020 2020 2020  te']]))..       
+00047830: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00047840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047850: 2020 2020 6265 7374 5f70 6172 616d 7320      best_params 
+00047860: 3d20 6469 6374 287a 6970 285b 2769 7465  = dict(zip(['ite
+00047870: 7261 7469 6f6e 7327 2c27 6c65 6172 6e69  rations','learni
+00047880: 6e67 5f72 6174 6527 5d2c 5b6d 6f64 656c  ng_rate'],[model
+00047890: 2e67 6574 5f62 6573 745f 6974 6572 6174  .get_best_iterat
+000478a0: 696f 6e28 292c 6d6f 6465 6c2e 6765 745f  ion(),model.get_
+000478b0: 616c 6c5f 7061 7261 6d73 2829 5b27 6c65  all_params()['le
+000478c0: 6172 6e69 6e67 5f72 6174 6527 5d5d 2929  arning_rate']]))
+000478d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000478e0: 2020 7072 696e 7428 2720 2020 2025 7320    print('    %s 
+000478f0: 4265 7374 2050 6172 616d 6574 6572 7320  Best Parameters 
+00047900: 666f 7220 4d6f 6465 6c3a 2049 7465 7261  for Model: Itera
+00047910: 7469 6f6e 7320 3d20 2573 2c20 6c65 6172  tions = %s, lear
+00047920: 6e69 6e67 5f72 6174 6520 3d20 2530 2e32  ning_rate = %0.2
+00047930: 6627 2025 280d 0a20 2020 2020 2020 2020  f' %(..         
 00047940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047950: 6265 7374 5f70 6172 616d 7320 3d20 7b7d  best_params = {}
-00047960: 0d0a 2020 2020 2020 2020 6966 2068 7970  ..        if hyp
-00047970: 6572 5f70 6172 616d 203d 3d20 2752 5327  er_param == 'RS'
-00047980: 206f 7220 6879 7065 725f 7061 7261 6d20   or hyper_param 
-00047990: 3d3d 2027 4753 273a 0d0a 2020 2020 2020  == 'GS':..      
-000479a0: 2020 2020 2020 2323 2323 2049 6e20 7468        #### In th
-000479b0: 6520 6361 7365 206f 6620 4361 7442 6f6f  e case of CatBoo
-000479c0: 7374 2c20 7765 2064 6f6e 2774 2064 6f20  st, we don't do 
-000479d0: 616e 7920 4879 7065 7220 5061 7261 6d65  any Hyper Parame
-000479e0: 7465 7220 7475 6e69 6e67 2023 2323 2323  ter tuning #####
-000479f0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00047a00: 2020 6966 206e 6f74 2049 6d62 616c 616e    if not Imbalan
-00047a10: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
-00047a20: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
-00047a30: 636f 7079 2e64 6565 7063 6f70 7928 6d6f  copy.deepcopy(mo
-00047a40: 6465 6c29 0d0a 2020 2020 2020 2020 2020  del)..          
-00047a50: 2020 2020 2020 6d6f 6465 6c20 3d20 6773        model = gs
-00047a60: 2e62 6573 745f 6573 7469 6d61 746f 725f  .best_estimator_
-00047a70: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00047a80: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00047a90: 2020 2020 2070 7269 6e74 2827 4e6f 2063       print('No c
-00047aa0: 726f 7373 2076 616c 6964 6174 696f 6e20  ross validation 
-00047ab0: 646f 6e65 2077 6865 6e20 496d 6261 6c61  done when Imbala
-00047ac0: 6e63 6564 5f46 6c61 6720 7365 7420 746f  nced_Flag set to
-00047ad0: 2054 7275 652e 2e2e 2729 0d0a 2020 2020   True...')..    
-00047ae0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-00047af0: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
-00047b00: 655f 4c61 6265 6c27 2061 6e64 206d 6f64  e_Label' and mod
-00047b10: 656c 7479 7065 203d 3d20 274d 756c 7469  eltype == 'Multi
-00047b20: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
-00047b30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00047b40: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00047b50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00047b60: 585f 6376 2e73 6861 7065 5b30 5d20 3c3d  X_cv.shape[0] <=
-00047b70: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
-00047b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047b90: 2320 5448 6973 2077 6f72 6b73 2077 656c  # THis works wel
-00047ba0: 6c20 666f 7220 736d 616c 6c20 6461 7461  l for small data
-00047bb0: 2073 6574 7320 616e 6420 6973 2073 696d   sets and is sim
-00047bc0: 696c 6172 2074 6f20 7061 7261 6d65 7472  ilar to parametr
-00047bd0: 6963 0d0a 2020 2020 2020 2020 2020 2020  ic..            
-00047be0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00047bf0: 6f64 3d20 2027 7369 676d 6f69 6427 2023  od=  'sigmoid' #
-00047c00: 2027 6973 6f74 6f6e 6963 2720 2320 230d   'isotonic' # #.
-00047c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047c20: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00047c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047c40: 2020 2020 2320 5448 6973 2077 6f72 6b73      # THis works
-00047c50: 2077 656c 6c20 666f 7220 6c61 7267 6520   well for large 
-00047c60: 6461 7461 2073 6574 7320 616e 6420 6973  data sets and is
-00047c70: 206e 6f6e 2d70 6172 616d 6574 7269 630d   non-parametric.
-00047c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047c90: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00047ca0: 2020 2769 736f 746f 6e69 6327 0d0a 2020    'isotonic'..  
+00047950: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00047960: 5f6e 616d 652c 206d 6f64 656c 2e67 6574  _name, model.get
+00047970: 5f62 6573 745f 6974 6572 6174 696f 6e28  _best_iteration(
+00047980: 292c 206d 6f64 656c 2e67 6574 5f61 6c6c  ), model.get_all
+00047990: 5f70 6172 616d 7328 295b 276c 6561 726e  _params()['learn
+000479a0: 696e 675f 7261 7465 275d 2929 0d0a 2020  ing_rate']))..  
+000479b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000479c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000479d0: 2062 6573 745f 7061 7261 6d73 203d 207b   best_params = {
+000479e0: 7d0d 0a20 2020 2020 2020 2069 6620 6879  }..        if hy
+000479f0: 7065 725f 7061 7261 6d20 3d3d 2027 5253  per_param == 'RS
+00047a00: 2720 6f72 2068 7970 6572 5f70 6172 616d  ' or hyper_param
+00047a10: 203d 3d20 2747 5327 3a0d 0a20 2020 2020   == 'GS':..     
+00047a20: 2020 2020 2020 2023 2323 2320 496e 2074         #### In t
+00047a30: 6865 2063 6173 6520 6f66 2043 6174 426f  he case of CatBo
+00047a40: 6f73 742c 2077 6520 646f 6e27 7420 646f  ost, we don't do
+00047a50: 2061 6e79 2048 7970 6572 2050 6172 616d   any Hyper Param
+00047a60: 6574 6572 2074 756e 696e 6720 2323 2323  eter tuning ####
+00047a70: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+00047a80: 2020 2069 6620 6e6f 7420 496d 6261 6c61     if not Imbala
+00047a90: 6e63 6564 5f46 6c61 673a 0d0a 2020 2020  nced_Flag:..    
+00047aa0: 2020 2020 2020 2020 2020 2020 6773 203d              gs =
+00047ab0: 2063 6f70 792e 6465 6570 636f 7079 286d   copy.deepcopy(m
+00047ac0: 6f64 656c 290d 0a20 2020 2020 2020 2020  odel)..         
+00047ad0: 2020 2020 2020 206d 6f64 656c 203d 2067         model = g
+00047ae0: 732e 6265 7374 5f65 7374 696d 6174 6f72  s.best_estimator
+00047af0: 5f0d 0a20 2020 2020 2020 2020 2020 2065  _..            e
+00047b00: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00047b10: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
+00047b20: 6372 6f73 7320 7661 6c69 6461 7469 6f6e  cross validation
+00047b30: 2064 6f6e 6520 7768 656e 2049 6d62 616c   done when Imbal
+00047b40: 616e 6365 645f 466c 6167 2073 6574 2074  anced_Flag set t
+00047b50: 6f20 5472 7565 2e2e 2e27 290d 0a20 2020  o True...')..   
+00047b60: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00047b70: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00047b80: 6c65 5f4c 6162 656c 2720 616e 6420 6d6f  le_Label' and mo
+00047b90: 6465 6c74 7970 6520 3d3d 2027 4d75 6c74  deltype == 'Mult
+00047ba0: 695f 436c 6173 7369 6669 6361 7469 6f6e  i_Classification
+00047bb0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00047bc0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+00047bd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00047be0: 2058 5f63 762e 7368 6170 655b 305d 203c   X_cv.shape[0] <
+00047bf0: 3d20 3130 3030 3a0d 0a20 2020 2020 2020  = 1000:..       
+00047c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047c10: 2023 2054 4869 7320 776f 726b 7320 7765   # THis works we
+00047c20: 6c6c 2066 6f72 2073 6d61 6c6c 2064 6174  ll for small dat
+00047c30: 6120 7365 7473 2061 6e64 2069 7320 7369  a sets and is si
+00047c40: 6d69 6c61 7220 746f 2070 6172 616d 6574  milar to paramet
+00047c50: 7269 630d 0a20 2020 2020 2020 2020 2020  ric..           
+00047c60: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00047c70: 686f 643d 2020 2773 6967 6d6f 6964 2720  hod=  'sigmoid' 
+00047c80: 2320 2769 736f 746f 6e69 6327 2023 2023  # 'isotonic' # #
+00047c90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00047ca0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
 00047cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047cc0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e63    from sklearn.c
-00047cd0: 616c 6962 7261 7469 6f6e 2069 6d70 6f72  alibration impor
-00047ce0: 7420 4361 6c69 6272 6174 6564 436c 6173  t CalibratedClas
-00047cf0: 7369 6669 6572 4356 0d0a 2020 2020 2020  sifierCV..      
-00047d00: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00047d10: 6465 6c20 3d20 4361 6c69 6272 6174 6564  del = Calibrated
-00047d20: 436c 6173 7369 6669 6572 4356 286d 6f64  ClassifierCV(mod
-00047d30: 656c 2c20 6d65 7468 6f64 3d6d 6574 686f  el, method=metho
-00047d40: 642c 2063 763d 6e5f 7370 6c69 7473 290d  d, cv=n_splits).
-00047d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047d60: 2020 2020 2069 6620 6e6f 7420 7065 7266       if not perf
-00047d70: 6f72 6d5f 7363 616c 696e 675f 666c 6167  orm_scaling_flag
-00047d80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00047d90: 2020 2020 2020 2020 2020 2058 5f66 756c             X_ful
-00047da0: 203d 2058 5f74 7261 696e 2e61 7070 656e   = X_train.appen
-00047db0: 6428 585f 6376 290d 0a20 2020 2020 2020  d(X_cv)..       
-00047dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047dd0: 2079 5f66 756c 203d 2079 5f74 7261 696e   y_ful = y_train
-00047de0: 2e61 7070 656e 6428 795f 6376 290d 0a20  .append(y_cv).. 
-00047df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047e00: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00047e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047e20: 2020 585f 6675 6c20 3d20 6e70 2e72 5f5b    X_ful = np.r_[
-00047e30: 585f 7472 6169 6e2c 2058 5f63 765d 0d0a  X_train, X_cv]..
+00047cc0: 2020 2020 2023 2054 4869 7320 776f 726b       # THis work
+00047cd0: 7320 7765 6c6c 2066 6f72 206c 6172 6765  s well for large
+00047ce0: 2064 6174 6120 7365 7473 2061 6e64 2069   data sets and i
+00047cf0: 7320 6e6f 6e2d 7061 7261 6d65 7472 6963  s non-parametric
+00047d00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00047d10: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00047d20: 3d20 2027 6973 6f74 6f6e 6963 270d 0a20  =  'isotonic'.. 
+00047d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047d40: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00047d50: 6361 6c69 6272 6174 696f 6e20 696d 706f  calibration impo
+00047d60: 7274 2043 616c 6962 7261 7465 6443 6c61  rt CalibratedCla
+00047d70: 7373 6966 6965 7243 560d 0a20 2020 2020  ssifierCV..     
+00047d80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00047d90: 6f64 656c 203d 2043 616c 6962 7261 7465  odel = Calibrate
+00047da0: 6443 6c61 7373 6966 6965 7243 5628 6d6f  dClassifierCV(mo
+00047db0: 6465 6c2c 206d 6574 686f 643d 6d65 7468  del, method=meth
+00047dc0: 6f64 2c20 6376 3d6e 5f73 706c 6974 7329  od, cv=n_splits)
+00047dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00047de0: 2020 2020 2020 6966 206e 6f74 2070 6572        if not per
+00047df0: 666f 726d 5f73 6361 6c69 6e67 5f66 6c61  form_scaling_fla
+00047e00: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00047e10: 2020 2020 2020 2020 2020 2020 585f 6675              X_fu
+00047e20: 6c20 3d20 585f 7472 6169 6e2e 6170 7065  l = X_train.appe
+00047e30: 6e64 2858 5f63 7629 0d0a 2020 2020 2020  nd(X_cv)..      
 00047e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047e50: 2020 2020 2020 2020 795f 6675 6c20 3d20          y_ful = 
-00047e60: 6e70 2e72 5f5b 795f 7472 6169 6e2c 2079  np.r_[y_train, y
-00047e70: 5f63 765d 0d0a 2020 2020 2020 2020 2020  _cv]..          
-00047e80: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-00047e90: 6669 7428 585f 6675 6c2c 2079 5f66 756c  fit(X_ful, y_ful
-00047ea0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00047eb0: 2020 2020 2020 2070 7269 6e74 2827 5573         print('Us
-00047ec0: 696e 6720 6120 4361 6c69 6272 6174 6564  ing a Calibrated
-00047ed0: 2043 6c61 7373 6966 6965 7220 696e 2074   Classifier in t
-00047ee0: 6869 7320 4d75 6c74 695f 436c 6173 7369  his Multi_Classi
-00047ef0: 6669 6361 7469 6f6e 2064 6174 6173 6574  fication dataset
-00047f00: 2074 6f20 696d 7072 6f76 6520 7265 7375   to improve resu
-00047f10: 6c74 732e 2e2e 2729 0d0a 2020 2020 2020  lts...')..      
-00047f20: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00047f30: 6c69 6272 6174 6f72 5f66 6c61 6720 3d20  librator_flag = 
-00047f40: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00047f50: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
-00047f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047f70: 2020 2063 616c 6962 7261 746f 725f 666c     calibrator_fl
-00047f80: 6167 203d 2046 616c 7365 0d0a 2020 2020  ag = False..    
-00047f90: 2020 2020 2020 2020 656c 6966 206d 6f64          elif mod
-00047fa0: 656c 5f6c 6162 656c 203d 3d20 274d 756c  el_label == 'Mul
-00047fb0: 7469 5f4c 6162 656c 2720 616e 6420 6d6f  ti_Label' and mo
-00047fc0: 6465 6c74 7970 6520 3d3d 2027 4269 6e61  deltype == 'Bina
-00047fd0: 7279 5f43 6c61 7373 6966 6963 6174 696f  ry_Classificatio
-00047fe0: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
-00047ff0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00048000: 4e6f 2047 7269 6453 6561 7263 6820 6f72  No GridSearch or
-00048010: 2052 616e 646f 6d69 7a65 6453 6561 7263   RandomizedSearc
-00048020: 6820 666f 7220 2573 2025 7320 7369 6e63  h for %s %s sinc
-00048030: 6520 6974 2074 616b 6573 2074 6f6f 206c  e it takes too l
-00048040: 6f6e 6727 2025 280d 0a20 2020 2020 2020  ong' %(..       
-00048050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048060: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00048070: 656c 5f6c 6162 656c 2c6d 6f64 656c 7479  el_label,modelty
-00048080: 7065 2929 0d0a 2020 2020 2020 2020 2369  pe))..        #i
-00048090: 6620 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77  f model_name.low
-000480a0: 6572 2829 203d 3d20 2763 6174 626f 6f73  er() == 'catboos
-000480b0: 7427 3a0d 0a20 2020 2020 2020 2023 2020  t':..        #  
-000480c0: 2020 7072 696e 7428 2742 6573 7420 4d6f    print('Best Mo
-000480d0: 6465 6c20 7365 6c65 6374 6564 2061 6e64  del selected and
-000480e0: 2069 7473 2070 6172 616d 6574 6572 7320   its parameters 
-000480f0: 6172 653a 5c6e 2020 2020 2573 2720 256d  are:\n    %s' %m
-00048100: 6f64 656c 2e67 6574 5f61 6c6c 5f70 6172  odel.get_all_par
-00048110: 616d 7328 2929 0d0a 2020 2020 2020 2020  ams())..        
-00048120: 2365 6c73 653a 0d0a 2020 2020 2020 2020  #else:..        
-00048130: 2320 2020 2070 7269 6e74 2827 4265 7374  #    print('Best
-00048140: 204d 6f64 656c 2073 656c 6563 7465 6420   Model selected 
-00048150: 616e 6420 6974 7320 6174 7472 6962 7574  and its attribut
-00048160: 6573 2061 7265 3a5c 6e20 2020 2025 7327  es are:\n    %s'
-00048170: 2025 6d6f 6465 6c29 0d0a 2020 2020 656c   %model)..    el
-00048180: 7365 3a0d 0a20 2020 2020 2020 2023 2323  se:..        ###
-00048190: 2323 2323 2320 4966 2074 6869 7320 6973  ##### If this is
-000481a0: 2061 206d 756c 7469 2d6c 6162 656c 206d   a multi-label m
-000481b0: 6f64 656c 2c20 7472 7920 746f 2073 6565  odel, try to see
-000481c0: 2069 6620 6974 2077 656e 7420 7468 726f   if it went thro
-000481d0: 6768 2047 5320 6f72 2052 532c 2069 6620  gh GS or RS, if 
-000481e0: 6e6f 742c 2075 7365 2069 7420 6173 2069  not, use it as i
-000481f0: 730d 0a20 2020 2020 2020 2074 7279 3a0d  s..        try:.
-00048200: 0a20 2020 2020 2020 2020 2020 2067 7320  .            gs 
-00048210: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00048220: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
-00048230: 2020 2020 6d6f 6465 6c20 3d20 6773 2e62      model = gs.b
-00048240: 6573 745f 6573 7469 6d61 746f 725f 0d0a  est_estimator_..
-00048250: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00048260: 0a20 2020 2020 2020 2020 2020 2067 7320  .            gs 
-00048270: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00048280: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
-00048290: 7072 696e 7428 2720 2020 2055 7369 6e67  print('    Using
-000482a0: 2025 7327 2025 7374 7228 6d6f 6465 6c29   %s' %str(model)
-000482b0: 2e73 706c 6974 2822 2822 295b 305d 290d  .split("(")[0]).
-000482c0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-000482d0: 2323 2320 2020 5468 6573 6520 6172 6520  ###   These are 
-000482e0: 7365 7474 696e 6773 2066 6f72 206d 616b  settings for mak
-000482f0: 696e 6720 7375 7265 2070 7265 6469 6374  ing sure predict
-00048300: 696f 6e73 2061 7320 7361 6d65 2074 7970  ions as same typ
-00048310: 6520 6173 2074 6172 6765 7420 2323 2323  e as target ####
-00048320: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00048330: 2020 2323 2320 4d61 6b65 2073 7572 6520    ### Make sure 
-00048340: 796f 7520 7365 7420 7468 6973 2066 6c61  you set this fla
-00048350: 6720 6173 2046 616c 7365 2073 6f20 7468  g as False so th
-00048360: 6174 2077 6865 6e20 656e 7365 6d62 6c69  at when ensembli
-00048370: 6e67 2069 7320 636f 6d70 6c65 7465 642c  ng is completed,
-00048380: 2074 6869 7320 666c 6167 2069 7320 5472   this flag is Tr
-00048390: 7565 2023 230d 0a20 2020 2070 6572 666f  ue ##..    perfo
-000483a0: 726d 6564 5f65 6e73 656d 626c 696e 6720  rmed_ensembling 
-000483b0: 3d20 4661 6c73 650d 0a20 2020 206d 6f64  = False..    mod
-000483c0: 6966 795f 7461 7267 6574 735f 666c 6167  ify_targets_flag
-000483d0: 203d 2046 616c 7365 0d0a 2020 2020 6966   = False..    if
-000483e0: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-000483f0: 2753 696e 676c 655f 4c61 6265 6c27 2061  'Single_Label' a
-00048400: 6e64 206d 6f64 656c 7479 7065 2021 3d20  nd modeltype != 
-00048410: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-00048420: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-00048430: 2323 2320 2020 5468 6973 2069 7320 666f  ###   This is fo
-00048440: 7220 5369 6e67 6c65 204c 6162 656c 2043  r Single Label C
-00048450: 6c61 7373 6966 6963 6174 696f 6e20 5072  lassification Pr
-00048460: 6f62 6c65 6d73 206f 6e6c 7920 2323 2323  oblems only ####
-00048470: 2323 0d0a 2020 2020 2020 2020 6d5f 7468  ##..        m_th
-00048480: 7265 7368 203d 2030 2e35 0d0a 2020 2020  resh = 0.5..    
-00048490: 2020 2020 795f 7072 6f62 6120 3d20 6d6f      y_proba = mo
-000484a0: 6465 6c2e 7072 6564 6963 745f 7072 6f62  del.predict_prob
-000484b0: 6128 585f 6376 290d 0a20 2020 2020 2020  a(X_cv)..       
-000484c0: 2079 5f70 7265 6420 3d20 6d6f 6465 6c2e   y_pred = model.
-000484d0: 7072 6564 6963 7428 585f 6376 290d 0a20  predict(X_cv).. 
-000484e0: 2020 2020 2020 2069 6620 6c65 6e28 636c         if len(cl
-000484f0: 6173 7365 7329 203c 3d20 323a 0d0a 2020  asses) <= 2:..  
-00048500: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00048510: 2746 696e 6469 6e67 2042 6573 7420 5468  'Finding Best Th
-00048520: 7265 7368 6f6c 6420 666f 7220 4869 6768  reshold for High
-00048530: 6573 7420 4631 2053 636f 7265 2e2e 2e27  est F1 Score...'
-00048540: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-00048550: 7265 6369 7369 6f6e 2c20 7265 6361 6c6c  recision, recall
-00048560: 2c20 7468 7265 7368 6f6c 6473 203d 2070  , thresholds = p
-00048570: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
-00048580: 6375 7276 6528 795f 6376 2c20 795f 7072  curve(y_cv, y_pr
-00048590: 6f62 615b 3a2c 7261 7265 5f63 6c61 7373  oba[:,rare_class
-000485a0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000485b0: 2370 7265 6369 7369 6f6e 2c20 7265 6361  #precision, reca
-000485c0: 6c6c 2c20 7468 7265 7368 6f6c 6473 203d  ll, thresholds =
-000485d0: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
-000485e0: 6c5f 6375 7276 6528 795f 6376 2c20 795f  l_curve(y_cv, y_
-000485f0: 7072 6f62 615b 3a2c 315d 290d 0a20 2020  proba[:,1])..   
-00048600: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00048610: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00048620: 3120 3d20 2832 2a70 7265 6369 7369 6f6e  1 = (2*precision
-00048630: 2a72 6563 616c 6c29 2f28 7072 6563 6973  *recall)/(precis
-00048640: 696f 6e2b 7265 6361 6c6c 290d 0a20 2020  ion+recall)..   
-00048650: 2020 2020 2020 2020 2020 2020 2066 3120               f1 
-00048660: 3d20 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  = np.nan_to_num(
-00048670: 6631 290d 0a20 2020 2020 2020 2020 2020  f1)..           
-00048680: 2020 2020 206d 5f69 6478 203d 206e 702e       m_idx = np.
-00048690: 6172 676d 6178 2866 3129 0d0a 2020 2020  argmax(f1)..    
-000486a0: 2020 2020 2020 2020 2020 2020 6d5f 7468              m_th
-000486b0: 7265 7368 203d 2074 6872 6573 686f 6c64  resh = threshold
-000486c0: 735b 6d5f 6964 785d 0d0a 2020 2020 2020  s[m_idx]..      
-000486d0: 2020 2020 2020 2020 2020 6265 7374 5f66            best_f
-000486e0: 3120 3d20 6631 5b6d 5f69 6478 5d0d 0a20  1 = f1[m_idx].. 
-000486f0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00048700: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00048710: 2020 2020 6265 7374 5f66 3120 3d20 6631      best_f1 = f1
-00048720: 5f73 636f 7265 2879 5f63 762c 2079 5f70  _score(y_cv, y_p
-00048730: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
-00048740: 2020 2020 2020 6d5f 7468 7265 7368 203d        m_thresh =
-00048750: 2030 2e35 0d0a 2020 2020 2020 2020 2020   0.5..          
-00048760: 2020 2320 7265 7472 6965 7665 206a 7573    # retrieve jus
-00048770: 7420 7468 6520 7072 6f62 6162 696c 6974  t the probabilit
-00048780: 6965 7320 666f 7220 7468 6520 706f 7369  ies for the posi
-00048790: 7469 7665 2063 6c61 7373 0d0a 2020 2020  tive class..    
-000487a0: 2020 2020 2020 2020 706f 735f 7072 6f62          pos_prob
-000487b0: 7320 3d20 795f 7072 6f62 615b 3a2c 2072  s = y_proba[:, r
-000487c0: 6172 655f 636c 6173 735d 0d0a 2020 2020  are_class]..    
-000487d0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-000487e0: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
-000487f0: 2020 2020 2020 2020 2020 2320 6372 6561            # crea
-00048800: 7465 2061 2068 6973 746f 6772 616d 206f  te a histogram o
-00048810: 6620 7468 6520 7072 6564 6963 7465 6420  f the predicted 
-00048820: 7072 6f62 6162 696c 6974 6965 7320 666f  probabilities fo
-00048830: 7220 7468 6520 5261 7265 2043 6c61 7373  r the Rare Class
-00048840: 2073 696e 6365 2069 7420 7769 6c6c 2068   since it will h
-00048850: 656c 7020 6465 6369 6465 2074 6872 6573  elp decide thres
-00048860: 686f 6c64 0d0a 2020 2020 2020 2020 2020  hold..          
-00048870: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
-00048880: 2866 6967 7369 7a65 3d28 362c 3629 290d  (figsize=(6,6)).
-00048890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000488a0: 2070 6c74 2e68 6973 7428 706f 735f 7072   plt.hist(pos_pr
-000488b0: 6f62 732c 2062 696e 733d 4269 6e73 2c20  obs, bins=Bins, 
-000488c0: 636f 6c6f 723d 2767 2729 0d0a 2020 2020  color='g')..    
-000488d0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-000488e0: 7469 746c 6528 224d 6f64 656c 2773 2050  title("Model's P
-000488f0: 7265 6469 6374 6976 6520 5072 6f62 6162  redictive Probab
-00048900: 696c 6974 7920 4869 7374 6f67 7261 6d20  ility Histogram 
-00048910: 666f 7220 5261 7265 2043 6c61 7373 3d25  for Rare Class=%
-00048920: 7320 7769 7468 2073 7567 6765 7374 6564  s with suggested
-00048930: 2074 6872 6573 686f 6c64 2069 6e20 7265   threshold in re
-00048940: 6422 2025 7261 7265 5f63 6c61 7373 5f6f  d" %rare_class_o
-00048950: 7269 6729 0d0a 2020 2020 2020 2020 2020  rig)..          
-00048960: 2020 2020 2020 706c 742e 6178 766c 696e        plt.axvlin
-00048970: 6528 783d 6d5f 7468 7265 7368 2c20 636f  e(x=m_thresh, co
-00048980: 6c6f 723d 2772 272c 206c 696e 6573 7479  lor='r', linesty
-00048990: 6c65 3d27 2d2d 2729 0d0a 2020 2020 2020  le='--')..      
-000489a0: 2020 2020 2020 2020 2020 706c 742e 7368            plt.sh
-000489b0: 6f77 2829 3b0d 0a20 2020 2020 2020 2020  ow();..         
-000489c0: 2020 2070 7269 6e74 2822 2020 2020 5573     print("    Us
-000489d0: 696e 6720 7468 7265 7368 6f6c 643d 302e  ing threshold=0.
-000489e0: 352e 2048 6f77 6576 6572 2c20 2530 2e33  5. However, %0.3
-000489f0: 6620 7072 6f76 6964 6573 2062 6574 7465  f provides bette
-00048a00: 7220 4631 3d25 302e 3266 2066 6f72 2072  r F1=%0.2f for r
-00048a10: 6172 6520 636c 6173 732e 2e2e 2220 2528  are class..." %(
-00048a20: 6d5f 7468 7265 7368 2c62 6573 745f 6631  m_thresh,best_f1
-00048a30: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00048a40: 2323 2379 5f70 7265 6420 3d20 2879 5f70  ###y_pred = (y_p
-00048a50: 726f 6261 5b3a 2c72 6172 655f 636c 6173  roba[:,rare_clas
-00048a60: 735d 3e3d 6d5f 7468 7265 7368 292e 6173  s]>=m_thresh).as
-00048a70: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-00048a80: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
-00048a90: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00048aa0: 2879 5f70 726f 6261 290d 0a20 2020 2020  (y_proba)..     
-00048ab0: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
-00048ac0: 205b 3a2c 305d 203d 2028 7072 6564 6963   [:,0] = (predic
-00048ad0: 7465 6420 5b3a 2c30 5d20 3e3d 2028 312d  ted [:,0] >= (1-
-00048ae0: 6d5f 7468 7265 7368 2929 2e61 7374 7970  m_thresh)).astyp
-00048af0: 6528 2769 6e74 2729 0d0a 2020 2020 2020  e('int')..      
-00048b00: 2020 2020 2020 7072 6564 6963 7465 6420        predicted 
-00048b10: 5b3a 2c31 5d20 3d20 2870 7265 6469 6374  [:,1] = (predict
-00048b20: 6564 205b 3a2c 315d 203e 206d 5f74 6872  ed [:,1] > m_thr
-00048b30: 6573 6829 2e61 7374 7970 6528 2769 6e74  esh).astype('int
-00048b40: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00048b50: 6966 206d 5f74 6872 6573 6820 213d 2030  if m_thresh != 0
-00048b60: 2e35 3a0d 0a20 2020 2020 2020 2020 2020  .5:..           
-00048b70: 2020 2020 2079 5f70 7265 6420 3d20 7072       y_pred = pr
-00048b80: 6564 6963 7465 645b 3a2c 7261 7265 5f63  edicted[:,rare_c
-00048b90: 6c61 7373 5d0d 0a20 2020 2020 2020 2065  lass]..        e
-00048ba0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00048bb0: 2020 2323 2323 2054 6869 7320 6973 2077    #### This is w
-00048bc0: 6865 7265 2079 6f75 2070 7265 6469 6374  here you predict
-00048bd0: 2066 6f72 204d 756c 7469 2d63 6c61 7373   for Multi-class
-00048be0: 2063 6c61 7373 6966 6963 6174 696f 6e20   classification 
-00048bf0: 6d6f 6465 6c73 2023 2323 2323 0d0a 2020  models #####..  
-00048c00: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-00048c10: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
-00048c20: 2858 5f63 7629 0d0a 2020 2020 656c 7365  (X_cv)..    else
-00048c30: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
-00048c40: 5468 6973 2069 7320 7768 6572 6520 796f  This is where yo
-00048c50: 7520 7072 6564 6963 7420 666f 7220 4d75  u predict for Mu
-00048c60: 6c74 692d 4f75 7470 7574 204d 756c 7469  lti-Output Multi
-00048c70: 2d4c 6162 656c 206d 6f64 656c 7320 2323  -Label models ##
-00048c80: 2323 230d 0a20 2020 2020 2020 2079 5f70  ###..        y_p
-00048c90: 7265 6420 3d20 6d6f 6465 6c2e 7072 6564  red = model.pred
-00048ca0: 6963 7428 585f 6376 290d 0a20 2020 2023  ict(X_cv)..    #
-00048cb0: 2323 2020 2054 6869 7320 6973 2077 6865  ##   This is whe
-00048cc0: 7265 2079 6f75 2070 7269 6e74 206f 7574  re you print out
-00048cd0: 2074 6865 2046 6972 7374 204d 6f64 656c   the First Model
-00048ce0: 2773 2052 6573 756c 7473 2023 2323 2323  's Results #####
-00048cf0: 2323 230d 0a20 2020 2070 7269 6e74 2827  ###..    print('
-00048d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048d30: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-00048d40: 2323 2323 2320 5468 6973 206e 6578 7420  ##### This next 
-00048d50: 7374 6570 2069 7320 7665 7279 2069 6d70  step is very imp
-00048d60: 6f72 7461 6e74 2073 696e 6365 2073 6f6d  ortant since som
-00048d70: 6520 6d6f 6465 6c73 2067 6976 6520 7365  e models give se
-00048d80: 7269 6573 2c20 6f74 6865 7273 2067 6976  ries, others giv
-00048d90: 6520 6172 7261 7973 2e20 5665 7279 2070  e arrays. Very p
-00048da0: 6169 6e66 756c 210d 0a20 2020 2069 6620  ainful!..    if 
-00048db0: 6973 696e 7374 616e 6365 2879 5f70 7265  isinstance(y_pre
-00048dc0: 642c 7064 2e53 6572 6965 7329 206f 7220  d,pd.Series) or 
-00048dd0: 6973 696e 7374 616e 6365 2879 5f70 7265  isinstance(y_pre
-00048de0: 642c 7064 2e44 6174 6146 7261 6d65 293a  d,pd.DataFrame):
-00048df0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
-00048e00: 203d 2079 5f70 7265 642e 7661 6c75 6573   = y_pred.values
-00048e10: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-00048e20: 6e63 6528 795f 6376 2c70 642e 5365 7269  nce(y_cv,pd.Seri
-00048e30: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
-00048e40: 6528 795f 6376 2c70 642e 4461 7461 4672  e(y_cv,pd.DataFr
-00048e50: 616d 6529 3a0d 0a20 2020 2020 2020 2079  ame):..        y
-00048e60: 5f63 7620 3d20 795f 6376 2e76 616c 7565  _cv = y_cv.value
-00048e70: 730d 0a20 2020 2070 7269 6e74 2827 2573  s..    print('%s
-00048e80: 204d 6f64 656c 2050 7265 6469 6374 696f   Model Predictio
-00048e90: 6e20 5265 7375 6c74 7320 6f6e 2048 656c  n Results on Hel
-00048ea0: 6420 4f75 7420 4356 2044 6174 6120 5365  d Out CV Data Se
-00048eb0: 743a 2720 256d 6f64 656c 5f6e 616d 6529  t:' %model_name)
-00048ec0: 0d0a 2020 2020 2323 2323 2323 204d 616b  ..    ###### Mak
-00048ed0: 6520 7375 7265 2074 6861 7420 796f 7520  e sure that you 
-00048ee0: 6368 616e 6765 2074 6865 206d 6f64 656c  change the model
-00048ef0: 2773 2070 7265 6469 6374 696f 6e73 2074  's predictions t
-00048f00: 6f20 6265 2074 6865 2073 616d 6520 7479  o be the same ty
-00048f10: 7065 2061 7320 6f72 6967 696e 616c 2074  pe as original t
-00048f20: 6172 6765 7420 2323 2323 0d0a 2020 2020  arget ####..    
-00048f30: 696e 745f 7479 7065 7320 3d20 5b6e 702e  int_types = [np.
-00048f40: 696e 7438 2c20 6e70 2e69 6e74 3136 2c20  int8, np.int16, 
-00048f50: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
-00048f60: 3634 5d0d 0a20 2020 2074 6172 6765 7473  64]..    targets
-00048f70: 5f6e 6567 6174 6976 655f 666c 6167 203d  _negative_flag =
-00048f80: 206c 656e 2879 5f63 763c 3029 203d 3d20   len(y_cv<0) == 
-00048f90: 300d 0a20 2020 2069 6620 795f 6376 2e64  0..    if y_cv.d
-00048fa0: 7479 7065 2069 6e20 696e 745f 7479 7065  type in int_type
-00048fb0: 733a 0d0a 2020 2020 2020 2020 795f 7072  s:..        y_pr
-00048fc0: 6564 203d 206d 6f64 6966 795f 6172 7261  ed = modify_arra
-00048fd0: 795f 746f 5f69 6e74 6567 6572 2879 5f70  y_to_integer(y_p
-00048fe0: 7265 642c 2074 6172 6765 7473 5f6e 6567  red, targets_neg
-00048ff0: 6174 6976 655f 666c 6167 290d 0a20 2020  ative_flag)..   
-00049000: 2020 2020 206d 6f64 6966 795f 7461 7267       modify_targ
-00049010: 6574 735f 666c 6167 203d 2054 7275 650d  ets_flag = True.
-00049020: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-00049030: 2323 2020 2020 4e20 4f20 5720 2020 5020  ##    N O W   P 
-00049040: 5220 4920 4e20 5420 2020 4120 4c20 4c20  R I N T   A L L 
-00049050: 2052 2045 2053 2055 204c 2054 2053 2023   R E S U L T S #
-00049060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049070: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
-00049080: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00049090: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-000490a0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-000490b0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-000490c0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000490d0: 6d73 6c65 5f63 616c 6375 6c61 7465 645f  msle_calculated_
-000490e0: 6d20 3d20 726d 7365 2879 5f63 762c 2079  m = rmse(y_cv, y
-000490f0: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
-00049100: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
-00049110: 7369 6f6e 5f6d 6f64 656c 5f73 7461 7473  sion_model_stats
-00049120: 2879 5f63 762c 2079 5f70 7265 642c 7461  (y_cv, y_pred,ta
-00049130: 7267 6574 2c70 6c6f 745f 6e61 6d65 3d6d  rget,plot_name=m
-00049140: 6f64 656c 5f6e 616d 6529 0d0a 2020 2020  odel_name)..    
-00049150: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00049160: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
-00049170: 6e61 6d65 203d 3d20 2746 6f72 6573 7473  name == 'Forests
-00049180: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-00049190: 2020 2020 6966 2063 616c 6962 7261 746f      if calibrato
-000491a0: 725f 666c 6167 3a0d 0a20 2020 2020 2020  r_flag:..       
-000491b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000491c0: 6e74 2827 2020 2020 4f4f 4220 5363 6f72  nt('    OOB Scor
-000491d0: 6520 3d20 2530 2e33 6627 2025 6d6f 6465  e = %0.3f' %mode
-000491e0: 6c2e 6261 7365 5f65 7374 696d 6174 6f72  l.base_estimator
-000491f0: 2e6f 6f62 5f73 636f 7265 5f29 0d0a 2020  .oob_score_)..  
-00049200: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00049210: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00049220: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00049230: 2020 2020 4f4f 4220 5363 6f72 6520 3d20      OOB Score = 
-00049240: 2530 2e33 6627 2025 6d6f 6465 6c2e 6f6f  %0.3f' %model.oo
-00049250: 625f 7363 6f72 655f 290d 0a20 2020 2020  b_score_)..     
-00049260: 2020 2020 2020 2072 6d73 6c65 5f63 616c         rmsle_cal
-00049270: 6375 6c61 7465 645f 6d20 3d20 6261 6c61  culated_m = bala
-00049280: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
-00049290: 6f72 6528 795f 6376 2c79 5f70 7265 6429  ore(y_cv,y_pred)
-000492a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000492b0: 206c 656e 2863 6c61 7373 6573 2920 3d3d   len(classes) ==
-000492c0: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
-000492d0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-000492e0: 5265 6775 6c61 7220 4163 6375 7261 6379  Regular Accuracy
-000492f0: 2053 636f 7265 203d 2025 302e 3166 2525   Score = %0.1f%%
-00049300: 2720 2528 6163 6375 7261 6379 5f73 636f  ' %(accuracy_sco
-00049310: 7265 2879 5f63 762c 795f 7072 6564 292a  re(y_cv,y_pred)*
-00049320: 3130 3029 290d 0a20 2020 2020 2020 2020  100))..         
-00049330: 2020 2020 2020 2079 5f70 726f 6261 7320         y_probas 
-00049340: 3d20 6d6f 6465 6c2e 7072 6564 6963 745f  = model.predict_
-00049350: 7072 6f62 6128 585f 6376 290d 0a20 2020  proba(X_cv)..   
-00049360: 2020 2020 2020 2020 2020 2020 2072 6d73               rms
-00049370: 6c65 5f63 616c 6375 6c61 7465 645f 6d20  le_calculated_m 
-00049380: 3d20 7072 696e 745f 636c 6173 7369 6669  = print_classifi
-00049390: 6361 7469 6f6e 5f6d 6f64 656c 5f73 7461  cation_model_sta
-000493a0: 7473 2879 5f63 762c 2079 5f70 726f 6261  ts(y_cv, y_proba
-000493b0: 732c 206d 5f74 6872 6573 6829 0d0a 2020  s, m_thresh)..  
-000493c0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-000493d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000493e0: 2023 2323 2323 2320 5573 6520 6120 6e69   ###### Use a ni
-000493f0: 6365 2063 6c61 7373 6966 6963 6174 696f  ce classificatio
-00049400: 6e20 6d61 7472 6978 2070 7269 6e74 696e  n matrix printin
-00049410: 6720 6d6f 6475 6c65 2068 6572 6520 2323  g module here ##
-00049420: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-00049430: 2020 2020 2020 2020 2079 5f70 726f 6261           y_proba
-00049440: 7320 3d20 6d6f 6465 6c2e 7072 6564 6963  s = model.predic
-00049450: 745f 7072 6f62 6128 585f 6376 290d 0a20  t_proba(X_cv).. 
-00049460: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00049470: 7269 6e74 5f63 6c61 7373 6966 6963 6174  rint_classificat
-00049480: 696f 6e5f 6d65 7472 6963 7328 795f 6376  ion_metrics(y_cv
-00049490: 2c20 795f 7072 6f62 6173 290d 0a20 2020  , y_probas)..   
-000494a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000494b0: 6e74 2863 6c61 7373 6966 6963 6174 696f  nt(classificatio
-000494c0: 6e5f 7265 706f 7274 2879 5f63 762c 795f  n_report(y_cv,y_
-000494d0: 7072 6564 2929 0d0a 2020 2020 2020 2020  pred))..        
-000494e0: 2020 2020 2020 2020 7072 696e 7428 636f          print(co
-000494f0: 6e66 7573 696f 6e5f 6d61 7472 6978 2879  nfusion_matrix(y
-00049500: 5f63 762c 2079 5f70 7265 6429 290d 0a20  _cv, y_pred)).. 
-00049510: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00049520: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00049530: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-00049540: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00049550: 2320 5468 6973 2069 7320 666f 7220 4d75  # This is for Mu
-00049560: 6c74 692d 4c61 6265 6c20 5265 6772 6573  lti-Label Regres
-00049570: 7369 6f6e 2023 2323 2323 2323 2323 2323  sion ###########
-00049580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049590: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-000495a0: 2020 2070 7269 6e74 5f72 6567 7265 7373     print_regress
-000495b0: 696f 6e5f 6d6f 6465 6c5f 7374 6174 7328  ion_model_stats(
-000495c0: 795f 6376 2c20 795f 7072 6564 2c74 6172  y_cv, y_pred,tar
-000495d0: 6765 742c 706c 6f74 5f6e 616d 653d 6d6f  get,plot_name=mo
-000495e0: 6465 6c5f 6e61 6d65 290d 0a20 2020 2020  del_name)..     
-000495f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00049600: 2020 2020 2020 795f 7072 6f62 6173 203d        y_probas =
-00049610: 206d 6f64 656c 2e70 7265 6469 6374 5f70   model.predict_p
-00049620: 726f 6261 2858 5f63 7629 0d0a 2020 2020  roba(X_cv)..    
-00049630: 2020 2020 2020 2020 2323 2323 2054 6869          #### Thi
-00049640: 7320 6973 2066 6f72 204d 756c 7469 2d4c  s is for Multi-L
-00049650: 6162 656c 2043 6c61 7373 6966 6963 6174  abel Classificat
-00049660: 696f 6e20 2323 2323 2323 2323 2323 2323  ion ############
-00049670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049680: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00049690: 2020 7072 696e 745f 636c 6173 7369 6669    print_classifi
-000496a0: 6361 7469 6f6e 5f6d 6574 7269 6373 2879  cation_metrics(y
-000496b0: 5f63 762c 2079 5f70 7265 642c 2046 616c  _cv, y_pred, Fal
-000496c0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-000496d0: 2070 7269 6e74 2863 6c61 7373 6966 6963   print(classific
-000496e0: 6174 696f 6e5f 7265 706f 7274 2879 5f63  ation_report(y_c
-000496f0: 762c 2079 5f70 7265 6420 2929 0d0a 2020  v, y_pred ))..  
-00049700: 2020 2323 2323 2323 2020 2020 2020 5345    ######      SE
-00049710: 5420 4245 5354 2050 4152 414d 4554 4552  T BEST PARAMETER
-00049720: 5320 4845 5245 2023 2323 2323 230d 0a20  S HERE ######.. 
-00049730: 2020 2023 2323 2046 696e 6420 7768 6174     ### Find what
-00049740: 2074 6865 206f 7264 6572 206f 6620 6265   the order of be
-00049750: 7374 2070 6172 616d 7320 6172 6520 616e  st params are an
-00049760: 6420 7365 7420 7468 6520 7361 6d65 2061  d set the same a
-00049770: 7320 7468 6520 6f72 6967 696e 616c 206d  s the original m
-00049780: 6f64 656c 2023 2323 0d0a 2020 2020 2323  odel ###..    ##
-00049790: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
-000497a0: 6520 7365 7420 7468 6520 6265 7374 2070  e set the best p
-000497b0: 6172 616d 6574 6572 7320 6672 6f6d 2074  arameters from t
-000497c0: 7261 696e 696e 6720 746f 2074 6865 206d  raining to the m
-000497d0: 6f64 656c 2023 2323 230d 0a20 2020 2069  odel ####..    i
-000497e0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-000497f0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
-00049800: 0d0a 2020 2020 2020 2020 2323 2323 2059  ..        #### Y
-00049810: 6f75 2064 6f20 656e 7365 6d62 6c69 6e67  ou do ensembling
-00049820: 206f 7220 7374 6163 6b69 6e67 206f 6e6c   or stacking onl
-00049830: 7920 666f 7220 5369 6e67 6c65 5f4c 6162  y for Single_Lab
-00049840: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
-00049850: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
-00049860: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00049870: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-00049880: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00049890: 6e6f 7420 5374 6163 6b69 6e67 5f46 6c61  not Stacking_Fla
-000498a0: 6720 616e 6420 585f 7472 6169 6e2e 7368  g and X_train.sh
-000498b0: 6170 655b 305d 203c 3d20 656e 7365 6d62  ape[0] <= ensemb
-000498c0: 6c65 5f6d 6178 5f72 6f77 733a 0d0a 2020  le_max_rows:..  
-000498d0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000498e0: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-000498f0: 2323 2323 2323 2045 204e 2053 2045 204d  ###### E N S E M
-00049900: 2042 204c 2045 2020 4d20 4f20 4420 4520   B L E  M O D E 
-00049910: 4c20 2023 2323 2323 2323 2323 2323 2323  L  #############
-00049920: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
-00049930: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00049940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049950: 2020 2063 6f6c 7320 3d20 5b5d 0d0a 2020     cols = []..  
-00049960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049970: 2020 7375 626d 203d 2070 642e 4461 7461    subm = pd.Data
-00049980: 4672 616d 6528 290d 0a20 2020 2020 2020  Frame()..       
-00049990: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-000499a0: 2320 5468 6973 2069 7320 666f 7220 456e  # This is for En
-000499b0: 7365 6d62 6c69 6e67 2020 4f6e 6c79 2023  sembling  Only #
-000499c0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-000499d0: 2020 2020 2020 2020 2020 6d6f 6465 6c73            models
-000499e0: 5f6c 6973 742c 2063 765f 656e 7365 6d62  _list, cv_ensemb
-000499f0: 6c65 7320 3d20 5175 6963 6b4d 4c5f 456e  les = QuickML_En
-00049a00: 7365 6d62 6c69 6e67 2858 5f74 7261 696e  sembling(X_train
-00049a10: 2c20 795f 7472 6169 6e2c 2058 5f63 762c  , y_train, X_cv,
-00049a20: 2079 5f63 762c 0d0a 2020 2020 2020 2020   y_cv,..        
-00049a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049a50: 2020 2020 2020 6d6f 6465 6c74 7970 653d        modeltype=
-00049a60: 6d6f 6465 6c74 7970 652c 2042 6f6f 7374  modeltype, Boost
-00049a70: 696e 675f 466c 6167 3d42 6f6f 7374 696e  ing_Flag=Boostin
-00049a80: 675f 466c 6167 2c0d 0a20 2020 2020 2020  g_Flag,..       
-00049a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ab0: 2020 2020 2020 2020 7363 6f72 696e 673d          scoring=
-00049ac0: 2727 2c20 7665 7262 6f73 653d 7665 7262  '', verbose=verb
-00049ad0: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
-00049ae0: 2020 2020 2020 2020 2020 6d6f 6465 6c73            models
-00049af0: 5f6c 6973 742e 6170 7065 6e64 286d 6f64  _list.append(mod
-00049b00: 656c 5f6e 616d 6529 0d0a 2020 2020 2020  el_name)..      
-00049b10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00049b20: 7220 6d6f 6465 6c73 2c20 6561 6368 2069  r models, each i
-00049b30: 6e20 7a69 7028 6d6f 6465 6c73 5f6c 6973  n zip(models_lis
-00049b40: 742c 2072 616e 6765 286c 656e 286d 6f64  t, range(len(mod
-00049b50: 656c 735f 6c69 7374 2929 293a 0d0a 2020  els_list))):..  
-00049b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049b70: 2020 2020 2020 6e65 775f 636f 6c20 3d20        new_col = 
-00049b80: 6561 6368 5f74 6172 6765 742b 275f 272b  each_target+'_'+
-00049b90: 6d6f 6465 6c73 2b27 5f70 7265 6469 6374  models+'_predict
-00049ba0: 696f 6e73 270d 0a20 2020 2020 2020 2020  ions'..         
-00049bb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00049bc0: 6620 6561 6368 2b31 203d 3d20 6c65 6e28  f each+1 == len(
-00049bd0: 6d6f 6465 6c73 5f6c 6973 7429 3a0d 0a20  models_list):.. 
-00049be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049bf0: 2020 2020 2020 2020 2020 2073 7562 6d5b             subm[
-00049c00: 6e65 775f 636f 6c5d 203d 2079 5f70 7265  new_col] = y_pre
-00049c10: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
-00049c20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00049c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00049c40: 2020 2020 2020 2020 2020 2020 2020 7375                su
-00049c50: 626d 5b6e 6577 5f63 6f6c 5d20 3d20 6376  bm[new_col] = cv
-00049c60: 5f65 6e73 656d 626c 6573 5b3a 2c65 6163  _ensembles[:,eac
-00049c70: 685d 0d0a 2020 2020 2020 2020 2020 2020  h]..            
-00049c80: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00049c90: 2e61 7070 656e 6428 6e65 775f 636f 6c29  .append(new_col)
-00049ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00049cb0: 2020 2020 2020 6966 206c 656e 2863 6f6c        if len(col
-00049cc0: 7329 203d 3d20 353a 0d0a 2020 2020 2020  s) == 5:..      
+00047e50: 2020 795f 6675 6c20 3d20 795f 7472 6169    y_ful = y_trai
+00047e60: 6e2e 6170 7065 6e64 2879 5f63 7629 0d0a  n.append(y_cv)..
+00047e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047e80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00047e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047ea0: 2020 2058 5f66 756c 203d 206e 702e 725f     X_ful = np.r_
+00047eb0: 5b58 5f74 7261 696e 2c20 585f 6376 5d0d  [X_train, X_cv].
+00047ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047ed0: 2020 2020 2020 2020 2079 5f66 756c 203d           y_ful =
+00047ee0: 206e 702e 725f 5b79 5f74 7261 696e 2c20   np.r_[y_train, 
+00047ef0: 795f 6376 5d0d 0a20 2020 2020 2020 2020  y_cv]..         
+00047f00: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00047f10: 2e66 6974 2858 5f66 756c 2c20 795f 6675  .fit(X_ful, y_fu
+00047f20: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+00047f30: 2020 2020 2020 2020 7072 696e 7428 2755          print('U
+00047f40: 7369 6e67 2061 2043 616c 6962 7261 7465  sing a Calibrate
+00047f50: 6420 436c 6173 7369 6669 6572 2069 6e20  d Classifier in 
+00047f60: 7468 6973 204d 756c 7469 5f43 6c61 7373  this Multi_Class
+00047f70: 6966 6963 6174 696f 6e20 6461 7461 7365  ification datase
+00047f80: 7420 746f 2069 6d70 726f 7665 2072 6573  t to improve res
+00047f90: 756c 7473 2e2e 2e27 290d 0a20 2020 2020  ults...')..     
+00047fa0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00047fb0: 6620 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77  f model_name.low
+00047fc0: 6572 2829 203d 3d20 2266 6f72 6573 7473  er() == "forests
+00047fd0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00047fe0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00047ff0: 4578 7472 6120 4361 6c69 6272 6174 696f  Extra Calibratio
+00048000: 6e20 776f 726b 7320 7765 6c6c 206f 6e6c  n works well onl
+00048010: 7920 666f 7220 7261 6e64 6f6d 2066 6f72  y for random for
+00048020: 6573 7473 2e20 5468 6520 7265 7374 2061  ests. The rest a
+00048030: 7265 2061 6c72 6561 6479 2064 6563 656e  re already decen
+00048040: 742e 0d0a 2020 2020 2020 2020 2020 2020  t...            
+00048050: 2020 2020 2020 2020 2020 2020 6361 6c69              cali
+00048060: 6272 6174 6f72 5f66 6c61 6720 3d20 5472  brator_flag = Tr
+00048070: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00048080: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00048090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000480a0: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
+000480b0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+000480c0: 2020 2020 2020 656c 6966 206d 6f64 656c        elif model
+000480d0: 5f6c 6162 656c 203d 3d20 274d 756c 7469  _label == 'Multi
+000480e0: 5f4c 6162 656c 2720 616e 6420 6d6f 6465  _Label' and mode
+000480f0: 6c74 7970 6520 3d3d 2027 4269 6e61 7279  ltype == 'Binary
+00048100: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+00048110: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00048120: 2020 2070 7269 6e74 2827 2020 2020 4e6f     print('    No
+00048130: 2047 7269 6453 6561 7263 6820 6f72 2052   GridSearch or R
+00048140: 616e 646f 6d69 7a65 6453 6561 7263 6820  andomizedSearch 
+00048150: 666f 7220 2573 2025 7320 7369 6e63 6520  for %s %s since 
+00048160: 6974 2074 616b 6573 2074 6f6f 206c 6f6e  it takes too lon
+00048170: 6727 2025 280d 0a20 2020 2020 2020 2020  g' %(..         
+00048180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048190: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+000481a0: 5f6c 6162 656c 2c6d 6f64 656c 7479 7065  _label,modeltype
+000481b0: 2929 0d0a 2020 2020 2020 2020 2369 6620  ))..        #if 
+000481c0: 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77 6572  model_name.lower
+000481d0: 2829 203d 3d20 2763 6174 626f 6f73 7427  () == 'catboost'
+000481e0: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+000481f0: 7072 696e 7428 2742 6573 7420 4d6f 6465  print('Best Mode
+00048200: 6c20 7365 6c65 6374 6564 2061 6e64 2069  l selected and i
+00048210: 7473 2070 6172 616d 6574 6572 7320 6172  ts parameters ar
+00048220: 653a 5c6e 2020 2020 2573 2720 256d 6f64  e:\n    %s' %mod
+00048230: 656c 2e67 6574 5f61 6c6c 5f70 6172 616d  el.get_all_param
+00048240: 7328 2929 0d0a 2020 2020 2020 2020 2365  s())..        #e
+00048250: 6c73 653a 0d0a 2020 2020 2020 2020 2320  lse:..        # 
+00048260: 2020 2070 7269 6e74 2827 4265 7374 204d     print('Best M
+00048270: 6f64 656c 2073 656c 6563 7465 6420 616e  odel selected an
+00048280: 6420 6974 7320 6174 7472 6962 7574 6573  d its attributes
+00048290: 2061 7265 3a5c 6e20 2020 2025 7327 2025   are:\n    %s' %
+000482a0: 6d6f 6465 6c29 0d0a 2020 2020 656c 7365  model)..    else
+000482b0: 3a0d 0a20 2020 2020 2020 2023 2323 2323  :..        #####
+000482c0: 2323 2320 4966 2074 6869 7320 6973 2061  ### If this is a
+000482d0: 206d 756c 7469 2d6c 6162 656c 206d 6f64   multi-label mod
+000482e0: 656c 2c20 7472 7920 746f 2073 6565 2069  el, try to see i
+000482f0: 6620 6974 2077 656e 7420 7468 726f 6768  f it went throgh
+00048300: 2047 5320 6f72 2052 532c 2069 6620 6e6f   GS or RS, if no
+00048310: 742c 2075 7365 2069 7420 6173 2069 730d  t, use it as is.
+00048320: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
+00048330: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
+00048340: 636f 7079 2e64 6565 7063 6f70 7928 6d6f  copy.deepcopy(mo
+00048350: 6465 6c29 0d0a 2020 2020 2020 2020 2020  del)..          
+00048360: 2020 6d6f 6465 6c20 3d20 6773 2e62 6573    model = gs.bes
+00048370: 745f 6573 7469 6d61 746f 725f 0d0a 2020  t_estimator_..  
+00048380: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+00048390: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
+000483a0: 636f 7079 2e64 6565 7063 6f70 7928 6d6f  copy.deepcopy(mo
+000483b0: 6465 6c29 0d0a 2020 2020 2020 2020 7072  del)..        pr
+000483c0: 696e 7428 2720 2020 2055 7369 6e67 2025  int('    Using %
+000483d0: 7327 2025 7374 7228 6d6f 6465 6c29 2e73  s' %str(model).s
+000483e0: 706c 6974 2822 2822 295b 305d 290d 0a20  plit("(")[0]).. 
+000483f0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00048400: 2320 2020 5468 6573 6520 6172 6520 7365  #   These are se
+00048410: 7474 696e 6773 2066 6f72 206d 616b 696e  ttings for makin
+00048420: 6720 7375 7265 2070 7265 6469 6374 696f  g sure predictio
+00048430: 6e73 2061 7320 7361 6d65 2074 7970 6520  ns as same type 
+00048440: 6173 2074 6172 6765 7420 2323 2323 2323  as target ######
+00048450: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00048460: 2323 2320 4d61 6b65 2073 7572 6520 796f  ### Make sure yo
+00048470: 7520 7365 7420 7468 6973 2066 6c61 6720  u set this flag 
+00048480: 6173 2046 616c 7365 2073 6f20 7468 6174  as False so that
+00048490: 2077 6865 6e20 656e 7365 6d62 6c69 6e67   when ensembling
+000484a0: 2069 7320 636f 6d70 6c65 7465 642c 2074   is completed, t
+000484b0: 6869 7320 666c 6167 2069 7320 5472 7565  his flag is True
+000484c0: 2023 230d 0a20 2020 2070 6572 666f 726d   ##..    perform
+000484d0: 6564 5f65 6e73 656d 626c 696e 6720 3d20  ed_ensembling = 
+000484e0: 4661 6c73 650d 0a20 2020 206d 6f64 6966  False..    modif
+000484f0: 795f 7461 7267 6574 735f 666c 6167 203d  y_targets_flag =
+00048500: 2046 616c 7365 0d0a 2020 2020 6966 206d   False..    if m
+00048510: 6f64 656c 5f6c 6162 656c 203d 3d20 2753  odel_label == 'S
+00048520: 696e 676c 655f 4c61 6265 6c27 2061 6e64  ingle_Label' and
+00048530: 206d 6f64 656c 7479 7065 2021 3d20 2752   modeltype != 'R
+00048540: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00048550: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+00048560: 2320 2020 5468 6973 2069 7320 666f 7220  #   This is for 
+00048570: 5369 6e67 6c65 204c 6162 656c 2043 6c61  Single Label Cla
+00048580: 7373 6966 6963 6174 696f 6e20 5072 6f62  ssification Prob
+00048590: 6c65 6d73 206f 6e6c 7920 2323 2323 2323  lems only ######
+000485a0: 0d0a 2020 2020 2020 2020 6d5f 7468 7265  ..        m_thre
+000485b0: 7368 203d 2030 2e35 0d0a 2020 2020 2020  sh = 0.5..      
+000485c0: 2020 795f 7072 6f62 6120 3d20 6d6f 6465    y_proba = mode
+000485d0: 6c2e 7072 6564 6963 745f 7072 6f62 6128  l.predict_proba(
+000485e0: 585f 6376 290d 0a20 2020 2020 2020 2079  X_cv)..        y
+000485f0: 5f70 7265 6420 3d20 6d6f 6465 6c2e 7072  _pred = model.pr
+00048600: 6564 6963 7428 585f 6376 290d 0a20 2020  edict(X_cv)..   
+00048610: 2020 2020 2069 6620 6c65 6e28 636c 6173       if len(clas
+00048620: 7365 7329 203c 3d20 323a 0d0a 2020 2020  ses) <= 2:..    
+00048630: 2020 2020 2020 2020 7072 696e 7428 2746          print('F
+00048640: 696e 6469 6e67 2042 6573 7420 5468 7265  inding Best Thre
+00048650: 7368 6f6c 6420 666f 7220 4869 6768 6573  shold for Highes
+00048660: 7420 4631 2053 636f 7265 2e2e 2e27 290d  t F1 Score...').
+00048670: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00048680: 6369 7369 6f6e 2c20 7265 6361 6c6c 2c20  cision, recall, 
+00048690: 7468 7265 7368 6f6c 6473 203d 2070 7265  thresholds = pre
+000486a0: 6369 7369 6f6e 5f72 6563 616c 6c5f 6375  cision_recall_cu
+000486b0: 7276 6528 795f 6376 2c20 795f 7072 6f62  rve(y_cv, y_prob
+000486c0: 615b 3a2c 7261 7265 5f63 6c61 7373 5d29  a[:,rare_class])
+000486d0: 0d0a 2020 2020 2020 2020 2020 2020 2370  ..            #p
+000486e0: 7265 6369 7369 6f6e 2c20 7265 6361 6c6c  recision, recall
+000486f0: 2c20 7468 7265 7368 6f6c 6473 203d 2070  , thresholds = p
+00048700: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
+00048710: 6375 7276 6528 795f 6376 2c20 795f 7072  curve(y_cv, y_pr
+00048720: 6f62 615b 3a2c 315d 290d 0a20 2020 2020  oba[:,1])..     
+00048730: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00048740: 2020 2020 2020 2020 2020 2020 2066 3120               f1 
+00048750: 3d20 2832 2a70 7265 6369 7369 6f6e 2a72  = (2*precision*r
+00048760: 6563 616c 6c29 2f28 7072 6563 6973 696f  ecall)/(precisio
+00048770: 6e2b 7265 6361 6c6c 290d 0a20 2020 2020  n+recall)..     
+00048780: 2020 2020 2020 2020 2020 2066 3120 3d20             f1 = 
+00048790: 6e70 2e6e 616e 5f74 6f5f 6e75 6d28 6631  np.nan_to_num(f1
+000487a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000487b0: 2020 206d 5f69 6478 203d 206e 702e 6172     m_idx = np.ar
+000487c0: 676d 6178 2866 3129 0d0a 2020 2020 2020  gmax(f1)..      
+000487d0: 2020 2020 2020 2020 2020 6d5f 7468 7265            m_thre
+000487e0: 7368 203d 2074 6872 6573 686f 6c64 735b  sh = thresholds[
+000487f0: 6d5f 6964 785d 0d0a 2020 2020 2020 2020  m_idx]..        
+00048800: 2020 2020 2020 2020 6265 7374 5f66 3120          best_f1 
+00048810: 3d20 6631 5b6d 5f69 6478 5d0d 0a20 2020  = f1[m_idx]..   
+00048820: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00048830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00048840: 2020 6265 7374 5f66 3120 3d20 6631 5f73    best_f1 = f1_s
+00048850: 636f 7265 2879 5f63 762c 2079 5f70 7265  core(y_cv, y_pre
+00048860: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+00048870: 2020 2020 6d5f 7468 7265 7368 203d 2030      m_thresh = 0
+00048880: 2e35 0d0a 2020 2020 2020 2020 2020 2020  .5..            
+00048890: 2320 7265 7472 6965 7665 206a 7573 7420  # retrieve just 
+000488a0: 7468 6520 7072 6f62 6162 696c 6974 6965  the probabilitie
+000488b0: 7320 666f 7220 7468 6520 706f 7369 7469  s for the positi
+000488c0: 7665 2063 6c61 7373 0d0a 2020 2020 2020  ve class..      
+000488d0: 2020 2020 2020 706f 735f 7072 6f62 7320        pos_probs 
+000488e0: 3d20 795f 7072 6f62 615b 3a2c 2072 6172  = y_proba[:, rar
+000488f0: 655f 636c 6173 735d 0d0a 2020 2020 2020  e_class]..      
+00048900: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00048910: 203e 3d20 313a 0d0a 2020 2020 2020 2020   >= 1:..        
+00048920: 2020 2020 2020 2020 2320 6372 6561 7465          # create
+00048930: 2061 2068 6973 746f 6772 616d 206f 6620   a histogram of 
+00048940: 7468 6520 7072 6564 6963 7465 6420 7072  the predicted pr
+00048950: 6f62 6162 696c 6974 6965 7320 666f 7220  obabilities for 
+00048960: 7468 6520 5261 7265 2043 6c61 7373 2073  the Rare Class s
+00048970: 696e 6365 2069 7420 7769 6c6c 2068 656c  ince it will hel
+00048980: 7020 6465 6369 6465 2074 6872 6573 686f  p decide thresho
+00048990: 6c64 0d0a 2020 2020 2020 2020 2020 2020  ld..            
+000489a0: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+000489b0: 6967 7369 7a65 3d28 362c 3629 290d 0a20  igsize=(6,6)).. 
+000489c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000489d0: 6c74 2e68 6973 7428 706f 735f 7072 6f62  lt.hist(pos_prob
+000489e0: 732c 2062 696e 733d 4269 6e73 2c20 636f  s, bins=Bins, co
+000489f0: 6c6f 723d 2767 2729 0d0a 2020 2020 2020  lor='g')..      
+00048a00: 2020 2020 2020 2020 2020 706c 742e 7469            plt.ti
+00048a10: 746c 6528 224d 6f64 656c 2773 2050 7265  tle("Model's Pre
+00048a20: 6469 6374 6976 6520 5072 6f62 6162 696c  dictive Probabil
+00048a30: 6974 7920 4869 7374 6f67 7261 6d20 666f  ity Histogram fo
+00048a40: 7220 5261 7265 2043 6c61 7373 3d25 7320  r Rare Class=%s 
+00048a50: 7769 7468 2073 7567 6765 7374 6564 2074  with suggested t
+00048a60: 6872 6573 686f 6c64 2069 6e20 7265 6422  hreshold in red"
+00048a70: 2025 7261 7265 5f63 6c61 7373 5f6f 7269   %rare_class_ori
+00048a80: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
+00048a90: 2020 2020 706c 742e 6178 766c 696e 6528      plt.axvline(
+00048aa0: 783d 6d5f 7468 7265 7368 2c20 636f 6c6f  x=m_thresh, colo
+00048ab0: 723d 2772 272c 206c 696e 6573 7479 6c65  r='r', linestyle
+00048ac0: 3d27 2d2d 2729 0d0a 2020 2020 2020 2020  ='--')..        
+00048ad0: 2020 2020 2020 2020 706c 742e 7368 6f77          plt.show
+00048ae0: 2829 3b0d 0a20 2020 2020 2020 2020 2020  ();..           
+00048af0: 2070 7269 6e74 2822 2020 2020 5573 696e   print("    Usin
+00048b00: 6720 7468 7265 7368 6f6c 643d 302e 352e  g threshold=0.5.
+00048b10: 2048 6f77 6576 6572 2c20 2530 2e33 6620   However, %0.3f 
+00048b20: 7072 6f76 6964 6573 2062 6574 7465 7220  provides better 
+00048b30: 4631 3d25 302e 3266 2066 6f72 2072 6172  F1=%0.2f for rar
+00048b40: 6520 636c 6173 732e 2e2e 2220 2528 6d5f  e class..." %(m_
+00048b50: 7468 7265 7368 2c62 6573 745f 6631 2929  thresh,best_f1))
+00048b60: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00048b70: 2379 5f70 7265 6420 3d20 2879 5f70 726f  #y_pred = (y_pro
+00048b80: 6261 5b3a 2c72 6172 655f 636c 6173 735d  ba[:,rare_class]
+00048b90: 3e3d 6d5f 7468 7265 7368 292e 6173 7479  >=m_thresh).asty
+00048ba0: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
+00048bb0: 2020 2020 2070 7265 6469 6374 6564 203d       predicted =
+00048bc0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
+00048bd0: 5f70 726f 6261 290d 0a20 2020 2020 2020  _proba)..       
+00048be0: 2020 2020 2070 7265 6469 6374 6564 205b       predicted [
+00048bf0: 3a2c 305d 203d 2028 7072 6564 6963 7465  :,0] = (predicte
+00048c00: 6420 5b3a 2c30 5d20 3e3d 2028 312d 6d5f  d [:,0] >= (1-m_
+00048c10: 7468 7265 7368 2929 2e61 7374 7970 6528  thresh)).astype(
+00048c20: 2769 6e74 2729 0d0a 2020 2020 2020 2020  'int')..        
+00048c30: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
+00048c40: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
+00048c50: 205b 3a2c 315d 203e 206d 5f74 6872 6573   [:,1] > m_thres
+00048c60: 6829 2e61 7374 7970 6528 2769 6e74 2729  h).astype('int')
+00048c70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00048c80: 206d 5f74 6872 6573 6820 213d 2030 2e35   m_thresh != 0.5
+00048c90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00048ca0: 2020 2079 5f70 7265 6420 3d20 7072 6564     y_pred = pred
+00048cb0: 6963 7465 645b 3a2c 7261 7265 5f63 6c61  icted[:,rare_cla
+00048cc0: 7373 5d0d 0a20 2020 2020 2020 2065 6c73  ss]..        els
+00048cd0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00048ce0: 2323 2323 2054 6869 7320 6973 2077 6865  #### This is whe
+00048cf0: 7265 2079 6f75 2070 7265 6469 6374 2066  re you predict f
+00048d00: 6f72 204d 756c 7469 2d63 6c61 7373 2063  or Multi-class c
+00048d10: 6c61 7373 6966 6963 6174 696f 6e20 6d6f  lassification mo
+00048d20: 6465 6c73 2023 2323 2323 0d0a 2020 2020  dels #####..    
+00048d30: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
+00048d40: 206d 6f64 656c 2e70 7265 6469 6374 2858   model.predict(X
+00048d50: 5f63 7629 0d0a 2020 2020 656c 7365 3a0d  _cv)..    else:.
+00048d60: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
+00048d70: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
+00048d80: 7072 6564 6963 7420 666f 7220 4d75 6c74  predict for Mult
+00048d90: 692d 4f75 7470 7574 204d 756c 7469 2d4c  i-Output Multi-L
+00048da0: 6162 656c 206d 6f64 656c 7320 2323 2323  abel models ####
+00048db0: 230d 0a20 2020 2020 2020 2079 5f70 7265  #..        y_pre
+00048dc0: 6420 3d20 6d6f 6465 6c2e 7072 6564 6963  d = model.predic
+00048dd0: 7428 585f 6376 290d 0a20 2020 2023 2323  t(X_cv)..    ###
+00048de0: 2020 2054 6869 7320 6973 2077 6865 7265     This is where
+00048df0: 2079 6f75 2070 7269 6e74 206f 7574 2074   you print out t
+00048e00: 6865 2046 6972 7374 204d 6f64 656c 2773  he First Model's
+00048e10: 2052 6573 756c 7473 2023 2323 2323 2323   Results #######
+00048e20: 230d 0a20 2020 2070 7269 6e74 2827 2323  #..    print('##
+00048e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00048e60: 2323 2323 2323 2729 0d0a 2020 2020 2323  ######')..    ##
+00048e70: 2323 2320 5468 6973 206e 6578 7420 7374  ### This next st
+00048e80: 6570 2069 7320 7665 7279 2069 6d70 6f72  ep is very impor
+00048e90: 7461 6e74 2073 696e 6365 2073 6f6d 6520  tant since some 
+00048ea0: 6d6f 6465 6c73 2067 6976 6520 7365 7269  models give seri
+00048eb0: 6573 2c20 6f74 6865 7273 2067 6976 6520  es, others give 
+00048ec0: 6172 7261 7973 2e20 5665 7279 2070 6169  arrays. Very pai
+00048ed0: 6e66 756c 210d 0a20 2020 2069 6620 6973  nful!..    if is
+00048ee0: 696e 7374 616e 6365 2879 5f70 7265 642c  instance(y_pred,
+00048ef0: 7064 2e53 6572 6965 7329 206f 7220 6973  pd.Series) or is
+00048f00: 696e 7374 616e 6365 2879 5f70 7265 642c  instance(y_pred,
+00048f10: 7064 2e44 6174 6146 7261 6d65 293a 0d0a  pd.DataFrame):..
+00048f20: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
+00048f30: 2079 5f70 7265 642e 7661 6c75 6573 0d0a   y_pred.values..
+00048f40: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00048f50: 6528 795f 6376 2c70 642e 5365 7269 6573  e(y_cv,pd.Series
+00048f60: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
+00048f70: 795f 6376 2c70 642e 4461 7461 4672 616d  y_cv,pd.DataFram
+00048f80: 6529 3a0d 0a20 2020 2020 2020 2079 5f63  e):..        y_c
+00048f90: 7620 3d20 795f 6376 2e76 616c 7565 730d  v = y_cv.values.
+00048fa0: 0a20 2020 2070 7269 6e74 2827 2573 204d  .    print('%s M
+00048fb0: 6f64 656c 2050 7265 6469 6374 696f 6e20  odel Prediction 
+00048fc0: 5265 7375 6c74 7320 6f6e 2048 656c 6420  Results on Held 
+00048fd0: 4f75 7420 4356 2044 6174 6120 5365 743a  Out CV Data Set:
+00048fe0: 2720 256d 6f64 656c 5f6e 616d 6529 0d0a  ' %model_name)..
+00048ff0: 2020 2020 2323 2323 2323 204d 616b 6520      ###### Make 
+00049000: 7375 7265 2074 6861 7420 796f 7520 6368  sure that you ch
+00049010: 616e 6765 2074 6865 206d 6f64 656c 2773  ange the model's
+00049020: 2070 7265 6469 6374 696f 6e73 2074 6f20   predictions to 
+00049030: 6265 2074 6865 2073 616d 6520 7479 7065  be the same type
+00049040: 2061 7320 6f72 6967 696e 616c 2074 6172   as original tar
+00049050: 6765 7420 2323 2323 0d0a 2020 2020 696e  get ####..    in
+00049060: 745f 7479 7065 7320 3d20 5b6e 702e 696e  t_types = [np.in
+00049070: 7438 2c20 6e70 2e69 6e74 3136 2c20 6e70  t8, np.int16, np
+00049080: 2e69 6e74 3332 2c20 6e70 2e69 6e74 3634  .int32, np.int64
+00049090: 5d0d 0a20 2020 2074 6172 6765 7473 5f6e  ]..    targets_n
+000490a0: 6567 6174 6976 655f 666c 6167 203d 206c  egative_flag = l
+000490b0: 656e 2879 5f63 763c 3029 203d 3d20 300d  en(y_cv<0) == 0.
+000490c0: 0a20 2020 2069 6620 795f 6376 2e64 7479  .    if y_cv.dty
+000490d0: 7065 2069 6e20 696e 745f 7479 7065 733a  pe in int_types:
+000490e0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+000490f0: 203d 206d 6f64 6966 795f 6172 7261 795f   = modify_array_
+00049100: 746f 5f69 6e74 6567 6572 2879 5f70 7265  to_integer(y_pre
+00049110: 642c 2074 6172 6765 7473 5f6e 6567 6174  d, targets_negat
+00049120: 6976 655f 666c 6167 290d 0a20 2020 2020  ive_flag)..     
+00049130: 2020 206d 6f64 6966 795f 7461 7267 6574     modify_target
+00049140: 735f 666c 6167 203d 2054 7275 650d 0a20  s_flag = True.. 
+00049150: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00049160: 2020 2020 4e20 4f20 5720 2020 5020 5220      N O W   P R 
+00049170: 4920 4e20 5420 2020 4120 4c20 4c20 2052  I N T   A L L  R
+00049180: 2045 2053 2055 204c 2054 2053 2023 2323   E S U L T S ###
+00049190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000491a0: 230d 0a20 2020 2069 6620 6d6f 6465 6c5f  #..    if model_
+000491b0: 6c61 6265 6c20 3d3d 2027 5369 6e67 6c65  label == 'Single
+000491c0: 5f4c 6162 656c 273a 0d0a 2020 2020 2020  _Label':..      
+000491d0: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+000491e0: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
+000491f0: 0a20 2020 2020 2020 2020 2020 2072 6d73  .            rms
+00049200: 6c65 5f63 616c 6375 6c61 7465 645f 6d20  le_calculated_m 
+00049210: 3d20 726d 7365 2879 5f63 762c 2079 5f70  = rmse(y_cv, y_p
+00049220: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
+00049230: 2020 7072 696e 745f 7265 6772 6573 7369    print_regressi
+00049240: 6f6e 5f6d 6f64 656c 5f73 7461 7473 2879  on_model_stats(y
+00049250: 5f63 762c 2079 5f70 7265 642c 7461 7267  _cv, y_pred,targ
+00049260: 6574 2c70 6c6f 745f 6e61 6d65 3d6d 6f64  et,plot_name=mod
+00049270: 656c 5f6e 616d 6529 0d0a 2020 2020 2020  el_name)..      
+00049280: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00049290: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
+000492a0: 6d65 203d 3d20 2746 6f72 6573 7473 273a  me == 'Forests':
+000492b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000492c0: 2020 6966 2063 616c 6962 7261 746f 725f    if calibrator_
+000492d0: 666c 6167 3a0d 0a20 2020 2020 2020 2020  flag:..         
+000492e0: 2020 2020 2020 2020 2020 2069 6620 4c6f             if Lo
+000492f0: 6f73 6556 6572 7369 6f6e 2873 6b6c 6561  oseVersion(sklea
+00049300: 726e 2e5f 5f76 6572 7369 6f6e 5f5f 2920  rn.__version__) 
+00049310: 3c3d 204c 6f6f 7365 5665 7273 696f 6e28  <= LooseVersion(
+00049320: 2730 2e32 342e 3227 293a 0d0a 2020 2020  '0.24.2'):..    
+00049330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049340: 2020 2020 2320 5065 7266 6f72 6d20 6163      # Perform ac
+00049350: 7469 6f6e 2066 6f72 2073 6369 6b69 742d  tion for scikit-
+00049360: 6c65 6172 6e20 7665 7273 696f 6e20 6265  learn version be
+00049370: 6c6f 7720 302e 3234 2e32 0d0a 2020 2020  low 0.24.2..    
+00049380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049390: 2020 2020 2320 4164 6420 796f 7572 2063      # Add your c
+000493a0: 6f64 6520 6865 7265 2066 6f72 2073 6369  ode here for sci
+000493b0: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+000493c0: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
+000493d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000493e0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+000493f0: 2020 204f 4f42 2053 636f 7265 203d 2025     OOB Score = %
+00049400: 302e 3366 2720 256d 6f64 656c 2e62 6173  0.3f' %model.bas
+00049410: 655f 6573 7469 6d61 746f 722e 6f6f 625f  e_estimator.oob_
+00049420: 7363 6f72 655f 290d 0a20 2020 2020 2020  score_)..       
+00049430: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00049440: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00049450: 2020 2020 2020 2020 2020 2020 2320 5065              # Pe
+00049460: 7266 6f72 6d20 6163 7469 6f6e 2066 6f72  rform action for
+00049470: 2073 6369 6b69 742d 6c65 6172 6e20 7665   scikit-learn ve
+00049480: 7273 696f 6e20 302e 3234 2e32 2061 6e64  rsion 0.24.2 and
+00049490: 2061 626f 7665 0d0a 2020 2020 2020 2020   above..        
+000494a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000494b0: 2320 4164 6420 796f 7572 2063 6f64 6520  # Add your code 
+000494c0: 6865 7265 2066 6f72 2073 6369 6b69 742d  here for scikit-
+000494d0: 6c65 6172 6e20 7665 7273 696f 6e20 302e  learn version 0.
+000494e0: 3234 2e32 2061 6e64 2061 626f 7665 0d0a  24.2 and above..
+000494f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049500: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00049510: 2020 204f 4f42 2053 636f 7265 203d 2025     OOB Score = %
+00049520: 302e 3366 2720 256d 6f64 656c 2e65 7374  0.3f' %model.est
+00049530: 696d 6174 6f72 2e6f 6f62 5f73 636f 7265  imator.oob_score
+00049540: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
+00049550: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00049560: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00049570: 7269 6e74 2827 2020 2020 4f4f 4220 5363  rint('    OOB Sc
+00049580: 6f72 6520 3d20 2530 2e33 6627 2025 6d6f  ore = %0.3f' %mo
+00049590: 6465 6c2e 6f6f 625f 7363 6f72 655f 290d  del.oob_score_).
+000495a0: 0a20 2020 2020 2020 2020 2020 2072 6d73  .            rms
+000495b0: 6c65 5f63 616c 6375 6c61 7465 645f 6d20  le_calculated_m 
+000495c0: 3d20 6261 6c61 6e63 6564 5f61 6363 7572  = balanced_accur
+000495d0: 6163 795f 7363 6f72 6528 795f 6376 2c79  acy_score(y_cv,y
+000495e0: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
+000495f0: 2020 2020 6966 206c 656e 2863 6c61 7373      if len(class
+00049600: 6573 2920 3d3d 2032 3a0d 0a20 2020 2020  es) == 2:..     
+00049610: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00049620: 2827 2020 2020 5265 6775 6c61 7220 4163  ('    Regular Ac
+00049630: 6375 7261 6379 2053 636f 7265 203d 2025  curacy Score = %
+00049640: 302e 3166 2525 2720 2528 6163 6375 7261  0.1f%%' %(accura
+00049650: 6379 5f73 636f 7265 2879 5f63 762c 795f  cy_score(y_cv,y_
+00049660: 7072 6564 292a 3130 3029 290d 0a20 2020  pred)*100))..   
+00049670: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+00049680: 726f 6261 7320 3d20 6d6f 6465 6c2e 7072  robas = model.pr
+00049690: 6564 6963 745f 7072 6f62 6128 585f 6376  edict_proba(X_cv
+000496a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000496b0: 2020 2072 6d73 6c65 5f63 616c 6375 6c61     rmsle_calcula
+000496c0: 7465 645f 6d20 3d20 7072 696e 745f 636c  ted_m = print_cl
+000496d0: 6173 7369 6669 6361 7469 6f6e 5f6d 6f64  assification_mod
+000496e0: 656c 5f73 7461 7473 2879 5f63 762c 2079  el_stats(y_cv, y
+000496f0: 5f70 726f 6261 732c 206d 5f74 6872 6573  _probas, m_thres
+00049700: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+00049710: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00049720: 2020 2020 2020 2023 2323 2323 2320 5573         ###### Us
+00049730: 6520 6120 6e69 6365 2063 6c61 7373 6966  e a nice classif
+00049740: 6963 6174 696f 6e20 6d61 7472 6978 2070  ication matrix p
+00049750: 7269 6e74 696e 6720 6d6f 6475 6c65 2068  rinting module h
+00049760: 6572 6520 2323 2323 2323 2323 230d 0a20  ere #########.. 
+00049770: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00049780: 5f70 726f 6261 7320 3d20 6d6f 6465 6c2e  _probas = model.
+00049790: 7072 6564 6963 745f 7072 6f62 6128 585f  predict_proba(X_
+000497a0: 6376 290d 0a20 2020 2020 2020 2020 2020  cv)..           
+000497b0: 2020 2020 2070 7269 6e74 5f63 6c61 7373       print_class
+000497c0: 6966 6963 6174 696f 6e5f 6d65 7472 6963  ification_metric
+000497d0: 7328 795f 6376 2c20 795f 7072 6f62 6173  s(y_cv, y_probas
+000497e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000497f0: 2020 2070 7269 6e74 2863 6c61 7373 6966     print(classif
+00049800: 6963 6174 696f 6e5f 7265 706f 7274 2879  ication_report(y
+00049810: 5f63 762c 795f 7072 6564 2929 0d0a 2020  _cv,y_pred))..  
+00049820: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00049830: 696e 7428 636f 6e66 7573 696f 6e5f 6d61  int(confusion_ma
+00049840: 7472 6978 2879 5f63 762c 2079 5f70 7265  trix(y_cv, y_pre
+00049850: 6429 290d 0a20 2020 2065 6c73 653a 0d0a  d))..    else:..
+00049860: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00049870: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
+00049880: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+00049890: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
+000498a0: 666f 7220 4d75 6c74 692d 4c61 6265 6c20  for Multi-Label 
+000498b0: 5265 6772 6573 7369 6f6e 2023 2323 2323  Regression #####
+000498c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000498d0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+000498e0: 2020 2020 2020 2020 2070 7269 6e74 5f72           print_r
+000498f0: 6567 7265 7373 696f 6e5f 6d6f 6465 6c5f  egression_model_
+00049900: 7374 6174 7328 795f 6376 2c20 795f 7072  stats(y_cv, y_pr
+00049910: 6564 2c74 6172 6765 742c 706c 6f74 5f6e  ed,target,plot_n
+00049920: 616d 653d 6d6f 6465 6c5f 6e61 6d65 290d  ame=model_name).
+00049930: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00049940: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+00049950: 6f62 6173 203d 206d 6f64 656c 2e70 7265  obas = model.pre
+00049960: 6469 6374 5f70 726f 6261 2858 5f63 7629  dict_proba(X_cv)
+00049970: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00049980: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
+00049990: 756c 7469 2d4c 6162 656c 2043 6c61 7373  ulti-Label Class
+000499a0: 6966 6963 6174 696f 6e20 2323 2323 2323  ification ######
+000499b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000499c0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+000499d0: 2020 2020 2020 2020 7072 696e 745f 636c          print_cl
+000499e0: 6173 7369 6669 6361 7469 6f6e 5f6d 6574  assification_met
+000499f0: 7269 6373 2879 5f63 762c 2079 5f70 7265  rics(y_cv, y_pre
+00049a00: 642c 2046 616c 7365 290d 0a20 2020 2020  d, False)..     
+00049a10: 2020 2020 2020 2070 7269 6e74 2863 6c61         print(cla
+00049a20: 7373 6966 6963 6174 696f 6e5f 7265 706f  ssification_repo
+00049a30: 7274 2879 5f63 762c 2079 5f70 7265 6420  rt(y_cv, y_pred 
+00049a40: 2929 0d0a 2020 2020 2323 2323 2323 2020  ))..    ######  
+00049a50: 2020 2020 5345 5420 4245 5354 2050 4152      SET BEST PAR
+00049a60: 414d 4554 4552 5320 4845 5245 2023 2323  AMETERS HERE ###
+00049a70: 2323 230d 0a20 2020 2023 2323 2046 696e  ###..    ### Fin
+00049a80: 6420 7768 6174 2074 6865 206f 7264 6572  d what the order
+00049a90: 206f 6620 6265 7374 2070 6172 616d 7320   of best params 
+00049aa0: 6172 6520 616e 6420 7365 7420 7468 6520  are and set the 
+00049ab0: 7361 6d65 2061 7320 7468 6520 6f72 6967  same as the orig
+00049ac0: 696e 616c 206d 6f64 656c 2023 2323 0d0a  inal model ###..
+00049ad0: 2020 2020 2323 2054 6869 7320 6973 2077      ## This is w
+00049ae0: 6865 7265 2077 6520 7365 7420 7468 6520  here we set the 
+00049af0: 6265 7374 2070 6172 616d 6574 6572 7320  best parameters 
+00049b00: 6672 6f6d 2074 7261 696e 696e 6720 746f  from training to
+00049b10: 2074 6865 206d 6f64 656c 2023 2323 230d   the model ####.
+00049b20: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
+00049b30: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
+00049b40: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
+00049b50: 2323 2323 2059 6f75 2064 6f20 656e 7365  #### You do ense
+00049b60: 6d62 6c69 6e67 206f 7220 7374 6163 6b69  mbling or stacki
+00049b70: 6e67 206f 6e6c 7920 666f 7220 5369 6e67  ng only for Sing
+00049b80: 6c65 5f4c 6162 656c 2070 726f 626c 656d  le_Label problem
+00049b90: 7320 2323 2323 2323 2323 2323 2323 0d0a  s ############..
+00049ba0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00049bb0: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
+00049bc0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+00049bd0: 2020 2069 6620 6e6f 7420 5374 6163 6b69     if not Stacki
+00049be0: 6e67 5f46 6c61 6720 616e 6420 585f 7472  ng_Flag and X_tr
+00049bf0: 6169 6e2e 7368 6170 655b 305d 203c 3d20  ain.shape[0] <= 
+00049c00: 656e 7365 6d62 6c65 5f6d 6178 5f72 6f77  ensemble_max_row
+00049c10: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00049c20: 2020 2020 7072 696e 7428 2723 2323 2323      print('#####
+00049c30: 2323 2323 2323 2323 2323 2323 2045 204e  ############ E N
+00049c40: 2053 2045 204d 2042 204c 2045 2020 4d20   S E M B L E  M 
+00049c50: 4f20 4420 4520 4c20 2023 2323 2323 2323  O D E L  #######
+00049c60: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+00049c70: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00049c80: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00049c90: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
+00049ca0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+00049cb0: 2020 2020 2020 2020 7375 626d 203d 2070          subm = p
+00049cc0: 642e 4461 7461 4672 616d 6528 290d 0a20  d.DataFrame().. 
 00049cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ce0: 2020 7072 696e 7428 2720 2020 2044 6973    print('    Dis
-00049cf0: 706c 6179 696e 6720 7265 7375 6c74 7320  playing results 
-00049d00: 6f66 2077 6569 6768 7465 6420 6176 6572  of weighted aver
-00049d10: 6167 6520 656e 7365 6d62 6c65 206f 6620  age ensemble of 
-00049d20: 2564 2072 6567 7265 7373 6f72 7327 2025  %d regressors' %
-00049d30: 6c65 6e28 636f 6c73 2929 0d0a 2020 2020  len(cols))..    
-00049d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049d50: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
-00049d60: 2073 7562 6d5b 636f 6c73 5b2d 315d 5d2a   subm[cols[-1]]*
-00049d70: 302e 352b 302e 3132 352a 2873 7562 6d5b  0.5+0.125*(subm[
-00049d80: 636f 6c73 5b30 5d5d 2b73 7562 6d5b 0d0a  cols[0]]+subm[..
-00049d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049db0: 2020 2020 2020 2020 636f 6c73 5b31 5d5d          cols[1]]
-00049dc0: 2b73 7562 6d5b 636f 6c73 5b32 5d5d 2b73  +subm[cols[2]]+s
-00049dd0: 7562 6d5b 636f 6c73 5b33 5d5d 290d 0a20  ubm[cols[3]]).. 
+00049ce0: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
+00049cf0: 666f 7220 456e 7365 6d62 6c69 6e67 2020  for Ensembling  
+00049d00: 4f6e 6c79 2023 2323 2323 0d0a 2020 2020  Only #####..    
+00049d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049d20: 6d6f 6465 6c73 5f6c 6973 742c 2063 765f  models_list, cv_
+00049d30: 656e 7365 6d62 6c65 7320 3d20 5175 6963  ensembles = Quic
+00049d40: 6b4d 4c5f 456e 7365 6d62 6c69 6e67 2858  kML_Ensembling(X
+00049d50: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+00049d60: 2058 5f63 762c 2079 5f63 762c 0d0a 2020   X_cv, y_cv,..  
+00049d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049d90: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00049da0: 6c74 7970 653d 6d6f 6465 6c74 7970 652c  ltype=modeltype,
+00049db0: 2042 6f6f 7374 696e 675f 466c 6167 3d42   Boosting_Flag=B
+00049dc0: 6f6f 7374 696e 675f 466c 6167 2c0d 0a20  oosting_Flag,.. 
+00049dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00049de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049df0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00049e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049e10: 2020 7072 696e 7428 2720 2020 2043 616c    print('    Cal
-00049e20: 6375 6c61 7469 6e67 2072 6567 756c 6172  culating regular
-00049e30: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
-00049e40: 6520 6f66 2025 6420 7265 6772 6573 736f  e of %d regresso
-00049e50: 7273 2720 256c 656e 2863 6f6c 7329 290d  rs' %len(cols)).
-00049e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049e70: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
-00049e80: 7265 6420 3d20 2873 7562 6d5b 636f 6c73  red = (subm[cols
-00049e90: 5d2e 6d65 616e 2861 7869 733d 3129 290d  ].mean(axis=1)).
-00049ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049eb0: 2020 2020 2070 7269 6e74 2827 2323 2323       print('####
-00049ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f00: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-00049f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049f20: 2070 6572 666f 726d 6564 5f65 6e73 656d   performed_ensem
-00049f30: 626c 696e 6720 3d20 5472 7565 0d0a 2020  bling = True..  
-00049f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049f50: 2020 2323 2323 2053 696e 6365 2077 6520    #### Since we 
-00049f60: 6861 7665 2061 206e 6577 2065 6e73 656d  have a new ensem
-00049f70: 626c 6564 2079 5f70 7265 642c 206d 616b  bled y_pred, mak
-00049f80: 6520 7375 7265 2069 7420 6973 2061 6e20  e sure it is an 
-00049f90: 6172 7261 7920 6265 666f 7265 2070 7269  array before pri
-00049fa0: 6e74 696e 6720 6974 210d 0a20 2020 2020  nting it!..     
-00049fb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00049fc0: 6620 6973 696e 7374 616e 6365 2865 6e73  f isinstance(ens
-00049fd0: 656d 5f70 7265 642c 7064 2e53 6572 6965  em_pred,pd.Serie
-00049fe0: 7329 206f 7220 6973 696e 7374 616e 6365  s) or isinstance
-00049ff0: 2865 6e73 656d 5f70 7265 642c 7064 2e44  (ensem_pred,pd.D
-0004a000: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00049df0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00049e00: 6f72 696e 673d 2727 2c20 7665 7262 6f73  oring='', verbos
+00049e10: 653d 7665 7262 6f73 6529 0d0a 2020 2020  e=verbose)..    
+00049e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049e30: 6d6f 6465 6c73 5f6c 6973 742e 6170 7065  models_list.appe
+00049e40: 6e64 286d 6f64 656c 5f6e 616d 6529 0d0a  nd(model_name)..
+00049e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049e60: 2020 2020 666f 7220 6d6f 6465 6c73 2c20      for models, 
+00049e70: 6561 6368 2069 6e20 7a69 7028 6d6f 6465  each in zip(mode
+00049e80: 6c73 5f6c 6973 742c 2072 616e 6765 286c  ls_list, range(l
+00049e90: 656e 286d 6f64 656c 735f 6c69 7374 2929  en(models_list))
+00049ea0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00049eb0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00049ec0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
+00049ed0: 742b 275f 272b 6d6f 6465 6c73 2b27 5f70  t+'_'+models+'_p
+00049ee0: 7265 6469 6374 696f 6e73 270d 0a20 2020  redictions'..   
+00049ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f00: 2020 2020 2069 6620 6561 6368 2b31 203d       if each+1 =
+00049f10: 3d20 6c65 6e28 6d6f 6465 6c73 5f6c 6973  = len(models_lis
+00049f20: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+00049f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f40: 2073 7562 6d5b 6e65 775f 636f 6c5d 203d   subm[new_col] =
+00049f50: 2079 5f70 7265 640d 0a20 2020 2020 2020   y_pred..       
+00049f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f70: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00049f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f90: 2020 2020 7375 626d 5b6e 6577 5f63 6f6c      subm[new_col
+00049fa0: 5d20 3d20 6376 5f65 6e73 656d 626c 6573  ] = cv_ensembles
+00049fb0: 5b3a 2c65 6163 685d 0d0a 2020 2020 2020  [:,each]..      
+00049fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049fd0: 2020 636f 6c73 2e61 7070 656e 6428 6e65    cols.append(ne
+00049fe0: 775f 636f 6c29 0d0a 2020 2020 2020 2020  w_col)..        
+00049ff0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0004a000: 656e 2863 6f6c 7329 203d 3d20 353a 0d0a  en(cols) == 5:..
 0004a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a020: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
-0004a030: 7369 6f6e 5f6d 6f64 656c 5f73 7461 7473  sion_model_stats
-0004a040: 2879 5f63 762c 2065 6e73 656d 5f70 7265  (y_cv, ensem_pre
-0004a050: 642e 7661 6c75 6573 2c20 7461 7267 6574  d.values, target
-0004a060: 2c70 6c6f 745f 6e61 6d65 3d27 456e 7365  ,plot_name='Ense
-0004a070: 6d62 6c65 2729 0d0a 2020 2020 2020 2020  mble')..        
-0004a080: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0004a090: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004a0a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004a0b0: 5f72 6567 7265 7373 696f 6e5f 6d6f 6465  _regression_mode
-0004a0c0: 6c5f 7374 6174 7328 795f 6376 2c20 656e  l_stats(y_cv, en
-0004a0d0: 7365 6d5f 7072 6564 2c20 7461 7267 6574  sem_pred, target
-0004a0e0: 2c20 706c 6f74 5f6e 616d 653d 2745 6e73  , plot_name='Ens
-0004a0f0: 656d 626c 6527 290d 0a20 2020 2020 2020  emble')..       
-0004a100: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-0004a110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004a120: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
-0004a130: 6c64 206e 6f74 2063 6f6d 706c 6574 6520  ld not complete 
-0004a140: 456e 7365 6d62 6c69 6e67 2070 7265 6469  Ensembling predi
-0004a150: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
-0004a160: 7574 2064 6174 6120 6475 6520 746f 2045  ut data due to E
-0004a170: 7272 6f72 2729 0d0a 2020 2020 2020 2020  rror')..        
-0004a180: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0004a190: 2020 2023 2320 2054 6869 7320 6973 2066     ##  This is f
-0004a1a0: 6f72 2043 6c61 7373 6966 6963 6174 696f  or Classificatio
-0004a1b0: 6e20 5072 6f62 6c65 6d73 204f 6e6c 7920  n Problems Only 
-0004a1c0: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
-0004a1d0: 2323 2046 696e 6420 7768 6174 2074 6865  ## Find what the
-0004a1e0: 206f 7264 6572 206f 6620 6265 7374 2070   order of best p
-0004a1f0: 6172 616d 7320 6172 6520 616e 6420 7365  arams are and se
-0004a200: 7420 7468 6520 7361 6d65 2061 7320 7468  t the same as th
-0004a210: 6520 6f72 6967 696e 616c 206d 6f64 656c  e original model
-0004a220: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
-0004a230: 2020 2323 2054 6869 7320 6973 2077 6865    ## This is whe
-0004a240: 7265 2077 6520 7365 7420 7468 6520 6265  re we set the be
-0004a250: 7374 2070 6172 616d 6574 6572 7320 6672  st parameters fr
-0004a260: 6f6d 2074 7261 696e 696e 6720 746f 2074  om training to t
-0004a270: 6865 206d 6f64 656c 2023 2323 230d 0a20  he model ####.. 
-0004a280: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0004a290: 7420 5374 6163 6b69 6e67 5f46 6c61 6720  t Stacking_Flag 
-0004a2a0: 616e 6420 585f 7472 6169 6e2e 7368 6170  and X_train.shap
-0004a2b0: 655b 305d 203c 3d20 656e 7365 6d62 6c65  e[0] <= ensemble
-0004a2c0: 5f6d 6178 5f72 6f77 733a 0d0a 2020 2020  _max_rows:..    
-0004a2d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0004a2e0: 7428 2723 2323 2323 2323 2323 2323 2323  t('#############
-0004a2f0: 2323 2323 2045 204e 2053 2045 204d 2042  #### E N S E M B
-0004a300: 204c 2045 2020 4d20 4f20 4420 4520 4c20   L E  M O D E L 
-0004a310: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0004a320: 2323 2327 290d 0a20 2020 2020 2020 2020  ###')..         
-0004a330: 2020 2020 2020 2023 2323 2320 5765 2064         #### We d
-0004a340: 6f20 456e 7365 6d62 6c69 6e67 206f 6e6c  o Ensembling onl
-0004a350: 7920 6966 2074 6865 2053 7461 636b 696e  y if the Stackin
-0004a360: 675f 466c 6167 2069 7320 4661 6c73 652e  g_Flag is False.
-0004a370: 204f 7468 6572 7769 7365 2c20 7765 2064   Otherwise, we d
-0004a380: 6f6e 2774 210d 0a20 2020 2020 2020 2020  on't!..         
-0004a390: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0004a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a3b0: 2063 6c61 7373 6573 203d 206c 6162 656c   classes = label
-0004a3c0: 5f64 6963 745b 6561 6368 5f74 6172 6765  _dict[each_targe
-0004a3d0: 745d 5b27 636c 6173 7365 7327 5d0d 0a20  t]['classes'].. 
+0004a020: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0004a030: 2020 2044 6973 706c 6179 696e 6720 7265     Displaying re
+0004a040: 7375 6c74 7320 6f66 2077 6569 6768 7465  sults of weighte
+0004a050: 6420 6176 6572 6167 6520 656e 7365 6d62  d average ensemb
+0004a060: 6c65 206f 6620 2564 2072 6567 7265 7373  le of %d regress
+0004a070: 6f72 7327 2025 6c65 6e28 636f 6c73 2929  ors' %len(cols))
+0004a080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a090: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
+0004a0a0: 7072 6564 203d 2073 7562 6d5b 636f 6c73  pred = subm[cols
+0004a0b0: 5b2d 315d 5d2a 302e 352b 302e 3132 352a  [-1]]*0.5+0.125*
+0004a0c0: 2873 7562 6d5b 636f 6c73 5b30 5d5d 2b73  (subm[cols[0]]+s
+0004a0d0: 7562 6d5b 0d0a 2020 2020 2020 2020 2020  ubm[..          
+0004a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a0f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0004a100: 6c73 5b31 5d5d 2b73 7562 6d5b 636f 6c73  ls[1]]+subm[cols
+0004a110: 5b32 5d5d 2b73 7562 6d5b 636f 6c73 5b33  [2]]+subm[cols[3
+0004a120: 5d5d 290d 0a20 2020 2020 2020 2020 2020  ]])..           
+0004a130: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0004a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a150: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0004a160: 2020 2043 616c 6375 6c61 7469 6e67 2072     Calculating r
+0004a170: 6567 756c 6172 2061 7665 7261 6765 2065  egular average e
+0004a180: 6e73 656d 626c 6520 6f66 2025 6420 7265  nsemble of %d re
+0004a190: 6772 6573 736f 7273 2720 256c 656e 2863  gressors' %len(c
+0004a1a0: 6f6c 7329 290d 0a20 2020 2020 2020 2020  ols))..         
+0004a1b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004a1c0: 6e73 656d 5f70 7265 6420 3d20 2873 7562  nsem_pred = (sub
+0004a1d0: 6d5b 636f 6c73 5d2e 6d65 616e 2861 7869  m[cols].mean(axi
+0004a1e0: 733d 3129 290d 0a20 2020 2020 2020 2020  s=1))..         
+0004a1f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004a200: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+0004a210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004a220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004a230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004a240: 2323 2323 2323 2323 2323 2323 2323 2327  ###############'
+0004a250: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0004a260: 2020 2020 2020 2070 6572 666f 726d 6564         performed
+0004a270: 5f65 6e73 656d 626c 696e 6720 3d20 5472  _ensembling = Tr
+0004a280: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+0004a290: 2020 2020 2020 2020 2323 2323 2053 696e          #### Sin
+0004a2a0: 6365 2077 6520 6861 7665 2061 206e 6577  ce we have a new
+0004a2b0: 2065 6e73 656d 626c 6564 2079 5f70 7265   ensembled y_pre
+0004a2c0: 642c 206d 616b 6520 7375 7265 2069 7420  d, make sure it 
+0004a2d0: 6973 2061 6e20 6172 7261 7920 6265 666f  is an array befo
+0004a2e0: 7265 2070 7269 6e74 696e 6720 6974 210d  re printing it!.
+0004a2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004a300: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0004a310: 6365 2865 6e73 656d 5f70 7265 642c 7064  ce(ensem_pred,pd
+0004a320: 2e53 6572 6965 7329 206f 7220 6973 696e  .Series) or isin
+0004a330: 7374 616e 6365 2865 6e73 656d 5f70 7265  stance(ensem_pre
+0004a340: 642c 7064 2e44 6174 6146 7261 6d65 293a  d,pd.DataFrame):
+0004a350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a360: 2020 2020 2020 2020 2020 7072 696e 745f            print_
+0004a370: 7265 6772 6573 7369 6f6e 5f6d 6f64 656c  regression_model
+0004a380: 5f73 7461 7473 2879 5f63 762c 2065 6e73  _stats(y_cv, ens
+0004a390: 656d 5f70 7265 642e 7661 6c75 6573 2c20  em_pred.values, 
+0004a3a0: 7461 7267 6574 2c70 6c6f 745f 6e61 6d65  target,plot_name
+0004a3b0: 3d27 456e 7365 6d62 6c65 2729 0d0a 2020  ='Ensemble')..  
+0004a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a3d0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
 0004a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a3f0: 2020 2063 6f6c 7320 3d20 5b5d 0d0a 2020     cols = []..  
-0004a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a410: 2020 7375 626d 203d 2070 642e 4461 7461    subm = pd.Data
-0004a420: 4672 616d 6528 290d 0a20 2020 2020 2020  Frame()..       
-0004a430: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0004a440: 2320 5468 6973 2069 7320 666f 7220 456e  # This is for En
-0004a450: 7365 6d62 6c69 6e67 2020 4f6e 6c79 2023  sembling  Only #
-0004a460: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-0004a470: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0004a480: 2863 6c61 7373 6573 2920 3d3d 2032 3a0d  (classes) == 2:.
-0004a490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004a4a0: 2020 2020 2020 2020 206d 6f64 656c 735f           models_
-0004a4b0: 6c69 7374 2c20 6376 5f65 6e73 656d 626c  list, cv_ensembl
-0004a4c0: 6573 203d 2051 7569 636b 4d4c 5f45 6e73  es = QuickML_Ens
-0004a4d0: 656d 626c 696e 6728 585f 7472 6169 6e2c  embling(X_train,
-0004a4e0: 2079 5f74 7261 696e 2c20 585f 6376 2c20   y_train, X_cv, 
-0004a4f0: 795f 6376 2c0d 0a20 2020 2020 2020 2020  y_cv,..         
-0004a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a520: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
-0004a530: 7065 3d27 4269 6e61 7279 5f43 6c61 7373  pe='Binary_Class
-0004a540: 6966 6963 6174 696f 6e27 2c20 426f 6f73  ification', Boos
-0004a550: 7469 6e67 5f46 6c61 673d 426f 6f73 7469  ting_Flag=Boosti
-0004a560: 6e67 5f46 6c61 672c 0d0a 2020 2020 2020  ng_Flag,..      
-0004a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a590: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-0004a5a0: 7269 6e67 3d27 272c 2076 6572 626f 7365  ring='', verbose
-0004a5b0: 3d76 6572 626f 7365 290d 0a20 2020 2020  =verbose)..     
-0004a5c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004a5d0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0004a5e0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004a5f0: 6465 6c73 5f6c 6973 742c 2063 765f 656e  dels_list, cv_en
-0004a600: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
-0004a610: 4c5f 456e 7365 6d62 6c69 6e67 2858 5f74  L_Ensembling(X_t
-0004a620: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
-0004a630: 5f63 762c 2079 5f63 762c 0d0a 2020 2020  _cv, y_cv,..    
-0004a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a660: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004a670: 6465 6c74 7970 653d 274d 756c 7469 5f43  deltype='Multi_C
-0004a680: 6c61 7373 6966 6963 6174 696f 6e27 2c20  lassification', 
-0004a690: 426f 6f73 7469 6e67 5f46 6c61 673d 426f  Boosting_Flag=Bo
-0004a6a0: 6f73 7469 6e67 5f46 6c61 672c 0d0a 2020  osting_Flag,..  
-0004a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a6e0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
-0004a6f0: 626f 7365 3d76 6572 626f 7365 290d 0a20  bose=verbose).. 
-0004a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a710: 2020 206d 6f64 656c 735f 6c69 7374 2e61     models_list.a
-0004a720: 7070 656e 6428 6d6f 6465 6c5f 6e61 6d65  ppend(model_name
-0004a730: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004a740: 2020 2020 2020 2066 6f72 206d 6f64 656c         for model
-0004a750: 732c 2065 6163 6820 696e 207a 6970 286d  s, each in zip(m
-0004a760: 6f64 656c 735f 6c69 7374 2c20 7261 6e67  odels_list, rang
-0004a770: 6528 6c65 6e28 6d6f 6465 6c73 5f6c 6973  e(len(models_lis
-0004a780: 7429 2929 3a0d 0a20 2020 2020 2020 2020  t))):..         
-0004a790: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0004a7a0: 6577 5f63 6f6c 203d 2065 6163 685f 7461  ew_col = each_ta
-0004a7b0: 7267 6574 2b27 5f27 2b6d 6f64 656c 732b  rget+'_'+models+
-0004a7c0: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
-0004a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a7e0: 2020 2020 2020 2020 6966 2065 6163 682b          if each+
-0004a7f0: 3120 3d3d 206c 656e 286d 6f64 656c 735f  1 == len(models_
-0004a800: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
-0004a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a820: 2020 2020 7375 626d 5b6e 6577 5f63 6f6c      subm[new_col
-0004a830: 5d20 3d20 795f 7072 6564 0d0a 2020 2020  ] = y_pred..    
+0004a3f0: 2070 7269 6e74 5f72 6567 7265 7373 696f   print_regressio
+0004a400: 6e5f 6d6f 6465 6c5f 7374 6174 7328 795f  n_model_stats(y_
+0004a410: 6376 2c20 656e 7365 6d5f 7072 6564 2c20  cv, ensem_pred, 
+0004a420: 7461 7267 6574 2c20 706c 6f74 5f6e 616d  target, plot_nam
+0004a430: 653d 2745 6e73 656d 626c 6527 290d 0a20  e='Ensemble').. 
+0004a440: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004a450: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0004a460: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004a470: 7428 2743 6f75 6c64 206e 6f74 2063 6f6d  t('Could not com
+0004a480: 706c 6574 6520 456e 7365 6d62 6c69 6e67  plete Ensembling
+0004a490: 2070 7265 6469 6374 696f 6e73 206f 6e20   predictions on 
+0004a4a0: 6865 6c64 206f 7574 2064 6174 6120 6475  held out data du
+0004a4b0: 6520 746f 2045 7272 6f72 2729 0d0a 2020  e to Error')..  
+0004a4c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0004a4d0: 2020 2020 2020 2020 2023 2320 2054 6869           ##  Thi
+0004a4e0: 7320 6973 2066 6f72 2043 6c61 7373 6966  s is for Classif
+0004a4f0: 6963 6174 696f 6e20 5072 6f62 6c65 6d73  ication Problems
+0004a500: 204f 6e6c 7920 230d 0a20 2020 2020 2020   Only #..       
+0004a510: 2020 2020 2023 2323 2046 696e 6420 7768       ### Find wh
+0004a520: 6174 2074 6865 206f 7264 6572 206f 6620  at the order of 
+0004a530: 6265 7374 2070 6172 616d 7320 6172 6520  best params are 
+0004a540: 616e 6420 7365 7420 7468 6520 7361 6d65  and set the same
+0004a550: 2061 7320 7468 6520 6f72 6967 696e 616c   as the original
+0004a560: 206d 6f64 656c 2023 2323 0d0a 2020 2020   model ###..    
+0004a570: 2020 2020 2020 2020 2323 2054 6869 7320          ## This 
+0004a580: 6973 2077 6865 7265 2077 6520 7365 7420  is where we set 
+0004a590: 7468 6520 6265 7374 2070 6172 616d 6574  the best paramet
+0004a5a0: 6572 7320 6672 6f6d 2074 7261 696e 696e  ers from trainin
+0004a5b0: 6720 746f 2074 6865 206d 6f64 656c 2023  g to the model #
+0004a5c0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0004a5d0: 2069 6620 6e6f 7420 5374 6163 6b69 6e67   if not Stacking
+0004a5e0: 5f46 6c61 6720 616e 6420 585f 7472 6169  _Flag and X_trai
+0004a5f0: 6e2e 7368 6170 655b 305d 203c 3d20 656e  n.shape[0] <= en
+0004a600: 7365 6d62 6c65 5f6d 6178 5f72 6f77 733a  semble_max_rows:
+0004a610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a620: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+0004a630: 2323 2323 2323 2323 2323 2045 204e 2053  ########## E N S
+0004a640: 2045 204d 2042 204c 2045 2020 4d20 4f20   E M B L E  M O 
+0004a650: 4420 4520 4c20 2023 2323 2323 2323 2323  D E L  #########
+0004a660: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+0004a670: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0004a680: 2320 5765 2064 6f20 456e 7365 6d62 6c69  # We do Ensembli
+0004a690: 6e67 206f 6e6c 7920 6966 2074 6865 2053  ng only if the S
+0004a6a0: 7461 636b 696e 675f 466c 6167 2069 7320  tacking_Flag is 
+0004a6b0: 4661 6c73 652e 204f 7468 6572 7769 7365  False. Otherwise
+0004a6c0: 2c20 7765 2064 6f6e 2774 210d 0a20 2020  , we don't!..   
+0004a6d0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+0004a6e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004a6f0: 2020 2020 2020 2063 6c61 7373 6573 203d         classes =
+0004a700: 206c 6162 656c 5f64 6963 745b 6561 6368   label_dict[each
+0004a710: 5f74 6172 6765 745d 5b27 636c 6173 7365  _target]['classe
+0004a720: 7327 5d0d 0a20 2020 2020 2020 2020 2020  s']..           
+0004a730: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
+0004a740: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+0004a750: 2020 2020 2020 2020 7375 626d 203d 2070          subm = p
+0004a760: 642e 4461 7461 4672 616d 6528 290d 0a20  d.DataFrame().. 
+0004a770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a780: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
+0004a790: 666f 7220 456e 7365 6d62 6c69 6e67 2020  for Ensembling  
+0004a7a0: 4f6e 6c79 2023 2323 2323 0d0a 2020 2020  Only #####..    
+0004a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a7c0: 6966 206c 656e 2863 6c61 7373 6573 2920  if len(classes) 
+0004a7d0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
+0004a7e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0004a7f0: 6f64 656c 735f 6c69 7374 2c20 6376 5f65  odels_list, cv_e
+0004a800: 6e73 656d 626c 6573 203d 2051 7569 636b  nsembles = Quick
+0004a810: 4d4c 5f45 6e73 656d 626c 696e 6728 585f  ML_Ensembling(X_
+0004a820: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
+0004a830: 585f 6376 2c20 795f 6376 2c0d 0a20 2020  X_cv, y_cv,..   
 0004a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a850: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0004a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a870: 2020 2020 2020 2073 7562 6d5b 6e65 775f         subm[new_
-0004a880: 636f 6c5d 203d 2063 765f 656e 7365 6d62  col] = cv_ensemb
-0004a890: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
-0004a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a8b0: 2020 2020 2063 6f6c 732e 6170 7065 6e64       cols.append
-0004a8c0: 286e 6577 5f63 6f6c 290d 0a20 2020 2020  (new_col)..     
-0004a8d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0004a8e0: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
-0004a8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004a900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004a910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004a920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004a930: 2323 2327 290d 0a20 2020 2020 2020 2020  ###')..         
-0004a940: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0004a950: 6e28 636f 6c73 2920 3d3d 2035 3a0d 0a20  n(cols) == 5:.. 
-0004a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a970: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0004a980: 2020 4469 7370 6c61 7969 6e67 2072 6573    Displaying res
-0004a990: 756c 7473 206f 6620 7765 6967 6874 6564  ults of weighted
-0004a9a0: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
-0004a9b0: 6520 6f66 2025 6420 636c 6173 7369 6669  e of %d classifi
-0004a9c0: 6572 7327 2025 6c65 6e28 636f 6c73 2929  ers' %len(cols))
-0004a9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004a9e0: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
-0004a9f0: 7072 6564 203d 206e 702e 726f 756e 6428  pred = np.round(
-0004aa00: 7375 626d 5b63 6f6c 735b 2d31 5d5d 2a30  subm[cols[-1]]*0
-0004aa10: 2e35 2b30 2e31 3235 2a28 7375 626d 5b63  .5+0.125*(subm[c
-0004aa20: 6f6c 735b 305d 5d2b 7375 626d 5b0d 0a20  ols[0]]+subm[.. 
-0004aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aa50: 2020 2020 2020 2063 6f6c 735b 315d 5d2b         cols[1]]+
-0004aa60: 7375 626d 5b63 6f6c 735b 325d 5d2b 7375  subm[cols[2]]+su
-0004aa70: 626d 5b63 6f6c 735b 335d 5d29 292e 6173  bm[cols[3]])).as
-0004aa80: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-0004aa90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004aaa0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0004aab0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0004aac0: 696e 7428 2720 2020 2043 616c 6375 6c61  int('    Calcula
-0004aad0: 7469 6e67 2072 6567 756c 6172 2061 7665  ting regular ave
-0004aae0: 7261 6765 2065 6e73 656d 626c 6520 6f66  rage ensemble of
-0004aaf0: 2025 6420 636c 6173 7369 6669 6572 7327   %d classifiers'
-0004ab00: 2025 6c65 6e28 636f 6c73 2929 0d0a 2020   %len(cols))..  
-0004ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ab20: 2020 2020 2020 656e 7365 6d5f 7072 6564        ensem_pred
-0004ab30: 203d 2028 7375 626d 5b63 6f6c 735d 2e6d   = (subm[cols].m
-0004ab40: 6561 6e28 6178 6973 3d31 2929 2e61 7374  ean(axis=1)).ast
-0004ab50: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
-0004ab60: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-0004ab70: 7266 6f72 6d65 645f 656e 7365 6d62 6c69  rformed_ensembli
-0004ab80: 6e67 203d 2054 7275 650d 0a20 2020 2020  ng = True..     
-0004ab90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0004aba0: 2323 2323 2054 6869 7320 6e65 7874 2073  #### This next s
-0004abb0: 7465 7020 6973 2076 6572 7920 696d 706f  tep is very impo
-0004abc0: 7274 616e 7420 7369 6e63 6520 736f 6d65  rtant since some
-0004abd0: 206d 6f64 656c 7320 6769 7665 2073 6572   models give ser
-0004abe0: 6965 732c 206f 7468 6572 7320 6769 7665  ies, others give
-0004abf0: 2061 7272 6179 732e 2056 6572 7920 7061   arrays. Very pa
-0004ac00: 696e 6675 6c21 0d0a 2020 2020 2020 2020  inful!..        
-0004ac10: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0004ac20: 7369 6e73 7461 6e63 6528 656e 7365 6d5f  sinstance(ensem_
-0004ac30: 7072 6564 2c70 642e 5365 7269 6573 293a  pred,pd.Series):
-0004ac40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004ac50: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
-0004ac60: 7072 6564 203d 2065 6e73 656d 5f70 7265  pred = ensem_pre
-0004ac70: 642e 7661 6c75 6573 0d0a 2020 2020 2020  d.values..      
-0004ac80: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0004ac90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004aca0: 2020 2020 2020 2070 7269 6e74 2827 436f         print('Co
-0004acb0: 756c 6420 6e6f 7420 636f 6d70 6c65 7465  uld not complete
-0004acc0: 2045 6e73 656d 626c 696e 6720 7072 6564   Ensembling pred
-0004acd0: 6963 7469 6f6e 7320 6f6e 2068 656c 6420  ictions on held 
-0004ace0: 6f75 7420 6461 7461 2064 7565 2074 6f20  out data due to 
-0004acf0: 4572 726f 7227 290d 0a20 2020 2020 2020  Error')..       
-0004ad00: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0004ad10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0004ad20: 7428 274e 6f20 456e 7365 6d62 6c69 6e67  t('No Ensembling
-0004ad30: 206f 6620 6d6f 6465 6c73 2064 6f6e 6520   of models done 
-0004ad40: 7369 6e63 6520 5374 6163 6b69 6e67 5f46  since Stacking_F
-0004ad50: 6c61 6720 3d20 5472 7565 2027 290d 0a20  lag = True ').. 
-0004ad60: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-0004ad70: 7262 6f73 6520 3e3d 2031 3a0d 0a20 2020  rbose >= 1:..   
-0004ad80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0004ad90: 6c65 6e28 636c 6173 7365 7329 203d 3d20  len(classes) == 
-0004ada0: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-0004adb0: 2020 2020 2020 2020 706c 6f74 5f63 6c61          plot_cla
-0004adc0: 7373 6966 6963 6174 696f 6e5f 7265 7375  ssification_resu
-0004add0: 6c74 7328 6d6f 6465 6c2c 585f 6376 2c20  lts(model,X_cv, 
-0004ade0: 795f 6376 2c20 795f 7072 6564 2c20 636c  y_cv, y_pred, cl
-0004adf0: 6173 7365 732c 2063 6c61 7373 5f6e 756d  asses, class_num
-0004ae00: 732c 2065 6163 685f 7461 7267 6574 2029  s, each_target )
-0004ae10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004ae20: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004ae30: 2020 2020 2020 2020 2020 2020 2074 7279               try
-0004ae40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004ae50: 2020 2020 2020 2020 2020 2044 7261 775f             Draw_
-0004ae60: 524f 435f 4d43 5f4d 4c28 6d6f 6465 6c2c  ROC_MC_ML(model,
-0004ae70: 2058 5f63 762c 2079 5f63 762c 2065 6163   X_cv, y_cv, eac
-0004ae80: 685f 7461 7267 6574 2c20 6d6f 6465 6c5f  h_target, model_
-0004ae90: 6e61 6d65 2c20 7665 7262 6f73 6529 0d0a  name, verbose)..
+0004a850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a860: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0004a870: 6f64 656c 7479 7065 3d27 4269 6e61 7279  odeltype='Binary
+0004a880: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+0004a890: 2c20 426f 6f73 7469 6e67 5f46 6c61 673d  , Boosting_Flag=
+0004a8a0: 426f 6f73 7469 6e67 5f46 6c61 672c 0d0a  Boosting_Flag,..
+0004a8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a8e0: 2020 2073 636f 7269 6e67 3d27 272c 2076     scoring='', v
+0004a8f0: 6572 626f 7365 3d76 6572 626f 7365 290d  erbose=verbose).
+0004a900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004a910: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0004a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a930: 2020 2020 6d6f 6465 6c73 5f6c 6973 742c      models_list,
+0004a940: 2063 765f 656e 7365 6d62 6c65 7320 3d20   cv_ensembles = 
+0004a950: 5175 6963 6b4d 4c5f 456e 7365 6d62 6c69  QuickML_Ensembli
+0004a960: 6e67 2858 5f74 7261 696e 2c20 795f 7472  ng(X_train, y_tr
+0004a970: 6169 6e2c 2058 5f63 762c 2079 5f63 762c  ain, X_cv, y_cv,
+0004a980: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a9b0: 2020 2020 6d6f 6465 6c74 7970 653d 274d      modeltype='M
+0004a9c0: 756c 7469 5f43 6c61 7373 6966 6963 6174  ulti_Classificat
+0004a9d0: 696f 6e27 2c20 426f 6f73 7469 6e67 5f46  ion', Boosting_F
+0004a9e0: 6c61 673d 426f 6f73 7469 6e67 5f46 6c61  lag=Boosting_Fla
+0004a9f0: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
+0004aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004aa20: 2020 2020 2020 2073 636f 7269 6e67 3d27         scoring='
+0004aa30: 272c 2076 6572 626f 7365 3d76 6572 626f  ', verbose=verbo
+0004aa40: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+0004aa50: 2020 2020 2020 2020 206d 6f64 656c 735f           models_
+0004aa60: 6c69 7374 2e61 7070 656e 6428 6d6f 6465  list.append(mode
+0004aa70: 6c5f 6e61 6d65 290d 0a20 2020 2020 2020  l_name)..       
+0004aa80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0004aa90: 206d 6f64 656c 732c 2065 6163 6820 696e   models, each in
+0004aaa0: 207a 6970 286d 6f64 656c 735f 6c69 7374   zip(models_list
+0004aab0: 2c20 7261 6e67 6528 6c65 6e28 6d6f 6465  , range(len(mode
+0004aac0: 6c73 5f6c 6973 7429 2929 3a0d 0a20 2020  ls_list))):..   
+0004aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004aae0: 2020 2020 206e 6577 5f63 6f6c 203d 2065       new_col = e
+0004aaf0: 6163 685f 7461 7267 6574 2b27 5f27 2b6d  ach_target+'_'+m
+0004ab00: 6f64 656c 732b 275f 7072 6564 6963 7469  odels+'_predicti
+0004ab10: 6f6e 7327 0d0a 2020 2020 2020 2020 2020  ons'..          
+0004ab20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0004ab30: 2065 6163 682b 3120 3d3d 206c 656e 286d   each+1 == len(m
+0004ab40: 6f64 656c 735f 6c69 7374 293a 0d0a 2020  odels_list):..  
+0004ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ab60: 2020 2020 2020 2020 2020 7375 626d 5b6e            subm[n
+0004ab70: 6577 5f63 6f6c 5d20 3d20 795f 7072 6564  ew_col] = y_pred
+0004ab80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004ab90: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0004aba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004abb0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+0004abc0: 6d5b 6e65 775f 636f 6c5d 203d 2063 765f  m[new_col] = cv_
+0004abd0: 656e 7365 6d62 6c65 735b 3a2c 6561 6368  ensembles[:,each
+0004abe0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0004abf0: 2020 2020 2020 2020 2020 2063 6f6c 732e             cols.
+0004ac00: 6170 7065 6e64 286e 6577 5f63 6f6c 290d  append(new_col).
+0004ac10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004ac20: 2020 2020 2070 7269 6e74 2827 2323 2323       print('####
+0004ac30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ac40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ac50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ac60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ac70: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+0004ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ac90: 2069 6620 6c65 6e28 636f 6c73 2920 3d3d   if len(cols) ==
+0004aca0: 2035 3a0d 0a20 2020 2020 2020 2020 2020   5:..           
+0004acb0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0004acc0: 6e74 2827 2020 2020 4469 7370 6c61 7969  nt('    Displayi
+0004acd0: 6e67 2072 6573 756c 7473 206f 6620 7765  ng results of we
+0004ace0: 6967 6874 6564 2061 7665 7261 6765 2065  ighted average e
+0004acf0: 6e73 656d 626c 6520 6f66 2025 6420 636c  nsemble of %d cl
+0004ad00: 6173 7369 6669 6572 7327 2025 6c65 6e28  assifiers' %len(
+0004ad10: 636f 6c73 2929 0d0a 2020 2020 2020 2020  cols))..        
+0004ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ad30: 656e 7365 6d5f 7072 6564 203d 206e 702e  ensem_pred = np.
+0004ad40: 726f 756e 6428 7375 626d 5b63 6f6c 735b  round(subm[cols[
+0004ad50: 2d31 5d5d 2a30 2e35 2b30 2e31 3235 2a28  -1]]*0.5+0.125*(
+0004ad60: 7375 626d 5b63 6f6c 735b 305d 5d2b 7375  subm[cols[0]]+su
+0004ad70: 626d 5b0d 0a20 2020 2020 2020 2020 2020  bm[..           
+0004ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ad90: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0004ada0: 735b 315d 5d2b 7375 626d 5b63 6f6c 735b  s[1]]+subm[cols[
+0004adb0: 325d 5d2b 7375 626d 5b63 6f6c 735b 335d  2]]+subm[cols[3]
+0004adc0: 5d29 292e 6173 7479 7065 2869 6e74 290d  ])).astype(int).
+0004add0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004ade0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0004adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ae00: 2020 2020 7072 696e 7428 2720 2020 2043      print('    C
+0004ae10: 616c 6375 6c61 7469 6e67 2072 6567 756c  alculating regul
+0004ae20: 6172 2061 7665 7261 6765 2065 6e73 656d  ar average ensem
+0004ae30: 626c 6520 6f66 2025 6420 636c 6173 7369  ble of %d classi
+0004ae40: 6669 6572 7327 2025 6c65 6e28 636f 6c73  fiers' %len(cols
+0004ae50: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0004ae60: 2020 2020 2020 2020 2020 2020 656e 7365              ense
+0004ae70: 6d5f 7072 6564 203d 2028 7375 626d 5b63  m_pred = (subm[c
+0004ae80: 6f6c 735d 2e6d 6561 6e28 6178 6973 3d31  ols].mean(axis=1
+0004ae90: 2929 2e61 7374 7970 6528 696e 7429 0d0a  )).astype(int)..
 0004aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aeb0: 2020 2020 2020 2020 4472 6177 5f4d 435f          Draw_MC_
-0004aec0: 4d4c 5f50 525f 524f 435f 4375 7276 6573  ML_PR_ROC_Curves
-0004aed0: 286d 6f64 656c 2c58 5f63 762c 795f 6376  (model,X_cv,y_cv
-0004aee0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004aef0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-0004af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004af10: 2020 2020 2020 2020 7072 696e 7428 2743          print('C
-0004af20: 6f75 6c64 206e 6f74 2070 6c6f 7420 5052  ould not plot PR
-0004af30: 2061 6e64 2052 4f43 2063 7572 7665 732e   and ROC curves.
-0004af40: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
-0004af50: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004af60: 2323 2049 6e20 6361 7365 2074 6865 7265  ## In case there
-0004af70: 2061 7265 2073 7065 6369 616c 2073 636f   are special sco
-0004af80: 7269 6e67 5f70 6172 616d 6574 6572 2072  ring_parameter r
-0004af90: 6571 7565 7374 732c 2079 6f75 2063 616e  equests, you can
-0004afa0: 2070 7269 6e74 2069 7420 6865 7265 210d   print it here!.
-0004afb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0004afc0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-0004afd0: 7220 3d3d 2027 726f 635f 6175 6327 206f  r == 'roc_auc' o
-0004afe0: 7220 7363 6f72 696e 675f 7061 7261 6d65  r scoring_parame
-0004aff0: 7465 7220 3d3d 2027 6175 6327 3a0d 0a20  ter == 'auc':.. 
-0004b000: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0004b010: 6620 6c65 6e28 636c 6173 7365 7329 203d  f len(classes) =
-0004b020: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
-0004b030: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0004b040: 2720 2020 2052 4f43 2041 5543 2053 636f  '    ROC AUC Sco
-0004b050: 7265 203d 2025 302e 3166 2525 2720 2528  re = %0.1f%%' %(
-0004b060: 726f 635f 6175 635f 7363 6f72 6528 795f  roc_auc_score(y_
-0004b070: 6376 2c20 795f 7072 6f62 615b 3a2c 7261  cv, y_proba[:,ra
-0004b080: 7265 5f63 6c61 7373 5d29 2a31 3030 2929  re_class])*100))
-0004b090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004b0a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004b0b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0004b0c0: 6e74 2827 2020 2020 4e6f 2052 4f43 2041  nt('    No ROC A
-0004b0d0: 5543 2073 636f 7265 2066 6f72 206d 756c  UC score for mul
-0004b0e0: 7469 2d63 6c61 7373 2070 726f 626c 656d  ti-class problem
-0004b0f0: 7327 290d 0a20 2020 2020 2020 2069 6620  s')..        if 
-0004b100: 6e6f 7420 5374 6163 6b69 6e67 5f46 6c61  not Stacking_Fla
-0004b110: 6720 616e 6420 7065 7266 6f72 6d65 645f  g and performed_
-0004b120: 656e 7365 6d62 6c69 6e67 3a0d 0a20 2020  ensembling:..   
-0004b130: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-0004b140: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-0004b150: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0004b160: 2020 2020 2020 2020 726d 736c 655f 6361          rmsle_ca
-0004b170: 6c63 756c 6174 6564 5f66 203d 2072 6d73  lculated_f = rms
-0004b180: 6528 795f 6376 2c20 656e 7365 6d5f 7072  e(y_cv, ensem_pr
-0004b190: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
-0004b1a0: 2020 2020 2070 7269 6e74 2827 4166 7465       print('Afte
-0004b1b0: 7220 6d75 6c74 6970 6c65 206d 6f64 656c  r multiple model
-0004b1c0: 732c 2045 6e73 656d 626c 6520 4d6f 6465  s, Ensemble Mode
-0004b1d0: 6c20 5265 7375 6c74 733a 2729 0d0a 2020  l Results:')..  
-0004b1e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0004b1f0: 696e 7428 2720 2020 2052 4d53 4520 5363  int('    RMSE Sc
-0004b200: 6f72 6520 3d20 2530 2e35 6627 2025 2872  ore = %0.5f' %(r
-0004b210: 6d73 6c65 5f63 616c 6375 6c61 7465 645f  msle_calculated_
-0004b220: 662c 2929 0d0a 2020 2020 2020 2020 2020  f,))..          
-0004b230: 2020 2020 2020 7072 696e 7428 2723 2323        print('###
-0004b240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b280: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
-0004b290: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0004b2a0: 2072 6d73 6c65 5f63 616c 6375 6c61 7465   rmsle_calculate
-0004b2b0: 645f 6620 3c20 726d 736c 655f 6361 6c63  d_f < rmsle_calc
-0004b2c0: 756c 6174 6564 5f6d 3a0d 0a20 2020 2020  ulated_m:..     
-0004b2d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0004b2e0: 7269 6e74 2827 456e 7365 6d62 6c69 6e67  rint('Ensembling
-0004b2f0: 204d 6f64 656c 7320 6973 2062 6574 7465   Models is bette
-0004b300: 7220 7468 616e 2053 696e 676c 6520 4d6f  r than Single Mo
-0004b310: 6465 6c20 666f 7220 7468 6973 2064 6174  del for this dat
-0004b320: 6120 7365 742e 2729 0d0a 2020 2020 2020  a set.')..      
-0004b330: 2020 2020 2020 2020 2020 2020 2020 6572                er
-0004b340: 726f 725f 7261 7465 2e61 7070 656e 6428  ror_rate.append(
-0004b350: 726d 736c 655f 6361 6c63 756c 6174 6564  rmsle_calculated
-0004b360: 5f66 290d 0a20 2020 2020 2020 2020 2020  _f)..           
-0004b370: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0004b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b390: 7072 696e 7428 2753 696e 676c 6520 4d6f  print('Single Mo
-0004b3a0: 6465 6c20 6973 2062 6574 7465 7220 7468  del is better th
-0004b3b0: 616e 2045 6e73 656d 626c 696e 6720 4d6f  an Ensembling Mo
-0004b3c0: 6465 6c73 2066 6f72 2074 6869 7320 6461  dels for this da
-0004b3d0: 7461 2073 6574 2e27 290d 0a20 2020 2020  ta set.')..     
-0004b3e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004b3f0: 7272 6f72 5f72 6174 652e 6170 7065 6e64  rror_rate.append
-0004b400: 2872 6d73 6c65 5f63 616c 6375 6c61 7465  (rmsle_calculate
-0004b410: 645f 6d29 0d0a 2020 2020 2020 2020 2020  d_m)..          
-0004b420: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004b430: 2020 2020 2020 2020 2072 6d73 6c65 5f63           rmsle_c
-0004b440: 616c 6375 6c61 7465 645f 6620 3d20 6261  alculated_f = ba
-0004b450: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-0004b460: 7363 6f72 6528 795f 6376 2c65 6e73 656d  score(y_cv,ensem
-0004b470: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
-0004b480: 2020 2020 2020 2020 7072 696e 7428 2741          print('A
-0004b490: 6674 6572 206d 756c 7469 706c 6520 6d6f  fter multiple mo
-0004b4a0: 6465 6c73 2c20 456e 7365 6d62 6c65 204d  dels, Ensemble M
-0004b4b0: 6f64 656c 2052 6573 756c 7473 3a27 290d  odel Results:').
-0004b4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b4d0: 2072 6172 655f 7063 7420 3d20 795f 6376   rare_pct = y_cv
-0004b4e0: 5b79 5f63 763d 3d72 6172 655f 636c 6173  [y_cv==rare_clas
-0004b4f0: 735d 2e73 6861 7065 5b30 5d2f 795f 6376  s].shape[0]/y_cv
-0004b500: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
-0004b510: 2020 2020 2020 2020 2020 2023 7072 696e             #prin
-0004b520: 7428 2720 2020 2042 616c 616e 6365 6420  t('    Balanced 
-0004b530: 4163 6375 7261 6379 2053 636f 7265 203d  Accuracy Score =
-0004b540: 2025 302e 3366 2525 2720 2528 0d0a 2020   %0.3f%%' %(..  
-0004b550: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0004b560: 2020 2020 2020 2072 6d73 6c65 5f63 616c         rmsle_cal
-0004b570: 6375 6c61 7465 645f 662a 3130 3029 290d  culated_f*100)).
-0004b580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b590: 2070 7269 6e74 5f63 6c61 7373 6966 6963   print_classific
-0004b5a0: 6174 696f 6e5f 6d65 7472 6963 7328 795f  ation_metrics(y_
-0004b5b0: 6376 2c20 656e 7365 6d5f 7072 6564 2c20  cv, ensem_pred, 
-0004b5c0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-0004b5d0: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
-0004b5e0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0004b5f0: 6f72 7428 795f 6376 2c65 6e73 656d 5f70  ort(y_cv,ensem_p
-0004b600: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
-0004b610: 2020 2020 2020 2070 7269 6e74 2863 6f6e         print(con
-0004b620: 6675 7369 6f6e 5f6d 6174 7269 7828 795f  fusion_matrix(y_
-0004b630: 6376 2c65 6e73 656d 5f70 7265 6429 290d  cv,ensem_pred)).
-0004b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b650: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
-0004b660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b6a0: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
-0004b6b0: 2020 2020 2020 2020 2069 6620 726d 736c           if rmsl
-0004b6c0: 655f 6361 6c63 756c 6174 6564 5f66 203e  e_calculated_f >
-0004b6d0: 2072 6d73 6c65 5f63 616c 6375 6c61 7465   rmsle_calculate
-0004b6e0: 645f 6d3a 0d0a 2020 2020 2020 2020 2020  d_m:..          
-0004b6f0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0004b700: 2745 6e73 656d 626c 696e 6720 4d6f 6465  'Ensembling Mode
-0004b710: 6c73 2069 7320 6265 7474 6572 2074 6861  ls is better tha
-0004b720: 6e20 5369 6e67 6c65 204d 6f64 656c 2066  n Single Model f
-0004b730: 6f72 2074 6869 7320 6461 7461 2073 6574  or this data set
-0004b740: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-0004b750: 2020 2020 2020 2020 2065 7272 6f72 5f72           error_r
-0004b760: 6174 652e 6170 7065 6e64 2872 6d73 6c65  ate.append(rmsle
-0004b770: 5f63 616c 6375 6c61 7465 645f 6629 0d0a  _calculated_f)..
-0004b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b790: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0004b7a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004b7b0: 2827 5369 6e67 6c65 204d 6f64 656c 2069  ('Single Model i
-0004b7c0: 7320 6265 7474 6572 2074 6861 6e20 456e  s better than En
-0004b7d0: 7365 6d62 6c69 6e67 204d 6f64 656c 7320  sembling Models 
-0004b7e0: 666f 7220 7468 6973 2064 6174 6120 7365  for this data se
-0004b7f0: 742e 2729 0d0a 2020 2020 2020 2020 2020  t.')..          
-0004b800: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-0004b810: 7261 7465 2e61 7070 656e 6428 726d 736c  rate.append(rmsl
-0004b820: 655f 6361 6c63 756c 6174 6564 5f6d 290d  e_calculated_m).
-0004b830: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-0004b840: 6f73 6520 3e3d 2031 3a0d 0a20 2020 2020  ose >= 1:..     
-0004b850: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
-0004b860: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
-0004b870: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-0004b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b890: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
-0004b8a0: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
-0004b8b0: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
-0004b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b8d0: 2020 706c 6f74 5f78 6762 5f6d 6574 7269    plot_xgb_metri
-0004b8e0: 6373 286d 6f64 656c 2c63 6174 626f 6f73  cs(model,catboos
-0004b8f0: 745f 7363 6f72 696e 672c 6576 616c 5f73  t_scoring,eval_s
-0004b900: 6574 2c6d 6f64 656c 7479 7065 2c27 2573  et,modeltype,'%s
-0004b910: 2052 6573 756c 7473 2720 2565 6163 685f   Results' %each_
-0004b920: 7461 7267 6574 2c0d 0a20 2020 2020 2020  target,..       
-0004b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b950: 206d 6f64 656c 5f6e 616d 6529 0d0a 2020   model_name)..  
-0004b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b970: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b990: 2070 6c6f 745f 7867 625f 6d65 7472 6963   plot_xgb_metric
-0004b9a0: 7328 6773 2e62 6573 745f 6573 7469 6d61  s(gs.best_estima
-0004b9b0: 746f 725f 2c65 7661 6c5f 6d65 7472 6963  tor_,eval_metric
-0004b9c0: 2c65 7661 6c5f 7365 742c 6d6f 6465 6c74  ,eval_set,modelt
-0004b9d0: 7970 652c 2725 7320 5265 7375 6c74 7327  ype,'%s Results'
-0004b9e0: 2025 6561 6368 5f74 6172 6765 742c 0d0a   %each_target,..
-0004b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ba10: 2020 2020 2020 2020 6d6f 6465 6c5f 6e61          model_na
-0004ba20: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
-0004ba30: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-0004ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ba50: 2020 7072 696e 7428 2743 6f75 6c64 206e    print('Could n
-0004ba60: 6f74 2070 6c6f 7420 4d6f 6465 6c20 4576  ot plot Model Ev
-0004ba70: 616c 7561 7469 6f6e 2052 6573 756c 7473  aluation Results
-0004ba80: 204d 6574 7269 6373 2729 0d0a 2020 2020   Metrics')..    
-0004ba90: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0004baa0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0004bab0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-0004bac0: 2020 2020 2020 2020 2070 6c6f 745f 5253           plot_RS
-0004bad0: 5f70 6172 616d 7328 6773 2e63 765f 7265  _params(gs.cv_re
-0004bae0: 7375 6c74 735f 2c20 7363 6f72 696e 675f  sults_, scoring_
-0004baf0: 7061 7261 6d65 7465 722c 2065 6163 685f  parameter, each_
-0004bb00: 7461 7267 6574 290d 0a20 2020 2020 2020  target)..       
-0004bb10: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-0004bb20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004bb30: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
-0004bb40: 6c64 206e 6f74 2070 6c6f 7420 4372 6f73  ld not plot Cros
-0004bb50: 7320 5661 6c69 6461 7469 6f6e 2050 6172  s Validation Par
-0004bb60: 616d 6574 6572 7327 290d 0a20 2020 2020  ameters')..     
-0004bb70: 2020 2070 7269 6e74 2827 2020 2020 5469     print('    Ti
-0004bb80: 6d65 2074 616b 656e 2066 6f72 2074 6869  me taken for thi
-0004bb90: 7320 5461 7267 6574 2028 696e 2073 6563  s Target (in sec
-0004bba0: 6f6e 6473 2920 3d20 2530 2e30 6627 2025  onds) = %0.0f' %
-0004bbb0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-0004bbc0: 7274 5f74 696d 6529 290d 0a20 2020 2065  rt_time))..    e
-0004bbd0: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
-0004bbe0: 2323 2059 6f75 2063 616e 2075 7365 204a  ## You can use J
-0004bbf0: 6163 6361 7264 2053 696d 696c 6172 6974  accard Similarit
-0004bc00: 7920 666f 7220 4d75 6c74 692d 4c61 6265  y for Multi-Labe
-0004bc10: 6c20 5072 6f62 6c65 6d73 2023 2323 2323  l Problems #####
-0004bc20: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-0004bc30: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
-0004bc40: 6574 6572 203d 3d20 276a 6163 6361 7264  eter == 'jaccard
-0004bc50: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-0004bc60: 6163 6375 5f61 6c6c 203d 206a 6163 6361  accu_all = jacca
-0004bc70: 7264 5f73 696e 676c 656c 6162 656c 2879  rd_singlelabel(y
-0004bc80: 5f63 762c 2079 5f70 7265 6429 0d0a 2020  _cv, y_pred)..  
-0004bc90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0004bca0: 2720 2020 2020 2020 204d 6561 6e20 4a61  '        Mean Ja
-0004bcb0: 6363 6172 6420 5369 6d69 6c61 7269 7479  ccard Similarity
-0004bcc0: 2020 3d20 7b3a 2c2e 3166 7d25 272e 666f    = {:,.1f}%'.fo
-0004bcd0: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-0004bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bcf0: 2020 2020 2020 2020 2020 2061 6363 755f             accu_
-0004bd00: 616c 6c2a 3130 3029 290d 0a20 2020 2020  all*100))..     
-0004bd10: 2020 2020 2020 2023 2320 5468 6973 2069         ## This i
-0004bd20: 7320 666f 7220 6d75 6c74 692d 6c61 6265  s for multi-labe
-0004bd30: 6c20 7072 6f62 6c65 6d73 2023 230d 0a20  l problems ##.. 
-0004bd40: 2020 2020 2020 2020 2020 2069 6620 6d75             if mu
-0004bd50: 6c74 696c 6162 656c 5f63 6f75 6e74 203d  ltilabel_count =
-0004bd60: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-0004bd70: 2020 2020 2020 7a69 7070 6564 203d 2063        zipped = c
-0004bd80: 6f70 792e 6465 6570 636f 7079 2879 5f70  opy.deepcopy(y_p
-0004bd90: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
-0004bda0: 2020 2020 2020 6d75 6c74 696c 6162 656c        multilabel
-0004bdb0: 5f63 6f75 6e74 202b 3d20 310d 0a20 2020  _count += 1..   
-0004bdc0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0004bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bde0: 7a69 7070 6564 203d 207a 6970 287a 6970  zipped = zip(zip
-0004bdf0: 7065 642c 795f 7072 6564 290d 0a20 2020  ped,y_pred)..   
-0004be00: 2020 2020 2020 2020 2020 2020 206d 756c               mul
-0004be10: 7469 6c61 6265 6c5f 636f 756e 7420 2b3d  tilabel_count +=
-0004be20: 2031 0d0a 2020 2020 2020 2020 656c 6966   1..        elif
-0004be30: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-0004be40: 6572 203d 3d20 2762 6173 6b65 745f 7265  er == 'basket_re
-0004be50: 6361 6c6c 273a 0d0a 2020 2020 2020 2020  call':..        
-0004be60: 2020 2020 6966 206d 756c 7469 6c61 6265      if multilabe
-0004be70: 6c5f 636f 756e 7420 3d3d 2030 3a0d 0a20  l_count == 0:.. 
-0004be80: 2020 2020 2020 2020 2020 2020 2020 207a                 z
-0004be90: 6970 7065 6420 3d20 636f 7079 2e64 6565  ipped = copy.dee
-0004bea0: 7063 6f70 7928 795f 7072 6564 290d 0a20  pcopy(y_pred).. 
-0004beb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0004bec0: 756c 7469 6c61 6265 6c5f 636f 756e 7420  ultilabel_count 
-0004bed0: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
-0004bee0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004bef0: 2020 2020 2020 2020 207a 6970 7065 6420           zipped 
-0004bf00: 3d20 7a69 7028 7a69 7070 6564 2c79 5f70  = zip(zipped,y_p
-0004bf10: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
-0004bf20: 2020 2020 2020 6d75 6c74 696c 6162 656c        multilabel
-0004bf30: 5f63 6f75 6e74 202b 3d20 310d 0a20 2020  _count += 1..   
-0004bf40: 2020 2020 2070 7269 6e74 2827 5472 6169       print('Trai
-0004bf50: 6e69 6e67 206d 6f64 656c 206f 6e20 636f  ning model on co
-0004bf60: 6d70 6c65 7465 2054 7261 696e 2064 6174  mplete Train dat
-0004bf70: 6120 616e 6420 5072 6564 6963 7469 6e67  a and Predicting
-0004bf80: 2075 7369 6e67 2067 6976 656e 2054 6573   using given Tes
-0004bf90: 7420 4461 7461 2e2e 2e27 290d 0a20 2020  t Data...')..   
-0004bfa0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0004bfb0: 2320 2020 2020 2020 2049 204d 2050 204f  #        I M P O
-0004bfc0: 2052 2054 2041 204e 2054 3a20 4320 4f20   R T A N T: C O 
-0004bfd0: 4d20 4220 4920 4e20 4920 4e20 4720 2044  M B I N I N G  D
-0004bfe0: 2041 2054 2041 2023 2323 2323 2323 2323   A T A #########
-0004bff0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0004c000: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
-0004c010: 5365 636f 6e64 2074 696d 653a 2077 6520  Second time: we 
-0004c020: 636f 6d62 696e 6520 7472 6169 6e20 616e  combine train an
-0004c030: 6420 4356 2069 6e74 6f20 5472 6169 6e20  d CV into Train 
-0004c040: 616e 6420 5465 7374 2053 6574 7320 2323  and Test Sets ##
-0004c050: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0004c060: 0a20 2020 2074 7261 696e 203d 2070 6172  .    train = par
-0004c070: 745f 7472 6169 6e2e 6170 7065 6e64 2870  t_train.append(p
-0004c080: 6172 745f 6376 290d 0a20 2020 2069 6d70  art_cv)..    imp
-0004c090: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
-0004c0a0: 3d20 5b78 2066 6f72 2078 2069 6e20 6c69  = [x for x in li
-0004c0b0: 7374 2874 7261 696e 2920 6966 2078 206e  st(train) if x n
-0004c0c0: 6f74 2069 6e20 7461 7267 6574 5d0d 0a20  ot in target].. 
-0004c0d0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-0004c0e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c0f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c120: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0004c130: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
-0004c140: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
-0004c150: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-0004c160: 2323 2323 2323 204e 6f77 2074 6861 7420  ###### Now that 
-0004c170: 7765 2068 6176 6520 7573 6564 2070 6172  we have used par
-0004c180: 7469 616c 2064 6174 6120 746f 206d 616b  tial data to mak
-0004c190: 6520 7374 6163 6b69 6e67 2070 7265 6469  e stacking predi
-0004c1a0: 6374 6f72 732c 2077 6520 6361 6e20 7265  ctors, we can re
-0004c1b0: 6d6f 7665 2074 6865 6d20 6672 6f6d 2063  move them from c
-0004c1c0: 6f6e 7369 6465 7261 7469 6f6e 210d 0a20  onsideration!.. 
-0004c1d0: 2020 2020 2020 2069 6620 5374 6163 6b69         if Stacki
-0004c1e0: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
-0004c1f0: 2020 2020 2020 696d 706f 7274 616e 745f        important_
-0004c200: 6665 6174 7572 6573 203d 206c 6566 745f  features = left_
-0004c210: 7375 6274 7261 6374 2869 6d70 6f72 7461  subtract(importa
-0004c220: 6e74 5f66 6561 7475 7265 732c 2061 6464  nt_features, add
-0004c230: 636f 6c29 0d0a 2020 2020 2020 2020 2020  col)..          
-0004c240: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0004c250: 2020 2020 2020 2020 7472 6169 6e2e 6472          train.dr
-0004c260: 6f70 2861 6464 636f 6c2c 6178 6973 3d31  op(addcol,axis=1
-0004c270: 2c20 696e 706c 6163 653d 5472 7565 290d  , inplace=True).
-0004c280: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-0004c290: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0004c2a0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
-0004c2b0: 2020 2020 2323 2323 2323 2053 696d 696c      ###### Simil
-0004c2c0: 6172 6c79 2077 6520 7769 6c6c 2068 6176  arly we will hav
-0004c2d0: 6520 746f 2063 7265 6174 6520 4b4d 6561  e to create KMea
-0004c2e0: 6e73 5f43 6c75 7374 6572 7320 6167 6169  ns_Clusters agai
-0004c2f0: 6e20 7573 696e 6720 6675 6c6c 2054 7261  n using full Tra
-0004c300: 696e 2064 6174 6121 0d0a 2020 2020 2020  in data!..      
-0004c310: 2020 6966 204b 4d65 616e 735f 4665 6174    if KMeans_Feat
-0004c320: 7572 697a 6572 3a0d 0a20 2020 2020 2020  urizer:..       
-0004c330: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-0004c340: 6561 7475 7265 7320 3d20 6c65 6674 5f73  eatures = left_s
-0004c350: 7562 7472 6163 7428 696d 706f 7274 616e  ubtract(importan
-0004c360: 745f 6665 6174 7572 6573 2c20 6b6d 5f6c  t_features, km_l
-0004c370: 6162 656c 290d 0a20 2020 2020 2020 2020  abel)..         
-0004c380: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0004c390: 2020 2020 2020 2020 2074 7261 696e 2e64           train.d
-0004c3a0: 726f 7028 6b6d 5f6c 6162 656c 2c61 7869  rop(km_label,axi
-0004c3b0: 733d 312c 2069 6e70 6c61 6365 3d54 7275  s=1, inplace=Tru
-0004c3c0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0004c3d0: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0004c3e0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-0004c3f0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-0004c400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c410: 2320 4249 4e4e 494e 4720 5345 434f 4e44  # BINNING SECOND
-0004c420: 2054 494d 4520 2023 2323 2323 2323 2323   TIME  #########
+0004aeb0: 2020 2020 7065 7266 6f72 6d65 645f 656e      performed_en
+0004aec0: 7365 6d62 6c69 6e67 203d 2054 7275 650d  sembling = True.
+0004aed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004aee0: 2020 2020 2023 2323 2323 2054 6869 7320       ##### This 
+0004aef0: 6e65 7874 2073 7465 7020 6973 2076 6572  next step is ver
+0004af00: 7920 696d 706f 7274 616e 7420 7369 6e63  y important sinc
+0004af10: 6520 736f 6d65 206d 6f64 656c 7320 6769  e some models gi
+0004af20: 7665 2073 6572 6965 732c 206f 7468 6572  ve series, other
+0004af30: 7320 6769 7665 2061 7272 6179 732e 2056  s give arrays. V
+0004af40: 6572 7920 7061 696e 6675 6c21 0d0a 2020  ery painful!..  
+0004af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004af60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0004af70: 656e 7365 6d5f 7072 6564 2c70 642e 5365  ensem_pred,pd.Se
+0004af80: 7269 6573 293a 0d0a 2020 2020 2020 2020  ries):..        
+0004af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004afa0: 656e 7365 6d5f 7072 6564 203d 2065 6e73  ensem_pred = ens
+0004afb0: 656d 5f70 7265 642e 7661 6c75 6573 0d0a  em_pred.values..
+0004afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004afd0: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0004afe0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0004aff0: 6e74 2827 436f 756c 6420 6e6f 7420 636f  nt('Could not co
+0004b000: 6d70 6c65 7465 2045 6e73 656d 626c 696e  mplete Ensemblin
+0004b010: 6720 7072 6564 6963 7469 6f6e 7320 6f6e  g predictions on
+0004b020: 2068 656c 6420 6f75 7420 6461 7461 2064   held out data d
+0004b030: 7565 2074 6f20 4572 726f 7227 290d 0a20  ue to Error').. 
+0004b040: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0004b050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004b060: 2020 7072 696e 7428 274e 6f20 456e 7365    print('No Ense
+0004b070: 6d62 6c69 6e67 206f 6620 6d6f 6465 6c73  mbling of models
+0004b080: 2064 6f6e 6520 7369 6e63 6520 5374 6163   done since Stac
+0004b090: 6b69 6e67 5f46 6c61 6720 3d20 5472 7565  king_Flag = True
+0004b0a0: 2027 290d 0a20 2020 2020 2020 2020 2020   ')..           
+0004b0b0: 2069 6620 7665 7262 6f73 6520 3e3d 2031   if verbose >= 1
+0004b0c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004b0d0: 2020 2069 6620 6c65 6e28 636c 6173 7365     if len(classe
+0004b0e0: 7329 203d 3d20 323a 0d0a 2020 2020 2020  s) == 2:..      
+0004b0f0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+0004b100: 6f74 5f63 6c61 7373 6966 6963 6174 696f  ot_classificatio
+0004b110: 6e5f 7265 7375 6c74 7328 6d6f 6465 6c2c  n_results(model,
+0004b120: 585f 6376 2c20 795f 6376 2c20 795f 7072  X_cv, y_cv, y_pr
+0004b130: 6564 2c20 636c 6173 7365 732c 2063 6c61  ed, classes, cla
+0004b140: 7373 5f6e 756d 732c 2065 6163 685f 7461  ss_nums, each_ta
+0004b150: 7267 6574 2029 0d0a 2020 2020 2020 2020  rget )..        
+0004b160: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b180: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0004b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b1a0: 2044 7261 775f 524f 435f 4d43 5f4d 4c28   Draw_ROC_MC_ML(
+0004b1b0: 6d6f 6465 6c2c 2058 5f63 762c 2079 5f63  model, X_cv, y_c
+0004b1c0: 762c 2065 6163 685f 7461 7267 6574 2c20  v, each_target, 
+0004b1d0: 6d6f 6465 6c5f 6e61 6d65 2c20 7665 7262  model_name, verb
+0004b1e0: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+0004b1f0: 2020 2020 2020 2020 2020 2020 2020 4472                Dr
+0004b200: 6177 5f4d 435f 4d4c 5f50 525f 524f 435f  aw_MC_ML_PR_ROC_
+0004b210: 4375 7276 6573 286d 6f64 656c 2c58 5f63  Curves(model,X_c
+0004b220: 762c 795f 6376 290d 0a20 2020 2020 2020  v,y_cv)..       
+0004b230: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0004b240: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0004b250: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004b260: 696e 7428 2743 6f75 6c64 206e 6f74 2070  int('Could not p
+0004b270: 6c6f 7420 5052 2061 6e64 2052 4f43 2063  lot PR and ROC c
+0004b280: 7572 7665 732e 2043 6f6e 7469 6e75 696e  urves. Continuin
+0004b290: 672e 2e2e 2729 0d0a 2020 2020 2020 2020  g...')..        
+0004b2a0: 2020 2020 2323 2323 2049 6e20 6361 7365      #### In case
+0004b2b0: 2074 6865 7265 2061 7265 2073 7065 6369   there are speci
+0004b2c0: 616c 2073 636f 7269 6e67 5f70 6172 616d  al scoring_param
+0004b2d0: 6574 6572 2072 6571 7565 7374 732c 2079  eter requests, y
+0004b2e0: 6f75 2063 616e 2070 7269 6e74 2069 7420  ou can print it 
+0004b2f0: 6865 7265 210d 0a20 2020 2020 2020 2020  here!..         
+0004b300: 2020 2069 6620 7363 6f72 696e 675f 7061     if scoring_pa
+0004b310: 7261 6d65 7465 7220 3d3d 2027 726f 635f  rameter == 'roc_
+0004b320: 6175 6327 206f 7220 7363 6f72 696e 675f  auc' or scoring_
+0004b330: 7061 7261 6d65 7465 7220 3d3d 2027 6175  parameter == 'au
+0004b340: 6327 3a0d 0a20 2020 2020 2020 2020 2020  c':..           
+0004b350: 2020 2020 2069 6620 6c65 6e28 636c 6173       if len(clas
+0004b360: 7365 7329 203d 3d20 323a 0d0a 2020 2020  ses) == 2:..    
+0004b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b380: 7072 696e 7428 2720 2020 2052 4f43 2041  print('    ROC A
+0004b390: 5543 2053 636f 7265 203d 2025 302e 3166  UC Score = %0.1f
+0004b3a0: 2525 2720 2528 726f 635f 6175 635f 7363  %%' %(roc_auc_sc
+0004b3b0: 6f72 6528 795f 6376 2c20 795f 7072 6f62  ore(y_cv, y_prob
+0004b3c0: 615b 3a2c 7261 7265 5f63 6c61 7373 5d29  a[:,rare_class])
+0004b3d0: 2a31 3030 2929 0d0a 2020 2020 2020 2020  *100))..        
+0004b3e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b400: 2020 2070 7269 6e74 2827 2020 2020 4e6f     print('    No
+0004b410: 2052 4f43 2041 5543 2073 636f 7265 2066   ROC AUC score f
+0004b420: 6f72 206d 756c 7469 2d63 6c61 7373 2070  or multi-class p
+0004b430: 726f 626c 656d 7327 290d 0a20 2020 2020  roblems')..     
+0004b440: 2020 2069 6620 6e6f 7420 5374 6163 6b69     if not Stacki
+0004b450: 6e67 5f46 6c61 6720 616e 6420 7065 7266  ng_Flag and perf
+0004b460: 6f72 6d65 645f 656e 7365 6d62 6c69 6e67  ormed_ensembling
+0004b470: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0004b480: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+0004b490: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+0004b4a0: 2020 2020 2020 2020 2020 2020 2020 726d                rm
+0004b4b0: 736c 655f 6361 6c63 756c 6174 6564 5f66  sle_calculated_f
+0004b4c0: 203d 2072 6d73 6528 795f 6376 2c20 656e   = rmse(y_cv, en
+0004b4d0: 7365 6d5f 7072 6564 290d 0a20 2020 2020  sem_pred)..     
+0004b4e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004b4f0: 2827 4166 7465 7220 6d75 6c74 6970 6c65  ('After multiple
+0004b500: 206d 6f64 656c 732c 2045 6e73 656d 626c   models, Ensembl
+0004b510: 6520 4d6f 6465 6c20 5265 7375 6c74 733a  e Model Results:
+0004b520: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0004b530: 2020 2020 7072 696e 7428 2720 2020 2052      print('    R
+0004b540: 4d53 4520 5363 6f72 6520 3d20 2530 2e35  MSE Score = %0.5
+0004b550: 6627 2025 2872 6d73 6c65 5f63 616c 6375  f' %(rmsle_calcu
+0004b560: 6c61 7465 645f 662c 2929 0d0a 2020 2020  lated_f,))..    
+0004b570: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004b580: 7428 2723 2323 2323 2323 2323 2323 2323  t('#############
+0004b590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b5d0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0004b5e0: 2020 2020 6966 2072 6d73 6c65 5f63 616c      if rmsle_cal
+0004b5f0: 6375 6c61 7465 645f 6620 3c20 726d 736c  culated_f < rmsl
+0004b600: 655f 6361 6c63 756c 6174 6564 5f6d 3a0d  e_calculated_m:.
+0004b610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b620: 2020 2020 2070 7269 6e74 2827 456e 7365       print('Ense
+0004b630: 6d62 6c69 6e67 204d 6f64 656c 7320 6973  mbling Models is
+0004b640: 2062 6574 7465 7220 7468 616e 2053 696e   better than Sin
+0004b650: 676c 6520 4d6f 6465 6c20 666f 7220 7468  gle Model for th
+0004b660: 6973 2064 6174 6120 7365 742e 2729 0d0a  is data set.')..
+0004b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b680: 2020 2020 6572 726f 725f 7261 7465 2e61      error_rate.a
+0004b690: 7070 656e 6428 726d 736c 655f 6361 6c63  ppend(rmsle_calc
+0004b6a0: 756c 6174 6564 5f66 290d 0a20 2020 2020  ulated_f)..     
+0004b6b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0004b6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004b6d0: 2020 2020 2020 7072 696e 7428 2753 696e        print('Sin
+0004b6e0: 676c 6520 4d6f 6465 6c20 6973 2062 6574  gle Model is bet
+0004b6f0: 7465 7220 7468 616e 2045 6e73 656d 626c  ter than Ensembl
+0004b700: 696e 6720 4d6f 6465 6c73 2066 6f72 2074  ing Models for t
+0004b710: 6869 7320 6461 7461 2073 6574 2e27 290d  his data set.').
+0004b720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b730: 2020 2020 2065 7272 6f72 5f72 6174 652e       error_rate.
+0004b740: 6170 7065 6e64 2872 6d73 6c65 5f63 616c  append(rmsle_cal
+0004b750: 6375 6c61 7465 645f 6d29 0d0a 2020 2020  culated_m)..    
+0004b760: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004b770: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0004b780: 6d73 6c65 5f63 616c 6375 6c61 7465 645f  msle_calculated_
+0004b790: 6620 3d20 6261 6c61 6e63 6564 5f61 6363  f = balanced_acc
+0004b7a0: 7572 6163 795f 7363 6f72 6528 795f 6376  uracy_score(y_cv
+0004b7b0: 2c65 6e73 656d 5f70 7265 6429 0d0a 2020  ,ensem_pred)..  
+0004b7c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004b7d0: 696e 7428 2741 6674 6572 206d 756c 7469  int('After multi
+0004b7e0: 706c 6520 6d6f 6465 6c73 2c20 456e 7365  ple models, Ense
+0004b7f0: 6d62 6c65 204d 6f64 656c 2052 6573 756c  mble Model Resul
+0004b800: 7473 3a27 290d 0a20 2020 2020 2020 2020  ts:')..         
+0004b810: 2020 2020 2020 2072 6172 655f 7063 7420         rare_pct 
+0004b820: 3d20 795f 6376 5b79 5f63 763d 3d72 6172  = y_cv[y_cv==rar
+0004b830: 655f 636c 6173 735d 2e73 6861 7065 5b30  e_class].shape[0
+0004b840: 5d2f 795f 6376 2e73 6861 7065 5b30 5d0d  ]/y_cv.shape[0].
+0004b850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b860: 2023 7072 696e 7428 2720 2020 2042 616c   #print('    Bal
+0004b870: 616e 6365 6420 4163 6375 7261 6379 2053  anced Accuracy S
+0004b880: 636f 7265 203d 2025 302e 3366 2525 2720  core = %0.3f%%' 
+0004b890: 2528 0d0a 2020 2020 2020 2020 2020 2020  %(..            
+0004b8a0: 2020 2020 2320 2020 2020 2020 2072 6d73      #        rms
+0004b8b0: 6c65 5f63 616c 6375 6c61 7465 645f 662a  le_calculated_f*
+0004b8c0: 3130 3029 290d 0a20 2020 2020 2020 2020  100))..         
+0004b8d0: 2020 2020 2020 2070 7269 6e74 5f63 6c61         print_cla
+0004b8e0: 7373 6966 6963 6174 696f 6e5f 6d65 7472  ssification_metr
+0004b8f0: 6963 7328 795f 6376 2c20 656e 7365 6d5f  ics(y_cv, ensem_
+0004b900: 7072 6564 2c20 4661 6c73 6529 0d0a 2020  pred, False)..  
+0004b910: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004b920: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
+0004b930: 6f6e 5f72 6570 6f72 7428 795f 6376 2c65  on_report(y_cv,e
+0004b940: 6e73 656d 5f70 7265 6429 290d 0a20 2020  nsem_pred))..   
+0004b950: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0004b960: 6e74 2863 6f6e 6675 7369 6f6e 5f6d 6174  nt(confusion_mat
+0004b970: 7269 7828 795f 6376 2c65 6e73 656d 5f70  rix(y_cv,ensem_p
+0004b980: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
+0004b990: 2020 2020 2020 2070 7269 6e74 2827 2323         print('##
+0004b9a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b9e0: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+0004b9f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0004ba00: 6620 726d 736c 655f 6361 6c63 756c 6174  f rmsle_calculat
+0004ba10: 6564 5f66 203e 2072 6d73 6c65 5f63 616c  ed_f > rmsle_cal
+0004ba20: 6375 6c61 7465 645f 6d3a 0d0a 2020 2020  culated_m:..    
+0004ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ba40: 7072 696e 7428 2745 6e73 656d 626c 696e  print('Ensemblin
+0004ba50: 6720 4d6f 6465 6c73 2069 7320 6265 7474  g Models is bett
+0004ba60: 6572 2074 6861 6e20 5369 6e67 6c65 204d  er than Single M
+0004ba70: 6f64 656c 2066 6f72 2074 6869 7320 6461  odel for this da
+0004ba80: 7461 2073 6574 2e27 290d 0a20 2020 2020  ta set.')..     
+0004ba90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004baa0: 7272 6f72 5f72 6174 652e 6170 7065 6e64  rror_rate.append
+0004bab0: 2872 6d73 6c65 5f63 616c 6375 6c61 7465  (rmsle_calculate
+0004bac0: 645f 6629 0d0a 2020 2020 2020 2020 2020  d_f)..          
+0004bad0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0004bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004baf0: 2070 7269 6e74 2827 5369 6e67 6c65 204d   print('Single M
+0004bb00: 6f64 656c 2069 7320 6265 7474 6572 2074  odel is better t
+0004bb10: 6861 6e20 456e 7365 6d62 6c69 6e67 204d  han Ensembling M
+0004bb20: 6f64 656c 7320 666f 7220 7468 6973 2064  odels for this d
+0004bb30: 6174 6120 7365 742e 2729 0d0a 2020 2020  ata set.')..    
+0004bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bb50: 6572 726f 725f 7261 7465 2e61 7070 656e  error_rate.appen
+0004bb60: 6428 726d 736c 655f 6361 6c63 756c 6174  d(rmsle_calculat
+0004bb70: 6564 5f6d 290d 0a20 2020 2020 2020 2069  ed_m)..        i
+0004bb80: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
+0004bb90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004bba0: 426f 6f73 7469 6e67 5f46 6c61 673a 0d0a  Boosting_Flag:..
+0004bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bbc0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0004bbd0: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+0004bbe0: 656c 5f6e 616d 652e 6c6f 7765 7228 2920  el_name.lower() 
+0004bbf0: 3d3d 2027 6361 7462 6f6f 7374 273a 0d0a  == 'catboost':..
+0004bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc10: 2020 2020 2020 2020 706c 6f74 5f78 6762          plot_xgb
+0004bc20: 5f6d 6574 7269 6373 286d 6f64 656c 2c63  _metrics(model,c
+0004bc30: 6174 626f 6f73 745f 7363 6f72 696e 672c  atboost_scoring,
+0004bc40: 6576 616c 5f73 6574 2c6d 6f64 656c 7479  eval_set,modelty
+0004bc50: 7065 2c27 2573 2052 6573 756c 7473 2720  pe,'%s Results' 
+0004bc60: 2565 6163 685f 7461 7267 6574 2c0d 0a20  %each_target,.. 
+0004bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc90: 2020 2020 2020 206d 6f64 656c 5f6e 616d         model_nam
+0004bca0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0004bcb0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bcd0: 2020 2020 2020 2070 6c6f 745f 7867 625f         plot_xgb_
+0004bce0: 6d65 7472 6963 7328 6773 2e62 6573 745f  metrics(gs.best_
+0004bcf0: 6573 7469 6d61 746f 725f 2c65 7661 6c5f  estimator_,eval_
+0004bd00: 6d65 7472 6963 2c65 7661 6c5f 7365 742c  metric,eval_set,
+0004bd10: 6d6f 6465 6c74 7970 652c 2725 7320 5265  modeltype,'%s Re
+0004bd20: 7375 6c74 7327 2025 6561 6368 5f74 6172  sults' %each_tar
+0004bd30: 6765 742c 0d0a 2020 2020 2020 2020 2020  get,..          
+0004bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bd50: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0004bd60: 6465 6c5f 6e61 6d65 290d 0a20 2020 2020  del_name)..     
+0004bd70: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0004bd80: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+0004bd90: 2020 2020 2020 2020 7072 696e 7428 2743          print('C
+0004bda0: 6f75 6c64 206e 6f74 2070 6c6f 7420 4d6f  ould not plot Mo
+0004bdb0: 6465 6c20 4576 616c 7561 7469 6f6e 2052  del Evaluation R
+0004bdc0: 6573 756c 7473 204d 6574 7269 6373 2729  esults Metrics')
+0004bdd0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0004bde0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0004bdf0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+0004be00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004be10: 6c6f 745f 5253 5f70 6172 616d 7328 6773  lot_RS_params(gs
+0004be20: 2e63 765f 7265 7375 6c74 735f 2c20 7363  .cv_results_, sc
+0004be30: 6f72 696e 675f 7061 7261 6d65 7465 722c  oring_parameter,
+0004be40: 2065 6163 685f 7461 7267 6574 290d 0a20   each_target).. 
+0004be50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004be60: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0004be70: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004be80: 7428 2743 6f75 6c64 206e 6f74 2070 6c6f  t('Could not plo
+0004be90: 7420 4372 6f73 7320 5661 6c69 6461 7469  t Cross Validati
+0004bea0: 6f6e 2050 6172 616d 6574 6572 7327 290d  on Parameters').
+0004beb0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0004bec0: 2020 2020 5469 6d65 2074 616b 656e 2066      Time taken f
+0004bed0: 6f72 2074 6869 7320 5461 7267 6574 2028  or this Target (
+0004bee0: 696e 2073 6563 6f6e 6473 2920 3d20 2530  in seconds) = %0
+0004bef0: 2e30 6627 2025 2874 696d 652e 7469 6d65  .0f' %(time.time
+0004bf00: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
+0004bf10: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+0004bf20: 2020 2020 2323 2323 2059 6f75 2063 616e      #### You can
+0004bf30: 2075 7365 204a 6163 6361 7264 2053 696d   use Jaccard Sim
+0004bf40: 696c 6172 6974 7920 666f 7220 4d75 6c74  ilarity for Mult
+0004bf50: 692d 4c61 6265 6c20 5072 6f62 6c65 6d73  i-Label Problems
+0004bf60: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+0004bf70: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
+0004bf80: 5f70 6172 616d 6574 6572 203d 3d20 276a  _parameter == 'j
+0004bf90: 6163 6361 7264 273a 0d0a 2020 2020 2020  accard':..      
+0004bfa0: 2020 2020 2020 6163 6375 5f61 6c6c 203d        accu_all =
+0004bfb0: 206a 6163 6361 7264 5f73 696e 676c 656c   jaccard_singlel
+0004bfc0: 6162 656c 2879 5f63 762c 2079 5f70 7265  abel(y_cv, y_pre
+0004bfd0: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+0004bfe0: 7072 696e 7428 2720 2020 2020 2020 204d  print('        M
+0004bff0: 6561 6e20 4a61 6363 6172 6420 5369 6d69  ean Jaccard Simi
+0004c000: 6c61 7269 7479 2020 3d20 7b3a 2c2e 3166  larity  = {:,.1f
+0004c010: 7d25 272e 666f 726d 6174 280d 0a20 2020  }%'.format(..   
+0004c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c040: 2061 6363 755f 616c 6c2a 3130 3029 290d   accu_all*100)).
+0004c050: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
+0004c060: 5468 6973 2069 7320 666f 7220 6d75 6c74  This is for mult
+0004c070: 692d 6c61 6265 6c20 7072 6f62 6c65 6d73  i-label problems
+0004c080: 2023 230d 0a20 2020 2020 2020 2020 2020   ##..           
+0004c090: 2069 6620 6d75 6c74 696c 6162 656c 5f63   if multilabel_c
+0004c0a0: 6f75 6e74 203d 3d20 303a 0d0a 2020 2020  ount == 0:..    
+0004c0b0: 2020 2020 2020 2020 2020 2020 7a69 7070              zipp
+0004c0c0: 6564 203d 2063 6f70 792e 6465 6570 636f  ed = copy.deepco
+0004c0d0: 7079 2879 5f70 7265 6429 0d0a 2020 2020  py(y_pred)..    
+0004c0e0: 2020 2020 2020 2020 2020 2020 6d75 6c74              mult
+0004c0f0: 696c 6162 656c 5f63 6f75 6e74 202b 3d20  ilabel_count += 
+0004c100: 310d 0a20 2020 2020 2020 2020 2020 2065  1..            e
+0004c110: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0004c120: 2020 2020 2020 7a69 7070 6564 203d 207a        zipped = z
+0004c130: 6970 287a 6970 7065 642c 795f 7072 6564  ip(zipped,y_pred
+0004c140: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0004c150: 2020 206d 756c 7469 6c61 6265 6c5f 636f     multilabel_co
+0004c160: 756e 7420 2b3d 2031 0d0a 2020 2020 2020  unt += 1..      
+0004c170: 2020 656c 6966 2073 636f 7269 6e67 5f70    elif scoring_p
+0004c180: 6172 616d 6574 6572 203d 3d20 2762 6173  arameter == 'bas
+0004c190: 6b65 745f 7265 6361 6c6c 273a 0d0a 2020  ket_recall':..  
+0004c1a0: 2020 2020 2020 2020 2020 6966 206d 756c            if mul
+0004c1b0: 7469 6c61 6265 6c5f 636f 756e 7420 3d3d  tilabel_count ==
+0004c1c0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+0004c1d0: 2020 2020 207a 6970 7065 6420 3d20 636f       zipped = co
+0004c1e0: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
+0004c1f0: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+0004c200: 2020 2020 206d 756c 7469 6c61 6265 6c5f       multilabel_
+0004c210: 636f 756e 7420 2b3d 2031 0d0a 2020 2020  count += 1..    
+0004c220: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004c230: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+0004c240: 6970 7065 6420 3d20 7a69 7028 7a69 7070  ipped = zip(zipp
+0004c250: 6564 2c79 5f70 7265 6429 0d0a 2020 2020  ed,y_pred)..    
+0004c260: 2020 2020 2020 2020 2020 2020 6d75 6c74              mult
+0004c270: 696c 6162 656c 5f63 6f75 6e74 202b 3d20  ilabel_count += 
+0004c280: 310d 0a20 2020 2020 2020 2070 7269 6e74  1..        print
+0004c290: 2827 5472 6169 6e69 6e67 206d 6f64 656c  ('Training model
+0004c2a0: 206f 6e20 636f 6d70 6c65 7465 2054 7261   on complete Tra
+0004c2b0: 696e 2064 6174 6120 616e 6420 5072 6564  in data and Pred
+0004c2c0: 6963 7469 6e67 2075 7369 6e67 2067 6976  icting using giv
+0004c2d0: 656e 2054 6573 7420 4461 7461 2e2e 2e27  en Test Data...'
+0004c2e0: 290d 0a20 2020 2023 2323 2323 2323 2323  )..    #########
+0004c2f0: 2323 2323 2323 2320 2020 2020 2020 2049  #######        I
+0004c300: 204d 2050 204f 2052 2054 2041 204e 2054   M P O R T A N T
+0004c310: 3a20 4320 4f20 4d20 4220 4920 4e20 4920  : C O M B I N I 
+0004c320: 4e20 4720 2044 2041 2054 2041 2023 2323  N G  D A T A ###
+0004c330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c340: 2323 230d 0a20 2020 2023 2323 2320 5468  ###..    #### Th
+0004c350: 6973 2069 7320 5365 636f 6e64 2074 696d  is is Second tim
+0004c360: 653a 2077 6520 636f 6d62 696e 6520 7472  e: we combine tr
+0004c370: 6169 6e20 616e 6420 4356 2069 6e74 6f20  ain and CV into 
+0004c380: 5472 6169 6e20 616e 6420 5465 7374 2053  Train and Test S
+0004c390: 6574 7320 2323 2323 2323 2323 2323 2323  ets ############
+0004c3a0: 2323 2323 230d 0a20 2020 2074 7261 696e  #####..    train
+0004c3b0: 203d 2070 6172 745f 7472 6169 6e2e 6170   = part_train.ap
+0004c3c0: 7065 6e64 2870 6172 745f 6376 290d 0a20  pend(part_cv).. 
+0004c3d0: 2020 2069 6d70 6f72 7461 6e74 5f66 6561     important_fea
+0004c3e0: 7475 7265 7320 3d20 5b78 2066 6f72 2078  tures = [x for x
+0004c3f0: 2069 6e20 6c69 7374 2874 7261 696e 2920   in list(train) 
+0004c400: 6966 2078 206e 6f74 2069 6e20 7461 7267  if x not in targ
+0004c410: 6574 5d0d 0a20 2020 2023 2323 2323 2323  et]..    #######
+0004c420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c440: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-0004c450: 6e65 775f 6e75 6d5f 7661 7273 203d 2074  new_num_vars = t
-0004c460: 7261 696e 5b69 6d70 6f72 7461 6e74 5f66  rain[important_f
-0004c470: 6561 7475 7265 735d 2e73 656c 6563 745f  eatures].select_
-0004c480: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
-0004c490: 6e70 2e66 6c6f 6174 3634 2c6e 702e 666c  np.float64,np.fl
-0004c4a0: 6f61 7433 322c 6e70 2e66 6c6f 6174 3136  oat32,np.float16
-0004c4b0: 5d29 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ]).columns.tolis
-0004c4c0: 7428 290d 0a20 2020 2020 2020 2023 2320  t()..        ## 
-0004c4d0: 4e6f 7720 7765 2072 652d 7573 6520 7468  Now we re-use th
-0004c4e0: 6520 7361 7665 645f 6e75 6d5f 7661 7273  e saved_num_vars
-0004c4f0: 2077 6869 6368 2063 6f6e 7461 696e 6564   which contained
-0004c500: 2061 206c 6973 7420 6f66 206e 756d 5f76   a list of num_v
-0004c510: 6172 7320 666f 7220 6269 6e6e 696e 6720  ars for binning 
-0004c520: 6e6f 7721 0d0a 2020 2020 2020 2020 2323  now!..        ##
-0004c530: 2323 2323 204f 6e63 6520 6167 6169 6e20  #### Once again 
-0004c540: 7765 2064 6f20 456e 7472 6f70 7920 4269  we do Entropy Bi
-0004c550: 6e6e 696e 6720 6f6e 2074 6865 2046 756c  nning on the Ful
-0004c560: 6c20 5472 6169 6e20 4461 7461 2053 6574  l Train Data Set
-0004c570: 2021 210d 0a20 2020 2020 2020 2023 2323   !!..        ###
-0004c580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c590: 2323 2323 2323 2320 4249 4e4e 494e 4720  ####### BINNING 
-0004c5a0: 5345 434f 4e44 2054 494d 4520 2023 2323  SECOND TIME  ###
-0004c5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c5c0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-0004c5d0: 2020 2020 2020 6966 2042 696e 6e69 6e67        if Binning
-0004c5e0: 5f46 6c61 6720 616e 6420 6c65 6e28 7361  _Flag and len(sa
-0004c5f0: 7665 645f 6e75 6d5f 7661 7273 2920 3e20  ved_num_vars) > 
-0004c600: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0004c610: 2323 2320 7768 656e 2079 6f75 2062 696e  ### when you bin
-0004c620: 2074 6865 2073 6563 6f6e 6420 7469 6d65   the second time
-0004c630: 2c20 796f 7520 6861 7665 2074 6f20 7365  , you have to se
-0004c640: 6e64 2069 6e20 696d 706f 7274 616e 745f  nd in important_
-0004c650: 6665 6174 7572 6573 2077 6974 6820 6f72  features with or
-0004c660: 6967 696e 616c 0d0a 2020 2020 2020 2020  iginal..        
-0004c670: 2020 2020 2323 2320 6e75 6d65 7269 6320      ### numeric 
-0004c680: 7661 7269 6162 6c65 7320 736f 2074 6861  variables so tha
-0004c690: 7420 6974 2077 6f72 6b73 206f 6e20 6269  t it works on bi
-0004c6a0: 6e6e 696e 6720 6f6e 6c79 2074 686f 7365  nning only those
-0004c6b0: 2e20 4f74 6865 7277 6973 6520 6974 2077  . Otherwise it w
-0004c6c0: 696c 6c20 6661 696c 2e0d 0a20 2020 2020  ill fail...     
-0004c6d0: 2020 2020 2020 2023 696d 706f 7274 616e         #importan
-0004c6e0: 745f 6665 6174 7572 6573 203d 206c 6566  t_features = lef
-0004c6f0: 745f 7375 6274 7261 6374 2869 6d70 6f72  t_subtract(impor
-0004c700: 7461 6e74 5f66 6561 7475 7265 732c 6269  tant_features,bi
-0004c710: 6e6e 6564 5f6e 756d 5f76 6172 7329 0d0a  nned_num_vars)..
-0004c720: 2020 2020 2020 2020 2020 2020 2374 7261              #tra
-0004c730: 696e 203d 2074 7261 696e 5b69 6d70 6f72  in = train[impor
-0004c740: 7461 6e74 5f66 6561 7475 7265 732b 5b65  tant_features+[e
-0004c750: 6163 685f 7461 7267 6574 5d5d 0d0a 2020  ach_target]]..  
-0004c760: 2020 2020 2020 2020 2020 2323 2320 446f            ### Do
-0004c770: 2045 6e74 726f 7079 2042 696e 6e69 6e67   Entropy Binning
-0004c780: 206f 6e6c 7920 6966 2074 6865 7265 2061   only if there a
-0004c790: 7265 206e 756d 6572 6963 2076 6172 6961  re numeric varia
-0004c7a0: 626c 6573 2069 6e20 7468 6520 6461 7461  bles in the data
-0004c7b0: 2073 6574 2120 2323 2323 230d 0a20 2020   set! #####..   
-0004c7c0: 2020 2020 2020 2020 2023 2323 2320 5768           #### Wh
-0004c7d0: 656e 2077 6520 4269 6e20 7468 6520 7365  en we Bin the se
-0004c7e0: 636f 6e64 2066 6972 7374 2074 696d 652c  cond first time,
-0004c7f0: 2077 6520 7365 7420 7468 6520 656e 7472   we set the entr
-0004c800: 6f70 795f 6269 6e6e 696e 6720 666c 6167  opy_binning flag
-0004c810: 2074 6f20 5472 7565 2073 6f0d 0a20 2020   to True so..   
-0004c820: 2020 2020 2020 2020 2023 2323 2320 2020           ####   
-0004c830: 2074 6861 7420 616c 6c20 6e75 6d65 7269   that all numeri
-0004c840: 6320 7661 7269 6162 6c65 7320 7468 6174  c variables that
-0004c850: 2061 7265 2062 696e 6e65 6420 6172 6520   are binned are 
-0004c860: 7265 6d6f 7665 642e 2054 6869 7320 7761  removed. This wa
-0004c870: 792c 206f 6e6c 7920 6269 6e73 2072 656d  y, only bins rem
-0004c880: 6169 6e2e 0d0a 2020 2020 2020 2020 2020  ain...          
-0004c890: 2020 7472 6169 6e2c 206e 756d 5f76 6172    train, num_var
-0004c8a0: 732c 2069 6d70 6f72 7461 6e74 5f66 6561  s, important_fea
-0004c8b0: 7475 7265 732c 2074 6573 7420 3d20 6164  tures, test = ad
-0004c8c0: 645f 656e 7472 6f70 795f 6269 6e6e 696e  d_entropy_binnin
-0004c8d0: 6728 7472 6169 6e2c 2065 6163 685f 7461  g(train, each_ta
-0004c8e0: 7267 6574 2c0d 0a20 2020 2020 2020 2020  rget,..         
-0004c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c910: 2020 2020 2020 2020 2073 6176 6564 5f6e           saved_n
-0004c920: 756d 5f76 6172 732c 2069 6d70 6f72 7461  um_vars, importa
-0004c930: 6e74 5f66 6561 7475 7265 732c 2074 6573  nt_features, tes
-0004c940: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-0004c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c970: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
-0004c980: 2020 656e 7472 6f70 795f 6269 6e6e 696e    entropy_binnin
-0004c990: 673d 5472 7565 2c76 6572 626f 7365 3d76  g=True,verbose=v
-0004c9a0: 6572 626f 7365 290d 0a20 2020 2020 2020  erbose)..       
-0004c9b0: 2020 2020 2023 2323 2320 496e 2073 6176       #### In sav
-0004c9c0: 6564 5f6e 756d 5f76 6172 7320 7765 2073  ed_num_vars we s
-0004c9d0: 656e 6420 696e 2061 6c6c 2074 6865 2063  end in all the c
-0004c9e0: 6f6e 7469 6e75 6f75 735f 7661 7273 2062  ontinuous_vars b
-0004c9f0: 7574 2077 6520 6269 6e20 6f6e 6c79 2074  ut we bin only t
-0004ca00: 6865 2074 6f70 2066 6577 2076 6172 732e  he top few vars.
-0004ca10: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004ca20: 2320 2054 686f 7365 2074 6861 7420 6172  #  Those that ar
-0004ca30: 6520 6269 6e6e 6564 2061 7265 2072 656d  e binned are rem
-0004ca40: 6f76 6564 2066 726f 6d20 7361 7665 645f  oved from saved_
-0004ca50: 6e75 6d5f 7661 7273 2061 6e64 2074 6865  num_vars and the
-0004ca60: 2072 656d 6169 6e69 6e67 2062 6563 6f6d   remaining becom
-0004ca70: 6520 6e75 6d5f 7661 7273 0d0a 2020 2020  e num_vars..    
-0004ca80: 2020 2020 2020 2020 2323 2320 4f75 7220          ### Our 
-0004ca90: 6a6f 6220 6973 2074 6f20 6669 6e64 2074  job is to find t
-0004caa0: 6865 206e 616d 6573 206f 6620 7468 6f73  he names of thos
-0004cab0: 6520 6f72 6967 696e 616c 206e 756d 6572  e original numer
-0004cac0: 6963 2076 6172 6961 626c 6573 2077 6869  ic variables whi
-0004cad0: 6368 2077 6572 6520 6269 6e6e 6564 2e0d  ch were binned..
-0004cae0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-0004caf0: 206f 7269 675f 6e75 6d5f 7661 7273 2063   orig_num_vars c
-0004cb00: 6f6e 7461 696e 7320 6f72 6967 696e 616c  ontains original
-0004cb10: 206e 756d 2076 6172 732e 206e 756d 5f76   num vars. num_v
-0004cb20: 6172 7320 636f 6e74 6169 6e73 2062 696e  ars contains bin
-0004cb30: 6e65 6420 7665 7273 696f 6e73 206f 6620  ned versions of 
-0004cb40: 7468 6f73 6520 7661 7273 2e0d 0a20 2020  those vars...   
-0004cb50: 2020 2020 2020 2020 2023 2323 2054 686f           ### Tho
-0004cb60: 7365 2062 696e 6e65 6420 7661 7269 6162  se binned variab
-0004cb70: 6c65 7320 6861 7665 206e 6f77 2062 6563  les have now bec
-0004cb80: 6f6d 6520 6361 7465 676f 7269 6361 6c20  ome categorical 
-0004cb90: 7661 7273 2061 6e64 206d 7573 7420 6265  vars and must be
-0004cba0: 2061 6464 6564 2074 6f20 696d 705f 6361   added to imp_ca
-0004cbb0: 7473 2e0d 0a20 2020 2020 2020 2020 2020  ts...           
-0004cbc0: 2023 2323 2320 416c 736f 206e 6f74 6520   #### Also note 
-0004cbd0: 7468 6174 2069 6d70 6f72 7461 6e74 5f66  that important_f
-0004cbe0: 6561 7475 7265 7320 646f 6573 206e 6f74  eatures does not
-0004cbf0: 2063 6f6e 7461 696e 206f 7269 675f 6e75   contain orig_nu
-0004cc00: 6d5f 7661 7273 2077 6869 6368 2068 6176  m_vars which hav
-0004cc10: 6520 6265 656e 2065 7261 7365 642e 0d0a  e been erased...
-0004cc20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0004cc30: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004cc40: 2827 2020 2020 4269 6e6e 696e 675f 466c  ('    Binning_Fl
-0004cc50: 6167 2073 6574 2074 6f20 4661 6c73 6520  ag set to False 
-0004cc60: 6f72 2074 6865 7265 2061 7265 206e 6f20  or there are no 
-0004cc70: 666c 6f61 7420 7661 7273 2069 6e20 6461  float vars in da
-0004cc80: 7461 2073 6574 2074 6f20 6265 2062 696e  ta set to be bin
-0004cc90: 6e65 6427 290d 0a20 2020 2020 2020 2023  ned')..        #
-0004cca0: 2323 204e 6f77 2077 6520 6164 6420 616e  ## Now we add an
-0004ccb0: 6f74 6865 7220 4665 6174 7572 6520 7469  other Feature ti
-0004ccc0: 6564 2074 6f20 4b4d 6561 6e73 2063 6c75  ed to KMeans clu
-0004ccd0: 7374 6572 696e 6720 7573 696e 6720 5072  stering using Pr
-0004cce0: 6564 6963 746f 7220 616e 6420 5461 7267  edictor and Targ
-0004ccf0: 6574 2076 6172 6961 626c 6573 2023 2323  et variables ###
-0004cd00: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
-0004cd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004cd20: 2320 2020 4b4d 4541 4e53 2020 2053 4543  #   KMEANS   SEC
-0004cd30: 4f4e 4420 2020 5449 4d45 2020 2020 2023  OND   TIME     #
-0004cd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004cd50: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0004cd60: 2020 2020 2069 6620 4b4d 6561 6e73 5f46       if KMeans_F
-0004cd70: 6561 7475 7269 7a65 7220 616e 6420 6c65  eaturizer and le
-0004cd80: 6e28 7361 7665 645f 6e75 6d5f 7661 7273  n(saved_num_vars
-0004cd90: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
-0004cda0: 2020 2020 2323 2323 2050 6572 666f 726d      #### Perform
-0004cdb0: 204b 4d65 616e 7320 4665 6174 7572 697a   KMeans Featuriz
-0004cdc0: 6572 206f 6e6c 7920 6966 2074 6865 7265  er only if there
-0004cdd0: 2061 7265 206e 756d 6572 6963 2076 6172   are numeric var
-0004cde0: 6961 626c 6573 2069 6e20 6461 7461 2073  iables in data s
-0004cdf0: 6574 2120 2323 2323 2323 2323 230d 0a20  et! #########.. 
-0004ce00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004ce10: 2827 4164 6469 6e67 206f 6e65 2066 6561  ('Adding one fea
-0004ce20: 7475 7265 206e 616d 6564 2025 7320 7573  ture named %s us
-0004ce30: 696e 6720 4b4d 6561 6e73 5f46 6561 7475  ing KMeans_Featu
-0004ce40: 7269 7a65 722e 2e2e 2720 256b 6d5f 6c61  rizer...' %km_la
-0004ce50: 6265 6c29 0d0a 2020 2020 2020 2020 2020  bel)..          
-0004ce60: 2020 2323 2323 204d 616b 6520 7468 6520    #### Make the 
-0004ce70: 6e75 6d62 6572 206f 6620 636c 7573 7465  number of cluste
-0004ce80: 7273 2061 7320 7468 6520 7361 6d65 2061  rs as the same a
-0004ce90: 7320 6c6f 6731 3020 6f66 206e 756d 6265  s log10 of numbe
-0004cea0: 7220 6f66 2072 6f77 7320 696e 2054 7261  r of rows in Tra
-0004ceb0: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
-0004cec0: 6966 2069 7369 6e73 7461 6e63 6528 7465  if isinstance(te
-0004ced0: 7374 2c20 7374 7229 3a0d 0a20 2020 2020  st, str):..     
-0004cee0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-0004cef0: 496e 2073 6f6d 6520 6361 7365 732c 2074  In some cases, t
-0004cf00: 6573 7420 6461 7461 206d 6179 206e 6f74  est data may not
-0004cf10: 2062 6520 6176 6169 6c61 626c 652e 2049   be available. I
-0004cf20: 6e20 7468 6174 2063 6173 652c 206a 7573  n that case, jus
-0004cf30: 7420 7365 6e64 2069 6e20 7472 6169 6e20  t send in train 
-0004cf40: 6173 2074 6573 740d 0a20 2020 2020 2020  as test..       
-0004cf50: 2020 2020 2020 2020 2074 7261 696e 5f63           train_c
-0004cf60: 6c75 7374 6572 2c20 5f20 3d20 5472 616e  luster, _ = Tran
-0004cf70: 7366 6f72 6d5f 4b4d 5f46 6561 7475 7265  sform_KM_Feature
-0004cf80: 7328 7472 6169 6e5b 696d 706f 7274 616e  s(train[importan
-0004cf90: 745f 6665 6174 7572 6573 5d2c 2074 7261  t_features], tra
-0004cfa0: 696e 5b0d 0a20 2020 2020 2020 2020 2020  in[..           
-0004cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cfc0: 2020 2020 2020 2020 2065 6163 685f 7461           each_ta
-0004cfd0: 7267 6574 5d2c 2074 7261 696e 5b69 6d70  rget], train[imp
-0004cfe0: 6f72 7461 6e74 5f66 6561 7475 7265 735d  ortant_features]
-0004cff0: 2c20 6e75 6d5f 636c 7573 7465 7273 290d  , num_clusters).
-0004d000: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0004d010: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0004d020: 2020 2020 2323 2323 2049 6620 7465 7374      #### If test
-0004d030: 2064 6174 6120 6973 2061 7661 696c 6162   data is availab
-0004d040: 6c65 2c20 7365 6e64 2069 6e20 7465 7374  le, send in test
-0004d050: 2064 6174 6120 746f 2067 6574 204b 4d20   data to get KM 
-0004d060: 636c 7573 7465 7273 2066 6f72 2074 6573  clusters for tes
-0004d070: 7420 2323 230d 0a20 2020 2020 2020 2020  t ###..         
-0004d080: 2020 2020 2020 2074 7261 696e 5f63 6c75         train_clu
-0004d090: 7374 6572 2c20 7465 7374 5f63 6c75 7374  ster, test_clust
-0004d0a0: 6572 203d 2054 7261 6e73 666f 726d 5f4b  er = Transform_K
-0004d0b0: 4d5f 4665 6174 7572 6573 2874 7261 696e  M_Features(train
-0004d0c0: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
-0004d0d0: 7265 735d 2c20 7472 6169 6e5b 0d0a 2020  res], train[..  
-0004d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d100: 2020 6561 6368 5f74 6172 6765 745d 2c20    each_target], 
-0004d110: 7465 7374 5b69 6d70 6f72 7461 6e74 5f66  test[important_f
-0004d120: 6561 7475 7265 735d 2c20 6e75 6d5f 636c  eatures], num_cl
-0004d130: 7573 7465 7273 290d 0a20 2020 2020 2020  usters)..       
-0004d140: 2020 2020 2023 2323 2320 4e6f 7720 6d61       #### Now ma
-0004d150: 6b65 2073 7572 6520 7468 6174 2074 6865  ke sure that the
-0004d160: 2063 6174 2066 6561 7475 7265 7320 6172   cat features ar
-0004d170: 6520 6569 7468 6572 2073 7472 696e 6720  e either string 
-0004d180: 6f72 2069 6e74 6567 6572 7320 2323 2323  or integers ####
-0004d190: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004d1a0: 7072 696e 7428 2720 2020 2055 7365 6420  print('    Used 
-0004d1b0: 4b4d 6561 6e73 2074 6f20 6e61 7475 7261  KMeans to natura
-0004d1c0: 6c6c 7920 636c 7573 7465 7220 5472 6169  lly cluster Trai
-0004d1d0: 6e20 7072 6564 6963 746f 7220 7661 7269  n predictor vari
-0004d1e0: 6162 6c65 7320 696e 746f 2025 6420 636c  ables into %d cl
-0004d1f0: 7573 7465 7273 2720 256e 756d 5f63 6c75  usters' %num_clu
-0004d200: 7374 6572 7329 0d0a 2020 2020 2020 2020  sters)..        
-0004d210: 2020 2020 7472 6169 6e5b 6b6d 5f6c 6162      train[km_lab
-0004d220: 656c 5d20 3d20 7472 6169 6e5f 636c 7573  el] = train_clus
-0004d230: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
-0004d240: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0004d250: 6365 2874 6573 742c 2073 7472 293a 0d0a  ce(test, str):..
-0004d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d270: 7465 7374 5b6b 6d5f 6c61 6265 6c5d 203d  test[km_label] =
-0004d280: 2074 6573 745f 636c 7573 7465 720d 0a20   test_cluster.. 
-0004d290: 2020 2020 2020 2020 2020 2023 585f 7472             #X_tr
-0004d2a0: 6169 6e2e 6472 6f70 2865 6163 685f 7461  ain.drop(each_ta
-0004d2b0: 7267 6574 2c61 7869 733d 312c 696e 706c  rget,axis=1,inpl
-0004d2c0: 6163 653d 5472 7565 290d 0a20 2020 2020  ace=True)..     
-0004d2d0: 2020 2020 2020 2066 6f72 2069 6d70 5f63         for imp_c
-0004d2e0: 6174 2069 6e20 696d 705f 6361 7473 3a0d  at in imp_cats:.
-0004d2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d300: 2074 7261 696e 5b69 6d70 5f63 6174 5d20   train[imp_cat] 
-0004d310: 3d20 7472 6169 6e5b 696d 705f 6361 745d  = train[imp_cat]
-0004d320: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
-0004d330: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0004d340: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0004d350: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
-0004d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d370: 2074 6573 745b 696d 705f 6361 745d 203d   test[imp_cat] =
-0004d380: 2074 6573 745b 696d 705f 6361 745d 2e61   test[imp_cat].a
-0004d390: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-0004d3a0: 2020 2020 2020 2020 7361 7665 645f 6e75          saved_nu
-0004d3b0: 6d5f 7661 7273 2e61 7070 656e 6428 6b6d  m_vars.append(km
-0004d3c0: 5f6c 6162 656c 2920 2323 2320 596f 7520  _label) ### You 
-0004d3d0: 6e65 6564 2074 6f20 6164 6420 6974 2074  need to add it t
-0004d3e0: 6f20 7468 6973 2076 6172 6961 626c 6520  o this variable 
-0004d3f0: 6c69 7374 2066 6f72 2053 6361 6c69 6e67  list for Scaling
-0004d400: 206c 6174 6572 210d 0a20 2020 2020 2020   later!..       
-0004d410: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-0004d420: 6561 7475 7265 732e 6170 7065 6e64 286b  eatures.append(k
-0004d430: 6d5f 6c61 6265 6c29 0d0a 2020 2020 2020  m_label)..      
-0004d440: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0004d450: 2323 2323 2323 2323 2323 2323 2053 5441  ############ STA
-0004d460: 434b 494e 4720 5345 434f 4e44 2054 494d  CKING SECOND TIM
-0004d470: 4520 2023 2323 2323 2323 2323 2323 2323  E  #############
-0004d480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004d490: 2323 0d0a 2020 2020 2020 2020 2323 2323  ##..        ####
-0004d4a0: 2323 2323 2320 5468 6973 2069 7320 7768  ##### This is wh
-0004d4b0: 6572 6520 796f 7520 646f 2053 7461 636b  ere you do Stack
-0004d4c0: 696e 6720 6f66 204d 756c 7469 204d 6f64  ing of Multi Mod
-0004d4d0: 656c 2052 6573 756c 7473 2069 6e74 6f20  el Results into 
-0004d4e0: 4f6e 6520 436f 6c75 6d6e 2023 2323 0d0a  One Column ###..
-0004d4f0: 2020 2020 2020 2020 6966 2053 7461 636b          if Stack
-0004d500: 696e 675f 466c 6167 3a0d 0a20 2020 2020  ing_Flag:..     
-0004d510: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0004d520: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0004d530: 2320 496e 206f 7264 6572 2074 6f20 6a6f  # In order to jo
-0004d540: 696e 2c20 796f 7520 6e65 6564 2058 5f74  in, you need X_t
-0004d550: 7261 696e 2074 6f20 6265 2061 2050 616e  rain to be a Pan
-0004d560: 6461 7320 5365 7269 6573 2068 6572 6520  das Series here 
-0004d570: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004d580: 2020 2020 7072 696e 7428 2743 4155 5449      print('CAUTI
-0004d590: 4f4e 3a20 5374 6163 6b69 6e67 2063 616e  ON: Stacking can
-0004d5a0: 2070 726f 6475 6365 2048 6967 686c 7920   produce Highly 
-0004d5b0: 4f76 6572 6669 7420 6d6f 6465 6c73 206f  Overfit models o
-0004d5c0: 6e20 5472 6169 6e69 6e67 2044 6174 612e  n Training Data.
-0004d5d0: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-0004d5e0: 2020 2020 2020 2323 2320 496e 206f 7264        ### In ord
-0004d5f0: 6572 2074 6f20 6176 6f69 6420 6f76 6572  er to avoid over
-0004d600: 6669 7474 696e 672c 2077 6520 6172 6520  fitting, we are 
-0004d610: 676f 696e 6720 746f 206c 6561 726e 2066  going to learn f
-0004d620: 726f 6d20 6120 736d 616c 6c20 7361 6d70  rom a small samp
-0004d630: 6c65 206f 6620 6461 7461 0d0a 2020 2020  le of data..    
-0004d640: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0004d650: 5468 6174 2069 7320 7768 7920 7765 2061  That is why we a
-0004d660: 7265 2075 7369 6e67 2058 5f63 7620 746f  re using X_cv to
-0004d670: 2074 7261 696e 206f 6e20 616e 6420 7573   train on and us
-0004d680: 696e 6720 6974 2074 6f20 7072 6564 6963  ing it to predic
-0004d690: 7420 6f6e 2058 5f74 7261 696e 210d 0a20  t on X_train!.. 
-0004d6a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0004d6b0: 6464 636f 6c2c 2073 7461 636b 7331 203d  ddcol, stacks1 =
-0004d6c0: 2051 7569 636b 4d4c 5f53 7461 636b 696e   QuickML_Stackin
-0004d6d0: 6728 7472 6169 6e5b 696d 706f 7274 616e  g(train[importan
-0004d6e0: 745f 6665 6174 7572 6573 5d2c 7472 6169  t_features],trai
-0004d6f0: 6e5b 6561 6368 5f74 6172 6765 745d 2c27  n[each_target],'
-0004d700: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-0004d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d720: 2020 6d6f 6465 6c74 7970 652c 2042 6f6f    modeltype, Boo
-0004d730: 7374 696e 675f 466c 6167 2c20 7363 6f72  sting_Flag, scor
-0004d740: 696e 675f 7061 7261 6d65 7465 722c 7665  ing_parameter,ve
-0004d750: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
-0004d760: 2020 2020 2020 2020 2323 2323 2320 4164          ##### Ad
-0004d770: 6469 6e67 206d 756c 7469 706c 6520 636f  ding multiple co
-0004d780: 6c75 6d6e 7320 666f 7220 5374 6163 6b69  lumns for Stacki
-0004d790: 6e67 2069 7320 6265 7374 2120 446f 206e  ng is best! Do n
-0004d7a0: 6f74 2064 6f20 7468 6520 6176 6572 6167  ot do the averag
-0004d7b0: 6520 6f66 2070 7265 6469 6374 696f 6e73  e of predictions
-0004d7c0: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-0004d7d0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
-0004d7e0: 6f6e 2077 6520 6164 6420 7468 6520 776f  on we add the wo
-0004d7f0: 7264 2022 5061 7274 6961 6c5f 5472 6169  rd "Partial_Trai
-0004d800: 6e22 2069 7320 746f 2073 686f 7720 7468  n" is to show th
-0004d810: 6174 2074 6865 7365 2053 7461 636b 696e  at these Stackin
-0004d820: 6720 7265 7375 6c74 7320 6172 6520 6672  g results are fr
-0004d830: 6f6d 2050 6172 7469 616c 2054 7261 696e  om Partial Train
-0004d840: 2064 6174 6121 0d0a 2020 2020 2020 2020   data!..        
-0004d850: 2020 2020 2020 2020 6164 6463 6f6c 7320          addcols 
-0004d860: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-0004d870: 6164 6463 6f6c 290d 0a20 2020 2020 2020  addcol)..       
-0004d880: 2020 2020 2020 2020 2023 2323 2323 2041           ##### A
-0004d890: 6464 696e 6720 6d75 6c74 6970 6c65 2063  dding multiple c
-0004d8a0: 6f6c 756d 6e73 2066 6f72 2053 7461 636b  olumns for Stack
-0004d8b0: 696e 6720 6973 2062 6573 7421 2044 6f20  ing is best! Do 
-0004d8c0: 6e6f 7420 646f 2074 6865 2061 7665 7261  not do the avera
-0004d8d0: 6765 206f 6620 7072 6564 6963 7469 6f6e  ge of prediction
-0004d8e0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-0004d8f0: 2020 2020 7472 6169 6e20 3d20 7472 6169      train = trai
-0004d900: 6e2e 6a6f 696e 2870 642e 4461 7461 4672  n.join(pd.DataFr
-0004d910: 616d 6528 7374 6163 6b73 312c 696e 6465  ame(stacks1,inde
-0004d920: 783d 7472 6169 6e2e 696e 6465 782c 0d0a  x=train.index,..
-0004d930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d960: 2020 636f 6c75 6d6e 733d 6164 6463 6f6c    columns=addcol
-0004d970: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
-0004d980: 2020 2020 2023 2323 2323 204c 6561 7669       ##### Leavi
-0004d990: 6e67 206d 756c 7469 706c 6520 636f 6c75  ng multiple colu
-0004d9a0: 6d6e 7320 666f 7220 5374 6163 6b69 6e67  mns for Stacking
-0004d9b0: 2069 7320 6265 7374 2120 446f 206e 6f74   is best! Do not
-0004d9c0: 2064 6f20 7468 6520 6176 6572 6167 6520   do the average 
-0004d9d0: 6f66 2070 7265 6469 6374 696f 6e73 210d  of predictions!.
-0004d9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d9f0: 2070 7269 6e74 2827 2020 2020 4164 6469   print('    Addi
-0004da00: 6e67 2025 6420 5374 6163 6b69 6e67 2066  ng %d Stacking f
-0004da10: 6561 7475 7265 2873 2920 746f 2074 7261  eature(s) to tra
-0004da20: 696e 696e 6720 6461 7461 2720 256c 656e  ining data' %len
-0004da30: 2861 6464 636f 6c73 2929 0d0a 2020 2020  (addcols))..    
-0004da40: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0004da50: 6f74 2069 7369 6e73 7461 6e63 6528 6f72  ot isinstance(or
-0004da60: 6967 5f74 6573 742c 2073 7472 293a 0d0a  ig_test, str):..
-0004da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004da80: 2020 2020 2323 2320 496e 206f 7264 6572      ### In order
-0004da90: 2074 6f20 6176 6f69 6420 6f76 6572 6669   to avoid overfi
-0004daa0: 7474 696e 672c 2077 6520 6172 6520 676f  tting, we are go
-0004dab0: 696e 6720 746f 206c 6561 726e 2066 726f  ing to learn fro
-0004dac0: 6d20 6120 736d 616c 6c20 7361 6d70 6c65  m a small sample
-0004dad0: 206f 6620 6461 7461 0d0a 2020 2020 2020   of data..      
-0004dae0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0004daf0: 2320 5468 6174 2069 7320 7768 7920 7765  # That is why we
-0004db00: 2061 7265 2075 7369 6e67 2058 5f74 7261   are using X_tra
-0004db10: 696e 2074 6f20 7472 6169 6e20 6f6e 2061  in to train on a
-0004db20: 6e64 2075 7369 6e67 2069 7420 746f 2070  nd using it to p
-0004db30: 7265 6469 6374 206f 6e20 585f 7465 7374  redict on X_test
-0004db40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004db50: 2020 2020 2020 5f2c 2073 7461 636b 7332        _, stacks2
-0004db60: 203d 2051 7569 636b 4d4c 5f53 7461 636b   = QuickML_Stack
-0004db70: 696e 6728 7472 6169 6e5b 696d 706f 7274  ing(train[import
-0004db80: 616e 745f 6665 6174 7572 6573 5d2c 7472  ant_features],tr
-0004db90: 6169 6e5b 6561 6368 5f74 6172 6765 745d  ain[each_target]
-0004dba0: 2c74 6573 745b 696d 706f 7274 616e 745f  ,test[important_
-0004dbb0: 6665 6174 7572 6573 5d2c 0d0a 2020 2020  features],..    
-0004dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dbd0: 2020 2020 2020 2020 2020 6d6f 6465 6c74            modelt
-0004dbe0: 7970 652c 2042 6f6f 7374 696e 675f 466c  ype, Boosting_Fl
-0004dbf0: 6167 2c20 7363 6f72 696e 675f 7061 7261  ag, scoring_para
-0004dc00: 6d65 7465 722c 7665 7262 6f73 6529 0d0a  meter,verbose)..
-0004dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dc20: 2020 2020 2323 2323 2320 4164 6469 6e67      ##### Adding
-0004dc30: 206d 756c 7469 706c 6520 636f 6c75 6d6e   multiple column
-0004dc40: 7320 666f 7220 5374 6163 6b69 6e67 2069  s for Stacking i
-0004dc50: 7320 6265 7374 2120 446f 206e 6f74 2064  s best! Do not d
-0004dc60: 6f20 7468 6520 6176 6572 6167 6520 6f66  o the average of
-0004dc70: 2070 7265 6469 6374 696f 6e73 210d 0a20   predictions!.. 
+0004c440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c470: 2323 2323 230d 0a20 2020 2069 6620 6d6f  #####..    if mo
+0004c480: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
+0004c490: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
+0004c4a0: 2020 2020 2020 2323 2323 2323 204e 6f77        ###### Now
+0004c4b0: 2074 6861 7420 7765 2068 6176 6520 7573   that we have us
+0004c4c0: 6564 2070 6172 7469 616c 2064 6174 6120  ed partial data 
+0004c4d0: 746f 206d 616b 6520 7374 6163 6b69 6e67  to make stacking
+0004c4e0: 2070 7265 6469 6374 6f72 732c 2077 6520   predictors, we 
+0004c4f0: 6361 6e20 7265 6d6f 7665 2074 6865 6d20  can remove them 
+0004c500: 6672 6f6d 2063 6f6e 7369 6465 7261 7469  from considerati
+0004c510: 6f6e 210d 0a20 2020 2020 2020 2069 6620  on!..        if 
+0004c520: 5374 6163 6b69 6e67 5f46 6c61 673a 0d0a  Stacking_Flag:..
+0004c530: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+0004c540: 7274 616e 745f 6665 6174 7572 6573 203d  rtant_features =
+0004c550: 206c 6566 745f 7375 6274 7261 6374 2869   left_subtract(i
+0004c560: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+0004c570: 732c 2061 6464 636f 6c29 0d0a 2020 2020  s, addcol)..    
+0004c580: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+0004c590: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0004c5a0: 6169 6e2e 6472 6f70 2861 6464 636f 6c2c  ain.drop(addcol,
+0004c5b0: 6178 6973 3d31 2c20 696e 706c 6163 653d  axis=1, inplace=
+0004c5c0: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
+0004c5d0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+0004c5e0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+0004c5f0: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
+0004c600: 2053 696d 696c 6172 6c79 2077 6520 7769   Similarly we wi
+0004c610: 6c6c 2068 6176 6520 746f 2063 7265 6174  ll have to creat
+0004c620: 6520 4b4d 6561 6e73 5f43 6c75 7374 6572  e KMeans_Cluster
+0004c630: 7320 6167 6169 6e20 7573 696e 6720 6675  s again using fu
+0004c640: 6c6c 2054 7261 696e 2064 6174 6121 0d0a  ll Train data!..
+0004c650: 2020 2020 2020 2020 6966 204b 4d65 616e          if KMean
+0004c660: 735f 4665 6174 7572 697a 6572 3a0d 0a20  s_Featurizer:.. 
+0004c670: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0004c680: 7461 6e74 5f66 6561 7475 7265 7320 3d20  tant_features = 
+0004c690: 6c65 6674 5f73 7562 7472 6163 7428 696d  left_subtract(im
+0004c6a0: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
+0004c6b0: 2c20 6b6d 5f6c 6162 656c 290d 0a20 2020  , km_label)..   
+0004c6c0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+0004c6d0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0004c6e0: 7261 696e 2e64 726f 7028 6b6d 5f6c 6162  rain.drop(km_lab
+0004c6f0: 656c 2c61 7869 733d 312c 2069 6e70 6c61  el,axis=1, inpla
+0004c700: 6365 3d54 7275 6529 0d0a 2020 2020 2020  ce=True)..      
+0004c710: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+0004c720: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004c730: 6173 730d 0a20 2020 2020 2020 2023 2323  ass..        ###
+0004c740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c750: 2323 2323 2323 2320 4249 4e4e 494e 4720  ####### BINNING 
+0004c760: 5345 434f 4e44 2054 494d 4520 2023 2323  SECOND TIME  ###
+0004c770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c780: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0004c790: 2020 2020 2020 6e65 775f 6e75 6d5f 7661        new_num_va
+0004c7a0: 7273 203d 2074 7261 696e 5b69 6d70 6f72  rs = train[impor
+0004c7b0: 7461 6e74 5f66 6561 7475 7265 735d 2e73  tant_features].s
+0004c7c0: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
+0004c7d0: 6c75 6465 3d5b 6e70 2e66 6c6f 6174 3634  lude=[np.float64
+0004c7e0: 2c6e 702e 666c 6f61 7433 322c 6e70 2e66  ,np.float32,np.f
+0004c7f0: 6c6f 6174 3136 5d29 2e63 6f6c 756d 6e73  loat16]).columns
+0004c800: 2e74 6f6c 6973 7428 290d 0a20 2020 2020  .tolist()..     
+0004c810: 2020 2023 2320 4e6f 7720 7765 2072 652d     ## Now we re-
+0004c820: 7573 6520 7468 6520 7361 7665 645f 6e75  use the saved_nu
+0004c830: 6d5f 7661 7273 2077 6869 6368 2063 6f6e  m_vars which con
+0004c840: 7461 696e 6564 2061 206c 6973 7420 6f66  tained a list of
+0004c850: 206e 756d 5f76 6172 7320 666f 7220 6269   num_vars for bi
+0004c860: 6e6e 696e 6720 6e6f 7721 0d0a 2020 2020  nning now!..    
+0004c870: 2020 2020 2323 2323 2323 204f 6e63 6520      ###### Once 
+0004c880: 6167 6169 6e20 7765 2064 6f20 456e 7472  again we do Entr
+0004c890: 6f70 7920 4269 6e6e 696e 6720 6f6e 2074  opy Binning on t
+0004c8a0: 6865 2046 756c 6c20 5472 6169 6e20 4461  he Full Train Da
+0004c8b0: 7461 2053 6574 2021 210d 0a20 2020 2020  ta Set !!..     
+0004c8c0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+0004c8d0: 2323 2323 2323 2323 2323 2323 2320 4249  ############# BI
+0004c8e0: 4e4e 494e 4720 5345 434f 4e44 2054 494d  NNING SECOND TIM
+0004c8f0: 4520 2023 2323 2323 2323 2323 2323 2323  E  #############
+0004c900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c910: 2323 0d0a 2020 2020 2020 2020 6966 2042  ##..        if B
+0004c920: 696e 6e69 6e67 5f46 6c61 6720 616e 6420  inning_Flag and 
+0004c930: 6c65 6e28 7361 7665 645f 6e75 6d5f 7661  len(saved_num_va
+0004c940: 7273 2920 3e20 303a 0d0a 2020 2020 2020  rs) > 0:..      
+0004c950: 2020 2020 2020 2323 2320 7768 656e 2079        ### when y
+0004c960: 6f75 2062 696e 2074 6865 2073 6563 6f6e  ou bin the secon
+0004c970: 6420 7469 6d65 2c20 796f 7520 6861 7665  d time, you have
+0004c980: 2074 6f20 7365 6e64 2069 6e20 696d 706f   to send in impo
+0004c990: 7274 616e 745f 6665 6174 7572 6573 2077  rtant_features w
+0004c9a0: 6974 6820 6f72 6967 696e 616c 0d0a 2020  ith original..  
+0004c9b0: 2020 2020 2020 2020 2020 2323 2320 6e75            ### nu
+0004c9c0: 6d65 7269 6320 7661 7269 6162 6c65 7320  meric variables 
+0004c9d0: 736f 2074 6861 7420 6974 2077 6f72 6b73  so that it works
+0004c9e0: 206f 6e20 6269 6e6e 696e 6720 6f6e 6c79   on binning only
+0004c9f0: 2074 686f 7365 2e20 4f74 6865 7277 6973   those. Otherwis
+0004ca00: 6520 6974 2077 696c 6c20 6661 696c 2e0d  e it will fail..
+0004ca10: 0a20 2020 2020 2020 2020 2020 2023 696d  .            #im
+0004ca20: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
+0004ca30: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
+0004ca40: 2869 6d70 6f72 7461 6e74 5f66 6561 7475  (important_featu
+0004ca50: 7265 732c 6269 6e6e 6564 5f6e 756d 5f76  res,binned_num_v
+0004ca60: 6172 7329 0d0a 2020 2020 2020 2020 2020  ars)..          
+0004ca70: 2020 2374 7261 696e 203d 2074 7261 696e    #train = train
+0004ca80: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
+0004ca90: 7265 732b 5b65 6163 685f 7461 7267 6574  res+[each_target
+0004caa0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
+0004cab0: 2323 2320 446f 2045 6e74 726f 7079 2042  ### Do Entropy B
+0004cac0: 696e 6e69 6e67 206f 6e6c 7920 6966 2074  inning only if t
+0004cad0: 6865 7265 2061 7265 206e 756d 6572 6963  here are numeric
+0004cae0: 2076 6172 6961 626c 6573 2069 6e20 7468   variables in th
+0004caf0: 6520 6461 7461 2073 6574 2120 2323 2323  e data set! ####
+0004cb00: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
+0004cb10: 2323 2320 5768 656e 2077 6520 4269 6e20  ### When we Bin 
+0004cb20: 7468 6520 7365 636f 6e64 2066 6972 7374  the second first
+0004cb30: 2074 696d 652c 2077 6520 7365 7420 7468   time, we set th
+0004cb40: 6520 656e 7472 6f70 795f 6269 6e6e 696e  e entropy_binnin
+0004cb50: 6720 666c 6167 2074 6f20 5472 7565 2073  g flag to True s
+0004cb60: 6f0d 0a20 2020 2020 2020 2020 2020 2023  o..            #
+0004cb70: 2323 2320 2020 2074 6861 7420 616c 6c20  ###    that all 
+0004cb80: 6e75 6d65 7269 6320 7661 7269 6162 6c65  numeric variable
+0004cb90: 7320 7468 6174 2061 7265 2062 696e 6e65  s that are binne
+0004cba0: 6420 6172 6520 7265 6d6f 7665 642e 2054  d are removed. T
+0004cbb0: 6869 7320 7761 792c 206f 6e6c 7920 6269  his way, only bi
+0004cbc0: 6e73 2072 656d 6169 6e2e 0d0a 2020 2020  ns remain...    
+0004cbd0: 2020 2020 2020 2020 7472 6169 6e2c 206e          train, n
+0004cbe0: 756d 5f76 6172 732c 2069 6d70 6f72 7461  um_vars, importa
+0004cbf0: 6e74 5f66 6561 7475 7265 732c 2074 6573  nt_features, tes
+0004cc00: 7420 3d20 6164 645f 656e 7472 6f70 795f  t = add_entropy_
+0004cc10: 6269 6e6e 696e 6728 7472 6169 6e2c 2065  binning(train, e
+0004cc20: 6163 685f 7461 7267 6574 2c0d 0a20 2020  ach_target,..   
+0004cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cc50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0004cc60: 6176 6564 5f6e 756d 5f76 6172 732c 2069  aved_num_vars, i
+0004cc70: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+0004cc80: 732c 2074 6573 742c 0d0a 2020 2020 2020  s, test,..      
+0004cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ccb0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0004ccc0: 6c74 7970 652c 2020 656e 7472 6f70 795f  ltype,  entropy_
+0004ccd0: 6269 6e6e 696e 673d 5472 7565 2c76 6572  binning=True,ver
+0004cce0: 626f 7365 3d76 6572 626f 7365 290d 0a20  bose=verbose).. 
+0004ccf0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+0004cd00: 496e 2073 6176 6564 5f6e 756d 5f76 6172  In saved_num_var
+0004cd10: 7320 7765 2073 656e 6420 696e 2061 6c6c  s we send in all
+0004cd20: 2074 6865 2063 6f6e 7469 6e75 6f75 735f   the continuous_
+0004cd30: 7661 7273 2062 7574 2077 6520 6269 6e20  vars but we bin 
+0004cd40: 6f6e 6c79 2074 6865 2074 6f70 2066 6577  only the top few
+0004cd50: 2076 6172 732e 0d0a 2020 2020 2020 2020   vars...        
+0004cd60: 2020 2020 2323 2320 2054 686f 7365 2074      ###  Those t
+0004cd70: 6861 7420 6172 6520 6269 6e6e 6564 2061  hat are binned a
+0004cd80: 7265 2072 656d 6f76 6564 2066 726f 6d20  re removed from 
+0004cd90: 7361 7665 645f 6e75 6d5f 7661 7273 2061  saved_num_vars a
+0004cda0: 6e64 2074 6865 2072 656d 6169 6e69 6e67  nd the remaining
+0004cdb0: 2062 6563 6f6d 6520 6e75 6d5f 7661 7273   become num_vars
+0004cdc0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+0004cdd0: 2320 4f75 7220 6a6f 6220 6973 2074 6f20  # Our job is to 
+0004cde0: 6669 6e64 2074 6865 206e 616d 6573 206f  find the names o
+0004cdf0: 6620 7468 6f73 6520 6f72 6967 696e 616c  f those original
+0004ce00: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+0004ce10: 6573 2077 6869 6368 2077 6572 6520 6269  es which were bi
+0004ce20: 6e6e 6564 2e0d 0a20 2020 2020 2020 2020  nned...         
+0004ce30: 2020 2023 2323 206f 7269 675f 6e75 6d5f     ### orig_num_
+0004ce40: 7661 7273 2063 6f6e 7461 696e 7320 6f72  vars contains or
+0004ce50: 6967 696e 616c 206e 756d 2076 6172 732e  iginal num vars.
+0004ce60: 206e 756d 5f76 6172 7320 636f 6e74 6169   num_vars contai
+0004ce70: 6e73 2062 696e 6e65 6420 7665 7273 696f  ns binned versio
+0004ce80: 6e73 206f 6620 7468 6f73 6520 7661 7273  ns of those vars
+0004ce90: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+0004cea0: 2323 2054 686f 7365 2062 696e 6e65 6420  ## Those binned 
+0004ceb0: 7661 7269 6162 6c65 7320 6861 7665 206e  variables have n
+0004cec0: 6f77 2062 6563 6f6d 6520 6361 7465 676f  ow become catego
+0004ced0: 7269 6361 6c20 7661 7273 2061 6e64 206d  rical vars and m
+0004cee0: 7573 7420 6265 2061 6464 6564 2074 6f20  ust be added to 
+0004cef0: 696d 705f 6361 7473 2e0d 0a20 2020 2020  imp_cats...     
+0004cf00: 2020 2020 2020 2023 2323 2320 416c 736f         #### Also
+0004cf10: 206e 6f74 6520 7468 6174 2069 6d70 6f72   note that impor
+0004cf20: 7461 6e74 5f66 6561 7475 7265 7320 646f  tant_features do
+0004cf30: 6573 206e 6f74 2063 6f6e 7461 696e 206f  es not contain o
+0004cf40: 7269 675f 6e75 6d5f 7661 7273 2077 6869  rig_num_vars whi
+0004cf50: 6368 2068 6176 6520 6265 656e 2065 7261  ch have been era
+0004cf60: 7365 642e 0d0a 2020 2020 2020 2020 656c  sed...        el
+0004cf70: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0004cf80: 2070 7269 6e74 2827 2020 2020 4269 6e6e   print('    Binn
+0004cf90: 696e 675f 466c 6167 2073 6574 2074 6f20  ing_Flag set to 
+0004cfa0: 4661 6c73 6520 6f72 2074 6865 7265 2061  False or there a
+0004cfb0: 7265 206e 6f20 666c 6f61 7420 7661 7273  re no float vars
+0004cfc0: 2069 6e20 6461 7461 2073 6574 2074 6f20   in data set to 
+0004cfd0: 6265 2062 696e 6e65 6427 290d 0a20 2020  be binned')..   
+0004cfe0: 2020 2020 2023 2323 204e 6f77 2077 6520       ### Now we 
+0004cff0: 6164 6420 616e 6f74 6865 7220 4665 6174  add another Feat
+0004d000: 7572 6520 7469 6564 2074 6f20 4b4d 6561  ure tied to KMea
+0004d010: 6e73 2063 6c75 7374 6572 696e 6720 7573  ns clustering us
+0004d020: 696e 6720 5072 6564 6963 746f 7220 616e  ing Predictor an
+0004d030: 6420 5461 7267 6574 2076 6172 6961 626c  d Target variabl
+0004d040: 6573 2023 2323 0d0a 2020 2020 2020 2020  es ###..        
+0004d050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004d060: 2323 2323 2323 2320 2020 4b4d 4541 4e53  #######   KMEANS
+0004d070: 2020 2053 4543 4f4e 4420 2020 5449 4d45     SECOND   TIME
+0004d080: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+0004d090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004d0a0: 230d 0a20 2020 2020 2020 2069 6620 4b4d  #..        if KM
+0004d0b0: 6561 6e73 5f46 6561 7475 7269 7a65 7220  eans_Featurizer 
+0004d0c0: 616e 6420 6c65 6e28 7361 7665 645f 6e75  and len(saved_nu
+0004d0d0: 6d5f 7661 7273 2920 3e20 303a 0d0a 2020  m_vars) > 0:..  
+0004d0e0: 2020 2020 2020 2020 2020 2323 2323 2050            #### P
+0004d0f0: 6572 666f 726d 204b 4d65 616e 7320 4665  erform KMeans Fe
+0004d100: 6174 7572 697a 6572 206f 6e6c 7920 6966  aturizer only if
+0004d110: 2074 6865 7265 2061 7265 206e 756d 6572   there are numer
+0004d120: 6963 2076 6172 6961 626c 6573 2069 6e20  ic variables in 
+0004d130: 6461 7461 2073 6574 2120 2323 2323 2323  data set! ######
+0004d140: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0004d150: 2070 7269 6e74 2827 4164 6469 6e67 206f   print('Adding o
+0004d160: 6e65 2066 6561 7475 7265 206e 616d 6564  ne feature named
+0004d170: 2025 7320 7573 696e 6720 4b4d 6561 6e73   %s using KMeans
+0004d180: 5f46 6561 7475 7269 7a65 722e 2e2e 2720  _Featurizer...' 
+0004d190: 256b 6d5f 6c61 6265 6c29 0d0a 2020 2020  %km_label)..    
+0004d1a0: 2020 2020 2020 2020 2323 2323 204d 616b          #### Mak
+0004d1b0: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+0004d1c0: 636c 7573 7465 7273 2061 7320 7468 6520  clusters as the 
+0004d1d0: 7361 6d65 2061 7320 6c6f 6731 3020 6f66  same as log10 of
+0004d1e0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+0004d1f0: 696e 2054 7261 696e 0d0a 2020 2020 2020  in Train..      
+0004d200: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0004d210: 6e63 6528 7465 7374 2c20 7374 7229 3a0d  nce(test, str):.
+0004d220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d230: 2023 2323 2320 496e 2073 6f6d 6520 6361   #### In some ca
+0004d240: 7365 732c 2074 6573 7420 6461 7461 206d  ses, test data m
+0004d250: 6179 206e 6f74 2062 6520 6176 6169 6c61  ay not be availa
+0004d260: 626c 652e 2049 6e20 7468 6174 2063 6173  ble. In that cas
+0004d270: 652c 206a 7573 7420 7365 6e64 2069 6e20  e, just send in 
+0004d280: 7472 6169 6e20 6173 2074 6573 740d 0a20  train as test.. 
+0004d290: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0004d2a0: 7261 696e 5f63 6c75 7374 6572 2c20 5f20  rain_cluster, _ 
+0004d2b0: 3d20 5472 616e 7366 6f72 6d5f 4b4d 5f46  = Transform_KM_F
+0004d2c0: 6561 7475 7265 7328 7472 6169 6e5b 696d  eatures(train[im
+0004d2d0: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
+0004d2e0: 5d2c 2074 7261 696e 5b0d 0a20 2020 2020  ], train[..     
+0004d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d300: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004d310: 6163 685f 7461 7267 6574 5d2c 2074 7261  ach_target], tra
+0004d320: 696e 5b69 6d70 6f72 7461 6e74 5f66 6561  in[important_fea
+0004d330: 7475 7265 735d 2c20 6e75 6d5f 636c 7573  tures], num_clus
+0004d340: 7465 7273 290d 0a20 2020 2020 2020 2020  ters)..         
+0004d350: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0004d360: 2020 2020 2020 2020 2020 2323 2323 2049            #### I
+0004d370: 6620 7465 7374 2064 6174 6120 6973 2061  f test data is a
+0004d380: 7661 696c 6162 6c65 2c20 7365 6e64 2069  vailable, send i
+0004d390: 6e20 7465 7374 2064 6174 6120 746f 2067  n test data to g
+0004d3a0: 6574 204b 4d20 636c 7573 7465 7273 2066  et KM clusters f
+0004d3b0: 6f72 2074 6573 7420 2323 230d 0a20 2020  or test ###..   
+0004d3c0: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+0004d3d0: 696e 5f63 6c75 7374 6572 2c20 7465 7374  in_cluster, test
+0004d3e0: 5f63 6c75 7374 6572 203d 2054 7261 6e73  _cluster = Trans
+0004d3f0: 666f 726d 5f4b 4d5f 4665 6174 7572 6573  form_KM_Features
+0004d400: 2874 7261 696e 5b69 6d70 6f72 7461 6e74  (train[important
+0004d410: 5f66 6561 7475 7265 735d 2c20 7472 6169  _features], trai
+0004d420: 6e5b 0d0a 2020 2020 2020 2020 2020 2020  n[..            
+0004d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d440: 2020 2020 2020 2020 6561 6368 5f74 6172          each_tar
+0004d450: 6765 745d 2c20 7465 7374 5b69 6d70 6f72  get], test[impor
+0004d460: 7461 6e74 5f66 6561 7475 7265 735d 2c20  tant_features], 
+0004d470: 6e75 6d5f 636c 7573 7465 7273 290d 0a20  num_clusters).. 
+0004d480: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+0004d490: 4e6f 7720 6d61 6b65 2073 7572 6520 7468  Now make sure th
+0004d4a0: 6174 2074 6865 2063 6174 2066 6561 7475  at the cat featu
+0004d4b0: 7265 7320 6172 6520 6569 7468 6572 2073  res are either s
+0004d4c0: 7472 696e 6720 6f72 2069 6e74 6567 6572  tring or integer
+0004d4d0: 7320 2323 2323 2323 0d0a 2020 2020 2020  s ######..      
+0004d4e0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0004d4f0: 2055 7365 6420 4b4d 6561 6e73 2074 6f20   Used KMeans to 
+0004d500: 6e61 7475 7261 6c6c 7920 636c 7573 7465  naturally cluste
+0004d510: 7220 5472 6169 6e20 7072 6564 6963 746f  r Train predicto
+0004d520: 7220 7661 7269 6162 6c65 7320 696e 746f  r variables into
+0004d530: 2025 6420 636c 7573 7465 7273 2720 256e   %d clusters' %n
+0004d540: 756d 5f63 6c75 7374 6572 7329 0d0a 2020  um_clusters)..  
+0004d550: 2020 2020 2020 2020 2020 7472 6169 6e5b            train[
+0004d560: 6b6d 5f6c 6162 656c 5d20 3d20 7472 6169  km_label] = trai
+0004d570: 6e5f 636c 7573 7465 720d 0a20 2020 2020  n_cluster..     
+0004d580: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+0004d590: 696e 7374 616e 6365 2874 6573 742c 2073  instance(test, s
+0004d5a0: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+0004d5b0: 2020 2020 2020 7465 7374 5b6b 6d5f 6c61        test[km_la
+0004d5c0: 6265 6c5d 203d 2074 6573 745f 636c 7573  bel] = test_clus
+0004d5d0: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
+0004d5e0: 2023 585f 7472 6169 6e2e 6472 6f70 2865   #X_train.drop(e
+0004d5f0: 6163 685f 7461 7267 6574 2c61 7869 733d  ach_target,axis=
+0004d600: 312c 696e 706c 6163 653d 5472 7565 290d  1,inplace=True).
+0004d610: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0004d620: 2069 6d70 5f63 6174 2069 6e20 696d 705f   imp_cat in imp_
+0004d630: 6361 7473 3a0d 0a20 2020 2020 2020 2020  cats:..         
+0004d640: 2020 2020 2020 2074 7261 696e 5b69 6d70         train[imp
+0004d650: 5f63 6174 5d20 3d20 7472 6169 6e5b 696d  _cat] = train[im
+0004d660: 705f 6361 745d 2e61 7374 7970 6528 696e  p_cat].astype(in
+0004d670: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+0004d680: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0004d690: 7461 6e63 6528 7465 7374 2c20 7374 7229  tance(test, str)
+0004d6a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004d6b0: 2020 2020 2020 2074 6573 745b 696d 705f         test[imp_
+0004d6c0: 6361 745d 203d 2074 6573 745b 696d 705f  cat] = test[imp_
+0004d6d0: 6361 745d 2e61 7374 7970 6528 696e 7429  cat].astype(int)
+0004d6e0: 0d0a 2020 2020 2020 2020 2020 2020 7361  ..            sa
+0004d6f0: 7665 645f 6e75 6d5f 7661 7273 2e61 7070  ved_num_vars.app
+0004d700: 656e 6428 6b6d 5f6c 6162 656c 2920 2323  end(km_label) ##
+0004d710: 2320 596f 7520 6e65 6564 2074 6f20 6164  # You need to ad
+0004d720: 6420 6974 2074 6f20 7468 6973 2076 6172  d it to this var
+0004d730: 6961 626c 6520 6c69 7374 2066 6f72 2053  iable list for S
+0004d740: 6361 6c69 6e67 206c 6174 6572 210d 0a20  caling later!.. 
+0004d750: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0004d760: 7461 6e74 5f66 6561 7475 7265 732e 6170  tant_features.ap
+0004d770: 7065 6e64 286b 6d5f 6c61 6265 6c29 0d0a  pend(km_label)..
+0004d780: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+0004d790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004d7a0: 2323 2053 5441 434b 494e 4720 5345 434f  ## STACKING SECO
+0004d7b0: 4e44 2054 494d 4520 2023 2323 2323 2323  ND TIME  #######
+0004d7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004d7d0: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+0004d7e0: 2020 2323 2323 2323 2323 2320 5468 6973    ######### This
+0004d7f0: 2069 7320 7768 6572 6520 796f 7520 646f   is where you do
+0004d800: 2053 7461 636b 696e 6720 6f66 204d 756c   Stacking of Mul
+0004d810: 7469 204d 6f64 656c 2052 6573 756c 7473  ti Model Results
+0004d820: 2069 6e74 6f20 4f6e 6520 436f 6c75 6d6e   into One Column
+0004d830: 2023 2323 0d0a 2020 2020 2020 2020 6966   ###..        if
+0004d840: 2053 7461 636b 696e 675f 466c 6167 3a0d   Stacking_Flag:.
+0004d850: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+0004d860: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004d870: 2020 2023 2323 2320 496e 206f 7264 6572     #### In order
+0004d880: 2074 6f20 6a6f 696e 2c20 796f 7520 6e65   to join, you ne
+0004d890: 6564 2058 5f74 7261 696e 2074 6f20 6265  ed X_train to be
+0004d8a0: 2061 2050 616e 6461 7320 5365 7269 6573   a Pandas Series
+0004d8b0: 2068 6572 6520 2323 0d0a 2020 2020 2020   here ##..      
+0004d8c0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0004d8d0: 2743 4155 5449 4f4e 3a20 5374 6163 6b69  'CAUTION: Stacki
+0004d8e0: 6e67 2063 616e 2070 726f 6475 6365 2048  ng can produce H
+0004d8f0: 6967 686c 7920 4f76 6572 6669 7420 6d6f  ighly Overfit mo
+0004d900: 6465 6c73 206f 6e20 5472 6169 6e69 6e67  dels on Training
+0004d910: 2044 6174 612e 2e2e 2729 0d0a 2020 2020   Data...')..    
+0004d920: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0004d930: 496e 206f 7264 6572 2074 6f20 6176 6f69  In order to avoi
+0004d940: 6420 6f76 6572 6669 7474 696e 672c 2077  d overfitting, w
+0004d950: 6520 6172 6520 676f 696e 6720 746f 206c  e are going to l
+0004d960: 6561 726e 2066 726f 6d20 6120 736d 616c  earn from a smal
+0004d970: 6c20 7361 6d70 6c65 206f 6620 6461 7461  l sample of data
+0004d980: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004d990: 2020 2323 2320 5468 6174 2069 7320 7768    ### That is wh
+0004d9a0: 7920 7765 2061 7265 2075 7369 6e67 2058  y we are using X
+0004d9b0: 5f63 7620 746f 2074 7261 696e 206f 6e20  _cv to train on 
+0004d9c0: 616e 6420 7573 696e 6720 6974 2074 6f20  and using it to 
+0004d9d0: 7072 6564 6963 7420 6f6e 2058 5f74 7261  predict on X_tra
+0004d9e0: 696e 210d 0a20 2020 2020 2020 2020 2020  in!..           
+0004d9f0: 2020 2020 2061 6464 636f 6c2c 2073 7461       addcol, sta
+0004da00: 636b 7331 203d 2051 7569 636b 4d4c 5f53  cks1 = QuickML_S
+0004da10: 7461 636b 696e 6728 7472 6169 6e5b 696d  tacking(train[im
+0004da20: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
+0004da30: 5d2c 7472 6169 6e5b 6561 6368 5f74 6172  ],train[each_tar
+0004da40: 6765 745d 2c27 272c 0d0a 2020 2020 2020  get],'',..      
+0004da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004da60: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+0004da70: 652c 2042 6f6f 7374 696e 675f 466c 6167  e, Boosting_Flag
+0004da80: 2c20 7363 6f72 696e 675f 7061 7261 6d65  , scoring_parame
+0004da90: 7465 722c 7665 7262 6f73 6529 0d0a 2020  ter,verbose)..  
+0004daa0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0004dab0: 2323 2320 4164 6469 6e67 206d 756c 7469  ### Adding multi
+0004dac0: 706c 6520 636f 6c75 6d6e 7320 666f 7220  ple columns for 
+0004dad0: 5374 6163 6b69 6e67 2069 7320 6265 7374  Stacking is best
+0004dae0: 2120 446f 206e 6f74 2064 6f20 7468 6520  ! Do not do the 
+0004daf0: 6176 6572 6167 6520 6f66 2070 7265 6469  average of predi
+0004db00: 6374 696f 6e73 210d 0a20 2020 2020 2020  ctions!..       
+0004db10: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
+0004db20: 6520 7265 6173 6f6e 2077 6520 6164 6420  e reason we add 
+0004db30: 7468 6520 776f 7264 2022 5061 7274 6961  the word "Partia
+0004db40: 6c5f 5472 6169 6e22 2069 7320 746f 2073  l_Train" is to s
+0004db50: 686f 7720 7468 6174 2074 6865 7365 2053  how that these S
+0004db60: 7461 636b 696e 6720 7265 7375 6c74 7320  tacking results 
+0004db70: 6172 6520 6672 6f6d 2050 6172 7469 616c  are from Partial
+0004db80: 2054 7261 696e 2064 6174 6121 0d0a 2020   Train data!..  
+0004db90: 2020 2020 2020 2020 2020 2020 2020 6164                ad
+0004dba0: 6463 6f6c 7320 3d20 636f 7079 2e64 6565  dcols = copy.dee
+0004dbb0: 7063 6f70 7928 6164 6463 6f6c 290d 0a20  pcopy(addcol).. 
+0004dbc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004dbd0: 2323 2323 2041 6464 696e 6720 6d75 6c74  #### Adding mult
+0004dbe0: 6970 6c65 2063 6f6c 756d 6e73 2066 6f72  iple columns for
+0004dbf0: 2053 7461 636b 696e 6720 6973 2062 6573   Stacking is bes
+0004dc00: 7421 2044 6f20 6e6f 7420 646f 2074 6865  t! Do not do the
+0004dc10: 2061 7665 7261 6765 206f 6620 7072 6564   average of pred
+0004dc20: 6963 7469 6f6e 7321 0d0a 2020 2020 2020  ictions!..      
+0004dc30: 2020 2020 2020 2020 2020 7472 6169 6e20            train 
+0004dc40: 3d20 7472 6169 6e2e 6a6f 696e 2870 642e  = train.join(pd.
+0004dc50: 4461 7461 4672 616d 6528 7374 6163 6b73  DataFrame(stacks
+0004dc60: 312c 696e 6465 783d 7472 6169 6e2e 696e  1,index=train.in
+0004dc70: 6465 782c 0d0a 2020 2020 2020 2020 2020  dex,..          
 0004dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dc90: 2020 2074 6573 7420 3d20 7465 7374 2e6a     test = test.j
-0004dca0: 6f69 6e28 7064 2e44 6174 6146 7261 6d65  oin(pd.DataFrame
-0004dcb0: 2873 7461 636b 7332 2c69 6e64 6578 3d74  (stacks2,index=t
-0004dcc0: 6573 742e 696e 6465 782c 0d0a 2020 2020  est.index,..    
-0004dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dd00: 2020 636f 6c75 6d6e 733d 6164 6463 6f6c    columns=addcol
-0004dd10: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
-0004dd20: 2020 2020 2020 2020 2023 2323 2323 2041           ##### A
-0004dd30: 6464 696e 6720 6d75 6c74 6970 6c65 2063  dding multiple c
-0004dd40: 6f6c 756d 6e73 2066 6f72 2053 7461 636b  olumns for Stack
-0004dd50: 696e 6720 6973 2062 6573 7421 2044 6f20  ing is best! Do 
-0004dd60: 6e6f 7420 646f 2074 6865 2061 7665 7261  not do the avera
-0004dd70: 6765 206f 6620 7072 6564 6963 7469 6f6e  ge of prediction
-0004dd80: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-0004dd90: 2020 2020 2020 2020 2374 6573 7420 3d20          #test = 
-0004dda0: 7465 7374 2e6a 6f69 6e28 7064 2e44 6174  test.join(pd.Dat
-0004ddb0: 6146 7261 6d65 2873 7461 636b 7332 2e6d  aFrame(stacks2.m
-0004ddc0: 6561 6e28 6178 6973 3d31 292e 726f 756e  ean(axis=1).roun
-0004ddd0: 6428 292e 6173 7479 7065 2869 6e74 292c  d().astype(int),
-0004dde0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004ddf0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-0004de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004de10: 2020 2020 636f 6c75 6d6e 733d 5b61 6464      columns=[add
-0004de20: 636f 6c5d 2c69 6e64 6578 3d74 6573 742e  col],index=test.
-0004de30: 696e 6465 7829 290d 0a20 2020 2020 2020  index))..       
-0004de40: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
-0004de50: 2057 6520 6d61 6b65 2073 7572 6520 7468   We make sure th
-0004de60: 6174 2077 6520 7265 6d6f 7665 2074 6f6f  at we remove too
-0004de70: 206d 616e 7920 6665 6174 7572 6573 2074   many features t
-0004de80: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
-0004de90: 6f72 7265 6c61 7465 6420 2120 2323 2323  orrelated ! ####
-0004dea0: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-0004deb0: 2020 2023 6164 6463 6f6c 203d 2072 656d     #addcol = rem
-0004dec0: 6f76 655f 7661 7269 6162 6c65 735f 7573  ove_variables_us
-0004ded0: 696e 675f 6661 7374 5f63 6f72 7265 6c61  ing_fast_correla
-0004dee0: 7469 6f6e 2874 7261 696e 2c61 6464 636f  tion(train,addco
-0004def0: 6c2c 6d6f 6465 6c74 7970 652c 636f 7272  l,modeltype,corr
-0004df00: 5f6c 696d 6974 2c76 6572 626f 7365 290d  _limit,verbose).
-0004df10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004df20: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
-0004df30: 7265 7320 2b3d 2061 6464 636f 6c73 0d0a  res += addcols..
-0004df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004df50: 7361 7665 645f 6e75 6d5f 7661 7273 2e61  saved_num_vars.a
-0004df60: 7070 656e 6428 6164 6463 6f6c 2920 2323  ppend(addcol) ##
-0004df70: 2320 596f 7520 6e65 6564 2074 6f20 6164  # You need to ad
-0004df80: 6420 6974 2066 6f72 2062 696e 6e69 6e67  d it for binning
-0004df90: 206c 6174 6572 210d 0a20 2020 2020 2020   later!..       
-0004dfa0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-0004dfb0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0004dfc0: 696e 7428 2745 7272 6f72 2069 6e20 5374  int('Error in St
-0004dfd0: 6163 6b69 6e67 2073 6563 6f6e 6420 7469  acking second ti
-0004dfe0: 6d65 2e20 436f 6e74 696e 7569 6e67 2e2e  me. Continuing..
-0004dff0: 2e27 290d 0a20 2020 2023 2323 2323 2323  .')..    #######
-0004e000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e050: 2323 2323 230d 0a20 2020 2069 6620 6c65  #####..    if le
-0004e060: 6e28 696d 706f 7274 616e 745f 6665 6174  n(important_feat
-0004e070: 7572 6573 2920 3d3d 2030 3a0d 0a20 2020  ures) == 0:..   
-0004e080: 2020 2020 2070 7269 6e74 2827 4e6f 2069       print('No i
-0004e090: 6d70 6f72 7461 6e74 2066 6561 7475 7265  mportant feature
-0004e0a0: 7320 666f 756e 642e 2055 7369 6e67 2061  s found. Using a
-0004e0b0: 6c6c 2069 6e70 7574 2066 6561 7475 7265  ll input feature
-0004e0c0: 732e 2e2e 2729 0d0a 2020 2020 2020 2020  s...')..        
-0004e0d0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004e0e0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
-0004e0f0: 7079 2873 6176 6564 5f69 6d70 6f72 7461  py(saved_importa
-0004e100: 6e74 5f66 6561 7475 7265 7329 0d0a 2020  nt_features)..  
-0004e110: 2020 2020 2020 2369 6d70 6f72 7461 6e74        #important
-0004e120: 5f66 6561 7475 7265 7320 3d20 636f 7079  _features = copy
-0004e130: 2e64 6565 7063 6f70 7928 7265 645f 7072  .deepcopy(red_pr
-0004e140: 6564 7329 0d0a 2020 2020 2323 2323 2323  eds)..    ######
-0004e150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e1a0: 2323 2323 2323 0d0a 2020 2020 6966 206d  ######..    if m
-0004e1b0: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
-0004e1c0: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
-0004e1d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0004e1e0: 2720 2020 2053 6574 7469 6e67 2062 6573  '    Setting bes
-0004e1f0: 7420 7061 7261 6d73 2066 6f72 2043 6174  t params for Cat
-0004e200: 426f 6f73 7420 6d6f 6465 6c20 6672 6f6d  Boost model from
-0004e210: 2049 6e69 7469 616c 2053 7461 7465 2073   Initial State s
-0004e220: 696e 6365 2079 6f75 2063 616e 6e6f 7420  ince you cannot 
-0004e230: 6368 616e 6765 2070 6172 616d 7320 746f  change params to
-0004e240: 2061 2066 6974 7465 6420 4361 7462 6f6f   a fitted Catboo
-0004e250: 7374 206d 6f64 656c 2027 290d 0a20 2020  st model ')..   
-0004e260: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
-0004e270: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
-0004e280: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-0004e290: 2020 2020 6d6f 6465 6c20 3d20 7867 626d      model = xgbm
-0004e2a0: 2e73 6574 5f70 6172 616d 7328 2a2a 6265  .set_params(**be
-0004e2b0: 7374 5f70 6172 616d 7329 0d0a 2020 2020  st_params)..    
-0004e2c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0004e2d0: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
-0004e2e0: 6c61 6265 6c20 213d 2027 4d75 6c74 695f  label != 'Multi_
-0004e2f0: 4c61 6265 6c27 3a0d 0a20 2020 2020 2020  Label':..       
-0004e300: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-0004e310: 2078 6762 6d2e 7365 745f 7061 7261 6d73   xgbm.set_params
-0004e320: 282a 2a62 6573 745f 7061 7261 6d73 290d  (**best_params).
-0004e330: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0004e340: 2020 2020 4e75 6d62 6572 206f 6620 4361      Number of Ca
-0004e350: 7465 676f 7269 6361 6c20 616e 6420 496e  tegorical and In
-0004e360: 7465 6765 7220 7661 7269 6162 6c65 7320  teger variables 
-0004e370: 7573 6564 2069 6e20 4361 7442 6f6f 7374  used in CatBoost
-0004e380: 2074 7261 696e 696e 6720 3d20 2564 2720   training = %d' 
-0004e390: 256c 656e 2869 6d70 5f63 6174 7329 290d  %len(imp_cats)).
-0004e3a0: 0a20 2020 2023 2323 2320 5065 7266 6f72  .    #### Perfor
-0004e3b0: 6d20 5363 616c 696e 6720 6f66 2054 7261  m Scaling of Tra
-0004e3c0: 696e 2064 6174 6120 6120 7365 636f 6e64  in data a second
-0004e3d0: 2074 696d 6520 7573 696e 6720 4655 4c4c   time using FULL
-0004e3e0: 2054 5241 494e 2064 6174 6120 7365 7420   TRAIN data set 
-0004e3f0: 7468 6973 2074 696d 6520 210d 0a20 2020  this time !..   
-0004e400: 2023 2323 2320 696d 706f 7274 616e 745f   #### important_
-0004e410: 6665 6174 7572 6573 206b 6565 7073 2074  features keeps t
-0004e420: 7261 636b 206f 6620 616c 6c20 7661 7269  rack of all vari
-0004e430: 6162 6c65 7320 7468 6174 2077 6520 6e65  ables that we ne
-0004e440: 6564 2074 6f20 656e 7375 7265 2074 6865  ed to ensure the
-0004e450: 7920 6172 6520 7363 616c 6564 210d 0a20  y are scaled!.. 
-0004e460: 2020 2069 6620 6e6f 7420 7065 7266 6f72     if not perfor
-0004e470: 6d5f 7363 616c 696e 675f 666c 6167 3a0d  m_scaling_flag:.
-0004e480: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0004e490: 4e6f 2025 7320 7363 616c 696e 6720 7065  No %s scaling pe
-0004e4a0: 7266 6f72 6d65 6420 7369 6e63 6520 7363  rformed since sc
-0004e4b0: 616c 696e 6720 666c 6167 2069 7320 7365  aling flag is se
-0004e4c0: 7420 746f 2066 616c 7365 2720 2573 6361  t to false' %sca
-0004e4d0: 6c69 6e67 290d 0a20 2020 2020 2020 2058  ling)..        X
-0004e4e0: 203d 2074 7261 696e 5b69 6d70 6f72 7461   = train[importa
-0004e4f0: 6e74 5f66 6561 7475 7265 735d 0d0a 2020  nt_features]..  
-0004e500: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-0004e510: 6e73 7461 6e63 6528 6f72 6967 5f74 6573  nstance(orig_tes
-0004e520: 742c 2073 7472 293a 0d0a 2020 2020 2020  t, str):..      
-0004e530: 2020 2020 2020 585f 7465 7374 203d 2074        X_test = t
-0004e540: 6573 745b 696d 706f 7274 616e 745f 6665  est[important_fe
-0004e550: 6174 7572 6573 5d0d 0a20 2020 2065 6c73  atures]..    els
-0004e560: 653a 0d0a 2020 2020 2020 2020 7072 696e  e:..        prin
-0004e570: 7428 2750 6572 666f 726d 696e 6720 2573  t('Performing %s
-0004e580: 2073 6361 6c69 6e67 206f 6620 7472 6169   scaling of trai
-0004e590: 6e20 616e 6420 7465 7374 2064 6174 612e  n and test data.
-0004e5a0: 2e2e 2720 2573 6361 6c69 6e67 290d 0a20  ..' %scaling).. 
-0004e5b0: 2020 2020 2020 2058 203d 2074 7261 696e         X = train
-0004e5c0: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
-0004e5d0: 7265 735d 0d0a 2020 2020 2020 2020 5353  res]..        SS
-0004e5e0: 2e66 6974 2858 290d 0a20 2020 2020 2020  .fit(X)..       
-0004e5f0: 2058 203d 2070 642e 4461 7461 4672 616d   X = pd.DataFram
-0004e600: 6528 5353 2e74 7261 6e73 666f 726d 2858  e(SS.transform(X
-0004e610: 292c 696e 6465 783d 6f72 6967 5f74 7261  ),index=orig_tra
-0004e620: 696e 2e69 6e64 6578 2c0d 0a20 2020 2020  in.index,..     
-0004e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e650: 2020 2063 6f6c 756d 6e73 3d69 6d70 6f72     columns=impor
-0004e660: 7461 6e74 5f66 6561 7475 7265 7329 0d0a  tant_features)..
-0004e670: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0004e680: 7369 6e73 7461 6e63 6528 6f72 6967 5f74  sinstance(orig_t
-0004e690: 6573 742c 2073 7472 293a 0d0a 2020 2020  est, str):..    
-0004e6a0: 2020 2020 2020 2020 585f 7465 7374 203d          X_test =
-0004e6b0: 2070 642e 4461 7461 4672 616d 6528 5353   pd.DataFrame(SS
-0004e6c0: 2e74 7261 6e73 666f 726d 2874 6573 745b  .transform(test[
-0004e6d0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004e6e0: 6573 5d29 2c69 6e64 6578 3d6f 7269 675f  es]),index=orig_
-0004e6f0: 7465 7374 2e69 6e64 6578 2c0d 0a20 2020  test.index,..   
-0004e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e720: 2020 2020 2063 6f6c 756d 6e73 3d69 6d70       columns=imp
-0004e730: 6f72 7461 6e74 5f66 6561 7475 7265 7329  ortant_features)
-0004e740: 0d0a 2020 2020 7072 696e 7428 2723 2323  ..    print('###
-0004e750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e790: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-0004e7a0: 7072 696e 7428 2723 2323 2323 2020 2046  print('#####   F
-0004e7b0: 2049 204e 2041 204c 2049 205a 2049 204e   I N A L I Z I N
-0004e7c0: 2047 2020 204d 204f 2044 2045 204c 2020   G   M O D E L  
-0004e7d0: 204f 204e 2020 2020 4620 5520 4c20 4c20   O N    F U L L 
-0004e7e0: 2020 5420 5220 4120 4920 4e20 2023 2323    T R A I N  ###
-0004e7f0: 2323 2729 0d0a 2020 2020 7072 696e 7428  ##')..    print(
-0004e800: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
-0004e810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e840: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-0004e850: 2020 2020 2323 2320 5468 6520 6e65 7874      ### The next
-0004e860: 2032 206c 696e 6573 2061 7265 2063 7275   2 lines are cru
-0004e870: 6369 616c 3a20 6966 2058 2061 6e64 2079  cial: if X and y
-0004e880: 2061 7265 2064 6174 6166 7261 6d65 732c   are dataframes,
-0004e890: 2074 6865 6e20 6e65 7874 2032 2073 686f   then next 2 sho
-0004e8a0: 756c 6420 6265 2064 6627 730d 0a20 2020  uld be df's..   
-0004e8b0: 2023 2323 2020 2054 6865 7920 7368 6f75   ###   They shou
-0004e8c0: 6c64 206e 6f74 2062 6520 6466 2e76 616c  ld not be df.val
-0004e8d0: 7565 7320 7369 6e63 6520 7468 6579 2077  ues since they w
-0004e8e0: 696c 6c20 6265 636f 6d65 206e 756d 7079  ill become numpy
-0004e8f0: 2061 7272 6179 7320 616e 6420 5847 4220   arrays and XGB 
-0004e900: 7769 6c6c 2065 7272 6f72 2e0d 0a20 2020  will error...   
-0004e910: 2074 7261 696e 6d20 3d20 7472 6169 6e5b   trainm = train[
-0004e920: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004e930: 6573 2b74 6172 6765 745d 0d0a 2020 2020  es+target]..    
-0004e940: 7265 645f 7072 6564 7320 3d20 636f 7079  red_preds = copy
-0004e950: 2e64 6565 7063 6f70 7928 696d 706f 7274  .deepcopy(import
-0004e960: 616e 745f 6665 6174 7572 6573 290d 0a20  ant_features).. 
-0004e970: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
-0004e980: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
-0004e990: 656c 273a 0d0a 2020 2020 2020 2020 7920  el':..        y 
-0004e9a0: 3d20 7472 6169 6e6d 5b65 6163 685f 7461  = trainm[each_ta
-0004e9b0: 7267 6574 5d0d 0a20 2020 2065 6c73 653a  rget]..    else:
-0004e9c0: 0d0a 2020 2020 2020 2020 7920 3d20 7472  ..        y = tr
-0004e9d0: 6169 6e6d 5b74 6172 6765 745d 0d0a 2020  ainm[target]..  
-0004e9e0: 2020 6576 616c 5f73 6574 203d 205b 2829    eval_set = [()
-0004e9f0: 5d0d 0a20 2020 2023 2323 2323 2023 2323  ]..    ##### ###
-0004ea00: 2323 2323 2323 2323 2320 2020 2020 2054  #########      T
-0004ea10: 5241 494e 494e 4720 4d4f 4445 4c20 5345  RAINING MODEL SE
-0004ea20: 434f 4e44 2054 494d 4520 5749 5448 2046  COND TIME WITH F
-0004ea30: 554c 4c5f 5452 4149 4e20 414e 4420 5052  ULL_TRAIN AND PR
-0004ea40: 4544 4943 5449 4e47 204f 4e20 5445 5354  EDICTING ON TEST
-0004ea50: 2023 2323 2323 2323 2323 2323 230d 0a20   ############.. 
-0004ea60: 2020 206d 6f64 656c 5f73 7461 7274 5f74     model_start_t
-0004ea70: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-0004ea80: 290d 0a20 2020 2069 6620 6d6f 6465 6c5f  )..    if model_
-0004ea90: 6c61 6265 6c20 3d3d 2027 5369 6e67 6c65  label == 'Single
-0004eaa0: 5f4c 6162 656c 273a 0d0a 2020 2020 2020  _Label':..      
-0004eab0: 2020 6966 2049 6d62 616c 616e 6365 645f    if Imbalanced_
-0004eac0: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-0004ead0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0004eae0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0004eaf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004eb00: 2323 2020 496d 6261 6c61 6e63 6564 204d  ##  Imbalanced M
-0004eb10: 6f64 656c 2054 7261 696e 696e 6720 2023  odel Training  #
-0004eb20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004eb30: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
-0004eb40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0004eb50: 7072 696e 7428 2749 6d62 616c 616e 6365  print('Imbalance
-0004eb60: 6420 5472 6169 6e69 6e67 2075 7369 6e67  d Training using
-0004eb70: 2053 4d4f 5445 2052 6172 6520 436c 6173   SMOTE Rare Clas
-0004eb80: 7320 4f76 6572 7361 6d70 6c69 6e67 206d  s Oversampling m
-0004eb90: 6574 686f 642e 2e2e 2729 0d0a 2020 2020  ethod...')..    
-0004eba0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0004ebb0: 5369 6e63 6520 6974 2069 7320 6120 7369  Since it is a si
-0004ebc0: 6e67 6c65 206c 6162 656c 2070 726f 626c  ngle label probl
-0004ebd0: 656d 2c20 7765 2075 7365 2065 6163 685f  em, we use each_
-0004ebe0: 7461 7267 6574 2069 6e73 7465 6164 206f  target instead o
-0004ebf0: 6620 7461 7267 6574 0d0a 2020 2020 2020  f target..      
-0004ec00: 2020 2020 2020 2020 2020 6d6f 6465 6c20            model 
-0004ec10: 3d20 7472 6169 6e69 6e67 5f77 6974 685f  = training_with_
-0004ec20: 534d 4f54 4528 582c 792c 2065 6163 685f  SMOTE(X,y, each_
-0004ec30: 7461 7267 6574 2c20 6576 616c 5f73 6574  target, eval_set
-0004ec40: 2c20 6d6f 6465 6c2c 0d0a 2020 2020 2020  , model,..      
-0004ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ec60: 2020 2020 2020 2020 2020 2020 426f 6f73              Boos
-0004ec70: 7469 6e67 5f46 6c61 672c 2065 7661 6c5f  ting_Flag, eval_
-0004ec80: 6d65 7472 6963 2c6d 6f64 656c 7479 7065  metric,modeltype
-0004ec90: 2c20 6d6f 6465 6c5f 6e61 6d65 2c0d 0a20  , model_name,.. 
-0004eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ecc0: 2074 7261 696e 696e 673d 4661 6c73 652c   training=False,
-0004ecd0: 206d 696e 6f72 6974 795f 636c 6173 733d   minority_class=
-0004ece0: 7261 7265 5f63 6c61 7373 2c0d 0a20 2020  rare_class,..   
-0004ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ed00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0004ed10: 6d70 5f63 6174 733d 696d 705f 6361 7473  mp_cats=imp_cats
-0004ed20: 2c20 6361 6c69 6272 6174 6f72 5f66 6c61  , calibrator_fla
-0004ed30: 673d 6361 6c69 6272 6174 6f72 5f66 6c61  g=calibrator_fla
-0004ed40: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
-0004ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ed60: 2020 2020 2020 4750 555f 6578 6973 7473        GPU_exists
-0004ed70: 3d47 5055 5f65 7869 7374 732c 2070 6172  =GPU_exists, par
-0004ed80: 616d 733d 6370 755f 7061 7261 6d73 2c0d  ams=cpu_params,.
-0004ed90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004edb0: 2020 206d 6f64 656c 5f6c 6162 656c 3d6d     model_label=m
-0004edc0: 6f64 656c 5f6c 6162 656c 2c20 7665 7262  odel_label, verb
-0004edd0: 6f73 653d 7665 7262 6f73 6529 0d0a 2020  ose=verbose)..  
-0004ede0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0004edf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004ee00: 2020 2070 7269 6e74 2827 4572 726f 7220     print('Error 
-0004ee10: 696e 2074 7261 696e 696e 6720 496d 6261  in training Imba
-0004ee20: 6c61 6e63 6564 206d 6f64 656c 2073 6563  lanced model sec
-0004ee30: 6f6e 6420 7469 6d65 2e20 5472 7969 6e67  ond time. Trying
-0004ee40: 2072 6567 756c 6172 206d 6f64 656c 2e2e   regular model..
-0004ee50: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0004ee60: 2020 2020 496d 6261 6c61 6e63 6564 5f46      Imbalanced_F
-0004ee70: 6c61 6720 3d20 2046 616c 7365 0d0a 2020  lag =  False..  
-0004ee80: 2020 2323 2323 2323 2323 2320 2020 494d    #########   IM
-0004ee90: 504f 5254 414e 5420 2020 2049 4d50 4f52  PORTANT    IMPOR
-0004eea0: 5441 4e54 2023 2323 2323 2323 2323 2323  TANT ###########
-0004eeb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004eec0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0004eed0: 2323 2323 2054 6869 7320 6973 206e 6f74  #### This is not
-0004eee0: 2061 206d 6973 7461 6b65 2120 496e 2063   a mistake! In c
-0004eef0: 6173 652c 2049 6d62 616c 616e 6365 6420  ase, Imbalanced 
-0004ef00: 5472 6169 6e69 6e67 2046 6169 6c73 0d0a  Training Fails..
-0004ef10: 2020 2020 2323 2323 2020 206f 7220 6966      ####   or if
-0004ef20: 2074 6865 7265 2069 7320 6e6f 2066 6c61   there is no fla
-0004ef30: 672c 2077 6520 6d75 7374 2073 7469 6c6c  g, we must still
-0004ef40: 2074 7261 696e 2074 6865 206d 6f64 656c   train the model
-0004ef50: 2121 0d0a 2020 2020 2323 2323 2020 2044  !!..    ####   D
-0004ef60: 4f20 4e4f 5420 544f 5543 4820 5448 4953  O NOT TOUCH THIS
-0004ef70: 204e 4558 5420 4c49 4e45 2054 4849 4e4b   NEXT LINE THINK
-0004ef80: 494e 4720 4954 2049 5320 4120 4d49 5354  ING IT IS A MIST
-0004ef90: 414b 4521 0d0a 2020 2020 6966 206e 6f74  AKE!..    if not
-0004efa0: 2049 6d62 616c 616e 6365 645f 466c 6167   Imbalanced_Flag
-0004efb0: 3a0d 0a20 2020 2020 2020 2023 2320 5468  :..        ## Th
-0004efc0: 6973 2069 7320 7768 6572 6520 7765 2074  is is where we t
-0004efd0: 6573 7420 6966 2074 6865 2070 7265 7669  est if the previ
-0004efe0: 6f75 7320 7472 6169 6e69 6e67 2077 6974  ous training wit
-0004eff0: 6820 534d 4f54 4520 7765 6e74 2073 6d6f  h SMOTE went smo
-0004f000: 6f74 686c 792e 2049 6620 6e6f 742c 2077  othly. If not, w
-0004f010: 6520 2074 7279 2077 6974 6820 6120 6469  e  try with a di
-0004f020: 6666 6572 656e 7420 6d65 7468 6f64 2068  fferent method h
-0004f030: 6572 652e 0d0a 2020 2020 2020 2020 2323  ere...        ##
-0004f040: 2323 2049 6620 646f 776e 7361 6d70 6c69  ## If downsampli
-0004f050: 6e67 206d 6f64 656c 2066 6169 6c65 642c  ng model failed,
-0004f060: 2069 7420 7769 6c6c 206a 7573 7420 6265   it will just be
-0004f070: 2061 6e20 656d 7074 7920 7374 7269 6e67   an empty string
-0004f080: 2c20 736f 2079 6f75 2063 616e 2074 7279  , so you can try
-0004f090: 2072 6567 756c 6172 206d 6f64 656c 2023   regular model #
-0004f0a0: 2323 0d0a 2020 2020 2020 2020 6966 206d  ##..        if m
-0004f0b0: 6f64 656c 5f6c 6162 656c 203d 3d20 2753  odel_label == 'S
-0004f0c0: 696e 676c 655f 4c61 6265 6c27 3a0d 0a20  ingle_Label':.. 
-0004f0d0: 2020 2020 2020 2020 2020 2069 6620 6361             if ca
-0004f0e0: 6c69 6272 6174 6f72 5f66 6c61 673a 0d0a  librator_flag:..
-0004f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f100: 6d6f 6465 6c2e 6669 7428 582c 2079 290d  model.fit(X, y).
-0004f110: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0004f120: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0004f130: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-0004f140: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-0004f150: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0004f160: 2323 2320 5365 7420 7468 6520 5665 7262  ### Set the Verb
-0004f170: 6f73 6520 746f 2030 2073 696e 6365 2077  ose to 0 since w
-0004f180: 6520 646f 6e27 7420 7761 6e74 2074 6f6f  e don't want too
-0004f190: 206d 7563 6820 6f75 7470 7574 2023 230d   much output ##.
-0004f1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004f1b0: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
-0004f1c0: 6d65 203d 3d20 2758 4742 6f6f 7374 273a  me == 'XGBoost':
-0004f1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004f1e0: 2020 2020 2020 2020 2020 2323 2323 2053            #### S
-0004f1f0: 6574 2074 6865 2056 6572 626f 7365 2074  et the Verbose t
-0004f200: 6f20 3020 7369 6e63 6520 7765 2064 6f6e  o 0 since we don
-0004f210: 2774 2077 616e 7420 746f 6f20 6d75 6368  't want too much
-0004f220: 206f 7574 7075 7420 2323 0d0a 2020 2020   output ##..    
-0004f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f240: 2020 2020 6d6f 6465 6c2e 6669 7428 582c      model.fit(X,
-0004f250: 2079 290d 0a20 2020 2020 2020 2020 2020   y)..           
-0004f260: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0004f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f280: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
-0004f290: 7428 582c 2079 2c20 6361 745f 6665 6174  t(X, y, cat_feat
-0004f2a0: 7572 6573 3d69 6d70 5f63 6174 732c 2070  ures=imp_cats, p
-0004f2b0: 6c6f 743d 4661 6c73 6529 0d0a 2020 2020  lot=False)..    
-0004f2c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0004f2d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004f2e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0004f2f0: 2e66 6974 2858 2c20 7929 0d0a 2020 2020  .fit(X, y)..    
-0004f300: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-0004f310: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
-0004f320: 756c 7469 2d4c 6162 656c 2054 7261 696e  ulti-Label Train
-0004f330: 696e 6720 2323 2323 2323 2323 230d 0a20  ing #########.. 
-0004f340: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-0004f350: 2858 2c20 7929 0d0a 2020 2020 7072 696e  (X, y)..    prin
-0004f360: 7428 2720 2020 2020 4163 7475 616c 2054  t('     Actual T
-0004f370: 7261 696e 696e 6720 7469 6d65 2074 616b  raining time tak
-0004f380: 656e 2069 6e20 7365 636f 6e64 7320 3d20  en in seconds = 
-0004f390: 2530 2e30 6627 2025 2874 696d 652e 7469  %0.0f' %(time.ti
-0004f3a0: 6d65 2829 2d6d 6f64 656c 5f73 7461 7274  me()-model_start
-0004f3b0: 5f74 696d 6529 290d 0a20 2020 2070 7269  _time))..    pri
-0004f3c0: 6e74 2827 5472 6169 6e69 6e67 206f 6620  nt('Training of 
-0004f3d0: 6d6f 6465 6c73 2063 6f6d 706c 6574 6564  models completed
-0004f3e0: 2e20 4e6f 7720 7374 6172 7469 6e67 2070  . Now starting p
-0004f3f0: 7265 6469 6374 696f 6e73 206f 6e20 7465  redictions on te
-0004f400: 7374 2064 6174 612e 2e2e 2729 0d0a 2020  st data...')..  
-0004f410: 2020 2323 2323 206e 6577 5f63 6f6c 7320    #### new_cols 
-0004f420: 6973 2074 6f20 6b65 6570 2074 7261 636b  is to keep track
-0004f430: 206f 6620 6e65 7720 7072 6564 6963 7469   of new predicti
-0004f440: 6f6e 2063 6f6c 756d 6e73 2077 6520 6172  on columns we ar
-0004f450: 6520 6372 6561 7469 6e67 2023 2323 2323  e creating #####
-0004f460: 0d0a 2020 2020 6e65 775f 636f 6c73 203d  ..    new_cols =
-0004f470: 205b 5d0d 0a20 2020 2069 6620 6e6f 7420   []..    if not 
-0004f480: 6973 696e 7374 616e 6365 286f 7269 675f  isinstance(orig_
-0004f490: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
-0004f4a0: 2020 2020 2023 2323 2049 6620 7468 6572       ### If ther
-0004f4b0: 6520 6973 2061 2074 6573 7420 6461 7461  e is a test data
-0004f4c0: 2066 7261 6d65 2c20 7468 656e 206c 6574   frame, then let
-0004f4d0: 2075 7320 7072 6564 6963 7420 6f6e 2069   us predict on i
-0004f4e0: 7420 2323 2323 2323 230d 0a20 2020 2020  t #######..     
-0004f4f0: 2020 2023 2323 2054 6865 206e 6578 7420     ### The next 
-0004f500: 3320 6c69 6e65 7320 6172 6520 6372 7563  3 lines are cruc
-0004f510: 6961 6c3a 2069 6620 5820 616e 6420 7920  ial: if X and y 
-0004f520: 6172 6520 6461 7461 6672 616d 6573 2c20  are dataframes, 
-0004f530: 7468 656e 206e 6578 7420 3220 7368 6f75  then next 2 shou
-0004f540: 6c64 2062 6520 6466 2773 0d0a 2020 2020  ld be df's..    
-0004f550: 2020 2020 2323 2320 2020 5468 6579 2073      ###   They s
-0004f560: 686f 756c 6420 6e6f 7420 6265 2064 662e  hould not be df.
-0004f570: 7661 6c75 6573 2073 696e 6365 2074 6865  values since the
-0004f580: 7920 7769 6c6c 2062 6563 6f6d 6520 6e75  y will become nu
-0004f590: 6d70 7920 6172 7261 7973 2061 6e64 2058  mpy arrays and X
-0004f5a0: 4742 2077 696c 6c20 6572 726f 722e 0d0a  GB will error...
-0004f5b0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-0004f5c0: 2020 2020 2020 2020 2020 2323 2323 2057            #### W
-0004f5d0: 6520 6e65 6564 2074 6865 2069 6420 636f  e need the id co
-0004f5e0: 6c75 6d6e 7320 746f 2063 6172 7279 206f  lumns to carry o
-0004f5f0: 7665 7220 696e 746f 2074 6865 2070 7265  ver into the pre
-0004f600: 6469 6374 696f 6e73 2023 2323 230d 0a20  dictions ####.. 
-0004f610: 2020 2020 2020 2020 2020 2074 6573 746d             testm
-0004f620: 203d 206f 7269 675f 7465 7374 5b69 645f   = orig_test[id_
-0004f630: 636f 6c73 5d2e 6a6f 696e 2870 642e 4461  cols].join(pd.Da
-0004f640: 7461 4672 616d 6528 585f 7465 7374 2c20  taFrame(X_test, 
-0004f650: 696e 6465 783d 6f72 6967 5f74 6573 742e  index=orig_test.
-0004f660: 696e 6465 782c 2063 6f6c 756d 6e73 3d72  index, columns=r
-0004f670: 6564 5f70 7265 6473 2929 0d0a 2020 2020  ed_preds))..    
-0004f680: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-0004f690: 2020 2020 2020 2020 2023 2323 2069 6620           ### if 
-0004f6a0: 666f 7220 736f 6d65 2072 6561 736f 6e20  for some reason 
-0004f6b0: 6964 2063 6f6c 756d 6e73 2061 7265 206e  id columns are n
-0004f6c0: 6f74 2061 7661 696c 6162 6c65 2c20 7468  ot available, th
-0004f6d0: 656e 2064 6f20 7769 7468 6f75 7420 6974  en do without it
-0004f6e0: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
-0004f6f0: 7374 6d20 3d20 7064 2e44 6174 6146 7261  stm = pd.DataFra
-0004f700: 6d65 2858 5f74 6573 742c 2069 6e64 6578  me(X_test, index
-0004f710: 3d6f 7269 675f 7465 7374 2e69 6e64 6578  =orig_test.index
-0004f720: 2c20 636f 6c75 6d6e 733d 7265 645f 7072  , columns=red_pr
-0004f730: 6564 7329 0d0a 2020 2020 656c 7365 3a0d  eds)..    else:.
-0004f740: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0004f750: 5369 6e63 6520 7468 6572 6520 6973 206e  Since there is n
-0004f760: 6f20 5465 7374 2066 696c 652c 2077 6520  o Test file, we 
-0004f770: 7769 6c6c 2064 6f20 6120 6669 6e61 6c20  will do a final 
-0004f780: 7072 6564 6963 7469 6f6e 206f 6e20 5472  prediction on Tr
-0004f790: 6169 6e20 6974 7365 6c66 2061 7320 7265  ain itself as re
-0004f7a0: 7475 726e 2069 7420 6173 2074 6573 746d  turn it as testm
-0004f7b0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
-0004f7c0: 2020 2020 2020 6f72 6967 5f69 6e64 6578        orig_index
-0004f7d0: 203d 206f 7269 675f 7472 6169 6e2e 696e   = orig_train.in
-0004f7e0: 6465 780d 0a20 2020 2020 2020 2074 7261  dex..        tra
-0004f7f0: 696e 6d20 3d20 7472 6169 6e2e 7265 696e  inm = train.rein
-0004f800: 6465 7828 696e 6465 7820 3d20 6f72 6967  dex(index = orig
-0004f810: 5f69 6e64 6578 290d 0a20 2020 2020 2020  _index)..       
-0004f820: 2069 6620 6e6f 7420 7065 7266 6f72 6d5f   if not perform_
-0004f830: 7363 616c 696e 675f 666c 6167 3a0d 0a20  scaling_flag:.. 
-0004f840: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
-0004f850: 7420 3d20 7472 6169 6e6d 5b69 6d70 6f72  t = trainm[impor
-0004f860: 7461 6e74 5f66 6561 7475 7265 735d 0d0a  tant_features]..
-0004f870: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0004f880: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
-0004f890: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
-0004f8a0: 2853 532e 7472 616e 7366 6f72 6d28 7472  (SS.transform(tr
-0004f8b0: 6169 6e6d 5b69 6d70 6f72 7461 6e74 5f66  ainm[important_f
-0004f8c0: 6561 7475 7265 735d 292c 0d0a 2020 2020  eatures]),..    
-0004f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f8e0: 696e 6465 783d 6f72 6967 5f69 6e64 6578  index=orig_index
-0004f8f0: 2c20 636f 6c75 6d6e 733d 696d 706f 7274  , columns=import
-0004f900: 616e 745f 6665 6174 7572 6573 290d 0a20  ant_features).. 
-0004f910: 2020 2020 2020 2074 6573 746d 203d 206f         testm = o
-0004f920: 7269 675f 7472 6169 6e5b 6964 5f63 6f6c  rig_train[id_col
-0004f930: 735d 2e6a 6f69 6e28 585f 7465 7374 290d  s].join(X_test).
-0004f940: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-0004f950: 2320 2054 6869 7320 6973 2077 6865 7265  #  This is where
-0004f960: 2077 6520 7374 6172 7420 7072 6564 6963   we start predic
-0004f970: 7469 6f6e 7320 6f6e 2074 6573 7420 6461  tions on test da
-0004f980: 7461 2069 6620 6176 6169 6c61 626c 6520  ta if available 
-0004f990: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0004f9a0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0004f9b0: 2079 5f70 7265 6420 3d20 6d6f 6465 6c2e   y_pred = model.
-0004f9c0: 7072 6564 6963 7428 585f 7465 7374 290d  predict(X_test).
-0004f9d0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-0004f9e0: 2020 2020 2020 6966 2028 585f 7472 6169        if (X_trai
-0004f9f0: 6e2e 6474 7970 6573 203d 3d20 585f 7465  n.dtypes == X_te
-0004fa00: 7374 2e64 7479 7065 7329 2e76 616c 7565  st.dtypes).value
-0004fa10: 732e 616c 6c28 293a 0d0a 2020 2020 2020  s.all():..      
-0004fa20: 2020 2020 2020 7072 696e 7428 274d 6f64        print('Mod
-0004fa30: 656c 2065 7272 6f72 696e 6720 6f6e 2070  el erroring on p
-0004fa40: 7265 6469 6374 696f 6e73 2e20 4368 6563  redictions. Chec
-0004fa50: 6b20 6966 2074 6573 7420 6461 7461 2068  k if test data h
-0004fa60: 6173 2061 6e79 2064 6966 6665 7265 6e63  as any differenc
-0004fa70: 6573 2066 726f 6d20 7472 6169 6e20 6461  es from train da
-0004fa80: 7461 2729 0d0a 2020 2020 2020 2020 656c  ta')..        el
-0004fa90: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0004faa0: 2065 7272 6f72 696e 675f 636f 6c75 6d6e   erroring_column
-0004fab0: 203d 2058 5f74 7261 696e 2e63 6f6c 756d   = X_train.colum
-0004fac0: 6e73 5b7e 2858 5f74 7261 696e 2e64 7479  ns[~(X_train.dty
-0004fad0: 7065 7320 3d3d 2058 5f74 6573 742e 6474  pes == X_test.dt
-0004fae0: 7970 6573 292e 7661 6c75 6573 5d5b 305d  ypes).values][0]
-0004faf0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0004fb00: 696e 7428 274d 6f64 656c 2065 7272 6f72  int('Model error
-0004fb10: 696e 6720 7369 6e63 6520 2573 2068 6173  ing since %s has
-0004fb20: 2061 2064 6966 6665 7265 6e74 2064 7479   a different dty
-0004fb30: 7065 2069 6e20 7465 7374 2063 6f6d 7061  pe in test compa
-0004fb40: 7265 6420 746f 2074 7261 696e 2e20 4669  red to train. Fi
-0004fb50: 7820 6974 2061 6e64 2072 652d 7275 6e2e  x it and re-run.
-0004fb60: 2720 2565 7272 6f72 696e 675f 636f 6c75  ' %erroring_colu
-0004fb70: 6d6e 290d 0a20 2020 2020 2020 2020 2020  mn)..           
-0004fb80: 2072 6574 7572 6e20 6d6f 6465 6c2c 2069   return model, i
-0004fb90: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-0004fba0: 732c 2074 7261 696e 6d2c 2074 6573 746d  s, trainm, testm
-0004fbb0: 0d0a 2020 2020 2323 2323 2320 5468 6973  ..    ##### This
-0004fbc0: 206e 6578 7420 7374 6570 2069 7320 7665   next step is ve
-0004fbd0: 7279 2069 6d70 6f72 7461 6e74 2073 696e  ry important sin
-0004fbe0: 6365 2073 6f6d 6520 6d6f 6465 6c73 2067  ce some models g
-0004fbf0: 6976 6520 7365 7269 6573 2c20 6f74 6865  ive series, othe
-0004fc00: 7273 2067 6976 6520 6172 7261 7973 2e20  rs give arrays. 
-0004fc10: 5665 7279 2070 6169 6e66 756c 210d 0a20  Very painful!.. 
-0004fc20: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0004fc30: 2879 5f70 7265 642c 7064 2e53 6572 6965  (y_pred,pd.Serie
-0004fc40: 7329 206f 7220 6973 696e 7374 616e 6365  s) or isinstance
-0004fc50: 2879 5f70 7265 642c 7064 2e44 6174 6146  (y_pred,pd.DataF
-0004fc60: 7261 6d65 2920 3a0d 0a20 2020 2020 2020  rame) :..       
-0004fc70: 2079 5f70 7265 6420 3d20 795f 7072 6564   y_pred = y_pred
-0004fc80: 2e76 616c 7565 730d 0a20 2020 2023 2323  .values..    ###
-0004fc90: 2323 2323 2054 6869 7320 6973 2077 6865  #### This is whe
-0004fca0: 7265 2079 6f75 206d 6f64 6966 7920 7072  re you modify pr
-0004fcb0: 6564 6963 7469 6f6e 7320 6f6e 2074 6573  edictions on tes
-0004fcc0: 7420 6461 7461 2074 6f20 6265 2073 616d  t data to be sam
-0004fcd0: 6520 6173 206f 7269 6769 6e61 6c20 6461  e as original da
-0004fce0: 7461 2074 7970 6520 2323 2323 230d 0a20  ta type #####.. 
-0004fcf0: 2020 2069 6620 6d6f 6469 6679 5f74 6172     if modify_tar
-0004fd00: 6765 7473 5f66 6c61 673a 0d0a 2020 2020  gets_flag:..    
-0004fd10: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
-0004fd20: 6966 795f 6172 7261 795f 746f 5f69 6e74  ify_array_to_int
-0004fd30: 6567 6572 2879 5f70 7265 642c 2074 6172  eger(y_pred, tar
-0004fd40: 6765 7473 5f6e 6567 6174 6976 655f 666c  gets_negative_fl
-0004fd50: 6167 290d 0a20 2020 2069 6620 6d6f 6465  ag)..    if mode
-0004fd60: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-0004fd70: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0004fd80: 2323 2323 2323 2323 2020 2054 6869 7320  ########   This 
-0004fd90: 6973 2066 6f72 2052 6567 7265 7373 696f  is for Regressio
-0004fda0: 6e20 5072 6f62 6c65 6d73 204f 6e6c 7920  n Problems Only 
-0004fdb0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0004fdc0: 2020 2020 2023 2323 2323 2320 2049 6620       ######  If 
-0004fdd0: 5374 6163 6b69 6e67 5f20 466c 6167 2069  Stacking_ Flag i
-0004fde0: 7320 4661 6c73 652c 2074 6865 6e20 7765  s False, then we
-0004fdf0: 2064 6f20 456e 7365 6d62 6c69 6e67 2023   do Ensembling #
-0004fe00: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-0004fe10: 6966 206e 6f74 2053 7461 636b 696e 675f  if not Stacking_
-0004fe20: 466c 6167 2061 6e64 206e 6f74 206d 6f64  Flag and not mod
-0004fe30: 656c 5f6c 6162 656c 203d 3d20 274d 756c  el_label == 'Mul
-0004fe40: 7469 5f4c 6162 656c 273a 0d0a 2020 2020  ti_Label':..    
-0004fe50: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-0004fe60: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0004fe70: 775f 636f 6c73 203d 205b 5d0d 0a20 2020  w_cols = []..   
-0004fe80: 2020 2020 2020 2020 2020 2020 2073 7562               sub
-0004fe90: 6d20 3d20 7064 2e44 6174 6146 7261 6d65  m = pd.DataFrame
-0004fea0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0004feb0: 2020 2020 2323 2323 2054 6869 7320 6973      #### This is
-0004fec0: 2066 6f72 2045 6e73 656d 626c 696e 6720   for Ensembling 
-0004fed0: 204f 6e6c 7920 2323 2323 230d 0a20 2020   Only #####..   
-0004fee0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0004fef0: 2320 496e 2054 6573 7420 6461 7461 2076  # In Test data v
-0004ff00: 6572 626f 7365 2069 7320 7365 7420 746f  erbose is set to
-0004ff10: 207a 6572 6f20 7369 6e63 6520 6e6f 2072   zero since no r
-0004ff20: 6573 756c 7473 2063 616e 2062 6520 6f62  esults can be ob
-0004ff30: 7461 696e 6564 210d 0a20 2020 2020 2020  tained!..       
-0004ff40: 2020 2020 2020 2020 206d 6f64 656c 735f           models_
-0004ff50: 6c69 7374 2c20 656e 7365 6d62 6c65 7320  list, ensembles 
-0004ff60: 3d20 5175 6963 6b4d 4c5f 456e 7365 6d62  = QuickML_Ensemb
-0004ff70: 6c69 6e67 2858 2c20 792c 2058 5f74 6573  ling(X, y, X_tes
-0004ff80: 742c 2027 272c 0d0a 2020 2020 2020 2020  t, '',..        
-0004ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ffb0: 2020 6d6f 6465 6c74 7970 653d 6d6f 6465    modeltype=mode
-0004ffc0: 6c74 7970 652c 2042 6f6f 7374 696e 675f  ltype, Boosting_
-0004ffd0: 466c 6167 3d42 6f6f 7374 696e 675f 466c  Flag=Boosting_Fl
-0004ffe0: 6167 2c0d 0a20 2020 2020 2020 2020 2020  ag,..           
-0004fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050010: 7363 6f72 696e 673d 2727 2c20 7665 7262  scoring='', verb
-00050020: 6f73 653d 3029 0d0a 2020 2020 2020 2020  ose=0)..        
-00050030: 2020 2020 2020 2020 6d6f 6465 6c73 5f6c          models_l
-00050040: 6973 742e 6170 7065 6e64 286d 6f64 656c  ist.append(model
-00050050: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-00050060: 2020 2020 2020 2020 666f 7220 6d6f 6465          for mode
-00050070: 6c73 2c20 6561 6368 2069 6e20 7a69 7028  ls, each in zip(
-00050080: 6d6f 6465 6c73 5f6c 6973 742c 2072 616e  models_list, ran
-00050090: 6765 286c 656e 286d 6f64 656c 735f 6c69  ge(len(models_li
-000500a0: 7374 2929 293a 0d0a 2020 2020 2020 2020  st))):..        
-000500b0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-000500c0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
-000500d0: 742b 275f 272b 6d6f 6465 6c73 2b27 5f70  t+'_'+models+'_p
-000500e0: 7265 6469 6374 696f 6e73 270d 0a20 2020  redictions'..   
-000500f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050100: 2069 6620 6561 6368 2b31 203d 3d20 6c65   if each+1 == le
-00050110: 6e28 6d6f 6465 6c73 5f6c 6973 7429 3a0d  n(models_list):.
-00050120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00050130: 2020 2020 2020 2020 2073 7562 6d5b 6e65           subm[ne
-00050140: 775f 636f 6c5d 203d 2079 5f70 7265 640d  w_col] = y_pred.
-00050150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00050160: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
-00050170: 6577 5f63 6f6c 5d20 3d20 795f 7072 6564  ew_col] = y_pred
-00050180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050190: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000501a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000501b0: 2020 2020 2073 7562 6d5b 6e65 775f 636f       subm[new_co
-000501c0: 6c5d 203d 2065 6e73 656d 626c 6573 5b3a  l] = ensembles[:
-000501d0: 2c65 6163 685d 0d0a 2020 2020 2020 2020  ,each]..        
-000501e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000501f0: 7465 7374 6d5b 6e65 775f 636f 6c5d 203d  testm[new_col] =
-00050200: 2065 6e73 656d 626c 6573 5b3a 2c65 6163   ensembles[:,eac
-00050210: 685d 0d0a 2020 2020 2020 2020 2020 2020  h]..            
-00050220: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
-00050230: 2e61 7070 656e 6428 6e65 775f 636f 6c29  .append(new_col)
-00050240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050250: 2020 2323 2320 4166 7465 7220 7468 6973    ### After this
-00050260: 2c20 795f 7072 6564 2069 7320 6120 5365  , y_pred is a Se
-00050270: 7269 6573 2066 726f 6d20 6e6f 7720 6f6e  ries from now on
-00050280: 2e20 596f 7520 6e65 6564 2079 5f70 7265  . You need y_pre
-00050290: 642e 7661 6c75 6573 2020 2323 2323 0d0a  d.values  ####..
-000502a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000502b0: 6966 206c 656e 286e 6577 5f63 6f6c 7329  if len(new_cols)
-000502c0: 203d 3d20 353a 0d0a 2020 2020 2020 2020   == 5:..        
-000502d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000502e0: 7428 2720 2020 2043 616c 6375 6c61 7469  t('    Calculati
-000502f0: 6e67 2077 6569 6768 7465 6420 6176 6572  ng weighted aver
-00050300: 6167 6520 656e 7365 6d62 6c65 206f 6620  age ensemble of 
-00050310: 2564 2072 6567 7265 7373 6f72 7327 2025  %d regressors' %
-00050320: 6c65 6e28 6e65 775f 636f 6c73 2929 0d0a  len(new_cols))..
+0004dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dca0: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
+0004dcb0: 6164 6463 6f6c 7329 290d 0a20 2020 2020  addcols))..     
+0004dcc0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+0004dcd0: 204c 6561 7669 6e67 206d 756c 7469 706c   Leaving multipl
+0004dce0: 6520 636f 6c75 6d6e 7320 666f 7220 5374  e columns for St
+0004dcf0: 6163 6b69 6e67 2069 7320 6265 7374 2120  acking is best! 
+0004dd00: 446f 206e 6f74 2064 6f20 7468 6520 6176  Do not do the av
+0004dd10: 6572 6167 6520 6f66 2070 7265 6469 6374  erage of predict
+0004dd20: 696f 6e73 210d 0a20 2020 2020 2020 2020  ions!..         
+0004dd30: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0004dd40: 2020 4164 6469 6e67 2025 6420 5374 6163    Adding %d Stac
+0004dd50: 6b69 6e67 2066 6561 7475 7265 2873 2920  king feature(s) 
+0004dd60: 746f 2074 7261 696e 696e 6720 6461 7461  to training data
+0004dd70: 2720 256c 656e 2861 6464 636f 6c73 2929  ' %len(addcols))
+0004dd80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004dd90: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0004dda0: 6e63 6528 6f72 6967 5f74 6573 742c 2073  nce(orig_test, s
+0004ddb0: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+0004ddc0: 2020 2020 2020 2020 2020 2323 2320 496e            ### In
+0004ddd0: 206f 7264 6572 2074 6f20 6176 6f69 6420   order to avoid 
+0004dde0: 6f76 6572 6669 7474 696e 672c 2077 6520  overfitting, we 
+0004ddf0: 6172 6520 676f 696e 6720 746f 206c 6561  are going to lea
+0004de00: 726e 2066 726f 6d20 6120 736d 616c 6c20  rn from a small 
+0004de10: 7361 6d70 6c65 206f 6620 6461 7461 0d0a  sample of data..
+0004de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de30: 2020 2020 2323 2320 5468 6174 2069 7320      ### That is 
+0004de40: 7768 7920 7765 2061 7265 2075 7369 6e67  why we are using
+0004de50: 2058 5f74 7261 696e 2074 6f20 7472 6169   X_train to trai
+0004de60: 6e20 6f6e 2061 6e64 2075 7369 6e67 2069  n on and using i
+0004de70: 7420 746f 2070 7265 6469 6374 206f 6e20  t to predict on 
+0004de80: 585f 7465 7374 0d0a 2020 2020 2020 2020  X_test..        
+0004de90: 2020 2020 2020 2020 2020 2020 5f2c 2073              _, s
+0004dea0: 7461 636b 7332 203d 2051 7569 636b 4d4c  tacks2 = QuickML
+0004deb0: 5f53 7461 636b 696e 6728 7472 6169 6e5b  _Stacking(train[
+0004dec0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004ded0: 6573 5d2c 7472 6169 6e5b 6561 6368 5f74  es],train[each_t
+0004dee0: 6172 6765 745d 2c74 6573 745b 696d 706f  arget],test[impo
+0004def0: 7274 616e 745f 6665 6174 7572 6573 5d2c  rtant_features],
+0004df00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004df20: 6d6f 6465 6c74 7970 652c 2042 6f6f 7374  modeltype, Boost
+0004df30: 696e 675f 466c 6167 2c20 7363 6f72 696e  ing_Flag, scorin
+0004df40: 675f 7061 7261 6d65 7465 722c 7665 7262  g_parameter,verb
+0004df50: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+0004df60: 2020 2020 2020 2020 2020 2323 2323 2320            ##### 
+0004df70: 4164 6469 6e67 206d 756c 7469 706c 6520  Adding multiple 
+0004df80: 636f 6c75 6d6e 7320 666f 7220 5374 6163  columns for Stac
+0004df90: 6b69 6e67 2069 7320 6265 7374 2120 446f  king is best! Do
+0004dfa0: 206e 6f74 2064 6f20 7468 6520 6176 6572   not do the aver
+0004dfb0: 6167 6520 6f66 2070 7265 6469 6374 696f  age of predictio
+0004dfc0: 6e73 210d 0a20 2020 2020 2020 2020 2020  ns!..           
+0004dfd0: 2020 2020 2020 2020 2074 6573 7420 3d20           test = 
+0004dfe0: 7465 7374 2e6a 6f69 6e28 7064 2e44 6174  test.join(pd.Dat
+0004dff0: 6146 7261 6d65 2873 7461 636b 7332 2c69  aFrame(stacks2,i
+0004e000: 6e64 6578 3d74 6573 742e 696e 6465 782c  ndex=test.index,
+0004e010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e040: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
+0004e050: 6164 6463 6f6c 7329 290d 0a20 2020 2020  addcols))..     
+0004e060: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004e070: 2323 2323 2041 6464 696e 6720 6d75 6c74  #### Adding mult
+0004e080: 6970 6c65 2063 6f6c 756d 6e73 2066 6f72  iple columns for
+0004e090: 2053 7461 636b 696e 6720 6973 2062 6573   Stacking is bes
+0004e0a0: 7421 2044 6f20 6e6f 7420 646f 2074 6865  t! Do not do the
+0004e0b0: 2061 7665 7261 6765 206f 6620 7072 6564   average of pred
+0004e0c0: 6963 7469 6f6e 7321 0d0a 2020 2020 2020  ictions!..      
+0004e0d0: 2020 2020 2020 2020 2020 2020 2020 2374                #t
+0004e0e0: 6573 7420 3d20 7465 7374 2e6a 6f69 6e28  est = test.join(
+0004e0f0: 7064 2e44 6174 6146 7261 6d65 2873 7461  pd.DataFrame(sta
+0004e100: 636b 7332 2e6d 6561 6e28 6178 6973 3d31  cks2.mean(axis=1
+0004e110: 292e 726f 756e 6428 292e 6173 7479 7065  ).round().astype
+0004e120: 2869 6e74 292c 0d0a 2020 2020 2020 2020  (int),..        
+0004e130: 2020 2020 2020 2020 2020 2020 2320 2020              #   
+0004e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e150: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0004e160: 733d 5b61 6464 636f 6c5d 2c69 6e64 6578  s=[addcol],index
+0004e170: 3d74 6573 742e 696e 6465 7829 290d 0a20  =test.index)).. 
+0004e180: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004e190: 2323 2323 2320 2057 6520 6d61 6b65 2073  #####  We make s
+0004e1a0: 7572 6520 7468 6174 2077 6520 7265 6d6f  ure that we remo
+0004e1b0: 7665 2074 6f6f 206d 616e 7920 6665 6174  ve too many feat
+0004e1c0: 7572 6573 2074 6861 7420 6172 6520 6869  ures that are hi
+0004e1d0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
+0004e1e0: 2120 2323 2323 230d 0a20 2020 2020 2020  ! #####..       
+0004e1f0: 2020 2020 2020 2020 2023 6164 6463 6f6c           #addcol
+0004e200: 203d 2072 656d 6f76 655f 7661 7269 6162   = remove_variab
+0004e210: 6c65 735f 7573 696e 675f 6661 7374 5f63  les_using_fast_c
+0004e220: 6f72 7265 6c61 7469 6f6e 2874 7261 696e  orrelation(train
+0004e230: 2c61 6464 636f 6c2c 6d6f 6465 6c74 7970  ,addcol,modeltyp
+0004e240: 652c 636f 7272 5f6c 696d 6974 2c76 6572  e,corr_limit,ver
+0004e250: 626f 7365 290d 0a20 2020 2020 2020 2020  bose)..         
+0004e260: 2020 2020 2020 2069 6d70 6f72 7461 6e74         important
+0004e270: 5f66 6561 7475 7265 7320 2b3d 2061 6464  _features += add
+0004e280: 636f 6c73 0d0a 2020 2020 2020 2020 2020  cols..          
+0004e290: 2020 2020 2020 7361 7665 645f 6e75 6d5f        saved_num_
+0004e2a0: 7661 7273 2e61 7070 656e 6428 6164 6463  vars.append(addc
+0004e2b0: 6f6c 2920 2323 2320 596f 7520 6e65 6564  ol) ### You need
+0004e2c0: 2074 6f20 6164 6420 6974 2066 6f72 2062   to add it for b
+0004e2d0: 696e 6e69 6e67 206c 6174 6572 210d 0a20  inning later!.. 
+0004e2e0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0004e2f0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+0004e300: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
+0004e310: 2069 6e20 5374 6163 6b69 6e67 2073 6563   in Stacking sec
+0004e320: 6f6e 6420 7469 6d65 2e20 436f 6e74 696e  ond time. Contin
+0004e330: 7569 6e67 2e2e 2e27 290d 0a20 2020 2023  uing...')..    #
+0004e340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e390: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+0004e3a0: 2069 6620 6c65 6e28 696d 706f 7274 616e   if len(importan
+0004e3b0: 745f 6665 6174 7572 6573 2920 3d3d 2030  t_features) == 0
+0004e3c0: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
+0004e3d0: 2827 4e6f 2069 6d70 6f72 7461 6e74 2066  ('No important f
+0004e3e0: 6561 7475 7265 7320 666f 756e 642e 2055  eatures found. U
+0004e3f0: 7369 6e67 2061 6c6c 2069 6e70 7574 2066  sing all input f
+0004e400: 6561 7475 7265 732e 2e2e 2729 0d0a 2020  eatures...')..  
+0004e410: 2020 2020 2020 696d 706f 7274 616e 745f        important_
+0004e420: 6665 6174 7572 6573 203d 2063 6f70 792e  features = copy.
+0004e430: 6465 6570 636f 7079 2873 6176 6564 5f69  deepcopy(saved_i
+0004e440: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+0004e450: 7329 0d0a 2020 2020 2020 2020 2369 6d70  s)..        #imp
+0004e460: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
+0004e470: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0004e480: 7265 645f 7072 6564 7329 0d0a 2020 2020  red_preds)..    
+0004e490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004e4e0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0004e4f0: 2020 6966 206d 6f64 656c 5f6e 616d 652e    if model_name.
+0004e500: 6c6f 7765 7228 2920 3d3d 2027 6361 7462  lower() == 'catb
+0004e510: 6f6f 7374 273a 0d0a 2020 2020 2020 2020  oost':..        
+0004e520: 7072 696e 7428 2720 2020 2053 6574 7469  print('    Setti
+0004e530: 6e67 2062 6573 7420 7061 7261 6d73 2066  ng best params f
+0004e540: 6f72 2043 6174 426f 6f73 7420 6d6f 6465  or CatBoost mode
+0004e550: 6c20 6672 6f6d 2049 6e69 7469 616c 2053  l from Initial S
+0004e560: 7461 7465 2073 696e 6365 2079 6f75 2063  tate since you c
+0004e570: 616e 6e6f 7420 6368 616e 6765 2070 6172  annot change par
+0004e580: 616d 7320 746f 2061 2066 6974 7465 6420  ams to a fitted 
+0004e590: 4361 7462 6f6f 7374 206d 6f64 656c 2027  Catboost model '
+0004e5a0: 290d 0a20 2020 2020 2020 2069 6620 6d6f  )..        if mo
+0004e5b0: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
+0004e5c0: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
+0004e5d0: 2020 2020 2020 2020 2020 6d6f 6465 6c20            model 
+0004e5e0: 3d20 7867 626d 2e73 6574 5f70 6172 616d  = xgbm.set_param
+0004e5f0: 7328 2a2a 6265 7374 5f70 6172 616d 7329  s(**best_params)
+0004e600: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0004e610: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004e620: 6d6f 6465 6c5f 6c61 6265 6c20 213d 2027  model_label != '
+0004e630: 4d75 6c74 695f 4c61 6265 6c27 3a0d 0a20  Multi_Label':.. 
+0004e640: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0004e650: 6f64 656c 203d 2078 6762 6d2e 7365 745f  odel = xgbm.set_
+0004e660: 7061 7261 6d73 282a 2a62 6573 745f 7061  params(**best_pa
+0004e670: 7261 6d73 290d 0a20 2020 2020 2020 2070  rams)..        p
+0004e680: 7269 6e74 2827 2020 2020 4e75 6d62 6572  rint('    Number
+0004e690: 206f 6620 4361 7465 676f 7269 6361 6c20   of Categorical 
+0004e6a0: 616e 6420 496e 7465 6765 7220 7661 7269  and Integer vari
+0004e6b0: 6162 6c65 7320 7573 6564 2069 6e20 4361  ables used in Ca
+0004e6c0: 7442 6f6f 7374 2074 7261 696e 696e 6720  tBoost training 
+0004e6d0: 3d20 2564 2720 256c 656e 2869 6d70 5f63  = %d' %len(imp_c
+0004e6e0: 6174 7329 290d 0a20 2020 2023 2323 2320  ats))..    #### 
+0004e6f0: 5065 7266 6f72 6d20 5363 616c 696e 6720  Perform Scaling 
+0004e700: 6f66 2054 7261 696e 2064 6174 6120 6120  of Train data a 
+0004e710: 7365 636f 6e64 2074 696d 6520 7573 696e  second time usin
+0004e720: 6720 4655 4c4c 2054 5241 494e 2064 6174  g FULL TRAIN dat
+0004e730: 6120 7365 7420 7468 6973 2074 696d 6520  a set this time 
+0004e740: 210d 0a20 2020 2023 2323 2320 696d 706f  !..    #### impo
+0004e750: 7274 616e 745f 6665 6174 7572 6573 206b  rtant_features k
+0004e760: 6565 7073 2074 7261 636b 206f 6620 616c  eeps track of al
+0004e770: 6c20 7661 7269 6162 6c65 7320 7468 6174  l variables that
+0004e780: 2077 6520 6e65 6564 2074 6f20 656e 7375   we need to ensu
+0004e790: 7265 2074 6865 7920 6172 6520 7363 616c  re they are scal
+0004e7a0: 6564 210d 0a20 2020 2069 6620 6e6f 7420  ed!..    if not 
+0004e7b0: 7065 7266 6f72 6d5f 7363 616c 696e 675f  perform_scaling_
+0004e7c0: 666c 6167 3a0d 0a20 2020 2020 2020 2070  flag:..        p
+0004e7d0: 7269 6e74 2827 4e6f 2025 7320 7363 616c  rint('No %s scal
+0004e7e0: 696e 6720 7065 7266 6f72 6d65 6420 7369  ing performed si
+0004e7f0: 6e63 6520 7363 616c 696e 6720 666c 6167  nce scaling flag
+0004e800: 2069 7320 7365 7420 746f 2066 616c 7365   is set to false
+0004e810: 2720 2573 6361 6c69 6e67 290d 0a20 2020  ' %scaling)..   
+0004e820: 2020 2020 2058 203d 2074 7261 696e 5b69       X = train[i
+0004e830: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+0004e840: 735d 0d0a 2020 2020 2020 2020 6966 206e  s]..        if n
+0004e850: 6f74 2069 7369 6e73 7461 6e63 6528 6f72  ot isinstance(or
+0004e860: 6967 5f74 6573 742c 2073 7472 293a 0d0a  ig_test, str):..
+0004e870: 2020 2020 2020 2020 2020 2020 585f 7465              X_te
+0004e880: 7374 203d 2074 6573 745b 696d 706f 7274  st = test[import
+0004e890: 616e 745f 6665 6174 7572 6573 5d0d 0a20  ant_features].. 
+0004e8a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0004e8b0: 2020 7072 696e 7428 2750 6572 666f 726d    print('Perform
+0004e8c0: 696e 6720 2573 2073 6361 6c69 6e67 206f  ing %s scaling o
+0004e8d0: 6620 7472 6169 6e20 616e 6420 7465 7374  f train and test
+0004e8e0: 2064 6174 612e 2e2e 2720 2573 6361 6c69   data...' %scali
+0004e8f0: 6e67 290d 0a20 2020 2020 2020 2058 203d  ng)..        X =
+0004e900: 2074 7261 696e 5b69 6d70 6f72 7461 6e74   train[important
+0004e910: 5f66 6561 7475 7265 735d 0d0a 2020 2020  _features]..    
+0004e920: 2020 2020 5353 2e66 6974 2858 290d 0a20      SS.fit(X).. 
+0004e930: 2020 2020 2020 2058 203d 2070 642e 4461         X = pd.Da
+0004e940: 7461 4672 616d 6528 5353 2e74 7261 6e73  taFrame(SS.trans
+0004e950: 666f 726d 2858 292c 696e 6465 783d 6f72  form(X),index=or
+0004e960: 6967 5f74 7261 696e 2e69 6e64 6578 2c0d  ig_train.index,.
+0004e970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e990: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+0004e9a0: 3d69 6d70 6f72 7461 6e74 5f66 6561 7475  =important_featu
+0004e9b0: 7265 7329 0d0a 2020 2020 2020 2020 6966  res)..        if
+0004e9c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0004e9d0: 6f72 6967 5f74 6573 742c 2073 7472 293a  orig_test, str):
+0004e9e0: 0d0a 2020 2020 2020 2020 2020 2020 585f  ..            X_
+0004e9f0: 7465 7374 203d 2070 642e 4461 7461 4672  test = pd.DataFr
+0004ea00: 616d 6528 5353 2e74 7261 6e73 666f 726d  ame(SS.transform
+0004ea10: 2874 6573 745b 696d 706f 7274 616e 745f  (test[important_
+0004ea20: 6665 6174 7572 6573 5d29 2c69 6e64 6578  features]),index
+0004ea30: 3d6f 7269 675f 7465 7374 2e69 6e64 6578  =orig_test.index
+0004ea40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0004ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ea60: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0004ea70: 6e73 3d69 6d70 6f72 7461 6e74 5f66 6561  ns=important_fea
+0004ea80: 7475 7265 7329 0d0a 2020 2020 7072 696e  tures)..    prin
+0004ea90: 7428 2723 2323 2323 2323 2323 2323 2323  t('#############
+0004eaa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ead0: 2323 2323 2323 2323 2323 2323 2323 2729  ##############')
+0004eae0: 0d0a 2020 2020 7072 696e 7428 2723 2323  ..    print('###
+0004eaf0: 2323 2020 2046 2049 204e 2041 204c 2049  ##   F I N A L I
+0004eb00: 205a 2049 204e 2047 2020 204d 204f 2044   Z I N G   M O D
+0004eb10: 2045 204c 2020 204f 204e 2020 2020 4620   E L   O N    F 
+0004eb20: 5520 4c20 4c20 2020 5420 5220 4120 4920  U L L   T R A I 
+0004eb30: 4e20 2023 2323 2323 2729 0d0a 2020 2020  N  #####')..    
+0004eb40: 7072 696e 7428 2723 2323 2323 2323 2323  print('#########
+0004eb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb90: 2323 2729 0d0a 2020 2020 2323 2320 5468  ##')..    ### Th
+0004eba0: 6520 6e65 7874 2032 206c 696e 6573 2061  e next 2 lines a
+0004ebb0: 7265 2063 7275 6369 616c 3a20 6966 2058  re crucial: if X
+0004ebc0: 2061 6e64 2079 2061 7265 2064 6174 6166   and y are dataf
+0004ebd0: 7261 6d65 732c 2074 6865 6e20 6e65 7874  rames, then next
+0004ebe0: 2032 2073 686f 756c 6420 6265 2064 6627   2 should be df'
+0004ebf0: 730d 0a20 2020 2023 2323 2020 2054 6865  s..    ###   The
+0004ec00: 7920 7368 6f75 6c64 206e 6f74 2062 6520  y should not be 
+0004ec10: 6466 2e76 616c 7565 7320 7369 6e63 6520  df.values since 
+0004ec20: 7468 6579 2077 696c 6c20 6265 636f 6d65  they will become
+0004ec30: 206e 756d 7079 2061 7272 6179 7320 616e   numpy arrays an
+0004ec40: 6420 5847 4220 7769 6c6c 2065 7272 6f72  d XGB will error
+0004ec50: 2e0d 0a20 2020 2074 7261 696e 6d20 3d20  ...    trainm = 
+0004ec60: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
+0004ec70: 6665 6174 7572 6573 2b74 6172 6765 745d  features+target]
+0004ec80: 0d0a 2020 2020 7265 645f 7072 6564 7320  ..    red_preds 
+0004ec90: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0004eca0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004ecb0: 6573 290d 0a20 2020 2069 6620 6d6f 6465  es)..    if mode
+0004ecc0: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+0004ecd0: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+0004ece0: 2020 2020 7920 3d20 7472 6169 6e6d 5b65      y = trainm[e
+0004ecf0: 6163 685f 7461 7267 6574 5d0d 0a20 2020  ach_target]..   
+0004ed00: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0004ed10: 7920 3d20 7472 6169 6e6d 5b74 6172 6765  y = trainm[targe
+0004ed20: 745d 0d0a 2020 2020 6576 616c 5f73 6574  t]..    eval_set
+0004ed30: 203d 205b 2829 5d0d 0a20 2020 2023 2323   = [()]..    ###
+0004ed40: 2323 2023 2323 2323 2323 2323 2323 2320  ## ############ 
+0004ed50: 2020 2020 2054 5241 494e 494e 4720 4d4f       TRAINING MO
+0004ed60: 4445 4c20 5345 434f 4e44 2054 494d 4520  DEL SECOND TIME 
+0004ed70: 5749 5448 2046 554c 4c5f 5452 4149 4e20  WITH FULL_TRAIN 
+0004ed80: 414e 4420 5052 4544 4943 5449 4e47 204f  AND PREDICTING O
+0004ed90: 4e20 5445 5354 2023 2323 2323 2323 2323  N TEST #########
+0004eda0: 2323 230d 0a20 2020 206d 6f64 656c 5f73  ###..    model_s
+0004edb0: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
+0004edc0: 2e74 696d 6528 290d 0a20 2020 2069 6620  .time()..    if 
+0004edd0: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
+0004ede0: 5369 6e67 6c65 5f4c 6162 656c 273a 0d0a  Single_Label':..
+0004edf0: 2020 2020 2020 2020 6966 2049 6d62 616c          if Imbal
+0004ee00: 616e 6365 645f 466c 6167 3a0d 0a20 2020  anced_Flag:..   
+0004ee10: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+0004ee20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004ee30: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
+0004ee40: 2323 2323 2323 2323 2020 496d 6261 6c61  ########  Imbala
+0004ee50: 6e63 6564 204d 6f64 656c 2054 7261 696e  nced Model Train
+0004ee60: 696e 6720 2023 2323 2323 2323 2323 2323  ing  ###########
+0004ee70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ee80: 2327 290d 0a20 2020 2020 2020 2020 2020  #')..           
+0004ee90: 2020 2020 2023 7072 696e 7428 2749 6d62       #print('Imb
+0004eea0: 616c 616e 6365 6420 5472 6169 6e69 6e67  alanced Training
+0004eeb0: 2075 7369 6e67 2053 4d4f 5445 2052 6172   using SMOTE Rar
+0004eec0: 6520 436c 6173 7320 4f76 6572 7361 6d70  e Class Oversamp
+0004eed0: 6c69 6e67 206d 6574 686f 642e 2e2e 2729  ling method...')
+0004eee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004eef0: 2020 2323 2320 5369 6e63 6520 6974 2069    ### Since it i
+0004ef00: 7320 6120 7369 6e67 6c65 206c 6162 656c  s a single label
+0004ef10: 2070 726f 626c 656d 2c20 7765 2075 7365   problem, we use
+0004ef20: 2065 6163 685f 7461 7267 6574 2069 6e73   each_target ins
+0004ef30: 7465 6164 206f 6620 7461 7267 6574 0d0a  tead of target..
+0004ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ef50: 6d6f 6465 6c20 3d20 7472 6169 6e69 6e67  model = training
+0004ef60: 5f77 6974 685f 534d 4f54 4528 582c 792c  _with_SMOTE(X,y,
+0004ef70: 2065 6163 685f 7461 7267 6574 2c20 6576   each_target, ev
+0004ef80: 616c 5f73 6574 2c20 6d6f 6465 6c2c 0d0a  al_set, model,..
+0004ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004efa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004efb0: 2020 426f 6f73 7469 6e67 5f46 6c61 672c    Boosting_Flag,
+0004efc0: 2065 7661 6c5f 6d65 7472 6963 2c6d 6f64   eval_metric,mod
+0004efd0: 656c 7479 7065 2c20 6d6f 6465 6c5f 6e61  eltype, model_na
+0004efe0: 6d65 2c0d 0a20 2020 2020 2020 2020 2020  me,..           
+0004eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f000: 2020 2020 2020 2074 7261 696e 696e 673d         training=
+0004f010: 4661 6c73 652c 206d 696e 6f72 6974 795f  False, minority_
+0004f020: 636c 6173 733d 7261 7265 5f63 6c61 7373  class=rare_class
+0004f030: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0004f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f050: 2020 2020 2069 6d70 5f63 6174 733d 696d       imp_cats=im
+0004f060: 705f 6361 7473 2c20 6361 6c69 6272 6174  p_cats, calibrat
+0004f070: 6f72 5f66 6c61 673d 6361 6c69 6272 6174  or_flag=calibrat
+0004f080: 6f72 5f66 6c61 672c 0d0a 2020 2020 2020  or_flag,..      
+0004f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f0a0: 2020 2020 2020 2020 2020 2020 4750 555f              GPU_
+0004f0b0: 6578 6973 7473 3d47 5055 5f65 7869 7374  exists=GPU_exist
+0004f0c0: 732c 2070 6172 616d 733d 6370 755f 7061  s, params=cpu_pa
+0004f0d0: 7261 6d73 2c0d 0a20 2020 2020 2020 2020  rams,..         
+0004f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f0f0: 2020 2020 2020 2020 206d 6f64 656c 5f6c           model_l
+0004f100: 6162 656c 3d6d 6f64 656c 5f6c 6162 656c  abel=model_label
+0004f110: 2c20 7665 7262 6f73 653d 7665 7262 6f73  , verbose=verbos
+0004f120: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0004f130: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0004f140: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0004f150: 4572 726f 7220 696e 2074 7261 696e 696e  Error in trainin
+0004f160: 6720 496d 6261 6c61 6e63 6564 206d 6f64  g Imbalanced mod
+0004f170: 656c 2073 6563 6f6e 6420 7469 6d65 2e20  el second time. 
+0004f180: 5472 7969 6e67 2072 6567 756c 6172 206d  Trying regular m
+0004f190: 6f64 656c 2e2e 2729 0d0a 2020 2020 2020  odel..')..      
+0004f1a0: 2020 2020 2020 2020 2020 496d 6261 6c61            Imbala
+0004f1b0: 6e63 6564 5f46 6c61 6720 3d20 2046 616c  nced_Flag =  Fal
+0004f1c0: 7365 0d0a 2020 2020 2323 2323 2323 2323  se..    ########
+0004f1d0: 2320 2020 494d 504f 5254 414e 5420 2020  #   IMPORTANT   
+0004f1e0: 2049 4d50 4f52 5441 4e54 2023 2323 2323   IMPORTANT #####
+0004f1f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004f200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004f210: 0d0a 2020 2020 2323 2323 2054 6869 7320  ..    #### This 
+0004f220: 6973 206e 6f74 2061 206d 6973 7461 6b65  is not a mistake
+0004f230: 2120 496e 2063 6173 652c 2049 6d62 616c  ! In case, Imbal
+0004f240: 616e 6365 6420 5472 6169 6e69 6e67 2046  anced Training F
+0004f250: 6169 6c73 0d0a 2020 2020 2323 2323 2020  ails..    ####  
+0004f260: 206f 7220 6966 2074 6865 7265 2069 7320   or if there is 
+0004f270: 6e6f 2066 6c61 672c 2077 6520 6d75 7374  no flag, we must
+0004f280: 2073 7469 6c6c 2074 7261 696e 2074 6865   still train the
+0004f290: 206d 6f64 656c 2121 0d0a 2020 2020 2323   model!!..    ##
+0004f2a0: 2323 2020 2044 4f20 4e4f 5420 544f 5543  ##   DO NOT TOUC
+0004f2b0: 4820 5448 4953 204e 4558 5420 4c49 4e45  H THIS NEXT LINE
+0004f2c0: 2054 4849 4e4b 494e 4720 4954 2049 5320   THINKING IT IS 
+0004f2d0: 4120 4d49 5354 414b 4521 0d0a 2020 2020  A MISTAKE!..    
+0004f2e0: 6966 206e 6f74 2049 6d62 616c 616e 6365  if not Imbalance
+0004f2f0: 645f 466c 6167 3a0d 0a20 2020 2020 2020  d_Flag:..       
+0004f300: 2023 2320 5468 6973 2069 7320 7768 6572   ## This is wher
+0004f310: 6520 7765 2074 6573 7420 6966 2074 6865  e we test if the
+0004f320: 2070 7265 7669 6f75 7320 7472 6169 6e69   previous traini
+0004f330: 6e67 2077 6974 6820 534d 4f54 4520 7765  ng with SMOTE we
+0004f340: 6e74 2073 6d6f 6f74 686c 792e 2049 6620  nt smoothly. If 
+0004f350: 6e6f 742c 2077 6520 2074 7279 2077 6974  not, we  try wit
+0004f360: 6820 6120 6469 6666 6572 656e 7420 6d65  h a different me
+0004f370: 7468 6f64 2068 6572 652e 0d0a 2020 2020  thod here...    
+0004f380: 2020 2020 2323 2323 2049 6620 646f 776e      #### If down
+0004f390: 7361 6d70 6c69 6e67 206d 6f64 656c 2066  sampling model f
+0004f3a0: 6169 6c65 642c 2069 7420 7769 6c6c 206a  ailed, it will j
+0004f3b0: 7573 7420 6265 2061 6e20 656d 7074 7920  ust be an empty 
+0004f3c0: 7374 7269 6e67 2c20 736f 2079 6f75 2063  string, so you c
+0004f3d0: 616e 2074 7279 2072 6567 756c 6172 206d  an try regular m
+0004f3e0: 6f64 656c 2023 2323 0d0a 2020 2020 2020  odel ###..      
+0004f3f0: 2020 6966 206d 6f64 656c 5f6c 6162 656c    if model_label
+0004f400: 203d 3d20 2753 696e 676c 655f 4c61 6265   == 'Single_Labe
+0004f410: 6c27 3a0d 0a20 2020 2020 2020 2020 2020  l':..           
+0004f420: 2069 6620 6361 6c69 6272 6174 6f72 5f66   if calibrator_f
+0004f430: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
+0004f440: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
+0004f450: 582c 2079 290d 0a20 2020 2020 2020 2020  X, y)..         
+0004f460: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0004f470: 2020 2020 2020 2020 2020 6966 2042 6f6f            if Boo
+0004f480: 7374 696e 675f 466c 6167 3a0d 0a20 2020  sting_Flag:..   
+0004f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f4a0: 2020 2020 2023 2323 2320 5365 7420 7468       #### Set th
+0004f4b0: 6520 5665 7262 6f73 6520 746f 2030 2073  e Verbose to 0 s
+0004f4c0: 696e 6365 2077 6520 646f 6e27 7420 7761  ince we don't wa
+0004f4d0: 6e74 2074 6f6f 206d 7563 6820 6f75 7470  nt too much outp
+0004f4e0: 7574 2023 230d 0a20 2020 2020 2020 2020  ut ##..         
+0004f4f0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+0004f500: 6465 6c5f 6e61 6d65 203d 3d20 2758 4742  del_name == 'XGB
+0004f510: 6f6f 7374 273a 0d0a 2020 2020 2020 2020  oost':..        
+0004f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f530: 2323 2323 2053 6574 2074 6865 2056 6572  #### Set the Ver
+0004f540: 626f 7365 2074 6f20 3020 7369 6e63 6520  bose to 0 since 
+0004f550: 7765 2064 6f6e 2774 2077 616e 7420 746f  we don't want to
+0004f560: 6f20 6d75 6368 206f 7574 7075 7420 2323  o much output ##
+0004f570: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004f580: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+0004f590: 6669 7428 582c 2079 290d 0a20 2020 2020  fit(X, y)..     
+0004f5a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004f5b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0004f5c0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0004f5d0: 6465 6c2e 6669 7428 582c 2079 2c20 6361  del.fit(X, y, ca
+0004f5e0: 745f 6665 6174 7572 6573 3d69 6d70 5f63  t_features=imp_c
+0004f5f0: 6174 732c 2070 6c6f 743d 4661 6c73 6529  ats, plot=False)
+0004f600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004f610: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0004f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f630: 206d 6f64 656c 2e66 6974 2858 2c20 7929   model.fit(X, y)
+0004f640: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0004f650: 2020 2020 2023 2323 2054 6869 7320 6973       ### This is
+0004f660: 2066 6f72 204d 756c 7469 2d4c 6162 656c   for Multi-Label
+0004f670: 2054 7261 696e 696e 6720 2323 2323 2323   Training ######
+0004f680: 2323 230d 0a20 2020 2020 2020 206d 6f64  ###..        mod
+0004f690: 656c 2e66 6974 2858 2c20 7929 0d0a 2020  el.fit(X, y)..  
+0004f6a0: 2020 7072 696e 7428 2720 2020 2020 4163    print('     Ac
+0004f6b0: 7475 616c 2054 7261 696e 696e 6720 7469  tual Training ti
+0004f6c0: 6d65 2074 616b 656e 2069 6e20 7365 636f  me taken in seco
+0004f6d0: 6e64 7320 3d20 2530 2e30 6627 2025 2874  nds = %0.0f' %(t
+0004f6e0: 696d 652e 7469 6d65 2829 2d6d 6f64 656c  ime.time()-model
+0004f6f0: 5f73 7461 7274 5f74 696d 6529 290d 0a20  _start_time)).. 
+0004f700: 2020 2070 7269 6e74 2827 5472 6169 6e69     print('Traini
+0004f710: 6e67 206f 6620 6d6f 6465 6c73 2063 6f6d  ng of models com
+0004f720: 706c 6574 6564 2e20 4e6f 7720 7374 6172  pleted. Now star
+0004f730: 7469 6e67 2070 7265 6469 6374 696f 6e73  ting predictions
+0004f740: 206f 6e20 7465 7374 2064 6174 612e 2e2e   on test data...
+0004f750: 2729 0d0a 2020 2020 2323 2323 206e 6577  ')..    #### new
+0004f760: 5f63 6f6c 7320 6973 2074 6f20 6b65 6570  _cols is to keep
+0004f770: 2074 7261 636b 206f 6620 6e65 7720 7072   track of new pr
+0004f780: 6564 6963 7469 6f6e 2063 6f6c 756d 6e73  ediction columns
+0004f790: 2077 6520 6172 6520 6372 6561 7469 6e67   we are creating
+0004f7a0: 2023 2323 2323 0d0a 2020 2020 6e65 775f   #####..    new_
+0004f7b0: 636f 6c73 203d 205b 5d0d 0a20 2020 2069  cols = []..    i
+0004f7c0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+0004f7d0: 286f 7269 675f 7465 7374 2c20 7374 7229  (orig_test, str)
+0004f7e0: 3a0d 0a20 2020 2020 2020 2023 2323 2049  :..        ### I
+0004f7f0: 6620 7468 6572 6520 6973 2061 2074 6573  f there is a tes
+0004f800: 7420 6461 7461 2066 7261 6d65 2c20 7468  t data frame, th
+0004f810: 656e 206c 6574 2075 7320 7072 6564 6963  en let us predic
+0004f820: 7420 6f6e 2069 7420 2323 2323 2323 230d  t on it #######.
+0004f830: 0a20 2020 2020 2020 2023 2323 2054 6865  .        ### The
+0004f840: 206e 6578 7420 3320 6c69 6e65 7320 6172   next 3 lines ar
+0004f850: 6520 6372 7563 6961 6c3a 2069 6620 5820  e crucial: if X 
+0004f860: 616e 6420 7920 6172 6520 6461 7461 6672  and y are datafr
+0004f870: 616d 6573 2c20 7468 656e 206e 6578 7420  ames, then next 
+0004f880: 3220 7368 6f75 6c64 2062 6520 6466 2773  2 should be df's
+0004f890: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
+0004f8a0: 5468 6579 2073 686f 756c 6420 6e6f 7420  They should not 
+0004f8b0: 6265 2064 662e 7661 6c75 6573 2073 696e  be df.values sin
+0004f8c0: 6365 2074 6865 7920 7769 6c6c 2062 6563  ce they will bec
+0004f8d0: 6f6d 6520 6e75 6d70 7920 6172 7261 7973  ome numpy arrays
+0004f8e0: 2061 6e64 2058 4742 2077 696c 6c20 6572   and XGB will er
+0004f8f0: 726f 722e 0d0a 2020 2020 2020 2020 7472  ror...        tr
+0004f900: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+0004f910: 2323 2323 2057 6520 6e65 6564 2074 6865  #### We need the
+0004f920: 2069 6420 636f 6c75 6d6e 7320 746f 2063   id columns to c
+0004f930: 6172 7279 206f 7665 7220 696e 746f 2074  arry over into t
+0004f940: 6865 2070 7265 6469 6374 696f 6e73 2023  he predictions #
+0004f950: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0004f960: 2074 6573 746d 203d 206f 7269 675f 7465   testm = orig_te
+0004f970: 7374 5b69 645f 636f 6c73 5d2e 6a6f 696e  st[id_cols].join
+0004f980: 2870 642e 4461 7461 4672 616d 6528 585f  (pd.DataFrame(X_
+0004f990: 7465 7374 2c20 696e 6465 783d 6f72 6967  test, index=orig
+0004f9a0: 5f74 6573 742e 696e 6465 782c 2063 6f6c  _test.index, col
+0004f9b0: 756d 6e73 3d72 6564 5f70 7265 6473 2929  umns=red_preds))
+0004f9c0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+0004f9d0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+0004f9e0: 2323 2069 6620 666f 7220 736f 6d65 2072  ## if for some r
+0004f9f0: 6561 736f 6e20 6964 2063 6f6c 756d 6e73  eason id columns
+0004fa00: 2061 7265 206e 6f74 2061 7661 696c 6162   are not availab
+0004fa10: 6c65 2c20 7468 656e 2064 6f20 7769 7468  le, then do with
+0004fa20: 6f75 7420 6974 0d0a 2020 2020 2020 2020  out it..        
+0004fa30: 2020 2020 7465 7374 6d20 3d20 7064 2e44      testm = pd.D
+0004fa40: 6174 6146 7261 6d65 2858 5f74 6573 742c  ataFrame(X_test,
+0004fa50: 2069 6e64 6578 3d6f 7269 675f 7465 7374   index=orig_test
+0004fa60: 2e69 6e64 6578 2c20 636f 6c75 6d6e 733d  .index, columns=
+0004fa70: 7265 645f 7072 6564 7329 0d0a 2020 2020  red_preds)..    
+0004fa80: 656c 7365 3a0d 0a20 2020 2020 2020 2070  else:..        p
+0004fa90: 7269 6e74 2827 5369 6e63 6520 7468 6572  rint('Since ther
+0004faa0: 6520 6973 206e 6f20 5465 7374 2066 696c  e is no Test fil
+0004fab0: 652c 2077 6520 7769 6c6c 2064 6f20 6120  e, we will do a 
+0004fac0: 6669 6e61 6c20 7072 6564 6963 7469 6f6e  final prediction
+0004fad0: 206f 6e20 5472 6169 6e20 6974 7365 6c66   on Train itself
+0004fae0: 2061 7320 7265 7475 726e 2069 7420 6173   as return it as
+0004faf0: 2074 6573 746d 2064 6174 6166 7261 6d65   testm dataframe
+0004fb00: 2729 0d0a 2020 2020 2020 2020 6f72 6967  ')..        orig
+0004fb10: 5f69 6e64 6578 203d 206f 7269 675f 7472  _index = orig_tr
+0004fb20: 6169 6e2e 696e 6465 780d 0a20 2020 2020  ain.index..     
+0004fb30: 2020 2074 7261 696e 6d20 3d20 7472 6169     trainm = trai
+0004fb40: 6e2e 7265 696e 6465 7828 696e 6465 7820  n.reindex(index 
+0004fb50: 3d20 6f72 6967 5f69 6e64 6578 290d 0a20  = orig_index).. 
+0004fb60: 2020 2020 2020 2069 6620 6e6f 7420 7065         if not pe
+0004fb70: 7266 6f72 6d5f 7363 616c 696e 675f 666c  rform_scaling_fl
+0004fb80: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
+0004fb90: 2058 5f74 6573 7420 3d20 7472 6169 6e6d   X_test = trainm
+0004fba0: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
+0004fbb0: 7265 735d 0d0a 2020 2020 2020 2020 656c  res]..        el
+0004fbc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0004fbd0: 2058 5f74 6573 7420 3d20 7064 2e44 6174   X_test = pd.Dat
+0004fbe0: 6146 7261 6d65 2853 532e 7472 616e 7366  aFrame(SS.transf
+0004fbf0: 6f72 6d28 7472 6169 6e6d 5b69 6d70 6f72  orm(trainm[impor
+0004fc00: 7461 6e74 5f66 6561 7475 7265 735d 292c  tant_features]),
+0004fc10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004fc20: 2020 2020 2020 696e 6465 783d 6f72 6967        index=orig
+0004fc30: 5f69 6e64 6578 2c20 636f 6c75 6d6e 733d  _index, columns=
+0004fc40: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004fc50: 6573 290d 0a20 2020 2020 2020 2074 6573  es)..        tes
+0004fc60: 746d 203d 206f 7269 675f 7472 6169 6e5b  tm = orig_train[
+0004fc70: 6964 5f63 6f6c 735d 2e6a 6f69 6e28 585f  id_cols].join(X_
+0004fc80: 7465 7374 290d 0a20 2020 2023 2323 2323  test)..    #####
+0004fc90: 2323 2323 2323 2320 2054 6869 7320 6973  #######  This is
+0004fca0: 2077 6865 7265 2077 6520 7374 6172 7420   where we start 
+0004fcb0: 7072 6564 6963 7469 6f6e 7320 6f6e 2074  predictions on t
+0004fcc0: 6573 7420 6461 7461 2069 6620 6176 6169  est data if avai
+0004fcd0: 6c61 626c 6520 2323 2323 2323 2323 2323  lable ##########
+0004fce0: 2323 230d 0a20 2020 2074 7279 3a0d 0a20  ###..    try:.. 
+0004fcf0: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+0004fd00: 6d6f 6465 6c2e 7072 6564 6963 7428 585f  model.predict(X_
+0004fd10: 7465 7374 290d 0a20 2020 2065 7863 6570  test)..    excep
+0004fd20: 743a 0d0a 2020 2020 2020 2020 6966 2028  t:..        if (
+0004fd30: 585f 7472 6169 6e2e 6474 7970 6573 203d  X_train.dtypes =
+0004fd40: 3d20 585f 7465 7374 2e64 7479 7065 7329  = X_test.dtypes)
+0004fd50: 2e76 616c 7565 732e 616c 6c28 293a 0d0a  .values.all():..
+0004fd60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004fd70: 7428 274d 6f64 656c 2065 7272 6f72 696e  t('Model errorin
+0004fd80: 6720 6f6e 2070 7265 6469 6374 696f 6e73  g on predictions
+0004fd90: 2e20 4368 6563 6b20 6966 2074 6573 7420  . Check if test 
+0004fda0: 6461 7461 2068 6173 2061 6e79 2064 6966  data has any dif
+0004fdb0: 6665 7265 6e63 6573 2066 726f 6d20 7472  ferences from tr
+0004fdc0: 6169 6e20 6461 7461 2729 0d0a 2020 2020  ain data')..    
+0004fdd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0004fde0: 2020 2020 2020 2065 7272 6f72 696e 675f         erroring_
+0004fdf0: 636f 6c75 6d6e 203d 2058 5f74 7261 696e  column = X_train
+0004fe00: 2e63 6f6c 756d 6e73 5b7e 2858 5f74 7261  .columns[~(X_tra
+0004fe10: 696e 2e64 7479 7065 7320 3d3d 2058 5f74  in.dtypes == X_t
+0004fe20: 6573 742e 6474 7970 6573 292e 7661 6c75  est.dtypes).valu
+0004fe30: 6573 5d5b 305d 0d0a 2020 2020 2020 2020  es][0]..        
+0004fe40: 2020 2020 7072 696e 7428 274d 6f64 656c      print('Model
+0004fe50: 2065 7272 6f72 696e 6720 7369 6e63 6520   erroring since 
+0004fe60: 2573 2068 6173 2061 2064 6966 6665 7265  %s has a differe
+0004fe70: 6e74 2064 7479 7065 2069 6e20 7465 7374  nt dtype in test
+0004fe80: 2063 6f6d 7061 7265 6420 746f 2074 7261   compared to tra
+0004fe90: 696e 2e20 4669 7820 6974 2061 6e64 2072  in. Fix it and r
+0004fea0: 652d 7275 6e2e 2720 2565 7272 6f72 696e  e-run.' %errorin
+0004feb0: 675f 636f 6c75 6d6e 290d 0a20 2020 2020  g_column)..     
+0004fec0: 2020 2020 2020 2072 6574 7572 6e20 6d6f         return mo
+0004fed0: 6465 6c2c 2069 6d70 6f72 7461 6e74 5f66  del, important_f
+0004fee0: 6561 7475 7265 732c 2074 7261 696e 6d2c  eatures, trainm,
+0004fef0: 2074 6573 746d 0d0a 2020 2020 2323 2323   testm..    ####
+0004ff00: 2320 5468 6973 206e 6578 7420 7374 6570  # This next step
+0004ff10: 2069 7320 7665 7279 2069 6d70 6f72 7461   is very importa
+0004ff20: 6e74 2073 696e 6365 2073 6f6d 6520 6d6f  nt since some mo
+0004ff30: 6465 6c73 2067 6976 6520 7365 7269 6573  dels give series
+0004ff40: 2c20 6f74 6865 7273 2067 6976 6520 6172  , others give ar
+0004ff50: 7261 7973 2e20 5665 7279 2070 6169 6e66  rays. Very painf
+0004ff60: 756c 210d 0a20 2020 2069 6620 6973 696e  ul!..    if isin
+0004ff70: 7374 616e 6365 2879 5f70 7265 642c 7064  stance(y_pred,pd
+0004ff80: 2e53 6572 6965 7329 206f 7220 6973 696e  .Series) or isin
+0004ff90: 7374 616e 6365 2879 5f70 7265 642c 7064  stance(y_pred,pd
+0004ffa0: 2e44 6174 6146 7261 6d65 2920 3a0d 0a20  .DataFrame) :.. 
+0004ffb0: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+0004ffc0: 795f 7072 6564 2e76 616c 7565 730d 0a20  y_pred.values.. 
+0004ffd0: 2020 2023 2323 2323 2323 2054 6869 7320     ####### This 
+0004ffe0: 6973 2077 6865 7265 2079 6f75 206d 6f64  is where you mod
+0004fff0: 6966 7920 7072 6564 6963 7469 6f6e 7320  ify predictions 
+00050000: 6f6e 2074 6573 7420 6461 7461 2074 6f20  on test data to 
+00050010: 6265 2073 616d 6520 6173 206f 7269 6769  be same as origi
+00050020: 6e61 6c20 6461 7461 2074 7970 6520 2323  nal data type ##
+00050030: 2323 230d 0a20 2020 2069 6620 6d6f 6469  ###..    if modi
+00050040: 6679 5f74 6172 6765 7473 5f66 6c61 673a  fy_targets_flag:
+00050050: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+00050060: 203d 206d 6f64 6966 795f 6172 7261 795f   = modify_array_
+00050070: 746f 5f69 6e74 6567 6572 2879 5f70 7265  to_integer(y_pre
+00050080: 642c 2074 6172 6765 7473 5f6e 6567 6174  d, targets_negat
+00050090: 6976 655f 666c 6167 290d 0a20 2020 2069  ive_flag)..    i
+000500a0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+000500b0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+000500c0: 2020 2020 2020 2323 2323 2323 2323 2020        ########  
+000500d0: 2054 6869 7320 6973 2066 6f72 2052 6567   This is for Reg
+000500e0: 7265 7373 696f 6e20 5072 6f62 6c65 6d73  ression Problems
+000500f0: 204f 6e6c 7920 2323 2323 2323 2323 2323   Only ##########
+00050100: 230d 0a20 2020 2020 2020 2023 2323 2323  #..        #####
+00050110: 2320 2049 6620 5374 6163 6b69 6e67 5f20  #  If Stacking_ 
+00050120: 466c 6167 2069 7320 4661 6c73 652c 2074  Flag is False, t
+00050130: 6865 6e20 7765 2064 6f20 456e 7365 6d62  hen we do Ensemb
+00050140: 6c69 6e67 2023 2323 2323 2323 0d0a 2020  ling #######..  
+00050150: 2020 2020 2020 6966 206e 6f74 2053 7461        if not Sta
+00050160: 636b 696e 675f 466c 6167 2061 6e64 206e  cking_Flag and n
+00050170: 6f74 206d 6f64 656c 5f6c 6162 656c 203d  ot model_label =
+00050180: 3d20 274d 756c 7469 5f4c 6162 656c 273a  = 'Multi_Label':
+00050190: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+000501a0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+000501b0: 2020 2020 6e65 775f 636f 6c73 203d 205b      new_cols = [
+000501c0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000501d0: 2020 2073 7562 6d20 3d20 7064 2e44 6174     subm = pd.Dat
+000501e0: 6146 7261 6d65 2829 0d0a 2020 2020 2020  aFrame()..      
+000501f0: 2020 2020 2020 2020 2020 2323 2323 2054            #### T
+00050200: 6869 7320 6973 2066 6f72 2045 6e73 656d  his is for Ensem
+00050210: 626c 696e 6720 204f 6e6c 7920 2323 2323  bling  Only ####
+00050220: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+00050230: 2020 2023 2323 2320 496e 2054 6573 7420     #### In Test 
+00050240: 6461 7461 2076 6572 626f 7365 2069 7320  data verbose is 
+00050250: 7365 7420 746f 207a 6572 6f20 7369 6e63  set to zero sinc
+00050260: 6520 6e6f 2072 6573 756c 7473 2063 616e  e no results can
+00050270: 2062 6520 6f62 7461 696e 6564 210d 0a20   be obtained!.. 
+00050280: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00050290: 6f64 656c 735f 6c69 7374 2c20 656e 7365  odels_list, ense
+000502a0: 6d62 6c65 7320 3d20 5175 6963 6b4d 4c5f  mbles = QuickML_
+000502b0: 456e 7365 6d62 6c69 6e67 2858 2c20 792c  Ensembling(X, y,
+000502c0: 2058 5f74 6573 742c 2027 272c 0d0a 2020   X_test, '',..  
+000502d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000502e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000502f0: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+00050300: 653d 6d6f 6465 6c74 7970 652c 2042 6f6f  e=modeltype, Boo
+00050310: 7374 696e 675f 466c 6167 3d42 6f6f 7374  sting_Flag=Boost
+00050320: 696e 675f 466c 6167 2c0d 0a20 2020 2020  ing_Flag,..     
 00050330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050340: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
-00050350: 2073 7562 6d5b 6e65 775f 636f 6c73 5b2d   subm[new_cols[-
-00050360: 315d 5d2a 302e 352b 302e 3132 352a 2873  1]]*0.5+0.125*(s
-00050370: 7562 6d5b 6e65 775f 636f 6c73 5b30 5d5d  ubm[new_cols[0]]
-00050380: 2b73 7562 6d5b 0d0a 2020 2020 2020 2020  +subm[..        
-00050390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503a0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-000503b0: 636f 6c73 5b31 5d5d 2b73 7562 6d5b 6e65  cols[1]]+subm[ne
-000503c0: 775f 636f 6c73 5b32 5d5d 2b73 7562 6d5b  w_cols[2]]+subm[
-000503d0: 6e65 775f 636f 6c73 5b33 5d5d 290d 0a20  new_cols[3]]).. 
-000503e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000503f0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00050400: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00050410: 2720 2020 2043 616c 6375 6c61 7469 6e67  '    Calculating
-00050420: 2072 6567 756c 6172 2061 7665 7261 6765   regular average
-00050430: 2065 6e73 656d 626c 6520 6f66 2025 6420   ensemble of %d 
-00050440: 7265 6772 6573 736f 7273 2720 256c 656e  regressors' %len
-00050450: 2863 6f6c 7329 290d 0a20 2020 2020 2020  (cols))..       
-00050460: 2020 2020 2020 2020 2020 2020 2065 6e73               ens
-00050470: 656d 5f70 7265 6420 3d20 2873 7562 6d5b  em_pred = (subm[
-00050480: 6e65 775f 636f 6c73 5d2e 6d65 616e 2861  new_cols].mean(a
-00050490: 7869 733d 3129 290d 0a20 2020 2020 2020  xis=1))..       
-000504a0: 2020 2020 2020 2020 2023 2323 2323 2054           ##### T
-000504b0: 6869 7320 6e65 7874 2073 7465 7020 6973  his next step is
-000504c0: 2076 6572 7920 696d 706f 7274 616e 7420   very important 
-000504d0: 7369 6e63 6520 736f 6d65 206d 6f64 656c  since some model
-000504e0: 7320 6769 7665 2073 6572 6965 732c 206f  s give series, o
-000504f0: 7468 6572 7320 6769 7665 2061 7272 6179  thers give array
-00050500: 732e 2056 6572 7920 7061 696e 6675 6c21  s. Very painful!
-00050510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050520: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00050530: 656e 7365 6d5f 7072 6564 2c70 642e 5365  ensem_pred,pd.Se
-00050540: 7269 6573 2920 6f72 2069 7369 6e73 7461  ries) or isinsta
-00050550: 6e63 6528 656e 7365 6d5f 7072 6564 2c70  nce(ensem_pred,p
-00050560: 642e 4461 7461 4672 616d 6529 3a0d 0a20  d.DataFrame):.. 
-00050570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050580: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
-00050590: 656e 7365 6d5f 7072 6564 2e76 616c 7565  ensem_pred.value
-000505a0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-000505b0: 2020 206e 6577 5f63 6f6c 203d 2065 6163     new_col = eac
-000505c0: 685f 7461 7267 6574 2b27 5f45 6e73 656d  h_target+'_Ensem
-000505d0: 626c 6564 5f70 7265 6469 6374 696f 6e73  bled_predictions
-000505e0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-000505f0: 2020 2074 6573 746d 5b6e 6577 5f63 6f6c     testm[new_col
-00050600: 5d20 3d20 656e 7365 6d5f 7072 6564 0d0a  ] = ensem_pred..
+00050340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050350: 2020 2020 2020 7363 6f72 696e 673d 2727        scoring=''
+00050360: 2c20 7665 7262 6f73 653d 3029 0d0a 2020  , verbose=0)..  
+00050370: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00050380: 6465 6c73 5f6c 6973 742e 6170 7065 6e64  dels_list.append
+00050390: 286d 6f64 656c 5f6e 616d 6529 0d0a 2020  (model_name)..  
+000503a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000503b0: 7220 6d6f 6465 6c73 2c20 6561 6368 2069  r models, each i
+000503c0: 6e20 7a69 7028 6d6f 6465 6c73 5f6c 6973  n zip(models_lis
+000503d0: 742c 2072 616e 6765 286c 656e 286d 6f64  t, range(len(mod
+000503e0: 656c 735f 6c69 7374 2929 293a 0d0a 2020  els_list))):..  
+000503f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050400: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
+00050410: 5f74 6172 6765 742b 275f 272b 6d6f 6465  _target+'_'+mode
+00050420: 6c73 2b27 5f70 7265 6469 6374 696f 6e73  ls+'_predictions
+00050430: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00050440: 2020 2020 2020 2069 6620 6561 6368 2b31         if each+1
+00050450: 203d 3d20 6c65 6e28 6d6f 6465 6c73 5f6c   == len(models_l
+00050460: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
+00050470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00050480: 7562 6d5b 6e65 775f 636f 6c5d 203d 2079  ubm[new_col] = y
+00050490: 5f70 7265 640d 0a20 2020 2020 2020 2020  _pred..         
+000504a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000504b0: 6573 746d 5b6e 6577 5f63 6f6c 5d20 3d20  estm[new_col] = 
+000504c0: 795f 7072 6564 0d0a 2020 2020 2020 2020  y_pred..        
+000504d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000504e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000504f0: 2020 2020 2020 2020 2020 2073 7562 6d5b             subm[
+00050500: 6e65 775f 636f 6c5d 203d 2065 6e73 656d  new_col] = ensem
+00050510: 626c 6573 5b3a 2c65 6163 685d 0d0a 2020  bles[:,each]..  
+00050520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050530: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
+00050540: 636f 6c5d 203d 2065 6e73 656d 626c 6573  col] = ensembles
+00050550: 5b3a 2c65 6163 685d 0d0a 2020 2020 2020  [:,each]..      
+00050560: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00050570: 775f 636f 6c73 2e61 7070 656e 6428 6e65  w_cols.append(ne
+00050580: 775f 636f 6c29 0d0a 2020 2020 2020 2020  w_col)..        
+00050590: 2020 2020 2020 2020 2323 2320 4166 7465          ### Afte
+000505a0: 7220 7468 6973 2c20 795f 7072 6564 2069  r this, y_pred i
+000505b0: 7320 6120 5365 7269 6573 2066 726f 6d20  s a Series from 
+000505c0: 6e6f 7720 6f6e 2e20 596f 7520 6e65 6564  now on. You need
+000505d0: 2079 5f70 7265 642e 7661 6c75 6573 2020   y_pred.values  
+000505e0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+000505f0: 2020 2020 2020 6966 206c 656e 286e 6577        if len(new
+00050600: 5f63 6f6c 7329 203d 3d20 353a 0d0a 2020  _cols) == 5:..  
 00050610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050620: 6e65 775f 636f 6c73 2e61 7070 656e 6428  new_cols.append(
-00050630: 6e65 775f 636f 6c29 0d0a 2020 2020 2020  new_col)..      
-00050640: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00050650: 2743 6f6d 706c 6574 6564 2045 6e73 656d  'Completed Ensem
-00050660: 626c 6520 7072 6564 6963 7469 6f6e 7320  ble predictions 
-00050670: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
-00050680: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00050690: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-000506a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-000506b0: 436f 756c 6420 6e6f 7420 636f 6d70 6c65  Could not comple
-000506c0: 7465 2045 6e73 656d 626c 696e 6720 7072  te Ensembling pr
-000506d0: 6564 6963 7469 6f6e 7320 6f6e 2068 656c  edictions on hel
-000506e0: 6420 6f75 7420 6461 7461 2064 7565 2074  d out data due t
-000506f0: 6f20 4572 726f 7227 290d 0a20 2020 2020  o Error')..     
-00050700: 2020 2065 6c69 6620 5374 6163 6b69 6e67     elif Stacking
-00050710: 5f46 6c61 6720 616e 6420 6e6f 7420 6d6f  _Flag and not mo
-00050720: 6465 6c5f 6c61 6265 6c20 3d3d 2027 4d75  del_label == 'Mu
-00050730: 6c74 695f 4c61 6265 6c27 3a0d 0a20 2020  lti_Label':..   
-00050740: 2020 2020 2020 2020 2073 7461 636b 5f63           stack_c
-00050750: 6f6c 732c 2073 7461 636b 7366 696e 616c  ols, stacksfinal
-00050760: 203d 2051 7569 636b 4d4c 5f53 7461 636b   = QuickML_Stack
-00050770: 696e 6728 582c 2079 2c20 585f 7465 7374  ing(X, y, X_test
-00050780: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00050790: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-000507a0: 656c 7479 7065 2c20 426f 6f73 7469 6e67  eltype, Boosting
-000507b0: 5f46 6c61 672c 0d0a 2020 2020 2020 2020  _Flag,..        
-000507c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000507d0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
-000507e0: 7465 722c 7665 7262 6f73 653d 7665 7262  ter,verbose=verb
-000507f0: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
-00050800: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
-00050810: 5f74 6172 6765 742b 275f 5374 6163 6b65  _target+'_Stacke
-00050820: 645f 272b 7374 6163 6b5f 636f 6c73 5b30  d_'+stack_cols[0
-00050830: 5d2e 7370 6c69 7428 225f 2229 5b30 5d2b  ].split("_")[0]+
-00050840: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
-00050850: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00050860: 656e 2873 7461 636b 5f63 6f6c 7329 203d  en(stack_cols) =
-00050870: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
-00050880: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
-00050890: 636f 6c5d 203d 2073 7461 636b 7366 696e  col] = stacksfin
-000508a0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-000508b0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000508c0: 2020 2020 2020 2023 2323 2320 4a75 7374         #### Just
-000508d0: 2061 7665 7261 6765 2074 6865 2070 7265   average the pre
-000508e0: 6469 6374 696f 6e73 2066 726f 6d20 6561  dictions from ea
-000508f0: 6368 2073 7461 636b 6564 206d 6f64 656c  ch stacked model
-00050900: 2069 6e74 6f20 6120 6669 6e61 6c20 7072   into a final pr
-00050910: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00050920: 2020 2020 7465 7374 6d5b 6e65 775f 636f      testm[new_co
-00050930: 6c5d 203d 2073 7461 636b 7366 696e 616c  l] = stacksfinal
-00050940: 2e6d 6561 6e28 6178 6973 3d31 290d 0a20  .mean(axis=1).. 
-00050950: 2020 2020 2020 2023 2323 2323 2320 5468         ###### Th
-00050960: 6973 2061 7070 6c69 6573 2074 6f20 5369  is applies to Si
-00050970: 6e67 6c65 5f4c 6162 656c 2061 7320 7765  ngle_Label as we
-00050980: 6c6c 2061 7320 4d75 6c74 695f 4c61 6265  ll as Multi_Labe
-00050990: 6c20 7072 6f62 6c65 6d73 2023 2323 2323  l problems #####
-000509a0: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
-000509b0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-000509c0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
-000509d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000509e0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000509f0: 7361 6d70 6c65 5f73 7562 6d69 7373 696f  sample_submissio
-00050a00: 6e2c 2073 7472 293a 0d0a 2020 2020 2020  n, str):..      
-00050a10: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00050a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050a30: 2020 2020 7361 6d70 6c65 5f73 7562 6d69      sample_submi
-00050a40: 7373 696f 6e5b 6561 6368 5f74 6172 6765  ssion[each_targe
-00050a50: 745d 203d 2079 5f70 7265 640d 0a20 2020  t] = y_pred..   
-00050a60: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-00050a70: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00050a80: 2020 2020 2020 2020 2020 2323 2320 6966            ### if
-00050a90: 2066 6f72 2073 6f6d 6520 7265 6173 6f6e   for some reason
-00050aa0: 2c20 7468 6520 7361 6d70 6c65 2073 7562  , the sample sub
-00050ab0: 6d69 7373 696f 6e20 6669 6c65 2068 6173  mission file has
-00050ac0: 2061 2064 6966 6665 7265 6e74 2073 6861   a different sha
-00050ad0: 7065 2074 6861 6e20 795f 7072 6564 2c0d  pe than y_pred,.
-00050ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00050af0: 2020 2020 2023 2323 2020 7468 6973 206d       ###  this m
-00050b00: 6179 2063 6175 7365 2061 6e20 6572 726f  ay cause an erro
-00050b10: 7220 616e 6420 796f 7520 6361 6e20 6a75  r and you can ju
-00050b20: 7374 2073 6b69 7020 7468 6174 2073 7465  st skip that ste
-00050b30: 7021 0d0a 2020 2020 2020 2020 2020 2020  p!..            
-00050b40: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
-00050b50: 7272 6f72 3a20 5361 6d70 6c65 2073 7562  rror: Sample sub
-00050b60: 6d69 7373 696f 6e20 6669 6c65 2069 7320  mission file is 
-00050b70: 696e 636f 7272 6563 742e 2050 6c65 6173  incorrect. Pleas
-00050b80: 6520 6368 6563 6b20 6974 2e20 636f 6e74  e check it. cont
-00050b90: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
-00050ba0: 2020 2020 2020 2020 2023 2323 2320 4966           #### If
-00050bb0: 2074 6865 7265 2069 7320 6120 7465 7374   there is a test
-00050bc0: 2066 696c 652c 2069 7420 7072 6f62 6162   file, it probab
-00050bd0: 6c79 2064 6f65 736e 2774 2068 6176 6520  ly doesn't have 
-00050be0: 7461 7267 6574 2c20 736f 2061 6464 2070  target, so add p
-00050bf0: 7265 6469 6374 696f 6e73 2074 6f20 6974  redictions to it
-00050c00: 210d 0a20 2020 2020 2020 2020 2020 2074  !..            t
-00050c10: 6573 746d 5b65 6163 685f 7461 7267 6574  estm[each_target
-00050c20: 2b27 5f70 7265 6469 6374 696f 6e73 275d  +'_predictions']
-00050c30: 203d 2079 5f70 7265 640d 0a20 2020 2020   = y_pred..     
-00050c40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00050c50: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00050c60: 6e73 7461 6e63 6528 7361 6d70 6c65 5f73  nstance(sample_s
-00050c70: 7562 6d69 7373 696f 6e2c 2073 7472 293a  ubmission, str):
-00050c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050c90: 2020 666f 7220 7072 6564 6963 745f 636f    for predict_co
-00050ca0: 6c2c 2069 2069 6e20 7a69 7028 7461 7267  l, i in zip(targ
-00050cb0: 6574 2c20 7261 6e67 6528 6c65 6e28 7461  et, range(len(ta
-00050cc0: 7267 6574 2929 293a 0d0a 2020 2020 2020  rget))):..      
-00050cd0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00050ce0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00050cf0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-00050d00: 6c65 5f73 7562 6d69 7373 696f 6e5b 7072  le_submission[pr
-00050d10: 6564 6963 745f 636f 6c5d 203d 2079 5f70  edict_col] = y_p
-00050d20: 7265 645b 3a2c 695d 0d0a 2020 2020 2020  red[:,i]..      
-00050d30: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00050d40: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00050d50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00050d60: 2323 2069 6620 666f 7220 736f 6d65 2072  ## if for some r
-00050d70: 6561 736f 6e2c 2074 6865 2073 616d 706c  eason, the sampl
-00050d80: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
-00050d90: 6520 6861 7320 6120 6469 6666 6572 656e  e has a differen
-00050da0: 7420 7368 6170 6520 7468 616e 2079 5f70  t shape than y_p
-00050db0: 7265 642c 0d0a 2020 2020 2020 2020 2020  red,..          
-00050dc0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00050dd0: 2320 2074 6869 7320 6d61 7920 6361 7573  #  this may caus
-00050de0: 6520 616e 2065 7272 6f72 2061 6e64 2079  e an error and y
-00050df0: 6f75 2063 616e 206a 7573 7420 736b 6970  ou can just skip
-00050e00: 2074 6861 7420 7374 6570 210d 0a20 2020   that step!..   
-00050e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050e20: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
-00050e30: 723a 2053 616d 706c 6520 7375 626d 6973  r: Sample submis
-00050e40: 7369 6f6e 2066 696c 6520 6973 2069 6e63  sion file is inc
-00050e50: 6f72 7265 6374 2e20 506c 6561 7365 2063  orrect. Please c
-00050e60: 6865 636b 2069 742e 2063 6f6e 7469 6e75  heck it. continu
-00050e70: 696e 672e 2e2e 2729 0d0a 2020 2020 2020  ing...')..      
-00050e80: 2020 2323 2323 2049 6620 7468 6572 6520    #### If there 
-00050e90: 6973 2061 2074 6573 7420 6669 6c65 2c20  is a test file, 
-00050ea0: 6974 2070 726f 6261 626c 7920 646f 6573  it probably does
-00050eb0: 6e27 7420 6861 7665 2074 6172 6765 742c  n't have target,
-00050ec0: 2073 6f20 6164 6420 7072 6564 6963 7469   so add predicti
-00050ed0: 6f6e 7320 746f 2069 7421 0d0a 2020 2020  ons to it!..    
-00050ee0: 2020 2020 2020 2020 666f 7220 7072 6564          for pred
-00050ef0: 6963 745f 636f 6c2c 2069 2069 6e20 7a69  ict_col, i in zi
-00050f00: 7028 7461 7267 6574 2c20 7261 6e67 6528  p(target, range(
-00050f10: 6c65 6e28 7461 7267 6574 2929 293a 0d0a  len(target))):..
-00050f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050f30: 7465 7374 6d5b 7072 6564 6963 745f 636f  testm[predict_co
-00050f40: 6c2b 275f 7072 6564 6963 7469 6f6e 7327  l+'_predictions'
-00050f50: 5d20 3d20 795f 7072 6564 5b3a 2c69 5d0d  ] = y_pred[:,i].
-00050f60: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00050f70: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-00050f80: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-00050f90: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
-00050fa0: 2020 2023 2323 2320 4f6e 6c79 2063 6572     #### Only cer
-00050fb0: 7461 696e 206d 756c 7469 2d6f 7574 7075  tain multi-outpu
-00050fc0: 7420 636c 6173 7369 6669 6572 7320 7072  t classifiers pr
-00050fd0: 6f76 6964 6520 7072 6f62 6173 2e20 466f  ovide probas. Fo
-00050fe0: 7220 6e6f 7720 4c69 6e65 6172 5356 4320  r now LinearSVC 
-00050ff0: 6361 6e27 742e 2048 656e 6365 2073 6b69  can't. Hence ski
-00051000: 7020 7468 6973 2e2e 2e0d 0a20 2020 2020  p this.....     
-00051010: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
-00051020: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
-00051030: 2020 2020 2323 2323 2323 2323 2020 2054      ########   T
-00051040: 6869 7320 6973 2066 6f72 2062 6f74 6820  his is for both 
-00051050: 4269 6e61 7279 2061 6e64 204d 756c 7469  Binary and Multi
-00051060: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
-00051070: 5072 6f62 6c65 6d73 2023 2323 2323 2323  Problems #######
-00051080: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00051090: 2020 795f 7072 6f62 6120 3d20 6d6f 6465    y_proba = mode
-000510a0: 6c2e 7072 6564 6963 745f 7072 6f62 6128  l.predict_proba(
-000510b0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-000510c0: 2020 2020 2070 7265 6469 6374 6564 203d       predicted =
-000510d0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
-000510e0: 5f70 726f 6261 290d 0a20 2020 2020 2020  _proba)..       
-000510f0: 2020 2020 2069 6620 6c65 6e28 636c 6173       if len(clas
-00051100: 7365 7329 203c 3d20 323a 0d0a 2020 2020  ses) <= 2:..    
-00051110: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00051120: 6963 7465 6420 5b3a 2c30 5d20 3d20 2870  icted [:,0] = (p
-00051130: 7265 6469 6374 6564 205b 3a2c 305d 203e  redicted [:,0] >
-00051140: 3d20 2831 2d6d 5f74 6872 6573 6829 292e  = (1-m_thresh)).
-00051150: 6173 7479 7065 2827 696e 7427 290d 0a20  astype('int').. 
-00051160: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00051170: 7265 6469 6374 6564 205b 3a2c 315d 203d  redicted [:,1] =
-00051180: 2028 7072 6564 6963 7465 6420 5b3a 2c31   (predicted [:,1
-00051190: 5d20 3e20 6d5f 7468 7265 7368 292e 6173  ] > m_thresh).as
-000511a0: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
-000511b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000511c0: 7072 6564 6963 7465 645b 3a2c 7261 7265  predicted[:,rare
-000511d0: 5f63 6c61 7373 5d2e 6d65 616e 2829 3d3d  _class].mean()==
-000511e0: 3020 6f72 2070 7265 6469 6374 6564 5b3a  0 or predicted[:
-000511f0: 2c72 6172 655f 636c 6173 735d 2e6d 6561  ,rare_class].mea
-00051200: 6e28 293d 3d31 3a0d 0a20 2020 2020 2020  n()==1:..       
-00051210: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00051220: 2049 6620 7468 6520 6d6f 6465 6c20 6973   If the model is
-00051230: 2070 7265 6469 6374 696e 6720 616c 6c20   predicting all 
-00051240: 3027 7320 6f72 2061 6c6c 2031 2773 2c20  0's or all 1's, 
-00051250: 796f 7520 6e65 6564 2074 6f20 7573 6520  you need to use 
-00051260: 6120 7265 6775 6c61 7220 7468 7265 7368  a regular thresh
-00051270: 6f6c 640d 0a20 2020 2020 2020 2020 2020  old..           
-00051280: 2020 2020 2020 2020 206d 5f74 6872 6573           m_thres
-00051290: 6820 3d20 302e 350d 0a20 2020 2020 2020  h = 0.5..       
-000512a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000512b0: 6e74 2827 2020 2020 4d61 6b69 6e67 2074  nt('    Making t
-000512c0: 6573 7420 4461 7461 2070 7265 6469 6374  est Data predict
-000512d0: 696f 6e73 2075 7369 6e67 2072 6567 756c  ions using regul
-000512e0: 6172 2054 6872 6573 686f 6c64 203d 2025  ar Threshold = %
-000512f0: 302e 3366 2720 256d 5f74 6872 6573 6829  0.3f' %m_thresh)
-00051300: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051310: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00051320: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00051330: 2049 6620 7468 6520 6d6f 6465 6c20 6973   If the model is
-00051340: 2067 6f6f 6420 7769 7468 2074 6865 206d   good with the m
-00051350: 6f64 6966 6965 6420 7468 7265 7368 6f6c  odified threshol
-00051360: 642c 2074 6865 6e20 796f 7520 7573 6520  d, then you use 
-00051370: 7468 6520 6d6f 6469 6669 6564 2074 6872  the modified thr
-00051380: 6573 686f 6c64 210d 0a20 2020 2020 2020  eshold!..       
-00051390: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000513a0: 6e74 2827 2020 2020 4d61 6b69 6e67 2074  nt('    Making t
-000513b0: 6573 7420 4461 7461 2070 7265 6469 6374  est Data predict
-000513c0: 696f 6e73 2075 7369 6e67 206d 6f64 6966  ions using modif
-000513d0: 6965 6420 5468 7265 7368 6f6c 6420 3d20  ied Threshold = 
-000513e0: 2530 2e33 6627 2025 6d5f 7468 7265 7368  %0.3f' %m_thresh
-000513f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00051400: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
-00051410: 7072 6564 6963 7465 645b 3a2c 7261 7265  predicted[:,rare
-00051420: 5f63 6c61 7373 5d0d 0a20 2020 2020 2020  _class]..       
-00051430: 2020 2020 2023 2323 2059 6f75 2077 696c       ### You wil
-00051440: 6c20 6e65 6564 2074 6f20 6372 6561 7465  l need to create
-00051450: 2070 726f 6261 6269 6c69 7469 6573 2066   probabilities f
-00051460: 6f72 2065 6163 6820 636c 6173 7320 6865  or each class he
-00051470: 7265 2020 2323 2323 0d0a 2020 2020 2020  re  ####..      
-00051480: 2020 2020 2020 666f 7220 6561 6368 5f63        for each_c
-00051490: 6c61 7373 2069 6e20 636c 6173 7365 733a  lass in classes:
-000514a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000514b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000514c0: 6561 6368 5f63 6c61 7373 2c20 7374 7229  each_class, str)
-000514d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000514e0: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
-000514f0: 203d 2065 6163 685f 7461 7267 6574 2b27   = each_target+'
-00051500: 5f70 726f 6261 5f27 2b65 6163 685f 636c  _proba_'+each_cl
-00051510: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-00051520: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00051530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051540: 7072 6f62 615f 636f 6c20 3d20 6561 6368  proba_col = each
-00051550: 5f74 6172 6765 742b 275f 7072 6f62 615f  _target+'_proba_
-00051560: 272b 7374 7228 6561 6368 5f63 6c61 7373  '+str(each_class
-00051570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00051580: 2020 2063 6f75 6e74 203d 2069 6e74 286c     count = int(l
-00051590: 6162 656c 5f64 6963 745b 6561 6368 5f74  abel_dict[each_t
-000515a0: 6172 6765 745d 5b27 6469 6374 696f 6e61  arget]['dictiona
-000515b0: 7279 275d 5b65 6163 685f 636c 6173 735d  ry'][each_class]
-000515c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000515d0: 2020 2074 6573 746d 5b70 726f 6261 5f63     testm[proba_c
-000515e0: 6f6c 5d20 3d20 795f 7072 6f62 615b 3a2c  ol] = y_proba[:,
-000515f0: 636f 756e 745d 0d0a 2020 2020 2020 2020  count]..        
-00051600: 2020 2020 2020 2020 7072 6f62 615f 636f          proba_co
-00051610: 6c73 2e61 7070 656e 6428 7072 6f62 615f  ls.append(proba_
-00051620: 636f 6c29 0d0a 2020 2020 2020 2020 2323  col)..        ##
-00051630: 2323 2320 4e6f 7720 7461 6b65 2065 6163  ### Now take eac
-00051640: 6820 7461 7267 6574 2069 6e20 7468 6520  h target in the 
-00051650: 6c69 7374 206f 6620 7461 7267 6574 7320  list of targets 
-00051660: 616e 6420 6170 706c 7920 7265 7665 7273  and apply revers
-00051670: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
-00051680: 206f 6e20 7072 6564 6963 7465 6420 6c61   on predicted la
-00051690: 6265 6c73 2023 2323 230d 0a20 2020 2020  bels ####..     
-000516a0: 2020 2066 6f72 2065 6163 685f 7461 7267     for each_targ
-000516b0: 6574 2c20 6920 696e 207a 6970 2874 6172  et, i in zip(tar
-000516c0: 6765 742c 2072 616e 6765 286c 656e 2874  get, range(len(t
-000516d0: 6172 6765 7429 2929 3a0d 0a20 2020 2020  arget))):..     
-000516e0: 2020 2020 2020 2069 6620 6c65 6e28 6c61         if len(la
-000516f0: 6265 6c5f 6469 6374 5b65 6163 685f 7461  bel_dict[each_ta
-00051700: 7267 6574 5d5b 2774 7261 6e73 666f 726d  rget]['transform
-00051710: 6572 275d 2920 3d3d 2030 3a0d 0a20 2020  er']) == 0:..   
-00051720: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00051730: 2323 2323 2323 2020 4e4f 2020 2054 2052  ######  NO   T R
-00051740: 2041 204e 2053 2046 204f 2052 204d 2045   A N S F O R M E
-00051750: 2052 2020 204c 204f 2047 2049 2043 2020   R   L O G I C  
-00051760: 4220 4520 4720 4920 4e20 5320 2020 2048  B E G I N S    H
-00051770: 2045 2052 2045 2021 2023 2323 2323 2323   E R E ! #######
-00051780: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00051790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000517a0: 2323 2320 6966 2074 6865 7265 2069 7320  ### if there is 
-000517b0: 6e6f 2074 7261 6e73 666f 726d 6572 2c20  no transformer, 
-000517c0: 7468 656e 206c 6561 7665 2074 6865 2070  then leave the p
-000517d0: 7265 6469 6374 6564 2063 6c61 7373 6573  redicted classes
-000517e0: 2061 7320 6973 0d0a 2020 2020 2020 2020   as is..        
-000517f0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-00051800: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
-00051810: 685f 7461 7267 6574 5d5b 2763 6c61 7373  h_target]['class
-00051820: 6573 275d 0d0a 2020 2020 2020 2020 2020  es']..          
-00051830: 2020 2020 2020 2323 2323 2320 4966 2074        ##### If t
-00051840: 6865 7265 2069 7320 6e6f 2074 7261 6e73  here is no trans
-00051850: 666f 726d 6572 2c20 796f 7520 6361 6e20  former, you can 
-00051860: 6a75 7374 2070 7265 6469 6374 2074 6865  just predict the
-00051870: 2063 6c61 7373 6573 2061 7320 6973 2061   classes as is a
-00051880: 6e64 2073 6176 6520 6974 2068 6572 6520  nd save it here 
-00051890: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-000518a0: 2020 2020 2070 7265 6469 6374 5f63 6f6c       predict_col
-000518b0: 7320 3d20 6561 6368 5f74 6172 6765 742b  s = each_target+
-000518c0: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
-000518d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000518e0: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
-000518f0: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
-00051900: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00051910: 2020 2020 2020 2074 6573 746d 5b70 7265         testm[pre
-00051920: 6469 6374 5f63 6f6c 735d 203d 2079 5f70  dict_cols] = y_p
-00051930: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
-00051940: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00051950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051960: 7465 7374 6d5b 7072 6564 6963 745f 636f  testm[predict_co
-00051970: 6c73 5d20 3d20 795f 7072 6564 5b3a 2c69  ls] = y_pred[:,i
-00051980: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00051990: 2020 2023 2323 2323 2320 2049 6620 5374     ######  If St
-000519a0: 6163 6b69 6e67 5f46 6c61 6720 6973 2046  acking_Flag is F
-000519b0: 616c 7365 2c20 7468 656e 2077 6520 646f  alse, then we do
-000519c0: 2045 6e73 656d 626c 696e 6720 2323 2323   Ensembling ####
-000519d0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-000519e0: 2020 2020 2069 6620 6e6f 7420 5374 6163       if not Stac
-000519f0: 6b69 6e67 5f46 6c61 6720 616e 6420 6d6f  king_Flag and mo
-00051a00: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
-00051a10: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
-00051a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051a30: 2020 2323 2320 456e 7365 6d62 6c69 6e67    ### Ensembling
-00051a40: 2069 7320 6e6f 7420 646f 6e65 2077 6865   is not done whe
-00051a50: 6e20 7468 6520 6d6f 6465 6c20 6e61 6d65  n the model name
-00051a60: 2069 7320 4361 7442 6f6f 7374 2023 2323   is CatBoost ###
-00051a70: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00051a80: 2020 2020 2020 206e 6577 5f63 6f6c 7320         new_cols 
-00051a90: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
-00051aa0: 2020 2020 2020 2020 2020 7375 626d 203d            subm =
-00051ab0: 2070 642e 4461 7461 4672 616d 6528 290d   pd.DataFrame().
-00051ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051ad0: 2020 2020 2023 2323 2320 5468 6973 2069       #### This i
-00051ae0: 7320 666f 7220 456e 7365 6d62 6c69 6e67  s for Ensembling
-00051af0: 2020 4f6e 6c79 2023 2323 2323 0d0a 2020    Only #####..  
-00051b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051b10: 2020 2323 2323 2049 6e20 5465 7374 2064    #### In Test d
-00051b20: 6174 6120 7665 7262 6f73 6520 6973 2073  ata verbose is s
-00051b30: 6574 2074 6f20 7a65 726f 2073 696e 6365  et to zero since
-00051b40: 206e 6f20 7265 7375 6c74 7320 6361 6e20   no results can 
-00051b50: 6265 206f 6274 6169 6e65 6421 0d0a 2020  be obtained!..  
-00051b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051b70: 2020 6966 206c 656e 2863 6c61 7373 6573    if len(classes
-00051b80: 2920 3d3d 2032 3a0d 0a20 2020 2020 2020  ) == 2:..       
-00051b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ba0: 206d 6f64 656c 735f 6c69 7374 2c20 656e   models_list, en
-00051bb0: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
-00051bc0: 4c5f 456e 7365 6d62 6c69 6e67 2858 2c20  L_Ensembling(X, 
-00051bd0: 792c 2058 5f74 6573 742c 2027 272c 0d0a  y, X_test, '',..
-00051be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c10: 2020 6d6f 6465 6c74 7970 653d 2742 696e    modeltype='Bin
-00051c20: 6172 795f 436c 6173 7369 6669 6361 7469  ary_Classificati
-00051c30: 6f6e 272c 2042 6f6f 7374 696e 675f 466c  on', Boosting_Fl
-00051c40: 6167 3d42 6f6f 7374 696e 675f 466c 6167  ag=Boosting_Flag
-00051c50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00051c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c80: 2020 2020 2020 7363 6f72 696e 673d 2727        scoring=''
-00051c90: 2c20 7665 7262 6f73 653d 3029 0d0a 2020  , verbose=0)..  
-00051ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051cb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00051cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051cd0: 206d 6f64 656c 735f 6c69 7374 2c20 656e   models_list, en
-00051ce0: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
-00051cf0: 4c5f 456e 7365 6d62 6c69 6e67 2858 2c20  L_Ensembling(X, 
-00051d00: 792c 2058 5f74 6573 742c 2027 272c 0d0a  y, X_test, '',..
-00051d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051d40: 2020 6d6f 6465 6c74 7970 653d 274d 756c    modeltype='Mul
-00051d50: 7469 5f43 6c61 7373 6966 6963 6174 696f  ti_Classificatio
-00051d60: 6e27 2c20 426f 6f73 7469 6e67 5f46 6c61  n', Boosting_Fla
-00051d70: 673d 426f 6f73 7469 6e67 5f46 6c61 672c  g=Boosting_Flag,
-00051d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051db0: 2020 2020 2073 636f 7269 6e67 3d27 272c       scoring='',
-00051dc0: 2076 6572 626f 7365 3d30 290d 0a20 2020   verbose=0)..   
-00051dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051de0: 206d 6f64 656c 735f 6c69 7374 2e61 7070   models_list.app
-00051df0: 656e 6428 6d6f 6465 6c5f 6e61 6d65 290d  end(model_name).
-00051e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051e10: 2020 2020 2066 6f72 206d 6f64 656c 732c       for models,
-00051e20: 2065 6163 6820 696e 207a 6970 286d 6f64   each in zip(mod
-00051e30: 656c 735f 6c69 7374 2c20 7261 6e67 6528  els_list, range(
-00051e40: 6c65 6e28 6d6f 6465 6c73 5f6c 6973 7429  len(models_list)
-00051e50: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00051e60: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00051e70: 5f63 6f6c 203d 2065 6163 685f 7461 7267  _col = each_targ
-00051e80: 6574 2b27 5f27 2b6d 6f64 656c 732b 275f  et+'_'+models+'_
-00051e90: 7072 6564 6963 7469 6f6e 7327 0d0a 2020  predictions'..  
-00051ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051eb0: 2020 2020 2020 6966 2065 6163 682b 3120        if each+1 
-00051ec0: 3d3d 206c 656e 286d 6f64 656c 735f 6c69  == len(models_li
-00051ed0: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
-00051ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ef0: 2020 7375 626d 5b6e 6577 5f63 6f6c 5d20    subm[new_col] 
-00051f00: 3d20 795f 7072 6564 0d0a 2020 2020 2020  = y_pred..      
-00051f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051f20: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
-00051f30: 636f 6c5d 203d 2079 5f70 7265 640d 0a20  col] = y_pred.. 
+00050620: 2020 7072 696e 7428 2720 2020 2043 616c    print('    Cal
+00050630: 6375 6c61 7469 6e67 2077 6569 6768 7465  culating weighte
+00050640: 6420 6176 6572 6167 6520 656e 7365 6d62  d average ensemb
+00050650: 6c65 206f 6620 2564 2072 6567 7265 7373  le of %d regress
+00050660: 6f72 7327 2025 6c65 6e28 6e65 775f 636f  ors' %len(new_co
+00050670: 6c73 2929 0d0a 2020 2020 2020 2020 2020  ls))..          
+00050680: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
+00050690: 7072 6564 203d 2073 7562 6d5b 6e65 775f  pred = subm[new_
+000506a0: 636f 6c73 5b2d 315d 5d2a 302e 352b 302e  cols[-1]]*0.5+0.
+000506b0: 3132 352a 2873 7562 6d5b 6e65 775f 636f  125*(subm[new_co
+000506c0: 6c73 5b30 5d5d 2b73 7562 6d5b 0d0a 2020  ls[0]]+subm[..  
+000506d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000506e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000506f0: 2020 6e65 775f 636f 6c73 5b31 5d5d 2b73    new_cols[1]]+s
+00050700: 7562 6d5b 6e65 775f 636f 6c73 5b32 5d5d  ubm[new_cols[2]]
+00050710: 2b73 7562 6d5b 6e65 775f 636f 6c73 5b33  +subm[new_cols[3
+00050720: 5d5d 290d 0a20 2020 2020 2020 2020 2020  ]])..           
+00050730: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00050740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050750: 7072 696e 7428 2720 2020 2043 616c 6375  print('    Calcu
+00050760: 6c61 7469 6e67 2072 6567 756c 6172 2061  lating regular a
+00050770: 7665 7261 6765 2065 6e73 656d 626c 6520  verage ensemble 
+00050780: 6f66 2025 6420 7265 6772 6573 736f 7273  of %d regressors
+00050790: 2720 256c 656e 2863 6f6c 7329 290d 0a20  ' %len(cols)).. 
+000507a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000507b0: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
+000507c0: 2873 7562 6d5b 6e65 775f 636f 6c73 5d2e  (subm[new_cols].
+000507d0: 6d65 616e 2861 7869 733d 3129 290d 0a20  mean(axis=1)).. 
+000507e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000507f0: 2323 2323 2054 6869 7320 6e65 7874 2073  #### This next s
+00050800: 7465 7020 6973 2076 6572 7920 696d 706f  tep is very impo
+00050810: 7274 616e 7420 7369 6e63 6520 736f 6d65  rtant since some
+00050820: 206d 6f64 656c 7320 6769 7665 2073 6572   models give ser
+00050830: 6965 732c 206f 7468 6572 7320 6769 7665  ies, others give
+00050840: 2061 7272 6179 732e 2056 6572 7920 7061   arrays. Very pa
+00050850: 696e 6675 6c21 0d0a 2020 2020 2020 2020  inful!..        
+00050860: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00050870: 7461 6e63 6528 656e 7365 6d5f 7072 6564  tance(ensem_pred
+00050880: 2c70 642e 5365 7269 6573 2920 6f72 2069  ,pd.Series) or i
+00050890: 7369 6e73 7461 6e63 6528 656e 7365 6d5f  sinstance(ensem_
+000508a0: 7072 6564 2c70 642e 4461 7461 4672 616d  pred,pd.DataFram
+000508b0: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+000508c0: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
+000508d0: 7265 6420 3d20 656e 7365 6d5f 7072 6564  red = ensem_pred
+000508e0: 2e76 616c 7565 730d 0a20 2020 2020 2020  .values..       
+000508f0: 2020 2020 2020 2020 206e 6577 5f63 6f6c           new_col
+00050900: 203d 2065 6163 685f 7461 7267 6574 2b27   = each_target+'
+00050910: 5f45 6e73 656d 626c 6564 5f70 7265 6469  _Ensembled_predi
+00050920: 6374 696f 6e73 270d 0a20 2020 2020 2020  ctions'..       
+00050930: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
+00050940: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d5f  ew_col] = ensem_
+00050950: 7072 6564 0d0a 2020 2020 2020 2020 2020  pred..          
+00050960: 2020 2020 2020 6e65 775f 636f 6c73 2e61        new_cols.a
+00050970: 7070 656e 6428 6e65 775f 636f 6c29 0d0a  ppend(new_col)..
+00050980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050990: 7072 696e 7428 2743 6f6d 706c 6574 6564  print('Completed
+000509a0: 2045 6e73 656d 626c 6520 7072 6564 6963   Ensemble predic
+000509b0: 7469 6f6e 7320 6f6e 2068 656c 6420 6f75  tions on held ou
+000509c0: 7420 6461 7461 2729 0d0a 2020 2020 2020  t data')..      
+000509d0: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+000509e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000509f0: 7269 6e74 2827 436f 756c 6420 6e6f 7420  rint('Could not 
+00050a00: 636f 6d70 6c65 7465 2045 6e73 656d 626c  complete Ensembl
+00050a10: 696e 6720 7072 6564 6963 7469 6f6e 7320  ing predictions 
+00050a20: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
+00050a30: 2064 7565 2074 6f20 4572 726f 7227 290d   due to Error').
+00050a40: 0a20 2020 2020 2020 2065 6c69 6620 5374  .        elif St
+00050a50: 6163 6b69 6e67 5f46 6c61 6720 616e 6420  acking_Flag and 
+00050a60: 6e6f 7420 6d6f 6465 6c5f 6c61 6265 6c20  not model_label 
+00050a70: 3d3d 2027 4d75 6c74 695f 4c61 6265 6c27  == 'Multi_Label'
+00050a80: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00050a90: 7461 636b 5f63 6f6c 732c 2073 7461 636b  tack_cols, stack
+00050aa0: 7366 696e 616c 203d 2051 7569 636b 4d4c  sfinal = QuickML
+00050ab0: 5f53 7461 636b 696e 6728 582c 2079 2c20  _Stacking(X, y, 
+00050ac0: 585f 7465 7374 2c0d 0a20 2020 2020 2020  X_test,..       
+00050ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050ae0: 2020 206d 6f64 656c 7479 7065 2c20 426f     modeltype, Bo
+00050af0: 6f73 7469 6e67 5f46 6c61 672c 0d0a 2020  osting_Flag,..  
+00050b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050b10: 2020 2020 2020 2020 7363 6f72 696e 675f          scoring_
+00050b20: 7061 7261 6d65 7465 722c 7665 7262 6f73  parameter,verbos
+00050b30: 653d 7665 7262 6f73 6529 0d0a 2020 2020  e=verbose)..    
+00050b40: 2020 2020 2020 2020 6e65 775f 636f 6c20          new_col 
+00050b50: 3d20 6561 6368 5f74 6172 6765 742b 275f  = each_target+'_
+00050b60: 5374 6163 6b65 645f 272b 7374 6163 6b5f  Stacked_'+stack_
+00050b70: 636f 6c73 5b30 5d2e 7370 6c69 7428 225f  cols[0].split("_
+00050b80: 2229 5b30 5d2b 275f 7072 6564 6963 7469  ")[0]+'_predicti
+00050b90: 6f6e 7327 0d0a 2020 2020 2020 2020 2020  ons'..          
+00050ba0: 2020 6966 206c 656e 2873 7461 636b 5f63    if len(stack_c
+00050bb0: 6f6c 7329 203d 3d20 313a 0d0a 2020 2020  ols) == 1:..    
+00050bc0: 2020 2020 2020 2020 2020 2020 7465 7374              test
+00050bd0: 6d5b 6e65 775f 636f 6c5d 203d 2073 7461  m[new_col] = sta
+00050be0: 636b 7366 696e 616c 0d0a 2020 2020 2020  cksfinal..      
+00050bf0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00050c00: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00050c10: 2320 4a75 7374 2061 7665 7261 6765 2074  # Just average t
+00050c20: 6865 2070 7265 6469 6374 696f 6e73 2066  he predictions f
+00050c30: 726f 6d20 6561 6368 2073 7461 636b 6564  rom each stacked
+00050c40: 206d 6f64 656c 2069 6e74 6f20 6120 6669   model into a fi
+00050c50: 6e61 6c20 7072 6564 0d0a 2020 2020 2020  nal pred..      
+00050c60: 2020 2020 2020 2020 2020 7465 7374 6d5b            testm[
+00050c70: 6e65 775f 636f 6c5d 203d 2073 7461 636b  new_col] = stack
+00050c80: 7366 696e 616c 2e6d 6561 6e28 6178 6973  sfinal.mean(axis
+00050c90: 3d31 290d 0a20 2020 2020 2020 2023 2323  =1)..        ###
+00050ca0: 2323 2320 5468 6973 2061 7070 6c69 6573  ### This applies
+00050cb0: 2074 6f20 5369 6e67 6c65 5f4c 6162 656c   to Single_Label
+00050cc0: 2061 7320 7765 6c6c 2061 7320 4d75 6c74   as well as Mult
+00050cd0: 695f 4c61 6265 6c20 7072 6f62 6c65 6d73  i_Label problems
+00050ce0: 2023 2323 2323 2323 2323 230d 0a20 2020   ##########..   
+00050cf0: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
+00050d00: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
+00050d10: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
+00050d20: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00050d30: 7461 6e63 6528 7361 6d70 6c65 5f73 7562  tance(sample_sub
+00050d40: 6d69 7373 696f 6e2c 2073 7472 293a 0d0a  mission, str):..
+00050d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050d60: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00050d70: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00050d80: 5f73 7562 6d69 7373 696f 6e5b 6561 6368  _submission[each
+00050d90: 5f74 6172 6765 745d 203d 2079 5f70 7265  _target] = y_pre
+00050da0: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
+00050db0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+00050dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050dd0: 2323 2320 6966 2066 6f72 2073 6f6d 6520  ### if for some 
+00050de0: 7265 6173 6f6e 2c20 7468 6520 7361 6d70  reason, the samp
+00050df0: 6c65 2073 7562 6d69 7373 696f 6e20 6669  le submission fi
+00050e00: 6c65 2068 6173 2061 2064 6966 6665 7265  le has a differe
+00050e10: 6e74 2073 6861 7065 2074 6861 6e20 795f  nt shape than y_
+00050e20: 7072 6564 2c0d 0a20 2020 2020 2020 2020  pred,..         
+00050e30: 2020 2020 2020 2020 2020 2023 2323 2020             ###  
+00050e40: 7468 6973 206d 6179 2063 6175 7365 2061  this may cause a
+00050e50: 6e20 6572 726f 7220 616e 6420 796f 7520  n error and you 
+00050e60: 6361 6e20 6a75 7374 2073 6b69 7020 7468  can just skip th
+00050e70: 6174 2073 7465 7021 0d0a 2020 2020 2020  at step!..      
+00050e80: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00050e90: 696e 7428 2745 7272 6f72 3a20 5361 6d70  int('Error: Samp
+00050ea0: 6c65 2073 7562 6d69 7373 696f 6e20 6669  le submission fi
+00050eb0: 6c65 2069 7320 696e 636f 7272 6563 742e  le is incorrect.
+00050ec0: 2050 6c65 6173 6520 6368 6563 6b20 6974   Please check it
+00050ed0: 2e20 636f 6e74 696e 7569 6e67 2e2e 2e27  . continuing...'
+00050ee0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00050ef0: 2323 2320 4966 2074 6865 7265 2069 7320  ### If there is 
+00050f00: 6120 7465 7374 2066 696c 652c 2069 7420  a test file, it 
+00050f10: 7072 6f62 6162 6c79 2064 6f65 736e 2774  probably doesn't
+00050f20: 2068 6176 6520 7461 7267 6574 2c20 736f   have target, so
+00050f30: 2061 6464 2070 7265 6469 6374 696f 6e73   add predictions
+00050f40: 2074 6f20 6974 210d 0a20 2020 2020 2020   to it!..       
+00050f50: 2020 2020 2074 6573 746d 5b65 6163 685f       testm[each_
+00050f60: 7461 7267 6574 2b27 5f70 7265 6469 6374  target+'_predict
+00050f70: 696f 6e73 275d 203d 2079 5f70 7265 640d  ions'] = y_pred.
+00050f80: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00050f90: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00050fa0: 6f74 2069 7369 6e73 7461 6e63 6528 7361  ot isinstance(sa
+00050fb0: 6d70 6c65 5f73 7562 6d69 7373 696f 6e2c  mple_submission,
+00050fc0: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+00050fd0: 2020 2020 2020 2020 666f 7220 7072 6564          for pred
+00050fe0: 6963 745f 636f 6c2c 2069 2069 6e20 7a69  ict_col, i in zi
+00050ff0: 7028 7461 7267 6574 2c20 7261 6e67 6528  p(target, range(
+00051000: 6c65 6e28 7461 7267 6574 2929 293a 0d0a  len(target))):..
+00051010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051020: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+00051030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051040: 2020 7361 6d70 6c65 5f73 7562 6d69 7373    sample_submiss
+00051050: 696f 6e5b 7072 6564 6963 745f 636f 6c5d  ion[predict_col]
+00051060: 203d 2079 5f70 7265 645b 3a2c 695d 0d0a   = y_pred[:,i]..
+00051070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051080: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00051090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000510a0: 2020 2020 2023 2323 2069 6620 666f 7220       ### if for 
+000510b0: 736f 6d65 2072 6561 736f 6e2c 2074 6865  some reason, the
+000510c0: 2073 616d 706c 6520 7375 626d 6973 7369   sample submissi
+000510d0: 6f6e 2066 696c 6520 6861 7320 6120 6469  on file has a di
+000510e0: 6666 6572 656e 7420 7368 6170 6520 7468  fferent shape th
+000510f0: 616e 2079 5f70 7265 642c 0d0a 2020 2020  an y_pred,..    
+00051100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051110: 2020 2020 2323 2320 2074 6869 7320 6d61      ###  this ma
+00051120: 7920 6361 7573 6520 616e 2065 7272 6f72  y cause an error
+00051130: 2061 6e64 2079 6f75 2063 616e 206a 7573   and you can jus
+00051140: 7420 736b 6970 2074 6861 7420 7374 6570  t skip that step
+00051150: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+00051160: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00051170: 2827 4572 726f 723a 2053 616d 706c 6520  ('Error: Sample 
+00051180: 7375 626d 6973 7369 6f6e 2066 696c 6520  submission file 
+00051190: 6973 2069 6e63 6f72 7265 6374 2e20 506c  is incorrect. Pl
+000511a0: 6561 7365 2063 6865 636b 2069 742e 2063  ease check it. c
+000511b0: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
+000511c0: 2020 2020 2020 2020 2323 2323 2049 6620          #### If 
+000511d0: 7468 6572 6520 6973 2061 2074 6573 7420  there is a test 
+000511e0: 6669 6c65 2c20 6974 2070 726f 6261 626c  file, it probabl
+000511f0: 7920 646f 6573 6e27 7420 6861 7665 2074  y doesn't have t
+00051200: 6172 6765 742c 2073 6f20 6164 6420 7072  arget, so add pr
+00051210: 6564 6963 7469 6f6e 7320 746f 2069 7421  edictions to it!
+00051220: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00051230: 7220 7072 6564 6963 745f 636f 6c2c 2069  r predict_col, i
+00051240: 2069 6e20 7a69 7028 7461 7267 6574 2c20   in zip(target, 
+00051250: 7261 6e67 6528 6c65 6e28 7461 7267 6574  range(len(target
+00051260: 2929 293a 0d0a 2020 2020 2020 2020 2020  ))):..          
+00051270: 2020 2020 2020 7465 7374 6d5b 7072 6564        testm[pred
+00051280: 6963 745f 636f 6c2b 275f 7072 6564 6963  ict_col+'_predic
+00051290: 7469 6f6e 7327 5d20 3d20 795f 7072 6564  tions'] = y_pred
+000512a0: 5b3a 2c69 5d0d 0a20 2020 2065 6c73 653a  [:,i]..    else:
+000512b0: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+000512c0: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
+000512d0: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
+000512e0: 2020 2020 2020 2020 2023 2323 2320 4f6e           #### On
+000512f0: 6c79 2063 6572 7461 696e 206d 756c 7469  ly certain multi
+00051300: 2d6f 7574 7075 7420 636c 6173 7369 6669  -output classifi
+00051310: 6572 7320 7072 6f76 6964 6520 7072 6f62  ers provide prob
+00051320: 6173 2e20 466f 7220 6e6f 7720 4c69 6e65  as. For now Line
+00051330: 6172 5356 4320 6361 6e27 742e 2048 656e  arSVC can't. Hen
+00051340: 6365 2073 6b69 7020 7468 6973 2e2e 2e0d  ce skip this....
+00051350: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00051360: 6261 5f63 6f6c 7320 3d20 5b5d 0d0a 2020  ba_cols = []..  
+00051370: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00051380: 2323 2020 2054 6869 7320 6973 2066 6f72  ##   This is for
+00051390: 2062 6f74 6820 4269 6e61 7279 2061 6e64   both Binary and
+000513a0: 204d 756c 7469 2043 6c61 7373 6966 6963   Multi Classific
+000513b0: 6174 696f 6e20 5072 6f62 6c65 6d73 2023  ation Problems #
+000513c0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+000513d0: 2020 2020 2020 2020 795f 7072 6f62 6120          y_proba 
+000513e0: 3d20 6d6f 6465 6c2e 7072 6564 6963 745f  = model.predict_
+000513f0: 7072 6f62 6128 585f 7465 7374 290d 0a20  proba(X_test).. 
+00051400: 2020 2020 2020 2020 2020 2070 7265 6469             predi
+00051410: 6374 6564 203d 2063 6f70 792e 6465 6570  cted = copy.deep
+00051420: 636f 7079 2879 5f70 726f 6261 290d 0a20  copy(y_proba).. 
+00051430: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00051440: 6e28 636c 6173 7365 7329 203c 3d20 323a  n(classes) <= 2:
+00051450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00051460: 2020 7072 6564 6963 7465 6420 5b3a 2c30    predicted [:,0
+00051470: 5d20 3d20 2870 7265 6469 6374 6564 205b  ] = (predicted [
+00051480: 3a2c 305d 203e 3d20 2831 2d6d 5f74 6872  :,0] >= (1-m_thr
+00051490: 6573 6829 292e 6173 7479 7065 2827 696e  esh)).astype('in
+000514a0: 7427 290d 0a20 2020 2020 2020 2020 2020  t')..           
+000514b0: 2020 2020 2070 7265 6469 6374 6564 205b       predicted [
+000514c0: 3a2c 315d 203d 2028 7072 6564 6963 7465  :,1] = (predicte
+000514d0: 6420 5b3a 2c31 5d20 3e20 6d5f 7468 7265  d [:,1] > m_thre
+000514e0: 7368 292e 6173 7479 7065 2827 696e 7427  sh).astype('int'
+000514f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00051500: 2020 2069 6620 7072 6564 6963 7465 645b     if predicted[
+00051510: 3a2c 7261 7265 5f63 6c61 7373 5d2e 6d65  :,rare_class].me
+00051520: 616e 2829 3d3d 3020 6f72 2070 7265 6469  an()==0 or predi
+00051530: 6374 6564 5b3a 2c72 6172 655f 636c 6173  cted[:,rare_clas
+00051540: 735d 2e6d 6561 6e28 293d 3d31 3a0d 0a20  s].mean()==1:.. 
+00051550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051560: 2020 2023 2323 2049 6620 7468 6520 6d6f     ### If the mo
+00051570: 6465 6c20 6973 2070 7265 6469 6374 696e  del is predictin
+00051580: 6720 616c 6c20 3027 7320 6f72 2061 6c6c  g all 0's or all
+00051590: 2031 2773 2c20 796f 7520 6e65 6564 2074   1's, you need t
+000515a0: 6f20 7573 6520 6120 7265 6775 6c61 7220  o use a regular 
+000515b0: 7468 7265 7368 6f6c 640d 0a20 2020 2020  threshold..     
+000515c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000515d0: 5f74 6872 6573 6820 3d20 302e 350d 0a20  _thresh = 0.5.. 
+000515e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000515f0: 2020 2070 7269 6e74 2827 2020 2020 4d61     print('    Ma
+00051600: 6b69 6e67 2074 6573 7420 4461 7461 2070  king test Data p
+00051610: 7265 6469 6374 696f 6e73 2075 7369 6e67  redictions using
+00051620: 2072 6567 756c 6172 2054 6872 6573 686f   regular Thresho
+00051630: 6c64 203d 2025 302e 3366 2720 256d 5f74  ld = %0.3f' %m_t
+00051640: 6872 6573 6829 0d0a 2020 2020 2020 2020  hresh)..        
+00051650: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00051660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051670: 2020 2023 2323 2049 6620 7468 6520 6d6f     ### If the mo
+00051680: 6465 6c20 6973 2067 6f6f 6420 7769 7468  del is good with
+00051690: 2074 6865 206d 6f64 6966 6965 6420 7468   the modified th
+000516a0: 7265 7368 6f6c 642c 2074 6865 6e20 796f  reshold, then yo
+000516b0: 7520 7573 6520 7468 6520 6d6f 6469 6669  u use the modifi
+000516c0: 6564 2074 6872 6573 686f 6c64 210d 0a20  ed threshold!.. 
+000516d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000516e0: 2020 2070 7269 6e74 2827 2020 2020 4d61     print('    Ma
+000516f0: 6b69 6e67 2074 6573 7420 4461 7461 2070  king test Data p
+00051700: 7265 6469 6374 696f 6e73 2075 7369 6e67  redictions using
+00051710: 206d 6f64 6966 6965 6420 5468 7265 7368   modified Thresh
+00051720: 6f6c 6420 3d20 2530 2e33 6627 2025 6d5f  old = %0.3f' %m_
+00051730: 7468 7265 7368 290d 0a20 2020 2020 2020  thresh)..       
+00051740: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+00051750: 7265 6420 3d20 7072 6564 6963 7465 645b  red = predicted[
+00051760: 3a2c 7261 7265 5f63 6c61 7373 5d0d 0a20  :,rare_class].. 
+00051770: 2020 2020 2020 2020 2020 2023 2323 2059             ### Y
+00051780: 6f75 2077 696c 6c20 6e65 6564 2074 6f20  ou will need to 
+00051790: 6372 6561 7465 2070 726f 6261 6269 6c69  create probabili
+000517a0: 7469 6573 2066 6f72 2065 6163 6820 636c  ties for each cl
+000517b0: 6173 7320 6865 7265 2020 2323 2323 0d0a  ass here  ####..
+000517c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000517d0: 6561 6368 5f63 6c61 7373 2069 6e20 636c  each_class in cl
+000517e0: 6173 7365 733a 0d0a 2020 2020 2020 2020  asses:..        
+000517f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00051800: 7461 6e63 6528 6561 6368 5f63 6c61 7373  tance(each_class
+00051810: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00051820: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+00051830: 6261 5f63 6f6c 203d 2065 6163 685f 7461  ba_col = each_ta
+00051840: 7267 6574 2b27 5f70 726f 6261 5f27 2b65  rget+'_proba_'+e
+00051850: 6163 685f 636c 6173 730d 0a20 2020 2020  ach_class..     
+00051860: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00051870: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00051880: 2020 2020 2020 7072 6f62 615f 636f 6c20        proba_col 
+00051890: 3d20 6561 6368 5f74 6172 6765 742b 275f  = each_target+'_
+000518a0: 7072 6f62 615f 272b 7374 7228 6561 6368  proba_'+str(each
+000518b0: 5f63 6c61 7373 290d 0a20 2020 2020 2020  _class)..       
+000518c0: 2020 2020 2020 2020 2063 6f75 6e74 203d           count =
+000518d0: 2069 6e74 286c 6162 656c 5f64 6963 745b   int(label_dict[
+000518e0: 6561 6368 5f74 6172 6765 745d 5b27 6469  each_target]['di
+000518f0: 6374 696f 6e61 7279 275d 5b65 6163 685f  ctionary'][each_
+00051900: 636c 6173 735d 290d 0a20 2020 2020 2020  class])..       
+00051910: 2020 2020 2020 2020 2074 6573 746d 5b70           testm[p
+00051920: 726f 6261 5f63 6f6c 5d20 3d20 795f 7072  roba_col] = y_pr
+00051930: 6f62 615b 3a2c 636f 756e 745d 0d0a 2020  oba[:,count]..  
+00051940: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00051950: 6f62 615f 636f 6c73 2e61 7070 656e 6428  oba_cols.append(
+00051960: 7072 6f62 615f 636f 6c29 0d0a 2020 2020  proba_col)..    
+00051970: 2020 2020 2323 2323 2320 4e6f 7720 7461      ##### Now ta
+00051980: 6b65 2065 6163 6820 7461 7267 6574 2069  ke each target i
+00051990: 6e20 7468 6520 6c69 7374 206f 6620 7461  n the list of ta
+000519a0: 7267 6574 7320 616e 6420 6170 706c 7920  rgets and apply 
+000519b0: 7265 7665 7273 6520 7472 616e 7366 6f72  reverse transfor
+000519c0: 6d61 7469 6f6e 206f 6e20 7072 6564 6963  mation on predic
+000519d0: 7465 6420 6c61 6265 6c73 2023 2323 230d  ted labels ####.
+000519e0: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
+000519f0: 685f 7461 7267 6574 2c20 6920 696e 207a  h_target, i in z
+00051a00: 6970 2874 6172 6765 742c 2072 616e 6765  ip(target, range
+00051a10: 286c 656e 2874 6172 6765 7429 2929 3a0d  (len(target))):.
+00051a20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00051a30: 6c65 6e28 6c61 6265 6c5f 6469 6374 5b65  len(label_dict[e
+00051a40: 6163 685f 7461 7267 6574 5d5b 2774 7261  ach_target]['tra
+00051a50: 6e73 666f 726d 6572 275d 2920 3d3d 2030  nsformer']) == 0
+00051a60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00051a70: 2020 2023 2323 2323 2323 2323 2020 4e4f     #########  NO
+00051a80: 2020 2054 2052 2041 204e 2053 2046 204f     T R A N S F O
+00051a90: 2052 204d 2045 2052 2020 204c 204f 2047   R M E R   L O G
+00051aa0: 2049 2043 2020 4220 4520 4720 4920 4e20   I C  B E G I N 
+00051ab0: 5320 2020 2048 2045 2052 2045 2021 2023  S    H E R E ! #
+00051ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00051ad0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00051ae0: 2020 2020 2020 2323 2320 6966 2074 6865        ### if the
+00051af0: 7265 2069 7320 6e6f 2074 7261 6e73 666f  re is no transfo
+00051b00: 726d 6572 2c20 7468 656e 206c 6561 7665  rmer, then leave
+00051b10: 2074 6865 2070 7265 6469 6374 6564 2063   the predicted c
+00051b20: 6c61 7373 6573 2061 7320 6973 0d0a 2020  lasses as is..  
+00051b30: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00051b40: 6173 7365 7320 3d20 6c61 6265 6c5f 6469  asses = label_di
+00051b50: 6374 5b65 6163 685f 7461 7267 6574 5d5b  ct[each_target][
+00051b60: 2763 6c61 7373 6573 275d 0d0a 2020 2020  'classes']..    
+00051b70: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00051b80: 2320 4966 2074 6865 7265 2069 7320 6e6f  # If there is no
+00051b90: 2074 7261 6e73 666f 726d 6572 2c20 796f   transformer, yo
+00051ba0: 7520 6361 6e20 6a75 7374 2070 7265 6469  u can just predi
+00051bb0: 6374 2074 6865 2063 6c61 7373 6573 2061  ct the classes a
+00051bc0: 7320 6973 2061 6e64 2073 6176 6520 6974  s is and save it
+00051bd0: 2068 6572 6520 2323 230d 0a20 2020 2020   here ###..     
+00051be0: 2020 2020 2020 2020 2020 2070 7265 6469             predi
+00051bf0: 6374 5f63 6f6c 7320 3d20 6561 6368 5f74  ct_cols = each_t
+00051c00: 6172 6765 742b 275f 7072 6564 6963 7469  arget+'_predicti
+00051c10: 6f6e 7327 0d0a 2020 2020 2020 2020 2020  ons'..          
+00051c20: 2020 2020 2020 6966 206d 6f64 656c 5f6c        if model_l
+00051c30: 6162 656c 203d 3d20 2753 696e 676c 655f  abel == 'Single_
+00051c40: 4c61 6265 6c27 3a0d 0a20 2020 2020 2020  Label':..       
+00051c50: 2020 2020 2020 2020 2020 2020 2074 6573               tes
+00051c60: 746d 5b70 7265 6469 6374 5f63 6f6c 735d  tm[predict_cols]
+00051c70: 203d 2079 5f70 7265 640d 0a20 2020 2020   = y_pred..     
+00051c80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00051c90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00051ca0: 2020 2020 2020 7465 7374 6d5b 7072 6564        testm[pred
+00051cb0: 6963 745f 636f 6c73 5d20 3d20 795f 7072  ict_cols] = y_pr
+00051cc0: 6564 5b3a 2c69 5d0d 0a20 2020 2020 2020  ed[:,i]..       
+00051cd0: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+00051ce0: 2049 6620 5374 6163 6b69 6e67 5f46 6c61   If Stacking_Fla
+00051cf0: 6720 6973 2046 616c 7365 2c20 7468 656e  g is False, then
+00051d00: 2077 6520 646f 2045 6e73 656d 626c 696e   we do Ensemblin
+00051d10: 6720 2323 2323 2323 230d 0a20 2020 2020  g #######..     
+00051d20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00051d30: 7420 5374 6163 6b69 6e67 5f46 6c61 6720  t Stacking_Flag 
+00051d40: 616e 6420 6d6f 6465 6c5f 6c61 6265 6c20  and model_label 
+00051d50: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
+00051d60: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00051d70: 2020 2020 2020 2020 2323 2320 456e 7365          ### Ense
+00051d80: 6d62 6c69 6e67 2069 7320 6e6f 7420 646f  mbling is not do
+00051d90: 6e65 2077 6865 6e20 7468 6520 6d6f 6465  ne when the mode
+00051da0: 6c20 6e61 6d65 2069 7320 4361 7442 6f6f  l name is CatBoo
+00051db0: 7374 2023 2323 230d 0a20 2020 2020 2020  st ####..       
+00051dc0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00051dd0: 5f63 6f6c 7320 3d20 5b5d 0d0a 2020 2020  _cols = []..    
+00051de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051df0: 7375 626d 203d 2070 642e 4461 7461 4672  subm = pd.DataFr
+00051e00: 616d 6528 290d 0a20 2020 2020 2020 2020  ame()..         
+00051e10: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00051e20: 5468 6973 2069 7320 666f 7220 456e 7365  This is for Ense
+00051e30: 6d62 6c69 6e67 2020 4f6e 6c79 2023 2323  mbling  Only ###
+00051e40: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00051e50: 2020 2020 2020 2020 2323 2323 2049 6e20          #### In 
+00051e60: 5465 7374 2064 6174 6120 7665 7262 6f73  Test data verbos
+00051e70: 6520 6973 2073 6574 2074 6f20 7a65 726f  e is set to zero
+00051e80: 2073 696e 6365 206e 6f20 7265 7375 6c74   since no result
+00051e90: 7320 6361 6e20 6265 206f 6274 6169 6e65  s can be obtaine
+00051ea0: 6421 0d0a 2020 2020 2020 2020 2020 2020  d!..            
+00051eb0: 2020 2020 2020 2020 6966 206c 656e 2863          if len(c
+00051ec0: 6c61 7373 6573 2920 3d3d 2032 3a0d 0a20  lasses) == 2:.. 
+00051ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051ee0: 2020 2020 2020 206d 6f64 656c 735f 6c69         models_li
+00051ef0: 7374 2c20 656e 7365 6d62 6c65 7320 3d20  st, ensembles = 
+00051f00: 5175 6963 6b4d 4c5f 456e 7365 6d62 6c69  QuickML_Ensembli
+00051f10: 6e67 2858 2c20 792c 2058 5f74 6573 742c  ng(X, y, X_test,
+00051f20: 2027 272c 0d0a 2020 2020 2020 2020 2020   '',..          
+00051f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051f50: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00051f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051f70: 2020 2020 2020 2020 2020 7375 626d 5b6e            subm[n
-00051f80: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d62  ew_col] = ensemb
-00051f90: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
+00051f50: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+00051f60: 653d 2742 696e 6172 795f 436c 6173 7369  e='Binary_Classi
+00051f70: 6669 6361 7469 6f6e 272c 2042 6f6f 7374  fication', Boost
+00051f80: 696e 675f 466c 6167 3d42 6f6f 7374 696e  ing_Flag=Boostin
+00051f90: 675f 466c 6167 2c0d 0a20 2020 2020 2020  g_Flag,..       
 00051fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051fb0: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
-00051fc0: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d62  ew_col] = ensemb
-00051fd0: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
-00051fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ff0: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
-00052000: 7065 6e64 286e 6577 5f63 6f6c 290d 0a20  pend(new_col).. 
-00052010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052020: 2020 2023 2323 2323 2323 206e 6f77 2063     ####### now c
-00052030: 6f6d 6269 6e65 2074 6865 2070 7265 6469  ombine the predi
-00052040: 6374 696f 6e73 2069 6e74 6f20 6f6e 6520  ctions into one 
-00052050: 656e 7365 6d62 6c65 6420 7072 6564 6963  ensembled predic
-00052060: 7469 6f6e 2023 2323 2323 2323 0d0a 2020  tion #######..  
+00051fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051fc0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
+00051fd0: 696e 673d 2727 2c20 7665 7262 6f73 653d  ing='', verbose=
+00051fe0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+00051ff0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00052000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052010: 2020 2020 2020 206d 6f64 656c 735f 6c69         models_li
+00052020: 7374 2c20 656e 7365 6d62 6c65 7320 3d20  st, ensembles = 
+00052030: 5175 6963 6b4d 4c5f 456e 7365 6d62 6c69  QuickML_Ensembli
+00052040: 6e67 2858 2c20 792c 2058 5f74 6573 742c  ng(X, y, X_test,
+00052050: 2027 272c 0d0a 2020 2020 2020 2020 2020   '',..          
+00052060: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00052070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052080: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
-00052090: 5f74 6172 6765 742b 275f 456e 7365 6d62  _target+'_Ensemb
-000520a0: 6c65 645f 7072 6564 6963 7469 6f6e 7327  led_predictions'
-000520b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000520c0: 2020 2020 2020 6966 206c 656e 286e 6577        if len(new
-000520d0: 5f63 6f6c 7329 203d 3d20 353a 0d0a 2020  _cols) == 5:..  
+00052080: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+00052090: 653d 274d 756c 7469 5f43 6c61 7373 6966  e='Multi_Classif
+000520a0: 6963 6174 696f 6e27 2c20 426f 6f73 7469  ication', Boosti
+000520b0: 6e67 5f46 6c61 673d 426f 6f73 7469 6e67  ng_Flag=Boosting
+000520c0: 5f46 6c61 672c 0d0a 2020 2020 2020 2020  _Flag,..        
+000520d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000520e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000520f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00052100: 2043 616c 6375 6c61 7469 6e67 2077 6569   Calculating wei
-00052110: 6768 7465 6420 6176 6572 6167 6520 656e  ghted average en
-00052120: 7365 6d62 6c65 206f 6620 2564 2063 6c61  semble of %d cla
-00052130: 7373 6966 6965 7273 2720 256c 656e 286e  ssifiers' %len(n
-00052140: 6577 5f63 6f6c 7329 290d 0a20 2020 2020  ew_cols))..     
-00052150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052160: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
-00052170: 6e70 2e72 6f75 6e64 2873 7562 6d5b 6e65  np.round(subm[ne
-00052180: 775f 636f 6c73 5b2d 315d 5d2a 302e 352b  w_cols[-1]]*0.5+
-00052190: 302e 3132 352a 2873 7562 6d5b 6e65 775f  0.125*(subm[new_
-000521a0: 636f 6c73 5b30 5d5d 2b73 7562 6d5b 0d0a  cols[0]]+subm[..
-000521b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000521c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000521d0: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
-000521e0: 5b31 5d5d 2b73 7562 6d5b 6e65 775f 636f  [1]]+subm[new_co
-000521f0: 6c73 5b32 5d5d 2b73 7562 6d5b 6e65 775f  ls[2]]+subm[new_
-00052200: 636f 6c73 5b33 5d5d 2929 2e61 7374 7970  cols[3]])).astyp
-00052210: 6528 696e 7429 0d0a 2020 2020 2020 2020  e(int)..        
-00052220: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00052230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00052240: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00052250: 2827 2020 2020 4361 6c63 756c 6174 696e  ('    Calculatin
-00052260: 6720 6176 6572 6167 6520 656e 7365 6d62  g average ensemb
-00052270: 6c65 206f 6620 2564 2063 6c61 7373 6966  le of %d classif
-00052280: 6965 7273 2720 256c 656e 286e 6577 5f63  iers' %len(new_c
-00052290: 6f6c 7329 290d 0a20 2020 2020 2020 2020  ols))..         
-000522a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000522b0: 6e73 656d 5f70 7265 6420 3d20 2873 7562  nsem_pred = (sub
-000522c0: 6d5b 6e65 775f 636f 6c73 5d2e 6d65 616e  m[new_cols].mean
-000522d0: 2861 7869 733d 3129 292e 6173 7479 7065  (axis=1)).astype
-000522e0: 2869 6e74 290d 0a20 2020 2020 2020 2020  (int)..         
-000522f0: 2020 2020 2020 2065 6c69 6620 5374 6163         elif Stac
-00052300: 6b69 6e67 5f46 6c61 6720 616e 6420 6d6f  king_Flag and mo
-00052310: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
-00052320: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
-00052330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052340: 2020 7374 6163 6b5f 636f 6c73 2c20 7374    stack_cols, st
-00052350: 6163 6b73 6669 6e61 6c20 3d20 5175 6963  acksfinal = Quic
-00052360: 6b4d 4c5f 5374 6163 6b69 6e67 2858 2c20  kML_Stacking(X, 
-00052370: 792c 2058 5f74 6573 742c 0d0a 2020 2020  y, X_test,..    
-00052380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000523a0: 2020 206d 6f64 656c 7479 7065 2c20 426f     modeltype, Bo
-000523b0: 6f73 7469 6e67 5f46 6c61 672c 7363 6f72  osting_Flag,scor
-000523c0: 696e 675f 7061 7261 6d65 7465 722c 7665  ing_parameter,ve
-000523d0: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
-000523e0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-000523f0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
-00052400: 742b 275f 5374 6163 6b65 645f 272b 7374  t+'_Stacked_'+st
-00052410: 6163 6b5f 636f 6c73 5b30 5d2e 7370 6c69  ack_cols[0].spli
-00052420: 7428 225f 2229 5b30 5d2b 275f 7072 6564  t("_")[0]+'_pred
-00052430: 6963 7469 6f6e 7327 0d0a 2020 2020 2020  ictions'..      
-00052440: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00052450: 7365 6d5f 7072 6564 203d 206e 702e 6172  sem_pred = np.ar
-00052460: 676d 6178 2873 7461 636b 7366 696e 616c  gmax(stacksfinal
-00052470: 2c61 7869 733d 3129 0d0a 2020 2020 2020  ,axis=1)..      
-00052480: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00052490: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
-000524a0: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
-000524b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000524c0: 2023 2323 2323 2054 6869 7320 6e65 7874   ##### This next
-000524d0: 2073 7465 7020 6973 2076 6572 7920 696d   step is very im
-000524e0: 706f 7274 616e 7420 7369 6e63 6520 736f  portant since so
-000524f0: 6d65 206d 6f64 656c 7320 6769 7665 2073  me models give s
-00052500: 6572 6965 732c 206f 7468 6572 7320 6769  eries, others gi
-00052510: 7665 2061 7272 6179 732e 2056 6572 7920  ve arrays. Very 
-00052520: 7061 696e 6675 6c21 0d0a 2020 2020 2020  painful!..      
-00052530: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00052540: 2069 7369 6e73 7461 6e63 6528 656e 7365   isinstance(ense
-00052550: 6d5f 7072 6564 2c70 642e 5365 7269 6573  m_pred,pd.Series
-00052560: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00052570: 2020 2020 2020 2020 2020 2020 656e 7365              ense
-00052580: 6d5f 7072 6564 203d 2065 6e73 656d 5f70  m_pred = ensem_p
-00052590: 7265 642e 7661 6c75 6573 0d0a 2020 2020  red.values..    
-000525a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000525b0: 7465 7374 6d5b 6e65 775f 636f 6c5d 203d  testm[new_col] =
-000525c0: 2065 6e73 656d 5f70 7265 640d 0a20 2020   ensem_pred..   
-000525d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000525e0: 206e 6577 5f63 6f6c 732e 6170 7065 6e64   new_cols.append
-000525f0: 286e 6577 5f63 6f6c 290d 0a20 2020 2020  (new_col)..     
-00052600: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00052610: 7420 6973 696e 7374 616e 6365 2873 616d  t isinstance(sam
-00052620: 706c 655f 7375 626d 6973 7369 6f6e 2c20  ple_submission, 
-00052630: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-00052640: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
-00052650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00052660: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-00052670: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00052680: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-00052690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000526a0: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
-000526b0: 7562 6d69 7373 696f 6e5b 6561 6368 5f74  ubmission[each_t
-000526c0: 6172 6765 745d 203d 2079 5f70 7265 640d  arget] = y_pred.
-000526d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000526e0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-000526f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052700: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-00052710: 6c65 5f73 7562 6d69 7373 696f 6e5b 6561  le_submission[ea
-00052720: 6368 5f74 6172 6765 745d 203d 2079 5f70  ch_target] = y_p
-00052730: 7265 645b 3a2c 695d 0d0a 2020 2020 2020  red[:,i]..      
-00052740: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00052750: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00052760: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00052770: 7269 6e74 2827 4572 726f 723a 2053 616d  rint('Error: Sam
-00052780: 706c 6520 7375 626d 6973 7369 6f6e 2066  ple submission f
-00052790: 696c 6520 6973 2069 6e63 6f72 7265 6374  ile is incorrect
-000527a0: 2e20 506c 6561 7365 2063 6865 636b 2069  . Please check i
-000527b0: 742e 2063 6f6e 7469 6e75 696e 672e 2e2e  t. continuing...
-000527c0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-000527d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000527e0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-000527f0: 2020 2020 5420 5220 4120 4e20 5320 4620      T R A N S F 
-00052800: 4f20 5220 4d20 4520 5220 2020 4c20 4f20  O R M E R   L O 
-00052810: 4720 4920 4320 2042 2045 2047 2049 204e  G I C  B E G I N
-00052820: 2053 2020 2020 4820 4520 5220 4520 2120   S    H E R E ! 
-00052830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052840: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-00052850: 2020 2020 2020 2023 2323 2069 6620 7468         ### if th
-00052860: 6572 6520 6973 2061 2074 7261 6e73 666f  ere is a transfo
-00052870: 726d 6572 2c20 7468 656e 2079 6f75 206d  rmer, then you m
-00052880: 7573 7420 636f 6e76 6572 7420 7468 6520  ust convert the 
-00052890: 7072 6564 6963 7465 6420 636c 6173 7365  predicted classe
-000528a0: 7320 746f 206f 7269 6720 636c 6173 7365  s to orig classe
-000528b0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-000528c0: 2020 2063 6c61 7373 6573 203d 206c 6162     classes = lab
-000528d0: 656c 5f64 6963 745b 6561 6368 5f74 6172  el_dict[each_tar
-000528e0: 6765 745d 5b27 636c 6173 7365 7327 5d0d  get]['classes'].
-000528f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00052900: 2064 6963 203d 206c 6162 656c 5f64 6963   dic = label_dic
-00052910: 745b 6561 6368 5f74 6172 6765 745d 5b27  t[each_target]['
-00052920: 6469 6374 696f 6e61 7279 275d 0d0a 2020  dictionary']..  
-00052930: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00052940: 616e 7366 6f72 6d65 7220 3d20 6c61 6265  ansformer = labe
-00052950: 6c5f 6469 6374 5b65 6163 685f 7461 7267  l_dict[each_targ
-00052960: 6574 5d5b 2774 7261 6e73 666f 726d 6572  et]['transformer
-00052970: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-00052980: 2020 2020 636c 6173 735f 6e75 6d73 203d      class_nums =
-00052990: 206c 6162 656c 5f64 6963 745b 6561 6368   label_dict[each
-000529a0: 5f74 6172 6765 745d 5b27 636c 6173 735f  _target]['class_
-000529b0: 6e75 6d73 275d 0d0a 2020 2020 2020 2020  nums']..        
-000529c0: 2020 2020 2020 2020 2323 2323 2320 4966          ##### If
-000529d0: 2074 6865 7265 2069 7320 6120 7472 616e   there is a tran
-000529e0: 7366 6f72 6d65 722c 2079 6f75 206d 7573  sformer, you mus
-000529f0: 7420 636f 6e76 6572 7420 7072 6564 6963  t convert predic
-00052a00: 7469 6f6e 7320 746f 206f 7269 6769 6e61  tions to origina
-00052a10: 6c20 636c 6173 7365 730d 0a20 2020 2020  l classes..     
-00052a20: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
-00052a30: 6e20 736f 6d65 2063 6173 6573 2073 7563  n some cases suc
-00052a40: 6820 6173 2043 6174 426f 6f73 742c 2074  h as CatBoost, t
-00052a50: 6865 206f 7574 7075 7420 666f 7220 6d75  he output for mu
-00052a60: 6c74 692d 636c 6173 7320 6973 2032 2d44  lti-class is 2-D
-00052a70: 2077 6974 6820 7368 6170 6520 282c 3129   with shape (,1)
-00052a80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00052a90: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00052aa0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00052ab0: 7274 2079 5f70 7265 642e 7368 6170 655b  rt y_pred.shape[
-00052ac0: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00052ad0: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
-00052ae0: 2079 5f70 7265 642e 7261 7665 6c28 290d   y_pred.ravel().
-00052af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00052b00: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00052b10: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00052b20: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
-00052b30: 2020 2020 2323 2323 2323 204f 6e63 6520      ###### Once 
-00052b40: 796f 7520 6765 7420 7468 6520 6162 6f76  you get the abov
-00052b50: 6520 7269 6768 742c 2079 6f75 2063 616e  e right, you can
-00052b60: 2064 6f20 7468 6520 7265 7374 2065 6173   do the rest eas
-00052b70: 7920 2323 2323 2323 0d0a 2020 2020 2020  y ######..      
-00052b80: 2020 2020 2020 2020 2020 7465 7374 6d5b            testm[
-00052b90: 6561 6368 5f74 6172 6765 742b 275f 7072  each_target+'_pr
-00052ba0: 6564 6963 7469 6f6e 7327 5d20 3d20 7064  edictions'] = pd
-00052bb0: 2e53 6572 6965 7328 795f 7072 6564 292e  .Series(y_pred).
-00052bc0: 6d61 7028 7472 616e 7366 6f72 6d65 7229  map(transformer)
-00052bd0: 2e76 616c 7565 730d 0a20 2020 2020 2020  .values..       
-00052be0: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
-00052bf0: 685f 636c 6173 7320 696e 2063 6c61 7373  h_class in class
-00052c00: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-00052c10: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00052c20: 7374 616e 6365 2865 6163 685f 636c 6173  stance(each_clas
-00052c30: 732c 2073 7472 293a 0d0a 2020 2020 2020  s, str):..      
-00052c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052c50: 2020 7072 6f62 615f 636f 6c20 3d20 6561    proba_col = ea
-00052c60: 6368 5f74 6172 6765 742b 275f 7072 6f62  ch_target+'_prob
-00052c70: 615f 272b 6561 6368 5f63 6c61 7373 0d0a  a_'+each_class..
-00052c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052c90: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00052ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052cb0: 2020 2070 726f 6261 5f63 6f6c 203d 2065     proba_col = e
-00052cc0: 6163 685f 7461 7267 6574 2b27 5f70 726f  ach_target+'_pro
-00052cd0: 6261 5f27 2b73 7472 2865 6163 685f 636c  ba_'+str(each_cl
-00052ce0: 6173 7329 0d0a 2020 2020 2020 2020 2020  ass)..          
-00052cf0: 2020 2020 2020 2020 2020 636f 756e 7420            count 
-00052d00: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
-00052d10: 685f 7461 7267 6574 5d5b 2764 6963 7469  h_target]['dicti
-00052d20: 6f6e 6172 7927 5d5b 6561 6368 5f63 6c61  onary'][each_cla
-00052d30: 7373 5d0d 0a20 2020 2020 2020 2020 2020  ss]..           
-00052d40: 2020 2020 2020 2020 2074 6573 746d 5b70           testm[p
-00052d50: 726f 6261 5f63 6f6c 5d20 3d20 795f 7072  roba_col] = y_pr
-00052d60: 6f62 615b 3a2c 636f 756e 745d 0d0a 2020  oba[:,count]..  
-00052d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052d80: 2020 7072 6f62 615f 636f 6c73 2e61 7070    proba_cols.app
-00052d90: 656e 6428 7072 6f62 615f 636f 6c29 0d0a  end(proba_col)..
-00052da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052db0: 2323 2323 2323 2020 4966 2053 7461 636b  ######  If Stack
-00052dc0: 696e 675f 2046 6c61 6720 6973 2046 616c  ing_ Flag is Fal
-00052dd0: 7365 2c20 7468 656e 2077 6520 646f 2045  se, then we do E
-00052de0: 6e73 656d 626c 696e 6720 2323 2323 2323  nsembling ######
-00052df0: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00052e00: 2020 2069 6620 6e6f 7420 5374 6163 6b69     if not Stacki
-00052e10: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
-00052e20: 2020 2020 2020 2020 2020 2020 2020 7375                su
-00052e30: 626d 203d 2070 642e 4461 7461 4672 616d  bm = pd.DataFram
-00052e40: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00052e50: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
-00052e60: 6973 2069 7320 666f 7220 456e 7365 6d62  is is for Ensemb
-00052e70: 6c69 6e67 2020 4f6e 6c79 2023 2323 2323  ling  Only #####
-00052e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00052e90: 2020 2020 2020 6966 206c 656e 2863 6c61        if len(cla
-00052ea0: 7373 6573 2920 3d3d 2032 3a0d 0a20 2020  sses) == 2:..   
-00052eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052ec0: 2020 2020 206d 6f64 656c 735f 6c69 7374       models_list
-00052ed0: 2c20 656e 7365 6d62 6c65 7320 3d20 5175  , ensembles = Qu
-00052ee0: 6963 6b4d 4c5f 456e 7365 6d62 6c69 6e67  ickML_Ensembling
-00052ef0: 2858 2c20 792c 2058 5f74 6573 742c 2027  (X, y, X_test, '
-00052f00: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-00052f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052f30: 2020 2020 2020 6d6f 6465 6c74 7970 653d        modeltype=
-00052f40: 2742 696e 6172 795f 436c 6173 7369 6669  'Binary_Classifi
-00052f50: 6361 7469 6f6e 272c 2042 6f6f 7374 696e  cation', Boostin
-00052f60: 675f 466c 6167 3d42 6f6f 7374 696e 675f  g_Flag=Boosting_
-00052f70: 466c 6167 2c0d 0a20 2020 2020 2020 2020  Flag,..         
+000520f0: 2020 2020 2020 2020 2020 2073 636f 7269             scori
+00052100: 6e67 3d27 272c 2076 6572 626f 7365 3d30  ng='', verbose=0
+00052110: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00052120: 2020 2020 2020 206d 6f64 656c 735f 6c69         models_li
+00052130: 7374 2e61 7070 656e 6428 6d6f 6465 6c5f  st.append(model_
+00052140: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+00052150: 2020 2020 2020 2020 2020 2066 6f72 206d             for m
+00052160: 6f64 656c 732c 2065 6163 6820 696e 207a  odels, each in z
+00052170: 6970 286d 6f64 656c 735f 6c69 7374 2c20  ip(models_list, 
+00052180: 7261 6e67 6528 6c65 6e28 6d6f 6465 6c73  range(len(models
+00052190: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
+000521a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000521b0: 2020 206e 6577 5f63 6f6c 203d 2065 6163     new_col = eac
+000521c0: 685f 7461 7267 6574 2b27 5f27 2b6d 6f64  h_target+'_'+mod
+000521d0: 656c 732b 275f 7072 6564 6963 7469 6f6e  els+'_prediction
+000521e0: 7327 0d0a 2020 2020 2020 2020 2020 2020  s'..            
+000521f0: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+00052200: 6163 682b 3120 3d3d 206c 656e 286d 6f64  ach+1 == len(mod
+00052210: 656c 735f 6c69 7374 293a 0d0a 2020 2020  els_list):..    
+00052220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052230: 2020 2020 2020 2020 7375 626d 5b6e 6577          subm[new
+00052240: 5f63 6f6c 5d20 3d20 795f 7072 6564 0d0a  _col] = y_pred..
+00052250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052260: 2020 2020 2020 2020 2020 2020 7465 7374              test
+00052270: 6d5b 6e65 775f 636f 6c5d 203d 2079 5f70  m[new_col] = y_p
+00052280: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
+00052290: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000522a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000522b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000522c0: 7375 626d 5b6e 6577 5f63 6f6c 5d20 3d20  subm[new_col] = 
+000522d0: 656e 7365 6d62 6c65 735b 3a2c 6561 6368  ensembles[:,each
+000522e0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000522f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00052300: 6573 746d 5b6e 6577 5f63 6f6c 5d20 3d20  estm[new_col] = 
+00052310: 656e 7365 6d62 6c65 735b 3a2c 6561 6368  ensembles[:,each
+00052320: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00052330: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+00052340: 6f6c 732e 6170 7065 6e64 286e 6577 5f63  ols.append(new_c
+00052350: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
+00052360: 2020 2020 2020 2020 2023 2323 2323 2323           #######
+00052370: 206e 6f77 2063 6f6d 6269 6e65 2074 6865   now combine the
+00052380: 2070 7265 6469 6374 696f 6e73 2069 6e74   predictions int
+00052390: 6f20 6f6e 6520 656e 7365 6d62 6c65 6420  o one ensembled 
+000523a0: 7072 6564 6963 7469 6f6e 2023 2323 2323  prediction #####
+000523b0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+000523c0: 2020 2020 2020 2020 6e65 775f 636f 6c20          new_col 
+000523d0: 3d20 6561 6368 5f74 6172 6765 742b 275f  = each_target+'_
+000523e0: 456e 7365 6d62 6c65 645f 7072 6564 6963  Ensembled_predic
+000523f0: 7469 6f6e 7327 0d0a 2020 2020 2020 2020  tions'..        
+00052400: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00052410: 656e 286e 6577 5f63 6f6c 7329 203d 3d20  en(new_cols) == 
+00052420: 353a 0d0a 2020 2020 2020 2020 2020 2020  5:..            
+00052430: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00052440: 7428 2720 2020 2043 616c 6375 6c61 7469  t('    Calculati
+00052450: 6e67 2077 6569 6768 7465 6420 6176 6572  ng weighted aver
+00052460: 6167 6520 656e 7365 6d62 6c65 206f 6620  age ensemble of 
+00052470: 2564 2063 6c61 7373 6966 6965 7273 2720  %d classifiers' 
+00052480: 256c 656e 286e 6577 5f63 6f6c 7329 290d  %len(new_cols)).
+00052490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000524a0: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
+000524b0: 7265 6420 3d20 6e70 2e72 6f75 6e64 2873  red = np.round(s
+000524c0: 7562 6d5b 6e65 775f 636f 6c73 5b2d 315d  ubm[new_cols[-1]
+000524d0: 5d2a 302e 352b 302e 3132 352a 2873 7562  ]*0.5+0.125*(sub
+000524e0: 6d5b 6e65 775f 636f 6c73 5b30 5d5d 2b73  m[new_cols[0]]+s
+000524f0: 7562 6d5b 0d0a 2020 2020 2020 2020 2020  ubm[..          
+00052500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052510: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00052520: 775f 636f 6c73 5b31 5d5d 2b73 7562 6d5b  w_cols[1]]+subm[
+00052530: 6e65 775f 636f 6c73 5b32 5d5d 2b73 7562  new_cols[2]]+sub
+00052540: 6d5b 6e65 775f 636f 6c73 5b33 5d5d 2929  m[new_cols[3]]))
+00052550: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+00052560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052570: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00052580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052590: 2070 7269 6e74 2827 2020 2020 4361 6c63   print('    Calc
+000525a0: 756c 6174 696e 6720 6176 6572 6167 6520  ulating average 
+000525b0: 656e 7365 6d62 6c65 206f 6620 2564 2063  ensemble of %d c
+000525c0: 6c61 7373 6966 6965 7273 2720 256c 656e  lassifiers' %len
+000525d0: 286e 6577 5f63 6f6c 7329 290d 0a20 2020  (new_cols))..   
+000525e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000525f0: 2020 2020 2065 6e73 656d 5f70 7265 6420       ensem_pred 
+00052600: 3d20 2873 7562 6d5b 6e65 775f 636f 6c73  = (subm[new_cols
+00052610: 5d2e 6d65 616e 2861 7869 733d 3129 292e  ].mean(axis=1)).
+00052620: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00052630: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00052640: 6620 5374 6163 6b69 6e67 5f46 6c61 6720  f Stacking_Flag 
+00052650: 616e 6420 6d6f 6465 6c5f 6c61 6265 6c20  and model_label 
+00052660: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
+00052670: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00052680: 2020 2020 2020 2020 7374 6163 6b5f 636f          stack_co
+00052690: 6c73 2c20 7374 6163 6b73 6669 6e61 6c20  ls, stacksfinal 
+000526a0: 3d20 5175 6963 6b4d 4c5f 5374 6163 6b69  = QuickML_Stacki
+000526b0: 6e67 2858 2c20 792c 2058 5f74 6573 742c  ng(X, y, X_test,
+000526c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000526d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000526e0: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
+000526f0: 7065 2c20 426f 6f73 7469 6e67 5f46 6c61  pe, Boosting_Fla
+00052700: 672c 7363 6f72 696e 675f 7061 7261 6d65  g,scoring_parame
+00052710: 7465 722c 7665 7262 6f73 6529 0d0a 2020  ter,verbose)..  
+00052720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052730: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
+00052740: 5f74 6172 6765 742b 275f 5374 6163 6b65  _target+'_Stacke
+00052750: 645f 272b 7374 6163 6b5f 636f 6c73 5b30  d_'+stack_cols[0
+00052760: 5d2e 7370 6c69 7428 225f 2229 5b30 5d2b  ].split("_")[0]+
+00052770: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
+00052780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052790: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
+000527a0: 206e 702e 6172 676d 6178 2873 7461 636b   np.argmax(stack
+000527b0: 7366 696e 616c 2c61 7869 733d 3129 0d0a  sfinal,axis=1)..
+000527c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000527d0: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
+000527e0: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
+000527f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00052800: 2020 2020 2020 2023 2323 2323 2054 6869         ##### Thi
+00052810: 7320 6e65 7874 2073 7465 7020 6973 2076  s next step is v
+00052820: 6572 7920 696d 706f 7274 616e 7420 7369  ery important si
+00052830: 6e63 6520 736f 6d65 206d 6f64 656c 7320  nce some models 
+00052840: 6769 7665 2073 6572 6965 732c 206f 7468  give series, oth
+00052850: 6572 7320 6769 7665 2061 7272 6179 732e  ers give arrays.
+00052860: 2056 6572 7920 7061 696e 6675 6c21 0d0a   Very painful!..
+00052870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052880: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00052890: 6528 656e 7365 6d5f 7072 6564 2c70 642e  e(ensem_pred,pd.
+000528a0: 5365 7269 6573 293a 0d0a 2020 2020 2020  Series):..      
+000528b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000528c0: 2020 656e 7365 6d5f 7072 6564 203d 2065    ensem_pred = e
+000528d0: 6e73 656d 5f70 7265 642e 7661 6c75 6573  nsem_pred.values
+000528e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000528f0: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
+00052900: 636f 6c5d 203d 2065 6e73 656d 5f70 7265  col] = ensem_pre
+00052910: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
+00052920: 2020 2020 2020 206e 6577 5f63 6f6c 732e         new_cols.
+00052930: 6170 7065 6e64 286e 6577 5f63 6f6c 290d  append(new_col).
+00052940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052950: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00052960: 6365 2873 616d 706c 655f 7375 626d 6973  ce(sample_submis
+00052970: 7369 6f6e 2c20 7374 7229 3a0d 0a20 2020  sion, str):..   
+00052980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052990: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+000529a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000529b0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
+000529c0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
+000529d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000529e0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+000529f0: 6d70 6c65 5f73 7562 6d69 7373 696f 6e5b  mple_submission[
+00052a00: 6561 6368 5f74 6172 6765 745d 203d 2079  each_target] = y
+00052a10: 5f70 7265 640d 0a20 2020 2020 2020 2020  _pred..         
+00052a20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00052a30: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00052a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052a50: 2020 7361 6d70 6c65 5f73 7562 6d69 7373    sample_submiss
+00052a60: 696f 6e5b 6561 6368 5f74 6172 6765 745d  ion[each_target]
+00052a70: 203d 2079 5f70 7265 645b 3a2c 695d 0d0a   = y_pred[:,i]..
+00052a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052a90: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00052aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052ab0: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
+00052ac0: 723a 2053 616d 706c 6520 7375 626d 6973  r: Sample submis
+00052ad0: 7369 6f6e 2066 696c 6520 6973 2069 6e63  sion file is inc
+00052ae0: 6f72 7265 6374 2e20 506c 6561 7365 2063  orrect. Please c
+00052af0: 6865 636b 2069 742e 2063 6f6e 7469 6e75  heck it. continu
+00052b00: 696e 672e 2e2e 2729 0d0a 2020 2020 2020  ing...')..      
+00052b10: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00052b20: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00052b30: 2323 2323 2323 2020 2020 5420 5220 4120  ######    T R A 
+00052b40: 4e20 5320 4620 4f20 5220 4d20 4520 5220  N S F O R M E R 
+00052b50: 2020 4c20 4f20 4720 4920 4320 2042 2045    L O G I C  B E
+00052b60: 2047 2049 204e 2053 2020 2020 4820 4520   G I N S    H E 
+00052b70: 5220 4520 2120 2323 2323 2323 2323 2323  R E ! ##########
+00052b80: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00052b90: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00052ba0: 2069 6620 7468 6572 6520 6973 2061 2074   if there is a t
+00052bb0: 7261 6e73 666f 726d 6572 2c20 7468 656e  ransformer, then
+00052bc0: 2079 6f75 206d 7573 7420 636f 6e76 6572   you must conver
+00052bd0: 7420 7468 6520 7072 6564 6963 7465 6420  t the predicted 
+00052be0: 636c 6173 7365 7320 746f 206f 7269 6720  classes to orig 
+00052bf0: 636c 6173 7365 730d 0a20 2020 2020 2020  classes..       
+00052c00: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
+00052c10: 203d 206c 6162 656c 5f64 6963 745b 6561   = label_dict[ea
+00052c20: 6368 5f74 6172 6765 745d 5b27 636c 6173  ch_target]['clas
+00052c30: 7365 7327 5d0d 0a20 2020 2020 2020 2020  ses']..         
+00052c40: 2020 2020 2020 2064 6963 203d 206c 6162         dic = lab
+00052c50: 656c 5f64 6963 745b 6561 6368 5f74 6172  el_dict[each_tar
+00052c60: 6765 745d 5b27 6469 6374 696f 6e61 7279  get]['dictionary
+00052c70: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
+00052c80: 2020 2020 7472 616e 7366 6f72 6d65 7220      transformer 
+00052c90: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
+00052ca0: 685f 7461 7267 6574 5d5b 2774 7261 6e73  h_target]['trans
+00052cb0: 666f 726d 6572 275d 0d0a 2020 2020 2020  former']..      
+00052cc0: 2020 2020 2020 2020 2020 636c 6173 735f            class_
+00052cd0: 6e75 6d73 203d 206c 6162 656c 5f64 6963  nums = label_dic
+00052ce0: 745b 6561 6368 5f74 6172 6765 745d 5b27  t[each_target]['
+00052cf0: 636c 6173 735f 6e75 6d73 275d 0d0a 2020  class_nums']..  
+00052d00: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00052d10: 2323 2320 4966 2074 6865 7265 2069 7320  ### If there is 
+00052d20: 6120 7472 616e 7366 6f72 6d65 722c 2079  a transformer, y
+00052d30: 6f75 206d 7573 7420 636f 6e76 6572 7420  ou must convert 
+00052d40: 7072 6564 6963 7469 6f6e 7320 746f 206f  predictions to o
+00052d50: 7269 6769 6e61 6c20 636c 6173 7365 730d  riginal classes.
+00052d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052d70: 2023 2323 2049 6e20 736f 6d65 2063 6173   ### In some cas
+00052d80: 6573 2073 7563 6820 6173 2043 6174 426f  es such as CatBo
+00052d90: 6f73 742c 2074 6865 206f 7574 7075 7420  ost, the output 
+00052da0: 666f 7220 6d75 6c74 692d 636c 6173 7320  for multi-class 
+00052db0: 6973 2032 2d44 2077 6974 6820 7368 6170  is 2-D with shap
+00052dc0: 6520 282c 3129 0d0a 2020 2020 2020 2020  e (,1)..        
+00052dd0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00052de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052df0: 2020 6173 7365 7274 2079 5f70 7265 642e    assert y_pred.
+00052e00: 7368 6170 655b 315d 0d0a 2020 2020 2020  shape[1]..      
+00052e10: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+00052e20: 7072 6564 203d 2079 5f70 7265 642e 7261  pred = y_pred.ra
+00052e30: 7665 6c28 290d 0a20 2020 2020 2020 2020  vel()..         
+00052e40: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00052e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052e60: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
+00052e70: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00052e80: 204f 6e63 6520 796f 7520 6765 7420 7468   Once you get th
+00052e90: 6520 6162 6f76 6520 7269 6768 742c 2079  e above right, y
+00052ea0: 6f75 2063 616e 2064 6f20 7468 6520 7265  ou can do the re
+00052eb0: 7374 2065 6173 7920 2323 2323 2323 0d0a  st easy ######..
+00052ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052ed0: 7465 7374 6d5b 6561 6368 5f74 6172 6765  testm[each_targe
+00052ee0: 742b 275f 7072 6564 6963 7469 6f6e 7327  t+'_predictions'
+00052ef0: 5d20 3d20 7064 2e53 6572 6965 7328 795f  ] = pd.Series(y_
+00052f00: 7072 6564 292e 6d61 7028 7472 616e 7366  pred).map(transf
+00052f10: 6f72 6d65 7229 2e76 616c 7565 730d 0a20  ormer).values.. 
+00052f20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00052f30: 6f72 2065 6163 685f 636c 6173 7320 696e  or each_class in
+00052f40: 2063 6c61 7373 6573 3a0d 0a20 2020 2020   classes:..     
+00052f50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00052f60: 6620 6973 696e 7374 616e 6365 2865 6163  f isinstance(eac
+00052f70: 685f 636c 6173 732c 2073 7472 293a 0d0a  h_class, str):..
 00052f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052fa0: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-00052fb0: 673d 2727 2c20 7665 7262 6f73 653d 7665  g='', verbose=ve
-00052fc0: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
-00052fd0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00052fe0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00052ff0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00053000: 735f 6c69 7374 2c20 656e 7365 6d62 6c65  s_list, ensemble
-00053010: 7320 3d20 5175 6963 6b4d 4c5f 456e 7365  s = QuickML_Ense
-00053020: 6d62 6c69 6e67 2858 2c20 792c 2058 5f74  mbling(X, y, X_t
-00053030: 6573 742c 2027 272c 0d0a 2020 2020 2020  est, '',..      
-00053040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053060: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00053070: 6c74 7970 653d 274d 756c 7469 5f43 6c61  ltype='Multi_Cla
-00053080: 7373 6966 6963 6174 696f 6e27 2c20 426f  ssification', Bo
-00053090: 6f73 7469 6e67 5f46 6c61 673d 426f 6f73  osting_Flag=Boos
-000530a0: 7469 6e67 5f46 6c61 672c 0d0a 2020 2020  ting_Flag,..    
-000530b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000530c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000530d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000530e0: 636f 7269 6e67 3d27 272c 2076 6572 626f  coring='', verbo
-000530f0: 7365 3d76 6572 626f 7365 290d 0a20 2020  se=verbose)..   
-00053100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053110: 206d 6f64 656c 735f 6c69 7374 2e61 7070   models_list.app
-00053120: 656e 6428 6d6f 6465 6c5f 6e61 6d65 290d  end(model_name).
-00053130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00053140: 2020 2020 2066 6f72 206d 6f64 656c 732c       for models,
-00053150: 2065 6163 6820 696e 207a 6970 286d 6f64   each in zip(mod
-00053160: 656c 735f 6c69 7374 2c20 7261 6e67 6528  els_list, range(
-00053170: 6c65 6e28 6d6f 6465 6c73 5f6c 6973 7429  len(models_list)
-00053180: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00053190: 2020 2020 2020 2020 2020 2020 206e 6577               new
-000531a0: 5f63 6f6c 203d 2065 6163 685f 7461 7267  _col = each_targ
-000531b0: 6574 2b27 5f27 2b6d 6f64 656c 732b 275f  et+'_'+models+'_
-000531c0: 7072 6564 6963 7469 6f6e 7327 0d0a 2020  predictions'..  
-000531d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000531e0: 2020 2020 2020 6966 2065 6163 682b 3120        if each+1 
-000531f0: 3d3d 206c 656e 286d 6f64 656c 735f 6c69  == len(models_li
-00053200: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
-00053210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053220: 2020 7375 626d 5b6e 6577 5f63 6f6c 5d20    subm[new_col] 
-00053230: 3d20 795f 7072 6564 0d0a 2020 2020 2020  = y_pred..      
-00053240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053250: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
-00053260: 636f 6c5d 203d 2070 642e 5365 7269 6573  col] = pd.Series
-00053270: 2879 5f70 7265 6429 2e6d 6170 2874 7261  (y_pred).map(tra
-00053280: 6e73 666f 726d 6572 292e 7661 6c75 6573  nsformer).values
-00053290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000532a0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-000532b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000532c0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
-000532d0: 6d5b 6e65 775f 636f 6c5d 203d 2065 6e73  m[new_col] = ens
-000532e0: 656d 626c 6573 5b3a 2c65 6163 685d 0d0a  embles[:,each]..
-000532f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053300: 2020 2020 2020 2020 2020 2020 7465 7374              test
-00053310: 6d5b 6e65 775f 636f 6c5d 203d 2070 642e  m[new_col] = pd.
-00053320: 5365 7269 6573 2865 6e73 656d 626c 6573  Series(ensembles
-00053330: 5b3a 2c65 6163 685d 292e 6d61 7028 7472  [:,each]).map(tr
-00053340: 616e 7366 6f72 6d65 7229 2e76 616c 7565  ansformer).value
-00053350: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00053360: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
-00053370: 6f6c 732e 6170 7065 6e64 286e 6577 5f63  ols.append(new_c
-00053380: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
-00053390: 2020 2020 2020 2020 2023 2323 2041 6674           ### Aft
-000533a0: 6572 2074 6869 732c 2079 5f70 7265 6420  er this, y_pred 
-000533b0: 6973 2061 2053 6572 6965 7320 6672 6f6d  is a Series from
-000533c0: 206e 6f77 206f 6e2e 2059 6f75 206e 6565   now on. You nee
-000533d0: 6420 795f 7072 6564 2e76 616c 7565 7320  d y_pred.values 
-000533e0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
-000533f0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00053400: 6e28 6e65 775f 636f 6c73 2920 3d3d 2035  n(new_cols) == 5
-00053410: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00053420: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00053430: 2827 2020 2020 4361 6c63 756c 6174 696e  ('    Calculatin
-00053440: 6720 7765 6967 6874 6564 2061 7665 7261  g weighted avera
-00053450: 6765 2065 6e73 656d 626c 6520 6f66 2025  ge ensemble of %
-00053460: 6420 636c 6173 7369 6669 6572 7327 2025  d classifiers' %
-00053470: 6c65 6e28 6e65 775f 636f 6c73 2929 0d0a  len(new_cols))..
-00053480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053490: 2020 2020 2020 2020 656e 7365 6d5f 7072          ensem_pr
-000534a0: 6564 203d 206e 702e 726f 756e 6428 7375  ed = np.round(su
-000534b0: 626d 5b6e 6577 5f63 6f6c 735b 2d31 5d5d  bm[new_cols[-1]]
-000534c0: 2a30 2e35 2b30 2e31 3235 2a28 7375 626d  *0.5+0.125*(subm
-000534d0: 5b6e 6577 5f63 6f6c 735b 305d 5d2b 7375  [new_cols[0]]+su
-000534e0: 626d 5b0d 0a20 2020 2020 2020 2020 2020  bm[..           
-000534f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053500: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00053510: 5f63 6f6c 735b 315d 5d2b 7375 626d 5b6e  _cols[1]]+subm[n
-00053520: 6577 5f63 6f6c 735b 325d 5d2b 7375 626d  ew_cols[2]]+subm
-00053530: 5b6e 6577 5f63 6f6c 735b 335d 5d29 292e  [new_cols[3]])).
-00053540: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00052f90: 2020 2020 2020 2020 7072 6f62 615f 636f          proba_co
+00052fa0: 6c20 3d20 6561 6368 5f74 6172 6765 742b  l = each_target+
+00052fb0: 275f 7072 6f62 615f 272b 6561 6368 5f63  '_proba_'+each_c
+00052fc0: 6c61 7373 0d0a 2020 2020 2020 2020 2020  lass..          
+00052fd0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00052fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052ff0: 2020 2020 2020 2020 2070 726f 6261 5f63           proba_c
+00053000: 6f6c 203d 2065 6163 685f 7461 7267 6574  ol = each_target
+00053010: 2b27 5f70 726f 6261 5f27 2b73 7472 2865  +'_proba_'+str(e
+00053020: 6163 685f 636c 6173 7329 0d0a 2020 2020  ach_class)..    
+00053030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053040: 636f 756e 7420 3d20 6c61 6265 6c5f 6469  count = label_di
+00053050: 6374 5b65 6163 685f 7461 7267 6574 5d5b  ct[each_target][
+00053060: 2764 6963 7469 6f6e 6172 7927 5d5b 6561  'dictionary'][ea
+00053070: 6368 5f63 6c61 7373 5d0d 0a20 2020 2020  ch_class]..     
+00053080: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00053090: 6573 746d 5b70 726f 6261 5f63 6f6c 5d20  estm[proba_col] 
+000530a0: 3d20 795f 7072 6f62 615b 3a2c 636f 756e  = y_proba[:,coun
+000530b0: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+000530c0: 2020 2020 2020 2020 7072 6f62 615f 636f          proba_co
+000530d0: 6c73 2e61 7070 656e 6428 7072 6f62 615f  ls.append(proba_
+000530e0: 636f 6c29 0d0a 2020 2020 2020 2020 2020  col)..          
+000530f0: 2020 2020 2020 2323 2323 2323 2020 4966        ######  If
+00053100: 2053 7461 636b 696e 675f 2046 6c61 6720   Stacking_ Flag 
+00053110: 6973 2046 616c 7365 2c20 7468 656e 2077  is False, then w
+00053120: 6520 646f 2045 6e73 656d 626c 696e 6720  e do Ensembling 
+00053130: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00053140: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00053150: 5374 6163 6b69 6e67 5f46 6c61 673a 0d0a  Stacking_Flag:..
+00053160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053170: 2020 2020 7375 626d 203d 2070 642e 4461      subm = pd.Da
+00053180: 7461 4672 616d 6528 290d 0a20 2020 2020  taFrame()..     
+00053190: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000531a0: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
+000531b0: 456e 7365 6d62 6c69 6e67 2020 4f6e 6c79  Ensembling  Only
+000531c0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+000531d0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000531e0: 656e 2863 6c61 7373 6573 2920 3d3d 2032  en(classes) == 2
+000531f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00053200: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00053210: 735f 6c69 7374 2c20 656e 7365 6d62 6c65  s_list, ensemble
+00053220: 7320 3d20 5175 6963 6b4d 4c5f 456e 7365  s = QuickML_Ense
+00053230: 6d62 6c69 6e67 2858 2c20 792c 2058 5f74  mbling(X, y, X_t
+00053240: 6573 742c 2027 272c 0d0a 2020 2020 2020  est, '',..      
+00053250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053270: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00053280: 6c74 7970 653d 2742 696e 6172 795f 436c  ltype='Binary_Cl
+00053290: 6173 7369 6669 6361 7469 6f6e 272c 2042  assification', B
+000532a0: 6f6f 7374 696e 675f 466c 6167 3d42 6f6f  oosting_Flag=Boo
+000532b0: 7374 696e 675f 466c 6167 2c0d 0a20 2020  sting_Flag,..   
+000532c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000532d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000532e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000532f0: 7363 6f72 696e 673d 2727 2c20 7665 7262  scoring='', verb
+00053300: 6f73 653d 7665 7262 6f73 6529 0d0a 2020  ose=verbose)..  
+00053310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053320: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00053330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053340: 206d 6f64 656c 735f 6c69 7374 2c20 656e   models_list, en
+00053350: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
+00053360: 4c5f 456e 7365 6d62 6c69 6e67 2858 2c20  L_Ensembling(X, 
+00053370: 792c 2058 5f74 6573 742c 2027 272c 0d0a  y, X_test, '',..
+00053380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000533a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000533b0: 2020 6d6f 6465 6c74 7970 653d 274d 756c    modeltype='Mul
+000533c0: 7469 5f43 6c61 7373 6966 6963 6174 696f  ti_Classificatio
+000533d0: 6e27 2c20 426f 6f73 7469 6e67 5f46 6c61  n', Boosting_Fla
+000533e0: 673d 426f 6f73 7469 6e67 5f46 6c61 672c  g=Boosting_Flag,
+000533f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00053400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053420: 2020 2020 2073 636f 7269 6e67 3d27 272c       scoring='',
+00053430: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
+00053440: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00053450: 2020 2020 2020 206d 6f64 656c 735f 6c69         models_li
+00053460: 7374 2e61 7070 656e 6428 6d6f 6465 6c5f  st.append(model_
+00053470: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+00053480: 2020 2020 2020 2020 2020 2066 6f72 206d             for m
+00053490: 6f64 656c 732c 2065 6163 6820 696e 207a  odels, each in z
+000534a0: 6970 286d 6f64 656c 735f 6c69 7374 2c20  ip(models_list, 
+000534b0: 7261 6e67 6528 6c65 6e28 6d6f 6465 6c73  range(len(models
+000534c0: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
+000534d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000534e0: 2020 206e 6577 5f63 6f6c 203d 2065 6163     new_col = eac
+000534f0: 685f 7461 7267 6574 2b27 5f27 2b6d 6f64  h_target+'_'+mod
+00053500: 656c 732b 275f 7072 6564 6963 7469 6f6e  els+'_prediction
+00053510: 7327 0d0a 2020 2020 2020 2020 2020 2020  s'..            
+00053520: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+00053530: 6163 682b 3120 3d3d 206c 656e 286d 6f64  ach+1 == len(mod
+00053540: 656c 735f 6c69 7374 293a 0d0a 2020 2020  els_list):..    
 00053550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053560: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00053570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053580: 7072 696e 7428 2720 2020 2043 616c 6375  print('    Calcu
-00053590: 6c61 7469 6e67 2072 6567 756c 6172 2061  lating regular a
-000535a0: 7665 7261 6765 2065 6e73 656d 626c 6520  verage ensemble 
-000535b0: 6f66 2025 6420 636c 6173 7369 6669 6572  of %d classifier
-000535c0: 7327 2025 6c65 6e28 6e65 775f 636f 6c73  s' %len(new_cols
-000535d0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-000535e0: 2020 2020 2020 2020 2020 2020 656e 7365              ense
-000535f0: 6d5f 7072 6564 203d 2028 7375 626d 5b6e  m_pred = (subm[n
-00053600: 6577 5f63 6f6c 735d 2e6d 6561 6e28 6178  ew_cols].mean(ax
-00053610: 6973 3d31 2929 2e61 7374 7970 6528 696e  is=1)).astype(in
-00053620: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00053630: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
-00053640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00053650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00053660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00053670: 2323 2323 2323 2327 290d 0a20 2020 2020  #######')..     
-00053680: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00053690: 2323 2323 2054 6869 7320 6e65 7874 2073  #### This next s
-000536a0: 7465 7020 6973 2076 6572 7920 696d 706f  tep is very impo
-000536b0: 7274 616e 7420 7369 6e63 6520 736f 6d65  rtant since some
-000536c0: 206d 6f64 656c 7320 6769 7665 2073 6572   models give ser
-000536d0: 6965 732c 206f 7468 6572 7320 6769 7665  ies, others give
-000536e0: 2061 7272 6179 732e 2056 6572 7920 7061   arrays. Very pa
-000536f0: 696e 6675 6c21 0d0a 2020 2020 2020 2020  inful!..        
-00053700: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00053710: 7369 6e73 7461 6e63 6528 656e 7365 6d5f  sinstance(ensem_
-00053720: 7072 6564 2c70 642e 5365 7269 6573 293a  pred,pd.Series):
-00053730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00053740: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
-00053750: 7072 6564 203d 2065 6e73 656d 5f70 7265  pred = ensem_pre
-00053760: 642e 7661 6c75 6573 0d0a 2020 2020 2020  d.values..      
-00053770: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00053780: 696e 7428 2743 6f6d 706c 6574 6564 2045  int('Completed E
-00053790: 6e73 656d 626c 6520 7072 6564 6963 7469  nsemble predicti
-000537a0: 6f6e 7320 6f6e 2068 656c 6420 6f75 7420  ons on held out 
-000537b0: 6461 7461 2729 0d0a 2020 2020 2020 2020  data')..        
-000537c0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-000537d0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
-000537e0: 742b 275f 456e 7365 6d62 6c65 645f 7072  t+'_Ensembled_pr
-000537f0: 6564 6963 7469 6f6e 7327 0d0a 2020 2020  edictions'..    
-00053800: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00053810: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00053820: 2020 2020 2020 2073 7461 636b 5f63 6f6c         stack_col
-00053830: 732c 2073 7461 636b 7366 696e 616c 203d  s, stacksfinal =
-00053840: 2051 7569 636b 4d4c 5f53 7461 636b 696e   QuickML_Stackin
-00053850: 6728 582c 2079 2c20 585f 7465 7374 2c0d  g(X, y, X_test,.
-00053860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00053870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053880: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
-00053890: 652c 2042 6f6f 7374 696e 675f 466c 6167  e, Boosting_Flag
-000538a0: 2c73 636f 7269 6e67 5f70 6172 616d 6574  ,scoring_paramet
-000538b0: 6572 2c76 6572 626f 7365 290d 0a20 2020  er,verbose)..   
-000538c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000538d0: 206e 6577 5f63 6f6c 203d 2065 6163 685f   new_col = each_
-000538e0: 7461 7267 6574 2b27 5f53 7461 636b 6564  target+'_Stacked
-000538f0: 5f27 2b73 7461 636b 5f63 6f6c 735b 305d  _'+stack_cols[0]
-00053900: 2e73 706c 6974 2822 5f22 295b 305d 2b27  .split("_")[0]+'
-00053910: 5f70 7265 6469 6374 696f 6e73 270d 0a20  _predictions'.. 
+00053560: 2020 2020 2020 2020 7375 626d 5b6e 6577          subm[new
+00053570: 5f63 6f6c 5d20 3d20 795f 7072 6564 0d0a  _col] = y_pred..
+00053580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053590: 2020 2020 2020 2020 2020 2020 7465 7374              test
+000535a0: 6d5b 6e65 775f 636f 6c5d 203d 2070 642e  m[new_col] = pd.
+000535b0: 5365 7269 6573 2879 5f70 7265 6429 2e6d  Series(y_pred).m
+000535c0: 6170 2874 7261 6e73 666f 726d 6572 292e  ap(transformer).
+000535d0: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
+000535e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000535f0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00053600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053610: 2020 2073 7562 6d5b 6e65 775f 636f 6c5d     subm[new_col]
+00053620: 203d 2065 6e73 656d 626c 6573 5b3a 2c65   = ensembles[:,e
+00053630: 6163 685d 0d0a 2020 2020 2020 2020 2020  ach]..          
+00053640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053650: 2020 7465 7374 6d5b 6e65 775f 636f 6c5d    testm[new_col]
+00053660: 203d 2070 642e 5365 7269 6573 2865 6e73   = pd.Series(ens
+00053670: 656d 626c 6573 5b3a 2c65 6163 685d 292e  embles[:,each]).
+00053680: 6d61 7028 7472 616e 7366 6f72 6d65 7229  map(transformer)
+00053690: 2e76 616c 7565 730d 0a20 2020 2020 2020  .values..       
+000536a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000536b0: 206e 6577 5f63 6f6c 732e 6170 7065 6e64   new_cols.append
+000536c0: 286e 6577 5f63 6f6c 290d 0a20 2020 2020  (new_col)..     
+000536d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000536e0: 2323 2041 6674 6572 2074 6869 732c 2079  ## After this, y
+000536f0: 5f70 7265 6420 6973 2061 2053 6572 6965  _pred is a Serie
+00053700: 7320 6672 6f6d 206e 6f77 206f 6e2e 2059  s from now on. Y
+00053710: 6f75 206e 6565 6420 795f 7072 6564 2e76  ou need y_pred.v
+00053720: 616c 7565 7320 2023 2323 230d 0a20 2020  alues  ####..   
+00053730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053740: 2069 6620 6c65 6e28 6e65 775f 636f 6c73   if len(new_cols
+00053750: 2920 3d3d 2035 3a0d 0a20 2020 2020 2020  ) == 5:..       
+00053760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053770: 2070 7269 6e74 2827 2020 2020 4361 6c63   print('    Calc
+00053780: 756c 6174 696e 6720 7765 6967 6874 6564  ulating weighted
+00053790: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
+000537a0: 6520 6f66 2025 6420 636c 6173 7369 6669  e of %d classifi
+000537b0: 6572 7327 2025 6c65 6e28 6e65 775f 636f  ers' %len(new_co
+000537c0: 6c73 2929 0d0a 2020 2020 2020 2020 2020  ls))..          
+000537d0: 2020 2020 2020 2020 2020 2020 2020 656e                en
+000537e0: 7365 6d5f 7072 6564 203d 206e 702e 726f  sem_pred = np.ro
+000537f0: 756e 6428 7375 626d 5b6e 6577 5f63 6f6c  und(subm[new_col
+00053800: 735b 2d31 5d5d 2a30 2e35 2b30 2e31 3235  s[-1]]*0.5+0.125
+00053810: 2a28 7375 626d 5b6e 6577 5f63 6f6c 735b  *(subm[new_cols[
+00053820: 305d 5d2b 7375 626d 5b0d 0a20 2020 2020  0]]+subm[..     
+00053830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053850: 2020 206e 6577 5f63 6f6c 735b 315d 5d2b     new_cols[1]]+
+00053860: 7375 626d 5b6e 6577 5f63 6f6c 735b 325d  subm[new_cols[2]
+00053870: 5d2b 7375 626d 5b6e 6577 5f63 6f6c 735b  ]+subm[new_cols[
+00053880: 335d 5d29 292e 6173 7479 7065 2869 6e74  3]])).astype(int
+00053890: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000538a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000538b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000538c0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+000538d0: 2043 616c 6375 6c61 7469 6e67 2072 6567   Calculating reg
+000538e0: 756c 6172 2061 7665 7261 6765 2065 6e73  ular average ens
+000538f0: 656d 626c 6520 6f66 2025 6420 636c 6173  emble of %d clas
+00053900: 7369 6669 6572 7327 2025 6c65 6e28 6e65  sifiers' %len(ne
+00053910: 775f 636f 6c73 2929 0d0a 2020 2020 2020  w_cols))..      
 00053920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053930: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
-00053940: 6e70 2e61 7267 6d61 7828 7374 6163 6b73  np.argmax(stacks
-00053950: 6669 6e61 6c2c 6178 6973 3d31 290d 0a20  final,axis=1).. 
-00053960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053970: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
-00053980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053930: 2020 656e 7365 6d5f 7072 6564 203d 2028    ensem_pred = (
+00053940: 7375 626d 5b6e 6577 5f63 6f6c 735d 2e6d  subm[new_cols].m
+00053950: 6561 6e28 6178 6973 3d31 2929 2e61 7374  ean(axis=1)).ast
+00053960: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
+00053970: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00053980: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
 00053990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000539a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000539b0: 2323 2729 0d0a 2020 2020 2020 2020 2020  ##')..          
-000539c0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000539d0: 2743 6f6d 706c 6574 6564 2053 7461 636b  'Completed Stack
-000539e0: 6564 2070 7265 6469 6374 696f 6e73 206f  ed predictions o
-000539f0: 6e20 6865 6c64 206f 7574 2064 6174 6127  n held out data'
-00053a00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00053a10: 2020 2074 6573 746d 5b6e 6577 5f63 6f6c     testm[new_col
-00053a20: 5d20 3d20 7064 2e53 6572 6965 7328 656e  ] = pd.Series(en
-00053a30: 7365 6d5f 7072 6564 292e 6d61 7028 7472  sem_pred).map(tr
-00053a40: 616e 7366 6f72 6d65 7229 2e76 616c 7565  ansformer).value
-00053a50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00053a60: 2020 206e 6577 5f63 6f6c 732e 6170 7065     new_cols.appe
-00053a70: 6e64 286e 6577 5f63 6f6c 290d 0a20 2020  nd(new_col)..   
-00053a80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00053a90: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
-00053aa0: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
-00053ab0: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-00053ac0: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00053ad0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00053ae0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00053af0: 655f 7375 626d 6973 7369 6f6e 5b65 6163  e_submission[eac
-00053b00: 685f 7461 7267 6574 5d20 3d20 7064 2e53  h_target] = pd.S
-00053b10: 6572 6965 7328 795f 7072 6564 292e 6d61  eries(y_pred).ma
-00053b20: 7028 7472 616e 7366 6f72 6d65 7229 2e76  p(transformer).v
-00053b30: 616c 7565 730d 0a20 2020 2020 2020 2020  alues..         
-00053b40: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00053b50: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00053b60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00053b70: 7428 2745 7272 6f72 3a20 5361 6d70 6c65  t('Error: Sample
-00053b80: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
-00053b90: 2069 7320 696e 636f 7272 6563 742e 2050   is incorrect. P
-00053ba0: 6c65 6173 6520 6368 6563 6b20 6974 2e20  lease check it. 
-00053bb0: 636f 6e74 696e 7569 6e67 2e2e 2e27 290d  continuing...').
-00053bc0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-00053bd0: 2323 2323 2323 2323 2323 2020 2050 204c  ##########   P L
-00053be0: 204f 2054 2020 2046 2045 2041 2054 2055   O T   F E A T U
-00053bf0: 2052 2045 2020 2049 204d 2050 204f 2052   R E   I M P O R
-00053c00: 2054 2041 204e 2043 2045 2053 2020 2048   T A N C E S   H
-00053c10: 2045 2052 2045 2023 2323 2323 2323 2323   E R E #########
-00053c20: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00053c30: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
-00053c40: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
-00053c50: 3a0d 0a20 2020 2020 2020 2069 6620 6361  :..        if ca
-00053c60: 6c69 6272 6174 6f72 5f66 6c61 673a 0d0a  librator_flag:..
-00053c70: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-00053c80: 5f6d 6f64 656c 203d 206d 6f64 656c 2e62  _model = model.b
-00053c90: 6173 655f 6573 7469 6d61 746f 720d 0a20  ase_estimator.. 
-00053ca0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00053cb0: 2020 2020 2020 2020 2020 706c 6f74 5f6d            plot_m
-00053cc0: 6f64 656c 203d 2063 6f70 792e 6465 6570  odel = copy.deep
-00053cd0: 636f 7079 286d 6f64 656c 290d 0a20 2020  copy(model)..   
-00053ce0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00053cf0: 2020 2020 2020 2023 2323 2323 2323 2054         ####### T
-00053d00: 6869 7320 6973 2077 6865 7265 2070 6c6f  his is where plo
-00053d10: 7420 6665 6174 7572 655f 696d 706f 7274  t feature_import
-00053d20: 616e 6365 735f 2066 6f72 2074 6865 206d  ances_ for the m
-00053d30: 6f64 656c 7320 2323 2323 2323 0d0a 2020  odels ######..  
-00053d40: 2020 2020 2020 2020 2020 6966 2042 6f6f            if Boo
-00053d50: 7374 696e 675f 466c 6167 2069 7320 4e6f  sting_Flag is No
-00053d60: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00053d70: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-00053d80: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-00053d90: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-00053da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053db0: 2323 2320 4966 2079 6f75 2075 7365 204c  ### If you use L
-00053dc0: 696e 6561 7253 5652 2020 7468 656e 2075  inearSVR  then u
-00053dd0: 7365 2061 6c6c 2061 6273 6f6c 7574 6520  se all absolute 
-00053de0: 7661 6c75 6573 2c20 736f 2079 6f75 2063  values, so you c
-00053df0: 616e 2070 6c6f 7420 7468 656d 2069 6e20  an plot them in 
-00053e00: 6465 6372 6561 7369 6e67 206f 7264 6572  decreasing order
-00053e10: 206f 6620 696d 706f 7274 616e 6365 0d0a   of importance..
+000539b0: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+000539c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000539d0: 2020 2020 2023 2323 2323 2054 6869 7320       ##### This 
+000539e0: 6e65 7874 2073 7465 7020 6973 2076 6572  next step is ver
+000539f0: 7920 696d 706f 7274 616e 7420 7369 6e63  y important sinc
+00053a00: 6520 736f 6d65 206d 6f64 656c 7320 6769  e some models gi
+00053a10: 7665 2073 6572 6965 732c 206f 7468 6572  ve series, other
+00053a20: 7320 6769 7665 2061 7272 6179 732e 2056  s give arrays. V
+00053a30: 6572 7920 7061 696e 6675 6c21 0d0a 2020  ery painful!..  
+00053a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053a50: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00053a60: 656e 7365 6d5f 7072 6564 2c70 642e 5365  ensem_pred,pd.Se
+00053a70: 7269 6573 293a 0d0a 2020 2020 2020 2020  ries):..        
+00053a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053a90: 656e 7365 6d5f 7072 6564 203d 2065 6e73  ensem_pred = ens
+00053aa0: 656d 5f70 7265 642e 7661 6c75 6573 0d0a  em_pred.values..
+00053ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053ac0: 2020 2020 7072 696e 7428 2743 6f6d 706c      print('Compl
+00053ad0: 6574 6564 2045 6e73 656d 626c 6520 7072  eted Ensemble pr
+00053ae0: 6564 6963 7469 6f6e 7320 6f6e 2068 656c  edictions on hel
+00053af0: 6420 6f75 7420 6461 7461 2729 0d0a 2020  d out data')..  
+00053b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053b10: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
+00053b20: 5f74 6172 6765 742b 275f 456e 7365 6d62  _target+'_Ensemb
+00053b30: 6c65 645f 7072 6564 6963 7469 6f6e 7327  led_predictions'
+00053b40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00053b50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00053b60: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00053b70: 636b 5f63 6f6c 732c 2073 7461 636b 7366  ck_cols, stacksf
+00053b80: 696e 616c 203d 2051 7569 636b 4d4c 5f53  inal = QuickML_S
+00053b90: 7461 636b 696e 6728 582c 2079 2c20 585f  tacking(X, y, X_
+00053ba0: 7465 7374 2c0d 0a20 2020 2020 2020 2020  test,..         
+00053bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053bc0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00053bd0: 6465 6c74 7970 652c 2042 6f6f 7374 696e  deltype, Boostin
+00053be0: 675f 466c 6167 2c73 636f 7269 6e67 5f70  g_Flag,scoring_p
+00053bf0: 6172 616d 6574 6572 2c76 6572 626f 7365  arameter,verbose
+00053c00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00053c10: 2020 2020 2020 206e 6577 5f63 6f6c 203d         new_col =
+00053c20: 2065 6163 685f 7461 7267 6574 2b27 5f53   each_target+'_S
+00053c30: 7461 636b 6564 5f27 2b73 7461 636b 5f63  tacked_'+stack_c
+00053c40: 6f6c 735b 305d 2e73 706c 6974 2822 5f22  ols[0].split("_"
+00053c50: 295b 305d 2b27 5f70 7265 6469 6374 696f  )[0]+'_predictio
+00053c60: 6e73 270d 0a20 2020 2020 2020 2020 2020  ns'..           
+00053c70: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
+00053c80: 7265 6420 3d20 6e70 2e61 7267 6d61 7828  red = np.argmax(
+00053c90: 7374 6163 6b73 6669 6e61 6c2c 6178 6973  stacksfinal,axis
+00053ca0: 3d31 290d 0a20 2020 2020 2020 2020 2020  =1)..           
+00053cb0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00053cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053ce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053cf0: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
+00053d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053d10: 7072 696e 7428 2743 6f6d 706c 6574 6564  print('Completed
+00053d20: 2053 7461 636b 6564 2070 7265 6469 6374   Stacked predict
+00053d30: 696f 6e73 206f 6e20 6865 6c64 206f 7574  ions on held out
+00053d40: 2064 6174 6127 290d 0a20 2020 2020 2020   data')..       
+00053d50: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
+00053d60: 6577 5f63 6f6c 5d20 3d20 7064 2e53 6572  ew_col] = pd.Ser
+00053d70: 6965 7328 656e 7365 6d5f 7072 6564 292e  ies(ensem_pred).
+00053d80: 6d61 7028 7472 616e 7366 6f72 6d65 7229  map(transformer)
+00053d90: 2e76 616c 7565 730d 0a20 2020 2020 2020  .values..       
+00053da0: 2020 2020 2020 2020 206e 6577 5f63 6f6c           new_col
+00053db0: 732e 6170 7065 6e64 286e 6577 5f63 6f6c  s.append(new_col
+00053dc0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00053dd0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00053de0: 616e 6365 2873 616d 706c 655f 7375 626d  ance(sample_subm
+00053df0: 6973 7369 6f6e 2c20 7374 7229 3a0d 0a20  ission, str):.. 
+00053e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053e10: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
 00053e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053e30: 2020 2020 2020 2020 696d 705f 6665 6174          imp_feat
-00053e40: 7572 6573 5f64 6620 3d20 7064 2e44 6174  ures_df = pd.Dat
-00053e50: 6146 7261 6d65 2861 6273 2870 6c6f 745f  aFrame(abs(plot_
-00053e60: 6d6f 6465 6c2e 636f 6566 5f29 2c0d 0a20  model.coef_),.. 
-00053e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053e30: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00053e40: 6f6e 5b65 6163 685f 7461 7267 6574 5d20  on[each_target] 
+00053e50: 3d20 7064 2e53 6572 6965 7328 795f 7072  = pd.Series(y_pr
+00053e60: 6564 292e 6d61 7028 7472 616e 7366 6f72  ed).map(transfor
+00053e70: 6d65 7229 2e76 616c 7565 730d 0a20 2020  mer).values..   
 00053e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053e90: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00053ea0: 6e73 3d5b 2746 6561 7475 7265 2049 6d70  ns=['Feature Imp
-00053eb0: 6f72 7461 6e63 6573 275d 2c69 6e64 6578  ortances'],index
-00053ec0: 3d69 6d70 6f72 7461 6e74 5f66 6561 7475  =important_featu
-00053ed0: 7265 7329 2e73 6f72 745f 7661 6c75 6573  res).sort_values
-00053ee0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00053ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053f00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00053f10: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
-00053f20: 6365 7327 2c61 7363 656e 6469 6e67 3d46  ces',ascending=F
-00053f30: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-00053f40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00053f50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00053f60: 2020 2020 2020 2020 2020 2323 2320 4966            ### If
-00053f70: 2079 6f75 2064 6f6e 2774 2075 7365 2061   you don't use a
-00053f80: 6273 6f6c 7574 6520 7661 6c75 6573 2c20  bsolute values, 
-00053f90: 796f 7520 776f 6e27 7420 6765 7420 7468  you won't get th
-00053fa0: 6520 7269 6768 7420 7365 7420 6f66 2066  e right set of f
-00053fb0: 6561 7475 7265 7320 696e 206f 7264 6572  eatures in order
-00053fc0: 2e20 4d61 6b65 2073 7572 6521 0d0a 2020  . Make sure!..  
-00053fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053fe0: 2020 2020 2020 696d 705f 6665 6174 7572        imp_featur
-00053ff0: 6573 5f64 6620 3d20 7064 2e44 6174 6146  es_df = pd.DataF
-00054000: 7261 6d65 2861 6273 2870 6c6f 745f 6d6f  rame(abs(plot_mo
-00054010: 6465 6c2e 636f 6566 5f5b 305d 292c 0d0a  del.coef_[0]),..
-00054020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054040: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00054050: 6d6e 733d 5b27 4665 6174 7572 6520 496d  mns=['Feature Im
-00054060: 706f 7274 616e 6365 7327 5d2c 696e 6465  portances'],inde
-00054070: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
-00054080: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
-00054090: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-000540a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000540b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000540c0: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
-000540d0: 6e63 6573 272c 6173 6365 6e64 696e 673d  nces',ascending=
-000540e0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-000540f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00054100: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-00054110: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
-00054120: 203d 3d20 2778 6762 6f6f 7374 273a 0d0a   == 'xgboost':..
-00054130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054140: 2020 2020 2323 2323 2320 2053 4841 5020      #####  SHAP 
-00054150: 7265 7175 6972 6573 2074 6869 7320 7374  requires this st
-00054160: 6570 3a20 5847 426f 6f73 7420 6d6f 6465  ep: XGBoost mode
-00054170: 6c73 206d 7573 7420 6861 7665 2062 6565  ls must have bee
-00054180: 6e20 2270 7265 6469 6374 6564 220d 0a20  n "predicted".. 
-00054190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000541a0: 2020 205f 203d 2070 6c6f 745f 6d6f 6465     _ = plot_mode
-000541b0: 6c2e 7072 6564 6963 7428 585f 7465 7374  l.predict(X_test
-000541c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000541d0: 2020 2020 2020 2023 2323 2049 7420 6973         ### It is
-000541e0: 2070 6f73 7369 626c 6520 7468 6174 2069   possible that i
-000541f0: 6e20 736f 6d65 2063 6173 6573 2c20 5847  n some cases, XG
-00054200: 426f 6f73 7420 6861 7320 6665 7765 7220  Boost has fewer 
-00054210: 6665 6174 7572 6573 2074 6861 6e20 7768  features than wh
-00054220: 6174 2077 6173 2073 656e 7420 696e 2e0d  at was sent in..
-00054230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054240: 2020 2020 2023 2323 2049 6e20 7468 6f73       ### In thos
-00054250: 6520 6361 7365 732c 2077 6520 6e65 6564  e cases, we need
-00054260: 2074 6f20 6964 656e 7469 6679 2061 6e64   to identify and
-00054270: 206b 6e6f 7720 7768 6963 6820 6665 6174   know which feat
-00054280: 7572 6573 2069 6e20 5847 426f 6f73 7420  ures in XGBoost 
-00054290: 6172 6520 696e 2061 6e64 2077 6869 6368  are in and which
-000542a0: 2061 7265 206f 7574 0d0a 2020 2020 2020   are out..      
-000542b0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000542c0: 2323 2049 6e20 7468 6174 2063 6173 652c  ## In that case,
-000542d0: 2077 6520 6e65 6564 2074 6f20 6669 6e64   we need to find
-000542e0: 2074 686f 7365 2066 6561 7475 7265 7320   those features 
-000542f0: 616e 6420 7468 656e 2064 6f20 6120 6665  and then do a fe
-00054300: 6174 7572 6520 696d 706f 7274 616e 6365  ature importance
-00054310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00054320: 2020 2020 2020 6469 6374 6620 3d20 706c        dictf = pl
-00054330: 6f74 5f6d 6f64 656c 2e67 6574 5f62 6f6f  ot_model.get_boo
-00054340: 7374 6572 2829 2e67 6574 5f73 636f 7265  ster().get_score
-00054350: 2869 6d70 6f72 7461 6e63 655f 7479 7065  (importance_type
-00054360: 3d27 6761 696e 2729 0d0a 2020 2020 2020  ='gain')..      
-00054370: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00054380: 206c 656e 286c 6566 745f 7375 6274 7261   len(left_subtra
-00054390: 6374 2870 6c6f 745f 6d6f 6465 6c2e 6765  ct(plot_model.ge
-000543a0: 745f 626f 6f73 7465 7228 292e 6665 6174  t_booster().feat
-000543b0: 7572 655f 6e61 6d65 732c 696d 706f 7274  ure_names,import
-000543c0: 616e 745f 6665 6174 7572 6573 2929 203e  ant_features)) >
-000543d0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-000543e0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-000543f0: 2320 4966 2066 6561 7475 7265 206e 616d  # If feature nam
-00054400: 6573 2066 726f 6d20 5847 426f 6f73 7420  es from XGBoost 
-00054410: 616e 6420 696d 706f 7274 616e 745f 6665  and important_fe
-00054420: 6174 7572 6573 2061 7265 206e 6f74 2073  atures are not s
-00054430: 616d 652c 796f 7520 6d75 7374 2074 7261  ame,you must tra
-00054440: 6e73 666f 726d 2064 6963 7466 206c 696b  nsform dictf lik
-00054450: 6520 7468 6973 210d 0a20 2020 2020 2020  e this!..       
+00053e90: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00053ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053eb0: 2020 7072 696e 7428 2745 7272 6f72 3a20    print('Error: 
+00053ec0: 5361 6d70 6c65 2073 7562 6d69 7373 696f  Sample submissio
+00053ed0: 6e20 6669 6c65 2069 7320 696e 636f 7272  n file is incorr
+00053ee0: 6563 742e 2050 6c65 6173 6520 6368 6563  ect. Please chec
+00053ef0: 6b20 6974 2e20 636f 6e74 696e 7569 6e67  k it. continuing
+00053f00: 2e2e 2e27 290d 0a20 2020 2023 2323 2323  ...')..    #####
+00053f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053f20: 2020 2050 204c 204f 2054 2020 2046 2045     P L O T   F E
+00053f30: 2041 2054 2055 2052 2045 2020 2049 204d   A T U R E   I M
+00053f40: 2050 204f 2052 2054 2041 204e 2043 2045   P O R T A N C E
+00053f50: 2053 2020 2048 2045 2052 2045 2023 2323   S   H E R E ###
+00053f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00053f70: 0d0a 2020 2020 6966 206d 6f64 656c 5f6c  ..    if model_l
+00053f80: 6162 656c 203d 3d20 2753 696e 676c 655f  abel == 'Single_
+00053f90: 4c61 6265 6c27 3a0d 0a20 2020 2020 2020  Label':..       
+00053fa0: 2069 6620 6361 6c69 6272 6174 6f72 5f66   if calibrator_f
+00053fb0: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
+00053fc0: 2020 6966 204c 6f6f 7365 5665 7273 696f    if LooseVersio
+00053fd0: 6e28 736b 6c65 6172 6e2e 5f5f 7665 7273  n(sklearn.__vers
+00053fe0: 696f 6e5f 5f29 203c 3d20 4c6f 6f73 6556  ion__) <= LooseV
+00053ff0: 6572 7369 6f6e 2827 302e 3234 2e32 2729  ersion('0.24.2')
+00054000: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00054010: 2020 2023 2050 6572 666f 726d 2061 6374     # Perform act
+00054020: 696f 6e20 666f 7220 7363 696b 6974 2d6c  ion for scikit-l
+00054030: 6561 726e 2076 6572 7369 6f6e 2062 656c  earn version bel
+00054040: 6f77 2030 2e32 342e 320d 0a20 2020 2020  ow 0.24.2..     
+00054050: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
+00054060: 2079 6f75 7220 636f 6465 2068 6572 6520   your code here 
+00054070: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
+00054080: 2076 6572 7369 6f6e 2062 656c 6f77 2030   version below 0
+00054090: 2e32 342e 320d 0a20 2020 2020 2020 2020  .24.2..         
+000540a0: 2020 2020 2020 2070 6c6f 745f 6d6f 6465         plot_mode
+000540b0: 6c20 3d20 6d6f 6465 6c2e 6261 7365 5f65  l = model.base_e
+000540c0: 7374 696d 6174 6f72 0d0a 2020 2020 2020  stimator..      
+000540d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000540e0: 2020 2020 2020 2020 2020 2020 2023 2050               # P
+000540f0: 6572 666f 726d 2061 6374 696f 6e20 666f  erform action fo
+00054100: 7220 7363 696b 6974 2d6c 6561 726e 2076  r scikit-learn v
+00054110: 6572 7369 6f6e 2030 2e32 342e 3220 616e  ersion 0.24.2 an
+00054120: 6420 6162 6f76 650d 0a20 2020 2020 2020  d above..       
+00054130: 2020 2020 2020 2020 2023 2041 6464 2079           # Add y
+00054140: 6f75 7220 636f 6465 2068 6572 6520 666f  our code here fo
+00054150: 7220 7363 696b 6974 2d6c 6561 726e 2076  r scikit-learn v
+00054160: 6572 7369 6f6e 2030 2e32 342e 3220 616e  ersion 0.24.2 an
+00054170: 6420 6162 6f76 650d 0a20 2020 2020 2020  d above..       
+00054180: 2020 2020 2020 2020 2070 6c6f 745f 6d6f           plot_mo
+00054190: 6465 6c20 3d20 6d6f 6465 6c2e 6573 7469  del = model.esti
+000541a0: 6d61 746f 720d 0a20 2020 2020 2020 2065  mator..        e
+000541b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000541c0: 2020 706c 6f74 5f6d 6f64 656c 203d 2063    plot_model = c
+000541d0: 6f70 792e 6465 6570 636f 7079 286d 6f64  opy.deepcopy(mod
+000541e0: 656c 290d 0a20 2020 2020 2020 2074 7279  el)..        try
+000541f0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00054200: 2323 2323 2323 2054 6869 7320 6973 2077  ###### This is w
+00054210: 6865 7265 2070 6c6f 7420 6665 6174 7572  here plot featur
+00054220: 655f 696d 706f 7274 616e 6365 735f 2066  e_importances_ f
+00054230: 6f72 2074 6865 206d 6f64 656c 7320 2323  or the models ##
+00054240: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00054250: 2020 6966 2042 6f6f 7374 696e 675f 466c    if Boosting_Fl
+00054260: 6167 2069 7320 4e6f 6e65 3a0d 0a20 2020  ag is None:..   
+00054270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054280: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
+00054290: 2027 5265 6772 6573 7369 6f6e 273a 0d0a   'Regression':..
+000542a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000542b0: 2020 2020 2020 2020 2323 2320 4966 2079          ### If y
+000542c0: 6f75 2075 7365 204c 696e 6561 7253 5652  ou use LinearSVR
+000542d0: 2020 7468 656e 2075 7365 2061 6c6c 2061    then use all a
+000542e0: 6273 6f6c 7574 6520 7661 6c75 6573 2c20  bsolute values, 
+000542f0: 736f 2079 6f75 2063 616e 2070 6c6f 7420  so you can plot 
+00054300: 7468 656d 2069 6e20 6465 6372 6561 7369  them in decreasi
+00054310: 6e67 206f 7264 6572 206f 6620 696d 706f  ng order of impo
+00054320: 7274 616e 6365 0d0a 2020 2020 2020 2020  rtance..        
+00054330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054340: 696d 705f 6665 6174 7572 6573 5f64 6620  imp_features_df 
+00054350: 3d20 7064 2e44 6174 6146 7261 6d65 2861  = pd.DataFrame(a
+00054360: 6273 2870 6c6f 745f 6d6f 6465 6c2e 636f  bs(plot_model.co
+00054370: 6566 5f29 2c0d 0a20 2020 2020 2020 2020  ef_),..         
+00054380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000543a0: 2020 2063 6f6c 756d 6e73 3d5b 2746 6561     columns=['Fea
+000543b0: 7475 7265 2049 6d70 6f72 7461 6e63 6573  ture Importances
+000543c0: 275d 2c69 6e64 6578 3d69 6d70 6f72 7461  '],index=importa
+000543d0: 6e74 5f66 6561 7475 7265 7329 2e73 6f72  nt_features).sor
+000543e0: 745f 7661 6c75 6573 280d 0a20 2020 2020  t_values(..     
+000543f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054410: 2020 2020 2020 2027 4665 6174 7572 6520         'Feature 
+00054420: 496d 706f 7274 616e 6365 7327 2c61 7363  Importances',asc
+00054430: 656e 6469 6e67 3d46 616c 7365 290d 0a20  ending=False).. 
+00054440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054450: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
 00054460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054470: 2064 6963 7461 203d 2064 6963 7428 7a69   dicta = dict(zi
-00054480: 7028 706c 6f74 5f6d 6f64 656c 2e67 6574  p(plot_model.get
-00054490: 5f62 6f6f 7374 6572 2829 2e66 6561 7475  _booster().featu
-000544a0: 7265 5f6e 616d 6573 2c69 6d70 6f72 7461  re_names,importa
-000544b0: 6e74 5f66 6561 7475 7265 7329 290d 0a20  nt_features)).. 
-000544c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000544d0: 2020 2020 2020 2066 6561 7464 6963 7420         featdict 
-000544e0: 3d20 6469 6374 285b 2878 2c64 6963 7461  = dict([(x,dicta
-000544f0: 5b78 5d29 2066 6f72 2078 2069 6e20 6469  [x]) for x in di
-00054500: 6374 662e 6b65 7973 2829 5d29 0d0a 2020  ctf.keys()])..  
-00054510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054520: 2020 2020 2020 6665 6174 6469 6374 3220        featdict2 
-00054530: 3d20 6469 6374 285b 2864 6963 7461 5b78  = dict([(dicta[x
-00054540: 5d2c 6469 6374 665b 785d 2920 666f 7220  ],dictf[x]) for 
-00054550: 7820 696e 2066 6561 7464 6963 742e 6b65  x in featdict.ke
-00054560: 7973 2829 5d29 0d0a 2020 2020 2020 2020  ys()])..        
-00054570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054580: 696d 705f 6665 6174 7572 6573 5f64 6620  imp_features_df 
-00054590: 3d20 2070 642e 4461 7461 4672 616d 6528  =  pd.DataFrame(
-000545a0: 6665 6174 6469 6374 322e 7661 6c75 6573  featdict2.values
-000545b0: 2829 2c69 6e64 6578 3d66 6561 7464 6963  (),index=featdic
-000545c0: 7432 2e6b 6579 7328 292c 0d0a 2020 2020  t2.keys(),..    
-000545d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000545e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000545f0: 2020 2020 636f 6c75 6d6e 7320 3d20 5b27      columns = ['
-00054600: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
-00054610: 6365 7327 5d29 2e73 6f72 745f 7661 6c75  ces']).sort_valu
-00054620: 6573 2827 4665 6174 7572 6520 496d 706f  es('Feature Impo
-00054630: 7274 616e 6365 7327 2c0d 0a20 2020 2020  rtances',..     
-00054640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054660: 2020 2061 7363 656e 6469 6e67 3d46 616c     ascending=Fal
-00054670: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-00054680: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00054690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000546a0: 2020 2020 2020 2020 2323 2323 2049 6620          #### If 
-000546b0: 7468 6520 6665 6174 7572 6520 6e61 6d65  the feature name
-000546c0: 7320 6672 6f6d 2058 4742 6f6f 7374 2061  s from XGBoost a
-000546d0: 6e64 2074 6865 2069 6d70 6f72 7461 6e74  nd the important
-000546e0: 5f66 6561 7475 7265 7320 6172 6520 7361  _features are sa
-000546f0: 6d65 2c0d 0a20 2020 2020 2020 2020 2020  me,..           
-00054700: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00054710: 2020 2020 2079 6f75 2063 616e 2070 6c6f       you can plo
-00054720: 7420 6469 6374 6620 696d 6d65 6469 6174  t dictf immediat
-00054730: 656c 7921 0d0a 2020 2020 2020 2020 2020  ely!..          
-00054740: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00054750: 705f 6665 6174 7572 6573 5f64 6620 3d20  p_features_df = 
-00054760: 2070 642e 4461 7461 4672 616d 6528 6469   pd.DataFrame(di
-00054770: 6374 662e 7661 6c75 6573 2829 2c69 6e64  ctf.values(),ind
-00054780: 6578 3d64 6963 7466 2e6b 6579 7328 292c  ex=dictf.keys(),
-00054790: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000547a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000547b0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-000547c0: 7320 3d20 5b27 4665 6174 7572 6520 496d  s = ['Feature Im
-000547d0: 706f 7274 616e 6365 7327 5d29 2e73 6f72  portances']).sor
-000547e0: 745f 7661 6c75 6573 2827 4665 6174 7572  t_values('Featur
-000547f0: 6520 496d 706f 7274 616e 6365 7327 2c0d  e Importances',.
-00054800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054820: 2020 2020 2020 2020 2061 7363 656e 6469           ascendi
-00054830: 6e67 3d46 616c 7365 290d 0a20 2020 2020  ng=False)..     
-00054840: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00054850: 6d6f 6465 6c5f 6e61 6d65 203d 3d20 2746  model_name == 'F
-00054860: 6f72 6573 7473 273a 0d0a 2020 2020 2020  orests':..      
-00054870: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00054880: 705f 6665 6174 7572 6573 5f64 6620 3d20  p_features_df = 
-00054890: 7064 2e44 6174 6146 7261 6d65 2870 6c6f  pd.DataFrame(plo
-000548a0: 745f 6d6f 6465 6c2e 6665 6174 7572 655f  t_model.feature_
-000548b0: 696d 706f 7274 616e 6365 735f 2c20 636f  importances_, co
-000548c0: 6c75 6d6e 733d 5b27 4665 6174 7572 6520  lumns=['Feature 
-000548d0: 496d 706f 7274 616e 6365 7327 5d2c 0d0a  Importances'],..
+00054470: 2020 2323 2320 4966 2079 6f75 2064 6f6e    ### If you don
+00054480: 2774 2075 7365 2061 6273 6f6c 7574 6520  't use absolute 
+00054490: 7661 6c75 6573 2c20 796f 7520 776f 6e27  values, you won'
+000544a0: 7420 6765 7420 7468 6520 7269 6768 7420  t get the right 
+000544b0: 7365 7420 6f66 2066 6561 7475 7265 7320  set of features 
+000544c0: 696e 206f 7264 6572 2e20 4d61 6b65 2073  in order. Make s
+000544d0: 7572 6521 0d0a 2020 2020 2020 2020 2020  ure!..          
+000544e0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000544f0: 705f 6665 6174 7572 6573 5f64 6620 3d20  p_features_df = 
+00054500: 7064 2e44 6174 6146 7261 6d65 2861 6273  pd.DataFrame(abs
+00054510: 2870 6c6f 745f 6d6f 6465 6c2e 636f 6566  (plot_model.coef
+00054520: 5f5b 305d 292c 0d0a 2020 2020 2020 2020  _[0]),..        
+00054530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054550: 2020 2020 636f 6c75 6d6e 733d 5b27 4665      columns=['Fe
+00054560: 6174 7572 6520 496d 706f 7274 616e 6365  ature Importance
+00054570: 7327 5d2c 696e 6465 783d 696d 706f 7274  s'],index=import
+00054580: 616e 745f 6665 6174 7572 6573 292e 736f  ant_features).so
+00054590: 7274 5f76 616c 7565 7328 0d0a 2020 2020  rt_values(..    
+000545a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000545b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000545c0: 2020 2020 2020 2020 2746 6561 7475 7265          'Feature
+000545d0: 2049 6d70 6f72 7461 6e63 6573 272c 6173   Importances',as
+000545e0: 6365 6e64 696e 673d 4661 6c73 6529 0d0a  cending=False)..
+000545f0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00054600: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00054610: 2020 2069 6620 6d6f 6465 6c5f 6e61 6d65     if model_name
+00054620: 2e6c 6f77 6572 2829 203d 3d20 2778 6762  .lower() == 'xgb
+00054630: 6f6f 7374 273a 0d0a 2020 2020 2020 2020  oost':..        
+00054640: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00054650: 2320 2053 4841 5020 7265 7175 6972 6573  #  SHAP requires
+00054660: 2074 6869 7320 7374 6570 3a20 5847 426f   this step: XGBo
+00054670: 6f73 7420 6d6f 6465 6c73 206d 7573 7420  ost models must 
+00054680: 6861 7665 2062 6565 6e20 2270 7265 6469  have been "predi
+00054690: 6374 6564 220d 0a20 2020 2020 2020 2020  cted"..         
+000546a0: 2020 2020 2020 2020 2020 205f 203d 2070             _ = p
+000546b0: 6c6f 745f 6d6f 6465 6c2e 7072 6564 6963  lot_model.predic
+000546c0: 7428 585f 7465 7374 290d 0a20 2020 2020  t(X_test)..     
+000546d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000546e0: 2323 2049 7420 6973 2070 6f73 7369 626c  ## It is possibl
+000546f0: 6520 7468 6174 2069 6e20 736f 6d65 2063  e that in some c
+00054700: 6173 6573 2c20 5847 426f 6f73 7420 6861  ases, XGBoost ha
+00054710: 7320 6665 7765 7220 6665 6174 7572 6573  s fewer features
+00054720: 2074 6861 6e20 7768 6174 2077 6173 2073   than what was s
+00054730: 656e 7420 696e 2e0d 0a20 2020 2020 2020  ent in...       
+00054740: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00054750: 2049 6e20 7468 6f73 6520 6361 7365 732c   In those cases,
+00054760: 2077 6520 6e65 6564 2074 6f20 6964 656e   we need to iden
+00054770: 7469 6679 2061 6e64 206b 6e6f 7720 7768  tify and know wh
+00054780: 6963 6820 6665 6174 7572 6573 2069 6e20  ich features in 
+00054790: 5847 426f 6f73 7420 6172 6520 696e 2061  XGBoost are in a
+000547a0: 6e64 2077 6869 6368 2061 7265 206f 7574  nd which are out
+000547b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000547c0: 2020 2020 2020 2323 2323 2049 6e20 7468        #### In th
+000547d0: 6174 2063 6173 652c 2077 6520 6e65 6564  at case, we need
+000547e0: 2074 6f20 6669 6e64 2074 686f 7365 2066   to find those f
+000547f0: 6561 7475 7265 7320 616e 6420 7468 656e  eatures and then
+00054800: 2064 6f20 6120 6665 6174 7572 6520 696d   do a feature im
+00054810: 706f 7274 616e 6365 0d0a 2020 2020 2020  portance..      
+00054820: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00054830: 6374 6620 3d20 706c 6f74 5f6d 6f64 656c  ctf = plot_model
+00054840: 2e67 6574 5f62 6f6f 7374 6572 2829 2e67  .get_booster().g
+00054850: 6574 5f73 636f 7265 2869 6d70 6f72 7461  et_score(importa
+00054860: 6e63 655f 7479 7065 3d27 6761 696e 2729  nce_type='gain')
+00054870: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00054880: 2020 2020 2020 6966 206c 656e 286c 6566        if len(lef
+00054890: 745f 7375 6274 7261 6374 2870 6c6f 745f  t_subtract(plot_
+000548a0: 6d6f 6465 6c2e 6765 745f 626f 6f73 7465  model.get_booste
+000548b0: 7228 292e 6665 6174 7572 655f 6e61 6d65  r().feature_name
+000548c0: 732c 696d 706f 7274 616e 745f 6665 6174  s,important_feat
+000548d0: 7572 6573 2929 203e 2030 3a0d 0a20 2020  ures)) > 0:..   
 000548e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000548f0: 2020 2020 2020 2020 2069 6e64 6578 3d69           index=i
-00054900: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-00054910: 7329 2e73 6f72 745f 7661 6c75 6573 2827  s).sort_values('
-00054920: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
-00054930: 6365 7327 2c0d 0a20 2020 2020 2020 2020  ces',..         
-00054940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054950: 6173 6365 6e64 696e 673d 4661 6c73 6529  ascending=False)
-00054960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00054970: 2020 656c 6966 206d 6f64 656c 5f6e 616d    elif model_nam
-00054980: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
-00054990: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
-000549a0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-000549b0: 6f6d 2063 6174 626f 6f73 7420 696d 706f  om catboost impo
-000549c0: 7274 2050 6f6f 6c0d 0a20 2020 2020 2020  rt Pool..       
-000549d0: 2020 2020 2020 2020 2020 2020 2074 7279               try
-000549e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000549f0: 2020 2020 2020 2020 2020 2069 6d70 5f66             imp_f
-00054a00: 6561 7475 7265 735f 6466 203d 2070 642e  eatures_df = pd.
-00054a10: 4461 7461 4672 616d 6528 706c 6f74 5f6d  DataFrame(plot_m
-00054a20: 6f64 656c 2e67 6574 5f66 6561 7475 7265  odel.get_feature
-00054a30: 5f69 6d70 6f72 7461 6e63 6528 0d0a 2020  _importance(..  
-00054a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a60: 2020 506f 6f6c 2858 5f63 762c 206c 6162    Pool(X_cv, lab
-00054a70: 656c 3d79 5f63 762c 6361 745f 6665 6174  el=y_cv,cat_feat
-00054a80: 7572 6573 3d69 6d70 5f63 6174 7329 292c  ures=imp_cats)),
-00054a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00054aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ab0: 2020 2020 2020 636f 6c75 6d6e 733d 5b27        columns=['
-00054ac0: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
-00054ad0: 6365 7327 5d2c 0d0a 2020 2020 2020 2020  ces'],..        
+000548f0: 2020 2020 2023 2323 2320 4966 2066 6561       #### If fea
+00054900: 7475 7265 206e 616d 6573 2066 726f 6d20  ture names from 
+00054910: 5847 426f 6f73 7420 616e 6420 696d 706f  XGBoost and impo
+00054920: 7274 616e 745f 6665 6174 7572 6573 2061  rtant_features a
+00054930: 7265 206e 6f74 2073 616d 652c 796f 7520  re not same,you 
+00054940: 6d75 7374 2074 7261 6e73 666f 726d 2064  must transform d
+00054950: 6963 7466 206c 696b 6520 7468 6973 210d  ictf like this!.
+00054960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054970: 2020 2020 2020 2020 2064 6963 7461 203d           dicta =
+00054980: 2064 6963 7428 7a69 7028 706c 6f74 5f6d   dict(zip(plot_m
+00054990: 6f64 656c 2e67 6574 5f62 6f6f 7374 6572  odel.get_booster
+000549a0: 2829 2e66 6561 7475 7265 5f6e 616d 6573  ().feature_names
+000549b0: 2c69 6d70 6f72 7461 6e74 5f66 6561 7475  ,important_featu
+000549c0: 7265 7329 290d 0a20 2020 2020 2020 2020  res))..         
+000549d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000549e0: 6561 7464 6963 7420 3d20 6469 6374 285b  eatdict = dict([
+000549f0: 2878 2c64 6963 7461 5b78 5d29 2066 6f72  (x,dicta[x]) for
+00054a00: 2078 2069 6e20 6469 6374 662e 6b65 7973   x in dictf.keys
+00054a10: 2829 5d29 0d0a 2020 2020 2020 2020 2020  ()])..          
+00054a20: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+00054a30: 6174 6469 6374 3220 3d20 6469 6374 285b  atdict2 = dict([
+00054a40: 2864 6963 7461 5b78 5d2c 6469 6374 665b  (dicta[x],dictf[
+00054a50: 785d 2920 666f 7220 7820 696e 2066 6561  x]) for x in fea
+00054a60: 7464 6963 742e 6b65 7973 2829 5d29 0d0a  tdict.keys()])..
+00054a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054a80: 2020 2020 2020 2020 696d 705f 6665 6174          imp_feat
+00054a90: 7572 6573 5f64 6620 3d20 2070 642e 4461  ures_df =  pd.Da
+00054aa0: 7461 4672 616d 6528 6665 6174 6469 6374  taFrame(featdict
+00054ab0: 322e 7661 6c75 6573 2829 2c69 6e64 6578  2.values(),index
+00054ac0: 3d66 6561 7464 6963 7432 2e6b 6579 7328  =featdict2.keys(
+00054ad0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
 00054ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054af0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00054b00: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
-00054b10: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
-00054b20: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-00054b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054b40: 2020 2020 2020 2020 2746 6561 7475 7265          'Feature
-00054b50: 2049 6d70 6f72 7461 6e63 6573 272c 6173   Importances',as
-00054b60: 6365 6e64 696e 673d 4661 6c73 6529 0d0a  cending=False)..
-00054b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054b80: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00054b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ba0: 2020 2020 2069 6d70 5f66 6561 7475 7265       imp_feature
-00054bb0: 735f 6466 203d 2070 642e 4461 7461 4672  s_df = pd.DataFr
-00054bc0: 616d 6528 706c 6f74 5f6d 6f64 656c 2e67  ame(plot_model.g
-00054bd0: 6574 5f66 6561 7475 7265 5f69 6d70 6f72  et_feature_impor
-00054be0: 7461 6e63 6528 292c 0d0a 2020 2020 2020  tance(),..      
-00054bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054af0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00054b00: 6d6e 7320 3d20 5b27 4665 6174 7572 6520  mns = ['Feature 
+00054b10: 496d 706f 7274 616e 6365 7327 5d29 2e73  Importances']).s
+00054b20: 6f72 745f 7661 6c75 6573 2827 4665 6174  ort_values('Feat
+00054b30: 7572 6520 496d 706f 7274 616e 6365 7327  ure Importances'
+00054b40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00054b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b60: 2020 2020 2020 2020 2020 2061 7363 656e             ascen
+00054b70: 6469 6e67 3d46 616c 7365 290d 0a20 2020  ding=False)..   
+00054b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b90: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00054ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054bb0: 2323 2323 2049 6620 7468 6520 6665 6174  #### If the feat
+00054bc0: 7572 6520 6e61 6d65 7320 6672 6f6d 2058  ure names from X
+00054bd0: 4742 6f6f 7374 2061 6e64 2074 6865 2069  GBoost and the i
+00054be0: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+00054bf0: 7320 6172 6520 7361 6d65 2c0d 0a20 2020  s are same,..   
 00054c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054c10: 2020 636f 6c75 6d6e 733d 5b27 4665 6174    columns=['Feat
-00054c20: 7572 6520 496d 706f 7274 616e 6365 7327  ure Importances'
-00054c30: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00054c10: 2020 2020 2023 2323 2020 2020 2079 6f75       ###     you
+00054c20: 2063 616e 2070 6c6f 7420 6469 6374 6620   can plot dictf 
+00054c30: 696d 6d65 6469 6174 656c 7921 0d0a 2020  immediately!..  
 00054c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054c50: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00054c60: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
-00054c70: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
-00054c80: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-00054c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ca0: 2020 2020 2020 2020 2020 2020 2746 6561              'Fea
-00054cb0: 7475 7265 2049 6d70 6f72 7461 6e63 6573  ture Importances
-00054cc0: 272c 6173 6365 6e64 696e 673d 4661 6c73  ',ascending=Fals
-00054cd0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00054ce0: 2323 2320 4e6f 7720 6472 6177 2074 6865  ### Now draw the
-00054cf0: 2066 6561 7475 7265 2069 6d70 6f72 7461   feature importa
-00054d00: 6e63 6573 2075 7369 6e67 2074 6865 2064  nces using the d
-00054d10: 6174 6120 6672 616d 6520 6162 6f76 6521  ata frame above!
-00054d20: 0d0a 2020 2020 2020 2020 2020 2020 6865  ..            he
-00054d30: 6967 6874 5f73 697a 6520 3d20 350d 0a20  ight_size = 5.. 
-00054d40: 2020 2020 2020 2020 2020 2077 6964 7468             width
-00054d50: 5f73 697a 6520 3d20 3130 0d0a 2020 2020  _size = 10..    
-00054d60: 2020 2020 2020 2020 636f 6c6f 725f 7374          color_st
-00054d70: 7269 6e67 203d 206c 6973 7428 2762 7972  ring = list('byr
-00054d80: 636d 676b 6279 7263 6d67 6b62 7972 636d  cmgkbyrcmgkbyrcm
-00054d90: 676b 6279 7263 6d67 6b27 295b 3a31 355d  gkbyrcmgk')[:15]
-00054da0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00054db0: 696e 7428 2720 2020 2050 6c6f 7474 696e  int('    Plottin
-00054dc0: 6720 4665 6174 7572 6520 496d 706f 7274  g Feature Import
-00054dd0: 616e 6365 7320 746f 2065 7870 6c61 696e  ances to explain
-00054de0: 2074 6865 206f 7574 7075 7420 6f66 206d   the output of m
-00054df0: 6f64 656c 2729 0d0a 2020 2020 2020 2020  odel')..        
-00054e00: 2020 2020 696d 705f 6665 6174 7572 6573      imp_features
-00054e10: 5f64 665b 3a31 355d 2e70 6c6f 7428 6b69  _df[:15].plot(ki
-00054e20: 6e64 3d27 6261 7268 272c 7469 746c 653d  nd='barh',title=
-00054e30: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
-00054e40: 6e63 6573 2066 6f72 2070 7265 6469 6374  nces for predict
-00054e50: 696e 6720 2573 2720 2565 6163 685f 7461  ing %s' %each_ta
-00054e60: 7267 6574 2c0d 0a20 2020 2020 2020 2020  rget,..         
-00054e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054e80: 2020 2020 2020 2020 6669 6773 697a 653d          figsize=
-00054e90: 2877 6964 7468 5f73 697a 652c 2068 6569  (width_size, hei
-00054ea0: 6768 745f 7369 7a65 292c 2063 6f6c 6f72  ght_size), color
-00054eb0: 3d63 6f6c 6f72 5f73 7472 696e 6729 3b0d  =color_string);.
-00054ec0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00054ed0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00054ee0: 696e 7428 2743 6f75 6c64 206e 6f74 2064  int('Could not d
-00054ef0: 7261 7720 6665 6174 7572 6520 696d 706f  raw feature impo
-00054f00: 7274 616e 6365 2070 6c6f 7420 6475 6520  rtance plot due 
-00054f10: 746f 2061 6e20 6572 726f 7227 290d 0a20  to an error').. 
-00054f20: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-00054f30: 2323 2020 2044 2052 2041 2057 2020 5348  ##   D R A W  SH
-00054f40: 4150 2020 5641 4c55 4553 2055 5349 4e47  AP  VALUES USING
-00054f50: 2054 5245 4520 4241 5345 4420 4d4f 4445   TREE BASED MODE
-00054f60: 4c53 2e20 5448 4520 5245 5354 2057 494c  LS. THE REST WIL
-00054f70: 4c20 4e4f 5420 4745 5420 5348 4150 2023  L NOT GET SHAP #
-00054f80: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00054f90: 2020 2020 2069 6620 7665 7262 6f73 6520       if verbose 
-00054fa0: 3e3d 2032 3a0d 0a20 2020 2020 2020 2020  >= 2:..         
-00054fb0: 2020 2070 7269 6e74 2827 5472 7969 6e67     print('Trying
-00054fc0: 2074 6f20 706c 6f74 2053 4841 5020 7661   to plot SHAP va
-00054fd0: 6c75 6573 2069 6620 5348 4150 2069 7320  lues if SHAP is 
-00054fe0: 696e 7374 616c 6c65 6420 696e 2074 6869  installed in thi
-00054ff0: 7320 6d61 6368 696e 652e 2e2e 2729 0d0a  s machine...')..
-00055000: 2020 2020 2020 2020 2020 2020 585f 706c              X_pl
-00055010: 6f74 203d 2058 5f63 765b 3a31 3030 305d  ot = X_cv[:1000]
-00055020: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
-00055030: 706c 6f74 203d 2079 5f63 765b 3a31 3030  plot = y_cv[:100
-00055040: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00055050: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00055060: 2020 2020 2020 6966 206d 6f64 656c 5f6e        if model_n
-00055070: 616d 652e 6c6f 7765 7228 2920 3d3d 2027  ame.lower() == '
-00055080: 6361 7462 6f6f 7374 273a 0d0a 2020 2020  catboost':..    
-00055090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000550a0: 6966 2076 6572 626f 7365 203e 2030 3a0d  if verbose > 0:.
-000550b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000550c0: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-000550d0: 7368 6170 0d0a 2020 2020 2020 2020 2020  shap..          
-000550e0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-000550f0: 6f6d 2063 6174 626f 6f73 7420 696d 706f  om catboost impo
-00055100: 7274 2050 6f6f 6c0d 0a20 2020 2020 2020  rt Pool..       
-00055110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055120: 2073 6861 702e 696e 6974 6a73 2829 0d0a   shap.initjs()..
-00055130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055140: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00054c50: 2020 2020 2020 696d 705f 6665 6174 7572        imp_featur
+00054c60: 6573 5f64 6620 3d20 2070 642e 4461 7461  es_df =  pd.Data
+00054c70: 4672 616d 6528 6469 6374 662e 7661 6c75  Frame(dictf.valu
+00054c80: 6573 2829 2c69 6e64 6578 3d64 6963 7466  es(),index=dictf
+00054c90: 2e6b 6579 7328 292c 0d0a 2020 2020 2020  .keys(),..      
+00054ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054cc0: 2020 636f 6c75 6d6e 7320 3d20 5b27 4665    columns = ['Fe
+00054cd0: 6174 7572 6520 496d 706f 7274 616e 6365  ature Importance
+00054ce0: 7327 5d29 2e73 6f72 745f 7661 6c75 6573  s']).sort_values
+00054cf0: 2827 4665 6174 7572 6520 496d 706f 7274  ('Feature Import
+00054d00: 616e 6365 7327 2c0d 0a20 2020 2020 2020  ances',..       
+00054d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054d30: 2061 7363 656e 6469 6e67 3d46 616c 7365   ascending=False
+00054d40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00054d50: 2020 2065 6c69 6620 6d6f 6465 6c5f 6e61     elif model_na
+00054d60: 6d65 203d 3d20 2746 6f72 6573 7473 273a  me == 'Forests':
+00054d70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00054d80: 2020 2020 2020 696d 705f 6665 6174 7572        imp_featur
+00054d90: 6573 5f64 6620 3d20 7064 2e44 6174 6146  es_df = pd.DataF
+00054da0: 7261 6d65 2870 6c6f 745f 6d6f 6465 6c2e  rame(plot_model.
+00054db0: 6665 6174 7572 655f 696d 706f 7274 616e  feature_importan
+00054dc0: 6365 735f 2c20 636f 6c75 6d6e 733d 5b27  ces_, columns=['
+00054dd0: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
+00054de0: 6365 7327 5d2c 0d0a 2020 2020 2020 2020  ces'],..        
+00054df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054e00: 2069 6e64 6578 3d69 6d70 6f72 7461 6e74   index=important
+00054e10: 5f66 6561 7475 7265 7329 2e73 6f72 745f  _features).sort_
+00054e20: 7661 6c75 6573 2827 4665 6174 7572 6520  values('Feature 
+00054e30: 496d 706f 7274 616e 6365 7327 2c0d 0a20  Importances',.. 
+00054e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054e50: 2020 2020 2020 2020 6173 6365 6e64 696e          ascendin
+00054e60: 673d 4661 6c73 6529 0d0a 2020 2020 2020  g=False)..      
+00054e70: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
+00054e80: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
+00054e90: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
+00054ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00054eb0: 2020 2020 2020 6672 6f6d 2063 6174 626f        from catbo
+00054ec0: 6f73 7420 696d 706f 7274 2050 6f6f 6c0d  ost import Pool.
+00054ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054ee0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00054ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f00: 2020 2069 6d70 5f66 6561 7475 7265 735f     imp_features_
+00054f10: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+00054f20: 6528 706c 6f74 5f6d 6f64 656c 2e67 6574  e(plot_model.get
+00054f30: 5f66 6561 7475 7265 5f69 6d70 6f72 7461  _feature_importa
+00054f40: 6e63 6528 0d0a 2020 2020 2020 2020 2020  nce(..          
+00054f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f60: 2020 2020 2020 2020 2020 506f 6f6c 2858            Pool(X
+00054f70: 5f63 762c 206c 6162 656c 3d79 5f63 762c  _cv, label=y_cv,
+00054f80: 6361 745f 6665 6174 7572 6573 3d69 6d70  cat_features=imp
+00054f90: 5f63 6174 7329 292c 0d0a 2020 2020 2020  _cats)),..      
+00054fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054fb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00054fc0: 6c75 6d6e 733d 5b27 4665 6174 7572 6520  lumns=['Feature 
+00054fd0: 496d 706f 7274 616e 6365 7327 5d2c 0d0a  Importances'],..
+00054fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055000: 2020 2020 696e 6465 783d 696d 706f 7274      index=import
+00055010: 616e 745f 6665 6174 7572 6573 292e 736f  ant_features).so
+00055020: 7274 5f76 616c 7565 7328 0d0a 2020 2020  rt_values(..    
+00055030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055050: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
+00055060: 6e63 6573 272c 6173 6365 6e64 696e 673d  nces',ascending=
+00055070: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+00055080: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00055090: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+000550a0: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
+000550b0: 5f66 6561 7475 7265 735f 6466 203d 2070  _features_df = p
+000550c0: 642e 4461 7461 4672 616d 6528 706c 6f74  d.DataFrame(plot
+000550d0: 5f6d 6f64 656c 2e67 6574 5f66 6561 7475  _model.get_featu
+000550e0: 7265 5f69 6d70 6f72 7461 6e63 6528 292c  re_importance(),
+000550f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00055100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055110: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00055120: 733d 5b27 4665 6174 7572 6520 496d 706f  s=['Feature Impo
+00055130: 7274 616e 6365 7327 5d2c 0d0a 2020 2020  rtances'],..    
+00055140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00055150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055160: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
-00055170: 616c 7565 7320 3d20 706c 6f74 5f6d 6f64  alues = plot_mod
-00055180: 656c 2e67 6574 5f66 6561 7475 7265 5f69  el.get_feature_i
-00055190: 6d70 6f72 7461 6e63 6528 506f 6f6c 2858  mportance(Pool(X
-000551a0: 5f70 6c6f 742c 206c 6162 656c 3d79 5f70  _plot, label=y_p
-000551b0: 6c6f 742c 0d0a 2020 2020 2020 2020 2020  lot,..          
-000551c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551e0: 2020 6361 745f 6665 6174 7572 6573 3d69    cat_features=i
-000551f0: 6d70 5f63 6174 7329 2c74 7970 653d 2253  mp_cats),type="S
-00055200: 6861 7056 616c 7565 7322 290d 0a20 2020  hapValues")..   
-00055210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055220: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-00055230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055240: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
-00055250: 616c 7565 7320 3d20 706c 6f74 5f6d 6f64  alues = plot_mod
-00055260: 656c 2e67 6574 5f66 6561 7475 7265 5f69  el.get_feature_i
-00055270: 6d70 6f72 7461 6e63 6528 7479 7065 3d22  mportance(type="
-00055280: 5368 6170 5661 6c75 6573 2229 0d0a 2020  ShapValues")..  
-00055290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000552a0: 2020 2020 2020 7368 6170 5f64 6620 3d20        shap_df = 
-000552b0: 7064 2e44 6174 6146 7261 6d65 286e 702e  pd.DataFrame(np.
-000552c0: 635f 5b58 5f70 6c6f 742e 7661 6c75 6573  c_[X_plot.values
-000552d0: 2c79 5f70 6c6f 745d 2c63 6f6c 756d 6e73  ,y_plot],columns
-000552e0: 3d5b 6c69 7374 2858 5f70 6c6f 7429 2b5b  =[list(X_plot)+[
-000552f0: 6561 6368 5f74 6172 6765 745d 5d29 0d0a  each_target]])..
-00055300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055310: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-00055320: 7479 7065 203d 3d20 274d 756c 7469 5f43  type == 'Multi_C
-00055330: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
-00055340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055350: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00055360: 2065 6163 685f 6920 696e 2072 616e 6765   each_i in range
-00055370: 286c 656e 2863 6c61 7373 6573 2929 3a0d  (len(classes)):.
-00055380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000553a0: 2023 2323 2054 6869 7320 6973 206e 6565   ### This is nee
-000553b0: 6465 6420 666f 7220 4361 7462 6f6f 7374  ded for Catboost
-000553c0: 206d 6f64 656c 7320 6275 7420 6974 2069   models but it i
-000553d0: 7320 7665 7279 2063 756d 6265 7273 6f6d  s very cumbersom
-000553e0: 6521 0d0a 2020 2020 2020 2020 2020 2020  e!..            
-000553f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055400: 2020 2020 2323 2320 596f 7520 6e65 6564      ### You need
-00055410: 2074 6f20 6379 636c 6520 7468 726f 7567   to cycle throug
-00055420: 6820 6d75 6c74 6970 6c65 2076 616c 7565  h multiple value
-00055430: 7320 6f66 2063 6c61 7373 6573 2066 726f  s of classes fro
-00055440: 6d20 3020 746f 206e 5f63 6c61 7373 6573  m 0 to n_classes
-00055450: 2d31 2e0d 0a20 2020 2020 2020 2020 2020  -1...           
-00055460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055470: 2020 2020 2023 2323 2054 6865 7265 2069       ### There i
-00055480: 7320 6e6f 2077 6179 2074 6f20 666f 7263  s no way to forc
-00055490: 6520 6974 2069 6e20 616e 2041 7820 3d3e  e it in an Ax =>
-000554a0: 2073 6f20 796f 7520 6172 6520 7374 7563   so you are stuc
-000554b0: 6b20 7072 696e 7469 6e67 206d 756c 7469  k printing multi
-000554c0: 706c 6520 6368 6172 7473 0d0a 2020 2020  ple charts..    
-000554d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000554e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-000554f0: 6669 6775 7265 2829 0d0a 2020 2020 2020  figure()..      
-00055500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055510: 2020 2020 2020 2020 2020 7368 6170 2e73            shap.s
-00055520: 756d 6d61 7279 5f70 6c6f 7428 7368 6170  ummary_plot(shap
-00055530: 5f76 616c 7565 735b 3a2c 6561 6368 5f69  _values[:,each_i
-00055540: 2c3a 5d2c 2073 6861 705f 6466 2c20 706c  ,:], shap_df, pl
-00055550: 6f74 5f74 7970 653d 2276 696f 6c69 6e22  ot_type="violin"
-00055560: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00055570: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00055580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00055590: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-000555a0: 742e 6669 6775 7265 2829 0d0a 2020 2020  t.figure()..    
-000555b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000555c0: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
-000555d0: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
-000555e0: 616c 7565 732c 2073 6861 705f 6466 2c20  alues, shap_df, 
-000555f0: 706c 6f74 5f74 7970 653d 2276 696f 6c69  plot_type="violi
-00055600: 6e22 290d 0a20 2020 2020 2020 2020 2020  n")..           
-00055610: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00055620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055630: 585f 706c 6f74 203d 2058 5f74 6573 745b  X_plot = X_test[
-00055640: 3a31 3030 305d 0d0a 2020 2020 2020 2020  :1000]..        
-00055650: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00055660: 7274 2073 6861 700d 0a20 2020 2020 2020  rt shap..       
-00055670: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00055680: 702e 696e 6974 6a73 2829 0d0a 2020 2020  p.initjs()..    
-00055690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000556a0: 2323 2323 2054 6869 7320 776f 726b 7320  #### This works 
-000556b0: 7765 6c6c 2066 6f72 2052 4643 2061 6e64  well for RFC and
-000556c0: 2058 4742 6f6f 7374 2066 6f72 206d 756c   XGBoost for mul
-000556d0: 7469 636c 6173 7320 7072 6f62 6c65 6d73  ticlass problems
-000556e0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
-000556f0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-00055700: 2054 6869 7320 706c 6f74 7320 6120 7669   This plots a vi
-00055710: 6f6c 696e 2070 6c6f 7420 7468 6174 2069  olin plot that i
-00055720: 7320 6469 6666 6572 656e 7420 6672 6f6d  s different from
-00055730: 2074 6865 2062 6172 2063 6861 7274 2061   the bar chart a
-00055740: 626f 7665 210d 0a20 2020 2020 2020 2020  bove!..         
-00055750: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00055760: 5468 6973 2064 6f65 7320 6e6f 7420 776f  This does not wo
-00055770: 726b 2066 6f72 2043 6174 426f 6f73 7420  rk for CatBoost 
-00055780: 736f 2074 7279 2073 6f6d 6574 6869 6e67  so try something
-00055790: 2065 6c73 6521 0d0a 2020 2020 2020 2020   else!..        
-000557a0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-000557b0: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
-000557c0: 2920 3d3d 2027 6c69 6e65 6172 273a 0d0a  ) == 'linear':..
-000557d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000557e0: 2020 2020 2020 2020 6578 706c 6169 6e65          explaine
-000557f0: 7220 3d20 7368 6170 2e4c 696e 6561 7245  r = shap.LinearE
-00055800: 7870 6c61 696e 6572 2870 6c6f 745f 6d6f  xplainer(plot_mo
-00055810: 6465 6c2c 2058 5f70 6c6f 742c 2066 6561  del, X_plot, fea
-00055820: 7475 7265 5f64 6570 656e 6465 6e63 653d  ture_dependence=
-00055830: 2269 6e64 6570 656e 6465 6e74 2229 0d0a  "independent")..
-00055840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055850: 2020 2020 2020 2020 7368 6170 5f76 616c          shap_val
-00055860: 7565 7320 3d20 6578 706c 6169 6e65 722e  ues = explainer.
-00055870: 7368 6170 5f76 616c 7565 7328 585f 706c  shap_values(X_pl
-00055880: 6f74 290d 0a20 2020 2020 2020 2020 2020  ot)..           
-00055890: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
-000558a0: 2e66 6967 7572 6528 290d 0a20 2020 2020  .figure()..     
-000558b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000558c0: 2020 2073 6861 702e 7375 6d6d 6172 795f     shap.summary_
-000558d0: 706c 6f74 2873 6861 705f 7661 6c75 6573  plot(shap_values
-000558e0: 2c20 585f 706c 6f74 2c20 706c 6f74 5f74  , X_plot, plot_t
-000558f0: 7970 653d 2262 6172 2229 0d0a 2020 2020  ype="bar")..    
-00055900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055910: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-00055920: 2021 3d20 2752 6567 7265 7373 696f 6e27   != 'Regression'
-00055930: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00055940: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00055950: 6c74 2e66 6967 7572 6528 290d 0a20 2020  lt.figure()..   
+00055160: 2020 2020 696e 6465 783d 696d 706f 7274      index=import
+00055170: 616e 745f 6665 6174 7572 6573 292e 736f  ant_features).so
+00055180: 7274 5f76 616c 7565 7328 0d0a 2020 2020  rt_values(..    
+00055190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000551a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000551b0: 2020 2020 2746 6561 7475 7265 2049 6d70      'Feature Imp
+000551c0: 6f72 7461 6e63 6573 272c 6173 6365 6e64  ortances',ascend
+000551d0: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
+000551e0: 2020 2020 2020 2020 2323 2320 4e6f 7720          ### Now 
+000551f0: 6472 6177 2074 6865 2066 6561 7475 7265  draw the feature
+00055200: 2069 6d70 6f72 7461 6e63 6573 2075 7369   importances usi
+00055210: 6e67 2074 6865 2064 6174 6120 6672 616d  ng the data fram
+00055220: 6520 6162 6f76 6521 0d0a 2020 2020 2020  e above!..      
+00055230: 2020 2020 2020 6865 6967 6874 5f73 697a        height_siz
+00055240: 6520 3d20 350d 0a20 2020 2020 2020 2020  e = 5..         
+00055250: 2020 2077 6964 7468 5f73 697a 6520 3d20     width_size = 
+00055260: 3130 0d0a 2020 2020 2020 2020 2020 2020  10..            
+00055270: 636f 6c6f 725f 7374 7269 6e67 203d 206c  color_string = l
+00055280: 6973 7428 2762 7972 636d 676b 6279 7263  ist('byrcmgkbyrc
+00055290: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+000552a0: 6b27 295b 3a31 355d 0d0a 2020 2020 2020  k')[:15]..      
+000552b0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+000552c0: 2050 6c6f 7474 696e 6720 4665 6174 7572   Plotting Featur
+000552d0: 6520 496d 706f 7274 616e 6365 7320 746f  e Importances to
+000552e0: 2065 7870 6c61 696e 2074 6865 206f 7574   explain the out
+000552f0: 7075 7420 6f66 206d 6f64 656c 2729 0d0a  put of model')..
+00055300: 2020 2020 2020 2020 2020 2020 696d 705f              imp_
+00055310: 6665 6174 7572 6573 5f64 665b 3a31 355d  features_df[:15]
+00055320: 2e70 6c6f 7428 6b69 6e64 3d27 6261 7268  .plot(kind='barh
+00055330: 272c 7469 746c 653d 2746 6561 7475 7265  ',title='Feature
+00055340: 2049 6d70 6f72 7461 6e63 6573 2066 6f72   Importances for
+00055350: 2070 7265 6469 6374 696e 6720 2573 2720   predicting %s' 
+00055360: 2565 6163 685f 7461 7267 6574 2c0d 0a20  %each_target,.. 
+00055370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055390: 6669 6773 697a 653d 2877 6964 7468 5f73  figsize=(width_s
+000553a0: 697a 652c 2068 6569 6768 745f 7369 7a65  ize, height_size
+000553b0: 292c 2063 6f6c 6f72 3d63 6f6c 6f72 5f73  ), color=color_s
+000553c0: 7472 696e 6729 3b0d 0a20 2020 2020 2020  tring);..       
+000553d0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+000553e0: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
+000553f0: 6c64 206e 6f74 2064 7261 7720 6665 6174  ld not draw feat
+00055400: 7572 6520 696d 706f 7274 616e 6365 2070  ure importance p
+00055410: 6c6f 7420 6475 6520 746f 2061 6e20 6572  lot due to an er
+00055420: 726f 7227 290d 0a20 2020 2020 2020 2023  ror')..        #
+00055430: 2323 2323 2323 2323 2323 2020 2044 2052  ##########   D R
+00055440: 2041 2057 2020 5348 4150 2020 5641 4c55   A W  SHAP  VALU
+00055450: 4553 2055 5349 4e47 2054 5245 4520 4241  ES USING TREE BA
+00055460: 5345 4420 4d4f 4445 4c53 2e20 5448 4520  SED MODELS. THE 
+00055470: 5245 5354 2057 494c 4c20 4e4f 5420 4745  REST WILL NOT GE
+00055480: 5420 5348 4150 2023 2323 2323 2323 2323  T SHAP #########
+00055490: 2323 230d 0a20 2020 2020 2020 2069 6620  ###..        if 
+000554a0: 7665 7262 6f73 6520 3e3d 2032 3a0d 0a20  verbose >= 2:.. 
+000554b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000554c0: 2827 5472 7969 6e67 2074 6f20 706c 6f74  ('Trying to plot
+000554d0: 2053 4841 5020 7661 6c75 6573 2069 6620   SHAP values if 
+000554e0: 5348 4150 2069 7320 696e 7374 616c 6c65  SHAP is installe
+000554f0: 6420 696e 2074 6869 7320 6d61 6368 696e  d in this machin
+00055500: 652e 2e2e 2729 0d0a 2020 2020 2020 2020  e...')..        
+00055510: 2020 2020 585f 706c 6f74 203d 2058 5f63      X_plot = X_c
+00055520: 765b 3a31 3030 305d 0d0a 2020 2020 2020  v[:1000]..      
+00055530: 2020 2020 2020 795f 706c 6f74 203d 2079        y_plot = y
+00055540: 5f63 765b 3a31 3030 305d 0d0a 2020 2020  _cv[:1000]..    
+00055550: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00055560: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00055570: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
+00055580: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
+00055590: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+000555a0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+000555b0: 7365 203e 2030 3a0d 0a20 2020 2020 2020  se > 0:..       
+000555c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000555d0: 2069 6d70 6f72 7420 7368 6170 0d0a 2020   import shap..  
+000555e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000555f0: 2020 2020 2020 6672 6f6d 2063 6174 626f        from catbo
+00055600: 6f73 7420 696d 706f 7274 2050 6f6f 6c0d  ost import Pool.
+00055610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055620: 2020 2020 2020 2020 2073 6861 702e 696e           shap.in
+00055630: 6974 6a73 2829 0d0a 2020 2020 2020 2020  itjs()..        
+00055640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055650: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00055660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055670: 2020 7368 6170 5f76 616c 7565 7320 3d20    shap_values = 
+00055680: 706c 6f74 5f6d 6f64 656c 2e67 6574 5f66  plot_model.get_f
+00055690: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
+000556a0: 6528 506f 6f6c 2858 5f70 6c6f 742c 206c  e(Pool(X_plot, l
+000556b0: 6162 656c 3d79 5f70 6c6f 742c 0d0a 2020  abel=y_plot,..  
+000556c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000556d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000556e0: 2020 2020 2020 2020 2020 6361 745f 6665            cat_fe
+000556f0: 6174 7572 6573 3d69 6d70 5f63 6174 7329  atures=imp_cats)
+00055700: 2c74 7970 653d 2253 6861 7056 616c 7565  ,type="ShapValue
+00055710: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
+00055720: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00055730: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00055740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055750: 2020 7368 6170 5f76 616c 7565 7320 3d20    shap_values = 
+00055760: 706c 6f74 5f6d 6f64 656c 2e67 6574 5f66  plot_model.get_f
+00055770: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
+00055780: 6528 7479 7065 3d22 5368 6170 5661 6c75  e(type="ShapValu
+00055790: 6573 2229 0d0a 2020 2020 2020 2020 2020  es")..          
+000557a0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+000557b0: 6170 5f64 6620 3d20 7064 2e44 6174 6146  ap_df = pd.DataF
+000557c0: 7261 6d65 286e 702e 635f 5b58 5f70 6c6f  rame(np.c_[X_plo
+000557d0: 742e 7661 6c75 6573 2c79 5f70 6c6f 745d  t.values,y_plot]
+000557e0: 2c63 6f6c 756d 6e73 3d5b 6c69 7374 2858  ,columns=[list(X
+000557f0: 5f70 6c6f 7429 2b5b 6561 6368 5f74 6172  _plot)+[each_tar
+00055800: 6765 745d 5d29 0d0a 2020 2020 2020 2020  get]])..        
+00055810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055820: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+00055830: 274d 756c 7469 5f43 6c61 7373 6966 6963  'Multi_Classific
+00055840: 6174 696f 6e27 3a0d 0a20 2020 2020 2020  ation':..       
+00055850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055860: 2020 2020 2066 6f72 2065 6163 685f 6920       for each_i 
+00055870: 696e 2072 616e 6765 286c 656e 2863 6c61  in range(len(cla
+00055880: 7373 6573 2929 3a0d 0a20 2020 2020 2020  sses)):..       
+00055890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000558a0: 2020 2020 2020 2020 2023 2323 2054 6869           ### Thi
+000558b0: 7320 6973 206e 6565 6465 6420 666f 7220  s is needed for 
+000558c0: 4361 7462 6f6f 7374 206d 6f64 656c 7320  Catboost models 
+000558d0: 6275 7420 6974 2069 7320 7665 7279 2063  but it is very c
+000558e0: 756d 6265 7273 6f6d 6521 0d0a 2020 2020  umbersome!..    
+000558f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055900: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00055910: 596f 7520 6e65 6564 2074 6f20 6379 636c  You need to cycl
+00055920: 6520 7468 726f 7567 6820 6d75 6c74 6970  e through multip
+00055930: 6c65 2076 616c 7565 7320 6f66 2063 6c61  le values of cla
+00055940: 7373 6573 2066 726f 6d20 3020 746f 206e  sses from 0 to n
+00055950: 5f63 6c61 7373 6573 2d31 2e0d 0a20 2020  _classes-1...   
 00055960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055970: 2020 2020 2020 2020 2073 6861 702e 7375           shap.su
-00055980: 6d6d 6172 795f 706c 6f74 2873 6861 705f  mmary_plot(shap_
-00055990: 7661 6c75 6573 2c20 585f 706c 6f74 290d  values, X_plot).
-000559a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000559b0: 2020 2020 2065 6c69 6620 6d6f 6465 6c5f       elif model_
-000559c0: 6e61 6d65 2e6c 6f77 6572 2829 203d 3d20  name.lower() == 
-000559d0: 2766 6f72 6573 7473 273a 0d0a 2020 2020  'forests':..    
+00055970: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00055980: 2054 6865 7265 2069 7320 6e6f 2077 6179   There is no way
+00055990: 2074 6f20 666f 7263 6520 6974 2069 6e20   to force it in 
+000559a0: 616e 2041 7820 3d3e 2073 6f20 796f 7520  an Ax => so you 
+000559b0: 6172 6520 7374 7563 6b20 7072 696e 7469  are stuck printi
+000559c0: 6e67 206d 756c 7469 706c 6520 6368 6172  ng multiple char
+000559d0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
 000559e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000559f0: 2020 2020 2323 2323 2054 6869 7320 776f      #### This wo
-00055a00: 726b 7320 7765 6c6c 2066 6f72 2052 4643  rks well for RFC
-00055a10: 2061 6e64 2058 4742 6f6f 7374 2066 6f72   and XGBoost for
-00055a20: 206d 756c 7469 636c 6173 7320 7072 6f62   multiclass prob
-00055a30: 6c65 6d73 2023 2323 2323 0d0a 2020 2020  lems #####..    
-00055a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055a50: 2020 2020 2323 2320 4974 2077 6f72 6b73      ### It works
-00055a60: 2066 6f72 2062 6f74 6820 6269 6e61 7279   for both binary
-00055a70: 2061 6e64 206d 756c 7469 2d63 6c61 7373   and multi-class
-00055a80: 2070 726f 626c 656d 7320 2323 2323 2323   problems ######
-00055a90: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00055aa0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00055ab0: 486f 7765 7665 722c 2069 7420 646f 6573  However, it does
-00055ac0: 204e 4f54 2077 6f72 6b20 666f 7220 4361   NOT work for Ca
-00055ad0: 7442 6f6f 7374 206d 6f64 656c 7321 0d0a  tBoost models!..
-00055ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055af0: 2020 2020 2020 2020 6578 706c 6169 6e65          explaine
-00055b00: 7220 3d20 7368 6170 2e54 7265 6545 7870  r = shap.TreeExp
-00055b10: 6c61 696e 6572 2870 6c6f 745f 6d6f 6465  lainer(plot_mode
-00055b20: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-00055b30: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00055b40: 5f76 616c 7565 7320 3d20 6578 706c 6169  _values = explai
-00055b50: 6e65 722e 7368 6170 5f76 616c 7565 7328  ner.shap_values(
-00055b60: 585f 706c 6f74 290d 0a20 2020 2020 2020  X_plot)..       
-00055b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055b80: 2070 6c74 2e66 6967 7572 6528 290d 0a20   plt.figure().. 
-00055b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ba0: 2020 2020 2020 2073 6861 702e 7375 6d6d         shap.summ
-00055bb0: 6172 795f 706c 6f74 2873 6861 705f 7661  ary_plot(shap_va
-00055bc0: 6c75 6573 2c20 585f 706c 6f74 2c20 706c  lues, X_plot, pl
-00055bd0: 6f74 5f74 7970 653d 2262 6172 2229 0d0a  ot_type="bar")..
-00055be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055bf0: 2020 2020 2020 2020 2323 2320 5468 6572          ### Ther
-00055c00: 6520 6973 206e 6f20 7369 6e67 6c65 2076  e is no single v
-00055c10: 696f 6c69 6e20 706c 6f74 2066 6f72 2052  iolin plot for R
-00055c20: 616e 646f 6d20 466f 7265 7374 7320 696e  andom Forests in
-00055c30: 2053 4841 500d 0a20 2020 2020 2020 2020   SHAP..         
-00055c40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00055c50: 2323 2320 4974 2061 6374 7561 6c6c 7920  ### It actually 
-00055c60: 6861 7320 6d75 6c74 6970 6c65 206f 7574  has multiple out
-00055c70: 7075 7473 2073 6f20 796f 7520 6361 6e20  puts so you can 
-00055c80: 6c6f 6f70 2074 6872 6f75 6768 2069 7420  loop through it 
-00055c90: 666f 7220 6561 6368 2063 6c61 7373 0d0a  for each class..
+000559f0: 2020 2020 706c 742e 6669 6775 7265 2829      plt.figure()
+00055a00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00055a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055a20: 2020 7368 6170 2e73 756d 6d61 7279 5f70    shap.summary_p
+00055a30: 6c6f 7428 7368 6170 5f76 616c 7565 735b  lot(shap_values[
+00055a40: 3a2c 6561 6368 5f69 2c3a 5d2c 2073 6861  :,each_i,:], sha
+00055a50: 705f 6466 2c20 706c 6f74 5f74 7970 653d  p_df, plot_type=
+00055a60: 2276 696f 6c69 6e22 290d 0a20 2020 2020  "violin")..     
+00055a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055a80: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00055a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055aa0: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
+00055ab0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00055ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055ad0: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
+00055ae0: 7428 7368 6170 5f76 616c 7565 732c 2073  t(shap_values, s
+00055af0: 6861 705f 6466 2c20 706c 6f74 5f74 7970  hap_df, plot_typ
+00055b00: 653d 2276 696f 6c69 6e22 290d 0a20 2020  e="violin")..   
+00055b10: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00055b20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00055b30: 2020 2020 2020 2020 585f 706c 6f74 203d          X_plot =
+00055b40: 2058 5f74 6573 745b 3a31 3030 305d 0d0a   X_test[:1000]..
+00055b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055b60: 2020 2020 696d 706f 7274 2073 6861 700d      import shap.
+00055b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055b80: 2020 2020 2073 6861 702e 696e 6974 6a73       shap.initjs
+00055b90: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00055ba0: 2020 2020 2020 2020 2323 2323 2054 6869          #### Thi
+00055bb0: 7320 776f 726b 7320 7765 6c6c 2066 6f72  s works well for
+00055bc0: 2052 4643 2061 6e64 2058 4742 6f6f 7374   RFC and XGBoost
+00055bd0: 2066 6f72 206d 756c 7469 636c 6173 7320   for multiclass 
+00055be0: 7072 6f62 6c65 6d73 2023 2323 2323 0d0a  problems #####..
+00055bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055c00: 2020 2020 2323 2323 2054 6869 7320 706c      #### This pl
+00055c10: 6f74 7320 6120 7669 6f6c 696e 2070 6c6f  ots a violin plo
+00055c20: 7420 7468 6174 2069 7320 6469 6666 6572  t that is differ
+00055c30: 656e 7420 6672 6f6d 2074 6865 2062 6172  ent from the bar
+00055c40: 2063 6861 7274 2061 626f 7665 210d 0a20   chart above!.. 
+00055c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055c60: 2020 2023 2323 2320 5468 6973 2064 6f65     #### This doe
+00055c70: 7320 6e6f 7420 776f 726b 2066 6f72 2043  s not work for C
+00055c80: 6174 426f 6f73 7420 736f 2074 7279 2073  atBoost so try s
+00055c90: 6f6d 6574 6869 6e67 2065 6c73 6521 0d0a  omething else!..
 00055ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055cb0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-00055cc0: 7479 7065 2021 3d20 2752 6567 7265 7373  type != 'Regress
-00055cd0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+00055cb0: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
+00055cc0: 652e 6c6f 7765 7228 2920 3d3d 2027 6c69  e.lower() == 'li
+00055cd0: 6e65 6172 273a 0d0a 2020 2020 2020 2020  near':..        
 00055ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055cf0: 2020 2066 6f72 2065 6163 685f 6920 696e     for each_i in
-00055d00: 2072 616e 6765 286c 656e 2863 6c61 7373   range(len(class
-00055d10: 6573 2929 3a0d 0a20 2020 2020 2020 2020  es)):..         
-00055d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d30: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
-00055d40: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00055cf0: 6578 706c 6169 6e65 7220 3d20 7368 6170  explainer = shap
+00055d00: 2e4c 696e 6561 7245 7870 6c61 696e 6572  .LinearExplainer
+00055d10: 2870 6c6f 745f 6d6f 6465 6c2c 2058 5f70  (plot_model, X_p
+00055d20: 6c6f 742c 2066 6561 7475 7265 5f64 6570  lot, feature_dep
+00055d30: 656e 6465 6e63 653d 2269 6e64 6570 656e  endence="indepen
+00055d40: 6465 6e74 2229 0d0a 2020 2020 2020 2020  dent")..        
 00055d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d60: 2020 2020 2073 6861 702e 7375 6d6d 6172       shap.summar
-00055d70: 795f 706c 6f74 2873 6861 705f 7661 6c75  y_plot(shap_valu
-00055d80: 6573 5b65 6163 685f 695d 2c20 585f 706c  es[each_i], X_pl
-00055d90: 6f74 290d 0a20 2020 2020 2020 2020 2020  ot)..           
-00055da0: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
-00055db0: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
-00055dc0: 203d 3d20 2778 6762 6f6f 7374 273a 0d0a   == 'xgboost':..
-00055dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055de0: 2020 2020 2020 2020 2323 2323 2054 6869          #### Thi
-00055df0: 7320 776f 726b 7320 7765 6c6c 2066 6f72  s works well for
-00055e00: 2052 4643 2061 6e64 2058 4742 6f6f 7374   RFC and XGBoost
-00055e10: 2066 6f72 206d 756c 7469 636c 6173 7320   for multiclass 
-00055e20: 7072 6f62 6c65 6d73 2023 2323 2323 0d0a  problems #####..
-00055e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055e40: 2020 2020 2020 2020 2323 2320 4974 2077          ### It w
-00055e50: 6f72 6b73 2066 6f72 2062 6f74 6820 6269  orks for both bi
-00055e60: 6e61 7279 2061 6e64 206d 756c 7469 2d63  nary and multi-c
-00055e70: 6c61 7373 2070 726f 626c 656d 7320 2323  lass problems ##
-00055e80: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-00055e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ea0: 2323 2320 486f 7765 7665 722c 2069 7420  ### However, it 
-00055eb0: 646f 6573 204e 4f54 2077 6f72 6b20 666f  does NOT work fo
-00055ec0: 7220 4361 7442 6f6f 7374 206d 6f64 656c  r CatBoost model
-00055ed0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-00055ee0: 2020 2020 2020 2020 2020 2020 6578 706c              expl
-00055ef0: 6169 6e65 7220 3d20 7368 6170 2e54 7265  ainer = shap.Tre
-00055f00: 6545 7870 6c61 696e 6572 2870 6c6f 745f  eExplainer(plot_
-00055f10: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
-00055f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055f30: 7368 6170 5f76 616c 7565 7320 3d20 6578  shap_values = ex
-00055f40: 706c 6169 6e65 722e 7368 6170 5f76 616c  plainer.shap_val
-00055f50: 7565 7328 585f 706c 6f74 290d 0a20 2020  ues(X_plot)..   
-00055f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055f70: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
-00055f80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00055f90: 2020 2020 2020 2020 2020 2073 6861 702e             shap.
-00055fa0: 7375 6d6d 6172 795f 706c 6f74 2873 6861  summary_plot(sha
-00055fb0: 705f 7661 6c75 6573 2c20 585f 706c 6f74  p_values, X_plot
-00055fc0: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
-00055fd0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00055fe0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00055ff0: 6f64 656c 7479 7065 2021 3d20 2752 6567  odeltype != 'Reg
-00056000: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
-00056010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056020: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
-00056030: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00056040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056050: 2073 6861 702e 7375 6d6d 6172 795f 706c   shap.summary_pl
-00056060: 6f74 2873 6861 705f 7661 6c75 6573 2c20  ot(shap_values, 
-00056070: 585f 706c 6f74 290d 0a20 2020 2020 2020  X_plot)..       
-00056080: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-00056090: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000560a0: 696e 7428 2743 6f75 6c64 206e 6f74 2070  int('Could not p
-000560b0: 6c6f 7420 5348 4150 2076 616c 7565 7320  lot SHAP values 
-000560c0: 7369 6e63 6520 5348 4150 2069 7320 6e6f  since SHAP is no
-000560d0: 7420 696e 7374 616c 6c65 6420 6f72 2063  t installed or c
-000560e0: 6f75 6c64 206e 6f74 2069 6d70 6f72 7420  ould not import 
-000560f0: 5348 4150 2069 6e20 7468 6973 206d 6163  SHAP in this mac
-00056100: 6869 6e65 2729 0d0a 2020 2020 656c 7365  hine')..    else
-00056110: 3a0d 0a20 2020 2020 2020 2023 2323 2323  :..        #####
-00056120: 2323 2323 2323 2320 4e6f 2050 6c6f 7474  ####### No Plott
-00056130: 696e 6720 6665 6174 7572 6520 696d 706f  ing feature impo
-00056140: 7274 616e 6365 7320 666f 7220 4d75 6c74  rtances for Mult
-00056150: 692d 4c61 6265 6c20 7072 6f62 6c65 6d73  i-Label problems
-00056160: 2023 2323 2323 2323 2323 2323 2323 230d   ##############.
-00056170: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-00056180: 2020 2020 4e6f 2066 6561 7475 7265 2069      No feature i
-00056190: 6d70 6f72 7461 6e63 6520 706c 6f74 7320  mportance plots 
-000561a0: 6176 6169 6c61 626c 6520 666f 7220 4d75  available for Mu
-000561b0: 6c74 692d 4c61 6265 6c20 7072 6f62 6c65  lti-Label proble
-000561c0: 6d73 2729 0d0a 2020 2020 7072 696e 7428  ms')..    print(
-000561d0: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
-000561e0: 2050 2052 2045 2044 2049 2043 2054 2049   P R E D I C T I
-000561f0: 204f 204e 2020 4f20 4e20 2054 2045 2053   O N  O N  T E S
-00056200: 2054 2020 2043 204f 204d 2050 204c 2045   T   C O M P L E
-00056210: 2054 2045 2044 2020 2323 2323 2323 2323   T E D  ########
-00056220: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-00056230: 2070 7269 6e74 2827 2020 2020 5469 6d65   print('    Time
-00056240: 2074 616b 656e 2074 6875 7320 6661 7220   taken thus far 
-00056250: 2869 6e20 7365 636f 6e64 7329 203d 2025  (in seconds) = %
-00056260: 302e 3066 2720 2528 7469 6d65 2e74 696d  0.0f' %(time.tim
-00056270: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
-00056280: 0d0a 2020 2020 2323 2020 5772 6974 6520  ..    ##  Write 
-00056290: 7468 6520 7465 7374 2061 6e64 2073 7562  the test and sub
-000562a0: 6d69 7373 696f 6e20 6669 6c65 7320 746f  mission files to
-000562b0: 2064 6973 6b20 2323 230d 0a20 2020 2070   disk ###..    p
-000562c0: 7269 6e74 2827 5772 6974 696e 6720 4f75  rint('Writing Ou
-000562d0: 7470 7574 2066 696c 6573 2074 6f20 6469  tput files to di
-000562e0: 736b 2e2e 2e27 290d 0a20 2020 2023 2323  sk...')..    ###
-000562f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056340: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00056350: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00056360: 6528 7465 7374 6d2c 2073 7472 293a 0d0a  e(testm, str):..
-00056370: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00056380: 2020 2020 2020 2020 2020 7772 6974 655f            write_
-00056390: 6669 6c65 5f74 6f5f 666f 6c64 6572 2874  file_to_folder(t
-000563a0: 6573 746d 2c20 6561 6368 5f74 6172 6765  estm, each_targe
-000563b0: 742c 2065 6163 685f 7461 7267 6574 2b27  t, each_target+'
-000563c0: 5f27 2b6d 6f64 656c 7479 7065 2b27 5f27  _'+modeltype+'_'
-000563d0: 2b27 7465 7374 5f6d 6f64 6966 6965 642e  +'test_modified.
-000563e0: 6373 7627 290d 0a20 2020 2020 2020 2020  csv')..         
-000563f0: 2020 2023 2323 2323 2020 2044 2052 2041     #####   D R A
-00056400: 2057 2020 204b 2044 2045 2020 5020 4c20   W   K D E  P L 
-00056410: 4f20 5420 5320 2020 464f 5220 5052 4f42  O T S   FOR PROB
-00056420: 4142 494c 4954 5920 4f46 2050 5245 4449  ABILITY OF PREDI
-00056430: 4354 494f 4e53 202d 2076 6572 7920 7573  CTIONS - very us
-00056440: 6566 756c 2120 2323 2323 2323 2323 230d  eful! #########.
-00056450: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00056460: 6d6f 6465 6c74 7970 6520 213d 2027 5265  modeltype != 'Re
-00056470: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-00056480: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-00056490: 6572 626f 7365 203e 3d20 323a 0d0a 2020  erbose >= 2:..  
-000564a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000564b0: 2020 7465 7374 6d5b 7072 6f62 615f 636f    testm[proba_co
-000564c0: 6c73 5d2e 706c 6f74 286b 696e 643d 276b  ls].plot(kind='k
-000564d0: 6465 272c 6669 6773 697a 653d 2831 302c  de',figsize=(10,
-000564e0: 3629 2c0d 0a20 2020 2020 2020 2020 2020  6),..           
-000564f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056500: 2020 2020 2020 2020 2074 6974 6c65 3d27           title='
-00056510: 5072 6564 6963 7469 7665 2050 726f 6261  Predictive Proba
-00056520: 6269 6c69 7479 2044 656e 7369 7479 2043  bility Density C
-00056530: 6861 7274 2077 6974 6820 7375 6767 6573  hart with sugges
-00056540: 7465 6420 7468 7265 7368 6f6c 6420 696e  ted threshold in
-00056550: 2072 6564 2729 0d0a 2020 2020 2020 2020   red')..        
-00056560: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00056570: 6178 766c 696e 6528 783d 6d5f 7468 7265  axvline(x=m_thre
-00056580: 7368 2c20 636f 6c6f 723d 2772 272c 206c  sh, color='r', l
-00056590: 696e 6573 7479 6c65 3d27 2d2d 2729 3b0d  inestyle='--');.
-000565a0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-000565b0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-000565c0: 696e 7428 2720 2020 2045 7272 6f72 3a20  int('    Error: 
-000565d0: 4e6f 7420 6162 6c65 2074 6f20 7361 7665  Not able to save
-000565e0: 2074 6573 7420 6d6f 6469 6669 6564 2066   test modified f
-000565f0: 696c 652e 2053 6b69 7070 696e 672e 2e2e  ile. Skipping...
-00056600: 2729 0d0a 2020 2020 2323 2323 2323 2323  ')..    ########
-00056610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056660: 2323 2323 230d 0a20 2020 2069 6620 6973  #####..    if is
-00056670: 696e 7374 616e 6365 2873 616d 706c 655f  instance(sample_
-00056680: 7375 626d 6973 7369 6f6e 2c20 7374 7229  submission, str)
-00056690: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
-000566a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000566b0: 6c65 6e28 6964 5f63 6f6c 7329 203e 2030  len(id_cols) > 0
-000566c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000566d0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
-000566e0: 7369 6f6e 203d 2074 6573 746d 5b69 645f  sion = testm[id_
-000566f0: 636f 6c73 5d0d 0a20 2020 2020 2020 2020  cols]..         
-00056700: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00056710: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00056720: 5f73 7562 6d69 7373 696f 6e20 3d20 7064  _submission = pd
-00056730: 2e44 6174 6146 7261 6d65 2869 6e64 6578  .DataFrame(index
-00056740: 3d74 6573 746d 2e69 6e64 6578 2c63 6f6c  =testm.index,col
-00056750: 756d 6e73 3d5b 5d29 0d0a 2020 2020 2020  umns=[])..      
-00056760: 2020 2020 2020 6966 206c 656e 2874 6172        if len(tar
-00056770: 6765 7429 203d 3d20 313a 0d0a 2020 2020  get) == 1:..    
-00056780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056790: 7361 6d70 6c65 5f73 7562 6d69 7373 696f  sample_submissio
-000567a0: 6e5b 6561 6368 5f74 6172 6765 745d 203d  n[each_target] =
-000567b0: 2074 6573 746d 5b65 6163 685f 7461 7267   testm[each_targ
-000567c0: 6574 2b27 5f70 7265 6469 6374 696f 6e73  et+'_predictions
-000567d0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-000567e0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000567f0: 2020 2020 2020 2070 7265 6469 6374 5f63         predict_c
-00056800: 6f6c 7320 3d20 5b78 2b27 5f70 7265 6469  ols = [x+'_predi
-00056810: 6374 696f 6e73 2720 666f 7220 7820 696e  ctions' for x in
-00056820: 2074 6172 6765 745d 0d0a 2020 2020 2020   target]..      
-00056830: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
-00056840: 6564 6963 745f 636f 6c2c 2074 6172 6765  edict_col, targe
-00056850: 745f 636f 6c20 696e 207a 6970 2870 7265  t_col in zip(pre
-00056860: 6469 6374 5f63 6f6c 732c 2074 6172 6765  dict_cols, targe
-00056870: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-00056880: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00056890: 7375 626d 6973 7369 6f6e 5b74 6172 6765  submission[targe
-000568a0: 745f 636f 6c5d 203d 2074 6573 746d 5b70  t_col] = testm[p
-000568b0: 7265 6469 6374 5f63 6f6c 5d0d 0a20 2020  redict_col]..   
-000568c0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-000568d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000568e0: 2745 7272 6f72 3a20 436f 756c 6420 6e6f  'Error: Could no
-000568f0: 7420 6372 6561 7465 2073 616d 706c 6520  t create sample 
-00056900: 7375 626d 6973 7369 6f6e 2066 696c 6520  submission file 
-00056910: 6672 6f6d 2054 6573 7420 6461 7461 2729  from Test data')
-00056920: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
-00056930: 2020 2020 7772 6974 655f 6669 6c65 5f74      write_file_t
-00056940: 6f5f 666f 6c64 6572 2873 616d 706c 655f  o_folder(sample_
-00056950: 7375 626d 6973 7369 6f6e 2c20 6561 6368  submission, each
-00056960: 5f74 6172 6765 742c 2065 6163 685f 7461  _target, each_ta
-00056970: 7267 6574 2b27 5f27 2b6d 6f64 656c 7479  rget+'_'+modelty
-00056980: 7065 2b27 5f27 2b27 7375 626d 6973 7369  pe+'_'+'submissi
-00056990: 6f6e 2e63 7376 2729 0d0a 2020 2020 6578  on.csv')..    ex
-000569a0: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
-000569b0: 7269 6e74 2827 2020 2020 4572 726f 723a  rint('    Error:
-000569c0: 204e 6f74 2061 626c 6520 746f 2073 6176   Not able to sav
-000569d0: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
-000569e0: 652e 2053 6b69 7070 696e 672e 2e2e 2729  e. Skipping...')
-000569f0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-00056a00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a50: 2323 230d 0a20 2020 2074 7279 3a0d 0a20  ###..    try:.. 
-00056a60: 2020 2020 2020 2023 2323 2320 4272 696e         #### Brin
-00056a70: 6720 7472 6169 6e6d 2062 6163 6b20 746f  g trainm back to
-00056a80: 2069 7473 206f 7269 6769 6e61 6c20 696e   its original in
-00056a90: 6465 7820 2323 2323 2323 2323 2323 2323  dex ############
-00056aa0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-00056ab0: 206f 7269 675f 696e 6465 7820 3d20 6f72   orig_index = or
-00056ac0: 6967 5f74 7261 696e 2e69 6e64 6578 0d0a  ig_train.index..
-00056ad0: 2020 2020 2020 2020 7472 6169 6e6d 203d          trainm =
-00056ae0: 2074 7261 696e 2e72 6569 6e64 6578 2869   train.reindex(i
-00056af0: 6e64 6578 203d 206f 7269 675f 696e 6465  ndex = orig_inde
-00056b00: 7829 0d0a 2020 2020 2020 2020 7772 6974  x)..        writ
-00056b10: 655f 6669 6c65 5f74 6f5f 666f 6c64 6572  e_file_to_folder
-00056b20: 2874 7261 696e 6d2c 2065 6163 685f 7461  (trainm, each_ta
-00056b30: 7267 6574 2c20 6561 6368 5f74 6172 6765  rget, each_targe
-00056b40: 742b 275f 272b 6d6f 6465 6c74 7970 652b  t+'_'+modeltype+
-00056b50: 275f 272b 2774 7261 696e 5f6d 6f64 6966  '_'+'train_modif
-00056b60: 6965 642e 6373 7627 290d 0a20 2020 2065  ied.csv')..    e
-00056b70: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00056b80: 7072 696e 7428 2720 2020 2045 7272 6f72  print('    Error
-00056b90: 3a20 4e6f 7420 6162 6c65 2074 6f20 7361  : Not able to sa
-00056ba0: 7665 2074 7261 696e 206d 6f64 6966 6965  ve train modifie
-00056bb0: 6420 6669 6c65 2e20 536b 6970 7069 6e67  d file. Skipping
-00056bc0: 2e2e 2e27 290d 0a20 2020 2023 2323 2049  ...')..    ### I
-00056bd0: 6e20 6361 7365 206f 6620 6d75 6c74 692d  n case of multi-
-00056be0: 6c61 6265 6c20 6d6f 6465 6c73 2c20 7765  label models, we
-00056bf0: 2077 696c 6c20 7265 7365 7420 7468 6520   will reset the 
-00056c00: 7374 6172 7420 7472 6169 6e20 616e 6420  start train and 
-00056c10: 7465 7374 2064 6174 6166 7261 6d65 7320  test dataframes 
-00056c20: 746f 2063 6f6e 7461 696e 206e 6577 2066  to contain new f
-00056c30: 6561 7475 7265 7320 6372 6561 7465 640d  eatures created.
-00056c40: 0a20 2020 2073 7461 7274 5f74 7261 696e  .    start_train
-00056c50: 203d 2073 7461 7274 5f74 7261 696e 5b74   = start_train[t
-00056c60: 6172 6765 745d 2e6a 6f69 6e28 7374 6172  arget].join(star
-00056c70: 745f 7472 6169 6e5b 6f72 6967 5f72 6564  t_train[orig_red
-00056c80: 5f70 7265 6473 5d29 0d0a 2020 2020 6966  _preds])..    if
-00056c90: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00056ca0: 6f72 6967 5f74 6573 742c 2073 7472 293a  orig_test, str):
-00056cb0: 0d0a 2020 2020 2020 2020 7374 6172 745f  ..        start_
-00056cc0: 7465 7374 203d 2073 7461 7274 5f74 6573  test = start_tes
-00056cd0: 745b 6f72 6967 5f72 6564 5f70 7265 6473  t[orig_red_preds
-00056ce0: 5d0d 0a20 2020 2023 2323 2320 4f6e 6365  ]..    #### Once
-00056cf0: 2065 6163 6820 7461 7267 6574 2063 7963   each target cyc
-00056d00: 6c65 2069 7320 6f76 6572 2c20 7265 7365  le is over, rese
-00056d10: 7420 7468 6520 7265 645f 7072 6564 7320  t the red_preds 
-00056d20: 746f 2074 6865 206f 7269 675f 7265 645f  to the orig_red_
-00056d30: 7072 6564 7320 736f 2077 6520 6361 6e20  preds so we can 
-00056d40: 7374 6172 7420 6f76 6572 0d0a 2020 2020  start over..    
-00056d50: 2372 6564 5f70 7265 6473 203d 2063 6f70  #red_preds = cop
-00056d60: 792e 6465 6570 636f 7079 286f 7269 675f  y.deepcopy(orig_
-00056d70: 7265 645f 7072 6564 7329 0d0a 2020 2020  red_preds)..    
-00056d80: 6966 206d 6f64 656c 5f6c 6162 656c 2021  if model_label !
-00056d90: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
-00056da0: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
-00056db0: 5065 7266 6f72 6d20 4669 6e61 6c20 4d75  Perform Final Mu
-00056dc0: 6c74 692d 4c61 6265 6c20 4f70 6572 6174  lti-Label Operat
-00056dd0: 696f 6e73 2068 6572 6520 7369 6e63 6520  ions here since 
-00056de0: 616c 6c20 4c61 6265 6c73 2061 7265 2066  all Labels are f
-00056df0: 696e 6973 6865 6420 6279 206e 6f77 2023  inished by now #
-00056e00: 2323 0d0a 2020 2020 2020 2020 2323 2323  ##..        ####
-00056e10: 2044 6f6e 2774 2063 6861 6e67 6520 7468   Don't change th
-00056e20: 6520 7461 7267 6574 2068 6572 6520 746f  e target here to
-00056e30: 2065 6163 685f 7461 7267 6574 2073 696e   each_target sin
-00056e40: 6365 2074 6869 7320 6973 2066 6f72 206d  ce this is for m
-00056e50: 756c 7469 2d6c 6162 656c 2073 6974 7561  ulti-label situa
-00056e60: 7469 6f6e 7320 6f6e 6c79 2023 2323 0d0a  tions only ###..
-00056e70: 2020 2020 2020 2020 6966 2028 7363 6f72          if (scor
-00056e80: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-00056e90: 2027 6261 736b 6574 5f72 6563 616c 6c27   'basket_recall'
-00056ea0: 206f 7220 7363 6f72 696e 675f 7061 7261   or scoring_para
-00056eb0: 6d65 7465 7220 3d3d 2027 6a61 6363 6172  meter == 'jaccar
-00056ec0: 6427 2920 616e 6420 6d6f 6465 6c74 7970  d') and modeltyp
-00056ed0: 6520 213d 2027 5265 6772 6573 7369 6f6e  e != 'Regression
-00056ee0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-00056ef0: 795f 7072 6564 7320 3d20 6e70 2e61 7272  y_preds = np.arr
-00056f00: 6179 286c 6973 7428 7a69 7070 6564 2929  ay(list(zipped))
-00056f10: 0d0a 2020 2020 2020 2020 2020 2020 5f2c  ..            _,
-00056f20: 5f2c 5f2c 795f 6163 7475 616c 7320 3d20  _,_,y_actuals = 
-00056f30: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-00056f40: 2874 7261 696e 5b72 6564 5f70 7265 6473  (train[red_preds
-00056f50: 5d2c 2074 7261 696e 5b74 6172 6765 745d  ], train[target]
-00056f60: 2e76 616c 7565 732c 0d0a 2020 2020 2020  .values,..      
-00056f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056f90: 2020 7465 7374 5f73 697a 653d 7465 7374    test_size=test
-00056fa0: 5f73 697a 652c 2072 616e 646f 6d5f 7374  _size, random_st
-00056fb0: 6174 653d 7365 6564 290d 0a20 2020 2020  ate=seed)..     
-00056fc0: 2020 2020 2020 2070 7269 6e74 2827 5368         print('Sh
-00056fd0: 6170 6520 6f66 2041 6374 7561 6c73 3a20  ape of Actuals: 
-00056fe0: 2573 2061 6e64 2050 7265 6473 3a20 2573  %s and Preds: %s
-00056ff0: 2720 2528 795f 6163 7475 616c 732e 7368  ' %(y_actuals.sh
-00057000: 6170 655b 305d 2c20 795f 7072 6564 732e  ape[0], y_preds.
-00057010: 7368 6170 655b 305d 2929 0d0a 2020 2020  shape[0]))..    
-00057020: 2020 2020 2020 2020 6966 2079 5f61 6374          if y_act
-00057030: 7561 6c73 2e73 6861 7065 5b30 5d20 3d3d  uals.shape[0] ==
-00057040: 2079 5f70 7265 6473 2e73 6861 7065 5b30   y_preds.shape[0
-00057050: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-00057060: 2020 2020 6966 2073 636f 7269 6e67 5f70      if scoring_p
-00057070: 6172 616d 6574 6572 203d 3d20 2762 6173  arameter == 'bas
-00057080: 6b65 745f 7265 6361 6c6c 2720 616e 6420  ket_recall' and 
-00057090: 6c65 6e28 7461 7267 6574 2920 3e20 313a  len(target) > 1:
-000570a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000570b0: 2020 2020 2020 6163 6375 5f61 6c6c 203d        accu_all =
-000570c0: 2062 6173 6b65 745f 7265 6361 6c6c 2879   basket_recall(y
-000570d0: 5f61 6374 7561 6c73 2c20 795f 7072 6564  _actuals, y_pred
-000570e0: 7329 2e6d 6561 6e28 290d 0a20 2020 2020  s).mean()..     
-000570f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00057100: 7269 6e74 2827 2020 2020 2020 2020 4d65  rint('        Me
-00057110: 616e 2042 6173 6b65 7420 5265 6361 6c6c  an Basket Recall
-00057120: 203d 207b 3a2c 2e31 667d 2527 2e66 6f72   = {:,.1f}%'.for
-00057130: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
-00057140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057170: 2020 2020 2020 2020 2020 6163 6375 5f61            accu_a
-00057180: 6c6c 2a31 3030 2929 0d0a 2020 2020 2020  ll*100))..      
-00057190: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-000571a0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-000571b0: 203d 3d20 276a 6163 6361 7264 2720 616e   == 'jaccard' an
-000571c0: 6420 6c65 6e28 7461 7267 6574 2920 3e20  d len(target) > 
-000571d0: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-000571e0: 2020 2020 2323 2020 5468 6973 2073 686f      ##  This sho
-000571f0: 7773 2073 696d 696c 6172 6974 7920 696e  ws similarity in
-00057200: 206d 756c 7469 2d6c 6162 656c 2073 6974   multi-label sit
-00057210: 7561 7469 6f6e 7320 2323 2323 0d0a 2020  uations ####..  
-00057220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057230: 2020 6163 6375 5f61 6c6c 203d 206a 6163    accu_all = jac
-00057240: 6361 7264 5f6d 756c 7469 6c61 6265 6c28  card_multilabel(
-00057250: 795f 6163 7475 616c 732c 2079 5f70 7265  y_actuals, y_pre
-00057260: 6473 290d 0a20 2020 2020 2020 2020 2020  ds)..           
-00057270: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00057280: 2020 2020 2020 2020 4d65 616e 204a 6163          Mean Jac
-00057290: 6361 7264 2053 696d 696c 6172 6974 7920  card Similarity 
-000572a0: 203d 2025 7327 2025 280d 0a20 2020 2020   = %s' %(..     
-000572b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000572c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000572d0: 2020 2020 2020 2061 6363 755f 616c 6c29         accu_all)
-000572e0: 290d 0a20 2020 2020 2020 2023 2320 2020  )..        ##   
-000572f0: 454e 4420 4f46 2053 484f 5749 4e47 204d  END OF SHOWING M
-00057300: 4554 5249 4353 204c 4142 454c 2049 4e20  ETRICS LABEL IN 
-00057310: 4120 4d55 4c54 4920 4c41 4245 4c20 4441  A MULTI LABEL DA
-00057320: 5441 2053 4554 2021 2057 4845 5720 2120  TA SET ! WHEW ! 
-00057330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057340: 2323 230d 0a20 2020 2070 7269 6e74 2827  ###..    print('
-00057350: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
-00057360: 2043 204f 204d 2050 204c 2045 2054 2045   C O M P L E T E
-00057370: 2044 2020 2323 2323 2323 2323 2323 2323   D  ############
-00057380: 2323 2323 2729 0d0a 2020 2020 7072 696e  ####')..    prin
-00057390: 7428 2754 696d 6520 5461 6b65 6e20 696e  t('Time Taken in
-000573a0: 206d 696e 7320 3d20 2530 2e31 6620 666f   mins = %0.1f fo
-000573b0: 7220 7468 6520 456e 7469 7265 2050 726f  r the Entire Pro
-000573c0: 6365 7373 2720 2528 2874 696d 652e 7469  cess' %((time.ti
-000573d0: 6d65 2829 2d73 7461 7274 5f74 696d 6529  me()-start_time)
-000573e0: 2f36 3029 290d 0a20 2020 2023 7265 7475  /60))..    #retu
-000573f0: 726e 206d 6f64 656c 2c20 696d 705f 6665  rn model, imp_fe
-00057400: 6174 7572 6573 5f64 662e 696e 6465 782e  atures_df.index.
-00057410: 746f 6c69 7374 2829 2c20 7472 6169 6e6d  tolist(), trainm
-00057420: 2c20 7465 7374 6d0d 0a20 2020 2072 6574  , testm..    ret
-00057430: 7572 6e20 6d6f 6465 6c2c 2069 6d70 6f72  urn model, impor
-00057440: 7461 6e74 5f66 6561 7475 7265 732c 2074  tant_features, t
-00057450: 7261 696e 6d2c 2074 6573 746d 0d0a 2323  rainm, testm..##
-00057460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000574a0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-000574b0: 6566 2070 6c6f 745f 5348 4150 5f76 616c  ef plot_SHAP_val
-000574c0: 7565 7328 6d2c 582c 6d6f 6465 6c74 7970  ues(m,X,modeltyp
-000574d0: 652c 426f 6f73 7469 6e67 5f46 6c61 673d  e,Boosting_Flag=
-000574e0: 4661 6c73 652c 6d61 7470 6c6f 746c 6962  False,matplotlib
-000574f0: 5f66 6c61 673d 4661 6c73 652c 7665 7262  _flag=False,verb
-00057500: 6f73 653d 3029 3a0d 0a20 2020 2069 6d70  ose=0):..    imp
-00057510: 6f72 7420 7368 6170 0d0a 2020 2020 2320  ort shap..    # 
-00057520: 6c6f 6164 204a 5320 7669 7375 616c 697a  load JS visualiz
-00057530: 6174 696f 6e20 636f 6465 2074 6f20 6e6f  ation code to no
-00057540: 7465 626f 6f6b 0d0a 2020 2020 6966 206e  tebook..    if n
-00057550: 6f74 206d 6174 706c 6f74 6c69 625f 666c  ot matplotlib_fl
-00057560: 6167 3a0d 0a20 2020 2020 2020 2073 6861  ag:..        sha
-00057570: 702e 696e 6974 6a73 2829 3b0d 0a20 2020  p.initjs();..   
-00057580: 2023 2065 7870 6c61 696e 2074 6865 206d   # explain the m
-00057590: 6f64 656c 2773 2070 7265 6469 6374 696f  odel's predictio
-000575a0: 6e73 2075 7369 6e67 2053 4841 5020 7661  ns using SHAP va
-000575b0: 6c75 6573 0d0a 2020 2020 6578 706c 6169  lues..    explai
-000575c0: 6e65 7220 3d20 7368 6170 2e54 7265 6545  ner = shap.TreeE
-000575d0: 7870 6c61 696e 6572 286d 290d 0a20 2020  xplainer(m)..   
-000575e0: 2073 6861 705f 7661 6c75 6573 203d 2065   shap_values = e
-000575f0: 7870 6c61 696e 6572 2e73 6861 705f 7661  xplainer.shap_va
-00057600: 6c75 6573 2858 290d 0a20 2020 2069 6620  lues(X)..    if 
-00057610: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
-00057620: 6720 6973 204e 6f6e 653a 0d0a 2020 2020  g is None:..    
-00057630: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-00057640: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
-00057650: 2020 2023 2076 6973 7561 6c69 7a65 2074     # visualize t
-00057660: 6865 2066 6972 7374 2070 7265 6469 6374  he first predict
-00057670: 696f 6e27 7320 6578 706c 616e 6174 696f  ion's explanatio
-00057680: 6e20 2875 7365 206d 6174 706c 6f74 6c69  n (use matplotli
-00057690: 623d 5472 7565 2074 6f20 6176 6f69 6420  b=True to avoid 
-000576a0: 4a61 7661 7363 7269 7074 290d 0a20 2020  Javascript)..   
-000576b0: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
-000576c0: 6f73 6520 3e20 3020 616e 6420 6d6f 6465  ose > 0 and mode
-000576d0: 6c74 7970 6520 213d 2027 4d75 6c74 695f  ltype != 'Multi_
-000576e0: 436c 6173 7369 6669 6361 7469 6f6e 273a  Classification':
-000576f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00057700: 2020 7368 6170 2e73 756d 6d61 7279 5f70    shap.summary_p
-00057710: 6c6f 7428 7368 6170 5f76 616c 7565 732c  lot(shap_values,
-00057720: 2058 2c20 706c 6f74 5f74 7970 653d 2276   X, plot_type="v
-00057730: 696f 6c69 6e22 293b 0d0a 2020 2020 2020  iolin");..      
-00057740: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
-00057750: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00057760: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
-00057770: 7428 7368 6170 5f76 616c 7565 732c 2058  t(shap_values, X
-00057780: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
-00057790: 2229 3b0d 0a20 2020 2065 6c73 653a 0d0a  ");..    else:..
-000577a0: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
-000577b0: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
-000577c0: 616c 7565 732c 2058 2c20 706c 6f74 5f74  alues, X, plot_t
-000577d0: 7970 653d 2262 6172 2229 3b0d 0a23 2323  ype="bar");..###
-000577e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000577f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057820: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
-00057830: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
-00057840: 2020 2020 2046 696e 6420 746f 7020 6665       Find top fe
-00057850: 6174 7572 6573 2075 7369 6e67 2058 4742  atures using XGB
-00057860: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00057870: 2323 2323 2323 2323 0d0a 2323 2323 2323  ########..######
-00057880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000578a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000578b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000578c0: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
-000578d0: 2078 6762 6f6f 7374 2069 6d70 6f72 7420   xgboost import 
-000578e0: 5847 4243 6c61 7373 6966 6965 722c 2058  XGBClassifier, X
-000578f0: 4742 5265 6772 6573 736f 720d 0a64 6566  GBRegressor..def
-00057900: 2066 696e 645f 746f 705f 6665 6174 7572   find_top_featur
-00057910: 6573 5f78 6762 2874 7261 696e 2c70 7265  es_xgb(train,pre
-00057920: 6473 2c6e 756d 7661 7273 2c74 6172 6765  ds,numvars,targe
-00057930: 742c 6d6f 6465 6c74 7970 652c 636f 7272  t,modeltype,corr
-00057940: 5f6c 696d 6974 2c76 6572 626f 7365 3d30  _limit,verbose=0
-00057950: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-00057960: 2054 6869 7320 6973 2061 2066 6173 7420   This is a fast 
-00057970: 7574 696c 6974 7920 7468 6174 2075 7365  utility that use
-00057980: 7320 5847 4220 746f 2066 696e 6420 746f  s XGB to find to
-00057990: 7020 6665 6174 7572 6573 2e20 596f 750d  p features. You.
-000579a0: 0a20 2020 2049 7420 7265 7475 726e 7320  .    It returns 
-000579b0: 6120 6c69 7374 206f 6620 696d 706f 7274  a list of import
-000579c0: 616e 7420 6665 6174 7572 6573 2e0d 0a20  ant features... 
-000579d0: 2020 2053 696e 6365 2069 7420 6973 2058     Since it is X
-000579e0: 4742 2c20 796f 7520 646f 6e74 2068 6176  GB, you dont hav
-000579f0: 6520 746f 2072 6573 7472 6963 7420 7468  e to restrict th
-00057a00: 6520 696e 7075 7420 746f 206a 7573 7420  e input to just 
-00057a10: 6e75 6d65 7269 6320 7661 7273 2e0d 0a20  numeric vars... 
-00057a20: 2020 2059 6f75 2063 616e 2073 656e 6420     You can send 
-00057a30: 696e 2061 6c6c 206b 696e 6473 206f 6620  in all kinds of 
-00057a40: 7661 7273 2061 6e64 2069 7420 7769 6c6c  vars and it will
-00057a50: 2074 616b 6520 6361 7265 206f 6620 7472   take care of tr
-00057a60: 616e 7366 6f72 6d69 6e67 2069 742e 2053  ansforming it. S
-00057a70: 7765 6574 210d 0a20 2020 2022 2222 0d0a  weet!..    """..
-00057a80: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00057a90: 2323 2323 2323 2323 2323 2020 2049 204d  ##########   I M
-00057aa0: 2050 204f 2052 2054 2041 204e 2054 2023   P O R T A N T #
-00057ab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ad0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-00057ae0: 2020 2023 2323 2323 2320 5468 6973 2074     ###### This t
-00057af0: 6f70 5f6e 756d 2064 6563 6964 6573 2068  op_num decides h
-00057b00: 6f77 206d 616e 7920 746f 705f 6e20 6665  ow many top_n fe
-00057b10: 6174 7572 6573 2058 4742 2073 656c 6563  atures XGB selec
-00057b20: 7473 2069 6e20 6561 6368 2069 7465 7261  ts in each itera
-00057b30: 7469 6f6e 2e0d 0a20 2020 2023 2323 2320  tion...    #### 
-00057b40: 2054 6865 7265 2061 2074 6f74 616c 206f   There a total o
-00057b50: 6620 3520 6974 6572 6174 696f 6e73 2e20  f 5 iterations. 
-00057b60: 4865 6e63 6520 3578 3130 206d 6561 6e73  Hence 5x10 means
-00057b70: 206d 6178 696d 756d 2035 3020 6665 6174   maximum 50 feat
-00057b80: 7565 7320 7769 6c6c 2062 6520 7365 6c65  ues will be sele
-00057b90: 6374 6564 2e0d 0a20 2020 2023 2323 2323  cted...    #####
-00057ba0: 2020 4966 2074 6865 7265 2061 7265 206d    If there are m
-00057bb0: 6f72 6520 7468 616e 2035 3020 7661 7269  ore than 50 vari
-00057bc0: 6162 6c65 732c 2074 6865 6e20 6d61 7869  ables, then maxi
-00057bd0: 6d75 6d20 352a 3235 203d 2031 3235 2076  mum 5*25 = 125 v
-00057be0: 6172 6961 626c 6573 2077 696c 6c20 6265  ariables will be
-00057bf0: 2073 656c 6563 7465 640d 0a20 2020 2069   selected..    i
-00057c00: 6620 6c65 6e28 7072 6564 7329 203c 3d20  f len(preds) <= 
-00057c10: 3530 3a0d 0a20 2020 2020 2020 2074 6f70  50:..        top
-00057c20: 5f6e 756d 203d 2031 300d 0a20 2020 2065  _num = 10..    e
-00057c30: 6c73 653a 0d0a 2020 2020 2020 2020 746f  lse:..        to
-00057c40: 705f 6e75 6d20 3d20 3235 0d0a 2020 2020  p_num = 25..    
-00057c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057c60: 2323 2323 2323 2020 2049 204d 2050 204f  ######   I M P O
-00057c70: 2052 2054 2041 204e 2054 2023 2323 2323   R T A N T #####
-00057c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057c90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ca0: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
-00057cb0: 2323 2320 4966 2074 6865 7265 2061 7265  ### If there are
-00057cc0: 206d 6f72 6520 7468 616e 2033 3020 6361   more than 30 ca
-00057cd0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
-00057ce0: 6c65 7320 696e 2061 2064 6174 6120 7365  les in a data se
-00057cf0: 742c 2069 7420 6973 2077 6f72 7468 2072  t, it is worth r
-00057d00: 6564 7563 696e 6720 6665 6174 7572 6573  educing features
-00057d10: 2e0d 0a20 2020 2023 2323 2320 204f 7468  ...    ####  Oth
-00057d20: 6572 7769 7365 2e20 5847 426f 6f73 7420  erwise. XGBoost 
-00057d30: 6973 2070 7265 7474 7920 676f 6f64 2061  is pretty good a
-00057d40: 7420 6669 6e64 696e 6720 7468 6520 6265  t finding the be
-00057d50: 7374 2066 6561 7475 7265 7320 7768 6574  st features whet
-00057d60: 6865 7220 6361 7420 6f72 206e 756d 6572  her cat or numer
-00057d70: 6963 2021 0d0a 2020 2020 6e5f 7370 6c69  ic !..    n_spli
-00057d80: 7473 203d 2035 0d0a 2020 2020 6d61 785f  ts = 5..    max_
-00057d90: 6465 7074 6820 3d20 380d 0a20 2020 206d  depth = 8..    m
-00057da0: 6178 5f63 6174 7320 3d20 350d 0a20 2020  ax_cats = 5..   
-00057db0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00057dc0: 2323 2323 2323 2320 2020 4920 4d20 5020  #######   I M P 
-00057dd0: 4f20 5220 5420 4120 4e20 5420 2323 2323  O R T A N T ####
-00057de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057e00: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00057e10: 7472 6169 6e20 3d20 636f 7079 2e64 6565  train = copy.dee
-00057e20: 7063 6f70 7928 7472 6169 6e29 0d0a 2020  pcopy(train)..  
-00057e30: 2020 7072 6564 7320 3d20 636f 7079 2e64    preds = copy.d
-00057e40: 6565 7063 6f70 7928 7072 6564 7329 0d0a  eepcopy(preds)..
-00057e50: 2020 2020 6e75 6d76 6172 7320 3d20 636f      numvars = co
-00057e60: 7079 2e64 6565 7063 6f70 7928 6e75 6d76  py.deepcopy(numv
-00057e70: 6172 7329 0d0a 2020 2020 7375 6273 616d  ars)..    subsam
-00057e80: 706c 6520 3d20 2030 2e37 0d0a 2020 2020  ple =  0.7..    
-00057e90: 636f 6c5f 7375 625f 7361 6d70 6c65 203d  col_sub_sample =
-00057ea0: 2030 2e37 0d0a 2020 2020 7472 6169 6e20   0.7..    train 
-00057eb0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00057ec0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
-00057ed0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
-00057ee0: 6d65 2829 0d0a 2020 2020 7465 7374 5f73  me()..    test_s
-00057ef0: 697a 6520 3d20 302e 320d 0a20 2020 2073  ize = 0.2..    s
-00057f00: 6565 6420 3d20 310d 0a20 2020 2065 6172  eed = 1..    ear
-00057f10: 6c79 5f73 746f 7070 696e 6720 3d20 350d  ly_stopping = 5.
-00057f20: 0a20 2020 2023 2323 2323 2323 2041 6c6c  .    ####### All
-00057f30: 2074 6865 2064 6566 6175 6c74 2070 6172   the default par
-00057f40: 616d 6574 6572 7320 6172 6520 7365 7420  ameters are set 
-00057f50: 7570 206e 6f77 2023 2323 2323 2323 2323  up now #########
-00057f60: 0d0a 2020 2020 6b66 203d 204b 466f 6c64  ..    kf = KFold
-00057f70: 286e 5f73 706c 6974 733d 6e5f 7370 6c69  (n_splits=n_spli
-00057f80: 7473 290d 0a20 2020 2072 656d 5f76 6172  ts)..    rem_var
-00057f90: 7320 3d20 6c65 6674 5f73 7562 7472 6163  s = left_subtrac
-00057fa0: 7428 7072 6564 732c 6e75 6d76 6172 7329  t(preds,numvars)
-00057fb0: 0d0a 2020 2020 6361 7476 6172 7320 3d20  ..    catvars = 
-00057fc0: 636f 7079 2e64 6565 7063 6f70 7928 7265  copy.deepcopy(re
-00057fd0: 6d5f 7661 7273 290d 0a20 2020 2023 2323  m_vars)..    ###
-00057fe0: 2323 2323 2323 2323 2320 2020 4920 204d  #########   I  M
-00057ff0: 2050 204f 2052 2054 2041 204e 2054 2021   P O R T A N T !
-00058000: 2049 204d 2050 204f 2052 2054 2041 204e   I M P O R T A N
-00058010: 2054 2021 2023 2323 2323 2323 2323 2323   T ! ###########
-00058020: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00058030: 2023 2323 2323 2049 2061 6d20 7265 6d6f   ##### I am remo
-00058040: 7669 6e67 2074 6865 2043 6174 2056 6172  ving the Cat Var
-00058050: 7320 7365 6c65 6374 696f 6e20 7573 696e  s selection usin
-00058060: 6720 4c69 6e65 6172 204d 6574 686f 6473  g Linear Methods
-00058070: 2073 696e 6365 2074 6865 7920 6661 696c   since they fail
-00058080: 2073 6f20 6f66 7465 6e2e 0d0a 2020 2020   so often...    
-00058090: 2323 2323 2320 4c69 6e65 6172 206d 6574  ##### Linear met
-000580a0: 686f 6473 2073 7563 6820 6173 2043 6869  hods such as Chi
-000580b0: 3220 6f72 204d 7574 7561 6c20 496e 666f  2 or Mutual Info
-000580c0: 726d 6174 696f 6e20 5363 6f72 6520 6172  rmation Score ar
-000580d0: 6520 6e6f 7420 6772 6561 740d 0a20 2020  e not great..   
-000580e0: 2023 2323 2320 2066 6f72 2066 6561 7475   ####  for featu
-000580f0: 7265 2073 656c 6563 7469 6f6e 2073 696e  re selection sin
-00058100: 6365 2074 6865 7920 6361 6e27 7420 6861  ce they can't ha
-00058110: 6e64 6c65 206c 6172 6765 2064 6174 6120  ndle large data 
-00058120: 616e 6420 7072 6f76 6964 650d 0a20 2020  and provide..   
-00058130: 2023 2323 2320 2069 6e63 6f6e 7369 7374   ####  inconsist
-00058140: 656e 7420 7265 7375 6c74 7320 666f 7220  ent results for 
-00058150: 6c61 7267 6520 6461 7461 2073 6574 732e  large data sets.
-00058160: 2048 656e 6365 2049 2061 6d20 7573 696e   Hence I am usin
-00058170: 6720 5847 426f 6f73 7420 616c 6f6e 652e  g XGBoost alone.
-00058180: 0d0a 2020 2020 2323 2323 2020 416c 736f  ..    ####  Also
-00058190: 2c20 616e 6f74 6865 7220 6d65 7468 6f64  , another method
-000581a0: 206f 6620 7573 696e 6720 5370 6561 726d   of using Spearm
-000581b0: 616e 2043 6f72 7265 6c61 7469 6f6e 2066  an Correlation f
-000581c0: 6f72 2043 6174 5661 7273 2077 6974 6820  or CatVars with 
-000581d0: 3130 3027 730d 0a20 2020 2023 2323 2320  100's..    #### 
-000581e0: 206f 6620 7661 7269 6162 6c65 7320 6973   of variables is
-000581f0: 2065 7874 7265 6d65 6c79 2073 6c6f 772e   extremely slow.
-00058200: 2041 6c73 6f2c 2069 7427 7320 6566 6665   Also, it's effe
-00058210: 6374 6976 656e 6573 2069 7320 6e6f 7420  ctivenes is not 
-00058220: 7665 7279 2063 6c65 6172 2e0d 0a20 2020  very clear...   
-00058230: 2023 2323 2320 2048 656e 6365 2066 6f72   ####  Hence for
-00058240: 206e 6f77 2c20 4920 616d 206e 6f74 2067   now, I am not g
-00058250: 6f69 6e67 2074 6f20 7573 6520 5370 6561  oing to use Spea
-00058260: 726d 616e 206d 6574 686f 642e 0d0a 2020  rman method...  
-00058270: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00058280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000582a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000582b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000582c0: 0d0a 2020 2020 2369 6620 6c65 6e28 6361  ..    #if len(ca
-000582d0: 7476 6172 7329 203e 206d 6178 5f63 6174  tvars) > max_cat
-000582e0: 733a 0d0a 2020 2020 2320 2020 2073 7461  s:..    #    sta
-000582f0: 7274 5f74 696d 6520 3d20 7469 6d65 2e74  rt_time = time.t
-00058300: 696d 6528 290d 0a20 2020 2023 2020 2020  ime()..    #    
-00058310: 696d 706f 7274 616e 745f 6361 7473 203d  important_cats =
-00058320: 2072 656d 6f76 655f 7661 7269 6162 6c65   remove_variable
-00058330: 735f 7573 696e 675f 6661 7374 5f63 6f72  s_using_fast_cor
-00058340: 7265 6c61 7469 6f6e 2874 7261 696e 2c63  relation(train,c
-00058350: 6174 7661 7273 2c6d 6f64 656c 7479 7065  atvars,modeltype
-00058360: 2c0d 0a20 2020 2023 2020 2020 2020 2020  ,..    #        
-00058370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058380: 2063 6f72 725f 6c69 6d69 742c 7665 7262   corr_limit,verb
-00058390: 6f73 6529 0d0a 2020 2020 2320 2020 2069  ose)..    #    i
-000583a0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
-000583b0: 0a20 2020 2023 2020 2020 2020 2020 7072  .    #        pr
-000583c0: 696e 7428 2754 696d 6520 7461 6b65 6e20  int('Time taken 
-000583d0: 666f 7220 7265 6475 6369 6e67 2068 6967  for reducing hig
-000583e0: 686c 7920 636f 7272 656c 6174 6564 2043  hly correlated C
-000583f0: 6174 6567 6f72 6963 616c 2076 6172 7320  ategorical vars 
-00058400: 7761 7320 2530 2e30 6620 7365 636f 6e64  was %0.0f second
-00058410: 7327 2025 2874 696d 652e 7469 6d65 2829  s' %(time.time()
-00058420: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
-00058430: 2020 2023 656c 7365 3a0d 0a20 2020 2069     #else:..    i
-00058440: 6d70 6f72 7461 6e74 5f63 6174 7320 3d20  mportant_cats = 
-00058450: 636f 7079 2e64 6565 7063 6f70 7928 6361  copy.deepcopy(ca
-00058460: 7476 6172 7329 0d0a 2020 2020 7072 696e  tvars)..    prin
-00058470: 7428 2720 2020 2028 2564 2920 6361 7465  t('    (%d) cate
-00058480: 676f 7269 6361 6c20 7661 7273 2e2e 2e27  gorical vars...'
-00058490: 2025 286c 656e 2863 6174 7661 7273 2929   %(len(catvars))
-000584a0: 290d 0a20 2020 2066 696e 616c 5f6c 6973  )..    final_lis
-000584b0: 7420 3d20 636f 7079 2e64 6565 7063 6f70  t = copy.deepcop
-000584c0: 7928 6e75 6d76 6172 7329 0d0a 2020 2020  y(numvars)..    
-000584d0: 6966 2020 6973 696e 7374 616e 6365 2866  if  isinstance(f
-000584e0: 696e 616c 5f6c 6973 742c 6e70 2e6e 6461  inal_list,np.nda
-000584f0: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
-00058500: 6669 6e61 6c5f 6c69 7374 203d 2066 696e  final_list = fin
-00058510: 616c 5f6c 6973 742e 746f 6c69 7374 2829  al_list.tolist()
-00058520: 0d0a 2020 2020 7072 6564 7320 3d20 6669  ..    preds = fi
-00058530: 6e61 6c5f 6c69 7374 2b69 6d70 6f72 7461  nal_list+importa
-00058540: 6e74 5f63 6174 730d 0a20 2020 2023 2323  nt_cats..    ###
-00058550: 2323 2323 596f 7520 6d75 7374 2063 6f6e  ####You must con
-00058560: 7665 7274 2063 6174 6567 6f72 7920 7661  vert category va
-00058570: 7269 6162 6c65 7320 696e 746f 2069 6e74  riables into int
-00058580: 6567 6572 7320 2323 2323 2323 2323 2323  egers ##########
-00058590: 2323 2323 230d 0a20 2020 2066 6f72 2069  #####..    for i
-000585a0: 6d70 6f72 7461 6e74 5f63 6174 2069 6e20  mportant_cat in 
-000585b0: 696d 706f 7274 616e 745f 6361 7473 3a0d  important_cats:.
-000585c0: 0a20 2020 2020 2020 2069 6620 7374 7228  .        if str(
-000585d0: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
-000585e0: 6361 745d 2e64 7479 7065 2920 3d3d 2027  cat].dtype) == '
-000585f0: 6361 7465 676f 7279 273a 0d0a 2020 2020  category':..    
-00058600: 2020 2020 2020 2020 7472 6169 6e5b 696d          train[im
-00058610: 706f 7274 616e 745f 6361 745d 203d 2074  portant_cat] = t
-00058620: 7261 696e 5b69 6d70 6f72 7461 6e74 5f63  rain[important_c
-00058630: 6174 5d2e 6173 7479 7065 2869 6e74 290d  at].astype(int).
-00058640: 0a20 2020 2023 2323 2323 2323 2320 2020  .    ########   
-00058650: 2044 726f 7020 4d69 7373 696e 6720 7661   Drop Missing va
-00058660: 6c75 6520 726f 7773 2073 696e 6365 2058  lue rows since X
-00058670: 4742 2066 6f72 2073 6f6d 6520 7265 6173  GB for some reas
-00058680: 6f6e 2020 2323 2323 2323 2323 230d 0a20  on  #########.. 
-00058690: 2020 2023 2323 2323 2323 2320 2020 2063     ########    c
-000586a0: 616e 2774 2068 616e 646c 6520 6d69 7373  an't handle miss
-000586b0: 696e 6720 7661 6c75 6573 2069 6e20 6561  ing values in ea
-000586c0: 726c 7920 7374 6f70 7069 6e67 2072 6f75  rly stopping rou
-000586d0: 6e64 7320 2323 2323 2323 230d 0a20 2020  nds #######..   
-000586e0: 2074 7261 696e 2e64 726f 706e 6128 6178   train.dropna(ax
-000586f0: 6973 3d30 2c73 7562 7365 743d 7072 6564  is=0,subset=pred
-00058700: 732b 5b74 6172 6765 745d 2c69 6e70 6c61  s+[target],inpla
-00058710: 6365 3d54 7275 6529 0d0a 2020 2020 2323  ce=True)..    ##
-00058720: 2323 2323 2323 2020 2044 6f6e 7420 6d6f  ######   Dont mo
-00058730: 7665 2074 6869 7320 7472 6169 6e20 616e  ve this train an
-00058740: 6420 7920 6465 6669 6e69 7469 6f6e 2061  d y definition a
-00058750: 6e79 7768 6572 6520 656c 7365 2023 2323  nywhere else ###
-00058760: 2323 2323 230d 0a20 2020 2079 203d 2074  #####..    y = t
-00058770: 7261 696e 5b74 6172 6765 745d 0d0a 2020  rain[target]..  
-00058780: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+00055d60: 7368 6170 5f76 616c 7565 7320 3d20 6578  shap_values = ex
+00055d70: 706c 6169 6e65 722e 7368 6170 5f76 616c  plainer.shap_val
+00055d80: 7565 7328 585f 706c 6f74 290d 0a20 2020  ues(X_plot)..   
+00055d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055da0: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
+00055db0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00055dc0: 2020 2020 2020 2020 2020 2073 6861 702e             shap.
+00055dd0: 7375 6d6d 6172 795f 706c 6f74 2873 6861  summary_plot(sha
+00055de0: 705f 7661 6c75 6573 2c20 585f 706c 6f74  p_values, X_plot
+00055df0: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
+00055e00: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00055e10: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00055e20: 6f64 656c 7479 7065 2021 3d20 2752 6567  odeltype != 'Reg
+00055e30: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
+00055e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055e50: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+00055e60: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00055e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055e80: 2073 6861 702e 7375 6d6d 6172 795f 706c   shap.summary_pl
+00055e90: 6f74 2873 6861 705f 7661 6c75 6573 2c20  ot(shap_values, 
+00055ea0: 585f 706c 6f74 290d 0a20 2020 2020 2020  X_plot)..       
+00055eb0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00055ec0: 6620 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77  f model_name.low
+00055ed0: 6572 2829 203d 3d20 2766 6f72 6573 7473  er() == 'forests
+00055ee0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00055ef0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00055f00: 2054 6869 7320 776f 726b 7320 7765 6c6c   This works well
+00055f10: 2066 6f72 2052 4643 2061 6e64 2058 4742   for RFC and XGB
+00055f20: 6f6f 7374 2066 6f72 206d 756c 7469 636c  oost for multicl
+00055f30: 6173 7320 7072 6f62 6c65 6d73 2023 2323  ass problems ###
+00055f40: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00055f50: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00055f60: 4974 2077 6f72 6b73 2066 6f72 2062 6f74  It works for bot
+00055f70: 6820 6269 6e61 7279 2061 6e64 206d 756c  h binary and mul
+00055f80: 7469 2d63 6c61 7373 2070 726f 626c 656d  ti-class problem
+00055f90: 7320 2323 2323 2323 2323 0d0a 2020 2020  s ########..    
+00055fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055fb0: 2020 2020 2323 2320 486f 7765 7665 722c      ### However,
+00055fc0: 2069 7420 646f 6573 204e 4f54 2077 6f72   it does NOT wor
+00055fd0: 6b20 666f 7220 4361 7442 6f6f 7374 206d  k for CatBoost m
+00055fe0: 6f64 656c 7321 0d0a 2020 2020 2020 2020  odels!..        
+00055ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056000: 6578 706c 6169 6e65 7220 3d20 7368 6170  explainer = shap
+00056010: 2e54 7265 6545 7870 6c61 696e 6572 2870  .TreeExplainer(p
+00056020: 6c6f 745f 6d6f 6465 6c29 0d0a 2020 2020  lot_model)..    
+00056030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056040: 2020 2020 7368 6170 5f76 616c 7565 7320      shap_values 
+00056050: 3d20 6578 706c 6169 6e65 722e 7368 6170  = explainer.shap
+00056060: 5f76 616c 7565 7328 585f 706c 6f74 290d  _values(X_plot).
+00056070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056080: 2020 2020 2020 2020 2070 6c74 2e66 6967           plt.fig
+00056090: 7572 6528 290d 0a20 2020 2020 2020 2020  ure()..         
+000560a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000560b0: 6861 702e 7375 6d6d 6172 795f 706c 6f74  hap.summary_plot
+000560c0: 2873 6861 705f 7661 6c75 6573 2c20 585f  (shap_values, X_
+000560d0: 706c 6f74 2c20 706c 6f74 5f74 7970 653d  plot, plot_type=
+000560e0: 2262 6172 2229 0d0a 2020 2020 2020 2020  "bar")..        
+000560f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056100: 2323 2320 5468 6572 6520 6973 206e 6f20  ### There is no 
+00056110: 7369 6e67 6c65 2076 696f 6c69 6e20 706c  single violin pl
+00056120: 6f74 2066 6f72 2052 616e 646f 6d20 466f  ot for Random Fo
+00056130: 7265 7374 7320 696e 2053 4841 500d 0a20  rests in SHAP.. 
+00056140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056150: 2020 2020 2020 2023 2323 2320 4974 2061         #### It a
+00056160: 6374 7561 6c6c 7920 6861 7320 6d75 6c74  ctually has mult
+00056170: 6970 6c65 206f 7574 7075 7473 2073 6f20  iple outputs so 
+00056180: 796f 7520 6361 6e20 6c6f 6f70 2074 6872  you can loop thr
+00056190: 6f75 6768 2069 7420 666f 7220 6561 6368  ough it for each
+000561a0: 2063 6c61 7373 0d0a 2020 2020 2020 2020   class..        
+000561b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561c0: 6966 206d 6f64 656c 7479 7065 2021 3d20  if modeltype != 
+000561d0: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+000561e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561f0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00056200: 6163 685f 6920 696e 2072 616e 6765 286c  ach_i in range(l
+00056210: 656e 2863 6c61 7373 6573 2929 3a0d 0a20  en(classes)):.. 
+00056220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056230: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00056240: 6c74 2e66 6967 7572 6528 290d 0a20 2020  lt.figure()..   
+00056250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056260: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+00056270: 702e 7375 6d6d 6172 795f 706c 6f74 2873  p.summary_plot(s
+00056280: 6861 705f 7661 6c75 6573 5b65 6163 685f  hap_values[each_
+00056290: 695d 2c20 585f 706c 6f74 290d 0a20 2020  i], X_plot)..   
+000562a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000562b0: 2065 6c69 6620 6d6f 6465 6c5f 6e61 6d65   elif model_name
+000562c0: 2e6c 6f77 6572 2829 203d 3d20 2778 6762  .lower() == 'xgb
+000562d0: 6f6f 7374 273a 0d0a 2020 2020 2020 2020  oost':..        
+000562e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000562f0: 2323 2323 2054 6869 7320 776f 726b 7320  #### This works 
+00056300: 7765 6c6c 2066 6f72 2052 4643 2061 6e64  well for RFC and
+00056310: 2058 4742 6f6f 7374 2066 6f72 206d 756c   XGBoost for mul
+00056320: 7469 636c 6173 7320 7072 6f62 6c65 6d73  ticlass problems
+00056330: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+00056340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056350: 2323 2320 4974 2077 6f72 6b73 2066 6f72  ### It works for
+00056360: 2062 6f74 6820 6269 6e61 7279 2061 6e64   both binary and
+00056370: 206d 756c 7469 2d63 6c61 7373 2070 726f   multi-class pro
+00056380: 626c 656d 7320 2323 2323 2323 2323 0d0a  blems ########..
+00056390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000563a0: 2020 2020 2020 2020 2323 2320 486f 7765          ### Howe
+000563b0: 7665 722c 2069 7420 646f 6573 204e 4f54  ver, it does NOT
+000563c0: 2077 6f72 6b20 666f 7220 4361 7442 6f6f   work for CatBoo
+000563d0: 7374 206d 6f64 656c 7321 0d0a 2020 2020  st models!..    
+000563e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000563f0: 2020 2020 6578 706c 6169 6e65 7220 3d20      explainer = 
+00056400: 7368 6170 2e54 7265 6545 7870 6c61 696e  shap.TreeExplain
+00056410: 6572 2870 6c6f 745f 6d6f 6465 6c29 0d0a  er(plot_model)..
+00056420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056430: 2020 2020 2020 2020 7368 6170 5f76 616c          shap_val
+00056440: 7565 7320 3d20 6578 706c 6169 6e65 722e  ues = explainer.
+00056450: 7368 6170 5f76 616c 7565 7328 585f 706c  shap_values(X_pl
+00056460: 6f74 290d 0a20 2020 2020 2020 2020 2020  ot)..           
+00056470: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
+00056480: 2e66 6967 7572 6528 290d 0a20 2020 2020  .figure()..     
+00056490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000564a0: 2020 2073 6861 702e 7375 6d6d 6172 795f     shap.summary_
+000564b0: 706c 6f74 2873 6861 705f 7661 6c75 6573  plot(shap_values
+000564c0: 2c20 585f 706c 6f74 2c20 706c 6f74 5f74  , X_plot, plot_t
+000564d0: 7970 653d 2262 6172 2229 0d0a 2020 2020  ype="bar")..    
+000564e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000564f0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+00056500: 2021 3d20 2752 6567 7265 7373 696f 6e27   != 'Regression'
+00056510: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00056520: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00056530: 6c74 2e66 6967 7572 6528 290d 0a20 2020  lt.figure()..   
+00056540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056550: 2020 2020 2020 2020 2073 6861 702e 7375           shap.su
+00056560: 6d6d 6172 795f 706c 6f74 2873 6861 705f  mmary_plot(shap_
+00056570: 7661 6c75 6573 2c20 585f 706c 6f74 290d  values, X_plot).
+00056580: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00056590: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+000565a0: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
+000565b0: 6c64 206e 6f74 2070 6c6f 7420 5348 4150  ld not plot SHAP
+000565c0: 2076 616c 7565 7320 7369 6e63 6520 5348   values since SH
+000565d0: 4150 2069 7320 6e6f 7420 696e 7374 616c  AP is not instal
+000565e0: 6c65 6420 6f72 2063 6f75 6c64 206e 6f74  led or could not
+000565f0: 2069 6d70 6f72 7420 5348 4150 2069 6e20   import SHAP in 
+00056600: 7468 6973 206d 6163 6869 6e65 2729 0d0a  this machine')..
+00056610: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00056620: 2020 2023 2323 2323 2323 2323 2323 2320     ############ 
+00056630: 4e6f 2050 6c6f 7474 696e 6720 6665 6174  No Plotting feat
+00056640: 7572 6520 696d 706f 7274 616e 6365 7320  ure importances 
+00056650: 666f 7220 4d75 6c74 692d 4c61 6265 6c20  for Multi-Label 
+00056660: 7072 6f62 6c65 6d73 2023 2323 2323 2323  problems #######
+00056670: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00056680: 2070 7269 6e74 2827 2020 2020 4e6f 2066   print('    No f
+00056690: 6561 7475 7265 2069 6d70 6f72 7461 6e63  eature importanc
+000566a0: 6520 706c 6f74 7320 6176 6169 6c61 626c  e plots availabl
+000566b0: 6520 666f 7220 4d75 6c74 692d 4c61 6265  e for Multi-Labe
+000566c0: 6c20 7072 6f62 6c65 6d73 2729 0d0a 2020  l problems')..  
+000566d0: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+000566e0: 2323 2323 2323 2323 2050 2052 2045 2044  ######## P R E D
+000566f0: 2049 2043 2054 2049 204f 204e 2020 4f20   I C T I O N  O 
+00056700: 4e20 2054 2045 2053 2054 2020 2043 204f  N  T E S T   C O
+00056710: 204d 2050 204c 2045 2054 2045 2044 2020   M P L E T E D  
+00056720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056730: 2327 290d 0a20 2020 2070 7269 6e74 2827  #')..    print('
+00056740: 2020 2020 5469 6d65 2074 616b 656e 2074      Time taken t
+00056750: 6875 7320 6661 7220 2869 6e20 7365 636f  hus far (in seco
+00056760: 6e64 7329 203d 2025 302e 3066 2720 2528  nds) = %0.0f' %(
+00056770: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
+00056780: 745f 7469 6d65 2929 0d0a 2020 2020 2323  t_time))..    ##
+00056790: 2020 5772 6974 6520 7468 6520 7465 7374    Write the test
+000567a0: 2061 6e64 2073 7562 6d69 7373 696f 6e20   and submission 
+000567b0: 6669 6c65 7320 746f 2064 6973 6b20 2323  files to disk ##
+000567c0: 230d 0a20 2020 2070 7269 6e74 2827 5772  #..    print('Wr
+000567d0: 6974 696e 6720 4f75 7470 7574 2066 696c  iting Output fil
+000567e0: 6573 2074 6f20 6469 736b 2e2e 2e27 290d  es to disk...').
+000567f0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00056800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056850: 2323 0d0a 2020 2020 6966 206e 6f74 2069  ##..    if not i
+00056860: 7369 6e73 7461 6e63 6528 7465 7374 6d2c  sinstance(testm,
+00056870: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+00056880: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00056890: 2020 7772 6974 655f 6669 6c65 5f74 6f5f    write_file_to_
+000568a0: 666f 6c64 6572 2874 6573 746d 2c20 6561  folder(testm, ea
+000568b0: 6368 5f74 6172 6765 742c 2065 6163 685f  ch_target, each_
+000568c0: 7461 7267 6574 2b27 5f27 2b6d 6f64 656c  target+'_'+model
+000568d0: 7479 7065 2b27 5f27 2b27 7465 7374 5f6d  type+'_'+'test_m
+000568e0: 6f64 6966 6965 642e 6373 7627 290d 0a20  odified.csv').. 
+000568f0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+00056900: 2020 2044 2052 2041 2057 2020 204b 2044     D R A W   K D
+00056910: 2045 2020 5020 4c20 4f20 5420 5320 2020   E  P L O T S   
+00056920: 464f 5220 5052 4f42 4142 494c 4954 5920  FOR PROBABILITY 
+00056930: 4f46 2050 5245 4449 4354 494f 4e53 202d  OF PREDICTIONS -
+00056940: 2076 6572 7920 7573 6566 756c 2120 2323   very useful! ##
+00056950: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00056960: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
+00056970: 6520 213d 2027 5265 6772 6573 7369 6f6e  e != 'Regression
+00056980: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00056990: 2020 2020 6966 2076 6572 626f 7365 203e      if verbose >
+000569a0: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
+000569b0: 2020 2020 2020 2020 2020 7465 7374 6d5b            testm[
+000569c0: 7072 6f62 615f 636f 6c73 5d2e 706c 6f74  proba_cols].plot
+000569d0: 286b 696e 643d 276b 6465 272c 6669 6773  (kind='kde',figs
+000569e0: 697a 653d 2831 302c 3629 2c0d 0a20 2020  ize=(10,6),..   
+000569f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056a10: 2074 6974 6c65 3d27 5072 6564 6963 7469   title='Predicti
+00056a20: 7665 2050 726f 6261 6269 6c69 7479 2044  ve Probability D
+00056a30: 656e 7369 7479 2043 6861 7274 2077 6974  ensity Chart wit
+00056a40: 6820 7375 6767 6573 7465 6420 7468 7265  h suggested thre
+00056a50: 7368 6f6c 6420 696e 2072 6564 2729 0d0a  shold in red')..
+00056a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056a70: 2020 2020 706c 742e 6178 766c 696e 6528      plt.axvline(
+00056a80: 783d 6d5f 7468 7265 7368 2c20 636f 6c6f  x=m_thresh, colo
+00056a90: 723d 2772 272c 206c 696e 6573 7479 6c65  r='r', linestyle
+00056aa0: 3d27 2d2d 2729 3b0d 0a20 2020 2020 2020  ='--');..       
+00056ab0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00056ac0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00056ad0: 2045 7272 6f72 3a20 4e6f 7420 6162 6c65   Error: Not able
+00056ae0: 2074 6f20 7361 7665 2074 6573 7420 6d6f   to save test mo
+00056af0: 6469 6669 6564 2066 696c 652e 2053 6b69  dified file. Ski
+00056b00: 7070 696e 672e 2e2e 2729 0d0a 2020 2020  pping...')..    
+00056b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056b60: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00056b70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00056b80: 2873 616d 706c 655f 7375 626d 6973 7369  (sample_submissi
+00056b90: 6f6e 2c20 7374 7229 3a0d 0a20 2020 2020  on, str):..     
+00056ba0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00056bb0: 2020 2020 2069 6620 6c65 6e28 6964 5f63       if len(id_c
+00056bc0: 6f6c 7329 203e 2030 3a0d 0a20 2020 2020  ols) > 0:..     
+00056bd0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00056be0: 655f 7375 626d 6973 7369 6f6e 203d 2074  e_submission = t
+00056bf0: 6573 746d 5b69 645f 636f 6c73 5d0d 0a20  estm[id_cols].. 
+00056c00: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00056c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00056c20: 2020 7361 6d70 6c65 5f73 7562 6d69 7373    sample_submiss
+00056c30: 696f 6e20 3d20 7064 2e44 6174 6146 7261  ion = pd.DataFra
+00056c40: 6d65 2869 6e64 6578 3d74 6573 746d 2e69  me(index=testm.i
+00056c50: 6e64 6578 2c63 6f6c 756d 6e73 3d5b 5d29  ndex,columns=[])
+00056c60: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00056c70: 206c 656e 2874 6172 6765 7429 203d 3d20   len(target) == 
+00056c80: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00056c90: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
+00056ca0: 7562 6d69 7373 696f 6e5b 6561 6368 5f74  ubmission[each_t
+00056cb0: 6172 6765 745d 203d 2074 6573 746d 5b65  arget] = testm[e
+00056cc0: 6163 685f 7461 7267 6574 2b27 5f70 7265  ach_target+'_pre
+00056cd0: 6469 6374 696f 6e73 275d 0d0a 2020 2020  dictions']..    
+00056ce0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00056cf0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00056d00: 7265 6469 6374 5f63 6f6c 7320 3d20 5b78  redict_cols = [x
+00056d10: 2b27 5f70 7265 6469 6374 696f 6e73 2720  +'_predictions' 
+00056d20: 666f 7220 7820 696e 2074 6172 6765 745d  for x in target]
+00056d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00056d40: 2020 666f 7220 7072 6564 6963 745f 636f    for predict_co
+00056d50: 6c2c 2074 6172 6765 745f 636f 6c20 696e  l, target_col in
+00056d60: 207a 6970 2870 7265 6469 6374 5f63 6f6c   zip(predict_col
+00056d70: 732c 2074 6172 6765 7429 3a0d 0a20 2020  s, target):..   
+00056d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056d90: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00056da0: 6f6e 5b74 6172 6765 745f 636f 6c5d 203d  on[target_col] =
+00056db0: 2074 6573 746d 5b70 7265 6469 6374 5f63   testm[predict_c
+00056dc0: 6f6c 5d0d 0a20 2020 2020 2020 2065 7863  ol]..        exc
+00056dd0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00056de0: 2020 7072 696e 7428 2745 7272 6f72 3a20    print('Error: 
+00056df0: 436f 756c 6420 6e6f 7420 6372 6561 7465  Could not create
+00056e00: 2073 616d 706c 6520 7375 626d 6973 7369   sample submissi
+00056e10: 6f6e 2066 696c 6520 6672 6f6d 2054 6573  on file from Tes
+00056e20: 7420 6461 7461 2729 0d0a 2020 2020 7472  t data')..    tr
+00056e30: 793a 0d0a 2020 2020 2020 2020 7772 6974  y:..        writ
+00056e40: 655f 6669 6c65 5f74 6f5f 666f 6c64 6572  e_file_to_folder
+00056e50: 2873 616d 706c 655f 7375 626d 6973 7369  (sample_submissi
+00056e60: 6f6e 2c20 6561 6368 5f74 6172 6765 742c  on, each_target,
+00056e70: 2065 6163 685f 7461 7267 6574 2b27 5f27   each_target+'_'
+00056e80: 2b6d 6f64 656c 7479 7065 2b27 5f27 2b27  +modeltype+'_'+'
+00056e90: 7375 626d 6973 7369 6f6e 2e63 7376 2729  submission.csv')
+00056ea0: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
+00056eb0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00056ec0: 2020 4572 726f 723a 204e 6f74 2061 626c    Error: Not abl
+00056ed0: 6520 746f 2073 6176 6520 7375 626d 6973  e to save submis
+00056ee0: 7369 6f6e 2066 696c 652e 2053 6b69 7070  sion file. Skipp
+00056ef0: 696e 672e 2e2e 2729 0d0a 2020 2020 2323  ing...')..    ##
+00056f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00056f50: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00056f60: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
+00056f70: 2323 2320 4272 696e 6720 7472 6169 6e6d  ### Bring trainm
+00056f80: 2062 6163 6b20 746f 2069 7473 206f 7269   back to its ori
+00056f90: 6769 6e61 6c20 696e 6465 7820 2323 2323  ginal index ####
+00056fa0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00056fb0: 0a20 2020 2020 2020 206f 7269 675f 696e  .        orig_in
+00056fc0: 6465 7820 3d20 6f72 6967 5f74 7261 696e  dex = orig_train
+00056fd0: 2e69 6e64 6578 0d0a 2020 2020 2020 2020  .index..        
+00056fe0: 7472 6169 6e6d 203d 2074 7261 696e 2e72  trainm = train.r
+00056ff0: 6569 6e64 6578 2869 6e64 6578 203d 206f  eindex(index = o
+00057000: 7269 675f 696e 6465 7829 0d0a 2020 2020  rig_index)..    
+00057010: 2020 2020 7772 6974 655f 6669 6c65 5f74      write_file_t
+00057020: 6f5f 666f 6c64 6572 2874 7261 696e 6d2c  o_folder(trainm,
+00057030: 2065 6163 685f 7461 7267 6574 2c20 6561   each_target, ea
+00057040: 6368 5f74 6172 6765 742b 275f 272b 6d6f  ch_target+'_'+mo
+00057050: 6465 6c74 7970 652b 275f 272b 2774 7261  deltype+'_'+'tra
+00057060: 696e 5f6d 6f64 6966 6965 642e 6373 7627  in_modified.csv'
+00057070: 290d 0a20 2020 2065 7863 6570 743a 0d0a  )..    except:..
+00057080: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00057090: 2020 2045 7272 6f72 3a20 4e6f 7420 6162     Error: Not ab
+000570a0: 6c65 2074 6f20 7361 7665 2074 7261 696e  le to save train
+000570b0: 206d 6f64 6966 6965 6420 6669 6c65 2e20   modified file. 
+000570c0: 536b 6970 7069 6e67 2e2e 2e27 290d 0a20  Skipping...').. 
+000570d0: 2020 2023 2323 2049 6e20 6361 7365 206f     ### In case o
+000570e0: 6620 6d75 6c74 692d 6c61 6265 6c20 6d6f  f multi-label mo
+000570f0: 6465 6c73 2c20 7765 2077 696c 6c20 7265  dels, we will re
+00057100: 7365 7420 7468 6520 7374 6172 7420 7472  set the start tr
+00057110: 6169 6e20 616e 6420 7465 7374 2064 6174  ain and test dat
+00057120: 6166 7261 6d65 7320 746f 2063 6f6e 7461  aframes to conta
+00057130: 696e 206e 6577 2066 6561 7475 7265 7320  in new features 
+00057140: 6372 6561 7465 640d 0a20 2020 2073 7461  created..    sta
+00057150: 7274 5f74 7261 696e 203d 2073 7461 7274  rt_train = start
+00057160: 5f74 7261 696e 5b74 6172 6765 745d 2e6a  _train[target].j
+00057170: 6f69 6e28 7374 6172 745f 7472 6169 6e5b  oin(start_train[
+00057180: 6f72 6967 5f72 6564 5f70 7265 6473 5d29  orig_red_preds])
+00057190: 0d0a 2020 2020 6966 206e 6f74 2069 7369  ..    if not isi
+000571a0: 6e73 7461 6e63 6528 6f72 6967 5f74 6573  nstance(orig_tes
+000571b0: 742c 2073 7472 293a 0d0a 2020 2020 2020  t, str):..      
+000571c0: 2020 7374 6172 745f 7465 7374 203d 2073    start_test = s
+000571d0: 7461 7274 5f74 6573 745b 6f72 6967 5f72  tart_test[orig_r
+000571e0: 6564 5f70 7265 6473 5d0d 0a20 2020 2023  ed_preds]..    #
+000571f0: 2323 2320 4f6e 6365 2065 6163 6820 7461  ### Once each ta
+00057200: 7267 6574 2063 7963 6c65 2069 7320 6f76  rget cycle is ov
+00057210: 6572 2c20 7265 7365 7420 7468 6520 7265  er, reset the re
+00057220: 645f 7072 6564 7320 746f 2074 6865 206f  d_preds to the o
+00057230: 7269 675f 7265 645f 7072 6564 7320 736f  rig_red_preds so
+00057240: 2077 6520 6361 6e20 7374 6172 7420 6f76   we can start ov
+00057250: 6572 0d0a 2020 2020 2372 6564 5f70 7265  er..    #red_pre
+00057260: 6473 203d 2063 6f70 792e 6465 6570 636f  ds = copy.deepco
+00057270: 7079 286f 7269 675f 7265 645f 7072 6564  py(orig_red_pred
+00057280: 7329 0d0a 2020 2020 6966 206d 6f64 656c  s)..    if model
+00057290: 5f6c 6162 656c 2021 3d20 2753 696e 676c  _label != 'Singl
+000572a0: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
+000572b0: 2020 2023 2323 2320 5065 7266 6f72 6d20     #### Perform 
+000572c0: 4669 6e61 6c20 4d75 6c74 692d 4c61 6265  Final Multi-Labe
+000572d0: 6c20 4f70 6572 6174 696f 6e73 2068 6572  l Operations her
+000572e0: 6520 7369 6e63 6520 616c 6c20 4c61 6265  e since all Labe
+000572f0: 6c73 2061 7265 2066 696e 6973 6865 6420  ls are finished 
+00057300: 6279 206e 6f77 2023 2323 0d0a 2020 2020  by now ###..    
+00057310: 2020 2020 2323 2323 2044 6f6e 2774 2063      #### Don't c
+00057320: 6861 6e67 6520 7468 6520 7461 7267 6574  hange the target
+00057330: 2068 6572 6520 746f 2065 6163 685f 7461   here to each_ta
+00057340: 7267 6574 2073 696e 6365 2074 6869 7320  rget since this 
+00057350: 6973 2066 6f72 206d 756c 7469 2d6c 6162  is for multi-lab
+00057360: 656c 2073 6974 7561 7469 6f6e 7320 6f6e  el situations on
+00057370: 6c79 2023 2323 0d0a 2020 2020 2020 2020  ly ###..        
+00057380: 6966 2028 7363 6f72 696e 675f 7061 7261  if (scoring_para
+00057390: 6d65 7465 7220 3d3d 2027 6261 736b 6574  meter == 'basket
+000573a0: 5f72 6563 616c 6c27 206f 7220 7363 6f72  _recall' or scor
+000573b0: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
+000573c0: 2027 6a61 6363 6172 6427 2920 616e 6420   'jaccard') and 
+000573d0: 6d6f 6465 6c74 7970 6520 213d 2027 5265  modeltype != 'Re
+000573e0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+000573f0: 2020 2020 2020 2020 795f 7072 6564 7320          y_preds 
+00057400: 3d20 6e70 2e61 7272 6179 286c 6973 7428  = np.array(list(
+00057410: 7a69 7070 6564 2929 0d0a 2020 2020 2020  zipped))..      
+00057420: 2020 2020 2020 5f2c 5f2c 5f2c 795f 6163        _,_,_,y_ac
+00057430: 7475 616c 7320 3d20 7472 6169 6e5f 7465  tuals = train_te
+00057440: 7374 5f73 706c 6974 2874 7261 696e 5b72  st_split(train[r
+00057450: 6564 5f70 7265 6473 5d2c 2074 7261 696e  ed_preds], train
+00057460: 5b74 6172 6765 745d 2e76 616c 7565 732c  [target].values,
+00057470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00057480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057490: 2020 2020 2020 2020 2020 7465 7374 5f73            test_s
+000574a0: 697a 653d 7465 7374 5f73 697a 652c 2072  ize=test_size, r
+000574b0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+000574c0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+000574d0: 7269 6e74 2827 5368 6170 6520 6f66 2041  rint('Shape of A
+000574e0: 6374 7561 6c73 3a20 2573 2061 6e64 2050  ctuals: %s and P
+000574f0: 7265 6473 3a20 2573 2720 2528 795f 6163  reds: %s' %(y_ac
+00057500: 7475 616c 732e 7368 6170 655b 305d 2c20  tuals.shape[0], 
+00057510: 795f 7072 6564 732e 7368 6170 655b 305d  y_preds.shape[0]
+00057520: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00057530: 6966 2079 5f61 6374 7561 6c73 2e73 6861  if y_actuals.sha
+00057540: 7065 5b30 5d20 3d3d 2079 5f70 7265 6473  pe[0] == y_preds
+00057550: 2e73 6861 7065 5b30 5d3a 0d0a 2020 2020  .shape[0]:..    
+00057560: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00057570: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+00057580: 203d 3d20 2762 6173 6b65 745f 7265 6361   == 'basket_reca
+00057590: 6c6c 2720 616e 6420 6c65 6e28 7461 7267  ll' and len(targ
+000575a0: 6574 2920 3e20 313a 0d0a 2020 2020 2020  et) > 1:..      
+000575b0: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+000575c0: 6375 5f61 6c6c 203d 2062 6173 6b65 745f  cu_all = basket_
+000575d0: 7265 6361 6c6c 2879 5f61 6374 7561 6c73  recall(y_actuals
+000575e0: 2c20 795f 7072 6564 7329 2e6d 6561 6e28  , y_preds).mean(
+000575f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00057600: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00057610: 2020 2020 2020 4d65 616e 2042 6173 6b65        Mean Baske
+00057620: 7420 5265 6361 6c6c 203d 207b 3a2c 2e31  t Recall = {:,.1
+00057630: 667d 2527 2e66 6f72 6d61 7428 0d0a 2020  f}%'.format(..  
+00057640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057680: 2020 6163 6375 5f61 6c6c 2a31 3030 2929    accu_all*100))
+00057690: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000576a0: 2020 656c 6966 2073 636f 7269 6e67 5f70    elif scoring_p
+000576b0: 6172 616d 6574 6572 203d 3d20 276a 6163  arameter == 'jac
+000576c0: 6361 7264 2720 616e 6420 6c65 6e28 7461  card' and len(ta
+000576d0: 7267 6574 2920 3e20 313a 0d0a 2020 2020  rget) > 1:..    
+000576e0: 2020 2020 2020 2020 2020 2020 2323 2020              ##  
+000576f0: 5468 6973 2073 686f 7773 2073 696d 696c  This shows simil
+00057700: 6172 6974 7920 696e 206d 756c 7469 2d6c  arity in multi-l
+00057710: 6162 656c 2073 6974 7561 7469 6f6e 7320  abel situations 
+00057720: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00057730: 2020 2020 2020 2020 2020 6163 6375 5f61            accu_a
+00057740: 6c6c 203d 206a 6163 6361 7264 5f6d 756c  ll = jaccard_mul
+00057750: 7469 6c61 6265 6c28 795f 6163 7475 616c  tilabel(y_actual
+00057760: 732c 2079 5f70 7265 6473 290d 0a20 2020  s, y_preds)..   
+00057770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057780: 2070 7269 6e74 2827 2020 2020 2020 2020   print('        
+00057790: 4d65 616e 204a 6163 6361 7264 2053 696d  Mean Jaccard Sim
+000577a0: 696c 6172 6974 7920 203d 2025 7327 2025  ilarity  = %s' %
+000577b0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000577c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000577d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000577e0: 6363 755f 616c 6c29 290d 0a20 2020 2020  ccu_all))..     
+000577f0: 2020 2023 2320 2020 454e 4420 4f46 2053     ##   END OF S
+00057800: 484f 5749 4e47 204d 4554 5249 4353 204c  HOWING METRICS L
+00057810: 4142 454c 2049 4e20 4120 4d55 4c54 4920  ABEL IN A MULTI 
+00057820: 4c41 4245 4c20 4441 5441 2053 4554 2021  LABEL DATA SET !
+00057830: 2057 4845 5720 2120 2323 2323 2323 2323   WHEW ! ########
+00057840: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00057850: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
+00057860: 2323 2323 2323 2320 2043 204f 204d 2050  #######  C O M P
+00057870: 204c 2045 2054 2045 2044 2020 2323 2323   L E T E D  ####
+00057880: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+00057890: 2020 2020 7072 696e 7428 2754 696d 6520      print('Time 
+000578a0: 5461 6b65 6e20 696e 206d 696e 7320 3d20  Taken in mins = 
+000578b0: 2530 2e31 6620 666f 7220 7468 6520 456e  %0.1f for the En
+000578c0: 7469 7265 2050 726f 6365 7373 2720 2528  tire Process' %(
+000578d0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+000578e0: 7274 5f74 696d 6529 2f36 3029 290d 0a20  rt_time)/60)).. 
+000578f0: 2020 2023 7265 7475 726e 206d 6f64 656c     #return model
+00057900: 2c20 696d 705f 6665 6174 7572 6573 5f64  , imp_features_d
+00057910: 662e 696e 6465 782e 746f 6c69 7374 2829  f.index.tolist()
+00057920: 2c20 7472 6169 6e6d 2c20 7465 7374 6d0d  , trainm, testm.
+00057930: 0a20 2020 2072 6574 7572 6e20 6d6f 6465  .    return mode
+00057940: 6c2c 2069 6d70 6f72 7461 6e74 5f66 6561  l, important_fea
+00057950: 7475 7265 732c 2074 7261 696e 6d2c 2074  tures, trainm, t
+00057960: 6573 746d 0d0a 2323 2323 2323 2323 2323  estm..##########
+00057970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000579a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000579b0: 2323 2323 230d 0a64 6566 2070 6c6f 745f  #####..def plot_
+000579c0: 5348 4150 5f76 616c 7565 7328 6d2c 582c  SHAP_values(m,X,
+000579d0: 6d6f 6465 6c74 7970 652c 426f 6f73 7469  modeltype,Boosti
+000579e0: 6e67 5f46 6c61 673d 4661 6c73 652c 6d61  ng_Flag=False,ma
+000579f0: 7470 6c6f 746c 6962 5f66 6c61 673d 4661  tplotlib_flag=Fa
+00057a00: 6c73 652c 7665 7262 6f73 653d 3029 3a0d  lse,verbose=0):.
+00057a10: 0a20 2020 2069 6d70 6f72 7420 7368 6170  .    import shap
+00057a20: 0d0a 2020 2020 2320 6c6f 6164 204a 5320  ..    # load JS 
+00057a30: 7669 7375 616c 697a 6174 696f 6e20 636f  visualization co
+00057a40: 6465 2074 6f20 6e6f 7465 626f 6f6b 0d0a  de to notebook..
+00057a50: 2020 2020 6966 206e 6f74 206d 6174 706c      if not matpl
+00057a60: 6f74 6c69 625f 666c 6167 3a0d 0a20 2020  otlib_flag:..   
+00057a70: 2020 2020 2073 6861 702e 696e 6974 6a73       shap.initjs
+00057a80: 2829 3b0d 0a20 2020 2023 2065 7870 6c61  ();..    # expla
+00057a90: 696e 2074 6865 206d 6f64 656c 2773 2070  in the model's p
+00057aa0: 7265 6469 6374 696f 6e73 2075 7369 6e67  redictions using
+00057ab0: 2053 4841 5020 7661 6c75 6573 0d0a 2020   SHAP values..  
+00057ac0: 2020 6578 706c 6169 6e65 7220 3d20 7368    explainer = sh
+00057ad0: 6170 2e54 7265 6545 7870 6c61 696e 6572  ap.TreeExplainer
+00057ae0: 286d 290d 0a20 2020 2073 6861 705f 7661  (m)..    shap_va
+00057af0: 6c75 6573 203d 2065 7870 6c61 696e 6572  lues = explainer
+00057b00: 2e73 6861 705f 7661 6c75 6573 2858 290d  .shap_values(X).
+00057b10: 0a20 2020 2069 6620 6e6f 7420 426f 6f73  .    if not Boos
+00057b20: 7469 6e67 5f46 6c61 6720 6973 204e 6f6e  ting_Flag is Non
+00057b30: 653a 0d0a 2020 2020 2020 2020 6966 2042  e:..        if B
+00057b40: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00057b50: 2020 2020 2020 2020 2020 2023 2076 6973             # vis
+00057b60: 7561 6c69 7a65 2074 6865 2066 6972 7374  ualize the first
+00057b70: 2070 7265 6469 6374 696f 6e27 7320 6578   prediction's ex
+00057b80: 706c 616e 6174 696f 6e20 2875 7365 206d  planation (use m
+00057b90: 6174 706c 6f74 6c69 623d 5472 7565 2074  atplotlib=True t
+00057ba0: 6f20 6176 6f69 6420 4a61 7661 7363 7269  o avoid Javascri
+00057bb0: 7074 290d 0a20 2020 2020 2020 2020 2020  pt)..           
+00057bc0: 2069 6620 7665 7262 6f73 6520 3e20 3020   if verbose > 0 
+00057bd0: 616e 6420 6d6f 6465 6c74 7970 6520 213d  and modeltype !=
+00057be0: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
+00057bf0: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
+00057c00: 2020 2020 2020 2020 2020 7368 6170 2e73            shap.s
+00057c10: 756d 6d61 7279 5f70 6c6f 7428 7368 6170  ummary_plot(shap
+00057c20: 5f76 616c 7565 732c 2058 2c20 706c 6f74  _values, X, plot
+00057c30: 5f74 7970 653d 2276 696f 6c69 6e22 293b  _type="violin");
+00057c40: 0d0a 2020 2020 2020 2020 6966 2076 6572  ..        if ver
+00057c50: 626f 7365 203e 3d20 313a 0d0a 2020 2020  bose >= 1:..    
+00057c60: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
+00057c70: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
+00057c80: 616c 7565 732c 2058 2c20 706c 6f74 5f74  alues, X, plot_t
+00057c90: 7970 653d 2262 6172 2229 3b0d 0a20 2020  ype="bar");..   
+00057ca0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00057cb0: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
+00057cc0: 7428 7368 6170 5f76 616c 7565 732c 2058  t(shap_values, X
+00057cd0: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
+00057ce0: 2229 3b0d 0a23 2323 2323 2323 2323 2323  ");..###########
+00057cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057d30: 2323 2323 230d 0a23 2323 2323 2323 2323  #####..#########
+00057d40: 2323 2323 2323 2320 2020 2020 2046 696e  #######      Fin
+00057d50: 6420 746f 7020 6665 6174 7572 6573 2075  d top features u
+00057d60: 7369 6e67 2058 4742 2020 2020 2023 2323  sing XGB     ###
+00057d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057d80: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00057d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057dd0: 2323 0d0a 6672 6f6d 2078 6762 6f6f 7374  ##..from xgboost
+00057de0: 2069 6d70 6f72 7420 5847 4243 6c61 7373   import XGBClass
+00057df0: 6966 6965 722c 2058 4742 5265 6772 6573  ifier, XGBRegres
+00057e00: 736f 720d 0a64 6566 2066 696e 645f 746f  sor..def find_to
+00057e10: 705f 6665 6174 7572 6573 5f78 6762 2874  p_features_xgb(t
+00057e20: 7261 696e 2c70 7265 6473 2c6e 756d 7661  rain,preds,numva
+00057e30: 7273 2c74 6172 6765 742c 6d6f 6465 6c74  rs,target,modelt
+00057e40: 7970 652c 636f 7272 5f6c 696d 6974 2c76  ype,corr_limit,v
+00057e50: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
+00057e60: 2222 220d 0a20 2020 2054 6869 7320 6973  """..    This is
+00057e70: 2061 2066 6173 7420 7574 696c 6974 7920   a fast utility 
+00057e80: 7468 6174 2075 7365 7320 5847 4220 746f  that uses XGB to
+00057e90: 2066 696e 6420 746f 7020 6665 6174 7572   find top featur
+00057ea0: 6573 2e20 596f 750d 0a20 2020 2049 7420  es. You..    It 
+00057eb0: 7265 7475 726e 7320 6120 6c69 7374 206f  returns a list o
+00057ec0: 6620 696d 706f 7274 616e 7420 6665 6174  f important feat
+00057ed0: 7572 6573 2e0d 0a20 2020 2053 696e 6365  ures...    Since
+00057ee0: 2069 7420 6973 2058 4742 2c20 796f 7520   it is XGB, you 
+00057ef0: 646f 6e74 2068 6176 6520 746f 2072 6573  dont have to res
+00057f00: 7472 6963 7420 7468 6520 696e 7075 7420  trict the input 
+00057f10: 746f 206a 7573 7420 6e75 6d65 7269 6320  to just numeric 
+00057f20: 7661 7273 2e0d 0a20 2020 2059 6f75 2063  vars...    You c
+00057f30: 616e 2073 656e 6420 696e 2061 6c6c 206b  an send in all k
+00057f40: 696e 6473 206f 6620 7661 7273 2061 6e64  inds of vars and
+00057f50: 2069 7420 7769 6c6c 2074 616b 6520 6361   it will take ca
+00057f60: 7265 206f 6620 7472 616e 7366 6f72 6d69  re of transformi
+00057f70: 6e67 2069 742e 2053 7765 6574 210d 0a20  ng it. Sweet!.. 
+00057f80: 2020 2022 2222 0d0a 2020 2020 2323 2323     """..    ####
+00057f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057fa0: 2323 2020 2049 204d 2050 204f 2052 2054  ##   I M P O R T
+00057fb0: 2041 204e 2054 2023 2323 2323 2323 2323   A N T #########
+00057fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057fe0: 2323 2323 230d 0a20 2020 2023 2323 2323  #####..    #####
+00057ff0: 2320 5468 6973 2074 6f70 5f6e 756d 2064  # This top_num d
+00058000: 6563 6964 6573 2068 6f77 206d 616e 7920  ecides how many 
+00058010: 746f 705f 6e20 6665 6174 7572 6573 2058  top_n features X
+00058020: 4742 2073 656c 6563 7473 2069 6e20 6561  GB selects in ea
+00058030: 6368 2069 7465 7261 7469 6f6e 2e0d 0a20  ch iteration... 
+00058040: 2020 2023 2323 2320 2054 6865 7265 2061     ####  There a
+00058050: 2074 6f74 616c 206f 6620 3520 6974 6572   total of 5 iter
+00058060: 6174 696f 6e73 2e20 4865 6e63 6520 3578  ations. Hence 5x
+00058070: 3130 206d 6561 6e73 206d 6178 696d 756d  10 means maximum
+00058080: 2035 3020 6665 6174 7565 7320 7769 6c6c   50 featues will
+00058090: 2062 6520 7365 6c65 6374 6564 2e0d 0a20   be selected... 
+000580a0: 2020 2023 2323 2323 2020 4966 2074 6865     #####  If the
+000580b0: 7265 2061 7265 206d 6f72 6520 7468 616e  re are more than
+000580c0: 2035 3020 7661 7269 6162 6c65 732c 2074   50 variables, t
+000580d0: 6865 6e20 6d61 7869 6d75 6d20 352a 3235  hen maximum 5*25
+000580e0: 203d 2031 3235 2076 6172 6961 626c 6573   = 125 variables
+000580f0: 2077 696c 6c20 6265 2073 656c 6563 7465   will be selecte
+00058100: 640d 0a20 2020 2069 6620 6c65 6e28 7072  d..    if len(pr
+00058110: 6564 7329 203c 3d20 3530 3a0d 0a20 2020  eds) <= 50:..   
+00058120: 2020 2020 2074 6f70 5f6e 756d 203d 2031       top_num = 1
+00058130: 300d 0a20 2020 2065 6c73 653a 0d0a 2020  0..    else:..  
+00058140: 2020 2020 2020 746f 705f 6e75 6d20 3d20        top_num = 
+00058150: 3235 0d0a 2020 2020 2323 2323 2323 2323  25..    ########
+00058160: 2323 2323 2323 2323 2323 2323 2323 2020  ##############  
+00058170: 2049 204d 2050 204f 2052 2054 2041 204e   I M P O R T A N
+00058180: 2054 2023 2323 2323 2323 2323 2323 2323   T #############
+00058190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000581a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000581b0: 230d 0a20 2020 2023 2323 2320 4966 2074  #..    #### If t
+000581c0: 6865 7265 2061 7265 206d 6f72 6520 7468  here are more th
+000581d0: 616e 2033 3020 6361 7465 676f 7269 6361  an 30 categorica
+000581e0: 6c20 7661 7269 6162 6c65 7320 696e 2061  l variables in a
+000581f0: 2064 6174 6120 7365 742c 2069 7420 6973   data set, it is
+00058200: 2077 6f72 7468 2072 6564 7563 696e 6720   worth reducing 
+00058210: 6665 6174 7572 6573 2e0d 0a20 2020 2023  features...    #
+00058220: 2323 2320 204f 7468 6572 7769 7365 2e20  ###  Otherwise. 
+00058230: 5847 426f 6f73 7420 6973 2070 7265 7474  XGBoost is prett
+00058240: 7920 676f 6f64 2061 7420 6669 6e64 696e  y good at findin
+00058250: 6720 7468 6520 6265 7374 2066 6561 7475  g the best featu
+00058260: 7265 7320 7768 6574 6865 7220 6361 7420  res whether cat 
+00058270: 6f72 206e 756d 6572 6963 2021 0d0a 2020  or numeric !..  
+00058280: 2020 6e5f 7370 6c69 7473 203d 2035 0d0a    n_splits = 5..
+00058290: 2020 2020 6d61 785f 6465 7074 6820 3d20      max_depth = 
+000582a0: 380d 0a20 2020 206d 6178 5f63 6174 7320  8..    max_cats 
+000582b0: 3d20 350d 0a20 2020 2023 2323 2323 2323  = 5..    #######
+000582c0: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
+000582d0: 2020 4920 4d20 5020 4f20 5220 5420 4120    I M P O R T A 
+000582e0: 4e20 5420 2323 2323 2323 2323 2323 2323  N T ############
+000582f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058310: 2323 0d0a 2020 2020 7472 6169 6e20 3d20  ##..    train = 
+00058320: 636f 7079 2e64 6565 7063 6f70 7928 7472  copy.deepcopy(tr
+00058330: 6169 6e29 0d0a 2020 2020 7072 6564 7320  ain)..    preds 
+00058340: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00058350: 7072 6564 7329 0d0a 2020 2020 6e75 6d76  preds)..    numv
+00058360: 6172 7320 3d20 636f 7079 2e64 6565 7063  ars = copy.deepc
+00058370: 6f70 7928 6e75 6d76 6172 7329 0d0a 2020  opy(numvars)..  
+00058380: 2020 7375 6273 616d 706c 6520 3d20 2030    subsample =  0
+00058390: 2e37 0d0a 2020 2020 636f 6c5f 7375 625f  .7..    col_sub_
+000583a0: 7361 6d70 6c65 203d 2030 2e37 0d0a 2020  sample = 0.7..  
+000583b0: 2020 7472 6169 6e20 3d20 636f 7079 2e64    train = copy.d
+000583c0: 6565 7063 6f70 7928 7472 6169 6e29 0d0a  eepcopy(train)..
+000583d0: 2020 2020 7374 6172 745f 7469 6d65 203d      start_time =
+000583e0: 2074 696d 652e 7469 6d65 2829 0d0a 2020   time.time()..  
+000583f0: 2020 7465 7374 5f73 697a 6520 3d20 302e    test_size = 0.
+00058400: 320d 0a20 2020 2073 6565 6420 3d20 310d  2..    seed = 1.
+00058410: 0a20 2020 2065 6172 6c79 5f73 746f 7070  .    early_stopp
+00058420: 696e 6720 3d20 350d 0a20 2020 2023 2323  ing = 5..    ###
+00058430: 2323 2323 2041 6c6c 2074 6865 2064 6566  #### All the def
+00058440: 6175 6c74 2070 6172 616d 6574 6572 7320  ault parameters 
+00058450: 6172 6520 7365 7420 7570 206e 6f77 2023  are set up now #
+00058460: 2323 2323 2323 2323 0d0a 2020 2020 6b66  ########..    kf
+00058470: 203d 204b 466f 6c64 286e 5f73 706c 6974   = KFold(n_split
+00058480: 733d 6e5f 7370 6c69 7473 290d 0a20 2020  s=n_splits)..   
+00058490: 2072 656d 5f76 6172 7320 3d20 6c65 6674   rem_vars = left
+000584a0: 5f73 7562 7472 6163 7428 7072 6564 732c  _subtract(preds,
+000584b0: 6e75 6d76 6172 7329 0d0a 2020 2020 6361  numvars)..    ca
+000584c0: 7476 6172 7320 3d20 636f 7079 2e64 6565  tvars = copy.dee
+000584d0: 7063 6f70 7928 7265 6d5f 7661 7273 290d  pcopy(rem_vars).
+000584e0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000584f0: 2320 2020 4920 204d 2050 204f 2052 2054  #   I  M P O R T
+00058500: 2041 204e 2054 2021 2049 204d 2050 204f   A N T ! I M P O
+00058510: 2052 2054 2041 204e 2054 2021 2023 2323   R T A N T ! ###
+00058520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058530: 2323 230d 0a20 2020 2023 2323 2323 2049  ###..    ##### I
+00058540: 2061 6d20 7265 6d6f 7669 6e67 2074 6865   am removing the
+00058550: 2043 6174 2056 6172 7320 7365 6c65 6374   Cat Vars select
+00058560: 696f 6e20 7573 696e 6720 4c69 6e65 6172  ion using Linear
+00058570: 204d 6574 686f 6473 2073 696e 6365 2074   Methods since t
+00058580: 6865 7920 6661 696c 2073 6f20 6f66 7465  hey fail so ofte
+00058590: 6e2e 0d0a 2020 2020 2323 2323 2320 4c69  n...    ##### Li
+000585a0: 6e65 6172 206d 6574 686f 6473 2073 7563  near methods suc
+000585b0: 6820 6173 2043 6869 3220 6f72 204d 7574  h as Chi2 or Mut
+000585c0: 7561 6c20 496e 666f 726d 6174 696f 6e20  ual Information 
+000585d0: 5363 6f72 6520 6172 6520 6e6f 7420 6772  Score are not gr
+000585e0: 6561 740d 0a20 2020 2023 2323 2320 2066  eat..    ####  f
+000585f0: 6f72 2066 6561 7475 7265 2073 656c 6563  or feature selec
+00058600: 7469 6f6e 2073 696e 6365 2074 6865 7920  tion since they 
+00058610: 6361 6e27 7420 6861 6e64 6c65 206c 6172  can't handle lar
+00058620: 6765 2064 6174 6120 616e 6420 7072 6f76  ge data and prov
+00058630: 6964 650d 0a20 2020 2023 2323 2320 2069  ide..    ####  i
+00058640: 6e63 6f6e 7369 7374 656e 7420 7265 7375  nconsistent resu
+00058650: 6c74 7320 666f 7220 6c61 7267 6520 6461  lts for large da
+00058660: 7461 2073 6574 732e 2048 656e 6365 2049  ta sets. Hence I
+00058670: 2061 6d20 7573 696e 6720 5847 426f 6f73   am using XGBoos
+00058680: 7420 616c 6f6e 652e 0d0a 2020 2020 2323  t alone...    ##
+00058690: 2323 2020 416c 736f 2c20 616e 6f74 6865  ##  Also, anothe
+000586a0: 7220 6d65 7468 6f64 206f 6620 7573 696e  r method of usin
+000586b0: 6720 5370 6561 726d 616e 2043 6f72 7265  g Spearman Corre
+000586c0: 6c61 7469 6f6e 2066 6f72 2043 6174 5661  lation for CatVa
+000586d0: 7273 2077 6974 6820 3130 3027 730d 0a20  rs with 100's.. 
+000586e0: 2020 2023 2323 2320 206f 6620 7661 7269     ####  of vari
+000586f0: 6162 6c65 7320 6973 2065 7874 7265 6d65  ables is extreme
+00058700: 6c79 2073 6c6f 772e 2041 6c73 6f2c 2069  ly slow. Also, i
+00058710: 7427 7320 6566 6665 6374 6976 656e 6573  t's effectivenes
+00058720: 2069 7320 6e6f 7420 7665 7279 2063 6c65   is not very cle
+00058730: 6172 2e0d 0a20 2020 2023 2323 2320 2048  ar...    ####  H
+00058740: 656e 6365 2066 6f72 206e 6f77 2c20 4920  ence for now, I 
+00058750: 616d 206e 6f74 2067 6f69 6e67 2074 6f20  am not going to 
+00058760: 7573 6520 5370 6561 726d 616e 206d 6574  use Spearman met
+00058770: 686f 642e 0d0a 2020 2020 2323 2323 2323  hod...    ######
+00058780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00058790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000587a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000587b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000587c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000587d0: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-000587e0: 7072 696e 7428 2723 2323 2323 2323 2020  print('#######  
-000587f0: 2020 2046 2045 2041 2054 2055 2052 2045     F E A T U R E
-00058800: 2020 2053 2045 204c 2045 2043 2054 2049     S E L E C T I
-00058810: 204f 204e 2020 2020 4259 2020 2058 2047   O N    BY   X G
-00058820: 2042 204f 204f 2053 2054 2020 2020 2323   B O O S T    ##
-00058830: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
-00058840: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-00058850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058890: 2323 2323 2729 0d0a 2020 2020 696d 706f  ####')..    impo
-000588a0: 7274 616e 745f 6665 6174 7572 6573 203d  rtant_features =
-000588b0: 205b 5d0d 0a20 2020 2069 6620 6d6f 6465   []..    if mode
-000588c0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-000588d0: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-000588e0: 6f62 6a65 6374 6976 6520 3d20 2772 6567  objective = 'reg
-000588f0: 3a73 7175 6172 6564 6572 726f 7227 0d0a  :squarederror'..
-00058900: 2020 2020 2020 2020 6d6f 6465 6c5f 7867          model_xg
-00058910: 6220 3d20 5847 4252 6567 7265 7373 6f72  b = XGBRegressor
-00058920: 2820 6e5f 6573 7469 6d61 746f 7273 3d31  ( n_estimators=1
-00058930: 3030 2c73 7562 7361 6d70 6c65 3d73 7562  00,subsample=sub
-00058940: 7361 6d70 6c65 2c6f 626a 6563 7469 7665  sample,objective
-00058950: 3d6f 626a 6563 7469 7665 2c0d 0a20 2020  =objective,..   
-00058960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058970: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00058980: 7361 6d70 6c65 5f62 7974 7265 653d 636f  sample_bytree=co
-00058990: 6c5f 7375 625f 7361 6d70 6c65 2c72 6567  l_sub_sample,reg
-000589a0: 5f61 6c70 6861 3d30 2e35 2c20 7265 675f  _alpha=0.5, reg_
-000589b0: 6c61 6d62 6461 3d30 2e35 2c0d 0a20 2020  lambda=0.5,..   
-000589c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000589d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000589e0: 6564 3d31 2c72 616e 646f 6d5f 7374 6174  ed=1,random_stat
-000589f0: 653d 312c 6e5f 6a6f 6273 3d2d 312c 206e  e=1,n_jobs=-1, n
-00058a00: 7468 7265 6164 3d2d 3129 0d0a 2020 2020  thread=-1)..    
-00058a10: 2020 2020 6576 616c 5f6d 6574 7269 6320      eval_metric 
-00058a20: 3d20 2772 6d73 6527 0d0a 2020 2020 656c  = 'rmse'..    el
-00058a30: 7365 3a0d 0a20 2020 2020 2020 2023 2323  se:..        ###
-00058a40: 2320 5468 6973 2069 7320 666f 7220 436c  # This is for Cl
-00058a50: 6173 7369 6669 6572 7320 6f6e 6c79 0d0a  assifiers only..
-00058a60: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-00058a70: 3d20 6e70 2e75 6e69 7175 6528 7472 6169  = np.unique(trai
-00058a80: 6e5b 7461 7267 6574 5d2e 7661 6c75 6573  n[target].values
-00058a90: 290d 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-00058aa0: 6e28 636c 6173 7365 7329 203d 3d20 323a  n(classes) == 2:
-00058ab0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-00058ac0: 6465 6c5f 7867 6220 3d20 5847 4243 6c61  del_xgb = XGBCla
-00058ad0: 7373 6966 6965 7228 6261 7365 5f73 636f  ssifier(base_sco
-00058ae0: 7265 3d30 2e35 2c20 626f 6f73 7465 723d  re=0.5, booster=
-00058af0: 2767 6274 7265 6527 2c20 7375 6273 616d  'gbtree', subsam
-00058b00: 706c 653d 7375 6273 616d 706c 652c 0d0a  ple=subsample,..
-00058b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058b20: 636f 6c73 616d 706c 655f 6279 7472 6565  colsample_bytree
-00058b30: 3d63 6f6c 5f73 7562 5f73 616d 706c 652c  =col_sub_sample,
-00058b40: 6761 6d6d 613d 312c 206c 6561 726e 696e  gamma=1, learnin
-00058b50: 675f 7261 7465 3d30 2e31 2c20 6d61 785f  g_rate=0.1, max_
-00058b60: 6465 6c74 615f 7374 6570 3d30 2c0d 0a20  delta_step=0,.. 
-00058b70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00058b80: 6178 5f64 6570 7468 3d6d 6178 5f64 6570  ax_depth=max_dep
-00058b90: 7468 2c20 6d69 6e5f 6368 696c 645f 7765  th, min_child_we
-00058ba0: 6967 6874 3d31 2c20 6d69 7373 696e 673d  ight=1, missing=
-00058bb0: 2d39 3939 2c20 6e5f 6573 7469 6d61 746f  -999, n_estimato
-00058bc0: 7273 3d32 3030 2c0d 0a20 2020 2020 2020  rs=200,..       
-00058bd0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-00058be0: 2d31 2c20 6e74 6872 6561 643d 2d31 2c20  -1, nthread=-1, 
-00058bf0: 6f62 6a65 6374 6976 653d 2762 696e 6172  objective='binar
-00058c00: 793a 6c6f 6769 7374 6963 272c 2075 7365  y:logistic', use
-00058c10: 5f6c 6162 656c 5f65 6e63 6f64 6572 3d46  _label_encoder=F
-00058c20: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
-00058c30: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
-00058c40: 6174 653d 312c 2072 6567 5f61 6c70 6861  ate=1, reg_alpha
-00058c50: 3d30 2e35 2c20 7265 675f 6c61 6d62 6461  =0.5, reg_lambda
-00058c60: 3d30 2e35 2c0d 0a20 2020 2020 2020 2020  =0.5,..         
-00058c70: 2020 2020 2020 2073 6565 643d 3129 0d0a         seed=1)..
-00058c80: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00058c90: 5f6d 6574 7269 6320 3d20 276c 6f67 6c6f  _metric = 'loglo
-00058ca0: 7373 270d 0a20 2020 2020 2020 2065 6c73  ss'..        els
-00058cb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00058cc0: 6d6f 6465 6c5f 7867 6220 3d20 5847 4243  model_xgb = XGBC
-00058cd0: 6c61 7373 6966 6965 7228 6261 7365 5f73  lassifier(base_s
-00058ce0: 636f 7265 3d30 2e35 2c20 626f 6f73 7465  core=0.5, booste
-00058cf0: 723d 2767 6274 7265 6527 2c20 7375 6273  r='gbtree', subs
-00058d00: 616d 706c 653d 7375 6273 616d 706c 652c  ample=subsample,
-00058d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00058d20: 2020 2020 2020 2020 2020 636f 6c73 616d            colsam
-00058d30: 706c 655f 6279 7472 6565 3d63 6f6c 5f73  ple_bytree=col_s
-00058d40: 7562 5f73 616d 706c 652c 2067 616d 6d61  ub_sample, gamma
-00058d50: 3d31 2c20 6c65 6172 6e69 6e67 5f72 6174  =1, learning_rat
-00058d60: 653d 302e 312c 206d 6178 5f64 656c 7461  e=0.1, max_delta
-00058d70: 5f73 7465 703d 302c 0d0a 2020 2020 2020  _step=0,..      
-00058d80: 2020 2020 2020 2020 2020 6d61 785f 6465            max_de
-00058d90: 7074 683d 6d61 785f 6465 7074 682c 206d  pth=max_depth, m
-00058da0: 696e 5f63 6869 6c64 5f77 6569 6768 743d  in_child_weight=
-00058db0: 312c 206d 6973 7369 6e67 3d2d 3939 392c  1, missing=-999,
-00058dc0: 206e 5f65 7374 696d 6174 6f72 733d 3230   n_estimators=20
-00058dd0: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
-00058de0: 2020 2020 6e5f 6a6f 6273 3d2d 312c 206e      n_jobs=-1, n
-00058df0: 7468 7265 6164 3d2d 312c 206f 626a 6563  thread=-1, objec
-00058e00: 7469 7665 3d27 6d75 6c74 693a 736f 6674  tive='multi:soft
-00058e10: 6d61 7827 2c20 7573 655f 6c61 6265 6c5f  max', use_label_
-00058e20: 656e 636f 6465 723d 4661 6c73 652c 0d0a  encoder=False,..
-00058e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058e40: 7261 6e64 6f6d 5f73 7461 7465 3d31 2c20  random_state=1, 
-00058e50: 7265 675f 616c 7068 613d 302e 352c 2072  reg_alpha=0.5, r
-00058e60: 6567 5f6c 616d 6264 613d 302e 352c 0d0a  eg_lambda=0.5,..
+000587c0: 2323 2323 2323 2323 0d0a 2020 2020 2369  ########..    #i
+000587d0: 6620 6c65 6e28 6361 7476 6172 7329 203e  f len(catvars) >
+000587e0: 206d 6178 5f63 6174 733a 0d0a 2020 2020   max_cats:..    
+000587f0: 2320 2020 2073 7461 7274 5f74 696d 6520  #    start_time 
+00058800: 3d20 7469 6d65 2e74 696d 6528 290d 0a20  = time.time().. 
+00058810: 2020 2023 2020 2020 696d 706f 7274 616e     #    importan
+00058820: 745f 6361 7473 203d 2072 656d 6f76 655f  t_cats = remove_
+00058830: 7661 7269 6162 6c65 735f 7573 696e 675f  variables_using_
+00058840: 6661 7374 5f63 6f72 7265 6c61 7469 6f6e  fast_correlation
+00058850: 2874 7261 696e 2c63 6174 7661 7273 2c6d  (train,catvars,m
+00058860: 6f64 656c 7479 7065 2c0d 0a20 2020 2023  odeltype,..    #
+00058870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058880: 2020 2020 2020 2020 2063 6f72 725f 6c69           corr_li
+00058890: 6d69 742c 7665 7262 6f73 6529 0d0a 2020  mit,verbose)..  
+000588a0: 2020 2320 2020 2069 6620 7665 7262 6f73    #    if verbos
+000588b0: 6520 3e3d 2031 3a0d 0a20 2020 2023 2020  e >= 1:..    #  
+000588c0: 2020 2020 2020 7072 696e 7428 2754 696d        print('Tim
+000588d0: 6520 7461 6b65 6e20 666f 7220 7265 6475  e taken for redu
+000588e0: 6369 6e67 2068 6967 686c 7920 636f 7272  cing highly corr
+000588f0: 656c 6174 6564 2043 6174 6567 6f72 6963  elated Categoric
+00058900: 616c 2076 6172 7320 7761 7320 2530 2e30  al vars was %0.0
+00058910: 6620 7365 636f 6e64 7327 2025 2874 696d  f seconds' %(tim
+00058920: 652e 7469 6d65 2829 2d73 7461 7274 5f74  e.time()-start_t
+00058930: 696d 6529 290d 0a20 2020 2023 656c 7365  ime))..    #else
+00058940: 3a0d 0a20 2020 2069 6d70 6f72 7461 6e74  :..    important
+00058950: 5f63 6174 7320 3d20 636f 7079 2e64 6565  _cats = copy.dee
+00058960: 7063 6f70 7928 6361 7476 6172 7329 0d0a  pcopy(catvars)..
+00058970: 2020 2020 7072 696e 7428 2720 2020 2028      print('    (
+00058980: 2564 2920 6361 7465 676f 7269 6361 6c20  %d) categorical 
+00058990: 7661 7273 2e2e 2e27 2025 286c 656e 2863  vars...' %(len(c
+000589a0: 6174 7661 7273 2929 290d 0a20 2020 2066  atvars)))..    f
+000589b0: 696e 616c 5f6c 6973 7420 3d20 636f 7079  inal_list = copy
+000589c0: 2e64 6565 7063 6f70 7928 6e75 6d76 6172  .deepcopy(numvar
+000589d0: 7329 0d0a 2020 2020 6966 2020 6973 696e  s)..    if  isin
+000589e0: 7374 616e 6365 2866 696e 616c 5f6c 6973  stance(final_lis
+000589f0: 742c 6e70 2e6e 6461 7272 6179 293a 0d0a  t,np.ndarray):..
+00058a00: 2020 2020 2020 2020 6669 6e61 6c5f 6c69          final_li
+00058a10: 7374 203d 2066 696e 616c 5f6c 6973 742e  st = final_list.
+00058a20: 746f 6c69 7374 2829 0d0a 2020 2020 7072  tolist()..    pr
+00058a30: 6564 7320 3d20 6669 6e61 6c5f 6c69 7374  eds = final_list
+00058a40: 2b69 6d70 6f72 7461 6e74 5f63 6174 730d  +important_cats.
+00058a50: 0a20 2020 2023 2323 2323 2323 596f 7520  .    #######You 
+00058a60: 6d75 7374 2063 6f6e 7665 7274 2063 6174  must convert cat
+00058a70: 6567 6f72 7920 7661 7269 6162 6c65 7320  egory variables 
+00058a80: 696e 746f 2069 6e74 6567 6572 7320 2323  into integers ##
+00058a90: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00058aa0: 2020 2066 6f72 2069 6d70 6f72 7461 6e74     for important
+00058ab0: 5f63 6174 2069 6e20 696d 706f 7274 616e  _cat in importan
+00058ac0: 745f 6361 7473 3a0d 0a20 2020 2020 2020  t_cats:..       
+00058ad0: 2069 6620 7374 7228 7472 6169 6e5b 696d   if str(train[im
+00058ae0: 706f 7274 616e 745f 6361 745d 2e64 7479  portant_cat].dty
+00058af0: 7065 2920 3d3d 2027 6361 7465 676f 7279  pe) == 'category
+00058b00: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00058b10: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
+00058b20: 6361 745d 203d 2074 7261 696e 5b69 6d70  cat] = train[imp
+00058b30: 6f72 7461 6e74 5f63 6174 5d2e 6173 7479  ortant_cat].asty
+00058b40: 7065 2869 6e74 290d 0a20 2020 2023 2323  pe(int)..    ###
+00058b50: 2323 2323 2320 2020 2044 726f 7020 4d69  #####    Drop Mi
+00058b60: 7373 696e 6720 7661 6c75 6520 726f 7773  ssing value rows
+00058b70: 2073 696e 6365 2058 4742 2066 6f72 2073   since XGB for s
+00058b80: 6f6d 6520 7265 6173 6f6e 2020 2323 2323  ome reason  ####
+00058b90: 2323 2323 230d 0a20 2020 2023 2323 2323  #####..    #####
+00058ba0: 2323 2320 2020 2063 616e 2774 2068 616e  ###    can't han
+00058bb0: 646c 6520 6d69 7373 696e 6720 7661 6c75  dle missing valu
+00058bc0: 6573 2069 6e20 6561 726c 7920 7374 6f70  es in early stop
+00058bd0: 7069 6e67 2072 6f75 6e64 7320 2323 2323  ping rounds ####
+00058be0: 2323 230d 0a20 2020 2074 7261 696e 2e64  ###..    train.d
+00058bf0: 726f 706e 6128 6178 6973 3d30 2c73 7562  ropna(axis=0,sub
+00058c00: 7365 743d 7072 6564 732b 5b74 6172 6765  set=preds+[targe
+00058c10: 745d 2c69 6e70 6c61 6365 3d54 7275 6529  t],inplace=True)
+00058c20: 0d0a 2020 2020 2323 2323 2323 2323 2020  ..    ########  
+00058c30: 2044 6f6e 7420 6d6f 7665 2074 6869 7320   Dont move this 
+00058c40: 7472 6169 6e20 616e 6420 7920 6465 6669  train and y defi
+00058c50: 6e69 7469 6f6e 2061 6e79 7768 6572 6520  nition anywhere 
+00058c60: 656c 7365 2023 2323 2323 2323 230d 0a20  else ########.. 
+00058c70: 2020 2079 203d 2074 7261 696e 5b74 6172     y = train[tar
+00058c80: 6765 745d 0d0a 2020 2020 7072 696e 7428  get]..    print(
+00058c90: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
+00058ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058ce0: 2729 0d0a 2020 2020 7072 696e 7428 2723  ')..    print('#
+00058cf0: 2323 2323 2323 2020 2020 2046 2045 2041  ######     F E A
+00058d00: 2054 2055 2052 2045 2020 2053 2045 204c   T U R E   S E L
+00058d10: 2045 2043 2054 2049 204f 204e 2020 2020   E C T I O N    
+00058d20: 4259 2020 2058 2047 2042 204f 204f 2053  BY   X G B O O S
+00058d30: 2054 2020 2020 2323 2323 2323 2323 2729   T    ########')
+00058d40: 0d0a 2020 2020 7072 696e 7428 2723 2323  ..    print('###
+00058d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058d90: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+00058da0: 2020 2020 696d 706f 7274 616e 745f 6665      important_fe
+00058db0: 6174 7572 6573 203d 205b 5d0d 0a20 2020  atures = []..   
+00058dc0: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
+00058dd0: 2027 5265 6772 6573 7369 6f6e 273a 0d0a   'Regression':..
+00058de0: 2020 2020 2020 2020 6f62 6a65 6374 6976          objectiv
+00058df0: 6520 3d20 2772 6567 3a73 7175 6172 6564  e = 'reg:squared
+00058e00: 6572 726f 7227 0d0a 2020 2020 2020 2020  error'..        
+00058e10: 6d6f 6465 6c5f 7867 6220 3d20 5847 4252  model_xgb = XGBR
+00058e20: 6567 7265 7373 6f72 2820 6e5f 6573 7469  egressor( n_esti
+00058e30: 6d61 746f 7273 3d31 3030 2c73 7562 7361  mators=100,subsa
+00058e40: 6d70 6c65 3d73 7562 7361 6d70 6c65 2c6f  mple=subsample,o
+00058e50: 626a 6563 7469 7665 3d6f 626a 6563 7469  bjective=objecti
+00058e60: 7665 2c0d 0a20 2020 2020 2020 2020 2020  ve,..           
 00058e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058e80: 7365 6564 3d31 290d 0a20 2020 2020 2020  seed=1)..       
-00058e90: 2020 2020 2065 7661 6c5f 6d65 7472 6963       eval_metric
-00058ea0: 203d 2027 6d6c 6f67 6c6f 7373 270d 0a20   = 'mlogloss'.. 
-00058eb0: 2020 2023 2323 2320 2020 5468 6973 2069     ####   This i
-00058ec0: 7320 7768 6572 6520 796f 7520 7374 6172  s where you star
-00058ed0: 7420 746f 2049 7465 7261 7465 206f 6e20  t to Iterate on 
-00058ee0: 4669 6e64 696e 6720 496d 706f 7274 616e  Finding Importan
-00058ef0: 7420 4665 6174 7572 6573 2023 2323 2323  t Features #####
-00058f00: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00058f10: 2073 6176 655f 7867 6220 3d20 636f 7079   save_xgb = copy
-00058f20: 2e64 6565 7063 6f70 7928 6d6f 6465 6c5f  .deepcopy(model_
-00058f30: 7867 6229 0d0a 2020 2020 7472 6169 6e5f  xgb)..    train_
-00058f40: 7020 3d20 7472 6169 6e5b 7072 6564 735d  p = train[preds]
-00058f50: 0d0a 2020 2020 6966 2074 7261 696e 5f70  ..    if train_p
-00058f60: 2e73 6861 7065 5b31 5d20 3c20 3130 3a0d  .shape[1] < 10:.
-00058f70: 0a20 2020 2020 2020 2069 7465 725f 6c69  .        iter_li
-00058f80: 6d69 7420 3d20 320d 0a20 2020 2065 6c73  mit = 2..    els
-00058f90: 653a 0d0a 2020 2020 2020 2020 6974 6572  e:..        iter
-00058fa0: 5f6c 696d 6974 203d 2069 6e74 2874 7261  _limit = int(tra
-00058fb0: 696e 5f70 2e73 6861 7065 5b31 5d2f 352b  in_p.shape[1]/5+
-00058fc0: 302e 3529 0d0a 2020 2020 7072 696e 7428  0.5)..    print(
-00058fd0: 2743 7572 7265 6e74 206e 756d 6265 7220  'Current number 
-00058fe0: 6f66 2070 7265 6469 6374 6f72 7320 3d20  of predictors = 
-00058ff0: 2564 2027 2025 2874 7261 696e 5f70 2e73  %d ' %(train_p.s
-00059000: 6861 7065 5b31 5d2c 2929 0d0a 2020 2020  hape[1],))..    
-00059010: 7072 696e 7428 2720 2020 2046 696e 6469  print('    Findi
-00059020: 6e67 2049 6d70 6f72 7461 6e74 2046 6561  ng Important Fea
-00059030: 7475 7265 7320 7573 696e 6720 426f 6f73  tures using Boos
-00059040: 7465 6420 5472 6565 7320 616c 676f 7269  ted Trees algori
-00059050: 7468 6d2e 2e2e 2729 0d0a 2020 2020 7472  thm...')..    tr
-00059060: 793a 0d0a 2020 2020 2020 2020 666f 7220  y:..        for 
-00059070: 6920 696e 2072 616e 6765 2830 2c74 7261  i in range(0,tra
-00059080: 696e 5f70 2e73 6861 7065 5b31 5d2c 6974  in_p.shape[1],it
-00059090: 6572 5f6c 696d 6974 293a 0d0a 2020 2020  er_limit):..    
-000590a0: 2020 2020 2020 2020 6e65 775f 7867 6220          new_xgb 
-000590b0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-000590c0: 7361 7665 5f78 6762 290d 0a20 2020 2020  save_xgb)..     
-000590d0: 2020 2020 2020 2069 6620 7472 6169 6e5f         if train_
-000590e0: 702e 7368 6170 655b 315d 2d69 203c 2032  p.shape[1]-i < 2
-000590f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00059100: 2020 2023 2323 2049 6620 7468 6572 6520     ### If there 
-00059110: 6973 206a 7573 7420 6f6e 6520 7661 7269  is just one vari
-00059120: 6162 6c65 206c 6566 742c 2074 6865 6e20  able left, then 
-00059130: 6a75 7374 2073 6b69 7020 6974 2023 2323  just skip it ###
-00059140: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00059150: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
-00059160: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00059170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059180: 2070 7269 6e74 2827 2020 2020 2020 2020   print('        
-00059190: 7573 696e 6720 2564 2076 6172 6961 626c  using %d variabl
-000591a0: 6573 2e2e 2e27 2025 2874 7261 696e 5f70  es...' %(train_p
-000591b0: 2e73 6861 7065 5b31 5d2d 6929 290d 0a0d  .shape[1]-i))...
-000591c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000591d0: 7472 6169 6e5f 702e 7368 6170 655b 315d  train_p.shape[1]
-000591e0: 2d69 203c 2069 7465 725f 6c69 6d69 743a  -i < iter_limit:
-000591f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00059200: 2020 5820 3d20 7472 6169 6e5f 702e 696c    X = train_p.il
-00059210: 6f63 5b3a 2c69 3a5d 0d0a 2020 2020 2020  oc[:,i:]..      
-00059220: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00059230: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
-00059240: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
-00059250: 2020 2020 2020 2020 2020 2020 2074 7261               tra
-00059260: 696e 5f70 6172 7420 3d20 696e 7428 2831  in_part = int((1
-00059270: 2d74 6573 745f 7369 7a65 292a 582e 7368  -test_size)*X.sh
-00059280: 6170 655b 305d 290d 0a20 2020 2020 2020  ape[0])..       
-00059290: 2020 2020 2020 2020 2020 2020 2058 5f74               X_t
-000592a0: 7261 696e 2c20 585f 6376 2c20 795f 7472  rain, X_cv, y_tr
-000592b0: 6169 6e2c 2079 5f63 7620 3d20 585b 3a74  ain, y_cv = X[:t
-000592c0: 7261 696e 5f70 6172 745d 2c58 5b74 7261  rain_part],X[tra
-000592d0: 696e 5f70 6172 743a 5d2c 795b 3a74 7261  in_part:],y[:tra
-000592e0: 696e 5f70 6172 745d 2c79 5b74 7261 696e  in_part],y[train
-000592f0: 5f70 6172 743a 5d0d 0a20 2020 2020 2020  _part:]..       
-00059300: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00059310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059320: 2020 2020 585f 7472 6169 6e2c 2058 5f63      X_train, X_c
-00059330: 762c 2079 5f74 7261 696e 2c20 795f 6376  v, y_train, y_cv
-00059340: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
-00059350: 6c69 7428 582c 2079 2c0d 0a20 2020 2020  lit(X, y,..     
-00059360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059380: 2020 2020 2020 2020 2020 2074 6573 745f             test_
-00059390: 7369 7a65 3d74 6573 745f 7369 7a65 2c20  size=test_size, 
-000593a0: 7261 6e64 6f6d 5f73 7461 7465 3d73 6565  random_state=see
-000593b0: 642c 2073 7472 6174 6966 793d 7929 0d0a  d, stratify=y)..
-000593c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000593d0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-000593e0: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
-000593f0: 6574 203d 205b 2858 5f74 7261 696e 2c79  et = [(X_train,y
-00059400: 5f74 7261 696e 292c 2858 5f63 762c 795f  _train),(X_cv,y_
-00059410: 6376 295d 0d0a 2020 2020 2020 2020 2020  cv)]..          
-00059420: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00059430: 7867 622e 6669 7428 585f 7472 6169 6e2c  xgb.fit(X_train,
-00059440: 795f 7472 6169 6e2c 6561 726c 795f 7374  y_train,early_st
-00059450: 6f70 7069 6e67 5f72 6f75 6e64 733d 6561  opping_rounds=ea
-00059460: 726c 795f 7374 6f70 7069 6e67 2c65 7661  rly_stopping,eva
-00059470: 6c5f 7365 743d 6576 616c 5f73 6574 2c0d  l_set=eval_set,.
-00059480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000594a0: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
-000594b0: 7472 6963 3d65 7661 6c5f 6d65 7472 6963  tric=eval_metric
-000594c0: 2c76 6572 626f 7365 3d46 616c 7365 290d  ,verbose=False).
-000594d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000594e0: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-000594f0: 6561 7475 7265 7320 2b3d 2070 642e 5365  eatures += pd.Se
-00059500: 7269 6573 286d 6f64 656c 5f78 6762 2e67  ries(model_xgb.g
-00059510: 6574 5f62 6f6f 7374 6572 2829 2e67 6574  et_booster().get
-00059520: 5f73 636f 7265 280d 0a20 2020 2020 2020  _score(..       
-00059530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059540: 2020 2020 2020 2020 2069 6d70 6f72 7461           importa
-00059550: 6e63 655f 7479 7065 3d27 6761 696e 2729  nce_type='gain')
-00059560: 292e 736f 7274 5f76 616c 7565 7328 6173  ).sort_values(as
-00059570: 6365 6e64 696e 673d 4661 6c73 6529 5b3a  cending=False)[:
-00059580: 746f 705f 6e75 6d5d 2e69 6e64 6578 2e74  top_num].index.t
-00059590: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
-000595a0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-000595b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000595c0: 2020 2020 2020 6e65 775f 7867 622e 6669        new_xgb.fi
-000595d0: 7428 585f 7472 6169 6e2c 795f 7472 6169  t(X_train,y_trai
-000595e0: 6e2c 6561 726c 795f 7374 6f70 7069 6e67  n,early_stopping
-000595f0: 5f72 6f75 6e64 733d 6561 726c 795f 7374  _rounds=early_st
-00059600: 6f70 7069 6e67 2c65 7661 6c5f 7365 743d  opping,eval_set=
-00059610: 6576 616c 5f73 6574 2c0d 0a20 2020 2020  eval_set,..     
-00059620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059640: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
-00059650: 7661 6c5f 6d65 7472 6963 2c76 6572 626f  val_metric,verbo
-00059660: 7365 3d46 616c 7365 290d 0a20 2020 2020  se=False)..     
-00059670: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00059680: 7269 6e74 2827 5847 4220 6861 7320 6120  rint('XGB has a 
-00059690: 6275 6720 696e 2076 6572 7369 6f6e 2078  bug in version x
-000596a0: 6762 6f6f 7374 2031 2e30 3220 666f 7220  gboost 1.02 for 
-000596b0: 6665 6174 7572 6520 696d 706f 7274 616e  feature importan
-000596c0: 6365 732e 2054 7279 2074 6f20 696e 7374  ces. Try to inst
-000596d0: 616c 6c20 7665 7273 696f 6e20 302e 3930  all version 0.90
-000596e0: 206f 7220 312e 3130 202d 2063 6f6e 7469   or 1.10 - conti
-000596f0: 6e75 696e 672e 2e2e 2729 0d0a 2020 2020  nuing...')..    
-00059700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059710: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-00059720: 6573 202b 3d20 7064 2e53 6572 6965 7328  es += pd.Series(
-00059730: 6e65 775f 7867 622e 6765 745f 626f 6f73  new_xgb.get_boos
-00059740: 7465 7228 292e 6765 745f 7363 6f72 6528  ter().get_score(
-00059750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00059760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059770: 2020 696d 706f 7274 616e 6365 5f74 7970    importance_typ
-00059780: 653d 2767 6169 6e27 2929 2e73 6f72 745f  e='gain')).sort_
-00059790: 7661 6c75 6573 2861 7363 656e 6469 6e67  values(ascending
-000597a0: 3d46 616c 7365 295b 3a74 6f70 5f6e 756d  =False)[:top_num
-000597b0: 5d2e 696e 6465 782e 746f 6c69 7374 2829  ].index.tolist()
-000597c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000597d0: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
-000597e0: 7572 6573 203d 206c 6973 7428 4f72 6465  ures = list(Orde
-000597f0: 7265 6444 6963 742e 6672 6f6d 6b65 7973  redDict.fromkeys
-00059800: 2869 6d70 6f72 7461 6e74 5f66 6561 7475  (important_featu
-00059810: 7265 7329 290d 0a20 2020 2020 2020 2020  res))..         
-00059820: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00059830: 2020 2020 2020 2020 2020 5820 3d20 7472            X = tr
-00059840: 6169 6e5f 705b 6c69 7374 2874 7261 696e  ain_p[list(train
-00059850: 5f70 2e63 6f6c 756d 6e73 2e76 616c 7565  _p.columns.value
-00059860: 7329 5b69 3a74 7261 696e 5f70 2e73 6861  s)[i:train_p.sha
-00059870: 7065 5b31 5d5d 5d0d 0a20 2020 2020 2020  pe[1]]]..       
-00059880: 2020 2020 2020 2020 2023 2323 2320 5370           #### Sp
-00059890: 6c69 7420 6865 7265 2069 6e74 6f20 7472  lit here into tr
-000598a0: 6169 6e20 616e 6420 7465 7374 2023 2323  ain and test ###
-000598b0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-000598c0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-000598d0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-000598e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000598f0: 2020 2020 2020 2074 7261 696e 5f70 6172         train_par
-00059900: 7420 3d20 696e 7428 2831 2d74 6573 745f  t = int((1-test_
-00059910: 7369 7a65 292a 582e 7368 6170 655b 305d  size)*X.shape[0]
-00059920: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00059930: 2020 2020 2020 2058 5f74 7261 696e 2c20         X_train, 
-00059940: 585f 6376 2c20 795f 7472 6169 6e2c 2079  X_cv, y_train, y
-00059950: 5f63 7620 3d20 585b 3a74 7261 696e 5f70  _cv = X[:train_p
-00059960: 6172 745d 2c58 5b74 7261 696e 5f70 6172  art],X[train_par
-00059970: 743a 5d2c 795b 3a74 7261 696e 5f70 6172  t:],y[:train_par
-00059980: 745d 2c79 5b74 7261 696e 5f70 6172 743a  t],y[train_part:
-00059990: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-000599a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000599b0: 2020 2020 2020 2020 2020 2020 2020 585f                X_
-000599c0: 7472 6169 6e2c 2058 5f63 762c 2079 5f74  train, X_cv, y_t
-000599d0: 7261 696e 2c20 795f 6376 203d 2074 7261  rain, y_cv = tra
-000599e0: 696e 5f74 6573 745f 7370 6c69 7428 582c  in_test_split(X,
-000599f0: 2079 2c0d 0a20 2020 2020 2020 2020 2020   y,..           
-00059a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059a20: 2020 2020 2020 2020 2074 6573 745f 7369           test_si
-00059a30: 7a65 3d74 6573 745f 7369 7a65 2c20 7261  ze=test_size, ra
-00059a40: 6e64 6f6d 5f73 7461 7465 3d73 6565 642c  ndom_state=seed,
-00059a50: 7374 7261 7469 6679 3d79 290d 0a20 2020  stratify=y)..   
-00059a60: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-00059a70: 6c5f 7365 7420 3d20 5b28 585f 7472 6169  l_set = [(X_trai
-00059a80: 6e2c 795f 7472 6169 6e29 2c28 585f 6376  n,y_train),(X_cv
-00059a90: 2c79 5f63 7629 5d0d 0a20 2020 2020 2020  ,y_cv)]..       
-00059aa0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00059ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059ac0: 2020 206d 6f64 656c 5f78 6762 2e66 6974     model_xgb.fit
-00059ad0: 2858 5f74 7261 696e 2c79 5f74 7261 696e  (X_train,y_train
-00059ae0: 2c65 6172 6c79 5f73 746f 7070 696e 675f  ,early_stopping_
-00059af0: 726f 756e 6473 3d65 6172 6c79 5f73 746f  rounds=early_sto
-00059b00: 7070 696e 672c 0d0a 2020 2020 2020 2020  pping,..        
-00059b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059b20: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
-00059b30: 6574 3d65 7661 6c5f 7365 742c 6576 616c  et=eval_set,eval
-00059b40: 5f6d 6574 7269 633d 6576 616c 5f6d 6574  _metric=eval_met
-00059b50: 7269 632c 7665 7262 6f73 653d 4661 6c73  ric,verbose=Fals
-00059b60: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00059b70: 2020 2020 2020 2020 696d 706f 7274 616e          importan
-00059b80: 745f 6665 6174 7572 6573 202b 3d20 7064  t_features += pd
-00059b90: 2e53 6572 6965 7328 6d6f 6465 6c5f 7867  .Series(model_xg
-00059ba0: 622e 6765 745f 626f 6f73 7465 7228 292e  b.get_booster().
-00059bb0: 6765 745f 7363 6f72 6528 0d0a 2020 2020  get_score(..    
-00059bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059bd0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00059be0: 7274 616e 6365 5f74 7970 653d 2767 6169  rtance_type='gai
-00059bf0: 6e27 2929 2e73 6f72 745f 7661 6c75 6573  n')).sort_values
-00059c00: 2861 7363 656e 6469 6e67 3d46 616c 7365  (ascending=False
-00059c10: 295b 3a74 6f70 5f6e 756d 5d2e 696e 6465  )[:top_num].inde
-00059c20: 782e 746f 6c69 7374 2829 0d0a 2020 2020  x.tolist()..    
-00059c30: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00059c40: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00059c50: 2020 2020 2020 2020 206e 6577 5f78 6762           new_xgb
-00059c60: 2e66 6974 2858 5f74 7261 696e 2c79 5f74  .fit(X_train,y_t
-00059c70: 7261 696e 2c65 6172 6c79 5f73 746f 7070  rain,early_stopp
-00059c80: 696e 675f 726f 756e 6473 3d65 6172 6c79  ing_rounds=early
-00059c90: 5f73 746f 7070 696e 672c 0d0a 2020 2020  _stopping,..    
-00059ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059cb0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00059cc0: 616c 5f73 6574 3d65 7661 6c5f 7365 742c  al_set=eval_set,
-00059cd0: 6576 616c 5f6d 6574 7269 633d 6576 616c  eval_metric=eval
-00059ce0: 5f6d 6574 7269 632c 7665 7262 6f73 653d  _metric,verbose=
-00059cf0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-00059d00: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00059d10: 7274 616e 745f 6665 6174 7572 6573 202b  rtant_features +
-00059d20: 3d20 7064 2e53 6572 6965 7328 6d6f 6465  = pd.Series(mode
-00059d30: 6c5f 7867 622e 6765 745f 626f 6f73 7465  l_xgb.get_booste
-00059d40: 7228 292e 6765 745f 7363 6f72 6528 0d0a  r().get_score(..
-00059d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059d70: 696d 706f 7274 616e 6365 5f74 7970 653d  importance_type=
-00059d80: 2767 6169 6e27 2929 2e73 6f72 745f 7661  'gain')).sort_va
-00059d90: 6c75 6573 2861 7363 656e 6469 6e67 3d46  lues(ascending=F
-00059da0: 616c 7365 295b 3a74 6f70 5f6e 756d 5d2e  alse)[:top_num].
-00059db0: 696e 6465 782e 746f 6c69 7374 2829 0d0a  index.tolist()..
-00059dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059dd0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-00059de0: 6573 203d 206c 6973 7428 4f72 6465 7265  es = list(Ordere
-00059df0: 6444 6963 742e 6672 6f6d 6b65 7973 2869  dDict.fromkeys(i
-00059e00: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-00059e10: 7329 290d 0a20 2020 2065 7863 6570 743a  s))..    except:
-00059e20: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00059e30: 2746 696e 6469 6e67 2074 6f70 2066 6561  'Finding top fea
-00059e40: 7475 7265 7320 7573 696e 6720 5847 4220  tures using XGB 
-00059e50: 6973 2063 7261 7368 696e 672e 2043 6f6e  is crashing. Con
-00059e60: 7469 6e75 696e 6720 7769 7468 2061 6c6c  tinuing with all
-00059e70: 2070 7265 6469 6374 6f72 732e 2e2e 2729   predictors...')
-00059e80: 0d0a 2020 2020 2020 2020 696d 706f 7274  ..        import
-00059e90: 616e 745f 6665 6174 7572 6573 203d 2063  ant_features = c
-00059ea0: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
-00059eb0: 6473 290d 0a20 2020 2020 2020 2072 6574  ds)..        ret
-00059ec0: 7572 6e20 696d 706f 7274 616e 745f 6665  urn important_fe
-00059ed0: 6174 7572 6573 2c20 5b5d 2c20 5b5d 0d0a  atures, [], []..
-00059ee0: 2020 2020 696d 706f 7274 616e 745f 6665      important_fe
-00059ef0: 6174 7572 6573 203d 206c 6973 7428 4f72  atures = list(Or
-00059f00: 6465 7265 6444 6963 742e 6672 6f6d 6b65  deredDict.fromke
-00059f10: 7973 2869 6d70 6f72 7461 6e74 5f66 6561  ys(important_fea
-00059f20: 7475 7265 7329 290d 0a20 2020 2070 7269  tures))..    pri
-00059f30: 6e74 2827 466f 756e 6420 2564 2069 6d70  nt('Found %d imp
-00059f40: 6f72 7461 6e74 2066 6561 7475 7265 7327  ortant features'
-00059f50: 2025 6c65 6e28 696d 706f 7274 616e 745f   %len(important_
-00059f60: 6665 6174 7572 6573 2929 0d0a 2020 2020  features))..    
-00059f70: 2370 7269 6e74 2827 2020 2020 5469 6d65  #print('    Time
-00059f80: 2074 616b 656e 2028 696e 2073 6563 6f6e   taken (in secon
-00059f90: 6473 2920 3d20 2530 2e30 6627 2025 2874  ds) = %0.0f' %(t
-00059fa0: 696d 652e 7469 6d65 2829 2d73 7461 7274  ime.time()-start
-00059fb0: 5f74 696d 6529 290d 0a20 2020 206e 756d  _time))..    num
-00059fc0: 7661 7273 203d 205b 7820 666f 7220 7820  vars = [x for x 
-00059fd0: 696e 206e 756d 7661 7273 2069 6620 7820  in numvars if x 
-00059fe0: 696e 2069 6d70 6f72 7461 6e74 5f66 6561  in important_fea
-00059ff0: 7475 7265 735d 0d0a 2020 2020 696d 706f  tures]..    impo
-0005a000: 7274 616e 745f 6361 7473 203d 205b 7820  rtant_cats = [x 
-0005a010: 666f 7220 7820 696e 2069 6d70 6f72 7461  for x in importa
-0005a020: 6e74 5f63 6174 7320 6966 2078 2069 6e20  nt_cats if x in 
-0005a030: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0005a040: 6573 5d0d 0a20 2020 2072 6574 7572 6e20  es]..    return 
-0005a050: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0005a060: 6573 2c20 6e75 6d76 6172 732c 2069 6d70  es, numvars, imp
-0005a070: 6f72 7461 6e74 5f63 6174 730d 0a23 2323  ortant_cats..###
-0005a080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a0a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a0b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a0c0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0005a0d0: 6566 2062 6173 6b65 745f 7265 6361 6c6c  ef basket_recall
-0005a0e0: 286c 6162 656c 2c20 7072 6564 293a 0d0a  (label, pred):..
-0005a0f0: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
-0005a100: 7320 7465 7374 7320 7468 6520 7265 6361  s tests the reca
-0005a110: 6c6c 206f 6620 6120 6769 7665 6e20 6261  ll of a given ba
-0005a120: 736b 6574 206f 6620 6974 656d 7320 696e  sket of items in
-0005a130: 2061 206c 6162 656c 2062 7920 7468 6520   a label by the 
-0005a140: 7365 636f 6e64 2062 6173 6b65 742c 2070  second basket, p
-0005a150: 7265 642e 0d0a 2020 2020 4974 2063 6f6d  red...    It com
-0005a160: 7061 7265 7320 7468 6520 3220 6261 736b  pares the 2 bask
-0005a170: 6574 7320 2861 7272 6179 7320 6f72 206c  ets (arrays or l
-0005a180: 6973 7473 2920 6e61 6d65 6420 6173 206c  ists) named as l
-0005a190: 6162 656c 2061 6e64 2070 7265 642c 2061  abel and pred, a
-0005a1a0: 6e64 2066 696e 6473 2063 6f6d 6d6f 6e20  nd finds common 
-0005a1b0: 6974 656d 730d 0a20 2020 2062 6574 7765  items..    betwe
-0005a1c0: 656e 2074 6865 2074 776f 2e20 5468 656e  en the two. Then
-0005a1d0: 2069 7420 6469 7669 6465 7320 7468 6174   it divides that
-0005a1e0: 206c 656e 6774 6820 6279 2074 6865 2074   length by the t
-0005a1f0: 6f74 616c 206e 756d 6265 7220 6f66 2069  otal number of i
-0005a200: 7465 6d73 2069 6e20 7468 6520 6c61 6265  tems in the labe
-0005a210: 6c20 6261 736b 6574 0d0a 2020 2020 746f  l basket..    to
-0005a220: 2063 6f6d 6520 7570 2077 6974 6820 6120   come up with a 
-0005a230: 6261 736b 6574 2072 6563 616c 6c20 7363  basket recall sc
-0005a240: 6f72 652e 2054 6869 7320 7363 6f72 6520  ore. This score 
-0005a250: 6d61 7920 6265 2075 7365 6675 6c20 696e  may be useful in
-0005a260: 2072 6563 6f6d 6d65 6e64 6174 696f 6e20   recommendation 
-0005a270: 7072 6f62 6c65 6d73 0d0a 2020 2020 7768  problems..    wh
-0005a280: 6572 6520 796f 7520 6172 6520 696e 7465  ere you are inte
-0005a290: 7265 7374 6564 2069 6e20 6669 6e64 696e  rested in findin
-0005a2a0: 6720 686f 7720 6d61 6e79 2069 7465 6d73  g how many items
-0005a2b0: 2069 6e20 6120 6261 736b 6574 2028 6c61   in a basket (la
-0005a2c0: 6265 6c73 2920 7468 6174 2079 6f75 720d  bels) that your.
-0005a2d0: 0a20 2020 2070 7265 6469 6374 696f 6e73  .    predictions
-0005a2e0: 2028 7072 6564 2920 6261 736b 6574 2067   (pred) basket g
-0005a2f0: 6f74 2063 6f72 7265 6374 2e20 5468 6520  ot correct. The 
-0005a300: 6f72 6465 7220 6f66 2074 6865 2069 7465  order of the ite
-0005a310: 6d73 2069 6e20 7468 6520 6261 736b 6574  ms in the basket
-0005a320: 7320 646f 6573 206e 6f74 206d 6174 7465  s does not matte
-0005a330: 722e 0d0a 2020 2020 2222 220d 0a20 2020  r...    """..   
-0005a340: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
-0005a350: 6162 656c 2c20 6c69 7374 293a 0d0a 2020  abel, list):..  
-0005a360: 2020 2020 2020 6c61 6265 6c20 3d20 6e70        label = np
-0005a370: 2e61 7272 6179 286c 6162 656c 290d 0a20  .array(label).. 
-0005a380: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0005a390: 2870 7265 642c 206c 6973 7429 3a0d 0a20  (pred, list):.. 
-0005a3a0: 2020 2020 2020 2070 7265 6420 3d20 6e70         pred = np
-0005a3b0: 2e61 7272 6179 2870 7265 6429 0d0a 2020  .array(pred)..  
-0005a3c0: 2020 6966 206c 656e 286c 6162 656c 2920    if len(label) 
-0005a3d0: 3e20 313a 0d0a 2020 2020 2020 2020 6a61  > 1:..        ja
-0005a3e0: 6363 5f61 7272 203d 205b 5d0d 0a20 2020  cc_arr = []..   
-0005a3f0: 2020 2020 2066 6f72 2072 6f77 312c 726f       for row1,ro
-0005a400: 7732 2c63 6f75 6e74 2069 6e20 7a69 7028  w2,count in zip(
-0005a410: 6c61 6265 6c2c 7072 6564 2c20 7261 6e67  label,pred, rang
-0005a420: 6528 6c65 6e28 6c61 6265 6c29 2929 3a0d  e(len(label))):.
-0005a430: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
-0005a440: 6572 7365 6374 696f 6e20 3d20 6c65 6e28  ersection = len(
-0005a450: 6e70 2e69 6e74 6572 7365 6374 3164 2872  np.intersect1d(r
-0005a460: 6f77 312c 726f 7732 2929 0d0a 2020 2020  ow1,row2))..    
-0005a470: 2020 2020 2020 2020 756e 696f 6e20 3d20          union = 
-0005a480: 6c65 6e28 726f 7731 290d 0a20 2020 2020  len(row1)..     
-0005a490: 2020 2020 2020 206a 6163 6320 3d20 666c         jacc = fl
-0005a4a0: 6f61 7428 696e 7465 7273 6563 7469 6f6e  oat(intersection
-0005a4b0: 202f 2075 6e69 6f6e 290d 0a20 2020 2020   / union)..     
-0005a4c0: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
-0005a4d0: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
-0005a4e0: 2020 2020 2020 206a 6163 635f 6172 7220         jacc_arr 
-0005a4f0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-0005a500: 6a61 6363 290d 0a20 2020 2020 2020 2020  jacc)..         
-0005a510: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0005a520: 2020 2020 2020 2020 2020 6a61 6363 5f61            jacc_a
-0005a530: 7272 203d 206e 702e 725f 5b6a 6163 635f  rr = np.r_[jacc_
-0005a540: 6172 722c 6a61 6363 5d0d 0a20 2020 2020  arr,jacc]..     
-0005a550: 2020 2072 6574 7572 6e20 6a61 6363 5f61     return jacc_a
-0005a560: 7272 0d0a 2020 2020 656c 7365 3a0d 0a20  rr..    else:.. 
-0005a570: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
-0005a580: 696f 6e20 3d20 6c65 6e28 6c69 7374 2873  ion = len(list(s
-0005a590: 6574 286c 6973 7431 292e 696e 7465 7273  et(list1).inters
-0005a5a0: 6563 7469 6f6e 2873 6574 286c 6973 7432  ection(set(list2
-0005a5b0: 2929 2929 0d0a 2020 2020 2020 2020 756e  ))))..        un
-0005a5c0: 696f 6e20 3d20 286c 656e 286c 6973 7431  ion = (len(list1
-0005a5d0: 2920 2b20 6c65 6e28 6c69 7374 3229 2920  ) + len(list2)) 
-0005a5e0: 2d20 696e 7465 7273 6563 7469 6f6e 0d0a  - intersection..
-0005a5f0: 2020 2020 2020 2020 6a61 6363 5f61 7272          jacc_arr
-0005a600: 203d 2066 6c6f 6174 2869 6e74 6572 7365   = float(interse
-0005a610: 6374 696f 6e20 2f20 756e 696f 6e29 0d0a  ction / union)..
-0005a620: 2020 2020 7265 7475 726e 206a 6163 635f      return jacc_
-0005a630: 6172 720d 0a23 2323 2323 2323 2323 2323  arr..###########
-0005a640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a680: 2323 2323 230d 0a64 6566 206a 6163 6361  #####..def jacca
-0005a690: 7264 5f73 696e 676c 656c 6162 656c 286c  rd_singlelabel(l
-0005a6a0: 6162 656c 2c20 7072 6564 293a 0d0a 2020  abel, pred):..  
-0005a6b0: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
-0005a6c0: 636f 6d70 6172 6573 2032 2062 6173 6b65  compares 2 baske
-0005a6d0: 7473 2028 636f 756c 6420 6265 206c 6973  ts (could be lis
-0005a6e0: 7473 206f 7220 6172 7261 7973 293a 206c  ts or arrays): l
-0005a6f0: 6162 656c 2061 6e64 2070 7265 642c 2061  abel and pred, a
-0005a700: 6e64 2066 696e 6473 2063 6f6d 6d6f 6e20  nd finds common 
-0005a710: 6974 656d 730d 0a20 2020 2062 6574 7765  items..    betwe
-0005a720: 656e 2074 6865 2074 776f 2e20 5468 656e  en the two. Then
-0005a730: 2069 7420 6469 7669 6465 7320 7468 6174   it divides that
-0005a740: 206e 756d 6265 7220 6279 2065 6974 6865   number by eithe
-0005a750: 7220 726f 7773 206f 7220 636f 6c75 6d6e  r rows or column
-0005a760: 7320 746f 2072 6574 7572 6e20 252e 0d0a  s to return %...
-0005a770: 2020 2020 2020 2020 2323 2320 4a61 6363          ### Jacc
-0005a780: 6172 645f 436f 6c75 6d6e 7769 7365 203d  ard_Columnwise =
-0005a790: 2074 6869 7320 6d65 616e 7320 796f 7520   this means you 
-0005a7a0: 6861 7665 206d 756c 7469 2d6c 6162 656c  have multi-label
-0005a7b0: 7320 616e 6420 796f 7520 7761 6e74 2069  s and you want i
-0005a7c0: 7420 7375 6d6d 6564 2063 6f6c 756d 6e77  t summed columnw
-0005a7d0: 6973 650d 0a20 2020 2020 2020 2023 2323  ise..        ###
-0005a7e0: 2020 2054 6869 7320 7465 6c6c 7320 796f     This tells yo
-0005a7f0: 7520 7768 6174 2069 7320 7468 6520 6176  u what is the av
-0005a800: 6572 6167 6520 6163 6375 7261 6379 2066  erage accuracy f
-0005a810: 6f72 2065 6163 6820 636f 6c75 6d6e 2069  or each column i
-0005a820: 6e20 6d75 6c74 692d 6c61 6265 6c20 7461  n multi-label ta
-0005a830: 7267 6574 0d0a 2020 2020 2020 2020 2323  rget..        ##
-0005a840: 2320 2020 4974 2077 696c 6c20 7265 7475  #   It will retu
-0005a850: 726e 2061 7320 6d61 6e79 2074 6f74 616c  rn as many total
-0005a860: 7320 6173 2074 6865 206e 756d 6265 7220  s as the number 
-0005a870: 6f66 2063 6f6c 756d 6e73 2069 6e20 796f  of columns in yo
-0005a880: 7572 206d 756c 7469 2d6c 6162 656c 2074  ur multi-label t
-0005a890: 6172 6765 742e 0d0a 2020 2020 2020 2020  arget...        
-0005a8a0: 2323 2320 2020 546f 2067 6574 2061 2070  ###   To get a p
-0005a8b0: 6572 6365 6e74 6167 652c 2079 6f75 2077  ercentage, you w
-0005a8c0: 696c 6c20 6861 7665 2074 6f20 6469 7669  ill have to divi
-0005a8d0: 6465 2069 7420 6279 2074 6865 206e 756d  de it by the num
-0005a8e0: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
-0005a8f0: 6865 2064 6174 6120 7365 742e 0d0a 2020  he data set...  
-0005a900: 2020 2020 2020 2323 2320 2020 5468 6973        ###   This
-0005a910: 2070 6572 6365 6e74 6167 6520 6769 7665   percentage give
-0005a920: 7320 796f 7520 7468 6520 2520 6f66 2072  s you the % of r
-0005a930: 6f77 7320 696e 2065 6163 6820 6c61 6265  ows in each labe
-0005a940: 6c20 796f 7520 676f 7420 636f 7272 6563  l you got correc
-0005a950: 746c 793d 2545 6163 685f 4c61 6265 6c20  tly=%Each_Label 
-0005a960: 4163 6375 7261 6379 0d0a 2020 2020 2020  Accuracy..      
-0005a970: 2020 2323 2320 2020 5468 6973 2077 696c    ###   This wil
-0005a980: 6c20 6769 7665 2079 6f75 2061 7320 6d61  l give you as ma
-0005a990: 6e79 2070 6572 6365 6e74 6167 6573 2061  ny percentages a
-0005a9a0: 7320 7468 6572 6520 6172 6520 6c61 6265  s there are labe
-0005a9b0: 6c73 2069 6e20 796f 7572 206d 756c 7469  ls in your multi
-0005a9c0: 2d6c 6162 656c 2074 6172 6765 742e 0d0a  -label target...
-0005a9d0: 2020 2020 2020 2020 2323 2320 4a61 6363          ### Jacc
-0005a9e0: 6172 645f 526f 772d 7769 7365 203d 2074  ard_Row-wise = t
-0005a9f0: 6869 7320 6d65 616e 7320 796f 7520 6861  his means you ha
-0005aa00: 7665 2063 6f6d 626f 7320 6275 7420 7768  ve combos but wh
-0005aa10: 6572 6520 6f72 6465 7220 6d61 7474 6572  ere order matter
-0005aa20: 7320 616e 6420 796f 7520 7761 6e74 2069  s and you want i
-0005aa30: 7420 636f 6d70 6172 6564 2072 6f77 2d77  t compared row-w
-0005aa40: 6973 650d 0a20 2020 2020 2020 2023 2323  ise..        ###
-0005aa50: 2020 2054 6869 7320 7465 6c6c 7320 796f     This tells yo
-0005aa60: 7520 686f 7720 6d61 6e79 206c 6162 656c  u how many label
-0005aa70: 7320 696e 2065 6163 6820 726f 7720 6469  s in each row di
-0005aa80: 6420 796f 7520 6765 7420 7269 6768 742e  d you get right.
-0005aa90: 2054 4861 7427 7320 6163 6375 7261 6379   THat's accuracy
-0005aaa0: 2062 7920 726f 772e 0d0a 2020 2020 2020   by row...      
-0005aab0: 2020 2323 2320 2020 4974 2077 696c 6c20    ###   It will 
-0005aac0: 7265 7475 726e 2061 7320 6d61 6e79 2074  return as many t
-0005aad0: 6f74 616c 7320 6173 2074 6865 206e 756d  otals as the num
-0005aae0: 6265 7220 6f66 2072 6f77 7320 696e 2079  ber of rows in y
-0005aaf0: 6f75 7220 6461 7461 2073 6574 2e0d 0a20  our data set... 
-0005ab00: 2020 2020 2020 2023 2323 2020 2054 6f20         ###   To 
-0005ab10: 6765 7420 6120 7065 7263 656e 7461 6765  get a percentage
-0005ab20: 2c20 796f 7520 7769 6c6c 2068 6176 6520  , you will have 
-0005ab30: 746f 2064 6976 6964 6520 6974 2062 7920  to divide it by 
-0005ab40: 7468 6520 6e75 6d62 6572 206f 6620 6c61  the number of la
-0005ab50: 6265 6c73 2069 6e20 7468 6520 6461 7461  bels in the data
-0005ab60: 2073 6574 2e0d 0a20 2020 2020 2020 2023   set...        #
-0005ab70: 2323 2020 2054 6869 7320 7065 7263 656e  ##   This percen
-0005ab80: 7461 6765 2067 6976 6573 2079 6f75 2074  tage gives you t
-0005ab90: 6865 2025 206f 6620 6c61 6265 6c73 2069  he % of labels i
-0005aba0: 6e20 6561 6368 2072 6f77 2079 6f75 2067  n each row you g
-0005abb0: 6f74 2063 6f72 7265 6374 6c79 3d25 436f  ot correctly=%Co
-0005abc0: 6d62 696e 6564 5f4c 6162 656c 5f41 6363  mbined_Label_Acc
-0005abd0: 7572 6163 790d 0a20 2020 2020 2020 2023  uracy..        #
-0005abe0: 2323 2020 2054 6869 7320 7769 6c6c 2067  ##   This will g
-0005abf0: 6976 6520 796f 7520 6120 7369 6e67 6c65  ive you a single
-0005ac00: 2070 6572 6365 6e74 6167 6520 6e75 6d62   percentage numb
-0005ac10: 6572 2066 6f72 2074 6865 2077 686f 6c65  er for the whole
-0005ac20: 2064 6174 6120 7365 740d 0a20 2020 2022   data set..    "
-0005ac30: 2222 0d0a 2020 2020 6966 2069 7369 6e73  ""..    if isins
-0005ac40: 7461 6e63 6528 6c61 6265 6c2c 206c 6973  tance(label, lis
-0005ac50: 7429 3a0d 0a20 2020 2020 2020 206c 6162  t):..        lab
-0005ac60: 656c 203d 206e 702e 6172 7261 7928 6c61  el = np.array(la
-0005ac70: 6265 6c29 0d0a 2020 2020 6966 2069 7369  bel)..    if isi
-0005ac80: 6e73 7461 6e63 6528 7072 6564 2c20 6c69  nstance(pred, li
-0005ac90: 7374 293a 0d0a 2020 2020 2020 2020 7072  st):..        pr
-0005aca0: 6564 203d 206e 702e 6172 7261 7928 7072  ed = np.array(pr
-0005acb0: 6564 290d 0a20 2020 2074 7279 3a0d 0a20  ed)..    try:.. 
-0005acc0: 2020 2020 2020 2023 2323 2054 6869 7320         ### This 
-0005acd0: 6973 2066 6f72 204d 756c 7469 2d4c 6162  is for Multi-Lab
-0005ace0: 656c 2050 726f 626c 656d 7320 2323 2323  el Problems ####
-0005acf0: 2320 5265 7475 726e 7320 3220 7265 7375  # Returns 2 resu
-0005ad00: 6c74 733a 206f 6e65 206e 756d 6265 7220  lts: one number 
-0005ad10: 616e 640d 0a20 2020 2020 2020 2023 2323  and..        ###
-0005ad20: 2020 2020 7468 6520 7365 636f 6e64 2069      the second i
-0005ad30: 7320 616e 2061 7272 6179 2077 6974 6820  s an array with 
-0005ad40: 6173 206d 616e 7920 6974 656d 7320 6173  as many items as
-0005ad50: 206e 756d 6265 7220 6f66 206c 6162 656c   number of label
-0005ad60: 7320 696e 2074 6172 6765 740d 0a20 2020  s in target..   
-0005ad70: 2020 2020 206a 6163 635f 6561 6368 5f6c       jacc_each_l
-0005ad80: 6162 656c 203d 206e 702e 7375 6d28 6c61  abel = np.sum(la
-0005ad90: 6265 6c3d 3d70 7265 642c 6178 6973 3d30  bel==pred,axis=0
-0005ada0: 292f 6c61 6265 6c2e 7368 6170 655b 305d  )/label.shape[0]
-0005adb0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0005adc0: 2020 6a61 6363 5f65 6163 685f 6c61 6265    jacc_each_labe
-0005add0: 6c0d 0a20 2020 2065 7863 6570 743a 0d0a  l..    except:..
-0005ade0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-0005adf0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0005ae00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ae10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ae20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ae30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ae40: 2323 0d0a 6465 6620 6a61 6363 6172 645f  ##..def jaccard_
-0005ae50: 6d75 6c74 696c 6162 656c 286c 6162 656c  multilabel(label
-0005ae60: 2c20 7072 6564 293a 0d0a 2020 2020 2222  , pred):..    ""
-0005ae70: 220d 0a20 2020 2054 6869 7320 636f 6d70  "..    This comp
-0005ae80: 6172 6573 2032 2062 6173 6b65 7473 2028  ares 2 baskets (
-0005ae90: 636f 756c 6420 6265 206c 6973 7473 206f  could be lists o
-0005aea0: 7220 6172 7261 7973 293a 206c 6162 656c  r arrays): label
-0005aeb0: 2061 6e64 2070 7265 642c 2061 6e64 2066   and pred, and f
-0005aec0: 696e 6473 2063 6f6d 6d6f 6e20 6974 656d  inds common item
-0005aed0: 730d 0a20 2020 2062 6574 7765 656e 2074  s..    between t
-0005aee0: 6865 2074 776f 2e20 5468 656e 2069 7420  he two. Then it 
-0005aef0: 6469 7669 6465 7320 7468 6174 206e 756d  divides that num
-0005af00: 6265 7220 6279 2065 6974 6865 7220 726f  ber by either ro
-0005af10: 7773 206f 7220 636f 6c75 6d6e 7320 746f  ws or columns to
-0005af20: 2072 6574 7572 6e20 252e 0d0a 2020 2020   return %...    
-0005af30: 2020 2020 2323 2320 4a61 6363 6172 645f      ### Jaccard_
-0005af40: 436f 6c75 6d6e 7769 7365 203d 2074 6869  Columnwise = thi
-0005af50: 7320 6d65 616e 7320 796f 7520 6861 7665  s means you have
-0005af60: 206d 756c 7469 2d6c 6162 656c 7320 616e   multi-labels an
-0005af70: 6420 796f 7520 7761 6e74 2069 7420 7375  d you want it su
-0005af80: 6d6d 6564 2063 6f6c 756d 6e77 6973 650d  mmed columnwise.
-0005af90: 0a20 2020 2020 2020 2023 2323 2020 2054  .        ###   T
-0005afa0: 6869 7320 7465 6c6c 7320 796f 7520 7768  his tells you wh
-0005afb0: 6174 2069 7320 7468 6520 6176 6572 6167  at is the averag
-0005afc0: 6520 6163 6375 7261 6379 2066 6f72 2065  e accuracy for e
-0005afd0: 6163 6820 636f 6c75 6d6e 2069 6e20 6d75  ach column in mu
-0005afe0: 6c74 692d 6c61 6265 6c20 7461 7267 6574  lti-label target
-0005aff0: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
-0005b000: 4974 2077 696c 6c20 7265 7475 726e 2061  It will return a
-0005b010: 7320 6d61 6e79 2074 6f74 616c 7320 6173  s many totals as
-0005b020: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
-0005b030: 6f6c 756d 6e73 2069 6e20 796f 7572 206d  olumns in your m
-0005b040: 756c 7469 2d6c 6162 656c 2074 6172 6765  ulti-label targe
-0005b050: 742e 0d0a 2020 2020 2020 2020 2323 2320  t...        ### 
-0005b060: 2020 546f 2067 6574 2061 2070 6572 6365    To get a perce
-0005b070: 6e74 6167 652c 2079 6f75 2077 696c 6c20  ntage, you will 
-0005b080: 6861 7665 2074 6f20 6469 7669 6465 2069  have to divide i
-0005b090: 7420 6279 2074 6865 206e 756d 6265 7220  t by the number 
-0005b0a0: 6f66 2072 6f77 7320 696e 2074 6865 2064  of rows in the d
-0005b0b0: 6174 6120 7365 742e 0d0a 2020 2020 2020  ata set...      
-0005b0c0: 2020 2323 2320 2020 5468 6973 2070 6572    ###   This per
-0005b0d0: 6365 6e74 6167 6520 6769 7665 7320 796f  centage gives yo
-0005b0e0: 7520 7468 6520 2520 6f66 2072 6f77 7320  u the % of rows 
-0005b0f0: 696e 2065 6163 6820 6c61 6265 6c20 796f  in each label yo
-0005b100: 7520 676f 7420 636f 7272 6563 746c 793d  u got correctly=
-0005b110: 2545 6163 685f 4c61 6265 6c20 4163 6375  %Each_Label Accu
-0005b120: 7261 6379 0d0a 2020 2020 2020 2020 2323  racy..        ##
-0005b130: 2320 2020 5468 6973 2077 696c 6c20 6769  #   This will gi
-0005b140: 7665 2079 6f75 2061 7320 6d61 6e79 2070  ve you as many p
-0005b150: 6572 6365 6e74 6167 6573 2061 7320 7468  ercentages as th
-0005b160: 6572 6520 6172 6520 6c61 6265 6c73 2069  ere are labels i
-0005b170: 6e20 796f 7572 206d 756c 7469 2d6c 6162  n your multi-lab
-0005b180: 656c 2074 6172 6765 742e 0d0a 2020 2020  el target...    
-0005b190: 2020 2020 2323 2320 4a61 6363 6172 645f      ### Jaccard_
-0005b1a0: 526f 772d 7769 7365 203d 2074 6869 7320  Row-wise = this 
-0005b1b0: 6d65 616e 7320 796f 7520 6861 7665 2063  means you have c
-0005b1c0: 6f6d 626f 7320 6275 7420 7768 6572 6520  ombos but where 
-0005b1d0: 6f72 6465 7220 6d61 7474 6572 7320 616e  order matters an
-0005b1e0: 6420 796f 7520 7761 6e74 2069 7420 636f  d you want it co
-0005b1f0: 6d70 6172 6564 2072 6f77 2d77 6973 650d  mpared row-wise.
-0005b200: 0a20 2020 2020 2020 2023 2323 2020 2054  .        ###   T
-0005b210: 6869 7320 7465 6c6c 7320 796f 7520 686f  his tells you ho
-0005b220: 7720 6d61 6e79 206c 6162 656c 7320 696e  w many labels in
-0005b230: 2065 6163 6820 726f 7720 6469 6420 796f   each row did yo
-0005b240: 7520 6765 7420 7269 6768 742e 2054 4861  u get right. THa
-0005b250: 7427 7320 6163 6375 7261 6379 2062 7920  t's accuracy by 
-0005b260: 726f 772e 0d0a 2020 2020 2020 2020 2323  row...        ##
-0005b270: 2320 2020 4974 2077 696c 6c20 7265 7475  #   It will retu
-0005b280: 726e 2061 7320 6d61 6e79 2074 6f74 616c  rn as many total
-0005b290: 7320 6173 2074 6865 206e 756d 6265 7220  s as the number 
-0005b2a0: 6f66 2072 6f77 7320 696e 2079 6f75 7220  of rows in your 
-0005b2b0: 6461 7461 2073 6574 2e0d 0a20 2020 2020  data set...     
-0005b2c0: 2020 2023 2323 2020 2054 6f20 6765 7420     ###   To get 
-0005b2d0: 6120 7065 7263 656e 7461 6765 2c20 796f  a percentage, yo
-0005b2e0: 7520 7769 6c6c 2068 6176 6520 746f 2064  u will have to d
-0005b2f0: 6976 6964 6520 6974 2062 7920 7468 6520  ivide it by the 
-0005b300: 6e75 6d62 6572 206f 6620 6c61 6265 6c73  number of labels
-0005b310: 2069 6e20 7468 6520 6461 7461 2073 6574   in the data set
-0005b320: 2e0d 0a20 2020 2020 2020 2023 2323 2020  ...        ###  
-0005b330: 2054 6869 7320 7065 7263 656e 7461 6765   This percentage
-0005b340: 2067 6976 6573 2079 6f75 2074 6865 2025   gives you the %
-0005b350: 206f 6620 6c61 6265 6c73 2069 6e20 6561   of labels in ea
-0005b360: 6368 2072 6f77 2079 6f75 2067 6f74 2063  ch row you got c
-0005b370: 6f72 7265 6374 6c79 3d25 436f 6d62 696e  orrectly=%Combin
-0005b380: 6564 5f4c 6162 656c 5f41 6363 7572 6163  ed_Label_Accurac
-0005b390: 790d 0a20 2020 2020 2020 2023 2323 2020  y..        ###  
-0005b3a0: 2054 6869 7320 7769 6c6c 2067 6976 6520   This will give 
-0005b3b0: 796f 7520 6120 7369 6e67 6c65 2070 6572  you a single per
-0005b3c0: 6365 6e74 6167 6520 6e75 6d62 6572 2066  centage number f
-0005b3d0: 6f72 2074 6865 2077 686f 6c65 2064 6174  or the whole dat
-0005b3e0: 6120 7365 740d 0a20 2020 2022 2222 0d0a  a set..    """..
-0005b3f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0005b400: 6528 6c61 6265 6c2c 206c 6973 7429 3a0d  e(label, list):.
-0005b410: 0a20 2020 2020 2020 206c 6162 656c 203d  .        label =
-0005b420: 206e 702e 6172 7261 7928 6c61 6265 6c29   np.array(label)
-0005b430: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-0005b440: 6e63 6528 7072 6564 2c20 6c69 7374 293a  nce(pred, list):
-0005b450: 0d0a 2020 2020 2020 2020 7072 6564 203d  ..        pred =
-0005b460: 206e 702e 6172 7261 7928 7072 6564 290d   np.array(pred).
-0005b470: 0a20 2020 2023 2323 2054 6869 7320 6973  .    ### This is
-0005b480: 2066 6f72 204d 756c 7469 2d4c 6162 656c   for Multi-Label
-0005b490: 2050 726f 626c 656d 7320 2323 2323 2320   Problems ##### 
-0005b4a0: 5265 7475 726e 7320 3220 7265 7375 6c74  Returns 2 result
-0005b4b0: 733a 206f 6e65 206e 756d 6265 7220 616e  s: one number an
-0005b4c0: 640d 0a20 2020 2023 2323 2020 2020 7468  d..    ###    th
-0005b4d0: 6520 7365 636f 6e64 2069 7320 616e 2061  e second is an a
-0005b4e0: 7272 6179 2077 6974 6820 6173 206d 616e  rray with as man
-0005b4f0: 7920 6974 656d 7320 6173 206e 756d 6265  y items as numbe
-0005b500: 7220 6f66 206c 6162 656c 7320 696e 2074  r of labels in t
-0005b510: 6172 6765 740d 0a20 2020 2074 7279 3a0d  arget..    try:.
-0005b520: 0a20 2020 2020 2020 206a 6163 635f 6461  .        jacc_da
-0005b530: 7461 5f73 6574 203d 206e 702e 7375 6d28  ta_set = np.sum(
-0005b540: 6c61 6265 6c3d 3d70 7265 642c 6178 6973  label==pred,axis
-0005b550: 3d31 292e 7375 6d28 292f 6c61 6265 6c2e  =1).sum()/label.
-0005b560: 7368 6170 655b 315d 0d0a 2020 2020 2020  shape[1]..      
-0005b570: 2020 7265 7475 726e 206a 6163 635f 6461    return jacc_da
-0005b580: 7461 5f73 6574 0d0a 2020 2020 6578 6365  ta_set..    exce
-0005b590: 7074 3a0d 0a20 2020 2020 2020 2072 6574  pt:..        ret
-0005b5a0: 7572 6e20 300d 0a23 2323 2323 2323 2323  urn 0..#########
-0005b5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005b5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005b5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005b5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005b5f0: 2323 2323 2323 230d 0a64 6566 2070 6c6f  #######..def plo
-0005b600: 745f 5253 5f70 6172 616d 7328 6376 5f72  t_RS_params(cv_r
-0005b610: 6573 756c 7473 2c20 7363 6f72 652c 206d  esults, score, m
-0005b620: 6e61 6d65 293a 0d0a 2020 2020 2222 220d  name):..    """.
-0005b630: 0a20 2020 2023 2323 2323 2323 2054 6869  .    ####### Thi
-0005b640: 7320 706c 6f74 7320 7468 6520 4772 6964  s plots the Grid
-0005b650: 5365 6172 6368 4356 2052 6573 756c 7473  SearchCV Results
-0005b660: 2073 656e 7420 696e 2023 2323 2323 2323   sent in #######
-0005b670: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
-0005b680: 2020 2020 6466 203d 2070 642e 4461 7461      df = pd.Data
-0005b690: 4672 616d 6528 6376 5f72 6573 756c 7473  Frame(cv_results
-0005b6a0: 290d 0a20 2020 2070 6172 616d 7320 3d20  )..    params = 
-0005b6b0: 5b78 2066 6f72 2078 2069 6e20 6c69 7374  [x for x in list
-0005b6c0: 2864 6629 2069 6620 782e 7374 6172 7473  (df) if x.starts
-0005b6d0: 7769 7468 2827 7061 7261 6d5f 2729 5d0d  with('param_')].
-0005b6e0: 0a20 2020 2074 7261 696e 636f 6c73 203d  .    traincols =
-0005b6f0: 205b 276d 6561 6e5f 7472 6169 6e5f 7363   ['mean_train_sc
-0005b700: 6f72 6527 205d 0d0a 2020 2020 7465 7374  ore' ]..    test
-0005b710: 636f 6c73 203d 205b 276d 6561 6e5f 7465  cols = ['mean_te
-0005b720: 7374 5f73 636f 7265 2720 5d0d 0a20 2020  st_score' ]..   
-0005b730: 2063 6f6c 7320 3d20 7472 6169 6e63 6f6c   cols = traincol
-0005b740: 732b 7465 7374 636f 6c73 0d0a 2020 2020  s+testcols..    
-0005b750: 6e63 6f6c 7320 3d20 320d 0a20 2020 206e  ncols = 2..    n
-0005b760: 6f70 6c6f 7473 203d 206c 656e 2870 6172  oplots = len(par
-0005b770: 616d 7329 0d0a 2020 2020 6966 206e 6f70  ams)..    if nop
-0005b780: 6c6f 7473 256e 636f 6c73 203d 3d20 303a  lots%ncols == 0:
-0005b790: 0d0a 2020 2020 2020 2020 726f 7773 203d  ..        rows =
-0005b7a0: 206e 6f70 6c6f 7473 2f6e 636f 6c73 0d0a   noplots/ncols..
-0005b7b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0005b7c0: 2020 2072 6f77 7320 3d20 286e 6f70 6c6f     rows = (noplo
-0005b7d0: 7473 2f6e 636f 6c73 292b 310d 0a20 2020  ts/ncols)+1..   
-0005b7e0: 2068 6569 6768 745f 7369 7a65 203d 2035   height_size = 5
-0005b7f0: 0d0a 2020 2020 7769 6474 685f 7369 7a65  ..    width_size
-0005b800: 203d 2031 350d 0a20 2020 2066 6967 203d   = 15..    fig =
-0005b810: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
-0005b820: 697a 653d 2877 6964 7468 5f73 697a 652c  ize=(width_size,
-0005b830: 726f 7773 2a68 6569 6768 745f 7369 7a65  rows*height_size
-0005b840: 2929 0d0a 2020 2020 6669 672e 7375 7074  ))..    fig.supt
-0005b850: 6974 6c65 2827 5472 6169 6e69 6e67 2061  itle('Training a
-0005b860: 6e64 2056 616c 6964 6174 696f 6e3a 2048  nd Validation: H
-0005b870: 7970 6572 2050 6172 616d 6574 6572 2054  yper Parameter T
-0005b880: 756e 696e 6720 666f 7220 7461 7267 6574  uning for target
-0005b890: 3d25 7327 2025 6d6e 616d 652c 2066 6f6e  =%s' %mname, fon
-0005b8a0: 7473 697a 653d 3230 2c79 3d31 2e30 3129  tsize=20,y=1.01)
-0005b8b0: 0d0a 2020 2020 2323 2323 2049 6620 7468  ..    #### If th
-0005b8c0: 6520 7661 6c75 6573 2061 7265 206e 6567  e values are neg
-0005b8d0: 6174 6976 652c 2063 6f6e 7665 7274 2074  ative, convert t
-0005b8e0: 6865 6d20 746f 2070 6f73 6974 6976 6520  hem to positive 
-0005b8f0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-0005b900: 2020 6966 206c 656e 2864 662e 6c6f 635b    if len(df.loc[
-0005b910: 6466 5b63 6f6c 735b 305d 5d3c 305d 2920  df[cols[0]]<0]) 
-0005b920: 3e20 303a 0d0a 2020 2020 2020 2020 6466  > 0:..        df
-0005b930: 5b63 6f6c 735d 203d 2064 665b 636f 6c73  [cols] = df[cols
-0005b940: 5d2a 2d31 0d0a 2020 2020 666f 7220 6561  ]*-1..    for ea
-0005b950: 6368 5f70 6172 616d 2c20 636f 756e 7420  ch_param, count 
-0005b960: 696e 207a 6970 2870 6172 616d 732c 2072  in zip(params, r
-0005b970: 616e 6765 286e 6f70 6c6f 7473 2929 3a0d  ange(noplots)):.
-0005b980: 0a20 2020 2020 2020 2070 6c74 2e73 7562  .        plt.sub
-0005b990: 706c 6f74 2872 6f77 732c 6e63 6f6c 732c  plot(rows,ncols,
-0005b9a0: 636f 756e 742b 3129 0d0a 2020 2020 2020  count+1)..      
-0005b9b0: 2020 6178 3120 3d20 706c 742e 6763 6128    ax1 = plt.gca(
-0005b9c0: 290d 0a20 2020 2020 2020 2069 6620 6466  )..        if df
-0005b9d0: 5b65 6163 685f 7061 7261 6d5d 2e64 7479  [each_param].dty
-0005b9e0: 7065 2021 3d20 6f62 6a65 6374 3a0d 0a20  pe != object:.. 
-0005b9f0: 2020 2020 2020 2020 2020 2064 665b 5b65             df[[e
-0005ba00: 6163 685f 7061 7261 6d5d 2b63 6f6c 735d  ach_param]+cols]
-0005ba10: 2e67 726f 7570 6279 2865 6163 685f 7061  .groupby(each_pa
-0005ba20: 7261 6d29 2e6d 6561 6e28 292e 706c 6f74  ram).mean().plot
-0005ba30: 286b 696e 643d 276c 696e 6527 2c0d 0a20  (kind='line',.. 
-0005ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005ba50: 2020 2020 2020 2020 2020 2074 6974 6c65             title
-0005ba60: 3d27 2573 2066 6f72 2025 7327 2025 2865  ='%s for %s' %(e
-0005ba70: 6163 685f 7061 7261 6d2c 6d6e 616d 6529  ach_param,mname)
-0005ba80: 2c61 783d 6178 3129 0d0a 2020 2020 2020  ,ax=ax1)..      
-0005ba90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0005baa0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-0005bab0: 2020 2020 2020 2020 2020 2064 665b 6561             df[ea
-0005bac0: 6368 5f70 6172 616d 5d20 3d20 7064 2e74  ch_param] = pd.t
-0005bad0: 6f5f 6e75 6d65 7269 6328 6466 5b65 6163  o_numeric(df[eac
-0005bae0: 685f 7061 7261 6d5d 290d 0a20 2020 2020  h_param])..     
-0005baf0: 2020 2020 2020 2020 2020 2064 665b 5b65             df[[e
-0005bb00: 6163 685f 7061 7261 6d5d 2b63 6f6c 735d  ach_param]+cols]
-0005bb10: 2e67 726f 7570 6279 2865 6163 685f 7061  .groupby(each_pa
-0005bb20: 7261 6d29 2e6d 6561 6e28 292e 706c 6f74  ram).mean().plot
-0005bb30: 286b 696e 643d 276c 696e 6527 2c0d 0a20  (kind='line',.. 
-0005bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bb50: 2020 2020 2020 2020 2020 2074 6974 6c65             title
-0005bb60: 3d27 2573 2066 6f72 2025 7327 2025 2865  ='%s for %s' %(e
-0005bb70: 6163 685f 7061 7261 6d2c 6d6e 616d 6529  ach_param,mname)
-0005bb80: 2c20 6178 3d61 7831 290d 0a20 2020 2020  , ax=ax1)..     
-0005bb90: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-0005bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bbb0: 6466 5b5b 6561 6368 5f70 6172 616d 5d2b  df[[each_param]+
-0005bbc0: 636f 6c73 5d2e 6772 6f75 7062 7928 6561  cols].groupby(ea
-0005bbd0: 6368 5f70 6172 616d 292e 6d65 616e 2829  ch_param).mean()
-0005bbe0: 2e70 6c6f 7428 6b69 6e64 3d27 6261 7227  .plot(kind='bar'
-0005bbf0: 2c73 7461 636b 6564 3d46 616c 7365 2c0d  ,stacked=False,.
-0005bc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0005bc10: 2020 2020 2020 2020 2020 2020 2074 6974               tit
-0005bc20: 6c65 3d27 2573 2066 6f72 2025 7327 2025  le='%s for %s' %
-0005bc30: 2865 6163 685f 7061 7261 6d2c 6d6e 616d  (each_param,mnam
-0005bc40: 6529 2c20 6178 3d61 7831 290d 0a20 2020  e), ax=ax1)..   
-0005bc50: 2023 2323 2320 5468 6973 2069 7320 746f   #### This is to
-0005bc60: 2070 6c6f 7420 7468 6520 7465 7374 5f6d   plot the test_m
-0005bc70: 6561 6e5f 7363 6f72 6520 6167 6169 6e73  ean_score agains
-0005bc80: 7420 7061 7261 6d73 2074 6f20 7365 6520  t params to see 
-0005bc90: 686f 7720 6974 2069 6e63 7265 6173 6573  how it increases
-0005bca0: 0d0a 2020 2020 666f 7220 6561 6368 5f70  ..    for each_p
-0005bcb0: 6172 616d 2069 6e20 7061 7261 6d73 3a0d  aram in params:.
-0005bcc0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
-0005bcd0: 6973 2069 7320 746f 2066 696e 6420 7768  is is to find wh
-0005bce0: 6963 6820 7061 7261 6d65 7465 7273 2061  ich parameters a
-0005bcf0: 7265 206e 6f6e 2073 7472 696e 6720 616e  re non string an
-0005bd00: 6420 636f 6e76 6572 7420 7468 656d 2074  d convert them t
-0005bd10: 6f20 7374 7269 6e67 730d 0a20 2020 2020  o strings..     
-0005bd20: 2020 2069 6620 6466 5b65 6163 685f 7061     if df[each_pa
-0005bd30: 7261 6d5d 2e64 7479 7065 213d 6f62 6a65  ram].dtype!=obje
-0005bd40: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
-0005bd50: 2020 2064 665b 6561 6368 5f70 6172 616d     df[each_param
-0005bd60: 5d20 3d20 6466 5b65 6163 685f 7061 7261  ] = df[each_para
-0005bd70: 6d5d 2e61 7374 7970 6528 7374 7229 0d0a  m].astype(str)..
-0005bd80: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0005bd90: 2020 6466 5b27 636f 6d62 696e 6564 5f70    df['combined_p
-0005bda0: 6172 616d 6574 6572 7327 5d20 3d20 6466  arameters'] = df
-0005bdb0: 5b70 6172 616d 735d 2e61 7070 6c79 286c  [params].apply(l
-0005bdc0: 616d 6264 6120 783a 2027 5f5f 272e 6a6f  ambda x: '__'.jo
-0005bdd0: 696e 2878 292c 2061 7869 733d 3120 290d  in(x), axis=1 ).
-0005bde0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-0005bdf0: 2020 2020 2020 6466 5b27 636f 6d62 696e        df['combin
-0005be00: 6564 5f70 6172 616d 6574 6572 7327 5d20  ed_parameters'] 
-0005be10: 3d20 6466 5b70 6172 616d 735d 2e61 7070  = df[params].app
-0005be20: 6c79 286c 616d 6264 6120 783a 2027 5f5f  ly(lambda x: '__
-0005be30: 272e 6a6f 696e 2878 2e6d 6170 2873 7472  '.join(x.map(str
-0005be40: 2929 2c20 6178 6973 3d31 2029 0d0a 2020  )), axis=1 )..  
-0005be50: 2020 6966 206c 656e 2870 6172 616d 7329    if len(params)
-0005be60: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
-0005be70: 6466 5b27 636f 6d62 696e 6564 5f70 6172  df['combined_par
-0005be80: 616d 6574 6572 7327 5d20 3d20 636f 7079  ameters'] = copy
-0005be90: 2e64 6565 7063 6f70 7928 6466 5b70 6172  .deepcopy(df[par
-0005bea0: 616d 735d 290d 0a20 2020 2065 6c73 653a  ams])..    else:
-0005beb0: 0d0a 2020 2020 2020 2020 6466 5b5b 2763  ..        df[['c
-0005bec0: 6f6d 6269 6e65 645f 7061 7261 6d65 7465  ombined_paramete
-0005bed0: 7273 275d 2b63 6f6c 735d 2e67 726f 7570  rs']+cols].group
-0005bee0: 6279 2827 636f 6d62 696e 6564 5f70 6172  by('combined_par
-0005bef0: 616d 6574 6572 7327 292e 6d65 616e 2829  ameters').mean()
-0005bf00: 2e73 6f72 745f 7661 6c75 6573 280d 0a20  .sort_values(.. 
-0005bf10: 2020 2020 2020 2020 2020 2063 6f6c 735b             cols[
-0005bf20: 315d 292e 706c 6f74 2866 6967 7369 7a65  1]).plot(figsize
-0005bf30: 3d28 7769 6474 685f 7369 7a65 2c68 6569  =(width_size,hei
-0005bf40: 6768 745f 7369 7a65 292c 6b69 6e64 3d27  ght_size),kind='
-0005bf50: 6c69 6e65 272c 7375 6270 6c6f 7473 3d46  line',subplots=F
-0005bf60: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
-0005bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bf80: 2020 2074 6974 6c65 3d27 436f 6d62 696e     title='Combin
-0005bf90: 6564 2050 6172 616d 6574 6572 733a 2025  ed Parameters: %
-0005bfa0: 7320 7363 6f72 6573 2066 6f72 2025 7327  s scores for %s'
-0005bfb0: 2025 2873 636f 7265 2c6d 6e61 6d65 2929   %(score,mname))
-0005bfc0: 0d0a 2020 2020 706c 742e 7874 6963 6b73  ..    plt.xticks
-0005bfd0: 2872 6f74 6174 696f 6e3d 3435 290d 0a20  (rotation=45).. 
-0005bfe0: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
-0005bff0: 2020 2020 7265 7475 726e 2064 660d 0a23      return df..#
-0005c000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c040: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0005c050: 0a64 6566 2070 6c6f 745f 7867 625f 6d65  .def plot_xgb_me
-0005c060: 7472 6963 7328 6d6f 6465 6c2c 6576 616c  trics(model,eval
-0005c070: 5f6d 6574 7269 632c 6576 616c 5f73 6574  _metric,eval_set
-0005c080: 2c6d 6f64 656c 7479 7065 2c6d 6f64 656c  ,modeltype,model
-0005c090: 5f6c 6162 656c 3d27 272c 6d6f 6465 6c5f  _label='',model_
-0005c0a0: 6e61 6d65 3d22 2229 3a0d 0a20 2020 2068  name=""):..    h
-0005c0b0: 6569 6768 745f 7369 7a65 203d 2035 0d0a  eight_size = 5..
-0005c0c0: 2020 2020 7769 6474 685f 7369 7a65 203d      width_size =
-0005c0d0: 2031 300d 0a20 2020 2069 6620 6d6f 6465   10..    if mode
-0005c0e0: 6c5f 6e61 6d65 2e6c 6f77 6572 2829 203d  l_name.lower() =
-0005c0f0: 3d20 2763 6174 626f 6f73 7427 3a0d 0a20  = 'catboost':.. 
-0005c100: 2020 2020 2020 2072 6573 756c 7473 203d         results =
-0005c110: 206d 6f64 656c 2e67 6574 5f65 7661 6c73   model.get_evals
-0005c120: 5f72 6573 756c 7428 290d 0a20 2020 2065  _result()..    e
-0005c130: 6c73 653a 0d0a 2020 2020 2020 2020 7265  lse:..        re
-0005c140: 7375 6c74 7320 3d20 6d6f 6465 6c2e 6576  sults = model.ev
-0005c150: 616c 735f 7265 7375 6c74 2829 0d0a 2020  als_result()..  
-0005c160: 2020 7265 735f 6b65 7973 203d 206c 6973    res_keys = lis
-0005c170: 7428 7265 7375 6c74 732e 6b65 7973 2829  t(results.keys()
-0005c180: 290d 0a20 2020 2065 7661 6c5f 6d65 7472  )..    eval_metr
-0005c190: 6963 203d 206c 6973 7428 7265 7375 6c74  ic = list(result
-0005c1a0: 735b 7265 735f 6b65 7973 5b30 5d5d 2e6b  s[res_keys[0]].k
-0005c1b0: 6579 7328 2929 0d0a 2020 2020 6966 2069  eys())..    if i
-0005c1c0: 7369 6e73 7461 6e63 6528 6576 616c 5f6d  sinstance(eval_m
-0005c1d0: 6574 7269 632c 206c 6973 7429 3a0d 0a20  etric, list):.. 
-0005c1e0: 2020 2020 2020 2023 2070 6c6f 7420 6c6f         # plot lo
-0005c1f0: 6720 6c6f 7373 0d0a 2020 2020 2020 2020  g loss..        
-0005c200: 6576 616c 5f6d 6574 7269 6320 3d20 6576  eval_metric = ev
-0005c210: 616c 5f6d 6574 7269 635b 305d 0d0a 2020  al_metric[0]..  
-0005c220: 2020 2320 706c 6f74 206d 6574 7269 6373    # plot metrics
-0005c230: 206e 6f77 0d0a 2020 2020 6669 672c 2061   now..    fig, a
-0005c240: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
-0005c250: 2866 6967 7369 7a65 3d28 7769 6474 685f  (figsize=(width_
-0005c260: 7369 7a65 2c20 6865 6967 6874 5f73 697a  size, height_siz
-0005c270: 6529 290d 0a20 2020 2065 706f 6368 7320  e))..    epochs 
-0005c280: 3d20 6c65 6e28 7265 7375 6c74 735b 7265  = len(results[re
-0005c290: 735f 6b65 7973 5b30 5d5d 5b65 7661 6c5f  s_keys[0]][eval_
-0005c2a0: 6d65 7472 6963 5d29 0d0a 2020 2020 785f  metric])..    x_
-0005c2b0: 6178 6973 203d 2072 616e 6765 2830 2c20  axis = range(0, 
-0005c2c0: 6570 6f63 6873 290d 0a20 2020 2069 6620  epochs)..    if 
-0005c2d0: 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77 6572  model_name.lower
-0005c2e0: 2829 203d 3d20 2763 6174 626f 6f73 7427  () == 'catboost'
-0005c2f0: 3a0d 0a20 2020 2020 2020 2061 782e 706c  :..        ax.pl
-0005c300: 6f74 2878 5f61 7869 732c 2072 6573 756c  ot(x_axis, resul
-0005c310: 7473 5b72 6573 5f6b 6579 735b 305d 5d5b  ts[res_keys[0]][
-0005c320: 6576 616c 5f6d 6574 7269 635d 2c20 6c61  eval_metric], la
-0005c330: 6265 6c3d 2725 7327 2025 7265 735f 6b65  bel='%s' %res_ke
-0005c340: 7973 5b30 5d29 0d0a 2020 2020 656c 7365  ys[0])..    else
-0005c350: 3a0d 0a20 2020 2020 2020 2061 782e 706c  :..        ax.pl
-0005c360: 6f74 2878 5f61 7869 732c 2072 6573 756c  ot(x_axis, resul
-0005c370: 7473 5b72 6573 5f6b 6579 735b 305d 5d5b  ts[res_keys[0]][
-0005c380: 6576 616c 5f6d 6574 7269 635d 2c20 6c61  eval_metric], la
-0005c390: 6265 6c3d 2725 7327 2025 7265 735f 6b65  bel='%s' %res_ke
-0005c3a0: 7973 5b30 5d29 0d0a 2020 2020 6570 6f63  ys[0])..    epoc
-0005c3b0: 6873 203d 206c 656e 2872 6573 756c 7473  hs = len(results
-0005c3c0: 5b72 6573 5f6b 6579 735b 2d31 5d5d 5b65  [res_keys[-1]][e
-0005c3d0: 7661 6c5f 6d65 7472 6963 5d29 0d0a 2020  val_metric])..  
-0005c3e0: 2020 785f 6178 6973 203d 2072 616e 6765    x_axis = range
-0005c3f0: 2830 2c20 6570 6f63 6873 290d 0a20 2020  (0, epochs)..   
-0005c400: 2061 782e 706c 6f74 2878 5f61 7869 732c   ax.plot(x_axis,
-0005c410: 2072 6573 756c 7473 5b72 6573 5f6b 6579   results[res_key
-0005c420: 735b 2d31 5d5d 5b65 7661 6c5f 6d65 7472  s[-1]][eval_metr
-0005c430: 6963 5d2c 206c 6162 656c 3d27 2573 2720  ic], label='%s' 
-0005c440: 2572 6573 5f6b 6579 735b 2d31 5d29 0d0a  %res_keys[-1])..
-0005c450: 2020 2020 6178 2e6c 6567 656e 6428 290d      ax.legend().
-0005c460: 0a20 2020 2070 6c74 2e79 6c61 6265 6c28  .    plt.ylabel(
-0005c470: 6576 616c 5f6d 6574 7269 6329 0d0a 2020  eval_metric)..  
-0005c480: 2020 706c 742e 7469 746c 6528 2725 7320    plt.title('%s 
-0005c490: 5472 6169 6e20 616e 6420 5661 6c69 6461  Train and Valida
-0005c4a0: 7469 6f6e 204d 6574 7269 6373 2061 6372  tion Metrics acr
-0005c4b0: 6f73 7320 4570 6f63 6873 2028 4561 726c  oss Epochs (Earl
-0005c4c0: 7920 5374 6f70 7069 6e67 2069 6e20 6566  y Stopping in ef
-0005c4d0: 6665 6374 2927 2025 6d6f 6465 6c5f 6c61  fect)' %model_la
-0005c4e0: 6265 6c29 0d0a 2020 2020 706c 742e 7368  bel)..    plt.sh
-0005c4f0: 6f77 2829 3b0d 0a23 2323 2323 2323 2323  ow();..#########
-0005c500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00058e80: 2020 2020 2063 6f6c 7361 6d70 6c65 5f62       colsample_b
+00058e90: 7974 7265 653d 636f 6c5f 7375 625f 7361  ytree=col_sub_sa
+00058ea0: 6d70 6c65 2c72 6567 5f61 6c70 6861 3d30  mple,reg_alpha=0
+00058eb0: 2e35 2c20 7265 675f 6c61 6d62 6461 3d30  .5, reg_lambda=0
+00058ec0: 2e35 2c0d 0a20 2020 2020 2020 2020 2020  .5,..           
+00058ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058ee0: 2020 2020 2020 7365 6564 3d31 2c72 616e        seed=1,ran
+00058ef0: 646f 6d5f 7374 6174 653d 312c 6e5f 6a6f  dom_state=1,n_jo
+00058f00: 6273 3d2d 312c 206e 7468 7265 6164 3d2d  bs=-1, nthread=-
+00058f10: 3129 0d0a 2020 2020 2020 2020 6576 616c  1)..        eval
+00058f20: 5f6d 6574 7269 6320 3d20 2772 6d73 6527  _metric = 'rmse'
+00058f30: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00058f40: 2020 2020 2023 2323 2320 5468 6973 2069       #### This i
+00058f50: 7320 666f 7220 436c 6173 7369 6669 6572  s for Classifier
+00058f60: 7320 6f6e 6c79 0d0a 2020 2020 2020 2020  s only..        
+00058f70: 636c 6173 7365 7320 3d20 6e70 2e75 6e69  classes = np.uni
+00058f80: 7175 6528 7472 6169 6e5b 7461 7267 6574  que(train[target
+00058f90: 5d2e 7661 6c75 6573 290d 0a20 2020 2020  ].values)..     
+00058fa0: 2020 2069 6620 6c65 6e28 636c 6173 7365     if len(classe
+00058fb0: 7329 203d 3d20 323a 0d0a 2020 2020 2020  s) == 2:..      
+00058fc0: 2020 2020 2020 6d6f 6465 6c5f 7867 6220        model_xgb 
+00058fd0: 3d20 5847 4243 6c61 7373 6966 6965 7228  = XGBClassifier(
+00058fe0: 6261 7365 5f73 636f 7265 3d30 2e35 2c20  base_score=0.5, 
+00058ff0: 626f 6f73 7465 723d 2767 6274 7265 6527  booster='gbtree'
+00059000: 2c20 7375 6273 616d 706c 653d 7375 6273  , subsample=subs
+00059010: 616d 706c 652c 0d0a 2020 2020 2020 2020  ample,..        
+00059020: 2020 2020 2020 2020 636f 6c73 616d 706c          colsampl
+00059030: 655f 6279 7472 6565 3d63 6f6c 5f73 7562  e_bytree=col_sub
+00059040: 5f73 616d 706c 652c 6761 6d6d 613d 312c  _sample,gamma=1,
+00059050: 206c 6561 726e 696e 675f 7261 7465 3d30   learning_rate=0
+00059060: 2e31 2c20 6d61 785f 6465 6c74 615f 7374  .1, max_delta_st
+00059070: 6570 3d30 2c0d 0a20 2020 2020 2020 2020  ep=0,..         
+00059080: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
+00059090: 3d6d 6178 5f64 6570 7468 2c20 6d69 6e5f  =max_depth, min_
+000590a0: 6368 696c 645f 7765 6967 6874 3d31 2c20  child_weight=1, 
+000590b0: 6d69 7373 696e 673d 2d39 3939 2c20 6e5f  missing=-999, n_
+000590c0: 6573 7469 6d61 746f 7273 3d32 3030 2c0d  estimators=200,.
+000590d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000590e0: 206e 5f6a 6f62 733d 2d31 2c20 6e74 6872   n_jobs=-1, nthr
+000590f0: 6561 643d 2d31 2c20 6f62 6a65 6374 6976  ead=-1, objectiv
+00059100: 653d 2762 696e 6172 793a 6c6f 6769 7374  e='binary:logist
+00059110: 6963 272c 2075 7365 5f6c 6162 656c 5f65  ic', use_label_e
+00059120: 6e63 6f64 6572 3d46 616c 7365 2c0d 0a20  ncoder=False,.. 
+00059130: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00059140: 616e 646f 6d5f 7374 6174 653d 312c 2072  andom_state=1, r
+00059150: 6567 5f61 6c70 6861 3d30 2e35 2c20 7265  eg_alpha=0.5, re
+00059160: 675f 6c61 6d62 6461 3d30 2e35 2c0d 0a20  g_lambda=0.5,.. 
+00059170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00059180: 6565 643d 3129 0d0a 2020 2020 2020 2020  eed=1)..        
+00059190: 2020 2020 6576 616c 5f6d 6574 7269 6320      eval_metric 
+000591a0: 3d20 276c 6f67 6c6f 7373 270d 0a20 2020  = 'logloss'..   
+000591b0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000591c0: 2020 2020 2020 2020 6d6f 6465 6c5f 7867          model_xg
+000591d0: 6220 3d20 5847 4243 6c61 7373 6966 6965  b = XGBClassifie
+000591e0: 7228 6261 7365 5f73 636f 7265 3d30 2e35  r(base_score=0.5
+000591f0: 2c20 626f 6f73 7465 723d 2767 6274 7265  , booster='gbtre
+00059200: 6527 2c20 7375 6273 616d 706c 653d 7375  e', subsample=su
+00059210: 6273 616d 706c 652c 0d0a 2020 2020 2020  bsample,..      
+00059220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059230: 2020 636f 6c73 616d 706c 655f 6279 7472    colsample_bytr
+00059240: 6565 3d63 6f6c 5f73 7562 5f73 616d 706c  ee=col_sub_sampl
+00059250: 652c 2067 616d 6d61 3d31 2c20 6c65 6172  e, gamma=1, lear
+00059260: 6e69 6e67 5f72 6174 653d 302e 312c 206d  ning_rate=0.1, m
+00059270: 6178 5f64 656c 7461 5f73 7465 703d 302c  ax_delta_step=0,
+00059280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00059290: 2020 6d61 785f 6465 7074 683d 6d61 785f    max_depth=max_
+000592a0: 6465 7074 682c 206d 696e 5f63 6869 6c64  depth, min_child
+000592b0: 5f77 6569 6768 743d 312c 206d 6973 7369  _weight=1, missi
+000592c0: 6e67 3d2d 3939 392c 206e 5f65 7374 696d  ng=-999, n_estim
+000592d0: 6174 6f72 733d 3230 302c 0d0a 2020 2020  ators=200,..    
+000592e0: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
+000592f0: 6273 3d2d 312c 206e 7468 7265 6164 3d2d  bs=-1, nthread=-
+00059300: 312c 206f 626a 6563 7469 7665 3d27 6d75  1, objective='mu
+00059310: 6c74 693a 736f 6674 6d61 7827 2c20 7573  lti:softmax', us
+00059320: 655f 6c61 6265 6c5f 656e 636f 6465 723d  e_label_encoder=
+00059330: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+00059340: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+00059350: 7461 7465 3d31 2c20 7265 675f 616c 7068  tate=1, reg_alph
+00059360: 613d 302e 352c 2072 6567 5f6c 616d 6264  a=0.5, reg_lambd
+00059370: 613d 302e 352c 0d0a 2020 2020 2020 2020  a=0.5,..        
+00059380: 2020 2020 2020 2020 7365 6564 3d31 290d          seed=1).
+00059390: 0a20 2020 2020 2020 2020 2020 2065 7661  .            eva
+000593a0: 6c5f 6d65 7472 6963 203d 2027 6d6c 6f67  l_metric = 'mlog
+000593b0: 6c6f 7373 270d 0a20 2020 2023 2323 2320  loss'..    #### 
+000593c0: 2020 5468 6973 2069 7320 7768 6572 6520    This is where 
+000593d0: 796f 7520 7374 6172 7420 746f 2049 7465  you start to Ite
+000593e0: 7261 7465 206f 6e20 4669 6e64 696e 6720  rate on Finding 
+000593f0: 496d 706f 7274 616e 7420 4665 6174 7572  Important Featur
+00059400: 6573 2023 2323 2323 2323 2323 2323 2323  es #############
+00059410: 2323 230d 0a20 2020 2073 6176 655f 7867  ###..    save_xg
+00059420: 6220 3d20 636f 7079 2e64 6565 7063 6f70  b = copy.deepcop
+00059430: 7928 6d6f 6465 6c5f 7867 6229 0d0a 2020  y(model_xgb)..  
+00059440: 2020 7472 6169 6e5f 7020 3d20 7472 6169    train_p = trai
+00059450: 6e5b 7072 6564 735d 0d0a 2020 2020 6966  n[preds]..    if
+00059460: 2074 7261 696e 5f70 2e73 6861 7065 5b31   train_p.shape[1
+00059470: 5d20 3c20 3130 3a0d 0a20 2020 2020 2020  ] < 10:..       
+00059480: 2069 7465 725f 6c69 6d69 7420 3d20 320d   iter_limit = 2.
+00059490: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+000594a0: 2020 2020 6974 6572 5f6c 696d 6974 203d      iter_limit =
+000594b0: 2069 6e74 2874 7261 696e 5f70 2e73 6861   int(train_p.sha
+000594c0: 7065 5b31 5d2f 352b 302e 3529 0d0a 2020  pe[1]/5+0.5)..  
+000594d0: 2020 7072 696e 7428 2743 7572 7265 6e74    print('Current
+000594e0: 206e 756d 6265 7220 6f66 2070 7265 6469   number of predi
+000594f0: 6374 6f72 7320 3d20 2564 2027 2025 2874  ctors = %d ' %(t
+00059500: 7261 696e 5f70 2e73 6861 7065 5b31 5d2c  rain_p.shape[1],
+00059510: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
+00059520: 2020 2046 696e 6469 6e67 2049 6d70 6f72     Finding Impor
+00059530: 7461 6e74 2046 6561 7475 7265 7320 7573  tant Features us
+00059540: 696e 6720 426f 6f73 7465 6420 5472 6565  ing Boosted Tree
+00059550: 7320 616c 676f 7269 7468 6d2e 2e2e 2729  s algorithm...')
+00059560: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
+00059570: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00059580: 6765 2830 2c74 7261 696e 5f70 2e73 6861  ge(0,train_p.sha
+00059590: 7065 5b31 5d2c 6974 6572 5f6c 696d 6974  pe[1],iter_limit
+000595a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000595b0: 6e65 775f 7867 6220 3d20 636f 7079 2e64  new_xgb = copy.d
+000595c0: 6565 7063 6f70 7928 7361 7665 5f78 6762  eepcopy(save_xgb
+000595d0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000595e0: 6620 7472 6169 6e5f 702e 7368 6170 655b  f train_p.shape[
+000595f0: 315d 2d69 203c 2032 3a0d 0a20 2020 2020  1]-i < 2:..     
+00059600: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
+00059610: 6620 7468 6572 6520 6973 206a 7573 7420  f there is just 
+00059620: 6f6e 6520 7661 7269 6162 6c65 206c 6566  one variable lef
+00059630: 742c 2074 6865 6e20 6a75 7374 2073 6b69  t, then just ski
+00059640: 7020 6974 2023 2323 2323 0d0a 2020 2020  p it #####..    
+00059650: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00059660: 696e 7565 0d0a 2020 2020 2020 2020 2020  inue..          
+00059670: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00059680: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00059690: 2020 2020 2020 2020 7573 696e 6720 2564          using %d
+000596a0: 2076 6172 6961 626c 6573 2e2e 2e27 2025   variables...' %
+000596b0: 2874 7261 696e 5f70 2e73 6861 7065 5b31  (train_p.shape[1
+000596c0: 5d2d 6929 290d 0a0d 0a20 2020 2020 2020  ]-i))....       
+000596d0: 2020 2020 2069 6620 7472 6169 6e5f 702e       if train_p.
+000596e0: 7368 6170 655b 315d 2d69 203c 2069 7465  shape[1]-i < ite
+000596f0: 725f 6c69 6d69 743a 0d0a 2020 2020 2020  r_limit:..      
+00059700: 2020 2020 2020 2020 2020 5820 3d20 7472            X = tr
+00059710: 6169 6e5f 702e 696c 6f63 5b3a 2c69 3a5d  ain_p.iloc[:,i:]
+00059720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00059730: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+00059740: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
+00059750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059760: 2020 2020 2074 7261 696e 5f70 6172 7420       train_part 
+00059770: 3d20 696e 7428 2831 2d74 6573 745f 7369  = int((1-test_si
+00059780: 7a65 292a 582e 7368 6170 655b 305d 290d  ze)*X.shape[0]).
+00059790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000597a0: 2020 2020 2058 5f74 7261 696e 2c20 585f       X_train, X_
+000597b0: 6376 2c20 795f 7472 6169 6e2c 2079 5f63  cv, y_train, y_c
+000597c0: 7620 3d20 585b 3a74 7261 696e 5f70 6172  v = X[:train_par
+000597d0: 745d 2c58 5b74 7261 696e 5f70 6172 743a  t],X[train_part:
+000597e0: 5d2c 795b 3a74 7261 696e 5f70 6172 745d  ],y[:train_part]
+000597f0: 2c79 5b74 7261 696e 5f70 6172 743a 5d0d  ,y[train_part:].
+00059800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059810: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00059820: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
+00059830: 6169 6e2c 2058 5f63 762c 2079 5f74 7261  ain, X_cv, y_tra
+00059840: 696e 2c20 795f 6376 203d 2074 7261 696e  in, y_cv = train
+00059850: 5f74 6573 745f 7370 6c69 7428 582c 2079  _test_split(X, y
+00059860: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00059870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059890: 2020 2074 6573 745f 7369 7a65 3d74 6573     test_size=tes
+000598a0: 745f 7369 7a65 2c20 7261 6e64 6f6d 5f73  t_size, random_s
+000598b0: 7461 7465 3d73 6565 642c 2073 7472 6174  tate=seed, strat
+000598c0: 6966 793d 7929 0d0a 2020 2020 2020 2020  ify=y)..        
+000598d0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+000598e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000598f0: 2020 6576 616c 5f73 6574 203d 205b 2858    eval_set = [(X
+00059900: 5f74 7261 696e 2c79 5f74 7261 696e 292c  _train,y_train),
+00059910: 2858 5f63 762c 795f 6376 295d 0d0a 2020  (X_cv,y_cv)]..  
+00059920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059930: 2020 6d6f 6465 6c5f 7867 622e 6669 7428    model_xgb.fit(
+00059940: 585f 7472 6169 6e2c 795f 7472 6169 6e2c  X_train,y_train,
+00059950: 6561 726c 795f 7374 6f70 7069 6e67 5f72  early_stopping_r
+00059960: 6f75 6e64 733d 6561 726c 795f 7374 6f70  ounds=early_stop
+00059970: 7069 6e67 2c65 7661 6c5f 7365 743d 6576  ping,eval_set=ev
+00059980: 616c 5f73 6574 2c0d 0a20 2020 2020 2020  al_set,..       
+00059990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000599a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000599b0: 2065 7661 6c5f 6d65 7472 6963 3d65 7661   eval_metric=eva
+000599c0: 6c5f 6d65 7472 6963 2c76 6572 626f 7365  l_metric,verbose
+000599d0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+000599e0: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
+000599f0: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
+00059a00: 2b3d 2070 642e 5365 7269 6573 286d 6f64  += pd.Series(mod
+00059a10: 656c 5f78 6762 2e67 6574 5f62 6f6f 7374  el_xgb.get_boost
+00059a20: 6572 2829 2e67 6574 5f73 636f 7265 280d  er().get_score(.
+00059a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059a50: 2069 6d70 6f72 7461 6e63 655f 7479 7065   importance_type
+00059a60: 3d27 6761 696e 2729 292e 736f 7274 5f76  ='gain')).sort_v
+00059a70: 616c 7565 7328 6173 6365 6e64 696e 673d  alues(ascending=
+00059a80: 4661 6c73 6529 5b3a 746f 705f 6e75 6d5d  False)[:top_num]
+00059a90: 2e69 6e64 6578 2e74 6f6c 6973 7428 290d  .index.tolist().
+00059aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059ab0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00059ac0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00059ad0: 775f 7867 622e 6669 7428 585f 7472 6169  w_xgb.fit(X_trai
+00059ae0: 6e2c 795f 7472 6169 6e2c 6561 726c 795f  n,y_train,early_
+00059af0: 7374 6f70 7069 6e67 5f72 6f75 6e64 733d  stopping_rounds=
+00059b00: 6561 726c 795f 7374 6f70 7069 6e67 2c65  early_stopping,e
+00059b10: 7661 6c5f 7365 743d 6576 616c 5f73 6574  val_set=eval_set
+00059b20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00059b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059b40: 2020 2020 2020 2020 2020 2065 7661 6c5f             eval_
+00059b50: 6d65 7472 6963 3d65 7661 6c5f 6d65 7472  metric=eval_metr
+00059b60: 6963 2c76 6572 626f 7365 3d46 616c 7365  ic,verbose=False
+00059b70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00059b80: 2020 2020 2020 2070 7269 6e74 2827 5847         print('XG
+00059b90: 4220 6861 7320 6120 6275 6720 696e 2076  B has a bug in v
+00059ba0: 6572 7369 6f6e 2078 6762 6f6f 7374 2031  ersion xgboost 1
+00059bb0: 2e30 3220 666f 7220 6665 6174 7572 6520  .02 for feature 
+00059bc0: 696d 706f 7274 616e 6365 732e 2054 7279  importances. Try
+00059bd0: 2074 6f20 696e 7374 616c 6c20 7665 7273   to install vers
+00059be0: 696f 6e20 302e 3930 206f 7220 312e 3130  ion 0.90 or 1.10
+00059bf0: 202d 2063 6f6e 7469 6e75 696e 672e 2e2e   - continuing...
+00059c00: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00059c10: 2020 2020 2020 2020 696d 706f 7274 616e          importan
+00059c20: 745f 6665 6174 7572 6573 202b 3d20 7064  t_features += pd
+00059c30: 2e53 6572 6965 7328 6e65 775f 7867 622e  .Series(new_xgb.
+00059c40: 6765 745f 626f 6f73 7465 7228 292e 6765  get_booster().ge
+00059c50: 745f 7363 6f72 6528 0d0a 2020 2020 2020  t_score(..      
+00059c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059c70: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00059c80: 616e 6365 5f74 7970 653d 2767 6169 6e27  ance_type='gain'
+00059c90: 2929 2e73 6f72 745f 7661 6c75 6573 2861  )).sort_values(a
+00059ca0: 7363 656e 6469 6e67 3d46 616c 7365 295b  scending=False)[
+00059cb0: 3a74 6f70 5f6e 756d 5d2e 696e 6465 782e  :top_num].index.
+00059cc0: 746f 6c69 7374 2829 0d0a 2020 2020 2020  tolist()..      
+00059cd0: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00059ce0: 616e 745f 6665 6174 7572 6573 203d 206c  ant_features = l
+00059cf0: 6973 7428 4f72 6465 7265 6444 6963 742e  ist(OrderedDict.
+00059d00: 6672 6f6d 6b65 7973 2869 6d70 6f72 7461  fromkeys(importa
+00059d10: 6e74 5f66 6561 7475 7265 7329 290d 0a20  nt_features)).. 
+00059d20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00059d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00059d40: 2020 5820 3d20 7472 6169 6e5f 705b 6c69    X = train_p[li
+00059d50: 7374 2874 7261 696e 5f70 2e63 6f6c 756d  st(train_p.colum
+00059d60: 6e73 2e76 616c 7565 7329 5b69 3a74 7261  ns.values)[i:tra
+00059d70: 696e 5f70 2e73 6861 7065 5b31 5d5d 5d0d  in_p.shape[1]]].
+00059d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059d90: 2023 2323 2320 5370 6c69 7420 6865 7265   #### Split here
+00059da0: 2069 6e74 6f20 7472 6169 6e20 616e 6420   into train and 
+00059db0: 7465 7374 2023 2323 2323 0d0a 2020 2020  test #####..    
+00059dc0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00059dd0: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
+00059de0: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
+00059df0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00059e00: 7261 696e 5f70 6172 7420 3d20 696e 7428  rain_part = int(
+00059e10: 2831 2d74 6573 745f 7369 7a65 292a 582e  (1-test_size)*X.
+00059e20: 7368 6170 655b 305d 290d 0a20 2020 2020  shape[0])..     
+00059e30: 2020 2020 2020 2020 2020 2020 2020 2058                 X
+00059e40: 5f74 7261 696e 2c20 585f 6376 2c20 795f  _train, X_cv, y_
+00059e50: 7472 6169 6e2c 2079 5f63 7620 3d20 585b  train, y_cv = X[
+00059e60: 3a74 7261 696e 5f70 6172 745d 2c58 5b74  :train_part],X[t
+00059e70: 7261 696e 5f70 6172 743a 5d2c 795b 3a74  rain_part:],y[:t
+00059e80: 7261 696e 5f70 6172 745d 2c79 5b74 7261  rain_part],y[tra
+00059e90: 696e 5f70 6172 743a 5d0d 0a20 2020 2020  in_part:]..     
+00059ea0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00059eb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00059ec0: 2020 2020 2020 585f 7472 6169 6e2c 2058        X_train, X
+00059ed0: 5f63 762c 2079 5f74 7261 696e 2c20 795f  _cv, y_train, y_
+00059ee0: 6376 203d 2074 7261 696e 5f74 6573 745f  cv = train_test_
+00059ef0: 7370 6c69 7428 582c 2079 2c0d 0a20 2020  split(X, y,..   
+00059f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059f30: 2074 6573 745f 7369 7a65 3d74 6573 745f   test_size=test_
+00059f40: 7369 7a65 2c20 7261 6e64 6f6d 5f73 7461  size, random_sta
+00059f50: 7465 3d73 6565 642c 7374 7261 7469 6679  te=seed,stratify
+00059f60: 3d79 290d 0a20 2020 2020 2020 2020 2020  =y)..           
+00059f70: 2020 2020 2065 7661 6c5f 7365 7420 3d20       eval_set = 
+00059f80: 5b28 585f 7472 6169 6e2c 795f 7472 6169  [(X_train,y_trai
+00059f90: 6e29 2c28 585f 6376 2c79 5f63 7629 5d0d  n),(X_cv,y_cv)].
+00059fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059fb0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00059fc0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00059fd0: 5f78 6762 2e66 6974 2858 5f74 7261 696e  _xgb.fit(X_train
+00059fe0: 2c79 5f74 7261 696e 2c65 6172 6c79 5f73  ,y_train,early_s
+00059ff0: 746f 7070 696e 675f 726f 756e 6473 3d65  topping_rounds=e
+0005a000: 6172 6c79 5f73 746f 7070 696e 672c 0d0a  arly_stopping,..
+0005a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a030: 2020 6576 616c 5f73 6574 3d65 7661 6c5f    eval_set=eval_
+0005a040: 7365 742c 6576 616c 5f6d 6574 7269 633d  set,eval_metric=
+0005a050: 6576 616c 5f6d 6574 7269 632c 7665 7262  eval_metric,verb
+0005a060: 6f73 653d 4661 6c73 6529 0d0a 2020 2020  ose=False)..    
+0005a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a080: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0005a090: 6573 202b 3d20 7064 2e53 6572 6965 7328  es += pd.Series(
+0005a0a0: 6d6f 6465 6c5f 7867 622e 6765 745f 626f  model_xgb.get_bo
+0005a0b0: 6f73 7465 7228 292e 6765 745f 7363 6f72  oster().get_scor
+0005a0c0: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
+0005a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a0e0: 2020 2020 696d 706f 7274 616e 6365 5f74      importance_t
+0005a0f0: 7970 653d 2767 6169 6e27 2929 2e73 6f72  ype='gain')).sor
+0005a100: 745f 7661 6c75 6573 2861 7363 656e 6469  t_values(ascendi
+0005a110: 6e67 3d46 616c 7365 295b 3a74 6f70 5f6e  ng=False)[:top_n
+0005a120: 756d 5d2e 696e 6465 782e 746f 6c69 7374  um].index.tolist
+0005a130: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0005a140: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+0005a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a160: 206e 6577 5f78 6762 2e66 6974 2858 5f74   new_xgb.fit(X_t
+0005a170: 7261 696e 2c79 5f74 7261 696e 2c65 6172  rain,y_train,ear
+0005a180: 6c79 5f73 746f 7070 696e 675f 726f 756e  ly_stopping_roun
+0005a190: 6473 3d65 6172 6c79 5f73 746f 7070 696e  ds=early_stoppin
+0005a1a0: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
+0005a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a1c0: 2020 2020 2020 6576 616c 5f73 6574 3d65        eval_set=e
+0005a1d0: 7661 6c5f 7365 742c 6576 616c 5f6d 6574  val_set,eval_met
+0005a1e0: 7269 633d 6576 616c 5f6d 6574 7269 632c  ric=eval_metric,
+0005a1f0: 7665 7262 6f73 653d 4661 6c73 6529 0d0a  verbose=False)..
+0005a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a210: 2020 2020 696d 706f 7274 616e 745f 6665      important_fe
+0005a220: 6174 7572 6573 202b 3d20 7064 2e53 6572  atures += pd.Ser
+0005a230: 6965 7328 6d6f 6465 6c5f 7867 622e 6765  ies(model_xgb.ge
+0005a240: 745f 626f 6f73 7465 7228 292e 6765 745f  t_booster().get_
+0005a250: 7363 6f72 6528 0d0a 2020 2020 2020 2020  score(..        
+0005a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a270: 2020 2020 2020 2020 696d 706f 7274 616e          importan
+0005a280: 6365 5f74 7970 653d 2767 6169 6e27 2929  ce_type='gain'))
+0005a290: 2e73 6f72 745f 7661 6c75 6573 2861 7363  .sort_values(asc
+0005a2a0: 656e 6469 6e67 3d46 616c 7365 295b 3a74  ending=False)[:t
+0005a2b0: 6f70 5f6e 756d 5d2e 696e 6465 782e 746f  op_num].index.to
+0005a2c0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+0005a2d0: 2020 2020 2020 2020 696d 706f 7274 616e          importan
+0005a2e0: 745f 6665 6174 7572 6573 203d 206c 6973  t_features = lis
+0005a2f0: 7428 4f72 6465 7265 6444 6963 742e 6672  t(OrderedDict.fr
+0005a300: 6f6d 6b65 7973 2869 6d70 6f72 7461 6e74  omkeys(important
+0005a310: 5f66 6561 7475 7265 7329 290d 0a20 2020  _features))..   
+0005a320: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+0005a330: 2020 7072 696e 7428 2746 696e 6469 6e67    print('Finding
+0005a340: 2074 6f70 2066 6561 7475 7265 7320 7573   top features us
+0005a350: 696e 6720 5847 4220 6973 2063 7261 7368  ing XGB is crash
+0005a360: 696e 672e 2043 6f6e 7469 6e75 696e 6720  ing. Continuing 
+0005a370: 7769 7468 2061 6c6c 2070 7265 6469 6374  with all predict
+0005a380: 6f72 732e 2e2e 2729 0d0a 2020 2020 2020  ors...')..      
+0005a390: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
+0005a3a0: 7572 6573 203d 2063 6f70 792e 6465 6570  ures = copy.deep
+0005a3b0: 636f 7079 2870 7265 6473 290d 0a20 2020  copy(preds)..   
+0005a3c0: 2020 2020 2072 6574 7572 6e20 696d 706f       return impo
+0005a3d0: 7274 616e 745f 6665 6174 7572 6573 2c20  rtant_features, 
+0005a3e0: 5b5d 2c20 5b5d 0d0a 2020 2020 696d 706f  [], []..    impo
+0005a3f0: 7274 616e 745f 6665 6174 7572 6573 203d  rtant_features =
+0005a400: 206c 6973 7428 4f72 6465 7265 6444 6963   list(OrderedDic
+0005a410: 742e 6672 6f6d 6b65 7973 2869 6d70 6f72  t.fromkeys(impor
+0005a420: 7461 6e74 5f66 6561 7475 7265 7329 290d  tant_features)).
+0005a430: 0a20 2020 2070 7269 6e74 2827 466f 756e  .    print('Foun
+0005a440: 6420 2564 2069 6d70 6f72 7461 6e74 2066  d %d important f
+0005a450: 6561 7475 7265 7327 2025 6c65 6e28 696d  eatures' %len(im
+0005a460: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
+0005a470: 2929 0d0a 2020 2020 2370 7269 6e74 2827  ))..    #print('
+0005a480: 2020 2020 5469 6d65 2074 616b 656e 2028      Time taken (
+0005a490: 696e 2073 6563 6f6e 6473 2920 3d20 2530  in seconds) = %0
+0005a4a0: 2e30 6627 2025 2874 696d 652e 7469 6d65  .0f' %(time.time
+0005a4b0: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
+0005a4c0: 0a20 2020 206e 756d 7661 7273 203d 205b  .    numvars = [
+0005a4d0: 7820 666f 7220 7820 696e 206e 756d 7661  x for x in numva
+0005a4e0: 7273 2069 6620 7820 696e 2069 6d70 6f72  rs if x in impor
+0005a4f0: 7461 6e74 5f66 6561 7475 7265 735d 0d0a  tant_features]..
+0005a500: 2020 2020 696d 706f 7274 616e 745f 6361      important_ca
+0005a510: 7473 203d 205b 7820 666f 7220 7820 696e  ts = [x for x in
+0005a520: 2069 6d70 6f72 7461 6e74 5f63 6174 7320   important_cats 
+0005a530: 6966 2078 2069 6e20 696d 706f 7274 616e  if x in importan
+0005a540: 745f 6665 6174 7572 6573 5d0d 0a20 2020  t_features]..   
+0005a550: 2072 6574 7572 6e20 696d 706f 7274 616e   return importan
+0005a560: 745f 6665 6174 7572 6573 2c20 6e75 6d76  t_features, numv
+0005a570: 6172 732c 2069 6d70 6f72 7461 6e74 5f63  ars, important_c
+0005a580: 6174 730d 0a23 2323 2323 2323 2323 2323  ats..###########
+0005a590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005a5a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005a5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005a5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005a5d0: 2323 2323 230d 0a64 6566 2062 6173 6b65  #####..def baske
+0005a5e0: 745f 7265 6361 6c6c 286c 6162 656c 2c20  t_recall(label, 
+0005a5f0: 7072 6564 293a 0d0a 2020 2020 2222 220d  pred):..    """.
+0005a600: 0a20 2020 2054 6869 7320 7465 7374 7320  .    This tests 
+0005a610: 7468 6520 7265 6361 6c6c 206f 6620 6120  the recall of a 
+0005a620: 6769 7665 6e20 6261 736b 6574 206f 6620  given basket of 
+0005a630: 6974 656d 7320 696e 2061 206c 6162 656c  items in a label
+0005a640: 2062 7920 7468 6520 7365 636f 6e64 2062   by the second b
+0005a650: 6173 6b65 742c 2070 7265 642e 0d0a 2020  asket, pred...  
+0005a660: 2020 4974 2063 6f6d 7061 7265 7320 7468    It compares th
+0005a670: 6520 3220 6261 736b 6574 7320 2861 7272  e 2 baskets (arr
+0005a680: 6179 7320 6f72 206c 6973 7473 2920 6e61  ays or lists) na
+0005a690: 6d65 6420 6173 206c 6162 656c 2061 6e64  med as label and
+0005a6a0: 2070 7265 642c 2061 6e64 2066 696e 6473   pred, and finds
+0005a6b0: 2063 6f6d 6d6f 6e20 6974 656d 730d 0a20   common items.. 
+0005a6c0: 2020 2062 6574 7765 656e 2074 6865 2074     between the t
+0005a6d0: 776f 2e20 5468 656e 2069 7420 6469 7669  wo. Then it divi
+0005a6e0: 6465 7320 7468 6174 206c 656e 6774 6820  des that length 
+0005a6f0: 6279 2074 6865 2074 6f74 616c 206e 756d  by the total num
+0005a700: 6265 7220 6f66 2069 7465 6d73 2069 6e20  ber of items in 
+0005a710: 7468 6520 6c61 6265 6c20 6261 736b 6574  the label basket
+0005a720: 0d0a 2020 2020 746f 2063 6f6d 6520 7570  ..    to come up
+0005a730: 2077 6974 6820 6120 6261 736b 6574 2072   with a basket r
+0005a740: 6563 616c 6c20 7363 6f72 652e 2054 6869  ecall score. Thi
+0005a750: 7320 7363 6f72 6520 6d61 7920 6265 2075  s score may be u
+0005a760: 7365 6675 6c20 696e 2072 6563 6f6d 6d65  seful in recomme
+0005a770: 6e64 6174 696f 6e20 7072 6f62 6c65 6d73  ndation problems
+0005a780: 0d0a 2020 2020 7768 6572 6520 796f 7520  ..    where you 
+0005a790: 6172 6520 696e 7465 7265 7374 6564 2069  are interested i
+0005a7a0: 6e20 6669 6e64 696e 6720 686f 7720 6d61  n finding how ma
+0005a7b0: 6e79 2069 7465 6d73 2069 6e20 6120 6261  ny items in a ba
+0005a7c0: 736b 6574 2028 6c61 6265 6c73 2920 7468  sket (labels) th
+0005a7d0: 6174 2079 6f75 720d 0a20 2020 2070 7265  at your..    pre
+0005a7e0: 6469 6374 696f 6e73 2028 7072 6564 2920  dictions (pred) 
+0005a7f0: 6261 736b 6574 2067 6f74 2063 6f72 7265  basket got corre
+0005a800: 6374 2e20 5468 6520 6f72 6465 7220 6f66  ct. The order of
+0005a810: 2074 6865 2069 7465 6d73 2069 6e20 7468   the items in th
+0005a820: 6520 6261 736b 6574 7320 646f 6573 206e  e baskets does n
+0005a830: 6f74 206d 6174 7465 722e 0d0a 2020 2020  ot matter...    
+0005a840: 2222 220d 0a20 2020 2069 6620 6973 696e  """..    if isin
+0005a850: 7374 616e 6365 286c 6162 656c 2c20 6c69  stance(label, li
+0005a860: 7374 293a 0d0a 2020 2020 2020 2020 6c61  st):..        la
+0005a870: 6265 6c20 3d20 6e70 2e61 7272 6179 286c  bel = np.array(l
+0005a880: 6162 656c 290d 0a20 2020 2069 6620 6973  abel)..    if is
+0005a890: 696e 7374 616e 6365 2870 7265 642c 206c  instance(pred, l
+0005a8a0: 6973 7429 3a0d 0a20 2020 2020 2020 2070  ist):..        p
+0005a8b0: 7265 6420 3d20 6e70 2e61 7272 6179 2870  red = np.array(p
+0005a8c0: 7265 6429 0d0a 2020 2020 6966 206c 656e  red)..    if len
+0005a8d0: 286c 6162 656c 2920 3e20 313a 0d0a 2020  (label) > 1:..  
+0005a8e0: 2020 2020 2020 6a61 6363 5f61 7272 203d        jacc_arr =
+0005a8f0: 205b 5d0d 0a20 2020 2020 2020 2066 6f72   []..        for
+0005a900: 2072 6f77 312c 726f 7732 2c63 6f75 6e74   row1,row2,count
+0005a910: 2069 6e20 7a69 7028 6c61 6265 6c2c 7072   in zip(label,pr
+0005a920: 6564 2c20 7261 6e67 6528 6c65 6e28 6c61  ed, range(len(la
+0005a930: 6265 6c29 2929 3a0d 0a20 2020 2020 2020  bel))):..       
+0005a940: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
+0005a950: 6e20 3d20 6c65 6e28 6e70 2e69 6e74 6572  n = len(np.inter
+0005a960: 7365 6374 3164 2872 6f77 312c 726f 7732  sect1d(row1,row2
+0005a970: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0005a980: 756e 696f 6e20 3d20 6c65 6e28 726f 7731  union = len(row1
+0005a990: 290d 0a20 2020 2020 2020 2020 2020 206a  )..            j
+0005a9a0: 6163 6320 3d20 666c 6f61 7428 696e 7465  acc = float(inte
+0005a9b0: 7273 6563 7469 6f6e 202f 2075 6e69 6f6e  rsection / union
+0005a9c0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0005a9d0: 6620 636f 756e 7420 3d3d 2030 3a0d 0a20  f count == 0:.. 
+0005a9e0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+0005a9f0: 6163 635f 6172 7220 3d20 636f 7079 2e64  acc_arr = copy.d
+0005aa00: 6565 7063 6f70 7928 6a61 6363 290d 0a20  eepcopy(jacc).. 
+0005aa10: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0005aa20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0005aa30: 2020 6a61 6363 5f61 7272 203d 206e 702e    jacc_arr = np.
+0005aa40: 725f 5b6a 6163 635f 6172 722c 6a61 6363  r_[jacc_arr,jacc
+0005aa50: 5d0d 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
+0005aa60: 6e20 6a61 6363 5f61 7272 0d0a 2020 2020  n jacc_arr..    
+0005aa70: 656c 7365 3a0d 0a20 2020 2020 2020 2069  else:..        i
+0005aa80: 6e74 6572 7365 6374 696f 6e20 3d20 6c65  ntersection = le
+0005aa90: 6e28 6c69 7374 2873 6574 286c 6973 7431  n(list(set(list1
+0005aaa0: 292e 696e 7465 7273 6563 7469 6f6e 2873  ).intersection(s
+0005aab0: 6574 286c 6973 7432 2929 2929 0d0a 2020  et(list2))))..  
+0005aac0: 2020 2020 2020 756e 696f 6e20 3d20 286c        union = (l
+0005aad0: 656e 286c 6973 7431 2920 2b20 6c65 6e28  en(list1) + len(
+0005aae0: 6c69 7374 3229 2920 2d20 696e 7465 7273  list2)) - inters
+0005aaf0: 6563 7469 6f6e 0d0a 2020 2020 2020 2020  ection..        
+0005ab00: 6a61 6363 5f61 7272 203d 2066 6c6f 6174  jacc_arr = float
+0005ab10: 2869 6e74 6572 7365 6374 696f 6e20 2f20  (intersection / 
+0005ab20: 756e 696f 6e29 0d0a 2020 2020 7265 7475  union)..    retu
+0005ab30: 726e 206a 6163 635f 6172 720d 0a23 2323  rn jacc_arr..###
+0005ab40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ab50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ab60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ab70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ab80: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+0005ab90: 6566 206a 6163 6361 7264 5f73 696e 676c  ef jaccard_singl
+0005aba0: 656c 6162 656c 286c 6162 656c 2c20 7072  elabel(label, pr
+0005abb0: 6564 293a 0d0a 2020 2020 2222 220d 0a20  ed):..    """.. 
+0005abc0: 2020 2054 6869 7320 636f 6d70 6172 6573     This compares
+0005abd0: 2032 2062 6173 6b65 7473 2028 636f 756c   2 baskets (coul
+0005abe0: 6420 6265 206c 6973 7473 206f 7220 6172  d be lists or ar
+0005abf0: 7261 7973 293a 206c 6162 656c 2061 6e64  rays): label and
+0005ac00: 2070 7265 642c 2061 6e64 2066 696e 6473   pred, and finds
+0005ac10: 2063 6f6d 6d6f 6e20 6974 656d 730d 0a20   common items.. 
+0005ac20: 2020 2062 6574 7765 656e 2074 6865 2074     between the t
+0005ac30: 776f 2e20 5468 656e 2069 7420 6469 7669  wo. Then it divi
+0005ac40: 6465 7320 7468 6174 206e 756d 6265 7220  des that number 
+0005ac50: 6279 2065 6974 6865 7220 726f 7773 206f  by either rows o
+0005ac60: 7220 636f 6c75 6d6e 7320 746f 2072 6574  r columns to ret
+0005ac70: 7572 6e20 252e 0d0a 2020 2020 2020 2020  urn %...        
+0005ac80: 2323 2320 4a61 6363 6172 645f 436f 6c75  ### Jaccard_Colu
+0005ac90: 6d6e 7769 7365 203d 2074 6869 7320 6d65  mnwise = this me
+0005aca0: 616e 7320 796f 7520 6861 7665 206d 756c  ans you have mul
+0005acb0: 7469 2d6c 6162 656c 7320 616e 6420 796f  ti-labels and yo
+0005acc0: 7520 7761 6e74 2069 7420 7375 6d6d 6564  u want it summed
+0005acd0: 2063 6f6c 756d 6e77 6973 650d 0a20 2020   columnwise..   
+0005ace0: 2020 2020 2023 2323 2020 2054 6869 7320       ###   This 
+0005acf0: 7465 6c6c 7320 796f 7520 7768 6174 2069  tells you what i
+0005ad00: 7320 7468 6520 6176 6572 6167 6520 6163  s the average ac
+0005ad10: 6375 7261 6379 2066 6f72 2065 6163 6820  curacy for each 
+0005ad20: 636f 6c75 6d6e 2069 6e20 6d75 6c74 692d  column in multi-
+0005ad30: 6c61 6265 6c20 7461 7267 6574 0d0a 2020  label target..  
+0005ad40: 2020 2020 2020 2323 2320 2020 4974 2077        ###   It w
+0005ad50: 696c 6c20 7265 7475 726e 2061 7320 6d61  ill return as ma
+0005ad60: 6e79 2074 6f74 616c 7320 6173 2074 6865  ny totals as the
+0005ad70: 206e 756d 6265 7220 6f66 2063 6f6c 756d   number of colum
+0005ad80: 6e73 2069 6e20 796f 7572 206d 756c 7469  ns in your multi
+0005ad90: 2d6c 6162 656c 2074 6172 6765 742e 0d0a  -label target...
+0005ada0: 2020 2020 2020 2020 2323 2320 2020 546f          ###   To
+0005adb0: 2067 6574 2061 2070 6572 6365 6e74 6167   get a percentag
+0005adc0: 652c 2079 6f75 2077 696c 6c20 6861 7665  e, you will have
+0005add0: 2074 6f20 6469 7669 6465 2069 7420 6279   to divide it by
+0005ade0: 2074 6865 206e 756d 6265 7220 6f66 2072   the number of r
+0005adf0: 6f77 7320 696e 2074 6865 2064 6174 6120  ows in the data 
+0005ae00: 7365 742e 0d0a 2020 2020 2020 2020 2323  set...        ##
+0005ae10: 2320 2020 5468 6973 2070 6572 6365 6e74  #   This percent
+0005ae20: 6167 6520 6769 7665 7320 796f 7520 7468  age gives you th
+0005ae30: 6520 2520 6f66 2072 6f77 7320 696e 2065  e % of rows in e
+0005ae40: 6163 6820 6c61 6265 6c20 796f 7520 676f  ach label you go
+0005ae50: 7420 636f 7272 6563 746c 793d 2545 6163  t correctly=%Eac
+0005ae60: 685f 4c61 6265 6c20 4163 6375 7261 6379  h_Label Accuracy
+0005ae70: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
+0005ae80: 5468 6973 2077 696c 6c20 6769 7665 2079  This will give y
+0005ae90: 6f75 2061 7320 6d61 6e79 2070 6572 6365  ou as many perce
+0005aea0: 6e74 6167 6573 2061 7320 7468 6572 6520  ntages as there 
+0005aeb0: 6172 6520 6c61 6265 6c73 2069 6e20 796f  are labels in yo
+0005aec0: 7572 206d 756c 7469 2d6c 6162 656c 2074  ur multi-label t
+0005aed0: 6172 6765 742e 0d0a 2020 2020 2020 2020  arget...        
+0005aee0: 2323 2320 4a61 6363 6172 645f 526f 772d  ### Jaccard_Row-
+0005aef0: 7769 7365 203d 2074 6869 7320 6d65 616e  wise = this mean
+0005af00: 7320 796f 7520 6861 7665 2063 6f6d 626f  s you have combo
+0005af10: 7320 6275 7420 7768 6572 6520 6f72 6465  s but where orde
+0005af20: 7220 6d61 7474 6572 7320 616e 6420 796f  r matters and yo
+0005af30: 7520 7761 6e74 2069 7420 636f 6d70 6172  u want it compar
+0005af40: 6564 2072 6f77 2d77 6973 650d 0a20 2020  ed row-wise..   
+0005af50: 2020 2020 2023 2323 2020 2054 6869 7320       ###   This 
+0005af60: 7465 6c6c 7320 796f 7520 686f 7720 6d61  tells you how ma
+0005af70: 6e79 206c 6162 656c 7320 696e 2065 6163  ny labels in eac
+0005af80: 6820 726f 7720 6469 6420 796f 7520 6765  h row did you ge
+0005af90: 7420 7269 6768 742e 2054 4861 7427 7320  t right. THat's 
+0005afa0: 6163 6375 7261 6379 2062 7920 726f 772e  accuracy by row.
+0005afb0: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
+0005afc0: 4974 2077 696c 6c20 7265 7475 726e 2061  It will return a
+0005afd0: 7320 6d61 6e79 2074 6f74 616c 7320 6173  s many totals as
+0005afe0: 2074 6865 206e 756d 6265 7220 6f66 2072   the number of r
+0005aff0: 6f77 7320 696e 2079 6f75 7220 6461 7461  ows in your data
+0005b000: 2073 6574 2e0d 0a20 2020 2020 2020 2023   set...        #
+0005b010: 2323 2020 2054 6f20 6765 7420 6120 7065  ##   To get a pe
+0005b020: 7263 656e 7461 6765 2c20 796f 7520 7769  rcentage, you wi
+0005b030: 6c6c 2068 6176 6520 746f 2064 6976 6964  ll have to divid
+0005b040: 6520 6974 2062 7920 7468 6520 6e75 6d62  e it by the numb
+0005b050: 6572 206f 6620 6c61 6265 6c73 2069 6e20  er of labels in 
+0005b060: 7468 6520 6461 7461 2073 6574 2e0d 0a20  the data set... 
+0005b070: 2020 2020 2020 2023 2323 2020 2054 6869         ###   Thi
+0005b080: 7320 7065 7263 656e 7461 6765 2067 6976  s percentage giv
+0005b090: 6573 2079 6f75 2074 6865 2025 206f 6620  es you the % of 
+0005b0a0: 6c61 6265 6c73 2069 6e20 6561 6368 2072  labels in each r
+0005b0b0: 6f77 2079 6f75 2067 6f74 2063 6f72 7265  ow you got corre
+0005b0c0: 6374 6c79 3d25 436f 6d62 696e 6564 5f4c  ctly=%Combined_L
+0005b0d0: 6162 656c 5f41 6363 7572 6163 790d 0a20  abel_Accuracy.. 
+0005b0e0: 2020 2020 2020 2023 2323 2020 2054 6869         ###   Thi
+0005b0f0: 7320 7769 6c6c 2067 6976 6520 796f 7520  s will give you 
+0005b100: 6120 7369 6e67 6c65 2070 6572 6365 6e74  a single percent
+0005b110: 6167 6520 6e75 6d62 6572 2066 6f72 2074  age number for t
+0005b120: 6865 2077 686f 6c65 2064 6174 6120 7365  he whole data se
+0005b130: 740d 0a20 2020 2022 2222 0d0a 2020 2020  t..    """..    
+0005b140: 6966 2069 7369 6e73 7461 6e63 6528 6c61  if isinstance(la
+0005b150: 6265 6c2c 206c 6973 7429 3a0d 0a20 2020  bel, list):..   
+0005b160: 2020 2020 206c 6162 656c 203d 206e 702e       label = np.
+0005b170: 6172 7261 7928 6c61 6265 6c29 0d0a 2020  array(label)..  
+0005b180: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0005b190: 7072 6564 2c20 6c69 7374 293a 0d0a 2020  pred, list):..  
+0005b1a0: 2020 2020 2020 7072 6564 203d 206e 702e        pred = np.
+0005b1b0: 6172 7261 7928 7072 6564 290d 0a20 2020  array(pred)..   
+0005b1c0: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
+0005b1d0: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
+0005b1e0: 756c 7469 2d4c 6162 656c 2050 726f 626c  ulti-Label Probl
+0005b1f0: 656d 7320 2323 2323 2320 5265 7475 726e  ems ##### Return
+0005b200: 7320 3220 7265 7375 6c74 733a 206f 6e65  s 2 results: one
+0005b210: 206e 756d 6265 7220 616e 640d 0a20 2020   number and..   
+0005b220: 2020 2020 2023 2323 2020 2020 7468 6520       ###    the 
+0005b230: 7365 636f 6e64 2069 7320 616e 2061 7272  second is an arr
+0005b240: 6179 2077 6974 6820 6173 206d 616e 7920  ay with as many 
+0005b250: 6974 656d 7320 6173 206e 756d 6265 7220  items as number 
+0005b260: 6f66 206c 6162 656c 7320 696e 2074 6172  of labels in tar
+0005b270: 6765 740d 0a20 2020 2020 2020 206a 6163  get..        jac
+0005b280: 635f 6561 6368 5f6c 6162 656c 203d 206e  c_each_label = n
+0005b290: 702e 7375 6d28 6c61 6265 6c3d 3d70 7265  p.sum(label==pre
+0005b2a0: 642c 6178 6973 3d30 292f 6c61 6265 6c2e  d,axis=0)/label.
+0005b2b0: 7368 6170 655b 305d 0d0a 2020 2020 2020  shape[0]..      
+0005b2c0: 2020 7265 7475 726e 2020 6a61 6363 5f65    return  jacc_e
+0005b2d0: 6163 685f 6c61 6265 6c0d 0a20 2020 2065  ach_label..    e
+0005b2e0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0005b2f0: 7265 7475 726e 2030 0d0a 2323 2323 2323  return 0..######
+0005b300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005b310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005b320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005b330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005b340: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
+0005b350: 6a61 6363 6172 645f 6d75 6c74 696c 6162  jaccard_multilab
+0005b360: 656c 286c 6162 656c 2c20 7072 6564 293a  el(label, pred):
+0005b370: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+0005b380: 6869 7320 636f 6d70 6172 6573 2032 2062  his compares 2 b
+0005b390: 6173 6b65 7473 2028 636f 756c 6420 6265  askets (could be
+0005b3a0: 206c 6973 7473 206f 7220 6172 7261 7973   lists or arrays
+0005b3b0: 293a 206c 6162 656c 2061 6e64 2070 7265  ): label and pre
+0005b3c0: 642c 2061 6e64 2066 696e 6473 2063 6f6d  d, and finds com
+0005b3d0: 6d6f 6e20 6974 656d 730d 0a20 2020 2062  mon items..    b
+0005b3e0: 6574 7765 656e 2074 6865 2074 776f 2e20  etween the two. 
+0005b3f0: 5468 656e 2069 7420 6469 7669 6465 7320  Then it divides 
+0005b400: 7468 6174 206e 756d 6265 7220 6279 2065  that number by e
+0005b410: 6974 6865 7220 726f 7773 206f 7220 636f  ither rows or co
+0005b420: 6c75 6d6e 7320 746f 2072 6574 7572 6e20  lumns to return 
+0005b430: 252e 0d0a 2020 2020 2020 2020 2323 2320  %...        ### 
+0005b440: 4a61 6363 6172 645f 436f 6c75 6d6e 7769  Jaccard_Columnwi
+0005b450: 7365 203d 2074 6869 7320 6d65 616e 7320  se = this means 
+0005b460: 796f 7520 6861 7665 206d 756c 7469 2d6c  you have multi-l
+0005b470: 6162 656c 7320 616e 6420 796f 7520 7761  abels and you wa
+0005b480: 6e74 2069 7420 7375 6d6d 6564 2063 6f6c  nt it summed col
+0005b490: 756d 6e77 6973 650d 0a20 2020 2020 2020  umnwise..       
+0005b4a0: 2023 2323 2020 2054 6869 7320 7465 6c6c   ###   This tell
+0005b4b0: 7320 796f 7520 7768 6174 2069 7320 7468  s you what is th
+0005b4c0: 6520 6176 6572 6167 6520 6163 6375 7261  e average accura
+0005b4d0: 6379 2066 6f72 2065 6163 6820 636f 6c75  cy for each colu
+0005b4e0: 6d6e 2069 6e20 6d75 6c74 692d 6c61 6265  mn in multi-labe
+0005b4f0: 6c20 7461 7267 6574 0d0a 2020 2020 2020  l target..      
+0005b500: 2020 2323 2320 2020 4974 2077 696c 6c20    ###   It will 
+0005b510: 7265 7475 726e 2061 7320 6d61 6e79 2074  return as many t
+0005b520: 6f74 616c 7320 6173 2074 6865 206e 756d  otals as the num
+0005b530: 6265 7220 6f66 2063 6f6c 756d 6e73 2069  ber of columns i
+0005b540: 6e20 796f 7572 206d 756c 7469 2d6c 6162  n your multi-lab
+0005b550: 656c 2074 6172 6765 742e 0d0a 2020 2020  el target...    
+0005b560: 2020 2020 2323 2320 2020 546f 2067 6574      ###   To get
+0005b570: 2061 2070 6572 6365 6e74 6167 652c 2079   a percentage, y
+0005b580: 6f75 2077 696c 6c20 6861 7665 2074 6f20  ou will have to 
+0005b590: 6469 7669 6465 2069 7420 6279 2074 6865  divide it by the
+0005b5a0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+0005b5b0: 696e 2074 6865 2064 6174 6120 7365 742e  in the data set.
+0005b5c0: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
+0005b5d0: 5468 6973 2070 6572 6365 6e74 6167 6520  This percentage 
+0005b5e0: 6769 7665 7320 796f 7520 7468 6520 2520  gives you the % 
+0005b5f0: 6f66 2072 6f77 7320 696e 2065 6163 6820  of rows in each 
+0005b600: 6c61 6265 6c20 796f 7520 676f 7420 636f  label you got co
+0005b610: 7272 6563 746c 793d 2545 6163 685f 4c61  rrectly=%Each_La
+0005b620: 6265 6c20 4163 6375 7261 6379 0d0a 2020  bel Accuracy..  
+0005b630: 2020 2020 2020 2323 2320 2020 5468 6973        ###   This
+0005b640: 2077 696c 6c20 6769 7665 2079 6f75 2061   will give you a
+0005b650: 7320 6d61 6e79 2070 6572 6365 6e74 6167  s many percentag
+0005b660: 6573 2061 7320 7468 6572 6520 6172 6520  es as there are 
+0005b670: 6c61 6265 6c73 2069 6e20 796f 7572 206d  labels in your m
+0005b680: 756c 7469 2d6c 6162 656c 2074 6172 6765  ulti-label targe
+0005b690: 742e 0d0a 2020 2020 2020 2020 2323 2320  t...        ### 
+0005b6a0: 4a61 6363 6172 645f 526f 772d 7769 7365  Jaccard_Row-wise
+0005b6b0: 203d 2074 6869 7320 6d65 616e 7320 796f   = this means yo
+0005b6c0: 7520 6861 7665 2063 6f6d 626f 7320 6275  u have combos bu
+0005b6d0: 7420 7768 6572 6520 6f72 6465 7220 6d61  t where order ma
+0005b6e0: 7474 6572 7320 616e 6420 796f 7520 7761  tters and you wa
+0005b6f0: 6e74 2069 7420 636f 6d70 6172 6564 2072  nt it compared r
+0005b700: 6f77 2d77 6973 650d 0a20 2020 2020 2020  ow-wise..       
+0005b710: 2023 2323 2020 2054 6869 7320 7465 6c6c   ###   This tell
+0005b720: 7320 796f 7520 686f 7720 6d61 6e79 206c  s you how many l
+0005b730: 6162 656c 7320 696e 2065 6163 6820 726f  abels in each ro
+0005b740: 7720 6469 6420 796f 7520 6765 7420 7269  w did you get ri
+0005b750: 6768 742e 2054 4861 7427 7320 6163 6375  ght. THat's accu
+0005b760: 7261 6379 2062 7920 726f 772e 0d0a 2020  racy by row...  
+0005b770: 2020 2020 2020 2323 2320 2020 4974 2077        ###   It w
+0005b780: 696c 6c20 7265 7475 726e 2061 7320 6d61  ill return as ma
+0005b790: 6e79 2074 6f74 616c 7320 6173 2074 6865  ny totals as the
+0005b7a0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+0005b7b0: 696e 2079 6f75 7220 6461 7461 2073 6574  in your data set
+0005b7c0: 2e0d 0a20 2020 2020 2020 2023 2323 2020  ...        ###  
+0005b7d0: 2054 6f20 6765 7420 6120 7065 7263 656e   To get a percen
+0005b7e0: 7461 6765 2c20 796f 7520 7769 6c6c 2068  tage, you will h
+0005b7f0: 6176 6520 746f 2064 6976 6964 6520 6974  ave to divide it
+0005b800: 2062 7920 7468 6520 6e75 6d62 6572 206f   by the number o
+0005b810: 6620 6c61 6265 6c73 2069 6e20 7468 6520  f labels in the 
+0005b820: 6461 7461 2073 6574 2e0d 0a20 2020 2020  data set...     
+0005b830: 2020 2023 2323 2020 2054 6869 7320 7065     ###   This pe
+0005b840: 7263 656e 7461 6765 2067 6976 6573 2079  rcentage gives y
+0005b850: 6f75 2074 6865 2025 206f 6620 6c61 6265  ou the % of labe
+0005b860: 6c73 2069 6e20 6561 6368 2072 6f77 2079  ls in each row y
+0005b870: 6f75 2067 6f74 2063 6f72 7265 6374 6c79  ou got correctly
+0005b880: 3d25 436f 6d62 696e 6564 5f4c 6162 656c  =%Combined_Label
+0005b890: 5f41 6363 7572 6163 790d 0a20 2020 2020  _Accuracy..     
+0005b8a0: 2020 2023 2323 2020 2054 6869 7320 7769     ###   This wi
+0005b8b0: 6c6c 2067 6976 6520 796f 7520 6120 7369  ll give you a si
+0005b8c0: 6e67 6c65 2070 6572 6365 6e74 6167 6520  ngle percentage 
+0005b8d0: 6e75 6d62 6572 2066 6f72 2074 6865 2077  number for the w
+0005b8e0: 686f 6c65 2064 6174 6120 7365 740d 0a20  hole data set.. 
+0005b8f0: 2020 2022 2222 0d0a 2020 2020 6966 2069     """..    if i
+0005b900: 7369 6e73 7461 6e63 6528 6c61 6265 6c2c  sinstance(label,
+0005b910: 206c 6973 7429 3a0d 0a20 2020 2020 2020   list):..       
+0005b920: 206c 6162 656c 203d 206e 702e 6172 7261   label = np.arra
+0005b930: 7928 6c61 6265 6c29 0d0a 2020 2020 6966  y(label)..    if
+0005b940: 2069 7369 6e73 7461 6e63 6528 7072 6564   isinstance(pred
+0005b950: 2c20 6c69 7374 293a 0d0a 2020 2020 2020  , list):..      
+0005b960: 2020 7072 6564 203d 206e 702e 6172 7261    pred = np.arra
+0005b970: 7928 7072 6564 290d 0a20 2020 2023 2323  y(pred)..    ###
+0005b980: 2054 6869 7320 6973 2066 6f72 204d 756c   This is for Mul
+0005b990: 7469 2d4c 6162 656c 2050 726f 626c 656d  ti-Label Problem
+0005b9a0: 7320 2323 2323 2320 5265 7475 726e 7320  s ##### Returns 
+0005b9b0: 3220 7265 7375 6c74 733a 206f 6e65 206e  2 results: one n
+0005b9c0: 756d 6265 7220 616e 640d 0a20 2020 2023  umber and..    #
+0005b9d0: 2323 2020 2020 7468 6520 7365 636f 6e64  ##    the second
+0005b9e0: 2069 7320 616e 2061 7272 6179 2077 6974   is an array wit
+0005b9f0: 6820 6173 206d 616e 7920 6974 656d 7320  h as many items 
+0005ba00: 6173 206e 756d 6265 7220 6f66 206c 6162  as number of lab
+0005ba10: 656c 7320 696e 2074 6172 6765 740d 0a20  els in target.. 
+0005ba20: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0005ba30: 206a 6163 635f 6461 7461 5f73 6574 203d   jacc_data_set =
+0005ba40: 206e 702e 7375 6d28 6c61 6265 6c3d 3d70   np.sum(label==p
+0005ba50: 7265 642c 6178 6973 3d31 292e 7375 6d28  red,axis=1).sum(
+0005ba60: 292f 6c61 6265 6c2e 7368 6170 655b 315d  )/label.shape[1]
+0005ba70: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0005ba80: 206a 6163 635f 6461 7461 5f73 6574 0d0a   jacc_data_set..
+0005ba90: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+0005baa0: 2020 2020 2072 6574 7572 6e20 300d 0a23       return 0..#
+0005bab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005bac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005bad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005bae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005baf0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0005bb00: 0a64 6566 2070 6c6f 745f 5253 5f70 6172  .def plot_RS_par
+0005bb10: 616d 7328 6376 5f72 6573 756c 7473 2c20  ams(cv_results, 
+0005bb20: 7363 6f72 652c 206d 6e61 6d65 293a 0d0a  score, mname):..
+0005bb30: 2020 2020 2222 220d 0a20 2020 2023 2323      """..    ###
+0005bb40: 2323 2323 2054 6869 7320 706c 6f74 7320  #### This plots 
+0005bb50: 7468 6520 4772 6964 5365 6172 6368 4356  the GridSearchCV
+0005bb60: 2052 6573 756c 7473 2073 656e 7420 696e   Results sent in
+0005bb70: 2023 2323 2323 2323 2323 2323 230d 0a20   ############.. 
+0005bb80: 2020 2022 2222 0d0a 2020 2020 6466 203d     """..    df =
+0005bb90: 2070 642e 4461 7461 4672 616d 6528 6376   pd.DataFrame(cv
+0005bba0: 5f72 6573 756c 7473 290d 0a20 2020 2070  _results)..    p
+0005bbb0: 6172 616d 7320 3d20 5b78 2066 6f72 2078  arams = [x for x
+0005bbc0: 2069 6e20 6c69 7374 2864 6629 2069 6620   in list(df) if 
+0005bbd0: 782e 7374 6172 7473 7769 7468 2827 7061  x.startswith('pa
+0005bbe0: 7261 6d5f 2729 5d0d 0a20 2020 2074 7261  ram_')]..    tra
+0005bbf0: 696e 636f 6c73 203d 205b 276d 6561 6e5f  incols = ['mean_
+0005bc00: 7472 6169 6e5f 7363 6f72 6527 205d 0d0a  train_score' ]..
+0005bc10: 2020 2020 7465 7374 636f 6c73 203d 205b      testcols = [
+0005bc20: 276d 6561 6e5f 7465 7374 5f73 636f 7265  'mean_test_score
+0005bc30: 2720 5d0d 0a20 2020 2063 6f6c 7320 3d20  ' ]..    cols = 
+0005bc40: 7472 6169 6e63 6f6c 732b 7465 7374 636f  traincols+testco
+0005bc50: 6c73 0d0a 2020 2020 6e63 6f6c 7320 3d20  ls..    ncols = 
+0005bc60: 320d 0a20 2020 206e 6f70 6c6f 7473 203d  2..    noplots =
+0005bc70: 206c 656e 2870 6172 616d 7329 0d0a 2020   len(params)..  
+0005bc80: 2020 6966 206e 6f70 6c6f 7473 256e 636f    if noplots%nco
+0005bc90: 6c73 203d 3d20 303a 0d0a 2020 2020 2020  ls == 0:..      
+0005bca0: 2020 726f 7773 203d 206e 6f70 6c6f 7473    rows = noplots
+0005bcb0: 2f6e 636f 6c73 0d0a 2020 2020 656c 7365  /ncols..    else
+0005bcc0: 3a0d 0a20 2020 2020 2020 2072 6f77 7320  :..        rows 
+0005bcd0: 3d20 286e 6f70 6c6f 7473 2f6e 636f 6c73  = (noplots/ncols
+0005bce0: 292b 310d 0a20 2020 2068 6569 6768 745f  )+1..    height_
+0005bcf0: 7369 7a65 203d 2035 0d0a 2020 2020 7769  size = 5..    wi
+0005bd00: 6474 685f 7369 7a65 203d 2031 350d 0a20  dth_size = 15.. 
+0005bd10: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
+0005bd20: 7572 6528 6669 6773 697a 653d 2877 6964  ure(figsize=(wid
+0005bd30: 7468 5f73 697a 652c 726f 7773 2a68 6569  th_size,rows*hei
+0005bd40: 6768 745f 7369 7a65 2929 0d0a 2020 2020  ght_size))..    
+0005bd50: 6669 672e 7375 7074 6974 6c65 2827 5472  fig.suptitle('Tr
+0005bd60: 6169 6e69 6e67 2061 6e64 2056 616c 6964  aining and Valid
+0005bd70: 6174 696f 6e3a 2048 7970 6572 2050 6172  ation: Hyper Par
+0005bd80: 616d 6574 6572 2054 756e 696e 6720 666f  ameter Tuning fo
+0005bd90: 7220 7461 7267 6574 3d25 7327 2025 6d6e  r target=%s' %mn
+0005bda0: 616d 652c 2066 6f6e 7473 697a 653d 3230  ame, fontsize=20
+0005bdb0: 2c79 3d31 2e30 3129 0d0a 2020 2020 2323  ,y=1.01)..    ##
+0005bdc0: 2323 2049 6620 7468 6520 7661 6c75 6573  ## If the values
+0005bdd0: 2061 7265 206e 6567 6174 6976 652c 2063   are negative, c
+0005bde0: 6f6e 7665 7274 2074 6865 6d20 746f 2070  onvert them to p
+0005bdf0: 6f73 6974 6976 6520 2323 2323 2323 2323  ositive ########
+0005be00: 2323 2323 0d0a 2020 2020 6966 206c 656e  ####..    if len
+0005be10: 2864 662e 6c6f 635b 6466 5b63 6f6c 735b  (df.loc[df[cols[
+0005be20: 305d 5d3c 305d 2920 3e20 303a 0d0a 2020  0]]<0]) > 0:..  
+0005be30: 2020 2020 2020 6466 5b63 6f6c 735d 203d        df[cols] =
+0005be40: 2064 665b 636f 6c73 5d2a 2d31 0d0a 2020   df[cols]*-1..  
+0005be50: 2020 666f 7220 6561 6368 5f70 6172 616d    for each_param
+0005be60: 2c20 636f 756e 7420 696e 207a 6970 2870  , count in zip(p
+0005be70: 6172 616d 732c 2072 616e 6765 286e 6f70  arams, range(nop
+0005be80: 6c6f 7473 2929 3a0d 0a20 2020 2020 2020  lots)):..       
+0005be90: 2070 6c74 2e73 7562 706c 6f74 2872 6f77   plt.subplot(row
+0005bea0: 732c 6e63 6f6c 732c 636f 756e 742b 3129  s,ncols,count+1)
+0005beb0: 0d0a 2020 2020 2020 2020 6178 3120 3d20  ..        ax1 = 
+0005bec0: 706c 742e 6763 6128 290d 0a20 2020 2020  plt.gca()..     
+0005bed0: 2020 2069 6620 6466 5b65 6163 685f 7061     if df[each_pa
+0005bee0: 7261 6d5d 2e64 7479 7065 2021 3d20 6f62  ram].dtype != ob
+0005bef0: 6a65 6374 3a0d 0a20 2020 2020 2020 2020  ject:..         
+0005bf00: 2020 2064 665b 5b65 6163 685f 7061 7261     df[[each_para
+0005bf10: 6d5d 2b63 6f6c 735d 2e67 726f 7570 6279  m]+cols].groupby
+0005bf20: 2865 6163 685f 7061 7261 6d29 2e6d 6561  (each_param).mea
+0005bf30: 6e28 292e 706c 6f74 286b 696e 643d 276c  n().plot(kind='l
+0005bf40: 696e 6527 2c0d 0a20 2020 2020 2020 2020  ine',..         
+0005bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005bf60: 2020 2074 6974 6c65 3d27 2573 2066 6f72     title='%s for
+0005bf70: 2025 7327 2025 2865 6163 685f 7061 7261   %s' %(each_para
+0005bf80: 6d2c 6d6e 616d 6529 2c61 783d 6178 3129  m,mname),ax=ax1)
+0005bf90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0005bfa0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+0005bfb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0005bfc0: 2020 2064 665b 6561 6368 5f70 6172 616d     df[each_param
+0005bfd0: 5d20 3d20 7064 2e74 6f5f 6e75 6d65 7269  ] = pd.to_numeri
+0005bfe0: 6328 6466 5b65 6163 685f 7061 7261 6d5d  c(df[each_param]
+0005bff0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0005c000: 2020 2064 665b 5b65 6163 685f 7061 7261     df[[each_para
+0005c010: 6d5d 2b63 6f6c 735d 2e67 726f 7570 6279  m]+cols].groupby
+0005c020: 2865 6163 685f 7061 7261 6d29 2e6d 6561  (each_param).mea
+0005c030: 6e28 292e 706c 6f74 286b 696e 643d 276c  n().plot(kind='l
+0005c040: 696e 6527 2c0d 0a20 2020 2020 2020 2020  ine',..         
+0005c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005c060: 2020 2074 6974 6c65 3d27 2573 2066 6f72     title='%s for
+0005c070: 2025 7327 2025 2865 6163 685f 7061 7261   %s' %(each_para
+0005c080: 6d2c 6d6e 616d 6529 2c20 6178 3d61 7831  m,mname), ax=ax1
+0005c090: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0005c0a0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0005c0b0: 2020 2020 2020 2020 6466 5b5b 6561 6368          df[[each
+0005c0c0: 5f70 6172 616d 5d2b 636f 6c73 5d2e 6772  _param]+cols].gr
+0005c0d0: 6f75 7062 7928 6561 6368 5f70 6172 616d  oupby(each_param
+0005c0e0: 292e 6d65 616e 2829 2e70 6c6f 7428 6b69  ).mean().plot(ki
+0005c0f0: 6e64 3d27 6261 7227 2c73 7461 636b 6564  nd='bar',stacked
+0005c100: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
+0005c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005c120: 2020 2020 2074 6974 6c65 3d27 2573 2066       title='%s f
+0005c130: 6f72 2025 7327 2025 2865 6163 685f 7061  or %s' %(each_pa
+0005c140: 7261 6d2c 6d6e 616d 6529 2c20 6178 3d61  ram,mname), ax=a
+0005c150: 7831 290d 0a20 2020 2023 2323 2320 5468  x1)..    #### Th
+0005c160: 6973 2069 7320 746f 2070 6c6f 7420 7468  is is to plot th
+0005c170: 6520 7465 7374 5f6d 6561 6e5f 7363 6f72  e test_mean_scor
+0005c180: 6520 6167 6169 6e73 7420 7061 7261 6d73  e against params
+0005c190: 2074 6f20 7365 6520 686f 7720 6974 2069   to see how it i
+0005c1a0: 6e63 7265 6173 6573 0d0a 2020 2020 666f  ncreases..    fo
+0005c1b0: 7220 6561 6368 5f70 6172 616d 2069 6e20  r each_param in 
+0005c1c0: 7061 7261 6d73 3a0d 0a20 2020 2020 2020  params:..       
+0005c1d0: 2023 2323 2320 5468 6973 2069 7320 746f   #### This is to
+0005c1e0: 2066 696e 6420 7768 6963 6820 7061 7261   find which para
+0005c1f0: 6d65 7465 7273 2061 7265 206e 6f6e 2073  meters are non s
+0005c200: 7472 696e 6720 616e 6420 636f 6e76 6572  tring and conver
+0005c210: 7420 7468 656d 2074 6f20 7374 7269 6e67  t them to string
+0005c220: 730d 0a20 2020 2020 2020 2069 6620 6466  s..        if df
+0005c230: 5b65 6163 685f 7061 7261 6d5d 2e64 7479  [each_param].dty
+0005c240: 7065 213d 6f62 6a65 6374 3a0d 0a20 2020  pe!=object:..   
+0005c250: 2020 2020 2020 2020 2020 2064 665b 6561             df[ea
+0005c260: 6368 5f70 6172 616d 5d20 3d20 6466 5b65  ch_param] = df[e
+0005c270: 6163 685f 7061 7261 6d5d 2e61 7374 7970  ach_param].astyp
+0005c280: 6528 7374 7229 0d0a 2020 2020 7472 793a  e(str)..    try:
+0005c290: 0d0a 2020 2020 2020 2020 6466 5b27 636f  ..        df['co
+0005c2a0: 6d62 696e 6564 5f70 6172 616d 6574 6572  mbined_parameter
+0005c2b0: 7327 5d20 3d20 6466 5b70 6172 616d 735d  s'] = df[params]
+0005c2c0: 2e61 7070 6c79 286c 616d 6264 6120 783a  .apply(lambda x:
+0005c2d0: 2027 5f5f 272e 6a6f 696e 2878 292c 2061   '__'.join(x), a
+0005c2e0: 7869 733d 3120 290d 0a20 2020 2065 7863  xis=1 )..    exc
+0005c2f0: 6570 743a 0d0a 2020 2020 2020 2020 6466  ept:..        df
+0005c300: 5b27 636f 6d62 696e 6564 5f70 6172 616d  ['combined_param
+0005c310: 6574 6572 7327 5d20 3d20 6466 5b70 6172  eters'] = df[par
+0005c320: 616d 735d 2e61 7070 6c79 286c 616d 6264  ams].apply(lambd
+0005c330: 6120 783a 2027 5f5f 272e 6a6f 696e 2878  a x: '__'.join(x
+0005c340: 2e6d 6170 2873 7472 2929 2c20 6178 6973  .map(str)), axis
+0005c350: 3d31 2029 0d0a 2020 2020 6966 206c 656e  =1 )..    if len
+0005c360: 2870 6172 616d 7329 203d 3d20 313a 0d0a  (params) == 1:..
+0005c370: 2020 2020 2020 2020 6466 5b27 636f 6d62          df['comb
+0005c380: 696e 6564 5f70 6172 616d 6574 6572 7327  ined_parameters'
+0005c390: 5d20 3d20 636f 7079 2e64 6565 7063 6f70  ] = copy.deepcop
+0005c3a0: 7928 6466 5b70 6172 616d 735d 290d 0a20  y(df[params]).. 
+0005c3b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0005c3c0: 2020 6466 5b5b 2763 6f6d 6269 6e65 645f    df[['combined_
+0005c3d0: 7061 7261 6d65 7465 7273 275d 2b63 6f6c  parameters']+col
+0005c3e0: 735d 2e67 726f 7570 6279 2827 636f 6d62  s].groupby('comb
+0005c3f0: 696e 6564 5f70 6172 616d 6574 6572 7327  ined_parameters'
+0005c400: 292e 6d65 616e 2829 2e73 6f72 745f 7661  ).mean().sort_va
+0005c410: 6c75 6573 280d 0a20 2020 2020 2020 2020  lues(..         
+0005c420: 2020 2063 6f6c 735b 315d 292e 706c 6f74     cols[1]).plot
+0005c430: 2866 6967 7369 7a65 3d28 7769 6474 685f  (figsize=(width_
+0005c440: 7369 7a65 2c68 6569 6768 745f 7369 7a65  size,height_size
+0005c450: 292c 6b69 6e64 3d27 6c69 6e65 272c 7375  ),kind='line',su
+0005c460: 6270 6c6f 7473 3d46 616c 7365 2c0d 0a20  bplots=False,.. 
+0005c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005c480: 2020 2020 2020 2020 2020 2074 6974 6c65             title
+0005c490: 3d27 436f 6d62 696e 6564 2050 6172 616d  ='Combined Param
+0005c4a0: 6574 6572 733a 2025 7320 7363 6f72 6573  eters: %s scores
+0005c4b0: 2066 6f72 2025 7327 2025 2873 636f 7265   for %s' %(score
+0005c4c0: 2c6d 6e61 6d65 2929 0d0a 2020 2020 706c  ,mname))..    pl
+0005c4d0: 742e 7874 6963 6b73 2872 6f74 6174 696f  t.xticks(rotatio
+0005c4e0: 6e3d 3435 290d 0a20 2020 2070 6c74 2e73  n=45)..    plt.s
+0005c4f0: 686f 7728 293b 0d0a 2020 2020 7265 7475  how();..    retu
+0005c500: 726e 2064 660d 0a23 2323 2323 2323 2323  rn df..#########
 0005c510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c540: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
-0005c550: 6b6c 6561 726e 2069 6d70 6f72 7420 6d65  klearn import me
-0005c560: 7472 6963 730d 0a69 6d70 6f72 7420 6d61  trics..import ma
-0005c570: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-0005c580: 6173 2070 6c74 0d0a 696d 706f 7274 2063  as plt..import c
-0005c590: 6f70 790d 0a69 6d70 6f72 7420 7064 620d  opy..import pdb.
-0005c5a0: 0a64 6566 2070 7269 6e74 5f63 6c61 7373  .def print_class
-0005c5b0: 6966 6963 6174 696f 6e5f 6d65 7472 6963  ification_metric
-0005c5c0: 7328 795f 7465 7374 2c20 795f 7072 6f62  s(y_test, y_prob
-0005c5d0: 732c 2070 726f 6261 5f66 6c61 673d 5472  s, proba_flag=Tr
-0005c5e0: 7565 293a 0d0a 2020 2020 2222 220d 0a20  ue):..    """.. 
-0005c5f0: 2020 2023 2323 2323 2323 2020 5365 6e64     #######  Send
-0005c600: 2069 6e20 7468 6520 6163 7475 616c 5f76   in the actual_v
-0005c610: 616c 7565 7320 616e 6420 7072 6564 6963  alues and predic
-0005c620: 7469 6f6e 5f70 726f 6261 6269 6c69 7469  tion_probabiliti
-0005c630: 6573 2066 6f72 2062 696e 6172 7920 636c  es for binary cl
-0005c640: 6173 7365 730d 0a20 2020 2054 6869 7320  asses..    This 
-0005c650: 7769 6c6c 2072 6574 7572 6e20 6261 636b  will return back
-0005c660: 206d 6574 7269 6373 2061 6e64 2070 7269   metrics and pri
-0005c670: 6e74 2074 6865 6d20 616c 6c20 696e 2061  nt them all in a
-0005c680: 206e 6561 7420 666f 726d 6174 0d0a 2020   neat format..  
-0005c690: 2020 2222 220d 0a20 2020 2079 5f74 6573    """..    y_tes
-0005c6a0: 7420 3d20 636f 7079 2e64 6565 7063 6f70  t = copy.deepcop
-0005c6b0: 7928 795f 7465 7374 290d 0a20 2020 206d  y(y_test)..    m
-0005c6c0: 756c 7469 5f6c 6162 656c 5f66 6c61 6720  ulti_label_flag 
-0005c6d0: 3d20 4661 6c73 650d 0a20 2020 206d 756c  = False..    mul
-0005c6e0: 7469 5f63 6c61 7373 5f66 6c61 6720 3d20  ti_class_flag = 
-0005c6f0: 4661 6c73 650d 0a20 2020 2074 7279 3a0d  False..    try:.
-0005c700: 0a20 2020 2020 2020 2069 6620 795f 7465  .        if y_te
-0005c710: 7374 2e73 6861 7065 5b31 5d20 3e20 303a  st.shape[1] > 0:
-0005c720: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
-0005c730: 6c74 695f 6c61 6265 6c5f 666c 6167 203d  lti_label_flag =
-0005c740: 2054 7275 650d 0a20 2020 2065 7863 6570   True..    excep
-0005c750: 743a 0d0a 2020 2020 2020 2020 7061 7373  t:..        pass
-0005c760: 0d0a 2020 2020 2323 2323 2323 2323 2054  ..    ######## T
-0005c770: 6869 7320 6973 2077 6865 7265 2079 6f75  his is where you
-0005c780: 2073 7461 7274 2070 7269 6e74 696e 6720   start printing 
-0005c790: 6d65 7472 6963 7320 2323 2323 2323 2323  metrics ########
-0005c7a0: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
-0005c7b0: 6c65 6e28 6e70 2e75 6e69 7175 6528 795f  len(np.unique(y_
-0005c7c0: 7465 7374 2929 203e 2032 3a0d 0a20 2020  test)) > 2:..   
-0005c7d0: 2020 2020 206d 756c 7469 5f63 6c61 7373       multi_class
-0005c7e0: 5f66 6c61 6720 3d20 5472 7565 0d0a 2020  _flag = True..  
-0005c7f0: 2020 2020 2020 7072 696e 7428 274d 756c        print('Mul
-0005c800: 7469 2043 6c61 7373 204d 6f64 656c 204d  ti Class Model M
-0005c810: 6574 7269 6373 2052 6570 6f72 7427 290d  etrics Report').
-0005c820: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0005c830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c860: 2323 2323 2327 290d 0a20 2020 2065 6c73  #####')..    els
-0005c870: 653a 0d0a 2020 2020 2020 2020 7072 696e  e:..        prin
-0005c880: 7428 2742 696e 6172 7920 436c 6173 7320  t('Binary Class 
-0005c890: 4d6f 6465 6c20 4d65 7472 6963 7320 5265  Model Metrics Re
-0005c8a0: 706f 7274 2729 0d0a 2020 2020 2020 2020  port')..        
-0005c8b0: 7072 696e 7428 2723 2323 2323 2323 2323  print('#########
-0005c8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c8e0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-0005c8f0: 2020 2020 2323 2323 2066 6f72 2073 6f6d      #### for som
-0005c900: 6520 6361 7365 732c 2079 6f75 2077 6f6e  e cases, you won
-0005c910: 2774 2067 6574 2070 726f 6261 2c20 736f  't get proba, so
-0005c920: 2063 6865 636b 2074 6865 2070 726f 6261   check the proba
-0005c930: 5f66 6c61 670d 0a20 2020 2069 6620 7072  _flag..    if pr
-0005c940: 6f62 615f 666c 6167 3a0d 0a20 2020 2020  oba_flag:..     
-0005c950: 2020 2069 6620 6d75 6c74 695f 6c61 6265     if multi_labe
-0005c960: 6c5f 666c 6167 3a0d 0a20 2020 2020 2020  l_flag:..       
-0005c970: 2020 2020 2079 5f70 7265 6473 203d 2028       y_preds = (
-0005c980: 795f 7072 6f62 733e 302e 3529 2e61 7374  y_probs>0.5).ast
-0005c990: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
-0005c9a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0005c9b0: 2020 2020 2079 5f70 7265 6473 203d 2079       y_preds = y
-0005c9c0: 5f70 726f 6273 2e61 7267 6d61 7828 6178  _probs.argmax(ax
-0005c9d0: 6973 3d31 290d 0a20 2020 2065 6c73 653a  is=1)..    else:
-0005c9e0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
-0005c9f0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-0005ca00: 7928 795f 7072 6f62 7329 0d0a 2020 2020  y(y_probs)..    
-0005ca10: 6966 206e 6f74 206d 756c 7469 5f63 6c61  if not multi_cla
-0005ca20: 7373 5f66 6c61 6720 2061 6e64 206e 6f74  ss_flag  and not
-0005ca30: 206d 756c 7469 5f6c 6162 656c 5f66 6c61   multi_label_fla
-0005ca40: 673a 0d0a 2020 2020 2020 2020 2320 4361  g:..        # Ca
-0005ca50: 6c63 756c 6174 6520 636f 6d70 6172 6973  lculate comparis
-0005ca60: 6f6e 206d 6574 7269 6373 2066 6f72 2042  on metrics for B
-0005ca70: 696e 6172 7920 636c 6173 7369 6669 6361  inary classifica
-0005ca80: 7469 6f6e 2072 6573 756c 7473 2e0d 0a20  tion results... 
-0005ca90: 2020 2020 2020 2061 6363 7572 6163 7920         accuracy 
-0005caa0: 3d20 6d65 7472 6963 732e 6163 6375 7261  = metrics.accura
-0005cab0: 6379 5f73 636f 7265 2879 5f74 6573 742c  cy_score(y_test,
-0005cac0: 2079 5f70 7265 6473 290d 0a20 2020 2020   y_preds)..     
-0005cad0: 2020 2062 616c 616e 6365 645f 6163 6375     balanced_accu
-0005cae0: 7261 6379 203d 206d 6574 7269 6373 2e62  racy = metrics.b
-0005caf0: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-0005cb00: 5f73 636f 7265 2879 5f74 6573 742c 2079  _score(y_test, y
-0005cb10: 5f70 7265 6473 290d 0a20 2020 2020 2020  _preds)..       
-0005cb20: 2070 7265 6369 7369 6f6e 203d 206d 6574   precision = met
-0005cb30: 7269 6373 2e70 7265 6369 7369 6f6e 5f73  rics.precision_s
-0005cb40: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
-0005cb50: 7265 6473 290d 0a20 2020 2020 2020 2066  reds)..        f
-0005cb60: 315f 7363 6f72 6520 3d20 6d65 7472 6963  1_score = metric
-0005cb70: 732e 6631 5f73 636f 7265 2879 5f74 6573  s.f1_score(y_tes
-0005cb80: 742c 2079 5f70 7265 6473 290d 0a20 2020  t, y_preds)..   
-0005cb90: 2020 2020 2072 6563 616c 6c20 3d20 6d65       recall = me
-0005cba0: 7472 6963 732e 7265 6361 6c6c 5f73 636f  trics.recall_sco
-0005cbb0: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
-0005cbc0: 6473 290d 0a20 2020 2020 2020 2069 6620  ds)..        if 
-0005cbd0: 7479 7065 286e 702e 6d65 616e 2828 795f  type(np.mean((y_
-0005cbe0: 7465 7374 3d3d 795f 7072 6564 7329 2929  test==y_preds)))
-0005cbf0: 203d 3d20 7064 2e53 6572 6965 733a 0d0a   == pd.Series:..
-0005cc00: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0005cc10: 7428 2720 2020 2041 6363 7572 6163 7920  t('    Accuracy 
-0005cc20: 2020 2020 2020 2020 203d 2025 302e 3166           = %0.1f
-0005cc30: 2525 2720 2528 6e70 2e6d 6561 6e28 6163  %%' %(np.mean(ac
-0005cc40: 6375 7261 6379 292a 3130 3029 290d 0a20  curacy)*100)).. 
-0005cc50: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0005cc60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005cc70: 2720 2020 2041 6363 7572 6163 7920 2020  '    Accuracy   
-0005cc80: 2020 2020 2020 203d 2025 302e 3166 2525         = %0.1f%%
-0005cc90: 2720 2528 6163 6375 7261 6379 2a31 3030  ' %(accuracy*100
-0005cca0: 2929 0d0a 2020 2020 2020 2020 7072 696e  ))..        prin
-0005ccb0: 7428 2720 2020 2042 616c 616e 6365 6420  t('    Balanced 
-0005ccc0: 4163 6375 7261 6379 203d 2025 302e 3166  Accuracy = %0.1f
-0005ccd0: 2525 2720 2528 6261 6c61 6e63 6564 5f61  %%' %(balanced_a
-0005cce0: 6363 7572 6163 792a 3130 3029 290d 0a20  ccuracy*100)).. 
-0005ccf0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005cd00: 2020 5072 6563 6973 696f 6e20 2020 2020    Precision     
-0005cd10: 2020 2020 3d20 2530 2e31 6625 2527 2025      = %0.1f%%' %
-0005cd20: 2870 7265 6369 7369 6f6e 2a31 3030 2929  (precision*100))
-0005cd30: 0d0a 2020 2020 2020 2020 6966 2070 726f  ..        if pro
-0005cd40: 6261 5f66 6c61 673a 0d0a 2020 2020 2020  ba_flag:..      
-0005cd50: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
-0005cd60: 6563 6973 696f 6e20 3d20 6e70 2e6d 6561  ecision = np.mea
-0005cd70: 6e28 6d65 7472 6963 732e 7072 6563 6973  n(metrics.precis
-0005cd80: 696f 6e5f 7363 6f72 6528 795f 7465 7374  ion_score(y_test
-0005cd90: 2c20 795f 7072 6564 732c 2061 7665 7261  , y_preds, avera
-0005cda0: 6765 3d4e 6f6e 6529 290d 0a20 2020 2020  ge=None))..     
-0005cdb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0005cdc0: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
-0005cdd0: 6563 6973 696f 6e20 3d20 6d65 7472 6963  ecision = metric
-0005cde0: 732e 7072 6563 6973 696f 6e5f 7363 6f72  s.precision_scor
-0005cdf0: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
-0005ce00: 732c 2061 7665 7261 6765 3d27 6d61 6372  s, average='macr
-0005ce10: 6f27 290d 0a20 2020 2020 2020 2070 7269  o')..        pri
-0005ce20: 6e74 2827 2020 2020 4176 6572 6167 6520  nt('    Average 
-0005ce30: 5072 6563 6973 696f 6e20 3d20 2530 2e31  Precision = %0.1
-0005ce40: 6625 2527 2025 2861 7665 7261 6765 5f70  f%%' %(average_p
-0005ce50: 7265 6369 7369 6f6e 2a31 3030 2929 0d0a  recision*100))..
-0005ce60: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0005ce70: 2020 2052 6563 616c 6c20 2020 2020 2020     Recall       
-0005ce80: 2020 2020 203d 2025 302e 3166 2525 2720       = %0.1f%%' 
-0005ce90: 2528 7265 6361 6c6c 2a31 3030 2929 0d0a  %(recall*100))..
-0005cea0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0005ceb0: 2020 2046 3120 5363 6f72 6520 2020 2020     F1 Score     
-0005cec0: 2020 2020 203d 2025 302e 3166 2525 2720       = %0.1f%%' 
-0005ced0: 2528 6631 5f73 636f 7265 2a31 3030 2929  %(f1_score*100))
-0005cee0: 0d0a 2020 2020 2020 2020 6966 2070 726f  ..        if pro
-0005cef0: 6261 5f66 6c61 673a 0d0a 2020 2020 2020  ba_flag:..      
-0005cf00: 2020 2020 2020 6670 722c 2074 7072 2c20        fpr, tpr, 
-0005cf10: 7468 7265 7368 6f6c 6420 3d20 6d65 7472  threshold = metr
-0005cf20: 6963 732e 726f 635f 6375 7276 6528 795f  ics.roc_curve(y_
-0005cf30: 7465 7374 2c20 795f 7072 6f62 735b 3a2c  test, y_probs[:,
-0005cf40: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-0005cf50: 2072 6f63 5f61 7563 203d 206d 6574 7269   roc_auc = metri
-0005cf60: 6373 2e61 7563 2866 7072 2c20 7470 7229  cs.auc(fpr, tpr)
-0005cf70: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0005cf80: 696e 7428 2720 2020 2052 4f43 2041 5543  int('    ROC AUC
-0005cf90: 2020 2020 2020 2020 2020 203d 2025 302e             = %0.
-0005cfa0: 3166 2525 2720 2528 726f 635f 6175 632a  1f%%' %(roc_auc*
-0005cfb0: 3130 3029 290d 0a20 2020 2020 2020 2065  100))..        e
-0005cfc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0005cfd0: 2020 726f 635f 6175 6320 3d20 300d 0a20    roc_auc = 0.. 
-0005cfe0: 2020 2020 2020 2070 7269 6e74 2827 2323         print('##
-0005cff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d020: 2323 2327 290d 0a20 2020 2020 2020 2072  ###')..        r
-0005d030: 6574 7572 6e20 5b61 6363 7572 6163 792c  eturn [accuracy,
-0005d040: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
-0005d050: 6379 2c20 7072 6563 6973 696f 6e2c 2061  cy, precision, a
-0005d060: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
-0005d070: 2c20 6631 5f73 636f 7265 2c20 7265 6361  , f1_score, reca
-0005d080: 6c6c 2c20 726f 635f 6175 635d 0d0a 2020  ll, roc_auc]..  
-0005d090: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0005d0a0: 2023 2043 616c 6375 6c61 7465 2063 6f6d   # Calculate com
-0005d0b0: 7061 7269 736f 6e20 6d65 7472 6963 7320  parison metrics 
-0005d0c0: 666f 7220 4d75 6c74 692d 436c 6173 7320  for Multi-Class 
-0005d0d0: 636c 6173 7369 6669 6361 7469 6f6e 2072  classification r
-0005d0e0: 6573 756c 7473 2e0d 0a20 2020 2020 2020  esults...       
-0005d0f0: 2061 6363 7572 6163 7920 3d20 6e70 2e6d   accuracy = np.m
-0005d100: 6561 6e28 2879 5f74 6573 743d 3d79 5f70  ean((y_test==y_p
-0005d110: 7265 6473 2929 0d0a 2020 2020 2020 2020  reds))..        
-0005d120: 6966 206d 756c 7469 5f6c 6162 656c 5f66  if multi_label_f
-0005d130: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
-0005d140: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-0005d150: 2879 5f74 6573 742e 7368 6170 655b 315d  (y_test.shape[1]
-0005d160: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0005d170: 2020 2020 7072 696e 7428 2746 6f72 2074      print('For t
-0005d180: 6172 6765 7420 6c61 6265 6c3a 2025 7327  arget label: %s'
-0005d190: 2025 6929 0d0a 2020 2020 2020 2020 2020   %i)..          
-0005d1a0: 2020 2020 2020 6261 6c61 6e63 6564 5f61        balanced_a
-0005d1b0: 6363 7572 6163 7920 3d20 6e70 2e6d 6561  ccuracy = np.mea
-0005d1c0: 6e28 6d65 7472 6963 732e 7265 6361 6c6c  n(metrics.recall
-0005d1d0: 5f73 636f 7265 2879 5f74 6573 745b 3a2c  _score(y_test[:,
-0005d1e0: 695d 2c20 795f 7072 6564 735b 3a2c 695d  i], y_preds[:,i]
-0005d1f0: 2c20 6176 6572 6167 653d 4e6f 6e65 2929  , average=None))
-0005d200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0005d210: 2020 7072 6563 6973 696f 6e20 3d20 6d65    precision = me
-0005d220: 7472 6963 732e 7072 6563 6973 696f 6e5f  trics.precision_
-0005d230: 7363 6f72 6528 795f 7465 7374 5b3a 2c69  score(y_test[:,i
-0005d240: 5d2c 2079 5f70 7265 6473 5b3a 2c69 5d2c  ], y_preds[:,i],
-0005d250: 2061 7665 7261 6765 3d4e 6f6e 6529 0d0a   average=None)..
-0005d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005d270: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
-0005d280: 6e20 3d20 6d65 7472 6963 732e 7072 6563  n = metrics.prec
-0005d290: 6973 696f 6e5f 7363 6f72 6528 795f 7465  ision_score(y_te
-0005d2a0: 7374 5b3a 2c69 5d2c 2079 5f70 7265 6473  st[:,i], y_preds
-0005d2b0: 5b3a 2c69 5d2c 2061 7665 7261 6765 3d27  [:,i], average='
-0005d2c0: 6d61 6372 6f27 290d 0a20 2020 2020 2020  macro')..       
-0005d2d0: 2020 2020 2020 2020 2066 315f 7363 6f72           f1_scor
-0005d2e0: 6520 3d20 6d65 7472 6963 732e 6631 5f73  e = metrics.f1_s
-0005d2f0: 636f 7265 2879 5f74 6573 745b 3a2c 695d  core(y_test[:,i]
-0005d300: 2c20 795f 7072 6564 735b 3a2c 695d 2c20  , y_preds[:,i], 
-0005d310: 6176 6572 6167 653d 4e6f 6e65 290d 0a20  average=None).. 
-0005d320: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0005d330: 6563 616c 6c20 3d20 6d65 7472 6963 732e  ecall = metrics.
-0005d340: 7265 6361 6c6c 5f73 636f 7265 2879 5f74  recall_score(y_t
-0005d350: 6573 745b 3a2c 695d 2c20 795f 7072 6564  est[:,i], y_pred
-0005d360: 735b 3a2c 695d 2c20 6176 6572 6167 653d  s[:,i], average=
-0005d370: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
-0005d380: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005d390: 2020 4261 6c61 6e63 6564 2041 6363 7572    Balanced Accur
-0005d3a0: 6163 7920 2861 7665 7261 6765 2072 6563  acy (average rec
-0005d3b0: 616c 6c29 203d 2025 302e 3166 2525 2720  all) = %0.1f%%' 
-0005d3c0: 2528 6261 6c61 6e63 6564 5f61 6363 7572  %(balanced_accur
-0005d3d0: 6163 792a 3130 3029 290d 0a20 2020 2020  acy*100))..     
-0005d3e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0005d3f0: 2827 2020 2020 4176 6572 6167 6520 5072  ('    Average Pr
-0005d400: 6563 6973 696f 6e20 286d 6163 726f 2920  ecision (macro) 
-0005d410: 3d20 2530 2e31 6625 2527 2025 2861 7665  = %0.1f%%' %(ave
-0005d420: 7261 6765 5f70 7265 6369 7369 6f6e 2a31  rage_precision*1
-0005d430: 3030 2929 0d0a 2020 2020 2020 2020 2020  00))..          
-0005d440: 2020 2020 2020 2323 2320 7468 6573 6520        ### these 
-0005d450: 6172 6520 6261 7369 6361 6c6c 7920 6f6e  are basically on
-0005d460: 6520 666f 7220 6561 6368 2063 6c61 7373  e for each class
-0005d470: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
-0005d480: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0005d490: 2020 2050 7265 6369 7369 6f6e 7320 6279     Precisions by
-0005d4a0: 2063 6c61 7373 3a27 290d 0a20 2020 2020   class:')..     
-0005d4b0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0005d4c0: 7265 6369 7369 6f6e 7320 696e 2070 7265  recisions in pre
-0005d4d0: 6369 7369 6f6e 3a0d 0a20 2020 2020 2020  cision:..       
-0005d4e0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0005d4f0: 6e74 2827 2020 2020 2530 2e31 6625 2520  nt('    %0.1f%% 
-0005d500: 2027 2025 2870 7265 6369 7369 6f6e 732a   ' %(precisions*
-0005d510: 3130 3029 2c65 6e64 3d22 2229 0d0a 2020  100),end="")..  
-0005d520: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0005d530: 696e 7428 275c 6e20 2020 2052 6563 616c  int('\n    Recal
-0005d540: 6c20 5363 6f72 6573 2062 7920 636c 6173  l Scores by clas
-0005d550: 733a 2729 0d0a 2020 2020 2020 2020 2020  s:')..          
-0005d560: 2020 2020 2020 666f 7220 7265 6361 6c6c        for recall
-0005d570: 7320 696e 2072 6563 616c 6c3a 0d0a 2020  s in recall:..  
-0005d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005d590: 2020 7072 696e 7428 2720 2020 2025 302e    print('    %0.
-0005d5a0: 3166 2525 2020 2720 2528 7265 6361 6c6c  1f%%  ' %(recall
-0005d5b0: 732a 3130 3029 2c20 656e 643d 2222 290d  s*100), end="").
-0005d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0005d5d0: 2070 7269 6e74 2827 5c6e 2020 2020 4631   print('\n    F1
-0005d5e0: 2053 636f 7265 7320 6279 2063 6c61 7373   Scores by class
-0005d5f0: 3a27 290d 0a20 2020 2020 2020 2020 2020  :')..           
-0005d600: 2020 2020 2066 6f72 2066 315f 7363 6f72       for f1_scor
-0005d610: 6573 2069 6e20 6631 5f73 636f 7265 3a0d  es in f1_score:.
-0005d620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0005d630: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0005d640: 2530 2e31 6625 2520 2027 2025 2866 315f  %0.1f%%  ' %(f1_
-0005d650: 7363 6f72 6573 2a31 3030 292c 656e 643d  scores*100),end=
-0005d660: 2222 290d 0a20 2020 2020 2020 2020 2020  "")..           
-0005d670: 2020 2020 2070 7269 6e74 2827 5c6e 2323       print('\n##
-0005d680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d6a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d6b0: 2323 2327 290d 0a20 2020 2020 2020 2065  ###')..        e
-0005d6c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0005d6d0: 2020 6261 6c61 6e63 6564 5f61 6363 7572    balanced_accur
-0005d6e0: 6163 7920 3d20 6d65 7472 6963 732e 6261  acy = metrics.ba
-0005d6f0: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-0005d700: 7363 6f72 6528 795f 7465 7374 2c20 795f  score(y_test, y_
-0005d710: 7072 6564 7329 0d0a 2020 2020 2020 2020  preds)..        
-0005d720: 2020 2020 7072 6563 6973 696f 6e20 3d20      precision = 
-0005d730: 6d65 7472 6963 732e 7072 6563 6973 696f  metrics.precisio
-0005d740: 6e5f 7363 6f72 6528 795f 7465 7374 2c20  n_score(y_test, 
-0005d750: 795f 7072 6564 732c 2061 7665 7261 6765  y_preds, average
-0005d760: 203d 204e 6f6e 6529 0d0a 2020 2020 2020   = None)..      
-0005d770: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
-0005d780: 6563 6973 696f 6e20 3d20 6d65 7472 6963  ecision = metric
-0005d790: 732e 7072 6563 6973 696f 6e5f 7363 6f72  s.precision_scor
-0005d7a0: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
-0005d7b0: 732c 6176 6572 6167 653d 276d 6163 726f  s,average='macro
-0005d7c0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0005d7d0: 6631 5f73 636f 7265 203d 206d 6574 7269  f1_score = metri
-0005d7e0: 6373 2e66 315f 7363 6f72 6528 795f 7465  cs.f1_score(y_te
-0005d7f0: 7374 2c20 795f 7072 6564 732c 2061 7665  st, y_preds, ave
-0005d800: 7261 6765 203d 204e 6f6e 6529 0d0a 2020  rage = None)..  
-0005d810: 2020 2020 2020 2020 2020 7265 6361 6c6c            recall
-0005d820: 203d 206d 6574 7269 6373 2e72 6563 616c   = metrics.recal
-0005d830: 6c5f 7363 6f72 6528 795f 7465 7374 2c20  l_score(y_test, 
-0005d840: 795f 7072 6564 732c 2061 7665 7261 6765  y_preds, average
-0005d850: 203d 204e 6f6e 6529 0d0a 2020 2020 2020   = None)..      
-0005d860: 2020 2020 2020 6966 2074 7970 6528 6e70        if type(np
-0005d870: 2e6d 6561 6e28 2879 5f74 6573 743d 3d79  .mean((y_test==y
-0005d880: 5f70 7265 6473 2929 2920 3d3d 2070 642e  _preds))) == pd.
-0005d890: 5365 7269 6573 3a0d 0a20 2020 2020 2020  Series:..       
-0005d8a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0005d8b0: 2020 2020 4163 6375 7261 6379 2020 2020      Accuracy    
-0005d8c0: 2020 2020 2020 3d20 2530 2e31 6625 2527        = %0.1f%%'
-0005d8d0: 2025 286e 702e 6d65 616e 2861 6363 7572   %(np.mean(accur
-0005d8e0: 6163 7929 2a31 3030 2929 0d0a 2020 2020  acy)*100))..    
-0005d8f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0005d900: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0005d910: 7269 6e74 2827 2020 2020 4163 6375 7261  rint('    Accura
-0005d920: 6379 2020 2020 2020 2020 2020 3d20 2530  cy          = %0
-0005d930: 2e31 6625 2527 2025 2861 6363 7572 6163  .1f%%' %(accurac
-0005d940: 792a 3130 3029 290d 0a20 2020 2020 2020  y*100))..       
-0005d950: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0005d960: 4261 6c61 6e63 6564 2041 6363 7572 6163  Balanced Accurac
-0005d970: 7920 2861 7665 7261 6765 2072 6563 616c  y (average recal
-0005d980: 6c29 203d 2025 302e 3166 2525 2720 2528  l) = %0.1f%%' %(
-0005d990: 6261 6c61 6e63 6564 5f61 6363 7572 6163  balanced_accurac
-0005d9a0: 792a 3130 3029 290d 0a20 2020 2020 2020  y*100))..       
-0005d9b0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0005d9c0: 4176 6572 6167 6520 5072 6563 6973 696f  Average Precisio
-0005d9d0: 6e20 286d 6163 726f 2920 3d20 2530 2e31  n (macro) = %0.1
-0005d9e0: 6625 2527 2025 2861 7665 7261 6765 5f70  f%%' %(average_p
-0005d9f0: 7265 6369 7369 6f6e 2a31 3030 2929 0d0a  recision*100))..
-0005da00: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0005da10: 7468 6573 6520 6172 6520 6261 7369 6361  these are basica
-0005da20: 6c6c 7920 6f6e 6520 666f 7220 6561 6368  lly one for each
-0005da30: 2063 6c61 7373 2023 2323 2323 0d0a 2020   class #####..  
-0005da40: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005da50: 2720 2020 2050 7265 6369 7369 6f6e 7320  '    Precisions 
-0005da60: 6279 2063 6c61 7373 3a27 290d 0a20 2020  by class:')..   
-0005da70: 2020 2020 2020 2020 2066 6f72 2070 7265           for pre
-0005da80: 6369 7369 6f6e 7320 696e 2070 7265 6369  cisions in preci
-0005da90: 7369 6f6e 3a0d 0a20 2020 2020 2020 2020  sion:..         
-0005daa0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005dab0: 2020 2530 2e31 6625 2520 2027 2025 2870    %0.1f%%  ' %(p
-0005dac0: 7265 6369 7369 6f6e 732a 3130 3029 2c65  recisions*100),e
-0005dad0: 6e64 3d22 2229 0d0a 2020 2020 2020 2020  nd="")..        
-0005dae0: 2020 2020 7072 696e 7428 275c 6e20 2020      print('\n   
-0005daf0: 2052 6563 616c 6c20 5363 6f72 6573 2062   Recall Scores b
-0005db00: 7920 636c 6173 733a 2729 0d0a 2020 2020  y class:')..    
-0005db10: 2020 2020 2020 2020 666f 7220 7265 6361          for reca
-0005db20: 6c6c 7320 696e 2072 6563 616c 6c3a 0d0a  lls in recall:..
-0005db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005db40: 7072 696e 7428 2720 2020 2025 302e 3166  print('    %0.1f
-0005db50: 2525 2020 2720 2528 7265 6361 6c6c 732a  %%  ' %(recalls*
-0005db60: 3130 3029 2c20 656e 643d 2222 290d 0a20  100), end="").. 
-0005db70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0005db80: 2827 5c6e 2020 2020 4631 2053 636f 7265  ('\n    F1 Score
-0005db90: 7320 6279 2063 6c61 7373 3a27 290d 0a20  s by class:').. 
-0005dba0: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-0005dbb0: 315f 7363 6f72 6573 2069 6e20 6631 5f73  1_scores in f1_s
-0005dbc0: 636f 7265 3a0d 0a20 2020 2020 2020 2020  core:..         
-0005dbd0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005dbe0: 2020 2530 2e31 6625 2520 2027 2025 2866    %0.1f%%  ' %(f
-0005dbf0: 315f 7363 6f72 6573 2a31 3030 292c 656e  1_scores*100),en
-0005dc00: 643d 2222 290d 0a20 2020 2020 2020 2020  d="")..         
-0005dc10: 2020 2023 2052 6574 7572 6e20 6c69 7374     # Return list
-0005dc20: 206f 6620 6d65 7472 6963 7320 746f 2062   of metrics to b
-0005dc30: 6520 6164 6465 6420 746f 2061 2044 6174  e added to a Dat
-0005dc40: 6166 7261 6d65 2074 6f20 636f 6d70 6172  aframe to compar
-0005dc50: 6520 6d6f 6465 6c73 2e0d 0a20 2020 2020  e models...     
-0005dc60: 2020 2020 2020 2070 7269 6e74 2827 5c6e         print('\n
-0005dc70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dc80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dc90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dca0: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
-0005dcb0: 2072 6574 7572 6e20 5b61 6363 7572 6163   return [accurac
-0005dcc0: 792c 2062 616c 616e 6365 645f 6163 6375  y, balanced_accu
-0005dcd0: 7261 6379 2c20 7072 6563 6973 696f 6e2c  racy, precision,
-0005dce0: 2061 7665 7261 6765 5f70 7265 6369 7369   average_precisi
-0005dcf0: 6f6e 2c20 6631 5f73 636f 7265 2c20 7265  on, f1_score, re
-0005dd00: 6361 6c6c 2c20 305d 0d0a 2323 2323 2323  call, 0]..######
-0005dd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd60: 2323 2323 2323 2323 2323 2323 0d0a 2323  ############..##
-0005dd70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dda0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ddb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ddc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ddd0: 0d0a 6465 6620 6c65 6674 5f73 7562 7472  ..def left_subtr
-0005dde0: 6163 7428 6c31 2c6c 3229 3a0d 0a20 2020  act(l1,l2):..   
-0005ddf0: 206c 7374 203d 205b 5d0d 0a20 2020 2066   lst = []..    f
-0005de00: 6f72 2069 2069 6e20 6c31 3a0d 0a20 2020  or i in l1:..   
-0005de10: 2020 2020 2069 6620 6920 6e6f 7420 696e       if i not in
-0005de20: 206c 323a 0d0a 2020 2020 2020 2020 2020   l2:..          
-0005de30: 2020 6c73 742e 6170 7065 6e64 2869 290d    lst.append(i).
-0005de40: 0a20 2020 2072 6574 7572 6e20 6c73 740d  .    return lst.
-0005de50: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0005de60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005de70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005de80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005de90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dea0: 230d 0a66 726f 6d20 636f 6c6c 6563 7469  #..from collecti
-0005deb0: 6f6e 7320 696d 706f 7274 2043 6f75 6e74  ons import Count
-0005dec0: 6572 0d0a 696d 706f 7274 2074 696d 650d  er..import time.
-0005ded0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6665  .from sklearn.fe
-0005dee0: 6174 7572 655f 7365 6c65 6374 696f 6e20  ature_selection 
-0005def0: 696d 706f 7274 2063 6869 322c 206d 7574  import chi2, mut
-0005df00: 7561 6c5f 696e 666f 5f72 6567 7265 7373  ual_info_regress
-0005df10: 696f 6e2c 206d 7574 7561 6c5f 696e 666f  ion, mutual_info
-0005df20: 5f63 6c61 7373 6966 0d0a 6672 6f6d 2073  _classif..from s
-0005df30: 6b6c 6561 726e 2e66 6561 7475 7265 5f73  klearn.feature_s
-0005df40: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-0005df50: 5365 6c65 6374 4b42 6573 740d 0a23 2323  SelectKBest..###
-0005df60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005df70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005df80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005df90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dfa0: 2323 2323 2323 2323 2323 2323 230d 0a66  #############..f
-0005dfb0: 726f 6d20 636f 6c6c 6563 7469 6f6e 7320  rom collections 
-0005dfc0: 696d 706f 7274 2064 6566 6175 6c74 6469  import defaultdi
-0005dfd0: 6374 0d0a 6672 6f6d 2063 6f6c 6c65 6374  ct..from collect
-0005dfe0: 696f 6e73 2069 6d70 6f72 7420 4f72 6465  ions import Orde
-0005dff0: 7265 6444 6963 740d 0a69 6d70 6f72 7420  redDict..import 
-0005e000: 7469 6d65 0d0a 6465 6620 7265 7475 726e  time..def return
-0005e010: 5f64 6963 7469 6f6e 6172 795f 6c69 7374  _dictionary_list
-0005e020: 286c 7374 5f6f 665f 7475 706c 6573 293a  (lst_of_tuples):
-0005e030: 0d0a 2020 2020 2222 2220 5265 7475 726e  ..    """ Return
-0005e040: 7320 6120 6469 6374 696f 6e61 7279 206f  s a dictionary o
-0005e050: 6620 6c69 7374 7320 6966 2079 6f75 2073  f lists if you s
-0005e060: 656e 6420 696e 2061 206c 6973 7420 6f66  end in a list of
-0005e070: 2054 7570 6c65 7322 2222 0d0a 2020 2020   Tuples"""..    
-0005e080: 6f72 4469 6374 203d 2064 6566 6175 6c74  orDict = default
-0005e090: 6469 6374 286c 6973 7429 0d0a 2020 2020  dict(list)..    
-0005e0a0: 2320 6974 6572 6174 696e 6720 6f76 6572  # iterating over
-0005e0b0: 206c 6973 7420 6f66 2074 7570 6c65 730d   list of tuples.
-0005e0c0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
-0005e0d0: 6c20 696e 206c 7374 5f6f 665f 7475 706c  l in lst_of_tupl
-0005e0e0: 6573 3a0d 0a20 2020 2020 2020 206f 7244  es:..        orD
-0005e0f0: 6963 745b 6b65 795d 2e61 7070 656e 6428  ict[key].append(
-0005e100: 7661 6c29 0d0a 2020 2020 7265 7475 726e  val)..    return
-0005e110: 206f 7244 6963 740d 0a23 2323 2323 2323   orDict..#######
-0005e120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e160: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-0005e170: 2072 656d 6f76 655f 7661 7269 6162 6c65   remove_variable
-0005e180: 735f 7573 696e 675f 6661 7374 5f63 6f72  s_using_fast_cor
-0005e190: 7265 6c61 7469 6f6e 2864 662c 206e 756d  relation(df, num
-0005e1a0: 7661 7273 2c20 6d6f 6465 6c74 7970 652c  vars, modeltype,
-0005e1b0: 2074 6172 6765 742c 0d0a 2020 2020 2020   target,..      
-0005e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005e1d0: 2020 2020 2020 2020 2020 636f 7272 5f6c            corr_l
-0005e1e0: 696d 6974 203d 2030 2e37 302c 7665 7262  imit = 0.70,verb
-0005e1f0: 6f73 653d 3029 3a0d 0a20 2020 2022 2222  ose=0):..    """
-0005e200: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-0005e210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005c540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005c550: 2323 2323 2323 230d 0a64 6566 2070 6c6f  #######..def plo
+0005c560: 745f 7867 625f 6d65 7472 6963 7328 6d6f  t_xgb_metrics(mo
+0005c570: 6465 6c2c 6576 616c 5f6d 6574 7269 632c  del,eval_metric,
+0005c580: 6576 616c 5f73 6574 2c6d 6f64 656c 7479  eval_set,modelty
+0005c590: 7065 2c6d 6f64 656c 5f6c 6162 656c 3d27  pe,model_label='
+0005c5a0: 272c 6d6f 6465 6c5f 6e61 6d65 3d22 2229  ',model_name="")
+0005c5b0: 3a0d 0a20 2020 2068 6569 6768 745f 7369  :..    height_si
+0005c5c0: 7a65 203d 2035 0d0a 2020 2020 7769 6474  ze = 5..    widt
+0005c5d0: 685f 7369 7a65 203d 2031 300d 0a20 2020  h_size = 10..   
+0005c5e0: 2069 6620 6d6f 6465 6c5f 6e61 6d65 2e6c   if model_name.l
+0005c5f0: 6f77 6572 2829 203d 3d20 2763 6174 626f  ower() == 'catbo
+0005c600: 6f73 7427 3a0d 0a20 2020 2020 2020 2072  ost':..        r
+0005c610: 6573 756c 7473 203d 206d 6f64 656c 2e67  esults = model.g
+0005c620: 6574 5f65 7661 6c73 5f72 6573 756c 7428  et_evals_result(
+0005c630: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+0005c640: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
+0005c650: 6d6f 6465 6c2e 6576 616c 735f 7265 7375  model.evals_resu
+0005c660: 6c74 2829 0d0a 2020 2020 7265 735f 6b65  lt()..    res_ke
+0005c670: 7973 203d 206c 6973 7428 7265 7375 6c74  ys = list(result
+0005c680: 732e 6b65 7973 2829 290d 0a20 2020 2065  s.keys())..    e
+0005c690: 7661 6c5f 6d65 7472 6963 203d 206c 6973  val_metric = lis
+0005c6a0: 7428 7265 7375 6c74 735b 7265 735f 6b65  t(results[res_ke
+0005c6b0: 7973 5b30 5d5d 2e6b 6579 7328 2929 0d0a  ys[0]].keys())..
+0005c6c0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0005c6d0: 6528 6576 616c 5f6d 6574 7269 632c 206c  e(eval_metric, l
+0005c6e0: 6973 7429 3a0d 0a20 2020 2020 2020 2023  ist):..        #
+0005c6f0: 2070 6c6f 7420 6c6f 6720 6c6f 7373 0d0a   plot log loss..
+0005c700: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
+0005c710: 7269 6320 3d20 6576 616c 5f6d 6574 7269  ric = eval_metri
+0005c720: 635b 305d 0d0a 2020 2020 2320 706c 6f74  c[0]..    # plot
+0005c730: 206d 6574 7269 6373 206e 6f77 0d0a 2020   metrics now..  
+0005c740: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
+0005c750: 7375 6270 6c6f 7473 2866 6967 7369 7a65  subplots(figsize
+0005c760: 3d28 7769 6474 685f 7369 7a65 2c20 6865  =(width_size, he
+0005c770: 6967 6874 5f73 697a 6529 290d 0a20 2020  ight_size))..   
+0005c780: 2065 706f 6368 7320 3d20 6c65 6e28 7265   epochs = len(re
+0005c790: 7375 6c74 735b 7265 735f 6b65 7973 5b30  sults[res_keys[0
+0005c7a0: 5d5d 5b65 7661 6c5f 6d65 7472 6963 5d29  ]][eval_metric])
+0005c7b0: 0d0a 2020 2020 785f 6178 6973 203d 2072  ..    x_axis = r
+0005c7c0: 616e 6765 2830 2c20 6570 6f63 6873 290d  ange(0, epochs).
+0005c7d0: 0a20 2020 2069 6620 6d6f 6465 6c5f 6e61  .    if model_na
+0005c7e0: 6d65 2e6c 6f77 6572 2829 203d 3d20 2763  me.lower() == 'c
+0005c7f0: 6174 626f 6f73 7427 3a0d 0a20 2020 2020  atboost':..     
+0005c800: 2020 2061 782e 706c 6f74 2878 5f61 7869     ax.plot(x_axi
+0005c810: 732c 2072 6573 756c 7473 5b72 6573 5f6b  s, results[res_k
+0005c820: 6579 735b 305d 5d5b 6576 616c 5f6d 6574  eys[0]][eval_met
+0005c830: 7269 635d 2c20 6c61 6265 6c3d 2725 7327  ric], label='%s'
+0005c840: 2025 7265 735f 6b65 7973 5b30 5d29 0d0a   %res_keys[0])..
+0005c850: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0005c860: 2020 2061 782e 706c 6f74 2878 5f61 7869     ax.plot(x_axi
+0005c870: 732c 2072 6573 756c 7473 5b72 6573 5f6b  s, results[res_k
+0005c880: 6579 735b 305d 5d5b 6576 616c 5f6d 6574  eys[0]][eval_met
+0005c890: 7269 635d 2c20 6c61 6265 6c3d 2725 7327  ric], label='%s'
+0005c8a0: 2025 7265 735f 6b65 7973 5b30 5d29 0d0a   %res_keys[0])..
+0005c8b0: 2020 2020 6570 6f63 6873 203d 206c 656e      epochs = len
+0005c8c0: 2872 6573 756c 7473 5b72 6573 5f6b 6579  (results[res_key
+0005c8d0: 735b 2d31 5d5d 5b65 7661 6c5f 6d65 7472  s[-1]][eval_metr
+0005c8e0: 6963 5d29 0d0a 2020 2020 785f 6178 6973  ic])..    x_axis
+0005c8f0: 203d 2072 616e 6765 2830 2c20 6570 6f63   = range(0, epoc
+0005c900: 6873 290d 0a20 2020 2061 782e 706c 6f74  hs)..    ax.plot
+0005c910: 2878 5f61 7869 732c 2072 6573 756c 7473  (x_axis, results
+0005c920: 5b72 6573 5f6b 6579 735b 2d31 5d5d 5b65  [res_keys[-1]][e
+0005c930: 7661 6c5f 6d65 7472 6963 5d2c 206c 6162  val_metric], lab
+0005c940: 656c 3d27 2573 2720 2572 6573 5f6b 6579  el='%s' %res_key
+0005c950: 735b 2d31 5d29 0d0a 2020 2020 6178 2e6c  s[-1])..    ax.l
+0005c960: 6567 656e 6428 290d 0a20 2020 2070 6c74  egend()..    plt
+0005c970: 2e79 6c61 6265 6c28 6576 616c 5f6d 6574  .ylabel(eval_met
+0005c980: 7269 6329 0d0a 2020 2020 706c 742e 7469  ric)..    plt.ti
+0005c990: 746c 6528 2725 7320 5472 6169 6e20 616e  tle('%s Train an
+0005c9a0: 6420 5661 6c69 6461 7469 6f6e 204d 6574  d Validation Met
+0005c9b0: 7269 6373 2061 6372 6f73 7320 4570 6f63  rics across Epoc
+0005c9c0: 6873 2028 4561 726c 7920 5374 6f70 7069  hs (Early Stoppi
+0005c9d0: 6e67 2069 6e20 6566 6665 6374 2927 2025  ng in effect)' %
+0005c9e0: 6d6f 6465 6c5f 6c61 6265 6c29 0d0a 2020  model_label)..  
+0005c9f0: 2020 706c 742e 7368 6f77 2829 3b0d 0a23    plt.show();..#
+0005ca00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ca10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ca20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ca30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ca40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005ca50: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2069  ..from sklearn i
+0005ca60: 6d70 6f72 7420 6d65 7472 6963 730d 0a69  mport metrics..i
+0005ca70: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
+0005ca80: 2e70 7970 6c6f 7420 6173 2070 6c74 0d0a  .pyplot as plt..
+0005ca90: 696d 706f 7274 2063 6f70 790d 0a69 6d70  import copy..imp
+0005caa0: 6f72 7420 7064 620d 0a64 6566 2070 7269  ort pdb..def pri
+0005cab0: 6e74 5f63 6c61 7373 6966 6963 6174 696f  nt_classificatio
+0005cac0: 6e5f 6d65 7472 6963 7328 795f 7465 7374  n_metrics(y_test
+0005cad0: 2c20 795f 7072 6f62 732c 2070 726f 6261  , y_probs, proba
+0005cae0: 5f66 6c61 673d 5472 7565 293a 0d0a 2020  _flag=True):..  
+0005caf0: 2020 2222 220d 0a20 2020 2023 2323 2323    """..    #####
+0005cb00: 2323 2020 5365 6e64 2069 6e20 7468 6520  ##  Send in the 
+0005cb10: 6163 7475 616c 5f76 616c 7565 7320 616e  actual_values an
+0005cb20: 6420 7072 6564 6963 7469 6f6e 5f70 726f  d prediction_pro
+0005cb30: 6261 6269 6c69 7469 6573 2066 6f72 2062  babilities for b
+0005cb40: 696e 6172 7920 636c 6173 7365 730d 0a20  inary classes.. 
+0005cb50: 2020 2054 6869 7320 7769 6c6c 2072 6574     This will ret
+0005cb60: 7572 6e20 6261 636b 206d 6574 7269 6373  urn back metrics
+0005cb70: 2061 6e64 2070 7269 6e74 2074 6865 6d20   and print them 
+0005cb80: 616c 6c20 696e 2061 206e 6561 7420 666f  all in a neat fo
+0005cb90: 726d 6174 0d0a 2020 2020 2222 220d 0a20  rmat..    """.. 
+0005cba0: 2020 2079 5f74 6573 7420 3d20 636f 7079     y_test = copy
+0005cbb0: 2e64 6565 7063 6f70 7928 795f 7465 7374  .deepcopy(y_test
+0005cbc0: 290d 0a20 2020 206d 756c 7469 5f6c 6162  )..    multi_lab
+0005cbd0: 656c 5f66 6c61 6720 3d20 4661 6c73 650d  el_flag = False.
+0005cbe0: 0a20 2020 206d 756c 7469 5f63 6c61 7373  .    multi_class
+0005cbf0: 5f66 6c61 6720 3d20 4661 6c73 650d 0a20  _flag = False.. 
+0005cc00: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0005cc10: 2069 6620 795f 7465 7374 2e73 6861 7065   if y_test.shape
+0005cc20: 5b31 5d20 3e20 303a 0d0a 2020 2020 2020  [1] > 0:..      
+0005cc30: 2020 2020 2020 6d75 6c74 695f 6c61 6265        multi_labe
+0005cc40: 6c5f 666c 6167 203d 2054 7275 650d 0a20  l_flag = True.. 
+0005cc50: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+0005cc60: 2020 2020 7061 7373 0d0a 2020 2020 2323      pass..    ##
+0005cc70: 2323 2323 2323 2054 6869 7320 6973 2077  ###### This is w
+0005cc80: 6865 7265 2079 6f75 2073 7461 7274 2070  here you start p
+0005cc90: 7269 6e74 696e 6720 6d65 7472 6963 7320  rinting metrics 
+0005cca0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0005ccb0: 0a20 2020 2069 6620 6c65 6e28 6e70 2e75  .    if len(np.u
+0005ccc0: 6e69 7175 6528 795f 7465 7374 2929 203e  nique(y_test)) >
+0005ccd0: 2032 3a0d 0a20 2020 2020 2020 206d 756c   2:..        mul
+0005cce0: 7469 5f63 6c61 7373 5f66 6c61 6720 3d20  ti_class_flag = 
+0005ccf0: 5472 7565 0d0a 2020 2020 2020 2020 7072  True..        pr
+0005cd00: 696e 7428 274d 756c 7469 2043 6c61 7373  int('Multi Class
+0005cd10: 204d 6f64 656c 204d 6574 7269 6373 2052   Model Metrics R
+0005cd20: 6570 6f72 7427 290d 0a20 2020 2020 2020  eport')..       
+0005cd30: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
+0005cd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005cd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005cd60: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+0005cd70: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+0005cd80: 2020 2020 7072 696e 7428 2742 696e 6172      print('Binar
+0005cd90: 7920 436c 6173 7320 4d6f 6465 6c20 4d65  y Class Model Me
+0005cda0: 7472 6963 7320 5265 706f 7274 2729 0d0a  trics Report')..
+0005cdb0: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
+0005cdc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005cdd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005cde0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005cdf0: 2323 2323 2729 0d0a 2020 2020 2323 2323  ####')..    ####
+0005ce00: 2066 6f72 2073 6f6d 6520 6361 7365 732c   for some cases,
+0005ce10: 2079 6f75 2077 6f6e 2774 2067 6574 2070   you won't get p
+0005ce20: 726f 6261 2c20 736f 2063 6865 636b 2074  roba, so check t
+0005ce30: 6865 2070 726f 6261 5f66 6c61 670d 0a20  he proba_flag.. 
+0005ce40: 2020 2069 6620 7072 6f62 615f 666c 6167     if proba_flag
+0005ce50: 3a0d 0a20 2020 2020 2020 2069 6620 6d75  :..        if mu
+0005ce60: 6c74 695f 6c61 6265 6c5f 666c 6167 3a0d  lti_label_flag:.
+0005ce70: 0a20 2020 2020 2020 2020 2020 2079 5f70  .            y_p
+0005ce80: 7265 6473 203d 2028 795f 7072 6f62 733e  reds = (y_probs>
+0005ce90: 302e 3529 2e61 7374 7970 6528 696e 7429  0.5).astype(int)
+0005cea0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0005ceb0: 0a20 2020 2020 2020 2020 2020 2079 5f70  .            y_p
+0005cec0: 7265 6473 203d 2079 5f70 726f 6273 2e61  reds = y_probs.a
+0005ced0: 7267 6d61 7828 6178 6973 3d31 290d 0a20  rgmax(axis=1).. 
+0005cee0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0005cef0: 2020 795f 7072 6564 7320 3d20 636f 7079    y_preds = copy
+0005cf00: 2e64 6565 7063 6f70 7928 795f 7072 6f62  .deepcopy(y_prob
+0005cf10: 7329 0d0a 2020 2020 6966 206e 6f74 206d  s)..    if not m
+0005cf20: 756c 7469 5f63 6c61 7373 5f66 6c61 6720  ulti_class_flag 
+0005cf30: 2061 6e64 206e 6f74 206d 756c 7469 5f6c   and not multi_l
+0005cf40: 6162 656c 5f66 6c61 673a 0d0a 2020 2020  abel_flag:..    
+0005cf50: 2020 2020 2320 4361 6c63 756c 6174 6520      # Calculate 
+0005cf60: 636f 6d70 6172 6973 6f6e 206d 6574 7269  comparison metri
+0005cf70: 6373 2066 6f72 2042 696e 6172 7920 636c  cs for Binary cl
+0005cf80: 6173 7369 6669 6361 7469 6f6e 2072 6573  assification res
+0005cf90: 756c 7473 2e0d 0a20 2020 2020 2020 2061  ults...        a
+0005cfa0: 6363 7572 6163 7920 3d20 6d65 7472 6963  ccuracy = metric
+0005cfb0: 732e 6163 6375 7261 6379 5f73 636f 7265  s.accuracy_score
+0005cfc0: 2879 5f74 6573 742c 2079 5f70 7265 6473  (y_test, y_preds
+0005cfd0: 290d 0a20 2020 2020 2020 2062 616c 616e  )..        balan
+0005cfe0: 6365 645f 6163 6375 7261 6379 203d 206d  ced_accuracy = m
+0005cff0: 6574 7269 6373 2e62 616c 616e 6365 645f  etrics.balanced_
+0005d000: 6163 6375 7261 6379 5f73 636f 7265 2879  accuracy_score(y
+0005d010: 5f74 6573 742c 2079 5f70 7265 6473 290d  _test, y_preds).
+0005d020: 0a20 2020 2020 2020 2070 7265 6369 7369  .        precisi
+0005d030: 6f6e 203d 206d 6574 7269 6373 2e70 7265  on = metrics.pre
+0005d040: 6369 7369 6f6e 5f73 636f 7265 2879 5f74  cision_score(y_t
+0005d050: 6573 742c 2079 5f70 7265 6473 290d 0a20  est, y_preds).. 
+0005d060: 2020 2020 2020 2066 315f 7363 6f72 6520         f1_score 
+0005d070: 3d20 6d65 7472 6963 732e 6631 5f73 636f  = metrics.f1_sco
+0005d080: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
+0005d090: 6473 290d 0a20 2020 2020 2020 2072 6563  ds)..        rec
+0005d0a0: 616c 6c20 3d20 6d65 7472 6963 732e 7265  all = metrics.re
+0005d0b0: 6361 6c6c 5f73 636f 7265 2879 5f74 6573  call_score(y_tes
+0005d0c0: 742c 2079 5f70 7265 6473 290d 0a20 2020  t, y_preds)..   
+0005d0d0: 2020 2020 2069 6620 7479 7065 286e 702e       if type(np.
+0005d0e0: 6d65 616e 2828 795f 7465 7374 3d3d 795f  mean((y_test==y_
+0005d0f0: 7072 6564 7329 2929 203d 3d20 7064 2e53  preds))) == pd.S
+0005d100: 6572 6965 733a 0d0a 2020 2020 2020 2020  eries:..        
+0005d110: 2020 2020 7072 696e 7428 2720 2020 2041      print('    A
+0005d120: 6363 7572 6163 7920 2020 2020 2020 2020  ccuracy         
+0005d130: 203d 2025 302e 3166 2525 2720 2528 6e70   = %0.1f%%' %(np
+0005d140: 2e6d 6561 6e28 6163 6375 7261 6379 292a  .mean(accuracy)*
+0005d150: 3130 3029 290d 0a20 2020 2020 2020 2065  100))..        e
+0005d160: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0005d170: 2020 7072 696e 7428 2720 2020 2041 6363    print('    Acc
+0005d180: 7572 6163 7920 2020 2020 2020 2020 203d  uracy          =
+0005d190: 2025 302e 3166 2525 2720 2528 6163 6375   %0.1f%%' %(accu
+0005d1a0: 7261 6379 2a31 3030 2929 0d0a 2020 2020  racy*100))..    
+0005d1b0: 2020 2020 7072 696e 7428 2720 2020 2042      print('    B
+0005d1c0: 616c 616e 6365 6420 4163 6375 7261 6379  alanced Accuracy
+0005d1d0: 203d 2025 302e 3166 2525 2720 2528 6261   = %0.1f%%' %(ba
+0005d1e0: 6c61 6e63 6564 5f61 6363 7572 6163 792a  lanced_accuracy*
+0005d1f0: 3130 3029 290d 0a20 2020 2020 2020 2070  100))..        p
+0005d200: 7269 6e74 2827 2020 2020 5072 6563 6973  rint('    Precis
+0005d210: 696f 6e20 2020 2020 2020 2020 3d20 2530  ion         = %0
+0005d220: 2e31 6625 2527 2025 2870 7265 6369 7369  .1f%%' %(precisi
+0005d230: 6f6e 2a31 3030 2929 0d0a 2020 2020 2020  on*100))..      
+0005d240: 2020 6966 2070 726f 6261 5f66 6c61 673a    if proba_flag:
+0005d250: 0d0a 2020 2020 2020 2020 2020 2020 6176  ..            av
+0005d260: 6572 6167 655f 7072 6563 6973 696f 6e20  erage_precision 
+0005d270: 3d20 6e70 2e6d 6561 6e28 6d65 7472 6963  = np.mean(metric
+0005d280: 732e 7072 6563 6973 696f 6e5f 7363 6f72  s.precision_scor
+0005d290: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
+0005d2a0: 732c 2061 7665 7261 6765 3d4e 6f6e 6529  s, average=None)
+0005d2b0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+0005d2c0: 0d0a 2020 2020 2020 2020 2020 2020 6176  ..            av
+0005d2d0: 6572 6167 655f 7072 6563 6973 696f 6e20  erage_precision 
+0005d2e0: 3d20 6d65 7472 6963 732e 7072 6563 6973  = metrics.precis
+0005d2f0: 696f 6e5f 7363 6f72 6528 795f 7465 7374  ion_score(y_test
+0005d300: 2c20 795f 7072 6564 732c 2061 7665 7261  , y_preds, avera
+0005d310: 6765 3d27 6d61 6372 6f27 290d 0a20 2020  ge='macro')..   
+0005d320: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0005d330: 4176 6572 6167 6520 5072 6563 6973 696f  Average Precisio
+0005d340: 6e20 3d20 2530 2e31 6625 2527 2025 2861  n = %0.1f%%' %(a
+0005d350: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
+0005d360: 2a31 3030 2929 0d0a 2020 2020 2020 2020  *100))..        
+0005d370: 7072 696e 7428 2720 2020 2052 6563 616c  print('    Recal
+0005d380: 6c20 2020 2020 2020 2020 2020 203d 2025  l            = %
+0005d390: 302e 3166 2525 2720 2528 7265 6361 6c6c  0.1f%%' %(recall
+0005d3a0: 2a31 3030 2929 0d0a 2020 2020 2020 2020  *100))..        
+0005d3b0: 7072 696e 7428 2720 2020 2046 3120 5363  print('    F1 Sc
+0005d3c0: 6f72 6520 2020 2020 2020 2020 203d 2025  ore          = %
+0005d3d0: 302e 3166 2525 2720 2528 6631 5f73 636f  0.1f%%' %(f1_sco
+0005d3e0: 7265 2a31 3030 2929 0d0a 2020 2020 2020  re*100))..      
+0005d3f0: 2020 6966 2070 726f 6261 5f66 6c61 673a    if proba_flag:
+0005d400: 0d0a 2020 2020 2020 2020 2020 2020 6670  ..            fp
+0005d410: 722c 2074 7072 2c20 7468 7265 7368 6f6c  r, tpr, threshol
+0005d420: 6420 3d20 6d65 7472 6963 732e 726f 635f  d = metrics.roc_
+0005d430: 6375 7276 6528 795f 7465 7374 2c20 795f  curve(y_test, y_
+0005d440: 7072 6f62 735b 3a2c 315d 290d 0a20 2020  probs[:,1])..   
+0005d450: 2020 2020 2020 2020 2072 6f63 5f61 7563           roc_auc
+0005d460: 203d 206d 6574 7269 6373 2e61 7563 2866   = metrics.auc(f
+0005d470: 7072 2c20 7470 7229 0d0a 2020 2020 2020  pr, tpr)..      
+0005d480: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0005d490: 2052 4f43 2041 5543 2020 2020 2020 2020   ROC AUC        
+0005d4a0: 2020 203d 2025 302e 3166 2525 2720 2528     = %0.1f%%' %(
+0005d4b0: 726f 635f 6175 632a 3130 3029 290d 0a20  roc_auc*100)).. 
+0005d4c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0005d4d0: 2020 2020 2020 2020 2020 726f 635f 6175            roc_au
+0005d4e0: 6320 3d20 300d 0a20 2020 2020 2020 2070  c = 0..        p
+0005d4f0: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
+0005d500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005d510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005d520: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+0005d530: 2020 2020 2020 2072 6574 7572 6e20 5b61         return [a
+0005d540: 6363 7572 6163 792c 2062 616c 616e 6365  ccuracy, balance
+0005d550: 645f 6163 6375 7261 6379 2c20 7072 6563  d_accuracy, prec
+0005d560: 6973 696f 6e2c 2061 7665 7261 6765 5f70  ision, average_p
+0005d570: 7265 6369 7369 6f6e 2c20 6631 5f73 636f  recision, f1_sco
+0005d580: 7265 2c20 7265 6361 6c6c 2c20 726f 635f  re, recall, roc_
+0005d590: 6175 635d 0d0a 2020 2020 656c 7365 3a0d  auc]..    else:.
+0005d5a0: 0a20 2020 2020 2020 2023 2043 616c 6375  .        # Calcu
+0005d5b0: 6c61 7465 2063 6f6d 7061 7269 736f 6e20  late comparison 
+0005d5c0: 6d65 7472 6963 7320 666f 7220 4d75 6c74  metrics for Mult
+0005d5d0: 692d 436c 6173 7320 636c 6173 7369 6669  i-Class classifi
+0005d5e0: 6361 7469 6f6e 2072 6573 756c 7473 2e0d  cation results..
+0005d5f0: 0a20 2020 2020 2020 2061 6363 7572 6163  .        accurac
+0005d600: 7920 3d20 6e70 2e6d 6561 6e28 2879 5f74  y = np.mean((y_t
+0005d610: 6573 743d 3d79 5f70 7265 6473 2929 0d0a  est==y_preds))..
+0005d620: 2020 2020 2020 2020 6966 206d 756c 7469          if multi
+0005d630: 5f6c 6162 656c 5f66 6c61 673a 0d0a 2020  _label_flag:..  
+0005d640: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+0005d650: 696e 2072 616e 6765 2879 5f74 6573 742e  in range(y_test.
+0005d660: 7368 6170 655b 315d 293a 0d0a 2020 2020  shape[1]):..    
+0005d670: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0005d680: 7428 2746 6f72 2074 6172 6765 7420 6c61  t('For target la
+0005d690: 6265 6c3a 2025 7327 2025 6929 0d0a 2020  bel: %s' %i)..  
+0005d6a0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+0005d6b0: 6c61 6e63 6564 5f61 6363 7572 6163 7920  lanced_accuracy 
+0005d6c0: 3d20 6e70 2e6d 6561 6e28 6d65 7472 6963  = np.mean(metric
+0005d6d0: 732e 7265 6361 6c6c 5f73 636f 7265 2879  s.recall_score(y
+0005d6e0: 5f74 6573 745b 3a2c 695d 2c20 795f 7072  _test[:,i], y_pr
+0005d6f0: 6564 735b 3a2c 695d 2c20 6176 6572 6167  eds[:,i], averag
+0005d700: 653d 4e6f 6e65 2929 0d0a 2020 2020 2020  e=None))..      
+0005d710: 2020 2020 2020 2020 2020 7072 6563 6973            precis
+0005d720: 696f 6e20 3d20 6d65 7472 6963 732e 7072  ion = metrics.pr
+0005d730: 6563 6973 696f 6e5f 7363 6f72 6528 795f  ecision_score(y_
+0005d740: 7465 7374 5b3a 2c69 5d2c 2079 5f70 7265  test[:,i], y_pre
+0005d750: 6473 5b3a 2c69 5d2c 2061 7665 7261 6765  ds[:,i], average
+0005d760: 3d4e 6f6e 6529 0d0a 2020 2020 2020 2020  =None)..        
+0005d770: 2020 2020 2020 2020 6176 6572 6167 655f          average_
+0005d780: 7072 6563 6973 696f 6e20 3d20 6d65 7472  precision = metr
+0005d790: 6963 732e 7072 6563 6973 696f 6e5f 7363  ics.precision_sc
+0005d7a0: 6f72 6528 795f 7465 7374 5b3a 2c69 5d2c  ore(y_test[:,i],
+0005d7b0: 2079 5f70 7265 6473 5b3a 2c69 5d2c 2061   y_preds[:,i], a
+0005d7c0: 7665 7261 6765 3d27 6d61 6372 6f27 290d  verage='macro').
+0005d7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005d7e0: 2066 315f 7363 6f72 6520 3d20 6d65 7472   f1_score = metr
+0005d7f0: 6963 732e 6631 5f73 636f 7265 2879 5f74  ics.f1_score(y_t
+0005d800: 6573 745b 3a2c 695d 2c20 795f 7072 6564  est[:,i], y_pred
+0005d810: 735b 3a2c 695d 2c20 6176 6572 6167 653d  s[:,i], average=
+0005d820: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
+0005d830: 2020 2020 2020 2072 6563 616c 6c20 3d20         recall = 
+0005d840: 6d65 7472 6963 732e 7265 6361 6c6c 5f73  metrics.recall_s
+0005d850: 636f 7265 2879 5f74 6573 745b 3a2c 695d  core(y_test[:,i]
+0005d860: 2c20 795f 7072 6564 735b 3a2c 695d 2c20  , y_preds[:,i], 
+0005d870: 6176 6572 6167 653d 4e6f 6e65 290d 0a20  average=None).. 
+0005d880: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0005d890: 7269 6e74 2827 2020 2020 4261 6c61 6e63  rint('    Balanc
+0005d8a0: 6564 2041 6363 7572 6163 7920 2861 7665  ed Accuracy (ave
+0005d8b0: 7261 6765 2072 6563 616c 6c29 203d 2025  rage recall) = %
+0005d8c0: 302e 3166 2525 2720 2528 6261 6c61 6e63  0.1f%%' %(balanc
+0005d8d0: 6564 5f61 6363 7572 6163 792a 3130 3029  ed_accuracy*100)
+0005d8e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0005d8f0: 2020 2070 7269 6e74 2827 2020 2020 4176     print('    Av
+0005d900: 6572 6167 6520 5072 6563 6973 696f 6e20  erage Precision 
+0005d910: 286d 6163 726f 2920 3d20 2530 2e31 6625  (macro) = %0.1f%
+0005d920: 2527 2025 2861 7665 7261 6765 5f70 7265  %' %(average_pre
+0005d930: 6369 7369 6f6e 2a31 3030 2929 0d0a 2020  cision*100))..  
+0005d940: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0005d950: 2320 7468 6573 6520 6172 6520 6261 7369  # these are basi
+0005d960: 6361 6c6c 7920 6f6e 6520 666f 7220 6561  cally one for ea
+0005d970: 6368 2063 6c61 7373 2023 2323 2323 0d0a  ch class #####..
+0005d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005d990: 7072 696e 7428 2720 2020 2050 7265 6369  print('    Preci
+0005d9a0: 7369 6f6e 7320 6279 2063 6c61 7373 3a27  sions by class:'
+0005d9b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0005d9c0: 2020 2066 6f72 2070 7265 6369 7369 6f6e     for precision
+0005d9d0: 7320 696e 2070 7265 6369 7369 6f6e 3a0d  s in precision:.
+0005d9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005d9f0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0005da00: 2530 2e31 6625 2520 2027 2025 2870 7265  %0.1f%%  ' %(pre
+0005da10: 6369 7369 6f6e 732a 3130 3029 2c65 6e64  cisions*100),end
+0005da20: 3d22 2229 0d0a 2020 2020 2020 2020 2020  ="")..          
+0005da30: 2020 2020 2020 7072 696e 7428 275c 6e20        print('\n 
+0005da40: 2020 2052 6563 616c 6c20 5363 6f72 6573     Recall Scores
+0005da50: 2062 7920 636c 6173 733a 2729 0d0a 2020   by class:')..  
+0005da60: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0005da70: 7220 7265 6361 6c6c 7320 696e 2072 6563  r recalls in rec
+0005da80: 616c 6c3a 0d0a 2020 2020 2020 2020 2020  all:..          
+0005da90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0005daa0: 2720 2020 2025 302e 3166 2525 2020 2720  '    %0.1f%%  ' 
+0005dab0: 2528 7265 6361 6c6c 732a 3130 3029 2c20  %(recalls*100), 
+0005dac0: 656e 643d 2222 290d 0a20 2020 2020 2020  end="")..       
+0005dad0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0005dae0: 5c6e 2020 2020 4631 2053 636f 7265 7320  \n    F1 Scores 
+0005daf0: 6279 2063 6c61 7373 3a27 290d 0a20 2020  by class:')..   
+0005db00: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0005db10: 2066 315f 7363 6f72 6573 2069 6e20 6631   f1_scores in f1
+0005db20: 5f73 636f 7265 3a0d 0a20 2020 2020 2020  _score:..       
+0005db30: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0005db40: 6e74 2827 2020 2020 2530 2e31 6625 2520  nt('    %0.1f%% 
+0005db50: 2027 2025 2866 315f 7363 6f72 6573 2a31   ' %(f1_scores*1
+0005db60: 3030 292c 656e 643d 2222 290d 0a20 2020  00),end="")..   
+0005db70: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0005db80: 6e74 2827 5c6e 2323 2323 2323 2323 2323  nt('\n##########
+0005db90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005dba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005dbb0: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+0005dbc0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0005dbd0: 2020 2020 2020 2020 2020 6261 6c61 6e63            balanc
+0005dbe0: 6564 5f61 6363 7572 6163 7920 3d20 6d65  ed_accuracy = me
+0005dbf0: 7472 6963 732e 6261 6c61 6e63 6564 5f61  trics.balanced_a
+0005dc00: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+0005dc10: 7465 7374 2c20 795f 7072 6564 7329 0d0a  test, y_preds)..
+0005dc20: 2020 2020 2020 2020 2020 2020 7072 6563              prec
+0005dc30: 6973 696f 6e20 3d20 6d65 7472 6963 732e  ision = metrics.
+0005dc40: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
+0005dc50: 795f 7465 7374 2c20 795f 7072 6564 732c  y_test, y_preds,
+0005dc60: 2061 7665 7261 6765 203d 204e 6f6e 6529   average = None)
+0005dc70: 0d0a 2020 2020 2020 2020 2020 2020 6176  ..            av
+0005dc80: 6572 6167 655f 7072 6563 6973 696f 6e20  erage_precision 
+0005dc90: 3d20 6d65 7472 6963 732e 7072 6563 6973  = metrics.precis
+0005dca0: 696f 6e5f 7363 6f72 6528 795f 7465 7374  ion_score(y_test
+0005dcb0: 2c20 795f 7072 6564 732c 6176 6572 6167  , y_preds,averag
+0005dcc0: 653d 276d 6163 726f 2729 0d0a 2020 2020  e='macro')..    
+0005dcd0: 2020 2020 2020 2020 6631 5f73 636f 7265          f1_score
+0005dce0: 203d 206d 6574 7269 6373 2e66 315f 7363   = metrics.f1_sc
+0005dcf0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+0005dd00: 6564 732c 2061 7665 7261 6765 203d 204e  eds, average = N
+0005dd10: 6f6e 6529 0d0a 2020 2020 2020 2020 2020  one)..          
+0005dd20: 2020 7265 6361 6c6c 203d 206d 6574 7269    recall = metri
+0005dd30: 6373 2e72 6563 616c 6c5f 7363 6f72 6528  cs.recall_score(
+0005dd40: 795f 7465 7374 2c20 795f 7072 6564 732c  y_test, y_preds,
+0005dd50: 2061 7665 7261 6765 203d 204e 6f6e 6529   average = None)
+0005dd60: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0005dd70: 2074 7970 6528 6e70 2e6d 6561 6e28 2879   type(np.mean((y
+0005dd80: 5f74 6573 743d 3d79 5f70 7265 6473 2929  _test==y_preds))
+0005dd90: 2920 3d3d 2070 642e 5365 7269 6573 3a0d  ) == pd.Series:.
+0005dda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005ddb0: 2070 7269 6e74 2827 2020 2020 4163 6375   print('    Accu
+0005ddc0: 7261 6379 2020 2020 2020 2020 2020 3d20  racy          = 
+0005ddd0: 2530 2e31 6625 2527 2025 286e 702e 6d65  %0.1f%%' %(np.me
+0005dde0: 616e 2861 6363 7572 6163 7929 2a31 3030  an(accuracy)*100
+0005ddf0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0005de00: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0005de10: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0005de20: 2020 4163 6375 7261 6379 2020 2020 2020    Accuracy      
+0005de30: 2020 2020 3d20 2530 2e31 6625 2527 2025      = %0.1f%%' %
+0005de40: 2861 6363 7572 6163 792a 3130 3029 290d  (accuracy*100)).
+0005de50: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0005de60: 6e74 2827 2020 2020 4261 6c61 6e63 6564  nt('    Balanced
+0005de70: 2041 6363 7572 6163 7920 2861 7665 7261   Accuracy (avera
+0005de80: 6765 2072 6563 616c 6c29 203d 2025 302e  ge recall) = %0.
+0005de90: 3166 2525 2720 2528 6261 6c61 6e63 6564  1f%%' %(balanced
+0005dea0: 5f61 6363 7572 6163 792a 3130 3029 290d  _accuracy*100)).
+0005deb0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0005dec0: 6e74 2827 2020 2020 4176 6572 6167 6520  nt('    Average 
+0005ded0: 5072 6563 6973 696f 6e20 286d 6163 726f  Precision (macro
+0005dee0: 2920 3d20 2530 2e31 6625 2527 2025 2861  ) = %0.1f%%' %(a
+0005def0: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
+0005df00: 2a31 3030 2929 0d0a 2020 2020 2020 2020  *100))..        
+0005df10: 2020 2020 2323 2320 7468 6573 6520 6172      ### these ar
+0005df20: 6520 6261 7369 6361 6c6c 7920 6f6e 6520  e basically one 
+0005df30: 666f 7220 6561 6368 2063 6c61 7373 2023  for each class #
+0005df40: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+0005df50: 2020 7072 696e 7428 2720 2020 2050 7265    print('    Pre
+0005df60: 6369 7369 6f6e 7320 6279 2063 6c61 7373  cisions by class
+0005df70: 3a27 290d 0a20 2020 2020 2020 2020 2020  :')..           
+0005df80: 2066 6f72 2070 7265 6369 7369 6f6e 7320   for precisions 
+0005df90: 696e 2070 7265 6369 7369 6f6e 3a0d 0a20  in precision:.. 
+0005dfa0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0005dfb0: 7269 6e74 2827 2020 2020 2530 2e31 6625  rint('    %0.1f%
+0005dfc0: 2520 2027 2025 2870 7265 6369 7369 6f6e  %  ' %(precision
+0005dfd0: 732a 3130 3029 2c65 6e64 3d22 2229 0d0a  s*100),end="")..
+0005dfe0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0005dff0: 7428 275c 6e20 2020 2052 6563 616c 6c20  t('\n    Recall 
+0005e000: 5363 6f72 6573 2062 7920 636c 6173 733a  Scores by class:
+0005e010: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0005e020: 666f 7220 7265 6361 6c6c 7320 696e 2072  for recalls in r
+0005e030: 6563 616c 6c3a 0d0a 2020 2020 2020 2020  ecall:..        
+0005e040: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005e050: 2020 2025 302e 3166 2525 2020 2720 2528     %0.1f%%  ' %(
+0005e060: 7265 6361 6c6c 732a 3130 3029 2c20 656e  recalls*100), en
+0005e070: 643d 2222 290d 0a20 2020 2020 2020 2020  d="")..         
+0005e080: 2020 2070 7269 6e74 2827 5c6e 2020 2020     print('\n    
+0005e090: 4631 2053 636f 7265 7320 6279 2063 6c61  F1 Scores by cla
+0005e0a0: 7373 3a27 290d 0a20 2020 2020 2020 2020  ss:')..         
+0005e0b0: 2020 2066 6f72 2066 315f 7363 6f72 6573     for f1_scores
+0005e0c0: 2069 6e20 6631 5f73 636f 7265 3a0d 0a20   in f1_score:.. 
+0005e0d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0005e0e0: 7269 6e74 2827 2020 2020 2530 2e31 6625  rint('    %0.1f%
+0005e0f0: 2520 2027 2025 2866 315f 7363 6f72 6573  %  ' %(f1_scores
+0005e100: 2a31 3030 292c 656e 643d 2222 290d 0a20  *100),end="").. 
+0005e110: 2020 2020 2020 2020 2020 2023 2052 6574             # Ret
+0005e120: 7572 6e20 6c69 7374 206f 6620 6d65 7472  urn list of metr
+0005e130: 6963 7320 746f 2062 6520 6164 6465 6420  ics to be added 
+0005e140: 746f 2061 2044 6174 6166 7261 6d65 2074  to a Dataframe t
+0005e150: 6f20 636f 6d70 6172 6520 6d6f 6465 6c73  o compare models
+0005e160: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
+0005e170: 7269 6e74 2827 5c6e 2323 2323 2323 2323  rint('\n########
+0005e180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e1a0: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+0005e1b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0005e1c0: 5b61 6363 7572 6163 792c 2062 616c 616e  [accuracy, balan
+0005e1d0: 6365 645f 6163 6375 7261 6379 2c20 7072  ced_accuracy, pr
+0005e1e0: 6563 6973 696f 6e2c 2061 7665 7261 6765  ecision, average
+0005e1f0: 5f70 7265 6369 7369 6f6e 2c20 6631 5f73  _precision, f1_s
+0005e200: 636f 7265 2c20 7265 6361 6c6c 2c20 305d  core, recall, 0]
+0005e210: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 0005e220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e250: 2323 2323 2323 2323 0d0a 2020 2020 2323  ########..    ##
-0005e260: 2323 2054 4849 5320 4d45 5448 4f44 2049  ## THIS METHOD I
-0005e270: 5320 4b4e 4f57 4e20 4153 2054 4845 2053  S KNOWN AS THE S
-0005e280: 554c 4f56 204d 4554 484f 4420 696e 2048  ULOV METHOD in H
-0005e290: 4f4e 4f52 204f 4620 6d79 206d 6f74 6865  ONOR OF my mothe
-0005e2a0: 7220 2323 2323 2323 2323 2323 2323 2323  r ##############
-0005e2b0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+0005e250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e270: 2323 2323 0d0a 2323 2323 2323 2323 2323  ####..##########
+0005e280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e2b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e2c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e2d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e2e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e2f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e300: 2323 2323 2323 2323 0d0a 2020 2020 5320  ########..    S 
-0005e310: 5520 4c20 4f20 5620 7265 6665 7273 2074  U L O V refers t
-0005e320: 6f20 5365 6c65 6374 2055 6e63 6f72 7265  o Select Uncorre
-0005e330: 6c61 7465 6420 4c69 7374 206f 6620 5661  lated List of Va
-0005e340: 7269 6162 6c65 733a 2043 7265 6174 6564  riables: Created
-0005e350: 2062 7920 5261 6d20 5365 7368 6164 7269   by Ram Seshadri
-0005e360: 0d0a 2020 2020 5355 4c4f 5620 6973 2061  ..    SULOV is a
-0005e370: 2068 6967 686c 7920 6566 6669 6369 656e   highly efficien
-0005e380: 7420 616c 676f 7269 7468 2074 6861 7420  t algorith that 
-0005e390: 7573 6573 204d 4953 2074 6f20 6272 6561  uses MIS to brea
-0005e3a0: 6b20 7469 652d 6272 6561 6b65 7273 2061  k tie-breakers a
-0005e3b0: 6d6f 6e67 0d0a 2020 2020 2068 6967 686c  mong..     highl
-0005e3c0: 7920 636f 7272 656c 6174 6564 2076 6172  y correlated var
-0005e3d0: 6961 626c 6573 2077 6865 7265 2077 6520  iables where we 
-0005e3e0: 6861 7665 2074 6f20 6465 6369 6465 2077  have to decide w
-0005e3f0: 6869 6368 206f 6620 7477 6f20 7661 7269  hich of two vari
-0005e400: 6162 6c65 7320 746f 2064 726f 702e 200d  ables to drop. .
-0005e410: 0a20 2020 2020 4375 7272 656e 746c 7920  .     Currently 
-0005e420: 7468 6572 6520 6973 206e 6f20 636c 6561  there is no clea
-0005e430: 7220 7761 792e 2053 554c 4f56 2075 7365  r way. SULOV use
-0005e440: 7320 4d49 5320 286d 7574 7561 6c5f 696e  s MIS (mutual_in
-0005e450: 666f 5f73 636f 7265 2920 746f 206b 6565  fo_score) to kee
-0005e460: 7020 0d0a 2020 2020 2074 6865 2068 6967  p ..     the hig
-0005e470: 6865 7220 4d49 5320 7661 7269 6162 6c65  her MIS variable
-0005e480: 2e20 5468 6973 206d 6574 686f 6420 656e  . This method en
-0005e490: 6162 6c65 7320 616e 2065 7874 7265 6d65  ables an extreme
-0005e4a0: 6c79 2066 6173 7420 616e 6420 6566 6665  ly fast and effe
-0005e4b0: 6374 6976 6520 7761 790d 0a20 2020 2020  ctive way..     
-0005e4c0: 746f 2073 656c 6563 7420 6265 7374 2066  to select best f
-0005e4d0: 6561 7475 7265 7320 6672 6f6d 2064 6174  eatures from dat
-0005e4e0: 612e 2059 6f75 206e 6565 6420 746f 2073  a. You need to s
-0005e4f0: 656e 6420 696e 2061 2064 6174 6166 7261  end in a datafra
-0005e500: 6d65 2077 6974 6820 6120 6c69 7374 200d  me with a list .
-0005e510: 0a20 2020 2020 6f66 206e 756d 6572 6963  .     of numeric
-0005e520: 2076 6172 6961 626c 6573 2061 6e64 2064   variables and d
-0005e530: 6566 696e 6520 6120 7468 7265 7368 6f6c  efine a threshol
-0005e540: 6420 2d20 7468 6174 2773 2061 6c6c 2e0d  d - that's all..
-0005e550: 0a20 2020 2020 5468 6973 2074 6872 6573  .     This thres
-0005e560: 686f 6c64 2077 696c 6c20 6465 6669 6e65  hold will define
-0005e570: 2074 6865 2022 6869 6768 2043 6f72 7265   the "high Corre
-0005e580: 6c61 7469 6f6e 2220 6d61 726b 3a20 6465  lation" mark: de
-0005e590: 6661 756c 7420 6973 202e 3730 2028 6162  fault is .70 (ab
-0005e5a0: 736f 6c75 7465 292e 0d0a 2020 2020 2059  solute)...     Y
-0005e5b0: 6f75 2063 616e 2063 6861 6e67 6520 7468  ou can change th
-0005e5c0: 6973 206c 696d 6974 2e20 4966 2074 776f  is limit. If two
-0005e5d0: 2076 6172 6961 626c 6573 2068 6176 6520   variables have 
-0005e5e0: 6162 736f 6c75 7465 2063 6f72 7265 6c61  absolute correla
-0005e5f0: 7469 6f6e 2068 6967 6865 7220 7468 616e  tion higher than
-0005e600: 200d 0a20 2020 2020 6c69 6d69 742c 2074   ..     limit, t
-0005e610: 6865 7920 7769 6c6c 2062 6520 7265 642d  hey will be red-
-0005e620: 666c 6167 6765 642c 2061 6e64 2075 7369  flagged, and usi
-0005e630: 6e67 2061 2073 6572 6965 7320 6f66 2074  ng a series of t
-0005e640: 6965 2d62 7265 616b 6572 2072 6f75 6e64  ie-breaker round
-0005e650: 732c 206f 6e65 206f 6620 0d0a 2020 2020  s, one of ..    
-0005e660: 2074 6865 6d20 7769 6c6c 2062 6520 7365   them will be se
-0005e670: 6c65 6374 6564 2073 696e 6365 2074 6865  lected since the
-0005e680: 2073 616d 6520 7661 7269 6162 6c65 2063   same variable c
-0005e690: 616e 2062 6520 636f 7272 656c 6174 6564  an be correlated
-0005e6a0: 2074 6f20 6d75 6c74 6970 6c65 2076 6172   to multiple var
-0005e6b0: 6961 626c 6573 2e0d 0a20 2020 2020 546f  iables...     To
-0005e6c0: 2064 6563 6964 6520 7768 6963 6820 7661   decide which va
-0005e6d0: 7269 6162 6c65 7320 746f 206b 6565 7020  riables to keep 
-0005e6e0: 696e 206b 6e6f 636b 6f75 7420 726f 756e  in knockout roun
-0005e6f0: 6473 2c20 6d75 7475 616c 2069 6e66 6f72  ds, mutual infor
-0005e700: 6d61 7469 6f6e 2073 636f 7265 2028 4d49  mation score (MI
-0005e710: 5329 0d0a 2020 2020 2069 7320 7573 6564  S)..     is used
-0005e720: 2e20 4d49 5320 7265 7475 726e 7320 6120  . MIS returns a 
-0005e730: 7261 6e6b 6564 206c 6973 7420 6f66 2063  ranked list of c
-0005e740: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
-0005e750: 6c65 733a 2077 6865 6e20 7765 2073 656c  les: when we sel
-0005e760: 6563 7420 6f6e 6520 746f 0d0a 2020 2020  ect one to..    
-0005e770: 206b 6565 702c 2077 6520 6b6e 6f63 6b20   keep, we knock 
-0005e780: 6f75 7420 616c 6c20 6f74 6865 7273 2074  out all others t
-0005e790: 6861 7420 7765 7265 2068 6967 686c 7920  hat were highly 
-0005e7a0: 636f 7272 656c 6174 6564 2074 6f20 6974  correlated to it
-0005e7b0: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
-0005e7c0: 6f63 6b0d 0a20 2020 2020 6f75 7420 636f  ock..     out co
-0005e7d0: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
-0005e7e0: 6573 2069 6e20 6561 6368 2072 6f75 6e64  es in each round
-0005e7f0: 2e20 496e 2074 6865 2065 6e64 2c20 5355  . In the end, SU
-0005e800: 4c4f 5620 6769 7665 7320 7573 2061 206c  LOV gives us a l
-0005e810: 6973 7420 6f66 206c 6561 7374 0d0a 2020  ist of least..  
-0005e820: 2020 2063 6f72 7265 6c61 7465 6420 7661     correlated va
-0005e830: 7269 6162 6c65 7320 7468 6174 2068 6176  riables that hav
-0005e840: 6520 7468 6520 6265 7374 206d 7574 7561  e the best mutua
-0005e850: 6c20 696e 666f 726d 6174 696f 6e20 7363  l information sc
-0005e860: 6f72 6520 696e 2079 6f75 7220 6461 7461  ore in your data
-0005e870: 2073 6574 210d 0a20 2020 2023 2323 2323   set!..    #####
-0005e880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e8c0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0005e8d0: 2020 2022 2222 0d0a 2020 2020 6466 203d     """..    df =
-0005e8e0: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
-0005e8f0: 6629 0d0a 2020 2020 7072 696e 7428 2752  f)..    print('R
-0005e900: 656d 6f76 696e 6720 6869 6768 6c79 2063  emoving highly c
-0005e910: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
-0005e920: 6c65 7320 7573 696e 6720 5355 4c4f 5620  les using SULOV 
-0005e930: 6d65 7468 6f64 2061 6d6f 6e67 2028 2564  method among (%d
-0005e940: 2920 6e75 6d65 7269 6320 7661 7269 6162  ) numeric variab
-0005e950: 6c65 7327 2025 6c65 6e28 6e75 6d76 6172  les' %len(numvar
-0005e960: 7329 290d 0a20 2020 2063 6f72 7265 6c61  s))..    correla
-0005e970: 7469 6f6e 5f64 6174 6166 7261 6d65 203d  tion_dataframe =
-0005e980: 2064 665b 6e75 6d76 6172 735d 2e63 6f72   df[numvars].cor
-0005e990: 7228 292e 6173 7479 7065 286e 702e 666c  r().astype(np.fl
-0005e9a0: 6f61 7431 3629 0d0a 2020 2020 6120 3d20  oat16)..    a = 
-0005e9b0: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
-0005e9c0: 6672 616d 652e 7661 6c75 6573 0d0a 2020  frame.values..  
-0005e9d0: 2020 636f 6c5f 696e 6465 7820 3d20 636f    col_index = co
-0005e9e0: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
-0005e9f0: 616d 652e 636f 6c75 6d6e 732e 746f 6c69  ame.columns.toli
-0005ea00: 7374 2829 0d0a 2020 2020 696e 6465 785f  st()..    index_
-0005ea10: 7472 6975 7070 6572 203d 206c 6973 7428  triupper = list(
-0005ea20: 7a69 7028 6e70 2e74 7269 755f 696e 6469  zip(np.triu_indi
-0005ea30: 6365 735f 6672 6f6d 2861 2c6b 3d31 295b  ces_from(a,k=1)[
-0005ea40: 305d 2c6e 702e 7472 6975 5f69 6e64 6963  0],np.triu_indic
-0005ea50: 6573 5f66 726f 6d28 612c 6b3d 3129 5b31  es_from(a,k=1)[1
-0005ea60: 5d29 290d 0a20 2020 2068 6967 685f 636f  ]))..    high_co
-0005ea70: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
-0005ea80: 5b78 2066 6f72 2078 2069 6e20 6e70 2e61  [x for x in np.a
-0005ea90: 7267 7768 6572 6528 6162 7328 615b 6e70  rgwhere(abs(a[np
-0005eaa0: 2e74 7269 755f 696e 6469 6365 7328 6c65  .triu_indices(le
-0005eab0: 6e28 6129 2c20 6b20 3d20 3129 5d29 3e3d  n(a), k = 1)])>=
-0005eac0: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
-0005ead0: 2020 6c6f 775f 636f 7272 5f69 6e64 6578    low_corr_index
-0005eae0: 5f6c 6973 7420 3d20 205b 7820 666f 7220  _list =  [x for 
-0005eaf0: 7820 696e 206e 702e 6172 6777 6865 7265  x in np.argwhere
-0005eb00: 2861 6273 2861 5b6e 702e 7472 6975 5f69  (abs(a[np.triu_i
-0005eb10: 6e64 6963 6573 286c 656e 2861 292c 206b  ndices(len(a), k
-0005eb20: 203d 2031 295d 293c 636f 7272 5f6c 696d   = 1)])<corr_lim
-0005eb30: 6974 295d 0d0a 2020 2020 7475 706c 655f  it)]..    tuple_
-0005eb40: 6c69 7374 203d 205b 7920 666f 7220 7920  list = [y for y 
-0005eb50: 696e 205b 696e 6465 785f 7472 6975 7070  in [index_triupp
-0005eb60: 6572 5b78 5b30 5d5d 2066 6f72 2078 2069  er[x[0]] for x i
-0005eb70: 6e20 6869 6768 5f63 6f72 725f 696e 6465  n high_corr_inde
-0005eb80: 785f 6c69 7374 5d5d 0d0a 2020 2020 636f  x_list]]..    co
-0005eb90: 7272 656c 6174 6564 5f70 6169 7220 3d20  rrelated_pair = 
-0005eba0: 5b28 636f 6c5f 696e 6465 785b 7475 706c  [(col_index[tupl
-0005ebb0: 655b 305d 5d2c 636f 6c5f 696e 6465 785b  e[0]],col_index[
-0005ebc0: 7475 706c 655b 315d 5d29 2066 6f72 2074  tuple[1]]) for t
-0005ebd0: 7570 6c65 2069 6e20 7475 706c 655f 6c69  uple in tuple_li
-0005ebe0: 7374 5d0d 0a20 2020 2063 6f72 725f 7061  st]..    corr_pa
-0005ebf0: 6972 5f64 6963 7420 3d20 6469 6374 2872  ir_dict = dict(r
-0005ec00: 6574 7572 6e5f 6469 6374 696f 6e61 7279  eturn_dictionary
-0005ec10: 5f6c 6973 7428 636f 7272 656c 6174 6564  _list(correlated
-0005ec20: 5f70 6169 7229 290d 0a20 2020 206b 6579  _pair))..    key
-0005ec30: 735f 696e 5f64 6963 7420 3d20 6c69 7374  s_in_dict = list
-0005ec40: 2863 6f72 725f 7061 6972 5f64 6963 742e  (corr_pair_dict.
-0005ec50: 6b65 7973 2829 290d 0a20 2020 2072 6576  keys())..    rev
-0005ec60: 6572 7365 5f63 6f72 7265 6c61 7465 645f  erse_correlated_
-0005ec70: 7061 6972 203d 205b 2879 2c78 2920 666f  pair = [(y,x) fo
-0005ec80: 7220 2878 2c79 2920 696e 2063 6f72 7265  r (x,y) in corre
-0005ec90: 6c61 7465 645f 7061 6972 5d0d 0a20 2020  lated_pair]..   
-0005eca0: 2072 6576 6572 7365 5f63 6f72 725f 7061   reverse_corr_pa
-0005ecb0: 6972 5f64 6963 7420 3d20 6469 6374 2872  ir_dict = dict(r
-0005ecc0: 6574 7572 6e5f 6469 6374 696f 6e61 7279  eturn_dictionary
-0005ecd0: 5f6c 6973 7428 7265 7665 7273 655f 636f  _list(reverse_co
-0005ece0: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
-0005ecf0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
-0005ed00: 6c20 696e 2072 6576 6572 7365 5f63 6f72  l in reverse_cor
-0005ed10: 725f 7061 6972 5f64 6963 742e 6974 656d  r_pair_dict.item
-0005ed20: 7328 293a 0d0a 2020 2020 2020 2020 6966  s():..        if
-0005ed30: 206b 6579 2069 6e20 6b65 7973 5f69 6e5f   key in keys_in_
-0005ed40: 6469 6374 3a0d 0a20 2020 2020 2020 2020  dict:..         
-0005ed50: 2020 2069 6620 6c65 6e28 6b65 7929 203e     if len(key) >
-0005ed60: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-0005ed70: 2020 2020 2063 6f72 725f 7061 6972 5f64       corr_pair_d
-0005ed80: 6963 745b 6b65 795d 202b 3d20 7661 6c0d  ict[key] += val.
-0005ed90: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0005eda0: 2020 2020 2020 2020 2020 2020 636f 7272              corr
-0005edb0: 5f70 6169 725f 6469 6374 5b6b 6579 5d20  _pair_dict[key] 
-0005edc0: 3d20 7661 6c0d 0a20 2020 2066 6c61 745f  = val..    flat_
-0005edd0: 636f 7272 5f70 6169 725f 6c69 7374 203d  corr_pair_list =
-0005ede0: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
-0005edf0: 7374 2069 6e20 636f 7272 656c 6174 6564  st in correlated
-0005ee00: 5f70 6169 7220 666f 7220 6974 656d 2069  _pair for item i
-0005ee10: 6e20 7375 626c 6973 745d 0d0a 2020 2020  n sublist]..    
-0005ee20: 2323 2323 2059 6f75 2063 616e 206d 616b  #### You can mak
-0005ee30: 6520 6974 2061 2064 6963 7469 6f6e 6172  e it a dictionar
-0005ee40: 7920 6f72 2061 2074 7570 6c65 206f 6620  y or a tuple of 
-0005ee50: 6c69 7374 732e 2057 6520 6861 7665 2063  lists. We have c
-0005ee60: 686f 7365 6e20 7468 6520 6c61 7474 6572  hosen the latter
-0005ee70: 2068 6572 6520 746f 206b 6565 7020 6f72   here to keep or
-0005ee80: 6465 7220 696e 7461 6374 2e0d 0a20 2020  der intact...   
-0005ee90: 2063 6f72 725f 7061 6972 5f63 6f75 6e74   corr_pair_count
-0005eea0: 5f64 6963 7420 3d20 636f 756e 745f 6672  _dict = count_fr
-0005eeb0: 6571 5f69 6e5f 6c69 7374 2866 6c61 745f  eq_in_list(flat_
-0005eec0: 636f 7272 5f70 6169 725f 6c69 7374 290d  corr_pair_list).
-0005eed0: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
-0005eee0: 205b 6b20 666f 7220 286b 2c76 2920 696e   [k for (k,v) in
-0005eef0: 2063 6f72 725f 7061 6972 5f63 6f75 6e74   corr_pair_count
-0005ef00: 5f64 6963 745d 0d0a 2020 2020 2323 2323  _dict]..    ####
-0005ef10: 2323 2054 6869 7320 6973 2066 6f72 206f  ## This is for o
-0005ef20: 7264 6572 696e 6720 7468 6520 7661 7269  rdering the vari
-0005ef30: 6162 6c65 7320 696e 2074 6865 2068 6967  ables in the hig
-0005ef40: 6865 7374 2074 6f20 6c6f 7765 7374 2069  hest to lowest i
-0005ef50: 6d70 6f72 7461 6e63 6520 746f 2074 6172  mportance to tar
-0005ef60: 6765 7420 2323 230d 0a20 2020 2069 6620  get ###..    if 
-0005ef70: 6c65 6e28 636f 7272 5f6c 6973 7429 203d  len(corr_list) =
-0005ef80: 3d20 303a 0d0a 2020 2020 2020 2020 6669  = 0:..        fi
-0005ef90: 6e61 6c5f 6c69 7374 203d 206c 6973 7428  nal_list = list(
-0005efa0: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
-0005efb0: 6672 616d 6529 0d0a 2020 2020 2020 2020  frame)..        
-0005efc0: 7072 696e 7428 2720 2020 204e 6f20 6e75  print('    No nu
-0005efd0: 6d65 7269 6320 7661 7273 2072 656d 6f76  meric vars remov
-0005efe0: 6564 2073 696e 6365 206e 6f6e 6520 6861  ed since none ha
-0005eff0: 7665 2068 6967 6820 636f 7272 656c 6174  ve high correlat
-0005f000: 696f 6e20 7769 7468 2065 6163 6820 6f74  ion with each ot
-0005f010: 6865 7220 696e 2074 6869 7320 6461 7461  her in this data
-0005f020: 2e2e 2e27 290d 0a20 2020 2065 6c73 653a  ...')..    else:
-0005f030: 0d0a 2020 2020 2020 2020 6d61 785f 6665  ..        max_fe
-0005f040: 6174 7320 3d20 6c65 6e28 636f 7272 5f6c  ats = len(corr_l
-0005f050: 6973 7429 0d0a 2020 2020 2020 2020 6966  ist)..        if
-0005f060: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-0005f070: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-0005f080: 2020 2020 2020 2020 2073 656c 5f66 756e           sel_fun
-0005f090: 6374 696f 6e20 3d20 6d75 7475 616c 5f69  ction = mutual_i
-0005f0a0: 6e66 6f5f 7265 6772 6573 7369 6f6e 0d0a  nfo_regression..
-0005f0b0: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
-0005f0c0: 2053 656c 6563 744b 4265 7374 2873 636f   SelectKBest(sco
-0005f0d0: 7265 5f66 756e 633d 7365 6c5f 6675 6e63  re_func=sel_func
-0005f0e0: 7469 6f6e 2c20 6b3d 6d61 785f 6665 6174  tion, k=max_feat
-0005f0f0: 7329 0d0a 2020 2020 2020 2020 656c 7365  s)..        else
-0005f100: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0005f110: 656c 5f66 756e 6374 696f 6e20 3d20 6d75  el_function = mu
-0005f120: 7475 616c 5f69 6e66 6f5f 636c 6173 7369  tual_info_classi
-0005f130: 660d 0a20 2020 2020 2020 2020 2020 2066  f..            f
-0005f140: 7320 3d20 5365 6c65 6374 4b42 6573 7428  s = SelectKBest(
-0005f150: 7363 6f72 655f 6675 6e63 3d73 656c 5f66  score_func=sel_f
-0005f160: 756e 6374 696f 6e2c 206b 3d6d 6178 5f66  unction, k=max_f
-0005f170: 6561 7473 290d 0a20 2020 2020 2020 2066  eats)..        f
-0005f180: 732e 6669 7428 6466 5b63 6f72 725f 6c69  s.fit(df[corr_li
-0005f190: 7374 5d2e 6173 7479 7065 286e 702e 666c  st].astype(np.fl
-0005f1a0: 6f61 7431 3629 2c20 6466 5b74 6172 6765  oat16), df[targe
-0005f1b0: 745d 290d 0a20 2020 2020 2020 206d 7574  t])..        mut
-0005f1c0: 7561 6c5f 696e 666f 203d 2064 6963 7428  ual_info = dict(
-0005f1d0: 7a69 7028 636f 7272 5f6c 6973 742c 6673  zip(corr_list,fs
-0005f1e0: 2e73 636f 7265 735f 2929 0d0a 2020 2020  .scores_))..    
-0005f1f0: 2020 2020 2323 2323 2054 6865 2066 6972      #### The fir
-0005f200: 7374 2076 6172 6961 626c 6520 696e 206c  st variable in l
-0005f210: 6973 7420 6861 7320 7468 6520 6869 6768  ist has the high
-0005f220: 6573 7420 636f 7272 656c 6174 696f 6e20  est correlation 
-0005f230: 746f 2074 6865 2074 6172 6765 7420 7661  to the target va
-0005f240: 7269 6162 6c65 2023 2323 0d0a 2020 2020  riable ###..    
-0005f250: 2020 2020 736f 7274 6564 5f62 795f 6d75      sorted_by_mu
-0005f260: 7475 616c 5f69 6e66 6f20 3d5b 6b65 7920  tual_info =[key 
-0005f270: 666f 7220 286b 6579 2c76 616c 2920 696e  for (key,val) in
-0005f280: 2073 6f72 7465 6428 6d75 7475 616c 5f69   sorted(mutual_i
-0005f290: 6e66 6f2e 6974 656d 7328 292c 206b 6579  nfo.items(), key
-0005f2a0: 3d6c 616d 6264 6120 6b76 3a20 6b76 5b31  =lambda kv: kv[1
-0005f2b0: 5d2c 7265 7665 7273 653d 5472 7565 295d  ],reverse=True)]
-0005f2c0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
-0005f2d0: 2020 4e6f 7720 7765 2073 656c 6563 7420    Now we select 
-0005f2e0: 7468 6520 6669 6e61 6c20 6c69 7374 206f  the final list o
-0005f2f0: 6620 636f 7272 656c 6174 6564 2076 6172  f correlated var
-0005f300: 6961 626c 6573 2023 2323 2323 2323 2323  iables #########
-0005f310: 2323 0d0a 2020 2020 2020 2020 7365 6c65  ##..        sele
-0005f320: 6374 6564 5f63 6f72 725f 6c69 7374 203d  cted_corr_list =
-0005f330: 205b 5d0d 0a20 2020 2020 2020 2023 2323   []..        ###
-0005f340: 2320 7365 6c65 6374 2065 6163 6820 7661  # select each va
-0005f350: 7269 6162 6c65 2062 7920 7468 6520 6869  riable by the hi
-0005f360: 6768 6573 7420 6d75 7475 616c 2069 6e66  ghest mutual inf
-0005f370: 6f20 616e 6420 7365 6520 7768 6174 2076  o and see what v
-0005f380: 6172 7320 6172 6520 636f 7272 656c 6174  ars are correlat
-0005f390: 6564 2074 6f20 6974 0d0a 2020 2020 2020  ed to it..      
-0005f3a0: 2020 666f 7220 6561 6368 5f63 6f72 725f    for each_corr_
-0005f3b0: 6e61 6d65 2069 6e20 736f 7274 6564 5f62  name in sorted_b
-0005f3c0: 795f 6d75 7475 616c 5f69 6e66 6f3a 0d0a  y_mutual_info:..
-0005f3d0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0005f3e0: 6164 6420 7468 6520 7365 6c65 6374 6564  add the selected
-0005f3f0: 2076 6172 2074 6f20 7468 6520 7365 6c65   var to the sele
-0005f400: 6374 6564 5f63 6f72 725f 6c69 7374 0d0a  cted_corr_list..
-0005f410: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
-0005f420: 6374 6564 5f63 6f72 725f 6c69 7374 2e61  cted_corr_list.a
-0005f430: 7070 656e 6428 6561 6368 5f63 6f72 725f  ppend(each_corr_
-0005f440: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
-0005f450: 2020 2066 6f72 2065 6163 685f 7265 6d6f     for each_remo
-0005f460: 7665 2069 6e20 636f 7272 5f70 6169 725f  ve in corr_pair_
-0005f470: 6469 6374 5b65 6163 685f 636f 7272 5f6e  dict[each_corr_n
-0005f480: 616d 655d 3a0d 0a20 2020 2020 2020 2020  ame]:..         
-0005f490: 2020 2020 2020 2023 2323 2320 4e6f 7720         #### Now 
-0005f4a0: 7265 6d6f 7665 2065 6163 6820 7661 7269  remove each vari
-0005f4b0: 6162 6c65 2074 6861 7420 6973 2068 6967  able that is hig
-0005f4c0: 686c 7920 636f 7272 656c 6174 6564 2074  hly correlated t
-0005f4d0: 6f20 7468 6520 7365 6c65 6374 6564 2076  o the selected v
-0005f4e0: 6172 6961 626c 650d 0a20 2020 2020 2020  ariable..       
-0005f4f0: 2020 2020 2020 2020 2069 6620 6561 6368           if each
-0005f500: 5f72 656d 6f76 6520 696e 2073 6f72 7465  _remove in sorte
-0005f510: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
-0005f520: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0005f530: 2020 2020 2020 2073 6f72 7465 645f 6279         sorted_by
-0005f540: 5f6d 7574 7561 6c5f 696e 666f 2e72 656d  _mutual_info.rem
-0005f550: 6f76 6528 6561 6368 5f72 656d 6f76 6529  ove(each_remove)
-0005f560: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
-0005f570: 4e6f 7720 7765 2063 6f6d 6269 6e65 2074  Now we combine t
-0005f580: 6865 2075 6e63 6f72 7265 6c61 7465 6420  he uncorrelated 
-0005f590: 6c69 7374 2074 6f20 7468 6520 7365 6c65  list to the sele
-0005f5a0: 6374 6564 2063 6f72 7265 6c61 7465 6420  cted correlated 
-0005f5b0: 6c69 7374 2061 626f 7665 0d0a 2020 2020  list above..    
-0005f5c0: 2020 2020 7265 6d5f 636f 6c5f 6c69 7374      rem_col_list
-0005f5d0: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
-0005f5e0: 286c 6973 7428 636f 7272 656c 6174 696f  (list(correlatio
-0005f5f0: 6e5f 6461 7461 6672 616d 6529 2c63 6f72  n_dataframe),cor
-0005f600: 725f 6c69 7374 290d 0a20 2020 2020 2020  r_list)..       
-0005f610: 2066 696e 616c 5f6c 6973 7420 3d20 7265   final_list = re
-0005f620: 6d5f 636f 6c5f 6c69 7374 202b 2073 656c  m_col_list + sel
-0005f630: 6563 7465 645f 636f 7272 5f6c 6973 740d  ected_corr_list.
-0005f640: 0a20 2020 2020 2020 2072 656d 6f76 6564  .        removed
-0005f650: 5f63 6f6c 7320 3d20 6c65 6674 5f73 7562  _cols = left_sub
-0005f660: 7472 6163 7428 6e75 6d76 6172 732c 2066  tract(numvars, f
-0005f670: 696e 616c 5f6c 6973 7429 0d0a 2020 2020  inal_list)..    
-0005f680: 2020 2020 6966 206c 656e 2872 656d 6f76      if len(remov
-0005f690: 6564 5f63 6f6c 7329 203e 2030 3a0d 0a20  ed_cols) > 0:.. 
-0005f6a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0005f6b0: 2827 2020 2020 5265 6d6f 7669 6e67 2028  ('    Removing (
-0005f6c0: 2564 2920 6869 6768 6c79 2063 6f72 7265  %d) highly corre
-0005f6d0: 6c61 7465 6420 7661 7269 6162 6c65 733a  lated variables:
-0005f6e0: 2720 2528 6c65 6e28 7265 6d6f 7665 645f  ' %(len(removed_
-0005f6f0: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
-0005f700: 2020 2020 2069 6620 6c65 6e28 7265 6d6f       if len(remo
-0005f710: 7665 645f 636f 6c73 2920 3c3d 2033 303a  ved_cols) <= 30:
-0005f720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0005f730: 2020 7072 696e 7428 2720 2020 2025 7327    print('    %s'
-0005f740: 2025 7265 6d6f 7665 645f 636f 6c73 290d   %removed_cols).
-0005f750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0005f760: 6c65 6e28 6669 6e61 6c5f 6c69 7374 2920  len(final_list) 
-0005f770: 3c3d 2033 303a 0d0a 2020 2020 2020 2020  <= 30:..        
-0005f780: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0005f790: 2020 2046 6f6c 6c6f 7769 6e67 2028 2564     Following (%d
-0005f7a0: 2920 7661 7273 2073 656c 6563 7465 643a  ) vars selected:
-0005f7b0: 2025 7327 2025 286c 656e 2866 696e 616c   %s' %(len(final
-0005f7c0: 5f6c 6973 7429 2c66 696e 616c 5f6c 6973  _list),final_lis
-0005f7d0: 7429 290d 0a20 2020 2072 6574 7572 6e20  t))..    return 
-0005f7e0: 6669 6e61 6c5f 6c69 7374 0d0a 2323 2323  final_list..####
-0005f7f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f840: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-0005f850: 2063 6f75 6e74 5f66 7265 715f 696e 5f6c   count_freq_in_l
-0005f860: 6973 7428 6c73 7429 3a0d 0a20 2020 2022  ist(lst):..    "
-0005f870: 2222 0d0a 2020 2020 5468 6973 2063 6f75  ""..    This cou
-0005f880: 6e74 7320 7468 6520 6672 6571 7565 6e63  nts the frequenc
-0005f890: 7920 6f66 2069 7465 6d73 2069 6e20 6120  y of items in a 
-0005f8a0: 6c69 7374 2062 7574 204d 4149 4e54 4149  list but MAINTAI
-0005f8b0: 4e53 2074 6865 206f 7264 6572 206f 6620  NS the order of 
-0005f8c0: 6170 7065 6172 616e 6365 206f 6620 6974  appearance of it
-0005f8d0: 656d 732e 0d0a 2020 2020 5468 6973 206f  ems...    This o
-0005f8e0: 7264 6572 2069 7320 7665 7279 2069 6d70  rder is very imp
-0005f8f0: 6f72 7461 6e74 2077 6865 6e20 796f 7520  ortant when you 
-0005f900: 6172 6520 646f 696e 6720 6365 7274 6169  are doing certai
-0005f910: 6e20 6675 6e63 7469 6f6e 732e 2048 656e  n functions. Hen
-0005f920: 6365 2074 6869 7320 6675 6e63 7469 6f6e  ce this function
-0005f930: 210d 0a20 2020 2022 2222 0d0a 2020 2020  !..    """..    
-0005f940: 7465 6d70 3d6e 702e 756e 6971 7565 286c  temp=np.unique(l
-0005f950: 7374 290d 0a20 2020 2072 6573 756c 7420  st)..    result 
-0005f960: 3d20 5b5d 0d0a 2020 2020 666f 7220 6920  = []..    for i 
-0005f970: 696e 2074 656d 703a 0d0a 2020 2020 2020  in temp:..      
-0005f980: 2020 7265 7375 6c74 2e61 7070 656e 6428    result.append(
-0005f990: 2869 2c6c 7374 2e63 6f75 6e74 2869 2929  (i,lst.count(i))
-0005f9a0: 290d 0a20 2020 2072 6574 7572 6e20 7265  )..    return re
-0005f9b0: 7375 6c74 0d0a 0d0a 6465 6620 6669 6e64  sult....def find
-0005f9c0: 5f63 6f72 725f 7661 7273 2863 6f72 7265  _corr_vars(corre
-0005f9d0: 6c61 7469 6f6e 5f64 6174 6166 7261 6d65  lation_dataframe
-0005f9e0: 2c63 6f72 725f 6c69 6d69 7420 3d20 302e  ,corr_limit = 0.
-0005f9f0: 3730 293a 0d0a 2020 2020 2222 220d 0a20  70):..    """.. 
-0005fa00: 2020 2054 6869 7320 7265 7475 726e 7320     This returns 
-0005fa10: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
-0005fa20: 636f 756e 7473 206f 6620 6561 6368 2076  counts of each v
-0005fa30: 6172 6961 626c 6520 616e 6420 686f 7720  ariable and how 
-0005fa40: 6d61 6e79 2076 6172 7320 6974 2069 7320  many vars it is 
-0005fa50: 636f 7272 656c 6174 6564 2074 6f20 696e  correlated to in
-0005fa60: 2074 6865 2064 6174 6166 7261 6d65 0d0a   the dataframe..
-0005fa70: 2020 2020 2222 220d 0a20 2020 2066 6c61      """..    fla
-0005fa80: 7474 656e 203d 206c 616d 6264 6120 6c3a  tten = lambda l:
-0005fa90: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
-0005faa0: 7374 2069 6e20 6c20 666f 7220 6974 656d  st in l for item
-0005fab0: 2069 6e20 7375 626c 6973 745d 0d0a 2020   in sublist]..  
-0005fac0: 2020 666c 6174 7465 6e5f 6974 656d 7320    flatten_items 
-0005fad0: 3d20 6c61 6d62 6461 2064 6963 3a20 5b78  = lambda dic: [x
-0005fae0: 2066 6f72 2078 2069 6e20 6469 632e 6974   for x in dic.it
-0005faf0: 656d 7328 295d 0d0a 2020 2020 6120 3d20  ems()]..    a = 
-0005fb00: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
-0005fb10: 6672 616d 652e 7661 6c75 6573 0d0a 2020  frame.values..  
-0005fb20: 2020 636f 6c5f 696e 6465 7820 3d20 636f    col_index = co
-0005fb30: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
-0005fb40: 616d 652e 636f 6c75 6d6e 732e 746f 6c69  ame.columns.toli
-0005fb50: 7374 2829 0d0a 2020 2020 696e 6465 785f  st()..    index_
-0005fb60: 7472 6975 7070 6572 203d 206c 6973 7428  triupper = list(
-0005fb70: 7a69 7028 6e70 2e74 7269 755f 696e 6469  zip(np.triu_indi
-0005fb80: 6365 735f 6672 6f6d 2861 2c6b 3d31 295b  ces_from(a,k=1)[
-0005fb90: 305d 2c6e 702e 7472 6975 5f69 6e64 6963  0],np.triu_indic
-0005fba0: 6573 5f66 726f 6d28 612c 6b3d 3129 5b31  es_from(a,k=1)[1
-0005fbb0: 5d29 290d 0a20 2020 2068 6967 685f 636f  ]))..    high_co
-0005fbc0: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
-0005fbd0: 5b78 2066 6f72 2078 2069 6e20 6e70 2e61  [x for x in np.a
-0005fbe0: 7267 7768 6572 6528 6162 7328 615b 6e70  rgwhere(abs(a[np
-0005fbf0: 2e74 7269 755f 696e 6469 6365 7328 6c65  .triu_indices(le
-0005fc00: 6e28 6129 2c20 6b20 3d20 3129 5d29 3e3d  n(a), k = 1)])>=
-0005fc10: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
-0005fc20: 2020 6c6f 775f 636f 7272 5f69 6e64 6578    low_corr_index
-0005fc30: 5f6c 6973 7420 3d20 205b 7820 666f 7220  _list =  [x for 
-0005fc40: 7820 696e 206e 702e 6172 6777 6865 7265  x in np.argwhere
-0005fc50: 2861 6273 2861 5b6e 702e 7472 6975 5f69  (abs(a[np.triu_i
-0005fc60: 6e64 6963 6573 286c 656e 2861 292c 206b  ndices(len(a), k
-0005fc70: 203d 2031 295d 293c 636f 7272 5f6c 696d   = 1)])<corr_lim
-0005fc80: 6974 295d 0d0a 2020 2020 7475 706c 655f  it)]..    tuple_
-0005fc90: 6c69 7374 203d 205b 7920 666f 7220 7920  list = [y for y 
-0005fca0: 696e 205b 696e 6465 785f 7472 6975 7070  in [index_triupp
-0005fcb0: 6572 5b78 5b30 5d5d 2066 6f72 2078 2069  er[x[0]] for x i
-0005fcc0: 6e20 6869 6768 5f63 6f72 725f 696e 6465  n high_corr_inde
-0005fcd0: 785f 6c69 7374 5d5d 0d0a 2020 2020 636f  x_list]]..    co
-0005fce0: 7272 656c 6174 6564 5f70 6169 7220 3d20  rrelated_pair = 
-0005fcf0: 5b28 636f 6c5f 696e 6465 785b 7475 706c  [(col_index[tupl
-0005fd00: 655b 305d 5d2c 636f 6c5f 696e 6465 785b  e[0]],col_index[
-0005fd10: 7475 706c 655b 315d 5d29 2066 6f72 2074  tuple[1]]) for t
-0005fd20: 7570 6c65 2069 6e20 7475 706c 655f 6c69  uple in tuple_li
-0005fd30: 7374 5d0d 0a20 2020 2063 6f72 7265 6c61  st]..    correla
-0005fd40: 7465 645f 7061 6972 5f64 6963 7420 3d20  ted_pair_dict = 
-0005fd50: 6469 6374 2863 6f72 7265 6c61 7465 645f  dict(correlated_
-0005fd60: 7061 6972 290d 0a20 2020 2066 6c61 745f  pair)..    flat_
-0005fd70: 636f 7272 5f70 6169 725f 6c69 7374 203d  corr_pair_list =
-0005fd80: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
-0005fd90: 7374 2069 6e20 636f 7272 656c 6174 6564  st in correlated
-0005fda0: 5f70 6169 7220 666f 7220 6974 656d 2069  _pair for item i
-0005fdb0: 6e20 7375 626c 6973 745d 0d0a 2020 2020  n sublist]..    
-0005fdc0: 2323 2323 2059 6f75 2063 616e 206d 616b  #### You can mak
-0005fdd0: 6520 6974 2061 2064 6963 7469 6f6e 6172  e it a dictionar
-0005fde0: 7920 6f72 2061 2074 7570 6c65 206f 6620  y or a tuple of 
-0005fdf0: 6c69 7374 732e 2057 6520 6861 7665 2063  lists. We have c
-0005fe00: 686f 7365 6e20 7468 6520 6c61 7474 6572  hosen the latter
-0005fe10: 2068 6572 6520 746f 206b 6565 7020 6f72   here to keep or
-0005fe20: 6465 7220 696e 7461 6374 2e0d 0a20 2020  der intact...   
-0005fe30: 2023 636f 7272 5f70 6169 725f 636f 756e   #corr_pair_coun
-0005fe40: 745f 6469 6374 203d 2043 6f75 6e74 6572  t_dict = Counter
-0005fe50: 2866 6c61 745f 636f 7272 5f70 6169 725f  (flat_corr_pair_
-0005fe60: 6c69 7374 290d 0a20 2020 2063 6f72 725f  list)..    corr_
-0005fe70: 7061 6972 5f63 6f75 6e74 5f64 6963 7420  pair_count_dict 
-0005fe80: 3d20 636f 756e 745f 6672 6571 5f69 6e5f  = count_freq_in_
-0005fe90: 6c69 7374 2866 6c61 745f 636f 7272 5f70  list(flat_corr_p
-0005fea0: 6169 725f 6c69 7374 290d 0a20 2020 2063  air_list)..    c
-0005feb0: 6f72 725f 6c69 7374 203d 206c 6973 7428  orr_list = list(
-0005fec0: 7365 7428 666c 6174 7465 6e28 666c 6174  set(flatten(flat
-0005fed0: 7465 6e5f 6974 656d 7328 636f 7272 656c  ten_items(correl
-0005fee0: 6174 6564 5f70 6169 725f 6469 6374 2929  ated_pair_dict))
-0005fef0: 2929 0d0a 2020 2020 7265 6d5f 636f 6c5f  ))..    rem_col_
-0005ff00: 6c69 7374 203d 206c 6566 745f 7375 6274  list = left_subt
-0005ff10: 7261 6374 286c 6973 7428 636f 7272 656c  ract(list(correl
-0005ff20: 6174 696f 6e5f 6461 7461 6672 616d 6529  ation_dataframe)
-0005ff30: 2c6c 6973 7428 4f72 6465 7265 6444 6963  ,list(OrderedDic
-0005ff40: 742e 6672 6f6d 6b65 7973 2866 6c61 745f  t.fromkeys(flat_
-0005ff50: 636f 7272 5f70 6169 725f 6c69 7374 2929  corr_pair_list))
-0005ff60: 290d 0a20 2020 2072 6574 7572 6e20 636f  )..    return co
-0005ff70: 7272 5f70 6169 725f 636f 756e 745f 6469  rr_pair_count_di
-0005ff80: 6374 2c20 7265 6d5f 636f 6c5f 6c69 7374  ct, rem_col_list
-0005ff90: 2c20 636f 7272 5f6c 6973 742c 2063 6f72  , corr_list, cor
-0005ffa0: 7265 6c61 7465 645f 7061 6972 5f64 6963  related_pair_dic
-0005ffb0: 740d 0a23 2323 2323 2323 2323 2323 2323  t..#############
-0005ffc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ffd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ffe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005fff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060000: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
-00060010: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
-00060020: 6d70 6f72 7420 4c6f 6769 7374 6963 5265  mport LogisticRe
-00060030: 6772 6573 7369 6f6e 0d0a 6672 6f6d 2073  gression..from s
-00060040: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
-00060050: 7369 6e67 2069 6d70 6f72 7420 5374 616e  sing import Stan
-00060060: 6461 7264 5363 616c 6572 0d0a 6672 6f6d  dardScaler..from
-00060070: 2073 6b6c 6561 726e 2e6c 696e 6561 725f   sklearn.linear_
-00060080: 6d6f 6465 6c20 696d 706f 7274 204c 6173  model import Las
-00060090: 736f 0d0a 6672 6f6d 2073 6b6c 6561 726e  so..from sklearn
-000600a0: 2e70 7265 7072 6f63 6573 7369 6e67 2069  .preprocessing i
-000600b0: 6d70 6f72 7420 506f 6c79 6e6f 6d69 616c  mport Polynomial
-000600c0: 4665 6174 7572 6573 0d0a 6672 6f6d 2073  Features..from s
-000600d0: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
-000600e0: 6563 7469 6f6e 2069 6d70 6f72 7420 4772  ection import Gr
-000600f0: 6964 5365 6172 6368 4356 0d0a 696d 706f  idSearchCV..impo
-00060100: 7274 2073 6b6c 6561 726e 0d0a 6672 6f6d  rt sklearn..from
-00060110: 2064 6973 7475 7469 6c73 2e76 6572 7369   distutils.versi
-00060120: 6f6e 2069 6d70 6f72 7420 4c6f 6f73 6556  on import LooseV
-00060130: 6572 7369 6f6e 0d0a 0d0a 6465 6620 6164  ersion....def ad
-00060140: 645f 706f 6c79 5f76 6172 735f 7365 6c65  d_poly_vars_sele
-00060150: 6374 2864 6174 612c 6e75 6d76 6172 732c  ct(data,numvars,
-00060160: 7461 7267 6574 7661 722c 6d6f 6465 6c74  targetvar,modelt
-00060170: 7970 652c 706f 6c79 5f64 6567 7265 653d  ype,poly_degree=
-00060180: 322c 4164 645f 506f 6c79 3d32 2c6d 643d  2,Add_Poly=2,md=
-00060190: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
-000601a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000601b0: 2063 6f72 725f 6c69 6d69 743d 302e 3730   corr_limit=0.70
-000601c0: 2c73 6361 6c69 6e67 3d54 7275 652c 2066  ,scaling=True, f
-000601d0: 6974 5f66 6c61 673d 4661 6c73 652c 2076  it_flag=False, v
-000601e0: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
-000601f0: 2222 220d 0a20 2020 2023 2323 2320 5468  """..    #### Th
-00060200: 6973 2061 6464 7320 506f 6c79 6e6f 6d69  is adds Polynomi
-00060210: 616c 2061 6e64 2049 6e74 6572 6163 7469  al and Interacti
-00060220: 6f6e 2056 6172 6961 626c 6573 206f 6620  on Variables of 
-00060230: 616e 7920 5369 7a65 2074 6f20 6120 6461  any Size to a da
-00060240: 7461 2073 6574 2061 6e64 2072 6574 7572  ta set and retur
-00060250: 6e73 2074 6865 2062 6573 7420 7661 7273  ns the best vars
-00060260: 0d0a 2020 2020 616d 6f6e 6720 7468 6f73  ..    among thos
-00060270: 6520 706f 6c79 2061 6e64 2069 6e74 6572  e poly and inter
-00060280: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
-00060290: 2e20 4e6f 7469 6365 2079 6f75 2077 696c  . Notice you wil
-000602a0: 6c20 6765 7420 6120 6c69 7374 206f 6620  l get a list of 
-000602b0: 7661 7269 6162 6c65 7320 6173 2077 656c  variables as wel
-000602c0: 6c20 6173 2074 6865 206d 6f64 6966 6965  l as the modifie
-000602d0: 640d 0a20 2020 2064 6174 6120 7365 7420  d..    data set 
-000602e0: 7769 7468 2074 6865 206f 6c64 2061 6e64  with the old and
-000602f0: 206e 6577 2028 6164 6465 6429 2076 6172   new (added) var
-00060300: 6961 626c 6573 2e20 5665 7279 2043 6f6e  iables. Very Con
-00060310: 7665 6e69 656e 7420 7768 656e 2079 6f75  venient when you
-00060320: 2077 616e 7420 746f 2064 6f20 7175 6963   want to do quic
-00060330: 6b20 7465 7374 696e 672e 0d0a 2020 2020  k testing...    
-00060340: 5468 6572 6520 6172 6520 3320 7365 7474  There are 3 sett
-00060350: 696e 6773 2066 6f72 2041 6464 5f50 6f6c  ings for Add_Pol
-00060360: 7920 666c 6167 3a20 3020 3d3e 204e 6f20  y flag: 0 => No 
-00060370: 706f 6c79 206f 7220 696e 7478 6e20 7661  poly or intxn va
-00060380: 7269 6162 6c65 7320 6164 6465 642e 2031  riables added. 1
-00060390: 3d3e 204f 6e6c 7920 696e 7478 6e20 7661  => Only intxn va
-000603a0: 7273 0d0a 2020 2020 6164 6465 642e 2032  rs..    added. 2
-000603b0: 3d3e 206f 6e6c 7920 706f 6c79 6e6f 6d69  => only polynomi
-000603c0: 616c 2064 6567 7265 6520 2873 7175 6172  al degree (squar
-000603d0: 6564 2920 7661 7273 2061 6464 6564 2e20  ed) vars added. 
-000603e0: 333d 3e20 626f 7468 2073 7175 6172 6564  3=> both squared
-000603f0: 2061 6e64 2069 6e74 786e 2076 6172 7320   and intxn vars 
-00060400: 6164 6465 642e 0d0a 2020 2020 4966 2046  added...    If F
-00060410: 6974 5f46 6c61 673d 5472 7565 2c20 7468  it_Flag=True, th
-00060420: 656e 2069 7420 6973 2061 7373 756d 6564  en it is assumed
-00060430: 2074 6861 7420 6974 2069 7320 5472 6169   that it is Trai
-00060440: 6e69 6e67 2064 6174 6120 616e 6420 6865  ning data and he
-00060450: 6e63 6520 7661 7269 6162 6c65 7320 6172  nce variables ar
-00060460: 6520 7365 6c65 6374 6564 0d0a 2020 2020  e selected..    
-00060470: 4966 2046 6974 5f46 6c61 673d 4661 6c73  If Fit_Flag=Fals
-00060480: 652c 2074 6865 6e20 6974 2069 7320 6173  e, then it is as
-00060490: 7375 6d65 6420 6974 2069 7320 5465 7374  sumed it is Test
-000604a0: 2064 6174 6120 616e 6420 6e6f 2076 6172   data and no var
-000604b0: 6961 626c 6573 2061 7265 2063 686f 7365  iables are chose
-000604c0: 6e20 6275 7420 7765 206b 6565 7020 7472  n but we keep tr
-000604d0: 6169 6e69 6e67 206f 6e65 732e 0d0a 2020  aining ones...  
-000604e0: 2020 2222 220d 0a20 2020 2064 6174 6120    """..    data 
-000604f0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00060500: 6461 7461 290d 0a20 2020 206e 756d 7661  data)..    numva
-00060510: 7273 203d 2063 6f70 792e 6465 6570 636f  rs = copy.deepco
-00060520: 7079 286e 756d 7661 7273 290d 0a20 2020  py(numvars)..   
-00060530: 2074 6f6c 6572 616e 6365 203d 2030 2e30   tolerance = 0.0
-00060540: 310d 0a20 2020 206f 7269 675f 6461 7461  1..    orig_data
-00060550: 5f69 6e64 6578 203d 2064 6174 612e 696e  _index = data.in
-00060560: 6465 780d 0a20 2020 2069 6620 6d6f 6465  dex..    if mode
-00060570: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-00060580: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-00060590: 6c6d 203d 204c 6173 736f 2861 6c70 6861  lm = Lasso(alpha
-000605a0: 3d30 2e30 3031 2c20 6d61 785f 6974 6572  =0.001, max_iter
-000605b0: 3d32 3030 302c 0d0a 2020 2020 2020 2020  =2000,..        
-000605c0: 2020 2020 2020 2020 2066 6974 5f69 6e74           fit_int
-000605d0: 6572 6365 7074 3d54 7275 6529 0d0a 2020  ercept=True)..  
-000605e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000605f0: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
-00060600: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
-00060610: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
-00060620: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
-00060630: 7374 6963 5265 6772 6573 7369 6f6e 2843  sticRegression(C
-00060640: 3d30 2e30 312c 6669 745f 696e 7465 7263  =0.01,fit_interc
-00060650: 6570 743d 5472 7565 2c74 6f6c 3d74 6f6c  ept=True,tol=tol
-00060660: 6572 616e 6365 2c0d 0a20 2020 2020 2020  erance,..       
-00060670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060680: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
-00060690: 723d 3230 3030 2c73 6f6c 7665 723d 276c  r=2000,solver='l
-000606a0: 6962 6c69 6e65 6172 272c 6e5f 6a6f 6273  iblinear',n_jobs
-000606b0: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
-000606c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000606d0: 2020 2020 7065 6e61 6c74 793d 276c 3227      penalty='l2'
-000606e0: 2c64 7561 6c3d 4661 6c73 652c 2072 616e  ,dual=False, ran
-000606f0: 646f 6d5f 7374 6174 653d 3029 0d0a 2020  dom_state=0)..  
-00060700: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00060710: 2020 2020 2020 2020 206c 6d20 3d20 4c6f           lm = Lo
-00060720: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
-00060730: 286d 756c 7469 5f63 6c61 7373 3d27 6f76  (multi_class='ov
-00060740: 7227 2c20 6d61 785f 6974 6572 3d31 3030  r', max_iter=100
-00060750: 3030 2920 2323 206c 6f67 6973 7469 6320  00) ## logistic 
-00060760: 7365 656d 7320 6265 7374 2061 6d6f 6e67  seems best among
-00060770: 2061 6c6c 0d0a 2020 2020 7072 6564 6963   all..    predic
-00060780: 746f 7273 203d 2063 6f70 792e 6465 6570  tors = copy.deep
-00060790: 636f 7079 286e 756d 7661 7273 290d 0a20  copy(numvars).. 
-000607a0: 2020 2023 2323 2320 6e75 6d62 6572 206f     #### number o
-000607b0: 6620 6f72 6967 696e 616c 2066 6561 7475  f original featu
-000607c0: 7265 7320 696e 2064 6174 6120 7365 7420  res in data set 
-000607d0: 2323 2323 0d0a 2020 2020 6e5f 6f72 6967  ####..    n_orig
-000607e0: 5f66 6561 7475 7265 7320 3d20 6c65 6e28  _features = len(
-000607f0: 7072 6564 6963 746f 7273 290d 0a20 2020  predictors)..   
-00060800: 2073 656c 6563 7465 6420 3d20 5b5d 0d0a   selected = []..
-00060810: 2020 2020 585f 6461 7461 203d 2064 6174      X_data = dat
-00060820: 615b 7072 6564 6963 746f 7273 5d0d 0a20  a[predictors].. 
-00060830: 2020 2023 2323 2323 2323 2020 496e 6974     #######  Init
-00060840: 6961 6c20 4d6f 6465 6c20 7769 7468 2061  ial Model with a
-00060850: 6c6c 2069 6e70 7574 2076 6172 6961 626c  ll input variabl
-00060860: 6573 2023 2323 2323 230d 0a20 2020 2069  es ######..    i
-00060870: 6620 7363 616c 696e 6720 3d3d 2027 5374  f scaling == 'St
-00060880: 616e 6461 7264 273a 0d0a 2020 2020 2020  andard':..      
-00060890: 2020 5853 203d 2053 7461 6e64 6172 6453    XS = StandardS
-000608a0: 6361 6c65 7228 292e 6669 745f 7472 616e  caler().fit_tran
-000608b0: 7366 6f72 6d28 585f 6461 7461 290d 0a20  sform(X_data).. 
-000608c0: 2020 2065 6c69 6620 7363 616c 696e 6720     elif scaling 
-000608d0: 3d3d 2027 4d69 6e4d 6178 273a 0d0a 2020  == 'MinMax':..  
-000608e0: 2020 2020 2020 5853 203d 204d 696e 4d61        XS = MinMa
-000608f0: 7853 6361 6c65 7228 292e 6669 745f 7472  xScaler().fit_tr
-00060900: 616e 7366 6f72 6d28 585f 6461 7461 290d  ansform(X_data).
-00060910: 0a20 2020 2023 2323 2020 6f72 2079 6f75  .    ###  or you
-00060920: 2063 616e 2075 7365 2043 656e 7465 7269   can use Centeri
-00060930: 6e67 2077 6869 6368 2073 696d 706c 7920  ng which simply 
-00060940: 7375 6274 7261 6374 7320 7468 6520 4d65  subtracts the Me
-00060950: 616e 3a0d 0a20 2020 2065 6c69 6620 7363  an:..    elif sc
-00060960: 616c 696e 6720 3d3d 2027 4365 6e74 6572  aling == 'Center
-00060970: 696e 6727 3a0d 0a20 2020 2020 2020 2058  ing':..        X
-00060980: 5320 3d20 2858 5f64 6174 612d 585f 6461  S = (X_data-X_da
-00060990: 7461 2e6d 6561 6e28 2929 0d0a 2020 2020  ta.mean())..    
-000609a0: 656c 7365 3a0d 0a20 2020 2020 2020 2058  else:..        X
-000609b0: 5320 3d20 636f 7079 2e64 6565 7063 6f70  S = copy.deepcop
-000609c0: 7928 585f 6461 7461 290d 0a20 2020 2023  y(X_data)..    #
-000609d0: 5853 2e63 6f6c 756d 6e73 3d70 7265 6469  XS.columns=predi
-000609e0: 6374 6f72 730d 0a20 2020 2058 203d 2063  ctors..    X = c
-000609f0: 6f70 792e 6465 6570 636f 7079 2858 5329  opy.deepcopy(XS)
-00060a00: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-00060a10: 2323 2323 2323 2323 2046 6974 2074 6865  ######## Fit the
-00060a20: 206d 6f64 656c 2061 6674 6572 2073 6361   model after sca
-00060a30: 6c69 6e67 2064 6174 6120 2323 2323 2323  ling data ######
-00060a40: 2323 2323 2323 2323 230d 0a20 2020 2069  #########..    i
-00060a50: 6620 6669 745f 666c 6167 3a0d 0a20 2020  f fit_flag:..   
-00060a60: 2020 2020 2059 203d 2064 6174 615b 7461       Y = data[ta
-00060a70: 7267 6574 7661 725d 0d0a 2020 2020 2020  rgetvar]..      
-00060a80: 2020 7072 696e 7428 2742 7569 6c64 696e    print('Buildin
-00060a90: 6720 496e 6974 616c 204d 6f64 656c 2077  g Inital Model w
-00060aa0: 6974 6820 6769 7665 6e20 7661 7269 6162  ith given variab
-00060ab0: 6c65 732e 2e2e 2729 0d0a 2020 2020 2020  les...')..      
-00060ac0: 2020 7072 696e 745f 6d6f 6465 6c5f 6d65    print_model_me
-00060ad0: 7472 6963 7328 6d6f 6465 6c74 7970 652c  trics(modeltype,
-00060ae0: 6c6d 2c58 2c59 2c46 616c 7365 290d 0a20  lm,X,Y,False).. 
-00060af0: 2020 2023 2323 2323 2323 2320 4865 7265     ######## Here
-00060b00: 2069 7320 7768 6572 6520 7468 6520 496e   is where the In
-00060b10: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
-00060b20: 6c65 2073 656c 6563 7469 6f6e 2062 6567  le selection beg
-00060b30: 696e 7320 2323 2323 2323 2323 2323 2323  ins ############
-00060b40: 0d0a 2020 2020 2370 7269 6e74 2827 4164  ..    #print('Ad
-00060b50: 6469 6e67 2050 6f6c 796e 6f6d 6961 6c20  ding Polynomial 
-00060b60: 2573 2d64 6567 7265 6520 616e 6420 496e  %s-degree and In
-00060b70: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
-00060b80: 6c65 732e 2e2e 2720 2570 6f6c 795f 6465  les...' %poly_de
-00060b90: 6772 6565 290d 0a20 2020 2069 6620 4164  gree)..    if Ad
-00060ba0: 645f 506f 6c79 203d 3d20 313a 0d0a 2020  d_Poly == 1:..  
-00060bb0: 2020 2020 2020 2323 2320 4966 2069 7420        ### If it 
-00060bc0: 6973 2031 2c20 6164 6420 6f6e 6c79 2049  is 1, add only I
-00060bd0: 6e74 6572 6163 7469 6f6e 2076 6172 6961  nteraction varia
-00060be0: 626c 6573 2e0d 0a20 2020 2020 2020 2070  bles...        p
-00060bf0: 6f6c 7920 3d20 506f 6c79 6e6f 6d69 616c  oly = Polynomial
-00060c00: 4665 6174 7572 6573 2864 6567 7265 653d  Features(degree=
-00060c10: 706f 6c79 5f64 6567 7265 652c 2069 6e63  poly_degree, inc
-00060c20: 6c75 6465 5f62 6961 7320 3d20 4661 6c73  lude_bias = Fals
-00060c30: 652c 2069 6e74 6572 6163 7469 6f6e 5f6f  e, interaction_o
-00060c40: 6e6c 793d 5472 7565 290d 0a20 2020 2065  nly=True)..    e
-00060c50: 6c69 6620 4164 645f 506f 6c79 203d 3d20  lif Add_Poly == 
-00060c60: 323a 0d0a 2020 2020 2020 2020 2323 2323  2:..        ####
-00060c70: 2049 6620 6974 2069 7320 3220 6f72 2033   If it is 2 or 3
-00060c80: 2061 6464 2062 6f74 6820 5371 7561 7265   add both Square
-00060c90: 6420 616e 6420 496e 7465 7261 6374 696f  d and Interactio
-00060ca0: 6e20 7661 7269 6162 6c65 732e 2057 6520  n variables. We 
-00060cb0: 7769 6c6c 2072 656d 6f76 6520 696e 7465  will remove inte
-00060cc0: 7261 6374 696f 6e0d 0a20 2020 2020 2020  raction..       
-00060cd0: 2023 2323 2020 2020 2020 2076 6172 6961   ###       varia
-00060ce0: 626c 6573 206c 6174 6572 2069 6e20 7468  bles later in th
-00060cf0: 6973 2070 726f 6772 616d 2e20 466f 7220  is program. For 
-00060d00: 6e6f 7720 696e 636c 7564 6520 626f 7468  now include both
-00060d10: 210d 0a20 2020 2020 2020 2070 6f6c 7920  !..        poly 
-00060d20: 3d20 506f 6c79 6e6f 6d69 616c 4665 6174  = PolynomialFeat
-00060d30: 7572 6573 2864 6567 7265 653d 706f 6c79  ures(degree=poly
-00060d40: 5f64 6567 7265 652c 2069 6e63 6c75 6465  _degree, include
-00060d50: 5f62 6961 7320 3d20 4661 6c73 652c 2069  _bias = False, i
-00060d60: 6e74 6572 6163 7469 6f6e 5f6f 6e6c 793d  nteraction_only=
-00060d70: 4661 6c73 6529 0d0a 2020 2020 656c 6966  False)..    elif
-00060d80: 2041 6464 5f50 6f6c 7920 3d3d 2033 3a0d   Add_Poly == 3:.
-00060d90: 0a20 2020 2020 2020 2023 2323 2320 4966  .        #### If
-00060da0: 2069 7420 6973 2032 206f 7220 3320 6164   it is 2 or 3 ad
-00060db0: 6420 626f 7468 2053 7175 6172 6564 2061  d both Squared a
-00060dc0: 6e64 2049 6e74 6572 6163 7469 6f6e 2076  nd Interaction v
-00060dd0: 6172 6961 626c 6573 2e20 5765 2077 696c  ariables. We wil
-00060de0: 6c20 7265 6d6f 7665 2069 6e74 6572 6163  l remove interac
-00060df0: 7469 6f6e 0d0a 2020 2020 2020 2020 2323  tion..        ##
-00060e00: 2320 2020 2020 2020 7661 7269 6162 6c65  #       variable
-00060e10: 7320 6c61 7465 7220 696e 2074 6869 7320  s later in this 
-00060e20: 7072 6f67 7261 6d2e 2046 6f72 206e 6f77  program. For now
-00060e30: 2069 6e63 6c75 6465 2062 6f74 6821 0d0a   include both!..
-00060e40: 2020 2020 2020 2020 706f 6c79 203d 2050          poly = P
-00060e50: 6f6c 796e 6f6d 6961 6c46 6561 7475 7265  olynomialFeature
-00060e60: 7328 6465 6772 6565 3d70 6f6c 795f 6465  s(degree=poly_de
-00060e70: 6772 6565 2c20 696e 636c 7564 655f 6269  gree, include_bi
-00060e80: 6173 203d 2046 616c 7365 2c20 696e 7465  as = False, inte
-00060e90: 7261 6374 696f 6e5f 6f6e 6c79 3d46 616c  raction_only=Fal
-00060ea0: 7365 290d 0a20 2020 2069 6620 6669 745f  se)..    if fit_
-00060eb0: 666c 6167 3a0d 0a20 2020 2020 2020 206d  flag:..        m
-00060ec0: 6420 3d20 706f 6c79 2e66 6974 2858 2920  d = poly.fit(X) 
-00060ed0: 2323 2323 2054 6869 7320 6465 6669 6e65  #### This define
-00060ee0: 7320 7468 6520 506f 6c79 6e6f 6d69 616c  s the Polynomial
-00060ef0: 2066 6561 7475 7265 2065 7874 7261 6374   feature extract
-00060f00: 696f 6e0d 0a20 2020 2074 7279 3a0d 0a20  ion..    try:.. 
-00060f10: 2020 2020 2020 2058 5020 3d20 6d64 2e74         XP = md.t
-00060f20: 7261 6e73 666f 726d 2858 2920 2323 2323  ransform(X) ####
-00060f30: 2054 6869 7320 7472 616e 7366 6f72 6d73   This transforms
-00060f40: 2058 2069 6e74 6f20 6120 506f 6c79 6e6f   X into a Polyno
-00060f50: 6d69 616c 204f 7264 6572 0d0a 2020 2020  mial Order..    
-00060f60: 6578 6365 7074 204d 656d 6f72 7945 7272  except MemoryErr
-00060f70: 6f72 3a0d 0a20 2020 2020 2020 2072 6574  or:..        ret
-00060f80: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
-00060f90: 2727 2c20 582c 206d 642c 205b 5d2c 2064  '', X, md, [], d
-00060fa0: 6963 7428 290d 0a20 2020 2023 2323 2323  ict()..    #####
-00060fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060ff0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00061000: 2020 2323 2323 2320 2020 434f 4e56 4552    #####   CONVER
-00061010: 5420 582d 5641 5249 4142 4c45 5320 4652  T X-VARIABLES FR
-00061020: 4f4d 2050 4f4c 5920 414e 4420 494e 5445  OM POLY AND INTE
-00061030: 5241 4354 494f 4e20 494e 544f 204f 5249  RACTION INTO ORI
-00061040: 4749 4e41 4c20 5641 5249 4142 4c45 5320  GINAL VARIABLES 
-00061050: 2323 230d 0a20 2020 2023 2323 2323 2323  ###..    #######
-00061060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000610a0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-000610b0: 6966 204c 6f6f 7365 5665 7273 696f 6e28  if LooseVersion(
-000610c0: 736b 6c65 6172 6e2e 5f5f 7665 7273 696f  sklearn.__versio
-000610d0: 6e5f 5f29 203c 204c 6f6f 7365 5665 7273  n__) < LooseVers
-000610e0: 696f 6e28 2730 2e32 342e 3227 293a 0d0a  ion('0.24.2'):..
-000610f0: 2020 2020 2020 2020 2320 5065 7266 6f72          # Perfor
-00061100: 6d20 6163 7469 6f6e 2066 6f72 2073 6369  m action for sci
-00061110: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
-00061120: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
-00061130: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
-00061140: 6572 666f 726d 696e 6720 6163 7469 6f6e  erforming action
-00061150: 2066 6f72 2073 6369 6b69 742d 6c65 6172   for scikit-lear
-00061160: 6e20 7665 7273 696f 6e20 6265 6c6f 7720  n version below 
-00061170: 302e 3234 2e32 2229 0d0a 2020 2020 2020  0.24.2")..      
-00061180: 2020 2320 4164 6420 796f 7572 2063 6f64    # Add your cod
-00061190: 6520 6865 7265 2066 6f72 2073 6369 6b69  e here for sciki
-000611a0: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
-000611b0: 6265 6c6f 7720 302e 3234 2e32 0d0a 2020  below 0.24.2..  
-000611c0: 2020 2020 2020 786e 616d 6573 203d 206d        xnames = m
-000611d0: 642e 6765 745f 6665 6174 7572 655f 6e61  d.get_feature_na
-000611e0: 6d65 7328 290d 0a20 2020 2065 6c73 653a  mes()..    else:
-000611f0: 0d0a 2020 2020 2020 2020 2320 5065 7266  ..        # Perf
-00061200: 6f72 6d20 6163 7469 6f6e 2066 6f72 2073  orm action for s
-00061210: 6369 6b69 742d 6c65 6172 6e20 7665 7273  cikit-learn vers
-00061220: 696f 6e20 302e 3234 2e32 2061 6e64 2061  ion 0.24.2 and a
-00061230: 626f 7665 0d0a 2020 2020 2020 2020 7072  bove..        pr
-00061240: 696e 7428 2250 6572 666f 726d 696e 6720  int("Performing 
-00061250: 6163 7469 6f6e 2066 6f72 2073 6369 6b69  action for sciki
-00061260: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
-00061270: 302e 3234 2e32 2061 6e64 2061 626f 7665  0.24.2 and above
-00061280: 2229 0d0a 2020 2020 2020 2020 2320 4164  ")..        # Ad
-00061290: 6420 796f 7572 2063 6f64 6520 6865 7265  d your code here
-000612a0: 2066 6f72 2073 6369 6b69 742d 6c65 6172   for scikit-lear
-000612b0: 6e20 7665 7273 696f 6e20 302e 3234 2e32  n version 0.24.2
-000612c0: 2061 6e64 2061 626f 7665 0d0a 2020 2020   and above..    
-000612d0: 2020 2020 786e 616d 6573 203d 206d 642e      xnames = md.
-000612e0: 6765 745f 6665 6174 7572 655f 6e61 6d65  get_feature_name
-000612f0: 735f 6f75 7428 292e 746f 6c69 7374 2829  s_out().tolist()
-00061300: 2023 2323 2078 6e61 6d65 7320 636f 6e74   ### xnames cont
-00061310: 6169 6e73 2061 6c6c 2078 2d6f 6e6c 792c  ains all x-only,
-00061320: 2050 6f6c 7920 616e 6420 496e 7478 6e20   Poly and Intxn 
-00061330: 7661 7269 6162 6c65 7320 696e 2078 2d66  variables in x-f
-00061340: 6f72 6d61 740d 0a20 2020 2020 2020 200d  ormat..        .
-00061350: 0a20 2020 2069 6620 6c65 6e28 786e 616d  .    if len(xnam
-00061360: 6573 2920 3e20 3330 303a 0d0a 2020 2020  es) > 300:..    
-00061370: 2020 2020 6d61 785f 6974 6572 203d 2035      max_iter = 5
-00061380: 3030 300d 0a20 2020 2065 6c73 653a 0d0a  000..    else:..
-00061390: 2020 2020 2020 2020 6d61 785f 6974 6572          max_iter
-000613a0: 203d 2032 3030 300d 0a20 2020 2023 2323   = 2000..    ###
-000613b0: 2323 2320 4255 494c 4449 4e47 2043 4f4d  ### BUILDING COM
-000613c0: 5041 5249 534f 4e20 4d4f 4445 4c20 5749  PARISON MODEL WI
-000613d0: 5448 2049 4e54 4552 4143 5449 4f4e 2056  TH INTERACTION V
-000613e0: 4152 4941 424c 4553 2023 2323 2323 2323  ARIABLES #######
-000613f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061400: 230d 0a20 2020 2073 7461 7274 5f74 696d  #..    start_tim
-00061410: 6520 3d20 7469 6d65 2e74 696d 6528 290d  e = time.time().
-00061420: 0a20 2020 2069 6620 6d6f 6465 6c74 7970  .    if modeltyp
-00061430: 6520 3d3d 2027 5265 6772 6573 7369 6f6e  e == 'Regression
-00061440: 273a 0d0a 2020 2020 2020 2020 6c6d 203d  ':..        lm =
-00061450: 204c 6173 736f 2861 6c70 6861 3d30 2e30   Lasso(alpha=0.0
-00061460: 3031 2c20 6d61 785f 6974 6572 3d6d 6178  01, max_iter=max
-00061470: 5f69 7465 722c 0d0a 2020 2020 2020 2020  _iter,..        
-00061480: 2020 2020 2020 2020 2066 6974 5f69 6e74           fit_int
-00061490: 6572 6365 7074 3d54 7275 6529 0d0a 2020  ercept=True)..  
-000614a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000614b0: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
-000614c0: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
-000614d0: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
-000614e0: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
-000614f0: 7374 6963 5265 6772 6573 7369 6f6e 2843  sticRegression(C
-00061500: 3d30 2e30 312c 6669 745f 696e 7465 7263  =0.01,fit_interc
-00061510: 6570 743d 5472 7565 2c20 746f 6c3d 746f  ept=True, tol=to
-00061520: 6c65 7261 6e63 652c 0d0a 2020 2020 2020  lerance,..      
-00061530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061540: 2020 2020 2020 6d61 785f 6974 6572 3d6d        max_iter=m
-00061550: 6178 5f69 7465 722c 736f 6c76 6572 3d27  ax_iter,solver='
-00061560: 6c69 626c 696e 6561 7227 2c6e 5f6a 6f62  liblinear',n_job
-00061570: 733d 2d31 2c0d 0a20 2020 2020 2020 2020  s=-1,..         
-00061580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061590: 2070 656e 616c 7479 3d27 6c32 272c 6475   penalty='l2',du
-000615a0: 616c 3d46 616c 7365 2c20 7261 6e64 6f6d  al=False, random
-000615b0: 5f73 7461 7465 3d30 290d 0a20 2020 2020  _state=0)..     
-000615c0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000615d0: 2020 2020 2020 6c6d 203d 204c 6f67 6973        lm = Logis
-000615e0: 7469 6352 6567 7265 7373 696f 6e28 6d75  ticRegression(mu
-000615f0: 6c74 695f 636c 6173 733d 276f 7672 272c  lti_class='ovr',
-00061600: 206d 6178 5f69 7465 723d 3130 3030 3029   max_iter=10000)
-00061610: 2023 2320 6c6f 6769 7374 6963 2073 6565   ## logistic see
-00061620: 6d73 2062 6573 7420 616d 6f6e 6720 616c  ms best among al
-00061630: 6c0d 0a20 2020 2023 2323 2323 2323 2323  l..    #########
-00061640: 2323 2048 6572 6520 7374 6172 7473 2074  ## Here starts t
-00061650: 6865 2063 6f6e 7665 7273 696f 6e20 6f66  he conversion of
-00061660: 2058 2076 6172 6961 626c 6573 2069 6e74   X variables int
-00061670: 6f20 5465 7874 2066 6561 7475 7265 2076  o Text feature v
-00061680: 6172 6961 626c 6520 6e61 6d65 7320 2323  ariable names ##
-00061690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000616a0: 2323 230d 0a20 2020 2058 5031 203d 2070  ###..    XP1 = p
-000616b0: 642e 4461 7461 4672 616d 6528 5850 2c69  d.DataFrame(XP,i
-000616c0: 6e64 6578 3d6f 7269 675f 6461 7461 5f69  ndex=orig_data_i
-000616d0: 6e64 6578 2c20 636f 6c75 6d6e 733d 786e  ndex, columns=xn
-000616e0: 616d 6573 2920 2323 2058 5031 2068 6173  ames) ## XP1 has
-000616f0: 2061 6c6c 2074 6865 2058 7661 7273 3a69   all the Xvars:i
-00061700: 6e63 6c20 6f72 6967 2b70 6f6c 792b 696e  ncl orig+poly+in
-00061710: 7478 6e20 7661 7273 0d0a 2020 2020 785f  txn vars..    x_
-00061720: 7661 7273 203d 2078 6e61 6d65 735b 3a6e  vars = xnames[:n
-00061730: 5f6f 7269 675f 6665 6174 7572 6573 5d20  _orig_features] 
-00061740: 2023 2323 2078 5f76 6172 7320 636f 6e74   ### x_vars cont
-00061750: 6169 6e20 785f 7661 7269 6162 6c65 7320  ain x_variables 
-00061760: 7375 6368 2061 7320 2778 3127 0d0a 2020  such as 'x1'..  
-00061770: 2020 2323 2323 2046 6561 7475 7265 5f78    #### Feature_x
-00061780: 7661 725f 6469 6374 2077 696c 6c20 6d61  var_dict will ma
-00061790: 7020 7468 6520 585f 7661 7273 2c20 5371  p the X_vars, Sq
-000617a0: 7561 7265 645f 7661 7273 2061 6e64 2049  uared_vars and I
-000617b0: 6e74 786e 5f76 6172 7320 6261 636b 2074  ntxn_vars back t
-000617c0: 6f20 2054 6578 7420 7661 7273 2069 6e20  o  Text vars in 
-000617d0: 6f6e 6520 7661 7269 6162 6c65 0d0a 2020  one variable..  
-000617e0: 2020 6665 6174 7572 655f 7876 6172 5f64    feature_xvar_d
-000617f0: 6963 7420 3d20 6469 6374 287a 6970 2878  ict = dict(zip(x
-00061800: 5f76 6172 732c 7072 6564 6963 746f 7273  _vars,predictors
-00061810: 2929 2023 2323 0d0a 2020 2020 6966 2066  )) ###..    if f
-00061820: 6974 5f66 6c61 673a 0d0a 2020 2020 2020  it_flag:..      
-00061830: 2020 2323 2323 2049 6620 7468 6572 6520    #### If there 
-00061840: 6973 2066 6974 7469 6e67 2074 6f20 6265  is fitting to be
-00061850: 2064 6f6e 652c 2074 6865 6e20 796f 7520   done, then you 
-00061860: 6d75 7374 2064 6f20 7468 6973 2023 2323  must do this ###
-00061870: 0d0a 2020 2020 2020 2020 6966 2041 6464  ..        if Add
-00061880: 5f50 6f6c 7920 3d3d 2031 3a20 2323 2323  _Poly == 1: ####
-00061890: 2054 6869 7320 6164 6473 206f 6e6c 7920   This adds only 
-000618a0: 496e 7465 7261 6374 696f 6e20 7661 7269  Interaction vari
-000618b0: 6162 6c65 7320 3d3e 206e 6f20 506f 6c79  ables => no Poly
-000618c0: 6e6f 6d69 616c 7321 0d0a 2020 2020 2020  nomials!..      
-000618d0: 2020 2020 2020 7371 5f76 6172 7320 3d20        sq_vars = 
-000618e0: 5b5d 2020 2020 2323 2320 7371 5f76 6172  []    ### sq_var
-000618f0: 7320 636f 6e74 6169 6e20 6f6e 6c79 2078  s contain only x
-00061900: 2d73 7175 6172 6564 2076 6172 6961 626c  -squared variabl
-00061910: 6573 2073 7563 6820 6173 2027 785e 3227  es such as 'x^2'
-00061920: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00061930: 7478 6e5f 7661 7273 203d 206c 6566 745f  txn_vars = left_
-00061940: 7375 6274 7261 6374 2878 6e61 6d65 732c  subtract(xnames,
-00061950: 2073 715f 7661 7273 2b78 5f76 6172 7329   sq_vars+x_vars)
-00061960: 2023 2323 2069 6e74 786e 5f76 6172 7320   ### intxn_vars 
-00061970: 636f 6e74 6169 6e20 696e 7465 7261 6374  contain interact
-00061980: 696f 6e20 7661 7273 2073 7563 6820 6173  ion vars such as
-00061990: 2027 7831 2078 3227 0d0a 2020 2020 2020   'x1 x2'..      
-000619a0: 2020 656c 6966 2041 6464 5f50 6f6c 7920    elif Add_Poly 
-000619b0: 3d3d 2032 3a20 2323 2323 2054 6869 7320  == 2: #### This 
-000619c0: 6164 6473 206f 6e6c 7920 506f 6c79 6e6f  adds only Polyno
-000619d0: 6d69 616c 2076 6172 6961 626c 6573 203d  mial variables =
-000619e0: 3e20 6e6f 2049 6e74 6572 6163 7469 6f6e  > no Interaction
-000619f0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-00061a00: 7371 5f76 6172 7320 3d20 5b78 2066 6f72  sq_vars = [x for
-00061a10: 2078 2069 6e20 786e 616d 6573 2069 6620   x in xnames if 
-00061a20: 275e 3227 2069 6e20 785d 2020 2020 2323  '^2' in x]    ##
-00061a30: 2320 7371 5f76 6172 7320 636f 6e74 6169  # sq_vars contai
-00061a40: 6e20 6f6e 6c79 2078 2d73 7175 6172 6564  n only x-squared
-00061a50: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
-00061a60: 6173 2027 785e 3227 0d0a 2020 2020 2020  as 'x^2'..      
-00061a70: 2020 2020 2020 696e 7478 6e5f 7661 7273        intxn_vars
-00061a80: 203d 205b 5d20 2323 2320 696e 7478 6e5f   = [] ### intxn_
-00061a90: 7661 7273 2063 6f6e 7461 696e 2069 6e74  vars contain int
-00061aa0: 6572 6163 7469 6f6e 2076 6172 7320 7375  eraction vars su
-00061ab0: 6368 2061 7320 2778 3120 7832 270d 0a20  ch as 'x1 x2'.. 
-00061ac0: 2020 2020 2020 2065 6c69 6620 4164 645f         elif Add_
-00061ad0: 506f 6c79 203d 3d20 333a 2023 2323 2320  Poly == 3: #### 
-00061ae0: 5468 6973 2061 6464 7320 426f 7468 2049  This adds Both I
-00061af0: 6e74 6572 6163 7469 6f6e 2061 6e64 2050  nteraction and P
-00061b00: 6f6c 796e 6f6d 6961 6c20 7661 7269 6162  olynomial variab
-00061b10: 6c65 7320 3d3e 2042 6573 7420 6f66 2042  les => Best of B
-00061b20: 6f74 6820 776f 726c 6473 210d 0a20 2020  oth worlds!..   
-00061b30: 2020 2020 2020 2020 2073 715f 7661 7273           sq_vars
-00061b40: 203d 205b 7820 666f 7220 7820 696e 2078   = [x for x in x
-00061b50: 6e61 6d65 7320 6966 2027 5e32 2720 696e  names if '^2' in
-00061b60: 2078 5d20 2020 2023 2323 2073 715f 7661   x]    ### sq_va
-00061b70: 7273 2063 6f6e 7461 696e 206f 6e6c 7920  rs contain only 
-00061b80: 782d 7371 7561 7265 6420 7661 7269 6162  x-squared variab
-00061b90: 6c65 7320 7375 6368 2061 7320 2778 5e32  les such as 'x^2
-00061ba0: 270d 0a20 2020 2020 2020 2020 2020 2069  '..            i
-00061bb0: 6e74 786e 5f76 6172 7320 3d20 6c65 6674  ntxn_vars = left
-00061bc0: 5f73 7562 7472 6163 7428 786e 616d 6573  _subtract(xnames
-00061bd0: 2c20 7371 5f76 6172 732b 785f 7661 7273  , sq_vars+x_vars
-00061be0: 2920 2323 2320 696e 7478 6e5f 7661 7273  ) ### intxn_vars
-00061bf0: 2063 6f6e 7461 696e 2069 6e74 6572 6163   contain interac
-00061c00: 7469 6f6e 2076 6172 7320 7375 6368 2061  tion vars such a
-00061c10: 7320 2778 3120 7832 270d 0a20 2020 2020  s 'x1 x2'..     
-00061c20: 2020 2023 2323 2320 2049 7420 6973 206e     ####  It is n
-00061c30: 6f77 2074 696d 6520 746f 2063 7574 2064  ow time to cut d
-00061c40: 6f77 6e20 7468 6520 6f72 6967 696e 616c  own the original
-00061c50: 2078 5f76 6172 6961 626c 6573 2074 6f20   x_variables to 
-00061c60: 6a75 7374 2073 7175 6172 6564 2076 6172  just squared var
-00061c70: 6961 626c 6573 2061 6e64 206f 7269 6769  iables and origi
-00061c80: 6e61 6c73 2068 6572 6520 2323 2323 0d0a  nals here ####..
-00061c90: 2020 2020 2020 2020 6469 6374 5f76 6172          dict_var
-00061ca0: 7320 3d20 6469 6374 287a 6970 2870 7265  s = dict(zip(pre
-00061cb0: 6469 6374 6f72 732c 785f 7661 7273 2929  dictors,x_vars))
-00061cc0: 2023 2323 2074 6869 7320 6973 2061 2064   ### this is a d
-00061cd0: 6963 7469 6f6e 6172 7920 6d61 7070 696e  ictionary mappin
-00061ce0: 6720 6f72 6967 696e 616c 2076 6172 6961  g original varia
-00061cf0: 626c 6573 2061 6e64 2074 6865 6972 2078  bles and their x
-00061d00: 2d76 6172 6961 626c 6573 0d0a 2020 2020  -variables..    
-00061d10: 2020 2020 7265 7665 7273 655f 6469 6374      reverse_dict
-00061d20: 5f76 6172 7320 3d20 6469 6374 285b 2879  _vars = dict([(y
-00061d30: 2c78 2920 666f 7220 2878 2c79 2920 696e  ,x) for (x,y) in
-00061d40: 2064 6963 745f 7661 7273 2e69 7465 6d73   dict_vars.items
-00061d50: 2829 5d29 2023 2323 2074 6869 7320 6d61  ()]) ### this ma
-00061d60: 7073 2074 6865 2078 2d76 6172 7320 746f  ps the x-vars to
-00061d70: 206f 7269 6769 6e61 6c20 7661 7273 0d0a   original vars..
-00061d80: 2020 2020 2020 2020 2323 2323 2320 4e6f          ##### No
-00061d90: 7720 6c65 7427 7320 636f 6e76 6572 7420  w let's convert 
-00061da0: 496e 7465 7261 6374 696f 6e20 785f 7661  Interaction x_va
-00061db0: 7269 6162 6c65 7320 696e 746f 2074 6865  riables into the
-00061dc0: 6972 2063 6f72 7265 7370 6f6e 6469 6e67  ir corresponding
-00061dd0: 2074 6578 7420 7661 7269 6162 6c65 730d   text variables.
-00061de0: 0a20 2020 2020 2020 2069 6e74 786e 5f74  .        intxn_t
-00061df0: 6578 745f 7661 7273 203d 205b 5d0d 0a20  ext_vars = [].. 
-00061e00: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
-00061e10: 6974 656d 2069 6e20 696e 7478 6e5f 7661  item in intxn_va
-00061e20: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
-00061e30: 2069 6620 6c65 6e28 6561 6368 5f69 7465   if len(each_ite
-00061e40: 6d2e 7370 6c69 7428 2220 2229 2920 3d3d  m.split(" ")) ==
-00061e50: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00061e60: 2020 2020 2069 6e74 786e 5f74 6578 745f       intxn_text_
-00061e70: 7661 7273 2e61 7070 656e 6428 7265 7665  vars.append(reve
-00061e80: 7273 655f 6469 6374 5f76 6172 735b 6561  rse_dict_vars[ea
-00061e90: 6368 5f69 7465 6d5d 290d 0a20 2020 2020  ch_item])..     
-00061ea0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00061eb0: 7265 5f78 7661 725f 6469 6374 5b65 6163  re_xvar_dict[eac
-00061ec0: 685f 6974 656d 5d20 3d20 7265 7665 7273  h_item] = revers
-00061ed0: 655f 6469 6374 5f76 6172 735b 6561 6368  e_dict_vars[each
-00061ee0: 5f69 7465 6d5d 0d0a 2020 2020 2020 2020  _item]..        
-00061ef0: 2020 2020 656c 6966 206c 656e 2865 6163      elif len(eac
-00061f00: 685f 6974 656d 2e73 706c 6974 2822 2022  h_item.split(" "
-00061f10: 2929 203d 3d20 323a 0d0a 2020 2020 2020  )) == 2:..      
-00061f20: 2020 2020 2020 2020 2020 7477 6f5f 6974            two_it
-00061f30: 656d 735f 6c69 7374 203d 2065 6163 685f  ems_list = each_
-00061f40: 6974 656d 2e73 706c 6974 2822 2022 290d  item.split(" ").
-00061f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00061f60: 2066 756c 6c5f 696e 7478 6e5f 6e61 6d65   full_intxn_name
-00061f70: 203d 2072 6576 6572 7365 5f64 6963 745f   = reverse_dict_
-00061f80: 7661 7273 5b74 776f 5f69 7465 6d73 5f6c  vars[two_items_l
-00061f90: 6973 745b 305d 5d20 2b22 2022 2b20 7265  ist[0]] +" "+ re
-00061fa0: 7665 7273 655f 6469 6374 5f76 6172 735b  verse_dict_vars[
-00061fb0: 7477 6f5f 6974 656d 735f 6c69 7374 5b31  two_items_list[1
-00061fc0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00061fd0: 2020 2020 696e 7478 6e5f 7465 7874 5f76      intxn_text_v
-00061fe0: 6172 732e 6170 7065 6e64 2866 756c 6c5f  ars.append(full_
-00061ff0: 696e 7478 6e5f 6e61 6d65 290d 0a20 2020  intxn_name)..   
-00062000: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00062010: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
-00062020: 6163 685f 6974 656d 5d20 3d20 6675 6c6c  ach_item] = full
-00062030: 5f69 6e74 786e 5f6e 616d 650d 0a20 2020  _intxn_name..   
-00062040: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00062050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062060: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
-00062070: 2323 2320 4e6f 7720 6c65 7427 7320 636f  ### Now let's co
-00062080: 6e76 6572 7420 5371 7561 7265 6420 785f  nvert Squared x_
-00062090: 7661 7269 6162 6c65 7320 696e 746f 2074  variables into t
-000620a0: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
-000620b0: 6e67 2074 6578 7420 7661 7269 6162 6c65  ng text variable
-000620c0: 730d 0a20 2020 2020 2020 2073 715f 7465  s..        sq_te
-000620d0: 7874 5f76 6172 7320 3d20 5b5d 0d0a 2020  xt_vars = []..  
-000620e0: 2020 2020 2020 666f 7220 6561 6368 5f73        for each_s
-000620f0: 715f 6974 656d 2069 6e20 7371 5f76 6172  q_item in sq_var
-00062100: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00062110: 6966 206c 656e 2865 6163 685f 7371 5f69  if len(each_sq_i
-00062120: 7465 6d2e 7370 6c69 7428 225e 2229 2920  tem.split("^")) 
-00062130: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
-00062140: 2020 2020 2020 2074 776f 5f69 7465 6d5f         two_item_
-00062150: 6c69 7374 203d 2065 6163 685f 7371 5f69  list = each_sq_i
-00062160: 7465 6d2e 7370 6c69 7428 225e 2229 0d0a  tem.split("^")..
-00062170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062180: 6675 6c6c 5f73 715f 6e61 6d65 203d 2072  full_sq_name = r
-00062190: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
-000621a0: 5b74 776f 5f69 7465 6d5f 6c69 7374 5b30  [two_item_list[0
-000621b0: 5d5d 202b 225e 3222 0d0a 2020 2020 2020  ]] +"^2"..      
-000621c0: 2020 2020 2020 2020 2020 7371 5f74 6578            sq_tex
-000621d0: 745f 7661 7273 2e61 7070 656e 6428 6675  t_vars.append(fu
-000621e0: 6c6c 5f73 715f 6e61 6d65 290d 0a20 2020  ll_sq_name)..   
-000621f0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00062200: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
-00062210: 6163 685f 7371 5f69 7465 6d5d 203d 2066  ach_sq_item] = f
-00062220: 756c 6c5f 7371 5f6e 616d 650d 0a20 2020  ull_sq_name..   
-00062230: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00062240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062250: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
-00062260: 2323 204e 6f77 2077 6520 6e65 6564 2074  ## Now we need t
-00062270: 6f20 636f 6d62 696e 6520 7468 6520 785f  o combine the x_
-00062280: 7661 7273 2c20 5371 7561 7265 645f 7661  vars, Squared_va
-00062290: 7273 2061 6e64 2074 6865 2049 6e74 786e  rs and the Intxn
-000622a0: 5f76 6172 7320 746f 6765 7468 6572 2061  _vars together a
-000622b0: 7320 5465 7874 2076 6172 7320 696e 206f  s Text vars in o
-000622c0: 6e65 2076 6172 6961 626c 650d 0a20 2020  ne variable..   
-000622d0: 2020 2020 2066 756c 6c5f 785f 7661 7273       full_x_vars
-000622e0: 203d 2078 5f76 6172 7320 2b20 7371 5f76   = x_vars + sq_v
-000622f0: 6172 7320 2b20 696e 7478 6e5f 7661 7273  ars + intxn_vars
-00062300: 0d0a 2020 2020 2020 2020 7465 7874 5f76  ..        text_v
-00062310: 6172 7320 3d20 7072 6564 6963 746f 7273  ars = predictors
-00062320: 202b 2073 715f 7465 7874 5f76 6172 7320   + sq_text_vars 
-00062330: 2b20 696e 7478 6e5f 7465 7874 5f76 6172  + intxn_text_var
-00062340: 7320 2323 2323 2074 6578 745f 7661 7273  s #### text_vars
-00062350: 206e 6f77 2063 6f6e 7461 696e 7320 616c   now contains al
-00062360: 6c20 7468 6520 7465 7874 2076 6572 7369  l the text versi
-00062370: 6f6e 206f 6620 782d 7661 7269 6162 6c65  on of x-variable
-00062380: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-00062390: 6e28 7465 7874 5f76 6172 7329 203d 3d20  n(text_vars) == 
-000623a0: 6c65 6e28 6675 6c6c 5f78 5f76 6172 7329  len(full_x_vars)
-000623b0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000623c0: 7269 6e74 2827 5375 6363 6573 7366 756c  rint('Successful
-000623d0: 6c79 2074 7261 6e73 666f 726d 6564 2078  ly transformed x
-000623e0: 2d76 6172 6961 626c 6573 2069 6e74 6f20  -variables into 
-000623f0: 7465 7874 2d76 6172 6961 626c 6573 2061  text-variables a
-00062400: 6674 6572 2050 6f6c 796e 6f6d 6961 6c20  fter Polynomial 
-00062410: 7472 616e 7366 6f72 6d61 7469 6f6e 7327  transformations'
-00062420: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00062430: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00062440: 696e 7428 2745 7272 6f72 3a20 4e6f 7420  int('Error: Not 
-00062450: 6162 6c65 2074 6f20 7472 616e 7366 6f72  able to transfor
-00062460: 6d20 782d 7661 7269 6162 6c65 7320 696e  m x-variables in
-00062470: 746f 2074 6578 742d 7661 7269 6162 6c65  to text-variable
-00062480: 732e 2043 6f6e 7469 6e75 696e 6720 7769  s. Continuing wi
-00062490: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
-000624a0: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-000624b0: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
-000624c0: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
-000624d0: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
-000624e0: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
-000624f0: 2020 2020 6665 6174 7572 655f 7465 7874      feature_text
-00062500: 7661 725f 6469 6374 2020 3d20 6469 6374  var_dict  = dict
-00062510: 285b 2879 2c78 2920 666f 7220 2878 2c79  ([(y,x) for (x,y
-00062520: 2920 696e 2066 6561 7475 7265 5f78 7661  ) in feature_xva
-00062530: 725f 6469 6374 2e69 7465 6d73 2829 5d29  r_dict.items()])
-00062540: 0d0a 2020 2020 2020 2020 2323 2323 204e  ..        #### N
-00062550: 6f77 2042 7569 6c64 2061 2044 6174 6120  ow Build a Data 
-00062560: 4672 616d 6520 636f 6e74 6169 6e69 6e67  Frame containing
-00062570: 2063 6f6e 7461 696e 696e 6720 6164 6469   containing addi
-00062580: 7469 6f6e 616c 2050 6f6c 7920 616e 6420  tional Poly and 
-00062590: 496e 7478 6e20 7661 7269 6162 6c65 7320  Intxn variables 
-000625a0: 696e 2078 2d66 6f72 6d61 7420 6865 7265  in x-format here
-000625b0: 2023 2323 230d 0a20 2020 2020 2020 206e   ####..        n
-000625c0: 6577 5f61 6464 785f 7661 7273 203d 2073  ew_addx_vars = s
-000625d0: 715f 7661 7273 2b69 6e74 786e 5f76 6172  q_vars+intxn_var
-000625e0: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-000625f0: 6e28 6e65 775f 6164 6478 5f76 6172 7329  n(new_addx_vars)
-00062600: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-00062610: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
-00062620: 3a20 5468 6572 6520 6172 6520 6e6f 2073  : There are no s
-00062630: 7175 6172 6564 206f 7220 696e 7465 7261  quared or intera
-00062640: 6374 696f 6e20 7661 7273 2074 6f20 6164  ction vars to ad
-00062650: 642e 2043 6f6e 7469 6e75 696e 6720 7769  d. Continuing wi
-00062660: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
-00062670: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-00062680: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
-00062690: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
-000626a0: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
-000626b0: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
-000626c0: 2020 2020 2323 2323 2020 5765 2064 6566      ####  We def
-000626d0: 696e 6520 3220 6461 7461 2066 7261 6d65  ine 2 data frame
-000626e0: 733a 206f 6e65 2066 6f72 2072 656d 6f76  s: one for remov
-000626f0: 696e 6720 6869 6768 6c79 2063 6f72 7265  ing highly corre
-00062700: 6c61 7465 6420 7661 7273 2061 6e64 206f  lated vars and o
-00062710: 7468 6572 2066 6f72 204c 6173 736f 2073  ther for Lasso s
-00062720: 656c 6563 7469 6f6e 0d0a 2020 2020 2020  election..      
-00062730: 2020 5850 3220 3d20 5850 315b 6e65 775f    XP2 = XP1[new_
-00062740: 6164 6478 5f76 6172 735d 2e6a 6f69 6e28  addx_vars].join(
-00062750: 5929 0d0a 2020 2020 2020 2020 5850 3158  Y)..        XP1X
-00062760: 203d 2058 5031 5b6e 6577 5f61 6464 785f   = XP1[new_addx_
-00062770: 7661 7273 5d0d 0a20 2020 2020 2020 206e  vars]..        n
-00062780: 6577 5f61 6464 7465 7874 5f76 6172 7320  ew_addtext_vars 
-00062790: 3d20 5b66 6561 7475 7265 5f78 7661 725f  = [feature_xvar_
-000627a0: 6469 6374 5b78 5d20 666f 7220 7820 696e  dict[x] for x in
-000627b0: 206e 6577 5f61 6464 785f 7661 7273 5d0d   new_addx_vars].
-000627c0: 0a20 2020 2020 2020 2058 5032 2e63 6f6c  .        XP2.col
-000627d0: 756d 6e73 203d 206e 6577 5f61 6464 7465  umns = new_addte
-000627e0: 7874 5f76 6172 732b 5b74 6172 6765 7476  xt_vars+[targetv
-000627f0: 6172 5d0d 0a20 2020 2020 2020 2058 5031  ar]..        XP1
-00062800: 582e 636f 6c75 6d6e 7320 3d20 6e65 775f  X.columns = new_
-00062810: 6164 6474 6578 745f 7661 7273 0d0a 2020  addtext_vars..  
-00062820: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-00062830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062870: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00062880: 2020 2023 2323 2320 2020 2046 4153 5420     ####    FAST 
-00062890: 4645 4154 5552 4520 5245 4455 4354 494f  FEATURE REDUCTIO
-000628a0: 4e20 5553 494e 4720 4c31 2052 4547 554c  N USING L1 REGUL
-000628b0: 4152 495a 4154 494f 4e20 464f 5220 4c41  ARIZATION FOR LA
-000628c0: 5247 4520 4441 5441 2053 4554 5320 2020  RGE DATA SETS   
-000628d0: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-000628e0: 2323 2323 2020 2055 7365 204c 6173 736f  ####   Use Lasso
-000628f0: 4356 206f 7220 4c6f 6769 7374 6963 5265  CV or LogisticRe
-00062900: 6772 6573 7369 6f6e 4356 2074 6f20 5265  gressionCV to Re
-00062910: 6475 6365 2056 6172 6961 626c 6573 2075  duce Variables u
-00062920: 7369 6e67 2052 6567 756c 6172 697a 6174  sing Regularizat
-00062930: 696f 6e0d 0a20 2020 2020 2020 2023 2323  ion..        ###
-00062940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062990: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000629a0: 2742 7569 6c64 696e 6720 436f 6d70 6172  'Building Compar
-000629b0: 6973 6f6e 204d 6f64 656c 2077 6974 6820  ison Model with 
-000629c0: 6f6e 6c79 2050 6f6c 7920 616e 6420 496e  only Poly and In
-000629d0: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
-000629e0: 6c65 732e 2e2e 2729 0d0a 2020 2020 2020  les...')..      
-000629f0: 2020 6c6d 5f70 2c20 5f20 3d20 7072 696e    lm_p, _ = prin
-00062a00: 745f 6d6f 6465 6c5f 6d65 7472 6963 7328  t_model_metrics(
-00062a10: 6d6f 6465 6c74 7970 652c 6c6d 2c58 5031  modeltype,lm,XP1
-00062a20: 582c 592c 5472 7565 290d 0a20 2020 2020  X,Y,True)..     
-00062a30: 2020 2070 7269 6e74 2827 2020 2020 5469     print('    Ti
-00062a40: 6d65 2054 616b 656e 3a20 2530 2e30 6620  me Taken: %0.0f 
-00062a50: 2869 6e20 7365 636f 6e64 7329 2720 2528  (in seconds)' %(
-00062a60: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
-00062a70: 745f 7469 6d65 2929 0d0a 2020 2020 2020  t_time))..      
-00062a80: 2020 2323 2323 2020 5765 206e 6565 6420    ####  We need 
-00062a90: 746f 2062 7569 6c64 2061 2064 6174 6166  to build a dataf
-00062aa0: 7261 6d65 2074 6f20 686f 6c64 2063 6f65  rame to hold coe
-00062ab0: 6666 6963 6965 6e74 7320 6672 6f6d 2074  fficients from t
-00062ac0: 6865 206d 6f64 656c 2066 6f72 2065 6163  he model for eac
-00062ad0: 6820 7661 7269 6162 6c65 2023 2323 0d0a  h variable ###..
-00062ae0: 2020 2020 2020 2020 6466 7820 3d20 7064          dfx = pd
-00062af0: 2e44 6174 6146 7261 6d65 285b 6e65 775f  .DataFrame([new_
-00062b00: 6164 6478 5f76 6172 732c 206e 6577 5f61  addx_vars, new_a
-00062b10: 6464 7465 7874 5f76 6172 735d 290d 0a20  ddtext_vars]).. 
-00062b20: 2020 2020 2020 2064 6620 3d20 6466 782e         df = dfx.
-00062b30: 540d 0a20 2020 2020 2020 2064 662e 636f  T..        df.co
-00062b40: 6c75 6d6e 733d 5b27 5820 4e61 6d65 7327  lumns=['X Names'
-00062b50: 2c27 496e 7465 7261 6374 696f 6e20 5661  ,'Interaction Va
-00062b60: 7269 6162 6c65 204e 616d 6573 275d 0d0a  riable Names']..
-00062b70: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00062b80: 2323 2020 4e20 4f20 5720 2020 4220 5520  ##  N O W   B U 
-00062b90: 4920 4c20 4420 2054 2048 2045 2020 4d20  I L D  T H E  M 
-00062ba0: 4f20 4420 4520 4c20 2323 2323 2323 2323  O D E L ########
-00062bb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062bc0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00062bd0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-00062be0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-00062bf0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
-00062c00: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
-00062c10: 616c 7565 7327 5d20 3d20 6c6d 5f70 2e63  alues'] = lm_p.c
-00062c20: 6f65 665f 0d0a 2020 2020 2020 2020 656c  oef_..        el
-00062c30: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00062c40: 2064 665b 2743 6f65 6666 6963 6965 6e74   df['Coefficient
-00062c50: 2056 616c 7565 7327 5d20 3d20 6c6d 5f70   Values'] = lm_p
-00062c60: 2e63 6f65 665f 5b30 5d0d 0a20 2020 2020  .coef_[0]..     
-00062c70: 2020 2023 2323 2320 5468 6973 2070 6172     #### This par
-00062c80: 7420 7365 6c65 6374 7320 7468 6520 746f  t selects the to
-00062c90: 7020 3130 2520 6f66 2069 6e74 6572 6163  p 10% of interac
-00062ca0: 7469 6f6e 2076 6172 6961 626c 6573 2063  tion variables c
-00062cb0: 7265 6174 6564 2075 7369 6e67 206c 696e  reated using lin
-00062cc0: 6561 7220 6d6f 6465 6c69 6e67 2e0d 0a20  ear modeling... 
-00062cd0: 2020 2020 2020 2023 2323 2020 2049 7420         ###   It 
-00062ce0: 6973 2076 6572 7920 696d 706f 7274 616e  is very importan
-00062cf0: 7420 746f 206c 6561 7665 2074 6865 206e  t to leave the n
-00062d00: 6578 7420 6c69 6e65 2061 7320 6973 2073  ext line as is s
-00062d10: 696e 6365 203e 2073 796d 626f 6c20 6973  ince > symbol is
-00062d20: 2062 6574 7465 7220 7468 616e 203e 3d0d   better than >=.
-00062d30: 0a20 2020 2020 2020 206c 696d 203d 2061  .        lim = a
-00062d40: 6273 2864 665b 2743 6f65 6666 6963 6965  bs(df['Coefficie
-00062d50: 6e74 2056 616c 7565 7327 5d29 2e71 7561  nt Values']).qua
-00062d60: 6e74 696c 6528 302e 3929 0d0a 2020 2020  ntile(0.9)..    
-00062d70: 2020 2020 6466 3930 203d 2064 665b 6162      df90 = df[ab
-00062d80: 7328 6466 5b27 436f 6566 6669 6369 656e  s(df['Coefficien
-00062d90: 7420 5661 6c75 6573 275d 293e 6c69 6d5d  t Values'])>lim]
-00062da0: 2e73 6f72 745f 7661 6c75 6573 2827 436f  .sort_values('Co
-00062db0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
-00062dc0: 272c 6173 6365 6e64 696e 673d 4661 6c73  ',ascending=Fals
-00062dd0: 6529 0d0a 2020 2020 2020 2020 6966 2064  e)..        if d
-00062de0: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
-00062df0: 616c 7565 7327 5d2e 7375 6d28 293d 3d30  alues'].sum()==0
-00062e00: 2e30 206f 7220 6466 3930 5b27 436f 6566  .0 or df90['Coef
-00062e10: 6669 6369 656e 7420 5661 6c75 6573 275d  ficient Values']
-00062e20: 2e73 756d 2829 3d3d 302e 303a 0d0a 2020  .sum()==0.0:..  
-00062e30: 2020 2020 2020 2020 2020 2323 2320 5468            ### Th
-00062e40: 6572 6520 6973 206e 6f20 636f 6566 6669  ere is no coeffi
-00062e50: 6369 656e 7420 7468 6174 2069 7320 6772  cient that is gr
-00062e60: 6561 7465 7220 7468 616e 2030 2068 6572  eater than 0 her
-00062e70: 652e 2053 6f20 7265 6a65 6374 2061 6c6c  e. So reject all
-00062e80: 2076 6172 6961 626c 6573 210d 0a20 2020   variables!..   
-00062e90: 2020 2020 2020 2020 2073 656c 5f78 5f76           sel_x_v
-00062ea0: 6172 7320 3d20 5b5d 0d0a 2020 2020 2020  ars = []..      
-00062eb0: 2020 2020 2020 7072 696e 7428 275a 6572        print('Zer
-00062ec0: 6f20 496e 7465 7261 6374 696f 6e20 616e  o Interaction an
-00062ed0: 6420 506f 6c79 6e6f 6d69 616c 2076 6172  d Polynomial var
-00062ee0: 6961 626c 6528 7329 2073 656c 6563 7465  iable(s) selecte
-00062ef0: 642e 2e2e 2729 0d0a 2020 2020 2020 2020  d...')..        
-00062f00: 656c 6966 2064 665b 2743 6f65 6666 6963  elif df['Coeffic
-00062f10: 6965 6e74 2056 616c 7565 7327 5d2e 7368  ient Values'].sh
-00062f20: 6170 655b 305d 203d 3d20 6466 3930 5b27  ape[0] == df90['
-00062f30: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
-00062f40: 6573 275d 2e73 6861 7065 5b30 5d3a 0d0a  es'].shape[0]:..
-00062f50: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00062f60: 5468 6572 6520 6973 206e 6f20 636f 6566  There is no coef
-00062f70: 6669 6369 656e 7420 7468 6174 2069 7320  ficient that is 
-00062f80: 6772 6561 7465 7220 7468 616e 2030 2068  greater than 0 h
-00062f90: 6572 652e 2053 6f20 7265 6a65 6374 2061  ere. So reject a
-00062fa0: 6c6c 2076 6172 6961 626c 6573 210d 0a20  ll variables!.. 
-00062fb0: 2020 2020 2020 2020 2020 2073 656c 5f78             sel_x
-00062fc0: 5f76 6172 7320 3d20 5b5d 0d0a 2020 2020  _vars = []..    
-00062fd0: 2020 2020 2020 2020 7072 696e 7428 275a          print('Z
-00062fe0: 6572 6f20 496e 7465 7261 6374 696f 6e20  ero Interaction 
-00062ff0: 616e 6420 506f 6c79 6e6f 6d69 616c 2076  and Polynomial v
-00063000: 6172 6961 626c 6528 7329 2073 656c 6563  ariable(s) selec
-00063010: 7465 642e 2e2e 2729 0d0a 2020 2020 2020  ted...')..      
-00063020: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00063030: 2020 2020 2023 2323 2320 7468 6572 6520       #### there 
-00063040: 6973 2073 6f6d 6520 636f 6566 6669 6369  is some coeffici
-00063050: 656e 7473 2061 7420 6c65 6173 7420 7468  ents at least th
-00063060: 6174 2061 7265 206e 6f6e 2d7a 6572 6f20  at are non-zero 
-00063070: 616e 6420 6865 6e63 6520 6361 6e20 6265  and hence can be
-00063080: 2074 7275 7374 6564 210d 0a20 2020 2020   trusted!..     
-00063090: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-000630a0: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-000630b0: 2020 2020 2020 2020 2064 6639 302e 736f           df90.so
-000630c0: 7274 5f76 616c 7565 7328 2743 6f65 6666  rt_values('Coeff
-000630d0: 6963 6965 6e74 2056 616c 7565 7327 2c61  icient Values',a
-000630e0: 7363 656e 6469 6e67 3d46 616c 7365 295b  scending=False)[
-000630f0: 3a31 305d 2e70 6c6f 7428 0d0a 2020 2020  :10].plot(..    
-00063100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00063110: 6b69 6e64 3d27 6261 7227 2c78 3d27 496e  kind='bar',x='In
-00063120: 7465 7261 6374 696f 6e20 5661 7269 6162  teraction Variab
-00063130: 6c65 204e 616d 6573 272c 793d 2743 6f65  le Names',y='Coe
-00063140: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
-00063150: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00063160: 2020 2020 2020 2074 6974 6c65 3d27 546f         title='To
-00063170: 7020 3130 2520 5661 7269 6162 6c65 2049  p 10% Variable I
-00063180: 6e74 6572 6163 7469 6f6e 7320 616e 6420  nteractions and 
-00063190: 7468 6569 7220 436f 6566 6669 6369 656e  their Coefficien
-000631a0: 7473 2027 290d 0a20 2020 2020 2020 2020  ts ')..         
-000631b0: 2020 2065 6c69 6620 7665 7262 6f73 6520     elif verbose 
-000631c0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
-000631d0: 2020 2020 2020 2064 6639 302e 736f 7274         df90.sort
-000631e0: 5f76 616c 7565 7328 2743 6f65 6666 6963  _values('Coeffic
-000631f0: 6965 6e74 2056 616c 7565 7327 2c61 7363  ient Values',asc
-00063200: 656e 6469 6e67 3d46 616c 7365 292e 706c  ending=False).pl
-00063210: 6f74 280d 0a20 2020 2020 2020 2020 2020  ot(..           
-00063220: 2020 2020 2020 2020 206b 696e 643d 2762           kind='b
-00063230: 6172 272c 783d 2749 6e74 6572 6163 7469  ar',x='Interacti
-00063240: 6f6e 2056 6172 6961 626c 6520 4e61 6d65  on Variable Name
-00063250: 7327 2c79 3d27 436f 6566 6669 6369 656e  s',y='Coefficien
-00063260: 7420 5661 6c75 6573 272c 0d0a 2020 2020  t Values',..    
-00063270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00063280: 2020 2020 7469 746c 653d 2741 6c6c 2056      title='All V
-00063290: 6172 6961 626c 6520 496e 7465 7261 6374  ariable Interact
-000632a0: 696f 6e73 2061 6e64 2074 6865 6972 2043  ions and their C
-000632b0: 6f65 6666 6963 6965 6e74 7327 2c66 6967  oefficients',fig
-000632c0: 7369 7a65 3d28 3230 2c31 3029 290d 0a20  size=(20,10)).. 
-000632d0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-000632e0: 6163 7469 6f6e 7320 3d20 6466 3930 5b27  actions = df90['
-000632f0: 496e 7465 7261 6374 696f 6e20 5661 7269  Interaction Vari
-00063300: 6162 6c65 204e 616d 6573 275d 2e76 616c  able Names'].val
-00063310: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
-00063320: 2020 2020 2020 2020 2020 7365 6c5f 785f            sel_x_
-00063330: 7661 7273 203d 2064 6639 305b 2258 204e  vars = df90["X N
-00063340: 616d 6573 225d 2e76 616c 7565 732e 746f  ames"].values.to
-00063350: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-00063360: 2323 2323 2323 2320 4e6f 7720 7765 2068  ####### Now we h
-00063370: 6176 6520 746f 2070 7574 2074 6865 2066  ave to put the f
-00063380: 756c 6c20 6461 7461 6672 616d 6520 746f  ull dataframe to
-00063390: 6765 7468 6572 2077 6974 6820 7365 6c65  gether with sele
-000633a0: 6374 6564 2076 6172 6961 626c 6573 2061  cted variables a
-000633b0: 6e64 206f 7269 6769 6e61 6c20 7072 6564  nd original pred
-000633c0: 6963 746f 7273 210d 0a20 2020 2020 2020  ictors!..       
-000633d0: 2023 2323 2320 444f 204e 4f54 2043 4841   #### DO NOT CHA
-000633e0: 4e47 4520 5448 4520 4e45 5854 204c 494e  NGE THE NEXT LIN
-000633f0: 4520 4556 454e 2054 484f 5547 4820 4954  E EVEN THOUGH IT
-00063400: 204d 4947 4854 2042 4520 5445 4d50 5449   MIGHT BE TEMPTI
-00063410: 4e47 2054 4f20 444f 2053 4f21 2049 7420  NG TO DO SO! It 
-00063420: 6973 2063 6f72 7265 6374 210d 0a20 2020  is correct!..   
-00063430: 2020 2020 2066 696e 616c 5f78 5f76 6172       final_x_var
-00063440: 7320 3d20 785f 7661 7273 202b 2073 656c  s = x_vars + sel
-00063450: 5f78 5f76 6172 730d 0a20 2020 2020 2020  _x_vars..       
-00063460: 2073 656c 5f74 6578 745f 7661 7273 203d   sel_text_vars =
-00063470: 205b 6665 6174 7572 655f 7876 6172 5f64   [feature_xvar_d
-00063480: 6963 745b 785d 2066 6f72 2078 2069 6e20  ict[x] for x in 
-00063490: 7365 6c5f 785f 7661 7273 5d0d 0a20 2020  sel_x_vars]..   
-000634a0: 2020 2020 2070 7269 6e74 2827 496e 6974       print('Init
-000634b0: 6961 6c6c 7920 6164 6469 6e67 2025 6420  ially adding %d 
-000634c0: 7661 7269 6162 6c65 2873 2920 6475 6520  variable(s) due 
-000634d0: 746f 2041 6464 5f50 6f6c 7920 3d20 2573  to Add_Poly = %s
-000634e0: 2073 6574 7469 6e67 2720 2528 6c65 6e28   setting' %(len(
-000634f0: 7365 6c5f 7465 7874 5f76 6172 7329 2c41  sel_text_vars),A
-00063500: 6464 5f50 6f6c 7929 290d 0a20 2020 2020  dd_Poly))..     
-00063510: 2020 2069 6620 7665 7262 6f73 6520 3e20     if verbose > 
-00063520: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00063530: 6966 206c 656e 2873 656c 5f74 6578 745f  if len(sel_text_
-00063540: 7661 7273 2920 3c3d 2033 303a 0d0a 2020  vars) <= 30:..  
-00063550: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00063560: 696e 7428 2720 2020 2041 6464 6564 2076  int('    Added v
-00063570: 6172 6961 626c 6573 3a20 2573 2720 2573  ariables: %s' %s
-00063580: 656c 5f74 6578 745f 7661 7273 290d 0a20  el_text_vars).. 
-00063590: 2020 2020 2020 2066 696e 616c 5f74 6578         final_tex
-000635a0: 745f 7661 7273 203d 205b 6665 6174 7572  t_vars = [featur
-000635b0: 655f 7876 6172 5f64 6963 745b 785d 2066  e_xvar_dict[x] f
-000635c0: 6f72 2078 2069 6e20 6669 6e61 6c5f 785f  or x in final_x_
-000635d0: 7661 7273 5d0d 0a20 2020 2020 2020 2023  vars]..        #
-000635e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000635f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063630: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00063640: 2020 2066 696e 616c 5f64 6620 3d20 6d64     final_df = md
-00063650: 2e74 7261 6e73 666f 726d 2864 6174 615b  .transform(data[
-00063660: 7072 6564 6963 746f 7273 5d29 0d0a 2020  predictors])..  
-00063670: 2020 2020 2020 6966 204c 6f6f 7365 5665        if LooseVe
-00063680: 7273 696f 6e28 736b 6c65 6172 6e2e 5f5f  rsion(sklearn.__
-00063690: 7665 7273 696f 6e5f 5f29 203c 204c 6f6f  version__) < Loo
-000636a0: 7365 5665 7273 696f 6e28 2730 2e32 342e  seVersion('0.24.
-000636b0: 3227 293a 0d0a 2020 2020 2020 2020 2020  2'):..          
-000636c0: 2020 2320 5065 7266 6f72 6d20 6163 7469    # Perform acti
-000636d0: 6f6e 2066 6f72 2073 6369 6b69 742d 6c65  on for scikit-le
-000636e0: 6172 6e20 7665 7273 696f 6e20 6265 6c6f  arn version belo
-000636f0: 7720 302e 3234 2e32 0d0a 2020 2020 2020  w 0.24.2..      
-00063700: 2020 2020 2020 7072 696e 7428 2250 6572        print("Per
-00063710: 666f 726d 696e 6720 6163 7469 6f6e 2066  forming action f
-00063720: 6f72 2073 6369 6b69 742d 6c65 6172 6e20  or scikit-learn 
-00063730: 7665 7273 696f 6e20 6265 6c6f 7720 302e  version below 0.
-00063740: 3234 2e32 2229 0d0a 2020 2020 2020 2020  24.2")..        
-00063750: 2020 2020 2320 4164 6420 796f 7572 2063      # Add your c
-00063760: 6f64 6520 6865 7265 2066 6f72 2073 6369  ode here for sci
-00063770: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
-00063780: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
-00063790: 2020 2020 2020 2020 2020 2020 786e 616d              xnam
-000637a0: 6573 203d 206d 642e 6765 745f 6665 6174  es = md.get_feat
-000637b0: 7572 655f 6e61 6d65 7328 290d 0a20 2020  ure_names()..   
-000637c0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000637d0: 2020 2020 2020 2020 2320 5065 7266 6f72          # Perfor
-000637e0: 6d20 6163 7469 6f6e 2066 6f72 2073 6369  m action for sci
-000637f0: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
-00063800: 6e20 302e 3234 2e32 2061 6e64 2061 626f  n 0.24.2 and abo
-00063810: 7665 0d0a 2020 2020 2020 2020 2020 2020  ve..            
-00063820: 7072 696e 7428 2250 6572 666f 726d 696e  print("Performin
-00063830: 6720 6163 7469 6f6e 2066 6f72 2073 6369  g action for sci
-00063840: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
-00063850: 6e20 302e 3234 2e32 2061 6e64 2061 626f  n 0.24.2 and abo
-00063860: 7665 2229 0d0a 2020 2020 2020 2020 2020  ve")..          
-00063870: 2020 2320 4164 6420 796f 7572 2063 6f64    # Add your cod
-00063880: 6520 6865 7265 2066 6f72 2073 6369 6b69  e here for sciki
-00063890: 742d 6c65 6172 6e20 7665 7273 696f 6e20  t-learn version 
-000638a0: 302e 3234 2e32 2061 6e64 2061 626f 7665  0.24.2 and above
-000638b0: 0d0a 2020 2020 2020 2020 2020 2020 786e  ..            xn
-000638c0: 616d 6573 203d 206d 642e 6765 745f 6665  ames = md.get_fe
-000638d0: 6174 7572 655f 6e61 6d65 735f 6f75 7428  ature_names_out(
-000638e0: 292e 746f 6c69 7374 2829 2023 2323 2078  ).tolist() ### x
-000638f0: 6e61 6d65 7320 636f 6e74 6169 6e73 2061  names contains a
-00063900: 6c6c 2078 2d6f 6e6c 792c 2050 6f6c 7920  ll x-only, Poly 
-00063910: 616e 6420 496e 7478 6e20 7661 7269 6162  and Intxn variab
-00063920: 6c65 7320 696e 2078 2d66 6f72 6d61 740d  les in x-format.
-00063930: 0a20 2020 2020 2020 2066 696e 616c 5f64  .        final_d
-00063940: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-00063950: 2866 696e 616c 5f64 662c 696e 6465 783d  (final_df,index=
-00063960: 6f72 6967 5f64 6174 615f 696e 6465 782c  orig_data_index,
-00063970: 2063 6f6c 756d 6e73 3d78 6e61 6d65 7329   columns=xnames)
-00063980: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
-00063990: 6466 203d 2066 696e 616c 5f64 665b 6669  df = final_df[fi
-000639a0: 6e61 6c5f 785f 7661 7273 5d0d 0a20 2020  nal_x_vars]..   
-000639b0: 2020 2020 2066 696e 616c 5f64 662e 636f       final_df.co
-000639c0: 6c75 6d6e 7320 3d20 6669 6e61 6c5f 7465  lumns = final_te
-000639d0: 7874 5f76 6172 730d 0a20 2020 2020 2020  xt_vars..       
-000639e0: 2063 6f70 795f 7072 6564 7320 3d20 636f   copy_preds = co
-000639f0: 7079 2e64 6565 7063 6f70 7928 7072 6564  py.deepcopy(pred
-00063a00: 6963 746f 7273 290d 0a20 2020 2020 2020  ictors)..       
-00063a10: 2023 2323 2323 2323 2049 6620 7468 6520   ####### If the 
-00063a20: 6f72 6967 696e 616c 2063 6f6c 756d 6e27  original column'
-00063a30: 7320 6474 7970 6520 7761 7320 696e 7465  s dtype was inte
-00063a40: 6765 722c 2070 7574 2069 7420 6261 636b  ger, put it back
-00063a50: 2061 7320 696e 7465 6765 7220 2323 230d   as integer ###.
-00063a60: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
-00063a70: 685f 7072 6564 2069 6e20 636f 7079 5f70  h_pred in copy_p
-00063a80: 7265 6473 3a0d 0a20 2020 2020 2020 2020  reds:..         
-00063a90: 2020 2069 6620 6461 7461 5b65 6163 685f     if data[each_
-00063aa0: 7072 6564 5d2e 6474 7970 6520 3d3d 2069  pred].dtype == i
-00063ab0: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
-00063ac0: 2020 2020 2066 696e 616c 5f64 665b 6561       final_df[ea
-00063ad0: 6368 5f70 7265 645d 203d 2066 696e 616c  ch_pred] = final
-00063ae0: 5f64 665b 6561 6368 5f70 7265 645d 2e61  _df[each_pred].a
-00063af0: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-00063b00: 2020 2020 6669 6e61 6c5f 6466 5b74 6172      final_df[tar
-00063b10: 6765 7476 6172 5d20 3d20 6461 7461 5b74  getvar] = data[t
-00063b20: 6172 6765 7476 6172 5d2e 7661 6c75 6573  argetvar].values
-00063b30: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
-00063b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063b60: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00063b70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00063b80: 6669 6e61 6c5f 7465 7874 5f76 6172 732c  final_text_vars,
-00063b90: 206c 6d5f 702c 2066 696e 616c 5f64 662c   lm_p, final_df,
-00063ba0: 206d 642c 2066 696e 616c 5f78 5f76 6172   md, final_x_var
-00063bb0: 732c 6665 6174 7572 655f 7876 6172 5f64  s,feature_xvar_d
-00063bc0: 6963 740d 0a20 2020 2065 6c73 653a 0d0a  ict..    else:..
-00063bd0: 2020 2020 2020 2020 2323 2323 204a 7573          #### Jus
-00063be0: 7420 7265 7475 726e 2074 6865 2074 7261  t return the tra
-00063bf0: 6e73 666f 726d 6564 2064 6174 6166 7261  nsformed datafra
-00063c00: 6d65 2077 6974 6820 616c 6c20 6f72 6967  me with all orig
-00063c10: 2b70 6f6c 792b 696e 7478 6e20 7661 7273  +poly+intxn vars
-00063c20: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
-00063c30: 6466 203d 206d 642e 7472 616e 7366 6f72  df = md.transfor
-00063c40: 6d28 6461 7461 5b70 7265 6469 6374 6f72  m(data[predictor
-00063c50: 735d 290d 0a20 2020 2020 2020 2069 6620  s])..        if 
-00063c60: 4c6f 6f73 6556 6572 7369 6f6e 2873 6b6c  LooseVersion(skl
-00063c70: 6561 726e 2e5f 5f76 6572 7369 6f6e 5f5f  earn.__version__
-00063c80: 2920 3c20 4c6f 6f73 6556 6572 7369 6f6e  ) < LooseVersion
-00063c90: 2827 302e 3234 2e32 2729 3a0d 0a20 2020  ('0.24.2'):..   
-00063ca0: 2020 2020 2020 2020 2023 2050 6572 666f           # Perfo
-00063cb0: 726d 2061 6374 696f 6e20 666f 7220 7363  rm action for sc
-00063cc0: 696b 6974 2d6c 6561 726e 2076 6572 7369  ikit-learn versi
-00063cd0: 6f6e 2062 656c 6f77 2030 2e32 342e 320d  on below 0.24.2.
-00063ce0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00063cf0: 6e74 2822 5065 7266 6f72 6d69 6e67 2061  nt("Performing a
-00063d00: 6374 696f 6e20 666f 7220 7363 696b 6974  ction for scikit
-00063d10: 2d6c 6561 726e 2076 6572 7369 6f6e 2062  -learn version b
-00063d20: 656c 6f77 2030 2e32 342e 3222 290d 0a20  elow 0.24.2").. 
-00063d30: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
-00063d40: 2079 6f75 7220 636f 6465 2068 6572 6520   your code here 
-00063d50: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
-00063d60: 2076 6572 7369 6f6e 2062 656c 6f77 2030   version below 0
-00063d70: 2e32 342e 320d 0a20 2020 2020 2020 2020  .24.2..         
-00063d80: 2020 2078 6e61 6d65 7320 3d20 6d64 2e67     xnames = md.g
-00063d90: 6574 5f66 6561 7475 7265 5f6e 616d 6573  et_feature_names
-00063da0: 2829 0d0a 2020 2020 2020 2020 656c 7365  ()..        else
-00063db0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00063dc0: 2050 6572 666f 726d 2061 6374 696f 6e20   Perform action 
-00063dd0: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
-00063de0: 2076 6572 7369 6f6e 2030 2e32 342e 3220   version 0.24.2 
-00063df0: 616e 6420 6162 6f76 650d 0a20 2020 2020  and above..     
-00063e00: 2020 2020 2020 2070 7269 6e74 2822 5065         print("Pe
-00063e10: 7266 6f72 6d69 6e67 2061 6374 696f 6e20  rforming action 
-00063e20: 666f 7220 7363 696b 6974 2d6c 6561 726e  for scikit-learn
-00063e30: 2076 6572 7369 6f6e 2030 2e32 342e 3220   version 0.24.2 
-00063e40: 616e 6420 6162 6f76 6522 290d 0a20 2020  and above")..   
-00063e50: 2020 2020 2020 2020 2023 2041 6464 2079           # Add y
-00063e60: 6f75 7220 636f 6465 2068 6572 6520 666f  our code here fo
-00063e70: 7220 7363 696b 6974 2d6c 6561 726e 2076  r scikit-learn v
-00063e80: 6572 7369 6f6e 2030 2e32 342e 3220 616e  ersion 0.24.2 an
-00063e90: 6420 6162 6f76 650d 0a20 2020 2020 2020  d above..       
-00063ea0: 2020 2020 2078 6e61 6d65 7320 3d20 6d64       xnames = md
-00063eb0: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
-00063ec0: 6573 5f6f 7574 2829 2e74 6f6c 6973 7428  es_out().tolist(
-00063ed0: 2920 2323 2320 786e 616d 6573 2063 6f6e  ) ### xnames con
-00063ee0: 7461 696e 7320 616c 6c20 782d 6f6e 6c79  tains all x-only
-00063ef0: 2c20 506f 6c79 2061 6e64 2049 6e74 786e  , Poly and Intxn
-00063f00: 2076 6172 6961 626c 6573 2069 6e20 782d   variables in x-
-00063f10: 666f 726d 6174 0d0a 2020 2020 2020 2020  format..        
-00063f20: 6669 6e61 6c5f 6466 203d 2070 642e 4461  final_df = pd.Da
-00063f30: 7461 4672 616d 6528 6669 6e61 6c5f 6466  taFrame(final_df
-00063f40: 2c69 6e64 6578 3d6f 7269 675f 6461 7461  ,index=orig_data
-00063f50: 5f69 6e64 6578 2c20 636f 6c75 6d6e 733d  _index, columns=
-00063f60: 786e 616d 6573 290d 0a20 2020 2020 2020  xnames)..       
-00063f70: 2072 6574 7572 6e20 7072 6564 6963 746f   return predicto
-00063f80: 7273 2c20 6c6d 2c20 6669 6e61 6c5f 6466  rs, lm, final_df
-00063f90: 2c20 6d64 2c20 786e 616d 6573 2c20 2222  , md, xnames, ""
-00063fa0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00063fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063ff0: 2323 2323 0d0a 2323 2049 6d70 6f72 7420  ####..## Import 
-00064000: 736b 6c65 6172 6e0d 0a66 726f 6d20 736b  sklearn..from sk
-00064010: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
-00064020: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
-00064030: 7373 5f76 616c 5f73 636f 7265 2c4b 466f  ss_val_score,KFo
-00064040: 6c64 2c20 5374 7261 7469 6669 6564 4b46  ld, StratifiedKF
-00064050: 6f6c 640d 0a64 6566 2070 7269 6e74 5f6d  old..def print_m
-00064060: 6f64 656c 5f6d 6574 7269 6373 286d 6f64  odel_metrics(mod
-00064070: 656c 7479 7065 2c72 6567 2c58 2c79 2c66  eltype,reg,X,y,f
-00064080: 6974 5f66 6c61 673d 4661 6c73 652c 7665  it_flag=False,ve
-00064090: 7262 6f73 653d 3129 3a0d 0a20 2020 2023  rbose=1):..    #
-000640a0: 2323 2049 6620 6669 745f 666c 6167 2069  ## If fit_flag i
-000640b0: 7320 7365 7420 746f 2054 7275 652c 2074  s set to True, t
-000640c0: 6865 6e20 796f 7520 6d75 7374 2072 6574  hen you must ret
-000640d0: 7572 6e20 6120 6669 7474 6564 206d 6f64  urn a fitted mod
-000640e0: 656c 2023 2323 0d0a 2020 2020 2323 2320  el ###..    ### 
-000640f0: 2020 456c 7365 2079 6f75 206d 7573 7420    Else you must 
-00064100: 7265 7475 726e 2074 6865 2063 765f 7363  return the cv_sc
-00064110: 6f72 6573 2e6d 6561 6e20 6f6e 6c79 2023  ores.mean only #
-00064120: 2323 230d 0a20 2020 206e 5f73 706c 6974  ###..    n_split
-00064130: 7320 3d20 350d 0a20 2020 2069 6620 7665  s = 5..    if ve
-00064140: 7262 6f73 653e 303a 0d0a 2020 2020 2020  rbose>0:..      
-00064150: 2020 7072 696e 7428 224d 6f64 656c 2052    print("Model R
-00064160: 6570 6f72 7420 3a22 290d 0a20 2020 2020  eport :")..     
-00064170: 2020 2070 7269 6e74 2827 2020 2020 4e75     print('    Nu
-00064180: 6d62 6572 206f 6620 5661 7269 6162 6c65  mber of Variable
-00064190: 7320 3d20 272c 582e 7368 6170 655b 315d  s = ',X.shape[1]
-000641a0: 290d 0a20 2020 2069 6620 6d6f 6465 6c74  )..    if modelt
-000641b0: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
-000641c0: 6f6e 273a 0d0a 2020 2020 2020 2020 7363  on':..        sc
-000641d0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
-000641e0: 7473 3d6e 5f73 706c 6974 7329 0d0a 2020  ts=n_splits)..  
-000641f0: 2020 2020 2020 2370 6572 666f 726d 7320        #performs 
-00064200: 6372 6f73 7320 7661 6c69 6461 7469 6f6e  cross validation
-00064210: 0d0a 2020 2020 2020 2020 6376 5f73 636f  ..        cv_sco
-00064220: 7265 7320 3d20 6372 6f73 735f 7661 6c5f  res = cross_val_
-00064230: 7363 6f72 6528 7265 672c 582c 792e 7661  score(reg,X,y.va
-00064240: 6c75 6573 2e72 6176 656c 2829 2c63 763d  lues.ravel(),cv=
-00064250: 7363 762c 7363 6f72 696e 673d 276e 6567  scv,scoring='neg
-00064260: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
-00064270: 726f 7227 290d 0a20 2020 2020 2020 2063  ror')..        c
-00064280: 765f 7363 6f72 6573 203d 206e 702e 7371  v_scores = np.sq
-00064290: 7274 286e 702e 6162 7328 6376 5f73 636f  rt(np.abs(cv_sco
-000642a0: 7265 7329 290d 0a20 2020 2020 2020 2069  res))..        i
-000642b0: 6620 7665 7262 6f73 653a 0d0a 2020 2020  f verbose:..    
-000642c0: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-000642d0: 2020 2043 5620 524d 5345 2053 636f 7265     CV RMSE Score
-000642e0: 203a 2025 2e34 6720 2b2f 2d20 252e 3467   : %.4g +/- %.4g
-000642f0: 207c 204d 696e 203d 2025 2e34 6720 7c20   | Min = %.4g | 
-00064300: 4d61 7820 3d20 252e 3467 2220 2528 0d0a  Max = %.4g" %(..
-00064310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00064320: 6e70 2e6d 6561 6e28 6376 5f73 636f 7265  np.mean(cv_score
-00064330: 7329 2c6e 702e 7374 6428 6376 5f73 636f  s),np.std(cv_sco
-00064340: 7265 7329 2c0d 0a20 2020 2020 2020 2020  res),..         
-00064350: 2020 2020 2020 2020 6e70 2e6d 696e 2863          np.min(c
-00064360: 765f 7363 6f72 6573 292c 6e70 2e6d 6178  v_scores),np.max
-00064370: 2863 765f 7363 6f72 6573 2929 290d 0a20  (cv_scores))).. 
-00064380: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00064390: 2020 7363 7620 3d20 5374 7261 7469 6669    scv = Stratifi
-000643a0: 6564 4b46 6f6c 6428 6e5f 7370 6c69 7473  edKFold(n_splits
-000643b0: 3d6e 5f73 706c 6974 732c 2072 616e 646f  =n_splits, rando
-000643c0: 6d5f 7374 6174 653d 302c 2073 6875 6666  m_state=0, shuff
-000643d0: 6c65 3d54 7275 6529 0d0a 2020 2020 2020  le=True)..      
-000643e0: 2020 2323 2320 7573 6520 4631 2077 6569    ### use F1 wei
-000643f0: 6768 7465 6420 7369 6e63 6520 6974 2077  ghted since it w
-00064400: 6f72 6b73 206f 6e20 6d75 6c74 6970 6c65  orks on multiple
-00064410: 2063 6c61 7373 6573 2061 7320 7765 6c6c   classes as well
-00064420: 2061 7320 6269 6e61 7279 2023 230d 0a20   as binary ##.. 
-00064430: 2020 2020 2020 2063 765f 7363 6f72 6573         cv_scores
-00064440: 203d 2063 726f 7373 5f76 616c 5f73 636f   = cross_val_sco
-00064450: 7265 2872 6567 2c58 2c79 2e76 616c 7565  re(reg,X,y.value
-00064460: 732e 7261 7665 6c28 292c 6376 3d73 6376  s.ravel(),cv=scv
-00064470: 2c73 636f 7269 6e67 3d27 6631 5f77 6569  ,scoring='f1_wei
-00064480: 6768 7465 6427 290d 0a20 2020 2020 2020  ghted')..       
-00064490: 2069 6620 7665 7262 6f73 653e 303a 0d0a   if verbose>0:..
-000644a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000644b0: 7428 2220 2020 2043 5620 5765 6967 6874  t("    CV Weight
-000644c0: 6564 2046 3120 5363 6f72 6520 3a20 252e  ed F1 Score : %.
-000644d0: 3467 202b 2f2d 2025 2e34 6720 7c20 4d69  4g +/- %.4g | Mi
-000644e0: 6e20 3d20 252e 3467 207c 204d 6178 203d  n = %.4g | Max =
-000644f0: 2025 2e34 6722 2025 2028 0d0a 2020 2020   %.4g" % (..    
-00064500: 2020 2020 2020 2020 2020 2020 6e70 2e6d              np.m
-00064510: 6561 6e28 6376 5f73 636f 7265 7329 2c6e  ean(cv_scores),n
-00064520: 702e 7374 6428 6376 5f73 636f 7265 7329  p.std(cv_scores)
-00064530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00064540: 2020 2020 6e70 2e6d 696e 2863 765f 7363      np.min(cv_sc
-00064550: 6f72 6573 292c 6e70 2e6d 6178 2863 765f  ores),np.max(cv_
-00064560: 7363 6f72 6573 2929 290d 0a20 2020 2069  scores)))..    i
-00064570: 6620 6669 745f 666c 6167 3a0d 0a20 2020  f fit_flag:..   
-00064580: 2020 2020 2072 6574 7572 6e20 7265 672e       return reg.
-00064590: 6669 7428 582c 7929 2c20 2063 765f 7363  fit(X,y),  cv_sc
-000645a0: 6f72 6573 2e6d 6561 6e28 290d 0a20 2020  ores.mean()..   
-000645b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000645c0: 7265 7475 726e 2020 6376 5f73 636f 7265  return  cv_score
-000645d0: 732e 6d65 616e 2829 0d0a 2323 2323 2323  s.mean()..######
-000645e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000645f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064630: 2323 2323 2323 2323 0d0a 6465 6620 7365  ########..def se
-00064640: 6c65 6374 5f62 6573 745f 7661 7269 6162  lect_best_variab
-00064650: 6c65 7328 6d64 2c20 7265 672c 2064 662c  les(md, reg, df,
-00064660: 6e61 6d65 732c 6e5f 6f72 6967 5f66 6561  names,n_orig_fea
-00064670: 7475 7265 732c 4164 645f 506f 6c79 2c76  tures,Add_Poly,v
-00064680: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
-00064690: 2222 220d 0a20 2020 2054 6869 7320 7072  """..    This pr
-000646a0: 6f67 7261 6d20 7365 6c65 6374 7320 7468  ogram selects th
-000646b0: 6520 746f 7020 3130 2520 6f66 2069 6e74  e top 10% of int
-000646c0: 6572 6163 7469 6f6e 2076 6172 6961 626c  eraction variabl
-000646d0: 6573 2063 7265 6174 6564 2075 7369 6e67  es created using
-000646e0: 206c 696e 6561 7220 6d6f 6465 6c69 6e67   linear modeling
-000646f0: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
-00064700: 6466 3930 203d 2064 665b 6162 7328 6466  df90 = df[abs(df
-00064710: 5b27 436f 6566 6669 6369 656e 7420 5661  ['Coefficient Va
-00064720: 6c75 6573 275d 293e 3d64 665b 2743 6f65  lues'])>=df['Coe
-00064730: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
-00064740: 5d2e 7175 616e 7469 6c65 2830 2e39 3029  ].quantile(0.90)
-00064750: 5d0d 0a20 2020 2069 6620 7665 7262 6f73  ]..    if verbos
-00064760: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-00064770: 2064 6639 302e 706c 6f74 280d 0a20 2020   df90.plot(..   
-00064780: 2020 2020 2020 2020 206b 696e 643d 2762           kind='b
-00064790: 6172 272c 783d 2749 6e74 6572 6163 7469  ar',x='Interacti
-000647a0: 6f6e 2056 6172 6961 626c 6520 4e61 6d65  on Variable Name
-000647b0: 7327 2c79 3d27 436f 6566 6669 6369 656e  s',y='Coefficien
-000647c0: 7420 5661 6c75 6573 272c 0d0a 2020 2020  t Values',..    
-000647d0: 2020 2020 2020 2020 7469 746c 653d 2754          title='T
-000647e0: 6f70 2031 3025 2056 6172 6961 626c 6520  op 10% Variable 
-000647f0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
-00064800: 2074 6865 6972 2043 6f65 6666 6963 6965   their Coefficie
-00064810: 6e74 7320 2729 0d0a 2020 2020 6966 2076  nts ')..    if v
-00064820: 6572 626f 7365 203e 3d20 313a 0d0a 2020  erbose >= 1:..  
-00064830: 2020 2020 2020 6466 2e70 6c6f 7428 6b69        df.plot(ki
-00064840: 6e64 3d27 6261 7227 2c78 3d27 496e 7465  nd='bar',x='Inte
-00064850: 7261 6374 696f 6e20 5661 7269 6162 6c65  raction Variable
-00064860: 204e 616d 6573 272c 793d 2743 6f65 6666   Names',y='Coeff
-00064870: 6963 6965 6e74 2056 616c 7565 7327 2c0d  icient Values',.
-00064880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00064890: 2074 6974 6c65 3d27 416c 6c20 5661 7269   title='All Vari
-000648a0: 6162 6c65 2049 6e74 6572 6163 7469 6f6e  able Interaction
-000648b0: 7320 616e 6420 7468 6569 7220 436f 6566  s and their Coef
-000648c0: 6669 6369 656e 7473 272c 6669 6773 697a  ficients',figsiz
-000648d0: 653d 2832 302c 3130 2929 0d0a 2020 2020  e=(20,10))..    
-000648e0: 696e 7465 7261 6374 696f 6e73 203d 2064  interactions = d
-000648f0: 6639 305b 2749 6e74 6572 6163 7469 6f6e  f90['Interaction
-00064900: 2056 6172 6961 626c 6520 4e61 6d65 7327   Variable Names'
-00064910: 5d2e 7661 6c75 6573 2e74 6f6c 6973 7428  ].values.tolist(
-00064920: 290d 0a20 2020 2070 7269 6e74 2827 2564  )..    print('%d
-00064930: 2049 6e74 6572 6163 7469 6f6e 2061 6e64   Interaction and
-00064940: 2050 6f6c 796e 6f6d 6961 6c20 7661 7269   Polynomial vari
-00064950: 6162 6c65 2873 2920 7365 6c65 6374 6564  able(s) selected
-00064960: 2e2e 2e5c 6e27 2025 6c65 6e28 696e 7465  ...\n' %len(inte
-00064970: 7261 6374 696f 6e73 2929 0d0a 2020 2020  ractions))..    
-00064980: 6669 6e61 6c76 6172 7320 3d20 6e61 6d65  finalvars = name
-00064990: 7320 2b20 696e 7465 7261 6374 696f 6e73  s + interactions
-000649a0: 0d0a 2020 2020 2366 696e 616c 7661 7273  ..    #finalvars
-000649b0: 5f69 6e64 6578 203d 205b 6466 5b64 665b  _index = [df[df[
-000649c0: 2749 6e74 6572 6163 7469 6f6e 2056 6172  'Interaction Var
-000649d0: 6961 626c 6520 4e61 6d65 7327 5d3d 3d78  iable Names']==x
-000649e0: 5d2e 696e 6465 785b 305d 2066 6f72 2078  ].index[0] for x
-000649f0: 2069 6e20 6669 6e61 6c76 6172 735d 0d0a   in finalvars]..
-00064a00: 2020 2020 7265 7475 726e 2066 696e 616c      return final
-00064a10: 7661 7273 0d0a 2323 2323 2323 2323 2323  vars..##########
-00064a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00064a70: 2323 2323 0d0a 6672 6f6d 2073 6b6c 6561  ####..from sklea
-00064a80: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00064a90: 7420 726f 635f 6375 7276 652c 2061 7563  t roc_curve, auc
-00064aa0: 0d0a 6672 6f6d 2073 6369 7079 2069 6d70  ..from scipy imp
-00064ab0: 6f72 7420 696e 7465 7270 0d0a 696d 706f  ort interp..impo
-00064ac0: 7274 2070 616e 6461 7320 6173 2070 640d  rt pandas as pd.
-00064ad0: 0a64 6566 2044 7261 775f 524f 435f 4d43  .def Draw_ROC_MC
-00064ae0: 5f4d 4c28 6d6f 6465 6c2c 2058 5f74 6573  _ML(model, X_tes
-00064af0: 742c 2079 5f74 7275 652c 2074 6172 6765  t, y_true, targe
-00064b00: 742c 206d 6f64 656c 5f6e 616d 652c 2076  t, model_name, v
-00064b10: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
-00064b20: 6669 6773 697a 6520 3d20 2831 302c 2036  figsize = (10, 6
-00064b30: 290d 0a20 2020 2079 5f70 726f 6261 203d  )..    y_proba =
-00064b40: 206d 6f64 656c 2e70 7265 6469 6374 5f70   model.predict_p
-00064b50: 726f 6261 2858 5f74 6573 7429 0d0a 2020  roba(X_test)..  
-00064b60: 2020 7072 6564 6963 7465 6420 3d20 636f    predicted = co
-00064b70: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
-00064b80: 6f62 6129 0d0a 2020 2020 7468 7265 7368  oba)..    thresh
-00064b90: 6f6c 6420 3d20 302e 3530 0d0a 2020 2020  old = 0.50..    
-00064ba0: 795f 7072 6564 203d 206d 6f64 656c 2e70  y_pred = model.p
-00064bb0: 7265 6469 6374 2858 5f74 6573 7429 0d0a  redict(X_test)..
-00064bc0: 2020 2020 6670 7220 3d20 6469 6374 2829      fpr = dict()
-00064bd0: 0d0a 2020 2020 7470 7220 3d20 6469 6374  ..    tpr = dict
-00064be0: 2829 0d0a 2020 2020 726f 635f 6175 6320  ()..    roc_auc 
-00064bf0: 3d20 6469 6374 2829 0d0a 2020 2020 6974  = dict()..    it
-00064c00: 6572 6174 696f 6e73 203d 2030 0d0a 2020  erations = 0..  
-00064c10: 2020 7261 7265 5f63 6c61 7373 203d 2066    rare_class = f
-00064c20: 696e 645f 7261 7265 5f63 6c61 7373 2879  ind_rare_class(y
-00064c30: 5f74 7275 6529 0d0a 2020 2020 6966 2069  _true)..    if i
-00064c40: 7369 6e73 7461 6e63 6528 7461 7267 6574  sinstance(target
-00064c50: 2c73 7472 293a 0d0a 2020 2020 2020 2020  ,str):..        
-00064c60: 7461 7267 6574 203d 205b 7461 7267 6574  target = [target
-00064c70: 5d0d 0a20 2020 2066 6f72 2074 6172 6720  ]..    for targ 
-00064c80: 696e 2074 6172 6765 743a 0d0a 2020 2020  in target:..    
-00064c90: 2020 2020 6966 206c 656e 286c 6566 745f      if len(left_
-00064ca0: 7375 6274 7261 6374 286e 702e 756e 6971  subtract(np.uniq
-00064cb0: 7565 2879 5f74 7275 6529 2c6e 702e 756e  ue(y_true),np.un
-00064cc0: 6971 7565 2879 5f70 7265 6429 2929 203d  ique(y_pred))) =
-00064cd0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-00064ce0: 2020 636c 6173 7365 7320 3d20 6c69 7374    classes = list
-00064cf0: 2872 616e 6765 286c 656e 286e 702e 756e  (range(len(np.un
-00064d00: 6971 7565 2879 5f74 7275 6529 2929 290d  ique(y_true)))).
-00064d10: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00064d20: 2020 2020 2020 2020 2020 2020 636c 6173              clas
-00064d30: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
-00064d40: 286c 656e 286e 702e 756e 6971 7565 2879  (len(np.unique(y
-00064d50: 5f70 7265 6429 2929 290d 0a20 2020 2020  _pred))))..     
-00064d60: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
-00064d70: 656e 2863 6c61 7373 6573 290d 0a20 2020  en(classes)..   
-00064d80: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
-00064d90: 6d65 2e6c 6f77 6572 2829 203d 3d20 2763  me.lower() == 'c
-00064da0: 6174 626f 6f73 7427 3a0d 0a20 2020 2020  atboost':..     
-00064db0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00064dc0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
-00064dd0: 7265 6420 3d20 2879 5f70 726f 6261 3e30  red = (y_proba>0
-00064de0: 2e35 292e 6173 7479 7065 2869 6e74 292e  .5).astype(int).
-00064df0: 646f 7428 636c 6173 7365 7329 0d0a 2020  dot(classes)..  
-00064e00: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00064e10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00064e20: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
-00064e30: 2069 6620 6e5f 636c 6173 7365 7320 3d3d   if n_classes ==
-00064e40: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
-00064e50: 2023 2323 2041 6c77 6179 7320 7365 7420   ### Always set 
-00064e60: 7261 7265 5f63 6c61 7373 2074 6f20 3120  rare_class to 1 
-00064e70: 7768 656e 2074 6865 7265 2061 7265 206f  when there are o
-00064e80: 6e6c 7920 3220 636c 6173 7365 7320 666f  nly 2 classes fo
-00064e90: 7220 6472 6177 696e 6720 524f 4320 4375  r drawing ROC Cu
-00064ea0: 7276 6521 0d0a 2020 2020 2020 2020 2020  rve!..          
-00064eb0: 2020 795f 7465 7374 203d 2063 6f70 792e    y_test = copy.
-00064ec0: 6465 6570 636f 7079 2879 5f74 7275 6529  deepcopy(y_true)
-00064ed0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00064ee0: 6564 6963 7465 6420 5b3a 2c30 5d20 3d20  edicted [:,0] = 
-00064ef0: 2870 7265 6469 6374 6564 205b 3a2c 305d  (predicted [:,0]
-00064f00: 203e 3d20 2831 2d6d 5f74 6872 6573 6829   >= (1-m_thresh)
-00064f10: 292e 6173 7479 7065 2827 696e 7427 290d  ).astype('int').
-00064f20: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
-00064f30: 6469 6374 6564 205b 3a2c 315d 203d 2028  dicted [:,1] = (
-00064f40: 7072 6564 6963 7465 6420 5b3a 2c31 5d20  predicted [:,1] 
-00064f50: 3e20 7468 7265 7368 6f6c 6429 2e61 7374  > threshold).ast
-00064f60: 7970 6528 2769 6e74 2729 0d0a 2020 2020  ype('int')..    
-00064f70: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
-00064f80: 2070 7265 6469 6374 6564 5b3a 2c72 6172   predicted[:,rar
-00064f90: 655f 636c 6173 735d 0d0a 2020 2020 2020  e_class]..      
-00064fa0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00064fb0: 2020 2020 2079 5f74 6573 7420 3d20 6c61       y_test = la
-00064fc0: 6265 6c5f 6269 6e61 7269 7a65 2879 5f74  bel_binarize(y_t
-00064fd0: 7275 652c 2063 6c61 7373 6573 290d 0a20  rue, classes).. 
-00064fe0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00064ff0: 2020 2020 2020 2020 2069 6620 6e5f 636c           if n_cl
-00065000: 6173 7365 7320 3e20 323a 0d0a 2020 2020  asses > 2:..    
-00065010: 2020 2020 2020 2020 2020 2020 6966 2079              if y
-00065020: 5f74 6573 742e 7368 6170 655b 315d 203d  _test.shape[1] =
-00065030: 3d20 795f 7072 6f62 612e 7368 6170 655b  = y_proba.shape[
-00065040: 315d 3a0d 0a20 2020 2020 2020 2020 2020  1]:..           
-00065050: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
-00065060: 203d 206c 6973 7428 7261 6e67 6528 795f   = list(range(y_
-00065070: 7465 7374 2e73 6861 7065 5b31 5d29 290d  test.shape[1])).
-00065080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065090: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000650a0: 2020 2020 2020 2020 2020 2020 6966 2079              if y
-000650b0: 5f70 726f 6261 2e73 6861 7065 5b31 5d20  _proba.shape[1] 
-000650c0: 3e20 795f 7465 7374 2e73 6861 7065 5b31  > y_test.shape[1
-000650d0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-000650e0: 2020 2020 2020 2020 2020 2020 636c 6173              clas
-000650f0: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
-00065100: 2879 5f70 726f 6261 2e73 6861 7065 5b31  (y_proba.shape[1
-00065110: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
-00065120: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00065130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065140: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-00065150: 3d20 6c69 7374 2872 616e 6765 2879 5f74  = list(range(y_t
-00065160: 6573 742e 7368 6170 655b 315d 2929 0d0a  est.shape[1]))..
-00065170: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00065180: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00065190: 730d 0a20 2020 2020 2020 2069 6620 6e5f  s..        if n_
-000651a0: 636c 6173 7365 7320 3d3d 2032 3a0d 0a20  classes == 2:.. 
-000651b0: 2020 2020 2020 2020 2020 2069 7465 7261             itera
-000651c0: 7469 6f6e 7320 3d20 310d 0a20 2020 2020  tions = 1..     
-000651d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000651e0: 2020 2020 2020 6974 6572 6174 696f 6e73        iterations
-000651f0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00065200: 286e 5f63 6c61 7373 6573 290d 0a20 2020  (n_classes)..   
-00065210: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-00065220: 2323 2323 2323 2323 2323 2020 2054 6869  ##########   Thi
-00065230: 7320 6973 2077 6865 7265 2079 6f75 2063  s is where you c
-00065240: 616c 6375 6c61 7465 2052 4f43 5f41 5543  alculate ROC_AUC
-00065250: 2066 6f72 2061 6c6c 2063 6c61 7373 6573   for all classes
-00065260: 2023 2323 2323 2323 2323 0d0a 2020 2020   #########..    
-00065270: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00065280: 6765 2869 7465 7261 7469 6f6e 7329 3a0d  ge(iterations):.
-00065290: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000652a0: 6e5f 636c 6173 7365 733d 3d32 3a0d 0a20  n_classes==2:.. 
-000652b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000652c0: 7072 5b72 6172 655f 636c 6173 735d 2c20  pr[rare_class], 
-000652d0: 7470 725b 7261 7265 5f63 6c61 7373 5d2c  tpr[rare_class],
-000652e0: 205f 203d 2072 6f63 5f63 7572 7665 2879   _ = roc_curve(y
-000652f0: 5f74 6573 742e 7261 7665 6c28 292c 2079  _test.ravel(), y
-00065300: 5f70 726f 6261 5b3a 2c72 6172 655f 636c  _proba[:,rare_cl
-00065310: 6173 735d 290d 0a20 2020 2020 2020 2020  ass])..         
-00065320: 2020 2020 2020 2072 6f63 5f61 7563 5b72         roc_auc[r
-00065330: 6172 655f 636c 6173 735d 203d 2061 7563  are_class] = auc
-00065340: 2866 7072 5b72 6172 655f 636c 6173 735d  (fpr[rare_class]
-00065350: 2c20 7470 725b 7261 7265 5f63 6c61 7373  , tpr[rare_class
-00065360: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00065370: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00065380: 2020 2020 2020 2066 7072 5b69 5d2c 2074         fpr[i], t
-00065390: 7072 5b69 5d2c 205f 203d 2072 6f63 5f63  pr[i], _ = roc_c
-000653a0: 7572 7665 2879 5f74 6573 745b 3a2c 695d  urve(y_test[:,i]
-000653b0: 2c20 795f 7072 6f62 615b 3a2c 695d 290d  , y_proba[:,i]).
-000653c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000653d0: 2072 6f63 5f61 7563 5b69 5d20 3d20 6175   roc_auc[i] = au
-000653e0: 6328 6670 725b 695d 2c20 7470 725b 695d  c(fpr[i], tpr[i]
-000653f0: 290d 0a20 2020 2020 2020 2023 2323 2043  )..        ### C
-00065400: 6f6d 7075 7465 204d 6963 726f 2041 7665  ompute Micro Ave
-00065410: 7261 6765 2077 6869 6368 2069 7320 6120  rage which is a 
-00065420: 726f 772d 6279 2d72 6f77 2073 636f 7265  row-by-row score
-00065430: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
-00065440: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00065450: 2020 2020 2020 2020 6966 206e 5f63 6c61          if n_cla
-00065460: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
-00065470: 2020 2020 2020 2020 2020 2020 6670 725b              fpr[
-00065480: 226d 6963 726f 225d 2c20 7470 725b 226d  "micro"], tpr["m
-00065490: 6963 726f 225d 2c20 5f20 3d20 726f 635f  icro"], _ = roc_
-000654a0: 6375 7276 6528 795f 7465 7374 2e72 6176  curve(y_test.rav
-000654b0: 656c 2829 2c20 795f 7072 6564 2e72 6176  el(), y_pred.rav
-000654c0: 656c 2829 290d 0a20 2020 2020 2020 2020  el())..         
-000654d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000654e0: 2020 2020 2020 2020 2020 6670 725b 226d            fpr["m
-000654f0: 6963 726f 225d 2c20 7470 725b 226d 6963  icro"], tpr["mic
-00065500: 726f 225d 2c20 5f20 3d20 726f 635f 6375  ro"], _ = roc_cu
-00065510: 7276 6528 795f 7465 7374 2e72 6176 656c  rve(y_test.ravel
-00065520: 2829 2c6c 6162 656c 5f62 696e 6172 697a  (),label_binariz
-00065530: 6528 795f 7072 6564 2c20 636c 6173 7365  e(y_pred, classe
-00065540: 7329 2e72 6176 656c 2829 290d 0a20 2020  s).ravel())..   
-00065550: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-00065560: 2020 2020 2020 2020 2020 6966 2079 5f74            if y_t
-00065570: 6573 742e 7261 7665 6c28 292e 7368 6170  est.ravel().shap
-00065580: 655b 305d 2021 3d20 795f 7072 6564 2e72  e[0] != y_pred.r
-00065590: 6176 656c 2829 2e73 6861 7065 5b30 5d3a  avel().shape[0]:
-000655a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000655b0: 2020 6670 725b 226d 6963 726f 225d 2c20    fpr["micro"], 
-000655c0: 7470 725b 226d 6963 726f 225d 2c20 5f20  tpr["micro"], _ 
-000655d0: 3d20 726f 635f 6375 7276 6528 795f 7465  = roc_curve(y_te
-000655e0: 7374 5b3a 2c3a 6e5f 636c 6173 7365 735d  st[:,:n_classes]
-000655f0: 2e72 6176 656c 2829 2c20 795f 7072 6f62  .ravel(), y_prob
-00065600: 615b 3a2c 3a6e 5f63 6c61 7373 6573 5d2e  a[:,:n_classes].
-00065610: 7261 7665 6c28 2929 0d0a 2020 2020 2020  ravel())..      
-00065620: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00065630: 2020 2020 2020 2020 2020 2020 2066 7072               fpr
-00065640: 5b22 6d69 6372 6f22 5d2c 2074 7072 5b22  ["micro"], tpr["
-00065650: 6d69 6372 6f22 5d2c 205f 203d 2072 6f63  micro"], _ = roc
-00065660: 5f63 7572 7665 2879 5f74 6573 742e 7261  _curve(y_test.ra
-00065670: 7665 6c28 292c 2079 5f70 726f 6261 5b3a  vel(), y_proba[:
-00065680: 2c72 6172 655f 636c 6173 735d 2e72 6176  ,rare_class].rav
-00065690: 656c 2829 290d 0a20 2020 2020 2020 2074  el())..        t
-000656a0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-000656b0: 2072 6f63 5f61 7563 5b22 6d69 6372 6f22   roc_auc["micro"
-000656c0: 5d20 3d20 6175 6328 6670 725b 226d 6963  ] = auc(fpr["mic
-000656d0: 726f 225d 2c20 7470 725b 226d 6963 726f  ro"], tpr["micro
-000656e0: 225d 290d 0a20 2020 2020 2020 2065 7863  "])..        exc
-000656f0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00065700: 2020 7061 7373 0d0a 2020 2020 2020 2020    pass..        
-00065710: 2320 6d69 6372 6f2d 6176 6572 6167 6520  # micro-average 
-00065720: 524f 4320 6375 7276 6520 616e 6420 524f  ROC curve and RO
-00065730: 4320 6172 6561 2068 6173 2062 6565 6e20  C area has been 
-00065740: 636f 6d70 7574 6564 0d0a 2020 2020 2020  computed..      
-00065750: 2020 6c61 6265 6c73 203d 205b 5d0d 0a20    labels = [].. 
-00065760: 2020 2020 2020 2069 6620 6e5f 636c 6173         if n_clas
-00065770: 7365 7320 3c3d 2032 3a0d 0a20 2020 2020  ses <= 2:..     
-00065780: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-00065790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000657a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000657b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000657c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000657d0: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-000657e0: 2020 2023 2050 6c6f 7420 6f66 2061 2052     # Plot of a R
-000657f0: 4f43 2063 7572 7665 2066 6f72 206f 6e65  OC curve for one
-00065800: 2063 6c61 7373 0d0a 2020 2020 2020 2020   class..        
-00065810: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
-00065820: 6967 7369 7a65 3d66 6967 7369 7a65 290d  igsize=figsize).
-00065830: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
-00065840: 2e70 6c6f 7428 6670 725b 7261 7265 5f63  .plot(fpr[rare_c
-00065850: 6c61 7373 5d2c 2074 7072 5b72 6172 655f  lass], tpr[rare_
-00065860: 636c 6173 735d 2c20 6c61 6265 6c3d 2752  class], label='R
-00065870: 4f43 2063 7572 7665 2028 4155 4320 3d20  OC curve (AUC = 
-00065880: 2530 2e35 6629 2720 2520 726f 635f 6175  %0.5f)' % roc_au
-00065890: 635b 7261 7265 5f63 6c61 7373 5d29 0d0a  c[rare_class])..
-000658a0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-000658b0: 706c 6f74 285b 302c 2031 5d2c 205b 302c  plot([0, 1], [0,
-000658c0: 2031 5d2c 2027 6b2d 2d27 290d 0a20 2020   1], 'k--')..   
-000658d0: 2020 2020 2020 2020 2070 6c74 2e78 6c69           plt.xli
-000658e0: 6d28 5b30 2e30 2c20 312e 305d 290d 0a20  m([0.0, 1.0]).. 
-000658f0: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
-00065900: 6c69 6d28 5b30 2e30 2c20 312e 3035 5d29  lim([0.0, 1.05])
-00065910: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
-00065920: 742e 786c 6162 656c 2827 4661 6c73 6520  t.xlabel('False 
-00065930: 506f 7369 7469 7665 2052 6174 6527 290d  Positive Rate').
-00065940: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
-00065950: 2e79 6c61 6265 6c28 2754 7275 6520 506f  .ylabel('True Po
-00065960: 7369 7469 7665 2052 6174 6527 290d 0a20  sitive Rate').. 
-00065970: 2020 2020 2020 2020 2020 2070 6c74 2e74             plt.t
-00065980: 6974 6c65 2827 524f 4320 4375 7276 6520  itle('ROC Curve 
-00065990: 666f 7220 5072 6564 6963 7469 6f6e 7320  for Predictions 
-000659a0: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
-000659b0: 2066 6f72 2074 6172 6765 743a 2025 7327   for target: %s'
-000659c0: 2025 7461 7267 290d 0a20 2020 2020 2020   %targ)..       
-000659d0: 2020 2020 2070 6c74 2e6c 6567 656e 6428       plt.legend(
-000659e0: 6c6f 633d 226c 6f77 6572 2072 6967 6874  loc="lower right
-000659f0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00065a00: 706c 742e 7368 6f77 2829 3b0d 0a20 2020  plt.show();..   
-00065a10: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00065a20: 2020 2020 2320 436f 6d70 7574 6520 6d61      # Compute ma
-00065a30: 6372 6f2d 6176 6572 6167 6520 524f 4320  cro-average ROC 
-00065a40: 6375 7276 6520 616e 6420 524f 4320 6172  curve and ROC ar
-00065a50: 6561 0d0a 2020 2020 2020 2020 2020 2020  ea..            
-00065a60: 6669 672c 2061 7820 3d20 706c 742e 7375  fig, ax = plt.su
-00065a70: 6270 6c6f 7473 2866 6967 7369 7a65 3d66  bplots(figsize=f
-00065a80: 6967 7369 7a65 290d 0a20 2020 2020 2020  igsize)..       
-00065a90: 2020 2020 2063 6f6c 6f72 7320 3d20 6379       colors = cy
-00065aa0: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
-00065ab0: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
-00065ac0: 6b27 290d 0a20 2020 2020 2020 2020 2020  k')..           
-00065ad0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00065ae0: 6974 6572 6174 696f 6e73 293a 0d0a 0d0a  iterations):....
-00065af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065b00: 2320 4669 7273 7420 6167 6772 6567 6174  # First aggregat
-00065b10: 6520 616c 6c20 6661 6c73 6520 706f 7369  e all false posi
-00065b20: 7469 7665 2072 6174 6573 0d0a 2020 2020  tive rates..    
-00065b30: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-00065b40: 6670 7220 3d20 6e70 2e75 6e69 7175 6528  fpr = np.unique(
-00065b50: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
-00065b60: 6670 725b 695d 2066 6f72 2069 2069 6e20  fpr[i] for i in 
-00065b70: 7261 6e67 6528 6e5f 636c 6173 7365 7329  range(n_classes)
-00065b80: 5d29 290d 0a0d 0a20 2020 2020 2020 2020  ]))....         
-00065b90: 2020 2020 2020 2023 2054 6865 6e20 696e         # Then in
-00065ba0: 7465 7270 6f6c 6174 6520 616c 6c20 524f  terpolate all RO
-00065bb0: 4320 6375 7276 6573 2061 7420 7468 6973  C curves at this
-00065bc0: 2070 6f69 6e74 730d 0a20 2020 2020 2020   points..       
-00065bd0: 2020 2020 2020 2020 206d 6561 6e5f 7470           mean_tp
-00065be0: 7220 3d20 6e70 2e7a 6572 6f73 5f6c 696b  r = np.zeros_lik
-00065bf0: 6528 616c 6c5f 6670 7229 0d0a 2020 2020  e(all_fpr)..    
-00065c00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00065c10: 6a20 696e 2072 616e 6765 286e 5f63 6c61  j in range(n_cla
-00065c20: 7373 6573 293a 0d0a 2020 2020 2020 2020  sses):..        
-00065c30: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
-00065c40: 5f74 7072 202b 3d20 696e 7465 7270 2861  _tpr += interp(a
-00065c50: 6c6c 5f66 7072 2c20 6670 725b 6a5d 2c20  ll_fpr, fpr[j], 
-00065c60: 7470 725b 6a5d 290d 0a0d 0a20 2020 2020  tpr[j])....     
-00065c70: 2020 2020 2020 2020 2020 2023 2046 696e             # Fin
-00065c80: 616c 6c79 2061 7665 7261 6765 2069 7420  ally average it 
-00065c90: 616e 6420 636f 6d70 7574 6520 4155 430d  and compute AUC.
-00065ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065cb0: 206d 6561 6e5f 7470 7220 2f3d 206e 5f63   mean_tpr /= n_c
-00065cc0: 6c61 7373 6573 0d0a 0d0a 2020 2020 2020  lasses....      
-00065cd0: 2020 2020 2020 2020 2020 6670 725b 226d            fpr["m
-00065ce0: 6163 726f 225d 203d 2061 6c6c 5f66 7072  acro"] = all_fpr
-00065cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00065d00: 2020 7470 725b 226d 6163 726f 225d 203d    tpr["macro"] =
-00065d10: 206d 6561 6e5f 7470 720d 0a20 2020 2020   mean_tpr..     
-00065d20: 2020 2020 2020 2020 2020 2072 6f63 5f61             roc_a
-00065d30: 7563 5b22 6d61 6372 6f22 5d20 3d20 6175  uc["macro"] = au
-00065d40: 6328 6670 725b 226d 6163 726f 225d 2c20  c(fpr["macro"], 
-00065d50: 7470 725b 226d 6163 726f 225d 290d 0a0d  tpr["macro"])...
-00065d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065d70: 2023 2050 6c6f 7420 616c 6c20 524f 4320   # Plot all ROC 
-00065d80: 6375 7276 6573 0d0a 2020 2020 2020 2020  curves..        
-00065d90: 2020 2020 2020 2020 6c77 203d 2032 0d0a          lw = 2..
-00065da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065db0: 636f 6c6f 7220 3d20 6e65 7874 2863 6f6c  color = next(col
-00065dc0: 6f72 7329 0d0a 2020 2020 2020 2020 2020  ors)..          
-00065dd0: 2020 2020 2020 6178 2e70 6c6f 7428 6670        ax.plot(fp
-00065de0: 725b 695d 2c20 7470 725b 695d 2c20 636f  r[i], tpr[i], co
-00065df0: 6c6f 723d 636f 6c6f 722c 206c 773d 6c77  lor=color, lw=lw
-00065e00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00065e10: 2020 206c 6162 656c 732e 6170 7065 6e64     labels.append
-00065e20: 2827 524f 4320 6375 7276 6520 6f66 2063  ('ROC curve of c
-00065e30: 6c61 7373 2025 6420 2861 7265 6120 3d20  lass %d (area = 
-00065e40: 2530 2e32 6629 2720 2528 692c 2072 6f63  %0.2f)' %(i, roc
-00065e50: 5f61 7563 5b69 5d29 290d 0a20 2020 2020  _auc[i]))..     
-00065e60: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00065e70: 2020 2020 2020 2020 2020 2020 206c 6162               lab
-00065e80: 656c 732e 6170 7065 6e64 2827 6d69 6372  els.append('micr
-00065e90: 6f2d 6176 6572 6167 6520 524f 4320 6375  o-average ROC cu
-00065ea0: 7276 6520 2861 7265 6120 3d20 7b30 3a30  rve (area = {0:0
-00065eb0: 2e32 667d 2927 0d0a 2020 2020 2020 2020  .2f})'..        
-00065ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065ed0: 2020 2020 2020 2027 272e 666f 726d 6174         ''.format
-00065ee0: 2872 6f63 5f61 7563 5b22 6d69 6372 6f22  (roc_auc["micro"
-00065ef0: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
-00065f00: 2020 2020 2061 782e 706c 6f74 2866 7072       ax.plot(fpr
-00065f10: 5b22 6d69 6372 6f22 5d2c 2074 7072 5b22  ["micro"], tpr["
-00065f20: 6d69 6372 6f22 5d2c 0d0a 2020 2020 2020  micro"],..      
-00065f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065f40: 2020 2063 6f6c 6f72 3d27 6465 6570 7069     color='deeppi
-00065f50: 6e6b 272c 206c 696e 6573 7479 6c65 3d27  nk', linestyle='
-00065f60: 3a27 2c20 6c69 6e65 7769 6474 683d 3429  :', linewidth=4)
-00065f70: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00065f80: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00065f90: 2020 2020 2020 2070 6173 730d 0a20 2020         pass..   
-00065fa0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00065fb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00065fc0: 6162 656c 732e 6170 7065 6e64 2827 6d61  abels.append('ma
-00065fd0: 6372 6f2d 6176 6572 6167 6520 524f 4320  cro-average ROC 
-00065fe0: 6375 7276 6520 2861 7265 6120 3d20 7b30  curve (area = {0
-00065ff0: 3a30 2e32 667d 2927 0d0a 2020 2020 2020  :0.2f})'..      
-00066000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066010: 2020 2020 2020 2020 2027 272e 666f 726d           ''.form
-00066020: 6174 2872 6f63 5f61 7563 5b22 6d61 6372  at(roc_auc["macr
-00066030: 6f22 5d29 290d 0a20 2020 2020 2020 2020  o"]))..         
-00066040: 2020 2020 2020 2061 782e 706c 6f74 2866         ax.plot(f
-00066050: 7072 5b22 6d61 6372 6f22 5d2c 2074 7072  pr["macro"], tpr
-00066060: 5b22 6d61 6372 6f22 5d2c 0d0a 2020 2020  ["macro"],..    
-00066070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066080: 2020 2020 2063 6f6c 6f72 3d27 6e61 7679       color='navy
-00066090: 272c 206c 696e 6573 7479 6c65 3d27 3a27  ', linestyle=':'
-000660a0: 2c20 6c69 6e65 7769 6474 683d 3429 0d0a  , linewidth=4)..
-000660b0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000660c0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-000660d0: 2020 2020 2070 6173 730d 0a20 2020 2020       pass..     
-000660e0: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
-000660f0: 302c 2031 5d2c 205b 302c 2031 5d2c 2027  0, 1], [0, 1], '
-00066100: 6b2d 2d27 2c20 6c77 3d6c 7729 0d0a 2020  k--', lw=lw)..  
-00066110: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00066120: 5f78 6c69 6d28 5b30 2e30 2c20 312e 305d  _xlim([0.0, 1.0]
-00066130: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-00066140: 782e 7365 745f 796c 696d 285b 302e 302c  x.set_ylim([0.0,
-00066150: 2031 2e30 355d 290d 0a20 2020 2020 2020   1.05])..       
-00066160: 2020 2020 2061 782e 7365 745f 786c 6162       ax.set_xlab
-00066170: 656c 2827 4661 6c73 6520 506f 7369 7469  el('False Positi
-00066180: 7665 2052 6174 6527 290d 0a20 2020 2020  ve Rate')..     
-00066190: 2020 2020 2020 2061 782e 7365 745f 796c         ax.set_yl
-000661a0: 6162 656c 2827 5472 7565 2050 6f73 6974  abel('True Posit
-000661b0: 6976 6520 5261 7465 2729 0d0a 2020 2020  ive Rate')..    
-000661c0: 2020 2020 2020 2020 6178 2e73 6574 5f74          ax.set_t
-000661d0: 6974 6c65 2827 524f 4320 4375 7276 6520  itle('ROC Curve 
-000661e0: 666f 7220 5072 6564 6963 7469 6f6e 7320  for Predictions 
-000661f0: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
-00066200: 2066 6f72 2074 6172 6765 743a 2025 7327   for target: %s'
-00066210: 2025 7461 7267 290d 0a20 2020 2020 2020   %targ)..       
-00066220: 2020 2020 2070 6c74 2e6c 6567 656e 6428       plt.legend(
-00066230: 6c61 6265 6c73 2c6c 6f63 3d22 6c6f 7765  labels,loc="lowe
-00066240: 7220 7269 6768 7422 290d 0a20 2020 2020  r right")..     
-00066250: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
-00066260: 293b 0d0a 0d0a 2323 2323 2323 2323 2323  );....##########
-00066270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000662a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000662b0: 2323 2323 2323 2323 230d 0a23 2052 656d  #########..# Rem
-000662c0: 6f76 6573 2064 7570 6c69 6361 7465 7320  oves duplicates 
-000662d0: 6672 6f6d 2061 206c 6973 7420 746f 2072  from a list to r
-000662e0: 6574 7572 6e20 756e 6971 7565 2076 616c  eturn unique val
-000662f0: 7565 7320 2d20 5553 4544 204f 4e4c 594f  ues - USED ONLYO
-00066300: 4e43 450d 0a64 6566 2066 696e 645f 7265  NCE..def find_re
-00066310: 6d6f 7665 5f64 7570 6c69 6361 7465 7328  move_duplicates(
-00066320: 7661 6c75 6573 293a 0d0a 2020 2020 6f75  values):..    ou
-00066330: 7470 7574 203d 205b 5d0d 0a20 2020 2073  tput = []..    s
-00066340: 6565 6e20 3d20 7365 7428 290d 0a20 2020  een = set()..   
-00066350: 2066 6f72 2076 616c 7565 2069 6e20 7661   for value in va
-00066360: 6c75 6573 3a0d 0a20 2020 2020 2020 2069  lues:..        i
-00066370: 6620 7661 6c75 6520 6e6f 7420 696e 2073  f value not in s
-00066380: 6565 6e3a 0d0a 2020 2020 2020 2020 2020  een:..          
-00066390: 2020 6f75 7470 7574 2e61 7070 656e 6428    output.append(
-000663a0: 7661 6c75 6529 0d0a 2020 2020 2020 2020  value)..        
-000663b0: 2020 2020 7365 656e 2e61 6464 2876 616c      seen.add(val
-000663c0: 7565 290d 0a20 2020 2072 6574 7572 6e20  ue)..    return 
-000663d0: 6f75 7470 7574 0d0a 2323 2323 2323 2323  output..########
-000663e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000663f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066420: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-00066430: 2073 706c 6974 5f64 6174 615f 6e65 7728   split_data_new(
-00066440: 7472 6169 6e66 696c 652c 2074 6573 7466  trainfile, testf
-00066450: 696c 652c 2074 6172 6765 742c 7365 702c  ile, target,sep,
-00066460: 206d 6f64 656c 7479 7065 3d27 5265 6772   modeltype='Regr
-00066470: 6573 7369 6f6e 272c 2072 616e 646f 6d73  ession', randoms
-00066480: 7461 7465 3d30 293a 0d0a 2020 2020 2222  tate=0):..    ""
-00066490: 220d 0a20 2020 2053 706c 6974 2079 6f75  "..    Split you
-000664a0: 7220 6669 6c65 206f 7220 6461 7461 2066  r file or data f
-000664b0: 7261 6d65 2069 6e74 6f20 3220 6f72 2033  rame into 2 or 3
-000664c0: 2073 706c 6974 732e 2053 7472 6174 6966   splits. Stratif
-000664d0: 6965 6420 6279 2043 6c61 7373 2061 7574  ied by Class aut
-000664e0: 6f6d 6174 6963 616c 6c79 2e0d 0a20 2020  omatically...   
-000664f0: 2041 6464 6974 696f 6e61 6c6c 792c 2069   Additionally, i
-00066500: 7420 7769 6c6c 2073 7472 6970 206f 7574  t will strip out
-00066510: 206e 6f6e 2d6e 756d 6572 6963 2063 6f6c   non-numeric col
-00066520: 7320 696e 2079 6f75 7220 6461 7461 2069  s in your data i
-00066530: 6620 796f 7520 6e65 6564 2069 742e 0d0a  f you need it...
-00066540: 2020 2020 2222 220d 0a20 2020 2072 616e      """..    ran
-00066550: 646f 6d73 7461 7465 203d 2039 390d 0a20  domstate = 99.. 
-00066560: 2020 2023 2323 2323 2323 2043 6f64 6573     ####### Codes
-00066570: 5f6c 6973 7420 636f 6e74 6169 6e73 206d  _list contains m
-00066580: 756c 7469 706c 6520 656e 636f 6465 7273  ultiple encoders
-00066590: 2074 6861 7420 6172 6520 7573 6564 2074   that are used t
-000665a0: 6f20 6f70 656e 2061 2043 5356 2066 696c  o open a CSV fil
-000665b0: 650d 0a20 2020 2063 6f64 6573 5f6c 6973  e..    codes_lis
-000665c0: 7420 3d20 5b27 7574 662d 3827 2c27 6973  t = ['utf-8','is
-000665d0: 6f2d 3838 3539 2d31 272c 2763 7031 3235  o-8859-1','cp125
-000665e0: 3227 2c27 6c61 7469 6e31 275d 0d0a 2020  2','latin1']..  
-000665f0: 2020 7365 6564 203d 2039 390d 0a20 2020    seed = 99..   
-00066600: 2069 6620 7479 7065 2874 7261 696e 6669   if type(trainfi
-00066610: 6c65 2920 3d3d 2073 7472 3a0d 0a20 2020  le) == str:..   
-00066620: 2020 2020 2069 6620 7472 6169 6e66 696c       if trainfil
-00066630: 6520 213d 2027 273a 0d0a 2020 2020 2020  e != '':..      
-00066640: 2020 2020 2020 2323 2323 2046 6972 7374        #### First
-00066650: 206c 6f61 6420 7468 6520 5472 6169 6e20   load the Train 
-00066660: 6669 6c65 2069 6620 6974 2069 7320 6176  file if it is av
-00066670: 6169 6c61 626c 6520 2323 2323 2323 2323  ailable ########
-00066680: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00066690: 666f 7220 636f 6465 7820 696e 2063 6f64  for codex in cod
-000666a0: 6573 5f6c 6973 743a 0d0a 2020 2020 2020  es_list:..      
-000666b0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-000666c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000666d0: 2020 2020 7472 6169 6e64 6620 3d20 7064      traindf = pd
-000666e0: 2e72 6561 645f 6373 7628 7472 6169 6e66  .read_csv(trainf
-000666f0: 696c 652c 7365 703d 7365 702c 656e 636f  ile,sep=sep,enco
-00066700: 6469 6e67 3d63 6f64 6578 2c69 6e64 6578  ding=codex,index
-00066710: 5f63 6f6c 3d4e 6f6e 6529 0d0a 2020 2020  _col=None)..    
-00066720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066730: 6272 6561 6b0d 0a20 2020 2020 2020 2020  break..         
-00066740: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-00066750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066760: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
-00066770: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00066780: 2754 7261 696e 2064 6174 6120 6769 7665  'Train data give
-00066790: 6e2e 2053 6861 7065 203d 2025 7327 2025  n. Shape = %s' %
-000667a0: 2874 7261 696e 6466 2e73 6861 7065 2c29  (traindf.shape,)
-000667b0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-000667c0: 7269 6e74 2827 5461 7267 6574 2052 6f77  rint('Target Row
-000667d0: 7320 5472 6169 6e20 3d20 2564 2720 256c  s Train = %d' %l
-000667e0: 656e 2874 7261 696e 6466 5b74 7261 696e  en(traindf[train
-000667f0: 6466 5b74 6172 6765 745d 3d3d 315d 2929  df[target]==1]))
-00066800: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00066810: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00066820: 6e74 2827 5472 6169 6e66 696c 6520 6973  nt('Trainfile is
-00066830: 206e 6f74 2066 6f75 6e64 2e20 4368 6563   not found. Chec
-00066840: 6b20 796f 7572 2069 6e70 7574 206f 7220  k your input or 
-00066850: 6669 6c65 2064 6573 7469 6e61 7469 6f6e  file destination
-00066860: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00066870: 7265 7475 726e 0d0a 2020 2020 2020 2020  return..        
-00066880: 6966 2020 7479 7065 2874 6573 7466 696c  if  type(testfil
-00066890: 6529 203d 3d20 7374 723a 0d0a 2020 2020  e) == str:..    
-000668a0: 2020 2020 2020 2020 6966 2074 6573 7466          if testf
-000668b0: 696c 6520 213d 2027 273a 0d0a 2020 2020  ile != '':..    
-000668c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000668d0: 7428 2754 7261 696e 2066 696c 6520 616e  t('Train file an
-000668e0: 6420 5465 7374 2066 696c 6520 6769 7665  d Test file give
-000668f0: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
-00066900: 2020 2020 2020 2323 2323 2323 2049 6620        ###### If 
-00066910: 7465 7374 6669 6c65 2069 7320 6176 6169  testfile is avai
-00066920: 6c61 626c 652c 2079 6f75 206e 6565 6420  lable, you need 
-00066930: 746f 2063 6f6d 6269 6e65 2074 7261 696e  to combine train
-00066940: 2061 6e64 2074 6573 7420 6461 7461 7365   and test datase
-00066950: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-00066960: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
-00066970: 2044 6174 6146 7261 6d65 2061 6e64 2054   DataFrame and T
-00066980: 6573 7466 696c 6520 6769 7665 6e2e 2729  estfile given.')
-00066990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000669a0: 2020 666f 7220 636f 6465 7820 696e 2063    for codex in c
-000669b0: 6f64 6573 5f6c 6973 743a 0d0a 2020 2020  odes_list:..    
-000669c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000669d0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-000669e0: 2020 2020 2020 2020 2020 2020 2020 7465                te
-000669f0: 7374 6466 203d 2070 642e 7265 6164 5f63  stdf = pd.read_c
-00066a00: 7376 2874 6573 7466 696c 652c 7365 703d  sv(testfile,sep=
-00066a10: 7365 702c 656e 636f 6469 6e67 3d63 6f64  sep,encoding=cod
-00066a20: 6578 2c69 6e64 6578 5f63 6f6c 3d4e 6f6e  ex,index_col=Non
-00066a30: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00066a40: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00066a50: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
-00066a60: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-00066a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066a80: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-00066a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066aa0: 2020 7072 696e 7428 2754 6573 7420 6461    print('Test da
-00066ab0: 7461 2067 6976 656e 2e20 5368 6170 6520  ta given. Shape 
-00066ac0: 3d20 2573 2720 2528 7465 7374 6466 2e73  = %s' %(testdf.s
-00066ad0: 6861 7065 2c29 290d 0a20 2020 2020 2020  hape,))..       
-00066ae0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00066af0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00066b00: 7428 2754 6573 7466 696c 6520 6973 206e  t('Testfile is n
-00066b10: 6f74 2067 6976 656e 2e20 436f 6e74 696e  ot given. Contin
-00066b20: 7569 6e67 2729 0d0a 2020 2020 2020 2020  uing')..        
-00066b30: 2020 2020 2020 2020 7465 7374 6466 203d          testdf =
-00066b40: 2027 270d 0a20 2020 2020 2020 2065 6c69   ''..        eli
-00066b50: 6620 7479 7065 2874 6573 7466 696c 6529  f type(testfile)
-00066b60: 203d 3d20 7064 2e44 6174 6146 7261 6d65   == pd.DataFrame
-00066b70: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00066b80: 7269 6e74 2827 5472 6169 6e20 6669 6c65  rint('Train file
-00066b90: 2061 6e64 2054 6573 7420 6461 7461 6672   and Test datafr
-00066ba0: 616d 6520 6769 7665 6e2e 2729 0d0a 2020  ame given.')..  
-00066bb0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
-00066bc0: 203d 2074 6573 7466 696c 655b 3a5d 0d0a   = testfile[:]..
-00066bd0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00066be0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00066bf0: 2827 5465 7374 6669 6c65 2069 7320 756e  ('Testfile is un
-00066c00: 6b6e 6f77 6e20 7479 7065 2e27 290d 0a20  known type.').. 
-00066c10: 2020 2020 2020 2020 2020 2074 6573 7464             testd
-00066c20: 6620 3d20 2727 0d0a 2020 2020 656c 6966  f = ''..    elif
-00066c30: 2074 7970 6528 7472 6169 6e66 696c 6529   type(trainfile)
-00066c40: 203d 3d20 7064 2e44 6174 6146 7261 6d65   == pd.DataFrame
-00066c50: 3a0d 0a20 2020 2020 2020 2074 7261 696e  :..        train
-00066c60: 6466 203d 2074 7261 696e 6669 6c65 5b3a  df = trainfile[:
-00066c70: 5d0d 0a20 2020 2020 2020 2069 6620 2074  ]..        if  t
-00066c80: 7970 6528 7465 7374 6669 6c65 2920 3d3d  ype(testfile) ==
-00066c90: 2073 7472 3a0d 0a20 2020 2020 2020 2020   str:..         
-00066ca0: 2020 2069 6620 7465 7374 6669 6c65 2021     if testfile !
-00066cb0: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
-00066cc0: 2020 2020 2020 2070 7269 6e74 2827 5472         print('Tr
-00066cd0: 6169 6e20 4461 7461 4672 616d 6520 616e  ain DataFrame an
-00066ce0: 6420 5465 7374 2066 696c 6520 6769 7665  d Test file give
-00066cf0: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
-00066d00: 2020 2020 2020 2323 2323 2323 2049 6620        ###### If 
-00066d10: 7465 7374 6669 6c65 2069 7320 6176 6169  testfile is avai
-00066d20: 6c61 626c 652c 2079 6f75 206e 6565 6420  lable, you need 
-00066d30: 746f 2063 6f6d 6269 6e65 2074 7261 696e  to combine train
-00066d40: 2061 6e64 2074 6573 7420 6461 7461 7365   and test datase
-00066d50: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-00066d60: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
-00066d70: 2044 6174 6146 7261 6d65 2061 6e64 2054   DataFrame and T
-00066d80: 6573 7466 696c 6520 6769 7665 6e2e 2729  estfile given.')
-00066d90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066da0: 2020 666f 7220 636f 6465 7820 696e 2063    for codex in c
-00066db0: 6f64 6573 5f6c 6973 743a 0d0a 2020 2020  odes_list:..    
-00066dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066dd0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00066de0: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00066df0: 7374 6466 203d 2070 642e 7265 6164 5f63  stdf = pd.read_c
-00066e00: 7376 2874 6573 7466 696c 652c 7365 703d  sv(testfile,sep=
-00066e10: 7365 702c 656e 636f 6469 6e67 3d63 6f64  sep,encoding=cod
-00066e20: 6578 2c69 6e64 6578 5f63 6f6c 3d4e 6f6e  ex,index_col=Non
-00066e30: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00066e40: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00066e50: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
-00066e60: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-00066e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066e80: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-00066e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066ea0: 2020 7072 696e 7428 2754 7261 696e 2053    print('Train S
-00066eb0: 6861 7065 3a25 7320 5465 7374 2053 6861  hape:%s Test Sha
-00066ec0: 7065 3a20 2573 2720 2528 7472 6169 6e64  pe: %s' %(traind
-00066ed0: 662e 7368 6170 652c 7465 7374 6466 2e73  f.shape,testdf.s
-00066ee0: 6861 7065 2929 0d0a 2020 2020 2020 2020  hape))..        
-00066ef0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00066f00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00066f10: 2827 4e6f 2074 6573 7466 696c 652e 2054  ('No testfile. T
-00066f20: 7261 696e 2053 6861 7065 3a25 7327 2025  rain Shape:%s' %
-00066f30: 2874 7261 696e 6466 2e73 6861 7065 2c29  (traindf.shape,)
-00066f40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00066f50: 2020 2074 6573 7464 6620 3d20 2727 0d0a     testdf = ''..
-00066f60: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
-00066f70: 6528 7465 7374 6669 6c65 2920 3d3d 2070  e(testfile) == p
-00066f80: 642e 4461 7461 4672 616d 653a 0d0a 2020  d.DataFrame:..  
-00066f90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00066fa0: 2754 7261 696e 2044 6174 6146 7261 6d65  'Train DataFrame
-00066fb0: 2061 6e64 2054 6573 7420 4461 7461 4672   and Test DataFr
-00066fc0: 616d 6520 6769 7665 6e2e 2729 0d0a 2020  ame given.')..  
-00066fd0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
-00066fe0: 203d 2074 6573 7466 696c 655b 3a5d 0d0a   = testfile[:]..
-00066ff0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00067000: 2020 2070 7269 6e74 2827 4e6f 2054 7261     print('No Tra
-00067010: 696e 206f 7220 5465 7374 2066 696c 6520  in or Test file 
-00067020: 7072 6f76 6964 6564 2e20 456e 642e 2e2e  provided. End...
-00067030: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
-00067040: 726e 0d0a 2020 2020 2323 2323 2323 2323  rn..    ########
-00067050: 2054 6869 7320 6973 2077 6865 7265 2074   This is where t
-00067060: 6865 2073 706c 6974 7469 6e67 2062 6567  he splitting beg
-00067070: 696e 7320 2323 2323 2323 2323 2323 2323  ins ############
-00067080: 2323 2323 230d 0a20 2020 2069 6620 7461  #####..    if ta
-00067090: 7267 6574 203d 3d20 2727 3a0d 0a20 2020  rget == '':..   
-000670a0: 2020 2020 2070 7269 6e74 2827 4e6f 2074       print('No t
-000670b0: 6172 6765 7420 7661 7269 6162 6c65 2070  arget variable p
-000670c0: 726f 7669 6465 642e 2050 6c65 6173 6520  rovided. Please 
-000670d0: 7072 6f76 6964 6520 7461 7267 6574 2076  provide target v
-000670e0: 6172 6961 626c 6527 290d 0a20 2020 2020  ariable')..     
-000670f0: 2020 2072 6574 7572 6e20 7472 6169 6e64     return traind
-00067100: 662c 204e 6f6e 652c 204e 6f6e 650d 0a20  f, None, None.. 
-00067110: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00067120: 2020 7920 3d20 7472 6169 6e64 665b 7461    y = traindf[ta
-00067130: 7267 6574 5d0d 0a20 2020 2069 6620 6d6f  rget]..    if mo
-00067140: 6465 6c74 7970 6520 3d3d 2027 436c 6173  deltype == 'Clas
-00067150: 7369 6669 6361 7469 6f6e 273a 0d0a 2020  sification':..  
-00067160: 2020 2020 2020 6966 2074 7261 696e 6466        if traindf
-00067170: 2e73 6861 7065 5b30 5d20 3c3d 2031 3030  .shape[0] <= 100
-00067180: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00067190: 7373 7320 3d20 5374 7261 7469 6669 6564  sss = Stratified
-000671a0: 5368 7566 666c 6553 706c 6974 286e 5f73  ShuffleSplit(n_s
-000671b0: 706c 6974 733d 322c 2074 6573 745f 7369  plits=2, test_si
-000671c0: 7a65 3d30 2e33 302c 2072 616e 646f 6d5f  ze=0.30, random_
-000671d0: 7374 6174 653d 7261 6e64 6f6d 7374 6174  state=randomstat
-000671e0: 6529 0d0a 2020 2020 2020 2020 656c 7365  e)..        else
-000671f0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00067200: 7373 203d 2053 7472 6174 6966 6965 6453  ss = StratifiedS
-00067210: 6875 6666 6c65 5370 6c69 7428 6e5f 7370  huffleSplit(n_sp
-00067220: 6c69 7473 3d32 2c20 7465 7374 5f73 697a  lits=2, test_siz
-00067230: 653d 302e 3230 2c20 7261 6e64 6f6d 5f73  e=0.20, random_s
-00067240: 7461 7465 3d72 616e 646f 6d73 7461 7465  tate=randomstate
-00067250: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00067260: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-00067270: 6e70 2e72 616e 646f 6d2e 7065 726d 7574  np.random.permut
-00067280: 6174 696f 6e28 7472 6169 6e64 662e 7368  ation(traindf.sh
-00067290: 6170 655b 305d 290d 0a20 2020 2020 2020  ape[0])..       
-000672a0: 2074 7261 696e 5f72 6f77 7320 3d20 696e   train_rows = in
-000672b0: 7428 302e 382a 7472 6169 6e64 662e 7368  t(0.8*traindf.sh
-000672c0: 6170 655b 305d 290d 0a20 2020 2070 7265  ape[0])..    pre
-000672d0: 6469 6374 6f72 7320 3d20 5b78 2066 6f72  dictors = [x for
-000672e0: 2078 2069 6e20 7472 6169 6e64 6620 6966   x in traindf if
-000672f0: 2078 206e 6f74 2069 6e20 7461 7267 6574   x not in target
-00067300: 5d0d 0a20 2020 2023 2323 2323 2073 656c  ]..    ##### sel
-00067310: 6563 7420 6f6e 6c79 2073 7472 696e 6720  ect only string 
-00067320: 636f 6c75 6d6e 7320 6672 6f6d 2074 6865  columns from the
-00067330: 2074 7261 696e 2064 6174 610d 0a20 2020   train data..   
-00067340: 2063 6f6c 7320 3d20 636f 7079 2e64 6565   cols = copy.dee
-00067350: 7063 6f70 7928 7072 6564 6963 746f 7273  pcopy(predictors
-00067360: 290d 0a20 2020 2023 636f 6c73 203d 2073  )..    #cols = s
-00067370: 656c 6563 745f 6e75 6d5f 636f 6c75 6d6e  elect_num_column
-00067380: 7328 7472 6169 6e64 665b 7072 6564 6963  s(traindf[predic
-00067390: 746f 7273 5d29 2e63 6f6c 756d 6e73 2e74  tors]).columns.t
-000673a0: 6f6c 6973 7428 290d 0a20 2020 2074 7261  olist()..    tra
-000673b0: 696e 6466 203d 2074 7261 696e 6466 5b63  indf = traindf[c
-000673c0: 6f6c 732b 5b74 6172 6765 745d 5d0d 0a20  ols+[target]].. 
-000673d0: 2020 2058 203d 2074 7261 696e 6466 5b63     X = traindf[c
-000673e0: 6f6c 735d 0d0a 2020 2020 6966 2074 7970  ols]..    if typ
-000673f0: 6528 7465 7374 6466 2920 3d3d 2073 7472  e(testdf) == str
-00067400: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
-00067410: 4966 206e 6f20 7465 7374 2044 6174 6146  If no test DataF
-00067420: 7261 6d65 2069 7320 6769 7665 6e2c 2074  rame is given, t
-00067430: 6865 6e20 7370 6c69 7420 7468 6520 7472  hen split the tr
-00067440: 6169 6e20 6461 7461 2069 6e74 6f20 7472  ain data into tr
-00067450: 6169 6e2c 2063 7620 616e 6420 7465 7374  ain, cv and test
-00067460: 2064 6174 6120 2323 2323 2323 230d 0a20   data #######.. 
-00067470: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
-00067480: 7970 6520 3d3d 2027 436c 6173 7369 6669  ype == 'Classifi
-00067490: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
-000674a0: 2020 2020 2020 7472 6169 6e69 6e64 6578        trainindex
-000674b0: 2c20 7465 7374 696e 6465 7820 3d20 7373  , testindex = ss
-000674c0: 732e 7370 6c69 7428 582c 2079 290d 0a20  s.split(X, y).. 
-000674d0: 2020 2020 2020 2020 2020 2074 7261 6461             trada
-000674e0: 7461 203d 2074 7261 696e 6466 2e69 6c6f  ta = traindf.ilo
-000674f0: 635b 7472 6169 6e69 6e64 6578 5b30 5d5d  c[trainindex[0]]
-00067500: 0d0a 2020 2020 2020 2020 2020 2020 7473  ..            ts
-00067510: 6461 7461 203d 2074 7261 696e 6466 2e69  data = traindf.i
-00067520: 6c6f 635b 7472 6169 6e69 6e64 6578 5b31  loc[trainindex[1
-00067530: 5d5d 0d0a 2020 2020 2020 2020 656c 7365  ]]..        else
-00067540: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
-00067550: 7261 696e 696e 675f 6964 782c 2074 6573  raining_idx, tes
-00067560: 745f 6964 7820 3d20 696e 6469 6365 735b  t_idx = indices[
-00067570: 3a74 7261 696e 5f72 6f77 735d 2c20 696e  :train_rows], in
-00067580: 6469 6365 735b 7472 6169 6e5f 726f 7773  dices[train_rows
-00067590: 3a5d 0d0a 2020 2020 2020 2020 2020 2020  :]..            
-000675a0: 7472 6164 6174 612c 2074 7364 6174 6120  tradata, tsdata 
-000675b0: 3d20 7472 6169 6e64 662e 696c 6f63 5b74  = traindf.iloc[t
-000675c0: 7261 696e 696e 675f 6964 785d 2c20 7472  raining_idx], tr
-000675d0: 6169 6e64 662e 696c 6f63 5b74 6573 745f  aindf.iloc[test_
-000675e0: 6964 785d 0d0a 2020 2020 2020 2020 2323  idx]..        ##
-000675f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067600: 2323 2320 2020 2043 524f 5353 2056 414c  ###    CROSS VAL
-00067610: 4944 4154 494f 4e20 504f 5254 494f 4e20  IDATION PORTION 
-00067620: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00067630: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
-00067640: 2020 5820 3d20 7473 6461 7461 5b63 6f6c    X = tsdata[col
-00067650: 735d 0d0a 2020 2020 2020 2020 7920 3d20  s]..        y = 
-00067660: 7473 6461 7461 5b74 6172 6765 745d 0d0a  tsdata[target]..
-00067670: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-00067680: 7479 7065 203d 3d20 2743 6c61 7373 6966  type == 'Classif
-00067690: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
-000676a0: 2020 2020 2020 2073 7373 203d 2053 7472         sss = Str
-000676b0: 6174 6966 6965 6453 6875 6666 6c65 5370  atifiedShuffleSp
-000676c0: 6c69 7428 6e5f 7370 6c69 7473 3d32 2c20  lit(n_splits=2, 
-000676d0: 7465 7374 5f73 697a 653d 302e 3430 2c20  test_size=0.40, 
-000676e0: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-000676f0: 646f 6d73 7461 7465 290d 0a20 2020 2020  domstate)..     
-00067700: 2020 2020 2020 2063 7669 6e64 6578 2c20         cvindex, 
-00067710: 7473 5f69 6e64 6578 203d 2073 7373 2e73  ts_index = sss.s
-00067720: 706c 6974 2858 2c20 7929 0d0a 2020 2020  plit(X, y)..    
-00067730: 2020 2020 2020 2020 6376 6461 7461 203d          cvdata =
-00067740: 2074 7364 6174 612e 696c 6f63 5b63 7669   tsdata.iloc[cvi
-00067750: 6e64 6578 5b30 5d5d 0d0a 2020 2020 2020  ndex[0]]..      
-00067760: 2020 2020 2020 7473 6461 7461 203d 2074        tsdata = t
-00067770: 7364 6174 612e 696c 6f63 5b63 7669 6e64  sdata.iloc[cvind
-00067780: 6578 5b31 5d5d 0d0a 2020 2020 2020 2020  ex[1]]..        
-00067790: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000677a0: 2020 2069 6e64 6963 6573 203d 206e 702e     indices = np.
-000677b0: 7261 6e64 6f6d 2e70 6572 6d75 7461 7469  random.permutati
-000677c0: 6f6e 2874 7364 6174 612e 7368 6170 655b  on(tsdata.shape[
-000677d0: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
-000677e0: 2074 7261 696e 5f72 6f77 7320 3d20 696e   train_rows = in
-000677f0: 7428 302e 342a 7473 6461 7461 2e73 6861  t(0.4*tsdata.sha
-00067800: 7065 5b30 5d29 0d0a 2020 2020 2020 2020  pe[0])..        
-00067810: 2020 2020 7472 6169 6e69 6e67 5f69 6478      training_idx
-00067820: 2c20 7465 7374 5f69 6478 203d 2069 6e64  , test_idx = ind
-00067830: 6963 6573 5b3a 7472 6169 6e5f 726f 7773  ices[:train_rows
-00067840: 5d2c 2069 6e64 6963 6573 5b74 7261 696e  ], indices[train
-00067850: 5f72 6f77 733a 5d0d 0a20 2020 2020 2020  _rows:]..       
-00067860: 2020 2020 2063 7664 6174 612c 2074 7364       cvdata, tsd
-00067870: 6174 6120 3d20 7473 6461 7461 2e69 6c6f  ata = tsdata.ilo
-00067880: 635b 7472 6169 6e69 6e67 5f69 6478 5d2c  c[training_idx],
-00067890: 2074 7364 6174 612e 696c 6f63 5b74 6573   tsdata.iloc[tes
-000678a0: 745f 6964 785d 0d0a 2020 2020 2020 2020  t_idx]..        
-000678b0: 7265 7475 726e 2074 7261 6461 7461 2c20  return tradata, 
-000678c0: 6376 6461 7461 2c20 7473 6461 7461 2c20  cvdata, tsdata, 
-000678d0: 636f 6c73 0d0a 2020 2020 656c 7365 3a0d  cols..    else:.
-000678e0: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
-000678f0: 2049 6620 5465 7374 2044 6174 6146 7261   If Test DataFra
-00067900: 6d65 2069 7320 6769 7665 6e20 7468 656e  me is given then
-00067910: 206b 6565 7020 7468 6174 2061 7320 7473   keep that as ts
-00067920: 6461 7461 2023 2323 2323 2323 230d 0a20  data ########.. 
-00067930: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
-00067940: 7970 6520 3d3d 2027 436c 6173 7369 6669  ype == 'Classifi
-00067950: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
-00067960: 2020 2020 2020 7472 6169 6e69 6e64 6578        trainindex
-00067970: 2c20 7465 7374 696e 6465 7820 3d20 7373  , testindex = ss
-00067980: 732e 7370 6c69 7428 582c 2079 290d 0a20  s.split(X, y).. 
-00067990: 2020 2020 2020 2020 2020 2074 7261 6461             trada
-000679a0: 7461 203d 2074 7261 696e 6466 2e69 6c6f  ta = traindf.ilo
-000679b0: 635b 7472 6169 6e69 6e64 6578 5b30 5d5d  c[trainindex[0]]
-000679c0: 0d0a 2020 2020 2020 2020 2020 2020 6376  ..            cv
-000679d0: 6461 7461 203d 2074 7261 696e 6466 2e69  data = traindf.i
-000679e0: 6c6f 635b 7472 6169 6e69 6e64 6578 5b31  loc[trainindex[1
-000679f0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00067a00: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00067a10: 2020 2020 2020 6966 206c 656e 2874 6573        if len(tes
-00067a20: 7464 665b 7461 7267 6574 5d2e 7661 6c75  tdf[target].valu
-00067a30: 655f 636f 756e 7473 2829 203e 3d20 3229  e_counts() >= 2)
-00067a40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00067a50: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00067a60: 2020 4e75 6d62 6572 206f 6620 5461 7267    Number of Targ
-00067a70: 6574 2052 6f77 7320 696e 2054 6573 7420  et Rows in Test 
-00067a80: 4461 7461 3a20 2564 2720 256c 656e 2874  Data: %d' %len(t
-00067a90: 6573 7464 665b 7465 7374 6466 5b74 6172  estdf[testdf[tar
-00067aa0: 6765 745d 3d3d 315d 2929 0d0a 2020 2020  get]==1]))..    
-00067ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00067ac0: 7473 6461 7461 203d 2074 6573 7464 665b  tsdata = testdf[
-00067ad0: 3a5d 0d0a 2020 2020 2020 2020 2020 2020  :]..            
-00067ae0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00067af0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00067b00: 7269 6e74 2827 2020 2020 5465 7374 2064  rint('    Test d
-00067b10: 6174 6120 6861 7320 7369 6e67 6c65 2063  ata has single c
-00067b20: 6c61 7373 2e20 4f76 6572 7772 6974 696e  lass. Overwritin
-00067b30: 6720 7072 6564 6963 7469 6f6e 7320 6f6e  g predictions on
-00067b40: 2054 6573 7420 5461 7267 6574 2063 6f6c   Test Target col
-00067b50: 756d 6e2e 2729 0d0a 2020 2020 2020 2020  umn.')..        
-00067b60: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00067b70: 6963 746f 7273 203d 205b 7820 666f 7220  ictors = [x for 
-00067b80: 7820 696e 206c 6973 7428 7472 6169 6e64  x in list(traind
-00067b90: 6629 2069 6620 7820 6e6f 7420 696e 2074  f) if x not in t
-00067ba0: 6172 6765 745d 0d0a 2020 2020 2020 2020  arget]..        
-00067bb0: 2020 2020 2020 2020 2020 2020 7473 6461              tsda
-00067bc0: 7461 203d 2074 6573 7464 665b 3a5d 0d0a  ta = testdf[:]..
-00067bd0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00067be0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00067bf0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00067c00: 4e6f 2054 6172 6765 7420 636f 6c75 6d6e  No Target column
-00067c10: 2069 6e20 5465 7374 2064 6174 6127 290d   in Test data').
-00067c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00067c30: 2074 6573 7464 665b 7461 7267 6574 5d20   testdf[target] 
-00067c40: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-00067c50: 2020 2020 2074 7364 6174 6120 3d20 7465       tsdata = te
-00067c60: 7374 6466 5b63 6f6c 732b 5b74 6172 6765  stdf[cols+[targe
-00067c70: 745d 5d0d 0a20 2020 2020 2020 2065 6c73  t]]..        els
-00067c80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00067c90: 696e 6469 6365 7320 3d20 6e70 2e72 616e  indices = np.ran
-00067ca0: 646f 6d2e 7065 726d 7574 6174 696f 6e28  dom.permutation(
-00067cb0: 7472 6169 6e64 662e 7368 6170 655b 305d  traindf.shape[0]
-00067cc0: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-00067cd0: 7261 696e 5f72 6f77 7320 3d20 696e 7428  rain_rows = int(
-00067ce0: 302e 382a 7472 6169 6e64 662e 7368 6170  0.8*traindf.shap
-00067cf0: 655b 305d 290d 0a20 2020 2020 2020 2020  e[0])..         
-00067d00: 2020 2074 7261 696e 696e 675f 6964 782c     training_idx,
-00067d10: 2074 6573 745f 6964 7820 3d20 696e 6469   test_idx = indi
-00067d20: 6365 735b 3a74 7261 696e 5f72 6f77 735d  ces[:train_rows]
-00067d30: 2c20 696e 6469 6365 735b 7472 6169 6e5f  , indices[train_
-00067d40: 726f 7773 3a5d 0d0a 2020 2020 2020 2020  rows:]..        
-00067d50: 2020 2020 7472 6164 6174 612c 2063 7664      tradata, cvd
-00067d60: 6174 6120 3d20 7472 6169 6e64 662e 696c  ata = traindf.il
-00067d70: 6f63 5b74 7261 696e 696e 675f 6964 785d  oc[training_idx]
-00067d80: 2c20 7472 6169 6e64 662e 696c 6f63 5b74  , traindf.iloc[t
-00067d90: 6573 745f 6964 785d 0d0a 2020 2020 2020  est_idx]..      
-00067da0: 2020 2020 2020 7473 6461 7461 203d 2074        tsdata = t
-00067db0: 6573 7464 665b 3a5d 0d0a 2020 2020 2020  estdf[:]..      
-00067dc0: 2020 7265 7475 726e 2074 7261 6461 7461    return tradata
-00067dd0: 2c20 6376 6461 7461 2c20 7473 6461 7461  , cvdata, tsdata
-00067de0: 2c20 636f 6c73 0d0a 2323 2323 2323 2323  , cols..########
-00067df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067e00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067e10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067e20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067e30: 2323 2323 0d0a 6465 6620 6669 6c6c 696e  ####..def fillin
-00067e40: 675f 6d69 7373 696e 675f 7661 6c75 6573  g_missing_values
-00067e50: 5f73 696d 706c 6528 7472 6169 6e2c 2074  _simple(train, t
-00067e60: 6573 742c 2063 6174 732c 206e 756d 7329  est, cats, nums)
-00067e70: 3a0d 0a20 2020 2023 2323 2320 6966 2079  :..    #### if y
-00067e80: 6f75 2077 616e 7420 746f 2066 696c 6c20  ou want to fill 
-00067e90: 6d69 7373 696e 6720 7661 6c75 6573 2075  missing values u
-00067ea0: 7369 6e67 206d 6561 6e2c 206d 6564 6961  sing mean, media
-00067eb0: 6e20 6d6f 6465 2c20 676f 2061 6865 6164  n mode, go ahead
-00067ec0: 210d 0a20 2020 2023 2323 2320 2049 2064  !..    ####  I d
-00067ed0: 6f6e 2774 2072 6563 6f6d 6d65 6e64 2042  on't recommend B
-00067ee0: 7574 2073 6f6d 6520 7065 6f70 6c65 2073  ut some people s
-00067ef0: 6565 6d20 746f 206c 696b 6520 6974 2e20  eem to like it. 
-00067f00: 2323 2323 230d 0a20 2020 2066 6f72 2076  #####..    for v
-00067f10: 6172 6d20 696e 2063 6174 733a 0d0a 2020  arm in cats:..  
-00067f20: 2020 2020 2020 6966 2074 7261 696e 5b76        if train[v
-00067f30: 6172 6d5d 2e69 736e 756c 6c28 292e 7375  arm].isnull().su
-00067f40: 6d28 2920 3e20 303a 0d0a 2020 2020 2020  m() > 0:..      
-00067f50: 2020 2020 2020 6669 6c6c 6e75 6d20 3d20        fillnum = 
-00067f60: 7472 6169 6e5b 7661 726d 5d2e 6d6f 6465  train[varm].mode
-00067f70: 2829 5b30 5d0d 0a20 2020 2020 2020 2020  ()[0]..         
-00067f80: 2020 2023 2323 2052 656d 656d 6265 7220     ### Remember 
-00067f90: 7468 6174 2066 696c 6c6e 6120 6f6e 6c79  that fillna only
-00067fa0: 2077 6f72 6b73 2061 7420 6461 7461 6672   works at datafr
-00067fb0: 616d 6520 6c65 7665 6c21 2023 2323 0d0a  ame level! ###..
-00067fc0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-00067fd0: 6e5b 5b76 6172 6d5d 5d20 3d20 7472 6169  n[[varm]] = trai
-00067fe0: 6e5b 5b76 6172 6d5d 5d2e 6669 6c6c 6e61  n[[varm]].fillna
-00067ff0: 2866 696c 6c6e 756d 290d 0a20 2020 2020  (fillnum)..     
-00068000: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00068010: 696e 7374 616e 6365 2874 6573 742c 2073  instance(test, s
-00068020: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
-00068030: 2020 2020 2020 6966 2074 6573 745b 7661        if test[va
-00068040: 726d 5d2e 6973 6e75 6c6c 2829 2e73 756d  rm].isnull().sum
-00068050: 2829 203e 2030 3a0d 0a20 2020 2020 2020  () > 0:..       
-00068060: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00068070: 2052 656d 656d 6265 7220 7468 6174 2066   Remember that f
-00068080: 696c 6c6e 6120 6f6e 6c79 2077 6f72 6b73  illna only works
-00068090: 2061 7420 6461 7461 6672 616d 6520 6c65   at dataframe le
-000680a0: 7665 6c21 2023 2323 0d0a 2020 2020 2020  vel! ###..      
-000680b0: 2020 2020 2020 2020 2020 2020 2020 7465                te
-000680c0: 7374 5b5b 7661 726d 5d5d 203d 2074 6573  st[[varm]] = tes
-000680d0: 745b 5b76 6172 6d5d 5d2e 6669 6c6c 6e61  t[[varm]].fillna
-000680e0: 2866 696c 6c6e 756d 290d 0a20 2020 2066  (fillnum)..    f
-000680f0: 6f72 206e 756d 2069 6e20 6e75 6d73 3a0d  or num in nums:.
-00068100: 0a20 2020 2020 2020 2069 6620 7472 6169  .        if trai
-00068110: 6e5b 7661 726d 5d2e 6973 6e75 6c6c 2829  n[varm].isnull()
-00068120: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
-00068130: 2020 2020 2020 2020 2066 696c 6c6e 756d           fillnum
-00068140: 203d 2074 7261 696e 5b6e 756d 5d2e 6d65   = train[num].me
-00068150: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
-00068160: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
-00068170: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
-00068180: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
-00068190: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
-000681a0: 2020 2020 2020 2020 2020 2074 7261 696e             train
-000681b0: 5b5b 6e75 6d5d 5d20 3d20 7472 6169 6e5b  [[num]] = train[
-000681c0: 5b6e 756d 5d5d 2e66 696c 6c6e 6128 6669  [num]].fillna(fi
-000681d0: 6c6c 6e75 6d29 0d0a 2020 2020 2020 2020  llnum)..        
-000681e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000681f0: 7461 6e63 6528 7465 7374 2c20 7374 7229  tance(test, str)
-00068200: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00068210: 2020 2069 6620 7465 7374 5b76 6172 6d5d     if test[varm]
-00068220: 2e69 736e 756c 6c28 292e 7375 6d28 2920  .isnull().sum() 
-00068230: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
-00068240: 2020 2020 2020 2020 2020 2323 2320 5265            ### Re
-00068250: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
-00068260: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
-00068270: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
-00068280: 2120 2323 230d 0a20 2020 2020 2020 2020  ! ###..         
-00068290: 2020 2020 2020 2020 2020 2074 6573 745b             test[
-000682a0: 5b6e 756d 5d5d 203d 2074 6573 745b 5b6e  [num]] = test[[n
-000682b0: 756d 5d5d 2e66 696c 6c6e 6128 6669 6c6c  um]].fillna(fill
-000682c0: 6e75 6d29 0d0a 2020 2020 2323 2320 5468  num)..    ### Th
-000682d0: 6973 2069 7320 6120 7369 6d70 6c65 206c  is is a simple l
-000682e0: 6f67 2074 7261 6e73 666f 726d 2066 6f72  og transform for
-000682f0: 2076 6572 7920 6c61 7267 6520 6e75 6d65   very large nume
-00068300: 7269 6320 7661 6c75 6573 203d 3e20 6869  ric values => hi
-00068310: 6768 6c79 2072 6563 6f6d 6d65 6e64 6564  ghly recommended
-00068320: 210d 0a20 2020 2066 6f72 206e 756d 2069  !..    for num i
-00068330: 6e20 6e75 6d73 3a0d 0a20 2020 2020 2020  n nums:..       
-00068340: 206d 6173 6b20 3d20 7472 6169 6e5b 6e75   mask = train[nu
-00068350: 6d5d 3d3d 300d 0a20 2020 2020 2020 2066  m]==0..        f
-00068360: 696c 6c6e 756d 203d 2031 3065 2d35 0d0a  illnum = 10e-5..
-00068370: 2020 2020 2020 2020 7472 6169 6e2e 6978          train.ix
-00068380: 5b6d 6173 6b2c 6e75 6d5d 203d 2066 696c  [mask,num] = fil
-00068390: 6c6e 756d 0d0a 2020 2020 2020 2020 2323  lnum..        ##
-000683a0: 2320 5265 6d65 6d62 6572 2074 6861 7420  # Remember that 
-000683b0: 6669 6c6c 6e61 206f 6e6c 7920 776f 726b  fillna only work
-000683c0: 7320 6174 2064 6174 6166 7261 6d65 206c  s at dataframe l
-000683d0: 6576 656c 2120 2323 230d 0a20 2020 2020  evel! ###..     
-000683e0: 2020 2074 7261 696e 5b5b 6e75 6d2b 275f     train[[num+'_
-000683f0: 6c6f 6727 5d5d 203d 206e 702e 6c6f 6731  log']] = np.log1
-00068400: 3028 7472 6169 6e5b 5b6e 756d 5d5d 292e  0(train[[num]]).
-00068410: 6669 6c6c 6e61 2830 290d 0a20 2020 2020  fillna(0)..     
-00068420: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00068430: 616e 6365 2874 6573 742c 2073 7472 293a  ance(test, str):
-00068440: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00068450: 736b 203d 2074 6573 745b 6e75 6d5d 3d3d  sk = test[num]==
-00068460: 300d 0a20 2020 2020 2020 2020 2020 2074  0..            t
-00068470: 6573 742e 6978 5b6d 6173 6b2c 6e75 6d5d  est.ix[mask,num]
-00068480: 203d 2066 696c 6c6e 756d 0d0a 2020 2020   = fillnum..    
-00068490: 2020 2020 2020 2020 2323 2320 5265 6d65          ### Reme
-000684a0: 6d62 6572 2074 6861 7420 6669 6c6c 6e61  mber that fillna
-000684b0: 206f 6e6c 7920 776f 726b 7320 6174 2064   only works at d
-000684c0: 6174 6166 7261 6d65 206c 6576 656c 2120  ataframe level! 
-000684d0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-000684e0: 2074 6573 745b 5b6e 756d 2b27 5f6c 6f67   test[[num+'_log
-000684f0: 275d 5d20 3d20 6e70 2e6c 6f67 3130 2874  ']] = np.log10(t
-00068500: 6573 745b 5b6e 756d 5d5d 292e 6669 6c6c  est[[num]]).fill
-00068510: 6e61 2830 290d 0a20 2020 2072 6574 7572  na(0)..    retur
-00068520: 6e20 7472 6169 6e2c 2074 6573 740d 0a23  n train, test..#
-00068530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068560: 2323 2323 2323 2323 2323 230d 0a69 6d70  ###########..imp
-00068570: 6f72 7420 6f73 0d0a 6465 6620 7772 6974  ort os..def writ
-00068580: 655f 6669 6c65 5f74 6f5f 666f 6c64 6572  e_file_to_folder
-00068590: 2864 662c 2065 6163 685f 7461 7267 6574  (df, each_target
-000685a0: 2c20 6261 7365 5f66 696c 656e 616d 652c  , base_filename,
-000685b0: 2076 6572 626f 7365 3d31 293a 0d0a 2020   verbose=1):..  
-000685c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000685d0: 6561 6368 5f74 6172 6765 742c 2073 7472  each_target, str
-000685e0: 293a 0d0a 2020 2020 2020 2020 6469 725f  ):..        dir_
-000685f0: 6e61 6d65 203d 2063 6f70 792e 6465 6570  name = copy.deep
-00068600: 636f 7079 2865 6163 685f 7461 7267 6574  copy(each_target
-00068610: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00068620: 2020 2020 2020 6469 725f 6e61 6d65 203d        dir_name =
-00068630: 2073 7472 2865 6163 685f 7461 7267 6574   str(each_target
-00068640: 290d 0a20 2020 2066 696c 656e 616d 6520  )..    filename 
-00068650: 3d20 6f73 2e70 6174 682e 6a6f 696e 2864  = os.path.join(d
-00068660: 6972 5f6e 616d 652c 2062 6173 655f 6669  ir_name, base_fi
-00068670: 6c65 6e61 6d65 290d 0a20 2020 2069 6620  lename)..    if 
-00068680: 7665 7262 6f73 6520 3e3d 2031 3a0d 0a20  verbose >= 1:.. 
-00068690: 2020 2020 2020 2069 6620 6f73 2e6e 616d         if os.nam
-000686a0: 6520 3d3d 2027 6e74 273a 0d0a 2020 2020  e == 'nt':..    
-000686b0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-000686c0: 2020 2053 6176 696e 6720 7072 6564 6963     Saving predic
-000686d0: 7469 6f6e 7320 746f 202e 5c25 7327 2025  tions to .\%s' %
-000686e0: 6669 6c65 6e61 6d65 290d 0a20 2020 2020  filename)..     
-000686f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00068700: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00068710: 2053 6176 696e 6720 7072 6564 6963 7469   Saving predicti
-00068720: 6f6e 7320 746f 202e 2f25 7327 2025 6669  ons to ./%s' %fi
-00068730: 6c65 6e61 6d65 290d 0a20 2020 2020 2020  lename)..       
-00068740: 2069 6620 6e6f 7420 6f73 2e70 6174 682e   if not os.path.
-00068750: 6973 6469 7228 6469 725f 6e61 6d65 293a  isdir(dir_name):
-00068760: 0d0a 2020 2020 2020 2020 2020 2020 6f73  ..            os
-00068770: 2e6d 6b64 6972 2864 6972 5f6e 616d 6529  .mkdir(dir_name)
-00068780: 0d0a 2020 2020 2020 2020 6466 2e74 6f5f  ..        df.to_
-00068790: 6373 7628 6669 6c65 6e61 6d65 2c69 6e64  csv(filename,ind
-000687a0: 6578 3d46 616c 7365 290d 0a23 2323 2323  ex=False)..#####
-000687b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000687c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000687d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000687e0: 2323 2323 2323 2323 230d 0a64 6566 2063  #########..def c
-000687f0: 7265 6174 655f 7473 5f66 6561 7475 7265  reate_ts_feature
-00068800: 7328 6466 2c20 7473 636f 6c29 3a0d 0a20  s(df, tscol):.. 
-00068810: 2020 2022 2222 0d0a 2020 2020 5468 6973     """..    This
-00068820: 2074 616b 6573 2069 6e20 696e 7075 7420   takes in input 
-00068830: 6120 6461 7461 6672 616d 6520 616e 6420  a dataframe and 
-00068840: 6120 6461 7465 2076 6172 6961 626c 652e  a date variable.
-00068850: 0d0a 2020 2020 4974 2074 6865 6e20 6372  ..    It then cr
-00068860: 6561 7465 7320 7469 6d65 2073 6572 6965  eates time serie
-00068870: 7320 6665 6174 7572 6573 2075 7369 6e67  s features using
-00068880: 2074 6865 2070 616e 6461 7320 2e64 742e   the pandas .dt.
-00068890: 7765 656b 6461 7920 6b69 6e64 206f 6620  weekday kind of 
-000688a0: 7379 6e74 6178 2e0d 0a20 2020 2049 7420  syntax...    It 
-000688b0: 616c 736f 2072 6574 7572 6e73 2074 6865  also returns the
-000688c0: 2064 6174 6120 6672 616d 6520 6f66 2061   data frame of a
-000688d0: 6464 6564 2066 6561 7475 7265 7320 7769  dded features wi
-000688e0: 7468 2065 6163 6820 7661 7269 6162 6c65  th each variable
-000688f0: 2061 7320 616e 2069 6e74 6567 6572 2076   as an integer v
-00068900: 6172 6961 626c 652e 0d0a 2020 2020 2222  ariable...    ""
-00068910: 220d 0a20 2020 2064 6620 3d20 636f 7079  "..    df = copy
-00068920: 2e64 6565 7063 6f70 7928 6466 290d 0a20  .deepcopy(df).. 
-00068930: 2020 2064 745f 6164 6473 203d 205b 5d0d     dt_adds = [].
-00068940: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-00068950: 2020 2064 665b 7473 636f 6c2b 275f 686f     df[tscol+'_ho
-00068960: 7572 275d 203d 2064 665b 7473 636f 6c5d  ur'] = df[tscol]
-00068970: 2e64 742e 686f 7572 2e66 696c 6c6e 6128  .dt.hour.fillna(
-00068980: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
-00068990: 2020 2020 2020 2020 6466 5b74 7363 6f6c          df[tscol
-000689a0: 2b27 5f6d 696e 7574 6527 5d20 3d20 6466  +'_minute'] = df
-000689b0: 5b74 7363 6f6c 5d2e 6474 2e6d 696e 7574  [tscol].dt.minut
-000689c0: 652e 6669 6c6c 6e61 2830 292e 6173 7479  e.fillna(0).asty
-000689d0: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
-000689e0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-000689f0: 7473 636f 6c2b 275f 686f 7572 2729 0d0a  tscol+'_hour')..
-00068a00: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
-00068a10: 6170 7065 6e64 2874 7363 6f6c 2b27 5f6d  append(tscol+'_m
-00068a20: 696e 7574 6527 290d 0a20 2020 2065 7863  inute')..    exc
-00068a30: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
-00068a40: 696e 7428 2720 2020 2045 7272 6f72 2069  int('    Error i
-00068a50: 6e20 6372 6561 7469 6e67 2068 6f75 722d  n creating hour-
-00068a60: 7365 636f 6e64 2064 6572 6976 6564 2066  second derived f
-00068a70: 6561 7475 7265 732e 2043 6f6e 7469 6e75  eatures. Continu
-00068a80: 696e 672e 2e2e 2729 0d0a 2020 2020 7472  ing...')..    tr
-00068a90: 793a 0d0a 2020 2020 2020 2020 6466 5b74  y:..        df[t
-00068aa0: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
-00068ab0: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
-00068ac0: 742e 6461 796f 6677 6565 6b2e 6669 6c6c  t.dayofweek.fill
-00068ad0: 6e61 2830 292e 6173 7479 7065 2869 6e74  na(0).astype(int
-00068ae0: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
-00068af0: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
-00068b00: 275f 6461 796f 6677 6565 6b27 290d 0a20  '_dayofweek').. 
-00068b10: 2020 2020 2020 2069 6620 7473 636f 6c2b         if tscol+
-00068b20: 275f 686f 7572 2720 696e 2064 745f 6164  '_hour' in dt_ad
-00068b30: 6473 3a0d 0a20 2020 2020 2020 2020 2020  ds:..           
-00068b40: 2044 4159 5320 3d20 6469 6374 287a 6970   DAYS = dict(zip
-00068b50: 2872 616e 6765 2837 292c 5b27 5375 6e27  (range(7),['Sun'
-00068b60: 2c20 274d 6f6e 272c 2027 5475 6527 2c20  , 'Mon', 'Tue', 
-00068b70: 2757 6564 272c 2027 5468 7527 2c20 2746  'Wed', 'Thu', 'F
-00068b80: 7269 272c 2027 5361 7427 5d29 290d 0a20  ri', 'Sat'])).. 
-00068b90: 2020 2020 2020 2020 2020 2064 665b 7473             df[ts
-00068ba0: 636f 6c2b 275f 6461 796f 6677 6565 6b27  col+'_dayofweek'
-00068bb0: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f64  ] = df[tscol+'_d
-00068bc0: 6179 6f66 7765 656b 275d 2e6d 6170 2844  ayofweek'].map(D
-00068bd0: 4159 5329 0d0a 2020 2020 2020 2020 2020  AYS)..          
-00068be0: 2020 6466 2e6c 6f63 5b3a 2c74 7363 6f6c    df.loc[:,tscol
-00068bf0: 2b27 5f64 6179 6f66 7765 656b 5f68 6f75  +'_dayofweek_hou
-00068c00: 725f 6372 6f73 7327 5d20 3d20 6466 5b74  r_cross'] = df[t
-00068c10: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
-00068c20: 275d 202b 2220 222b 2064 665b 7473 636f  '] +" "+ df[tsco
-00068c30: 6c2b 275f 686f 7572 275d 2e61 7374 7970  l+'_hour'].astyp
-00068c40: 6528 7374 7229 0d0a 2020 2020 2020 2020  e(str)..        
-00068c50: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
-00068c60: 6e64 2874 7363 6f6c 2b27 5f64 6179 6f66  nd(tscol+'_dayof
-00068c70: 7765 656b 5f68 6f75 725f 6372 6f73 7327  week_hour_cross'
-00068c80: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
-00068c90: 636f 6c2b 275f 7175 6172 7465 7227 5d20  col+'_quarter'] 
-00068ca0: 3d20 6466 5b74 7363 6f6c 5d2e 6474 2e71  = df[tscol].dt.q
-00068cb0: 7561 7274 6572 2e66 696c 6c6e 6128 3029  uarter.fillna(0)
-00068cc0: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
-00068cd0: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
-00068ce0: 7065 6e64 2874 7363 6f6c 2b27 5f71 7561  pend(tscol+'_qua
-00068cf0: 7274 6572 2729 0d0a 2020 2020 2020 2020  rter')..        
-00068d00: 6466 5b74 7363 6f6c 2b27 5f6d 6f6e 7468  df[tscol+'_month
-00068d10: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
-00068d20: 742e 6d6f 6e74 682e 6669 6c6c 6e61 2830  t.month.fillna(0
-00068d30: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
-00068d40: 2020 2020 2020 204d 4f4e 5448 5320 3d20         MONTHS = 
-00068d50: 6469 6374 287a 6970 2872 616e 6765 2831  dict(zip(range(1
-00068d60: 2c31 3329 2c5b 274a 616e 272c 2027 4665  ,13),['Jan', 'Fe
-00068d70: 6227 2c20 274d 6172 272c 2027 4170 7227  b', 'Mar', 'Apr'
-00068d80: 2c20 274d 6179 272c 2027 4a75 6e27 2c20  , 'May', 'Jun', 
-00068d90: 274a 756c 272c 0d0a 2020 2020 2020 2020  'Jul',..        
-00068da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00068db0: 2020 2020 2020 2020 2020 2020 2741 7567              'Aug
-00068dc0: 272c 2027 5365 7027 2c20 274f 6374 272c  ', 'Sep', 'Oct',
-00068dd0: 2027 4e6f 7627 2c20 2744 6563 275d 2929   'Nov', 'Dec']))
-00068de0: 0d0a 2020 2020 2020 2020 6466 5b74 7363  ..        df[tsc
-00068df0: 6f6c 2b27 5f6d 6f6e 7468 275d 203d 2064  ol+'_month'] = d
-00068e00: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
-00068e10: 5d2e 6d61 7028 4d4f 4e54 4853 290d 0a20  ].map(MONTHS).. 
-00068e20: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00068e30: 7070 656e 6428 7473 636f 6c2b 275f 6d6f  ppend(tscol+'_mo
-00068e40: 6e74 6827 290d 0a20 2020 2020 2020 2023  nth')..        #
-00068e50: 2323 2320 4164 6420 736f 6d65 2066 6561  ### Add some fea
-00068e60: 7475 7265 7320 666f 7220 6d6f 6e74 6873  tures for months
-00068e70: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00068e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068e90: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00068ea0: 2020 2066 6573 7469 7665 7320 3d20 5b27     festives = ['
-00068eb0: 4f63 7427 2c27 4e6f 7627 2c27 4465 6327  Oct','Nov','Dec'
-00068ec0: 5d0d 0a20 2020 2020 2020 206e 616d 655f  ]..        name_
-00068ed0: 636f 6c20 3d20 7473 636f 6c2b 225f 6973  col = tscol+"_is
-00068ee0: 5f66 6573 7469 7665 220d 0a20 2020 2020  _festive"..     
-00068ef0: 2020 2064 665b 6e61 6d65 5f63 6f6c 5d20     df[name_col] 
-00068f00: 3d20 300d 0a20 2020 2020 2020 2064 665b  = 0..        df[
-00068f10: 6e61 6d65 5f63 6f6c 5d20 3d20 6466 5b74  name_col] = df[t
-00068f20: 7363 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d  scol+'_month'].m
-00068f30: 6170 286c 616d 6264 6120 783a 2031 2069  ap(lambda x: 1 i
-00068f40: 6620 7820 696e 2066 6573 7469 7665 7320  f x in festives 
-00068f50: 656c 7365 2030 292e 7661 6c75 6573 0d0a  else 0).values..
-00068f60: 2020 2020 2020 2020 2323 2320 5265 6d65          ### Reme
-00068f70: 6d62 6572 2074 6861 7420 6669 6c6c 6e61  mber that fillna
-00068f80: 206f 6e6c 7920 776f 726b 7320 6174 2064   only works at d
-00068f90: 6174 6166 7261 6d65 206c 6576 656c 2120  ataframe level! 
-00068fa0: 2323 230d 0a20 2020 2020 2020 2064 665b  ###..        df[
-00068fb0: 5b6e 616d 655f 636f 6c5d 5d20 3d20 6466  [name_col]] = df
-00068fc0: 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66 696c  [[name_col]].fil
-00068fd0: 6c6e 6128 3029 0d0a 2020 2020 2020 2020  lna(0)..        
-00068fe0: 6474 5f61 6464 732e 6170 7065 6e64 286e  dt_adds.append(n
-00068ff0: 616d 655f 636f 6c29 0d0a 2020 2020 2020  ame_col)..      
-00069000: 2020 7375 6d6d 6572 203d 205b 274a 756e    summer = ['Jun
-00069010: 272c 274a 756c 272c 2741 7567 275d 0d0a  ','Jul','Aug']..
-00069020: 2020 2020 2020 2020 6e61 6d65 5f63 6f6c          name_col
-00069030: 203d 2074 7363 6f6c 2b22 5f69 735f 7375   = tscol+"_is_su
-00069040: 6d6d 6572 220d 0a20 2020 2020 2020 2064  mmer"..        d
-00069050: 665b 6e61 6d65 5f63 6f6c 5d20 3d20 300d  f[name_col] = 0.
-00069060: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
-00069070: 5f63 6f6c 5d20 3d20 6466 5b74 7363 6f6c  _col] = df[tscol
-00069080: 2b27 5f6d 6f6e 7468 275d 2e6d 6170 286c  +'_month'].map(l
-00069090: 616d 6264 6120 783a 2031 2069 6620 7820  ambda x: 1 if x 
-000690a0: 696e 2073 756d 6d65 7220 656c 7365 2030  in summer else 0
-000690b0: 292e 7661 6c75 6573 0d0a 2020 2020 2020  ).values..      
-000690c0: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
-000690d0: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
-000690e0: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
-000690f0: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
-00069100: 2020 2020 2020 2064 665b 5b6e 616d 655f         df[[name_
-00069110: 636f 6c5d 5d20 3d20 6466 5b5b 6e61 6d65  col]] = df[[name
-00069120: 5f63 6f6c 5d5d 2e66 696c 6c6e 6128 3029  _col]].fillna(0)
-00069130: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
-00069140: 732e 6170 7065 6e64 286e 616d 655f 636f  s.append(name_co
-00069150: 6c29 0d0a 2020 2020 2020 2020 7769 6e74  l)..        wint
-00069160: 6572 203d 205b 2744 6563 272c 274a 616e  er = ['Dec','Jan
-00069170: 272c 2746 6562 275d 0d0a 2020 2020 2020  ','Feb']..      
-00069180: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
-00069190: 6f6c 2b22 5f69 735f 7769 6e74 6572 220d  ol+"_is_winter".
-000691a0: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
-000691b0: 5f63 6f6c 5d20 3d20 300d 0a20 2020 2020  _col] = 0..     
-000691c0: 2020 2064 665b 6e61 6d65 5f63 6f6c 5d20     df[name_col] 
-000691d0: 3d20 6466 5b74 7363 6f6c 2b27 5f6d 6f6e  = df[tscol+'_mon
-000691e0: 7468 275d 2e6d 6170 286c 616d 6264 6120  th'].map(lambda 
-000691f0: 783a 2031 2069 6620 7820 696e 2077 696e  x: 1 if x in win
-00069200: 7465 7220 656c 7365 2030 292e 7661 6c75  ter else 0).valu
-00069210: 6573 0d0a 2020 2020 2020 2020 2323 2320  es..        ### 
-00069220: 5265 6d65 6d62 6572 2074 6861 7420 6669  Remember that fi
-00069230: 6c6c 6e61 206f 6e6c 7920 776f 726b 7320  llna only works 
-00069240: 6174 2064 6174 6166 7261 6d65 206c 6576  at dataframe lev
-00069250: 656c 2120 2323 230d 0a20 2020 2020 2020  el! ###..       
-00069260: 2064 665b 5b6e 616d 655f 636f 6c5d 5d20   df[[name_col]] 
-00069270: 3d20 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d  = df[[name_col]]
-00069280: 2e66 696c 6c6e 6128 3029 0d0a 2020 2020  .fillna(0)..    
-00069290: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
-000692a0: 6e64 286e 616d 655f 636f 6c29 0d0a 2020  nd(name_col)..  
-000692b0: 2020 2020 2020 636f 6c64 203d 205b 274f        cold = ['O
-000692c0: 6374 272c 274e 6f76 272c 2744 6563 272c  ct','Nov','Dec',
-000692d0: 274a 616e 272c 2746 6562 272c 274d 6172  'Jan','Feb','Mar
-000692e0: 275d 0d0a 2020 2020 2020 2020 6e61 6d65  ']..        name
-000692f0: 5f63 6f6c 203d 2074 7363 6f6c 2b22 5f69  _col = tscol+"_i
-00069300: 735f 636f 6c64 220d 0a20 2020 2020 2020  s_cold"..       
-00069310: 2064 665b 6e61 6d65 5f63 6f6c 5d20 3d20   df[name_col] = 
-00069320: 300d 0a20 2020 2020 2020 2064 665b 6e61  0..        df[na
-00069330: 6d65 5f63 6f6c 5d20 3d20 6466 5b74 7363  me_col] = df[tsc
-00069340: 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d 6170  ol+'_month'].map
-00069350: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
-00069360: 7820 696e 2063 6f6c 6420 656c 7365 2030  x in cold else 0
-00069370: 292e 7661 6c75 6573 0d0a 2020 2020 2020  ).values..      
-00069380: 2020 2323 2320 5265 6d65 6d62 6572 2074    ### Remember t
-00069390: 6861 7420 6669 6c6c 6e61 206f 6e6c 7920  hat fillna only 
-000693a0: 776f 726b 7320 6174 2064 6174 6166 7261  works at datafra
-000693b0: 6d65 206c 6576 656c 2120 2323 230d 0a20  me level! ###.. 
-000693c0: 2020 2020 2020 2064 665b 5b6e 616d 655f         df[[name_
-000693d0: 636f 6c5d 5d20 3d20 6466 5b5b 6e61 6d65  col]] = df[[name
-000693e0: 5f63 6f6c 5d5d 2e66 696c 6c6e 6128 3029  _col]].fillna(0)
-000693f0: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
-00069400: 732e 6170 7065 6e64 286e 616d 655f 636f  s.append(name_co
-00069410: 6c29 0d0a 2020 2020 2020 2020 7761 726d  l)..        warm
-00069420: 203d 205b 2741 7072 272c 274d 6179 272c   = ['Apr','May',
-00069430: 274a 756e 272c 274a 756c 272c 2741 7567  'Jun','Jul','Aug
-00069440: 272c 2753 6570 275d 0d0a 2020 2020 2020  ','Sep']..      
-00069450: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
-00069460: 6f6c 2b22 5f69 735f 7761 726d 220d 0a20  ol+"_is_warm".. 
-00069470: 2020 2020 2020 2064 665b 6e61 6d65 5f63         df[name_c
-00069480: 6f6c 5d20 3d20 300d 0a20 2020 2020 2020  ol] = 0..       
-00069490: 2064 665b 6e61 6d65 5f63 6f6c 5d20 3d20   df[name_col] = 
-000694a0: 6466 5b74 7363 6f6c 2b27 5f6d 6f6e 7468  df[tscol+'_month
-000694b0: 275d 2e6d 6170 286c 616d 6264 6120 783a  '].map(lambda x:
-000694c0: 2031 2069 6620 7820 696e 2077 6172 6d20   1 if x in warm 
-000694d0: 656c 7365 2030 292e 7661 6c75 6573 0d0a  else 0).values..
-000694e0: 2020 2020 2020 2020 6466 5b5b 6e61 6d65          df[[name
-000694f0: 5f63 6f6c 5d5d 203d 2064 665b 5b6e 616d  _col]] = df[[nam
-00069500: 655f 636f 6c5d 5d2e 6669 6c6c 6e61 2830  e_col]].fillna(0
-00069510: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
-00069520: 6473 2e61 7070 656e 6428 6e61 6d65 5f63  ds.append(name_c
-00069530: 6f6c 290d 0a20 2020 2020 2020 2023 2323  ol)..        ###
-00069540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069580: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-00069590: 6966 2074 7363 6f6c 2b27 5f64 6179 6f66  if tscol+'_dayof
-000695a0: 7765 656b 2720 696e 2064 745f 6164 6473  week' in dt_adds
-000695b0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
-000695c0: 662e 6c6f 635b 3a2c 7473 636f 6c2b 275f  f.loc[:,tscol+'_
-000695d0: 6d6f 6e74 685f 6461 796f 6677 6565 6b5f  month_dayofweek_
-000695e0: 6372 6f73 7327 5d20 3d20 6466 5b74 7363  cross'] = df[tsc
-000695f0: 6f6c 2b27 5f6d 6f6e 7468 275d 202b 2220  ol+'_month'] +" 
-00069600: 222b 2064 665b 7473 636f 6c2b 275f 6461  "+ df[tscol+'_da
-00069610: 796f 6677 6565 6b27 5d0d 0a20 2020 2020  yofweek']..     
-00069620: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00069630: 7070 656e 6428 7473 636f 6c2b 275f 6d6f  ppend(tscol+'_mo
-00069640: 6e74 685f 6461 796f 6677 6565 6b5f 6372  nth_dayofweek_cr
-00069650: 6f73 7327 290d 0a20 2020 2020 2020 2064  oss')..        d
-00069660: 665b 7473 636f 6c2b 275f 7965 6172 275d  f[tscol+'_year']
-00069670: 203d 2064 665b 7473 636f 6c5d 2e64 742e   = df[tscol].dt.
-00069680: 7965 6172 2e66 696c 6c6e 6128 3029 2e61  year.fillna(0).a
-00069690: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-000696a0: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
-000696b0: 6e64 2874 7363 6f6c 2b27 5f79 6561 7227  nd(tscol+'_year'
-000696c0: 290d 0a20 2020 2020 2020 2074 6f64 6179  )..        today
-000696d0: 203d 2064 6174 652e 746f 6461 7928 290d   = date.today().
-000696e0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
-000696f0: 6c2b 275f 6167 655f 696e 5f79 6561 7273  l+'_age_in_years
-00069700: 275d 203d 2074 6f64 6179 2e79 6561 7220  '] = today.year 
-00069710: 2d20 6466 5b74 7363 6f6c 5d2e 6474 2e79  - df[tscol].dt.y
-00069720: 6561 722e 6669 6c6c 6e61 2830 292e 6173  ear.fillna(0).as
-00069730: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-00069740: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
-00069750: 6428 7473 636f 6c2b 275f 6167 655f 696e  d(tscol+'_age_in
-00069760: 5f79 6561 7273 2729 0d0a 2020 2020 2020  _years')..      
-00069770: 2020 6466 5b74 7363 6f6c 2b27 5f64 6179    df[tscol+'_day
-00069780: 6f66 7965 6172 275d 203d 2064 665b 7473  ofyear'] = df[ts
-00069790: 636f 6c5d 2e64 742e 6461 796f 6679 6561  col].dt.dayofyea
-000697a0: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
-000697b0: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
-000697c0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-000697d0: 7473 636f 6c2b 275f 6461 796f 6679 6561  tscol+'_dayofyea
-000697e0: 7227 290d 0a20 2020 2020 2020 2064 665b  r')..        df[
-000697f0: 7473 636f 6c2b 275f 6461 796f 666d 6f6e  tscol+'_dayofmon
-00069800: 7468 275d 203d 2064 665b 7473 636f 6c5d  th'] = df[tscol]
-00069810: 2e64 742e 6461 792e 6669 6c6c 6e61 2830  .dt.day.fillna(0
-00069820: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
-00069830: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00069840: 7070 656e 6428 7473 636f 6c2b 275f 6461  ppend(tscol+'_da
-00069850: 796f 666d 6f6e 7468 2729 0d0a 2020 2020  yofmonth')..    
-00069860: 2020 2020 6466 5b74 7363 6f6c 2b27 5f77      df[tscol+'_w
-00069870: 6565 6b6f 6679 6561 7227 5d20 3d20 6466  eekofyear'] = df
-00069880: 5b74 7363 6f6c 5d2e 6474 2e77 6565 6b6f  [tscol].dt.weeko
-00069890: 6679 6561 722e 6669 6c6c 6e61 2830 292e  fyear.fillna(0).
-000698a0: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
-000698b0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
-000698c0: 656e 6428 7473 636f 6c2b 275f 7765 656b  end(tscol+'_week
-000698d0: 6f66 7965 6172 2729 0d0a 2020 2020 2020  ofyear')..      
-000698e0: 2020 7765 656b 656e 6473 203d 2028 6466    weekends = (df
-000698f0: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7765  [tscol+'_dayofwe
-00069900: 656b 275d 203d 3d20 2753 6174 2729 207c  ek'] == 'Sat') |
-00069910: 2028 6466 5b74 7363 6f6c 2b27 5f64 6179   (df[tscol+'_day
-00069920: 6f66 7765 656b 275d 203d 3d20 2753 756e  ofweek'] == 'Sun
-00069930: 2729 0d0a 2020 2020 2020 2020 6466 5b74  ')..        df[t
-00069940: 7363 6f6c 2b27 5f74 7970 656f 6664 6179  scol+'_typeofday
-00069950: 275d 203d 2027 7765 656b 6461 7927 0d0a  '] = 'weekday'..
-00069960: 2020 2020 2020 2020 6466 2e6c 6f63 5b77          df.loc[w
-00069970: 6565 6b65 6e64 732c 2074 7363 6f6c 2b27  eekends, tscol+'
-00069980: 5f74 7970 656f 6664 6179 275d 203d 2027  _typeofday'] = '
-00069990: 7765 656b 656e 6427 0d0a 2020 2020 2020  weekend'..      
-000699a0: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
-000699b0: 2874 7363 6f6c 2b27 5f74 7970 656f 6664  (tscol+'_typeofd
-000699c0: 6179 2729 0d0a 2020 2020 2020 2020 6966  ay')..        if
-000699d0: 2074 7363 6f6c 2b27 5f74 7970 656f 6664   tscol+'_typeofd
-000699e0: 6179 2720 696e 2064 745f 6164 6473 3a0d  ay' in dt_adds:.
-000699f0: 0a20 2020 2020 2020 2020 2020 2064 662e  .            df.
-00069a00: 6c6f 635b 3a2c 7473 636f 6c2b 275f 6d6f  loc[:,tscol+'_mo
-00069a10: 6e74 685f 7479 7065 6f66 6461 795f 6372  nth_typeofday_cr
-00069a20: 6f73 7327 5d20 3d20 6466 5b74 7363 6f6c  oss'] = df[tscol
-00069a30: 2b27 5f6d 6f6e 7468 275d 202b 2220 222b  +'_month'] +" "+
-00069a40: 2064 665b 7473 636f 6c2b 275f 7479 7065   df[tscol+'_type
-00069a50: 6f66 6461 7927 5d0d 0a20 2020 2020 2020  ofday']..       
-00069a60: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
-00069a70: 656e 6428 7473 636f 6c2b 275f 6d6f 6e74  end(tscol+'_mont
-00069a80: 685f 7479 7065 6f66 6461 795f 6372 6f73  h_typeofday_cros
-00069a90: 7327 290d 0a20 2020 2065 7863 6570 743a  s')..    except:
-00069aa0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00069ab0: 2720 2020 2045 7272 6f72 2069 6e20 6372  '    Error in cr
-00069ac0: 6561 7469 6e67 2064 6174 6520 7469 6d65  eating date time
-00069ad0: 2064 6572 6976 6564 2066 6561 7475 7265   derived feature
-00069ae0: 732e 2043 6f6e 7469 6e75 696e 672e 2e2e  s. Continuing...
-00069af0: 2729 0d0a 2020 2020 7072 696e 7428 2720  ')..    print(' 
-00069b00: 2020 2041 6464 6564 2025 6420 636f 6c75     Added %d colu
-00069b10: 6d6e 7320 6672 6f6d 2025 7320 636f 6c75  mns from %s colu
-00069b20: 6d6e 2720 2528 6c65 6e28 6474 5f61 6464  mn' %(len(dt_add
-00069b30: 7329 2c74 7363 6f6c 2929 0d0a 2020 2020  s),tscol))..    
-00069b40: 6466 203d 2064 665b 6474 5f61 6464 735d  df = df[dt_adds]
-00069b50: 0d0a 2020 2020 7265 7475 726e 2064 660d  ..    return df.
-00069b60: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00069b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069b80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069b90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069ba0: 230d 0a66 726f 6d20 6461 7465 7574 696c  #..from dateutil
-00069bb0: 2e72 656c 6174 6976 6564 656c 7461 2069  .relativedelta i
-00069bc0: 6d70 6f72 7420 7265 6c61 7469 7665 6465  mport relativede
-00069bd0: 6c74 610d 0a66 726f 6d20 6461 7465 7469  lta..from dateti
-00069be0: 6d65 2069 6d70 6f72 7420 6461 7465 0d0a  me import date..
-00069bf0: 2323 2323 2320 5468 6973 2069 7320 6120  ##### This is a 
-00069c00: 6c69 7474 6c65 2075 7469 6c69 7479 2074  little utility t
-00069c10: 6861 7420 636f 6d70 7574 6573 2061 6765  hat computes age
-00069c20: 2066 726f 6d20 7965 6172 2023 2323 230d   from year ####.
-00069c30: 0a64 6566 2063 6f6d 7075 7465 5f61 6765  .def compute_age
-00069c40: 2879 6561 725f 7374 7269 6e67 293a 0d0a  (year_string):..
-00069c50: 2020 2020 746f 6461 7920 3d20 6461 7465      today = date
-00069c60: 2e74 6f64 6179 2829 0d0a 2020 2020 6167  .today()..    ag
-00069c70: 6520 3d20 7265 6c61 7469 7665 6465 6c74  e = relativedelt
-00069c80: 6128 746f 6461 792c 2079 6561 725f 7374  a(today, year_st
-00069c90: 7269 6e67 290d 0a20 2020 2072 6574 7572  ring)..    retur
-00069ca0: 6e20 6167 652e 7965 6172 730d 0a23 2323  n age.years..###
-00069cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069ce0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00069cf0: 6465 6620 6372 6561 7465 5f74 696d 655f  def create_time_
-00069d00: 7365 7269 6573 5f66 6561 7475 7265 7328  series_features(
-00069d10: 6474 662c 2074 735f 636f 6c75 6d6e 293a  dtf, ts_column):
-00069d20: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
-00069d30: 6869 7320 6372 6561 7465 7320 6265 7477  his creates betw
-00069d40: 6565 6e20 3820 616e 6420 3130 2064 6174  een 8 and 10 dat
-00069d50: 6520 7469 6d65 2066 6561 7475 7265 7320  e time features 
-00069d60: 666f 7220 6561 6368 2064 6174 6520 7661  for each date va
-00069d70: 7269 6162 6c65 2e20 5468 6520 6e75 6d62  riable. The numb
-00069d80: 6572 206f 6620 6665 6174 7572 6573 0d0a  er of features..
-00069d90: 2020 2020 6465 7065 6e64 7320 6f6e 2077      depends on w
-00069da0: 6865 7468 6572 2069 7420 6973 206a 7573  hether it is jus
-00069db0: 7420 6120 7965 6172 2076 6172 6961 626c  t a year variabl
-00069dc0: 6520 6f72 2061 2079 6561 722b 6d6f 6e74  e or a year+mont
-00069dd0: 682b 6461 7920 616e 6420 7768 6574 6865  h+day and whethe
-00069de0: 7220 6974 2068 6173 2068 6f75 7273 2061  r it has hours a
-00069df0: 6e64 206d 696e 732b 7365 6373 2e0d 0a20  nd mins+secs... 
-00069e00: 2020 2053 6f20 7468 6973 2063 616e 2063     So this can c
-00069e10: 7265 6174 6520 616c 6c20 7468 6573 6520  reate all these 
-00069e20: 6665 6174 7572 6573 2075 7369 6e67 206a  features using j
-00069e30: 7573 7420 7468 6520 6461 7465 2074 696d  ust the date tim
-00069e40: 6520 636f 6c75 6d6e 2074 6861 7420 796f  e column that yo
-00069e50: 7520 7365 6e64 2069 6e2e 0d0a 2020 2020  u send in...    
-00069e60: 4974 2072 6574 7572 6e73 2074 6865 2065  It returns the e
-00069e70: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
-00069e80: 7769 7468 2061 6464 6564 2076 6172 6961  with added varia
-00069e90: 626c 6573 2061 7320 6f75 7470 7574 2e0d  bles as output..
-00069ea0: 0a20 2020 2022 2222 0d0a 2020 2020 6474  .    """..    dt
-00069eb0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
-00069ec0: 7928 6474 6629 0d0a 2020 2020 2323 2323  y(dtf)..    ####
-00069ed0: 2049 6620 666f 7220 736f 6d65 2072 6561   If for some rea
-00069ee0: 736f 6e20 7473 5f63 6f6c 756d 6e20 6973  son ts_column is
-00069ef0: 206a 7573 7420 6120 6e75 6d62 6572 2c20   just a number, 
-00069f00: 6d61 6b65 2073 7572 6520 6974 2069 7320  make sure it is 
-00069f10: 6120 7374 7269 6e67 2073 6f20 6974 2064  a string so it d
-00069f20: 6f65 7320 6e6f 7420 626c 6f77 2075 7020  oes not blow up 
-00069f30: 616e 6420 636f 6e63 6174 656e 6174 6564  and concatenated
-00069f40: 0d0a 2020 2020 6966 206e 6f74 2069 7369  ..    if not isi
-00069f50: 6e73 7461 6e63 6528 7473 5f63 6f6c 756d  nstance(ts_colum
-00069f60: 6e2c 7374 7229 3a0d 0a20 2020 2020 2020  n,str):..       
-00069f70: 2074 735f 636f 6c75 6d6e 203d 2073 7472   ts_column = str
-00069f80: 2874 735f 636f 6c75 6d6e 290d 0a20 2020  (ts_column)..   
-00069f90: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
-00069fa0: 2323 2049 6e20 736f 6d65 2065 7874 7265  ## In some extre
-00069fb0: 6d65 2063 6173 6573 2c20 6461 7465 2074  me cases, date t
-00069fc0: 696d 6520 7661 7273 2061 7265 206e 6f74  ime vars are not
-00069fd0: 2070 726f 6365 7373 6564 2079 6574 2061   processed yet a
-00069fe0: 6e64 2068 656e 6365 2077 6520 6d75 7374  nd hence we must
-00069ff0: 2066 696c 6c20 6d69 7373 696e 6720 7661   fill missing va
-0006a000: 6c75 6573 2068 6572 6521 0d0a 2020 2020  lues here!..    
-0006a010: 2020 2020 6966 2064 7466 5b74 735f 636f      if dtf[ts_co
-0006a020: 6c75 6d6e 5d2e 6973 6e75 6c6c 2829 2e73  lumn].isnull().s
-0006a030: 756d 2829 203e 2030 3a0d 0a20 2020 2020  um() > 0:..     
-0006a040: 2020 2020 2020 206d 6973 7369 6e67 5f66         missing_f
-0006a050: 6c61 6720 3d20 5472 7565 0d0a 2020 2020  lag = True..    
-0006a060: 2020 2020 2020 2020 6e65 775f 6d69 7373          new_miss
-0006a070: 696e 675f 636f 6c20 3d20 7473 5f63 6f6c  ing_col = ts_col
-0006a080: 756d 6e20 2b20 275f 4d69 7373 696e 675f  umn + '_Missing_
-0006a090: 466c 6167 270d 0a20 2020 2020 2020 2020  Flag'..         
-0006a0a0: 2020 2064 7466 5b6e 6577 5f6d 6973 7369     dtf[new_missi
-0006a0b0: 6e67 5f63 6f6c 5d20 3d20 300d 0a20 2020  ng_col] = 0..   
-0006a0c0: 2020 2020 2020 2020 2064 7466 2e6c 6f63           dtf.loc
-0006a0d0: 5b64 7466 5b74 735f 636f 6c75 6d6e 5d2e  [dtf[ts_column].
-0006a0e0: 6973 6e75 6c6c 2829 2c6e 6577 5f6d 6973  isnull(),new_mis
-0006a0f0: 7369 6e67 5f63 6f6c 5d3d 310d 0a20 2020  sing_col]=1..   
-0006a100: 2020 2020 2020 2020 2023 2323 2052 656d           ### Rem
-0006a110: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
-0006a120: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
-0006a130: 7468 6520 6461 7461 6672 616d 6520 6c65  the dataframe le
-0006a140: 7665 6c21 0d0a 2020 2020 2020 2020 2020  vel!..          
-0006a150: 2020 6474 665b 5b74 735f 636f 6c75 6d6e    dtf[[ts_column
-0006a160: 5d5d 203d 2064 7466 5b5b 7473 5f63 6f6c  ]] = dtf[[ts_col
-0006a170: 756d 6e5d 5d2e 6669 6c6c 6e61 286d 6574  umn]].fillna(met
-0006a180: 686f 643d 2766 6669 6c6c 2729 0d0a 2020  hod='ffill')..  
-0006a190: 2020 2020 2020 6966 2064 7466 5b74 735f        if dtf[ts_
-0006a1a0: 636f 6c75 6d6e 5d2e 6474 7970 6520 696e  column].dtype in
-0006a1b0: 205b 6e70 2e66 6c6f 6174 3634 2c6e 702e   [np.float64,np.
-0006a1c0: 666c 6f61 7433 322c 6e70 2e66 6c6f 6174  float32,np.float
-0006a1d0: 3136 5d3a 0d0a 2020 2020 2020 2020 2020  16]:..          
-0006a1e0: 2020 6474 665b 7473 5f63 6f6c 756d 6e5d    dtf[ts_column]
-0006a1f0: 203d 2064 7466 5b74 735f 636f 6c75 6d6e   = dtf[ts_column
-0006a200: 5d2e 6173 7479 7065 2869 6e74 290d 0a20  ].astype(int).. 
-0006a210: 2020 2020 2020 2023 2323 2069 6620 7765         ### if we
-0006a220: 2068 6176 6520 616c 7265 6164 7920 666f   have already fo
-0006a230: 756e 6420 7468 6174 2069 7420 7761 7320  und that it was 
-0006a240: 6120 6461 7465 2074 696d 6520 7661 722c  a date time var,
-0006a250: 2074 6865 6e20 6c65 6176 6520 6974 2061   then leave it a
-0006a260: 7320 6974 2069 732e 2054 6861 7473 2067  s it is. Thats g
-0006a270: 6f6f 6420 656e 6f75 6768 210d 0a20 2020  ood enough!..   
-0006a280: 2020 2020 2064 6174 655f 6974 656d 7320       date_items 
-0006a290: 3d20 6474 665b 7473 5f63 6f6c 756d 6e5d  = dtf[ts_column]
-0006a2a0: 2e61 7070 6c79 2873 7472 292e 6170 706c  .apply(str).appl
-0006a2b0: 7928 6c65 6e29 2e76 616c 7565 730d 0a20  y(len).values.. 
-0006a2c0: 2020 2020 2020 2023 2323 2320 496e 2073         #### In s
-0006a2d0: 6f6d 6520 6578 7472 656d 6520 6361 7365  ome extreme case
-0006a2e0: 732c 0d0a 2020 2020 2020 2020 6966 2061  s,..        if a
-0006a2f0: 6c6c 2864 6174 655f 6974 656d 735b 305d  ll(date_items[0]
-0006a300: 203d 3d20 6974 656d 2066 6f72 2069 7465   == item for ite
-0006a310: 6d20 696e 2064 6174 655f 6974 656d 7329  m in date_items)
-0006a320: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0006a330: 6620 6461 7465 5f69 7465 6d73 5b30 5d20  f date_items[0] 
-0006a340: 3d3d 2034 3a0d 0a20 2020 2020 2020 2020  == 4:..         
-0006a350: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
-0006a360: 2069 7320 6a75 7374 2061 2079 6561 7220   is just a year 
-0006a370: 7661 7269 6162 6c65 2061 6c6f 6e65 2c20  variable alone, 
-0006a380: 796f 7520 7368 6f75 6c64 206c 6561 7665  you should leave
-0006a390: 2069 7420 6173 206a 7573 7420 6120 7965   it as just a ye
-0006a3a0: 6172 210d 0a20 2020 2020 2020 2020 2020  ar!..           
-0006a3b0: 2020 2020 2061 6765 5f63 6f6c 203d 2074       age_col = t
-0006a3c0: 735f 636f 6c75 6d6e 2b27 5f61 6765 5f69  s_column+'_age_i
-0006a3d0: 6e5f 7965 6172 7327 0d0a 2020 2020 2020  n_years'..      
-0006a3e0: 2020 2020 2020 2020 2020 6474 665b 6167            dtf[ag
-0006a3f0: 655f 636f 6c5d 203d 2064 7466 5b74 735f  e_col] = dtf[ts_
-0006a400: 636f 6c75 6d6e 5d2e 6d61 7028 6c61 6d62  column].map(lamb
-0006a410: 6461 2078 3a20 7064 2e74 6f5f 6461 7465  da x: pd.to_date
-0006a420: 7469 6d65 2878 2c66 6f72 6d61 743d 2725  time(x,format='%
-0006a430: 5927 2929 2e61 7070 6c79 2863 6f6d 7075  Y')).apply(compu
-0006a440: 7465 5f61 6765 292e 7661 6c75 6573 0d0a  te_age).values..
-0006a450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a460: 7265 7475 726e 2064 7466 5b5b 7473 5f63  return dtf[[ts_c
-0006a470: 6f6c 756d 6e2c 6167 655f 636f 6c5d 5d0d  olumn,age_col]].
-0006a480: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0006a490: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0006a4a0: 2020 2020 2323 2320 6966 2069 7420 6973      ### if it is
-0006a4b0: 206e 6f74 2061 2079 6561 7220 616c 6f6e   not a year alon
-0006a4c0: 652c 2074 6865 6e20 636f 6e76 6572 7420  e, then convert 
-0006a4d0: 6974 2069 6e74 6f20 6120 6461 7465 2074  it into a date t
-0006a4e0: 696d 6520 7661 7269 6162 6c65 0d0a 2020  ime variable..  
-0006a4f0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
-0006a500: 665b 7473 5f63 6f6c 756d 6e5d 203d 2070  f[ts_column] = p
-0006a510: 642e 746f 5f64 6174 6574 696d 6528 6474  d.to_datetime(dt
-0006a520: 665b 7473 5f63 6f6c 756d 6e5d 2c20 696e  f[ts_column], in
-0006a530: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
-0006a540: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
-0006a550: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006a560: 2020 2020 2020 6474 665b 7473 5f63 6f6c        dtf[ts_col
-0006a570: 756d 6e5d 203d 2070 642e 746f 5f64 6174  umn] = pd.to_dat
-0006a580: 6574 696d 6528 6474 665b 7473 5f63 6f6c  etime(dtf[ts_col
-0006a590: 756d 6e5d 2c20 696e 6665 725f 6461 7465  umn], infer_date
-0006a5a0: 7469 6d65 5f66 6f72 6d61 743d 5472 7565  time_format=True
-0006a5b0: 290d 0a20 2020 2020 2020 2064 7466 203d  )..        dtf =
-0006a5c0: 2063 7265 6174 655f 7473 5f66 6561 7475   create_ts_featu
-0006a5d0: 7265 7328 6474 662c 7473 5f63 6f6c 756d  res(dtf,ts_colum
-0006a5e0: 6e29 0d0a 2020 2020 6578 6365 7074 3a0d  n)..    except:.
-0006a5f0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0006a600: 4572 726f 7220 696e 2050 726f 6365 7373  Error in Process
-0006a610: 696e 6720 2573 2063 6f6c 756d 6e20 666f  ing %s column fo
-0006a620: 7220 6461 7465 2074 696d 6520 6665 6174  r date time feat
-0006a630: 7572 6573 2e20 436f 6e74 696e 7569 6e67  ures. Continuing
-0006a640: 2e2e 2e27 2025 7473 5f63 6f6c 756d 6e29  ...' %ts_column)
-0006a650: 0d0a 2020 2020 7265 7475 726e 2064 7466  ..    return dtf
-0006a660: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0006a670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a680: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
-0006a690: 2063 6f6c 6c65 6374 696f 6e73 2069 6d70   collections imp
-0006a6a0: 6f72 7420 436f 756e 7465 720d 0a69 6d70  ort Counter..imp
-0006a6b0: 6f72 7420 7469 6d65 0d0a 2323 2323 2323  ort time..######
-0006a6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a6e0: 2323 0d0a 696d 706f 7274 2077 6172 6e69  ##..import warni
-0006a6f0: 6e67 730d 0a77 6172 6e69 6e67 732e 6669  ngs..warnings.fi
-0006a700: 6c74 6572 7761 726e 696e 6773 2822 6967  lterwarnings("ig
-0006a710: 6e6f 7265 2229 0d0a 6672 6f6d 2073 6b6c  nore")..from skl
-0006a720: 6561 726e 2e65 7863 6570 7469 6f6e 7320  earn.exceptions 
-0006a730: 696d 706f 7274 2044 6174 6143 6f6e 7665  import DataConve
-0006a740: 7273 696f 6e57 6172 6e69 6e67 0d0a 7761  rsionWarning..wa
-0006a750: 726e 696e 6773 2e66 696c 7465 7277 6172  rnings.filterwar
-0006a760: 6e69 6e67 7328 6163 7469 6f6e 3d27 6967  nings(action='ig
-0006a770: 6e6f 7265 272c 2063 6174 6567 6f72 793d  nore', category=
-0006a780: 4461 7461 436f 6e76 6572 7369 6f6e 5761  DataConversionWa
-0006a790: 726e 696e 6729 0d0a 2323 2323 2323 2323  rning)..########
-0006a7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a7e0: 2323 2323 2323 2323 2323 2323 0d0a 6672  ############..fr
-0006a7f0: 6f6d 2073 6b6c 6561 726e 2e75 7469 6c73  om sklearn.utils
-0006a800: 2e63 6c61 7373 5f77 6569 6768 7420 696d  .class_weight im
-0006a810: 706f 7274 2063 6f6d 7075 7465 5f63 6c61  port compute_cla
-0006a820: 7373 5f77 6569 6768 740d 0a66 726f 6d20  ss_weight..from 
-0006a830: 696d 626c 6561 726e 2e6f 7665 725f 7361  imblearn.over_sa
-0006a840: 6d70 6c69 6e67 2069 6d70 6f72 7420 534d  mpling import SM
-0006a850: 4f54 452c 2053 4d4f 5445 4e43 0d0a 6672  OTE, SMOTENC..fr
-0006a860: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
-0006a870: 6d70 6f72 7420 436f 756e 7465 720d 0a69  mport Counter..i
-0006a880: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
-0006a890: 7274 2070 6462 0d0a 2323 2323 2323 2323  rt pdb..########
-0006a8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a8e0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0006a8f0: 0a23 2323 2052 6567 7265 7373 696f 6e5f  .### Regression_
-0006a900: 5265 7361 6d70 6c65 7220 6973 2061 206e  Resampler is a n
-0006a910: 6561 7420 6c69 6272 6172 7920 7468 6174  eat library that
-0006a920: 2072 6574 7572 6e73 2061 206e 756d 7079   returns a numpy
-0006a930: 206c 6973 7420 6f66 2063 6c61 7373 6573   list of classes
-0006a940: 2066 6f72 2065 6163 680d 0a23 2323 2020   for each..###  
-0006a950: 636f 7272 6573 706f 6e64 696e 6720 7361  corresponding sa
-0006a960: 6d70 6c65 2e20 6672 6f6d 2074 6172 6765  mple. from targe
-0006a970: 7420 6461 7461 2e20 4974 2065 6e61 626c  t data. It enabl
-0006a980: 6573 2072 6567 7265 7369 736f 6e20 7072  es regresison pr
-0006a990: 6f62 6c65 6d73 2074 6f20 7573 6520 534d  oblems to use SM
-0006a9a0: 4f54 452e 0d0a 2323 2320 2049 2068 6176  OTE...###  I hav
-0006a9b0: 6520 7573 6564 2061 2073 696d 696c 6172  e used a similar
-0006a9c0: 2063 6f6e 6365 7074 2062 7574 2069 6d70   concept but imp
-0006a9d0: 6c65 6d65 6e74 6564 2069 7420 6d79 2077  lemented it my w
-0006a9e0: 6179 2075 7369 6e67 204b 2d4d 6561 6e73  ay using K-Means
-0006a9f0: 2061 6c67 6f72 6974 686d 2e0d 0a23 2323   algorithm...###
-0006aa00: 2020 4d79 2073 696e 6365 7265 2074 6861    My sincere tha
-0006aa10: 6e6b 7320 746f 2074 6865 2063 7265 6174  nks to the creat
-0006aa20: 6f72 7320 6f66 2074 6865 206c 6962 7261  ors of the libra
-0006aa30: 7279 3a0d 0a23 2323 2020 2020 2068 7474  ry:..###     htt
-0006aa40: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0006aa50: 6174 6966 2d68 6173 7361 6e2f 5265 6772  atif-hassan/Regr
-0006aa60: 6573 7369 6f6e 5f52 6553 616d 706c 696e  ession_ReSamplin
-0006aa70: 672f 0d0a 2323 2323 2323 2323 2323 2323  g/..############
-0006aa80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006aa90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006aaa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006aab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006aac0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-0006aad0: 2074 7261 696e 696e 675f 7769 7468 5f53   training_with_S
-0006aae0: 4d4f 5445 2858 5f64 662c 795f 6466 2c74  MOTE(X_df,y_df,t
-0006aaf0: 6172 6765 742c 6576 616c 5f73 6574 2c6d  arget,eval_set,m
-0006ab00: 6f64 656c 5f69 6e70 7574 2c42 6f6f 7374  odel_input,Boost
-0006ab10: 696e 675f 466c 6167 2c65 7661 6c5f 6d65  ing_Flag,eval_me
-0006ab20: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
-0006ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ab40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0006ab50: 6f64 656c 7479 7065 2c20 6d6f 6465 6c5f  odeltype, model_
-0006ab60: 6e61 6d65 2c0d 0a20 2020 2020 2020 2020  name,..         
-0006ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ab80: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-0006ab90: 6e69 6e67 3d54 7275 652c 6d69 6e6f 7269  ning=True,minori
-0006aba0: 7479 5f63 6c61 7373 3d31 2c69 6d70 5f63  ty_class=1,imp_c
-0006abb0: 6174 733d 5b5d 2c0d 0a20 2020 2020 2020  ats=[],..       
-0006abc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006abd0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-0006abe0: 6c69 6272 6174 6f72 5f66 6c61 673d 4661  librator_flag=Fa
-0006abf0: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0006ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ac10: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
-0006ac20: 7869 7374 733d 4661 6c73 652c 2070 6172  xists=False, par
-0006ac30: 616d 733d 7b7d 2c0d 0a20 2020 2020 2020  ams={},..       
-0006ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ac50: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0006ac60: 6465 6c5f 6c61 6265 6c3d 2753 696e 676c  del_label='Singl
-0006ac70: 655f 4c61 6265 6c27 2c20 7665 7262 6f73  e_Label', verbos
-0006ac80: 653d 3029 3a0d 0a20 2020 2022 2222 0d0a  e=0):..    """..
-0006ac90: 2020 2020 2323 2323 2323 2323 2320 2020      #########   
-0006aca0: 204f 5645 5253 414d 504c 494e 4720 4f46   OVERSAMPLING OF
-0006acb0: 204d 494e 4f52 4954 5920 434c 4153 5320   MINORITY CLASS 
-0006acc0: 414e 4420 5452 4149 4e49 4e47 2020 5349  AND TRAINING  SI
-0006acd0: 5a45 5320 2023 2323 2323 2323 2323 2323  ZES  ###########
-0006ace0: 2323 2323 0d0a 2020 2020 2323 2323 2020  ####..    ####  
-0006acf0: 534d 4f54 4520 2853 796e 7468 6574 6963  SMOTE (Synthetic
-0006ad00: 204d 696e 6f72 6974 7920 4f76 6572 7361   Minority Oversa
-0006ad10: 6d70 6c69 6e67 2054 6563 686e 6971 7565  mpling Technique
-0006ad20: 2920 776f 726b 7320 7765 6c6c 2077 6974  ) works well wit
-0006ad30: 6820 696d 6261 6c61 6e63 6564 2063 6c61  h imbalanced cla
-0006ad40: 7373 6573 2e0d 0a20 2020 2023 2323 2320  sses...    #### 
-0006ad50: 2054 6869 7320 6973 2061 2067 7265 6174   This is a great
-0006ad60: 2077 6179 2074 6f20 7472 6169 6e20 6120   way to train a 
-0006ad70: 6d6f 6465 6c20 696e 2073 7563 6820 6361  model in such ca
-0006ad80: 7365 7320 7769 7468 2072 6570 6561 7465  ses with repeate
-0006ad90: 6420 7361 6d70 6c65 7320 6f66 2072 6172  d samples of rar
-0006ada0: 652d 636c 6173 730d 0a20 2020 2023 2323  e-class..    ###
-0006adb0: 2320 2061 6c6f 6e67 2077 6974 6820 6261  #  along with ba
-0006adc0: 7463 6865 7320 6f66 206d 616a 6f72 6974  tches of majorit
-0006add0: 7920 636c 6173 7320 616e 6420 6765 7420  y class and get 
-0006ade0: 7468 6520 6d6f 6465 6c20 746f 2064 6966  the model to dif
-0006adf0: 6665 7265 6e74 6961 7465 2062 6574 7765  ferentiate betwe
-0006ae00: 656e 2032 2063 6c61 7373 6573 2e0d 0a20  en 2 classes... 
-0006ae10: 2020 2023 2323 2320 2054 6869 7320 6361     ####  This ca
-0006ae20: 6e20 616c 736f 2062 6520 7573 6564 2066  n also be used f
-0006ae30: 6f72 2052 6567 7265 7373 696f 6e20 7072  or Regression pr
-0006ae40: 6f62 6c65 6d73 2062 7920 7573 696e 6720  oblems by using 
-0006ae50: 7468 6520 6e75 6d65 7269 6320 7461 7267  the numeric targ
-0006ae60: 6574 2076 616c 7565 7320 636f 6e76 6572  et values conver
-0006ae70: 7465 640d 0a20 2020 2023 2323 2320 2074  ted..    ####  t
-0006ae80: 6f20 636c 7573 7465 7220 6c61 6265 6c73  o cluster labels
-0006ae90: 2075 7369 6e67 204b 4d65 616e 732e 2059   using KMeans. Y
-0006aea0: 6f75 2063 616e 2074 6865 6e20 7573 6520  ou can then use 
-0006aeb0: 7468 6520 636c 7573 7465 7220 6c61 6265  the cluster labe
-0006aec0: 6c73 2074 6f20 6164 6420 6d6f 7265 2073  ls to add more s
-0006aed0: 616d 706c 6573 2e0d 0a20 2020 2023 2323  amples...    ###
-0006aee0: 2323 2323 2323 2020 2020 4d41 4b45 2053  ######    MAKE S
-0006aef0: 5552 4520 594f 5520 5455 4e45 2054 4845  URE YOU TUNE THE
-0006af00: 2044 4546 4155 4c54 5320 4749 5645 4e20   DEFAULTS GIVEN 
-0006af10: 4845 5245 2120 2023 2323 2323 2323 2323  HERE!  #########
-0006af20: 2323 2323 2323 0d0a 2020 2020 2222 220d  ######..    """.
-0006af30: 0a20 2020 2058 5f64 6620 3d20 636f 7079  .    X_df = copy
-0006af40: 2e64 6565 7063 6f70 7928 585f 6466 290d  .deepcopy(X_df).
-0006af50: 0a20 2020 2079 5f64 6620 3d20 636f 7079  .    y_df = copy
-0006af60: 2e64 6565 7063 6f70 7928 795f 6466 290d  .deepcopy(y_df).
-0006af70: 0a20 2020 206d 6f64 656c 5f63 6f70 7920  .    model_copy 
-0006af80: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-0006af90: 6d6f 6465 6c5f 696e 7075 7429 0d0a 2020  model_input)..  
-0006afa0: 2020 6d6f 6465 6c20 3d20 636f 7079 2e64    model = copy.d
-0006afb0: 6565 7063 6f70 7928 6d6f 6465 6c5f 636f  eepcopy(model_co
-0006afc0: 7079 290d 0a20 2020 2073 7461 7274 5f74  py)..    start_t
-0006afd0: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-0006afe0: 290d 0a20 2020 2023 2323 2323 204e 6f77  )..    ##### Now
-0006aff0: 2077 6520 7769 6c6c 2073 7461 7274 2075   we will start u
-0006b000: 7369 6e67 2052 6573 616d 706c 696e 6720  sing Resampling 
-0006b010: 4c69 6272 6172 7920 746f 206d 616b 6520  Library to make 
-0006b020: 6461 7461 206d 6f72 6520 6261 6c61 6e63  data more balanc
-0006b030: 6564 2023 2323 0d0a 2020 2020 6966 206d  ed ###..    if m
-0006b040: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
-0006b050: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
-0006b060: 2020 2070 7269 6e74 2822 5573 696e 6720     print("Using 
-0006b070: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
-0006b080: 706c 6572 206c 6962 7261 7279 2074 6f20  pler library to 
-0006b090: 6d61 6b65 2073 6b65 7765 6420 7461 7267  make skewed targ
-0006b0a0: 6574 2076 6172 6961 626c 6520 6d6f 7265  et variable more
-0006b0b0: 2062 616c 616e 6365 642e 2e2e 2229 0d0a   balanced...")..
-0006b0c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006b0d0: 2020 2023 7072 696e 7428 2255 7369 6e67     #print("Using
-0006b0e0: 2053 4d4f 5445 2773 206f 7665 722d 7361   SMOTE's over-sa
-0006b0f0: 6d70 6c69 6e67 2074 6563 686e 6971 7565  mpling technique
-0006b100: 7320 746f 206d 616b 6520 7468 6520 2564  s to make the %d
-0006b110: 2063 6c61 7373 6573 2062 616c 616e 6365   classes balance
-0006b120: 642e 2e2e 2220 256c 656e 286e 702e 756e  d..." %len(np.un
-0006b130: 6971 7565 2879 5f64 6629 2929 0d0a 2020  ique(y_df)))..  
-0006b140: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
-0006b150: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
-0006b160: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
-0006b170: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0006b180: 7428 2755 7369 6e67 2053 656c 662d 5061  t('Using Self-Pa
-0006b190: 6365 6420 456e 7365 6d62 6c65 2043 6c61  ced Ensemble Cla
-0006b1a0: 7373 6966 6965 7220 746f 2068 616e 646c  ssifier to handl
-0006b1b0: 6520 7468 6973 2049 6d62 616c 616e 6365  e this Imbalance
-0006b1c0: 6420 6461 7461 7365 742e 2e2e 2729 0d0a  d dataset...')..
-0006b1d0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0006b1e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0006b1f0: 2827 5573 696e 6720 4f6e 6556 7352 6573  ('Using OneVsRes
-0006b200: 742b 5365 6c66 2d50 6163 6564 2045 6e73  t+Self-Paced Ens
-0006b210: 656d 626c 6520 436c 6173 7369 6669 6572  emble Classifier
-0006b220: 2074 6f20 6861 6e64 6c65 2074 6869 7320   to handle this 
-0006b230: 496d 6261 6c61 6e63 6564 2064 6174 6173  Imbalanced datas
-0006b240: 6574 2e2e 2e27 290d 0a20 2020 2074 7279  et...')..    try
-0006b250: 3a0d 0a20 2020 2020 2020 2023 2323 2323  :..        #####
-0006b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b2a0: 2323 0d0a 2020 2020 2020 2020 2320 496e  ##..        # In
-0006b2b0: 6974 6961 6c69 7a65 2074 6865 2072 6573  itialize the res
-0006b2c0: 616d 706c 6572 206f 626a 6563 740d 0a20  ampler object.. 
-0006b2d0: 2020 2020 2020 2064 665f 7472 6169 6e20         df_train 
-0006b2e0: 3d20 585f 6466 2e6a 6f69 6e28 795f 6466  = X_df.join(y_df
-0006b2f0: 290d 0a20 2020 2020 2020 2023 2047 656e  )..        # Gen
-0006b300: 6572 6174 6520 636c 6173 7365 730d 0a20  erate classes.. 
-0006b310: 2020 2020 2020 2023 2323 2320 5365 6c65         #### Sele
-0006b320: 6374 2074 6865 2072 6967 6874 2053 4d4f  ct the right SMO
-0006b330: 5445 2061 6c67 6f72 6974 686d 2062 6173  TE algorithm bas
-0006b340: 6564 206f 6e20 7768 6574 6865 7220 7468  ed on whether th
-0006b350: 6572 6520 6172 6520 616e 7920 696d 705f  ere are any imp_
-0006b360: 6361 7473 2069 6e20 6461 7461 0d0a 2020  cats in data..  
-0006b370: 2020 2020 2020 6361 745f 7661 7273 5f69        cat_vars_i
-0006b380: 6e64 6578 203d 205b 6920 666f 7220 692c  ndex = [i for i,
-0006b390: 206a 2069 6e20 656e 756d 6572 6174 6528   j in enumerate(
-0006b3a0: 585f 6466 2e63 6f6c 756d 6e73 2920 6966  X_df.columns) if
-0006b3b0: 206a 2069 6e20 696d 705f 6361 7473 5d0d   j in imp_cats].
-0006b3c0: 0a20 2020 2020 2020 2023 2323 2067 6574  .        ### get
-0006b3d0: 2074 6865 206e 756d 6265 7220 6f66 204b   the number of K
-0006b3e0: 5f4e 6569 6768 626f 7273 2075 7369 6e67  _Neighbors using
-0006b3f0: 2074 6869 7320 6361 6c63 756c 6174 696f   this calculatio
-0006b400: 6e0d 0a20 2020 2020 2020 2072 6172 655f  n..        rare_
-0006b410: 7361 6d70 6c65 7320 3d20 7064 2e53 6572  samples = pd.Ser
-0006b420: 6965 7328 436f 756e 7465 7228 795f 6466  ies(Counter(y_df
-0006b430: 2929 2e6d 696e 2829 0d0a 2020 2020 2020  )).min()..      
-0006b440: 2020 2370 7269 6e74 2827 2020 2020 4e75    #print('    Nu
-0006b450: 6d62 6572 206f 6620 5261 7265 2043 6c61  mber of Rare Cla
-0006b460: 7373 2073 616d 706c 6573 203d 2025 6427  ss samples = %d'
-0006b470: 2025 7261 7265 5f73 616d 706c 6573 290d   %rare_samples).
-0006b480: 0a20 2020 2020 2020 2072 6172 655f 7063  .        rare_pc
-0006b490: 7420 3d20 7261 7265 5f73 616d 706c 6573  t = rare_samples
-0006b4a0: 2f79 5f64 662e 7368 6170 655b 305d 0d0a  /y_df.shape[0]..
-0006b4b0: 2020 2020 2020 2020 736d 616c 6c65 7374          smallest
-0006b4c0: 5f6b 6e20 3d20 2072 6172 655f 7361 6d70  _kn =  rare_samp
-0006b4d0: 6c65 7320 2d20 310d 0a20 2020 2020 2020  les - 1..       
-0006b4e0: 2069 6620 736d 616c 6c65 7374 5f6b 6e20   if smallest_kn 
-0006b4f0: 3e20 353a 0d0a 2020 2020 2020 2020 2020  > 5:..          
-0006b500: 2020 736d 616c 6c65 7374 5f6b 6e20 3d20    smallest_kn = 
-0006b510: 350d 0a20 2020 2020 2020 2065 6c69 6620  5..        elif 
-0006b520: 736d 616c 6c65 7374 5f6b 6e20 3e20 3220  smallest_kn > 2 
-0006b530: 616e 6420 736d 616c 6c65 7374 5f6b 6e20  and smallest_kn 
-0006b540: 3c20 353a 0d0a 2020 2020 2020 2020 2020  < 5:..          
-0006b550: 2020 736d 616c 6c65 7374 5f6b 6e20 3d20    smallest_kn = 
-0006b560: 320d 0a20 2020 2020 2020 2065 6c73 6520  2..        else 
-0006b570: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0006b580: 6d61 6c6c 6573 745f 6b6e 203d 2031 0d0a  mallest_kn = 1..
-0006b590: 2020 2020 2020 2020 2370 7269 6e74 2827          #print('
-0006b5a0: 2020 2020 4e75 6d62 6572 206f 6620 4b20      Number of K 
-0006b5b0: 4e65 6967 6862 6f72 7320 7365 6c65 6374  Neighbors select
-0006b5c0: 6564 2066 6f72 2053 4d4f 5445 203d 2025  ed for SMOTE = %
-0006b5d0: 6427 2025 736d 616c 6c65 7374 5f6b 6e29  d' %smallest_kn)
-0006b5e0: 0d0a 2020 2020 2020 2020 2370 7269 6e74  ..        #print
-0006b5f0: 2827 2020 2020 5063 7420 6f66 2052 6172  ('    Pct of Rar
-0006b600: 6520 436c 6173 7320 696e 2064 6174 6120  e Class in data 
-0006b610: 3d20 2530 2e32 6625 2527 2025 2872 6172  = %0.2f%%' %(rar
-0006b620: 655f 7063 742a 3130 3029 290d 0a20 2020  e_pct*100))..   
-0006b630: 2020 2020 2069 6620 7261 7265 5f70 6374       if rare_pct
-0006b640: 203e 2030 2e31 303a 0d0a 2020 2020 2020   > 0.10:..      
-0006b650: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-0006b660: 2054 6869 7320 6973 206e 6f74 2061 6e20   This is not an 
-0006b670: 496d 6261 6c61 6e63 6564 2064 6174 6120  Imbalanced data 
-0006b680: 7365 742e 204e 6f20 6e65 6564 2074 6f20  set. No need to 
-0006b690: 7573 6520 534d 4f54 4520 6275 7420 636f  use SMOTE but co
-0006b6a0: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a20  ntinuing...').. 
-0006b6b0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-0006b6c0: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-0006b6d0: 4d4f 5445 2069 7320 6572 726f 7269 6e67  MOTE is erroring
-0006b6e0: 2e20 436f 6e74 696e 7569 6e67 2077 6974  . Continuing wit
-0006b6f0: 686f 7574 2053 4d4f 5445 2e2e 2e27 290d  hout SMOTE...').
-0006b700: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0006b710: 6d6f 6465 6c0d 0a20 2020 2020 2020 2023  model..        #
-0006b720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b760: 2323 2323 2323 0d0a 2020 2020 2323 2320  ######..    ### 
-0006b770: 6e6f 7720 7472 6169 6e20 7468 6520 6d6f  now train the mo
-0006b780: 6465 6c20 6f6e 2066 756c 6c20 7472 6169  del on full trai
-0006b790: 6e20 6461 7461 2023 2323 2323 2323 2323  n data #########
-0006b7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b7b0: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
-0006b7c0: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-0006b7d0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-0006b7e0: 2020 2020 2320 5265 6772 6573 7369 6f6e      # Regression
-0006b7f0: 2070 726f 626c 656d 2074 7572 6e65 6420   problem turned 
-0006b800: 696e 746f 2043 6c61 7373 6966 6963 6174  into Classificat
-0006b810: 696f 6e20 7072 6f62 6c65 6d0d 0a20 2020  ion problem..   
-0006b820: 2020 2020 206e 5f63 6c75 7374 6572 7320       n_clusters 
-0006b830: 3d20 6d61 7828 332c 2069 6e74 286e 702e  = max(3, int(np.
-0006b840: 6c6f 6731 3028 6c65 6e28 795f 6466 2929  log10(len(y_df))
-0006b850: 2920 2b20 3129 0d0a 2020 2020 2020 2020  ) + 1)..        
-0006b860: 2320 5573 6520 4b4d 6561 6e73 2074 6f20  # Use KMeans to 
-0006b870: 6669 6e64 206e 6174 7572 616c 2063 6c75  find natural clu
-0006b880: 7374 6572 7320 696e 2079 6f75 7220 6461  sters in your da
-0006b890: 7461 0d0a 2020 2020 2020 2020 6b6d 5f6d  ta..        km_m
-0006b8a0: 6f64 656c 203d 204b 4d65 616e 7328 6e5f  odel = KMeans(n_
-0006b8b0: 636c 7573 7465 7273 3d6e 5f63 6c75 7374  clusters=n_clust
-0006b8c0: 6572 732c 0d0a 2020 2020 2020 2020 2020  ers,..          
-0006b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b8e0: 6e5f 696e 6974 3d35 2c0d 0a20 2020 2020  n_init=5,..     
-0006b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b900: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-0006b910: 653d 3939 290d 0a20 2020 2020 2020 2023  e=99)..        #
-0006b920: 2323 2320 7265 6d65 6d62 6572 2079 6f75  ### remember you
-0006b930: 206d 7573 7420 7072 6564 6963 7420 7573   must predict us
-0006b940: 696e 6720 6f6e 6c79 2070 7265 6469 6374  ing only predict
-0006b950: 6f72 2076 6172 6961 626c 6573 210d 0a20  or variables!.. 
-0006b960: 2020 2020 2020 2059 5f63 6c61 7373 6573         Y_classes
-0006b970: 203d 206b 6d5f 6d6f 6465 6c2e 6669 745f   = km_model.fit_
-0006b980: 7072 6564 6963 7428 585f 6466 290d 0a20  predict(X_df).. 
-0006b990: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006b9a0: 2020 595f 636c 6173 7365 7320 3d20 636f    Y_classes = co
-0006b9b0: 7079 2e64 6565 7063 6f70 7928 795f 6466  py.deepcopy(y_df
-0006b9c0: 290d 0a20 2020 2023 2323 2320 534d 4f54  )..    #### SMOT
-0006b9d0: 4520 776f 726b 7320 6f6e 6c79 2066 6f72  E works only for
-0006b9e0: 2053 696e 676c 6520 4c61 6265 6c20 7072   Single Label pr
-0006b9f0: 6f62 6c65 6d73 2023 2323 230d 0a20 2020  oblems ####..   
-0006ba00: 2069 6620 6d6f 6465 6c5f 6c61 6265 6c20   if model_label 
-0006ba10: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
-0006ba20: 273a 0d0a 2020 2020 2020 2020 636c 6173  ':..        clas
-0006ba30: 735f 7765 6967 6874 6564 5f72 6f77 7320  s_weighted_rows 
-0006ba40: 3d20 6765 745f 636c 6173 735f 6469 7374  = get_class_dist
-0006ba50: 7269 6275 7469 6f6e 2859 5f63 6c61 7373  ribution(Y_class
-0006ba60: 6573 290d 0a20 2020 2020 2020 2069 6620  es)..        if 
-0006ba70: 6c65 6e28 696d 705f 6361 7473 2920 3e20  len(imp_cats) > 
-0006ba80: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0006ba90: 2320 596f 7572 2066 6176 6f75 7269 7465  # Your favourite
-0006baa0: 206f 7665 7273 616d 706c 6572 203d 2053   oversampler = S
-0006bab0: 4d4f 5445 4e43 2069 7320 6265 7474 6572  MOTENC is better
-0006bac0: 2074 6861 6e20 534d 4f54 4520 696e 206d   than SMOTE in m
-0006bad0: 6f73 7420 6361 7365 7321 0d0a 2020 2020  ost cases!..    
-0006bae0: 2020 2020 2020 2020 736d 6f74 6520 3d20          smote = 
-0006baf0: 534d 4f54 454e 4328 6361 7465 676f 7269  SMOTENC(categori
-0006bb00: 6361 6c5f 6665 6174 7572 6573 3d63 6174  cal_features=cat
-0006bb10: 5f76 6172 735f 696e 6465 782c 0d0a 2020  _vars_index,..  
-0006bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bb30: 2020 2020 2020 7361 6d70 6c69 6e67 5f73        sampling_s
-0006bb40: 7472 6174 6567 793d 636c 6173 735f 7765  trategy=class_we
-0006bb50: 6967 6874 6564 5f72 6f77 732c 0d0a 2020  ighted_rows,..  
-0006bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bb70: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-0006bb80: 7465 3d34 322c 206b 5f6e 6569 6768 626f  te=42, k_neighbo
-0006bb90: 7273 3d73 6d61 6c6c 6573 745f 6b6e 2c20  rs=smallest_kn, 
-0006bba0: 6e5f 6a6f 6273 3d2d 3129 0d0a 2020 2020  n_jobs=-1)..    
-0006bbb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006bbc0: 2020 2020 2020 2023 2059 6f75 7220 6661         # Your fa
-0006bbd0: 766f 7572 6974 6520 6f76 6572 7361 6d70  vourite oversamp
-0006bbe0: 6c65 7220 3d20 534d 4f54 4520 6973 2062  ler = SMOTE is b
-0006bbf0: 6574 7465 7220 7468 616e 2053 4d4f 5445  etter than SMOTE
-0006bc00: 454e 4e20 696e 206d 6f73 7420 6361 7365  ENN in most case
-0006bc10: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-0006bc20: 736d 6f74 6520 3d20 534d 4f54 4528 7261  smote = SMOTE(ra
-0006bc30: 6e64 6f6d 5f73 7461 7465 3d32 372c 2073  ndom_state=27, s
-0006bc40: 616d 706c 696e 675f 7374 7261 7465 6779  ampling_strategy
-0006bc50: 3d63 6c61 7373 5f77 6569 6768 7465 645f  =class_weighted_
-0006bc60: 726f 7773 2c20 6e5f 6a6f 6273 3d2d 3129  rows, n_jobs=-1)
-0006bc70: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-0006bc80: 2323 2323 2323 2323 2323 2323 2323 2020  ##############  
-0006bc90: 2020 5265 6772 6573 7369 6f6e 2052 6573    Regression Res
-0006bca0: 616d 706c 6572 2020 2020 2323 2323 2323  ampler    ######
-0006bcb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006bcc0: 2323 230d 0a20 2020 2074 7279 3a0d 0a20  ###..    try:.. 
-0006bcd0: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
-0006bce0: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
-0006bcf0: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-0006bd00: 2020 2323 2323 2055 7369 6e67 2072 6567    #### Using reg
-0006bd10: 2072 6573 616d 706c 6572 2077 696c 6c20   resampler will 
-0006bd20: 6e65 6564 2074 6172 6765 7420 636f 6c75  need target colu
-0006bd30: 6d6e 2069 6e20 6466 5f74 7261 696e 2074  mn in df_train t
-0006bd40: 7261 696e 202d 2064 6f6e 2774 2066 6f72  rain - don't for
-0006bd50: 6765 7421 0d0a 2020 2020 2020 2020 2020  get!..          
-0006bd60: 2020 585f 6466 5f72 6573 2c20 795f 6466    X_df_res, y_df
-0006bd70: 5f72 6573 203d 206b 6d65 616e 735f 7265  _res = kmeans_re
-0006bd80: 7361 6d70 6c65 7228 585f 6466 2c20 795f  sampler(X_df, y_
-0006bd90: 6466 2c20 7461 7267 6574 2c20 736d 6f74  df, target, smot
-0006bda0: 652c 2076 6572 626f 7365 290d 0a20 2020  e, verbose)..   
-0006bdb0: 2020 2020 2020 2020 2023 2323 2074 6865           ### the
-0006bdc0: 2078 5f64 665f 7265 7320 6f75 7470 7574   x_df_res output
-0006bdd0: 206f 6620 7265 7361 6d70 6c65 7220 7769   of resampler wi
-0006bde0: 6c6c 206e 6f74 2068 6176 6520 7468 6520  ll not have the 
-0006bdf0: 7461 7267 6574 2073 696e 6365 2069 7420  target since it 
-0006be00: 7769 6c6c 2068 6176 6520 6265 656e 2072  will have been r
-0006be10: 656d 6f76 6564 210d 0a20 2020 2020 2020  emoved!..       
-0006be20: 2020 2020 2023 2323 2079 5f64 665f 7265       ### y_df_re
-0006be30: 7320 7769 6c6c 2068 6176 6520 7468 6520  s will have the 
-0006be40: 7461 7267 6574 2063 6f6c 756d 6e20 7769  target column wi
-0006be50: 7468 206e 6f77 2065 7874 7261 2072 6f77  th now extra row
-0006be60: 7320 666f 7220 7265 6772 6573 7369 6f6e  s for regression
-0006be70: 2074 7261 696e 696e 6721 0d0a 2020 2020   training!..    
-0006be80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006be90: 2020 2020 2020 2023 2323 2320 466f 7220         #### For 
-0006bea0: 636c 6173 7369 6669 6361 7469 6f6e 2070  classification p
-0006beb0: 726f 626c 656d 7320 7369 6d70 6c79 2075  roblems simply u
-0006bec0: 7369 6e67 2074 6865 206f 7269 6769 6e61  sing the origina
-0006bed0: 6c20 6461 7461 2077 696c 6c20 646f 0d0a  l data will do..
-0006bee0: 2020 2020 2020 2020 2020 2020 2358 5f64              #X_d
-0006bef0: 665f 7265 732c 2079 5f64 665f 7265 7320  f_res, y_df_res 
-0006bf00: 3d20 736d 6f74 652e 6669 745f 7265 7361  = smote.fit_resa
-0006bf10: 6d70 6c65 2858 5f64 662c 2079 5f64 6629  mple(X_df, y_df)
-0006bf20: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0006bf30: 2320 466f 7220 636c 6173 7369 6669 6361  # For classifica
-0006bf40: 7469 6f6e 2070 726f 626c 656d 7320 7765  tion problems we
-0006bf50: 2061 7265 2067 6f69 6e67 2074 6f20 7573   are going to us
-0006bf60: 6520 5350 4520 6672 6f6d 206e 6f77 206f  e SPE from now o
-0006bf70: 6e0d 0a20 2020 2020 2020 2020 2020 2069  n..            i
-0006bf80: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-0006bf90: 4269 6e61 7279 5f43 6c61 7373 6966 6963  Binary_Classific
-0006bfa0: 6174 696f 6e27 3a0d 0a20 2020 2020 2020  ation':..       
-0006bfb0: 2020 2020 2020 2020 2023 2323 2046 6f72           ### For
-0006bfc0: 2042 696e 6172 7920 636c 6173 732c 2053   Binary class, S
-0006bfd0: 5045 206d 6f64 656c 2069 7320 6265 7474  PE model is bett
-0006bfe0: 6572 2023 2323 2323 2323 2323 2323 230d  er ############.
-0006bff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c000: 2072 6620 3d20 5261 6e64 6f6d 466f 7265   rf = RandomFore
-0006c010: 7374 436c 6173 7369 6669 6572 286e 5f65  stClassifier(n_e
-0006c020: 7374 696d 6174 6f72 733d 3130 302c 2072  stimators=100, r
-0006c030: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
-0006c040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c050: 2073 7065 203d 2053 656c 6650 6163 6564   spe = SelfPaced
-0006c060: 456e 7365 6d62 6c65 436c 6173 7369 6669  EnsembleClassifi
-0006c070: 6572 2865 7374 696d 6174 6f72 3d72 662c  er(estimator=rf,
-0006c080: 206e 5f6a 6f62 733d 2d31 2c20 736f 6674   n_jobs=-1, soft
-0006c090: 5f72 6573 616d 706c 655f 666c 6167 3d46  _resample_flag=F
-0006c0a0: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-0006c0b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006c0c0: 2020 2020 2020 2020 2020 2323 2046 6f72            ## For
-0006c0d0: 206d 756c 7469 2d63 6c61 7373 204f 6e65   multi-class One
-0006c0e0: 7673 5265 7374 206d 6f64 656c 2069 7320  vsRest model is 
-0006c0f0: 6265 7474 6572 2020 2323 2323 2323 2323  better  ########
-0006c100: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0006c110: 2020 2020 2072 6620 3d20 5261 6e64 6f6d       rf = Random
-0006c120: 466f 7265 7374 436c 6173 7369 6669 6572  ForestClassifier
-0006c130: 286e 5f65 7374 696d 6174 6f72 733d 3130  (n_estimators=10
-0006c140: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
-0006c150: 3939 290d 0a20 2020 2020 2020 2020 2020  99)..           
-0006c160: 2020 2020 2073 7065 203d 2053 656c 6650       spe = SelfP
-0006c170: 6163 6564 456e 7365 6d62 6c65 436c 6173  acedEnsembleClas
-0006c180: 7369 6669 6572 2865 7374 696d 6174 6f72  sifier(estimator
-0006c190: 3d72 662c 206e 5f6a 6f62 733d 2d31 2c20  =rf, n_jobs=-1, 
-0006c1a0: 736f 6674 5f72 6573 616d 706c 655f 666c  soft_resample_fl
-0006c1b0: 6167 3d46 616c 7365 290d 0a20 2020 2020  ag=False)..     
-0006c1c0: 2020 2020 2020 2020 2020 2073 7065 203d             spe =
-0006c1d0: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
-0006c1e0: 6669 6572 2865 7374 696d 6174 6f72 3d73  fier(estimator=s
-0006c1f0: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
-0006c200: 2073 7065 2e66 6974 2858 5f64 662c 2079   spe.fit(X_df, y
-0006c210: 5f64 6629 0d0a 2020 2020 2020 2020 2020  _df)..          
-0006c220: 2020 7265 7475 726e 2073 7065 0d0a 2020    return spe..  
-0006c230: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-0006c240: 2020 2070 7269 6e74 2827 534d 4f54 4520     print('SMOTE 
-0006c250: 6f72 2052 6567 7265 7373 696f 6e2d 7265  or Regression-re
-0006c260: 7361 6d70 6c65 7220 6973 2065 7272 6f72  sampler is error
-0006c270: 696e 672e 2043 6f6e 7469 6e75 696e 672e  ing. Continuing.
-0006c280: 2e2e 2729 0d0a 2020 2020 2020 2020 6d6f  ..')..        mo
-0006c290: 6465 6c20 3d20 6d6f 6465 6c5f 7472 6169  del = model_trai
-0006c2a0: 6e69 6e67 5f73 6d6f 7465 286d 6f64 656c  ning_smote(model
-0006c2b0: 2c20 585f 6466 2c20 795f 6466 2c20 6576  , X_df, y_df, ev
-0006c2c0: 616c 5f73 6574 2c20 6576 616c 5f6d 6574  al_set, eval_met
-0006c2d0: 7269 632c 0d0a 2020 2020 2020 2020 2020  ric,..          
-0006c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c2f0: 2020 2070 6172 616d 732c 2069 6d70 5f63     params, imp_c
-0006c300: 6174 732c 206d 6f64 656c 7479 7065 2c0d  ats, modeltype,.
-0006c310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c320: 2020 2020 2020 2020 2020 2020 2063 616c               cal
-0006c330: 6962 7261 746f 725f 666c 6167 2c20 6d6f  ibrator_flag, mo
-0006c340: 6465 6c5f 6e61 6d65 2c20 426f 6f73 7469  del_name, Boosti
-0006c350: 6e67 5f46 6c61 672c 206d 6f64 656c 5f6c  ng_Flag, model_l
-0006c360: 6162 656c 2c0d 0a20 2020 2020 2020 2020  abel,..         
-0006c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c380: 2020 2020 4750 555f 6578 6973 7473 290d      GPU_exists).
-0006c390: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0006c3a0: 2020 2020 4d6f 6465 6c20 5472 6169 6e69      Model Traini
-0006c3b0: 6e67 2074 696d 6520 7461 6b65 6e20 3d20  ng time taken = 
-0006c3c0: 2530 2e30 6620 7365 636f 6e64 7327 2025  %0.0f seconds' %
-0006c3d0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-0006c3e0: 7274 5f74 696d 6529 290d 0a20 2020 2020  rt_time))..     
-0006c3f0: 2020 2072 6574 7572 6e20 7370 650d 0a20     return spe.. 
-0006c400: 2020 2070 7269 6e74 2827 5472 6169 6e69     print('Traini
-0006c410: 6e67 206d 6f64 656c 206e 6f77 206f 6e20  ng model now on 
-0006c420: 7265 7361 6d70 6c65 6420 7472 6169 6e20  resampled train 
-0006c430: 6461 7461 3a20 2573 2e20 5468 6973 2077  data: %s. This w
-0006c440: 696c 6c20 7461 6b65 2074 696d 652e 2e2e  ill take time...
-0006c450: 2720 2528 585f 6466 5f72 6573 2e73 6861  ' %(X_df_res.sha
-0006c460: 7065 2c29 290d 0a20 2020 2023 2046 6974  pe,))..    # Fit
-0006c470: 2074 6865 206d 6f64 656c 2075 7369 6e67   the model using
-0006c480: 2078 5f74 7261 696e 2061 6e64 2079 5f74   x_train and y_t
-0006c490: 7261 696e 2066 756c 6c20 6461 7461 2073  rain full data s
-0006c4a0: 656e 7420 696e 0d0a 2020 2020 6d6f 6465  ent in..    mode
-0006c4b0: 6c20 3d20 6d6f 6465 6c5f 7472 6169 6e69  l = model_traini
-0006c4c0: 6e67 5f73 6d6f 7465 286d 6f64 656c 2c20  ng_smote(model, 
-0006c4d0: 585f 6466 5f72 6573 2c20 795f 6466 5f72  X_df_res, y_df_r
-0006c4e0: 6573 2c20 6576 616c 5f73 6574 2c20 6576  es, eval_set, ev
-0006c4f0: 616c 5f6d 6574 7269 632c 0d0a 2020 2020  al_metric,..    
-0006c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c510: 2020 2020 2070 6172 616d 732c 2069 6d70       params, imp
-0006c520: 5f63 6174 732c 206d 6f64 656c 7479 7065  _cats, modeltype
-0006c530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0006c540: 2020 2020 2020 2020 2020 2063 616c 6962             calib
-0006c550: 7261 746f 725f 666c 6167 2c20 6d6f 6465  rator_flag, mode
-0006c560: 6c5f 6e61 6d65 2c20 426f 6f73 7469 6e67  l_name, Boosting
-0006c570: 5f46 6c61 672c 206d 6f64 656c 5f6c 6162  _Flag, model_lab
-0006c580: 656c 2c0d 0a20 2020 2020 2020 2020 2020  el,..           
-0006c590: 2020 2020 2020 2020 2020 2020 2020 4750                GP
-0006c5a0: 555f 6578 6973 7473 290d 0a20 2020 2070  U_exists)..    p
-0006c5b0: 7269 6e74 2827 2020 2020 5265 7361 6d70  rint('    Resamp
-0006c5c0: 6c65 6420 6461 7461 2054 7261 696e 696e  led data Trainin
-0006c5d0: 6720 7469 6d65 2074 616b 656e 203d 2025  g time taken = %
-0006c5e0: 302e 3066 2073 6563 6f6e 6473 2720 2528  0.0f seconds' %(
-0006c5f0: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
-0006c600: 745f 7469 6d65 2929 0d0a 2020 2020 234e  t_time))..    #N
-0006c610: 6f77 206d 616b 6520 7072 6564 6963 7469  ow make predicti
-0006c620: 6f6e 7320 6f6e 2068 656c 6420 6f75 7420  ons on held out 
-0006c630: 6461 7461 0d0a 2020 2020 6d6f 6465 6c5f  data..    model_
-0006c640: 7374 7220 3d20 7374 7228 6d6f 6465 6c29  str = str(model)
-0006c650: 2e73 706c 6974 2822 2822 295b 305d 0d0a  .split("(")[0]..
-0006c660: 2020 2020 6966 2074 7261 696e 696e 673a      if training:
-0006c670: 0d0a 2020 2020 2020 2020 785f 7465 7374  ..        x_test
-0006c680: 203d 2065 7661 6c5f 7365 745b 305d 5b30   = eval_set[0][0
-0006c690: 5d0d 0a20 2020 2020 2020 2079 5f74 6573  ]..        y_tes
-0006c6a0: 7420 3d20 6576 616c 5f73 6574 5b30 5d5b  t = eval_set[0][
-0006c6b0: 315d 0d0a 2020 2020 2020 2020 2320 4368  1]..        # Ch
-0006c6c0: 6563 6b20 7468 6520 7363 6f72 650d 0a20  eck the score.. 
-0006c6d0: 2020 2020 2020 2070 7269 6e74 2827 2323         print('##
-0006c6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c710: 2323 2323 2323 2729 0d0a 2020 2020 2020  ######')..      
-0006c720: 2020 7072 696e 7428 2752 6573 616d 706c    print('Resampl
-0006c730: 6564 206d 6f64 656c 2072 6573 756c 7473  ed model results
-0006c740: 206f 6e20 4865 6c64 206f 7574 2056 616c   on Held out Val
-0006c750: 6964 6174 696f 6e20 6461 7461 3a27 290d  idation data:').
-0006c760: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-0006c770: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-0006c780: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0006c790: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
-0006c7a0: 7369 6f6e 5f6d 6574 7269 6373 2879 5f74  sion_metrics(y_t
-0006c7b0: 6573 742c 206d 6f64 656c 2e70 7265 6469  est, model.predi
-0006c7c0: 6374 2878 5f74 6573 7429 290d 0a20 2020  ct(x_test))..   
-0006c7d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0006c7e0: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
-0006c7f0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0006c800: 6f72 7428 795f 7465 7374 2c20 6d6f 6465  ort(y_test, mode
-0006c810: 6c2e 7072 6564 6963 7428 785f 7465 7374  l.predict(x_test
-0006c820: 2929 290d 0a20 2020 2020 2020 2070 7269  )))..        pri
-0006c830: 6e74 2827 2323 2323 2323 2323 2323 2323  nt('############
-0006c840: 2323 2323 2323 2020 436f 6d70 6c65 7465  ######  Complete
-0006c850: 6420 496d 6261 6c61 6e63 6564 2054 7261  d Imbalanced Tra
-0006c860: 696e 696e 6720 7573 696e 6720 2573 2023  ining using %s #
-0006c870: 2323 2323 2323 2323 2323 2323 2323 2327  ###############'
-0006c880: 2025 6d6f 6465 6c5f 7374 7229 0d0a 2020   %model_str)..  
-0006c890: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0006c8a0: 2069 6620 7665 7262 6f73 6520 3e3d 2031   if verbose >= 1
-0006c8b0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-0006c8c0: 6967 2c20 2861 7831 2c20 6178 3229 203d  ig, (ax1, ax2) =
-0006c8d0: 2070 6c74 2e73 7562 706c 6f74 7328 312c   plt.subplots(1,
-0006c8e0: 2032 2c20 7368 6172 6579 3d54 7275 652c   2, sharey=True,
-0006c8f0: 6669 6773 697a 653d 2831 322c 3529 290d  figsize=(12,5)).
-0006c900: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0006c910: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-0006c920: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-0006c930: 2020 2020 2020 2020 2020 2020 795f 6466              y_df
-0006c940: 2e70 6c6f 7428 6b69 6e64 3d27 6869 7374  .plot(kind='hist
-0006c950: 272c 7469 746c 653d 2744 6973 742e 206f  ',title='Dist. o
-0006c960: 6620 7461 7267 6574 2062 6566 6f72 6520  f target before 
-0006c970: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
-0006c980: 706c 6572 272c 2061 783d 6178 312c 2063  pler', ax=ax1, c
-0006c990: 6f6c 6f72 3d27 7227 290d 0a20 2020 2020  olor='r')..     
-0006c9a0: 2020 2020 2020 2020 2020 2070 642e 4461             pd.Da
-0006c9b0: 7461 4672 616d 6528 795f 6466 5f72 6573  taFrame(y_df_res
-0006c9c0: 292e 706c 6f74 286b 696e 643d 2768 6973  ).plot(kind='his
-0006c9d0: 7427 2c74 6974 6c65 3d27 4469 7374 2e20  t',title='Dist. 
-0006c9e0: 6f66 2074 6172 6765 7420 6166 7465 7220  of target after 
-0006c9f0: 5265 6772 6573 7369 6f6e 2052 6573 616d  Regression Resam
-0006ca00: 706c 6572 272c 2061 783d 6178 322c 2063  pler', ax=ax2, c
-0006ca10: 6f6c 6f72 3d27 6227 290d 0a20 2020 2020  olor='b')..     
-0006ca20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0006ca30: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-0006ca40: 6466 2e76 616c 7565 5f63 6f75 6e74 7328  df.value_counts(
-0006ca50: 3129 2e70 6c6f 7428 6b69 6e64 3d27 6261  1).plot(kind='ba
-0006ca60: 7227 2c74 6974 6c65 3d27 4469 7374 7269  r',title='Distri
-0006ca70: 6275 7469 6f6e 206f 6620 636c 6173 7365  bution of classe
-0006ca80: 7320 6265 666f 7265 2053 4d4f 5445 272c  s before SMOTE',
-0006ca90: 2061 783d 6178 312c 2063 6f6c 6f72 3d27   ax=ax1, color='
-0006caa0: 7227 290d 0a20 2020 2020 2020 2020 2020  r')..           
-0006cab0: 2020 2020 2079 5f64 665f 7265 732e 7661       y_df_res.va
-0006cac0: 6c75 655f 636f 756e 7473 2831 292e 706c  lue_counts(1).pl
-0006cad0: 6f74 286b 696e 643d 2762 6172 272c 7469  ot(kind='bar',ti
-0006cae0: 746c 653d 2744 6973 7472 6962 7574 696f  tle='Distributio
-0006caf0: 6e20 6f66 2063 6c61 7373 6573 2061 6674  n of classes aft
-0006cb00: 6572 2053 4d4f 5445 272c 2061 783d 6178  er SMOTE', ax=ax
-0006cb10: 322c 2063 6f6c 6f72 3d27 6227 290d 0a20  2, color='b').. 
-0006cb20: 2020 2072 6574 7572 6e20 6d6f 6465 6c0d     return model.
-0006cb30: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0006cb40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006cb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006cb60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006cb70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006cb80: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0006cb90: 0a64 6566 206d 6f64 656c 5f74 7261 696e  .def model_train
-0006cba0: 696e 675f 736d 6f74 6528 6d6f 6465 6c2c  ing_smote(model,
-0006cbb0: 2078 5f74 7261 696e 2c20 795f 7472 6169   x_train, y_trai
-0006cbc0: 6e2c 2065 7661 6c5f 7365 742c 2065 7661  n, eval_set, eva
-0006cbd0: 6c5f 6d65 7472 6963 2c0d 0a20 2020 2020  l_metric,..     
-0006cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cbf0: 2020 2020 7061 7261 6d73 2c20 696d 705f      params, imp_
-0006cc00: 6361 7473 2c20 6d6f 6465 6c74 7970 652c  cats, modeltype,
-0006cc10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006cc20: 2020 2020 2020 2020 2020 6361 6c69 6272            calibr
-0006cc30: 6174 6f72 5f66 6c61 672c 206d 6f64 656c  ator_flag, model
-0006cc40: 5f6e 616d 652c 2042 6f6f 7374 696e 675f  _name, Boosting_
-0006cc50: 466c 6167 2c20 6d6f 6465 6c5f 6c61 6265  Flag, model_labe
-0006cc60: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-0006cc70: 2020 2020 2020 2020 2020 2020 2047 5055               GPU
-0006cc80: 5f65 7869 7374 7329 3a0d 0a20 2020 2023  _exists):..    #
-0006cc90: 2323 2320 5468 6973 206d 6f64 656c 2074  ### This model t
-0006cca0: 7261 696e 696e 6720 7669 6120 534d 4f54  raining via SMOT
-0006ccb0: 4520 6861 7320 746f 2062 6520 6d6f 6469  E has to be modi
-0006ccc0: 6669 6564 206c 6174 6572 2023 2323 2323  fied later #####
-0006ccd0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0006cce0: 0a20 2020 2065 6172 6c79 5f73 746f 7070  .    early_stopp
-0006ccf0: 696e 6720 3d20 350d 0a20 2020 2069 6620  ing = 5..    if 
-0006cd00: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
-0006cd10: 5369 6e67 6c65 5f4c 6162 656c 273a 0d0a  Single_Label':..
-0006cd20: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
-0006cd30: 696e 675f 466c 6167 3a0d 0a20 2020 2020  ing_Flag:..     
-0006cd40: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
-0006cd50: 6e61 6d65 203d 3d20 2758 4742 6f6f 7374  name == 'XGBoost
-0006cd60: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-0006cd70: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006cd80: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0006cd90: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
-0006cda0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0006cdb0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0006cdc0: 2e66 6974 2878 5f74 7261 696e 2c20 795f  .fit(x_train, y_
-0006cdd0: 7472 6169 6e29 0d0a 2020 2020 2020 2020  train)..        
-0006cde0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0006cdf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0006ce00: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
-0006ce10: 616c 5f73 6574 3d3d 5b28 295d 206f 7220  al_set==[()] or 
-0006ce20: 6d6f 6465 6c74 7970 6520 3d3d 2027 4d75  modeltype == 'Mu
-0006ce30: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
-0006ce40: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-0006ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ce60: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
-0006ce70: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
-0006ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ce90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0006cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ceb0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-0006cec0: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
-0006ced0: 7261 696e 2c65 6172 6c79 5f73 746f 7070  rain,early_stopp
-0006cee0: 696e 675f 726f 756e 6473 3d65 6172 6c79  ing_rounds=early
-0006cef0: 5f73 746f 7070 696e 672c 0d0a 2020 2020  _stopping,..    
+0005e2d0: 2323 2323 2323 2323 0d0a 6465 6620 6c65  ########..def le
+0005e2e0: 6674 5f73 7562 7472 6163 7428 6c31 2c6c  ft_subtract(l1,l
+0005e2f0: 3229 3a0d 0a20 2020 206c 7374 203d 205b  2):..    lst = [
+0005e300: 5d0d 0a20 2020 2066 6f72 2069 2069 6e20  ]..    for i in 
+0005e310: 6c31 3a0d 0a20 2020 2020 2020 2069 6620  l1:..        if 
+0005e320: 6920 6e6f 7420 696e 206c 323a 0d0a 2020  i not in l2:..  
+0005e330: 2020 2020 2020 2020 2020 6c73 742e 6170            lst.ap
+0005e340: 7065 6e64 2869 290d 0a20 2020 2072 6574  pend(i)..    ret
+0005e350: 7572 6e20 6c73 740d 0a23 2323 2323 2323  urn lst..#######
+0005e360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e3a0: 2323 2323 2323 2323 230d 0a66 726f 6d20  #########..from 
+0005e3b0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0005e3c0: 7274 2043 6f75 6e74 6572 0d0a 696d 706f  rt Counter..impo
+0005e3d0: 7274 2074 696d 650d 0a66 726f 6d20 736b  rt time..from sk
+0005e3e0: 6c65 6172 6e2e 6665 6174 7572 655f 7365  learn.feature_se
+0005e3f0: 6c65 6374 696f 6e20 696d 706f 7274 2063  lection import c
+0005e400: 6869 322c 206d 7574 7561 6c5f 696e 666f  hi2, mutual_info
+0005e410: 5f72 6567 7265 7373 696f 6e2c 206d 7574  _regression, mut
+0005e420: 7561 6c5f 696e 666f 5f63 6c61 7373 6966  ual_info_classif
+0005e430: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e66  ..from sklearn.f
+0005e440: 6561 7475 7265 5f73 656c 6563 7469 6f6e  eature_selection
+0005e450: 2069 6d70 6f72 7420 5365 6c65 6374 4b42   import SelectKB
+0005e460: 6573 740d 0a23 2323 2323 2323 2323 2323  est..###########
+0005e470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e4b0: 2323 2323 230d 0a66 726f 6d20 636f 6c6c  #####..from coll
+0005e4c0: 6563 7469 6f6e 7320 696d 706f 7274 2064  ections import d
+0005e4d0: 6566 6175 6c74 6469 6374 0d0a 6672 6f6d  efaultdict..from
+0005e4e0: 2063 6f6c 6c65 6374 696f 6e73 2069 6d70   collections imp
+0005e4f0: 6f72 7420 4f72 6465 7265 6444 6963 740d  ort OrderedDict.
+0005e500: 0a69 6d70 6f72 7420 7469 6d65 0d0a 6465  .import time..de
+0005e510: 6620 7265 7475 726e 5f64 6963 7469 6f6e  f return_diction
+0005e520: 6172 795f 6c69 7374 286c 7374 5f6f 665f  ary_list(lst_of_
+0005e530: 7475 706c 6573 293a 0d0a 2020 2020 2222  tuples):..    ""
+0005e540: 2220 5265 7475 726e 7320 6120 6469 6374  " Returns a dict
+0005e550: 696f 6e61 7279 206f 6620 6c69 7374 7320  ionary of lists 
+0005e560: 6966 2079 6f75 2073 656e 6420 696e 2061  if you send in a
+0005e570: 206c 6973 7420 6f66 2054 7570 6c65 7322   list of Tuples"
+0005e580: 2222 0d0a 2020 2020 6f72 4469 6374 203d  ""..    orDict =
+0005e590: 2064 6566 6175 6c74 6469 6374 286c 6973   defaultdict(lis
+0005e5a0: 7429 0d0a 2020 2020 2320 6974 6572 6174  t)..    # iterat
+0005e5b0: 696e 6720 6f76 6572 206c 6973 7420 6f66  ing over list of
+0005e5c0: 2074 7570 6c65 730d 0a20 2020 2066 6f72   tuples..    for
+0005e5d0: 206b 6579 2c20 7661 6c20 696e 206c 7374   key, val in lst
+0005e5e0: 5f6f 665f 7475 706c 6573 3a0d 0a20 2020  _of_tuples:..   
+0005e5f0: 2020 2020 206f 7244 6963 745b 6b65 795d       orDict[key]
+0005e600: 2e61 7070 656e 6428 7661 6c29 0d0a 2020  .append(val)..  
+0005e610: 2020 7265 7475 726e 206f 7244 6963 740d    return orDict.
+0005e620: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0005e630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e670: 2323 230d 0a64 6566 2072 656d 6f76 655f  ###..def remove_
+0005e680: 7661 7269 6162 6c65 735f 7573 696e 675f  variables_using_
+0005e690: 6661 7374 5f63 6f72 7265 6c61 7469 6f6e  fast_correlation
+0005e6a0: 2864 662c 206e 756d 7661 7273 2c20 6d6f  (df, numvars, mo
+0005e6b0: 6465 6c74 7970 652c 2074 6172 6765 742c  deltype, target,
+0005e6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0005e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005e6e0: 2020 636f 7272 5f6c 696d 6974 203d 2030    corr_limit = 0
+0005e6f0: 2e37 302c 7665 7262 6f73 653d 3029 3a0d  .70,verbose=0):.
+0005e700: 0a20 2020 2022 2222 0d0a 2020 2020 2323  .    """..    ##
+0005e710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e760: 0d0a 2020 2020 2323 2323 2054 4849 5320  ..    #### THIS 
+0005e770: 4d45 5448 4f44 2049 5320 4b4e 4f57 4e20  METHOD IS KNOWN 
+0005e780: 4153 2054 4845 2053 554c 4f56 204d 4554  AS THE SULOV MET
+0005e790: 484f 4420 696e 2048 4f4e 4f52 204f 4620  HOD in HONOR OF 
+0005e7a0: 6d79 206d 6f74 6865 7220 2323 2323 2323  my mother ######
+0005e7b0: 2323 2323 2323 2323 0d0a 2020 2020 2323  ########..    ##
+0005e7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e7e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e7f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005e810: 0d0a 2020 2020 5320 5520 4c20 4f20 5620  ..    S U L O V 
+0005e820: 7265 6665 7273 2074 6f20 5365 6c65 6374  refers to Select
+0005e830: 2055 6e63 6f72 7265 6c61 7465 6420 4c69   Uncorrelated Li
+0005e840: 7374 206f 6620 5661 7269 6162 6c65 733a  st of Variables:
+0005e850: 2043 7265 6174 6564 2062 7920 5261 6d20   Created by Ram 
+0005e860: 5365 7368 6164 7269 0d0a 2020 2020 5355  Seshadri..    SU
+0005e870: 4c4f 5620 6973 2061 2068 6967 686c 7920  LOV is a highly 
+0005e880: 6566 6669 6369 656e 7420 616c 676f 7269  efficient algori
+0005e890: 7468 2074 6861 7420 7573 6573 204d 4953  th that uses MIS
+0005e8a0: 2074 6f20 6272 6561 6b20 7469 652d 6272   to break tie-br
+0005e8b0: 6561 6b65 7273 2061 6d6f 6e67 0d0a 2020  eakers among..  
+0005e8c0: 2020 2068 6967 686c 7920 636f 7272 656c     highly correl
+0005e8d0: 6174 6564 2076 6172 6961 626c 6573 2077  ated variables w
+0005e8e0: 6865 7265 2077 6520 6861 7665 2074 6f20  here we have to 
+0005e8f0: 6465 6369 6465 2077 6869 6368 206f 6620  decide which of 
+0005e900: 7477 6f20 7661 7269 6162 6c65 7320 746f  two variables to
+0005e910: 2064 726f 702e 200d 0a20 2020 2020 4375   drop. ..     Cu
+0005e920: 7272 656e 746c 7920 7468 6572 6520 6973  rrently there is
+0005e930: 206e 6f20 636c 6561 7220 7761 792e 2053   no clear way. S
+0005e940: 554c 4f56 2075 7365 7320 4d49 5320 286d  ULOV uses MIS (m
+0005e950: 7574 7561 6c5f 696e 666f 5f73 636f 7265  utual_info_score
+0005e960: 2920 746f 206b 6565 7020 0d0a 2020 2020  ) to keep ..    
+0005e970: 2074 6865 2068 6967 6865 7220 4d49 5320   the higher MIS 
+0005e980: 7661 7269 6162 6c65 2e20 5468 6973 206d  variable. This m
+0005e990: 6574 686f 6420 656e 6162 6c65 7320 616e  ethod enables an
+0005e9a0: 2065 7874 7265 6d65 6c79 2066 6173 7420   extremely fast 
+0005e9b0: 616e 6420 6566 6665 6374 6976 6520 7761  and effective wa
+0005e9c0: 790d 0a20 2020 2020 746f 2073 656c 6563  y..     to selec
+0005e9d0: 7420 6265 7374 2066 6561 7475 7265 7320  t best features 
+0005e9e0: 6672 6f6d 2064 6174 612e 2059 6f75 206e  from data. You n
+0005e9f0: 6565 6420 746f 2073 656e 6420 696e 2061  eed to send in a
+0005ea00: 2064 6174 6166 7261 6d65 2077 6974 6820   dataframe with 
+0005ea10: 6120 6c69 7374 200d 0a20 2020 2020 6f66  a list ..     of
+0005ea20: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+0005ea30: 6573 2061 6e64 2064 6566 696e 6520 6120  es and define a 
+0005ea40: 7468 7265 7368 6f6c 6420 2d20 7468 6174  threshold - that
+0005ea50: 2773 2061 6c6c 2e0d 0a20 2020 2020 5468  's all...     Th
+0005ea60: 6973 2074 6872 6573 686f 6c64 2077 696c  is threshold wil
+0005ea70: 6c20 6465 6669 6e65 2074 6865 2022 6869  l define the "hi
+0005ea80: 6768 2043 6f72 7265 6c61 7469 6f6e 2220  gh Correlation" 
+0005ea90: 6d61 726b 3a20 6465 6661 756c 7420 6973  mark: default is
+0005eaa0: 202e 3730 2028 6162 736f 6c75 7465 292e   .70 (absolute).
+0005eab0: 0d0a 2020 2020 2059 6f75 2063 616e 2063  ..     You can c
+0005eac0: 6861 6e67 6520 7468 6973 206c 696d 6974  hange this limit
+0005ead0: 2e20 4966 2074 776f 2076 6172 6961 626c  . If two variabl
+0005eae0: 6573 2068 6176 6520 6162 736f 6c75 7465  es have absolute
+0005eaf0: 2063 6f72 7265 6c61 7469 6f6e 2068 6967   correlation hig
+0005eb00: 6865 7220 7468 616e 200d 0a20 2020 2020  her than ..     
+0005eb10: 6c69 6d69 742c 2074 6865 7920 7769 6c6c  limit, they will
+0005eb20: 2062 6520 7265 642d 666c 6167 6765 642c   be red-flagged,
+0005eb30: 2061 6e64 2075 7369 6e67 2061 2073 6572   and using a ser
+0005eb40: 6965 7320 6f66 2074 6965 2d62 7265 616b  ies of tie-break
+0005eb50: 6572 2072 6f75 6e64 732c 206f 6e65 206f  er rounds, one o
+0005eb60: 6620 0d0a 2020 2020 2074 6865 6d20 7769  f ..     them wi
+0005eb70: 6c6c 2062 6520 7365 6c65 6374 6564 2073  ll be selected s
+0005eb80: 696e 6365 2074 6865 2073 616d 6520 7661  ince the same va
+0005eb90: 7269 6162 6c65 2063 616e 2062 6520 636f  riable can be co
+0005eba0: 7272 656c 6174 6564 2074 6f20 6d75 6c74  rrelated to mult
+0005ebb0: 6970 6c65 2076 6172 6961 626c 6573 2e0d  iple variables..
+0005ebc0: 0a20 2020 2020 546f 2064 6563 6964 6520  .     To decide 
+0005ebd0: 7768 6963 6820 7661 7269 6162 6c65 7320  which variables 
+0005ebe0: 746f 206b 6565 7020 696e 206b 6e6f 636b  to keep in knock
+0005ebf0: 6f75 7420 726f 756e 6473 2c20 6d75 7475  out rounds, mutu
+0005ec00: 616c 2069 6e66 6f72 6d61 7469 6f6e 2073  al information s
+0005ec10: 636f 7265 2028 4d49 5329 0d0a 2020 2020  core (MIS)..    
+0005ec20: 2069 7320 7573 6564 2e20 4d49 5320 7265   is used. MIS re
+0005ec30: 7475 726e 7320 6120 7261 6e6b 6564 206c  turns a ranked l
+0005ec40: 6973 7420 6f66 2063 6f72 7265 6c61 7465  ist of correlate
+0005ec50: 6420 7661 7269 6162 6c65 733a 2077 6865  d variables: whe
+0005ec60: 6e20 7765 2073 656c 6563 7420 6f6e 6520  n we select one 
+0005ec70: 746f 0d0a 2020 2020 206b 6565 702c 2077  to..     keep, w
+0005ec80: 6520 6b6e 6f63 6b20 6f75 7420 616c 6c20  e knock out all 
+0005ec90: 6f74 6865 7273 2074 6861 7420 7765 7265  others that were
+0005eca0: 2068 6967 686c 7920 636f 7272 656c 6174   highly correlat
+0005ecb0: 6564 2074 6f20 6974 2e20 5468 6973 2077  ed to it. This w
+0005ecc0: 6179 2077 6520 6b6e 6f63 6b0d 0a20 2020  ay we knock..   
+0005ecd0: 2020 6f75 7420 636f 7272 656c 6174 6564    out correlated
+0005ece0: 2076 6172 6961 626c 6573 2069 6e20 6561   variables in ea
+0005ecf0: 6368 2072 6f75 6e64 2e20 496e 2074 6865  ch round. In the
+0005ed00: 2065 6e64 2c20 5355 4c4f 5620 6769 7665   end, SULOV give
+0005ed10: 7320 7573 2061 206c 6973 7420 6f66 206c  s us a list of l
+0005ed20: 6561 7374 0d0a 2020 2020 2063 6f72 7265  east..     corre
+0005ed30: 6c61 7465 6420 7661 7269 6162 6c65 7320  lated variables 
+0005ed40: 7468 6174 2068 6176 6520 7468 6520 6265  that have the be
+0005ed50: 7374 206d 7574 7561 6c20 696e 666f 726d  st mutual inform
+0005ed60: 6174 696f 6e20 7363 6f72 6520 696e 2079  ation score in y
+0005ed70: 6f75 7220 6461 7461 2073 6574 210d 0a20  our data set!.. 
+0005ed80: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+0005ed90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005eda0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005edb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005edc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005edd0: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
+0005ede0: 2020 2020 6466 203d 2063 6f70 792e 6465      df = copy.de
+0005edf0: 6570 636f 7079 2864 6629 0d0a 2020 2020  epcopy(df)..    
+0005ee00: 7072 696e 7428 2752 656d 6f76 696e 6720  print('Removing 
+0005ee10: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
+0005ee20: 6420 7661 7269 6162 6c65 7320 7573 696e  d variables usin
+0005ee30: 6720 5355 4c4f 5620 6d65 7468 6f64 2061  g SULOV method a
+0005ee40: 6d6f 6e67 2028 2564 2920 6e75 6d65 7269  mong (%d) numeri
+0005ee50: 6320 7661 7269 6162 6c65 7327 2025 6c65  c variables' %le
+0005ee60: 6e28 6e75 6d76 6172 7329 290d 0a20 2020  n(numvars))..   
+0005ee70: 2063 6f72 7265 6c61 7469 6f6e 5f64 6174   correlation_dat
+0005ee80: 6166 7261 6d65 203d 2064 665b 6e75 6d76  aframe = df[numv
+0005ee90: 6172 735d 2e63 6f72 7228 292e 6173 7479  ars].corr().asty
+0005eea0: 7065 286e 702e 666c 6f61 7431 3629 0d0a  pe(np.float16)..
+0005eeb0: 2020 2020 6120 3d20 636f 7272 656c 6174      a = correlat
+0005eec0: 696f 6e5f 6461 7461 6672 616d 652e 7661  ion_dataframe.va
+0005eed0: 6c75 6573 0d0a 2020 2020 636f 6c5f 696e  lues..    col_in
+0005eee0: 6465 7820 3d20 636f 7272 656c 6174 696f  dex = correlatio
+0005eef0: 6e5f 6461 7461 6672 616d 652e 636f 6c75  n_dataframe.colu
+0005ef00: 6d6e 732e 746f 6c69 7374 2829 0d0a 2020  mns.tolist()..  
+0005ef10: 2020 696e 6465 785f 7472 6975 7070 6572    index_triupper
+0005ef20: 203d 206c 6973 7428 7a69 7028 6e70 2e74   = list(zip(np.t
+0005ef30: 7269 755f 696e 6469 6365 735f 6672 6f6d  riu_indices_from
+0005ef40: 2861 2c6b 3d31 295b 305d 2c6e 702e 7472  (a,k=1)[0],np.tr
+0005ef50: 6975 5f69 6e64 6963 6573 5f66 726f 6d28  iu_indices_from(
+0005ef60: 612c 6b3d 3129 5b31 5d29 290d 0a20 2020  a,k=1)[1]))..   
+0005ef70: 2068 6967 685f 636f 7272 5f69 6e64 6578   high_corr_index
+0005ef80: 5f6c 6973 7420 3d20 5b78 2066 6f72 2078  _list = [x for x
+0005ef90: 2069 6e20 6e70 2e61 7267 7768 6572 6528   in np.argwhere(
+0005efa0: 6162 7328 615b 6e70 2e74 7269 755f 696e  abs(a[np.triu_in
+0005efb0: 6469 6365 7328 6c65 6e28 6129 2c20 6b20  dices(len(a), k 
+0005efc0: 3d20 3129 5d29 3e3d 636f 7272 5f6c 696d  = 1)])>=corr_lim
+0005efd0: 6974 295d 0d0a 2020 2020 6c6f 775f 636f  it)]..    low_co
+0005efe0: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
+0005eff0: 205b 7820 666f 7220 7820 696e 206e 702e   [x for x in np.
+0005f000: 6172 6777 6865 7265 2861 6273 2861 5b6e  argwhere(abs(a[n
+0005f010: 702e 7472 6975 5f69 6e64 6963 6573 286c  p.triu_indices(l
+0005f020: 656e 2861 292c 206b 203d 2031 295d 293c  en(a), k = 1)])<
+0005f030: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
+0005f040: 2020 7475 706c 655f 6c69 7374 203d 205b    tuple_list = [
+0005f050: 7920 666f 7220 7920 696e 205b 696e 6465  y for y in [inde
+0005f060: 785f 7472 6975 7070 6572 5b78 5b30 5d5d  x_triupper[x[0]]
+0005f070: 2066 6f72 2078 2069 6e20 6869 6768 5f63   for x in high_c
+0005f080: 6f72 725f 696e 6465 785f 6c69 7374 5d5d  orr_index_list]]
+0005f090: 0d0a 2020 2020 636f 7272 656c 6174 6564  ..    correlated
+0005f0a0: 5f70 6169 7220 3d20 5b28 636f 6c5f 696e  _pair = [(col_in
+0005f0b0: 6465 785b 7475 706c 655b 305d 5d2c 636f  dex[tuple[0]],co
+0005f0c0: 6c5f 696e 6465 785b 7475 706c 655b 315d  l_index[tuple[1]
+0005f0d0: 5d29 2066 6f72 2074 7570 6c65 2069 6e20  ]) for tuple in 
+0005f0e0: 7475 706c 655f 6c69 7374 5d0d 0a20 2020  tuple_list]..   
+0005f0f0: 2063 6f72 725f 7061 6972 5f64 6963 7420   corr_pair_dict 
+0005f100: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
+0005f110: 6374 696f 6e61 7279 5f6c 6973 7428 636f  ctionary_list(co
+0005f120: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
+0005f130: 0a20 2020 206b 6579 735f 696e 5f64 6963  .    keys_in_dic
+0005f140: 7420 3d20 6c69 7374 2863 6f72 725f 7061  t = list(corr_pa
+0005f150: 6972 5f64 6963 742e 6b65 7973 2829 290d  ir_dict.keys()).
+0005f160: 0a20 2020 2072 6576 6572 7365 5f63 6f72  .    reverse_cor
+0005f170: 7265 6c61 7465 645f 7061 6972 203d 205b  related_pair = [
+0005f180: 2879 2c78 2920 666f 7220 2878 2c79 2920  (y,x) for (x,y) 
+0005f190: 696e 2063 6f72 7265 6c61 7465 645f 7061  in correlated_pa
+0005f1a0: 6972 5d0d 0a20 2020 2072 6576 6572 7365  ir]..    reverse
+0005f1b0: 5f63 6f72 725f 7061 6972 5f64 6963 7420  _corr_pair_dict 
+0005f1c0: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
+0005f1d0: 6374 696f 6e61 7279 5f6c 6973 7428 7265  ctionary_list(re
+0005f1e0: 7665 7273 655f 636f 7272 656c 6174 6564  verse_correlated
+0005f1f0: 5f70 6169 7229 290d 0a20 2020 2066 6f72  _pair))..    for
+0005f200: 206b 6579 2c20 7661 6c20 696e 2072 6576   key, val in rev
+0005f210: 6572 7365 5f63 6f72 725f 7061 6972 5f64  erse_corr_pair_d
+0005f220: 6963 742e 6974 656d 7328 293a 0d0a 2020  ict.items():..  
+0005f230: 2020 2020 2020 6966 206b 6579 2069 6e20        if key in 
+0005f240: 6b65 7973 5f69 6e5f 6469 6374 3a0d 0a20  keys_in_dict:.. 
+0005f250: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0005f260: 6e28 6b65 7929 203e 2031 3a0d 0a20 2020  n(key) > 1:..   
+0005f270: 2020 2020 2020 2020 2020 2020 2063 6f72               cor
+0005f280: 725f 7061 6972 5f64 6963 745b 6b65 795d  r_pair_dict[key]
+0005f290: 202b 3d20 7661 6c0d 0a20 2020 2020 2020   += val..       
+0005f2a0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0005f2b0: 2020 2020 636f 7272 5f70 6169 725f 6469      corr_pair_di
+0005f2c0: 6374 5b6b 6579 5d20 3d20 7661 6c0d 0a20  ct[key] = val.. 
+0005f2d0: 2020 2066 6c61 745f 636f 7272 5f70 6169     flat_corr_pai
+0005f2e0: 725f 6c69 7374 203d 205b 6974 656d 2066  r_list = [item f
+0005f2f0: 6f72 2073 7562 6c69 7374 2069 6e20 636f  or sublist in co
+0005f300: 7272 656c 6174 6564 5f70 6169 7220 666f  rrelated_pair fo
+0005f310: 7220 6974 656d 2069 6e20 7375 626c 6973  r item in sublis
+0005f320: 745d 0d0a 2020 2020 2323 2323 2059 6f75  t]..    #### You
+0005f330: 2063 616e 206d 616b 6520 6974 2061 2064   can make it a d
+0005f340: 6963 7469 6f6e 6172 7920 6f72 2061 2074  ictionary or a t
+0005f350: 7570 6c65 206f 6620 6c69 7374 732e 2057  uple of lists. W
+0005f360: 6520 6861 7665 2063 686f 7365 6e20 7468  e have chosen th
+0005f370: 6520 6c61 7474 6572 2068 6572 6520 746f  e latter here to
+0005f380: 206b 6565 7020 6f72 6465 7220 696e 7461   keep order inta
+0005f390: 6374 2e0d 0a20 2020 2063 6f72 725f 7061  ct...    corr_pa
+0005f3a0: 6972 5f63 6f75 6e74 5f64 6963 7420 3d20  ir_count_dict = 
+0005f3b0: 636f 756e 745f 6672 6571 5f69 6e5f 6c69  count_freq_in_li
+0005f3c0: 7374 2866 6c61 745f 636f 7272 5f70 6169  st(flat_corr_pai
+0005f3d0: 725f 6c69 7374 290d 0a20 2020 2063 6f72  r_list)..    cor
+0005f3e0: 725f 6c69 7374 203d 205b 6b20 666f 7220  r_list = [k for 
+0005f3f0: 286b 2c76 2920 696e 2063 6f72 725f 7061  (k,v) in corr_pa
+0005f400: 6972 5f63 6f75 6e74 5f64 6963 745d 0d0a  ir_count_dict]..
+0005f410: 2020 2020 2323 2323 2323 2054 6869 7320      ###### This 
+0005f420: 6973 2066 6f72 206f 7264 6572 696e 6720  is for ordering 
+0005f430: 7468 6520 7661 7269 6162 6c65 7320 696e  the variables in
+0005f440: 2074 6865 2068 6967 6865 7374 2074 6f20   the highest to 
+0005f450: 6c6f 7765 7374 2069 6d70 6f72 7461 6e63  lowest importanc
+0005f460: 6520 746f 2074 6172 6765 7420 2323 230d  e to target ###.
+0005f470: 0a20 2020 2069 6620 6c65 6e28 636f 7272  .    if len(corr
+0005f480: 5f6c 6973 7429 203d 3d20 303a 0d0a 2020  _list) == 0:..  
+0005f490: 2020 2020 2020 6669 6e61 6c5f 6c69 7374        final_list
+0005f4a0: 203d 206c 6973 7428 636f 7272 656c 6174   = list(correlat
+0005f4b0: 696f 6e5f 6461 7461 6672 616d 6529 0d0a  ion_dataframe)..
+0005f4c0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005f4d0: 2020 204e 6f20 6e75 6d65 7269 6320 7661     No numeric va
+0005f4e0: 7273 2072 656d 6f76 6564 2073 696e 6365  rs removed since
+0005f4f0: 206e 6f6e 6520 6861 7665 2068 6967 6820   none have high 
+0005f500: 636f 7272 656c 6174 696f 6e20 7769 7468  correlation with
+0005f510: 2065 6163 6820 6f74 6865 7220 696e 2074   each other in t
+0005f520: 6869 7320 6461 7461 2e2e 2e27 290d 0a20  his data...').. 
+0005f530: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0005f540: 2020 6d61 785f 6665 6174 7320 3d20 6c65    max_feats = le
+0005f550: 6e28 636f 7272 5f6c 6973 7429 0d0a 2020  n(corr_list)..  
+0005f560: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
+0005f570: 7065 203d 3d20 2752 6567 7265 7373 696f  pe == 'Regressio
+0005f580: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
+0005f590: 2073 656c 5f66 756e 6374 696f 6e20 3d20   sel_function = 
+0005f5a0: 6d75 7475 616c 5f69 6e66 6f5f 7265 6772  mutual_info_regr
+0005f5b0: 6573 7369 6f6e 0d0a 2020 2020 2020 2020  ession..        
+0005f5c0: 2020 2020 6673 203d 2053 656c 6563 744b      fs = SelectK
+0005f5d0: 4265 7374 2873 636f 7265 5f66 756e 633d  Best(score_func=
+0005f5e0: 7365 6c5f 6675 6e63 7469 6f6e 2c20 6b3d  sel_function, k=
+0005f5f0: 6d61 785f 6665 6174 7329 0d0a 2020 2020  max_feats)..    
+0005f600: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0005f610: 2020 2020 2020 2073 656c 5f66 756e 6374         sel_funct
+0005f620: 696f 6e20 3d20 6d75 7475 616c 5f69 6e66  ion = mutual_inf
+0005f630: 6f5f 636c 6173 7369 660d 0a20 2020 2020  o_classif..     
+0005f640: 2020 2020 2020 2066 7320 3d20 5365 6c65         fs = Sele
+0005f650: 6374 4b42 6573 7428 7363 6f72 655f 6675  ctKBest(score_fu
+0005f660: 6e63 3d73 656c 5f66 756e 6374 696f 6e2c  nc=sel_function,
+0005f670: 206b 3d6d 6178 5f66 6561 7473 290d 0a20   k=max_feats).. 
+0005f680: 2020 2020 2020 2066 732e 6669 7428 6466         fs.fit(df
+0005f690: 5b63 6f72 725f 6c69 7374 5d2e 6173 7479  [corr_list].asty
+0005f6a0: 7065 286e 702e 666c 6f61 7431 3629 2c20  pe(np.float16), 
+0005f6b0: 6466 5b74 6172 6765 745d 290d 0a20 2020  df[target])..   
+0005f6c0: 2020 2020 206d 7574 7561 6c5f 696e 666f       mutual_info
+0005f6d0: 203d 2064 6963 7428 7a69 7028 636f 7272   = dict(zip(corr
+0005f6e0: 5f6c 6973 742c 6673 2e73 636f 7265 735f  _list,fs.scores_
+0005f6f0: 2929 0d0a 2020 2020 2020 2020 2323 2323  ))..        ####
+0005f700: 2054 6865 2066 6972 7374 2076 6172 6961   The first varia
+0005f710: 626c 6520 696e 206c 6973 7420 6861 7320  ble in list has 
+0005f720: 7468 6520 6869 6768 6573 7420 636f 7272  the highest corr
+0005f730: 656c 6174 696f 6e20 746f 2074 6865 2074  elation to the t
+0005f740: 6172 6765 7420 7661 7269 6162 6c65 2023  arget variable #
+0005f750: 2323 0d0a 2020 2020 2020 2020 736f 7274  ##..        sort
+0005f760: 6564 5f62 795f 6d75 7475 616c 5f69 6e66  ed_by_mutual_inf
+0005f770: 6f20 3d5b 6b65 7920 666f 7220 286b 6579  o =[key for (key
+0005f780: 2c76 616c 2920 696e 2073 6f72 7465 6428  ,val) in sorted(
+0005f790: 6d75 7475 616c 5f69 6e66 6f2e 6974 656d  mutual_info.item
+0005f7a0: 7328 292c 206b 6579 3d6c 616d 6264 6120  s(), key=lambda 
+0005f7b0: 6b76 3a20 6b76 5b31 5d2c 7265 7665 7273  kv: kv[1],revers
+0005f7c0: 653d 5472 7565 295d 0d0a 2020 2020 2020  e=True)]..      
+0005f7d0: 2020 2323 2323 2320 2020 4e6f 7720 7765    #####   Now we
+0005f7e0: 2073 656c 6563 7420 7468 6520 6669 6e61   select the fina
+0005f7f0: 6c20 6c69 7374 206f 6620 636f 7272 656c  l list of correl
+0005f800: 6174 6564 2076 6172 6961 626c 6573 2023  ated variables #
+0005f810: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0005f820: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
+0005f830: 725f 6c69 7374 203d 205b 5d0d 0a20 2020  r_list = []..   
+0005f840: 2020 2020 2023 2323 2320 7365 6c65 6374       #### select
+0005f850: 2065 6163 6820 7661 7269 6162 6c65 2062   each variable b
+0005f860: 7920 7468 6520 6869 6768 6573 7420 6d75  y the highest mu
+0005f870: 7475 616c 2069 6e66 6f20 616e 6420 7365  tual info and se
+0005f880: 6520 7768 6174 2076 6172 7320 6172 6520  e what vars are 
+0005f890: 636f 7272 656c 6174 6564 2074 6f20 6974  correlated to it
+0005f8a0: 0d0a 2020 2020 2020 2020 666f 7220 6561  ..        for ea
+0005f8b0: 6368 5f63 6f72 725f 6e61 6d65 2069 6e20  ch_corr_name in 
+0005f8c0: 736f 7274 6564 5f62 795f 6d75 7475 616c  sorted_by_mutual
+0005f8d0: 5f69 6e66 6f3a 0d0a 2020 2020 2020 2020  _info:..        
+0005f8e0: 2020 2020 2323 2320 6164 6420 7468 6520      ### add the 
+0005f8f0: 7365 6c65 6374 6564 2076 6172 2074 6f20  selected var to 
+0005f900: 7468 6520 7365 6c65 6374 6564 5f63 6f72  the selected_cor
+0005f910: 725f 6c69 7374 0d0a 2020 2020 2020 2020  r_list..        
+0005f920: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
+0005f930: 725f 6c69 7374 2e61 7070 656e 6428 6561  r_list.append(ea
+0005f940: 6368 5f63 6f72 725f 6e61 6d65 290d 0a20  ch_corr_name).. 
+0005f950: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0005f960: 6163 685f 7265 6d6f 7665 2069 6e20 636f  ach_remove in co
+0005f970: 7272 5f70 6169 725f 6469 6374 5b65 6163  rr_pair_dict[eac
+0005f980: 685f 636f 7272 5f6e 616d 655d 3a0d 0a20  h_corr_name]:.. 
+0005f990: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0005f9a0: 2323 2320 4e6f 7720 7265 6d6f 7665 2065  ### Now remove e
+0005f9b0: 6163 6820 7661 7269 6162 6c65 2074 6861  ach variable tha
+0005f9c0: 7420 6973 2068 6967 686c 7920 636f 7272  t is highly corr
+0005f9d0: 656c 6174 6564 2074 6f20 7468 6520 7365  elated to the se
+0005f9e0: 6c65 6374 6564 2076 6172 6961 626c 650d  lected variable.
+0005f9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005fa00: 2069 6620 6561 6368 5f72 656d 6f76 6520   if each_remove 
+0005fa10: 696e 2073 6f72 7465 645f 6279 5f6d 7574  in sorted_by_mut
+0005fa20: 7561 6c5f 696e 666f 3a0d 0a20 2020 2020  ual_info:..     
+0005fa30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0005fa40: 6f72 7465 645f 6279 5f6d 7574 7561 6c5f  orted_by_mutual_
+0005fa50: 696e 666f 2e72 656d 6f76 6528 6561 6368  info.remove(each
+0005fa60: 5f72 656d 6f76 6529 0d0a 2020 2020 2020  _remove)..      
+0005fa70: 2020 2323 2323 2320 4e6f 7720 7765 2063    ##### Now we c
+0005fa80: 6f6d 6269 6e65 2074 6865 2075 6e63 6f72  ombine the uncor
+0005fa90: 7265 6c61 7465 6420 6c69 7374 2074 6f20  related list to 
+0005faa0: 7468 6520 7365 6c65 6374 6564 2063 6f72  the selected cor
+0005fab0: 7265 6c61 7465 6420 6c69 7374 2061 626f  related list abo
+0005fac0: 7665 0d0a 2020 2020 2020 2020 7265 6d5f  ve..        rem_
+0005fad0: 636f 6c5f 6c69 7374 203d 206c 6566 745f  col_list = left_
+0005fae0: 7375 6274 7261 6374 286c 6973 7428 636f  subtract(list(co
+0005faf0: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
+0005fb00: 616d 6529 2c63 6f72 725f 6c69 7374 290d  ame),corr_list).
+0005fb10: 0a20 2020 2020 2020 2066 696e 616c 5f6c  .        final_l
+0005fb20: 6973 7420 3d20 7265 6d5f 636f 6c5f 6c69  ist = rem_col_li
+0005fb30: 7374 202b 2073 656c 6563 7465 645f 636f  st + selected_co
+0005fb40: 7272 5f6c 6973 740d 0a20 2020 2020 2020  rr_list..       
+0005fb50: 2072 656d 6f76 6564 5f63 6f6c 7320 3d20   removed_cols = 
+0005fb60: 6c65 6674 5f73 7562 7472 6163 7428 6e75  left_subtract(nu
+0005fb70: 6d76 6172 732c 2066 696e 616c 5f6c 6973  mvars, final_lis
+0005fb80: 7429 0d0a 2020 2020 2020 2020 6966 206c  t)..        if l
+0005fb90: 656e 2872 656d 6f76 6564 5f63 6f6c 7329  en(removed_cols)
+0005fba0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
+0005fbb0: 2020 2070 7269 6e74 2827 2020 2020 5265     print('    Re
+0005fbc0: 6d6f 7669 6e67 2028 2564 2920 6869 6768  moving (%d) high
+0005fbd0: 6c79 2063 6f72 7265 6c61 7465 6420 7661  ly correlated va
+0005fbe0: 7269 6162 6c65 733a 2720 2528 6c65 6e28  riables:' %(len(
+0005fbf0: 7265 6d6f 7665 645f 636f 6c73 2929 290d  removed_cols))).
+0005fc00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0005fc10: 6c65 6e28 7265 6d6f 7665 645f 636f 6c73  len(removed_cols
+0005fc20: 2920 3c3d 2033 303a 0d0a 2020 2020 2020  ) <= 30:..      
+0005fc30: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0005fc40: 2720 2020 2025 7327 2025 7265 6d6f 7665  '    %s' %remove
+0005fc50: 645f 636f 6c73 290d 0a20 2020 2020 2020  d_cols)..       
+0005fc60: 2020 2020 2069 6620 6c65 6e28 6669 6e61       if len(fina
+0005fc70: 6c5f 6c69 7374 2920 3c3d 2033 303a 0d0a  l_list) <= 30:..
+0005fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005fc90: 7072 696e 7428 2720 2020 2046 6f6c 6c6f  print('    Follo
+0005fca0: 7769 6e67 2028 2564 2920 7661 7273 2073  wing (%d) vars s
+0005fcb0: 656c 6563 7465 643a 2025 7327 2025 286c  elected: %s' %(l
+0005fcc0: 656e 2866 696e 616c 5f6c 6973 7429 2c66  en(final_list),f
+0005fcd0: 696e 616c 5f6c 6973 7429 290d 0a20 2020  inal_list))..   
+0005fce0: 2072 6574 7572 6e20 6669 6e61 6c5f 6c69   return final_li
+0005fcf0: 7374 0d0a 2323 2323 2323 2323 2323 2323  st..############
+0005fd00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005fd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005fd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005fd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005fd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0005fd50: 2323 230d 0a64 6566 2063 6f75 6e74 5f66  ###..def count_f
+0005fd60: 7265 715f 696e 5f6c 6973 7428 6c73 7429  req_in_list(lst)
+0005fd70: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+0005fd80: 5468 6973 2063 6f75 6e74 7320 7468 6520  This counts the 
+0005fd90: 6672 6571 7565 6e63 7920 6f66 2069 7465  frequency of ite
+0005fda0: 6d73 2069 6e20 6120 6c69 7374 2062 7574  ms in a list but
+0005fdb0: 204d 4149 4e54 4149 4e53 2074 6865 206f   MAINTAINS the o
+0005fdc0: 7264 6572 206f 6620 6170 7065 6172 616e  rder of appearan
+0005fdd0: 6365 206f 6620 6974 656d 732e 0d0a 2020  ce of items...  
+0005fde0: 2020 5468 6973 206f 7264 6572 2069 7320    This order is 
+0005fdf0: 7665 7279 2069 6d70 6f72 7461 6e74 2077  very important w
+0005fe00: 6865 6e20 796f 7520 6172 6520 646f 696e  hen you are doin
+0005fe10: 6720 6365 7274 6169 6e20 6675 6e63 7469  g certain functi
+0005fe20: 6f6e 732e 2048 656e 6365 2074 6869 7320  ons. Hence this 
+0005fe30: 6675 6e63 7469 6f6e 210d 0a20 2020 2022  function!..    "
+0005fe40: 2222 0d0a 2020 2020 7465 6d70 3d6e 702e  ""..    temp=np.
+0005fe50: 756e 6971 7565 286c 7374 290d 0a20 2020  unique(lst)..   
+0005fe60: 2072 6573 756c 7420 3d20 5b5d 0d0a 2020   result = []..  
+0005fe70: 2020 666f 7220 6920 696e 2074 656d 703a    for i in temp:
+0005fe80: 0d0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+0005fe90: 2e61 7070 656e 6428 2869 2c6c 7374 2e63  .append((i,lst.c
+0005fea0: 6f75 6e74 2869 2929 290d 0a20 2020 2072  ount(i)))..    r
+0005feb0: 6574 7572 6e20 7265 7375 6c74 0d0a 0d0a  eturn result....
+0005fec0: 6465 6620 6669 6e64 5f63 6f72 725f 7661  def find_corr_va
+0005fed0: 7273 2863 6f72 7265 6c61 7469 6f6e 5f64  rs(correlation_d
+0005fee0: 6174 6166 7261 6d65 2c63 6f72 725f 6c69  ataframe,corr_li
+0005fef0: 6d69 7420 3d20 302e 3730 293a 0d0a 2020  mit = 0.70):..  
+0005ff00: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
+0005ff10: 7265 7475 726e 7320 6120 6469 6374 696f  returns a dictio
+0005ff20: 6e61 7279 206f 6620 636f 756e 7473 206f  nary of counts o
+0005ff30: 6620 6561 6368 2076 6172 6961 626c 6520  f each variable 
+0005ff40: 616e 6420 686f 7720 6d61 6e79 2076 6172  and how many var
+0005ff50: 7320 6974 2069 7320 636f 7272 656c 6174  s it is correlat
+0005ff60: 6564 2074 6f20 696e 2074 6865 2064 6174  ed to in the dat
+0005ff70: 6166 7261 6d65 0d0a 2020 2020 2222 220d  aframe..    """.
+0005ff80: 0a20 2020 2066 6c61 7474 656e 203d 206c  .    flatten = l
+0005ff90: 616d 6264 6120 6c3a 205b 6974 656d 2066  ambda l: [item f
+0005ffa0: 6f72 2073 7562 6c69 7374 2069 6e20 6c20  or sublist in l 
+0005ffb0: 666f 7220 6974 656d 2069 6e20 7375 626c  for item in subl
+0005ffc0: 6973 745d 0d0a 2020 2020 666c 6174 7465  ist]..    flatte
+0005ffd0: 6e5f 6974 656d 7320 3d20 6c61 6d62 6461  n_items = lambda
+0005ffe0: 2064 6963 3a20 5b78 2066 6f72 2078 2069   dic: [x for x i
+0005fff0: 6e20 6469 632e 6974 656d 7328 295d 0d0a  n dic.items()]..
+00060000: 2020 2020 6120 3d20 636f 7272 656c 6174      a = correlat
+00060010: 696f 6e5f 6461 7461 6672 616d 652e 7661  ion_dataframe.va
+00060020: 6c75 6573 0d0a 2020 2020 636f 6c5f 696e  lues..    col_in
+00060030: 6465 7820 3d20 636f 7272 656c 6174 696f  dex = correlatio
+00060040: 6e5f 6461 7461 6672 616d 652e 636f 6c75  n_dataframe.colu
+00060050: 6d6e 732e 746f 6c69 7374 2829 0d0a 2020  mns.tolist()..  
+00060060: 2020 696e 6465 785f 7472 6975 7070 6572    index_triupper
+00060070: 203d 206c 6973 7428 7a69 7028 6e70 2e74   = list(zip(np.t
+00060080: 7269 755f 696e 6469 6365 735f 6672 6f6d  riu_indices_from
+00060090: 2861 2c6b 3d31 295b 305d 2c6e 702e 7472  (a,k=1)[0],np.tr
+000600a0: 6975 5f69 6e64 6963 6573 5f66 726f 6d28  iu_indices_from(
+000600b0: 612c 6b3d 3129 5b31 5d29 290d 0a20 2020  a,k=1)[1]))..   
+000600c0: 2068 6967 685f 636f 7272 5f69 6e64 6578   high_corr_index
+000600d0: 5f6c 6973 7420 3d20 5b78 2066 6f72 2078  _list = [x for x
+000600e0: 2069 6e20 6e70 2e61 7267 7768 6572 6528   in np.argwhere(
+000600f0: 6162 7328 615b 6e70 2e74 7269 755f 696e  abs(a[np.triu_in
+00060100: 6469 6365 7328 6c65 6e28 6129 2c20 6b20  dices(len(a), k 
+00060110: 3d20 3129 5d29 3e3d 636f 7272 5f6c 696d  = 1)])>=corr_lim
+00060120: 6974 295d 0d0a 2020 2020 6c6f 775f 636f  it)]..    low_co
+00060130: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
+00060140: 205b 7820 666f 7220 7820 696e 206e 702e   [x for x in np.
+00060150: 6172 6777 6865 7265 2861 6273 2861 5b6e  argwhere(abs(a[n
+00060160: 702e 7472 6975 5f69 6e64 6963 6573 286c  p.triu_indices(l
+00060170: 656e 2861 292c 206b 203d 2031 295d 293c  en(a), k = 1)])<
+00060180: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
+00060190: 2020 7475 706c 655f 6c69 7374 203d 205b    tuple_list = [
+000601a0: 7920 666f 7220 7920 696e 205b 696e 6465  y for y in [inde
+000601b0: 785f 7472 6975 7070 6572 5b78 5b30 5d5d  x_triupper[x[0]]
+000601c0: 2066 6f72 2078 2069 6e20 6869 6768 5f63   for x in high_c
+000601d0: 6f72 725f 696e 6465 785f 6c69 7374 5d5d  orr_index_list]]
+000601e0: 0d0a 2020 2020 636f 7272 656c 6174 6564  ..    correlated
+000601f0: 5f70 6169 7220 3d20 5b28 636f 6c5f 696e  _pair = [(col_in
+00060200: 6465 785b 7475 706c 655b 305d 5d2c 636f  dex[tuple[0]],co
+00060210: 6c5f 696e 6465 785b 7475 706c 655b 315d  l_index[tuple[1]
+00060220: 5d29 2066 6f72 2074 7570 6c65 2069 6e20  ]) for tuple in 
+00060230: 7475 706c 655f 6c69 7374 5d0d 0a20 2020  tuple_list]..   
+00060240: 2063 6f72 7265 6c61 7465 645f 7061 6972   correlated_pair
+00060250: 5f64 6963 7420 3d20 6469 6374 2863 6f72  _dict = dict(cor
+00060260: 7265 6c61 7465 645f 7061 6972 290d 0a20  related_pair).. 
+00060270: 2020 2066 6c61 745f 636f 7272 5f70 6169     flat_corr_pai
+00060280: 725f 6c69 7374 203d 205b 6974 656d 2066  r_list = [item f
+00060290: 6f72 2073 7562 6c69 7374 2069 6e20 636f  or sublist in co
+000602a0: 7272 656c 6174 6564 5f70 6169 7220 666f  rrelated_pair fo
+000602b0: 7220 6974 656d 2069 6e20 7375 626c 6973  r item in sublis
+000602c0: 745d 0d0a 2020 2020 2323 2323 2059 6f75  t]..    #### You
+000602d0: 2063 616e 206d 616b 6520 6974 2061 2064   can make it a d
+000602e0: 6963 7469 6f6e 6172 7920 6f72 2061 2074  ictionary or a t
+000602f0: 7570 6c65 206f 6620 6c69 7374 732e 2057  uple of lists. W
+00060300: 6520 6861 7665 2063 686f 7365 6e20 7468  e have chosen th
+00060310: 6520 6c61 7474 6572 2068 6572 6520 746f  e latter here to
+00060320: 206b 6565 7020 6f72 6465 7220 696e 7461   keep order inta
+00060330: 6374 2e0d 0a20 2020 2023 636f 7272 5f70  ct...    #corr_p
+00060340: 6169 725f 636f 756e 745f 6469 6374 203d  air_count_dict =
+00060350: 2043 6f75 6e74 6572 2866 6c61 745f 636f   Counter(flat_co
+00060360: 7272 5f70 6169 725f 6c69 7374 290d 0a20  rr_pair_list).. 
+00060370: 2020 2063 6f72 725f 7061 6972 5f63 6f75     corr_pair_cou
+00060380: 6e74 5f64 6963 7420 3d20 636f 756e 745f  nt_dict = count_
+00060390: 6672 6571 5f69 6e5f 6c69 7374 2866 6c61  freq_in_list(fla
+000603a0: 745f 636f 7272 5f70 6169 725f 6c69 7374  t_corr_pair_list
+000603b0: 290d 0a20 2020 2063 6f72 725f 6c69 7374  )..    corr_list
+000603c0: 203d 206c 6973 7428 7365 7428 666c 6174   = list(set(flat
+000603d0: 7465 6e28 666c 6174 7465 6e5f 6974 656d  ten(flatten_item
+000603e0: 7328 636f 7272 656c 6174 6564 5f70 6169  s(correlated_pai
+000603f0: 725f 6469 6374 2929 2929 0d0a 2020 2020  r_dict))))..    
+00060400: 7265 6d5f 636f 6c5f 6c69 7374 203d 206c  rem_col_list = l
+00060410: 6566 745f 7375 6274 7261 6374 286c 6973  eft_subtract(lis
+00060420: 7428 636f 7272 656c 6174 696f 6e5f 6461  t(correlation_da
+00060430: 7461 6672 616d 6529 2c6c 6973 7428 4f72  taframe),list(Or
+00060440: 6465 7265 6444 6963 742e 6672 6f6d 6b65  deredDict.fromke
+00060450: 7973 2866 6c61 745f 636f 7272 5f70 6169  ys(flat_corr_pai
+00060460: 725f 6c69 7374 2929 290d 0a20 2020 2072  r_list)))..    r
+00060470: 6574 7572 6e20 636f 7272 5f70 6169 725f  eturn corr_pair_
+00060480: 636f 756e 745f 6469 6374 2c20 7265 6d5f  count_dict, rem_
+00060490: 636f 6c5f 6c69 7374 2c20 636f 7272 5f6c  col_list, corr_l
+000604a0: 6973 742c 2063 6f72 7265 6c61 7465 645f  ist, correlated_
+000604b0: 7061 6972 5f64 6963 740d 0a23 2323 2323  pair_dict..#####
+000604c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000604d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000604e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000604f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00060500: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
+00060510: 6d20 736b 6c65 6172 6e2e 6c69 6e65 6172  m sklearn.linear
+00060520: 5f6d 6f64 656c 2069 6d70 6f72 7420 4c6f  _model import Lo
+00060530: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+00060540: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e70  ..from sklearn.p
+00060550: 7265 7072 6f63 6573 7369 6e67 2069 6d70  reprocessing imp
+00060560: 6f72 7420 5374 616e 6461 7264 5363 616c  ort StandardScal
+00060570: 6572 0d0a 6672 6f6d 2073 6b6c 6561 726e  er..from sklearn
+00060580: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
+00060590: 706f 7274 204c 6173 736f 0d0a 6672 6f6d  port Lasso..from
+000605a0: 2073 6b6c 6561 726e 2e70 7265 7072 6f63   sklearn.preproc
+000605b0: 6573 7369 6e67 2069 6d70 6f72 7420 506f  essing import Po
+000605c0: 6c79 6e6f 6d69 616c 4665 6174 7572 6573  lynomialFeatures
+000605d0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+000605e0: 6f64 656c 5f73 656c 6563 7469 6f6e 2069  odel_selection i
+000605f0: 6d70 6f72 7420 4772 6964 5365 6172 6368  mport GridSearch
+00060600: 4356 0d0a 696d 706f 7274 2073 6b6c 6561  CV..import sklea
+00060610: 726e 0d0a 6672 6f6d 2064 6973 7475 7469  rn..from distuti
+00060620: 6c73 2e76 6572 7369 6f6e 2069 6d70 6f72  ls.version impor
+00060630: 7420 4c6f 6f73 6556 6572 7369 6f6e 0d0a  t LooseVersion..
+00060640: 0d0a 6465 6620 6164 645f 706f 6c79 5f76  ..def add_poly_v
+00060650: 6172 735f 7365 6c65 6374 2864 6174 612c  ars_select(data,
+00060660: 6e75 6d76 6172 732c 7461 7267 6574 7661  numvars,targetva
+00060670: 722c 6d6f 6465 6c74 7970 652c 706f 6c79  r,modeltype,poly
+00060680: 5f64 6567 7265 653d 322c 4164 645f 506f  _degree=2,Add_Po
+00060690: 6c79 3d32 2c6d 643d 2727 2c0d 0a20 2020  ly=2,md='',..   
+000606a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000606b0: 2020 2020 2020 2020 2063 6f72 725f 6c69           corr_li
+000606c0: 6d69 743d 302e 3730 2c73 6361 6c69 6e67  mit=0.70,scaling
+000606d0: 3d54 7275 652c 2066 6974 5f66 6c61 673d  =True, fit_flag=
+000606e0: 4661 6c73 652c 2076 6572 626f 7365 3d30  False, verbose=0
+000606f0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+00060700: 2023 2323 2320 5468 6973 2061 6464 7320   #### This adds 
+00060710: 506f 6c79 6e6f 6d69 616c 2061 6e64 2049  Polynomial and I
+00060720: 6e74 6572 6163 7469 6f6e 2056 6172 6961  nteraction Varia
+00060730: 626c 6573 206f 6620 616e 7920 5369 7a65  bles of any Size
+00060740: 2074 6f20 6120 6461 7461 2073 6574 2061   to a data set a
+00060750: 6e64 2072 6574 7572 6e73 2074 6865 2062  nd returns the b
+00060760: 6573 7420 7661 7273 0d0a 2020 2020 616d  est vars..    am
+00060770: 6f6e 6720 7468 6f73 6520 706f 6c79 2061  ong those poly a
+00060780: 6e64 2069 6e74 6572 6163 7469 6f6e 2076  nd interaction v
+00060790: 6172 6961 626c 6573 2e20 4e6f 7469 6365  ariables. Notice
+000607a0: 2079 6f75 2077 696c 6c20 6765 7420 6120   you will get a 
+000607b0: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
+000607c0: 7320 6173 2077 656c 6c20 6173 2074 6865  s as well as the
+000607d0: 206d 6f64 6966 6965 640d 0a20 2020 2064   modified..    d
+000607e0: 6174 6120 7365 7420 7769 7468 2074 6865  ata set with the
+000607f0: 206f 6c64 2061 6e64 206e 6577 2028 6164   old and new (ad
+00060800: 6465 6429 2076 6172 6961 626c 6573 2e20  ded) variables. 
+00060810: 5665 7279 2043 6f6e 7665 6e69 656e 7420  Very Convenient 
+00060820: 7768 656e 2079 6f75 2077 616e 7420 746f  when you want to
+00060830: 2064 6f20 7175 6963 6b20 7465 7374 696e   do quick testin
+00060840: 672e 0d0a 2020 2020 5468 6572 6520 6172  g...    There ar
+00060850: 6520 3320 7365 7474 696e 6773 2066 6f72  e 3 settings for
+00060860: 2041 6464 5f50 6f6c 7920 666c 6167 3a20   Add_Poly flag: 
+00060870: 3020 3d3e 204e 6f20 706f 6c79 206f 7220  0 => No poly or 
+00060880: 696e 7478 6e20 7661 7269 6162 6c65 7320  intxn variables 
+00060890: 6164 6465 642e 2031 3d3e 204f 6e6c 7920  added. 1=> Only 
+000608a0: 696e 7478 6e20 7661 7273 0d0a 2020 2020  intxn vars..    
+000608b0: 6164 6465 642e 2032 3d3e 206f 6e6c 7920  added. 2=> only 
+000608c0: 706f 6c79 6e6f 6d69 616c 2064 6567 7265  polynomial degre
+000608d0: 6520 2873 7175 6172 6564 2920 7661 7273  e (squared) vars
+000608e0: 2061 6464 6564 2e20 333d 3e20 626f 7468   added. 3=> both
+000608f0: 2073 7175 6172 6564 2061 6e64 2069 6e74   squared and int
+00060900: 786e 2076 6172 7320 6164 6465 642e 0d0a  xn vars added...
+00060910: 2020 2020 4966 2046 6974 5f46 6c61 673d      If Fit_Flag=
+00060920: 5472 7565 2c20 7468 656e 2069 7420 6973  True, then it is
+00060930: 2061 7373 756d 6564 2074 6861 7420 6974   assumed that it
+00060940: 2069 7320 5472 6169 6e69 6e67 2064 6174   is Training dat
+00060950: 6120 616e 6420 6865 6e63 6520 7661 7269  a and hence vari
+00060960: 6162 6c65 7320 6172 6520 7365 6c65 6374  ables are select
+00060970: 6564 0d0a 2020 2020 4966 2046 6974 5f46  ed..    If Fit_F
+00060980: 6c61 673d 4661 6c73 652c 2074 6865 6e20  lag=False, then 
+00060990: 6974 2069 7320 6173 7375 6d65 6420 6974  it is assumed it
+000609a0: 2069 7320 5465 7374 2064 6174 6120 616e   is Test data an
+000609b0: 6420 6e6f 2076 6172 6961 626c 6573 2061  d no variables a
+000609c0: 7265 2063 686f 7365 6e20 6275 7420 7765  re chosen but we
+000609d0: 206b 6565 7020 7472 6169 6e69 6e67 206f   keep training o
+000609e0: 6e65 732e 0d0a 2020 2020 2222 220d 0a20  nes...    """.. 
+000609f0: 2020 2064 6174 6120 3d20 636f 7079 2e64     data = copy.d
+00060a00: 6565 7063 6f70 7928 6461 7461 290d 0a20  eepcopy(data).. 
+00060a10: 2020 206e 756d 7661 7273 203d 2063 6f70     numvars = cop
+00060a20: 792e 6465 6570 636f 7079 286e 756d 7661  y.deepcopy(numva
+00060a30: 7273 290d 0a20 2020 2074 6f6c 6572 616e  rs)..    toleran
+00060a40: 6365 203d 2030 2e30 310d 0a20 2020 206f  ce = 0.01..    o
+00060a50: 7269 675f 6461 7461 5f69 6e64 6578 203d  rig_data_index =
+00060a60: 2064 6174 612e 696e 6465 780d 0a20 2020   data.index..   
+00060a70: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
+00060a80: 2027 5265 6772 6573 7369 6f6e 273a 0d0a   'Regression':..
+00060a90: 2020 2020 2020 2020 6c6d 203d 204c 6173          lm = Las
+00060aa0: 736f 2861 6c70 6861 3d30 2e30 3031 2c20  so(alpha=0.001, 
+00060ab0: 6d61 785f 6974 6572 3d32 3030 302c 0d0a  max_iter=2000,..
+00060ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060ad0: 2066 6974 5f69 6e74 6572 6365 7074 3d54   fit_intercept=T
+00060ae0: 7275 6529 0d0a 2020 2020 656c 7365 3a0d  rue)..    else:.
+00060af0: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
+00060b00: 6c74 7970 6520 3d3d 2027 4269 6e61 7279  ltype == 'Binary
+00060b10: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+00060b20: 3a0d 0a20 2020 2020 2020 2020 2020 206c  :..            l
+00060b30: 6d20 3d20 4c6f 6769 7374 6963 5265 6772  m = LogisticRegr
+00060b40: 6573 7369 6f6e 2843 3d30 2e30 312c 6669  ession(C=0.01,fi
+00060b50: 745f 696e 7465 7263 6570 743d 5472 7565  t_intercept=True
+00060b60: 2c74 6f6c 3d74 6f6c 6572 616e 6365 2c0d  ,tol=tolerance,.
+00060b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00060b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060b90: 206d 6178 5f69 7465 723d 3230 3030 2c73   max_iter=2000,s
+00060ba0: 6f6c 7665 723d 276c 6962 6c69 6e65 6172  olver='liblinear
+00060bb0: 272c 6e5f 6a6f 6273 3d2d 312c 0d0a 2020  ',n_jobs=-1,..  
+00060bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060bd0: 2020 2020 2020 2020 2020 2020 7065 6e61              pena
+00060be0: 6c74 793d 276c 3227 2c64 7561 6c3d 4661  lty='l2',dual=Fa
+00060bf0: 6c73 652c 2072 616e 646f 6d5f 7374 6174  lse, random_stat
+00060c00: 653d 3029 0d0a 2020 2020 2020 2020 656c  e=0)..        el
+00060c10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00060c20: 206c 6d20 3d20 4c6f 6769 7374 6963 5265   lm = LogisticRe
+00060c30: 6772 6573 7369 6f6e 286d 756c 7469 5f63  gression(multi_c
+00060c40: 6c61 7373 3d27 6f76 7227 2c20 6d61 785f  lass='ovr', max_
+00060c50: 6974 6572 3d31 3030 3030 2920 2323 206c  iter=10000) ## l
+00060c60: 6f67 6973 7469 6320 7365 656d 7320 6265  ogistic seems be
+00060c70: 7374 2061 6d6f 6e67 2061 6c6c 0d0a 2020  st among all..  
+00060c80: 2020 7072 6564 6963 746f 7273 203d 2063    predictors = c
+00060c90: 6f70 792e 6465 6570 636f 7079 286e 756d  opy.deepcopy(num
+00060ca0: 7661 7273 290d 0a20 2020 2023 2323 2320  vars)..    #### 
+00060cb0: 6e75 6d62 6572 206f 6620 6f72 6967 696e  number of origin
+00060cc0: 616c 2066 6561 7475 7265 7320 696e 2064  al features in d
+00060cd0: 6174 6120 7365 7420 2323 2323 0d0a 2020  ata set ####..  
+00060ce0: 2020 6e5f 6f72 6967 5f66 6561 7475 7265    n_orig_feature
+00060cf0: 7320 3d20 6c65 6e28 7072 6564 6963 746f  s = len(predicto
+00060d00: 7273 290d 0a20 2020 2073 656c 6563 7465  rs)..    selecte
+00060d10: 6420 3d20 5b5d 0d0a 2020 2020 585f 6461  d = []..    X_da
+00060d20: 7461 203d 2064 6174 615b 7072 6564 6963  ta = data[predic
+00060d30: 746f 7273 5d0d 0a20 2020 2023 2323 2323  tors]..    #####
+00060d40: 2323 2020 496e 6974 6961 6c20 4d6f 6465  ##  Initial Mode
+00060d50: 6c20 7769 7468 2061 6c6c 2069 6e70 7574  l with all input
+00060d60: 2076 6172 6961 626c 6573 2023 2323 2323   variables #####
+00060d70: 230d 0a20 2020 2069 6620 7363 616c 696e  #..    if scalin
+00060d80: 6720 3d3d 2027 5374 616e 6461 7264 273a  g == 'Standard':
+00060d90: 0d0a 2020 2020 2020 2020 5853 203d 2053  ..        XS = S
+00060da0: 7461 6e64 6172 6453 6361 6c65 7228 292e  tandardScaler().
+00060db0: 6669 745f 7472 616e 7366 6f72 6d28 585f  fit_transform(X_
+00060dc0: 6461 7461 290d 0a20 2020 2065 6c69 6620  data)..    elif 
+00060dd0: 7363 616c 696e 6720 3d3d 2027 4d69 6e4d  scaling == 'MinM
+00060de0: 6178 273a 0d0a 2020 2020 2020 2020 5853  ax':..        XS
+00060df0: 203d 204d 696e 4d61 7853 6361 6c65 7228   = MinMaxScaler(
+00060e00: 292e 6669 745f 7472 616e 7366 6f72 6d28  ).fit_transform(
+00060e10: 585f 6461 7461 290d 0a20 2020 2023 2323  X_data)..    ###
+00060e20: 2020 6f72 2079 6f75 2063 616e 2075 7365    or you can use
+00060e30: 2043 656e 7465 7269 6e67 2077 6869 6368   Centering which
+00060e40: 2073 696d 706c 7920 7375 6274 7261 6374   simply subtract
+00060e50: 7320 7468 6520 4d65 616e 3a0d 0a20 2020  s the Mean:..   
+00060e60: 2065 6c69 6620 7363 616c 696e 6720 3d3d   elif scaling ==
+00060e70: 2027 4365 6e74 6572 696e 6727 3a0d 0a20   'Centering':.. 
+00060e80: 2020 2020 2020 2058 5320 3d20 2858 5f64         XS = (X_d
+00060e90: 6174 612d 585f 6461 7461 2e6d 6561 6e28  ata-X_data.mean(
+00060ea0: 2929 0d0a 2020 2020 656c 7365 3a0d 0a20  ))..    else:.. 
+00060eb0: 2020 2020 2020 2058 5320 3d20 636f 7079         XS = copy
+00060ec0: 2e64 6565 7063 6f70 7928 585f 6461 7461  .deepcopy(X_data
+00060ed0: 290d 0a20 2020 2023 5853 2e63 6f6c 756d  )..    #XS.colum
+00060ee0: 6e73 3d70 7265 6469 6374 6f72 730d 0a20  ns=predictors.. 
+00060ef0: 2020 2058 203d 2063 6f70 792e 6465 6570     X = copy.deep
+00060f00: 636f 7079 2858 5329 0d0a 2020 2020 2323  copy(XS)..    ##
+00060f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00060f20: 2046 6974 2074 6865 206d 6f64 656c 2061   Fit the model a
+00060f30: 6674 6572 2073 6361 6c69 6e67 2064 6174  fter scaling dat
+00060f40: 6120 2323 2323 2323 2323 2323 2323 2323  a ##############
+00060f50: 230d 0a20 2020 2069 6620 6669 745f 666c  #..    if fit_fl
+00060f60: 6167 3a0d 0a20 2020 2020 2020 2059 203d  ag:..        Y =
+00060f70: 2064 6174 615b 7461 7267 6574 7661 725d   data[targetvar]
+00060f80: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00060f90: 2742 7569 6c64 696e 6720 496e 6974 616c  'Building Inital
+00060fa0: 204d 6f64 656c 2077 6974 6820 6769 7665   Model with give
+00060fb0: 6e20 7661 7269 6162 6c65 732e 2e2e 2729  n variables...')
+00060fc0: 0d0a 2020 2020 2020 2020 7072 696e 745f  ..        print_
+00060fd0: 6d6f 6465 6c5f 6d65 7472 6963 7328 6d6f  model_metrics(mo
+00060fe0: 6465 6c74 7970 652c 6c6d 2c58 2c59 2c46  deltype,lm,X,Y,F
+00060ff0: 616c 7365 290d 0a20 2020 2023 2323 2323  alse)..    #####
+00061000: 2323 2320 4865 7265 2069 7320 7768 6572  ### Here is wher
+00061010: 6520 7468 6520 496e 7465 7261 6374 696f  e the Interactio
+00061020: 6e20 7661 7269 6162 6c65 2073 656c 6563  n variable selec
+00061030: 7469 6f6e 2062 6567 696e 7320 2323 2323  tion begins ####
+00061040: 2323 2323 2323 2323 0d0a 2020 2020 2370  ########..    #p
+00061050: 7269 6e74 2827 4164 6469 6e67 2050 6f6c  rint('Adding Pol
+00061060: 796e 6f6d 6961 6c20 2573 2d64 6567 7265  ynomial %s-degre
+00061070: 6520 616e 6420 496e 7465 7261 6374 696f  e and Interactio
+00061080: 6e20 7661 7269 6162 6c65 732e 2e2e 2720  n variables...' 
+00061090: 2570 6f6c 795f 6465 6772 6565 290d 0a20  %poly_degree).. 
+000610a0: 2020 2069 6620 4164 645f 506f 6c79 203d     if Add_Poly =
+000610b0: 3d20 313a 0d0a 2020 2020 2020 2020 2323  = 1:..        ##
+000610c0: 2320 4966 2069 7420 6973 2031 2c20 6164  # If it is 1, ad
+000610d0: 6420 6f6e 6c79 2049 6e74 6572 6163 7469  d only Interacti
+000610e0: 6f6e 2076 6172 6961 626c 6573 2e0d 0a20  on variables... 
+000610f0: 2020 2020 2020 2070 6f6c 7920 3d20 506f         poly = Po
+00061100: 6c79 6e6f 6d69 616c 4665 6174 7572 6573  lynomialFeatures
+00061110: 2864 6567 7265 653d 706f 6c79 5f64 6567  (degree=poly_deg
+00061120: 7265 652c 2069 6e63 6c75 6465 5f62 6961  ree, include_bia
+00061130: 7320 3d20 4661 6c73 652c 2069 6e74 6572  s = False, inter
+00061140: 6163 7469 6f6e 5f6f 6e6c 793d 5472 7565  action_only=True
+00061150: 290d 0a20 2020 2065 6c69 6620 4164 645f  )..    elif Add_
+00061160: 506f 6c79 203d 3d20 323a 0d0a 2020 2020  Poly == 2:..    
+00061170: 2020 2020 2323 2323 2049 6620 6974 2069      #### If it i
+00061180: 7320 3220 6f72 2033 2061 6464 2062 6f74  s 2 or 3 add bot
+00061190: 6820 5371 7561 7265 6420 616e 6420 496e  h Squared and In
+000611a0: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
+000611b0: 6c65 732e 2057 6520 7769 6c6c 2072 656d  les. We will rem
+000611c0: 6f76 6520 696e 7465 7261 6374 696f 6e0d  ove interaction.
+000611d0: 0a20 2020 2020 2020 2023 2323 2020 2020  .        ###    
+000611e0: 2020 2076 6172 6961 626c 6573 206c 6174     variables lat
+000611f0: 6572 2069 6e20 7468 6973 2070 726f 6772  er in this progr
+00061200: 616d 2e20 466f 7220 6e6f 7720 696e 636c  am. For now incl
+00061210: 7564 6520 626f 7468 210d 0a20 2020 2020  ude both!..     
+00061220: 2020 2070 6f6c 7920 3d20 506f 6c79 6e6f     poly = Polyno
+00061230: 6d69 616c 4665 6174 7572 6573 2864 6567  mialFeatures(deg
+00061240: 7265 653d 706f 6c79 5f64 6567 7265 652c  ree=poly_degree,
+00061250: 2069 6e63 6c75 6465 5f62 6961 7320 3d20   include_bias = 
+00061260: 4661 6c73 652c 2069 6e74 6572 6163 7469  False, interacti
+00061270: 6f6e 5f6f 6e6c 793d 4661 6c73 6529 0d0a  on_only=False)..
+00061280: 2020 2020 656c 6966 2041 6464 5f50 6f6c      elif Add_Pol
+00061290: 7920 3d3d 2033 3a0d 0a20 2020 2020 2020  y == 3:..       
+000612a0: 2023 2323 2320 4966 2069 7420 6973 2032   #### If it is 2
+000612b0: 206f 7220 3320 6164 6420 626f 7468 2053   or 3 add both S
+000612c0: 7175 6172 6564 2061 6e64 2049 6e74 6572  quared and Inter
+000612d0: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
+000612e0: 2e20 5765 2077 696c 6c20 7265 6d6f 7665  . We will remove
+000612f0: 2069 6e74 6572 6163 7469 6f6e 0d0a 2020   interaction..  
+00061300: 2020 2020 2020 2323 2320 2020 2020 2020        ###       
+00061310: 7661 7269 6162 6c65 7320 6c61 7465 7220  variables later 
+00061320: 696e 2074 6869 7320 7072 6f67 7261 6d2e  in this program.
+00061330: 2046 6f72 206e 6f77 2069 6e63 6c75 6465   For now include
+00061340: 2062 6f74 6821 0d0a 2020 2020 2020 2020   both!..        
+00061350: 706f 6c79 203d 2050 6f6c 796e 6f6d 6961  poly = Polynomia
+00061360: 6c46 6561 7475 7265 7328 6465 6772 6565  lFeatures(degree
+00061370: 3d70 6f6c 795f 6465 6772 6565 2c20 696e  =poly_degree, in
+00061380: 636c 7564 655f 6269 6173 203d 2046 616c  clude_bias = Fal
+00061390: 7365 2c20 696e 7465 7261 6374 696f 6e5f  se, interaction_
+000613a0: 6f6e 6c79 3d46 616c 7365 290d 0a20 2020  only=False)..   
+000613b0: 2069 6620 6669 745f 666c 6167 3a0d 0a20   if fit_flag:.. 
+000613c0: 2020 2020 2020 206d 6420 3d20 706f 6c79         md = poly
+000613d0: 2e66 6974 2858 2920 2323 2323 2054 6869  .fit(X) #### Thi
+000613e0: 7320 6465 6669 6e65 7320 7468 6520 506f  s defines the Po
+000613f0: 6c79 6e6f 6d69 616c 2066 6561 7475 7265  lynomial feature
+00061400: 2065 7874 7261 6374 696f 6e0d 0a20 2020   extraction..   
+00061410: 2074 7279 3a0d 0a20 2020 2020 2020 2058   try:..        X
+00061420: 5020 3d20 6d64 2e74 7261 6e73 666f 726d  P = md.transform
+00061430: 2858 2920 2323 2323 2054 6869 7320 7472  (X) #### This tr
+00061440: 616e 7366 6f72 6d73 2058 2069 6e74 6f20  ansforms X into 
+00061450: 6120 506f 6c79 6e6f 6d69 616c 204f 7264  a Polynomial Ord
+00061460: 6572 0d0a 2020 2020 6578 6365 7074 204d  er..    except M
+00061470: 656d 6f72 7945 7272 6f72 3a0d 0a20 2020  emoryError:..   
+00061480: 2020 2020 2072 6574 7572 6e20 7072 6564       return pred
+00061490: 6963 746f 7273 2c20 2727 2c20 582c 206d  ictors, '', X, m
+000614a0: 642c 205b 5d2c 2064 6963 7428 290d 0a20  d, [], dict().. 
+000614b0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+000614c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000614d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000614e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000614f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061500: 2323 2323 0d0a 2020 2020 2323 2323 2320  ####..    ##### 
+00061510: 2020 434f 4e56 4552 5420 582d 5641 5249    CONVERT X-VARI
+00061520: 4142 4c45 5320 4652 4f4d 2050 4f4c 5920  ABLES FROM POLY 
+00061530: 414e 4420 494e 5445 5241 4354 494f 4e20  AND INTERACTION 
+00061540: 494e 544f 204f 5249 4749 4e41 4c20 5641  INTO ORIGINAL VA
+00061550: 5249 4142 4c45 5320 2323 230d 0a20 2020  RIABLES ###..   
+00061560: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00061570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000615a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000615b0: 2323 0d0a 2020 2020 6966 204c 6f6f 7365  ##..    if Loose
+000615c0: 5665 7273 696f 6e28 736b 6c65 6172 6e2e  Version(sklearn.
+000615d0: 5f5f 7665 7273 696f 6e5f 5f29 203c 3d20  __version__) <= 
+000615e0: 4c6f 6f73 6556 6572 7369 6f6e 2827 302e  LooseVersion('0.
+000615f0: 3234 2e32 2729 3a0d 0a20 2020 2020 2020  24.2'):..       
+00061600: 2023 2050 6572 666f 726d 2061 6374 696f   # Perform actio
+00061610: 6e20 666f 7220 7363 696b 6974 2d6c 6561  n for scikit-lea
+00061620: 726e 2076 6572 7369 6f6e 2062 656c 6f77  rn version below
+00061630: 2030 2e32 342e 320d 0a20 2020 2020 2020   0.24.2..       
+00061640: 2023 2041 6464 2079 6f75 7220 636f 6465   # Add your code
+00061650: 2068 6572 6520 666f 7220 7363 696b 6974   here for scikit
+00061660: 2d6c 6561 726e 2076 6572 7369 6f6e 2062  -learn version b
+00061670: 656c 6f77 2030 2e32 342e 320d 0a20 2020  elow 0.24.2..   
+00061680: 2020 2020 2078 6e61 6d65 7320 3d20 6d64       xnames = md
+00061690: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
+000616a0: 6573 2829 0d0a 2020 2020 656c 7365 3a0d  es()..    else:.
+000616b0: 0a20 2020 2020 2020 2023 2050 6572 666f  .        # Perfo
+000616c0: 726d 2061 6374 696f 6e20 666f 7220 7363  rm action for sc
+000616d0: 696b 6974 2d6c 6561 726e 2076 6572 7369  ikit-learn versi
+000616e0: 6f6e 2030 2e32 342e 3220 616e 6420 6162  on 0.24.2 and ab
+000616f0: 6f76 650d 0a20 2020 2020 2020 2023 2041  ove..        # A
+00061700: 6464 2079 6f75 7220 636f 6465 2068 6572  dd your code her
+00061710: 6520 666f 7220 7363 696b 6974 2d6c 6561  e for scikit-lea
+00061720: 726e 2076 6572 7369 6f6e 2030 2e32 342e  rn version 0.24.
+00061730: 3220 616e 6420 6162 6f76 650d 0a20 2020  2 and above..   
+00061740: 2020 2020 2078 6e61 6d65 7320 3d20 6d64       xnames = md
+00061750: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
+00061760: 6573 5f6f 7574 2829 2e74 6f6c 6973 7428  es_out().tolist(
+00061770: 2920 2323 2320 786e 616d 6573 2063 6f6e  ) ### xnames con
+00061780: 7461 696e 7320 616c 6c20 782d 6f6e 6c79  tains all x-only
+00061790: 2c20 506f 6c79 2061 6e64 2049 6e74 786e  , Poly and Intxn
+000617a0: 2076 6172 6961 626c 6573 2069 6e20 782d   variables in x-
+000617b0: 666f 726d 6174 0d0a 2020 2020 2020 2020  format..        
+000617c0: 0d0a 2020 2020 6966 206c 656e 2878 6e61  ..    if len(xna
+000617d0: 6d65 7329 203e 2033 3030 3a0d 0a20 2020  mes) > 300:..   
+000617e0: 2020 2020 206d 6178 5f69 7465 7220 3d20       max_iter = 
+000617f0: 3530 3030 0d0a 2020 2020 656c 7365 3a0d  5000..    else:.
+00061800: 0a20 2020 2020 2020 206d 6178 5f69 7465  .        max_ite
+00061810: 7220 3d20 3230 3030 0d0a 2020 2020 2323  r = 2000..    ##
+00061820: 2323 2323 2042 5549 4c44 494e 4720 434f  #### BUILDING CO
+00061830: 4d50 4152 4953 4f4e 204d 4f44 454c 2057  MPARISON MODEL W
+00061840: 4954 4820 494e 5445 5241 4354 494f 4e20  ITH INTERACTION 
+00061850: 5641 5249 4142 4c45 5320 2323 2323 2323  VARIABLES ######
+00061860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061870: 2323 0d0a 2020 2020 7374 6172 745f 7469  ##..    start_ti
+00061880: 6d65 203d 2074 696d 652e 7469 6d65 2829  me = time.time()
+00061890: 0d0a 2020 2020 6966 206d 6f64 656c 7479  ..    if modelty
+000618a0: 7065 203d 3d20 2752 6567 7265 7373 696f  pe == 'Regressio
+000618b0: 6e27 3a0d 0a20 2020 2020 2020 206c 6d20  n':..        lm 
+000618c0: 3d20 4c61 7373 6f28 616c 7068 613d 302e  = Lasso(alpha=0.
+000618d0: 3030 312c 206d 6178 5f69 7465 723d 6d61  001, max_iter=ma
+000618e0: 785f 6974 6572 2c0d 0a20 2020 2020 2020  x_iter,..       
+000618f0: 2020 2020 2020 2020 2020 6669 745f 696e            fit_in
+00061900: 7465 7263 6570 743d 5472 7565 290d 0a20  tercept=True).. 
+00061910: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00061920: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+00061930: 3d20 2742 696e 6172 795f 436c 6173 7369  = 'Binary_Classi
+00061940: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
+00061950: 2020 2020 2020 2020 6c6d 203d 204c 6f67          lm = Log
+00061960: 6973 7469 6352 6567 7265 7373 696f 6e28  isticRegression(
+00061970: 433d 302e 3031 2c66 6974 5f69 6e74 6572  C=0.01,fit_inter
+00061980: 6365 7074 3d54 7275 652c 2074 6f6c 3d74  cept=True, tol=t
+00061990: 6f6c 6572 616e 6365 2c0d 0a20 2020 2020  olerance,..     
+000619a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000619b0: 2020 2020 2020 206d 6178 5f69 7465 723d         max_iter=
+000619c0: 6d61 785f 6974 6572 2c73 6f6c 7665 723d  max_iter,solver=
+000619d0: 276c 6962 6c69 6e65 6172 272c 6e5f 6a6f  'liblinear',n_jo
+000619e0: 6273 3d2d 312c 0d0a 2020 2020 2020 2020  bs=-1,..        
+000619f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00061a00: 2020 7065 6e61 6c74 793d 276c 3227 2c64    penalty='l2',d
+00061a10: 7561 6c3d 4661 6c73 652c 2072 616e 646f  ual=False, rando
+00061a20: 6d5f 7374 6174 653d 3029 0d0a 2020 2020  m_state=0)..    
+00061a30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00061a40: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
+00061a50: 7374 6963 5265 6772 6573 7369 6f6e 286d  sticRegression(m
+00061a60: 756c 7469 5f63 6c61 7373 3d27 6f76 7227  ulti_class='ovr'
+00061a70: 2c20 6d61 785f 6974 6572 3d31 3030 3030  , max_iter=10000
+00061a80: 2920 2323 206c 6f67 6973 7469 6320 7365  ) ## logistic se
+00061a90: 656d 7320 6265 7374 2061 6d6f 6e67 2061  ems best among a
+00061aa0: 6c6c 0d0a 2020 2020 2323 2323 2323 2323  ll..    ########
+00061ab0: 2323 2320 4865 7265 2073 7461 7274 7320  ### Here starts 
+00061ac0: 7468 6520 636f 6e76 6572 7369 6f6e 206f  the conversion o
+00061ad0: 6620 5820 7661 7269 6162 6c65 7320 696e  f X variables in
+00061ae0: 746f 2054 6578 7420 6665 6174 7572 6520  to Text feature 
+00061af0: 7661 7269 6162 6c65 206e 616d 6573 2023  variable names #
+00061b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00061b10: 2323 2323 0d0a 2020 2020 5850 3120 3d20  ####..    XP1 = 
+00061b20: 7064 2e44 6174 6146 7261 6d65 2858 502c  pd.DataFrame(XP,
+00061b30: 696e 6465 783d 6f72 6967 5f64 6174 615f  index=orig_data_
+00061b40: 696e 6465 782c 2063 6f6c 756d 6e73 3d78  index, columns=x
+00061b50: 6e61 6d65 7329 2023 2320 5850 3120 6861  names) ## XP1 ha
+00061b60: 7320 616c 6c20 7468 6520 5876 6172 733a  s all the Xvars:
+00061b70: 696e 636c 206f 7269 672b 706f 6c79 2b69  incl orig+poly+i
+00061b80: 6e74 786e 2076 6172 730d 0a20 2020 2078  ntxn vars..    x
+00061b90: 5f76 6172 7320 3d20 786e 616d 6573 5b3a  _vars = xnames[:
+00061ba0: 6e5f 6f72 6967 5f66 6561 7475 7265 735d  n_orig_features]
+00061bb0: 2020 2323 2320 785f 7661 7273 2063 6f6e    ### x_vars con
+00061bc0: 7461 696e 2078 5f76 6172 6961 626c 6573  tain x_variables
+00061bd0: 2073 7563 6820 6173 2027 7831 270d 0a20   such as 'x1'.. 
+00061be0: 2020 2023 2323 2320 4665 6174 7572 655f     #### Feature_
+00061bf0: 7876 6172 5f64 6963 7420 7769 6c6c 206d  xvar_dict will m
+00061c00: 6170 2074 6865 2058 5f76 6172 732c 2053  ap the X_vars, S
+00061c10: 7175 6172 6564 5f76 6172 7320 616e 6420  quared_vars and 
+00061c20: 496e 7478 6e5f 7661 7273 2062 6163 6b20  Intxn_vars back 
+00061c30: 746f 2020 5465 7874 2076 6172 7320 696e  to  Text vars in
+00061c40: 206f 6e65 2076 6172 6961 626c 650d 0a20   one variable.. 
+00061c50: 2020 2066 6561 7475 7265 5f78 7661 725f     feature_xvar_
+00061c60: 6469 6374 203d 2064 6963 7428 7a69 7028  dict = dict(zip(
+00061c70: 785f 7661 7273 2c70 7265 6469 6374 6f72  x_vars,predictor
+00061c80: 7329 2920 2323 230d 0a20 2020 2069 6620  s)) ###..    if 
+00061c90: 6669 745f 666c 6167 3a0d 0a20 2020 2020  fit_flag:..     
+00061ca0: 2020 2023 2323 2320 4966 2074 6865 7265     #### If there
+00061cb0: 2069 7320 6669 7474 696e 6720 746f 2062   is fitting to b
+00061cc0: 6520 646f 6e65 2c20 7468 656e 2079 6f75  e done, then you
+00061cd0: 206d 7573 7420 646f 2074 6869 7320 2323   must do this ##
+00061ce0: 230d 0a20 2020 2020 2020 2069 6620 4164  #..        if Ad
+00061cf0: 645f 506f 6c79 203d 3d20 313a 2023 2323  d_Poly == 1: ###
+00061d00: 2320 5468 6973 2061 6464 7320 6f6e 6c79  # This adds only
+00061d10: 2049 6e74 6572 6163 7469 6f6e 2076 6172   Interaction var
+00061d20: 6961 626c 6573 203d 3e20 6e6f 2050 6f6c  iables => no Pol
+00061d30: 796e 6f6d 6961 6c73 210d 0a20 2020 2020  ynomials!..     
+00061d40: 2020 2020 2020 2073 715f 7661 7273 203d         sq_vars =
+00061d50: 205b 5d20 2020 2023 2323 2073 715f 7661   []    ### sq_va
+00061d60: 7273 2063 6f6e 7461 696e 206f 6e6c 7920  rs contain only 
+00061d70: 782d 7371 7561 7265 6420 7661 7269 6162  x-squared variab
+00061d80: 6c65 7320 7375 6368 2061 7320 2778 5e32  les such as 'x^2
+00061d90: 270d 0a20 2020 2020 2020 2020 2020 2069  '..            i
+00061da0: 6e74 786e 5f76 6172 7320 3d20 6c65 6674  ntxn_vars = left
+00061db0: 5f73 7562 7472 6163 7428 786e 616d 6573  _subtract(xnames
+00061dc0: 2c20 7371 5f76 6172 732b 785f 7661 7273  , sq_vars+x_vars
+00061dd0: 2920 2323 2320 696e 7478 6e5f 7661 7273  ) ### intxn_vars
+00061de0: 2063 6f6e 7461 696e 2069 6e74 6572 6163   contain interac
+00061df0: 7469 6f6e 2076 6172 7320 7375 6368 2061  tion vars such a
+00061e00: 7320 2778 3120 7832 270d 0a20 2020 2020  s 'x1 x2'..     
+00061e10: 2020 2065 6c69 6620 4164 645f 506f 6c79     elif Add_Poly
+00061e20: 203d 3d20 323a 2023 2323 2320 5468 6973   == 2: #### This
+00061e30: 2061 6464 7320 6f6e 6c79 2050 6f6c 796e   adds only Polyn
+00061e40: 6f6d 6961 6c20 7661 7269 6162 6c65 7320  omial variables 
+00061e50: 3d3e 206e 6f20 496e 7465 7261 6374 696f  => no Interactio
+00061e60: 6e73 210d 0a20 2020 2020 2020 2020 2020  ns!..           
+00061e70: 2073 715f 7661 7273 203d 205b 7820 666f   sq_vars = [x fo
+00061e80: 7220 7820 696e 2078 6e61 6d65 7320 6966  r x in xnames if
+00061e90: 2027 5e32 2720 696e 2078 5d20 2020 2023   '^2' in x]    #
+00061ea0: 2323 2073 715f 7661 7273 2063 6f6e 7461  ## sq_vars conta
+00061eb0: 696e 206f 6e6c 7920 782d 7371 7561 7265  in only x-square
+00061ec0: 6420 7661 7269 6162 6c65 7320 7375 6368  d variables such
+00061ed0: 2061 7320 2778 5e32 270d 0a20 2020 2020   as 'x^2'..     
+00061ee0: 2020 2020 2020 2069 6e74 786e 5f76 6172         intxn_var
+00061ef0: 7320 3d20 5b5d 2023 2323 2069 6e74 786e  s = [] ### intxn
+00061f00: 5f76 6172 7320 636f 6e74 6169 6e20 696e  _vars contain in
+00061f10: 7465 7261 6374 696f 6e20 7661 7273 2073  teraction vars s
+00061f20: 7563 6820 6173 2027 7831 2078 3227 0d0a  uch as 'x1 x2'..
+00061f30: 2020 2020 2020 2020 656c 6966 2041 6464          elif Add
+00061f40: 5f50 6f6c 7920 3d3d 2033 3a20 2323 2323  _Poly == 3: ####
+00061f50: 2054 6869 7320 6164 6473 2042 6f74 6820   This adds Both 
+00061f60: 496e 7465 7261 6374 696f 6e20 616e 6420  Interaction and 
+00061f70: 506f 6c79 6e6f 6d69 616c 2076 6172 6961  Polynomial varia
+00061f80: 626c 6573 203d 3e20 4265 7374 206f 6620  bles => Best of 
+00061f90: 426f 7468 2077 6f72 6c64 7321 0d0a 2020  Both worlds!..  
+00061fa0: 2020 2020 2020 2020 2020 7371 5f76 6172            sq_var
+00061fb0: 7320 3d20 5b78 2066 6f72 2078 2069 6e20  s = [x for x in 
+00061fc0: 786e 616d 6573 2069 6620 275e 3227 2069  xnames if '^2' i
+00061fd0: 6e20 785d 2020 2020 2323 2320 7371 5f76  n x]    ### sq_v
+00061fe0: 6172 7320 636f 6e74 6169 6e20 6f6e 6c79  ars contain only
+00061ff0: 2078 2d73 7175 6172 6564 2076 6172 6961   x-squared varia
+00062000: 626c 6573 2073 7563 6820 6173 2027 785e  bles such as 'x^
+00062010: 3227 0d0a 2020 2020 2020 2020 2020 2020  2'..            
+00062020: 696e 7478 6e5f 7661 7273 203d 206c 6566  intxn_vars = lef
+00062030: 745f 7375 6274 7261 6374 2878 6e61 6d65  t_subtract(xname
+00062040: 732c 2073 715f 7661 7273 2b78 5f76 6172  s, sq_vars+x_var
+00062050: 7329 2023 2323 2069 6e74 786e 5f76 6172  s) ### intxn_var
+00062060: 7320 636f 6e74 6169 6e20 696e 7465 7261  s contain intera
+00062070: 6374 696f 6e20 7661 7273 2073 7563 6820  ction vars such 
+00062080: 6173 2027 7831 2078 3227 0d0a 2020 2020  as 'x1 x2'..    
+00062090: 2020 2020 2323 2323 2020 4974 2069 7320      ####  It is 
+000620a0: 6e6f 7720 7469 6d65 2074 6f20 6375 7420  now time to cut 
+000620b0: 646f 776e 2074 6865 206f 7269 6769 6e61  down the origina
+000620c0: 6c20 785f 7661 7269 6162 6c65 7320 746f  l x_variables to
+000620d0: 206a 7573 7420 7371 7561 7265 6420 7661   just squared va
+000620e0: 7269 6162 6c65 7320 616e 6420 6f72 6967  riables and orig
+000620f0: 696e 616c 7320 6865 7265 2023 2323 230d  inals here ####.
+00062100: 0a20 2020 2020 2020 2064 6963 745f 7661  .        dict_va
+00062110: 7273 203d 2064 6963 7428 7a69 7028 7072  rs = dict(zip(pr
+00062120: 6564 6963 746f 7273 2c78 5f76 6172 7329  edictors,x_vars)
+00062130: 2920 2323 2320 7468 6973 2069 7320 6120  ) ### this is a 
+00062140: 6469 6374 696f 6e61 7279 206d 6170 7069  dictionary mappi
+00062150: 6e67 206f 7269 6769 6e61 6c20 7661 7269  ng original vari
+00062160: 6162 6c65 7320 616e 6420 7468 6569 7220  ables and their 
+00062170: 782d 7661 7269 6162 6c65 730d 0a20 2020  x-variables..   
+00062180: 2020 2020 2072 6576 6572 7365 5f64 6963       reverse_dic
+00062190: 745f 7661 7273 203d 2064 6963 7428 5b28  t_vars = dict([(
+000621a0: 792c 7829 2066 6f72 2028 782c 7929 2069  y,x) for (x,y) i
+000621b0: 6e20 6469 6374 5f76 6172 732e 6974 656d  n dict_vars.item
+000621c0: 7328 295d 2920 2323 2320 7468 6973 206d  s()]) ### this m
+000621d0: 6170 7320 7468 6520 782d 7661 7273 2074  aps the x-vars t
+000621e0: 6f20 6f72 6967 696e 616c 2076 6172 730d  o original vars.
+000621f0: 0a20 2020 2020 2020 2023 2323 2323 204e  .        ##### N
+00062200: 6f77 206c 6574 2773 2063 6f6e 7665 7274  ow let's convert
+00062210: 2049 6e74 6572 6163 7469 6f6e 2078 5f76   Interaction x_v
+00062220: 6172 6961 626c 6573 2069 6e74 6f20 7468  ariables into th
+00062230: 6569 7220 636f 7272 6573 706f 6e64 696e  eir correspondin
+00062240: 6720 7465 7874 2076 6172 6961 626c 6573  g text variables
+00062250: 0d0a 2020 2020 2020 2020 696e 7478 6e5f  ..        intxn_
+00062260: 7465 7874 5f76 6172 7320 3d20 5b5d 0d0a  text_vars = []..
+00062270: 2020 2020 2020 2020 666f 7220 6561 6368          for each
+00062280: 5f69 7465 6d20 696e 2069 6e74 786e 5f76  _item in intxn_v
+00062290: 6172 733a 0d0a 2020 2020 2020 2020 2020  ars:..          
+000622a0: 2020 6966 206c 656e 2865 6163 685f 6974    if len(each_it
+000622b0: 656d 2e73 706c 6974 2822 2022 2929 203d  em.split(" ")) =
+000622c0: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
+000622d0: 2020 2020 2020 696e 7478 6e5f 7465 7874        intxn_text
+000622e0: 5f76 6172 732e 6170 7065 6e64 2872 6576  _vars.append(rev
+000622f0: 6572 7365 5f64 6963 745f 7661 7273 5b65  erse_dict_vars[e
+00062300: 6163 685f 6974 656d 5d29 0d0a 2020 2020  ach_item])..    
+00062310: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00062320: 7572 655f 7876 6172 5f64 6963 745b 6561  ure_xvar_dict[ea
+00062330: 6368 5f69 7465 6d5d 203d 2072 6576 6572  ch_item] = rever
+00062340: 7365 5f64 6963 745f 7661 7273 5b65 6163  se_dict_vars[eac
+00062350: 685f 6974 656d 5d0d 0a20 2020 2020 2020  h_item]..       
+00062360: 2020 2020 2065 6c69 6620 6c65 6e28 6561       elif len(ea
+00062370: 6368 5f69 7465 6d2e 7370 6c69 7428 2220  ch_item.split(" 
+00062380: 2229 2920 3d3d 2032 3a0d 0a20 2020 2020  ")) == 2:..     
+00062390: 2020 2020 2020 2020 2020 2074 776f 5f69             two_i
+000623a0: 7465 6d73 5f6c 6973 7420 3d20 6561 6368  tems_list = each
+000623b0: 5f69 7465 6d2e 7370 6c69 7428 2220 2229  _item.split(" ")
+000623c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000623d0: 2020 6675 6c6c 5f69 6e74 786e 5f6e 616d    full_intxn_nam
+000623e0: 6520 3d20 7265 7665 7273 655f 6469 6374  e = reverse_dict
+000623f0: 5f76 6172 735b 7477 6f5f 6974 656d 735f  _vars[two_items_
+00062400: 6c69 7374 5b30 5d5d 202b 2220 222b 2072  list[0]] +" "+ r
+00062410: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
+00062420: 5b74 776f 5f69 7465 6d73 5f6c 6973 745b  [two_items_list[
+00062430: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
+00062440: 2020 2020 2069 6e74 786e 5f74 6578 745f       intxn_text_
+00062450: 7661 7273 2e61 7070 656e 6428 6675 6c6c  vars.append(full
+00062460: 5f69 6e74 786e 5f6e 616d 6529 0d0a 2020  _intxn_name)..  
+00062470: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+00062480: 6174 7572 655f 7876 6172 5f64 6963 745b  ature_xvar_dict[
+00062490: 6561 6368 5f69 7465 6d5d 203d 2066 756c  each_item] = ful
+000624a0: 6c5f 696e 7478 6e5f 6e61 6d65 0d0a 2020  l_intxn_name..  
+000624b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000624c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000624d0: 2070 6173 730d 0a20 2020 2020 2020 2023   pass..        #
+000624e0: 2323 2323 204e 6f77 206c 6574 2773 2063  #### Now let's c
+000624f0: 6f6e 7665 7274 2053 7175 6172 6564 2078  onvert Squared x
+00062500: 5f76 6172 6961 626c 6573 2069 6e74 6f20  _variables into 
+00062510: 7468 6569 7220 636f 7272 6573 706f 6e64  their correspond
+00062520: 696e 6720 7465 7874 2076 6172 6961 626c  ing text variabl
+00062530: 6573 0d0a 2020 2020 2020 2020 7371 5f74  es..        sq_t
+00062540: 6578 745f 7661 7273 203d 205b 5d0d 0a20  ext_vars = [].. 
+00062550: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
+00062560: 7371 5f69 7465 6d20 696e 2073 715f 7661  sq_item in sq_va
+00062570: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
+00062580: 2069 6620 6c65 6e28 6561 6368 5f73 715f   if len(each_sq_
+00062590: 6974 656d 2e73 706c 6974 2822 5e22 2929  item.split("^"))
+000625a0: 203d 3d20 323a 0d0a 2020 2020 2020 2020   == 2:..        
+000625b0: 2020 2020 2020 2020 7477 6f5f 6974 656d          two_item
+000625c0: 5f6c 6973 7420 3d20 6561 6368 5f73 715f  _list = each_sq_
+000625d0: 6974 656d 2e73 706c 6974 2822 5e22 290d  item.split("^").
+000625e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000625f0: 2066 756c 6c5f 7371 5f6e 616d 6520 3d20   full_sq_name = 
+00062600: 7265 7665 7273 655f 6469 6374 5f76 6172  reverse_dict_var
+00062610: 735b 7477 6f5f 6974 656d 5f6c 6973 745b  s[two_item_list[
+00062620: 305d 5d20 2b22 5e32 220d 0a20 2020 2020  0]] +"^2"..     
+00062630: 2020 2020 2020 2020 2020 2073 715f 7465             sq_te
+00062640: 7874 5f76 6172 732e 6170 7065 6e64 2866  xt_vars.append(f
+00062650: 756c 6c5f 7371 5f6e 616d 6529 0d0a 2020  ull_sq_name)..  
+00062660: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+00062670: 6174 7572 655f 7876 6172 5f64 6963 745b  ature_xvar_dict[
+00062680: 6561 6368 5f73 715f 6974 656d 5d20 3d20  each_sq_item] = 
+00062690: 6675 6c6c 5f73 715f 6e61 6d65 0d0a 2020  full_sq_name..  
+000626a0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000626b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000626c0: 2070 6173 730d 0a20 2020 2020 2020 2023   pass..        #
+000626d0: 2323 2320 4e6f 7720 7765 206e 6565 6420  ### Now we need 
+000626e0: 746f 2063 6f6d 6269 6e65 2074 6865 2078  to combine the x
+000626f0: 5f76 6172 732c 2053 7175 6172 6564 5f76  _vars, Squared_v
+00062700: 6172 7320 616e 6420 7468 6520 496e 7478  ars and the Intx
+00062710: 6e5f 7661 7273 2074 6f67 6574 6865 7220  n_vars together 
+00062720: 6173 2054 6578 7420 7661 7273 2069 6e20  as Text vars in 
+00062730: 6f6e 6520 7661 7269 6162 6c65 0d0a 2020  one variable..  
+00062740: 2020 2020 2020 6675 6c6c 5f78 5f76 6172        full_x_var
+00062750: 7320 3d20 785f 7661 7273 202b 2073 715f  s = x_vars + sq_
+00062760: 7661 7273 202b 2069 6e74 786e 5f76 6172  vars + intxn_var
+00062770: 730d 0a20 2020 2020 2020 2074 6578 745f  s..        text_
+00062780: 7661 7273 203d 2070 7265 6469 6374 6f72  vars = predictor
+00062790: 7320 2b20 7371 5f74 6578 745f 7661 7273  s + sq_text_vars
+000627a0: 202b 2069 6e74 786e 5f74 6578 745f 7661   + intxn_text_va
+000627b0: 7273 2023 2323 2320 7465 7874 5f76 6172  rs #### text_var
+000627c0: 7320 6e6f 7720 636f 6e74 6169 6e73 2061  s now contains a
+000627d0: 6c6c 2074 6865 2074 6578 7420 7665 7273  ll the text vers
+000627e0: 696f 6e20 6f66 2078 2d76 6172 6961 626c  ion of x-variabl
+000627f0: 6573 0d0a 2020 2020 2020 2020 6966 206c  es..        if l
+00062800: 656e 2874 6578 745f 7661 7273 2920 3d3d  en(text_vars) ==
+00062810: 206c 656e 2866 756c 6c5f 785f 7661 7273   len(full_x_vars
+00062820: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00062830: 7072 696e 7428 2753 7563 6365 7373 6675  print('Successfu
+00062840: 6c6c 7920 7472 616e 7366 6f72 6d65 6420  lly transformed 
+00062850: 782d 7661 7269 6162 6c65 7320 696e 746f  x-variables into
+00062860: 2074 6578 742d 7661 7269 6162 6c65 7320   text-variables 
+00062870: 6166 7465 7220 506f 6c79 6e6f 6d69 616c  after Polynomial
+00062880: 2074 7261 6e73 666f 726d 6174 696f 6e73   transformations
+00062890: 2729 0d0a 2020 2020 2020 2020 656c 7365  ')..        else
+000628a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+000628b0: 7269 6e74 2827 4572 726f 723a 204e 6f74  rint('Error: Not
+000628c0: 2061 626c 6520 746f 2074 7261 6e73 666f   able to transfo
+000628d0: 726d 2078 2d76 6172 6961 626c 6573 2069  rm x-variables i
+000628e0: 6e74 6f20 7465 7874 2d76 6172 6961 626c  nto text-variabl
+000628f0: 6573 2e20 436f 6e74 696e 7569 6e67 2077  es. Continuing w
+00062900: 6974 686f 7574 2050 6f6c 7920 7661 7273  ithout Poly vars
+00062910: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
+00062920: 2020 2072 6574 7572 6e20 7072 6564 6963     return predic
+00062930: 746f 7273 2c20 6c6d 2c20 5850 312c 206d  tors, lm, XP1, m
+00062940: 642c 2078 5f76 6172 732c 6665 6174 7572  d, x_vars,featur
+00062950: 655f 7876 6172 5f64 6963 740d 0a20 2020  e_xvar_dict..   
+00062960: 2020 2020 2066 6561 7475 7265 5f74 6578       feature_tex
+00062970: 7476 6172 5f64 6963 7420 203d 2064 6963  tvar_dict  = dic
+00062980: 7428 5b28 792c 7829 2066 6f72 2028 782c  t([(y,x) for (x,
+00062990: 7929 2069 6e20 6665 6174 7572 655f 7876  y) in feature_xv
+000629a0: 6172 5f64 6963 742e 6974 656d 7328 295d  ar_dict.items()]
+000629b0: 290d 0a20 2020 2020 2020 2023 2323 2320  )..        #### 
+000629c0: 4e6f 7720 4275 696c 6420 6120 4461 7461  Now Build a Data
+000629d0: 2046 7261 6d65 2063 6f6e 7461 696e 696e   Frame containin
+000629e0: 6720 636f 6e74 6169 6e69 6e67 2061 6464  g containing add
+000629f0: 6974 696f 6e61 6c20 506f 6c79 2061 6e64  itional Poly and
+00062a00: 2049 6e74 786e 2076 6172 6961 626c 6573   Intxn variables
+00062a10: 2069 6e20 782d 666f 726d 6174 2068 6572   in x-format her
+00062a20: 6520 2323 2323 0d0a 2020 2020 2020 2020  e ####..        
+00062a30: 6e65 775f 6164 6478 5f76 6172 7320 3d20  new_addx_vars = 
+00062a40: 7371 5f76 6172 732b 696e 7478 6e5f 7661  sq_vars+intxn_va
+00062a50: 7273 0d0a 2020 2020 2020 2020 6966 206c  rs..        if l
+00062a60: 656e 286e 6577 5f61 6464 785f 7661 7273  en(new_addx_vars
+00062a70: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
+00062a80: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
+00062a90: 723a 2054 6865 7265 2061 7265 206e 6f20  r: There are no 
+00062aa0: 7371 7561 7265 6420 6f72 2069 6e74 6572  squared or inter
+00062ab0: 6163 7469 6f6e 2076 6172 7320 746f 2061  action vars to a
+00062ac0: 6464 2e20 436f 6e74 696e 7569 6e67 2077  dd. Continuing w
+00062ad0: 6974 686f 7574 2050 6f6c 7920 7661 7273  ithout Poly vars
+00062ae0: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
+00062af0: 2020 2072 6574 7572 6e20 7072 6564 6963     return predic
+00062b00: 746f 7273 2c20 6c6d 2c20 5850 312c 206d  tors, lm, XP1, m
+00062b10: 642c 2078 5f76 6172 732c 6665 6174 7572  d, x_vars,featur
+00062b20: 655f 7876 6172 5f64 6963 740d 0a20 2020  e_xvar_dict..   
+00062b30: 2020 2020 2023 2323 2320 2057 6520 6465       ####  We de
+00062b40: 6669 6e65 2032 2064 6174 6120 6672 616d  fine 2 data fram
+00062b50: 6573 3a20 6f6e 6520 666f 7220 7265 6d6f  es: one for remo
+00062b60: 7669 6e67 2068 6967 686c 7920 636f 7272  ving highly corr
+00062b70: 656c 6174 6564 2076 6172 7320 616e 6420  elated vars and 
+00062b80: 6f74 6865 7220 666f 7220 4c61 7373 6f20  other for Lasso 
+00062b90: 7365 6c65 6374 696f 6e0d 0a20 2020 2020  selection..     
+00062ba0: 2020 2058 5032 203d 2058 5031 5b6e 6577     XP2 = XP1[new
+00062bb0: 5f61 6464 785f 7661 7273 5d2e 6a6f 696e  _addx_vars].join
+00062bc0: 2859 290d 0a20 2020 2020 2020 2058 5031  (Y)..        XP1
+00062bd0: 5820 3d20 5850 315b 6e65 775f 6164 6478  X = XP1[new_addx
+00062be0: 5f76 6172 735d 0d0a 2020 2020 2020 2020  _vars]..        
+00062bf0: 6e65 775f 6164 6474 6578 745f 7661 7273  new_addtext_vars
+00062c00: 203d 205b 6665 6174 7572 655f 7876 6172   = [feature_xvar
+00062c10: 5f64 6963 745b 785d 2066 6f72 2078 2069  _dict[x] for x i
+00062c20: 6e20 6e65 775f 6164 6478 5f76 6172 735d  n new_addx_vars]
+00062c30: 0d0a 2020 2020 2020 2020 5850 322e 636f  ..        XP2.co
+00062c40: 6c75 6d6e 7320 3d20 6e65 775f 6164 6474  lumns = new_addt
+00062c50: 6578 745f 7661 7273 2b5b 7461 7267 6574  ext_vars+[target
+00062c60: 7661 725d 0d0a 2020 2020 2020 2020 5850  var]..        XP
+00062c70: 3158 2e63 6f6c 756d 6e73 203d 206e 6577  1X.columns = new
+00062c80: 5f61 6464 7465 7874 5f76 6172 730d 0a20  _addtext_vars.. 
+00062c90: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+00062ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062ce0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00062cf0: 2020 2020 2323 2323 2020 2020 4641 5354      ####    FAST
+00062d00: 2046 4541 5455 5245 2052 4544 5543 5449   FEATURE REDUCTI
+00062d10: 4f4e 2055 5349 4e47 204c 3120 5245 4755  ON USING L1 REGU
+00062d20: 4c41 5249 5a41 5449 4f4e 2046 4f52 204c  LARIZATION FOR L
+00062d30: 4152 4745 2044 4154 4120 5345 5453 2020  ARGE DATA SETS  
+00062d40: 2023 2323 2323 230d 0a20 2020 2020 2020   ######..       
+00062d50: 2023 2323 2320 2020 5573 6520 4c61 7373   ####   Use Lass
+00062d60: 6f43 5620 6f72 204c 6f67 6973 7469 6352  oCV or LogisticR
+00062d70: 6567 7265 7373 696f 6e43 5620 746f 2052  egressionCV to R
+00062d80: 6564 7563 6520 5661 7269 6162 6c65 7320  educe Variables 
+00062d90: 7573 696e 6720 5265 6775 6c61 7269 7a61  using Regulariza
+00062da0: 7469 6f6e 0d0a 2020 2020 2020 2020 2323  tion..        ##
+00062db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00062e00: 230d 0a20 2020 2020 2020 2070 7269 6e74  #..        print
+00062e10: 2827 4275 696c 6469 6e67 2043 6f6d 7061  ('Building Compa
+00062e20: 7269 736f 6e20 4d6f 6465 6c20 7769 7468  rison Model with
+00062e30: 206f 6e6c 7920 506f 6c79 2061 6e64 2049   only Poly and I
+00062e40: 6e74 6572 6163 7469 6f6e 2076 6172 6961  nteraction varia
+00062e50: 626c 6573 2e2e 2e27 290d 0a20 2020 2020  bles...')..     
+00062e60: 2020 206c 6d5f 702c 205f 203d 2070 7269     lm_p, _ = pri
+00062e70: 6e74 5f6d 6f64 656c 5f6d 6574 7269 6373  nt_model_metrics
+00062e80: 286d 6f64 656c 7479 7065 2c6c 6d2c 5850  (modeltype,lm,XP
+00062e90: 3158 2c59 2c54 7275 6529 0d0a 2020 2020  1X,Y,True)..    
+00062ea0: 2020 2020 7072 696e 7428 2720 2020 2054      print('    T
+00062eb0: 696d 6520 5461 6b65 6e3a 2025 302e 3066  ime Taken: %0.0f
+00062ec0: 2028 696e 2073 6563 6f6e 6473 2927 2025   (in seconds)' %
+00062ed0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+00062ee0: 7274 5f74 696d 6529 290d 0a20 2020 2020  rt_time))..     
+00062ef0: 2020 2023 2323 2320 2057 6520 6e65 6564     ####  We need
+00062f00: 2074 6f20 6275 696c 6420 6120 6461 7461   to build a data
+00062f10: 6672 616d 6520 746f 2068 6f6c 6420 636f  frame to hold co
+00062f20: 6566 6669 6369 656e 7473 2066 726f 6d20  efficients from 
+00062f30: 7468 6520 6d6f 6465 6c20 666f 7220 6561  the model for ea
+00062f40: 6368 2076 6172 6961 626c 6520 2323 230d  ch variable ###.
+00062f50: 0a20 2020 2020 2020 2064 6678 203d 2070  .        dfx = p
+00062f60: 642e 4461 7461 4672 616d 6528 5b6e 6577  d.DataFrame([new
+00062f70: 5f61 6464 785f 7661 7273 2c20 6e65 775f  _addx_vars, new_
+00062f80: 6164 6474 6578 745f 7661 7273 5d29 0d0a  addtext_vars])..
+00062f90: 2020 2020 2020 2020 6466 203d 2064 6678          df = dfx
+00062fa0: 2e54 0d0a 2020 2020 2020 2020 6466 2e63  .T..        df.c
+00062fb0: 6f6c 756d 6e73 3d5b 2758 204e 616d 6573  olumns=['X Names
+00062fc0: 272c 2749 6e74 6572 6163 7469 6f6e 2056  ','Interaction V
+00062fd0: 6172 6961 626c 6520 4e61 6d65 7327 5d0d  ariable Names'].
+00062fe0: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
+00062ff0: 2323 2320 204e 204f 2057 2020 2042 2055  ###  N O W   B U
+00063000: 2049 204c 2044 2020 5420 4820 4520 204d   I L D  T H E  M
+00063010: 204f 2044 2045 204c 2023 2323 2323 2323   O D E L #######
+00063020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063030: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00063040: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
+00063050: 6520 3d3d 2027 5265 6772 6573 7369 6f6e  e == 'Regression
+00063060: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00063070: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
+00063080: 5661 6c75 6573 275d 203d 206c 6d5f 702e  Values'] = lm_p.
+00063090: 636f 6566 5f0d 0a20 2020 2020 2020 2065  coef_..        e
+000630a0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000630b0: 2020 6466 5b27 436f 6566 6669 6369 656e    df['Coefficien
+000630c0: 7420 5661 6c75 6573 275d 203d 206c 6d5f  t Values'] = lm_
+000630d0: 702e 636f 6566 5f5b 305d 0d0a 2020 2020  p.coef_[0]..    
+000630e0: 2020 2020 2323 2323 2054 6869 7320 7061      #### This pa
+000630f0: 7274 2073 656c 6563 7473 2074 6865 2074  rt selects the t
+00063100: 6f70 2031 3025 206f 6620 696e 7465 7261  op 10% of intera
+00063110: 6374 696f 6e20 7661 7269 6162 6c65 7320  ction variables 
+00063120: 6372 6561 7465 6420 7573 696e 6720 6c69  created using li
+00063130: 6e65 6172 206d 6f64 656c 696e 672e 0d0a  near modeling...
+00063140: 2020 2020 2020 2020 2323 2320 2020 4974          ###   It
+00063150: 2069 7320 7665 7279 2069 6d70 6f72 7461   is very importa
+00063160: 6e74 2074 6f20 6c65 6176 6520 7468 6520  nt to leave the 
+00063170: 6e65 7874 206c 696e 6520 6173 2069 7320  next line as is 
+00063180: 7369 6e63 6520 3e20 7379 6d62 6f6c 2069  since > symbol i
+00063190: 7320 6265 7474 6572 2074 6861 6e20 3e3d  s better than >=
+000631a0: 0d0a 2020 2020 2020 2020 6c69 6d20 3d20  ..        lim = 
+000631b0: 6162 7328 6466 5b27 436f 6566 6669 6369  abs(df['Coeffici
+000631c0: 656e 7420 5661 6c75 6573 275d 292e 7175  ent Values']).qu
+000631d0: 616e 7469 6c65 2830 2e39 290d 0a20 2020  antile(0.9)..   
+000631e0: 2020 2020 2064 6639 3020 3d20 6466 5b61       df90 = df[a
+000631f0: 6273 2864 665b 2743 6f65 6666 6963 6965  bs(df['Coefficie
+00063200: 6e74 2056 616c 7565 7327 5d29 3e6c 696d  nt Values'])>lim
+00063210: 5d2e 736f 7274 5f76 616c 7565 7328 2743  ].sort_values('C
+00063220: 6f65 6666 6963 6965 6e74 2056 616c 7565  oefficient Value
+00063230: 7327 2c61 7363 656e 6469 6e67 3d46 616c  s',ascending=Fal
+00063240: 7365 290d 0a20 2020 2020 2020 2069 6620  se)..        if 
+00063250: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
+00063260: 5661 6c75 6573 275d 2e73 756d 2829 3d3d  Values'].sum()==
+00063270: 302e 3020 6f72 2064 6639 305b 2743 6f65  0.0 or df90['Coe
+00063280: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
+00063290: 5d2e 7375 6d28 293d 3d30 2e30 3a0d 0a20  ].sum()==0.0:.. 
+000632a0: 2020 2020 2020 2020 2020 2023 2323 2054             ### T
+000632b0: 6865 7265 2069 7320 6e6f 2063 6f65 6666  here is no coeff
+000632c0: 6963 6965 6e74 2074 6861 7420 6973 2067  icient that is g
+000632d0: 7265 6174 6572 2074 6861 6e20 3020 6865  reater than 0 he
+000632e0: 7265 2e20 536f 2072 656a 6563 7420 616c  re. So reject al
+000632f0: 6c20 7661 7269 6162 6c65 7321 0d0a 2020  l variables!..  
+00063300: 2020 2020 2020 2020 2020 7365 6c5f 785f            sel_x_
+00063310: 7661 7273 203d 205b 5d0d 0a20 2020 2020  vars = []..     
+00063320: 2020 2020 2020 2070 7269 6e74 2827 5a65         print('Ze
+00063330: 726f 2049 6e74 6572 6163 7469 6f6e 2061  ro Interaction a
+00063340: 6e64 2050 6f6c 796e 6f6d 6961 6c20 7661  nd Polynomial va
+00063350: 7269 6162 6c65 2873 2920 7365 6c65 6374  riable(s) select
+00063360: 6564 2e2e 2e27 290d 0a20 2020 2020 2020  ed...')..       
+00063370: 2065 6c69 6620 6466 5b27 436f 6566 6669   elif df['Coeffi
+00063380: 6369 656e 7420 5661 6c75 6573 275d 2e73  cient Values'].s
+00063390: 6861 7065 5b30 5d20 3d3d 2064 6639 305b  hape[0] == df90[
+000633a0: 2743 6f65 6666 6963 6965 6e74 2056 616c  'Coefficient Val
+000633b0: 7565 7327 5d2e 7368 6170 655b 305d 3a0d  ues'].shape[0]:.
+000633c0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+000633d0: 2054 6865 7265 2069 7320 6e6f 2063 6f65   There is no coe
+000633e0: 6666 6963 6965 6e74 2074 6861 7420 6973  fficient that is
+000633f0: 2067 7265 6174 6572 2074 6861 6e20 3020   greater than 0 
+00063400: 6865 7265 2e20 536f 2072 656a 6563 7420  here. So reject 
+00063410: 616c 6c20 7661 7269 6162 6c65 7321 0d0a  all variables!..
+00063420: 2020 2020 2020 2020 2020 2020 7365 6c5f              sel_
+00063430: 785f 7661 7273 203d 205b 5d0d 0a20 2020  x_vars = []..   
+00063440: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00063450: 5a65 726f 2049 6e74 6572 6163 7469 6f6e  Zero Interaction
+00063460: 2061 6e64 2050 6f6c 796e 6f6d 6961 6c20   and Polynomial 
+00063470: 7661 7269 6162 6c65 2873 2920 7365 6c65  variable(s) sele
+00063480: 6374 6564 2e2e 2e27 290d 0a20 2020 2020  cted...')..     
+00063490: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000634a0: 2020 2020 2020 2323 2323 2074 6865 7265        #### there
+000634b0: 2069 7320 736f 6d65 2063 6f65 6666 6963   is some coeffic
+000634c0: 6965 6e74 7320 6174 206c 6561 7374 2074  ients at least t
+000634d0: 6861 7420 6172 6520 6e6f 6e2d 7a65 726f  hat are non-zero
+000634e0: 2061 6e64 2068 656e 6365 2063 616e 2062   and hence can b
+000634f0: 6520 7472 7573 7465 6421 0d0a 2020 2020  e trusted!..    
+00063500: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00063510: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
+00063520: 2020 2020 2020 2020 2020 6466 3930 2e73            df90.s
+00063530: 6f72 745f 7661 6c75 6573 2827 436f 6566  ort_values('Coef
+00063540: 6669 6369 656e 7420 5661 6c75 6573 272c  ficient Values',
+00063550: 6173 6365 6e64 696e 673d 4661 6c73 6529  ascending=False)
+00063560: 5b3a 3130 5d2e 706c 6f74 280d 0a20 2020  [:10].plot(..   
+00063570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00063580: 206b 696e 643d 2762 6172 272c 783d 2749   kind='bar',x='I
+00063590: 6e74 6572 6163 7469 6f6e 2056 6172 6961  nteraction Varia
+000635a0: 626c 6520 4e61 6d65 7327 2c79 3d27 436f  ble Names',y='Co
+000635b0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
+000635c0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+000635d0: 2020 2020 2020 2020 7469 746c 653d 2754          title='T
+000635e0: 6f70 2031 3025 2056 6172 6961 626c 6520  op 10% Variable 
+000635f0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+00063600: 2074 6865 6972 2043 6f65 6666 6963 6965   their Coefficie
+00063610: 6e74 7320 2729 0d0a 2020 2020 2020 2020  nts ')..        
+00063620: 2020 2020 656c 6966 2076 6572 626f 7365      elif verbose
+00063630: 203d 3d20 323a 0d0a 2020 2020 2020 2020   == 2:..        
+00063640: 2020 2020 2020 2020 6466 3930 2e73 6f72          df90.sor
+00063650: 745f 7661 6c75 6573 2827 436f 6566 6669  t_values('Coeffi
+00063660: 6369 656e 7420 5661 6c75 6573 272c 6173  cient Values',as
+00063670: 6365 6e64 696e 673d 4661 6c73 6529 2e70  cending=False).p
+00063680: 6c6f 7428 0d0a 2020 2020 2020 2020 2020  lot(..          
+00063690: 2020 2020 2020 2020 2020 6b69 6e64 3d27            kind='
+000636a0: 6261 7227 2c78 3d27 496e 7465 7261 6374  bar',x='Interact
+000636b0: 696f 6e20 5661 7269 6162 6c65 204e 616d  ion Variable Nam
+000636c0: 6573 272c 793d 2743 6f65 6666 6963 6965  es',y='Coefficie
+000636d0: 6e74 2056 616c 7565 7327 2c0d 0a20 2020  nt Values',..   
+000636e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000636f0: 2020 2020 2074 6974 6c65 3d27 416c 6c20       title='All 
+00063700: 5661 7269 6162 6c65 2049 6e74 6572 6163  Variable Interac
+00063710: 7469 6f6e 7320 616e 6420 7468 6569 7220  tions and their 
+00063720: 436f 6566 6669 6369 656e 7473 272c 6669  Coefficients',fi
+00063730: 6773 697a 653d 2832 302c 3130 2929 0d0a  gsize=(20,10))..
+00063740: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00063750: 7261 6374 696f 6e73 203d 2064 6639 305b  ractions = df90[
+00063760: 2749 6e74 6572 6163 7469 6f6e 2056 6172  'Interaction Var
+00063770: 6961 626c 6520 4e61 6d65 7327 5d2e 7661  iable Names'].va
+00063780: 6c75 6573 2e74 6f6c 6973 7428 290d 0a20  lues.tolist().. 
+00063790: 2020 2020 2020 2020 2020 2073 656c 5f78             sel_x
+000637a0: 5f76 6172 7320 3d20 6466 3930 5b22 5820  _vars = df90["X 
+000637b0: 4e61 6d65 7322 5d2e 7661 6c75 6573 2e74  Names"].values.t
+000637c0: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
+000637d0: 2023 2323 2323 2323 204e 6f77 2077 6520   ####### Now we 
+000637e0: 6861 7665 2074 6f20 7075 7420 7468 6520  have to put the 
+000637f0: 6675 6c6c 2064 6174 6166 7261 6d65 2074  full dataframe t
+00063800: 6f67 6574 6865 7220 7769 7468 2073 656c  ogether with sel
+00063810: 6563 7465 6420 7661 7269 6162 6c65 7320  ected variables 
+00063820: 616e 6420 6f72 6967 696e 616c 2070 7265  and original pre
+00063830: 6469 6374 6f72 7321 0d0a 2020 2020 2020  dictors!..      
+00063840: 2020 2323 2323 2044 4f20 4e4f 5420 4348    #### DO NOT CH
+00063850: 414e 4745 2054 4845 204e 4558 5420 4c49  ANGE THE NEXT LI
+00063860: 4e45 2045 5645 4e20 5448 4f55 4748 2049  NE EVEN THOUGH I
+00063870: 5420 4d49 4748 5420 4245 2054 454d 5054  T MIGHT BE TEMPT
+00063880: 494e 4720 544f 2044 4f20 534f 2120 4974  ING TO DO SO! It
+00063890: 2069 7320 636f 7272 6563 7421 0d0a 2020   is correct!..  
+000638a0: 2020 2020 2020 6669 6e61 6c5f 785f 7661        final_x_va
+000638b0: 7273 203d 2078 5f76 6172 7320 2b20 7365  rs = x_vars + se
+000638c0: 6c5f 785f 7661 7273 0d0a 2020 2020 2020  l_x_vars..      
+000638d0: 2020 7365 6c5f 7465 7874 5f76 6172 7320    sel_text_vars 
+000638e0: 3d20 5b66 6561 7475 7265 5f78 7661 725f  = [feature_xvar_
+000638f0: 6469 6374 5b78 5d20 666f 7220 7820 696e  dict[x] for x in
+00063900: 2073 656c 5f78 5f76 6172 735d 0d0a 2020   sel_x_vars]..  
+00063910: 2020 2020 2020 7072 696e 7428 2749 6e69        print('Ini
+00063920: 7469 616c 6c79 2061 6464 696e 6720 2564  tially adding %d
+00063930: 2076 6172 6961 626c 6528 7329 2064 7565   variable(s) due
+00063940: 2074 6f20 4164 645f 506f 6c79 203d 2025   to Add_Poly = %
+00063950: 7320 7365 7474 696e 6727 2025 286c 656e  s setting' %(len
+00063960: 2873 656c 5f74 6578 745f 7661 7273 292c  (sel_text_vars),
+00063970: 4164 645f 506f 6c79 2929 0d0a 2020 2020  Add_Poly))..    
+00063980: 2020 2020 6966 2076 6572 626f 7365 203e      if verbose >
+00063990: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+000639a0: 2069 6620 6c65 6e28 7365 6c5f 7465 7874   if len(sel_text
+000639b0: 5f76 6172 7329 203c 3d20 3330 3a0d 0a20  _vars) <= 30:.. 
+000639c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000639d0: 7269 6e74 2827 2020 2020 4164 6465 6420  rint('    Added 
+000639e0: 7661 7269 6162 6c65 733a 2025 7327 2025  variables: %s' %
+000639f0: 7365 6c5f 7465 7874 5f76 6172 7329 0d0a  sel_text_vars)..
+00063a00: 2020 2020 2020 2020 6669 6e61 6c5f 7465          final_te
+00063a10: 7874 5f76 6172 7320 3d20 5b66 6561 7475  xt_vars = [featu
+00063a20: 7265 5f78 7661 725f 6469 6374 5b78 5d20  re_xvar_dict[x] 
+00063a30: 666f 7220 7820 696e 2066 696e 616c 5f78  for x in final_x
+00063a40: 5f76 6172 735d 0d0a 2020 2020 2020 2020  _vars]..        
+00063a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063aa0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00063ab0: 2020 2020 6669 6e61 6c5f 6466 203d 206d      final_df = m
+00063ac0: 642e 7472 616e 7366 6f72 6d28 6461 7461  d.transform(data
+00063ad0: 5b70 7265 6469 6374 6f72 735d 290d 0a20  [predictors]).. 
+00063ae0: 2020 2020 2020 2069 6620 4c6f 6f73 6556         if LooseV
+00063af0: 6572 7369 6f6e 2873 6b6c 6561 726e 2e5f  ersion(sklearn._
+00063b00: 5f76 6572 7369 6f6e 5f5f 2920 3c3d 204c  _version__) <= L
+00063b10: 6f6f 7365 5665 7273 696f 6e28 2730 2e32  ooseVersion('0.2
+00063b20: 342e 3227 293a 0d0a 2020 2020 2020 2020  4.2'):..        
+00063b30: 2020 2020 2320 5065 7266 6f72 6d20 6163      # Perform ac
+00063b40: 7469 6f6e 2066 6f72 2073 6369 6b69 742d  tion for scikit-
+00063b50: 6c65 6172 6e20 7665 7273 696f 6e20 6265  learn version be
+00063b60: 6c6f 7720 302e 3234 2e32 0d0a 2020 2020  low 0.24.2..    
+00063b70: 2020 2020 2020 2020 2320 4164 6420 796f          # Add yo
+00063b80: 7572 2063 6f64 6520 6865 7265 2066 6f72  ur code here for
+00063b90: 2073 6369 6b69 742d 6c65 6172 6e20 7665   scikit-learn ve
+00063ba0: 7273 696f 6e20 6265 6c6f 7720 302e 3234  rsion below 0.24
+00063bb0: 2e32 0d0a 2020 2020 2020 2020 2020 2020  .2..            
+00063bc0: 786e 616d 6573 203d 206d 642e 6765 745f  xnames = md.get_
+00063bd0: 6665 6174 7572 655f 6e61 6d65 7328 290d  feature_names().
+00063be0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00063bf0: 2020 2020 2020 2020 2020 2020 2320 5065              # Pe
+00063c00: 7266 6f72 6d20 6163 7469 6f6e 2066 6f72  rform action for
+00063c10: 2073 6369 6b69 742d 6c65 6172 6e20 7665   scikit-learn ve
+00063c20: 7273 696f 6e20 302e 3234 2e32 2061 6e64  rsion 0.24.2 and
+00063c30: 2061 626f 7665 0d0a 2020 2020 2020 2020   above..        
+00063c40: 2020 2020 2320 4164 6420 796f 7572 2063      # Add your c
+00063c50: 6f64 6520 6865 7265 2066 6f72 2073 6369  ode here for sci
+00063c60: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+00063c70: 6e20 302e 3234 2e32 2061 6e64 2061 626f  n 0.24.2 and abo
+00063c80: 7665 0d0a 2020 2020 2020 2020 2020 2020  ve..            
+00063c90: 786e 616d 6573 203d 206d 642e 6765 745f  xnames = md.get_
+00063ca0: 6665 6174 7572 655f 6e61 6d65 735f 6f75  feature_names_ou
+00063cb0: 7428 292e 746f 6c69 7374 2829 2023 2323  t().tolist() ###
+00063cc0: 2078 6e61 6d65 7320 636f 6e74 6169 6e73   xnames contains
+00063cd0: 2061 6c6c 2078 2d6f 6e6c 792c 2050 6f6c   all x-only, Pol
+00063ce0: 7920 616e 6420 496e 7478 6e20 7661 7269  y and Intxn vari
+00063cf0: 6162 6c65 7320 696e 2078 2d66 6f72 6d61  ables in x-forma
+00063d00: 740d 0a20 2020 2020 2020 2066 696e 616c  t..        final
+00063d10: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
+00063d20: 6d65 2866 696e 616c 5f64 662c 696e 6465  me(final_df,inde
+00063d30: 783d 6f72 6967 5f64 6174 615f 696e 6465  x=orig_data_inde
+00063d40: 782c 2063 6f6c 756d 6e73 3d78 6e61 6d65  x, columns=xname
+00063d50: 7329 0d0a 2020 2020 2020 2020 6669 6e61  s)..        fina
+00063d60: 6c5f 6466 203d 2066 696e 616c 5f64 665b  l_df = final_df[
+00063d70: 6669 6e61 6c5f 785f 7661 7273 5d0d 0a20  final_x_vars].. 
+00063d80: 2020 2020 2020 2066 696e 616c 5f64 662e         final_df.
+00063d90: 636f 6c75 6d6e 7320 3d20 6669 6e61 6c5f  columns = final_
+00063da0: 7465 7874 5f76 6172 730d 0a20 2020 2020  text_vars..     
+00063db0: 2020 2063 6f70 795f 7072 6564 7320 3d20     copy_preds = 
+00063dc0: 636f 7079 2e64 6565 7063 6f70 7928 7072  copy.deepcopy(pr
+00063dd0: 6564 6963 746f 7273 290d 0a20 2020 2020  edictors)..     
+00063de0: 2020 2023 2323 2323 2323 2049 6620 7468     ####### If th
+00063df0: 6520 6f72 6967 696e 616c 2063 6f6c 756d  e original colum
+00063e00: 6e27 7320 6474 7970 6520 7761 7320 696e  n's dtype was in
+00063e10: 7465 6765 722c 2070 7574 2069 7420 6261  teger, put it ba
+00063e20: 636b 2061 7320 696e 7465 6765 7220 2323  ck as integer ##
+00063e30: 230d 0a20 2020 2020 2020 2066 6f72 2065  #..        for e
+00063e40: 6163 685f 7072 6564 2069 6e20 636f 7079  ach_pred in copy
+00063e50: 5f70 7265 6473 3a0d 0a20 2020 2020 2020  _preds:..       
+00063e60: 2020 2020 2069 6620 6461 7461 5b65 6163       if data[eac
+00063e70: 685f 7072 6564 5d2e 6474 7970 6520 3d3d  h_pred].dtype ==
+00063e80: 2069 6e74 3a0d 0a20 2020 2020 2020 2020   int:..         
+00063e90: 2020 2020 2020 2066 696e 616c 5f64 665b         final_df[
+00063ea0: 6561 6368 5f70 7265 645d 203d 2066 696e  each_pred] = fin
+00063eb0: 616c 5f64 665b 6561 6368 5f70 7265 645d  al_df[each_pred]
+00063ec0: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+00063ed0: 2020 2020 2020 6669 6e61 6c5f 6466 5b74        final_df[t
+00063ee0: 6172 6765 7476 6172 5d20 3d20 6461 7461  argetvar] = data
+00063ef0: 5b74 6172 6765 7476 6172 5d2e 7661 6c75  [targetvar].valu
+00063f00: 6573 0d0a 2020 2020 2020 2020 2323 2323  es..        ####
+00063f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00063f40: 230d 0a20 2020 2020 2020 2072 6574 7572  #..        retur
+00063f50: 6e20 6669 6e61 6c5f 7465 7874 5f76 6172  n final_text_var
+00063f60: 732c 206c 6d5f 702c 2066 696e 616c 5f64  s, lm_p, final_d
+00063f70: 662c 206d 642c 2066 696e 616c 5f78 5f76  f, md, final_x_v
+00063f80: 6172 732c 6665 6174 7572 655f 7876 6172  ars,feature_xvar
+00063f90: 5f64 6963 740d 0a20 2020 2065 6c73 653a  _dict..    else:
+00063fa0: 0d0a 2020 2020 2020 2020 2323 2323 204a  ..        #### J
+00063fb0: 7573 7420 7265 7475 726e 2074 6865 2074  ust return the t
+00063fc0: 7261 6e73 666f 726d 6564 2064 6174 6166  ransformed dataf
+00063fd0: 7261 6d65 2077 6974 6820 616c 6c20 6f72  rame with all or
+00063fe0: 6967 2b70 6f6c 792b 696e 7478 6e20 7661  ig+poly+intxn va
+00063ff0: 7273 0d0a 2020 2020 2020 2020 6669 6e61  rs..        fina
+00064000: 6c5f 6466 203d 206d 642e 7472 616e 7366  l_df = md.transf
+00064010: 6f72 6d28 6461 7461 5b70 7265 6469 6374  orm(data[predict
+00064020: 6f72 735d 290d 0a20 2020 2020 2020 2069  ors])..        i
+00064030: 6620 4c6f 6f73 6556 6572 7369 6f6e 2873  f LooseVersion(s
+00064040: 6b6c 6561 726e 2e5f 5f76 6572 7369 6f6e  klearn.__version
+00064050: 5f5f 2920 3c3d 204c 6f6f 7365 5665 7273  __) <= LooseVers
+00064060: 696f 6e28 2730 2e32 342e 3227 293a 0d0a  ion('0.24.2'):..
+00064070: 2020 2020 2020 2020 2020 2020 2320 5065              # Pe
+00064080: 7266 6f72 6d20 6163 7469 6f6e 2066 6f72  rform action for
+00064090: 2073 6369 6b69 742d 6c65 6172 6e20 7665   scikit-learn ve
+000640a0: 7273 696f 6e20 6265 6c6f 7720 302e 3234  rsion below 0.24
+000640b0: 2e32 0d0a 2020 2020 2020 2020 2020 2020  .2..            
+000640c0: 2320 4164 6420 796f 7572 2063 6f64 6520  # Add your code 
+000640d0: 6865 7265 2066 6f72 2073 6369 6b69 742d  here for scikit-
+000640e0: 6c65 6172 6e20 7665 7273 696f 6e20 6265  learn version be
+000640f0: 6c6f 7720 302e 3234 2e32 0d0a 2020 2020  low 0.24.2..    
+00064100: 2020 2020 2020 2020 786e 616d 6573 203d          xnames =
+00064110: 206d 642e 6765 745f 6665 6174 7572 655f   md.get_feature_
+00064120: 6e61 6d65 7328 290d 0a20 2020 2020 2020  names()..       
+00064130: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00064140: 2020 2020 2320 5065 7266 6f72 6d20 6163      # Perform ac
+00064150: 7469 6f6e 2066 6f72 2073 6369 6b69 742d  tion for scikit-
+00064160: 6c65 6172 6e20 7665 7273 696f 6e20 302e  learn version 0.
+00064170: 3234 2e32 2061 6e64 2061 626f 7665 0d0a  24.2 and above..
+00064180: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
+00064190: 6420 796f 7572 2063 6f64 6520 6865 7265  d your code here
+000641a0: 2066 6f72 2073 6369 6b69 742d 6c65 6172   for scikit-lear
+000641b0: 6e20 7665 7273 696f 6e20 302e 3234 2e32  n version 0.24.2
+000641c0: 2061 6e64 2061 626f 7665 0d0a 2020 2020   and above..    
+000641d0: 2020 2020 2020 2020 786e 616d 6573 203d          xnames =
+000641e0: 206d 642e 6765 745f 6665 6174 7572 655f   md.get_feature_
+000641f0: 6e61 6d65 735f 6f75 7428 292e 746f 6c69  names_out().toli
+00064200: 7374 2829 2023 2323 2078 6e61 6d65 7320  st() ### xnames 
+00064210: 636f 6e74 6169 6e73 2061 6c6c 2078 2d6f  contains all x-o
+00064220: 6e6c 792c 2050 6f6c 7920 616e 6420 496e  nly, Poly and In
+00064230: 7478 6e20 7661 7269 6162 6c65 7320 696e  txn variables in
+00064240: 2078 2d66 6f72 6d61 740d 0a20 2020 2020   x-format..     
+00064250: 2020 2066 696e 616c 5f64 6620 3d20 7064     final_df = pd
+00064260: 2e44 6174 6146 7261 6d65 2866 696e 616c  .DataFrame(final
+00064270: 5f64 662c 696e 6465 783d 6f72 6967 5f64  _df,index=orig_d
+00064280: 6174 615f 696e 6465 782c 2063 6f6c 756d  ata_index, colum
+00064290: 6e73 3d78 6e61 6d65 7329 0d0a 2020 2020  ns=xnames)..    
+000642a0: 2020 2020 7265 7475 726e 2070 7265 6469      return predi
+000642b0: 6374 6f72 732c 206c 6d2c 2066 696e 616c  ctors, lm, final
+000642c0: 5f64 662c 206d 642c 2078 6e61 6d65 732c  _df, md, xnames,
+000642d0: 2022 220d 0a23 2323 2323 2323 2323 2323   ""..###########
+000642e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000642f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064320: 2323 2323 2323 230d 0a23 2320 496d 706f  #######..## Impo
+00064330: 7274 2073 6b6c 6561 726e 0d0a 6672 6f6d  rt sklearn..from
+00064340: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00064350: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00064360: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00064370: 4b46 6f6c 642c 2053 7472 6174 6966 6965  KFold, Stratifie
+00064380: 644b 466f 6c64 0d0a 6465 6620 7072 696e  dKFold..def prin
+00064390: 745f 6d6f 6465 6c5f 6d65 7472 6963 7328  t_model_metrics(
+000643a0: 6d6f 6465 6c74 7970 652c 7265 672c 582c  modeltype,reg,X,
+000643b0: 792c 6669 745f 666c 6167 3d46 616c 7365  y,fit_flag=False
+000643c0: 2c76 6572 626f 7365 3d31 293a 0d0a 2020  ,verbose=1):..  
+000643d0: 2020 2323 2320 4966 2066 6974 5f66 6c61    ### If fit_fla
+000643e0: 6720 6973 2073 6574 2074 6f20 5472 7565  g is set to True
+000643f0: 2c20 7468 656e 2079 6f75 206d 7573 7420  , then you must 
+00064400: 7265 7475 726e 2061 2066 6974 7465 6420  return a fitted 
+00064410: 6d6f 6465 6c20 2323 230d 0a20 2020 2023  model ###..    #
+00064420: 2323 2020 2045 6c73 6520 796f 7520 6d75  ##   Else you mu
+00064430: 7374 2072 6574 7572 6e20 7468 6520 6376  st return the cv
+00064440: 5f73 636f 7265 732e 6d65 616e 206f 6e6c  _scores.mean onl
+00064450: 7920 2323 2323 0d0a 2020 2020 6e5f 7370  y ####..    n_sp
+00064460: 6c69 7473 203d 2035 0d0a 2020 2020 6966  lits = 5..    if
+00064470: 2076 6572 626f 7365 3e30 3a0d 0a20 2020   verbose>0:..   
+00064480: 2020 2020 2070 7269 6e74 2822 4d6f 6465       print("Mode
+00064490: 6c20 5265 706f 7274 203a 2229 0d0a 2020  l Report :")..  
+000644a0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+000644b0: 204e 756d 6265 7220 6f66 2056 6172 6961   Number of Varia
+000644c0: 626c 6573 203d 2027 2c58 2e73 6861 7065  bles = ',X.shape
+000644d0: 5b31 5d29 0d0a 2020 2020 6966 206d 6f64  [1])..    if mod
+000644e0: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
+000644f0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
+00064500: 2073 6376 203d 204b 466f 6c64 286e 5f73   scv = KFold(n_s
+00064510: 706c 6974 733d 6e5f 7370 6c69 7473 290d  plits=n_splits).
+00064520: 0a20 2020 2020 2020 2023 7065 7266 6f72  .        #perfor
+00064530: 6d73 2063 726f 7373 2076 616c 6964 6174  ms cross validat
+00064540: 696f 6e0d 0a20 2020 2020 2020 2063 765f  ion..        cv_
+00064550: 7363 6f72 6573 203d 2063 726f 7373 5f76  scores = cross_v
+00064560: 616c 5f73 636f 7265 2872 6567 2c58 2c79  al_score(reg,X,y
+00064570: 2e76 616c 7565 732e 7261 7665 6c28 292c  .values.ravel(),
+00064580: 6376 3d73 6376 2c73 636f 7269 6e67 3d27  cv=scv,scoring='
+00064590: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
+000645a0: 5f65 7272 6f72 2729 0d0a 2020 2020 2020  _error')..      
+000645b0: 2020 6376 5f73 636f 7265 7320 3d20 6e70    cv_scores = np
+000645c0: 2e73 7172 7428 6e70 2e61 6273 2863 765f  .sqrt(np.abs(cv_
+000645d0: 7363 6f72 6573 2929 0d0a 2020 2020 2020  scores))..      
+000645e0: 2020 6966 2076 6572 626f 7365 3a0d 0a20    if verbose:.. 
+000645f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00064600: 2822 2020 2020 4356 2052 4d53 4520 5363  ("    CV RMSE Sc
+00064610: 6f72 6520 3a20 252e 3467 202b 2f2d 2025  ore : %.4g +/- %
+00064620: 2e34 6720 7c20 4d69 6e20 3d20 252e 3467  .4g | Min = %.4g
+00064630: 207c 204d 6178 203d 2025 2e34 6722 2025   | Max = %.4g" %
+00064640: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00064650: 2020 206e 702e 6d65 616e 2863 765f 7363     np.mean(cv_sc
+00064660: 6f72 6573 292c 6e70 2e73 7464 2863 765f  ores),np.std(cv_
+00064670: 7363 6f72 6573 292c 0d0a 2020 2020 2020  scores),..      
+00064680: 2020 2020 2020 2020 2020 206e 702e 6d69             np.mi
+00064690: 6e28 6376 5f73 636f 7265 7329 2c6e 702e  n(cv_scores),np.
+000646a0: 6d61 7828 6376 5f73 636f 7265 7329 2929  max(cv_scores)))
+000646b0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+000646c0: 2020 2020 2073 6376 203d 2053 7472 6174       scv = Strat
+000646d0: 6966 6965 644b 466f 6c64 286e 5f73 706c  ifiedKFold(n_spl
+000646e0: 6974 733d 6e5f 7370 6c69 7473 2c20 7261  its=n_splits, ra
+000646f0: 6e64 6f6d 5f73 7461 7465 3d30 2c20 7368  ndom_state=0, sh
+00064700: 7566 666c 653d 5472 7565 290d 0a20 2020  uffle=True)..   
+00064710: 2020 2020 2023 2323 2075 7365 2046 3120       ### use F1 
+00064720: 7765 6967 6874 6564 2073 696e 6365 2069  weighted since i
+00064730: 7420 776f 726b 7320 6f6e 206d 756c 7469  t works on multi
+00064740: 706c 6520 636c 6173 7365 7320 6173 2077  ple classes as w
+00064750: 656c 6c20 6173 2062 696e 6172 7920 2323  ell as binary ##
+00064760: 0d0a 2020 2020 2020 2020 6376 5f73 636f  ..        cv_sco
+00064770: 7265 7320 3d20 6372 6f73 735f 7661 6c5f  res = cross_val_
+00064780: 7363 6f72 6528 7265 672c 582c 792e 7661  score(reg,X,y.va
+00064790: 6c75 6573 2e72 6176 656c 2829 2c63 763d  lues.ravel(),cv=
+000647a0: 7363 762c 7363 6f72 696e 673d 2766 315f  scv,scoring='f1_
+000647b0: 7765 6967 6874 6564 2729 0d0a 2020 2020  weighted')..    
+000647c0: 2020 2020 6966 2076 6572 626f 7365 3e30      if verbose>0
+000647d0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+000647e0: 7269 6e74 2822 2020 2020 4356 2057 6569  rint("    CV Wei
+000647f0: 6768 7465 6420 4631 2053 636f 7265 203a  ghted F1 Score :
+00064800: 2025 2e34 6720 2b2f 2d20 252e 3467 207c   %.4g +/- %.4g |
+00064810: 204d 696e 203d 2025 2e34 6720 7c20 4d61   Min = %.4g | Ma
+00064820: 7820 3d20 252e 3467 2220 2520 280d 0a20  x = %.4g" % (.. 
+00064830: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00064840: 702e 6d65 616e 2863 765f 7363 6f72 6573  p.mean(cv_scores
+00064850: 292c 6e70 2e73 7464 2863 765f 7363 6f72  ),np.std(cv_scor
+00064860: 6573 292c 0d0a 2020 2020 2020 2020 2020  es),..          
+00064870: 2020 2020 2020 206e 702e 6d69 6e28 6376         np.min(cv
+00064880: 5f73 636f 7265 7329 2c6e 702e 6d61 7828  _scores),np.max(
+00064890: 6376 5f73 636f 7265 7329 2929 0d0a 2020  cv_scores)))..  
+000648a0: 2020 6966 2066 6974 5f66 6c61 673a 0d0a    if fit_flag:..
+000648b0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+000648c0: 6567 2e66 6974 2858 2c79 292c 2020 6376  eg.fit(X,y),  cv
+000648d0: 5f73 636f 7265 732e 6d65 616e 2829 0d0a  _scores.mean()..
+000648e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000648f0: 2020 2072 6574 7572 6e20 2063 765f 7363     return  cv_sc
+00064900: 6f72 6573 2e6d 6561 6e28 290d 0a23 2323  ores.mean()..###
+00064910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064960: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+00064970: 2073 656c 6563 745f 6265 7374 5f76 6172   select_best_var
+00064980: 6961 626c 6573 286d 642c 2072 6567 2c20  iables(md, reg, 
+00064990: 6466 2c6e 616d 6573 2c6e 5f6f 7269 675f  df,names,n_orig_
+000649a0: 6665 6174 7572 6573 2c41 6464 5f50 6f6c  features,Add_Pol
+000649b0: 792c 7665 7262 6f73 653d 3029 3a0d 0a20  y,verbose=0):.. 
+000649c0: 2020 2022 2222 0d0a 2020 2020 5468 6973     """..    This
+000649d0: 2070 726f 6772 616d 2073 656c 6563 7473   program selects
+000649e0: 2074 6865 2074 6f70 2031 3025 206f 6620   the top 10% of 
+000649f0: 696e 7465 7261 6374 696f 6e20 7661 7269  interaction vari
+00064a00: 6162 6c65 7320 6372 6561 7465 6420 7573  ables created us
+00064a10: 696e 6720 6c69 6e65 6172 206d 6f64 656c  ing linear model
+00064a20: 696e 672e 0d0a 2020 2020 2222 220d 0a20  ing...    """.. 
+00064a30: 2020 2064 6639 3020 3d20 6466 5b61 6273     df90 = df[abs
+00064a40: 2864 665b 2743 6f65 6666 6963 6965 6e74  (df['Coefficient
+00064a50: 2056 616c 7565 7327 5d29 3e3d 6466 5b27   Values'])>=df['
+00064a60: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
+00064a70: 6573 275d 2e71 7561 6e74 696c 6528 302e  es'].quantile(0.
+00064a80: 3930 295d 0d0a 2020 2020 6966 2076 6572  90)]..    if ver
+00064a90: 626f 7365 203e 3d20 313a 0d0a 2020 2020  bose >= 1:..    
+00064aa0: 2020 2020 6466 3930 2e70 6c6f 7428 0d0a      df90.plot(..
+00064ab0: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
+00064ac0: 3d27 6261 7227 2c78 3d27 496e 7465 7261  ='bar',x='Intera
+00064ad0: 6374 696f 6e20 5661 7269 6162 6c65 204e  ction Variable N
+00064ae0: 616d 6573 272c 793d 2743 6f65 6666 6963  ames',y='Coeffic
+00064af0: 6965 6e74 2056 616c 7565 7327 2c0d 0a20  ient Values',.. 
+00064b00: 2020 2020 2020 2020 2020 2074 6974 6c65             title
+00064b10: 3d27 546f 7020 3130 2520 5661 7269 6162  ='Top 10% Variab
+00064b20: 6c65 2049 6e74 6572 6163 7469 6f6e 7320  le Interactions 
+00064b30: 616e 6420 7468 6569 7220 436f 6566 6669  and their Coeffi
+00064b40: 6369 656e 7473 2027 290d 0a20 2020 2069  cients ')..    i
+00064b50: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
+00064b60: 0a20 2020 2020 2020 2064 662e 706c 6f74  .        df.plot
+00064b70: 286b 696e 643d 2762 6172 272c 783d 2749  (kind='bar',x='I
+00064b80: 6e74 6572 6163 7469 6f6e 2056 6172 6961  nteraction Varia
+00064b90: 626c 6520 4e61 6d65 7327 2c79 3d27 436f  ble Names',y='Co
+00064ba0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
+00064bb0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00064bc0: 2020 2020 7469 746c 653d 2741 6c6c 2056      title='All V
+00064bd0: 6172 6961 626c 6520 496e 7465 7261 6374  ariable Interact
+00064be0: 696f 6e73 2061 6e64 2074 6865 6972 2043  ions and their C
+00064bf0: 6f65 6666 6963 6965 6e74 7327 2c66 6967  oefficients',fig
+00064c00: 7369 7a65 3d28 3230 2c31 3029 290d 0a20  size=(20,10)).. 
+00064c10: 2020 2069 6e74 6572 6163 7469 6f6e 7320     interactions 
+00064c20: 3d20 6466 3930 5b27 496e 7465 7261 6374  = df90['Interact
+00064c30: 696f 6e20 5661 7269 6162 6c65 204e 616d  ion Variable Nam
+00064c40: 6573 275d 2e76 616c 7565 732e 746f 6c69  es'].values.toli
+00064c50: 7374 2829 0d0a 2020 2020 7072 696e 7428  st()..    print(
+00064c60: 2725 6420 496e 7465 7261 6374 696f 6e20  '%d Interaction 
+00064c70: 616e 6420 506f 6c79 6e6f 6d69 616c 2076  and Polynomial v
+00064c80: 6172 6961 626c 6528 7329 2073 656c 6563  ariable(s) selec
+00064c90: 7465 642e 2e2e 5c6e 2720 256c 656e 2869  ted...\n' %len(i
+00064ca0: 6e74 6572 6163 7469 6f6e 7329 290d 0a20  nteractions)).. 
+00064cb0: 2020 2066 696e 616c 7661 7273 203d 206e     finalvars = n
+00064cc0: 616d 6573 202b 2069 6e74 6572 6163 7469  ames + interacti
+00064cd0: 6f6e 730d 0a20 2020 2023 6669 6e61 6c76  ons..    #finalv
+00064ce0: 6172 735f 696e 6465 7820 3d20 5b64 665b  ars_index = [df[
+00064cf0: 6466 5b27 496e 7465 7261 6374 696f 6e20  df['Interaction 
+00064d00: 5661 7269 6162 6c65 204e 616d 6573 275d  Variable Names']
+00064d10: 3d3d 785d 2e69 6e64 6578 5b30 5d20 666f  ==x].index[0] fo
+00064d20: 7220 7820 696e 2066 696e 616c 7661 7273  r x in finalvars
+00064d30: 5d0d 0a20 2020 2072 6574 7572 6e20 6669  ]..    return fi
+00064d40: 6e61 6c76 6172 730d 0a23 2323 2323 2323  nalvars..#######
+00064d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064da0: 2323 2323 2323 230d 0a66 726f 6d20 736b  #######..from sk
+00064db0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00064dc0: 706f 7274 2072 6f63 5f63 7572 7665 2c20  port roc_curve, 
+00064dd0: 6175 630d 0a66 726f 6d20 7363 6970 7920  auc..from scipy 
+00064de0: 696d 706f 7274 2069 6e74 6572 700d 0a69  import interp..i
+00064df0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+00064e00: 7064 0d0a 6465 6620 4472 6177 5f52 4f43  pd..def Draw_ROC
+00064e10: 5f4d 435f 4d4c 286d 6f64 656c 2c20 585f  _MC_ML(model, X_
+00064e20: 7465 7374 2c20 795f 7472 7565 2c20 7461  test, y_true, ta
+00064e30: 7267 6574 2c20 6d6f 6465 6c5f 6e61 6d65  rget, model_name
+00064e40: 2c20 7665 7262 6f73 653d 3029 3a0d 0a20  , verbose=0):.. 
+00064e50: 2020 2066 6967 7369 7a65 203d 2028 3130     figsize = (10
+00064e60: 2c20 3629 0d0a 2020 2020 795f 7072 6f62  , 6)..    y_prob
+00064e70: 6120 3d20 6d6f 6465 6c2e 7072 6564 6963  a = model.predic
+00064e80: 745f 7072 6f62 6128 585f 7465 7374 290d  t_proba(X_test).
+00064e90: 0a20 2020 2070 7265 6469 6374 6564 203d  .    predicted =
+00064ea0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
+00064eb0: 5f70 726f 6261 290d 0a20 2020 2074 6872  _proba)..    thr
+00064ec0: 6573 686f 6c64 203d 2030 2e35 300d 0a20  eshold = 0.50.. 
+00064ed0: 2020 2079 5f70 7265 6420 3d20 6d6f 6465     y_pred = mode
+00064ee0: 6c2e 7072 6564 6963 7428 585f 7465 7374  l.predict(X_test
+00064ef0: 290d 0a20 2020 2066 7072 203d 2064 6963  )..    fpr = dic
+00064f00: 7428 290d 0a20 2020 2074 7072 203d 2064  t()..    tpr = d
+00064f10: 6963 7428 290d 0a20 2020 2072 6f63 5f61  ict()..    roc_a
+00064f20: 7563 203d 2064 6963 7428 290d 0a20 2020  uc = dict()..   
+00064f30: 2069 7465 7261 7469 6f6e 7320 3d20 300d   iterations = 0.
+00064f40: 0a20 2020 2072 6172 655f 636c 6173 7320  .    rare_class 
+00064f50: 3d20 6669 6e64 5f72 6172 655f 636c 6173  = find_rare_clas
+00064f60: 7328 795f 7472 7565 290d 0a20 2020 2069  s(y_true)..    i
+00064f70: 6620 6973 696e 7374 616e 6365 2874 6172  f isinstance(tar
+00064f80: 6765 742c 7374 7229 3a0d 0a20 2020 2020  get,str):..     
+00064f90: 2020 2074 6172 6765 7420 3d20 5b74 6172     target = [tar
+00064fa0: 6765 745d 0d0a 2020 2020 666f 7220 7461  get]..    for ta
+00064fb0: 7267 2069 6e20 7461 7267 6574 3a0d 0a20  rg in target:.. 
+00064fc0: 2020 2020 2020 2069 6620 6c65 6e28 6c65         if len(le
+00064fd0: 6674 5f73 7562 7472 6163 7428 6e70 2e75  ft_subtract(np.u
+00064fe0: 6e69 7175 6528 795f 7472 7565 292c 6e70  nique(y_true),np
+00064ff0: 2e75 6e69 7175 6528 795f 7072 6564 2929  .unique(y_pred))
+00065000: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
+00065010: 2020 2020 2063 6c61 7373 6573 203d 206c       classes = l
+00065020: 6973 7428 7261 6e67 6528 6c65 6e28 6e70  ist(range(len(np
+00065030: 2e75 6e69 7175 6528 795f 7472 7565 2929  .unique(y_true))
+00065040: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+00065050: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+00065060: 6c61 7373 6573 203d 206c 6973 7428 7261  lasses = list(ra
+00065070: 6e67 6528 6c65 6e28 6e70 2e75 6e69 7175  nge(len(np.uniqu
+00065080: 6528 795f 7072 6564 2929 2929 0d0a 2020  e(y_pred))))..  
+00065090: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
+000650a0: 3d20 6c65 6e28 636c 6173 7365 7329 0d0a  = len(classes)..
+000650b0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+000650c0: 5f6e 616d 652e 6c6f 7765 7228 2920 3d3d  _name.lower() ==
+000650d0: 2027 6361 7462 6f6f 7374 273a 0d0a 2020   'catboost':..  
+000650e0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+000650f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065100: 795f 7072 6564 203d 2028 795f 7072 6f62  y_pred = (y_prob
+00065110: 613e 302e 3529 2e61 7374 7970 6528 696e  a>0.5).astype(in
+00065120: 7429 2e64 6f74 2863 6c61 7373 6573 290d  t).dot(classes).
+00065130: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00065140: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00065150: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00065160: 2020 2020 6966 206e 5f63 6c61 7373 6573      if n_classes
+00065170: 203d 3d20 323a 0d0a 2020 2020 2020 2020   == 2:..        
+00065180: 2020 2020 2323 2320 416c 7761 7973 2073      ### Always s
+00065190: 6574 2072 6172 655f 636c 6173 7320 746f  et rare_class to
+000651a0: 2031 2077 6865 6e20 7468 6572 6520 6172   1 when there ar
+000651b0: 6520 6f6e 6c79 2032 2063 6c61 7373 6573  e only 2 classes
+000651c0: 2066 6f72 2064 7261 7769 6e67 2052 4f43   for drawing ROC
+000651d0: 2043 7572 7665 210d 0a20 2020 2020 2020   Curve!..       
+000651e0: 2020 2020 2079 5f74 6573 7420 3d20 636f       y_test = co
+000651f0: 7079 2e64 6565 7063 6f70 7928 795f 7472  py.deepcopy(y_tr
+00065200: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
+00065210: 2070 7265 6469 6374 6564 205b 3a2c 305d   predicted [:,0]
+00065220: 203d 2028 7072 6564 6963 7465 6420 5b3a   = (predicted [:
+00065230: 2c30 5d20 3e3d 2028 312d 6d5f 7468 7265  ,0] >= (1-m_thre
+00065240: 7368 2929 2e61 7374 7970 6528 2769 6e74  sh)).astype('int
+00065250: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00065260: 7072 6564 6963 7465 6420 5b3a 2c31 5d20  predicted [:,1] 
+00065270: 3d20 2870 7265 6469 6374 6564 205b 3a2c  = (predicted [:,
+00065280: 315d 203e 2074 6872 6573 686f 6c64 292e  1] > threshold).
+00065290: 6173 7479 7065 2827 696e 7427 290d 0a20  astype('int').. 
+000652a0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+000652b0: 6420 3d20 7072 6564 6963 7465 645b 3a2c  d = predicted[:,
+000652c0: 7261 7265 5f63 6c61 7373 5d0d 0a20 2020  rare_class]..   
+000652d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000652e0: 2020 2020 2020 2020 795f 7465 7374 203d          y_test =
+000652f0: 206c 6162 656c 5f62 696e 6172 697a 6528   label_binarize(
+00065300: 795f 7472 7565 2c20 636c 6173 7365 7329  y_true, classes)
+00065310: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+00065320: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00065330: 5f63 6c61 7373 6573 203e 2032 3a0d 0a20  _classes > 2:.. 
+00065340: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00065350: 6620 795f 7465 7374 2e73 6861 7065 5b31  f y_test.shape[1
+00065360: 5d20 3d3d 2079 5f70 726f 6261 2e73 6861  ] == y_proba.sha
+00065370: 7065 5b31 5d3a 0d0a 2020 2020 2020 2020  pe[1]:..        
+00065380: 2020 2020 2020 2020 2020 2020 636c 6173              clas
+00065390: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
+000653a0: 2879 5f74 6573 742e 7368 6170 655b 315d  (y_test.shape[1]
+000653b0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+000653c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000653d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000653e0: 6620 795f 7072 6f62 612e 7368 6170 655b  f y_proba.shape[
+000653f0: 315d 203e 2079 5f74 6573 742e 7368 6170  1] > y_test.shap
+00065400: 655b 315d 3a0d 0a20 2020 2020 2020 2020  e[1]:..         
+00065410: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00065420: 6c61 7373 6573 203d 206c 6973 7428 7261  lasses = list(ra
+00065430: 6e67 6528 795f 7072 6f62 612e 7368 6170  nge(y_proba.shap
+00065440: 655b 315d 2929 0d0a 2020 2020 2020 2020  e[1]))..        
+00065450: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00065460: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00065470: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+00065480: 6573 203d 206c 6973 7428 7261 6e67 6528  es = list(range(
+00065490: 795f 7465 7374 2e73 6861 7065 5b31 5d29  y_test.shape[1])
+000654a0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+000654b0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+000654c0: 7061 7373 0d0a 2020 2020 2020 2020 6966  pass..        if
+000654d0: 206e 5f63 6c61 7373 6573 203d 3d20 323a   n_classes == 2:
+000654e0: 0d0a 2020 2020 2020 2020 2020 2020 6974  ..            it
+000654f0: 6572 6174 696f 6e73 203d 2031 0d0a 2020  erations = 1..  
+00065500: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00065510: 2020 2020 2020 2020 2069 7465 7261 7469           iterati
+00065520: 6f6e 7320 3d20 636f 7079 2e64 6565 7063  ons = copy.deepc
+00065530: 6f70 7928 6e5f 636c 6173 7365 7329 0d0a  opy(n_classes)..
+00065540: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+00065550: 2323 2323 2323 2323 2323 2323 2320 2020  #############   
+00065560: 5468 6973 2069 7320 7768 6572 6520 796f  This is where yo
+00065570: 7520 6361 6c63 756c 6174 6520 524f 435f  u calculate ROC_
+00065580: 4155 4320 666f 7220 616c 6c20 636c 6173  AUC for all clas
+00065590: 7365 7320 2323 2323 2323 2323 230d 0a20  ses #########.. 
+000655a0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000655b0: 7261 6e67 6528 6974 6572 6174 696f 6e73  range(iterations
+000655c0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000655d0: 6966 206e 5f63 6c61 7373 6573 3d3d 323a  if n_classes==2:
+000655e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000655f0: 2020 6670 725b 7261 7265 5f63 6c61 7373    fpr[rare_class
+00065600: 5d2c 2074 7072 5b72 6172 655f 636c 6173  ], tpr[rare_clas
+00065610: 735d 2c20 5f20 3d20 726f 635f 6375 7276  s], _ = roc_curv
+00065620: 6528 795f 7465 7374 2e72 6176 656c 2829  e(y_test.ravel()
+00065630: 2c20 795f 7072 6f62 615b 3a2c 7261 7265  , y_proba[:,rare
+00065640: 5f63 6c61 7373 5d29 0d0a 2020 2020 2020  _class])..      
+00065650: 2020 2020 2020 2020 2020 726f 635f 6175            roc_au
+00065660: 635b 7261 7265 5f63 6c61 7373 5d20 3d20  c[rare_class] = 
+00065670: 6175 6328 6670 725b 7261 7265 5f63 6c61  auc(fpr[rare_cla
+00065680: 7373 5d2c 2074 7072 5b72 6172 655f 636c  ss], tpr[rare_cl
+00065690: 6173 735d 290d 0a20 2020 2020 2020 2020  ass])..         
+000656a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000656b0: 2020 2020 2020 2020 2020 6670 725b 695d            fpr[i]
+000656c0: 2c20 7470 725b 695d 2c20 5f20 3d20 726f  , tpr[i], _ = ro
+000656d0: 635f 6375 7276 6528 795f 7465 7374 5b3a  c_curve(y_test[:
+000656e0: 2c69 5d2c 2079 5f70 726f 6261 5b3a 2c69  ,i], y_proba[:,i
+000656f0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00065700: 2020 2020 726f 635f 6175 635b 695d 203d      roc_auc[i] =
+00065710: 2061 7563 2866 7072 5b69 5d2c 2074 7072   auc(fpr[i], tpr
+00065720: 5b69 5d29 0d0a 2020 2020 2020 2020 2323  [i])..        ##
+00065730: 2320 436f 6d70 7574 6520 4d69 6372 6f20  # Compute Micro 
+00065740: 4176 6572 6167 6520 7768 6963 6820 6973  Average which is
+00065750: 2061 2072 6f77 2d62 792d 726f 7720 7363   a row-by-row sc
+00065760: 6f72 6520 2323 2323 2323 2323 2323 230d  ore ###########.
+00065770: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
+00065780: 2020 2020 2020 2020 2020 2069 6620 6e5f             if n_
+00065790: 636c 6173 7365 7320 3d3d 2032 3a0d 0a20  classes == 2:.. 
+000657a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000657b0: 7072 5b22 6d69 6372 6f22 5d2c 2074 7072  pr["micro"], tpr
+000657c0: 5b22 6d69 6372 6f22 5d2c 205f 203d 2072  ["micro"], _ = r
+000657d0: 6f63 5f63 7572 7665 2879 5f74 6573 742e  oc_curve(y_test.
+000657e0: 7261 7665 6c28 292c 2079 5f70 7265 642e  ravel(), y_pred.
+000657f0: 7261 7665 6c28 2929 0d0a 2020 2020 2020  ravel())..      
+00065800: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00065810: 2020 2020 2020 2020 2020 2020 2066 7072               fpr
+00065820: 5b22 6d69 6372 6f22 5d2c 2074 7072 5b22  ["micro"], tpr["
+00065830: 6d69 6372 6f22 5d2c 205f 203d 2072 6f63  micro"], _ = roc
+00065840: 5f63 7572 7665 2879 5f74 6573 742e 7261  _curve(y_test.ra
+00065850: 7665 6c28 292c 6c61 6265 6c5f 6269 6e61  vel(),label_bina
+00065860: 7269 7a65 2879 5f70 7265 642c 2063 6c61  rize(y_pred, cla
+00065870: 7373 6573 292e 7261 7665 6c28 2929 0d0a  sses).ravel())..
+00065880: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+00065890: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000658a0: 795f 7465 7374 2e72 6176 656c 2829 2e73  y_test.ravel().s
+000658b0: 6861 7065 5b30 5d20 213d 2079 5f70 7265  hape[0] != y_pre
+000658c0: 642e 7261 7665 6c28 292e 7368 6170 655b  d.ravel().shape[
+000658d0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+000658e0: 2020 2020 2066 7072 5b22 6d69 6372 6f22       fpr["micro"
+000658f0: 5d2c 2074 7072 5b22 6d69 6372 6f22 5d2c  ], tpr["micro"],
+00065900: 205f 203d 2072 6f63 5f63 7572 7665 2879   _ = roc_curve(y
+00065910: 5f74 6573 745b 3a2c 3a6e 5f63 6c61 7373  _test[:,:n_class
+00065920: 6573 5d2e 7261 7665 6c28 292c 2079 5f70  es].ravel(), y_p
+00065930: 726f 6261 5b3a 2c3a 6e5f 636c 6173 7365  roba[:,:n_classe
+00065940: 735d 2e72 6176 656c 2829 290d 0a20 2020  s].ravel())..   
+00065950: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00065960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065970: 6670 725b 226d 6963 726f 225d 2c20 7470  fpr["micro"], tp
+00065980: 725b 226d 6963 726f 225d 2c20 5f20 3d20  r["micro"], _ = 
+00065990: 726f 635f 6375 7276 6528 795f 7465 7374  roc_curve(y_test
+000659a0: 2e72 6176 656c 2829 2c20 795f 7072 6f62  .ravel(), y_prob
+000659b0: 615b 3a2c 7261 7265 5f63 6c61 7373 5d2e  a[:,rare_class].
+000659c0: 7261 7665 6c28 2929 0d0a 2020 2020 2020  ravel())..      
+000659d0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+000659e0: 2020 2020 726f 635f 6175 635b 226d 6963      roc_auc["mic
+000659f0: 726f 225d 203d 2061 7563 2866 7072 5b22  ro"] = auc(fpr["
+00065a00: 6d69 6372 6f22 5d2c 2074 7072 5b22 6d69  micro"], tpr["mi
+00065a10: 6372 6f22 5d29 0d0a 2020 2020 2020 2020  cro"])..        
+00065a20: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00065a30: 2020 2020 2070 6173 730d 0a20 2020 2020       pass..     
+00065a40: 2020 2023 206d 6963 726f 2d61 7665 7261     # micro-avera
+00065a50: 6765 2052 4f43 2063 7572 7665 2061 6e64  ge ROC curve and
+00065a60: 2052 4f43 2061 7265 6120 6861 7320 6265   ROC area has be
+00065a70: 656e 2063 6f6d 7075 7465 640d 0a20 2020  en computed..   
+00065a80: 2020 2020 206c 6162 656c 7320 3d20 5b5d       labels = []
+00065a90: 0d0a 2020 2020 2020 2020 6966 206e 5f63  ..        if n_c
+00065aa0: 6c61 7373 6573 203c 3d20 323a 0d0a 2020  lasses <= 2:..  
+00065ab0: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00065ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00065ad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00065ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00065af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00065b00: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+00065b10: 2020 2020 2020 2320 506c 6f74 206f 6620        # Plot of 
+00065b20: 6120 524f 4320 6375 7276 6520 666f 7220  a ROC curve for 
+00065b30: 6f6e 6520 636c 6173 730d 0a20 2020 2020  one class..     
+00065b40: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+00065b50: 6528 6669 6773 697a 653d 6669 6773 697a  e(figsize=figsiz
+00065b60: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00065b70: 706c 742e 706c 6f74 2866 7072 5b72 6172  plt.plot(fpr[rar
+00065b80: 655f 636c 6173 735d 2c20 7470 725b 7261  e_class], tpr[ra
+00065b90: 7265 5f63 6c61 7373 5d2c 206c 6162 656c  re_class], label
+00065ba0: 3d27 524f 4320 6375 7276 6520 2841 5543  ='ROC curve (AUC
+00065bb0: 203d 2025 302e 3566 2927 2025 2072 6f63   = %0.5f)' % roc
+00065bc0: 5f61 7563 5b72 6172 655f 636c 6173 735d  _auc[rare_class]
+00065bd0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00065be0: 6c74 2e70 6c6f 7428 5b30 2c20 315d 2c20  lt.plot([0, 1], 
+00065bf0: 5b30 2c20 315d 2c20 276b 2d2d 2729 0d0a  [0, 1], 'k--')..
+00065c00: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00065c10: 786c 696d 285b 302e 302c 2031 2e30 5d29  xlim([0.0, 1.0])
+00065c20: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+00065c30: 742e 796c 696d 285b 302e 302c 2031 2e30  t.ylim([0.0, 1.0
+00065c40: 355d 290d 0a20 2020 2020 2020 2020 2020  5])..           
+00065c50: 2070 6c74 2e78 6c61 6265 6c28 2746 616c   plt.xlabel('Fal
+00065c60: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
+00065c70: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00065c80: 706c 742e 796c 6162 656c 2827 5472 7565  plt.ylabel('True
+00065c90: 2050 6f73 6974 6976 6520 5261 7465 2729   Positive Rate')
+00065ca0: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+00065cb0: 742e 7469 746c 6528 2752 4f43 2043 7572  t.title('ROC Cur
+00065cc0: 7665 2066 6f72 2050 7265 6469 6374 696f  ve for Predictio
+00065cd0: 6e73 206f 6e20 6865 6c64 206f 7574 2064  ns on held out d
+00065ce0: 6174 6120 666f 7220 7461 7267 6574 3a20  ata for target: 
+00065cf0: 2573 2720 2574 6172 6729 0d0a 2020 2020  %s' %targ)..    
+00065d00: 2020 2020 2020 2020 706c 742e 6c65 6765          plt.lege
+00065d10: 6e64 286c 6f63 3d22 6c6f 7765 7220 7269  nd(loc="lower ri
+00065d20: 6768 7422 290d 0a20 2020 2020 2020 2020  ght")..         
+00065d30: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
+00065d40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00065d50: 2020 2020 2020 2023 2043 6f6d 7075 7465         # Compute
+00065d60: 206d 6163 726f 2d61 7665 7261 6765 2052   macro-average R
+00065d70: 4f43 2063 7572 7665 2061 6e64 2052 4f43  OC curve and ROC
+00065d80: 2061 7265 610d 0a20 2020 2020 2020 2020   area..         
+00065d90: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00065da0: 2e73 7562 706c 6f74 7328 6669 6773 697a  .subplots(figsiz
+00065db0: 653d 6669 6773 697a 6529 0d0a 2020 2020  e=figsize)..    
+00065dc0: 2020 2020 2020 2020 636f 6c6f 7273 203d          colors =
+00065dd0: 2063 7963 6c65 2827 6279 7263 6d67 6b62   cycle('byrcmgkb
+00065de0: 7972 636d 676b 6279 7263 6d67 6b62 7972  yrcmgkbyrcmgkbyr
+00065df0: 636d 676b 2729 0d0a 2020 2020 2020 2020  cmgk')..        
+00065e00: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00065e10: 6765 2869 7465 7261 7469 6f6e 7329 3a0d  ge(iterations):.
+00065e20: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00065e30: 2020 2023 2046 6972 7374 2061 6767 7265     # First aggre
+00065e40: 6761 7465 2061 6c6c 2066 616c 7365 2070  gate all false p
+00065e50: 6f73 6974 6976 6520 7261 7465 730d 0a20  ositive rates.. 
+00065e60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00065e70: 6c6c 5f66 7072 203d 206e 702e 756e 6971  ll_fpr = np.uniq
+00065e80: 7565 286e 702e 636f 6e63 6174 656e 6174  ue(np.concatenat
+00065e90: 6528 5b66 7072 5b69 5d20 666f 7220 6920  e([fpr[i] for i 
+00065ea0: 696e 2072 616e 6765 286e 5f63 6c61 7373  in range(n_class
+00065eb0: 6573 295d 2929 0d0a 0d0a 2020 2020 2020  es)]))....      
+00065ec0: 2020 2020 2020 2020 2020 2320 5468 656e            # Then
+00065ed0: 2069 6e74 6572 706f 6c61 7465 2061 6c6c   interpolate all
+00065ee0: 2052 4f43 2063 7572 7665 7320 6174 2074   ROC curves at t
+00065ef0: 6869 7320 706f 696e 7473 0d0a 2020 2020  his points..    
+00065f00: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
+00065f10: 5f74 7072 203d 206e 702e 7a65 726f 735f  _tpr = np.zeros_
+00065f20: 6c69 6b65 2861 6c6c 5f66 7072 290d 0a20  like(all_fpr).. 
+00065f30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00065f40: 6f72 206a 2069 6e20 7261 6e67 6528 6e5f  or j in range(n_
+00065f50: 636c 6173 7365 7329 3a0d 0a20 2020 2020  classes):..     
+00065f60: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00065f70: 6561 6e5f 7470 7220 2b3d 2069 6e74 6572  ean_tpr += inter
+00065f80: 7028 616c 6c5f 6670 722c 2066 7072 5b6a  p(all_fpr, fpr[j
+00065f90: 5d2c 2074 7072 5b6a 5d29 0d0a 0d0a 2020  ], tpr[j])....  
+00065fa0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00065fb0: 4669 6e61 6c6c 7920 6176 6572 6167 6520  Finally average 
+00065fc0: 6974 2061 6e64 2063 6f6d 7075 7465 2041  it and compute A
+00065fd0: 5543 0d0a 2020 2020 2020 2020 2020 2020  UC..            
+00065fe0: 2020 2020 6d65 616e 5f74 7072 202f 3d20      mean_tpr /= 
+00065ff0: 6e5f 636c 6173 7365 730d 0a0d 0a20 2020  n_classes....   
+00066000: 2020 2020 2020 2020 2020 2020 2066 7072               fpr
+00066010: 5b22 6d61 6372 6f22 5d20 3d20 616c 6c5f  ["macro"] = all_
+00066020: 6670 720d 0a20 2020 2020 2020 2020 2020  fpr..           
+00066030: 2020 2020 2074 7072 5b22 6d61 6372 6f22       tpr["macro"
+00066040: 5d20 3d20 6d65 616e 5f74 7072 0d0a 2020  ] = mean_tpr..  
+00066050: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00066060: 635f 6175 635b 226d 6163 726f 225d 203d  c_auc["macro"] =
+00066070: 2061 7563 2866 7072 5b22 6d61 6372 6f22   auc(fpr["macro"
+00066080: 5d2c 2074 7072 5b22 6d61 6372 6f22 5d29  ], tpr["macro"])
+00066090: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000660a0: 2020 2020 2320 506c 6f74 2061 6c6c 2052      # Plot all R
+000660b0: 4f43 2063 7572 7665 730d 0a20 2020 2020  OC curves..     
+000660c0: 2020 2020 2020 2020 2020 206c 7720 3d20             lw = 
+000660d0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
+000660e0: 2020 2063 6f6c 6f72 203d 206e 6578 7428     color = next(
+000660f0: 636f 6c6f 7273 290d 0a20 2020 2020 2020  colors)..       
+00066100: 2020 2020 2020 2020 2061 782e 706c 6f74           ax.plot
+00066110: 2866 7072 5b69 5d2c 2074 7072 5b69 5d2c  (fpr[i], tpr[i],
+00066120: 2063 6f6c 6f72 3d63 6f6c 6f72 2c20 6c77   color=color, lw
+00066130: 3d6c 7729 0d0a 2020 2020 2020 2020 2020  =lw)..          
+00066140: 2020 2020 2020 6c61 6265 6c73 2e61 7070        labels.app
+00066150: 656e 6428 2752 4f43 2063 7572 7665 206f  end('ROC curve o
+00066160: 6620 636c 6173 7320 2564 2028 6172 6561  f class %d (area
+00066170: 203d 2025 302e 3266 2927 2025 2869 2c20   = %0.2f)' %(i, 
+00066180: 726f 635f 6175 635b 695d 2929 0d0a 2020  roc_auc[i]))..  
+00066190: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+000661a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000661b0: 6c61 6265 6c73 2e61 7070 656e 6428 276d  labels.append('m
+000661c0: 6963 726f 2d61 7665 7261 6765 2052 4f43  icro-average ROC
+000661d0: 2063 7572 7665 2028 6172 6561 203d 207b   curve (area = {
+000661e0: 303a 302e 3266 7d29 270d 0a20 2020 2020  0:0.2f})'..     
+000661f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066200: 2020 2020 2020 2020 2020 2727 2e66 6f72            ''.for
+00066210: 6d61 7428 726f 635f 6175 635b 226d 6963  mat(roc_auc["mic
+00066220: 726f 225d 2929 0d0a 2020 2020 2020 2020  ro"]))..        
+00066230: 2020 2020 2020 2020 6178 2e70 6c6f 7428          ax.plot(
+00066240: 6670 725b 226d 6963 726f 225d 2c20 7470  fpr["micro"], tp
+00066250: 725b 226d 6963 726f 225d 2c0d 0a20 2020  r["micro"],..   
+00066260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066270: 2020 2020 2020 636f 6c6f 723d 2764 6565        color='dee
+00066280: 7070 696e 6b27 2c20 6c69 6e65 7374 796c  ppink', linestyl
+00066290: 653d 273a 272c 206c 696e 6577 6964 7468  e=':', linewidth
+000662a0: 3d34 290d 0a20 2020 2020 2020 2020 2020  =4)..           
+000662b0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+000662c0: 2020 2020 2020 2020 2020 7061 7373 0d0a            pass..
+000662d0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+000662e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000662f0: 2020 6c61 6265 6c73 2e61 7070 656e 6428    labels.append(
+00066300: 276d 6163 726f 2d61 7665 7261 6765 2052  'macro-average R
+00066310: 4f43 2063 7572 7665 2028 6172 6561 203d  OC curve (area =
+00066320: 207b 303a 302e 3266 7d29 270d 0a20 2020   {0:0.2f})'..   
+00066330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066340: 2020 2020 2020 2020 2020 2020 2727 2e66              ''.f
+00066350: 6f72 6d61 7428 726f 635f 6175 635b 226d  ormat(roc_auc["m
+00066360: 6163 726f 225d 2929 0d0a 2020 2020 2020  acro"]))..      
+00066370: 2020 2020 2020 2020 2020 6178 2e70 6c6f            ax.plo
+00066380: 7428 6670 725b 226d 6163 726f 225d 2c20  t(fpr["macro"], 
+00066390: 7470 725b 226d 6163 726f 225d 2c0d 0a20  tpr["macro"],.. 
+000663a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000663b0: 2020 2020 2020 2020 636f 6c6f 723d 276e          color='n
+000663c0: 6176 7927 2c20 6c69 6e65 7374 796c 653d  avy', linestyle=
+000663d0: 273a 272c 206c 696e 6577 6964 7468 3d34  ':', linewidth=4
+000663e0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+000663f0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00066400: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
+00066410: 2020 2020 2020 2020 2020 6178 2e70 6c6f            ax.plo
+00066420: 7428 5b30 2c20 315d 2c20 5b30 2c20 315d  t([0, 1], [0, 1]
+00066430: 2c20 276b 2d2d 272c 206c 773d 6c77 290d  , 'k--', lw=lw).
+00066440: 0a20 2020 2020 2020 2020 2020 2061 782e  .            ax.
+00066450: 7365 745f 786c 696d 285b 302e 302c 2031  set_xlim([0.0, 1
+00066460: 2e30 5d29 0d0a 2020 2020 2020 2020 2020  .0])..          
+00066470: 2020 6178 2e73 6574 5f79 6c69 6d28 5b30    ax.set_ylim([0
+00066480: 2e30 2c20 312e 3035 5d29 0d0a 2020 2020  .0, 1.05])..    
+00066490: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
+000664a0: 6c61 6265 6c28 2746 616c 7365 2050 6f73  label('False Pos
+000664b0: 6974 6976 6520 5261 7465 2729 0d0a 2020  itive Rate')..  
+000664c0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+000664d0: 5f79 6c61 6265 6c28 2754 7275 6520 506f  _ylabel('True Po
+000664e0: 7369 7469 7665 2052 6174 6527 290d 0a20  sitive Rate').. 
+000664f0: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
+00066500: 745f 7469 746c 6528 2752 4f43 2043 7572  t_title('ROC Cur
+00066510: 7665 2066 6f72 2050 7265 6469 6374 696f  ve for Predictio
+00066520: 6e73 206f 6e20 6865 6c64 206f 7574 2064  ns on held out d
+00066530: 6174 6120 666f 7220 7461 7267 6574 3a20  ata for target: 
+00066540: 2573 2720 2574 6172 6729 0d0a 2020 2020  %s' %targ)..    
+00066550: 2020 2020 2020 2020 706c 742e 6c65 6765          plt.lege
+00066560: 6e64 286c 6162 656c 732c 6c6f 633d 226c  nd(labels,loc="l
+00066570: 6f77 6572 2072 6967 6874 2229 0d0a 2020  ower right")..  
+00066580: 2020 2020 2020 2020 2020 706c 742e 7368            plt.sh
+00066590: 6f77 2829 3b0d 0a0d 0a23 2323 2323 2323  ow();....#######
+000665a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000665b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000665c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000665d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000665e0: 2323 2323 2323 2323 2323 2323 0d0a 2320  ############..# 
+000665f0: 5265 6d6f 7665 7320 6475 706c 6963 6174  Removes duplicat
+00066600: 6573 2066 726f 6d20 6120 6c69 7374 2074  es from a list t
+00066610: 6f20 7265 7475 726e 2075 6e69 7175 6520  o return unique 
+00066620: 7661 6c75 6573 202d 2055 5345 4420 4f4e  values - USED ON
+00066630: 4c59 4f4e 4345 0d0a 6465 6620 6669 6e64  LYONCE..def find
+00066640: 5f72 656d 6f76 655f 6475 706c 6963 6174  _remove_duplicat
+00066650: 6573 2876 616c 7565 7329 3a0d 0a20 2020  es(values):..   
+00066660: 206f 7574 7075 7420 3d20 5b5d 0d0a 2020   output = []..  
+00066670: 2020 7365 656e 203d 2073 6574 2829 0d0a    seen = set()..
+00066680: 2020 2020 666f 7220 7661 6c75 6520 696e      for value in
+00066690: 2076 616c 7565 733a 0d0a 2020 2020 2020   values:..      
+000666a0: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
+000666b0: 6e20 7365 656e 3a0d 0a20 2020 2020 2020  n seen:..       
+000666c0: 2020 2020 206f 7574 7075 742e 6170 7065       output.appe
+000666d0: 6e64 2876 616c 7565 290d 0a20 2020 2020  nd(value)..     
+000666e0: 2020 2020 2020 2073 6565 6e2e 6164 6428         seen.add(
+000666f0: 7661 6c75 6529 0d0a 2020 2020 7265 7475  value)..    retu
+00066700: 726e 206f 7574 7075 740d 0a23 2323 2323  rn output..#####
+00066710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00066750: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00066760: 6465 6620 7370 6c69 745f 6461 7461 5f6e  def split_data_n
+00066770: 6577 2874 7261 696e 6669 6c65 2c20 7465  ew(trainfile, te
+00066780: 7374 6669 6c65 2c20 7461 7267 6574 2c73  stfile, target,s
+00066790: 6570 2c20 6d6f 6465 6c74 7970 653d 2752  ep, modeltype='R
+000667a0: 6567 7265 7373 696f 6e27 2c20 7261 6e64  egression', rand
+000667b0: 6f6d 7374 6174 653d 3029 3a0d 0a20 2020  omstate=0):..   
+000667c0: 2022 2222 0d0a 2020 2020 5370 6c69 7420   """..    Split 
+000667d0: 796f 7572 2066 696c 6520 6f72 2064 6174  your file or dat
+000667e0: 6120 6672 616d 6520 696e 746f 2032 206f  a frame into 2 o
+000667f0: 7220 3320 7370 6c69 7473 2e20 5374 7261  r 3 splits. Stra
+00066800: 7469 6669 6564 2062 7920 436c 6173 7320  tified by Class 
+00066810: 6175 746f 6d61 7469 6361 6c6c 792e 0d0a  automatically...
+00066820: 2020 2020 4164 6469 7469 6f6e 616c 6c79      Additionally
+00066830: 2c20 6974 2077 696c 6c20 7374 7269 7020  , it will strip 
+00066840: 6f75 7420 6e6f 6e2d 6e75 6d65 7269 6320  out non-numeric 
+00066850: 636f 6c73 2069 6e20 796f 7572 2064 6174  cols in your dat
+00066860: 6120 6966 2079 6f75 206e 6565 6420 6974  a if you need it
+00066870: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+00066880: 7261 6e64 6f6d 7374 6174 6520 3d20 3939  randomstate = 99
+00066890: 0d0a 2020 2020 2323 2323 2323 2320 436f  ..    ####### Co
+000668a0: 6465 735f 6c69 7374 2063 6f6e 7461 696e  des_list contain
+000668b0: 7320 6d75 6c74 6970 6c65 2065 6e63 6f64  s multiple encod
+000668c0: 6572 7320 7468 6174 2061 7265 2075 7365  ers that are use
+000668d0: 6420 746f 206f 7065 6e20 6120 4353 5620  d to open a CSV 
+000668e0: 6669 6c65 0d0a 2020 2020 636f 6465 735f  file..    codes_
+000668f0: 6c69 7374 203d 205b 2775 7466 2d38 272c  list = ['utf-8',
+00066900: 2769 736f 2d38 3835 392d 3127 2c27 6370  'iso-8859-1','cp
+00066910: 3132 3532 272c 276c 6174 696e 3127 5d0d  1252','latin1'].
+00066920: 0a20 2020 2073 6565 6420 3d20 3939 0d0a  .    seed = 99..
+00066930: 2020 2020 6966 2074 7970 6528 7472 6169      if type(trai
+00066940: 6e66 696c 6529 203d 3d20 7374 723a 0d0a  nfile) == str:..
+00066950: 2020 2020 2020 2020 6966 2074 7261 696e          if train
+00066960: 6669 6c65 2021 3d20 2727 3a0d 0a20 2020  file != '':..   
+00066970: 2020 2020 2020 2020 2023 2323 2320 4669           #### Fi
+00066980: 7273 7420 6c6f 6164 2074 6865 2054 7261  rst load the Tra
+00066990: 696e 2066 696c 6520 6966 2069 7420 6973  in file if it is
+000669a0: 2061 7661 696c 6162 6c65 2023 2323 2323   available #####
+000669b0: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+000669c0: 2020 2066 6f72 2063 6f64 6578 2069 6e20     for codex in 
+000669d0: 636f 6465 735f 6c69 7374 3a0d 0a20 2020  codes_list:..   
+000669e0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+000669f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066a00: 2020 2020 2020 2074 7261 696e 6466 203d         traindf =
+00066a10: 2070 642e 7265 6164 5f63 7376 2874 7261   pd.read_csv(tra
+00066a20: 696e 6669 6c65 2c73 6570 3d73 6570 2c65  infile,sep=sep,e
+00066a30: 6e63 6f64 696e 673d 636f 6465 782c 696e  ncoding=codex,in
+00066a40: 6465 785f 636f 6c3d 4e6f 6e65 290d 0a20  dex_col=None).. 
+00066a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066a60: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+00066a70: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00066a80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066a90: 2020 2020 2020 2063 6f6e 7469 6e75 650d         continue.
+00066aa0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00066ab0: 6e74 2827 5472 6169 6e20 6461 7461 2067  nt('Train data g
+00066ac0: 6976 656e 2e20 5368 6170 6520 3d20 2573  iven. Shape = %s
+00066ad0: 2720 2528 7472 6169 6e64 662e 7368 6170  ' %(traindf.shap
+00066ae0: 652c 2929 0d0a 2020 2020 2020 2020 2020  e,))..          
+00066af0: 2020 7072 696e 7428 2754 6172 6765 7420    print('Target 
+00066b00: 526f 7773 2054 7261 696e 203d 2025 6427  Rows Train = %d'
+00066b10: 2025 6c65 6e28 7472 6169 6e64 665b 7472   %len(traindf[tr
+00066b20: 6169 6e64 665b 7461 7267 6574 5d3d 3d31  aindf[target]==1
+00066b30: 5d29 290d 0a20 2020 2020 2020 2065 6c73  ]))..        els
+00066b40: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00066b50: 7072 696e 7428 2754 7261 696e 6669 6c65  print('Trainfile
+00066b60: 2069 7320 6e6f 7420 666f 756e 642e 2043   is not found. C
+00066b70: 6865 636b 2079 6f75 7220 696e 7075 7420  heck your input 
+00066b80: 6f72 2066 696c 6520 6465 7374 696e 6174  or file destinat
+00066b90: 696f 6e27 290d 0a20 2020 2020 2020 2020  ion')..         
+00066ba0: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+00066bb0: 2020 2069 6620 2074 7970 6528 7465 7374     if  type(test
+00066bc0: 6669 6c65 2920 3d3d 2073 7472 3a0d 0a20  file) == str:.. 
+00066bd0: 2020 2020 2020 2020 2020 2069 6620 7465             if te
+00066be0: 7374 6669 6c65 2021 3d20 2727 3a0d 0a20  stfile != '':.. 
+00066bf0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00066c00: 7269 6e74 2827 5472 6169 6e20 6669 6c65  rint('Train file
+00066c10: 2061 6e64 2054 6573 7420 6669 6c65 2067   and Test file g
+00066c20: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
+00066c30: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+00066c40: 4966 2074 6573 7466 696c 6520 6973 2061  If testfile is a
+00066c50: 7661 696c 6162 6c65 2c20 796f 7520 6e65  vailable, you ne
+00066c60: 6564 2074 6f20 636f 6d62 696e 6520 7472  ed to combine tr
+00066c70: 6169 6e20 616e 6420 7465 7374 2064 6174  ain and test dat
+00066c80: 6173 6574 730d 0a20 2020 2020 2020 2020  asets..         
+00066c90: 2020 2020 2020 2070 7269 6e74 2827 5472         print('Tr
+00066ca0: 6169 6e20 4461 7461 4672 616d 6520 616e  ain DataFrame an
+00066cb0: 6420 5465 7374 6669 6c65 2067 6976 656e  d Testfile given
+00066cc0: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+00066cd0: 2020 2020 2066 6f72 2063 6f64 6578 2069       for codex i
+00066ce0: 6e20 636f 6465 735f 6c69 7374 3a0d 0a20  n codes_list:.. 
+00066cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066d00: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00066d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066d20: 2074 6573 7464 6620 3d20 7064 2e72 6561   testdf = pd.rea
+00066d30: 645f 6373 7628 7465 7374 6669 6c65 2c73  d_csv(testfile,s
+00066d40: 6570 3d73 6570 2c65 6e63 6f64 696e 673d  ep=sep,encoding=
+00066d50: 636f 6465 782c 696e 6465 785f 636f 6c3d  codex,index_col=
+00066d60: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
+00066d70: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00066d80: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
+00066d90: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00066da0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066db0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00066dc0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
+00066dd0: 2020 2020 2070 7269 6e74 2827 5465 7374       print('Test
+00066de0: 2064 6174 6120 6769 7665 6e2e 2053 6861   data given. Sha
+00066df0: 7065 203d 2025 7327 2025 2874 6573 7464  pe = %s' %(testd
+00066e00: 662e 7368 6170 652c 2929 0d0a 2020 2020  f.shape,))..    
+00066e10: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00066e20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00066e30: 7269 6e74 2827 5465 7374 6669 6c65 2069  rint('Testfile i
+00066e40: 7320 6e6f 7420 6769 7665 6e2e 2043 6f6e  s not given. Con
+00066e50: 7469 6e75 696e 6727 290d 0a20 2020 2020  tinuing')..     
+00066e60: 2020 2020 2020 2020 2020 2074 6573 7464             testd
+00066e70: 6620 3d20 2727 0d0a 2020 2020 2020 2020  f = ''..        
+00066e80: 656c 6966 2074 7970 6528 7465 7374 6669  elif type(testfi
+00066e90: 6c65 2920 3d3d 2070 642e 4461 7461 4672  le) == pd.DataFr
+00066ea0: 616d 653a 0d0a 2020 2020 2020 2020 2020  ame:..          
+00066eb0: 2020 7072 696e 7428 2754 7261 696e 2066    print('Train f
+00066ec0: 696c 6520 616e 6420 5465 7374 2064 6174  ile and Test dat
+00066ed0: 6166 7261 6d65 2067 6976 656e 2e27 290d  aframe given.').
+00066ee0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
+00066ef0: 7464 6620 3d20 7465 7374 6669 6c65 5b3a  tdf = testfile[:
+00066f00: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
+00066f10: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00066f20: 696e 7428 2754 6573 7466 696c 6520 6973  int('Testfile is
+00066f30: 2075 6e6b 6e6f 776e 2074 7970 652e 2729   unknown type.')
+00066f40: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
+00066f50: 7374 6466 203d 2027 270d 0a20 2020 2065  stdf = ''..    e
+00066f60: 6c69 6620 7479 7065 2874 7261 696e 6669  lif type(trainfi
+00066f70: 6c65 2920 3d3d 2070 642e 4461 7461 4672  le) == pd.DataFr
+00066f80: 616d 653a 0d0a 2020 2020 2020 2020 7472  ame:..        tr
+00066f90: 6169 6e64 6620 3d20 7472 6169 6e66 696c  aindf = trainfil
+00066fa0: 655b 3a5d 0d0a 2020 2020 2020 2020 6966  e[:]..        if
+00066fb0: 2020 7479 7065 2874 6573 7466 696c 6529    type(testfile)
+00066fc0: 203d 3d20 7374 723a 0d0a 2020 2020 2020   == str:..      
+00066fd0: 2020 2020 2020 6966 2074 6573 7466 696c        if testfil
+00066fe0: 6520 213d 2027 273a 0d0a 2020 2020 2020  e != '':..      
+00066ff0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00067000: 2754 7261 696e 2044 6174 6146 7261 6d65  'Train DataFrame
+00067010: 2061 6e64 2054 6573 7420 6669 6c65 2067   and Test file g
+00067020: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
+00067030: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+00067040: 4966 2074 6573 7466 696c 6520 6973 2061  If testfile is a
+00067050: 7661 696c 6162 6c65 2c20 796f 7520 6e65  vailable, you ne
+00067060: 6564 2074 6f20 636f 6d62 696e 6520 7472  ed to combine tr
+00067070: 6169 6e20 616e 6420 7465 7374 2064 6174  ain and test dat
+00067080: 6173 6574 730d 0a20 2020 2020 2020 2020  asets..         
+00067090: 2020 2020 2020 2070 7269 6e74 2827 5472         print('Tr
+000670a0: 6169 6e20 4461 7461 4672 616d 6520 616e  ain DataFrame an
+000670b0: 6420 5465 7374 6669 6c65 2067 6976 656e  d Testfile given
+000670c0: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+000670d0: 2020 2020 2066 6f72 2063 6f64 6578 2069       for codex i
+000670e0: 6e20 636f 6465 735f 6c69 7374 3a0d 0a20  n codes_list:.. 
+000670f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067100: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00067110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067120: 2074 6573 7464 6620 3d20 7064 2e72 6561   testdf = pd.rea
+00067130: 645f 6373 7628 7465 7374 6669 6c65 2c73  d_csv(testfile,s
+00067140: 6570 3d73 6570 2c65 6e63 6f64 696e 673d  ep=sep,encoding=
+00067150: 636f 6465 782c 696e 6465 785f 636f 6c3d  codex,index_col=
+00067160: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
+00067170: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00067180: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
+00067190: 2020 2020 2020 2020 2020 6578 6365 7074            except
+000671a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000671b0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+000671c0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
+000671d0: 2020 2020 2070 7269 6e74 2827 5472 6169       print('Trai
+000671e0: 6e20 5368 6170 653a 2573 2054 6573 7420  n Shape:%s Test 
+000671f0: 5368 6170 653a 2025 7327 2025 2874 7261  Shape: %s' %(tra
+00067200: 696e 6466 2e73 6861 7065 2c74 6573 7464  indf.shape,testd
+00067210: 662e 7368 6170 6529 290d 0a20 2020 2020  f.shape))..     
+00067220: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00067230: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00067240: 696e 7428 274e 6f20 7465 7374 6669 6c65  int('No testfile
+00067250: 2e20 5472 6169 6e20 5368 6170 653a 2573  . Train Shape:%s
+00067260: 2720 2528 7472 6169 6e64 662e 7368 6170  ' %(traindf.shap
+00067270: 652c 2929 0d0a 2020 2020 2020 2020 2020  e,))..          
+00067280: 2020 2020 2020 7465 7374 6466 203d 2027        testdf = '
+00067290: 270d 0a20 2020 2020 2020 2065 6c69 6620  '..        elif 
+000672a0: 7479 7065 2874 6573 7466 696c 6529 203d  type(testfile) =
+000672b0: 3d20 7064 2e44 6174 6146 7261 6d65 3a0d  = pd.DataFrame:.
+000672c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+000672d0: 6e74 2827 5472 6169 6e20 4461 7461 4672  nt('Train DataFr
+000672e0: 616d 6520 616e 6420 5465 7374 2044 6174  ame and Test Dat
+000672f0: 6146 7261 6d65 2067 6976 656e 2e27 290d  aFrame given.').
+00067300: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
+00067310: 7464 6620 3d20 7465 7374 6669 6c65 5b3a  tdf = testfile[:
+00067320: 5d0d 0a20 2020 2065 6c73 653a 0d0a 2020  ]..    else:..  
+00067330: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
+00067340: 5472 6169 6e20 6f72 2054 6573 7420 6669  Train or Test fi
+00067350: 6c65 2070 726f 7669 6465 642e 2045 6e64  le provided. End
+00067360: 2e2e 2e27 290d 0a20 2020 2020 2020 2072  ...')..        r
+00067370: 6574 7572 6e0d 0a20 2020 2023 2323 2323  eturn..    #####
+00067380: 2323 2320 5468 6973 2069 7320 7768 6572  ### This is wher
+00067390: 6520 7468 6520 7370 6c69 7474 696e 6720  e the splitting 
+000673a0: 6265 6769 6e73 2023 2323 2323 2323 2323  begins #########
+000673b0: 2323 2323 2323 2323 0d0a 2020 2020 6966  ########..    if
+000673c0: 2074 6172 6765 7420 3d3d 2027 273a 0d0a   target == '':..
+000673d0: 2020 2020 2020 2020 7072 696e 7428 274e          print('N
+000673e0: 6f20 7461 7267 6574 2076 6172 6961 626c  o target variabl
+000673f0: 6520 7072 6f76 6964 6564 2e20 506c 6561  e provided. Plea
+00067400: 7365 2070 726f 7669 6465 2074 6172 6765  se provide targe
+00067410: 7420 7661 7269 6162 6c65 2729 0d0a 2020  t variable')..  
+00067420: 2020 2020 2020 7265 7475 726e 2074 7261        return tra
+00067430: 696e 6466 2c20 4e6f 6e65 2c20 4e6f 6e65  indf, None, None
+00067440: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00067450: 2020 2020 2079 203d 2074 7261 696e 6466       y = traindf
+00067460: 5b74 6172 6765 745d 0d0a 2020 2020 6966  [target]..    if
+00067470: 206d 6f64 656c 7479 7065 203d 3d20 2743   modeltype == 'C
+00067480: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+00067490: 0a20 2020 2020 2020 2069 6620 7472 6169  .        if trai
+000674a0: 6e64 662e 7368 6170 655b 305d 203c 3d20  ndf.shape[0] <= 
+000674b0: 3130 3030 3a0d 0a20 2020 2020 2020 2020  1000:..         
+000674c0: 2020 2073 7373 203d 2053 7472 6174 6966     sss = Stratif
+000674d0: 6965 6453 6875 6666 6c65 5370 6c69 7428  iedShuffleSplit(
+000674e0: 6e5f 7370 6c69 7473 3d32 2c20 7465 7374  n_splits=2, test
+000674f0: 5f73 697a 653d 302e 3330 2c20 7261 6e64  _size=0.30, rand
+00067500: 6f6d 5f73 7461 7465 3d72 616e 646f 6d73  om_state=randoms
+00067510: 7461 7465 290d 0a20 2020 2020 2020 2065  tate)..        e
+00067520: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00067530: 2020 7373 7320 3d20 5374 7261 7469 6669    sss = Stratifi
+00067540: 6564 5368 7566 666c 6553 706c 6974 286e  edShuffleSplit(n
+00067550: 5f73 706c 6974 733d 322c 2074 6573 745f  _splits=2, test_
+00067560: 7369 7a65 3d30 2e32 302c 2072 616e 646f  size=0.20, rando
+00067570: 6d5f 7374 6174 653d 7261 6e64 6f6d 7374  m_state=randomst
+00067580: 6174 6529 0d0a 2020 2020 656c 7365 3a0d  ate)..    else:.
+00067590: 0a20 2020 2020 2020 2069 6e64 6963 6573  .        indices
+000675a0: 203d 206e 702e 7261 6e64 6f6d 2e70 6572   = np.random.per
+000675b0: 6d75 7461 7469 6f6e 2874 7261 696e 6466  mutation(traindf
+000675c0: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
+000675d0: 2020 2020 7472 6169 6e5f 726f 7773 203d      train_rows =
+000675e0: 2069 6e74 2830 2e38 2a74 7261 696e 6466   int(0.8*traindf
+000675f0: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
+00067600: 7072 6564 6963 746f 7273 203d 205b 7820  predictors = [x 
+00067610: 666f 7220 7820 696e 2074 7261 696e 6466  for x in traindf
+00067620: 2069 6620 7820 6e6f 7420 696e 2074 6172   if x not in tar
+00067630: 6765 745d 0d0a 2020 2020 2323 2323 2320  get]..    ##### 
+00067640: 7365 6c65 6374 206f 6e6c 7920 7374 7269  select only stri
+00067650: 6e67 2063 6f6c 756d 6e73 2066 726f 6d20  ng columns from 
+00067660: 7468 6520 7472 6169 6e20 6461 7461 0d0a  the train data..
+00067670: 2020 2020 636f 6c73 203d 2063 6f70 792e      cols = copy.
+00067680: 6465 6570 636f 7079 2870 7265 6469 6374  deepcopy(predict
+00067690: 6f72 7329 0d0a 2020 2020 2363 6f6c 7320  ors)..    #cols 
+000676a0: 3d20 7365 6c65 6374 5f6e 756d 5f63 6f6c  = select_num_col
+000676b0: 756d 6e73 2874 7261 696e 6466 5b70 7265  umns(traindf[pre
+000676c0: 6469 6374 6f72 735d 292e 636f 6c75 6d6e  dictors]).column
+000676d0: 732e 746f 6c69 7374 2829 0d0a 2020 2020  s.tolist()..    
+000676e0: 7472 6169 6e64 6620 3d20 7472 6169 6e64  traindf = traind
+000676f0: 665b 636f 6c73 2b5b 7461 7267 6574 5d5d  f[cols+[target]]
+00067700: 0d0a 2020 2020 5820 3d20 7472 6169 6e64  ..    X = traind
+00067710: 665b 636f 6c73 5d0d 0a20 2020 2069 6620  f[cols]..    if 
+00067720: 7479 7065 2874 6573 7464 6629 203d 3d20  type(testdf) == 
+00067730: 7374 723a 0d0a 2020 2020 2020 2020 2323  str:..        ##
+00067740: 2323 2049 6620 6e6f 2074 6573 7420 4461  ## If no test Da
+00067750: 7461 4672 616d 6520 6973 2067 6976 656e  taFrame is given
+00067760: 2c20 7468 656e 2073 706c 6974 2074 6865  , then split the
+00067770: 2074 7261 696e 2064 6174 6120 696e 746f   train data into
+00067780: 2074 7261 696e 2c20 6376 2061 6e64 2074   train, cv and t
+00067790: 6573 7420 6461 7461 2023 2323 2323 2323  est data #######
+000677a0: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+000677b0: 656c 7479 7065 203d 3d20 2743 6c61 7373  eltype == 'Class
+000677c0: 6966 6963 6174 696f 6e27 3a0d 0a20 2020  ification':..   
+000677d0: 2020 2020 2020 2020 2074 7261 696e 696e           trainin
+000677e0: 6465 782c 2074 6573 7469 6e64 6578 203d  dex, testindex =
+000677f0: 2073 7373 2e73 706c 6974 2858 2c20 7929   sss.split(X, y)
+00067800: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00067810: 6164 6174 6120 3d20 7472 6169 6e64 662e  adata = traindf.
+00067820: 696c 6f63 5b74 7261 696e 696e 6465 785b  iloc[trainindex[
+00067830: 305d 5d0d 0a20 2020 2020 2020 2020 2020  0]]..           
+00067840: 2074 7364 6174 6120 3d20 7472 6169 6e64   tsdata = traind
+00067850: 662e 696c 6f63 5b74 7261 696e 696e 6465  f.iloc[traininde
+00067860: 785b 315d 5d0d 0a20 2020 2020 2020 2065  x[1]]..        e
+00067870: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00067880: 2020 7472 6169 6e69 6e67 5f69 6478 2c20    training_idx, 
+00067890: 7465 7374 5f69 6478 203d 2069 6e64 6963  test_idx = indic
+000678a0: 6573 5b3a 7472 6169 6e5f 726f 7773 5d2c  es[:train_rows],
+000678b0: 2069 6e64 6963 6573 5b74 7261 696e 5f72   indices[train_r
+000678c0: 6f77 733a 5d0d 0a20 2020 2020 2020 2020  ows:]..         
+000678d0: 2020 2074 7261 6461 7461 2c20 7473 6461     tradata, tsda
+000678e0: 7461 203d 2074 7261 696e 6466 2e69 6c6f  ta = traindf.ilo
+000678f0: 635b 7472 6169 6e69 6e67 5f69 6478 5d2c  c[training_idx],
+00067900: 2074 7261 696e 6466 2e69 6c6f 635b 7465   traindf.iloc[te
+00067910: 7374 5f69 6478 5d0d 0a20 2020 2020 2020  st_idx]..       
+00067920: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00067930: 2323 2323 2323 2020 2020 4352 4f53 5320  ######    CROSS 
+00067940: 5641 4c49 4441 5449 4f4e 2050 4f52 5449  VALIDATION PORTI
+00067950: 4f4e 2020 2323 2323 2323 2323 2323 2323  ON  ############
+00067960: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00067970: 2020 2020 2058 203d 2074 7364 6174 615b       X = tsdata[
+00067980: 636f 6c73 5d0d 0a20 2020 2020 2020 2079  cols]..        y
+00067990: 203d 2074 7364 6174 615b 7461 7267 6574   = tsdata[target
+000679a0: 5d0d 0a20 2020 2020 2020 2069 6620 6d6f  ]..        if mo
+000679b0: 6465 6c74 7970 6520 3d3d 2027 436c 6173  deltype == 'Clas
+000679c0: 7369 6669 6361 7469 6f6e 273a 0d0a 2020  sification':..  
+000679d0: 2020 2020 2020 2020 2020 7373 7320 3d20            sss = 
+000679e0: 5374 7261 7469 6669 6564 5368 7566 666c  StratifiedShuffl
+000679f0: 6553 706c 6974 286e 5f73 706c 6974 733d  eSplit(n_splits=
+00067a00: 322c 2074 6573 745f 7369 7a65 3d30 2e34  2, test_size=0.4
+00067a10: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
+00067a20: 7261 6e64 6f6d 7374 6174 6529 0d0a 2020  randomstate)..  
+00067a30: 2020 2020 2020 2020 2020 6376 696e 6465            cvinde
+00067a40: 782c 2074 735f 696e 6465 7820 3d20 7373  x, ts_index = ss
+00067a50: 732e 7370 6c69 7428 582c 2079 290d 0a20  s.split(X, y).. 
+00067a60: 2020 2020 2020 2020 2020 2063 7664 6174             cvdat
+00067a70: 6120 3d20 7473 6461 7461 2e69 6c6f 635b  a = tsdata.iloc[
+00067a80: 6376 696e 6465 785b 305d 5d0d 0a20 2020  cvindex[0]]..   
+00067a90: 2020 2020 2020 2020 2074 7364 6174 6120           tsdata 
+00067aa0: 3d20 7473 6461 7461 2e69 6c6f 635b 6376  = tsdata.iloc[cv
+00067ab0: 696e 6465 785b 315d 5d0d 0a20 2020 2020  index[1]]..     
+00067ac0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00067ad0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+00067ae0: 6e70 2e72 616e 646f 6d2e 7065 726d 7574  np.random.permut
+00067af0: 6174 696f 6e28 7473 6461 7461 2e73 6861  ation(tsdata.sha
+00067b00: 7065 5b30 5d29 0d0a 2020 2020 2020 2020  pe[0])..        
+00067b10: 2020 2020 7472 6169 6e5f 726f 7773 203d      train_rows =
+00067b20: 2069 6e74 2830 2e34 2a74 7364 6174 612e   int(0.4*tsdata.
+00067b30: 7368 6170 655b 305d 290d 0a20 2020 2020  shape[0])..     
+00067b40: 2020 2020 2020 2074 7261 696e 696e 675f         training_
+00067b50: 6964 782c 2074 6573 745f 6964 7820 3d20  idx, test_idx = 
+00067b60: 696e 6469 6365 735b 3a74 7261 696e 5f72  indices[:train_r
+00067b70: 6f77 735d 2c20 696e 6469 6365 735b 7472  ows], indices[tr
+00067b80: 6169 6e5f 726f 7773 3a5d 0d0a 2020 2020  ain_rows:]..    
+00067b90: 2020 2020 2020 2020 6376 6461 7461 2c20          cvdata, 
+00067ba0: 7473 6461 7461 203d 2074 7364 6174 612e  tsdata = tsdata.
+00067bb0: 696c 6f63 5b74 7261 696e 696e 675f 6964  iloc[training_id
+00067bc0: 785d 2c20 7473 6461 7461 2e69 6c6f 635b  x], tsdata.iloc[
+00067bd0: 7465 7374 5f69 6478 5d0d 0a20 2020 2020  test_idx]..     
+00067be0: 2020 2072 6574 7572 6e20 7472 6164 6174     return tradat
+00067bf0: 612c 2063 7664 6174 612c 2074 7364 6174  a, cvdata, tsdat
+00067c00: 612c 2063 6f6c 730d 0a20 2020 2065 6c73  a, cols..    els
+00067c10: 653a 0d0a 2020 2020 2020 2020 2323 2323  e:..        ####
+00067c20: 2323 2320 4966 2054 6573 7420 4461 7461  ### If Test Data
+00067c30: 4672 616d 6520 6973 2067 6976 656e 2074  Frame is given t
+00067c40: 6865 6e20 6b65 6570 2074 6861 7420 6173  hen keep that as
+00067c50: 2074 7364 6174 6120 2323 2323 2323 2323   tsdata ########
+00067c60: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+00067c70: 656c 7479 7065 203d 3d20 2743 6c61 7373  eltype == 'Class
+00067c80: 6966 6963 6174 696f 6e27 3a0d 0a20 2020  ification':..   
+00067c90: 2020 2020 2020 2020 2074 7261 696e 696e           trainin
+00067ca0: 6465 782c 2074 6573 7469 6e64 6578 203d  dex, testindex =
+00067cb0: 2073 7373 2e73 706c 6974 2858 2c20 7929   sss.split(X, y)
+00067cc0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00067cd0: 6164 6174 6120 3d20 7472 6169 6e64 662e  adata = traindf.
+00067ce0: 696c 6f63 5b74 7261 696e 696e 6465 785b  iloc[trainindex[
+00067cf0: 305d 5d0d 0a20 2020 2020 2020 2020 2020  0]]..           
+00067d00: 2063 7664 6174 6120 3d20 7472 6169 6e64   cvdata = traind
+00067d10: 662e 696c 6f63 5b74 7261 696e 696e 6465  f.iloc[traininde
+00067d20: 785b 315d 5d0d 0a20 2020 2020 2020 2020  x[1]]..         
+00067d30: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00067d40: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00067d50: 7465 7374 6466 5b74 6172 6765 745d 2e76  testdf[target].v
+00067d60: 616c 7565 5f63 6f75 6e74 7328 2920 3e3d  alue_counts() >=
+00067d70: 2032 293a 0d0a 2020 2020 2020 2020 2020   2):..          
+00067d80: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00067d90: 2720 2020 204e 756d 6265 7220 6f66 2054  '    Number of T
+00067da0: 6172 6765 7420 526f 7773 2069 6e20 5465  arget Rows in Te
+00067db0: 7374 2044 6174 613a 2025 6427 2025 6c65  st Data: %d' %le
+00067dc0: 6e28 7465 7374 6466 5b74 6573 7464 665b  n(testdf[testdf[
+00067dd0: 7461 7267 6574 5d3d 3d31 5d29 290d 0a20  target]==1])).. 
+00067de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067df0: 2020 2074 7364 6174 6120 3d20 7465 7374     tsdata = test
+00067e00: 6466 5b3a 5d0d 0a20 2020 2020 2020 2020  df[:]..         
+00067e10: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00067e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067e30: 2020 7072 696e 7428 2720 2020 2054 6573    print('    Tes
+00067e40: 7420 6461 7461 2068 6173 2073 696e 676c  t data has singl
+00067e50: 6520 636c 6173 732e 204f 7665 7277 7269  e class. Overwri
+00067e60: 7469 6e67 2070 7265 6469 6374 696f 6e73  ting predictions
+00067e70: 206f 6e20 5465 7374 2054 6172 6765 7420   on Test Target 
+00067e80: 636f 6c75 6d6e 2e27 290d 0a20 2020 2020  column.')..     
+00067e90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00067ea0: 7265 6469 6374 6f72 7320 3d20 5b78 2066  redictors = [x f
+00067eb0: 6f72 2078 2069 6e20 6c69 7374 2874 7261  or x in list(tra
+00067ec0: 696e 6466 2920 6966 2078 206e 6f74 2069  indf) if x not i
+00067ed0: 6e20 7461 7267 6574 5d0d 0a20 2020 2020  n target]..     
+00067ee0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00067ef0: 7364 6174 6120 3d20 7465 7374 6466 5b3a  sdata = testdf[:
+00067f00: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00067f10: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00067f20: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00067f30: 2020 204e 6f20 5461 7267 6574 2063 6f6c     No Target col
+00067f40: 756d 6e20 696e 2054 6573 7420 6461 7461  umn in Test data
+00067f50: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00067f60: 2020 2020 7465 7374 6466 5b74 6172 6765      testdf[targe
+00067f70: 745d 203d 2030 0d0a 2020 2020 2020 2020  t] = 0..        
+00067f80: 2020 2020 2020 2020 7473 6461 7461 203d          tsdata =
+00067f90: 2074 6573 7464 665b 636f 6c73 2b5b 7461   testdf[cols+[ta
+00067fa0: 7267 6574 5d5d 0d0a 2020 2020 2020 2020  rget]]..        
+00067fb0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00067fc0: 2020 2069 6e64 6963 6573 203d 206e 702e     indices = np.
+00067fd0: 7261 6e64 6f6d 2e70 6572 6d75 7461 7469  random.permutati
+00067fe0: 6f6e 2874 7261 696e 6466 2e73 6861 7065  on(traindf.shape
+00067ff0: 5b30 5d29 0d0a 2020 2020 2020 2020 2020  [0])..          
+00068000: 2020 7472 6169 6e5f 726f 7773 203d 2069    train_rows = i
+00068010: 6e74 2830 2e38 2a74 7261 696e 6466 2e73  nt(0.8*traindf.s
+00068020: 6861 7065 5b30 5d29 0d0a 2020 2020 2020  hape[0])..      
+00068030: 2020 2020 2020 7472 6169 6e69 6e67 5f69        training_i
+00068040: 6478 2c20 7465 7374 5f69 6478 203d 2069  dx, test_idx = i
+00068050: 6e64 6963 6573 5b3a 7472 6169 6e5f 726f  ndices[:train_ro
+00068060: 7773 5d2c 2069 6e64 6963 6573 5b74 7261  ws], indices[tra
+00068070: 696e 5f72 6f77 733a 5d0d 0a20 2020 2020  in_rows:]..     
+00068080: 2020 2020 2020 2074 7261 6461 7461 2c20         tradata, 
+00068090: 6376 6461 7461 203d 2074 7261 696e 6466  cvdata = traindf
+000680a0: 2e69 6c6f 635b 7472 6169 6e69 6e67 5f69  .iloc[training_i
+000680b0: 6478 5d2c 2074 7261 696e 6466 2e69 6c6f  dx], traindf.ilo
+000680c0: 635b 7465 7374 5f69 6478 5d0d 0a20 2020  c[test_idx]..   
+000680d0: 2020 2020 2020 2020 2074 7364 6174 6120           tsdata 
+000680e0: 3d20 7465 7374 6466 5b3a 5d0d 0a20 2020  = testdf[:]..   
+000680f0: 2020 2020 2072 6574 7572 6e20 7472 6164       return trad
+00068100: 6174 612c 2063 7664 6174 612c 2074 7364  ata, cvdata, tsd
+00068110: 6174 612c 2063 6f6c 730d 0a23 2323 2323  ata, cols..#####
+00068120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068160: 2323 2323 2323 230d 0a64 6566 2066 696c  #######..def fil
+00068170: 6c69 6e67 5f6d 6973 7369 6e67 5f76 616c  ling_missing_val
+00068180: 7565 735f 7369 6d70 6c65 2874 7261 696e  ues_simple(train
+00068190: 2c20 7465 7374 2c20 6361 7473 2c20 6e75  , test, cats, nu
+000681a0: 6d73 293a 0d0a 2020 2020 2323 2323 2069  ms):..    #### i
+000681b0: 6620 796f 7520 7761 6e74 2074 6f20 6669  f you want to fi
+000681c0: 6c6c 206d 6973 7369 6e67 2076 616c 7565  ll missing value
+000681d0: 7320 7573 696e 6720 6d65 616e 2c20 6d65  s using mean, me
+000681e0: 6469 616e 206d 6f64 652c 2067 6f20 6168  dian mode, go ah
+000681f0: 6561 6421 0d0a 2020 2020 2323 2323 2020  ead!..    ####  
+00068200: 4920 646f 6e27 7420 7265 636f 6d6d 656e  I don't recommen
+00068210: 6420 4275 7420 736f 6d65 2070 656f 706c  d But some peopl
+00068220: 6520 7365 656d 2074 6f20 6c69 6b65 2069  e seem to like i
+00068230: 742e 2023 2323 2323 0d0a 2020 2020 666f  t. #####..    fo
+00068240: 7220 7661 726d 2069 6e20 6361 7473 3a0d  r varm in cats:.
+00068250: 0a20 2020 2020 2020 2069 6620 7472 6169  .        if trai
+00068260: 6e5b 7661 726d 5d2e 6973 6e75 6c6c 2829  n[varm].isnull()
+00068270: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+00068280: 2020 2020 2020 2020 2066 696c 6c6e 756d           fillnum
+00068290: 203d 2074 7261 696e 5b76 6172 6d5d 2e6d   = train[varm].m
+000682a0: 6f64 6528 295b 305d 0d0a 2020 2020 2020  ode()[0]..      
+000682b0: 2020 2020 2020 2323 2320 5265 6d65 6d62        ### Rememb
+000682c0: 6572 2074 6861 7420 6669 6c6c 6e61 206f  er that fillna o
+000682d0: 6e6c 7920 776f 726b 7320 6174 2064 6174  nly works at dat
+000682e0: 6166 7261 6d65 206c 6576 656c 2120 2323  aframe level! ##
+000682f0: 230d 0a20 2020 2020 2020 2020 2020 2074  #..            t
+00068300: 7261 696e 5b5b 7661 726d 5d5d 203d 2074  rain[[varm]] = t
+00068310: 7261 696e 5b5b 7661 726d 5d5d 2e66 696c  rain[[varm]].fil
+00068320: 6c6e 6128 6669 6c6c 6e75 6d29 0d0a 2020  lna(fillnum)..  
+00068330: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00068340: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
+00068350: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00068360: 2020 2020 2020 2020 2069 6620 7465 7374           if test
+00068370: 5b76 6172 6d5d 2e69 736e 756c 6c28 292e  [varm].isnull().
+00068380: 7375 6d28 2920 3e20 303a 0d0a 2020 2020  sum() > 0:..    
+00068390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000683a0: 2323 2320 5265 6d65 6d62 6572 2074 6861  ### Remember tha
+000683b0: 7420 6669 6c6c 6e61 206f 6e6c 7920 776f  t fillna only wo
+000683c0: 726b 7320 6174 2064 6174 6166 7261 6d65  rks at dataframe
+000683d0: 206c 6576 656c 2120 2323 230d 0a20 2020   level! ###..   
+000683e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000683f0: 2074 6573 745b 5b76 6172 6d5d 5d20 3d20   test[[varm]] = 
+00068400: 7465 7374 5b5b 7661 726d 5d5d 2e66 696c  test[[varm]].fil
+00068410: 6c6e 6128 6669 6c6c 6e75 6d29 0d0a 2020  lna(fillnum)..  
+00068420: 2020 666f 7220 6e75 6d20 696e 206e 756d    for num in num
+00068430: 733a 0d0a 2020 2020 2020 2020 6966 2074  s:..        if t
+00068440: 7261 696e 5b76 6172 6d5d 2e69 736e 756c  rain[varm].isnul
+00068450: 6c28 292e 7375 6d28 2920 3e20 303a 0d0a  l().sum() > 0:..
+00068460: 2020 2020 2020 2020 2020 2020 6669 6c6c              fill
+00068470: 6e75 6d20 3d20 7472 6169 6e5b 6e75 6d5d  num = train[num]
+00068480: 2e6d 6561 6e28 290d 0a20 2020 2020 2020  .mean()..       
+00068490: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
+000684a0: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
+000684b0: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
+000684c0: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
+000684d0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+000684e0: 6169 6e5b 5b6e 756d 5d5d 203d 2074 7261  ain[[num]] = tra
+000684f0: 696e 5b5b 6e75 6d5d 5d2e 6669 6c6c 6e61  in[[num]].fillna
+00068500: 2866 696c 6c6e 756d 290d 0a20 2020 2020  (fillnum)..     
+00068510: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00068520: 696e 7374 616e 6365 2874 6573 742c 2073  instance(test, s
+00068530: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+00068540: 2020 2020 2020 6966 2074 6573 745b 7661        if test[va
+00068550: 726d 5d2e 6973 6e75 6c6c 2829 2e73 756d  rm].isnull().sum
+00068560: 2829 203e 2030 3a0d 0a20 2020 2020 2020  () > 0:..       
+00068570: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00068580: 2052 656d 656d 6265 7220 7468 6174 2066   Remember that f
+00068590: 696c 6c6e 6120 6f6e 6c79 2077 6f72 6b73  illna only works
+000685a0: 2061 7420 6461 7461 6672 616d 6520 6c65   at dataframe le
+000685b0: 7665 6c21 2023 2323 0d0a 2020 2020 2020  vel! ###..      
+000685c0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+000685d0: 7374 5b5b 6e75 6d5d 5d20 3d20 7465 7374  st[[num]] = test
+000685e0: 5b5b 6e75 6d5d 5d2e 6669 6c6c 6e61 2866  [[num]].fillna(f
+000685f0: 696c 6c6e 756d 290d 0a20 2020 2023 2323  illnum)..    ###
+00068600: 2054 6869 7320 6973 2061 2073 696d 706c   This is a simpl
+00068610: 6520 6c6f 6720 7472 616e 7366 6f72 6d20  e log transform 
+00068620: 666f 7220 7665 7279 206c 6172 6765 206e  for very large n
+00068630: 756d 6572 6963 2076 616c 7565 7320 3d3e  umeric values =>
+00068640: 2068 6967 686c 7920 7265 636f 6d6d 656e   highly recommen
+00068650: 6465 6421 0d0a 2020 2020 666f 7220 6e75  ded!..    for nu
+00068660: 6d20 696e 206e 756d 733a 0d0a 2020 2020  m in nums:..    
+00068670: 2020 2020 6d61 736b 203d 2074 7261 696e      mask = train
+00068680: 5b6e 756d 5d3d 3d30 0d0a 2020 2020 2020  [num]==0..      
+00068690: 2020 6669 6c6c 6e75 6d20 3d20 3130 652d    fillnum = 10e-
+000686a0: 350d 0a20 2020 2020 2020 2074 7261 696e  5..        train
+000686b0: 2e69 785b 6d61 736b 2c6e 756d 5d20 3d20  .ix[mask,num] = 
+000686c0: 6669 6c6c 6e75 6d0d 0a20 2020 2020 2020  fillnum..       
+000686d0: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+000686e0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+000686f0: 6f72 6b73 2061 7420 6461 7461 6672 616d  orks at datafram
+00068700: 6520 6c65 7665 6c21 2023 2323 0d0a 2020  e level! ###..  
+00068710: 2020 2020 2020 7472 6169 6e5b 5b6e 756d        train[[num
+00068720: 2b27 5f6c 6f67 275d 5d20 3d20 6e70 2e6c  +'_log']] = np.l
+00068730: 6f67 3130 2874 7261 696e 5b5b 6e75 6d5d  og10(train[[num]
+00068740: 5d29 2e66 696c 6c6e 6128 3029 0d0a 2020  ]).fillna(0)..  
+00068750: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00068760: 6e73 7461 6e63 6528 7465 7374 2c20 7374  nstance(test, st
+00068770: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+00068780: 206d 6173 6b20 3d20 7465 7374 5b6e 756d   mask = test[num
+00068790: 5d3d 3d30 0d0a 2020 2020 2020 2020 2020  ]==0..          
+000687a0: 2020 7465 7374 2e69 785b 6d61 736b 2c6e    test.ix[mask,n
+000687b0: 756d 5d20 3d20 6669 6c6c 6e75 6d0d 0a20  um] = fillnum.. 
+000687c0: 2020 2020 2020 2020 2020 2023 2323 2052             ### R
+000687d0: 656d 656d 6265 7220 7468 6174 2066 696c  emember that fil
+000687e0: 6c6e 6120 6f6e 6c79 2077 6f72 6b73 2061  lna only works a
+000687f0: 7420 6461 7461 6672 616d 6520 6c65 7665  t dataframe leve
+00068800: 6c21 2023 2323 0d0a 2020 2020 2020 2020  l! ###..        
+00068810: 2020 2020 7465 7374 5b5b 6e75 6d2b 275f      test[[num+'_
+00068820: 6c6f 6727 5d5d 203d 206e 702e 6c6f 6731  log']] = np.log1
+00068830: 3028 7465 7374 5b5b 6e75 6d5d 5d29 2e66  0(test[[num]]).f
+00068840: 696c 6c6e 6128 3029 0d0a 2020 2020 7265  illna(0)..    re
+00068850: 7475 726e 2074 7261 696e 2c20 7465 7374  turn train, test
+00068860: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00068870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068890: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+000688a0: 696d 706f 7274 206f 730d 0a64 6566 2077  import os..def w
+000688b0: 7269 7465 5f66 696c 655f 746f 5f66 6f6c  rite_file_to_fol
+000688c0: 6465 7228 6466 2c20 6561 6368 5f74 6172  der(df, each_tar
+000688d0: 6765 742c 2062 6173 655f 6669 6c65 6e61  get, base_filena
+000688e0: 6d65 2c20 7665 7262 6f73 653d 3129 3a0d  me, verbose=1):.
+000688f0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00068900: 6365 2865 6163 685f 7461 7267 6574 2c20  ce(each_target, 
+00068910: 7374 7229 3a0d 0a20 2020 2020 2020 2064  str):..        d
+00068920: 6972 5f6e 616d 6520 3d20 636f 7079 2e64  ir_name = copy.d
+00068930: 6565 7063 6f70 7928 6561 6368 5f74 6172  eepcopy(each_tar
+00068940: 6765 7429 0d0a 2020 2020 656c 7365 3a0d  get)..    else:.
+00068950: 0a20 2020 2020 2020 2064 6972 5f6e 616d  .        dir_nam
+00068960: 6520 3d20 7374 7228 6561 6368 5f74 6172  e = str(each_tar
+00068970: 6765 7429 0d0a 2020 2020 6669 6c65 6e61  get)..    filena
+00068980: 6d65 203d 206f 732e 7061 7468 2e6a 6f69  me = os.path.joi
+00068990: 6e28 6469 725f 6e61 6d65 2c20 6261 7365  n(dir_name, base
+000689a0: 5f66 696c 656e 616d 6529 0d0a 2020 2020  _filename)..    
+000689b0: 6966 2076 6572 626f 7365 203e 3d20 313a  if verbose >= 1:
+000689c0: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
+000689d0: 6e61 6d65 203d 3d20 276e 7427 3a0d 0a20  name == 'nt':.. 
+000689e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000689f0: 2827 2020 2020 5361 7669 6e67 2070 7265  ('    Saving pre
+00068a00: 6469 6374 696f 6e73 2074 6f20 2e5c 2573  dictions to .\%s
+00068a10: 2720 2566 696c 656e 616d 6529 0d0a 2020  ' %filename)..  
+00068a20: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00068a30: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00068a40: 2020 2020 5361 7669 6e67 2070 7265 6469      Saving predi
+00068a50: 6374 696f 6e73 2074 6f20 2e2f 2573 2720  ctions to ./%s' 
+00068a60: 2566 696c 656e 616d 6529 0d0a 2020 2020  %filename)..    
+00068a70: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
+00068a80: 7468 2e69 7364 6972 2864 6972 5f6e 616d  th.isdir(dir_nam
+00068a90: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+00068aa0: 206f 732e 6d6b 6469 7228 6469 725f 6e61   os.mkdir(dir_na
+00068ab0: 6d65 290d 0a20 2020 2020 2020 2064 662e  me)..        df.
+00068ac0: 746f 5f63 7376 2866 696c 656e 616d 652c  to_csv(filename,
+00068ad0: 696e 6465 783d 4661 6c73 6529 0d0a 2323  index=False)..##
+00068ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00068b10: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+00068b20: 6620 6372 6561 7465 5f74 735f 6665 6174  f create_ts_feat
+00068b30: 7572 6573 2864 662c 2074 7363 6f6c 293a  ures(df, tscol):
+00068b40: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+00068b50: 6869 7320 7461 6b65 7320 696e 2069 6e70  his takes in inp
+00068b60: 7574 2061 2064 6174 6166 7261 6d65 2061  ut a dataframe a
+00068b70: 6e64 2061 2064 6174 6520 7661 7269 6162  nd a date variab
+00068b80: 6c65 2e0d 0a20 2020 2049 7420 7468 656e  le...    It then
+00068b90: 2063 7265 6174 6573 2074 696d 6520 7365   creates time se
+00068ba0: 7269 6573 2066 6561 7475 7265 7320 7573  ries features us
+00068bb0: 696e 6720 7468 6520 7061 6e64 6173 202e  ing the pandas .
+00068bc0: 6474 2e77 6565 6b64 6179 206b 696e 6420  dt.weekday kind 
+00068bd0: 6f66 2073 796e 7461 782e 0d0a 2020 2020  of syntax...    
+00068be0: 4974 2061 6c73 6f20 7265 7475 726e 7320  It also returns 
+00068bf0: 7468 6520 6461 7461 2066 7261 6d65 206f  the data frame o
+00068c00: 6620 6164 6465 6420 6665 6174 7572 6573  f added features
+00068c10: 2077 6974 6820 6561 6368 2076 6172 6961   with each varia
+00068c20: 626c 6520 6173 2061 6e20 696e 7465 6765  ble as an intege
+00068c30: 7220 7661 7269 6162 6c65 2e0d 0a20 2020  r variable...   
+00068c40: 2022 2222 0d0a 2020 2020 6466 203d 2063   """..    df = c
+00068c50: 6f70 792e 6465 6570 636f 7079 2864 6629  opy.deepcopy(df)
+00068c60: 0d0a 2020 2020 6474 5f61 6464 7320 3d20  ..    dt_adds = 
+00068c70: 5b5d 0d0a 2020 2020 7472 793a 0d0a 2020  []..    try:..  
+00068c80: 2020 2020 2020 6466 5b74 7363 6f6c 2b27        df[tscol+'
+00068c90: 5f68 6f75 7227 5d20 3d20 6466 5b74 7363  _hour'] = df[tsc
+00068ca0: 6f6c 5d2e 6474 2e68 6f75 722e 6669 6c6c  ol].dt.hour.fill
+00068cb0: 6e61 2830 292e 6173 7479 7065 2869 6e74  na(0).astype(int
+00068cc0: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
+00068cd0: 636f 6c2b 275f 6d69 6e75 7465 275d 203d  col+'_minute'] =
+00068ce0: 2064 665b 7473 636f 6c5d 2e64 742e 6d69   df[tscol].dt.mi
+00068cf0: 6e75 7465 2e66 696c 6c6e 6128 3029 2e61  nute.fillna(0).a
+00068d00: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
+00068d10: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
+00068d20: 6e64 2874 7363 6f6c 2b27 5f68 6f75 7227  nd(tscol+'_hour'
+00068d30: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
+00068d40: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
+00068d50: 275f 6d69 6e75 7465 2729 0d0a 2020 2020  '_minute')..    
+00068d60: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00068d70: 2070 7269 6e74 2827 2020 2020 4572 726f   print('    Erro
+00068d80: 7220 696e 2063 7265 6174 696e 6720 686f  r in creating ho
+00068d90: 7572 2d73 6563 6f6e 6420 6465 7269 7665  ur-second derive
+00068da0: 6420 6665 6174 7572 6573 2e20 436f 6e74  d features. Cont
+00068db0: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
+00068dc0: 2074 7279 3a0d 0a20 2020 2020 2020 2064   try:..        d
+00068dd0: 665b 7473 636f 6c2b 275f 6461 796f 6677  f[tscol+'_dayofw
+00068de0: 6565 6b27 5d20 3d20 6466 5b74 7363 6f6c  eek'] = df[tscol
+00068df0: 5d2e 6474 2e64 6179 6f66 7765 656b 2e66  ].dt.dayofweek.f
+00068e00: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
+00068e10: 696e 7429 0d0a 2020 2020 2020 2020 6474  int)..        dt
+00068e20: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+00068e30: 6f6c 2b27 5f64 6179 6f66 7765 656b 2729  ol+'_dayofweek')
+00068e40: 0d0a 2020 2020 2020 2020 6966 2074 7363  ..        if tsc
+00068e50: 6f6c 2b27 5f68 6f75 7227 2069 6e20 6474  ol+'_hour' in dt
+00068e60: 5f61 6464 733a 0d0a 2020 2020 2020 2020  _adds:..        
+00068e70: 2020 2020 4441 5953 203d 2064 6963 7428      DAYS = dict(
+00068e80: 7a69 7028 7261 6e67 6528 3729 2c5b 2753  zip(range(7),['S
+00068e90: 756e 272c 2027 4d6f 6e27 2c20 2754 7565  un', 'Mon', 'Tue
+00068ea0: 272c 2027 5765 6427 2c20 2754 6875 272c  ', 'Wed', 'Thu',
+00068eb0: 2027 4672 6927 2c20 2753 6174 275d 2929   'Fri', 'Sat']))
+00068ec0: 0d0a 2020 2020 2020 2020 2020 2020 6466  ..            df
+00068ed0: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7765  [tscol+'_dayofwe
+00068ee0: 656b 275d 203d 2064 665b 7473 636f 6c2b  ek'] = df[tscol+
+00068ef0: 275f 6461 796f 6677 6565 6b27 5d2e 6d61  '_dayofweek'].ma
+00068f00: 7028 4441 5953 290d 0a20 2020 2020 2020  p(DAYS)..       
+00068f10: 2020 2020 2064 662e 6c6f 635b 3a2c 7473       df.loc[:,ts
+00068f20: 636f 6c2b 275f 6461 796f 6677 6565 6b5f  col+'_dayofweek_
+00068f30: 686f 7572 5f63 726f 7373 275d 203d 2064  hour_cross'] = d
+00068f40: 665b 7473 636f 6c2b 275f 6461 796f 6677  f[tscol+'_dayofw
+00068f50: 6565 6b27 5d20 2b22 2022 2b20 6466 5b74  eek'] +" "+ df[t
+00068f60: 7363 6f6c 2b27 5f68 6f75 7227 5d2e 6173  scol+'_hour'].as
+00068f70: 7479 7065 2873 7472 290d 0a20 2020 2020  type(str)..     
+00068f80: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+00068f90: 7070 656e 6428 7473 636f 6c2b 275f 6461  ppend(tscol+'_da
+00068fa0: 796f 6677 6565 6b5f 686f 7572 5f63 726f  yofweek_hour_cro
+00068fb0: 7373 2729 0d0a 2020 2020 2020 2020 6466  ss')..        df
+00068fc0: 5b74 7363 6f6c 2b27 5f71 7561 7274 6572  [tscol+'_quarter
+00068fd0: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
+00068fe0: 742e 7175 6172 7465 722e 6669 6c6c 6e61  t.quarter.fillna
+00068ff0: 2830 292e 6173 7479 7065 2869 6e74 290d  (0).astype(int).
+00069000: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+00069010: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+00069020: 7175 6172 7465 7227 290d 0a20 2020 2020  quarter')..     
+00069030: 2020 2064 665b 7473 636f 6c2b 275f 6d6f     df[tscol+'_mo
+00069040: 6e74 6827 5d20 3d20 6466 5b74 7363 6f6c  nth'] = df[tscol
+00069050: 5d2e 6474 2e6d 6f6e 7468 2e66 696c 6c6e  ].dt.month.filln
+00069060: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+00069070: 0d0a 2020 2020 2020 2020 4d4f 4e54 4853  ..        MONTHS
+00069080: 203d 2064 6963 7428 7a69 7028 7261 6e67   = dict(zip(rang
+00069090: 6528 312c 3133 292c 5b27 4a61 6e27 2c20  e(1,13),['Jan', 
+000690a0: 2746 6562 272c 2027 4d61 7227 2c20 2741  'Feb', 'Mar', 'A
+000690b0: 7072 272c 2027 4d61 7927 2c20 274a 756e  pr', 'May', 'Jun
+000690c0: 272c 2027 4a75 6c27 2c0d 0a20 2020 2020  ', 'Jul',..     
+000690d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000690e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000690f0: 4175 6727 2c20 2753 6570 272c 2027 4f63  Aug', 'Sep', 'Oc
+00069100: 7427 2c20 274e 6f76 272c 2027 4465 6327  t', 'Nov', 'Dec'
+00069110: 5d29 290d 0a20 2020 2020 2020 2064 665b  ]))..        df[
+00069120: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d20  tscol+'_month'] 
+00069130: 3d20 6466 5b74 7363 6f6c 2b27 5f6d 6f6e  = df[tscol+'_mon
+00069140: 7468 275d 2e6d 6170 284d 4f4e 5448 5329  th'].map(MONTHS)
+00069150: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
+00069160: 732e 6170 7065 6e64 2874 7363 6f6c 2b27  s.append(tscol+'
+00069170: 5f6d 6f6e 7468 2729 0d0a 2020 2020 2020  _month')..      
+00069180: 2020 2323 2323 2041 6464 2073 6f6d 6520    #### Add some 
+00069190: 6665 6174 7572 6573 2066 6f72 206d 6f6e  features for mon
+000691a0: 7468 7320 2323 2323 2323 2323 2323 2323  ths ############
+000691b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000691c0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+000691d0: 2020 2020 2020 6665 7374 6976 6573 203d        festives =
+000691e0: 205b 274f 6374 272c 274e 6f76 272c 2744   ['Oct','Nov','D
+000691f0: 6563 275d 0d0a 2020 2020 2020 2020 6e61  ec']..        na
+00069200: 6d65 5f63 6f6c 203d 2074 7363 6f6c 2b22  me_col = tscol+"
+00069210: 5f69 735f 6665 7374 6976 6522 0d0a 2020  _is_festive"..  
+00069220: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
+00069230: 6c5d 203d 2030 0d0a 2020 2020 2020 2020  l] = 0..        
+00069240: 6466 5b6e 616d 655f 636f 6c5d 203d 2064  df[name_col] = d
+00069250: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
+00069260: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
+00069270: 3120 6966 2078 2069 6e20 6665 7374 6976  1 if x in festiv
+00069280: 6573 2065 6c73 6520 3029 2e76 616c 7565  es else 0).value
+00069290: 730d 0a20 2020 2020 2020 2023 2323 2052  s..        ### R
+000692a0: 656d 656d 6265 7220 7468 6174 2066 696c  emember that fil
+000692b0: 6c6e 6120 6f6e 6c79 2077 6f72 6b73 2061  lna only works a
+000692c0: 7420 6461 7461 6672 616d 6520 6c65 7665  t dataframe leve
+000692d0: 6c21 2023 2323 0d0a 2020 2020 2020 2020  l! ###..        
+000692e0: 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d  df[[name_col]] =
+000692f0: 2064 665b 5b6e 616d 655f 636f 6c5d 5d2e   df[[name_col]].
+00069300: 6669 6c6c 6e61 2830 290d 0a20 2020 2020  fillna(0)..     
+00069310: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
+00069320: 6428 6e61 6d65 5f63 6f6c 290d 0a20 2020  d(name_col)..   
+00069330: 2020 2020 2073 756d 6d65 7220 3d20 5b27       summer = ['
+00069340: 4a75 6e27 2c27 4a75 6c27 2c27 4175 6727  Jun','Jul','Aug'
+00069350: 5d0d 0a20 2020 2020 2020 206e 616d 655f  ]..        name_
+00069360: 636f 6c20 3d20 7473 636f 6c2b 225f 6973  col = tscol+"_is
+00069370: 5f73 756d 6d65 7222 0d0a 2020 2020 2020  _summer"..      
+00069380: 2020 6466 5b6e 616d 655f 636f 6c5d 203d    df[name_col] =
+00069390: 2030 0d0a 2020 2020 2020 2020 6466 5b6e   0..        df[n
+000693a0: 616d 655f 636f 6c5d 203d 2064 665b 7473  ame_col] = df[ts
+000693b0: 636f 6c2b 275f 6d6f 6e74 6827 5d2e 6d61  col+'_month'].ma
+000693c0: 7028 6c61 6d62 6461 2078 3a20 3120 6966  p(lambda x: 1 if
+000693d0: 2078 2069 6e20 7375 6d6d 6572 2065 6c73   x in summer els
+000693e0: 6520 3029 2e76 616c 7565 730d 0a20 2020  e 0).values..   
+000693f0: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
+00069400: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
+00069410: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
+00069420: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
+00069430: 0d0a 2020 2020 2020 2020 6466 5b5b 6e61  ..        df[[na
+00069440: 6d65 5f63 6f6c 5d5d 203d 2064 665b 5b6e  me_col]] = df[[n
+00069450: 616d 655f 636f 6c5d 5d2e 6669 6c6c 6e61  ame_col]].fillna
+00069460: 2830 290d 0a20 2020 2020 2020 2064 745f  (0)..        dt_
+00069470: 6164 6473 2e61 7070 656e 6428 6e61 6d65  adds.append(name
+00069480: 5f63 6f6c 290d 0a20 2020 2020 2020 2077  _col)..        w
+00069490: 696e 7465 7220 3d20 5b27 4465 6327 2c27  inter = ['Dec','
+000694a0: 4a61 6e27 2c27 4665 6227 5d0d 0a20 2020  Jan','Feb']..   
+000694b0: 2020 2020 206e 616d 655f 636f 6c20 3d20       name_col = 
+000694c0: 7473 636f 6c2b 225f 6973 5f77 696e 7465  tscol+"_is_winte
+000694d0: 7222 0d0a 2020 2020 2020 2020 6466 5b6e  r"..        df[n
+000694e0: 616d 655f 636f 6c5d 203d 2030 0d0a 2020  ame_col] = 0..  
+000694f0: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
+00069500: 6c5d 203d 2064 665b 7473 636f 6c2b 275f  l] = df[tscol+'_
+00069510: 6d6f 6e74 6827 5d2e 6d61 7028 6c61 6d62  month'].map(lamb
+00069520: 6461 2078 3a20 3120 6966 2078 2069 6e20  da x: 1 if x in 
+00069530: 7769 6e74 6572 2065 6c73 6520 3029 2e76  winter else 0).v
+00069540: 616c 7565 730d 0a20 2020 2020 2020 2023  alues..        #
+00069550: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
+00069560: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
+00069570: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
+00069580: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
+00069590: 2020 2020 6466 5b5b 6e61 6d65 5f63 6f6c      df[[name_col
+000695a0: 5d5d 203d 2064 665b 5b6e 616d 655f 636f  ]] = df[[name_co
+000695b0: 6c5d 5d2e 6669 6c6c 6e61 2830 290d 0a20  l]].fillna(0).. 
+000695c0: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+000695d0: 7070 656e 6428 6e61 6d65 5f63 6f6c 290d  ppend(name_col).
+000695e0: 0a20 2020 2020 2020 2063 6f6c 6420 3d20  .        cold = 
+000695f0: 5b27 4f63 7427 2c27 4e6f 7627 2c27 4465  ['Oct','Nov','De
+00069600: 6327 2c27 4a61 6e27 2c27 4665 6227 2c27  c','Jan','Feb','
+00069610: 4d61 7227 5d0d 0a20 2020 2020 2020 206e  Mar']..        n
+00069620: 616d 655f 636f 6c20 3d20 7473 636f 6c2b  ame_col = tscol+
+00069630: 225f 6973 5f63 6f6c 6422 0d0a 2020 2020  "_is_cold"..    
+00069640: 2020 2020 6466 5b6e 616d 655f 636f 6c5d      df[name_col]
+00069650: 203d 2030 0d0a 2020 2020 2020 2020 6466   = 0..        df
+00069660: 5b6e 616d 655f 636f 6c5d 203d 2064 665b  [name_col] = df[
+00069670: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d2e  tscol+'_month'].
+00069680: 6d61 7028 6c61 6d62 6461 2078 3a20 3120  map(lambda x: 1 
+00069690: 6966 2078 2069 6e20 636f 6c64 2065 6c73  if x in cold els
+000696a0: 6520 3029 2e76 616c 7565 730d 0a20 2020  e 0).values..   
+000696b0: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
+000696c0: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
+000696d0: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
+000696e0: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
+000696f0: 0d0a 2020 2020 2020 2020 6466 5b5b 6e61  ..        df[[na
+00069700: 6d65 5f63 6f6c 5d5d 203d 2064 665b 5b6e  me_col]] = df[[n
+00069710: 616d 655f 636f 6c5d 5d2e 6669 6c6c 6e61  ame_col]].fillna
+00069720: 2830 290d 0a20 2020 2020 2020 2064 745f  (0)..        dt_
+00069730: 6164 6473 2e61 7070 656e 6428 6e61 6d65  adds.append(name
+00069740: 5f63 6f6c 290d 0a20 2020 2020 2020 2077  _col)..        w
+00069750: 6172 6d20 3d20 5b27 4170 7227 2c27 4d61  arm = ['Apr','Ma
+00069760: 7927 2c27 4a75 6e27 2c27 4a75 6c27 2c27  y','Jun','Jul','
+00069770: 4175 6727 2c27 5365 7027 5d0d 0a20 2020  Aug','Sep']..   
+00069780: 2020 2020 206e 616d 655f 636f 6c20 3d20       name_col = 
+00069790: 7473 636f 6c2b 225f 6973 5f77 6172 6d22  tscol+"_is_warm"
+000697a0: 0d0a 2020 2020 2020 2020 6466 5b6e 616d  ..        df[nam
+000697b0: 655f 636f 6c5d 203d 2030 0d0a 2020 2020  e_col] = 0..    
+000697c0: 2020 2020 6466 5b6e 616d 655f 636f 6c5d      df[name_col]
+000697d0: 203d 2064 665b 7473 636f 6c2b 275f 6d6f   = df[tscol+'_mo
+000697e0: 6e74 6827 5d2e 6d61 7028 6c61 6d62 6461  nth'].map(lambda
+000697f0: 2078 3a20 3120 6966 2078 2069 6e20 7761   x: 1 if x in wa
+00069800: 726d 2065 6c73 6520 3029 2e76 616c 7565  rm else 0).value
+00069810: 730d 0a20 2020 2020 2020 2064 665b 5b6e  s..        df[[n
+00069820: 616d 655f 636f 6c5d 5d20 3d20 6466 5b5b  ame_col]] = df[[
+00069830: 6e61 6d65 5f63 6f6c 5d5d 2e66 696c 6c6e  name_col]].filln
+00069840: 6128 3029 0d0a 2020 2020 2020 2020 6474  a(0)..        dt
+00069850: 5f61 6464 732e 6170 7065 6e64 286e 616d  _adds.append(nam
+00069860: 655f 636f 6c29 0d0a 2020 2020 2020 2020  e_col)..        
+00069870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000698a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000698b0: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+000698c0: 2020 2069 6620 7473 636f 6c2b 275f 6461     if tscol+'_da
+000698d0: 796f 6677 6565 6b27 2069 6e20 6474 5f61  yofweek' in dt_a
+000698e0: 6464 733a 0d0a 2020 2020 2020 2020 2020  dds:..          
+000698f0: 2020 6466 2e6c 6f63 5b3a 2c74 7363 6f6c    df.loc[:,tscol
+00069900: 2b27 5f6d 6f6e 7468 5f64 6179 6f66 7765  +'_month_dayofwe
+00069910: 656b 5f63 726f 7373 275d 203d 2064 665b  ek_cross'] = df[
+00069920: 7473 636f 6c2b 275f 6d6f 6e74 6827 5d20  tscol+'_month'] 
+00069930: 2b22 2022 2b20 6466 5b74 7363 6f6c 2b27  +" "+ df[tscol+'
+00069940: 5f64 6179 6f66 7765 656b 275d 0d0a 2020  _dayofweek']..  
+00069950: 2020 2020 2020 2020 2020 6474 5f61 6464            dt_add
+00069960: 732e 6170 7065 6e64 2874 7363 6f6c 2b27  s.append(tscol+'
+00069970: 5f6d 6f6e 7468 5f64 6179 6f66 7765 656b  _month_dayofweek
+00069980: 5f63 726f 7373 2729 0d0a 2020 2020 2020  _cross')..      
+00069990: 2020 6466 5b74 7363 6f6c 2b27 5f79 6561    df[tscol+'_yea
+000699a0: 7227 5d20 3d20 6466 5b74 7363 6f6c 5d2e  r'] = df[tscol].
+000699b0: 6474 2e79 6561 722e 6669 6c6c 6e61 2830  dt.year.fillna(0
+000699c0: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
+000699d0: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+000699e0: 7070 656e 6428 7473 636f 6c2b 275f 7965  ppend(tscol+'_ye
+000699f0: 6172 2729 0d0a 2020 2020 2020 2020 746f  ar')..        to
+00069a00: 6461 7920 3d20 6461 7465 2e74 6f64 6179  day = date.today
+00069a10: 2829 0d0a 2020 2020 2020 2020 6466 5b74  ()..        df[t
+00069a20: 7363 6f6c 2b27 5f61 6765 5f69 6e5f 7965  scol+'_age_in_ye
+00069a30: 6172 7327 5d20 3d20 746f 6461 792e 7965  ars'] = today.ye
+00069a40: 6172 202d 2064 665b 7473 636f 6c5d 2e64  ar - df[tscol].d
+00069a50: 742e 7965 6172 2e66 696c 6c6e 6128 3029  t.year.fillna(0)
+00069a60: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+00069a70: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
+00069a80: 7065 6e64 2874 7363 6f6c 2b27 5f61 6765  pend(tscol+'_age
+00069a90: 5f69 6e5f 7965 6172 7327 290d 0a20 2020  _in_years')..   
+00069aa0: 2020 2020 2064 665b 7473 636f 6c2b 275f       df[tscol+'_
+00069ab0: 6461 796f 6679 6561 7227 5d20 3d20 6466  dayofyear'] = df
+00069ac0: 5b74 7363 6f6c 5d2e 6474 2e64 6179 6f66  [tscol].dt.dayof
+00069ad0: 7965 6172 2e66 696c 6c6e 6128 3029 2e61  year.fillna(0).a
+00069ae0: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
+00069af0: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
+00069b00: 6e64 2874 7363 6f6c 2b27 5f64 6179 6f66  nd(tscol+'_dayof
+00069b10: 7965 6172 2729 0d0a 2020 2020 2020 2020  year')..        
+00069b20: 6466 5b74 7363 6f6c 2b27 5f64 6179 6f66  df[tscol+'_dayof
+00069b30: 6d6f 6e74 6827 5d20 3d20 6466 5b74 7363  month'] = df[tsc
+00069b40: 6f6c 5d2e 6474 2e64 6179 2e66 696c 6c6e  ol].dt.day.filln
+00069b50: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+00069b60: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
+00069b70: 732e 6170 7065 6e64 2874 7363 6f6c 2b27  s.append(tscol+'
+00069b80: 5f64 6179 6f66 6d6f 6e74 6827 290d 0a20  _dayofmonth').. 
+00069b90: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
+00069ba0: 275f 7765 656b 6f66 7965 6172 275d 203d  '_weekofyear'] =
+00069bb0: 2064 665b 7473 636f 6c5d 2e64 742e 7765   df[tscol].dt.we
+00069bc0: 656b 6f66 7965 6172 2e66 696c 6c6e 6128  ekofyear.fillna(
+00069bd0: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
+00069be0: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
+00069bf0: 6170 7065 6e64 2874 7363 6f6c 2b27 5f77  append(tscol+'_w
+00069c00: 6565 6b6f 6679 6561 7227 290d 0a20 2020  eekofyear')..   
+00069c10: 2020 2020 2077 6565 6b65 6e64 7320 3d20       weekends = 
+00069c20: 2864 665b 7473 636f 6c2b 275f 6461 796f  (df[tscol+'_dayo
+00069c30: 6677 6565 6b27 5d20 3d3d 2027 5361 7427  fweek'] == 'Sat'
+00069c40: 2920 7c20 2864 665b 7473 636f 6c2b 275f  ) | (df[tscol+'_
+00069c50: 6461 796f 6677 6565 6b27 5d20 3d3d 2027  dayofweek'] == '
+00069c60: 5375 6e27 290d 0a20 2020 2020 2020 2064  Sun')..        d
+00069c70: 665b 7473 636f 6c2b 275f 7479 7065 6f66  f[tscol+'_typeof
+00069c80: 6461 7927 5d20 3d20 2777 6565 6b64 6179  day'] = 'weekday
+00069c90: 270d 0a20 2020 2020 2020 2064 662e 6c6f  '..        df.lo
+00069ca0: 635b 7765 656b 656e 6473 2c20 7473 636f  c[weekends, tsco
+00069cb0: 6c2b 275f 7479 7065 6f66 6461 7927 5d20  l+'_typeofday'] 
+00069cc0: 3d20 2777 6565 6b65 6e64 270d 0a20 2020  = 'weekend'..   
+00069cd0: 2020 2020 2064 745f 6164 6473 2e61 7070       dt_adds.app
+00069ce0: 656e 6428 7473 636f 6c2b 275f 7479 7065  end(tscol+'_type
+00069cf0: 6f66 6461 7927 290d 0a20 2020 2020 2020  ofday')..       
+00069d00: 2069 6620 7473 636f 6c2b 275f 7479 7065   if tscol+'_type
+00069d10: 6f66 6461 7927 2069 6e20 6474 5f61 6464  ofday' in dt_add
+00069d20: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00069d30: 6466 2e6c 6f63 5b3a 2c74 7363 6f6c 2b27  df.loc[:,tscol+'
+00069d40: 5f6d 6f6e 7468 5f74 7970 656f 6664 6179  _month_typeofday
+00069d50: 5f63 726f 7373 275d 203d 2064 665b 7473  _cross'] = df[ts
+00069d60: 636f 6c2b 275f 6d6f 6e74 6827 5d20 2b22  col+'_month'] +"
+00069d70: 2022 2b20 6466 5b74 7363 6f6c 2b27 5f74   "+ df[tscol+'_t
+00069d80: 7970 656f 6664 6179 275d 0d0a 2020 2020  ypeofday']..    
+00069d90: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
+00069da0: 6170 7065 6e64 2874 7363 6f6c 2b27 5f6d  append(tscol+'_m
+00069db0: 6f6e 7468 5f74 7970 656f 6664 6179 5f63  onth_typeofday_c
+00069dc0: 726f 7373 2729 0d0a 2020 2020 6578 6365  ross')..    exce
+00069dd0: 7074 3a0d 0a20 2020 2020 2020 2070 7269  pt:..        pri
+00069de0: 6e74 2827 2020 2020 4572 726f 7220 696e  nt('    Error in
+00069df0: 2063 7265 6174 696e 6720 6461 7465 2074   creating date t
+00069e00: 696d 6520 6465 7269 7665 6420 6665 6174  ime derived feat
+00069e10: 7572 6573 2e20 436f 6e74 696e 7569 6e67  ures. Continuing
+00069e20: 2e2e 2e27 290d 0a20 2020 2070 7269 6e74  ...')..    print
+00069e30: 2827 2020 2020 4164 6465 6420 2564 2063  ('    Added %d c
+00069e40: 6f6c 756d 6e73 2066 726f 6d20 2573 2063  olumns from %s c
+00069e50: 6f6c 756d 6e27 2025 286c 656e 2864 745f  olumn' %(len(dt_
+00069e60: 6164 6473 292c 7473 636f 6c29 290d 0a20  adds),tscol)).. 
+00069e70: 2020 2064 6620 3d20 6466 5b64 745f 6164     df = df[dt_ad
+00069e80: 6473 5d0d 0a20 2020 2072 6574 7572 6e20  ds]..    return 
+00069e90: 6466 0d0a 2323 2323 2323 2323 2323 2323  df..############
+00069ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069ed0: 2323 2323 0d0a 6672 6f6d 2064 6174 6575  ####..from dateu
+00069ee0: 7469 6c2e 7265 6c61 7469 7665 6465 6c74  til.relativedelt
+00069ef0: 6120 696d 706f 7274 2072 656c 6174 6976  a import relativ
+00069f00: 6564 656c 7461 0d0a 6672 6f6d 2064 6174  edelta..from dat
+00069f10: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
+00069f20: 650d 0a23 2323 2323 2054 6869 7320 6973  e..##### This is
+00069f30: 2061 206c 6974 746c 6520 7574 696c 6974   a little utilit
+00069f40: 7920 7468 6174 2063 6f6d 7075 7465 7320  y that computes 
+00069f50: 6167 6520 6672 6f6d 2079 6561 7220 2323  age from year ##
+00069f60: 2323 0d0a 6465 6620 636f 6d70 7574 655f  ##..def compute_
+00069f70: 6167 6528 7965 6172 5f73 7472 696e 6729  age(year_string)
+00069f80: 3a0d 0a20 2020 2074 6f64 6179 203d 2064  :..    today = d
+00069f90: 6174 652e 746f 6461 7928 290d 0a20 2020  ate.today()..   
+00069fa0: 2061 6765 203d 2072 656c 6174 6976 6564   age = relatived
+00069fb0: 656c 7461 2874 6f64 6179 2c20 7965 6172  elta(today, year
+00069fc0: 5f73 7472 696e 6729 0d0a 2020 2020 7265  _string)..    re
+00069fd0: 7475 726e 2061 6765 2e79 6561 7273 0d0a  turn age.years..
+00069fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00069ff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a020: 230d 0a64 6566 2063 7265 6174 655f 7469  #..def create_ti
+0006a030: 6d65 5f73 6572 6965 735f 6665 6174 7572  me_series_featur
+0006a040: 6573 2864 7466 2c20 7473 5f63 6f6c 756d  es(dtf, ts_colum
+0006a050: 6e29 3a0d 0a20 2020 2022 2222 0d0a 2020  n):..    """..  
+0006a060: 2020 5468 6973 2063 7265 6174 6573 2062    This creates b
+0006a070: 6574 7765 656e 2038 2061 6e64 2031 3020  etween 8 and 10 
+0006a080: 6461 7465 2074 696d 6520 6665 6174 7572  date time featur
+0006a090: 6573 2066 6f72 2065 6163 6820 6461 7465  es for each date
+0006a0a0: 2076 6172 6961 626c 652e 2054 6865 206e   variable. The n
+0006a0b0: 756d 6265 7220 6f66 2066 6561 7475 7265  umber of feature
+0006a0c0: 730d 0a20 2020 2064 6570 656e 6473 206f  s..    depends o
+0006a0d0: 6e20 7768 6574 6865 7220 6974 2069 7320  n whether it is 
+0006a0e0: 6a75 7374 2061 2079 6561 7220 7661 7269  just a year vari
+0006a0f0: 6162 6c65 206f 7220 6120 7965 6172 2b6d  able or a year+m
+0006a100: 6f6e 7468 2b64 6179 2061 6e64 2077 6865  onth+day and whe
+0006a110: 7468 6572 2069 7420 6861 7320 686f 7572  ther it has hour
+0006a120: 7320 616e 6420 6d69 6e73 2b73 6563 732e  s and mins+secs.
+0006a130: 0d0a 2020 2020 536f 2074 6869 7320 6361  ..    So this ca
+0006a140: 6e20 6372 6561 7465 2061 6c6c 2074 6865  n create all the
+0006a150: 7365 2066 6561 7475 7265 7320 7573 696e  se features usin
+0006a160: 6720 6a75 7374 2074 6865 2064 6174 6520  g just the date 
+0006a170: 7469 6d65 2063 6f6c 756d 6e20 7468 6174  time column that
+0006a180: 2079 6f75 2073 656e 6420 696e 2e0d 0a20   you send in... 
+0006a190: 2020 2049 7420 7265 7475 726e 7320 7468     It returns th
+0006a1a0: 6520 656e 7469 7265 2064 6174 6166 7261  e entire datafra
+0006a1b0: 6d65 2077 6974 6820 6164 6465 6420 7661  me with added va
+0006a1c0: 7269 6162 6c65 7320 6173 206f 7574 7075  riables as outpu
+0006a1d0: 742e 0d0a 2020 2020 2222 220d 0a20 2020  t...    """..   
+0006a1e0: 2064 7466 203d 2063 6f70 792e 6465 6570   dtf = copy.deep
+0006a1f0: 636f 7079 2864 7466 290d 0a20 2020 2023  copy(dtf)..    #
+0006a200: 2323 2320 4966 2066 6f72 2073 6f6d 6520  ### If for some 
+0006a210: 7265 6173 6f6e 2074 735f 636f 6c75 6d6e  reason ts_column
+0006a220: 2069 7320 6a75 7374 2061 206e 756d 6265   is just a numbe
+0006a230: 722c 206d 616b 6520 7375 7265 2069 7420  r, make sure it 
+0006a240: 6973 2061 2073 7472 696e 6720 736f 2069  is a string so i
+0006a250: 7420 646f 6573 206e 6f74 2062 6c6f 7720  t does not blow 
+0006a260: 7570 2061 6e64 2063 6f6e 6361 7465 6e61  up and concatena
+0006a270: 7465 640d 0a20 2020 2069 6620 6e6f 7420  ted..    if not 
+0006a280: 6973 696e 7374 616e 6365 2874 735f 636f  isinstance(ts_co
+0006a290: 6c75 6d6e 2c73 7472 293a 0d0a 2020 2020  lumn,str):..    
+0006a2a0: 2020 2020 7473 5f63 6f6c 756d 6e20 3d20      ts_column = 
+0006a2b0: 7374 7228 7473 5f63 6f6c 756d 6e29 0d0a  str(ts_column)..
+0006a2c0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0006a2d0: 2020 2323 2320 496e 2073 6f6d 6520 6578    ### In some ex
+0006a2e0: 7472 656d 6520 6361 7365 732c 2064 6174  treme cases, dat
+0006a2f0: 6520 7469 6d65 2076 6172 7320 6172 6520  e time vars are 
+0006a300: 6e6f 7420 7072 6f63 6573 7365 6420 7965  not processed ye
+0006a310: 7420 616e 6420 6865 6e63 6520 7765 206d  t and hence we m
+0006a320: 7573 7420 6669 6c6c 206d 6973 7369 6e67  ust fill missing
+0006a330: 2076 616c 7565 7320 6865 7265 210d 0a20   values here!.. 
+0006a340: 2020 2020 2020 2069 6620 6474 665b 7473         if dtf[ts
+0006a350: 5f63 6f6c 756d 6e5d 2e69 736e 756c 6c28  _column].isnull(
+0006a360: 292e 7375 6d28 2920 3e20 303a 0d0a 2020  ).sum() > 0:..  
+0006a370: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
+0006a380: 675f 666c 6167 203d 2054 7275 650d 0a20  g_flag = True.. 
+0006a390: 2020 2020 2020 2020 2020 206e 6577 5f6d             new_m
+0006a3a0: 6973 7369 6e67 5f63 6f6c 203d 2074 735f  issing_col = ts_
+0006a3b0: 636f 6c75 6d6e 202b 2027 5f4d 6973 7369  column + '_Missi
+0006a3c0: 6e67 5f46 6c61 6727 0d0a 2020 2020 2020  ng_Flag'..      
+0006a3d0: 2020 2020 2020 6474 665b 6e65 775f 6d69        dtf[new_mi
+0006a3e0: 7373 696e 675f 636f 6c5d 203d 2030 0d0a  ssing_col] = 0..
+0006a3f0: 2020 2020 2020 2020 2020 2020 6474 662e              dtf.
+0006a400: 6c6f 635b 6474 665b 7473 5f63 6f6c 756d  loc[dtf[ts_colum
+0006a410: 6e5d 2e69 736e 756c 6c28 292c 6e65 775f  n].isnull(),new_
+0006a420: 6d69 7373 696e 675f 636f 6c5d 3d31 0d0a  missing_col]=1..
+0006a430: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0006a440: 5265 6d65 6d62 6572 2074 6861 7420 6669  Remember that fi
+0006a450: 6c6c 6e61 206f 6e6c 7920 776f 726b 7320  llna only works 
+0006a460: 6174 2074 6865 2064 6174 6166 7261 6d65  at the dataframe
+0006a470: 206c 6576 656c 210d 0a20 2020 2020 2020   level!..       
+0006a480: 2020 2020 2064 7466 5b5b 7473 5f63 6f6c       dtf[[ts_col
+0006a490: 756d 6e5d 5d20 3d20 6474 665b 5b74 735f  umn]] = dtf[[ts_
+0006a4a0: 636f 6c75 6d6e 5d5d 2e66 696c 6c6e 6128  column]].fillna(
+0006a4b0: 6d65 7468 6f64 3d27 6666 696c 6c27 290d  method='ffill').
+0006a4c0: 0a20 2020 2020 2020 2069 6620 6474 665b  .        if dtf[
+0006a4d0: 7473 5f63 6f6c 756d 6e5d 2e64 7479 7065  ts_column].dtype
+0006a4e0: 2069 6e20 5b6e 702e 666c 6f61 7436 342c   in [np.float64,
+0006a4f0: 6e70 2e66 6c6f 6174 3332 2c6e 702e 666c  np.float32,np.fl
+0006a500: 6f61 7431 365d 3a0d 0a20 2020 2020 2020  oat16]:..       
+0006a510: 2020 2020 2064 7466 5b74 735f 636f 6c75       dtf[ts_colu
+0006a520: 6d6e 5d20 3d20 6474 665b 7473 5f63 6f6c  mn] = dtf[ts_col
+0006a530: 756d 6e5d 2e61 7374 7970 6528 696e 7429  umn].astype(int)
+0006a540: 0d0a 2020 2020 2020 2020 2323 2320 6966  ..        ### if
+0006a550: 2077 6520 6861 7665 2061 6c72 6561 6479   we have already
+0006a560: 2066 6f75 6e64 2074 6861 7420 6974 2077   found that it w
+0006a570: 6173 2061 2064 6174 6520 7469 6d65 2076  as a date time v
+0006a580: 6172 2c20 7468 656e 206c 6561 7665 2069  ar, then leave i
+0006a590: 7420 6173 2069 7420 6973 2e20 5468 6174  t as it is. That
+0006a5a0: 7320 676f 6f64 2065 6e6f 7567 6821 0d0a  s good enough!..
+0006a5b0: 2020 2020 2020 2020 6461 7465 5f69 7465          date_ite
+0006a5c0: 6d73 203d 2064 7466 5b74 735f 636f 6c75  ms = dtf[ts_colu
+0006a5d0: 6d6e 5d2e 6170 706c 7928 7374 7229 2e61  mn].apply(str).a
+0006a5e0: 7070 6c79 286c 656e 292e 7661 6c75 6573  pply(len).values
+0006a5f0: 0d0a 2020 2020 2020 2020 2323 2323 2049  ..        #### I
+0006a600: 6e20 736f 6d65 2065 7874 7265 6d65 2063  n some extreme c
+0006a610: 6173 6573 2c0d 0a20 2020 2020 2020 2069  ases,..        i
+0006a620: 6620 616c 6c28 6461 7465 5f69 7465 6d73  f all(date_items
+0006a630: 5b30 5d20 3d3d 2069 7465 6d20 666f 7220  [0] == item for 
+0006a640: 6974 656d 2069 6e20 6461 7465 5f69 7465  item in date_ite
+0006a650: 6d73 293a 0d0a 2020 2020 2020 2020 2020  ms):..          
+0006a660: 2020 6966 2064 6174 655f 6974 656d 735b    if date_items[
+0006a670: 305d 203d 3d20 343a 0d0a 2020 2020 2020  0] == 4:..      
+0006a680: 2020 2020 2020 2020 2020 2323 2320 4966            ### If
+0006a690: 2069 7420 6973 206a 7573 7420 6120 7965   it is just a ye
+0006a6a0: 6172 2076 6172 6961 626c 6520 616c 6f6e  ar variable alon
+0006a6b0: 652c 2079 6f75 2073 686f 756c 6420 6c65  e, you should le
+0006a6c0: 6176 6520 6974 2061 7320 6a75 7374 2061  ave it as just a
+0006a6d0: 2079 6561 7221 0d0a 2020 2020 2020 2020   year!..        
+0006a6e0: 2020 2020 2020 2020 6167 655f 636f 6c20          age_col 
+0006a6f0: 3d20 7473 5f63 6f6c 756d 6e2b 275f 6167  = ts_column+'_ag
+0006a700: 655f 696e 5f79 6561 7273 270d 0a20 2020  e_in_years'..   
+0006a710: 2020 2020 2020 2020 2020 2020 2064 7466               dtf
+0006a720: 5b61 6765 5f63 6f6c 5d20 3d20 6474 665b  [age_col] = dtf[
+0006a730: 7473 5f63 6f6c 756d 6e5d 2e6d 6170 286c  ts_column].map(l
+0006a740: 616d 6264 6120 783a 2070 642e 746f 5f64  ambda x: pd.to_d
+0006a750: 6174 6574 696d 6528 782c 666f 726d 6174  atetime(x,format
+0006a760: 3d27 2559 2729 292e 6170 706c 7928 636f  ='%Y')).apply(co
+0006a770: 6d70 7574 655f 6167 6529 2e76 616c 7565  mpute_age).value
+0006a780: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0006a790: 2020 2072 6574 7572 6e20 6474 665b 5b74     return dtf[[t
+0006a7a0: 735f 636f 6c75 6d6e 2c61 6765 5f63 6f6c  s_column,age_col
+0006a7b0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
+0006a7c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0006a7d0: 2020 2020 2020 2023 2323 2069 6620 6974         ### if it
+0006a7e0: 2069 7320 6e6f 7420 6120 7965 6172 2061   is not a year a
+0006a7f0: 6c6f 6e65 2c20 7468 656e 2063 6f6e 7665  lone, then conve
+0006a800: 7274 2069 7420 696e 746f 2061 2064 6174  rt it into a dat
+0006a810: 6520 7469 6d65 2076 6172 6961 626c 650d  e time variable.
+0006a820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006a830: 2064 7466 5b74 735f 636f 6c75 6d6e 5d20   dtf[ts_column] 
+0006a840: 3d20 7064 2e74 6f5f 6461 7465 7469 6d65  = pd.to_datetime
+0006a850: 2864 7466 5b74 735f 636f 6c75 6d6e 5d2c  (dtf[ts_column],
+0006a860: 2069 6e66 6572 5f64 6174 6574 696d 655f   infer_datetime_
+0006a870: 666f 726d 6174 3d54 7275 6529 0d0a 2020  format=True)..  
+0006a880: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0006a890: 2020 2020 2020 2020 2064 7466 5b74 735f           dtf[ts_
+0006a8a0: 636f 6c75 6d6e 5d20 3d20 7064 2e74 6f5f  column] = pd.to_
+0006a8b0: 6461 7465 7469 6d65 2864 7466 5b74 735f  datetime(dtf[ts_
+0006a8c0: 636f 6c75 6d6e 5d2c 2069 6e66 6572 5f64  column], infer_d
+0006a8d0: 6174 6574 696d 655f 666f 726d 6174 3d54  atetime_format=T
+0006a8e0: 7275 6529 0d0a 2020 2020 2020 2020 6474  rue)..        dt
+0006a8f0: 6620 3d20 6372 6561 7465 5f74 735f 6665  f = create_ts_fe
+0006a900: 6174 7572 6573 2864 7466 2c74 735f 636f  atures(dtf,ts_co
+0006a910: 6c75 6d6e 290d 0a20 2020 2065 7863 6570  lumn)..    excep
+0006a920: 743a 0d0a 2020 2020 2020 2020 7072 696e  t:..        prin
+0006a930: 7428 2745 7272 6f72 2069 6e20 5072 6f63  t('Error in Proc
+0006a940: 6573 7369 6e67 2025 7320 636f 6c75 6d6e  essing %s column
+0006a950: 2066 6f72 2064 6174 6520 7469 6d65 2066   for date time f
+0006a960: 6561 7475 7265 732e 2043 6f6e 7469 6e75  eatures. Continu
+0006a970: 696e 672e 2e2e 2720 2574 735f 636f 6c75  ing...' %ts_colu
+0006a980: 6d6e 290d 0a20 2020 2072 6574 7572 6e20  mn)..    return 
+0006a990: 6474 660d 0a23 2323 2323 2323 2323 2323  dtf..###########
+0006a9a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006a9b0: 2323 2323 2323 2323 2323 2323 230d 0a66  #############..f
+0006a9c0: 726f 6d20 636f 6c6c 6563 7469 6f6e 7320  rom collections 
+0006a9d0: 696d 706f 7274 2043 6f75 6e74 6572 0d0a  import Counter..
+0006a9e0: 696d 706f 7274 2074 696d 650d 0a23 2323  import time..###
+0006a9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aa00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aa10: 2323 2323 230d 0a69 6d70 6f72 7420 7761  #####..import wa
+0006aa20: 726e 696e 6773 0d0a 7761 726e 696e 6773  rnings..warnings
+0006aa30: 2e66 696c 7465 7277 6172 6e69 6e67 7328  .filterwarnings(
+0006aa40: 2269 676e 6f72 6522 290d 0a66 726f 6d20  "ignore")..from 
+0006aa50: 736b 6c65 6172 6e2e 6578 6365 7074 696f  sklearn.exceptio
+0006aa60: 6e73 2069 6d70 6f72 7420 4461 7461 436f  ns import DataCo
+0006aa70: 6e76 6572 7369 6f6e 5761 726e 696e 670d  nversionWarning.
+0006aa80: 0a77 6172 6e69 6e67 732e 6669 6c74 6572  .warnings.filter
+0006aa90: 7761 726e 696e 6773 2861 6374 696f 6e3d  warnings(action=
+0006aaa0: 2769 676e 6f72 6527 2c20 6361 7465 676f  'ignore', catego
+0006aab0: 7279 3d44 6174 6143 6f6e 7665 7273 696f  ry=DataConversio
+0006aac0: 6e57 6172 6e69 6e67 290d 0a23 2323 2323  nWarning)..#####
+0006aad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006aaf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ab00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ab10: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0006ab20: 0a66 726f 6d20 736b 6c65 6172 6e2e 7574  .from sklearn.ut
+0006ab30: 696c 732e 636c 6173 735f 7765 6967 6874  ils.class_weight
+0006ab40: 2069 6d70 6f72 7420 636f 6d70 7574 655f   import compute_
+0006ab50: 636c 6173 735f 7765 6967 6874 0d0a 6672  class_weight..fr
+0006ab60: 6f6d 2069 6d62 6c65 6172 6e2e 6f76 6572  om imblearn.over
+0006ab70: 5f73 616d 706c 696e 6720 696d 706f 7274  _sampling import
+0006ab80: 2053 4d4f 5445 2c20 534d 4f54 454e 430d   SMOTE, SMOTENC.
+0006ab90: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
+0006aba0: 7320 696d 706f 7274 2043 6f75 6e74 6572  s import Counter
+0006abb0: 0d0a 696d 706f 7274 2063 6f70 790d 0a69  ..import copy..i
+0006abc0: 6d70 6f72 7420 7064 620d 0a23 2323 2323  mport pdb..#####
+0006abd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006abe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006abf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ac00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ac10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ac20: 2323 0d0a 2323 2320 5265 6772 6573 7369  ##..### Regressi
+0006ac30: 6f6e 5f52 6573 616d 706c 6572 2069 7320  on_Resampler is 
+0006ac40: 6120 6e65 6174 206c 6962 7261 7279 2074  a neat library t
+0006ac50: 6861 7420 7265 7475 726e 7320 6120 6e75  hat returns a nu
+0006ac60: 6d70 7920 6c69 7374 206f 6620 636c 6173  mpy list of clas
+0006ac70: 7365 7320 666f 7220 6561 6368 0d0a 2323  ses for each..##
+0006ac80: 2320 2063 6f72 7265 7370 6f6e 6469 6e67  #  corresponding
+0006ac90: 2073 616d 706c 652e 2066 726f 6d20 7461   sample. from ta
+0006aca0: 7267 6574 2064 6174 612e 2049 7420 656e  rget data. It en
+0006acb0: 6162 6c65 7320 7265 6772 6573 6973 6f6e  ables regresison
+0006acc0: 2070 726f 626c 656d 7320 746f 2075 7365   problems to use
+0006acd0: 2053 4d4f 5445 2e0d 0a23 2323 2020 4920   SMOTE...###  I 
+0006ace0: 6861 7665 2075 7365 6420 6120 7369 6d69  have used a simi
+0006acf0: 6c61 7220 636f 6e63 6570 7420 6275 7420  lar concept but 
+0006ad00: 696d 706c 656d 656e 7465 6420 6974 206d  implemented it m
+0006ad10: 7920 7761 7920 7573 696e 6720 4b2d 4d65  y way using K-Me
+0006ad20: 616e 7320 616c 676f 7269 7468 6d2e 0d0a  ans algorithm...
+0006ad30: 2323 2320 204d 7920 7369 6e63 6572 6520  ###  My sincere 
+0006ad40: 7468 616e 6b73 2074 6f20 7468 6520 6372  thanks to the cr
+0006ad50: 6561 746f 7273 206f 6620 7468 6520 6c69  eators of the li
+0006ad60: 6272 6172 793a 0d0a 2323 2320 2020 2020  brary:..###     
+0006ad70: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0006ad80: 6f6d 2f61 7469 662d 6861 7373 616e 2f52  om/atif-hassan/R
+0006ad90: 6567 7265 7373 696f 6e5f 5265 5361 6d70  egression_ReSamp
+0006ada0: 6c69 6e67 2f0d 0a23 2323 2323 2323 2323  ling/..#########
+0006adb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006adc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006add0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ade0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006adf0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006ae00: 6465 6620 7472 6169 6e69 6e67 5f77 6974  def training_wit
+0006ae10: 685f 534d 4f54 4528 585f 6466 2c79 5f64  h_SMOTE(X_df,y_d
+0006ae20: 662c 7461 7267 6574 2c65 7661 6c5f 7365  f,target,eval_se
+0006ae30: 742c 6d6f 6465 6c5f 696e 7075 742c 426f  t,model_input,Bo
+0006ae40: 6f73 7469 6e67 5f46 6c61 672c 6576 616c  osting_Flag,eval
+0006ae50: 5f6d 6574 7269 632c 0d0a 2020 2020 2020  _metric,..      
+0006ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ae80: 2020 6d6f 6465 6c74 7970 652c 206d 6f64    modeltype, mod
+0006ae90: 656c 5f6e 616d 652c 0d0a 2020 2020 2020  el_name,..      
+0006aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006aeb0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0006aec0: 7261 696e 696e 673d 5472 7565 2c6d 696e  raining=True,min
+0006aed0: 6f72 6974 795f 636c 6173 733d 312c 696d  ority_class=1,im
+0006aee0: 705f 6361 7473 3d5b 5d2c 0d0a 2020 2020  p_cats=[],..    
+0006aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006af10: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
+0006af20: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
+0006af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006af40: 2020 2020 2020 2020 2020 2020 2020 4750                GP
+0006af50: 555f 6578 6973 7473 3d46 616c 7365 2c20  U_exists=False, 
+0006af60: 7061 7261 6d73 3d7b 7d2c 0d0a 2020 2020  params={},..    
+0006af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006af90: 206d 6f64 656c 5f6c 6162 656c 3d27 5369   model_label='Si
+0006afa0: 6e67 6c65 5f4c 6162 656c 272c 2076 6572  ngle_Label', ver
+0006afb0: 626f 7365 3d30 293a 0d0a 2020 2020 2222  bose=0):..    ""
+0006afc0: 220d 0a20 2020 2023 2323 2323 2323 2323  "..    #########
+0006afd0: 2020 2020 4f56 4552 5341 4d50 4c49 4e47      OVERSAMPLING
+0006afe0: 204f 4620 4d49 4e4f 5249 5459 2043 4c41   OF MINORITY CLA
+0006aff0: 5353 2041 4e44 2054 5241 494e 494e 4720  SS AND TRAINING 
+0006b000: 2053 495a 4553 2020 2323 2323 2323 2323   SIZES  ########
+0006b010: 2323 2323 2323 230d 0a20 2020 2023 2323  #######..    ###
+0006b020: 2320 2053 4d4f 5445 2028 5379 6e74 6865  #  SMOTE (Synthe
+0006b030: 7469 6320 4d69 6e6f 7269 7479 204f 7665  tic Minority Ove
+0006b040: 7273 616d 706c 696e 6720 5465 6368 6e69  rsampling Techni
+0006b050: 7175 6529 2077 6f72 6b73 2077 656c 6c20  que) works well 
+0006b060: 7769 7468 2069 6d62 616c 616e 6365 6420  with imbalanced 
+0006b070: 636c 6173 7365 732e 0d0a 2020 2020 2323  classes...    ##
+0006b080: 2323 2020 5468 6973 2069 7320 6120 6772  ##  This is a gr
+0006b090: 6561 7420 7761 7920 746f 2074 7261 696e  eat way to train
+0006b0a0: 2061 206d 6f64 656c 2069 6e20 7375 6368   a model in such
+0006b0b0: 2063 6173 6573 2077 6974 6820 7265 7065   cases with repe
+0006b0c0: 6174 6564 2073 616d 706c 6573 206f 6620  ated samples of 
+0006b0d0: 7261 7265 2d63 6c61 7373 0d0a 2020 2020  rare-class..    
+0006b0e0: 2323 2323 2020 616c 6f6e 6720 7769 7468  ####  along with
+0006b0f0: 2062 6174 6368 6573 206f 6620 6d61 6a6f   batches of majo
+0006b100: 7269 7479 2063 6c61 7373 2061 6e64 2067  rity class and g
+0006b110: 6574 2074 6865 206d 6f64 656c 2074 6f20  et the model to 
+0006b120: 6469 6666 6572 656e 7469 6174 6520 6265  differentiate be
+0006b130: 7477 6565 6e20 3220 636c 6173 7365 732e  tween 2 classes.
+0006b140: 0d0a 2020 2020 2323 2323 2020 5468 6973  ..    ####  This
+0006b150: 2063 616e 2061 6c73 6f20 6265 2075 7365   can also be use
+0006b160: 6420 666f 7220 5265 6772 6573 7369 6f6e  d for Regression
+0006b170: 2070 726f 626c 656d 7320 6279 2075 7369   problems by usi
+0006b180: 6e67 2074 6865 206e 756d 6572 6963 2074  ng the numeric t
+0006b190: 6172 6765 7420 7661 6c75 6573 2063 6f6e  arget values con
+0006b1a0: 7665 7274 6564 0d0a 2020 2020 2323 2323  verted..    ####
+0006b1b0: 2020 746f 2063 6c75 7374 6572 206c 6162    to cluster lab
+0006b1c0: 656c 7320 7573 696e 6720 4b4d 6561 6e73  els using KMeans
+0006b1d0: 2e20 596f 7520 6361 6e20 7468 656e 2075  . You can then u
+0006b1e0: 7365 2074 6865 2063 6c75 7374 6572 206c  se the cluster l
+0006b1f0: 6162 656c 7320 746f 2061 6464 206d 6f72  abels to add mor
+0006b200: 6520 7361 6d70 6c65 732e 0d0a 2020 2020  e samples...    
+0006b210: 2323 2323 2323 2323 2320 2020 204d 414b  #########    MAK
+0006b220: 4520 5355 5245 2059 4f55 2054 554e 4520  E SURE YOU TUNE 
+0006b230: 5448 4520 4445 4641 554c 5453 2047 4956  THE DEFAULTS GIV
+0006b240: 454e 2048 4552 4521 2020 2323 2323 2323  EN HERE!  ######
+0006b250: 2323 2323 2323 2323 230d 0a20 2020 2022  #########..    "
+0006b260: 2222 0d0a 2020 2020 585f 6466 203d 2063  ""..    X_df = c
+0006b270: 6f70 792e 6465 6570 636f 7079 2858 5f64  opy.deepcopy(X_d
+0006b280: 6629 0d0a 2020 2020 795f 6466 203d 2063  f)..    y_df = c
+0006b290: 6f70 792e 6465 6570 636f 7079 2879 5f64  opy.deepcopy(y_d
+0006b2a0: 6629 0d0a 2020 2020 6d6f 6465 6c5f 636f  f)..    model_co
+0006b2b0: 7079 203d 2063 6f70 792e 6465 6570 636f  py = copy.deepco
+0006b2c0: 7079 286d 6f64 656c 5f69 6e70 7574 290d  py(model_input).
+0006b2d0: 0a20 2020 206d 6f64 656c 203d 2063 6f70  .    model = cop
+0006b2e0: 792e 6465 6570 636f 7079 286d 6f64 656c  y.deepcopy(model
+0006b2f0: 5f63 6f70 7929 0d0a 2020 2020 7374 6172  _copy)..    star
+0006b300: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+0006b310: 6d65 2829 0d0a 2020 2020 2323 2323 2320  me()..    ##### 
+0006b320: 4e6f 7720 7765 2077 696c 6c20 7374 6172  Now we will star
+0006b330: 7420 7573 696e 6720 5265 7361 6d70 6c69  t using Resampli
+0006b340: 6e67 204c 6962 7261 7279 2074 6f20 6d61  ng Library to ma
+0006b350: 6b65 2064 6174 6120 6d6f 7265 2062 616c  ke data more bal
+0006b360: 616e 6365 6420 2323 230d 0a20 2020 2069  anced ###..    i
+0006b370: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+0006b380: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+0006b390: 2020 2020 2020 7072 696e 7428 2255 7369        print("Usi
+0006b3a0: 6e67 2052 6567 7265 7373 696f 6e20 5265  ng Regression Re
+0006b3b0: 7361 6d70 6c65 7220 6c69 6272 6172 7920  sampler library 
+0006b3c0: 746f 206d 616b 6520 736b 6577 6564 2074  to make skewed t
+0006b3d0: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
+0006b3e0: 6f72 6520 6261 6c61 6e63 6564 2e2e 2e22  ore balanced..."
+0006b3f0: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+0006b400: 2020 2020 2020 2370 7269 6e74 2822 5573        #print("Us
+0006b410: 696e 6720 534d 4f54 4527 7320 6f76 6572  ing SMOTE's over
+0006b420: 2d73 616d 706c 696e 6720 7465 6368 6e69  -sampling techni
+0006b430: 7175 6573 2074 6f20 6d61 6b65 2074 6865  ques to make the
+0006b440: 2025 6420 636c 6173 7365 7320 6261 6c61   %d classes bala
+0006b450: 6e63 6564 2e2e 2e22 2025 6c65 6e28 6e70  nced..." %len(np
+0006b460: 2e75 6e69 7175 6528 795f 6466 2929 290d  .unique(y_df))).
+0006b470: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
+0006b480: 6c74 7970 6520 3d3d 2027 4269 6e61 7279  ltype == 'Binary
+0006b490: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+0006b4a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0006b4b0: 7269 6e74 2827 5573 696e 6720 5365 6c66  rint('Using Self
+0006b4c0: 2d50 6163 6564 2045 6e73 656d 626c 6520  -Paced Ensemble 
+0006b4d0: 436c 6173 7369 6669 6572 2074 6f20 6861  Classifier to ha
+0006b4e0: 6e64 6c65 2074 6869 7320 496d 6261 6c61  ndle this Imbala
+0006b4f0: 6e63 6564 2064 6174 6173 6574 2e2e 2e27  nced dataset...'
+0006b500: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+0006b510: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0006b520: 696e 7428 2755 7369 6e67 204f 6e65 5673  int('Using OneVs
+0006b530: 5265 7374 2b53 656c 662d 5061 6365 6420  Rest+Self-Paced 
+0006b540: 456e 7365 6d62 6c65 2043 6c61 7373 6966  Ensemble Classif
+0006b550: 6965 7220 746f 2068 616e 646c 6520 7468  ier to handle th
+0006b560: 6973 2049 6d62 616c 616e 6365 6420 6461  is Imbalanced da
+0006b570: 7461 7365 742e 2e2e 2729 0d0a 2020 2020  taset...')..    
+0006b580: 7472 793a 0d0a 2020 2020 2020 2020 2323  try:..        ##
+0006b590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b5a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b5d0: 2323 2323 230d 0a20 2020 2020 2020 2023  #####..        #
+0006b5e0: 2049 6e69 7469 616c 697a 6520 7468 6520   Initialize the 
+0006b5f0: 7265 7361 6d70 6c65 7220 6f62 6a65 6374  resampler object
+0006b600: 0d0a 2020 2020 2020 2020 6466 5f74 7261  ..        df_tra
+0006b610: 696e 203d 2058 5f64 662e 6a6f 696e 2879  in = X_df.join(y
+0006b620: 5f64 6629 0d0a 2020 2020 2020 2020 2320  _df)..        # 
+0006b630: 4765 6e65 7261 7465 2063 6c61 7373 6573  Generate classes
+0006b640: 0d0a 2020 2020 2020 2020 2323 2323 2053  ..        #### S
+0006b650: 656c 6563 7420 7468 6520 7269 6768 7420  elect the right 
+0006b660: 534d 4f54 4520 616c 676f 7269 7468 6d20  SMOTE algorithm 
+0006b670: 6261 7365 6420 6f6e 2077 6865 7468 6572  based on whether
+0006b680: 2074 6865 7265 2061 7265 2061 6e79 2069   there are any i
+0006b690: 6d70 5f63 6174 7320 696e 2064 6174 610d  mp_cats in data.
+0006b6a0: 0a20 2020 2020 2020 2063 6174 5f76 6172  .        cat_var
+0006b6b0: 735f 696e 6465 7820 3d20 5b69 2066 6f72  s_index = [i for
+0006b6c0: 2069 2c20 6a20 696e 2065 6e75 6d65 7261   i, j in enumera
+0006b6d0: 7465 2858 5f64 662e 636f 6c75 6d6e 7329  te(X_df.columns)
+0006b6e0: 2069 6620 6a20 696e 2069 6d70 5f63 6174   if j in imp_cat
+0006b6f0: 735d 0d0a 2020 2020 2020 2020 2323 2320  s]..        ### 
+0006b700: 6765 7420 7468 6520 6e75 6d62 6572 206f  get the number o
+0006b710: 6620 4b5f 4e65 6967 6862 6f72 7320 7573  f K_Neighbors us
+0006b720: 696e 6720 7468 6973 2063 616c 6375 6c61  ing this calcula
+0006b730: 7469 6f6e 0d0a 2020 2020 2020 2020 7261  tion..        ra
+0006b740: 7265 5f73 616d 706c 6573 203d 2070 642e  re_samples = pd.
+0006b750: 5365 7269 6573 2843 6f75 6e74 6572 2879  Series(Counter(y
+0006b760: 5f64 6629 292e 6d69 6e28 290d 0a20 2020  _df)).min()..   
+0006b770: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
+0006b780: 204e 756d 6265 7220 6f66 2052 6172 6520   Number of Rare 
+0006b790: 436c 6173 7320 7361 6d70 6c65 7320 3d20  Class samples = 
+0006b7a0: 2564 2720 2572 6172 655f 7361 6d70 6c65  %d' %rare_sample
+0006b7b0: 7329 0d0a 2020 2020 2020 2020 7261 7265  s)..        rare
+0006b7c0: 5f70 6374 203d 2072 6172 655f 7361 6d70  _pct = rare_samp
+0006b7d0: 6c65 732f 795f 6466 2e73 6861 7065 5b30  les/y_df.shape[0
+0006b7e0: 5d0d 0a20 2020 2020 2020 2073 6d61 6c6c  ]..        small
+0006b7f0: 6573 745f 6b6e 203d 2020 7261 7265 5f73  est_kn =  rare_s
+0006b800: 616d 706c 6573 202d 2031 0d0a 2020 2020  amples - 1..    
+0006b810: 2020 2020 6966 2073 6d61 6c6c 6573 745f      if smallest_
+0006b820: 6b6e 203e 2035 3a0d 0a20 2020 2020 2020  kn > 5:..       
+0006b830: 2020 2020 2073 6d61 6c6c 6573 745f 6b6e       smallest_kn
+0006b840: 203d 2035 0d0a 2020 2020 2020 2020 656c   = 5..        el
+0006b850: 6966 2073 6d61 6c6c 6573 745f 6b6e 203e  if smallest_kn >
+0006b860: 2032 2061 6e64 2073 6d61 6c6c 6573 745f   2 and smallest_
+0006b870: 6b6e 203c 2035 3a0d 0a20 2020 2020 2020  kn < 5:..       
+0006b880: 2020 2020 2073 6d61 6c6c 6573 745f 6b6e       smallest_kn
+0006b890: 203d 2032 0d0a 2020 2020 2020 2020 656c   = 2..        el
+0006b8a0: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
+0006b8b0: 2020 736d 616c 6c65 7374 5f6b 6e20 3d20    smallest_kn = 
+0006b8c0: 310d 0a20 2020 2020 2020 2023 7072 696e  1..        #prin
+0006b8d0: 7428 2720 2020 204e 756d 6265 7220 6f66  t('    Number of
+0006b8e0: 204b 204e 6569 6768 626f 7273 2073 656c   K Neighbors sel
+0006b8f0: 6563 7465 6420 666f 7220 534d 4f54 4520  ected for SMOTE 
+0006b900: 3d20 2564 2720 2573 6d61 6c6c 6573 745f  = %d' %smallest_
+0006b910: 6b6e 290d 0a20 2020 2020 2020 2023 7072  kn)..        #pr
+0006b920: 696e 7428 2720 2020 2050 6374 206f 6620  int('    Pct of 
+0006b930: 5261 7265 2043 6c61 7373 2069 6e20 6461  Rare Class in da
+0006b940: 7461 203d 2025 302e 3266 2525 2720 2528  ta = %0.2f%%' %(
+0006b950: 7261 7265 5f70 6374 2a31 3030 2929 0d0a  rare_pct*100))..
+0006b960: 2020 2020 2020 2020 6966 2072 6172 655f          if rare_
+0006b970: 7063 7420 3e20 302e 3130 3a0d 0a20 2020  pct > 0.10:..   
+0006b980: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0006b990: 2020 2020 5468 6973 2069 7320 6e6f 7420      This is not 
+0006b9a0: 616e 2049 6d62 616c 616e 6365 6420 6461  an Imbalanced da
+0006b9b0: 7461 2073 6574 2e20 4e6f 206e 6565 6420  ta set. No need 
+0006b9c0: 746f 2075 7365 2053 4d4f 5445 2062 7574  to use SMOTE but
+0006b9d0: 2063 6f6e 7469 6e75 696e 672e 2e2e 2729   continuing...')
+0006b9e0: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
+0006b9f0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0006ba00: 2020 534d 4f54 4520 6973 2065 7272 6f72    SMOTE is error
+0006ba10: 696e 672e 2043 6f6e 7469 6e75 696e 6720  ing. Continuing 
+0006ba20: 7769 7468 6f75 7420 534d 4f54 452e 2e2e  without SMOTE...
+0006ba30: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
+0006ba40: 726e 206d 6f64 656c 0d0a 2020 2020 2020  rn model..      
+0006ba50: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0006ba60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ba70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ba80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ba90: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
+0006baa0: 2323 206e 6f77 2074 7261 696e 2074 6865  ## now train the
+0006bab0: 206d 6f64 656c 206f 6e20 6675 6c6c 2074   model on full t
+0006bac0: 7261 696e 2064 6174 6120 2323 2323 2323  rain data ######
+0006bad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006bae0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006baf0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+0006bb00: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+0006bb10: 2020 2020 2020 2023 2052 6567 7265 7373         # Regress
+0006bb20: 696f 6e20 7072 6f62 6c65 6d20 7475 726e  ion problem turn
+0006bb30: 6564 2069 6e74 6f20 436c 6173 7369 6669  ed into Classifi
+0006bb40: 6361 7469 6f6e 2070 726f 626c 656d 0d0a  cation problem..
+0006bb50: 2020 2020 2020 2020 6e5f 636c 7573 7465          n_cluste
+0006bb60: 7273 203d 206d 6178 2833 2c20 696e 7428  rs = max(3, int(
+0006bb70: 6e70 2e6c 6f67 3130 286c 656e 2879 5f64  np.log10(len(y_d
+0006bb80: 6629 2929 202b 2031 290d 0a20 2020 2020  f))) + 1)..     
+0006bb90: 2020 2023 2055 7365 204b 4d65 616e 7320     # Use KMeans 
+0006bba0: 746f 2066 696e 6420 6e61 7475 7261 6c20  to find natural 
+0006bbb0: 636c 7573 7465 7273 2069 6e20 796f 7572  clusters in your
+0006bbc0: 2064 6174 610d 0a20 2020 2020 2020 206b   data..        k
+0006bbd0: 6d5f 6d6f 6465 6c20 3d20 4b4d 6561 6e73  m_model = KMeans
+0006bbe0: 286e 5f63 6c75 7374 6572 733d 6e5f 636c  (n_clusters=n_cl
+0006bbf0: 7573 7465 7273 2c0d 0a20 2020 2020 2020  usters,..       
+0006bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bc10: 2020 206e 5f69 6e69 743d 352c 0d0a 2020     n_init=5,..  
+0006bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bc30: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+0006bc40: 7461 7465 3d39 3929 0d0a 2020 2020 2020  tate=99)..      
+0006bc50: 2020 2323 2323 2072 656d 656d 6265 7220    #### remember 
+0006bc60: 796f 7520 6d75 7374 2070 7265 6469 6374  you must predict
+0006bc70: 2075 7369 6e67 206f 6e6c 7920 7072 6564   using only pred
+0006bc80: 6963 746f 7220 7661 7269 6162 6c65 7321  ictor variables!
+0006bc90: 0d0a 2020 2020 2020 2020 595f 636c 6173  ..        Y_clas
+0006bca0: 7365 7320 3d20 6b6d 5f6d 6f64 656c 2e66  ses = km_model.f
+0006bcb0: 6974 5f70 7265 6469 6374 2858 5f64 6629  it_predict(X_df)
+0006bcc0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0006bcd0: 2020 2020 2059 5f63 6c61 7373 6573 203d       Y_classes =
+0006bce0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
+0006bcf0: 5f64 6629 0d0a 2020 2020 2323 2323 2053  _df)..    #### S
+0006bd00: 4d4f 5445 2077 6f72 6b73 206f 6e6c 7920  MOTE works only 
+0006bd10: 666f 7220 5369 6e67 6c65 204c 6162 656c  for Single Label
+0006bd20: 2070 726f 626c 656d 7320 2323 2323 0d0a   problems ####..
+0006bd30: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
+0006bd40: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
+0006bd50: 6265 6c27 3a0d 0a20 2020 2020 2020 2063  bel':..        c
+0006bd60: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
+0006bd70: 7773 203d 2067 6574 5f63 6c61 7373 5f64  ws = get_class_d
+0006bd80: 6973 7472 6962 7574 696f 6e28 595f 636c  istribution(Y_cl
+0006bd90: 6173 7365 7329 0d0a 2020 2020 2020 2020  asses)..        
+0006bda0: 6966 206c 656e 2869 6d70 5f63 6174 7329  if len(imp_cats)
+0006bdb0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
+0006bdc0: 2020 2023 2059 6f75 7220 6661 766f 7572     # Your favour
+0006bdd0: 6974 6520 6f76 6572 7361 6d70 6c65 7220  ite oversampler 
+0006bde0: 3d20 534d 4f54 454e 4320 6973 2062 6574  = SMOTENC is bet
+0006bdf0: 7465 7220 7468 616e 2053 4d4f 5445 2069  ter than SMOTE i
+0006be00: 6e20 6d6f 7374 2063 6173 6573 210d 0a20  n most cases!.. 
+0006be10: 2020 2020 2020 2020 2020 2073 6d6f 7465             smote
+0006be20: 203d 2053 4d4f 5445 4e43 2863 6174 6567   = SMOTENC(categ
+0006be30: 6f72 6963 616c 5f66 6561 7475 7265 733d  orical_features=
+0006be40: 6361 745f 7661 7273 5f69 6e64 6578 2c0d  cat_vars_index,.
+0006be50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006be60: 2020 2020 2020 2020 2073 616d 706c 696e           samplin
+0006be70: 675f 7374 7261 7465 6779 3d63 6c61 7373  g_strategy=class
+0006be80: 5f77 6569 6768 7465 645f 726f 7773 2c0d  _weighted_rows,.
+0006be90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006bea0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+0006beb0: 7374 6174 653d 3432 2c20 6b5f 6e65 6967  state=42, k_neig
+0006bec0: 6862 6f72 733d 736d 616c 6c65 7374 5f6b  hbors=smallest_k
+0006bed0: 6e2c 206e 5f6a 6f62 733d 2d31 290d 0a20  n, n_jobs=-1).. 
+0006bee0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006bef0: 2020 2020 2020 2020 2020 2320 596f 7572            # Your
+0006bf00: 2066 6176 6f75 7269 7465 206f 7665 7273   favourite overs
+0006bf10: 616d 706c 6572 203d 2053 4d4f 5445 2069  ampler = SMOTE i
+0006bf20: 7320 6265 7474 6572 2074 6861 6e20 534d  s better than SM
+0006bf30: 4f54 4545 4e4e 2069 6e20 6d6f 7374 2063  OTEENN in most c
+0006bf40: 6173 6573 210d 0a20 2020 2020 2020 2020  ases!..         
+0006bf50: 2020 2073 6d6f 7465 203d 2053 4d4f 5445     smote = SMOTE
+0006bf60: 2872 616e 646f 6d5f 7374 6174 653d 3237  (random_state=27
+0006bf70: 2c20 7361 6d70 6c69 6e67 5f73 7472 6174  , sampling_strat
+0006bf80: 6567 793d 636c 6173 735f 7765 6967 6874  egy=class_weight
+0006bf90: 6564 5f72 6f77 732c 206e 5f6a 6f62 733d  ed_rows, n_jobs=
+0006bfa0: 2d31 290d 0a20 2020 2023 2323 2323 2323  -1)..    #######
+0006bfb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006bfc0: 2320 2020 2052 6567 7265 7373 696f 6e20  #    Regression 
+0006bfd0: 5265 7361 6d70 6c65 7220 2020 2023 2323  Resampler    ###
+0006bfe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006bff0: 2323 2323 2323 0d0a 2020 2020 7472 793a  ######..    try:
+0006c000: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+0006c010: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
+0006c020: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
+0006c030: 2020 2020 2023 2323 2320 5573 696e 6720       #### Using 
+0006c040: 7265 6720 7265 7361 6d70 6c65 7220 7769  reg resampler wi
+0006c050: 6c6c 206e 6565 6420 7461 7267 6574 2063  ll need target c
+0006c060: 6f6c 756d 6e20 696e 2064 665f 7472 6169  olumn in df_trai
+0006c070: 6e20 7472 6169 6e20 2d20 646f 6e27 7420  n train - don't 
+0006c080: 666f 7267 6574 210d 0a20 2020 2020 2020  forget!..       
+0006c090: 2020 2020 2058 5f64 665f 7265 732c 2079       X_df_res, y
+0006c0a0: 5f64 665f 7265 7320 3d20 6b6d 6561 6e73  _df_res = kmeans
+0006c0b0: 5f72 6573 616d 706c 6572 2858 5f64 662c  _resampler(X_df,
+0006c0c0: 2079 5f64 662c 2074 6172 6765 742c 2073   y_df, target, s
+0006c0d0: 6d6f 7465 2c20 7665 7262 6f73 6529 0d0a  mote, verbose)..
+0006c0e0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0006c0f0: 7468 6520 785f 6466 5f72 6573 206f 7574  the x_df_res out
+0006c100: 7075 7420 6f66 2072 6573 616d 706c 6572  put of resampler
+0006c110: 2077 696c 6c20 6e6f 7420 6861 7665 2074   will not have t
+0006c120: 6865 2074 6172 6765 7420 7369 6e63 6520  he target since 
+0006c130: 6974 2077 696c 6c20 6861 7665 2062 6565  it will have bee
+0006c140: 6e20 7265 6d6f 7665 6421 0d0a 2020 2020  n removed!..    
+0006c150: 2020 2020 2020 2020 2323 2320 795f 6466          ### y_df
+0006c160: 5f72 6573 2077 696c 6c20 6861 7665 2074  _res will have t
+0006c170: 6865 2074 6172 6765 7420 636f 6c75 6d6e  he target column
+0006c180: 2077 6974 6820 6e6f 7720 6578 7472 6120   with now extra 
+0006c190: 726f 7773 2066 6f72 2072 6567 7265 7373  rows for regress
+0006c1a0: 696f 6e20 7472 6169 6e69 6e67 210d 0a20  ion training!.. 
+0006c1b0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006c1c0: 2020 2020 2020 2020 2020 2323 2323 2046            #### F
+0006c1d0: 6f72 2063 6c61 7373 6966 6963 6174 696f  or classificatio
+0006c1e0: 6e20 7072 6f62 6c65 6d73 2073 696d 706c  n problems simpl
+0006c1f0: 7920 7573 696e 6720 7468 6520 6f72 6967  y using the orig
+0006c200: 696e 616c 2064 6174 6120 7769 6c6c 2064  inal data will d
+0006c210: 6f0d 0a20 2020 2020 2020 2020 2020 2023  o..            #
+0006c220: 585f 6466 5f72 6573 2c20 795f 6466 5f72  X_df_res, y_df_r
+0006c230: 6573 203d 2073 6d6f 7465 2e66 6974 5f72  es = smote.fit_r
+0006c240: 6573 616d 706c 6528 585f 6466 2c20 795f  esample(X_df, y_
+0006c250: 6466 290d 0a20 2020 2020 2020 2020 2020  df)..           
+0006c260: 2023 2323 2046 6f72 2063 6c61 7373 6966   ### For classif
+0006c270: 6963 6174 696f 6e20 7072 6f62 6c65 6d73  ication problems
+0006c280: 2077 6520 6172 6520 676f 696e 6720 746f   we are going to
+0006c290: 2075 7365 2053 5045 2066 726f 6d20 6e6f   use SPE from no
+0006c2a0: 7720 6f6e 0d0a 2020 2020 2020 2020 2020  w on..          
+0006c2b0: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+0006c2c0: 3d20 2742 696e 6172 795f 436c 6173 7369  = 'Binary_Classi
+0006c2d0: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
+0006c2e0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0006c2f0: 466f 7220 4269 6e61 7279 2063 6c61 7373  For Binary class
+0006c300: 2c20 5350 4520 6d6f 6465 6c20 6973 2062  , SPE model is b
+0006c310: 6574 7465 7220 2323 2323 2323 2323 2323  etter ##########
+0006c320: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0006c330: 2020 2020 7370 6520 3d20 5365 6c66 5061      spe = SelfPa
+0006c340: 6365 6445 6e73 656d 626c 6543 6c61 7373  cedEnsembleClass
+0006c350: 6966 6965 7228 6573 7469 6d61 746f 723d  ifier(estimator=
+0006c360: 6d6f 6465 6c5f 636f 7079 2c20 6e5f 6a6f  model_copy, n_jo
+0006c370: 6273 3d2d 312c 2073 6f66 745f 7265 7361  bs=-1, soft_resa
+0006c380: 6d70 6c65 5f66 6c61 673d 4661 6c73 6529  mple_flag=False)
+0006c390: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0006c3a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0006c3b0: 2020 2020 2023 2320 466f 7220 6d75 6c74       ## For mult
+0006c3c0: 692d 636c 6173 7320 4f6e 6576 7352 6573  i-class OnevsRes
+0006c3d0: 7420 6d6f 6465 6c20 6973 2062 6574 7465  t model is bette
+0006c3e0: 7220 2023 2323 2323 2323 2323 2323 0d0a  r  ###########..
+0006c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c400: 7370 6520 3d20 5365 6c66 5061 6365 6445  spe = SelfPacedE
+0006c410: 6e73 656d 626c 6543 6c61 7373 6966 6965  nsembleClassifie
+0006c420: 7228 6573 7469 6d61 746f 723d 6d6f 6465  r(estimator=mode
+0006c430: 6c5f 636f 7079 2c20 6e5f 6a6f 6273 3d2d  l_copy, n_jobs=-
+0006c440: 312c 2073 6f66 745f 7265 7361 6d70 6c65  1, soft_resample
+0006c450: 5f66 6c61 673d 4661 6c73 6529 0d0a 2020  _flag=False)..  
+0006c460: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+0006c470: 6520 3d20 4f6e 6556 7352 6573 7443 6c61  e = OneVsRestCla
+0006c480: 7373 6966 6965 7228 6573 7469 6d61 746f  ssifier(estimato
+0006c490: 723d 7370 6529 0d0a 2020 2020 2020 2020  r=spe)..        
+0006c4a0: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
+0006c4b0: 696e 6720 496d 6261 6c61 6e63 6564 206d  ing Imbalanced m
+0006c4c0: 6f64 656c 2e20 5468 6973 2077 696c 6c20  odel. This will 
+0006c4d0: 7461 6b65 2074 696d 652e 2e2e 2729 0d0a  take time...')..
+0006c4e0: 2020 2020 2020 2020 2020 2020 7370 652e              spe.
+0006c4f0: 6669 7428 585f 6466 2c20 795f 6466 290d  fit(X_df, y_df).
+0006c500: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0006c510: 7572 6e20 7370 650d 0a20 2020 2065 7863  urn spe..    exc
+0006c520: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
+0006c530: 696e 7428 2753 4d4f 5445 206f 7220 5265  int('SMOTE or Re
+0006c540: 6772 6573 7369 6f6e 2d72 6573 616d 706c  gression-resampl
+0006c550: 6572 2069 7320 6572 726f 7269 6e67 2e20  er is erroring. 
+0006c560: 436f 6e74 696e 7569 6e67 2e2e 2e27 290d  Continuing...').
+0006c570: 0a20 2020 2020 2020 206d 6f64 656c 203d  .        model =
+0006c580: 206d 6f64 656c 5f74 7261 696e 696e 675f   model_training_
+0006c590: 736d 6f74 6528 6d6f 6465 6c2c 2058 5f64  smote(model, X_d
+0006c5a0: 662c 2079 5f64 662c 2065 7661 6c5f 7365  f, y_df, eval_se
+0006c5b0: 742c 2065 7661 6c5f 6d65 7472 6963 2c0d  t, eval_metric,.
+0006c5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006c5d0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0006c5e0: 7261 6d73 2c20 696d 705f 6361 7473 2c20  rams, imp_cats, 
+0006c5f0: 6d6f 6465 6c74 7970 652c 0d0a 2020 2020  modeltype,..    
+0006c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c610: 2020 2020 2020 2020 6361 6c69 6272 6174          calibrat
+0006c620: 6f72 5f66 6c61 672c 206d 6f64 656c 5f6e  or_flag, model_n
+0006c630: 616d 652c 2042 6f6f 7374 696e 675f 466c  ame, Boosting_Fl
+0006c640: 6167 2c20 6d6f 6465 6c5f 6c61 6265 6c2c  ag, model_label,
+0006c650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006c660: 2020 2020 2020 2020 2020 2020 2020 2047                 G
+0006c670: 5055 5f65 7869 7374 7329 0d0a 2020 2020  PU_exists)..    
+0006c680: 2020 2020 7072 696e 7428 2720 2020 204d      print('    M
+0006c690: 6f64 656c 2054 7261 696e 696e 6720 7469  odel Training ti
+0006c6a0: 6d65 2074 616b 656e 203d 2025 302e 3066  me taken = %0.0f
+0006c6b0: 2073 6563 6f6e 6473 2720 2528 7469 6d65   seconds' %(time
+0006c6c0: 2e74 696d 6528 292d 7374 6172 745f 7469  .time()-start_ti
+0006c6d0: 6d65 2929 0d0a 2020 2020 2020 2020 7265  me))..        re
+0006c6e0: 7475 726e 2073 7065 0d0a 2020 2020 7072  turn spe..    pr
+0006c6f0: 696e 7428 2754 7261 696e 696e 6720 6d6f  int('Training mo
+0006c700: 6465 6c20 6e6f 7720 6f6e 2072 6573 616d  del now on resam
+0006c710: 706c 6564 2074 7261 696e 2064 6174 613a  pled train data:
+0006c720: 2025 732e 2054 6869 7320 7769 6c6c 2074   %s. This will t
+0006c730: 616b 6520 7469 6d65 2e2e 2e27 2025 2858  ake time...' %(X
+0006c740: 5f64 665f 7265 732e 7368 6170 652c 2929  _df_res.shape,))
+0006c750: 0d0a 2020 2020 2320 4669 7420 7468 6520  ..    # Fit the 
+0006c760: 6d6f 6465 6c20 7573 696e 6720 785f 7472  model using x_tr
+0006c770: 6169 6e20 616e 6420 795f 7472 6169 6e20  ain and y_train 
+0006c780: 6675 6c6c 2064 6174 6120 7365 6e74 2069  full data sent i
+0006c790: 6e0d 0a20 2020 206d 6f64 656c 203d 206d  n..    model = m
+0006c7a0: 6f64 656c 5f74 7261 696e 696e 675f 736d  odel_training_sm
+0006c7b0: 6f74 6528 6d6f 6465 6c2c 2058 5f64 665f  ote(model, X_df_
+0006c7c0: 7265 732c 2079 5f64 665f 7265 732c 2065  res, y_df_res, e
+0006c7d0: 7661 6c5f 7365 742c 2065 7661 6c5f 6d65  val_set, eval_me
+0006c7e0: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
+0006c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c800: 7061 7261 6d73 2c20 696d 705f 6361 7473  params, imp_cats
+0006c810: 2c20 6d6f 6465 6c74 7970 652c 0d0a 2020  , modeltype,..  
+0006c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c830: 2020 2020 2020 6361 6c69 6272 6174 6f72        calibrator
+0006c840: 5f66 6c61 672c 206d 6f64 656c 5f6e 616d  _flag, model_nam
+0006c850: 652c 2042 6f6f 7374 696e 675f 466c 6167  e, Boosting_Flag
+0006c860: 2c20 6d6f 6465 6c5f 6c61 6265 6c2c 0d0a  , model_label,..
+0006c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c880: 2020 2020 2020 2020 2047 5055 5f65 7869           GPU_exi
+0006c890: 7374 7329 0d0a 2020 2020 7072 696e 7428  sts)..    print(
+0006c8a0: 2720 2020 2052 6573 616d 706c 6564 2064  '    Resampled d
+0006c8b0: 6174 6120 5472 6169 6e69 6e67 2074 696d  ata Training tim
+0006c8c0: 6520 7461 6b65 6e20 3d20 2530 2e30 6620  e taken = %0.0f 
+0006c8d0: 7365 636f 6e64 7327 2025 2874 696d 652e  seconds' %(time.
+0006c8e0: 7469 6d65 2829 2d73 7461 7274 5f74 696d  time()-start_tim
+0006c8f0: 6529 290d 0a20 2020 2023 4e6f 7720 6d61  e))..    #Now ma
+0006c900: 6b65 2070 7265 6469 6374 696f 6e73 206f  ke predictions o
+0006c910: 6e20 6865 6c64 206f 7574 2064 6174 610d  n held out data.
+0006c920: 0a20 2020 206d 6f64 656c 5f73 7472 203d  .    model_str =
+0006c930: 2073 7472 286d 6f64 656c 292e 7370 6c69   str(model).spli
+0006c940: 7428 2228 2229 5b30 5d0d 0a20 2020 2069  t("(")[0]..    i
+0006c950: 6620 7472 6169 6e69 6e67 3a0d 0a20 2020  f training:..   
+0006c960: 2020 2020 2078 5f74 6573 7420 3d20 6576       x_test = ev
+0006c970: 616c 5f73 6574 5b30 5d5b 305d 0d0a 2020  al_set[0][0]..  
+0006c980: 2020 2020 2020 795f 7465 7374 203d 2065        y_test = e
+0006c990: 7661 6c5f 7365 745b 305d 5b31 5d0d 0a20  val_set[0][1].. 
+0006c9a0: 2020 2020 2020 2023 2043 6865 636b 2074         # Check t
+0006c9b0: 6865 2073 636f 7265 0d0a 2020 2020 2020  he score..      
+0006c9c0: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+0006c9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006c9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006c9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ca00: 2327 290d 0a20 2020 2020 2020 2070 7269  #')..        pri
+0006ca10: 6e74 2827 5265 7361 6d70 6c65 6420 6d6f  nt('Resampled mo
+0006ca20: 6465 6c20 7265 7375 6c74 7320 6f6e 2048  del results on H
+0006ca30: 656c 6420 6f75 7420 5661 6c69 6461 7469  eld out Validati
+0006ca40: 6f6e 2064 6174 613a 2729 0d0a 2020 2020  on data:')..    
+0006ca50: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+0006ca60: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+0006ca70: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0006ca80: 7269 6e74 5f72 6567 7265 7373 696f 6e5f  rint_regression_
+0006ca90: 6d65 7472 6963 7328 795f 7465 7374 2c20  metrics(y_test, 
+0006caa0: 6d6f 6465 6c2e 7072 6564 6963 7428 785f  model.predict(x_
+0006cab0: 7465 7374 2929 0d0a 2020 2020 2020 2020  test))..        
+0006cac0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0006cad0: 2020 2070 7269 6e74 2863 6c61 7373 6966     print(classif
+0006cae0: 6963 6174 696f 6e5f 7265 706f 7274 2879  ication_report(y
+0006caf0: 5f74 6573 742c 206d 6f64 656c 2e70 7265  _test, model.pre
+0006cb00: 6469 6374 2878 5f74 6573 7429 2929 0d0a  dict(x_test)))..
+0006cb10: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
+0006cb20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006cb30: 2320 2043 6f6d 706c 6574 6564 2049 6d62  #  Completed Imb
+0006cb40: 616c 616e 6365 6420 5472 6169 6e69 6e67  alanced Training
+0006cb50: 2075 7369 6e67 2025 7320 2323 2323 2323   using %s ######
+0006cb60: 2323 2323 2323 2323 2323 2720 256d 6f64  ##########' %mod
+0006cb70: 656c 5f73 7472 290d 0a20 2020 2065 6c73  el_str)..    els
+0006cb80: 653a 0d0a 2020 2020 2020 2020 6966 2076  e:..        if v
+0006cb90: 6572 626f 7365 203e 3d20 313a 0d0a 2020  erbose >= 1:..  
+0006cba0: 2020 2020 2020 2020 2020 6669 672c 2028            fig, (
+0006cbb0: 6178 312c 2061 7832 2920 3d20 706c 742e  ax1, ax2) = plt.
+0006cbc0: 7375 6270 6c6f 7473 2831 2c20 322c 2073  subplots(1, 2, s
+0006cbd0: 6861 7265 793d 5472 7565 2c66 6967 7369  harey=True,figsi
+0006cbe0: 7a65 3d28 3132 2c35 2929 0d0a 2020 2020  ze=(12,5))..    
+0006cbf0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+0006cc00: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
+0006cc10: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+0006cc20: 2020 2020 2020 2079 5f64 662e 706c 6f74         y_df.plot
+0006cc30: 286b 696e 643d 2768 6973 7427 2c74 6974  (kind='hist',tit
+0006cc40: 6c65 3d27 4469 7374 2e20 6f66 2074 6172  le='Dist. of tar
+0006cc50: 6765 7420 6265 666f 7265 2052 6567 7265  get before Regre
+0006cc60: 7373 696f 6e20 5265 7361 6d70 6c65 7227  ssion Resampler'
+0006cc70: 2c20 6178 3d61 7831 2c20 636f 6c6f 723d  , ax=ax1, color=
+0006cc80: 2772 2729 0d0a 2020 2020 2020 2020 2020  'r')..          
+0006cc90: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
+0006cca0: 6d65 2879 5f64 665f 7265 7329 2e70 6c6f  me(y_df_res).plo
+0006ccb0: 7428 6b69 6e64 3d27 6869 7374 272c 7469  t(kind='hist',ti
+0006ccc0: 746c 653d 2744 6973 742e 206f 6620 7461  tle='Dist. of ta
+0006ccd0: 7267 6574 2061 6674 6572 2052 6567 7265  rget after Regre
+0006cce0: 7373 696f 6e20 5265 7361 6d70 6c65 7227  ssion Resampler'
+0006ccf0: 2c20 6178 3d61 7832 2c20 636f 6c6f 723d  , ax=ax2, color=
+0006cd00: 2762 2729 0d0a 2020 2020 2020 2020 2020  'b')..          
+0006cd10: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006cd20: 2020 2020 2020 2020 2079 5f64 662e 7661           y_df.va
+0006cd30: 6c75 655f 636f 756e 7473 2831 292e 706c  lue_counts(1).pl
+0006cd40: 6f74 286b 696e 643d 2762 6172 272c 7469  ot(kind='bar',ti
+0006cd50: 746c 653d 2744 6973 7472 6962 7574 696f  tle='Distributio
+0006cd60: 6e20 6f66 2063 6c61 7373 6573 2062 6566  n of classes bef
+0006cd70: 6f72 6520 534d 4f54 4527 2c20 6178 3d61  ore SMOTE', ax=a
+0006cd80: 7831 2c20 636f 6c6f 723d 2772 2729 0d0a  x1, color='r')..
+0006cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cda0: 795f 6466 5f72 6573 2e76 616c 7565 5f63  y_df_res.value_c
+0006cdb0: 6f75 6e74 7328 3129 2e70 6c6f 7428 6b69  ounts(1).plot(ki
+0006cdc0: 6e64 3d27 6261 7227 2c74 6974 6c65 3d27  nd='bar',title='
+0006cdd0: 4469 7374 7269 6275 7469 6f6e 206f 6620  Distribution of 
+0006cde0: 636c 6173 7365 7320 6166 7465 7220 534d  classes after SM
+0006cdf0: 4f54 4527 2c20 6178 3d61 7832 2c20 636f  OTE', ax=ax2, co
+0006ce00: 6c6f 723d 2762 2729 0d0a 2020 2020 7265  lor='b')..    re
+0006ce10: 7475 726e 206d 6f64 656c 0d0a 2323 2323  turn model..####
+0006ce20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ce30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ce40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ce50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ce60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ce70: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
+0006ce80: 6d6f 6465 6c5f 7472 6169 6e69 6e67 5f73  model_training_s
+0006ce90: 6d6f 7465 286d 6f64 656c 2c20 785f 7472  mote(model, x_tr
+0006cea0: 6169 6e2c 2079 5f74 7261 696e 2c20 6576  ain, y_train, ev
+0006ceb0: 616c 5f73 6574 2c20 6576 616c 5f6d 6574  al_set, eval_met
+0006cec0: 7269 632c 0d0a 2020 2020 2020 2020 2020  ric,..          
+0006ced0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0006cee0: 6172 616d 732c 2069 6d70 5f63 6174 732c  arams, imp_cats,
+0006cef0: 206d 6f64 656c 7479 7065 2c0d 0a20 2020   modeltype,..   
 0006cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cf10: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-0006cf20: 5f6d 6574 7269 633d 6576 616c 5f6d 6574  _metric=eval_met
-0006cf30: 7269 632c 6576 616c 5f73 6574 3d65 7661  ric,eval_set=eva
-0006cf40: 6c5f 7365 742c 7665 7262 6f73 653d 4661  l_set,verbose=Fa
-0006cf50: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
-0006cf60: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
-0006cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cf80: 2020 2023 2323 2320 4f6e 2043 6f6c 6162     #### On Colab
-0006cf90: 2c20 6576 656e 2074 686f 7567 6820 4750  , even though GP
-0006cfa0: 5520 6578 6973 7473 2c20 6d61 6e79 2070  U exists, many p
-0006cfb0: 656f 706c 6520 646f 6e27 7420 7475 726e  eople don't turn
-0006cfc0: 2069 7420 6f6e 2e0d 0a20 2020 2020 2020   it on...       
-0006cfd0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0006cfe0: 2320 2049 6e20 7468 6174 2063 6173 652c  #  In that case,
-0006cff0: 2058 4742 6f6f 7374 2062 6c6f 7773 2075   XGBoost blows u
-0006d000: 7020 7768 656e 2067 7075 5f70 7265 6469  p when gpu_predi
-0006d010: 6374 6f72 2069 7320 7573 6564 2e0d 0a20  ctor is used... 
-0006d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d030: 2020 2023 2323 2320 2054 6869 7320 6973     ####  This is
-0006d040: 2074 6f20 7475 726e 2069 7420 6261 636b   to turn it back
-0006d050: 2074 6f20 6370 755f 7072 6564 6963 746f   to cpu_predicto
-0006d060: 7220 696e 2063 6173 6520 4750 5520 6572  r in case GPU er
-0006d070: 726f 7273 210d 0a20 2020 2020 2020 2020  rors!..         
-0006d080: 2020 2020 2020 2020 2020 2069 6620 4750             if GP
-0006d090: 555f 6578 6973 7473 3a0d 0a20 2020 2020  U_exists:..     
-0006d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d0b0: 2020 2070 7269 6e74 2827 5761 726e 696e     print('Warnin
-0006d0c0: 673a 2047 5055 2065 7869 7374 7320 6275  g: GPU exists bu
-0006d0d0: 7420 6974 2069 7320 6e6f 7420 7475 726e  t it is not turn
-0006d0e0: 6564 206f 6e2e 2055 7369 6e67 2043 5055  ed on. Using CPU
-0006d0f0: 2066 6f72 2070 7265 6469 6374 696f 6e73   for predictions
-0006d100: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
-0006d110: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0006d120: 6620 6361 6c69 6272 6174 6f72 5f66 6c61  f calibrator_fla
-0006d130: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-0006d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d150: 6d6f 6465 6c2e 6261 7365 5f65 7374 696d  model.base_estim
-0006d160: 6174 6f72 2e73 6574 5f70 6172 616d 7328  ator.set_params(
-0006d170: 2a2a 7061 7261 6d73 290d 0a20 2020 2020  **params)..     
-0006d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d190: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-0006d1a0: 2878 5f74 7261 696e 2c20 795f 7472 6169  (x_train, y_trai
-0006d1b0: 6e29 0d0a 2020 2020 2020 2020 2020 2020  n)..            
-0006d1c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0006d1d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0006d1e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0006d1f0: 6f64 656c 2e65 7374 696d 6174 6f72 2e73  odel.estimator.s
-0006d200: 6574 5f70 6172 616d 7328 2a2a 7061 7261  et_params(**para
-0006d210: 6d73 290d 0a20 2020 2020 2020 2020 2020  ms)..           
-0006d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d230: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
-0006d240: 696e 2c20 795f 7472 6169 6e29 0d0a 2020  in, y_train)..  
-0006d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d260: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0006d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d280: 2069 6620 6576 616c 5f73 6574 3d3d 5b28   if eval_set==[(
-0006d290: 295d 206f 7220 6d6f 6465 6c74 7970 6520  )] or modeltype 
-0006d2a0: 3d3d 2027 4d75 6c74 695f 436c 6173 7369  == 'Multi_Classi
-0006d2b0: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
-0006d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d2d0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
-0006d2e0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
-0006d2f0: 696e 290d 0a20 2020 2020 2020 2020 2020  in)..           
-0006d300: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0006d310: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0006d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d330: 6d6f 6465 6c2e 6669 7428 785f 7472 6169  model.fit(x_trai
-0006d340: 6e2c 2079 5f74 7261 696e 2c20 6561 726c  n, y_train, earl
-0006d350: 795f 7374 6f70 7069 6e67 5f72 6f75 6e64  y_stopping_round
-0006d360: 733d 6561 726c 795f 7374 6f70 7069 6e67  s=early_stopping
-0006d370: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0006d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d390: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
-0006d3a0: 7661 6c5f 6d65 7472 6963 2c65 7661 6c5f  val_metric,eval_
-0006d3b0: 7365 743d 6576 616c 5f73 6574 2c76 6572  set=eval_set,ver
-0006d3c0: 626f 7365 3d46 616c 7365 290d 0a20 2020  bose=False)..   
-0006d3d0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0006d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d3f0: 6561 726c 795f 7374 6f70 7069 6e67 203d  early_stopping =
-0006d400: 2032 300d 0a20 2020 2020 2020 2020 2020   20..           
-0006d410: 2020 2020 2069 6620 6576 616c 5f73 6574       if eval_set
-0006d420: 203d 3d20 5b28 295d 3a0d 0a20 2020 2020   == [()]:..     
-0006d430: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0006d440: 6f64 656c 2e66 6974 2878 5f74 7261 696e  odel.fit(x_train
-0006d450: 2c20 795f 7472 6169 6e2c 2063 6174 5f66  , y_train, cat_f
-0006d460: 6561 7475 7265 733d 696d 705f 6361 7473  eatures=imp_cats
-0006d470: 2c70 6c6f 743d 4661 6c73 652c 2076 6572  ,plot=False, ver
-0006d480: 626f 7365 3d31 290d 0a20 2020 2020 2020  bose=1)..       
-0006d490: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0006d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d4b0: 2020 2020 6d6f 6465 6c2e 6669 7428 785f      model.fit(x_
-0006d4c0: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
-0006d4d0: 6361 745f 6665 6174 7572 6573 3d69 6d70  cat_features=imp
-0006d4e0: 5f63 6174 732c 2076 6572 626f 7365 3d31  _cats, verbose=1
-0006d4f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0006d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006d510: 2020 2065 7661 6c5f 7365 743d 6576 616c     eval_set=eval
-0006d520: 5f73 6574 2c20 7573 655f 6265 7374 5f6d  _set, use_best_m
-0006d530: 6f64 656c 3d54 7275 652c 2070 6c6f 743d  odel=True, plot=
-0006d540: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-0006d550: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0006d560: 2020 206d 6f64 656c 2e66 6974 2878 5f74     model.fit(x_t
-0006d570: 7261 696e 2c20 795f 7472 6169 6e29 0d0a  rain, y_train)..
-0006d580: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006d590: 2020 206d 6f64 656c 2e66 6974 2878 5f74     model.fit(x_t
-0006d5a0: 7261 696e 2c20 795f 7472 6169 6e29 0d0a  rain, y_train)..
-0006d5b0: 2020 2020 7265 7475 726e 206d 6f64 656c      return model
-0006d5c0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0006d5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d610: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
-0006d620: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
-0006d630: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
-0006d640: 6573 745f 7370 6c69 740d 0a69 6d70 6f72  est_split..impor
-0006d650: 7420 6e75 6d70 7920 6173 206e 700d 0a66  t numpy as np..f
-0006d660: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-0006d670: 6963 7320 696d 706f 7274 2066 315f 7363  ics import f1_sc
-0006d680: 6f72 650d 0a69 6d70 6f72 7420 636f 7079  ore..import copy
-0006d690: 0d0a 696d 706f 7274 206d 6174 706c 6f74  ..import matplot
-0006d6a0: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-0006d6b0: 740d 0a66 726f 6d20 696e 7370 6563 7420  t..from inspect 
-0006d6c0: 696d 706f 7274 2073 6967 6e61 7475 7265  import signature
-0006d6d0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e70  ..from sklearn.p
-0006d6e0: 7265 7072 6f63 6573 7369 6e67 2069 6d70  reprocessing imp
-0006d6f0: 6f72 7420 6c61 6265 6c5f 6269 6e61 7269  ort label_binari
-0006d700: 7a65 0d0a 6672 6f6d 2073 6b6c 6561 726e  ze..from sklearn
-0006d710: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-0006d720: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
-0006d730: 5f63 7572 7665 0d0a 6672 6f6d 2073 6b6c  _curve..from skl
-0006d740: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-0006d750: 6f72 7420 6176 6572 6167 655f 7072 6563  ort average_prec
-0006d760: 6973 696f 6e5f 7363 6f72 650d 0a66 726f  ision_score..fro
-0006d770: 6d20 6974 6572 746f 6f6c 7320 696d 706f  m itertools impo
-0006d780: 7274 2063 7963 6c65 0d0a 2323 2323 2323  rt cycle..######
-0006d790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d7d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d7e0: 2323 2323 2323 230d 0a64 6566 206d 756c  #######..def mul
-0006d7f0: 7469 5f66 3128 7472 7574 682c 2070 7265  ti_f1(truth, pre
-0006d800: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-0006d810: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
-0006d820: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-0006d830: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
-0006d840: 0d0a 6465 6620 6d75 6c74 695f 7072 6563  ..def multi_prec
-0006d850: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
-0006d860: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-0006d870: 7265 7475 726e 2070 7265 6369 7369 6f6e  return precision
-0006d880: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-0006d890: 6564 6963 7469 6f6e 732c 6176 6572 6167  edictions,averag
-0006d8a0: 653d 4e6f 6e65 290d 0a23 2323 2323 2323  e=None)..#######
-0006d8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d900: 2323 2323 2323 230d 0a64 6566 2044 7261  #######..def Dra
-0006d910: 775f 4d43 5f4d 4c5f 5052 5f52 4f43 5f43  w_MC_ML_PR_ROC_C
-0006d920: 7572 7665 7328 636c 6173 7369 6669 6572  urves(classifier
-0006d930: 2c58 5f74 6573 742c 795f 7465 7374 293a  ,X_test,y_test):
-0006d940: 0d0a 2020 2020 2222 220d 0a20 2020 203d  ..    """..    =
-0006d950: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d960: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d970: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d980: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d990: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d9a0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2050 7265  =======..    Pre
-0006d9b0: 6369 7369 6f6e 2d52 6563 616c 6c20 4375  cision-Recall Cu
-0006d9c0: 7276 6573 3a20 4578 7465 6e73 696f 6e20  rves: Extension 
-0006d9d0: 6f66 204f 7269 6769 6e61 6c20 5665 7273  of Original Vers
-0006d9e0: 696f 6e20 696e 2053 4b4c 6561 726e 2773  ion in SKLearn's
-0006d9f0: 2044 6f63 756d 656e 7461 7469 6f6e 2050   Documentation P
-0006da00: 6167 653a 0d0a 2020 2020 6874 7470 733a  age:..    https:
-0006da10: 2f2f 7363 696b 6974 2d6c 6561 726e 2e6f  //scikit-learn.o
-0006da20: 7267 2f73 7461 626c 652f 6175 746f 5f65  rg/stable/auto_e
-0006da30: 7861 6d70 6c65 732f 6d6f 6465 6c5f 7365  xamples/model_se
-0006da40: 6c65 6374 696f 6e2f 706c 6f74 5f70 7265  lection/plot_pre
-0006da50: 6369 7369 6f6e 5f72 6563 616c 6c2e 6874  cision_recall.ht
-0006da60: 6d6c 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  ml..    ========
-0006da70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006da80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006da90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006daa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006dab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006dac0: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
-0006dad0: 6967 7369 7a65 203d 2028 3130 2c20 3629  igsize = (10, 6)
-0006dae0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
+0006cf10: 2020 2020 2063 616c 6962 7261 746f 725f       calibrator_
+0006cf20: 666c 6167 2c20 6d6f 6465 6c5f 6e61 6d65  flag, model_name
+0006cf30: 2c20 426f 6f73 7469 6e67 5f46 6c61 672c  , Boosting_Flag,
+0006cf40: 206d 6f64 656c 5f6c 6162 656c 2c0d 0a20   model_label,.. 
+0006cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cf60: 2020 2020 2020 2020 4750 555f 6578 6973          GPU_exis
+0006cf70: 7473 293a 0d0a 2020 2020 2323 2323 2054  ts):..    #### T
+0006cf80: 6869 7320 6d6f 6465 6c20 7472 6169 6e69  his model traini
+0006cf90: 6e67 2076 6961 2053 4d4f 5445 2068 6173  ng via SMOTE has
+0006cfa0: 2074 6f20 6265 206d 6f64 6966 6965 6420   to be modified 
+0006cfb0: 6c61 7465 7220 2323 2323 2323 2323 2323  later ##########
+0006cfc0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006cfd0: 6561 726c 795f 7374 6f70 7069 6e67 203d  early_stopping =
+0006cfe0: 2035 0d0a 2020 2020 6966 206d 6f64 656c   5..    if model
+0006cff0: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
+0006d000: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
+0006d010: 2020 2069 6620 426f 6f73 7469 6e67 5f46     if Boosting_F
+0006d020: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
+0006d030: 2020 6966 206d 6f64 656c 5f6e 616d 6520    if model_name 
+0006d040: 3d3d 2027 5847 426f 6f73 7427 3a0d 0a20  == 'XGBoost':.. 
+0006d050: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0006d060: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+0006d070: 2020 2020 2020 2020 2069 6620 6361 6c69           if cali
+0006d080: 6272 6174 6f72 5f66 6c61 673a 0d0a 2020  brator_flag:..  
+0006d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d0a0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
+0006d0b0: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
+0006d0c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0006d0d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d0f0: 2020 2020 2020 6966 2065 7661 6c5f 7365        if eval_se
+0006d100: 743d 3d5b 2829 5d20 6f72 206d 6f64 656c  t==[()] or model
+0006d110: 7479 7065 203d 3d20 274d 756c 7469 5f43  type == 'Multi_C
+0006d120: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+0006d130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006d140: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0006d150: 656c 2e66 6974 2878 5f74 7261 696e 2c20  el.fit(x_train, 
+0006d160: 795f 7472 6169 6e29 0d0a 2020 2020 2020  y_train)..      
+0006d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d180: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d1a0: 2020 2020 206d 6f64 656c 2e66 6974 2878       model.fit(x
+0006d1b0: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+0006d1c0: 6561 726c 795f 7374 6f70 7069 6e67 5f72  early_stopping_r
+0006d1d0: 6f75 6e64 733d 6561 726c 795f 7374 6f70  ounds=early_stop
+0006d1e0: 7069 6e67 2c0d 0a20 2020 2020 2020 2020  ping,..         
+0006d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d200: 2020 2020 2020 2065 7661 6c5f 6d65 7472         eval_metr
+0006d210: 6963 3d65 7661 6c5f 6d65 7472 6963 2c65  ic=eval_metric,e
+0006d220: 7661 6c5f 7365 743d 6576 616c 5f73 6574  val_set=eval_set
+0006d230: 2c76 6572 626f 7365 3d46 616c 7365 290d  ,verbose=False).
+0006d240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006d250: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+0006d260: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0006d270: 2323 204f 6e20 436f 6c61 622c 2065 7665  ## On Colab, eve
+0006d280: 6e20 7468 6f75 6768 2047 5055 2065 7869  n though GPU exi
+0006d290: 7374 732c 206d 616e 7920 7065 6f70 6c65  sts, many people
+0006d2a0: 2064 6f6e 2774 2074 7572 6e20 6974 206f   don't turn it o
+0006d2b0: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
+0006d2c0: 2020 2020 2020 2020 2323 2323 2020 496e          ####  In
+0006d2d0: 2074 6861 7420 6361 7365 2c20 5847 426f   that case, XGBo
+0006d2e0: 6f73 7420 626c 6f77 7320 7570 2077 6865  ost blows up whe
+0006d2f0: 6e20 6770 755f 7072 6564 6963 746f 7220  n gpu_predictor 
+0006d300: 6973 2075 7365 642e 0d0a 2020 2020 2020  is used...      
+0006d310: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0006d320: 2323 2020 5468 6973 2069 7320 746f 2074  ##  This is to t
+0006d330: 7572 6e20 6974 2062 6163 6b20 746f 2063  urn it back to c
+0006d340: 7075 5f70 7265 6469 6374 6f72 2069 6e20  pu_predictor in 
+0006d350: 6361 7365 2047 5055 2065 7272 6f72 7321  case GPU errors!
+0006d360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006d370: 2020 2020 2020 6966 2047 5055 5f65 7869        if GPU_exi
+0006d380: 7374 733a 0d0a 2020 2020 2020 2020 2020  sts:..          
+0006d390: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0006d3a0: 696e 7428 2757 6172 6e69 6e67 3a20 4750  int('Warning: GP
+0006d3b0: 5520 6578 6973 7473 2062 7574 2069 7420  U exists but it 
+0006d3c0: 6973 206e 6f74 2074 7572 6e65 6420 6f6e  is not turned on
+0006d3d0: 2e20 5573 696e 6720 4350 5520 666f 7220  . Using CPU for 
+0006d3e0: 7072 6564 6963 7469 6f6e 732e 2e2e 2729  predictions...')
+0006d3f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006d400: 2020 2020 2020 2020 2020 6966 2063 616c            if cal
+0006d410: 6962 7261 746f 725f 666c 6167 3a0d 0a20  ibrator_flag:.. 
+0006d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d430: 2020 2020 2020 2020 2020 2069 6620 4c6f             if Lo
+0006d440: 6f73 6556 6572 7369 6f6e 2873 6b6c 6561  oseVersion(sklea
+0006d450: 726e 2e5f 5f76 6572 7369 6f6e 5f5f 2920  rn.__version__) 
+0006d460: 3c3d 204c 6f6f 7365 5665 7273 696f 6e28  <= LooseVersion(
+0006d470: 2730 2e32 342e 3227 293a 0d0a 2020 2020  '0.24.2'):..    
+0006d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d490: 2020 2020 2020 2020 2020 2020 2320 5065              # Pe
+0006d4a0: 7266 6f72 6d20 6163 7469 6f6e 2066 6f72  rform action for
+0006d4b0: 2073 6369 6b69 742d 6c65 6172 6e20 7665   scikit-learn ve
+0006d4c0: 7273 696f 6e20 6265 6c6f 7720 302e 3234  rsion below 0.24
+0006d4d0: 2e32 0d0a 2020 2020 2020 2020 2020 2020  .2..            
+0006d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d4f0: 2020 2020 2320 4164 6420 796f 7572 2063      # Add your c
+0006d500: 6f64 6520 6865 7265 2066 6f72 2073 6369  ode here for sci
+0006d510: 6b69 742d 6c65 6172 6e20 7665 7273 696f  kit-learn versio
+0006d520: 6e20 6265 6c6f 7720 302e 3234 2e32 0d0a  n below 0.24.2..
+0006d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d550: 6d6f 6465 6c2e 6261 7365 5f65 7374 696d  model.base_estim
+0006d560: 6174 6f72 2e73 6574 5f70 6172 616d 7328  ator.set_params(
+0006d570: 2a2a 7061 7261 6d73 290d 0a20 2020 2020  **params)..     
+0006d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d590: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d5b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0006d5c0: 5065 7266 6f72 6d20 6163 7469 6f6e 2066  Perform action f
+0006d5d0: 6f72 2073 6369 6b69 742d 6c65 6172 6e20  or scikit-learn 
+0006d5e0: 7665 7273 696f 6e20 302e 3234 2e32 2061  version 0.24.2 a
+0006d5f0: 6e64 2061 626f 7665 0d0a 2020 2020 2020  nd above..      
+0006d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d610: 2020 2020 2020 2020 2020 2320 4164 6420            # Add 
+0006d620: 796f 7572 2063 6f64 6520 6865 7265 2066  your code here f
+0006d630: 6f72 2073 6369 6b69 742d 6c65 6172 6e20  or scikit-learn 
+0006d640: 7665 7273 696f 6e20 302e 3234 2e32 2061  version 0.24.2 a
+0006d650: 6e64 2061 626f 7665 0d0a 2020 2020 2020  nd above..      
+0006d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d670: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+0006d680: 6573 7469 6d61 746f 722e 7365 745f 7061  estimator.set_pa
+0006d690: 7261 6d73 282a 2a70 6172 616d 7329 0d0a  rams(**params)..
+0006d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d6b0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0006d6c0: 6c2e 6669 7428 785f 7472 6169 6e2c 2079  l.fit(x_train, y
+0006d6d0: 5f74 7261 696e 290d 0a20 2020 2020 2020  _train)..       
+0006d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d6f0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0006d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d710: 2020 2020 6d6f 6465 6c2e 6573 7469 6d61      model.estima
+0006d720: 746f 722e 7365 745f 7061 7261 6d73 282a  tor.set_params(*
+0006d730: 2a70 6172 616d 7329 0d0a 2020 2020 2020  *params)..      
+0006d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d750: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
+0006d760: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
+0006d770: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0006d780: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d7a0: 2020 2020 2020 6966 2065 7661 6c5f 7365        if eval_se
+0006d7b0: 743d 3d5b 2829 5d20 6f72 206d 6f64 656c  t==[()] or model
+0006d7c0: 7479 7065 203d 3d20 274d 756c 7469 5f43  type == 'Multi_C
+0006d7d0: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+0006d7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006d7f0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0006d800: 656c 2e66 6974 2878 5f74 7261 696e 2c20  el.fit(x_train, 
+0006d810: 795f 7472 6169 6e29 0d0a 2020 2020 2020  y_train)..      
+0006d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d830: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d850: 2020 2020 206d 6f64 656c 2e66 6974 2878       model.fit(x
+0006d860: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+0006d870: 2065 6172 6c79 5f73 746f 7070 696e 675f   early_stopping_
+0006d880: 726f 756e 6473 3d65 6172 6c79 5f73 746f  rounds=early_sto
+0006d890: 7070 696e 672c 0d0a 2020 2020 2020 2020  pping,..        
+0006d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d8b0: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
+0006d8c0: 7269 633d 6576 616c 5f6d 6574 7269 632c  ric=eval_metric,
+0006d8d0: 6576 616c 5f73 6574 3d65 7661 6c5f 7365  eval_set=eval_se
+0006d8e0: 742c 7665 7262 6f73 653d 4661 6c73 6529  t,verbose=False)
+0006d8f0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0006d900: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0006d910: 2020 2020 2065 6172 6c79 5f73 746f 7070       early_stopp
+0006d920: 696e 6720 3d20 3230 0d0a 2020 2020 2020  ing = 20..      
+0006d930: 2020 2020 2020 2020 2020 6966 2065 7661            if eva
+0006d940: 6c5f 7365 7420 3d3d 205b 2829 5d3a 0d0a  l_set == [()]:..
+0006d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006d960: 2020 2020 6d6f 6465 6c2e 6669 7428 785f      model.fit(x_
+0006d970: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
+0006d980: 6361 745f 6665 6174 7572 6573 3d69 6d70  cat_features=imp
+0006d990: 5f63 6174 732c 706c 6f74 3d46 616c 7365  _cats,plot=False
+0006d9a0: 2c20 7665 7262 6f73 653d 3129 0d0a 2020  , verbose=1)..  
+0006d9b0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0006d9c0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0006d9d0: 2020 2020 2020 2020 206d 6f64 656c 2e66           model.f
+0006d9e0: 6974 2878 5f74 7261 696e 2c20 795f 7472  it(x_train, y_tr
+0006d9f0: 6169 6e2c 2063 6174 5f66 6561 7475 7265  ain, cat_feature
+0006da00: 733d 696d 705f 6361 7473 2c20 7665 7262  s=imp_cats, verb
+0006da10: 6f73 653d 312c 0d0a 2020 2020 2020 2020  ose=1,..        
+0006da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006da30: 2020 2020 2020 2020 6576 616c 5f73 6574          eval_set
+0006da40: 3d65 7661 6c5f 7365 742c 2075 7365 5f62  =eval_set, use_b
+0006da50: 6573 745f 6d6f 6465 6c3d 5472 7565 2c20  est_model=True, 
+0006da60: 706c 6f74 3d46 616c 7365 290d 0a20 2020  plot=False)..   
+0006da70: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0006da80: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
+0006da90: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
+0006daa0: 696e 290d 0a20 2020 2065 6c73 653a 0d0a  in)..    else:..
+0006dab0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
+0006dac0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
+0006dad0: 696e 290d 0a20 2020 2072 6574 7572 6e20  in)..    return 
+0006dae0: 6d6f 6465 6c0d 0a23 2323 2323 2323 2323  model..#########
 0006daf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006db00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006db10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006db20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006db30: 2323 2323 230d 0a20 2020 2023 2049 6e20  #####..    # In 
-0006db40: 6269 6e61 7279 2063 6c61 7373 6966 6963  binary classific
-0006db50: 6174 696f 6e20 7365 7474 696e 6773 0d0a  ation settings..
-0006db60: 2020 2020 2320 436f 6d70 7574 6520 7468      # Compute th
-0006db70: 6520 6176 6572 6167 6520 7072 6563 6973  e average precis
-0006db80: 696f 6e20 7363 6f72 6520 666f 7220 4269  ion score for Bi
-0006db90: 6e61 7279 2043 6c61 7373 6573 0d0a 2020  nary Classes..  
-0006dba0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0006dbb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dbc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dbd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dbe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dbf0: 230d 0a20 2020 2079 5f70 7265 6420 3d20  #..    y_pred = 
-0006dc00: 636c 6173 7369 6669 6572 2e70 7265 6469  classifier.predi
-0006dc10: 6374 2858 5f74 6573 7429 0d0a 2020 2020  ct(X_test)..    
-0006dc20: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
-0006dc30: 7261 6374 286e 702e 756e 6971 7565 2879  ract(np.unique(y
-0006dc40: 5f74 6573 7429 2c6e 702e 756e 6971 7565  _test),np.unique
-0006dc50: 2879 5f70 7265 6429 2929 203d 3d20 303a  (y_pred))) == 0:
-0006dc60: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
-0006dc70: 7320 3d20 6c69 7374 2872 616e 6765 286c  s = list(range(l
-0006dc80: 656e 286e 702e 756e 6971 7565 2879 5f74  en(np.unique(y_t
-0006dc90: 6573 7429 2929 290d 0a20 2020 2065 6c73  est))))..    els
-0006dca0: 653a 0d0a 2020 2020 2020 2020 636c 6173  e:..        clas
-0006dcb0: 7365 7320 3d20 6c69 7374 2872 616e 6765  ses = list(range
-0006dcc0: 286c 656e 286e 702e 756e 6971 7565 2879  (len(np.unique(y
-0006dcd0: 5f70 7265 6429 2929 290d 0a20 2020 2023  _pred))))..    #
-0006dce0: 636c 6173 7365 7320 3d20 6c69 7374 2872  classes = list(r
-0006dcf0: 616e 6765 286c 656e 286e 702e 756e 6971  ange(len(np.uniq
-0006dd00: 7565 2879 5f74 6573 7429 2929 290d 0a20  ue(y_test)))).. 
-0006dd10: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
-0006dd20: 656e 2863 6c61 7373 6573 290d 0a20 2020  en(classes)..   
-0006dd30: 2069 6620 6e5f 636c 6173 7365 7320 3d3d   if n_classes ==
-0006dd40: 2032 3a0d 0a20 2020 2020 2020 2074 7279   2:..        try
-0006dd50: 3a0d 0a20 2020 2020 2020 2020 2020 2079  :..            y
-0006dd60: 5f73 636f 7265 203d 2063 6c61 7373 6966  _score = classif
-0006dd70: 6965 722e 6465 6369 7369 6f6e 5f66 756e  ier.decision_fun
-0006dd80: 6374 696f 6e28 585f 7465 7374 290d 0a20  ction(X_test).. 
-0006dd90: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-0006dda0: 2020 2020 2020 2020 2020 2020 795f 7363              y_sc
-0006ddb0: 6f72 6520 3d20 636c 6173 7369 6669 6572  ore = classifier
-0006ddc0: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
-0006ddd0: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
-0006dde0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-0006ddf0: 2020 6176 6572 6167 655f 7072 6563 6973    average_precis
-0006de00: 696f 6e20 3d20 6176 6572 6167 655f 7072  ion = average_pr
-0006de10: 6563 6973 696f 6e5f 7363 6f72 6528 795f  ecision_score(y_
-0006de20: 7465 7374 2c20 795f 7363 6f72 6529 0d0a  test, y_score)..
-0006de30: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-0006de40: 0a20 2020 2020 2020 2020 2020 2061 7665  .            ave
-0006de50: 7261 6765 5f70 7265 6369 7369 6f6e 203d  rage_precision =
-0006de60: 206d 756c 7469 5f70 7265 6369 7369 6f6e   multi_precision
-0006de70: 2879 5f74 6573 742c 2063 6c61 7373 6966  (y_test, classif
-0006de80: 6965 722e 7072 6564 6963 7428 585f 7465  ier.predict(X_te
-0006de90: 7374 2929 2e6d 6561 6e28 290d 0a20 2020  st)).mean()..   
-0006dea0: 2020 2020 2070 7269 6e74 2827 4176 6572       print('Aver
-0006deb0: 6167 6520 7072 6563 6973 696f 6e2d 7265  age precision-re
-0006dec0: 6361 6c6c 2073 636f 7265 3a20 7b30 3a30  call score: {0:0
-0006ded0: 2e32 667d 272e 666f 726d 6174 280d 0a20  .2f}'.format(.. 
-0006dee0: 2020 2020 2020 2020 2020 2020 2061 7665               ave
-0006def0: 7261 6765 5f70 7265 6369 7369 6f6e 2929  rage_precision))
-0006df00: 0d0a 2020 2020 2020 2020 665f 7363 6f72  ..        f_scor
-0006df10: 6573 203d 206d 756c 7469 5f66 3128 795f  es = multi_f1(y_
-0006df20: 7465 7374 2c63 6c61 7373 6966 6965 722e  test,classifier.
-0006df30: 7072 6564 6963 7428 585f 7465 7374 2929  predict(X_test))
-0006df40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0006df50: 274d 6163 726f 2046 3120 7363 6f72 652c  'Macro F1 score,
-0006df60: 2061 7665 7261 6765 6420 6f76 6572 2061   averaged over a
-0006df70: 6c6c 2063 6c61 7373 6573 3a20 7b30 3a30  ll classes: {0:0
-0006df80: 2e32 667d 270d 0a20 2020 2020 2020 2020  .2f}'..         
-0006df90: 2020 2020 202e 666f 726d 6174 2866 5f73       .format(f_s
-0006dfa0: 636f 7265 732e 6d65 616e 2829 2929 0d0a  cores.mean()))..
-0006dfb0: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-0006dfc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dfd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dfe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e000: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-0006e010: 2023 2050 6c6f 7420 7468 6520 5072 6563   # Plot the Prec
-0006e020: 6973 696f 6e2d 5265 6361 6c6c 2063 7572  ision-Recall cur
-0006e030: 7665 0d0a 2020 2020 2020 2020 2320 2e2e  ve..        # ..
-0006e040: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e050: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-0006e060: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
-0006e070: 7265 2866 6967 7369 7a65 3d66 6967 7369  re(figsize=figsi
-0006e080: 7a65 290d 0a20 2020 2020 2020 2074 7279  ze)..        try
-0006e090: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0006e0a0: 2323 2054 6869 7320 776f 726b 7320 666f  ## This works fo
-0006e0b0: 7220 4c6f 6769 7374 6963 2052 6567 7265  r Logistic Regre
-0006e0c0: 7373 696f 6e20 616e 6420 6f74 6865 7220  ssion and other 
-0006e0d0: 4c69 6e65 6172 204d 6f64 656c 7320 2323  Linear Models ##
-0006e0e0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0006e0f0: 7072 6563 6973 696f 6e2c 2072 6563 616c  precision, recal
-0006e100: 6c2c 205f 203d 2070 7265 6369 7369 6f6e  l, _ = precision
-0006e110: 5f72 6563 616c 6c5f 6375 7276 6528 795f  _recall_curve(y_
-0006e120: 7465 7374 2c20 795f 7363 6f72 6529 0d0a  test, y_score)..
-0006e130: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-0006e140: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-0006e150: 2054 6869 7320 776f 726b 7320 666f 7220   This works for 
-0006e160: 4e6f 6e20 4c69 6e65 6172 204d 6f64 656c  Non Linear Model
-0006e170: 7320 7375 6368 2061 7320 466f 7265 7374  s such as Forest
-0006e180: 7320 616e 6420 5847 426f 6f73 7420 2323  s and XGBoost ##
-0006e190: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0006e1a0: 2070 7265 6369 7369 6f6e 2c20 7265 6361   precision, reca
-0006e1b0: 6c6c 2c20 5f20 3d20 7072 6563 6973 696f  ll, _ = precisio
-0006e1c0: 6e5f 7265 6361 6c6c 5f63 7572 7665 2879  n_recall_curve(y
-0006e1d0: 5f74 6573 742c 2079 5f73 636f 7265 5b3a  _test, y_score[:
-0006e1e0: 2c31 5d29 0d0a 0d0a 2020 2020 2020 2020  ,1])....        
-0006e1f0: 2320 496e 206d 6174 706c 6f74 6c69 6220  # In matplotlib 
-0006e200: 3c20 312e 352c 2070 6c74 2e66 696c 6c5f  < 1.5, plt.fill_
-0006e210: 6265 7477 6565 6e20 646f 6573 206e 6f74  between does not
-0006e220: 2068 6176 6520 6120 2773 7465 7027 2061   have a 'step' a
-0006e230: 7267 756d 656e 740d 0a20 2020 2020 2020  rgument..       
-0006e240: 2073 7465 705f 6b77 6172 6773 203d 2028   step_kwargs = (
-0006e250: 7b27 7374 6570 273a 2027 706f 7374 277d  {'step': 'post'}
-0006e260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006e270: 2020 2020 2020 2020 2069 6620 2773 7465           if 'ste
-0006e280: 7027 2069 6e20 7369 676e 6174 7572 6528  p' in signature(
-0006e290: 706c 742e 6669 6c6c 5f62 6574 7765 656e  plt.fill_between
-0006e2a0: 292e 7061 7261 6d65 7465 7273 0d0a 2020  ).parameters..  
-0006e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e2c0: 2020 2020 2065 6c73 6520 7b7d 290d 0a20       else {}).. 
-0006e2d0: 2020 2020 2020 2070 6c74 2e73 7465 7028         plt.step(
-0006e2e0: 7265 6361 6c6c 2c20 7072 6563 6973 696f  recall, precisio
-0006e2f0: 6e2c 2063 6f6c 6f72 3d27 6727 2c20 616c  n, color='g', al
-0006e300: 7068 613d 302e 322c 0d0a 2020 2020 2020  pha=0.2,..      
-0006e310: 2020 2020 2020 2020 2020 2077 6865 7265             where
-0006e320: 3d27 706f 7374 2729 0d0a 2020 2020 2020  ='post')..      
-0006e330: 2020 706c 742e 6669 6c6c 5f62 6574 7765    plt.fill_betwe
-0006e340: 656e 2872 6563 616c 6c2c 2070 7265 6369  en(recall, preci
-0006e350: 7369 6f6e 2c20 616c 7068 613d 302e 322c  sion, alpha=0.2,
-0006e360: 2063 6f6c 6f72 3d27 6727 2c20 2a2a 7374   color='g', **st
-0006e370: 6570 5f6b 7761 7267 7329 0d0a 0d0a 2020  ep_kwargs)....  
-0006e380: 2020 2020 2020 706c 742e 786c 6162 656c        plt.xlabel
-0006e390: 2827 5265 6361 6c6c 2729 0d0a 2020 2020  ('Recall')..    
-0006e3a0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-0006e3b0: 5072 6563 6973 696f 6e27 290d 0a20 2020  Precision')..   
-0006e3c0: 2020 2020 2070 6c74 2e79 6c69 6d28 5b30       plt.ylim([0
-0006e3d0: 2e30 2c20 312e 3035 5d29 0d0a 2020 2020  .0, 1.05])..    
-0006e3e0: 2020 2020 706c 742e 786c 696d 285b 302e      plt.xlim([0.
-0006e3f0: 302c 2031 2e30 5d29 0d0a 2020 2020 2020  0, 1.0])..      
-0006e400: 2020 706c 742e 7469 746c 6528 2750 7265    plt.title('Pre
-0006e410: 6369 7369 6f6e 2d52 6563 616c 6c20 6375  cision-Recall cu
-0006e420: 7276 653a 2041 7667 2e50 7265 6369 7369  rve: Avg.Precisi
-0006e430: 6f6e 3d7b 303a 302e 3266 7d2c 2041 7667  on={0:0.2f}, Avg
-0006e440: 2046 313d 7b31 3a30 2e32 667d 272e 666f   F1={1:0.2f}'.fo
-0006e450: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-0006e460: 2020 2020 2020 2020 2061 7665 7261 6765           average
-0006e470: 5f70 7265 6369 7369 6f6e 2c66 5f73 636f  _precision,f_sco
-0006e480: 7265 732e 6d65 616e 2829 2929 0d0a 2020  res.mean()))..  
-0006e490: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
-0006e4a0: 3b0d 0a20 2020 2020 2020 2023 2323 2323  ;..        #####
-0006e4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006db30: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
+0006db40: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
+0006db50: 6563 7469 6f6e 2069 6d70 6f72 7420 7472  ection import tr
+0006db60: 6169 6e5f 7465 7374 5f73 706c 6974 0d0a  ain_test_split..
+0006db70: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0006db80: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
+0006db90: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+0006dba0: 6631 5f73 636f 7265 0d0a 696d 706f 7274  f1_score..import
+0006dbb0: 2063 6f70 790d 0a69 6d70 6f72 7420 6d61   copy..import ma
+0006dbc0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+0006dbd0: 6173 2070 6c74 0d0a 6672 6f6d 2069 6e73  as plt..from ins
+0006dbe0: 7065 6374 2069 6d70 6f72 7420 7369 676e  pect import sign
+0006dbf0: 6174 7572 650d 0a66 726f 6d20 736b 6c65  ature..from skle
+0006dc00: 6172 6e2e 7072 6570 726f 6365 7373 696e  arn.preprocessin
+0006dc10: 6720 696d 706f 7274 206c 6162 656c 5f62  g import label_b
+0006dc20: 696e 6172 697a 650d 0a66 726f 6d20 736b  inarize..from sk
+0006dc30: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+0006dc40: 706f 7274 2070 7265 6369 7369 6f6e 5f72  port precision_r
+0006dc50: 6563 616c 6c5f 6375 7276 650d 0a66 726f  ecall_curve..fro
+0006dc60: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+0006dc70: 7320 696d 706f 7274 2061 7665 7261 6765  s import average
+0006dc80: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
+0006dc90: 0d0a 6672 6f6d 2069 7465 7274 6f6f 6c73  ..from itertools
+0006dca0: 2069 6d70 6f72 7420 6379 636c 650d 0a23   import cycle..#
+0006dcb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dcc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dd00: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+0006dd10: 6620 6d75 6c74 695f 6631 2874 7275 7468  f multi_f1(truth
+0006dd20: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+0006dd30: 0a20 2020 2072 6574 7572 6e20 6631 5f73  .    return f1_s
+0006dd40: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+0006dd50: 6963 7469 6f6e 732c 6176 6572 6167 653d  ictions,average=
+0006dd60: 4e6f 6e65 290d 0a64 6566 206d 756c 7469  None)..def multi
+0006dd70: 5f70 7265 6369 7369 6f6e 2874 7275 7468  _precision(truth
+0006dd80: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+0006dd90: 0a20 2020 2072 6574 7572 6e20 7072 6563  .    return prec
+0006dda0: 6973 696f 6e5f 7363 6f72 6528 7472 7574  ision_score(trut
+0006ddb0: 682c 2070 7265 6469 6374 696f 6e73 2c61  h, predictions,a
+0006ddc0: 7665 7261 6765 3d4e 6f6e 6529 0d0a 2323  verage=None)..##
+0006ddd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006dde0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ddf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006de00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006de10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006de20: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+0006de30: 6620 4472 6177 5f4d 435f 4d4c 5f50 525f  f Draw_MC_ML_PR_
+0006de40: 524f 435f 4375 7276 6573 2863 6c61 7373  ROC_Curves(class
+0006de50: 6966 6965 722c 585f 7465 7374 2c79 5f74  ifier,X_test,y_t
+0006de60: 6573 7429 3a0d 0a20 2020 2022 2222 0d0a  est):..    """..
+0006de70: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+0006de80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006de90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dea0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006deb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dec0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+0006ded0: 2020 5072 6563 6973 696f 6e2d 5265 6361    Precision-Reca
+0006dee0: 6c6c 2043 7572 7665 733a 2045 7874 656e  ll Curves: Exten
+0006def0: 7369 6f6e 206f 6620 4f72 6967 696e 616c  sion of Original
+0006df00: 2056 6572 7369 6f6e 2069 6e20 534b 4c65   Version in SKLe
+0006df10: 6172 6e27 7320 446f 6375 6d65 6e74 6174  arn's Documentat
+0006df20: 696f 6e20 5061 6765 3a0d 0a20 2020 2068  ion Page:..    h
+0006df30: 7474 7073 3a2f 2f73 6369 6b69 742d 6c65  ttps://scikit-le
+0006df40: 6172 6e2e 6f72 672f 7374 6162 6c65 2f61  arn.org/stable/a
+0006df50: 7574 6f5f 6578 616d 706c 6573 2f6d 6f64  uto_examples/mod
+0006df60: 656c 5f73 656c 6563 7469 6f6e 2f70 6c6f  el_selection/plo
+0006df70: 745f 7072 6563 6973 696f 6e5f 7265 6361  t_precision_reca
+0006df80: 6c6c 2e68 746d 6c0d 0a20 2020 203d 3d3d  ll.html..    ===
+0006df90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dfa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dfb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dfc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dfd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0006dfe0: 3d3d 3d3d 3d0d 0a20 2020 2022 2222 0d0a  =====..    """..
+0006dff0: 2020 2020 6669 6773 697a 6520 3d20 2831      figsize = (1
+0006e000: 302c 2036 290d 0a20 2020 2023 2323 2323  0, 6)..    #####
+0006e010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e050: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006e060: 2320 496e 2062 696e 6172 7920 636c 6173  # In binary clas
+0006e070: 7369 6669 6361 7469 6f6e 2073 6574 7469  sification setti
+0006e080: 6e67 730d 0a20 2020 2023 2043 6f6d 7075  ngs..    # Compu
+0006e090: 7465 2074 6865 2061 7665 7261 6765 2070  te the average p
+0006e0a0: 7265 6369 7369 6f6e 2073 636f 7265 2066  recision score f
+0006e0b0: 6f72 2042 696e 6172 7920 436c 6173 7365  or Binary Classe
+0006e0c0: 730d 0a20 2020 2023 2323 2323 2323 2323  s..    #########
+0006e0d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e0e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e0f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e110: 2323 2323 2323 0d0a 2020 2020 795f 7072  ######..    y_pr
+0006e120: 6564 203d 2063 6c61 7373 6966 6965 722e  ed = classifier.
+0006e130: 7072 6564 6963 7428 585f 7465 7374 290d  predict(X_test).
+0006e140: 0a20 2020 2069 6620 6c65 6e28 6c65 6674  .    if len(left
+0006e150: 5f73 7562 7472 6163 7428 6e70 2e75 6e69  _subtract(np.uni
+0006e160: 7175 6528 795f 7465 7374 292c 6e70 2e75  que(y_test),np.u
+0006e170: 6e69 7175 6528 795f 7072 6564 2929 2920  nique(y_pred))) 
+0006e180: 3d3d 2030 3a0d 0a20 2020 2020 2020 2063  == 0:..        c
+0006e190: 6c61 7373 6573 203d 206c 6973 7428 7261  lasses = list(ra
+0006e1a0: 6e67 6528 6c65 6e28 6e70 2e75 6e69 7175  nge(len(np.uniqu
+0006e1b0: 6528 795f 7465 7374 2929 2929 0d0a 2020  e(y_test))))..  
+0006e1c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006e1d0: 2063 6c61 7373 6573 203d 206c 6973 7428   classes = list(
+0006e1e0: 7261 6e67 6528 6c65 6e28 6e70 2e75 6e69  range(len(np.uni
+0006e1f0: 7175 6528 795f 7072 6564 2929 2929 0d0a  que(y_pred))))..
+0006e200: 2020 2020 2363 6c61 7373 6573 203d 206c      #classes = l
+0006e210: 6973 7428 7261 6e67 6528 6c65 6e28 6e70  ist(range(len(np
+0006e220: 2e75 6e69 7175 6528 795f 7465 7374 2929  .unique(y_test))
+0006e230: 2929 0d0a 2020 2020 6e5f 636c 6173 7365  ))..    n_classe
+0006e240: 7320 3d20 6c65 6e28 636c 6173 7365 7329  s = len(classes)
+0006e250: 0d0a 2020 2020 6966 206e 5f63 6c61 7373  ..    if n_class
+0006e260: 6573 203d 3d20 323a 0d0a 2020 2020 2020  es == 2:..      
+0006e270: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+0006e280: 2020 2020 795f 7363 6f72 6520 3d20 636c      y_score = cl
+0006e290: 6173 7369 6669 6572 2e64 6563 6973 696f  assifier.decisio
+0006e2a0: 6e5f 6675 6e63 7469 6f6e 2858 5f74 6573  n_function(X_tes
+0006e2b0: 7429 0d0a 2020 2020 2020 2020 6578 6365  t)..        exce
+0006e2c0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+0006e2d0: 2079 5f73 636f 7265 203d 2063 6c61 7373   y_score = class
+0006e2e0: 6966 6965 722e 7072 6564 6963 745f 7072  ifier.predict_pr
+0006e2f0: 6f62 6128 585f 7465 7374 290d 0a20 2020  oba(X_test)..   
+0006e300: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+0006e310: 2020 2020 2020 2061 7665 7261 6765 5f70         average_p
+0006e320: 7265 6369 7369 6f6e 203d 2061 7665 7261  recision = avera
+0006e330: 6765 5f70 7265 6369 7369 6f6e 5f73 636f  ge_precision_sco
+0006e340: 7265 2879 5f74 6573 742c 2079 5f73 636f  re(y_test, y_sco
+0006e350: 7265 290d 0a20 2020 2020 2020 2065 7863  re)..        exc
+0006e360: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0006e370: 2020 6176 6572 6167 655f 7072 6563 6973    average_precis
+0006e380: 696f 6e20 3d20 6d75 6c74 695f 7072 6563  ion = multi_prec
+0006e390: 6973 696f 6e28 795f 7465 7374 2c20 636c  ision(y_test, cl
+0006e3a0: 6173 7369 6669 6572 2e70 7265 6469 6374  assifier.predict
+0006e3b0: 2858 5f74 6573 7429 292e 6d65 616e 2829  (X_test)).mean()
+0006e3c0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006e3d0: 2741 7665 7261 6765 2070 7265 6369 7369  'Average precisi
+0006e3e0: 6f6e 2d72 6563 616c 6c20 7363 6f72 653a  on-recall score:
+0006e3f0: 207b 303a 302e 3266 7d27 2e66 6f72 6d61   {0:0.2f}'.forma
+0006e400: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+0006e410: 2020 6176 6572 6167 655f 7072 6563 6973    average_precis
+0006e420: 696f 6e29 290d 0a20 2020 2020 2020 2066  ion))..        f
+0006e430: 5f73 636f 7265 7320 3d20 6d75 6c74 695f  _scores = multi_
+0006e440: 6631 2879 5f74 6573 742c 636c 6173 7369  f1(y_test,classi
+0006e450: 6669 6572 2e70 7265 6469 6374 2858 5f74  fier.predict(X_t
+0006e460: 6573 7429 290d 0a20 2020 2020 2020 2070  est))..        p
+0006e470: 7269 6e74 2827 4d61 6372 6f20 4631 2073  rint('Macro F1 s
+0006e480: 636f 7265 2c20 6176 6572 6167 6564 206f  core, averaged o
+0006e490: 7665 7220 616c 6c20 636c 6173 7365 733a  ver all classes:
+0006e4a0: 207b 303a 302e 3266 7d27 0d0a 2020 2020   {0:0.2f}'..    
+0006e4b0: 2020 2020 2020 2020 2020 2e66 6f72 6d61            .forma
+0006e4c0: 7428 665f 7363 6f72 6573 2e6d 6561 6e28  t(f_scores.mean(
+0006e4d0: 2929 290d 0a20 2020 2020 2020 2023 2323  )))..        ###
 0006e4e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4f0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0006e500: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-0006e510: 2049 6e20 6d75 6c74 692d 6c61 6265 6c20   In multi-label 
-0006e520: 7365 7474 696e 6773 0d0a 2020 2020 2020  settings..      
-0006e530: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
-0006e540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-0006e550: 2020 2020 2020 230d 0a20 2020 2020 2020        #..       
-0006e560: 2023 2043 7265 6174 6520 6d75 6c74 692d   # Create multi-
-0006e570: 6c61 6265 6c20 6461 7461 2c20 6669 742c  label data, fit,
-0006e580: 2061 6e64 2070 7265 6469 6374 0d0a 2020   and predict..  
-0006e590: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
-0006e5a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5c0: 2e2e 2e0d 0a20 2020 2020 2020 2023 0d0a  .....        #..
-0006e5d0: 2020 2020 2020 2020 2320 5765 2063 7265          # We cre
-0006e5e0: 6174 6520 6120 6d75 6c74 692d 6c61 6265  ate a multi-labe
-0006e5f0: 6c20 6461 7461 7365 742c 2074 6f20 696c  l dataset, to il
-0006e600: 6c75 7374 7261 7465 2074 6865 2070 7265  lustrate the pre
-0006e610: 6369 7369 6f6e 2d72 6563 616c 6c20 696e  cision-recall in
-0006e620: 0d0a 2020 2020 2020 2020 2320 6d75 6c74  ..        # mult
-0006e630: 692d 6c61 6265 6c20 7365 7474 696e 6773  i-label settings
-0006e640: 0d0a 0d0a 2020 2020 2020 2020 2320 5573  ....        # Us
-0006e650: 6520 6c61 6265 6c5f 6269 6e61 7269 7a65  e label_binarize
-0006e660: 2074 6f20 6265 206d 756c 7469 2d6c 6162   to be multi-lab
-0006e670: 656c 206c 696b 6520 7365 7474 696e 6773  el like settings
-0006e680: 0d0a 2020 2020 2020 2020 5920 3d20 6c61  ..        Y = la
-0006e690: 6265 6c5f 6269 6e61 7269 7a65 2879 5f74  bel_binarize(y_t
-0006e6a0: 6573 742c 2063 6c61 7373 6573 290d 0a20  est, classes).. 
-0006e6b0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
-0006e6c0: 203d 2059 2e73 6861 7065 5b31 5d0d 0a20   = Y.shape[1].. 
-0006e6d0: 2020 2020 2020 2059 5f74 6573 7420 3d20         Y_test = 
-0006e6e0: 636f 7079 2e64 6565 7063 6f70 7928 5929  copy.deepcopy(Y)
-0006e6f0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0006e700: 2020 2020 2020 2020 2020 2020 795f 7363              y_sc
-0006e710: 6f72 6520 3d20 636c 6173 7369 6669 6572  ore = classifier
-0006e720: 2e64 6563 6973 696f 6e5f 6675 6e63 7469  .decision_functi
-0006e730: 6f6e 2858 5f74 6573 7429 0d0a 2020 2020  on(X_test)..    
-0006e740: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-0006e750: 2020 2020 2020 2020 2079 5f73 636f 7265           y_score
-0006e760: 203d 2063 6c61 7373 6966 6965 722e 7072   = classifier.pr
-0006e770: 6564 6963 745f 7072 6f62 6128 585f 7465  edict_proba(X_te
-0006e780: 7374 290d 0a0d 0a20 2020 2020 2020 2023  st)....        #
-0006e790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e7a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e7b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e7c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e7d0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006e7e0: 2020 2020 2020 2020 2320 5468 6520 6176          # The av
-0006e7f0: 6572 6167 6520 7072 6563 6973 696f 6e20  erage precision 
-0006e800: 7363 6f72 6520 696e 206d 756c 7469 2d6c  score in multi-l
-0006e810: 6162 656c 2073 6574 7469 6e67 730d 0a20  abel settings.. 
-0006e820: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
-0006e830: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e840: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e850: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a0d  ................
-0006e860: 0a20 2020 2020 2020 2023 2046 6f72 2065  .        # For e
-0006e870: 6163 6820 636c 6173 730d 0a20 2020 2020  ach class..     
-0006e880: 2020 2070 7265 6369 7369 6f6e 203d 2064     precision = d
-0006e890: 6963 7428 290d 0a20 2020 2020 2020 2072  ict()..        r
-0006e8a0: 6563 616c 6c20 3d20 6469 6374 2829 0d0a  ecall = dict()..
-0006e8b0: 2020 2020 2020 2020 6176 6572 6167 655f          average_
-0006e8c0: 7072 6563 6973 696f 6e20 3d20 6469 6374  precision = dict
-0006e8d0: 2829 0d0a 2020 2020 2020 2020 666f 7220  ()..        for 
-0006e8e0: 6920 696e 2072 616e 6765 286e 5f63 6c61  i in range(n_cla
-0006e8f0: 7373 6573 293a 0d0a 2020 2020 2020 2020  sses):..        
-0006e900: 2020 2020 7072 6563 6973 696f 6e5b 695d      precision[i]
-0006e910: 2c20 7265 6361 6c6c 5b69 5d2c 205f 203d  , recall[i], _ =
-0006e920: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
-0006e930: 6c5f 6375 7276 6528 595f 7465 7374 5b3a  l_curve(Y_test[:
-0006e940: 2c20 695d 2c0d 0a20 2020 2020 2020 2020  , i],..         
-0006e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e980: 2020 2020 2020 2079 5f73 636f 7265 5b3a         y_score[:
-0006e990: 2c20 695d 290d 0a20 2020 2020 2020 2020  , i])..         
-0006e9a0: 2020 2061 7665 7261 6765 5f70 7265 6369     average_preci
-0006e9b0: 7369 6f6e 5b69 5d20 3d20 6176 6572 6167  sion[i] = averag
-0006e9c0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-0006e9d0: 6528 595f 7465 7374 5b3a 2c20 695d 2c20  e(Y_test[:, i], 
-0006e9e0: 795f 7363 6f72 655b 3a2c 2069 5d29 0d0a  y_score[:, i])..
-0006e9f0: 0d0a 2020 2020 2020 2020 2320 4120 226d  ..        # A "m
-0006ea00: 6963 726f 2d61 7665 7261 6765 223a 2071  icro-average": q
-0006ea10: 7561 6e74 6966 7969 6e67 2073 636f 7265  uantifying score
-0006ea20: 206f 6e20 616c 6c20 636c 6173 7365 7320   on all classes 
-0006ea30: 6a6f 696e 746c 790d 0a20 2020 2020 2020  jointly..       
-0006ea40: 2070 7265 6369 7369 6f6e 5b22 6d69 6372   precision["micr
-0006ea50: 6f22 5d2c 2072 6563 616c 6c5b 226d 6963  o"], recall["mic
-0006ea60: 726f 225d 2c20 5f20 3d20 7072 6563 6973  ro"], _ = precis
-0006ea70: 696f 6e5f 7265 6361 6c6c 5f63 7572 7665  ion_recall_curve
-0006ea80: 2859 5f74 6573 745b 0d0a 2020 2020 2020  (Y_test[..      
-0006ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006eaa0: 2020 3a2c 3a6e 5f63 6c61 7373 6573 5d2e    :,:n_classes].
-0006eab0: 7261 7665 6c28 292c 795f 7363 6f72 655b  ravel(),y_score[
-0006eac0: 3a2c 3a6e 5f63 6c61 7373 6573 5d2e 7261  :,:n_classes].ra
-0006ead0: 7665 6c28 2929 0d0a 2020 2020 2020 2020  vel())..        
-0006eae0: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
-0006eaf0: 6e5b 226d 6963 726f 225d 203d 2061 7665  n["micro"] = ave
-0006eb00: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
-0006eb10: 636f 7265 2859 5f74 6573 745b 0d0a 2020  core(Y_test[..  
-0006eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006eb30: 2020 2020 2020 3a2c 3a6e 5f63 6c61 7373        :,:n_class
-0006eb40: 6573 5d2c 2079 5f73 636f 7265 5b3a 2c3a  es], y_score[:,:
-0006eb50: 6e5f 636c 6173 7365 735d 2c61 7665 7261  n_classes],avera
-0006eb60: 6765 3d22 6d69 6372 6f22 290d 0a20 2020  ge="micro")..   
-0006eb70: 2020 2020 2070 7269 6e74 2827 4176 6572       print('Aver
-0006eb80: 6167 6520 7072 6563 6973 696f 6e20 7363  age precision sc
-0006eb90: 6f72 652c 206d 6963 726f 2d61 7665 7261  ore, micro-avera
-0006eba0: 6765 6420 6f76 6572 2061 6c6c 2063 6c61  ged over all cla
-0006ebb0: 7373 6573 3a20 7b30 3a30 2e32 667d 270d  sses: {0:0.2f}'.
-0006ebc0: 0a20 2020 2020 2020 2020 2020 2020 202e  .              .
-0006ebd0: 666f 726d 6174 2861 7665 7261 6765 5f70  format(average_p
-0006ebe0: 7265 6369 7369 6f6e 5b22 6d69 6372 6f22  recision["micro"
-0006ebf0: 5d29 290d 0a0d 0a20 2020 2020 2020 2023  ]))....        #
-0006ec00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec40: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006ec50: 2020 2020 2020 2020 2320 506c 6f74 2050          # Plot P
-0006ec60: 7265 6369 7369 6f6e 2d52 6563 616c 6c20  recision-Recall 
-0006ec70: 6375 7276 6520 666f 7220 6561 6368 2063  curve for each c
-0006ec80: 6c61 7373 2061 6e64 2069 736f 2d66 3120  lass and iso-f1 
-0006ec90: 6375 7276 6573 0d0a 2020 2020 2020 2020  curves..        
-0006eca0: 2320 506c 6f74 2074 6865 206d 6963 726f  # Plot the micro
-0006ecb0: 2d61 7665 7261 6765 6420 5072 6563 6973  -averaged Precis
-0006ecc0: 696f 6e2d 5265 6361 6c6c 2063 7572 7665  ion-Recall curve
-0006ecd0: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
+0006e4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e520: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0006e530: 2020 2020 2020 2320 506c 6f74 2074 6865        # Plot the
+0006e540: 2050 7265 6369 7369 6f6e 2d52 6563 616c   Precision-Recal
+0006e550: 6c20 6375 7276 650d 0a20 2020 2020 2020  l curve..       
+0006e560: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
+0006e570: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006e580: 2e2e 2e0d 0a20 2020 2020 2020 2070 6c74  .....        plt
+0006e590: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
+0006e5a0: 6669 6773 697a 6529 0d0a 2020 2020 2020  figsize)..      
+0006e5b0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+0006e5c0: 2020 2020 2323 2320 5468 6973 2077 6f72      ### This wor
+0006e5d0: 6b73 2066 6f72 204c 6f67 6973 7469 6320  ks for Logistic 
+0006e5e0: 5265 6772 6573 7369 6f6e 2061 6e64 206f  Regression and o
+0006e5f0: 7468 6572 204c 696e 6561 7220 4d6f 6465  ther Linear Mode
+0006e600: 6c73 2023 2323 230d 0a20 2020 2020 2020  ls ####..       
+0006e610: 2020 2020 2070 7265 6369 7369 6f6e 2c20       precision, 
+0006e620: 7265 6361 6c6c 2c20 5f20 3d20 7072 6563  recall, _ = prec
+0006e630: 6973 696f 6e5f 7265 6361 6c6c 5f63 7572  ision_recall_cur
+0006e640: 7665 2879 5f74 6573 742c 2079 5f73 636f  ve(y_test, y_sco
+0006e650: 7265 290d 0a20 2020 2020 2020 2065 7863  re)..        exc
+0006e660: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0006e670: 2020 2323 2320 5468 6973 2077 6f72 6b73    ### This works
+0006e680: 2066 6f72 204e 6f6e 204c 696e 6561 7220   for Non Linear 
+0006e690: 4d6f 6465 6c73 2073 7563 6820 6173 2046  Models such as F
+0006e6a0: 6f72 6573 7473 2061 6e64 2058 4742 6f6f  orests and XGBoo
+0006e6b0: 7374 2023 2323 2323 0d0a 2020 2020 2020  st #####..      
+0006e6c0: 2020 2020 2020 7072 6563 6973 696f 6e2c        precision,
+0006e6d0: 2072 6563 616c 6c2c 205f 203d 2070 7265   recall, _ = pre
+0006e6e0: 6369 7369 6f6e 5f72 6563 616c 6c5f 6375  cision_recall_cu
+0006e6f0: 7276 6528 795f 7465 7374 2c20 795f 7363  rve(y_test, y_sc
+0006e700: 6f72 655b 3a2c 315d 290d 0a0d 0a20 2020  ore[:,1])....   
+0006e710: 2020 2020 2023 2049 6e20 6d61 7470 6c6f       # In matplo
+0006e720: 746c 6962 203c 2031 2e35 2c20 706c 742e  tlib < 1.5, plt.
+0006e730: 6669 6c6c 5f62 6574 7765 656e 2064 6f65  fill_between doe
+0006e740: 7320 6e6f 7420 6861 7665 2061 2027 7374  s not have a 'st
+0006e750: 6570 2720 6172 6775 6d65 6e74 0d0a 2020  ep' argument..  
+0006e760: 2020 2020 2020 7374 6570 5f6b 7761 7267        step_kwarg
+0006e770: 7320 3d20 287b 2773 7465 7027 3a20 2770  s = ({'step': 'p
+0006e780: 6f73 7427 7d0d 0a20 2020 2020 2020 2020  ost'}..         
+0006e790: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0006e7a0: 2027 7374 6570 2720 696e 2073 6967 6e61   'step' in signa
+0006e7b0: 7475 7265 2870 6c74 2e66 696c 6c5f 6265  ture(plt.fill_be
+0006e7c0: 7477 6565 6e29 2e70 6172 616d 6574 6572  tween).parameter
+0006e7d0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0006e7e0: 2020 2020 2020 2020 2020 656c 7365 207b            else {
+0006e7f0: 7d29 0d0a 2020 2020 2020 2020 706c 742e  })..        plt.
+0006e800: 7374 6570 2872 6563 616c 6c2c 2070 7265  step(recall, pre
+0006e810: 6369 7369 6f6e 2c20 636f 6c6f 723d 2767  cision, color='g
+0006e820: 272c 2061 6c70 6861 3d30 2e32 2c0d 0a20  ', alpha=0.2,.. 
+0006e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006e840: 7768 6572 653d 2770 6f73 7427 290d 0a20  where='post').. 
+0006e850: 2020 2020 2020 2070 6c74 2e66 696c 6c5f         plt.fill_
+0006e860: 6265 7477 6565 6e28 7265 6361 6c6c 2c20  between(recall, 
+0006e870: 7072 6563 6973 696f 6e2c 2061 6c70 6861  precision, alpha
+0006e880: 3d30 2e32 2c20 636f 6c6f 723d 2767 272c  =0.2, color='g',
+0006e890: 202a 2a73 7465 705f 6b77 6172 6773 290d   **step_kwargs).
+0006e8a0: 0a0d 0a20 2020 2020 2020 2070 6c74 2e78  ...        plt.x
+0006e8b0: 6c61 6265 6c28 2752 6563 616c 6c27 290d  label('Recall').
+0006e8c0: 0a20 2020 2020 2020 2070 6c74 2e79 6c61  .        plt.yla
+0006e8d0: 6265 6c28 2750 7265 6369 7369 6f6e 2729  bel('Precision')
+0006e8e0: 0d0a 2020 2020 2020 2020 706c 742e 796c  ..        plt.yl
+0006e8f0: 696d 285b 302e 302c 2031 2e30 355d 290d  im([0.0, 1.05]).
+0006e900: 0a20 2020 2020 2020 2070 6c74 2e78 6c69  .        plt.xli
+0006e910: 6d28 5b30 2e30 2c20 312e 305d 290d 0a20  m([0.0, 1.0]).. 
+0006e920: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
+0006e930: 2827 5072 6563 6973 696f 6e2d 5265 6361  ('Precision-Reca
+0006e940: 6c6c 2063 7572 7665 3a20 4176 672e 5072  ll curve: Avg.Pr
+0006e950: 6563 6973 696f 6e3d 7b30 3a30 2e32 667d  ecision={0:0.2f}
+0006e960: 2c20 4176 6720 4631 3d7b 313a 302e 3266  , Avg F1={1:0.2f
+0006e970: 7d27 2e66 6f72 6d61 7428 0d0a 2020 2020  }'.format(..    
+0006e980: 2020 2020 2020 2020 2020 2020 2020 6176                av
+0006e990: 6572 6167 655f 7072 6563 6973 696f 6e2c  erage_precision,
+0006e9a0: 665f 7363 6f72 6573 2e6d 6561 6e28 2929  f_scores.mean())
+0006e9b0: 290d 0a20 2020 2020 2020 2070 6c74 2e73  )..        plt.s
+0006e9c0: 686f 7728 293b 0d0a 2020 2020 2020 2020  how();..        
+0006e9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006e9f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ea00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ea10: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0006ea20: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+0006ea30: 2020 2020 2320 496e 206d 756c 7469 2d6c      # In multi-l
+0006ea40: 6162 656c 2073 6574 7469 6e67 730d 0a20  abel settings.. 
+0006ea50: 2020 2020 2020 2023 202d 2d2d 2d2d 2d2d         # -------
+0006ea60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0006ea70: 2d0d 0a20 2020 2020 2020 2023 0d0a 2020  -..        #..  
+0006ea80: 2020 2020 2020 2320 4372 6561 7465 206d        # Create m
+0006ea90: 756c 7469 2d6c 6162 656c 2064 6174 612c  ulti-label data,
+0006eaa0: 2066 6974 2c20 616e 6420 7072 6564 6963   fit, and predic
+0006eab0: 740d 0a20 2020 2020 2020 2023 202e 2e2e  t..        # ...
+0006eac0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ead0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006eae0: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
+0006eaf0: 2020 230d 0a20 2020 2020 2020 2023 2057    #..        # W
+0006eb00: 6520 6372 6561 7465 2061 206d 756c 7469  e create a multi
+0006eb10: 2d6c 6162 656c 2064 6174 6173 6574 2c20  -label dataset, 
+0006eb20: 746f 2069 6c6c 7573 7472 6174 6520 7468  to illustrate th
+0006eb30: 6520 7072 6563 6973 696f 6e2d 7265 6361  e precision-reca
+0006eb40: 6c6c 2069 6e0d 0a20 2020 2020 2020 2023  ll in..        #
+0006eb50: 206d 756c 7469 2d6c 6162 656c 2073 6574   multi-label set
+0006eb60: 7469 6e67 730d 0a0d 0a20 2020 2020 2020  tings....       
+0006eb70: 2023 2055 7365 206c 6162 656c 5f62 696e   # Use label_bin
+0006eb80: 6172 697a 6520 746f 2062 6520 6d75 6c74  arize to be mult
+0006eb90: 692d 6c61 6265 6c20 6c69 6b65 2073 6574  i-label like set
+0006eba0: 7469 6e67 730d 0a20 2020 2020 2020 2059  tings..        Y
+0006ebb0: 203d 206c 6162 656c 5f62 696e 6172 697a   = label_binariz
+0006ebc0: 6528 795f 7465 7374 2c20 636c 6173 7365  e(y_test, classe
+0006ebd0: 7329 0d0a 2020 2020 2020 2020 6e5f 636c  s)..        n_cl
+0006ebe0: 6173 7365 7320 3d20 592e 7368 6170 655b  asses = Y.shape[
+0006ebf0: 315d 0d0a 2020 2020 2020 2020 595f 7465  1]..        Y_te
+0006ec00: 7374 203d 2063 6f70 792e 6465 6570 636f  st = copy.deepco
+0006ec10: 7079 2859 290d 0a20 2020 2020 2020 2074  py(Y)..        t
+0006ec20: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+0006ec30: 2079 5f73 636f 7265 203d 2063 6c61 7373   y_score = class
+0006ec40: 6966 6965 722e 6465 6369 7369 6f6e 5f66  ifier.decision_f
+0006ec50: 756e 6374 696f 6e28 585f 7465 7374 290d  unction(X_test).
+0006ec60: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+0006ec70: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+0006ec80: 7363 6f72 6520 3d20 636c 6173 7369 6669  score = classifi
+0006ec90: 6572 2e70 7265 6469 6374 5f70 726f 6261  er.predict_proba
+0006eca0: 2858 5f74 6573 7429 0d0a 0d0a 2020 2020  (X_test)....    
+0006ecb0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+0006ecc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ecd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ece0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ecf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ed00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ed10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ed20: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-0006ed30: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-0006ed40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ed00: 2323 230d 0a20 2020 2020 2020 2023 2054  ###..        # T
+0006ed10: 6865 2061 7665 7261 6765 2070 7265 6369  he average preci
+0006ed20: 7369 6f6e 2073 636f 7265 2069 6e20 6d75  sion score in mu
+0006ed30: 6c74 692d 6c61 6265 6c20 7365 7474 696e  lti-label settin
+0006ed40: 6773 0d0a 2020 2020 2020 2020 2320 2e2e  gs..        # ..
 0006ed50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006ed60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006ed70: 2e2e 0d0a 2020 2020 2020 2020 230d 0a20  ....        #.. 
-0006ed80: 2020 2020 2020 2023 2073 6574 7570 2070         # setup p
-0006ed90: 6c6f 7420 6465 7461 696c 730d 0a20 2020  lot details..   
-0006eda0: 2020 2020 2063 6f6c 6f72 7320 3d20 6379       colors = cy
-0006edb0: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
-0006edc0: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
-0006edd0: 6b27 290d 0a0d 0a20 2020 2020 2020 2070  k')....        p
-0006ede0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
-0006edf0: 653d 6669 6773 697a 6529 0d0a 2020 2020  e=figsize)..    
-0006ee00: 2020 2020 665f 7363 6f72 6573 203d 206d      f_scores = m
-0006ee10: 756c 7469 5f66 3128 795f 7465 7374 2c63  ulti_f1(y_test,c
-0006ee20: 6c61 7373 6966 6965 722e 7072 6564 6963  lassifier.predic
-0006ee30: 7428 585f 7465 7374 2929 0d0a 2020 2020  t(X_test))..    
-0006ee40: 2020 2020 7072 696e 7428 274d 6163 726f      print('Macro
-0006ee50: 2046 3120 7363 6f72 652c 2061 7665 7261   F1 score, avera
-0006ee60: 6765 6420 6f76 6572 2061 6c6c 2063 6c61  ged over all cla
-0006ee70: 7373 6573 3a20 7b30 3a30 2e32 667d 270d  sses: {0:0.2f}'.
-0006ee80: 0a20 2020 2020 2020 2020 2020 2020 202e  .              .
-0006ee90: 666f 726d 6174 2866 5f73 636f 7265 732e  format(f_scores.
-0006eea0: 6d65 616e 2829 2929 0d0a 2020 2020 2020  mean()))..      
-0006eeb0: 2020 6c69 6e65 7320 3d20 5b5d 0d0a 2020    lines = []..  
-0006eec0: 2020 2020 2020 6c61 6265 6c73 203d 205b        labels = [
-0006eed0: 5d0d 0a20 2020 2020 2020 2066 6f72 2066  ]..        for f
-0006eee0: 5f73 636f 7265 2069 6e20 665f 7363 6f72  _score in f_scor
-0006eef0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0006ef00: 2078 203d 206e 702e 6c69 6e73 7061 6365   x = np.linspace
-0006ef10: 2830 2e30 312c 2031 290d 0a20 2020 2020  (0.01, 1)..     
-0006ef20: 2020 2020 2020 2079 203d 2066 5f73 636f         y = f_sco
-0006ef30: 7265 202a 2078 202f 2028 3220 2a20 7820  re * x / (2 * x 
-0006ef40: 2d20 665f 7363 6f72 6529 0d0a 2020 2020  - f_score)..    
-0006ef50: 2020 2020 2020 2020 6c2c 203d 2070 6c74          l, = plt
-0006ef60: 2e70 6c6f 7428 785b 7920 3e3d 2030 5d2c  .plot(x[y >= 0],
-0006ef70: 2079 5b79 203e 3d20 305d 2c20 636f 6c6f   y[y >= 0], colo
-0006ef80: 723d 2767 7261 7927 2c20 616c 7068 613d  r='gray', alpha=
-0006ef90: 302e 3229 0d0a 2020 2020 2020 2020 2020  0.2)..          
-0006efa0: 2020 706c 742e 616e 6e6f 7461 7465 2827    plt.annotate('
-0006efb0: 6631 3d7b 303a 302e 3266 7d27 2e66 6f72  f1={0:0.2f}'.for
-0006efc0: 6d61 7428 665f 7363 6f72 6529 2c20 7879  mat(f_score), xy
-0006efd0: 3d28 302e 392c 2079 5b34 355d 202b 2030  =(0.9, y[45] + 0
-0006efe0: 2e30 3229 290d 0a0d 0a20 2020 2020 2020  .02))....       
-0006eff0: 206c 696e 6573 2e61 7070 656e 6428 6c29   lines.append(l)
-0006f000: 0d0a 2020 2020 2020 2020 6c61 6265 6c73  ..        labels
-0006f010: 2e61 7070 656e 6428 2769 736f 2d66 3120  .append('iso-f1 
-0006f020: 6375 7276 6573 2729 0d0a 2020 2020 2020  curves')..      
-0006f030: 2020 6c2c 203d 2070 6c74 2e70 6c6f 7428    l, = plt.plot(
-0006f040: 7265 6361 6c6c 5b22 6d69 6372 6f22 5d2c  recall["micro"],
-0006f050: 2070 7265 6369 7369 6f6e 5b22 6d69 6372   precision["micr
-0006f060: 6f22 5d2c 2063 6f6c 6f72 3d27 676f 6c64  o"], color='gold
-0006f070: 272c 206c 773d 3229 0d0a 2020 2020 2020  ', lw=2)..      
-0006f080: 2020 6c69 6e65 732e 6170 7065 6e64 286c    lines.append(l
-0006f090: 290d 0a20 2020 2020 2020 206c 6162 656c  )..        label
-0006f0a0: 732e 6170 7065 6e64 2827 6d69 6372 6f2d  s.append('micro-
-0006f0b0: 6176 6572 6167 6520 5072 6563 6973 696f  average Precisio
-0006f0c0: 6e2d 7265 6361 6c6c 2028 6172 6561 203d  n-recall (area =
-0006f0d0: 207b 303a 302e 3266 7d29 270d 0a20 2020   {0:0.2f})'..   
-0006f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006f0f0: 2020 2027 272e 666f 726d 6174 2861 7665     ''.format(ave
-0006f100: 7261 6765 5f70 7265 6369 7369 6f6e 5b22  rage_precision["
-0006f110: 6d69 6372 6f22 5d29 290d 0a0d 0a20 2020  micro"]))....   
-0006f120: 2020 2020 2066 6f72 2069 2c20 636f 6c6f       for i, colo
-0006f130: 7220 696e 207a 6970 2872 616e 6765 286e  r in zip(range(n
-0006f140: 5f63 6c61 7373 6573 292c 2063 6f6c 6f72  _classes), color
-0006f150: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
-0006f160: 206c 2c20 3d20 706c 742e 706c 6f74 2872   l, = plt.plot(r
-0006f170: 6563 616c 6c5b 695d 2c20 7072 6563 6973  ecall[i], precis
-0006f180: 696f 6e5b 695d 2c20 636f 6c6f 723d 636f  ion[i], color=co
-0006f190: 6c6f 722c 206c 773d 3129 0d0a 2020 2020  lor, lw=1)..    
-0006f1a0: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-0006f1b0: 7065 6e64 286c 290d 0a20 2020 2020 2020  pend(l)..       
-0006f1c0: 2020 2020 206c 6162 656c 732e 6170 7065       labels.appe
-0006f1d0: 6e64 2827 5072 6563 6973 696f 6e2d 7265  nd('Precision-re
-0006f1e0: 6361 6c6c 2066 6f72 2063 6c61 7373 207b  call for class {
-0006f1f0: 307d 2028 6172 6561 203d 207b 313a 302e  0} (area = {1:0.
-0006f200: 3266 7d29 270d 0a20 2020 2020 2020 2020  2f})'..         
-0006f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006f220: 2027 272e 666f 726d 6174 2869 2c20 6176   ''.format(i, av
-0006f230: 6572 6167 655f 7072 6563 6973 696f 6e5b  erage_precision[
-0006f240: 695d 2929 0d0a 0d0a 2020 2020 2020 2020  i]))....        
-0006f250: 6669 6720 3d20 706c 742e 6763 6628 290d  fig = plt.gcf().
-0006f260: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
-0006f270: 706c 6f74 735f 6164 6a75 7374 2862 6f74  plots_adjust(bot
-0006f280: 746f 6d3d 302e 3235 290d 0a20 2020 2020  tom=0.25)..     
-0006f290: 2020 2070 6c74 2e78 6c69 6d28 5b30 2e30     plt.xlim([0.0
-0006f2a0: 2c20 312e 305d 290d 0a20 2020 2020 2020  , 1.0])..       
-0006f2b0: 2070 6c74 2e79 6c69 6d28 5b30 2e30 2c20   plt.ylim([0.0, 
-0006f2c0: 312e 3035 5d29 0d0a 2020 2020 2020 2020  1.05])..        
-0006f2d0: 706c 742e 786c 6162 656c 2827 5265 6361  plt.xlabel('Reca
-0006f2e0: 6c6c 2729 0d0a 2020 2020 2020 2020 706c  ll')..        pl
-0006f2f0: 742e 796c 6162 656c 2827 5072 6563 6973  t.ylabel('Precis
-0006f300: 696f 6e27 290d 0a20 2020 2020 2020 2070  ion')..        p
-0006f310: 6c74 2e74 6974 6c65 2827 4d69 6372 6f20  lt.title('Micro 
-0006f320: 4176 6720 5072 6563 6973 696f 6e2d 5265  Avg Precision-Re
-0006f330: 6361 6c6c 2063 7572 7665 2077 6974 6820  call curve with 
-0006f340: 6973 6f2d 6631 2063 7572 7665 7327 290d  iso-f1 curves').
-0006f350: 0a20 2020 2020 2020 2070 6c74 2e6c 6567  .        plt.leg
-0006f360: 656e 6428 6c69 6e65 732c 206c 6162 656c  end(lines, label
-0006f370: 732c 206c 6f63 3d27 6c6f 7765 7220 6c65  s, loc='lower le
-0006f380: 6674 272c 2070 726f 703d 6469 6374 2873  ft', prop=dict(s
-0006f390: 697a 653d 3130 2929 0d0a 2020 2020 2020  ize=10))..      
-0006f3a0: 2020 706c 742e 7368 6f77 2829 3b0d 0a23    plt.show();..#
-0006f3b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f3c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f3d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f3e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f3f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f400: 2323 2323 230d 0a69 6d70 6f72 7420 6d61  #####..import ma
-0006f410: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-0006f420: 6173 2070 6c74 0d0a 696d 706f 7274 2073  as plt..import s
-0006f430: 6561 626f 726e 2061 7320 736e 730d 0a64  eaborn as sns..d
-0006f440: 6566 2064 7261 775f 636f 6e66 7573 696f  ef draw_confusio
-0006f450: 6e5f 6d61 7874 7269 7828 795f 7465 7374  n_maxtrix(y_test
-0006f460: 2c79 5f70 7265 642c 206d 6f64 656c 5f6e  ,y_pred, model_n
-0006f470: 616d 653d 274d 6f64 656c 272c 6178 3d27  ame='Model',ax='
-0006f480: 2729 3a0d 0a20 2020 2022 2222 0d0a 2020  '):..    """..  
-0006f490: 2020 5468 6973 2070 6c6f 7473 2061 2062    This plots a b
-0006f4a0: 6561 7574 6966 756c 2063 6f6e 6675 7369  eautiful confusi
-0006f4b0: 6f6e 206d 6174 7269 7820 6261 7365 6420  on matrix based 
-0006f4c0: 6f6e 2069 6e70 7574 3a20 6772 6f75 6e64  on input: ground
-0006f4d0: 2074 7275 7468 7320 616e 6420 7072 6564   truths and pred
-0006f4e0: 6963 7469 6f6e 730d 0a20 2020 2022 2222  ictions..    """
-0006f4f0: 0d0a 2020 2020 2343 6f6e 6675 7369 6f6e  ..    #Confusion
-0006f500: 204d 6174 7269 780d 0a20 2020 2027 2727   Matrix..    '''
-0006f510: 506c 6f74 7469 6e67 2043 4f4e 4655 5349  Plotting CONFUSI
-0006f520: 4f4e 204d 4154 5249 5827 2727 0d0a 2020  ON MATRIX'''..  
-0006f530: 2020 696d 706f 7274 2073 6561 626f 726e    import seaborn
-0006f540: 2061 7320 736e 730d 0a20 2020 2073 6e73   as sns..    sns
-0006f550: 2e73 6574 5f73 7479 6c65 2827 6461 726b  .set_style('dark
-0006f560: 6772 6964 2729 0d0a 0d0a 2020 2020 2727  grid')....    ''
-0006f570: 2744 6973 706c 6179 2727 270d 0a20 2020  'Display'''..   
-0006f580: 2066 726f 6d20 4950 7974 686f 6e2e 636f   from IPython.co
-0006f590: 7265 2e64 6973 706c 6179 2069 6d70 6f72  re.display impor
-0006f5a0: 7420 6469 7370 6c61 792c 2048 544d 4c0d  t display, HTML.
-0006f5b0: 0a20 2020 2064 6973 706c 6179 2848 544d  .    display(HTM
-0006f5c0: 4c28 223c 7374 796c 653e 2e63 6f6e 7461  L("<style>.conta
-0006f5d0: 696e 6572 207b 2077 6964 7468 3a39 3525  iner { width:95%
-0006f5e0: 2021 696d 706f 7274 616e 743b 207d 3c2f   !important; }</
-0006f5f0: 7374 796c 653e 2229 290d 0a20 2020 2070  style>"))..    p
-0006f600: 642e 6f70 7469 6f6e 732e 6469 7370 6c61  d.options.displa
-0006f610: 792e 666c 6f61 745f 666f 726d 6174 203d  y.float_format =
-0006f620: 2027 7b3a 2c2e 3266 7d27 2e66 6f72 6d61   '{:,.2f}'.forma
-0006f630: 740d 0a0d 0a20 2020 2023 4765 7420 7468  t....    #Get th
-0006f640: 6520 636f 6e66 7573 696f 6e20 6d61 7472  e confusion matr
-0006f650: 6978 2061 6e64 2070 7574 2069 7420 696e  ix and put it in
-0006f660: 746f 2061 2064 660d 0a20 2020 2066 726f  to a df..    fro
-0006f670: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-0006f680: 7320 696d 706f 7274 2063 6f6e 6675 7369  s import confusi
-0006f690: 6f6e 5f6d 6174 7269 782c 2066 315f 7363  on_matrix, f1_sc
-0006f6a0: 6f72 650d 0a0d 0a20 2020 2063 6d20 3d20  ore....    cm = 
-0006f6b0: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
-0006f6c0: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
-0006f6d0: 0d0a 0d0a 2020 2020 636d 5f64 6620 3d20  ....    cm_df = 
-0006f6e0: 7064 2e44 6174 6146 7261 6d65 2863 6d2c  pd.DataFrame(cm,
-0006f6f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006f700: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0006f710: 203d 206e 702e 756e 6971 7565 2879 5f74   = np.unique(y_t
-0006f720: 6573 7429 2e74 6f6c 6973 7428 292c 0d0a  est).tolist(),..
+0006ed70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006ed80: 2e2e 0d0a 0d0a 2020 2020 2020 2020 2320  ......        # 
+0006ed90: 466f 7220 6561 6368 2063 6c61 7373 0d0a  For each class..
+0006eda0: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
+0006edb0: 6e20 3d20 6469 6374 2829 0d0a 2020 2020  n = dict()..    
+0006edc0: 2020 2020 7265 6361 6c6c 203d 2064 6963      recall = dic
+0006edd0: 7428 290d 0a20 2020 2020 2020 2061 7665  t()..        ave
+0006ede0: 7261 6765 5f70 7265 6369 7369 6f6e 203d  rage_precision =
+0006edf0: 2064 6963 7428 290d 0a20 2020 2020 2020   dict()..       
+0006ee00: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0006ee10: 6e5f 636c 6173 7365 7329 3a0d 0a20 2020  n_classes):..   
+0006ee20: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
+0006ee30: 6f6e 5b69 5d2c 2072 6563 616c 6c5b 695d  on[i], recall[i]
+0006ee40: 2c20 5f20 3d20 7072 6563 6973 696f 6e5f  , _ = precision_
+0006ee50: 7265 6361 6c6c 5f63 7572 7665 2859 5f74  recall_curve(Y_t
+0006ee60: 6573 745b 3a2c 2069 5d2c 0d0a 2020 2020  est[:, i],..    
+0006ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006eea0: 2020 2020 2020 2020 2020 2020 795f 7363              y_sc
+0006eeb0: 6f72 655b 3a2c 2069 5d29 0d0a 2020 2020  ore[:, i])..    
+0006eec0: 2020 2020 2020 2020 6176 6572 6167 655f          average_
+0006eed0: 7072 6563 6973 696f 6e5b 695d 203d 2061  precision[i] = a
+0006eee0: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
+0006eef0: 5f73 636f 7265 2859 5f74 6573 745b 3a2c  _score(Y_test[:,
+0006ef00: 2069 5d2c 2079 5f73 636f 7265 5b3a 2c20   i], y_score[:, 
+0006ef10: 695d 290d 0a0d 0a20 2020 2020 2020 2023  i])....        #
+0006ef20: 2041 2022 6d69 6372 6f2d 6176 6572 6167   A "micro-averag
+0006ef30: 6522 3a20 7175 616e 7469 6679 696e 6720  e": quantifying 
+0006ef40: 7363 6f72 6520 6f6e 2061 6c6c 2063 6c61  score on all cla
+0006ef50: 7373 6573 206a 6f69 6e74 6c79 0d0a 2020  sses jointly..  
+0006ef60: 2020 2020 2020 7072 6563 6973 696f 6e5b        precision[
+0006ef70: 226d 6963 726f 225d 2c20 7265 6361 6c6c  "micro"], recall
+0006ef80: 5b22 6d69 6372 6f22 5d2c 205f 203d 2070  ["micro"], _ = p
+0006ef90: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
+0006efa0: 6375 7276 6528 595f 7465 7374 5b0d 0a20  curve(Y_test[.. 
+0006efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006efc0: 2020 2020 2020 203a 2c3a 6e5f 636c 6173         :,:n_clas
+0006efd0: 7365 735d 2e72 6176 656c 2829 2c79 5f73  ses].ravel(),y_s
+0006efe0: 636f 7265 5b3a 2c3a 6e5f 636c 6173 7365  core[:,:n_classe
+0006eff0: 735d 2e72 6176 656c 2829 290d 0a20 2020  s].ravel())..   
+0006f000: 2020 2020 2061 7665 7261 6765 5f70 7265       average_pre
+0006f010: 6369 7369 6f6e 5b22 6d69 6372 6f22 5d20  cision["micro"] 
+0006f020: 3d20 6176 6572 6167 655f 7072 6563 6973  = average_precis
+0006f030: 696f 6e5f 7363 6f72 6528 595f 7465 7374  ion_score(Y_test
+0006f040: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
+0006f050: 2020 2020 2020 2020 2020 203a 2c3a 6e5f             :,:n_
+0006f060: 636c 6173 7365 735d 2c20 795f 7363 6f72  classes], y_scor
+0006f070: 655b 3a2c 3a6e 5f63 6c61 7373 6573 5d2c  e[:,:n_classes],
+0006f080: 6176 6572 6167 653d 226d 6963 726f 2229  average="micro")
+0006f090: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006f0a0: 2741 7665 7261 6765 2070 7265 6369 7369  'Average precisi
+0006f0b0: 6f6e 2073 636f 7265 2c20 6d69 6372 6f2d  on score, micro-
+0006f0c0: 6176 6572 6167 6564 206f 7665 7220 616c  averaged over al
+0006f0d0: 6c20 636c 6173 7365 733a 207b 303a 302e  l classes: {0:0.
+0006f0e0: 3266 7d27 0d0a 2020 2020 2020 2020 2020  2f}'..          
+0006f0f0: 2020 2020 2e66 6f72 6d61 7428 6176 6572      .format(aver
+0006f100: 6167 655f 7072 6563 6973 696f 6e5b 226d  age_precision["m
+0006f110: 6963 726f 225d 2929 0d0a 0d0a 2020 2020  icro"]))....    
+0006f120: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+0006f130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f170: 2323 230d 0a20 2020 2020 2020 2023 2050  ###..        # P
+0006f180: 6c6f 7420 5072 6563 6973 696f 6e2d 5265  lot Precision-Re
+0006f190: 6361 6c6c 2063 7572 7665 2066 6f72 2065  call curve for e
+0006f1a0: 6163 6820 636c 6173 7320 616e 6420 6973  ach class and is
+0006f1b0: 6f2d 6631 2063 7572 7665 730d 0a20 2020  o-f1 curves..   
+0006f1c0: 2020 2020 2023 2050 6c6f 7420 7468 6520       # Plot the 
+0006f1d0: 6d69 6372 6f2d 6176 6572 6167 6564 2050  micro-averaged P
+0006f1e0: 7265 6369 7369 6f6e 2d52 6563 616c 6c20  recision-Recall 
+0006f1f0: 6375 7276 650d 0a20 2020 2020 2020 2023  curve..        #
+0006f200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f240: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006f250: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
+0006f260: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006f270: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006f280: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006f290: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
+0006f2a0: 2023 0d0a 2020 2020 2020 2020 2320 7365   #..        # se
+0006f2b0: 7475 7020 706c 6f74 2064 6574 6169 6c73  tup plot details
+0006f2c0: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
+0006f2d0: 203d 2063 7963 6c65 2827 6279 7263 6d67   = cycle('byrcmg
+0006f2e0: 6b62 7972 636d 676b 6279 7263 6d67 6b62  kbyrcmgkbyrcmgkb
+0006f2f0: 7972 636d 676b 2729 0d0a 0d0a 2020 2020  yrcmgk')....    
+0006f300: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+0006f310: 6967 7369 7a65 3d66 6967 7369 7a65 290d  igsize=figsize).
+0006f320: 0a20 2020 2020 2020 2066 5f73 636f 7265  .        f_score
+0006f330: 7320 3d20 6d75 6c74 695f 6631 2879 5f74  s = multi_f1(y_t
+0006f340: 6573 742c 636c 6173 7369 6669 6572 2e70  est,classifier.p
+0006f350: 7265 6469 6374 2858 5f74 6573 7429 290d  redict(X_test)).
+0006f360: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0006f370: 4d61 6372 6f20 4631 2073 636f 7265 2c20  Macro F1 score, 
+0006f380: 6176 6572 6167 6564 206f 7665 7220 616c  averaged over al
+0006f390: 6c20 636c 6173 7365 733a 207b 303a 302e  l classes: {0:0.
+0006f3a0: 3266 7d27 0d0a 2020 2020 2020 2020 2020  2f}'..          
+0006f3b0: 2020 2020 2e66 6f72 6d61 7428 665f 7363      .format(f_sc
+0006f3c0: 6f72 6573 2e6d 6561 6e28 2929 290d 0a20  ores.mean())).. 
+0006f3d0: 2020 2020 2020 206c 696e 6573 203d 205b         lines = [
+0006f3e0: 5d0d 0a20 2020 2020 2020 206c 6162 656c  ]..        label
+0006f3f0: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+0006f400: 666f 7220 665f 7363 6f72 6520 696e 2066  for f_score in f
+0006f410: 5f73 636f 7265 733a 0d0a 2020 2020 2020  _scores:..      
+0006f420: 2020 2020 2020 7820 3d20 6e70 2e6c 696e        x = np.lin
+0006f430: 7370 6163 6528 302e 3031 2c20 3129 0d0a  space(0.01, 1)..
+0006f440: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+0006f450: 665f 7363 6f72 6520 2a20 7820 2f20 2832  f_score * x / (2
+0006f460: 202a 2078 202d 2066 5f73 636f 7265 290d   * x - f_score).
+0006f470: 0a20 2020 2020 2020 2020 2020 206c 2c20  .            l, 
+0006f480: 3d20 706c 742e 706c 6f74 2878 5b79 203e  = plt.plot(x[y >
+0006f490: 3d20 305d 2c20 795b 7920 3e3d 2030 5d2c  = 0], y[y >= 0],
+0006f4a0: 2063 6f6c 6f72 3d27 6772 6179 272c 2061   color='gray', a
+0006f4b0: 6c70 6861 3d30 2e32 290d 0a20 2020 2020  lpha=0.2)..     
+0006f4c0: 2020 2020 2020 2070 6c74 2e61 6e6e 6f74         plt.annot
+0006f4d0: 6174 6528 2766 313d 7b30 3a30 2e32 667d  ate('f1={0:0.2f}
+0006f4e0: 272e 666f 726d 6174 2866 5f73 636f 7265  '.format(f_score
+0006f4f0: 292c 2078 793d 2830 2e39 2c20 795b 3435  ), xy=(0.9, y[45
+0006f500: 5d20 2b20 302e 3032 2929 0d0a 0d0a 2020  ] + 0.02))....  
+0006f510: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
+0006f520: 6e64 286c 290d 0a20 2020 2020 2020 206c  nd(l)..        l
+0006f530: 6162 656c 732e 6170 7065 6e64 2827 6973  abels.append('is
+0006f540: 6f2d 6631 2063 7572 7665 7327 290d 0a20  o-f1 curves').. 
+0006f550: 2020 2020 2020 206c 2c20 3d20 706c 742e         l, = plt.
+0006f560: 706c 6f74 2872 6563 616c 6c5b 226d 6963  plot(recall["mic
+0006f570: 726f 225d 2c20 7072 6563 6973 696f 6e5b  ro"], precision[
+0006f580: 226d 6963 726f 225d 2c20 636f 6c6f 723d  "micro"], color=
+0006f590: 2767 6f6c 6427 2c20 6c77 3d32 290d 0a20  'gold', lw=2).. 
+0006f5a0: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
+0006f5b0: 656e 6428 6c29 0d0a 2020 2020 2020 2020  end(l)..        
+0006f5c0: 6c61 6265 6c73 2e61 7070 656e 6428 276d  labels.append('m
+0006f5d0: 6963 726f 2d61 7665 7261 6765 2050 7265  icro-average Pre
+0006f5e0: 6369 7369 6f6e 2d72 6563 616c 6c20 2861  cision-recall (a
+0006f5f0: 7265 6120 3d20 7b30 3a30 2e32 667d 2927  rea = {0:0.2f})'
+0006f600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006f610: 2020 2020 2020 2020 2727 2e66 6f72 6d61          ''.forma
+0006f620: 7428 6176 6572 6167 655f 7072 6563 6973  t(average_precis
+0006f630: 696f 6e5b 226d 6963 726f 225d 2929 0d0a  ion["micro"]))..
+0006f640: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
+0006f650: 2063 6f6c 6f72 2069 6e20 7a69 7028 7261   color in zip(ra
+0006f660: 6e67 6528 6e5f 636c 6173 7365 7329 2c20  nge(n_classes), 
+0006f670: 636f 6c6f 7273 293a 0d0a 2020 2020 2020  colors):..      
+0006f680: 2020 2020 2020 6c2c 203d 2070 6c74 2e70        l, = plt.p
+0006f690: 6c6f 7428 7265 6361 6c6c 5b69 5d2c 2070  lot(recall[i], p
+0006f6a0: 7265 6369 7369 6f6e 5b69 5d2c 2063 6f6c  recision[i], col
+0006f6b0: 6f72 3d63 6f6c 6f72 2c20 6c77 3d31 290d  or=color, lw=1).
+0006f6c0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+0006f6d0: 6573 2e61 7070 656e 6428 6c29 0d0a 2020  es.append(l)..  
+0006f6e0: 2020 2020 2020 2020 2020 6c61 6265 6c73            labels
+0006f6f0: 2e61 7070 656e 6428 2750 7265 6369 7369  .append('Precisi
+0006f700: 6f6e 2d72 6563 616c 6c20 666f 7220 636c  on-recall for cl
+0006f710: 6173 7320 7b30 7d20 2861 7265 6120 3d20  ass {0} (area = 
+0006f720: 7b31 3a30 2e32 667d 2927 0d0a 2020 2020  {1:0.2f})'..    
 0006f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006f740: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-0006f750: 203d 206e 702e 756e 6971 7565 2879 5f74   = np.unique(y_t
-0006f760: 6573 7429 2e74 6f6c 6973 7428 292c 0d0a  est).tolist(),..
-0006f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006f780: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0006f790: 2073 6e73 2e68 6561 746d 6170 2863 6d5f   sns.heatmap(cm_
-0006f7a0: 6466 2c0d 0a20 2020 2020 2020 2020 2020  df,..           
-0006f7b0: 2020 2020 2063 656e 7465 723d 302c 0d0a       center=0,..
-0006f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006f7d0: 636d 6170 3d73 6e73 2e64 6976 6572 6769  cmap=sns.divergi
-0006f7e0: 6e67 5f70 616c 6574 7465 2832 3230 2c20  ng_palette(220, 
-0006f7f0: 3135 2c20 6173 5f63 6d61 703d 5472 7565  15, as_cmap=True
-0006f800: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0006f810: 2020 2020 616e 6e6f 743d 5472 7565 2c0d      annot=True,.
-0006f820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006f830: 2066 6d74 3d27 6727 2c0d 0a20 2020 2020   fmt='g',..     
-0006f840: 2020 2020 2020 2020 2020 6178 3d61 7829            ax=ax)
-0006f850: 0d0a 0d0a 2020 2020 6178 2e73 6574 5f74  ....    ax.set_t
-0006f860: 6974 6c65 2827 2025 7320 5c6e 4631 2053  itle(' %s \nF1 S
-0006f870: 636f 7265 2861 7667 203d 206d 6963 726f  core(avg = micro
-0006f880: 293a 2025 302e 3266 205c 6e46 3120 5363  ): %0.2f \nF1 Sc
-0006f890: 6f72 6528 6176 6720 3d20 6d61 6372 6f29  ore(avg = macro)
-0006f8a0: 3a20 2530 2e32 6627 2025 280d 0a20 2020  : %0.2f' %(..   
-0006f8b0: 2020 2020 206d 6f64 656c 5f6e 616d 652c       model_name,
-0006f8c0: 6631 5f73 636f 7265 2879 5f74 6573 742c  f1_score(y_test,
-0006f8d0: 2079 5f70 7265 642c 2061 7665 7261 6765   y_pred, average
-0006f8e0: 3d27 6d69 6372 6f27 292c 6631 5f73 636f  ='micro'),f1_sco
-0006f8f0: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
-0006f900: 642c 2061 7665 7261 6765 3d27 6d61 6372  d, average='macr
-0006f910: 6f27 2929 2c0d 0a20 2020 2020 2020 2020  o')),..         
-0006f920: 2020 2020 2066 6f6e 7473 697a 6520 3d20       fontsize = 
-0006f930: 3133 290d 0a20 2020 2061 782e 7365 745f  13)..    ax.set_
-0006f940: 796c 6162 656c 2827 5472 7565 206c 6162  ylabel('True lab
-0006f950: 656c 272c 2066 6f6e 7473 697a 6520 3d20  el', fontsize = 
-0006f960: 3133 290d 0a20 2020 2061 782e 7365 745f  13)..    ax.set_
-0006f970: 786c 6162 656c 2827 5072 6564 6963 7465  xlabel('Predicte
-0006f980: 6420 6c61 6265 6c27 2c20 666f 6e74 7369  d label', fontsi
-0006f990: 7a65 203d 2031 3329 0d0a 2323 2323 2323  ze = 13)..######
-0006f9a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f9f0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-0006fa00: 6574 7269 6373 2069 6d70 6f72 7420 636c  etrics import cl
-0006fa10: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0006fa20: 6f72 742c 2072 6f63 5f63 7572 7665 0d0a  ort, roc_curve..
-0006fa30: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
-0006fa40: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
-0006fa50: 0a69 6d70 6f72 7420 7365 6162 6f72 6e20  .import seaborn 
-0006fa60: 6173 2073 6e73 0d0a 0d0a 6672 6f6d 2073  as sns....from s
-0006fa70: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
-0006fa80: 6d70 6f72 7420 726f 635f 6375 7276 652c  mport roc_curve,
-0006fa90: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
-0006faa0: 6c5f 6375 7276 650d 0a0d 0a64 6566 2070  l_curve....def p
-0006fab0: 6c6f 745f 7072 6563 6973 696f 6e5f 7265  lot_precision_re
-0006fac0: 6361 6c6c 5f63 7572 7665 286d 2c20 785f  call_curve(m, x_
-0006fad0: 7465 7374 632c 2079 5f74 6573 742c 2061  testc, y_test, a
-0006fae0: 783d 4e6f 6e65 293a 0d0a 2020 2020 2323  x=None):..    ##
-0006faf0: 2323 2054 6869 7320 6973 2061 2073 696d  ## This is a sim
-0006fb00: 706c 6520 7761 7920 746f 2070 6c6f 7420  ple way to plot 
-0006fb10: 5052 2063 7572 7665 2066 6f72 2062 696e  PR curve for bin
-0006fb20: 6172 7920 636c 6173 7365 7320 2323 2323  ary classes ####
-0006fb30: 230d 0a20 2020 2079 5f73 636f 7265 7320  #..    y_scores 
-0006fb40: 3d20 6d2e 7072 6564 6963 745f 7072 6f62  = m.predict_prob
-0006fb50: 6128 785f 7465 7374 6329 5b3a 2c31 5d0d  a(x_testc)[:,1].
-0006fb60: 0a20 2020 2023 2323 2067 656e 6572 6174  .    ### generat
-0006fb70: 6520 7468 6520 7072 6563 6973 696f 6e20  e the precision 
-0006fb80: 7265 6361 6c6c 2063 7572 7665 2023 2323  recall curve ###
-0006fb90: 2323 2323 2323 230d 0a20 2020 2070 2c20  #######..    p, 
-0006fba0: 722c 2074 6872 6573 686f 6c64 7320 3d20  r, thresholds = 
-0006fbb0: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
-0006fbc0: 5f63 7572 7665 2879 5f74 6573 742c 2079  _curve(y_test, y
-0006fbd0: 5f73 636f 7265 7329 0d0a 2020 2020 2323  _scores)..    ##
-0006fbe0: 2323 2070 6c6f 7420 7468 6520 6375 7276  ## plot the curv
-0006fbf0: 6520 2323 2323 2323 2323 2323 0d0a 2020  e ##########..  
-0006fc00: 2020 6178 2e73 6574 5f74 6974 6c65 2822    ax.set_title("
-0006fc10: 5072 6563 6973 696f 6e20 5265 6361 6c6c  Precision Recall
-0006fc20: 2043 7572 7665 2229 0d0a 2020 2020 6178   Curve")..    ax
-0006fc30: 2e70 6c6f 7428 722c 2070 2c20 636f 6c6f  .plot(r, p, colo
-0006fc40: 723d 2270 7572 706c 6522 290d 0a20 2020  r="purple")..   
-0006fc50: 2061 782e 7365 745f 796c 696d 285b 302e   ax.set_ylim([0.
-0006fc60: 352c 2031 2e30 315d 290d 0a20 2020 2061  5, 1.01])..    a
-0006fc70: 782e 7365 745f 786c 696d 285b 302e 352c  x.set_xlim([0.5,
-0006fc80: 2031 2e30 315d 290d 0a20 2020 2061 782e   1.01])..    ax.
-0006fc90: 7365 745f 786c 6162 656c 2827 5265 6361  set_xlabel('Reca
-0006fca0: 6c6c 2729 0d0a 2020 2020 6178 2e73 6574  ll')..    ax.set
-0006fcb0: 5f79 6c61 6265 6c28 2750 7265 6369 7369  _ylabel('Precisi
-0006fcc0: 6f6e 2729 0d0a 0d0a 6465 6620 706c 6f74  on')....def plot
-0006fcd0: 5f72 6f63 5f63 7572 7665 286d 2c20 785f  _roc_curve(m, x_
-0006fce0: 7465 7374 632c 2079 5f74 6573 742c 2061  testc, y_test, a
-0006fcf0: 783d 4e6f 6e65 293a 0d0a 2020 2020 2323  x=None):..    ##
-0006fd00: 2323 2054 6869 7320 6973 2061 2073 696d  ## This is a sim
-0006fd10: 706c 6520 7761 7920 746f 2070 6c6f 7420  ple way to plot 
-0006fd20: 524f 4320 6375 7276 6520 666f 7220 6269  ROC curve for bi
-0006fd30: 6e61 7279 2063 6c61 7373 6573 2023 2323  nary classes ###
-0006fd40: 2323 0d0a 2020 2020 795f 7363 6f72 6573  ##..    y_scores
-0006fd50: 203d 206d 2e70 7265 6469 6374 5f70 726f   = m.predict_pro
-0006fd60: 6261 2878 5f74 6573 7463 295b 3a2c 315d  ba(x_testc)[:,1]
-0006fd70: 0d0a 2020 2020 2323 2320 6765 6e65 7261  ..    ### genera
-0006fd80: 7465 2074 6865 2070 7265 6369 7369 6f6e  te the precision
-0006fd90: 2072 6563 616c 6c20 6375 7276 6520 2323   recall curve ##
-0006fda0: 2323 2323 2323 2323 0d0a 2020 2020 6670  ########..    fp
-0006fdb0: 722c 2074 7072 2c20 5f20 3d20 726f 635f  r, tpr, _ = roc_
-0006fdc0: 6375 7276 6528 795f 7465 7374 2c20 2079  curve(y_test,  y
-0006fdd0: 5f73 636f 7265 7329 0d0a 2020 2020 2323  _scores)..    ##
-0006fde0: 2323 2070 6c6f 7420 7468 6520 6375 7276  ## plot the curv
-0006fdf0: 6520 2323 2323 2323 2323 2323 0d0a 2020  e ##########..  
-0006fe00: 2020 6178 2e73 6574 5f74 6974 6c65 2822    ax.set_title("
-0006fe10: 524f 4320 4155 4320 4375 7276 6522 290d  ROC AUC Curve").
-0006fe20: 0a20 2020 2061 782e 706c 6f74 2866 7072  .    ax.plot(fpr
-0006fe30: 2c74 7072 2c20 636f 6c6f 723d 2270 7572  ,tpr, color="pur
-0006fe40: 706c 6522 290d 0a20 2020 2061 782e 7365  ple")..    ax.se
-0006fe50: 745f 796c 696d 285b 302e 302c 2031 2e30  t_ylim([0.0, 1.0
-0006fe60: 315d 290d 0a20 2020 2061 782e 7365 745f  1])..    ax.set_
-0006fe70: 786c 696d 285b 302e 302c 2031 2e30 315d  xlim([0.0, 1.01]
-0006fe80: 290d 0a20 2020 2061 782e 7365 745f 786c  )..    ax.set_xl
-0006fe90: 6162 656c 2827 4661 6c73 6520 506f 7369  abel('False Posi
-0006fea0: 7469 7665 2052 6174 6527 290d 0a20 2020  tive Rate')..   
-0006feb0: 2061 782e 7365 745f 796c 6162 656c 2827   ax.set_ylabel('
-0006fec0: 5472 7565 2050 6f73 6974 6976 6520 5261  True Positive Ra
-0006fed0: 7465 2729 0d0a 0d0a 0d0a 6465 6620 706c  te')......def pl
-0006fee0: 6f74 5f63 6c61 7373 6966 6963 6174 696f  ot_classificatio
-0006fef0: 6e5f 7265 7375 6c74 7328 6d2c 2058 5f74  n_results(m, X_t
-0006ff00: 7275 652c 2079 5f74 7275 652c 2079 5f70  rue, y_true, y_p
-0006ff10: 7265 642c 206c 6162 656c 732c 2074 6172  red, labels, tar
-0006ff20: 6765 745f 6e61 6d65 732c 2065 6163 685f  get_names, each_
-0006ff30: 7461 7267 6574 293a 0d0a 2020 2020 2323  target):..    ##
-0006ff40: 2323 2054 6865 7365 2070 6c6f 7473 2061  ## These plots a
-0006ff50: 7265 206f 6e6c 7920 666f 7220 6269 6e61  re only for bina
-0006ff60: 7279 2063 6c61 7373 6573 2023 2323 2323  ry classes #####
-0006ff70: 2323 2323 2323 2323 0d0a 2020 2020 7472  ########..    tr
-0006ff80: 793a 0d0a 2020 2020 2020 2020 6669 672c  y:..        fig,
-0006ff90: 2061 7865 7320 3d20 706c 742e 7375 6270   axes = plt.subp
-0006ffa0: 6c6f 7473 2832 2c32 2c66 6967 7369 7a65  lots(2,2,figsize
-0006ffb0: 3d28 3135 2c31 3529 290d 0a20 2020 2020  =(15,15))..     
-0006ffc0: 2020 2070 6c6f 745f 726f 635f 6375 7276     plot_roc_curv
-0006ffd0: 6528 6d2c 2058 5f74 7275 652c 2079 5f74  e(m, X_true, y_t
-0006ffe0: 7275 652c 2061 783d 6178 6573 5b30 2c31  rue, ax=axes[0,1
-0006fff0: 5d29 0d0a 2020 2020 2020 2020 6178 6573  ])..        axes
-00070000: 5b30 2c31 5d2e 7365 745f 7469 746c 6528  [0,1].set_title(
-00070010: 2752 4f43 2041 5543 2043 7572 7665 3a20  'ROC AUC Curve: 
-00070020: 2573 2720 2565 6163 685f 7461 7267 6574  %s' %each_target
-00070030: 290d 0a20 2020 2020 2020 2070 6c6f 745f  )..        plot_
-00070040: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
-00070050: 5f63 7572 7665 286d 2c20 585f 7472 7565  _curve(m, X_true
-00070060: 2c20 795f 7472 7565 2c20 6178 3d61 7865  , y_true, ax=axe
-00070070: 735b 312c 305d 290d 0a20 2020 2020 2020  s[1,0])..       
-00070080: 2061 7865 735b 312c 305d 2e73 6574 5f74   axes[1,0].set_t
-00070090: 6974 6c65 2827 5052 2041 5543 2043 7572  itle('PR AUC Cur
-000700a0: 7665 2066 6f72 3a20 2573 2720 2565 6163  ve for: %s' %eac
-000700b0: 685f 7461 7267 6574 290d 0a20 2020 2020  h_target)..     
-000700c0: 2020 2079 5f70 7265 6420 3d20 6d2e 7072     y_pred = m.pr
-000700d0: 6564 6963 7428 585f 7472 7565 290d 0a20  edict(X_true).. 
-000700e0: 2020 2020 2020 2064 7261 775f 636f 6e66         draw_conf
-000700f0: 7573 696f 6e5f 6d61 7874 7269 7828 795f  usion_maxtrix(y_
-00070100: 7472 7565 2c20 795f 7072 6564 2c20 2743  true, y_pred, 'C
-00070110: 6f6e 6675 7369 6f6e 204d 6174 7269 7827  onfusion Matrix'
-00070120: 2c20 6178 3d61 7865 735b 302c 305d 290d  , ax=axes[0,0]).
-00070130: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
-00070140: 2020 2020 2020 2020 2020 2063 6c66 5f72             clf_r
-00070150: 6570 6f72 7420 3d20 636c 6173 7369 6669  eport = classifi
-00070160: 6361 7469 6f6e 5f72 6570 6f72 7428 795f  cation_report(y_
-00070170: 7472 7565 2c0d 0a20 2020 2020 2020 2020  true,..         
-00070180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000701a0: 2020 2020 2020 795f 7072 6564 2c0d 0a20        y_pred,.. 
-000701b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000701c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000701d0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-000701e0: 6265 6c73 3d6c 6162 656c 732c 0d0a 2020  bels=labels,..  
-000701f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070210: 2020 2020 2020 2020 2020 2020 2074 6172               tar
-00070220: 6765 745f 6e61 6d65 733d 7461 7267 6574  get_names=target
-00070230: 5f6e 616d 6573 2c0d 0a20 2020 2020 2020  _names,..       
-00070240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070260: 2020 2020 2020 2020 6f75 7470 7574 5f64          output_d
-00070270: 6963 743d 5472 7565 290d 0a20 2020 2020  ict=True)..     
-00070280: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00070290: 2020 2020 2020 2020 636c 665f 7265 706f          clf_repo
-000702a0: 7274 203d 2063 6c61 7373 6966 6963 6174  rt = classificat
-000702b0: 696f 6e5f 7265 706f 7274 2879 5f74 7275  ion_report(y_tru
-000702c0: 652c 795f 7072 6564 2c6c 6162 656c 733d  e,y_pred,labels=
-000702d0: 7461 7267 6574 5f6e 616d 6573 2c0d 0a20  target_names,.. 
-000702e0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000702f0: 6172 6765 745f 6e61 6d65 733d 6c61 6265  arget_names=labe
-00070300: 6c73 2c6f 7574 7075 745f 6469 6374 3d54  ls,output_dict=T
-00070310: 7275 6529 0d0a 2020 2020 2020 2020 736e  rue)..        sn
-00070320: 732e 6865 6174 6d61 7028 7064 2e44 6174  s.heatmap(pd.Dat
-00070330: 6146 7261 6d65 2863 6c66 5f72 6570 6f72  aFrame(clf_repor
-00070340: 7429 2e69 6c6f 635b 3a2c 203a 5d2e 542c  t).iloc[:, :].T,
-00070350: 2061 6e6e 6f74 3d54 7275 652c 6178 3d61   annot=True,ax=a
-00070360: 7865 735b 312c 315d 2c66 6d74 3d27 302e  xes[1,1],fmt='0.
-00070370: 3266 2729 3b0d 0a20 2020 2020 2020 2061  2f');..        a
-00070380: 7865 735b 312c 315d 2e73 6574 5f74 6974  xes[1,1].set_tit
-00070390: 6c65 2827 436c 6173 7369 6669 6361 7469  le('Classificati
-000703a0: 6f6e 2052 6570 6f72 743a 2025 7327 2025  on Report: %s' %
-000703b0: 6561 6368 5f74 6172 6765 7429 0d0a 2020  each_target)..  
-000703c0: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-000703d0: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
-000703e0: 2063 6f75 6c64 206e 6f74 2070 6c6f 7420   could not plot 
-000703f0: 636c 6173 7369 6669 6361 7469 6f6e 2072  classification r
-00070400: 6573 756c 7473 2e20 436f 6e74 696e 7569  esults. Continui
-00070410: 6e67 2e2e 2e27 290d 0a0d 0a66 726f 6d20  ng...')....from 
-00070420: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
-00070430: 696d 706f 7274 2063 6c61 7373 6966 6963  import classific
-00070440: 6174 696f 6e5f 7265 706f 7274 2c20 636f  ation_report, co
-00070450: 6e66 7573 696f 6e5f 6d61 7472 6978 0d0a  nfusion_matrix..
-00070460: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6574  from sklearn.met
-00070470: 7269 6373 2069 6d70 6f72 7420 6261 6c61  rics import bala
-00070480: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
-00070490: 6f72 650d 0a64 6566 2070 7269 6e74 5f63  ore..def print_c
-000704a0: 6c61 7373 6966 6963 6174 696f 6e5f 6d6f  lassification_mo
-000704b0: 6465 6c5f 7374 6174 7328 795f 7472 7565  del_stats(y_true
-000704c0: 2c20 7072 6564 6963 7465 642c 206d 5f74  , predicted, m_t
-000704d0: 6872 6573 683d 302e 3529 3a0d 0a20 2020  hresh=0.5):..   
-000704e0: 2022 2222 0d0a 2020 2020 5468 6973 2070   """..    This p
-000704f0: 7269 6e74 7320 636c 6173 7369 6669 6361  rints classifica
-00070500: 7469 6f6e 206d 6574 7269 6373 2069 6e20  tion metrics in 
-00070510: 6120 6e69 6365 2066 6f72 6d61 7420 6f6e  a nice format on
-00070520: 6c79 2066 6f72 2062 696e 6172 7920 636c  ly for binary cl
-00070530: 6173 7365 730d 0a20 2020 2022 2222 0d0a  asses..    """..
-00070540: 2020 2020 2320 5573 6520 7468 6973 2074      # Use this t
-00070550: 6f20 5465 7374 2043 6c61 7373 6966 6963  o Test Classific
-00070560: 6174 696f 6e20 5072 6f62 6c65 6d73 204f  ation Problems O
-00070570: 6e6c 7920 2323 2323 0d0a 2020 2020 7472  nly ####..    tr
-00070580: 793a 0d0a 2020 2020 2020 2020 7261 7265  y:..        rare
-00070590: 5f63 6c61 7373 203d 2066 696e 645f 7261  _class = find_ra
-000705a0: 7265 5f63 6c61 7373 2879 5f74 7275 6529  re_class(y_true)
-000705b0: 0d0a 2020 2020 2020 2020 7265 675f 6163  ..        reg_ac
-000705c0: 6320 3d20 5b30 2c30 5d0d 0a20 2020 2020  c = [0,0]..     
-000705d0: 2020 2066 6f72 2069 2c74 6872 6573 686f     for i,thresho
-000705e0: 6c64 2069 6e20 7a69 7028 7261 6e67 6528  ld in zip(range(
-000705f0: 3229 2c20 5b30 2e35 2c20 6d5f 7468 7265  2), [0.5, m_thre
-00070600: 7368 5d29 3a0d 0a20 2020 2020 2020 2020  sh]):..         
-00070610: 2020 2069 6620 7468 7265 7368 6f6c 6420     if threshold 
-00070620: 213d 2030 2e35 3a0d 0a20 2020 2020 2020  != 0.5:..       
-00070630: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-00070640: 6564 205b 3a2c 305d 203d 2028 7072 6564  ed [:,0] = (pred
-00070650: 6963 7465 6420 5b3a 2c30 5d20 3e3d 2028  icted [:,0] >= (
-00070660: 312d 7468 7265 7368 6f6c 6429 292e 6173  1-threshold)).as
-00070670: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
-00070680: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-00070690: 6469 6374 6564 205b 3a2c 315d 203d 2028  dicted [:,1] = (
-000706a0: 7072 6564 6963 7465 6420 5b3a 2c31 5d20  predicted [:,1] 
-000706b0: 3e3d 2074 6872 6573 686f 6c64 292e 6173  >= threshold).as
-000706c0: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
-000706d0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
-000706e0: 7265 6420 3d20 7072 6564 6963 7465 645b  red = predicted[
-000706f0: 3a2c 7261 7265 5f63 6c61 7373 5d0d 0a20  :,rare_class].. 
-00070700: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00070710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00070720: 2020 795f 7072 6564 203d 2070 7265 6469    y_pred = predi
-00070730: 6374 6564 2e61 7267 6d61 7828 6178 6973  cted.argmax(axis
-00070740: 3d31 290d 0a20 2020 2020 2020 2020 2020  =1)..           
-00070750: 2070 7269 6e74 2827 4261 6c61 6e63 6564   print('Balanced
-00070760: 2041 6363 7572 6163 7920 3d20 2530 2e32   Accuracy = %0.2
-00070770: 6625 2520 7769 7468 2054 6872 6573 686f  f%% with Thresho
-00070780: 6c64 203d 2025 302e 3266 2720 2528 0d0a  ld = %0.2f' %(..
-00070790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000707a0: 3130 302a 6261 6c61 6e63 6564 5f61 6363  100*balanced_acc
-000707b0: 7572 6163 795f 7363 6f72 6528 795f 7472  uracy_score(y_tr
-000707c0: 7565 2c20 795f 7072 6564 292c 7468 7265  ue, y_pred),thre
-000707d0: 7368 6f6c 6429 290d 0a20 2020 2020 2020  shold))..       
-000707e0: 2020 2020 2070 7269 6e74 2827 436f 6e66       print('Conf
-000707f0: 7573 696f 6e20 4d61 7472 6978 3a27 290d  usion Matrix:').
-00070800: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00070810: 6e74 2863 6f6e 6675 7369 6f6e 5f6d 6174  nt(confusion_mat
-00070820: 7269 7828 795f 7472 7565 2c20 795f 7072  rix(y_true, y_pr
-00070830: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
-00070840: 2020 7072 696e 7428 636c 6173 7369 6669    print(classifi
-00070850: 6361 7469 6f6e 5f72 6570 6f72 7428 795f  cation_report(y_
-00070860: 7472 7565 2c20 795f 7072 6564 2929 0d0a  true, y_pred))..
-00070870: 2020 2020 2020 2020 2020 2020 7265 675f              reg_
-00070880: 6163 635b 695d 203d 2062 616c 616e 6365  acc[i] = balance
-00070890: 645f 6163 6375 7261 6379 5f73 636f 7265  d_accuracy_score
-000708a0: 2879 5f74 7275 652c 2079 5f70 7265 6429  (y_true, y_pred)
-000708b0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000708c0: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
-000708d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000708e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000708f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070900: 2323 2323 2323 2729 0d0a 2020 2020 2020  ######')..      
-00070910: 2020 6966 2020 7265 675f 6163 635b 305d    if  reg_acc[0]
-00070920: 203e 3d20 7265 675f 6163 635b 315d 203a   >= reg_acc[1] :
-00070930: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00070940: 696e 7428 2752 6567 756c 6172 2074 6872  int('Regular thr
-00070950: 6573 686f 6c64 203d 2025 302e 3266 2069  eshold = %0.2f i
-00070960: 7320 6265 7474 6572 2720 2530 2e35 290d  s better' %0.5).
-00070970: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00070980: 7572 6e20 7265 675f 6163 635b 305d 0d0a  urn reg_acc[0]..
-00070990: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000709a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000709b0: 2827 4d6f 6469 6669 6564 2074 6872 6573  ('Modified thres
-000709c0: 686f 6c64 203d 2025 302e 3266 2069 7320  hold = %0.2f is 
-000709d0: 6265 7474 6572 2720 256d 5f74 6872 6573  better' %m_thres
-000709e0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-000709f0: 7265 7475 726e 2072 6567 5f61 6363 5b31  return reg_acc[1
-00070a00: 5d0d 0a20 2020 2065 7863 6570 743a 0d0a  ]..    except:..
-00070a10: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
-00070a20: 7272 6f72 3a20 7072 696e 7469 6e67 2063  rror: printing c
-00070a30: 6c61 7373 6966 6963 6174 696f 6e20 6d6f  lassification mo
-00070a40: 6465 6c20 6d65 7472 6963 732e 2043 6f6e  del metrics. Con
-00070a50: 7469 6e75 696e 672e 2e2e 2729 0d0a 2020  tinuing...')..  
-00070a60: 2020 2020 2020 7265 7475 726e 2030 0d0a        return 0..
-00070a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070aa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070ab0: 2323 2323 230d 0a23 2323 2323 2020 2020  #####..#####    
-00070ac0: 2052 4547 5245 5353 494f 4e20 4348 4152   REGRESSION CHAR
-00070ad0: 5453 2041 4e44 204d 4554 5249 4353 2041  TS AND METRICS A
-00070ae0: 5245 2050 5249 4e54 4544 2050 4c4f 5454  RE PRINTED PLOTT
-00070af0: 4544 2048 4552 450d 0a23 2323 2323 2323  ED HERE..#######
-00070b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070b30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00070b40: 696d 706f 7274 2074 696d 650d 0a64 6566  import time..def
-00070b50: 2070 6c6f 745f 7265 6772 6573 7369 6f6e   plot_regression
-00070b60: 5f73 6361 7474 6572 7328 6466 2c20 6466  _scatters(df, df
-00070b70: 322c 206e 756d 5f76 6172 732c 206b 696e  2, num_vars, kin
-00070b80: 643d 2773 6361 7474 6572 272c 2070 6c6f  d='scatter', plo
-00070b90: 745f 6e61 6d65 3d27 2729 3a0d 0a20 2020  t_name=''):..   
-00070ba0: 2022 2222 0d0a 2020 2020 4772 6561 7420   """..    Great 
-00070bb0: 7761 7920 746f 2070 6c6f 7420 636f 6e74  way to plot cont
-00070bc0: 696e 756f 7573 2076 6172 6961 626c 6573  inuous variables
-00070bd0: 2066 6173 742e 204a 7573 7420 7365 6e74   fast. Just sent
-00070be0: 2074 6865 6d20 696e 2061 6e64 2069 7420   them in and it 
-00070bf0: 7769 6c6c 2074 616b 6520 6361 7265 206f  will take care o
-00070c00: 6620 7468 6520 7265 7374 210d 0a20 2020  f the rest!..   
-00070c10: 2022 2222 0d0a 2020 2020 6669 6773 697a   """..    figsiz
-00070c20: 6520 3d20 2831 302c 2031 3029 0d0a 2020  e = (10, 10)..  
-00070c30: 2020 636f 6c6f 7273 203d 2063 7963 6c65    colors = cycle
-00070c40: 2827 6279 7263 6d67 6b62 7972 636d 676b  ('byrcmgkbyrcmgk
-00070c50: 6279 7263 6d67 6b62 7972 636d 676b 2729  byrcmgkbyrcmgk')
-00070c60: 0d0a 2020 2020 6e75 6d5f 7661 7273 5f6c  ..    num_vars_l
-00070c70: 656e 203d 206c 656e 286e 756d 5f76 6172  en = len(num_var
-00070c80: 7329 0d0a 2020 2020 636f 6c20 3d20 320d  s)..    col = 2.
-00070c90: 0a20 2020 2073 7461 7274 5f74 696d 6520  .    start_time 
-00070ca0: 3d20 7469 6d65 2e74 696d 6528 290d 0a20  = time.time().. 
-00070cb0: 2020 2072 6f77 203d 206c 656e 286e 756d     row = len(num
-00070cc0: 5f76 6172 7329 0d0a 2020 2020 6669 672c  _vars)..    fig,
-00070cd0: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-00070ce0: 7473 2872 6f77 2c20 636f 6c29 0d0a 2020  ts(row, col)..  
-00070cf0: 2020 6966 2063 6f6c 203c 2032 3a0d 0a20    if col < 2:.. 
-00070d00: 2020 2020 2020 2066 6967 2e73 6574 5f73         fig.set_s
-00070d10: 697a 655f 696e 6368 6573 286d 696e 2831  ize_inches(min(1
-00070d20: 352c 3829 2c72 6f77 2a35 290d 0a20 2020  5,8),row*5)..   
-00070d30: 2020 2020 2066 6967 2e73 7562 706c 6f74       fig.subplot
-00070d40: 735f 6164 6a75 7374 2868 7370 6163 653d  s_adjust(hspace=
-00070d50: 302e 3529 2023 2323 2054 6869 7320 636f  0.5) ### This co
-00070d60: 6e74 726f 6c73 2074 6865 2073 7061 6365  ntrols the space
-00070d70: 2062 6574 7765 6e20 726f 7773 0d0a 2020   betwen rows..  
-00070d80: 2020 2020 2020 6669 672e 7375 6270 6c6f        fig.subplo
-00070d90: 7473 5f61 646a 7573 7428 7773 7061 6365  ts_adjust(wspace
-00070da0: 3d30 2e33 2920 2323 2320 5468 6973 2063  =0.3) ### This c
-00070db0: 6f6e 7472 6f6c 7320 7468 6520 7370 6163  ontrols the spac
-00070dc0: 6520 6265 7477 6565 6e20 636f 6c75 6d6e  e between column
-00070dd0: 730d 0a20 2020 2065 6c73 653a 0d0a 2020  s..    else:..  
-00070de0: 2020 2020 2020 6669 672e 7365 745f 7369        fig.set_si
-00070df0: 7a65 5f69 6e63 6865 7328 6d69 6e28 636f  ze_inches(min(co
-00070e00: 6c2a 3130 2c32 3029 2c72 6f77 2a35 290d  l*10,20),row*5).
-00070e10: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
-00070e20: 706c 6f74 735f 6164 6a75 7374 2868 7370  plots_adjust(hsp
-00070e30: 6163 653d 302e 3329 2023 2323 2054 6869  ace=0.3) ### Thi
-00070e40: 7320 636f 6e74 726f 6c73 2074 6865 2073  s controls the s
-00070e50: 7061 6365 2062 6574 7765 6e20 726f 7773  pace betwen rows
-00070e60: 0d0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
-00070e70: 6270 6c6f 7473 5f61 646a 7573 7428 7773  bplots_adjust(ws
-00070e80: 7061 6365 3d30 2e33 2920 2323 2320 5468  pace=0.3) ### Th
-00070e90: 6973 2063 6f6e 7472 6f6c 7320 7468 6520  is controls the 
-00070ea0: 7370 6163 6520 6265 7477 6565 6e20 636f  space between co
-00070eb0: 6c75 6d6e 730d 0a20 2020 2066 6967 2e73  lumns..    fig.s
-00070ec0: 7570 7469 746c 6528 2752 6567 7265 7373  uptitle('Regress
-00070ed0: 696f 6e20 4d65 7472 6963 7320 506c 6f74  ion Metrics Plot
-00070ee0: 7320 666f 7220 2573 204d 6f64 656c 2720  s for %s Model' 
-00070ef0: 2570 6c6f 745f 6e61 6d65 2c20 666f 6e74  %plot_name, font
-00070f00: 7369 7a65 3d32 3029 0d0a 2020 2020 636f  size=20)..    co
-00070f10: 756e 7465 7220 3d20 300d 0a20 2020 2069  unter = 0..    i
-00070f20: 6620 726f 7720 3d3d 2031 3a0d 0a20 2020  f row == 1:..   
-00070f30: 2020 2020 2061 7820 3d20 6178 2e72 6573       ax = ax.res
-00070f40: 6861 7065 282d 312c 3129 2e54 0d0a 2020  hape(-1,1).T..  
-00070f50: 2020 666f 7220 6b20 696e 206e 702e 6172    for k in np.ar
-00070f60: 616e 6765 2872 6f77 293a 0d0a 2020 2020  ange(row):..    
-00070f70: 2020 2020 726f 775f 636f 6c6f 7220 3d20      row_color = 
-00070f80: 6e65 7874 2863 6f6c 6f72 7329 0d0a 2020  next(colors)..  
-00070f90: 2020 2020 2020 666f 7220 6c20 696e 206e        for l in n
-00070fa0: 702e 6172 616e 6765 2863 6f6c 293a 0d0a  p.arange(col):..
-00070fb0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00070fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00070fd0: 2020 6966 2063 6f6c 3d3d 313a 0d0a 2020    if col==1:..  
-00070fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070ff0: 2020 6966 2072 6f77 203d 3d20 313a 0d0a    if row == 1:..
-00071000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071010: 2020 2020 2020 2020 7820 3d20 6466 5b3a          x = df[:
-00071020: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00071030: 2020 2020 2020 2020 2020 2079 203d 2064             y = d
-00071040: 6632 5b3a 5d0d 0a20 2020 2020 2020 2020  f2[:]..         
-00071050: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00071060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00071070: 2020 2020 2020 2020 2020 7820 3d20 6466            x = df
-00071080: 5b3a 2c6b 5d0d 0a20 2020 2020 2020 2020  [:,k]..         
-00071090: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000710a0: 203d 2064 6632 5b3a 2c6b 5d0d 0a20 2020   = df2[:,k]..   
-000710b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000710c0: 2061 7831 203d 2061 785b 6b5d 5b6c 5d0d   ax1 = ax[k][l].
-000710d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000710e0: 2020 2020 206c 696e 6553 7461 7274 203d       lineStart =
-000710f0: 2078 2e6d 696e 2829 0d0a 2020 2020 2020   x.min()..      
-00071100: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00071110: 6e65 456e 6420 3d20 782e 6d61 7828 290d  neEnd = x.max().
-00071120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00071130: 2020 2020 2061 7831 2e73 6361 7474 6572       ax1.scatter
-00071140: 2878 2c20 792c 2063 6f6c 6f72 3d72 6f77  (x, y, color=row
-00071150: 5f63 6f6c 6f72 290d 0a20 2020 2020 2020  _color)..       
-00071160: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
-00071170: 2e70 6c6f 7428 5b6c 696e 6553 7461 7274  .plot([lineStart
-00071180: 2c20 6c69 6e65 456e 645d 2c20 5b6c 696e  , lineEnd], [lin
-00071190: 6553 7461 7274 2c20 6c69 6e65 456e 645d  eStart, lineEnd]
-000711a0: 2c20 276b 2d27 2c20 636f 6c6f 723d 726f  , 'k-', color=ro
-000711b0: 775f 636f 6c6f 7229 0d0a 2020 2020 2020  w_color)..      
-000711c0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000711d0: 312e 7365 745f 786c 6162 656c 2827 4163  1.set_xlabel('Ac
-000711e0: 7475 616c 7327 290d 0a20 2020 2020 2020  tuals')..       
-000711f0: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
-00071200: 2e73 6574 5f79 6c61 6265 6c28 2750 7265  .set_ylabel('Pre
-00071210: 6469 6374 6564 2729 0d0a 2020 2020 2020  dicted')..      
-00071220: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00071230: 312e 7365 745f 7469 746c 6528 2750 7265  1.set_title('Pre
-00071240: 6469 6374 6564 2076 7320 4163 7475 616c  dicted vs Actual
-00071250: 7320 506c 6f74 2066 6f72 2054 6172 6765  s Plot for Targe
-00071260: 7420 3d20 2573 2720 256e 756d 5f76 6172  t = %s' %num_var
-00071270: 735b 6b5d 290d 0a20 2020 2020 2020 2020  s[k])..         
-00071280: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00071290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000712a0: 2020 6966 2072 6f77 203d 3d20 313a 0d0a    if row == 1:..
-000712b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000712c0: 2020 2020 2020 2020 7820 3d20 6466 5b3a          x = df[:
-000712d0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-000712e0: 2020 2020 2020 2020 2020 2079 203d 2064             y = d
-000712f0: 6632 5b3a 5d0d 0a20 2020 2020 2020 2020  f2[:]..         
-00071300: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00071310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00071320: 2020 2020 2020 2020 2020 7820 3d20 6466            x = df
-00071330: 5b3a 2c6b 5d0d 0a20 2020 2020 2020 2020  [:,k]..         
-00071340: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00071350: 203d 2064 6632 5b3a 2c6b 5d0d 0a20 2020   = df2[:,k]..   
-00071360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071370: 206c 696e 6553 7461 7274 203d 2078 2e6d   lineStart = x.m
-00071380: 696e 2829 0d0a 2020 2020 2020 2020 2020  in()..          
-00071390: 2020 2020 2020 2020 2020 6c69 6e65 456e            lineEn
-000713a0: 6420 3d20 782e 6d61 7828 290d 0a20 2020  d = x.max()..   
-000713b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000713c0: 2069 6620 6c20 3d3d 2030 3a0d 0a20 2020   if l == 0:..   
-000713d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000713e0: 2020 2020 2061 7831 203d 2061 785b 6b5d       ax1 = ax[k]
-000713f0: 5b6c 5d0d 0a20 2020 2020 2020 2020 2020  [l]..           
-00071400: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
-00071410: 2e73 6361 7474 6572 2878 2c20 792c 2020  .scatter(x, y,  
-00071420: 636f 6c6f 7220 3d20 726f 775f 636f 6c6f  color = row_colo
-00071430: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-00071440: 2020 2020 2020 2020 2020 2020 6178 312e              ax1.
-00071450: 706c 6f74 285b 6c69 6e65 5374 6172 742c  plot([lineStart,
-00071460: 206c 696e 6545 6e64 5d2c 205b 6c69 6e65   lineEnd], [line
-00071470: 5374 6172 742c 206c 696e 6545 6e64 5d2c  Start, lineEnd],
-00071480: 2027 6b2d 272c 2063 6f6c 6f72 203d 2072   'k-', color = r
-00071490: 6f77 5f63 6f6c 6f72 290d 0a20 2020 2020  ow_color)..     
-000714a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000714b0: 2020 2061 7831 2e73 6574 5f78 6c61 6265     ax1.set_xlabe
-000714c0: 6c28 2741 6374 7561 6c73 2729 0d0a 2020  l('Actuals')..  
-000714d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000714e0: 2020 2020 2020 6178 312e 7365 745f 796c        ax1.set_yl
-000714f0: 6162 656c 2827 5072 6564 6963 7465 6427  abel('Predicted'
-00071500: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00071510: 2020 2020 2020 2020 2020 2061 7831 2e73             ax1.s
-00071520: 6574 5f74 6974 6c65 2827 5072 6564 6963  et_title('Predic
-00071530: 7465 6420 7673 2041 6374 7561 6c73 2050  ted vs Actuals P
-00071540: 6c6f 7420 666f 7220 5461 7267 6574 203d  lot for Target =
-00071550: 2025 7327 2025 6e75 6d5f 7661 7273 5b6b   %s' %num_vars[k
-00071560: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00071570: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00071580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071590: 2020 2020 2020 2061 7831 203d 2061 785b         ax1 = ax[
-000715a0: 6b5d 5b6c 5d0d 0a20 2020 2020 2020 2020  k][l]..         
-000715b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000715c0: 7831 2e68 6973 7428 2878 2d79 292c 2064  x1.hist((x-y), d
-000715d0: 656e 7369 7479 3d54 7275 652c 636f 6c6f  ensity=True,colo
-000715e0: 7220 3d20 726f 775f 636f 6c6f 7229 0d0a  r = row_color)..
+0006f740: 2020 2020 2020 2727 2e66 6f72 6d61 7428        ''.format(
+0006f750: 692c 2061 7665 7261 6765 5f70 7265 6369  i, average_preci
+0006f760: 7369 6f6e 5b69 5d29 290d 0a0d 0a20 2020  sion[i]))....   
+0006f770: 2020 2020 2066 6967 203d 2070 6c74 2e67       fig = plt.g
+0006f780: 6366 2829 0d0a 2020 2020 2020 2020 6669  cf()..        fi
+0006f790: 672e 7375 6270 6c6f 7473 5f61 646a 7573  g.subplots_adjus
+0006f7a0: 7428 626f 7474 6f6d 3d30 2e32 3529 0d0a  t(bottom=0.25)..
+0006f7b0: 2020 2020 2020 2020 706c 742e 786c 696d          plt.xlim
+0006f7c0: 285b 302e 302c 2031 2e30 5d29 0d0a 2020  ([0.0, 1.0])..  
+0006f7d0: 2020 2020 2020 706c 742e 796c 696d 285b        plt.ylim([
+0006f7e0: 302e 302c 2031 2e30 355d 290d 0a20 2020  0.0, 1.05])..   
+0006f7f0: 2020 2020 2070 6c74 2e78 6c61 6265 6c28       plt.xlabel(
+0006f800: 2752 6563 616c 6c27 290d 0a20 2020 2020  'Recall')..     
+0006f810: 2020 2070 6c74 2e79 6c61 6265 6c28 2750     plt.ylabel('P
+0006f820: 7265 6369 7369 6f6e 2729 0d0a 2020 2020  recision')..    
+0006f830: 2020 2020 706c 742e 7469 746c 6528 274d      plt.title('M
+0006f840: 6963 726f 2041 7667 2050 7265 6369 7369  icro Avg Precisi
+0006f850: 6f6e 2d52 6563 616c 6c20 6375 7276 6520  on-Recall curve 
+0006f860: 7769 7468 2069 736f 2d66 3120 6375 7276  with iso-f1 curv
+0006f870: 6573 2729 0d0a 2020 2020 2020 2020 706c  es')..        pl
+0006f880: 742e 6c65 6765 6e64 286c 696e 6573 2c20  t.legend(lines, 
+0006f890: 6c61 6265 6c73 2c20 6c6f 633d 276c 6f77  labels, loc='low
+0006f8a0: 6572 206c 6566 7427 2c20 7072 6f70 3d64  er left', prop=d
+0006f8b0: 6963 7428 7369 7a65 3d31 3029 290d 0a20  ict(size=10)).. 
+0006f8c0: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+0006f8d0: 293b 0d0a 2323 2323 2323 2323 2323 2323  );..############
+0006f8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006f920: 2323 2323 2323 2323 2323 0d0a 696d 706f  ##########..impo
+0006f930: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
+0006f940: 706c 6f74 2061 7320 706c 740d 0a69 6d70  plot as plt..imp
+0006f950: 6f72 7420 7365 6162 6f72 6e20 6173 2073  ort seaborn as s
+0006f960: 6e73 0d0a 6465 6620 6472 6177 5f63 6f6e  ns..def draw_con
+0006f970: 6675 7369 6f6e 5f6d 6178 7472 6978 2879  fusion_maxtrix(y
+0006f980: 5f74 6573 742c 795f 7072 6564 2c20 6d6f  _test,y_pred, mo
+0006f990: 6465 6c5f 6e61 6d65 3d27 4d6f 6465 6c27  del_name='Model'
+0006f9a0: 2c61 783d 2727 293a 0d0a 2020 2020 2222  ,ax=''):..    ""
+0006f9b0: 220d 0a20 2020 2054 6869 7320 706c 6f74  "..    This plot
+0006f9c0: 7320 6120 6265 6175 7469 6675 6c20 636f  s a beautiful co
+0006f9d0: 6e66 7573 696f 6e20 6d61 7472 6978 2062  nfusion matrix b
+0006f9e0: 6173 6564 206f 6e20 696e 7075 743a 2067  ased on input: g
+0006f9f0: 726f 756e 6420 7472 7574 6873 2061 6e64  round truths and
+0006fa00: 2070 7265 6469 6374 696f 6e73 0d0a 2020   predictions..  
+0006fa10: 2020 2222 220d 0a20 2020 2023 436f 6e66    """..    #Conf
+0006fa20: 7573 696f 6e20 4d61 7472 6978 0d0a 2020  usion Matrix..  
+0006fa30: 2020 2727 2750 6c6f 7474 696e 6720 434f    '''Plotting CO
+0006fa40: 4e46 5553 494f 4e20 4d41 5452 4958 2727  NFUSION MATRIX''
+0006fa50: 270d 0a20 2020 2069 6d70 6f72 7420 7365  '..    import se
+0006fa60: 6162 6f72 6e20 6173 2073 6e73 0d0a 2020  aborn as sns..  
+0006fa70: 2020 736e 732e 7365 745f 7374 796c 6528    sns.set_style(
+0006fa80: 2764 6172 6b67 7269 6427 290d 0a0d 0a20  'darkgrid').... 
+0006fa90: 2020 2027 2727 4469 7370 6c61 7927 2727     '''Display'''
+0006faa0: 0d0a 2020 2020 6672 6f6d 2049 5079 7468  ..    from IPyth
+0006fab0: 6f6e 2e63 6f72 652e 6469 7370 6c61 7920  on.core.display 
+0006fac0: 696d 706f 7274 2064 6973 706c 6179 2c20  import display, 
+0006fad0: 4854 4d4c 0d0a 2020 2020 6469 7370 6c61  HTML..    displa
+0006fae0: 7928 4854 4d4c 2822 3c73 7479 6c65 3e2e  y(HTML("<style>.
+0006faf0: 636f 6e74 6169 6e65 7220 7b20 7769 6474  container { widt
+0006fb00: 683a 3935 2520 2169 6d70 6f72 7461 6e74  h:95% !important
+0006fb10: 3b20 7d3c 2f73 7479 6c65 3e22 2929 0d0a  ; }</style>"))..
+0006fb20: 2020 2020 7064 2e6f 7074 696f 6e73 2e64      pd.options.d
+0006fb30: 6973 706c 6179 2e66 6c6f 6174 5f66 6f72  isplay.float_for
+0006fb40: 6d61 7420 3d20 277b 3a2c 2e32 667d 272e  mat = '{:,.2f}'.
+0006fb50: 666f 726d 6174 0d0a 0d0a 2020 2020 2347  format....    #G
+0006fb60: 6574 2074 6865 2063 6f6e 6675 7369 6f6e  et the confusion
+0006fb70: 206d 6174 7269 7820 616e 6420 7075 7420   matrix and put 
+0006fb80: 6974 2069 6e74 6f20 6120 6466 0d0a 2020  it into a df..  
+0006fb90: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6d    from sklearn.m
+0006fba0: 6574 7269 6373 2069 6d70 6f72 7420 636f  etrics import co
+0006fbb0: 6e66 7573 696f 6e5f 6d61 7472 6978 2c20  nfusion_matrix, 
+0006fbc0: 6631 5f73 636f 7265 0d0a 0d0a 2020 2020  f1_score....    
+0006fbd0: 636d 203d 2063 6f6e 6675 7369 6f6e 5f6d  cm = confusion_m
+0006fbe0: 6174 7269 7828 795f 7465 7374 2c20 795f  atrix(y_test, y_
+0006fbf0: 7072 6564 290d 0a0d 0a20 2020 2063 6d5f  pred)....    cm_
+0006fc00: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+0006fc10: 6528 636d 2c0d 0a20 2020 2020 2020 2020  e(cm,..         
+0006fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006fc30: 696e 6465 7820 3d20 6e70 2e75 6e69 7175  index = np.uniqu
+0006fc40: 6528 795f 7465 7374 292e 746f 6c69 7374  e(y_test).tolist
+0006fc50: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
+0006fc60: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0006fc70: 6c75 6d6e 7320 3d20 6e70 2e75 6e69 7175  lumns = np.uniqu
+0006fc80: 6528 795f 7465 7374 292e 746f 6c69 7374  e(y_test).tolist
+0006fc90: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
+0006fca0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+0006fcb0: 0d0a 2020 2020 736e 732e 6865 6174 6d61  ..    sns.heatma
+0006fcc0: 7028 636d 5f64 662c 0d0a 2020 2020 2020  p(cm_df,..      
+0006fcd0: 2020 2020 2020 2020 2020 6365 6e74 6572            center
+0006fce0: 3d30 2c0d 0a20 2020 2020 2020 2020 2020  =0,..           
+0006fcf0: 2020 2020 2063 6d61 703d 736e 732e 6469       cmap=sns.di
+0006fd00: 7665 7267 696e 675f 7061 6c65 7474 6528  verging_palette(
+0006fd10: 3232 302c 2031 352c 2061 735f 636d 6170  220, 15, as_cmap
+0006fd20: 3d54 7275 6529 2c0d 0a20 2020 2020 2020  =True),..       
+0006fd30: 2020 2020 2020 2020 2061 6e6e 6f74 3d54           annot=T
+0006fd40: 7275 652c 0d0a 2020 2020 2020 2020 2020  rue,..          
+0006fd50: 2020 2020 2020 666d 743d 2767 272c 0d0a        fmt='g',..
+0006fd60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0006fd70: 783d 6178 290d 0a0d 0a20 2020 2061 782e  x=ax)....    ax.
+0006fd80: 7365 745f 7469 746c 6528 2720 2573 205c  set_title(' %s \
+0006fd90: 6e46 3120 5363 6f72 6528 6176 6720 3d20  nF1 Score(avg = 
+0006fda0: 6d69 6372 6f29 3a20 2530 2e32 6620 5c6e  micro): %0.2f \n
+0006fdb0: 4631 2053 636f 7265 2861 7667 203d 206d  F1 Score(avg = m
+0006fdc0: 6163 726f 293a 2025 302e 3266 2720 2528  acro): %0.2f' %(
+0006fdd0: 0d0a 2020 2020 2020 2020 6d6f 6465 6c5f  ..        model_
+0006fde0: 6e61 6d65 2c66 315f 7363 6f72 6528 795f  name,f1_score(y_
+0006fdf0: 7465 7374 2c20 795f 7072 6564 2c20 6176  test, y_pred, av
+0006fe00: 6572 6167 653d 276d 6963 726f 2729 2c66  erage='micro'),f
+0006fe10: 315f 7363 6f72 6528 795f 7465 7374 2c20  1_score(y_test, 
+0006fe20: 795f 7072 6564 2c20 6176 6572 6167 653d  y_pred, average=
+0006fe30: 276d 6163 726f 2729 292c 0d0a 2020 2020  'macro')),..    
+0006fe40: 2020 2020 2020 2020 2020 666f 6e74 7369            fontsi
+0006fe50: 7a65 203d 2031 3329 0d0a 2020 2020 6178  ze = 13)..    ax
+0006fe60: 2e73 6574 5f79 6c61 6265 6c28 2754 7275  .set_ylabel('Tru
+0006fe70: 6520 6c61 6265 6c27 2c20 666f 6e74 7369  e label', fontsi
+0006fe80: 7a65 203d 2031 3329 0d0a 2020 2020 6178  ze = 13)..    ax
+0006fe90: 2e73 6574 5f78 6c61 6265 6c28 2750 7265  .set_xlabel('Pre
+0006fea0: 6469 6374 6564 206c 6162 656c 272c 2066  dicted label', f
+0006feb0: 6f6e 7473 697a 6520 3d20 3133 290d 0a23  ontsize = 13)..#
+0006fec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006fed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006fee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006fef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ff00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006ff10: 2323 2323 230d 0a66 726f 6d20 736b 6c65  #####..from skle
+0006ff20: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
+0006ff30: 7274 2063 6c61 7373 6966 6963 6174 696f  rt classificatio
+0006ff40: 6e5f 7265 706f 7274 2c20 726f 635f 6375  n_report, roc_cu
+0006ff50: 7276 650d 0a69 6d70 6f72 7420 6d61 7470  rve..import matp
+0006ff60: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
+0006ff70: 2070 6c74 0d0a 696d 706f 7274 2073 6561   plt..import sea
+0006ff80: 626f 726e 2061 7320 736e 730d 0a0d 0a66  born as sns....f
+0006ff90: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+0006ffa0: 6963 7320 696d 706f 7274 2072 6f63 5f63  ics import roc_c
+0006ffb0: 7572 7665 2c20 7072 6563 6973 696f 6e5f  urve, precision_
+0006ffc0: 7265 6361 6c6c 5f63 7572 7665 0d0a 0d0a  recall_curve....
+0006ffd0: 6465 6620 706c 6f74 5f70 7265 6369 7369  def plot_precisi
+0006ffe0: 6f6e 5f72 6563 616c 6c5f 6375 7276 6528  on_recall_curve(
+0006fff0: 6d2c 2078 5f74 6573 7463 2c20 795f 7465  m, x_testc, y_te
+00070000: 7374 2c20 6178 3d4e 6f6e 6529 3a0d 0a0d  st, ax=None):...
+00070010: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
+00070020: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
+00070030: 6f20 706c 6f74 2050 5220 6375 7276 6520  o plot PR curve 
+00070040: 666f 7220 6269 6e61 7279 2063 6c61 7373  for binary class
+00070050: 6573 2023 2323 2323 0d0a 2020 2020 795f  es #####..    y_
+00070060: 7363 6f72 6573 203d 206d 2e70 7265 6469  scores = m.predi
+00070070: 6374 5f70 726f 6261 2878 5f74 6573 7463  ct_proba(x_testc
+00070080: 295b 3a2c 315d 0d0a 2020 2020 2323 2320  )[:,1]..    ### 
+00070090: 6765 6e65 7261 7465 2074 6865 2070 7265  generate the pre
+000700a0: 6369 7369 6f6e 2072 6563 616c 6c20 6375  cision recall cu
+000700b0: 7276 6520 2323 2323 2323 2323 2323 0d0a  rve ##########..
+000700c0: 2020 2020 702c 2072 2c20 7468 7265 7368      p, r, thresh
+000700d0: 6f6c 6473 203d 2070 7265 6369 7369 6f6e  olds = precision
+000700e0: 5f72 6563 616c 6c5f 6375 7276 6528 795f  _recall_curve(y_
+000700f0: 7465 7374 2c20 795f 7363 6f72 6573 290d  test, y_scores).
+00070100: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
+00070110: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
+00070120: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
+00070130: 7469 746c 6528 2250 7265 6369 7369 6f6e  title("Precision
+00070140: 2052 6563 616c 6c20 4375 7276 6522 290d   Recall Curve").
+00070150: 0a20 2020 2061 782e 706c 6f74 2872 2c20  .    ax.plot(r, 
+00070160: 702c 2063 6f6c 6f72 3d22 7075 7270 6c65  p, color="purple
+00070170: 2229 0d0a 2020 2020 6178 2e73 6574 5f79  ")..    ax.set_y
+00070180: 6c69 6d28 5b30 2e35 2c20 312e 3031 5d29  lim([0.5, 1.01])
+00070190: 0d0a 2020 2020 6178 2e73 6574 5f78 6c69  ..    ax.set_xli
+000701a0: 6d28 5b30 2e35 2c20 312e 3031 5d29 0d0a  m([0.5, 1.01])..
+000701b0: 2020 2020 6178 2e73 6574 5f78 6c61 6265      ax.set_xlabe
+000701c0: 6c28 2752 6563 616c 6c27 290d 0a20 2020  l('Recall')..   
+000701d0: 2061 782e 7365 745f 796c 6162 656c 2827   ax.set_ylabel('
+000701e0: 5072 6563 6973 696f 6e27 290d 0a0d 0a64  Precision')....d
+000701f0: 6566 2070 6c6f 745f 726f 635f 6375 7276  ef plot_roc_curv
+00070200: 6528 6d2c 2078 5f74 6573 7463 2c20 795f  e(m, x_testc, y_
+00070210: 7465 7374 2c20 6178 3d4e 6f6e 6529 3a0d  test, ax=None):.
+00070220: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
+00070230: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
+00070240: 6f20 706c 6f74 2052 4f43 2063 7572 7665  o plot ROC curve
+00070250: 2066 6f72 2062 696e 6172 7920 636c 6173   for binary clas
+00070260: 7365 7320 2323 2323 230d 0a20 2020 2079  ses #####..    y
+00070270: 5f73 636f 7265 7320 3d20 6d2e 7072 6564  _scores = m.pred
+00070280: 6963 745f 7072 6f62 6128 785f 7465 7374  ict_proba(x_test
+00070290: 6329 5b3a 2c31 5d0d 0a20 2020 2023 2323  c)[:,1]..    ###
+000702a0: 2067 656e 6572 6174 6520 7468 6520 7072   generate the pr
+000702b0: 6563 6973 696f 6e20 7265 6361 6c6c 2063  ecision recall c
+000702c0: 7572 7665 2023 2323 2323 2323 2323 230d  urve ##########.
+000702d0: 0a20 2020 2066 7072 2c20 7470 722c 205f  .    fpr, tpr, _
+000702e0: 203d 2072 6f63 5f63 7572 7665 2879 5f74   = roc_curve(y_t
+000702f0: 6573 742c 2020 795f 7363 6f72 6573 290d  est,  y_scores).
+00070300: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
+00070310: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
+00070320: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
+00070330: 7469 746c 6528 2252 4f43 2041 5543 2043  title("ROC AUC C
+00070340: 7572 7665 2229 0d0a 2020 2020 6178 2e70  urve")..    ax.p
+00070350: 6c6f 7428 6670 722c 7470 722c 2063 6f6c  lot(fpr,tpr, col
+00070360: 6f72 3d22 7075 7270 6c65 2229 0d0a 2020  or="purple")..  
+00070370: 2020 6178 2e73 6574 5f79 6c69 6d28 5b30    ax.set_ylim([0
+00070380: 2e30 2c20 312e 3031 5d29 0d0a 2020 2020  .0, 1.01])..    
+00070390: 6178 2e73 6574 5f78 6c69 6d28 5b30 2e30  ax.set_xlim([0.0
+000703a0: 2c20 312e 3031 5d29 0d0a 2020 2020 6178  , 1.01])..    ax
+000703b0: 2e73 6574 5f78 6c61 6265 6c28 2746 616c  .set_xlabel('Fal
+000703c0: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
+000703d0: 2729 0d0a 2020 2020 6178 2e73 6574 5f79  ')..    ax.set_y
+000703e0: 6c61 6265 6c28 2754 7275 6520 506f 7369  label('True Posi
+000703f0: 7469 7665 2052 6174 6527 290d 0a0d 0a0d  tive Rate').....
+00070400: 0a64 6566 2070 6c6f 745f 636c 6173 7369  .def plot_classi
+00070410: 6669 6361 7469 6f6e 5f72 6573 756c 7473  fication_results
+00070420: 286d 2c20 585f 7472 7565 2c20 795f 7472  (m, X_true, y_tr
+00070430: 7565 2c20 795f 7072 6564 2c20 6c61 6265  ue, y_pred, labe
+00070440: 6c73 2c20 7461 7267 6574 5f6e 616d 6573  ls, target_names
+00070450: 2c20 6561 6368 5f74 6172 6765 7429 3a0d  , each_target):.
+00070460: 0a20 2020 2023 2323 2320 5468 6573 6520  .    #### These 
+00070470: 706c 6f74 7320 6172 6520 6f6e 6c79 2066  plots are only f
+00070480: 6f72 2062 696e 6172 7920 636c 6173 7365  or binary classe
+00070490: 7320 2323 2323 2323 2323 2323 2323 230d  s #############.
+000704a0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+000704b0: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
+000704c0: 6c74 2e73 7562 706c 6f74 7328 322c 322c  lt.subplots(2,2,
+000704d0: 6669 6773 697a 653d 2831 352c 3135 2929  figsize=(15,15))
+000704e0: 0d0a 2020 2020 2020 2020 706c 6f74 5f72  ..        plot_r
+000704f0: 6f63 5f63 7572 7665 286d 2c20 585f 7472  oc_curve(m, X_tr
+00070500: 7565 2c20 795f 7472 7565 2c20 6178 3d61  ue, y_true, ax=a
+00070510: 7865 735b 302c 315d 290d 0a20 2020 2020  xes[0,1])..     
+00070520: 2020 2061 7865 735b 302c 315d 2e73 6574     axes[0,1].set
+00070530: 5f74 6974 6c65 2827 524f 4320 4155 4320  _title('ROC AUC 
+00070540: 4375 7276 653a 2025 7327 2025 6561 6368  Curve: %s' %each
+00070550: 5f74 6172 6765 7429 0d0a 2020 2020 2020  _target)..      
+00070560: 2020 0d0a 2020 2020 2020 2020 706c 6f74    ..        plot
+00070570: 5f70 7265 6369 7369 6f6e 5f72 6563 616c  _precision_recal
+00070580: 6c5f 6375 7276 6528 6d2c 2058 5f74 7275  l_curve(m, X_tru
+00070590: 652c 2079 5f74 7275 652c 2061 783d 6178  e, y_true, ax=ax
+000705a0: 6573 5b31 2c30 5d29 0d0a 2020 2020 2020  es[1,0])..      
+000705b0: 2020 6178 6573 5b31 2c30 5d2e 7365 745f    axes[1,0].set_
+000705c0: 7469 746c 6528 2750 5220 4155 4320 4375  title('PR AUC Cu
+000705d0: 7276 6520 666f 723a 2025 7327 2025 6561  rve for: %s' %ea
+000705e0: 6368 5f74 6172 6765 7429 0d0a 2020 2020  ch_target)..    
+000705f0: 2020 2020 795f 7072 6564 203d 206d 2e70      y_pred = m.p
+00070600: 7265 6469 6374 2858 5f74 7275 6529 0d0a  redict(X_true)..
+00070610: 2020 2020 2020 2020 6472 6177 5f63 6f6e          draw_con
+00070620: 6675 7369 6f6e 5f6d 6178 7472 6978 2879  fusion_maxtrix(y
+00070630: 5f74 7275 652c 2079 5f70 7265 642c 2027  _true, y_pred, '
+00070640: 436f 6e66 7573 696f 6e20 4d61 7472 6978  Confusion Matrix
+00070650: 272c 2061 783d 6178 6573 5b30 2c30 5d29  ', ax=axes[0,0])
+00070660: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+00070670: 2020 2020 2020 2020 2020 2020 636c 665f              clf_
+00070680: 7265 706f 7274 203d 2063 6c61 7373 6966  report = classif
+00070690: 6963 6174 696f 6e5f 7265 706f 7274 2879  ication_report(y
+000706a0: 5f74 7275 652c 0d0a 2020 2020 2020 2020  _true,..        
+000706b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000706c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000706d0: 2020 2020 2020 2079 5f70 7265 642c 0d0a         y_pred,..
+000706e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000706f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070710: 236c 6162 656c 733d 7461 7267 6574 5f6e  #labels=target_n
+00070720: 616d 6573 2c0d 0a20 2020 2020 2020 2020  ames,..         
+00070730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070750: 2020 2020 2020 2023 7461 7267 6574 5f6e         #target_n
+00070760: 616d 6573 3d6c 6162 656c 732c 0d0a 2020  ames=labels,..  
+00070770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070790: 2020 2020 2020 2020 2020 2020 206f 7574               out
+000707a0: 7075 745f 6469 6374 3d54 7275 6529 0d0a  put_dict=True)..
+000707b0: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+000707c0: 0a20 2020 2020 2020 2020 2020 2063 6c66  .            clf
+000707d0: 5f72 6570 6f72 7420 3d20 636c 6173 7369  _report = classi
+000707e0: 6669 6361 7469 6f6e 5f72 6570 6f72 7428  fication_report(
+000707f0: 795f 7472 7565 2c79 5f70 7265 642c 0d0a  y_true,y_pred,..
+00070800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070810: 236c 6162 656c 733d 7461 7267 6574 5f6e  #labels=target_n
+00070820: 616d 6573 2c0d 0a20 2020 2020 2020 2020  ames,..         
+00070830: 2020 2020 2020 2023 7461 7267 6574 5f6e         #target_n
+00070840: 616d 6573 3d6c 6162 656c 732c 0d0a 2020  ames=labels,..  
+00070850: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+00070860: 7470 7574 5f64 6963 743d 5472 7565 290d  tput_dict=True).
+00070870: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00070880: 2020 2073 6e73 2e68 6561 746d 6170 2870     sns.heatmap(p
+00070890: 642e 4461 7461 4672 616d 6528 636c 665f  d.DataFrame(clf_
+000708a0: 7265 706f 7274 292e 696c 6f63 5b3a 2c20  report).iloc[:, 
+000708b0: 3a5d 2e54 2c20 616e 6e6f 743d 5472 7565  :].T, annot=True
+000708c0: 2c61 783d 6178 6573 5b31 2c31 5d2c 666d  ,ax=axes[1,1],fm
+000708d0: 743d 2730 2e32 6627 293b 0d0a 2020 2020  t='0.2f');..    
+000708e0: 2020 2020 6178 6573 5b31 2c31 5d2e 7365      axes[1,1].se
+000708f0: 745f 7469 746c 6528 2743 6c61 7373 6966  t_title('Classif
+00070900: 6963 6174 696f 6e20 5265 706f 7274 3a20  ication Report: 
+00070910: 2573 2720 2565 6163 685f 7461 7267 6574  %s' %each_target
+00070920: 290d 0a20 2020 2065 7863 6570 743a 0d0a  )..    except:..
+00070930: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
+00070940: 7272 6f72 3a20 636f 756c 6420 6e6f 7420  rror: could not 
+00070950: 706c 6f74 2063 6c61 7373 6966 6963 6174  plot classificat
+00070960: 696f 6e20 7265 7375 6c74 732e 2043 6f6e  ion results. Con
+00070970: 7469 6e75 696e 672e 2e2e 2729 0d0a 0d0a  tinuing...')....
+00070980: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6574  from sklearn.met
+00070990: 7269 6373 2069 6d70 6f72 7420 636c 6173  rics import clas
+000709a0: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
+000709b0: 742c 2063 6f6e 6675 7369 6f6e 5f6d 6174  t, confusion_mat
+000709c0: 7269 780d 0a66 726f 6d20 736b 6c65 6172  rix..from sklear
+000709d0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
+000709e0: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
+000709f0: 6379 5f73 636f 7265 0d0a 6465 6620 7072  cy_score..def pr
+00070a00: 696e 745f 636c 6173 7369 6669 6361 7469  int_classificati
+00070a10: 6f6e 5f6d 6f64 656c 5f73 7461 7473 2879  on_model_stats(y
+00070a20: 5f74 7275 652c 2070 7265 6469 6374 6564  _true, predicted
+00070a30: 2c20 6d5f 7468 7265 7368 3d30 2e35 293a  , m_thresh=0.5):
+00070a40: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+00070a50: 6869 7320 7072 696e 7473 2063 6c61 7373  his prints class
+00070a60: 6966 6963 6174 696f 6e20 6d65 7472 6963  ification metric
+00070a70: 7320 696e 2061 206e 6963 6520 666f 726d  s in a nice form
+00070a80: 6174 206f 6e6c 7920 666f 7220 6269 6e61  at only for bina
+00070a90: 7279 2063 6c61 7373 6573 0d0a 2020 2020  ry classes..    
+00070aa0: 2222 220d 0a20 2020 2023 2055 7365 2074  """..    # Use t
+00070ab0: 6869 7320 746f 2054 6573 7420 436c 6173  his to Test Clas
+00070ac0: 7369 6669 6361 7469 6f6e 2050 726f 626c  sification Probl
+00070ad0: 656d 7320 4f6e 6c79 2023 2323 230d 0a20  ems Only ####.. 
+00070ae0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00070af0: 2072 6172 655f 636c 6173 7320 3d20 6669   rare_class = fi
+00070b00: 6e64 5f72 6172 655f 636c 6173 7328 795f  nd_rare_class(y_
+00070b10: 7472 7565 290d 0a20 2020 2020 2020 2072  true)..        r
+00070b20: 6567 5f61 6363 203d 205b 302c 305d 0d0a  eg_acc = [0,0]..
+00070b30: 2020 2020 2020 2020 666f 7220 692c 7468          for i,th
+00070b40: 7265 7368 6f6c 6420 696e 207a 6970 2872  reshold in zip(r
+00070b50: 616e 6765 2832 292c 205b 302e 352c 206d  ange(2), [0.5, m
+00070b60: 5f74 6872 6573 685d 293a 0d0a 2020 2020  _thresh]):..    
+00070b70: 2020 2020 2020 2020 6966 2074 6872 6573          if thres
+00070b80: 686f 6c64 2021 3d20 302e 353a 0d0a 2020  hold != 0.5:..  
+00070b90: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00070ba0: 6564 6963 7465 6420 5b3a 2c30 5d20 3d20  edicted [:,0] = 
+00070bb0: 2870 7265 6469 6374 6564 205b 3a2c 305d  (predicted [:,0]
+00070bc0: 203e 3d20 2831 2d74 6872 6573 686f 6c64   >= (1-threshold
+00070bd0: 2929 2e61 7374 7970 6528 2769 6e74 2729  )).astype('int')
+00070be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070bf0: 2020 7072 6564 6963 7465 6420 5b3a 2c31    predicted [:,1
+00070c00: 5d20 3d20 2870 7265 6469 6374 6564 205b  ] = (predicted [
+00070c10: 3a2c 315d 203e 3d20 7468 7265 7368 6f6c  :,1] >= threshol
+00070c20: 6429 2e61 7374 7970 6528 2769 6e74 2729  d).astype('int')
+00070c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070c40: 2020 795f 7072 6564 203d 2070 7265 6469    y_pred = predi
+00070c50: 6374 6564 5b3a 2c72 6172 655f 636c 6173  cted[:,rare_clas
+00070c60: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+00070c70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00070c80: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+00070c90: 7072 6564 6963 7465 642e 6172 676d 6178  predicted.argmax
+00070ca0: 2861 7869 733d 3129 0d0a 2020 2020 2020  (axis=1)..      
+00070cb0: 2020 2020 2020 7072 696e 7428 2742 616c        print('Bal
+00070cc0: 616e 6365 6420 4163 6375 7261 6379 203d  anced Accuracy =
+00070cd0: 2025 302e 3266 2525 2077 6974 6820 5468   %0.2f%% with Th
+00070ce0: 7265 7368 6f6c 6420 3d20 2530 2e32 6627  reshold = %0.2f'
+00070cf0: 2025 280d 0a20 2020 2020 2020 2020 2020   %(..           
+00070d00: 2020 2020 2031 3030 2a62 616c 616e 6365       100*balance
+00070d10: 645f 6163 6375 7261 6379 5f73 636f 7265  d_accuracy_score
+00070d20: 2879 5f74 7275 652c 2079 5f70 7265 6429  (y_true, y_pred)
+00070d30: 2c74 6872 6573 686f 6c64 2929 0d0a 2020  ,threshold))..  
+00070d40: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00070d50: 2743 6f6e 6675 7369 6f6e 204d 6174 7269  'Confusion Matri
+00070d60: 783a 2729 0d0a 2020 2020 2020 2020 2020  x:')..          
+00070d70: 2020 7072 696e 7428 636f 6e66 7573 696f    print(confusio
+00070d80: 6e5f 6d61 7472 6978 2879 5f74 7275 652c  n_matrix(y_true,
+00070d90: 2079 5f70 7265 6429 290d 0a20 2020 2020   y_pred))..     
+00070da0: 2020 2020 2020 2070 7269 6e74 2863 6c61         print(cla
+00070db0: 7373 6966 6963 6174 696f 6e5f 7265 706f  ssification_repo
+00070dc0: 7274 2879 5f74 7275 652c 2079 5f70 7265  rt(y_true, y_pre
+00070dd0: 6429 290d 0a20 2020 2020 2020 2020 2020  d))..           
+00070de0: 2072 6567 5f61 6363 5b69 5d20 3d20 6261   reg_acc[i] = ba
+00070df0: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+00070e00: 7363 6f72 6528 795f 7472 7565 2c20 795f  score(y_true, y_
+00070e10: 7072 6564 290d 0a20 2020 2020 2020 2070  pred)..        p
+00070e20: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
+00070e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070e60: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+00070e70: 2020 2020 2020 2069 6620 2072 6567 5f61         if  reg_a
+00070e80: 6363 5b30 5d20 3e3d 2072 6567 5f61 6363  cc[0] >= reg_acc
+00070e90: 5b31 5d20 3a0d 0a20 2020 2020 2020 2020  [1] :..         
+00070ea0: 2020 2070 7269 6e74 2827 5265 6775 6c61     print('Regula
+00070eb0: 7220 7468 7265 7368 6f6c 6420 3d20 2530  r threshold = %0
+00070ec0: 2e32 6620 6973 2062 6574 7465 7227 2025  .2f is better' %
+00070ed0: 302e 3529 0d0a 2020 2020 2020 2020 2020  0.5)..          
+00070ee0: 2020 7265 7475 726e 2072 6567 5f61 6363    return reg_acc
+00070ef0: 5b30 5d0d 0a20 2020 2020 2020 2065 6c73  [0]..        els
+00070f00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00070f10: 7072 696e 7428 274d 6f64 6966 6965 6420  print('Modified 
+00070f20: 7468 7265 7368 6f6c 6420 3d20 2530 2e32  threshold = %0.2
+00070f30: 6620 6973 2062 6574 7465 7227 2025 6d5f  f is better' %m_
+00070f40: 7468 7265 7368 290d 0a20 2020 2020 2020  thresh)..       
+00070f50: 2020 2020 2072 6574 7572 6e20 7265 675f       return reg_
+00070f60: 6163 635b 315d 0d0a 2020 2020 6578 6365  acc[1]..    exce
+00070f70: 7074 3a0d 0a20 2020 2020 2020 2070 7269  pt:..        pri
+00070f80: 6e74 2827 4572 726f 723a 2070 7269 6e74  nt('Error: print
+00070f90: 696e 6720 636c 6173 7369 6669 6361 7469  ing classificati
+00070fa0: 6f6e 206d 6f64 656c 206d 6574 7269 6373  on model metrics
+00070fb0: 2e20 436f 6e74 696e 7569 6e67 2e2e 2e27  . Continuing...'
+00070fc0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00070fd0: 6e20 300d 0a23 2323 2323 2323 2323 2323  n 0..###########
+00070fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00070ff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071010: 2323 2323 2323 2323 2323 0d0a 2323 2323  ##########..####
+00071020: 2320 2020 2020 5245 4752 4553 5349 4f4e  #     REGRESSION
+00071030: 2043 4841 5254 5320 414e 4420 4d45 5452   CHARTS AND METR
+00071040: 4943 5320 4152 4520 5052 494e 5445 4420  ICS ARE PRINTED 
+00071050: 504c 4f54 5445 4420 4845 5245 0d0a 2323  PLOTTED HERE..##
+00071060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000710a0: 2323 230d 0a69 6d70 6f72 7420 7469 6d65  ###..import time
+000710b0: 0d0a 6465 6620 706c 6f74 5f72 6567 7265  ..def plot_regre
+000710c0: 7373 696f 6e5f 7363 6174 7465 7273 2864  ssion_scatters(d
+000710d0: 662c 2064 6632 2c20 6e75 6d5f 7661 7273  f, df2, num_vars
+000710e0: 2c20 6b69 6e64 3d27 7363 6174 7465 7227  , kind='scatter'
+000710f0: 2c20 706c 6f74 5f6e 616d 653d 2727 293a  , plot_name=''):
+00071100: 0d0a 2020 2020 2222 220d 0a20 2020 2047  ..    """..    G
+00071110: 7265 6174 2077 6179 2074 6f20 706c 6f74  reat way to plot
+00071120: 2063 6f6e 7469 6e75 6f75 7320 7661 7269   continuous vari
+00071130: 6162 6c65 7320 6661 7374 2e20 4a75 7374  ables fast. Just
+00071140: 2073 656e 7420 7468 656d 2069 6e20 616e   sent them in an
+00071150: 6420 6974 2077 696c 6c20 7461 6b65 2063  d it will take c
+00071160: 6172 6520 6f66 2074 6865 2072 6573 7421  are of the rest!
+00071170: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
+00071180: 6967 7369 7a65 203d 2028 3130 2c20 3130  igsize = (10, 10
+00071190: 290d 0a20 2020 2063 6f6c 6f72 7320 3d20  )..    colors = 
+000711a0: 6379 636c 6528 2762 7972 636d 676b 6279  cycle('byrcmgkby
+000711b0: 7263 6d67 6b62 7972 636d 676b 6279 7263  rcmgkbyrcmgkbyrc
+000711c0: 6d67 6b27 290d 0a20 2020 206e 756d 5f76  mgk')..    num_v
+000711d0: 6172 735f 6c65 6e20 3d20 6c65 6e28 6e75  ars_len = len(nu
+000711e0: 6d5f 7661 7273 290d 0a20 2020 2063 6f6c  m_vars)..    col
+000711f0: 203d 2032 0d0a 2020 2020 7374 6172 745f   = 2..    start_
+00071200: 7469 6d65 203d 2074 696d 652e 7469 6d65  time = time.time
+00071210: 2829 0d0a 2020 2020 726f 7720 3d20 6c65  ()..    row = le
+00071220: 6e28 6e75 6d5f 7661 7273 290d 0a20 2020  n(num_vars)..   
+00071230: 2066 6967 2c20 6178 203d 2070 6c74 2e73   fig, ax = plt.s
+00071240: 7562 706c 6f74 7328 726f 772c 2063 6f6c  ubplots(row, col
+00071250: 290d 0a20 2020 2069 6620 636f 6c20 3c20  )..    if col < 
+00071260: 323a 0d0a 2020 2020 2020 2020 6669 672e  2:..        fig.
+00071270: 7365 745f 7369 7a65 5f69 6e63 6865 7328  set_size_inches(
+00071280: 6d69 6e28 3135 2c38 292c 726f 772a 3529  min(15,8),row*5)
+00071290: 0d0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
+000712a0: 6270 6c6f 7473 5f61 646a 7573 7428 6873  bplots_adjust(hs
+000712b0: 7061 6365 3d30 2e35 2920 2323 2320 5468  pace=0.5) ### Th
+000712c0: 6973 2063 6f6e 7472 6f6c 7320 7468 6520  is controls the 
+000712d0: 7370 6163 6520 6265 7477 656e 2072 6f77  space betwen row
+000712e0: 730d 0a20 2020 2020 2020 2066 6967 2e73  s..        fig.s
+000712f0: 7562 706c 6f74 735f 6164 6a75 7374 2877  ubplots_adjust(w
+00071300: 7370 6163 653d 302e 3329 2023 2323 2054  space=0.3) ### T
+00071310: 6869 7320 636f 6e74 726f 6c73 2074 6865  his controls the
+00071320: 2073 7061 6365 2062 6574 7765 656e 2063   space between c
+00071330: 6f6c 756d 6e73 0d0a 2020 2020 656c 7365  olumns..    else
+00071340: 3a0d 0a20 2020 2020 2020 2066 6967 2e73  :..        fig.s
+00071350: 6574 5f73 697a 655f 696e 6368 6573 286d  et_size_inches(m
+00071360: 696e 2863 6f6c 2a31 302c 3230 292c 726f  in(col*10,20),ro
+00071370: 772a 3529 0d0a 2020 2020 2020 2020 6669  w*5)..        fi
+00071380: 672e 7375 6270 6c6f 7473 5f61 646a 7573  g.subplots_adjus
+00071390: 7428 6873 7061 6365 3d30 2e33 2920 2323  t(hspace=0.3) ##
+000713a0: 2320 5468 6973 2063 6f6e 7472 6f6c 7320  # This controls 
+000713b0: 7468 6520 7370 6163 6520 6265 7477 656e  the space betwen
+000713c0: 2072 6f77 730d 0a20 2020 2020 2020 2066   rows..        f
+000713d0: 6967 2e73 7562 706c 6f74 735f 6164 6a75  ig.subplots_adju
+000713e0: 7374 2877 7370 6163 653d 302e 3329 2023  st(wspace=0.3) #
+000713f0: 2323 2054 6869 7320 636f 6e74 726f 6c73  ## This controls
+00071400: 2074 6865 2073 7061 6365 2062 6574 7765   the space betwe
+00071410: 656e 2063 6f6c 756d 6e73 0d0a 2020 2020  en columns..    
+00071420: 6669 672e 7375 7074 6974 6c65 2827 5265  fig.suptitle('Re
+00071430: 6772 6573 7369 6f6e 204d 6574 7269 6373  gression Metrics
+00071440: 2050 6c6f 7473 2066 6f72 2025 7320 4d6f   Plots for %s Mo
+00071450: 6465 6c27 2025 706c 6f74 5f6e 616d 652c  del' %plot_name,
+00071460: 2066 6f6e 7473 697a 653d 3230 290d 0a20   fontsize=20).. 
+00071470: 2020 2063 6f75 6e74 6572 203d 2030 0d0a     counter = 0..
+00071480: 2020 2020 6966 2072 6f77 203d 3d20 313a      if row == 1:
+00071490: 0d0a 2020 2020 2020 2020 6178 203d 2061  ..        ax = a
+000714a0: 782e 7265 7368 6170 6528 2d31 2c31 292e  x.reshape(-1,1).
+000714b0: 540d 0a20 2020 2066 6f72 206b 2069 6e20  T..    for k in 
+000714c0: 6e70 2e61 7261 6e67 6528 726f 7729 3a0d  np.arange(row):.
+000714d0: 0a20 2020 2020 2020 2072 6f77 5f63 6f6c  .        row_col
+000714e0: 6f72 203d 206e 6578 7428 636f 6c6f 7273  or = next(colors
+000714f0: 290d 0a20 2020 2020 2020 2066 6f72 206c  )..        for l
+00071500: 2069 6e20 6e70 2e61 7261 6e67 6528 636f   in np.arange(co
+00071510: 6c29 3a0d 0a20 2020 2020 2020 2020 2020  l):..           
+00071520: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00071530: 2020 2020 2020 2069 6620 636f 6c3d 3d31         if col==1
+00071540: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00071550: 2020 2020 2020 2069 6620 726f 7720 3d3d         if row ==
+00071560: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00071570: 2020 2020 2020 2020 2020 2020 2078 203d               x =
+00071580: 2064 665b 3a5d 0d0a 2020 2020 2020 2020   df[:]..        
+00071590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000715a0: 7920 3d20 6466 325b 3a5d 0d0a 2020 2020  y = df2[:]..    
+000715b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000715c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000715d0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+000715e0: 203d 2064 665b 3a2c 6b5d 0d0a 2020 2020   = df[:,k]..    
 000715f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071600: 2020 2020 2020 2020 6178 312e 6178 766c          ax1.axvl
-00071610: 696e 6528 636f 6c6f 723d 276b 2729 0d0a  ine(color='k')..
-00071620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071630: 2020 2020 2020 2020 6178 312e 7365 745f          ax1.set_
-00071640: 7469 746c 6528 2752 6573 6964 7561 6c73  title('Residuals
-00071650: 2050 6c6f 7420 666f 7220 5461 7267 6574   Plot for Target
-00071660: 203d 2025 7327 2025 6e75 6d5f 7661 7273   = %s' %num_vars
-00071670: 5b6b 5d29 0d0a 2020 2020 2020 2020 2020  [k])..          
-00071680: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00071690: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-000716a0: 6c20 3d3d 2031 3a0d 0a20 2020 2020 2020  l == 1:..       
-000716b0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-000716c0: 6e74 6572 202b 3d20 310d 0a20 2020 2020  nter += 1..     
-000716d0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000716e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000716f0: 2020 2020 2020 6178 5b6b 5d5b 6c5d 2e73        ax[k][l].s
-00071700: 6574 5f74 6974 6c65 2827 4e6f 2050 7265  et_title('No Pre
-00071710: 6469 6374 6564 2076 7320 4163 7475 616c  dicted vs Actual
-00071720: 7320 506c 6f74 2066 6f72 2070 6c6f 7420  s Plot for plot 
-00071730: 6173 2025 7320 6973 206e 6f74 206e 756d  as %s is not num
-00071740: 6572 6963 2720 256e 756d 5f76 6172 735b  eric' %num_vars[
-00071750: 6b5d 290d 0a20 2020 2020 2020 2020 2020  k])..           
-00071760: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
-00071770: 202b 3d20 310d 0a20 2020 2070 7269 6e74   += 1..    print
-00071780: 2827 5265 6772 6573 7369 6f6e 2050 6c6f  ('Regression Plo
-00071790: 7473 2063 6f6d 706c 6574 6564 2069 6e20  ts completed in 
-000717a0: 2530 2e33 6620 7365 636f 6e64 7327 2025  %0.3f seconds' %
-000717b0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-000717c0: 7274 5f74 696d 6529 290d 0a23 2323 2323  rt_time))..#####
-000717d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000717e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000717f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071810: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-00071820: 2070 7269 6e74 5f72 6567 7265 7373 696f   print_regressio
-00071830: 6e5f 6d6f 6465 6c5f 7374 6174 7328 6163  n_model_stats(ac
-00071840: 7475 616c 732c 2070 7265 6469 6374 6564  tuals, predicted
-00071850: 2c20 7461 7267 6574 733d 2727 2c20 706c  , targets='', pl
-00071860: 6f74 5f6e 616d 653d 2727 293a 0d0a 2020  ot_name=''):..  
-00071870: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
-00071880: 7072 6f67 7261 6d20 7072 696e 7473 2061  program prints a
-00071890: 6e64 2072 6574 7572 6e73 204d 4145 2c20  nd returns MAE, 
-000718a0: 524d 5345 2c20 4d41 5045 2e0d 0a20 2020  RMSE, MAPE...   
-000718b0: 2049 6620 796f 7520 6c69 6b65 2074 6865   If you like the
-000718c0: 204d 4145 2061 6e64 2052 4d53 4520 746f   MAE and RMSE to
-000718d0: 2068 6176 6520 6120 7469 746c 6520 6f72   have a title or
-000718e0: 2073 6f6d 6574 6869 6e67 2c20 6a75 7374   something, just
-000718f0: 2067 6976 6520 7468 6174 0d0a 2020 2020   give that..    
-00071900: 696e 2074 6865 2069 6e70 7574 2061 7320  in the input as 
-00071910: 2274 6974 6c65 2220 616e 6420 6974 2077  "title" and it w
-00071920: 696c 6c20 7072 696e 7420 7468 6174 2074  ill print that t
-00071930: 6974 6c65 206f 6e20 7468 6520 4d41 4520  itle on the MAE 
-00071940: 616e 6420 524d 5345 2061 7320 610d 0a20  and RMSE as a.. 
-00071950: 2020 2063 6861 7274 2066 6f72 2074 6861     chart for tha
-00071960: 7420 6d6f 6465 6c2e 2052 6574 7572 6e73  t model. Returns
-00071970: 204d 4145 2c20 4d41 455f 6173 5f70 6572   MAE, MAE_as_per
-00071980: 6365 6e74 6167 652c 2061 6e64 2052 4d53  centage, and RMS
-00071990: 455f 6173 5f70 6572 6365 6e74 6167 650d  E_as_percentage.
-000719a0: 0a20 2020 2022 2222 0d0a 2020 2020 6966  .    """..    if
-000719b0: 2069 7369 6e73 7461 6e63 6528 6163 7475   isinstance(actu
-000719c0: 616c 732c 7064 2e53 6572 6965 7329 206f  als,pd.Series) o
-000719d0: 7220 6973 696e 7374 616e 6365 2861 6374  r isinstance(act
-000719e0: 7561 6c73 2c70 642e 4461 7461 4672 616d  uals,pd.DataFram
-000719f0: 6529 3a0d 0a20 2020 2020 2020 2061 6374  e):..        act
-00071a00: 7561 6c73 203d 2061 6374 7561 6c73 2e76  uals = actuals.v
-00071a10: 616c 7565 730d 0a20 2020 2069 6620 6973  alues..    if is
-00071a20: 696e 7374 616e 6365 2870 7265 6469 6374  instance(predict
-00071a30: 6564 2c70 642e 5365 7269 6573 2920 6f72  ed,pd.Series) or
-00071a40: 2069 7369 6e73 7461 6e63 6528 7072 6564   isinstance(pred
-00071a50: 6963 7465 642c 7064 2e44 6174 6146 7261  icted,pd.DataFra
-00071a60: 6d65 293a 0d0a 2020 2020 2020 2020 7072  me):..        pr
-00071a70: 6564 6963 7465 6420 3d20 7072 6564 6963  edicted = predic
-00071a80: 7465 642e 7661 6c75 6573 0d0a 2020 2020  ted.values..    
-00071a90: 6966 206c 656e 2861 6374 7561 6c73 2920  if len(actuals) 
-00071aa0: 213d 206c 656e 2870 7265 6469 6374 6564  != len(predicted
-00071ab0: 293a 0d0a 2020 2020 2020 2020 7072 696e  ):..        prin
-00071ac0: 7428 2745 7272 6f72 3a20 4e75 6d62 6572  t('Error: Number
-00071ad0: 206f 6620 6163 7475 616c 7320 616e 6420   of actuals and 
-00071ae0: 7072 6564 6963 7465 6420 646f 6e74 206d  predicted dont m
-00071af0: 6174 6368 2e20 436f 6e74 696e 7569 6e67  atch. Continuing
-00071b00: 2e2e 2e27 290d 0a20 2020 2069 6620 7461  ...')..    if ta
-00071b10: 7267 6574 7320 3d3d 2022 223a 0d0a 2020  rgets == "":..  
-00071b20: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00071b30: 2020 2020 2020 2020 2323 2320 5468 6973          ### This
-00071b40: 2069 7320 666f 7220 4d75 6c74 695f 4c61   is for Multi_La
-00071b50: 6265 6c20 5072 6f62 6c65 6d73 2023 2323  bel Problems ###
-00071b60: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
-00071b70: 7365 7274 2061 6374 7561 6c73 2e73 6861  sert actuals.sha
-00071b80: 7065 5b31 5d0d 0a20 2020 2020 2020 2020  pe[1]..         
-00071b90: 2020 206d 756c 7469 5f6c 6162 656c 203d     multi_label =
-00071ba0: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
-00071bb0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00071bc0: 2861 6374 7561 6c73 2c70 642e 5365 7269  (actuals,pd.Seri
-00071bd0: 6573 293a 0d0a 2020 2020 2020 2020 2020  es):..          
-00071be0: 2020 2020 2020 636f 6c73 203d 205b 6163        cols = [ac
-00071bf0: 7475 616c 732e 6e61 6d65 5d0d 0a20 2020  tuals.name]..   
-00071c00: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-00071c10: 696e 7374 616e 6365 2861 6374 7561 6c73  instance(actuals
-00071c20: 2c70 642e 4461 7461 4672 616d 6529 3a0d  ,pd.DataFrame):.
-00071c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00071c40: 2063 6f6c 7320 3d20 6163 7475 616c 732e   cols = actuals.
-00071c50: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
-00071c60: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00071c70: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00071c80: 2020 2020 2063 6f6c 7320 3d20 5b27 7461       cols = ['ta
-00071c90: 7267 6574 5f27 2b73 7472 2869 2920 666f  rget_'+str(i) fo
-00071ca0: 7220 6920 696e 2072 616e 6765 2861 6374  r i in range(act
-00071cb0: 7561 6c73 2e73 6861 7065 5b31 5d29 5d0d  uals.shape[1])].
-00071cc0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00071cd0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-00071ce0: 2323 2054 4869 7320 6973 2066 6f72 2053  ## THis is for S
-00071cf0: 696e 676c 6520 4c61 6265 6c20 7072 6f62  ingle Label prob
-00071d00: 6c65 6d73 2023 2323 2323 0d0a 2020 2020  lems #####..    
-00071d10: 2020 2020 2020 2020 6d75 6c74 695f 6c61          multi_la
-00071d20: 6265 6c20 3d20 4661 6c73 650d 0a20 2020  bel = False..   
-00071d30: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00071d40: 7374 616e 6365 2861 6374 7561 6c73 2c70  stance(actuals,p
-00071d50: 642e 5365 7269 6573 293a 0d0a 2020 2020  d.Series):..    
-00071d60: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00071d70: 203d 205b 6163 7475 616c 732e 6e61 6d65   = [actuals.name
-00071d80: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00071d90: 6c69 6620 6973 696e 7374 616e 6365 2861  lif isinstance(a
-00071da0: 6374 7561 6c73 2c70 642e 4461 7461 4672  ctuals,pd.DataFr
-00071db0: 616d 6529 3a0d 0a20 2020 2020 2020 2020  ame):..         
-00071dc0: 2020 2020 2020 2063 6f6c 7320 3d20 6163         cols = ac
-00071dd0: 7475 616c 732e 636f 6c75 6d6e 732e 746f  tuals.columns.to
-00071de0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-00071df0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00071e00: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
-00071e10: 3d20 5b27 7461 7267 6574 5f31 275d 0d0a  = ['target_1']..
-00071e20: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00071e30: 2020 2063 6f6c 7320 3d20 636f 7079 2e64     cols = copy.d
-00071e40: 6565 7063 6f70 7928 7461 7267 6574 7329  eepcopy(targets)
-00071e50: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-00071e60: 6e73 7461 6e63 6528 7461 7267 6574 732c  nstance(targets,
-00071e70: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-00071e80: 2020 2020 636f 6c73 203d 205b 7461 7267      cols = [targ
-00071e90: 6574 735d 0d0a 2020 2020 2020 2020 6966  ets]..        if
-00071ea0: 206c 656e 2863 6f6c 7329 203d 3d20 313a   len(cols) == 1:
-00071eb0: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
-00071ec0: 6c74 695f 6c61 6265 6c20 3d20 4661 6c73  lti_label = Fals
-00071ed0: 650d 0a20 2020 2020 2020 2065 6c73 653a  e..        else:
-00071ee0: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
-00071ef0: 6c74 695f 6c61 6265 6c20 3d20 5472 7565  lti_label = True
-00071f00: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
-00071f10: 2020 2020 706c 6f74 5f72 6567 7265 7373      plot_regress
-00071f20: 696f 6e5f 7363 6174 7465 7273 2861 6374  ion_scatters(act
-00071f30: 7561 6c73 2c70 7265 6469 6374 6564 2c63  uals,predicted,c
-00071f40: 6f6c 732c 706c 6f74 5f6e 616d 653d 706c  ols,plot_name=pl
-00071f50: 6f74 5f6e 616d 6529 0d0a 2020 2020 6578  ot_name)..    ex
-00071f60: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
-00071f70: 7269 6e74 2827 436f 756c 6420 6e6f 7420  rint('Could not 
-00071f80: 6472 6177 2072 6567 7265 7373 696f 6e20  draw regression 
-00071f90: 706c 6f74 2062 7574 2063 6f6e 7469 6e75  plot but continu
-00071fa0: 696e 672e 2e2e 2729 0d0a 2020 2020 6966  ing...')..    if
-00071fb0: 206d 756c 7469 5f6c 6162 656c 3a0d 0a20   multi_label:.. 
-00071fc0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00071fd0: 7261 6e67 6528 6163 7475 616c 732e 7368  range(actuals.sh
-00071fe0: 6170 655b 315d 293a 0d0a 2020 2020 2020  ape[1]):..      
-00071ff0: 2020 2020 2020 6163 7475 616c 735f 7820        actuals_x 
-00072000: 3d20 6163 7475 616c 735b 3a2c 695d 0d0a  = actuals[:,i]..
-00072010: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00072020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00072030: 2020 7072 6564 6963 7465 645f 7820 3d20    predicted_x = 
-00072040: 7072 6564 6963 7465 645b 3a2c 695d 0d0a  predicted[:,i]..
-00072050: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00072060: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00072070: 2020 2020 2070 7265 6469 6374 6564 5f78       predicted_x
-00072080: 203d 2070 7265 6469 6374 6564 5b3a 5d0d   = predicted[:].
-00072090: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000720a0: 6e74 2827 5265 6772 6573 7369 6f6e 204d  nt('Regression M
-000720b0: 6574 7269 6373 2066 6f72 2054 6172 6765  etrics for Targe
-000720c0: 743d 2573 2720 2563 6f6c 735b 695d 290d  t=%s' %cols[i]).
-000720d0: 0a20 2020 2020 2020 2020 2020 206d 6165  .            mae
-000720e0: 2c20 6d61 655f 6173 702c 2072 6d73 655f  , mae_asp, rmse_
-000720f0: 6173 7020 3d20 7072 696e 745f 7265 6772  asp = print_regr
-00072100: 6573 7369 6f6e 5f6d 6574 7269 6373 2861  ession_metrics(a
-00072110: 6374 7561 6c73 5f78 2c20 7072 6564 6963  ctuals_x, predic
-00072120: 7465 645f 7829 0d0a 2020 2020 656c 7365  ted_x)..    else
-00072130: 3a0d 0a20 2020 2020 2020 206d 6165 2c20  :..        mae, 
-00072140: 6d61 655f 6173 702c 2072 6d73 655f 6173  mae_asp, rmse_as
-00072150: 7020 3d20 7072 696e 745f 7265 6772 6573  p = print_regres
-00072160: 7369 6f6e 5f6d 6574 7269 6373 2861 6374  sion_metrics(act
-00072170: 7561 6c73 2c20 7072 6564 6963 7465 6429  uals, predicted)
-00072180: 0d0a 2020 2020 7265 7475 726e 206d 6165  ..    return mae
-00072190: 2c20 6d61 655f 6173 702c 2072 6d73 655f  , mae_asp, rmse_
-000721a0: 6173 700d 0a23 2323 2323 2323 2323 2323  asp..###########
-000721b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000721c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000721d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000721e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000721f0: 2323 2323 230d 0a64 6566 2070 7269 6e74  #####..def print
-00072200: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
-00072210: 6963 7328 6163 7475 616c 732c 2070 7265  ics(actuals, pre
-00072220: 6469 6374 6564 293a 0d0a 2020 2020 6d61  dicted):..    ma
-00072230: 6520 3d20 6d65 616e 5f61 6273 6f6c 7574  e = mean_absolut
-00072240: 655f 6572 726f 7228 6163 7475 616c 732c  e_error(actuals,
-00072250: 2070 7265 6469 6374 6564 290d 0a20 2020   predicted)..   
-00072260: 206d 6165 5f61 7370 203d 2028 6d65 616e   mae_asp = (mean
-00072270: 5f61 6273 6f6c 7574 655f 6572 726f 7228  _absolute_error(
-00072280: 6163 7475 616c 732c 2070 7265 6469 6374  actuals, predict
-00072290: 6564 292f 6163 7475 616c 732e 7374 6428  ed)/actuals.std(
-000722a0: 2929 2a31 3030 0d0a 2020 2020 726d 7365  ))*100..    rmse
-000722b0: 5f61 7370 203d 2028 6e70 2e73 7172 7428  _asp = (np.sqrt(
-000722c0: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-000722d0: 6f72 2861 6374 7561 6c73 2c70 7265 6469  or(actuals,predi
-000722e0: 6374 6564 2929 2f61 6374 7561 6c73 2e73  cted))/actuals.s
-000722f0: 7464 2829 292a 3130 300d 0a20 2020 2072  td())*100..    r
-00072300: 6d73 6520 3d20 7072 696e 745f 726d 7365  mse = print_rmse
-00072310: 2861 6374 7561 6c73 2c20 7072 6564 6963  (actuals, predic
-00072320: 7465 6429 0d0a 2020 2020 5f20 3d20 7072  ted)..    _ = pr
-00072330: 696e 745f 6d61 7065 2861 6374 7561 6c73  int_mape(actuals
-00072340: 2c20 7072 6564 6963 7465 6429 0d0a 2020  , predicted)..  
-00072350: 2020 6d61 7065 203d 2070 7269 6e74 5f6d    mape = print_m
-00072360: 6170 6528 6163 7475 616c 732c 2070 7265  ape(actuals, pre
-00072370: 6469 6374 6564 290d 0a20 2020 2070 7269  dicted)..    pri
-00072380: 6e74 2827 2020 2020 4d41 4520 3d20 2530  nt('    MAE = %0
-00072390: 2e34 6627 2025 6d61 6529 0d0a 2020 2020  .4f' %mae)..    
-000723a0: 7072 696e 7428 2220 2020 204d 4150 4520  print("    MAPE 
-000723b0: 3d20 2530 2e30 6625 2520 284d 4150 4520  = %0.0f%% (MAPE 
-000723c0: 7769 6c6c 2062 6520 7665 7279 2068 6967  will be very hig
-000723d0: 6820 7768 656e 207a 6572 6f73 2069 6e20  h when zeros in 
-000723e0: 6163 7475 616c 7329 2220 2528 6d61 7065  actuals)" %(mape
-000723f0: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
-00072400: 2020 2052 4d53 4520 3d20 2530 2e34 6627     RMSE = %0.4f'
-00072410: 2025 726d 7365 290d 0a20 2020 2070 7269   %rmse)..    pri
-00072420: 6e74 2827 2020 2020 4e6f 726d 616c 697a  nt('    Normaliz
-00072430: 6564 204d 4145 2028 6173 2025 2520 7374  ed MAE (as %% st
-00072440: 6420 6465 7620 6f66 2041 6374 7561 6c73  d dev of Actuals
-00072450: 2920 3d20 2530 2e30 6625 2527 2025 286d  ) = %0.0f%%' %(m
-00072460: 6165 2f61 6273 2861 6374 7561 6c73 292e  ae/abs(actuals).
-00072470: 7374 6428 292a 3130 3029 290d 0a20 2020  std()*100))..   
-00072480: 2023 204e 6f72 6d61 6c69 7a65 6420 524d   # Normalized RM
-00072490: 5345 2070 7269 6e74 2827 524d 5345 203d  SE print('RMSE =
-000724a0: 207b 3a2c 2e4f 667d 272e 666f 726d 6174   {:,.Of}'.format
-000724b0: 2872 6d73 6529 290d 0a20 2020 2023 7072  (rmse))..    #pr
-000724c0: 696e 7428 2720 2020 204e 6f72 6d61 6c69  int('    Normali
-000724d0: 7a65 6420 524d 5345 2028 2525 206f 6620  zed RMSE (%% of 
-000724e0: 4d69 6e4d 6178 206f 6620 4163 7475 616c  MinMax of Actual
-000724f0: 7329 203d 2025 302e 3066 2525 2720 2528  s) = %0.0f%%' %(
-00072500: 3130 302a 726d 7365 2f61 6273 2861 6374  100*rmse/abs(act
-00072510: 7561 6c73 2e6d 6178 2829 2d61 6374 7561  uals.max()-actua
-00072520: 6c73 2e6d 696e 2829 2929 290d 0a20 2020  ls.min())))..   
-00072530: 2070 7269 6e74 2827 2020 2020 4e6f 726d   print('    Norm
-00072540: 616c 697a 6564 2052 4d53 4520 2825 2520  alized RMSE (%% 
-00072550: 6f66 2053 7464 2044 6576 206f 6620 4163  of Std Dev of Ac
-00072560: 7475 616c 7329 203d 2025 302e 3066 2525  tuals) = %0.0f%%
-00072570: 2720 2528 3130 302a 726d 7365 2f61 6374  ' %(100*rmse/act
-00072580: 7561 6c73 2e73 7464 2829 2929 0d0a 2020  uals.std()))..  
-00072590: 2020 7265 7475 726e 206d 6165 2c20 6d61    return mae, ma
-000725a0: 655f 6173 702c 2072 6d73 655f 6173 700d  e_asp, rmse_asp.
-000725b0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-000725c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000725d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000725e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000725f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072600: 230d 0a64 6566 2070 7269 6e74 5f73 7461  #..def print_sta
-00072610: 7469 635f 726d 7365 2861 6374 7561 6c2c  tic_rmse(actual,
-00072620: 2070 7265 6469 6374 6564 2c20 7374 6172   predicted, star
-00072630: 745f 6672 6f6d 3d30 2c76 6572 626f 7365  t_from=0,verbose
-00072640: 3d30 293a 0d0a 2020 2020 2222 220d 0a20  =0):..    """.. 
-00072650: 2020 2074 6869 7320 6361 6c63 756c 6174     this calculat
-00072660: 6573 2074 6865 2072 6174 696f 206f 6620  es the ratio of 
-00072670: 7468 6520 726d 7365 2065 7272 6f72 2074  the rmse error t
-00072680: 6f20 7468 6520 7374 616e 6461 7264 2064  o the standard d
-00072690: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
-000726a0: 6163 7475 616c 732e 0d0a 2020 2020 5468  actuals...    Th
-000726b0: 6973 2072 6174 696f 2073 686f 756c 6420  is ratio should 
-000726c0: 6265 2062 656c 6f77 2031 2066 6f72 2061  be below 1 for a
-000726d0: 206d 6f64 656c 2074 6f20 6265 2063 6f6e   model to be con
-000726e0: 7369 6465 7265 6420 7573 6566 756c 2e0d  sidered useful..
-000726f0: 0a20 2020 2054 6865 2063 6f6d 7061 7269  .    The compari
-00072700: 736f 6e20 7374 6172 7473 2066 726f 6d20  son starts from 
-00072710: 7468 6520 726f 7720 696e 6469 6361 7465  the row indicate
-00072720: 6420 696e 2074 6865 2022 7374 6172 745f  d in the "start_
-00072730: 6672 6f6d 2220 7661 7269 6162 6c65 2e0d  from" variable..
-00072740: 0a20 2020 2022 2222 0d0a 2020 2020 726d  .    """..    rm
-00072750: 7365 203d 206e 702e 7371 7274 286d 6561  se = np.sqrt(mea
-00072760: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
-00072770: 6163 7475 616c 5b73 7461 7274 5f66 726f  actual[start_fro
-00072780: 6d3a 5d2c 7072 6564 6963 7465 645b 7374  m:],predicted[st
-00072790: 6172 745f 6672 6f6d 3a5d 2929 0d0a 2020  art_from:]))..  
-000727a0: 2020 7374 645f 6465 7620 3d20 6163 7475    std_dev = actu
-000727b0: 616c 5b73 7461 7274 5f66 726f 6d3a 5d2e  al[start_from:].
-000727c0: 7374 6428 290d 0a20 2020 2069 6620 7665  std()..    if ve
-000727d0: 7262 6f73 6520 3e3d 2031 3a0d 0a20 2020  rbose >= 1:..   
-000727e0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-000727f0: 524d 5345 203d 2025 302e 3266 2720 2572  RMSE = %0.2f' %r
-00072800: 6d73 6529 0d0a 2020 2020 2020 2020 7072  mse)..        pr
-00072810: 696e 7428 2720 2020 2053 7464 2044 6576  int('    Std Dev
-00072820: 6961 7469 6f6e 206f 6620 4163 7475 616c  iation of Actual
-00072830: 7320 3d20 2530 2e32 6627 2025 2873 7464  s = %0.2f' %(std
-00072840: 5f64 6576 2929 0d0a 2020 2020 2020 2020  _dev))..        
-00072850: 7072 696e 7428 2720 2020 204e 6f72 6d61  print('    Norma
-00072860: 6c69 7a65 6420 524d 5345 203d 2025 302e  lized RMSE = %0.
-00072870: 3166 2525 2720 2528 726d 7365 2a31 3030  1f%%' %(rmse*100
-00072880: 2f73 7464 5f64 6576 2929 0d0a 2020 2020  /std_dev))..    
-00072890: 7265 7475 726e 2072 6d73 652c 2072 6d73  return rmse, rms
-000728a0: 652f 7374 645f 6465 760d 0a23 2323 2323  e/std_dev..#####
-000728b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000728c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000728d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000728e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000728f0: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
-00072900: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-00072910: 7320 696d 706f 7274 206d 6561 6e5f 7371  s import mean_sq
-00072920: 7561 7265 645f 6572 726f 722c 6d65 616e  uared_error,mean
-00072930: 5f61 6273 6f6c 7574 655f 6572 726f 720d  _absolute_error.
-00072940: 0a64 6566 2070 7269 6e74 5f72 6d73 6528  .def print_rmse(
-00072950: 792c 2079 5f68 6174 293a 0d0a 2020 2020  y, y_hat):..    
-00072960: 2222 220d 0a20 2020 2043 616c 6375 6c61  """..    Calcula
-00072970: 7469 6e67 2052 6f6f 7420 4d65 616e 2053  ting Root Mean S
-00072980: 7175 6172 6520 4572 726f 7220 6874 7470  quare Error http
-00072990: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-000729a0: 2e6f 7267 2f77 696b 692f 526f 6f74 2d6d  .org/wiki/Root-m
-000729b0: 6561 6e2d 7371 7561 7265 5f64 6576 6961  ean-square_devia
-000729c0: 7469 6f6e 0d0a 2020 2020 2222 220d 0a20  tion..    """.. 
-000729d0: 2020 206d 7365 203d 206e 702e 6d65 616e     mse = np.mean
-000729e0: 2828 7920 2d20 795f 6861 7429 2a2a 3229  ((y - y_hat)**2)
-000729f0: 0d0a 2020 2020 7265 7475 726e 206e 702e  ..    return np.
-00072a00: 7371 7274 286d 7365 290d 0a0d 0a64 6566  sqrt(mse)....def
-00072a10: 2070 7269 6e74 5f6d 6170 6528 792c 2079   print_mape(y, y
-00072a20: 5f68 6174 293a 0d0a 2020 2020 2222 220d  _hat):..    """.
-00072a30: 0a20 2020 2043 616c 6375 6c61 7469 6e67  .    Calculating
-00072a40: 204d 6561 6e20 4162 736f 6c75 7465 2050   Mean Absolute P
-00072a50: 6572 6365 6e74 2045 7272 6f72 2068 7474  ercent Error htt
-00072a60: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
-00072a70: 612e 6f72 672f 7769 6b69 2f4d 6561 6e5f  a.org/wiki/Mean_
-00072a80: 6162 736f 6c75 7465 5f70 6572 6365 6e74  absolute_percent
-00072a90: 6167 655f 6572 726f 720d 0a20 2020 2054  age_error..    T
-00072aa0: 6f20 6176 6f69 6420 696e 6669 6e69 7479  o avoid infinity
-00072ab0: 2064 7565 2074 6f20 6469 7669 7369 6f6e   due to division
-00072ac0: 2062 7920 7a65 726f 2c20 7765 2073 656c   by zero, we sel
-00072ad0: 6563 7420 6d61 7828 302e 3031 2c20 6162  ect max(0.01, ab
-00072ae0: 7328 6163 7475 616c 7329 2920 746f 2073  s(actuals)) to s
-00072af0: 686f 7720 4d41 5045 2e0d 0a20 2020 2022  how MAPE...    "
-00072b00: 2222 0d0a 2020 2020 2323 2320 5768 6572  ""..    ### Wher
-00072b10: 6576 6572 2074 6865 7265 2069 7320 7a65  ever there is ze
-00072b20: 726f 2c20 7265 706c 6163 6520 6974 2077  ro, replace it w
-00072b30: 6974 6820 302e 3030 3120 736f 2069 7420  ith 0.001 so it 
-00072b40: 646f 6573 6e27 7420 7265 7375 6c74 2069  doesn't result i
-00072b50: 6e20 6469 7669 7369 6f6e 2062 7920 7a65  n division by ze
-00072b60: 726f 0d0a 2020 2020 7065 7263 5f65 7272  ro..    perc_err
-00072b70: 203d 2028 3130 302a 286e 702e 7768 6572   = (100*(np.wher
-00072b80: 6528 793d 3d30 2c30 2e30 3031 2c79 2920  e(y==0,0.001,y) 
-00072b90: 2d20 795f 6861 7429 292f 6e70 2e77 6865  - y_hat))/np.whe
-00072ba0: 7265 2879 3d3d 302c 302e 3030 312c 7929  re(y==0,0.001,y)
-00072bb0: 0d0a 2020 2020 7265 7475 726e 206e 702e  ..    return np.
-00072bc0: 6d65 616e 2861 6273 2870 6572 635f 6572  mean(abs(perc_er
-00072bd0: 7229 290d 0a23 2323 2323 2323 2323 2323  r))..###########
-00072be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072c10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072c20: 2323 2323 230d 0a66 726f 6d20 736b 6c65  #####..from skle
-00072c30: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
-00072c40: 7274 206d 6561 6e5f 6162 736f 6c75 7465  rt mean_absolute
-00072c50: 5f65 7272 6f72 2c20 6d65 616e 5f73 7175  _error, mean_squ
-00072c60: 6172 6564 5f65 7272 6f72 0d0a 6672 6f6d  ared_error..from
-00072c70: 2069 7465 7274 6f6f 6c73 2069 6d70 6f72   itertools impor
-00072c80: 7420 6379 636c 650d 0a69 6d70 6f72 7420  t cycle..import 
-00072c90: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-00072ca0: 7420 6173 2070 6c74 0d0a 6465 6620 706c  t as plt..def pl
-00072cb0: 6f74 5f64 6670 6c6f 7428 6466 706c 6f74  ot_dfplot(dfplot
-00072cc0: 2c70 6c6f 745f 7469 746c 653d 2222 293a  ,plot_title=""):
-00072cd0: 0d0a 2020 2020 6669 6773 697a 6520 3d20  ..    figsize = 
-00072ce0: 2831 302c 2031 3029 0d0a 2020 2020 636f  (10, 10)..    co
-00072cf0: 6c6f 7273 203d 2063 7963 6c65 2827 6279  lors = cycle('by
-00072d00: 7263 6d67 6b62 7972 636d 676b 6279 7263  rcmgkbyrcmgkbyrc
-00072d10: 6d67 6b62 7972 636d 676b 2729 0d0a 2020  mgkbyrcmgk')..  
-00072d20: 2020 706c 742e 6669 6775 7265 2866 6967    plt.figure(fig
-00072d30: 7369 7a65 3d66 6967 7369 7a65 290d 0a20  size=figsize).. 
-00072d40: 2020 2061 6374 7561 6c73 203d 2064 6670     actuals = dfp
-00072d50: 6c6f 745b 2741 6374 7561 6c73 275d 0d0a  lot['Actuals']..
-00072d60: 2020 2020 7072 6564 6963 7465 6420 3d20      predicted = 
-00072d70: 2064 6670 6c6f 745b 2750 7265 6469 6374   dfplot['Predict
-00072d80: 6564 275d 0d0a 2020 2020 6c69 6e65 5374  ed']..    lineSt
-00072d90: 6172 7420 3d20 6163 7475 616c 732e 6d69  art = actuals.mi
-00072da0: 6e28 290d 0a20 2020 206c 696e 6545 6e64  n()..    lineEnd
-00072db0: 203d 2061 6374 7561 6c73 2e6d 6178 2829   = actuals.max()
-00072dc0: 0d0a 2020 2020 706c 742e 7363 6174 7465  ..    plt.scatte
-00072dd0: 7228 6163 7475 616c 732c 2070 7265 6469  r(actuals, predi
-00072de0: 6374 6564 2c20 636f 6c6f 7220 3d20 6e65  cted, color = ne
-00072df0: 7874 2863 6f6c 6f72 7329 2c20 616c 7068  xt(colors), alph
-00072e00: 613d 302e 352c 6c61 6265 6c3d 2750 7265  a=0.5,label='Pre
-00072e10: 6469 6374 696f 6e73 2729 0d0a 2020 2020  dictions')..    
-00072e20: 706c 742e 706c 6f74 285b 6c69 6e65 5374  plt.plot([lineSt
-00072e30: 6172 742c 206c 696e 6545 6e64 5d2c 205b  art, lineEnd], [
-00072e40: 6c69 6e65 5374 6172 742c 206c 696e 6545  lineStart, lineE
-00072e50: 6e64 5d2c 2027 6b2d 272c 2063 6f6c 6f72  nd], 'k-', color
-00072e60: 203d 206e 6578 7428 636f 6c6f 7273 2929   = next(colors))
-00072e70: 0d0a 2020 2020 706c 742e 786c 696d 286c  ..    plt.xlim(l
-00072e80: 696e 6553 7461 7274 2c20 6c69 6e65 456e  ineStart, lineEn
-00072e90: 6429 0d0a 2020 2020 706c 742e 796c 696d  d)..    plt.ylim
-00072ea0: 286c 696e 6553 7461 7274 2c20 6c69 6e65  (lineStart, line
-00072eb0: 456e 6429 0d0a 2020 2020 706c 742e 786c  End)..    plt.xl
-00072ec0: 6162 656c 2827 4163 7475 616c 2729 0d0a  abel('Actual')..
-00072ed0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-00072ee0: 5072 6564 6963 7465 6427 290d 0a20 2020  Predicted')..   
-00072ef0: 2070 6c74 2e6c 6567 656e 6428 290d 0a20   plt.legend().. 
-00072f00: 2020 2070 6c74 2e74 6974 6c65 2827 5072     plt.title('Pr
-00072f10: 6564 6963 7465 6420 7673 2041 6374 7561  edicted vs Actua
-00072f20: 6c73 2066 6f72 2054 6172 6765 7420 3d20  ls for Target = 
-00072f30: 2573 2720 2570 6c6f 745f 7469 746c 652c  %s' %plot_title,
-00072f40: 2066 6f6e 7473 697a 653d 3132 290d 0a20   fontsize=12).. 
-00072f50: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
-00072f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072fa0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00072fb0: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
-00072fc0: 7320 696d 706f 7274 2064 6566 6175 6c74  s import default
-00072fd0: 6469 6374 0d0a 6465 6620 7265 7475 726e  dict..def return
-00072fe0: 5f6c 6973 745f 6d61 7463 6869 6e67 5f6b  _list_matching_k
-00072ff0: 6579 7328 6469 6374 6f2c 6c69 7374 5f6b  eys(dicto,list_k
-00073000: 6579 7329 3a0d 0a20 2020 2027 2727 5265  eys):..    '''Re
-00073010: 7475 726e 2061 206c 6973 7420 6f66 2076  turn a list of v
-00073020: 616c 7565 7320 6d61 7463 6869 6e67 206b  alues matching k
-00073030: 6579 7320 696e 2061 2064 6963 7469 6f6e  eys in a diction
-00073040: 6172 790d 0a20 2020 2066 726f 6d20 6120  ary..    from a 
-00073050: 6c69 7374 206f 6620 6b65 7973 2e20 5265  list of keys. Re
-00073060: 7475 726e 7320 5661 6c75 6573 2069 6e20  turns Values in 
-00073070: 7468 6520 5361 6d65 206f 7264 6572 2061  the Same order a
-00073080: 7320 7468 6520 4c69 7374 204b 6579 732e  s the List Keys.
-00073090: 0d0a 2020 2020 2727 270d 0a20 2020 2072  ..    '''..    r
-000730a0: 6573 756c 7473 203d 205b 5d0d 0a20 2020  esults = []..   
-000730b0: 2066 6f72 2065 6163 6820 696e 206c 6973   for each in lis
-000730c0: 745f 6b65 7973 3a0d 0a20 2020 2020 2020  t_keys:..       
-000730d0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
-000730e0: 6469 6374 6f5b 6561 6368 5d29 0d0a 2020  dicto[each])..  
-000730f0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
-00073100: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00073110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00073120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00073130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071600: 2020 2020 7920 3d20 6466 325b 3a2c 6b5d      y = df2[:,k]
+00071610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071620: 2020 2020 2020 6178 3120 3d20 6178 5b6b        ax1 = ax[k
+00071630: 5d5b 6c5d 0d0a 2020 2020 2020 2020 2020  ][l]..          
+00071640: 2020 2020 2020 2020 2020 6c69 6e65 5374            lineSt
+00071650: 6172 7420 3d20 782e 6d69 6e28 290d 0a20  art = x.min().. 
+00071660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071670: 2020 206c 696e 6545 6e64 203d 2078 2e6d     lineEnd = x.m
+00071680: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
+00071690: 2020 2020 2020 2020 2020 6178 312e 7363            ax1.sc
+000716a0: 6174 7465 7228 782c 2079 2c20 636f 6c6f  atter(x, y, colo
+000716b0: 723d 726f 775f 636f 6c6f 7229 0d0a 2020  r=row_color)..  
+000716c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000716d0: 2020 6178 312e 706c 6f74 285b 6c69 6e65    ax1.plot([line
+000716e0: 5374 6172 742c 206c 696e 6545 6e64 5d2c  Start, lineEnd],
+000716f0: 205b 6c69 6e65 5374 6172 742c 206c 696e   [lineStart, lin
+00071700: 6545 6e64 5d2c 2027 6b2d 272c 2063 6f6c  eEnd], 'k-', col
+00071710: 6f72 3d72 6f77 5f63 6f6c 6f72 290d 0a20  or=row_color).. 
+00071720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071730: 2020 2061 7831 2e73 6574 5f78 6c61 6265     ax1.set_xlabe
+00071740: 6c28 2741 6374 7561 6c73 2729 0d0a 2020  l('Actuals')..  
+00071750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071760: 2020 6178 312e 7365 745f 796c 6162 656c    ax1.set_ylabel
+00071770: 2827 5072 6564 6963 7465 6427 290d 0a20  ('Predicted').. 
+00071780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071790: 2020 2061 7831 2e73 6574 5f74 6974 6c65     ax1.set_title
+000717a0: 2827 5072 6564 6963 7465 6420 7673 2041  ('Predicted vs A
+000717b0: 6374 7561 6c73 2050 6c6f 7420 666f 7220  ctuals Plot for 
+000717c0: 5461 7267 6574 203d 2025 7327 2025 6e75  Target = %s' %nu
+000717d0: 6d5f 7661 7273 5b6b 5d29 0d0a 2020 2020  m_vars[k])..    
+000717e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000717f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00071800: 2020 2020 2020 2069 6620 726f 7720 3d3d         if row ==
+00071810: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00071820: 2020 2020 2020 2020 2020 2020 2078 203d               x =
+00071830: 2064 665b 3a5d 0d0a 2020 2020 2020 2020   df[:]..        
+00071840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071850: 7920 3d20 6466 325b 3a5d 0d0a 2020 2020  y = df2[:]..    
+00071860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071870: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00071880: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00071890: 203d 2064 665b 3a2c 6b5d 0d0a 2020 2020   = df[:,k]..    
+000718a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000718b0: 2020 2020 7920 3d20 6466 325b 3a2c 6b5d      y = df2[:,k]
+000718c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000718d0: 2020 2020 2020 6c69 6e65 5374 6172 7420        lineStart 
+000718e0: 3d20 782e 6d69 6e28 290d 0a20 2020 2020  = x.min()..     
+000718f0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00071900: 696e 6545 6e64 203d 2078 2e6d 6178 2829  ineEnd = x.max()
+00071910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071920: 2020 2020 2020 6966 206c 203d 3d20 303a        if l == 0:
+00071930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071940: 2020 2020 2020 2020 2020 6178 3120 3d20            ax1 = 
+00071950: 6178 5b6b 5d5b 6c5d 0d0a 2020 2020 2020  ax[k][l]..      
+00071960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071970: 2020 6178 312e 7363 6174 7465 7228 782c    ax1.scatter(x,
+00071980: 2079 2c20 2063 6f6c 6f72 203d 2072 6f77   y,  color = row
+00071990: 5f63 6f6c 6f72 290d 0a20 2020 2020 2020  _color)..       
+000719a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000719b0: 2061 7831 2e70 6c6f 7428 5b6c 696e 6553   ax1.plot([lineS
+000719c0: 7461 7274 2c20 6c69 6e65 456e 645d 2c20  tart, lineEnd], 
+000719d0: 5b6c 696e 6553 7461 7274 2c20 6c69 6e65  [lineStart, line
+000719e0: 456e 645d 2c20 276b 2d27 2c20 636f 6c6f  End], 'k-', colo
+000719f0: 7220 3d20 726f 775f 636f 6c6f 7229 0d0a  r = row_color)..
+00071a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071a10: 2020 2020 2020 2020 6178 312e 7365 745f          ax1.set_
+00071a20: 786c 6162 656c 2827 4163 7475 616c 7327  xlabel('Actuals'
+00071a30: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00071a40: 2020 2020 2020 2020 2020 2061 7831 2e73             ax1.s
+00071a50: 6574 5f79 6c61 6265 6c28 2750 7265 6469  et_ylabel('Predi
+00071a60: 6374 6564 2729 0d0a 2020 2020 2020 2020  cted')..        
+00071a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071a80: 6178 312e 7365 745f 7469 746c 6528 2750  ax1.set_title('P
+00071a90: 7265 6469 6374 6564 2076 7320 4163 7475  redicted vs Actu
+00071aa0: 616c 7320 506c 6f74 2066 6f72 2054 6172  als Plot for Tar
+00071ab0: 6765 7420 3d20 2573 2720 256e 756d 5f76  get = %s' %num_v
+00071ac0: 6172 735b 6b5d 290d 0a20 2020 2020 2020  ars[k])..       
+00071ad0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00071ae0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00071af0: 2020 2020 2020 2020 2020 2020 6178 3120              ax1 
+00071b00: 3d20 6178 5b6b 5d5b 6c5d 0d0a 2020 2020  = ax[k][l]..    
+00071b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071b20: 2020 2020 6178 312e 6869 7374 2828 782d      ax1.hist((x-
+00071b30: 7929 2c20 6465 6e73 6974 793d 5472 7565  y), density=True
+00071b40: 2c63 6f6c 6f72 203d 2072 6f77 5f63 6f6c  ,color = row_col
+00071b50: 6f72 290d 0a20 2020 2020 2020 2020 2020  or)..           
+00071b60: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00071b70: 2e61 7876 6c69 6e65 2863 6f6c 6f72 3d27  .axvline(color='
+00071b80: 6b27 290d 0a20 2020 2020 2020 2020 2020  k')..           
+00071b90: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00071ba0: 2e73 6574 5f74 6974 6c65 2827 5265 7369  .set_title('Resi
+00071bb0: 6475 616c 7320 506c 6f74 2066 6f72 2054  duals Plot for T
+00071bc0: 6172 6765 7420 3d20 2573 2720 256e 756d  arget = %s' %num
+00071bd0: 5f76 6172 735b 6b5d 290d 0a20 2020 2020  _vars[k])..     
+00071be0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+00071bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c00: 6966 2063 6f6c 203d 3d20 313a 0d0a 2020  if col == 1:..  
+00071c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c20: 2020 636f 756e 7465 7220 2b3d 2031 0d0a    counter += 1..
+00071c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c40: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00071c50: 2020 2020 2020 2020 2020 2061 785b 6b5d             ax[k]
+00071c60: 5b6c 5d2e 7365 745f 7469 746c 6528 274e  [l].set_title('N
+00071c70: 6f20 5072 6564 6963 7465 6420 7673 2041  o Predicted vs A
+00071c80: 6374 7561 6c73 2050 6c6f 7420 666f 7220  ctuals Plot for 
+00071c90: 706c 6f74 2061 7320 2573 2069 7320 6e6f  plot as %s is no
+00071ca0: 7420 6e75 6d65 7269 6327 2025 6e75 6d5f  t numeric' %num_
+00071cb0: 7661 7273 5b6b 5d29 0d0a 2020 2020 2020  vars[k])..      
+00071cc0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00071cd0: 756e 7465 7220 2b3d 2031 0d0a 2020 2020  unter += 1..    
+00071ce0: 7072 696e 7428 2752 6567 7265 7373 696f  print('Regressio
+00071cf0: 6e20 506c 6f74 7320 636f 6d70 6c65 7465  n Plots complete
+00071d00: 6420 696e 2025 302e 3366 2073 6563 6f6e  d in %0.3f secon
+00071d10: 6473 2720 2528 7469 6d65 2e74 696d 6528  ds' %(time.time(
+00071d20: 292d 7374 6172 745f 7469 6d65 2929 0d0a  )-start_time))..
+00071d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071d40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00071d80: 0d0a 6465 6620 7072 696e 745f 7265 6772  ..def print_regr
+00071d90: 6573 7369 6f6e 5f6d 6f64 656c 5f73 7461  ession_model_sta
+00071da0: 7473 2861 6374 7561 6c73 2c20 7072 6564  ts(actuals, pred
+00071db0: 6963 7465 642c 2074 6172 6765 7473 3d27  icted, targets='
+00071dc0: 272c 2070 6c6f 745f 6e61 6d65 3d27 2729  ', plot_name='')
+00071dd0: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+00071de0: 5468 6973 2070 726f 6772 616d 2070 7269  This program pri
+00071df0: 6e74 7320 616e 6420 7265 7475 726e 7320  nts and returns 
+00071e00: 4d41 452c 2052 4d53 452c 204d 4150 452e  MAE, RMSE, MAPE.
+00071e10: 0d0a 2020 2020 4966 2079 6f75 206c 696b  ..    If you lik
+00071e20: 6520 7468 6520 4d41 4520 616e 6420 524d  e the MAE and RM
+00071e30: 5345 2074 6f20 6861 7665 2061 2074 6974  SE to have a tit
+00071e40: 6c65 206f 7220 736f 6d65 7468 696e 672c  le or something,
+00071e50: 206a 7573 7420 6769 7665 2074 6861 740d   just give that.
+00071e60: 0a20 2020 2069 6e20 7468 6520 696e 7075  .    in the inpu
+00071e70: 7420 6173 2022 7469 746c 6522 2061 6e64  t as "title" and
+00071e80: 2069 7420 7769 6c6c 2070 7269 6e74 2074   it will print t
+00071e90: 6861 7420 7469 746c 6520 6f6e 2074 6865  hat title on the
+00071ea0: 204d 4145 2061 6e64 2052 4d53 4520 6173   MAE and RMSE as
+00071eb0: 2061 0d0a 2020 2020 6368 6172 7420 666f   a..    chart fo
+00071ec0: 7220 7468 6174 206d 6f64 656c 2e20 5265  r that model. Re
+00071ed0: 7475 726e 7320 4d41 452c 204d 4145 5f61  turns MAE, MAE_a
+00071ee0: 735f 7065 7263 656e 7461 6765 2c20 616e  s_percentage, an
+00071ef0: 6420 524d 5345 5f61 735f 7065 7263 656e  d RMSE_as_percen
+00071f00: 7461 6765 0d0a 2020 2020 2222 220d 0a20  tage..    """.. 
+00071f10: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00071f20: 2861 6374 7561 6c73 2c70 642e 5365 7269  (actuals,pd.Seri
+00071f30: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
+00071f40: 6528 6163 7475 616c 732c 7064 2e44 6174  e(actuals,pd.Dat
+00071f50: 6146 7261 6d65 293a 0d0a 2020 2020 2020  aFrame):..      
+00071f60: 2020 6163 7475 616c 7320 3d20 6163 7475    actuals = actu
+00071f70: 616c 732e 7661 6c75 6573 0d0a 2020 2020  als.values..    
+00071f80: 6966 2069 7369 6e73 7461 6e63 6528 7072  if isinstance(pr
+00071f90: 6564 6963 7465 642c 7064 2e53 6572 6965  edicted,pd.Serie
+00071fa0: 7329 206f 7220 6973 696e 7374 616e 6365  s) or isinstance
+00071fb0: 2870 7265 6469 6374 6564 2c70 642e 4461  (predicted,pd.Da
+00071fc0: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
+00071fd0: 2020 2070 7265 6469 6374 6564 203d 2070     predicted = p
+00071fe0: 7265 6469 6374 6564 2e76 616c 7565 730d  redicted.values.
+00071ff0: 0a20 2020 2069 6620 6c65 6e28 6163 7475  .    if len(actu
+00072000: 616c 7329 2021 3d20 6c65 6e28 7072 6564  als) != len(pred
+00072010: 6963 7465 6429 3a0d 0a20 2020 2020 2020  icted):..       
+00072020: 2070 7269 6e74 2827 4572 726f 723a 204e   print('Error: N
+00072030: 756d 6265 7220 6f66 2061 6374 7561 6c73  umber of actuals
+00072040: 2061 6e64 2070 7265 6469 6374 6564 2064   and predicted d
+00072050: 6f6e 7420 6d61 7463 682e 2043 6f6e 7469  ont match. Conti
+00072060: 6e75 696e 672e 2e2e 2729 0d0a 2020 2020  nuing...')..    
+00072070: 6966 2074 6172 6765 7473 203d 3d20 2222  if targets == ""
+00072080: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
+00072090: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+000720a0: 2054 6869 7320 6973 2066 6f72 204d 756c   This is for Mul
+000720b0: 7469 5f4c 6162 656c 2050 726f 626c 656d  ti_Label Problem
+000720c0: 7320 2323 230d 0a20 2020 2020 2020 2020  s ###..         
+000720d0: 2020 2061 7373 6572 7420 6163 7475 616c     assert actual
+000720e0: 732e 7368 6170 655b 315d 0d0a 2020 2020  s.shape[1]..    
+000720f0: 2020 2020 2020 2020 6d75 6c74 695f 6c61          multi_la
+00072100: 6265 6c20 3d20 5472 7565 0d0a 2020 2020  bel = True..    
+00072110: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00072120: 7461 6e63 6528 6163 7475 616c 732c 7064  tance(actuals,pd
+00072130: 2e53 6572 6965 7329 3a0d 0a20 2020 2020  .Series):..     
+00072140: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
+00072150: 3d20 5b61 6374 7561 6c73 2e6e 616d 655d  = [actuals.name]
+00072160: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00072170: 6966 2069 7369 6e73 7461 6e63 6528 6163  if isinstance(ac
+00072180: 7475 616c 732c 7064 2e44 6174 6146 7261  tuals,pd.DataFra
+00072190: 6d65 293a 0d0a 2020 2020 2020 2020 2020  me):..          
+000721a0: 2020 2020 2020 636f 6c73 203d 2061 6374        cols = act
+000721b0: 7561 6c73 2e63 6f6c 756d 6e73 2e74 6f6c  uals.columns.tol
+000721c0: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
+000721d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000721e0: 2020 2020 2020 2020 2020 636f 6c73 203d            cols =
+000721f0: 205b 2774 6172 6765 745f 272b 7374 7228   ['target_'+str(
+00072200: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
+00072210: 6528 6163 7475 616c 732e 7368 6170 655b  e(actuals.shape[
+00072220: 315d 295d 0d0a 2020 2020 2020 2020 6578  1])]..        ex
+00072230: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00072240: 2020 2023 2323 2320 5448 6973 2069 7320     #### THis is 
+00072250: 666f 7220 5369 6e67 6c65 204c 6162 656c  for Single Label
+00072260: 2070 726f 626c 656d 7320 2323 2323 230d   problems #####.
+00072270: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
+00072280: 7469 5f6c 6162 656c 203d 2046 616c 7365  ti_label = False
+00072290: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000722a0: 2069 7369 6e73 7461 6e63 6528 6163 7475   isinstance(actu
+000722b0: 616c 732c 7064 2e53 6572 6965 7329 3a0d  als,pd.Series):.
+000722c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000722d0: 2063 6f6c 7320 3d20 5b61 6374 7561 6c73   cols = [actuals
+000722e0: 2e6e 616d 655d 0d0a 2020 2020 2020 2020  .name]..        
+000722f0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00072300: 6e63 6528 6163 7475 616c 732c 7064 2e44  nce(actuals,pd.D
+00072310: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00072320: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00072330: 203d 2061 6374 7561 6c73 2e63 6f6c 756d   = actuals.colum
+00072340: 6e73 2e74 6f6c 6973 7428 290d 0a20 2020  ns.tolist()..   
+00072350: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00072360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072370: 636f 6c73 203d 205b 2774 6172 6765 745f  cols = ['target_
+00072380: 3127 5d0d 0a20 2020 2065 6c73 653a 0d0a  1']..    else:..
+00072390: 2020 2020 2020 2020 636f 6c73 203d 2063          cols = c
+000723a0: 6f70 792e 6465 6570 636f 7079 2874 6172  opy.deepcopy(tar
+000723b0: 6765 7473 290d 0a20 2020 2020 2020 2069  gets)..        i
+000723c0: 6620 6973 696e 7374 616e 6365 2874 6172  f isinstance(tar
+000723d0: 6765 7473 2c20 7374 7229 3a0d 0a20 2020  gets, str):..   
+000723e0: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
+000723f0: 5b74 6172 6765 7473 5d0d 0a20 2020 2020  [targets]..     
+00072400: 2020 2069 6620 6c65 6e28 636f 6c73 2920     if len(cols) 
+00072410: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+00072420: 2020 206d 756c 7469 5f6c 6162 656c 203d     multi_label =
+00072430: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+00072440: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00072450: 2020 206d 756c 7469 5f6c 6162 656c 203d     multi_label =
+00072460: 2054 7275 650d 0a20 2020 2074 7279 3a0d   True..    try:.
+00072470: 0a20 2020 2020 2020 2070 6c6f 745f 7265  .        plot_re
+00072480: 6772 6573 7369 6f6e 5f73 6361 7474 6572  gression_scatter
+00072490: 7328 6163 7475 616c 732c 7072 6564 6963  s(actuals,predic
+000724a0: 7465 642c 636f 6c73 2c70 6c6f 745f 6e61  ted,cols,plot_na
+000724b0: 6d65 3d70 6c6f 745f 6e61 6d65 290d 0a20  me=plot_name).. 
+000724c0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+000724d0: 2020 2020 7072 696e 7428 2743 6f75 6c64      print('Could
+000724e0: 206e 6f74 2064 7261 7720 7265 6772 6573   not draw regres
+000724f0: 7369 6f6e 2070 6c6f 7420 6275 7420 636f  sion plot but co
+00072500: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a20  ntinuing...').. 
+00072510: 2020 2069 6620 6d75 6c74 695f 6c61 6265     if multi_labe
+00072520: 6c3a 0d0a 2020 2020 2020 2020 666f 7220  l:..        for 
+00072530: 6920 696e 2072 616e 6765 2861 6374 7561  i in range(actua
+00072540: 6c73 2e73 6861 7065 5b31 5d29 3a0d 0a20  ls.shape[1]):.. 
+00072550: 2020 2020 2020 2020 2020 2061 6374 7561             actua
+00072560: 6c73 5f78 203d 2061 6374 7561 6c73 5b3a  ls_x = actuals[:
+00072570: 2c69 5d0d 0a20 2020 2020 2020 2020 2020  ,i]..           
+00072580: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00072590: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
+000725a0: 5f78 203d 2070 7265 6469 6374 6564 5b3a  _x = predicted[:
+000725b0: 2c69 5d0d 0a20 2020 2020 2020 2020 2020  ,i]..           
+000725c0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+000725d0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
+000725e0: 7465 645f 7820 3d20 7072 6564 6963 7465  ted_x = predicte
+000725f0: 645b 3a5d 0d0a 2020 2020 2020 2020 2020  d[:]..          
+00072600: 2020 7072 696e 7428 2752 6567 7265 7373    print('Regress
+00072610: 696f 6e20 4d65 7472 6963 7320 666f 7220  ion Metrics for 
+00072620: 5461 7267 6574 3d25 7327 2025 636f 6c73  Target=%s' %cols
+00072630: 5b69 5d29 0d0a 2020 2020 2020 2020 2020  [i])..          
+00072640: 2020 6d61 652c 206d 6165 5f61 7370 2c20    mae, mae_asp, 
+00072650: 726d 7365 5f61 7370 203d 2070 7269 6e74  rmse_asp = print
+00072660: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
+00072670: 6963 7328 6163 7475 616c 735f 782c 2070  ics(actuals_x, p
+00072680: 7265 6469 6374 6564 5f78 290d 0a20 2020  redicted_x)..   
+00072690: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000726a0: 6d61 652c 206d 6165 5f61 7370 2c20 726d  mae, mae_asp, rm
+000726b0: 7365 5f61 7370 203d 2070 7269 6e74 5f72  se_asp = print_r
+000726c0: 6567 7265 7373 696f 6e5f 6d65 7472 6963  egression_metric
+000726d0: 7328 6163 7475 616c 732c 2070 7265 6469  s(actuals, predi
+000726e0: 6374 6564 290d 0a20 2020 2072 6574 7572  cted)..    retur
+000726f0: 6e20 6d61 652c 206d 6165 5f61 7370 2c20  n mae, mae_asp, 
+00072700: 726d 7365 5f61 7370 0d0a 2323 2323 2323  rmse_asp..######
+00072710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072750: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
+00072760: 7072 696e 745f 7265 6772 6573 7369 6f6e  print_regression
+00072770: 5f6d 6574 7269 6373 2861 6374 7561 6c73  _metrics(actuals
+00072780: 2c20 7072 6564 6963 7465 6429 3a0d 0a20  , predicted):.. 
+00072790: 2020 206d 6165 203d 206d 6561 6e5f 6162     mae = mean_ab
+000727a0: 736f 6c75 7465 5f65 7272 6f72 2861 6374  solute_error(act
+000727b0: 7561 6c73 2c20 7072 6564 6963 7465 6429  uals, predicted)
+000727c0: 0d0a 2020 2020 6d61 655f 6173 7020 3d20  ..    mae_asp = 
+000727d0: 286d 6561 6e5f 6162 736f 6c75 7465 5f65  (mean_absolute_e
+000727e0: 7272 6f72 2861 6374 7561 6c73 2c20 7072  rror(actuals, pr
+000727f0: 6564 6963 7465 6429 2f61 6374 7561 6c73  edicted)/actuals
+00072800: 2e73 7464 2829 292a 3130 300d 0a20 2020  .std())*100..   
+00072810: 2072 6d73 655f 6173 7020 3d20 286e 702e   rmse_asp = (np.
+00072820: 7371 7274 286d 6561 6e5f 7371 7561 7265  sqrt(mean_square
+00072830: 645f 6572 726f 7228 6163 7475 616c 732c  d_error(actuals,
+00072840: 7072 6564 6963 7465 6429 292f 6163 7475  predicted))/actu
+00072850: 616c 732e 7374 6428 2929 2a31 3030 0d0a  als.std())*100..
+00072860: 2020 2020 726d 7365 203d 2070 7269 6e74      rmse = print
+00072870: 5f72 6d73 6528 6163 7475 616c 732c 2070  _rmse(actuals, p
+00072880: 7265 6469 6374 6564 290d 0a20 2020 205f  redicted)..    _
+00072890: 203d 2070 7269 6e74 5f6d 6170 6528 6163   = print_mape(ac
+000728a0: 7475 616c 732c 2070 7265 6469 6374 6564  tuals, predicted
+000728b0: 290d 0a20 2020 206d 6170 6520 3d20 7072  )..    mape = pr
+000728c0: 696e 745f 6d61 7065 2861 6374 7561 6c73  int_mape(actuals
+000728d0: 2c20 7072 6564 6963 7465 6429 0d0a 2020  , predicted)..  
+000728e0: 2020 7072 696e 7428 2720 2020 204d 4145    print('    MAE
+000728f0: 203d 2025 302e 3466 2720 256d 6165 290d   = %0.4f' %mae).
+00072900: 0a20 2020 2070 7269 6e74 2822 2020 2020  .    print("    
+00072910: 4d41 5045 203d 2025 302e 3066 2525 2028  MAPE = %0.0f%% (
+00072920: 4d41 5045 2077 696c 6c20 6265 2076 6572  MAPE will be ver
+00072930: 7920 6869 6768 2077 6865 6e20 7a65 726f  y high when zero
+00072940: 7320 696e 2061 6374 7561 6c73 2922 2025  s in actuals)" %
+00072950: 286d 6170 6529 290d 0a20 2020 2070 7269  (mape))..    pri
+00072960: 6e74 2827 2020 2020 524d 5345 203d 2025  nt('    RMSE = %
+00072970: 302e 3466 2720 2572 6d73 6529 0d0a 2020  0.4f' %rmse)..  
+00072980: 2020 7072 696e 7428 2720 2020 204e 6f72    print('    Nor
+00072990: 6d61 6c69 7a65 6420 4d41 4520 2861 7320  malized MAE (as 
+000729a0: 2525 2073 7464 2064 6576 206f 6620 4163  %% std dev of Ac
+000729b0: 7475 616c 7329 203d 2025 302e 3066 2525  tuals) = %0.0f%%
+000729c0: 2720 2528 6d61 652f 6162 7328 6163 7475  ' %(mae/abs(actu
+000729d0: 616c 7329 2e73 7464 2829 2a31 3030 2929  als).std()*100))
+000729e0: 0d0a 2020 2020 2320 4e6f 726d 616c 697a  ..    # Normaliz
+000729f0: 6564 2052 4d53 4520 7072 696e 7428 2752  ed RMSE print('R
+00072a00: 4d53 4520 3d20 7b3a 2c2e 4f66 7d27 2e66  MSE = {:,.Of}'.f
+00072a10: 6f72 6d61 7428 726d 7365 2929 0d0a 2020  ormat(rmse))..  
+00072a20: 2020 2370 7269 6e74 2827 2020 2020 4e6f    #print('    No
+00072a30: 726d 616c 697a 6564 2052 4d53 4520 2825  rmalized RMSE (%
+00072a40: 2520 6f66 204d 696e 4d61 7820 6f66 2041  % of MinMax of A
+00072a50: 6374 7561 6c73 2920 3d20 2530 2e30 6625  ctuals) = %0.0f%
+00072a60: 2527 2025 2831 3030 2a72 6d73 652f 6162  %' %(100*rmse/ab
+00072a70: 7328 6163 7475 616c 732e 6d61 7828 292d  s(actuals.max()-
+00072a80: 6163 7475 616c 732e 6d69 6e28 2929 2929  actuals.min())))
+00072a90: 0d0a 2020 2020 7072 696e 7428 2720 2020  ..    print('   
+00072aa0: 204e 6f72 6d61 6c69 7a65 6420 524d 5345   Normalized RMSE
+00072ab0: 2028 2525 206f 6620 5374 6420 4465 7620   (%% of Std Dev 
+00072ac0: 6f66 2041 6374 7561 6c73 2920 3d20 2530  of Actuals) = %0
+00072ad0: 2e30 6625 2527 2025 2831 3030 2a72 6d73  .0f%%' %(100*rms
+00072ae0: 652f 6163 7475 616c 732e 7374 6428 2929  e/actuals.std())
+00072af0: 290d 0a20 2020 2072 6574 7572 6e20 6d61  )..    return ma
+00072b00: 652c 206d 6165 5f61 7370 2c20 726d 7365  e, mae_asp, rmse
+00072b10: 5f61 7370 0d0a 2323 2323 2323 2323 2323  _asp..##########
+00072b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072b60: 2323 2323 2323 0d0a 6465 6620 7072 696e  ######..def prin
+00072b70: 745f 7374 6174 6963 5f72 6d73 6528 6163  t_static_rmse(ac
+00072b80: 7475 616c 2c20 7072 6564 6963 7465 642c  tual, predicted,
+00072b90: 2073 7461 7274 5f66 726f 6d3d 302c 7665   start_from=0,ve
+00072ba0: 7262 6f73 653d 3029 3a0d 0a20 2020 2022  rbose=0):..    "
+00072bb0: 2222 0d0a 2020 2020 7468 6973 2063 616c  ""..    this cal
+00072bc0: 6375 6c61 7465 7320 7468 6520 7261 7469  culates the rati
+00072bd0: 6f20 6f66 2074 6865 2072 6d73 6520 6572  o of the rmse er
+00072be0: 726f 7220 746f 2074 6865 2073 7461 6e64  ror to the stand
+00072bf0: 6172 6420 6465 7669 6174 696f 6e20 6f66  ard deviation of
+00072c00: 2074 6865 2061 6374 7561 6c73 2e0d 0a20   the actuals... 
+00072c10: 2020 2054 6869 7320 7261 7469 6f20 7368     This ratio sh
+00072c20: 6f75 6c64 2062 6520 6265 6c6f 7720 3120  ould be below 1 
+00072c30: 666f 7220 6120 6d6f 6465 6c20 746f 2062  for a model to b
+00072c40: 6520 636f 6e73 6964 6572 6564 2075 7365  e considered use
+00072c50: 6675 6c2e 0d0a 2020 2020 5468 6520 636f  ful...    The co
+00072c60: 6d70 6172 6973 6f6e 2073 7461 7274 7320  mparison starts 
+00072c70: 6672 6f6d 2074 6865 2072 6f77 2069 6e64  from the row ind
+00072c80: 6963 6174 6564 2069 6e20 7468 6520 2273  icated in the "s
+00072c90: 7461 7274 5f66 726f 6d22 2076 6172 6961  tart_from" varia
+00072ca0: 626c 652e 0d0a 2020 2020 2222 220d 0a20  ble...    """.. 
+00072cb0: 2020 2072 6d73 6520 3d20 6e70 2e73 7172     rmse = np.sqr
+00072cc0: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
+00072cd0: 7272 6f72 2861 6374 7561 6c5b 7374 6172  rror(actual[star
+00072ce0: 745f 6672 6f6d 3a5d 2c70 7265 6469 6374  t_from:],predict
+00072cf0: 6564 5b73 7461 7274 5f66 726f 6d3a 5d29  ed[start_from:])
+00072d00: 290d 0a20 2020 2073 7464 5f64 6576 203d  )..    std_dev =
+00072d10: 2061 6374 7561 6c5b 7374 6172 745f 6672   actual[start_fr
+00072d20: 6f6d 3a5d 2e73 7464 2829 0d0a 2020 2020  om:].std()..    
+00072d30: 6966 2076 6572 626f 7365 203e 3d20 313a  if verbose >= 1:
+00072d40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00072d50: 2720 2020 2052 4d53 4520 3d20 2530 2e32  '    RMSE = %0.2
+00072d60: 6627 2025 726d 7365 290d 0a20 2020 2020  f' %rmse)..     
+00072d70: 2020 2070 7269 6e74 2827 2020 2020 5374     print('    St
+00072d80: 6420 4465 7669 6174 696f 6e20 6f66 2041  d Deviation of A
+00072d90: 6374 7561 6c73 203d 2025 302e 3266 2720  ctuals = %0.2f' 
+00072da0: 2528 7374 645f 6465 7629 290d 0a20 2020  %(std_dev))..   
+00072db0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00072dc0: 4e6f 726d 616c 697a 6564 2052 4d53 4520  Normalized RMSE 
+00072dd0: 3d20 2530 2e31 6625 2527 2025 2872 6d73  = %0.1f%%' %(rms
+00072de0: 652a 3130 302f 7374 645f 6465 7629 290d  e*100/std_dev)).
+00072df0: 0a20 2020 2072 6574 7572 6e20 726d 7365  .    return rmse
+00072e00: 2c20 726d 7365 2f73 7464 5f64 6576 0d0a  , rmse/std_dev..
+00072e10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072e20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00072e60: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00072e70: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+00072e80: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00072e90: 2c6d 6561 6e5f 6162 736f 6c75 7465 5f65  ,mean_absolute_e
+00072ea0: 7272 6f72 0d0a 6465 6620 7072 696e 745f  rror..def print_
+00072eb0: 726d 7365 2879 2c20 795f 6861 7429 3a0d  rmse(y, y_hat):.
+00072ec0: 0a20 2020 2022 2222 0d0a 2020 2020 4361  .    """..    Ca
+00072ed0: 6c63 756c 6174 696e 6720 526f 6f74 204d  lculating Root M
+00072ee0: 6561 6e20 5371 7561 7265 2045 7272 6f72  ean Square Error
+00072ef0: 2068 7474 7073 3a2f 2f65 6e2e 7769 6b69   https://en.wiki
+00072f00: 7065 6469 612e 6f72 672f 7769 6b69 2f52  pedia.org/wiki/R
+00072f10: 6f6f 742d 6d65 616e 2d73 7175 6172 655f  oot-mean-square_
+00072f20: 6465 7669 6174 696f 6e0d 0a20 2020 2022  deviation..    "
+00072f30: 2222 0d0a 2020 2020 6d73 6520 3d20 6e70  ""..    mse = np
+00072f40: 2e6d 6561 6e28 2879 202d 2079 5f68 6174  .mean((y - y_hat
+00072f50: 292a 2a32 290d 0a20 2020 2072 6574 7572  )**2)..    retur
+00072f60: 6e20 6e70 2e73 7172 7428 6d73 6529 0d0a  n np.sqrt(mse)..
+00072f70: 0d0a 6465 6620 7072 696e 745f 6d61 7065  ..def print_mape
+00072f80: 2879 2c20 795f 6861 7429 3a0d 0a20 2020  (y, y_hat):..   
+00072f90: 2022 2222 0d0a 2020 2020 4361 6c63 756c   """..    Calcul
+00072fa0: 6174 696e 6720 4d65 616e 2041 6273 6f6c  ating Mean Absol
+00072fb0: 7574 6520 5065 7263 656e 7420 4572 726f  ute Percent Erro
+00072fc0: 7220 6874 7470 733a 2f2f 656e 2e77 696b  r https://en.wik
+00072fd0: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
+00072fe0: 4d65 616e 5f61 6273 6f6c 7574 655f 7065  Mean_absolute_pe
+00072ff0: 7263 656e 7461 6765 5f65 7272 6f72 0d0a  rcentage_error..
+00073000: 2020 2020 546f 2061 766f 6964 2069 6e66      To avoid inf
+00073010: 696e 6974 7920 6475 6520 746f 2064 6976  inity due to div
+00073020: 6973 696f 6e20 6279 207a 6572 6f2c 2077  ision by zero, w
+00073030: 6520 7365 6c65 6374 206d 6178 2830 2e30  e select max(0.0
+00073040: 312c 2061 6273 2861 6374 7561 6c73 2929  1, abs(actuals))
+00073050: 2074 6f20 7368 6f77 204d 4150 452e 0d0a   to show MAPE...
+00073060: 2020 2020 2222 220d 0a20 2020 2023 2323      """..    ###
+00073070: 2057 6865 7265 7665 7220 7468 6572 6520   Wherever there 
+00073080: 6973 207a 6572 6f2c 2072 6570 6c61 6365  is zero, replace
+00073090: 2069 7420 7769 7468 2030 2e30 3031 2073   it with 0.001 s
+000730a0: 6f20 6974 2064 6f65 736e 2774 2072 6573  o it doesn't res
+000730b0: 756c 7420 696e 2064 6976 6973 696f 6e20  ult in division 
+000730c0: 6279 207a 6572 6f0d 0a20 2020 2070 6572  by zero..    per
+000730d0: 635f 6572 7220 3d20 2831 3030 2a28 6e70  c_err = (100*(np
+000730e0: 2e77 6865 7265 2879 3d3d 302c 302e 3030  .where(y==0,0.00
+000730f0: 312c 7929 202d 2079 5f68 6174 2929 2f6e  1,y) - y_hat))/n
+00073100: 702e 7768 6572 6528 793d 3d30 2c30 2e30  p.where(y==0,0.0
+00073110: 3031 2c79 290d 0a20 2020 2072 6574 7572  01,y)..    retur
+00073120: 6e20 6e70 2e6d 6561 6e28 6162 7328 7065  n np.mean(abs(pe
+00073130: 7263 5f65 7272 2929 0d0a 2323 2323 2323  rc_err))..######
 00073140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00073150: 2323 2323 0d0a 6465 6620 7265 6d6f 7665  ####..def remove
-00073160: 5f68 6967 686c 795f 636f 7272 656c 6174  _highly_correlat
-00073170: 6564 5f76 6172 735f 6661 7374 2864 662c  ed_vars_fast(df,
-00073180: 2063 6f72 725f 6c69 6d69 743d 302e 3730   corr_limit=0.70
-00073190: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-000731a0: 2054 6869 7320 6973 2061 2073 696d 706c   This is a simpl
-000731b0: 6520 6d65 7468 6f64 2074 6f20 7265 6d6f  e method to remo
-000731c0: 7665 2068 6967 686c 7920 636f 7272 656c  ve highly correl
-000731d0: 6174 6564 2066 6561 7475 7265 7320 6661  ated features fa
-000731e0: 7374 2075 7369 6e67 2050 6561 7273 6f6e  st using Pearson
-000731f0: 2773 2043 6f72 7265 6c61 7469 6f6e 2e0d  's Correlation..
-00073200: 0a20 2020 2055 7365 2074 6869 7320 6f6e  .    Use this on
-00073210: 6c79 2066 6f72 2066 6c6f 6174 2061 6e64  ly for float and
-00073220: 2069 6e74 6567 6572 2076 6172 6961 626c   integer variabl
-00073230: 6573 2e20 4974 2077 696c 6c20 6175 746f  es. It will auto
-00073240: 6d61 7469 6361 6c6c 7920 7365 6c65 6374  matically select
-00073250: 2074 686f 7365 206f 6e6c 792e 0d0a 2020   those only...  
-00073260: 2020 4974 2063 616e 2062 6520 7573 6564    It can be used
-00073270: 2066 6f72 2076 6572 7920 6c61 7267 6520   for very large 
-00073280: 6461 7461 2073 6574 7320 7768 6572 6520  data sets where 
-00073290: 6665 6174 7572 6577 697a 2068 6173 2074  featurewiz has t
-000732a0: 726f 7562 6c65 2077 6974 6820 6d65 6d6f  rouble with memo
-000732b0: 7279 0d0a 2020 2020 2222 220d 0a20 2020  ry..    """..   
-000732c0: 2023 2043 7265 6174 696e 6720 636f 7272   # Creating corr
-000732d0: 656c 6174 696f 6e20 6d61 7472 6978 0d0a  elation matrix..
-000732e0: 2020 2020 636f 725f 6d61 7472 6978 203d      cor_matrix =
-000732f0: 2064 662e 636f 7272 2829 2e61 6273 2829   df.corr().abs()
-00073300: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00073310: 3136 290d 0a20 2020 2023 2053 656c 6563  16)..    # Selec
-00073320: 7469 6e67 2075 7070 6572 2074 7269 616e  ting upper trian
-00073330: 676c 6520 6f66 2063 6f72 7265 6c61 7469  gle of correlati
-00073340: 6f6e 206d 6174 7269 780d 0a20 2020 2075  on matrix..    u
-00073350: 7070 6572 5f74 7269 203d 2063 6f72 5f6d  pper_tri = cor_m
-00073360: 6174 7269 782e 7768 6572 6528 6e70 2e74  atrix.where(np.t
-00073370: 7269 7528 6e70 2e6f 6e65 7328 636f 725f  riu(np.ones(cor_
-00073380: 6d61 7472 6978 2e73 6861 7065 292c 0d0a  matrix.shape),..
-00073390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000733a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000733b0: 2020 6b3d 3129 2e61 7374 7970 6528 6e70    k=1).astype(np
-000733c0: 2e62 6f6f 6c29 290d 0a20 2020 2023 2046  .bool))..    # F
-000733d0: 696e 6469 6e67 2069 6e64 6578 206f 6620  inding index of 
-000733e0: 6665 6174 7572 6520 636f 6c75 6d6e 7320  feature columns 
-000733f0: 7769 7468 2063 6f72 7265 6c61 7469 6f6e  with correlation
-00073400: 2067 7265 6174 6572 2074 6861 6e20 302e   greater than 0.
-00073410: 3935 0d0a 2020 2020 746f 5f64 726f 7020  95..    to_drop 
-00073420: 3d20 5b63 6f6c 756d 6e20 666f 7220 636f  = [column for co
-00073430: 6c75 6d6e 2069 6e20 7570 7065 725f 7472  lumn in upper_tr
-00073440: 692e 636f 6c75 6d6e 7320 6966 2061 6e79  i.columns if any
-00073450: 2875 7070 6572 5f74 7269 5b63 6f6c 756d  (upper_tri[colum
-00073460: 6e5d 203e 2063 6f72 725f 6c69 6d69 7429  n] > corr_limit)
-00073470: 5d0d 0a20 2020 2070 7269 6e74 2829 3b0d  ]..    print();.
-00073480: 0a20 2020 2070 7269 6e74 2827 4869 6768  .    print('High
-00073490: 6c79 2063 6f72 7265 6c61 7465 6420 636f  ly correlated co
-000734a0: 6c75 6d6e 7320 746f 2072 656d 6f76 653a  lumns to remove:
-000734b0: 2025 7327 2025 746f 5f64 726f 7029 0d0a   %s' %to_drop)..
-000734c0: 2020 2020 7265 7475 726e 2074 6f5f 6472      return to_dr
-000734d0: 6f70 0d0a 2323 2323 2323 2323 2323 2323  op..############
+00073150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073180: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
+00073190: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+000731a0: 2069 6d70 6f72 7420 6d65 616e 5f61 6273   import mean_abs
+000731b0: 6f6c 7574 655f 6572 726f 722c 206d 6561  olute_error, mea
+000731c0: 6e5f 7371 7561 7265 645f 6572 726f 720d  n_squared_error.
+000731d0: 0a66 726f 6d20 6974 6572 746f 6f6c 7320  .from itertools 
+000731e0: 696d 706f 7274 2063 7963 6c65 0d0a 696d  import cycle..im
+000731f0: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+00073200: 7079 706c 6f74 2061 7320 706c 740d 0a64  pyplot as plt..d
+00073210: 6566 2070 6c6f 745f 6466 706c 6f74 2864  ef plot_dfplot(d
+00073220: 6670 6c6f 742c 706c 6f74 5f74 6974 6c65  fplot,plot_title
+00073230: 3d22 2229 3a0d 0a20 2020 2066 6967 7369  =""):..    figsi
+00073240: 7a65 203d 2028 3130 2c20 3130 290d 0a20  ze = (10, 10).. 
+00073250: 2020 2063 6f6c 6f72 7320 3d20 6379 636c     colors = cycl
+00073260: 6528 2762 7972 636d 676b 6279 7263 6d67  e('byrcmgkbyrcmg
+00073270: 6b62 7972 636d 676b 6279 7263 6d67 6b27  kbyrcmgkbyrcmgk'
+00073280: 290d 0a20 2020 2070 6c74 2e66 6967 7572  )..    plt.figur
+00073290: 6528 6669 6773 697a 653d 6669 6773 697a  e(figsize=figsiz
+000732a0: 6529 0d0a 2020 2020 6163 7475 616c 7320  e)..    actuals 
+000732b0: 3d20 6466 706c 6f74 5b27 4163 7475 616c  = dfplot['Actual
+000732c0: 7327 5d0d 0a20 2020 2070 7265 6469 6374  s']..    predict
+000732d0: 6564 203d 2020 6466 706c 6f74 5b27 5072  ed =  dfplot['Pr
+000732e0: 6564 6963 7465 6427 5d0d 0a20 2020 206c  edicted']..    l
+000732f0: 696e 6553 7461 7274 203d 2061 6374 7561  ineStart = actua
+00073300: 6c73 2e6d 696e 2829 0d0a 2020 2020 6c69  ls.min()..    li
+00073310: 6e65 456e 6420 3d20 6163 7475 616c 732e  neEnd = actuals.
+00073320: 6d61 7828 290d 0a20 2020 2070 6c74 2e73  max()..    plt.s
+00073330: 6361 7474 6572 2861 6374 7561 6c73 2c20  catter(actuals, 
+00073340: 7072 6564 6963 7465 642c 2063 6f6c 6f72  predicted, color
+00073350: 203d 206e 6578 7428 636f 6c6f 7273 292c   = next(colors),
+00073360: 2061 6c70 6861 3d30 2e35 2c6c 6162 656c   alpha=0.5,label
+00073370: 3d27 5072 6564 6963 7469 6f6e 7327 290d  ='Predictions').
+00073380: 0a20 2020 2070 6c74 2e70 6c6f 7428 5b6c  .    plt.plot([l
+00073390: 696e 6553 7461 7274 2c20 6c69 6e65 456e  ineStart, lineEn
+000733a0: 645d 2c20 5b6c 696e 6553 7461 7274 2c20  d], [lineStart, 
+000733b0: 6c69 6e65 456e 645d 2c20 276b 2d27 2c20  lineEnd], 'k-', 
+000733c0: 636f 6c6f 7220 3d20 6e65 7874 2863 6f6c  color = next(col
+000733d0: 6f72 7329 290d 0a20 2020 2070 6c74 2e78  ors))..    plt.x
+000733e0: 6c69 6d28 6c69 6e65 5374 6172 742c 206c  lim(lineStart, l
+000733f0: 696e 6545 6e64 290d 0a20 2020 2070 6c74  ineEnd)..    plt
+00073400: 2e79 6c69 6d28 6c69 6e65 5374 6172 742c  .ylim(lineStart,
+00073410: 206c 696e 6545 6e64 290d 0a20 2020 2070   lineEnd)..    p
+00073420: 6c74 2e78 6c61 6265 6c28 2741 6374 7561  lt.xlabel('Actua
+00073430: 6c27 290d 0a20 2020 2070 6c74 2e79 6c61  l')..    plt.yla
+00073440: 6265 6c28 2750 7265 6469 6374 6564 2729  bel('Predicted')
+00073450: 0d0a 2020 2020 706c 742e 6c65 6765 6e64  ..    plt.legend
+00073460: 2829 0d0a 2020 2020 706c 742e 7469 746c  ()..    plt.titl
+00073470: 6528 2750 7265 6469 6374 6564 2076 7320  e('Predicted vs 
+00073480: 4163 7475 616c 7320 666f 7220 5461 7267  Actuals for Targ
+00073490: 6574 203d 2025 7327 2025 706c 6f74 5f74  et = %s' %plot_t
+000734a0: 6974 6c65 2c20 666f 6e74 7369 7a65 3d31  itle, fontsize=1
+000734b0: 3229 0d0a 2020 2020 706c 742e 7368 6f77  2)..    plt.show
+000734c0: 2829 3b0d 0a23 2323 2323 2323 2323 2323  ();..###########
+000734d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000734e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000734f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00073500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00073510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00073520: 2323 2323 2323 2323 230d 0a64 6566 2061  #########..def a
-00073530: 6464 5f65 6e74 726f 7079 5f62 696e 6e69  dd_entropy_binni
-00073540: 6e67 2874 656d 705f 7472 6169 6e2c 2074  ng(temp_train, t
-00073550: 6172 672c 206e 756d 5f76 6172 732c 2069  arg, num_vars, i
-00073560: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-00073570: 732c 2074 656d 705f 7465 7374 2c0d 0a20  s, temp_test,.. 
-00073580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073590: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
-000735a0: 2065 6e74 726f 7079 5f62 696e 6e69 6e67   entropy_binning
-000735b0: 2c76 6572 626f 7365 3d30 293a 0d0a 2020  ,verbose=0):..  
-000735c0: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
-000735d0: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
-000735e0: 7768 6572 6520 7765 2064 6f20 454e 5452  where we do ENTR
-000735f0: 4f50 5920 4249 4e4e 494e 4720 4f46 2043  OPY BINNING OF C
-00073600: 4f4e 5449 4e55 4f55 5320 5641 5253 2023  ONTINUOUS VARS #
-00073610: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00073620: 2020 2020 2323 2323 2049 7420 6973 2062      #### It is b
-00073630: 6573 7420 746f 2064 6f20 4269 6e6e 696e  est to do Binnin
-00073640: 6720 6f6e 204f 4e4c 5920 6f6e 2074 6865  g on ONLY on the
-00073650: 2074 6f70 206d 6f73 7420 7661 7269 6162   top most variab
-00073660: 6c65 7320 6672 6f6d 2049 6d70 6f72 7461  les from Importa
-00073670: 6e74 5f46 6561 7475 7265 7321 0d0a 2020  nt_Features!..  
-00073680: 2020 2020 2020 2323 2323 204d 616b 6520        #### Make 
-00073690: 7375 7265 2074 6861 7420 7468 6520 546f  sure that the To
-000736a0: 7020 322d 3130 2076 6172 7320 6172 6520  p 2-10 vars are 
-000736b0: 616c 6c20 434f 4e54 494e 554f 5553 2056  all CONTINUOUS V
-000736c0: 4152 5321 204f 7468 6572 7769 7365 2042  ARS! Otherwise B
-000736d0: 696e 6e69 6e67 2069 7320 5761 7374 6521  inning is Waste!
-000736e0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
-000736f0: 6869 7320 6d65 7468 6f64 2065 6e73 7572  his method ensur
-00073700: 6573 2079 6f75 2067 6574 2074 6865 2042  es you get the B
-00073710: 6573 7420 5265 7375 6c74 7320 6279 2067  est Results by g
-00073720: 656e 6572 616c 697a 696e 6720 6f6e 2074  eneralizing on t
-00073730: 6865 2074 6f70 206e 756d 6572 6963 2076  he top numeric v
-00073740: 6172 7321 0d0a 2020 2020 2222 220d 0a20  ars!..    """.. 
-00073750: 2020 2074 656d 705f 7472 6169 6e20 3d20     temp_train = 
-00073760: 636f 7079 2e64 6565 7063 6f70 7928 7465  copy.deepcopy(te
-00073770: 6d70 5f74 7261 696e 290d 0a20 2020 2074  mp_train)..    t
-00073780: 656d 705f 7465 7374 203d 2063 6f70 792e  emp_test = copy.
-00073790: 6465 6570 636f 7079 2874 656d 705f 7465  deepcopy(temp_te
-000737a0: 7374 290d 0a20 2020 206d 6178 5f64 6570  st)..    max_dep
-000737b0: 7468 203d 2031 300d 0a20 2020 2073 6565  th = 10..    see
-000737c0: 6420 3d20 3939 0d0a 2020 2020 6e75 6d5f  d = 99..    num_
-000737d0: 7661 7273 203d 2063 6f70 792e 6465 6570  vars = copy.deep
-000737e0: 636f 7079 286e 756d 5f76 6172 7329 0d0a  copy(num_vars)..
-000737f0: 2020 2020 636f 6e74 696e 756f 7573 5f76      continuous_v
-00073800: 6172 7320 3d20 636f 7079 2e64 6565 7063  ars = copy.deepc
-00073810: 6f70 7928 6e75 6d5f 7661 7273 290d 0a20  opy(num_vars).. 
-00073820: 2020 2069 6d70 6f72 7461 6e74 5f66 6561     important_fea
-00073830: 7475 7265 7320 3d20 636f 7079 2e64 6565  tures = copy.dee
-00073840: 7063 6f70 7928 696d 706f 7274 616e 745f  pcopy(important_
-00073850: 6665 6174 7572 6573 290d 0a20 2020 2070  features)..    p
-00073860: 7269 6e74 2827 4465 7465 726d 696e 696e  rint('Determinin
-00073870: 6720 7768 6963 6820 6f66 2025 6420 636f  g which of %d co
-00073880: 6e74 696e 756f 7573 2076 6172 6961 626c  ntinuous variabl
-00073890: 6573 2073 686f 756c 6420 6265 2045 6e74  es should be Ent
-000738a0: 726f 7079 2042 696e 6e65 642e 2e2e 2720  ropy Binned...' 
-000738b0: 256c 656e 2863 6f6e 7469 6e75 6f75 735f  %len(continuous_
-000738c0: 7661 7273 2929 0d0a 2020 2020 6966 206c  vars))..    if l
-000738d0: 656e 2863 6f6e 7469 6e75 6f75 735f 7661  en(continuous_va
-000738e0: 7273 2920 3e20 3020 616e 6420 6c65 6e28  rs) > 0 and len(
-000738f0: 636f 6e74 696e 756f 7573 5f76 6172 7329  continuous_vars)
-00073900: 203c 3d20 323a 0d0a 2020 2020 2020 2020   <= 2:..        
-00073910: 6d61 785f 6465 7074 6820 3d20 2032 0d0a  max_depth =  2..
-00073920: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
-00073930: 7573 5f76 6172 7320 3d20 636f 6e74 696e  us_vars = contin
-00073940: 756f 7573 5f76 6172 735b 3a5d 0d0a 2020  uous_vars[:]..  
-00073950: 2020 656c 6966 206c 656e 2863 6f6e 7469    elif len(conti
-00073960: 6e75 6f75 735f 7661 7273 2920 3e20 3220  nuous_vars) > 2 
-00073970: 616e 6420 6c65 6e28 636f 6e74 696e 756f  and len(continuo
-00073980: 7573 5f76 6172 7329 203c 3d20 353a 0d0a  us_vars) <= 5:..
-00073990: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
-000739a0: 6820 3d20 6c65 6e28 636f 6e74 696e 756f  h = len(continuo
-000739b0: 7573 5f76 6172 7329 202d 2032 0d0a 2020  us_vars) - 2..  
-000739c0: 2020 2020 2020 636f 6e74 696e 756f 7573        continuous
-000739d0: 5f76 6172 7320 3d20 636f 6e74 696e 756f  _vars = continuo
-000739e0: 7573 5f76 6172 735b 3a32 5d0d 0a20 2020  us_vars[:2]..   
-000739f0: 2065 6c69 6620 6c65 6e28 636f 6e74 696e   elif len(contin
-00073a00: 756f 7573 5f76 6172 7329 203e 2035 2061  uous_vars) > 5 a
-00073a10: 6e64 206c 656e 2863 6f6e 7469 6e75 6f75  nd len(continuou
-00073a20: 735f 7661 7273 2920 3c3d 2031 303a 0d0a  s_vars) <= 10:..
-00073a30: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
-00073a40: 6820 3d20 350d 0a20 2020 2020 2020 2063  h = 5..        c
-00073a50: 6f6e 7469 6e75 6f75 735f 7661 7273 203d  ontinuous_vars =
-00073a60: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
-00073a70: 5b3a 355d 0d0a 2020 2020 656c 6966 206c  [:5]..    elif l
-00073a80: 656e 2863 6f6e 7469 6e75 6f75 735f 7661  en(continuous_va
-00073a90: 7273 2920 3e20 3130 2061 6e64 206c 656e  rs) > 10 and len
-00073aa0: 2863 6f6e 7469 6e75 6f75 735f 7661 7273  (continuous_vars
-00073ab0: 2920 3c3d 2035 303a 0d0a 2020 2020 2020  ) <= 50:..      
-00073ac0: 2020 6d61 785f 6465 7074 6820 3d20 6d61    max_depth = ma
-00073ad0: 785f 6465 7074 680d 0a20 2020 2020 2020  x_depth..       
-00073ae0: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
-00073af0: 203d 2063 6f6e 7469 6e75 6f75 735f 7661   = continuous_va
-00073b00: 7273 5b3a 3130 5d0d 0a20 2020 2065 6c73  rs[:10]..    els
-00073b10: 653a 0d0a 2020 2020 2020 2020 6d61 785f  e:..        max_
-00073b20: 6465 7074 6820 3d20 6d61 785f 6465 7074  depth = max_dept
-00073b30: 680d 0a20 2020 2020 2020 2063 6f6e 7469  h..        conti
-00073b40: 6e75 6f75 735f 7661 7273 203d 2063 6f6e  nuous_vars = con
-00073b50: 7469 6e75 6f75 735f 7661 7273 5b3a 3530  tinuous_vars[:50
-00073b60: 5d0d 0a20 2020 206e 6577 5f62 696e 636f  ]..    new_binco
-00073b70: 6c73 203d 205b 5d0d 0a20 2020 2023 2323  ls = []..    ###
-00073b80: 2020 2054 6869 7320 6973 2061 6e20 4177     This is an Aw
-00073b90: 6573 6f6d 6520 456e 7472 6f70 7920 4261  esome Entropy Ba
-00073ba0: 7365 6420 4269 6e6e 696e 6720 4d65 7468  sed Binning Meth
-00073bb0: 6f64 2066 6f72 2043 6f6e 7469 6e75 6f75  od for Continuou
-00073bc0: 7320 5661 7269 6162 6c65 7320 2323 2323  s Variables ####
-00073bd0: 2323 2323 2323 230d 0a20 2020 2066 726f  #######..    fro
-00073be0: 6d20 736b 6c65 6172 6e2e 7472 6565 2069  m sklearn.tree i
-00073bf0: 6d70 6f72 7420 4465 6369 7369 6f6e 5472  mport DecisionTr
-00073c00: 6565 5265 6772 6573 736f 722c 2044 6563  eeRegressor, Dec
-00073c10: 6973 696f 6e54 7265 6543 6c61 7373 6966  isionTreeClassif
-00073c20: 6965 720d 0a20 2020 2069 6620 6d6f 6465  ier..    if mode
-00073c30: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-00073c40: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-00073c50: 636c 6620 3d20 4465 6369 7369 6f6e 5472  clf = DecisionTr
-00073c60: 6565 5265 6772 6573 736f 7228 6372 6974  eeRegressor(crit
-00073c70: 6572 696f 6e3d 276d 7365 272c 6d69 6e5f  erion='mse',min_
-00073c80: 7361 6d70 6c65 735f 6c65 6166 3d32 2c0d  samples_leaf=2,.
-00073c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00073ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073cb0: 2020 2020 206d 6178 5f64 6570 7468 3d6d       max_depth=m
-00073cc0: 6178 5f64 6570 7468 2c0d 0a20 2020 2020  ax_depth,..     
-00073cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073ce0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00073cf0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-00073d00: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00073d10: 2020 2020 2020 636c 6620 3d20 4465 6369        clf = Deci
-00073d20: 7369 6f6e 5472 6565 436c 6173 7369 6669  sionTreeClassifi
-00073d30: 6572 2863 7269 7465 7269 6f6e 3d27 656e  er(criterion='en
-00073d40: 7472 6f70 7927 2c6d 696e 5f73 616d 706c  tropy',min_sampl
-00073d50: 6573 5f6c 6561 663d 322c 0d0a 2020 2020  es_leaf=2,..    
-00073d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073d80: 2020 2020 206d 6178 5f64 6570 7468 3d6d       max_depth=m
-00073d90: 6178 5f64 6570 7468 2c0d 0a20 2020 2020  ax_depth,..     
-00073da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073dc0: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
-00073dd0: 3d73 6565 6429 0d0a 2020 2020 656e 7472  =seed)..    entr
-00073de0: 6f70 795f 7468 7265 7368 6f6c 6420 3d20  opy_threshold = 
-00073df0: 5b5d 0d0a 2020 2020 2323 2323 2323 2320  []..    ####### 
-00073e00: 5468 6973 2069 7320 7768 6572 6520 7765  This is where we
-00073e10: 2062 696e 2065 6163 6820 7661 7269 6162   bin each variab
-00073e20: 6c65 2074 6872 6f75 6768 2061 206d 6574  le through a met
-00073e30: 686f 6420 6b6e 6f77 6e20 6173 2045 6e74  hod known as Ent
-00073e40: 726f 7079 2042 696e 6e69 6e67 2023 2323  ropy Binning ###
-00073e50: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00073e60: 2066 6f72 2065 6163 685f 6e75 6d20 696e   for each_num in
-00073e70: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
-00073e80: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
-00073e90: 0a20 2020 2020 2020 2020 2020 2063 6c66  .            clf
-00073ea0: 2e66 6974 2874 656d 705f 7472 6169 6e5b  .fit(temp_train[
-00073eb0: 6561 6368 5f6e 756d 5d2e 7661 6c75 6573  each_num].values
-00073ec0: 2e72 6573 6861 7065 282d 312c 3129 2c74  .reshape(-1,1),t
-00073ed0: 656d 705f 7472 6169 6e5b 7461 7267 5d2e  emp_train[targ].
-00073ee0: 7661 6c75 6573 290d 0a20 2020 2020 2020  values)..       
-00073ef0: 2020 2020 2065 6e74 726f 7079 5f74 6872       entropy_thr
-00073f00: 6573 686f 6c64 203d 2063 6c66 2e74 7265  eshold = clf.tre
-00073f10: 655f 2e74 6872 6573 686f 6c64 5b63 6c66  e_.threshold[clf
-00073f20: 2e74 7265 655f 2e74 6872 6573 686f 6c64  .tree_.threshold
-00073f30: 3e2d 325d 0d0a 2020 2020 2020 2020 2020  >-2]..          
-00073f40: 2020 656e 7472 6f70 795f 7468 7265 7368    entropy_thresh
-00073f50: 6f6c 6420 3d20 6e70 2e73 6f72 7428 656e  old = np.sort(en
-00073f60: 7472 6f70 795f 7468 7265 7368 6f6c 6429  tropy_threshold)
-00073f70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00073f80: 2069 7369 6e73 7461 6e63 6528 6561 6368   isinstance(each
-00073f90: 5f6e 756d 2c20 7374 7229 3a0d 0a20 2020  _num, str):..   
-00073fa0: 2020 2020 2020 2020 2020 2020 2062 696e               bin
-00073fb0: 636f 6c20 3d20 6561 6368 5f6e 756d 2b27  col = each_num+'
-00073fc0: 5f62 696e 270d 0a20 2020 2020 2020 2020  _bin'..         
-00073fd0: 2020 2020 2020 2074 656d 705f 7472 6169         temp_trai
-00073fe0: 6e5b 6269 6e63 6f6c 5d20 3d20 6e70 2e64  n[bincol] = np.d
-00073ff0: 6967 6974 697a 6528 7465 6d70 5f74 7261  igitize(temp_tra
-00074000: 696e 5b65 6163 685f 6e75 6d5d 2e76 616c  in[each_num].val
-00074010: 7565 732c 2065 6e74 726f 7079 5f74 6872  ues, entropy_thr
-00074020: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
-00074030: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00074040: 2020 2020 2020 2020 2020 2020 6269 6e63              binc
-00074050: 6f6c 203d 2027 6269 6e5f 272b 7374 7228  ol = 'bin_'+str(
-00074060: 6561 6368 5f6e 756d 290d 0a20 2020 2020  each_num)..     
-00074070: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
-00074080: 7472 6169 6e5b 6269 6e63 6f6c 5d20 3d20  train[bincol] = 
-00074090: 6e70 2e64 6967 6974 697a 6528 7465 6d70  np.digitize(temp
-000740a0: 5f74 7261 696e 5b65 6163 685f 6e75 6d5d  _train[each_num]
-000740b0: 2e76 616c 7565 732c 2065 6e74 726f 7079  .values, entropy
-000740c0: 5f74 6872 6573 686f 6c64 290d 0a20 2020  _threshold)..   
-000740d0: 2020 2020 2020 2020 2023 2323 2320 5765           #### We
-000740e0: 2044 726f 7020 7468 6520 6f72 6967 696e   Drop the origin
-000740f0: 616c 2063 6f6e 7469 6e75 6f75 7320 7661  al continuous va
-00074100: 7269 6162 6c65 2061 6674 6572 2079 6f75  riable after you
-00074110: 2068 6176 6520 6372 6561 7465 6420 7468   have created th
-00074120: 6520 6269 6e20 7768 656e 2046 6c61 6720  e bin when Flag 
-00074130: 6973 2074 7275 650d 0a20 2020 2020 2020  is true..       
-00074140: 2020 2020 2023 2323 2057 6520 446f 6e27       ### We Don'
-00074150: 7420 6472 6f70 2074 6865 7365 206f 7269  t drop these ori
-00074160: 6769 6e61 6c20 6e75 6d65 7269 6320 7661  ginal numeric va
-00074170: 7273 2073 696e 6365 2074 6865 7920 7769  rs since they wi
-00074180: 6c6c 2062 6520 7573 6564 206c 6174 6572  ll be used later
-00074190: 2066 6f72 2066 756c 6c20 7472 6169 6e20   for full train 
-000741a0: 6269 6e6e 696e 670d 0a20 2020 2020 2020  binning..       
-000741b0: 2020 2020 2069 6620 7479 7065 2874 656d       if type(tem
-000741c0: 705f 7465 7374 2920 213d 2073 7472 3a0d  p_test) != str:.
-000741d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000741e0: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-000741f0: 6163 685f 6e75 6d2c 2073 7472 293a 0d0a  ach_num, str):..
+00073510: 2323 2323 0d0a 6672 6f6d 2063 6f6c 6c65  ####..from colle
+00073520: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+00073530: 6661 756c 7464 6963 740d 0a64 6566 2072  faultdict..def r
+00073540: 6574 7572 6e5f 6c69 7374 5f6d 6174 6368  eturn_list_match
+00073550: 696e 675f 6b65 7973 2864 6963 746f 2c6c  ing_keys(dicto,l
+00073560: 6973 745f 6b65 7973 293a 0d0a 2020 2020  ist_keys):..    
+00073570: 2727 2752 6574 7572 6e20 6120 6c69 7374  '''Return a list
+00073580: 206f 6620 7661 6c75 6573 206d 6174 6368   of values match
+00073590: 696e 6720 6b65 7973 2069 6e20 6120 6469  ing keys in a di
+000735a0: 6374 696f 6e61 7279 0d0a 2020 2020 6672  ctionary..    fr
+000735b0: 6f6d 2061 206c 6973 7420 6f66 206b 6579  om a list of key
+000735c0: 732e 2052 6574 7572 6e73 2056 616c 7565  s. Returns Value
+000735d0: 7320 696e 2074 6865 2053 616d 6520 6f72  s in the Same or
+000735e0: 6465 7220 6173 2074 6865 204c 6973 7420  der as the List 
+000735f0: 4b65 7973 2e0d 0a20 2020 2027 2727 0d0a  Keys...    '''..
+00073600: 2020 2020 7265 7375 6c74 7320 3d20 5b5d      results = []
+00073610: 0d0a 2020 2020 666f 7220 6561 6368 2069  ..    for each i
+00073620: 6e20 6c69 7374 5f6b 6579 733a 0d0a 2020  n list_keys:..  
+00073630: 2020 2020 2020 7265 7375 6c74 732e 6170        results.ap
+00073640: 7065 6e64 2864 6963 746f 5b65 6163 685d  pend(dicto[each]
+00073650: 290d 0a20 2020 2072 6574 7572 6e20 7265  )..    return re
+00073660: 7375 6c74 730d 0a23 2323 2323 2323 2323  sults..#########
+00073670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000736a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000736b0: 2323 2323 2323 2323 230d 0a64 6566 2072  #########..def r
+000736c0: 656d 6f76 655f 6869 6768 6c79 5f63 6f72  emove_highly_cor
+000736d0: 7265 6c61 7465 645f 7661 7273 5f66 6173  related_vars_fas
+000736e0: 7428 6466 2c20 636f 7272 5f6c 696d 6974  t(df, corr_limit
+000736f0: 3d30 2e37 3029 3a0d 0a20 2020 2022 2222  =0.70):..    """
+00073700: 0d0a 2020 2020 5468 6973 2069 7320 6120  ..    This is a 
+00073710: 7369 6d70 6c65 206d 6574 686f 6420 746f  simple method to
+00073720: 2072 656d 6f76 6520 6869 6768 6c79 2063   remove highly c
+00073730: 6f72 7265 6c61 7465 6420 6665 6174 7572  orrelated featur
+00073740: 6573 2066 6173 7420 7573 696e 6720 5065  es fast using Pe
+00073750: 6172 736f 6e27 7320 436f 7272 656c 6174  arson's Correlat
+00073760: 696f 6e2e 0d0a 2020 2020 5573 6520 7468  ion...    Use th
+00073770: 6973 206f 6e6c 7920 666f 7220 666c 6f61  is only for floa
+00073780: 7420 616e 6420 696e 7465 6765 7220 7661  t and integer va
+00073790: 7269 6162 6c65 732e 2049 7420 7769 6c6c  riables. It will
+000737a0: 2061 7574 6f6d 6174 6963 616c 6c79 2073   automatically s
+000737b0: 656c 6563 7420 7468 6f73 6520 6f6e 6c79  elect those only
+000737c0: 2e0d 0a20 2020 2049 7420 6361 6e20 6265  ...    It can be
+000737d0: 2075 7365 6420 666f 7220 7665 7279 206c   used for very l
+000737e0: 6172 6765 2064 6174 6120 7365 7473 2077  arge data sets w
+000737f0: 6865 7265 2066 6561 7475 7265 7769 7a20  here featurewiz 
+00073800: 6861 7320 7472 6f75 626c 6520 7769 7468  has trouble with
+00073810: 206d 656d 6f72 790d 0a20 2020 2022 2222   memory..    """
+00073820: 0d0a 2020 2020 2320 4372 6561 7469 6e67  ..    # Creating
+00073830: 2063 6f72 7265 6c61 7469 6f6e 206d 6174   correlation mat
+00073840: 7269 780d 0a20 2020 2063 6f72 5f6d 6174  rix..    cor_mat
+00073850: 7269 7820 3d20 6466 2e63 6f72 7228 292e  rix = df.corr().
+00073860: 6162 7328 292e 6173 7479 7065 286e 702e  abs().astype(np.
+00073870: 666c 6f61 7431 3629 0d0a 2020 2020 2320  float16)..    # 
+00073880: 5365 6c65 6374 696e 6720 7570 7065 7220  Selecting upper 
+00073890: 7472 6961 6e67 6c65 206f 6620 636f 7272  triangle of corr
+000738a0: 656c 6174 696f 6e20 6d61 7472 6978 0d0a  elation matrix..
+000738b0: 2020 2020 7570 7065 725f 7472 6920 3d20      upper_tri = 
+000738c0: 636f 725f 6d61 7472 6978 2e77 6865 7265  cor_matrix.where
+000738d0: 286e 702e 7472 6975 286e 702e 6f6e 6573  (np.triu(np.ones
+000738e0: 2863 6f72 5f6d 6174 7269 782e 7368 6170  (cor_matrix.shap
+000738f0: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
+00073900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073910: 2020 2020 2020 206b 3d31 292e 6173 7479         k=1).asty
+00073920: 7065 286e 702e 626f 6f6c 2929 0d0a 2020  pe(np.bool))..  
+00073930: 2020 2320 4669 6e64 696e 6720 696e 6465    # Finding inde
+00073940: 7820 6f66 2066 6561 7475 7265 2063 6f6c  x of feature col
+00073950: 756d 6e73 2077 6974 6820 636f 7272 656c  umns with correl
+00073960: 6174 696f 6e20 6772 6561 7465 7220 7468  ation greater th
+00073970: 616e 2030 2e39 350d 0a20 2020 2074 6f5f  an 0.95..    to_
+00073980: 6472 6f70 203d 205b 636f 6c75 6d6e 2066  drop = [column f
+00073990: 6f72 2063 6f6c 756d 6e20 696e 2075 7070  or column in upp
+000739a0: 6572 5f74 7269 2e63 6f6c 756d 6e73 2069  er_tri.columns i
+000739b0: 6620 616e 7928 7570 7065 725f 7472 695b  f any(upper_tri[
+000739c0: 636f 6c75 6d6e 5d20 3e20 636f 7272 5f6c  column] > corr_l
+000739d0: 696d 6974 295d 0d0a 2020 2020 7072 696e  imit)]..    prin
+000739e0: 7428 293b 0d0a 2020 2020 7072 696e 7428  t();..    print(
+000739f0: 2748 6967 686c 7920 636f 7272 656c 6174  'Highly correlat
+00073a00: 6564 2063 6f6c 756d 6e73 2074 6f20 7265  ed columns to re
+00073a10: 6d6f 7665 3a20 2573 2720 2574 6f5f 6472  move: %s' %to_dr
+00073a20: 6f70 290d 0a20 2020 2072 6574 7572 6e20  op)..    return 
+00073a30: 746f 5f64 726f 700d 0a23 2323 2323 2323  to_drop..#######
+00073a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00073a80: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00073a90: 6465 6620 6164 645f 656e 7472 6f70 795f  def add_entropy_
+00073aa0: 6269 6e6e 696e 6728 7465 6d70 5f74 7261  binning(temp_tra
+00073ab0: 696e 2c20 7461 7267 2c20 6e75 6d5f 7661  in, targ, num_va
+00073ac0: 7273 2c20 696d 706f 7274 616e 745f 6665  rs, important_fe
+00073ad0: 6174 7572 6573 2c20 7465 6d70 5f74 6573  atures, temp_tes
+00073ae0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+00073af0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00073b00: 7479 7065 2c20 656e 7472 6f70 795f 6269  type, entropy_bi
+00073b10: 6e6e 696e 672c 7665 7262 6f73 653d 3029  nning,verbose=0)
+00073b20: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+00073b30: 2020 2020 2323 2323 2323 2020 2054 6869      ######   Thi
+00073b40: 7320 6973 2077 6865 7265 2077 6520 646f  s is where we do
+00073b50: 2045 4e54 524f 5059 2042 494e 4e49 4e47   ENTROPY BINNING
+00073b60: 204f 4620 434f 4e54 494e 554f 5553 2056   OF CONTINUOUS V
+00073b70: 4152 5320 2323 2323 2323 2323 2323 230d  ARS ###########.
+00073b80: 0a20 2020 2020 2020 2023 2323 2320 4974  .        #### It
+00073b90: 2069 7320 6265 7374 2074 6f20 646f 2042   is best to do B
+00073ba0: 696e 6e69 6e67 206f 6e20 4f4e 4c59 206f  inning on ONLY o
+00073bb0: 6e20 7468 6520 746f 7020 6d6f 7374 2076  n the top most v
+00073bc0: 6172 6961 626c 6573 2066 726f 6d20 496d  ariables from Im
+00073bd0: 706f 7274 616e 745f 4665 6174 7572 6573  portant_Features
+00073be0: 210d 0a20 2020 2020 2020 2023 2323 2320  !..        #### 
+00073bf0: 4d61 6b65 2073 7572 6520 7468 6174 2074  Make sure that t
+00073c00: 6865 2054 6f70 2032 2d31 3020 7661 7273  he Top 2-10 vars
+00073c10: 2061 7265 2061 6c6c 2043 4f4e 5449 4e55   are all CONTINU
+00073c20: 4f55 5320 5641 5253 2120 4f74 6865 7277  OUS VARS! Otherw
+00073c30: 6973 6520 4269 6e6e 696e 6720 6973 2057  ise Binning is W
+00073c40: 6173 7465 210d 0a20 2020 2020 2020 2023  aste!..        #
+00073c50: 2323 2320 5468 6973 206d 6574 686f 6420  ### This method 
+00073c60: 656e 7375 7265 7320 796f 7520 6765 7420  ensures you get 
+00073c70: 7468 6520 4265 7374 2052 6573 756c 7473  the Best Results
+00073c80: 2062 7920 6765 6e65 7261 6c69 7a69 6e67   by generalizing
+00073c90: 206f 6e20 7468 6520 746f 7020 6e75 6d65   on the top nume
+00073ca0: 7269 6320 7661 7273 210d 0a20 2020 2022  ric vars!..    "
+00073cb0: 2222 0d0a 2020 2020 7465 6d70 5f74 7261  ""..    temp_tra
+00073cc0: 696e 203d 2063 6f70 792e 6465 6570 636f  in = copy.deepco
+00073cd0: 7079 2874 656d 705f 7472 6169 6e29 0d0a  py(temp_train)..
+00073ce0: 2020 2020 7465 6d70 5f74 6573 7420 3d20      temp_test = 
+00073cf0: 636f 7079 2e64 6565 7063 6f70 7928 7465  copy.deepcopy(te
+00073d00: 6d70 5f74 6573 7429 0d0a 2020 2020 6d61  mp_test)..    ma
+00073d10: 785f 6465 7074 6820 3d20 3130 0d0a 2020  x_depth = 10..  
+00073d20: 2020 7365 6564 203d 2039 390d 0a20 2020    seed = 99..   
+00073d30: 206e 756d 5f76 6172 7320 3d20 636f 7079   num_vars = copy
+00073d40: 2e64 6565 7063 6f70 7928 6e75 6d5f 7661  .deepcopy(num_va
+00073d50: 7273 290d 0a20 2020 2063 6f6e 7469 6e75  rs)..    continu
+00073d60: 6f75 735f 7661 7273 203d 2063 6f70 792e  ous_vars = copy.
+00073d70: 6465 6570 636f 7079 286e 756d 5f76 6172  deepcopy(num_var
+00073d80: 7329 0d0a 2020 2020 696d 706f 7274 616e  s)..    importan
+00073d90: 745f 6665 6174 7572 6573 203d 2063 6f70  t_features = cop
+00073da0: 792e 6465 6570 636f 7079 2869 6d70 6f72  y.deepcopy(impor
+00073db0: 7461 6e74 5f66 6561 7475 7265 7329 0d0a  tant_features)..
+00073dc0: 2020 2020 7072 696e 7428 2744 6574 6572      print('Deter
+00073dd0: 6d69 6e69 6e67 2077 6869 6368 206f 6620  mining which of 
+00073de0: 2564 2063 6f6e 7469 6e75 6f75 7320 7661  %d continuous va
+00073df0: 7269 6162 6c65 7320 7368 6f75 6c64 2062  riables should b
+00073e00: 6520 456e 7472 6f70 7920 4269 6e6e 6564  e Entropy Binned
+00073e10: 2e2e 2e27 2025 6c65 6e28 636f 6e74 696e  ...' %len(contin
+00073e20: 756f 7573 5f76 6172 7329 290d 0a20 2020  uous_vars))..   
+00073e30: 2069 6620 6c65 6e28 636f 6e74 696e 756f   if len(continuo
+00073e40: 7573 5f76 6172 7329 203e 2030 2061 6e64  us_vars) > 0 and
+00073e50: 206c 656e 2863 6f6e 7469 6e75 6f75 735f   len(continuous_
+00073e60: 7661 7273 2920 3c3d 2032 3a0d 0a20 2020  vars) <= 2:..   
+00073e70: 2020 2020 206d 6178 5f64 6570 7468 203d       max_depth =
+00073e80: 2020 320d 0a20 2020 2020 2020 2063 6f6e    2..        con
+00073e90: 7469 6e75 6f75 735f 7661 7273 203d 2063  tinuous_vars = c
+00073ea0: 6f6e 7469 6e75 6f75 735f 7661 7273 5b3a  ontinuous_vars[:
+00073eb0: 5d0d 0a20 2020 2065 6c69 6620 6c65 6e28  ]..    elif len(
+00073ec0: 636f 6e74 696e 756f 7573 5f76 6172 7329  continuous_vars)
+00073ed0: 203e 2032 2061 6e64 206c 656e 2863 6f6e   > 2 and len(con
+00073ee0: 7469 6e75 6f75 735f 7661 7273 2920 3c3d  tinuous_vars) <=
+00073ef0: 2035 3a0d 0a20 2020 2020 2020 206d 6178   5:..        max
+00073f00: 5f64 6570 7468 203d 206c 656e 2863 6f6e  _depth = len(con
+00073f10: 7469 6e75 6f75 735f 7661 7273 2920 2d20  tinuous_vars) - 
+00073f20: 320d 0a20 2020 2020 2020 2063 6f6e 7469  2..        conti
+00073f30: 6e75 6f75 735f 7661 7273 203d 2063 6f6e  nuous_vars = con
+00073f40: 7469 6e75 6f75 735f 7661 7273 5b3a 325d  tinuous_vars[:2]
+00073f50: 0d0a 2020 2020 656c 6966 206c 656e 2863  ..    elif len(c
+00073f60: 6f6e 7469 6e75 6f75 735f 7661 7273 2920  ontinuous_vars) 
+00073f70: 3e20 3520 616e 6420 6c65 6e28 636f 6e74  > 5 and len(cont
+00073f80: 696e 756f 7573 5f76 6172 7329 203c 3d20  inuous_vars) <= 
+00073f90: 3130 3a0d 0a20 2020 2020 2020 206d 6178  10:..        max
+00073fa0: 5f64 6570 7468 203d 2035 0d0a 2020 2020  _depth = 5..    
+00073fb0: 2020 2020 636f 6e74 696e 756f 7573 5f76      continuous_v
+00073fc0: 6172 7320 3d20 636f 6e74 696e 756f 7573  ars = continuous
+00073fd0: 5f76 6172 735b 3a35 5d0d 0a20 2020 2065  _vars[:5]..    e
+00073fe0: 6c69 6620 6c65 6e28 636f 6e74 696e 756f  lif len(continuo
+00073ff0: 7573 5f76 6172 7329 203e 2031 3020 616e  us_vars) > 10 an
+00074000: 6420 6c65 6e28 636f 6e74 696e 756f 7573  d len(continuous
+00074010: 5f76 6172 7329 203c 3d20 3530 3a0d 0a20  _vars) <= 50:.. 
+00074020: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
+00074030: 203d 206d 6178 5f64 6570 7468 0d0a 2020   = max_depth..  
+00074040: 2020 2020 2020 636f 6e74 696e 756f 7573        continuous
+00074050: 5f76 6172 7320 3d20 636f 6e74 696e 756f  _vars = continuo
+00074060: 7573 5f76 6172 735b 3a31 305d 0d0a 2020  us_vars[:10]..  
+00074070: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00074080: 206d 6178 5f64 6570 7468 203d 206d 6178   max_depth = max
+00074090: 5f64 6570 7468 0d0a 2020 2020 2020 2020  _depth..        
+000740a0: 636f 6e74 696e 756f 7573 5f76 6172 7320  continuous_vars 
+000740b0: 3d20 636f 6e74 696e 756f 7573 5f76 6172  = continuous_var
+000740c0: 735b 3a35 305d 0d0a 2020 2020 6e65 775f  s[:50]..    new_
+000740d0: 6269 6e63 6f6c 7320 3d20 5b5d 0d0a 2020  bincols = []..  
+000740e0: 2020 2323 2320 2020 5468 6973 2069 7320    ###   This is 
+000740f0: 616e 2041 7765 736f 6d65 2045 6e74 726f  an Awesome Entro
+00074100: 7079 2042 6173 6564 2042 696e 6e69 6e67  py Based Binning
+00074110: 204d 6574 686f 6420 666f 7220 436f 6e74   Method for Cont
+00074120: 696e 756f 7573 2056 6172 6961 626c 6573  inuous Variables
+00074130: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+00074140: 2020 6672 6f6d 2073 6b6c 6561 726e 2e74    from sklearn.t
+00074150: 7265 6520 696d 706f 7274 2044 6563 6973  ree import Decis
+00074160: 696f 6e54 7265 6552 6567 7265 7373 6f72  ionTreeRegressor
+00074170: 2c20 4465 6369 7369 6f6e 5472 6565 436c  , DecisionTreeCl
+00074180: 6173 7369 6669 6572 0d0a 2020 2020 6966  assifier..    if
+00074190: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+000741a0: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+000741b0: 2020 2020 2063 6c66 203d 2044 6563 6973       clf = Decis
+000741c0: 696f 6e54 7265 6552 6567 7265 7373 6f72  ionTreeRegressor
+000741d0: 2863 7269 7465 7269 6f6e 3d27 6d73 6527  (criterion='mse'
+000741e0: 2c6d 696e 5f73 616d 706c 6573 5f6c 6561  ,min_samples_lea
+000741f0: 663d 322c 0d0a 2020 2020 2020 2020 2020  f=2,..          
 00074200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074210: 2020 2020 6269 6e63 6f6c 203d 2065 6163      bincol = eac
-00074220: 685f 6e75 6d2b 275f 6269 6e27 0d0a 2020  h_num+'_bin'..  
+00074210: 2020 2020 2020 2020 2020 6d61 785f 6465            max_de
+00074220: 7074 683d 6d61 785f 6465 7074 682c 0d0a  pth=max_depth,..
 00074230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074240: 2020 7465 6d70 5f74 6573 745b 6269 6e63    temp_test[binc
-00074250: 6f6c 5d20 3d20 6e70 2e64 6967 6974 697a  ol] = np.digitiz
-00074260: 6528 7465 6d70 5f74 6573 745b 6561 6368  e(temp_test[each
-00074270: 5f6e 756d 5d2e 7661 6c75 6573 2c20 656e  _num].values, en
-00074280: 7472 6f70 795f 7468 7265 7368 6f6c 6429  tropy_threshold)
-00074290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000742a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000742b0: 2020 2020 2020 2020 2020 2020 2062 696e               bin
-000742c0: 636f 6c20 3d20 2762 696e 5f27 2b73 7472  col = 'bin_'+str
-000742d0: 2865 6163 685f 6e75 6d29 0d0a 2020 2020  (each_num)..    
-000742e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000742f0: 7465 6d70 5f74 6573 745b 6269 6e63 6f6c  temp_test[bincol
-00074300: 5d20 3d20 6e70 2e64 6967 6974 697a 6528  ] = np.digitize(
-00074310: 7465 6d70 5f74 6573 745b 6561 6368 5f6e  temp_test[each_n
-00074320: 756d 5d2e 7661 6c75 6573 2c20 656e 7472  um].values, entr
-00074330: 6f70 795f 7468 7265 7368 6f6c 6429 0d0a  opy_threshold)..
-00074340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074350: 2323 2323 2057 6520 4472 6f70 2074 6865  #### We Drop the
-00074360: 206f 7269 6769 6e61 6c20 636f 6e74 696e   original contin
-00074370: 756f 7573 2076 6172 6961 626c 6520 6166  uous variable af
-00074380: 7465 7220 796f 7520 6861 7665 2063 7265  ter you have cre
-00074390: 6174 6564 2074 6865 2062 696e 2077 6865  ated the bin whe
-000743a0: 6e20 466c 6167 2069 7320 7472 7565 0d0a  n Flag is true..
-000743b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000743c0: 2323 2320 5765 2044 6f6e 2774 2064 726f  ### We Don't dro
-000743d0: 7020 7468 6573 6520 6f72 6967 696e 616c  p these original
-000743e0: 206e 756d 6572 6963 2076 6172 7320 7369   numeric vars si
-000743f0: 6e63 6520 7468 6579 2077 696c 6c20 6265  nce they will be
-00074400: 2075 7365 6420 6c61 7465 7220 666f 7220   used later for 
-00074410: 6675 6c6c 2074 7261 696e 2062 696e 6e69  full train binni
-00074420: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-00074430: 6966 2065 6e74 726f 7079 5f62 696e 6e69  if entropy_binni
-00074440: 6e67 3a0d 0a20 2020 2020 2020 2020 2020  ng:..           
-00074450: 2020 2020 2023 2323 2049 6e20 7468 6520       ### In the 
-00074460: 7365 636f 6e64 2074 696d 652c 2077 6520  second time, we 
-00074470: 646f 6e27 7420 7265 7065 6174 2061 6464  don't repeat add
-00074480: 696e 6720 6269 6e6e 6564 2076 6172 7320  ing binned vars 
-00074490: 7369 6e63 6520 7468 6579 2068 6176 6520  since they have 
-000744a0: 616c 7265 6164 7920 6265 656e 2061 6464  already been add
-000744b0: 6564 210d 0a20 2020 2020 2020 2020 2020  ed!..           
-000744c0: 2020 2020 2023 2323 2320 7765 2061 6c73       #### we als
-000744d0: 6f20 6d61 6b65 2073 7572 6520 7468 6174  o make sure that
-000744e0: 2074 6865 206f 7269 6720 6e75 6d20 7661   the orig num va
-000744f0: 7273 2077 6869 6368 2068 6176 6520 6e6f  rs which have no
-00074500: 7720 6265 656e 2062 696e 6e65 6420 6172  w been binned ar
-00074510: 6520 7265 6d6f 7665 6421 0d0a 2020 2020  e removed!..    
-00074520: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
-00074530: 5f74 7261 696e 2e64 726f 7028 6561 6368  _train.drop(each
-00074540: 5f6e 756d 2c61 7869 733d 312c 696e 706c  _num,axis=1,inpl
-00074550: 6163 653d 5472 7565 290d 0a20 2020 2020  ace=True)..     
-00074560: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-00074570: 7065 2874 656d 705f 7465 7374 2920 213d  pe(temp_test) !=
-00074580: 2073 7472 3a0d 0a20 2020 2020 2020 2020   str:..         
-00074590: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
-000745a0: 7465 7374 2e64 726f 7028 6561 6368 5f6e  test.drop(each_n
-000745b0: 756d 2c61 7869 733d 312c 696e 706c 6163  um,axis=1,inplac
-000745c0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
-000745d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000745e0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-000745f0: 2049 6e20 7468 6520 6669 7273 7420 7469   In the first ti
-00074600: 6d65 2c20 7765 2061 6464 2062 696e 6e65  me, we add binne
-00074610: 6420 7661 7273 2074 6f20 2069 6d70 6f72  d vars to  impor
-00074620: 7461 6e74 5f66 6561 7475 7265 7320 2023  tant_features  #
-00074630: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00074640: 2020 2020 2323 2320 496e 2074 6865 2073      ### In the s
-00074650: 6563 6f6e 6420 7469 6d65 2c20 7765 2064  econd time, we d
-00074660: 6f6e 2774 2072 6570 6561 7420 7468 6174  on't repeat that
-00074670: 2073 696e 6365 2074 6865 7920 6861 7665   since they have
-00074680: 2061 6c72 6561 6479 2062 6565 6e20 6164   already been ad
-00074690: 6465 6421 0d0a 2020 2020 2020 2020 2020  ded!..          
-000746a0: 2020 2020 2020 696d 706f 7274 616e 745f        important_
-000746b0: 6665 6174 7572 6573 2e61 7070 656e 6428  features.append(
-000746c0: 6269 6e63 6f6c 290d 0a20 2020 2020 2020  bincol)..       
-000746d0: 2020 2020 206e 756d 5f76 6172 732e 6170       num_vars.ap
-000746e0: 7065 6e64 2862 696e 636f 6c29 0d0a 2020  pend(bincol)..  
-000746f0: 2020 2020 2020 2020 2020 696d 706f 7274            import
-00074700: 616e 745f 6665 6174 7572 6573 2e72 656d  ant_features.rem
-00074710: 6f76 6528 6561 6368 5f6e 756d 290d 0a20  ove(each_num).. 
-00074720: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00074730: 4472 6f70 2074 6865 7365 206f 7269 6769  Drop these origi
-00074740: 6e61 6c20 636f 6e74 696e 756f 7573 2076  nal continuous v
-00074750: 6172 6961 626c 6520 6672 6f6d 2066 7572  ariable from fur
-00074760: 7468 6572 2063 6f6e 7369 6465 7261 7469  ther considerati
-00074770: 6f6e 2074 6861 7427 7320 616c 6c21 2023  on that's all! #
-00074780: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00074790: 6e75 6d5f 7661 7273 2e72 656d 6f76 6528  num_vars.remove(
-000747a0: 6561 6368 5f6e 756d 290d 0a20 2020 2020  each_num)..     
-000747b0: 2020 2020 2020 206e 6577 5f62 696e 636f         new_binco
-000747c0: 6c73 2e61 7070 656e 6428 6269 6e63 6f6c  ls.append(bincol
-000747d0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-000747e0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-000747f0: 7072 696e 7428 2745 7272 6f72 2069 6e20  print('Error in 
-00074800: 2573 2064 7572 696e 6720 456e 7472 6f70  %s during Entrop
-00074810: 7920 4269 6e6e 696e 6727 2025 6561 6368  y Binning' %each
-00074820: 5f6e 756d 290d 0a20 2020 2070 7269 6e74  _num)..    print
-00074830: 2827 2020 2020 5365 6c65 6374 6564 2061  ('    Selected a
-00074840: 6e64 2062 696e 6e65 6420 6f6e 6c79 2074  nd binned only t
-00074850: 6f70 2025 7320 636f 6e74 696e 756f 7573  op %s continuous
-00074860: 2076 6172 6961 626c 6573 2e27 2025 286c   variables.' %(l
-00074870: 656e 286e 6577 5f62 696e 636f 6c73 2929  en(new_bincols))
-00074880: 290d 0a20 2020 2069 6620 7665 7262 6f73  )..    if verbos
-00074890: 6520 616e 6420 6c65 6e28 6e65 775f 6269  e and len(new_bi
-000748a0: 6e63 6f6c 7329 203c 3d20 3330 3a0d 0a20  ncols) <= 30:.. 
-000748b0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-000748c0: 2020 2573 2720 256e 6577 5f62 696e 636f    %s' %new_binco
-000748d0: 6c73 290d 0a20 2020 2072 6574 7572 6e20  ls)..    return 
-000748e0: 7465 6d70 5f74 7261 696e 2c20 6e75 6d5f  temp_train, num_
-000748f0: 7661 7273 2c20 696d 706f 7274 616e 745f  vars, important_
-00074900: 6665 6174 7572 6573 2c20 7465 6d70 5f74  features, temp_t
-00074910: 6573 740d 0a23 2323 2323 2323 2323 2323  est..###########
-00074920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074960: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
-00074970: 2e62 6173 6520 696d 706f 7274 2042 6173  .base import Bas
-00074980: 6545 7374 696d 6174 6f72 2c20 436c 6173  eEstimator, Clas
-00074990: 7369 6669 6572 4d69 7869 6e2c 2054 7261  sifierMixin, Tra
-000749a0: 6e73 666f 726d 6572 4d69 7869 6e0d 0a66  nsformerMixin..f
-000749b0: 726f 6d20 696d 626c 6561 726e 2e6f 7665  rom imblearn.ove
-000749c0: 725f 7361 6d70 6c69 6e67 2069 6d70 6f72  r_sampling impor
-000749d0: 7420 534d 4f54 452c 2053 564d 534d 4f54  t SMOTE, SVMSMOT
-000749e0: 450d 0a66 726f 6d20 696d 626c 6561 726e  E..from imblearn
-000749f0: 2e6f 7665 725f 7361 6d70 6c69 6e67 2069  .over_sampling i
-00074a00: 6d70 6f72 7420 4144 4153 594e 2c20 534d  mport ADASYN, SM
-00074a10: 4f54 454e 430d 0a66 726f 6d20 736b 6c65  OTENC..from skle
-00074a20: 6172 6e2e 636c 7573 7465 7220 696d 706f  arn.cluster impo
-00074a30: 7274 204b 4d65 616e 730d 0a64 6566 206b  rt KMeans..def k
-00074a40: 6d65 616e 735f 7265 7361 6d70 6c65 7228  means_resampler(
-00074a50: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
-00074a60: 2c20 7461 7267 6574 2c20 736d 6f74 653d  , target, smote=
-00074a70: 2222 2c20 7665 7262 6f73 653d 3029 3a0d  "", verbose=0):.
-00074a80: 0a20 2020 2022 2222 0d0a 2020 2020 5468  .    """..    Th
-00074a90: 6973 2066 756e 6374 696f 6e20 636f 6e76  is function conv
-00074aa0: 6572 7473 2061 2052 6567 7265 7373 696f  erts a Regressio
-00074ab0: 6e20 7072 6f62 6c65 6d20 696e 746f 2061  n problem into a
-00074ac0: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
-00074ad0: 7072 6f62 6c65 6d20 746f 2065 6e61 626c  problem to enabl
-00074ae0: 6520 534d 4f54 4521 0d0a 2020 2020 4974  e SMOTE!..    It
-00074af0: 2069 7320 6120 7665 7279 2073 696d 706c   is a very simpl
-00074b00: 6520 7761 7920 746f 2073 656e 6420 796f  e way to send yo
-00074b10: 7572 2078 5f74 7261 696e 2c20 795f 7472  ur x_train, y_tr
-00074b20: 6169 6e20 696e 2061 6e64 2067 6574 2062  ain in and get b
-00074b30: 6163 6b20 616e 206f 7665 7273 616d 706c  ack an oversampl
-00074b40: 6564 2078 5f74 7261 696e 2c20 795f 7472  ed x_train, y_tr
-00074b50: 6169 6e2e 0d0a 2020 2020 5768 7920 6973  ain...    Why is
-00074b60: 2074 6869 7320 6e65 6564 6564 2069 6e20   this needed in 
-00074b70: 4d61 6368 696e 6520 4c65 6172 6e69 6e67  Machine Learning
-00074b80: 2070 726f 626c 656d 733f 0d0a 2020 2020   problems?..    
-00074b90: 2020 2020 2049 6e20 496d 6261 6c61 6e63       In Imbalanc
-00074ba0: 6564 2064 6174 6173 6574 732c 2065 7370  ed datasets, esp
-00074bb0: 2e20 736b 6577 6564 2072 6567 7265 7373  . skewed regress
-00074bc0: 696f 6e20 7072 6f62 6c65 6d73 2077 6865  ion problems whe
-00074bd0: 7265 2074 6865 2074 6172 6765 7420 7661  re the target va
-00074be0: 7269 6162 6c65 2069 7320 736b 6577 6564  riable is skewed
-00074bf0: 2c20 7468 6973 2069 7320 6e65 6564 6564  , this is needed
-00074c00: 2e0d 0a20 2020 2054 7279 2074 6869 7320  ...    Try this 
-00074c10: 6f6e 2079 6f75 7220 736b 6577 6564 2052  on your skewed R
-00074c20: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
-00074c30: 6d73 2061 6e64 2073 6565 2077 6861 7420  ms and see what 
-00074c40: 7265 7375 6c74 7320 796f 7520 6765 742e  results you get.
-00074c50: 2049 7420 7368 6f75 6c64 2062 6520 6265   It should be be
-00074c60: 7474 6572 2e0d 0a20 2020 202d 2d2d 2d2d  tter...    -----
-00074c70: 2d2d 2d2d 2d0d 0a20 2020 2049 6e70 7574  -----..    Input
-00074c80: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00074c90: 2d0d 0a20 2020 2078 5f74 7261 696e 203a  -..    x_train :
-00074ca0: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
-00074cb0: 653a 2079 6f75 206d 7573 7420 7365 6e64  e: you must send
-00074cc0: 2069 6e20 7468 6520 6461 7461 2077 6974   in the data wit
-00074cd0: 6820 7072 6564 6963 746f 7273 206f 6e6c  h predictors onl
-00074ce0: 792e 0d0a 2020 2020 6d69 6e5f 6e5f 7361  y...    min_n_sa
-00074cf0: 6d70 6c65 7320 3a20 696e 742c 2064 6566  mples : int, def
-00074d00: 6175 6c74 3d35 3a20 6d69 6e20 6e75 6d62  ault=5: min numb
-00074d10: 6572 206f 6620 7361 6d70 6c65 7320 6265  er of samples be
-00074d20: 6c6f 7720 7768 6963 6820 796f 7520 636f  low which you co
-00074d30: 6d62 696e 6520 6269 6e73 0d0a 2020 2020  mbine bins..    
-00074d40: 6269 6e73 203a 2069 6e74 2c20 6465 6661  bins : int, defa
-00074d50: 756c 743d 333a 2068 6f77 206d 616e 7920  ult=3: how many 
-00074d60: 6269 6e73 2079 6f75 2077 616e 7420 746f  bins you want to
-00074d70: 2073 706c 6974 2074 6172 6765 7420 696e   split target in
-00074d80: 746f 0d0a 0d0a 2020 2020 4f75 7470 7574  to....    Output
-00074d90: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00074da0: 2d0d 0a20 2020 206e 5f66 6561 7475 7265  -..    n_feature
-00074db0: 735f 203a 2069 6e74 0d0a 2020 2020 2020  s_ : int..      
-00074dc0: 2020 5468 6520 6e75 6d62 6572 206f 6620    The number of 
-00074dd0: 6665 6174 7572 6573 206f 6620 7468 6520  features of the 
-00074de0: 6461 7461 2070 6173 7365 6420 746f 203a  data passed to :
-00074df0: 6d65 7468 3a60 6669 7460 2e0d 0a20 2020  meth:`fit`...   
-00074e00: 2022 2222 0d0a 2020 2020 785f 7472 6169   """..    x_trai
-00074e10: 6e5f 6320 3d20 636f 7079 2e64 6565 7063  n_c = copy.deepc
-00074e20: 6f70 7928 785f 7472 6169 6e29 0d0a 2020  opy(x_train)..  
-00074e30: 2020 785f 7472 6169 6e5f 635b 7461 7267    x_train_c[targ
-00074e40: 6574 5d20 3d20 795f 7472 6169 6e2e 7661  et] = y_train.va
-00074e50: 6c75 6573 0d0a 0d0a 2020 2020 2320 5265  lues....    # Re
-00074e60: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
-00074e70: 2074 7572 6e65 6420 696e 746f 2043 6c61   turned into Cla
-00074e80: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
-00074e90: 6c65 6d0d 0a20 2020 206e 5f63 6c75 7374  lem..    n_clust
-00074ea0: 6572 7320 3d20 6d61 7828 332c 2069 6e74  ers = max(3, int
-00074eb0: 286e 702e 6c6f 6731 3028 6c65 6e28 795f  (np.log10(len(y_
-00074ec0: 7472 6169 6e29 2929 202b 2031 290d 0a20  train))) + 1).. 
-00074ed0: 2020 2023 2055 7365 204b 4d65 616e 7320     # Use KMeans 
-00074ee0: 746f 2066 696e 6420 6e61 7475 7261 6c20  to find natural 
-00074ef0: 636c 7573 7465 7273 2069 6e20 796f 7572  clusters in your
-00074f00: 2064 6174 610d 0a20 2020 206b 6d5f 6d6f   data..    km_mo
-00074f10: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
-00074f20: 6c75 7374 6572 733d 6e5f 636c 7573 7465  lusters=n_cluste
-00074f30: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
-00074f40: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
-00074f50: 743d 352c 0d0a 2020 2020 2020 2020 2020  t=5,..          
-00074f60: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-00074f70: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-00074f80: 2020 2323 2323 2072 656d 656d 6265 7220    #### remember 
-00074f90: 796f 7520 6d75 7374 2070 7265 6469 6374  you must predict
-00074fa0: 2075 7369 6e67 206f 6e6c 7920 7072 6564   using only pred
-00074fb0: 6963 746f 7220 7661 7269 6162 6c65 7321  ictor variables!
-00074fc0: 0d0a 2020 2020 795f 7472 6169 6e5f 6320  ..    y_train_c 
-00074fd0: 3d20 6b6d 5f6d 6f64 656c 2e66 6974 5f70  = km_model.fit_p
-00074fe0: 7265 6469 6374 2878 5f74 7261 696e 290d  redict(x_train).
-00074ff0: 0a0d 0a20 2020 2069 6620 7665 7262 6f73  ...    if verbos
-00075000: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-00075010: 2070 7269 6e74 2827 2020 2020 4e75 6d62   print('    Numb
-00075020: 6572 206f 6620 636c 7573 7465 7273 2063  er of clusters c
-00075030: 7265 6174 6564 203d 2025 6427 2025 6e5f  reated = %d' %n_
-00075040: 636c 7573 7465 7273 290d 0a0d 0a20 2020  clusters)....   
-00075050: 2023 2323 2320 4765 6e65 7261 7465 2074   #### Generate t
-00075060: 6865 206f 7665 722d 7361 6d70 6c65 6420  he over-sampled 
-00075070: 6461 7461 0d0a 2020 2020 2323 2323 2041  data..    #### A
-00075080: 4441 5359 4e20 2f20 534d 4f54 4520 6f76  DASYN / SMOTE ov
-00075090: 6572 7361 6d70 6c69 6e67 2023 2323 2323  ersampling #####
-000750a0: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-000750b0: 6e63 6528 736d 6f74 652c 2073 7472 293a  nce(smote, str):
-000750c0: 0d0a 2020 2020 2020 2020 785f 7472 6169  ..        x_trai
-000750d0: 6e5f 6578 742c 205f 203d 206f 7665 7273  n_ext, _ = overs
-000750e0: 616d 706c 655f 534d 4f54 4528 785f 7472  ample_SMOTE(x_tr
-000750f0: 6169 6e5f 632c 2079 5f74 7261 696e 5f63  ain_c, y_train_c
-00075100: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00075110: 2020 2020 2020 785f 7472 6169 6e5f 6578        x_train_ex
-00075120: 742c 205f 203d 2073 6d6f 7465 2e66 6974  t, _ = smote.fit
-00075130: 5f72 6573 616d 706c 6528 785f 7472 6169  _resample(x_trai
-00075140: 6e5f 632c 2079 5f74 7261 696e 5f63 290d  n_c, y_train_c).
-00075150: 0a20 2020 2079 5f74 7261 696e 5f65 7874  .    y_train_ext
-00075160: 203d 2078 5f74 7261 696e 5f65 7874 5b74   = x_train_ext[t
-00075170: 6172 6765 745d 2e76 616c 7565 730d 0a20  arget].values.. 
-00075180: 2020 2078 5f74 7261 696e 5f65 7874 2e64     x_train_ext.d
-00075190: 726f 7028 7461 7267 6574 2c20 6178 6973  rop(target, axis
-000751a0: 3d31 2c20 696e 706c 6163 653d 5472 7565  =1, inplace=True
-000751b0: 290d 0a20 2020 2072 6574 7572 6e20 2878  )..    return (x
-000751c0: 5f74 7261 696e 5f65 7874 2c20 795f 7472  _train_ext, y_tr
-000751d0: 6169 6e5f 6578 7429 0d0a 0d0a 2323 2323  ain_ext)....####
-000751e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000751f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075220: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00075230: 6672 6f6d 2073 6b6c 6561 726e 2e75 7469  from sklearn.uti
-00075240: 6c73 2e63 6c61 7373 5f77 6569 6768 7420  ls.class_weight 
-00075250: 696d 706f 7274 2063 6f6d 7075 7465 5f63  import compute_c
-00075260: 6c61 7373 5f77 6569 6768 740d 0a64 6566  lass_weight..def
-00075270: 2067 6574 5f63 6c61 7373 5f64 6973 7472   get_class_distr
-00075280: 6962 7574 696f 6e28 795f 696e 7075 7429  ibution(y_input)
-00075290: 3a0d 0a20 2020 2079 5f69 6e70 7574 203d  :..    y_input =
-000752a0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
-000752b0: 5f69 6e70 7574 290d 0a20 2020 2063 6c61  _input)..    cla
-000752c0: 7373 6573 203d 206e 702e 756e 6971 7565  sses = np.unique
-000752d0: 2879 5f69 6e70 7574 290d 0a20 2020 2078  (y_input)..    x
-000752e0: 7020 3d20 436f 756e 7465 7228 795f 696e  p = Counter(y_in
-000752f0: 7075 7429 0d0a 2020 2020 636c 6173 735f  put)..    class_
-00075300: 7765 6967 6874 7320 3d20 636f 6d70 7574  weights = comput
-00075310: 655f 636c 6173 735f 7765 6967 6874 2827  e_class_weight('
-00075320: 6261 6c61 6e63 6564 272c 2063 6c61 7373  balanced', class
-00075330: 6573 3d6e 702e 756e 6971 7565 2879 5f69  es=np.unique(y_i
-00075340: 6e70 7574 292c 2079 3d79 5f69 6e70 7574  nput), y=y_input
-00075350: 290d 0a20 2020 2069 6620 6c65 6e28 636c  )..    if len(cl
-00075360: 6173 735f 7765 6967 6874 735b 2863 6c61  ass_weights[(cla
-00075370: 7373 5f77 6569 6768 7473 3e20 3130 295d  ss_weights> 10)]
-00075380: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
-00075390: 636c 6173 735f 7765 6967 6874 7320 3d20  class_weights = 
-000753a0: 2863 6c61 7373 5f77 6569 6768 7473 2f31  (class_weights/1
-000753b0: 3029 0d0a 2020 2020 656c 7365 3a0d 0a20  0)..    else:.. 
-000753c0: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
-000753d0: 6768 7473 203d 2028 636c 6173 735f 7765  ghts = (class_we
-000753e0: 6967 6874 7329 0d0a 2020 2020 7072 696e  ights)..    prin
-000753f0: 7428 2720 2020 2063 6c61 7373 5f77 6569  t('    class_wei
-00075400: 6768 7473 203d 2025 7327 2025 636c 6173  ghts = %s' %clas
-00075410: 735f 7765 6967 6874 7329 0d0a 2020 2020  s_weights)..    
-00075420: 636c 6173 735f 7765 6967 6874 735b 2863  class_weights[(c
-00075430: 6c61 7373 5f77 6569 6768 7473 3c31 295d  lass_weights<1)]
-00075440: 3d31 0d0a 2020 2020 636c 6173 735f 726f  =1..    class_ro
-00075450: 7773 203d 2063 6c61 7373 5f77 6569 6768  ws = class_weigh
-00075460: 7473 2a5b 7870 5b78 5d20 666f 7220 7820  ts*[xp[x] for x 
-00075470: 696e 2063 6c61 7373 6573 5d0d 0a20 2020  in classes]..   
-00075480: 2063 6c61 7373 5f72 6f77 7320 3d20 636c   class_rows = cl
-00075490: 6173 735f 726f 7773 2e61 7374 7970 6528  ass_rows.astype(
-000754a0: 696e 7429 0d0a 2020 2020 636c 6173 735f  int)..    class_
-000754b0: 7765 6967 6874 6564 5f72 6f77 7320 3d20  weighted_rows = 
-000754c0: 6469 6374 287a 6970 2863 6c61 7373 6573  dict(zip(classes
-000754d0: 2c63 6c61 7373 5f72 6f77 7329 290d 0a20  ,class_rows)).. 
-000754e0: 2020 2070 7269 6e74 2827 2020 2020 636c     print('    cl
-000754f0: 6173 735f 7765 6967 6874 6564 5f72 6f77  ass_weighted_row
-00075500: 7320 3d20 2573 2720 2563 6c61 7373 5f77  s = %s' %class_w
-00075510: 6569 6768 7465 645f 726f 7773 290d 0a20  eighted_rows).. 
-00075520: 2020 2072 6574 7572 6e20 636c 6173 735f     return class_
-00075530: 7765 6967 6874 6564 5f72 6f77 730d 0a0d  weighted_rows...
-00075540: 0a64 6566 206f 7665 7273 616d 706c 655f  .def oversample_
-00075550: 534d 4f54 4528 582c 7929 3a0d 0a20 2020  SMOTE(X,y):..   
-00075560: 2023 696e 7075 7420 4461 7461 4672 616d   #input DataFram
-00075570: 650d 0a20 2020 2023 5820 e286 9249 6e64  e..    #X ...Ind
-00075580: 6570 656e 6465 6e74 2056 6172 6961 626c  ependent Variabl
-00075590: 6520 696e 2044 6174 6146 7261 6d65 5c0d  e in DataFrame\.
-000755a0: 0a20 2020 2023 7920 e286 9264 6570 656e  .    #y ...depen
-000755b0: 6465 6e74 2056 6172 6961 626c 6520 696e  dent Variable in
-000755c0: 2050 616e 6461 7320 4461 7461 4672 616d   Pandas DataFram
-000755d0: 6520 666f 726d 6174 0d0a 2020 2020 2320  e format..    # 
-000755e0: 4765 7420 7468 6520 636c 6173 7320 6469  Get the class di
-000755f0: 7374 7269 7562 7469 6f6e 2066 6f72 2070  striubtion for p
-00075600: 6572 666f 6d69 6e67 2072 656c 6174 6976  erfoming relativ
-00075610: 6520 7361 6d70 6c69 6e67 2069 6e20 7468  e sampling in th
-00075620: 6520 6e65 7874 206c 696e 650d 0a20 2020  e next line..   
-00075630: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
-00075640: 726f 7773 203d 2067 6574 5f63 6c61 7373  rows = get_class
-00075650: 5f64 6973 7472 6962 7574 696f 6e28 7929  _distribution(y)
-00075660: 0d0a 2020 2020 736d 6f74 6520 3d20 5356  ..    smote = SV
-00075670: 4d53 4d4f 5445 2820 7261 6e64 6f6d 5f73  MSMOTE( random_s
-00075680: 7461 7465 3d32 372c 0d0a 2020 2020 2020  tate=27,..      
-00075690: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-000756a0: 6c69 6e67 5f73 7472 6174 6567 793d 636c  ling_strategy=cl
-000756b0: 6173 735f 7765 6967 6874 6564 5f72 6f77  ass_weighted_row
-000756c0: 7329 0d0a 2020 2020 582c 2079 203d 2073  s)..    X, y = s
-000756d0: 6d6f 7465 2e66 6974 5f72 6573 616d 706c  mote.fit_resampl
-000756e0: 6528 582c 2079 290d 0a20 2020 2072 6574  e(X, y)..    ret
-000756f0: 7572 6e28 582c 7929 0d0a 0d0a 6465 6620  urn(X,y)....def 
-00075700: 6f76 6572 7361 6d70 6c65 5f41 4441 5359  oversample_ADASY
-00075710: 4e28 582c 7929 3a0d 0a20 2020 2023 696e  N(X,y):..    #in
-00075720: 7075 7420 4461 7461 4672 616d 650d 0a20  put DataFrame.. 
-00075730: 2020 2023 5820 e286 9249 6e64 6570 656e     #X ...Indepen
-00075740: 6465 6e74 2056 6172 6961 626c 6520 696e  dent Variable in
-00075750: 2044 6174 6146 7261 6d65 5c0d 0a20 2020   DataFrame\..   
-00075760: 2023 7920 e286 9264 6570 656e 6465 6e74   #y ...dependent
-00075770: 2056 6172 6961 626c 6520 696e 2050 616e   Variable in Pan
-00075780: 6461 7320 4461 7461 4672 616d 6520 666f  das DataFrame fo
-00075790: 726d 6174 0d0a 2020 2020 2320 4765 7420  rmat..    # Get 
-000757a0: 7468 6520 636c 6173 7320 6469 7374 7269  the class distri
-000757b0: 7562 7469 6f6e 2066 6f72 2070 6572 666f  ubtion for perfo
-000757c0: 6d69 6e67 2072 656c 6174 6976 6520 7361  ming relative sa
-000757d0: 6d70 6c69 6e67 2069 6e20 7468 6520 6e65  mpling in the ne
-000757e0: 7874 206c 696e 650d 0a20 2020 2063 6c61  xt line..    cla
-000757f0: 7373 5f77 6569 6768 7465 645f 726f 7773  ss_weighted_rows
-00075800: 203d 2067 6574 5f63 6c61 7373 5f64 6973   = get_class_dis
-00075810: 7472 6962 7574 696f 6e28 7929 0d0a 2020  tribution(y)..  
-00075820: 2020 2320 596f 7572 2066 6176 6f75 7269    # Your favouri
-00075830: 7465 206f 7665 7273 616d 706c 6572 0d0a  te oversampler..
-00075840: 2020 2020 736d 6f74 6520 3d20 4144 4153      smote = ADAS
-00075850: 594e 2872 616e 646f 6d5f 7374 6174 653d  YN(random_state=
-00075860: 3237 2c0d 0a20 2020 2020 2020 2020 2020  27,..           
-00075870: 2020 2020 2020 2020 7361 6d70 6c69 6e67          sampling
-00075880: 5f73 7472 6174 6567 793d 636c 6173 735f  _strategy=class_
-00075890: 7765 6967 6874 6564 5f72 6f77 7329 0d0a  weighted_rows)..
-000758a0: 2020 2020 582c 2079 203d 2073 6d6f 7465      X, y = smote
-000758b0: 2e66 6974 5f72 6573 616d 706c 6528 582c  .fit_resample(X,
-000758c0: 2079 290d 0a20 2020 2072 6574 7572 6e28   y)..    return(
-000758d0: 582c 7929 0d0a 2323 2323 2323 2323 2323  X,y)..##########
-000758e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000758f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075930: 230d 0a64 6566 206d 6172 7468 6173 5f63  #..def marthas_c
-00075940: 6f6c 756d 6e73 2864 6174 612c 7665 7262  olumns(data,verb
-00075950: 6f73 653d 3029 3a0d 0a20 2020 2022 2222  ose=0):..    """
-00075960: 0d0a 2020 2020 5468 6973 2070 726f 6772  ..    This progr
-00075970: 616d 2069 7320 6e61 6d65 6420 2069 6e20  am is named  in 
-00075980: 686f 6e6f 7220 6f66 206d 7920 6f6e 6520  honor of my one 
-00075990: 6f66 2073 7475 6465 6e74 732c 204d 6172  of students, Mar
-000759a0: 7468 612c 2077 686f 2063 616d 6520 7570  tha, who came up
-000759b0: 2077 6974 6820 7468 6520 6964 6561 2066   with the idea f
-000759c0: 6f72 2069 742e 0d0a 2020 2020 4974 2773  or it...    It's
-000759d0: 2061 206e 6561 7420 7761 7920 6f66 2070   a neat way of p
-000759e0: 7269 6e74 696e 6720 6461 7461 2074 7970  rinting data typ
-000759f0: 6573 2061 6e64 2069 6e66 6f72 6d61 7469  es and informati
-00075a00: 6f6e 2063 6f6d 7061 7265 6420 746f 2074  on compared to t
-00075a10: 6865 2062 6f72 696e 6720 6465 7363 7269  he boring descri
-00075a20: 6265 2829 2066 756e 6374 696f 6e20 696e  be() function in
-00075a30: 2050 616e 6461 732e 0d0a 2020 2020 2222   Pandas...    ""
-00075a40: 220d 0a20 2020 2064 6174 6120 3d20 6461  "..    data = da
-00075a50: 7461 5b3a 5d0d 0a20 2020 2070 7269 6e74  ta[:]..    print
-00075a60: 2827 4461 7461 2053 6574 2053 6861 7065  ('Data Set Shape
-00075a70: 3a20 2564 2072 6f77 732c 2025 6420 636f  : %d rows, %d co
-00075a80: 6c73 2720 2520 6461 7461 2e73 6861 7065  ls' % data.shape
-00075a90: 290d 0a20 2020 2069 6620 6461 7461 2e73  )..    if data.s
-00075aa0: 6861 7065 5b31 5d20 3e20 3330 3a0d 0a20  hape[1] > 30:.. 
-00075ab0: 2020 2020 2020 2070 7269 6e74 2827 546f         print('To
-00075ac0: 6f20 6d61 6e79 2063 6f6c 756d 6e73 2074  o many columns t
-00075ad0: 6f20 7072 696e 7427 290d 0a20 2020 2065  o print')..    e
-00075ae0: 6c73 653a 0d0a 2020 2020 2020 2020 6966  lse:..        if
-00075af0: 2076 6572 626f 7365 3d3d 313a 0d0a 2020   verbose==1:..  
-00075b00: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00075b10: 2720 2020 2041 6464 6974 696f 6e61 6c20  '    Additional 
-00075b20: 6465 7461 696c 7320 6f6e 2063 6f6c 756d  details on colum
-00075b30: 6e73 3a27 290d 0a20 2020 2020 2020 2020  ns:')..         
-00075b40: 2020 2066 6f72 2063 6f6c 2069 6e20 6461     for col in da
-00075b50: 7461 2e63 6f6c 756d 6e73 3a0d 0a20 2020  ta.columns:..   
-00075b60: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00075b70: 6e74 2827 5c74 2a20 2573 3a5c 7425 6420  nt('\t* %s:\t%d 
-00075b80: 6d69 7373 696e 672c 2025 6420 756e 6971  missing, %d uniq
-00075b90: 7565 732c 206d 6f73 7420 636f 6d6d 6f6e  ues, most common
-00075ba0: 3a20 2573 2720 2520 280d 0a20 2020 2020  : %s' % (..     
-00075bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075bc0: 2020 2063 6f6c 2c0d 0a20 2020 2020 2020     col,..       
-00075bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075be0: 2064 6174 615b 636f 6c5d 2e69 736e 756c   data[col].isnul
-00075bf0: 6c28 292e 7375 6d28 292c 0d0a 2020 2020  l().sum(),..    
-00075c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c10: 2020 2020 6461 7461 5b63 6f6c 5d2e 6e75      data[col].nu
-00075c20: 6e69 7175 6528 292c 0d0a 2020 2020 2020  nique(),..      
-00075c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c40: 2020 6461 7461 5b63 6f6c 5d2e 7661 6c75    data[col].valu
-00075c50: 655f 636f 756e 7473 2829 2e68 6561 6428  e_counts().head(
-00075c60: 3229 2e74 6f5f 6469 6374 2829 0d0a 2020  2).to_dict()..  
-00075c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c80: 2020 2929 0d0a 2020 2020 2020 2020 2020    ))..          
-00075c90: 2020 7072 696e 7428 272d 2d2d 2d2d 2d2d    print('-------
-00075ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d27 290d  -------------').
-00075ce0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00075cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075d30: 2323 230d 0a64 6566 2067 6574 5f73 697a  ###..def get_siz
-00075d40: 6528 6279 7465 732c 2073 7566 6669 783d  e(bytes, suffix=
-00075d50: 2242 2229 3a0d 0a20 2020 2022 2222 0d0a  "B"):..    """..
-00075d60: 2020 2020 5363 616c 6520 6279 7465 7320      Scale bytes 
-00075d70: 746f 2069 7473 2070 726f 7065 7220 666f  to its proper fo
-00075d80: 726d 6174 0d0a 2020 2020 652e 673a 0d0a  rmat..    e.g:..
-00075d90: 2020 2020 2020 2020 3132 3533 3635 3620          1253656 
-00075da0: 3d3e 2027 312e 3230 4d42 270d 0a20 2020  => '1.20MB'..   
-00075db0: 2020 2020 2031 3235 3336 3536 3637 3820       1253656678 
-00075dc0: 3d3e 2027 312e 3137 4742 270d 0a20 2020  => '1.17GB'..   
-00075dd0: 2022 2222 0d0a 2020 2020 6661 6374 6f72   """..    factor
-00075de0: 203d 2031 3032 340d 0a20 2020 2066 6f72   = 1024..    for
-00075df0: 2075 6e69 7420 696e 205b 2222 2c20 224b   unit in ["", "K
-00075e00: 222c 2022 4d22 2c20 2247 222c 2022 5422  ", "M", "G", "T"
-00075e10: 2c20 2250 225d 3a0d 0a20 2020 2020 2020  , "P"]:..       
-00075e20: 2069 6620 6279 7465 7320 3c20 6661 6374   if bytes < fact
-00075e30: 6f72 3a0d 0a20 2020 2020 2020 2020 2020  or:..           
-00075e40: 2072 6574 7572 6e20 6622 7b62 7974 6573   return f"{bytes
-00075e50: 3a2e 3266 7d7b 756e 6974 7d7b 7375 6666  :.2f}{unit}{suff
-00075e60: 6978 7d22 0d0a 2020 2020 2020 2020 6279  ix}"..        by
-00075e70: 7465 7320 2f3d 2066 6163 746f 720d 0a0d  tes /= factor...
-00075e80: 0a64 6566 2070 7269 6e74 5f73 7973 7465  .def print_syste
-00075e90: 6d5f 696e 666f 2829 3a0d 0a20 2020 2022  m_info():..    "
-00075ea0: 2222 0d0a 2020 2020 5468 6973 2070 7269  ""..    This pri
-00075eb0: 6e74 7320 7468 6520 696e 666f 726d 6174  nts the informat
-00075ec0: 696f 6e20 6f6e 2074 6865 2068 6172 6477  ion on the hardw
-00075ed0: 6172 6520 7275 6e6e 696e 6720 7468 6520  are running the 
-00075ee0: 5079 7468 6f6e 2063 6f64 6520 0d0a 2020  Python code ..  
-00075ef0: 2020 4d61 6e79 2074 6861 6e6b 7320 746f    Many thanks to
-00075f00: 3a20 6874 7470 733a 2f2f 7777 772e 7468  : https://www.th
-00075f10: 6570 7974 686f 6e63 6f64 652e 636f 6d2f  epythoncode.com/
-00075f20: 6172 7469 636c 652f 6765 742d 6861 7264  article/get-hard
-00075f30: 7761 7265 2d73 7973 7465 6d2d 696e 666f  ware-system-info
-00075f40: 726d 6174 696f 6e2d 7079 7468 6f6e 0d0a  rmation-python..
-00075f50: 2020 2020 2222 220d 0a20 2020 2069 6d70      """..    imp
-00075f60: 6f72 7420 7073 7574 696c 0d0a 2020 2020  ort psutil..    
-00075f70: 696d 706f 7274 2070 6c61 7466 6f72 6d0d  import platform.
-00075f80: 0a20 2020 2070 7269 6e74 2822 3d22 2a32  .    print("="*2
-00075f90: 302c 2022 5379 7374 656d 2049 6e66 6f72  0, "System Infor
-00075fa0: 6d61 7469 6f6e 222c 2022 3d22 2a32 3029  mation", "="*20)
-00075fb0: 0d0a 2020 2020 756e 616d 6520 3d20 706c  ..    uname = pl
-00075fc0: 6174 666f 726d 2e75 6e61 6d65 2829 0d0a  atform.uname()..
-00075fd0: 2020 2020 7072 696e 7428 6622 5379 7374      print(f"Syst
-00075fe0: 656d 3a20 7b75 6e61 6d65 2e73 7973 7465  em: {uname.syste
-00075ff0: 6d7d 2229 0d0a 2020 2020 7072 696e 7428  m}")..    print(
-00076000: 6622 4e6f 6465 204e 616d 653a 207b 756e  f"Node Name: {un
-00076010: 616d 652e 6e6f 6465 7d22 290d 0a20 2020  ame.node}")..   
-00076020: 2070 7269 6e74 2866 2252 656c 6561 7365   print(f"Release
-00076030: 3a20 7b75 6e61 6d65 2e72 656c 6561 7365  : {uname.release
-00076040: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
-00076050: 2256 6572 7369 6f6e 3a20 7b75 6e61 6d65  "Version: {uname
-00076060: 2e76 6572 7369 6f6e 7d22 290d 0a20 2020  .version}")..   
-00076070: 2070 7269 6e74 2866 224d 6163 6869 6e65   print(f"Machine
-00076080: 3a20 7b75 6e61 6d65 2e6d 6163 6869 6e65  : {uname.machine
-00076090: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
-000760a0: 2250 726f 6365 7373 6f72 3a20 7b75 6e61  "Processor: {una
-000760b0: 6d65 2e70 726f 6365 7373 6f72 7d22 290d  me.processor}").
-000760c0: 0a20 2020 2070 7269 6e74 2822 3d22 2a32  .    print("="*2
-000760d0: 322c 2022 4350 5520 496e 666f 726d 6174  2, "CPU Informat
-000760e0: 696f 6e22 2c20 223d 222a 3232 290d 0a20  ion", "="*22).. 
-000760f0: 2020 2023 206e 756d 6265 7220 6f66 2063     # number of c
-00076100: 6f72 6573 0d0a 2020 2020 7072 696e 7428  ores..    print(
-00076110: 2250 6879 7369 6361 6c20 636f 7265 733a  "Physical cores:
-00076120: 222c 2070 7375 7469 6c2e 6370 755f 636f  ", psutil.cpu_co
-00076130: 756e 7428 6c6f 6769 6361 6c3d 4661 6c73  unt(logical=Fals
-00076140: 6529 290d 0a20 2020 2070 7269 6e74 2822  e))..    print("
-00076150: 546f 7461 6c20 636f 7265 733a 222c 2070  Total cores:", p
-00076160: 7375 7469 6c2e 6370 755f 636f 756e 7428  sutil.cpu_count(
-00076170: 6c6f 6769 6361 6c3d 5472 7565 2929 0d0a  logical=True))..
-00076180: 2020 2020 7072 696e 7428 223d 222a 3230      print("="*20
-00076190: 2c20 224d 656d 6f72 7920 496e 666f 726d  , "Memory Inform
-000761a0: 6174 696f 6e22 2c20 223d 222a 3230 290d  ation", "="*20).
-000761b0: 0a20 2020 2023 2067 6574 2074 6865 206d  .    # get the m
-000761c0: 656d 6f72 7920 6465 7461 696c 730d 0a20  emory details.. 
-000761d0: 2020 2073 766d 656d 203d 2070 7375 7469     svmem = psuti
-000761e0: 6c2e 7669 7274 7561 6c5f 6d65 6d6f 7279  l.virtual_memory
-000761f0: 2829 0d0a 2020 2020 7072 696e 7428 6622  ()..    print(f"
-00076200: 546f 7461 6c3a 207b 6765 745f 7369 7a65  Total: {get_size
-00076210: 2873 766d 656d 2e74 6f74 616c 297d 2229  (svmem.total)}")
-00076220: 0d0a 2020 2020 7072 696e 7428 6622 4176  ..    print(f"Av
-00076230: 6169 6c61 626c 653a 207b 6765 745f 7369  ailable: {get_si
-00076240: 7a65 2873 766d 656d 2e61 7661 696c 6162  ze(svmem.availab
-00076250: 6c65 297d 2229 0d0a 2020 2020 7072 696e  le)}")..    prin
-00076260: 7428 6622 5573 6564 3a20 7b67 6574 5f73  t(f"Used: {get_s
-00076270: 697a 6528 7376 6d65 6d2e 7573 6564 297d  ize(svmem.used)}
-00076280: 2229 0d0a 2020 2020 7072 696e 7428 223d  ")..    print("=
-00076290: 222a 3138 2c20 2253 7973 7465 6d20 496e  "*18, "System In
-000762a0: 666f 726d 6174 696f 6e20 456e 6422 2c20  formation End", 
-000762b0: 223d 222a 3138 290d 0a23 2323 2323 2323  "="*18)..#######
-000762c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000762d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000762e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000762f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00076300: 2323 2323 2323 2323 2323 2323 2323 0000  ##############..
-00076310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000763f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00076410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00076470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00076480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00076490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000764a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000764b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000764c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000764d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000764e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000764f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00076510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00076550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00076560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000765f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00076610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00076620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000766f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000767f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00076810: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
-00076820: 4c5f 456e 7365 6d62 6c69 6e67 2e70 7900  L_Ensembling.py.
-00076830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00076870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00076880: 3030 3332 3634 3400 3030 3030 3030 3030  0032644.00000000
-00076890: 3030 3000 3032 3130 3130 0020 3000 0000  000.021010. 0...
+00074240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074250: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00074260: 3d73 6565 6429 0d0a 2020 2020 656c 7365  =seed)..    else
+00074270: 3a0d 0a20 2020 2020 2020 2063 6c66 203d  :..        clf =
+00074280: 2044 6563 6973 696f 6e54 7265 6543 6c61   DecisionTreeCla
+00074290: 7373 6966 6965 7228 6372 6974 6572 696f  ssifier(criterio
+000742a0: 6e3d 2765 6e74 726f 7079 272c 6d69 6e5f  n='entropy',min_
+000742b0: 7361 6d70 6c65 735f 6c65 6166 3d32 2c0d  samples_leaf=2,.
+000742c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000742d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000742e0: 2020 2020 2020 2020 2020 6d61 785f 6465            max_de
+000742f0: 7074 683d 6d61 785f 6465 7074 682c 0d0a  pth=max_depth,..
+00074300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074320: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+00074330: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
+00074340: 2065 6e74 726f 7079 5f74 6872 6573 686f   entropy_thresho
+00074350: 6c64 203d 205b 5d0d 0a20 2020 2023 2323  ld = []..    ###
+00074360: 2323 2323 2054 6869 7320 6973 2077 6865  #### This is whe
+00074370: 7265 2077 6520 6269 6e20 6561 6368 2076  re we bin each v
+00074380: 6172 6961 626c 6520 7468 726f 7567 6820  ariable through 
+00074390: 6120 6d65 7468 6f64 206b 6e6f 776e 2061  a method known a
+000743a0: 7320 456e 7472 6f70 7920 4269 6e6e 696e  s Entropy Binnin
+000743b0: 6720 2323 2323 2323 2323 2323 2323 2323  g ##############
+000743c0: 0d0a 2020 2020 666f 7220 6561 6368 5f6e  ..    for each_n
+000743d0: 756d 2069 6e20 636f 6e74 696e 756f 7573  um in continuous
+000743e0: 5f76 6172 733a 0d0a 2020 2020 2020 2020  _vars:..        
+000743f0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00074400: 2020 636c 662e 6669 7428 7465 6d70 5f74    clf.fit(temp_t
+00074410: 7261 696e 5b65 6163 685f 6e75 6d5d 2e76  rain[each_num].v
+00074420: 616c 7565 732e 7265 7368 6170 6528 2d31  alues.reshape(-1
+00074430: 2c31 292c 7465 6d70 5f74 7261 696e 5b74  ,1),temp_train[t
+00074440: 6172 675d 2e76 616c 7565 7329 0d0a 2020  arg].values)..  
+00074450: 2020 2020 2020 2020 2020 656e 7472 6f70            entrop
+00074460: 795f 7468 7265 7368 6f6c 6420 3d20 636c  y_threshold = cl
+00074470: 662e 7472 6565 5f2e 7468 7265 7368 6f6c  f.tree_.threshol
+00074480: 645b 636c 662e 7472 6565 5f2e 7468 7265  d[clf.tree_.thre
+00074490: 7368 6f6c 643e 2d32 5d0d 0a20 2020 2020  shold>-2]..     
+000744a0: 2020 2020 2020 2065 6e74 726f 7079 5f74         entropy_t
+000744b0: 6872 6573 686f 6c64 203d 206e 702e 736f  hreshold = np.so
+000744c0: 7274 2865 6e74 726f 7079 5f74 6872 6573  rt(entropy_thres
+000744d0: 686f 6c64 290d 0a20 2020 2020 2020 2020  hold)..         
+000744e0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000744f0: 2865 6163 685f 6e75 6d2c 2073 7472 293a  (each_num, str):
+00074500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00074510: 2020 6269 6e63 6f6c 203d 2065 6163 685f    bincol = each_
+00074520: 6e75 6d2b 275f 6269 6e27 0d0a 2020 2020  num+'_bin'..    
+00074530: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+00074540: 5f74 7261 696e 5b62 696e 636f 6c5d 203d  _train[bincol] =
+00074550: 206e 702e 6469 6769 7469 7a65 2874 656d   np.digitize(tem
+00074560: 705f 7472 6169 6e5b 6561 6368 5f6e 756d  p_train[each_num
+00074570: 5d2e 7661 6c75 6573 2c20 656e 7472 6f70  ].values, entrop
+00074580: 795f 7468 7265 7368 6f6c 6429 0d0a 2020  y_threshold)..  
+00074590: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000745a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000745b0: 2062 696e 636f 6c20 3d20 2762 696e 5f27   bincol = 'bin_'
+000745c0: 2b73 7472 2865 6163 685f 6e75 6d29 0d0a  +str(each_num)..
+000745d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000745e0: 7465 6d70 5f74 7261 696e 5b62 696e 636f  temp_train[binco
+000745f0: 6c5d 203d 206e 702e 6469 6769 7469 7a65  l] = np.digitize
+00074600: 2874 656d 705f 7472 6169 6e5b 6561 6368  (temp_train[each
+00074610: 5f6e 756d 5d2e 7661 6c75 6573 2c20 656e  _num].values, en
+00074620: 7472 6f70 795f 7468 7265 7368 6f6c 6429  tropy_threshold)
+00074630: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00074640: 2323 2057 6520 4472 6f70 2074 6865 206f  ## We Drop the o
+00074650: 7269 6769 6e61 6c20 636f 6e74 696e 756f  riginal continuo
+00074660: 7573 2076 6172 6961 626c 6520 6166 7465  us variable afte
+00074670: 7220 796f 7520 6861 7665 2063 7265 6174  r you have creat
+00074680: 6564 2074 6865 2062 696e 2077 6865 6e20  ed the bin when 
+00074690: 466c 6167 2069 7320 7472 7565 0d0a 2020  Flag is true..  
+000746a0: 2020 2020 2020 2020 2020 2323 2320 5765            ### We
+000746b0: 2044 6f6e 2774 2064 726f 7020 7468 6573   Don't drop thes
+000746c0: 6520 6f72 6967 696e 616c 206e 756d 6572  e original numer
+000746d0: 6963 2076 6172 7320 7369 6e63 6520 7468  ic vars since th
+000746e0: 6579 2077 696c 6c20 6265 2075 7365 6420  ey will be used 
+000746f0: 6c61 7465 7220 666f 7220 6675 6c6c 2074  later for full t
+00074700: 7261 696e 2062 696e 6e69 6e67 0d0a 2020  rain binning..  
+00074710: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
+00074720: 6528 7465 6d70 5f74 6573 7429 2021 3d20  e(temp_test) != 
+00074730: 7374 723a 0d0a 2020 2020 2020 2020 2020  str:..          
+00074740: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00074750: 6e63 6528 6561 6368 5f6e 756d 2c20 7374  nce(each_num, st
+00074760: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+00074770: 2020 2020 2020 2020 2062 696e 636f 6c20           bincol 
+00074780: 3d20 6561 6368 5f6e 756d 2b27 5f62 696e  = each_num+'_bin
+00074790: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+000747a0: 2020 2020 2020 2074 656d 705f 7465 7374         temp_test
+000747b0: 5b62 696e 636f 6c5d 203d 206e 702e 6469  [bincol] = np.di
+000747c0: 6769 7469 7a65 2874 656d 705f 7465 7374  gitize(temp_test
+000747d0: 5b65 6163 685f 6e75 6d5d 2e76 616c 7565  [each_num].value
+000747e0: 732c 2065 6e74 726f 7079 5f74 6872 6573  s, entropy_thres
+000747f0: 686f 6c64 290d 0a20 2020 2020 2020 2020  hold)..         
+00074800: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00074810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074820: 2020 6269 6e63 6f6c 203d 2027 6269 6e5f    bincol = 'bin_
+00074830: 272b 7374 7228 6561 6368 5f6e 756d 290d  '+str(each_num).
+00074840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00074850: 2020 2020 2074 656d 705f 7465 7374 5b62       temp_test[b
+00074860: 696e 636f 6c5d 203d 206e 702e 6469 6769  incol] = np.digi
+00074870: 7469 7a65 2874 656d 705f 7465 7374 5b65  tize(temp_test[e
+00074880: 6163 685f 6e75 6d5d 2e76 616c 7565 732c  ach_num].values,
+00074890: 2065 6e74 726f 7079 5f74 6872 6573 686f   entropy_thresho
+000748a0: 6c64 290d 0a20 2020 2020 2020 2020 2020  ld)..           
+000748b0: 2020 2020 2023 2323 2320 5765 2044 726f       #### We Dro
+000748c0: 7020 7468 6520 6f72 6967 696e 616c 2063  p the original c
+000748d0: 6f6e 7469 6e75 6f75 7320 7661 7269 6162  ontinuous variab
+000748e0: 6c65 2061 6674 6572 2079 6f75 2068 6176  le after you hav
+000748f0: 6520 6372 6561 7465 6420 7468 6520 6269  e created the bi
+00074900: 6e20 7768 656e 2046 6c61 6720 6973 2074  n when Flag is t
+00074910: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00074920: 2020 2020 2023 2323 2057 6520 446f 6e27       ### We Don'
+00074930: 7420 6472 6f70 2074 6865 7365 206f 7269  t drop these ori
+00074940: 6769 6e61 6c20 6e75 6d65 7269 6320 7661  ginal numeric va
+00074950: 7273 2073 696e 6365 2074 6865 7920 7769  rs since they wi
+00074960: 6c6c 2062 6520 7573 6564 206c 6174 6572  ll be used later
+00074970: 2066 6f72 2066 756c 6c20 7472 6169 6e20   for full train 
+00074980: 6269 6e6e 696e 670d 0a20 2020 2020 2020  binning..       
+00074990: 2020 2020 2069 6620 656e 7472 6f70 795f       if entropy_
+000749a0: 6269 6e6e 696e 673a 0d0a 2020 2020 2020  binning:..      
+000749b0: 2020 2020 2020 2020 2020 2323 2320 496e            ### In
+000749c0: 2074 6865 2073 6563 6f6e 6420 7469 6d65   the second time
+000749d0: 2c20 7765 2064 6f6e 2774 2072 6570 6561  , we don't repea
+000749e0: 7420 6164 6469 6e67 2062 696e 6e65 6420  t adding binned 
+000749f0: 7661 7273 2073 696e 6365 2074 6865 7920  vars since they 
+00074a00: 6861 7665 2061 6c72 6561 6479 2062 6565  have already bee
+00074a10: 6e20 6164 6465 6421 0d0a 2020 2020 2020  n added!..      
+00074a20: 2020 2020 2020 2020 2020 2323 2323 2077            #### w
+00074a30: 6520 616c 736f 206d 616b 6520 7375 7265  e also make sure
+00074a40: 2074 6861 7420 7468 6520 6f72 6967 206e   that the orig n
+00074a50: 756d 2076 6172 7320 7768 6963 6820 6861  um vars which ha
+00074a60: 7665 206e 6f77 2062 6565 6e20 6269 6e6e  ve now been binn
+00074a70: 6564 2061 7265 2072 656d 6f76 6564 210d  ed are removed!.
+00074a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00074a90: 2074 656d 705f 7472 6169 6e2e 6472 6f70   temp_train.drop
+00074aa0: 2865 6163 685f 6e75 6d2c 6178 6973 3d31  (each_num,axis=1
+00074ab0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
+00074ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ad0: 6966 2074 7970 6528 7465 6d70 5f74 6573  if type(temp_tes
+00074ae0: 7429 2021 3d20 7374 723a 0d0a 2020 2020  t) != str:..    
+00074af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074b00: 7465 6d70 5f74 6573 742e 6472 6f70 2865  temp_test.drop(e
+00074b10: 6163 685f 6e75 6d2c 6178 6973 3d31 2c69  ach_num,axis=1,i
+00074b20: 6e70 6c61 6365 3d54 7275 6529 0d0a 2020  nplace=True)..  
+00074b30: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00074b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00074b50: 2023 2323 2320 496e 2074 6865 2066 6972   #### In the fir
+00074b60: 7374 2074 696d 652c 2077 6520 6164 6420  st time, we add 
+00074b70: 6269 6e6e 6564 2076 6172 7320 746f 2020  binned vars to  
+00074b80: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+00074b90: 6573 2020 2323 230d 0a20 2020 2020 2020  es  ###..       
+00074ba0: 2020 2020 2020 2020 2023 2323 2049 6e20           ### In 
+00074bb0: 7468 6520 7365 636f 6e64 2074 696d 652c  the second time,
+00074bc0: 2077 6520 646f 6e27 7420 7265 7065 6174   we don't repeat
+00074bd0: 2074 6861 7420 7369 6e63 6520 7468 6579   that since they
+00074be0: 2068 6176 6520 616c 7265 6164 7920 6265   have already be
+00074bf0: 656e 2061 6464 6564 210d 0a20 2020 2020  en added!..     
+00074c00: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00074c10: 7461 6e74 5f66 6561 7475 7265 732e 6170  tant_features.ap
+00074c20: 7065 6e64 2862 696e 636f 6c29 0d0a 2020  pend(bincol)..  
+00074c30: 2020 2020 2020 2020 2020 6e75 6d5f 7661            num_va
+00074c40: 7273 2e61 7070 656e 6428 6269 6e63 6f6c  rs.append(bincol
+00074c50: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00074c60: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+00074c70: 732e 7265 6d6f 7665 2865 6163 685f 6e75  s.remove(each_nu
+00074c80: 6d29 0d0a 2020 2020 2020 2020 2020 2020  m)..            
+00074c90: 2323 2323 2044 726f 7020 7468 6573 6520  #### Drop these 
+00074ca0: 6f72 6967 696e 616c 2063 6f6e 7469 6e75  original continu
+00074cb0: 6f75 7320 7661 7269 6162 6c65 2066 726f  ous variable fro
+00074cc0: 6d20 6675 7274 6865 7220 636f 6e73 6964  m further consid
+00074cd0: 6572 6174 696f 6e20 7468 6174 2773 2061  eration that's a
+00074ce0: 6c6c 2120 2323 230d 0a20 2020 2020 2020  ll! ###..       
+00074cf0: 2020 2020 206e 756d 5f76 6172 732e 7265       num_vars.re
+00074d00: 6d6f 7665 2865 6163 685f 6e75 6d29 0d0a  move(each_num)..
+00074d10: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00074d20: 6269 6e63 6f6c 732e 6170 7065 6e64 2862  bincols.append(b
+00074d30: 696e 636f 6c29 0d0a 2020 2020 2020 2020  incol)..        
+00074d40: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00074d50: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
+00074d60: 7220 696e 2025 7320 6475 7269 6e67 2045  r in %s during E
+00074d70: 6e74 726f 7079 2042 696e 6e69 6e67 2720  ntropy Binning' 
+00074d80: 2565 6163 685f 6e75 6d29 0d0a 2020 2020  %each_num)..    
+00074d90: 7072 696e 7428 2720 2020 2053 656c 6563  print('    Selec
+00074da0: 7465 6420 616e 6420 6269 6e6e 6564 206f  ted and binned o
+00074db0: 6e6c 7920 746f 7020 2573 2063 6f6e 7469  nly top %s conti
+00074dc0: 6e75 6f75 7320 7661 7269 6162 6c65 732e  nuous variables.
+00074dd0: 2720 2528 6c65 6e28 6e65 775f 6269 6e63  ' %(len(new_binc
+00074de0: 6f6c 7329 2929 0d0a 2020 2020 6966 2076  ols)))..    if v
+00074df0: 6572 626f 7365 2061 6e64 206c 656e 286e  erbose and len(n
+00074e00: 6577 5f62 696e 636f 6c73 2920 3c3d 2033  ew_bincols) <= 3
+00074e10: 303a 0d0a 2020 2020 2020 2020 7072 696e  0:..        prin
+00074e20: 7428 2720 2020 2025 7327 2025 6e65 775f  t('    %s' %new_
+00074e30: 6269 6e63 6f6c 7329 0d0a 2020 2020 7265  bincols)..    re
+00074e40: 7475 726e 2074 656d 705f 7472 6169 6e2c  turn temp_train,
+00074e50: 206e 756d 5f76 6172 732c 2069 6d70 6f72   num_vars, impor
+00074e60: 7461 6e74 5f66 6561 7475 7265 732c 2074  tant_features, t
+00074e70: 656d 705f 7465 7374 0d0a 2323 2323 2323  emp_test..######
+00074e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00074ec0: 2323 2323 2323 230d 0a66 726f 6d20 736b  #######..from sk
+00074ed0: 6c65 6172 6e2e 6261 7365 2069 6d70 6f72  learn.base impor
+00074ee0: 7420 4261 7365 4573 7469 6d61 746f 722c  t BaseEstimator,
+00074ef0: 2043 6c61 7373 6966 6965 724d 6978 696e   ClassifierMixin
+00074f00: 2c20 5472 616e 7366 6f72 6d65 724d 6978  , TransformerMix
+00074f10: 696e 0d0a 6672 6f6d 2069 6d62 6c65 6172  in..from imblear
+00074f20: 6e2e 6f76 6572 5f73 616d 706c 696e 6720  n.over_sampling 
+00074f30: 696d 706f 7274 2053 4d4f 5445 2c20 5356  import SMOTE, SV
+00074f40: 4d53 4d4f 5445 0d0a 6672 6f6d 2069 6d62  MSMOTE..from imb
+00074f50: 6c65 6172 6e2e 6f76 6572 5f73 616d 706c  learn.over_sampl
+00074f60: 696e 6720 696d 706f 7274 2041 4441 5359  ing import ADASY
+00074f70: 4e2c 2053 4d4f 5445 4e43 0d0a 6672 6f6d  N, SMOTENC..from
+00074f80: 2073 6b6c 6561 726e 2e63 6c75 7374 6572   sklearn.cluster
+00074f90: 2069 6d70 6f72 7420 4b4d 6561 6e73 0d0a   import KMeans..
+00074fa0: 6465 6620 6b6d 6561 6e73 5f72 6573 616d  def kmeans_resam
+00074fb0: 706c 6572 2878 5f74 7261 696e 2c20 795f  pler(x_train, y_
+00074fc0: 7472 6169 6e2c 2074 6172 6765 742c 2073  train, target, s
+00074fd0: 6d6f 7465 3d22 222c 2076 6572 626f 7365  mote="", verbose
+00074fe0: 3d30 293a 0d0a 2020 2020 2222 220d 0a20  =0):..    """.. 
+00074ff0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+00075000: 2063 6f6e 7665 7274 7320 6120 5265 6772   converts a Regr
+00075010: 6573 7369 6f6e 2070 726f 626c 656d 2069  ession problem i
+00075020: 6e74 6f20 6120 436c 6173 7369 6669 6361  nto a Classifica
+00075030: 7469 6f6e 2070 726f 626c 656d 2074 6f20  tion problem to 
+00075040: 656e 6162 6c65 2053 4d4f 5445 210d 0a20  enable SMOTE!.. 
+00075050: 2020 2049 7420 6973 2061 2076 6572 7920     It is a very 
+00075060: 7369 6d70 6c65 2077 6179 2074 6f20 7365  simple way to se
+00075070: 6e64 2079 6f75 7220 785f 7472 6169 6e2c  nd your x_train,
+00075080: 2079 5f74 7261 696e 2069 6e20 616e 6420   y_train in and 
+00075090: 6765 7420 6261 636b 2061 6e20 6f76 6572  get back an over
+000750a0: 7361 6d70 6c65 6420 785f 7472 6169 6e2c  sampled x_train,
+000750b0: 2079 5f74 7261 696e 2e0d 0a20 2020 2057   y_train...    W
+000750c0: 6879 2069 7320 7468 6973 206e 6565 6465  hy is this neede
+000750d0: 6420 696e 204d 6163 6869 6e65 204c 6561  d in Machine Lea
+000750e0: 726e 696e 6720 7072 6f62 6c65 6d73 3f0d  rning problems?.
+000750f0: 0a20 2020 2020 2020 2020 496e 2049 6d62  .         In Imb
+00075100: 616c 616e 6365 6420 6461 7461 7365 7473  alanced datasets
+00075110: 2c20 6573 702e 2073 6b65 7765 6420 7265  , esp. skewed re
+00075120: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
+00075130: 7320 7768 6572 6520 7468 6520 7461 7267  s where the targ
+00075140: 6574 2076 6172 6961 626c 6520 6973 2073  et variable is s
+00075150: 6b65 7765 642c 2074 6869 7320 6973 206e  kewed, this is n
+00075160: 6565 6465 642e 0d0a 2020 2020 5472 7920  eeded...    Try 
+00075170: 7468 6973 206f 6e20 796f 7572 2073 6b65  this on your ske
+00075180: 7765 6420 5265 6772 6573 7369 6f6e 2070  wed Regression p
+00075190: 726f 626c 656d 7320 616e 6420 7365 6520  roblems and see 
+000751a0: 7768 6174 2072 6573 756c 7473 2079 6f75  what results you
+000751b0: 2067 6574 2e20 4974 2073 686f 756c 6420   get. It should 
+000751c0: 6265 2062 6574 7465 722e 0d0a 2020 2020  be better...    
+000751d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000751e0: 496e 7075 7473 0d0a 2020 2020 2d2d 2d2d  Inputs..    ----
+000751f0: 2d2d 2d2d 2d2d 0d0a 2020 2020 785f 7472  ------..    x_tr
+00075200: 6169 6e20 3a20 7061 6e64 6173 2064 6174  ain : pandas dat
+00075210: 6166 7261 6d65 3a20 796f 7520 6d75 7374  aframe: you must
+00075220: 2073 656e 6420 696e 2074 6865 2064 6174   send in the dat
+00075230: 6120 7769 7468 2070 7265 6469 6374 6f72  a with predictor
+00075240: 7320 6f6e 6c79 2e0d 0a20 2020 206d 696e  s only...    min
+00075250: 5f6e 5f73 616d 706c 6573 203a 2069 6e74  _n_samples : int
+00075260: 2c20 6465 6661 756c 743d 353a 206d 696e  , default=5: min
+00075270: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+00075280: 6573 2062 656c 6f77 2077 6869 6368 2079  es below which y
+00075290: 6f75 2063 6f6d 6269 6e65 2062 696e 730d  ou combine bins.
+000752a0: 0a20 2020 2062 696e 7320 3a20 696e 742c  .    bins : int,
+000752b0: 2064 6566 6175 6c74 3d33 3a20 686f 7720   default=3: how 
+000752c0: 6d61 6e79 2062 696e 7320 796f 7520 7761  many bins you wa
+000752d0: 6e74 2074 6f20 7370 6c69 7420 7461 7267  nt to split targ
+000752e0: 6574 2069 6e74 6f0d 0a0d 0a20 2020 204f  et into....    O
+000752f0: 7574 7075 7473 0d0a 2020 2020 2d2d 2d2d  utputs..    ----
+00075300: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e5f 6665  ------..    n_fe
+00075310: 6174 7572 6573 5f20 3a20 696e 740d 0a20  atures_ : int.. 
+00075320: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+00075330: 7220 6f66 2066 6561 7475 7265 7320 6f66  r of features of
+00075340: 2074 6865 2064 6174 6120 7061 7373 6564   the data passed
+00075350: 2074 6f20 3a6d 6574 683a 6066 6974 602e   to :meth:`fit`.
+00075360: 0d0a 2020 2020 2222 220d 0a20 2020 2078  ..    """..    x
+00075370: 5f74 7261 696e 5f63 203d 2063 6f70 792e  _train_c = copy.
+00075380: 6465 6570 636f 7079 2878 5f74 7261 696e  deepcopy(x_train
+00075390: 290d 0a20 2020 2078 5f74 7261 696e 5f63  )..    x_train_c
+000753a0: 5b74 6172 6765 745d 203d 2079 5f74 7261  [target] = y_tra
+000753b0: 696e 2e76 616c 7565 730d 0a0d 0a20 2020  in.values....   
+000753c0: 2023 2052 6567 7265 7373 696f 6e20 7072   # Regression pr
+000753d0: 6f62 6c65 6d20 7475 726e 6564 2069 6e74  oblem turned int
+000753e0: 6f20 436c 6173 7369 6669 6361 7469 6f6e  o Classification
+000753f0: 2070 726f 626c 656d 0d0a 2020 2020 6e5f   problem..    n_
+00075400: 636c 7573 7465 7273 203d 206d 6178 2833  clusters = max(3
+00075410: 2c20 696e 7428 6e70 2e6c 6f67 3130 286c  , int(np.log10(l
+00075420: 656e 2879 5f74 7261 696e 2929 2920 2b20  en(y_train))) + 
+00075430: 3129 0d0a 2020 2020 2320 5573 6520 4b4d  1)..    # Use KM
+00075440: 6561 6e73 2074 6f20 6669 6e64 206e 6174  eans to find nat
+00075450: 7572 616c 2063 6c75 7374 6572 7320 696e  ural clusters in
+00075460: 2079 6f75 7220 6461 7461 0d0a 2020 2020   your data..    
+00075470: 6b6d 5f6d 6f64 656c 203d 204b 4d65 616e  km_model = KMean
+00075480: 7328 6e5f 636c 7573 7465 7273 3d6e 5f63  s(n_clusters=n_c
+00075490: 6c75 7374 6572 732c 0d0a 2020 2020 2020  lusters,..      
+000754a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000754b0: 6e5f 696e 6974 3d35 2c0d 0a20 2020 2020  n_init=5,..     
+000754c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000754d0: 2072 616e 646f 6d5f 7374 6174 653d 3939   random_state=99
+000754e0: 290d 0a20 2020 2023 2323 2320 7265 6d65  )..    #### reme
+000754f0: 6d62 6572 2079 6f75 206d 7573 7420 7072  mber you must pr
+00075500: 6564 6963 7420 7573 696e 6720 6f6e 6c79  edict using only
+00075510: 2070 7265 6469 6374 6f72 2076 6172 6961   predictor varia
+00075520: 626c 6573 210d 0a20 2020 2079 5f74 7261  bles!..    y_tra
+00075530: 696e 5f63 203d 206b 6d5f 6d6f 6465 6c2e  in_c = km_model.
+00075540: 6669 745f 7072 6564 6963 7428 785f 7472  fit_predict(x_tr
+00075550: 6169 6e29 0d0a 0d0a 2020 2020 6966 2076  ain)....    if v
+00075560: 6572 626f 7365 203e 3d20 313a 0d0a 2020  erbose >= 1:..  
+00075570: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00075580: 204e 756d 6265 7220 6f66 2063 6c75 7374   Number of clust
+00075590: 6572 7320 6372 6561 7465 6420 3d20 2564  ers created = %d
+000755a0: 2720 256e 5f63 6c75 7374 6572 7329 0d0a  ' %n_clusters)..
+000755b0: 0d0a 2020 2020 2323 2323 2047 656e 6572  ..    #### Gener
+000755c0: 6174 6520 7468 6520 6f76 6572 2d73 616d  ate the over-sam
+000755d0: 706c 6564 2064 6174 610d 0a20 2020 2023  pled data..    #
+000755e0: 2323 2320 4144 4153 594e 202f 2053 4d4f  ### ADASYN / SMO
+000755f0: 5445 206f 7665 7273 616d 706c 696e 6720  TE oversampling 
+00075600: 2323 2323 230d 0a20 2020 2069 6620 6973  #####..    if is
+00075610: 696e 7374 616e 6365 2873 6d6f 7465 2c20  instance(smote, 
+00075620: 7374 7229 3a0d 0a20 2020 2020 2020 2078  str):..        x
+00075630: 5f74 7261 696e 5f65 7874 2c20 5f20 3d20  _train_ext, _ = 
+00075640: 6f76 6572 7361 6d70 6c65 5f53 4d4f 5445  oversample_SMOTE
+00075650: 2878 5f74 7261 696e 5f63 2c20 795f 7472  (x_train_c, y_tr
+00075660: 6169 6e5f 6329 0d0a 2020 2020 656c 7365  ain_c)..    else
+00075670: 3a0d 0a20 2020 2020 2020 2078 5f74 7261  :..        x_tra
+00075680: 696e 5f65 7874 2c20 5f20 3d20 736d 6f74  in_ext, _ = smot
+00075690: 652e 6669 745f 7265 7361 6d70 6c65 2878  e.fit_resample(x
+000756a0: 5f74 7261 696e 5f63 2c20 795f 7472 6169  _train_c, y_trai
+000756b0: 6e5f 6329 0d0a 2020 2020 795f 7472 6169  n_c)..    y_trai
+000756c0: 6e5f 6578 7420 3d20 785f 7472 6169 6e5f  n_ext = x_train_
+000756d0: 6578 745b 7461 7267 6574 5d2e 7661 6c75  ext[target].valu
+000756e0: 6573 0d0a 2020 2020 785f 7472 6169 6e5f  es..    x_train_
+000756f0: 6578 742e 6472 6f70 2874 6172 6765 742c  ext.drop(target,
+00075700: 2061 7869 733d 312c 2069 6e70 6c61 6365   axis=1, inplace
+00075710: 3d54 7275 6529 0d0a 2020 2020 7265 7475  =True)..    retu
+00075720: 726e 2028 785f 7472 6169 6e5f 6578 742c  rn (x_train_ext,
+00075730: 2079 5f74 7261 696e 5f65 7874 290d 0a0d   y_train_ext)...
+00075740: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00075750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075790: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+000757a0: 6e2e 7574 696c 732e 636c 6173 735f 7765  n.utils.class_we
+000757b0: 6967 6874 2069 6d70 6f72 7420 636f 6d70  ight import comp
+000757c0: 7574 655f 636c 6173 735f 7765 6967 6874  ute_class_weight
+000757d0: 0d0a 6465 6620 6765 745f 636c 6173 735f  ..def get_class_
+000757e0: 6469 7374 7269 6275 7469 6f6e 2879 5f69  distribution(y_i
+000757f0: 6e70 7574 293a 0d0a 2020 2020 795f 696e  nput):..    y_in
+00075800: 7075 7420 3d20 636f 7079 2e64 6565 7063  put = copy.deepc
+00075810: 6f70 7928 795f 696e 7075 7429 0d0a 2020  opy(y_input)..  
+00075820: 2020 636c 6173 7365 7320 3d20 6e70 2e75    classes = np.u
+00075830: 6e69 7175 6528 795f 696e 7075 7429 0d0a  nique(y_input)..
+00075840: 2020 2020 7870 203d 2043 6f75 6e74 6572      xp = Counter
+00075850: 2879 5f69 6e70 7574 290d 0a20 2020 2063  (y_input)..    c
+00075860: 6c61 7373 5f77 6569 6768 7473 203d 2063  lass_weights = c
+00075870: 6f6d 7075 7465 5f63 6c61 7373 5f77 6569  ompute_class_wei
+00075880: 6768 7428 2762 616c 616e 6365 6427 2c20  ght('balanced', 
+00075890: 636c 6173 7365 733d 6e70 2e75 6e69 7175  classes=np.uniqu
+000758a0: 6528 795f 696e 7075 7429 2c20 793d 795f  e(y_input), y=y_
+000758b0: 696e 7075 7429 0d0a 2020 2020 6966 206c  input)..    if l
+000758c0: 656e 2863 6c61 7373 5f77 6569 6768 7473  en(class_weights
+000758d0: 5b28 636c 6173 735f 7765 6967 6874 733e  [(class_weights>
+000758e0: 2031 3029 5d29 203e 2030 3a0d 0a20 2020   10)]) > 0:..   
+000758f0: 2020 2020 2063 6c61 7373 5f77 6569 6768       class_weigh
+00075900: 7473 203d 2028 636c 6173 735f 7765 6967  ts = (class_weig
+00075910: 6874 732f 3130 290d 0a20 2020 2065 6c73  hts/10)..    els
+00075920: 653a 0d0a 2020 2020 2020 2020 636c 6173  e:..        clas
+00075930: 735f 7765 6967 6874 7320 3d20 2863 6c61  s_weights = (cla
+00075940: 7373 5f77 6569 6768 7473 290d 0a20 2020  ss_weights)..   
+00075950: 2070 7269 6e74 2827 2020 2020 636c 6173   print('    clas
+00075960: 735f 7765 6967 6874 7320 3d20 2573 2720  s_weights = %s' 
+00075970: 2563 6c61 7373 5f77 6569 6768 7473 290d  %class_weights).
+00075980: 0a20 2020 2063 6c61 7373 5f77 6569 6768  .    class_weigh
+00075990: 7473 5b28 636c 6173 735f 7765 6967 6874  ts[(class_weight
+000759a0: 733c 3129 5d3d 310d 0a20 2020 2063 6c61  s<1)]=1..    cla
+000759b0: 7373 5f72 6f77 7320 3d20 636c 6173 735f  ss_rows = class_
+000759c0: 7765 6967 6874 732a 5b78 705b 785d 2066  weights*[xp[x] f
+000759d0: 6f72 2078 2069 6e20 636c 6173 7365 735d  or x in classes]
+000759e0: 0d0a 2020 2020 636c 6173 735f 726f 7773  ..    class_rows
+000759f0: 203d 2063 6c61 7373 5f72 6f77 732e 6173   = class_rows.as
+00075a00: 7479 7065 2869 6e74 290d 0a20 2020 2063  type(int)..    c
+00075a10: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
+00075a20: 7773 203d 2064 6963 7428 7a69 7028 636c  ws = dict(zip(cl
+00075a30: 6173 7365 732c 636c 6173 735f 726f 7773  asses,class_rows
+00075a40: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
+00075a50: 2020 2063 6c61 7373 5f77 6569 6768 7465     class_weighte
+00075a60: 645f 726f 7773 203d 2025 7327 2025 636c  d_rows = %s' %cl
+00075a70: 6173 735f 7765 6967 6874 6564 5f72 6f77  ass_weighted_row
+00075a80: 7329 0d0a 2020 2020 7265 7475 726e 2063  s)..    return c
+00075a90: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
+00075aa0: 7773 0d0a 0d0a 6465 6620 6f76 6572 7361  ws....def oversa
+00075ab0: 6d70 6c65 5f53 4d4f 5445 2858 2c79 293a  mple_SMOTE(X,y):
+00075ac0: 0d0a 2020 2020 2369 6e70 7574 2044 6174  ..    #input Dat
+00075ad0: 6146 7261 6d65 0d0a 2020 2020 2358 20e2  aFrame..    #X .
+00075ae0: 8692 496e 6465 7065 6e64 656e 7420 5661  ..Independent Va
+00075af0: 7269 6162 6c65 2069 6e20 4461 7461 4672  riable in DataFr
+00075b00: 616d 655c 0d0a 2020 2020 2379 20e2 8692  ame\..    #y ...
+00075b10: 6465 7065 6e64 656e 7420 5661 7269 6162  dependent Variab
+00075b20: 6c65 2069 6e20 5061 6e64 6173 2044 6174  le in Pandas Dat
+00075b30: 6146 7261 6d65 2066 6f72 6d61 740d 0a20  aFrame format.. 
+00075b40: 2020 2023 2047 6574 2074 6865 2063 6c61     # Get the cla
+00075b50: 7373 2064 6973 7472 6975 6274 696f 6e20  ss distriubtion 
+00075b60: 666f 7220 7065 7266 6f6d 696e 6720 7265  for perfoming re
+00075b70: 6c61 7469 7665 2073 616d 706c 696e 6720  lative sampling 
+00075b80: 696e 2074 6865 206e 6578 7420 6c69 6e65  in the next line
+00075b90: 0d0a 2020 2020 636c 6173 735f 7765 6967  ..    class_weig
+00075ba0: 6874 6564 5f72 6f77 7320 3d20 6765 745f  hted_rows = get_
+00075bb0: 636c 6173 735f 6469 7374 7269 6275 7469  class_distributi
+00075bc0: 6f6e 2879 290d 0a20 2020 2073 6d6f 7465  on(y)..    smote
+00075bd0: 203d 2053 564d 534d 4f54 4528 2072 616e   = SVMSMOTE( ran
+00075be0: 646f 6d5f 7374 6174 653d 3237 2c0d 0a20  dom_state=27,.. 
+00075bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075c00: 2073 616d 706c 696e 675f 7374 7261 7465   sampling_strate
+00075c10: 6779 3d63 6c61 7373 5f77 6569 6768 7465  gy=class_weighte
+00075c20: 645f 726f 7773 290d 0a20 2020 2058 2c20  d_rows)..    X, 
+00075c30: 7920 3d20 736d 6f74 652e 6669 745f 7265  y = smote.fit_re
+00075c40: 7361 6d70 6c65 2858 2c20 7929 0d0a 2020  sample(X, y)..  
+00075c50: 2020 7265 7475 726e 2858 2c79 290d 0a0d    return(X,y)...
+00075c60: 0a64 6566 206f 7665 7273 616d 706c 655f  .def oversample_
+00075c70: 4144 4153 594e 2858 2c79 293a 0d0a 2020  ADASYN(X,y):..  
+00075c80: 2020 2369 6e70 7574 2044 6174 6146 7261    #input DataFra
+00075c90: 6d65 0d0a 2020 2020 2358 20e2 8692 496e  me..    #X ...In
+00075ca0: 6465 7065 6e64 656e 7420 5661 7269 6162  dependent Variab
+00075cb0: 6c65 2069 6e20 4461 7461 4672 616d 655c  le in DataFrame\
+00075cc0: 0d0a 2020 2020 2379 20e2 8692 6465 7065  ..    #y ...depe
+00075cd0: 6e64 656e 7420 5661 7269 6162 6c65 2069  ndent Variable i
+00075ce0: 6e20 5061 6e64 6173 2044 6174 6146 7261  n Pandas DataFra
+00075cf0: 6d65 2066 6f72 6d61 740d 0a20 2020 2023  me format..    #
+00075d00: 2047 6574 2074 6865 2063 6c61 7373 2064   Get the class d
+00075d10: 6973 7472 6975 6274 696f 6e20 666f 7220  istriubtion for 
+00075d20: 7065 7266 6f6d 696e 6720 7265 6c61 7469  perfoming relati
+00075d30: 7665 2073 616d 706c 696e 6720 696e 2074  ve sampling in t
+00075d40: 6865 206e 6578 7420 6c69 6e65 0d0a 2020  he next line..  
+00075d50: 2020 636c 6173 735f 7765 6967 6874 6564    class_weighted
+00075d60: 5f72 6f77 7320 3d20 6765 745f 636c 6173  _rows = get_clas
+00075d70: 735f 6469 7374 7269 6275 7469 6f6e 2879  s_distribution(y
+00075d80: 290d 0a20 2020 2023 2059 6f75 7220 6661  )..    # Your fa
+00075d90: 766f 7572 6974 6520 6f76 6572 7361 6d70  vourite oversamp
+00075da0: 6c65 720d 0a20 2020 2073 6d6f 7465 203d  ler..    smote =
+00075db0: 2041 4441 5359 4e28 7261 6e64 6f6d 5f73   ADASYN(random_s
+00075dc0: 7461 7465 3d32 372c 0d0a 2020 2020 2020  tate=27,..      
+00075dd0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+00075de0: 706c 696e 675f 7374 7261 7465 6779 3d63  pling_strategy=c
+00075df0: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
+00075e00: 7773 290d 0a20 2020 2058 2c20 7920 3d20  ws)..    X, y = 
+00075e10: 736d 6f74 652e 6669 745f 7265 7361 6d70  smote.fit_resamp
+00075e20: 6c65 2858 2c20 7929 0d0a 2020 2020 7265  le(X, y)..    re
+00075e30: 7475 726e 2858 2c79 290d 0a23 2323 2323  turn(X,y)..#####
+00075e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00075e90: 2323 2323 2323 0d0a 6465 6620 6d61 7274  ######..def mart
+00075ea0: 6861 735f 636f 6c75 6d6e 7328 6461 7461  has_columns(data
+00075eb0: 2c76 6572 626f 7365 3d30 293a 0d0a 2020  ,verbose=0):..  
+00075ec0: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
+00075ed0: 7072 6f67 7261 6d20 6973 206e 616d 6564  program is named
+00075ee0: 2020 696e 2068 6f6e 6f72 206f 6620 6d79    in honor of my
+00075ef0: 206f 6e65 206f 6620 7374 7564 656e 7473   one of students
+00075f00: 2c20 4d61 7274 6861 2c20 7768 6f20 6361  , Martha, who ca
+00075f10: 6d65 2075 7020 7769 7468 2074 6865 2069  me up with the i
+00075f20: 6465 6120 666f 7220 6974 2e0d 0a20 2020  dea for it...   
+00075f30: 2049 7427 7320 6120 6e65 6174 2077 6179   It's a neat way
+00075f40: 206f 6620 7072 696e 7469 6e67 2064 6174   of printing dat
+00075f50: 6120 7479 7065 7320 616e 6420 696e 666f  a types and info
+00075f60: 726d 6174 696f 6e20 636f 6d70 6172 6564  rmation compared
+00075f70: 2074 6f20 7468 6520 626f 7269 6e67 2064   to the boring d
+00075f80: 6573 6372 6962 6528 2920 6675 6e63 7469  escribe() functi
+00075f90: 6f6e 2069 6e20 5061 6e64 6173 2e0d 0a20  on in Pandas... 
+00075fa0: 2020 2022 2222 0d0a 2020 2020 6461 7461     """..    data
+00075fb0: 203d 2064 6174 615b 3a5d 0d0a 2020 2020   = data[:]..    
+00075fc0: 7072 696e 7428 2744 6174 6120 5365 7420  print('Data Set 
+00075fd0: 5368 6170 653a 2025 6420 726f 7773 2c20  Shape: %d rows, 
+00075fe0: 2564 2063 6f6c 7327 2025 2064 6174 612e  %d cols' % data.
+00075ff0: 7368 6170 6529 0d0a 2020 2020 6966 2064  shape)..    if d
+00076000: 6174 612e 7368 6170 655b 315d 203e 2033  ata.shape[1] > 3
+00076010: 303a 0d0a 2020 2020 2020 2020 7072 696e  0:..        prin
+00076020: 7428 2754 6f6f 206d 616e 7920 636f 6c75  t('Too many colu
+00076030: 6d6e 7320 746f 2070 7269 6e74 2729 0d0a  mns to print')..
+00076040: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00076050: 2020 2069 6620 7665 7262 6f73 653d 3d31     if verbose==1
+00076060: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00076070: 7269 6e74 2827 2020 2020 4164 6469 7469  rint('    Additi
+00076080: 6f6e 616c 2064 6574 6169 6c73 206f 6e20  onal details on 
+00076090: 636f 6c75 6d6e 733a 2729 0d0a 2020 2020  columns:')..    
+000760a0: 2020 2020 2020 2020 666f 7220 636f 6c20          for col 
+000760b0: 696e 2064 6174 612e 636f 6c75 6d6e 733a  in data.columns:
+000760c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000760d0: 2020 7072 696e 7428 275c 742a 2025 733a    print('\t* %s:
+000760e0: 5c74 2564 206d 6973 7369 6e67 2c20 2564  \t%d missing, %d
+000760f0: 2075 6e69 7175 6573 2c20 6d6f 7374 2063   uniques, most c
+00076100: 6f6d 6d6f 6e3a 2025 7327 2025 2028 0d0a  ommon: %s' % (..
+00076110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076120: 2020 2020 2020 2020 636f 6c2c 0d0a 2020          col,..  
+00076130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076140: 2020 2020 2020 6461 7461 5b63 6f6c 5d2e        data[col].
+00076150: 6973 6e75 6c6c 2829 2e73 756d 2829 2c0d  isnull().sum(),.
+00076160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00076170: 2020 2020 2020 2020 2064 6174 615b 636f           data[co
+00076180: 6c5d 2e6e 756e 6971 7565 2829 2c0d 0a20  l].nunique(),.. 
+00076190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000761a0: 2020 2020 2020 2064 6174 615b 636f 6c5d         data[col]
+000761b0: 2e76 616c 7565 5f63 6f75 6e74 7328 292e  .value_counts().
+000761c0: 6865 6164 2832 292e 746f 5f64 6963 7428  head(2).to_dict(
+000761d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000761e0: 2020 2020 2020 2029 290d 0a20 2020 2020         ))..     
+000761f0: 2020 2020 2020 2070 7269 6e74 2827 2d2d         print('--
+00076200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00076210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00076220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00076230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00076240: 2d2d 2729 0d0a 2323 2323 2323 2323 2323  --')..##########
+00076250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076290: 2323 2323 2323 2323 0d0a 6465 6620 6765  ########..def ge
+000762a0: 745f 7369 7a65 2862 7974 6573 2c20 7375  t_size(bytes, su
+000762b0: 6666 6978 3d22 4222 293a 0d0a 2020 2020  ffix="B"):..    
+000762c0: 2222 220d 0a20 2020 2053 6361 6c65 2062  """..    Scale b
+000762d0: 7974 6573 2074 6f20 6974 7320 7072 6f70  ytes to its prop
+000762e0: 6572 2066 6f72 6d61 740d 0a20 2020 2065  er format..    e
+000762f0: 2e67 3a0d 0a20 2020 2020 2020 2031 3235  .g:..        125
+00076300: 3336 3536 203d 3e20 2731 2e32 304d 4227  3656 => '1.20MB'
+00076310: 0d0a 2020 2020 2020 2020 3132 3533 3635  ..        125365
+00076320: 3636 3738 203d 3e20 2731 2e31 3747 4227  6678 => '1.17GB'
+00076330: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
+00076340: 6163 746f 7220 3d20 3130 3234 0d0a 2020  actor = 1024..  
+00076350: 2020 666f 7220 756e 6974 2069 6e20 5b22    for unit in ["
+00076360: 222c 2022 4b22 2c20 224d 222c 2022 4722  ", "K", "M", "G"
+00076370: 2c20 2254 222c 2022 5022 5d3a 0d0a 2020  , "T", "P"]:..  
+00076380: 2020 2020 2020 6966 2062 7974 6573 203c        if bytes <
+00076390: 2066 6163 746f 723a 0d0a 2020 2020 2020   factor:..      
+000763a0: 2020 2020 2020 7265 7475 726e 2066 227b        return f"{
+000763b0: 6279 7465 733a 2e32 667d 7b75 6e69 747d  bytes:.2f}{unit}
+000763c0: 7b73 7566 6669 787d 220d 0a20 2020 2020  {suffix}"..     
+000763d0: 2020 2062 7974 6573 202f 3d20 6661 6374     bytes /= fact
+000763e0: 6f72 0d0a 0d0a 6465 6620 7072 696e 745f  or....def print_
+000763f0: 7379 7374 656d 5f69 6e66 6f28 293a 0d0a  system_info():..
+00076400: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
+00076410: 7320 7072 696e 7473 2074 6865 2069 6e66  s prints the inf
+00076420: 6f72 6d61 7469 6f6e 206f 6e20 7468 6520  ormation on the 
+00076430: 6861 7264 7761 7265 2072 756e 6e69 6e67  hardware running
+00076440: 2074 6865 2050 7974 686f 6e20 636f 6465   the Python code
+00076450: 200d 0a20 2020 204d 616e 7920 7468 616e   ..    Many than
+00076460: 6b73 2074 6f3a 2068 7474 7073 3a2f 2f77  ks to: https://w
+00076470: 7777 2e74 6865 7079 7468 6f6e 636f 6465  ww.thepythoncode
+00076480: 2e63 6f6d 2f61 7274 6963 6c65 2f67 6574  .com/article/get
+00076490: 2d68 6172 6477 6172 652d 7379 7374 656d  -hardware-system
+000764a0: 2d69 6e66 6f72 6d61 7469 6f6e 2d70 7974  -information-pyt
+000764b0: 686f 6e0d 0a20 2020 2022 2222 0d0a 2020  hon..    """..  
+000764c0: 2020 696d 706f 7274 2070 7375 7469 6c0d    import psutil.
+000764d0: 0a20 2020 2069 6d70 6f72 7420 706c 6174  .    import plat
+000764e0: 666f 726d 0d0a 2020 2020 7072 696e 7428  form..    print(
+000764f0: 223d 222a 3230 2c20 2253 7973 7465 6d20  "="*20, "System 
+00076500: 496e 666f 726d 6174 696f 6e22 2c20 223d  Information", "=
+00076510: 222a 3230 290d 0a20 2020 2075 6e61 6d65  "*20)..    uname
+00076520: 203d 2070 6c61 7466 6f72 6d2e 756e 616d   = platform.unam
+00076530: 6528 290d 0a20 2020 2070 7269 6e74 2866  e()..    print(f
+00076540: 2253 7973 7465 6d3a 207b 756e 616d 652e  "System: {uname.
+00076550: 7379 7374 656d 7d22 290d 0a20 2020 2070  system}")..    p
+00076560: 7269 6e74 2866 224e 6f64 6520 4e61 6d65  rint(f"Node Name
+00076570: 3a20 7b75 6e61 6d65 2e6e 6f64 657d 2229  : {uname.node}")
+00076580: 0d0a 2020 2020 7072 696e 7428 6622 5265  ..    print(f"Re
+00076590: 6c65 6173 653a 207b 756e 616d 652e 7265  lease: {uname.re
+000765a0: 6c65 6173 657d 2229 0d0a 2020 2020 7072  lease}")..    pr
+000765b0: 696e 7428 6622 5665 7273 696f 6e3a 207b  int(f"Version: {
+000765c0: 756e 616d 652e 7665 7273 696f 6e7d 2229  uname.version}")
+000765d0: 0d0a 2020 2020 7072 696e 7428 6622 4d61  ..    print(f"Ma
+000765e0: 6368 696e 653a 207b 756e 616d 652e 6d61  chine: {uname.ma
+000765f0: 6368 696e 657d 2229 0d0a 2020 2020 7072  chine}")..    pr
+00076600: 696e 7428 6622 5072 6f63 6573 736f 723a  int(f"Processor:
+00076610: 207b 756e 616d 652e 7072 6f63 6573 736f   {uname.processo
+00076620: 727d 2229 0d0a 2020 2020 7072 696e 7428  r}")..    print(
+00076630: 223d 222a 3232 2c20 2243 5055 2049 6e66  "="*22, "CPU Inf
+00076640: 6f72 6d61 7469 6f6e 222c 2022 3d22 2a32  ormation", "="*2
+00076650: 3229 0d0a 2020 2020 2320 6e75 6d62 6572  2)..    # number
+00076660: 206f 6620 636f 7265 730d 0a20 2020 2070   of cores..    p
+00076670: 7269 6e74 2822 5068 7973 6963 616c 2063  rint("Physical c
+00076680: 6f72 6573 3a22 2c20 7073 7574 696c 2e63  ores:", psutil.c
+00076690: 7075 5f63 6f75 6e74 286c 6f67 6963 616c  pu_count(logical
+000766a0: 3d46 616c 7365 2929 0d0a 2020 2020 7072  =False))..    pr
+000766b0: 696e 7428 2254 6f74 616c 2063 6f72 6573  int("Total cores
+000766c0: 3a22 2c20 7073 7574 696c 2e63 7075 5f63  :", psutil.cpu_c
+000766d0: 6f75 6e74 286c 6f67 6963 616c 3d54 7275  ount(logical=Tru
+000766e0: 6529 290d 0a20 2020 2070 7269 6e74 2822  e))..    print("
+000766f0: 3d22 2a32 302c 2022 4d65 6d6f 7279 2049  ="*20, "Memory I
+00076700: 6e66 6f72 6d61 7469 6f6e 222c 2022 3d22  nformation", "="
+00076710: 2a32 3029 0d0a 2020 2020 2320 6765 7420  *20)..    # get 
+00076720: 7468 6520 6d65 6d6f 7279 2064 6574 6169  the memory detai
+00076730: 6c73 0d0a 2020 2020 7376 6d65 6d20 3d20  ls..    svmem = 
+00076740: 7073 7574 696c 2e76 6972 7475 616c 5f6d  psutil.virtual_m
+00076750: 656d 6f72 7928 290d 0a20 2020 2070 7269  emory()..    pri
+00076760: 6e74 2866 2254 6f74 616c 3a20 7b67 6574  nt(f"Total: {get
+00076770: 5f73 697a 6528 7376 6d65 6d2e 746f 7461  _size(svmem.tota
+00076780: 6c29 7d22 290d 0a20 2020 2070 7269 6e74  l)}")..    print
+00076790: 2866 2241 7661 696c 6162 6c65 3a20 7b67  (f"Available: {g
+000767a0: 6574 5f73 697a 6528 7376 6d65 6d2e 6176  et_size(svmem.av
+000767b0: 6169 6c61 626c 6529 7d22 290d 0a20 2020  ailable)}")..   
+000767c0: 2070 7269 6e74 2866 2255 7365 643a 207b   print(f"Used: {
+000767d0: 6765 745f 7369 7a65 2873 766d 656d 2e75  get_size(svmem.u
+000767e0: 7365 6429 7d22 290d 0a20 2020 2070 7269  sed)}")..    pri
+000767f0: 6e74 2822 3d22 2a31 382c 2022 5379 7374  nt("="*18, "Syst
+00076800: 656d 2049 6e66 6f72 6d61 7469 6f6e 2045  em Information E
+00076810: 6e64 222c 2022 3d22 2a31 3829 0d0a 2323  nd", "="*18)..##
+00076820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00076870: 2323 2300 0000 0000 0000 0000 0000 0000  ###.............
+00076880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000768f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00076900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00076920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00076950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00076940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000769f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076a00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00076a10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-00076a20: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
-00076a30: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-00076a40: 7420 6173 2070 6c74 0d0a 6765 745f 6970  t as plt..get_ip
-00076a50: 7974 686f 6e28 292e 6d61 6769 6328 276d  ython().magic('m
-00076a60: 6174 706c 6f74 6c69 6220 696e 6c69 6e65  atplotlib inline
-00076a70: 2729 0d0a 696d 706f 7274 2073 6561 626f  ')..import seabo
-00076a80: 726e 2061 7320 736e 730d 0a73 6e73 2e73  rn as sns..sns.s
-00076a90: 6574 2873 7479 6c65 3d22 7768 6974 6522  et(style="white"
-00076aa0: 2c20 636f 6c6f 725f 636f 6465 733d 5472  , color_codes=Tr
-00076ab0: 7565 290d 0a69 6d70 6f72 7420 7761 726e  ue)..import warn
-00076ac0: 696e 6773 0d0a 7761 726e 696e 6773 2e66  ings..warnings.f
-00076ad0: 696c 7465 7277 6172 6e69 6e67 7328 2269  ilterwarnings("i
-00076ae0: 676e 6f72 6522 290d 0a66 726f 6d20 736b  gnore")..from sk
-00076af0: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
-00076b00: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
-00076b10: 7373 5f76 616c 5f73 636f 7265 2c20 5374  ss_val_score, St
-00076b20: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
-00076b30: 706c 6974 2c20 5469 6d65 5365 7269 6573  plit, TimeSeries
-00076b40: 5370 6c69 740d 0a66 726f 6d20 736b 6c65  Split..from skle
-00076b50: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
-00076b60: 696e 6561 7253 5643 2c20 4c69 6e65 6172  inearSVC, Linear
-00076b70: 5356 520d 0a66 726f 6d20 736b 6c65 6172  SVR..from sklear
-00076b80: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
-00076b90: 6d70 6f72 7420 5347 4452 6567 7265 7373  mport SGDRegress
-00076ba0: 6f72 2c20 5347 4443 6c61 7373 6966 6965  or, SGDClassifie
-00076bb0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-00076bc0: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
-00076bd0: 696d 706f 7274 2063 726f 7373 5f76 616c  import cross_val
-00076be0: 5f73 636f 7265 2c20 5374 7261 7469 6669  _score, Stratifi
-00076bf0: 6564 5368 7566 666c 6553 706c 6974 2c20  edShuffleSplit, 
-00076c00: 5469 6d65 5365 7269 6573 5370 6c69 740d  TimeSeriesSplit.
-00076c10: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
-00076c20: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
-00076c30: 706f 7274 2053 6875 6666 6c65 5370 6c69  port ShuffleSpli
-00076c40: 742c 5374 7261 7469 6669 6564 4b46 6f6c  t,StratifiedKFol
-00076c50: 642c 4b46 6f6c 640d 0a66 726f 6d20 736b  d,KFold..from sk
-00076c60: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
-00076c70: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
-00076c80: 7274 204c 696e 6561 7244 6973 6372 696d  rt LinearDiscrim
-00076c90: 696e 616e 7441 6e61 6c79 7369 730d 0a66  inantAnalysis..f
-00076ca0: 726f 6d20 736b 6c65 6172 6e2e 656e 7365  rom sklearn.ense
-00076cb0: 6d62 6c65 2069 6d70 6f72 7420 4261 6767  mble import Bagg
-00076cc0: 696e 6752 6567 7265 7373 6f72 2c20 5261  ingRegressor, Ra
-00076cd0: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
-00076ce0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
-00076cf0: 7374 5265 6772 6573 736f 720d 0a66 726f  stRegressor..fro
-00076d00: 6d20 736b 6c65 6172 6e2e 656e 7365 6d62  m sklearn.ensemb
-00076d10: 6c65 2069 6d70 6f72 7420 4578 7472 6154  le import ExtraT
-00076d20: 7265 6573 436c 6173 7369 6669 6572 2c45  reesClassifier,E
-00076d30: 7874 7261 5472 6565 7352 6567 7265 7373  xtraTreesRegress
-00076d40: 6f72 0d0a 6672 6f6d 2073 6b6c 6561 726e  or..from sklearn
-00076d50: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
-00076d60: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
-00076d70: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
-00076d80: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
-00076d90: 6765 0d0a 6672 6f6d 2073 6b6c 6561 726e  ge..from sklearn
-00076da0: 2e73 766d 2069 6d70 6f72 7420 4c69 6e65  .svm import Line
-00076db0: 6172 5356 432c 2053 5652 2c20 4c69 6e65  arSVC, SVR, Line
-00076dc0: 6172 5356 520d 0a66 726f 6d20 736b 6c65  arSVR..from skle
-00076dd0: 6172 6e2e 656e 7365 6d62 6c65 2069 6d70  arn.ensemble imp
-00076de0: 6f72 7420 4164 6142 6f6f 7374 436c 6173  ort AdaBoostClas
-00076df0: 7369 6669 6572 2c20 4164 6142 6f6f 7374  sifier, AdaBoost
-00076e00: 5265 6772 6573 736f 720d 0a66 726f 6d20  Regressor..from 
-00076e10: 736b 6c65 6172 6e2e 7472 6565 2069 6d70  sklearn.tree imp
-00076e20: 6f72 7420 4465 6369 7369 6f6e 5472 6565  ort DecisionTree
-00076e30: 5265 6772 6573 736f 722c 2044 6563 6973  Regressor, Decis
-00076e40: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
-00076e50: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-00076e60: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
-00076e70: 6f72 7420 4c61 7373 6f2c 204c 6173 736f  ort Lasso, Lasso
-00076e80: 4356 2c20 5269 6467 652c 2052 6964 6765  CV, Ridge, Ridge
-00076e90: 4356 2c20 4c61 7373 6f4c 6172 7343 560d  CV, LassoLarsCV.
-00076ea0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
-00076eb0: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
-00076ec0: 706f 7274 2063 726f 7373 5f76 616c 5f70  port cross_val_p
-00076ed0: 7265 6469 6374 0d0a 6672 6f6d 2073 6b6c  redict..from skl
-00076ee0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
-00076ef0: 706f 7274 2045 7874 7261 5472 6565 7352  port ExtraTreesR
-00076f00: 6567 7265 7373 6f72 2c20 4578 7472 6154  egressor, ExtraT
-00076f10: 7265 6573 436c 6173 7369 6669 6572 0d0a  reesClassifier..
-00076f20: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
-00076f30: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
-00076f40: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
-00076f50: 696f 6e2c 204c 6f67 6973 7469 6352 6567  ion, LogisticReg
-00076f60: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
-00076f70: 7252 6567 7265 7373 696f 6e0d 0a66 726f  rRegression..fro
-00076f80: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
-00076f90: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
-00076fa0: 2047 7269 6453 6561 7263 6843 562c 5374   GridSearchCV,St
-00076fb0: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
-00076fc0: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
-00076fd0: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
-00076fe0: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
-00076ff0: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
-00077000: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
-00077010: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
-00077020: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-00077030: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00077040: 756c 7469 636c 6173 7320 696d 706f 7274  ulticlass import
-00077050: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
-00077060: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
-00077070: 726e 2e6e 6569 6768 626f 7273 2069 6d70  rn.neighbors imp
-00077080: 6f72 7420 4b4e 6569 6768 626f 7273 5265  ort KNeighborsRe
-00077090: 6772 6573 736f 720d 0a69 6d70 6f72 7420  gressor..import 
-000770a0: 7469 6d65 0d0a 696d 706f 7274 2070 6462  time..import pdb
-000770b0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
-000770c0: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
-000770d0: 7274 206f 7065 7261 746f 720d 0a23 2323  rt operator..###
-000770e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000770f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00077100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00077110: 2323 2323 2323 0d0a 6465 6620 5175 6963  ######..def Quic
-00077120: 6b4d 4c5f 456e 7365 6d62 6c69 6e67 2858  kML_Ensembling(X
-00077130: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
-00077140: 2058 5f74 6573 742c 2079 5f74 6573 743d   X_test, y_test=
-00077150: 2727 2c20 6d6f 6465 6c74 7970 653d 2752  '', modeltype='R
-00077160: 6567 7265 7373 696f 6e27 2c0d 0a20 2020  egression',..   
-00077170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077180: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
-00077190: 673d 4661 6c73 652c 0d0a 2020 2020 2020  g=False,..      
-000771a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000771b0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
-000771c0: 626f 7365 3d30 293a 0d0a 2020 2020 2222  bose=0):..    ""
-000771d0: 220d 0a20 2020 2051 7569 636b 6c79 2062  "..    Quickly b
-000771e0: 7569 6c64 7320 616e 6420 7275 6e73 206d  uilds and runs m
-000771f0: 756c 7469 706c 6520 6d6f 6465 6c73 2066  ultiple models f
-00077200: 6f72 2061 2063 6c65 616e 2064 6174 6120  or a clean data 
-00077210: 7365 7428 6f6e 6c79 206e 756d 6572 6963  set(only numeric
-00077220: 7329 2e0d 0a20 2020 2022 2222 0d0a 2020  s)...    """..  
-00077230: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-00077240: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
-00077250: 7365 6564 203d 2039 390d 0a20 2020 2046  seed = 99..    F
-00077260: 4f4c 4453 203d 2035 0d0a 2020 2020 6d6f  OLDS = 5..    mo
-00077270: 6465 6c5f 6469 6374 203d 207b 7d0d 0a20  del_dict = {}.. 
-00077280: 2020 206d 6f64 656c 5f74 7570 6c65 7320     model_tuples 
-00077290: 3d20 5b5d 0d0a 2020 2020 6966 206c 656e  = []..    if len
-000772a0: 2858 5f74 7261 696e 2920 3c3d 2031 3030  (X_train) <= 100
-000772b0: 3030 3020 616e 6420 585f 7472 6169 6e2e  000 and X_train.
-000772c0: 7368 6170 655b 315d 203c 2035 303a 0d0a  shape[1] < 50:..
-000772d0: 2020 2020 2020 2020 4e55 4d53 203d 2031          NUMS = 1
-000772e0: 3030 0d0a 2020 2020 656c 7365 3a0d 0a20  00..    else:.. 
-000772f0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00077300: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
-00077310: 203d 2058 5f74 7261 696e 2e73 616d 706c   = X_train.sampl
-00077320: 6528 6672 6163 3d30 2e33 302c 7261 6e64  e(frac=0.30,rand
-00077330: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-00077340: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
-00077350: 6e20 3d20 795f 7472 6169 6e5b 585f 7472  n = y_train[X_tr
-00077360: 6169 6e2e 696e 6465 785d 0d0a 2020 2020  ain.index]..    
-00077370: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00077380: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-00077390: 2020 2020 2020 204e 554d 5320 3d20 3230         NUMS = 20
-000773a0: 300d 0a20 2020 2023 2323 2323 2320 5468  0..    ###### Th
-000773b0: 6973 2069 7320 7768 6572 6520 7765 2073  is is where we s
-000773c0: 7461 7274 2070 6572 666f 726d 696e 6720  tart performing 
-000773d0: 656e 7365 6d62 6c69 6e67 206f 6620 6d75  ensembling of mu
-000773e0: 6c74 6970 6c65 2073 696d 706c 6572 206d  ltiple simpler m
-000773f0: 6f64 656c 7320 2323 230d 0a20 2020 2069  odels ###..    i
-00077400: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00077410: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-00077420: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
-00077430: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
-00077440: 2020 2020 2073 636f 7269 6e67 203d 2027       scoring = '
-00077450: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
-00077460: 5f65 7272 6f72 270d 0a20 2020 2020 2020  _error'..       
-00077470: 2023 7363 7620 3d20 5368 7566 666c 6553   #scv = ShuffleS
-00077480: 706c 6974 286e 5f73 706c 6974 733d 464f  plit(n_splits=FO
-00077490: 4c44 532c 7261 6e64 6f6d 5f73 7461 7465  LDS,random_state
-000774a0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
-000774b0: 7363 7620 3d20 4b46 6f6c 6428 6e5f 7370  scv = KFold(n_sp
-000774c0: 6c69 7473 3d46 4f4c 4453 2c20 7368 7566  lits=FOLDS, shuf
-000774d0: 666c 653d 4661 6c73 6529 0d0a 2020 2020  fle=False)..    
-000774e0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-000774f0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-00077500: 2020 2020 2020 2020 2020 2023 2320 4372             ## Cr
-00077510: 6561 7465 2061 6e20 656e 7365 6d62 6c65  eate an ensemble
-00077520: 206d 6f64 656c 2023 2323 230d 0a20 2020   model ####..   
-00077530: 2020 2020 2020 2020 206d 6f64 656c 3520           model5 
-00077540: 3d20 4164 6142 6f6f 7374 5265 6772 6573  = AdaBoostRegres
-00077550: 736f 7228 6261 7365 5f65 7374 696d 6174  sor(base_estimat
-00077560: 6f72 3d44 6563 6973 696f 6e54 7265 6552  or=DecisionTreeR
-00077570: 6567 7265 7373 6f72 280d 0a20 2020 2020  egressor(..     
-00077580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077590: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000775a0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-000775b0: 2c20 6d61 785f 6465 7074 683d 312c 206d  , max_depth=1, m
-000775c0: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
-000775d0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
-000775e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000775f0: 2020 2020 2020 2029 2c20 6e5f 6573 7469         ), n_esti
-00077600: 6d61 746f 7273 3d4e 554d 532c 2072 616e  mators=NUMS, ran
-00077610: 646f 6d5f 7374 6174 653d 7365 6564 290d  dom_state=seed).
-00077620: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00077630: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
-00077640: 2828 2741 6461 626f 6f73 7427 2c6d 6f64  (('Adaboost',mod
-00077650: 656c 3529 290d 0a20 2020 2020 2020 2065  el5))..        e
-00077660: 6c69 6620 6e6f 7420 426f 6f73 7469 6e67  lif not Boosting
-00077670: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
-00077680: 2020 2020 6d6f 6465 6c35 203d 204c 6173      model5 = Las
-00077690: 736f 4c61 7273 4356 2863 763d 7363 7629  soLarsCV(cv=scv)
-000776a0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-000776b0: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
-000776c0: 6428 2827 4c61 7373 6f4c 6172 7343 5627  d(('LassoLarsCV'
-000776d0: 2c6d 6f64 656c 3529 290d 0a20 2020 2020  ,model5))..     
-000776e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000776f0: 2020 2020 2020 6d6f 6465 6c35 203d 204c        model5 = L
-00077700: 6173 736f 4c61 7273 4356 2863 763d 7363  assoLarsCV(cv=sc
-00077710: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
-00077720: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-00077730: 656e 6428 2827 4c61 7373 6f4c 6172 7343  end(('LassoLarsC
-00077740: 5627 2c6d 6f64 656c 3529 290d 0a20 2020  V',model5))..   
-00077750: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
-00077760: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
-00077770: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00077780: 6c36 203d 2042 6167 6769 6e67 5265 6772  l6 = BaggingRegr
-00077790: 6573 736f 7228 4465 6369 7369 6f6e 5472  essor(DecisionTr
-000777a0: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
-000777b0: 6f6d 5f73 7461 7465 3d73 6565 6429 2c0d  om_state=seed),.
-000777c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000777d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000777e0: 2020 2020 2020 2020 2020 2020 206e 5f65               n_e
-000777f0: 7374 696d 6174 6f72 733d 4e55 4d53 2c72  stimators=NUMS,r
-00077800: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-00077810: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
-00077820: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-00077830: 6e64 2828 2742 6167 6769 6e67 5f52 6567  nd(('Bagging_Reg
-00077840: 7265 7373 6f72 272c 6d6f 6465 6c36 2929  ressor',model6))
-00077850: 0d0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
-00077860: 6f74 2042 6f6f 7374 696e 675f 466c 6167  ot Boosting_Flag
-00077870: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
-00077880: 6f64 656c 3620 3d20 4c69 6e65 6172 5356  odel6 = LinearSV
-00077890: 5228 290d 0a20 2020 2020 2020 2020 2020  R()..           
-000778a0: 206d 6f64 656c 5f74 7570 6c65 732e 6170   model_tuples.ap
-000778b0: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
-000778c0: 5227 2c6d 6f64 656c 3629 290d 0a20 2020  R',model6))..   
-000778d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000778e0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-000778f0: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
-00077900: 7265 7373 6f72 286d 6178 5f64 6570 7468  ressor(max_depth
-00077910: 3d35 2c6d 696e 5f73 616d 706c 6573 5f6c  =5,min_samples_l
-00077920: 6561 663d 3229 0d0a 2020 2020 2020 2020  eaf=2)..        
-00077930: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
-00077940: 2e61 7070 656e 6428 2827 4465 6369 7369  .append(('Decisi
-00077950: 6f6e 5f54 7265 6527 2c6d 6f64 656c 3629  on_Tree',model6)
-00077960: 290d 0a20 2020 2020 2020 206d 6f64 656c  )..        model
-00077970: 3720 3d20 4b4e 6569 6768 626f 7273 5265  7 = KNeighborsRe
-00077980: 6772 6573 736f 7228 6e5f 6e65 6967 6862  gressor(n_neighb
-00077990: 6f72 733d 3829 0d0a 2020 2020 2020 2020  ors=8)..        
-000779a0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-000779b0: 656e 6428 2827 4b4e 4e5f 5265 6772 6573  end(('KNN_Regres
-000779c0: 736f 7227 2c6d 6f64 656c 3729 290d 0a20  sor',model7)).. 
-000779d0: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
-000779e0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
-000779f0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-00077a00: 2323 2049 6620 7468 6520 426f 6f73 7469  ## If the Boosti
-00077a10: 6e67 5f46 6c61 6720 6973 2054 7275 652c  ng_Flag is True,
-00077a20: 2069 7420 6d65 616e 7320 426f 6f73 7469   it means Boosti
-00077a30: 6e67 206d 6f64 656c 2069 7320 7072 6573  ng model is pres
-00077a40: 656e 742e 0d0a 2020 2020 2020 2020 2020  ent...          
-00077a50: 2020 2323 2320 2020 536f 2063 686f 6f73    ###   So choos
-00077a60: 6520 6120 6469 6666 6572 656e 7420 6b69  e a different ki
-00077a70: 6e64 206f 6620 636c 6173 7369 6669 6572  nd of classifier
-00077a80: 2068 6572 650d 0a20 2020 2020 2020 2020   here..         
-00077a90: 2020 206d 6f64 656c 3820 3d20 4465 6369     model8 = Deci
-00077aa0: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
-00077ab0: 7228 6d61 785f 6465 7074 683d 352c 6d69  r(max_depth=5,mi
-00077ac0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-00077ad0: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
-00077ae0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-00077af0: 6e64 2828 2744 6563 6973 696f 6e5f 5472  nd(('Decision_Tr
-00077b00: 6565 272c 6d6f 6465 6c38 2929 0d0a 2020  ee',model8))..  
-00077b10: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
-00077b20: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-00077b30: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00077b40: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00077b50: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-00077b60: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-00077b70: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-00077b80: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00077b90: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-00077ba0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-00077bb0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-00077bc0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00077bd0: 6d6f 6465 6c38 203d 2041 6461 426f 6f73  model8 = AdaBoos
-00077be0: 7452 6567 7265 7373 6f72 2862 6173 655f  tRegressor(base_
-00077bf0: 6573 7469 6d61 746f 723d 4465 6369 7369  estimator=Decisi
-00077c00: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
-00077c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00077c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077c30: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-00077c40: 7465 3d73 6565 642c 206d 6178 5f64 6570  te=seed, max_dep
-00077c50: 7468 3d31 2c20 6d69 6e5f 7361 6d70 6c65  th=1, min_sample
-00077c60: 735f 6c65 6166 3d32 0d0a 2020 2020 2020  s_leaf=2..      
-00077c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077c80: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-00077c90: 206e 5f65 7374 696d 6174 6f72 733d 4e55   n_estimators=NU
-00077ca0: 4d53 2c20 7261 6e64 6f6d 5f73 7461 7465  MS, random_state
-00077cb0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
-00077cc0: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
-00077cd0: 2e61 7070 656e 6428 2827 4164 6162 6f6f  .append(('Adaboo
-00077ce0: 7374 272c 6d6f 6465 6c38 2929 0d0a 2020  st',model8))..  
-00077cf0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00077d00: 2020 2020 2020 2020 206d 6f64 656c 3820           model8 
-00077d10: 3d20 5261 6e64 6f6d 466f 7265 7374 5265  = RandomForestRe
-00077d20: 6772 6573 736f 7228 626f 6f74 7374 7261  gressor(bootstra
-00077d30: 7020 3d20 4661 6c73 652c 0d0a 2020 2020  p = False,..    
-00077d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077d60: 2020 206d 6178 5f64 6570 7468 203d 2031     max_depth = 1
-00077d70: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
-00077d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077d90: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
-00077da0: 6561 7475 7265 7320 3d20 2761 7574 6f27  eatures = 'auto'
-00077db0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00077dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077dd0: 2020 2020 2020 2020 2020 6d69 6e5f 7361            min_sa
-00077de0: 6d70 6c65 735f 6c65 6166 203d 2032 2c0d  mples_leaf = 2,.
-00077df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00077e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e10: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
-00077e20: 746f 7273 203d 2032 3030 2c0d 0a20 2020  tors = 200,..   
-00077e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077e50: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
-00077e60: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
-00077e70: 2020 6d6f 6465 6c5f 7475 706c 6573 2e61    model_tuples.a
-00077e80: 7070 656e 6428 2827 5246 5f52 6567 7265  ppend(('RF_Regre
-00077e90: 7373 6f72 272c 6d6f 6465 6c38 2929 0d0a  ssor',model8))..
-00077ea0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00077eb0: 2020 2069 6620 7363 6f72 696e 6720 3d3d     if scoring ==
-00077ec0: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
-00077ed0: 2020 7363 6f72 696e 6720 3d20 2761 6363    scoring = 'acc
-00077ee0: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
-00077ef0: 6e75 6d5f 636c 6173 7365 7320 3d20 6c65  num_classes = le
-00077f00: 6e28 6e70 2e75 6e69 7175 6528 795f 7465  n(np.unique(y_te
-00077f10: 7374 2929 0d0a 2020 2020 2020 2020 7363  st))..        sc
-00077f20: 7620 3d20 5374 7261 7469 6669 6564 4b46  v = StratifiedKF
-00077f30: 6f6c 6428 6e5f 7370 6c69 7473 3d46 4f4c  old(n_splits=FOL
-00077f40: 4453 2c20 7368 7566 666c 653d 5472 7565  DS, shuffle=True
-00077f50: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
-00077f60: 6565 6429 0d0a 2020 2020 2020 2020 6966  eed)..        if
-00077f70: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
-00077f80: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-00077f90: 2020 2020 2023 2320 4372 6561 7465 2061       ## Create a
-00077fa0: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
-00077fb0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
-00077fc0: 2020 206d 6f64 656c 3520 3d20 4164 6142     model5 = AdaB
-00077fd0: 6f6f 7374 436c 6173 7369 6669 6572 2862  oostClassifier(b
-00077fe0: 6173 655f 6573 7469 6d61 746f 723d 4465  ase_estimator=De
-00077ff0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-00078000: 6669 6572 280d 0a20 2020 2020 2020 2020  fier(..         
-00078010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078020: 2020 2020 2020 2020 2020 2072 616e 646f             rando
-00078030: 6d5f 7374 6174 653d 7365 6564 2c20 6d61  m_state=seed, ma
-00078040: 785f 6465 7074 683d 312c 206d 696e 5f73  x_depth=1, min_s
-00078050: 616d 706c 6573 5f6c 6561 663d 320d 0a20  amples_leaf=2.. 
-00078060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078080: 2020 2029 2c20 6e5f 6573 7469 6d61 746f     ), n_estimato
-00078090: 7273 3d4e 554d 532c 2072 616e 646f 6d5f  rs=NUMS, random_
-000780a0: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
-000780b0: 2020 2020 2020 2020 206d 6f64 656c 5f74           model_t
-000780c0: 7570 6c65 732e 6170 7065 6e64 2828 2741  uples.append(('A
-000780d0: 6461 626f 6f73 7427 2c6d 6f64 656c 3529  daboost',model5)
-000780e0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-000780f0: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
-00078100: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-00078110: 6d6f 6465 6c35 203d 204c 696e 6561 7244  model5 = LinearD
-00078120: 6973 6372 696d 696e 616e 7441 6e61 6c79  iscriminantAnaly
-00078130: 7369 7328 290d 0a20 2020 2020 2020 2020  sis()..         
-00078140: 2020 206d 6f64 656c 5f74 7570 6c65 732e     model_tuples.
-00078150: 6170 7065 6e64 2828 274c 696e 6561 725f  append(('Linear_
-00078160: 4469 7363 7269 6d69 6e61 6e74 272c 6d6f  Discriminant',mo
-00078170: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
-00078180: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00078190: 2020 206d 6f64 656c 3520 3d20 4c6f 6769     model5 = Logi
-000781a0: 7374 6963 5265 6772 6573 7369 6f6e 4356  sticRegressionCV
-000781b0: 2843 733d 5b30 2e30 3031 2c30 2e30 312c  (Cs=[0.001,0.01,
-000781c0: 302e 312c 312c 3130 2c31 3030 5d2c 2074  0.1,1,10,100], t
-000781d0: 6f6c 3d30 2e30 312c 0d0a 2020 2020 2020  ol=0.01,..      
-000781e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000781f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078200: 2020 2020 736f 6c76 6572 3d27 6c69 626c      solver='libl
-00078210: 696e 6561 7227 2c20 7261 6e64 6f6d 5f73  inear', random_s
-00078220: 7461 7465 3d73 6565 6429 0d0a 2020 2020  tate=seed)..    
-00078230: 2020 2020 2020 2020 6d6f 6465 6c5f 7475          model_tu
-00078240: 706c 6573 2e61 7070 656e 6428 2827 4c6f  ples.append(('Lo
-00078250: 6769 7374 6963 5f52 6567 7265 7373 696f  gistic_Regressio
-00078260: 6e5f 4356 272c 6d6f 6465 6c35 2929 0d0a  n_CV',model5))..
-00078270: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
-00078280: 696e 675f 466c 6167 2069 7320 4e6f 6e65  ing_Flag is None
-00078290: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
-000782a0: 6f64 656c 3620 3d20 4465 6369 7369 6f6e  odel6 = Decision
-000782b0: 5472 6565 436c 6173 7369 6669 6572 286d  TreeClassifier(m
-000782c0: 6178 5f64 6570 7468 3d35 2c6d 696e 5f73  ax_depth=5,min_s
-000782d0: 616d 706c 6573 5f6c 6561 663d 3229 0d0a  amples_leaf=2)..
-000782e0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-000782f0: 6c5f 7475 706c 6573 2e61 7070 656e 6428  l_tuples.append(
-00078300: 2827 4465 6369 7369 6f6e 5f54 7265 6527  ('Decision_Tree'
-00078310: 2c6d 6f64 656c 3629 290d 0a20 2020 2020  ,model6))..     
-00078320: 2020 2065 6c69 6620 6e6f 7420 426f 6f73     elif not Boos
-00078330: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
-00078340: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-00078350: 204c 696e 6561 7253 5643 2829 0d0a 2020   LinearSVC()..  
-00078360: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00078370: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
-00078380: 4c69 6e65 6172 5f53 5643 272c 6d6f 6465  Linear_SVC',mode
-00078390: 6c36 2929 0d0a 2020 2020 2020 2020 656c  l6))..        el
-000783a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000783b0: 206d 6f64 656c 3620 3d20 4465 6369 7369   model6 = Decisi
-000783c0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-000783d0: 286d 6178 5f64 6570 7468 3d35 2c6d 696e  (max_depth=5,min
-000783e0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-000783f0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
-00078400: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
-00078410: 6428 2827 4465 6369 7369 6f6e 5f54 7265  d(('Decision_Tre
-00078420: 6527 2c6d 6f64 656c 3629 290d 0a20 2020  e',model6))..   
-00078430: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
-00078440: 6520 3d3d 2027 4269 6e61 7279 5f43 6c61  e == 'Binary_Cla
-00078450: 7373 6966 6963 6174 696f 6e27 3a0d 0a20  ssification':.. 
-00078460: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00078470: 3720 3d20 4761 7573 7369 616e 4e42 2829  7 = GaussianNB()
-00078480: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00078490: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-000784a0: 656c 3720 3d20 4d75 6c74 696e 6f6d 6961  el7 = Multinomia
-000784b0: 6c4e 4228 290d 0a20 2020 2020 2020 206d  lNB()..        m
-000784c0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
-000784d0: 6e64 2828 274e 6169 7665 5f42 6179 6573  nd(('Naive_Bayes
-000784e0: 272c 6d6f 6465 6c37 2929 0d0a 2020 2020  ',model7))..    
-000784f0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
-00078500: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-00078510: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00078520: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00078530: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-00078540: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-00078550: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-00078560: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00078570: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-00078580: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-00078590: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-000785a0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-000785b0: 6d6f 6465 6c38 203d 2052 616e 646f 6d46  model8 = RandomF
-000785c0: 6f72 6573 7443 6c61 7373 6966 6965 7228  orestClassifier(
-000785d0: 626f 6f74 7374 7261 7020 3d20 4661 6c73  bootstrap = Fals
-000785e0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-000785f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078600: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-00078610: 6570 7468 203d 2031 302c 0d0a 2020 2020  epth = 10,..    
-00078620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078640: 2020 206d 6178 5f66 6561 7475 7265 7320     max_features 
-00078650: 3d20 2761 7574 6f27 2c0d 0a20 2020 2020  = 'auto',..     
+00076a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00076a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00076a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00076a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00076a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00076aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00076b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00076b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00076b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00076c10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00076c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00076e10: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
+00076e20: 4c5f 456e 7365 6d62 6c69 6e67 2e70 7900  L_Ensembling.py.
+00076e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00076e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00076e80: 3030 3332 3634 3400 3030 3030 3030 3030  0032644.00000000
+00076e90: 3030 3000 3032 3130 3131 0020 3000 0000  000.021011. 0...
+00076ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00076f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00076f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00076f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00076f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00076ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00077000: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+00077010: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+00077020: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
+00077030: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+00077040: 7420 6173 2070 6c74 0d0a 6765 745f 6970  t as plt..get_ip
+00077050: 7974 686f 6e28 292e 6d61 6769 6328 276d  ython().magic('m
+00077060: 6174 706c 6f74 6c69 6220 696e 6c69 6e65  atplotlib inline
+00077070: 2729 0d0a 696d 706f 7274 2073 6561 626f  ')..import seabo
+00077080: 726e 2061 7320 736e 730d 0a73 6e73 2e73  rn as sns..sns.s
+00077090: 6574 2873 7479 6c65 3d22 7768 6974 6522  et(style="white"
+000770a0: 2c20 636f 6c6f 725f 636f 6465 733d 5472  , color_codes=Tr
+000770b0: 7565 290d 0a69 6d70 6f72 7420 7761 726e  ue)..import warn
+000770c0: 696e 6773 0d0a 7761 726e 696e 6773 2e66  ings..warnings.f
+000770d0: 696c 7465 7277 6172 6e69 6e67 7328 2269  ilterwarnings("i
+000770e0: 676e 6f72 6522 290d 0a66 726f 6d20 736b  gnore")..from sk
+000770f0: 6c65 6172 6e2e 6d6f 6465 6c5f 7365 6c65  learn.model_sele
+00077100: 6374 696f 6e20 696d 706f 7274 2063 726f  ction import cro
+00077110: 7373 5f76 616c 5f73 636f 7265 2c20 5374  ss_val_score, St
+00077120: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
+00077130: 706c 6974 2c20 5469 6d65 5365 7269 6573  plit, TimeSeries
+00077140: 5370 6c69 740d 0a66 726f 6d20 736b 6c65  Split..from skle
+00077150: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
+00077160: 696e 6561 7253 5643 2c20 4c69 6e65 6172  inearSVC, Linear
+00077170: 5356 520d 0a66 726f 6d20 736b 6c65 6172  SVR..from sklear
+00077180: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
+00077190: 6d70 6f72 7420 5347 4452 6567 7265 7373  mport SGDRegress
+000771a0: 6f72 2c20 5347 4443 6c61 7373 6966 6965  or, SGDClassifie
+000771b0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+000771c0: 6d6f 6465 6c5f 7365 6c65 6374 696f 6e20  model_selection 
+000771d0: 696d 706f 7274 2063 726f 7373 5f76 616c  import cross_val
+000771e0: 5f73 636f 7265 2c20 5374 7261 7469 6669  _score, Stratifi
+000771f0: 6564 5368 7566 666c 6553 706c 6974 2c20  edShuffleSplit, 
+00077200: 5469 6d65 5365 7269 6573 5370 6c69 740d  TimeSeriesSplit.
+00077210: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
+00077220: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
+00077230: 706f 7274 2053 6875 6666 6c65 5370 6c69  port ShuffleSpli
+00077240: 742c 5374 7261 7469 6669 6564 4b46 6f6c  t,StratifiedKFol
+00077250: 642c 4b46 6f6c 640d 0a66 726f 6d20 736b  d,KFold..from sk
+00077260: 6c65 6172 6e2e 6469 7363 7269 6d69 6e61  learn.discrimina
+00077270: 6e74 5f61 6e61 6c79 7369 7320 696d 706f  nt_analysis impo
+00077280: 7274 204c 696e 6561 7244 6973 6372 696d  rt LinearDiscrim
+00077290: 696e 616e 7441 6e61 6c79 7369 730d 0a66  inantAnalysis..f
+000772a0: 726f 6d20 736b 6c65 6172 6e2e 656e 7365  rom sklearn.ense
+000772b0: 6d62 6c65 2069 6d70 6f72 7420 4261 6767  mble import Bagg
+000772c0: 696e 6752 6567 7265 7373 6f72 2c20 5261  ingRegressor, Ra
+000772d0: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
+000772e0: 6669 6572 2c20 5261 6e64 6f6d 466f 7265  fier, RandomFore
+000772f0: 7374 5265 6772 6573 736f 720d 0a66 726f  stRegressor..fro
+00077300: 6d20 736b 6c65 6172 6e2e 656e 7365 6d62  m sklearn.ensemb
+00077310: 6c65 2069 6d70 6f72 7420 4578 7472 6154  le import ExtraT
+00077320: 7265 6573 436c 6173 7369 6669 6572 2c45  reesClassifier,E
+00077330: 7874 7261 5472 6565 7352 6567 7265 7373  xtraTreesRegress
+00077340: 6f72 0d0a 6672 6f6d 2073 6b6c 6561 726e  or..from sklearn
+00077350: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
+00077360: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
+00077370: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
+00077380: 7252 6567 7265 7373 696f 6e2c 2052 6964  rRegression, Rid
+00077390: 6765 0d0a 6672 6f6d 2073 6b6c 6561 726e  ge..from sklearn
+000773a0: 2e73 766d 2069 6d70 6f72 7420 4c69 6e65  .svm import Line
+000773b0: 6172 5356 432c 2053 5652 2c20 4c69 6e65  arSVC, SVR, Line
+000773c0: 6172 5356 520d 0a66 726f 6d20 736b 6c65  arSVR..from skle
+000773d0: 6172 6e2e 656e 7365 6d62 6c65 2069 6d70  arn.ensemble imp
+000773e0: 6f72 7420 4164 6142 6f6f 7374 436c 6173  ort AdaBoostClas
+000773f0: 7369 6669 6572 2c20 4164 6142 6f6f 7374  sifier, AdaBoost
+00077400: 5265 6772 6573 736f 720d 0a66 726f 6d20  Regressor..from 
+00077410: 736b 6c65 6172 6e2e 7472 6565 2069 6d70  sklearn.tree imp
+00077420: 6f72 7420 4465 6369 7369 6f6e 5472 6565  ort DecisionTree
+00077430: 5265 6772 6573 736f 722c 2044 6563 6973  Regressor, Decis
+00077440: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
+00077450: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+00077460: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
+00077470: 6f72 7420 4c61 7373 6f2c 204c 6173 736f  ort Lasso, Lasso
+00077480: 4356 2c20 5269 6467 652c 2052 6964 6765  CV, Ridge, Ridge
+00077490: 4356 2c20 4c61 7373 6f4c 6172 7343 560d  CV, LassoLarsCV.
+000774a0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d6f  .from sklearn.mo
+000774b0: 6465 6c5f 7365 6c65 6374 696f 6e20 696d  del_selection im
+000774c0: 706f 7274 2063 726f 7373 5f76 616c 5f70  port cross_val_p
+000774d0: 7265 6469 6374 0d0a 6672 6f6d 2073 6b6c  redict..from skl
+000774e0: 6561 726e 2e65 6e73 656d 626c 6520 696d  earn.ensemble im
+000774f0: 706f 7274 2045 7874 7261 5472 6565 7352  port ExtraTreesR
+00077500: 6567 7265 7373 6f72 2c20 4578 7472 6154  egressor, ExtraT
+00077510: 7265 6573 436c 6173 7369 6669 6572 0d0a  reesClassifier..
+00077520: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
+00077530: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
+00077540: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+00077550: 696f 6e2c 204c 6f67 6973 7469 6352 6567  ion, LogisticReg
+00077560: 7265 7373 696f 6e43 562c 204c 696e 6561  ressionCV, Linea
+00077570: 7252 6567 7265 7373 696f 6e0d 0a66 726f  rRegression..fro
+00077580: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+00077590: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+000775a0: 2047 7269 6453 6561 7263 6843 562c 5374   GridSearchCV,St
+000775b0: 7261 7469 6669 6564 5368 7566 666c 6553  ratifiedShuffleS
+000775c0: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
+000775d0: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
+000775e0: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
+000775f0: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
+00077600: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
+00077610: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
+00077620: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+00077630: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00077640: 756c 7469 636c 6173 7320 696d 706f 7274  ulticlass import
+00077650: 204f 6e65 5673 5265 7374 436c 6173 7369   OneVsRestClassi
+00077660: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
+00077670: 726e 2e6e 6569 6768 626f 7273 2069 6d70  rn.neighbors imp
+00077680: 6f72 7420 4b4e 6569 6768 626f 7273 5265  ort KNeighborsRe
+00077690: 6772 6573 736f 720d 0a69 6d70 6f72 7420  gressor..import 
+000776a0: 7469 6d65 0d0a 696d 706f 7274 2070 6462  time..import pdb
+000776b0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
+000776c0: 6d70 6f72 7420 636f 7079 0d0a 696d 706f  mport copy..impo
+000776d0: 7274 206f 7065 7261 746f 720d 0a23 2323  rt operator..###
+000776e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000776f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00077700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00077710: 2323 2323 2323 0d0a 6465 6620 5175 6963  ######..def Quic
+00077720: 6b4d 4c5f 456e 7365 6d62 6c69 6e67 2858  kML_Ensembling(X
+00077730: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
+00077740: 2058 5f74 6573 742c 2079 5f74 6573 743d   X_test, y_test=
+00077750: 2727 2c20 6d6f 6465 6c74 7970 653d 2752  '', modeltype='R
+00077760: 6567 7265 7373 696f 6e27 2c0d 0a20 2020  egression',..   
+00077770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077780: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00077790: 673d 4661 6c73 652c 0d0a 2020 2020 2020  g=False,..      
+000777a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000777b0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
+000777c0: 626f 7365 3d30 293a 0d0a 2020 2020 2222  bose=0):..    ""
+000777d0: 220d 0a20 2020 2051 7569 636b 6c79 2062  "..    Quickly b
+000777e0: 7569 6c64 7320 616e 6420 7275 6e73 206d  uilds and runs m
+000777f0: 756c 7469 706c 6520 6d6f 6465 6c73 2066  ultiple models f
+00077800: 6f72 2061 2063 6c65 616e 2064 6174 6120  or a clean data 
+00077810: 7365 7428 6f6e 6c79 206e 756d 6572 6963  set(only numeric
+00077820: 7329 2e0d 0a20 2020 2022 2222 0d0a 2020  s)...    """..  
+00077830: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
+00077840: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
+00077850: 7365 6564 203d 2039 390d 0a20 2020 2046  seed = 99..    F
+00077860: 4f4c 4453 203d 2035 0d0a 2020 2020 6d6f  OLDS = 5..    mo
+00077870: 6465 6c5f 6469 6374 203d 207b 7d0d 0a20  del_dict = {}.. 
+00077880: 2020 206d 6f64 656c 5f74 7570 6c65 7320     model_tuples 
+00077890: 3d20 5b5d 0d0a 2020 2020 6966 206c 656e  = []..    if len
+000778a0: 2858 5f74 7261 696e 2920 3c3d 2031 3030  (X_train) <= 100
+000778b0: 3030 3020 616e 6420 585f 7472 6169 6e2e  000 and X_train.
+000778c0: 7368 6170 655b 315d 203c 2035 303a 0d0a  shape[1] < 50:..
+000778d0: 2020 2020 2020 2020 4e55 4d53 203d 2031          NUMS = 1
+000778e0: 3030 0d0a 2020 2020 656c 7365 3a0d 0a20  00..    else:.. 
+000778f0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00077900: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
+00077910: 203d 2058 5f74 7261 696e 2e73 616d 706c   = X_train.sampl
+00077920: 6528 6672 6163 3d30 2e33 302c 7261 6e64  e(frac=0.30,rand
+00077930: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+00077940: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
+00077950: 6e20 3d20 795f 7472 6169 6e5b 585f 7472  n = y_train[X_tr
+00077960: 6169 6e2e 696e 6465 785d 0d0a 2020 2020  ain.index]..    
+00077970: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00077980: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00077990: 2020 2020 2020 204e 554d 5320 3d20 3230         NUMS = 20
+000779a0: 300d 0a20 2020 2023 2323 2323 2320 5468  0..    ###### Th
+000779b0: 6973 2069 7320 7768 6572 6520 7765 2073  is is where we s
+000779c0: 7461 7274 2070 6572 666f 726d 696e 6720  tart performing 
+000779d0: 656e 7365 6d62 6c69 6e67 206f 6620 6d75  ensembling of mu
+000779e0: 6c74 6970 6c65 2073 696d 706c 6572 206d  ltiple simpler m
+000779f0: 6f64 656c 7320 2323 230d 0a20 2020 2069  odels ###..    i
+00077a00: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+00077a10: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+00077a20: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
+00077a30: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
+00077a40: 2020 2020 2073 636f 7269 6e67 203d 2027       scoring = '
+00077a50: 6e65 675f 6d65 616e 5f73 7175 6172 6564  neg_mean_squared
+00077a60: 5f65 7272 6f72 270d 0a20 2020 2020 2020  _error'..       
+00077a70: 2023 7363 7620 3d20 5368 7566 666c 6553   #scv = ShuffleS
+00077a80: 706c 6974 286e 5f73 706c 6974 733d 464f  plit(n_splits=FO
+00077a90: 4c44 532c 7261 6e64 6f6d 5f73 7461 7465  LDS,random_state
+00077aa0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
+00077ab0: 7363 7620 3d20 4b46 6f6c 6428 6e5f 7370  scv = KFold(n_sp
+00077ac0: 6c69 7473 3d46 4f4c 4453 2c20 7368 7566  lits=FOLDS, shuf
+00077ad0: 666c 653d 4661 6c73 6529 0d0a 2020 2020  fle=False)..    
+00077ae0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+00077af0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+00077b00: 2020 2020 2020 2020 2020 2023 2320 4372             ## Cr
+00077b10: 6561 7465 2061 6e20 656e 7365 6d62 6c65  eate an ensemble
+00077b20: 206d 6f64 656c 2023 2323 230d 0a20 2020   model ####..   
+00077b30: 2020 2020 2020 2020 206d 6f64 656c 3520           model5 
+00077b40: 3d20 4164 6142 6f6f 7374 5265 6772 6573  = AdaBoostRegres
+00077b50: 736f 7228 6261 7365 5f65 7374 696d 6174  sor(base_estimat
+00077b60: 6f72 3d44 6563 6973 696f 6e54 7265 6552  or=DecisionTreeR
+00077b70: 6567 7265 7373 6f72 280d 0a20 2020 2020  egressor(..     
+00077b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077b90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00077ba0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+00077bb0: 2c20 6d61 785f 6465 7074 683d 312c 206d  , max_depth=1, m
+00077bc0: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
+00077bd0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
+00077be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077bf0: 2020 2020 2020 2029 2c20 6e5f 6573 7469         ), n_esti
+00077c00: 6d61 746f 7273 3d4e 554d 532c 2072 616e  mators=NUMS, ran
+00077c10: 646f 6d5f 7374 6174 653d 7365 6564 290d  dom_state=seed).
+00077c20: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00077c30: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
+00077c40: 2828 2741 6461 626f 6f73 7427 2c6d 6f64  (('Adaboost',mod
+00077c50: 656c 3529 290d 0a20 2020 2020 2020 2065  el5))..        e
+00077c60: 6c69 6620 6e6f 7420 426f 6f73 7469 6e67  lif not Boosting
+00077c70: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
+00077c80: 2020 2020 6d6f 6465 6c35 203d 204c 6173      model5 = Las
+00077c90: 736f 4c61 7273 4356 2863 763d 7363 7629  soLarsCV(cv=scv)
+00077ca0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
+00077cb0: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
+00077cc0: 6428 2827 4c61 7373 6f4c 6172 7343 5627  d(('LassoLarsCV'
+00077cd0: 2c6d 6f64 656c 3529 290d 0a20 2020 2020  ,model5))..     
+00077ce0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00077cf0: 2020 2020 2020 6d6f 6465 6c35 203d 204c        model5 = L
+00077d00: 6173 736f 4c61 7273 4356 2863 763d 7363  assoLarsCV(cv=sc
+00077d10: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
+00077d20: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+00077d30: 656e 6428 2827 4c61 7373 6f4c 6172 7343  end(('LassoLarsC
+00077d40: 5627 2c6d 6f64 656c 3529 290d 0a20 2020  V',model5))..   
+00077d50: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
+00077d60: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
+00077d70: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00077d80: 6c36 203d 2042 6167 6769 6e67 5265 6772  l6 = BaggingRegr
+00077d90: 6573 736f 7228 4465 6369 7369 6f6e 5472  essor(DecisionTr
+00077da0: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
+00077db0: 6f6d 5f73 7461 7465 3d73 6565 6429 2c0d  om_state=seed),.
+00077dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00077dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077de0: 2020 2020 2020 2020 2020 2020 206e 5f65               n_e
+00077df0: 7374 696d 6174 6f72 733d 4e55 4d53 2c72  stimators=NUMS,r
+00077e00: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+00077e10: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
+00077e20: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+00077e30: 6e64 2828 2742 6167 6769 6e67 5f52 6567  nd(('Bagging_Reg
+00077e40: 7265 7373 6f72 272c 6d6f 6465 6c36 2929  ressor',model6))
+00077e50: 0d0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
+00077e60: 6f74 2042 6f6f 7374 696e 675f 466c 6167  ot Boosting_Flag
+00077e70: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
+00077e80: 6f64 656c 3620 3d20 4c69 6e65 6172 5356  odel6 = LinearSV
+00077e90: 5228 290d 0a20 2020 2020 2020 2020 2020  R()..           
+00077ea0: 206d 6f64 656c 5f74 7570 6c65 732e 6170   model_tuples.ap
+00077eb0: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
+00077ec0: 5227 2c6d 6f64 656c 3629 290d 0a20 2020  R',model6))..   
+00077ed0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00077ee0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+00077ef0: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
+00077f00: 7265 7373 6f72 286d 6178 5f64 6570 7468  ressor(max_depth
+00077f10: 3d35 2c6d 696e 5f73 616d 706c 6573 5f6c  =5,min_samples_l
+00077f20: 6561 663d 3229 0d0a 2020 2020 2020 2020  eaf=2)..        
+00077f30: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
+00077f40: 2e61 7070 656e 6428 2827 4465 6369 7369  .append(('Decisi
+00077f50: 6f6e 5f54 7265 6527 2c6d 6f64 656c 3629  on_Tree',model6)
+00077f60: 290d 0a20 2020 2020 2020 206d 6f64 656c  )..        model
+00077f70: 3720 3d20 4b4e 6569 6768 626f 7273 5265  7 = KNeighborsRe
+00077f80: 6772 6573 736f 7228 6e5f 6e65 6967 6862  gressor(n_neighb
+00077f90: 6f72 733d 3829 0d0a 2020 2020 2020 2020  ors=8)..        
+00077fa0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+00077fb0: 656e 6428 2827 4b4e 4e5f 5265 6772 6573  end(('KNN_Regres
+00077fc0: 736f 7227 2c6d 6f64 656c 3729 290d 0a20  sor',model7)).. 
+00077fd0: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
+00077fe0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
+00077ff0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00078000: 2323 2049 6620 7468 6520 426f 6f73 7469  ## If the Boosti
+00078010: 6e67 5f46 6c61 6720 6973 2054 7275 652c  ng_Flag is True,
+00078020: 2069 7420 6d65 616e 7320 426f 6f73 7469   it means Boosti
+00078030: 6e67 206d 6f64 656c 2069 7320 7072 6573  ng model is pres
+00078040: 656e 742e 0d0a 2020 2020 2020 2020 2020  ent...          
+00078050: 2020 2323 2320 2020 536f 2063 686f 6f73    ###   So choos
+00078060: 6520 6120 6469 6666 6572 656e 7420 6b69  e a different ki
+00078070: 6e64 206f 6620 636c 6173 7369 6669 6572  nd of classifier
+00078080: 2068 6572 650d 0a20 2020 2020 2020 2020   here..         
+00078090: 2020 206d 6f64 656c 3820 3d20 4465 6369     model8 = Deci
+000780a0: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
+000780b0: 7228 6d61 785f 6465 7074 683d 352c 6d69  r(max_depth=5,mi
+000780c0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+000780d0: 290d 0a20 2020 2020 2020 2020 2020 206d  )..            m
+000780e0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+000780f0: 6e64 2828 2744 6563 6973 696f 6e5f 5472  nd(('Decision_Tr
+00078100: 6565 272c 6d6f 6465 6c38 2929 0d0a 2020  ee',model8))..  
+00078110: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
+00078120: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00078130: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00078140: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00078150: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+00078160: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+00078170: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+00078180: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00078190: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+000781a0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+000781b0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+000781c0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+000781d0: 6d6f 6465 6c38 203d 2041 6461 426f 6f73  model8 = AdaBoos
+000781e0: 7452 6567 7265 7373 6f72 2862 6173 655f  tRegressor(base_
+000781f0: 6573 7469 6d61 746f 723d 4465 6369 7369  estimator=Decisi
+00078200: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
+00078210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00078220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078230: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00078240: 7465 3d73 6565 642c 206d 6178 5f64 6570  te=seed, max_dep
+00078250: 7468 3d31 2c20 6d69 6e5f 7361 6d70 6c65  th=1, min_sample
+00078260: 735f 6c65 6166 3d32 0d0a 2020 2020 2020  s_leaf=2..      
+00078270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078280: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00078290: 206e 5f65 7374 696d 6174 6f72 733d 4e55   n_estimators=NU
+000782a0: 4d53 2c20 7261 6e64 6f6d 5f73 7461 7465  MS, random_state
+000782b0: 3d73 6565 6429 0d0a 2020 2020 2020 2020  =seed)..        
+000782c0: 2020 2020 6d6f 6465 6c5f 7475 706c 6573      model_tuples
+000782d0: 2e61 7070 656e 6428 2827 4164 6162 6f6f  .append(('Adaboo
+000782e0: 7374 272c 6d6f 6465 6c38 2929 0d0a 2020  st',model8))..  
+000782f0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00078300: 2020 2020 2020 2020 206d 6f64 656c 3820           model8 
+00078310: 3d20 5261 6e64 6f6d 466f 7265 7374 5265  = RandomForestRe
+00078320: 6772 6573 736f 7228 626f 6f74 7374 7261  gressor(bootstra
+00078330: 7020 3d20 4661 6c73 652c 0d0a 2020 2020  p = False,..    
+00078340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078360: 2020 206d 6178 5f64 6570 7468 203d 2031     max_depth = 1
+00078370: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00078380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078390: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
+000783a0: 6561 7475 7265 7320 3d20 2761 7574 6f27  eatures = 'auto'
+000783b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000783c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000783d0: 2020 2020 2020 2020 2020 6d69 6e5f 7361            min_sa
+000783e0: 6d70 6c65 735f 6c65 6166 203d 2032 2c0d  mples_leaf = 2,.
+000783f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00078400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078410: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
+00078420: 746f 7273 203d 2032 3030 2c0d 0a20 2020  tors = 200,..   
+00078430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078450: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00078460: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
+00078470: 2020 6d6f 6465 6c5f 7475 706c 6573 2e61    model_tuples.a
+00078480: 7070 656e 6428 2827 5246 5f52 6567 7265  ppend(('RF_Regre
+00078490: 7373 6f72 272c 6d6f 6465 6c38 2929 0d0a  ssor',model8))..
+000784a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000784b0: 2020 2069 6620 7363 6f72 696e 6720 3d3d     if scoring ==
+000784c0: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
+000784d0: 2020 7363 6f72 696e 6720 3d20 2761 6363    scoring = 'acc
+000784e0: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
+000784f0: 6e75 6d5f 636c 6173 7365 7320 3d20 6c65  num_classes = le
+00078500: 6e28 6e70 2e75 6e69 7175 6528 795f 7465  n(np.unique(y_te
+00078510: 7374 2929 0d0a 2020 2020 2020 2020 7363  st))..        sc
+00078520: 7620 3d20 5374 7261 7469 6669 6564 4b46  v = StratifiedKF
+00078530: 6f6c 6428 6e5f 7370 6c69 7473 3d46 4f4c  old(n_splits=FOL
+00078540: 4453 2c20 7368 7566 666c 653d 5472 7565  DS, shuffle=True
+00078550: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
+00078560: 6565 6429 0d0a 2020 2020 2020 2020 6966  eed)..        if
+00078570: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
+00078580: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00078590: 2020 2020 2023 2320 4372 6561 7465 2061       ## Create a
+000785a0: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
+000785b0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
+000785c0: 2020 206d 6f64 656c 3520 3d20 4164 6142     model5 = AdaB
+000785d0: 6f6f 7374 436c 6173 7369 6669 6572 2862  oostClassifier(b
+000785e0: 6173 655f 6573 7469 6d61 746f 723d 4465  ase_estimator=De
+000785f0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
+00078600: 6669 6572 280d 0a20 2020 2020 2020 2020  fier(..         
+00078610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078620: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00078630: 6d5f 7374 6174 653d 7365 6564 2c20 6d61  m_state=seed, ma
+00078640: 785f 6465 7074 683d 312c 206d 696e 5f73  x_depth=1, min_s
+00078650: 616d 706c 6573 5f6c 6561 663d 320d 0a20  amples_leaf=2.. 
 00078660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00078670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078680: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
-00078690: 6166 203d 2032 2c0d 0a20 2020 2020 2020  af = 2,..       
-000786a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000786b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000786c0: 6e5f 6573 7469 6d61 746f 7273 203d 2032  n_estimators = 2
-000786d0: 3030 2c0d 0a20 2020 2020 2020 2020 2020  00,..           
-000786e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000786f0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-00078700: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
-00078710: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-00078720: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
-00078730: 4261 6767 696e 675f 436c 6173 7369 6669  Bagging_Classifi
-00078740: 6572 272c 6d6f 6465 6c38 2929 0d0a 2020  er',model8))..  
-00078750: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
-00078760: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-00078770: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00078780: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
-00078790: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
-000787a0: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
-000787b0: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
-000787c0: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-000787d0: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
-000787e0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
-000787f0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
-00078800: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00078810: 7367 645f 6265 7374 5f6d 6f64 656c 203d  sgd_best_model =
-00078820: 2053 4744 436c 6173 7369 6669 6572 2861   SGDClassifier(a
-00078830: 6c70 6861 3d31 652d 3036 2c0d 0a20 2020  lpha=1e-06,..   
-00078840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078850: 2020 2020 2020 2020 2020 2020 206c 6f73               los
-00078860: 733d 276c 6f67 272c 0d0a 2020 2020 2020  s='log',..      
-00078870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078880: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
-00078890: 723d 3130 3030 2c0d 0a20 2020 2020 2020  r=1000,..       
-000788a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000788b0: 2020 2020 2020 2020 7065 6e61 6c74 793d          penalty=
-000788c0: 276c 3227 2c0d 0a20 2020 2020 2020 2020  'l2',..         
-000788d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000788e0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
-000788f0: 6174 6520 3d20 2763 6f6e 7374 616e 7427  ate = 'constant'
-00078900: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00078910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078920: 2020 6574 6130 203d 202e 312c 0d0a 2020    eta0 = .1,..  
-00078930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078940: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-00078950: 646f 6d5f 7374 6174 6520 3d20 332c 0d0a  dom_state = 3,..
-00078960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078970: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00078980: 6f6c 3d4e 6f6e 6529 0d0a 2020 2020 2020  ol=None)..      
-00078990: 2020 2020 2020 6d6f 6465 6c38 203d 204f        model8 = O
-000789a0: 6e65 5673 5265 7374 436c 6173 7369 6669  neVsRestClassifi
-000789b0: 6572 2873 6764 5f62 6573 745f 6d6f 6465  er(sgd_best_mode
-000789c0: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-000789d0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
-000789e0: 656e 6428 2827 4f6e 655f 7673 5f52 6573  end(('One_vs_Res
-000789f0: 745f 436c 6173 7369 6669 6572 272c 6d6f  t_Classifier',mo
-00078a00: 6465 6c38 2929 0d0a 2020 2020 2020 2020  del8))..        
-00078a10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00078a20: 2020 206d 6f64 656c 3820 3d20 5261 6e64     model8 = Rand
-00078a30: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
-00078a40: 6572 2862 6f6f 7473 7472 6170 203d 2046  er(bootstrap = F
-00078a50: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
-00078a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078a70: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-00078a80: 785f 6465 7074 6820 3d20 3130 2c0d 0a20  x_depth = 10,.. 
-00078a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078ab0: 2020 2020 2020 6d61 785f 6665 6174 7572        max_featur
-00078ac0: 6573 203d 2027 6175 746f 272c 0d0a 2020  es = 'auto',..  
-00078ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078af0: 2020 2020 206d 696e 5f73 616d 706c 6573       min_samples
-00078b00: 5f6c 6561 6620 3d20 322c 0d0a 2020 2020  _leaf = 2,..    
-00078b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078b30: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
-00078b40: 3d20 3230 302c 0d0a 2020 2020 2020 2020  = 200,..        
-00078b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078b60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00078b70: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
-00078b80: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00078b90: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
-00078ba0: 2828 2742 6167 6769 6e67 5f43 6c61 7373  (('Bagging_Class
-00078bb0: 6966 6965 7227 2c6d 6f64 656c 3829 290d  ifier',model8)).
-00078bc0: 0a20 2020 206d 6f64 656c 5f64 6963 7420  .    model_dict 
-00078bd0: 3d20 6469 6374 286d 6f64 656c 5f74 7570  = dict(model_tup
-00078be0: 6c65 7329 0d0a 2020 2020 6d6f 6465 6c73  les)..    models
-00078bf0: 2c20 7265 7375 6c74 7320 3d20 7275 6e5f  , results = run_
-00078c00: 656e 7365 6d62 6c65 5f6d 6f64 656c 7328  ensemble_models(
-00078c10: 6d6f 6465 6c5f 6469 6374 2c20 585f 7472  model_dict, X_tr
-00078c20: 6169 6e2c 2079 5f74 7261 696e 2c20 585f  ain, y_train, X_
-00078c30: 7465 7374 2c20 795f 7465 7374 2c0d 0a20  test, y_test,.. 
-00078c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078c60: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
-00078c70: 2c20 6d6f 6465 6c74 7970 6529 0d0a 2020  , modeltype)..  
-00078c80: 2020 7265 7475 726e 206d 6f64 656c 732c    return models,
-00078c90: 2072 6573 756c 7473 0d0a 2323 2323 2323   results..######
-00078ca0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00078cb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00078cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00078cd0: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
-00078ce0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
-00078cf0: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
-00078d00: 6379 5f73 636f 7265 2c61 6363 7572 6163  cy_score,accurac
-00078d10: 795f 7363 6f72 652c 7072 6563 6973 696f  y_score,precisio
-00078d20: 6e5f 7363 6f72 652c 7265 6361 6c6c 5f73  n_score,recall_s
-00078d30: 636f 7265 2c66 315f 7363 6f72 650d 0a66  core,f1_score..f
-00078d40: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00078d50: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
-00078d60: 6162 736f 6c75 7465 5f65 7272 6f72 2c20  absolute_error, 
-00078d70: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-00078d80: 6f72 0d0a 696d 706f 7274 2063 6f70 790d  or..import copy.
-00078d90: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
-00078da0: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
-00078db0: 7420 4c69 6e65 6172 5265 6772 6573 7369  t LinearRegressi
-00078dc0: 6f6e 0d0a 6672 6f6d 2073 6b6c 6561 726e  on..from sklearn
-00078dd0: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
-00078de0: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
-00078df0: 7265 7373 696f 6e0d 0a64 6566 2072 756e  ression..def run
-00078e00: 5f65 6e73 656d 626c 655f 6d6f 6465 6c73  _ensemble_models
-00078e10: 286d 6f64 656c 5f64 6963 742c 2058 5f74  (model_dict, X_t
-00078e20: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
-00078e30: 5f74 6573 742c 2079 5f74 6573 742c 2073  _test, y_test, s
-00078e40: 636f 7269 6e67 2c20 6d6f 6465 6c74 7970  coring, modeltyp
-00078e50: 6529 3a0d 0a20 2020 2073 7461 7274 5f74  e):..    start_t
-00078e60: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
-00078e70: 290d 0a20 2020 206d 6f64 656c 5f6e 616d  )..    model_nam
-00078e80: 652c 2020 6261 635f 7363 6f72 655f 6c69  e,  bac_score_li
-00078e90: 7374 2c20 6163 5f73 636f 7265 5f6c 6973  st, ac_score_lis
-00078ea0: 742c 2070 5f73 636f 7265 5f6c 6973 742c  t, p_score_list,
-00078eb0: 2072 5f73 636f 7265 5f6c 6973 742c 2066   r_score_list, f
-00078ec0: 315f 7363 6f72 655f 6c69 7374 203d 205b  1_score_list = [
-00078ed0: 5d2c 205b 5d2c 205b 5d2c 205b 5d2c 205b  ], [], [], [], [
-00078ee0: 5d2c 205b 5d0d 0a20 2020 2069 7465 7261  ], []..    itera
-00078ef0: 7469 6f6e 203d 2030 0d0a 2020 2020 6573  tion = 0..    es
-00078f00: 7469 6d61 746f 7273 203d 205b 5d0d 0a20  timators = [].. 
-00078f10: 2020 2065 7374 696d 5f74 7570 6c65 7320     estim_tuples 
-00078f20: 3d20 5b5d 0d0a 2020 2020 666f 7220 6b65  = []..    for ke
-00078f30: 792c 7661 6c20 696e 206d 6f64 656c 5f64  y,val in model_d
-00078f40: 6963 742e 6974 656d 7328 293a 0d0a 2020  ict.items():..  
-00078f50: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
-00078f60: 6e61 6d65 203d 206b 6579 0d0a 2020 2020  name = key..    
-00078f70: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2e61      model_name.a
-00078f80: 7070 656e 6428 6b65 7929 0d0a 2020 2020  ppend(key)..    
-00078f90: 2020 2020 6966 2073 7472 2876 616c 292e      if str(val).
-00078fa0: 7370 6c69 7428 2228 2229 5b30 5d20 3d3d  split("(")[0] ==
-00078fb0: 2027 4d75 6c74 696e 6f6d 6961 6c4e 4227   'MultinomialNB'
-00078fc0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00078fd0: 2323 2320 4d75 6c74 696e 6f6d 6961 6c20  ### Multinomial 
-00078fe0: 6d6f 6465 6c73 206e 6565 6420 6f6e 6c79  models need only
-00078ff0: 2070 6f73 6974 6976 6520 7661 6c75 6573   positive values
-00079000: 2121 0d0a 2020 2020 2020 2020 2020 2020  !!..            
-00079010: 7661 6c2e 6669 7428 6162 7328 585f 7472  val.fit(abs(X_tr
-00079020: 6169 6e29 2c20 795f 7472 6169 6e29 0d0a  ain), y_train)..
-00079030: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00079040: 6564 203d 2076 616c 2e70 7265 6469 6374  ed = val.predict
-00079050: 2861 6273 2858 5f74 6573 7429 290d 0a20  (abs(X_test)).. 
-00079060: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00079070: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00079080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079090: 7661 6c2e 6669 7428 585f 7472 6169 6e2c  val.fit(X_train,
-000790a0: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
-000790b0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
-000790c0: 6420 3d20 7661 6c2e 7072 6564 6963 7428  d = val.predict(
-000790d0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-000790e0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-000790f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00079100: 206d 6f64 656c 7479 7065 2021 3d20 2752   modeltype != 'R
-00079110: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00078680: 2020 2029 2c20 6e5f 6573 7469 6d61 746f     ), n_estimato
+00078690: 7273 3d4e 554d 532c 2072 616e 646f 6d5f  rs=NUMS, random_
+000786a0: 7374 6174 653d 7365 6564 290d 0a20 2020  state=seed)..   
+000786b0: 2020 2020 2020 2020 206d 6f64 656c 5f74           model_t
+000786c0: 7570 6c65 732e 6170 7065 6e64 2828 2741  uples.append(('A
+000786d0: 6461 626f 6f73 7427 2c6d 6f64 656c 3529  daboost',model5)
+000786e0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+000786f0: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
+00078700: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00078710: 6d6f 6465 6c35 203d 204c 696e 6561 7244  model5 = LinearD
+00078720: 6973 6372 696d 696e 616e 7441 6e61 6c79  iscriminantAnaly
+00078730: 7369 7328 290d 0a20 2020 2020 2020 2020  sis()..         
+00078740: 2020 206d 6f64 656c 5f74 7570 6c65 732e     model_tuples.
+00078750: 6170 7065 6e64 2828 274c 696e 6561 725f  append(('Linear_
+00078760: 4469 7363 7269 6d69 6e61 6e74 272c 6d6f  Discriminant',mo
+00078770: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
+00078780: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00078790: 2020 206d 6f64 656c 3520 3d20 4c6f 6769     model5 = Logi
+000787a0: 7374 6963 5265 6772 6573 7369 6f6e 4356  sticRegressionCV
+000787b0: 2843 733d 5b30 2e30 3031 2c30 2e30 312c  (Cs=[0.001,0.01,
+000787c0: 302e 312c 312c 3130 2c31 3030 5d2c 2074  0.1,1,10,100], t
+000787d0: 6f6c 3d30 2e30 312c 0d0a 2020 2020 2020  ol=0.01,..      
+000787e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000787f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078800: 2020 2020 736f 6c76 6572 3d27 6c69 626c      solver='libl
+00078810: 696e 6561 7227 2c20 7261 6e64 6f6d 5f73  inear', random_s
+00078820: 7461 7465 3d73 6565 6429 0d0a 2020 2020  tate=seed)..    
+00078830: 2020 2020 2020 2020 6d6f 6465 6c5f 7475          model_tu
+00078840: 706c 6573 2e61 7070 656e 6428 2827 4c6f  ples.append(('Lo
+00078850: 6769 7374 6963 5f52 6567 7265 7373 696f  gistic_Regressio
+00078860: 6e5f 4356 272c 6d6f 6465 6c35 2929 0d0a  n_CV',model5))..
+00078870: 2020 2020 2020 2020 6966 2042 6f6f 7374          if Boost
+00078880: 696e 675f 466c 6167 2069 7320 4e6f 6e65  ing_Flag is None
+00078890: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
+000788a0: 6f64 656c 3620 3d20 4465 6369 7369 6f6e  odel6 = Decision
+000788b0: 5472 6565 436c 6173 7369 6669 6572 286d  TreeClassifier(m
+000788c0: 6178 5f64 6570 7468 3d35 2c6d 696e 5f73  ax_depth=5,min_s
+000788d0: 616d 706c 6573 5f6c 6561 663d 3229 0d0a  amples_leaf=2)..
+000788e0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000788f0: 6c5f 7475 706c 6573 2e61 7070 656e 6428  l_tuples.append(
+00078900: 2827 4465 6369 7369 6f6e 5f54 7265 6527  ('Decision_Tree'
+00078910: 2c6d 6f64 656c 3629 290d 0a20 2020 2020  ,model6))..     
+00078920: 2020 2065 6c69 6620 6e6f 7420 426f 6f73     elif not Boos
+00078930: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
+00078940: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+00078950: 204c 696e 6561 7253 5643 2829 0d0a 2020   LinearSVC()..  
+00078960: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00078970: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
+00078980: 4c69 6e65 6172 5f53 5643 272c 6d6f 6465  Linear_SVC',mode
+00078990: 6c36 2929 0d0a 2020 2020 2020 2020 656c  l6))..        el
+000789a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000789b0: 206d 6f64 656c 3620 3d20 4465 6369 7369   model6 = Decisi
+000789c0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+000789d0: 286d 6178 5f64 6570 7468 3d35 2c6d 696e  (max_depth=5,min
+000789e0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+000789f0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
+00078a00: 6465 6c5f 7475 706c 6573 2e61 7070 656e  del_tuples.appen
+00078a10: 6428 2827 4465 6369 7369 6f6e 5f54 7265  d(('Decision_Tre
+00078a20: 6527 2c6d 6f64 656c 3629 290d 0a20 2020  e',model6))..   
+00078a30: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
+00078a40: 6520 3d3d 2027 4269 6e61 7279 5f43 6c61  e == 'Binary_Cla
+00078a50: 7373 6966 6963 6174 696f 6e27 3a0d 0a20  ssification':.. 
+00078a60: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00078a70: 3720 3d20 4761 7573 7369 616e 4e42 2829  7 = GaussianNB()
+00078a80: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00078a90: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00078aa0: 656c 3720 3d20 4d75 6c74 696e 6f6d 6961  el7 = Multinomia
+00078ab0: 6c4e 4228 290d 0a20 2020 2020 2020 206d  lNB()..        m
+00078ac0: 6f64 656c 5f74 7570 6c65 732e 6170 7065  odel_tuples.appe
+00078ad0: 6e64 2828 274e 6169 7665 5f42 6179 6573  nd(('Naive_Bayes
+00078ae0: 272c 6d6f 6465 6c37 2929 0d0a 2020 2020  ',model7))..    
+00078af0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+00078b00: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+00078b10: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00078b20: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00078b30: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+00078b40: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+00078b50: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+00078b60: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00078b70: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+00078b80: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+00078b90: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+00078ba0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00078bb0: 6d6f 6465 6c38 203d 2052 616e 646f 6d46  model8 = RandomF
+00078bc0: 6f72 6573 7443 6c61 7373 6966 6965 7228  orestClassifier(
+00078bd0: 626f 6f74 7374 7261 7020 3d20 4661 6c73  bootstrap = Fals
+00078be0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00078bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c00: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
+00078c10: 6570 7468 203d 2031 302c 0d0a 2020 2020  epth = 10,..    
+00078c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c40: 2020 206d 6178 5f66 6561 7475 7265 7320     max_features 
+00078c50: 3d20 2761 7574 6f27 2c0d 0a20 2020 2020  = 'auto',..     
+00078c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078c80: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
+00078c90: 6166 203d 2032 2c0d 0a20 2020 2020 2020  af = 2,..       
+00078ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078cc0: 6e5f 6573 7469 6d61 746f 7273 203d 2032  n_estimators = 2
+00078cd0: 3030 2c0d 0a20 2020 2020 2020 2020 2020  00,..           
+00078ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078cf0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+00078d00: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+00078d10: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00078d20: 7475 706c 6573 2e61 7070 656e 6428 2827  tuples.append(('
+00078d30: 4261 6767 696e 675f 436c 6173 7369 6669  Bagging_Classifi
+00078d40: 6572 272c 6d6f 6465 6c38 2929 0d0a 2020  er',model8))..  
+00078d50: 2020 2020 2020 656c 6966 206e 6f74 2042        elif not B
+00078d60: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
+00078d70: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00078d80: 4966 2074 6865 2042 6f6f 7374 696e 675f  If the Boosting_
+00078d90: 466c 6167 2069 7320 5472 7565 2c20 6974  Flag is True, it
+00078da0: 206d 6561 6e73 2042 6f6f 7374 696e 6720   means Boosting 
+00078db0: 6d6f 6465 6c20 6973 2070 7265 7365 6e74  model is present
+00078dc0: 2e0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00078dd0: 2323 2020 2053 6f20 6368 6f6f 7365 2061  ##   So choose a
+00078de0: 2064 6966 6665 7265 6e74 206b 696e 6420   different kind 
+00078df0: 6f66 2063 6c61 7373 6966 6965 7220 6865  of classifier he
+00078e00: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00078e10: 7367 645f 6265 7374 5f6d 6f64 656c 203d  sgd_best_model =
+00078e20: 2053 4744 436c 6173 7369 6669 6572 2861   SGDClassifier(a
+00078e30: 6c70 6861 3d31 652d 3036 2c0d 0a20 2020  lpha=1e-06,..   
+00078e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078e50: 2020 2020 2020 2020 2020 2020 206c 6f73               los
+00078e60: 733d 276c 6f67 272c 0d0a 2020 2020 2020  s='log',..      
+00078e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078e80: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
+00078e90: 723d 3130 3030 2c0d 0a20 2020 2020 2020  r=1000,..       
+00078ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078eb0: 2020 2020 2020 2020 7065 6e61 6c74 793d          penalty=
+00078ec0: 276c 3227 2c0d 0a20 2020 2020 2020 2020  'l2',..         
+00078ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078ee0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
+00078ef0: 6174 6520 3d20 2763 6f6e 7374 616e 7427  ate = 'constant'
+00078f00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00078f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078f20: 2020 6574 6130 203d 202e 312c 0d0a 2020    eta0 = .1,..  
+00078f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078f40: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+00078f50: 646f 6d5f 7374 6174 6520 3d20 332c 0d0a  dom_state = 3,..
+00078f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078f70: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00078f80: 6f6c 3d4e 6f6e 6529 0d0a 2020 2020 2020  ol=None)..      
+00078f90: 2020 2020 2020 6d6f 6465 6c38 203d 204f        model8 = O
+00078fa0: 6e65 5673 5265 7374 436c 6173 7369 6669  neVsRestClassifi
+00078fb0: 6572 2873 6764 5f62 6573 745f 6d6f 6465  er(sgd_best_mode
+00078fc0: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+00078fd0: 6d6f 6465 6c5f 7475 706c 6573 2e61 7070  model_tuples.app
+00078fe0: 656e 6428 2827 4f6e 655f 7673 5f52 6573  end(('One_vs_Res
+00078ff0: 745f 436c 6173 7369 6669 6572 272c 6d6f  t_Classifier',mo
+00079000: 6465 6c38 2929 0d0a 2020 2020 2020 2020  del8))..        
+00079010: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00079020: 2020 206d 6f64 656c 3820 3d20 5261 6e64     model8 = Rand
+00079030: 6f6d 466f 7265 7374 436c 6173 7369 6669  omForestClassifi
+00079040: 6572 2862 6f6f 7473 7472 6170 203d 2046  er(bootstrap = F
+00079050: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
+00079060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079070: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00079080: 785f 6465 7074 6820 3d20 3130 2c0d 0a20  x_depth = 10,.. 
+00079090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000790a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000790b0: 2020 2020 2020 6d61 785f 6665 6174 7572        max_featur
+000790c0: 6573 203d 2027 6175 746f 272c 0d0a 2020  es = 'auto',..  
+000790d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000790e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000790f0: 2020 2020 206d 696e 5f73 616d 706c 6573       min_samples
+00079100: 5f6c 6561 6620 3d20 322c 0d0a 2020 2020  _leaf = 2,..    
+00079110: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00079120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079130: 206b 6579 203d 2027 4c6f 6769 7374 6963   key = 'Logistic
-00079140: 5f52 6567 7265 7373 696f 6e27 0d0a 2020  _Regression'..  
+00079130: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
+00079140: 3d20 3230 302c 0d0a 2020 2020 2020 2020  = 200,..        
 00079150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079160: 2020 7661 6c20 3d20 4c6f 6769 7374 6963    val = Logistic
-00079170: 5265 6772 6573 7369 6f6e 2829 0d0a 2020  Regression()..  
-00079180: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00079190: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000791a0: 2020 2020 2020 2020 206b 6579 203d 2027           key = '
-000791b0: 4c69 6e65 6172 5f52 6567 7265 7373 696f  Linear_Regressio
-000791c0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
-000791d0: 2020 2020 2020 2020 7661 6c20 3d20 4c69          val = Li
-000791e0: 6e65 6172 5265 6772 6573 7369 6f6e 2829  nearRegression()
-000791f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00079200: 2020 7661 6c2e 6669 7428 585f 7472 6169    val.fit(X_trai
-00079210: 6e2c 2079 5f74 7261 696e 290d 0a20 2020  n, y_train)..   
-00079220: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00079230: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
-00079240: 7661 6c2e 7072 6564 6963 7428 585f 7465  val.predict(X_te
-00079250: 7374 290d 0a20 2020 2020 2020 2065 7863  st)..        exc
-00079260: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00079270: 2020 7072 696e 7428 2745 7272 6f72 2069    print('Error i
-00079280: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
-00079290: 732e 2052 6574 7572 6e69 6e67 2e2e 2e27  s. Returning...'
-000792a0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-000792b0: 7461 636b 7320 3d20 6e70 2e61 7272 6179  tacks = np.array
-000792c0: 285b 5d29 0d0a 2020 2020 2020 2020 2020  ([])..          
-000792d0: 2020 7265 7475 726e 206d 6f64 656c 5f6e    return model_n
-000792e0: 616d 652c 2073 7461 636b 730d 0a20 2020  ame, stacks..   
-000792f0: 2020 2020 2069 6620 6974 6572 6174 696f       if iteratio
-00079300: 6e20 3d3d 2030 3a0d 0a20 2020 2020 2020  n == 0:..       
-00079310: 2020 2020 2073 7461 636b 7320 3d20 636f       stacks = co
-00079320: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
-00079330: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
-00079340: 2069 7465 7261 7469 6f6e 202b 3d20 310d   iteration += 1.
-00079350: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00079360: 2020 2020 2020 2020 2020 2020 7374 6163              stac
-00079370: 6b73 203d 206e 702e 635f 5b73 7461 636b  ks = np.c_[stack
-00079380: 732c 795f 7072 6564 5d0d 0a20 2020 2020  s,y_pred]..     
-00079390: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-000793a0: 616e 6365 2879 5f74 6573 742c 7374 7229  ance(y_test,str)
-000793b0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-000793c0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-000793d0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-000793e0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-000793f0: 635f 7363 6f72 6520 3d20 6e70 2e73 7172  c_score = np.sqr
-00079400: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
-00079410: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
-00079420: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
-00079430: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00079440: 732e 6170 7065 6e64 2828 6573 7469 6d61  s.append((estima
-00079450: 746f 725f 6e61 6d65 2c76 616c 2c20 6261  tor_name,val, ba
-00079460: 635f 7363 6f72 6529 290d 0a20 2020 2020  c_score))..     
-00079470: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-00079480: 5f74 7570 6c65 732e 6170 7065 6e64 2828  _tuples.append((
-00079490: 6573 7469 6d61 746f 725f 6e61 6d65 2c20  estimator_name, 
-000794a0: 6261 635f 7363 6f72 6529 290d 0a20 2020  bac_score))..   
-000794b0: 2020 2020 2020 2020 2020 2020 2062 6163               bac
-000794c0: 5f73 636f 7265 5f6c 6973 742e 6170 7065  _score_list.appe
-000794d0: 6e64 2862 6163 5f73 636f 7265 290d 0a20  nd(bac_score).. 
-000794e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000794f0: 635f 7363 6f72 655f 6c69 7374 2e61 7070  c_score_list.app
-00079500: 656e 6428 6d65 616e 5f73 7175 6172 6564  end(mean_squared
-00079510: 5f65 7272 6f72 2879 5f74 6573 742c 2079  _error(y_test, y
-00079520: 5f70 7265 6429 290d 0a20 2020 2020 2020  _pred))..       
-00079530: 2020 2020 2020 2020 2070 5f73 636f 7265           p_score
-00079540: 5f6c 6973 742e 6170 7065 6e64 286d 6561  _list.append(mea
-00079550: 6e5f 6162 736f 6c75 7465 5f65 7272 6f72  n_absolute_error
-00079560: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
-00079570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00079580: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
-00079590: 736f 6e5f 6466 203d 2070 642e 4461 7461  son_df = pd.Data
-000795a0: 4672 616d 6528 5b6d 6f64 656c 5f6e 616d  Frame([model_nam
-000795b0: 652c 2062 6163 5f73 636f 7265 5f6c 6973  e, bac_score_lis
-000795c0: 742c 2061 635f 7363 6f72 655f 6c69 7374  t, ac_score_list
-000795d0: 2c70 5f73 636f 7265 5f6c 6973 745d 292e  ,p_score_list]).
-000795e0: 540d 0a20 2020 2020 2020 2020 2020 2020  T..             
-000795f0: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
-00079600: 736f 6e5f 6466 2e63 6f6c 756d 6e73 203d  son_df.columns =
-00079610: 205b 276d 6f64 656c 5f6e 616d 6527 2c20   ['model_name', 
-00079620: 2752 4d53 4527 2c20 274d 5345 272c 274d  'RMSE', 'MSE','M
-00079630: 4145 275d 0d0a 2020 2020 2020 2020 2020  AE']..          
-00079640: 2020 2020 2020 6d6f 6465 6c5f 636f 6d70        model_comp
-00079650: 6172 6973 6f6e 5f64 6620 3d20 6d6f 6465  arison_df = mode
-00079660: 6c5f 636f 6d70 6172 6973 6f6e 5f64 662e  l_comparison_df.
-00079670: 736f 7274 5f76 616c 7565 7328 6279 3d27  sort_values(by='
-00079680: 524d 5345 272c 2061 7363 656e 6469 6e67  RMSE', ascending
-00079690: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-000796a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000796b0: 2020 2020 2020 2020 2020 2062 6163 5f73             bac_s
-000796c0: 636f 7265 203d 2062 616c 616e 6365 645f  core = balanced_
-000796d0: 6163 6375 7261 6379 5f73 636f 7265 2879  accuracy_score(y
-000796e0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
-000796f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079700: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
-00079710: 6428 2865 7374 696d 6174 6f72 5f6e 616d  d((estimator_nam
-00079720: 652c 7661 6c2c 2062 6163 5f73 636f 7265  e,val, bac_score
-00079730: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00079740: 2020 2020 6573 7469 6d5f 7475 706c 6573      estim_tuples
-00079750: 2e61 7070 656e 6428 2865 7374 696d 6174  .append((estimat
-00079760: 6f72 5f6e 616d 652c 2062 6163 5f73 636f  or_name, bac_sco
-00079770: 7265 2929 0d0a 2020 2020 2020 2020 2020  re))..          
-00079780: 2020 2020 2020 6261 635f 7363 6f72 655f        bac_score_
-00079790: 6c69 7374 2e61 7070 656e 6428 6261 6c61  list.append(bala
-000797a0: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
-000797b0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-000797c0: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
-000797d0: 2020 2020 2020 6163 5f73 636f 7265 5f6c        ac_score_l
-000797e0: 6973 742e 6170 7065 6e64 2861 6363 7572  ist.append(accur
-000797f0: 6163 795f 7363 6f72 6528 795f 7465 7374  acy_score(y_test
-00079800: 2c20 795f 7072 6564 2929 0d0a 2020 2020  , y_pred))..    
-00079810: 2020 2020 2020 2020 2020 2020 705f 7363              p_sc
-00079820: 6f72 655f 6c69 7374 2e61 7070 656e 6428  ore_list.append(
-00079830: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
-00079840: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
-00079850: 6176 6572 6167 653d 276d 6163 726f 2729  average='macro')
-00079860: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00079870: 2020 2072 5f73 636f 7265 5f6c 6973 742e     r_score_list.
-00079880: 6170 7065 6e64 2872 6563 616c 6c5f 7363  append(recall_sc
-00079890: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-000798a0: 6564 2c20 6176 6572 6167 653d 276d 6163  ed, average='mac
-000798b0: 726f 2729 290d 0a20 2020 2020 2020 2020  ro'))..         
-000798c0: 2020 2020 2020 2066 315f 7363 6f72 655f         f1_score_
-000798d0: 6c69 7374 2e61 7070 656e 6428 6631 5f73  list.append(f1_s
-000798e0: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
-000798f0: 7265 642c 2061 7665 7261 6765 3d27 6d61  red, average='ma
-00079900: 6372 6f27 2929 0d0a 2020 2020 2020 2020  cro'))..        
-00079910: 2020 2020 2020 2020 6d6f 6465 6c5f 636f          model_co
-00079920: 6d70 6172 6973 6f6e 5f64 6620 3d20 7064  mparison_df = pd
-00079930: 2e44 6174 6146 7261 6d65 285b 6d6f 6465  .DataFrame([mode
-00079940: 6c5f 6e61 6d65 2c20 6261 635f 7363 6f72  l_name, bac_scor
-00079950: 655f 6c69 7374 2c20 6163 5f73 636f 7265  e_list, ac_score
-00079960: 5f6c 6973 742c 2070 5f73 636f 7265 5f6c  _list, p_score_l
-00079970: 6973 742c 0d0a 2020 2020 2020 2020 2020  ist,..          
-00079980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000799a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000799b0: 5f73 636f 7265 5f6c 6973 742c 2066 315f  _score_list, f1_
-000799c0: 7363 6f72 655f 6c69 7374 5d29 2e54 0d0a  score_list]).T..
-000799d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000799e0: 6d6f 6465 6c5f 636f 6d70 6172 6973 6f6e  model_comparison
-000799f0: 5f64 662e 636f 6c75 6d6e 7320 3d20 5b27  _df.columns = ['
-00079a00: 6d6f 6465 6c5f 6e61 6d65 272c 2027 6261  model_name', 'ba
-00079a10: 6c5f 6163 6375 7261 6379 5f73 636f 7265  l_accuracy_score
-00079a20: 272c 2027 6163 6375 7261 6379 5f73 636f  ', 'accuracy_sco
-00079a30: 7265 272c 0d0a 2020 2020 2020 2020 2020  re',..          
-00079a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079a50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00079a60: 6176 655f 7072 6563 6973 696f 6e5f 7363  ave_precision_sc
-00079a70: 6f72 6527 2c20 2761 7665 5f72 6563 616c  ore', 'ave_recal
-00079a80: 6c5f 7363 6f72 6527 2c20 2761 7665 5f66  l_score', 'ave_f
-00079a90: 315f 7363 6f72 6527 5d0d 0a20 2020 2020  1_score']..     
-00079aa0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00079ab0: 5f63 6f6d 7061 7269 736f 6e5f 6466 203d  _comparison_df =
-00079ac0: 206d 6f64 656c 5f63 6f6d 7061 7269 736f   model_compariso
-00079ad0: 6e5f 6466 2e73 6f72 745f 7661 6c75 6573  n_df.sort_values
-00079ae0: 2862 793d 2762 616c 5f61 6363 7572 6163  (by='bal_accurac
-00079af0: 795f 7363 6f72 6527 2c20 6173 6365 6e64  y_score', ascend
-00079b00: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
-00079b10: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00079b20: 6528 795f 7465 7374 2c20 7374 7229 3a0d  e(y_test, str):.
-00079b30: 0a20 2020 2020 2020 2064 6174 615f 6672  .        data_fr
-00079b40: 616d 6520 3d20 6d6f 6465 6c5f 636f 6d70  ame = model_comp
-00079b50: 6172 6973 6f6e 5f64 662e 7365 745f 696e  arison_df.set_in
-00079b60: 6465 7828 276d 6f64 656c 5f6e 616d 6527  dex('model_name'
-00079b70: 292e 6173 7479 7065 2866 6c6f 6174 290d  ).astype(float).
-00079b80: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
-00079b90: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
-00079ba0: 3130 2929 0d0a 2020 2020 2020 2020 6720  10))..        g 
-00079bb0: 3d20 736e 732e 6865 6174 6d61 7028 6461  = sns.heatmap(da
-00079bc0: 7461 5f66 7261 6d65 2c61 6e6e 6f74 3d54  ta_frame,annot=T
-00079bd0: 7275 652c 666d 743d 2730 2e32 6627 2c63  rue,fmt='0.2f',c
-00079be0: 6261 723d 4661 6c73 6529 0d0a 2020 2020  bar=False)..    
-00079bf0: 2020 2020 672e 7365 745f 7874 6963 6b6c      g.set_xtickl
-00079c00: 6162 656c 7328 672e 6765 745f 7874 6963  abels(g.get_xtic
-00079c10: 6b6c 6162 656c 7328 292c 2072 6f74 6174  klabels(), rotat
-00079c20: 696f 6e20 3d20 3435 2c20 666f 6e74 7369  ion = 45, fontsi
-00079c30: 7a65 203d 2031 3229 0d0a 2020 2020 2020  ze = 12)..      
-00079c40: 2020 672e 7365 745f 7974 6963 6b6c 6162    g.set_yticklab
-00079c50: 656c 7328 672e 6765 745f 7974 6963 6b6c  els(g.get_ytickl
-00079c60: 6162 656c 7328 292c 2072 6f74 6174 696f  abels(), rotatio
-00079c70: 6e20 3d20 302c 2066 6f6e 7473 697a 6520  n = 0, fontsize 
-00079c80: 3d20 3132 290d 0a20 2020 2020 2020 2070  = 12)..        p
-00079c90: 7269 6e74 2827 5469 6d65 2074 616b 656e  rint('Time taken
-00079ca0: 203d 2025 302e 3066 2073 6563 6f6e 6473   = %0.0f seconds
-00079cb0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
-00079cc0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
-00079cd0: 2020 2020 2020 672e 7365 745f 7469 746c        g.set_titl
-00079ce0: 6528 2751 7569 636b 4d4c 2045 6e73 656d  e('QuickML Ensem
-00079cf0: 626c 696e 6720 4d6f 6465 6c73 2052 6573  bling Models Res
-00079d00: 756c 7473 272c 666f 6e74 7369 7a65 3d31  ults',fontsize=1
-00079d10: 3829 0d0a 2020 2020 2020 2020 6631 5f73  8)..        f1_s
-00079d20: 7461 7473 203d 2064 6963 7428 6573 7469  tats = dict(esti
-00079d30: 6d5f 7475 706c 6573 290d 0a20 2020 2020  m_tuples)..     
-00079d40: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00079d50: 2020 2020 2069 6620 7363 6f72 696e 6720       if scoring 
-00079d60: 696e 205b 276c 6f67 6c6f 7373 272c 2772  in ['logloss','r
-00079d70: 6d73 6527 2c27 6d61 6527 2c27 6d61 7065  mse','mae','mape
-00079d80: 272c 2752 4d53 4527 2c27 6e65 675f 6d65  ','RMSE','neg_me
-00079d90: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00079da0: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
-00079db0: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
-00079dc0: 6e61 6d65 203d 206d 696e 2866 315f 7374  name = min(f1_st
-00079dd0: 6174 732e 6974 656d 7328 292c 206b 6579  ats.items(), key
-00079de0: 3d6f 7065 7261 746f 722e 6974 656d 6765  =operator.itemge
-00079df0: 7474 6572 2831 2929 5b30 5d0d 0a20 2020  tter(1))[0]..   
-00079e00: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00079e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079e20: 6265 7374 5f6d 6f64 656c 5f6e 616d 6520  best_model_name 
-00079e30: 3d20 6d61 7828 6631 5f73 7461 7473 2e69  = max(f1_stats.i
-00079e40: 7465 6d73 2829 2c20 6b65 793d 6f70 6572  tems(), key=oper
-00079e50: 6174 6f72 2e69 7465 6d67 6574 7465 7228  ator.itemgetter(
-00079e60: 3129 295b 305d 0d0a 2020 2020 2020 2020  1))[0]..        
-00079e70: 2020 2020 7072 696e 7428 2742 6173 6564      print('Based
-00079e80: 206f 6e20 7472 7969 6e67 206d 756c 7469   on trying multi
-00079e90: 706c 6520 6d6f 6465 6c73 2c20 4265 7374  ple models, Best
-00079ea0: 2074 7970 6520 6f66 2061 6c67 6f72 6974   type of algorit
-00079eb0: 686d 2066 6f72 2074 6869 7320 6461 7461  hm for this data
-00079ec0: 2073 6574 2069 7320 2573 2720 2562 6573   set is %s' %bes
-00079ed0: 745f 6d6f 6465 6c5f 6e61 6d65 290d 0a20  t_model_name).. 
-00079ee0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-00079ef0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00079f00: 7428 2743 6f75 6c64 206e 6f74 2064 6574  t('Could not det
-00079f10: 6563 7420 6265 7374 2061 6c67 6f72 6974  ect best algorit
-00079f20: 686d 2074 7970 6520 6672 6f6d 2065 6e73  hm type from ens
-00079f30: 656d 626c 696e 672e 2043 6f6e 7469 6e75  embling. Continu
-00079f40: 696e 672e 2e2e 2729 0d0a 2020 2020 7265  ing...')..    re
-00079f50: 7475 726e 206d 6f64 656c 5f6e 616d 652c  turn model_name,
-00079f60: 2073 7461 636b 730d 0a23 2323 2323 2323   stacks..#######
-00079f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00079f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00079f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00079fa0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
-00079fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007a010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007a070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007a080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007a090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007a150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a200: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0007a210: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0007a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-0007a410: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
-0007a420: 4c5f 5374 6163 6b69 6e67 2e70 7900 0000  L_Stacking.py...
-0007a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0007a470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0007a480: 3030 3236 3237 3600 3030 3030 3030 3030  0026276.00000000
-0007a490: 3030 3000 3032 3034 3734 0020 3000 0000  000.020474. 0...
-0007a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0007a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0007a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007a550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00079160: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00079170: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
+00079180: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00079190: 656c 5f74 7570 6c65 732e 6170 7065 6e64  el_tuples.append
+000791a0: 2828 2742 6167 6769 6e67 5f43 6c61 7373  (('Bagging_Class
+000791b0: 6966 6965 7227 2c6d 6f64 656c 3829 290d  ifier',model8)).
+000791c0: 0a20 2020 206d 6f64 656c 5f64 6963 7420  .    model_dict 
+000791d0: 3d20 6469 6374 286d 6f64 656c 5f74 7570  = dict(model_tup
+000791e0: 6c65 7329 0d0a 2020 2020 6d6f 6465 6c73  les)..    models
+000791f0: 2c20 7265 7375 6c74 7320 3d20 7275 6e5f  , results = run_
+00079200: 656e 7365 6d62 6c65 5f6d 6f64 656c 7328  ensemble_models(
+00079210: 6d6f 6465 6c5f 6469 6374 2c20 585f 7472  model_dict, X_tr
+00079220: 6169 6e2c 2079 5f74 7261 696e 2c20 585f  ain, y_train, X_
+00079230: 7465 7374 2c20 795f 7465 7374 2c0d 0a20  test, y_test,.. 
+00079240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079260: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
+00079270: 2c20 6d6f 6465 6c74 7970 6529 0d0a 2020  , modeltype)..  
+00079280: 2020 7265 7475 726e 206d 6f64 656c 732c    return models,
+00079290: 2072 6573 756c 7473 0d0a 2323 2323 2323   results..######
+000792a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000792b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000792c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000792d0: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+000792e0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
+000792f0: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
+00079300: 6379 5f73 636f 7265 2c61 6363 7572 6163  cy_score,accurac
+00079310: 795f 7363 6f72 652c 7072 6563 6973 696f  y_score,precisio
+00079320: 6e5f 7363 6f72 652c 7265 6361 6c6c 5f73  n_score,recall_s
+00079330: 636f 7265 2c66 315f 7363 6f72 650d 0a66  core,f1_score..f
+00079340: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00079350: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
+00079360: 6162 736f 6c75 7465 5f65 7272 6f72 2c20  absolute_error, 
+00079370: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+00079380: 6f72 0d0a 696d 706f 7274 2063 6f70 790d  or..import copy.
+00079390: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
+000793a0: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
+000793b0: 7420 4c69 6e65 6172 5265 6772 6573 7369  t LinearRegressi
+000793c0: 6f6e 0d0a 6672 6f6d 2073 6b6c 6561 726e  on..from sklearn
+000793d0: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
+000793e0: 706f 7274 204c 6f67 6973 7469 6352 6567  port LogisticReg
+000793f0: 7265 7373 696f 6e0d 0a64 6566 2072 756e  ression..def run
+00079400: 5f65 6e73 656d 626c 655f 6d6f 6465 6c73  _ensemble_models
+00079410: 286d 6f64 656c 5f64 6963 742c 2058 5f74  (model_dict, X_t
+00079420: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
+00079430: 5f74 6573 742c 2079 5f74 6573 742c 2073  _test, y_test, s
+00079440: 636f 7269 6e67 2c20 6d6f 6465 6c74 7970  coring, modeltyp
+00079450: 6529 3a0d 0a20 2020 2073 7461 7274 5f74  e):..    start_t
+00079460: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
+00079470: 290d 0a20 2020 206d 6f64 656c 5f6e 616d  )..    model_nam
+00079480: 652c 2020 6261 635f 7363 6f72 655f 6c69  e,  bac_score_li
+00079490: 7374 2c20 6163 5f73 636f 7265 5f6c 6973  st, ac_score_lis
+000794a0: 742c 2070 5f73 636f 7265 5f6c 6973 742c  t, p_score_list,
+000794b0: 2072 5f73 636f 7265 5f6c 6973 742c 2066   r_score_list, f
+000794c0: 315f 7363 6f72 655f 6c69 7374 203d 205b  1_score_list = [
+000794d0: 5d2c 205b 5d2c 205b 5d2c 205b 5d2c 205b  ], [], [], [], [
+000794e0: 5d2c 205b 5d0d 0a20 2020 2069 7465 7261  ], []..    itera
+000794f0: 7469 6f6e 203d 2030 0d0a 2020 2020 6573  tion = 0..    es
+00079500: 7469 6d61 746f 7273 203d 205b 5d0d 0a20  timators = [].. 
+00079510: 2020 2065 7374 696d 5f74 7570 6c65 7320     estim_tuples 
+00079520: 3d20 5b5d 0d0a 2020 2020 666f 7220 6b65  = []..    for ke
+00079530: 792c 7661 6c20 696e 206d 6f64 656c 5f64  y,val in model_d
+00079540: 6963 742e 6974 656d 7328 293a 0d0a 2020  ict.items():..  
+00079550: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+00079560: 6e61 6d65 203d 206b 6579 0d0a 2020 2020  name = key..    
+00079570: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2e61      model_name.a
+00079580: 7070 656e 6428 6b65 7929 0d0a 2020 2020  ppend(key)..    
+00079590: 2020 2020 6966 2073 7472 2876 616c 292e      if str(val).
+000795a0: 7370 6c69 7428 2228 2229 5b30 5d20 3d3d  split("(")[0] ==
+000795b0: 2027 4d75 6c74 696e 6f6d 6961 6c4e 4227   'MultinomialNB'
+000795c0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+000795d0: 2323 2320 4d75 6c74 696e 6f6d 6961 6c20  ### Multinomial 
+000795e0: 6d6f 6465 6c73 206e 6565 6420 6f6e 6c79  models need only
+000795f0: 2070 6f73 6974 6976 6520 7661 6c75 6573   positive values
+00079600: 2121 0d0a 2020 2020 2020 2020 2020 2020  !!..            
+00079610: 7661 6c2e 6669 7428 6162 7328 585f 7472  val.fit(abs(X_tr
+00079620: 6169 6e29 2c20 795f 7472 6169 6e29 0d0a  ain), y_train)..
+00079630: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+00079640: 6564 203d 2076 616c 2e70 7265 6469 6374  ed = val.predict
+00079650: 2861 6273 2858 5f74 6573 7429 290d 0a20  (abs(X_test)).. 
+00079660: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00079670: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+00079680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079690: 7661 6c2e 6669 7428 585f 7472 6169 6e2c  val.fit(X_train,
+000796a0: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
+000796b0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+000796c0: 6420 3d20 7661 6c2e 7072 6564 6963 7428  d = val.predict(
+000796d0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+000796e0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+000796f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00079700: 206d 6f64 656c 7479 7065 2021 3d20 2752   modeltype != 'R
+00079710: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00079720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079730: 206b 6579 203d 2027 4c6f 6769 7374 6963   key = 'Logistic
+00079740: 5f52 6567 7265 7373 696f 6e27 0d0a 2020  _Regression'..  
+00079750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079760: 2020 7661 6c20 3d20 4c6f 6769 7374 6963    val = Logistic
+00079770: 5265 6772 6573 7369 6f6e 2829 0d0a 2020  Regression()..  
+00079780: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00079790: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000797a0: 2020 2020 2020 2020 206b 6579 203d 2027           key = '
+000797b0: 4c69 6e65 6172 5f52 6567 7265 7373 696f  Linear_Regressio
+000797c0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
+000797d0: 2020 2020 2020 2020 7661 6c20 3d20 4c69          val = Li
+000797e0: 6e65 6172 5265 6772 6573 7369 6f6e 2829  nearRegression()
+000797f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00079800: 2020 7661 6c2e 6669 7428 585f 7472 6169    val.fit(X_trai
+00079810: 6e2c 2079 5f74 7261 696e 290d 0a20 2020  n, y_train)..   
+00079820: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00079830: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+00079840: 7661 6c2e 7072 6564 6963 7428 585f 7465  val.predict(X_te
+00079850: 7374 290d 0a20 2020 2020 2020 2065 7863  st)..        exc
+00079860: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00079870: 2020 7072 696e 7428 2745 7272 6f72 2069    print('Error i
+00079880: 6e20 656e 7365 6d62 6c65 206d 6f64 656c  n ensemble model
+00079890: 732e 2052 6574 7572 6e69 6e67 2e2e 2e27  s. Returning...'
+000798a0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+000798b0: 7461 636b 7320 3d20 6e70 2e61 7272 6179  tacks = np.array
+000798c0: 285b 5d29 0d0a 2020 2020 2020 2020 2020  ([])..          
+000798d0: 2020 7265 7475 726e 206d 6f64 656c 5f6e    return model_n
+000798e0: 616d 652c 2073 7461 636b 730d 0a20 2020  ame, stacks..   
+000798f0: 2020 2020 2069 6620 6974 6572 6174 696f       if iteratio
+00079900: 6e20 3d3d 2030 3a0d 0a20 2020 2020 2020  n == 0:..       
+00079910: 2020 2020 2073 7461 636b 7320 3d20 636f       stacks = co
+00079920: 7079 2e64 6565 7063 6f70 7928 795f 7072  py.deepcopy(y_pr
+00079930: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+00079940: 2069 7465 7261 7469 6f6e 202b 3d20 310d   iteration += 1.
+00079950: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00079960: 2020 2020 2020 2020 2020 2020 7374 6163              stac
+00079970: 6b73 203d 206e 702e 635f 5b73 7461 636b  ks = np.c_[stack
+00079980: 732c 795f 7072 6564 5d0d 0a20 2020 2020  s,y_pred]..     
+00079990: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000799a0: 616e 6365 2879 5f74 6573 742c 7374 7229  ance(y_test,str)
+000799b0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+000799c0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+000799d0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+000799e0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+000799f0: 635f 7363 6f72 6520 3d20 6e70 2e73 7172  c_score = np.sqr
+00079a00: 7428 6d65 616e 5f73 7175 6172 6564 5f65  t(mean_squared_e
+00079a10: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
+00079a20: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
+00079a30: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00079a40: 732e 6170 7065 6e64 2828 6573 7469 6d61  s.append((estima
+00079a50: 746f 725f 6e61 6d65 2c76 616c 2c20 6261  tor_name,val, ba
+00079a60: 635f 7363 6f72 6529 290d 0a20 2020 2020  c_score))..     
+00079a70: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+00079a80: 5f74 7570 6c65 732e 6170 7065 6e64 2828  _tuples.append((
+00079a90: 6573 7469 6d61 746f 725f 6e61 6d65 2c20  estimator_name, 
+00079aa0: 6261 635f 7363 6f72 6529 290d 0a20 2020  bac_score))..   
+00079ab0: 2020 2020 2020 2020 2020 2020 2062 6163               bac
+00079ac0: 5f73 636f 7265 5f6c 6973 742e 6170 7065  _score_list.appe
+00079ad0: 6e64 2862 6163 5f73 636f 7265 290d 0a20  nd(bac_score).. 
+00079ae0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00079af0: 635f 7363 6f72 655f 6c69 7374 2e61 7070  c_score_list.app
+00079b00: 656e 6428 6d65 616e 5f73 7175 6172 6564  end(mean_squared
+00079b10: 5f65 7272 6f72 2879 5f74 6573 742c 2079  _error(y_test, y
+00079b20: 5f70 7265 6429 290d 0a20 2020 2020 2020  _pred))..       
+00079b30: 2020 2020 2020 2020 2070 5f73 636f 7265           p_score
+00079b40: 5f6c 6973 742e 6170 7065 6e64 286d 6561  _list.append(mea
+00079b50: 6e5f 6162 736f 6c75 7465 5f65 7272 6f72  n_absolute_error
+00079b60: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
+00079b70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00079b80: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
+00079b90: 736f 6e5f 6466 203d 2070 642e 4461 7461  son_df = pd.Data
+00079ba0: 4672 616d 6528 5b6d 6f64 656c 5f6e 616d  Frame([model_nam
+00079bb0: 652c 2062 6163 5f73 636f 7265 5f6c 6973  e, bac_score_lis
+00079bc0: 742c 2061 635f 7363 6f72 655f 6c69 7374  t, ac_score_list
+00079bd0: 2c70 5f73 636f 7265 5f6c 6973 745d 292e  ,p_score_list]).
+00079be0: 540d 0a20 2020 2020 2020 2020 2020 2020  T..             
+00079bf0: 2020 206d 6f64 656c 5f63 6f6d 7061 7269     model_compari
+00079c00: 736f 6e5f 6466 2e63 6f6c 756d 6e73 203d  son_df.columns =
+00079c10: 205b 276d 6f64 656c 5f6e 616d 6527 2c20   ['model_name', 
+00079c20: 2752 4d53 4527 2c20 274d 5345 272c 274d  'RMSE', 'MSE','M
+00079c30: 4145 275d 0d0a 2020 2020 2020 2020 2020  AE']..          
+00079c40: 2020 2020 2020 6d6f 6465 6c5f 636f 6d70        model_comp
+00079c50: 6172 6973 6f6e 5f64 6620 3d20 6d6f 6465  arison_df = mode
+00079c60: 6c5f 636f 6d70 6172 6973 6f6e 5f64 662e  l_comparison_df.
+00079c70: 736f 7274 5f76 616c 7565 7328 6279 3d27  sort_values(by='
+00079c80: 524d 5345 272c 2061 7363 656e 6469 6e67  RMSE', ascending
+00079c90: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+00079ca0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00079cb0: 2020 2020 2020 2020 2020 2062 6163 5f73             bac_s
+00079cc0: 636f 7265 203d 2062 616c 616e 6365 645f  core = balanced_
+00079cd0: 6163 6375 7261 6379 5f73 636f 7265 2879  accuracy_score(y
+00079ce0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
+00079cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079d00: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
+00079d10: 6428 2865 7374 696d 6174 6f72 5f6e 616d  d((estimator_nam
+00079d20: 652c 7661 6c2c 2062 6163 5f73 636f 7265  e,val, bac_score
+00079d30: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00079d40: 2020 2020 6573 7469 6d5f 7475 706c 6573      estim_tuples
+00079d50: 2e61 7070 656e 6428 2865 7374 696d 6174  .append((estimat
+00079d60: 6f72 5f6e 616d 652c 2062 6163 5f73 636f  or_name, bac_sco
+00079d70: 7265 2929 0d0a 2020 2020 2020 2020 2020  re))..          
+00079d80: 2020 2020 2020 6261 635f 7363 6f72 655f        bac_score_
+00079d90: 6c69 7374 2e61 7070 656e 6428 6261 6c61  list.append(bala
+00079da0: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
+00079db0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+00079dc0: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
+00079dd0: 2020 2020 2020 6163 5f73 636f 7265 5f6c        ac_score_l
+00079de0: 6973 742e 6170 7065 6e64 2861 6363 7572  ist.append(accur
+00079df0: 6163 795f 7363 6f72 6528 795f 7465 7374  acy_score(y_test
+00079e00: 2c20 795f 7072 6564 2929 0d0a 2020 2020  , y_pred))..    
+00079e10: 2020 2020 2020 2020 2020 2020 705f 7363              p_sc
+00079e20: 6f72 655f 6c69 7374 2e61 7070 656e 6428  ore_list.append(
+00079e30: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
+00079e40: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
+00079e50: 6176 6572 6167 653d 276d 6163 726f 2729  average='macro')
+00079e60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00079e70: 2020 2072 5f73 636f 7265 5f6c 6973 742e     r_score_list.
+00079e80: 6170 7065 6e64 2872 6563 616c 6c5f 7363  append(recall_sc
+00079e90: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+00079ea0: 6564 2c20 6176 6572 6167 653d 276d 6163  ed, average='mac
+00079eb0: 726f 2729 290d 0a20 2020 2020 2020 2020  ro'))..         
+00079ec0: 2020 2020 2020 2066 315f 7363 6f72 655f         f1_score_
+00079ed0: 6c69 7374 2e61 7070 656e 6428 6631 5f73  list.append(f1_s
+00079ee0: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
+00079ef0: 7265 642c 2061 7665 7261 6765 3d27 6d61  red, average='ma
+00079f00: 6372 6f27 2929 0d0a 2020 2020 2020 2020  cro'))..        
+00079f10: 2020 2020 2020 2020 6d6f 6465 6c5f 636f          model_co
+00079f20: 6d70 6172 6973 6f6e 5f64 6620 3d20 7064  mparison_df = pd
+00079f30: 2e44 6174 6146 7261 6d65 285b 6d6f 6465  .DataFrame([mode
+00079f40: 6c5f 6e61 6d65 2c20 6261 635f 7363 6f72  l_name, bac_scor
+00079f50: 655f 6c69 7374 2c20 6163 5f73 636f 7265  e_list, ac_score
+00079f60: 5f6c 6973 742c 2070 5f73 636f 7265 5f6c  _list, p_score_l
+00079f70: 6973 742c 0d0a 2020 2020 2020 2020 2020  ist,..          
+00079f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079fa0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00079fb0: 5f73 636f 7265 5f6c 6973 742c 2066 315f  _score_list, f1_
+00079fc0: 7363 6f72 655f 6c69 7374 5d29 2e54 0d0a  score_list]).T..
+00079fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079fe0: 6d6f 6465 6c5f 636f 6d70 6172 6973 6f6e  model_comparison
+00079ff0: 5f64 662e 636f 6c75 6d6e 7320 3d20 5b27  _df.columns = ['
+0007a000: 6d6f 6465 6c5f 6e61 6d65 272c 2027 6261  model_name', 'ba
+0007a010: 6c5f 6163 6375 7261 6379 5f73 636f 7265  l_accuracy_score
+0007a020: 272c 2027 6163 6375 7261 6379 5f73 636f  ', 'accuracy_sco
+0007a030: 7265 272c 0d0a 2020 2020 2020 2020 2020  re',..          
+0007a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a050: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0007a060: 6176 655f 7072 6563 6973 696f 6e5f 7363  ave_precision_sc
+0007a070: 6f72 6527 2c20 2761 7665 5f72 6563 616c  ore', 'ave_recal
+0007a080: 6c5f 7363 6f72 6527 2c20 2761 7665 5f66  l_score', 'ave_f
+0007a090: 315f 7363 6f72 6527 5d0d 0a20 2020 2020  1_score']..     
+0007a0a0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0007a0b0: 5f63 6f6d 7061 7269 736f 6e5f 6466 203d  _comparison_df =
+0007a0c0: 206d 6f64 656c 5f63 6f6d 7061 7269 736f   model_compariso
+0007a0d0: 6e5f 6466 2e73 6f72 745f 7661 6c75 6573  n_df.sort_values
+0007a0e0: 2862 793d 2762 616c 5f61 6363 7572 6163  (by='bal_accurac
+0007a0f0: 795f 7363 6f72 6527 2c20 6173 6365 6e64  y_score', ascend
+0007a100: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
+0007a110: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0007a120: 6528 795f 7465 7374 2c20 7374 7229 3a0d  e(y_test, str):.
+0007a130: 0a20 2020 2020 2020 2064 6174 615f 6672  .        data_fr
+0007a140: 616d 6520 3d20 6d6f 6465 6c5f 636f 6d70  ame = model_comp
+0007a150: 6172 6973 6f6e 5f64 662e 7365 745f 696e  arison_df.set_in
+0007a160: 6465 7828 276d 6f64 656c 5f6e 616d 6527  dex('model_name'
+0007a170: 292e 6173 7479 7065 2866 6c6f 6174 290d  ).astype(float).
+0007a180: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
+0007a190: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
+0007a1a0: 3130 2929 0d0a 2020 2020 2020 2020 6720  10))..        g 
+0007a1b0: 3d20 736e 732e 6865 6174 6d61 7028 6461  = sns.heatmap(da
+0007a1c0: 7461 5f66 7261 6d65 2c61 6e6e 6f74 3d54  ta_frame,annot=T
+0007a1d0: 7275 652c 666d 743d 2730 2e32 6627 2c63  rue,fmt='0.2f',c
+0007a1e0: 6261 723d 4661 6c73 6529 0d0a 2020 2020  bar=False)..    
+0007a1f0: 2020 2020 672e 7365 745f 7874 6963 6b6c      g.set_xtickl
+0007a200: 6162 656c 7328 672e 6765 745f 7874 6963  abels(g.get_xtic
+0007a210: 6b6c 6162 656c 7328 292c 2072 6f74 6174  klabels(), rotat
+0007a220: 696f 6e20 3d20 3435 2c20 666f 6e74 7369  ion = 45, fontsi
+0007a230: 7a65 203d 2031 3229 0d0a 2020 2020 2020  ze = 12)..      
+0007a240: 2020 672e 7365 745f 7974 6963 6b6c 6162    g.set_yticklab
+0007a250: 656c 7328 672e 6765 745f 7974 6963 6b6c  els(g.get_ytickl
+0007a260: 6162 656c 7328 292c 2072 6f74 6174 696f  abels(), rotatio
+0007a270: 6e20 3d20 302c 2066 6f6e 7473 697a 6520  n = 0, fontsize 
+0007a280: 3d20 3132 290d 0a20 2020 2020 2020 2070  = 12)..        p
+0007a290: 7269 6e74 2827 5469 6d65 2074 616b 656e  rint('Time taken
+0007a2a0: 203d 2025 302e 3066 2073 6563 6f6e 6473   = %0.0f seconds
+0007a2b0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
+0007a2c0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
+0007a2d0: 2020 2020 2020 672e 7365 745f 7469 746c        g.set_titl
+0007a2e0: 6528 2751 7569 636b 4d4c 2045 6e73 656d  e('QuickML Ensem
+0007a2f0: 626c 696e 6720 4d6f 6465 6c73 2052 6573  bling Models Res
+0007a300: 756c 7473 272c 666f 6e74 7369 7a65 3d31  ults',fontsize=1
+0007a310: 3829 0d0a 2020 2020 2020 2020 6631 5f73  8)..        f1_s
+0007a320: 7461 7473 203d 2064 6963 7428 6573 7469  tats = dict(esti
+0007a330: 6d5f 7475 706c 6573 290d 0a20 2020 2020  m_tuples)..     
+0007a340: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0007a350: 2020 2020 2069 6620 7363 6f72 696e 6720       if scoring 
+0007a360: 696e 205b 276c 6f67 6c6f 7373 272c 2772  in ['logloss','r
+0007a370: 6d73 6527 2c27 6d61 6527 2c27 6d61 7065  mse','mae','mape
+0007a380: 272c 2752 4d53 4527 2c27 6e65 675f 6d65  ','RMSE','neg_me
+0007a390: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+0007a3a0: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
+0007a3b0: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
+0007a3c0: 6e61 6d65 203d 206d 696e 2866 315f 7374  name = min(f1_st
+0007a3d0: 6174 732e 6974 656d 7328 292c 206b 6579  ats.items(), key
+0007a3e0: 3d6f 7065 7261 746f 722e 6974 656d 6765  =operator.itemge
+0007a3f0: 7474 6572 2831 2929 5b30 5d0d 0a20 2020  tter(1))[0]..   
+0007a400: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0007a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a420: 6265 7374 5f6d 6f64 656c 5f6e 616d 6520  best_model_name 
+0007a430: 3d20 6d61 7828 6631 5f73 7461 7473 2e69  = max(f1_stats.i
+0007a440: 7465 6d73 2829 2c20 6b65 793d 6f70 6572  tems(), key=oper
+0007a450: 6174 6f72 2e69 7465 6d67 6574 7465 7228  ator.itemgetter(
+0007a460: 3129 295b 305d 0d0a 2020 2020 2020 2020  1))[0]..        
+0007a470: 2020 2020 7072 696e 7428 2742 6173 6564      print('Based
+0007a480: 206f 6e20 7472 7969 6e67 206d 756c 7469   on trying multi
+0007a490: 706c 6520 6d6f 6465 6c73 2c20 4265 7374  ple models, Best
+0007a4a0: 2074 7970 6520 6f66 2061 6c67 6f72 6974   type of algorit
+0007a4b0: 686d 2066 6f72 2074 6869 7320 6461 7461  hm for this data
+0007a4c0: 2073 6574 2069 7320 2573 2720 2562 6573   set is %s' %bes
+0007a4d0: 745f 6d6f 6465 6c5f 6e61 6d65 290d 0a20  t_model_name).. 
+0007a4e0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+0007a4f0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0007a500: 7428 2743 6f75 6c64 206e 6f74 2064 6574  t('Could not det
+0007a510: 6563 7420 6265 7374 2061 6c67 6f72 6974  ect best algorit
+0007a520: 686d 2074 7970 6520 6672 6f6d 2065 6e73  hm type from ens
+0007a530: 656d 626c 696e 672e 2043 6f6e 7469 6e75  embling. Continu
+0007a540: 696e 672e 2e2e 2729 0d0a 2020 2020 7265  ing...')..    re
+0007a550: 7475 726e 206d 6f64 656c 5f6e 616d 652c  turn model_name,
+0007a560: 2073 7461 636b 730d 0a23 2323 2323 2323   stacks..#######
+0007a570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007a580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007a590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007a5a0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
 0007a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007a600: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0007a610: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-0007a620: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
-0007a630: 7761 726e 696e 6773 0d0a 7761 726e 696e  warnings..warnin
-0007a640: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
-0007a650: 7328 2269 676e 6f72 6522 290d 0a66 726f  s("ignore")..fro
-0007a660: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
-0007a670: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
-0007a680: 2063 726f 7373 5f76 616c 5f73 636f 7265   cross_val_score
-0007a690: 2c20 5374 7261 7469 6669 6564 5368 7566  , StratifiedShuf
-0007a6a0: 666c 6553 706c 6974 2c20 5469 6d65 5365  fleSplit, TimeSe
-0007a6b0: 7269 6573 5370 6c69 740d 0a66 726f 6d20  riesSplit..from 
-0007a6c0: 736b 6c65 6172 6e2e 6d6f 6465 6c5f 7365  sklearn.model_se
-0007a6d0: 6c65 6374 696f 6e20 696d 706f 7274 2053  lection import S
-0007a6e0: 6875 6666 6c65 5370 6c69 742c 5374 7261  huffleSplit,Stra
-0007a6f0: 7469 6669 6564 4b46 6f6c 642c 4b46 6f6c  tifiedKFold,KFol
-0007a700: 640d 0a66 726f 6d20 736b 6c65 6172 6e2e  d..from sklearn.
-0007a710: 6469 7363 7269 6d69 6e61 6e74 5f61 6e61  discriminant_ana
-0007a720: 6c79 7369 7320 696d 706f 7274 204c 696e  lysis import Lin
-0007a730: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
-0007a740: 6e61 6c79 7369 730d 0a66 726f 6d20 736b  nalysis..from sk
-0007a750: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
-0007a760: 6d70 6f72 7420 4261 6767 696e 6752 6567  mport BaggingReg
-0007a770: 7265 7373 6f72 2c20 5261 6e64 6f6d 466f  ressor, RandomFo
-0007a780: 7265 7374 436c 6173 7369 6669 6572 0d0a  restClassifier..
-0007a790: 6672 6f6d 2073 6b6c 6561 726e 2e65 6e73  from sklearn.ens
-0007a7a0: 656d 626c 6520 696d 706f 7274 2045 7874  emble import Ext
-0007a7b0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
-0007a7c0: 722c 4578 7472 6154 7265 6573 5265 6772  r,ExtraTreesRegr
-0007a7d0: 6573 736f 720d 0a66 726f 6d20 736b 6c65  essor..from skle
-0007a7e0: 6172 6e2e 6c69 6e65 6172 5f6d 6f64 656c  arn.linear_model
-0007a7f0: 2069 6d70 6f72 7420 4c6f 6769 7374 6963   import Logistic
-0007a800: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
-0007a810: 6e65 6172 5265 6772 6573 7369 6f6e 2c20  nearRegression, 
-0007a820: 5269 6467 650d 0a66 726f 6d20 736b 6c65  Ridge..from skle
-0007a830: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
-0007a840: 696e 6561 7253 5643 2c20 5356 522c 204c  inearSVC, SVR, L
-0007a850: 696e 6561 7253 5652 0d0a 6672 6f6d 2073  inearSVR..from s
-0007a860: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
-0007a870: 696d 706f 7274 2041 6461 426f 6f73 7443  import AdaBoostC
-0007a880: 6c61 7373 6966 6965 722c 2041 6461 426f  lassifier, AdaBo
-0007a890: 6f73 7452 6567 7265 7373 6f72 0d0a 6672  ostRegressor..fr
-0007a8a0: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
-0007a8b0: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
-0007a8c0: 7265 6552 6567 7265 7373 6f72 2c20 4465  reeRegressor, De
-0007a8d0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-0007a8e0: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
-0007a8f0: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
-0007a900: 696d 706f 7274 204c 6173 736f 2c20 4c61  import Lasso, La
-0007a910: 7373 6f43 562c 2052 6964 6765 2c20 5269  ssoCV, Ridge, Ri
-0007a920: 6467 6543 562c 204c 6173 736f 4c61 7273  dgeCV, LassoLars
-0007a930: 4356 0d0a 6672 6f6d 2073 6b6c 6561 726e  CV..from sklearn
-0007a940: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
-0007a950: 2069 6d70 6f72 7420 6372 6f73 735f 7661   import cross_va
-0007a960: 6c5f 7072 6564 6963 740d 0a66 726f 6d20  l_predict..from 
-0007a970: 736b 6c65 6172 6e2e 656e 7365 6d62 6c65  sklearn.ensemble
-0007a980: 2069 6d70 6f72 7420 4578 7472 6154 7265   import ExtraTre
-0007a990: 6573 5265 6772 6573 736f 722c 2045 7874  esRegressor, Ext
-0007a9a0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
-0007a9b0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
-0007a9c0: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
-0007a9d0: 6f72 7420 4c6f 6769 7374 6963 5265 6772  ort LogisticRegr
-0007a9e0: 6573 7369 6f6e 2c20 4c6f 6769 7374 6963  ession, Logistic
-0007a9f0: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
-0007aa00: 6e65 6172 5265 6772 6573 7369 6f6e 0d0a  nearRegression..
-0007aa10: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
-0007aa20: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
-0007aa30: 6f72 7420 4772 6964 5365 6172 6368 4356  ort GridSearchCV
-0007aa40: 2c53 7472 6174 6966 6965 6453 6875 6666  ,StratifiedShuff
-0007aa50: 6c65 5370 6c69 742c 5368 7566 666c 6553  leSplit,ShuffleS
-0007aa60: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
-0007aa70: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
-0007aa80: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
-0007aa90: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
-0007aaa0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
-0007aab0: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
-0007aac0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-0007aad0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
-0007aae0: 6d70 6f72 7420 7064 620d 0a69 6d70 6f72  mport pdb..impor
-0007aaf0: 7420 7469 6d65 0d0a 696d 706f 7274 2063  t time..import c
-0007ab00: 6f70 790d 0a66 726f 6d20 636f 6c6c 6563  opy..from collec
-0007ab10: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
-0007ab20: 6e74 6572 0d0a 6672 6f6d 2063 6f6c 6c65  nter..from colle
-0007ab30: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0007ab40: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
-0007ab50: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
-0007ab60: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
-0007ab70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007ab80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007ab90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007aba0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007abb0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0007abc0: 6566 2066 696e 645f 7261 7265 5f63 6c61  ef find_rare_cla
-0007abd0: 7373 2863 6c61 7373 6573 2c20 7665 7262  ss(classes, verb
-0007abe0: 6f73 653d 3029 3a0d 0a20 2020 2023 2323  ose=0):..    ###
-0007abf0: 2323 2323 2323 2050 7269 6e74 2074 6865  ###### Print the
-0007ac00: 2025 2063 6f75 6e74 206f 6620 6561 6368   % count of each
-0007ac10: 2063 6c61 7373 2069 6e20 6120 5461 7267   class in a Targ
-0007ac20: 6574 2076 6172 6961 626c 6520 2023 2323  et variable  ###
-0007ac30: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
-0007ac40: 2057 6f72 6b73 206f 6e20 4d75 6c74 6920   Works on Multi 
-0007ac50: 436c 6173 7320 746f 6f2e 2050 7269 6e74  Class too. Print
-0007ac60: 7320 636c 6173 7320 7065 7263 656e 7461  s class percenta
-0007ac70: 6765 7320 636f 756e 7420 6f66 2074 6172  ges count of tar
-0007ac80: 6765 7420 7661 7269 6162 6c65 2e0d 0a20  get variable... 
-0007ac90: 2020 2049 7420 7265 7475 726e 7320 7468     It returns th
-0007aca0: 6520 6e61 6d65 206f 6620 7468 6520 5261  e name of the Ra
-0007acb0: 7265 2063 6c61 7373 2028 7468 6520 6f6e  re class (the on
-0007acc0: 6520 7769 7468 2074 6865 206d 696e 696d  e with the minim
-0007acd0: 756d 2063 6c61 7373 206d 656d 6265 7220  um class member 
-0007ace0: 636f 756e 7429 2e0d 0a20 2020 2054 6869  count)...    Thi
-0007acf0: 7320 6361 6e20 616c 736f 2062 6520 6865  s can also be he
-0007ad00: 6c70 6675 6c20 696e 2075 7369 6e67 2069  lpful in using i
-0007ad10: 7420 6173 2070 6f73 5f6c 6162 656c 2069  t as pos_label i
-0007ad20: 6e20 4269 6e61 7279 2061 6e64 204d 756c  n Binary and Mul
-0007ad30: 7469 2043 6c61 7373 2070 726f 626c 656d  ti Class problem
-0007ad40: 732e 0d0a 2020 2020 2222 220d 0a20 2020  s...    """..   
-0007ad50: 2063 6f75 6e74 7320 3d20 4f72 6465 7265   counts = Ordere
-0007ad60: 6444 6963 7428 436f 756e 7465 7228 636c  dDict(Counter(cl
-0007ad70: 6173 7365 7329 290d 0a20 2020 2074 6f74  asses))..    tot
-0007ad80: 616c 203d 2073 756d 2863 6f75 6e74 732e  al = sum(counts.
-0007ad90: 7661 6c75 6573 2829 290d 0a20 2020 2069  values())..    i
-0007ada0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
-0007adb0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0007adc0: 2043 6c61 7373 2020 2d3e 2043 6f75 6e74   Class  -> Count
-0007add0: 7320 2d3e 2050 6572 6365 6e74 2729 0d0a  s -> Percent')..
-0007ade0: 2020 2020 2020 2020 666f 7220 636c 7320          for cls 
-0007adf0: 696e 2063 6f75 6e74 732e 6b65 7973 2829  in counts.keys()
-0007ae00: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0007ae10: 7269 6e74 2822 2536 733a 2025 2037 6420  rint("%6s: % 7d 
-0007ae20: 202d 3e20 2025 2035 2e31 6625 2522 2025   ->  % 5.1f%%" %
-0007ae30: 2028 636c 732c 2063 6f75 6e74 735b 636c   (cls, counts[cl
-0007ae40: 735d 2c20 636f 756e 7473 5b63 6c73 5d2f  s], counts[cls]/
-0007ae50: 746f 7461 6c2a 3130 3029 290d 0a20 2020  total*100))..   
-0007ae60: 2069 6620 7479 7065 2870 642e 5365 7269   if type(pd.Seri
-0007ae70: 6573 2863 6f75 6e74 7329 2e69 6478 6d69  es(counts).idxmi
-0007ae80: 6e28 2929 3d3d 7374 723a 0d0a 2020 2020  n())==str:..    
-0007ae90: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
-0007aea0: 7269 6573 2863 6f75 6e74 7329 2e69 6478  ries(counts).idx
-0007aeb0: 6d69 6e28 290d 0a20 2020 2065 6c73 653a  min()..    else:
-0007aec0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0007aed0: 2069 6e74 2870 642e 5365 7269 6573 2863   int(pd.Series(c
-0007aee0: 6f75 6e74 7329 2e69 6478 6d69 6e28 2929  ounts).idxmin())
-0007aef0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0007af00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007af10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007af20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007af30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007af40: 2323 0d0a 6465 6620 5175 6963 6b4d 4c5f  ##..def QuickML_
-0007af50: 5374 6163 6b69 6e67 2858 5f74 7261 696e  Stacking(X_train
-0007af60: 2c20 795f 7472 6169 6e2c 2058 5f74 6573  , y_train, X_tes
-0007af70: 743d 2727 2c20 6d6f 6465 6c74 7970 653d  t='', modeltype=
-0007af80: 2752 6567 7265 7373 696f 6e27 2c42 6f6f  'Regression',Boo
-0007af90: 7374 696e 675f 466c 6167 3d46 616c 7365  sting_Flag=False
-0007afa0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007afb0: 2020 2020 2020 2073 636f 7269 6e67 3d27         scoring='
-0007afc0: 272c 2076 6572 626f 7365 3d30 293a 0d0a  ', verbose=0):..
-0007afd0: 2020 2020 2222 220d 0a20 2020 2051 7569      """..    Qui
-0007afe0: 636b 6c79 2062 7569 6c64 2053 7461 636b  ckly build Stack
-0007aff0: 7320 6f66 206d 756c 7469 706c 6520 6d6f  s of multiple mo
-0007b000: 6465 6c20 7265 7375 6c74 730d 0a20 2020  del results..   
-0007b010: 2049 6e70 7574 206d 7573 7420 6265 2061   Input must be a
-0007b020: 2063 6c65 616e 2064 6174 6120 7365 7420   clean data set 
-0007b030: 286f 6e6c 7920 6e75 6d65 7269 6320 7661  (only numeric va
-0007b040: 7269 6162 6c65 732c 206e 6f20 6361 7465  riables, no cate
-0007b050: 676f 7269 6361 6c20 6f72 2073 7472 696e  gorical or strin
-0007b060: 6720 7661 7269 6162 6c65 7329 2e0d 0a20  g variables)... 
-0007b070: 2020 2022 2222 0d0a 2020 2020 585f 7472     """..    X_tr
-0007b080: 6169 6e20 3d20 636f 7079 2e64 6565 7063  ain = copy.deepc
-0007b090: 6f70 7928 585f 7472 6169 6e29 0d0a 2020  opy(X_train)..  
-0007b0a0: 2020 585f 7465 7374 203d 2063 6f70 792e    X_test = copy.
-0007b0b0: 6465 6570 636f 7079 2858 5f74 6573 7429  deepcopy(X_test)
-0007b0c0: 0d0a 2020 2020 795f 7472 6169 6e20 3d20  ..    y_train = 
-0007b0d0: 636f 7079 2e64 6565 7063 6f70 7928 795f  copy.deepcopy(y_
-0007b0e0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
-0007b0f0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
-0007b100: 6d65 2829 0d0a 2020 2020 7365 6564 203d  me()..    seed =
-0007b110: 2039 390d 0a20 2020 2069 6620 6c65 6e28   99..    if len(
-0007b120: 585f 7472 6169 6e29 203c 3d20 3130 3030  X_train) <= 1000
-0007b130: 3030 206f 7220 585f 7472 6169 6e2e 7368  00 or X_train.sh
-0007b140: 6170 655b 315d 203c 2035 303a 0d0a 2020  ape[1] < 50:..  
-0007b150: 2020 2020 2020 4e55 4d53 203d 2031 3030        NUMS = 100
-0007b160: 0d0a 2020 2020 2020 2020 464f 4c44 5320  ..        FOLDS 
-0007b170: 3d20 350d 0a20 2020 2065 6c73 653a 0d0a  = 5..    else:..
-0007b180: 2020 2020 2020 2020 4e55 4d53 203d 2032          NUMS = 2
-0007b190: 3030 0d0a 2020 2020 2020 2020 464f 4c44  00..        FOLD
-0007b1a0: 5320 3d20 3130 0d0a 2020 2020 2323 2063  S = 10..    ## c
-0007b1b0: 7265 6174 6520 5374 6163 6b69 6e67 206d  reate Stacking m
-0007b1c0: 6f64 656c 730d 0a20 2020 2065 7374 696d  odels..    estim
-0007b1d0: 6174 6f72 7320 3d20 5b5d 0d0a 2020 2020  ators = []..    
-0007b1e0: 2323 2320 5468 6973 206b 6565 7073 2074  ### This keeps t
-0007b1f0: 7261 636b 7320 6f66 2074 6865 206e 756d  racks of the num
-0007b200: 6265 7220 6f66 2070 7265 6469 6374 5f70  ber of predict_p
-0007b210: 726f 6261 2063 6f6c 756d 6e73 2067 656e  roba columns gen
-0007b220: 6572 6174 6564 2062 7920 6561 6368 206d  erated by each m
-0007b230: 6f64 656c 2023 2323 230d 0a20 2020 2065  odel ####..    e
-0007b240: 7374 696d 6174 6f72 5f6c 656e 6774 6820  stimator_length 
-0007b250: 3d20 5b5d 0d0a 2020 2020 6966 2069 7369  = []..    if isi
-0007b260: 6e73 7461 6e63 6528 585f 7465 7374 2c20  nstance(X_test, 
-0007b270: 7374 7229 3a0d 0a20 2020 2020 2020 206e  str):..        n
-0007b280: 6f5f 6669 7420 3d20 5472 7565 0d0a 2020  o_fit = True..  
-0007b290: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0007b2a0: 206e 6f5f 6669 7420 3d20 4661 6c73 650d   no_fit = False.
-0007b2b0: 0a20 2020 2069 6620 6e6f 5f66 6974 3a0d  .    if no_fit:.
-0007b2c0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
-0007b2d0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
-0007b2e0: 646f 6e27 7420 6669 7420 7468 6520 6d6f  don't fit the mo
-0007b2f0: 6465 6c20 6275 7420 6a75 7374 2064 6f20  del but just do 
-0007b300: 6372 6f73 735f 7661 6c5f 7072 6564 6963  cross_val_predic
-0007b310: 7420 2323 2323 0d0a 2020 2020 2020 2020  t ####..        
-0007b320: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
-0007b330: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
-0007b340: 2020 2020 2020 2020 2020 2069 6620 7363             if sc
-0007b350: 6f72 696e 6720 3d3d 2027 273a 0d0a 2020  oring == '':..  
-0007b360: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0007b370: 6f72 696e 6720 3d20 276e 6567 5f6d 6561  oring = 'neg_mea
-0007b380: 6e5f 7371 7561 7265 645f 6572 726f 7227  n_squared_error'
-0007b390: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
-0007b3a0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
-0007b3b0: 7473 3d46 4f4c 4453 2c20 7368 7566 666c  ts=FOLDS, shuffl
-0007b3c0: 653d 4661 6c73 6529 0d0a 2020 2020 2020  e=False)..      
-0007b3d0: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
-0007b3e0: 675f 466c 6167 3a0d 0a20 2020 2020 2020  g_Flag:..       
-0007b3f0: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
-0007b400: 2020 2042 6167 6769 6e67 206d 6f64 656c     Bagging model
-0007b410: 7320 6966 2042 6167 6769 6e67 2069 7320  s if Bagging is 
-0007b420: 6368 6f73 656e 2023 2323 230d 0a20 2020  chosen ####..   
-0007b430: 2020 2020 2020 2020 2020 2020 2023 6d6f               #mo
-0007b440: 6465 6c34 203d 2042 6167 6769 6e67 5265  del4 = BaggingRe
-0007b450: 6772 6573 736f 7228 4465 6369 7369 6f6e  gressor(Decision
-0007b460: 5472 6565 5265 6772 6573 736f 7228 7261  TreeRegressor(ra
-0007b470: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
-0007b480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007b490: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-0007b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b4b0: 6e5f 6573 7469 6d61 746f 7273 3d4e 554d  n_estimators=NUM
-0007b4c0: 532c 7261 6e64 6f6d 5f73 7461 7465 3d73  S,random_state=s
-0007b4d0: 6565 6429 0d0a 2020 2020 2020 2020 2020  eed)..          
-0007b4e0: 2020 2020 2020 6d6f 6465 6c34 203d 204c        model4 = L
-0007b4f0: 696e 6561 7253 5652 2829 0d0a 2020 2020  inearSVR()..    
-0007b500: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0007b510: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
-0007b520: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
-0007b530: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
-0007b540: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
-0007b550: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007b560: 2020 2065 7374 696d 6174 6f72 732e 6170     estimators.ap
-0007b570: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
-0007b580: 5227 2c6d 6f64 656c 3429 290d 0a20 2020  R',model4))..   
-0007b590: 2020 2020 2020 2020 2020 2020 2065 7374               est
-0007b5a0: 696d 6174 6f72 5f6c 656e 6774 682e 6170  imator_length.ap
-0007b5b0: 7065 6e64 2831 290d 0a20 2020 2020 2020  pend(1)..       
-0007b5c0: 2020 2020 2065 6c69 6620 426f 6f73 7469       elif Boosti
-0007b5d0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
-0007b5e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007b5f0: 2020 2323 2323 2020 2054 7265 6520 6d6f    ####   Tree mo
-0007b600: 6465 6c73 2069 6620 4c69 6e65 6172 2063  dels if Linear c
-0007b610: 686f 7365 6e20 2323 2323 230d 0a20 2020  hosen #####..   
-0007b620: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0007b630: 656c 3520 3d20 4465 6369 7369 6f6e 5472  el5 = DecisionTr
-0007b640: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
-0007b650: 6f6d 5f73 7461 7465 3d73 6565 642c 6d69  om_state=seed,mi
-0007b660: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-0007b670: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007b680: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
-0007b690: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
-0007b6a0: 6f64 656c 352c 585f 7472 6169 6e2c 795f  odel5,X_train,y_
-0007b6b0: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
-0007b6c0: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
-0007b6d0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0007b6e0: 746f 7273 2e61 7070 656e 6428 2827 4465  tors.append(('De
-0007b6f0: 6369 7369 6f6e 2054 7265 6573 272c 6d6f  cision Trees',mo
-0007b700: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
-0007b710: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007b720: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
-0007b730: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0007b740: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0007b750: 2020 2020 2020 2023 2323 2320 2020 4c69         ####   Li
-0007b760: 6e65 6172 204d 6f64 656c 7320 6966 2042  near Models if B
-0007b770: 6f6f 7374 696e 6720 6973 2063 686f 7365  oosting is chose
-0007b780: 6e20 2323 2323 230d 0a20 2020 2020 2020  n #####..       
-0007b790: 2020 2020 2020 2020 206d 6f64 656c 3620           model6 
-0007b7a0: 3d20 4c61 7373 6f43 5628 616c 7068 6173  = LassoCV(alphas
-0007b7b0: 3d6e 702e 6c6f 6773 7061 6365 282d 352c  =np.logspace(-5,
-0007b7c0: 2d31 2c32 3029 2c20 6376 3d73 6376 2c72  -1,20), cv=scv,r
-0007b7d0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
-0007b7e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007b7f0: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
-0007b800: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
-0007b810: 6f64 656c 362c 585f 7472 6169 6e2c 795f  odel6,X_train,y_
-0007b820: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
-0007b830: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
-0007b840: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0007b850: 746f 7273 2e61 7070 656e 6428 2827 4c61  tors.append(('La
-0007b860: 7373 6f43 5620 5265 6775 6c61 7269 7a61  ssoCV Regulariza
-0007b870: 7469 6f6e 272c 6d6f 6465 6c36 2929 0d0a  tion',model6))..
-0007b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b890: 6573 7469 6d61 746f 725f 6c65 6e67 7468  estimator_length
-0007b8a0: 2e61 7070 656e 6428 3129 0d0a 2020 2020  .append(1)..    
-0007b8b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0007b8c0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
-0007b8d0: 203d 206c 656e 2843 6f75 6e74 6572 2879   = len(Counter(y
-0007b8e0: 5f74 7261 696e 2929 0d0a 2020 2020 2020  _train))..      
-0007b8f0: 2020 2020 2020 6966 206e 5f63 6c61 7373        if n_class
-0007b900: 6573 203e 2032 3a0d 0a20 2020 2020 2020  es > 2:..       
-0007b910: 2020 2020 2020 2020 2023 2323 2320 496e           #### In
-0007b920: 206d 756c 7469 2d63 6c61 7373 2073 6574   multi-class set
-0007b930: 7469 6e67 2c20 6974 206d 616b 6573 2073  ting, it makes s
-0007b940: 656e 7365 2074 6f20 7475 726e 2069 7420  ense to turn it 
-0007b950: 696e 746f 2062 696e 6172 7920 636c 6173  into binary clas
-0007b960: 7320 696e 2073 7461 6765 2d31 0d0a 2020  s in stage-1..  
-0007b970: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0007b980: 2323 2049 6e20 7374 6167 6520 322c 2061  ## In stage 2, a
-0007b990: 2063 6f6d 706c 6578 206d 6f64 656c 2077   complex model w
-0007b9a0: 696c 6c20 7461 6b65 2074 6865 2069 6e70  ill take the inp
-0007b9b0: 7574 7320 6f66 2074 6869 7320 6d6f 6465  uts of this mode
-0007b9c0: 6c20 616e 6420 7472 7920 746f 2070 7265  l and try to pre
-0007b9d0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
-0007b9e0: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
-0007b9f0: 203d 2066 696e 645f 7261 7265 5f63 6c61   = find_rare_cla
-0007ba00: 7373 2879 5f74 7261 696e 290d 0a20 2020  ss(y_train)..   
-0007ba10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007ba20: 7261 7265 5f63 6c61 7373 203d 3d20 303a  rare_class == 0:
-0007ba30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007ba40: 2020 2020 2020 6d61 6a6f 7269 7479 5f63        majority_c
-0007ba50: 6c61 7373 203d 2031 0d0a 2020 2020 2020  lass = 1..      
-0007ba60: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0007ba70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007ba80: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
-0007ba90: 6173 7320 3d20 300d 0a20 2020 2020 2020  ass = 0..       
-0007baa0: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
-0007bab0: 203d 2079 5f74 7261 696e 2e6d 6170 286c   = y_train.map(l
-0007bac0: 616d 6264 6120 783a 2072 6172 655f 636c  ambda x: rare_cl
-0007bad0: 6173 7320 6966 2078 3d3d 7261 7265 5f63  ass if x==rare_c
-0007bae0: 6c61 7373 2065 6c73 6520 6d61 6a6f 7269  lass else majori
-0007baf0: 7479 5f63 6c61 7373 290d 0a20 2020 2020  ty_class)..     
-0007bb00: 2020 2020 2020 2069 6620 7363 6f72 696e         if scorin
-0007bb10: 6720 3d3d 2027 273a 0d0a 2020 2020 2020  g == '':..      
-0007bb20: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-0007bb30: 6720 3d20 2761 6363 7572 6163 7927 0d0a  g = 'accuracy'..
-0007bb40: 2020 2020 2020 2020 2020 2020 7363 7620              scv 
-0007bb50: 3d20 5374 7261 7469 6669 6564 4b46 6f6c  = StratifiedKFol
-0007bb60: 6428 6e5f 7370 6c69 7473 3d46 4f4c 4453  d(n_splits=FOLDS
-0007bb70: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
-0007bb80: 6565 642c 2073 6875 6666 6c65 3d54 7275  eed, shuffle=Tru
-0007bb90: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0007bba0: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
-0007bbb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0007bbc0: 2020 2023 2323 2320 2020 4c69 6e65 6172     ####   Linear
-0007bbd0: 204d 6f64 656c 7320 6966 2042 6f6f 7374   Models if Boost
-0007bbe0: 696e 6720 6973 2063 686f 7365 6e20 2323  ing is chosen ##
-0007bbf0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0007bc00: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
-0007bc10: 6e65 6172 4469 7363 7269 6d69 6e61 6e74  nearDiscriminant
-0007bc20: 416e 616c 7973 6973 2829 0d0a 2020 2020  Analysis()..    
-0007bc30: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0007bc40: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
-0007bc50: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
-0007bc60: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
-0007bc70: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
-0007bc80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0007bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bca0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0007bcb0: 6574 686f 643d 2770 7265 6469 6374 5f70  ethod='predict_p
-0007bcc0: 726f 6261 2729 0d0a 2020 2020 2020 2020  roba')..        
-0007bcd0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007bce0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
-0007bcf0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
-0007bd00: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
-0007bd10: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007bd20: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007bd30: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007bd40: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
-0007bd50: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
-0007bd60: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-0007bd70: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0007bd80: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
-0007bd90: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
-0007bda0: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
-0007bdb0: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
-0007bdc0: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
-0007bdd0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
-0007bde0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
-0007bdf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0007be00: 6573 756c 7473 203d 2063 726f 7373 5f76  esults = cross_v
-0007be10: 616c 5f70 7265 6469 6374 286d 6f64 656c  al_predict(model
-0007be20: 362c 585f 7472 6169 6e2c 795f 7472 6169  6,X_train,y_trai
-0007be30: 6e2c 2063 763d 7363 762c 6e5f 6a6f 6273  n, cv=scv,n_jobs
-0007be40: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
-0007be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be70: 2020 6d65 7468 6f64 3d27 7072 6564 6963    method='predic
-0007be80: 745f 7072 6f62 6127 290d 0a20 2020 2020  t_proba')..     
-0007be90: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007bea0: 6174 6f72 732e 6170 7065 6e64 2828 2744  ators.append(('D
-0007beb0: 6563 6973 696f 6e20 5472 6565 272c 6d6f  ecision Tree',mo
-0007bec0: 6465 6c36 2929 0d0a 2020 2020 2020 2020  del6))..        
-0007bed0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007bee0: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
-0007bef0: 7265 7375 6c74 732e 7368 6170 655b 315d  results.shape[1]
-0007bf00: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0007bf10: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007bf20: 2020 2020 2020 2323 2323 2323 2020 2020        ######    
-0007bf30: 4e61 6976 6520 4261 7965 7320 6d6f 6465  Naive Bayes mode
-0007bf40: 6c73 2069 6620 4261 6767 696e 6720 6973  ls if Bagging is
-0007bf50: 2063 686f 7365 6e20 2323 2323 0d0a 2020   chosen ####..  
-0007bf60: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007bf70: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
-0007bf80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007bf90: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-0007bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bfb0: 2020 2020 6d6f 6465 6c37 203d 2047 6175      model7 = Gau
-0007bfc0: 7373 6961 6e4e 4228 290d 0a20 2020 2020  ssianNB()..     
-0007bfd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0007bfe0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0007bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c000: 6d6f 6465 6c37 203d 2044 6563 6973 696f  model7 = Decisio
-0007c010: 6e54 7265 6543 6c61 7373 6966 6965 7228  nTreeClassifier(
-0007c020: 6d69 6e5f 7361 6d70 6c65 735f 6c65 6166  min_samples_leaf
-0007c030: 3d32 290d 0a20 2020 2020 2020 2020 2020  =2)..           
-0007c040: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0007c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c060: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-0007c070: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0007c080: 6465 6c37 203d 204d 756c 7469 6e6f 6d69  del7 = Multinomi
-0007c090: 616c 4e42 2829 0d0a 2020 2020 2020 2020  alNB()..        
-0007c0a0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0007c0b0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0007c0c0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0007c0d0: 656c 3720 3d20 4465 6369 7369 6f6e 5472  el7 = DecisionTr
-0007c0e0: 6565 436c 6173 7369 6669 6572 286d 696e  eeClassifier(min
-0007c0f0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-0007c100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c110: 2020 7265 7375 6c74 7320 3d20 6372 6f73    results = cros
-0007c120: 735f 7661 6c5f 7072 6564 6963 7428 6d6f  s_val_predict(mo
-0007c130: 6465 6c37 2c58 5f74 7261 696e 2c79 5f74  del7,X_train,y_t
-0007c140: 7261 696e 2c20 6376 3d73 6376 2c6e 5f6a  rain, cv=scv,n_j
-0007c150: 6f62 733d 2d31 2c0d 0a20 2020 2020 2020  obs=-1,..       
-0007c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c180: 2020 2020 206d 6574 686f 643d 2770 7265       method='pre
-0007c190: 6469 6374 5f70 726f 6261 2729 0d0a 2020  dict_proba')..  
-0007c1a0: 2020 2020 2020 2020 2020 2020 2020 6573                es
-0007c1b0: 7469 6d61 746f 7273 2e61 7070 656e 6428  timators.append(
-0007c1c0: 2827 4e61 6976 6520 4261 7965 7327 2c6d  ('Naive Bayes',m
-0007c1d0: 6f64 656c 3729 290d 0a20 2020 2020 2020  odel7))..       
-0007c1e0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007c1f0: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
-0007c200: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
-0007c210: 5d29 0d0a 2020 2020 656c 7365 3a0d 0a20  ])..    else:.. 
-0007c220: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
-0007c230: 2069 7320 7768 6572 6520 796f 7520 6669   is where you fi
-0007c240: 7420 7468 6520 6d6f 6465 6c20 616e 6420  t the model and 
-0007c250: 7468 656e 2070 7265 6469 6374 2023 2323  then predict ###
-0007c260: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
-0007c270: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-0007c280: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-0007c290: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
-0007c2a0: 7269 6e67 203d 3d20 2727 3a0d 0a20 2020  ring == '':..   
-0007c2b0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-0007c2c0: 7269 6e67 203d 2027 6e65 675f 6d65 616e  ring = 'neg_mean
-0007c2d0: 5f73 7175 6172 6564 5f65 7272 6f72 270d  _squared_error'.
-0007c2e0: 0a20 2020 2020 2020 2020 2020 2073 6376  .            scv
-0007c2f0: 203d 204b 466f 6c64 286e 5f73 706c 6974   = KFold(n_split
-0007c300: 733d 464f 4c44 532c 2073 6875 6666 6c65  s=FOLDS, shuffle
-0007c310: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-0007c320: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
-0007c330: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
-0007c340: 2020 2020 2020 2020 2323 2323 2323 2020          ######  
-0007c350: 2020 4261 6767 696e 6720 6d6f 6465 6c73    Bagging models
-0007c360: 2069 6620 4261 6767 696e 6720 6973 2063   if Bagging is c
-0007c370: 686f 7365 6e20 2323 2323 0d0a 2020 2020  hosen ####..    
-0007c380: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
-0007c390: 656c 3420 3d20 4261 6767 696e 6752 6567  el4 = BaggingReg
-0007c3a0: 7265 7373 6f72 2844 6563 6973 696f 6e54  ressor(DecisionT
-0007c3b0: 7265 6552 6567 7265 7373 6f72 2872 616e  reeRegressor(ran
-0007c3c0: 646f 6d5f 7374 6174 653d 7365 6564 292c  dom_state=seed),
-0007c3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c3e0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-0007c3f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0007c400: 5f65 7374 696d 6174 6f72 733d 4e55 4d53  _estimators=NUMS
-0007c410: 2c72 616e 646f 6d5f 7374 6174 653d 7365  ,random_state=se
-0007c420: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
-0007c430: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
-0007c440: 6e65 6172 5356 5228 290d 0a20 2020 2020  nearSVR()..     
-0007c450: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0007c460: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
-0007c470: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
-0007c480: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
-0007c490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c4a0: 2020 6573 7469 6d61 746f 7273 2e61 7070    estimators.app
-0007c4b0: 656e 6428 2827 4c69 6e65 6172 5f53 5652  end(('Linear_SVR
-0007c4c0: 272c 6d6f 6465 6c34 2929 0d0a 2020 2020  ',model4))..    
-0007c4d0: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-0007c4e0: 6d61 746f 725f 6c65 6e67 7468 2e61 7070  mator_length.app
-0007c4f0: 656e 6428 3129 0d0a 2020 2020 2020 2020  end(1)..        
-0007c500: 2020 2020 656c 6966 2042 6f6f 7374 696e      elif Boostin
-0007c510: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
-0007c520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007c530: 2023 2323 2320 2020 5472 6565 206d 6f64   ####   Tree mod
-0007c540: 656c 7320 6966 204c 696e 6561 7220 6368  els if Linear ch
-0007c550: 6f73 656e 2023 2323 2323 0d0a 2020 2020  osen #####..    
-0007c560: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0007c570: 6c35 203d 2044 6563 6973 696f 6e54 7265  l5 = DecisionTre
-0007c580: 6552 6567 7265 7373 6f72 2872 616e 646f  eRegressor(rando
-0007c590: 6d5f 7374 6174 653d 7365 6564 2c6d 696e  m_state=seed,min
-0007c5a0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
-0007c5b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c5c0: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
-0007c5d0: 6c35 2e66 6974 2858 5f74 7261 696e 2c79  l5.fit(X_train,y
-0007c5e0: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
-0007c5f0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-0007c600: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007c610: 6f72 732e 6170 7065 6e64 2828 2744 6563  ors.append(('Dec
-0007c620: 6973 696f 6e20 5472 6565 7327 2c6d 6f64  ision Trees',mod
-0007c630: 656c 3529 290d 0a20 2020 2020 2020 2020  el5))..         
-0007c640: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0007c650: 5f6c 656e 6774 682e 6170 7065 6e64 2831  _length.append(1
-0007c660: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0007c670: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007c680: 2020 2020 2020 2323 2323 2020 204c 696e        ####   Lin
-0007c690: 6561 7220 4d6f 6465 6c73 2069 6620 426f  ear Models if Bo
-0007c6a0: 6f73 7469 6e67 2069 7320 6368 6f73 656e  osting is chosen
-0007c6b0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
-0007c6c0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
-0007c6d0: 204c 6173 736f 4356 2861 6c70 6861 733d   LassoCV(alphas=
-0007c6e0: 6e70 2e6c 6f67 7370 6163 6528 2d35 2c2d  np.logspace(-5,-
-0007c6f0: 312c 3230 292c 2063 763d 7363 762c 7261  1,20), cv=scv,ra
-0007c700: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
-0007c710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007c720: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
-0007c730: 6c36 2e66 6974 2858 5f74 7261 696e 2c79  l6.fit(X_train,y
-0007c740: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
-0007c750: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
-0007c760: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007c770: 6f72 732e 6170 7065 6e64 2828 274c 6173  ors.append(('Las
-0007c780: 736f 4356 2052 6567 756c 6172 697a 6174  soCV Regularizat
-0007c790: 696f 6e27 2c6d 6f64 656c 3629 290d 0a20  ion',model6)).. 
-0007c7a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0007c7b0: 7374 696d 6174 6f72 5f6c 656e 6774 682e  stimator_length.
-0007c7c0: 6170 7065 6e64 2831 290d 0a20 2020 2020  append(1)..     
-0007c7d0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0007c7e0: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
-0007c7f0: 3d20 6c65 6e28 436f 756e 7465 7228 795f  = len(Counter(y_
-0007c800: 7472 6169 6e29 290d 0a20 2020 2020 2020  train))..       
-0007c810: 2020 2020 2069 6620 6e5f 636c 6173 7365       if n_classe
-0007c820: 7320 3e20 323a 0d0a 2020 2020 2020 2020  s > 2:..        
-0007c830: 2020 2020 2020 2020 2323 2323 2049 6e20          #### In 
-0007c840: 6d75 6c74 692d 636c 6173 7320 7365 7474  multi-class sett
-0007c850: 696e 672c 2069 7420 6d61 6b65 7320 7365  ing, it makes se
-0007c860: 6e73 6520 746f 2074 7572 6e20 6974 2069  nse to turn it i
-0007c870: 6e74 6f20 6269 6e61 7279 2063 6c61 7373  nto binary class
-0007c880: 2069 6e20 7374 6167 652d 310d 0a20 2020   in stage-1..   
-0007c890: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0007c8a0: 2320 496e 2073 7461 6765 2032 2c20 6120  # In stage 2, a 
-0007c8b0: 636f 6d70 6c65 7820 6d6f 6465 6c20 7769  complex model wi
-0007c8c0: 6c6c 2074 616b 6520 7468 6520 696e 7075  ll take the inpu
-0007c8d0: 7473 206f 6620 7468 6973 206d 6f64 656c  ts of this model
-0007c8e0: 2061 6e64 2074 7279 2074 6f20 7072 6564   and try to pred
-0007c8f0: 6963 740d 0a20 2020 2020 2020 2020 2020  ict..           
-0007c900: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
-0007c910: 3d20 6669 6e64 5f72 6172 655f 636c 6173  = find_rare_clas
-0007c920: 7328 795f 7472 6169 6e29 0d0a 2020 2020  s(y_train)..    
-0007c930: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0007c940: 6172 655f 636c 6173 7320 3d3d 2030 3a0d  are_class == 0:.
-0007c950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007c960: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
-0007c970: 6173 7320 3d20 310d 0a20 2020 2020 2020  ass = 1..       
-0007c980: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0007c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c9a0: 2020 2020 6d61 6a6f 7269 7479 5f63 6c61      majority_cla
-0007c9b0: 7373 203d 2030 0d0a 2020 2020 2020 2020  ss = 0..        
-0007c9c0: 2020 2020 2020 2020 795f 7472 6169 6e20          y_train 
-0007c9d0: 3d20 795f 7472 6169 6e2e 6d61 7028 6c61  = y_train.map(la
-0007c9e0: 6d62 6461 2078 3a20 7261 7265 5f63 6c61  mbda x: rare_cla
-0007c9f0: 7373 2069 6620 783d 3d72 6172 655f 636c  ss if x==rare_cl
-0007ca00: 6173 7320 656c 7365 206d 616a 6f72 6974  ass else majorit
-0007ca10: 795f 636c 6173 7329 0d0a 2020 2020 2020  y_class)..      
-0007ca20: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
-0007ca30: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
-0007ca40: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
-0007ca50: 203d 2027 6163 6375 7261 6379 270d 0a20   = 'accuracy'.. 
-0007ca60: 2020 2020 2020 2020 2020 2073 6376 203d             scv =
-0007ca70: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-0007ca80: 286e 5f73 706c 6974 733d 464f 4c44 532c  (n_splits=FOLDS,
-0007ca90: 2072 616e 646f 6d5f 7374 6174 653d 7365   random_state=se
-0007caa0: 6564 2c20 7368 7566 666c 653d 5472 7565  ed, shuffle=True
-0007cab0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0007cac0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
-0007cad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007cae0: 2020 2323 2323 2020 204c 696e 6561 7220    ####   Linear 
-0007caf0: 4d6f 6465 6c73 2069 6620 426f 6f73 7469  Models if Boosti
-0007cb00: 6e67 2069 7320 6368 6f73 656e 2023 2323  ng is chosen ###
-0007cb10: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0007cb20: 2020 2020 6d6f 6465 6c34 203d 204c 696e      model4 = Lin
-0007cb30: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
-0007cb40: 6e61 6c79 7369 7328 290d 0a20 2020 2020  nalysis()..     
-0007cb50: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0007cb60: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
-0007cb70: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
-0007cb80: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
-0007cb90: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
-0007cba0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
-0007cbb0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
-0007cbc0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
-0007cbd0: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
-0007cbe0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007cbf0: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007cc00: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007cc10: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
-0007cc20: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
-0007cc30: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
-0007cc40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0007cc50: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
-0007cc60: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
-0007cc70: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
-0007cc80: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
-0007cc90: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
-0007cca0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
-0007ccb0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
-0007ccc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0007ccd0: 6573 756c 7473 203d 206d 6f64 656c 362e  esults = model6.
-0007cce0: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
-0007ccf0: 6169 6e29 2e70 7265 6469 6374 5f70 726f  ain).predict_pro
-0007cd00: 6261 2858 5f74 6573 7429 0d0a 2020 2020  ba(X_test)..    
-0007cd10: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-0007cd20: 6d61 746f 7273 2e61 7070 656e 6428 2827  mators.append(('
-0007cd30: 4465 6369 7369 6f6e 2054 7265 6527 2c6d  Decision Tree',m
-0007cd40: 6f64 656c 3629 290d 0a20 2020 2020 2020  odel6))..       
-0007cd50: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0007cd60: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
-0007cd70: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
-0007cd80: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0007cd90: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0007cda0: 2020 2020 2020 2023 2323 2323 2320 2020         ######   
-0007cdb0: 204e 6169 7665 2042 6179 6573 206d 6f64   Naive Bayes mod
-0007cdc0: 656c 7320 6966 2042 6167 6769 6e67 2069  els if Bagging i
-0007cdd0: 7320 6368 6f73 656e 2023 2323 230d 0a20  s chosen ####.. 
-0007cde0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0007cdf0: 6620 6e5f 636c 6173 7365 7320 3c3d 2032  f n_classes <= 2
-0007ce00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0007ce10: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0007ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ce30: 2020 2020 206d 6f64 656c 3720 3d20 4761       model7 = Ga
-0007ce40: 7573 7369 616e 4e42 2829 0d0a 2020 2020  ussianNB()..    
-0007ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ce60: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0007ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ce80: 206d 6f64 656c 3720 3d20 4465 6369 7369   model7 = Decisi
-0007ce90: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
-0007cea0: 286d 696e 5f73 616d 706c 6573 5f6c 6561  (min_samples_lea
-0007ceb0: 663d 3229 0d0a 2020 2020 2020 2020 2020  f=2)..          
-0007cec0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0007ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cee0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0007cef0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0007cf00: 6f64 656c 3720 3d20 4d75 6c74 696e 6f6d  odel7 = Multinom
-0007cf10: 6961 6c4e 4228 290d 0a20 2020 2020 2020  ialNB()..       
-0007cf20: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0007cf30: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0007cf40: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0007cf50: 6465 6c37 203d 2044 6563 6973 696f 6e54  del7 = DecisionT
-0007cf60: 7265 6543 6c61 7373 6966 6965 7228 6d69  reeClassifier(mi
-0007cf70: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
-0007cf80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007cf90: 2020 2072 6573 756c 7473 203d 206d 6f64     results = mod
-0007cfa0: 656c 372e 6669 7428 585f 7472 6169 6e2c  el7.fit(X_train,
-0007cfb0: 795f 7472 6169 6e29 2e70 7265 6469 6374  y_train).predict
-0007cfc0: 5f70 726f 6261 2858 5f74 6573 7429 0d0a  _proba(X_test)..
-0007cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cfe0: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
-0007cff0: 6428 2827 4e61 6976 6520 4261 7965 7327  d(('Naive Bayes'
-0007d000: 2c6d 6f64 656c 3729 290d 0a20 2020 2020  ,model7))..     
-0007d010: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0007d020: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
-0007d030: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
-0007d040: 5b31 5d29 0d0a 2020 2020 2373 7461 636b  [1])..    #stack
-0007d050: 7320 3d20 6e70 2e63 5f5b 7265 7375 6c74  s = np.c_[result
-0007d060: 7331 2c72 6573 756c 7473 322c 7265 7375  s1,results2,resu
-0007d070: 6c74 7333 5d0d 0a20 2020 2065 7374 696d  lts3]..    estim
-0007d080: 6174 6f72 735f 6c69 7374 203d 205b 2874  ators_list = [(t
-0007d090: 7570 6c65 735b 305d 2c74 7570 6c65 735b  uples[0],tuples[
-0007d0a0: 315d 2920 666f 7220 7475 706c 6573 2069  1]) for tuples i
-0007d0b0: 6e20 6573 7469 6d61 746f 7273 5d0d 0a20  n estimators].. 
-0007d0c0: 2020 2065 7374 696d 6174 6f72 5f6e 616d     estimator_nam
-0007d0d0: 6573 203d 205b 7475 706c 6573 5b30 5d20  es = [tuples[0] 
-0007d0e0: 666f 7220 7475 706c 6573 2069 6e20 6573  for tuples in es
-0007d0f0: 7469 6d61 746f 7273 5d0d 0a20 2020 2023  timators]..    #
-0007d100: 2323 2320 4865 7265 2069 7320 7768 6572  ### Here is wher
-0007d110: 6520 7765 2063 6f6e 736f 6c69 6461 7465  e we consolidate
-0007d120: 2074 6865 2065 7374 696d 6174 6f72 206e   the estimator n
-0007d130: 616d 6573 2061 6e64 2074 6865 6972 2072  ames and their r
-0007d140: 6573 756c 7473 2069 6e74 6f20 6f6e 6520  esults into one 
-0007d150: 636f 6d6d 6f6e 206c 6973 7420 2323 230d  common list ###.
-0007d160: 0a20 2020 206c 7320 3d20 5b5d 0d0a 2020  .    ls = []..  
-0007d170: 2020 666f 7220 782c 7920 696e 2064 6963    for x,y in dic
-0007d180: 7428 7a69 7028 6573 7469 6d61 746f 725f  t(zip(estimator_
-0007d190: 6e61 6d65 732c 6573 7469 6d61 746f 725f  names,estimator_
-0007d1a0: 6c65 6e67 7468 2929 2e69 7465 6d73 2829  length)).items()
-0007d1b0: 3a0d 0a20 2020 2020 2020 2065 6c73 203d  :..        els =
-0007d1c0: 205b 782b 275f 272b 7374 7228 6561 6368   [x+'_'+str(each
-0007d1d0: 7929 2066 6f72 2065 6163 6879 2069 6e20  y) for eachy in 
-0007d1e0: 7261 6e67 6528 7929 5d0d 0a20 2020 2020  range(y)]..     
-0007d1f0: 2020 206c 7320 2b3d 2065 6c73 0d0a 2020     ls += els..  
-0007d200: 2020 6966 2076 6572 626f 7365 203d 3d20    if verbose == 
-0007d210: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
-0007d220: 7428 2720 2020 2054 696d 6520 7461 6b65  t('    Time take
-0007d230: 6e20 666f 7220 5374 6163 6b69 6e67 3a20  n for Stacking: 
-0007d240: 2530 2e31 6620 7365 636f 6e64 7327 2025  %0.1f seconds' %
-0007d250: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
-0007d260: 7274 5f74 696d 6529 290d 0a20 2020 2072  rt_time))..    r
-0007d270: 6574 7572 6e20 6c73 2c20 7265 7375 6c74  eturn ls, result
-0007d280: 730d 0a23 2323 2323 2323 2323 2323 2323  s..#############
-0007d290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007d2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007d2b0: 2323 2323 2323 2323 2323 2323 0d0a 0000  ############....
-0007d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007d410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007d480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007d490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007d550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0007d610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0007d620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-0007d810: 2f61 7574 6f76 696d 6c2f 5472 616e 7366  /autoviml/Transf
-0007d820: 6f72 6d5f 4b4d 5f46 6561 7475 7265 732e  orm_KM_Features.
-0007d830: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
-0007d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0007d870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0007d880: 3030 3135 3332 3300 3030 3030 3030 3030  0015323.00000000
-0007d890: 3030 3000 3032 3135 3333 0020 3000 0000  000.021533. 0...
-0007d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007a610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007a670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007a680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007a690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007a750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a800: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0007a810: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0007a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aa00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+0007aa10: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
+0007aa20: 4c5f 5374 6163 6b69 6e67 2e70 7900 0000  L_Stacking.py...
+0007aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aa60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0007aa70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0007aa80: 3030 3236 3237 3600 3030 3030 3030 3030  0026276.00000000
+0007aa90: 3030 3000 3032 3034 3735 0020 3000 0000  000.020475. 0...
+0007aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007ab50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ac00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0007ac10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+0007ac20: 7920 6173 206e 700d 0a69 6d70 6f72 7420  y as np..import 
+0007ac30: 7761 726e 696e 6773 0d0a 7761 726e 696e  warnings..warnin
+0007ac40: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
+0007ac50: 7328 2269 676e 6f72 6522 290d 0a66 726f  s("ignore")..fro
+0007ac60: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+0007ac70: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+0007ac80: 2063 726f 7373 5f76 616c 5f73 636f 7265   cross_val_score
+0007ac90: 2c20 5374 7261 7469 6669 6564 5368 7566  , StratifiedShuf
+0007aca0: 666c 6553 706c 6974 2c20 5469 6d65 5365  fleSplit, TimeSe
+0007acb0: 7269 6573 5370 6c69 740d 0a66 726f 6d20  riesSplit..from 
+0007acc0: 736b 6c65 6172 6e2e 6d6f 6465 6c5f 7365  sklearn.model_se
+0007acd0: 6c65 6374 696f 6e20 696d 706f 7274 2053  lection import S
+0007ace0: 6875 6666 6c65 5370 6c69 742c 5374 7261  huffleSplit,Stra
+0007acf0: 7469 6669 6564 4b46 6f6c 642c 4b46 6f6c  tifiedKFold,KFol
+0007ad00: 640d 0a66 726f 6d20 736b 6c65 6172 6e2e  d..from sklearn.
+0007ad10: 6469 7363 7269 6d69 6e61 6e74 5f61 6e61  discriminant_ana
+0007ad20: 6c79 7369 7320 696d 706f 7274 204c 696e  lysis import Lin
+0007ad30: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
+0007ad40: 6e61 6c79 7369 730d 0a66 726f 6d20 736b  nalysis..from sk
+0007ad50: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
+0007ad60: 6d70 6f72 7420 4261 6767 696e 6752 6567  mport BaggingReg
+0007ad70: 7265 7373 6f72 2c20 5261 6e64 6f6d 466f  ressor, RandomFo
+0007ad80: 7265 7374 436c 6173 7369 6669 6572 0d0a  restClassifier..
+0007ad90: 6672 6f6d 2073 6b6c 6561 726e 2e65 6e73  from sklearn.ens
+0007ada0: 656d 626c 6520 696d 706f 7274 2045 7874  emble import Ext
+0007adb0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
+0007adc0: 722c 4578 7472 6154 7265 6573 5265 6772  r,ExtraTreesRegr
+0007add0: 6573 736f 720d 0a66 726f 6d20 736b 6c65  essor..from skle
+0007ade0: 6172 6e2e 6c69 6e65 6172 5f6d 6f64 656c  arn.linear_model
+0007adf0: 2069 6d70 6f72 7420 4c6f 6769 7374 6963   import Logistic
+0007ae00: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
+0007ae10: 6e65 6172 5265 6772 6573 7369 6f6e 2c20  nearRegression, 
+0007ae20: 5269 6467 650d 0a66 726f 6d20 736b 6c65  Ridge..from skle
+0007ae30: 6172 6e2e 7376 6d20 696d 706f 7274 204c  arn.svm import L
+0007ae40: 696e 6561 7253 5643 2c20 5356 522c 204c  inearSVC, SVR, L
+0007ae50: 696e 6561 7253 5652 0d0a 6672 6f6d 2073  inearSVR..from s
+0007ae60: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
+0007ae70: 696d 706f 7274 2041 6461 426f 6f73 7443  import AdaBoostC
+0007ae80: 6c61 7373 6966 6965 722c 2041 6461 426f  lassifier, AdaBo
+0007ae90: 6f73 7452 6567 7265 7373 6f72 0d0a 6672  ostRegressor..fr
+0007aea0: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
+0007aeb0: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
+0007aec0: 7265 6552 6567 7265 7373 6f72 2c20 4465  reeRegressor, De
+0007aed0: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
+0007aee0: 6669 6572 0d0a 6672 6f6d 2073 6b6c 6561  fier..from sklea
+0007aef0: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
+0007af00: 696d 706f 7274 204c 6173 736f 2c20 4c61  import Lasso, La
+0007af10: 7373 6f43 562c 2052 6964 6765 2c20 5269  ssoCV, Ridge, Ri
+0007af20: 6467 6543 562c 204c 6173 736f 4c61 7273  dgeCV, LassoLars
+0007af30: 4356 0d0a 6672 6f6d 2073 6b6c 6561 726e  CV..from sklearn
+0007af40: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
+0007af50: 2069 6d70 6f72 7420 6372 6f73 735f 7661   import cross_va
+0007af60: 6c5f 7072 6564 6963 740d 0a66 726f 6d20  l_predict..from 
+0007af70: 736b 6c65 6172 6e2e 656e 7365 6d62 6c65  sklearn.ensemble
+0007af80: 2069 6d70 6f72 7420 4578 7472 6154 7265   import ExtraTre
+0007af90: 6573 5265 6772 6573 736f 722c 2045 7874  esRegressor, Ext
+0007afa0: 7261 5472 6565 7343 6c61 7373 6966 6965  raTreesClassifie
+0007afb0: 720d 0a66 726f 6d20 736b 6c65 6172 6e2e  r..from sklearn.
+0007afc0: 6c69 6e65 6172 5f6d 6f64 656c 2069 6d70  linear_model imp
+0007afd0: 6f72 7420 4c6f 6769 7374 6963 5265 6772  ort LogisticRegr
+0007afe0: 6573 7369 6f6e 2c20 4c6f 6769 7374 6963  ession, Logistic
+0007aff0: 5265 6772 6573 7369 6f6e 4356 2c20 4c69  RegressionCV, Li
+0007b000: 6e65 6172 5265 6772 6573 7369 6f6e 0d0a  nearRegression..
+0007b010: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+0007b020: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+0007b030: 6f72 7420 4772 6964 5365 6172 6368 4356  ort GridSearchCV
+0007b040: 2c53 7472 6174 6966 6965 6453 6875 6666  ,StratifiedShuff
+0007b050: 6c65 5370 6c69 742c 5368 7566 666c 6553  leSplit,ShuffleS
+0007b060: 706c 6974 0d0a 6672 6f6d 2073 6b6c 6561  plit..from sklea
+0007b070: 726e 2e6e 6169 7665 5f62 6179 6573 2069  rn.naive_bayes i
+0007b080: 6d70 6f72 7420 4761 7573 7369 616e 4e42  mport GaussianNB
+0007b090: 2c20 4d75 6c74 696e 6f6d 6961 6c4e 420d  , MultinomialNB.
+0007b0a0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7472  .from sklearn.tr
+0007b0b0: 6565 2069 6d70 6f72 7420 4465 6369 7369  ee import Decisi
+0007b0c0: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+0007b0d0: 0d0a 696d 706f 7274 2074 696d 650d 0a69  ..import time..i
+0007b0e0: 6d70 6f72 7420 7064 620d 0a69 6d70 6f72  mport pdb..impor
+0007b0f0: 7420 7469 6d65 0d0a 696d 706f 7274 2063  t time..import c
+0007b100: 6f70 790d 0a66 726f 6d20 636f 6c6c 6563  opy..from collec
+0007b110: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
+0007b120: 6e74 6572 0d0a 6672 6f6d 2063 6f6c 6c65  nter..from colle
+0007b130: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0007b140: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
+0007b150: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0007b160: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
+0007b170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b1a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b1b0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+0007b1c0: 6566 2066 696e 645f 7261 7265 5f63 6c61  ef find_rare_cla
+0007b1d0: 7373 2863 6c61 7373 6573 2c20 7665 7262  ss(classes, verb
+0007b1e0: 6f73 653d 3029 3a0d 0a20 2020 2023 2323  ose=0):..    ###
+0007b1f0: 2323 2323 2323 2050 7269 6e74 2074 6865  ###### Print the
+0007b200: 2025 2063 6f75 6e74 206f 6620 6561 6368   % count of each
+0007b210: 2063 6c61 7373 2069 6e20 6120 5461 7267   class in a Targ
+0007b220: 6574 2076 6172 6961 626c 6520 2023 2323  et variable  ###
+0007b230: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
+0007b240: 2057 6f72 6b73 206f 6e20 4d75 6c74 6920   Works on Multi 
+0007b250: 436c 6173 7320 746f 6f2e 2050 7269 6e74  Class too. Print
+0007b260: 7320 636c 6173 7320 7065 7263 656e 7461  s class percenta
+0007b270: 6765 7320 636f 756e 7420 6f66 2074 6172  ges count of tar
+0007b280: 6765 7420 7661 7269 6162 6c65 2e0d 0a20  get variable... 
+0007b290: 2020 2049 7420 7265 7475 726e 7320 7468     It returns th
+0007b2a0: 6520 6e61 6d65 206f 6620 7468 6520 5261  e name of the Ra
+0007b2b0: 7265 2063 6c61 7373 2028 7468 6520 6f6e  re class (the on
+0007b2c0: 6520 7769 7468 2074 6865 206d 696e 696d  e with the minim
+0007b2d0: 756d 2063 6c61 7373 206d 656d 6265 7220  um class member 
+0007b2e0: 636f 756e 7429 2e0d 0a20 2020 2054 6869  count)...    Thi
+0007b2f0: 7320 6361 6e20 616c 736f 2062 6520 6865  s can also be he
+0007b300: 6c70 6675 6c20 696e 2075 7369 6e67 2069  lpful in using i
+0007b310: 7420 6173 2070 6f73 5f6c 6162 656c 2069  t as pos_label i
+0007b320: 6e20 4269 6e61 7279 2061 6e64 204d 756c  n Binary and Mul
+0007b330: 7469 2043 6c61 7373 2070 726f 626c 656d  ti Class problem
+0007b340: 732e 0d0a 2020 2020 2222 220d 0a20 2020  s...    """..   
+0007b350: 2063 6f75 6e74 7320 3d20 4f72 6465 7265   counts = Ordere
+0007b360: 6444 6963 7428 436f 756e 7465 7228 636c  dDict(Counter(cl
+0007b370: 6173 7365 7329 290d 0a20 2020 2074 6f74  asses))..    tot
+0007b380: 616c 203d 2073 756d 2863 6f75 6e74 732e  al = sum(counts.
+0007b390: 7661 6c75 6573 2829 290d 0a20 2020 2069  values())..    i
+0007b3a0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
+0007b3b0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0007b3c0: 2043 6c61 7373 2020 2d3e 2043 6f75 6e74   Class  -> Count
+0007b3d0: 7320 2d3e 2050 6572 6365 6e74 2729 0d0a  s -> Percent')..
+0007b3e0: 2020 2020 2020 2020 666f 7220 636c 7320          for cls 
+0007b3f0: 696e 2063 6f75 6e74 732e 6b65 7973 2829  in counts.keys()
+0007b400: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0007b410: 7269 6e74 2822 2536 733a 2025 2037 6420  rint("%6s: % 7d 
+0007b420: 202d 3e20 2025 2035 2e31 6625 2522 2025   ->  % 5.1f%%" %
+0007b430: 2028 636c 732c 2063 6f75 6e74 735b 636c   (cls, counts[cl
+0007b440: 735d 2c20 636f 756e 7473 5b63 6c73 5d2f  s], counts[cls]/
+0007b450: 746f 7461 6c2a 3130 3029 290d 0a20 2020  total*100))..   
+0007b460: 2069 6620 7479 7065 2870 642e 5365 7269   if type(pd.Seri
+0007b470: 6573 2863 6f75 6e74 7329 2e69 6478 6d69  es(counts).idxmi
+0007b480: 6e28 2929 3d3d 7374 723a 0d0a 2020 2020  n())==str:..    
+0007b490: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+0007b4a0: 7269 6573 2863 6f75 6e74 7329 2e69 6478  ries(counts).idx
+0007b4b0: 6d69 6e28 290d 0a20 2020 2065 6c73 653a  min()..    else:
+0007b4c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0007b4d0: 2069 6e74 2870 642e 5365 7269 6573 2863   int(pd.Series(c
+0007b4e0: 6f75 6e74 7329 2e69 6478 6d69 6e28 2929  ounts).idxmin())
+0007b4f0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0007b500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007b540: 2323 0d0a 6465 6620 5175 6963 6b4d 4c5f  ##..def QuickML_
+0007b550: 5374 6163 6b69 6e67 2858 5f74 7261 696e  Stacking(X_train
+0007b560: 2c20 795f 7472 6169 6e2c 2058 5f74 6573  , y_train, X_tes
+0007b570: 743d 2727 2c20 6d6f 6465 6c74 7970 653d  t='', modeltype=
+0007b580: 2752 6567 7265 7373 696f 6e27 2c42 6f6f  'Regression',Boo
+0007b590: 7374 696e 675f 466c 6167 3d46 616c 7365  sting_Flag=False
+0007b5a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0007b5b0: 2020 2020 2020 2073 636f 7269 6e67 3d27         scoring='
+0007b5c0: 272c 2076 6572 626f 7365 3d30 293a 0d0a  ', verbose=0):..
+0007b5d0: 2020 2020 2222 220d 0a20 2020 2051 7569      """..    Qui
+0007b5e0: 636b 6c79 2062 7569 6c64 2053 7461 636b  ckly build Stack
+0007b5f0: 7320 6f66 206d 756c 7469 706c 6520 6d6f  s of multiple mo
+0007b600: 6465 6c20 7265 7375 6c74 730d 0a20 2020  del results..   
+0007b610: 2049 6e70 7574 206d 7573 7420 6265 2061   Input must be a
+0007b620: 2063 6c65 616e 2064 6174 6120 7365 7420   clean data set 
+0007b630: 286f 6e6c 7920 6e75 6d65 7269 6320 7661  (only numeric va
+0007b640: 7269 6162 6c65 732c 206e 6f20 6361 7465  riables, no cate
+0007b650: 676f 7269 6361 6c20 6f72 2073 7472 696e  gorical or strin
+0007b660: 6720 7661 7269 6162 6c65 7329 2e0d 0a20  g variables)... 
+0007b670: 2020 2022 2222 0d0a 2020 2020 585f 7472     """..    X_tr
+0007b680: 6169 6e20 3d20 636f 7079 2e64 6565 7063  ain = copy.deepc
+0007b690: 6f70 7928 585f 7472 6169 6e29 0d0a 2020  opy(X_train)..  
+0007b6a0: 2020 585f 7465 7374 203d 2063 6f70 792e    X_test = copy.
+0007b6b0: 6465 6570 636f 7079 2858 5f74 6573 7429  deepcopy(X_test)
+0007b6c0: 0d0a 2020 2020 795f 7472 6169 6e20 3d20  ..    y_train = 
+0007b6d0: 636f 7079 2e64 6565 7063 6f70 7928 795f  copy.deepcopy(y_
+0007b6e0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
+0007b6f0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+0007b700: 6d65 2829 0d0a 2020 2020 7365 6564 203d  me()..    seed =
+0007b710: 2039 390d 0a20 2020 2069 6620 6c65 6e28   99..    if len(
+0007b720: 585f 7472 6169 6e29 203c 3d20 3130 3030  X_train) <= 1000
+0007b730: 3030 206f 7220 585f 7472 6169 6e2e 7368  00 or X_train.sh
+0007b740: 6170 655b 315d 203c 2035 303a 0d0a 2020  ape[1] < 50:..  
+0007b750: 2020 2020 2020 4e55 4d53 203d 2031 3030        NUMS = 100
+0007b760: 0d0a 2020 2020 2020 2020 464f 4c44 5320  ..        FOLDS 
+0007b770: 3d20 350d 0a20 2020 2065 6c73 653a 0d0a  = 5..    else:..
+0007b780: 2020 2020 2020 2020 4e55 4d53 203d 2032          NUMS = 2
+0007b790: 3030 0d0a 2020 2020 2020 2020 464f 4c44  00..        FOLD
+0007b7a0: 5320 3d20 3130 0d0a 2020 2020 2323 2063  S = 10..    ## c
+0007b7b0: 7265 6174 6520 5374 6163 6b69 6e67 206d  reate Stacking m
+0007b7c0: 6f64 656c 730d 0a20 2020 2065 7374 696d  odels..    estim
+0007b7d0: 6174 6f72 7320 3d20 5b5d 0d0a 2020 2020  ators = []..    
+0007b7e0: 2323 2320 5468 6973 206b 6565 7073 2074  ### This keeps t
+0007b7f0: 7261 636b 7320 6f66 2074 6865 206e 756d  racks of the num
+0007b800: 6265 7220 6f66 2070 7265 6469 6374 5f70  ber of predict_p
+0007b810: 726f 6261 2063 6f6c 756d 6e73 2067 656e  roba columns gen
+0007b820: 6572 6174 6564 2062 7920 6561 6368 206d  erated by each m
+0007b830: 6f64 656c 2023 2323 230d 0a20 2020 2065  odel ####..    e
+0007b840: 7374 696d 6174 6f72 5f6c 656e 6774 6820  stimator_length 
+0007b850: 3d20 5b5d 0d0a 2020 2020 6966 2069 7369  = []..    if isi
+0007b860: 6e73 7461 6e63 6528 585f 7465 7374 2c20  nstance(X_test, 
+0007b870: 7374 7229 3a0d 0a20 2020 2020 2020 206e  str):..        n
+0007b880: 6f5f 6669 7420 3d20 5472 7565 0d0a 2020  o_fit = True..  
+0007b890: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0007b8a0: 206e 6f5f 6669 7420 3d20 4661 6c73 650d   no_fit = False.
+0007b8b0: 0a20 2020 2069 6620 6e6f 5f66 6974 3a0d  .    if no_fit:.
+0007b8c0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
+0007b8d0: 6973 2069 7320 7768 6572 6520 796f 7520  is is where you 
+0007b8e0: 646f 6e27 7420 6669 7420 7468 6520 6d6f  don't fit the mo
+0007b8f0: 6465 6c20 6275 7420 6a75 7374 2064 6f20  del but just do 
+0007b900: 6372 6f73 735f 7661 6c5f 7072 6564 6963  cross_val_predic
+0007b910: 7420 2323 2323 0d0a 2020 2020 2020 2020  t ####..        
+0007b920: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+0007b930: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+0007b940: 2020 2020 2020 2020 2020 2069 6620 7363             if sc
+0007b950: 6f72 696e 6720 3d3d 2027 273a 0d0a 2020  oring == '':..  
+0007b960: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0007b970: 6f72 696e 6720 3d20 276e 6567 5f6d 6561  oring = 'neg_mea
+0007b980: 6e5f 7371 7561 7265 645f 6572 726f 7227  n_squared_error'
+0007b990: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
+0007b9a0: 7620 3d20 4b46 6f6c 6428 6e5f 7370 6c69  v = KFold(n_spli
+0007b9b0: 7473 3d46 4f4c 4453 2c20 7368 7566 666c  ts=FOLDS, shuffl
+0007b9c0: 653d 4661 6c73 6529 0d0a 2020 2020 2020  e=False)..      
+0007b9d0: 2020 2020 2020 6966 2042 6f6f 7374 696e        if Boostin
+0007b9e0: 675f 466c 6167 3a0d 0a20 2020 2020 2020  g_Flag:..       
+0007b9f0: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+0007ba00: 2020 2042 6167 6769 6e67 206d 6f64 656c     Bagging model
+0007ba10: 7320 6966 2042 6167 6769 6e67 2069 7320  s if Bagging is 
+0007ba20: 6368 6f73 656e 2023 2323 230d 0a20 2020  chosen ####..   
+0007ba30: 2020 2020 2020 2020 2020 2020 2023 6d6f               #mo
+0007ba40: 6465 6c34 203d 2042 6167 6769 6e67 5265  del4 = BaggingRe
+0007ba50: 6772 6573 736f 7228 4465 6369 7369 6f6e  gressor(Decision
+0007ba60: 5472 6565 5265 6772 6573 736f 7228 7261  TreeRegressor(ra
+0007ba70: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
+0007ba80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0007ba90: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+0007baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bab0: 6e5f 6573 7469 6d61 746f 7273 3d4e 554d  n_estimators=NUM
+0007bac0: 532c 7261 6e64 6f6d 5f73 7461 7465 3d73  S,random_state=s
+0007bad0: 6565 6429 0d0a 2020 2020 2020 2020 2020  eed)..          
+0007bae0: 2020 2020 2020 6d6f 6465 6c34 203d 204c        model4 = L
+0007baf0: 696e 6561 7253 5652 2829 0d0a 2020 2020  inearSVR()..    
+0007bb00: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0007bb10: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
+0007bb20: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
+0007bb30: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
+0007bb40: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
+0007bb50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007bb60: 2020 2065 7374 696d 6174 6f72 732e 6170     estimators.ap
+0007bb70: 7065 6e64 2828 274c 696e 6561 725f 5356  pend(('Linear_SV
+0007bb80: 5227 2c6d 6f64 656c 3429 290d 0a20 2020  R',model4))..   
+0007bb90: 2020 2020 2020 2020 2020 2020 2065 7374               est
+0007bba0: 696d 6174 6f72 5f6c 656e 6774 682e 6170  imator_length.ap
+0007bbb0: 7065 6e64 2831 290d 0a20 2020 2020 2020  pend(1)..       
+0007bbc0: 2020 2020 2065 6c69 6620 426f 6f73 7469       elif Boosti
+0007bbd0: 6e67 5f46 6c61 6720 6973 204e 6f6e 653a  ng_Flag is None:
+0007bbe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007bbf0: 2020 2323 2323 2020 2054 7265 6520 6d6f    ####   Tree mo
+0007bc00: 6465 6c73 2069 6620 4c69 6e65 6172 2063  dels if Linear c
+0007bc10: 686f 7365 6e20 2323 2323 230d 0a20 2020  hosen #####..   
+0007bc20: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0007bc30: 656c 3520 3d20 4465 6369 7369 6f6e 5472  el5 = DecisionTr
+0007bc40: 6565 5265 6772 6573 736f 7228 7261 6e64  eeRegressor(rand
+0007bc50: 6f6d 5f73 7461 7465 3d73 6565 642c 6d69  om_state=seed,mi
+0007bc60: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+0007bc70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007bc80: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
+0007bc90: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
+0007bca0: 6f64 656c 352c 585f 7472 6169 6e2c 795f  odel5,X_train,y_
+0007bcb0: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
+0007bcc0: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
+0007bcd0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0007bce0: 746f 7273 2e61 7070 656e 6428 2827 4465  tors.append(('De
+0007bcf0: 6369 7369 6f6e 2054 7265 6573 272c 6d6f  cision Trees',mo
+0007bd00: 6465 6c35 2929 0d0a 2020 2020 2020 2020  del5))..        
+0007bd10: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007bd20: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
+0007bd30: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+0007bd40: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0007bd50: 2020 2020 2020 2023 2323 2320 2020 4c69         ####   Li
+0007bd60: 6e65 6172 204d 6f64 656c 7320 6966 2042  near Models if B
+0007bd70: 6f6f 7374 696e 6720 6973 2063 686f 7365  oosting is chose
+0007bd80: 6e20 2323 2323 230d 0a20 2020 2020 2020  n #####..       
+0007bd90: 2020 2020 2020 2020 206d 6f64 656c 3620           model6 
+0007bda0: 3d20 4c61 7373 6f43 5628 616c 7068 6173  = LassoCV(alphas
+0007bdb0: 3d6e 702e 6c6f 6773 7061 6365 282d 352c  =np.logspace(-5,
+0007bdc0: 2d31 2c32 3029 2c20 6376 3d73 6376 2c72  -1,20), cv=scv,r
+0007bdd0: 616e 646f 6d5f 7374 6174 653d 7365 6564  andom_state=seed
+0007bde0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007bdf0: 2020 2072 6573 756c 7473 203d 2063 726f     results = cro
+0007be00: 7373 5f76 616c 5f70 7265 6469 6374 286d  ss_val_predict(m
+0007be10: 6f64 656c 362c 585f 7472 6169 6e2c 795f  odel6,X_train,y_
+0007be20: 7472 6169 6e2c 2063 763d 7363 762c 6e5f  train, cv=scv,n_
+0007be30: 6a6f 6273 3d2d 3129 0d0a 2020 2020 2020  jobs=-1)..      
+0007be40: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0007be50: 746f 7273 2e61 7070 656e 6428 2827 4c61  tors.append(('La
+0007be60: 7373 6f43 5620 5265 6775 6c61 7269 7a61  ssoCV Regulariza
+0007be70: 7469 6f6e 272c 6d6f 6465 6c36 2929 0d0a  tion',model6))..
+0007be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be90: 6573 7469 6d61 746f 725f 6c65 6e67 7468  estimator_length
+0007bea0: 2e61 7070 656e 6428 3129 0d0a 2020 2020  .append(1)..    
+0007beb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0007bec0: 2020 2020 2020 206e 5f63 6c61 7373 6573         n_classes
+0007bed0: 203d 206c 656e 2843 6f75 6e74 6572 2879   = len(Counter(y
+0007bee0: 5f74 7261 696e 2929 0d0a 2020 2020 2020  _train))..      
+0007bef0: 2020 2020 2020 6966 206e 5f63 6c61 7373        if n_class
+0007bf00: 6573 203e 2032 3a0d 0a20 2020 2020 2020  es > 2:..       
+0007bf10: 2020 2020 2020 2020 2023 2323 2320 496e           #### In
+0007bf20: 206d 756c 7469 2d63 6c61 7373 2073 6574   multi-class set
+0007bf30: 7469 6e67 2c20 6974 206d 616b 6573 2073  ting, it makes s
+0007bf40: 656e 7365 2074 6f20 7475 726e 2069 7420  ense to turn it 
+0007bf50: 696e 746f 2062 696e 6172 7920 636c 6173  into binary clas
+0007bf60: 7320 696e 2073 7461 6765 2d31 0d0a 2020  s in stage-1..  
+0007bf70: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0007bf80: 2323 2049 6e20 7374 6167 6520 322c 2061  ## In stage 2, a
+0007bf90: 2063 6f6d 706c 6578 206d 6f64 656c 2077   complex model w
+0007bfa0: 696c 6c20 7461 6b65 2074 6865 2069 6e70  ill take the inp
+0007bfb0: 7574 7320 6f66 2074 6869 7320 6d6f 6465  uts of this mode
+0007bfc0: 6c20 616e 6420 7472 7920 746f 2070 7265  l and try to pre
+0007bfd0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
+0007bfe0: 2020 2020 2020 7261 7265 5f63 6c61 7373        rare_class
+0007bff0: 203d 2066 696e 645f 7261 7265 5f63 6c61   = find_rare_cla
+0007c000: 7373 2879 5f74 7261 696e 290d 0a20 2020  ss(y_train)..   
+0007c010: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007c020: 7261 7265 5f63 6c61 7373 203d 3d20 303a  rare_class == 0:
+0007c030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c040: 2020 2020 2020 6d61 6a6f 7269 7479 5f63        majority_c
+0007c050: 6c61 7373 203d 2031 0d0a 2020 2020 2020  lass = 1..      
+0007c060: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0007c070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007c080: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
+0007c090: 6173 7320 3d20 300d 0a20 2020 2020 2020  ass = 0..       
+0007c0a0: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
+0007c0b0: 203d 2079 5f74 7261 696e 2e6d 6170 286c   = y_train.map(l
+0007c0c0: 616d 6264 6120 783a 2072 6172 655f 636c  ambda x: rare_cl
+0007c0d0: 6173 7320 6966 2078 3d3d 7261 7265 5f63  ass if x==rare_c
+0007c0e0: 6c61 7373 2065 6c73 6520 6d61 6a6f 7269  lass else majori
+0007c0f0: 7479 5f63 6c61 7373 290d 0a20 2020 2020  ty_class)..     
+0007c100: 2020 2020 2020 2069 6620 7363 6f72 696e         if scorin
+0007c110: 6720 3d3d 2027 273a 0d0a 2020 2020 2020  g == '':..      
+0007c120: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
+0007c130: 6720 3d20 2761 6363 7572 6163 7927 0d0a  g = 'accuracy'..
+0007c140: 2020 2020 2020 2020 2020 2020 7363 7620              scv 
+0007c150: 3d20 5374 7261 7469 6669 6564 4b46 6f6c  = StratifiedKFol
+0007c160: 6428 6e5f 7370 6c69 7473 3d46 4f4c 4453  d(n_splits=FOLDS
+0007c170: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d73  , random_state=s
+0007c180: 6565 642c 2073 6875 6666 6c65 3d54 7275  eed, shuffle=Tru
+0007c190: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0007c1a0: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
+0007c1b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007c1c0: 2020 2023 2323 2320 2020 4c69 6e65 6172     ####   Linear
+0007c1d0: 204d 6f64 656c 7320 6966 2042 6f6f 7374   Models if Boost
+0007c1e0: 696e 6720 6973 2063 686f 7365 6e20 2323  ing is chosen ##
+0007c1f0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0007c200: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
+0007c210: 6e65 6172 4469 7363 7269 6d69 6e61 6e74  nearDiscriminant
+0007c220: 416e 616c 7973 6973 2829 0d0a 2020 2020  Analysis()..    
+0007c230: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0007c240: 6c74 7320 3d20 6372 6f73 735f 7661 6c5f  lts = cross_val_
+0007c250: 7072 6564 6963 7428 6d6f 6465 6c34 2c58  predict(model4,X
+0007c260: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
+0007c270: 6376 3d73 6376 2c6e 5f6a 6f62 733d 2d31  cv=scv,n_jobs=-1
+0007c280: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0007c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c2a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0007c2b0: 6574 686f 643d 2770 7265 6469 6374 5f70  ethod='predict_p
+0007c2c0: 726f 6261 2729 0d0a 2020 2020 2020 2020  roba')..        
+0007c2d0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007c2e0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
+0007c2f0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
+0007c300: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
+0007c310: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007c320: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007c330: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007c340: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+0007c350: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+0007c360: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+0007c370: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0007c380: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
+0007c390: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
+0007c3a0: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
+0007c3b0: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
+0007c3c0: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
+0007c3d0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
+0007c3e0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
+0007c3f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0007c400: 6573 756c 7473 203d 2063 726f 7373 5f76  esults = cross_v
+0007c410: 616c 5f70 7265 6469 6374 286d 6f64 656c  al_predict(model
+0007c420: 362c 585f 7472 6169 6e2c 795f 7472 6169  6,X_train,y_trai
+0007c430: 6e2c 2063 763d 7363 762c 6e5f 6a6f 6273  n, cv=scv,n_jobs
+0007c440: 3d2d 312c 0d0a 2020 2020 2020 2020 2020  =-1,..          
+0007c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c470: 2020 6d65 7468 6f64 3d27 7072 6564 6963    method='predic
+0007c480: 745f 7072 6f62 6127 290d 0a20 2020 2020  t_proba')..     
+0007c490: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007c4a0: 6174 6f72 732e 6170 7065 6e64 2828 2744  ators.append(('D
+0007c4b0: 6563 6973 696f 6e20 5472 6565 272c 6d6f  ecision Tree',mo
+0007c4c0: 6465 6c36 2929 0d0a 2020 2020 2020 2020  del6))..        
+0007c4d0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007c4e0: 725f 6c65 6e67 7468 2e61 7070 656e 6428  r_length.append(
+0007c4f0: 7265 7375 6c74 732e 7368 6170 655b 315d  results.shape[1]
+0007c500: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0007c510: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007c520: 2020 2020 2020 2323 2323 2323 2020 2020        ######    
+0007c530: 4e61 6976 6520 4261 7965 7320 6d6f 6465  Naive Bayes mode
+0007c540: 6c73 2069 6620 4261 6767 696e 6720 6973  ls if Bagging is
+0007c550: 2063 686f 7365 6e20 2323 2323 0d0a 2020   chosen ####..  
+0007c560: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007c570: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
+0007c580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c590: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+0007c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c5b0: 2020 2020 6d6f 6465 6c37 203d 2047 6175      model7 = Gau
+0007c5c0: 7373 6961 6e4e 4228 290d 0a20 2020 2020  ssianNB()..     
+0007c5d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0007c5e0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0007c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c600: 6d6f 6465 6c37 203d 2044 6563 6973 696f  model7 = Decisio
+0007c610: 6e54 7265 6543 6c61 7373 6966 6965 7228  nTreeClassifier(
+0007c620: 6d69 6e5f 7361 6d70 6c65 735f 6c65 6166  min_samples_leaf
+0007c630: 3d32 290d 0a20 2020 2020 2020 2020 2020  =2)..           
+0007c640: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0007c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c660: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0007c670: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0007c680: 6465 6c37 203d 204d 756c 7469 6e6f 6d69  del7 = Multinomi
+0007c690: 616c 4e42 2829 0d0a 2020 2020 2020 2020  alNB()..        
+0007c6a0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0007c6b0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+0007c6c0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0007c6d0: 656c 3720 3d20 4465 6369 7369 6f6e 5472  el7 = DecisionTr
+0007c6e0: 6565 436c 6173 7369 6669 6572 286d 696e  eeClassifier(min
+0007c6f0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+0007c700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c710: 2020 7265 7375 6c74 7320 3d20 6372 6f73    results = cros
+0007c720: 735f 7661 6c5f 7072 6564 6963 7428 6d6f  s_val_predict(mo
+0007c730: 6465 6c37 2c58 5f74 7261 696e 2c79 5f74  del7,X_train,y_t
+0007c740: 7261 696e 2c20 6376 3d73 6376 2c6e 5f6a  rain, cv=scv,n_j
+0007c750: 6f62 733d 2d31 2c0d 0a20 2020 2020 2020  obs=-1,..       
+0007c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c780: 2020 2020 206d 6574 686f 643d 2770 7265       method='pre
+0007c790: 6469 6374 5f70 726f 6261 2729 0d0a 2020  dict_proba')..  
+0007c7a0: 2020 2020 2020 2020 2020 2020 2020 6573                es
+0007c7b0: 7469 6d61 746f 7273 2e61 7070 656e 6428  timators.append(
+0007c7c0: 2827 4e61 6976 6520 4261 7965 7327 2c6d  ('Naive Bayes',m
+0007c7d0: 6f64 656c 3729 290d 0a20 2020 2020 2020  odel7))..       
+0007c7e0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007c7f0: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
+0007c800: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
+0007c810: 5d29 0d0a 2020 2020 656c 7365 3a0d 0a20  ])..    else:.. 
+0007c820: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
+0007c830: 2069 7320 7768 6572 6520 796f 7520 6669   is where you fi
+0007c840: 7420 7468 6520 6d6f 6465 6c20 616e 6420  t the model and 
+0007c850: 7468 656e 2070 7265 6469 6374 2023 2323  then predict ###
+0007c860: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
+0007c870: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+0007c880: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+0007c890: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
+0007c8a0: 7269 6e67 203d 3d20 2727 3a0d 0a20 2020  ring == '':..   
+0007c8b0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0007c8c0: 7269 6e67 203d 2027 6e65 675f 6d65 616e  ring = 'neg_mean
+0007c8d0: 5f73 7175 6172 6564 5f65 7272 6f72 270d  _squared_error'.
+0007c8e0: 0a20 2020 2020 2020 2020 2020 2073 6376  .            scv
+0007c8f0: 203d 204b 466f 6c64 286e 5f73 706c 6974   = KFold(n_split
+0007c900: 733d 464f 4c44 532c 2073 6875 6666 6c65  s=FOLDS, shuffle
+0007c910: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+0007c920: 2020 2020 2069 6620 426f 6f73 7469 6e67       if Boosting
+0007c930: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
+0007c940: 2020 2020 2020 2020 2323 2323 2323 2020          ######  
+0007c950: 2020 4261 6767 696e 6720 6d6f 6465 6c73    Bagging models
+0007c960: 2069 6620 4261 6767 696e 6720 6973 2063   if Bagging is c
+0007c970: 686f 7365 6e20 2323 2323 0d0a 2020 2020  hosen ####..    
+0007c980: 2020 2020 2020 2020 2020 2020 236d 6f64              #mod
+0007c990: 656c 3420 3d20 4261 6767 696e 6752 6567  el4 = BaggingReg
+0007c9a0: 7265 7373 6f72 2844 6563 6973 696f 6e54  ressor(DecisionT
+0007c9b0: 7265 6552 6567 7265 7373 6f72 2872 616e  reeRegressor(ran
+0007c9c0: 646f 6d5f 7374 6174 653d 7365 6564 292c  dom_state=seed),
+0007c9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007c9e0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+0007c9f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0007ca00: 5f65 7374 696d 6174 6f72 733d 4e55 4d53  _estimators=NUMS
+0007ca10: 2c72 616e 646f 6d5f 7374 6174 653d 7365  ,random_state=se
+0007ca20: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+0007ca30: 2020 2020 206d 6f64 656c 3420 3d20 4c69       model4 = Li
+0007ca40: 6e65 6172 5356 5228 290d 0a20 2020 2020  nearSVR()..     
+0007ca50: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0007ca60: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
+0007ca70: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
+0007ca80: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
+0007ca90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007caa0: 2020 6573 7469 6d61 746f 7273 2e61 7070    estimators.app
+0007cab0: 656e 6428 2827 4c69 6e65 6172 5f53 5652  end(('Linear_SVR
+0007cac0: 272c 6d6f 6465 6c34 2929 0d0a 2020 2020  ',model4))..    
+0007cad0: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+0007cae0: 6d61 746f 725f 6c65 6e67 7468 2e61 7070  mator_length.app
+0007caf0: 656e 6428 3129 0d0a 2020 2020 2020 2020  end(1)..        
+0007cb00: 2020 2020 656c 6966 2042 6f6f 7374 696e      elif Boostin
+0007cb10: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
+0007cb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007cb30: 2023 2323 2320 2020 5472 6565 206d 6f64   ####   Tree mod
+0007cb40: 656c 7320 6966 204c 696e 6561 7220 6368  els if Linear ch
+0007cb50: 6f73 656e 2023 2323 2323 0d0a 2020 2020  osen #####..    
+0007cb60: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0007cb70: 6c35 203d 2044 6563 6973 696f 6e54 7265  l5 = DecisionTre
+0007cb80: 6552 6567 7265 7373 6f72 2872 616e 646f  eRegressor(rando
+0007cb90: 6d5f 7374 6174 653d 7365 6564 2c6d 696e  m_state=seed,min
+0007cba0: 5f73 616d 706c 6573 5f6c 6561 663d 3229  _samples_leaf=2)
+0007cbb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007cbc0: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
+0007cbd0: 6c35 2e66 6974 2858 5f74 7261 696e 2c79  l5.fit(X_train,y
+0007cbe0: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
+0007cbf0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+0007cc00: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007cc10: 6f72 732e 6170 7065 6e64 2828 2744 6563  ors.append(('Dec
+0007cc20: 6973 696f 6e20 5472 6565 7327 2c6d 6f64  ision Trees',mod
+0007cc30: 656c 3529 290d 0a20 2020 2020 2020 2020  el5))..         
+0007cc40: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+0007cc50: 5f6c 656e 6774 682e 6170 7065 6e64 2831  _length.append(1
+0007cc60: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0007cc70: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007cc80: 2020 2020 2020 2323 2323 2020 204c 696e        ####   Lin
+0007cc90: 6561 7220 4d6f 6465 6c73 2069 6620 426f  ear Models if Bo
+0007cca0: 6f73 7469 6e67 2069 7320 6368 6f73 656e  osting is chosen
+0007ccb0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+0007ccc0: 2020 2020 2020 2020 6d6f 6465 6c36 203d          model6 =
+0007ccd0: 204c 6173 736f 4356 2861 6c70 6861 733d   LassoCV(alphas=
+0007cce0: 6e70 2e6c 6f67 7370 6163 6528 2d35 2c2d  np.logspace(-5,-
+0007ccf0: 312c 3230 292c 2063 763d 7363 762c 7261  1,20), cv=scv,ra
+0007cd00: 6e64 6f6d 5f73 7461 7465 3d73 6565 6429  ndom_state=seed)
+0007cd10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007cd20: 2020 7265 7375 6c74 7320 3d20 6d6f 6465    results = mode
+0007cd30: 6c36 2e66 6974 2858 5f74 7261 696e 2c79  l6.fit(X_train,y
+0007cd40: 5f74 7261 696e 292e 7072 6564 6963 7428  _train).predict(
+0007cd50: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+0007cd60: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007cd70: 6f72 732e 6170 7065 6e64 2828 274c 6173  ors.append(('Las
+0007cd80: 736f 4356 2052 6567 756c 6172 697a 6174  soCV Regularizat
+0007cd90: 696f 6e27 2c6d 6f64 656c 3629 290d 0a20  ion',model6)).. 
+0007cda0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0007cdb0: 7374 696d 6174 6f72 5f6c 656e 6774 682e  stimator_length.
+0007cdc0: 6170 7065 6e64 2831 290d 0a20 2020 2020  append(1)..     
+0007cdd0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0007cde0: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
+0007cdf0: 3d20 6c65 6e28 436f 756e 7465 7228 795f  = len(Counter(y_
+0007ce00: 7472 6169 6e29 290d 0a20 2020 2020 2020  train))..       
+0007ce10: 2020 2020 2069 6620 6e5f 636c 6173 7365       if n_classe
+0007ce20: 7320 3e20 323a 0d0a 2020 2020 2020 2020  s > 2:..        
+0007ce30: 2020 2020 2020 2020 2323 2323 2049 6e20          #### In 
+0007ce40: 6d75 6c74 692d 636c 6173 7320 7365 7474  multi-class sett
+0007ce50: 696e 672c 2069 7420 6d61 6b65 7320 7365  ing, it makes se
+0007ce60: 6e73 6520 746f 2074 7572 6e20 6974 2069  nse to turn it i
+0007ce70: 6e74 6f20 6269 6e61 7279 2063 6c61 7373  nto binary class
+0007ce80: 2069 6e20 7374 6167 652d 310d 0a20 2020   in stage-1..   
+0007ce90: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0007cea0: 2320 496e 2073 7461 6765 2032 2c20 6120  # In stage 2, a 
+0007ceb0: 636f 6d70 6c65 7820 6d6f 6465 6c20 7769  complex model wi
+0007cec0: 6c6c 2074 616b 6520 7468 6520 696e 7075  ll take the inpu
+0007ced0: 7473 206f 6620 7468 6973 206d 6f64 656c  ts of this model
+0007cee0: 2061 6e64 2074 7279 2074 6f20 7072 6564   and try to pred
+0007cef0: 6963 740d 0a20 2020 2020 2020 2020 2020  ict..           
+0007cf00: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
+0007cf10: 3d20 6669 6e64 5f72 6172 655f 636c 6173  = find_rare_clas
+0007cf20: 7328 795f 7472 6169 6e29 0d0a 2020 2020  s(y_train)..    
+0007cf30: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0007cf40: 6172 655f 636c 6173 7320 3d3d 2030 3a0d  are_class == 0:.
+0007cf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007cf60: 2020 2020 206d 616a 6f72 6974 795f 636c       majority_cl
+0007cf70: 6173 7320 3d20 310d 0a20 2020 2020 2020  ass = 1..       
+0007cf80: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0007cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cfa0: 2020 2020 6d61 6a6f 7269 7479 5f63 6c61      majority_cla
+0007cfb0: 7373 203d 2030 0d0a 2020 2020 2020 2020  ss = 0..        
+0007cfc0: 2020 2020 2020 2020 795f 7472 6169 6e20          y_train 
+0007cfd0: 3d20 795f 7472 6169 6e2e 6d61 7028 6c61  = y_train.map(la
+0007cfe0: 6d62 6461 2078 3a20 7261 7265 5f63 6c61  mbda x: rare_cla
+0007cff0: 7373 2069 6620 783d 3d72 6172 655f 636c  ss if x==rare_cl
+0007d000: 6173 7320 656c 7365 206d 616a 6f72 6974  ass else majorit
+0007d010: 795f 636c 6173 7329 0d0a 2020 2020 2020  y_class)..      
+0007d020: 2020 2020 2020 6966 2073 636f 7269 6e67        if scoring
+0007d030: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
+0007d040: 2020 2020 2020 2020 2073 636f 7269 6e67           scoring
+0007d050: 203d 2027 6163 6375 7261 6379 270d 0a20   = 'accuracy'.. 
+0007d060: 2020 2020 2020 2020 2020 2073 6376 203d             scv =
+0007d070: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+0007d080: 286e 5f73 706c 6974 733d 464f 4c44 532c  (n_splits=FOLDS,
+0007d090: 2072 616e 646f 6d5f 7374 6174 653d 7365   random_state=se
+0007d0a0: 6564 2c20 7368 7566 666c 653d 5472 7565  ed, shuffle=True
+0007d0b0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0007d0c0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
+0007d0d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007d0e0: 2020 2323 2323 2020 204c 696e 6561 7220    ####   Linear 
+0007d0f0: 4d6f 6465 6c73 2069 6620 426f 6f73 7469  Models if Boosti
+0007d100: 6e67 2069 7320 6368 6f73 656e 2023 2323  ng is chosen ###
+0007d110: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0007d120: 2020 2020 6d6f 6465 6c34 203d 204c 696e      model4 = Lin
+0007d130: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
+0007d140: 6e61 6c79 7369 7328 290d 0a20 2020 2020  nalysis()..     
+0007d150: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0007d160: 7473 203d 206d 6f64 656c 342e 6669 7428  ts = model4.fit(
+0007d170: 585f 7472 6169 6e2c 795f 7472 6169 6e29  X_train,y_train)
+0007d180: 2e70 7265 6469 6374 5f70 726f 6261 2858  .predict_proba(X
+0007d190: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
+0007d1a0: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+0007d1b0: 7273 2e61 7070 656e 6428 2827 4c69 6e65  rs.append(('Line
+0007d1c0: 6172 2044 6973 6372 696d 696e 616e 7427  ar Discriminant'
+0007d1d0: 2c6d 6f64 656c 3429 290d 0a20 2020 2020  ,model4))..     
+0007d1e0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007d1f0: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007d200: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007d210: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+0007d220: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+0007d230: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+0007d240: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0007d250: 2323 2320 2020 5472 6565 206d 6f64 656c  ###   Tree model
+0007d260: 7320 6966 204c 696e 6561 7220 6368 6f73  s if Linear chos
+0007d270: 656e 2023 2323 2323 0d0a 2020 2020 2020  en #####..      
+0007d280: 2020 2020 2020 2020 2020 6d6f 6465 6c36            model6
+0007d290: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
+0007d2a0: 6c61 7373 6966 6965 7228 6d69 6e5f 7361  lassifier(min_sa
+0007d2b0: 6d70 6c65 735f 6c65 6166 3d32 290d 0a20  mples_leaf=2).. 
+0007d2c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0007d2d0: 6573 756c 7473 203d 206d 6f64 656c 362e  esults = model6.
+0007d2e0: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
+0007d2f0: 6169 6e29 2e70 7265 6469 6374 5f70 726f  ain).predict_pro
+0007d300: 6261 2858 5f74 6573 7429 0d0a 2020 2020  ba(X_test)..    
+0007d310: 2020 2020 2020 2020 2020 2020 6573 7469              esti
+0007d320: 6d61 746f 7273 2e61 7070 656e 6428 2827  mators.append(('
+0007d330: 4465 6369 7369 6f6e 2054 7265 6527 2c6d  Decision Tree',m
+0007d340: 6f64 656c 3629 290d 0a20 2020 2020 2020  odel6))..       
+0007d350: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0007d360: 6f72 5f6c 656e 6774 682e 6170 7065 6e64  or_length.append
+0007d370: 2872 6573 756c 7473 2e73 6861 7065 5b31  (results.shape[1
+0007d380: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0007d390: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0007d3a0: 2020 2020 2020 2023 2323 2323 2320 2020         ######   
+0007d3b0: 204e 6169 7665 2042 6179 6573 206d 6f64   Naive Bayes mod
+0007d3c0: 656c 7320 6966 2042 6167 6769 6e67 2069  els if Bagging i
+0007d3d0: 7320 6368 6f73 656e 2023 2323 230d 0a20  s chosen ####.. 
+0007d3e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0007d3f0: 6620 6e5f 636c 6173 7365 7320 3c3d 2032  f n_classes <= 2
+0007d400: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007d410: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0007d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d430: 2020 2020 206d 6f64 656c 3720 3d20 4761       model7 = Ga
+0007d440: 7573 7369 616e 4e42 2829 0d0a 2020 2020  ussianNB()..    
+0007d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d460: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0007d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d480: 206d 6f64 656c 3720 3d20 4465 6369 7369   model7 = Decisi
+0007d490: 6f6e 5472 6565 436c 6173 7369 6669 6572  onTreeClassifier
+0007d4a0: 286d 696e 5f73 616d 706c 6573 5f6c 6561  (min_samples_lea
+0007d4b0: 663d 3229 0d0a 2020 2020 2020 2020 2020  f=2)..          
+0007d4c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0007d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d4e0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+0007d4f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0007d500: 6f64 656c 3720 3d20 4d75 6c74 696e 6f6d  odel7 = Multinom
+0007d510: 6961 6c4e 4228 290d 0a20 2020 2020 2020  ialNB()..       
+0007d520: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0007d530: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0007d540: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0007d550: 6465 6c37 203d 2044 6563 6973 696f 6e54  del7 = DecisionT
+0007d560: 7265 6543 6c61 7373 6966 6965 7228 6d69  reeClassifier(mi
+0007d570: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+0007d580: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007d590: 2020 2072 6573 756c 7473 203d 206d 6f64     results = mod
+0007d5a0: 656c 372e 6669 7428 585f 7472 6169 6e2c  el7.fit(X_train,
+0007d5b0: 795f 7472 6169 6e29 2e70 7265 6469 6374  y_train).predict
+0007d5c0: 5f70 726f 6261 2858 5f74 6573 7429 0d0a  _proba(X_test)..
+0007d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d5e0: 6573 7469 6d61 746f 7273 2e61 7070 656e  estimators.appen
+0007d5f0: 6428 2827 4e61 6976 6520 4261 7965 7327  d(('Naive Bayes'
+0007d600: 2c6d 6f64 656c 3729 290d 0a20 2020 2020  ,model7))..     
+0007d610: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0007d620: 6174 6f72 5f6c 656e 6774 682e 6170 7065  ator_length.appe
+0007d630: 6e64 2872 6573 756c 7473 2e73 6861 7065  nd(results.shape
+0007d640: 5b31 5d29 0d0a 2020 2020 2373 7461 636b  [1])..    #stack
+0007d650: 7320 3d20 6e70 2e63 5f5b 7265 7375 6c74  s = np.c_[result
+0007d660: 7331 2c72 6573 756c 7473 322c 7265 7375  s1,results2,resu
+0007d670: 6c74 7333 5d0d 0a20 2020 2065 7374 696d  lts3]..    estim
+0007d680: 6174 6f72 735f 6c69 7374 203d 205b 2874  ators_list = [(t
+0007d690: 7570 6c65 735b 305d 2c74 7570 6c65 735b  uples[0],tuples[
+0007d6a0: 315d 2920 666f 7220 7475 706c 6573 2069  1]) for tuples i
+0007d6b0: 6e20 6573 7469 6d61 746f 7273 5d0d 0a20  n estimators].. 
+0007d6c0: 2020 2065 7374 696d 6174 6f72 5f6e 616d     estimator_nam
+0007d6d0: 6573 203d 205b 7475 706c 6573 5b30 5d20  es = [tuples[0] 
+0007d6e0: 666f 7220 7475 706c 6573 2069 6e20 6573  for tuples in es
+0007d6f0: 7469 6d61 746f 7273 5d0d 0a20 2020 2023  timators]..    #
+0007d700: 2323 2320 4865 7265 2069 7320 7768 6572  ### Here is wher
+0007d710: 6520 7765 2063 6f6e 736f 6c69 6461 7465  e we consolidate
+0007d720: 2074 6865 2065 7374 696d 6174 6f72 206e   the estimator n
+0007d730: 616d 6573 2061 6e64 2074 6865 6972 2072  ames and their r
+0007d740: 6573 756c 7473 2069 6e74 6f20 6f6e 6520  esults into one 
+0007d750: 636f 6d6d 6f6e 206c 6973 7420 2323 230d  common list ###.
+0007d760: 0a20 2020 206c 7320 3d20 5b5d 0d0a 2020  .    ls = []..  
+0007d770: 2020 666f 7220 782c 7920 696e 2064 6963    for x,y in dic
+0007d780: 7428 7a69 7028 6573 7469 6d61 746f 725f  t(zip(estimator_
+0007d790: 6e61 6d65 732c 6573 7469 6d61 746f 725f  names,estimator_
+0007d7a0: 6c65 6e67 7468 2929 2e69 7465 6d73 2829  length)).items()
+0007d7b0: 3a0d 0a20 2020 2020 2020 2065 6c73 203d  :..        els =
+0007d7c0: 205b 782b 275f 272b 7374 7228 6561 6368   [x+'_'+str(each
+0007d7d0: 7929 2066 6f72 2065 6163 6879 2069 6e20  y) for eachy in 
+0007d7e0: 7261 6e67 6528 7929 5d0d 0a20 2020 2020  range(y)]..     
+0007d7f0: 2020 206c 7320 2b3d 2065 6c73 0d0a 2020     ls += els..  
+0007d800: 2020 6966 2076 6572 626f 7365 203d 3d20    if verbose == 
+0007d810: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
+0007d820: 7428 2720 2020 2054 696d 6520 7461 6b65  t('    Time take
+0007d830: 6e20 666f 7220 5374 6163 6b69 6e67 3a20  n for Stacking: 
+0007d840: 2530 2e31 6620 7365 636f 6e64 7327 2025  %0.1f seconds' %
+0007d850: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+0007d860: 7274 5f74 696d 6529 290d 0a20 2020 2072  rt_time))..    r
+0007d870: 6574 7572 6e20 6c73 2c20 7265 7375 6c74  eturn ls, result
+0007d880: 730d 0a23 2323 2323 2323 2323 2323 2323  s..#############
+0007d890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007d8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0007d8b0: 2323 2323 2323 2323 2323 2323 0d0a 0000  ############....
 0007d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007d900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007d920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007d950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007d940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007d950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007da00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0007da10: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-0007da20: 7320 6173 2070 640d 0a66 726f 6d20 736b  s as pd..from sk
-0007da30: 6c65 6172 6e2e 636c 7573 7465 7220 696d  learn.cluster im
-0007da40: 706f 7274 204b 4d65 616e 730d 0a69 6d70  port KMeans..imp
-0007da50: 6f72 7420 736b 6c65 6172 6e0d 0a69 6d70  ort sklearn..imp
-0007da60: 6f72 7420 7363 6970 790d 0a0d 0a63 6c61  ort scipy....cla
-0007da70: 7373 204b 4d65 616e 7346 6561 7475 7269  ss KMeansFeaturi
-0007da80: 7a65 723a 0d0a 2020 2020 2222 2254 7261  zer:..    """Tra
-0007da90: 6e73 666f 726d 7320 6e75 6d65 7269 6320  nsforms numeric 
-0007daa0: 6461 7461 2069 6e74 6f20 6b2d 6d65 616e  data into k-mean
-0007dab0: 7320 636c 7573 7465 7220 6d65 6d62 6572  s cluster member
-0007dac0: 7368 6970 732e 0d0a 2020 2020 4672 6f6d  ships...    From
-0007dad0: 2074 6865 2046 6561 7475 7265 2045 6e67   the Feature Eng
-0007dae0: 696e 6565 7269 6e67 2042 6f6f 6b20 6279  ineering Book by
-0007daf0: 2041 6c69 6365 205a 6865 6e67 0d0a 2020   Alice Zheng..  
-0007db00: 2020 6874 7470 733a 2f2f 6769 7468 7562    https://github
-0007db10: 2e63 6f6d 2f61 6c69 6365 7a68 656e 672f  .com/alicezheng/
-0007db20: 6665 6174 7572 652d 656e 6769 6e65 6572  feature-engineer
-0007db30: 696e 672d 626f 6f6b 2f62 6c6f 622f 6d61  ing-book/blob/ma
-0007db40: 7374 6572 2f6b 6d65 616e 735f 6665 6174  ster/kmeans_feat
-0007db50: 7572 697a 6572 2e70 790d 0a20 2020 2054  urizer.py..    T
-0007db60: 6869 7320 7472 616e 7366 6f72 6d65 7220  his transformer 
-0007db70: 7275 6e73 206b 2d6d 6561 6e73 206f 6e20  runs k-means on 
-0007db80: 7468 6520 696e 7075 7420 6461 7461 2061  the input data a
-0007db90: 6e64 2063 6f6e 7665 7274 7320 6561 6368  nd converts each
-0007dba0: 2064 6174 6120 706f 696e 740d 0a20 2020   data point..   
-0007dbb0: 2069 6e74 6f20 7468 6520 6964 206f 6620   into the id of 
-0007dbc0: 7468 6520 636c 6f73 6573 7420 636c 7573  the closest clus
-0007dbd0: 7465 722e 2049 6620 6120 7461 7267 6574  ter. If a target
-0007dbe0: 2076 6172 6961 626c 6520 6973 2070 7265   variable is pre
-0007dbf0: 7365 6e74 2c20 6974 2069 730d 0a20 2020  sent, it is..   
-0007dc00: 2073 6361 6c65 6420 616e 6420 696e 636c   scaled and incl
-0007dc10: 7564 6564 2061 7320 696e 7075 7420 746f  uded as input to
-0007dc20: 206b 2d6d 6561 6e73 2069 6e20 6f72 6465   k-means in orde
-0007dc30: 7220 746f 2064 6572 6976 6520 636c 7573  r to derive clus
-0007dc40: 7465 7273 2074 6861 740d 0a20 2020 206f  ters that..    o
-0007dc50: 6265 7920 7468 6520 636c 6173 7369 6669  bey the classifi
-0007dc60: 6361 7469 6f6e 2062 6f75 6e64 6172 7920  cation boundary 
-0007dc70: 6173 2077 656c 6c20 6173 2067 726f 7570  as well as group
-0007dc80: 2073 696d 696c 6172 2070 6f69 6e74 7320   similar points 
-0007dc90: 746f 6765 7468 6572 2e0d 0a20 2020 2050  together...    P
-0007dca0: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-0007dcb0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206b  ---------..    k
-0007dcc0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
-0007dcd0: 6e61 6c2c 2064 6566 6175 6c74 2031 3030  nal, default 100
-0007dce0: 0d0a 2020 2020 2020 2020 5468 6520 6e75  ..        The nu
-0007dcf0: 6d62 6572 206f 6620 636c 7573 7465 7273  mber of clusters
-0007dd00: 2074 6f20 6772 6f75 7020 6461 7461 2069   to group data i
-0007dd10: 6e74 6f2e 0d0a 2020 2020 7461 7267 6574  nto...    target
-0007dd20: 5f73 6361 6c65 3a20 666c 6f61 742c 205b  _scale: float, [
-0007dd30: 302c 2069 6e66 7479 5d2c 206f 7074 696f  0, infty], optio
-0007dd40: 6e61 6c2c 2064 6566 6175 6c74 2035 2e30  nal, default 5.0
-0007dd50: 0d0a 2020 2020 2020 2020 5468 6520 7363  ..        The sc
-0007dd60: 616c 696e 6720 6661 6374 6f72 2066 6f72  aling factor for
-0007dd70: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-0007dd80: 6162 6c65 2e20 5365 7420 7468 6973 2074  able. Set this t
-0007dd90: 6f20 7a65 726f 2074 6f20 6967 6e6f 7265  o zero to ignore
-0007dda0: 0d0a 2020 2020 2020 2020 7468 6520 7461  ..        the ta
-0007ddb0: 7267 6574 2e20 466f 7220 636c 6173 7369  rget. For classi
-0007ddc0: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
-0007ddd0: 732c 206c 6172 6765 7220 6074 6172 6765  s, larger `targe
-0007dde0: 745f 7363 616c 6560 2076 616c 7565 730d  t_scale` values.
-0007ddf0: 0a20 2020 2020 2020 2077 696c 6c20 7072  .        will pr
-0007de00: 6f64 7563 6520 636c 7573 7465 7273 2074  oduce clusters t
-0007de10: 6861 7420 6265 7474 6572 2072 6573 7065  hat better respe
-0007de20: 6374 2074 6865 2063 6c61 7373 2062 6f75  ct the class bou
-0007de30: 6e64 6172 792e 0d0a 2020 2020 7261 6e64  ndary...    rand
-0007de40: 6f6d 5f73 7461 7465 203a 2069 6e74 6567  om_state : integ
-0007de50: 6572 206f 7220 6e75 6d70 792e 5261 6e64  er or numpy.Rand
-0007de60: 6f6d 5374 6174 652c 206f 7074 696f 6e61  omState, optiona
-0007de70: 6c0d 0a20 2020 2020 2020 2054 6869 7320  l..        This 
-0007de80: 6973 2070 6173 7365 6420 746f 206b 2d6d  is passed to k-m
-0007de90: 6561 6e73 2061 7320 7468 6520 6765 6e65  eans as the gene
-0007dea0: 7261 746f 7220 7573 6564 2074 6f20 696e  rator used to in
-0007deb0: 6974 6961 6c69 7a65 2074 6865 0d0a 2020  itialize the..  
-0007dec0: 2020 2020 2020 6b6d 6561 6e73 2063 656e        kmeans cen
-0007ded0: 7465 7273 2e20 4966 2061 6e20 696e 7465  ters. If an inte
-0007dee0: 6765 7220 6973 2067 6976 656e 2c20 6974  ger is given, it
-0007def0: 2066 6978 6573 2074 6865 2073 6565 642e   fixes the seed.
-0007df00: 2044 6566 6175 6c74 7320 746f 0d0a 2020   Defaults to..  
-0007df10: 2020 2020 2020 7468 6520 676c 6f62 616c        the global
-0007df20: 206e 756d 7079 2072 616e 646f 6d20 6e75   numpy random nu
-0007df30: 6d62 6572 2067 656e 6572 6174 6f72 2e0d  mber generator..
-0007df40: 0a20 2020 2041 7474 7269 6275 7465 730d  .    Attributes.
-0007df50: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
-0007df60: 0a20 2020 2063 6c75 7374 6572 5f63 656e  .    cluster_cen
-0007df70: 7465 7273 5f20 3a20 6172 7261 792c 205b  ters_ : array, [
-0007df80: 6b2c 206e 5f66 6561 7475 7265 735d 0d0a  k, n_features]..
-0007df90: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-0007dfa0: 7465 7320 6f66 2063 6c75 7374 6572 2063  tes of cluster c
-0007dfb0: 656e 7465 7273 2e20 6e5f 6665 6174 7572  enters. n_featur
-0007dfc0: 6573 2064 6f65 7320 636f 756e 7420 7468  es does count th
-0007dfd0: 6520 7461 7267 6574 2063 6f6c 756d 6e2e  e target column.
-0007dfe0: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
-0007dff0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0007e000: 6c66 2c20 6b3d 3130 302c 2074 6172 6765  lf, k=100, targe
-0007e010: 745f 7363 616c 653d 352e 302c 2072 616e  t_scale=5.0, ran
-0007e020: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
-0007e030: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
-0007e040: 203d 206b 0d0a 2020 2020 2020 2020 7365   = k..        se
-0007e050: 6c66 2e74 6172 6765 745f 7363 616c 6520  lf.target_scale 
-0007e060: 3d20 7461 7267 6574 5f73 6361 6c65 0d0a  = target_scale..
-0007e070: 2020 2020 2020 2020 7365 6c66 2e72 616e          self.ran
-0007e080: 646f 6d5f 7374 6174 6520 3d20 7261 6e64  dom_state = rand
-0007e090: 6f6d 5f73 7461 7465 0d0a 0d0a 2020 2020  om_state....    
-0007e0a0: 6465 6620 6669 7428 7365 6c66 2c20 582c  def fit(self, X,
-0007e0b0: 2079 3d4e 6f6e 6529 3a0d 0a20 2020 2020   y=None):..     
-0007e0c0: 2020 2022 2222 5275 6e73 206b 2d6d 6561     """Runs k-mea
-0007e0d0: 6e73 206f 6e20 7468 6520 696e 7075 7420  ns on the input 
-0007e0e0: 6461 7461 2061 6e64 2066 696e 6420 6365  data and find ce
-0007e0f0: 6e74 726f 6964 732e 0d0a 2020 2020 2020  ntroids...      
-0007e100: 2020 4966 206e 6f20 7461 7267 6574 2069    If no target i
-0007e110: 7320 6769 7665 6e20 2860 7960 2069 7320  s given (`y` is 
-0007e120: 4e6f 6e65 2920 7468 656e 2072 756e 2076  None) then run v
-0007e130: 616e 696c 6c61 206b 2d6d 6561 6e73 206f  anilla k-means o
-0007e140: 6e20 696e 7075 740d 0a20 2020 2020 2020  n input..       
-0007e150: 2060 5860 2e0d 0a20 2020 2020 2020 2049   `X`...        I
-0007e160: 6620 7461 7267 6574 2060 7960 2069 7320  f target `y` is 
-0007e170: 6769 7665 6e2c 2074 6865 6e20 696e 636c  given, then incl
-0007e180: 7564 6520 7468 6520 7461 7267 6574 2028  ude the target (
-0007e190: 7765 6967 6874 6564 2062 790d 0a20 2020  weighted by..   
-0007e1a0: 2020 2020 2060 7461 7267 6574 5f73 6361       `target_sca
-0007e1b0: 6c65 6029 2061 7320 616e 2065 7874 7261  le`) as an extra
-0007e1c0: 2064 696d 656e 7369 6f6e 2066 6f72 206b   dimension for k
-0007e1d0: 2d6d 6561 6e73 2063 6c75 7374 6572 696e  -means clusterin
-0007e1e0: 672e 2049 6e20 7468 6973 0d0a 2020 2020  g. In this..    
-0007e1f0: 2020 2020 6361 7365 2c20 7275 6e20 6b2d      case, run k-
-0007e200: 6d65 616e 7320 7477 6963 652c 2066 6972  means twice, fir
-0007e210: 7374 2077 6974 6820 7468 6520 7461 7267  st with the targ
-0007e220: 6574 2c20 7468 656e 2061 6e20 6578 7472  et, then an extr
-0007e230: 6120 6974 6572 6174 696f 6e0d 0a20 2020  a iteration..   
-0007e240: 2020 2020 2077 6974 686f 7574 2e0d 0a20       without... 
-0007e250: 2020 2020 2020 2041 6674 6572 2066 6974         After fit
-0007e260: 7469 6e67 2c20 7468 6520 6174 7472 6962  ting, the attrib
-0007e270: 7574 6520 6063 6c75 7374 6572 5f63 656e  ute `cluster_cen
-0007e280: 7465 7273 5f60 2061 7265 2073 6574 2074  ters_` are set t
-0007e290: 6f20 7468 6520 6b2d 6d65 616e 730d 0a20  o the k-means.. 
-0007e2a0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
-0007e2b0: 2069 6e20 7468 6520 696e 7075 7420 7370   in the input sp
-0007e2c0: 6163 6520 7265 7072 6573 656e 7465 6420  ace represented 
-0007e2d0: 6279 2060 5860 2e0d 0a20 2020 2020 2020  by `X`...       
-0007e2e0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0007e2f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0007e300: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
-0007e310: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
-0007e320: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
-0007e330: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
-0007e340: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
-0007e350: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
-0007e360: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
-0007e370: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
-0007e380: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
-0007e390: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0007e3a0: 7072 6f76 6964 6564 2c20 7769 6c6c 2062  provided, will b
-0007e3b0: 6520 7765 6967 6874 6564 2077 6974 6820  e weighted with 
-0007e3c0: 6074 6172 6765 745f 7363 616c 6560 2061  `target_scale` a
-0007e3d0: 6e64 2069 6e63 6c75 6465 6420 696e 0d0a  nd included in..
-0007e3e0: 2020 2020 2020 2020 2020 2020 6b2d 6d65              k-me
-0007e3f0: 616e 7320 636c 7573 7465 7269 6e67 2061  ans clustering a
-0007e400: 7320 6869 6e74 2e0d 0a20 2020 2020 2020  s hint...       
-0007e410: 2022 2222 0d0a 2020 2020 2020 2020 6e5f   """..        n_
-0007e420: 6665 6174 7572 6573 203d 2058 2e73 6861  features = X.sha
-0007e430: 7065 5b31 5d0d 0a20 2020 2020 2020 2069  pe[1]..        i
-0007e440: 6620 7920 6973 204e 6f6e 653a 0d0a 2020  f y is None:..  
-0007e450: 2020 2020 2020 2020 2020 2320 4e6f 2074            # No t
-0007e460: 6172 6765 7420 7661 7269 6162 6c65 2c20  arget variable, 
-0007e470: 6a75 7374 2064 6f20 706c 6169 6e20 6b2d  just do plain k-
-0007e480: 6d65 616e 730d 0a20 2020 2020 2020 2020  means..         
-0007e490: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
-0007e4a0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
-0007e4b0: 7365 6c66 2e6b 2c0d 0a20 2020 2020 2020  self.k,..       
-0007e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e4d0: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
-0007e4e0: 743d 3230 2c0d 0a20 2020 2020 2020 2020  t=20,..         
-0007e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e500: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-0007e510: 7374 6174 653d 7365 6c66 2e72 616e 646f  state=self.rando
-0007e520: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
-0007e530: 2020 2020 2020 6b6d 5f6d 6f64 656c 2e66        km_model.f
-0007e540: 6974 2858 290d 0a0d 0a20 2020 2020 2020  it(X)....       
-0007e550: 2020 2020 2073 656c 662e 6b6d 5f6d 6f64       self.km_mod
-0007e560: 656c 5f20 3d20 6b6d 5f6d 6f64 656c 0d0a  el_ = km_model..
-0007e570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0007e580: 2e63 6c75 7374 6572 5f63 656e 7465 7273  .cluster_centers
-0007e590: 5f20 3d20 6b6d 5f6d 6f64 656c 2e63 6c75  _ = km_model.clu
-0007e5a0: 7374 6572 5f63 656e 7465 7273 5f0d 0a20  ster_centers_.. 
-0007e5b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0007e5c0: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
-0007e5d0: 2020 2320 5468 6572 6520 6973 2074 6172    # There is tar
-0007e5e0: 6765 7420 696e 666f 726d 6174 696f 6e2e  get information.
-0007e5f0: 2041 7070 6c79 2061 7070 726f 7072 6961   Apply appropria
-0007e600: 7465 2073 6361 6c69 6e67 2061 6e64 2069  te scaling and i
-0007e610: 6e63 6c75 6465 0d0a 2020 2020 2020 2020  nclude..        
-0007e620: 2320 696e 746f 2069 6e70 7574 2064 6174  # into input dat
-0007e630: 6120 746f 206b 2d6d 6561 6e73 0d0a 2020  a to k-means..  
-0007e640: 2020 2020 2020 6461 7461 5f77 6974 685f        data_with_
-0007e650: 7461 7267 6574 203d 206e 702e 6873 7461  target = np.hsta
-0007e660: 636b 2828 582c 2079 5b3a 2c6e 702e 6e65  ck((X, y[:,np.ne
-0007e670: 7761 7869 735d 2a73 656c 662e 7461 7267  waxis]*self.targ
-0007e680: 6574 5f73 6361 6c65 2929 0d0a 0d0a 2020  et_scale))....  
-0007e690: 2020 2020 2020 2320 4275 696c 6420 6120        # Build a 
-0007e6a0: 7072 652d 7472 6169 6e69 6e67 206b 2d6d  pre-training k-m
-0007e6b0: 6561 6e73 206d 6f64 656c 206f 6e20 6461  eans model on da
-0007e6c0: 7461 2061 6e64 2074 6172 6765 740d 0a20  ta and target.. 
-0007e6d0: 2020 2020 2020 206b 6d5f 6d6f 6465 6c5f         km_model_
-0007e6e0: 7072 6574 7261 696e 203d 204b 4d65 616e  pretrain = KMean
-0007e6f0: 7328 6e5f 636c 7573 7465 7273 3d73 656c  s(n_clusters=sel
-0007e700: 662e 6b2c 0d0a 2020 2020 2020 2020 2020  f.k,..          
-0007e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e720: 2020 2020 2020 2020 206e 5f69 6e69 743d           n_init=
-0007e730: 3230 2c0d 0a20 2020 2020 2020 2020 2020  20,..           
-0007e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e750: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-0007e760: 7461 7465 3d73 656c 662e 7261 6e64 6f6d  tate=self.random
-0007e770: 5f73 7461 7465 290d 0a20 2020 2020 2020  _state)..       
-0007e780: 206b 6d5f 6d6f 6465 6c5f 7072 6574 7261   km_model_pretra
-0007e790: 696e 2e66 6974 2864 6174 615f 7769 7468  in.fit(data_with
-0007e7a0: 5f74 6172 6765 7429 0d0a 0d0a 2020 2020  _target)....    
-0007e7b0: 2020 2020 2320 5275 6e20 6b2d 6d65 616e      # Run k-mean
-0007e7c0: 7320 6120 7365 636f 6e64 2074 696d 6520  s a second time 
-0007e7d0: 746f 2067 6574 2074 6865 2063 6c75 7374  to get the clust
-0007e7e0: 6572 7320 696e 2074 6865 206f 7269 6769  ers in the origi
-0007e7f0: 6e61 6c20 7370 6163 650d 0a20 2020 2020  nal space..     
-0007e800: 2020 2023 2077 6974 686f 7574 2074 6172     # without tar
-0007e810: 6765 7420 696e 666f 2e20 496e 6974 6961  get info. Initia
-0007e820: 6c69 7a65 2075 7369 6e67 2063 656e 7472  lize using centr
-0007e830: 6f69 6473 2066 6f75 6e64 2069 6e20 7072  oids found in pr
-0007e840: 652d 7472 6169 6e69 6e67 2e0d 0a20 2020  e-training...   
-0007e850: 2020 2020 2023 2047 6f20 7468 726f 7567       # Go throug
-0007e860: 6820 6120 7369 6e67 6c65 2069 7465 7261  h a single itera
-0007e870: 7469 6f6e 206f 6620 636c 7573 7465 7220  tion of cluster 
-0007e880: 6173 7369 676e 6d65 6e74 2061 6e64 2063  assignment and c
-0007e890: 656e 7472 6f69 640d 0a20 2020 2020 2020  entroid..       
-0007e8a0: 2023 2072 6563 6f6d 7075 7461 7469 6f6e   # recomputation
-0007e8b0: 2e0d 0a20 2020 2020 2020 206b 6d5f 6d6f  ...        km_mo
-0007e8c0: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
-0007e8d0: 6c75 7374 6572 733d 7365 6c66 2e6b 2c0d  lusters=self.k,.
-0007e8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007e8f0: 2020 2020 2020 2020 2020 2069 6e69 743d             init=
-0007e900: 6b6d 5f6d 6f64 656c 5f70 7265 7472 6169  km_model_pretrai
-0007e910: 6e2e 636c 7573 7465 725f 6365 6e74 6572  n.cluster_center
-0007e920: 735f 5b3a 2c3a 6e5f 6665 6174 7572 6573  s_[:,:n_features
-0007e930: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0007e940: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-0007e950: 696e 6974 3d31 2c0d 0a20 2020 2020 2020  init=1,..       
-0007e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e970: 2020 206d 6178 5f69 7465 723d 3129 0d0a     max_iter=1)..
-0007e980: 2020 2020 2020 2020 6b6d 5f6d 6f64 656c          km_model
-0007e990: 2e66 6974 2858 290d 0a0d 0a20 2020 2020  .fit(X)....     
-0007e9a0: 2020 2073 656c 662e 6b6d 5f6d 6f64 656c     self.km_model
-0007e9b0: 203d 206b 6d5f 6d6f 6465 6c0d 0a20 2020   = km_model..   
-0007e9c0: 2020 2020 2073 656c 662e 636c 7573 7465       self.cluste
-0007e9d0: 725f 6365 6e74 6572 735f 203d 206b 6d5f  r_centers_ = km_
-0007e9e0: 6d6f 6465 6c2e 636c 7573 7465 725f 6365  model.cluster_ce
-0007e9f0: 6e74 6572 735f 0d0a 2020 2020 2020 2020  nters_..        
-0007ea00: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
-0007ea10: 2020 2064 6566 2074 7261 6e73 666f 726d     def transform
-0007ea20: 2873 656c 662c 2058 2c20 793d 4e6f 6e65  (self, X, y=None
-0007ea30: 293a 0d0a 2020 2020 2020 2020 2222 224f  ):..        """O
-0007ea40: 7574 7075 7420 7468 6520 636c 6f73 6573  utput the closes
-0007ea50: 7420 636c 7573 7465 7220 6964 2066 6f72  t cluster id for
-0007ea60: 2065 6163 6820 696e 7075 7420 6461 7461   each input data
-0007ea70: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
-0007ea80: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0007ea90: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0007eaa0: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
-0007eab0: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
-0007eac0: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
-0007ead0: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
-0007eae0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
-0007eaf0: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
-0007eb00: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
-0007eb10: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
-0007eb20: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
-0007eb30: 0a20 2020 2020 2020 2020 2020 2054 6172  .            Tar
-0007eb40: 6765 7420 7665 6374 6f72 2069 7320 6967  get vector is ig
-0007eb50: 6e6f 7265 6420 6576 656e 2069 6620 7072  nored even if pr
-0007eb60: 6f76 6964 6564 2e0d 0a20 2020 2020 2020  ovided...       
-0007eb70: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0007eb80: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0007eb90: 2020 2063 6c75 7374 6572 5f69 6473 203a     cluster_ids :
-0007eba0: 2061 7272 6179 2c20 7368 6170 655b 6e5f   array, shape[n_
-0007ebb0: 6461 7461 5f70 6f69 6e74 732c 315d 0d0a  data_points,1]..
-0007ebc0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0007ebd0: 2020 2020 2063 6c75 7374 6572 7320 3d20       clusters = 
-0007ebe0: 7365 6c66 2e6b 6d5f 6d6f 6465 6c2e 7072  self.km_model.pr
-0007ebf0: 6564 6963 7428 5829 0d0a 2020 2020 2020  edict(X)..      
-0007ec00: 2020 7265 7475 726e 2063 6c75 7374 6572    return cluster
-0007ec10: 735b 3a2c 6e70 2e6e 6577 6178 6973 5d0d  s[:,np.newaxis].
-0007ec20: 0a0d 0a20 2020 2064 6566 2066 6974 5f74  ...    def fit_t
-0007ec30: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
-0007ec40: 2c20 793d 4e6f 6e65 293a 0d0a 2020 2020  , y=None):..    
-0007ec50: 2020 2020 2222 2252 756e 7320 6669 7420      """Runs fit 
-0007ec60: 666f 6c6c 6f77 6564 2062 7920 7472 616e  followed by tran
-0007ec70: 7366 6f72 6d2e 0d0a 2020 2020 2020 2020  sform...        
-0007ec80: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
-0007ec90: 662e 6669 7428 582c 2079 290d 0a20 2020  f.fit(X, y)..   
-0007eca0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0007ecb0: 2e74 7261 6e73 666f 726d 2858 2c20 7929  .transform(X, y)
-0007ecc0: 0d0a 0d0a 0d0a 6672 6f6d 2063 6f6c 6c65  ......from colle
-0007ecd0: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0007ece0: 6661 756c 7464 6963 740d 0a69 6d70 6f72  faultdict..impor
-0007ecf0: 7420 6f70 6572 6174 6f72 0d0a 696d 706f  t operator..impo
-0007ed00: 7274 2070 6462 0d0a 696d 706f 7274 2063  rt pdb..import c
-0007ed10: 6f70 790d 0a66 726f 6d20 736b 6c65 6172  opy..from sklear
-0007ed20: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
-0007ed30: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
-0007ed40: 6573 745f 7370 6c69 740d 0a64 6566 2054  est_split..def T
-0007ed50: 7261 6e73 666f 726d 5f4b 4d5f 4665 6174  ransform_KM_Feat
-0007ed60: 7572 6573 2874 7261 696e 696e 675f 6461  ures(training_da
-0007ed70: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
-0007ed80: 656c 732c 2074 6573 745f 6461 7461 2c20  els, test_data, 
-0007ed90: 6b6d 5f6d 6178 3d30 293a 0d0a 2020 2020  km_max=0):..    
-0007eda0: 7365 6564 203d 2039 390d 0a20 2020 2070  seed = 99..    p
-0007edb0: 7265 6473 203d 206c 6973 7428 7472 6169  reds = list(trai
-0007edc0: 6e69 6e67 5f64 6174 6129 0d0a 2020 2020  ning_data)..    
-0007edd0: 7461 7267 6574 203d 2074 7261 696e 696e  target = trainin
-0007ede0: 675f 6c61 6265 6c73 2e6e 616d 650d 0a20  g_labels.name.. 
-0007edf0: 2020 2074 7261 696e 5f69 6e64 6578 203d     train_index =
-0007ee00: 2020 7472 6169 6e69 6e67 5f64 6174 612e    training_data.
-0007ee10: 696e 6465 780d 0a20 2020 2074 6573 745f  index..    test_
-0007ee20: 696e 6465 7820 3d20 2074 6573 745f 6461  index =  test_da
-0007ee30: 7461 2e69 6e64 6578 0d0a 2020 2020 6966  ta.index..    if
-0007ee40: 206b 6d5f 6d61 7820 3c3d 2032 3a0d 0a20   km_max <= 2:.. 
-0007ee50: 2020 2020 2020 206b 5f6d 6178 203d 2032         k_max = 2
-0007ee60: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-0007ee70: 2020 2020 206b 5f6d 6178 203d 2063 6f70       k_max = cop
-0007ee80: 792e 6465 6570 636f 7079 286b 6d5f 6d61  y.deepcopy(km_ma
-0007ee90: 7829 0d0a 2020 2020 2323 2320 4361 6c63  x)..    ### Calc
-0007eea0: 756c 6174 6520 7468 6520 7461 7267 6574  ulate the target
-0007eeb0: 2073 6361 6c65 2068 6572 6520 3d3e 2074   scale here => t
-0007eec0: 6865 2068 6967 6865 7220 7468 6520 6e75  he higher the nu
-0007eed0: 6d62 6572 2074 6865 2062 6574 7465 7220  mber the better 
-0007eee0: 666f 7220 7461 7267 6574 2061 6363 7572  for target accur
-0007eef0: 6163 790d 0a20 2020 2074 7279 3a0d 0a20  acy..    try:.. 
-0007ef00: 2020 2020 2020 2069 6620 7472 6169 6e69         if traini
-0007ef10: 6e67 5f6c 6162 656c 732e 6474 7970 6520  ng_labels.dtype 
-0007ef20: 696e 205b 6e70 2e66 6c6f 6174 3634 2c6e  in [np.float64,n
-0007ef30: 702e 666c 6f61 7433 322c 6e70 2e66 6c6f  p.float32,np.flo
-0007ef40: 6174 3136 5d3a 0d0a 2020 2020 2020 2020  at16]:..        
-0007ef50: 2020 2020 7461 7267 6574 5f72 616e 6765      target_range
-0007ef60: 203d 2066 6c6f 6174 2861 6273 2874 7261   = float(abs(tra
-0007ef70: 696e 696e 675f 6c61 6265 6c73 2e6d 6178  ining_labels.max
-0007ef80: 2829 202d 2074 7261 696e 696e 675f 6c61  () - training_la
-0007ef90: 6265 6c73 2e6d 696e 2829 2929 0d0a 2020  bels.min()))..  
-0007efa0: 2020 2020 2020 656c 6966 2074 7261 696e        elif train
-0007efb0: 696e 675f 6c61 6265 6c73 2e64 7479 7065  ing_labels.dtype
-0007efc0: 2069 6e20 5b6f 626a 6563 742c 626f 6f6c   in [object,bool
-0007efd0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-0007efe0: 7461 7267 6574 5f72 616e 6765 203d 2069  target_range = i
-0007eff0: 6e74 286c 656e 2843 6f75 6e74 6572 2874  nt(len(Counter(t
-0007f000: 7261 696e 696e 675f 6c61 6265 6c73 2929  raining_labels))
-0007f010: 202b 2033 290d 0a20 2020 2020 2020 2065   + 3)..        e
-0007f020: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0007f030: 2020 7461 7267 6574 5f72 616e 6765 203d    target_range =
-0007f040: 2069 6e74 2861 6273 2874 7261 696e 696e   int(abs(trainin
-0007f050: 675f 6c61 6265 6c73 2e6d 6178 2829 202d  g_labels.max() -
-0007f060: 2074 7261 696e 696e 675f 6c61 6265 6c73   training_labels
-0007f070: 2e6d 696e 2829 2929 0d0a 2020 2020 6578  .min()))..    ex
-0007f080: 6365 7074 3a0d 0a20 2020 2020 2020 2074  cept:..        t
-0007f090: 6172 6765 745f 7261 6e67 6520 3d20 352e  arget_range = 5.
-0007f0a0: 300d 0a20 2020 206b 6d66 203d 2020 4b4d  0..    kmf =  KM
-0007f0b0: 6561 6e73 4665 6174 7572 697a 6572 286b  eansFeaturizer(k
-0007f0c0: 3d6b 5f6d 6178 2c20 7461 7267 6574 5f73  =k_max, target_s
-0007f0d0: 6361 6c65 3d74 6172 6765 745f 7261 6e67  cale=target_rang
-0007f0e0: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
-0007f0f0: 7365 6564 290d 0a20 2020 206b 6d66 5f68  seed)..    kmf_h
-0007f100: 696e 7420 3d20 6b6d 662e 6669 7428 7472  int = kmf.fit(tr
-0007f110: 6169 6e69 6e67 5f64 6174 612c 2074 7261  aining_data, tra
-0007f120: 696e 696e 675f 6c61 6265 6c73 290d 0a20  ining_labels).. 
-0007f130: 2020 2023 2323 204a 7573 7420 7265 7475     ### Just retu
-0007f140: 726e 2069 7420 7769 7468 2074 6865 2063  rn it with the c
-0007f150: 6c75 7374 6572 2063 6f6c 756d 6e20 3d3e  luster column =>
-0007f160: 206e 6f20 6e65 6564 2074 6f20 7265 7475   no need to retu
-0007f170: 726e 2074 6865 2064 6174 6120 6672 616d  rn the data fram
-0007f180: 6520 2323 230d 0a20 2020 2074 7261 696e  e ###..    train
-0007f190: 696e 675f 636c 7573 7465 725f 6665 6174  ing_cluster_feat
-0007f1a0: 7572 6573 203d 206b 6d66 5f68 696e 742e  ures = kmf_hint.
-0007f1b0: 7472 616e 7366 6f72 6d28 7472 6169 6e69  transform(traini
-0007f1c0: 6e67 5f64 6174 6129 0d0a 2020 2020 7465  ng_data)..    te
-0007f1d0: 7374 5f63 6c75 7374 6572 5f66 6561 7475  st_cluster_featu
-0007f1e0: 7265 7320 3d20 6b6d 665f 6869 6e74 2e74  res = kmf_hint.t
-0007f1f0: 7261 6e73 666f 726d 2874 6573 745f 6461  ransform(test_da
-0007f200: 7461 290d 0a20 2020 206e 7078 203d 206e  ta)..    npx = n
-0007f210: 702e 635f 5b74 7261 696e 696e 675f 6461  p.c_[training_da
-0007f220: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
-0007f230: 656c 732e 7661 6c75 6573 5d0d 0a20 2020  els.values]..   
-0007f240: 2074 7261 696e 696e 675f 7769 7468 5f63   training_with_c
-0007f250: 6c75 7374 6572 203d 206e 702e 635f 5b6e  luster = np.c_[n
-0007f260: 7078 2c74 7261 696e 696e 675f 636c 7573  px,training_clus
-0007f270: 7465 725f 6665 6174 7572 6573 5d0d 0a20  ter_features].. 
-0007f280: 2020 2074 6573 745f 7769 7468 5f63 6c75     test_with_clu
-0007f290: 7374 6572 203d 206e 702e 635f 5b74 6573  ster = np.c_[tes
-0007f2a0: 745f 6461 7461 2c20 7465 7374 5f63 6c75  t_data, test_clu
-0007f2b0: 7374 6572 5f66 6561 7475 7265 735d 0d0a  ster_features]..
-0007f2c0: 2020 2020 2323 2320 5765 2061 7265 2067      ### We are g
-0007f2d0: 6f69 6e67 2074 6f20 6a75 7374 2072 6574  oing to just ret
-0007f2e0: 7572 6e20 7468 6520 636c 7573 7465 7220  urn the cluster 
-0007f2f0: 7661 6c75 6573 2023 2323 2323 230d 0a20  values ######.. 
-0007f300: 2020 2074 7261 696e 5f77 6974 685f 636c     train_with_cl
-0007f310: 7573 7465 725f 6466 203d 2074 7261 696e  uster_df = train
-0007f320: 696e 675f 7769 7468 5f63 6c75 7374 6572  ing_with_cluster
-0007f330: 5b3a 2c2d 315d 0d0a 2020 2020 7465 7374  [:,-1]..    test
-0007f340: 5f77 6974 685f 636c 7573 7465 725f 6466  _with_cluster_df
-0007f350: 203d 2074 6573 745f 7769 7468 5f63 6c75   = test_with_clu
-0007f360: 7374 6572 5b3a 2c2d 315d 0d0a 2020 2020  ster[:,-1]..    
-0007f370: 2374 7261 696e 5f77 6974 685f 636c 7573  #train_with_clus
-0007f380: 7465 725f 6466 203d 2070 642e 4461 7461  ter_df = pd.Data
-0007f390: 4672 616d 6528 7472 6169 6e69 6e67 5f77  Frame(training_w
-0007f3a0: 6974 685f 636c 7573 7465 722c 696e 6465  ith_cluster,inde
-0007f3b0: 783d 7472 6169 6e5f 696e 6465 782c 0d0a  x=train_index,..
-0007f3c0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0007f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f3e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d70         columns=p
-0007f3f0: 7265 6473 2b5b 7461 7267 6574 2c27 636c  reds+[target,'cl
-0007f400: 7573 7465 7227 5d29 0d0a 2020 2020 2374  uster'])..    #t
-0007f410: 6573 745f 7769 7468 5f63 6c75 7374 6572  est_with_cluster
-0007f420: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
-0007f430: 6d65 2874 6573 745f 7769 7468 5f63 6c75  me(test_with_clu
-0007f440: 7374 6572 2c69 6e64 6578 3d74 6573 745f  ster,index=test_
-0007f450: 696e 6465 782c 0d0a 2020 2020 2320 2020  index,..    #   
-0007f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f470: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0007f480: 6f6c 756d 6e73 3d70 7265 6473 2b5b 2763  olumns=preds+['c
-0007f490: 6c75 7374 6572 275d 290d 0a20 2020 2072  luster'])..    r
-0007f4a0: 6574 7572 6e20 7472 6169 6e5f 7769 7468  eturn train_with
-0007f4b0: 5f63 6c75 7374 6572 5f64 662c 2074 6573  _cluster_df, tes
-0007f4c0: 745f 7769 7468 5f63 6c75 7374 6572 5f64  t_with_cluster_d
-0007f4d0: 660d 0a00 0000 0000 0000 0000 0000 0000  f...............
-0007f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0007f610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0007f670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0007f680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0007f690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0007f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0007f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007f750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0007f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f800: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
-0007f810: 3638 392e 300a 0000 0000 0000 0000 0000  689.0...........
-0007f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fa00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-0007fa10: 2f61 7574 6f76 696d 6c2f 5f5f 696e 6974  /autoviml/__init
-0007fa20: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
-0007fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fa60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0007fa70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0007fa80: 3030 3033 3236 3400 3030 3030 3030 3030  0003264.00000000
-0007fa90: 3030 3000 3031 3730 3733 0020 3000 0000  000.017073. 0...
-0007faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007da10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007da60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007da70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007da80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007da90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007db50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0007dc10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0007dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007de00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+0007de10: 2f61 7574 6f76 696d 6c2f 5472 616e 7366  /autoviml/Transf
+0007de20: 6f72 6d5f 4b4d 5f46 6561 7475 7265 732e  orm_KM_Features.
+0007de30: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+0007de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007de60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0007de70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0007de80: 3030 3135 3332 3300 3030 3030 3030 3030  0015323.00000000
+0007de90: 3030 3000 3032 3135 3334 0020 3000 0000  000.021534. 0...
+0007dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007df50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007e000: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0007e010: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+0007e020: 7320 6173 2070 640d 0a66 726f 6d20 736b  s as pd..from sk
+0007e030: 6c65 6172 6e2e 636c 7573 7465 7220 696d  learn.cluster im
+0007e040: 706f 7274 204b 4d65 616e 730d 0a69 6d70  port KMeans..imp
+0007e050: 6f72 7420 736b 6c65 6172 6e0d 0a69 6d70  ort sklearn..imp
+0007e060: 6f72 7420 7363 6970 790d 0a0d 0a63 6c61  ort scipy....cla
+0007e070: 7373 204b 4d65 616e 7346 6561 7475 7269  ss KMeansFeaturi
+0007e080: 7a65 723a 0d0a 2020 2020 2222 2254 7261  zer:..    """Tra
+0007e090: 6e73 666f 726d 7320 6e75 6d65 7269 6320  nsforms numeric 
+0007e0a0: 6461 7461 2069 6e74 6f20 6b2d 6d65 616e  data into k-mean
+0007e0b0: 7320 636c 7573 7465 7220 6d65 6d62 6572  s cluster member
+0007e0c0: 7368 6970 732e 0d0a 2020 2020 4672 6f6d  ships...    From
+0007e0d0: 2074 6865 2046 6561 7475 7265 2045 6e67   the Feature Eng
+0007e0e0: 696e 6565 7269 6e67 2042 6f6f 6b20 6279  ineering Book by
+0007e0f0: 2041 6c69 6365 205a 6865 6e67 0d0a 2020   Alice Zheng..  
+0007e100: 2020 6874 7470 733a 2f2f 6769 7468 7562    https://github
+0007e110: 2e63 6f6d 2f61 6c69 6365 7a68 656e 672f  .com/alicezheng/
+0007e120: 6665 6174 7572 652d 656e 6769 6e65 6572  feature-engineer
+0007e130: 696e 672d 626f 6f6b 2f62 6c6f 622f 6d61  ing-book/blob/ma
+0007e140: 7374 6572 2f6b 6d65 616e 735f 6665 6174  ster/kmeans_feat
+0007e150: 7572 697a 6572 2e70 790d 0a20 2020 2054  urizer.py..    T
+0007e160: 6869 7320 7472 616e 7366 6f72 6d65 7220  his transformer 
+0007e170: 7275 6e73 206b 2d6d 6561 6e73 206f 6e20  runs k-means on 
+0007e180: 7468 6520 696e 7075 7420 6461 7461 2061  the input data a
+0007e190: 6e64 2063 6f6e 7665 7274 7320 6561 6368  nd converts each
+0007e1a0: 2064 6174 6120 706f 696e 740d 0a20 2020   data point..   
+0007e1b0: 2069 6e74 6f20 7468 6520 6964 206f 6620   into the id of 
+0007e1c0: 7468 6520 636c 6f73 6573 7420 636c 7573  the closest clus
+0007e1d0: 7465 722e 2049 6620 6120 7461 7267 6574  ter. If a target
+0007e1e0: 2076 6172 6961 626c 6520 6973 2070 7265   variable is pre
+0007e1f0: 7365 6e74 2c20 6974 2069 730d 0a20 2020  sent, it is..   
+0007e200: 2073 6361 6c65 6420 616e 6420 696e 636c   scaled and incl
+0007e210: 7564 6564 2061 7320 696e 7075 7420 746f  uded as input to
+0007e220: 206b 2d6d 6561 6e73 2069 6e20 6f72 6465   k-means in orde
+0007e230: 7220 746f 2064 6572 6976 6520 636c 7573  r to derive clus
+0007e240: 7465 7273 2074 6861 740d 0a20 2020 206f  ters that..    o
+0007e250: 6265 7920 7468 6520 636c 6173 7369 6669  bey the classifi
+0007e260: 6361 7469 6f6e 2062 6f75 6e64 6172 7920  cation boundary 
+0007e270: 6173 2077 656c 6c20 6173 2067 726f 7570  as well as group
+0007e280: 2073 696d 696c 6172 2070 6f69 6e74 7320   similar points 
+0007e290: 746f 6765 7468 6572 2e0d 0a20 2020 2050  together...    P
+0007e2a0: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+0007e2b0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206b  ---------..    k
+0007e2c0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+0007e2d0: 6e61 6c2c 2064 6566 6175 6c74 2031 3030  nal, default 100
+0007e2e0: 0d0a 2020 2020 2020 2020 5468 6520 6e75  ..        The nu
+0007e2f0: 6d62 6572 206f 6620 636c 7573 7465 7273  mber of clusters
+0007e300: 2074 6f20 6772 6f75 7020 6461 7461 2069   to group data i
+0007e310: 6e74 6f2e 0d0a 2020 2020 7461 7267 6574  nto...    target
+0007e320: 5f73 6361 6c65 3a20 666c 6f61 742c 205b  _scale: float, [
+0007e330: 302c 2069 6e66 7479 5d2c 206f 7074 696f  0, infty], optio
+0007e340: 6e61 6c2c 2064 6566 6175 6c74 2035 2e30  nal, default 5.0
+0007e350: 0d0a 2020 2020 2020 2020 5468 6520 7363  ..        The sc
+0007e360: 616c 696e 6720 6661 6374 6f72 2066 6f72  aling factor for
+0007e370: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
+0007e380: 6162 6c65 2e20 5365 7420 7468 6973 2074  able. Set this t
+0007e390: 6f20 7a65 726f 2074 6f20 6967 6e6f 7265  o zero to ignore
+0007e3a0: 0d0a 2020 2020 2020 2020 7468 6520 7461  ..        the ta
+0007e3b0: 7267 6574 2e20 466f 7220 636c 6173 7369  rget. For classi
+0007e3c0: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+0007e3d0: 732c 206c 6172 6765 7220 6074 6172 6765  s, larger `targe
+0007e3e0: 745f 7363 616c 6560 2076 616c 7565 730d  t_scale` values.
+0007e3f0: 0a20 2020 2020 2020 2077 696c 6c20 7072  .        will pr
+0007e400: 6f64 7563 6520 636c 7573 7465 7273 2074  oduce clusters t
+0007e410: 6861 7420 6265 7474 6572 2072 6573 7065  hat better respe
+0007e420: 6374 2074 6865 2063 6c61 7373 2062 6f75  ct the class bou
+0007e430: 6e64 6172 792e 0d0a 2020 2020 7261 6e64  ndary...    rand
+0007e440: 6f6d 5f73 7461 7465 203a 2069 6e74 6567  om_state : integ
+0007e450: 6572 206f 7220 6e75 6d70 792e 5261 6e64  er or numpy.Rand
+0007e460: 6f6d 5374 6174 652c 206f 7074 696f 6e61  omState, optiona
+0007e470: 6c0d 0a20 2020 2020 2020 2054 6869 7320  l..        This 
+0007e480: 6973 2070 6173 7365 6420 746f 206b 2d6d  is passed to k-m
+0007e490: 6561 6e73 2061 7320 7468 6520 6765 6e65  eans as the gene
+0007e4a0: 7261 746f 7220 7573 6564 2074 6f20 696e  rator used to in
+0007e4b0: 6974 6961 6c69 7a65 2074 6865 0d0a 2020  itialize the..  
+0007e4c0: 2020 2020 2020 6b6d 6561 6e73 2063 656e        kmeans cen
+0007e4d0: 7465 7273 2e20 4966 2061 6e20 696e 7465  ters. If an inte
+0007e4e0: 6765 7220 6973 2067 6976 656e 2c20 6974  ger is given, it
+0007e4f0: 2066 6978 6573 2074 6865 2073 6565 642e   fixes the seed.
+0007e500: 2044 6566 6175 6c74 7320 746f 0d0a 2020   Defaults to..  
+0007e510: 2020 2020 2020 7468 6520 676c 6f62 616c        the global
+0007e520: 206e 756d 7079 2072 616e 646f 6d20 6e75   numpy random nu
+0007e530: 6d62 6572 2067 656e 6572 6174 6f72 2e0d  mber generator..
+0007e540: 0a20 2020 2041 7474 7269 6275 7465 730d  .    Attributes.
+0007e550: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
+0007e560: 0a20 2020 2063 6c75 7374 6572 5f63 656e  .    cluster_cen
+0007e570: 7465 7273 5f20 3a20 6172 7261 792c 205b  ters_ : array, [
+0007e580: 6b2c 206e 5f66 6561 7475 7265 735d 0d0a  k, n_features]..
+0007e590: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
+0007e5a0: 7465 7320 6f66 2063 6c75 7374 6572 2063  tes of cluster c
+0007e5b0: 656e 7465 7273 2e20 6e5f 6665 6174 7572  enters. n_featur
+0007e5c0: 6573 2064 6f65 7320 636f 756e 7420 7468  es does count th
+0007e5d0: 6520 7461 7267 6574 2063 6f6c 756d 6e2e  e target column.
+0007e5e0: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
+0007e5f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0007e600: 6c66 2c20 6b3d 3130 302c 2074 6172 6765  lf, k=100, targe
+0007e610: 745f 7363 616c 653d 352e 302c 2072 616e  t_scale=5.0, ran
+0007e620: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
+0007e630: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
+0007e640: 203d 206b 0d0a 2020 2020 2020 2020 7365   = k..        se
+0007e650: 6c66 2e74 6172 6765 745f 7363 616c 6520  lf.target_scale 
+0007e660: 3d20 7461 7267 6574 5f73 6361 6c65 0d0a  = target_scale..
+0007e670: 2020 2020 2020 2020 7365 6c66 2e72 616e          self.ran
+0007e680: 646f 6d5f 7374 6174 6520 3d20 7261 6e64  dom_state = rand
+0007e690: 6f6d 5f73 7461 7465 0d0a 0d0a 2020 2020  om_state....    
+0007e6a0: 6465 6620 6669 7428 7365 6c66 2c20 582c  def fit(self, X,
+0007e6b0: 2079 3d4e 6f6e 6529 3a0d 0a20 2020 2020   y=None):..     
+0007e6c0: 2020 2022 2222 5275 6e73 206b 2d6d 6561     """Runs k-mea
+0007e6d0: 6e73 206f 6e20 7468 6520 696e 7075 7420  ns on the input 
+0007e6e0: 6461 7461 2061 6e64 2066 696e 6420 6365  data and find ce
+0007e6f0: 6e74 726f 6964 732e 0d0a 2020 2020 2020  ntroids...      
+0007e700: 2020 4966 206e 6f20 7461 7267 6574 2069    If no target i
+0007e710: 7320 6769 7665 6e20 2860 7960 2069 7320  s given (`y` is 
+0007e720: 4e6f 6e65 2920 7468 656e 2072 756e 2076  None) then run v
+0007e730: 616e 696c 6c61 206b 2d6d 6561 6e73 206f  anilla k-means o
+0007e740: 6e20 696e 7075 740d 0a20 2020 2020 2020  n input..       
+0007e750: 2060 5860 2e0d 0a20 2020 2020 2020 2049   `X`...        I
+0007e760: 6620 7461 7267 6574 2060 7960 2069 7320  f target `y` is 
+0007e770: 6769 7665 6e2c 2074 6865 6e20 696e 636c  given, then incl
+0007e780: 7564 6520 7468 6520 7461 7267 6574 2028  ude the target (
+0007e790: 7765 6967 6874 6564 2062 790d 0a20 2020  weighted by..   
+0007e7a0: 2020 2020 2060 7461 7267 6574 5f73 6361       `target_sca
+0007e7b0: 6c65 6029 2061 7320 616e 2065 7874 7261  le`) as an extra
+0007e7c0: 2064 696d 656e 7369 6f6e 2066 6f72 206b   dimension for k
+0007e7d0: 2d6d 6561 6e73 2063 6c75 7374 6572 696e  -means clusterin
+0007e7e0: 672e 2049 6e20 7468 6973 0d0a 2020 2020  g. In this..    
+0007e7f0: 2020 2020 6361 7365 2c20 7275 6e20 6b2d      case, run k-
+0007e800: 6d65 616e 7320 7477 6963 652c 2066 6972  means twice, fir
+0007e810: 7374 2077 6974 6820 7468 6520 7461 7267  st with the targ
+0007e820: 6574 2c20 7468 656e 2061 6e20 6578 7472  et, then an extr
+0007e830: 6120 6974 6572 6174 696f 6e0d 0a20 2020  a iteration..   
+0007e840: 2020 2020 2077 6974 686f 7574 2e0d 0a20       without... 
+0007e850: 2020 2020 2020 2041 6674 6572 2066 6974         After fit
+0007e860: 7469 6e67 2c20 7468 6520 6174 7472 6962  ting, the attrib
+0007e870: 7574 6520 6063 6c75 7374 6572 5f63 656e  ute `cluster_cen
+0007e880: 7465 7273 5f60 2061 7265 2073 6574 2074  ters_` are set t
+0007e890: 6f20 7468 6520 6b2d 6d65 616e 730d 0a20  o the k-means.. 
+0007e8a0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
+0007e8b0: 2069 6e20 7468 6520 696e 7075 7420 7370   in the input sp
+0007e8c0: 6163 6520 7265 7072 6573 656e 7465 6420  ace represented 
+0007e8d0: 6279 2060 5860 2e0d 0a20 2020 2020 2020  by `X`...       
+0007e8e0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0007e8f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0007e900: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
+0007e910: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
+0007e920: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
+0007e930: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
+0007e940: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+0007e950: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
+0007e960: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
+0007e970: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
+0007e980: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
+0007e990: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0007e9a0: 7072 6f76 6964 6564 2c20 7769 6c6c 2062  provided, will b
+0007e9b0: 6520 7765 6967 6874 6564 2077 6974 6820  e weighted with 
+0007e9c0: 6074 6172 6765 745f 7363 616c 6560 2061  `target_scale` a
+0007e9d0: 6e64 2069 6e63 6c75 6465 6420 696e 0d0a  nd included in..
+0007e9e0: 2020 2020 2020 2020 2020 2020 6b2d 6d65              k-me
+0007e9f0: 616e 7320 636c 7573 7465 7269 6e67 2061  ans clustering a
+0007ea00: 7320 6869 6e74 2e0d 0a20 2020 2020 2020  s hint...       
+0007ea10: 2022 2222 0d0a 2020 2020 2020 2020 6e5f   """..        n_
+0007ea20: 6665 6174 7572 6573 203d 2058 2e73 6861  features = X.sha
+0007ea30: 7065 5b31 5d0d 0a20 2020 2020 2020 2069  pe[1]..        i
+0007ea40: 6620 7920 6973 204e 6f6e 653a 0d0a 2020  f y is None:..  
+0007ea50: 2020 2020 2020 2020 2020 2320 4e6f 2074            # No t
+0007ea60: 6172 6765 7420 7661 7269 6162 6c65 2c20  arget variable, 
+0007ea70: 6a75 7374 2064 6f20 706c 6169 6e20 6b2d  just do plain k-
+0007ea80: 6d65 616e 730d 0a20 2020 2020 2020 2020  means..         
+0007ea90: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
+0007eaa0: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
+0007eab0: 7365 6c66 2e6b 2c0d 0a20 2020 2020 2020  self.k,..       
+0007eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ead0: 2020 2020 2020 2020 2020 206e 5f69 6e69             n_ini
+0007eae0: 743d 3230 2c0d 0a20 2020 2020 2020 2020  t=20,..         
+0007eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007eb00: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+0007eb10: 7374 6174 653d 7365 6c66 2e72 616e 646f  state=self.rando
+0007eb20: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
+0007eb30: 2020 2020 2020 6b6d 5f6d 6f64 656c 2e66        km_model.f
+0007eb40: 6974 2858 290d 0a0d 0a20 2020 2020 2020  it(X)....       
+0007eb50: 2020 2020 2073 656c 662e 6b6d 5f6d 6f64       self.km_mod
+0007eb60: 656c 5f20 3d20 6b6d 5f6d 6f64 656c 0d0a  el_ = km_model..
+0007eb70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0007eb80: 2e63 6c75 7374 6572 5f63 656e 7465 7273  .cluster_centers
+0007eb90: 5f20 3d20 6b6d 5f6d 6f64 656c 2e63 6c75  _ = km_model.clu
+0007eba0: 7374 6572 5f63 656e 7465 7273 5f0d 0a20  ster_centers_.. 
+0007ebb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0007ebc0: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
+0007ebd0: 2020 2320 5468 6572 6520 6973 2074 6172    # There is tar
+0007ebe0: 6765 7420 696e 666f 726d 6174 696f 6e2e  get information.
+0007ebf0: 2041 7070 6c79 2061 7070 726f 7072 6961   Apply appropria
+0007ec00: 7465 2073 6361 6c69 6e67 2061 6e64 2069  te scaling and i
+0007ec10: 6e63 6c75 6465 0d0a 2020 2020 2020 2020  nclude..        
+0007ec20: 2320 696e 746f 2069 6e70 7574 2064 6174  # into input dat
+0007ec30: 6120 746f 206b 2d6d 6561 6e73 0d0a 2020  a to k-means..  
+0007ec40: 2020 2020 2020 6461 7461 5f77 6974 685f        data_with_
+0007ec50: 7461 7267 6574 203d 206e 702e 6873 7461  target = np.hsta
+0007ec60: 636b 2828 582c 2079 5b3a 2c6e 702e 6e65  ck((X, y[:,np.ne
+0007ec70: 7761 7869 735d 2a73 656c 662e 7461 7267  waxis]*self.targ
+0007ec80: 6574 5f73 6361 6c65 2929 0d0a 0d0a 2020  et_scale))....  
+0007ec90: 2020 2020 2020 2320 4275 696c 6420 6120        # Build a 
+0007eca0: 7072 652d 7472 6169 6e69 6e67 206b 2d6d  pre-training k-m
+0007ecb0: 6561 6e73 206d 6f64 656c 206f 6e20 6461  eans model on da
+0007ecc0: 7461 2061 6e64 2074 6172 6765 740d 0a20  ta and target.. 
+0007ecd0: 2020 2020 2020 206b 6d5f 6d6f 6465 6c5f         km_model_
+0007ece0: 7072 6574 7261 696e 203d 204b 4d65 616e  pretrain = KMean
+0007ecf0: 7328 6e5f 636c 7573 7465 7273 3d73 656c  s(n_clusters=sel
+0007ed00: 662e 6b2c 0d0a 2020 2020 2020 2020 2020  f.k,..          
+0007ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ed20: 2020 2020 2020 2020 206e 5f69 6e69 743d           n_init=
+0007ed30: 3230 2c0d 0a20 2020 2020 2020 2020 2020  20,..           
+0007ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ed50: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+0007ed60: 7461 7465 3d73 656c 662e 7261 6e64 6f6d  tate=self.random
+0007ed70: 5f73 7461 7465 290d 0a20 2020 2020 2020  _state)..       
+0007ed80: 206b 6d5f 6d6f 6465 6c5f 7072 6574 7261   km_model_pretra
+0007ed90: 696e 2e66 6974 2864 6174 615f 7769 7468  in.fit(data_with
+0007eda0: 5f74 6172 6765 7429 0d0a 0d0a 2020 2020  _target)....    
+0007edb0: 2020 2020 2320 5275 6e20 6b2d 6d65 616e      # Run k-mean
+0007edc0: 7320 6120 7365 636f 6e64 2074 696d 6520  s a second time 
+0007edd0: 746f 2067 6574 2074 6865 2063 6c75 7374  to get the clust
+0007ede0: 6572 7320 696e 2074 6865 206f 7269 6769  ers in the origi
+0007edf0: 6e61 6c20 7370 6163 650d 0a20 2020 2020  nal space..     
+0007ee00: 2020 2023 2077 6974 686f 7574 2074 6172     # without tar
+0007ee10: 6765 7420 696e 666f 2e20 496e 6974 6961  get info. Initia
+0007ee20: 6c69 7a65 2075 7369 6e67 2063 656e 7472  lize using centr
+0007ee30: 6f69 6473 2066 6f75 6e64 2069 6e20 7072  oids found in pr
+0007ee40: 652d 7472 6169 6e69 6e67 2e0d 0a20 2020  e-training...   
+0007ee50: 2020 2020 2023 2047 6f20 7468 726f 7567       # Go throug
+0007ee60: 6820 6120 7369 6e67 6c65 2069 7465 7261  h a single itera
+0007ee70: 7469 6f6e 206f 6620 636c 7573 7465 7220  tion of cluster 
+0007ee80: 6173 7369 676e 6d65 6e74 2061 6e64 2063  assignment and c
+0007ee90: 656e 7472 6f69 640d 0a20 2020 2020 2020  entroid..       
+0007eea0: 2023 2072 6563 6f6d 7075 7461 7469 6f6e   # recomputation
+0007eeb0: 2e0d 0a20 2020 2020 2020 206b 6d5f 6d6f  ...        km_mo
+0007eec0: 6465 6c20 3d20 4b4d 6561 6e73 286e 5f63  del = KMeans(n_c
+0007eed0: 6c75 7374 6572 733d 7365 6c66 2e6b 2c0d  lusters=self.k,.
+0007eee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007eef0: 2020 2020 2020 2020 2020 2069 6e69 743d             init=
+0007ef00: 6b6d 5f6d 6f64 656c 5f70 7265 7472 6169  km_model_pretrai
+0007ef10: 6e2e 636c 7573 7465 725f 6365 6e74 6572  n.cluster_center
+0007ef20: 735f 5b3a 2c3a 6e5f 6665 6174 7572 6573  s_[:,:n_features
+0007ef30: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0007ef40: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+0007ef50: 696e 6974 3d31 2c0d 0a20 2020 2020 2020  init=1,..       
+0007ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ef70: 2020 206d 6178 5f69 7465 723d 3129 0d0a     max_iter=1)..
+0007ef80: 2020 2020 2020 2020 6b6d 5f6d 6f64 656c          km_model
+0007ef90: 2e66 6974 2858 290d 0a0d 0a20 2020 2020  .fit(X)....     
+0007efa0: 2020 2073 656c 662e 6b6d 5f6d 6f64 656c     self.km_model
+0007efb0: 203d 206b 6d5f 6d6f 6465 6c0d 0a20 2020   = km_model..   
+0007efc0: 2020 2020 2073 656c 662e 636c 7573 7465       self.cluste
+0007efd0: 725f 6365 6e74 6572 735f 203d 206b 6d5f  r_centers_ = km_
+0007efe0: 6d6f 6465 6c2e 636c 7573 7465 725f 6365  model.cluster_ce
+0007eff0: 6e74 6572 735f 0d0a 2020 2020 2020 2020  nters_..        
+0007f000: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
+0007f010: 2020 2064 6566 2074 7261 6e73 666f 726d     def transform
+0007f020: 2873 656c 662c 2058 2c20 793d 4e6f 6e65  (self, X, y=None
+0007f030: 293a 0d0a 2020 2020 2020 2020 2222 224f  ):..        """O
+0007f040: 7574 7075 7420 7468 6520 636c 6f73 6573  utput the closes
+0007f050: 7420 636c 7573 7465 7220 6964 2066 6f72  t cluster id for
+0007f060: 2065 6163 6820 696e 7075 7420 6461 7461   each input data
+0007f070: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
+0007f080: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0007f090: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0007f0a0: 0a20 2020 2020 2020 2058 203a 2061 7272  .        X : arr
+0007f0b0: 6179 2d6c 696b 6520 6f72 2073 7061 7273  ay-like or spars
+0007f0c0: 6520 6d61 7472 6978 2c20 7368 6170 653d  e matrix, shape=
+0007f0d0: 286e 5f64 6174 615f 706f 696e 7473 2c20  (n_data_points, 
+0007f0e0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+0007f0f0: 2020 2020 2079 203a 2076 6563 746f 7220       y : vector 
+0007f100: 6f66 206c 656e 6774 6820 6e5f 6461 7461  of length n_data
+0007f110: 5f70 6f69 6e74 732c 206f 7074 696f 6e61  _points, optiona
+0007f120: 6c2c 2064 6566 6175 6c74 204e 6f6e 650d  l, default None.
+0007f130: 0a20 2020 2020 2020 2020 2020 2054 6172  .            Tar
+0007f140: 6765 7420 7665 6374 6f72 2069 7320 6967  get vector is ig
+0007f150: 6e6f 7265 6420 6576 656e 2069 6620 7072  nored even if pr
+0007f160: 6f76 6964 6564 2e0d 0a20 2020 2020 2020  ovided...       
+0007f170: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0007f180: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0007f190: 2020 2063 6c75 7374 6572 5f69 6473 203a     cluster_ids :
+0007f1a0: 2061 7272 6179 2c20 7368 6170 655b 6e5f   array, shape[n_
+0007f1b0: 6461 7461 5f70 6f69 6e74 732c 315d 0d0a  data_points,1]..
+0007f1c0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0007f1d0: 2020 2020 2063 6c75 7374 6572 7320 3d20       clusters = 
+0007f1e0: 7365 6c66 2e6b 6d5f 6d6f 6465 6c2e 7072  self.km_model.pr
+0007f1f0: 6564 6963 7428 5829 0d0a 2020 2020 2020  edict(X)..      
+0007f200: 2020 7265 7475 726e 2063 6c75 7374 6572    return cluster
+0007f210: 735b 3a2c 6e70 2e6e 6577 6178 6973 5d0d  s[:,np.newaxis].
+0007f220: 0a0d 0a20 2020 2064 6566 2066 6974 5f74  ...    def fit_t
+0007f230: 7261 6e73 666f 726d 2873 656c 662c 2058  ransform(self, X
+0007f240: 2c20 793d 4e6f 6e65 293a 0d0a 2020 2020  , y=None):..    
+0007f250: 2020 2020 2222 2252 756e 7320 6669 7420      """Runs fit 
+0007f260: 666f 6c6c 6f77 6564 2062 7920 7472 616e  followed by tran
+0007f270: 7366 6f72 6d2e 0d0a 2020 2020 2020 2020  sform...        
+0007f280: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
+0007f290: 662e 6669 7428 582c 2079 290d 0a20 2020  f.fit(X, y)..   
+0007f2a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0007f2b0: 2e74 7261 6e73 666f 726d 2858 2c20 7929  .transform(X, y)
+0007f2c0: 0d0a 0d0a 0d0a 6672 6f6d 2063 6f6c 6c65  ......from colle
+0007f2d0: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0007f2e0: 6661 756c 7464 6963 740d 0a69 6d70 6f72  faultdict..impor
+0007f2f0: 7420 6f70 6572 6174 6f72 0d0a 696d 706f  t operator..impo
+0007f300: 7274 2070 6462 0d0a 696d 706f 7274 2063  rt pdb..import c
+0007f310: 6f70 790d 0a66 726f 6d20 736b 6c65 6172  opy..from sklear
+0007f320: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
+0007f330: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
+0007f340: 6573 745f 7370 6c69 740d 0a64 6566 2054  est_split..def T
+0007f350: 7261 6e73 666f 726d 5f4b 4d5f 4665 6174  ransform_KM_Feat
+0007f360: 7572 6573 2874 7261 696e 696e 675f 6461  ures(training_da
+0007f370: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
+0007f380: 656c 732c 2074 6573 745f 6461 7461 2c20  els, test_data, 
+0007f390: 6b6d 5f6d 6178 3d30 293a 0d0a 2020 2020  km_max=0):..    
+0007f3a0: 7365 6564 203d 2039 390d 0a20 2020 2070  seed = 99..    p
+0007f3b0: 7265 6473 203d 206c 6973 7428 7472 6169  reds = list(trai
+0007f3c0: 6e69 6e67 5f64 6174 6129 0d0a 2020 2020  ning_data)..    
+0007f3d0: 7461 7267 6574 203d 2074 7261 696e 696e  target = trainin
+0007f3e0: 675f 6c61 6265 6c73 2e6e 616d 650d 0a20  g_labels.name.. 
+0007f3f0: 2020 2074 7261 696e 5f69 6e64 6578 203d     train_index =
+0007f400: 2020 7472 6169 6e69 6e67 5f64 6174 612e    training_data.
+0007f410: 696e 6465 780d 0a20 2020 2074 6573 745f  index..    test_
+0007f420: 696e 6465 7820 3d20 2074 6573 745f 6461  index =  test_da
+0007f430: 7461 2e69 6e64 6578 0d0a 2020 2020 6966  ta.index..    if
+0007f440: 206b 6d5f 6d61 7820 3c3d 2032 3a0d 0a20   km_max <= 2:.. 
+0007f450: 2020 2020 2020 206b 5f6d 6178 203d 2032         k_max = 2
+0007f460: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0007f470: 2020 2020 206b 5f6d 6178 203d 2063 6f70       k_max = cop
+0007f480: 792e 6465 6570 636f 7079 286b 6d5f 6d61  y.deepcopy(km_ma
+0007f490: 7829 0d0a 2020 2020 2323 2320 4361 6c63  x)..    ### Calc
+0007f4a0: 756c 6174 6520 7468 6520 7461 7267 6574  ulate the target
+0007f4b0: 2073 6361 6c65 2068 6572 6520 3d3e 2074   scale here => t
+0007f4c0: 6865 2068 6967 6865 7220 7468 6520 6e75  he higher the nu
+0007f4d0: 6d62 6572 2074 6865 2062 6574 7465 7220  mber the better 
+0007f4e0: 666f 7220 7461 7267 6574 2061 6363 7572  for target accur
+0007f4f0: 6163 790d 0a20 2020 2074 7279 3a0d 0a20  acy..    try:.. 
+0007f500: 2020 2020 2020 2069 6620 7472 6169 6e69         if traini
+0007f510: 6e67 5f6c 6162 656c 732e 6474 7970 6520  ng_labels.dtype 
+0007f520: 696e 205b 6e70 2e66 6c6f 6174 3634 2c6e  in [np.float64,n
+0007f530: 702e 666c 6f61 7433 322c 6e70 2e66 6c6f  p.float32,np.flo
+0007f540: 6174 3136 5d3a 0d0a 2020 2020 2020 2020  at16]:..        
+0007f550: 2020 2020 7461 7267 6574 5f72 616e 6765      target_range
+0007f560: 203d 2066 6c6f 6174 2861 6273 2874 7261   = float(abs(tra
+0007f570: 696e 696e 675f 6c61 6265 6c73 2e6d 6178  ining_labels.max
+0007f580: 2829 202d 2074 7261 696e 696e 675f 6c61  () - training_la
+0007f590: 6265 6c73 2e6d 696e 2829 2929 0d0a 2020  bels.min()))..  
+0007f5a0: 2020 2020 2020 656c 6966 2074 7261 696e        elif train
+0007f5b0: 696e 675f 6c61 6265 6c73 2e64 7479 7065  ing_labels.dtype
+0007f5c0: 2069 6e20 5b6f 626a 6563 742c 626f 6f6c   in [object,bool
+0007f5d0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+0007f5e0: 7461 7267 6574 5f72 616e 6765 203d 2069  target_range = i
+0007f5f0: 6e74 286c 656e 2843 6f75 6e74 6572 2874  nt(len(Counter(t
+0007f600: 7261 696e 696e 675f 6c61 6265 6c73 2929  raining_labels))
+0007f610: 202b 2033 290d 0a20 2020 2020 2020 2065   + 3)..        e
+0007f620: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0007f630: 2020 7461 7267 6574 5f72 616e 6765 203d    target_range =
+0007f640: 2069 6e74 2861 6273 2874 7261 696e 696e   int(abs(trainin
+0007f650: 675f 6c61 6265 6c73 2e6d 6178 2829 202d  g_labels.max() -
+0007f660: 2074 7261 696e 696e 675f 6c61 6265 6c73   training_labels
+0007f670: 2e6d 696e 2829 2929 0d0a 2020 2020 6578  .min()))..    ex
+0007f680: 6365 7074 3a0d 0a20 2020 2020 2020 2074  cept:..        t
+0007f690: 6172 6765 745f 7261 6e67 6520 3d20 352e  arget_range = 5.
+0007f6a0: 300d 0a20 2020 206b 6d66 203d 2020 4b4d  0..    kmf =  KM
+0007f6b0: 6561 6e73 4665 6174 7572 697a 6572 286b  eansFeaturizer(k
+0007f6c0: 3d6b 5f6d 6178 2c20 7461 7267 6574 5f73  =k_max, target_s
+0007f6d0: 6361 6c65 3d74 6172 6765 745f 7261 6e67  cale=target_rang
+0007f6e0: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
+0007f6f0: 7365 6564 290d 0a20 2020 206b 6d66 5f68  seed)..    kmf_h
+0007f700: 696e 7420 3d20 6b6d 662e 6669 7428 7472  int = kmf.fit(tr
+0007f710: 6169 6e69 6e67 5f64 6174 612c 2074 7261  aining_data, tra
+0007f720: 696e 696e 675f 6c61 6265 6c73 290d 0a20  ining_labels).. 
+0007f730: 2020 2023 2323 204a 7573 7420 7265 7475     ### Just retu
+0007f740: 726e 2069 7420 7769 7468 2074 6865 2063  rn it with the c
+0007f750: 6c75 7374 6572 2063 6f6c 756d 6e20 3d3e  luster column =>
+0007f760: 206e 6f20 6e65 6564 2074 6f20 7265 7475   no need to retu
+0007f770: 726e 2074 6865 2064 6174 6120 6672 616d  rn the data fram
+0007f780: 6520 2323 230d 0a20 2020 2074 7261 696e  e ###..    train
+0007f790: 696e 675f 636c 7573 7465 725f 6665 6174  ing_cluster_feat
+0007f7a0: 7572 6573 203d 206b 6d66 5f68 696e 742e  ures = kmf_hint.
+0007f7b0: 7472 616e 7366 6f72 6d28 7472 6169 6e69  transform(traini
+0007f7c0: 6e67 5f64 6174 6129 0d0a 2020 2020 7465  ng_data)..    te
+0007f7d0: 7374 5f63 6c75 7374 6572 5f66 6561 7475  st_cluster_featu
+0007f7e0: 7265 7320 3d20 6b6d 665f 6869 6e74 2e74  res = kmf_hint.t
+0007f7f0: 7261 6e73 666f 726d 2874 6573 745f 6461  ransform(test_da
+0007f800: 7461 290d 0a20 2020 206e 7078 203d 206e  ta)..    npx = n
+0007f810: 702e 635f 5b74 7261 696e 696e 675f 6461  p.c_[training_da
+0007f820: 7461 2c20 7472 6169 6e69 6e67 5f6c 6162  ta, training_lab
+0007f830: 656c 732e 7661 6c75 6573 5d0d 0a20 2020  els.values]..   
+0007f840: 2074 7261 696e 696e 675f 7769 7468 5f63   training_with_c
+0007f850: 6c75 7374 6572 203d 206e 702e 635f 5b6e  luster = np.c_[n
+0007f860: 7078 2c74 7261 696e 696e 675f 636c 7573  px,training_clus
+0007f870: 7465 725f 6665 6174 7572 6573 5d0d 0a20  ter_features].. 
+0007f880: 2020 2074 6573 745f 7769 7468 5f63 6c75     test_with_clu
+0007f890: 7374 6572 203d 206e 702e 635f 5b74 6573  ster = np.c_[tes
+0007f8a0: 745f 6461 7461 2c20 7465 7374 5f63 6c75  t_data, test_clu
+0007f8b0: 7374 6572 5f66 6561 7475 7265 735d 0d0a  ster_features]..
+0007f8c0: 2020 2020 2323 2320 5765 2061 7265 2067      ### We are g
+0007f8d0: 6f69 6e67 2074 6f20 6a75 7374 2072 6574  oing to just ret
+0007f8e0: 7572 6e20 7468 6520 636c 7573 7465 7220  urn the cluster 
+0007f8f0: 7661 6c75 6573 2023 2323 2323 230d 0a20  values ######.. 
+0007f900: 2020 2074 7261 696e 5f77 6974 685f 636c     train_with_cl
+0007f910: 7573 7465 725f 6466 203d 2074 7261 696e  uster_df = train
+0007f920: 696e 675f 7769 7468 5f63 6c75 7374 6572  ing_with_cluster
+0007f930: 5b3a 2c2d 315d 0d0a 2020 2020 7465 7374  [:,-1]..    test
+0007f940: 5f77 6974 685f 636c 7573 7465 725f 6466  _with_cluster_df
+0007f950: 203d 2074 6573 745f 7769 7468 5f63 6c75   = test_with_clu
+0007f960: 7374 6572 5b3a 2c2d 315d 0d0a 2020 2020  ster[:,-1]..    
+0007f970: 2374 7261 696e 5f77 6974 685f 636c 7573  #train_with_clus
+0007f980: 7465 725f 6466 203d 2070 642e 4461 7461  ter_df = pd.Data
+0007f990: 4672 616d 6528 7472 6169 6e69 6e67 5f77  Frame(training_w
+0007f9a0: 6974 685f 636c 7573 7465 722c 696e 6465  ith_cluster,inde
+0007f9b0: 783d 7472 6169 6e5f 696e 6465 782c 0d0a  x=train_index,..
+0007f9c0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0007f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f9e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d70         columns=p
+0007f9f0: 7265 6473 2b5b 7461 7267 6574 2c27 636c  reds+[target,'cl
+0007fa00: 7573 7465 7227 5d29 0d0a 2020 2020 2374  uster'])..    #t
+0007fa10: 6573 745f 7769 7468 5f63 6c75 7374 6572  est_with_cluster
+0007fa20: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
+0007fa30: 6d65 2874 6573 745f 7769 7468 5f63 6c75  me(test_with_clu
+0007fa40: 7374 6572 2c69 6e64 6578 3d74 6573 745f  ster,index=test_
+0007fa50: 696e 6465 782c 0d0a 2020 2020 2320 2020  index,..    #   
+0007fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fa70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0007fa80: 6f6c 756d 6e73 3d70 7265 6473 2b5b 2763  olumns=preds+['c
+0007fa90: 6c75 7374 6572 275d 290d 0a20 2020 2072  luster'])..    r
+0007faa0: 6574 7572 6e20 7472 6169 6e5f 7769 7468  eturn train_with
+0007fab0: 5f63 6c75 7374 6572 5f64 662c 2074 6573  _cluster_df, tes
+0007fac0: 745f 7769 7468 5f63 6c75 7374 6572 5f64  t_with_cluster_d
+0007fad0: 660d 0a00 0000 0000 0000 0000 0000 0000  f...............
 0007fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0007fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0007fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fb40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0007fb50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fc00: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-0007fc10: 662d 3820 2d2a 2d0d 0a23 2323 2323 2323  f-8 -*-..#######
-0007fc20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fc30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fc40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fc50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fc60: 2323 2323 2323 2323 230d 0a23 2020 2020  #########..#    
-0007fc70: 2041 7574 6f5f 5669 4d4c 202d 2041 7574   Auto_ViML - Aut
-0007fc80: 6f6d 6174 6963 616c 6c79 2042 7569 6c64  omatically Build
-0007fc90: 204d 756c 7469 706c 6520 496e 7465 7270   Multiple Interp
-0007fca0: 7265 7461 626c 6520 4d4c 204d 6f64 656c  retable ML Model
-0007fcb0: 7320 696e 2053 696e 676c 6520 4c69 6e65  s in Single Line
-0007fcc0: 206f 6620 436f 6465 0d0a 2320 2020 2020   of Code..#     
-0007fcd0: 5079 7468 6f6e 2076 332e 362b 0d0a 2320  Python v3.6+..# 
-0007fce0: 2020 2020 4372 6561 7465 6420 6279 2052      Created by R
-0007fcf0: 616d 2053 6573 6861 6472 690d 0a23 2020  am Seshadri..#  
-0007fd00: 2020 204c 6963 656e 7365 6420 756e 6465     Licensed unde
-0007fd10: 7220 4170 6163 6865 204c 6963 656e 7365  r Apache License
-0007fd20: 2076 320d 0a23 2323 2323 2323 2323 2323   v2..###########
-0007fd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0007fd70: 2323 2323 230d 0a23 2056 6572 7369 6f6e  #####..# Version
-0007fd80: 0d0a 6672 6f6d 202e 5f5f 7665 7273 696f  ..from .__versio
-0007fd90: 6e5f 5f20 696d 706f 7274 205f 5f76 6572  n__ import __ver
-0007fda0: 7369 6f6e 5f5f 2c20 5f5f 6e6c 705f 7665  sion__, __nlp_ve
-0007fdb0: 7273 696f 6e5f 5f0d 0a69 6620 5f5f 6e61  rsion__..if __na
-0007fdc0: 6d65 5f5f 203d 3d20 225f 5f6d 6169 6e5f  me__ == "__main_
-0007fdd0: 5f22 3a0d 0a20 2020 206d 6f64 756c 655f  _":..    module_
-0007fde0: 7479 7065 203d 2027 5275 6e6e 696e 6727  type = 'Running'
-0007fdf0: 0d0a 656c 7365 3a0d 0a20 2020 206d 6f64  ..else:..    mod
-0007fe00: 756c 655f 7479 7065 203d 2027 496d 706f  ule_type = 'Impo
-0007fe10: 7274 6564 270d 0a76 696d 6c5f 7665 7273  rted'..viml_vers
-0007fe20: 696f 6e5f 6e75 6d62 6572 203d 205f 5f76  ion_number = __v
-0007fe30: 6572 7369 6f6e 5f5f 0d0a 6e6c 705f 7665  ersion__..nlp_ve
-0007fe40: 7273 696f 6e5f 6e75 6d62 6572 203d 205f  rsion_number = _
-0007fe50: 5f6e 6c70 5f76 6572 7369 6f6e 5f5f 0d0a  _nlp_version__..
-0007fe60: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
-0007fe70: 5f56 694d 4c20 7665 7273 696f 6e3a 2025  _ViML version: %
-0007fe80: 732e 2043 616c 6c20 7573 696e 673a 0d0a  s. Call using:..
-0007fe90: 2020 2020 2020 2020 2020 2020 206d 2c20               m, 
-0007fea0: 6665 6174 732c 2074 7261 696e 6d2c 2074  feats, trainm, t
-0007feb0: 6573 746d 203d 2041 7574 6f5f 5669 4d4c  estm = Auto_ViML
-0007fec0: 2874 7261 696e 2c20 7461 7267 6574 2c20  (train, target, 
-0007fed0: 7465 7374 2c0d 0a20 2020 2020 2020 2020  test,..         
-0007fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fef0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
-0007ff00: 7369 6f6e 3d27 272c 0d0a 2020 2020 2020  sion='',..      
-0007ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff20: 2020 2020 2020 7363 6f72 696e 675f 7061        scoring_pa
-0007ff30: 7261 6d65 7465 723d 2727 2c20 4b4d 6561  rameter='', KMea
-0007ff40: 6e73 5f46 6561 7475 7269 7a65 723d 4661  ns_Featurizer=Fa
-0007ff50: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0007ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff70: 2020 6879 7065 725f 7061 7261 6d3d 2752    hyper_param='R
-0007ff80: 5327 2c66 6561 7475 7265 5f72 6564 7563  S',feature_reduc
-0007ff90: 7469 6f6e 3d54 7275 652c 0d0a 2020 2020  tion=True,..    
-0007ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ffb0: 2020 2020 2020 2020 2042 6f6f 7374 696e           Boostin
-0007ffc0: 675f 466c 6167 3d27 4361 7442 6f6f 7374  g_Flag='CatBoost
-0007ffd0: 272c 2042 696e 6e69 6e67 5f46 6c61 673d  ', Binning_Flag=
-0007ffe0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0007fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080000: 2020 2020 4164 645f 506f 6c79 3d30 2c20      Add_Poly=0, 
-00080010: 5374 6163 6b69 6e67 5f46 6c61 673d 4661  Stacking_Flag=Fa
-00080020: 6c73 652c 496d 6261 6c61 6e63 6564 5f46  lse,Imbalanced_F
-00080030: 6c61 673d 4661 6c73 652c 0d0a 2020 2020  lag=False,..    
-00080040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080050: 2020 2020 2020 2020 4750 555f 666c 6167          GPU_flag
-00080060: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
-00080070: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00080080: 2222 2220 2528 6d6f 6475 6c65 5f74 7970  """ %(module_typ
-00080090: 652c 2076 696d 6c5f 7665 7273 696f 6e5f  e, viml_version_
-000800a0: 6e75 6d62 6572 2929 0d0a 7072 696e 7428  number))..print(
-000800b0: 290d 0a23 2323 2323 2323 2323 2323 2323  )..#############
-000800c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000800d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000800e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000800f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080100: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00080110: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
-00080120: 5f4e 4c50 2076 6572 7369 6f6e 3a20 2573  _NLP version: %s
-00080130: 2e2e 2043 616c 6c20 7573 696e 673a 0d0a  .. Call using:..
-00080140: 2020 2020 2074 7261 696e 5f6e 6c70 2c20       train_nlp, 
-00080150: 7465 7374 5f6e 6c70 2c20 6e6c 705f 7069  test_nlp, nlp_pi
-00080160: 7065 6c69 6e65 2c20 7072 6564 6963 7469  peline, predicti
-00080170: 6f6e 7320 3d20 4175 746f 5f4e 4c50 280d  ons = Auto_NLP(.
-00080180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00080190: 206e 6c70 5f63 6f6c 756d 6e2c 2074 7261   nlp_column, tra
-000801a0: 696e 2c20 7465 7374 2c20 7461 7267 6574  in, test, target
-000801b0: 2c20 7363 6f72 655f 7479 7065 3d27 6261  , score_type='ba
-000801c0: 6c61 6e63 6564 5f61 6363 7572 6163 7927  lanced_accuracy'
-000801d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000801e0: 2020 206d 6f64 656c 7479 7065 3d27 436c     modeltype='Cl
-000801f0: 6173 7369 6669 6361 7469 6f6e 272c 746f  assification',to
-00080200: 705f 6e75 6d5f 6665 6174 7572 6573 3d32  p_num_features=2
-00080210: 3030 2c20 7665 7262 6f73 653d 302c 0d0a  00, verbose=0,..
-00080220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080230: 6275 696c 645f 6d6f 6465 6c3d 5472 7565  build_model=True
-00080240: 2922 2222 2025 286d 6f64 756c 655f 7479  )""" %(module_ty
-00080250: 7065 2c20 6e6c 705f 7665 7273 696f 6e5f  pe, nlp_version_
-00080260: 6e75 6d62 6572 2929 0d0a 2323 2323 2323  number))..######
-00080270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00080290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000802a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000802b0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
-000802c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000802d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000802e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000802f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000803f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00080410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00080470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00080480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00080490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000804a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000804b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000804c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000804d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000804e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000804f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00080510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00080550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00080560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000805f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080600: 3232 206d 7469 6d65 3d31 3638 3433 3237  22 mtime=1684327
-00080610: 3136 342e 300a 0000 0000 0000 0000 0000  164.0...........
-00080620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000806f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000807f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00080810: 2f61 7574 6f76 696d 6c2f 5f5f 7665 7273  /autoviml/__vers
-00080820: 696f 6e5f 5f2e 7079 0000 0000 0000 0000  ion__.py........
-00080830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00080870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00080880: 3030 3030 3633 3300 3030 3030 3030 3030  0000633.00000000
-00080890: 3030 3000 3031 3736 3132 0020 3000 0000  000.017612. 0...
-000808a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000808b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0007fc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0007fc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0007fc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0007fc90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0007fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0007fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0007fd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0007fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe00: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
+0007fe10: 3638 392e 300a 0000 0000 0000 0000 0000  689.0...........
+0007fe20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fe90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0007fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00080010: 2f61 7574 6f76 696d 6c2f 5f5f 696e 6974  /autoviml/__init
+00080020: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
+00080030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00080070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00080080: 3030 3033 3236 3400 3030 3030 3030 3030  0003264.00000000
+00080090: 3030 3000 3031 3730 3734 0020 3000 0000  000.017074. 0...
+000800a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000800b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000800c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000800d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000800e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000800f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00080110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00080130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00080150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00080160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000801f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080200: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
+00080210: 662d 3820 2d2a 2d0d 0a23 2323 2323 2323  f-8 -*-..#######
+00080220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080260: 2323 2323 2323 2323 230d 0a23 2020 2020  #########..#    
+00080270: 2041 7574 6f5f 5669 4d4c 202d 2041 7574   Auto_ViML - Aut
+00080280: 6f6d 6174 6963 616c 6c79 2042 7569 6c64  omatically Build
+00080290: 204d 756c 7469 706c 6520 496e 7465 7270   Multiple Interp
+000802a0: 7265 7461 626c 6520 4d4c 204d 6f64 656c  retable ML Model
+000802b0: 7320 696e 2053 696e 676c 6520 4c69 6e65  s in Single Line
+000802c0: 206f 6620 436f 6465 0d0a 2320 2020 2020   of Code..#     
+000802d0: 5079 7468 6f6e 2076 332e 362b 0d0a 2320  Python v3.6+..# 
+000802e0: 2020 2020 4372 6561 7465 6420 6279 2052      Created by R
+000802f0: 616d 2053 6573 6861 6472 690d 0a23 2020  am Seshadri..#  
+00080300: 2020 204c 6963 656e 7365 6420 756e 6465     Licensed unde
+00080310: 7220 4170 6163 6865 204c 6963 656e 7365  r Apache License
+00080320: 2076 320d 0a23 2323 2323 2323 2323 2323   v2..###########
+00080330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080370: 2323 2323 230d 0a23 2056 6572 7369 6f6e  #####..# Version
+00080380: 0d0a 6672 6f6d 202e 5f5f 7665 7273 696f  ..from .__versio
+00080390: 6e5f 5f20 696d 706f 7274 205f 5f76 6572  n__ import __ver
+000803a0: 7369 6f6e 5f5f 2c20 5f5f 6e6c 705f 7665  sion__, __nlp_ve
+000803b0: 7273 696f 6e5f 5f0d 0a69 6620 5f5f 6e61  rsion__..if __na
+000803c0: 6d65 5f5f 203d 3d20 225f 5f6d 6169 6e5f  me__ == "__main_
+000803d0: 5f22 3a0d 0a20 2020 206d 6f64 756c 655f  _":..    module_
+000803e0: 7479 7065 203d 2027 5275 6e6e 696e 6727  type = 'Running'
+000803f0: 0d0a 656c 7365 3a0d 0a20 2020 206d 6f64  ..else:..    mod
+00080400: 756c 655f 7479 7065 203d 2027 496d 706f  ule_type = 'Impo
+00080410: 7274 6564 270d 0a76 696d 6c5f 7665 7273  rted'..viml_vers
+00080420: 696f 6e5f 6e75 6d62 6572 203d 205f 5f76  ion_number = __v
+00080430: 6572 7369 6f6e 5f5f 0d0a 6e6c 705f 7665  ersion__..nlp_ve
+00080440: 7273 696f 6e5f 6e75 6d62 6572 203d 205f  rsion_number = _
+00080450: 5f6e 6c70 5f76 6572 7369 6f6e 5f5f 0d0a  _nlp_version__..
+00080460: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
+00080470: 5f56 694d 4c20 7665 7273 696f 6e3a 2025  _ViML version: %
+00080480: 732e 2043 616c 6c20 7573 696e 673a 0d0a  s. Call using:..
+00080490: 2020 2020 2020 2020 2020 2020 206d 2c20               m, 
+000804a0: 6665 6174 732c 2074 7261 696e 6d2c 2074  feats, trainm, t
+000804b0: 6573 746d 203d 2041 7574 6f5f 5669 4d4c  estm = Auto_ViML
+000804c0: 2874 7261 696e 2c20 7461 7267 6574 2c20  (train, target, 
+000804d0: 7465 7374 2c0d 0a20 2020 2020 2020 2020  test,..         
+000804e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000804f0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
+00080500: 7369 6f6e 3d27 272c 0d0a 2020 2020 2020  sion='',..      
+00080510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080520: 2020 2020 2020 7363 6f72 696e 675f 7061        scoring_pa
+00080530: 7261 6d65 7465 723d 2727 2c20 4b4d 6561  rameter='', KMea
+00080540: 6e73 5f46 6561 7475 7269 7a65 723d 4661  ns_Featurizer=Fa
+00080550: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+00080560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080570: 2020 6879 7065 725f 7061 7261 6d3d 2752    hyper_param='R
+00080580: 5327 2c66 6561 7475 7265 5f72 6564 7563  S',feature_reduc
+00080590: 7469 6f6e 3d54 7275 652c 0d0a 2020 2020  tion=True,..    
+000805a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000805b0: 2020 2020 2020 2020 2042 6f6f 7374 696e           Boostin
+000805c0: 675f 466c 6167 3d27 4361 7442 6f6f 7374  g_Flag='CatBoost
+000805d0: 272c 2042 696e 6e69 6e67 5f46 6c61 673d  ', Binning_Flag=
+000805e0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+000805f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080600: 2020 2020 4164 645f 506f 6c79 3d30 2c20      Add_Poly=0, 
+00080610: 5374 6163 6b69 6e67 5f46 6c61 673d 4661  Stacking_Flag=Fa
+00080620: 6c73 652c 496d 6261 6c61 6e63 6564 5f46  lse,Imbalanced_F
+00080630: 6c61 673d 4661 6c73 652c 0d0a 2020 2020  lag=False,..    
+00080640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080650: 2020 2020 2020 2020 4750 555f 666c 6167          GPU_flag
+00080660: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
+00080670: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00080680: 2222 2220 2528 6d6f 6475 6c65 5f74 7970  """ %(module_typ
+00080690: 652c 2076 696d 6c5f 7665 7273 696f 6e5f  e, viml_version_
+000806a0: 6e75 6d62 6572 2929 0d0a 7072 696e 7428  number))..print(
+000806b0: 290d 0a23 2323 2323 2323 2323 2323 2323  )..#############
+000806c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000806d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000806e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000806f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080700: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00080710: 7072 696e 7428 2222 2225 7320 4175 746f  print("""%s Auto
+00080720: 5f4e 4c50 2076 6572 7369 6f6e 3a20 2573  _NLP version: %s
+00080730: 2e2e 2043 616c 6c20 7573 696e 673a 0d0a  .. Call using:..
+00080740: 2020 2020 2074 7261 696e 5f6e 6c70 2c20       train_nlp, 
+00080750: 7465 7374 5f6e 6c70 2c20 6e6c 705f 7069  test_nlp, nlp_pi
+00080760: 7065 6c69 6e65 2c20 7072 6564 6963 7469  peline, predicti
+00080770: 6f6e 7320 3d20 4175 746f 5f4e 4c50 280d  ons = Auto_NLP(.
+00080780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080790: 206e 6c70 5f63 6f6c 756d 6e2c 2074 7261   nlp_column, tra
+000807a0: 696e 2c20 7465 7374 2c20 7461 7267 6574  in, test, target
+000807b0: 2c20 7363 6f72 655f 7479 7065 3d27 6261  , score_type='ba
+000807c0: 6c61 6e63 6564 5f61 6363 7572 6163 7927  lanced_accuracy'
+000807d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000807e0: 2020 206d 6f64 656c 7479 7065 3d27 436c     modeltype='Cl
+000807f0: 6173 7369 6669 6361 7469 6f6e 272c 746f  assification',to
+00080800: 705f 6e75 6d5f 6665 6174 7572 6573 3d32  p_num_features=2
+00080810: 3030 2c20 7665 7262 6f73 653d 302c 0d0a  00, verbose=0,..
+00080820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080830: 6275 696c 645f 6d6f 6465 6c3d 5472 7565  build_model=True
+00080840: 2922 2222 2025 286d 6f64 756c 655f 7479  )""" %(module_ty
+00080850: 7065 2c20 6e6c 705f 7665 7273 696f 6e5f  pe, nlp_version_
+00080860: 6e75 6d62 6572 2929 0d0a 2323 2323 2323  number))..######
+00080870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00080890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000808a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000808b0: 2323 0d0a 0000 0000 0000 0000 0000 0000  ##..............
 000808c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00080900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00080920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00080950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00080940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000809f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080a00: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-00080a10: 662d 3820 2d2a 2d0d 0a22 2222 5370 6563  f-8 -*-.."""Spec
-00080a20: 6966 6965 7320 7468 6520 7665 7273 696f  ifies the versio
-00080a30: 6e20 6f66 2074 6865 2041 7574 6f5f 5669  n of the Auto_Vi
-00080a40: 4d4c 2070 6163 6b61 6765 2e22 2222 0d0a  ML package."""..
-00080a50: 0d0a 5f5f 7469 746c 655f 5f20 3d20 2241  ..__title__ = "A
-00080a60: 7574 6f5f 5669 4d4c 220d 0a5f 5f61 7574  uto_ViML"..__aut
-00080a70: 686f 725f 5f20 3d20 2252 616d 2053 6573  hor__ = "Ram Ses
-00080a80: 6861 6472 6922 0d0a 5f5f 6465 7363 7269  hadri"..__descri
-00080a90: 7074 696f 6e5f 5f20 3d20 2241 7574 6f6d  ption__ = "Autom
-00080aa0: 6174 6963 616c 6c79 2042 7569 6c64 204d  atically Build M
-00080ab0: 756c 7469 706c 6520 496e 7465 7270 7265  ultiple Interpre
-00080ac0: 7461 626c 6520 4d4c 204d 6f64 656c 7320  table ML Models 
-00080ad0: 696e 2053 696e 676c 6520 4c69 6e65 206f  in Single Line o
-00080ae0: 6620 436f 6465 220d 0a5f 5f75 726c 5f5f  f Code"..__url__
-00080af0: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
-00080b00: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
-00080b10: 4175 746f 5f56 694d 4c2e 6769 7422 0d0a  Auto_ViML.git"..
-00080b20: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
-00080b30: 2e31 2e37 3135 220d 0a5f 5f6e 6c70 5f76  .1.715"..__nlp_v
-00080b40: 6572 7369 6f6e 5f5f 203d 2022 302e 312e  ersion__ = "0.1.
-00080b50: 3031 220d 0a5f 5f6c 6963 656e 7365 5f5f  01"..__license__
-00080b60: 203d 2022 4170 6163 6865 204c 6963 656e   = "Apache Licen
-00080b70: 7365 2032 2e30 220d 0a5f 5f63 6f70 7972  se 2.0"..__copyr
-00080b80: 6967 6874 5f5f 203d 2022 3230 3230 2d32  ight__ = "2020-2
-00080b90: 3120 476f 6f67 6c65 220d 0a00 0000 0000  1 Google".......
+00080a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00080a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00080a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00080a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00080a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00080aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00080b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00080b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00080b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00080c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c00: 3232 206d 7469 6d65 3d31 3638 3437 3037  22 mtime=1684707
+00080c10: 3036 382e 300a 0000 0000 0000 0000 0000  068.0...........
 00080c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00080c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00080c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00080c90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00080c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00080d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00080d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00080d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080e00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00080e10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00080e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00080e10: 2f61 7574 6f76 696d 6c2f 5f5f 7665 7273  /autoviml/__vers
+00080e20: 696f 6e5f 5f2e 7079 0000 0000 0000 0000  ion__.py........
 00080e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00080e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00080e80: 3030 3030 3633 3300 3030 3030 3030 3030  0000633.00000000
+00080e90: 3030 3000 3031 3736 3133 0020 3000 0000  000.017613. 0...
 00080ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00080f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00080f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00080f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00080f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00080f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00081010: 2f61 7574 6f76 696d 6c2f 636c 6173 7369  /autoviml/classi
-00081020: 6679 5f6d 6574 686f 642e 7079 0000 0000  fy_method.py....
-00081030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00081070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00081080: 3030 3433 3630 3200 3030 3030 3030 3030  0043602.00000000
-00081090: 3030 3000 3032 3035 3131 0020 3000 0000  000.020511. 0...
-000810a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000810b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000810c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000810d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000810e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000810f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00081110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00081130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00081150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00081160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
+00081010: 662d 3820 2d2a 2d0d 0a22 2222 5370 6563  f-8 -*-.."""Spec
+00081020: 6966 6965 7320 7468 6520 7665 7273 696f  ifies the versio
+00081030: 6e20 6f66 2074 6865 2041 7574 6f5f 5669  n of the Auto_Vi
+00081040: 4d4c 2070 6163 6b61 6765 2e22 2222 0d0a  ML package."""..
+00081050: 0d0a 5f5f 7469 746c 655f 5f20 3d20 2241  ..__title__ = "A
+00081060: 7574 6f5f 5669 4d4c 220d 0a5f 5f61 7574  uto_ViML"..__aut
+00081070: 686f 725f 5f20 3d20 2252 616d 2053 6573  hor__ = "Ram Ses
+00081080: 6861 6472 6922 0d0a 5f5f 6465 7363 7269  hadri"..__descri
+00081090: 7074 696f 6e5f 5f20 3d20 2241 7574 6f6d  ption__ = "Autom
+000810a0: 6174 6963 616c 6c79 2042 7569 6c64 204d  atically Build M
+000810b0: 756c 7469 706c 6520 496e 7465 7270 7265  ultiple Interpre
+000810c0: 7461 626c 6520 4d4c 204d 6f64 656c 7320  table ML Models 
+000810d0: 696e 2053 696e 676c 6520 4c69 6e65 206f  in Single Line o
+000810e0: 6620 436f 6465 220d 0a5f 5f75 726c 5f5f  f Code"..__url__
+000810f0: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
+00081100: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
+00081110: 4175 746f 5f56 694d 4c2e 6769 7422 0d0a  Auto_ViML.git"..
+00081120: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
+00081130: 2e31 2e37 3136 220d 0a5f 5f6e 6c70 5f76  .1.716"..__nlp_v
+00081140: 6572 7369 6f6e 5f5f 203d 2022 302e 312e  ersion__ = "0.1.
+00081150: 3031 220d 0a5f 5f6c 6963 656e 7365 5f5f  01"..__license__
+00081160: 203d 2022 4170 6163 6865 204c 6963 656e   = "Apache Licen
+00081170: 7365 2032 2e30 220d 0a5f 5f63 6f70 7972  se 2.0"..__copyr
+00081180: 6967 6874 5f5f 203d 2022 3230 3230 2d32  ight__ = "2020-2
+00081190: 3120 476f 6f67 6c65 220d 0a00 0000 0000  1 Google".......
 000811a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000811b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000811c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000811d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000811e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000811f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00081200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00081210: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-00081220: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
-00081230: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
-00081240: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
-00081250: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
-00081260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000812a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
-000812b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
-000812c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
-000812d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
-000812e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
-000812f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
-00081300: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
-00081310: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
-00081320: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
-00081330: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
-00081340: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
-00081350: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
-00081360: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
-00081370: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-00081380: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
-00081390: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
-000813a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
-000813b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
-000813c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-000813d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
-000813e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
-000813f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
-00081400: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-00081410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081450: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
-00081460: 6462 0d0a 6672 6f6d 2066 756e 6374 6f6f  db..from functoo
-00081470: 6c73 2069 6d70 6f72 7420 7265 6475 6365  ls import reduce
-00081480: 0d0a 696d 706f 7274 2063 6f70 790d 0a69  ..import copy..i
-00081490: 6d70 6f72 7420 7469 6d65 0d0a 6465 6620  mport time..def 
-000814a0: 6c65 6674 5f73 7562 7472 6163 7428 6c31  left_subtract(l1
-000814b0: 2c6c 3229 3a0d 0a20 2020 206c 7374 203d  ,l2):..    lst =
-000814c0: 205b 5d0d 0a20 2020 2066 6f72 2069 2069   []..    for i i
-000814d0: 6e20 6c31 3a0d 0a20 2020 2020 2020 2069  n l1:..        i
-000814e0: 6620 6920 6e6f 7420 696e 206c 323a 0d0a  f i not in l2:..
-000814f0: 2020 2020 2020 2020 2020 2020 6c73 742e              lst.
-00081500: 6170 7065 6e64 2869 290d 0a20 2020 2072  append(i)..    r
-00081510: 6574 7572 6e20 6c73 740d 0a23 2323 2323  eturn lst..#####
-00081520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081560: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
-00081570: 706f 7274 2063 6f70 790d 0a64 6566 2045  port copy..def E
-00081580: 4441 5f66 696e 645f 7265 6d6f 7665 5f63  DA_find_remove_c
-00081590: 6f6c 756d 6e73 5f77 6974 685f 696e 6669  olumns_with_infi
-000815a0: 6e69 7479 2864 662c 2072 656d 6f76 653d  nity(df, remove=
-000815b0: 4661 6c73 6529 3a0d 0a20 2020 2022 2222  False):..    """
-000815c0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
-000815d0: 696f 6e20 6669 6e64 7320 616c 6c20 636f  ion finds all co
-000815e0: 6c75 6d6e 7320 696e 2061 2064 6174 6166  lumns in a dataf
-000815f0: 7261 6d65 2074 6861 7420 6861 7665 2069  rame that have i
-00081600: 6e69 6669 6e69 7465 2076 616c 7565 7320  nifinite values 
-00081610: 286e 702e 696e 6620 6f72 202d 6e70 2e69  (np.inf or -np.i
-00081620: 6e66 290d 0a20 2020 2049 7420 7265 7475  nf)..    It retu
-00081630: 726e 7320 6120 6c69 7374 206f 6620 636f  rns a list of co
-00081640: 6c75 6d6e 206e 616d 6573 2e20 4966 2074  lumn names. If t
-00081650: 6865 206c 6973 7420 6973 2065 6d70 7479  he list is empty
-00081660: 2c20 6974 206d 6561 6e73 206e 6f20 636f  , it means no co
-00081670: 6c75 6d6e 7320 7765 7265 2066 6f75 6e64  lumns were found
-00081680: 2e0d 0a20 2020 2049 6620 7265 6d6f 7665  ...    If remove
-00081690: 2066 6c61 6720 6973 2073 6574 2c20 7468   flag is set, th
-000816a0: 656e 2069 7420 7265 7475 726e 7320 6120  en it returns a 
-000816b0: 736d 616c 6c65 7220 6461 7461 6672 616d  smaller datafram
-000816c0: 6520 7769 7468 2069 6e66 2063 6f6c 756d  e with inf colum
-000816d0: 6e73 2072 656d 6f76 6564 2e0d 0a20 2020  ns removed...   
-000816e0: 2022 2222 0d0a 2020 2020 6e75 6d73 203d   """..    nums =
-000816f0: 2064 662e 7365 6c65 6374 5f64 7479 7065   df.select_dtype
-00081700: 7328 696e 636c 7564 653d 276e 756d 6265  s(include='numbe
-00081710: 7227 292e 636f 6c75 6d6e 732e 746f 6c69  r').columns.toli
-00081720: 7374 2829 0d0a 2020 2020 6466 7820 3d20  st()..    dfx = 
-00081730: 6466 5b6e 756d 735d 0d0a 2020 2020 7375  df[nums]..    su
-00081740: 6d5f 726f 7773 203d 206e 702e 6973 696e  m_rows = np.isin
-00081750: 6628 6466 7829 2e76 616c 7565 732e 7375  f(dfx).values.su
-00081760: 6d28 290d 0a20 2020 2061 6464 5f63 6f6c  m()..    add_col
-00081770: 7320 3d20 206c 6973 7428 6466 782e 636f  s =  list(dfx.co
-00081780: 6c75 6d6e 732e 746f 5f73 6572 6965 7328  lumns.to_series(
-00081790: 295b 6e70 2e69 7369 6e66 2864 6678 292e  )[np.isinf(dfx).
-000817a0: 616e 7928 295d 290d 0a20 2020 2069 6620  any()])..    if 
-000817b0: 7375 6d5f 726f 7773 203e 2030 3a0d 0a20  sum_rows > 0:.. 
-000817c0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-000817d0: 2020 7468 6572 6520 6172 6520 2564 2072    there are %d r
-000817e0: 6f77 7320 616e 6420 2564 2063 6f6c 756d  ows and %d colum
-000817f0: 6e73 2077 6974 6820 696e 6669 6e69 7479  ns with infinity
-00081800: 2069 6e20 7468 656d 2e2e 2e27 2025 2873   in them...' %(s
-00081810: 756d 5f72 6f77 732c 6c65 6e28 6164 645f  um_rows,len(add_
-00081820: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
-00081830: 2069 6620 7265 6d6f 7665 3a0d 0a20 2020   if remove:..   
-00081840: 2020 2020 2020 2020 2023 2323 2068 6572           ### her
-00081850: 6520 796f 7520 6e65 6564 2074 6f20 7573  e you need to us
-00081860: 6520 6466 2073 696e 6365 2074 6865 2077  e df since the w
-00081870: 686f 6c65 2064 6174 6173 6574 2069 7320  hole dataset is 
-00081880: 696e 766f 6c76 6564 2023 2323 0d0a 2020  involved ###..  
-00081890: 2020 2020 2020 2020 2020 6e6f 636f 6c73            nocols
-000818a0: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
-000818b0: 662e 636f 6c75 6d6e 7320 6966 2078 206e  f.columns if x n
-000818c0: 6f74 2069 6e20 6164 645f 636f 6c73 5d0d  ot in add_cols].
-000818d0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000818e0: 6e74 2822 2020 2020 5368 6170 6520 6f66  nt("    Shape of
-000818f0: 2064 6174 6173 6574 2062 6566 6f72 6520   dataset before 
-00081900: 2573 2061 6e64 2061 6674 6572 2025 7320  %s and after %s 
-00081910: 7265 6d6f 7669 6e67 2063 6f6c 756d 6e73  removing columns
-00081920: 2077 6974 6820 696e 6669 6e69 7479 2220   with infinity" 
-00081930: 2528 6466 2e73 6861 7065 2c28 6466 5b6e  %(df.shape,(df[n
-00081940: 6f63 6f6c 735d 2e73 6861 7065 2c29 2929  ocols].shape,)))
-00081950: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00081960: 7475 726e 2064 665b 6e6f 636f 6c73 5d0d  turn df[nocols].
-00081970: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00081980: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
-00081990: 6869 7320 7769 6c6c 2062 6520 6120 6c69  his will be a li
-000819a0: 7374 206f 6620 636f 6c75 6d6e 7320 7769  st of columns wi
-000819b0: 7468 2069 6e66 696e 6974 7920 2323 2323  th infinity ####
-000819c0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000819d0: 7475 726e 2061 6464 5f63 6f6c 730d 0a20  turn add_cols.. 
-000819e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000819f0: 2020 2323 2074 6869 7320 7769 6c6c 2062    ## this will b
-00081a00: 6520 616e 2065 6d70 7479 206c 6973 7420  e an empty list 
-00081a10: 6966 2074 6865 7265 2061 7265 206e 6f20  if there are no 
-00081a20: 636f 6c75 6d6e 7320 7769 7468 2069 6e66  columns with inf
-00081a30: 696e 6974 790d 0a20 2020 2020 2020 2072  inity..        r
-00081a40: 6574 7572 6e20 6164 645f 636f 6c73 0d0a  eturn add_cols..
-00081a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081aa0: 2323 2323 0d0a 6465 6620 636c 6173 7369  ####..def classi
-00081ab0: 6679 5f63 6f6c 756d 6e73 2864 665f 7072  fy_columns(df_pr
-00081ac0: 6564 732c 2076 6572 626f 7365 3d30 293a  eds, verbose=0):
-00081ad0: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
-00081ae0: 6869 7320 6163 7475 616c 6c79 2064 6f65  his actually doe
-00081af0: 7320 4578 706c 6f72 6174 6f72 7920 6461  s Exploratory da
-00081b00: 7461 2061 6e61 6c79 7369 7320 2d20 6974  ta analysis - it
-00081b10: 206d 6561 6e73 2074 6869 7320 6675 6e63   means this func
-00081b20: 7469 6f6e 2070 6572 666f 726d 7320 4544  tion performs ED
-00081b30: 410d 0a20 2020 2023 2323 2323 2323 2323  A..    #########
+00081200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00081210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00081270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00081280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00081290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000812a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000812b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000812c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000812d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000812e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000812f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00081310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00081350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00081360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000813f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081400: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00081410: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00081420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000814f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000815f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00081610: 2f61 7574 6f76 696d 6c2f 636c 6173 7369  /autoviml/classi
+00081620: 6679 5f6d 6574 686f 642e 7079 0000 0000  fy_method.py....
+00081630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00081670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00081680: 3030 3433 3630 3200 3030 3030 3030 3030  0043602.00000000
+00081690: 3030 3000 3032 3035 3132 0020 3000 0000  000.020512. 0...
+000816a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000816b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000816c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000816d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000816e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000816f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00081710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00081730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00081750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00081760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000817f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081800: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00081810: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+00081820: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
+00081830: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
+00081840: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
+00081850: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
+00081860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000818a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+000818b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
+000818c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
+000818d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
+000818e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
+000818f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
+00081900: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
+00081910: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
+00081920: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
+00081930: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
+00081940: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
+00081950: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
+00081960: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
+00081970: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+00081980: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
+00081990: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
+000819a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
+000819b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
+000819c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000819d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
+000819e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
+000819f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
+00081a00: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00081a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081a50: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
+00081a60: 6462 0d0a 6672 6f6d 2066 756e 6374 6f6f  db..from functoo
+00081a70: 6c73 2069 6d70 6f72 7420 7265 6475 6365  ls import reduce
+00081a80: 0d0a 696d 706f 7274 2063 6f70 790d 0a69  ..import copy..i
+00081a90: 6d70 6f72 7420 7469 6d65 0d0a 6465 6620  mport time..def 
+00081aa0: 6c65 6674 5f73 7562 7472 6163 7428 6c31  left_subtract(l1
+00081ab0: 2c6c 3229 3a0d 0a20 2020 206c 7374 203d  ,l2):..    lst =
+00081ac0: 205b 5d0d 0a20 2020 2066 6f72 2069 2069   []..    for i i
+00081ad0: 6e20 6c31 3a0d 0a20 2020 2020 2020 2069  n l1:..        i
+00081ae0: 6620 6920 6e6f 7420 696e 206c 323a 0d0a  f i not in l2:..
+00081af0: 2020 2020 2020 2020 2020 2020 6c73 742e              lst.
+00081b00: 6170 7065 6e64 2869 290d 0a20 2020 2072  append(i)..    r
+00081b10: 6574 7572 6e20 6c73 740d 0a23 2323 2323  eturn lst..#####
+00081b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00081b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00081b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00081b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081b80: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-00081b90: 2020 2054 616b 6573 2061 2064 6174 6166     Takes a dataf
-00081ba0: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
-00081bb0: 6f6e 6c79 2070 7265 6469 6374 6f72 7320  only predictors 
-00081bc0: 746f 2062 6520 636c 6173 7369 6669 6564  to be classified
-00081bd0: 2069 6e74 6f20 7661 7269 6f75 7320 7479   into various ty
-00081be0: 7065 732e 0d0a 2020 2020 444f 204e 4f54  pes...    DO NOT
-00081bf0: 2053 454e 4420 494e 2041 2054 4152 4745   SEND IN A TARGE
-00081c00: 5420 434f 4c55 4d4e 2073 696e 6365 2069  T COLUMN since i
-00081c10: 7420 7769 6c6c 2074 7279 2074 6f20 696e  t will try to in
-00081c20: 636c 7564 6520 7468 6174 2069 6e74 6f20  clude that into 
-00081c30: 7661 7269 6f75 7320 636f 6c75 6d6e 732e  various columns.
-00081c40: 0d0a 2020 2020 5265 7475 726e 7320 6120  ..    Returns a 
-00081c50: 6461 7461 2066 7261 6d65 2063 6f6e 7461  data frame conta
-00081c60: 696e 696e 6720 636f 6c75 6d6e 7320 616e  ining columns an
-00081c70: 6420 7468 6520 636c 6173 7320 6974 2062  d the class it b
-00081c80: 656c 6f6e 6773 2074 6f20 7375 6368 2061  elongs to such a
-00081c90: 7320 6e75 6d65 7269 632c 0d0a 2020 2020  s numeric,..    
-00081ca0: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
-00081cb0: 6520 6f72 2069 6420 636f 6c75 6d6e 2c20  e or id column, 
-00081cc0: 626f 6f6c 6561 6e2c 206e 6c70 2c20 6469  boolean, nlp, di
-00081cd0: 7363 7265 7465 5f73 7472 696e 6720 616e  screte_string an
-00081ce0: 6420 636f 6c73 2074 6f20 6465 6c65 7465  d cols to delete
-00081cf0: 2e2e 2e0d 0a20 2020 2023 2323 2323 2323  .....    #######
-00081d00: 2052 6574 7572 6e73 2061 2064 6963 7469   Returns a dicti
-00081d10: 6f6e 6172 7920 7769 7468 2031 3020 6b69  onary with 10 ki
-00081d20: 6e64 7320 6f66 2076 6172 7320 6c69 6b65  nds of vars like
-00081d30: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a20   the following: 
-00081d40: 2320 636f 6e74 696e 756f 7573 5f76 6172  # continuous_var
-00081d50: 732c 696e 745f 7661 7273 0d0a 2020 2020  s,int_vars..    
-00081d60: 2320 6361 745f 7661 7273 2c66 6163 746f  # cat_vars,facto
-00081d70: 725f 7661 7273 2c20 626f 6f6c 5f76 6172  r_vars, bool_var
-00081d80: 732c 6469 7363 7265 7465 5f73 7472 696e  s,discrete_strin
-00081d90: 675f 7661 7273 2c6e 6c70 5f76 6172 732c  g_vars,nlp_vars,
-00081da0: 6461 7465 5f76 6172 732c 6964 5f76 6172  date_vars,id_var
-00081db0: 732c 636f 6c73 5f64 656c 6574 650d 0a20  s,cols_delete.. 
-00081dc0: 2020 2022 2222 0d0a 2020 2020 7472 6169     """..    trai
-00081dd0: 6e20 3d20 636f 7079 2e64 6565 7063 6f70  n = copy.deepcop
-00081de0: 7928 6466 5f70 7265 6473 290d 0a20 2020  y(df_preds)..   
-00081df0: 2023 2323 2320 4966 2074 6865 7265 2061   #### If there a
-00081e00: 7265 2033 3020 6368 6172 7320 6172 6520  re 30 chars are 
-00081e10: 6d6f 7265 2069 6e20 6120 6469 7363 7265  more in a discre
-00081e20: 7465 5f73 7472 696e 675f 7661 722c 2069  te_string_var, i
-00081e30: 7420 6973 2074 6865 6e20 636f 6e73 6964  t is then consid
-00081e40: 6572 6564 2061 6e20 4e4c 5020 7661 7269  ered an NLP vari
-00081e50: 6162 6c65 0d0a 2020 2020 6d61 785f 6e6c  able..    max_nl
-00081e60: 705f 6368 6172 5f73 697a 6520 3d20 3330  p_char_size = 30
-00081e70: 0d0a 2020 2020 6d61 785f 636f 6c73 5f74  ..    max_cols_t
-00081e80: 6f5f 7072 696e 7420 3d20 3330 0d0a 2020  o_print = 30..  
-00081e90: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
-00081ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081ef0: 2729 0d0a 2020 2020 7072 696e 7428 2723  ')..    print('#
-00081f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081f10: 2323 2323 2323 2320 4320 4c20 4120 5320  ####### C L A S 
-00081f20: 5320 4920 4620 5920 4920 4e20 4720 2056  S I F Y I N G  V
-00081f30: 2041 2052 2049 2041 2042 204c 2045 2053   A R I A B L E S
-00081f40: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-00081f50: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
-00081f60: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-00081f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00081fb0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-00081fc0: 2020 2020 7072 696e 7428 2743 6c61 7373      print('Class
-00081fd0: 6966 7969 6e67 2076 6172 6961 626c 6573  ifying variables
-00081fe0: 2069 6e20 6461 7461 2073 6574 2e2e 2e27   in data set...'
-00081ff0: 290d 0a20 2020 2023 2323 2320 4361 745f  )..    #### Cat_
-00082000: 4c69 6d69 7420 6465 6669 6e65 7320 7468  Limit defines th
-00082010: 6520 6d61 7820 6e75 6d62 6572 206f 6620  e max number of 
-00082020: 6361 7465 676f 7269 6573 2061 2063 6f6c  categories a col
-00082030: 756d 6e20 6361 6e20 6861 7665 2074 6f20  umn can have to 
-00082040: 6265 2063 616c 6c65 6420 6120 6361 7465  be called a cate
-00082050: 676f 7269 6361 6c20 636f 6c75 6d0d 0a20  gorical colum.. 
-00082060: 2020 2063 6174 5f6c 696d 6974 203d 2033     cat_limit = 3
-00082070: 350d 0a20 2020 2066 6c6f 6174 5f6c 696d  5..    float_lim
-00082080: 6974 203d 2031 3520 2323 2323 204d 616b  it = 15 #### Mak
-00082090: 6520 7468 6973 206c 696d 6974 206c 6f77  e this limit low
-000820a0: 2073 6f20 7468 6174 2066 6c6f 6174 2076   so that float v
-000820b0: 6172 6961 626c 6573 2062 656c 6f77 2074  ariables below t
-000820c0: 6869 7320 6c69 6d69 7420 6265 636f 6d65  his limit become
-000820d0: 2063 6174 2076 6172 7320 2323 230d 0a20   cat vars ###.. 
-000820e0: 2020 2064 6566 2061 6464 2861 2c62 293a     def add(a,b):
-000820f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00082100: 2061 2b62 0d0a 2020 2020 7375 6d5f 616c   a+b..    sum_al
-00082110: 6c5f 636f 6c73 203d 2064 6963 7428 290d  l_cols = dict().
-00082120: 0a20 2020 206f 7269 675f 636f 6c73 5f74  .    orig_cols_t
-00082130: 6f74 616c 203d 2074 7261 696e 2e73 6861  otal = train.sha
-00082140: 7065 5b31 5d0d 0a20 2020 2023 5479 7065  pe[1]..    #Type
-00082150: 7320 6f66 2063 6f6c 756d 6e73 0d0a 2020  s of columns..  
-00082160: 2020 636f 6c73 5f64 656c 6574 6520 3d20    cols_delete = 
-00082170: 5b5d 0d0a 2020 2020 636f 6c73 5f64 656c  []..    cols_del
-00082180: 6574 6520 3d20 5b63 6f6c 2066 6f72 2063  ete = [col for c
-00082190: 6f6c 2069 6e20 6c69 7374 2874 7261 696e  ol in list(train
-000821a0: 2920 6966 2028 6c65 6e28 7472 6169 6e5b  ) if (len(train[
-000821b0: 636f 6c5d 2e76 616c 7565 5f63 6f75 6e74  col].value_count
-000821c0: 7328 2929 203d 3d20 310d 0a20 2020 2020  s()) == 1..     
-000821d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000821e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000821f0: 2020 2920 7c20 2874 7261 696e 5b63 6f6c    ) | (train[col
-00082200: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
-00082210: 2f6c 656e 2874 7261 696e 2920 3e3d 2030  /len(train) >= 0
-00082220: 2e39 3029 5d0d 0a20 2020 2069 6e66 5f63  .90)]..    inf_c
-00082230: 6f6c 7320 3d20 4544 415f 6669 6e64 5f72  ols = EDA_find_r
-00082240: 656d 6f76 655f 636f 6c75 6d6e 735f 7769  emove_columns_wi
-00082250: 7468 5f69 6e66 696e 6974 7928 7472 6169  th_infinity(trai
-00082260: 6e29 0d0a 2020 2020 6d69 7865 645f 636f  n)..    mixed_co
-00082270: 6c73 203d 205b 7820 666f 7220 7820 696e  ls = [x for x in
-00082280: 206c 6973 7428 7472 6169 6e29 2069 6620   list(train) if 
-00082290: 6c65 6e28 7472 6169 6e5b 785d 2e64 726f  len(train[x].dro
-000822a0: 706e 6128 292e 6170 706c 7928 7479 7065  pna().apply(type
-000822b0: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
-000822c0: 2920 3e20 315d 0d0a 2020 2020 6966 206c  ) > 1]..    if l
-000822d0: 656e 286d 6978 6564 5f63 6f6c 7329 203e  en(mixed_cols) >
-000822e0: 2030 3a0d 0a20 2020 2020 2020 2070 7269   0:..        pri
-000822f0: 6e74 2827 2020 2020 5265 6d6f 7669 6e67  nt('    Removing
-00082300: 2025 7320 636f 6c75 6d6e 2873 2920 6475   %s column(s) du
-00082310: 6520 746f 206d 6978 6564 2064 6174 6120  e to mixed data 
-00082320: 7479 7065 2064 6574 6563 7465 642e 2e2e  type detected...
-00082330: 2720 256d 6978 6564 5f63 6f6c 7329 0d0a  ' %mixed_cols)..
-00082340: 2020 2020 636f 6c73 5f64 656c 6574 6520      cols_delete 
-00082350: 2b3d 206d 6978 6564 5f63 6f6c 730d 0a20  += mixed_cols.. 
-00082360: 2020 2063 6f6c 735f 6465 6c65 7465 202b     cols_delete +
-00082370: 3d20 696e 665f 636f 6c73 0d0a 2020 2020  = inf_cols..    
-00082380: 7472 6169 6e20 3d20 7472 6169 6e5b 6c65  train = train[le
-00082390: 6674 5f73 7562 7472 6163 7428 6c69 7374  ft_subtract(list
-000823a0: 2874 7261 696e 292c 636f 6c73 5f64 656c  (train),cols_del
-000823b0: 6574 6529 5d0d 0a20 2020 2076 6172 5f64  ete)]..    var_d
-000823c0: 6620 3d20 7064 2e53 6572 6965 7328 6469  f = pd.Series(di
-000823d0: 6374 2874 7261 696e 2e64 7479 7065 7329  ct(train.dtypes)
-000823e0: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
-000823f0: 6f70 3d46 616c 7365 292e 7265 6e61 6d65  op=False).rename
-00082400: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00082410: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00082420: 6e73 3d7b 303a 2774 7970 655f 6f66 5f63  ns={0:'type_of_c
-00082430: 6f6c 756d 6e27 7d29 0d0a 2020 2020 7375  olumn'})..    su
-00082440: 6d5f 616c 6c5f 636f 6c73 5b27 636f 6c73  m_all_cols['cols
-00082450: 5f64 656c 6574 6527 5d20 3d20 636f 6c73  _delete'] = cols
-00082460: 5f64 656c 6574 650d 0a0d 0a20 2020 2076  _delete....    v
-00082470: 6172 5f64 665b 2762 6f6f 6c27 5d20 3d20  ar_df['bool'] = 
-00082480: 7661 725f 6466 2e61 7070 6c79 286c 616d  var_df.apply(lam
-00082490: 6264 6120 783a 2031 2069 6620 785b 2774  bda x: 1 if x['t
-000824a0: 7970 655f 6f66 5f63 6f6c 756d 6e27 5d20  ype_of_column'] 
-000824b0: 696e 205b 2762 6f6f 6c27 2c27 6f62 6a65  in ['bool','obje
-000824c0: 6374 275d 0d0a 2020 2020 2020 2020 2020  ct']..          
-000824d0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-000824e0: 6420 6c65 6e28 7472 6169 6e5b 785b 2769  d len(train[x['i
-000824f0: 6e64 6578 275d 5d2e 7661 6c75 655f 636f  ndex']].value_co
-00082500: 756e 7473 2829 2920 3d3d 2032 2065 6c73  unts()) == 2 els
-00082510: 6520 302c 2061 7869 733d 3129 0d0a 2020  e 0, axis=1)..  
-00082520: 2020 7374 7269 6e67 5f62 6f6f 6c5f 7661    string_bool_va
-00082530: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
-00082540: 5b28 7661 725f 6466 5b27 626f 6f6c 275d  [(var_df['bool']
-00082550: 203d 3d31 295d 5b27 696e 6465 7827 5d29   ==1)]['index'])
-00082560: 0d0a 2020 2020 7375 6d5f 616c 6c5f 636f  ..    sum_all_co
-00082570: 6c73 5b27 7374 7269 6e67 5f62 6f6f 6c5f  ls['string_bool_
-00082580: 7661 7273 275d 203d 2073 7472 696e 675f  vars'] = string_
-00082590: 626f 6f6c 5f76 6172 730d 0a20 2020 2076  bool_vars..    v
-000825a0: 6172 5f64 665b 276e 756d 5f62 6f6f 6c27  ar_df['num_bool'
-000825b0: 5d20 3d20 7661 725f 6466 2e61 7070 6c79  ] = var_df.apply
-000825c0: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
-000825d0: 785b 2774 7970 655f 6f66 5f63 6f6c 756d  x['type_of_colum
-000825e0: 6e27 5d20 696e 205b 6e70 2e75 696e 7438  n'] in [np.uint8
-000825f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00082600: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00082610: 702e 7569 6e74 3136 2c20 6e70 2e75 696e  p.uint16, np.uin
-00082620: 7433 322c 206e 702e 7569 6e74 3634 2c0d  t32, np.uint64,.
-00082630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082640: 2020 2020 2020 2020 2020 2020 2027 696e               'in
-00082650: 7438 272c 2769 6e74 3136 272c 2769 6e74  t8','int16','int
-00082660: 3332 272c 2769 6e74 3634 272c 0d0a 2020  32','int64',..  
-00082670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082680: 2020 2020 2020 2020 2020 2766 6c6f 6174            'float
-00082690: 3136 272c 2766 6c6f 6174 3332 272c 2766  16','float32','f
-000826a0: 6c6f 6174 3634 275d 2061 6e64 206c 656e  loat64'] and len
-000826b0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000826c0: 2020 2020 2020 2020 2020 2074 7261 696e             train
-000826d0: 5b78 5b27 696e 6465 7827 5d5d 2e76 616c  [x['index']].val
-000826e0: 7565 5f63 6f75 6e74 7328 2929 203d 3d20  ue_counts()) == 
-000826f0: 3220 656c 7365 2030 2c20 6178 6973 3d31  2 else 0, axis=1
-00082700: 290d 0a20 2020 206e 756d 5f62 6f6f 6c5f  )..    num_bool_
-00082710: 7661 7273 203d 206c 6973 7428 7661 725f  vars = list(var_
-00082720: 6466 5b28 7661 725f 6466 5b27 6e75 6d5f  df[(var_df['num_
-00082730: 626f 6f6c 275d 203d 3d31 295d 5b27 696e  bool'] ==1)]['in
-00082740: 6465 7827 5d29 0d0a 2020 2020 7375 6d5f  dex'])..    sum_
-00082750: 616c 6c5f 636f 6c73 5b27 6e75 6d5f 626f  all_cols['num_bo
-00082760: 6f6c 5f76 6172 7327 5d20 3d20 6e75 6d5f  ol_vars'] = num_
-00082770: 626f 6f6c 5f76 6172 730d 0a20 2020 2023  bool_vars..    #
-00082780: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
-00082790: 7768 6572 6520 7765 2074 616b 6520 616c  where we take al
-000827a0: 6c20 4f62 6a65 6374 2076 6172 7320 616e  l Object vars an
-000827b0: 6420 7370 6c69 7420 7468 656d 2069 6e74  d split them int
-000827c0: 6f20 6469 6666 206b 696e 6473 2023 2323  o diff kinds ###
-000827d0: 0d0a 2020 2020 6469 7363 7265 7465 5f6f  ..    discrete_o
-000827e0: 725f 6e6c 7020 3d20 7661 725f 6466 2e61  r_nlp = var_df.a
-000827f0: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
-00082800: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
-00082810: 6f6c 756d 6e27 5d20 696e 205b 276f 626a  olumn'] in ['obj
-00082820: 6563 7427 5d20 2061 6e64 2078 5b0d 0a20  ect']  and x[.. 
-00082830: 2020 2020 2020 2027 696e 6465 7827 5d20         'index'] 
-00082840: 6e6f 7420 696e 2073 7472 696e 675f 626f  not in string_bo
-00082850: 6f6c 5f76 6172 732b 636f 6c73 5f64 656c  ol_vars+cols_del
-00082860: 6574 6520 656c 7365 2030 2c61 7869 733d  ete else 0,axis=
-00082870: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
-00082880: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
-00082890: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
-000828a0: 6574 6865 7220 6120 7374 7269 6e67 2076  ether a string v
-000828b0: 6172 2069 7320 6e6c 7020 6f72 2064 6973  ar is nlp or dis
-000828c0: 6372 6574 655f 7374 7269 6e67 2076 6172  crete_string var
-000828d0: 2023 2323 0d0a 2020 2020 7661 725f 6466   ###..    var_df
-000828e0: 5b27 6e6c 705f 7374 7269 6e67 7327 5d20  ['nlp_strings'] 
-000828f0: 3d20 300d 0a20 2020 2076 6172 5f64 665b  = 0..    var_df[
-00082900: 2764 6973 6372 6574 655f 7374 7269 6e67  'discrete_string
-00082910: 7327 5d20 3d20 300d 0a20 2020 2076 6172  s'] = 0..    var
-00082920: 5f64 665b 2763 6174 275d 203d 2030 0d0a  _df['cat'] = 0..
-00082930: 2020 2020 7661 725f 6466 5b27 6964 5f63      var_df['id_c
-00082940: 6f6c 275d 203d 2030 0d0a 2020 2020 6469  ol'] = 0..    di
-00082950: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
-00082960: 7273 203d 2076 6172 5f64 662e 6c6f 635b  rs = var_df.loc[
-00082970: 6469 7363 7265 7465 5f6f 725f 6e6c 703d  discrete_or_nlp=
-00082980: 3d31 5d5b 2769 6e64 6578 275d 2e76 616c  =1]['index'].val
-00082990: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
-000829a0: 2020 636f 7079 5f64 6973 6372 6574 655f    copy_discrete_
-000829b0: 6f72 5f6e 6c70 5f76 6172 7320 3d20 636f  or_nlp_vars = co
-000829c0: 7079 2e64 6565 7063 6f70 7928 6469 7363  py.deepcopy(disc
-000829d0: 7265 7465 5f6f 725f 6e6c 705f 7661 7273  rete_or_nlp_vars
-000829e0: 290d 0a20 2020 2069 6620 6c65 6e28 6469  )..    if len(di
-000829f0: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
-00082a00: 7273 2920 3e20 303a 0d0a 2020 2020 2020  rs) > 0:..      
-00082a10: 2020 666f 7220 636f 6c20 696e 2063 6f70    for col in cop
-00082a20: 795f 6469 7363 7265 7465 5f6f 725f 6e6c  y_discrete_or_nl
-00082a30: 705f 7661 7273 3a0d 0a20 2020 2020 2020  p_vars:..       
-00082a40: 2020 2020 2023 2323 2320 6669 7273 7420       #### first 
-00082a50: 6669 6c6c 2065 6d70 7479 206f 7220 6d69  fill empty or mi
-00082a60: 7373 696e 6720 7661 6c73 2073 696e 6365  ssing vals since
-00082a70: 2069 7420 7769 6c6c 2062 6c6f 7775 7020   it will blowup 
-00082a80: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00082a90: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-00082aa0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
-00082ab0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
-00082ac0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
-00082ad0: 2020 2020 2020 2020 2020 7472 6169 6e5b            train[
-00082ae0: 5b63 6f6c 5d5d 203d 2074 7261 696e 5b5b  [col]] = train[[
-00082af0: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 2020  col]].fillna('  
-00082b00: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00082b10: 6966 2074 7261 696e 5b63 6f6c 5d2e 6d61  if train[col].ma
-00082b20: 7028 6c61 6d62 6461 2078 3a20 6c65 6e28  p(lambda x: len(
-00082b30: 7829 2069 6620 7479 7065 2878 293d 3d73  x) if type(x)==s
-00082b40: 7472 2065 6c73 6520 3029 2e6d 6178 280d  tr else 0).max(.
-00082b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082b60: 2029 203e 3d20 3530 2061 6e64 206c 656e   ) >= 50 and len
-00082b70: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
-00082b80: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
-00082b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082ba0: 2020 2020 2920 3e3d 2069 6e74 2830 2e39      ) >= int(0.9
-00082bb0: 2a6c 656e 2874 7261 696e 2929 2061 6e64  *len(train)) and
-00082bc0: 2063 6f6c 206e 6f74 2069 6e20 7374 7269   col not in stri
-00082bd0: 6e67 5f62 6f6f 6c5f 7661 7273 3a0d 0a20  ng_bool_vars:.. 
-00082be0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00082bf0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00082c00: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
-00082c10: 6e6c 705f 7374 7269 6e67 7327 5d20 3d20  nlp_strings'] = 
-00082c20: 310d 0a20 2020 2020 2020 2020 2020 2065  1..            e
-00082c30: 6c69 6620 7472 6169 6e5b 636f 6c5d 2e6d  lif train[col].m
-00082c40: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
-00082c50: 2878 2920 6966 2074 7970 6528 7829 3d3d  (x) if type(x)==
-00082c60: 7374 7220 656c 7365 2030 292e 6d65 616e  str else 0).mean
-00082c70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00082c80: 2020 2029 203e 3d20 6d61 785f 6e6c 705f     ) >= max_nlp_
-00082c90: 6368 6172 5f73 697a 6520 616e 6420 7472  char_size and tr
-00082ca0: 6169 6e5b 636f 6c5d 2e6d 6170 286c 616d  ain[col].map(lam
-00082cb0: 6264 6120 783a 206c 656e 2878 2920 6966  bda x: len(x) if
-00082cc0: 2074 7970 6528 7829 3d3d 7374 7220 656c   type(x)==str el
-00082cd0: 7365 2030 292e 6d61 7828 0d0a 2020 2020  se 0).max(..    
-00082ce0: 2020 2020 2020 2020 2020 2020 2920 3c20              ) < 
-00082cf0: 3530 2061 6e64 206c 656e 2874 7261 696e  50 and len(train
-00082d00: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
-00082d10: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
-00082d20: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
-00082d30: 3c3d 2069 6e74 2830 2e39 2a6c 656e 2874  <= int(0.9*len(t
-00082d40: 7261 696e 2929 2061 6e64 2063 6f6c 206e  rain)) and col n
-00082d50: 6f74 2069 6e20 7374 7269 6e67 5f62 6f6f  ot in string_boo
-00082d60: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
-00082d70: 2020 2020 2020 2020 2076 6172 5f64 662e           var_df.
-00082d80: 6c6f 635b 7661 725f 6466 5b27 696e 6465  loc[var_df['inde
-00082d90: 7827 5d3d 3d63 6f6c 2c27 6469 7363 7265  x']==col,'discre
-00082da0: 7465 5f73 7472 696e 6773 275d 203d 2031  te_strings'] = 1
-00082db0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00082dc0: 6966 206c 656e 2874 7261 696e 5b63 6f6c  if len(train[col
-00082dd0: 5d2e 7661 6c75 655f 636f 756e 7473 2829  ].value_counts()
-00082de0: 2920 3e20 6361 745f 6c69 6d69 7420 616e  ) > cat_limit an
-00082df0: 6420 6c65 6e28 7472 6169 6e5b 636f 6c5d  d len(train[col]
-00082e00: 2e76 616c 7565 5f63 6f75 6e74 7328 290d  .value_counts().
-00082e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082e20: 2020 2020 2020 2020 2029 203c 3d20 696e           ) <= in
-00082e30: 7428 302e 392a 6c65 6e28 7472 6169 6e29  t(0.9*len(train)
-00082e40: 2920 616e 6420 636f 6c20 6e6f 7420 696e  ) and col not in
-00082e50: 2073 7472 696e 675f 626f 6f6c 5f76 6172   string_bool_var
-00082e60: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00082e70: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-00082e80: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-00082e90: 636f 6c2c 2764 6973 6372 6574 655f 7374  col,'discrete_st
-00082ea0: 7269 6e67 7327 5d20 3d20 310d 0a20 2020  rings'] = 1..   
-00082eb0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-00082ec0: 6e28 7472 6169 6e5b 636f 6c5d 2e76 616c  n(train[col].val
-00082ed0: 7565 5f63 6f75 6e74 7328 2929 203e 2063  ue_counts()) > c
-00082ee0: 6174 5f6c 696d 6974 2061 6e64 206c 656e  at_limit and len
-00082ef0: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
-00082f00: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
-00082f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082f20: 2020 2020 2920 3d3d 206c 656e 2874 7261      ) == len(tra
-00082f30: 696e 2920 616e 6420 636f 6c20 6e6f 7420  in) and col not 
-00082f40: 696e 2073 7472 696e 675f 626f 6f6c 5f76  in string_bool_v
-00082f50: 6172 733a 0d0a 2020 2020 2020 2020 2020  ars:..          
-00082f60: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
-00082f70: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
-00082f80: 3d3d 636f 6c2c 2769 645f 636f 6c27 5d20  ==col,'id_col'] 
-00082f90: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-00082fa0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00082fb0: 2020 2020 2020 2020 7661 725f 6466 2e6c          var_df.l
-00082fc0: 6f63 5b76 6172 5f64 665b 2769 6e64 6578  oc[var_df['index
-00082fd0: 275d 3d3d 636f 6c2c 2763 6174 275d 203d  ']==col,'cat'] =
-00082fe0: 2031 0d0a 2020 2020 6e6c 705f 7661 7273   1..    nlp_vars
-00082ff0: 203d 206c 6973 7428 7661 725f 6466 5b28   = list(var_df[(
-00083000: 7661 725f 6466 5b27 6e6c 705f 7374 7269  var_df['nlp_stri
-00083010: 6e67 7327 5d20 3d3d 3129 5d5b 2769 6e64  ngs'] ==1)]['ind
-00083020: 6578 275d 290d 0a20 2020 2073 756d 5f61  ex'])..    sum_a
-00083030: 6c6c 5f63 6f6c 735b 276e 6c70 5f76 6172  ll_cols['nlp_var
-00083040: 7327 5d20 3d20 6e6c 705f 7661 7273 0d0a  s'] = nlp_vars..
-00083050: 2020 2020 6469 7363 7265 7465 5f73 7472      discrete_str
-00083060: 696e 675f 7661 7273 203d 206c 6973 7428  ing_vars = list(
-00083070: 7661 725f 6466 5b28 7661 725f 6466 5b27  var_df[(var_df['
-00083080: 6469 7363 7265 7465 5f73 7472 696e 6773  discrete_strings
-00083090: 275d 203d 3d31 2920 5d5b 2769 6e64 6578  '] ==1) ]['index
-000830a0: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
-000830b0: 5f63 6f6c 735b 2764 6973 6372 6574 655f  _cols['discrete_
-000830c0: 7374 7269 6e67 5f76 6172 7327 5d20 3d20  string_vars'] = 
-000830d0: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-000830e0: 7661 7273 0d0a 2020 2020 2323 2323 2323  vars..    ######
-000830f0: 2054 6869 7320 6861 7070 656e 7320 6f6e   This happens on
-00083100: 6c79 2069 6620 6120 7374 7269 6e67 2063  ly if a string c
-00083110: 6f6c 756d 6e20 6861 7070 656e 7320 746f  olumn happens to
-00083120: 2062 6520 616e 2049 4420 636f 6c75 6d6e   be an ID column
-00083130: 2023 2323 2323 2323 0d0a 2020 2020 2323   #######..    ##
-00083140: 2323 2044 4f20 4e4f 5420 4164 6420 7468  ## DO NOT Add th
-00083150: 6973 2074 6f20 4944 5f56 4152 5320 7965  is to ID_VARS ye
-00083160: 742e 2049 7420 7769 6c6c 2062 6520 646f  t. It will be do
-00083170: 6e65 206c 6174 6572 2e2e 2044 6f6e 7420  ne later.. Dont 
-00083180: 6368 616e 6765 2069 7420 6561 7369 6c79  change it easily
-00083190: 2e2e 2e0d 0a20 2020 2023 2323 2320 4361  .....    #### Ca
-000831a0: 7465 676f 7279 2044 5459 5045 2076 6172  tegory DTYPE var
-000831b0: 7320 6172 6520 7665 7279 2073 7065 6369  s are very speci
-000831c0: 616c 203d 2074 6865 7920 6361 6e20 6265  al = they can be
-000831d0: 206c 6566 7420 6173 2069 7320 616e 6420   left as is and 
-000831e0: 6e6f 7420 6469 7374 7572 6265 6420 696e  not disturbed in
-000831f0: 2050 7974 686f 6e2e 2023 2323 0d0a 2020   Python. ###..  
-00083200: 2020 7661 725f 6466 5b27 6463 6174 275d    var_df['dcat']
-00083210: 203d 2076 6172 5f64 662e 6170 706c 7928   = var_df.apply(
-00083220: 6c61 6d62 6461 2078 3a20 3120 6966 2073  lambda x: 1 if s
-00083230: 7472 2878 5b27 7479 7065 5f6f 665f 636f  tr(x['type_of_co
-00083240: 6c75 6d6e 275d 293d 3d27 6361 7465 676f  lumn'])=='catego
-00083250: 7279 2720 656c 7365 2030 2c0d 0a20 2020  ry' else 0,..   
-00083260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083270: 2020 2020 2020 2020 2061 7869 733d 3129           axis=1)
-00083280: 0d0a 2020 2020 6661 6374 6f72 5f76 6172  ..    factor_var
-00083290: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
-000832a0: 2876 6172 5f64 665b 2764 6361 7427 5d20  (var_df['dcat'] 
-000832b0: 3d3d 3129 5d5b 2769 6e64 6578 275d 290d  ==1)]['index']).
-000832c0: 0a20 2020 2073 756d 5f61 6c6c 5f63 6f6c  .    sum_all_col
-000832d0: 735b 2766 6163 746f 725f 7661 7273 275d  s['factor_vars']
-000832e0: 203d 2066 6163 746f 725f 7661 7273 0d0a   = factor_vars..
-000832f0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-00083300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00083330: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00083340: 2020 6461 7465 5f6f 725f 6964 203d 2076    date_or_id = v
-00083350: 6172 5f64 662e 6170 706c 7928 6c61 6d62  ar_df.apply(lamb
-00083360: 6461 2078 3a20 3120 6966 2078 5b27 7479  da x: 1 if x['ty
-00083370: 7065 5f6f 665f 636f 6c75 6d6e 275d 2069  pe_of_column'] i
-00083380: 6e20 5b6e 702e 7569 6e74 382c 0d0a 2020  n [np.uint8,..  
-00083390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000833a0: 2020 2020 2020 206e 702e 7569 6e74 3136         np.uint16
-000833b0: 2c20 6e70 2e75 696e 7433 322c 206e 702e  , np.uint32, np.
-000833c0: 7569 6e74 3634 2c0d 0a20 2020 2020 2020  uint64,..       
-000833d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000833e0: 2020 2769 6e74 3827 2c27 696e 7431 3627    'int8','int16'
-000833f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00083400: 2020 2020 2020 2020 2020 2027 696e 7433             'int3
-00083410: 3227 2c27 696e 7436 3427 5d20 2061 6e64  2','int64']  and
-00083420: 2078 5b0d 0a20 2020 2020 2020 2027 696e   x[..        'in
-00083430: 6465 7827 5d20 6e6f 7420 696e 2073 7472  dex'] not in str
-00083440: 696e 675f 626f 6f6c 5f76 6172 732b 6e75  ing_bool_vars+nu
-00083450: 6d5f 626f 6f6c 5f76 6172 732b 6469 7363  m_bool_vars+disc
-00083460: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
-00083470: 2b6e 6c70 5f76 6172 7320 656c 7365 2030  +nlp_vars else 0
-00083480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00083490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000834a0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000834b0: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
-000834c0: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
-000834d0: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
-000834e0: 6574 6865 7220 6120 6e75 6d65 7269 6320  ether a numeric 
-000834f0: 636f 6c20 6973 2064 6174 6520 6f72 2069  col is date or i
-00083500: 6420 7661 7269 6162 6c65 2023 2323 0d0a  d variable ###..
-00083510: 2020 2020 7661 725f 6466 5b27 696e 7427      var_df['int'
-00083520: 5d20 3d20 300d 0a20 2020 2076 6172 5f64  ] = 0..    var_d
-00083530: 665b 2764 6174 655f 7469 6d65 275d 203d  f['date_time'] =
-00083540: 2030 0d0a 2020 2020 2323 2320 6966 2061   0..    ### if a
-00083550: 2070 6172 7469 6375 6c61 7220 636f 6c75   particular colu
-00083560: 6d6e 2069 7320 6461 7465 2d74 696d 6520  mn is date-time 
-00083570: 7479 7065 2c20 6e6f 7720 7365 7420 6974  type, now set it
-00083580: 2061 7320 6120 6461 7465 2074 696d 6520   as a date time 
-00083590: 7661 7269 6162 6c65 2023 230d 0a20 2020  variable ##..   
-000835a0: 2076 6172 5f64 665b 2764 6174 655f 7469   var_df['date_ti
-000835b0: 6d65 275d 203d 2076 6172 5f64 662e 6170  me'] = var_df.ap
-000835c0: 706c 7928 6c61 6d62 6461 2078 3a20 3120  ply(lambda x: 1 
-000835d0: 6966 2078 5b27 7479 7065 5f6f 665f 636f  if x['type_of_co
-000835e0: 6c75 6d6e 275d 2069 6e20 5b27 3c4d 385b  lumn'] in ['<M8[
-000835f0: 6e73 5d27 2c27 6461 7465 7469 6d65 3634  ns]','datetime64
-00083600: 5b6e 735d 275d 2020 616e 6420 785b 0d0a  [ns]']  and x[..
-00083610: 2020 2020 2020 2020 2769 6e64 6578 275d          'index']
-00083620: 206e 6f74 2069 6e20 7374 7269 6e67 5f62   not in string_b
-00083630: 6f6f 6c5f 7661 7273 2b6e 756d 5f62 6f6f  ool_vars+num_boo
-00083640: 6c5f 7661 7273 2b64 6973 6372 6574 655f  l_vars+discrete_
-00083650: 7374 7269 6e67 5f76 6172 732b 6e6c 705f  string_vars+nlp_
-00083660: 7661 7273 2065 6c73 6520 302c 0d0a 2020  vars else 0,..  
-00083670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083690: 2020 2020 2020 6178 6973 3d31 290d 0a20        axis=1).. 
-000836a0: 2020 2023 2323 2074 6869 7320 6973 2077     ### this is w
-000836b0: 6865 7265 2077 6520 7361 7665 2074 6865  here we save the
-000836c0: 6d20 6173 2064 6174 6520 7469 6d65 2076  m as date time v
-000836d0: 6172 6961 626c 6573 2023 2323 0d0a 2020  ariables ###..  
-000836e0: 2020 6966 206c 656e 2876 6172 5f64 662e    if len(var_df.
-000836f0: 6c6f 635b 6461 7465 5f6f 725f 6964 3d3d  loc[date_or_id==
-00083700: 315d 2920 213d 2030 3a0d 0a20 2020 2020  1]) != 0:..     
-00083710: 2020 2066 6f72 2063 6f6c 2069 6e20 7661     for col in va
-00083720: 725f 6466 2e6c 6f63 5b64 6174 655f 6f72  r_df.loc[date_or
-00083730: 5f69 643d 3d31 5d5b 2769 6e64 6578 275d  _id==1]['index']
-00083740: 2e76 616c 7565 732e 746f 6c69 7374 2829  .values.tolist()
-00083750: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00083760: 6620 6c65 6e28 7472 6169 6e5b 636f 6c5d  f len(train[col]
-00083770: 2e76 616c 7565 5f63 6f75 6e74 7328 2929  .value_counts())
-00083780: 203d 3d20 6c65 6e28 7472 6169 6e29 3a0d   == len(train):.
-00083790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000837a0: 2069 6620 7472 6169 6e5b 636f 6c5d 2e6d   if train[col].m
-000837b0: 696e 2829 203c 2031 3930 3020 6f72 2074  in() < 1900 or t
-000837c0: 7261 696e 5b63 6f6c 5d2e 6d61 7828 2920  rain[col].max() 
-000837d0: 3e20 3230 3530 3a0d 0a20 2020 2020 2020  > 2050:..       
-000837e0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-000837f0: 5f64 662e 6c6f 635b 7661 725f 6466 5b27  _df.loc[var_df['
-00083800: 696e 6465 7827 5d3d 3d63 6f6c 2c27 6964  index']==col,'id
-00083810: 5f63 6f6c 275d 203d 2031 0d0a 2020 2020  _col'] = 1..    
-00083820: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00083830: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00083840: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00083850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083860: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
-00083870: 696d 6528 7472 6169 6e5b 636f 6c5d 2c69  ime(train[col],i
-00083880: 6e66 6572 5f64 6174 6574 696d 655f 666f  nfer_datetime_fo
-00083890: 726d 6174 3d54 7275 6529 0d0a 2020 2020  rmat=True)..    
-000838a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000838b0: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-000838c0: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-000838d0: 636f 6c2c 2764 6174 655f 7469 6d65 275d  col,'date_time']
-000838e0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-000838f0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00083900: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00083910: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
-00083920: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
-00083930: 6465 7827 5d3d 3d63 6f6c 2c27 6964 5f63  dex']==col,'id_c
-00083940: 6f6c 275d 203d 2031 0d0a 2020 2020 2020  ol'] = 1..      
-00083950: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00083960: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00083970: 7472 6169 6e5b 636f 6c5d 2e6d 696e 2829  train[col].min()
-00083980: 203c 2031 3930 3020 6f72 2074 7261 696e   < 1900 or train
-00083990: 5b63 6f6c 5d2e 6d61 7828 2920 3e20 3230  [col].max() > 20
-000839a0: 3530 3a0d 0a20 2020 2020 2020 2020 2020  50:..           
-000839b0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
-000839c0: 6e6f 7420 696e 206e 756d 5f62 6f6f 6c5f  not in num_bool_
-000839d0: 7661 7273 3a0d 0a20 2020 2020 2020 2020  vars:..         
-000839e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000839f0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00083a00: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
-00083a10: 696e 7427 5d20 3d20 310d 0a20 2020 2020  int'] = 1..     
-00083a20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00083a30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00083a40: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00083a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083a60: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
-00083a70: 6d65 2874 7261 696e 5b63 6f6c 5d2c 696e  me(train[col],in
-00083a80: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
-00083a90: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
-00083aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083ab0: 2020 2076 6172 5f64 662e 6c6f 635b 7661     var_df.loc[va
-00083ac0: 725f 6466 5b27 696e 6465 7827 5d3d 3d63  r_df['index']==c
-00083ad0: 6f6c 2c27 6461 7465 5f74 696d 6527 5d20  ol,'date_time'] 
-00083ae0: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-00083af0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00083b00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00083b10: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
-00083b20: 206e 6f74 2069 6e20 6e75 6d5f 626f 6f6c   not in num_bool
-00083b30: 5f76 6172 733a 0d0a 2020 2020 2020 2020  _vars:..        
-00083b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083b50: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
-00083b60: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
-00083b70: 636f 6c2c 2769 6e74 275d 203d 2031 0d0a  col,'int'] = 1..
-00083b80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00083b90: 2020 2070 6173 730d 0a20 2020 2069 6e74     pass..    int
-00083ba0: 5f76 6172 7320 3d20 6c69 7374 2876 6172  _vars = list(var
-00083bb0: 5f64 665b 2876 6172 5f64 665b 2769 6e74  _df[(var_df['int
-00083bc0: 275d 203d 3d31 295d 5b27 696e 6465 7827  '] ==1)]['index'
-00083bd0: 5d29 0d0a 2020 2020 6461 7465 5f76 6172  ])..    date_var
-00083be0: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
-00083bf0: 2876 6172 5f64 665b 2764 6174 655f 7469  (var_df['date_ti
-00083c00: 6d65 275d 203d 3d20 3129 5d5b 2769 6e64  me'] == 1)]['ind
-00083c10: 6578 275d 290d 0a20 2020 2069 645f 7661  ex'])..    id_va
-00083c20: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
-00083c30: 5b28 7661 725f 6466 5b27 6964 5f63 6f6c  [(var_df['id_col
-00083c40: 275d 203d 3d20 3129 5d5b 2769 6e64 6578  '] == 1)]['index
-00083c50: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
-00083c60: 5f63 6f6c 735b 2769 6e74 5f76 6172 7327  _cols['int_vars'
-00083c70: 5d20 3d20 696e 745f 7661 7273 0d0a 2020  ] = int_vars..  
-00083c80: 2020 636f 7079 5f64 6174 655f 7661 7273    copy_date_vars
-00083c90: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00083ca0: 2864 6174 655f 7661 7273 290d 0a20 2020  (date_vars)..   
-00083cb0: 2066 6f72 2064 6174 655f 7661 7220 696e   for date_var in
-00083cc0: 2063 6f70 795f 6461 7465 5f76 6172 733a   copy_date_vars:
-00083cd0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
-00083ce0: 6869 7320 7465 7374 2069 7320 746f 206d  his test is to m
-00083cf0: 616b 6520 7375 7265 2073 7572 6520 6461  ake sure sure da
-00083d00: 7465 2076 6172 7320 6172 6520 6163 7475  te vars are actu
-00083d10: 616c 6c79 2064 6174 6520 7661 7273 0d0a  ally date vars..
-00083d20: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00083d30: 2020 2020 2020 2020 2020 7064 2e74 6f5f            pd.to_
-00083d40: 6461 7465 7469 6d65 2874 7261 696e 5b64  datetime(train[d
-00083d50: 6174 655f 7661 725d 2c69 6e66 6572 5f64  ate_var],infer_d
-00083d60: 6174 6574 696d 655f 666f 726d 6174 3d54  atetime_format=T
-00083d70: 7275 6529 0d0a 2020 2020 2020 2020 6578  rue)..        ex
-00083d80: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00083d90: 2020 2023 2323 2323 2069 6620 6e6f 7420     ##### if not 
-00083da0: 6120 6461 7465 2076 6172 2c20 7468 656e  a date var, then
-00083db0: 206a 7573 7420 6164 6420 6974 2074 6f20   just add it to 
-00083dc0: 6465 6c65 7465 2069 7420 6672 6f6d 2070  delete it from p
-00083dd0: 726f 6365 7373 696e 670d 0a20 2020 2020  rocessing..     
-00083de0: 2020 2020 2020 2063 6f6c 735f 6465 6c65         cols_dele
-00083df0: 7465 2e61 7070 656e 6428 6461 7465 5f76  te.append(date_v
-00083e00: 6172 290d 0a20 2020 2020 2020 2020 2020  ar)..           
-00083e10: 2064 6174 655f 7661 7273 2e72 656d 6f76   date_vars.remov
-00083e20: 6528 6461 7465 5f76 6172 290d 0a20 2020  e(date_var)..   
-00083e30: 2073 756d 5f61 6c6c 5f63 6f6c 735b 2764   sum_all_cols['d
-00083e40: 6174 655f 7661 7273 275d 203d 2064 6174  ate_vars'] = dat
-00083e50: 655f 7661 7273 0d0a 2020 2020 7375 6d5f  e_vars..    sum_
-00083e60: 616c 6c5f 636f 6c73 5b27 6964 5f76 6172  all_cols['id_var
-00083e70: 7327 5d20 3d20 6964 5f76 6172 730d 0a20  s'] = id_vars.. 
-00083e80: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
-00083e90: 2763 6f6c 735f 6465 6c65 7465 275d 203d  'cols_delete'] =
-00083ea0: 2063 6f6c 735f 6465 6c65 7465 0d0a 2020   cols_delete..  
-00083eb0: 2020 2323 2054 6869 7320 6973 2061 6e20    ## This is an 
-00083ec0: 4558 5452 454d 454c 5920 636f 6d70 6c69  EXTREMELY compli
-00083ed0: 6361 7465 6420 6c6f 6769 6320 666f 7220  cated logic for 
-00083ee0: 6361 7420 7661 7273 2e20 446f 6e27 7420  cat vars. Don't 
-00083ef0: 6368 616e 6765 2069 7420 756e 6c65 7373  change it unless
-00083f00: 2079 6f75 2074 6573 7420 6974 206d 616e   you test it man
-00083f10: 7920 7469 6d65 7321 0d0a 2020 2020 7661  y times!..    va
-00083f20: 725f 6466 5b27 6e75 6d65 7269 6327 5d20  r_df['numeric'] 
-00083f30: 3d20 300d 0a20 2020 2066 6c6f 6174 5f6f  = 0..    float_o
-00083f40: 725f 6361 7420 3d20 7661 725f 6466 2e61  r_cat = var_df.a
-00083f50: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
-00083f60: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
-00083f70: 6f6c 756d 6e27 5d20 696e 205b 2766 6c6f  olumn'] in ['flo
-00083f80: 6174 3136 272c 0d0a 2020 2020 2020 2020  at16',..        
-00083f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083fa0: 2020 2020 2766 6c6f 6174 3332 272c 2766      'float32','f
-00083fb0: 6c6f 6174 3634 275d 2065 6c73 6520 302c  loat64'] else 0,
-00083fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00083fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083fe0: 2020 2020 2020 2020 2020 6178 6973 3d31            axis=1
-00083ff0: 290d 0a20 2020 2023 2323 2323 2323 2020  )..    #######  
-00084000: 5765 206e 6565 6420 746f 206d 616b 6520  We need to make 
-00084010: 7375 7265 2074 6865 7265 2061 7265 206e  sure there are n
-00084020: 6f20 6361 7465 676f 7269 6361 6c20 7661  o categorical va
-00084030: 7273 2069 6e20 666c 6f61 7420 2323 2323  rs in float ####
-00084040: 2323 230d 0a20 2020 2069 6620 6c65 6e28  ###..    if len(
-00084050: 7661 725f 6466 2e6c 6f63 5b66 6c6f 6174  var_df.loc[float
-00084060: 5f6f 725f 6361 7420 3d3d 2031 5d29 203e  _or_cat == 1]) >
-00084070: 2030 3a0d 0a20 2020 2020 2020 2066 6f72   0:..        for
-00084080: 2063 6f6c 2069 6e20 7661 725f 6466 2e6c   col in var_df.l
-00084090: 6f63 5b66 6c6f 6174 5f6f 725f 6361 7420  oc[float_or_cat 
-000840a0: 3d3d 2031 5d5b 2769 6e64 6578 275d 2e76  == 1]['index'].v
-000840b0: 616c 7565 732e 746f 6c69 7374 2829 3a0d  alues.tolist():.
-000840c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000840d0: 6c65 6e28 7472 6169 6e5b 636f 6c5d 2e76  len(train[col].v
-000840e0: 616c 7565 5f63 6f75 6e74 7328 2929 203e  alue_counts()) >
-000840f0: 2032 2061 6e64 206c 656e 2874 7261 696e   2 and len(train
-00084100: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
-00084110: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
-00084120: 2020 2020 2020 2920 3c3d 2066 6c6f 6174        ) <= float
-00084130: 5f6c 696d 6974 2061 6e64 206c 656e 2874  _limit and len(t
-00084140: 7261 696e 5b63 6f6c 5d2e 7661 6c75 655f  rain[col].value_
-00084150: 636f 756e 7473 2829 2920 3c3d 206c 656e  counts()) <= len
-00084160: 2874 7261 696e 293a 0d0a 2020 2020 2020  (train):..      
-00084170: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
-00084180: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
-00084190: 6578 275d 3d3d 636f 6c2c 2763 6174 275d  ex']==col,'cat']
-000841a0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-000841b0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000841c0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
-000841d0: 6e6f 7420 696e 2028 6e75 6d5f 626f 6f6c  not in (num_bool
-000841e0: 5f76 6172 7320 2b20 6661 6374 6f72 5f76  _vars + factor_v
-000841f0: 6172 7329 3a0d 0a20 2020 2020 2020 2020  ars):..         
-00084200: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
-00084210: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
-00084220: 6465 7827 5d3d 3d63 6f6c 2c27 6e75 6d65  dex']==col,'nume
-00084230: 7269 6327 5d20 3d20 310d 0a20 2020 2063  ric'] = 1..    c
-00084240: 6174 5f76 6172 7320 3d20 6c69 7374 2876  at_vars = list(v
-00084250: 6172 5f64 665b 2876 6172 5f64 665b 2763  ar_df[(var_df['c
-00084260: 6174 275d 203d 3d31 295d 5b27 696e 6465  at'] ==1)]['inde
-00084270: 7827 5d29 0d0a 2020 2020 636f 6e74 696e  x'])..    contin
-00084280: 756f 7573 5f76 6172 7320 3d20 6c69 7374  uous_vars = list
-00084290: 2876 6172 5f64 665b 2876 6172 5f64 665b  (var_df[(var_df[
-000842a0: 276e 756d 6572 6963 275d 203d 3d31 295d  'numeric'] ==1)]
-000842b0: 5b27 696e 6465 7827 5d29 0d0a 2020 2020  ['index'])..    
-000842c0: 0d0a 2020 2020 2323 2323 2323 2323 2020  ..    ########  
-000842d0: 5620 4520 5220 5920 2020 2049 204d 2050  V E R Y    I M P
-000842e0: 204f 2052 2054 2041 204e 2054 2020 2023   O R T A N T   #
-000842f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00084300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00084310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00084320: 2323 0d0a 2020 2020 6361 745f 7661 7273  ##..    cat_vars
-00084330: 5f63 6f70 7920 3d20 636f 7079 2e64 6565  _copy = copy.dee
-00084340: 7063 6f70 7928 6661 6374 6f72 5f76 6172  pcopy(factor_var
-00084350: 7329 200d 0a20 2020 2066 6f72 2063 6174  s) ..    for cat
-00084360: 2069 6e20 6361 745f 7661 7273 5f63 6f70   in cat_vars_cop
-00084370: 793a 0d0a 2020 2020 2020 2020 6966 2064  y:..        if d
-00084380: 665f 7072 6564 735b 6361 745d 2e64 7479  f_preds[cat].dty
-00084390: 7065 3d3d 666c 6f61 743a 0d0a 2020 2020  pe==float:..    
-000843a0: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
-000843b0: 7573 5f76 6172 732e 6170 7065 6e64 2863  us_vars.append(c
-000843c0: 6174 290d 0a20 2020 2020 2020 2020 2020  at)..           
-000843d0: 2066 6163 746f 725f 7661 7273 2e72 656d   factor_vars.rem
-000843e0: 6f76 6528 6361 7429 0d0a 2020 2020 2020  ove(cat)..      
-000843f0: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
-00084400: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
-00084410: 3d3d 6361 742c 2764 6361 7427 5d20 3d20  ==cat,'dcat'] = 
-00084420: 300d 0a20 2020 2020 2020 2020 2020 2076  0..            v
-00084430: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-00084440: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
-00084450: 6e75 6d65 7269 6327 5d20 3d20 310d 0a20  numeric'] = 1.. 
-00084460: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
-00084470: 6466 5f70 7265 6473 5b63 6174 5d2e 7661  df_preds[cat].va
-00084480: 6c75 655f 636f 756e 7473 2829 2920 3d3d  lue_counts()) ==
-00084490: 2064 665f 7072 6564 732e 7368 6170 655b   df_preds.shape[
-000844a0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
-000844b0: 2069 645f 7661 7273 2e61 7070 656e 6428   id_vars.append(
-000844c0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
-000844d0: 2020 6661 6374 6f72 5f76 6172 732e 7265    factor_vars.re
-000844e0: 6d6f 7665 2863 6174 290d 0a20 2020 2020  move(cat)..     
-000844f0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
-00084500: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
-00084510: 5d3d 3d63 6174 2c27 6463 6174 275d 203d  ]==cat,'dcat'] =
-00084520: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00084530: 7661 725f 6466 2e6c 6f63 5b76 6172 5f64  var_df.loc[var_d
-00084540: 665b 2769 6e64 6578 275d 3d3d 6361 742c  f['index']==cat,
-00084550: 2769 645f 636f 6c27 5d20 3d20 310d 0a20  'id_col'] = 1.. 
-00084560: 2020 200d 0a20 2020 2073 756d 5f61 6c6c     ..    sum_all
-00084570: 5f63 6f6c 735b 2766 6163 746f 725f 7661  _cols['factor_va
-00084580: 7273 275d 203d 2066 6163 746f 725f 7661  rs'] = factor_va
-00084590: 7273 0d0a 2020 2020 2323 2323 2320 5468  rs..    ##### Th
-000845a0: 6572 6520 6172 6520 6120 636f 7570 6c65  ere are a couple
-000845b0: 206f 6620 6578 7472 6120 7465 7374 7320   of extra tests 
-000845c0: 796f 7520 6e65 6564 2074 6f20 646f 2074  you need to do t
-000845d0: 6f20 7265 6d6f 7665 2061 6262 6572 6174  o remove abberat
-000845e0: 696f 6e73 2069 6e20 6361 745f 7661 7273  ions in cat_vars
-000845f0: 2023 2323 0d0a 2020 2020 6361 745f 7661   ###..    cat_va
-00084600: 7273 5f63 6f70 7920 3d20 636f 7079 2e64  rs_copy = copy.d
-00084610: 6565 7063 6f70 7928 6361 745f 7661 7273  eepcopy(cat_vars
-00084620: 2920 0d0a 2020 2020 666f 7220 6361 7420  ) ..    for cat 
-00084630: 696e 2063 6174 5f76 6172 735f 636f 7079  in cat_vars_copy
-00084640: 3a0d 0a20 2020 2020 2020 2069 6620 6466  :..        if df
-00084650: 5f70 7265 6473 5b63 6174 5d2e 6474 7970  _preds[cat].dtyp
-00084660: 653d 3d66 6c6f 6174 3a0d 0a20 2020 2020  e==float:..     
-00084670: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
-00084680: 735f 7661 7273 2e61 7070 656e 6428 6361  s_vars.append(ca
-00084690: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-000846a0: 6361 745f 7661 7273 2e72 656d 6f76 6528  cat_vars.remove(
-000846b0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
-000846c0: 2020 7661 725f 6466 2e6c 6f63 5b76 6172    var_df.loc[var
-000846d0: 5f64 665b 2769 6e64 6578 275d 3d3d 6361  _df['index']==ca
-000846e0: 742c 2763 6174 275d 203d 2030 0d0a 2020  t,'cat'] = 0..  
-000846f0: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
-00084700: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
-00084710: 6578 275d 3d3d 6361 742c 276e 756d 6572  ex']==cat,'numer
-00084720: 6963 275d 203d 2031 0d0a 2020 2020 2020  ic'] = 1..      
-00084730: 2020 656c 6966 206c 656e 2864 665f 7072    elif len(df_pr
-00084740: 6564 735b 6361 745d 2e76 616c 7565 5f63  eds[cat].value_c
-00084750: 6f75 6e74 7328 2929 203d 3d20 6466 5f70  ounts()) == df_p
-00084760: 7265 6473 2e73 6861 7065 5b30 5d3a 0d0a  reds.shape[0]:..
-00084770: 2020 2020 2020 2020 2020 2020 6964 5f76              id_v
-00084780: 6172 732e 6170 7065 6e64 2863 6174 290d  ars.append(cat).
-00084790: 0a20 2020 2020 2020 2020 2020 2063 6174  .            cat
-000847a0: 5f76 6172 732e 7265 6d6f 7665 2863 6174  _vars.remove(cat
-000847b0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
-000847c0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
-000847d0: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
-000847e0: 6361 7427 5d20 3d20 300d 0a20 2020 2020  cat'] = 0..     
-000847f0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
-00084800: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
-00084810: 5d3d 3d63 6174 2c27 6964 5f63 6f6c 275d  ]==cat,'id_col']
-00084820: 203d 2031 0d0a 2020 2020 7375 6d5f 616c   = 1..    sum_al
-00084830: 6c5f 636f 6c73 5b27 6361 745f 7661 7273  l_cols['cat_vars
-00084840: 275d 203d 2063 6174 5f76 6172 730d 0a20  '] = cat_vars.. 
-00084850: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
-00084860: 2763 6f6e 7469 6e75 6f75 735f 7661 7273  'continuous_vars
-00084870: 275d 203d 2063 6f6e 7469 6e75 6f75 735f  '] = continuous_
-00084880: 7661 7273 0d0a 2020 2020 7375 6d5f 616c  vars..    sum_al
-00084890: 6c5f 636f 6c73 5b27 6964 5f76 6172 7327  l_cols['id_vars'
-000848a0: 5d20 3d20 6964 5f76 6172 730d 0a20 2020  ] = id_vars..   
-000848b0: 2023 2323 2323 2320 5468 6973 2069 7320   ###### This is 
-000848c0: 7768 6572 6520 796f 7520 636f 6e73 6f6c  where you consol
-000848d0: 6461 7465 2074 6865 206e 756d 6265 7273  date the numbers
-000848e0: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
-000848f0: 2020 7661 725f 6469 6374 5f73 756d 203d    var_dict_sum =
-00084900: 2064 6963 7428 7a69 7028 7661 725f 6466   dict(zip(var_df
-00084910: 2e76 616c 7565 735b 3a2c 305d 2c20 7661  .values[:,0], va
-00084920: 725f 6466 2e76 616c 7565 735b 3a2c 323a  r_df.values[:,2:
-00084930: 5d2e 7375 6d28 3129 2929 0d0a 2020 2020  ].sum(1)))..    
-00084940: 666f 7220 636f 6c2c 2073 756d 7661 6c20  for col, sumval 
-00084950: 696e 2076 6172 5f64 6963 745f 7375 6d2e  in var_dict_sum.
-00084960: 6974 656d 7328 293a 0d0a 2020 2020 2020  items():..      
-00084970: 2020 6966 2073 756d 7661 6c20 3d3d 2030    if sumval == 0
-00084980: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00084990: 7269 6e74 2827 2573 206f 6620 7479 7065  rint('%s of type
-000849a0: 3d25 7320 6973 206e 6f74 2063 6c61 7373  =%s is not class
-000849b0: 6966 6965 6427 2025 2863 6f6c 2c74 7261  ified' %(col,tra
-000849c0: 696e 5b63 6f6c 5d2e 6474 7970 6529 290d  in[col].dtype)).
-000849d0: 0a20 2020 2020 2020 2065 6c69 6620 7375  .        elif su
-000849e0: 6d76 616c 203e 2031 3a0d 0a20 2020 2020  mval > 1:..     
-000849f0: 2020 2020 2020 2070 7269 6e74 2827 2573         print('%s
-00084a00: 206f 6620 7479 7065 3d25 7320 6973 2063   of type=%s is c
-00084a10: 6c61 7373 6966 6965 6420 696e 746f 206d  lassified into m
-00084a20: 6f72 6520 7468 656e 206f 6e65 2074 7970  ore then one typ
-00084a30: 6527 2025 2863 6f6c 2c74 7261 696e 5b63  e' %(col,train[c
-00084a40: 6f6c 5d2e 6474 7970 6529 290d 0a20 2020  ol].dtype))..   
-00084a50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00084a60: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
-00084a70: 2020 2323 2323 2320 4966 2074 6865 7265    ##### If there
-00084a80: 2061 7265 206d 6f72 6520 7468 616e 2031   are more than 1
-00084a90: 3030 3020 756e 6971 7565 2076 616c 7565  000 unique value
-00084aa0: 732c 2074 6865 6e20 6164 6420 6974 2074  s, then add it t
-00084ab0: 6f20 4e4c 5020 7661 7273 2023 2323 0d0a  o NLP vars ###..
-00084ac0: 2020 2020 636f 7079 5f64 6973 6372 6574      copy_discret
-00084ad0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
-00084ae0: 7079 2864 6973 6372 6574 655f 7374 7269  py(discrete_stri
-00084af0: 6e67 5f76 6172 7329 0d0a 2020 2020 666f  ng_vars)..    fo
-00084b00: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
-00084b10: 696e 2063 6f70 795f 6469 7363 7265 7465  in copy_discrete
-00084b20: 733a 0d0a 2020 2020 2020 2020 6966 2074  s:..        if t
-00084b30: 7261 696e 5b65 6163 685f 6469 7363 7265  rain[each_discre
-00084b40: 7465 5d2e 6e75 6e69 7175 6528 2920 3e3d  te].nunique() >=
-00084b50: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
-00084b60: 2020 2020 6e6c 705f 7661 7273 2e61 7070      nlp_vars.app
-00084b70: 656e 6428 6561 6368 5f64 6973 6372 6574  end(each_discret
-00084b80: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00084b90: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-00084ba0: 7661 7273 2e72 656d 6f76 6528 6561 6368  vars.remove(each
-00084bb0: 5f64 6973 6372 6574 6529 0d0a 2020 2020  _discrete)..    
-00084bc0: 2020 2020 656c 6966 2074 7261 696e 5b65      elif train[e
-00084bd0: 6163 685f 6469 7363 7265 7465 5d2e 6e75  ach_discrete].nu
-00084be0: 6e69 7175 6528 2920 3e20 3130 3020 616e  nique() > 100 an
-00084bf0: 6420 7472 6169 6e5b 6561 6368 5f64 6973  d train[each_dis
-00084c00: 6372 6574 655d 2e6e 756e 6971 7565 2829  crete].nunique()
-00084c10: 203c 2031 3030 303a 0d0a 2020 2020 2020   < 1000:..      
-00084c20: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
-00084c30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00084c40: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
-00084c50: 2069 7320 6c65 7373 2074 6861 6e20 3130   is less than 10
-00084c60: 3020 756e 6971 7565 2076 616c 7565 732c  0 unique values,
-00084c70: 2074 6865 6e20 6d61 6b65 2069 7420 6361   then make it ca
-00084c80: 7465 676f 7269 6361 6c20 7661 720d 0a20  tegorical var.. 
-00084c90: 2020 2020 2020 2020 2020 2063 6174 5f76             cat_v
-00084ca0: 6172 732e 6170 7065 6e64 2865 6163 685f  ars.append(each_
-00084cb0: 6469 7363 7265 7465 290d 0a20 2020 2020  discrete)..     
-00084cc0: 2020 2020 2020 2064 6973 6372 6574 655f         discrete_
-00084cd0: 7374 7269 6e67 5f76 6172 732e 7265 6d6f  string_vars.remo
-00084ce0: 7665 2865 6163 685f 6469 7363 7265 7465  ve(each_discrete
-00084cf0: 290d 0a20 2020 2073 756d 5f61 6c6c 5f63  )..    sum_all_c
-00084d00: 6f6c 735b 2764 6973 6372 6574 655f 7374  ols['discrete_st
-00084d10: 7269 6e67 5f76 6172 7327 5d20 3d20 2064  ring_vars'] =  d
-00084d20: 6973 6372 6574 655f 7374 7269 6e67 5f76  iscrete_string_v
-00084d30: 6172 730d 0a20 2020 2073 756d 5f61 6c6c  ars..    sum_all
-00084d40: 5f63 6f6c 735b 2763 6174 5f76 6172 7327  _cols['cat_vars'
-00084d50: 5d20 3d20 6361 745f 7661 7273 0d0a 2020  ] = cat_vars..  
-00084d60: 2020 7375 6d5f 616c 6c5f 636f 6c73 5b27    sum_all_cols['
-00084d70: 6e6c 705f 7661 7273 275d 203d 206e 6c70  nlp_vars'] = nlp
-00084d80: 5f76 6172 730d 0a20 2020 2023 2323 2323  _vars..    #####
-00084d90: 2323 2323 2323 2323 2323 2020 5468 6973  ##########  This
-00084da0: 2069 7320 7768 6572 6520 796f 7520 7072   is where you pr
-00084db0: 696e 7420 616c 6c20 7468 6520 7479 7065  int all the type
-00084dc0: 7320 6f66 2076 6172 6961 626c 6573 2023  s of variables #
-00084dd0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-00084de0: 2020 2023 2323 2323 2323 2052 6574 7572     ####### Retur
-00084df0: 6e73 2038 2076 6172 7320 696e 2074 6865  ns 8 vars in the
-00084e00: 2066 6f6c 6c6f 7769 6e67 206f 7264 6572   following order
-00084e10: 3a20 636f 6e74 696e 756f 7573 5f76 6172  : continuous_var
-00084e20: 732c 696e 745f 7661 7273 2c63 6174 5f76  s,int_vars,cat_v
-00084e30: 6172 732c 0d0a 2020 2020 2323 2320 2073  ars,..    ###  s
-00084e40: 7472 696e 675f 626f 6f6c 5f76 6172 732c  tring_bool_vars,
-00084e50: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
-00084e60: 7661 7273 2c6e 6c70 5f76 6172 732c 6461  vars,nlp_vars,da
-00084e70: 7465 5f6f 725f 6964 5f76 6172 732c 636f  te_or_id_vars,co
-00084e80: 6c73 5f64 656c 6574 650d 0a20 2020 2069  ls_delete..    i
-00084e90: 6620 7665 7262 6f73 6520 3d3d 2031 3a0d  f verbose == 1:.
-00084ea0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00084eb0: 2020 2020 4e75 6d62 6572 206f 6620 4e75      Number of Nu
-00084ec0: 6d65 7269 6320 436f 6c75 6d6e 7320 3d20  meric Columns = 
-00084ed0: 222c 206c 656e 2863 6f6e 7469 6e75 6f75  ", len(continuou
-00084ee0: 735f 7661 7273 2929 0d0a 2020 2020 2020  s_vars))..      
-00084ef0: 2020 7072 696e 7428 2220 2020 204e 756d    print("    Num
-00084f00: 6265 7220 6f66 2049 6e74 6567 6572 2d43  ber of Integer-C
-00084f10: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
-00084f20: 6e73 203d 2022 2c20 6c65 6e28 696e 745f  ns = ", len(int_
-00084f30: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
-00084f40: 7072 696e 7428 2220 2020 204e 756d 6265  print("    Numbe
-00084f50: 7220 6f66 2053 7472 696e 672d 4361 7465  r of String-Cate
-00084f60: 676f 7269 6361 6c20 436f 6c75 6d6e 7320  gorical Columns 
-00084f70: 3d20 222c 206c 656e 2863 6174 5f76 6172  = ", len(cat_var
-00084f80: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00084f90: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00084fa0: 6620 4661 6374 6f72 2d43 6174 6567 6f72  f Factor-Categor
-00084fb0: 6963 616c 2043 6f6c 756d 6e73 203d 2022  ical Columns = "
-00084fc0: 2c20 6c65 6e28 6661 6374 6f72 5f76 6172  , len(factor_var
-00084fd0: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00084fe0: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00084ff0: 6620 5374 7269 6e67 2d42 6f6f 6c65 616e  f String-Boolean
-00085000: 2043 6f6c 756d 6e73 203d 2022 2c20 6c65   Columns = ", le
-00085010: 6e28 7374 7269 6e67 5f62 6f6f 6c5f 7661  n(string_bool_va
-00085020: 7273 2929 0d0a 2020 2020 2020 2020 7072  rs))..        pr
-00085030: 696e 7428 2220 2020 204e 756d 6265 7220  int("    Number 
-00085040: 6f66 204e 756d 6572 6963 2d42 6f6f 6c65  of Numeric-Boole
-00085050: 616e 2043 6f6c 756d 6e73 203d 2022 2c20  an Columns = ", 
-00085060: 6c65 6e28 6e75 6d5f 626f 6f6c 5f76 6172  len(num_bool_var
-00085070: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00085080: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00085090: 6620 4469 7363 7265 7465 2053 7472 696e  f Discrete Strin
-000850a0: 6720 436f 6c75 6d6e 7320 3d20 222c 206c  g Columns = ", l
-000850b0: 656e 2864 6973 6372 6574 655f 7374 7269  en(discrete_stri
-000850c0: 6e67 5f76 6172 7329 290d 0a20 2020 2020  ng_vars))..     
-000850d0: 2020 2070 7269 6e74 2822 2020 2020 4e75     print("    Nu
-000850e0: 6d62 6572 206f 6620 4e4c 5020 5374 7269  mber of NLP Stri
-000850f0: 6e67 2043 6f6c 756d 6e73 203d 2022 2c20  ng Columns = ", 
-00085100: 6c65 6e28 6e6c 705f 7661 7273 2929 0d0a  len(nlp_vars))..
-00085110: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-00085120: 2020 204e 756d 6265 7220 6f66 2044 6174     Number of Dat
-00085130: 6520 5469 6d65 2043 6f6c 756d 6e73 203d  e Time Columns =
-00085140: 2022 2c20 6c65 6e28 6461 7465 5f76 6172   ", len(date_var
-00085150: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
-00085160: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
-00085170: 6620 4944 2043 6f6c 756d 6e73 203d 2022  f ID Columns = "
-00085180: 2c20 6c65 6e28 6964 5f76 6172 7329 290d  , len(id_vars)).
-00085190: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-000851a0: 2020 2020 4e75 6d62 6572 206f 6620 436f      Number of Co
-000851b0: 6c75 6d6e 7320 746f 2044 656c 6574 6520  lumns to Delete 
-000851c0: 3d20 222c 206c 656e 2863 6f6c 735f 6465  = ", len(cols_de
-000851d0: 6c65 7465 2929 0d0a 2020 2020 6966 2076  lete))..    if v
-000851e0: 6572 626f 7365 203d 3d20 323a 0d0a 2020  erbose == 2:..  
-000851f0: 2020 2020 2020 7072 696e 7428 2720 2050        print('  P
-00085200: 7269 6e74 696e 6720 7570 746f 2025 6420  rinting upto %d 
-00085210: 636f 6c75 6d6e 7320 6d61 7820 696e 2065  columns max in e
-00085220: 6163 6820 6361 7465 676f 7279 3a27 2025  ach category:' %
-00085230: 6d61 785f 636f 6c73 5f74 6f5f 7072 696e  max_cols_to_prin
-00085240: 7429 0d0a 2020 2020 2020 2020 7072 696e  t)..        prin
-00085250: 7428 2220 2020 204e 756d 6572 6963 2043  t("    Numeric C
-00085260: 6f6c 756d 6e73 203a 2025 7322 2025 636f  olumns : %s" %co
-00085270: 6e74 696e 756f 7573 5f76 6172 735b 3a6d  ntinuous_vars[:m
-00085280: 6178 5f63 6f6c 735f 746f 5f70 7269 6e74  ax_cols_to_print
-00085290: 5d29 0d0a 2020 2020 2020 2020 7072 696e  ])..        prin
-000852a0: 7428 2220 2020 2049 6e74 6567 6572 2d43  t("    Integer-C
-000852b0: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
-000852c0: 6e73 3a20 2573 2220 2569 6e74 5f76 6172  ns: %s" %int_var
-000852d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
-000852e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
-000852f0: 7072 696e 7428 2220 2020 2053 7472 696e  print("    Strin
-00085300: 672d 4361 7465 676f 7269 6361 6c20 436f  g-Categorical Co
-00085310: 6c75 6d6e 733a 2025 7322 2025 6361 745f  lumns: %s" %cat_
-00085320: 7661 7273 5b3a 6d61 785f 636f 6c73 5f74  vars[:max_cols_t
-00085330: 6f5f 7072 696e 745d 290d 0a20 2020 2020  o_print])..     
-00085340: 2020 2070 7269 6e74 2822 2020 2020 4661     print("    Fa
-00085350: 6374 6f72 2d43 6174 6567 6f72 6963 616c  ctor-Categorical
-00085360: 2043 6f6c 756d 6e73 3a20 2573 2220 2566   Columns: %s" %f
-00085370: 6163 746f 725f 7661 7273 5b3a 6d61 785f  actor_vars[:max_
-00085380: 636f 6c73 5f74 6f5f 7072 696e 745d 290d  cols_to_print]).
-00085390: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-000853a0: 2020 2020 5374 7269 6e67 2d42 6f6f 6c65      String-Boole
-000853b0: 616e 2043 6f6c 756d 6e73 3a20 2573 2220  an Columns: %s" 
-000853c0: 2573 7472 696e 675f 626f 6f6c 5f76 6172  %string_bool_var
-000853d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
-000853e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
-000853f0: 7072 696e 7428 2220 2020 204e 756d 6572  print("    Numer
-00085400: 6963 2d42 6f6f 6c65 616e 2043 6f6c 756d  ic-Boolean Colum
-00085410: 6e73 3a20 2573 2220 256e 756d 5f62 6f6f  ns: %s" %num_boo
-00085420: 6c5f 7661 7273 5b3a 6d61 785f 636f 6c73  l_vars[:max_cols
-00085430: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
-00085440: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-00085450: 4469 7363 7265 7465 2053 7472 696e 6720  Discrete String 
-00085460: 436f 6c75 6d6e 733a 2025 7322 2025 6469  Columns: %s" %di
-00085470: 7363 7265 7465 5f73 7472 696e 675f 7661  screte_string_va
-00085480: 7273 5b3a 6d61 785f 636f 6c73 5f74 6f5f  rs[:max_cols_to_
-00085490: 7072 696e 745d 290d 0a20 2020 2020 2020  print])..       
-000854a0: 2070 7269 6e74 2822 2020 2020 4e4c 5020   print("    NLP 
-000854b0: 7465 7874 2043 6f6c 756d 6e73 3a20 2573  text Columns: %s
-000854c0: 2220 256e 6c70 5f76 6172 735b 3a6d 6178  " %nlp_vars[:max
-000854d0: 5f63 6f6c 735f 746f 5f70 7269 6e74 5d29  _cols_to_print])
-000854e0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000854f0: 2220 2020 2044 6174 6520 5469 6d65 2043  "    Date Time C
-00085500: 6f6c 756d 6e73 3a20 2573 2220 2564 6174  olumns: %s" %dat
-00085510: 655f 7661 7273 5b3a 6d61 785f 636f 6c73  e_vars[:max_cols
-00085520: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
-00085530: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-00085540: 4944 2043 6f6c 756d 6e73 3a20 2573 2220  ID Columns: %s" 
-00085550: 2569 645f 7661 7273 5b3a 6d61 785f 636f  %id_vars[:max_co
-00085560: 6c73 5f74 6f5f 7072 696e 745d 290d 0a20  ls_to_print]).. 
-00085570: 2020 2020 2020 2070 7269 6e74 2822 2020         print("  
-00085580: 2020 436f 6c75 6d6e 7320 7468 6174 2077    Columns that w
-00085590: 696c 6c20 6e6f 7420 6265 2063 6f6e 7369  ill not be consi
-000855a0: 6465 7265 6420 696e 206d 6f64 656c 696e  dered in modelin
-000855b0: 673a 2025 7322 2025 636f 6c73 5f64 656c  g: %s" %cols_del
-000855c0: 6574 655b 3a6d 6178 5f63 6f6c 735f 746f  ete[:max_cols_to
-000855d0: 5f70 7269 6e74 5d29 0d0a 2020 2020 2323  _print])..    ##
-000855e0: 2323 2320 6e6f 7720 636f 6c6c 6563 7420  ### now collect 
-000855f0: 616c 6c20 7468 6520 636f 6c75 6d6e 2074  all the column t
-00085600: 7970 6573 2061 6e64 2063 6f6c 756d 6e20  ypes and column 
-00085610: 6e61 6d65 7320 696e 746f 2061 2073 696e  names into a sin
-00085620: 676c 6520 6469 6374 696f 6e61 7279 2074  gle dictionary t
-00085630: 6f20 7265 7475 726e 210d 0a20 2020 200d  o return!..    .
-00085640: 0a20 2020 206c 656e 5f73 756d 5f61 6c6c  .    len_sum_all
-00085650: 5f63 6f6c 7320 3d20 7265 6475 6365 2861  _cols = reduce(a
-00085660: 6464 2c5b 6c65 6e28 7629 2066 6f72 2076  dd,[len(v) for v
-00085670: 2069 6e20 7375 6d5f 616c 6c5f 636f 6c73   in sum_all_cols
-00085680: 2e76 616c 7565 7328 295d 290d 0a20 2020  .values()])..   
-00085690: 2069 6620 6c65 6e5f 7375 6d5f 616c 6c5f   if len_sum_all_
-000856a0: 636f 6c73 203d 3d20 6f72 6967 5f63 6f6c  cols == orig_col
-000856b0: 735f 746f 7461 6c3a 0d0a 2020 2020 2020  s_total:..      
-000856c0: 2020 7072 696e 7428 2720 2020 2025 6420    print('    %d 
-000856d0: 5072 6564 6963 746f 7273 2063 6c61 7373  Predictors class
-000856e0: 6966 6965 642e 2e2e 2720 256f 7269 675f  ified...' %orig_
-000856f0: 636f 6c73 5f74 6f74 616c 290d 0a20 2020  cols_total)..   
-00085700: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
-00085710: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
-00085720: 6f74 2069 6e63 6c75 6465 2074 6865 2054  ot include the T
-00085730: 6172 6765 7420 636f 6c75 6d6e 2873 2927  arget column(s)'
-00085740: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00085750: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
-00085760: 6f66 2063 6f6c 756d 6e73 2063 6c61 7373  of columns class
-00085770: 6966 6965 6420 2564 2064 6f65 7320 6e6f  ified %d does no
-00085780: 7420 6d61 7463 6820 2564 2074 6f74 616c  t match %d total
-00085790: 2063 6f6c 732e 2043 6f6e 7469 6e75 696e   cols. Continuin
-000857a0: 672e 2e2e 2720 2528 0d0a 2020 2020 2020  g...' %(..      
-000857b0: 2020 2020 2020 2020 2020 2020 206c 656e               len
-000857c0: 5f73 756d 5f61 6c6c 5f63 6f6c 732c 206f  _sum_all_cols, o
-000857d0: 7269 675f 636f 6c73 5f74 6f74 616c 2929  rig_cols_total))
-000857e0: 0d0a 2020 2020 2020 2020 6c73 203d 2073  ..        ls = s
-000857f0: 756d 5f61 6c6c 5f63 6f6c 732e 7661 6c75  um_all_cols.valu
-00085800: 6573 2829 0d0a 2020 2020 2020 2020 666c  es()..        fl
-00085810: 6174 5f6c 6973 7420 3d20 5b69 7465 6d20  at_list = [item 
-00085820: 666f 7220 7375 626c 6973 7420 696e 206c  for sublist in l
-00085830: 7320 666f 7220 6974 656d 2069 6e20 7375  s for item in su
-00085840: 626c 6973 745d 0d0a 2020 2020 2020 2020  blist]..        
-00085850: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
-00085860: 7261 6374 286c 6973 7428 7472 6169 6e29  ract(list(train)
-00085870: 2c66 6c61 745f 6c69 7374 2929 203d 3d20  ,flat_list)) == 
-00085880: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00085890: 7072 696e 7428 2720 4d69 7373 696e 6720  print(' Missing 
-000858a0: 636f 6c75 6d6e 7320 3d20 4e6f 6e65 2729  columns = None')
-000858b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000858c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-000858d0: 6e74 2827 204d 6973 7369 6e67 2063 6f6c  nt(' Missing col
-000858e0: 756d 6e73 203d 2025 7327 2025 6c65 6674  umns = %s' %left
-000858f0: 5f73 7562 7472 6163 7428 6c69 7374 2874  _subtract(list(t
-00085900: 7261 696e 292c 666c 6174 5f6c 6973 7429  rain),flat_list)
-00085910: 290d 0a20 2020 2072 6574 7572 6e20 7375  )..    return su
-00085920: 6d5f 616c 6c5f 636f 6c73 0d0a 2323 2323  m_all_cols..####
-00085930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00085980: 0d0a 0000 0000 0000 0000 0000 0000 0000  ................
-00085990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000859f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00085a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00085a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00085a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00085a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00085aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00085b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00085b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00085b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00085c10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00085c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00085e10: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
-00085e20: 5f73 636f 7265 732e 7079 0000 0000 0000  _scores.py......
-00085e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00085e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00085e80: 3030 3132 3536 3400 3030 3030 3030 3030  0012564.00000000
-00085e90: 3030 3000 3032 3032 3237 0020 3000 0000  000.020227. 0...
-00085ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00085f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00085f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00085f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00085f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00081b60: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
+00081b70: 706f 7274 2063 6f70 790d 0a64 6566 2045  port copy..def E
+00081b80: 4441 5f66 696e 645f 7265 6d6f 7665 5f63  DA_find_remove_c
+00081b90: 6f6c 756d 6e73 5f77 6974 685f 696e 6669  olumns_with_infi
+00081ba0: 6e69 7479 2864 662c 2072 656d 6f76 653d  nity(df, remove=
+00081bb0: 4661 6c73 6529 3a0d 0a20 2020 2022 2222  False):..    """
+00081bc0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+00081bd0: 696f 6e20 6669 6e64 7320 616c 6c20 636f  ion finds all co
+00081be0: 6c75 6d6e 7320 696e 2061 2064 6174 6166  lumns in a dataf
+00081bf0: 7261 6d65 2074 6861 7420 6861 7665 2069  rame that have i
+00081c00: 6e69 6669 6e69 7465 2076 616c 7565 7320  nifinite values 
+00081c10: 286e 702e 696e 6620 6f72 202d 6e70 2e69  (np.inf or -np.i
+00081c20: 6e66 290d 0a20 2020 2049 7420 7265 7475  nf)..    It retu
+00081c30: 726e 7320 6120 6c69 7374 206f 6620 636f  rns a list of co
+00081c40: 6c75 6d6e 206e 616d 6573 2e20 4966 2074  lumn names. If t
+00081c50: 6865 206c 6973 7420 6973 2065 6d70 7479  he list is empty
+00081c60: 2c20 6974 206d 6561 6e73 206e 6f20 636f  , it means no co
+00081c70: 6c75 6d6e 7320 7765 7265 2066 6f75 6e64  lumns were found
+00081c80: 2e0d 0a20 2020 2049 6620 7265 6d6f 7665  ...    If remove
+00081c90: 2066 6c61 6720 6973 2073 6574 2c20 7468   flag is set, th
+00081ca0: 656e 2069 7420 7265 7475 726e 7320 6120  en it returns a 
+00081cb0: 736d 616c 6c65 7220 6461 7461 6672 616d  smaller datafram
+00081cc0: 6520 7769 7468 2069 6e66 2063 6f6c 756d  e with inf colum
+00081cd0: 6e73 2072 656d 6f76 6564 2e0d 0a20 2020  ns removed...   
+00081ce0: 2022 2222 0d0a 2020 2020 6e75 6d73 203d   """..    nums =
+00081cf0: 2064 662e 7365 6c65 6374 5f64 7479 7065   df.select_dtype
+00081d00: 7328 696e 636c 7564 653d 276e 756d 6265  s(include='numbe
+00081d10: 7227 292e 636f 6c75 6d6e 732e 746f 6c69  r').columns.toli
+00081d20: 7374 2829 0d0a 2020 2020 6466 7820 3d20  st()..    dfx = 
+00081d30: 6466 5b6e 756d 735d 0d0a 2020 2020 7375  df[nums]..    su
+00081d40: 6d5f 726f 7773 203d 206e 702e 6973 696e  m_rows = np.isin
+00081d50: 6628 6466 7829 2e76 616c 7565 732e 7375  f(dfx).values.su
+00081d60: 6d28 290d 0a20 2020 2061 6464 5f63 6f6c  m()..    add_col
+00081d70: 7320 3d20 206c 6973 7428 6466 782e 636f  s =  list(dfx.co
+00081d80: 6c75 6d6e 732e 746f 5f73 6572 6965 7328  lumns.to_series(
+00081d90: 295b 6e70 2e69 7369 6e66 2864 6678 292e  )[np.isinf(dfx).
+00081da0: 616e 7928 295d 290d 0a20 2020 2069 6620  any()])..    if 
+00081db0: 7375 6d5f 726f 7773 203e 2030 3a0d 0a20  sum_rows > 0:.. 
+00081dc0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+00081dd0: 2020 7468 6572 6520 6172 6520 2564 2072    there are %d r
+00081de0: 6f77 7320 616e 6420 2564 2063 6f6c 756d  ows and %d colum
+00081df0: 6e73 2077 6974 6820 696e 6669 6e69 7479  ns with infinity
+00081e00: 2069 6e20 7468 656d 2e2e 2e27 2025 2873   in them...' %(s
+00081e10: 756d 5f72 6f77 732c 6c65 6e28 6164 645f  um_rows,len(add_
+00081e20: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
+00081e30: 2069 6620 7265 6d6f 7665 3a0d 0a20 2020   if remove:..   
+00081e40: 2020 2020 2020 2020 2023 2323 2068 6572           ### her
+00081e50: 6520 796f 7520 6e65 6564 2074 6f20 7573  e you need to us
+00081e60: 6520 6466 2073 696e 6365 2074 6865 2077  e df since the w
+00081e70: 686f 6c65 2064 6174 6173 6574 2069 7320  hole dataset is 
+00081e80: 696e 766f 6c76 6564 2023 2323 0d0a 2020  involved ###..  
+00081e90: 2020 2020 2020 2020 2020 6e6f 636f 6c73            nocols
+00081ea0: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
+00081eb0: 662e 636f 6c75 6d6e 7320 6966 2078 206e  f.columns if x n
+00081ec0: 6f74 2069 6e20 6164 645f 636f 6c73 5d0d  ot in add_cols].
+00081ed0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00081ee0: 6e74 2822 2020 2020 5368 6170 6520 6f66  nt("    Shape of
+00081ef0: 2064 6174 6173 6574 2062 6566 6f72 6520   dataset before 
+00081f00: 2573 2061 6e64 2061 6674 6572 2025 7320  %s and after %s 
+00081f10: 7265 6d6f 7669 6e67 2063 6f6c 756d 6e73  removing columns
+00081f20: 2077 6974 6820 696e 6669 6e69 7479 2220   with infinity" 
+00081f30: 2528 6466 2e73 6861 7065 2c28 6466 5b6e  %(df.shape,(df[n
+00081f40: 6f63 6f6c 735d 2e73 6861 7065 2c29 2929  ocols].shape,)))
+00081f50: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00081f60: 7475 726e 2064 665b 6e6f 636f 6c73 5d0d  turn df[nocols].
+00081f70: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00081f80: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
+00081f90: 6869 7320 7769 6c6c 2062 6520 6120 6c69  his will be a li
+00081fa0: 7374 206f 6620 636f 6c75 6d6e 7320 7769  st of columns wi
+00081fb0: 7468 2069 6e66 696e 6974 7920 2323 2323  th infinity ####
+00081fc0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00081fd0: 7475 726e 2061 6464 5f63 6f6c 730d 0a20  turn add_cols.. 
+00081fe0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00081ff0: 2020 2323 2074 6869 7320 7769 6c6c 2062    ## this will b
+00082000: 6520 616e 2065 6d70 7479 206c 6973 7420  e an empty list 
+00082010: 6966 2074 6865 7265 2061 7265 206e 6f20  if there are no 
+00082020: 636f 6c75 6d6e 7320 7769 7468 2069 6e66  columns with inf
+00082030: 696e 6974 790d 0a20 2020 2020 2020 2072  inity..        r
+00082040: 6574 7572 6e20 6164 645f 636f 6c73 0d0a  eturn add_cols..
+00082050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000820a0: 2323 2323 0d0a 6465 6620 636c 6173 7369  ####..def classi
+000820b0: 6679 5f63 6f6c 756d 6e73 2864 665f 7072  fy_columns(df_pr
+000820c0: 6564 732c 2076 6572 626f 7365 3d30 293a  eds, verbose=0):
+000820d0: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+000820e0: 6869 7320 6163 7475 616c 6c79 2064 6f65  his actually doe
+000820f0: 7320 4578 706c 6f72 6174 6f72 7920 6461  s Exploratory da
+00082100: 7461 2061 6e61 6c79 7369 7320 2d20 6974  ta analysis - it
+00082110: 206d 6561 6e73 2074 6869 7320 6675 6e63   means this func
+00082120: 7469 6f6e 2070 6572 666f 726d 7320 4544  tion performs ED
+00082130: 410d 0a20 2020 2023 2323 2323 2323 2323  A..    #########
+00082140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082180: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00082190: 2020 2054 616b 6573 2061 2064 6174 6166     Takes a dataf
+000821a0: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
+000821b0: 6f6e 6c79 2070 7265 6469 6374 6f72 7320  only predictors 
+000821c0: 746f 2062 6520 636c 6173 7369 6669 6564  to be classified
+000821d0: 2069 6e74 6f20 7661 7269 6f75 7320 7479   into various ty
+000821e0: 7065 732e 0d0a 2020 2020 444f 204e 4f54  pes...    DO NOT
+000821f0: 2053 454e 4420 494e 2041 2054 4152 4745   SEND IN A TARGE
+00082200: 5420 434f 4c55 4d4e 2073 696e 6365 2069  T COLUMN since i
+00082210: 7420 7769 6c6c 2074 7279 2074 6f20 696e  t will try to in
+00082220: 636c 7564 6520 7468 6174 2069 6e74 6f20  clude that into 
+00082230: 7661 7269 6f75 7320 636f 6c75 6d6e 732e  various columns.
+00082240: 0d0a 2020 2020 5265 7475 726e 7320 6120  ..    Returns a 
+00082250: 6461 7461 2066 7261 6d65 2063 6f6e 7461  data frame conta
+00082260: 696e 696e 6720 636f 6c75 6d6e 7320 616e  ining columns an
+00082270: 6420 7468 6520 636c 6173 7320 6974 2062  d the class it b
+00082280: 656c 6f6e 6773 2074 6f20 7375 6368 2061  elongs to such a
+00082290: 7320 6e75 6d65 7269 632c 0d0a 2020 2020  s numeric,..    
+000822a0: 6361 7465 676f 7269 6361 6c2c 2064 6174  categorical, dat
+000822b0: 6520 6f72 2069 6420 636f 6c75 6d6e 2c20  e or id column, 
+000822c0: 626f 6f6c 6561 6e2c 206e 6c70 2c20 6469  boolean, nlp, di
+000822d0: 7363 7265 7465 5f73 7472 696e 6720 616e  screte_string an
+000822e0: 6420 636f 6c73 2074 6f20 6465 6c65 7465  d cols to delete
+000822f0: 2e2e 2e0d 0a20 2020 2023 2323 2323 2323  .....    #######
+00082300: 2052 6574 7572 6e73 2061 2064 6963 7469   Returns a dicti
+00082310: 6f6e 6172 7920 7769 7468 2031 3020 6b69  onary with 10 ki
+00082320: 6e64 7320 6f66 2076 6172 7320 6c69 6b65  nds of vars like
+00082330: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a20   the following: 
+00082340: 2320 636f 6e74 696e 756f 7573 5f76 6172  # continuous_var
+00082350: 732c 696e 745f 7661 7273 0d0a 2020 2020  s,int_vars..    
+00082360: 2320 6361 745f 7661 7273 2c66 6163 746f  # cat_vars,facto
+00082370: 725f 7661 7273 2c20 626f 6f6c 5f76 6172  r_vars, bool_var
+00082380: 732c 6469 7363 7265 7465 5f73 7472 696e  s,discrete_strin
+00082390: 675f 7661 7273 2c6e 6c70 5f76 6172 732c  g_vars,nlp_vars,
+000823a0: 6461 7465 5f76 6172 732c 6964 5f76 6172  date_vars,id_var
+000823b0: 732c 636f 6c73 5f64 656c 6574 650d 0a20  s,cols_delete.. 
+000823c0: 2020 2022 2222 0d0a 2020 2020 7472 6169     """..    trai
+000823d0: 6e20 3d20 636f 7079 2e64 6565 7063 6f70  n = copy.deepcop
+000823e0: 7928 6466 5f70 7265 6473 290d 0a20 2020  y(df_preds)..   
+000823f0: 2023 2323 2320 4966 2074 6865 7265 2061   #### If there a
+00082400: 7265 2033 3020 6368 6172 7320 6172 6520  re 30 chars are 
+00082410: 6d6f 7265 2069 6e20 6120 6469 7363 7265  more in a discre
+00082420: 7465 5f73 7472 696e 675f 7661 722c 2069  te_string_var, i
+00082430: 7420 6973 2074 6865 6e20 636f 6e73 6964  t is then consid
+00082440: 6572 6564 2061 6e20 4e4c 5020 7661 7269  ered an NLP vari
+00082450: 6162 6c65 0d0a 2020 2020 6d61 785f 6e6c  able..    max_nl
+00082460: 705f 6368 6172 5f73 697a 6520 3d20 3330  p_char_size = 30
+00082470: 0d0a 2020 2020 6d61 785f 636f 6c73 5f74  ..    max_cols_t
+00082480: 6f5f 7072 696e 7420 3d20 3330 0d0a 2020  o_print = 30..  
+00082490: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
+000824a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000824b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000824c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000824d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000824e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000824f0: 2729 0d0a 2020 2020 7072 696e 7428 2723  ')..    print('#
+00082500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082510: 2323 2323 2323 2320 4320 4c20 4120 5320  ####### C L A S 
+00082520: 5320 4920 4620 5920 4920 4e20 4720 2056  S I F Y I N G  V
+00082530: 2041 2052 2049 2041 2042 204c 2045 2053   A R I A B L E S
+00082540: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00082550: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
+00082560: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+00082570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00082590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000825a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000825b0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+000825c0: 2020 2020 7072 696e 7428 2743 6c61 7373      print('Class
+000825d0: 6966 7969 6e67 2076 6172 6961 626c 6573  ifying variables
+000825e0: 2069 6e20 6461 7461 2073 6574 2e2e 2e27   in data set...'
+000825f0: 290d 0a20 2020 2023 2323 2320 4361 745f  )..    #### Cat_
+00082600: 4c69 6d69 7420 6465 6669 6e65 7320 7468  Limit defines th
+00082610: 6520 6d61 7820 6e75 6d62 6572 206f 6620  e max number of 
+00082620: 6361 7465 676f 7269 6573 2061 2063 6f6c  categories a col
+00082630: 756d 6e20 6361 6e20 6861 7665 2074 6f20  umn can have to 
+00082640: 6265 2063 616c 6c65 6420 6120 6361 7465  be called a cate
+00082650: 676f 7269 6361 6c20 636f 6c75 6d0d 0a20  gorical colum.. 
+00082660: 2020 2063 6174 5f6c 696d 6974 203d 2033     cat_limit = 3
+00082670: 350d 0a20 2020 2066 6c6f 6174 5f6c 696d  5..    float_lim
+00082680: 6974 203d 2031 3520 2323 2323 204d 616b  it = 15 #### Mak
+00082690: 6520 7468 6973 206c 696d 6974 206c 6f77  e this limit low
+000826a0: 2073 6f20 7468 6174 2066 6c6f 6174 2076   so that float v
+000826b0: 6172 6961 626c 6573 2062 656c 6f77 2074  ariables below t
+000826c0: 6869 7320 6c69 6d69 7420 6265 636f 6d65  his limit become
+000826d0: 2063 6174 2076 6172 7320 2323 230d 0a20   cat vars ###.. 
+000826e0: 2020 2064 6566 2061 6464 2861 2c62 293a     def add(a,b):
+000826f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00082700: 2061 2b62 0d0a 2020 2020 7375 6d5f 616c   a+b..    sum_al
+00082710: 6c5f 636f 6c73 203d 2064 6963 7428 290d  l_cols = dict().
+00082720: 0a20 2020 206f 7269 675f 636f 6c73 5f74  .    orig_cols_t
+00082730: 6f74 616c 203d 2074 7261 696e 2e73 6861  otal = train.sha
+00082740: 7065 5b31 5d0d 0a20 2020 2023 5479 7065  pe[1]..    #Type
+00082750: 7320 6f66 2063 6f6c 756d 6e73 0d0a 2020  s of columns..  
+00082760: 2020 636f 6c73 5f64 656c 6574 6520 3d20    cols_delete = 
+00082770: 5b5d 0d0a 2020 2020 636f 6c73 5f64 656c  []..    cols_del
+00082780: 6574 6520 3d20 5b63 6f6c 2066 6f72 2063  ete = [col for c
+00082790: 6f6c 2069 6e20 6c69 7374 2874 7261 696e  ol in list(train
+000827a0: 2920 6966 2028 6c65 6e28 7472 6169 6e5b  ) if (len(train[
+000827b0: 636f 6c5d 2e76 616c 7565 5f63 6f75 6e74  col].value_count
+000827c0: 7328 2929 203d 3d20 310d 0a20 2020 2020  s()) == 1..     
+000827d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000827e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000827f0: 2020 2920 7c20 2874 7261 696e 5b63 6f6c    ) | (train[col
+00082800: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
+00082810: 2f6c 656e 2874 7261 696e 2920 3e3d 2030  /len(train) >= 0
+00082820: 2e39 3029 5d0d 0a20 2020 2069 6e66 5f63  .90)]..    inf_c
+00082830: 6f6c 7320 3d20 4544 415f 6669 6e64 5f72  ols = EDA_find_r
+00082840: 656d 6f76 655f 636f 6c75 6d6e 735f 7769  emove_columns_wi
+00082850: 7468 5f69 6e66 696e 6974 7928 7472 6169  th_infinity(trai
+00082860: 6e29 0d0a 2020 2020 6d69 7865 645f 636f  n)..    mixed_co
+00082870: 6c73 203d 205b 7820 666f 7220 7820 696e  ls = [x for x in
+00082880: 206c 6973 7428 7472 6169 6e29 2069 6620   list(train) if 
+00082890: 6c65 6e28 7472 6169 6e5b 785d 2e64 726f  len(train[x].dro
+000828a0: 706e 6128 292e 6170 706c 7928 7479 7065  pna().apply(type
+000828b0: 292e 7661 6c75 655f 636f 756e 7473 2829  ).value_counts()
+000828c0: 2920 3e20 315d 0d0a 2020 2020 6966 206c  ) > 1]..    if l
+000828d0: 656e 286d 6978 6564 5f63 6f6c 7329 203e  en(mixed_cols) >
+000828e0: 2030 3a0d 0a20 2020 2020 2020 2070 7269   0:..        pri
+000828f0: 6e74 2827 2020 2020 5265 6d6f 7669 6e67  nt('    Removing
+00082900: 2025 7320 636f 6c75 6d6e 2873 2920 6475   %s column(s) du
+00082910: 6520 746f 206d 6978 6564 2064 6174 6120  e to mixed data 
+00082920: 7479 7065 2064 6574 6563 7465 642e 2e2e  type detected...
+00082930: 2720 256d 6978 6564 5f63 6f6c 7329 0d0a  ' %mixed_cols)..
+00082940: 2020 2020 636f 6c73 5f64 656c 6574 6520      cols_delete 
+00082950: 2b3d 206d 6978 6564 5f63 6f6c 730d 0a20  += mixed_cols.. 
+00082960: 2020 2063 6f6c 735f 6465 6c65 7465 202b     cols_delete +
+00082970: 3d20 696e 665f 636f 6c73 0d0a 2020 2020  = inf_cols..    
+00082980: 7472 6169 6e20 3d20 7472 6169 6e5b 6c65  train = train[le
+00082990: 6674 5f73 7562 7472 6163 7428 6c69 7374  ft_subtract(list
+000829a0: 2874 7261 696e 292c 636f 6c73 5f64 656c  (train),cols_del
+000829b0: 6574 6529 5d0d 0a20 2020 2076 6172 5f64  ete)]..    var_d
+000829c0: 6620 3d20 7064 2e53 6572 6965 7328 6469  f = pd.Series(di
+000829d0: 6374 2874 7261 696e 2e64 7479 7065 7329  ct(train.dtypes)
+000829e0: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
+000829f0: 6f70 3d46 616c 7365 292e 7265 6e61 6d65  op=False).rename
+00082a00: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00082a10: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00082a20: 6e73 3d7b 303a 2774 7970 655f 6f66 5f63  ns={0:'type_of_c
+00082a30: 6f6c 756d 6e27 7d29 0d0a 2020 2020 7375  olumn'})..    su
+00082a40: 6d5f 616c 6c5f 636f 6c73 5b27 636f 6c73  m_all_cols['cols
+00082a50: 5f64 656c 6574 6527 5d20 3d20 636f 6c73  _delete'] = cols
+00082a60: 5f64 656c 6574 650d 0a0d 0a20 2020 2076  _delete....    v
+00082a70: 6172 5f64 665b 2762 6f6f 6c27 5d20 3d20  ar_df['bool'] = 
+00082a80: 7661 725f 6466 2e61 7070 6c79 286c 616d  var_df.apply(lam
+00082a90: 6264 6120 783a 2031 2069 6620 785b 2774  bda x: 1 if x['t
+00082aa0: 7970 655f 6f66 5f63 6f6c 756d 6e27 5d20  ype_of_column'] 
+00082ab0: 696e 205b 2762 6f6f 6c27 2c27 6f62 6a65  in ['bool','obje
+00082ac0: 6374 275d 0d0a 2020 2020 2020 2020 2020  ct']..          
+00082ad0: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00082ae0: 6420 6c65 6e28 7472 6169 6e5b 785b 2769  d len(train[x['i
+00082af0: 6e64 6578 275d 5d2e 7661 6c75 655f 636f  ndex']].value_co
+00082b00: 756e 7473 2829 2920 3d3d 2032 2065 6c73  unts()) == 2 els
+00082b10: 6520 302c 2061 7869 733d 3129 0d0a 2020  e 0, axis=1)..  
+00082b20: 2020 7374 7269 6e67 5f62 6f6f 6c5f 7661    string_bool_va
+00082b30: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
+00082b40: 5b28 7661 725f 6466 5b27 626f 6f6c 275d  [(var_df['bool']
+00082b50: 203d 3d31 295d 5b27 696e 6465 7827 5d29   ==1)]['index'])
+00082b60: 0d0a 2020 2020 7375 6d5f 616c 6c5f 636f  ..    sum_all_co
+00082b70: 6c73 5b27 7374 7269 6e67 5f62 6f6f 6c5f  ls['string_bool_
+00082b80: 7661 7273 275d 203d 2073 7472 696e 675f  vars'] = string_
+00082b90: 626f 6f6c 5f76 6172 730d 0a20 2020 2076  bool_vars..    v
+00082ba0: 6172 5f64 665b 276e 756d 5f62 6f6f 6c27  ar_df['num_bool'
+00082bb0: 5d20 3d20 7661 725f 6466 2e61 7070 6c79  ] = var_df.apply
+00082bc0: 286c 616d 6264 6120 783a 2031 2069 6620  (lambda x: 1 if 
+00082bd0: 785b 2774 7970 655f 6f66 5f63 6f6c 756d  x['type_of_colum
+00082be0: 6e27 5d20 696e 205b 6e70 2e75 696e 7438  n'] in [np.uint8
+00082bf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00082c00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00082c10: 702e 7569 6e74 3136 2c20 6e70 2e75 696e  p.uint16, np.uin
+00082c20: 7433 322c 206e 702e 7569 6e74 3634 2c0d  t32, np.uint64,.
+00082c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082c40: 2020 2020 2020 2020 2020 2020 2027 696e               'in
+00082c50: 7438 272c 2769 6e74 3136 272c 2769 6e74  t8','int16','int
+00082c60: 3332 272c 2769 6e74 3634 272c 0d0a 2020  32','int64',..  
+00082c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082c80: 2020 2020 2020 2020 2020 2766 6c6f 6174            'float
+00082c90: 3136 272c 2766 6c6f 6174 3332 272c 2766  16','float32','f
+00082ca0: 6c6f 6174 3634 275d 2061 6e64 206c 656e  loat64'] and len
+00082cb0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00082cc0: 2020 2020 2020 2020 2020 2074 7261 696e             train
+00082cd0: 5b78 5b27 696e 6465 7827 5d5d 2e76 616c  [x['index']].val
+00082ce0: 7565 5f63 6f75 6e74 7328 2929 203d 3d20  ue_counts()) == 
+00082cf0: 3220 656c 7365 2030 2c20 6178 6973 3d31  2 else 0, axis=1
+00082d00: 290d 0a20 2020 206e 756d 5f62 6f6f 6c5f  )..    num_bool_
+00082d10: 7661 7273 203d 206c 6973 7428 7661 725f  vars = list(var_
+00082d20: 6466 5b28 7661 725f 6466 5b27 6e75 6d5f  df[(var_df['num_
+00082d30: 626f 6f6c 275d 203d 3d31 295d 5b27 696e  bool'] ==1)]['in
+00082d40: 6465 7827 5d29 0d0a 2020 2020 7375 6d5f  dex'])..    sum_
+00082d50: 616c 6c5f 636f 6c73 5b27 6e75 6d5f 626f  all_cols['num_bo
+00082d60: 6f6c 5f76 6172 7327 5d20 3d20 6e75 6d5f  ol_vars'] = num_
+00082d70: 626f 6f6c 5f76 6172 730d 0a20 2020 2023  bool_vars..    #
+00082d80: 2323 2323 2320 2020 5468 6973 2069 7320  #####   This is 
+00082d90: 7768 6572 6520 7765 2074 616b 6520 616c  where we take al
+00082da0: 6c20 4f62 6a65 6374 2076 6172 7320 616e  l Object vars an
+00082db0: 6420 7370 6c69 7420 7468 656d 2069 6e74  d split them int
+00082dc0: 6f20 6469 6666 206b 696e 6473 2023 2323  o diff kinds ###
+00082dd0: 0d0a 2020 2020 6469 7363 7265 7465 5f6f  ..    discrete_o
+00082de0: 725f 6e6c 7020 3d20 7661 725f 6466 2e61  r_nlp = var_df.a
+00082df0: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
+00082e00: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
+00082e10: 6f6c 756d 6e27 5d20 696e 205b 276f 626a  olumn'] in ['obj
+00082e20: 6563 7427 5d20 2061 6e64 2078 5b0d 0a20  ect']  and x[.. 
+00082e30: 2020 2020 2020 2027 696e 6465 7827 5d20         'index'] 
+00082e40: 6e6f 7420 696e 2073 7472 696e 675f 626f  not in string_bo
+00082e50: 6f6c 5f76 6172 732b 636f 6c73 5f64 656c  ol_vars+cols_del
+00082e60: 6574 6520 656c 7365 2030 2c61 7869 733d  ete else 0,axis=
+00082e70: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
+00082e80: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
+00082e90: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
+00082ea0: 6574 6865 7220 6120 7374 7269 6e67 2076  ether a string v
+00082eb0: 6172 2069 7320 6e6c 7020 6f72 2064 6973  ar is nlp or dis
+00082ec0: 6372 6574 655f 7374 7269 6e67 2076 6172  crete_string var
+00082ed0: 2023 2323 0d0a 2020 2020 7661 725f 6466   ###..    var_df
+00082ee0: 5b27 6e6c 705f 7374 7269 6e67 7327 5d20  ['nlp_strings'] 
+00082ef0: 3d20 300d 0a20 2020 2076 6172 5f64 665b  = 0..    var_df[
+00082f00: 2764 6973 6372 6574 655f 7374 7269 6e67  'discrete_string
+00082f10: 7327 5d20 3d20 300d 0a20 2020 2076 6172  s'] = 0..    var
+00082f20: 5f64 665b 2763 6174 275d 203d 2030 0d0a  _df['cat'] = 0..
+00082f30: 2020 2020 7661 725f 6466 5b27 6964 5f63      var_df['id_c
+00082f40: 6f6c 275d 203d 2030 0d0a 2020 2020 6469  ol'] = 0..    di
+00082f50: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
+00082f60: 7273 203d 2076 6172 5f64 662e 6c6f 635b  rs = var_df.loc[
+00082f70: 6469 7363 7265 7465 5f6f 725f 6e6c 703d  discrete_or_nlp=
+00082f80: 3d31 5d5b 2769 6e64 6578 275d 2e76 616c  =1]['index'].val
+00082f90: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
+00082fa0: 2020 636f 7079 5f64 6973 6372 6574 655f    copy_discrete_
+00082fb0: 6f72 5f6e 6c70 5f76 6172 7320 3d20 636f  or_nlp_vars = co
+00082fc0: 7079 2e64 6565 7063 6f70 7928 6469 7363  py.deepcopy(disc
+00082fd0: 7265 7465 5f6f 725f 6e6c 705f 7661 7273  rete_or_nlp_vars
+00082fe0: 290d 0a20 2020 2069 6620 6c65 6e28 6469  )..    if len(di
+00082ff0: 7363 7265 7465 5f6f 725f 6e6c 705f 7661  screte_or_nlp_va
+00083000: 7273 2920 3e20 303a 0d0a 2020 2020 2020  rs) > 0:..      
+00083010: 2020 666f 7220 636f 6c20 696e 2063 6f70    for col in cop
+00083020: 795f 6469 7363 7265 7465 5f6f 725f 6e6c  y_discrete_or_nl
+00083030: 705f 7661 7273 3a0d 0a20 2020 2020 2020  p_vars:..       
+00083040: 2020 2020 2023 2323 2320 6669 7273 7420       #### first 
+00083050: 6669 6c6c 2065 6d70 7479 206f 7220 6d69  fill empty or mi
+00083060: 7373 696e 6720 7661 6c73 2073 696e 6365  ssing vals since
+00083070: 2069 7420 7769 6c6c 2062 6c6f 7775 7020   it will blowup 
+00083080: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+00083090: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+000830a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+000830b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
+000830c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
+000830d0: 2020 2020 2020 2020 2020 7472 6169 6e5b            train[
+000830e0: 5b63 6f6c 5d5d 203d 2074 7261 696e 5b5b  [col]] = train[[
+000830f0: 636f 6c5d 5d2e 6669 6c6c 6e61 2827 2020  col]].fillna('  
+00083100: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00083110: 6966 2074 7261 696e 5b63 6f6c 5d2e 6d61  if train[col].ma
+00083120: 7028 6c61 6d62 6461 2078 3a20 6c65 6e28  p(lambda x: len(
+00083130: 7829 2069 6620 7479 7065 2878 293d 3d73  x) if type(x)==s
+00083140: 7472 2065 6c73 6520 3029 2e6d 6178 280d  tr else 0).max(.
+00083150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00083160: 2029 203e 3d20 3530 2061 6e64 206c 656e   ) >= 50 and len
+00083170: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
+00083180: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
+00083190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000831a0: 2020 2020 2920 3e3d 2069 6e74 2830 2e39      ) >= int(0.9
+000831b0: 2a6c 656e 2874 7261 696e 2929 2061 6e64  *len(train)) and
+000831c0: 2063 6f6c 206e 6f74 2069 6e20 7374 7269   col not in stri
+000831d0: 6e67 5f62 6f6f 6c5f 7661 7273 3a0d 0a20  ng_bool_vars:.. 
+000831e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000831f0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00083200: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
+00083210: 6e6c 705f 7374 7269 6e67 7327 5d20 3d20  nlp_strings'] = 
+00083220: 310d 0a20 2020 2020 2020 2020 2020 2065  1..            e
+00083230: 6c69 6620 7472 6169 6e5b 636f 6c5d 2e6d  lif train[col].m
+00083240: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
+00083250: 2878 2920 6966 2074 7970 6528 7829 3d3d  (x) if type(x)==
+00083260: 7374 7220 656c 7365 2030 292e 6d65 616e  str else 0).mean
+00083270: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00083280: 2020 2029 203e 3d20 6d61 785f 6e6c 705f     ) >= max_nlp_
+00083290: 6368 6172 5f73 697a 6520 616e 6420 7472  char_size and tr
+000832a0: 6169 6e5b 636f 6c5d 2e6d 6170 286c 616d  ain[col].map(lam
+000832b0: 6264 6120 783a 206c 656e 2878 2920 6966  bda x: len(x) if
+000832c0: 2074 7970 6528 7829 3d3d 7374 7220 656c   type(x)==str el
+000832d0: 7365 2030 292e 6d61 7828 0d0a 2020 2020  se 0).max(..    
+000832e0: 2020 2020 2020 2020 2020 2020 2920 3c20              ) < 
+000832f0: 3530 2061 6e64 206c 656e 2874 7261 696e  50 and len(train
+00083300: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
+00083310: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
+00083320: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
+00083330: 3c3d 2069 6e74 2830 2e39 2a6c 656e 2874  <= int(0.9*len(t
+00083340: 7261 696e 2929 2061 6e64 2063 6f6c 206e  rain)) and col n
+00083350: 6f74 2069 6e20 7374 7269 6e67 5f62 6f6f  ot in string_boo
+00083360: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
+00083370: 2020 2020 2020 2020 2076 6172 5f64 662e           var_df.
+00083380: 6c6f 635b 7661 725f 6466 5b27 696e 6465  loc[var_df['inde
+00083390: 7827 5d3d 3d63 6f6c 2c27 6469 7363 7265  x']==col,'discre
+000833a0: 7465 5f73 7472 696e 6773 275d 203d 2031  te_strings'] = 1
+000833b0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000833c0: 6966 206c 656e 2874 7261 696e 5b63 6f6c  if len(train[col
+000833d0: 5d2e 7661 6c75 655f 636f 756e 7473 2829  ].value_counts()
+000833e0: 2920 3e20 6361 745f 6c69 6d69 7420 616e  ) > cat_limit an
+000833f0: 6420 6c65 6e28 7472 6169 6e5b 636f 6c5d  d len(train[col]
+00083400: 2e76 616c 7565 5f63 6f75 6e74 7328 290d  .value_counts().
+00083410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00083420: 2020 2020 2020 2020 2029 203c 3d20 696e           ) <= in
+00083430: 7428 302e 392a 6c65 6e28 7472 6169 6e29  t(0.9*len(train)
+00083440: 2920 616e 6420 636f 6c20 6e6f 7420 696e  ) and col not in
+00083450: 2073 7472 696e 675f 626f 6f6c 5f76 6172   string_bool_var
+00083460: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00083470: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+00083480: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+00083490: 636f 6c2c 2764 6973 6372 6574 655f 7374  col,'discrete_st
+000834a0: 7269 6e67 7327 5d20 3d20 310d 0a20 2020  rings'] = 1..   
+000834b0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
+000834c0: 6e28 7472 6169 6e5b 636f 6c5d 2e76 616c  n(train[col].val
+000834d0: 7565 5f63 6f75 6e74 7328 2929 203e 2063  ue_counts()) > c
+000834e0: 6174 5f6c 696d 6974 2061 6e64 206c 656e  at_limit and len
+000834f0: 2874 7261 696e 5b63 6f6c 5d2e 7661 6c75  (train[col].valu
+00083500: 655f 636f 756e 7473 2829 0d0a 2020 2020  e_counts()..    
+00083510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083520: 2020 2020 2920 3d3d 206c 656e 2874 7261      ) == len(tra
+00083530: 696e 2920 616e 6420 636f 6c20 6e6f 7420  in) and col not 
+00083540: 696e 2073 7472 696e 675f 626f 6f6c 5f76  in string_bool_v
+00083550: 6172 733a 0d0a 2020 2020 2020 2020 2020  ars:..          
+00083560: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
+00083570: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
+00083580: 3d3d 636f 6c2c 2769 645f 636f 6c27 5d20  ==col,'id_col'] 
+00083590: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
+000835a0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000835b0: 2020 2020 2020 2020 7661 725f 6466 2e6c          var_df.l
+000835c0: 6f63 5b76 6172 5f64 665b 2769 6e64 6578  oc[var_df['index
+000835d0: 275d 3d3d 636f 6c2c 2763 6174 275d 203d  ']==col,'cat'] =
+000835e0: 2031 0d0a 2020 2020 6e6c 705f 7661 7273   1..    nlp_vars
+000835f0: 203d 206c 6973 7428 7661 725f 6466 5b28   = list(var_df[(
+00083600: 7661 725f 6466 5b27 6e6c 705f 7374 7269  var_df['nlp_stri
+00083610: 6e67 7327 5d20 3d3d 3129 5d5b 2769 6e64  ngs'] ==1)]['ind
+00083620: 6578 275d 290d 0a20 2020 2073 756d 5f61  ex'])..    sum_a
+00083630: 6c6c 5f63 6f6c 735b 276e 6c70 5f76 6172  ll_cols['nlp_var
+00083640: 7327 5d20 3d20 6e6c 705f 7661 7273 0d0a  s'] = nlp_vars..
+00083650: 2020 2020 6469 7363 7265 7465 5f73 7472      discrete_str
+00083660: 696e 675f 7661 7273 203d 206c 6973 7428  ing_vars = list(
+00083670: 7661 725f 6466 5b28 7661 725f 6466 5b27  var_df[(var_df['
+00083680: 6469 7363 7265 7465 5f73 7472 696e 6773  discrete_strings
+00083690: 275d 203d 3d31 2920 5d5b 2769 6e64 6578  '] ==1) ]['index
+000836a0: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
+000836b0: 5f63 6f6c 735b 2764 6973 6372 6574 655f  _cols['discrete_
+000836c0: 7374 7269 6e67 5f76 6172 7327 5d20 3d20  string_vars'] = 
+000836d0: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+000836e0: 7661 7273 0d0a 2020 2020 2323 2323 2323  vars..    ######
+000836f0: 2054 6869 7320 6861 7070 656e 7320 6f6e   This happens on
+00083700: 6c79 2069 6620 6120 7374 7269 6e67 2063  ly if a string c
+00083710: 6f6c 756d 6e20 6861 7070 656e 7320 746f  olumn happens to
+00083720: 2062 6520 616e 2049 4420 636f 6c75 6d6e   be an ID column
+00083730: 2023 2323 2323 2323 0d0a 2020 2020 2323   #######..    ##
+00083740: 2323 2044 4f20 4e4f 5420 4164 6420 7468  ## DO NOT Add th
+00083750: 6973 2074 6f20 4944 5f56 4152 5320 7965  is to ID_VARS ye
+00083760: 742e 2049 7420 7769 6c6c 2062 6520 646f  t. It will be do
+00083770: 6e65 206c 6174 6572 2e2e 2044 6f6e 7420  ne later.. Dont 
+00083780: 6368 616e 6765 2069 7420 6561 7369 6c79  change it easily
+00083790: 2e2e 2e0d 0a20 2020 2023 2323 2320 4361  .....    #### Ca
+000837a0: 7465 676f 7279 2044 5459 5045 2076 6172  tegory DTYPE var
+000837b0: 7320 6172 6520 7665 7279 2073 7065 6369  s are very speci
+000837c0: 616c 203d 2074 6865 7920 6361 6e20 6265  al = they can be
+000837d0: 206c 6566 7420 6173 2069 7320 616e 6420   left as is and 
+000837e0: 6e6f 7420 6469 7374 7572 6265 6420 696e  not disturbed in
+000837f0: 2050 7974 686f 6e2e 2023 2323 0d0a 2020   Python. ###..  
+00083800: 2020 7661 725f 6466 5b27 6463 6174 275d    var_df['dcat']
+00083810: 203d 2076 6172 5f64 662e 6170 706c 7928   = var_df.apply(
+00083820: 6c61 6d62 6461 2078 3a20 3120 6966 2073  lambda x: 1 if s
+00083830: 7472 2878 5b27 7479 7065 5f6f 665f 636f  tr(x['type_of_co
+00083840: 6c75 6d6e 275d 293d 3d27 6361 7465 676f  lumn'])=='catego
+00083850: 7279 2720 656c 7365 2030 2c0d 0a20 2020  ry' else 0,..   
+00083860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083870: 2020 2020 2020 2020 2061 7869 733d 3129           axis=1)
+00083880: 0d0a 2020 2020 6661 6374 6f72 5f76 6172  ..    factor_var
+00083890: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
+000838a0: 2876 6172 5f64 665b 2764 6361 7427 5d20  (var_df['dcat'] 
+000838b0: 3d3d 3129 5d5b 2769 6e64 6578 275d 290d  ==1)]['index']).
+000838c0: 0a20 2020 2073 756d 5f61 6c6c 5f63 6f6c  .    sum_all_col
+000838d0: 735b 2766 6163 746f 725f 7661 7273 275d  s['factor_vars']
+000838e0: 203d 2066 6163 746f 725f 7661 7273 0d0a   = factor_vars..
+000838f0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+00083900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00083930: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00083940: 2020 6461 7465 5f6f 725f 6964 203d 2076    date_or_id = v
+00083950: 6172 5f64 662e 6170 706c 7928 6c61 6d62  ar_df.apply(lamb
+00083960: 6461 2078 3a20 3120 6966 2078 5b27 7479  da x: 1 if x['ty
+00083970: 7065 5f6f 665f 636f 6c75 6d6e 275d 2069  pe_of_column'] i
+00083980: 6e20 5b6e 702e 7569 6e74 382c 0d0a 2020  n [np.uint8,..  
+00083990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000839a0: 2020 2020 2020 206e 702e 7569 6e74 3136         np.uint16
+000839b0: 2c20 6e70 2e75 696e 7433 322c 206e 702e  , np.uint32, np.
+000839c0: 7569 6e74 3634 2c0d 0a20 2020 2020 2020  uint64,..       
+000839d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000839e0: 2020 2769 6e74 3827 2c27 696e 7431 3627    'int8','int16'
+000839f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00083a00: 2020 2020 2020 2020 2020 2027 696e 7433             'int3
+00083a10: 3227 2c27 696e 7436 3427 5d20 2061 6e64  2','int64']  and
+00083a20: 2078 5b0d 0a20 2020 2020 2020 2027 696e   x[..        'in
+00083a30: 6465 7827 5d20 6e6f 7420 696e 2073 7472  dex'] not in str
+00083a40: 696e 675f 626f 6f6c 5f76 6172 732b 6e75  ing_bool_vars+nu
+00083a50: 6d5f 626f 6f6c 5f76 6172 732b 6469 7363  m_bool_vars+disc
+00083a60: 7265 7465 5f73 7472 696e 675f 7661 7273  rete_string_vars
+00083a70: 2b6e 6c70 5f76 6172 7320 656c 7365 2030  +nlp_vars else 0
+00083a80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00083a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083aa0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00083ab0: 3129 0d0a 2020 2020 2323 2323 2323 2323  1)..    ########
+00083ac0: 2320 5468 6973 2069 7320 7768 6572 6520  # This is where 
+00083ad0: 7765 2066 6967 7572 6520 6f75 7420 7768  we figure out wh
+00083ae0: 6574 6865 7220 6120 6e75 6d65 7269 6320  ether a numeric 
+00083af0: 636f 6c20 6973 2064 6174 6520 6f72 2069  col is date or i
+00083b00: 6420 7661 7269 6162 6c65 2023 2323 0d0a  d variable ###..
+00083b10: 2020 2020 7661 725f 6466 5b27 696e 7427      var_df['int'
+00083b20: 5d20 3d20 300d 0a20 2020 2076 6172 5f64  ] = 0..    var_d
+00083b30: 665b 2764 6174 655f 7469 6d65 275d 203d  f['date_time'] =
+00083b40: 2030 0d0a 2020 2020 2323 2320 6966 2061   0..    ### if a
+00083b50: 2070 6172 7469 6375 6c61 7220 636f 6c75   particular colu
+00083b60: 6d6e 2069 7320 6461 7465 2d74 696d 6520  mn is date-time 
+00083b70: 7479 7065 2c20 6e6f 7720 7365 7420 6974  type, now set it
+00083b80: 2061 7320 6120 6461 7465 2074 696d 6520   as a date time 
+00083b90: 7661 7269 6162 6c65 2023 230d 0a20 2020  variable ##..   
+00083ba0: 2076 6172 5f64 665b 2764 6174 655f 7469   var_df['date_ti
+00083bb0: 6d65 275d 203d 2076 6172 5f64 662e 6170  me'] = var_df.ap
+00083bc0: 706c 7928 6c61 6d62 6461 2078 3a20 3120  ply(lambda x: 1 
+00083bd0: 6966 2078 5b27 7479 7065 5f6f 665f 636f  if x['type_of_co
+00083be0: 6c75 6d6e 275d 2069 6e20 5b27 3c4d 385b  lumn'] in ['<M8[
+00083bf0: 6e73 5d27 2c27 6461 7465 7469 6d65 3634  ns]','datetime64
+00083c00: 5b6e 735d 275d 2020 616e 6420 785b 0d0a  [ns]']  and x[..
+00083c10: 2020 2020 2020 2020 2769 6e64 6578 275d          'index']
+00083c20: 206e 6f74 2069 6e20 7374 7269 6e67 5f62   not in string_b
+00083c30: 6f6f 6c5f 7661 7273 2b6e 756d 5f62 6f6f  ool_vars+num_boo
+00083c40: 6c5f 7661 7273 2b64 6973 6372 6574 655f  l_vars+discrete_
+00083c50: 7374 7269 6e67 5f76 6172 732b 6e6c 705f  string_vars+nlp_
+00083c60: 7661 7273 2065 6c73 6520 302c 0d0a 2020  vars else 0,..  
+00083c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083c90: 2020 2020 2020 6178 6973 3d31 290d 0a20        axis=1).. 
+00083ca0: 2020 2023 2323 2074 6869 7320 6973 2077     ### this is w
+00083cb0: 6865 7265 2077 6520 7361 7665 2074 6865  here we save the
+00083cc0: 6d20 6173 2064 6174 6520 7469 6d65 2076  m as date time v
+00083cd0: 6172 6961 626c 6573 2023 2323 0d0a 2020  ariables ###..  
+00083ce0: 2020 6966 206c 656e 2876 6172 5f64 662e    if len(var_df.
+00083cf0: 6c6f 635b 6461 7465 5f6f 725f 6964 3d3d  loc[date_or_id==
+00083d00: 315d 2920 213d 2030 3a0d 0a20 2020 2020  1]) != 0:..     
+00083d10: 2020 2066 6f72 2063 6f6c 2069 6e20 7661     for col in va
+00083d20: 725f 6466 2e6c 6f63 5b64 6174 655f 6f72  r_df.loc[date_or
+00083d30: 5f69 643d 3d31 5d5b 2769 6e64 6578 275d  _id==1]['index']
+00083d40: 2e76 616c 7565 732e 746f 6c69 7374 2829  .values.tolist()
+00083d50: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00083d60: 6620 6c65 6e28 7472 6169 6e5b 636f 6c5d  f len(train[col]
+00083d70: 2e76 616c 7565 5f63 6f75 6e74 7328 2929  .value_counts())
+00083d80: 203d 3d20 6c65 6e28 7472 6169 6e29 3a0d   == len(train):.
+00083d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00083da0: 2069 6620 7472 6169 6e5b 636f 6c5d 2e6d   if train[col].m
+00083db0: 696e 2829 203c 2031 3930 3020 6f72 2074  in() < 1900 or t
+00083dc0: 7261 696e 5b63 6f6c 5d2e 6d61 7828 2920  rain[col].max() 
+00083dd0: 3e20 3230 3530 3a0d 0a20 2020 2020 2020  > 2050:..       
+00083de0: 2020 2020 2020 2020 2020 2020 2076 6172               var
+00083df0: 5f64 662e 6c6f 635b 7661 725f 6466 5b27  _df.loc[var_df['
+00083e00: 696e 6465 7827 5d3d 3d63 6f6c 2c27 6964  index']==col,'id
+00083e10: 5f63 6f6c 275d 203d 2031 0d0a 2020 2020  _col'] = 1..    
+00083e20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00083e30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00083e40: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00083e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083e60: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
+00083e70: 696d 6528 7472 6169 6e5b 636f 6c5d 2c69  ime(train[col],i
+00083e80: 6e66 6572 5f64 6174 6574 696d 655f 666f  nfer_datetime_fo
+00083e90: 726d 6174 3d54 7275 6529 0d0a 2020 2020  rmat=True)..    
+00083ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083eb0: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+00083ec0: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+00083ed0: 636f 6c2c 2764 6174 655f 7469 6d65 275d  col,'date_time']
+00083ee0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+00083ef0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00083f00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00083f10: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
+00083f20: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
+00083f30: 6465 7827 5d3d 3d63 6f6c 2c27 6964 5f63  dex']==col,'id_c
+00083f40: 6f6c 275d 203d 2031 0d0a 2020 2020 2020  ol'] = 1..      
+00083f50: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00083f60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00083f70: 7472 6169 6e5b 636f 6c5d 2e6d 696e 2829  train[col].min()
+00083f80: 203c 2031 3930 3020 6f72 2074 7261 696e   < 1900 or train
+00083f90: 5b63 6f6c 5d2e 6d61 7828 2920 3e20 3230  [col].max() > 20
+00083fa0: 3530 3a0d 0a20 2020 2020 2020 2020 2020  50:..           
+00083fb0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
+00083fc0: 6e6f 7420 696e 206e 756d 5f62 6f6f 6c5f  not in num_bool_
+00083fd0: 7661 7273 3a0d 0a20 2020 2020 2020 2020  vars:..         
+00083fe0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00083ff0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00084000: 5b27 696e 6465 7827 5d3d 3d63 6f6c 2c27  ['index']==col,'
+00084010: 696e 7427 5d20 3d20 310d 0a20 2020 2020  int'] = 1..     
+00084020: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00084030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00084040: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00084050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084060: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
+00084070: 6d65 2874 7261 696e 5b63 6f6c 5d2c 696e  me(train[col],in
+00084080: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
+00084090: 6d61 743d 5472 7565 290d 0a20 2020 2020  mat=True)..     
+000840a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000840b0: 2020 2076 6172 5f64 662e 6c6f 635b 7661     var_df.loc[va
+000840c0: 725f 6466 5b27 696e 6465 7827 5d3d 3d63  r_df['index']==c
+000840d0: 6f6c 2c27 6461 7465 5f74 696d 6527 5d20  ol,'date_time'] 
+000840e0: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
+000840f0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00084100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00084110: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
+00084120: 206e 6f74 2069 6e20 6e75 6d5f 626f 6f6c   not in num_bool
+00084130: 5f76 6172 733a 0d0a 2020 2020 2020 2020  _vars:..        
+00084140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084150: 2020 2020 7661 725f 6466 2e6c 6f63 5b76      var_df.loc[v
+00084160: 6172 5f64 665b 2769 6e64 6578 275d 3d3d  ar_df['index']==
+00084170: 636f 6c2c 2769 6e74 275d 203d 2031 0d0a  col,'int'] = 1..
+00084180: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00084190: 2020 2070 6173 730d 0a20 2020 2069 6e74     pass..    int
+000841a0: 5f76 6172 7320 3d20 6c69 7374 2876 6172  _vars = list(var
+000841b0: 5f64 665b 2876 6172 5f64 665b 2769 6e74  _df[(var_df['int
+000841c0: 275d 203d 3d31 295d 5b27 696e 6465 7827  '] ==1)]['index'
+000841d0: 5d29 0d0a 2020 2020 6461 7465 5f76 6172  ])..    date_var
+000841e0: 7320 3d20 6c69 7374 2876 6172 5f64 665b  s = list(var_df[
+000841f0: 2876 6172 5f64 665b 2764 6174 655f 7469  (var_df['date_ti
+00084200: 6d65 275d 203d 3d20 3129 5d5b 2769 6e64  me'] == 1)]['ind
+00084210: 6578 275d 290d 0a20 2020 2069 645f 7661  ex'])..    id_va
+00084220: 7273 203d 206c 6973 7428 7661 725f 6466  rs = list(var_df
+00084230: 5b28 7661 725f 6466 5b27 6964 5f63 6f6c  [(var_df['id_col
+00084240: 275d 203d 3d20 3129 5d5b 2769 6e64 6578  '] == 1)]['index
+00084250: 275d 290d 0a20 2020 2073 756d 5f61 6c6c  '])..    sum_all
+00084260: 5f63 6f6c 735b 2769 6e74 5f76 6172 7327  _cols['int_vars'
+00084270: 5d20 3d20 696e 745f 7661 7273 0d0a 2020  ] = int_vars..  
+00084280: 2020 636f 7079 5f64 6174 655f 7661 7273    copy_date_vars
+00084290: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+000842a0: 2864 6174 655f 7661 7273 290d 0a20 2020  (date_vars)..   
+000842b0: 2066 6f72 2064 6174 655f 7661 7220 696e   for date_var in
+000842c0: 2063 6f70 795f 6461 7465 5f76 6172 733a   copy_date_vars:
+000842d0: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
+000842e0: 6869 7320 7465 7374 2069 7320 746f 206d  his test is to m
+000842f0: 616b 6520 7375 7265 2073 7572 6520 6461  ake sure sure da
+00084300: 7465 2076 6172 7320 6172 6520 6163 7475  te vars are actu
+00084310: 616c 6c79 2064 6174 6520 7661 7273 0d0a  ally date vars..
+00084320: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00084330: 2020 2020 2020 2020 2020 7064 2e74 6f5f            pd.to_
+00084340: 6461 7465 7469 6d65 2874 7261 696e 5b64  datetime(train[d
+00084350: 6174 655f 7661 725d 2c69 6e66 6572 5f64  ate_var],infer_d
+00084360: 6174 6574 696d 655f 666f 726d 6174 3d54  atetime_format=T
+00084370: 7275 6529 0d0a 2020 2020 2020 2020 6578  rue)..        ex
+00084380: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00084390: 2020 2023 2323 2323 2069 6620 6e6f 7420     ##### if not 
+000843a0: 6120 6461 7465 2076 6172 2c20 7468 656e  a date var, then
+000843b0: 206a 7573 7420 6164 6420 6974 2074 6f20   just add it to 
+000843c0: 6465 6c65 7465 2069 7420 6672 6f6d 2070  delete it from p
+000843d0: 726f 6365 7373 696e 670d 0a20 2020 2020  rocessing..     
+000843e0: 2020 2020 2020 2063 6f6c 735f 6465 6c65         cols_dele
+000843f0: 7465 2e61 7070 656e 6428 6461 7465 5f76  te.append(date_v
+00084400: 6172 290d 0a20 2020 2020 2020 2020 2020  ar)..           
+00084410: 2064 6174 655f 7661 7273 2e72 656d 6f76   date_vars.remov
+00084420: 6528 6461 7465 5f76 6172 290d 0a20 2020  e(date_var)..   
+00084430: 2073 756d 5f61 6c6c 5f63 6f6c 735b 2764   sum_all_cols['d
+00084440: 6174 655f 7661 7273 275d 203d 2064 6174  ate_vars'] = dat
+00084450: 655f 7661 7273 0d0a 2020 2020 7375 6d5f  e_vars..    sum_
+00084460: 616c 6c5f 636f 6c73 5b27 6964 5f76 6172  all_cols['id_var
+00084470: 7327 5d20 3d20 6964 5f76 6172 730d 0a20  s'] = id_vars.. 
+00084480: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
+00084490: 2763 6f6c 735f 6465 6c65 7465 275d 203d  'cols_delete'] =
+000844a0: 2063 6f6c 735f 6465 6c65 7465 0d0a 2020   cols_delete..  
+000844b0: 2020 2323 2054 6869 7320 6973 2061 6e20    ## This is an 
+000844c0: 4558 5452 454d 454c 5920 636f 6d70 6c69  EXTREMELY compli
+000844d0: 6361 7465 6420 6c6f 6769 6320 666f 7220  cated logic for 
+000844e0: 6361 7420 7661 7273 2e20 446f 6e27 7420  cat vars. Don't 
+000844f0: 6368 616e 6765 2069 7420 756e 6c65 7373  change it unless
+00084500: 2079 6f75 2074 6573 7420 6974 206d 616e   you test it man
+00084510: 7920 7469 6d65 7321 0d0a 2020 2020 7661  y times!..    va
+00084520: 725f 6466 5b27 6e75 6d65 7269 6327 5d20  r_df['numeric'] 
+00084530: 3d20 300d 0a20 2020 2066 6c6f 6174 5f6f  = 0..    float_o
+00084540: 725f 6361 7420 3d20 7661 725f 6466 2e61  r_cat = var_df.a
+00084550: 7070 6c79 286c 616d 6264 6120 783a 2031  pply(lambda x: 1
+00084560: 2069 6620 785b 2774 7970 655f 6f66 5f63   if x['type_of_c
+00084570: 6f6c 756d 6e27 5d20 696e 205b 2766 6c6f  olumn'] in ['flo
+00084580: 6174 3136 272c 0d0a 2020 2020 2020 2020  at16',..        
+00084590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000845a0: 2020 2020 2766 6c6f 6174 3332 272c 2766      'float32','f
+000845b0: 6c6f 6174 3634 275d 2065 6c73 6520 302c  loat64'] else 0,
+000845c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000845d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000845e0: 2020 2020 2020 2020 2020 6178 6973 3d31            axis=1
+000845f0: 290d 0a20 2020 2023 2323 2323 2323 2020  )..    #######  
+00084600: 5765 206e 6565 6420 746f 206d 616b 6520  We need to make 
+00084610: 7375 7265 2074 6865 7265 2061 7265 206e  sure there are n
+00084620: 6f20 6361 7465 676f 7269 6361 6c20 7661  o categorical va
+00084630: 7273 2069 6e20 666c 6f61 7420 2323 2323  rs in float ####
+00084640: 2323 230d 0a20 2020 2069 6620 6c65 6e28  ###..    if len(
+00084650: 7661 725f 6466 2e6c 6f63 5b66 6c6f 6174  var_df.loc[float
+00084660: 5f6f 725f 6361 7420 3d3d 2031 5d29 203e  _or_cat == 1]) >
+00084670: 2030 3a0d 0a20 2020 2020 2020 2066 6f72   0:..        for
+00084680: 2063 6f6c 2069 6e20 7661 725f 6466 2e6c   col in var_df.l
+00084690: 6f63 5b66 6c6f 6174 5f6f 725f 6361 7420  oc[float_or_cat 
+000846a0: 3d3d 2031 5d5b 2769 6e64 6578 275d 2e76  == 1]['index'].v
+000846b0: 616c 7565 732e 746f 6c69 7374 2829 3a0d  alues.tolist():.
+000846c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000846d0: 6c65 6e28 7472 6169 6e5b 636f 6c5d 2e76  len(train[col].v
+000846e0: 616c 7565 5f63 6f75 6e74 7328 2929 203e  alue_counts()) >
+000846f0: 2032 2061 6e64 206c 656e 2874 7261 696e   2 and len(train
+00084700: 5b63 6f6c 5d2e 7661 6c75 655f 636f 756e  [col].value_coun
+00084710: 7473 2829 0d0a 2020 2020 2020 2020 2020  ts()..          
+00084720: 2020 2020 2020 2920 3c3d 2066 6c6f 6174        ) <= float
+00084730: 5f6c 696d 6974 2061 6e64 206c 656e 2874  _limit and len(t
+00084740: 7261 696e 5b63 6f6c 5d2e 7661 6c75 655f  rain[col].value_
+00084750: 636f 756e 7473 2829 2920 3c3d 206c 656e  counts()) <= len
+00084760: 2874 7261 696e 293a 0d0a 2020 2020 2020  (train):..      
+00084770: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
+00084780: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
+00084790: 6578 275d 3d3d 636f 6c2c 2763 6174 275d  ex']==col,'cat']
+000847a0: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+000847b0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000847c0: 2020 2020 2020 2020 2069 6620 636f 6c20           if col 
+000847d0: 6e6f 7420 696e 2028 6e75 6d5f 626f 6f6c  not in (num_bool
+000847e0: 5f76 6172 7320 2b20 6661 6374 6f72 5f76  _vars + factor_v
+000847f0: 6172 7329 3a0d 0a20 2020 2020 2020 2020  ars):..         
+00084800: 2020 2020 2020 2020 2020 2076 6172 5f64             var_d
+00084810: 662e 6c6f 635b 7661 725f 6466 5b27 696e  f.loc[var_df['in
+00084820: 6465 7827 5d3d 3d63 6f6c 2c27 6e75 6d65  dex']==col,'nume
+00084830: 7269 6327 5d20 3d20 310d 0a20 2020 2063  ric'] = 1..    c
+00084840: 6174 5f76 6172 7320 3d20 6c69 7374 2876  at_vars = list(v
+00084850: 6172 5f64 665b 2876 6172 5f64 665b 2763  ar_df[(var_df['c
+00084860: 6174 275d 203d 3d31 295d 5b27 696e 6465  at'] ==1)]['inde
+00084870: 7827 5d29 0d0a 2020 2020 636f 6e74 696e  x'])..    contin
+00084880: 756f 7573 5f76 6172 7320 3d20 6c69 7374  uous_vars = list
+00084890: 2876 6172 5f64 665b 2876 6172 5f64 665b  (var_df[(var_df[
+000848a0: 276e 756d 6572 6963 275d 203d 3d31 295d  'numeric'] ==1)]
+000848b0: 5b27 696e 6465 7827 5d29 0d0a 2020 2020  ['index'])..    
+000848c0: 0d0a 2020 2020 2323 2323 2323 2323 2020  ..    ########  
+000848d0: 5620 4520 5220 5920 2020 2049 204d 2050  V E R Y    I M P
+000848e0: 204f 2052 2054 2041 204e 2054 2020 2023   O R T A N T   #
+000848f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00084920: 2323 0d0a 2020 2020 6361 745f 7661 7273  ##..    cat_vars
+00084930: 5f63 6f70 7920 3d20 636f 7079 2e64 6565  _copy = copy.dee
+00084940: 7063 6f70 7928 6661 6374 6f72 5f76 6172  pcopy(factor_var
+00084950: 7329 200d 0a20 2020 2066 6f72 2063 6174  s) ..    for cat
+00084960: 2069 6e20 6361 745f 7661 7273 5f63 6f70   in cat_vars_cop
+00084970: 793a 0d0a 2020 2020 2020 2020 6966 2064  y:..        if d
+00084980: 665f 7072 6564 735b 6361 745d 2e64 7479  f_preds[cat].dty
+00084990: 7065 3d3d 666c 6f61 743a 0d0a 2020 2020  pe==float:..    
+000849a0: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
+000849b0: 7573 5f76 6172 732e 6170 7065 6e64 2863  us_vars.append(c
+000849c0: 6174 290d 0a20 2020 2020 2020 2020 2020  at)..           
+000849d0: 2066 6163 746f 725f 7661 7273 2e72 656d   factor_vars.rem
+000849e0: 6f76 6528 6361 7429 0d0a 2020 2020 2020  ove(cat)..      
+000849f0: 2020 2020 2020 7661 725f 6466 2e6c 6f63        var_df.loc
+00084a00: 5b76 6172 5f64 665b 2769 6e64 6578 275d  [var_df['index']
+00084a10: 3d3d 6361 742c 2764 6361 7427 5d20 3d20  ==cat,'dcat'] = 
+00084a20: 300d 0a20 2020 2020 2020 2020 2020 2076  0..            v
+00084a30: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00084a40: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
+00084a50: 6e75 6d65 7269 6327 5d20 3d20 310d 0a20  numeric'] = 1.. 
+00084a60: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+00084a70: 6466 5f70 7265 6473 5b63 6174 5d2e 7661  df_preds[cat].va
+00084a80: 6c75 655f 636f 756e 7473 2829 2920 3d3d  lue_counts()) ==
+00084a90: 2064 665f 7072 6564 732e 7368 6170 655b   df_preds.shape[
+00084aa0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+00084ab0: 2069 645f 7661 7273 2e61 7070 656e 6428   id_vars.append(
+00084ac0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
+00084ad0: 2020 6661 6374 6f72 5f76 6172 732e 7265    factor_vars.re
+00084ae0: 6d6f 7665 2863 6174 290d 0a20 2020 2020  move(cat)..     
+00084af0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
+00084b00: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
+00084b10: 5d3d 3d63 6174 2c27 6463 6174 275d 203d  ]==cat,'dcat'] =
+00084b20: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+00084b30: 7661 725f 6466 2e6c 6f63 5b76 6172 5f64  var_df.loc[var_d
+00084b40: 665b 2769 6e64 6578 275d 3d3d 6361 742c  f['index']==cat,
+00084b50: 2769 645f 636f 6c27 5d20 3d20 310d 0a20  'id_col'] = 1.. 
+00084b60: 2020 200d 0a20 2020 2073 756d 5f61 6c6c     ..    sum_all
+00084b70: 5f63 6f6c 735b 2766 6163 746f 725f 7661  _cols['factor_va
+00084b80: 7273 275d 203d 2066 6163 746f 725f 7661  rs'] = factor_va
+00084b90: 7273 0d0a 2020 2020 2323 2323 2320 5468  rs..    ##### Th
+00084ba0: 6572 6520 6172 6520 6120 636f 7570 6c65  ere are a couple
+00084bb0: 206f 6620 6578 7472 6120 7465 7374 7320   of extra tests 
+00084bc0: 796f 7520 6e65 6564 2074 6f20 646f 2074  you need to do t
+00084bd0: 6f20 7265 6d6f 7665 2061 6262 6572 6174  o remove abberat
+00084be0: 696f 6e73 2069 6e20 6361 745f 7661 7273  ions in cat_vars
+00084bf0: 2023 2323 0d0a 2020 2020 6361 745f 7661   ###..    cat_va
+00084c00: 7273 5f63 6f70 7920 3d20 636f 7079 2e64  rs_copy = copy.d
+00084c10: 6565 7063 6f70 7928 6361 745f 7661 7273  eepcopy(cat_vars
+00084c20: 2920 0d0a 2020 2020 666f 7220 6361 7420  ) ..    for cat 
+00084c30: 696e 2063 6174 5f76 6172 735f 636f 7079  in cat_vars_copy
+00084c40: 3a0d 0a20 2020 2020 2020 2069 6620 6466  :..        if df
+00084c50: 5f70 7265 6473 5b63 6174 5d2e 6474 7970  _preds[cat].dtyp
+00084c60: 653d 3d66 6c6f 6174 3a0d 0a20 2020 2020  e==float:..     
+00084c70: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
+00084c80: 735f 7661 7273 2e61 7070 656e 6428 6361  s_vars.append(ca
+00084c90: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00084ca0: 6361 745f 7661 7273 2e72 656d 6f76 6528  cat_vars.remove(
+00084cb0: 6361 7429 0d0a 2020 2020 2020 2020 2020  cat)..          
+00084cc0: 2020 7661 725f 6466 2e6c 6f63 5b76 6172    var_df.loc[var
+00084cd0: 5f64 665b 2769 6e64 6578 275d 3d3d 6361  _df['index']==ca
+00084ce0: 742c 2763 6174 275d 203d 2030 0d0a 2020  t,'cat'] = 0..  
+00084cf0: 2020 2020 2020 2020 2020 7661 725f 6466            var_df
+00084d00: 2e6c 6f63 5b76 6172 5f64 665b 2769 6e64  .loc[var_df['ind
+00084d10: 6578 275d 3d3d 6361 742c 276e 756d 6572  ex']==cat,'numer
+00084d20: 6963 275d 203d 2031 0d0a 2020 2020 2020  ic'] = 1..      
+00084d30: 2020 656c 6966 206c 656e 2864 665f 7072    elif len(df_pr
+00084d40: 6564 735b 6361 745d 2e76 616c 7565 5f63  eds[cat].value_c
+00084d50: 6f75 6e74 7328 2929 203d 3d20 6466 5f70  ounts()) == df_p
+00084d60: 7265 6473 2e73 6861 7065 5b30 5d3a 0d0a  reds.shape[0]:..
+00084d70: 2020 2020 2020 2020 2020 2020 6964 5f76              id_v
+00084d80: 6172 732e 6170 7065 6e64 2863 6174 290d  ars.append(cat).
+00084d90: 0a20 2020 2020 2020 2020 2020 2063 6174  .            cat
+00084da0: 5f76 6172 732e 7265 6d6f 7665 2863 6174  _vars.remove(cat
+00084db0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+00084dc0: 6172 5f64 662e 6c6f 635b 7661 725f 6466  ar_df.loc[var_df
+00084dd0: 5b27 696e 6465 7827 5d3d 3d63 6174 2c27  ['index']==cat,'
+00084de0: 6361 7427 5d20 3d20 300d 0a20 2020 2020  cat'] = 0..     
+00084df0: 2020 2020 2020 2076 6172 5f64 662e 6c6f         var_df.lo
+00084e00: 635b 7661 725f 6466 5b27 696e 6465 7827  c[var_df['index'
+00084e10: 5d3d 3d63 6174 2c27 6964 5f63 6f6c 275d  ]==cat,'id_col']
+00084e20: 203d 2031 0d0a 2020 2020 7375 6d5f 616c   = 1..    sum_al
+00084e30: 6c5f 636f 6c73 5b27 6361 745f 7661 7273  l_cols['cat_vars
+00084e40: 275d 203d 2063 6174 5f76 6172 730d 0a20  '] = cat_vars.. 
+00084e50: 2020 2073 756d 5f61 6c6c 5f63 6f6c 735b     sum_all_cols[
+00084e60: 2763 6f6e 7469 6e75 6f75 735f 7661 7273  'continuous_vars
+00084e70: 275d 203d 2063 6f6e 7469 6e75 6f75 735f  '] = continuous_
+00084e80: 7661 7273 0d0a 2020 2020 7375 6d5f 616c  vars..    sum_al
+00084e90: 6c5f 636f 6c73 5b27 6964 5f76 6172 7327  l_cols['id_vars'
+00084ea0: 5d20 3d20 6964 5f76 6172 730d 0a20 2020  ] = id_vars..   
+00084eb0: 2023 2323 2323 2320 5468 6973 2069 7320   ###### This is 
+00084ec0: 7768 6572 6520 796f 7520 636f 6e73 6f6c  where you consol
+00084ed0: 6461 7465 2074 6865 206e 756d 6265 7273  date the numbers
+00084ee0: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+00084ef0: 2020 7661 725f 6469 6374 5f73 756d 203d    var_dict_sum =
+00084f00: 2064 6963 7428 7a69 7028 7661 725f 6466   dict(zip(var_df
+00084f10: 2e76 616c 7565 735b 3a2c 305d 2c20 7661  .values[:,0], va
+00084f20: 725f 6466 2e76 616c 7565 735b 3a2c 323a  r_df.values[:,2:
+00084f30: 5d2e 7375 6d28 3129 2929 0d0a 2020 2020  ].sum(1)))..    
+00084f40: 666f 7220 636f 6c2c 2073 756d 7661 6c20  for col, sumval 
+00084f50: 696e 2076 6172 5f64 6963 745f 7375 6d2e  in var_dict_sum.
+00084f60: 6974 656d 7328 293a 0d0a 2020 2020 2020  items():..      
+00084f70: 2020 6966 2073 756d 7661 6c20 3d3d 2030    if sumval == 0
+00084f80: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00084f90: 7269 6e74 2827 2573 206f 6620 7479 7065  rint('%s of type
+00084fa0: 3d25 7320 6973 206e 6f74 2063 6c61 7373  =%s is not class
+00084fb0: 6966 6965 6427 2025 2863 6f6c 2c74 7261  ified' %(col,tra
+00084fc0: 696e 5b63 6f6c 5d2e 6474 7970 6529 290d  in[col].dtype)).
+00084fd0: 0a20 2020 2020 2020 2065 6c69 6620 7375  .        elif su
+00084fe0: 6d76 616c 203e 2031 3a0d 0a20 2020 2020  mval > 1:..     
+00084ff0: 2020 2020 2020 2070 7269 6e74 2827 2573         print('%s
+00085000: 206f 6620 7479 7065 3d25 7320 6973 2063   of type=%s is c
+00085010: 6c61 7373 6966 6965 6420 696e 746f 206d  lassified into m
+00085020: 6f72 6520 7468 656e 206f 6e65 2074 7970  ore then one typ
+00085030: 6527 2025 2863 6f6c 2c74 7261 696e 5b63  e' %(col,train[c
+00085040: 6f6c 5d2e 6474 7970 6529 290d 0a20 2020  ol].dtype))..   
+00085050: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00085060: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
+00085070: 2020 2323 2323 2320 4966 2074 6865 7265    ##### If there
+00085080: 2061 7265 206d 6f72 6520 7468 616e 2031   are more than 1
+00085090: 3030 3020 756e 6971 7565 2076 616c 7565  000 unique value
+000850a0: 732c 2074 6865 6e20 6164 6420 6974 2074  s, then add it t
+000850b0: 6f20 4e4c 5020 7661 7273 2023 2323 0d0a  o NLP vars ###..
+000850c0: 2020 2020 636f 7079 5f64 6973 6372 6574      copy_discret
+000850d0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
+000850e0: 7079 2864 6973 6372 6574 655f 7374 7269  py(discrete_stri
+000850f0: 6e67 5f76 6172 7329 0d0a 2020 2020 666f  ng_vars)..    fo
+00085100: 7220 6561 6368 5f64 6973 6372 6574 6520  r each_discrete 
+00085110: 696e 2063 6f70 795f 6469 7363 7265 7465  in copy_discrete
+00085120: 733a 0d0a 2020 2020 2020 2020 6966 2074  s:..        if t
+00085130: 7261 696e 5b65 6163 685f 6469 7363 7265  rain[each_discre
+00085140: 7465 5d2e 6e75 6e69 7175 6528 2920 3e3d  te].nunique() >=
+00085150: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
+00085160: 2020 2020 6e6c 705f 7661 7273 2e61 7070      nlp_vars.app
+00085170: 656e 6428 6561 6368 5f64 6973 6372 6574  end(each_discret
+00085180: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00085190: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+000851a0: 7661 7273 2e72 656d 6f76 6528 6561 6368  vars.remove(each
+000851b0: 5f64 6973 6372 6574 6529 0d0a 2020 2020  _discrete)..    
+000851c0: 2020 2020 656c 6966 2074 7261 696e 5b65      elif train[e
+000851d0: 6163 685f 6469 7363 7265 7465 5d2e 6e75  ach_discrete].nu
+000851e0: 6e69 7175 6528 2920 3e20 3130 3020 616e  nique() > 100 an
+000851f0: 6420 7472 6169 6e5b 6561 6368 5f64 6973  d train[each_dis
+00085200: 6372 6574 655d 2e6e 756e 6971 7565 2829  crete].nunique()
+00085210: 203c 2031 3030 303a 0d0a 2020 2020 2020   < 1000:..      
+00085220: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00085230: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00085240: 2020 2020 2020 2023 2323 2049 6620 6974         ### If it
+00085250: 2069 7320 6c65 7373 2074 6861 6e20 3130   is less than 10
+00085260: 3020 756e 6971 7565 2076 616c 7565 732c  0 unique values,
+00085270: 2074 6865 6e20 6d61 6b65 2069 7420 6361   then make it ca
+00085280: 7465 676f 7269 6361 6c20 7661 720d 0a20  tegorical var.. 
+00085290: 2020 2020 2020 2020 2020 2063 6174 5f76             cat_v
+000852a0: 6172 732e 6170 7065 6e64 2865 6163 685f  ars.append(each_
+000852b0: 6469 7363 7265 7465 290d 0a20 2020 2020  discrete)..     
+000852c0: 2020 2020 2020 2064 6973 6372 6574 655f         discrete_
+000852d0: 7374 7269 6e67 5f76 6172 732e 7265 6d6f  string_vars.remo
+000852e0: 7665 2865 6163 685f 6469 7363 7265 7465  ve(each_discrete
+000852f0: 290d 0a20 2020 2073 756d 5f61 6c6c 5f63  )..    sum_all_c
+00085300: 6f6c 735b 2764 6973 6372 6574 655f 7374  ols['discrete_st
+00085310: 7269 6e67 5f76 6172 7327 5d20 3d20 2064  ring_vars'] =  d
+00085320: 6973 6372 6574 655f 7374 7269 6e67 5f76  iscrete_string_v
+00085330: 6172 730d 0a20 2020 2073 756d 5f61 6c6c  ars..    sum_all
+00085340: 5f63 6f6c 735b 2763 6174 5f76 6172 7327  _cols['cat_vars'
+00085350: 5d20 3d20 6361 745f 7661 7273 0d0a 2020  ] = cat_vars..  
+00085360: 2020 7375 6d5f 616c 6c5f 636f 6c73 5b27    sum_all_cols['
+00085370: 6e6c 705f 7661 7273 275d 203d 206e 6c70  nlp_vars'] = nlp
+00085380: 5f76 6172 730d 0a20 2020 2023 2323 2323  _vars..    #####
+00085390: 2323 2323 2323 2323 2323 2020 5468 6973  ##########  This
+000853a0: 2069 7320 7768 6572 6520 796f 7520 7072   is where you pr
+000853b0: 696e 7420 616c 6c20 7468 6520 7479 7065  int all the type
+000853c0: 7320 6f66 2076 6172 6961 626c 6573 2023  s of variables #
+000853d0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+000853e0: 2020 2023 2323 2323 2323 2052 6574 7572     ####### Retur
+000853f0: 6e73 2038 2076 6172 7320 696e 2074 6865  ns 8 vars in the
+00085400: 2066 6f6c 6c6f 7769 6e67 206f 7264 6572   following order
+00085410: 3a20 636f 6e74 696e 756f 7573 5f76 6172  : continuous_var
+00085420: 732c 696e 745f 7661 7273 2c63 6174 5f76  s,int_vars,cat_v
+00085430: 6172 732c 0d0a 2020 2020 2323 2320 2073  ars,..    ###  s
+00085440: 7472 696e 675f 626f 6f6c 5f76 6172 732c  tring_bool_vars,
+00085450: 6469 7363 7265 7465 5f73 7472 696e 675f  discrete_string_
+00085460: 7661 7273 2c6e 6c70 5f76 6172 732c 6461  vars,nlp_vars,da
+00085470: 7465 5f6f 725f 6964 5f76 6172 732c 636f  te_or_id_vars,co
+00085480: 6c73 5f64 656c 6574 650d 0a20 2020 2069  ls_delete..    i
+00085490: 6620 7665 7262 6f73 6520 3d3d 2031 3a0d  f verbose == 1:.
+000854a0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000854b0: 2020 2020 4e75 6d62 6572 206f 6620 4e75      Number of Nu
+000854c0: 6d65 7269 6320 436f 6c75 6d6e 7320 3d20  meric Columns = 
+000854d0: 222c 206c 656e 2863 6f6e 7469 6e75 6f75  ", len(continuou
+000854e0: 735f 7661 7273 2929 0d0a 2020 2020 2020  s_vars))..      
+000854f0: 2020 7072 696e 7428 2220 2020 204e 756d    print("    Num
+00085500: 6265 7220 6f66 2049 6e74 6567 6572 2d43  ber of Integer-C
+00085510: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
+00085520: 6e73 203d 2022 2c20 6c65 6e28 696e 745f  ns = ", len(int_
+00085530: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
+00085540: 7072 696e 7428 2220 2020 204e 756d 6265  print("    Numbe
+00085550: 7220 6f66 2053 7472 696e 672d 4361 7465  r of String-Cate
+00085560: 676f 7269 6361 6c20 436f 6c75 6d6e 7320  gorical Columns 
+00085570: 3d20 222c 206c 656e 2863 6174 5f76 6172  = ", len(cat_var
+00085580: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00085590: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+000855a0: 6620 4661 6374 6f72 2d43 6174 6567 6f72  f Factor-Categor
+000855b0: 6963 616c 2043 6f6c 756d 6e73 203d 2022  ical Columns = "
+000855c0: 2c20 6c65 6e28 6661 6374 6f72 5f76 6172  , len(factor_var
+000855d0: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+000855e0: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+000855f0: 6620 5374 7269 6e67 2d42 6f6f 6c65 616e  f String-Boolean
+00085600: 2043 6f6c 756d 6e73 203d 2022 2c20 6c65   Columns = ", le
+00085610: 6e28 7374 7269 6e67 5f62 6f6f 6c5f 7661  n(string_bool_va
+00085620: 7273 2929 0d0a 2020 2020 2020 2020 7072  rs))..        pr
+00085630: 696e 7428 2220 2020 204e 756d 6265 7220  int("    Number 
+00085640: 6f66 204e 756d 6572 6963 2d42 6f6f 6c65  of Numeric-Boole
+00085650: 616e 2043 6f6c 756d 6e73 203d 2022 2c20  an Columns = ", 
+00085660: 6c65 6e28 6e75 6d5f 626f 6f6c 5f76 6172  len(num_bool_var
+00085670: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00085680: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00085690: 6620 4469 7363 7265 7465 2053 7472 696e  f Discrete Strin
+000856a0: 6720 436f 6c75 6d6e 7320 3d20 222c 206c  g Columns = ", l
+000856b0: 656e 2864 6973 6372 6574 655f 7374 7269  en(discrete_stri
+000856c0: 6e67 5f76 6172 7329 290d 0a20 2020 2020  ng_vars))..     
+000856d0: 2020 2070 7269 6e74 2822 2020 2020 4e75     print("    Nu
+000856e0: 6d62 6572 206f 6620 4e4c 5020 5374 7269  mber of NLP Stri
+000856f0: 6e67 2043 6f6c 756d 6e73 203d 2022 2c20  ng Columns = ", 
+00085700: 6c65 6e28 6e6c 705f 7661 7273 2929 0d0a  len(nlp_vars))..
+00085710: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
+00085720: 2020 204e 756d 6265 7220 6f66 2044 6174     Number of Dat
+00085730: 6520 5469 6d65 2043 6f6c 756d 6e73 203d  e Time Columns =
+00085740: 2022 2c20 6c65 6e28 6461 7465 5f76 6172   ", len(date_var
+00085750: 7329 290d 0a20 2020 2020 2020 2070 7269  s))..        pri
+00085760: 6e74 2822 2020 2020 4e75 6d62 6572 206f  nt("    Number o
+00085770: 6620 4944 2043 6f6c 756d 6e73 203d 2022  f ID Columns = "
+00085780: 2c20 6c65 6e28 6964 5f76 6172 7329 290d  , len(id_vars)).
+00085790: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000857a0: 2020 2020 4e75 6d62 6572 206f 6620 436f      Number of Co
+000857b0: 6c75 6d6e 7320 746f 2044 656c 6574 6520  lumns to Delete 
+000857c0: 3d20 222c 206c 656e 2863 6f6c 735f 6465  = ", len(cols_de
+000857d0: 6c65 7465 2929 0d0a 2020 2020 6966 2076  lete))..    if v
+000857e0: 6572 626f 7365 203d 3d20 323a 0d0a 2020  erbose == 2:..  
+000857f0: 2020 2020 2020 7072 696e 7428 2720 2050        print('  P
+00085800: 7269 6e74 696e 6720 7570 746f 2025 6420  rinting upto %d 
+00085810: 636f 6c75 6d6e 7320 6d61 7820 696e 2065  columns max in e
+00085820: 6163 6820 6361 7465 676f 7279 3a27 2025  ach category:' %
+00085830: 6d61 785f 636f 6c73 5f74 6f5f 7072 696e  max_cols_to_prin
+00085840: 7429 0d0a 2020 2020 2020 2020 7072 696e  t)..        prin
+00085850: 7428 2220 2020 204e 756d 6572 6963 2043  t("    Numeric C
+00085860: 6f6c 756d 6e73 203a 2025 7322 2025 636f  olumns : %s" %co
+00085870: 6e74 696e 756f 7573 5f76 6172 735b 3a6d  ntinuous_vars[:m
+00085880: 6178 5f63 6f6c 735f 746f 5f70 7269 6e74  ax_cols_to_print
+00085890: 5d29 0d0a 2020 2020 2020 2020 7072 696e  ])..        prin
+000858a0: 7428 2220 2020 2049 6e74 6567 6572 2d43  t("    Integer-C
+000858b0: 6174 6567 6f72 6963 616c 2043 6f6c 756d  ategorical Colum
+000858c0: 6e73 3a20 2573 2220 2569 6e74 5f76 6172  ns: %s" %int_var
+000858d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
+000858e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
+000858f0: 7072 696e 7428 2220 2020 2053 7472 696e  print("    Strin
+00085900: 672d 4361 7465 676f 7269 6361 6c20 436f  g-Categorical Co
+00085910: 6c75 6d6e 733a 2025 7322 2025 6361 745f  lumns: %s" %cat_
+00085920: 7661 7273 5b3a 6d61 785f 636f 6c73 5f74  vars[:max_cols_t
+00085930: 6f5f 7072 696e 745d 290d 0a20 2020 2020  o_print])..     
+00085940: 2020 2070 7269 6e74 2822 2020 2020 4661     print("    Fa
+00085950: 6374 6f72 2d43 6174 6567 6f72 6963 616c  ctor-Categorical
+00085960: 2043 6f6c 756d 6e73 3a20 2573 2220 2566   Columns: %s" %f
+00085970: 6163 746f 725f 7661 7273 5b3a 6d61 785f  actor_vars[:max_
+00085980: 636f 6c73 5f74 6f5f 7072 696e 745d 290d  cols_to_print]).
+00085990: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000859a0: 2020 2020 5374 7269 6e67 2d42 6f6f 6c65      String-Boole
+000859b0: 616e 2043 6f6c 756d 6e73 3a20 2573 2220  an Columns: %s" 
+000859c0: 2573 7472 696e 675f 626f 6f6c 5f76 6172  %string_bool_var
+000859d0: 735b 3a6d 6178 5f63 6f6c 735f 746f 5f70  s[:max_cols_to_p
+000859e0: 7269 6e74 5d29 0d0a 2020 2020 2020 2020  rint])..        
+000859f0: 7072 696e 7428 2220 2020 204e 756d 6572  print("    Numer
+00085a00: 6963 2d42 6f6f 6c65 616e 2043 6f6c 756d  ic-Boolean Colum
+00085a10: 6e73 3a20 2573 2220 256e 756d 5f62 6f6f  ns: %s" %num_boo
+00085a20: 6c5f 7661 7273 5b3a 6d61 785f 636f 6c73  l_vars[:max_cols
+00085a30: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
+00085a40: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
+00085a50: 4469 7363 7265 7465 2053 7472 696e 6720  Discrete String 
+00085a60: 436f 6c75 6d6e 733a 2025 7322 2025 6469  Columns: %s" %di
+00085a70: 7363 7265 7465 5f73 7472 696e 675f 7661  screte_string_va
+00085a80: 7273 5b3a 6d61 785f 636f 6c73 5f74 6f5f  rs[:max_cols_to_
+00085a90: 7072 696e 745d 290d 0a20 2020 2020 2020  print])..       
+00085aa0: 2070 7269 6e74 2822 2020 2020 4e4c 5020   print("    NLP 
+00085ab0: 7465 7874 2043 6f6c 756d 6e73 3a20 2573  text Columns: %s
+00085ac0: 2220 256e 6c70 5f76 6172 735b 3a6d 6178  " %nlp_vars[:max
+00085ad0: 5f63 6f6c 735f 746f 5f70 7269 6e74 5d29  _cols_to_print])
+00085ae0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00085af0: 2220 2020 2044 6174 6520 5469 6d65 2043  "    Date Time C
+00085b00: 6f6c 756d 6e73 3a20 2573 2220 2564 6174  olumns: %s" %dat
+00085b10: 655f 7661 7273 5b3a 6d61 785f 636f 6c73  e_vars[:max_cols
+00085b20: 5f74 6f5f 7072 696e 745d 290d 0a20 2020  _to_print])..   
+00085b30: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
+00085b40: 4944 2043 6f6c 756d 6e73 3a20 2573 2220  ID Columns: %s" 
+00085b50: 2569 645f 7661 7273 5b3a 6d61 785f 636f  %id_vars[:max_co
+00085b60: 6c73 5f74 6f5f 7072 696e 745d 290d 0a20  ls_to_print]).. 
+00085b70: 2020 2020 2020 2070 7269 6e74 2822 2020         print("  
+00085b80: 2020 436f 6c75 6d6e 7320 7468 6174 2077    Columns that w
+00085b90: 696c 6c20 6e6f 7420 6265 2063 6f6e 7369  ill not be consi
+00085ba0: 6465 7265 6420 696e 206d 6f64 656c 696e  dered in modelin
+00085bb0: 673a 2025 7322 2025 636f 6c73 5f64 656c  g: %s" %cols_del
+00085bc0: 6574 655b 3a6d 6178 5f63 6f6c 735f 746f  ete[:max_cols_to
+00085bd0: 5f70 7269 6e74 5d29 0d0a 2020 2020 2323  _print])..    ##
+00085be0: 2323 2320 6e6f 7720 636f 6c6c 6563 7420  ### now collect 
+00085bf0: 616c 6c20 7468 6520 636f 6c75 6d6e 2074  all the column t
+00085c00: 7970 6573 2061 6e64 2063 6f6c 756d 6e20  ypes and column 
+00085c10: 6e61 6d65 7320 696e 746f 2061 2073 696e  names into a sin
+00085c20: 676c 6520 6469 6374 696f 6e61 7279 2074  gle dictionary t
+00085c30: 6f20 7265 7475 726e 210d 0a20 2020 200d  o return!..    .
+00085c40: 0a20 2020 206c 656e 5f73 756d 5f61 6c6c  .    len_sum_all
+00085c50: 5f63 6f6c 7320 3d20 7265 6475 6365 2861  _cols = reduce(a
+00085c60: 6464 2c5b 6c65 6e28 7629 2066 6f72 2076  dd,[len(v) for v
+00085c70: 2069 6e20 7375 6d5f 616c 6c5f 636f 6c73   in sum_all_cols
+00085c80: 2e76 616c 7565 7328 295d 290d 0a20 2020  .values()])..   
+00085c90: 2069 6620 6c65 6e5f 7375 6d5f 616c 6c5f   if len_sum_all_
+00085ca0: 636f 6c73 203d 3d20 6f72 6967 5f63 6f6c  cols == orig_col
+00085cb0: 735f 746f 7461 6c3a 0d0a 2020 2020 2020  s_total:..      
+00085cc0: 2020 7072 696e 7428 2720 2020 2025 6420    print('    %d 
+00085cd0: 5072 6564 6963 746f 7273 2063 6c61 7373  Predictors class
+00085ce0: 6966 6965 642e 2e2e 2720 256f 7269 675f  ified...' %orig_
+00085cf0: 636f 6c73 5f74 6f74 616c 290d 0a20 2020  cols_total)..   
+00085d00: 2020 2020 2023 7072 696e 7428 2720 2020       #print('   
+00085d10: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
+00085d20: 6f74 2069 6e63 6c75 6465 2074 6865 2054  ot include the T
+00085d30: 6172 6765 7420 636f 6c75 6d6e 2873 2927  arget column(s)'
+00085d40: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00085d50: 2020 2020 2020 7072 696e 7428 274e 6f20        print('No 
+00085d60: 6f66 2063 6f6c 756d 6e73 2063 6c61 7373  of columns class
+00085d70: 6966 6965 6420 2564 2064 6f65 7320 6e6f  ified %d does no
+00085d80: 7420 6d61 7463 6820 2564 2074 6f74 616c  t match %d total
+00085d90: 2063 6f6c 732e 2043 6f6e 7469 6e75 696e   cols. Continuin
+00085da0: 672e 2e2e 2720 2528 0d0a 2020 2020 2020  g...' %(..      
+00085db0: 2020 2020 2020 2020 2020 2020 206c 656e               len
+00085dc0: 5f73 756d 5f61 6c6c 5f63 6f6c 732c 206f  _sum_all_cols, o
+00085dd0: 7269 675f 636f 6c73 5f74 6f74 616c 2929  rig_cols_total))
+00085de0: 0d0a 2020 2020 2020 2020 6c73 203d 2073  ..        ls = s
+00085df0: 756d 5f61 6c6c 5f63 6f6c 732e 7661 6c75  um_all_cols.valu
+00085e00: 6573 2829 0d0a 2020 2020 2020 2020 666c  es()..        fl
+00085e10: 6174 5f6c 6973 7420 3d20 5b69 7465 6d20  at_list = [item 
+00085e20: 666f 7220 7375 626c 6973 7420 696e 206c  for sublist in l
+00085e30: 7320 666f 7220 6974 656d 2069 6e20 7375  s for item in su
+00085e40: 626c 6973 745d 0d0a 2020 2020 2020 2020  blist]..        
+00085e50: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
+00085e60: 7261 6374 286c 6973 7428 7472 6169 6e29  ract(list(train)
+00085e70: 2c66 6c61 745f 6c69 7374 2929 203d 3d20  ,flat_list)) == 
+00085e80: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00085e90: 7072 696e 7428 2720 4d69 7373 696e 6720  print(' Missing 
+00085ea0: 636f 6c75 6d6e 7320 3d20 4e6f 6e65 2729  columns = None')
+00085eb0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00085ec0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00085ed0: 6e74 2827 204d 6973 7369 6e67 2063 6f6c  nt(' Missing col
+00085ee0: 756d 6e73 203d 2025 7327 2025 6c65 6674  umns = %s' %left
+00085ef0: 5f73 7562 7472 6163 7428 6c69 7374 2874  _subtract(list(t
+00085f00: 7261 696e 292c 666c 6174 5f6c 6973 7429  rain),flat_list)
+00085f10: 290d 0a20 2020 2072 6574 7572 6e20 7375  )..    return su
+00085f20: 6d5f 616c 6c5f 636f 6c73 0d0a 2323 2323  m_all_cols..####
+00085f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085f60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00085f80: 0d0a 0000 0000 0000 0000 0000 0000 0000  ................
 00085f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00086000: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00086010: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
-00086020: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
-00086030: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
-00086040: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00086050: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
-00086060: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
-00086070: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
-00086080: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
-00086090: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
-000860a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
-000860b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
-000860c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
-000860d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
-000860e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
-000860f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00086100: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
-00086110: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
-00086120: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
-00086130: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00086140: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
-00086150: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00086160: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
-00086170: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
-00086180: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
-00086190: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-000861a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
-000861b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
-000861c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
-000861d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
-000861e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
-000861f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-00086200: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
-00086210: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
-00086220: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00086230: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00086240: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
-00086250: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-00086260: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
-00086270: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00086280: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
-00086290: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-000862a0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
-000862b0: 6375 7261 6379 5f73 636f 7265 0d0a 6672  curacy_score..fr
-000862c0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
-000862d0: 6373 2069 6d70 6f72 7420 6176 6572 6167  cs import averag
-000862e0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-000862f0: 650d 0a66 726f 6d20 736b 6c65 6172 6e2e  e..from sklearn.
-00086300: 6d65 7472 6963 7320 696d 706f 7274 2066  metrics import f
-00086310: 315f 7363 6f72 650d 0a66 726f 6d20 736b  1_score..from sk
-00086320: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00086330: 706f 7274 206c 6f67 5f6c 6f73 730d 0a66  port log_loss..f
-00086340: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00086350: 6963 7320 696d 706f 7274 2070 7265 6369  ics import preci
-00086360: 7369 6f6e 5f73 636f 7265 0d0a 6672 6f6d  sion_score..from
-00086370: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-00086380: 2069 6d70 6f72 7420 7265 6361 6c6c 5f73   import recall_s
-00086390: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
-000863a0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-000863b0: 7420 726f 635f 6175 635f 7363 6f72 650d  t roc_auc_score.
-000863c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-000863d0: 7472 6963 7320 696d 706f 7274 2066 6265  trics import fbe
-000863e0: 7461 5f73 636f 7265 0d0a 2323 2323 2323  ta_score..######
-000863f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086430: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00086440: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-00086450: 7472 6963 7320 696d 706f 7274 2063 6f6e  trics import con
-00086460: 6675 7369 6f6e 5f6d 6174 7269 780d 0a64  fusion_matrix..d
-00086470: 6566 2062 616c 616e 6365 645f 6163 6375  ef balanced_accu
-00086480: 7261 6379 5f73 636f 7265 2879 5f74 7275  racy_score(y_tru
-00086490: 652c 2079 5f70 7265 642c 2073 616d 706c  e, y_pred, sampl
-000864a0: 655f 7765 6967 6874 3d4e 6f6e 652c 0d0a  e_weight=None,..
-000864b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000864c0: 2020 2020 2020 2020 2020 2020 6164 6a75              adju
-000864d0: 7374 6564 3d46 616c 7365 293a 0d0a 2020  sted=False):..  
-000864e0: 2020 4320 3d20 636f 6e66 7573 696f 6e5f    C = confusion_
-000864f0: 6d61 7472 6978 2879 5f74 7275 652c 2079  matrix(y_true, y
-00086500: 5f70 7265 642c 2073 616d 706c 655f 7765  _pred, sample_we
-00086510: 6967 6874 3d73 616d 706c 655f 7765 6967  ight=sample_weig
-00086520: 6874 290d 0a20 2020 2077 6974 6820 6e70  ht)..    with np
-00086530: 2e65 7272 7374 6174 6528 6469 7669 6465  .errstate(divide
-00086540: 3d27 6967 6e6f 7265 272c 2069 6e76 616c  ='ignore', inval
-00086550: 6964 3d27 6967 6e6f 7265 2729 3a0d 0a20  id='ignore'):.. 
-00086560: 2020 2020 2020 2070 6572 5f63 6c61 7373         per_class
-00086570: 203d 206e 702e 6469 6167 2843 2920 2f20   = np.diag(C) / 
-00086580: 432e 7375 6d28 6178 6973 3d31 290d 0a20  C.sum(axis=1).. 
-00086590: 2020 2069 6620 6e70 2e61 6e79 286e 702e     if np.any(np.
-000865a0: 6973 6e61 6e28 7065 725f 636c 6173 7329  isnan(per_class)
-000865b0: 293a 0d0a 2020 2020 2020 2020 7761 726e  ):..        warn
-000865c0: 696e 6773 2e77 6172 6e28 2779 5f70 7265  ings.warn('y_pre
-000865d0: 6420 636f 6e74 6169 6e73 2063 6c61 7373  d contains class
-000865e0: 6573 206e 6f74 2069 6e20 795f 7472 7565  es not in y_true
-000865f0: 2729 0d0a 2020 2020 2020 2020 7065 725f  ')..        per_
-00086600: 636c 6173 7320 3d20 7065 725f 636c 6173  class = per_clas
-00086610: 735b 7e6e 702e 6973 6e61 6e28 7065 725f  s[~np.isnan(per_
-00086620: 636c 6173 7329 5d0d 0a20 2020 2073 636f  class)]..    sco
-00086630: 7265 203d 206e 702e 6d65 616e 2870 6572  re = np.mean(per
-00086640: 5f63 6c61 7373 290d 0a20 2020 2069 6620  _class)..    if 
-00086650: 6164 6a75 7374 6564 3a0d 0a20 2020 2020  adjusted:..     
-00086660: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
-00086670: 656e 2870 6572 5f63 6c61 7373 290d 0a20  en(per_class).. 
-00086680: 2020 2020 2020 2063 6861 6e63 6520 3d20         chance = 
-00086690: 3120 2f20 6e5f 636c 6173 7365 730d 0a20  1 / n_classes.. 
-000866a0: 2020 2020 2020 2073 636f 7265 202d 3d20         score -= 
-000866b0: 6368 616e 6365 0d0a 2020 2020 2020 2020  chance..        
-000866c0: 7363 6f72 6520 2f3d 2031 202d 2063 6861  score /= 1 - cha
-000866d0: 6e63 650d 0a20 2020 2072 6574 7572 6e20  nce..    return 
-000866e0: 7363 6f72 650d 0a23 2323 2323 2323 2323  score..#########
-000866f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00086730: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
-00086740: 6620 6163 6375 2872 6573 756c 7473 2c20  f accu(results, 
-00086750: 795f 6376 293a 0d0a 2020 2020 7265 7475  y_cv):..    retu
-00086760: 726e 2028 7265 7375 6c74 733d 3d79 5f63  rn (results==y_c
-00086770: 7629 2e61 7374 7970 6528 696e 7429 2e73  v).astype(int).s
-00086780: 756d 2861 7869 733d 3029 2f28 795f 6376  um(axis=0)/(y_cv
-00086790: 2e73 6861 7065 5b30 5d29 0d0a 6465 6620  .shape[0])..def 
-000867a0: 726d 7365 2872 6573 756c 7473 2c20 795f  rmse(results, y_
-000867b0: 6376 293a 0d0a 2020 2020 7265 7475 726e  cv):..    return
-000867c0: 206e 702e 7371 7274 286e 702e 6d65 616e   np.sqrt(np.mean
-000867d0: 2828 7265 7375 6c74 7320 2d20 795f 6376  ((results - y_cv
-000867e0: 292a 2a32 2c20 6178 6973 3d30 2929 0d0a  )**2, axis=0))..
-000867f0: 2323 2323 2323 2323 2044 6566 696e 696e  ######## Definin
-00086800: 6720 6f62 6a65 6374 6976 6520 6675 6e63  g objective func
-00086810: 7469 6f6e 7320 666f 7220 4879 7065 724f  tions for HyperO
-00086820: 7074 2068 6572 6520 2323 2323 2323 2323  pt here ########
-00086830: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00086840: 6465 6620 6769 6e69 2874 7275 7468 2c20  def gini(truth, 
-00086850: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-00086860: 2020 2067 203d 206e 702e 6173 6172 7261     g = np.asarra
-00086870: 7928 6e70 2e63 5f5b 7472 7574 682c 2070  y(np.c_[truth, p
-00086880: 7265 6469 6374 696f 6e73 2c20 6e70 2e61  redictions, np.a
-00086890: 7261 6e67 6528 6c65 6e28 7472 7574 6829  range(len(truth)
-000868a0: 2920 5d2c 2064 7479 7065 3d6e 702e 666c  ) ], dtype=np.fl
-000868b0: 6f61 7429 0d0a 2020 2020 6720 3d20 675b  oat)..    g = g[
-000868c0: 6e70 2e6c 6578 736f 7274 2828 675b 3a2c  np.lexsort((g[:,
-000868d0: 325d 2c20 2d31 2a67 5b3a 2c31 5d29 295d  2], -1*g[:,1]))]
-000868e0: 0d0a 2020 2020 6773 203d 2067 5b3a 2c30  ..    gs = g[:,0
-000868f0: 5d2e 6375 6d73 756d 2829 2e73 756d 2829  ].cumsum().sum()
-00086900: 202f 2067 5b3a 2c30 5d2e 7375 6d28 290d   / g[:,0].sum().
-00086910: 0a20 2020 2067 7320 2d3d 2028 6c65 6e28  .    gs -= (len(
-00086920: 7472 7574 6829 202b 2031 2920 2f20 322e  truth) + 1) / 2.
-00086930: 0d0a 2020 2020 7265 7475 726e 2067 7320  ..    return gs 
-00086940: 2f20 6c65 6e28 7472 7574 6829 0d0a 0d0a  / len(truth)....
-00086950: 6465 6620 6769 6e69 5f73 6b6c 6561 726e  def gini_sklearn
-00086960: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086970: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-00086980: 6e20 6769 6e69 2874 7275 7468 2c20 7072  n gini(truth, pr
-00086990: 6564 6963 7469 6f6e 7329 202f 2067 696e  edictions) / gin
-000869a0: 6928 7472 7574 682c 2074 7275 7468 290d  i(truth, truth).
-000869b0: 0a0d 0a64 6566 2067 696e 695f 6d65 6165  ...def gini_meae
-000869c0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000869d0: 6f6e 7329 3a0d 0a20 2020 2073 636f 7265  ons):..    score
-000869e0: 203d 206d 6564 6961 6e5f 6162 736f 6c75   = median_absolu
-000869f0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
-00086a00: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-00086a10: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-00086a20: 0d0a 6465 6620 6769 6e69 5f6d 736c 6528  ..def gini_msle(
-00086a30: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086a40: 6e73 293a 0d0a 2020 2020 7363 6f72 6520  ns):..    score 
-00086a50: 3d20 6d65 616e 5f73 7175 6172 6564 5f6c  = mean_squared_l
-00086a60: 6f67 5f65 7272 6f72 2874 7275 7468 2c20  og_error(truth, 
-00086a70: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-00086a80: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-00086a90: 0d0a 6465 6620 6769 6e69 5f6d 6165 2874  ..def gini_mae(t
-00086aa0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00086ab0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
-00086ac0: 206d 6561 6e5f 6162 736f 6c75 7465 5f65   mean_absolute_e
-00086ad0: 7272 6f72 2874 7275 7468 2c20 7072 6564  rror(truth, pred
-00086ae0: 6963 7469 6f6e 7329 0d0a 2020 2020 7265  ictions)..    re
-00086af0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
-00086b00: 6620 6769 6e69 5f6d 7365 2874 7275 7468  f gini_mse(truth
-00086b10: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00086b20: 0a20 2020 2073 636f 7265 203d 206d 6561  .    score = mea
-00086b30: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
-00086b40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086b50: 6e73 290d 0a20 2020 2072 6574 7572 6e20  ns)..    return 
-00086b60: 7363 6f72 650d 0a0d 0a64 6566 2067 696e  score....def gin
-00086b70: 695f 726d 7365 2874 7275 7468 2c20 7072  i_rmse(truth, pr
-00086b80: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00086b90: 2073 636f 7265 203d 206e 702e 7371 7274   score = np.sqrt
-00086ba0: 286d 6561 6e5f 7371 7561 7265 645f 6572  (mean_squared_er
-00086bb0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
-00086bc0: 6374 696f 6e73 2929 0d0a 2020 2020 7265  ctions))..    re
-00086bd0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
-00086be0: 6620 6769 6e69 5f61 6363 7572 6163 7928  f gini_accuracy(
-00086bf0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086c00: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086c10: 2061 6363 7572 6163 795f 7363 6f72 6528   accuracy_score(
-00086c20: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086c30: 6e73 290d 0a0d 0a64 6566 2067 696e 695f  ns)....def gini_
-00086c40: 6261 6c5f 6163 6375 7261 6379 2874 7275  bal_accuracy(tru
-00086c50: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00086c60: 3a0d 0a20 2020 2072 6574 7572 6e20 6261  :..    return ba
-00086c70: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
-00086c80: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00086c90: 6469 6374 696f 6e73 290d 0a0d 0a64 6566  dictions)....def
-00086ca0: 2067 696e 695f 726f 6328 7472 7574 682c   gini_roc(truth,
-00086cb0: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
-00086cc0: 2020 2020 7265 7475 726e 2072 6f63 5f61      return roc_a
-00086cd0: 7563 5f73 636f 7265 2874 7275 7468 2c20  uc_score(truth, 
-00086ce0: 7072 6564 6963 7469 6f6e 7329 0d0a 0d0a  predictions)....
-00086cf0: 6465 6620 6769 6e69 5f70 7265 6369 7369  def gini_precisi
-00086d00: 6f6e 2874 7275 7468 2c20 7072 6564 6963  on(truth, predic
-00086d10: 7469 6f6e 732c 706f 735f 6c61 6265 6c3d  tions,pos_label=
-00086d20: 3129 3a0d 0a20 2020 2072 6574 7572 6e20  1):..    return 
-00086d30: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
-00086d40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086d50: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
-00086d60: 5b70 6f73 5f6c 6162 656c 5d0d 0a0d 0a64  [pos_label]....d
-00086d70: 6566 2067 696e 695f 6176 6572 6167 655f  ef gini_average_
-00086d80: 7072 6563 6973 696f 6e28 7472 7574 682c  precision(truth,
-00086d90: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
-00086da0: 2020 2020 7265 7475 726e 2070 7265 6369      return preci
-00086db0: 7369 6f6e 5f73 636f 7265 2874 7275 7468  sion_score(truth
-00086dc0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-00086dd0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-00086de0: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
-00086df0: 0a64 6566 2067 696e 695f 7765 6967 6874  .def gini_weight
-00086e00: 6564 5f70 7265 6369 7369 6f6e 2874 7275  ed_precision(tru
-00086e10: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00086e20: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
-00086e30: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
-00086e40: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
-00086e50: 2e61 7267 6d61 7828 6178 6973 3d31 292c  .argmax(axis=1),
-00086e60: 6176 6572 6167 653d 2777 6569 6768 7465  average='weighte
-00086e70: 6427 290d 0a0d 0a64 6566 2067 696e 695f  d')....def gini_
-00086e80: 6d61 6372 6f5f 7072 6563 6973 696f 6e28  macro_precision(
-00086e90: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086ea0: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086eb0: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
-00086ec0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086ed0: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-00086ee0: 3129 2c61 7665 7261 6765 3d27 6d61 6372  1),average='macr
-00086ef0: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00086f00: 6d69 6372 6f5f 7072 6563 6973 696f 6e28  micro_precision(
-00086f10: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00086f20: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00086f30: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
-00086f40: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00086f50: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-00086f60: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
-00086f70: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00086f80: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
-00086f90: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
-00086fa0: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00086fb0: 726e 2070 7265 6369 7369 6f6e 5f73 636f  rn precision_sco
-00086fc0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
-00086fd0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
-00086fe0: 733d 3129 2c61 7665 7261 6765 3d27 7361  s=1),average='sa
-00086ff0: 6d70 6c65 7327 290d 0a0d 0a64 6566 2067  mples')....def g
-00087000: 696e 695f 6631 2874 7275 7468 2c20 7072  ini_f1(truth, pr
-00087010: 6564 6963 7469 6f6e 732c 706f 735f 6c61  edictions,pos_la
-00087020: 6265 6c3d 3129 3a0d 0a20 2020 2072 6574  bel=1):..    ret
-00087030: 7572 6e20 6631 5f73 636f 7265 2874 7275  urn f1_score(tru
-00087040: 7468 2c20 7072 6564 6963 7469 6f6e 732c  th, predictions,
-00087050: 6176 6572 6167 653d 4e6f 6e65 295b 706f  average=None)[po
-00087060: 735f 6c61 6265 6c5d 0d0a 0d0a 6465 6620  s_label]....def 
-00087070: 6769 6e69 5f77 6569 6768 7465 645f 6631  gini_weighted_f1
-00087080: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00087090: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-000870a0: 6e20 6631 5f73 636f 7265 2874 7275 7468  n f1_score(truth
-000870b0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-000870c0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-000870d0: 7261 6765 3d27 7765 6967 6874 6564 2729  rage='weighted')
-000870e0: 0d0a 0d0a 6465 6620 6769 6e69 5f6d 6163  ....def gini_mac
-000870f0: 726f 5f66 3128 7472 7574 682c 2070 7265  ro_f1(truth, pre
-00087100: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-00087110: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
-00087120: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00087130: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
-00087140: 292c 6176 6572 6167 653d 276d 6163 726f  ),average='macro
-00087150: 2729 0d0a 0d0a 6465 6620 6769 6e69 5f6d  ')....def gini_m
-00087160: 6963 726f 5f66 3128 7472 7574 682c 2070  icro_f1(truth, p
-00087170: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
-00087180: 2020 7265 7475 726e 2066 315f 7363 6f72    return f1_scor
-00087190: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-000871a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-000871b0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
-000871c0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
-000871d0: 5f73 616d 706c 6573 5f66 3128 7472 7574  _samples_f1(trut
-000871e0: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-000871f0: 0d0a 2020 2020 7265 7475 726e 2066 315f  ..    return f1_
-00087200: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00087210: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
-00087220: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
-00087230: 2773 616d 706c 6573 2729 0d0a 0d0a 6465  'samples')....de
-00087240: 6620 6769 6e69 5f6c 6f67 5f6c 6f73 7328  f gini_log_loss(
-00087250: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00087260: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00087270: 206c 6f67 5f6c 6f73 7328 7472 7574 682c   log_loss(truth,
-00087280: 2070 7265 6469 6374 696f 6e73 2c6e 6f72   predictions,nor
-00087290: 6d61 6c69 7a65 3d54 7275 6529 0d0a 0d0a  malize=True)....
-000872a0: 6465 6620 6769 6e69 5f72 6563 616c 6c28  def gini_recall(
-000872b0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-000872c0: 6e73 2c70 6f73 5f6c 6162 656c 3d31 293a  ns,pos_label=1):
-000872d0: 0d0a 2020 2020 7265 7475 726e 2072 6563  ..    return rec
-000872e0: 616c 6c5f 7363 6f72 6528 7472 7574 682c  all_score(truth,
-000872f0: 2070 7265 6469 6374 696f 6e73 2c61 7665   predictions,ave
-00087300: 7261 6765 3d4e 6f6e 6529 5b70 6f73 5f6c  rage=None)[pos_l
-00087310: 6162 656c 5d0d 0a0d 0a64 6566 2067 696e  abel]....def gin
-00087320: 695f 7765 6967 6874 6564 5f72 6563 616c  i_weighted_recal
-00087330: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
-00087340: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00087350: 726e 2072 6563 616c 6c5f 7363 6f72 6528  rn recall_score(
-00087360: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00087370: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
-00087380: 292c 6176 6572 6167 653d 2777 6569 6768  ),average='weigh
-00087390: 7465 6427 290d 0a0d 0a64 6566 2067 696e  ted')....def gin
-000873a0: 695f 7361 6d70 6c65 735f 7265 6361 6c6c  i_samples_recall
-000873b0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000873c0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-000873d0: 6e20 7265 6361 6c6c 5f73 636f 7265 2874  n recall_score(t
-000873e0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-000873f0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
-00087400: 2c61 7665 7261 6765 3d27 7361 6d70 6c65  ,average='sample
-00087410: 7327 290d 0a0d 0a64 6566 2067 696e 695f  s')....def gini_
-00087420: 6d61 6372 6f5f 7265 6361 6c6c 2874 7275  macro_recall(tru
-00087430: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-00087440: 3a0d 0a20 2020 2072 6574 7572 6e20 7265  :..    return re
-00087450: 6361 6c6c 5f73 636f 7265 2874 7275 7468  call_score(truth
-00087460: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
-00087470: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
-00087480: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
-00087490: 0a64 6566 2067 696e 695f 6d69 6372 6f5f  .def gini_micro_
-000874a0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-000874b0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-000874c0: 2072 6574 7572 6e20 7265 6361 6c6c 5f73   return recall_s
-000874d0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-000874e0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
-000874f0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
-00087500: 6d69 6372 6f27 290d 0a0d 0a23 2063 616c  micro')....# cal
-00087510: 6375 6c61 7465 2066 322d 6d65 6173 7572  culate f2-measur
-00087520: 650d 0a64 6566 2066 325f 6d65 6173 7572  e..def f2_measur
-00087530: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
-00087540: 293a 0d0a 2020 2020 7265 7475 726e 2066  ):..    return f
-00087550: 6265 7461 5f73 636f 7265 2879 5f74 7275  beta_score(y_tru
-00087560: 652c 2079 5f70 7265 642c 2062 6574 613d  e, y_pred, beta=
-00087570: 3229 0d0a 0000 0000 0000 0000 0000 0000  2)..............
-00087580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000875f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00087610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00087670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00087680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00087690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000876a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000876b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000876c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000876d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000876e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000876f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00087710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00087750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00087760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000877f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087800: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-00087810: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-00087820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000878f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000879f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00087a10: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
-00087a20: 5f73 636f 7265 735f 484f 2e70 7900 0000  _scores_HO.py...
-00087a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00087a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00087a80: 3030 3230 3630 3500 3030 3030 3030 3030  0020605.00000000
-00087a90: 3030 3000 3032 3036 3130 0020 3000 0000  000.020610. 0...
-00087aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00087b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00087b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00087b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00087b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00086010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00086070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00086080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00086090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000860a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000860b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000860c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000860d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000860e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000860f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00086110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00086150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00086160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000861f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086200: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00086210: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00086220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000862f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000863f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00086410: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
+00086420: 5f73 636f 7265 732e 7079 0000 0000 0000  _scores.py......
+00086430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00086470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00086480: 3030 3132 3536 3400 3030 3030 3030 3030  0012564.00000000
+00086490: 3030 3000 3032 3032 3330 0020 3000 0000  000.020230. 0...
+000864a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000864b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000864c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000864d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000864e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000864f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00086510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00086530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00086550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00086560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000865f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00086600: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00086610: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
+00086620: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
+00086630: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
+00086640: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086650: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
+00086660: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
+00086670: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
+00086680: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
+00086690: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
+000866a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
+000866b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
+000866c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
+000866d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
+000866e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
+000866f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00086700: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
+00086710: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
+00086720: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
+00086730: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00086740: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+00086750: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00086760: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
+00086770: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
+00086780: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
+00086790: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+000867a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
+000867b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
+000867c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
+000867d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
+000867e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
+000867f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
+00086800: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
+00086810: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
+00086820: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00086830: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00086840: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00086850: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+00086860: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
+00086870: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086880: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
+00086890: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+000868a0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
+000868b0: 6375 7261 6379 5f73 636f 7265 0d0a 6672  curacy_score..fr
+000868c0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
+000868d0: 6373 2069 6d70 6f72 7420 6176 6572 6167  cs import averag
+000868e0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
+000868f0: 650d 0a66 726f 6d20 736b 6c65 6172 6e2e  e..from sklearn.
+00086900: 6d65 7472 6963 7320 696d 706f 7274 2066  metrics import f
+00086910: 315f 7363 6f72 650d 0a66 726f 6d20 736b  1_score..from sk
+00086920: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00086930: 706f 7274 206c 6f67 5f6c 6f73 730d 0a66  port log_loss..f
+00086940: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00086950: 6963 7320 696d 706f 7274 2070 7265 6369  ics import preci
+00086960: 7369 6f6e 5f73 636f 7265 0d0a 6672 6f6d  sion_score..from
+00086970: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00086980: 2069 6d70 6f72 7420 7265 6361 6c6c 5f73   import recall_s
+00086990: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
+000869a0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+000869b0: 7420 726f 635f 6175 635f 7363 6f72 650d  t roc_auc_score.
+000869c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+000869d0: 7472 6963 7320 696d 706f 7274 2066 6265  trics import fbe
+000869e0: 7461 5f73 636f 7265 0d0a 2323 2323 2323  ta_score..######
+000869f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086a00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086a30: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00086a40: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+00086a50: 7472 6963 7320 696d 706f 7274 2063 6f6e  trics import con
+00086a60: 6675 7369 6f6e 5f6d 6174 7269 780d 0a64  fusion_matrix..d
+00086a70: 6566 2062 616c 616e 6365 645f 6163 6375  ef balanced_accu
+00086a80: 7261 6379 5f73 636f 7265 2879 5f74 7275  racy_score(y_tru
+00086a90: 652c 2079 5f70 7265 642c 2073 616d 706c  e, y_pred, sampl
+00086aa0: 655f 7765 6967 6874 3d4e 6f6e 652c 0d0a  e_weight=None,..
+00086ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ac0: 2020 2020 2020 2020 2020 2020 6164 6a75              adju
+00086ad0: 7374 6564 3d46 616c 7365 293a 0d0a 2020  sted=False):..  
+00086ae0: 2020 4320 3d20 636f 6e66 7573 696f 6e5f    C = confusion_
+00086af0: 6d61 7472 6978 2879 5f74 7275 652c 2079  matrix(y_true, y
+00086b00: 5f70 7265 642c 2073 616d 706c 655f 7765  _pred, sample_we
+00086b10: 6967 6874 3d73 616d 706c 655f 7765 6967  ight=sample_weig
+00086b20: 6874 290d 0a20 2020 2077 6974 6820 6e70  ht)..    with np
+00086b30: 2e65 7272 7374 6174 6528 6469 7669 6465  .errstate(divide
+00086b40: 3d27 6967 6e6f 7265 272c 2069 6e76 616c  ='ignore', inval
+00086b50: 6964 3d27 6967 6e6f 7265 2729 3a0d 0a20  id='ignore'):.. 
+00086b60: 2020 2020 2020 2070 6572 5f63 6c61 7373         per_class
+00086b70: 203d 206e 702e 6469 6167 2843 2920 2f20   = np.diag(C) / 
+00086b80: 432e 7375 6d28 6178 6973 3d31 290d 0a20  C.sum(axis=1).. 
+00086b90: 2020 2069 6620 6e70 2e61 6e79 286e 702e     if np.any(np.
+00086ba0: 6973 6e61 6e28 7065 725f 636c 6173 7329  isnan(per_class)
+00086bb0: 293a 0d0a 2020 2020 2020 2020 7761 726e  ):..        warn
+00086bc0: 696e 6773 2e77 6172 6e28 2779 5f70 7265  ings.warn('y_pre
+00086bd0: 6420 636f 6e74 6169 6e73 2063 6c61 7373  d contains class
+00086be0: 6573 206e 6f74 2069 6e20 795f 7472 7565  es not in y_true
+00086bf0: 2729 0d0a 2020 2020 2020 2020 7065 725f  ')..        per_
+00086c00: 636c 6173 7320 3d20 7065 725f 636c 6173  class = per_clas
+00086c10: 735b 7e6e 702e 6973 6e61 6e28 7065 725f  s[~np.isnan(per_
+00086c20: 636c 6173 7329 5d0d 0a20 2020 2073 636f  class)]..    sco
+00086c30: 7265 203d 206e 702e 6d65 616e 2870 6572  re = np.mean(per
+00086c40: 5f63 6c61 7373 290d 0a20 2020 2069 6620  _class)..    if 
+00086c50: 6164 6a75 7374 6564 3a0d 0a20 2020 2020  adjusted:..     
+00086c60: 2020 206e 5f63 6c61 7373 6573 203d 206c     n_classes = l
+00086c70: 656e 2870 6572 5f63 6c61 7373 290d 0a20  en(per_class).. 
+00086c80: 2020 2020 2020 2063 6861 6e63 6520 3d20         chance = 
+00086c90: 3120 2f20 6e5f 636c 6173 7365 730d 0a20  1 / n_classes.. 
+00086ca0: 2020 2020 2020 2073 636f 7265 202d 3d20         score -= 
+00086cb0: 6368 616e 6365 0d0a 2020 2020 2020 2020  chance..        
+00086cc0: 7363 6f72 6520 2f3d 2031 202d 2063 6861  score /= 1 - cha
+00086cd0: 6e63 650d 0a20 2020 2072 6574 7572 6e20  nce..    return 
+00086ce0: 7363 6f72 650d 0a23 2323 2323 2323 2323  score..#########
+00086cf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00086d30: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+00086d40: 6620 6163 6375 2872 6573 756c 7473 2c20  f accu(results, 
+00086d50: 795f 6376 293a 0d0a 2020 2020 7265 7475  y_cv):..    retu
+00086d60: 726e 2028 7265 7375 6c74 733d 3d79 5f63  rn (results==y_c
+00086d70: 7629 2e61 7374 7970 6528 696e 7429 2e73  v).astype(int).s
+00086d80: 756d 2861 7869 733d 3029 2f28 795f 6376  um(axis=0)/(y_cv
+00086d90: 2e73 6861 7065 5b30 5d29 0d0a 6465 6620  .shape[0])..def 
+00086da0: 726d 7365 2872 6573 756c 7473 2c20 795f  rmse(results, y_
+00086db0: 6376 293a 0d0a 2020 2020 7265 7475 726e  cv):..    return
+00086dc0: 206e 702e 7371 7274 286e 702e 6d65 616e   np.sqrt(np.mean
+00086dd0: 2828 7265 7375 6c74 7320 2d20 795f 6376  ((results - y_cv
+00086de0: 292a 2a32 2c20 6178 6973 3d30 2929 0d0a  )**2, axis=0))..
+00086df0: 2323 2323 2323 2323 2044 6566 696e 696e  ######## Definin
+00086e00: 6720 6f62 6a65 6374 6976 6520 6675 6e63  g objective func
+00086e10: 7469 6f6e 7320 666f 7220 4879 7065 724f  tions for HyperO
+00086e20: 7074 2068 6572 6520 2323 2323 2323 2323  pt here ########
+00086e30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00086e40: 6465 6620 6769 6e69 2874 7275 7468 2c20  def gini(truth, 
+00086e50: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+00086e60: 2020 2067 203d 206e 702e 6173 6172 7261     g = np.asarra
+00086e70: 7928 6e70 2e63 5f5b 7472 7574 682c 2070  y(np.c_[truth, p
+00086e80: 7265 6469 6374 696f 6e73 2c20 6e70 2e61  redictions, np.a
+00086e90: 7261 6e67 6528 6c65 6e28 7472 7574 6829  range(len(truth)
+00086ea0: 2920 5d2c 2064 7479 7065 3d6e 702e 666c  ) ], dtype=np.fl
+00086eb0: 6f61 7429 0d0a 2020 2020 6720 3d20 675b  oat)..    g = g[
+00086ec0: 6e70 2e6c 6578 736f 7274 2828 675b 3a2c  np.lexsort((g[:,
+00086ed0: 325d 2c20 2d31 2a67 5b3a 2c31 5d29 295d  2], -1*g[:,1]))]
+00086ee0: 0d0a 2020 2020 6773 203d 2067 5b3a 2c30  ..    gs = g[:,0
+00086ef0: 5d2e 6375 6d73 756d 2829 2e73 756d 2829  ].cumsum().sum()
+00086f00: 202f 2067 5b3a 2c30 5d2e 7375 6d28 290d   / g[:,0].sum().
+00086f10: 0a20 2020 2067 7320 2d3d 2028 6c65 6e28  .    gs -= (len(
+00086f20: 7472 7574 6829 202b 2031 2920 2f20 322e  truth) + 1) / 2.
+00086f30: 0d0a 2020 2020 7265 7475 726e 2067 7320  ..    return gs 
+00086f40: 2f20 6c65 6e28 7472 7574 6829 0d0a 0d0a  / len(truth)....
+00086f50: 6465 6620 6769 6e69 5f73 6b6c 6561 726e  def gini_sklearn
+00086f60: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00086f70: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+00086f80: 6e20 6769 6e69 2874 7275 7468 2c20 7072  n gini(truth, pr
+00086f90: 6564 6963 7469 6f6e 7329 202f 2067 696e  edictions) / gin
+00086fa0: 6928 7472 7574 682c 2074 7275 7468 290d  i(truth, truth).
+00086fb0: 0a0d 0a64 6566 2067 696e 695f 6d65 6165  ...def gini_meae
+00086fc0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00086fd0: 6f6e 7329 3a0d 0a20 2020 2073 636f 7265  ons):..    score
+00086fe0: 203d 206d 6564 6961 6e5f 6162 736f 6c75   = median_absolu
+00086ff0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
+00087000: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+00087010: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+00087020: 0d0a 6465 6620 6769 6e69 5f6d 736c 6528  ..def gini_msle(
+00087030: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087040: 6e73 293a 0d0a 2020 2020 7363 6f72 6520  ns):..    score 
+00087050: 3d20 6d65 616e 5f73 7175 6172 6564 5f6c  = mean_squared_l
+00087060: 6f67 5f65 7272 6f72 2874 7275 7468 2c20  og_error(truth, 
+00087070: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+00087080: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+00087090: 0d0a 6465 6620 6769 6e69 5f6d 6165 2874  ..def gini_mae(t
+000870a0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+000870b0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
+000870c0: 206d 6561 6e5f 6162 736f 6c75 7465 5f65   mean_absolute_e
+000870d0: 7272 6f72 2874 7275 7468 2c20 7072 6564  rror(truth, pred
+000870e0: 6963 7469 6f6e 7329 0d0a 2020 2020 7265  ictions)..    re
+000870f0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
+00087100: 6620 6769 6e69 5f6d 7365 2874 7275 7468  f gini_mse(truth
+00087110: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00087120: 0a20 2020 2073 636f 7265 203d 206d 6561  .    score = mea
+00087130: 6e5f 7371 7561 7265 645f 6572 726f 7228  n_squared_error(
+00087140: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087150: 6e73 290d 0a20 2020 2072 6574 7572 6e20  ns)..    return 
+00087160: 7363 6f72 650d 0a0d 0a64 6566 2067 696e  score....def gin
+00087170: 695f 726d 7365 2874 7275 7468 2c20 7072  i_rmse(truth, pr
+00087180: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00087190: 2073 636f 7265 203d 206e 702e 7371 7274   score = np.sqrt
+000871a0: 286d 6561 6e5f 7371 7561 7265 645f 6572  (mean_squared_er
+000871b0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
+000871c0: 6374 696f 6e73 2929 0d0a 2020 2020 7265  ctions))..    re
+000871d0: 7475 726e 2073 636f 7265 0d0a 0d0a 6465  turn score....de
+000871e0: 6620 6769 6e69 5f61 6363 7572 6163 7928  f gini_accuracy(
+000871f0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087200: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00087210: 2061 6363 7572 6163 795f 7363 6f72 6528   accuracy_score(
+00087220: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087230: 6e73 290d 0a0d 0a64 6566 2067 696e 695f  ns)....def gini_
+00087240: 6261 6c5f 6163 6375 7261 6379 2874 7275  bal_accuracy(tru
+00087250: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00087260: 3a0d 0a20 2020 2072 6574 7572 6e20 6261  :..    return ba
+00087270: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+00087280: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00087290: 6469 6374 696f 6e73 290d 0a0d 0a64 6566  dictions)....def
+000872a0: 2067 696e 695f 726f 6328 7472 7574 682c   gini_roc(truth,
+000872b0: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
+000872c0: 2020 2020 7265 7475 726e 2072 6f63 5f61      return roc_a
+000872d0: 7563 5f73 636f 7265 2874 7275 7468 2c20  uc_score(truth, 
+000872e0: 7072 6564 6963 7469 6f6e 7329 0d0a 0d0a  predictions)....
+000872f0: 6465 6620 6769 6e69 5f70 7265 6369 7369  def gini_precisi
+00087300: 6f6e 2874 7275 7468 2c20 7072 6564 6963  on(truth, predic
+00087310: 7469 6f6e 732c 706f 735f 6c61 6265 6c3d  tions,pos_label=
+00087320: 3129 3a0d 0a20 2020 2072 6574 7572 6e20  1):..    return 
+00087330: 7072 6563 6973 696f 6e5f 7363 6f72 6528  precision_score(
+00087340: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087350: 6e73 2c61 7665 7261 6765 3d4e 6f6e 6529  ns,average=None)
+00087360: 5b70 6f73 5f6c 6162 656c 5d0d 0a0d 0a64  [pos_label]....d
+00087370: 6566 2067 696e 695f 6176 6572 6167 655f  ef gini_average_
+00087380: 7072 6563 6973 696f 6e28 7472 7574 682c  precision(truth,
+00087390: 2070 7265 6469 6374 696f 6e73 293a 0d0a   predictions):..
+000873a0: 2020 2020 7265 7475 726e 2070 7265 6369      return preci
+000873b0: 7369 6f6e 5f73 636f 7265 2874 7275 7468  sion_score(truth
+000873c0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+000873d0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+000873e0: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
+000873f0: 0a64 6566 2067 696e 695f 7765 6967 6874  .def gini_weight
+00087400: 6564 5f70 7265 6369 7369 6f6e 2874 7275  ed_precision(tru
+00087410: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00087420: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
+00087430: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
+00087440: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
+00087450: 2e61 7267 6d61 7828 6178 6973 3d31 292c  .argmax(axis=1),
+00087460: 6176 6572 6167 653d 2777 6569 6768 7465  average='weighte
+00087470: 6427 290d 0a0d 0a64 6566 2067 696e 695f  d')....def gini_
+00087480: 6d61 6372 6f5f 7072 6563 6973 696f 6e28  macro_precision(
+00087490: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+000874a0: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+000874b0: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
+000874c0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000874d0: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+000874e0: 3129 2c61 7665 7261 6765 3d27 6d61 6372  1),average='macr
+000874f0: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00087500: 6d69 6372 6f5f 7072 6563 6973 696f 6e28  micro_precision(
+00087510: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087520: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00087530: 2070 7265 6369 7369 6f6e 5f73 636f 7265   precision_score
+00087540: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00087550: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+00087560: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
+00087570: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00087580: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
+00087590: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
+000875a0: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+000875b0: 726e 2070 7265 6369 7369 6f6e 5f73 636f  rn precision_sco
+000875c0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
+000875d0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
+000875e0: 733d 3129 2c61 7665 7261 6765 3d27 7361  s=1),average='sa
+000875f0: 6d70 6c65 7327 290d 0a0d 0a64 6566 2067  mples')....def g
+00087600: 696e 695f 6631 2874 7275 7468 2c20 7072  ini_f1(truth, pr
+00087610: 6564 6963 7469 6f6e 732c 706f 735f 6c61  edictions,pos_la
+00087620: 6265 6c3d 3129 3a0d 0a20 2020 2072 6574  bel=1):..    ret
+00087630: 7572 6e20 6631 5f73 636f 7265 2874 7275  urn f1_score(tru
+00087640: 7468 2c20 7072 6564 6963 7469 6f6e 732c  th, predictions,
+00087650: 6176 6572 6167 653d 4e6f 6e65 295b 706f  average=None)[po
+00087660: 735f 6c61 6265 6c5d 0d0a 0d0a 6465 6620  s_label]....def 
+00087670: 6769 6e69 5f77 6569 6768 7465 645f 6631  gini_weighted_f1
+00087680: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00087690: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+000876a0: 6e20 6631 5f73 636f 7265 2874 7275 7468  n f1_score(truth
+000876b0: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+000876c0: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+000876d0: 7261 6765 3d27 7765 6967 6874 6564 2729  rage='weighted')
+000876e0: 0d0a 0d0a 6465 6620 6769 6e69 5f6d 6163  ....def gini_mac
+000876f0: 726f 5f66 3128 7472 7574 682c 2070 7265  ro_f1(truth, pre
+00087700: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+00087710: 7265 7475 726e 2066 315f 7363 6f72 6528  return f1_score(
+00087720: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087730: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
+00087740: 292c 6176 6572 6167 653d 276d 6163 726f  ),average='macro
+00087750: 2729 0d0a 0d0a 6465 6620 6769 6e69 5f6d  ')....def gini_m
+00087760: 6963 726f 5f66 3128 7472 7574 682c 2070  icro_f1(truth, p
+00087770: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
+00087780: 2020 7265 7475 726e 2066 315f 7363 6f72    return f1_scor
+00087790: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+000877a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+000877b0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
+000877c0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
+000877d0: 5f73 616d 706c 6573 5f66 3128 7472 7574  _samples_f1(trut
+000877e0: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+000877f0: 0d0a 2020 2020 7265 7475 726e 2066 315f  ..    return f1_
+00087800: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00087810: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
+00087820: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
+00087830: 2773 616d 706c 6573 2729 0d0a 0d0a 6465  'samples')....de
+00087840: 6620 6769 6e69 5f6c 6f67 5f6c 6f73 7328  f gini_log_loss(
+00087850: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087860: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00087870: 206c 6f67 5f6c 6f73 7328 7472 7574 682c   log_loss(truth,
+00087880: 2070 7265 6469 6374 696f 6e73 2c6e 6f72   predictions,nor
+00087890: 6d61 6c69 7a65 3d54 7275 6529 0d0a 0d0a  malize=True)....
+000878a0: 6465 6620 6769 6e69 5f72 6563 616c 6c28  def gini_recall(
+000878b0: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+000878c0: 6e73 2c70 6f73 5f6c 6162 656c 3d31 293a  ns,pos_label=1):
+000878d0: 0d0a 2020 2020 7265 7475 726e 2072 6563  ..    return rec
+000878e0: 616c 6c5f 7363 6f72 6528 7472 7574 682c  all_score(truth,
+000878f0: 2070 7265 6469 6374 696f 6e73 2c61 7665   predictions,ave
+00087900: 7261 6765 3d4e 6f6e 6529 5b70 6f73 5f6c  rage=None)[pos_l
+00087910: 6162 656c 5d0d 0a0d 0a64 6566 2067 696e  abel]....def gin
+00087920: 695f 7765 6967 6874 6564 5f72 6563 616c  i_weighted_recal
+00087930: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
+00087940: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00087950: 726e 2072 6563 616c 6c5f 7363 6f72 6528  rn recall_score(
+00087960: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00087970: 6e73 2e61 7267 6d61 7828 6178 6973 3d31  ns.argmax(axis=1
+00087980: 292c 6176 6572 6167 653d 2777 6569 6768  ),average='weigh
+00087990: 7465 6427 290d 0a0d 0a64 6566 2067 696e  ted')....def gin
+000879a0: 695f 7361 6d70 6c65 735f 7265 6361 6c6c  i_samples_recall
+000879b0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000879c0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+000879d0: 6e20 7265 6361 6c6c 5f73 636f 7265 2874  n recall_score(t
+000879e0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+000879f0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
+00087a00: 2c61 7665 7261 6765 3d27 7361 6d70 6c65  ,average='sample
+00087a10: 7327 290d 0a0d 0a64 6566 2067 696e 695f  s')....def gini_
+00087a20: 6d61 6372 6f5f 7265 6361 6c6c 2874 7275  macro_recall(tru
+00087a30: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00087a40: 3a0d 0a20 2020 2072 6574 7572 6e20 7265  :..    return re
+00087a50: 6361 6c6c 5f73 636f 7265 2874 7275 7468  call_score(truth
+00087a60: 2c20 7072 6564 6963 7469 6f6e 732e 6172  , predictions.ar
+00087a70: 676d 6178 2861 7869 733d 3129 2c61 7665  gmax(axis=1),ave
+00087a80: 7261 6765 3d27 6d61 6372 6f27 290d 0a0d  rage='macro')...
+00087a90: 0a64 6566 2067 696e 695f 6d69 6372 6f5f  .def gini_micro_
+00087aa0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+00087ab0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00087ac0: 2072 6574 7572 6e20 7265 6361 6c6c 5f73   return recall_s
+00087ad0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+00087ae0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
+00087af0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
+00087b00: 6d69 6372 6f27 290d 0a0d 0a23 2063 616c  micro')....# cal
+00087b10: 6375 6c61 7465 2066 322d 6d65 6173 7572  culate f2-measur
+00087b20: 650d 0a64 6566 2066 325f 6d65 6173 7572  e..def f2_measur
+00087b30: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
+00087b40: 293a 0d0a 2020 2020 7265 7475 726e 2066  ):..    return f
+00087b50: 6265 7461 5f73 636f 7265 2879 5f74 7275  beta_score(y_tru
+00087b60: 652c 2079 5f70 7265 642c 2062 6574 613d  e, y_pred, beta=
+00087b70: 3229 0d0a 0000 0000 0000 0000 0000 0000  2)..............
 00087b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087c00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00087c10: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
-00087c20: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
-00087c30: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
-00087c40: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00087c50: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
-00087c60: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
-00087c70: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
-00087c80: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
-00087c90: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
-00087ca0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
-00087cb0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
-00087cc0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
-00087cd0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
-00087ce0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
-00087cf0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00087d00: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
-00087d10: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
-00087d20: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
-00087d30: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00087d40: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
-00087d50: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00087d60: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
-00087d70: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
-00087d80: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
-00087d90: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-00087da0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
-00087db0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
-00087dc0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
-00087dd0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
-00087de0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
-00087df0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-00087e00: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
-00087e10: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
-00087e20: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00087e30: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00087e40: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
-00087e50: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
-00087e60: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
-00087e70: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00087e80: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
-00087e90: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00087ea0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
-00087eb0: 6375 7261 6379 5f73 636f 7265 2020 200d  curacy_score   .
-00087ec0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-00087ed0: 7472 6963 7320 696d 706f 7274 2061 7665  trics import ave
-00087ee0: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
-00087ef0: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
-00087f00: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-00087f10: 7420 6631 5f73 636f 7265 0d0a 6672 6f6d  t f1_score..from
-00087f20: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-00087f30: 2069 6d70 6f72 7420 6c6f 675f 6c6f 7373   import log_loss
-00087f40: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00087f50: 6574 7269 6373 2069 6d70 6f72 7420 7072  etrics import pr
-00087f60: 6563 6973 696f 6e5f 7363 6f72 650d 0a66  ecision_score..f
-00087f70: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00087f80: 6963 7320 696d 706f 7274 2072 6563 616c  ics import recal
-00087f90: 6c5f 7363 6f72 650d 0a66 726f 6d20 736b  l_score..from sk
-00087fa0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
-00087fb0: 706f 7274 2072 6f63 5f61 7563 5f73 636f  port roc_auc_sco
-00087fc0: 7265 0d0a 6672 6f6d 2073 6b6c 6561 726e  re..from sklearn
-00087fd0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00087fe0: 6662 6574 615f 7363 6f72 650d 0a23 2323  fbeta_score..###
-00087ff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088040: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
-00088050: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00088060: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
-00088070: 0d0a 6465 6620 6261 6c61 6e63 6564 5f61  ..def balanced_a
-00088080: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
-00088090: 7472 7565 2c20 795f 7072 6564 2c20 7361  true, y_pred, sa
-000880a0: 6d70 6c65 5f77 6569 6768 743d 4e6f 6e65  mple_weight=None
-000880b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000880c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000880d0: 646a 7573 7465 643d 4661 6c73 6529 3a0d  djusted=False):.
-000880e0: 0a20 2020 2043 203d 2063 6f6e 6675 7369  .    C = confusi
-000880f0: 6f6e 5f6d 6174 7269 7828 795f 7472 7565  on_matrix(y_true
-00088100: 2c20 795f 7072 6564 2c20 7361 6d70 6c65  , y_pred, sample
-00088110: 5f77 6569 6768 743d 7361 6d70 6c65 5f77  _weight=sample_w
-00088120: 6569 6768 7429 0d0a 2020 2020 7769 7468  eight)..    with
-00088130: 206e 702e 6572 7273 7461 7465 2864 6976   np.errstate(div
-00088140: 6964 653d 2769 676e 6f72 6527 2c20 696e  ide='ignore', in
-00088150: 7661 6c69 643d 2769 676e 6f72 6527 293a  valid='ignore'):
-00088160: 0d0a 2020 2020 2020 2020 7065 725f 636c  ..        per_cl
-00088170: 6173 7320 3d20 6e70 2e64 6961 6728 4329  ass = np.diag(C)
-00088180: 202f 2043 2e73 756d 2861 7869 733d 3129   / C.sum(axis=1)
-00088190: 0d0a 2020 2020 6966 206e 702e 616e 7928  ..    if np.any(
-000881a0: 6e70 2e69 736e 616e 2870 6572 5f63 6c61  np.isnan(per_cla
-000881b0: 7373 2929 3a0d 0a20 2020 2020 2020 2077  ss)):..        w
-000881c0: 6172 6e69 6e67 732e 7761 726e 2827 795f  arnings.warn('y_
-000881d0: 7072 6564 2063 6f6e 7461 696e 7320 636c  pred contains cl
-000881e0: 6173 7365 7320 6e6f 7420 696e 2079 5f74  asses not in y_t
-000881f0: 7275 6527 290d 0a20 2020 2020 2020 2070  rue')..        p
-00088200: 6572 5f63 6c61 7373 203d 2070 6572 5f63  er_class = per_c
-00088210: 6c61 7373 5b7e 6e70 2e69 736e 616e 2870  lass[~np.isnan(p
-00088220: 6572 5f63 6c61 7373 295d 0d0a 2020 2020  er_class)]..    
-00088230: 7363 6f72 6520 3d20 6e70 2e6d 6561 6e28  score = np.mean(
-00088240: 7065 725f 636c 6173 7329 0d0a 2020 2020  per_class)..    
-00088250: 6966 2061 646a 7573 7465 643a 0d0a 2020  if adjusted:..  
-00088260: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
-00088270: 3d20 6c65 6e28 7065 725f 636c 6173 7329  = len(per_class)
-00088280: 0d0a 2020 2020 2020 2020 6368 616e 6365  ..        chance
-00088290: 203d 2031 202f 206e 5f63 6c61 7373 6573   = 1 / n_classes
-000882a0: 0d0a 2020 2020 2020 2020 7363 6f72 6520  ..        score 
-000882b0: 2d3d 2063 6861 6e63 650d 0a20 2020 2020  -= chance..     
-000882c0: 2020 2073 636f 7265 202f 3d20 3120 2d20     score /= 1 - 
-000882d0: 6368 616e 6365 0d0a 2020 2020 7265 7475  chance..    retu
-000882e0: 726e 2073 636f 7265 0d0a 2323 2323 2323  rn score..######
-000882f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088330: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00088340: 0a64 6566 2061 6363 7528 7265 7375 6c74  .def accu(result
-00088350: 732c 2079 5f63 7629 3a0d 0a20 2020 2072  s, y_cv):..    r
-00088360: 6574 7572 6e20 2872 6573 756c 7473 3d3d  eturn (results==
-00088370: 795f 6376 292e 6173 7479 7065 2869 6e74  y_cv).astype(int
-00088380: 292e 7375 6d28 6178 6973 3d30 292f 2879  ).sum(axis=0)/(y
-00088390: 5f63 762e 7368 6170 655b 305d 290d 0a64  _cv.shape[0])..d
-000883a0: 6566 2072 6d73 6528 7265 7375 6c74 732c  ef rmse(results,
-000883b0: 2079 5f63 7629 3a0d 0a20 2020 2072 6574   y_cv):..    ret
-000883c0: 7572 6e20 6e70 2e73 7172 7428 6e70 2e6d  urn np.sqrt(np.m
-000883d0: 6561 6e28 2872 6573 756c 7473 202d 2079  ean((results - y
-000883e0: 5f63 7629 2a2a 322c 2061 7869 733d 3029  _cv)**2, axis=0)
-000883f0: 290d 0a23 2323 2323 2323 2320 4465 6669  )..######## Defi
-00088400: 6e69 6e67 206f 626a 6563 7469 7665 2066  ning objective f
-00088410: 756e 6374 696f 6e73 2066 6f72 2048 7970  unctions for Hyp
-00088420: 6572 4f70 7420 6865 7265 2023 2323 2323  erOpt here #####
-00088430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00088440: 230d 0a23 2323 206b 6565 7020 616c 6c20  #..### keep all 
-00088450: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
-00088460: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-00088470: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
-00088480: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
-00088490: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
-000884a0: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
-000884b0: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
-000884c0: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
-000884d0: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
-000884e0: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
-000884f0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
-00088500: 2061 6e79 7469 6d65 210d 0a64 6566 2067   anytime!..def g
-00088510: 696e 6928 7472 7574 682c 2070 7265 6469  ini(truth, predi
-00088520: 6374 696f 6e73 293a 0d0a 2020 2020 6720  ctions):..    g 
-00088530: 3d20 6e70 2e61 7361 7272 6179 286e 702e  = np.asarray(np.
-00088540: 635f 5b74 7275 7468 2c20 7072 6564 6963  c_[truth, predic
-00088550: 7469 6f6e 732c 206e 702e 6172 616e 6765  tions, np.arange
-00088560: 286c 656e 2874 7275 7468 2929 205d 2c20  (len(truth)) ], 
-00088570: 6474 7970 653d 6e70 2e66 6c6f 6174 290d  dtype=np.float).
-00088580: 0a20 2020 2067 203d 2067 5b6e 702e 6c65  .    g = g[np.le
-00088590: 7873 6f72 7428 2867 5b3a 2c32 5d2c 202d  xsort((g[:,2], -
-000885a0: 312a 675b 3a2c 315d 2929 5d0d 0a20 2020  1*g[:,1]))]..   
-000885b0: 2067 7320 3d20 675b 3a2c 305d 2e63 756d   gs = g[:,0].cum
-000885c0: 7375 6d28 292e 7375 6d28 2920 2f20 675b  sum().sum() / g[
-000885d0: 3a2c 305d 2e73 756d 2829 0d0a 2020 2020  :,0].sum()..    
-000885e0: 6773 202d 3d20 286c 656e 2874 7275 7468  gs -= (len(truth
-000885f0: 2920 2b20 3129 202f 2032 2e0d 0a20 2020  ) + 1) / 2...   
-00088600: 2072 6574 7572 6e20 6773 202f 206c 656e   return gs / len
-00088610: 2874 7275 7468 290d 0a0d 0a64 6566 2067  (truth)....def g
-00088620: 696e 695f 736b 6c65 6172 6e28 7472 7574  ini_sklearn(trut
-00088630: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00088640: 0d0a 2020 2020 7265 7475 726e 2067 696e  ..    return gin
-00088650: 6928 7472 7574 682c 2070 7265 6469 6374  i(truth, predict
-00088660: 696f 6e73 2920 2f20 6769 6e69 2874 7275  ions) / gini(tru
-00088670: 7468 2c20 7472 7574 6829 0d0a 0d0a 6465  th, truth)....de
-00088680: 6620 6769 6e69 5f6d 6561 6528 7472 7574  f gini_meae(trut
-00088690: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-000886a0: 0d0a 2020 2020 7363 6f72 6520 3d20 6d65  ..    score = me
-000886b0: 6469 616e 5f61 6273 6f6c 7574 655f 6572  dian_absolute_er
-000886c0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
-000886d0: 6374 696f 6e73 290d 0a20 2020 2072 6574  ctions)..    ret
-000886e0: 7572 6e20 7363 6f72 650d 0a0d 0a64 6566  urn score....def
-000886f0: 2067 696e 695f 6d73 6c65 2874 7275 7468   gini_msle(truth
-00088700: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00088710: 0a20 2020 2073 636f 7265 203d 206e 702e  .    score = np.
-00088720: 7371 7274 286d 6561 6e5f 7371 7561 7265  sqrt(mean_square
-00088730: 645f 6c6f 675f 6572 726f 7228 7472 7574  d_log_error(trut
-00088740: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
-00088750: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
-00088760: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f6d  re....def gini_m
-00088770: 6165 2874 7275 7468 2c20 7072 6564 6963  ae(truth, predic
-00088780: 7469 6f6e 7329 3a0d 0a20 2020 2073 636f  tions):..    sco
-00088790: 7265 203d 206d 6561 6e5f 6162 736f 6c75  re = mean_absolu
-000887a0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
-000887b0: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
-000887c0: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
-000887d0: 0d0a 6465 6620 6769 6e69 5f6d 7365 2874  ..def gini_mse(t
-000887e0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-000887f0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
-00088800: 206e 702e 7371 7274 286d 6561 6e5f 7371   np.sqrt(mean_sq
-00088810: 7561 7265 645f 6572 726f 7228 7472 7574  uared_error(trut
-00088820: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
-00088830: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
-00088840: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f72  re....def gini_r
-00088850: 6d73 6528 7472 7574 682c 2070 7265 6469  mse(truth, predi
-00088860: 6374 696f 6e73 293a 0d0a 2020 2020 7363  ctions):..    sc
-00088870: 6f72 6520 3d20 6e70 2e73 7172 7428 6d65  ore = np.sqrt(me
-00088880: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00088890: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-000888a0: 6f6e 7329 290d 0a20 2020 2072 6574 7572  ons))..    retur
-000888b0: 6e20 7363 6f72 650d 0a0d 0a64 6566 2067  n score....def g
-000888c0: 696e 695f 6163 6375 7261 6379 2874 7275  ini_accuracy(tru
-000888d0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
-000888e0: 3a0d 0a20 2020 2072 6574 7572 6e20 312d  :..    return 1-
-000888f0: 6163 6375 7261 6379 5f73 636f 7265 2874  accuracy_score(t
-00088900: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00088910: 7329 0d0a 0d0a 6465 6620 6769 6e69 5f62  s)....def gini_b
-00088920: 616c 5f61 6363 7572 6163 7928 7472 7574  al_accuracy(trut
-00088930: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00088940: 0d0a 2020 2020 7265 7475 726e 2031 2d62  ..    return 1-b
-00088950: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-00088960: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088970: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
-00088980: 6620 6769 6e69 5f72 6f63 2874 7275 7468  f gini_roc(truth
-00088990: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-000889a0: 0a20 2020 2072 6574 7572 6e20 312d 726f  .    return 1-ro
-000889b0: 635f 6175 635f 7363 6f72 6528 7472 7574  c_auc_score(trut
-000889c0: 682c 2070 7265 6469 6374 696f 6e73 290d  h, predictions).
-000889d0: 0a0d 0a64 6566 2067 696e 695f 7072 6563  ...def gini_prec
-000889e0: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
-000889f0: 6469 6374 696f 6e73 2c70 6f73 5f6c 6162  dictions,pos_lab
-00088a00: 656c 3d31 293a 0d0a 2020 2020 7265 7475  el=1):..    retu
-00088a10: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
-00088a20: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-00088a30: 6963 7469 6f6e 7329 0d0a 0d0a 6465 6620  ictions)....def 
-00088a40: 6769 6e69 5f61 7665 7261 6765 5f70 7265  gini_average_pre
-00088a50: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
-00088a60: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088a70: 2072 6574 7572 6e20 312d 6176 6572 6167   return 1-averag
-00088a80: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-00088a90: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-00088aa0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-00088ab0: 3d31 292c 6176 6572 6167 653d 2777 6569  =1),average='wei
-00088ac0: 6768 7465 6427 290d 0a0d 0a64 6566 2067  ghted')....def g
-00088ad0: 696e 695f 7765 6967 6874 6564 5f70 7265  ini_weighted_pre
-00088ae0: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
-00088af0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088b00: 2072 6574 7572 6e20 312d 7072 6563 6973   return 1-precis
-00088b10: 696f 6e5f 7363 6f72 6528 7472 7574 682c  ion_score(truth,
-00088b20: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
-00088b30: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
-00088b40: 6167 653d 2777 6569 6768 7465 6427 290d  age='weighted').
-00088b50: 0a0d 0a64 6566 2067 696e 695f 6d61 6372  ...def gini_macr
-00088b60: 6f5f 7072 6563 6973 696f 6e28 7472 7574  o_precision(trut
-00088b70: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-00088b80: 0d0a 2020 2020 7265 7475 726e 2031 2d70  ..    return 1-p
-00088b90: 7265 6369 7369 6f6e 5f73 636f 7265 2874  recision_score(t
-00088ba0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
-00088bb0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
-00088bc0: 2c61 7665 7261 6765 3d27 6d61 6372 6f27  ,average='macro'
-00088bd0: 290d 0a0d 0a64 6566 2067 696e 695f 6d69  )....def gini_mi
-00088be0: 6372 6f5f 7072 6563 6973 696f 6e28 7472  cro_precision(tr
-00088bf0: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
-00088c00: 293a 0d0a 2020 2020 7265 7475 726e 2031  ):..    return 1
-00088c10: 2d70 7265 6369 7369 6f6e 5f73 636f 7265  -precision_score
-00088c20: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00088c30: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
-00088c40: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
-00088c50: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
-00088c60: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
-00088c70: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
-00088c80: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00088c90: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
-00088ca0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
-00088cb0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
-00088cc0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
-00088cd0: 7361 6d70 6c65 7327 290d 0a0d 0a64 6566  samples')....def
-00088ce0: 2067 696e 695f 6631 2874 7275 7468 2c20   gini_f1(truth, 
-00088cf0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-00088d00: 2020 2072 6574 7572 6e20 312d 6631 5f73     return 1-f1_s
-00088d10: 636f 7265 2874 7275 7468 2c70 7265 6469  core(truth,predi
-00088d20: 6374 696f 6e73 290d 0a0d 0a64 6566 2067  ctions)....def g
-00088d30: 696e 695f 7765 6967 6874 6564 5f66 3128  ini_weighted_f1(
-00088d40: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
-00088d50: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
-00088d60: 2031 2d66 315f 7363 6f72 6528 7472 7574   1-f1_score(trut
-00088d70: 682c 2070 7265 6469 6374 696f 6e73 2e61  h, predictions.a
-00088d80: 7267 6d61 7828 6178 6973 3d31 292c 6176  rgmax(axis=1),av
-00088d90: 6572 6167 653d 2777 6569 6768 7465 6427  erage='weighted'
-00088da0: 290d 0a0d 0a64 6566 2067 696e 695f 6d61  )....def gini_ma
-00088db0: 6372 6f5f 6631 2874 7275 7468 2c20 7072  cro_f1(truth, pr
-00088dc0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088dd0: 2072 6574 7572 6e20 312d 6631 5f73 636f   return 1-f1_sco
-00088de0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
-00088df0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
-00088e00: 733d 3129 2c61 7665 7261 6765 3d27 6d61  s=1),average='ma
-00088e10: 6372 6f27 290d 0a0d 0a64 6566 2067 696e  cro')....def gin
-00088e20: 695f 6d69 6372 6f5f 6631 2874 7275 7468  i_micro_f1(truth
-00088e30: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
-00088e40: 0a20 2020 2072 6574 7572 6e20 312d 6631  .    return 1-f1
-00088e50: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088e60: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
-00088e70: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
-00088e80: 3d27 6d69 6372 6f27 290d 0a0d 0a64 6566  ='micro')....def
-00088e90: 2067 696e 695f 7361 6d70 6c65 735f 6631   gini_samples_f1
-00088ea0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00088eb0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
-00088ec0: 6e20 312d 6631 5f73 636f 7265 2874 7275  n 1-f1_score(tru
-00088ed0: 7468 2c20 7072 6564 6963 7469 6f6e 732e  th, predictions.
-00088ee0: 6172 676d 6178 2861 7869 733d 3129 2c61  argmax(axis=1),a
-00088ef0: 7665 7261 6765 3d27 7361 6d70 6c65 7327  verage='samples'
-00088f00: 290d 0a0d 0a64 6566 2067 696e 695f 6c6f  )....def gini_lo
-00088f10: 675f 6c6f 7373 2874 7275 7468 2c20 7072  g_loss(truth, pr
-00088f20: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088f30: 2072 6574 7572 6e20 6c6f 675f 6c6f 7373   return log_loss
-00088f40: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
-00088f50: 6f6e 732c 6e6f 726d 616c 697a 653d 5472  ons,normalize=Tr
-00088f60: 7565 290d 0a0d 0a64 6566 2067 696e 695f  ue)....def gini_
-00088f70: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-00088f80: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088f90: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
-00088fa0: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00088fb0: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
-00088fc0: 6620 6769 6e69 5f77 6569 6768 7465 645f  f gini_weighted_
-00088fd0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
-00088fe0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
-00088ff0: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
-00089000: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
-00089010: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
-00089020: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
-00089030: 3d27 7765 6967 6874 6564 2729 0d0a 0d0a  ='weighted')....
-00089040: 6465 6620 6769 6e69 5f73 616d 706c 6573  def gini_samples
-00089050: 5f72 6563 616c 6c28 7472 7574 682c 2070  _recall(truth, p
-00089060: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
-00089070: 2020 7265 7475 726e 2031 2d72 6563 616c    return 1-recal
-00089080: 6c5f 7363 6f72 6528 7472 7574 682c 2070  l_score(truth, p
-00089090: 7265 6469 6374 696f 6e73 2e61 7267 6d61  redictions.argma
-000890a0: 7828 6178 6973 3d31 292c 6176 6572 6167  x(axis=1),averag
-000890b0: 653d 2773 616d 706c 6573 2729 0d0a 0d0a  e='samples')....
-000890c0: 6465 6620 6769 6e69 5f6d 6163 726f 5f72  def gini_macro_r
-000890d0: 6563 616c 6c28 7472 7574 682c 2070 7265  ecall(truth, pre
-000890e0: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
-000890f0: 7265 7475 726e 2031 2d72 6563 616c 6c5f  return 1-recall_
-00089100: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-00089110: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
-00089120: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
-00089130: 276d 6163 726f 2729 0d0a 0d0a 6465 6620  'macro')....def 
-00089140: 6769 6e69 5f6d 6963 726f 5f72 6563 616c  gini_micro_recal
-00089150: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
-00089160: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
-00089170: 726e 2031 2d72 6563 616c 6c5f 7363 6f72  rn 1-recall_scor
-00089180: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
-00089190: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
-000891a0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
-000891b0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
-000891c0: 5f72 6f63 5f61 7563 2874 7275 7468 2c20  _roc_auc(truth, 
-000891d0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
-000891e0: 2020 2072 6574 7572 6e20 312d 726f 635f     return 1-roc_
-000891f0: 6175 635f 7363 6f72 6528 7472 7574 682c  auc_score(truth,
-00089200: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
-00089210: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
-00089220: 6167 653d 276d 6163 726f 2729 0d0a 2320  age='macro')..# 
-00089230: 6361 6c63 756c 6174 6520 6632 2d6d 6561  calculate f2-mea
-00089240: 7375 7265 0d0a 6465 6620 6632 5f6d 6561  sure..def f2_mea
-00089250: 7375 7265 2879 5f74 7275 652c 2079 5f70  sure(y_true, y_p
-00089260: 7265 6429 3a0d 0a20 2020 2072 6574 7572  red):..    retur
-00089270: 6e20 6662 6574 615f 7363 6f72 6528 795f  n fbeta_score(y_
-00089280: 7472 7565 2c20 795f 7072 6564 2c20 6265  true, y_pred, be
-00089290: 7461 3d32 290d 0a23 2323 206b 6565 7020  ta=2)..### keep 
-000892a0: 616c 6c20 5265 6772 6573 7369 6f6e 2053  all Regression S
-000892b0: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-000892c0: 735f 6265 7474 6572 2054 7275 6520 7369  s_better True si
-000892d0: 6e63 6520 6974 206c 6561 7665 7320 7468  nce it leaves th
-000892e0: 656d 2061 7320 6973 2061 6e64 206d 696e  em as is and min
-000892f0: 696d 697a 6573 2074 6865 6d0d 0a6d 6561  imizes them..mea
-00089300: 655f 7363 6f72 6572 203d 206d 616b 655f  e_scorer = make_
-00089310: 7363 6f72 6572 2867 696e 695f 6d65 6165  scorer(gini_meae
-00089320: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
-00089330: 7465 723d 5472 7565 290d 0a6d 736c 655f  ter=True)..msle_
-00089340: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
-00089350: 6f72 6572 2867 696e 695f 6d73 6c65 2c20  orer(gini_msle, 
-00089360: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00089370: 723d 5472 7565 290d 0a6d 6165 5f73 636f  r=True)..mae_sco
-00089380: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
-00089390: 7228 6769 6e69 5f6d 6165 2c20 6772 6561  r(gini_mae, grea
-000893a0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-000893b0: 7565 290d 0a6d 7365 5f73 636f 7265 7220  ue)..mse_scorer 
-000893c0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-000893d0: 6e69 5f6d 7365 2c20 6772 6561 7465 725f  ni_mse, greater_
-000893e0: 6973 5f62 6574 7465 723d 5472 7565 290d  is_better=True).
-000893f0: 0a0d 0a23 2323 206b 6565 7020 616c 6c20  ...### keep all 
-00089400: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
-00089410: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
-00089420: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
-00089430: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
-00089440: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
-00089450: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
-00089460: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
-00089470: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
-00089480: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
-00089490: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
-000894a0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
-000894b0: 2061 6e79 7469 6d65 210d 0a61 6363 7572   anytime!..accur
-000894c0: 6163 795f 7363 6f72 6572 203d 206d 616b  acy_scorer = mak
-000894d0: 655f 7363 6f72 6572 2867 696e 695f 6163  e_scorer(gini_ac
-000894e0: 6375 7261 6379 2c20 6772 6561 7465 725f  curacy, greater_
-000894f0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-00089500: 6e65 6564 735f 7072 6f62 613d 4661 6c73  needs_proba=Fals
-00089510: 6529 0d0a 6261 6c5f 6163 6375 7261 6379  e)..bal_accuracy
-00089520: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-00089530: 636f 7265 7228 6769 6e69 5f62 616c 5f61  corer(gini_bal_a
-00089540: 6363 7572 6163 792c 2067 7265 6174 6572  ccuracy, greater
-00089550: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
-00089560: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
-00089570: 7365 290d 0a0d 0a67 696e 695f 7363 6f72  se)....gini_scor
-00089580: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-00089590: 2867 696e 695f 736b 6c65 6172 6e2c 2067  (gini_sklearn, g
-000895a0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-000895b0: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
-000895c0: 6261 3d54 7275 6529 0d0a 726f 635f 7363  ba=True)..roc_sc
-000895d0: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
-000895e0: 6572 2867 696e 695f 726f 632c 2067 7265  er(gini_roc, gre
-000895f0: 6174 6572 5f69 735f 6265 7474 6572 3d54  ater_is_better=T
-00089600: 7275 652c 206e 6565 6473 5f70 726f 6261  rue, needs_proba
-00089610: 3d54 7275 6529 0d0a 0d0a 7072 6563 6973  =True)....precis
-00089620: 696f 6e5f 7363 6f72 6572 203d 206d 616b  ion_scorer = mak
-00089630: 655f 7363 6f72 6572 2867 696e 695f 7072  e_scorer(gini_pr
-00089640: 6563 6973 696f 6e2c 2067 7265 6174 6572  ecision, greater
-00089650: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
-00089660: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
-00089670: 7365 290d 0a61 7665 7261 6765 5f70 7265  se)..average_pre
-00089680: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
-00089690: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-000896a0: 5f61 7665 7261 6765 5f70 7265 6369 7369  _average_precisi
-000896b0: 6f6e 2c20 6772 6561 7465 725f 6973 5f62  on, greater_is_b
-000896c0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-000896d0: 735f 7072 6f62 613d 5472 7565 290d 0a77  s_proba=True)..w
-000896e0: 6569 6768 7465 645f 7072 6563 6973 696f  eighted_precisio
-000896f0: 6e5f 7363 6f72 6572 203d 206d 616b 655f  n_scorer = make_
-00089700: 7363 6f72 6572 2867 696e 695f 7765 6967  scorer(gini_weig
-00089710: 6874 6564 5f70 7265 6369 7369 6f6e 2c20  hted_precision, 
-00089720: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00089730: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
-00089740: 6f62 613d 5472 7565 290d 0a6d 6163 726f  oba=True)..macro
-00089750: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
-00089760: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
-00089770: 6769 6e69 5f6d 6163 726f 5f70 7265 6369  gini_macro_preci
-00089780: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
-00089790: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
-000897a0: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
-000897b0: 0a6d 6963 726f 5f70 7265 6369 7369 6f6e  .micro_precision
-000897c0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-000897d0: 636f 7265 7228 6769 6e69 5f6d 6963 726f  corer(gini_micro
-000897e0: 5f70 7265 6369 7369 6f6e 2c20 6772 6561  _precision, grea
-000897f0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089800: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089810: 5472 7565 290d 0a73 616d 706c 6573 5f70  True)..samples_p
-00089820: 7265 6369 7369 6f6e 5f73 636f 7265 7220  recision_scorer 
-00089830: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-00089840: 6e69 5f73 616d 706c 6573 5f70 7265 6369  ni_samples_preci
-00089850: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
-00089860: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
-00089870: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
-00089880: 0a0d 0a66 315f 7363 6f72 6572 203d 206d  ...f1_scorer = m
-00089890: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
-000898a0: 6631 2c20 6772 6561 7465 725f 6973 5f62  f1, greater_is_b
-000898b0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
-000898c0: 735f 7072 6f62 613d 4661 6c73 6529 0d0a  s_proba=False)..
-000898d0: 7765 6967 6874 6564 5f66 315f 7363 6f72  weighted_f1_scor
-000898e0: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
-000898f0: 2867 696e 695f 7765 6967 6874 6564 5f66  (gini_weighted_f
-00089900: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
-00089910: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-00089920: 5f70 726f 6261 3d54 7275 6529 0d0a 6d61  _proba=True)..ma
-00089930: 6372 6f5f 6631 5f73 636f 7265 7220 3d20  cro_f1_scorer = 
-00089940: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
-00089950: 5f6d 6163 726f 5f66 312c 2067 7265 6174  _macro_f1, great
-00089960: 6572 5f69 735f 6265 7474 6572 3d54 7275  er_is_better=Tru
-00089970: 652c 206e 6565 6473 5f70 726f 6261 3d54  e, needs_proba=T
-00089980: 7275 6529 0d0a 6d69 6372 6f5f 6631 5f73  rue)..micro_f1_s
-00089990: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
-000899a0: 7265 7228 6769 6e69 5f6d 6963 726f 5f66  rer(gini_micro_f
-000899b0: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
-000899c0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
-000899d0: 5f70 726f 6261 3d54 7275 6529 0d0a 7361  _proba=True)..sa
-000899e0: 6d70 6c65 735f 6631 5f73 636f 7265 7220  mples_f1_scorer 
-000899f0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
-00089a00: 6e69 5f73 616d 706c 6573 5f66 312c 2067  ni_samples_f1, g
-00089a10: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
-00089a20: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
-00089a30: 6261 3d54 7275 6529 0d0a 0d0a 7265 6361  ba=True)....reca
-00089a40: 6c6c 5f73 636f 7265 7220 3d20 6d61 6b65  ll_scorer = make
-00089a50: 5f73 636f 7265 7228 6769 6e69 5f72 6563  _scorer(gini_rec
-00089a60: 616c 6c2c 2067 7265 6174 6572 5f69 735f  all, greater_is_
-00089a70: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
-00089a80: 6473 5f70 726f 6261 3d46 616c 7365 290d  ds_proba=False).
-00089a90: 0a77 6569 6768 7465 645f 7265 6361 6c6c  .weighted_recall
-00089aa0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
-00089ab0: 636f 7265 7228 6769 6e69 5f77 6569 6768  corer(gini_weigh
-00089ac0: 7465 645f 7265 6361 6c6c 2c20 6772 6561  ted_recall, grea
-00089ad0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089ae0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089af0: 5472 7565 290d 0a6d 6163 726f 5f72 6563  True)..macro_rec
-00089b00: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
-00089b10: 655f 7363 6f72 6572 2867 696e 695f 6d61  e_scorer(gini_ma
-00089b20: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
-00089b30: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089b40: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089b50: 5472 7565 290d 0a6d 6963 726f 5f72 6563  True)..micro_rec
-00089b60: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
-00089b70: 655f 7363 6f72 6572 2867 696e 695f 6d69  e_scorer(gini_mi
-00089b80: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
-00089b90: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
-00089ba0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
-00089bb0: 5472 7565 290d 0a73 616d 706c 6573 5f72  True)..samples_r
-00089bc0: 6563 616c 6c5f 7363 6f72 6572 203d 206d  ecall_scorer = m
-00089bd0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
-00089be0: 7361 6d70 6c65 735f 7265 6361 6c6c 2c20  samples_recall, 
-00089bf0: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
-00089c00: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
-00089c10: 6f62 613d 5472 7565 290d 0a0d 0a72 6f63  oba=True)....roc
-00089c20: 5f61 7563 5f73 636f 7265 7220 3d20 6d61  _auc_scorer = ma
-00089c30: 6b65 5f73 636f 7265 7228 6769 6e69 5f72  ke_scorer(gini_r
-00089c40: 6f63 5f61 7563 2c20 6772 6561 7465 725f  oc_auc, greater_
-00089c50: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
-00089c60: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
-00089c70: 290d 0a23 2323 204c 6561 7665 2074 6865  )..### Leave the
-00089c80: 206c 6f67 2d6c 6f73 7320 7363 6f72 6572   log-loss scorer
-00089c90: 2061 7320 6772 6561 7465 725f 6973 5f62   as greater_is_b
-00089ca0: 6574 7465 7220 5472 7565 2073 696e 6365  etter True since
-00089cb0: 2069 7420 6b65 6570 7320 7369 676e 2061   it keeps sign a
-00089cc0: 6e64 206d 696e 696d 697a 6573 2069 742e  nd minimizes it.
-00089cd0: 0d0a 6c6f 676c 6f73 735f 7363 6f72 6572  ..logloss_scorer
-00089ce0: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
-00089cf0: 696e 695f 6c6f 675f 6c6f 7373 2c20 6772  ini_log_loss, gr
-00089d00: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
-00089d10: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
-00089d20: 613d 5472 7565 290d 0a23 2323 2323 2323  a=True)..#######
-00089d30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089d40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00089d80: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
-00089d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00089e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00089e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00089e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00089e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-00089ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00089f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00089f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00089f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a000: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0008a010: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0008a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-0008a210: 2f61 7574 6f76 696d 6c2f 6665 6174 7572  /autoviml/featur
-0008a220: 655f 656e 6769 6e65 6572 696e 672e 7079  e_engineering.py
-0008a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0008a270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0008a280: 3030 3433 3237 3000 3030 3030 3030 3030  0043270.00000000
-0008a290: 3030 3000 3032 3133 3432 0020 3000 0000  000.021342. 0...
-0008a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-0008a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a320: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-0008a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0008a350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0008a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00087c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00087c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00087c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00087c90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00087ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00087d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00087d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00087d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+00087e10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+00087e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00087ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00088010: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
+00088020: 5f73 636f 7265 735f 484f 2e70 7900 0000  _scores_HO.py...
+00088030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00088070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00088080: 3030 3230 3630 3500 3030 3030 3030 3030  0020605.00000000
+00088090: 3030 3000 3032 3036 3131 0020 3000 0000  000.020611. 0...
+000880a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000880b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000880c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000880d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000880e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000880f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00088110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00088130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00088150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00088160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000881f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00088200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00088210: 6e70 0d0a 6672 6f6d 2073 6b6c 6561 726e  np..from sklearn
+00088220: 2069 6d70 6f72 7420 6d6f 6465 6c5f 7365   import model_se
+00088230: 6c65 6374 696f 6e0d 0a66 726f 6d20 736b  lection..from sk
+00088240: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00088250: 706f 7274 2063 6f6e 6675 7369 6f6e 5f6d  port confusion_m
+00088260: 6174 7269 782c 206d 6561 6e5f 7371 7561  atrix, mean_squa
+00088270: 7265 645f 6572 726f 720d 0a66 726f 6d20  red_error..from 
+00088280: 736b 6c65 6172 6e20 696d 706f 7274 206d  sklearn import m
+00088290: 6574 7269 6373 0d0a 6672 6f6d 2073 6b6c  etrics..from skl
+000882a0: 6561 726e 2069 6d70 6f72 7420 6d6f 6465  earn import mode
+000882b0: 6c5f 7365 6c65 6374 696f 6e2c 206d 6574  l_selection, met
+000882c0: 7269 6373 2020 2023 4164 6469 7469 6f6e  rics   #Addition
+000882d0: 616c 2073 6b6c 6561 726e 2066 756e 6374  al sklearn funct
+000882e0: 696f 6e73 0d0a 6672 6f6d 2073 6b6c 6561  ions..from sklea
+000882f0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00088300: 7420 6163 6375 7261 6379 5f73 636f 7265  t accuracy_score
+00088310: 2c66 315f 7363 6f72 652c 726f 635f 6175  ,f1_score,roc_au
+00088320: 635f 7363 6f72 652c 6c6f 675f 6c6f 7373  c_score,log_loss
+00088330: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00088340: 6574 7269 6373 2069 6d70 6f72 7420 6d65  etrics import me
+00088350: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00088360: 2c6d 6564 6961 6e5f 6162 736f 6c75 7465  ,median_absolute
+00088370: 5f65 7272 6f72 2c6d 6561 6e5f 6162 736f  _error,mean_abso
+00088380: 6c75 7465 5f65 7272 6f72 0d0a 6672 6f6d  lute_error..from
+00088390: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+000883a0: 2069 6d70 6f72 7420 636c 6173 7369 6669   import classifi
+000883b0: 6361 7469 6f6e 5f72 6570 6f72 742c 2063  cation_report, c
+000883c0: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
+000883d0: 6d65 616e 5f73 7175 6172 6564 5f6c 6f67  mean_squared_log
+000883e0: 5f65 7272 6f72 0d0a 6672 6f6d 2073 6b6c  _error..from skl
+000883f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
+00088400: 6f72 7420 7072 6563 6973 696f 6e5f 7265  ort precision_re
+00088410: 6361 6c6c 5f63 7572 7665 0d0a 6672 6f6d  call_curve..from
+00088420: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00088430: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00088440: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00088450: 2053 7472 6174 6966 6965 644b 466f 6c64   StratifiedKFold
+00088460: 2c20 4b46 6f6c 640d 0a66 726f 6d20 736b  , KFold..from sk
+00088470: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+00088480: 706f 7274 206d 616b 655f 7363 6f72 6572  port make_scorer
+00088490: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+000884a0: 6574 7269 6373 2069 6d70 6f72 7420 6163  etrics import ac
+000884b0: 6375 7261 6379 5f73 636f 7265 2020 200d  curacy_score   .
+000884c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+000884d0: 7472 6963 7320 696d 706f 7274 2061 7665  trics import ave
+000884e0: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
+000884f0: 636f 7265 0d0a 6672 6f6d 2073 6b6c 6561  core..from sklea
+00088500: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+00088510: 7420 6631 5f73 636f 7265 0d0a 6672 6f6d  t f1_score..from
+00088520: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+00088530: 2069 6d70 6f72 7420 6c6f 675f 6c6f 7373   import log_loss
+00088540: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+00088550: 6574 7269 6373 2069 6d70 6f72 7420 7072  etrics import pr
+00088560: 6563 6973 696f 6e5f 7363 6f72 650d 0a66  ecision_score..f
+00088570: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00088580: 6963 7320 696d 706f 7274 2072 6563 616c  ics import recal
+00088590: 6c5f 7363 6f72 650d 0a66 726f 6d20 736b  l_score..from sk
+000885a0: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+000885b0: 706f 7274 2072 6f63 5f61 7563 5f73 636f  port roc_auc_sco
+000885c0: 7265 0d0a 6672 6f6d 2073 6b6c 6561 726e  re..from sklearn
+000885d0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+000885e0: 6662 6574 615f 7363 6f72 650d 0a23 2323  fbeta_score..###
+000885f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088640: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
+00088650: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+00088660: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+00088670: 0d0a 6465 6620 6261 6c61 6e63 6564 5f61  ..def balanced_a
+00088680: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
+00088690: 7472 7565 2c20 795f 7072 6564 2c20 7361  true, y_pred, sa
+000886a0: 6d70 6c65 5f77 6569 6768 743d 4e6f 6e65  mple_weight=None
+000886b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000886c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000886d0: 646a 7573 7465 643d 4661 6c73 6529 3a0d  djusted=False):.
+000886e0: 0a20 2020 2043 203d 2063 6f6e 6675 7369  .    C = confusi
+000886f0: 6f6e 5f6d 6174 7269 7828 795f 7472 7565  on_matrix(y_true
+00088700: 2c20 795f 7072 6564 2c20 7361 6d70 6c65  , y_pred, sample
+00088710: 5f77 6569 6768 743d 7361 6d70 6c65 5f77  _weight=sample_w
+00088720: 6569 6768 7429 0d0a 2020 2020 7769 7468  eight)..    with
+00088730: 206e 702e 6572 7273 7461 7465 2864 6976   np.errstate(div
+00088740: 6964 653d 2769 676e 6f72 6527 2c20 696e  ide='ignore', in
+00088750: 7661 6c69 643d 2769 676e 6f72 6527 293a  valid='ignore'):
+00088760: 0d0a 2020 2020 2020 2020 7065 725f 636c  ..        per_cl
+00088770: 6173 7320 3d20 6e70 2e64 6961 6728 4329  ass = np.diag(C)
+00088780: 202f 2043 2e73 756d 2861 7869 733d 3129   / C.sum(axis=1)
+00088790: 0d0a 2020 2020 6966 206e 702e 616e 7928  ..    if np.any(
+000887a0: 6e70 2e69 736e 616e 2870 6572 5f63 6c61  np.isnan(per_cla
+000887b0: 7373 2929 3a0d 0a20 2020 2020 2020 2077  ss)):..        w
+000887c0: 6172 6e69 6e67 732e 7761 726e 2827 795f  arnings.warn('y_
+000887d0: 7072 6564 2063 6f6e 7461 696e 7320 636c  pred contains cl
+000887e0: 6173 7365 7320 6e6f 7420 696e 2079 5f74  asses not in y_t
+000887f0: 7275 6527 290d 0a20 2020 2020 2020 2070  rue')..        p
+00088800: 6572 5f63 6c61 7373 203d 2070 6572 5f63  er_class = per_c
+00088810: 6c61 7373 5b7e 6e70 2e69 736e 616e 2870  lass[~np.isnan(p
+00088820: 6572 5f63 6c61 7373 295d 0d0a 2020 2020  er_class)]..    
+00088830: 7363 6f72 6520 3d20 6e70 2e6d 6561 6e28  score = np.mean(
+00088840: 7065 725f 636c 6173 7329 0d0a 2020 2020  per_class)..    
+00088850: 6966 2061 646a 7573 7465 643a 0d0a 2020  if adjusted:..  
+00088860: 2020 2020 2020 6e5f 636c 6173 7365 7320        n_classes 
+00088870: 3d20 6c65 6e28 7065 725f 636c 6173 7329  = len(per_class)
+00088880: 0d0a 2020 2020 2020 2020 6368 616e 6365  ..        chance
+00088890: 203d 2031 202f 206e 5f63 6c61 7373 6573   = 1 / n_classes
+000888a0: 0d0a 2020 2020 2020 2020 7363 6f72 6520  ..        score 
+000888b0: 2d3d 2063 6861 6e63 650d 0a20 2020 2020  -= chance..     
+000888c0: 2020 2073 636f 7265 202f 3d20 3120 2d20     score /= 1 - 
+000888d0: 6368 616e 6365 0d0a 2020 2020 7265 7475  chance..    retu
+000888e0: 726e 2073 636f 7265 0d0a 2323 2323 2323  rn score..######
+000888f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088930: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00088940: 0a64 6566 2061 6363 7528 7265 7375 6c74  .def accu(result
+00088950: 732c 2079 5f63 7629 3a0d 0a20 2020 2072  s, y_cv):..    r
+00088960: 6574 7572 6e20 2872 6573 756c 7473 3d3d  eturn (results==
+00088970: 795f 6376 292e 6173 7479 7065 2869 6e74  y_cv).astype(int
+00088980: 292e 7375 6d28 6178 6973 3d30 292f 2879  ).sum(axis=0)/(y
+00088990: 5f63 762e 7368 6170 655b 305d 290d 0a64  _cv.shape[0])..d
+000889a0: 6566 2072 6d73 6528 7265 7375 6c74 732c  ef rmse(results,
+000889b0: 2079 5f63 7629 3a0d 0a20 2020 2072 6574   y_cv):..    ret
+000889c0: 7572 6e20 6e70 2e73 7172 7428 6e70 2e6d  urn np.sqrt(np.m
+000889d0: 6561 6e28 2872 6573 756c 7473 202d 2079  ean((results - y
+000889e0: 5f63 7629 2a2a 322c 2061 7869 733d 3029  _cv)**2, axis=0)
+000889f0: 290d 0a23 2323 2323 2323 2320 4465 6669  )..######## Defi
+00088a00: 6e69 6e67 206f 626a 6563 7469 7665 2066  ning objective f
+00088a10: 756e 6374 696f 6e73 2066 6f72 2048 7970  unctions for Hyp
+00088a20: 6572 4f70 7420 6865 7265 2023 2323 2323  erOpt here #####
+00088a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00088a40: 230d 0a23 2323 206b 6565 7020 616c 6c20  #..### keep all 
+00088a50: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
+00088a60: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+00088a70: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
+00088a80: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
+00088a90: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
+00088aa0: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
+00088ab0: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
+00088ac0: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
+00088ad0: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
+00088ae0: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
+00088af0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
+00088b00: 2061 6e79 7469 6d65 210d 0a64 6566 2067   anytime!..def g
+00088b10: 696e 6928 7472 7574 682c 2070 7265 6469  ini(truth, predi
+00088b20: 6374 696f 6e73 293a 0d0a 2020 2020 6720  ctions):..    g 
+00088b30: 3d20 6e70 2e61 7361 7272 6179 286e 702e  = np.asarray(np.
+00088b40: 635f 5b74 7275 7468 2c20 7072 6564 6963  c_[truth, predic
+00088b50: 7469 6f6e 732c 206e 702e 6172 616e 6765  tions, np.arange
+00088b60: 286c 656e 2874 7275 7468 2929 205d 2c20  (len(truth)) ], 
+00088b70: 6474 7970 653d 6e70 2e66 6c6f 6174 290d  dtype=np.float).
+00088b80: 0a20 2020 2067 203d 2067 5b6e 702e 6c65  .    g = g[np.le
+00088b90: 7873 6f72 7428 2867 5b3a 2c32 5d2c 202d  xsort((g[:,2], -
+00088ba0: 312a 675b 3a2c 315d 2929 5d0d 0a20 2020  1*g[:,1]))]..   
+00088bb0: 2067 7320 3d20 675b 3a2c 305d 2e63 756d   gs = g[:,0].cum
+00088bc0: 7375 6d28 292e 7375 6d28 2920 2f20 675b  sum().sum() / g[
+00088bd0: 3a2c 305d 2e73 756d 2829 0d0a 2020 2020  :,0].sum()..    
+00088be0: 6773 202d 3d20 286c 656e 2874 7275 7468  gs -= (len(truth
+00088bf0: 2920 2b20 3129 202f 2032 2e0d 0a20 2020  ) + 1) / 2...   
+00088c00: 2072 6574 7572 6e20 6773 202f 206c 656e   return gs / len
+00088c10: 2874 7275 7468 290d 0a0d 0a64 6566 2067  (truth)....def g
+00088c20: 696e 695f 736b 6c65 6172 6e28 7472 7574  ini_sklearn(trut
+00088c30: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088c40: 0d0a 2020 2020 7265 7475 726e 2067 696e  ..    return gin
+00088c50: 6928 7472 7574 682c 2070 7265 6469 6374  i(truth, predict
+00088c60: 696f 6e73 2920 2f20 6769 6e69 2874 7275  ions) / gini(tru
+00088c70: 7468 2c20 7472 7574 6829 0d0a 0d0a 6465  th, truth)....de
+00088c80: 6620 6769 6e69 5f6d 6561 6528 7472 7574  f gini_meae(trut
+00088c90: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088ca0: 0d0a 2020 2020 7363 6f72 6520 3d20 6d65  ..    score = me
+00088cb0: 6469 616e 5f61 6273 6f6c 7574 655f 6572  dian_absolute_er
+00088cc0: 726f 7228 7472 7574 682c 2070 7265 6469  ror(truth, predi
+00088cd0: 6374 696f 6e73 290d 0a20 2020 2072 6574  ctions)..    ret
+00088ce0: 7572 6e20 7363 6f72 650d 0a0d 0a64 6566  urn score....def
+00088cf0: 2067 696e 695f 6d73 6c65 2874 7275 7468   gini_msle(truth
+00088d00: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00088d10: 0a20 2020 2073 636f 7265 203d 206e 702e  .    score = np.
+00088d20: 7371 7274 286d 6561 6e5f 7371 7561 7265  sqrt(mean_square
+00088d30: 645f 6c6f 675f 6572 726f 7228 7472 7574  d_log_error(trut
+00088d40: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
+00088d50: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
+00088d60: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f6d  re....def gini_m
+00088d70: 6165 2874 7275 7468 2c20 7072 6564 6963  ae(truth, predic
+00088d80: 7469 6f6e 7329 3a0d 0a20 2020 2073 636f  tions):..    sco
+00088d90: 7265 203d 206d 6561 6e5f 6162 736f 6c75  re = mean_absolu
+00088da0: 7465 5f65 7272 6f72 2874 7275 7468 2c20  te_error(truth, 
+00088db0: 7072 6564 6963 7469 6f6e 7329 0d0a 2020  predictions)..  
+00088dc0: 2020 7265 7475 726e 2073 636f 7265 0d0a    return score..
+00088dd0: 0d0a 6465 6620 6769 6e69 5f6d 7365 2874  ..def gini_mse(t
+00088de0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+00088df0: 7329 3a0d 0a20 2020 2073 636f 7265 203d  s):..    score =
+00088e00: 206e 702e 7371 7274 286d 6561 6e5f 7371   np.sqrt(mean_sq
+00088e10: 7561 7265 645f 6572 726f 7228 7472 7574  uared_error(trut
+00088e20: 682c 2070 7265 6469 6374 696f 6e73 2929  h, predictions))
+00088e30: 0d0a 2020 2020 7265 7475 726e 2073 636f  ..    return sco
+00088e40: 7265 0d0a 0d0a 6465 6620 6769 6e69 5f72  re....def gini_r
+00088e50: 6d73 6528 7472 7574 682c 2070 7265 6469  mse(truth, predi
+00088e60: 6374 696f 6e73 293a 0d0a 2020 2020 7363  ctions):..    sc
+00088e70: 6f72 6520 3d20 6e70 2e73 7172 7428 6d65  ore = np.sqrt(me
+00088e80: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00088e90: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00088ea0: 6f6e 7329 290d 0a20 2020 2072 6574 7572  ons))..    retur
+00088eb0: 6e20 7363 6f72 650d 0a0d 0a64 6566 2067  n score....def g
+00088ec0: 696e 695f 6163 6375 7261 6379 2874 7275  ini_accuracy(tru
+00088ed0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+00088ee0: 3a0d 0a20 2020 2072 6574 7572 6e20 312d  :..    return 1-
+00088ef0: 6163 6375 7261 6379 5f73 636f 7265 2874  accuracy_score(t
+00088f00: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+00088f10: 7329 0d0a 0d0a 6465 6620 6769 6e69 5f62  s)....def gini_b
+00088f20: 616c 5f61 6363 7572 6163 7928 7472 7574  al_accuracy(trut
+00088f30: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00088f40: 0d0a 2020 2020 7265 7475 726e 2031 2d62  ..    return 1-b
+00088f50: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
+00088f60: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00088f70: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
+00088f80: 6620 6769 6e69 5f72 6f63 2874 7275 7468  f gini_roc(truth
+00088f90: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00088fa0: 0a20 2020 2072 6574 7572 6e20 312d 726f  .    return 1-ro
+00088fb0: 635f 6175 635f 7363 6f72 6528 7472 7574  c_auc_score(trut
+00088fc0: 682c 2070 7265 6469 6374 696f 6e73 290d  h, predictions).
+00088fd0: 0a0d 0a64 6566 2067 696e 695f 7072 6563  ...def gini_prec
+00088fe0: 6973 696f 6e28 7472 7574 682c 2070 7265  ision(truth, pre
+00088ff0: 6469 6374 696f 6e73 2c70 6f73 5f6c 6162  dictions,pos_lab
+00089000: 656c 3d31 293a 0d0a 2020 2020 7265 7475  el=1):..    retu
+00089010: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
+00089020: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+00089030: 6963 7469 6f6e 7329 0d0a 0d0a 6465 6620  ictions)....def 
+00089040: 6769 6e69 5f61 7665 7261 6765 5f70 7265  gini_average_pre
+00089050: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
+00089060: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00089070: 2072 6574 7572 6e20 312d 6176 6572 6167   return 1-averag
+00089080: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
+00089090: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+000890a0: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+000890b0: 3d31 292c 6176 6572 6167 653d 2777 6569  =1),average='wei
+000890c0: 6768 7465 6427 290d 0a0d 0a64 6566 2067  ghted')....def g
+000890d0: 696e 695f 7765 6967 6874 6564 5f70 7265  ini_weighted_pre
+000890e0: 6369 7369 6f6e 2874 7275 7468 2c20 7072  cision(truth, pr
+000890f0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00089100: 2072 6574 7572 6e20 312d 7072 6563 6973   return 1-precis
+00089110: 696f 6e5f 7363 6f72 6528 7472 7574 682c  ion_score(truth,
+00089120: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
+00089130: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
+00089140: 6167 653d 2777 6569 6768 7465 6427 290d  age='weighted').
+00089150: 0a0d 0a64 6566 2067 696e 695f 6d61 6372  ...def gini_macr
+00089160: 6f5f 7072 6563 6973 696f 6e28 7472 7574  o_precision(trut
+00089170: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
+00089180: 0d0a 2020 2020 7265 7475 726e 2031 2d70  ..    return 1-p
+00089190: 7265 6369 7369 6f6e 5f73 636f 7265 2874  recision_score(t
+000891a0: 7275 7468 2c20 7072 6564 6963 7469 6f6e  ruth, prediction
+000891b0: 732e 6172 676d 6178 2861 7869 733d 3129  s.argmax(axis=1)
+000891c0: 2c61 7665 7261 6765 3d27 6d61 6372 6f27  ,average='macro'
+000891d0: 290d 0a0d 0a64 6566 2067 696e 695f 6d69  )....def gini_mi
+000891e0: 6372 6f5f 7072 6563 6973 696f 6e28 7472  cro_precision(tr
+000891f0: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
+00089200: 293a 0d0a 2020 2020 7265 7475 726e 2031  ):..    return 1
+00089210: 2d70 7265 6369 7369 6f6e 5f73 636f 7265  -precision_score
+00089220: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00089230: 6f6e 732e 6172 676d 6178 2861 7869 733d  ons.argmax(axis=
+00089240: 3129 2c61 7665 7261 6765 3d27 6d69 6372  1),average='micr
+00089250: 6f27 290d 0a0d 0a64 6566 2067 696e 695f  o')....def gini_
+00089260: 7361 6d70 6c65 735f 7072 6563 6973 696f  samples_precisio
+00089270: 6e28 7472 7574 682c 2070 7265 6469 6374  n(truth, predict
+00089280: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00089290: 726e 2031 2d70 7265 6369 7369 6f6e 5f73  rn 1-precision_s
+000892a0: 636f 7265 2874 7275 7468 2c20 7072 6564  core(truth, pred
+000892b0: 6963 7469 6f6e 732e 6172 676d 6178 2861  ictions.argmax(a
+000892c0: 7869 733d 3129 2c61 7665 7261 6765 3d27  xis=1),average='
+000892d0: 7361 6d70 6c65 7327 290d 0a0d 0a64 6566  samples')....def
+000892e0: 2067 696e 695f 6631 2874 7275 7468 2c20   gini_f1(truth, 
+000892f0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+00089300: 2020 2072 6574 7572 6e20 312d 6631 5f73     return 1-f1_s
+00089310: 636f 7265 2874 7275 7468 2c70 7265 6469  core(truth,predi
+00089320: 6374 696f 6e73 290d 0a0d 0a64 6566 2067  ctions)....def g
+00089330: 696e 695f 7765 6967 6874 6564 5f66 3128  ini_weighted_f1(
+00089340: 7472 7574 682c 2070 7265 6469 6374 696f  truth, predictio
+00089350: 6e73 293a 0d0a 2020 2020 7265 7475 726e  ns):..    return
+00089360: 2031 2d66 315f 7363 6f72 6528 7472 7574   1-f1_score(trut
+00089370: 682c 2070 7265 6469 6374 696f 6e73 2e61  h, predictions.a
+00089380: 7267 6d61 7828 6178 6973 3d31 292c 6176  rgmax(axis=1),av
+00089390: 6572 6167 653d 2777 6569 6768 7465 6427  erage='weighted'
+000893a0: 290d 0a0d 0a64 6566 2067 696e 695f 6d61  )....def gini_ma
+000893b0: 6372 6f5f 6631 2874 7275 7468 2c20 7072  cro_f1(truth, pr
+000893c0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+000893d0: 2072 6574 7572 6e20 312d 6631 5f73 636f   return 1-f1_sco
+000893e0: 7265 2874 7275 7468 2c20 7072 6564 6963  re(truth, predic
+000893f0: 7469 6f6e 732e 6172 676d 6178 2861 7869  tions.argmax(axi
+00089400: 733d 3129 2c61 7665 7261 6765 3d27 6d61  s=1),average='ma
+00089410: 6372 6f27 290d 0a0d 0a64 6566 2067 696e  cro')....def gin
+00089420: 695f 6d69 6372 6f5f 6631 2874 7275 7468  i_micro_f1(truth
+00089430: 2c20 7072 6564 6963 7469 6f6e 7329 3a0d  , predictions):.
+00089440: 0a20 2020 2072 6574 7572 6e20 312d 6631  .    return 1-f1
+00089450: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00089460: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
+00089470: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
+00089480: 3d27 6d69 6372 6f27 290d 0a0d 0a64 6566  ='micro')....def
+00089490: 2067 696e 695f 7361 6d70 6c65 735f 6631   gini_samples_f1
+000894a0: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+000894b0: 6f6e 7329 3a0d 0a20 2020 2072 6574 7572  ons):..    retur
+000894c0: 6e20 312d 6631 5f73 636f 7265 2874 7275  n 1-f1_score(tru
+000894d0: 7468 2c20 7072 6564 6963 7469 6f6e 732e  th, predictions.
+000894e0: 6172 676d 6178 2861 7869 733d 3129 2c61  argmax(axis=1),a
+000894f0: 7665 7261 6765 3d27 7361 6d70 6c65 7327  verage='samples'
+00089500: 290d 0a0d 0a64 6566 2067 696e 695f 6c6f  )....def gini_lo
+00089510: 675f 6c6f 7373 2874 7275 7468 2c20 7072  g_loss(truth, pr
+00089520: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00089530: 2072 6574 7572 6e20 6c6f 675f 6c6f 7373   return log_loss
+00089540: 2874 7275 7468 2c20 7072 6564 6963 7469  (truth, predicti
+00089550: 6f6e 732c 6e6f 726d 616c 697a 653d 5472  ons,normalize=Tr
+00089560: 7565 290d 0a0d 0a64 6566 2067 696e 695f  ue)....def gini_
+00089570: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+00089580: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+00089590: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
+000895a0: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+000895b0: 6564 6963 7469 6f6e 7329 0d0a 0d0a 6465  edictions)....de
+000895c0: 6620 6769 6e69 5f77 6569 6768 7465 645f  f gini_weighted_
+000895d0: 7265 6361 6c6c 2874 7275 7468 2c20 7072  recall(truth, pr
+000895e0: 6564 6963 7469 6f6e 7329 3a0d 0a20 2020  edictions):..   
+000895f0: 2072 6574 7572 6e20 312d 7265 6361 6c6c   return 1-recall
+00089600: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+00089610: 6564 6963 7469 6f6e 732e 6172 676d 6178  edictions.argmax
+00089620: 2861 7869 733d 3129 2c61 7665 7261 6765  (axis=1),average
+00089630: 3d27 7765 6967 6874 6564 2729 0d0a 0d0a  ='weighted')....
+00089640: 6465 6620 6769 6e69 5f73 616d 706c 6573  def gini_samples
+00089650: 5f72 6563 616c 6c28 7472 7574 682c 2070  _recall(truth, p
+00089660: 7265 6469 6374 696f 6e73 293a 0d0a 2020  redictions):..  
+00089670: 2020 7265 7475 726e 2031 2d72 6563 616c    return 1-recal
+00089680: 6c5f 7363 6f72 6528 7472 7574 682c 2070  l_score(truth, p
+00089690: 7265 6469 6374 696f 6e73 2e61 7267 6d61  redictions.argma
+000896a0: 7828 6178 6973 3d31 292c 6176 6572 6167  x(axis=1),averag
+000896b0: 653d 2773 616d 706c 6573 2729 0d0a 0d0a  e='samples')....
+000896c0: 6465 6620 6769 6e69 5f6d 6163 726f 5f72  def gini_macro_r
+000896d0: 6563 616c 6c28 7472 7574 682c 2070 7265  ecall(truth, pre
+000896e0: 6469 6374 696f 6e73 293a 0d0a 2020 2020  dictions):..    
+000896f0: 7265 7475 726e 2031 2d72 6563 616c 6c5f  return 1-recall_
+00089700: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
+00089710: 6469 6374 696f 6e73 2e61 7267 6d61 7828  dictions.argmax(
+00089720: 6178 6973 3d31 292c 6176 6572 6167 653d  axis=1),average=
+00089730: 276d 6163 726f 2729 0d0a 0d0a 6465 6620  'macro')....def 
+00089740: 6769 6e69 5f6d 6963 726f 5f72 6563 616c  gini_micro_recal
+00089750: 6c28 7472 7574 682c 2070 7265 6469 6374  l(truth, predict
+00089760: 696f 6e73 293a 0d0a 2020 2020 7265 7475  ions):..    retu
+00089770: 726e 2031 2d72 6563 616c 6c5f 7363 6f72  rn 1-recall_scor
+00089780: 6528 7472 7574 682c 2070 7265 6469 6374  e(truth, predict
+00089790: 696f 6e73 2e61 7267 6d61 7828 6178 6973  ions.argmax(axis
+000897a0: 3d31 292c 6176 6572 6167 653d 276d 6963  =1),average='mic
+000897b0: 726f 2729 0d0a 0d0a 6465 6620 6769 6e69  ro')....def gini
+000897c0: 5f72 6f63 5f61 7563 2874 7275 7468 2c20  _roc_auc(truth, 
+000897d0: 7072 6564 6963 7469 6f6e 7329 3a0d 0a20  predictions):.. 
+000897e0: 2020 2072 6574 7572 6e20 312d 726f 635f     return 1-roc_
+000897f0: 6175 635f 7363 6f72 6528 7472 7574 682c  auc_score(truth,
+00089800: 2070 7265 6469 6374 696f 6e73 2e61 7267   predictions.arg
+00089810: 6d61 7828 6178 6973 3d31 292c 6176 6572  max(axis=1),aver
+00089820: 6167 653d 276d 6163 726f 2729 0d0a 2320  age='macro')..# 
+00089830: 6361 6c63 756c 6174 6520 6632 2d6d 6561  calculate f2-mea
+00089840: 7375 7265 0d0a 6465 6620 6632 5f6d 6561  sure..def f2_mea
+00089850: 7375 7265 2879 5f74 7275 652c 2079 5f70  sure(y_true, y_p
+00089860: 7265 6429 3a0d 0a20 2020 2072 6574 7572  red):..    retur
+00089870: 6e20 6662 6574 615f 7363 6f72 6528 795f  n fbeta_score(y_
+00089880: 7472 7565 2c20 795f 7072 6564 2c20 6265  true, y_pred, be
+00089890: 7461 3d32 290d 0a23 2323 206b 6565 7020  ta=2)..### keep 
+000898a0: 616c 6c20 5265 6772 6573 7369 6f6e 2053  all Regression S
+000898b0: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+000898c0: 735f 6265 7474 6572 2054 7275 6520 7369  s_better True si
+000898d0: 6e63 6520 6974 206c 6561 7665 7320 7468  nce it leaves th
+000898e0: 656d 2061 7320 6973 2061 6e64 206d 696e  em as is and min
+000898f0: 696d 697a 6573 2074 6865 6d0d 0a6d 6561  imizes them..mea
+00089900: 655f 7363 6f72 6572 203d 206d 616b 655f  e_scorer = make_
+00089910: 7363 6f72 6572 2867 696e 695f 6d65 6165  scorer(gini_meae
+00089920: 2c20 6772 6561 7465 725f 6973 5f62 6574  , greater_is_bet
+00089930: 7465 723d 5472 7565 290d 0a6d 736c 655f  ter=True)..msle_
+00089940: 7363 6f72 6572 203d 206d 616b 655f 7363  scorer = make_sc
+00089950: 6f72 6572 2867 696e 695f 6d73 6c65 2c20  orer(gini_msle, 
+00089960: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+00089970: 723d 5472 7565 290d 0a6d 6165 5f73 636f  r=True)..mae_sco
+00089980: 7265 7220 3d20 6d61 6b65 5f73 636f 7265  rer = make_score
+00089990: 7228 6769 6e69 5f6d 6165 2c20 6772 6561  r(gini_mae, grea
+000899a0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+000899b0: 7565 290d 0a6d 7365 5f73 636f 7265 7220  ue)..mse_scorer 
+000899c0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+000899d0: 6e69 5f6d 7365 2c20 6772 6561 7465 725f  ni_mse, greater_
+000899e0: 6973 5f62 6574 7465 723d 5472 7565 290d  is_better=True).
+000899f0: 0a0d 0a23 2323 206b 6565 7020 616c 6c20  ...### keep all 
+00089a00: 436c 6173 7369 6669 6361 7469 6f6e 2053  Classification S
+00089a10: 636f 7265 7273 2067 7265 6174 6572 5f69  corers greater_i
+00089a20: 735f 6265 7474 6572 2054 7275 6520 6275  s_better True bu
+00089a30: 7420 7375 6274 7261 6374 2073 636f 7265  t subtract score
+00089a40: 7220 6672 6f6d 2031 2073 6f20 6974 2064  r from 1 so it d
+00089a50: 696d 696e 6973 6865 732e 0d0a 2323 2323  iminishes...####
+00089a60: 2054 6869 7320 6973 2074 6865 206f 6e6c   This is the onl
+00089a70: 7920 7761 7920 4879 7065 724f 7074 2077  y way HyperOpt w
+00089a80: 696c 6c20 6669 6e64 2074 6865 206d 696e  ill find the min
+00089a90: 696d 756d 202d 2073 6f20 646f 6e27 7420  imum - so don't 
+00089aa0: 6368 616e 6765 2074 6869 7320 636f 6465  change this code
+00089ab0: 2061 6e79 7469 6d65 210d 0a61 6363 7572   anytime!..accur
+00089ac0: 6163 795f 7363 6f72 6572 203d 206d 616b  acy_scorer = mak
+00089ad0: 655f 7363 6f72 6572 2867 696e 695f 6163  e_scorer(gini_ac
+00089ae0: 6375 7261 6379 2c20 6772 6561 7465 725f  curacy, greater_
+00089af0: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+00089b00: 6e65 6564 735f 7072 6f62 613d 4661 6c73  needs_proba=Fals
+00089b10: 6529 0d0a 6261 6c5f 6163 6375 7261 6379  e)..bal_accuracy
+00089b20: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+00089b30: 636f 7265 7228 6769 6e69 5f62 616c 5f61  corer(gini_bal_a
+00089b40: 6363 7572 6163 792c 2067 7265 6174 6572  ccuracy, greater
+00089b50: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00089b60: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
+00089b70: 7365 290d 0a0d 0a67 696e 695f 7363 6f72  se)....gini_scor
+00089b80: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+00089b90: 2867 696e 695f 736b 6c65 6172 6e2c 2067  (gini_sklearn, g
+00089ba0: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+00089bb0: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
+00089bc0: 6261 3d54 7275 6529 0d0a 726f 635f 7363  ba=True)..roc_sc
+00089bd0: 6f72 6572 203d 206d 616b 655f 7363 6f72  orer = make_scor
+00089be0: 6572 2867 696e 695f 726f 632c 2067 7265  er(gini_roc, gre
+00089bf0: 6174 6572 5f69 735f 6265 7474 6572 3d54  ater_is_better=T
+00089c00: 7275 652c 206e 6565 6473 5f70 726f 6261  rue, needs_proba
+00089c10: 3d54 7275 6529 0d0a 0d0a 7072 6563 6973  =True)....precis
+00089c20: 696f 6e5f 7363 6f72 6572 203d 206d 616b  ion_scorer = mak
+00089c30: 655f 7363 6f72 6572 2867 696e 695f 7072  e_scorer(gini_pr
+00089c40: 6563 6973 696f 6e2c 2067 7265 6174 6572  ecision, greater
+00089c50: 5f69 735f 6265 7474 6572 3d54 7275 652c  _is_better=True,
+00089c60: 206e 6565 6473 5f70 726f 6261 3d46 616c   needs_proba=Fal
+00089c70: 7365 290d 0a61 7665 7261 6765 5f70 7265  se)..average_pre
+00089c80: 6369 7369 6f6e 5f73 636f 7265 7220 3d20  cision_scorer = 
+00089c90: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+00089ca0: 5f61 7665 7261 6765 5f70 7265 6369 7369  _average_precisi
+00089cb0: 6f6e 2c20 6772 6561 7465 725f 6973 5f62  on, greater_is_b
+00089cc0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
+00089cd0: 735f 7072 6f62 613d 5472 7565 290d 0a77  s_proba=True)..w
+00089ce0: 6569 6768 7465 645f 7072 6563 6973 696f  eighted_precisio
+00089cf0: 6e5f 7363 6f72 6572 203d 206d 616b 655f  n_scorer = make_
+00089d00: 7363 6f72 6572 2867 696e 695f 7765 6967  scorer(gini_weig
+00089d10: 6874 6564 5f70 7265 6369 7369 6f6e 2c20  hted_precision, 
+00089d20: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+00089d30: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+00089d40: 6f62 613d 5472 7565 290d 0a6d 6163 726f  oba=True)..macro
+00089d50: 5f70 7265 6369 7369 6f6e 5f73 636f 7265  _precision_score
+00089d60: 7220 3d20 6d61 6b65 5f73 636f 7265 7228  r = make_scorer(
+00089d70: 6769 6e69 5f6d 6163 726f 5f70 7265 6369  gini_macro_preci
+00089d80: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
+00089d90: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
+00089da0: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
+00089db0: 0a6d 6963 726f 5f70 7265 6369 7369 6f6e  .micro_precision
+00089dc0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+00089dd0: 636f 7265 7228 6769 6e69 5f6d 6963 726f  corer(gini_micro
+00089de0: 5f70 7265 6369 7369 6f6e 2c20 6772 6561  _precision, grea
+00089df0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+00089e00: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+00089e10: 5472 7565 290d 0a73 616d 706c 6573 5f70  True)..samples_p
+00089e20: 7265 6369 7369 6f6e 5f73 636f 7265 7220  recision_scorer 
+00089e30: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+00089e40: 6e69 5f73 616d 706c 6573 5f70 7265 6369  ni_samples_preci
+00089e50: 7369 6f6e 2c20 6772 6561 7465 725f 6973  sion, greater_is
+00089e60: 5f62 6574 7465 723d 5472 7565 2c20 6e65  _better=True, ne
+00089e70: 6564 735f 7072 6f62 613d 5472 7565 290d  eds_proba=True).
+00089e80: 0a0d 0a66 315f 7363 6f72 6572 203d 206d  ...f1_scorer = m
+00089e90: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+00089ea0: 6631 2c20 6772 6561 7465 725f 6973 5f62  f1, greater_is_b
+00089eb0: 6574 7465 723d 5472 7565 2c20 6e65 6564  etter=True, need
+00089ec0: 735f 7072 6f62 613d 4661 6c73 6529 0d0a  s_proba=False)..
+00089ed0: 7765 6967 6874 6564 5f66 315f 7363 6f72  weighted_f1_scor
+00089ee0: 6572 203d 206d 616b 655f 7363 6f72 6572  er = make_scorer
+00089ef0: 2867 696e 695f 7765 6967 6874 6564 5f66  (gini_weighted_f
+00089f00: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
+00089f10: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+00089f20: 5f70 726f 6261 3d54 7275 6529 0d0a 6d61  _proba=True)..ma
+00089f30: 6372 6f5f 6631 5f73 636f 7265 7220 3d20  cro_f1_scorer = 
+00089f40: 6d61 6b65 5f73 636f 7265 7228 6769 6e69  make_scorer(gini
+00089f50: 5f6d 6163 726f 5f66 312c 2067 7265 6174  _macro_f1, great
+00089f60: 6572 5f69 735f 6265 7474 6572 3d54 7275  er_is_better=Tru
+00089f70: 652c 206e 6565 6473 5f70 726f 6261 3d54  e, needs_proba=T
+00089f80: 7275 6529 0d0a 6d69 6372 6f5f 6631 5f73  rue)..micro_f1_s
+00089f90: 636f 7265 7220 3d20 6d61 6b65 5f73 636f  corer = make_sco
+00089fa0: 7265 7228 6769 6e69 5f6d 6963 726f 5f66  rer(gini_micro_f
+00089fb0: 312c 2067 7265 6174 6572 5f69 735f 6265  1, greater_is_be
+00089fc0: 7474 6572 3d54 7275 652c 206e 6565 6473  tter=True, needs
+00089fd0: 5f70 726f 6261 3d54 7275 6529 0d0a 7361  _proba=True)..sa
+00089fe0: 6d70 6c65 735f 6631 5f73 636f 7265 7220  mples_f1_scorer 
+00089ff0: 3d20 6d61 6b65 5f73 636f 7265 7228 6769  = make_scorer(gi
+0008a000: 6e69 5f73 616d 706c 6573 5f66 312c 2067  ni_samples_f1, g
+0008a010: 7265 6174 6572 5f69 735f 6265 7474 6572  reater_is_better
+0008a020: 3d54 7275 652c 206e 6565 6473 5f70 726f  =True, needs_pro
+0008a030: 6261 3d54 7275 6529 0d0a 0d0a 7265 6361  ba=True)....reca
+0008a040: 6c6c 5f73 636f 7265 7220 3d20 6d61 6b65  ll_scorer = make
+0008a050: 5f73 636f 7265 7228 6769 6e69 5f72 6563  _scorer(gini_rec
+0008a060: 616c 6c2c 2067 7265 6174 6572 5f69 735f  all, greater_is_
+0008a070: 6265 7474 6572 3d54 7275 652c 206e 6565  better=True, nee
+0008a080: 6473 5f70 726f 6261 3d46 616c 7365 290d  ds_proba=False).
+0008a090: 0a77 6569 6768 7465 645f 7265 6361 6c6c  .weighted_recall
+0008a0a0: 5f73 636f 7265 7220 3d20 6d61 6b65 5f73  _scorer = make_s
+0008a0b0: 636f 7265 7228 6769 6e69 5f77 6569 6768  corer(gini_weigh
+0008a0c0: 7465 645f 7265 6361 6c6c 2c20 6772 6561  ted_recall, grea
+0008a0d0: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+0008a0e0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+0008a0f0: 5472 7565 290d 0a6d 6163 726f 5f72 6563  True)..macro_rec
+0008a100: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
+0008a110: 655f 7363 6f72 6572 2867 696e 695f 6d61  e_scorer(gini_ma
+0008a120: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
+0008a130: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+0008a140: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+0008a150: 5472 7565 290d 0a6d 6963 726f 5f72 6563  True)..micro_rec
+0008a160: 616c 6c5f 7363 6f72 6572 203d 206d 616b  all_scorer = mak
+0008a170: 655f 7363 6f72 6572 2867 696e 695f 6d69  e_scorer(gini_mi
+0008a180: 6372 6f5f 7265 6361 6c6c 2c20 6772 6561  cro_recall, grea
+0008a190: 7465 725f 6973 5f62 6574 7465 723d 5472  ter_is_better=Tr
+0008a1a0: 7565 2c20 6e65 6564 735f 7072 6f62 613d  ue, needs_proba=
+0008a1b0: 5472 7565 290d 0a73 616d 706c 6573 5f72  True)..samples_r
+0008a1c0: 6563 616c 6c5f 7363 6f72 6572 203d 206d  ecall_scorer = m
+0008a1d0: 616b 655f 7363 6f72 6572 2867 696e 695f  ake_scorer(gini_
+0008a1e0: 7361 6d70 6c65 735f 7265 6361 6c6c 2c20  samples_recall, 
+0008a1f0: 6772 6561 7465 725f 6973 5f62 6574 7465  greater_is_bette
+0008a200: 723d 5472 7565 2c20 6e65 6564 735f 7072  r=True, needs_pr
+0008a210: 6f62 613d 5472 7565 290d 0a0d 0a72 6f63  oba=True)....roc
+0008a220: 5f61 7563 5f73 636f 7265 7220 3d20 6d61  _auc_scorer = ma
+0008a230: 6b65 5f73 636f 7265 7228 6769 6e69 5f72  ke_scorer(gini_r
+0008a240: 6f63 5f61 7563 2c20 6772 6561 7465 725f  oc_auc, greater_
+0008a250: 6973 5f62 6574 7465 723d 5472 7565 2c20  is_better=True, 
+0008a260: 6e65 6564 735f 7072 6f62 613d 5472 7565  needs_proba=True
+0008a270: 290d 0a23 2323 204c 6561 7665 2074 6865  )..### Leave the
+0008a280: 206c 6f67 2d6c 6f73 7320 7363 6f72 6572   log-loss scorer
+0008a290: 2061 7320 6772 6561 7465 725f 6973 5f62   as greater_is_b
+0008a2a0: 6574 7465 7220 5472 7565 2073 696e 6365  etter True since
+0008a2b0: 2069 7420 6b65 6570 7320 7369 676e 2061   it keeps sign a
+0008a2c0: 6e64 206d 696e 696d 697a 6573 2069 742e  nd minimizes it.
+0008a2d0: 0d0a 6c6f 676c 6f73 735f 7363 6f72 6572  ..logloss_scorer
+0008a2e0: 203d 206d 616b 655f 7363 6f72 6572 2867   = make_scorer(g
+0008a2f0: 696e 695f 6c6f 675f 6c6f 7373 2c20 6772  ini_log_loss, gr
+0008a300: 6561 7465 725f 6973 5f62 6574 7465 723d  eater_is_better=
+0008a310: 5472 7565 2c20 6e65 6564 735f 7072 6f62  True, needs_prob
+0008a320: 613d 5472 7565 290d 0a23 2323 2323 2323  a=True)..#######
+0008a330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008a340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008a350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008a360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008a370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008a380: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
 0008a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008a400: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0008a410: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
-0008a420: 7920 6173 206e 700d 0a23 2323 2323 2323  y as np..#######
-0008a430: 2323 204e 4557 2041 6e64 2046 4153 5420  ## NEW And FAST 
-0008a440: 5741 5920 746f 2041 4444 2046 6561 7475  WAY to ADD Featu
-0008a450: 7265 2045 6e67 6720 434f 4c55 4d4e 5320  re Engg COLUMNS 
-0008a460: 494e 2041 2044 4154 4120 5345 5420 2323  IN A DATA SET ##
-0008a470: 2323 2323 230d 0a23 2323 2020 204d 6f64  #####..###   Mod
-0008a480: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
-0008a490: 2061 6464 696e 6720 4665 6174 7572 6573   adding Features
-0008a4a0: 2075 7369 6e67 2046 6561 7475 7265 2054   using Feature T
-0008a4b0: 6f6f 6c73 2023 2323 230d 0a64 6566 2061  ools ####..def a
-0008a4c0: 6464 5f63 6f6d 7075 7461 7469 6f6e 616c  dd_computational
-0008a4d0: 5f70 7269 6d69 7469 7665 5f66 6561 7475  _primitive_featu
-0008a4e0: 7265 7328 2064 662c 2061 6464 5f74 7970  res( df, add_typ
-0008a4f0: 6573 3d5b 5d2c 2069 6463 6f6c 756d 6e3d  es=[], idcolumn=
-0008a500: 2727 293a 0d0a 2020 2020 2222 220d 0a20  ''):..    """.. 
-0008a510: 2020 2023 2323 2020 204d 6f64 6966 7920     ###   Modify 
-0008a520: 4461 7461 6672 616d 6520 6279 2061 6464  Dataframe by add
-0008a530: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
-0008a540: 6c20 7072 696d 6974 6976 6520 4665 6174  l primitive Feat
-0008a550: 7572 6573 2075 7369 6e67 2046 6561 7475  ures using Featu
-0008a560: 7265 2054 6f6f 6c73 2023 2323 230d 0a20  re Tools ####.. 
-0008a570: 2020 2023 2323 2020 2057 6861 7420 6172     ###   What ar
-0008a580: 6520 636f 6d70 7574 6174 696f 6e61 6c20  e computational 
-0008a590: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
-0008a5a0: 2061 7265 2074 6f20 6164 642c 2073 7562   are to add, sub
-0008a5b0: 7472 6163 742c 206d 756c 7469 706c 7920  tract, multiply 
-0008a5c0: 616e 6420 6469 7669 6465 2066 6561 7475  and divide featu
-0008a5d0: 7265 730d 0a20 2020 2023 2323 2049 6e70  res..    ### Inp
-0008a5e0: 7574 733a 0d0a 2020 2020 2323 2320 2020  uts:..    ###   
-0008a5f0: 6466 3a20 4a75 7374 2073 656e 7420 696e  df: Just sent in
-0008a600: 2074 6865 2064 6174 6120 6672 616d 6520   the data frame 
-0008a610: 6466 2074 6861 7420 796f 7520 7761 6e74  df that you want
-0008a620: 2066 6561 7475 7265 7320 6164 6465 6420   features added 
-0008a630: 746f 0d0a 2020 2020 2323 2320 2020 6164  to..    ###   ad
-0008a640: 645f 7479 7065 733a 206c 6973 7420 6f66  d_types: list of
-0008a650: 2063 6f6d 7075 7461 7469 6f6e 616c 2074   computational t
-0008a660: 7970 6573 3a20 2761 6464 272c 2027 7375  ypes: 'add', 'su
-0008a670: 6274 7261 6374 272c 2027 6d75 6c74 6970  btract', 'multip
-0008a680: 6c79 2720 616e 6420 2764 6976 6964 6527  ly' and 'divide'
-0008a690: 2e20 4368 6f6f 7365 2061 6e79 206f 7220  . Choose any or 
-0008a6a0: 616c 6c2e 0d0a 2020 2020 2323 2320 2020  all...    ###   
-0008a6b0: 6964 636f 6c75 6d6e 3a20 7468 6973 2069  idcolumn: this i
-0008a6c0: 7320 746f 2063 7265 6174 6520 616e 2069  s to create an i
-0008a6d0: 6e64 6578 2066 6f72 2074 6865 2064 6174  ndex for the dat
-0008a6e0: 6166 7261 6d65 2073 696e 6365 2046 5420  aframe since FT 
-0008a6f0: 7275 6e73 206f 6e20 696e 6465 7820 7661  runs on index va
-0008a700: 7269 6162 6c65 2e20 596f 7520 6361 6e20  riable. You can 
-0008a710: 6c65 6176 6520 6974 2065 6d70 7479 2073  leave it empty s
-0008a720: 7472 696e 672e 0d0a 2020 2020 2222 220d  tring...    """.
-0008a730: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-0008a740: 2020 2069 6d70 6f72 7420 6665 6174 7572     import featur
-0008a750: 6574 6f6f 6c73 2061 7320 6674 0d0a 2020  etools as ft..  
-0008a760: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-0008a770: 2020 2070 7269 6e74 2827 596f 7520 6d75     print('You mu
-0008a780: 7374 2069 6e73 7461 6c6c 2066 6561 7475  st install featu
-0008a790: 7265 746f 6f6c 7320 746f 2075 7365 2066  retools to use f
-0008a7a0: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
-0008a7b0: 6e67 2066 756e 6374 696f 6e73 2e20 496e  ng functions. In
-0008a7c0: 7374 616c 6c20 6974 2061 6e64 2074 7279  stall it and try
-0008a7d0: 2061 6761 696e 2e27 290d 0a20 2020 2064   again.')..    d
-0008a7e0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
-0008a7f0: 7928 6466 290d 0a20 2020 2070 726f 6a65  y(df)..    proje
-0008a800: 6374 6964 203d 2027 7072 6f6a 6563 745f  ctid = 'project_
-0008a810: 7072 6564 6963 7469 6f6e 270d 0a20 2020  prediction'..   
-0008a820: 2064 6174 6169 6420 3d20 2770 726f 6a65   dataid = 'proje
-0008a830: 6374 5f64 6174 6127 0d0a 2020 2020 6966  ct_data'..    if
-0008a840: 2069 6463 6f6c 756d 6e20 3d3d 2027 273a   idcolumn == '':
-0008a850: 0d0a 2020 2020 2020 2020 696e 6465 7869  ..        indexi
-0008a860: 6420 3d20 2769 6e64 6578 270d 0a20 2020  d = 'index'..   
-0008a870: 2020 2020 206d 616b 655f 696e 6465 7820       make_index 
-0008a880: 3d20 5472 7565 0d0a 2020 2020 656c 7365  = True..    else
-0008a890: 3a0d 0a20 2020 2020 2020 2069 6e64 6578  :..        index
-0008a8a0: 6964 203d 2069 6463 6f6c 756d 6e0d 0a20  id = idcolumn.. 
-0008a8b0: 2020 2020 2020 206d 616b 655f 696e 6465         make_inde
-0008a8c0: 783d 4661 6c73 650d 0a20 2020 2023 204d  x=False..    # M
-0008a8d0: 616b 6520 616e 2065 6e74 6974 7973 6574  ake an entityset
-0008a8e0: 2061 6e64 2061 6464 2074 6865 2065 6e74   and add the ent
-0008a8f0: 6974 790d 0a20 2020 2065 7320 3d20 6674  ity..    es = ft
-0008a900: 2e45 6e74 6974 7953 6574 2869 6420 3d20  .EntitySet(id = 
-0008a910: 7072 6f6a 6563 7469 6429 0d0a 2020 2020  projectid)..    
-0008a920: 6573 2e65 6e74 6974 795f 6672 6f6d 5f64  es.entity_from_d
-0008a930: 6174 6166 7261 6d65 2865 6e74 6974 795f  ataframe(entity_
-0008a940: 6964 203d 2064 6174 6169 642c 2064 6174  id = dataid, dat
-0008a950: 6166 7261 6d65 203d 2064 662c 0d0a 2020  aframe = df,..  
-0008a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a970: 2020 2020 2020 2020 2020 206d 616b 655f             make_
-0008a980: 696e 6465 7820 3d20 6d61 6b65 5f69 6e64  index = make_ind
-0008a990: 6578 2c20 696e 6465 7820 3d20 696e 6465  ex, index = inde
-0008a9a0: 7869 6429 0d0a 0d0a 2020 2020 2320 5275  xid)....    # Ru
-0008a9b0: 6e20 6465 6570 2066 6561 7475 7265 2073  n deep feature s
-0008a9c0: 796e 7468 6573 6973 2077 6974 6820 6769  ynthesis with gi
-0008a9d0: 7665 6e20 696e 7075 7420 7072 696d 6974  ven input primit
-0008a9e0: 6976 6573 206f 7220 6175 746f 6d61 7469  ives or automati
-0008a9f0: 6361 6c6c 7920 6465 6570 2032 0d0a 2020  cally deep 2..  
-0008aa00: 2020 6966 206c 656e 2861 6464 5f74 7970    if len(add_typ
-0008aa10: 6573 2920 3e20 303a 0d0a 2020 2020 2020  es) > 0:..      
-0008aa20: 2020 2323 2320 4275 696c 6420 4665 6174    ### Build Feat
-0008aa30: 7572 6573 2062 6173 6564 206f 6e20 6769  ures based on gi
-0008aa40: 7665 6e20 7072 696d 6974 6976 6520 7479  ven primitive ty
-0008aa50: 7065 732c 2061 6464 5f74 7970 6573 2077  pes, add_types w
-0008aa60: 6869 6368 2069 7320 6120 6c69 7374 0d0a  hich is a list..
-0008aa70: 2020 2020 2020 2020 6466 5f6d 6f64 2c20          df_mod, 
-0008aa80: 6665 6174 7572 655f 6465 6673 203d 2066  feature_defs = f
-0008aa90: 742e 6466 7328 656e 7469 7479 7365 7420  t.dfs(entityset 
-0008aaa0: 3d20 6573 2c20 7461 7267 6574 5f65 6e74  = es, target_ent
-0008aab0: 6974 7920 3d20 6461 7461 6964 2c0d 0a20  ity = dataid,.. 
-0008aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008aad0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0008aae0: 735f 7072 696d 6974 6976 6573 203d 2061  s_primitives = a
-0008aaf0: 6464 5f74 7970 6573 290d 0a20 2020 2065  dd_types)..    e
-0008ab00: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
-0008ab10: 2320 5065 7266 6f72 6d20 4465 6570 2046  # Perform Deep F
-0008ab20: 6561 7475 7265 2053 796e 7468 6573 6973  eature Synthesis
-0008ab30: 2041 7574 6f6d 6174 6963 616c 6c79 2066   Automatically f
-0008ab40: 6f72 2044 6570 7468 2032 0d0a 2020 2020  or Depth 2..    
-0008ab50: 2020 2020 6466 5f6d 6f64 2c20 6665 6174      df_mod, feat
-0008ab60: 7572 655f 6465 6673 203d 2066 742e 6466  ure_defs = ft.df
-0008ab70: 7328 656e 7469 7479 7365 743d 6573 2c20  s(entityset=es, 
-0008ab80: 7461 7267 6574 5f65 6e74 6974 7920 3d20  target_entity = 
-0008ab90: 6461 7461 6964 2c0d 0a20 2020 2020 2020  dataid,..       
-0008aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008abb0: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
-0008abc0: 203d 2032 2c20 6e5f 6a6f 6273 3d2d 312c   = 2, n_jobs=-1,
-0008abd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008abf0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
-0008ac00: 2020 6966 206d 616b 655f 696e 6465 783a    if make_index:
-0008ac10: 0d0a 2020 2020 2020 2020 6466 5f6d 6f64  ..        df_mod
-0008ac20: 203d 2064 665f 6d6f 642e 7265 7365 745f   = df_mod.reset_
-0008ac30: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
-0008ac40: 0d0a 2020 2020 7265 7475 726e 2064 665f  ..    return df_
-0008ac50: 6d6f 640d 0a0d 0a64 6566 2066 6561 7475  mod....def featu
-0008ac60: 7265 5f65 6e67 696e 6565 7269 6e67 2864  re_engineering(d
-0008ac70: 662c 2066 745f 7265 7175 6573 7473 2c20  f, ft_requests, 
-0008ac80: 6964 636f 6c29 3a0d 0a20 2020 2022 2222  idcol):..    """
-0008ac90: 0d0a 2020 2020 5468 6520 4665 6174 7572  ..    The Featur
-0008aca0: 6520 456e 6769 6e65 6572 696e 6720 6d6f  e Engineering mo
-0008acb0: 6475 6c65 206e 6565 6473 2046 6561 7475  dule needs Featu
-0008acc0: 7265 546f 6f6c 7320 696e 7374 616c 6c65  reTools installe
-0008acd0: 6420 746f 2077 6f72 6b2e 0d0a 2020 2020  d to work...    
-0008ace0: 536f 2070 6c65 6173 6520 646f 2022 7069  So please do "pi
-0008acf0: 7020 696e 7374 616c 6c20 6665 6174 7572  p install featur
-0008ad00: 6574 6f6f 6c73 2220 6265 666f 7265 2074  etools" before t
-0008ad10: 7279 696e 6720 6f75 7420 7468 6973 206d  rying out this m
-0008ad20: 6f64 756c 652e 0d0a 2020 2020 4974 2074  odule...    It t
-0008ad30: 616b 6573 2061 2067 6976 656e 2064 6174  akes a given dat
-0008ad40: 6120 7365 742c 2064 6620 616e 6420 6164  a set, df and ad
-0008ad50: 6473 2066 6561 7475 7265 7320 6261 7365  ds features base
-0008ad60: 6420 6f6e 2074 6865 2072 6571 7565 7420  d on the requet 
-0008ad70: 7479 7065 7320 696e 0d0a 2020 2020 6674  types in..    ft
-0008ad80: 5f72 6571 7565 7374 7320 7768 6963 6820  _requests which 
-0008ad90: 6361 6e20 6265 2027 6164 6427 2c27 7375  can be 'add','su
-0008ada0: 6274 7261 6374 272c 276d 756c 7469 706c  btract','multipl
-0008adb0: 7927 2c27 6469 7669 6465 272e 2049 6620  y','divide'. If 
-0008adc0: 796f 7520 6861 7665 0d0a 2020 2020 616e  you have..    an
-0008add0: 2069 645f 636f 6c75 6d6e 2069 6e20 7468   id_column in th
-0008ade0: 6520 6461 7461 2073 6574 2c20 796f 7520  e data set, you 
-0008adf0: 6361 6e20 7072 6f76 6964 6520 6974 2061  can provide it a
-0008ae00: 7320 6964 636f 6c20 2861 2073 7472 696e  s idcol (a strin
-0008ae10: 6720 7661 7269 6162 6c65 292e 0d0a 2020  g variable)...  
-0008ae20: 2020 4974 2077 696c 6c20 7265 7475 726e    It will return
-0008ae30: 2079 6f75 7220 6d6f 6469 6669 6564 2064   your modified d
-0008ae40: 6174 6173 6574 2077 6974 6820 2769 6463  ataset with 'idc
-0008ae50: 6f6c 2720 6173 2074 6865 2069 6e64 6578  ol' as the index
-0008ae60: 2e20 4d61 6b65 2073 7572 650d 0a20 2020  . Make sure..   
-0008ae70: 2079 6f75 2072 6573 6574 2074 6865 2069   you reset the i
-0008ae80: 6e64 6578 2069 6620 796f 7520 7761 6e74  ndex if you want
-0008ae90: 2074 6f20 7265 7475 726e 2069 7420 746f   to return it to
-0008aea0: 2069 7473 2066 6f72 6d65 7220 7374 6174   its former stat
-0008aeb0: 652e 0d0a 2020 2020 416c 736f 2064 6f20  e...    Also do 
-0008aec0: 6e6f 7420 7365 6e64 2069 6e20 796f 7572  not send in your
-0008aed0: 2065 6e74 6972 6520 6461 7461 6672 616d   entire datafram
-0008aee0: 6521 204a 7573 7420 7365 6e64 2061 2073  e! Just send a s
-0008aef0: 6d61 6c6c 2064 6174 6166 7261 6d65 2077  mall dataframe w
-0008af00: 6974 6820 6120 6665 7720 7661 7269 6162  ith a few variab
-0008af10: 6c65 732e 0d0a 2020 2020 4f6e 6365 2079  les...    Once y
-0008af20: 6f75 2073 6565 2068 6f77 2069 7420 6164  ou see how it ad
-0008af30: 6473 2074 6f20 7065 7266 6f72 6d61 6e63  ds to performanc
-0008af40: 6520 6f66 206d 6f64 656c 2c20 796f 7520  e of model, you 
-0008af50: 6361 6e20 6164 6420 6d6f 7265 2076 6172  can add more var
-0008af60: 6961 626c 6573 2074 6f20 6461 7461 6672  iables to datafr
-0008af70: 616d 652e 0d0a 2020 2020 2222 220d 0a20  ame...    """.. 
-0008af80: 2020 2064 6620 3d20 636f 7079 2e64 6565     df = copy.dee
-0008af90: 7063 6f70 7928 6466 290d 0a20 2020 2069  pcopy(df)..    i
-0008afa0: 6620 6466 2e73 6861 7065 5b31 5d20 3c20  f df.shape[1] < 
-0008afb0: 323a 0d0a 2020 2020 2020 2020 7072 696e  2:..        prin
-0008afc0: 7428 274d 6f72 6520 7468 616e 206f 6e65  t('More than one
-0008afd0: 2063 6f6c 756d 6e20 696e 2064 6174 6166   column in dataf
-0008afe0: 7261 6d65 2072 6571 7569 7265 6420 746f  rame required to
-0008aff0: 2070 6572 666f 726d 2066 6561 7475 7265   perform feature
-0008b000: 2065 6e67 696e 6565 7269 6e67 2e20 5265   engineering. Re
-0008b010: 7475 726e 696e 6727 290d 0a20 2020 2020  turning')..     
-0008b020: 2020 2072 6574 7572 6e20 6466 0d0a 2020     return df..  
-0008b030: 2020 6674 5f64 6963 7420 3d20 6469 6374    ft_dict = dict
-0008b040: 287a 6970 285b 2761 6464 272c 276d 756c  (zip(['add','mul
-0008b050: 7469 706c 7927 2c27 7375 6274 7261 6374  tiply','subtract
-0008b060: 272c 2764 6976 6964 6527 5d2c 0d0a 2020  ','divide'],..  
-0008b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b080: 5b27 6164 645f 6e75 6d65 7269 6327 2c20  ['add_numeric', 
-0008b090: 276d 756c 7469 706c 795f 6e75 6d65 7269  'multiply_numeri
-0008b0a0: 6327 2c0d 0a20 2020 2020 2020 2020 2020  c',..           
-0008b0b0: 2027 7375 6274 7261 6374 5f6e 756d 6572   'subtract_numer
-0008b0c0: 6963 272c 2027 6469 7669 6465 5f6e 756d  ic', 'divide_num
-0008b0d0: 6572 6963 275d 2929 0d0a 2020 2020 6966  eric']))..    if
-0008b0e0: 206c 656e 2866 745f 7265 7175 6573 7473   len(ft_requests
-0008b0f0: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
-0008b100: 6674 5f6c 6973 7420 3d20 5b5d 0d0a 2020  ft_list = []..  
-0008b110: 2020 2020 2020 666f 7220 6674 5f6f 6e65        for ft_one
-0008b120: 2069 6e20 6674 5f72 6571 7565 7374 733a   in ft_requests:
-0008b130: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0008b140: 2066 745f 6f6e 6520 696e 2066 745f 6469   ft_one in ft_di
-0008b150: 6374 2e6b 6579 7328 293a 0d0a 2020 2020  ct.keys():..    
-0008b160: 2020 2020 2020 2020 2020 2020 6674 5f6c              ft_l
-0008b170: 6973 742e 6170 7065 6e64 2866 745f 6469  ist.append(ft_di
-0008b180: 6374 5b66 745f 6f6e 655d 290d 0a20 2020  ct[ft_one])..   
-0008b190: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0008a400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0008a410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0008a470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0008a480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0008a490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0008a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0008a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008a550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a600: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0008a610: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0008a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+0008a810: 2f61 7574 6f76 696d 6c2f 6665 6174 7572  /autoviml/featur
+0008a820: 655f 656e 6769 6e65 6572 696e 672e 7079  e_engineering.py
+0008a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0008a870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0008a880: 3030 3433 3237 3000 3030 3030 3030 3030  0043270.00000000
+0008a890: 3030 3000 3032 3133 3433 0020 3000 0000  000.021343. 0...
+0008a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0008a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a920: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0008a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008a950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008aa00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0008aa10: 2070 640d 0a69 6d70 6f72 7420 6e75 6d70   pd..import nump
+0008aa20: 7920 6173 206e 700d 0a23 2323 2323 2323  y as np..#######
+0008aa30: 2323 204e 4557 2041 6e64 2046 4153 5420  ## NEW And FAST 
+0008aa40: 5741 5920 746f 2041 4444 2046 6561 7475  WAY to ADD Featu
+0008aa50: 7265 2045 6e67 6720 434f 4c55 4d4e 5320  re Engg COLUMNS 
+0008aa60: 494e 2041 2044 4154 4120 5345 5420 2323  IN A DATA SET ##
+0008aa70: 2323 2323 230d 0a23 2323 2020 204d 6f64  #####..###   Mod
+0008aa80: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
+0008aa90: 2061 6464 696e 6720 4665 6174 7572 6573   adding Features
+0008aaa0: 2075 7369 6e67 2046 6561 7475 7265 2054   using Feature T
+0008aab0: 6f6f 6c73 2023 2323 230d 0a64 6566 2061  ools ####..def a
+0008aac0: 6464 5f63 6f6d 7075 7461 7469 6f6e 616c  dd_computational
+0008aad0: 5f70 7269 6d69 7469 7665 5f66 6561 7475  _primitive_featu
+0008aae0: 7265 7328 2064 662c 2061 6464 5f74 7970  res( df, add_typ
+0008aaf0: 6573 3d5b 5d2c 2069 6463 6f6c 756d 6e3d  es=[], idcolumn=
+0008ab00: 2727 293a 0d0a 2020 2020 2222 220d 0a20  ''):..    """.. 
+0008ab10: 2020 2023 2323 2020 204d 6f64 6966 7920     ###   Modify 
+0008ab20: 4461 7461 6672 616d 6520 6279 2061 6464  Dataframe by add
+0008ab30: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
+0008ab40: 6c20 7072 696d 6974 6976 6520 4665 6174  l primitive Feat
+0008ab50: 7572 6573 2075 7369 6e67 2046 6561 7475  ures using Featu
+0008ab60: 7265 2054 6f6f 6c73 2023 2323 230d 0a20  re Tools ####.. 
+0008ab70: 2020 2023 2323 2020 2057 6861 7420 6172     ###   What ar
+0008ab80: 6520 636f 6d70 7574 6174 696f 6e61 6c20  e computational 
+0008ab90: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
+0008aba0: 2061 7265 2074 6f20 6164 642c 2073 7562   are to add, sub
+0008abb0: 7472 6163 742c 206d 756c 7469 706c 7920  tract, multiply 
+0008abc0: 616e 6420 6469 7669 6465 2066 6561 7475  and divide featu
+0008abd0: 7265 730d 0a20 2020 2023 2323 2049 6e70  res..    ### Inp
+0008abe0: 7574 733a 0d0a 2020 2020 2323 2320 2020  uts:..    ###   
+0008abf0: 6466 3a20 4a75 7374 2073 656e 7420 696e  df: Just sent in
+0008ac00: 2074 6865 2064 6174 6120 6672 616d 6520   the data frame 
+0008ac10: 6466 2074 6861 7420 796f 7520 7761 6e74  df that you want
+0008ac20: 2066 6561 7475 7265 7320 6164 6465 6420   features added 
+0008ac30: 746f 0d0a 2020 2020 2323 2320 2020 6164  to..    ###   ad
+0008ac40: 645f 7479 7065 733a 206c 6973 7420 6f66  d_types: list of
+0008ac50: 2063 6f6d 7075 7461 7469 6f6e 616c 2074   computational t
+0008ac60: 7970 6573 3a20 2761 6464 272c 2027 7375  ypes: 'add', 'su
+0008ac70: 6274 7261 6374 272c 2027 6d75 6c74 6970  btract', 'multip
+0008ac80: 6c79 2720 616e 6420 2764 6976 6964 6527  ly' and 'divide'
+0008ac90: 2e20 4368 6f6f 7365 2061 6e79 206f 7220  . Choose any or 
+0008aca0: 616c 6c2e 0d0a 2020 2020 2323 2320 2020  all...    ###   
+0008acb0: 6964 636f 6c75 6d6e 3a20 7468 6973 2069  idcolumn: this i
+0008acc0: 7320 746f 2063 7265 6174 6520 616e 2069  s to create an i
+0008acd0: 6e64 6578 2066 6f72 2074 6865 2064 6174  ndex for the dat
+0008ace0: 6166 7261 6d65 2073 696e 6365 2046 5420  aframe since FT 
+0008acf0: 7275 6e73 206f 6e20 696e 6465 7820 7661  runs on index va
+0008ad00: 7269 6162 6c65 2e20 596f 7520 6361 6e20  riable. You can 
+0008ad10: 6c65 6176 6520 6974 2065 6d70 7479 2073  leave it empty s
+0008ad20: 7472 696e 672e 0d0a 2020 2020 2222 220d  tring...    """.
+0008ad30: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+0008ad40: 2020 2069 6d70 6f72 7420 6665 6174 7572     import featur
+0008ad50: 6574 6f6f 6c73 2061 7320 6674 0d0a 2020  etools as ft..  
+0008ad60: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+0008ad70: 2020 2070 7269 6e74 2827 596f 7520 6d75     print('You mu
+0008ad80: 7374 2069 6e73 7461 6c6c 2066 6561 7475  st install featu
+0008ad90: 7265 746f 6f6c 7320 746f 2075 7365 2066  retools to use f
+0008ada0: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
+0008adb0: 6e67 2066 756e 6374 696f 6e73 2e20 496e  ng functions. In
+0008adc0: 7374 616c 6c20 6974 2061 6e64 2074 7279  stall it and try
+0008add0: 2061 6761 696e 2e27 290d 0a20 2020 2064   again.')..    d
+0008ade0: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
+0008adf0: 7928 6466 290d 0a20 2020 2070 726f 6a65  y(df)..    proje
+0008ae00: 6374 6964 203d 2027 7072 6f6a 6563 745f  ctid = 'project_
+0008ae10: 7072 6564 6963 7469 6f6e 270d 0a20 2020  prediction'..   
+0008ae20: 2064 6174 6169 6420 3d20 2770 726f 6a65   dataid = 'proje
+0008ae30: 6374 5f64 6174 6127 0d0a 2020 2020 6966  ct_data'..    if
+0008ae40: 2069 6463 6f6c 756d 6e20 3d3d 2027 273a   idcolumn == '':
+0008ae50: 0d0a 2020 2020 2020 2020 696e 6465 7869  ..        indexi
+0008ae60: 6420 3d20 2769 6e64 6578 270d 0a20 2020  d = 'index'..   
+0008ae70: 2020 2020 206d 616b 655f 696e 6465 7820       make_index 
+0008ae80: 3d20 5472 7565 0d0a 2020 2020 656c 7365  = True..    else
+0008ae90: 3a0d 0a20 2020 2020 2020 2069 6e64 6578  :..        index
+0008aea0: 6964 203d 2069 6463 6f6c 756d 6e0d 0a20  id = idcolumn.. 
+0008aeb0: 2020 2020 2020 206d 616b 655f 696e 6465         make_inde
+0008aec0: 783d 4661 6c73 650d 0a20 2020 2023 204d  x=False..    # M
+0008aed0: 616b 6520 616e 2065 6e74 6974 7973 6574  ake an entityset
+0008aee0: 2061 6e64 2061 6464 2074 6865 2065 6e74   and add the ent
+0008aef0: 6974 790d 0a20 2020 2065 7320 3d20 6674  ity..    es = ft
+0008af00: 2e45 6e74 6974 7953 6574 2869 6420 3d20  .EntitySet(id = 
+0008af10: 7072 6f6a 6563 7469 6429 0d0a 2020 2020  projectid)..    
+0008af20: 6573 2e65 6e74 6974 795f 6672 6f6d 5f64  es.entity_from_d
+0008af30: 6174 6166 7261 6d65 2865 6e74 6974 795f  ataframe(entity_
+0008af40: 6964 203d 2064 6174 6169 642c 2064 6174  id = dataid, dat
+0008af50: 6166 7261 6d65 203d 2064 662c 0d0a 2020  aframe = df,..  
+0008af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008af70: 2020 2020 2020 2020 2020 206d 616b 655f             make_
+0008af80: 696e 6465 7820 3d20 6d61 6b65 5f69 6e64  index = make_ind
+0008af90: 6578 2c20 696e 6465 7820 3d20 696e 6465  ex, index = inde
+0008afa0: 7869 6429 0d0a 0d0a 2020 2020 2320 5275  xid)....    # Ru
+0008afb0: 6e20 6465 6570 2066 6561 7475 7265 2073  n deep feature s
+0008afc0: 796e 7468 6573 6973 2077 6974 6820 6769  ynthesis with gi
+0008afd0: 7665 6e20 696e 7075 7420 7072 696d 6974  ven input primit
+0008afe0: 6976 6573 206f 7220 6175 746f 6d61 7469  ives or automati
+0008aff0: 6361 6c6c 7920 6465 6570 2032 0d0a 2020  cally deep 2..  
+0008b000: 2020 6966 206c 656e 2861 6464 5f74 7970    if len(add_typ
+0008b010: 6573 2920 3e20 303a 0d0a 2020 2020 2020  es) > 0:..      
+0008b020: 2020 2323 2320 4275 696c 6420 4665 6174    ### Build Feat
+0008b030: 7572 6573 2062 6173 6564 206f 6e20 6769  ures based on gi
+0008b040: 7665 6e20 7072 696d 6974 6976 6520 7479  ven primitive ty
+0008b050: 7065 732c 2061 6464 5f74 7970 6573 2077  pes, add_types w
+0008b060: 6869 6368 2069 7320 6120 6c69 7374 0d0a  hich is a list..
+0008b070: 2020 2020 2020 2020 6466 5f6d 6f64 2c20          df_mod, 
+0008b080: 6665 6174 7572 655f 6465 6673 203d 2066  feature_defs = f
+0008b090: 742e 6466 7328 656e 7469 7479 7365 7420  t.dfs(entityset 
+0008b0a0: 3d20 6573 2c20 7461 7267 6574 5f65 6e74  = es, target_ent
+0008b0b0: 6974 7920 3d20 6461 7461 6964 2c0d 0a20  ity = dataid,.. 
+0008b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b0d0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+0008b0e0: 735f 7072 696d 6974 6976 6573 203d 2061  s_primitives = a
+0008b0f0: 6464 5f74 7970 6573 290d 0a20 2020 2065  dd_types)..    e
+0008b100: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
+0008b110: 2320 5065 7266 6f72 6d20 4465 6570 2046  # Perform Deep F
+0008b120: 6561 7475 7265 2053 796e 7468 6573 6973  eature Synthesis
+0008b130: 2041 7574 6f6d 6174 6963 616c 6c79 2066   Automatically f
+0008b140: 6f72 2044 6570 7468 2032 0d0a 2020 2020  or Depth 2..    
+0008b150: 2020 2020 6466 5f6d 6f64 2c20 6665 6174      df_mod, feat
+0008b160: 7572 655f 6465 6673 203d 2066 742e 6466  ure_defs = ft.df
+0008b170: 7328 656e 7469 7479 7365 743d 6573 2c20  s(entityset=es, 
+0008b180: 7461 7267 6574 5f65 6e74 6974 7920 3d20  target_entity = 
+0008b190: 6461 7461 6964 2c0d 0a20 2020 2020 2020  dataid,..       
 0008b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b1b0: 7072 696e 7428 2720 2020 2043 616e 6e6f  print('    Canno
-0008b1c0: 7420 7065 7266 6f72 6d20 2573 2d74 7970  t perform %s-typ
-0008b1d0: 6520 6665 6174 7572 6520 656e 6769 6e65  e feature engine
-0008b1e0: 6572 696e 672e 2e2e 2720 2566 745f 6f6e  ering...' %ft_on
-0008b1f0: 6529 0d0a 2020 2020 2020 2020 636f 6c73  e)..        cols
-0008b200: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
-0008b210: 662e 636f 6c75 6d6e 732e 746f 6c69 7374  f.columns.tolist
-0008b220: 2829 2069 6620 7820 6e6f 7420 696e 205b  () if x not in [
-0008b230: 6964 636f 6c5d 5d0d 0a20 2020 2020 2020  idcol]]..       
-0008b240: 2066 6f72 2065 6163 685f 6674 2c20 636f   for each_ft, co
-0008b250: 756e 7420 696e 207a 6970 2866 745f 6c69  unt in zip(ft_li
-0008b260: 7374 2c20 7261 6e67 6528 6c65 6e28 6674  st, range(len(ft
-0008b270: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
-0008b280: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
-0008b290: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
-0008b2a0: 2020 2020 2020 2064 665f 6d6f 6420 3d20         df_mod = 
-0008b2b0: 6164 645f 636f 6d70 7574 6174 696f 6e61  add_computationa
-0008b2c0: 6c5f 7072 696d 6974 6976 655f 6665 6174  l_primitive_feat
-0008b2d0: 7572 6573 2864 662c 5b65 6163 685f 6674  ures(df,[each_ft
-0008b2e0: 5d2c 2069 6463 6f6c 290d 0a20 2020 2020  ], idcol)..     
-0008b2f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0008b300: 2864 665f 6d6f 642e 7368 6170 6529 0d0a  (df_mod.shape)..
-0008b310: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0008b320: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0008b330: 2020 2064 665f 7465 6d70 203d 2061 6464     df_temp = add
-0008b340: 5f63 6f6d 7075 7461 7469 6f6e 616c 5f70  _computational_p
-0008b350: 7269 6d69 7469 7665 5f66 6561 7475 7265  rimitive_feature
-0008b360: 7328 6466 2c5b 6561 6368 5f66 745d 2c20  s(df,[each_ft], 
-0008b370: 6964 636f 6c29 0d0a 2020 2020 2020 2020  idcol)..        
-0008b380: 2020 2020 2020 2020 6466 5f74 656d 702e          df_temp.
-0008b390: 6472 6f70 2863 6f6c 732c 6178 6973 3d31  drop(cols,axis=1
-0008b3a0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-0008b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b3c0: 6466 5f6d 6f64 203d 2070 642e 636f 6e63  df_mod = pd.conc
-0008b3d0: 6174 285b 6466 5f6d 6f64 2c64 665f 7465  at([df_mod,df_te
-0008b3e0: 6d70 5d2c 6178 6973 3d31 2c69 676e 6f72  mp],axis=1,ignor
-0008b3f0: 655f 696e 6465 783d 4661 6c73 6529 0d0a  e_index=False)..
-0008b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b410: 7072 696e 7428 6466 5f6d 6f64 2e73 6861  print(df_mod.sha
-0008b420: 7065 290d 0a20 2020 2065 6c73 653a 0d0a  pe)..    else:..
-0008b430: 2020 2020 2020 2020 6466 5f6d 6f64 203d          df_mod =
-0008b440: 2061 6464 5f63 6f6d 7075 7461 7469 6f6e   add_computation
-0008b450: 616c 5f70 7269 6d69 7469 7665 5f66 6561  al_primitive_fea
-0008b460: 7475 7265 7328 6466 2c5b 5d2c 2069 6463  tures(df,[], idc
-0008b470: 6f6c 290d 0a20 2020 2072 6574 7572 6e20  ol)..    return 
-0008b480: 6466 5f6d 6f64 0d0a 0d0a 0d0a 6465 6620  df_mod......def 
-0008b490: 6164 645f 6461 7465 5f74 696d 655f 6665  add_date_time_fe
-0008b4a0: 6174 7572 6573 2873 6d61 6c6c 6466 2c20  atures(smalldf, 
-0008b4b0: 7374 6172 7454 696d 652c 2065 6e64 5469  startTime, endTi
-0008b4c0: 6d65 2c20 7370 6c69 7474 6572 5f64 6174  me, splitter_dat
-0008b4d0: 655f 7374 7269 6e67 3d22 2f22 2c73 706c  e_string="/",spl
-0008b4e0: 6974 7465 725f 686f 7572 5f73 7472 696e  itter_hour_strin
-0008b4f0: 673d 223a 2229 3a0d 0a20 2020 2022 2222  g=":"):..    """
-0008b500: 0d0a 2020 2020 4966 2079 6f75 2068 6176  ..    If you hav
-0008b510: 6520 7374 6172 7420 6461 7465 2074 696d  e start date tim
-0008b520: 6520 7374 616d 7020 616e 6420 656e 6420  e stamp and end 
-0008b530: 6461 7465 2074 696d 6520 7374 616d 702c  date time stamp,
-0008b540: 2074 6869 7320 6d6f 6475 6c65 2077 696c   this module wil
-0008b550: 6c20 6372 6561 7465 2061 6464 6974 696f  l create additio
-0008b560: 6e61 6c20 6665 6174 7572 6573 2066 6f72  nal features for
-0008b570: 2073 7563 6820 6669 656c 6473 2e0d 0a20   such fields... 
-0008b580: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
-0008b590: 6964 6520 6120 7374 6172 7420 6461 7465  ide a start date
-0008b5a0: 2074 696d 6520 7374 616d 7020 6669 656c   time stamp fiel
-0008b5b0: 6420 616e 6420 6966 2079 6f75 2068 6176  d and if you hav
-0008b5c0: 6520 616e 2065 6e64 2064 6174 6520 7469  e an end date ti
-0008b5d0: 6d65 2073 7461 6d70 2066 6965 6c64 2c20  me stamp field, 
-0008b5e0: 796f 7520 6d75 7374 2075 7365 2069 742e  you must use it.
-0008b5f0: 0d0a 2020 2020 4f74 6865 7277 6973 652c  ..    Otherwise,
-0008b600: 2079 6f75 2061 7265 2062 6574 7465 7220   you are better 
-0008b610: 6f66 6620 7573 696e 6720 7468 6520 6372  off using the cr
-0008b620: 6561 7465 5f64 6174 655f 7469 6d65 5f66  eate_date_time_f
-0008b630: 6561 7475 7265 7320 6d6f 6475 6c65 2077  eatures module w
-0008b640: 6869 6368 2069 7320 616c 736f 2069 6e20  hich is also in 
-0008b650: 7468 6973 206c 6962 7261 7279 2e0d 0a20  this library... 
-0008b660: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
-0008b670: 6964 6520 7468 6520 666f 6c6c 6f77 696e  ide the followin
-0008b680: 673a 0d0a 2020 2020 736d 616c 6c64 663a  g:..    smalldf:
-0008b690: 2044 6174 6166 7261 6d65 2063 6f6e 7461   Dataframe conta
-0008b6a0: 696e 696e 6720 796f 7572 2064 6174 6520  ining your date 
-0008b6b0: 7469 6d65 2066 6965 6c64 730d 0a20 2020  time fields..   
-0008b6c0: 2073 7461 7274 5469 6d65 3a20 7468 6973   startTime: this
-0008b6d0: 2069 7320 686f 7065 6675 6c6c 7920 6120   is hopefully a 
-0008b6e0: 7374 7269 6e67 2066 6965 6c64 2077 6869  string field whi
-0008b6f0: 6368 2063 6f6e 7665 7274 7320 746f 2061  ch converts to a
-0008b700: 2064 6174 6520 7469 6d65 2073 7461 6d70   date time stamp
-0008b710: 2065 6173 696c 792e 204d 616b 6520 7375   easily. Make su
-0008b720: 7265 2069 7420 6973 2061 2073 7472 696e  re it is a strin
-0008b730: 672e 0d0a 2020 2020 656e 6454 696d 653a  g...    endTime:
-0008b740: 2074 6869 7320 616c 736f 206d 7573 7420   this also must 
-0008b750: 6265 2061 2073 7472 696e 6720 6669 656c  be a string fiel
-0008b760: 6420 7768 6963 6820 636f 6e76 6572 7473  d which converts
-0008b770: 2074 6f20 6120 6461 7465 2074 696d 6520   to a date time 
-0008b780: 7374 616d 7020 6561 7369 6c79 2e20 4d61  stamp easily. Ma
-0008b790: 6b65 2073 7572 6520 6974 2069 7320 6120  ke sure it is a 
-0008b7a0: 7374 7269 6e67 2e0d 0a20 2020 2073 706c  string...    spl
-0008b7b0: 6974 7465 725f 6461 7465 5f73 7472 696e  itter_date_strin
-0008b7c0: 673a 2075 7375 616c 6c79 2074 6865 7265  g: usually there
-0008b7d0: 2069 7320 6120 7374 7269 6e67 2073 7563   is a string suc
-0008b7e0: 6820 6173 2027 2f27 206f 7220 272e 2720  h as '/' or '.' 
-0008b7f0: 6265 7477 6565 6e20 6461 792f 6d6f 6e74  between day/mont
-0008b800: 682f 7965 6172 2065 7463 2e20 4465 6661  h/year etc. Defa
-0008b810: 756c 7420 6973 2061 7373 756d 6564 202f  ult is assumed /
-0008b820: 2068 6572 652e 0d0a 2020 2020 7370 6c69   here...    spli
-0008b830: 7474 6572 5f68 6f75 725f 7374 7269 6e67  tter_hour_string
-0008b840: 3a20 7573 7561 6c6c 7920 7468 6572 6520  : usually there 
-0008b850: 6973 2061 2073 7472 696e 6720 7375 6368  is a string such
-0008b860: 2061 7320 273a 2720 6f72 2027 2e27 2062   as ':' or '.' b
-0008b870: 6574 7765 656e 2068 6f75 723a 6d69 6e3a  etween hour:min:
-0008b880: 7365 6320 6574 632e 2044 6566 6175 6c74  sec etc. Default
-0008b890: 2069 7320 6173 7375 6d65 6420 3a20 6865   is assumed : he
-0008b8a0: 7265 2e0d 0a20 2020 2022 2222 0d0a 2020  re...    """..  
-0008b8b0: 2020 736d 616c 6c64 6620 3d20 736d 616c    smalldf = smal
-0008b8c0: 6c64 662e 636f 7079 2829 0d0a 2020 2020  ldf.copy()..    
-0008b8d0: 6164 645f 636f 6c73 203d 205b 5d0d 0a20  add_cols = [].. 
-0008b8e0: 2020 2073 7461 7274 5f64 6174 6520 3d20     start_date = 
-0008b8f0: 2770 726f 6365 7373 696e 6727 2b73 7461  'processing'+sta
-0008b900: 7274 5469 6d65 2b27 5f73 7461 7274 5f64  rtTime+'_start_d
-0008b910: 6174 6527 0d0a 2020 2020 736d 616c 6c64  ate'..    smalld
-0008b920: 665b 7374 6172 745f 6461 7465 5d20 3d20  f[start_date] = 
-0008b930: 736d 616c 6c64 665b 7374 6172 7454 696d  smalldf[startTim
-0008b940: 655d 2e6d 6170 286c 616d 6264 6120 783a  e].map(lambda x:
-0008b950: 2078 2e73 706c 6974 2822 2022 295b 305d   x.split(" ")[0]
-0008b960: 290d 0a20 2020 2061 6464 5f63 6f6c 732e  )..    add_cols.
-0008b970: 6170 7065 6e64 2873 7461 7274 5f64 6174  append(start_dat
-0008b980: 6529 0d0a 2020 2020 7472 793a 0d0a 2020  e)..    try:..  
-0008b990: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
-0008b9a0: 203d 2027 7072 6f63 6573 7369 6e67 272b   = 'processing'+
-0008b9b0: 7374 6172 7454 696d 652b 275f 7374 6172  startTime+'_star
-0008b9c0: 745f 7469 6d65 270d 0a20 2020 2020 2020  t_time'..       
-0008b9d0: 2073 6d61 6c6c 6466 5b73 7461 7274 5f74   smalldf[start_t
-0008b9e0: 696d 655d 203d 2073 6d61 6c6c 6466 5b73  ime] = smalldf[s
-0008b9f0: 7461 7274 5469 6d65 5d2e 6d61 7028 6c61  tartTime].map(la
-0008ba00: 6d62 6461 2078 3a20 782e 7370 6c69 7428  mbda x: x.split(
-0008ba10: 2220 2229 5b31 5d29 0d0a 2020 2020 2020  " ")[1])..      
-0008ba20: 2020 6164 645f 636f 6c73 2e61 7070 656e    add_cols.appen
-0008ba30: 6428 7374 6172 745f 7469 6d65 290d 0a20  d(start_time).. 
-0008ba40: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-0008ba50: 2020 2020 2323 2320 7468 6572 6520 6973      ### there is
-0008ba60: 206e 6f20 686f 7572 2d6d 696e 7574 6573   no hour-minutes
-0008ba70: 2070 6172 7420 6f66 2074 6869 7320 6461   part of this da
-0008ba80: 7465 2074 696d 6520 7374 616d 7020 6669  te time stamp fi
-0008ba90: 656c 642e 2059 6f75 2063 616e 206a 7573  eld. You can jus
-0008baa0: 7420 736b 6970 2069 7420 6966 2069 7420  t skip it if it 
-0008bab0: 6973 206e 6f74 2074 6865 7265 0d0a 2020  is not there..  
-0008bac0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
-0008bad0: 656e 645f 6461 7465 203d 2027 7072 6f63  end_date = 'proc
-0008bae0: 6573 7369 6e67 272b 656e 6454 696d 652b  essing'+endTime+
-0008baf0: 275f 656e 645f 6461 7465 270d 0a20 2020  '_end_date'..   
-0008bb00: 2073 6d61 6c6c 6466 5b65 6e64 5f64 6174   smalldf[end_dat
-0008bb10: 655d 203d 2073 6d61 6c6c 6466 5b65 6e64  e] = smalldf[end
-0008bb20: 5469 6d65 5d2e 6d61 7028 6c61 6d62 6461  Time].map(lambda
-0008bb30: 2078 3a20 782e 7370 6c69 7428 2220 2229   x: x.split(" ")
-0008bb40: 5b30 5d29 0d0a 2020 2020 6164 645f 636f  [0])..    add_co
-0008bb50: 6c73 2e61 7070 656e 6428 656e 645f 6461  ls.append(end_da
-0008bb60: 7465 290d 0a20 2020 2074 7279 3a0d 0a20  te)..    try:.. 
-0008bb70: 2020 2020 2020 2065 6e64 5f74 696d 6520         end_time 
-0008bb80: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
-0008bb90: 6e64 5469 6d65 2b27 5f65 6e64 5f74 696d  ndTime+'_end_tim
-0008bba0: 6527 0d0a 2020 2020 2020 2020 736d 616c  e'..        smal
-0008bbb0: 6c64 665b 656e 645f 7469 6d65 5d20 3d20  ldf[end_time] = 
-0008bbc0: 736d 616c 6c64 665b 656e 6454 696d 655d  smalldf[endTime]
-0008bbd0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
-0008bbe0: 2e73 706c 6974 2822 2022 295b 315d 290d  .split(" ")[1]).
-0008bbf0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
-0008bc00: 732e 6170 7065 6e64 2865 6e64 5f74 696d  s.append(end_tim
-0008bc10: 6529 0d0a 2020 2020 6578 6365 7074 3a0d  e)..    except:.
-0008bc20: 0a20 2020 2020 2020 2023 2323 2074 6865  .        ### the
-0008bc30: 7265 2069 7320 6e6f 2068 6f75 722d 6d69  re is no hour-mi
-0008bc40: 6e75 7465 7320 7061 7274 206f 6620 7468  nutes part of th
-0008bc50: 6973 2064 6174 6520 7469 6d65 2073 7461  is date time sta
-0008bc60: 6d70 2066 6965 6c64 2e20 596f 7520 6361  mp field. You ca
-0008bc70: 6e20 6a75 7374 2073 6b69 7020 6974 2069  n just skip it i
-0008bc80: 6620 6974 2069 7320 6e6f 7420 7468 6572  f it is not ther
-0008bc90: 650d 0a20 2020 2020 2020 2070 6173 730d  e..        pass.
-0008bca0: 0a20 2020 2076 6965 775f 6461 7973 203d  .    view_days =
-0008bcb0: 2027 7072 6f63 6573 7369 6e67 272b 7374   'processing'+st
-0008bcc0: 6172 7454 696d 652b 275f 656c 6170 7365  artTime+'_elapse
-0008bcd0: 645f 6461 7973 270d 0a20 2020 2073 6d61  d_days'..    sma
-0008bce0: 6c6c 6466 5b76 6965 775f 6461 7973 5d20  lldf[view_days] 
-0008bcf0: 3d20 2870 642e 746f 5f64 6174 6574 696d  = (pd.to_datetim
-0008bd00: 6528 736d 616c 6c64 665b 656e 645f 6461  e(smalldf[end_da
-0008bd10: 7465 5d29 202d 2070 642e 746f 5f64 6174  te]) - pd.to_dat
-0008bd20: 6574 696d 6528 736d 616c 6c64 665b 7374  etime(smalldf[st
-0008bd30: 6172 745f 6461 7465 5d29 292e 7661 6c75  art_date])).valu
-0008bd40: 6573 2e61 7374 7970 6528 696e 7429 0d0a  es.astype(int)..
-0008bd50: 2020 2020 6164 645f 636f 6c73 2e61 7070      add_cols.app
-0008bd60: 656e 6428 7669 6577 5f64 6179 7329 0d0a  end(view_days)..
-0008bd70: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0008bd80: 2020 7669 6577 5f74 696d 6520 3d20 2770    view_time = 'p
-0008bd90: 726f 6365 7373 696e 6727 2b73 7461 7274  rocessing'+start
-0008bda0: 5469 6d65 2b27 5f65 6c61 7073 6564 5f74  Time+'_elapsed_t
-0008bdb0: 696d 6527 0d0a 2020 2020 2020 2020 736d  ime'..        sm
-0008bdc0: 616c 6c64 665b 7669 6577 5f74 696d 655d  alldf[view_time]
-0008bdd0: 203d 2028 7064 2e74 6f5f 6461 7465 7469   = (pd.to_dateti
-0008bde0: 6d65 2873 6d61 6c6c 6466 5b65 6e64 5f74  me(smalldf[end_t
-0008bdf0: 696d 655d 2920 2d20 7064 2e74 6f5f 6461  ime]) - pd.to_da
-0008be00: 7465 7469 6d65 2873 6d61 6c6c 6466 5b73  tetime(smalldf[s
-0008be10: 7461 7274 5f74 696d 655d 2929 2e61 7374  tart_time])).ast
-0008be20: 7970 6528 2774 696d 6564 656c 7461 3634  ype('timedelta64
-0008be30: 5b73 5d27 292e 7661 6c75 6573 0d0a 2020  [s]').values..  
-0008be40: 2020 2020 2020 6164 645f 636f 6c73 2e61        add_cols.a
-0008be50: 7070 656e 6428 7669 6577 5f74 696d 6529  ppend(view_time)
-0008be60: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
-0008be70: 2020 2020 2020 2023 2323 2049 6e20 736f         ### In so
-0008be80: 6d65 2064 6174 6520 7469 6d65 2066 6965  me date time fie
-0008be90: 6c64 7320 7468 6973 2067 6976 6573 2061  lds this gives a
-0008bea0: 6e20 6572 726f 7220 736f 2073 6b69 7020  n error so skip 
-0008beb0: 6974 2069 6e20 7468 6174 2063 6173 650d  it in that case.
-0008bec0: 0a20 2020 2020 2020 2070 6173 730d 0a20  .        pass.. 
-0008bed0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
-0008bee0: 6f6e 2077 6520 6368 6f73 6520 656e 6454  on we chose endT
-0008bef0: 696d 6520 6865 7265 2069 7320 7468 6174  ime here is that
-0008bf00: 2073 7461 7274 5469 6d65 2069 7320 7573   startTime is us
-0008bf10: 7561 6c6c 7920 7461 6b65 6e20 6361 7265  ually taken care
-0008bf20: 206f 6620 6279 2061 6e6f 7468 6572 206c   of by another l
-0008bf30: 6962 7261 7279 2e20 536f 2062 6574 7465  ibrary. So bette
-0008bf40: 7220 746f 2064 6f20 7468 6973 2061 6c6f  r to do this alo
-0008bf50: 6e65 2e0d 0a20 2020 2079 6561 7220 3d20  ne...    year = 
-0008bf60: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
-0008bf70: 5469 6d65 2b27 5f65 6e64 5f79 6561 7227  Time+'_end_year'
-0008bf80: 0d0a 2020 2020 736d 616c 6c64 665b 7965  ..    smalldf[ye
-0008bf90: 6172 5d20 3d20 736d 616c 6c64 665b 656e  ar] = smalldf[en
-0008bfa0: 645f 6461 7465 5d2e 6d61 7028 6c61 6d62  d_date].map(lamb
-0008bfb0: 6461 2078 3a20 7374 7228 7829 2e73 706c  da x: str(x).spl
-0008bfc0: 6974 2873 706c 6974 7465 725f 6461 7465  it(splitter_date
-0008bfd0: 5f73 7472 696e 6729 5b30 5d29 2e76 616c  _string)[0]).val
-0008bfe0: 7565 730d 0a20 2020 2061 6464 5f63 6f6c  ues..    add_col
-0008bff0: 732e 6170 7065 6e64 2879 6561 7229 0d0a  s.append(year)..
-0008c000: 2020 2020 2323 2323 2054 6865 2072 6561      #### The rea
-0008c010: 736f 6e20 7765 2063 686f 7365 2065 6e64  son we chose end
-0008c020: 5469 6d65 2068 6572 6520 6973 2074 6861  Time here is tha
-0008c030: 7420 7374 6172 7454 696d 6520 6973 2075  t startTime is u
-0008c040: 7375 616c 6c79 2074 616b 656e 2063 6172  sually taken car
-0008c050: 6520 6f66 2062 7920 616e 6f74 6865 7220  e of by another 
-0008c060: 6c69 6272 6172 792e 2053 6f20 6265 7474  library. So bett
-0008c070: 6572 2074 6f20 646f 2074 6869 7320 616c  er to do this al
-0008c080: 6f6e 652e 0d0a 2020 2020 6d6f 6e74 6820  one...    month 
-0008c090: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
-0008c0a0: 6e64 5469 6d65 2b27 5f65 6e64 5f6d 6f6e  ndTime+'_end_mon
-0008c0b0: 7468 270d 0a20 2020 2073 6d61 6c6c 6466  th'..    smalldf
-0008c0c0: 5b6d 6f6e 7468 5d20 3d20 736d 616c 6c64  [month] = smalld
-0008c0d0: 665b 656e 645f 6461 7465 5d2e 6d61 7028  f[end_date].map(
-0008c0e0: 6c61 6d62 6461 2078 3a20 7374 7228 7829  lambda x: str(x)
-0008c0f0: 2e73 706c 6974 2873 706c 6974 7465 725f  .split(splitter_
-0008c100: 6461 7465 5f73 7472 696e 6729 5b31 5d29  date_string)[1])
-0008c110: 2e76 616c 7565 730d 0a20 2020 2061 6464  .values..    add
-0008c120: 5f63 6f6c 732e 6170 7065 6e64 286d 6f6e  _cols.append(mon
-0008c130: 7468 290d 0a20 2020 2074 7279 3a0d 0a20  th)..    try:.. 
-0008c140: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
-0008c150: 7265 6173 6f6e 2077 6520 6368 6f73 6520  reason we chose 
-0008c160: 656e 6454 696d 6520 6865 7265 2069 7320  endTime here is 
-0008c170: 7468 6174 2073 7461 7274 5469 6d65 2069  that startTime i
-0008c180: 7320 7573 7561 6c6c 7920 7461 6b65 6e20  s usually taken 
-0008c190: 6361 7265 206f 6620 6279 2061 6e6f 7468  care of by anoth
-0008c1a0: 6572 206c 6962 7261 7279 2e20 536f 2062  er library. So b
-0008c1b0: 6574 7465 7220 746f 2064 6f20 7468 6973  etter to do this
-0008c1c0: 2061 6c6f 6e65 2e0d 0a20 2020 2020 2020   alone...       
-0008c1d0: 2064 6179 6e75 6d20 3d20 2770 726f 6365   daynum = 'proce
-0008c1e0: 7373 696e 6727 2b65 6e64 5469 6d65 2b27  ssing'+endTime+'
-0008c1f0: 5f65 6e64 5f64 6179 5f6e 756d 6265 7227  _end_day_number'
-0008c200: 0d0a 2020 2020 2020 2020 736d 616c 6c64  ..        smalld
-0008c210: 665b 6461 796e 756d 5d20 3d20 736d 616c  f[daynum] = smal
-0008c220: 6c64 665b 656e 645f 6461 7465 5d2e 6d61  ldf[end_date].ma
-0008c230: 7028 6c61 6d62 6461 2078 3a20 7374 7228  p(lambda x: str(
-0008c240: 7829 2e73 706c 6974 2873 706c 6974 7465  x).split(splitte
-0008c250: 725f 6461 7465 5f73 7472 696e 6729 5b32  r_date_string)[2
-0008c260: 5d29 2e76 616c 7565 730d 0a20 2020 2020  ]).values..     
-0008c270: 2020 2061 6464 5f63 6f6c 732e 6170 7065     add_cols.appe
-0008c280: 6e64 2864 6179 6e75 6d29 0d0a 2020 2020  nd(daynum)..    
-0008c290: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0008c2a0: 2023 2323 2049 6e20 736f 6d65 2064 6174   ### In some dat
-0008c2b0: 6520 7469 6d65 2066 6965 6c64 7320 7468  e time fields th
-0008c2c0: 6520 6461 7920 6e75 6d62 6572 2069 7320  e day number is 
-0008c2d0: 6e6f 7420 7468 6572 652e 2049 6620 6e6f  not there. If no
-0008c2e0: 742c 206a 7573 7420 736b 6970 2069 7420  t, just skip it 
-0008c2f0: 2323 2323 0d0a 2020 2020 2020 2020 7061  ####..        pa
-0008c300: 7373 0d0a 2020 2020 2323 2323 2049 6e20  ss..    #### In 
-0008c310: 736f 6d65 2064 6174 6520 7469 6d65 2066  some date time f
-0008c320: 6965 6c64 732c 2074 6865 2068 6f75 7220  ields, the hour 
-0008c330: 616e 6420 6d69 6e75 7465 2069 7320 6e6f  and minute is no
-0008c340: 7420 7468 6572 652c 2073 6f20 736b 6970  t there, so skip
-0008c350: 2069 7420 696e 2074 6861 7420 6361 7365   it in that case
-0008c360: 2069 6620 6974 2065 7272 6f72 7321 0d0a   if it errors!..
+0008b1b0: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
+0008b1c0: 203d 2032 2c20 6e5f 6a6f 6273 3d2d 312c   = 2, n_jobs=-1,
+0008b1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b1f0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
+0008b200: 2020 6966 206d 616b 655f 696e 6465 783a    if make_index:
+0008b210: 0d0a 2020 2020 2020 2020 6466 5f6d 6f64  ..        df_mod
+0008b220: 203d 2064 665f 6d6f 642e 7265 7365 745f   = df_mod.reset_
+0008b230: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
+0008b240: 0d0a 2020 2020 7265 7475 726e 2064 665f  ..    return df_
+0008b250: 6d6f 640d 0a0d 0a64 6566 2066 6561 7475  mod....def featu
+0008b260: 7265 5f65 6e67 696e 6565 7269 6e67 2864  re_engineering(d
+0008b270: 662c 2066 745f 7265 7175 6573 7473 2c20  f, ft_requests, 
+0008b280: 6964 636f 6c29 3a0d 0a20 2020 2022 2222  idcol):..    """
+0008b290: 0d0a 2020 2020 5468 6520 4665 6174 7572  ..    The Featur
+0008b2a0: 6520 456e 6769 6e65 6572 696e 6720 6d6f  e Engineering mo
+0008b2b0: 6475 6c65 206e 6565 6473 2046 6561 7475  dule needs Featu
+0008b2c0: 7265 546f 6f6c 7320 696e 7374 616c 6c65  reTools installe
+0008b2d0: 6420 746f 2077 6f72 6b2e 0d0a 2020 2020  d to work...    
+0008b2e0: 536f 2070 6c65 6173 6520 646f 2022 7069  So please do "pi
+0008b2f0: 7020 696e 7374 616c 6c20 6665 6174 7572  p install featur
+0008b300: 6574 6f6f 6c73 2220 6265 666f 7265 2074  etools" before t
+0008b310: 7279 696e 6720 6f75 7420 7468 6973 206d  rying out this m
+0008b320: 6f64 756c 652e 0d0a 2020 2020 4974 2074  odule...    It t
+0008b330: 616b 6573 2061 2067 6976 656e 2064 6174  akes a given dat
+0008b340: 6120 7365 742c 2064 6620 616e 6420 6164  a set, df and ad
+0008b350: 6473 2066 6561 7475 7265 7320 6261 7365  ds features base
+0008b360: 6420 6f6e 2074 6865 2072 6571 7565 7420  d on the requet 
+0008b370: 7479 7065 7320 696e 0d0a 2020 2020 6674  types in..    ft
+0008b380: 5f72 6571 7565 7374 7320 7768 6963 6820  _requests which 
+0008b390: 6361 6e20 6265 2027 6164 6427 2c27 7375  can be 'add','su
+0008b3a0: 6274 7261 6374 272c 276d 756c 7469 706c  btract','multipl
+0008b3b0: 7927 2c27 6469 7669 6465 272e 2049 6620  y','divide'. If 
+0008b3c0: 796f 7520 6861 7665 0d0a 2020 2020 616e  you have..    an
+0008b3d0: 2069 645f 636f 6c75 6d6e 2069 6e20 7468   id_column in th
+0008b3e0: 6520 6461 7461 2073 6574 2c20 796f 7520  e data set, you 
+0008b3f0: 6361 6e20 7072 6f76 6964 6520 6974 2061  can provide it a
+0008b400: 7320 6964 636f 6c20 2861 2073 7472 696e  s idcol (a strin
+0008b410: 6720 7661 7269 6162 6c65 292e 0d0a 2020  g variable)...  
+0008b420: 2020 4974 2077 696c 6c20 7265 7475 726e    It will return
+0008b430: 2079 6f75 7220 6d6f 6469 6669 6564 2064   your modified d
+0008b440: 6174 6173 6574 2077 6974 6820 2769 6463  ataset with 'idc
+0008b450: 6f6c 2720 6173 2074 6865 2069 6e64 6578  ol' as the index
+0008b460: 2e20 4d61 6b65 2073 7572 650d 0a20 2020  . Make sure..   
+0008b470: 2079 6f75 2072 6573 6574 2074 6865 2069   you reset the i
+0008b480: 6e64 6578 2069 6620 796f 7520 7761 6e74  ndex if you want
+0008b490: 2074 6f20 7265 7475 726e 2069 7420 746f   to return it to
+0008b4a0: 2069 7473 2066 6f72 6d65 7220 7374 6174   its former stat
+0008b4b0: 652e 0d0a 2020 2020 416c 736f 2064 6f20  e...    Also do 
+0008b4c0: 6e6f 7420 7365 6e64 2069 6e20 796f 7572  not send in your
+0008b4d0: 2065 6e74 6972 6520 6461 7461 6672 616d   entire datafram
+0008b4e0: 6521 204a 7573 7420 7365 6e64 2061 2073  e! Just send a s
+0008b4f0: 6d61 6c6c 2064 6174 6166 7261 6d65 2077  mall dataframe w
+0008b500: 6974 6820 6120 6665 7720 7661 7269 6162  ith a few variab
+0008b510: 6c65 732e 0d0a 2020 2020 4f6e 6365 2079  les...    Once y
+0008b520: 6f75 2073 6565 2068 6f77 2069 7420 6164  ou see how it ad
+0008b530: 6473 2074 6f20 7065 7266 6f72 6d61 6e63  ds to performanc
+0008b540: 6520 6f66 206d 6f64 656c 2c20 796f 7520  e of model, you 
+0008b550: 6361 6e20 6164 6420 6d6f 7265 2076 6172  can add more var
+0008b560: 6961 626c 6573 2074 6f20 6461 7461 6672  iables to datafr
+0008b570: 616d 652e 0d0a 2020 2020 2222 220d 0a20  ame...    """.. 
+0008b580: 2020 2064 6620 3d20 636f 7079 2e64 6565     df = copy.dee
+0008b590: 7063 6f70 7928 6466 290d 0a20 2020 2069  pcopy(df)..    i
+0008b5a0: 6620 6466 2e73 6861 7065 5b31 5d20 3c20  f df.shape[1] < 
+0008b5b0: 323a 0d0a 2020 2020 2020 2020 7072 696e  2:..        prin
+0008b5c0: 7428 274d 6f72 6520 7468 616e 206f 6e65  t('More than one
+0008b5d0: 2063 6f6c 756d 6e20 696e 2064 6174 6166   column in dataf
+0008b5e0: 7261 6d65 2072 6571 7569 7265 6420 746f  rame required to
+0008b5f0: 2070 6572 666f 726d 2066 6561 7475 7265   perform feature
+0008b600: 2065 6e67 696e 6565 7269 6e67 2e20 5265   engineering. Re
+0008b610: 7475 726e 696e 6727 290d 0a20 2020 2020  turning')..     
+0008b620: 2020 2072 6574 7572 6e20 6466 0d0a 2020     return df..  
+0008b630: 2020 6674 5f64 6963 7420 3d20 6469 6374    ft_dict = dict
+0008b640: 287a 6970 285b 2761 6464 272c 276d 756c  (zip(['add','mul
+0008b650: 7469 706c 7927 2c27 7375 6274 7261 6374  tiply','subtract
+0008b660: 272c 2764 6976 6964 6527 5d2c 0d0a 2020  ','divide'],..  
+0008b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b680: 5b27 6164 645f 6e75 6d65 7269 6327 2c20  ['add_numeric', 
+0008b690: 276d 756c 7469 706c 795f 6e75 6d65 7269  'multiply_numeri
+0008b6a0: 6327 2c0d 0a20 2020 2020 2020 2020 2020  c',..           
+0008b6b0: 2027 7375 6274 7261 6374 5f6e 756d 6572   'subtract_numer
+0008b6c0: 6963 272c 2027 6469 7669 6465 5f6e 756d  ic', 'divide_num
+0008b6d0: 6572 6963 275d 2929 0d0a 2020 2020 6966  eric']))..    if
+0008b6e0: 206c 656e 2866 745f 7265 7175 6573 7473   len(ft_requests
+0008b6f0: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
+0008b700: 6674 5f6c 6973 7420 3d20 5b5d 0d0a 2020  ft_list = []..  
+0008b710: 2020 2020 2020 666f 7220 6674 5f6f 6e65        for ft_one
+0008b720: 2069 6e20 6674 5f72 6571 7565 7374 733a   in ft_requests:
+0008b730: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0008b740: 2066 745f 6f6e 6520 696e 2066 745f 6469   ft_one in ft_di
+0008b750: 6374 2e6b 6579 7328 293a 0d0a 2020 2020  ct.keys():..    
+0008b760: 2020 2020 2020 2020 2020 2020 6674 5f6c              ft_l
+0008b770: 6973 742e 6170 7065 6e64 2866 745f 6469  ist.append(ft_di
+0008b780: 6374 5b66 745f 6f6e 655d 290d 0a20 2020  ct[ft_one])..   
+0008b790: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0008b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b7b0: 7072 696e 7428 2720 2020 2043 616e 6e6f  print('    Canno
+0008b7c0: 7420 7065 7266 6f72 6d20 2573 2d74 7970  t perform %s-typ
+0008b7d0: 6520 6665 6174 7572 6520 656e 6769 6e65  e feature engine
+0008b7e0: 6572 696e 672e 2e2e 2720 2566 745f 6f6e  ering...' %ft_on
+0008b7f0: 6529 0d0a 2020 2020 2020 2020 636f 6c73  e)..        cols
+0008b800: 203d 205b 7820 666f 7220 7820 696e 2064   = [x for x in d
+0008b810: 662e 636f 6c75 6d6e 732e 746f 6c69 7374  f.columns.tolist
+0008b820: 2829 2069 6620 7820 6e6f 7420 696e 205b  () if x not in [
+0008b830: 6964 636f 6c5d 5d0d 0a20 2020 2020 2020  idcol]]..       
+0008b840: 2066 6f72 2065 6163 685f 6674 2c20 636f   for each_ft, co
+0008b850: 756e 7420 696e 207a 6970 2866 745f 6c69  unt in zip(ft_li
+0008b860: 7374 2c20 7261 6e67 6528 6c65 6e28 6674  st, range(len(ft
+0008b870: 5f6c 6973 7429 2929 3a0d 0a20 2020 2020  _list))):..     
+0008b880: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
+0008b890: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+0008b8a0: 2020 2020 2020 2064 665f 6d6f 6420 3d20         df_mod = 
+0008b8b0: 6164 645f 636f 6d70 7574 6174 696f 6e61  add_computationa
+0008b8c0: 6c5f 7072 696d 6974 6976 655f 6665 6174  l_primitive_feat
+0008b8d0: 7572 6573 2864 662c 5b65 6163 685f 6674  ures(df,[each_ft
+0008b8e0: 5d2c 2069 6463 6f6c 290d 0a20 2020 2020  ], idcol)..     
+0008b8f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0008b900: 2864 665f 6d6f 642e 7368 6170 6529 0d0a  (df_mod.shape)..
+0008b910: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0008b920: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0008b930: 2020 2064 665f 7465 6d70 203d 2061 6464     df_temp = add
+0008b940: 5f63 6f6d 7075 7461 7469 6f6e 616c 5f70  _computational_p
+0008b950: 7269 6d69 7469 7665 5f66 6561 7475 7265  rimitive_feature
+0008b960: 7328 6466 2c5b 6561 6368 5f66 745d 2c20  s(df,[each_ft], 
+0008b970: 6964 636f 6c29 0d0a 2020 2020 2020 2020  idcol)..        
+0008b980: 2020 2020 2020 2020 6466 5f74 656d 702e          df_temp.
+0008b990: 6472 6f70 2863 6f6c 732c 6178 6973 3d31  drop(cols,axis=1
+0008b9a0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
+0008b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b9c0: 6466 5f6d 6f64 203d 2070 642e 636f 6e63  df_mod = pd.conc
+0008b9d0: 6174 285b 6466 5f6d 6f64 2c64 665f 7465  at([df_mod,df_te
+0008b9e0: 6d70 5d2c 6178 6973 3d31 2c69 676e 6f72  mp],axis=1,ignor
+0008b9f0: 655f 696e 6465 783d 4661 6c73 6529 0d0a  e_index=False)..
+0008ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ba10: 7072 696e 7428 6466 5f6d 6f64 2e73 6861  print(df_mod.sha
+0008ba20: 7065 290d 0a20 2020 2065 6c73 653a 0d0a  pe)..    else:..
+0008ba30: 2020 2020 2020 2020 6466 5f6d 6f64 203d          df_mod =
+0008ba40: 2061 6464 5f63 6f6d 7075 7461 7469 6f6e   add_computation
+0008ba50: 616c 5f70 7269 6d69 7469 7665 5f66 6561  al_primitive_fea
+0008ba60: 7475 7265 7328 6466 2c5b 5d2c 2069 6463  tures(df,[], idc
+0008ba70: 6f6c 290d 0a20 2020 2072 6574 7572 6e20  ol)..    return 
+0008ba80: 6466 5f6d 6f64 0d0a 0d0a 0d0a 6465 6620  df_mod......def 
+0008ba90: 6164 645f 6461 7465 5f74 696d 655f 6665  add_date_time_fe
+0008baa0: 6174 7572 6573 2873 6d61 6c6c 6466 2c20  atures(smalldf, 
+0008bab0: 7374 6172 7454 696d 652c 2065 6e64 5469  startTime, endTi
+0008bac0: 6d65 2c20 7370 6c69 7474 6572 5f64 6174  me, splitter_dat
+0008bad0: 655f 7374 7269 6e67 3d22 2f22 2c73 706c  e_string="/",spl
+0008bae0: 6974 7465 725f 686f 7572 5f73 7472 696e  itter_hour_strin
+0008baf0: 673d 223a 2229 3a0d 0a20 2020 2022 2222  g=":"):..    """
+0008bb00: 0d0a 2020 2020 4966 2079 6f75 2068 6176  ..    If you hav
+0008bb10: 6520 7374 6172 7420 6461 7465 2074 696d  e start date tim
+0008bb20: 6520 7374 616d 7020 616e 6420 656e 6420  e stamp and end 
+0008bb30: 6461 7465 2074 696d 6520 7374 616d 702c  date time stamp,
+0008bb40: 2074 6869 7320 6d6f 6475 6c65 2077 696c   this module wil
+0008bb50: 6c20 6372 6561 7465 2061 6464 6974 696f  l create additio
+0008bb60: 6e61 6c20 6665 6174 7572 6573 2066 6f72  nal features for
+0008bb70: 2073 7563 6820 6669 656c 6473 2e0d 0a20   such fields... 
+0008bb80: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
+0008bb90: 6964 6520 6120 7374 6172 7420 6461 7465  ide a start date
+0008bba0: 2074 696d 6520 7374 616d 7020 6669 656c   time stamp fiel
+0008bbb0: 6420 616e 6420 6966 2079 6f75 2068 6176  d and if you hav
+0008bbc0: 6520 616e 2065 6e64 2064 6174 6520 7469  e an end date ti
+0008bbd0: 6d65 2073 7461 6d70 2066 6965 6c64 2c20  me stamp field, 
+0008bbe0: 796f 7520 6d75 7374 2075 7365 2069 742e  you must use it.
+0008bbf0: 0d0a 2020 2020 4f74 6865 7277 6973 652c  ..    Otherwise,
+0008bc00: 2079 6f75 2061 7265 2062 6574 7465 7220   you are better 
+0008bc10: 6f66 6620 7573 696e 6720 7468 6520 6372  off using the cr
+0008bc20: 6561 7465 5f64 6174 655f 7469 6d65 5f66  eate_date_time_f
+0008bc30: 6561 7475 7265 7320 6d6f 6475 6c65 2077  eatures module w
+0008bc40: 6869 6368 2069 7320 616c 736f 2069 6e20  hich is also in 
+0008bc50: 7468 6973 206c 6962 7261 7279 2e0d 0a20  this library... 
+0008bc60: 2020 2059 6f75 206d 7573 7420 7072 6f76     You must prov
+0008bc70: 6964 6520 7468 6520 666f 6c6c 6f77 696e  ide the followin
+0008bc80: 673a 0d0a 2020 2020 736d 616c 6c64 663a  g:..    smalldf:
+0008bc90: 2044 6174 6166 7261 6d65 2063 6f6e 7461   Dataframe conta
+0008bca0: 696e 696e 6720 796f 7572 2064 6174 6520  ining your date 
+0008bcb0: 7469 6d65 2066 6965 6c64 730d 0a20 2020  time fields..   
+0008bcc0: 2073 7461 7274 5469 6d65 3a20 7468 6973   startTime: this
+0008bcd0: 2069 7320 686f 7065 6675 6c6c 7920 6120   is hopefully a 
+0008bce0: 7374 7269 6e67 2066 6965 6c64 2077 6869  string field whi
+0008bcf0: 6368 2063 6f6e 7665 7274 7320 746f 2061  ch converts to a
+0008bd00: 2064 6174 6520 7469 6d65 2073 7461 6d70   date time stamp
+0008bd10: 2065 6173 696c 792e 204d 616b 6520 7375   easily. Make su
+0008bd20: 7265 2069 7420 6973 2061 2073 7472 696e  re it is a strin
+0008bd30: 672e 0d0a 2020 2020 656e 6454 696d 653a  g...    endTime:
+0008bd40: 2074 6869 7320 616c 736f 206d 7573 7420   this also must 
+0008bd50: 6265 2061 2073 7472 696e 6720 6669 656c  be a string fiel
+0008bd60: 6420 7768 6963 6820 636f 6e76 6572 7473  d which converts
+0008bd70: 2074 6f20 6120 6461 7465 2074 696d 6520   to a date time 
+0008bd80: 7374 616d 7020 6561 7369 6c79 2e20 4d61  stamp easily. Ma
+0008bd90: 6b65 2073 7572 6520 6974 2069 7320 6120  ke sure it is a 
+0008bda0: 7374 7269 6e67 2e0d 0a20 2020 2073 706c  string...    spl
+0008bdb0: 6974 7465 725f 6461 7465 5f73 7472 696e  itter_date_strin
+0008bdc0: 673a 2075 7375 616c 6c79 2074 6865 7265  g: usually there
+0008bdd0: 2069 7320 6120 7374 7269 6e67 2073 7563   is a string suc
+0008bde0: 6820 6173 2027 2f27 206f 7220 272e 2720  h as '/' or '.' 
+0008bdf0: 6265 7477 6565 6e20 6461 792f 6d6f 6e74  between day/mont
+0008be00: 682f 7965 6172 2065 7463 2e20 4465 6661  h/year etc. Defa
+0008be10: 756c 7420 6973 2061 7373 756d 6564 202f  ult is assumed /
+0008be20: 2068 6572 652e 0d0a 2020 2020 7370 6c69   here...    spli
+0008be30: 7474 6572 5f68 6f75 725f 7374 7269 6e67  tter_hour_string
+0008be40: 3a20 7573 7561 6c6c 7920 7468 6572 6520  : usually there 
+0008be50: 6973 2061 2073 7472 696e 6720 7375 6368  is a string such
+0008be60: 2061 7320 273a 2720 6f72 2027 2e27 2062   as ':' or '.' b
+0008be70: 6574 7765 656e 2068 6f75 723a 6d69 6e3a  etween hour:min:
+0008be80: 7365 6320 6574 632e 2044 6566 6175 6c74  sec etc. Default
+0008be90: 2069 7320 6173 7375 6d65 6420 3a20 6865   is assumed : he
+0008bea0: 7265 2e0d 0a20 2020 2022 2222 0d0a 2020  re...    """..  
+0008beb0: 2020 736d 616c 6c64 6620 3d20 736d 616c    smalldf = smal
+0008bec0: 6c64 662e 636f 7079 2829 0d0a 2020 2020  ldf.copy()..    
+0008bed0: 6164 645f 636f 6c73 203d 205b 5d0d 0a20  add_cols = [].. 
+0008bee0: 2020 2073 7461 7274 5f64 6174 6520 3d20     start_date = 
+0008bef0: 2770 726f 6365 7373 696e 6727 2b73 7461  'processing'+sta
+0008bf00: 7274 5469 6d65 2b27 5f73 7461 7274 5f64  rtTime+'_start_d
+0008bf10: 6174 6527 0d0a 2020 2020 736d 616c 6c64  ate'..    smalld
+0008bf20: 665b 7374 6172 745f 6461 7465 5d20 3d20  f[start_date] = 
+0008bf30: 736d 616c 6c64 665b 7374 6172 7454 696d  smalldf[startTim
+0008bf40: 655d 2e6d 6170 286c 616d 6264 6120 783a  e].map(lambda x:
+0008bf50: 2078 2e73 706c 6974 2822 2022 295b 305d   x.split(" ")[0]
+0008bf60: 290d 0a20 2020 2061 6464 5f63 6f6c 732e  )..    add_cols.
+0008bf70: 6170 7065 6e64 2873 7461 7274 5f64 6174  append(start_dat
+0008bf80: 6529 0d0a 2020 2020 7472 793a 0d0a 2020  e)..    try:..  
+0008bf90: 2020 2020 2020 7374 6172 745f 7469 6d65        start_time
+0008bfa0: 203d 2027 7072 6f63 6573 7369 6e67 272b   = 'processing'+
+0008bfb0: 7374 6172 7454 696d 652b 275f 7374 6172  startTime+'_star
+0008bfc0: 745f 7469 6d65 270d 0a20 2020 2020 2020  t_time'..       
+0008bfd0: 2073 6d61 6c6c 6466 5b73 7461 7274 5f74   smalldf[start_t
+0008bfe0: 696d 655d 203d 2073 6d61 6c6c 6466 5b73  ime] = smalldf[s
+0008bff0: 7461 7274 5469 6d65 5d2e 6d61 7028 6c61  tartTime].map(la
+0008c000: 6d62 6461 2078 3a20 782e 7370 6c69 7428  mbda x: x.split(
+0008c010: 2220 2229 5b31 5d29 0d0a 2020 2020 2020  " ")[1])..      
+0008c020: 2020 6164 645f 636f 6c73 2e61 7070 656e    add_cols.appen
+0008c030: 6428 7374 6172 745f 7469 6d65 290d 0a20  d(start_time).. 
+0008c040: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+0008c050: 2020 2020 2323 2320 7468 6572 6520 6973      ### there is
+0008c060: 206e 6f20 686f 7572 2d6d 696e 7574 6573   no hour-minutes
+0008c070: 2070 6172 7420 6f66 2074 6869 7320 6461   part of this da
+0008c080: 7465 2074 696d 6520 7374 616d 7020 6669  te time stamp fi
+0008c090: 656c 642e 2059 6f75 2063 616e 206a 7573  eld. You can jus
+0008c0a0: 7420 736b 6970 2069 7420 6966 2069 7420  t skip it if it 
+0008c0b0: 6973 206e 6f74 2074 6865 7265 0d0a 2020  is not there..  
+0008c0c0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+0008c0d0: 656e 645f 6461 7465 203d 2027 7072 6f63  end_date = 'proc
+0008c0e0: 6573 7369 6e67 272b 656e 6454 696d 652b  essing'+endTime+
+0008c0f0: 275f 656e 645f 6461 7465 270d 0a20 2020  '_end_date'..   
+0008c100: 2073 6d61 6c6c 6466 5b65 6e64 5f64 6174   smalldf[end_dat
+0008c110: 655d 203d 2073 6d61 6c6c 6466 5b65 6e64  e] = smalldf[end
+0008c120: 5469 6d65 5d2e 6d61 7028 6c61 6d62 6461  Time].map(lambda
+0008c130: 2078 3a20 782e 7370 6c69 7428 2220 2229   x: x.split(" ")
+0008c140: 5b30 5d29 0d0a 2020 2020 6164 645f 636f  [0])..    add_co
+0008c150: 6c73 2e61 7070 656e 6428 656e 645f 6461  ls.append(end_da
+0008c160: 7465 290d 0a20 2020 2074 7279 3a0d 0a20  te)..    try:.. 
+0008c170: 2020 2020 2020 2065 6e64 5f74 696d 6520         end_time 
+0008c180: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
+0008c190: 6e64 5469 6d65 2b27 5f65 6e64 5f74 696d  ndTime+'_end_tim
+0008c1a0: 6527 0d0a 2020 2020 2020 2020 736d 616c  e'..        smal
+0008c1b0: 6c64 665b 656e 645f 7469 6d65 5d20 3d20  ldf[end_time] = 
+0008c1c0: 736d 616c 6c64 665b 656e 6454 696d 655d  smalldf[endTime]
+0008c1d0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
+0008c1e0: 2e73 706c 6974 2822 2022 295b 315d 290d  .split(" ")[1]).
+0008c1f0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
+0008c200: 732e 6170 7065 6e64 2865 6e64 5f74 696d  s.append(end_tim
+0008c210: 6529 0d0a 2020 2020 6578 6365 7074 3a0d  e)..    except:.
+0008c220: 0a20 2020 2020 2020 2023 2323 2074 6865  .        ### the
+0008c230: 7265 2069 7320 6e6f 2068 6f75 722d 6d69  re is no hour-mi
+0008c240: 6e75 7465 7320 7061 7274 206f 6620 7468  nutes part of th
+0008c250: 6973 2064 6174 6520 7469 6d65 2073 7461  is date time sta
+0008c260: 6d70 2066 6965 6c64 2e20 596f 7520 6361  mp field. You ca
+0008c270: 6e20 6a75 7374 2073 6b69 7020 6974 2069  n just skip it i
+0008c280: 6620 6974 2069 7320 6e6f 7420 7468 6572  f it is not ther
+0008c290: 650d 0a20 2020 2020 2020 2070 6173 730d  e..        pass.
+0008c2a0: 0a20 2020 2076 6965 775f 6461 7973 203d  .    view_days =
+0008c2b0: 2027 7072 6f63 6573 7369 6e67 272b 7374   'processing'+st
+0008c2c0: 6172 7454 696d 652b 275f 656c 6170 7365  artTime+'_elapse
+0008c2d0: 645f 6461 7973 270d 0a20 2020 2073 6d61  d_days'..    sma
+0008c2e0: 6c6c 6466 5b76 6965 775f 6461 7973 5d20  lldf[view_days] 
+0008c2f0: 3d20 2870 642e 746f 5f64 6174 6574 696d  = (pd.to_datetim
+0008c300: 6528 736d 616c 6c64 665b 656e 645f 6461  e(smalldf[end_da
+0008c310: 7465 5d29 202d 2070 642e 746f 5f64 6174  te]) - pd.to_dat
+0008c320: 6574 696d 6528 736d 616c 6c64 665b 7374  etime(smalldf[st
+0008c330: 6172 745f 6461 7465 5d29 292e 7661 6c75  art_date])).valu
+0008c340: 6573 2e61 7374 7970 6528 696e 7429 0d0a  es.astype(int)..
+0008c350: 2020 2020 6164 645f 636f 6c73 2e61 7070      add_cols.app
+0008c360: 656e 6428 7669 6577 5f64 6179 7329 0d0a  end(view_days)..
 0008c370: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0008c380: 2020 7374 6172 745f 686f 7572 203d 2027    start_hour = '
-0008c390: 7072 6f63 6573 7369 6e67 272b 7374 6172  processing'+star
-0008c3a0: 7454 696d 652b 275f 7374 6172 745f 686f  tTime+'_start_ho
-0008c3b0: 7572 270d 0a20 2020 2020 2020 2073 6d61  ur'..        sma
-0008c3c0: 6c6c 6466 5b73 7461 7274 5f68 6f75 725d  lldf[start_hour]
-0008c3d0: 203d 2073 6d61 6c6c 6466 5b73 7461 7274   = smalldf[start
-0008c3e0: 5f74 696d 655d 2e6d 6170 286c 616d 6264  _time].map(lambd
-0008c3f0: 6120 783a 2073 7472 2878 292e 7370 6c69  a x: str(x).spli
-0008c400: 7428 7370 6c69 7474 6572 5f68 6f75 725f  t(splitter_hour_
-0008c410: 7374 7269 6e67 295b 305d 292e 7661 6c75  string)[0]).valu
-0008c420: 6573 0d0a 2020 2020 2020 2020 6164 645f  es..        add_
-0008c430: 636f 6c73 2e61 7070 656e 6428 7374 6172  cols.append(star
-0008c440: 745f 686f 7572 290d 0a20 2020 2020 2020  t_hour)..       
-0008c450: 2073 7461 7274 5f6d 696e 203d 2027 7072   start_min = 'pr
-0008c460: 6f63 6573 7369 6e67 272b 7374 6172 7454  ocessing'+startT
-0008c470: 696d 652b 275f 7374 6172 745f 686f 7572  ime+'_start_hour
-0008c480: 270d 0a20 2020 2020 2020 2073 6d61 6c6c  '..        small
-0008c490: 6466 5b73 7461 7274 5f6d 696e 5d20 3d20  df[start_min] = 
-0008c4a0: 736d 616c 6c64 665b 7374 6172 745f 7469  smalldf[start_ti
-0008c4b0: 6d65 5d2e 6d61 7028 6c61 6d62 6461 2078  me].map(lambda x
-0008c4c0: 3a20 7374 7228 7829 2e73 706c 6974 2873  : str(x).split(s
-0008c4d0: 706c 6974 7465 725f 686f 7572 5f73 7472  plitter_hour_str
-0008c4e0: 696e 6729 5b31 5d29 2e76 616c 7565 730d  ing)[1]).values.
-0008c4f0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
-0008c500: 732e 6170 7065 6e64 2873 7461 7274 5f6d  s.append(start_m
-0008c510: 696e 290d 0a20 2020 2065 7863 6570 743a  in)..    except:
-0008c520: 0d0a 2020 2020 2020 2020 2323 2320 4966  ..        ### If
-0008c530: 2069 7420 6572 726f 7273 2c20 736b 6970   it errors, skip
-0008c540: 2069 740d 0a20 2020 2020 2020 2070 6173   it..        pas
-0008c550: 730d 0a20 2020 2023 2323 2320 4368 6563  s..    #### Chec
-0008c560: 6b20 6966 2074 6865 7265 2069 7320 6120  k if there is a 
-0008c570: 7765 656b 6461 7920 616e 6420 7765 656b  weekday and week
-0008c580: 656e 6473 2069 6e20 6461 7465 2074 696d  ends in date tim
-0008c590: 6520 636f 6c75 6d6e 7320 7573 696e 6720  e columns using 
-0008c5a0: 656e 6454 696d 6520 6f6e 6c79 0d0a 2020  endTime only..  
-0008c5b0: 2020 7765 656b 6461 795f 6e75 6d20 3d20    weekday_num = 
-0008c5c0: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
-0008c5d0: 5469 6d65 2b27 5f65 6e64 5f77 6565 6b64  Time+'_end_weekd
-0008c5e0: 6179 5f6e 756d 6265 7227 0d0a 2020 2020  ay_number'..    
-0008c5f0: 736d 616c 6c64 665b 7765 656b 6461 795f  smalldf[weekday_
-0008c600: 6e75 6d5d 203d 2070 642e 746f 5f64 6174  num] = pd.to_dat
-0008c610: 6574 696d 6528 736d 616c 6c64 665b 656e  etime(smalldf[en
-0008c620: 645f 6461 7465 5d29 2e64 742e 7765 656b  d_date]).dt.week
-0008c630: 6461 792e 7661 6c75 6573 0d0a 2020 2020  day.values..    
-0008c640: 6164 645f 636f 6c73 2e61 7070 656e 6428  add_cols.append(
-0008c650: 7765 656b 6461 795f 6e75 6d29 0d0a 2020  weekday_num)..  
-0008c660: 2020 7765 656b 656e 6420 3d20 2770 726f    weekend = 'pro
-0008c670: 6365 7373 696e 6727 2b65 6e64 5469 6d65  cessing'+endTime
-0008c680: 2b27 5f65 6e64 5f77 6565 6b65 6e64 5f66  +'_end_weekend_f
-0008c690: 6c61 6727 0d0a 2020 2020 736d 616c 6c64  lag'..    smalld
-0008c6a0: 665b 7765 656b 656e 645d 203d 2073 6d61  f[weekend] = sma
-0008c6b0: 6c6c 6466 5b77 6565 6b64 6179 5f6e 756d  lldf[weekday_num
-0008c6c0: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
-0008c6d0: 3120 6966 2078 2069 6e5b 352c 365d 2065  1 if x in[5,6] e
-0008c6e0: 6c73 6520 3029 0d0a 2020 2020 6164 645f  lse 0)..    add_
-0008c6f0: 636f 6c73 2e61 7070 656e 6428 7765 656b  cols.append(week
-0008c700: 656e 6429 0d0a 2020 2020 2323 2323 2049  end)..    #### I
-0008c710: 6620 6576 6572 7974 6869 6e67 2077 6f72  f everything wor
-0008c720: 6b73 2077 656c 6c2c 2074 6865 7265 2073  ks well, there s
-0008c730: 686f 756c 6420 6265 2031 3320 6e65 7720  hould be 13 new 
-0008c740: 636f 6c75 6d6e 7320 6164 6465 6420 6279  columns added by
-0008c750: 206d 6f64 756c 652e 2041 6c6c 2074 6865   module. All the
-0008c760: 2062 6573 7421 0d0a 2020 2020 7072 696e   best!..    prin
-0008c770: 7428 2725 6420 636f 6c75 6d6e 7320 6164  t('%d columns ad
-0008c780: 6465 6420 7573 696e 6720 7374 6172 7420  ded using start 
-0008c790: 6461 7465 3d25 7320 616e 6420 656e 6420  date=%s and end 
-0008c7a0: 6461 7465 3d25 7320 7072 6f63 6573 7369  date=%s processi
-0008c7b0: 6e67 2e2e 2e27 2025 286c 656e 2861 6464  ng...' %(len(add
-0008c7c0: 5f63 6f6c 7329 2c73 7461 7274 5469 6d65  _cols),startTime
-0008c7d0: 2c65 6e64 5469 6d65 2929 0d0a 2020 2020  ,endTime))..    
-0008c7e0: 7265 7475 726e 2073 6d61 6c6c 6466 0d0a  return smalldf..
-0008c7f0: 230d 0a23 2323 2323 2323 2323 2323 2323  #..#############
-0008c800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008c840: 2323 2323 0d0a 6465 6620 7370 6c69 745f  ####..def split_
-0008c850: 6f6e 655f 6669 656c 645f 696e 746f 5f6d  one_field_into_m
-0008c860: 616e 7928 6466 2c20 6669 656c 642c 2073  any(df, field, s
-0008c870: 706c 6974 7465 722c 2066 696c 6c65 722c  plitter, filler,
-0008c880: 206e 6577 5f6e 616d 6573 5f6c 6973 7429   new_names_list)
-0008c890: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0008c8a0: 5468 6973 206c 6974 746c 6520 6675 6e63  This little func
-0008c8b0: 7469 6f6e 2074 616b 6573 2061 6e79 2064  tion takes any d
-0008c8c0: 6174 6120 6672 616d 6520 6669 656c 6420  ata frame field 
-0008c8d0: 2873 7472 696e 6720 7661 7269 6162 6c65  (string variable
-0008c8e0: 7320 6f6e 6c79 2920 616e 6420 7370 6c69  s only) and spli
-0008c8f0: 7473 0d0a 2020 2020 6974 2069 6e74 6f20  ts..    it into 
-0008c900: 6173 206d 616e 7920 6669 656c 6473 2061  as many fields a
-0008c910: 7320 796f 7520 7761 6e74 2069 6e20 7468  s you want in th
-0008c920: 6520 6e65 775f 6e61 6d65 735f 6c69 7374  e new_names_list
-0008c930: 2e0d 0a20 2020 2059 6f75 2063 616e 2061  ...    You can a
-0008c940: 6c73 6f20 7370 6563 6966 7920 7768 6174  lso specify what
-0008c950: 2073 7472 696e 6720 746f 2073 706c 6974   string to split
-0008c960: 206f 6e20 7573 696e 6720 7468 6520 7370   on using the sp
-0008c970: 6c69 7474 6572 2061 7267 756d 656e 742e  litter argument.
-0008c980: 0d0a 2020 2020 596f 7520 6361 6e20 616c  ..    You can al
-0008c990: 736f 2066 696c 6c20 4e75 6c6c 2076 616c  so fill Null val
-0008c9a0: 7565 7320 7468 6174 206f 6363 7572 2064  ues that occur d
-0008c9b0: 7565 2074 6f20 796f 7572 2073 706c 6974  ue to your split
-0008c9c0: 7469 6e67 2062 7920 7370 6563 6966 7969  ting by specifyi
-0008c9d0: 6e67 2061 2066 696c 6c65 722e 0d0a 2020  ng a filler...  
-0008c9e0: 2020 6966 206e 6f20 6e65 775f 6e61 6d65    if no new_name
-0008c9f0: 735f 6c69 7374 2069 7320 6769 7665 6e2c  s_list is given,
-0008ca00: 2074 6865 6e20 7765 2075 7365 2074 6865   then we use the
-0008ca10: 206e 616d 6520 6f66 2074 6865 2066 6965   name of the fie
-0008ca20: 6c64 2069 7473 656c 6620 746f 2073 706c  ld itself to spl
-0008ca30: 6974 2e0d 0a20 2020 2022 2222 0d0a 2020  it...    """..  
-0008ca40: 2020 696d 706f 7274 2077 6172 6e69 6e67    import warning
-0008ca50: 730d 0a20 2020 2077 6172 6e69 6e67 732e  s..    warnings.
-0008ca60: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
-0008ca70: 6967 6e6f 7265 2229 0d0a 2020 2020 6466  ignore")..    df
-0008ca80: 203d 2064 662e 636f 7079 2829 0d0a 2020   = df.copy()..  
-0008ca90: 2020 2323 2320 4669 7273 7420 7072 696e    ### First prin
-0008caa0: 7420 7468 6520 6d61 7869 6d75 6d20 6e75  t the maximum nu
-0008cab0: 6d62 6572 206f 6620 7468 696e 6773 2069  mber of things i
-0008cac0: 6e20 7468 6174 2066 6965 6c64 0d0a 2020  n that field..  
-0008cad0: 2020 6d61 785f 7468 696e 6773 203d 2064    max_things = d
-0008cae0: 665b 6669 656c 645d 2e6d 6170 286c 616d  f[field].map(lam
-0008caf0: 6264 6120 783a 206c 656e 2878 2e73 706c  bda x: len(x.spl
-0008cb00: 6974 2873 706c 6974 7465 7229 2929 2e6d  it(splitter))).m
-0008cb10: 6178 2829 0d0a 2020 2020 6966 206c 656e  ax()..    if len
-0008cb20: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008cb30: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-0008cb40: 7072 696e 7428 2720 2020 204d 6178 2e20  print('    Max. 
-0008cb50: 636f 6c75 6d6e 7320 6372 6561 7465 6420  columns created 
-0008cb60: 6279 2073 706c 6974 7469 6e67 2025 7320  by splitting %s 
-0008cb70: 6669 656c 6420 6973 2025 642e 2720 2528  field is %d.' %(
-0008cb80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008cb90: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0008cba0: 656c 642c 6d61 785f 7468 696e 6773 2929  eld,max_things))
-0008cbb0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-0008cbc0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0008cbd0: 4d61 782e 2063 6f6c 756d 6e73 2063 7265  Max. columns cre
-0008cbe0: 6174 6564 2062 7920 7370 6c69 7474 696e  ated by splittin
-0008cbf0: 6720 2573 2066 6965 6c64 2069 7320 2564  g %s field is %d
-0008cc00: 2062 7574 2079 6f75 2068 6176 6520 6769   but you have gi
-0008cc10: 7665 6e20 2564 2076 6172 6961 626c 6520  ven %d variable 
-0008cc20: 6e61 6d65 7320 6f6e 6c79 2e20 5365 6c65  names only. Sele
-0008cc30: 6374 696e 6720 6669 7273 7420 2564 2720  cting first %d' 
-0008cc40: 2528 0d0a 2020 2020 2020 2020 2020 2020  %(..            
-0008cc50: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
-0008cc60: 642c 6d61 785f 7468 696e 6773 2c6c 656e  d,max_things,len
-0008cc70: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008cc80: 2c6c 656e 286e 6577 5f6e 616d 6573 5f6c  ,len(new_names_l
-0008cc90: 6973 7429 2929 0d0a 2020 2020 2323 2320  ist)))..    ### 
-0008cca0: 5468 6973 2063 7265 6174 6573 2061 206e  This creates a n
-0008ccb0: 6577 2066 6965 6c64 2074 6861 7420 636f  ew field that co
-0008ccc0: 756e 7473 2074 6865 206e 756d 6265 7220  unts the number 
-0008ccd0: 6f66 2074 6869 6e67 7320 7468 6174 2061  of things that a
-0008cce0: 7265 2069 6e20 7468 6174 2066 6965 6c64  re in that field
-0008ccf0: 2e0d 0a20 2020 206e 756d 5f70 726f 6475  ...    num_produ
-0008cd00: 6374 735f 7669 6577 6564 203d 2027 636f  cts_viewed = 'co
-0008cd10: 756e 745f 7468 696e 6773 5f69 6e5f 272b  unt_things_in_'+
-0008cd20: 6669 656c 640d 0a20 2020 2064 665b 6e75  field..    df[nu
-0008cd30: 6d5f 7072 6f64 7563 7473 5f76 6965 7765  m_products_viewe
-0008cd40: 645d 203d 2064 665b 6669 656c 645d 2e6d  d] = df[field].m
-0008cd50: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
-0008cd60: 2878 2e73 706c 6974 2822 3b22 2929 292e  (x.split(";"))).
-0008cd70: 7661 6c75 6573 0d0a 2020 2020 2323 2320  values..    ### 
-0008cd80: 436c 6561 6e20 7570 2074 6865 2066 6965  Clean up the fie
-0008cd90: 6c64 2073 7563 6820 7468 6174 2069 7420  ld such that it 
-0008cda0: 6861 7320 7468 6520 7269 6768 7420 6e75  has the right nu
-0008cdb0: 6d62 6572 206f 6620 7370 6c69 7420 6368  mber of split ch
-0008cdc0: 6172 7320 6f74 6865 7277 6973 6520 6164  ars otherwise ad
-0008cdd0: 6420 746f 2069 740d 0a20 2020 2064 665b  d to it..    df[
-0008cde0: 6669 656c 645d 203d 2064 665b 6669 656c  field] = df[fiel
-0008cdf0: 645d 2e6d 6170 286c 616d 6264 6120 783a  d].map(lambda x:
-0008ce00: 2078 2b73 706c 6974 7465 722a 286d 6178   x+splitter*(max
-0008ce10: 5f74 6869 6e67 732d 6c65 6e28 782e 7370  _things-len(x.sp
-0008ce20: 6c69 7428 223b 2229 2929 2069 6620 6c65  lit(";"))) if le
-0008ce30: 6e28 782e 7370 6c69 7428 223b 2229 2920  n(x.split(";")) 
-0008ce40: 3c20 6d61 785f 7468 696e 6773 2065 6c73  < max_things els
-0008ce50: 6520 7829 0d0a 2020 2020 2323 2323 2323  e x)..    ######
-0008ce60: 204e 6f77 2079 6f75 2063 7265 6174 6520   Now you create 
-0008ce70: 6e65 7720 6669 656c 6473 2062 7920 7370  new fields by sp
-0008ce80: 6c69 7420 7468 6520 6f6e 6520 6c61 7267  lit the one larg
-0008ce90: 6520 6669 656c 6420 2323 2323 2323 2323  e field ########
-0008cea0: 0d0a 2020 2020 6966 206e 6577 5f6e 616d  ..    if new_nam
-0008ceb0: 6573 5f6c 6973 7420 3d3d 2027 273a 0d0a  es_list == '':..
-0008cec0: 2020 2020 2020 2020 6e65 775f 6e61 6d65          new_name
-0008ced0: 735f 6c69 7374 203d 205b 6669 656c 642b  s_list = [field+
-0008cee0: 275f 272b 7374 7228 6929 2066 6f72 2069  '_'+str(i) for i
-0008cef0: 2069 6e20 7261 6e67 6528 312c 6d61 785f   in range(1,max_
-0008cf00: 7468 696e 6773 2b31 295d 0d0a 2020 2020  things+1)]..    
-0008cf10: 7472 793a 0d0a 2020 2020 2020 2020 666f  try:..        fo
-0008cf20: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-0008cf30: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
-0008cf40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0008cf50: 6466 5b66 6965 6c64 5d2e 6669 6c6c 6e61  df[field].fillna
-0008cf60: 2866 696c 6c65 722c 2069 6e70 6c61 6365  (filler, inplace
-0008cf70: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-0008cf80: 2020 2020 6466 2e6c 6f63 5b64 665b 6669      df.loc[df[fi
-0008cf90: 656c 645d 203d 3d20 7370 6c69 7474 6572  eld] == splitter
-0008cfa0: 2c20 6669 656c 645d 203d 2066 696c 6c65  , field] = fille
-0008cfb0: 720d 0a20 2020 2020 2020 2020 2020 2064  r..            d
-0008cfc0: 665b 6e65 775f 6e61 6d65 735f 6c69 7374  f[new_names_list
-0008cfd0: 5b69 5d5d 203d 2064 665b 6669 656c 645d  [i]] = df[field]
-0008cfe0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
-0008cff0: 2e73 706c 6974 2873 706c 6974 7465 7229  .split(splitter)
-0008d000: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-0008d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d020: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008d030: 6620 7370 6c69 7474 6572 2069 6e20 7820  f splitter in x 
-0008d040: 656c 7365 2078 290d 0a20 2020 2065 7863  else x)..    exc
-0008d050: 6570 743a 0d0a 2020 2020 2020 2020 2323  ept:..        ##
-0008d060: 2320 4368 6563 6b20 6966 2074 6865 2063  # Check if the c
-0008d070: 6f6c 756d 6e20 6973 2061 2073 7472 696e  olumn is a strin
-0008d080: 6720 636f 6c75 6d6e 2e20 4966 206e 6f74  g column. If not
-0008d090: 2c20 6769 7665 2061 6e20 6572 726f 7220  , give an error 
-0008d0a0: 6d65 7373 6167 652e 0d0a 2020 2020 2020  message...      
-0008d0b0: 2020 7072 696e 7428 2743 616e 6e6f 7420    print('Cannot 
-0008d0c0: 7370 6c69 7420 7468 6520 636f 6c75 6d6e  split the column
-0008d0d0: 2e20 4765 7474 696e 6720 616e 2065 7272  . Getting an err
-0008d0e0: 6f72 2e20 4368 6563 6b20 7468 6520 636f  or. Check the co
-0008d0f0: 6c75 6d6e 2061 6761 696e 2729 0d0a 2020  lumn again')..  
-0008d100: 2020 2020 2020 7265 7475 726e 2064 660d        return df.
-0008d110: 0a20 2020 2072 6574 7572 6e20 6466 2c20  .    return df, 
-0008d120: 6e65 775f 6e61 6d65 735f 6c69 7374 0d0a  new_names_list..
-0008d130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008d180: 230d 0a64 6566 2061 6464 5f61 6767 7265  #..def add_aggre
-0008d190: 6761 7465 5f70 7269 6d69 7469 7665 5f66  gate_primitive_f
-0008d1a0: 6561 7475 7265 7328 6466 742c 2061 6767  eatures(dft, agg
-0008d1b0: 5f74 7970 6573 2c20 6964 5f63 6f6c 756d  _types, id_colum
-0008d1c0: 6e2c 2069 676e 6f72 655f 7661 7269 6162  n, ignore_variab
-0008d1d0: 6c65 733d 5b5d 293a 0d0a 2020 2020 2222  les=[]):..    ""
-0008d1e0: 220d 0a20 2020 2023 2323 2020 204d 6f64  "..    ###   Mod
-0008d1f0: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
-0008d200: 2061 6464 696e 6720 636f 6d70 7574 6174   adding computat
-0008d210: 696f 6e61 6c20 7072 696d 6974 6976 6520  ional primitive 
-0008d220: 4665 6174 7572 6573 2075 7369 6e67 2046  Features using F
-0008d230: 6561 7475 7265 2054 6f6f 6c73 2023 2323  eature Tools ###
-0008d240: 230d 0a20 2020 2023 2323 2020 2057 6861  #..    ###   Wha
-0008d250: 7420 6172 6520 6167 6772 6567 6174 6520  t are aggregate 
-0008d260: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
-0008d270: 2061 7265 2074 6f20 226d 6561 6e22 226d   are to "mean""m
-0008d280: 6564 6961 6e22 2c22 6d6f 6465 222c 226d  edian","mode","m
-0008d290: 696e 222c 226d 6178 222c 2065 7463 2e20  in","max", etc. 
-0008d2a0: 6665 6174 7572 6573 0d0a 2020 2020 2323  features..    ##
-0008d2b0: 2320 496e 7075 7473 3a0d 0a20 2020 2023  # Inputs:..    #
-0008d2c0: 2323 2020 2064 663a 204a 7573 7420 7365  ##   df: Just se
-0008d2d0: 6e74 2069 6e20 7468 6520 6461 7461 2066  nt in the data f
-0008d2e0: 7261 6d65 2064 6620 7468 6174 2079 6f75  rame df that you
-0008d2f0: 2077 616e 7420 6665 6174 7572 6573 2061   want features a
-0008d300: 6464 6564 2074 6f0d 0a20 2020 2023 2323  dded to..    ###
-0008d310: 2020 2061 6767 5f74 7970 6573 3a20 6c69     agg_types: li
-0008d320: 7374 206f 6620 636f 6d70 7574 6174 696f  st of computatio
-0008d330: 6e61 6c20 7479 7065 733a 2027 6d65 616e  nal types: 'mean
-0008d340: 272c 276d 6564 6961 6e27 2c27 636f 756e  ','median','coun
-0008d350: 7427 2c20 276d 6178 272c 2027 6d69 6e27  t', 'max', 'min'
-0008d360: 2c20 2773 756d 272c 2065 7463 2e0d 0a20  , 'sum', etc... 
-0008d370: 2020 2023 2323 2020 2020 2020 2020 204f     ###         O
-0008d380: 6e65 2063 6176 6561 743a 2074 6865 7365  ne caveat: these
-0008d390: 2061 6767 5f74 7970 6573 206d 7573 7420   agg_types must 
-0008d3a0: 6265 2066 6f75 6e64 2069 6e20 7468 6520  be found in the 
-0008d3b0: 6167 675f 6675 6e63 206f 6620 6e75 6d70  agg_func of nump
-0008d3c0: 7920 6f72 2070 616e 6461 7320 6772 6f75  y or pandas grou
-0008d3d0: 7062 7920 7374 6174 656d 656e 742e 0d0a  pby statement...
-0008d3e0: 2020 2020 2323 2320 2020 2020 2020 2020      ###         
-0008d3f0: 666f 7220 6578 616d 706c 653a 206e 756d  for example: num
-0008d400: 7079 2068 6173 2027 6d65 6469 616e 272c  py has 'median',
-0008d410: 2770 726f 6427 2c27 7375 6d27 2c27 7374  'prod','sum','st
-0008d420: 6427 2c27 7661 7227 2c20 6574 632e 202d  d','var', etc. -
-0008d430: 2074 6865 7920 7769 6c6c 2077 6f72 6b21   they will work!
-0008d440: 0d0a 2020 2020 2323 2320 2020 6964 636f  ..    ###   idco
-0008d450: 6c75 6d6e 3a20 7468 6973 2069 7320 746f  lumn: this is to
-0008d460: 2063 7265 6174 6520 616e 2069 6e64 6578   create an index
-0008d470: 2066 6f72 2074 6865 2064 6174 6166 7261   for the datafra
-0008d480: 6d65 2073 696e 6365 2046 5420 7275 6e73  me since FT runs
-0008d490: 206f 6e20 696e 6465 7820 7661 7269 6162   on index variab
-0008d4a0: 6c65 2e20 596f 7520 6361 6e20 6c65 6176  le. You can leav
-0008d4b0: 6520 6974 2065 6d70 7479 2073 7472 696e  e it empty strin
-0008d4c0: 672e 0d0a 2020 2020 2323 2320 2020 6967  g...    ###   ig
-0008d4d0: 6e6f 7265 5f76 6172 6961 626c 6573 3a20  nore_variables: 
-0008d4e0: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
-0008d4f0: 7320 746f 2069 676e 6f72 6520 616d 6f6e  s to ignore amon
-0008d500: 6720 6e75 6d65 7269 6320 7661 7269 6162  g numeric variab
-0008d510: 6c65 7320 696e 2064 6174 6120 7369 6e63  les in data sinc
-0008d520: 6520 7468 6579 206d 6179 2062 6520 4944  e they may be ID
-0008d530: 2076 6172 6961 626c 6573 2e0d 0a20 2020   variables...   
-0008d540: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
-0008d550: 2063 6f70 790d 0a20 2020 2023 2323 204d   copy..    ### M
-0008d560: 616b 6520 7375 7265 2074 6865 206c 6973  ake sure the lis
-0008d570: 7420 6f66 2066 756e 6374 696f 6e73 2074  t of functions t
-0008d580: 6865 7920 7365 6e64 2069 6e20 6172 6520  hey send in are 
-0008d590: 6163 6365 7074 6162 6c65 2066 756e 6374  acceptable funct
-0008d5a0: 696f 6e73 2e20 4966 206e 6f74 2c20 7468  ions. If not, th
-0008d5b0: 6520 6167 6772 6567 6174 6520 7769 6c6c  e aggregate will
-0008d5c0: 2062 6c6f 7720 7570 210d 0a20 2020 2066   blow up!..    f
-0008d5d0: 756e 635f 7365 7420 3d20 7b27 636f 756e  unc_set = {'coun
-0008d5e0: 7427 2c27 7375 6d27 2c27 6d65 616e 272c  t','sum','mean',
-0008d5f0: 276d 6164 272c 276d 6564 6961 6e27 2c27  'mad','median','
-0008d600: 6d69 6e27 2c27 6d61 7827 2c27 6d6f 6465  min','max','mode
-0008d610: 272c 2761 6273 272c 2770 726f 6427 2c27  ','abs','prod','
-0008d620: 7374 6427 2c27 7661 7227 2c27 7365 6d27  std','var','sem'
-0008d630: 2c27 736b 6577 272c 276b 7572 7427 2c27  ,'skew','kurt','
-0008d640: 7175 616e 7469 6c65 272c 2763 756d 7375  quantile','cumsu
-0008d650: 6d27 2c27 6375 6d70 726f 6427 2c27 6375  m','cumprod','cu
-0008d660: 6d6d 6178 272c 2763 756d 6d69 6e27 7d0d  mmax','cummin'}.
-0008d670: 0a20 2020 2061 6767 5f74 7970 6573 203d  .    agg_types =
-0008d680: 206c 6973 7428 7365 7428 6167 675f 7479   list(set(agg_ty
-0008d690: 7065 7329 2e69 6e74 6572 7365 6374 696f  pes).intersectio
-0008d6a0: 6e28 6675 6e63 5f73 6574 2929 0d0a 2020  n(func_set))..  
-0008d6b0: 2020 2323 2320 4966 2074 6865 2069 676e    ### If the ign
-0008d6c0: 6f72 655f 7661 7269 6162 6c65 7320 6c69  ore_variables li
-0008d6d0: 7374 2069 7320 656d 7074 792c 206d 616b  st is empty, mak
-0008d6e0: 6520 7375 7265 2079 6f75 2061 6464 2074  e sure you add t
-0008d6f0: 6865 2069 645f 636f 6c75 6d6e 2074 6f20  he id_column to 
-0008d700: 6974 2073 6f20 6974 2063 616e 2062 6520  it so it can be 
-0008d710: 6472 6f70 7065 6420 6672 6f6d 2061 6767  dropped from agg
-0008d720: 7265 6761 7469 6f6e 2e0d 0a20 2020 2069  regation...    i
-0008d730: 6620 6c65 6e28 6967 6e6f 7265 5f76 6172  f len(ignore_var
-0008d740: 6961 626c 6573 2920 3d3d 2030 3a0d 0a20  iables) == 0:.. 
-0008d750: 2020 2020 2020 2069 676e 6f72 655f 7661         ignore_va
-0008d760: 7269 6162 6c65 7320 3d20 5b69 645f 636f  riables = [id_co
-0008d770: 6c75 6d6e 5d0d 0a20 2020 2023 2323 2053  lumn]..    ### S
-0008d780: 656c 6563 7420 6f6e 6c79 2069 6e74 6567  elect only integ
-0008d790: 6572 2061 6e64 2066 6c6f 6174 2076 6172  er and float var
-0008d7a0: 6961 626c 6573 2074 6f20 646f 2074 6869  iables to do thi
-0008d7b0: 7320 6167 6772 6567 6174 696f 6e20 6f6e  s aggregation on
-0008d7c0: 2e20 4265 2076 6572 7920 6361 7265 6675  . Be very carefu
-0008d7d0: 6c20 6966 2074 6865 7265 2061 7265 2074  l if there are t
-0008d7e0: 6f6f 206d 616e 7920 7661 7273 2e0d 0a20  oo many vars... 
-0008d7f0: 2020 2023 2323 2054 6869 7320 7769 6c6c     ### This will
-0008d800: 2074 616b 6520 7469 6d65 2074 6f20 7275   take time to ru
-0008d810: 6e20 696e 2074 6861 7420 6361 7365 2e0d  n in that case..
-0008d820: 0a20 2020 2064 6674 5f69 6e64 6578 203d  .    dft_index =
-0008d830: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
-0008d840: 6674 5b69 645f 636f 6c75 6d6e 5d29 0d0a  ft[id_column])..
-0008d850: 2020 2020 6466 745f 636f 6e74 203d 2063      dft_cont = c
-0008d860: 6f70 792e 6465 6570 636f 7079 2864 6674  opy.deepcopy(dft
-0008d870: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-0008d880: 6e75 6d62 6572 2729 2e64 726f 7028 6967  number').drop(ig
-0008d890: 6e6f 7265 5f76 6172 6961 626c 6573 2c61  nore_variables,a
-0008d8a0: 7869 733d 3129 290d 0a20 2020 2064 6674  xis=1))..    dft
-0008d8b0: 5f63 6f6e 745b 6964 5f63 6f6c 756d 6e5d  _cont[id_column]
-0008d8c0: 203d 2064 6674 5f69 6e64 6578 0d0a 2020   = dft_index..  
-0008d8d0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0008d8e0: 6466 745f 6675 6c6c 203d 2064 6674 5f63  dft_full = dft_c
-0008d8f0: 6f6e 742e 6772 6f75 7062 7928 6964 5f63  ont.groupby(id_c
-0008d900: 6f6c 756d 6e29 2e61 6767 2861 6767 5f74  olumn).agg(agg_t
-0008d910: 7970 6573 290d 0a20 2020 2065 7863 6570  ypes)..    excep
-0008d920: 743a 0d0a 2020 2020 2020 2020 2323 2320  t:..        ### 
-0008d930: 6966 2066 6f72 2073 6f6d 6520 7265 6173  if for some reas
-0008d940: 6f6e 2c20 7468 6520 6772 6f75 7062 7920  on, the groupby 
-0008d950: 626c 6f77 7320 7570 2c20 7468 656e 206a  blows up, then j
-0008d960: 7573 7420 7265 7475 726e 2074 6865 2064  ust return the d
-0008d970: 6174 6166 7261 6d65 2061 7320 6973 202d  ataframe as is -
-0008d980: 206e 6f20 6368 616e 6765 7321 0d0a 2020   no changes!..  
-0008d990: 2020 2020 2020 7265 7475 726e 2064 6674        return dft
-0008d9a0: 0d0a 2020 2020 636f 6c73 203d 205b 782b  ..    cols = [x+
-0008d9b0: 275f 272b 792b 275f 6279 5f27 2b69 645f  '_'+y+'_by_'+id_
-0008d9c0: 636f 6c75 6d6e 2066 6f72 2028 782c 7929  column for (x,y)
-0008d9d0: 2069 6e20 6466 745f 6675 6c6c 2e63 6f6c   in dft_full.col
-0008d9e0: 756d 6e73 5d0d 0a20 2020 2064 6674 5f66  umns]..    dft_f
-0008d9f0: 756c 6c2e 636f 6c75 6d6e 7320 3d20 636f  ull.columns = co
-0008da00: 6c73 0d0a 2020 2020 2323 2320 204e 6f74  ls..    ###  Not
-0008da10: 2065 7665 7279 2063 6f6c 756d 6e20 6861   every column ha
-0008da20: 7320 7573 6566 756c 2076 616c 7565 732e  s useful values.
-0008da30: 2049 6620 6974 2069 7320 6675 6c6c 206f   If it is full o
-0008da40: 6620 6a75 7374 2074 6865 2073 616d 6520  f just the same 
-0008da50: 7661 6c75 652c 2072 656d 6f76 6520 6974  value, remove it
-0008da60: 0d0a 2020 2020 5f2c 206c 6973 745f 756e  ..    _, list_un
-0008da70: 6971 7565 5f63 6f6c 5f69 6473 203d 206e  ique_col_ids = n
-0008da80: 702e 756e 6971 7565 2864 6674 5f66 756c  p.unique(dft_ful
-0008da90: 6c2c 2061 7869 7320 3d20 312c 2072 6574  l, axis = 1, ret
-0008daa0: 7572 6e5f 696e 6465 783d 5472 7565 290d  urn_index=True).
-0008dab0: 0a20 2020 2064 6674 5f66 756c 6c20 3d20  .    dft_full = 
-0008dac0: 6466 745f 6675 6c6c 2e69 6c6f 635b 3a2c  dft_full.iloc[:,
-0008dad0: 206c 6973 745f 756e 6971 7565 5f63 6f6c   list_unique_col
-0008dae0: 5f69 6473 5d0d 0a20 2020 2072 6574 7572  _ids]..    retur
-0008daf0: 6e20 6466 745f 6675 6c6c 0d0a 2323 2323  n dft_full..####
-0008db00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008db70: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
-0008db80: 706f 7274 2063 6f70 790d 0a69 6d70 6f72  port copy..impor
-0008db90: 7420 7469 6d65 0d0a 696d 706f 7274 2070  t time..import p
-0008dba0: 6462 0d0a 6465 6620 4645 5f63 7265 6174  db..def FE_creat
-0008dbb0: 655f 6772 6f75 7062 795f 6665 6174 7572  e_groupby_featur
-0008dbc0: 6573 2864 6674 2c20 6772 6f75 7062 795f  es(dft, groupby_
-0008dbd0: 636f 6c75 6d6e 732c 206e 756d 6572 6963  columns, numeric
-0008dbe0: 5f63 6f6c 756d 6e73 2c20 6167 675f 7479  _columns, agg_ty
-0008dbf0: 7065 7329 3a0d 0a20 2020 2022 2222 0d0a  pes):..    """..
-0008dc00: 2020 2020 4645 206d 6561 6e73 2046 4541      FE means FEA
-0008dc10: 5455 5245 2045 4e47 494e 4545 5249 4e47  TURE ENGINEERING
-0008dc20: 202d 2054 6861 7420 6d65 616e 7320 7468   - That means th
-0008dc30: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
-0008dc40: 2063 7265 6174 6520 6e65 7720 6665 6174   create new feat
-0008dc50: 7572 6573 0d0a 2020 2020 4265 7761 7265  ures..    Beware
-0008dc60: 3a20 7468 6973 2066 756e 6374 696f 6e20  : this function 
-0008dc70: 7769 6c6c 2072 6574 7572 6e20 6120 736d  will return a sm
-0008dc80: 616c 6c65 7220 6461 7461 6672 616d 6520  aller dataframe 
-0008dc90: 7468 616e 2077 6861 7420 796f 7520 7365  than what you se
-0008dca0: 6e64 2069 6e20 7369 6e63 6520 6974 2067  nd in since it g
-0008dcb0: 726f 7570 7320 726f 7773 2062 7920 6b65  roups rows by ke
-0008dcc0: 7973 2e0d 0a20 2020 2023 2323 2323 2323  ys...    #######
-0008dcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dd00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dd30: 2323 0d0a 2020 2020 4675 6e63 7469 6f6e  ##..    Function
-0008dd40: 2067 726f 7570 7320 726f 7773 2069 6e20   groups rows in 
-0008dd50: 6120 6466 7420 6461 7461 6672 616d 6520  a dft dataframe 
-0008dd60: 6279 2074 6865 2067 726f 7570 6279 5f63  by the groupby_c
-0008dd70: 6f6c 756d 6e73 2061 6e64 2072 6574 7572  olumns and retur
-0008dd80: 6e73 206d 756c 7469 706c 6520 636f 6c75  ns multiple colu
-0008dd90: 6d6e 7320 666f 7220 7468 6520 6e75 6d65  mns for the nume
-0008dda0: 7269 6320 636f 6c75 6d6e 2061 6767 7265  ric column aggre
-0008ddb0: 6761 7465 642e 0d0a 2020 2020 446f 206e  gated...    Do n
-0008ddc0: 6f74 2073 656e 6420 696e 206d 6f72 6520  ot send in more 
-0008ddd0: 7468 616e 206f 6e65 2063 6f6c 756d 6e20  than one column 
-0008dde0: 696e 2074 6865 206e 756d 6572 6963 2063  in the numeric c
-0008ddf0: 6f6c 756d 6e20 7369 6e63 6520 6265 796f  olumn since beyo
-0008de00: 6e64 2074 6865 2066 6972 7374 2063 6f6c  nd the first col
-0008de10: 756d 6e20 6974 2077 696c 6c20 6265 2069  umn it will be i
-0008de20: 676e 6f72 6564 210d 0a20 2020 2061 6767  gnored!..    agg
-0008de30: 5f74 7970 6520 6361 6e20 6265 2061 6e79  _type can be any
-0008de40: 206e 756d 7079 2066 756e 6374 696f 6e20   numpy function 
-0008de50: 7375 6368 2061 7320 6d65 616e 2c20 6d65  such as mean, me
-0008de60: 6469 616e 2c20 7375 6d2c 2063 6f75 6e74  dian, sum, count
-0008de70: 2c20 6574 632e 0d0a 2020 2020 2323 2323  , etc...    ####
-0008de80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008de90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008deb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ded0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008dee0: 2323 2323 2323 0d0a 2020 2020 5265 7475  ######..    Retu
-0008def0: 726e 733a 2061 2073 6d61 6c6c 6572 2064  rns: a smaller d
-0008df00: 6174 6166 7261 6d65 2077 6974 6820 726f  ataframe with ro
-0008df10: 7773 2067 726f 7570 6564 2062 7920 6772  ws grouped by gr
-0008df20: 6f75 7062 795f 636f 6c75 6d6e 7320 616e  oupby_columns an
-0008df30: 6420 6167 6772 6567 6174 6564 2066 6f72  d aggregated for
-0008df40: 2074 6865 206e 756d 6572 6963 5f63 6f6c   the numeric_col
-0008df50: 756d 6e0d 0a20 2020 2022 2222 0d0a 2020  umn..    """..  
-0008df60: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-0008df70: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
-0008df80: 6772 6f75 7065 645f 7365 7020 3d20 7064  grouped_sep = pd
-0008df90: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
-0008dfa0: 2020 7072 696e 7428 2741 7574 6f76 696d    print('Autovim
-0008dfb0: 6c20 4665 6174 7572 6520 456e 6769 6e65  l Feature Engine
-0008dfc0: 6572 696e 673a 2063 7265 6174 696e 6720  ering: creating 
-0008dfd0: 6772 6f75 7062 7920 6665 6174 7572 6573  groupby features
-0008dfe0: 2075 7369 6e67 2025 7327 2025 6772 6f75   using %s' %grou
-0008dff0: 7062 795f 636f 6c75 6d6e 7329 0d0a 2020  pby_columns)..  
-0008e000: 2020 2323 2323 2323 2323 2323 2020 5468    ##########  Th
-0008e010: 6973 2069 7320 7768 6572 6520 7765 2063  is is where we c
-0008e020: 7265 6174 6520 6e65 7720 636f 6c75 6d6e  reate new column
-0008e030: 7320 6279 2065 6163 6820 6e75 6d65 7269  s by each numeri
-0008e040: 6320 636f 6c75 6d6e 2067 726f 7570 6564  c column grouped
-0008e050: 2062 7920 6772 6f75 702d 6279 2063 6f6c   by group-by col
-0008e060: 756d 6e73 2067 6976 656e 2e0d 0a20 2020  umns given...   
-0008e070: 2069 6620 6973 696e 7374 616e 6365 286e   if isinstance(n
-0008e080: 756d 6572 6963 5f63 6f6c 756d 6e73 2c20  umeric_columns, 
-0008e090: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
-0008e0a0: 7061 7373 0d0a 2020 2020 656c 6966 2069  pass..    elif i
-0008e0b0: 7369 6e73 7461 6e63 6528 6e75 6d65 7269  sinstance(numeri
-0008e0c0: 635f 636f 6c75 6d6e 2c20 7374 7229 3a0d  c_column, str):.
-0008e0d0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-0008e0e0: 5f63 6f6c 756d 6e73 203d 205b 6e75 6d65  _columns = [nume
-0008e0f0: 7269 635f 636f 6c75 6d6e 735d 0d0a 2020  ric_columns]..  
-0008e100: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0008e110: 2070 7269 6e74 2827 2020 2020 4e75 6d65   print('    Nume
-0008e120: 7269 6320 636f 6c75 6d6e 206d 7573 7420  ric column must 
-0008e130: 6265 2061 2073 7472 696e 6720 6e6f 7420  be a string not 
-0008e140: 6120 6e75 6d62 6572 2054 7279 2061 6761  a number Try aga
-0008e150: 696e 2729 0d0a 2020 2020 2020 2020 7265  in')..        re
-0008e160: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
-0008e170: 6528 290d 0a20 2020 2067 726f 7570 6564  e()..    grouped
-0008e180: 5f6c 6973 7420 3d20 7064 2e44 6174 6146  _list = pd.DataF
-0008e190: 7261 6d65 2829 0d0a 2020 2020 666f 7220  rame()..    for 
-0008e1a0: 6974 6572 6174 696f 6e2c 206e 756d 6572  iteration, numer
-0008e1b0: 6963 5f63 6f6c 756d 6e20 696e 207a 6970  ic_column in zip
-0008e1c0: 2872 616e 6765 286c 656e 286e 756d 6572  (range(len(numer
-0008e1d0: 6963 5f63 6f6c 756d 6e73 2929 2c6e 756d  ic_columns)),num
-0008e1e0: 6572 6963 5f63 6f6c 756d 6e73 293a 0d0a  eric_columns):..
-0008e1f0: 2020 2020 2020 2020 6772 6f75 7065 6420          grouped 
-0008e200: 3d20 6466 742e 6772 6f75 7062 7928 6772  = dft.groupby(gr
-0008e210: 6f75 7062 795f 636f 6c75 6d6e 7329 5b5b  oupby_columns)[[
-0008e220: 6e75 6d65 7269 635f 636f 6c75 6d6e 5d5d  numeric_column]]
-0008e230: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0008e240: 2020 2020 2020 2020 2020 2020 6167 675f              agg_
-0008e250: 7479 7065 203d 2061 6767 5f74 7970 6573  type = agg_types
-0008e260: 5b69 7465 7261 7469 6f6e 5d0d 0a20 2020  [iteration]..   
-0008e270: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-0008e280: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0008e290: 2720 2020 204e 6f20 6167 6772 6567 6174  '    No aggregat
-0008e2a0: 696f 6e20 7479 7065 2067 6976 656e 2c20  ion type given, 
-0008e2b0: 6865 6e63 6520 6d65 616e 2069 7320 6368  hence mean is ch
-0008e2c0: 6f73 656e 2062 7920 6465 6661 756c 7427  osen by default'
-0008e2d0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-0008e2e0: 6767 5f74 7970 6520 3d20 276d 6561 6e27  gg_type = 'mean'
-0008e2f0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0008e300: 2020 2020 2020 2020 2020 2020 7072 6566              pref
-0008e310: 6978 203d 206e 756d 6572 6963 5f63 6f6c  ix = numeric_col
-0008e320: 756d 6e20 2b20 275f 270d 0a20 2020 2020  umn + '_'..     
-0008e330: 2020 2020 2020 2069 6620 6167 675f 7479         if agg_ty
-0008e340: 7065 2069 6e20 5b27 5375 6d27 2c20 2773  pe in ['Sum', 's
-0008e350: 756d 275d 3a0d 0a20 2020 2020 2020 2020  um']:..         
-0008e360: 2020 2020 2020 2067 726f 7570 6564 5f61         grouped_a
-0008e370: 6767 203d 2067 726f 7570 6564 2e73 756d  gg = grouped.sum
-0008e380: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0008e390: 656c 6966 2061 6767 5f74 7970 6520 696e  elif agg_type in
-0008e3a0: 205b 274d 6561 6e27 2c20 276d 6561 6e27   ['Mean', 'mean'
-0008e3b0: 2c27 4176 6572 6167 6527 2c27 6176 6572  ,'Average','aver
-0008e3c0: 6167 6527 5d3a 0d0a 2020 2020 2020 2020  age']:..        
-0008e3d0: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
-0008e3e0: 6167 6720 3d20 6772 6f75 7065 642e 6d65  agg = grouped.me
-0008e3f0: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
-0008e400: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
-0008e410: 696e 205b 2763 6f75 6e74 272c 2027 436f  in ['count', 'Co
-0008e420: 756e 7427 5d3a 0d0a 2020 2020 2020 2020  unt']:..        
-0008e430: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
-0008e440: 6167 6720 3d20 6772 6f75 7065 642e 636f  agg = grouped.co
-0008e450: 756e 7428 290d 0a20 2020 2020 2020 2020  unt()..         
-0008e460: 2020 2065 6c69 6620 6167 675f 7479 7065     elif agg_type
-0008e470: 2069 6e20 5b27 4d65 6469 616e 272c 2027   in ['Median', '
-0008e480: 6d65 6469 616e 275d 3a0d 0a20 2020 2020  median']:..     
-0008e490: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0008e4a0: 6564 5f61 6767 203d 2067 726f 7570 6564  ed_agg = grouped
-0008e4b0: 2e6d 6564 6961 6e28 290d 0a20 2020 2020  .median()..     
-0008e4c0: 2020 2020 2020 2065 6c69 6620 6167 675f         elif agg_
-0008e4d0: 7479 7065 2069 6e20 5b27 4d61 7869 6d75  type in ['Maximu
-0008e4e0: 6d27 2c20 276d 6178 696d 756d 272c 276d  m', 'maximum','m
-0008e4f0: 6178 272c 2027 4d61 7827 5d3a 0d0a 2020  ax', 'Max']:..  
-0008e500: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0008e510: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
-0008e520: 616d 6f75 6e74 730d 0a20 2020 2020 2020  amounts..       
-0008e530: 2020 2020 2020 2020 2067 726f 7570 6564           grouped
-0008e540: 5f61 6767 203d 2067 726f 7570 6564 2e6d  _agg = grouped.m
-0008e550: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
-0008e560: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
-0008e570: 696e 205b 274d 696e 696d 756d 272c 2027  in ['Minimum', '
-0008e580: 6d69 6e69 6d75 6d27 2c27 6d69 6e27 2c20  minimum','min', 
-0008e590: 274d 696e 275d 3a0d 0a20 2020 2020 2020  'Min']:..       
-0008e5a0: 2020 2020 2020 2020 2023 2320 6d61 7869           ## maxi
-0008e5b0: 6d75 6d20 6f66 2074 6865 2061 6d6f 756e  mum of the amoun
-0008e5c0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-0008e5d0: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
-0008e5e0: 3d20 6772 6f75 7065 642e 6d69 6e28 290d  = grouped.min().
-0008e5f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0008e600: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0008e610: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
-0008e620: 3d20 6772 6f75 7065 642e 6d65 616e 2829  = grouped.mean()
-0008e630: 0d0a 2020 2020 2020 2020 2020 2020 6772  ..            gr
-0008e640: 6f75 7065 645f 7365 7020 3d20 6772 6f75  ouped_sep = grou
-0008e650: 7065 645f 6167 672e 756e 7374 6163 6b28  ped_agg.unstack(
-0008e660: 292e 6164 645f 7072 6566 6978 2870 7265  ).add_prefix(pre
-0008e670: 6669 7829 2e66 696c 6c6e 6128 3029 0d0a  fix).fillna(0)..
-0008e680: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-0008e690: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0008e6a0: 6e74 2827 2020 2020 4572 726f 7220 696e  nt('    Error in
-0008e6b0: 2063 7265 6174 696e 6720 6772 6f75 7062   creating groupb
-0008e6c0: 7920 6665 6174 7572 6573 2e2e 2e72 6574  y features...ret
-0008e6d0: 7572 6e69 6e67 2077 6974 6820 6e75 6c6c  urning with null
-0008e6e0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
-0008e6f0: 2020 2020 2020 2020 2020 6772 6f75 7065            groupe
-0008e700: 645f 7365 7020 3d20 7064 2e44 6174 6146  d_sep = pd.DataF
-0008e710: 7261 6d65 2829 0d0a 2020 2020 2020 2020  rame()..        
-0008e720: 6966 2069 7465 7261 7469 6f6e 203d 3d20  if iteration == 
-0008e730: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0008e740: 6772 6f75 7065 645f 6c69 7374 203d 2063  grouped_list = c
-0008e750: 6f70 792e 6465 6570 636f 7079 2867 726f  opy.deepcopy(gro
-0008e760: 7570 6564 5f73 6570 290d 0a20 2020 2020  uped_sep)..     
-0008e770: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0008e780: 2020 2020 2020 6772 6f75 7065 645f 6c69        grouped_li
-0008e790: 7374 203d 2070 642e 636f 6e63 6174 285b  st = pd.concat([
-0008e7a0: 6772 6f75 7065 645f 6c69 7374 2c67 726f  grouped_list,gro
-0008e7b0: 7570 6564 5f73 6570 5d2c 6178 6973 3d31  uped_sep],axis=1
-0008e7c0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-0008e7d0: 2827 2020 2020 4166 7465 7220 6772 6f75  ('    After grou
-0008e7e0: 7065 6420 6665 6174 7572 6573 2061 6464  ped features add
-0008e7f0: 6564 2062 7920 2573 2c20 6e75 6d62 6572  ed by %s, number
-0008e800: 206f 6620 636f 6c75 6d6e 7320 3d20 2564   of columns = %d
-0008e810: 2720 2528 6e75 6d65 7269 635f 636f 6c75  ' %(numeric_colu
-0008e820: 6d6e 2c20 6772 6f75 7065 645f 6c69 7374  mn, grouped_list
-0008e830: 2e73 6861 7065 5b31 5d29 290d 0a20 2020  .shape[1]))..   
-0008e840: 2023 2323 2320 6f6e 6365 2065 7665 7279   #### once every
-0008e850: 7468 696e 6720 6973 2064 6f6e 652c 2079  thing is done, y
-0008e860: 6f75 2063 616e 2063 6c6f 7365 2069 7420  ou can close it 
-0008e870: 6865 7265 0d0a 2020 2020 7072 696e 7428  here..    print(
-0008e880: 2754 696d 6520 7461 6b65 6e20 666f 7220  'Time taken for 
-0008e890: 6372 6561 7469 6f6e 206f 6620 6772 6f75  creation of grou
-0008e8a0: 7062 7920 6665 6174 7572 6573 2028 696e  pby features (in
-0008e8b0: 2073 6563 6f6e 6473 2920 3d20 2530 2e30   seconds) = %0.0
-0008e8c0: 6627 2025 2874 696d 652e 7469 6d65 2829  f' %(time.time()
-0008e8d0: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
-0008e8e0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0008e8f0: 2067 726f 7570 6564 5f6c 6973 742e 636f   grouped_list.co
-0008e900: 6c75 6d6e 7320 3d20 6772 6f75 7065 645f  lumns = grouped_
-0008e910: 6c69 7374 2e63 6f6c 756d 6e73 2e67 6574  list.columns.get
-0008e920: 5f6c 6576 656c 5f76 616c 7565 7328 3129  _level_values(1)
-0008e930: 0d0a 2020 2020 2020 2020 6772 6f75 7065  ..        groupe
-0008e940: 645f 6c69 7374 2e63 6f6c 756d 6e73 2e6e  d_list.columns.n
-0008e950: 616d 6520 3d20 4e6f 6e65 2023 2320 6d61  ame = None ## ma
-0008e960: 6b65 2073 7572 6520 7468 6520 6e61 6d65  ke sure the name
-0008e970: 206f 6e20 636f 6c75 6d6e 7320 6973 2072   on columns is r
-0008e980: 656d 6f76 6564 0d0a 2020 2020 2020 2020  emoved..        
-0008e990: 6772 6f75 7065 645f 6c69 7374 203d 2067  grouped_list = g
-0008e9a0: 726f 7570 6564 5f6c 6973 742e 7265 7365  rouped_list.rese
-0008e9b0: 745f 696e 6465 7828 2920 2323 206d 616b  t_index() ## mak
-0008e9c0: 6520 7375 7265 2074 6865 2049 4420 636f  e sure the ID co
-0008e9d0: 6c75 6d6e 2063 6f6d 6573 2062 6163 6b0d  lumn comes back.
-0008e9e0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-0008e9f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-0008ea00: 4572 726f 7220 696e 2073 6574 7469 6e67  Error in setting
-0008ea10: 2063 6f6c 756d 6e20 6e61 6d65 732e 2050   column names. P
-0008ea20: 6c65 6173 6520 7265 7365 7420 636f 6c75  lease reset colu
-0008ea30: 6d6e 206e 616d 6573 2061 6674 6572 2074  mn names after t
-0008ea40: 6869 7320 7374 6570 2e2e 2e27 290d 0a20  his step...').. 
-0008ea50: 2020 2072 6574 7572 6e20 6772 6f75 7065     return groupe
-0008ea60: 645f 6c69 7374 0d0a 2323 2323 2323 2323  d_list..########
-0008ea70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ea80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008ea90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eaa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008eab0: 2323 2323 2323 2323 0000 0000 0000 0000  ########........
-0008eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0008ec10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ec60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0008ec70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0008ec80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0008ec90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-0008eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0008ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0008ed50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-0008ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee00: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
-0008ee10: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
-0008ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ee90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-0008f010: 2f61 7574 6f76 696d 6c2f 7375 6c6f 765f  /autoviml/sulov_
-0008f020: 6d65 7468 6f64 2e70 7900 0000 0000 0000  method.py.......
-0008f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-0008f070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-0008f080: 3030 3333 3234 3500 3030 3030 3030 3030  0033245.00000000
-0008f090: 3030 3000 3032 3030 3436 0020 3000 0000  000.020046. 0...
-0008f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008c380: 2020 7669 6577 5f74 696d 6520 3d20 2770    view_time = 'p
+0008c390: 726f 6365 7373 696e 6727 2b73 7461 7274  rocessing'+start
+0008c3a0: 5469 6d65 2b27 5f65 6c61 7073 6564 5f74  Time+'_elapsed_t
+0008c3b0: 696d 6527 0d0a 2020 2020 2020 2020 736d  ime'..        sm
+0008c3c0: 616c 6c64 665b 7669 6577 5f74 696d 655d  alldf[view_time]
+0008c3d0: 203d 2028 7064 2e74 6f5f 6461 7465 7469   = (pd.to_dateti
+0008c3e0: 6d65 2873 6d61 6c6c 6466 5b65 6e64 5f74  me(smalldf[end_t
+0008c3f0: 696d 655d 2920 2d20 7064 2e74 6f5f 6461  ime]) - pd.to_da
+0008c400: 7465 7469 6d65 2873 6d61 6c6c 6466 5b73  tetime(smalldf[s
+0008c410: 7461 7274 5f74 696d 655d 2929 2e61 7374  tart_time])).ast
+0008c420: 7970 6528 2774 696d 6564 656c 7461 3634  ype('timedelta64
+0008c430: 5b73 5d27 292e 7661 6c75 6573 0d0a 2020  [s]').values..  
+0008c440: 2020 2020 2020 6164 645f 636f 6c73 2e61        add_cols.a
+0008c450: 7070 656e 6428 7669 6577 5f74 696d 6529  ppend(view_time)
+0008c460: 0d0a 2020 2020 6578 6365 7074 3a0d 0a20  ..    except:.. 
+0008c470: 2020 2020 2020 2023 2323 2049 6e20 736f         ### In so
+0008c480: 6d65 2064 6174 6520 7469 6d65 2066 6965  me date time fie
+0008c490: 6c64 7320 7468 6973 2067 6976 6573 2061  lds this gives a
+0008c4a0: 6e20 6572 726f 7220 736f 2073 6b69 7020  n error so skip 
+0008c4b0: 6974 2069 6e20 7468 6174 2063 6173 650d  it in that case.
+0008c4c0: 0a20 2020 2020 2020 2070 6173 730d 0a20  .        pass.. 
+0008c4d0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
+0008c4e0: 6f6e 2077 6520 6368 6f73 6520 656e 6454  on we chose endT
+0008c4f0: 696d 6520 6865 7265 2069 7320 7468 6174  ime here is that
+0008c500: 2073 7461 7274 5469 6d65 2069 7320 7573   startTime is us
+0008c510: 7561 6c6c 7920 7461 6b65 6e20 6361 7265  ually taken care
+0008c520: 206f 6620 6279 2061 6e6f 7468 6572 206c   of by another l
+0008c530: 6962 7261 7279 2e20 536f 2062 6574 7465  ibrary. So bette
+0008c540: 7220 746f 2064 6f20 7468 6973 2061 6c6f  r to do this alo
+0008c550: 6e65 2e0d 0a20 2020 2079 6561 7220 3d20  ne...    year = 
+0008c560: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
+0008c570: 5469 6d65 2b27 5f65 6e64 5f79 6561 7227  Time+'_end_year'
+0008c580: 0d0a 2020 2020 736d 616c 6c64 665b 7965  ..    smalldf[ye
+0008c590: 6172 5d20 3d20 736d 616c 6c64 665b 656e  ar] = smalldf[en
+0008c5a0: 645f 6461 7465 5d2e 6d61 7028 6c61 6d62  d_date].map(lamb
+0008c5b0: 6461 2078 3a20 7374 7228 7829 2e73 706c  da x: str(x).spl
+0008c5c0: 6974 2873 706c 6974 7465 725f 6461 7465  it(splitter_date
+0008c5d0: 5f73 7472 696e 6729 5b30 5d29 2e76 616c  _string)[0]).val
+0008c5e0: 7565 730d 0a20 2020 2061 6464 5f63 6f6c  ues..    add_col
+0008c5f0: 732e 6170 7065 6e64 2879 6561 7229 0d0a  s.append(year)..
+0008c600: 2020 2020 2323 2323 2054 6865 2072 6561      #### The rea
+0008c610: 736f 6e20 7765 2063 686f 7365 2065 6e64  son we chose end
+0008c620: 5469 6d65 2068 6572 6520 6973 2074 6861  Time here is tha
+0008c630: 7420 7374 6172 7454 696d 6520 6973 2075  t startTime is u
+0008c640: 7375 616c 6c79 2074 616b 656e 2063 6172  sually taken car
+0008c650: 6520 6f66 2062 7920 616e 6f74 6865 7220  e of by another 
+0008c660: 6c69 6272 6172 792e 2053 6f20 6265 7474  library. So bett
+0008c670: 6572 2074 6f20 646f 2074 6869 7320 616c  er to do this al
+0008c680: 6f6e 652e 0d0a 2020 2020 6d6f 6e74 6820  one...    month 
+0008c690: 3d20 2770 726f 6365 7373 696e 6727 2b65  = 'processing'+e
+0008c6a0: 6e64 5469 6d65 2b27 5f65 6e64 5f6d 6f6e  ndTime+'_end_mon
+0008c6b0: 7468 270d 0a20 2020 2073 6d61 6c6c 6466  th'..    smalldf
+0008c6c0: 5b6d 6f6e 7468 5d20 3d20 736d 616c 6c64  [month] = smalld
+0008c6d0: 665b 656e 645f 6461 7465 5d2e 6d61 7028  f[end_date].map(
+0008c6e0: 6c61 6d62 6461 2078 3a20 7374 7228 7829  lambda x: str(x)
+0008c6f0: 2e73 706c 6974 2873 706c 6974 7465 725f  .split(splitter_
+0008c700: 6461 7465 5f73 7472 696e 6729 5b31 5d29  date_string)[1])
+0008c710: 2e76 616c 7565 730d 0a20 2020 2061 6464  .values..    add
+0008c720: 5f63 6f6c 732e 6170 7065 6e64 286d 6f6e  _cols.append(mon
+0008c730: 7468 290d 0a20 2020 2074 7279 3a0d 0a20  th)..    try:.. 
+0008c740: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
+0008c750: 7265 6173 6f6e 2077 6520 6368 6f73 6520  reason we chose 
+0008c760: 656e 6454 696d 6520 6865 7265 2069 7320  endTime here is 
+0008c770: 7468 6174 2073 7461 7274 5469 6d65 2069  that startTime i
+0008c780: 7320 7573 7561 6c6c 7920 7461 6b65 6e20  s usually taken 
+0008c790: 6361 7265 206f 6620 6279 2061 6e6f 7468  care of by anoth
+0008c7a0: 6572 206c 6962 7261 7279 2e20 536f 2062  er library. So b
+0008c7b0: 6574 7465 7220 746f 2064 6f20 7468 6973  etter to do this
+0008c7c0: 2061 6c6f 6e65 2e0d 0a20 2020 2020 2020   alone...       
+0008c7d0: 2064 6179 6e75 6d20 3d20 2770 726f 6365   daynum = 'proce
+0008c7e0: 7373 696e 6727 2b65 6e64 5469 6d65 2b27  ssing'+endTime+'
+0008c7f0: 5f65 6e64 5f64 6179 5f6e 756d 6265 7227  _end_day_number'
+0008c800: 0d0a 2020 2020 2020 2020 736d 616c 6c64  ..        smalld
+0008c810: 665b 6461 796e 756d 5d20 3d20 736d 616c  f[daynum] = smal
+0008c820: 6c64 665b 656e 645f 6461 7465 5d2e 6d61  ldf[end_date].ma
+0008c830: 7028 6c61 6d62 6461 2078 3a20 7374 7228  p(lambda x: str(
+0008c840: 7829 2e73 706c 6974 2873 706c 6974 7465  x).split(splitte
+0008c850: 725f 6461 7465 5f73 7472 696e 6729 5b32  r_date_string)[2
+0008c860: 5d29 2e76 616c 7565 730d 0a20 2020 2020  ]).values..     
+0008c870: 2020 2061 6464 5f63 6f6c 732e 6170 7065     add_cols.appe
+0008c880: 6e64 2864 6179 6e75 6d29 0d0a 2020 2020  nd(daynum)..    
+0008c890: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0008c8a0: 2023 2323 2049 6e20 736f 6d65 2064 6174   ### In some dat
+0008c8b0: 6520 7469 6d65 2066 6965 6c64 7320 7468  e time fields th
+0008c8c0: 6520 6461 7920 6e75 6d62 6572 2069 7320  e day number is 
+0008c8d0: 6e6f 7420 7468 6572 652e 2049 6620 6e6f  not there. If no
+0008c8e0: 742c 206a 7573 7420 736b 6970 2069 7420  t, just skip it 
+0008c8f0: 2323 2323 0d0a 2020 2020 2020 2020 7061  ####..        pa
+0008c900: 7373 0d0a 2020 2020 2323 2323 2049 6e20  ss..    #### In 
+0008c910: 736f 6d65 2064 6174 6520 7469 6d65 2066  some date time f
+0008c920: 6965 6c64 732c 2074 6865 2068 6f75 7220  ields, the hour 
+0008c930: 616e 6420 6d69 6e75 7465 2069 7320 6e6f  and minute is no
+0008c940: 7420 7468 6572 652c 2073 6f20 736b 6970  t there, so skip
+0008c950: 2069 7420 696e 2074 6861 7420 6361 7365   it in that case
+0008c960: 2069 6620 6974 2065 7272 6f72 7321 0d0a   if it errors!..
+0008c970: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0008c980: 2020 7374 6172 745f 686f 7572 203d 2027    start_hour = '
+0008c990: 7072 6f63 6573 7369 6e67 272b 7374 6172  processing'+star
+0008c9a0: 7454 696d 652b 275f 7374 6172 745f 686f  tTime+'_start_ho
+0008c9b0: 7572 270d 0a20 2020 2020 2020 2073 6d61  ur'..        sma
+0008c9c0: 6c6c 6466 5b73 7461 7274 5f68 6f75 725d  lldf[start_hour]
+0008c9d0: 203d 2073 6d61 6c6c 6466 5b73 7461 7274   = smalldf[start
+0008c9e0: 5f74 696d 655d 2e6d 6170 286c 616d 6264  _time].map(lambd
+0008c9f0: 6120 783a 2073 7472 2878 292e 7370 6c69  a x: str(x).spli
+0008ca00: 7428 7370 6c69 7474 6572 5f68 6f75 725f  t(splitter_hour_
+0008ca10: 7374 7269 6e67 295b 305d 292e 7661 6c75  string)[0]).valu
+0008ca20: 6573 0d0a 2020 2020 2020 2020 6164 645f  es..        add_
+0008ca30: 636f 6c73 2e61 7070 656e 6428 7374 6172  cols.append(star
+0008ca40: 745f 686f 7572 290d 0a20 2020 2020 2020  t_hour)..       
+0008ca50: 2073 7461 7274 5f6d 696e 203d 2027 7072   start_min = 'pr
+0008ca60: 6f63 6573 7369 6e67 272b 7374 6172 7454  ocessing'+startT
+0008ca70: 696d 652b 275f 7374 6172 745f 686f 7572  ime+'_start_hour
+0008ca80: 270d 0a20 2020 2020 2020 2073 6d61 6c6c  '..        small
+0008ca90: 6466 5b73 7461 7274 5f6d 696e 5d20 3d20  df[start_min] = 
+0008caa0: 736d 616c 6c64 665b 7374 6172 745f 7469  smalldf[start_ti
+0008cab0: 6d65 5d2e 6d61 7028 6c61 6d62 6461 2078  me].map(lambda x
+0008cac0: 3a20 7374 7228 7829 2e73 706c 6974 2873  : str(x).split(s
+0008cad0: 706c 6974 7465 725f 686f 7572 5f73 7472  plitter_hour_str
+0008cae0: 696e 6729 5b31 5d29 2e76 616c 7565 730d  ing)[1]).values.
+0008caf0: 0a20 2020 2020 2020 2061 6464 5f63 6f6c  .        add_col
+0008cb00: 732e 6170 7065 6e64 2873 7461 7274 5f6d  s.append(start_m
+0008cb10: 696e 290d 0a20 2020 2065 7863 6570 743a  in)..    except:
+0008cb20: 0d0a 2020 2020 2020 2020 2323 2320 4966  ..        ### If
+0008cb30: 2069 7420 6572 726f 7273 2c20 736b 6970   it errors, skip
+0008cb40: 2069 740d 0a20 2020 2020 2020 2070 6173   it..        pas
+0008cb50: 730d 0a20 2020 2023 2323 2320 4368 6563  s..    #### Chec
+0008cb60: 6b20 6966 2074 6865 7265 2069 7320 6120  k if there is a 
+0008cb70: 7765 656b 6461 7920 616e 6420 7765 656b  weekday and week
+0008cb80: 656e 6473 2069 6e20 6461 7465 2074 696d  ends in date tim
+0008cb90: 6520 636f 6c75 6d6e 7320 7573 696e 6720  e columns using 
+0008cba0: 656e 6454 696d 6520 6f6e 6c79 0d0a 2020  endTime only..  
+0008cbb0: 2020 7765 656b 6461 795f 6e75 6d20 3d20    weekday_num = 
+0008cbc0: 2770 726f 6365 7373 696e 6727 2b65 6e64  'processing'+end
+0008cbd0: 5469 6d65 2b27 5f65 6e64 5f77 6565 6b64  Time+'_end_weekd
+0008cbe0: 6179 5f6e 756d 6265 7227 0d0a 2020 2020  ay_number'..    
+0008cbf0: 736d 616c 6c64 665b 7765 656b 6461 795f  smalldf[weekday_
+0008cc00: 6e75 6d5d 203d 2070 642e 746f 5f64 6174  num] = pd.to_dat
+0008cc10: 6574 696d 6528 736d 616c 6c64 665b 656e  etime(smalldf[en
+0008cc20: 645f 6461 7465 5d29 2e64 742e 7765 656b  d_date]).dt.week
+0008cc30: 6461 792e 7661 6c75 6573 0d0a 2020 2020  day.values..    
+0008cc40: 6164 645f 636f 6c73 2e61 7070 656e 6428  add_cols.append(
+0008cc50: 7765 656b 6461 795f 6e75 6d29 0d0a 2020  weekday_num)..  
+0008cc60: 2020 7765 656b 656e 6420 3d20 2770 726f    weekend = 'pro
+0008cc70: 6365 7373 696e 6727 2b65 6e64 5469 6d65  cessing'+endTime
+0008cc80: 2b27 5f65 6e64 5f77 6565 6b65 6e64 5f66  +'_end_weekend_f
+0008cc90: 6c61 6727 0d0a 2020 2020 736d 616c 6c64  lag'..    smalld
+0008cca0: 665b 7765 656b 656e 645d 203d 2073 6d61  f[weekend] = sma
+0008ccb0: 6c6c 6466 5b77 6565 6b64 6179 5f6e 756d  lldf[weekday_num
+0008ccc0: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
+0008ccd0: 3120 6966 2078 2069 6e5b 352c 365d 2065  1 if x in[5,6] e
+0008cce0: 6c73 6520 3029 0d0a 2020 2020 6164 645f  lse 0)..    add_
+0008ccf0: 636f 6c73 2e61 7070 656e 6428 7765 656b  cols.append(week
+0008cd00: 656e 6429 0d0a 2020 2020 2323 2323 2049  end)..    #### I
+0008cd10: 6620 6576 6572 7974 6869 6e67 2077 6f72  f everything wor
+0008cd20: 6b73 2077 656c 6c2c 2074 6865 7265 2073  ks well, there s
+0008cd30: 686f 756c 6420 6265 2031 3320 6e65 7720  hould be 13 new 
+0008cd40: 636f 6c75 6d6e 7320 6164 6465 6420 6279  columns added by
+0008cd50: 206d 6f64 756c 652e 2041 6c6c 2074 6865   module. All the
+0008cd60: 2062 6573 7421 0d0a 2020 2020 7072 696e   best!..    prin
+0008cd70: 7428 2725 6420 636f 6c75 6d6e 7320 6164  t('%d columns ad
+0008cd80: 6465 6420 7573 696e 6720 7374 6172 7420  ded using start 
+0008cd90: 6461 7465 3d25 7320 616e 6420 656e 6420  date=%s and end 
+0008cda0: 6461 7465 3d25 7320 7072 6f63 6573 7369  date=%s processi
+0008cdb0: 6e67 2e2e 2e27 2025 286c 656e 2861 6464  ng...' %(len(add
+0008cdc0: 5f63 6f6c 7329 2c73 7461 7274 5469 6d65  _cols),startTime
+0008cdd0: 2c65 6e64 5469 6d65 2929 0d0a 2020 2020  ,endTime))..    
+0008cde0: 7265 7475 726e 2073 6d61 6c6c 6466 0d0a  return smalldf..
+0008cdf0: 230d 0a23 2323 2323 2323 2323 2323 2323  #..#############
+0008ce00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ce10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ce20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ce30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ce40: 2323 2323 0d0a 6465 6620 7370 6c69 745f  ####..def split_
+0008ce50: 6f6e 655f 6669 656c 645f 696e 746f 5f6d  one_field_into_m
+0008ce60: 616e 7928 6466 2c20 6669 656c 642c 2073  any(df, field, s
+0008ce70: 706c 6974 7465 722c 2066 696c 6c65 722c  plitter, filler,
+0008ce80: 206e 6577 5f6e 616d 6573 5f6c 6973 7429   new_names_list)
+0008ce90: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+0008cea0: 5468 6973 206c 6974 746c 6520 6675 6e63  This little func
+0008ceb0: 7469 6f6e 2074 616b 6573 2061 6e79 2064  tion takes any d
+0008cec0: 6174 6120 6672 616d 6520 6669 656c 6420  ata frame field 
+0008ced0: 2873 7472 696e 6720 7661 7269 6162 6c65  (string variable
+0008cee0: 7320 6f6e 6c79 2920 616e 6420 7370 6c69  s only) and spli
+0008cef0: 7473 0d0a 2020 2020 6974 2069 6e74 6f20  ts..    it into 
+0008cf00: 6173 206d 616e 7920 6669 656c 6473 2061  as many fields a
+0008cf10: 7320 796f 7520 7761 6e74 2069 6e20 7468  s you want in th
+0008cf20: 6520 6e65 775f 6e61 6d65 735f 6c69 7374  e new_names_list
+0008cf30: 2e0d 0a20 2020 2059 6f75 2063 616e 2061  ...    You can a
+0008cf40: 6c73 6f20 7370 6563 6966 7920 7768 6174  lso specify what
+0008cf50: 2073 7472 696e 6720 746f 2073 706c 6974   string to split
+0008cf60: 206f 6e20 7573 696e 6720 7468 6520 7370   on using the sp
+0008cf70: 6c69 7474 6572 2061 7267 756d 656e 742e  litter argument.
+0008cf80: 0d0a 2020 2020 596f 7520 6361 6e20 616c  ..    You can al
+0008cf90: 736f 2066 696c 6c20 4e75 6c6c 2076 616c  so fill Null val
+0008cfa0: 7565 7320 7468 6174 206f 6363 7572 2064  ues that occur d
+0008cfb0: 7565 2074 6f20 796f 7572 2073 706c 6974  ue to your split
+0008cfc0: 7469 6e67 2062 7920 7370 6563 6966 7969  ting by specifyi
+0008cfd0: 6e67 2061 2066 696c 6c65 722e 0d0a 2020  ng a filler...  
+0008cfe0: 2020 6966 206e 6f20 6e65 775f 6e61 6d65    if no new_name
+0008cff0: 735f 6c69 7374 2069 7320 6769 7665 6e2c  s_list is given,
+0008d000: 2074 6865 6e20 7765 2075 7365 2074 6865   then we use the
+0008d010: 206e 616d 6520 6f66 2074 6865 2066 6965   name of the fie
+0008d020: 6c64 2069 7473 656c 6620 746f 2073 706c  ld itself to spl
+0008d030: 6974 2e0d 0a20 2020 2022 2222 0d0a 2020  it...    """..  
+0008d040: 2020 696d 706f 7274 2077 6172 6e69 6e67    import warning
+0008d050: 730d 0a20 2020 2077 6172 6e69 6e67 732e  s..    warnings.
+0008d060: 6669 6c74 6572 7761 726e 696e 6773 2822  filterwarnings("
+0008d070: 6967 6e6f 7265 2229 0d0a 2020 2020 6466  ignore")..    df
+0008d080: 203d 2064 662e 636f 7079 2829 0d0a 2020   = df.copy()..  
+0008d090: 2020 2323 2320 4669 7273 7420 7072 696e    ### First prin
+0008d0a0: 7420 7468 6520 6d61 7869 6d75 6d20 6e75  t the maximum nu
+0008d0b0: 6d62 6572 206f 6620 7468 696e 6773 2069  mber of things i
+0008d0c0: 6e20 7468 6174 2066 6965 6c64 0d0a 2020  n that field..  
+0008d0d0: 2020 6d61 785f 7468 696e 6773 203d 2064    max_things = d
+0008d0e0: 665b 6669 656c 645d 2e6d 6170 286c 616d  f[field].map(lam
+0008d0f0: 6264 6120 783a 206c 656e 2878 2e73 706c  bda x: len(x.spl
+0008d100: 6974 2873 706c 6974 7465 7229 2929 2e6d  it(splitter))).m
+0008d110: 6178 2829 0d0a 2020 2020 6966 206c 656e  ax()..    if len
+0008d120: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008d130: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+0008d140: 7072 696e 7428 2720 2020 204d 6178 2e20  print('    Max. 
+0008d150: 636f 6c75 6d6e 7320 6372 6561 7465 6420  columns created 
+0008d160: 6279 2073 706c 6974 7469 6e67 2025 7320  by splitting %s 
+0008d170: 6669 656c 6420 6973 2025 642e 2720 2528  field is %d.' %(
+0008d180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008d190: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0008d1a0: 656c 642c 6d61 785f 7468 696e 6773 2929  eld,max_things))
+0008d1b0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+0008d1c0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0008d1d0: 4d61 782e 2063 6f6c 756d 6e73 2063 7265  Max. columns cre
+0008d1e0: 6174 6564 2062 7920 7370 6c69 7474 696e  ated by splittin
+0008d1f0: 6720 2573 2066 6965 6c64 2069 7320 2564  g %s field is %d
+0008d200: 2062 7574 2079 6f75 2068 6176 6520 6769   but you have gi
+0008d210: 7665 6e20 2564 2076 6172 6961 626c 6520  ven %d variable 
+0008d220: 6e61 6d65 7320 6f6e 6c79 2e20 5365 6c65  names only. Sele
+0008d230: 6374 696e 6720 6669 7273 7420 2564 2720  cting first %d' 
+0008d240: 2528 0d0a 2020 2020 2020 2020 2020 2020  %(..            
+0008d250: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+0008d260: 642c 6d61 785f 7468 696e 6773 2c6c 656e  d,max_things,len
+0008d270: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008d280: 2c6c 656e 286e 6577 5f6e 616d 6573 5f6c  ,len(new_names_l
+0008d290: 6973 7429 2929 0d0a 2020 2020 2323 2320  ist)))..    ### 
+0008d2a0: 5468 6973 2063 7265 6174 6573 2061 206e  This creates a n
+0008d2b0: 6577 2066 6965 6c64 2074 6861 7420 636f  ew field that co
+0008d2c0: 756e 7473 2074 6865 206e 756d 6265 7220  unts the number 
+0008d2d0: 6f66 2074 6869 6e67 7320 7468 6174 2061  of things that a
+0008d2e0: 7265 2069 6e20 7468 6174 2066 6965 6c64  re in that field
+0008d2f0: 2e0d 0a20 2020 206e 756d 5f70 726f 6475  ...    num_produ
+0008d300: 6374 735f 7669 6577 6564 203d 2027 636f  cts_viewed = 'co
+0008d310: 756e 745f 7468 696e 6773 5f69 6e5f 272b  unt_things_in_'+
+0008d320: 6669 656c 640d 0a20 2020 2064 665b 6e75  field..    df[nu
+0008d330: 6d5f 7072 6f64 7563 7473 5f76 6965 7765  m_products_viewe
+0008d340: 645d 203d 2064 665b 6669 656c 645d 2e6d  d] = df[field].m
+0008d350: 6170 286c 616d 6264 6120 783a 206c 656e  ap(lambda x: len
+0008d360: 2878 2e73 706c 6974 2822 3b22 2929 292e  (x.split(";"))).
+0008d370: 7661 6c75 6573 0d0a 2020 2020 2323 2320  values..    ### 
+0008d380: 436c 6561 6e20 7570 2074 6865 2066 6965  Clean up the fie
+0008d390: 6c64 2073 7563 6820 7468 6174 2069 7420  ld such that it 
+0008d3a0: 6861 7320 7468 6520 7269 6768 7420 6e75  has the right nu
+0008d3b0: 6d62 6572 206f 6620 7370 6c69 7420 6368  mber of split ch
+0008d3c0: 6172 7320 6f74 6865 7277 6973 6520 6164  ars otherwise ad
+0008d3d0: 6420 746f 2069 740d 0a20 2020 2064 665b  d to it..    df[
+0008d3e0: 6669 656c 645d 203d 2064 665b 6669 656c  field] = df[fiel
+0008d3f0: 645d 2e6d 6170 286c 616d 6264 6120 783a  d].map(lambda x:
+0008d400: 2078 2b73 706c 6974 7465 722a 286d 6178   x+splitter*(max
+0008d410: 5f74 6869 6e67 732d 6c65 6e28 782e 7370  _things-len(x.sp
+0008d420: 6c69 7428 223b 2229 2929 2069 6620 6c65  lit(";"))) if le
+0008d430: 6e28 782e 7370 6c69 7428 223b 2229 2920  n(x.split(";")) 
+0008d440: 3c20 6d61 785f 7468 696e 6773 2065 6c73  < max_things els
+0008d450: 6520 7829 0d0a 2020 2020 2323 2323 2323  e x)..    ######
+0008d460: 204e 6f77 2079 6f75 2063 7265 6174 6520   Now you create 
+0008d470: 6e65 7720 6669 656c 6473 2062 7920 7370  new fields by sp
+0008d480: 6c69 7420 7468 6520 6f6e 6520 6c61 7267  lit the one larg
+0008d490: 6520 6669 656c 6420 2323 2323 2323 2323  e field ########
+0008d4a0: 0d0a 2020 2020 6966 206e 6577 5f6e 616d  ..    if new_nam
+0008d4b0: 6573 5f6c 6973 7420 3d3d 2027 273a 0d0a  es_list == '':..
+0008d4c0: 2020 2020 2020 2020 6e65 775f 6e61 6d65          new_name
+0008d4d0: 735f 6c69 7374 203d 205b 6669 656c 642b  s_list = [field+
+0008d4e0: 275f 272b 7374 7228 6929 2066 6f72 2069  '_'+str(i) for i
+0008d4f0: 2069 6e20 7261 6e67 6528 312c 6d61 785f   in range(1,max_
+0008d500: 7468 696e 6773 2b31 295d 0d0a 2020 2020  things+1)]..    
+0008d510: 7472 793a 0d0a 2020 2020 2020 2020 666f  try:..        fo
+0008d520: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0008d530: 286e 6577 5f6e 616d 6573 5f6c 6973 7429  (new_names_list)
+0008d540: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0008d550: 6466 5b66 6965 6c64 5d2e 6669 6c6c 6e61  df[field].fillna
+0008d560: 2866 696c 6c65 722c 2069 6e70 6c61 6365  (filler, inplace
+0008d570: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+0008d580: 2020 2020 6466 2e6c 6f63 5b64 665b 6669      df.loc[df[fi
+0008d590: 656c 645d 203d 3d20 7370 6c69 7474 6572  eld] == splitter
+0008d5a0: 2c20 6669 656c 645d 203d 2066 696c 6c65  , field] = fille
+0008d5b0: 720d 0a20 2020 2020 2020 2020 2020 2064  r..            d
+0008d5c0: 665b 6e65 775f 6e61 6d65 735f 6c69 7374  f[new_names_list
+0008d5d0: 5b69 5d5d 203d 2064 665b 6669 656c 645d  [i]] = df[field]
+0008d5e0: 2e6d 6170 286c 616d 6264 6120 783a 2078  .map(lambda x: x
+0008d5f0: 2e73 706c 6974 2873 706c 6974 7465 7229  .split(splitter)
+0008d600: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
+0008d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d620: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008d630: 6620 7370 6c69 7474 6572 2069 6e20 7820  f splitter in x 
+0008d640: 656c 7365 2078 290d 0a20 2020 2065 7863  else x)..    exc
+0008d650: 6570 743a 0d0a 2020 2020 2020 2020 2323  ept:..        ##
+0008d660: 2320 4368 6563 6b20 6966 2074 6865 2063  # Check if the c
+0008d670: 6f6c 756d 6e20 6973 2061 2073 7472 696e  olumn is a strin
+0008d680: 6720 636f 6c75 6d6e 2e20 4966 206e 6f74  g column. If not
+0008d690: 2c20 6769 7665 2061 6e20 6572 726f 7220  , give an error 
+0008d6a0: 6d65 7373 6167 652e 0d0a 2020 2020 2020  message...      
+0008d6b0: 2020 7072 696e 7428 2743 616e 6e6f 7420    print('Cannot 
+0008d6c0: 7370 6c69 7420 7468 6520 636f 6c75 6d6e  split the column
+0008d6d0: 2e20 4765 7474 696e 6720 616e 2065 7272  . Getting an err
+0008d6e0: 6f72 2e20 4368 6563 6b20 7468 6520 636f  or. Check the co
+0008d6f0: 6c75 6d6e 2061 6761 696e 2729 0d0a 2020  lumn again')..  
+0008d700: 2020 2020 2020 7265 7475 726e 2064 660d        return df.
+0008d710: 0a20 2020 2072 6574 7572 6e20 6466 2c20  .    return df, 
+0008d720: 6e65 775f 6e61 6d65 735f 6c69 7374 0d0a  new_names_list..
+0008d730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008d780: 230d 0a64 6566 2061 6464 5f61 6767 7265  #..def add_aggre
+0008d790: 6761 7465 5f70 7269 6d69 7469 7665 5f66  gate_primitive_f
+0008d7a0: 6561 7475 7265 7328 6466 742c 2061 6767  eatures(dft, agg
+0008d7b0: 5f74 7970 6573 2c20 6964 5f63 6f6c 756d  _types, id_colum
+0008d7c0: 6e2c 2069 676e 6f72 655f 7661 7269 6162  n, ignore_variab
+0008d7d0: 6c65 733d 5b5d 293a 0d0a 2020 2020 2222  les=[]):..    ""
+0008d7e0: 220d 0a20 2020 2023 2323 2020 204d 6f64  "..    ###   Mod
+0008d7f0: 6966 7920 4461 7461 6672 616d 6520 6279  ify Dataframe by
+0008d800: 2061 6464 696e 6720 636f 6d70 7574 6174   adding computat
+0008d810: 696f 6e61 6c20 7072 696d 6974 6976 6520  ional primitive 
+0008d820: 4665 6174 7572 6573 2075 7369 6e67 2046  Features using F
+0008d830: 6561 7475 7265 2054 6f6f 6c73 2023 2323  eature Tools ###
+0008d840: 230d 0a20 2020 2023 2323 2020 2057 6861  #..    ###   Wha
+0008d850: 7420 6172 6520 6167 6772 6567 6174 6520  t are aggregate 
+0008d860: 7072 696d 6974 6976 6573 3f20 7468 6579  primitives? they
+0008d870: 2061 7265 2074 6f20 226d 6561 6e22 226d   are to "mean""m
+0008d880: 6564 6961 6e22 2c22 6d6f 6465 222c 226d  edian","mode","m
+0008d890: 696e 222c 226d 6178 222c 2065 7463 2e20  in","max", etc. 
+0008d8a0: 6665 6174 7572 6573 0d0a 2020 2020 2323  features..    ##
+0008d8b0: 2320 496e 7075 7473 3a0d 0a20 2020 2023  # Inputs:..    #
+0008d8c0: 2323 2020 2064 663a 204a 7573 7420 7365  ##   df: Just se
+0008d8d0: 6e74 2069 6e20 7468 6520 6461 7461 2066  nt in the data f
+0008d8e0: 7261 6d65 2064 6620 7468 6174 2079 6f75  rame df that you
+0008d8f0: 2077 616e 7420 6665 6174 7572 6573 2061   want features a
+0008d900: 6464 6564 2074 6f0d 0a20 2020 2023 2323  dded to..    ###
+0008d910: 2020 2061 6767 5f74 7970 6573 3a20 6c69     agg_types: li
+0008d920: 7374 206f 6620 636f 6d70 7574 6174 696f  st of computatio
+0008d930: 6e61 6c20 7479 7065 733a 2027 6d65 616e  nal types: 'mean
+0008d940: 272c 276d 6564 6961 6e27 2c27 636f 756e  ','median','coun
+0008d950: 7427 2c20 276d 6178 272c 2027 6d69 6e27  t', 'max', 'min'
+0008d960: 2c20 2773 756d 272c 2065 7463 2e0d 0a20  , 'sum', etc... 
+0008d970: 2020 2023 2323 2020 2020 2020 2020 204f     ###         O
+0008d980: 6e65 2063 6176 6561 743a 2074 6865 7365  ne caveat: these
+0008d990: 2061 6767 5f74 7970 6573 206d 7573 7420   agg_types must 
+0008d9a0: 6265 2066 6f75 6e64 2069 6e20 7468 6520  be found in the 
+0008d9b0: 6167 675f 6675 6e63 206f 6620 6e75 6d70  agg_func of nump
+0008d9c0: 7920 6f72 2070 616e 6461 7320 6772 6f75  y or pandas grou
+0008d9d0: 7062 7920 7374 6174 656d 656e 742e 0d0a  pby statement...
+0008d9e0: 2020 2020 2323 2320 2020 2020 2020 2020      ###         
+0008d9f0: 666f 7220 6578 616d 706c 653a 206e 756d  for example: num
+0008da00: 7079 2068 6173 2027 6d65 6469 616e 272c  py has 'median',
+0008da10: 2770 726f 6427 2c27 7375 6d27 2c27 7374  'prod','sum','st
+0008da20: 6427 2c27 7661 7227 2c20 6574 632e 202d  d','var', etc. -
+0008da30: 2074 6865 7920 7769 6c6c 2077 6f72 6b21   they will work!
+0008da40: 0d0a 2020 2020 2323 2320 2020 6964 636f  ..    ###   idco
+0008da50: 6c75 6d6e 3a20 7468 6973 2069 7320 746f  lumn: this is to
+0008da60: 2063 7265 6174 6520 616e 2069 6e64 6578   create an index
+0008da70: 2066 6f72 2074 6865 2064 6174 6166 7261   for the datafra
+0008da80: 6d65 2073 696e 6365 2046 5420 7275 6e73  me since FT runs
+0008da90: 206f 6e20 696e 6465 7820 7661 7269 6162   on index variab
+0008daa0: 6c65 2e20 596f 7520 6361 6e20 6c65 6176  le. You can leav
+0008dab0: 6520 6974 2065 6d70 7479 2073 7472 696e  e it empty strin
+0008dac0: 672e 0d0a 2020 2020 2323 2320 2020 6967  g...    ###   ig
+0008dad0: 6e6f 7265 5f76 6172 6961 626c 6573 3a20  nore_variables: 
+0008dae0: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
+0008daf0: 7320 746f 2069 676e 6f72 6520 616d 6f6e  s to ignore amon
+0008db00: 6720 6e75 6d65 7269 6320 7661 7269 6162  g numeric variab
+0008db10: 6c65 7320 696e 2064 6174 6120 7369 6e63  les in data sinc
+0008db20: 6520 7468 6579 206d 6179 2062 6520 4944  e they may be ID
+0008db30: 2076 6172 6961 626c 6573 2e0d 0a20 2020   variables...   
+0008db40: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
+0008db50: 2063 6f70 790d 0a20 2020 2023 2323 204d   copy..    ### M
+0008db60: 616b 6520 7375 7265 2074 6865 206c 6973  ake sure the lis
+0008db70: 7420 6f66 2066 756e 6374 696f 6e73 2074  t of functions t
+0008db80: 6865 7920 7365 6e64 2069 6e20 6172 6520  hey send in are 
+0008db90: 6163 6365 7074 6162 6c65 2066 756e 6374  acceptable funct
+0008dba0: 696f 6e73 2e20 4966 206e 6f74 2c20 7468  ions. If not, th
+0008dbb0: 6520 6167 6772 6567 6174 6520 7769 6c6c  e aggregate will
+0008dbc0: 2062 6c6f 7720 7570 210d 0a20 2020 2066   blow up!..    f
+0008dbd0: 756e 635f 7365 7420 3d20 7b27 636f 756e  unc_set = {'coun
+0008dbe0: 7427 2c27 7375 6d27 2c27 6d65 616e 272c  t','sum','mean',
+0008dbf0: 276d 6164 272c 276d 6564 6961 6e27 2c27  'mad','median','
+0008dc00: 6d69 6e27 2c27 6d61 7827 2c27 6d6f 6465  min','max','mode
+0008dc10: 272c 2761 6273 272c 2770 726f 6427 2c27  ','abs','prod','
+0008dc20: 7374 6427 2c27 7661 7227 2c27 7365 6d27  std','var','sem'
+0008dc30: 2c27 736b 6577 272c 276b 7572 7427 2c27  ,'skew','kurt','
+0008dc40: 7175 616e 7469 6c65 272c 2763 756d 7375  quantile','cumsu
+0008dc50: 6d27 2c27 6375 6d70 726f 6427 2c27 6375  m','cumprod','cu
+0008dc60: 6d6d 6178 272c 2763 756d 6d69 6e27 7d0d  mmax','cummin'}.
+0008dc70: 0a20 2020 2061 6767 5f74 7970 6573 203d  .    agg_types =
+0008dc80: 206c 6973 7428 7365 7428 6167 675f 7479   list(set(agg_ty
+0008dc90: 7065 7329 2e69 6e74 6572 7365 6374 696f  pes).intersectio
+0008dca0: 6e28 6675 6e63 5f73 6574 2929 0d0a 2020  n(func_set))..  
+0008dcb0: 2020 2323 2320 4966 2074 6865 2069 676e    ### If the ign
+0008dcc0: 6f72 655f 7661 7269 6162 6c65 7320 6c69  ore_variables li
+0008dcd0: 7374 2069 7320 656d 7074 792c 206d 616b  st is empty, mak
+0008dce0: 6520 7375 7265 2079 6f75 2061 6464 2074  e sure you add t
+0008dcf0: 6865 2069 645f 636f 6c75 6d6e 2074 6f20  he id_column to 
+0008dd00: 6974 2073 6f20 6974 2063 616e 2062 6520  it so it can be 
+0008dd10: 6472 6f70 7065 6420 6672 6f6d 2061 6767  dropped from agg
+0008dd20: 7265 6761 7469 6f6e 2e0d 0a20 2020 2069  regation...    i
+0008dd30: 6620 6c65 6e28 6967 6e6f 7265 5f76 6172  f len(ignore_var
+0008dd40: 6961 626c 6573 2920 3d3d 2030 3a0d 0a20  iables) == 0:.. 
+0008dd50: 2020 2020 2020 2069 676e 6f72 655f 7661         ignore_va
+0008dd60: 7269 6162 6c65 7320 3d20 5b69 645f 636f  riables = [id_co
+0008dd70: 6c75 6d6e 5d0d 0a20 2020 2023 2323 2053  lumn]..    ### S
+0008dd80: 656c 6563 7420 6f6e 6c79 2069 6e74 6567  elect only integ
+0008dd90: 6572 2061 6e64 2066 6c6f 6174 2076 6172  er and float var
+0008dda0: 6961 626c 6573 2074 6f20 646f 2074 6869  iables to do thi
+0008ddb0: 7320 6167 6772 6567 6174 696f 6e20 6f6e  s aggregation on
+0008ddc0: 2e20 4265 2076 6572 7920 6361 7265 6675  . Be very carefu
+0008ddd0: 6c20 6966 2074 6865 7265 2061 7265 2074  l if there are t
+0008dde0: 6f6f 206d 616e 7920 7661 7273 2e0d 0a20  oo many vars... 
+0008ddf0: 2020 2023 2323 2054 6869 7320 7769 6c6c     ### This will
+0008de00: 2074 616b 6520 7469 6d65 2074 6f20 7275   take time to ru
+0008de10: 6e20 696e 2074 6861 7420 6361 7365 2e0d  n in that case..
+0008de20: 0a20 2020 2064 6674 5f69 6e64 6578 203d  .    dft_index =
+0008de30: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
+0008de40: 6674 5b69 645f 636f 6c75 6d6e 5d29 0d0a  ft[id_column])..
+0008de50: 2020 2020 6466 745f 636f 6e74 203d 2063      dft_cont = c
+0008de60: 6f70 792e 6465 6570 636f 7079 2864 6674  opy.deepcopy(dft
+0008de70: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+0008de80: 6e75 6d62 6572 2729 2e64 726f 7028 6967  number').drop(ig
+0008de90: 6e6f 7265 5f76 6172 6961 626c 6573 2c61  nore_variables,a
+0008dea0: 7869 733d 3129 290d 0a20 2020 2064 6674  xis=1))..    dft
+0008deb0: 5f63 6f6e 745b 6964 5f63 6f6c 756d 6e5d  _cont[id_column]
+0008dec0: 203d 2064 6674 5f69 6e64 6578 0d0a 2020   = dft_index..  
+0008ded0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+0008dee0: 6466 745f 6675 6c6c 203d 2064 6674 5f63  dft_full = dft_c
+0008def0: 6f6e 742e 6772 6f75 7062 7928 6964 5f63  ont.groupby(id_c
+0008df00: 6f6c 756d 6e29 2e61 6767 2861 6767 5f74  olumn).agg(agg_t
+0008df10: 7970 6573 290d 0a20 2020 2065 7863 6570  ypes)..    excep
+0008df20: 743a 0d0a 2020 2020 2020 2020 2323 2320  t:..        ### 
+0008df30: 6966 2066 6f72 2073 6f6d 6520 7265 6173  if for some reas
+0008df40: 6f6e 2c20 7468 6520 6772 6f75 7062 7920  on, the groupby 
+0008df50: 626c 6f77 7320 7570 2c20 7468 656e 206a  blows up, then j
+0008df60: 7573 7420 7265 7475 726e 2074 6865 2064  ust return the d
+0008df70: 6174 6166 7261 6d65 2061 7320 6973 202d  ataframe as is -
+0008df80: 206e 6f20 6368 616e 6765 7321 0d0a 2020   no changes!..  
+0008df90: 2020 2020 2020 7265 7475 726e 2064 6674        return dft
+0008dfa0: 0d0a 2020 2020 636f 6c73 203d 205b 782b  ..    cols = [x+
+0008dfb0: 275f 272b 792b 275f 6279 5f27 2b69 645f  '_'+y+'_by_'+id_
+0008dfc0: 636f 6c75 6d6e 2066 6f72 2028 782c 7929  column for (x,y)
+0008dfd0: 2069 6e20 6466 745f 6675 6c6c 2e63 6f6c   in dft_full.col
+0008dfe0: 756d 6e73 5d0d 0a20 2020 2064 6674 5f66  umns]..    dft_f
+0008dff0: 756c 6c2e 636f 6c75 6d6e 7320 3d20 636f  ull.columns = co
+0008e000: 6c73 0d0a 2020 2020 2323 2320 204e 6f74  ls..    ###  Not
+0008e010: 2065 7665 7279 2063 6f6c 756d 6e20 6861   every column ha
+0008e020: 7320 7573 6566 756c 2076 616c 7565 732e  s useful values.
+0008e030: 2049 6620 6974 2069 7320 6675 6c6c 206f   If it is full o
+0008e040: 6620 6a75 7374 2074 6865 2073 616d 6520  f just the same 
+0008e050: 7661 6c75 652c 2072 656d 6f76 6520 6974  value, remove it
+0008e060: 0d0a 2020 2020 5f2c 206c 6973 745f 756e  ..    _, list_un
+0008e070: 6971 7565 5f63 6f6c 5f69 6473 203d 206e  ique_col_ids = n
+0008e080: 702e 756e 6971 7565 2864 6674 5f66 756c  p.unique(dft_ful
+0008e090: 6c2c 2061 7869 7320 3d20 312c 2072 6574  l, axis = 1, ret
+0008e0a0: 7572 6e5f 696e 6465 783d 5472 7565 290d  urn_index=True).
+0008e0b0: 0a20 2020 2064 6674 5f66 756c 6c20 3d20  .    dft_full = 
+0008e0c0: 6466 745f 6675 6c6c 2e69 6c6f 635b 3a2c  dft_full.iloc[:,
+0008e0d0: 206c 6973 745f 756e 6971 7565 5f63 6f6c   list_unique_col
+0008e0e0: 5f69 6473 5d0d 0a20 2020 2072 6574 7572  _ids]..    retur
+0008e0f0: 6e20 6466 745f 6675 6c6c 0d0a 2323 2323  n dft_full..####
+0008e100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e170: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
+0008e180: 706f 7274 2063 6f70 790d 0a69 6d70 6f72  port copy..impor
+0008e190: 7420 7469 6d65 0d0a 696d 706f 7274 2070  t time..import p
+0008e1a0: 6462 0d0a 6465 6620 4645 5f63 7265 6174  db..def FE_creat
+0008e1b0: 655f 6772 6f75 7062 795f 6665 6174 7572  e_groupby_featur
+0008e1c0: 6573 2864 6674 2c20 6772 6f75 7062 795f  es(dft, groupby_
+0008e1d0: 636f 6c75 6d6e 732c 206e 756d 6572 6963  columns, numeric
+0008e1e0: 5f63 6f6c 756d 6e73 2c20 6167 675f 7479  _columns, agg_ty
+0008e1f0: 7065 7329 3a0d 0a20 2020 2022 2222 0d0a  pes):..    """..
+0008e200: 2020 2020 4645 206d 6561 6e73 2046 4541      FE means FEA
+0008e210: 5455 5245 2045 4e47 494e 4545 5249 4e47  TURE ENGINEERING
+0008e220: 202d 2054 6861 7420 6d65 616e 7320 7468   - That means th
+0008e230: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
+0008e240: 2063 7265 6174 6520 6e65 7720 6665 6174   create new feat
+0008e250: 7572 6573 0d0a 2020 2020 4265 7761 7265  ures..    Beware
+0008e260: 3a20 7468 6973 2066 756e 6374 696f 6e20  : this function 
+0008e270: 7769 6c6c 2072 6574 7572 6e20 6120 736d  will return a sm
+0008e280: 616c 6c65 7220 6461 7461 6672 616d 6520  aller dataframe 
+0008e290: 7468 616e 2077 6861 7420 796f 7520 7365  than what you se
+0008e2a0: 6e64 2069 6e20 7369 6e63 6520 6974 2067  nd in since it g
+0008e2b0: 726f 7570 7320 726f 7773 2062 7920 6b65  roups rows by ke
+0008e2c0: 7973 2e0d 0a20 2020 2023 2323 2323 2323  ys...    #######
+0008e2d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e2e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e2f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e330: 2323 0d0a 2020 2020 4675 6e63 7469 6f6e  ##..    Function
+0008e340: 2067 726f 7570 7320 726f 7773 2069 6e20   groups rows in 
+0008e350: 6120 6466 7420 6461 7461 6672 616d 6520  a dft dataframe 
+0008e360: 6279 2074 6865 2067 726f 7570 6279 5f63  by the groupby_c
+0008e370: 6f6c 756d 6e73 2061 6e64 2072 6574 7572  olumns and retur
+0008e380: 6e73 206d 756c 7469 706c 6520 636f 6c75  ns multiple colu
+0008e390: 6d6e 7320 666f 7220 7468 6520 6e75 6d65  mns for the nume
+0008e3a0: 7269 6320 636f 6c75 6d6e 2061 6767 7265  ric column aggre
+0008e3b0: 6761 7465 642e 0d0a 2020 2020 446f 206e  gated...    Do n
+0008e3c0: 6f74 2073 656e 6420 696e 206d 6f72 6520  ot send in more 
+0008e3d0: 7468 616e 206f 6e65 2063 6f6c 756d 6e20  than one column 
+0008e3e0: 696e 2074 6865 206e 756d 6572 6963 2063  in the numeric c
+0008e3f0: 6f6c 756d 6e20 7369 6e63 6520 6265 796f  olumn since beyo
+0008e400: 6e64 2074 6865 2066 6972 7374 2063 6f6c  nd the first col
+0008e410: 756d 6e20 6974 2077 696c 6c20 6265 2069  umn it will be i
+0008e420: 676e 6f72 6564 210d 0a20 2020 2061 6767  gnored!..    agg
+0008e430: 5f74 7970 6520 6361 6e20 6265 2061 6e79  _type can be any
+0008e440: 206e 756d 7079 2066 756e 6374 696f 6e20   numpy function 
+0008e450: 7375 6368 2061 7320 6d65 616e 2c20 6d65  such as mean, me
+0008e460: 6469 616e 2c20 7375 6d2c 2063 6f75 6e74  dian, sum, count
+0008e470: 2c20 6574 632e 0d0a 2020 2020 2323 2323  , etc...    ####
+0008e480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e4d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008e4e0: 2323 2323 2323 0d0a 2020 2020 5265 7475  ######..    Retu
+0008e4f0: 726e 733a 2061 2073 6d61 6c6c 6572 2064  rns: a smaller d
+0008e500: 6174 6166 7261 6d65 2077 6974 6820 726f  ataframe with ro
+0008e510: 7773 2067 726f 7570 6564 2062 7920 6772  ws grouped by gr
+0008e520: 6f75 7062 795f 636f 6c75 6d6e 7320 616e  oupby_columns an
+0008e530: 6420 6167 6772 6567 6174 6564 2066 6f72  d aggregated for
+0008e540: 2074 6865 206e 756d 6572 6963 5f63 6f6c   the numeric_col
+0008e550: 756d 6e0d 0a20 2020 2022 2222 0d0a 2020  umn..    """..  
+0008e560: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
+0008e570: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
+0008e580: 6772 6f75 7065 645f 7365 7020 3d20 7064  grouped_sep = pd
+0008e590: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
+0008e5a0: 2020 7072 696e 7428 2741 7574 6f76 696d    print('Autovim
+0008e5b0: 6c20 4665 6174 7572 6520 456e 6769 6e65  l Feature Engine
+0008e5c0: 6572 696e 673a 2063 7265 6174 696e 6720  ering: creating 
+0008e5d0: 6772 6f75 7062 7920 6665 6174 7572 6573  groupby features
+0008e5e0: 2075 7369 6e67 2025 7327 2025 6772 6f75   using %s' %grou
+0008e5f0: 7062 795f 636f 6c75 6d6e 7329 0d0a 2020  pby_columns)..  
+0008e600: 2020 2323 2323 2323 2323 2323 2020 5468    ##########  Th
+0008e610: 6973 2069 7320 7768 6572 6520 7765 2063  is is where we c
+0008e620: 7265 6174 6520 6e65 7720 636f 6c75 6d6e  reate new column
+0008e630: 7320 6279 2065 6163 6820 6e75 6d65 7269  s by each numeri
+0008e640: 6320 636f 6c75 6d6e 2067 726f 7570 6564  c column grouped
+0008e650: 2062 7920 6772 6f75 702d 6279 2063 6f6c   by group-by col
+0008e660: 756d 6e73 2067 6976 656e 2e0d 0a20 2020  umns given...   
+0008e670: 2069 6620 6973 696e 7374 616e 6365 286e   if isinstance(n
+0008e680: 756d 6572 6963 5f63 6f6c 756d 6e73 2c20  umeric_columns, 
+0008e690: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
+0008e6a0: 7061 7373 0d0a 2020 2020 656c 6966 2069  pass..    elif i
+0008e6b0: 7369 6e73 7461 6e63 6528 6e75 6d65 7269  sinstance(numeri
+0008e6c0: 635f 636f 6c75 6d6e 2c20 7374 7229 3a0d  c_column, str):.
+0008e6d0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+0008e6e0: 5f63 6f6c 756d 6e73 203d 205b 6e75 6d65  _columns = [nume
+0008e6f0: 7269 635f 636f 6c75 6d6e 735d 0d0a 2020  ric_columns]..  
+0008e700: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0008e710: 2070 7269 6e74 2827 2020 2020 4e75 6d65   print('    Nume
+0008e720: 7269 6320 636f 6c75 6d6e 206d 7573 7420  ric column must 
+0008e730: 6265 2061 2073 7472 696e 6720 6e6f 7420  be a string not 
+0008e740: 6120 6e75 6d62 6572 2054 7279 2061 6761  a number Try aga
+0008e750: 696e 2729 0d0a 2020 2020 2020 2020 7265  in')..        re
+0008e760: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
+0008e770: 6528 290d 0a20 2020 2067 726f 7570 6564  e()..    grouped
+0008e780: 5f6c 6973 7420 3d20 7064 2e44 6174 6146  _list = pd.DataF
+0008e790: 7261 6d65 2829 0d0a 2020 2020 666f 7220  rame()..    for 
+0008e7a0: 6974 6572 6174 696f 6e2c 206e 756d 6572  iteration, numer
+0008e7b0: 6963 5f63 6f6c 756d 6e20 696e 207a 6970  ic_column in zip
+0008e7c0: 2872 616e 6765 286c 656e 286e 756d 6572  (range(len(numer
+0008e7d0: 6963 5f63 6f6c 756d 6e73 2929 2c6e 756d  ic_columns)),num
+0008e7e0: 6572 6963 5f63 6f6c 756d 6e73 293a 0d0a  eric_columns):..
+0008e7f0: 2020 2020 2020 2020 6772 6f75 7065 6420          grouped 
+0008e800: 3d20 6466 742e 6772 6f75 7062 7928 6772  = dft.groupby(gr
+0008e810: 6f75 7062 795f 636f 6c75 6d6e 7329 5b5b  oupby_columns)[[
+0008e820: 6e75 6d65 7269 635f 636f 6c75 6d6e 5d5d  numeric_column]]
+0008e830: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+0008e840: 2020 2020 2020 2020 2020 2020 6167 675f              agg_
+0008e850: 7479 7065 203d 2061 6767 5f74 7970 6573  type = agg_types
+0008e860: 5b69 7465 7261 7469 6f6e 5d0d 0a20 2020  [iteration]..   
+0008e870: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+0008e880: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0008e890: 2720 2020 204e 6f20 6167 6772 6567 6174  '    No aggregat
+0008e8a0: 696f 6e20 7479 7065 2067 6976 656e 2c20  ion type given, 
+0008e8b0: 6865 6e63 6520 6d65 616e 2069 7320 6368  hence mean is ch
+0008e8c0: 6f73 656e 2062 7920 6465 6661 756c 7427  osen by default'
+0008e8d0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+0008e8e0: 6767 5f74 7970 6520 3d20 276d 6561 6e27  gg_type = 'mean'
+0008e8f0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+0008e900: 2020 2020 2020 2020 2020 2020 7072 6566              pref
+0008e910: 6978 203d 206e 756d 6572 6963 5f63 6f6c  ix = numeric_col
+0008e920: 756d 6e20 2b20 275f 270d 0a20 2020 2020  umn + '_'..     
+0008e930: 2020 2020 2020 2069 6620 6167 675f 7479         if agg_ty
+0008e940: 7065 2069 6e20 5b27 5375 6d27 2c20 2773  pe in ['Sum', 's
+0008e950: 756d 275d 3a0d 0a20 2020 2020 2020 2020  um']:..         
+0008e960: 2020 2020 2020 2067 726f 7570 6564 5f61         grouped_a
+0008e970: 6767 203d 2067 726f 7570 6564 2e73 756d  gg = grouped.sum
+0008e980: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0008e990: 656c 6966 2061 6767 5f74 7970 6520 696e  elif agg_type in
+0008e9a0: 205b 274d 6561 6e27 2c20 276d 6561 6e27   ['Mean', 'mean'
+0008e9b0: 2c27 4176 6572 6167 6527 2c27 6176 6572  ,'Average','aver
+0008e9c0: 6167 6527 5d3a 0d0a 2020 2020 2020 2020  age']:..        
+0008e9d0: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
+0008e9e0: 6167 6720 3d20 6772 6f75 7065 642e 6d65  agg = grouped.me
+0008e9f0: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
+0008ea00: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
+0008ea10: 696e 205b 2763 6f75 6e74 272c 2027 436f  in ['count', 'Co
+0008ea20: 756e 7427 5d3a 0d0a 2020 2020 2020 2020  unt']:..        
+0008ea30: 2020 2020 2020 2020 6772 6f75 7065 645f          grouped_
+0008ea40: 6167 6720 3d20 6772 6f75 7065 642e 636f  agg = grouped.co
+0008ea50: 756e 7428 290d 0a20 2020 2020 2020 2020  unt()..         
+0008ea60: 2020 2065 6c69 6620 6167 675f 7479 7065     elif agg_type
+0008ea70: 2069 6e20 5b27 4d65 6469 616e 272c 2027   in ['Median', '
+0008ea80: 6d65 6469 616e 275d 3a0d 0a20 2020 2020  median']:..     
+0008ea90: 2020 2020 2020 2020 2020 2067 726f 7570             group
+0008eaa0: 6564 5f61 6767 203d 2067 726f 7570 6564  ed_agg = grouped
+0008eab0: 2e6d 6564 6961 6e28 290d 0a20 2020 2020  .median()..     
+0008eac0: 2020 2020 2020 2065 6c69 6620 6167 675f         elif agg_
+0008ead0: 7479 7065 2069 6e20 5b27 4d61 7869 6d75  type in ['Maximu
+0008eae0: 6d27 2c20 276d 6178 696d 756d 272c 276d  m', 'maximum','m
+0008eaf0: 6178 272c 2027 4d61 7827 5d3a 0d0a 2020  ax', 'Max']:..  
+0008eb00: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0008eb10: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
+0008eb20: 616d 6f75 6e74 730d 0a20 2020 2020 2020  amounts..       
+0008eb30: 2020 2020 2020 2020 2067 726f 7570 6564           grouped
+0008eb40: 5f61 6767 203d 2067 726f 7570 6564 2e6d  _agg = grouped.m
+0008eb50: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
+0008eb60: 2020 656c 6966 2061 6767 5f74 7970 6520    elif agg_type 
+0008eb70: 696e 205b 274d 696e 696d 756d 272c 2027  in ['Minimum', '
+0008eb80: 6d69 6e69 6d75 6d27 2c27 6d69 6e27 2c20  minimum','min', 
+0008eb90: 274d 696e 275d 3a0d 0a20 2020 2020 2020  'Min']:..       
+0008eba0: 2020 2020 2020 2020 2023 2320 6d61 7869           ## maxi
+0008ebb0: 6d75 6d20 6f66 2074 6865 2061 6d6f 756e  mum of the amoun
+0008ebc0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+0008ebd0: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
+0008ebe0: 3d20 6772 6f75 7065 642e 6d69 6e28 290d  = grouped.min().
+0008ebf0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0008ec00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0008ec10: 2020 2020 6772 6f75 7065 645f 6167 6720      grouped_agg 
+0008ec20: 3d20 6772 6f75 7065 642e 6d65 616e 2829  = grouped.mean()
+0008ec30: 0d0a 2020 2020 2020 2020 2020 2020 6772  ..            gr
+0008ec40: 6f75 7065 645f 7365 7020 3d20 6772 6f75  ouped_sep = grou
+0008ec50: 7065 645f 6167 672e 756e 7374 6163 6b28  ped_agg.unstack(
+0008ec60: 292e 6164 645f 7072 6566 6978 2870 7265  ).add_prefix(pre
+0008ec70: 6669 7829 2e66 696c 6c6e 6128 3029 0d0a  fix).fillna(0)..
+0008ec80: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+0008ec90: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0008eca0: 6e74 2827 2020 2020 4572 726f 7220 696e  nt('    Error in
+0008ecb0: 2063 7265 6174 696e 6720 6772 6f75 7062   creating groupb
+0008ecc0: 7920 6665 6174 7572 6573 2e2e 2e72 6574  y features...ret
+0008ecd0: 7572 6e69 6e67 2077 6974 6820 6e75 6c6c  urning with null
+0008ece0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
+0008ecf0: 2020 2020 2020 2020 2020 6772 6f75 7065            groupe
+0008ed00: 645f 7365 7020 3d20 7064 2e44 6174 6146  d_sep = pd.DataF
+0008ed10: 7261 6d65 2829 0d0a 2020 2020 2020 2020  rame()..        
+0008ed20: 6966 2069 7465 7261 7469 6f6e 203d 3d20  if iteration == 
+0008ed30: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0008ed40: 6772 6f75 7065 645f 6c69 7374 203d 2063  grouped_list = c
+0008ed50: 6f70 792e 6465 6570 636f 7079 2867 726f  opy.deepcopy(gro
+0008ed60: 7570 6564 5f73 6570 290d 0a20 2020 2020  uped_sep)..     
+0008ed70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0008ed80: 2020 2020 2020 6772 6f75 7065 645f 6c69        grouped_li
+0008ed90: 7374 203d 2070 642e 636f 6e63 6174 285b  st = pd.concat([
+0008eda0: 6772 6f75 7065 645f 6c69 7374 2c67 726f  grouped_list,gro
+0008edb0: 7570 6564 5f73 6570 5d2c 6178 6973 3d31  uped_sep],axis=1
+0008edc0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+0008edd0: 2827 2020 2020 4166 7465 7220 6772 6f75  ('    After grou
+0008ede0: 7065 6420 6665 6174 7572 6573 2061 6464  ped features add
+0008edf0: 6564 2062 7920 2573 2c20 6e75 6d62 6572  ed by %s, number
+0008ee00: 206f 6620 636f 6c75 6d6e 7320 3d20 2564   of columns = %d
+0008ee10: 2720 2528 6e75 6d65 7269 635f 636f 6c75  ' %(numeric_colu
+0008ee20: 6d6e 2c20 6772 6f75 7065 645f 6c69 7374  mn, grouped_list
+0008ee30: 2e73 6861 7065 5b31 5d29 290d 0a20 2020  .shape[1]))..   
+0008ee40: 2023 2323 2320 6f6e 6365 2065 7665 7279   #### once every
+0008ee50: 7468 696e 6720 6973 2064 6f6e 652c 2079  thing is done, y
+0008ee60: 6f75 2063 616e 2063 6c6f 7365 2069 7420  ou can close it 
+0008ee70: 6865 7265 0d0a 2020 2020 7072 696e 7428  here..    print(
+0008ee80: 2754 696d 6520 7461 6b65 6e20 666f 7220  'Time taken for 
+0008ee90: 6372 6561 7469 6f6e 206f 6620 6772 6f75  creation of grou
+0008eea0: 7062 7920 6665 6174 7572 6573 2028 696e  pby features (in
+0008eeb0: 2073 6563 6f6e 6473 2920 3d20 2530 2e30   seconds) = %0.0
+0008eec0: 6627 2025 2874 696d 652e 7469 6d65 2829  f' %(time.time()
+0008eed0: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
+0008eee0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0008eef0: 2067 726f 7570 6564 5f6c 6973 742e 636f   grouped_list.co
+0008ef00: 6c75 6d6e 7320 3d20 6772 6f75 7065 645f  lumns = grouped_
+0008ef10: 6c69 7374 2e63 6f6c 756d 6e73 2e67 6574  list.columns.get
+0008ef20: 5f6c 6576 656c 5f76 616c 7565 7328 3129  _level_values(1)
+0008ef30: 0d0a 2020 2020 2020 2020 6772 6f75 7065  ..        groupe
+0008ef40: 645f 6c69 7374 2e63 6f6c 756d 6e73 2e6e  d_list.columns.n
+0008ef50: 616d 6520 3d20 4e6f 6e65 2023 2320 6d61  ame = None ## ma
+0008ef60: 6b65 2073 7572 6520 7468 6520 6e61 6d65  ke sure the name
+0008ef70: 206f 6e20 636f 6c75 6d6e 7320 6973 2072   on columns is r
+0008ef80: 656d 6f76 6564 0d0a 2020 2020 2020 2020  emoved..        
+0008ef90: 6772 6f75 7065 645f 6c69 7374 203d 2067  grouped_list = g
+0008efa0: 726f 7570 6564 5f6c 6973 742e 7265 7365  rouped_list.rese
+0008efb0: 745f 696e 6465 7828 2920 2323 206d 616b  t_index() ## mak
+0008efc0: 6520 7375 7265 2074 6865 2049 4420 636f  e sure the ID co
+0008efd0: 6c75 6d6e 2063 6f6d 6573 2062 6163 6b0d  lumn comes back.
+0008efe0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
+0008eff0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+0008f000: 4572 726f 7220 696e 2073 6574 7469 6e67  Error in setting
+0008f010: 2063 6f6c 756d 6e20 6e61 6d65 732e 2050   column names. P
+0008f020: 6c65 6173 6520 7265 7365 7420 636f 6c75  lease reset colu
+0008f030: 6d6e 206e 616d 6573 2061 6674 6572 2074  mn names after t
+0008f040: 6869 7320 7374 6570 2e2e 2e27 290d 0a20  his step...').. 
+0008f050: 2020 2072 6574 7572 6e20 6772 6f75 7065     return groupe
+0008f060: 645f 6c69 7374 0d0a 2323 2323 2323 2323  d_list..########
+0008f070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f0a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f0b0: 2323 2323 2323 2323 0000 0000 0000 0000  ########........
 0008f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0008f100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f120: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0008f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-0008f150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008f200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0008f210: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
-0008f220: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
-0008f230: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
-0008f240: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
-0008f250: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
-0008f260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f2a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
-0008f2b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
-0008f2c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
-0008f2d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
-0008f2e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
-0008f2f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
-0008f300: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
-0008f310: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
-0008f320: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
-0008f330: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
-0008f340: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
-0008f350: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
-0008f360: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
-0008f370: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-0008f380: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
-0008f390: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
-0008f3a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
-0008f3b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
-0008f3c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0008f3d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
-0008f3e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
-0008f3f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
-0008f400: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
-0008f410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f450: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
-0008f460: 6462 0d0a 696d 706f 7274 2063 6f70 790d  db..import copy.
-0008f470: 0a69 6d70 6f72 7420 7469 6d65 0d0a 6672  .import time..fr
-0008f480: 6f6d 2073 6b6c 6561 726e 2e66 6561 7475  om sklearn.featu
-0008f490: 7265 5f73 656c 6563 7469 6f6e 2069 6d70  re_selection imp
-0008f4a0: 6f72 7420 6368 6932 2c20 6d75 7475 616c  ort chi2, mutual
-0008f4b0: 5f69 6e66 6f5f 7265 6772 6573 7369 6f6e  _info_regression
-0008f4c0: 2c20 6d75 7475 616c 5f69 6e66 6f5f 636c  , mutual_info_cl
-0008f4d0: 6173 7369 660d 0a66 726f 6d20 736b 6c65  assif..from skle
-0008f4e0: 6172 6e2e 6665 6174 7572 655f 7365 6c65  arn.feature_sele
-0008f4f0: 6374 696f 6e20 696d 706f 7274 2053 656c  ction import Sel
-0008f500: 6563 744b 4265 7374 0d0a 6672 6f6d 2069  ectKBest..from i
-0008f510: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
-0008f520: 636f 6d62 696e 6174 696f 6e73 0d0a 696d  combinations..im
-0008f530: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-0008f540: 7061 7463 6865 7320 6173 206d 7061 7463  patches as mpatc
-0008f550: 6865 730d 0a69 6d70 6f72 7420 6d61 7470  hes..import matp
-0008f560: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
-0008f570: 2070 6c74 0d0a 6672 6f6d 2063 6f6c 6c65   plt..from colle
-0008f580: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
-0008f590: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
-0008f5a0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
-0008f5b0: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
-0008f5c0: 696d 706f 7274 2074 696d 650d 0a23 2323  import time..###
-0008f5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f5f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f620: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0008f630: 6465 6620 6c65 6674 5f73 7562 7472 6163  def left_subtrac
-0008f640: 7428 6c31 2c6c 3229 3a0d 0a20 2020 206c  t(l1,l2):..    l
-0008f650: 7374 203d 205b 5d0d 0a20 2020 2066 6f72  st = []..    for
-0008f660: 2069 2069 6e20 6c31 3a0d 0a20 2020 2020   i in l1:..     
-0008f670: 2020 2069 6620 6920 6e6f 7420 696e 206c     if i not in l
-0008f680: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-0008f690: 6c73 742e 6170 7065 6e64 2869 290d 0a20  lst.append(i).. 
-0008f6a0: 2020 2072 6574 7572 6e20 6c73 740d 0a23     return lst..#
-0008f6b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f6c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f6d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f6e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f6f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f700: 0d0a 6465 6620 7265 7475 726e 5f64 6963  ..def return_dic
-0008f710: 7469 6f6e 6172 795f 6c69 7374 286c 7374  tionary_list(lst
-0008f720: 5f6f 665f 7475 706c 6573 293a 0d0a 2020  _of_tuples):..  
-0008f730: 2020 2222 2220 5265 7475 726e 7320 6120    """ Returns a 
-0008f740: 6469 6374 696f 6e61 7279 206f 6620 6c69  dictionary of li
-0008f750: 7374 7320 6966 2079 6f75 2073 656e 6420  sts if you send 
-0008f760: 696e 2061 206c 6973 7420 6f66 2054 7570  in a list of Tup
-0008f770: 6c65 7322 2222 0d0a 2020 2020 6f72 4469  les"""..    orDi
-0008f780: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
-0008f790: 286c 6973 7429 0d0a 2020 2020 2320 6974  (list)..    # it
-0008f7a0: 6572 6174 696e 6720 6f76 6572 206c 6973  erating over lis
-0008f7b0: 7420 6f66 2074 7570 6c65 730d 0a20 2020  t of tuples..   
-0008f7c0: 2066 6f72 206b 6579 2c20 7661 6c20 696e   for key, val in
-0008f7d0: 206c 7374 5f6f 665f 7475 706c 6573 3a0d   lst_of_tuples:.
-0008f7e0: 0a20 2020 2020 2020 206f 7244 6963 745b  .        orDict[
-0008f7f0: 6b65 795d 2e61 7070 656e 6428 7661 6c29  key].append(val)
-0008f800: 0d0a 2020 2020 7265 7475 726e 206f 7244  ..    return orD
-0008f810: 6963 740d 0a23 2323 2323 2323 2323 2323  ict..###########
-0008f820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f860: 2323 2323 230d 0a64 6566 2066 696e 645f  #####..def find_
-0008f870: 7265 6d6f 7665 5f64 7570 6c69 6361 7465  remove_duplicate
-0008f880: 7328 6c69 7374 5f6f 665f 7661 6c75 6573  s(list_of_values
-0008f890: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0008f8a0: 2023 2052 656d 6f76 6573 2064 7570 6c69   # Removes dupli
-0008f8b0: 6361 7465 7320 6672 6f6d 2061 206c 6973  cates from a lis
-0008f8c0: 7420 746f 2072 6574 7572 6e20 756e 6971  t to return uniq
-0008f8d0: 7565 2076 616c 7565 7320 2d20 5553 4544  ue values - USED
-0008f8e0: 204f 4e4c 5920 4f4e 4345 0d0a 2020 2020   ONLY ONCE..    
-0008f8f0: 2222 220d 0a20 2020 206f 7574 7075 7420  """..    output 
-0008f900: 3d20 5b5d 0d0a 2020 2020 7365 656e 203d  = []..    seen =
-0008f910: 2073 6574 2829 0d0a 2020 2020 666f 7220   set()..    for 
-0008f920: 7661 6c75 6520 696e 206c 6973 745f 6f66  value in list_of
-0008f930: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
-0008f940: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
-0008f950: 6e20 7365 656e 3a0d 0a20 2020 2020 2020  n seen:..       
-0008f960: 2020 2020 206f 7574 7075 742e 6170 7065       output.appe
-0008f970: 6e64 2876 616c 7565 290d 0a20 2020 2020  nd(value)..     
-0008f980: 2020 2020 2020 2073 6565 6e2e 6164 6428         seen.add(
-0008f990: 7661 6c75 6529 0d0a 2020 2020 7265 7475  value)..    retu
-0008f9a0: 726e 206f 7574 7075 740d 0a23 2323 2323  rn output..#####
-0008f9b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f9c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f9d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f9e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008f9f0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0008fa00: 6566 2046 455f 7265 6d6f 7665 5f76 6172  ef FE_remove_var
-0008fa10: 6961 626c 6573 5f75 7369 6e67 5f53 554c  iables_using_SUL
-0008fa20: 4f56 5f6d 6574 686f 6428 6466 2c20 7072  OV_method(df, pr
-0008fa30: 6564 735f 696e 2c20 6d6f 6465 6c74 7970  eds_in, modeltyp
-0008fa40: 652c 2074 6172 6765 742c 0d0a 2020 2020  e, target,..    
-0008fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fa60: 2020 2020 2020 2020 2020 2020 636f 7272              corr
-0008fa70: 5f6c 696d 6974 203d 2030 2e37 302c 7665  _limit = 0.70,ve
-0008fa80: 7262 6f73 653d 302c 2064 6173 6b5f 7867  rbose=0, dask_xg
-0008fa90: 626f 6f73 745f 666c 6167 3d46 616c 7365  boost_flag=False
-0008faa0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0008fab0: 2046 4520 7374 616e 6473 2066 6f72 2046   FE stands for F
-0008fac0: 6561 7475 7265 2045 6e67 696e 6565 7269  eature Engineeri
-0008fad0: 6e67 202d 2069 7420 6d65 616e 7320 7468  ng - it means th
-0008fae0: 6973 2066 756e 6374 696f 6e20 7065 7266  is function perf
-0008faf0: 6f72 6d73 2066 6561 7475 7265 2065 6e67  orms feature eng
-0008fb00: 696e 6565 7269 6e67 0d0a 2020 2020 2323  ineering..    ##
-0008fb10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0008fb60: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
-0008fb70: 2323 2323 2020 2020 2020 2020 2020 2020  ####            
-0008fb80: 2020 5355 4c4f 5620 7374 616e 6473 2066    SULOV stands f
-0008fb90: 6f72 2053 6561 7263 6869 6e67 2055 6e63  or Searching Unc
-0008fba0: 6f72 7265 6c61 7465 6420 4c69 7374 204f  orrelated List O
-0008fbb0: 6620 5661 7269 6162 6c65 7320 2023 2323  f Variables  ###
-0008fbc0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0008fbd0: 5468 6973 2068 6967 686c 7920 6566 6669  This highly effi
-0008fbe0: 6369 656e 7420 6d65 7468 6f64 2072 656d  cient method rem
-0008fbf0: 6f76 6573 2076 6172 6961 626c 6573 2074  oves variables t
-0008fc00: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
-0008fc10: 6f72 7265 6c61 7465 6420 7573 696e 6720  orrelated using 
-0008fc20: 6120 7365 7269 6573 206f 660d 0a20 2020  a series of..   
-0008fc30: 2070 6169 722d 7769 7365 2063 6f72 7265   pair-wise corre
-0008fc40: 6c61 7469 6f6e 206b 6e6f 636b 6f75 7420  lation knockout 
-0008fc50: 726f 756e 6473 2e20 4974 2069 7320 6578  rounds. It is ex
-0008fc60: 7472 656d 656c 7920 6661 7374 2061 6e64  tremely fast and
-0008fc70: 2068 656e 6365 2063 616e 2077 6f72 6b20   hence can work 
-0008fc80: 6f6e 2074 686f 7573 616e 6473 0d0a 2020  on thousands..  
-0008fc90: 2020 6f66 2076 6172 6961 626c 6573 2069    of variables i
-0008fca0: 6e20 6c65 7373 2074 6861 6e20 6120 6d69  n less than a mi
-0008fcb0: 6e75 7465 2c20 6576 656e 206f 6e20 6120  nute, even on a 
-0008fcc0: 6c61 7074 6f70 2e20 596f 7520 6e65 6564  laptop. You need
-0008fcd0: 2074 6f20 7365 6e64 2069 6e20 6120 6c69   to send in a li
-0008fce0: 7374 206f 6620 6e75 6d65 7269 630d 0a20  st of numeric.. 
-0008fcf0: 2020 2076 6172 6961 626c 6573 2061 6e64     variables and
-0008fd00: 2074 6861 7427 7320 616c 6c21 2054 6865   that's all! The
-0008fd10: 206d 6574 686f 6420 6465 6669 6e65 7320   method defines 
-0008fd20: 6869 6768 2043 6f72 7265 6c61 7469 6f6e  high Correlation
-0008fd30: 2061 7320 616e 7974 6869 6e67 206f 7665   as anything ove
-0008fd40: 7220 302e 3730 2028 6162 736f 6c75 7465  r 0.70 (absolute
-0008fd50: 290d 0a20 2020 2062 7574 2074 6869 7320  )..    but this 
-0008fd60: 6361 6e20 6265 2063 6861 6e67 6564 2e20  can be changed. 
-0008fd70: 4966 2074 776f 2076 6172 6961 626c 6573  If two variables
-0008fd80: 2068 6176 6520 6162 736f 6c75 7465 2063   have absolute c
-0008fd90: 6f72 7265 6c61 7469 6f6e 2068 6967 6865  orrelation highe
-0008fda0: 7220 7468 616e 2074 6869 732c 2074 6865  r than this, the
-0008fdb0: 790d 0a20 2020 2077 696c 6c20 6265 206d  y..    will be m
-0008fdc0: 6172 6b65 642c 2061 6e64 2075 7369 6e67  arked, and using
-0008fdd0: 2061 2070 726f 6365 7373 206f 6620 656c   a process of el
-0008fde0: 696d 696e 6174 696f 6e2c 206f 6e65 206f  imination, one o
-0008fdf0: 6620 7468 656d 2077 696c 6c20 6765 7420  f them will get 
-0008fe00: 6b6e 6f63 6b65 6420 6f75 743a 0d0a 2020  knocked out:..  
-0008fe10: 2020 546f 2064 6563 6964 6520 6f72 6465    To decide orde
-0008fe20: 7220 6f66 2076 6172 6961 626c 6573 2074  r of variables t
-0008fe30: 6f20 6b65 6570 2c20 7765 2075 7365 206d  o keep, we use m
-0008fe40: 7574 7561 696c 2069 6e66 6f72 6d61 7469  utuail informati
-0008fe50: 6f6e 2073 636f 7265 2074 6f20 7365 6c65  on score to sele
-0008fe60: 6374 2e20 4d49 5320 7265 7475 726e 730d  ct. MIS returns.
-0008fe70: 0a20 2020 2061 2072 616e 6b65 6420 6c69  .    a ranked li
-0008fe80: 7374 206f 6620 7468 6573 6520 636f 7272  st of these corr
-0008fe90: 656c 6174 6564 2076 6172 6961 626c 6573  elated variables
-0008fea0: 3a20 7768 656e 2077 6520 7365 6c65 6374  : when we select
-0008feb0: 206f 6e65 2c20 7765 206b 6e6f 636b 206f   one, we knock o
-0008fec0: 7574 206f 7468 6572 730d 0a20 2020 2074  ut others..    t
-0008fed0: 6861 7420 6974 2069 7320 636f 7272 656c  hat it is correl
-0008fee0: 6174 6564 2074 6f2e 2054 6865 6e20 7765  ated to. Then we
-0008fef0: 2073 656c 6563 7420 6e65 7874 2076 6172   select next var
-0008ff00: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
-0008ff10: 6f63 6b20 6f75 7420 636f 7272 656c 6174  ock out correlat
-0008ff20: 6564 2076 6172 6961 626c 6573 2e0d 0a20  ed variables... 
-0008ff30: 2020 2046 696e 616c 6c79 2077 6520 6172     Finally we ar
-0008ff40: 6520 6c65 6674 2077 6974 6820 756e 636f  e left with unco
-0008ff50: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
-0008ff60: 6573 2074 6861 7420 6172 6520 616c 736f  es that are also
-0008ff70: 2068 6967 686c 7920 696d 706f 7274 616e   highly importan
-0008ff80: 7420 696e 206d 7574 7561 6c20 7363 6f72  t in mutual scor
-0008ff90: 652e 0d0a 2020 2020 2323 2323 2323 2323  e...    ########
-0008ffa0: 2020 594f 5520 4d55 5354 2049 4e43 4c55    YOU MUST INCLU
-0008ffb0: 4445 2054 4845 2041 424f 5645 204d 4553  DE THE ABOVE MES
-0008ffc0: 5341 4745 2049 4620 594f 5520 434f 5059  SAGE IF YOU COPY
-0008ffd0: 2054 4849 5320 434f 4445 2049 4e20 594f   THIS CODE IN YO
-0008ffe0: 5552 204c 4942 5241 5259 2023 2323 2323  UR LIBRARY #####
-0008fff0: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
-00090000: 2020 2020 0d0a 2020 2020 6466 203d 2063      ..    df = c
-00090010: 6f70 792e 6465 6570 636f 7079 2864 6629  opy.deepcopy(df)
-00090020: 0d0a 2020 2020 6466 5f74 6172 6765 7420  ..    df_target 
-00090030: 3d20 6466 5b74 6172 6765 745d 0d0a 2020  = df[target]..  
-00090040: 2020 6e75 6d76 6172 7320 3d20 6466 5b70    numvars = df[p
-00090050: 7265 6473 5f69 6e5d 2e73 656c 6563 745f  reds_in].select_
-00090060: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
-00090070: 666c 6f61 7427 292e 636f 6c75 6d6e 732e  float').columns.
-00090080: 746f 6c69 7374 2829 0d0a 2020 2020 7265  tolist()..    re
-00090090: 6d76 6172 7320 3d20 6c65 6674 5f73 7562  mvars = left_sub
-000900a0: 7472 6163 7428 7072 6564 735f 696e 2c20  tract(preds_in, 
-000900b0: 6e75 6d76 6172 7329 0d0a 2020 2020 6466  numvars)..    df
-000900c0: 203d 2064 665b 6e75 6d76 6172 735d 0d0a   = df[numvars]..
-000900d0: 2020 2020 2323 2320 666f 7220 736f 6d65      ### for some
-000900e0: 2072 6561 736f 6e2c 2064 6f69 6e67 2061   reason, doing a
-000900f0: 206d 6173 7320 6669 6c6c 6e61 206f 6620   mass fillna of 
-00090100: 7661 7273 2064 6f65 736e 2774 2077 6f72  vars doesn't wor
-00090110: 6b21 2048 656e 6365 2064 6f69 6e67 2069  k! Hence doing i
-00090120: 7420 696e 6469 7669 6475 616c 6c79 210d  t individually!.
-00090130: 0a20 2020 206e 756c 6c5f 7661 7273 203d  .    null_vars =
-00090140: 206e 702e 6172 7261 7928 6e75 6d76 6172   np.array(numvar
-00090150: 7329 5b64 662e 6973 6e75 6c6c 2829 2e73  s)[df.isnull().s
-00090160: 756d 2829 3e30 5d0d 0a20 2020 2066 6f72  um()>0]..    for
-00090170: 2065 6163 685f 6e75 6d20 696e 206e 756c   each_num in nul
-00090180: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
-00090190: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
-000901a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
-000901b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
-000901c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
-000901d0: 2020 2020 2020 6466 5b5b 6561 6368 5f6e        df[[each_n
-000901e0: 756d 5d5d 203d 2064 665b 5b65 6163 685f  um]] = df[[each_
-000901f0: 6e75 6d5d 5d2e 6669 6c6c 6e61 2830 290d  num]].fillna(0).
-00090200: 0a20 2020 2074 6172 6765 7420 3d20 636f  .    target = co
-00090210: 7079 2e64 6565 7063 6f70 7928 7461 7267  py.deepcopy(targ
-00090220: 6574 290d 0a0d 0a20 2020 2070 7269 6e74  et)....    print
-00090230: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
-00090240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090280: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-00090290: 2070 7269 6e74 2827 2323 2323 2320 2053   print('#####  S
-000902a0: 554c 4f56 3a20 2053 6561 7263 6869 6e67  ULOV:  Searching
-000902b0: 2066 6f72 2055 6e63 6f72 7265 6c61 7465   for Uncorrelate
-000902c0: 6420 4c69 7374 204f 6620 5661 7269 6162  d List Of Variab
-000902d0: 6c65 7320 696e 2025 7320 6665 6174 7572  les in %s featur
-000902e0: 6573 2023 2323 2323 2323 2323 2323 2327  es ############'
-000902f0: 2025 6c65 6e28 6e75 6d76 6172 7329 290d   %len(numvars)).
-00090300: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
-00090310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090360: 2323 2327 290d 0a20 2020 2023 2323 2054  ###')..    ### T
-00090370: 6869 7320 6973 2061 2073 686f 7274 6572  his is a shorter
-00090380: 2076 6572 7369 6f6e 206f 6620 6765 7474   version of gett
-00090390: 696e 6720 756e 6475 706c 6963 6174 6564  ing unduplicated
-000903a0: 2061 6e64 2068 6967 686c 7920 636f 7272   and highly corr
-000903b0: 656c 6174 6564 2076 6172 7320 2323 0d0a  elated vars ##..
-000903c0: 2020 2020 636f 7272 656c 6174 696f 6e5f      correlation_
-000903d0: 6461 7461 6672 616d 6520 3d20 6466 2e63  dataframe = df.c
-000903e0: 6f72 7228 292e 6162 7328 292e 756e 7374  orr().abs().unst
-000903f0: 6163 6b28 292e 736f 7274 5f76 616c 7565  ack().sort_value
-00090400: 7328 292e 6472 6f70 5f64 7570 6c69 6361  s().drop_duplica
-00090410: 7465 7328 290d 0a20 2020 2063 6f72 7264  tes()..    corrd
-00090420: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-00090430: 2863 6f72 7265 6c61 7469 6f6e 5f64 6174  (correlation_dat
-00090440: 6166 7261 6d65 5b3a 5d2e 7265 7365 745f  aframe[:].reset_
-00090450: 696e 6465 7828 2929 0d0a 2020 2020 636f  index())..    co
-00090460: 7272 6466 2e63 6f6c 756d 6e73 203d 205b  rrdf.columns = [
-00090470: 2776 6172 3127 2c27 7661 7232 272c 2763  'var1','var2','c
-00090480: 6f65 6666 275d 0d0a 2020 2020 636f 7272  oeff']..    corr
-00090490: 6466 3120 3d20 636f 7272 6466 5b63 6f72  df1 = corrdf[cor
-000904a0: 7264 665b 2763 6f65 6666 275d 3e3d 636f  rdf['coeff']>=co
-000904b0: 7272 5f6c 696d 6974 5d0d 0a20 2020 2063  rr_limit]..    c
-000904c0: 6f72 7265 6c61 7465 645f 7061 6972 203d  orrelated_pair =
-000904d0: 206c 6973 7428 7a69 7028 636f 7272 6466   list(zip(corrdf
-000904e0: 315b 2776 6172 3127 5d2e 7661 6c75 6573  1['var1'].values
-000904f0: 2e74 6f6c 6973 7428 292c 636f 7272 6466  .tolist(),corrdf
-00090500: 315b 2776 6172 3227 5d2e 7661 6c75 6573  1['var2'].values
-00090510: 2e74 6f6c 6973 7428 2929 290d 0a20 2020  .tolist()))..   
-00090520: 2063 6f72 725f 7061 6972 5f64 6963 7420   corr_pair_dict 
-00090530: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
-00090540: 6374 696f 6e61 7279 5f6c 6973 7428 636f  ctionary_list(co
-00090550: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
-00090560: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
-00090570: 2066 696e 645f 7265 6d6f 7665 5f64 7570   find_remove_dup
-00090580: 6c69 6361 7465 7328 636f 7272 6466 315b  licates(corrdf1[
-00090590: 2776 6172 3127 5d2e 7661 6c75 6573 2e74  'var1'].values.t
-000905a0: 6f6c 6973 7428 292b 636f 7272 6466 315b  olist()+corrdf1[
-000905b0: 2776 6172 3227 5d2e 7661 6c75 6573 2e74  'var2'].values.t
-000905c0: 6f6c 6973 7428 2929 0d0a 2020 2020 6b65  olist())..    ke
-000905d0: 7973 5f69 6e5f 6469 6374 203d 206c 6973  ys_in_dict = lis
-000905e0: 7428 636f 7272 5f70 6169 725f 6469 6374  t(corr_pair_dict
-000905f0: 2e6b 6579 7328 2929 0d0a 2020 2020 7265  .keys())..    re
-00090600: 7665 7273 655f 636f 7272 656c 6174 6564  verse_correlated
-00090610: 5f70 6169 7220 3d20 5b28 792c 7829 2066  _pair = [(y,x) f
-00090620: 6f72 2028 782c 7929 2069 6e20 636f 7272  or (x,y) in corr
-00090630: 656c 6174 6564 5f70 6169 725d 0d0a 2020  elated_pair]..  
-00090640: 2020 7265 7665 7273 655f 636f 7272 5f70    reverse_corr_p
-00090650: 6169 725f 6469 6374 203d 2064 6963 7428  air_dict = dict(
-00090660: 7265 7475 726e 5f64 6963 7469 6f6e 6172  return_dictionar
-00090670: 795f 6c69 7374 2872 6576 6572 7365 5f63  y_list(reverse_c
-00090680: 6f72 7265 6c61 7465 645f 7061 6972 2929  orrelated_pair))
-00090690: 0d0a 2020 2020 2323 2323 2063 6f72 725f  ..    #### corr_
-000906a0: 7061 6972 5f64 6963 7420 6973 2075 7365  pair_dict is use
-000906b0: 6420 6c61 7465 7220 746f 206d 616b 6520  d later to make 
-000906c0: 7468 6520 6e65 7477 6f72 6b20 6469 6167  the network diag
-000906d0: 7261 6d20 746f 2073 6565 2077 6869 6368  ram to see which
-000906e0: 2076 6172 7320 6172 6520 636f 7272 656c   vars are correl
-000906f0: 6174 6564 2074 6f20 7768 6963 680d 0a20  ated to which.. 
-00090700: 2020 2066 6f72 206b 6579 2c20 7661 6c20     for key, val 
-00090710: 696e 2072 6576 6572 7365 5f63 6f72 725f  in reverse_corr_
-00090720: 7061 6972 5f64 6963 742e 6974 656d 7328  pair_dict.items(
-00090730: 293a 0d0a 2020 2020 2020 2020 6966 206b  ):..        if k
-00090740: 6579 2069 6e20 6b65 7973 5f69 6e5f 6469  ey in keys_in_di
-00090750: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
-00090760: 2069 6620 6c65 6e28 6b65 7929 203e 2031   if len(key) > 1
-00090770: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00090780: 2020 2063 6f72 725f 7061 6972 5f64 6963     corr_pair_dic
-00090790: 745b 6b65 795d 202b 3d20 7661 6c0d 0a20  t[key] += val.. 
-000907a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000907b0: 2020 2020 2020 2020 2020 636f 7272 5f70            corr_p
-000907c0: 6169 725f 6469 6374 5b6b 6579 5d20 3d20  air_dict[key] = 
-000907d0: 7661 6c0d 0a0d 0a20 2020 2023 2323 2323  val....    #####
-000907e0: 2320 5468 6973 2069 7320 666f 7220 6f72  # This is for or
-000907f0: 6465 7269 6e67 2074 6865 2076 6172 6961  dering the varia
-00090800: 626c 6573 2069 6e20 7468 6520 6869 6768  bles in the high
-00090810: 6573 7420 746f 206c 6f77 6573 7420 696d  est to lowest im
-00090820: 706f 7274 616e 6365 2074 6f20 7461 7267  portance to targ
-00090830: 6574 2023 2323 0d0a 2020 2020 6966 206c  et ###..    if l
-00090840: 656e 2863 6f72 725f 6c69 7374 2920 3d3d  en(corr_list) ==
-00090850: 2030 3a0d 0a20 2020 2020 2020 2066 696e   0:..        fin
-00090860: 616c 5f6c 6973 7420 3d20 6c69 7374 2863  al_list = list(c
-00090870: 6f72 7265 6c61 7469 6f6e 5f64 6174 6166  orrelation_dataf
-00090880: 7261 6d65 290d 0a20 2020 2020 2020 2070  rame)..        p
-00090890: 7269 6e74 2827 5365 6c65 6374 696e 6720  rint('Selecting 
-000908a0: 616c 6c20 2825 6429 2076 6172 6961 626c  all (%d) variabl
-000908b0: 6573 2073 696e 6365 206e 6f6e 6520 6f66  es since none of
-000908c0: 206e 756d 6572 6963 2076 6172 7320 6172   numeric vars ar
-000908d0: 6520 6869 6768 6c79 2063 6f72 7265 6c61  e highly correla
-000908e0: 7465 642e 2e2e 2720 256c 656e 286e 756d  ted...' %len(num
-000908f0: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
-00090900: 7265 7475 726e 206e 756d 7661 7273 0d0a  return numvars..
-00090910: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00090920: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00090930: 2874 6172 6765 742c 206c 6973 7429 3a0d  (target, list):.
-00090940: 0a20 2020 2020 2020 2020 2020 2074 6172  .            tar
-00090950: 6765 7420 3d20 7461 7267 6574 5b30 5d0d  get = target[0].
-00090960: 0a20 2020 2020 2020 206d 6178 5f66 6561  .        max_fea
-00090970: 7473 203d 206c 656e 2863 6f72 725f 6c69  ts = len(corr_li
-00090980: 7374 290d 0a20 2020 2020 2020 2069 6620  st)..        if 
-00090990: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-000909a0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
-000909b0: 2020 2020 2020 2020 7365 6c5f 6675 6e63          sel_func
-000909c0: 7469 6f6e 203d 206d 7574 7561 6c5f 696e  tion = mutual_in
-000909d0: 666f 5f72 6567 7265 7373 696f 6e0d 0a20  fo_regression.. 
-000909e0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
-000909f0: 5365 6c65 6374 4b42 6573 7428 7363 6f72  SelectKBest(scor
-00090a00: 655f 6675 6e63 3d73 656c 5f66 756e 6374  e_func=sel_funct
-00090a10: 696f 6e2c 206b 3d6d 6178 5f66 6561 7473  ion, k=max_feats
-00090a20: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00090a30: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00090a40: 6c5f 6675 6e63 7469 6f6e 203d 206d 7574  l_function = mut
-00090a50: 7561 6c5f 696e 666f 5f63 6c61 7373 6966  ual_info_classif
-00090a60: 0d0a 2020 2020 2020 2020 2020 2020 6673  ..            fs
-00090a70: 203d 2053 656c 6563 744b 4265 7374 2873   = SelectKBest(s
-00090a80: 636f 7265 5f66 756e 633d 7365 6c5f 6675  core_func=sel_fu
-00090a90: 6e63 7469 6f6e 2c20 6b3d 6d61 785f 6665  nction, k=max_fe
-00090aa0: 6174 7329 0d0a 2020 2020 2020 2020 2323  ats)..        ##
-00090ab0: 2323 2320 796f 7520 6d75 7374 2065 6e73  ### you must ens
-00090ac0: 7572 6520 7468 6572 6520 6172 6520 6e6f  ure there are no
-00090ad0: 2069 6e66 696e 6974 6520 6e6f 7220 6e75   infinite nor nu
-00090ae0: 6c6c 2076 616c 7565 7320 696e 2063 6f72  ll values in cor
-00090af0: 725f 6c69 7374 2064 6620 2323 0d0a 2020  r_list df ##..  
-00090b00: 2020 2020 2020 6466 5f66 6974 203d 2064        df_fit = d
-00090b10: 665b 636f 7272 5f6c 6973 745d 0d0a 2020  f[corr_list]..  
-00090b20: 2020 2020 2020 2323 2320 4e6f 7720 6368        ### Now ch
-00090b30: 6563 6b20 6966 2074 6865 7265 2061 7265  eck if there are
-00090b40: 2061 6e79 204e 614e 2076 616c 7565 7320   any NaN values 
-00090b50: 696e 2074 6865 2064 6174 6173 6574 2023  in the dataset #
-00090b60: 2323 2323 0d0a 2020 2020 2020 2020 0d0a  ####..        ..
-00090b70: 2020 2020 2020 2020 6966 2064 665f 6669          if df_fi
-00090b80: 742e 6973 6e75 6c6c 2829 2e73 756d 2829  t.isnull().sum()
-00090b90: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
-00090ba0: 2020 2020 2020 2020 2064 665f 6669 7420           df_fit 
-00090bb0: 3d20 6466 5f66 6974 2e64 726f 706e 6128  = df_fit.dropna(
-00090bc0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00090bd0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00090be0: 696e 7428 2720 2020 2074 6865 7265 2061  int('    there a
-00090bf0: 7265 206e 6f20 6e75 6c6c 2076 616c 7565  re no null value
-00090c00: 7320 696e 2064 6174 6173 6574 2e2e 2e27  s in dataset...'
-00090c10: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
-00090c20: 2052 6564 7563 6520 6d65 6d6f 7279 2075   Reduce memory u
-00090c30: 7361 6765 2061 6e64 2066 696e 6420 6d75  sage and find mu
-00090c40: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
-00090c50: 2073 636f 7265 2023 2323 2320 2020 2020   score ####     
-00090c60: 2020 0d0a 2020 2020 2020 2020 2374 7279    ..        #try
-00090c70: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00090c80: 6466 5f66 6974 203d 2072 6564 7563 655f  df_fit = reduce_
-00090c90: 6d65 6d5f 7573 6167 6528 6466 5f66 6974  mem_usage(df_fit
-00090ca0: 290d 0a20 2020 2020 2020 2023 6578 6365  )..        #exce
-00090cb0: 7074 3a0d 0a20 2020 2020 2020 2023 2020  pt:..        #  
-00090cc0: 2020 7072 696e 7428 2752 6564 7563 6520    print('Reduce 
-00090cd0: 6d65 6d6f 7279 2065 7272 6f72 696e 672e  memory erroring.
-00090ce0: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
-00090cf0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
-00090d00: 5265 6164 7920 746f 2070 6572 666f 726d  Ready to perform
-00090d10: 2066 6974 2061 6e64 2066 696e 6420 6d75   fit and find mu
-00090d20: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
-00090d30: 2073 636f 7265 2023 2323 230d 0a20 2020   score ####..   
-00090d40: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00090d50: 2020 2020 2020 2066 732e 6669 7428 6466         fs.fit(df
-00090d60: 5f66 6974 2c20 6466 5f74 6172 6765 7429  _fit, df_target)
-00090d70: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00090d80: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00090d90: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
-00090da0: 4b42 6573 7428 2920 6675 6e63 7469 6f6e  KBest() function
-00090db0: 2069 7320 6572 726f 7269 6e67 2e20 5265   is erroring. Re
-00090dc0: 7475 726e 696e 6720 7769 7468 2061 6c6c  turning with all
-00090dd0: 2025 7320 7661 7269 6162 6c65 732e 2e2e   %s variables...
-00090de0: 2720 256c 656e 286e 756d 7661 7273 2929  ' %len(numvars))
-00090df0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00090e00: 7475 726e 206e 756d 7661 7273 0d0a 2020  turn numvars..  
-00090e10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00090e20: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00090e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090e70: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00090e80: 2020 2020 2020 2023 2323 2323 2323 2020         #######  
-00090e90: 2054 6869 7320 6973 2074 6865 206d 6169   This is the mai
-00090ea0: 6e20 7365 6374 696f 6e20 7768 6572 6520  n section where 
-00090eb0: 7765 2075 7365 206d 7574 7561 6c20 696e  we use mutual in
-00090ec0: 666f 2073 636f 7265 2074 6f20 7365 6c65  fo score to sele
-00090ed0: 6374 2076 6172 7320 2020 2020 2020 200d  ct vars        .
-00090ee0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00090ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00090f30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00090f40: 2020 2020 2020 2020 2020 2020 6d75 7475              mutu
-00090f50: 616c 5f69 6e66 6f20 3d20 6469 6374 287a  al_info = dict(z
-00090f60: 6970 2863 6f72 725f 6c69 7374 2c66 732e  ip(corr_list,fs.
-00090f70: 7363 6f72 6573 5f29 290d 0a20 2020 2020  scores_))..     
-00090f80: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
-00090f90: 6669 7273 7420 7661 7269 6162 6c65 2069  first variable i
-00090fa0: 6e20 6c69 7374 2068 6173 2074 6865 2068  n list has the h
-00090fb0: 6967 6865 7374 2063 6f72 7265 6c61 7469  ighest correlati
-00090fc0: 6f6e 2074 6f20 7468 6520 7461 7267 6574  on to the target
-00090fd0: 2076 6172 6961 626c 6520 2323 230d 0a20   variable ###.. 
-00090fe0: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
-00090ff0: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
-00091000: 203d 5b6b 6579 2066 6f72 2028 6b65 792c   =[key for (key,
-00091010: 7661 6c29 2069 6e20 736f 7274 6564 286d  val) in sorted(m
-00091020: 7574 7561 6c5f 696e 666f 2e69 7465 6d73  utual_info.items
-00091030: 2829 2c20 6b65 793d 6c61 6d62 6461 206b  (), key=lambda k
-00091040: 763a 206b 765b 315d 2c72 6576 6572 7365  v: kv[1],reverse
-00091050: 3d54 7275 6529 5d0d 0a20 2020 2020 2020  =True)]..       
-00091060: 2020 2020 2023 2323 2323 2020 204e 6f77       #####   Now
-00091070: 2077 6520 7365 6c65 6374 2074 6865 2066   we select the f
-00091080: 696e 616c 206c 6973 7420 6f66 2063 6f72  inal list of cor
-00091090: 7265 6c61 7465 6420 7661 7269 6162 6c65  related variable
-000910a0: 7320 2323 2323 2323 2323 2323 230d 0a20  s ###########.. 
-000910b0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-000910c0: 7465 645f 636f 7272 5f6c 6973 7420 3d20  ted_corr_list = 
-000910d0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-000910e0: 2323 2323 2059 6f75 2068 6176 6520 746f  #### You have to
-000910f0: 206d 616b 6520 6d75 6c74 6970 6c65 2063   make multiple c
-00091100: 6f70 6965 7320 6f66 2074 6869 7320 736f  opies of this so
-00091110: 7274 6564 206c 6973 7420 7369 6e63 6520  rted list since 
-00091120: 6974 2069 7320 6974 6572 6174 6564 206d  it is iterated m
-00091130: 616e 7920 7469 6d65 7320 2323 2323 0d0a  any times ####..
-00091140: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-00091150: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
-00091160: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
-00091170: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
-00091180: 2020 2020 2020 2020 2020 2020 636f 7079              copy
-00091190: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
-000911a0: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
-000911b0: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
-000911c0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
-000911d0: 5f70 6169 7220 3d20 636f 7079 2e64 6565  _pair = copy.dee
-000911e0: 7063 6f70 7928 636f 7272 5f70 6169 725f  pcopy(corr_pair_
-000911f0: 6469 6374 290d 0a20 2020 2020 2020 2020  dict)..         
-00091200: 2020 2023 2323 2320 7365 6c65 6374 2065     #### select e
-00091210: 6163 6820 7661 7269 6162 6c65 2062 7920  ach variable by 
-00091220: 7468 6520 6869 6768 6573 7420 6d75 7475  the highest mutu
-00091230: 616c 2069 6e66 6f20 616e 6420 7365 6520  al info and see 
-00091240: 7768 6174 2076 6172 7320 6172 6520 636f  what vars are co
-00091250: 7272 656c 6174 6564 2074 6f20 6974 0d0a  rrelated to it..
-00091260: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00091270: 6561 6368 5f63 6f72 725f 6e61 6d65 2069  each_corr_name i
-00091280: 6e20 636f 7079 5f73 6f72 7465 643a 0d0a  n copy_sorted:..
-00091290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000912a0: 2323 2320 6164 6420 7468 6520 7365 6c65  ### add the sele
-000912b0: 6374 6564 2076 6172 2074 6f20 7468 6520  cted var to the 
-000912c0: 7365 6c65 6374 6564 5f63 6f72 725f 6c69  selected_corr_li
-000912d0: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
-000912e0: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
-000912f0: 725f 6c69 7374 2e61 7070 656e 6428 6561  r_list.append(ea
-00091300: 6368 5f63 6f72 725f 6e61 6d65 290d 0a20  ch_corr_name).. 
-00091310: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00091320: 6f72 2065 6163 685f 7265 6d6f 7665 2069  or each_remove i
-00091330: 6e20 636f 7079 5f70 6169 725b 6561 6368  n copy_pair[each
-00091340: 5f63 6f72 725f 6e61 6d65 5d3a 0d0a 2020  _corr_name]:..  
-00091350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091360: 2020 2323 2323 204e 6f77 2072 656d 6f76    #### Now remov
-00091370: 6520 6561 6368 2076 6172 6961 626c 6520  e each variable 
-00091380: 7468 6174 2069 7320 6869 6768 6c79 2063  that is highly c
-00091390: 6f72 7265 6c61 7465 6420 746f 2074 6865  orrelated to the
-000913a0: 2073 656c 6563 7465 6420 7661 7269 6162   selected variab
-000913b0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-000913c0: 2020 2020 2020 2020 6966 2065 6163 685f          if each_
-000913d0: 7265 6d6f 7665 2069 6e20 636f 7079 5f73  remove in copy_s
-000913e0: 6f72 7465 643a 0d0a 2020 2020 2020 2020  orted:..        
-000913f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091400: 636f 7079 5f73 6f72 7465 642e 7265 6d6f  copy_sorted.remo
-00091410: 7665 2865 6163 685f 7265 6d6f 7665 290d  ve(each_remove).
-00091420: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00091430: 2323 204e 6f77 2077 6520 636f 6d62 696e  ## Now we combin
-00091440: 6520 7468 6520 756e 636f 7272 656c 6174  e the uncorrelat
-00091450: 6564 206c 6973 7420 746f 2074 6865 2073  ed list to the s
-00091460: 656c 6563 7465 6420 636f 7272 656c 6174  elected correlat
-00091470: 6564 206c 6973 7420 6162 6f76 650d 0a20  ed list above.. 
-00091480: 2020 2020 2020 2020 2020 2072 656d 5f63             rem_c
-00091490: 6f6c 5f6c 6973 7420 3d20 6c65 6674 5f73  ol_list = left_s
-000914a0: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
-000914b0: 636f 7272 5f6c 6973 7429 0d0a 2020 2020  corr_list)..    
-000914c0: 2020 2020 2020 2020 6669 6e61 6c5f 6c69          final_li
-000914d0: 7374 203d 2072 656d 5f63 6f6c 5f6c 6973  st = rem_col_lis
-000914e0: 7420 2b20 7365 6c65 6374 6564 5f63 6f72  t + selected_cor
-000914f0: 725f 6c69 7374 0d0a 2020 2020 2020 2020  r_list..        
-00091500: 2020 2020 7265 6d6f 7665 645f 636f 6c73      removed_cols
-00091510: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
-00091520: 286e 756d 7661 7273 2c20 6669 6e61 6c5f  (numvars, final_
-00091530: 6c69 7374 290d 0a20 2020 2020 2020 2065  list)..        e
-00091540: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00091550: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-00091560: 2020 2070 7269 6e74 2827 2020 2020 5355     print('    SU
-00091570: 4c4f 5620 4d65 7468 6f64 2063 7261 7368  LOV Method crash
-00091580: 696e 6720 6475 6520 746f 2025 7327 2025  ing due to %s' %
-00091590: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-000915a0: 2323 2323 2044 726f 7070 696e 6720 6869  #### Dropping hi
-000915b0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
-000915c0: 4665 6174 7572 6573 2066 6173 7420 7573  Features fast us
-000915d0: 696e 6720 7369 6d70 6c65 206c 696e 6561  ing simple linea
-000915e0: 7220 636f 7272 656c 6174 696f 6e20 2323  r correlation ##
-000915f0: 230d 0a20 2020 2020 2020 2020 2020 2072  #..            r
-00091600: 656d 6f76 6564 5f63 6f6c 7320 3d20 7265  emoved_cols = re
-00091610: 6d6f 7665 5f68 6967 686c 795f 636f 7272  move_highly_corr
-00091620: 656c 6174 6564 5f76 6172 735f 6661 7374  elated_vars_fast
-00091630: 2864 662c 636f 7272 5f6c 696d 6974 290d  (df,corr_limit).
-00091640: 0a20 2020 2020 2020 2020 2020 2066 696e  .            fin
-00091650: 616c 5f6c 6973 7420 3d20 6c65 6674 5f73  al_list = left_s
-00091660: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
-00091670: 2072 656d 6f76 6564 5f63 6f6c 7329 0d0a   removed_cols)..
-00091680: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
-00091690: 656d 6f76 6564 5f63 6f6c 7329 203e 2030  emoved_cols) > 0
-000916a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000916b0: 7269 6e74 2827 2020 2020 5265 6d6f 7669  rint('    Removi
-000916c0: 6e67 2028 2564 2920 6869 6768 6c79 2063  ng (%d) highly c
-000916d0: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
-000916e0: 6c65 733a 2720 2528 6c65 6e28 7265 6d6f  les:' %(len(remo
-000916f0: 7665 645f 636f 6c73 2929 290d 0a20 2020  ved_cols)))..   
-00091700: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00091710: 7265 6d6f 7665 645f 636f 6c73 2920 3c3d  removed_cols) <=
-00091720: 2033 303a 0d0a 2020 2020 2020 2020 2020   30:..          
-00091730: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00091740: 2025 7327 2025 7265 6d6f 7665 645f 636f   %s' %removed_co
-00091750: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
-00091760: 2069 6620 6c65 6e28 6669 6e61 6c5f 6c69   if len(final_li
-00091770: 7374 2920 3c3d 2033 303a 0d0a 2020 2020  st) <= 30:..    
-00091780: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00091790: 7428 2720 2020 2046 6f6c 6c6f 7769 6e67  t('    Following
-000917a0: 2028 2564 2920 7661 7273 2073 656c 6563   (%d) vars selec
-000917b0: 7465 643a 2025 7327 2025 286c 656e 2866  ted: %s' %(len(f
-000917c0: 696e 616c 5f6c 6973 7429 2c66 696e 616c  inal_list),final
-000917d0: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
-000917e0: 2023 2323 2323 2323 2323 2323 2323 2320   ############## 
-000917f0: 2020 2044 2052 2041 2057 2020 2043 204f     D R A W   C O
-00091800: 2052 2052 2045 204c 2041 2054 2049 204f   R R E L A T I O
-00091810: 204e 2020 204e 2045 2054 2057 204f 2052   N   N E T W O R
-00091820: 204b 2023 2323 2323 2323 2323 2323 2323   K #############
-00091830: 2323 2323 230d 0a20 2020 2020 2020 2073  #####..        s
-00091840: 656c 6563 7465 6420 3d20 636f 7079 2e64  elected = copy.d
-00091850: 6565 7063 6f70 7928 6669 6e61 6c5f 6c69  eepcopy(final_li
-00091860: 7374 290d 0a20 2020 2020 2020 2074 7279  st)..        try
-00091870: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00091880: 6d70 6f72 7420 6e65 7477 6f72 6b78 2061  mport networkx a
-00091890: 7320 6e78 0d0a 2020 2020 2020 2020 2020  s nx..          
-000918a0: 2020 2323 2323 204e 6f77 2073 7461 7274    #### Now start
-000918b0: 2062 7569 6c64 696e 6720 7468 6520 6772   building the gr
-000918c0: 6170 6820 2323 2323 2323 2323 2323 2323  aph ############
-000918d0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-000918e0: 2020 2020 2067 6620 3d20 6e78 2e47 7261       gf = nx.Gra
-000918f0: 7068 2829 0d0a 2020 2020 2020 2020 2020  ph()..          
-00091900: 2020 2323 2320 7468 6520 6d75 7475 616c    ### the mutual
-00091910: 2069 6e66 6f20 7363 6f72 6520 6769 7665   info score give
-00091920: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
-00091930: 6520 6275 6262 6c65 2023 2323 0d0a 2020  e bubble ###..  
-00091940: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
-00091950: 6c69 6572 203d 2032 3130 300d 0a20 2020  lier = 2100..   
-00091960: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
-00091970: 6820 696e 206f 7269 675f 736f 7274 6564  h in orig_sorted
-00091980: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00091990: 2020 2067 662e 6164 645f 6e6f 6465 2865     gf.add_node(e
-000919a0: 6163 682c 2073 697a 653d 696e 7428 6d61  ach, size=int(ma
-000919b0: 7828 312c 6d75 7475 616c 5f69 6e66 6f5b  x(1,mutual_info[
-000919c0: 6561 6368 5d2a 6d75 6c74 6970 6c69 6572  each]*multiplier
-000919d0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
-000919e0: 2023 2323 2323 2323 2323 2054 6869 7320   ######### This 
-000919f0: 6973 2077 6865 7265 2079 6f75 2063 616c  is where you cal
-00091a00: 6375 6c61 7465 2074 6865 2073 697a 6520  culate the size 
-00091a10: 6f66 2065 6163 6820 6e6f 6465 2074 6f20  of each node to 
-00091a20: 6472 6177 0d0a 2020 2020 2020 2020 2020  draw..          
-00091a30: 2020 7369 7a65 7320 3d20 5b6d 7574 7561    sizes = [mutua
-00091a40: 6c5f 696e 666f 5b78 5d2a 6d75 6c74 6970  l_info[x]*multip
-00091a50: 6c69 6572 2066 6f72 2078 2069 6e20 6c69  lier for x in li
-00091a60: 7374 2867 662e 6e6f 6465 7328 2929 5d0d  st(gf.nodes())].
-00091a70: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00091a80: 2320 2054 6865 2073 697a 6573 206f 6620  #  The sizes of 
-00091a90: 7468 6520 6275 6262 6c65 7320 666f 7220  the bubbles for 
-00091aa0: 6561 6368 206e 6f64 6520 6973 2064 6574  each node is det
-00091ab0: 6572 6d69 6e65 6420 6279 2069 7473 206d  ermined by its m
-00091ac0: 7574 7561 6c20 696e 666f 726d 6174 696f  utual informatio
-00091ad0: 6e20 7363 6f72 6520 7661 6c75 650d 0a20  n score value.. 
-00091ae0: 2020 2020 2020 2020 2020 2063 6f72 7220             corr 
-00091af0: 3d20 6466 5f66 6974 2e63 6f72 7228 290d  = df_fit.corr().
-00091b00: 0a20 2020 2020 2020 2020 2020 2068 6967  .            hig
-00091b10: 685f 636f 7272 203d 2063 6f72 725b 6162  h_corr = corr[ab
-00091b20: 7328 636f 7272 293e 636f 7272 5f6c 696d  s(corr)>corr_lim
-00091b30: 6974 5d0d 0a20 2020 2020 2020 2020 2020  it]..           
-00091b40: 2023 2320 6869 6768 5f63 6f72 7220 6973   ## high_corr is
-00091b50: 2074 6865 2064 6174 6166 7261 6d65 206f   the dataframe o
-00091b60: 6620 6120 6665 7720 7661 7269 6162 6c65  f a few variable
-00091b70: 7320 7468 6174 2061 7265 2068 6967 686c  s that are highl
-00091b80: 7920 636f 7272 656c 6174 6564 2074 6f20  y correlated to 
-00091b90: 6561 6368 206f 7468 6572 0d0a 2020 2020  each other..    
-00091ba0: 2020 2020 2020 2020 636f 6d62 6f73 203d          combos =
-00091bb0: 2063 6f6d 6269 6e61 7469 6f6e 7328 636f   combinations(co
-00091bc0: 7272 5f6c 6973 742c 3229 0d0a 2020 2020  rr_list,2)..    
-00091bd0: 2020 2020 2020 2020 2323 2320 7468 6973          ### this
-00091be0: 2067 6976 6573 2074 6865 2073 7472 656e   gives the stren
-00091bf0: 6774 6820 6f66 2063 6f72 7265 6c61 7469  gth of correlati
-00091c00: 6f6e 2062 6574 7765 656e 2032 206e 6f64  on between 2 nod
-00091c10: 6573 2023 230d 0a20 2020 2020 2020 2020  es ##..         
-00091c20: 2020 206d 756c 7469 706c 6965 7220 3d20     multiplier = 
-00091c30: 3230 0d0a 2020 2020 2020 2020 2020 2020  20..            
-00091c40: 666f 7220 2876 6172 312c 2076 6172 3229  for (var1, var2)
-00091c50: 2069 6e20 636f 6d62 6f73 3a0d 0a20 2020   in combos:..   
-00091c60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00091c70: 6e70 2e69 736e 616e 2868 6967 685f 636f  np.isnan(high_co
-00091c80: 7272 2e6c 6f63 5b76 6172 312c 7661 7232  rr.loc[var1,var2
-00091c90: 5d29 3a0d 0a20 2020 2020 2020 2020 2020  ]):..           
-00091ca0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-00091cb0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00091cc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00091cd0: 2020 2020 2020 2020 2020 6766 2e61 6464            gf.add
-00091ce0: 5f65 6467 6528 7661 7231 2c20 7661 7232  _edge(var1, var2
-00091cf0: 2c77 6569 6768 743d 6d75 6c74 6970 6c69  ,weight=multipli
-00091d00: 6572 2a68 6967 685f 636f 7272 2e6c 6f63  er*high_corr.loc
-00091d10: 5b76 6172 312c 7661 7232 5d29 0d0a 2020  [var1,var2])..  
-00091d20: 2020 2020 2020 2020 2020 2323 2323 2323            ######
-00091d30: 2323 204e 6f77 2073 7461 7274 2062 7569  ## Now start bui
-00091d40: 6c64 696e 6720 7468 6520 6e65 7477 6f72  lding the networ
-00091d50: 6b78 2067 7261 7068 2023 2323 2323 2323  kx graph #######
-00091d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00091d70: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00091d80: 2077 6964 7468 7320 3d20 6e78 2e67 6574   widths = nx.get
-00091d90: 5f65 6467 655f 6174 7472 6962 7574 6573  _edge_attributes
-00091da0: 2867 662c 2027 7765 6967 6874 2729 0d0a  (gf, 'weight')..
-00091db0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-00091dc0: 6c69 7374 203d 2067 662e 6e6f 6465 7328  list = gf.nodes(
-00091dd0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00091de0: 6f6c 7320 3d20 350d 0a20 2020 2020 2020  ols = 5..       
-00091df0: 2020 2020 2068 6569 6768 745f 7369 7a65       height_size
-00091e00: 203d 2035 0d0a 2020 2020 2020 2020 2020   = 5..          
-00091e10: 2020 7769 6474 685f 7369 7a65 203d 2031    width_size = 1
-00091e20: 350d 0a20 2020 2020 2020 2020 2020 2072  5..            r
-00091e30: 6f77 7320 3d20 696e 7428 6c65 6e28 636f  ows = int(len(co
-00091e40: 7272 5f6c 6973 7429 2f63 6f6c 7329 0d0a  rr_list)/cols)..
-00091e50: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00091e60: 6f77 7320 3c20 313a 0d0a 2020 2020 2020  ows < 1:..      
-00091e70: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
-00091e80: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-00091e90: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
-00091ea0: 7a65 3d28 7769 6474 685f 7369 7a65 2c6d  ze=(width_size,m
-00091eb0: 696e 2832 302c 6865 6967 6874 5f73 697a  in(20,height_siz
-00091ec0: 652a 726f 7773 2929 290d 0a20 2020 2020  e*rows)))..     
-00091ed0: 2020 2020 2020 2070 6f73 203d 206e 782e         pos = nx.
-00091ee0: 7368 656c 6c5f 6c61 796f 7574 2867 6629  shell_layout(gf)
-00091ef0: 0d0a 2020 2020 2020 2020 2020 2020 6e78  ..            nx
-00091f00: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6e  .draw_networkx_n
-00091f10: 6f64 6573 2867 662c 706f 732c 0d0a 2020  odes(gf,pos,..  
-00091f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f40: 206e 6f64 656c 6973 743d 6e6f 6465 6c69   nodelist=nodeli
-00091f50: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
-00091f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f70: 2020 2020 2020 2020 6e6f 6465 5f73 697a          node_siz
-00091f80: 653d 7369 7a65 732c 0d0a 2020 2020 2020  e=sizes,..      
-00091f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091fa0: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
-00091fb0: 655f 636f 6c6f 723d 2762 6c75 6527 2c0d  e_color='blue',.
-00091fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00091fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091fe0: 2020 2020 616c 7068 613d 302e 3529 0d0a      alpha=0.5)..
-00091ff0: 2020 2020 2020 2020 2020 2020 6e78 2e64              nx.d
-00092000: 7261 775f 6e65 7477 6f72 6b78 5f65 6467  raw_networkx_edg
-00092010: 6573 2867 662c 706f 732c 0d0a 2020 2020  es(gf,pos,..    
-00092020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092030: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00092040: 6467 656c 6973 7420 3d20 7769 6474 6873  dgelist = widths
-00092050: 2e6b 6579 7328 292c 0d0a 2020 2020 2020  .keys(),..      
-00092060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092070: 2020 2020 2020 2020 2020 2020 2077 6964               wid
-00092080: 7468 3d6c 6973 7428 7769 6474 6873 2e76  th=list(widths.v
-00092090: 616c 7565 7328 2929 2c0d 0a20 2020 2020  alues()),..     
-000920a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000920b0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-000920c0: 6765 5f63 6f6c 6f72 3d27 6c69 6768 7462  ge_color='lightb
-000920d0: 6c75 6527 2c0d 0a20 2020 2020 2020 2020  lue',..         
-000920e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000920f0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-00092100: 302e 3629 0d0a 2020 2020 2020 2020 2020  0.6)..          
-00092110: 2020 706f 735f 6869 6768 6572 203d 207b    pos_higher = {
-00092120: 7d0d 0a20 2020 2020 2020 2020 2020 2078  }..            x
-00092130: 5f6f 6666 203d 2030 2e30 3420 2023 206f  _off = 0.04  # o
-00092140: 6666 7365 7420 6f6e 2074 6865 2078 2061  ffset on the x a
-00092150: 7869 730d 0a20 2020 2020 2020 2020 2020  xis..           
-00092160: 2079 5f6f 6666 203d 2030 2e30 3420 2023   y_off = 0.04  #
-00092170: 206f 6666 7365 7420 6f6e 2074 6865 2079   offset on the y
-00092180: 2061 7869 730d 0a20 2020 2020 2020 2020   axis..         
-00092190: 2020 2066 6f72 206b 2c20 7620 696e 2070     for k, v in p
-000921a0: 6f73 2e69 7465 6d73 2829 3a0d 0a20 2020  os.items():..   
-000921b0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-000921c0: 5f68 6967 6865 725b 6b5d 203d 2028 765b  _higher[k] = (v[
-000921d0: 305d 2b78 5f6f 6666 2c20 765b 315d 2b79  0]+x_off, v[1]+y
-000921e0: 5f6f 6666 290d 0a20 2020 2020 2020 2020  _off)..         
-000921f0: 2020 2069 6620 6c65 6e28 7365 6c65 6374     if len(select
-00092200: 6564 2920 3d3d 2030 3a0d 0a20 2020 2020  ed) == 0:..     
-00092210: 2020 2020 2020 2020 2020 206e 782e 6472             nx.dr
-00092220: 6177 5f6e 6574 776f 726b 785f 6c61 6265  aw_networkx_labe
-00092230: 6c73 2867 662c 2070 6f73 3d70 6f73 5f68  ls(gf, pos=pos_h
-00092240: 6967 6865 722c 0d0a 2020 2020 2020 2020  igher,..        
-00092250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092260: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
-00092270: 6c73 3d64 6963 7428 7a69 7028 6e6f 6465  ls=dict(zip(node
-00092280: 6c69 7374 2c6e 6f64 656c 6973 7429 292c  list,nodelist)),
-00092290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000922a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000922b0: 2020 2020 2020 666f 6e74 5f63 6f6c 6f72        font_color
-000922c0: 3d27 626c 6163 6b27 290d 0a20 2020 2020  ='black')..     
-000922d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000922e0: 2020 2020 2020 2020 2020 2020 2020 6e78                nx
-000922f0: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6c  .draw_networkx_l
-00092300: 6162 656c 7328 6766 2c20 706f 733d 706f  abels(gf, pos=po
-00092310: 735f 6869 6768 6572 2c0d 0a20 2020 2020  s_higher,..     
-00092320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092330: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00092340: 6162 656c 7320 3d20 6469 6374 287a 6970  abels = dict(zip
-00092350: 286e 6f64 656c 6973 742c 5b78 2b27 2028  (nodelist,[x+' (
-00092360: 7365 6c65 6374 6564 2927 2069 6620 7820  selected)' if x 
-00092370: 696e 2073 656c 6563 7465 6420 656c 7365  in selected else
-00092380: 2078 2b27 2028 7265 6d6f 7665 6429 2720   x+' (removed)' 
-00092390: 666f 7220 7820 696e 206e 6f64 656c 6973  for x in nodelis
-000923a0: 745d 2929 2c0d 0a20 2020 2020 2020 2020  t])),..         
-000923b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000923c0: 2020 2020 2020 2020 2020 2066 6f6e 745f             font_
-000923d0: 636f 6c6f 723d 2762 6c61 636b 2729 0d0a  color='black')..
-000923e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-000923f0: 626f 7828 5472 7565 290d 0a20 2020 2020  box(True)..     
-00092400: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
-00092410: 2822 2222 496e 2053 554c 4f56 2c20 7765  ("""In SULOV, we
-00092420: 2072 6570 6561 7465 646c 7920 7265 6d6f   repeatedly remo
-00092430: 7665 2066 6561 7475 7265 7320 7769 7468  ve features with
-00092440: 206c 6f77 6572 206d 7574 7561 6c20 696e   lower mutual in
-00092450: 666f 2073 636f 7265 7320 616d 6f6e 6720  fo scores among 
-00092460: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
-00092470: 6420 7061 6972 7320 2873 6565 2066 6967  d pairs (see fig
-00092480: 7572 6529 2c0d 0a20 2020 2020 2020 2020  ure),..         
-00092490: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-000924a0: 554c 4f56 2073 656c 6563 7473 2074 6865  ULOV selects the
-000924b0: 2066 6561 7475 7265 2077 6974 6820 6869   feature with hi
-000924c0: 6768 6572 206d 7574 7561 6c20 696e 666f  gher mutual info
-000924d0: 2073 636f 7265 2072 656c 6174 6564 2074   score related t
-000924e0: 6f20 7461 7267 6574 2077 6865 6e20 6368  o target when ch
-000924f0: 6f6f 7369 6e67 2062 6574 7765 656e 2061  oosing between a
-00092500: 2070 6169 722e 2022 2222 2c20 666f 6e74   pair. """, font
-00092510: 7369 7a65 3d31 3029 0d0a 2020 2020 2020  size=10)..      
-00092520: 2020 2020 2020 706c 742e 7375 7074 6974        plt.suptit
-00092530: 6c65 2827 486f 7720 5355 4c4f 5620 4d65  le('How SULOV Me
-00092540: 7468 6f64 2057 6f72 6b73 2062 7920 5265  thod Works by Re
-00092550: 6d6f 7669 6e67 2048 6967 686c 7920 436f  moving Highly Co
-00092560: 7272 656c 6174 6564 2046 6561 7475 7265  rrelated Feature
-00092570: 7327 2c20 666f 6e74 7369 7a65 3d32 302c  s', fontsize=20,
-00092580: 793d 312e 3033 290d 0a20 2020 2020 2020  y=1.03)..       
-00092590: 2020 2020 2072 6564 5f70 6174 6368 203d       red_patch =
-000925a0: 206d 7061 7463 6865 732e 5061 7463 6828   mpatches.Patch(
-000925b0: 636f 6c6f 723d 2762 6c75 6527 2c20 6c61  color='blue', la
-000925c0: 6265 6c3d 2742 6967 6765 7220 6369 7263  bel='Bigger circ
-000925d0: 6c65 2064 656e 6f74 6573 2068 6967 6865  le denotes highe
-000925e0: 7220 6d75 7475 616c 2069 6e66 6f20 7363  r mutual info sc
-000925f0: 6f72 6520 7769 7468 2074 6172 6765 7427  ore with target'
-00092600: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
-00092610: 6c75 655f 7061 7463 6820 3d20 6d70 6174  lue_patch = mpat
-00092620: 6368 6573 2e50 6174 6368 2863 6f6c 6f72  ches.Patch(color
-00092630: 3d27 6c69 6768 7462 6c75 6527 2c20 6c61  ='lightblue', la
-00092640: 6265 6c3d 2754 6869 636b 6572 206c 696e  bel='Thicker lin
-00092650: 6520 6465 6e6f 7465 7320 6869 6768 6572  e denotes higher
-00092660: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
-00092670: 7765 656e 2074 776f 2076 6172 6961 626c  ween two variabl
-00092680: 6573 2729 0d0a 2020 2020 2020 2020 2020  es')..          
-00092690: 2020 706c 742e 6c65 6765 6e64 2868 616e    plt.legend(han
-000926a0: 646c 6573 3d5b 7265 645f 7061 7463 682c  dles=[red_patch,
-000926b0: 2062 6c75 655f 7061 7463 685d 2c6c 6f63   blue_patch],loc
-000926c0: 3d27 6265 7374 2729 0d0a 2020 2020 2020  ='best')..      
-000926d0: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
-000926e0: 3b0d 0a20 2020 2020 2020 2020 2020 2023  ;..            #
-000926f0: 2323 2323 2020 2020 4e20 4520 5420 5720  ####    N E T W 
-00092700: 4f20 5220 4b20 2020 2020 4420 4920 4120  O R K     D I A 
-00092710: 4720 5220 4120 4d20 2020 2043 204f 204d  G R A M    C O M
-00092720: 2050 204c 2045 2054 2045 2020 2023 2323   P L E T E   ###
-00092730: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00092740: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00092750: 726e 2066 696e 616c 5f6c 6973 742b 7265  rn final_list+re
-00092760: 6d76 6172 730d 0a20 2020 2020 2020 2065  mvars..        e
-00092770: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00092780: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-00092790: 2020 2070 7269 6e74 2827 2020 2020 4e65     print('    Ne
-000927a0: 7477 6f72 6b78 206c 6962 7261 7279 2076  tworkx library v
-000927b0: 6973 7561 6c69 7a61 7469 6f6e 2063 7261  isualization cra
-000927c0: 7368 696e 6720 6475 6520 746f 2025 7327  shing due to %s'
-000927d0: 2025 6529 0d0a 2020 2020 2020 2020 2020   %e)..          
-000927e0: 2020 7072 696e 7428 2743 6f6e 7469 6e75    print('Continu
-000927f0: 696e 6720 7769 7468 2053 554c 4f56 2e20  ing with SULOV. 
-00092800: 2564 2066 6561 7475 7265 7320 7365 6c65  %d features sele
-00092810: 6374 6564 2720 256c 656e 2866 696e 616c  cted' %len(final
-00092820: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
-00092830: 2020 2020 2072 6574 7572 6e20 6669 6e61       return fina
-00092840: 6c5f 6c69 7374 2b72 656d 7661 7273 0d0a  l_list+remvars..
-00092850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00092890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000928a0: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
-000928b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000928c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000928d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000928e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000928f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000929f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00092a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00092a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00092a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00092a90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
-00092aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00092b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00092b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c00: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
-00092c10: 3631 352e 3834 3137 3730 340a 0000 0000  615.8417704.....
-00092c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00092e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00092e20: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
-00092e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00092e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00092e80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00092e90: 3030 3000 3031 3634 3434 0020 3500 0000  000.016444. 5...
-00092ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0008f210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0008f270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0008f280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0008f290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0008f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0008f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008f350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f400: 3232 206d 7469 6d65 3d31 3637 3831 3539  22 mtime=1678159
+0008f410: 3732 322e 300a 0000 0000 0000 0000 0000  722.0...........
+0008f420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+0008f610: 2f61 7574 6f76 696d 6c2f 7375 6c6f 765f  /autoviml/sulov_
+0008f620: 6d65 7468 6f64 2e70 7900 0000 0000 0000  method.py.......
+0008f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0008f670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0008f680: 3030 3333 3234 3500 3030 3030 3030 3030  0033245.00000000
+0008f690: 3030 3000 3032 3030 3437 0020 3000 0000  000.020047. 0...
+0008f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+0008f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+0008f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0008f750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0008f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0008f800: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0008f810: 6e70 0d0a 696d 706f 7274 2070 616e 6461  np..import panda
+0008f820: 7320 6173 2070 640d 0a69 6d70 6f72 7420  s as pd..import 
+0008f830: 7261 6e64 6f6d 0d0a 6e70 2e72 616e 646f  random..np.rando
+0008f840: 6d2e 7365 6564 2839 3929 0d0a 7261 6e64  m.seed(99)..rand
+0008f850: 6f6d 2e73 6565 6428 3432 290d 0a23 2323  om.seed(42)..###
+0008f860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008f8a0: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+0008f8b0: 2323 2320 5468 6520 7761 726e 696e 6773  ### The warnings
+0008f8c0: 2066 726f 6d20 536b 6c65 6172 6e20 6172   from Sklearn ar
+0008f8d0: 6520 736f 2061 6e6e 6f79 696e 6720 7468  e so annoying th
+0008f8e0: 6174 2049 2068 6176 6520 746f 2073 6875  at I have to shu
+0008f8f0: 7420 6974 206f 6666 2023 2323 2323 2323  t it off #######
+0008f900: 0d0a 696d 706f 7274 2077 6172 6e69 6e67  ..import warning
+0008f910: 730d 0a77 6172 6e69 6e67 732e 6669 6c74  s..warnings.filt
+0008f920: 6572 7761 726e 696e 6773 2822 6967 6e6f  erwarnings("igno
+0008f930: 7265 2229 0d0a 6672 6f6d 2073 6b6c 6561  re")..from sklea
+0008f940: 726e 2e65 7863 6570 7469 6f6e 7320 696d  rn.exceptions im
+0008f950: 706f 7274 2044 6174 6143 6f6e 7665 7273  port DataConvers
+0008f960: 696f 6e57 6172 6e69 6e67 0d0a 7761 726e  ionWarning..warn
+0008f970: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+0008f980: 6e67 7328 6163 7469 6f6e 3d27 6967 6e6f  ngs(action='igno
+0008f990: 7265 272c 2063 6174 6567 6f72 793d 4461  re', category=Da
+0008f9a0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
+0008f9b0: 696e 6729 0d0a 6465 6620 7761 726e 282a  ing)..def warn(*
+0008f9c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+0008f9d0: 0d0a 2020 2020 7061 7373 0d0a 7761 726e  ..    pass..warn
+0008f9e0: 696e 6773 2e77 6172 6e20 3d20 7761 726e  ings.warn = warn
+0008f9f0: 0d0a 696d 706f 7274 206c 6f67 6769 6e67  ..import logging
+0008fa00: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0008fa10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fa20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fa30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fa40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fa50: 2323 2323 2323 0d0a 696d 706f 7274 2070  ######..import p
+0008fa60: 6462 0d0a 696d 706f 7274 2063 6f70 790d  db..import copy.
+0008fa70: 0a69 6d70 6f72 7420 7469 6d65 0d0a 6672  .import time..fr
+0008fa80: 6f6d 2073 6b6c 6561 726e 2e66 6561 7475  om sklearn.featu
+0008fa90: 7265 5f73 656c 6563 7469 6f6e 2069 6d70  re_selection imp
+0008faa0: 6f72 7420 6368 6932 2c20 6d75 7475 616c  ort chi2, mutual
+0008fab0: 5f69 6e66 6f5f 7265 6772 6573 7369 6f6e  _info_regression
+0008fac0: 2c20 6d75 7475 616c 5f69 6e66 6f5f 636c  , mutual_info_cl
+0008fad0: 6173 7369 660d 0a66 726f 6d20 736b 6c65  assif..from skle
+0008fae0: 6172 6e2e 6665 6174 7572 655f 7365 6c65  arn.feature_sele
+0008faf0: 6374 696f 6e20 696d 706f 7274 2053 656c  ction import Sel
+0008fb00: 6563 744b 4265 7374 0d0a 6672 6f6d 2069  ectKBest..from i
+0008fb10: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
+0008fb20: 636f 6d62 696e 6174 696f 6e73 0d0a 696d  combinations..im
+0008fb30: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0008fb40: 7061 7463 6865 7320 6173 206d 7061 7463  patches as mpatc
+0008fb50: 6865 730d 0a69 6d70 6f72 7420 6d61 7470  hes..import matp
+0008fb60: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
+0008fb70: 2070 6c74 0d0a 6672 6f6d 2063 6f6c 6c65   plt..from colle
+0008fb80: 6374 696f 6e73 2069 6d70 6f72 7420 6465  ctions import de
+0008fb90: 6661 756c 7464 6963 740d 0a66 726f 6d20  faultdict..from 
+0008fba0: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0008fbb0: 7274 204f 7264 6572 6564 4469 6374 0d0a  rt OrderedDict..
+0008fbc0: 696d 706f 7274 2074 696d 650d 0a23 2323  import time..###
+0008fbd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fbe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fbf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fc00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fc10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fc20: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0008fc30: 6465 6620 6c65 6674 5f73 7562 7472 6163  def left_subtrac
+0008fc40: 7428 6c31 2c6c 3229 3a0d 0a20 2020 206c  t(l1,l2):..    l
+0008fc50: 7374 203d 205b 5d0d 0a20 2020 2066 6f72  st = []..    for
+0008fc60: 2069 2069 6e20 6c31 3a0d 0a20 2020 2020   i in l1:..     
+0008fc70: 2020 2069 6620 6920 6e6f 7420 696e 206c     if i not in l
+0008fc80: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
+0008fc90: 6c73 742e 6170 7065 6e64 2869 290d 0a20  lst.append(i).. 
+0008fca0: 2020 2072 6574 7572 6e20 6c73 740d 0a23     return lst..#
+0008fcb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fcc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fcd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fce0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fcf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fd00: 0d0a 6465 6620 7265 7475 726e 5f64 6963  ..def return_dic
+0008fd10: 7469 6f6e 6172 795f 6c69 7374 286c 7374  tionary_list(lst
+0008fd20: 5f6f 665f 7475 706c 6573 293a 0d0a 2020  _of_tuples):..  
+0008fd30: 2020 2222 2220 5265 7475 726e 7320 6120    """ Returns a 
+0008fd40: 6469 6374 696f 6e61 7279 206f 6620 6c69  dictionary of li
+0008fd50: 7374 7320 6966 2079 6f75 2073 656e 6420  sts if you send 
+0008fd60: 696e 2061 206c 6973 7420 6f66 2054 7570  in a list of Tup
+0008fd70: 6c65 7322 2222 0d0a 2020 2020 6f72 4469  les"""..    orDi
+0008fd80: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
+0008fd90: 286c 6973 7429 0d0a 2020 2020 2320 6974  (list)..    # it
+0008fda0: 6572 6174 696e 6720 6f76 6572 206c 6973  erating over lis
+0008fdb0: 7420 6f66 2074 7570 6c65 730d 0a20 2020  t of tuples..   
+0008fdc0: 2066 6f72 206b 6579 2c20 7661 6c20 696e   for key, val in
+0008fdd0: 206c 7374 5f6f 665f 7475 706c 6573 3a0d   lst_of_tuples:.
+0008fde0: 0a20 2020 2020 2020 206f 7244 6963 745b  .        orDict[
+0008fdf0: 6b65 795d 2e61 7070 656e 6428 7661 6c29  key].append(val)
+0008fe00: 0d0a 2020 2020 7265 7475 726e 206f 7244  ..    return orD
+0008fe10: 6963 740d 0a23 2323 2323 2323 2323 2323  ict..###########
+0008fe20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fe30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fe40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fe50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fe60: 2323 2323 230d 0a64 6566 2066 696e 645f  #####..def find_
+0008fe70: 7265 6d6f 7665 5f64 7570 6c69 6361 7465  remove_duplicate
+0008fe80: 7328 6c69 7374 5f6f 665f 7661 6c75 6573  s(list_of_values
+0008fe90: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0008fea0: 2023 2052 656d 6f76 6573 2064 7570 6c69   # Removes dupli
+0008feb0: 6361 7465 7320 6672 6f6d 2061 206c 6973  cates from a lis
+0008fec0: 7420 746f 2072 6574 7572 6e20 756e 6971  t to return uniq
+0008fed0: 7565 2076 616c 7565 7320 2d20 5553 4544  ue values - USED
+0008fee0: 204f 4e4c 5920 4f4e 4345 0d0a 2020 2020   ONLY ONCE..    
+0008fef0: 2222 220d 0a20 2020 206f 7574 7075 7420  """..    output 
+0008ff00: 3d20 5b5d 0d0a 2020 2020 7365 656e 203d  = []..    seen =
+0008ff10: 2073 6574 2829 0d0a 2020 2020 666f 7220   set()..    for 
+0008ff20: 7661 6c75 6520 696e 206c 6973 745f 6f66  value in list_of
+0008ff30: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
+0008ff40: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
+0008ff50: 6e20 7365 656e 3a0d 0a20 2020 2020 2020  n seen:..       
+0008ff60: 2020 2020 206f 7574 7075 742e 6170 7065       output.appe
+0008ff70: 6e64 2876 616c 7565 290d 0a20 2020 2020  nd(value)..     
+0008ff80: 2020 2020 2020 2073 6565 6e2e 6164 6428         seen.add(
+0008ff90: 7661 6c75 6529 0d0a 2020 2020 7265 7475  value)..    retu
+0008ffa0: 726e 206f 7574 7075 740d 0a23 2323 2323  rn output..#####
+0008ffb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ffc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ffd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008ffe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0008fff0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+00090000: 6566 2046 455f 7265 6d6f 7665 5f76 6172  ef FE_remove_var
+00090010: 6961 626c 6573 5f75 7369 6e67 5f53 554c  iables_using_SUL
+00090020: 4f56 5f6d 6574 686f 6428 6466 2c20 7072  OV_method(df, pr
+00090030: 6564 735f 696e 2c20 6d6f 6465 6c74 7970  eds_in, modeltyp
+00090040: 652c 2074 6172 6765 742c 0d0a 2020 2020  e, target,..    
+00090050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090060: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+00090070: 5f6c 696d 6974 203d 2030 2e37 302c 7665  _limit = 0.70,ve
+00090080: 7262 6f73 653d 302c 2064 6173 6b5f 7867  rbose=0, dask_xg
+00090090: 626f 6f73 745f 666c 6167 3d46 616c 7365  boost_flag=False
+000900a0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+000900b0: 2046 4520 7374 616e 6473 2066 6f72 2046   FE stands for F
+000900c0: 6561 7475 7265 2045 6e67 696e 6565 7269  eature Engineeri
+000900d0: 6e67 202d 2069 7420 6d65 616e 7320 7468  ng - it means th
+000900e0: 6973 2066 756e 6374 696f 6e20 7065 7266  is function perf
+000900f0: 6f72 6d73 2066 6561 7475 7265 2065 6e67  orms feature eng
+00090100: 696e 6565 7269 6e67 0d0a 2020 2020 2323  ineering..    ##
+00090110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090160: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
+00090170: 2323 2323 2020 2020 2020 2020 2020 2020  ####            
+00090180: 2020 5355 4c4f 5620 7374 616e 6473 2066    SULOV stands f
+00090190: 6f72 2053 6561 7263 6869 6e67 2055 6e63  or Searching Unc
+000901a0: 6f72 7265 6c61 7465 6420 4c69 7374 204f  orrelated List O
+000901b0: 6620 5661 7269 6162 6c65 7320 2023 2323  f Variables  ###
+000901c0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+000901d0: 5468 6973 2068 6967 686c 7920 6566 6669  This highly effi
+000901e0: 6369 656e 7420 6d65 7468 6f64 2072 656d  cient method rem
+000901f0: 6f76 6573 2076 6172 6961 626c 6573 2074  oves variables t
+00090200: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
+00090210: 6f72 7265 6c61 7465 6420 7573 696e 6720  orrelated using 
+00090220: 6120 7365 7269 6573 206f 660d 0a20 2020  a series of..   
+00090230: 2070 6169 722d 7769 7365 2063 6f72 7265   pair-wise corre
+00090240: 6c61 7469 6f6e 206b 6e6f 636b 6f75 7420  lation knockout 
+00090250: 726f 756e 6473 2e20 4974 2069 7320 6578  rounds. It is ex
+00090260: 7472 656d 656c 7920 6661 7374 2061 6e64  tremely fast and
+00090270: 2068 656e 6365 2063 616e 2077 6f72 6b20   hence can work 
+00090280: 6f6e 2074 686f 7573 616e 6473 0d0a 2020  on thousands..  
+00090290: 2020 6f66 2076 6172 6961 626c 6573 2069    of variables i
+000902a0: 6e20 6c65 7373 2074 6861 6e20 6120 6d69  n less than a mi
+000902b0: 6e75 7465 2c20 6576 656e 206f 6e20 6120  nute, even on a 
+000902c0: 6c61 7074 6f70 2e20 596f 7520 6e65 6564  laptop. You need
+000902d0: 2074 6f20 7365 6e64 2069 6e20 6120 6c69   to send in a li
+000902e0: 7374 206f 6620 6e75 6d65 7269 630d 0a20  st of numeric.. 
+000902f0: 2020 2076 6172 6961 626c 6573 2061 6e64     variables and
+00090300: 2074 6861 7427 7320 616c 6c21 2054 6865   that's all! The
+00090310: 206d 6574 686f 6420 6465 6669 6e65 7320   method defines 
+00090320: 6869 6768 2043 6f72 7265 6c61 7469 6f6e  high Correlation
+00090330: 2061 7320 616e 7974 6869 6e67 206f 7665   as anything ove
+00090340: 7220 302e 3730 2028 6162 736f 6c75 7465  r 0.70 (absolute
+00090350: 290d 0a20 2020 2062 7574 2074 6869 7320  )..    but this 
+00090360: 6361 6e20 6265 2063 6861 6e67 6564 2e20  can be changed. 
+00090370: 4966 2074 776f 2076 6172 6961 626c 6573  If two variables
+00090380: 2068 6176 6520 6162 736f 6c75 7465 2063   have absolute c
+00090390: 6f72 7265 6c61 7469 6f6e 2068 6967 6865  orrelation highe
+000903a0: 7220 7468 616e 2074 6869 732c 2074 6865  r than this, the
+000903b0: 790d 0a20 2020 2077 696c 6c20 6265 206d  y..    will be m
+000903c0: 6172 6b65 642c 2061 6e64 2075 7369 6e67  arked, and using
+000903d0: 2061 2070 726f 6365 7373 206f 6620 656c   a process of el
+000903e0: 696d 696e 6174 696f 6e2c 206f 6e65 206f  imination, one o
+000903f0: 6620 7468 656d 2077 696c 6c20 6765 7420  f them will get 
+00090400: 6b6e 6f63 6b65 6420 6f75 743a 0d0a 2020  knocked out:..  
+00090410: 2020 546f 2064 6563 6964 6520 6f72 6465    To decide orde
+00090420: 7220 6f66 2076 6172 6961 626c 6573 2074  r of variables t
+00090430: 6f20 6b65 6570 2c20 7765 2075 7365 206d  o keep, we use m
+00090440: 7574 7561 696c 2069 6e66 6f72 6d61 7469  utuail informati
+00090450: 6f6e 2073 636f 7265 2074 6f20 7365 6c65  on score to sele
+00090460: 6374 2e20 4d49 5320 7265 7475 726e 730d  ct. MIS returns.
+00090470: 0a20 2020 2061 2072 616e 6b65 6420 6c69  .    a ranked li
+00090480: 7374 206f 6620 7468 6573 6520 636f 7272  st of these corr
+00090490: 656c 6174 6564 2076 6172 6961 626c 6573  elated variables
+000904a0: 3a20 7768 656e 2077 6520 7365 6c65 6374  : when we select
+000904b0: 206f 6e65 2c20 7765 206b 6e6f 636b 206f   one, we knock o
+000904c0: 7574 206f 7468 6572 730d 0a20 2020 2074  ut others..    t
+000904d0: 6861 7420 6974 2069 7320 636f 7272 656c  hat it is correl
+000904e0: 6174 6564 2074 6f2e 2054 6865 6e20 7765  ated to. Then we
+000904f0: 2073 656c 6563 7420 6e65 7874 2076 6172   select next var
+00090500: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
+00090510: 6f63 6b20 6f75 7420 636f 7272 656c 6174  ock out correlat
+00090520: 6564 2076 6172 6961 626c 6573 2e0d 0a20  ed variables... 
+00090530: 2020 2046 696e 616c 6c79 2077 6520 6172     Finally we ar
+00090540: 6520 6c65 6674 2077 6974 6820 756e 636f  e left with unco
+00090550: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
+00090560: 6573 2074 6861 7420 6172 6520 616c 736f  es that are also
+00090570: 2068 6967 686c 7920 696d 706f 7274 616e   highly importan
+00090580: 7420 696e 206d 7574 7561 6c20 7363 6f72  t in mutual scor
+00090590: 652e 0d0a 2020 2020 2323 2323 2323 2323  e...    ########
+000905a0: 2020 594f 5520 4d55 5354 2049 4e43 4c55    YOU MUST INCLU
+000905b0: 4445 2054 4845 2041 424f 5645 204d 4553  DE THE ABOVE MES
+000905c0: 5341 4745 2049 4620 594f 5520 434f 5059  SAGE IF YOU COPY
+000905d0: 2054 4849 5320 434f 4445 2049 4e20 594f   THIS CODE IN YO
+000905e0: 5552 204c 4942 5241 5259 2023 2323 2323  UR LIBRARY #####
+000905f0: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
+00090600: 2020 2020 0d0a 2020 2020 6466 203d 2063      ..    df = c
+00090610: 6f70 792e 6465 6570 636f 7079 2864 6629  opy.deepcopy(df)
+00090620: 0d0a 2020 2020 6466 5f74 6172 6765 7420  ..    df_target 
+00090630: 3d20 6466 5b74 6172 6765 745d 0d0a 2020  = df[target]..  
+00090640: 2020 6e75 6d76 6172 7320 3d20 6466 5b70    numvars = df[p
+00090650: 7265 6473 5f69 6e5d 2e73 656c 6563 745f  reds_in].select_
+00090660: 6474 7970 6573 2869 6e63 6c75 6465 3d27  dtypes(include='
+00090670: 666c 6f61 7427 292e 636f 6c75 6d6e 732e  float').columns.
+00090680: 746f 6c69 7374 2829 0d0a 2020 2020 7265  tolist()..    re
+00090690: 6d76 6172 7320 3d20 6c65 6674 5f73 7562  mvars = left_sub
+000906a0: 7472 6163 7428 7072 6564 735f 696e 2c20  tract(preds_in, 
+000906b0: 6e75 6d76 6172 7329 0d0a 2020 2020 6466  numvars)..    df
+000906c0: 203d 2064 665b 6e75 6d76 6172 735d 0d0a   = df[numvars]..
+000906d0: 2020 2020 2323 2320 666f 7220 736f 6d65      ### for some
+000906e0: 2072 6561 736f 6e2c 2064 6f69 6e67 2061   reason, doing a
+000906f0: 206d 6173 7320 6669 6c6c 6e61 206f 6620   mass fillna of 
+00090700: 7661 7273 2064 6f65 736e 2774 2077 6f72  vars doesn't wor
+00090710: 6b21 2048 656e 6365 2064 6f69 6e67 2069  k! Hence doing i
+00090720: 7420 696e 6469 7669 6475 616c 6c79 210d  t individually!.
+00090730: 0a20 2020 206e 756c 6c5f 7661 7273 203d  .    null_vars =
+00090740: 206e 702e 6172 7261 7928 6e75 6d76 6172   np.array(numvar
+00090750: 7329 5b64 662e 6973 6e75 6c6c 2829 2e73  s)[df.isnull().s
+00090760: 756d 2829 3e30 5d0d 0a20 2020 2066 6f72  um()>0]..    for
+00090770: 2065 6163 685f 6e75 6d20 696e 206e 756c   each_num in nul
+00090780: 6c5f 7661 7273 3a0d 0a20 2020 2020 2020  l_vars:..       
+00090790: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+000907a0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+000907b0: 6f72 6b73 2061 7420 7468 6520 6461 7461  orks at the data
+000907c0: 6672 616d 6520 6c65 7665 6c21 0d0a 2020  frame level!..  
+000907d0: 2020 2020 2020 6466 5b5b 6561 6368 5f6e        df[[each_n
+000907e0: 756d 5d5d 203d 2064 665b 5b65 6163 685f  um]] = df[[each_
+000907f0: 6e75 6d5d 5d2e 6669 6c6c 6e61 2830 290d  num]].fillna(0).
+00090800: 0a20 2020 2074 6172 6765 7420 3d20 636f  .    target = co
+00090810: 7079 2e64 6565 7063 6f70 7928 7461 7267  py.deepcopy(targ
+00090820: 6574 290d 0a0d 0a20 2020 2070 7269 6e74  et)....    print
+00090830: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+00090840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090880: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+00090890: 2070 7269 6e74 2827 2323 2323 2320 2053   print('#####  S
+000908a0: 554c 4f56 3a20 2053 6561 7263 6869 6e67  ULOV:  Searching
+000908b0: 2066 6f72 2055 6e63 6f72 7265 6c61 7465   for Uncorrelate
+000908c0: 6420 4c69 7374 204f 6620 5661 7269 6162  d List Of Variab
+000908d0: 6c65 7320 696e 2025 7320 6665 6174 7572  les in %s featur
+000908e0: 6573 2023 2323 2323 2323 2323 2323 2327  es ############'
+000908f0: 2025 6c65 6e28 6e75 6d76 6172 7329 290d   %len(numvars)).
+00090900: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
+00090910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090930: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00090960: 2323 2327 290d 0a20 2020 2023 2323 2054  ###')..    ### T
+00090970: 6869 7320 6973 2061 2073 686f 7274 6572  his is a shorter
+00090980: 2076 6572 7369 6f6e 206f 6620 6765 7474   version of gett
+00090990: 696e 6720 756e 6475 706c 6963 6174 6564  ing unduplicated
+000909a0: 2061 6e64 2068 6967 686c 7920 636f 7272   and highly corr
+000909b0: 656c 6174 6564 2076 6172 7320 2323 0d0a  elated vars ##..
+000909c0: 2020 2020 636f 7272 656c 6174 696f 6e5f      correlation_
+000909d0: 6461 7461 6672 616d 6520 3d20 6466 2e63  dataframe = df.c
+000909e0: 6f72 7228 292e 6162 7328 292e 756e 7374  orr().abs().unst
+000909f0: 6163 6b28 292e 736f 7274 5f76 616c 7565  ack().sort_value
+00090a00: 7328 292e 6472 6f70 5f64 7570 6c69 6361  s().drop_duplica
+00090a10: 7465 7328 290d 0a20 2020 2063 6f72 7264  tes()..    corrd
+00090a20: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+00090a30: 2863 6f72 7265 6c61 7469 6f6e 5f64 6174  (correlation_dat
+00090a40: 6166 7261 6d65 5b3a 5d2e 7265 7365 745f  aframe[:].reset_
+00090a50: 696e 6465 7828 2929 0d0a 2020 2020 636f  index())..    co
+00090a60: 7272 6466 2e63 6f6c 756d 6e73 203d 205b  rrdf.columns = [
+00090a70: 2776 6172 3127 2c27 7661 7232 272c 2763  'var1','var2','c
+00090a80: 6f65 6666 275d 0d0a 2020 2020 636f 7272  oeff']..    corr
+00090a90: 6466 3120 3d20 636f 7272 6466 5b63 6f72  df1 = corrdf[cor
+00090aa0: 7264 665b 2763 6f65 6666 275d 3e3d 636f  rdf['coeff']>=co
+00090ab0: 7272 5f6c 696d 6974 5d0d 0a20 2020 2063  rr_limit]..    c
+00090ac0: 6f72 7265 6c61 7465 645f 7061 6972 203d  orrelated_pair =
+00090ad0: 206c 6973 7428 7a69 7028 636f 7272 6466   list(zip(corrdf
+00090ae0: 315b 2776 6172 3127 5d2e 7661 6c75 6573  1['var1'].values
+00090af0: 2e74 6f6c 6973 7428 292c 636f 7272 6466  .tolist(),corrdf
+00090b00: 315b 2776 6172 3227 5d2e 7661 6c75 6573  1['var2'].values
+00090b10: 2e74 6f6c 6973 7428 2929 290d 0a20 2020  .tolist()))..   
+00090b20: 2063 6f72 725f 7061 6972 5f64 6963 7420   corr_pair_dict 
+00090b30: 3d20 6469 6374 2872 6574 7572 6e5f 6469  = dict(return_di
+00090b40: 6374 696f 6e61 7279 5f6c 6973 7428 636f  ctionary_list(co
+00090b50: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
+00090b60: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
+00090b70: 2066 696e 645f 7265 6d6f 7665 5f64 7570   find_remove_dup
+00090b80: 6c69 6361 7465 7328 636f 7272 6466 315b  licates(corrdf1[
+00090b90: 2776 6172 3127 5d2e 7661 6c75 6573 2e74  'var1'].values.t
+00090ba0: 6f6c 6973 7428 292b 636f 7272 6466 315b  olist()+corrdf1[
+00090bb0: 2776 6172 3227 5d2e 7661 6c75 6573 2e74  'var2'].values.t
+00090bc0: 6f6c 6973 7428 2929 0d0a 2020 2020 6b65  olist())..    ke
+00090bd0: 7973 5f69 6e5f 6469 6374 203d 206c 6973  ys_in_dict = lis
+00090be0: 7428 636f 7272 5f70 6169 725f 6469 6374  t(corr_pair_dict
+00090bf0: 2e6b 6579 7328 2929 0d0a 2020 2020 7265  .keys())..    re
+00090c00: 7665 7273 655f 636f 7272 656c 6174 6564  verse_correlated
+00090c10: 5f70 6169 7220 3d20 5b28 792c 7829 2066  _pair = [(y,x) f
+00090c20: 6f72 2028 782c 7929 2069 6e20 636f 7272  or (x,y) in corr
+00090c30: 656c 6174 6564 5f70 6169 725d 0d0a 2020  elated_pair]..  
+00090c40: 2020 7265 7665 7273 655f 636f 7272 5f70    reverse_corr_p
+00090c50: 6169 725f 6469 6374 203d 2064 6963 7428  air_dict = dict(
+00090c60: 7265 7475 726e 5f64 6963 7469 6f6e 6172  return_dictionar
+00090c70: 795f 6c69 7374 2872 6576 6572 7365 5f63  y_list(reverse_c
+00090c80: 6f72 7265 6c61 7465 645f 7061 6972 2929  orrelated_pair))
+00090c90: 0d0a 2020 2020 2323 2323 2063 6f72 725f  ..    #### corr_
+00090ca0: 7061 6972 5f64 6963 7420 6973 2075 7365  pair_dict is use
+00090cb0: 6420 6c61 7465 7220 746f 206d 616b 6520  d later to make 
+00090cc0: 7468 6520 6e65 7477 6f72 6b20 6469 6167  the network diag
+00090cd0: 7261 6d20 746f 2073 6565 2077 6869 6368  ram to see which
+00090ce0: 2076 6172 7320 6172 6520 636f 7272 656c   vars are correl
+00090cf0: 6174 6564 2074 6f20 7768 6963 680d 0a20  ated to which.. 
+00090d00: 2020 2066 6f72 206b 6579 2c20 7661 6c20     for key, val 
+00090d10: 696e 2072 6576 6572 7365 5f63 6f72 725f  in reverse_corr_
+00090d20: 7061 6972 5f64 6963 742e 6974 656d 7328  pair_dict.items(
+00090d30: 293a 0d0a 2020 2020 2020 2020 6966 206b  ):..        if k
+00090d40: 6579 2069 6e20 6b65 7973 5f69 6e5f 6469  ey in keys_in_di
+00090d50: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
+00090d60: 2069 6620 6c65 6e28 6b65 7929 203e 2031   if len(key) > 1
+00090d70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00090d80: 2020 2063 6f72 725f 7061 6972 5f64 6963     corr_pair_dic
+00090d90: 745b 6b65 795d 202b 3d20 7661 6c0d 0a20  t[key] += val.. 
+00090da0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00090db0: 2020 2020 2020 2020 2020 636f 7272 5f70            corr_p
+00090dc0: 6169 725f 6469 6374 5b6b 6579 5d20 3d20  air_dict[key] = 
+00090dd0: 7661 6c0d 0a0d 0a20 2020 2023 2323 2323  val....    #####
+00090de0: 2320 5468 6973 2069 7320 666f 7220 6f72  # This is for or
+00090df0: 6465 7269 6e67 2074 6865 2076 6172 6961  dering the varia
+00090e00: 626c 6573 2069 6e20 7468 6520 6869 6768  bles in the high
+00090e10: 6573 7420 746f 206c 6f77 6573 7420 696d  est to lowest im
+00090e20: 706f 7274 616e 6365 2074 6f20 7461 7267  portance to targ
+00090e30: 6574 2023 2323 0d0a 2020 2020 6966 206c  et ###..    if l
+00090e40: 656e 2863 6f72 725f 6c69 7374 2920 3d3d  en(corr_list) ==
+00090e50: 2030 3a0d 0a20 2020 2020 2020 2066 696e   0:..        fin
+00090e60: 616c 5f6c 6973 7420 3d20 6c69 7374 2863  al_list = list(c
+00090e70: 6f72 7265 6c61 7469 6f6e 5f64 6174 6166  orrelation_dataf
+00090e80: 7261 6d65 290d 0a20 2020 2020 2020 2070  rame)..        p
+00090e90: 7269 6e74 2827 5365 6c65 6374 696e 6720  rint('Selecting 
+00090ea0: 616c 6c20 2825 6429 2076 6172 6961 626c  all (%d) variabl
+00090eb0: 6573 2073 696e 6365 206e 6f6e 6520 6f66  es since none of
+00090ec0: 206e 756d 6572 6963 2076 6172 7320 6172   numeric vars ar
+00090ed0: 6520 6869 6768 6c79 2063 6f72 7265 6c61  e highly correla
+00090ee0: 7465 642e 2e2e 2720 256c 656e 286e 756d  ted...' %len(num
+00090ef0: 7661 7273 2929 0d0a 2020 2020 2020 2020  vars))..        
+00090f00: 7265 7475 726e 206e 756d 7661 7273 0d0a  return numvars..
+00090f10: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00090f20: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00090f30: 2874 6172 6765 742c 206c 6973 7429 3a0d  (target, list):.
+00090f40: 0a20 2020 2020 2020 2020 2020 2074 6172  .            tar
+00090f50: 6765 7420 3d20 7461 7267 6574 5b30 5d0d  get = target[0].
+00090f60: 0a20 2020 2020 2020 206d 6178 5f66 6561  .        max_fea
+00090f70: 7473 203d 206c 656e 2863 6f72 725f 6c69  ts = len(corr_li
+00090f80: 7374 290d 0a20 2020 2020 2020 2069 6620  st)..        if 
+00090f90: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+00090fa0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+00090fb0: 2020 2020 2020 2020 7365 6c5f 6675 6e63          sel_func
+00090fc0: 7469 6f6e 203d 206d 7574 7561 6c5f 696e  tion = mutual_in
+00090fd0: 666f 5f72 6567 7265 7373 696f 6e0d 0a20  fo_regression.. 
+00090fe0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+00090ff0: 5365 6c65 6374 4b42 6573 7428 7363 6f72  SelectKBest(scor
+00091000: 655f 6675 6e63 3d73 656c 5f66 756e 6374  e_func=sel_funct
+00091010: 696f 6e2c 206b 3d6d 6178 5f66 6561 7473  ion, k=max_feats
+00091020: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00091030: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00091040: 6c5f 6675 6e63 7469 6f6e 203d 206d 7574  l_function = mut
+00091050: 7561 6c5f 696e 666f 5f63 6c61 7373 6966  ual_info_classif
+00091060: 0d0a 2020 2020 2020 2020 2020 2020 6673  ..            fs
+00091070: 203d 2053 656c 6563 744b 4265 7374 2873   = SelectKBest(s
+00091080: 636f 7265 5f66 756e 633d 7365 6c5f 6675  core_func=sel_fu
+00091090: 6e63 7469 6f6e 2c20 6b3d 6d61 785f 6665  nction, k=max_fe
+000910a0: 6174 7329 0d0a 2020 2020 2020 2020 2323  ats)..        ##
+000910b0: 2323 2320 796f 7520 6d75 7374 2065 6e73  ### you must ens
+000910c0: 7572 6520 7468 6572 6520 6172 6520 6e6f  ure there are no
+000910d0: 2069 6e66 696e 6974 6520 6e6f 7220 6e75   infinite nor nu
+000910e0: 6c6c 2076 616c 7565 7320 696e 2063 6f72  ll values in cor
+000910f0: 725f 6c69 7374 2064 6620 2323 0d0a 2020  r_list df ##..  
+00091100: 2020 2020 2020 6466 5f66 6974 203d 2064        df_fit = d
+00091110: 665b 636f 7272 5f6c 6973 745d 0d0a 2020  f[corr_list]..  
+00091120: 2020 2020 2020 2323 2320 4e6f 7720 6368        ### Now ch
+00091130: 6563 6b20 6966 2074 6865 7265 2061 7265  eck if there are
+00091140: 2061 6e79 204e 614e 2076 616c 7565 7320   any NaN values 
+00091150: 696e 2074 6865 2064 6174 6173 6574 2023  in the dataset #
+00091160: 2323 2323 0d0a 2020 2020 2020 2020 0d0a  ####..        ..
+00091170: 2020 2020 2020 2020 6966 2064 665f 6669          if df_fi
+00091180: 742e 6973 6e75 6c6c 2829 2e73 756d 2829  t.isnull().sum()
+00091190: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+000911a0: 2020 2020 2020 2020 2064 665f 6669 7420           df_fit 
+000911b0: 3d20 6466 5f66 6974 2e64 726f 706e 6128  = df_fit.dropna(
+000911c0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000911d0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+000911e0: 696e 7428 2720 2020 2074 6865 7265 2061  int('    there a
+000911f0: 7265 206e 6f20 6e75 6c6c 2076 616c 7565  re no null value
+00091200: 7320 696e 2064 6174 6173 6574 2e2e 2e27  s in dataset...'
+00091210: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
+00091220: 2052 6564 7563 6520 6d65 6d6f 7279 2075   Reduce memory u
+00091230: 7361 6765 2061 6e64 2066 696e 6420 6d75  sage and find mu
+00091240: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
+00091250: 2073 636f 7265 2023 2323 2320 2020 2020   score ####     
+00091260: 2020 0d0a 2020 2020 2020 2020 2374 7279    ..        #try
+00091270: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00091280: 6466 5f66 6974 203d 2072 6564 7563 655f  df_fit = reduce_
+00091290: 6d65 6d5f 7573 6167 6528 6466 5f66 6974  mem_usage(df_fit
+000912a0: 290d 0a20 2020 2020 2020 2023 6578 6365  )..        #exce
+000912b0: 7074 3a0d 0a20 2020 2020 2020 2023 2020  pt:..        #  
+000912c0: 2020 7072 696e 7428 2752 6564 7563 6520    print('Reduce 
+000912d0: 6d65 6d6f 7279 2065 7272 6f72 696e 672e  memory erroring.
+000912e0: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
+000912f0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
+00091300: 5265 6164 7920 746f 2070 6572 666f 726d  Ready to perform
+00091310: 2066 6974 2061 6e64 2066 696e 6420 6d75   fit and find mu
+00091320: 7475 616c 2069 6e66 6f72 6d61 7469 6f6e  tual information
+00091330: 2073 636f 7265 2023 2323 230d 0a20 2020   score ####..   
+00091340: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00091350: 2020 2020 2020 2066 732e 6669 7428 6466         fs.fit(df
+00091360: 5f66 6974 2c20 6466 5f74 6172 6765 7429  _fit, df_target)
+00091370: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00091380: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00091390: 7269 6e74 2827 2020 2020 5365 6c65 6374  rint('    Select
+000913a0: 4b42 6573 7428 2920 6675 6e63 7469 6f6e  KBest() function
+000913b0: 2069 7320 6572 726f 7269 6e67 2e20 5265   is erroring. Re
+000913c0: 7475 726e 696e 6720 7769 7468 2061 6c6c  turning with all
+000913d0: 2025 7320 7661 7269 6162 6c65 732e 2e2e   %s variables...
+000913e0: 2720 256c 656e 286e 756d 7661 7273 2929  ' %len(numvars))
+000913f0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00091400: 7475 726e 206e 756d 7661 7273 0d0a 2020  turn numvars..  
+00091410: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00091420: 2020 2020 2020 2020 2323 2323 2323 2323          ########
+00091430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091470: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00091480: 2020 2020 2020 2023 2323 2323 2323 2020         #######  
+00091490: 2054 6869 7320 6973 2074 6865 206d 6169   This is the mai
+000914a0: 6e20 7365 6374 696f 6e20 7768 6572 6520  n section where 
+000914b0: 7765 2075 7365 206d 7574 7561 6c20 696e  we use mutual in
+000914c0: 666f 2073 636f 7265 2074 6f20 7365 6c65  fo score to sele
+000914d0: 6374 2076 6172 7320 2020 2020 2020 200d  ct vars        .
+000914e0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+000914f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00091530: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00091540: 2020 2020 2020 2020 2020 2020 6d75 7475              mutu
+00091550: 616c 5f69 6e66 6f20 3d20 6469 6374 287a  al_info = dict(z
+00091560: 6970 2863 6f72 725f 6c69 7374 2c66 732e  ip(corr_list,fs.
+00091570: 7363 6f72 6573 5f29 290d 0a20 2020 2020  scores_))..     
+00091580: 2020 2020 2020 2023 2323 2320 5468 6520         #### The 
+00091590: 6669 7273 7420 7661 7269 6162 6c65 2069  first variable i
+000915a0: 6e20 6c69 7374 2068 6173 2074 6865 2068  n list has the h
+000915b0: 6967 6865 7374 2063 6f72 7265 6c61 7469  ighest correlati
+000915c0: 6f6e 2074 6f20 7468 6520 7461 7267 6574  on to the target
+000915d0: 2076 6172 6961 626c 6520 2323 230d 0a20   variable ###.. 
+000915e0: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+000915f0: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
+00091600: 203d 5b6b 6579 2066 6f72 2028 6b65 792c   =[key for (key,
+00091610: 7661 6c29 2069 6e20 736f 7274 6564 286d  val) in sorted(m
+00091620: 7574 7561 6c5f 696e 666f 2e69 7465 6d73  utual_info.items
+00091630: 2829 2c20 6b65 793d 6c61 6d62 6461 206b  (), key=lambda k
+00091640: 763a 206b 765b 315d 2c72 6576 6572 7365  v: kv[1],reverse
+00091650: 3d54 7275 6529 5d0d 0a20 2020 2020 2020  =True)]..       
+00091660: 2020 2020 2023 2323 2323 2020 204e 6f77       #####   Now
+00091670: 2077 6520 7365 6c65 6374 2074 6865 2066   we select the f
+00091680: 696e 616c 206c 6973 7420 6f66 2063 6f72  inal list of cor
+00091690: 7265 6c61 7465 6420 7661 7269 6162 6c65  related variable
+000916a0: 7320 2323 2323 2323 2323 2323 230d 0a20  s ###########.. 
+000916b0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+000916c0: 7465 645f 636f 7272 5f6c 6973 7420 3d20  ted_corr_list = 
+000916d0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+000916e0: 2323 2323 2059 6f75 2068 6176 6520 746f  #### You have to
+000916f0: 206d 616b 6520 6d75 6c74 6970 6c65 2063   make multiple c
+00091700: 6f70 6965 7320 6f66 2074 6869 7320 736f  opies of this so
+00091710: 7274 6564 206c 6973 7420 7369 6e63 6520  rted list since 
+00091720: 6974 2069 7320 6974 6572 6174 6564 206d  it is iterated m
+00091730: 616e 7920 7469 6d65 7320 2323 2323 0d0a  any times ####..
+00091740: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
+00091750: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
+00091760: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
+00091770: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
+00091780: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+00091790: 5f73 6f72 7465 6420 3d20 636f 7079 2e64  _sorted = copy.d
+000917a0: 6565 7063 6f70 7928 736f 7274 6564 5f62  eepcopy(sorted_b
+000917b0: 795f 6d75 7475 616c 5f69 6e66 6f29 0d0a  y_mutual_info)..
+000917c0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+000917d0: 5f70 6169 7220 3d20 636f 7079 2e64 6565  _pair = copy.dee
+000917e0: 7063 6f70 7928 636f 7272 5f70 6169 725f  pcopy(corr_pair_
+000917f0: 6469 6374 290d 0a20 2020 2020 2020 2020  dict)..         
+00091800: 2020 2023 2323 2320 7365 6c65 6374 2065     #### select e
+00091810: 6163 6820 7661 7269 6162 6c65 2062 7920  ach variable by 
+00091820: 7468 6520 6869 6768 6573 7420 6d75 7475  the highest mutu
+00091830: 616c 2069 6e66 6f20 616e 6420 7365 6520  al info and see 
+00091840: 7768 6174 2076 6172 7320 6172 6520 636f  what vars are co
+00091850: 7272 656c 6174 6564 2074 6f20 6974 0d0a  rrelated to it..
+00091860: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00091870: 6561 6368 5f63 6f72 725f 6e61 6d65 2069  each_corr_name i
+00091880: 6e20 636f 7079 5f73 6f72 7465 643a 0d0a  n copy_sorted:..
+00091890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000918a0: 2323 2320 6164 6420 7468 6520 7365 6c65  ### add the sele
+000918b0: 6374 6564 2076 6172 2074 6f20 7468 6520  cted var to the 
+000918c0: 7365 6c65 6374 6564 5f63 6f72 725f 6c69  selected_corr_li
+000918d0: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
+000918e0: 2020 2020 7365 6c65 6374 6564 5f63 6f72      selected_cor
+000918f0: 725f 6c69 7374 2e61 7070 656e 6428 6561  r_list.append(ea
+00091900: 6368 5f63 6f72 725f 6e61 6d65 290d 0a20  ch_corr_name).. 
+00091910: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00091920: 6f72 2065 6163 685f 7265 6d6f 7665 2069  or each_remove i
+00091930: 6e20 636f 7079 5f70 6169 725b 6561 6368  n copy_pair[each
+00091940: 5f63 6f72 725f 6e61 6d65 5d3a 0d0a 2020  _corr_name]:..  
+00091950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091960: 2020 2323 2323 204e 6f77 2072 656d 6f76    #### Now remov
+00091970: 6520 6561 6368 2076 6172 6961 626c 6520  e each variable 
+00091980: 7468 6174 2069 7320 6869 6768 6c79 2063  that is highly c
+00091990: 6f72 7265 6c61 7465 6420 746f 2074 6865  orrelated to the
+000919a0: 2073 656c 6563 7465 6420 7661 7269 6162   selected variab
+000919b0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
+000919c0: 2020 2020 2020 2020 6966 2065 6163 685f          if each_
+000919d0: 7265 6d6f 7665 2069 6e20 636f 7079 5f73  remove in copy_s
+000919e0: 6f72 7465 643a 0d0a 2020 2020 2020 2020  orted:..        
+000919f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091a00: 636f 7079 5f73 6f72 7465 642e 7265 6d6f  copy_sorted.remo
+00091a10: 7665 2865 6163 685f 7265 6d6f 7665 290d  ve(each_remove).
+00091a20: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00091a30: 2323 204e 6f77 2077 6520 636f 6d62 696e  ## Now we combin
+00091a40: 6520 7468 6520 756e 636f 7272 656c 6174  e the uncorrelat
+00091a50: 6564 206c 6973 7420 746f 2074 6865 2073  ed list to the s
+00091a60: 656c 6563 7465 6420 636f 7272 656c 6174  elected correlat
+00091a70: 6564 206c 6973 7420 6162 6f76 650d 0a20  ed list above.. 
+00091a80: 2020 2020 2020 2020 2020 2072 656d 5f63             rem_c
+00091a90: 6f6c 5f6c 6973 7420 3d20 6c65 6674 5f73  ol_list = left_s
+00091aa0: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
+00091ab0: 636f 7272 5f6c 6973 7429 0d0a 2020 2020  corr_list)..    
+00091ac0: 2020 2020 2020 2020 6669 6e61 6c5f 6c69          final_li
+00091ad0: 7374 203d 2072 656d 5f63 6f6c 5f6c 6973  st = rem_col_lis
+00091ae0: 7420 2b20 7365 6c65 6374 6564 5f63 6f72  t + selected_cor
+00091af0: 725f 6c69 7374 0d0a 2020 2020 2020 2020  r_list..        
+00091b00: 2020 2020 7265 6d6f 7665 645f 636f 6c73      removed_cols
+00091b10: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
+00091b20: 286e 756d 7661 7273 2c20 6669 6e61 6c5f  (numvars, final_
+00091b30: 6c69 7374 290d 0a20 2020 2020 2020 2065  list)..        e
+00091b40: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00091b50: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00091b60: 2020 2070 7269 6e74 2827 2020 2020 5355     print('    SU
+00091b70: 4c4f 5620 4d65 7468 6f64 2063 7261 7368  LOV Method crash
+00091b80: 696e 6720 6475 6520 746f 2025 7327 2025  ing due to %s' %
+00091b90: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00091ba0: 2323 2323 2044 726f 7070 696e 6720 6869  #### Dropping hi
+00091bb0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
+00091bc0: 4665 6174 7572 6573 2066 6173 7420 7573  Features fast us
+00091bd0: 696e 6720 7369 6d70 6c65 206c 696e 6561  ing simple linea
+00091be0: 7220 636f 7272 656c 6174 696f 6e20 2323  r correlation ##
+00091bf0: 230d 0a20 2020 2020 2020 2020 2020 2072  #..            r
+00091c00: 656d 6f76 6564 5f63 6f6c 7320 3d20 7265  emoved_cols = re
+00091c10: 6d6f 7665 5f68 6967 686c 795f 636f 7272  move_highly_corr
+00091c20: 656c 6174 6564 5f76 6172 735f 6661 7374  elated_vars_fast
+00091c30: 2864 662c 636f 7272 5f6c 696d 6974 290d  (df,corr_limit).
+00091c40: 0a20 2020 2020 2020 2020 2020 2066 696e  .            fin
+00091c50: 616c 5f6c 6973 7420 3d20 6c65 6674 5f73  al_list = left_s
+00091c60: 7562 7472 6163 7428 6e75 6d76 6172 732c  ubtract(numvars,
+00091c70: 2072 656d 6f76 6564 5f63 6f6c 7329 0d0a   removed_cols)..
+00091c80: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
+00091c90: 656d 6f76 6564 5f63 6f6c 7329 203e 2030  emoved_cols) > 0
+00091ca0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00091cb0: 7269 6e74 2827 2020 2020 5265 6d6f 7669  rint('    Removi
+00091cc0: 6e67 2028 2564 2920 6869 6768 6c79 2063  ng (%d) highly c
+00091cd0: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
+00091ce0: 6c65 733a 2720 2528 6c65 6e28 7265 6d6f  les:' %(len(remo
+00091cf0: 7665 645f 636f 6c73 2929 290d 0a20 2020  ved_cols)))..   
+00091d00: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00091d10: 7265 6d6f 7665 645f 636f 6c73 2920 3c3d  removed_cols) <=
+00091d20: 2033 303a 0d0a 2020 2020 2020 2020 2020   30:..          
+00091d30: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00091d40: 2025 7327 2025 7265 6d6f 7665 645f 636f   %s' %removed_co
+00091d50: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
+00091d60: 2069 6620 6c65 6e28 6669 6e61 6c5f 6c69   if len(final_li
+00091d70: 7374 2920 3c3d 2033 303a 0d0a 2020 2020  st) <= 30:..    
+00091d80: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00091d90: 7428 2720 2020 2046 6f6c 6c6f 7769 6e67  t('    Following
+00091da0: 2028 2564 2920 7661 7273 2073 656c 6563   (%d) vars selec
+00091db0: 7465 643a 2025 7327 2025 286c 656e 2866  ted: %s' %(len(f
+00091dc0: 696e 616c 5f6c 6973 7429 2c66 696e 616c  inal_list),final
+00091dd0: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
+00091de0: 2023 2323 2323 2323 2323 2323 2323 2320   ############## 
+00091df0: 2020 2044 2052 2041 2057 2020 2043 204f     D R A W   C O
+00091e00: 2052 2052 2045 204c 2041 2054 2049 204f   R R E L A T I O
+00091e10: 204e 2020 204e 2045 2054 2057 204f 2052   N   N E T W O R
+00091e20: 204b 2023 2323 2323 2323 2323 2323 2323   K #############
+00091e30: 2323 2323 230d 0a20 2020 2020 2020 2073  #####..        s
+00091e40: 656c 6563 7465 6420 3d20 636f 7079 2e64  elected = copy.d
+00091e50: 6565 7063 6f70 7928 6669 6e61 6c5f 6c69  eepcopy(final_li
+00091e60: 7374 290d 0a20 2020 2020 2020 2074 7279  st)..        try
+00091e70: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00091e80: 6d70 6f72 7420 6e65 7477 6f72 6b78 2061  mport networkx a
+00091e90: 7320 6e78 0d0a 2020 2020 2020 2020 2020  s nx..          
+00091ea0: 2020 2323 2323 204e 6f77 2073 7461 7274    #### Now start
+00091eb0: 2062 7569 6c64 696e 6720 7468 6520 6772   building the gr
+00091ec0: 6170 6820 2323 2323 2323 2323 2323 2323  aph ############
+00091ed0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00091ee0: 2020 2020 2067 6620 3d20 6e78 2e47 7261       gf = nx.Gra
+00091ef0: 7068 2829 0d0a 2020 2020 2020 2020 2020  ph()..          
+00091f00: 2020 2323 2320 7468 6520 6d75 7475 616c    ### the mutual
+00091f10: 2069 6e66 6f20 7363 6f72 6520 6769 7665   info score give
+00091f20: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
+00091f30: 6520 6275 6262 6c65 2023 2323 0d0a 2020  e bubble ###..  
+00091f40: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
+00091f50: 6c69 6572 203d 2032 3130 300d 0a20 2020  lier = 2100..   
+00091f60: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
+00091f70: 6820 696e 206f 7269 675f 736f 7274 6564  h in orig_sorted
+00091f80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00091f90: 2020 2067 662e 6164 645f 6e6f 6465 2865     gf.add_node(e
+00091fa0: 6163 682c 2073 697a 653d 696e 7428 6d61  ach, size=int(ma
+00091fb0: 7828 312c 6d75 7475 616c 5f69 6e66 6f5b  x(1,mutual_info[
+00091fc0: 6561 6368 5d2a 6d75 6c74 6970 6c69 6572  each]*multiplier
+00091fd0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
+00091fe0: 2023 2323 2323 2323 2323 2054 6869 7320   ######### This 
+00091ff0: 6973 2077 6865 7265 2079 6f75 2063 616c  is where you cal
+00092000: 6375 6c61 7465 2074 6865 2073 697a 6520  culate the size 
+00092010: 6f66 2065 6163 6820 6e6f 6465 2074 6f20  of each node to 
+00092020: 6472 6177 0d0a 2020 2020 2020 2020 2020  draw..          
+00092030: 2020 7369 7a65 7320 3d20 5b6d 7574 7561    sizes = [mutua
+00092040: 6c5f 696e 666f 5b78 5d2a 6d75 6c74 6970  l_info[x]*multip
+00092050: 6c69 6572 2066 6f72 2078 2069 6e20 6c69  lier for x in li
+00092060: 7374 2867 662e 6e6f 6465 7328 2929 5d0d  st(gf.nodes())].
+00092070: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00092080: 2320 2054 6865 2073 697a 6573 206f 6620  #  The sizes of 
+00092090: 7468 6520 6275 6262 6c65 7320 666f 7220  the bubbles for 
+000920a0: 6561 6368 206e 6f64 6520 6973 2064 6574  each node is det
+000920b0: 6572 6d69 6e65 6420 6279 2069 7473 206d  ermined by its m
+000920c0: 7574 7561 6c20 696e 666f 726d 6174 696f  utual informatio
+000920d0: 6e20 7363 6f72 6520 7661 6c75 650d 0a20  n score value.. 
+000920e0: 2020 2020 2020 2020 2020 2063 6f72 7220             corr 
+000920f0: 3d20 6466 5f66 6974 2e63 6f72 7228 290d  = df_fit.corr().
+00092100: 0a20 2020 2020 2020 2020 2020 2068 6967  .            hig
+00092110: 685f 636f 7272 203d 2063 6f72 725b 6162  h_corr = corr[ab
+00092120: 7328 636f 7272 293e 636f 7272 5f6c 696d  s(corr)>corr_lim
+00092130: 6974 5d0d 0a20 2020 2020 2020 2020 2020  it]..           
+00092140: 2023 2320 6869 6768 5f63 6f72 7220 6973   ## high_corr is
+00092150: 2074 6865 2064 6174 6166 7261 6d65 206f   the dataframe o
+00092160: 6620 6120 6665 7720 7661 7269 6162 6c65  f a few variable
+00092170: 7320 7468 6174 2061 7265 2068 6967 686c  s that are highl
+00092180: 7920 636f 7272 656c 6174 6564 2074 6f20  y correlated to 
+00092190: 6561 6368 206f 7468 6572 0d0a 2020 2020  each other..    
+000921a0: 2020 2020 2020 2020 636f 6d62 6f73 203d          combos =
+000921b0: 2063 6f6d 6269 6e61 7469 6f6e 7328 636f   combinations(co
+000921c0: 7272 5f6c 6973 742c 3229 0d0a 2020 2020  rr_list,2)..    
+000921d0: 2020 2020 2020 2020 2323 2320 7468 6973          ### this
+000921e0: 2067 6976 6573 2074 6865 2073 7472 656e   gives the stren
+000921f0: 6774 6820 6f66 2063 6f72 7265 6c61 7469  gth of correlati
+00092200: 6f6e 2062 6574 7765 656e 2032 206e 6f64  on between 2 nod
+00092210: 6573 2023 230d 0a20 2020 2020 2020 2020  es ##..         
+00092220: 2020 206d 756c 7469 706c 6965 7220 3d20     multiplier = 
+00092230: 3230 0d0a 2020 2020 2020 2020 2020 2020  20..            
+00092240: 666f 7220 2876 6172 312c 2076 6172 3229  for (var1, var2)
+00092250: 2069 6e20 636f 6d62 6f73 3a0d 0a20 2020   in combos:..   
+00092260: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00092270: 6e70 2e69 736e 616e 2868 6967 685f 636f  np.isnan(high_co
+00092280: 7272 2e6c 6f63 5b76 6172 312c 7661 7232  rr.loc[var1,var2
+00092290: 5d29 3a0d 0a20 2020 2020 2020 2020 2020  ]):..           
+000922a0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+000922b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000922c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000922d0: 2020 2020 2020 2020 2020 6766 2e61 6464            gf.add
+000922e0: 5f65 6467 6528 7661 7231 2c20 7661 7232  _edge(var1, var2
+000922f0: 2c77 6569 6768 743d 6d75 6c74 6970 6c69  ,weight=multipli
+00092300: 6572 2a68 6967 685f 636f 7272 2e6c 6f63  er*high_corr.loc
+00092310: 5b76 6172 312c 7661 7232 5d29 0d0a 2020  [var1,var2])..  
+00092320: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00092330: 2323 204e 6f77 2073 7461 7274 2062 7569  ## Now start bui
+00092340: 6c64 696e 6720 7468 6520 6e65 7477 6f72  lding the networ
+00092350: 6b78 2067 7261 7068 2023 2323 2323 2323  kx graph #######
+00092360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092370: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+00092380: 2077 6964 7468 7320 3d20 6e78 2e67 6574   widths = nx.get
+00092390: 5f65 6467 655f 6174 7472 6962 7574 6573  _edge_attributes
+000923a0: 2867 662c 2027 7765 6967 6874 2729 0d0a  (gf, 'weight')..
+000923b0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
+000923c0: 6c69 7374 203d 2067 662e 6e6f 6465 7328  list = gf.nodes(
+000923d0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+000923e0: 6f6c 7320 3d20 350d 0a20 2020 2020 2020  ols = 5..       
+000923f0: 2020 2020 2068 6569 6768 745f 7369 7a65       height_size
+00092400: 203d 2035 0d0a 2020 2020 2020 2020 2020   = 5..          
+00092410: 2020 7769 6474 685f 7369 7a65 203d 2031    width_size = 1
+00092420: 350d 0a20 2020 2020 2020 2020 2020 2072  5..            r
+00092430: 6f77 7320 3d20 696e 7428 6c65 6e28 636f  ows = int(len(co
+00092440: 7272 5f6c 6973 7429 2f63 6f6c 7329 0d0a  rr_list)/cols)..
+00092450: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+00092460: 6f77 7320 3c20 313a 0d0a 2020 2020 2020  ows < 1:..      
+00092470: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
+00092480: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+00092490: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+000924a0: 7a65 3d28 7769 6474 685f 7369 7a65 2c6d  ze=(width_size,m
+000924b0: 696e 2832 302c 6865 6967 6874 5f73 697a  in(20,height_siz
+000924c0: 652a 726f 7773 2929 290d 0a20 2020 2020  e*rows)))..     
+000924d0: 2020 2020 2020 2070 6f73 203d 206e 782e         pos = nx.
+000924e0: 7368 656c 6c5f 6c61 796f 7574 2867 6629  shell_layout(gf)
+000924f0: 0d0a 2020 2020 2020 2020 2020 2020 6e78  ..            nx
+00092500: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6e  .draw_networkx_n
+00092510: 6f64 6573 2867 662c 706f 732c 0d0a 2020  odes(gf,pos,..  
+00092520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092540: 206e 6f64 656c 6973 743d 6e6f 6465 6c69   nodelist=nodeli
+00092550: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
+00092560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092570: 2020 2020 2020 2020 6e6f 6465 5f73 697a          node_siz
+00092580: 653d 7369 7a65 732c 0d0a 2020 2020 2020  e=sizes,..      
+00092590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000925a0: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
+000925b0: 655f 636f 6c6f 723d 2762 6c75 6527 2c0d  e_color='blue',.
+000925c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000925d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000925e0: 2020 2020 616c 7068 613d 302e 3529 0d0a      alpha=0.5)..
+000925f0: 2020 2020 2020 2020 2020 2020 6e78 2e64              nx.d
+00092600: 7261 775f 6e65 7477 6f72 6b78 5f65 6467  raw_networkx_edg
+00092610: 6573 2867 662c 706f 732c 0d0a 2020 2020  es(gf,pos,..    
+00092620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092630: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00092640: 6467 656c 6973 7420 3d20 7769 6474 6873  dgelist = widths
+00092650: 2e6b 6579 7328 292c 0d0a 2020 2020 2020  .keys(),..      
+00092660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092670: 2020 2020 2020 2020 2020 2020 2077 6964               wid
+00092680: 7468 3d6c 6973 7428 7769 6474 6873 2e76  th=list(widths.v
+00092690: 616c 7565 7328 2929 2c0d 0a20 2020 2020  alues()),..     
+000926a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000926b0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+000926c0: 6765 5f63 6f6c 6f72 3d27 6c69 6768 7462  ge_color='lightb
+000926d0: 6c75 6527 2c0d 0a20 2020 2020 2020 2020  lue',..         
+000926e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000926f0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
+00092700: 302e 3629 0d0a 2020 2020 2020 2020 2020  0.6)..          
+00092710: 2020 706f 735f 6869 6768 6572 203d 207b    pos_higher = {
+00092720: 7d0d 0a20 2020 2020 2020 2020 2020 2078  }..            x
+00092730: 5f6f 6666 203d 2030 2e30 3420 2023 206f  _off = 0.04  # o
+00092740: 6666 7365 7420 6f6e 2074 6865 2078 2061  ffset on the x a
+00092750: 7869 730d 0a20 2020 2020 2020 2020 2020  xis..           
+00092760: 2079 5f6f 6666 203d 2030 2e30 3420 2023   y_off = 0.04  #
+00092770: 206f 6666 7365 7420 6f6e 2074 6865 2079   offset on the y
+00092780: 2061 7869 730d 0a20 2020 2020 2020 2020   axis..         
+00092790: 2020 2066 6f72 206b 2c20 7620 696e 2070     for k, v in p
+000927a0: 6f73 2e69 7465 6d73 2829 3a0d 0a20 2020  os.items():..   
+000927b0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+000927c0: 5f68 6967 6865 725b 6b5d 203d 2028 765b  _higher[k] = (v[
+000927d0: 305d 2b78 5f6f 6666 2c20 765b 315d 2b79  0]+x_off, v[1]+y
+000927e0: 5f6f 6666 290d 0a20 2020 2020 2020 2020  _off)..         
+000927f0: 2020 2069 6620 6c65 6e28 7365 6c65 6374     if len(select
+00092800: 6564 2920 3d3d 2030 3a0d 0a20 2020 2020  ed) == 0:..     
+00092810: 2020 2020 2020 2020 2020 206e 782e 6472             nx.dr
+00092820: 6177 5f6e 6574 776f 726b 785f 6c61 6265  aw_networkx_labe
+00092830: 6c73 2867 662c 2070 6f73 3d70 6f73 5f68  ls(gf, pos=pos_h
+00092840: 6967 6865 722c 0d0a 2020 2020 2020 2020  igher,..        
+00092850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092860: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+00092870: 6c73 3d64 6963 7428 7a69 7028 6e6f 6465  ls=dict(zip(node
+00092880: 6c69 7374 2c6e 6f64 656c 6973 7429 292c  list,nodelist)),
+00092890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000928a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000928b0: 2020 2020 2020 666f 6e74 5f63 6f6c 6f72        font_color
+000928c0: 3d27 626c 6163 6b27 290d 0a20 2020 2020  ='black')..     
+000928d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000928e0: 2020 2020 2020 2020 2020 2020 2020 6e78                nx
+000928f0: 2e64 7261 775f 6e65 7477 6f72 6b78 5f6c  .draw_networkx_l
+00092900: 6162 656c 7328 6766 2c20 706f 733d 706f  abels(gf, pos=po
+00092910: 735f 6869 6768 6572 2c0d 0a20 2020 2020  s_higher,..     
+00092920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092930: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00092940: 6162 656c 7320 3d20 6469 6374 287a 6970  abels = dict(zip
+00092950: 286e 6f64 656c 6973 742c 5b78 2b27 2028  (nodelist,[x+' (
+00092960: 7365 6c65 6374 6564 2927 2069 6620 7820  selected)' if x 
+00092970: 696e 2073 656c 6563 7465 6420 656c 7365  in selected else
+00092980: 2078 2b27 2028 7265 6d6f 7665 6429 2720   x+' (removed)' 
+00092990: 666f 7220 7820 696e 206e 6f64 656c 6973  for x in nodelis
+000929a0: 745d 2929 2c0d 0a20 2020 2020 2020 2020  t])),..         
+000929b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000929c0: 2020 2020 2020 2020 2020 2066 6f6e 745f             font_
+000929d0: 636f 6c6f 723d 2762 6c61 636b 2729 0d0a  color='black')..
+000929e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+000929f0: 626f 7828 5472 7565 290d 0a20 2020 2020  box(True)..     
+00092a00: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
+00092a10: 2822 2222 496e 2053 554c 4f56 2c20 7765  ("""In SULOV, we
+00092a20: 2072 6570 6561 7465 646c 7920 7265 6d6f   repeatedly remo
+00092a30: 7665 2066 6561 7475 7265 7320 7769 7468  ve features with
+00092a40: 206c 6f77 6572 206d 7574 7561 6c20 696e   lower mutual in
+00092a50: 666f 2073 636f 7265 7320 616d 6f6e 6720  fo scores among 
+00092a60: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
+00092a70: 6420 7061 6972 7320 2873 6565 2066 6967  d pairs (see fig
+00092a80: 7572 6529 2c0d 0a20 2020 2020 2020 2020  ure),..         
+00092a90: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00092aa0: 554c 4f56 2073 656c 6563 7473 2074 6865  ULOV selects the
+00092ab0: 2066 6561 7475 7265 2077 6974 6820 6869   feature with hi
+00092ac0: 6768 6572 206d 7574 7561 6c20 696e 666f  gher mutual info
+00092ad0: 2073 636f 7265 2072 656c 6174 6564 2074   score related t
+00092ae0: 6f20 7461 7267 6574 2077 6865 6e20 6368  o target when ch
+00092af0: 6f6f 7369 6e67 2062 6574 7765 656e 2061  oosing between a
+00092b00: 2070 6169 722e 2022 2222 2c20 666f 6e74   pair. """, font
+00092b10: 7369 7a65 3d31 3029 0d0a 2020 2020 2020  size=10)..      
+00092b20: 2020 2020 2020 706c 742e 7375 7074 6974        plt.suptit
+00092b30: 6c65 2827 486f 7720 5355 4c4f 5620 4d65  le('How SULOV Me
+00092b40: 7468 6f64 2057 6f72 6b73 2062 7920 5265  thod Works by Re
+00092b50: 6d6f 7669 6e67 2048 6967 686c 7920 436f  moving Highly Co
+00092b60: 7272 656c 6174 6564 2046 6561 7475 7265  rrelated Feature
+00092b70: 7327 2c20 666f 6e74 7369 7a65 3d32 302c  s', fontsize=20,
+00092b80: 793d 312e 3033 290d 0a20 2020 2020 2020  y=1.03)..       
+00092b90: 2020 2020 2072 6564 5f70 6174 6368 203d       red_patch =
+00092ba0: 206d 7061 7463 6865 732e 5061 7463 6828   mpatches.Patch(
+00092bb0: 636f 6c6f 723d 2762 6c75 6527 2c20 6c61  color='blue', la
+00092bc0: 6265 6c3d 2742 6967 6765 7220 6369 7263  bel='Bigger circ
+00092bd0: 6c65 2064 656e 6f74 6573 2068 6967 6865  le denotes highe
+00092be0: 7220 6d75 7475 616c 2069 6e66 6f20 7363  r mutual info sc
+00092bf0: 6f72 6520 7769 7468 2074 6172 6765 7427  ore with target'
+00092c00: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
+00092c10: 6c75 655f 7061 7463 6820 3d20 6d70 6174  lue_patch = mpat
+00092c20: 6368 6573 2e50 6174 6368 2863 6f6c 6f72  ches.Patch(color
+00092c30: 3d27 6c69 6768 7462 6c75 6527 2c20 6c61  ='lightblue', la
+00092c40: 6265 6c3d 2754 6869 636b 6572 206c 696e  bel='Thicker lin
+00092c50: 6520 6465 6e6f 7465 7320 6869 6768 6572  e denotes higher
+00092c60: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
+00092c70: 7765 656e 2074 776f 2076 6172 6961 626c  ween two variabl
+00092c80: 6573 2729 0d0a 2020 2020 2020 2020 2020  es')..          
+00092c90: 2020 706c 742e 6c65 6765 6e64 2868 616e    plt.legend(han
+00092ca0: 646c 6573 3d5b 7265 645f 7061 7463 682c  dles=[red_patch,
+00092cb0: 2062 6c75 655f 7061 7463 685d 2c6c 6f63   blue_patch],loc
+00092cc0: 3d27 6265 7374 2729 0d0a 2020 2020 2020  ='best')..      
+00092cd0: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
+00092ce0: 3b0d 0a20 2020 2020 2020 2020 2020 2023  ;..            #
+00092cf0: 2323 2323 2020 2020 4e20 4520 5420 5720  ####    N E T W 
+00092d00: 4f20 5220 4b20 2020 2020 4420 4920 4120  O R K     D I A 
+00092d10: 4720 5220 4120 4d20 2020 2043 204f 204d  G R A M    C O M
+00092d20: 2050 204c 2045 2054 2045 2020 2023 2323   P L E T E   ###
+00092d30: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00092d40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00092d50: 726e 2066 696e 616c 5f6c 6973 742b 7265  rn final_list+re
+00092d60: 6d76 6172 730d 0a20 2020 2020 2020 2065  mvars..        e
+00092d70: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00092d80: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00092d90: 2020 2070 7269 6e74 2827 2020 2020 4e65     print('    Ne
+00092da0: 7477 6f72 6b78 206c 6962 7261 7279 2076  tworkx library v
+00092db0: 6973 7561 6c69 7a61 7469 6f6e 2063 7261  isualization cra
+00092dc0: 7368 696e 6720 6475 6520 746f 2025 7327  shing due to %s'
+00092dd0: 2025 6529 0d0a 2020 2020 2020 2020 2020   %e)..          
+00092de0: 2020 7072 696e 7428 2743 6f6e 7469 6e75    print('Continu
+00092df0: 696e 6720 7769 7468 2053 554c 4f56 2e20  ing with SULOV. 
+00092e00: 2564 2066 6561 7475 7265 7320 7365 6c65  %d features sele
+00092e10: 6374 6564 2720 256c 656e 2866 696e 616c  cted' %len(final
+00092e20: 5f6c 6973 7429 290d 0a20 2020 2020 2020  _list))..       
+00092e30: 2020 2020 2072 6574 7572 6e20 6669 6e61       return fina
+00092e40: 6c5f 6c69 7374 2b72 656d 7661 7273 0d0a  l_list+remvars..
+00092e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00092ea0: 2323 230d 0a00 0000 0000 0000 0000 0000  ###.............
 00092eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00092f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00092f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00092f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00092f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00092f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -37634,16 +37634,16 @@
 00093010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00093070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00093080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00093090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00093080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00093090: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
 000930a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000930b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000930c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000930d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000930e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000930f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -37658,16 +37658,16 @@
 00093190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000931f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00093200: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00093210: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
+00093200: 3237 206d 7469 6d65 3d31 3638 3437 3039  27 mtime=1684709
+00093210: 3331 372e 3331 3030 3239 0a00 0000 0000  317.310029......
 00093220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -37690,24 +37690,24 @@
 00093390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000933f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00093400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
+00093400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
 00093410: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00093420: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
+00093420: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
 00093430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00093470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00093480: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
-00093490: 3030 3000 3031 3735 3536 0020 3000 0000  000.017556. 0...
+00093480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00093490: 3030 3000 3031 3634 3435 0020 3500 0000  000.016445. 5...
 000934a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000934b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000934c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000934d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000934e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000934f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00093500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -37722,1883 +37722,1883 @@
 00093590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000935f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00093600: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00093610: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
-00093620: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00093630: 312e 3731 350a 5375 6d6d 6172 793a 2041  1.715.Summary: A
-00093640: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
-00093650: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
-00093660: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
-00093670: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
-00093680: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
-00093690: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
-000936a0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
-000936b0: 694d 4c2f 4175 746f 5f56 694d 4c0a 4175  iML/Auto_ViML.Au
-000936c0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
-000936d0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
-000936e0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
-000936f0: 6573 6372 6970 7469 6f6e 3a20 2320 4175  escription: # Au
-00093700: 746f 2d56 694d 4c0a 2020 2020 2020 2020  to-ViML.        
-00093710: 0a20 2020 2020 2020 2021 5b62 616e 6e65  .        ![banne
-00093720: 725d 286c 6f67 6f2e 706e 6729 3c62 723e  r](logo.png)<br>
-00093730: 0a20 2020 2020 2020 2041 7574 6f6d 6174  .        Automat
-00093740: 6963 616c 6c79 2042 7569 6c64 2056 6172  ically Build Var
-00093750: 696f 7573 2049 6e74 6572 7072 6574 6162  ious Interpretab
-00093760: 6c65 204d 4c20 6d6f 6465 6c73 2066 6173  le ML models fas
-00093770: 7421 3c62 723e 0a20 2020 2020 2020 205b  t!<br>.        [
-00093780: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
-00093790: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
-000937a0: 6164 6765 2f61 7574 6f76 696d 6c2f 7765  adge/autoviml/we
-000937b0: 656b 295d 2868 7474 7073 3a2f 2f70 6570  ek)](https://pep
-000937c0: 792e 7465 6368 2f70 726f 6a65 6374 2f61  y.tech/project/a
-000937d0: 7574 6f76 696d 6c2f 7765 656b 290a 2020  utoviml/week).  
-000937e0: 2020 2020 2020 5b21 5b44 6f77 6e6c 6f61        [![Downloa
-000937f0: 6473 5d28 6874 7470 733a 2f2f 7065 7079  ds](https://pepy
-00093800: 2e74 6563 682f 6261 6467 652f 6175 746f  .tech/badge/auto
-00093810: 7669 6d6c 2f6d 6f6e 7468 295d 2868 7474  viml/month)](htt
-00093820: 7073 3a2f 2f70 6570 792e 7465 6368 2f70  ps://pepy.tech/p
-00093830: 726f 6a65 6374 2f61 7574 6f76 696d 6c2f  roject/autoviml/
-00093840: 6d6f 6e74 6829 0a20 2020 2020 2020 205b  month).        [
-00093850: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
-00093860: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
-00093870: 6164 6765 2f61 7574 6f76 696d 6c29 5d28  adge/autoviml)](
-00093880: 6874 7470 733a 2f2f 7065 7079 2e74 6563  https://pepy.tec
-00093890: 682f 7072 6f6a 6563 742f 6175 746f 7669  h/project/autovi
-000938a0: 6d6c 290a 2020 2020 2020 2020 5b21 5b73  ml).        [![s
-000938b0: 7461 6e64 6172 642d 7265 6164 6d65 2063  tandard-readme c
-000938c0: 6f6d 706c 6961 6e74 5d28 6874 7470 733a  ompliant](https:
-000938d0: 2f2f 696d 672e 7368 6965 6c64 732e 696f  //img.shields.io
-000938e0: 2f62 6164 6765 2f73 7461 6e64 6172 642d  /badge/standard-
-000938f0: 2d72 6561 646d 652d 4f4b 2d67 7265 656e  -readme-OK-green
-00093900: 2e73 7667 3f73 7479 6c65 3d66 6c61 742d  .svg?style=flat-
-00093910: 7371 7561 7265 295d 2868 7474 7073 3a2f  square)](https:/
-00093920: 2f67 6974 6875 622e 636f 6d2f 5269 6368  /github.com/Rich
-00093930: 6172 644c 6974 742f 7374 616e 6461 7264  ardLitt/standard
-00093940: 2d72 6561 646d 6529 0a20 2020 2020 2020  -readme).       
-00093950: 205b 215b 5079 7468 6f6e 2056 6572 7369   [![Python Versi
-00093960: 6f6e 735d 2868 7474 7073 3a2f 2f69 6d67  ons](https://img
-00093970: 2e73 6869 656c 6473 2e69 6f2f 7079 7069  .shields.io/pypi
-00093980: 2f70 7976 6572 7369 6f6e 732f 6175 746f  /pyversions/auto
-00093990: 7669 6d6c 2e73 7667 3f6c 6f67 6f3d 7079  viml.svg?logo=py
-000939a0: 7468 6f6e 266c 6f67 6f43 6f6c 6f72 3d77  thon&logoColor=w
-000939b0: 6869 7465 295d 2868 7474 7073 3a2f 2f70  hite)](https://p
-000939c0: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
-000939d0: 6175 746f 7669 6d6c 290a 2020 2020 2020  autoviml).      
-000939e0: 2020 5b21 5b50 7950 4920 5665 7273 696f    [![PyPI Versio
-000939f0: 6e5d 2868 7474 7073 3a2f 2f69 6d67 2e73  n](https://img.s
-00093a00: 6869 656c 6473 2e69 6f2f 7079 7069 2f76  hields.io/pypi/v
-00093a10: 2f61 7574 6f76 696d 6c2e 7376 673f 6c6f  /autoviml.svg?lo
-00093a20: 676f 3d70 7970 6926 6c6f 676f 436f 6c6f  go=pypi&logoColo
-00093a30: 723d 7768 6974 6529 5d28 6874 7470 733a  r=white)](https:
-00093a40: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
-00093a50: 6374 2f61 7574 6f76 696d 6c29 0a20 2020  ct/autoviml).   
-00093a60: 2020 2020 205b 215b 5079 5049 204c 6963       [![PyPI Lic
-00093a70: 656e 7365 5d28 6874 7470 733a 2f2f 696d  ense](https://im
-00093a80: 672e 7368 6965 6c64 732e 696f 2f70 7970  g.shields.io/pyp
-00093a90: 692f 6c2f 6175 746f 7669 6d6c 2e73 7667  i/l/autoviml.svg
-00093aa0: 295d 2868 7474 7073 3a2f 2f67 6974 6875  )](https://githu
-00093ab0: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-00093ac0: 7574 6f5f 5669 4d4c 2f62 6c6f 622f 6d61  uto_ViML/blob/ma
-00093ad0: 7374 6572 2f4c 4943 454e 5345 290a 2020  ster/LICENSE).  
-00093ae0: 2020 2020 2020 0a20 2020 2020 2020 2041        .        A
-00093af0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
-00093b00: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
-00093b10: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
-00093b20: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
-00093b30: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
-00093b40: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
-00093b50: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
-00093b60: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
-00093b70: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
-00093b80: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
-00093b90: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
-00093ba0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
-00093bb0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
-00093bc0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
-00093bd0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
-00093be0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
-00093bf0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
-00093c00: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
-00093c10: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
-00093c20: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
-00093c30: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
-00093c40: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
-00093c50: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
-00093c60: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
-00093c70: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
-00093c80: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
-00093c90: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
-00093ca0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
-00093cb0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
-00093cc0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
-00093cd0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
-00093ce0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
-00093cf0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
-00093d00: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
-00093d10: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
-00093d20: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
-00093d30: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
-00093d40: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
-00093d50: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
-00093d60: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
-00093d70: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
-00093d80: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
-00093d90: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
-00093da0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
-00093db0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
-00093dc0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
-00093dd0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
-00093de0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
-00093df0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
-00093e00: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
-00093e10: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
-00093e20: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
-00093e30: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
-00093e40: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
-00093e50: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
-00093e60: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
-00093e70: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
-00093e80: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
-00093e90: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
-00093ea0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
-00093eb0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
-00093ec0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
-00093ed0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
-00093ee0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
-00093ef0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
-00093f00: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
-00093f10: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
-00093f20: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
-00093f30: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
-00093f40: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
-00093f50: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
-00093f60: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
-00093f70: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
-00093f80: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
-00093f90: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
-00093fa0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
-00093fb0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
-00093fc0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
-00093fd0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
-00093fe0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
-00093ff0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
-00094000: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
-00094010: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
-00094020: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
-00094030: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
-00094040: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
-00094050: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
-00094060: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
-00094070: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
-00094080: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
-00094090: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
-000940a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
-000940b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
-000940c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
-000940d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
-000940e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
-000940f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
-00094100: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
-00094110: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
-00094120: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
-00094130: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
-00094140: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
-00094150: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
-00094160: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
-00094170: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-00094180: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
-00094190: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
-000941a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
-000941b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
-000941c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-000941d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
-000941e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-000941f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
-00094200: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
-00094210: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
-00094220: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00094230: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
-00094240: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
-00094250: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
-00094260: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-00094270: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
-00094280: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
-00094290: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
-000942a0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
-000942b0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
-000942c0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
-000942d0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
-000942e0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
-000942f0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
-00094300: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
-00094310: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
-00094320: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
-00094330: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
-00094340: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
-00094350: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
-00094360: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
-00094370: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
-00094380: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
-00094390: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
-000943a0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
-000943b0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
-000943c0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
-000943d0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
-000943e0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
-000943f0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
-00094400: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
-00094410: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
-00094420: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
-00094430: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
-00094440: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
-00094450: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
-00094460: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
-00094470: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
-00094480: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
-00094490: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
-000944a0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
-000944b0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
-000944c0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
-000944d0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
-000944e0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
-000944f0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
-00094500: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
-00094510: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
-00094520: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
-00094530: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
-00094540: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
-00094550: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
-00094560: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
-00094570: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
-00094580: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
-00094590: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
-000945a0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
-000945b0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
-000945c0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
-000945d0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
-000945e0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
-000945f0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
-00094600: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
-00094610: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
-00094620: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
-00094630: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
-00094640: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
-00094650: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
-00094660: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
-00094670: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
-00094680: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
-00094690: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
-000946a0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
-000946b0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
-000946c0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
-000946d0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
-000946e0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
-000946f0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
-00094700: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
-00094710: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
-00094720: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
-00094730: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
-00094740: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
-00094750: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
-00094760: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
-00094770: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
-00094780: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
-00094790: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
-000947a0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
-000947b0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
-000947c0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
-000947d0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
-000947e0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
-000947f0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
-00094800: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
-00094810: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
-00094820: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
-00094830: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
-00094840: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
-00094850: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
-00094860: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
-00094870: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
-00094880: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00094890: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
-000948a0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
-000948b0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
-000948c0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
-000948d0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
-000948e0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
-000948f0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
-00094900: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
-00094910: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
-00094920: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
-00094930: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
-00094940: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
-00094950: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
-00094960: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
-00094970: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
-00094980: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
-00094990: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
-000949a0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
-000949b0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
-000949c0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
-000949d0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
-000949e0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
-000949f0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
-00094a00: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
-00094a10: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
-00094a20: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
-00094a30: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
-00094a40: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
-00094a50: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
-00094a60: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
-00094a70: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
-00094a80: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
-00094a90: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
-00094aa0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
-00094ab0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
-00094ac0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
-00094ad0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
-00094ae0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
-00094af0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
-00094b00: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
-00094b10: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
-00094b20: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
-00094b30: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
-00094b40: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
-00094b50: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
-00094b60: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
-00094b70: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
-00094b80: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
-00094b90: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
-00094ba0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
-00094bb0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
-00094bc0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
-00094bd0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
-00094be0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
-00094bf0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
-00094c00: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
-00094c10: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
-00094c20: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
-00094c30: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
-00094c40: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
-00094c50: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
-00094c60: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
-00094c70: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
-00094c80: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
-00094c90: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
-00094ca0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
-00094cb0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
-00094cc0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
-00094cd0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
-00094ce0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
-00094cf0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
-00094d00: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
-00094d10: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
-00094d20: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
-00094d30: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
-00094d40: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
-00094d50: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
-00094d60: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
-00094d70: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
-00094d80: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
-00094d90: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
-00094da0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
-00094db0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
-00094dc0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
-00094dd0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
-00094de0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
-00094df0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
-00094e00: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
-00094e10: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
-00094e20: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
-00094e30: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
-00094e40: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
-00094e50: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
-00094e60: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
-00094e70: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
-00094e80: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
-00094e90: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
-00094ea0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
-00094eb0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
-00094ec0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
-00094ed0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
-00094ee0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
-00094ef0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
-00094f00: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
-00094f10: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
-00094f20: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
-00094f30: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-00094f40: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
-00094f50: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
-00094f60: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
-00094f70: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00094f80: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
-00094f90: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
-00094fa0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
-00094fb0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
-00094fc0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
-00094fd0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
-00094fe0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
-00094ff0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
-00095000: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-00095010: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
-00095020: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
-00095030: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
-00095040: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
-00095050: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
-00095060: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
-00095070: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
-00095080: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
-00095090: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
-000950a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
-000950b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
-000950c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
-000950d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
-000950e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
-000950f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
-00095100: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00095110: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
-00095120: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
-00095130: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
-00095140: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
-00095150: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
-00095160: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
-00095170: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
-00095180: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
-00095190: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
-000951a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
-000951b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
-000951c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
-000951d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
-000951e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
-000951f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
-00095200: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
-00095210: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
-00095220: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
-00095230: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
-00095240: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
-00095250: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
-00095260: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
-00095270: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
-00095280: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
-00095290: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
-000952a0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
-000952b0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
-000952c0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
-000952d0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-000952e0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
-000952f0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
-00095300: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
-00095310: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
-00095320: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00095330: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
-00095340: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-00095350: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
-00095360: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00095370: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
-00095380: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00095390: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
-000953a0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-000953b0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
-000953c0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
-000953d0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
-000953e0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
-000953f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00095400: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
-00095410: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00095420: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
-00095430: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00095440: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
-00095450: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00095460: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
-00095470: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00095480: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
-00095490: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-000954a0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
-000954b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000954c0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-000954d0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
-000954e0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
-000954f0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
-00095500: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
-00095510: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
-00095520: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
-00095530: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
-00095540: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
-00095550: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
-00095560: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
-00095570: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
-00095580: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
-00095590: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
-000955a0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
-000955b0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
-000955c0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
-000955d0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
-000955e0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
-000955f0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
-00095600: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
-00095610: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
-00095620: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
-00095630: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
-00095640: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
-00095650: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
-00095660: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
-00095670: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
-00095680: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
-00095690: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
-000956a0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
-000956b0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
-000956c0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
-000956d0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
-000956e0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
-000956f0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
-00095700: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
-00095710: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
-00095720: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
-00095730: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
-00095740: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
-00095750: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
-00095760: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
-00095770: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
-00095780: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-00095790: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
-000957a0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
-000957b0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
-000957c0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
-000957d0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
-000957e0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
-000957f0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
-00095800: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
-00095810: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
-00095820: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
-00095830: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
-00095840: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
-00095850: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
-00095860: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
-00095870: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
-00095880: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
-00095890: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
-000958a0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
-000958b0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
-000958c0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
-000958d0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
-000958e0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
-000958f0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
-00095900: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
-00095910: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
-00095920: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
-00095930: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
-00095940: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
-00095950: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
-00095960: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
-00095970: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
-00095980: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
-00095990: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
-000959a0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
-000959b0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
-000959c0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
-000959d0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
-000959e0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
-000959f0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
-00095a00: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
-00095a10: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
-00095a20: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
-00095a30: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
-00095a40: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
-00095a50: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
-00095a60: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
-00095a70: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
-00095a80: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
-00095a90: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
-00095aa0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
-00095ab0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
-00095ac0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
-00095ad0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
-00095ae0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
-00095af0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
-00095b00: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
-00095b10: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
-00095b20: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
-00095b30: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
-00095b40: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
-00095b50: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
-00095b60: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
-00095b70: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
-00095b80: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
-00095b90: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
-00095ba0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
-00095bb0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
-00095bc0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
-00095bd0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
-00095be0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
-00095bf0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
-00095c00: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
-00095c10: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
-00095c20: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
-00095c30: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
-00095c40: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
-00095c50: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
-00095c60: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
-00095c70: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
-00095c80: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
-00095c90: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
-00095ca0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
-00095cb0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
-00095cc0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
-00095cd0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
-00095ce0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
-00095cf0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
-00095d00: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
-00095d10: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
-00095d20: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
-00095d30: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
-00095d40: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
-00095d50: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
-00095d60: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
-00095d70: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
-00095d80: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
-00095d90: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
-00095da0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
-00095db0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
-00095dc0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
-00095dd0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
-00095de0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
-00095df0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
-00095e00: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
-00095e10: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
-00095e20: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
-00095e30: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
-00095e40: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
-00095e50: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
-00095e60: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
-00095e70: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
-00095e80: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
-00095e90: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
-00095ea0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
-00095eb0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
-00095ec0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
-00095ed0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
-00095ee0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
-00095ef0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
-00095f00: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
-00095f10: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
-00095f20: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
-00095f30: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
-00095f40: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
-00095f50: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
-00095f60: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
-00095f70: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
-00095f80: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
-00095f90: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
-00095fa0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
-00095fb0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
-00095fc0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
-00095fd0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
-00095fe0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
-00095ff0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
-00096000: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
-00096010: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
-00096020: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
-00096030: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
-00096040: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
-00096050: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
-00096060: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
-00096070: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
-00096080: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
-00096090: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
-000960a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
-000960b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
-000960c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
-000960d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
-000960e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
-000960f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
-00096100: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
-00096110: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
-00096120: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
-00096130: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
-00096140: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
-00096150: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
-00096160: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
-00096170: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
-00096180: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
-00096190: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
-000961a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
-000961b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
-000961c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
-000961d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
-000961e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
-000961f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
-00096200: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
-00096210: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
-00096220: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
-00096230: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
-00096240: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
-00096250: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
-00096260: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
-00096270: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
-00096280: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
-00096290: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
-000962a0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
-000962b0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
-000962c0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
-000962d0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
-000962e0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
-000962f0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
-00096300: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
-00096310: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
-00096320: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
-00096330: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
-00096340: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
-00096350: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
-00096360: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
-00096370: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
-00096380: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
-00096390: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
-000963a0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
-000963b0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
-000963c0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
-000963d0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
-000963e0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
-000963f0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
-00096400: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
-00096410: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
-00096420: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
-00096430: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
-00096440: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
-00096450: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
-00096460: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
-00096470: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
-00096480: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
-00096490: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
-000964a0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
-000964b0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
-000964c0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
-000964d0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
-000964e0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
-000964f0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
-00096500: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
-00096510: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
-00096520: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
-00096530: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
-00096540: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
-00096550: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
-00096560: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
-00096570: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
-00096580: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
-00096590: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
-000965a0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
-000965b0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
-000965c0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
-000965d0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
-000965e0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
-000965f0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
-00096600: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
-00096610: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
-00096620: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
-00096630: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
-00096640: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
-00096650: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
-00096660: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
-00096670: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
-00096680: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
-00096690: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
-000966a0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
-000966b0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
-000966c0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
-000966d0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
-000966e0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
-000966f0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
-00096700: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
-00096710: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
-00096720: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
-00096730: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
-00096740: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
-00096750: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
-00096760: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
-00096770: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
-00096780: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
-00096790: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
-000967a0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
-000967b0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
-000967c0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
-000967d0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
-000967e0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
-000967f0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
-00096800: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
-00096810: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
-00096820: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
-00096830: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
-00096840: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
-00096850: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
-00096860: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
-00096870: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
-00096880: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
-00096890: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
-000968a0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
-000968b0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
-000968c0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
-000968d0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
-000968e0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
-000968f0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
-00096900: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
-00096910: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
-00096920: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
-00096930: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
-00096940: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
-00096950: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
-00096960: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
-00096970: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
-00096980: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
-00096990: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
-000969a0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
-000969b0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
-000969c0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
-000969d0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
-000969e0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
-000969f0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
-00096a00: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
-00096a10: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
-00096a20: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
-00096a30: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
-00096a40: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
-00096a50: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
-00096a60: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
-00096a70: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00096a80: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
-00096a90: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
-00096aa0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
-00096ab0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
-00096ac0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
-00096ad0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
-00096ae0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
-00096af0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
-00096b00: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
-00096b10: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
-00096b20: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
-00096b30: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
-00096b40: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
-00096b50: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
-00096b60: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
-00096b70: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
-00096b80: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
-00096b90: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
-00096ba0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
-00096bb0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
-00096bc0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
-00096bd0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
-00096be0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
-00096bf0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00096c00: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
-00096c10: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
-00096c20: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
-00096c30: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
-00096c40: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
-00096c50: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
-00096c60: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
-00096c70: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
-00096c80: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
-00096c90: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
-00096ca0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
-00096cb0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
-00096cc0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
-00096cd0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
-00096ce0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
-00096cf0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
-00096d00: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
-00096d10: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
-00096d20: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
-00096d30: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
-00096d40: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
-00096d50: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00096d60: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
-00096d70: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00096d80: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
-00096d90: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00096da0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
-00096db0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
-00096dc0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
-00096dd0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
-00096de0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
-00096df0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
-00096e00: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
-00096e10: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
-00096e20: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
-00096e30: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
-00096e40: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
-00096e50: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
-00096e60: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
-00096e70: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
-00096e80: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
-00096e90: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
-00096ea0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
-00096eb0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
-00096ec0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
-00096ed0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
-00096ee0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
-00096ef0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
-00096f00: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
-00096f10: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
-00096f20: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
-00096f30: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
-00096f40: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
-00096f50: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
-00096f60: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
-00096f70: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
-00096f80: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
-00096f90: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
-00096fa0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
-00096fb0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
-00096fc0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
-00096fd0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
-00096fe0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
-00096ff0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
-00097000: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
-00097010: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
-00097020: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
-00097030: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
-00097040: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
-00097050: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
-00097060: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
-00097070: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
-00097080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000970f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000971f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00097210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00097270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00097280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00097290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
-000972a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000972b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000972c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000972d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000972e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000972f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00097310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00097350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00097360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000973f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097400: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00097410: 3631 352e 300a 0000 0000 0000 0000 0000  615.0...........
-00097420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000974f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000975f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00097610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00097620: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
-00097630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00097670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00097680: 3030 3030 3737 3500 3030 3030 3030 3030  0000775.00000000
-00097690: 3030 3000 3032 3033 3434 0020 3000 0000  000.020344. 0...
+00093600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00093610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00093670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00093680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00093690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000936a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000936b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000936c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000936d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000936e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000936f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00093710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00093750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00093760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000937f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093800: 3232 206d 7469 6d65 3d31 3638 3437 3039  22 mtime=1684709
+00093810: 3331 362e 300a 0000 0000 0000 0000 0000  316.0...........
+00093820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000938f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000939f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00093a10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00093a20: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
+00093a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00093a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00093a80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
+00093a90: 3030 3000 3031 3735 3537 0020 3000 0000  000.017557. 0...
+00093aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00093b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00093b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00093b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00093b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00093c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00093c10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
+00093c20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
+00093c30: 312e 3731 360a 5375 6d6d 6172 793a 2041  1.716.Summary: A
+00093c40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
+00093c50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
+00093c60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
+00093c70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
+00093c80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
+00093c90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
+00093ca0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
+00093cb0: 694d 4c2f 4175 746f 5f56 694d 4c0a 4175  iML/Auto_ViML.Au
+00093cc0: 7468 6f72 3a20 5261 6d20 5365 7368 6164  thor: Ram Seshad
+00093cd0: 7269 0a4c 6963 656e 7365 3a20 4170 6163  ri.License: Apac
+00093ce0: 6865 204c 6963 656e 7365 2032 2e30 0a44  he License 2.0.D
+00093cf0: 6573 6372 6970 7469 6f6e 3a20 2320 4175  escription: # Au
+00093d00: 746f 2d56 694d 4c0a 2020 2020 2020 2020  to-ViML.        
+00093d10: 0a20 2020 2020 2020 2021 5b62 616e 6e65  .        ![banne
+00093d20: 725d 286c 6f67 6f2e 706e 6729 3c62 723e  r](logo.png)<br>
+00093d30: 0a20 2020 2020 2020 2041 7574 6f6d 6174  .        Automat
+00093d40: 6963 616c 6c79 2042 7569 6c64 2056 6172  ically Build Var
+00093d50: 696f 7573 2049 6e74 6572 7072 6574 6162  ious Interpretab
+00093d60: 6c65 204d 4c20 6d6f 6465 6c73 2066 6173  le ML models fas
+00093d70: 7421 3c62 723e 0a20 2020 2020 2020 205b  t!<br>.        [
+00093d80: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
+00093d90: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
+00093da0: 6164 6765 2f61 7574 6f76 696d 6c2f 7765  adge/autoviml/we
+00093db0: 656b 295d 2868 7474 7073 3a2f 2f70 6570  ek)](https://pep
+00093dc0: 792e 7465 6368 2f70 726f 6a65 6374 2f61  y.tech/project/a
+00093dd0: 7574 6f76 696d 6c2f 7765 656b 290a 2020  utoviml/week).  
+00093de0: 2020 2020 2020 5b21 5b44 6f77 6e6c 6f61        [![Downloa
+00093df0: 6473 5d28 6874 7470 733a 2f2f 7065 7079  ds](https://pepy
+00093e00: 2e74 6563 682f 6261 6467 652f 6175 746f  .tech/badge/auto
+00093e10: 7669 6d6c 2f6d 6f6e 7468 295d 2868 7474  viml/month)](htt
+00093e20: 7073 3a2f 2f70 6570 792e 7465 6368 2f70  ps://pepy.tech/p
+00093e30: 726f 6a65 6374 2f61 7574 6f76 696d 6c2f  roject/autoviml/
+00093e40: 6d6f 6e74 6829 0a20 2020 2020 2020 205b  month).        [
+00093e50: 215b 446f 776e 6c6f 6164 735d 2868 7474  ![Downloads](htt
+00093e60: 7073 3a2f 2f70 6570 792e 7465 6368 2f62  ps://pepy.tech/b
+00093e70: 6164 6765 2f61 7574 6f76 696d 6c29 5d28  adge/autoviml)](
+00093e80: 6874 7470 733a 2f2f 7065 7079 2e74 6563  https://pepy.tec
+00093e90: 682f 7072 6f6a 6563 742f 6175 746f 7669  h/project/autovi
+00093ea0: 6d6c 290a 2020 2020 2020 2020 5b21 5b73  ml).        [![s
+00093eb0: 7461 6e64 6172 642d 7265 6164 6d65 2063  tandard-readme c
+00093ec0: 6f6d 706c 6961 6e74 5d28 6874 7470 733a  ompliant](https:
+00093ed0: 2f2f 696d 672e 7368 6965 6c64 732e 696f  //img.shields.io
+00093ee0: 2f62 6164 6765 2f73 7461 6e64 6172 642d  /badge/standard-
+00093ef0: 2d72 6561 646d 652d 4f4b 2d67 7265 656e  -readme-OK-green
+00093f00: 2e73 7667 3f73 7479 6c65 3d66 6c61 742d  .svg?style=flat-
+00093f10: 7371 7561 7265 295d 2868 7474 7073 3a2f  square)](https:/
+00093f20: 2f67 6974 6875 622e 636f 6d2f 5269 6368  /github.com/Rich
+00093f30: 6172 644c 6974 742f 7374 616e 6461 7264  ardLitt/standard
+00093f40: 2d72 6561 646d 6529 0a20 2020 2020 2020  -readme).       
+00093f50: 205b 215b 5079 7468 6f6e 2056 6572 7369   [![Python Versi
+00093f60: 6f6e 735d 2868 7474 7073 3a2f 2f69 6d67  ons](https://img
+00093f70: 2e73 6869 656c 6473 2e69 6f2f 7079 7069  .shields.io/pypi
+00093f80: 2f70 7976 6572 7369 6f6e 732f 6175 746f  /pyversions/auto
+00093f90: 7669 6d6c 2e73 7667 3f6c 6f67 6f3d 7079  viml.svg?logo=py
+00093fa0: 7468 6f6e 266c 6f67 6f43 6f6c 6f72 3d77  thon&logoColor=w
+00093fb0: 6869 7465 295d 2868 7474 7073 3a2f 2f70  hite)](https://p
+00093fc0: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
+00093fd0: 6175 746f 7669 6d6c 290a 2020 2020 2020  autoviml).      
+00093fe0: 2020 5b21 5b50 7950 4920 5665 7273 696f    [![PyPI Versio
+00093ff0: 6e5d 2868 7474 7073 3a2f 2f69 6d67 2e73  n](https://img.s
+00094000: 6869 656c 6473 2e69 6f2f 7079 7069 2f76  hields.io/pypi/v
+00094010: 2f61 7574 6f76 696d 6c2e 7376 673f 6c6f  /autoviml.svg?lo
+00094020: 676f 3d70 7970 6926 6c6f 676f 436f 6c6f  go=pypi&logoColo
+00094030: 723d 7768 6974 6529 5d28 6874 7470 733a  r=white)](https:
+00094040: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
+00094050: 6374 2f61 7574 6f76 696d 6c29 0a20 2020  ct/autoviml).   
+00094060: 2020 2020 205b 215b 5079 5049 204c 6963       [![PyPI Lic
+00094070: 656e 7365 5d28 6874 7470 733a 2f2f 696d  ense](https://im
+00094080: 672e 7368 6965 6c64 732e 696f 2f70 7970  g.shields.io/pyp
+00094090: 692f 6c2f 6175 746f 7669 6d6c 2e73 7667  i/l/autoviml.svg
+000940a0: 295d 2868 7474 7073 3a2f 2f67 6974 6875  )](https://githu
+000940b0: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+000940c0: 7574 6f5f 5669 4d4c 2f62 6c6f 622f 6d61  uto_ViML/blob/ma
+000940d0: 7374 6572 2f4c 4943 454e 5345 290a 2020  ster/LICENSE).  
+000940e0: 2020 2020 2020 0a20 2020 2020 2020 2041        .        A
+000940f0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
+00094100: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
+00094110: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
+00094120: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
+00094130: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
+00094140: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
+00094150: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
+00094160: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
+00094170: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
+00094180: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
+00094190: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
+000941a0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
+000941b0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
+000941c0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
+000941d0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
+000941e0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
+000941f0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
+00094200: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
+00094210: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
+00094220: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
+00094230: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
+00094240: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
+00094250: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
+00094260: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
+00094270: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
+00094280: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+00094290: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
+000942a0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
+000942b0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
+000942c0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
+000942d0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
+000942e0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
+000942f0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
+00094300: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
+00094310: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
+00094320: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
+00094330: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
+00094340: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
+00094350: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
+00094360: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
+00094370: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
+00094380: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
+00094390: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
+000943a0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
+000943b0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
+000943c0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
+000943d0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
+000943e0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
+000943f0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
+00094400: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
+00094410: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
+00094420: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
+00094430: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
+00094440: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
+00094450: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
+00094460: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00094470: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
+00094480: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
+00094490: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
+000944a0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
+000944b0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
+000944c0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
+000944d0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
+000944e0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
+000944f0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
+00094500: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
+00094510: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
+00094520: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
+00094530: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
+00094540: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
+00094550: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
+00094560: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
+00094570: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
+00094580: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
+00094590: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
+000945a0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
+000945b0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
+000945c0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
+000945d0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+000945e0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
+000945f0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
+00094600: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
+00094610: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
+00094620: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
+00094630: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
+00094640: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
+00094650: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
+00094660: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
+00094670: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
+00094680: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
+00094690: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
+000946a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
+000946b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
+000946c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
+000946d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
+000946e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
+000946f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
+00094700: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
+00094710: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00094720: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
+00094730: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
+00094740: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00094750: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
+00094760: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
+00094770: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
+00094780: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
+00094790: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
+000947a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
+000947b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
+000947c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+000947d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
+000947e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+000947f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
+00094800: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
+00094810: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
+00094820: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+00094830: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
+00094840: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
+00094850: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
+00094860: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
+00094870: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
+00094880: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
+00094890: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
+000948a0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
+000948b0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
+000948c0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
+000948d0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
+000948e0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
+000948f0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
+00094900: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
+00094910: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
+00094920: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
+00094930: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
+00094940: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
+00094950: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
+00094960: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
+00094970: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
+00094980: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
+00094990: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
+000949a0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
+000949b0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
+000949c0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
+000949d0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
+000949e0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
+000949f0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+00094a00: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
+00094a10: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
+00094a20: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
+00094a30: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
+00094a40: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
+00094a50: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
+00094a60: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
+00094a70: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
+00094a80: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
+00094a90: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
+00094aa0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
+00094ab0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
+00094ac0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
+00094ad0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
+00094ae0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
+00094af0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
+00094b00: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
+00094b10: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
+00094b20: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
+00094b30: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
+00094b40: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
+00094b50: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
+00094b60: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
+00094b70: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
+00094b80: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
+00094b90: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
+00094ba0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
+00094bb0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
+00094bc0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
+00094bd0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
+00094be0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
+00094bf0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+00094c00: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
+00094c10: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
+00094c20: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
+00094c30: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
+00094c40: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
+00094c50: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
+00094c60: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
+00094c70: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
+00094c80: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
+00094c90: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
+00094ca0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
+00094cb0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
+00094cc0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
+00094cd0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
+00094ce0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
+00094cf0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
+00094d00: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
+00094d10: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
+00094d20: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
+00094d30: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
+00094d40: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
+00094d50: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
+00094d60: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
+00094d70: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
+00094d80: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
+00094d90: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
+00094da0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
+00094db0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
+00094dc0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
+00094dd0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
+00094de0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
+00094df0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
+00094e00: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
+00094e10: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
+00094e20: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
+00094e30: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
+00094e40: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
+00094e50: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
+00094e60: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
+00094e70: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
+00094e80: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00094e90: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
+00094ea0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
+00094eb0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
+00094ec0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
+00094ed0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
+00094ee0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
+00094ef0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
+00094f00: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
+00094f10: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
+00094f20: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
+00094f30: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094f40: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
+00094f50: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094f60: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
+00094f70: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
+00094f80: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
+00094f90: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
+00094fa0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
+00094fb0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
+00094fc0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00094fd0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
+00094fe0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
+00094ff0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
+00095000: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
+00095010: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
+00095020: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
+00095030: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
+00095040: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
+00095050: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
+00095060: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
+00095070: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
+00095080: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
+00095090: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
+000950a0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
+000950b0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
+000950c0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
+000950d0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
+000950e0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
+000950f0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
+00095100: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
+00095110: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
+00095120: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
+00095130: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
+00095140: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
+00095150: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
+00095160: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
+00095170: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
+00095180: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
+00095190: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
+000951a0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
+000951b0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
+000951c0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
+000951d0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
+000951e0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
+000951f0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
+00095200: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
+00095210: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
+00095220: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
+00095230: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
+00095240: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
+00095250: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
+00095260: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
+00095270: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
+00095280: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
+00095290: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
+000952a0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
+000952b0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
+000952c0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
+000952d0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
+000952e0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
+000952f0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
+00095300: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
+00095310: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
+00095320: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
+00095330: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
+00095340: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
+00095350: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
+00095360: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
+00095370: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
+00095380: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
+00095390: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
+000953a0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
+000953b0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
+000953c0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
+000953d0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
+000953e0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
+000953f0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
+00095400: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
+00095410: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
+00095420: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
+00095430: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
+00095440: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
+00095450: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
+00095460: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
+00095470: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
+00095480: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
+00095490: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
+000954a0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
+000954b0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+000954c0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
+000954d0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
+000954e0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+000954f0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
+00095500: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
+00095510: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00095520: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
+00095530: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00095540: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+00095550: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+00095560: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+00095570: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+00095580: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
+00095590: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
+000955a0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
+000955b0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
+000955c0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
+000955d0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
+000955e0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
+000955f0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
+00095600: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+00095610: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
+00095620: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
+00095630: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
+00095640: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
+00095650: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
+00095660: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
+00095670: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
+00095680: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
+00095690: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
+000956a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
+000956b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
+000956c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
+000956d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
+000956e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
+000956f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
+00095700: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00095710: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
+00095720: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+00095730: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
+00095740: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
+00095750: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
+00095760: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
+00095770: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
+00095780: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
+00095790: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
+000957a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
+000957b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
+000957c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
+000957d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
+000957e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
+000957f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
+00095800: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
+00095810: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
+00095820: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
+00095830: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
+00095840: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
+00095850: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
+00095860: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
+00095870: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
+00095880: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
+00095890: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
+000958a0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
+000958b0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
+000958c0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+000958d0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+000958e0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
+000958f0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
+00095900: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
+00095910: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
+00095920: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00095930: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
+00095940: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
+00095950: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00095960: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00095970: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
+00095980: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00095990: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
+000959a0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+000959b0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+000959c0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
+000959d0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
+000959e0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
+000959f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00095a00: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00095a10: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00095a20: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
+00095a30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00095a40: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
+00095a50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00095a60: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
+00095a70: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00095a80: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
+00095a90: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00095aa0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
+00095ab0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00095ac0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
+00095ad0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
+00095ae0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
+00095af0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
+00095b00: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
+00095b10: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
+00095b20: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
+00095b30: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
+00095b40: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
+00095b50: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
+00095b60: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
+00095b70: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
+00095b80: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
+00095b90: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
+00095ba0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
+00095bb0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
+00095bc0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
+00095bd0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
+00095be0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
+00095bf0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
+00095c00: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+00095c10: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
+00095c20: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
+00095c30: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
+00095c40: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
+00095c50: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
+00095c60: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
+00095c70: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
+00095c80: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
+00095c90: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
+00095ca0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
+00095cb0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
+00095cc0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
+00095cd0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
+00095ce0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
+00095cf0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
+00095d00: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
+00095d10: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
+00095d20: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
+00095d30: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00095d40: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
+00095d50: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+00095d60: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
+00095d70: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
+00095d80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00095d90: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
+00095da0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
+00095db0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
+00095dc0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
+00095dd0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
+00095de0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
+00095df0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
+00095e00: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
+00095e10: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
+00095e20: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
+00095e30: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
+00095e40: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
+00095e50: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
+00095e60: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
+00095e70: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
+00095e80: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
+00095e90: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+00095ea0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
+00095eb0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
+00095ec0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
+00095ed0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
+00095ee0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
+00095ef0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
+00095f00: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
+00095f10: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
+00095f20: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
+00095f30: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
+00095f40: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
+00095f50: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
+00095f60: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
+00095f70: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
+00095f80: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
+00095f90: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
+00095fa0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
+00095fb0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
+00095fc0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
+00095fd0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
+00095fe0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
+00095ff0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
+00096000: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
+00096010: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
+00096020: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
+00096030: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
+00096040: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
+00096050: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
+00096060: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
+00096070: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
+00096080: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
+00096090: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
+000960a0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
+000960b0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
+000960c0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
+000960d0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
+000960e0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
+000960f0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
+00096100: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
+00096110: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
+00096120: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
+00096130: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
+00096140: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
+00096150: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
+00096160: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
+00096170: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
+00096180: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
+00096190: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
+000961a0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+000961b0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
+000961c0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
+000961d0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
+000961e0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
+000961f0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
+00096200: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
+00096210: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+00096220: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
+00096230: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00096240: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
+00096250: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
+00096260: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
+00096270: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
+00096280: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
+00096290: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
+000962a0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
+000962b0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
+000962c0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
+000962d0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
+000962e0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
+000962f0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
+00096300: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
+00096310: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
+00096320: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
+00096330: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
+00096340: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
+00096350: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
+00096360: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
+00096370: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
+00096380: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
+00096390: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
+000963a0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
+000963b0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
+000963c0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
+000963d0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
+000963e0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
+000963f0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
+00096400: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
+00096410: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
+00096420: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
+00096430: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
+00096440: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
+00096450: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
+00096460: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
+00096470: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
+00096480: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00096490: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
+000964a0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
+000964b0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
+000964c0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
+000964d0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
+000964e0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
+000964f0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
+00096500: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
+00096510: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
+00096520: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
+00096530: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
+00096540: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
+00096550: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
+00096560: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
+00096570: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
+00096580: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
+00096590: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
+000965a0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
+000965b0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
+000965c0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
+000965d0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
+000965e0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
+000965f0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
+00096600: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
+00096610: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
+00096620: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
+00096630: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
+00096640: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
+00096650: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
+00096660: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
+00096670: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
+00096680: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
+00096690: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
+000966a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+000966b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
+000966c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
+000966d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
+000966e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
+000966f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
+00096700: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
+00096710: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+00096720: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
+00096730: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
+00096740: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
+00096750: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
+00096760: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
+00096770: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
+00096780: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
+00096790: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
+000967a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
+000967b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
+000967c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
+000967d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
+000967e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
+000967f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
+00096800: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
+00096810: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00096820: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
+00096830: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
+00096840: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
+00096850: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
+00096860: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
+00096870: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
+00096880: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
+00096890: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
+000968a0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
+000968b0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
+000968c0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
+000968d0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
+000968e0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
+000968f0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
+00096900: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
+00096910: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
+00096920: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
+00096930: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
+00096940: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
+00096950: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
+00096960: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
+00096970: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
+00096980: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
+00096990: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
+000969a0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
+000969b0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
+000969c0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
+000969d0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
+000969e0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
+000969f0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
+00096a00: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
+00096a10: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
+00096a20: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
+00096a30: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
+00096a40: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
+00096a50: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00096a60: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
+00096a70: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
+00096a80: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
+00096a90: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
+00096aa0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
+00096ab0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
+00096ac0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
+00096ad0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
+00096ae0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
+00096af0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
+00096b00: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
+00096b10: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
+00096b20: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
+00096b30: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
+00096b40: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
+00096b50: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
+00096b60: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00096b70: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
+00096b80: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
+00096b90: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
+00096ba0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
+00096bb0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00096bc0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
+00096bd0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
+00096be0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
+00096bf0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
+00096c00: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
+00096c10: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00096c20: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
+00096c30: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
+00096c40: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
+00096c50: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
+00096c60: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
+00096c70: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
+00096c80: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
+00096c90: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
+00096ca0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
+00096cb0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
+00096cc0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
+00096cd0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
+00096ce0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
+00096cf0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
+00096d00: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
+00096d10: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
+00096d20: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
+00096d30: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
+00096d40: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
+00096d50: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
+00096d60: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
+00096d70: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
+00096d80: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
+00096d90: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
+00096da0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
+00096db0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+00096dc0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
+00096dd0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
+00096de0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
+00096df0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
+00096e00: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
+00096e10: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
+00096e20: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
+00096e30: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
+00096e40: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
+00096e50: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
+00096e60: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
+00096e70: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
+00096e80: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
+00096e90: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
+00096ea0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
+00096eb0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
+00096ec0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
+00096ed0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
+00096ee0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
+00096ef0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
+00096f00: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
+00096f10: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
+00096f20: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
+00096f30: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
+00096f40: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
+00096f50: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
+00096f60: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
+00096f70: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
+00096f80: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
+00096f90: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
+00096fa0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
+00096fb0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
+00096fc0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
+00096fd0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
+00096fe0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
+00096ff0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
+00097000: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
+00097010: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
+00097020: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
+00097030: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
+00097040: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
+00097050: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
+00097060: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
+00097070: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00097080: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
+00097090: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
+000970a0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
+000970b0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
+000970c0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
+000970d0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
+000970e0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
+000970f0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
+00097100: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
+00097110: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
+00097120: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00097130: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00097140: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00097150: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00097160: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+00097170: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
+00097180: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
+00097190: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
+000971a0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
+000971b0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
+000971c0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
+000971d0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
+000971e0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
+000971f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00097200: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
+00097210: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
+00097220: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
+00097230: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
+00097240: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
+00097250: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+00097260: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
+00097270: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
+00097280: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
+00097290: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
+000972a0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
+000972b0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
+000972c0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
+000972d0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
+000972e0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
+000972f0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
+00097300: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
+00097310: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
+00097320: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
+00097330: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
+00097340: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
+00097350: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00097360: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
+00097370: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00097380: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
+00097390: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000973a0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
+000973b0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
+000973c0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
+000973d0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
+000973e0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
+000973f0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
+00097400: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
+00097410: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
+00097420: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
+00097430: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
+00097440: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
+00097450: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
+00097460: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
+00097470: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
+00097480: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
+00097490: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
+000974a0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
+000974b0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+000974c0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
+000974d0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
+000974e0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
+000974f0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
+00097500: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
+00097510: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
+00097520: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
+00097530: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
+00097540: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
+00097550: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
+00097560: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
+00097570: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
+00097580: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
+00097590: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
+000975a0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
+000975b0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
+000975c0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
+000975d0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
+000975e0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
+000975f0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
+00097600: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+00097610: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+00097620: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
+00097630: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
+00097640: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
+00097650: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
+00097660: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00097670: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
+00097680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00097700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00097720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00097750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00097740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000977f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097800: 5245 4144 4d45 2e6d 640a 7365 7475 702e  README.md.setup.
-00097810: 6366 670a 7365 7475 702e 7079 0a61 7574  cfg.setup.py.aut
-00097820: 6f76 696d 6c2f 4175 746f 5f4e 4c50 2e70  oviml/Auto_NLP.p
-00097830: 790a 6175 746f 7669 6d6c 2f41 7574 6f5f  y.autoviml/Auto_
-00097840: 5669 4d4c 2e70 790a 6175 746f 7669 6d6c  ViML.py.autoviml
-00097850: 2f51 7569 636b 4d4c 5f45 6e73 656d 626c  /QuickML_Ensembl
-00097860: 696e 672e 7079 0a61 7574 6f76 696d 6c2f  ing.py.autoviml/
-00097870: 5175 6963 6b4d 4c5f 5374 6163 6b69 6e67  QuickML_Stacking
-00097880: 2e70 790a 6175 746f 7669 6d6c 2f54 7261  .py.autoviml/Tra
-00097890: 6e73 666f 726d 5f4b 4d5f 4665 6174 7572  nsform_KM_Featur
-000978a0: 6573 2e70 790a 6175 746f 7669 6d6c 2f5f  es.py.autoviml/_
-000978b0: 5f69 6e69 745f 5f2e 7079 0a61 7574 6f76  _init__.py.autov
-000978c0: 696d 6c2f 5f5f 7665 7273 696f 6e5f 5f2e  iml/__version__.
-000978d0: 7079 0a61 7574 6f76 696d 6c2f 636c 6173  py.autoviml/clas
-000978e0: 7369 6679 5f6d 6574 686f 642e 7079 0a61  sify_method.py.a
-000978f0: 7574 6f76 696d 6c2f 6375 7374 6f6d 5f73  utoviml/custom_s
-00097900: 636f 7265 732e 7079 0a61 7574 6f76 696d  cores.py.autovim
-00097910: 6c2f 6375 7374 6f6d 5f73 636f 7265 735f  l/custom_scores_
-00097920: 484f 2e70 790a 6175 746f 7669 6d6c 2f66  HO.py.autoviml/f
-00097930: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
-00097940: 6e67 2e70 790a 6175 746f 7669 6d6c 2f73  ng.py.autoviml/s
-00097950: 756c 6f76 5f6d 6574 686f 642e 7079 0a61  ulov_method.py.a
-00097960: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
-00097970: 2f50 4b47 2d49 4e46 4f0a 6175 746f 7669  /PKG-INFO.autovi
-00097980: 6d6c 2e65 6767 2d69 6e66 6f2f 534f 5552  ml.egg-info/SOUR
-00097990: 4345 532e 7478 740a 6175 746f 7669 6d6c  CES.txt.autoviml
-000979a0: 2e65 6767 2d69 6e66 6f2f 6465 7065 6e64  .egg-info/depend
-000979b0: 656e 6379 5f6c 696e 6b73 2e74 7874 0a61  ency_links.txt.a
-000979c0: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
-000979d0: 2f72 6571 7569 7265 732e 7478 740a 6175  /requires.txt.au
-000979e0: 746f 7669 6d6c 2e65 6767 2d69 6e66 6f2f  toviml.egg-info/
-000979f0: 746f 705f 6c65 7665 6c2e 7478 7400 0000  top_level.txt...
-00097a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00097a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00097810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00097870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00097880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00097890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000978a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000978b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000978c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000978d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000978e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000978f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00097910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00097950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00097960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000979f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097a00: 3232 206d 7469 6d65 3d31 3638 3437 3039  22 mtime=1684709
+00097a10: 3331 362e 300a 0000 0000 0000 0000 0000  316.0...........
 00097a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00097a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00097a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00097a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00097a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00097b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00097b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00097b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c00: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00097c10: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
-00097c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00097c10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00097c20: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
 00097c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00097c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00097c80: 3030 3030 3737 3500 3030 3030 3030 3030  0000775.00000000
+00097c90: 3030 3000 3032 3033 3435 0020 3000 0000  000.020345. 0...
 00097ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00097d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00097d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00097d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00097d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00097d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00097e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00097e20: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
-00097e30: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
-00097e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00097e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00097e80: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
-00097e90: 3030 3000 3032 3235 3135 0020 3000 0000  000.022515. 0...
-00097ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
-00097f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
-00097f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00097f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
-00097f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098000: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00097e00: 5245 4144 4d45 2e6d 640a 7365 7475 702e  README.md.setup.
+00097e10: 6366 670a 7365 7475 702e 7079 0a61 7574  cfg.setup.py.aut
+00097e20: 6f76 696d 6c2f 4175 746f 5f4e 4c50 2e70  oviml/Auto_NLP.p
+00097e30: 790a 6175 746f 7669 6d6c 2f41 7574 6f5f  y.autoviml/Auto_
+00097e40: 5669 4d4c 2e70 790a 6175 746f 7669 6d6c  ViML.py.autoviml
+00097e50: 2f51 7569 636b 4d4c 5f45 6e73 656d 626c  /QuickML_Ensembl
+00097e60: 696e 672e 7079 0a61 7574 6f76 696d 6c2f  ing.py.autoviml/
+00097e70: 5175 6963 6b4d 4c5f 5374 6163 6b69 6e67  QuickML_Stacking
+00097e80: 2e70 790a 6175 746f 7669 6d6c 2f54 7261  .py.autoviml/Tra
+00097e90: 6e73 666f 726d 5f4b 4d5f 4665 6174 7572  nsform_KM_Featur
+00097ea0: 6573 2e70 790a 6175 746f 7669 6d6c 2f5f  es.py.autoviml/_
+00097eb0: 5f69 6e69 745f 5f2e 7079 0a61 7574 6f76  _init__.py.autov
+00097ec0: 696d 6c2f 5f5f 7665 7273 696f 6e5f 5f2e  iml/__version__.
+00097ed0: 7079 0a61 7574 6f76 696d 6c2f 636c 6173  py.autoviml/clas
+00097ee0: 7369 6679 5f6d 6574 686f 642e 7079 0a61  sify_method.py.a
+00097ef0: 7574 6f76 696d 6c2f 6375 7374 6f6d 5f73  utoviml/custom_s
+00097f00: 636f 7265 732e 7079 0a61 7574 6f76 696d  cores.py.autovim
+00097f10: 6c2f 6375 7374 6f6d 5f73 636f 7265 735f  l/custom_scores_
+00097f20: 484f 2e70 790a 6175 746f 7669 6d6c 2f66  HO.py.autoviml/f
+00097f30: 6561 7475 7265 5f65 6e67 696e 6565 7269  eature_engineeri
+00097f40: 6e67 2e70 790a 6175 746f 7669 6d6c 2f73  ng.py.autoviml/s
+00097f50: 756c 6f76 5f6d 6574 686f 642e 7079 0a61  ulov_method.py.a
+00097f60: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
+00097f70: 2f50 4b47 2d49 4e46 4f0a 6175 746f 7669  /PKG-INFO.autovi
+00097f80: 6d6c 2e65 6767 2d69 6e66 6f2f 534f 5552  ml.egg-info/SOUR
+00097f90: 4345 532e 7478 740a 6175 746f 7669 6d6c  CES.txt.autoviml
+00097fa0: 2e65 6767 2d69 6e66 6f2f 6465 7065 6e64  .egg-info/depend
+00097fb0: 656e 6379 5f6c 696e 6b73 2e74 7874 0a61  ency_links.txt.a
+00097fc0: 7574 6f76 696d 6c2e 6567 672d 696e 666f  utoviml.egg-info
+00097fd0: 2f72 6571 7569 7265 732e 7478 740a 6175  /requires.txt.au
+00097fe0: 746f 7669 6d6c 2e65 6767 2d69 6e66 6f2f  toviml.egg-info/
+00097ff0: 746f 705f 6c65 7665 6c2e 7478 7400 0000  top_level.txt...
+00098000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00098010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00098070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00098080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00098090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000980a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000980b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000980c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000980d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000980e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000980f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00098110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00098150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00098160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000981f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00098210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098200: 3232 206d 7469 6d65 3d31 3638 3437 3039  22 mtime=1684709
+00098210: 3331 362e 300a 0000 0000 0000 0000 0000  316.0...........
 00098220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00098270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00098280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00098290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00098260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000982f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00098300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00098350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00098340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098400: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00098410: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
-00098420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00098410: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00098420: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
+00098430: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
 00098440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00098470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00098480: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00098490: 3030 3000 3032 3235 3136 0020 3000 0000  000.022516. 0...
 000984a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000984b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000984c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000984d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000984e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000984f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00098510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00098530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00098550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00098560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00098610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00098620: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
+00098600: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00098610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00098670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00098680: 3030 3030 3336 3700 3030 3030 3030 3030  0000367.00000000
-00098690: 3030 3000 3032 3130 3535 0020 3000 0000  000.021055. 0...
+00098660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00098700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00098720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00098750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00098740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000987f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098800: 6265 6175 7469 6675 6c73 6f75 7034 0a63  beautifulsoup4.c
-00098810: 6174 626f 6f73 740a 656d 6f6a 690a 696d  atboost.emoji.im
-00098820: 6261 6c61 6e63 6564 2d6c 6561 726e 3e3d  balanced-learn>=
-00098830: 302e 3130 2e31 0a69 6d62 616c 616e 6365  0.10.1.imbalance
-00098840: 645f 656e 7365 6d62 6c65 3e3d 302e 322e  d_ensemble>=0.2.
-00098850: 300a 6970 7974 686f 6e0a 6a75 7079 7465  0.ipython.jupyte
-00098860: 720a 6c69 6768 7467 626d 3e3d 332e 302e  r.lightgbm>=3.0.
-00098870: 300a 6d61 7470 6c6f 746c 6962 0a6e 6c74  0.matplotlib.nlt
-00098880: 6b0a 6e75 6d70 797e 3d31 2e31 392e 350a  k.numpy~=1.19.5.
-00098890: 7061 6e64 6173 3e3d 312e 312e 330a 7265  pandas>=1.1.3.re
-000988a0: 6765 780a 7363 696b 6974 2d6c 6561 726e  gex.scikit-learn
-000988b0: 7e3d 312e 310a 7365 6162 6f72 6e0a 7368  ~=1.1.seaborn.sh
-000988c0: 6170 3e3d 302e 3336 2e30 0a74 6578 7462  ap>=0.36.0.textb
-000988d0: 6c6f 620a 7661 6465 7253 656e 7469 6d65  lob.vaderSentime
-000988e0: 6e74 0a78 6762 6f6f 7374 7e3d 312e 312e  nt.xgboost~=1.1.
-000988f0: 310a 786c 7264 0a00 0000 0000 0000 0000  1.xlrd..........
-00098900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00098810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00098870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00098880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00098890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000988a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000988b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000988c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000988d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000988e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000988f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00098910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00098950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00098960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000989f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00098a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098a00: 3232 206d 7469 6d65 3d31 3638 3437 3039  22 mtime=1684709
+00098a10: 3331 362e 300a 0000 0000 0000 0000 0000  316.0...........
 00098a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00098a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00098a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00098a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00098a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00098b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00098b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00098b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c00: 3232 206d 7469 6d65 3d31 3638 3433 3238  22 mtime=1684328
-00098c10: 3631 342e 300a 0000 0000 0000 0000 0000  614.0...........
-00098c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00098c10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00098c20: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
 00098c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00098c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00098c80: 3030 3030 3336 3700 3030 3030 3030 3030  0000367.00000000
+00098c90: 3030 3000 3032 3130 3536 0020 3000 0000  000.021056. 0...
 00098ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00098d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00098d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00098d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00098d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00098e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
-00098e20: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
-00098e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00098e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00098e80: 3030 3030 3031 3100 3030 3030 3030 3030  0000011.00000000
-00098e90: 3030 3000 3032 3131 3731 0020 3000 0000  000.021171. 0...
-00098ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00098e00: 6265 6175 7469 6675 6c73 6f75 7034 0a63  beautifulsoup4.c
+00098e10: 6174 626f 6f73 740a 656d 6f6a 690a 696d  atboost.emoji.im
+00098e20: 6261 6c61 6e63 6564 2d6c 6561 726e 3e3d  balanced-learn>=
+00098e30: 302e 3130 2e31 0a69 6d62 616c 616e 6365  0.10.1.imbalance
+00098e40: 645f 656e 7365 6d62 6c65 3e3d 302e 322e  d_ensemble>=0.2.
+00098e50: 300a 6970 7974 686f 6e0a 6a75 7079 7465  0.ipython.jupyte
+00098e60: 720a 6c69 6768 7467 626d 3e3d 332e 302e  r.lightgbm>=3.0.
+00098e70: 300a 6d61 7470 6c6f 746c 6962 0a6e 6c74  0.matplotlib.nlt
+00098e80: 6b0a 6e75 6d70 797e 3d31 2e31 392e 350a  k.numpy~=1.19.5.
+00098e90: 7061 6e64 6173 3e3d 312e 312e 330a 7265  pandas>=1.1.3.re
+00098ea0: 6765 780a 7363 696b 6974 2d6c 6561 726e  gex.scikit-learn
+00098eb0: 7e3d 312e 310a 7365 6162 6f72 6e0a 7368  ~=1.1.seaborn.sh
+00098ec0: 6170 3e3d 302e 3336 2e30 0a74 6578 7462  ap>=0.36.0.textb
+00098ed0: 6c6f 620a 7661 6465 7253 656e 7469 6d65  lob.vaderSentime
+00098ee0: 6e74 0a78 6762 6f6f 7374 7e3d 312e 312e  nt.xgboost~=1.1.
+00098ef0: 310a 786c 7264 0a00 0000 0000 0000 0000  1.xlrd..........
+00098f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00098f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00098f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00098f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00098f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099000: 6175 746f 7669 6d6c 0a00 0000 0000 0000  autoviml........
+00099000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00099010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00099070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00099080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00099090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000990a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000990b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000990c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000990d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000990e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000990f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00099110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00099160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000991f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00099210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099200: 3232 206d 7469 6d65 3d31 3638 3437 3039  22 mtime=1684709
+00099210: 3331 362e 300a 0000 0000 0000 0000 0000  316.0...........
 00099220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00099270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00099280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00099290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00099260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000992f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00099300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00099350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00099340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099400: 3238 206d 7469 6d65 3d31 3638 3433 3238  28 mtime=1684328
-00099410: 3631 352e 3931 3038 3639 340a 0000 0000  615.9108694.....
-00099420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00099410: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
+00099420: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
 00099430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00099470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00099480: 3030 3030 3031 3100 3030 3030 3030 3030  0000011.00000000
+00099490: 3030 3000 3032 3131 3732 0020 3000 0000  000.021172. 0...
 000994a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000994b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000994c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000994d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000994e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000994f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00099510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00099530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00099560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00099610: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
+00099600: 6175 746f 7669 6d6c 0a00 0000 0000 0000  autoviml........
+00099610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00099670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00099680: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
-00099690: 3030 3000 3031 3437 3336 0020 3000 0000  000.014736. 0...
+00099660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00099700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099720: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00099720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00099750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00099740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000997f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099800: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-00099810: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-00099820: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00099800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00099810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00099870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00099880: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00099890: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
 000998a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000998b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000998c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000998d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000998e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000998f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00099910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00099960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000999f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00099a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a00: 3237 206d 7469 6d65 3d31 3638 3437 3039  27 mtime=1684709
+00099a10: 3331 372e 3334 3132 3737 0a00 0000 0000  317.341277......
 00099a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00099a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00099a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00099a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00099a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00099b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00099b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00099b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099c00: 3232 206d 7469 6d65 3d31 3638 3433 3237  22 mtime=1684327
-00099c10: 3138 392e 300a 0000 0000 0000 0000 0000  189.0...........
+00099c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+00099c10: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
 00099c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+00099c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+00099c80: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
+00099c90: 3030 3000 3031 3437 3337 0020 3000 0000  000.014737. 0...
 00099ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 00099d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099d20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 00099d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00099d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00099d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3135  autoviml-0.1.715
-00099e10: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
-00099e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e00: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+00099e10: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+00099e20: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
 00099e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
-00099e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00099e80: 3030 3032 3331 3100 3030 3030 3030 3030  0002311.00000000
-00099e90: 3030 3000 3031 3436 3234 0020 3000 0000  000.014624. 0...
+00099e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
+00099f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f20: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
+00099f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
-00099f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00099f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00099f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a000: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
-0009a010: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
-0009a020: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
-0009a030: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
-0009a040: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
-0009a050: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
-0009a060: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
-0009a070: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
-0009a080: 0d0a 2020 2020 6e61 6d65 3d22 6175 746f  ..    name="auto
-0009a090: 7669 6d6c 222c 0d0a 2020 2020 7665 7273  viml",..    vers
-0009a0a0: 696f 6e3d 2230 2e31 2e37 3135 222c 0d0a  ion="0.1.715",..
-0009a0b0: 2020 2020 6175 7468 6f72 3d22 5261 6d20      author="Ram 
-0009a0c0: 5365 7368 6164 7269 222c 0d0a 2020 2020  Seshadri",..    
-0009a0d0: 2320 6175 7468 6f72 5f65 6d61 696c 3d22  # author_email="
-0009a0e0: 6175 7468 6f72 4065 7861 6d70 6c65 2e63  author@example.c
-0009a0f0: 6f6d 222c 0d0a 2020 2020 6465 7363 7269  om",..    descri
-0009a100: 7074 696f 6e3d 2241 7574 6f6d 6174 6963  ption="Automatic
-0009a110: 616c 6c79 2042 7569 6c64 2056 6172 6961  ally Build Varia
-0009a120: 6e74 2049 6e74 6572 7072 6574 6162 6c65  nt Interpretable
-0009a130: 204d 4c20 6d6f 6465 6c73 2066 6173 7420   ML models fast 
-0009a140: 2d20 6e6f 7720 7769 7468 2043 6174 426f  - now with CatBo
-0009a150: 6f73 7421 222c 0d0a 2020 2020 6c6f 6e67  ost!",..    long
-0009a160: 5f64 6573 6372 6970 7469 6f6e 3d6c 6f6e  _description=lon
-0009a170: 675f 6465 7363 7269 7074 696f 6e2c 0d0a  g_description,..
-0009a180: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
-0009a190: 7469 6f6e 5f63 6f6e 7465 6e74 5f74 7970  tion_content_typ
-0009a1a0: 653d 2274 6578 742f 6d61 726b 646f 776e  e="text/markdown
-0009a1b0: 222c 0d0a 2020 2020 6c69 6365 6e73 653d  ",..    license=
-0009a1c0: 2741 7061 6368 6520 4c69 6365 6e73 6520  'Apache License 
-0009a1d0: 322e 3027 2c0d 0a20 2020 2075 726c 3d22  2.0',..    url="
-0009a1e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0009a1f0: 6f6d 2f41 7574 6f56 694d 4c2f 4175 746f  om/AutoViML/Auto
-0009a200: 5f56 694d 4c22 2c0d 0a20 2020 2070 6163  _ViML",..    pac
-0009a210: 6b61 6765 733d 7365 7475 7074 6f6f 6c73  kages=setuptools
-0009a220: 2e66 696e 645f 7061 636b 6167 6573 2865  .find_packages(e
-0009a230: 7863 6c75 6465 3d28 2274 6573 7473 222c  xclude=("tests",
-0009a240: 2929 2c0d 0a20 2020 2069 6e73 7461 6c6c  )),..    install
-0009a250: 5f72 6571 7569 7265 733d 5b0d 0a20 2020  _requires=[..   
-0009a260: 2020 2020 2022 6e75 6d70 797e 3d31 2e31       "numpy~=1.1
-0009a270: 392e 3522 2c0d 0a20 2020 2020 2020 2022  9.5",..        "
-0009a280: 7061 6e64 6173 3e3d 312e 312e 3322 2c0d  pandas>=1.1.3",.
-0009a290: 0a20 2020 2020 2020 2022 786c 7264 222c  .        "xlrd",
-0009a2a0: 0d0a 2020 2020 2020 2020 226d 6174 706c  ..        "matpl
-0009a2b0: 6f74 6c69 6222 2c0d 0a20 2020 2020 2020  otlib",..       
-0009a2c0: 2022 6265 6175 7469 6675 6c73 6f75 7034   "beautifulsoup4
-0009a2d0: 222c 0d0a 2020 2020 2020 2020 2265 6d6f  ",..        "emo
-0009a2e0: 6a69 222c 0d0a 2020 2020 2020 2020 2269  ji",..        "i
-0009a2f0: 7079 7468 6f6e 222c 0d0a 2020 2020 2020  python",..      
-0009a300: 2020 226a 7570 7974 6572 222c 0d0a 2020    "jupyter",..  
-0009a310: 2020 2020 2020 2273 6561 626f 726e 222c        "seaborn",
-0009a320: 0d0a 2020 2020 2020 2020 2263 6174 626f  ..        "catbo
-0009a330: 6f73 7422 2c0d 0a20 2020 2020 2020 2022  ost",..        "
-0009a340: 7465 7874 626c 6f62 222c 0d0a 2020 2020  textblob",..    
-0009a350: 2020 2020 226e 6c74 6b22 2c0d 0a20 2020      "nltk",..   
-0009a360: 2020 2020 2022 7265 6765 7822 2c0d 0a20       "regex",.. 
-0009a370: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
-0009a380: 6561 726e 7e3d 312e 3122 2c0d 0a20 2020  earn~=1.1",..   
-0009a390: 2020 2020 2022 7867 626f 6f73 747e 3d31       "xgboost~=1
-0009a3a0: 2e31 2e31 222c 0d0a 2020 2020 2020 2020  .1.1",..        
-0009a3b0: 2276 6164 6572 5365 6e74 696d 656e 7422  "vaderSentiment"
-0009a3c0: 2c0d 0a20 2020 2020 2020 2022 696d 6261  ,..        "imba
-0009a3d0: 6c61 6e63 6564 2d6c 6561 726e 3e3d 302e  lanced-learn>=0.
-0009a3e0: 3130 2e31 222c 0d0a 2020 2020 2020 2020  10.1",..        
-0009a3f0: 2273 6861 703e 3d30 2e33 362e 3022 2c0d  "shap>=0.36.0",.
-0009a400: 0a20 2020 2020 2020 2022 696d 6261 6c61  .        "imbala
-0009a410: 6e63 6564 5f65 6e73 656d 626c 653e 3d30  nced_ensemble>=0
-0009a420: 2e32 2e30 222c 0d0a 2020 2020 2020 2020  .2.0",..        
-0009a430: 226c 6967 6874 6762 6d3e 3d33 2e30 2e30  "lightgbm>=3.0.0
-0009a440: 222c 0d0a 2020 2020 5d2c 0d0a 2020 2020  ",..    ],..    
-0009a450: 636c 6173 7369 6669 6572 733d 5b0d 0a20  classifiers=[.. 
-0009a460: 2020 2020 2020 2022 5072 6f67 7261 6d6d         "Programm
-0009a470: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-0009a480: 5079 7468 6f6e 203a 3a20 3322 2c0d 0a20  Python :: 3",.. 
-0009a490: 2020 2020 2020 2022 4f70 6572 6174 696e         "Operatin
-0009a4a0: 6720 5379 7374 656d 203a 3a20 4f53 2049  g System :: OS I
-0009a4b0: 6e64 6570 656e 6465 6e74 222c 0d0a 2020  ndependent",..  
-0009a4c0: 2020 5d2c 0d0a 290d 0a00 0000 0000 0000    ],..).........
+0009a000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0009a010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0009a070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0009a080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0009a090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0009a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0009a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0009a150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0009a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a200: 3232 206d 7469 6d65 3d31 3638 3437 3037  22 mtime=1684707
+0009a210: 3035 332e 300a 0000 0000 0000 0000 0000  053.0...........
+0009a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3136  autoviml-0.1.716
+0009a410: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
+0009a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
+0009a470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
+0009a480: 3030 3032 3331 3100 3030 3030 3030 3030  0002311.00000000
+0009a490: 3030 3000 3031 3436 3235 0020 3000 0000  000.014625. 0...
+0009a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
 0009a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a520: 0000 0000 0000 0000 0072 616d 0000 0000  .........ram....
 0009a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0009a550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0009a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0009aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0009a600: 696d 706f 7274 2073 6574 7570 746f 6f6c  import setuptool
+0009a610: 730d 0a0d 0a77 6974 6820 6f70 656e 2822  s....with open("
+0009a620: 5245 4144 4d45 2e6d 6422 2c20 2272 222c  README.md", "r",
+0009a630: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+0009a640: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
+0009a650: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
+0009a660: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
+0009a670: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
+0009a680: 0d0a 2020 2020 6e61 6d65 3d22 6175 746f  ..    name="auto
+0009a690: 7669 6d6c 222c 0d0a 2020 2020 7665 7273  viml",..    vers
+0009a6a0: 696f 6e3d 2230 2e31 2e37 3136 222c 0d0a  ion="0.1.716",..
+0009a6b0: 2020 2020 6175 7468 6f72 3d22 5261 6d20      author="Ram 
+0009a6c0: 5365 7368 6164 7269 222c 0d0a 2020 2020  Seshadri",..    
+0009a6d0: 2320 6175 7468 6f72 5f65 6d61 696c 3d22  # author_email="
+0009a6e0: 6175 7468 6f72 4065 7861 6d70 6c65 2e63  author@example.c
+0009a6f0: 6f6d 222c 0d0a 2020 2020 6465 7363 7269  om",..    descri
+0009a700: 7074 696f 6e3d 2241 7574 6f6d 6174 6963  ption="Automatic
+0009a710: 616c 6c79 2042 7569 6c64 2056 6172 6961  ally Build Varia
+0009a720: 6e74 2049 6e74 6572 7072 6574 6162 6c65  nt Interpretable
+0009a730: 204d 4c20 6d6f 6465 6c73 2066 6173 7420   ML models fast 
+0009a740: 2d20 6e6f 7720 7769 7468 2043 6174 426f  - now with CatBo
+0009a750: 6f73 7421 222c 0d0a 2020 2020 6c6f 6e67  ost!",..    long
+0009a760: 5f64 6573 6372 6970 7469 6f6e 3d6c 6f6e  _description=lon
+0009a770: 675f 6465 7363 7269 7074 696f 6e2c 0d0a  g_description,..
+0009a780: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
+0009a790: 7469 6f6e 5f63 6f6e 7465 6e74 5f74 7970  tion_content_typ
+0009a7a0: 653d 2274 6578 742f 6d61 726b 646f 776e  e="text/markdown
+0009a7b0: 222c 0d0a 2020 2020 6c69 6365 6e73 653d  ",..    license=
+0009a7c0: 2741 7061 6368 6520 4c69 6365 6e73 6520  'Apache License 
+0009a7d0: 322e 3027 2c0d 0a20 2020 2075 726c 3d22  2.0',..    url="
+0009a7e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0009a7f0: 6f6d 2f41 7574 6f56 694d 4c2f 4175 746f  om/AutoViML/Auto
+0009a800: 5f56 694d 4c22 2c0d 0a20 2020 2070 6163  _ViML",..    pac
+0009a810: 6b61 6765 733d 7365 7475 7074 6f6f 6c73  kages=setuptools
+0009a820: 2e66 696e 645f 7061 636b 6167 6573 2865  .find_packages(e
+0009a830: 7863 6c75 6465 3d28 2274 6573 7473 222c  xclude=("tests",
+0009a840: 2929 2c0d 0a20 2020 2069 6e73 7461 6c6c  )),..    install
+0009a850: 5f72 6571 7569 7265 733d 5b0d 0a20 2020  _requires=[..   
+0009a860: 2020 2020 2022 6e75 6d70 797e 3d31 2e31       "numpy~=1.1
+0009a870: 392e 3522 2c0d 0a20 2020 2020 2020 2022  9.5",..        "
+0009a880: 7061 6e64 6173 3e3d 312e 312e 3322 2c0d  pandas>=1.1.3",.
+0009a890: 0a20 2020 2020 2020 2022 786c 7264 222c  .        "xlrd",
+0009a8a0: 0d0a 2020 2020 2020 2020 226d 6174 706c  ..        "matpl
+0009a8b0: 6f74 6c69 6222 2c0d 0a20 2020 2020 2020  otlib",..       
+0009a8c0: 2022 6265 6175 7469 6675 6c73 6f75 7034   "beautifulsoup4
+0009a8d0: 222c 0d0a 2020 2020 2020 2020 2265 6d6f  ",..        "emo
+0009a8e0: 6a69 222c 0d0a 2020 2020 2020 2020 2269  ji",..        "i
+0009a8f0: 7079 7468 6f6e 222c 0d0a 2020 2020 2020  python",..      
+0009a900: 2020 226a 7570 7974 6572 222c 0d0a 2020    "jupyter",..  
+0009a910: 2020 2020 2020 2273 6561 626f 726e 222c        "seaborn",
+0009a920: 0d0a 2020 2020 2020 2020 2263 6174 626f  ..        "catbo
+0009a930: 6f73 7422 2c0d 0a20 2020 2020 2020 2022  ost",..        "
+0009a940: 7465 7874 626c 6f62 222c 0d0a 2020 2020  textblob",..    
+0009a950: 2020 2020 226e 6c74 6b22 2c0d 0a20 2020      "nltk",..   
+0009a960: 2020 2020 2022 7265 6765 7822 2c0d 0a20       "regex",.. 
+0009a970: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
+0009a980: 6561 726e 7e3d 312e 3122 2c0d 0a20 2020  earn~=1.1",..   
+0009a990: 2020 2020 2022 7867 626f 6f73 747e 3d31       "xgboost~=1
+0009a9a0: 2e31 2e31 222c 0d0a 2020 2020 2020 2020  .1.1",..        
+0009a9b0: 2276 6164 6572 5365 6e74 696d 656e 7422  "vaderSentiment"
+0009a9c0: 2c0d 0a20 2020 2020 2020 2022 696d 6261  ,..        "imba
+0009a9d0: 6c61 6e63 6564 2d6c 6561 726e 3e3d 302e  lanced-learn>=0.
+0009a9e0: 3130 2e31 222c 0d0a 2020 2020 2020 2020  10.1",..        
+0009a9f0: 2273 6861 703e 3d30 2e33 362e 3022 2c0d  "shap>=0.36.0",.
+0009aa00: 0a20 2020 2020 2020 2022 696d 6261 6c61  .        "imbala
+0009aa10: 6e63 6564 5f65 6e73 656d 626c 653e 3d30  nced_ensemble>=0
+0009aa20: 2e32 2e30 222c 0d0a 2020 2020 2020 2020  .2.0",..        
+0009aa30: 226c 6967 6874 6762 6d3e 3d33 2e30 2e30  "lightgbm>=3.0.0
+0009aa40: 222c 0d0a 2020 2020 5d2c 0d0a 2020 2020  ",..    ],..    
+0009aa50: 636c 6173 7369 6669 6572 733d 5b0d 0a20  classifiers=[.. 
+0009aa60: 2020 2020 2020 2022 5072 6f67 7261 6d6d         "Programm
+0009aa70: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+0009aa80: 5079 7468 6f6e 203a 3a20 3322 2c0d 0a20  Python :: 3",.. 
+0009aa90: 2020 2020 2020 2022 4f70 6572 6174 696e         "Operatin
+0009aaa0: 6720 5379 7374 656d 203a 3a20 4f53 2049  g System :: OS I
+0009aab0: 6e64 6570 656e 6465 6e74 222c 0d0a 2020  ndependent",..  
+0009aac0: 2020 5d2c 0d0a 290d 0a00 0000 0000 0000    ],..).........
 0009aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009ab00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0009ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

