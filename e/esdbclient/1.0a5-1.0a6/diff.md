# Comparing `tmp/esdbclient-1.0a5.tar.gz` & `tmp/esdbclient-1.0a6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "esdbclient-1.0a5.tar", max compression
+gzip compressed data, was "esdbclient-1.0a6.tar", max compression
```

## Comparing `esdbclient-1.0a5.tar` & `esdbclient-1.0a6.tar`

### file list

```diff
@@ -1,37 +1,37 @@
--rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.0a5/LICENSE
--rw-r--r--   0        0        0   107338 2023-05-16 17:59:25.274009 esdbclient-1.0a5/README.md
--rw-r--r--   0        0        0      515 2023-05-10 19:02:05.845353 esdbclient-1.0a5/esdbclient/__init__.py
--rw-r--r--   0        0        0    14218 2023-05-11 10:04:02.070439 esdbclient-1.0a5/esdbclient/asyncio_client.py
--rw-r--r--   0        0        0    35330 2023-05-16 12:05:07.454645 esdbclient-1.0a5/esdbclient/client.py
--rw-r--r--   0        0        0    11556 2023-05-10 19:02:05.847236 esdbclient-1.0a5/esdbclient/connection.py
--rw-r--r--   0        0        0     2330 2023-05-12 13:14:11.908419 esdbclient-1.0a5/esdbclient/esdbapibase.py
--rw-r--r--   0        0        0      838 2023-05-11 20:15:54.815803 esdbclient-1.0a5/esdbclient/events.py
--rw-r--r--   0        0        0     3199 2023-05-11 22:17:12.557460 esdbclient-1.0a5/esdbclient/exceptions.py
--rw-r--r--   0        0        0     4912 2023-05-10 19:02:05.848113 esdbclient-1.0a5/esdbclient/gossip.py
--rw-r--r--   0        0        0    28984 2023-05-16 12:05:07.458965 esdbclient-1.0a5/esdbclient/persistent.py
--rw-r--r--   0        0        0    13401 2023-05-09 15:45:39.784205 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.py
--rw-r--r--   0        0        0    37958 2023-05-09 15:45:38.350807 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.pyi
--rw-r--r--   0        0        0    19336 2023-05-09 15:45:39.761236 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2_grpc.py
--rw-r--r--   0        0        0     1790 2023-05-09 15:45:39.793881 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.py
--rw-r--r--   0        0        0    13555 2023-05-09 15:45:37.813695 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.734763 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2_grpc.py
--rw-r--r--   0        0        0     2817 2023-05-09 15:45:39.765118 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.py
--rw-r--r--   0        0        0     5524 2023-05-09 15:45:37.858863 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.pyi
--rw-r--r--   0        0        0     2752 2023-05-09 15:45:39.763073 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2_grpc.py
--rw-r--r--   0        0        0    22467 2023-05-09 15:45:39.771649 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.py
--rw-r--r--   0        0        0    73220 2023-05-09 15:45:38.784305 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.pyi
--rw-r--r--   0        0        0    15771 2023-05-09 15:45:39.791304 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2_grpc.py
--rw-r--r--   0        0        0     3782 2023-05-09 15:45:39.773845 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.py
--rw-r--r--   0        0        0     9874 2023-05-09 15:45:37.963369 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.783977 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2_grpc.py
--rw-r--r--   0        0        0     1686 2023-05-09 15:45:39.755017 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.py
--rw-r--r--   0        0        0     2838 2023-05-09 15:45:37.828819 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.797991 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2_grpc.py
--rw-r--r--   0        0        0    19933 2023-05-09 15:45:39.801455 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.py
--rw-r--r--   0        0        0    71744 2023-05-09 15:45:38.782146 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.pyi
--rw-r--r--   0        0        0     9787 2023-05-09 15:45:37.926522 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2_grpc.py
--rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.0a5/esdbclient/py.typed
--rw-r--r--   0        0        0    43490 2023-05-12 18:07:09.772591 esdbclient-1.0a5/esdbclient/streams.py
--rw-r--r--   0        0        0     2670 2023-05-16 19:17:37.212060 esdbclient-1.0a5/pyproject.toml
--rw-r--r--   0        0        0   111251 1970-01-01 00:00:00.000000 esdbclient-1.0a5/setup.py
--rw-r--r--   0        0        0   108668 1970-01-01 00:00:00.000000 esdbclient-1.0a5/PKG-INFO
+-rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.0a6/LICENSE
+-rw-r--r--   0        0        0   111383 2023-05-22 13:13:57.511132 esdbclient-1.0a6/README.md
+-rw-r--r--   0        0        0      515 2023-05-10 19:02:05.845353 esdbclient-1.0a6/esdbclient/__init__.py
+-rw-r--r--   0        0        0    14175 2023-05-20 01:30:08.950137 esdbclient-1.0a6/esdbclient/asyncio_client.py
+-rw-r--r--   0        0        0    35531 2023-05-20 03:12:59.117064 esdbclient-1.0a6/esdbclient/client.py
+-rw-r--r--   0        0        0    11560 2023-05-19 15:05:34.128220 esdbclient-1.0a6/esdbclient/connection.py
+-rw-r--r--   0        0        0     2386 2023-05-19 15:05:37.413801 esdbclient-1.0a6/esdbclient/esdbapibase.py
+-rw-r--r--   0        0        0      838 2023-05-11 20:15:54.815803 esdbclient-1.0a6/esdbclient/events.py
+-rw-r--r--   0        0        0     3245 2023-05-20 01:32:12.161060 esdbclient-1.0a6/esdbclient/exceptions.py
+-rw-r--r--   0        0        0     4928 2023-05-19 15:05:40.918186 esdbclient-1.0a6/esdbclient/gossip.py
+-rw-r--r--   0        0        0    30889 2023-05-19 16:02:42.915580 esdbclient-1.0a6/esdbclient/persistent.py
+-rw-r--r--   0        0        0    13401 2023-05-09 15:45:39.784205 esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2.py
+-rw-r--r--   0        0        0    37958 2023-05-09 15:45:38.350807 esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2.pyi
+-rw-r--r--   0        0        0    19336 2023-05-09 15:45:39.761236 esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2_grpc.py
+-rw-r--r--   0        0        0     1790 2023-05-09 15:45:39.793881 esdbclient-1.0a6/esdbclient/protos/Grpc/code_pb2.py
+-rw-r--r--   0        0        0    13555 2023-05-09 15:45:37.813695 esdbclient-1.0a6/esdbclient/protos/Grpc/code_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.734763 esdbclient-1.0a6/esdbclient/protos/Grpc/code_pb2_grpc.py
+-rw-r--r--   0        0        0     2817 2023-05-09 15:45:39.765118 esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2.py
+-rw-r--r--   0        0        0     5524 2023-05-09 15:45:37.858863 esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2.pyi
+-rw-r--r--   0        0        0     2752 2023-05-09 15:45:39.763073 esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2_grpc.py
+-rw-r--r--   0        0        0    22467 2023-05-09 15:45:39.771649 esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2.py
+-rw-r--r--   0        0        0    73220 2023-05-09 15:45:38.784305 esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2.pyi
+-rw-r--r--   0        0        0    15771 2023-05-09 15:45:39.791304 esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2_grpc.py
+-rw-r--r--   0        0        0     3782 2023-05-09 15:45:39.773845 esdbclient-1.0a6/esdbclient/protos/Grpc/shared_pb2.py
+-rw-r--r--   0        0        0     9874 2023-05-09 15:45:37.963369 esdbclient-1.0a6/esdbclient/protos/Grpc/shared_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.783977 esdbclient-1.0a6/esdbclient/protos/Grpc/shared_pb2_grpc.py
+-rw-r--r--   0        0        0     1686 2023-05-09 15:45:39.755017 esdbclient-1.0a6/esdbclient/protos/Grpc/status_pb2.py
+-rw-r--r--   0        0        0     2838 2023-05-09 15:45:37.828819 esdbclient-1.0a6/esdbclient/protos/Grpc/status_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.797991 esdbclient-1.0a6/esdbclient/protos/Grpc/status_pb2_grpc.py
+-rw-r--r--   0        0        0    19933 2023-05-09 15:45:39.801455 esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2.py
+-rw-r--r--   0        0        0    71744 2023-05-09 15:45:38.782146 esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2.pyi
+-rw-r--r--   0        0        0     9787 2023-05-09 15:45:37.926522 esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2_grpc.py
+-rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.0a6/esdbclient/py.typed
+-rw-r--r--   0        0        0    44026 2023-05-22 13:07:29.542125 esdbclient-1.0a6/esdbclient/streams.py
+-rw-r--r--   0        0        0     2670 2023-05-16 23:53:58.006272 esdbclient-1.0a6/pyproject.toml
+-rw-r--r--   0        0        0   115310 1970-01-01 00:00:00.000000 esdbclient-1.0a6/setup.py
+-rw-r--r--   0        0        0   112713 1970-01-01 00:00:00.000000 esdbclient-1.0a6/PKG-INFO
```

### Comparing `esdbclient-1.0a5/LICENSE` & `esdbclient-1.0a6/LICENSE`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/README.md` & `esdbclient-1.0a6/PKG-INFO`

 * *Files 8% similar despite different names*

```diff
@@ -1,6709 +1,7045 @@
-00000000: 2320 5079 7468 6f6e 2067 5250 4320 436c  # Python gRPC Cl
-00000010: 6965 6e74 2066 6f72 2045 7665 6e74 5374  ient for EventSt
-00000020: 6f72 6544 420a 0a54 6869 7320 5b50 7974  oreDB..This [Pyt
-00000030: 686f 6e20 7061 636b 6167 655d 2868 7474  hon package](htt
-00000040: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
-00000050: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
-00000060: 2f29 2070 726f 7669 6465 7320 6120 5079  /) provides a Py
-00000070: 7468 6f6e 0a67 5250 4320 636c 6965 6e74  thon.gRPC client
-00000080: 2066 6f72 205b 4576 656e 7453 746f 7265   for [EventStore
-00000090: 4442 5d28 6874 7470 733a 2f2f 7777 772e  DB](https://www.
-000000a0: 6576 656e 7473 746f 7265 2e63 6f6d 2f29  eventstore.com/)
-000000b0: 2e0a 0a54 6869 7320 636c 6965 6e74 2068  ...This client h
-000000c0: 6173 2062 6565 6e20 6465 7665 6c6f 7065  as been develope
-000000d0: 6420 696e 2063 6f6c 6c61 626f 7261 7469  d in collaborati
-000000e0: 6f6e 2077 6974 6820 7468 6520 4576 656e  on with the Even
-000000f0: 7453 746f 7265 4442 0a74 6561 6d2e 2041  tStoreDB.team. A
-00000100: 6c74 686f 7567 6820 6e6f 7420 616c 6c20  lthough not all 
-00000110: 7468 6520 6665 6174 7572 6573 206f 6620  the features of 
-00000120: 4576 656e 7453 746f 7265 4442 2061 7265  EventStoreDB are
-00000130: 2073 7570 706f 7274 6564 0a62 7920 7468   supported.by th
-00000140: 6973 2063 6c69 656e 742c 206d 616e 7920  is client, many 
-00000150: 6f66 2074 6865 206d 6f73 7420 7573 6566  of the most usef
-00000160: 756c 206f 6e65 7320 6172 6520 7072 6573  ul ones are pres
-00000170: 656e 7465 640a 696e 2061 6e20 6561 7379  ented.in an easy
-00000180: 2d74 6f2d 7573 6520 696e 7465 7266 6163  -to-use interfac
-00000190: 652e 0a0a 5468 6973 2063 6c69 656e 7420  e...This client 
-000001a0: 6861 7320 6265 656e 2074 6573 7465 6420  has been tested 
-000001b0: 746f 2077 6f72 6b20 7769 7468 2045 7665  to work with Eve
-000001c0: 6e74 5374 6f72 6544 4220 4c54 5320 7665  ntStoreDB LTS ve
-000001d0: 7273 696f 6e73 2032 312e 3130 2c0a 7769  rsions 21.10,.wi
-000001e0: 7468 6f75 7420 616e 6420 7769 7468 6f75  thout and withou
-000001f0: 7420 5353 4c2f 544c 532c 2061 6e64 2077  t SSL/TLS, and w
-00000200: 6974 6820 5079 7468 6f6e 2076 6572 7369  ith Python versi
-00000210: 6f6e 7320 332e 3720 746f 2033 2e31 312e  ons 3.7 to 3.11.
-00000220: 2054 6865 7265 0a69 7320 3130 3025 2074   There.is 100% t
-00000230: 6573 7420 636f 7665 7261 6765 2e20 5468  est coverage. Th
-00000240: 6520 636f 6465 2068 6173 2074 7970 696e  e code has typin
-00000250: 6720 616e 6e6f 7461 7469 6f6e 732c 2063  g annotations, c
-00000260: 6865 636b 6564 2077 6974 6820 6d79 7079  hecked with mypy
-00000270: 2e0a 5468 6520 636f 6465 2069 7320 666f  ..The code is fo
-00000280: 726d 6174 7465 6420 7769 7468 2062 6c61  rmatted with bla
-00000290: 636b 2061 6e64 2069 736f 7274 2c20 616e  ck and isort, an
-000002a0: 6420 6368 6563 6b65 6420 7769 7468 2066  d checked with f
-000002b0: 6c61 6b65 382e 2050 6f65 7472 790a 6973  lake8. Poetry.is
-000002c0: 2075 7365 6420 666f 7220 7061 636b 6167   used for packag
-000002d0: 6520 6d61 6e61 6765 6d65 6e74 2064 7572  e management dur
-000002e0: 696e 6720 6465 7665 6c6f 706d 656e 742c  ing development,
-000002f0: 2061 6e64 2066 6f72 2062 7569 6c64 696e   and for buildin
-00000300: 6720 616e 640a 7075 626c 6973 6869 6e67  g and.publishing
-00000310: 2064 6973 7472 6962 7574 696f 6e73 2074   distributions t
-00000320: 6f20 5b50 7950 495d 2868 7474 7073 3a2f  o [PyPI](https:/
-00000330: 2f70 7970 692e 6f72 672f 7072 6f6a 6563  /pypi.org/projec
-00000340: 742f 6573 6462 636c 6965 6e74 2f29 2e0a  t/esdbclient/)..
-00000350: 0a23 2320 5379 6e6f 7073 6973 0a0a 5468  .## Synopsis..Th
-00000360: 6520 6045 5344 4243 6c69 656e 7460 2063  e `ESDBClient` c
-00000370: 6c61 7373 2063 616e 2062 6520 696d 706f  lass can be impo
-00000380: 7274 6564 2066 726f 6d20 7468 6520 6065  rted from the `e
-00000390: 7364 6263 6c69 656e 7460 2070 6163 6b61  sdbclient` packa
-000003a0: 6765 2e0a 0a54 6f20 7275 6e20 7468 6520  ge...To run the 
-000003b0: 636c 6965 6e74 2c20 796f 7520 7769 6c6c  client, you will
-000003c0: 206e 6565 6420 6120 636f 6e6e 6563 7469   need a connecti
-000003d0: 6f6e 2073 7472 696e 6720 5552 492e 2041  on string URI. A
-000003e0: 6e64 2c20 746f 0a63 6f6e 6e65 6374 2074  nd, to.connect t
-000003f0: 6f20 6120 2273 6563 7572 6522 2045 7665  o a "secure" Eve
-00000400: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-00000410: 2c20 796f 7520 7769 6c6c 2061 6c73 6f20  , you will also 
-00000420: 6e65 6564 2061 6e0a 5353 4c2f 544c 5320  need an.SSL/TLS 
-00000430: 6365 7274 6966 6963 6174 652e 0a0a 5072  certificate...Pr
-00000440: 6f62 6162 6c79 2074 6865 2074 6872 6565  obably the three
-00000450: 206d 6f73 7420 7573 6566 756c 206d 6574   most useful met
-00000460: 686f 6473 206f 6620 6045 5344 4243 6c69  hods of `ESDBCli
-00000470: 656e 7460 2061 7265 3a0a 0a2a 2060 6170  ent` are:..* `ap
-00000480: 7065 6e64 5f65 7665 6e74 7328 2960 2054  pend_events()` T
-00000490: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
-000004a0: 6520 7573 6564 2074 6f20 7265 636f 7264  e used to record
-000004b0: 2065 7665 6e74 7320 696e 2061 2070 6172   events in a par
-000004c0: 7469 6375 6c61 720a 2273 7472 6561 6d22  ticular."stream"
-000004d0: 2e20 5468 6973 2069 7320 7573 6566 756c  . This is useful
-000004e0: 2066 6f72 2065 7861 6d70 6c65 2077 6865   for example whe
-000004f0: 6e20 6578 6563 7574 696e 6720 6120 636f  n executing a co
-00000500: 6d6d 616e 6420 696e 2061 6e20 6170 706c  mmand in an appl
-00000510: 6963 6174 696f 6e0a 7468 6174 206d 7574  ication.that mut
-00000520: 6174 6573 2061 6e20 6167 6772 6567 6174  ates an aggregat
-00000530: 652e 2054 6869 7320 6d65 7468 6f64 2069  e. This method i
-00000540: 7320 2261 746f 6d69 6322 2069 6e20 7468  s "atomic" in th
-00000550: 6174 2065 6974 6865 7220 616c 6c20 6f72  at either all or
-00000560: 206e 6f6e 6520 6f66 0a74 6865 2065 7665   none of.the eve
-00000570: 6e74 7320 7769 6c6c 2062 6520 7265 636f  nts will be reco
-00000580: 7264 6564 2e0a 0a2a 2060 7265 6164 5f73  rded...* `read_s
-00000590: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
-000005a0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-000005b0: 6265 2075 7365 6420 746f 2072 6574 7269  be used to retri
-000005c0: 6576 6520 616c 6c20 7468 6520 7265 636f  eve all the reco
-000005d0: 7264 6564 0a65 7665 6e74 7320 696e 2061  rded.events in a
-000005e0: 2022 7374 7265 616d 222e 2054 6869 7320   "stream". This 
-000005f0: 6973 2075 7365 6675 6c20 666f 7220 6578  is useful for ex
-00000600: 616d 706c 6520 7768 656e 2072 6563 6f6e  ample when recon
-00000610: 7374 7275 6374 696e 6720 616e 2061 6767  structing an agg
-00000620: 7265 6761 7465 0a62 6566 6f72 6520 6578  regate.before ex
-00000630: 6563 7574 696e 6720 6120 636f 6d6d 616e  ecuting a comman
-00000640: 6420 696e 2061 6e20 6170 706c 6963 6174  d in an applicat
-00000650: 696f 6e2e 0a0a 2a20 6073 7562 7363 7269  ion...* `subscri
-00000660: 6265 5f61 6c6c 5f65 7665 6e74 7328 2960  be_all_events()`
-00000670: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
-00000680: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
-00000690: 6976 6520 616c 6c20 7265 636f 7264 6564  ive all recorded
-000006a0: 0a65 7665 6e74 7320 6163 726f 7373 2061  .events across a
-000006b0: 6c6c 2022 7374 7265 616d 7322 2e20 5468  ll "streams". Th
-000006c0: 6973 2069 7320 7573 6566 756c 2069 6e20  is is useful in 
-000006d0: 646f 776e 7374 7265 616d 2065 7665 6e74  downstream event
-000006e0: 2d70 726f 6365 7373 696e 670a 636f 6d70  -processing.comp
-000006f0: 6f6e 656e 7473 2c20 616e 6420 7375 7070  onents, and supp
-00000700: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
-00000710: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
-00000720: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
-00000730: 7469 6373 2028 7365 6520 6265 6c6f 7729  tics (see below)
-00000740: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
-00000750: 656c 6f77 2075 7365 7320 616e 2022 696e  elow uses an "in
-00000760: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
-00000770: 7265 4442 2073 6572 7665 7220 7275 6e6e  reDB server runn
-00000780: 696e 6720 6c6f 6361 6c6c 7920 6f6e 2070  ing locally on p
-00000790: 6f72 7420 3231 3134 2e0a 0a60 6060 7079  ort 2114...```py
-000007a0: 7468 6f6e 0a69 6d70 6f72 7420 6573 6462  thon.import esdb
-000007b0: 636c 6965 6e74 2c20 7575 6964 0a0a 0a23  client, uuid...#
-000007c0: 2043 6f6e 7374 7275 6374 2045 5344 4243   Construct ESDBC
-000007d0: 6c69 656e 7420 7769 7468 2061 6e20 4576  lient with an Ev
-000007e0: 656e 7453 746f 7265 4442 2055 5249 2e0a  entStoreDB URI..
-000007f0: 0a63 6c69 656e 7420 3d20 6573 6462 636c  .client = esdbcl
-00000800: 6965 6e74 2e45 5344 4243 6c69 656e 7428  ient.ESDBClient(
-00000810: 7572 693d 2265 7364 623a 2f2f 6c6f 6361  uri="esdb://loca
-00000820: 6c68 6f73 743a 3231 3134 3f54 6c73 3d66  lhost:2114?Tls=f
-00000830: 616c 7365 2229 0a0a 0a23 2041 7070 656e  alse")...# Appen
-00000840: 6420 6576 656e 7473 2074 6f20 6120 6e65  d events to a ne
-00000850: 7720 7374 7265 616d 2e0a 0a73 7472 6561  w stream...strea
-00000860: 6d5f 6e61 6d65 203d 2073 7472 2875 7569  m_name = str(uui
-00000870: 642e 7575 6964 3428 2929 0a0a 6576 656e  d.uuid4())..even
-00000880: 7431 203d 2065 7364 6263 6c69 656e 742e  t1 = esdbclient.
-00000890: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
-000008a0: 7264 6572 4372 6561 7465 6427 2c20 6461  rderCreated', da
-000008b0: 7461 3d62 2764 6174 6131 2729 0a0a 636c  ta=b'data1')..cl
-000008c0: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-000008d0: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-000008e0: 616d 653d 7374 7265 616d 5f6e 616d 652c  ame=stream_name,
-000008f0: 0a20 2020 2065 7870 6563 7465 645f 706f  .    expected_po
-00000900: 7369 7469 6f6e 3d4e 6f6e 652c 0a20 2020  sition=None,.   
-00000910: 2065 7665 6e74 733d 5b65 7665 6e74 315d   events=[event1]
-00000920: 2c0a 290a 0a0a 2320 4170 7065 6e64 206d  ,.)...# Append m
-00000930: 6f72 6520 6576 656e 7473 2074 6f20 616e  ore events to an
-00000940: 2065 7869 7374 696e 6720 7374 7265 616d   existing stream
-00000950: 2e0a 0a65 7665 6e74 3220 3d20 6573 6462  ...event2 = esdb
-00000960: 636c 6965 6e74 2e4e 6577 4576 656e 7428  client.NewEvent(
-00000970: 7479 7065 3d27 4f72 6465 7255 7064 6174  type='OrderUpdat
-00000980: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
-00000990: 3227 290a 6576 656e 7433 203d 2065 7364  2').event3 = esd
-000009a0: 6263 6c69 656e 742e 4e65 7745 7665 6e74  bclient.NewEvent
-000009b0: 2874 7970 653d 274f 7264 6572 4465 6c65  (type='OrderDele
-000009c0: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
-000009d0: 6133 2729 0a0a 636c 6965 6e74 2e61 7070  a3')..client.app
-000009e0: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
-000009f0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00000a00: 616d 5f6e 616d 652c 0a20 2020 2065 7870  am_name,.    exp
-00000a10: 6563 7465 645f 706f 7369 7469 6f6e 3d30  ected_position=0
-00000a20: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
-00000a30: 656e 7432 2c20 6576 656e 7433 5d2c 0a29  ent2, event3],.)
-00000a40: 0a0a 0a23 2052 6561 6420 616c 6c20 6576  ...# Read all ev
-00000a50: 656e 7473 2072 6563 6f72 6465 6420 696e  ents recorded in
-00000a60: 2061 2073 7472 6561 6d2e 0a0a 7265 636f   a stream...reco
-00000a70: 7264 6564 203d 2063 6c69 656e 742e 7265  rded = client.re
-00000a80: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00000a90: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-00000aa0: 653d 7374 7265 616d 5f6e 616d 650a 290a  e=stream_name.).
-00000ab0: 0a61 7373 6572 7420 6c65 6e28 7265 636f  .assert len(reco
-00000ac0: 7264 6564 2920 3d3d 2033 0a61 7373 6572  rded) == 3.asser
-00000ad0: 7420 7265 636f 7264 6564 5b30 5d2e 6461  t recorded[0].da
-00000ae0: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
-00000af0: 610a 6173 7365 7274 2072 6563 6f72 6465  a.assert recorde
-00000b00: 645b 315d 2e64 6174 6120 3d3d 2065 7665  d[1].data == eve
-00000b10: 6e74 322e 6461 7461 0a61 7373 6572 7420  nt2.data.assert 
-00000b20: 7265 636f 7264 6564 5b32 5d2e 6461 7461  recorded[2].data
-00000b30: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
-00000b40: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
-00000b50: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
-00000b60: 312e 7479 7065 0a61 7373 6572 7420 7265  1.type.assert re
-00000b70: 636f 7264 6564 5b31 5d2e 7479 7065 203d  corded[1].type =
-00000b80: 3d20 6576 656e 7432 2e74 7970 650a 6173  = event2.type.as
-00000b90: 7365 7274 2072 6563 6f72 6465 645b 325d  sert recorded[2]
-00000ba0: 2e74 7970 6520 3d3d 2065 7665 6e74 332e  .type == event3.
-00000bb0: 7479 7065 0a0a 0a23 2049 6e20 616e 2065  type...# In an e
-00000bc0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
-00000bd0: 636f 6d70 6f6e 656e 742c 2075 7365 2061  component, use a
-00000be0: 2022 6361 7463 682d 7570 2220 7375 6273   "catch-up" subs
-00000bf0: 6372 6970 7469 6f6e 0a23 2074 6f20 7265  cription.# to re
-00000c00: 6365 6976 6520 616c 6c20 6576 656e 7473  ceive all events
-00000c10: 2061 6372 6f73 7320 616c 6c20 7374 7265   across all stre
-00000c20: 616d 732c 2069 6e63 6c75 6469 6e67 2065  ams, including e
-00000c30: 7665 6e74 7320 7468 6174 0a23 2068 6176  vents that.# hav
-00000c40: 6520 6e6f 7420 7965 7420 6265 656e 2072  e not yet been r
-00000c50: 6563 6f72 6465 642c 2073 7461 7274 696e  ecorded, startin
-00000c60: 6720 6672 6f6d 2074 6865 2063 6f6d 706f  g from the compo
-00000c70: 6e65 6e74 2773 206c 6173 740a 2320 7361  nent's last.# sa
-00000c80: 7665 6420 2263 6f6d 6d69 7420 706f 7369  ved "commit posi
-00000c90: 7469 6f6e 222e 0a0a 6c61 7374 5f73 6176  tion"...last_sav
-00000ca0: 6564 5f63 6f6d 6d69 745f 706f 7369 7469  ed_commit_positi
-00000cb0: 6f6e 203d 2030 0a0a 7375 6273 6372 6970  on = 0..subscrip
-00000cc0: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
-00000cd0: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
-00000ce0: 7473 280a 2020 2020 636f 6d6d 6974 5f70  ts(.    commit_p
-00000cf0: 6f73 6974 696f 6e3d 6c61 7374 5f73 6176  osition=last_sav
-00000d00: 6564 5f63 6f6d 6d69 745f 706f 7369 7469  ed_commit_positi
-00000d10: 6f6e 0a29 0a0a 2320 546f 2069 6d70 6c65  on.)..# To imple
-00000d20: 6d65 6e74 2022 6578 6163 746c 792d 6f6e  ment "exactly-on
-00000d30: 6365 2220 7365 6d61 6e74 6963 732c 2069  ce" semantics, i
-00000d40: 7465 7261 7465 206f 7665 7220 7468 650a  terate over the.
-00000d50: 2320 2263 6174 6368 2d75 7022 2073 7562  # "catch-up" sub
-00000d60: 7363 7269 7074 696f 6e2e 2050 726f 6365  scription. Proce
-00000d70: 7373 2065 6163 6820 7265 6365 6976 6564  ss each received
-00000d80: 2065 7665 6e74 2c0a 2320 696e 2074 7572   event,.# in tur
-00000d90: 6e2c 2074 6872 6f75 6768 2061 6e20 6576  n, through an ev
-00000da0: 656e 742d 7072 6f63 6573 7369 6e67 2070  ent-processing p
-00000db0: 6f6c 6963 792e 2053 6176 6520 7468 650a  olicy. Save the.
-00000dc0: 2320 7661 6c75 6520 6f66 2074 6865 2063  # value of the c
-00000dd0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2061  ommit_position a
-00000de0: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
-00000df0: 7072 6f63 6573 7365 640a 2320 6576 656e  processed.# even
-00000e00: 7420 7769 7468 206e 6577 2073 7461 7465  t with new state
-00000e10: 2067 656e 6572 6174 6564 2062 7920 7468   generated by th
-00000e20: 6520 706f 6c69 6379 2069 6e20 7468 6520  e policy in the 
-00000e30: 7361 6d65 0a23 2061 746f 6d69 6320 7472  same.# atomic tr
-00000e40: 616e 7361 6374 696f 6e2e 2055 7365 2074  ansaction. Use t
-00000e50: 6865 206c 6173 7420 7361 7665 6420 2263  he last saved "c
-00000e60: 6f6d 6d69 7420 706f 7369 7469 6f6e 220a  ommit position".
-00000e70: 2320 7768 656e 2072 6573 7461 7274 696e  # when restartin
-00000e80: 6720 7468 6520 2263 6174 6368 2d75 7022  g the "catch-up"
-00000e90: 2073 7562 7363 7269 7074 696f 6e2e 0a0a   subscription...
-00000ea0: 7265 6365 6976 6564 203d 205b 5d0a 666f  received = [].fo
-00000eb0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-00000ec0: 7269 7074 696f 6e3a 0a20 2020 2072 6563  ription:.    rec
-00000ed0: 6569 7665 642e 6170 7065 6e64 2865 7665  eived.append(eve
-00000ee0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
-00000ef0: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
-00000f00: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
-00000f10: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-00000f20: 5b2d 335d 2e64 6174 6120 3d3d 2065 7665  [-3].data == eve
-00000f30: 6e74 312e 6461 7461 0a61 7373 6572 7420  nt1.data.assert 
-00000f40: 7265 6365 6976 6564 5b2d 325d 2e64 6174  received[-2].dat
-00000f50: 6120 3d3d 2065 7665 6e74 322e 6461 7461  a == event2.data
-00000f60: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-00000f70: 5b2d 315d 2e64 6174 6120 3d3d 2065 7665  [-1].data == eve
-00000f80: 6e74 332e 6461 7461 0a61 7373 6572 7420  nt3.data.assert 
-00000f90: 7265 6365 6976 6564 5b2d 335d 2e74 7970  received[-3].typ
-00000fa0: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
-00000fb0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-00000fc0: 5b2d 325d 2e74 7970 6520 3d3d 2065 7665  [-2].type == eve
-00000fd0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
-00000fe0: 7265 6365 6976 6564 5b2d 315d 2e74 7970  received[-1].typ
-00000ff0: 6520 3d3d 2065 7665 6e74 332e 7479 7065  e == event3.type
-00001000: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
-00001010: 645b 2d33 5d2e 636f 6d6d 6974 5f70 6f73  d[-3].commit_pos
-00001020: 6974 696f 6e20 3e20 300a 6173 7365 7274  ition > 0.assert
-00001030: 2072 6563 6569 7665 645b 2d32 5d2e 636f   received[-2].co
-00001040: 6d6d 6974 5f70 6f73 6974 696f 6e20 3e20  mmit_position > 
-00001050: 7265 6365 6976 6564 5b2d 335d 2e63 6f6d  received[-3].com
-00001060: 6d69 745f 706f 7369 7469 6f6e 0a61 7373  mit_position.ass
-00001070: 6572 7420 7265 6365 6976 6564 5b2d 315d  ert received[-1]
-00001080: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-00001090: 203e 2072 6563 6569 7665 645b 2d32 5d2e   > received[-2].
-000010a0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e0a  commit_position.
-000010b0: 0a0a 2320 436c 6f73 6520 7468 6520 636c  ..# Close the cl
-000010c0: 6965 6e74 2061 6674 6572 2075 7365 2e0a  ient after use..
-000010d0: 0a63 6c69 656e 742e 636c 6f73 6528 290a  .client.close().
-000010e0: 6060 600a 0a53 6565 2062 656c 6f77 2066  ```..See below f
-000010f0: 6f72 206d 6f72 6520 6465 7461 696c 732e  or more details.
-00001100: 0a0a 466f 7220 616e 2065 7861 6d70 6c65  ..For an example
-00001110: 206f 6620 7573 6167 652c 2073 6565 2074   of usage, see t
-00001120: 6865 205b 6576 656e 7473 6f75 7263 696e  he [eventsourcin
-00001130: 672d 6576 656e 7473 746f 7265 6462 5d28  g-eventstoredb](
-00001140: 0a68 7474 7073 3a2f 2f67 6974 6875 622e  .https://github.
-00001150: 636f 6d2f 7079 6576 656e 7473 6f75 7263  com/pyeventsourc
-00001160: 696e 672f 6576 656e 7473 6f75 7263 696e  ing/eventsourcin
-00001170: 672d 6576 656e 7473 746f 7265 6462 2920  g-eventstoredb) 
-00001180: 7061 636b 6167 652e 0a0a 2323 2054 6162  package...## Tab
-00001190: 6c65 206f 6620 636f 6e74 656e 7473 0a0a  le of contents..
-000011a0: 3c21 2d2d 2054 4f43 202d 2d3e 0a2a 205b  <!-- TOC -->.* [
-000011b0: 496e 7374 616c 6c20 7061 636b 6167 655d  Install package]
-000011c0: 2823 696e 7374 616c 6c2d 7061 636b 6167  (#install-packag
-000011d0: 6529 0a20 202a 205b 4672 6f6d 2050 7950  e).  * [From PyP
-000011e0: 495d 2823 6672 6f6d 2d70 7970 6929 0a20  I](#from-pypi). 
-000011f0: 202a 205b 5769 7468 2050 6f65 7472 795d   * [With Poetry]
-00001200: 2823 7769 7468 2d70 6f65 7472 7929 0a2a  (#with-poetry).*
-00001210: 205b 4576 656e 7453 746f 7265 4442 2073   [EventStoreDB s
-00001220: 6572 7665 725d 2823 6576 656e 7473 746f  erver](#eventsto
-00001230: 7265 6462 2d73 6572 7665 7229 0a20 202a  redb-server).  *
-00001240: 205b 5275 6e20 636f 6e74 6169 6e65 725d   [Run container]
-00001250: 2823 7275 6e2d 636f 6e74 6169 6e65 7229  (#run-container)
-00001260: 0a20 202a 205b 5374 6f70 2063 6f6e 7461  .  * [Stop conta
-00001270: 696e 6572 5d28 2373 746f 702d 636f 6e74  iner](#stop-cont
-00001280: 6169 6e65 7229 0a2a 205b 4576 656e 7453  ainer).* [EventS
-00001290: 746f 7265 4442 2063 6c69 656e 745d 2823  toreDB client](#
-000012a0: 6576 656e 7473 746f 7265 6462 2d63 6c69  eventstoredb-cli
-000012b0: 656e 7429 0a20 202a 205b 496d 706f 7274  ent).  * [Import
-000012c0: 2063 6c61 7373 5d28 2369 6d70 6f72 742d   class](#import-
-000012d0: 636c 6173 7329 0a20 202a 205b 436f 6e73  class).  * [Cons
-000012e0: 7472 7563 7420 636c 6965 6e74 5d28 2363  truct client](#c
-000012f0: 6f6e 7374 7275 6374 2d63 6c69 656e 7429  onstruct-client)
-00001300: 0a2a 205b 5374 7265 616d 735d 2823 7374  .* [Streams](#st
-00001310: 7265 616d 7329 0a20 202a 205b 4170 7065  reams).  * [Appe
-00001320: 6e64 2065 7665 6e74 735d 2823 6170 7065  nd events](#appe
-00001330: 6e64 2d65 7665 6e74 7329 0a20 202a 205b  nd-events).  * [
-00001340: 4170 7065 6e64 2065 7665 6e74 5d28 2361  Append event](#a
-00001350: 7070 656e 642d 6576 656e 7429 0a20 202a  ppend-event).  *
-00001360: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
-00001370: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
-00001380: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
-00001390: 6e64 2d6f 7065 7261 7469 6f6e 7329 0a20  nd-operations). 
-000013a0: 202a 205b 5265 6164 2073 7472 6561 6d20   * [Read stream 
-000013b0: 6576 656e 7473 5d28 2372 6561 642d 7374  events](#read-st
-000013c0: 7265 616d 2d65 7665 6e74 7329 0a20 202a  ream-events).  *
-000013d0: 205b 486f 7720 746f 2069 6d70 6c65 6d65   [How to impleme
-000013e0: 6e74 2073 6e61 7073 686f 7474 696e 6720  nt snapshotting 
-000013f0: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
-00001400: 425d 2823 686f 772d 746f 2d69 6d70 6c65  B](#how-to-imple
-00001410: 6d65 6e74 2d73 6e61 7073 686f 7474 696e  ment-snapshottin
-00001420: 672d 7769 7468 2d65 7665 6e74 7374 6f72  g-with-eventstor
-00001430: 6564 6229 0a20 202a 205b 5265 6164 2061  edb).  * [Read a
-00001440: 6c6c 2065 7665 6e74 735d 2823 7265 6164  ll events](#read
-00001450: 2d61 6c6c 2d65 7665 6e74 7329 0a20 202a  -all-events).  *
-00001460: 205b 4765 7420 6375 7272 656e 7420 7374   [Get current st
-00001470: 7265 616d 2070 6f73 6974 696f 6e5d 2823  ream position](#
-00001480: 6765 742d 6375 7272 656e 742d 7374 7265  get-current-stre
-00001490: 616d 2d70 6f73 6974 696f 6e29 0a20 202a  am-position).  *
-000014a0: 205b 4765 7420 6375 7272 656e 7420 636f   [Get current co
-000014b0: 6d6d 6974 2070 6f73 6974 696f 6e5d 2823  mmit position](#
-000014c0: 6765 742d 6375 7272 656e 742d 636f 6d6d  get-current-comm
-000014d0: 6974 2d70 6f73 6974 696f 6e29 0a20 202a  it-position).  *
-000014e0: 205b 4765 7420 7374 7265 616d 206d 6574   [Get stream met
-000014f0: 6164 6174 615d 2823 6765 742d 7374 7265  adata](#get-stre
-00001500: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
-00001510: 205b 5365 7420 7374 7265 616d 206d 6574   [Set stream met
-00001520: 6164 6174 615d 2823 7365 742d 7374 7265  adata](#set-stre
-00001530: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
-00001540: 205b 4465 6c65 7465 2073 7472 6561 6d5d   [Delete stream]
-00001550: 2823 6465 6c65 7465 2d73 7472 6561 6d29  (#delete-stream)
-00001560: 0a20 202a 205b 546f 6d62 7374 6f6e 6520  .  * [Tombstone 
-00001570: 7374 7265 616d 5d28 2374 6f6d 6273 746f  stream](#tombsto
-00001580: 6e65 2d73 7472 6561 6d29 0a2a 205b 4361  ne-stream).* [Ca
-00001590: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-000015a0: 696f 6e73 5d28 2363 6174 6368 2d75 702d  ions](#catch-up-
-000015b0: 7375 6273 6372 6970 7469 6f6e 7329 0a20  subscriptions). 
-000015c0: 202a 205b 486f 7720 746f 2069 6d70 6c65   * [How to imple
-000015d0: 6d65 6e74 2065 7861 6374 6c79 2d6f 6e63  ment exactly-onc
-000015e0: 6520 6576 656e 7420 7072 6f63 6573 7369  e event processi
-000015f0: 6e67 5d28 2368 6f77 2d74 6f2d 696d 706c  ng](#how-to-impl
-00001600: 656d 656e 742d 6578 6163 746c 792d 6f6e  ement-exactly-on
-00001610: 6365 2d65 7665 6e74 2d70 726f 6365 7373  ce-event-process
-00001620: 696e 6729 0a20 202a 205b 5375 6273 6372  ing).  * [Subscr
-00001630: 6962 6520 616c 6c20 6576 656e 7473 5d28  ibe all events](
-00001640: 2373 7562 7363 7269 6265 2d61 6c6c 2d65  #subscribe-all-e
-00001650: 7665 6e74 7329 0a20 202a 205b 5375 6273  vents).  * [Subs
-00001660: 6372 6962 6520 7374 7265 616d 2065 7665  cribe stream eve
-00001670: 6e74 735d 2823 7375 6273 6372 6962 652d  nts](#subscribe-
-00001680: 7374 7265 616d 2d65 7665 6e74 7329 0a2a  stream-events).*
-00001690: 205b 5065 7273 6973 7465 6e74 2073 7562   [Persistent sub
-000016a0: 7363 7269 7074 696f 6e73 5d28 2370 6572  scriptions](#per
-000016b0: 7369 7374 656e 742d 7375 6273 6372 6970  sistent-subscrip
-000016c0: 7469 6f6e 7329 0a20 202a 205b 4372 6561  tions).  * [Crea
-000016d0: 7465 2073 7562 7363 7269 7074 696f 6e5d  te subscription]
-000016e0: 2823 6372 6561 7465 2d73 7562 7363 7269  (#create-subscri
-000016f0: 7074 696f 6e29 0a20 202a 205b 5265 6164  ption).  * [Read
-00001700: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
-00001710: 7265 6164 2d73 7562 7363 7269 7074 696f  read-subscriptio
-00001720: 6e29 0a20 202a 205b 4765 7420 7375 6273  n).  * [Get subs
-00001730: 6372 6970 7469 6f6e 2069 6e66 6f5d 2823  cription info](#
-00001740: 6765 742d 7375 6273 6372 6970 7469 6f6e  get-subscription
-00001750: 2d69 6e66 6f29 0a20 202a 205b 4c69 7374  -info).  * [List
-00001760: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
-00001770: 236c 6973 742d 7375 6273 6372 6970 7469  #list-subscripti
-00001780: 6f6e 7329 0a20 202a 205b 4465 6c65 7465  ons).  * [Delete
-00001790: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
-000017a0: 6465 6c65 7465 2d73 7562 7363 7269 7074  delete-subscript
-000017b0: 696f 6e29 0a20 202a 205b 5570 6461 7465  ion).  * [Update
-000017c0: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
-000017d0: 7570 6461 7465 2d73 7562 7363 7269 7074  update-subscript
-000017e0: 696f 6e29 0a20 202a 205b 4372 6561 7465  ion).  * [Create
-000017f0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00001800: 7469 6f6e 5d28 2363 7265 6174 652d 7374  tion](#create-st
-00001810: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
-00001820: 6e29 0a20 202a 205b 5265 6164 2073 7472  n).  * [Read str
-00001830: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00001840: 5d28 2372 6561 642d 7374 7265 616d 2d73  ](#read-stream-s
-00001850: 7562 7363 7269 7074 696f 6e29 0a20 202a  ubscription).  *
-00001860: 205b 4765 7420 7374 7265 616d 2073 7562   [Get stream sub
-00001870: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
-00001880: 2367 6574 2d73 7472 6561 6d2d 7375 6273  #get-stream-subs
-00001890: 6372 6970 7469 6f6e 2d69 6e66 6f29 0a20  cription-info). 
-000018a0: 202a 205b 4c69 7374 2073 7472 6561 6d20   * [List stream 
-000018b0: 7375 6273 6372 6970 7469 6f6e 735d 2823  subscriptions](#
-000018c0: 6c69 7374 2d73 7472 6561 6d2d 7375 6273  list-stream-subs
-000018d0: 6372 6970 7469 6f6e 7329 0a20 202a 205b  criptions).  * [
-000018e0: 5570 6461 7465 2073 7472 6561 6d20 7375  Update stream su
-000018f0: 6273 6372 6970 7469 6f6e 5d28 2375 7064  bscription](#upd
-00001900: 6174 652d 7374 7265 616d 2d73 7562 7363  ate-stream-subsc
-00001910: 7269 7074 696f 6e29 0a20 202a 205b 4465  ription).  * [De
-00001920: 6c65 7465 2073 7472 6561 6d20 7375 6273  lete stream subs
-00001930: 6372 6970 7469 6f6e 5d28 2364 656c 6574  cription](#delet
-00001940: 652d 7374 7265 616d 2d73 7562 7363 7269  e-stream-subscri
-00001950: 7074 696f 6e29 0a20 202a 205b 5065 7273  ption).  * [Pers
-00001960: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00001970: 696f 6e20 636f 6e73 756d 6572 5d28 2370  ion consumer](#p
-00001980: 6572 7369 7374 656e 742d 7375 6273 6372  ersistent-subscr
-00001990: 6970 7469 6f6e 2d63 6f6e 7375 6d65 7229  iption-consumer)
-000019a0: 0a2a 205b 436f 6e6e 6563 7469 6f6e 5d28  .* [Connection](
-000019b0: 2363 6f6e 6e65 6374 696f 6e29 0a20 202a  #connection).  *
-000019c0: 205b 5265 636f 6e6e 6563 745d 2823 7265   [Reconnect](#re
-000019d0: 636f 6e6e 6563 7429 0a20 202a 205b 436c  connect).  * [Cl
-000019e0: 6f73 655d 2823 636c 6f73 6529 0a2a 205b  ose](#close).* [
-000019f0: 4e6f 7465 735d 2823 6e6f 7465 7329 0a20  Notes](#notes). 
-00001a00: 202a 205b 436f 6e6e 6563 7469 6f6e 2073   * [Connection s
-00001a10: 7472 696e 6773 5d28 2363 6f6e 6e65 6374  trings](#connect
-00001a20: 696f 6e2d 7374 7269 6e67 7329 0a20 202a  ion-strings).  *
-00001a30: 205b 5265 6775 6c61 7220 6578 7072 6573   [Regular expres
-00001a40: 7369 6f6e 2066 696c 7465 7273 5d28 2372  sion filters](#r
-00001a50: 6567 756c 6172 2d65 7870 7265 7373 696f  egular-expressio
-00001a60: 6e2d 6669 6c74 6572 7329 0a20 202a 205b  n-filters).  * [
-00001a70: 4e65 7720 6576 656e 7420 6f62 6a65 6374  New event object
-00001a80: 735d 2823 6e65 772d 6576 656e 742d 6f62  s](#new-event-ob
-00001a90: 6a65 6374 7329 0a20 202a 205b 5265 636f  jects).  * [Reco
-00001aa0: 7264 6564 2065 7665 6e74 206f 626a 6563  rded event objec
-00001ab0: 7473 5d28 2372 6563 6f72 6465 642d 6576  ts](#recorded-ev
-00001ac0: 656e 742d 6f62 6a65 6374 7329 0a20 202a  ent-objects).  *
-00001ad0: 205b 4173 796e 6369 6f20 636c 6965 6e74   [Asyncio client
-00001ae0: 5d28 2361 7379 6e63 696f 2d63 6c69 656e  ](#asyncio-clien
-00001af0: 7429 0a2a 205b 436f 6e74 7269 6275 746f  t).* [Contributo
-00001b00: 7273 5d28 2363 6f6e 7472 6962 7574 6f72  rs](#contributor
-00001b10: 7329 0a20 202a 205b 496e 7374 616c 6c20  s).  * [Install 
-00001b20: 506f 6574 7279 5d28 2369 6e73 7461 6c6c  Poetry](#install
-00001b30: 2d70 6f65 7472 7929 0a20 202a 205b 5365  -poetry).  * [Se
-00001b40: 7475 7020 666f 7220 5079 4368 6172 6d20  tup for PyCharm 
-00001b50: 7573 6572 735d 2823 7365 7475 702d 666f  users](#setup-fo
-00001b60: 722d 7079 6368 6172 6d2d 7573 6572 7329  r-pycharm-users)
-00001b70: 0a20 202a 205b 5365 7475 7020 6672 6f6d  .  * [Setup from
-00001b80: 2063 6f6d 6d61 6e64 206c 696e 655d 2823   command line](#
-00001b90: 7365 7475 702d 6672 6f6d 2d63 6f6d 6d61  setup-from-comma
-00001ba0: 6e64 2d6c 696e 6529 0a20 202a 205b 5072  nd-line).  * [Pr
-00001bb0: 6f6a 6563 7420 4d61 6b65 6669 6c65 2063  oject Makefile c
-00001bc0: 6f6d 6d61 6e64 735d 2823 7072 6f6a 6563  ommands](#projec
-00001bd0: 742d 6d61 6b65 6669 6c65 2d63 6f6d 6d61  t-makefile-comma
-00001be0: 6e64 7329 0a3c 212d 2d20 544f 4320 2d2d  nds).<!-- TOC --
-00001bf0: 3e0a 0a23 2320 496e 7374 616c 6c20 7061  >..## Install pa
-00001c00: 636b 6167 650a 0a49 7420 6973 2072 6563  ckage..It is rec
-00001c10: 6f6d 6d65 6e64 6564 2074 6f20 696e 7374  ommended to inst
-00001c20: 616c 6c20 5079 7468 6f6e 2070 6163 6b61  all Python packa
-00001c30: 6765 7320 696e 746f 2061 2050 7974 686f  ges into a Pytho
-00001c40: 6e20 7669 7274 7561 6c20 656e 7669 726f  n virtual enviro
-00001c50: 6e6d 656e 742e 0a0a 2323 2320 4672 6f6d  nment...### From
-00001c60: 2050 7950 490a 0a59 6f75 2063 616e 2075   PyPI..You can u
-00001c70: 7365 2070 6970 2074 6f20 696e 7374 616c  se pip to instal
-00001c80: 6c20 7468 6973 2070 6163 6b61 6765 2064  l this package d
-00001c90: 6972 6563 746c 7920 6672 6f6d 0a5b 7468  irectly from.[th
-00001ca0: 6520 5079 7468 6f6e 2050 6163 6b61 6765  e Python Package
-00001cb0: 2049 6e64 6578 5d28 6874 7470 733a 2f2f   Index](https://
-00001cc0: 7079 7069 2e6f 7267 2f70 726f 6a65 6374  pypi.org/project
-00001cd0: 2f65 7364 6263 6c69 656e 742f 292e 0a0a  /esdbclient/)...
-00001ce0: 2020 2020 2420 7069 7020 696e 7374 616c      $ pip instal
-00001cf0: 6c20 6573 6462 636c 6965 6e74 0a0a 2323  l esdbclient..##
-00001d00: 2320 5769 7468 2050 6f65 7472 790a 0a59  # With Poetry..Y
-00001d10: 6f75 2063 616e 2075 7365 2050 6f65 7472  ou can use Poetr
-00001d20: 7920 746f 2061 6464 2074 6869 7320 7061  y to add this pa
-00001d30: 636b 6167 6520 746f 2079 6f75 7220 7079  ckage to your py
-00001d40: 7072 6f6a 6563 742e 746f 6d6c 2061 6e64  project.toml and
-00001d50: 2069 6e73 7461 6c6c 2069 742e 0a0a 2020   install it...  
-00001d60: 2020 2420 706f 6574 7279 2061 6464 2065    $ poetry add e
-00001d70: 7364 6263 6c69 656e 740a 0a23 2320 4576  sdbclient..## Ev
-00001d80: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00001d90: 720a 0a54 6865 2045 7665 6e74 5374 6f72  r..The EventStor
-00001da0: 6544 4220 7365 7276 6572 2063 616e 2062  eDB server can b
-00001db0: 6520 7275 6e20 6c6f 6361 6c6c 7920 7573  e run locally us
-00001dc0: 696e 6720 7468 6520 6f66 6669 6369 616c  ing the official
-00001dd0: 2044 6f63 6b65 7220 636f 6e74 6169 6e65   Docker containe
-00001de0: 7220 696d 6167 652e 0a0a 2323 2320 5275  r image...### Ru
-00001df0: 6e20 636f 6e74 6169 6e65 720a 0a46 6f72  n container..For
-00001e00: 2064 6576 656c 6f70 6d65 6e74 2c20 796f   development, yo
-00001e10: 7520 6361 6e20 7275 6e20 6120 2273 6563  u can run a "sec
-00001e20: 7572 6522 2045 7665 6e74 5374 6f72 6544  ure" EventStoreD
-00001e30: 4220 7365 7276 6572 2075 7369 6e67 2074  B server using t
-00001e40: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
-00001e50: 6d61 6e64 2e0a 0a20 2020 2024 2064 6f63  mand...    $ doc
-00001e60: 6b65 7220 7275 6e20 2d64 202d 2d6e 616d  ker run -d --nam
-00001e70: 6520 6576 656e 7473 746f 7265 6462 2d73  e eventstoredb-s
-00001e80: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
-00001e90: 333a 3231 3133 202d 2d65 6e76 2022 484f  3:2113 --env "HO
-00001ea0: 4d45 3d2f 746d 7022 2065 7665 6e74 7374  ME=/tmp" eventst
-00001eb0: 6f72 652f 6576 656e 7473 746f 7265 3a32  ore/eventstore:2
-00001ec0: 312e 3130 2e39 2d62 7573 7465 722d 736c  1.10.9-buster-sl
-00001ed0: 696d 202d 2d64 6576 0a0a 4173 2077 6520  im --dev..As we 
-00001ee0: 7769 6c6c 2073 6565 2c20 7468 6520 636c  will see, the cl
-00001ef0: 6965 6e74 206e 6565 6473 2061 6e20 4576  ient needs an Ev
-00001f00: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-00001f10: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-00001f20: 2061 7320 7468 6520 7661 6c75 6520 6f66   as the value of
-00001f30: 0a69 7473 2060 7572 6960 2063 6f6e 7374  .its `uri` const
-00001f40: 7275 6374 6f72 2061 7267 756d 656e 742e  ructor argument.
-00001f50: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
-00001f60: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
-00001f70: 2064 6574 6169 6c65 6420 696e 666f 726d   detailed inform
-00001f80: 6174 696f 6e0a 6162 6f75 7420 4576 656e  ation.about Even
-00001f90: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
-00001fa0: 696f 6e20 7374 7269 6e67 2055 5249 732e  ion string URIs.
-00001fb0: 0a0a 5468 6520 636f 6e6e 6563 7469 6f6e  ..The connection
-00001fc0: 2073 7472 696e 6720 666f 7220 7468 6973   string for this
-00001fd0: 2022 7365 6375 7265 2220 4576 656e 7453   "secure" EventS
-00001fe0: 746f 7265 4442 2073 6572 7665 7220 776f  toreDB server wo
-00001ff0: 756c 6420 6265 3a0a 0a20 2020 2065 7364  uld be:..    esd
-00002000: 623a 2f2f 6164 6d69 6e3a 6368 616e 6765  b://admin:change
-00002010: 6974 406c 6f63 616c 686f 7374 3a32 3131  it@localhost:211
-00002020: 330a 0a54 6f20 636f 6e6e 6563 7420 746f  3..To connect to
-00002030: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
-00002040: 6572 2c20 796f 7520 7769 6c6c 2075 7375  er, you will usu
-00002050: 616c 6c79 206e 6565 6420 746f 2069 6e63  ally need to inc
-00002060: 6c75 6465 2061 2022 7573 6572 6e61 6d65  lude a "username
-00002070: 220a 616e 6420 6120 2270 6173 7377 6f72  ".and a "passwor
-00002080: 6422 2069 6e20 7468 6520 636f 6e6e 6563  d" in the connec
-00002090: 7469 6f6e 2073 7472 696e 672c 2073 6f20  tion string, so 
-000020a0: 7468 6174 2074 6865 2073 6572 7665 7220  that the server 
-000020b0: 6361 6e20 6175 7468 656e 7469 6361 7465  can authenticate
-000020c0: 2074 6865 0a63 6c69 656e 742e 2054 6865   the.client. The
-000020d0: 2064 6566 6175 6c74 2075 7365 726e 616d   default usernam
-000020e0: 6520 6973 2022 6164 6d69 6e22 2061 6e64  e is "admin" and
-000020f0: 2074 6865 2064 6566 6175 6c74 2070 6173   the default pas
-00002100: 7377 6f72 6420 6973 2022 6368 616e 6765  sword is "change
-00002110: 6974 222e 0a0a 5768 656e 2063 6f6e 6e65  it"...When conne
-00002120: 6374 696e 6720 746f 2061 2022 7365 6375  cting to a "secu
-00002130: 7265 2220 7365 7276 6572 2c20 7468 6520  re" server, the 
-00002140: 636c 6965 6e74 2061 6c73 6f20 6e65 6564  client also need
-00002150: 7320 616e 2053 534c 2f54 4c53 0a63 6572  s an SSL/TLS.cer
-00002160: 7469 6669 6361 7465 2061 7320 7468 6520  tificate as the 
-00002170: 7661 6c75 6520 6f66 2069 7473 2060 726f  value of its `ro
-00002180: 6f74 5f63 6572 7469 6669 6361 7465 7360  ot_certificates`
-00002190: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
-000021a0: 756d 656e 742e 2054 6f20 636f 6e6e 6563  ument. To connec
-000021b0: 740a 746f 2061 2022 7365 6375 7265 2220  t.to a "secure" 
-000021c0: 7365 7276 6572 2079 6f75 2077 696c 6c20  server you will 
-000021d0: 6e65 6564 2061 6e20 5353 4c2f 544c 5320  need an SSL/TLS 
-000021e0: 6365 7274 6966 6963 6174 6520 736f 2074  certificate so t
-000021f0: 6861 7420 7468 6520 636c 6965 6e74 2063  hat the client c
-00002200: 616e 0a61 7574 6865 6e74 6963 6174 6520  an.authenticate 
-00002210: 7468 6520 7365 7276 6572 2e20 466f 7220  the server. For 
-00002220: 6465 7665 6c6f 706d 656e 742c 2079 6f75  development, you
-00002230: 2063 616e 2065 6974 6865 7220 7573 6520   can either use 
-00002240: 7468 6520 5353 4c2f 544c 5320 6365 7274  the SSL/TLS cert
-00002250: 6966 6963 6174 650a 6f66 2074 6865 2063  ificate.of the c
-00002260: 6572 7469 6669 6361 7465 2061 7574 686f  ertificate autho
-00002270: 7269 7479 2075 7365 6420 746f 2063 7265  rity used to cre
-00002280: 6174 6520 7468 6520 7365 7276 6572 2773  ate the server's
-00002290: 2063 6572 7469 6669 6361 7465 2c20 6f72   certificate, or
-000022a0: 2077 6865 6e20 7573 696e 6720 610a 7369   when using a.si
-000022b0: 6e67 6c65 2d6e 6f64 6520 636c 7573 7465  ngle-node cluste
-000022c0: 722c 2079 6f75 2063 616e 2075 7365 2074  r, you can use t
-000022d0: 6865 2073 6572 7665 7220 6365 7274 6966  he server certif
-000022e0: 6963 6174 6520 6974 7365 6c66 2e20 596f  icate itself. Yo
-000022f0: 7520 6361 6e20 6765 7420 7468 650a 7365  u can get the.se
-00002300: 7276 6572 2063 6572 7469 6669 6361 7465  rver certificate
-00002310: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
-00002320: 696e 6720 5079 7468 6f6e 2063 6f64 652e  ing Python code.
-00002330: 0a0a 0a60 6060 7079 7468 6f6e 0a69 6d70  ...```python.imp
-00002340: 6f72 7420 7373 6c0a 0a73 6572 7665 725f  ort ssl..server_
-00002350: 6365 7274 6966 6963 6174 6520 3d20 7373  certificate = ss
-00002360: 6c2e 6765 745f 7365 7276 6572 5f63 6572  l.get_server_cer
-00002370: 7469 6669 6361 7465 2861 6464 723d 2827  tificate(addr=('
-00002380: 6c6f 6361 6c68 6f73 7427 2c20 3231 3133  localhost', 2113
-00002390: 2929 0a60 6060 0a0a 596f 7520 6361 6e20  )).```..You can 
-000023a0: 616c 736f 2073 7461 7274 2061 6e20 2269  also start an "i
-000023b0: 6e73 6563 7572 6522 2073 6572 7665 7220  nsecure" server 
-000023c0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
-000023d0: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
-000023e0: 2020 2420 646f 636b 6572 2072 756e 202d    $ docker run -
-000023f0: 6420 2d2d 6e61 6d65 2065 7665 6e74 7374  d --name eventst
-00002400: 6f72 6564 622d 696e 7365 6375 7265 202d  oredb-insecure -
-00002410: 6974 202d 7020 3231 3134 3a32 3131 3320  it -p 2114:2113 
-00002420: 6576 656e 7473 746f 7265 2f65 7665 6e74  eventstore/event
-00002430: 7374 6f72 653a 3231 2e31 302e 392d 6275  store:21.10.9-bu
-00002440: 7374 6572 2d73 6c69 6d20 2d2d 696e 7365  ster-slim --inse
-00002450: 6375 7265 0a0a 5468 6520 636f 6e6e 6563  cure..The connec
-00002460: 7469 6f6e 2073 7472 696e 6720 5552 4920  tion string URI 
-00002470: 666f 7220 7468 6973 2022 696e 7365 6375  for this "insecu
-00002480: 7265 2220 7365 7276 6572 2077 6f75 6c64  re" server would
-00002490: 2062 653a 0a0a 2020 2020 6573 6462 3a2f   be:..    esdb:/
-000024a0: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
-000024b0: 546c 733d 6661 6c73 650a 0a41 7320 7765  Tls=false..As we
-000024c0: 2077 696c 6c20 7365 652c 2077 6865 6e20   will see, when 
-000024d0: 636f 6e6e 6563 7469 6e67 2074 6f20 616e  connecting to an
-000024e0: 2022 696e 7365 6375 7265 2220 7365 7276   "insecure" serv
-000024f0: 6572 2c20 7468 6572 6520 6973 206e 6f20  er, there is no 
-00002500: 6e65 6564 2074 6f20 696e 636c 7564 650a  need to include.
-00002510: 6120 2275 7365 726e 616d 6522 2061 6e64  a "username" and
-00002520: 2061 2022 7061 7373 776f 7264 2220 696e   a "password" in
-00002530: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-00002540: 7374 7269 6e67 2e20 4966 2079 6f75 2064  string. If you d
-00002550: 6f2c 2074 6865 7365 2076 616c 7565 7320  o, these values 
-00002560: 7769 6c6c 0a62 6520 6967 6e6f 7265 6420  will.be ignored 
-00002570: 6279 2074 6865 2063 6c69 656e 742c 2073  by the client, s
-00002580: 6f20 7468 6174 2074 6865 7920 7769 6c6c  o that they will
-00002590: 206e 6f74 2062 6520 7365 6e74 2074 6f20   not be sent to 
-000025a0: 7468 6520 7365 7276 6572 206f 7665 7220  the server over 
-000025b0: 616e 0a69 6e73 6563 7572 6520 6368 616e  an.insecure chan
-000025c0: 6e65 6c2e 0a0a 506c 6561 7365 206e 6f74  nel...Please not
-000025d0: 652c 2074 6865 2022 696e 7365 6375 7265  e, the "insecure
-000025e0: 2220 636f 6e6e 6563 7469 6f6e 2073 7472  " connection str
-000025f0: 696e 6720 7573 6573 2061 2071 7565 7279  ing uses a query
-00002600: 2073 7472 696e 6720 7769 7468 2074 6865   string with the
-00002610: 2066 6965 6c64 2d76 616c 7565 0a60 546c   field-value.`Tl
-00002620: 733d 6661 6c73 6560 2e20 5468 6520 7661  s=false`. The va
-00002630: 6c75 6520 6f66 2074 6869 7320 6669 656c  lue of this fiel
-00002640: 6420 6973 2062 7920 6465 6661 756c 7420  d is by default 
-00002650: 6074 7275 6560 2e20 5365 6520 7468 6520  `true`. See the 
-00002660: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-00002670: 6c6f 770a 666f 7220 6d6f 7265 2069 6e66  low.for more inf
-00002680: 6f72 6d61 7469 6f6e 2061 626f 7574 2045  ormation about E
-00002690: 7665 6e74 5374 6f72 6544 4220 636f 6e6e  ventStoreDB conn
-000026a0: 6563 7469 6f6e 2073 7472 696e 6773 2061  ection strings a
-000026b0: 6e64 2074 6865 2066 6965 6c64 7320 7468  nd the fields th
-000026c0: 6174 2063 616e 2062 650a 7573 6564 2069  at can be.used i
-000026d0: 6e20 7468 6520 7175 6572 7920 7374 7269  n the query stri
-000026e0: 6e67 2074 6f20 7370 6563 6966 7920 636f  ng to specify co
-000026f0: 6e6e 6563 7469 6f6e 206f 7074 696f 6e73  nnection options
-00002700: 2e0a 0a23 2323 2053 746f 7020 636f 6e74  ...### Stop cont
-00002710: 6169 6e65 720a 0a54 6f20 7374 6f70 2061  ainer..To stop a
-00002720: 6e64 2072 656d 6f76 6520 7468 6520 2273  nd remove the "s
-00002730: 6563 7572 6522 2063 6f6e 7461 696e 6572  ecure" container
-00002740: 2c20 7573 6520 7468 6520 666f 6c6c 6f77  , use the follow
-00002750: 696e 6720 446f 636b 6572 2063 6f6d 6d61  ing Docker comma
-00002760: 6e64 732e 0a0a 2020 2020 2420 646f 636b  nds...    $ dock
-00002770: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
-00002780: 7265 6462 2d73 6563 7572 650a 0924 2064  redb-secure..$ d
-00002790: 6f63 6b65 7220 726d 2065 7665 6e74 7374  ocker rm eventst
-000027a0: 6f72 6564 622d 7365 6375 7265 0a0a 546f  oredb-secure..To
-000027b0: 2073 746f 7020 616e 6420 7265 6d6f 7665   stop and remove
-000027c0: 2074 6865 2022 696e 7365 6375 7265 2220   the "insecure" 
-000027d0: 636f 6e74 6169 6e65 722c 2075 7365 2074  container, use t
-000027e0: 6865 2066 6f6c 6c6f 7769 6e67 2044 6f63  he following Doc
-000027f0: 6b65 7220 636f 6d6d 616e 6473 2e0a 0a20  ker commands... 
-00002800: 2020 2024 2064 6f63 6b65 7220 7374 6f70     $ docker stop
-00002810: 2065 7665 6e74 7374 6f72 6564 622d 696e   eventstoredb-in
-00002820: 7365 6375 7265 0a09 2420 646f 636b 6572  secure..$ docker
-00002830: 2072 6d20 6576 656e 7473 746f 7265 6462   rm eventstoredb
-00002840: 2d69 6e73 6563 7572 650a 0a0a 2323 2045  -insecure...## E
-00002850: 7665 6e74 5374 6f72 6544 4220 636c 6965  ventStoreDB clie
-00002860: 6e74 0a0a 5468 6973 2045 7665 6e74 5374  nt..This EventSt
-00002870: 6f72 6544 4220 636c 6965 6e74 2069 7320  oreDB client is 
-00002880: 696d 706c 656d 656e 7465 6420 696e 2074  implemented in t
-00002890: 6865 2060 6573 6462 636c 6965 6e74 6020  he `esdbclient` 
-000028a0: 7061 636b 6167 6520 7769 7468 0a74 6865  package with.the
-000028b0: 2060 4553 4442 436c 6965 6e74 6020 636c   `ESDBClient` cl
-000028c0: 6173 732e 0a0a 2323 2320 496d 706f 7274  ass...### Import
-000028d0: 2063 6c61 7373 0a0a 5468 6520 6045 5344   class..The `ESD
-000028e0: 4243 6c69 656e 7460 2063 6c61 7373 2063  BClient` class c
-000028f0: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
-00002900: 726f 6d20 7468 6520 6065 7364 6263 6c69  rom the `esdbcli
-00002910: 656e 7460 2070 6163 6b61 6765 2e0a 0a60  ent` package...`
-00002920: 6060 7079 7468 6f6e 0a66 726f 6d20 6573  ``python.from es
-00002930: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
-00002940: 4553 4442 436c 6965 6e74 0a60 6060 0a0a  ESDBClient.```..
-00002950: 2323 2320 436f 6e73 7472 7563 7420 636c  ### Construct cl
-00002960: 6965 6e74 0a0a 5468 6520 6045 5344 4243  ient..The `ESDBC
-00002970: 6c69 656e 7460 2063 6c61 7373 2063 616e  lient` class can
-00002980: 2062 6520 636f 6e73 7472 7563 7465 6420   be constructed 
-00002990: 7769 7468 2061 2060 7572 6960 2061 7267  with a `uri` arg
-000029a0: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
-000029b0: 7265 7175 6972 6564 2e0a 416e 642c 2074  required..And, t
-000029c0: 6f20 636f 6e6e 6563 7420 746f 2061 2022  o connect to a "
-000029d0: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
-000029e0: 7265 4442 2073 6572 7665 722c 2074 6865  reDB server, the
-000029f0: 206f 7074 696f 6e61 6c20 6072 6f6f 745f   optional `root_
-00002a00: 6365 7274 6966 6963 6174 6573 600a 6172  certificates`.ar
-00002a10: 6775 6d65 6e74 2069 7320 616c 736f 2072  gument is also r
-00002a20: 6571 7569 7265 642e 0a0a 5468 6520 6075  equired...The `u
-00002a30: 7269 6020 6172 6775 6d65 6e74 2069 7320  ri` argument is 
-00002a40: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-00002a50: 6e20 4576 656e 7453 746f 7265 4442 2063  n EventStoreDB c
-00002a60: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00002a70: 2055 5249 2074 6861 740a 636f 6e66 6f72   URI that.confor
-00002a80: 6d73 2077 6974 6820 7468 6520 7374 616e  ms with the stan
-00002a90: 6461 7264 2045 7665 6e74 5374 6f72 6544  dard EventStoreD
-00002aa0: 4220 2265 7364 6222 206f 7220 2265 7364  B "esdb" or "esd
-00002ab0: 622b 6469 7363 6f76 6572 2220 5552 4920  b+discover" URI 
-00002ac0: 7363 6865 6d65 732e 2054 6865 0a73 796e  schemes. The.syn
-00002ad0: 7461 7820 616e 6420 7365 6d61 6e74 6963  tax and semantic
-00002ae0: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
-00002af0: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-00002b00: 696e 6773 2061 7265 2065 7870 6c61 696e  ings are explain
-00002b10: 6564 2069 6e20 7468 6520 4e6f 7465 730a  ed in the Notes.
-00002b20: 7365 6374 696f 6e20 6265 6c6f 772e 0a0a  section below...
-00002b30: 466f 7220 6578 616d 706c 652c 2074 6865  For example, the
-00002b40: 2066 6f6c 6c6f 7769 6e67 2063 6f6e 6e65   following conne
-00002b50: 6374 696f 6e20 7374 7269 6e67 2073 7065  ction string spe
-00002b60: 6369 6669 6573 2074 6861 7420 7468 6520  cifies that the 
-00002b70: 636c 6965 6e74 2073 686f 756c 640a 6174  client should.at
-00002b80: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
-00002b90: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
-00002ba0: 6374 696f 6e20 746f 2070 6f72 7420 3231  ction to port 21
-00002bb0: 3133 206f 6e20 226c 6f63 616c 686f 7374  13 on "localhost
-00002bc0: 222c 2061 6e64 2075 7365 2074 6865 0a63  ", and use the.c
-00002bd0: 6c69 656e 7420 6372 6564 656e 7469 616c  lient credential
-00002be0: 7320 2275 7365 726e 616d 6522 2061 6e64  s "username" and
-00002bf0: 2022 7061 7373 776f 7264 2220 7768 656e   "password" when
-00002c00: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
-00002c10: 2074 6865 2073 6572 7665 722e 0a0a 2020   the server...  
-00002c20: 2020 6573 6462 3a2f 2f75 7365 726e 616d    esdb://usernam
-00002c30: 653a 7061 7373 776f 7264 406c 6f63 616c  e:password@local
-00002c40: 686f 7374 3a32 3131 333f 546c 733d 7472  host:2113?Tls=tr
-00002c50: 7565 0a0a 5468 6520 636c 6965 6e74 206d  ue..The client m
-00002c60: 7573 7420 6265 2063 6f6e 6669 6775 7265  ust be configure
-00002c70: 6420 746f 2063 7265 6174 6520 6120 2273  d to create a "s
-00002c80: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-00002c90: 6e20 746f 2061 2022 7365 6375 7265 2220  n to a "secure" 
-00002ca0: 7365 7276 6572 2c0a 6f72 2061 6c74 6572  server,.or alter
-00002cb0: 6e61 7469 7665 6c79 2061 6e20 2269 6e73  natively an "ins
-00002cc0: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-00002cd0: 6e20 746f 2061 6e20 2269 6e73 6563 7572  n to an "insecur
-00002ce0: 6522 2073 6572 7665 722e 2042 7920 6465  e" server. By de
-00002cf0: 6661 756c 742c 2074 6865 0a63 6c69 656e  fault, the.clien
-00002d00: 7420 7769 6c6c 2061 7474 656d 7074 2074  t will attempt t
-00002d10: 6f20 6372 6561 7465 2061 2022 7365 6375  o create a "secu
-00002d20: 7265 2220 636f 6e6e 6563 7469 6f6e 2e20  re" connection. 
-00002d30: 416e 6420 736f 2c20 7768 656e 2063 6f6e  And so, when con
-00002d40: 6e65 6374 696e 6720 746f 2061 6e0a 2269  necting to an."i
-00002d50: 6e73 6563 7572 6522 2073 6572 7665 722c  nsecure" server,
-00002d60: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-00002d70: 7374 7269 6e67 206d 7573 7420 7370 6563  string must spec
-00002d80: 6966 7920 7468 6174 2074 6865 2063 6c69  ify that the cli
-00002d90: 656e 7420 7368 6f75 6c64 2061 7474 656d  ent should attem
-00002da0: 7074 0a74 6f20 6d61 6b65 2061 6e20 2269  pt.to make an "i
-00002db0: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
-00002dc0: 696f 6e2e 0a0a 5468 6520 666f 6c6c 6f77  ion...The follow
-00002dd0: 696e 6720 636f 6e6e 6563 7469 6f6e 2073  ing connection s
-00002de0: 7472 696e 6720 7370 6563 6966 6965 7320  tring specifies 
-00002df0: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
-00002e00: 7368 6f75 6c64 0a61 7474 656d 7074 2074  should.attempt t
-00002e10: 6f20 6372 6561 7465 2061 6e20 2269 6e73  o create an "ins
-00002e20: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-00002e30: 6e20 746f 2070 6f72 7420 3231 3134 206f  n to port 2114 o
-00002e40: 6e20 226c 6f63 616c 686f 7374 222e 0a57  n "localhost"..W
-00002e50: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
-00002e60: 6f20 616e 2022 696e 7365 6375 7265 2220  o an "insecure" 
-00002e70: 7365 7276 6572 2c20 7468 6520 636c 6965  server, the clie
-00002e80: 6e74 2077 696c 6c20 6967 6e6f 7265 2061  nt will ignore a
-00002e90: 6e79 0a75 7365 726e 616d 6520 616e 6420  ny.username and 
-00002ea0: 7061 7373 776f 7264 2069 6e66 6f72 6d61  password informa
-00002eb0: 7469 6f6e 2069 6e63 6c75 6465 6420 696e  tion included in
-00002ec0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-00002ed0: 7374 7269 6e67 2c0a 736f 2074 6861 7420  string,.so that 
-00002ee0: 7573 6572 6e61 6d65 7320 616e 6420 7061  usernames and pa
-00002ef0: 7373 776f 7264 7320 6172 6520 6e6f 7420  sswords are not 
-00002f00: 7365 6e74 206f 7665 7220 616e 2022 696e  sent over an "in
-00002f10: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-00002f20: 6f6e 2e0a 0a20 2020 2065 7364 623a 2f2f  on...    esdb://
-00002f30: 6c6f 6361 6c68 6f73 743a 3231 3134 3f54  localhost:2114?T
-00002f40: 6c73 3d66 616c 7365 0a0a 506c 6561 7365  ls=false..Please
-00002f50: 206e 6f74 652c 2074 6865 2022 696e 7365   note, the "inse
-00002f60: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
-00002f70: 2073 7472 696e 6720 7573 6573 2061 2071   string uses a q
-00002f80: 7565 7279 2073 7472 696e 6720 7769 7468  uery string with
-00002f90: 2074 6865 2066 6965 6c64 2d76 616c 7565   the field-value
-00002fa0: 0a60 546c 733d 6661 6c73 6560 2e20 5468  .`Tls=false`. Th
-00002fb0: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
-00002fc0: 6669 656c 6420 6973 2062 7920 6465 6661  field is by defa
-00002fd0: 756c 7420 6074 7275 6560 2e20 556e 6c65  ult `true`. Unle
-00002fe0: 7373 2074 6865 2063 6f6e 6e65 6374 696f  ss the connectio
-00002ff0: 6e20 7374 7269 6e67 0a55 5249 2069 6e63  n string.URI inc
-00003000: 6c75 6465 7320 7468 6520 6669 656c 642d  ludes the field-
-00003010: 7661 6c75 6520 6054 6c73 3d66 616c 7365  value `Tls=false
-00003020: 6020 696e 2074 6865 2071 7565 7279 2073  ` in the query s
-00003030: 7472 696e 672c 2074 6865 2060 726f 6f74  tring, the `root
-00003040: 5f63 6572 7469 6669 6361 7465 7360 0a63  _certificates`.c
-00003050: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
-00003060: 656e 7420 6973 2061 6c73 6f20 7265 7175  ent is also requ
-00003070: 6972 6564 2e0a 0a57 6865 6e20 636f 6e6e  ired...When conn
-00003080: 6563 7469 6e67 2074 6f20 6120 2273 6563  ecting to a "sec
-00003090: 7572 6522 2073 6572 7665 722c 2074 6865  ure" server, the
-000030a0: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
-000030b0: 7465 7360 2061 7267 756d 656e 7420 6973  tes` argument is
-000030c0: 2065 7870 6563 7465 6420 746f 0a62 6520   expected to.be 
-000030d0: 6120 5079 7468 6f6e 2060 7374 7260 2063  a Python `str` c
-000030e0: 6f6e 7461 696e 696e 6720 5045 4d20 656e  ontaining PEM en
-000030f0: 636f 6465 6420 5353 4c2f 544c 5320 726f  coded SSL/TLS ro
-00003100: 6f74 2063 6572 7469 6669 6361 7465 732e  ot certificates.
-00003110: 2054 6869 7320 7661 6c75 6520 6973 0a70   This value is.p
-00003120: 6173 7365 6420 6469 7265 6374 6c79 2074  assed directly t
-00003130: 6f20 6067 7270 632e 7373 6c5f 6368 616e  o `grpc.ssl_chan
-00003140: 6e65 6c5f 6372 6564 656e 7469 616c 7328  nel_credentials(
-00003150: 2960 2e20 4974 2069 7320 7573 6564 2066  )`. It is used f
-00003160: 6f72 2061 7574 6865 6e74 6963 6174 696e  or authenticatin
-00003170: 6720 7468 650a 7365 7276 6572 2074 6f20  g the.server to 
-00003180: 7468 6520 636c 6965 6e74 2e20 4974 2069  the client. It i
-00003190: 7320 636f 6d6d 6f6e 6c79 2074 6865 2063  s commonly the c
-000031a0: 6572 7469 6669 6361 7465 206f 6620 7468  ertificate of th
-000031b0: 6520 6365 7274 6966 6963 6174 6520 6175  e certificate au
-000031c0: 7468 6f72 6974 7920 7468 6174 0a77 6173  thority that.was
-000031d0: 2072 6573 706f 6e73 6962 6c65 2066 6f72   responsible for
-000031e0: 2067 656e 6572 6174 696e 6720 7468 6520   generating the 
-000031f0: 5353 4c2f 544c 5320 6365 7274 6966 6963  SSL/TLS certific
-00003200: 6174 6520 7573 6564 2062 7920 7468 6520  ate used by the 
-00003210: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-00003220: 7665 722e 0a42 7574 2c20 616c 7465 726e  ver..But, altern
-00003230: 6174 6976 656c 7920 666f 7220 6465 7665  atively for deve
-00003240: 6c6f 706d 656e 742c 2079 6f75 2063 616e  lopment, you can
-00003250: 2075 7365 2074 6865 2073 6572 7665 7227   use the server'
-00003260: 7320 6365 7274 6966 6963 6174 6520 6974  s certificate it
-00003270: 7365 6c66 2e0a 0a49 6e20 7468 6520 6578  self...In the ex
-00003280: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
-00003290: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
-000032a0: 756d 656e 7420 7661 6c75 6573 2061 7265  ument values are
-000032b0: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
-000032c0: 6f70 6572 6174 696e 670a 7379 7374 656d  operating.system
-000032d0: 2065 6e76 6972 6f6e 6d65 6e74 2e20 5468   environment. Th
-000032e0: 6973 2069 7320 6120 7479 7069 6361 6c20  is is a typical 
-000032f0: 6172 7261 6e67 656d 656e 7420 696e 2061  arrangement in a
-00003300: 2070 726f 6475 6374 696f 6e20 656e 7669   production envi
-00003310: 726f 6e6d 656e 742e 2049 7420 6973 0a64  ronment. It is.d
-00003320: 6f6e 6520 7468 6973 2077 6179 2068 6572  one this way her
-00003330: 6520 736f 2074 6861 7420 7468 6520 636f  e so that the co
-00003340: 6465 2069 6e20 7468 6973 2064 6f63 756d  de in this docum
-00003350: 656e 7461 7469 6f6e 2063 616e 2062 6520  entation can be 
-00003360: 7465 7374 6564 2077 6974 6820 626f 7468  tested with both
-00003370: 0a61 2022 7365 6375 7265 2220 616e 6420  .a "secure" and 
-00003380: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
-00003390: 7276 6572 2e0a 0a60 6060 7079 7468 6f6e  rver...```python
-000033a0: 0a69 6d70 6f72 7420 6f73 0a0a 636c 6965  .import os..clie
-000033b0: 6e74 203d 2045 5344 4243 6c69 656e 7428  nt = ESDBClient(
-000033c0: 0a20 2020 2075 7269 3d6f 732e 6765 7465  .    uri=os.gete
-000033d0: 6e76 2822 4553 4442 5f55 5249 2229 2c0a  nv("ESDB_URI"),.
-000033e0: 2020 2020 726f 6f74 5f63 6572 7469 6669      root_certifi
-000033f0: 6361 7465 733d 6f73 2e67 6574 656e 7628  cates=os.getenv(
-00003400: 2245 5344 425f 524f 4f54 5f43 4552 5449  "ESDB_ROOT_CERTI
-00003410: 4649 4341 5445 5322 292c 0a29 0a60 6060  FICATES"),.).```
-00003420: 0a0a 5365 6520 7468 6520 4e6f 7465 7320  ..See the Notes 
-00003430: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
-00003440: 7220 6465 7461 696c 6564 2069 6e66 6f72  r detailed infor
-00003450: 6d61 7469 6f6e 2061 626f 7574 2045 7665  mation about Eve
-00003460: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
-00003470: 7469 6f6e 0a73 7472 696e 6773 2061 6e64  tion.strings and
-00003480: 2074 6865 2066 6965 6c64 7320 7468 6174   the fields that
-00003490: 2063 616e 2062 6520 7573 6564 2069 6e20   can be used in 
-000034a0: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
-000034b0: 2074 6f20 7370 6563 6966 7920 636f 6e6e   to specify conn
-000034c0: 6563 7469 6f6e 0a6f 7074 696f 6e73 2e0a  ection.options..
-000034d0: 0a23 2320 5374 7265 616d 730a 0a49 6e20  .## Streams..In 
-000034e0: 4576 656e 7453 746f 7265 4442 2c20 6120  EventStoreDB, a 
-000034f0: 2273 7472 6561 6d22 2069 7320 6120 7365  "stream" is a se
-00003500: 7175 656e 6365 206f 6620 7265 636f 7264  quence of record
-00003510: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
-00003520: 6c6c 2068 6176 650a 7468 6520 7361 6d65  ll have.the same
-00003530: 2022 7374 7265 616d 206e 616d 6522 2e20   "stream name". 
-00003540: 5468 6572 6520 7769 6c6c 206e 6f72 6d61  There will norma
-00003550: 6c6c 7920 6265 206d 616e 7920 7374 7265  lly be many stre
-00003560: 616d 7320 696e 2061 2064 6174 6162 6173  ams in a databas
-00003570: 652e 0a45 6163 6820 7265 636f 7264 6564  e..Each recorded
-00003580: 2065 7665 6e74 2068 6173 2061 2022 7374   event has a "st
-00003590: 7265 616d 2070 6f73 6974 696f 6e22 2069  ream position" i
-000035a0: 6e20 6974 7320 7374 7265 616d 2c20 616e  n its stream, an
-000035b0: 6420 6120 2263 6f6d 6d69 7420 706f 7369  d a "commit posi
-000035c0: 7469 6f6e 220a 696e 2074 6865 2064 6174  tion".in the dat
-000035d0: 6162 6173 652e 2054 6865 2073 7472 6561  abase. The strea
-000035e0: 6d20 706f 7369 7469 6f6e 7320 6f66 2074  m positions of t
-000035f0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00003600: 7473 2069 6e20 6120 7374 7265 616d 2069  ts in a stream i
-00003610: 7320 6120 6761 706c 6573 730a 7365 7175  s a gapless.sequ
-00003620: 656e 6365 2073 7461 7274 696e 6720 6672  ence starting fr
-00003630: 6f6d 207a 6572 6f2e 2054 6865 2063 6f6d  om zero. The com
-00003640: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
-00003650: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00003660: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
-00003670: 6261 7365 0a66 6f72 6d20 6120 7365 7175  base.form a sequ
-00003680: 656e 6365 2074 6861 7420 6973 206e 6f74  ence that is not
-00003690: 2067 6170 6c65 7373 2e0a 0a54 6865 206d   gapless...The m
-000036a0: 6574 686f 6473 2060 6170 7065 6e64 5f65  ethods `append_e
-000036b0: 7665 6e74 7328 2960 2c20 6072 6561 645f  vents()`, `read_
-000036c0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-000036d0: 2061 6e64 2060 7265 6164 5f61 6c6c 5f65   and `read_all_e
-000036e0: 7665 6e74 7328 2960 2063 616e 0a62 6520  vents()` can.be 
-000036f0: 7573 6564 2074 6f20 7265 636f 7264 2061  used to record a
-00003700: 6e64 2072 6561 6420 6576 656e 7473 2069  nd read events i
-00003710: 6e20 7468 6520 6461 7461 6261 7365 2e0a  n the database..
-00003720: 0a23 2323 2041 7070 656e 6420 6576 656e  .### Append even
-00003730: 7473 0a0a 2a72 6571 7569 7265 7320 6c65  ts..*requires le
-00003740: 6164 6572 2a0a 0a54 6865 2060 6170 7065  ader*..The `appe
-00003750: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
-00003760: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
-00003770: 746f 2077 7269 7465 2061 2073 6571 7565  to write a seque
-00003780: 6e63 6520 6f66 206e 6577 2065 7665 6e74  nce of new event
-00003790: 7320 6174 6f6d 6963 616c 6c79 0a74 6f20  s atomically.to 
-000037a0: 6120 2273 7472 6561 6d22 2e20 5772 6974  a "stream". Writ
-000037b0: 696e 6720 6e65 7720 6576 656e 7473 2065  ing new events e
-000037c0: 6974 6865 7220 6372 6561 7465 7320 6120  ither creates a 
-000037d0: 7374 7265 616d 2c20 6f72 2061 7070 656e  stream, or appen
-000037e0: 6473 2065 7665 6e74 7320 746f 2074 6865  ds events to the
-000037f0: 2065 6e64 0a6f 6620 6120 7374 7265 616d   end.of a stream
-00003800: 2e20 5468 6973 206d 6574 686f 6420 6973  . This method is
-00003810: 2069 6465 6d70 6f74 656e 742e 0a0a 5468   idempotent...Th
-00003820: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
-00003830: 2075 7365 6420 746f 2072 6563 6f72 6420   used to record 
-00003840: 6174 6f6d 6963 616c 6c79 2061 6c6c 2074  atomically all t
-00003850: 6865 206e 6577 0a65 7665 6e74 7320 7468  he new.events th
-00003860: 6174 2061 7265 2067 656e 6572 6174 6564  at are generated
-00003870: 2077 6865 6e20 6578 6563 7574 696e 6720   when executing 
-00003880: 6120 636f 6d6d 616e 6420 696e 2061 6e20  a command in an 
-00003890: 6170 706c 6963 6174 696f 6e2e 0a0a 5468  application...Th
-000038a0: 7265 6520 6172 6775 6d65 6e74 7320 6172  ree arguments ar
-000038b0: 6520 7265 7175 6972 6564 2c20 6073 7472  e required, `str
-000038c0: 6561 6d5f 6e61 6d65 602c 2060 6578 7065  eam_name`, `expe
-000038d0: 6374 6564 5f70 6f73 6974 696f 6e60 0a61  cted_position`.a
-000038e0: 6e64 2060 6576 656e 7473 602e 0a0a 5468  nd `events`...Th
-000038f0: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
-00003900: 6172 6775 6d65 6e74 2069 7320 7265 7175  argument is requ
-00003910: 6972 6564 2c20 616e 6420 6973 2065 7870  ired, and is exp
-00003920: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-00003930: 7468 6f6e 0a60 7374 7260 2074 6861 7420  thon.`str` that 
-00003940: 756e 6971 7565 6c79 2069 6465 6e74 6966  uniquely identif
-00003950: 6965 7320 7468 6520 7374 7265 616d 2069  ies the stream i
-00003960: 6e20 7468 6520 6461 7461 6261 7365 2e0a  n the database..
-00003970: 0a54 6865 2060 6578 7065 6374 6564 5f70  .The `expected_p
-00003980: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00003990: 7420 6973 2072 6571 7569 7265 642c 2069  t is required, i
-000039a0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-000039b0: 3a20 604e 6f6e 6560 0a69 6620 6576 656e  : `None`.if even
-000039c0: 7473 2061 7265 2062 6569 6e67 2077 7269  ts are being wri
-000039d0: 7474 656e 2074 6f20 6120 6e65 7720 7374  tten to a new st
-000039e0: 7265 616d 2c20 616e 6420 6f74 6865 7277  ream, and otherw
-000039f0: 6973 6520 616e 2050 7974 686f 6e20 6069  ise an Python `i
-00003a00: 6e74 600a 6571 7561 6c20 746f 2074 6865  nt`.equal to the
-00003a10: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-00003a20: 2073 7472 6561 6d20 6f66 2074 6865 206c   stream of the l
-00003a30: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-00003a40: 6e74 2069 6e20 7468 6520 7374 7265 616d  nt in the stream
-00003a50: 2e0a 0a54 6865 2060 6576 656e 7473 6020  ...The `events` 
-00003a60: 6172 6775 6d65 6e74 2069 7320 7265 7175  argument is requ
-00003a70: 6972 6564 2c20 616e 6420 6973 2065 7870  ired, and is exp
-00003a80: 6563 7465 6420 746f 2062 6520 6120 7365  ected to be a se
-00003a90: 7175 656e 6365 206f 6620 6e65 770a 6576  quence of new.ev
-00003aa0: 656e 7420 6f62 6a65 6374 7320 746f 2062  ent objects to b
-00003ab0: 6520 6170 7065 6e64 6564 2074 6f20 7468  e appended to th
-00003ac0: 6520 6e61 6d65 6420 7374 7265 616d 2e20  e named stream. 
-00003ad0: 5468 6520 604e 6577 4576 656e 7460 2063  The `NewEvent` c
-00003ae0: 6c61 7373 2073 686f 756c 640a 6265 2075  lass should.be u
-00003af0: 7365 6420 746f 2063 6f6e 7374 7275 6374  sed to construct
-00003b00: 206e 6577 2065 7665 6e74 206f 626a 6563   new event objec
-00003b10: 7473 2028 7365 6520 7468 6520 4e6f 7465  ts (see the Note
-00003b20: 7320 7365 6374 696f 6e20 6265 6c6f 7720  s section below 
-00003b30: 666f 7220 6465 7461 696c 730a 6f66 2074  for details.of t
-00003b40: 6869 7320 636c 6173 7329 2e0a 0a54 6869  his class)...Thi
-00003b50: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-00003b60: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00003b70: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
-00003b80: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
-00003b90: 2060 666c 6f61 7460 2074 6861 7420 7365   `float` that se
-00003ba0: 7473 0a61 2064 6561 646c 696e 6520 666f  ts.a deadline fo
-00003bb0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00003bc0: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00003bd0: 7261 7469 6f6e 2e0a 0a53 7472 6561 6d73  ration...Streams
-00003be0: 2061 7265 2063 7265 6174 6564 2062 7920   are created by 
-00003bf0: 7772 6974 696e 6720 6576 656e 7473 2e20  writing events. 
-00003c00: 5468 6520 636f 7272 6563 7420 7661 6c75  The correct valu
-00003c10: 6520 6f66 2074 6865 2060 6578 7065 6374  e of the `expect
-00003c20: 6564 5f70 6f73 6974 696f 6e60 0a61 7267  ed_position`.arg
-00003c30: 756d 656e 7420 7768 656e 2077 7269 7469  ument when writi
-00003c40: 6e67 2074 6865 2066 6972 7374 2065 7665  ng the first eve
-00003c50: 6e74 206f 6620 6120 6e65 7720 7374 7265  nt of a new stre
-00003c60: 616d 2069 7320 604e 6f6e 6560 2e20 506c  am is `None`. Pl
-00003c70: 6561 7365 206e 6f74 652c 2069 7420 6973  ease note, it is
-00003c80: 0a6e 6f74 2070 6f73 7369 626c 6520 746f  .not possible to
-00003c90: 2073 6f6d 6568 6f77 2063 7265 6174 6520   somehow create 
-00003ca0: 616e 2022 656d 7074 7922 2073 7472 6561  an "empty" strea
-00003cb0: 6d20 696e 2045 7665 6e74 5374 6f72 6544  m in EventStoreD
-00003cc0: 422e 0a0a 5468 6520 7374 7265 616d 2070  B...The stream p
-00003cd0: 6f73 6974 696f 6e73 206f 6620 7265 636f  ositions of reco
-00003ce0: 7264 6564 2065 7665 6e74 7320 696e 2061  rded events in a
-00003cf0: 2073 7472 6561 6d20 7374 6172 7420 6672   stream start fr
-00003d00: 6f6d 207a 6572 6f2c 2061 6e64 2066 6f72  om zero, and for
-00003d10: 6d20 6120 6761 706c 6573 730a 7365 7175  m a gapless.sequ
-00003d20: 656e 6365 206f 6620 696e 7465 6765 7273  ence of integers
-00003d30: 2e20 5468 6520 7374 7265 616d 2070 6f73  . The stream pos
-00003d40: 6974 696f 6e20 6f66 2074 6865 2066 6972  ition of the fir
-00003d50: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-00003d60: 7420 696e 2061 2073 7472 6561 6d20 6973  t in a stream is
-00003d70: 0a60 3060 2e20 416e 6420 736f 2077 6865  .`0`. And so whe
-00003d80: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
-00003d90: 7365 636f 6e64 206e 6577 2065 7665 6e74  second new event
-00003da0: 2074 6f20 6120 7374 7265 616d 2074 6861   to a stream tha
-00003db0: 7420 6861 7320 6f6e 6520 7265 636f 7264  t has one record
-00003dc0: 6564 2065 7665 6e74 2c0a 7468 6520 636f  ed event,.the co
-00003dd0: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
-00003de0: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003df0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
-00003e00: 6973 2060 3060 2e20 5369 6d69 6c61 726c  is `0`. Similarl
-00003e10: 792c 2074 6865 2073 7472 6561 6d0a 706f  y, the stream.po
-00003e20: 7369 7469 6f6e 206f 6620 7468 6520 7365  sition of the se
-00003e30: 636f 6e64 2072 6563 6f72 6465 6420 6576  cond recorded ev
-00003e40: 656e 7420 696e 2061 2073 7472 6561 6d20  ent in a stream 
-00003e50: 6973 2060 3160 2c20 616e 6420 736f 2077  is `1`, and so w
-00003e60: 6865 6e20 6170 7065 6e64 696e 6720 7468  hen appending th
-00003e70: 650a 7468 6972 6420 6e65 7720 6576 656e  e.third new even
-00003e80: 7420 746f 2061 2073 7472 6561 6d20 7468  t to a stream th
-00003e90: 6174 2068 6173 2074 776f 2072 6563 6f72  at has two recor
-00003ea0: 6465 6420 6576 656e 7473 2c20 7468 6520  ded events, the 
-00003eb0: 636f 7272 6563 7420 7661 6c75 6520 6f66  correct value of
-00003ec0: 2074 6865 0a60 6578 7065 6374 6564 5f70   the.`expected_p
-00003ed0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00003ee0: 7420 6973 2060 3160 2e20 416e 6420 736f  t is `1`. And so
-00003ef0: 206f 6e2e 2e2e 0a0a 4966 2074 6865 7265   on.....If there
-00003f00: 2069 7320 6120 6d69 736d 6174 6368 2062   is a mismatch b
-00003f10: 6574 7765 656e 2074 6865 2067 6976 656e  etween the given
-00003f20: 2076 616c 7565 206f 6620 7468 6520 6065   value of the `e
-00003f30: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00003f40: 6020 6172 6775 6d65 6e74 0a61 6e64 2074  ` argument.and t
-00003f50: 6865 2070 6f73 6974 696f 6e20 6f66 2074  he position of t
-00003f60: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-00003f70: 2065 7665 6e74 2069 6e20 6120 7374 7265   event in a stre
-00003f80: 616d 2c20 7468 656e 2061 6e20 6045 7870  am, then an `Exp
-00003f90: 6563 7465 6450 6f73 6974 696f 6e45 7272  ectedPositionErr
-00003fa0: 6f72 600a 6578 6365 7074 696f 6e20 7769  or`.exception wi
-00003fb0: 6c6c 2062 6520 7261 6973 6564 2e20 5468  ll be raised. Th
-00003fc0: 6973 2065 6666 6563 7469 7665 6c79 2061  is effectively a
-00003fd0: 6363 6f6d 706c 6973 6865 7320 6f70 7469  ccomplishes opti
-00003fe0: 6d69 7374 6963 2063 6f6e 6375 7272 656e  mistic concurren
-00003ff0: 6379 2063 6f6e 7472 6f6c 2e0a 0a49 6620  cy control...If 
-00004000: 796f 7520 7769 7368 2074 6f20 6469 7361  you wish to disa
-00004010: 626c 6520 6f70 7469 6d69 7374 6963 2063  ble optimistic c
-00004020: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
-00004030: 6f6c 2077 6865 6e20 6170 7065 6e64 696e  ol when appendin
-00004040: 6720 6e65 7720 6576 656e 7473 2c20 796f  g new events, yo
-00004050: 750a 6361 6e20 7365 7420 7468 6520 6065  u.can set the `e
-00004060: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00004070: 6020 746f 2061 206e 6567 6174 6976 6520  ` to a negative 
-00004080: 696e 7465 6765 722e 0a0a 4966 2079 6f75  integer...If you
-00004090: 206e 6565 6420 746f 2064 6973 636f 7665   need to discove
-000040a0: 7220 7468 6520 6375 7272 656e 7420 706f  r the current po
-000040b0: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
-000040c0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-000040d0: 7420 696e 2061 2073 7472 6561 6d2c 0a79  t in a stream,.y
-000040e0: 6f75 2063 616e 2075 7365 2074 6865 2060  ou can use the `
-000040f0: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
-00004100: 696f 6e28 2960 206d 6574 686f 642e 0a0a  ion()` method...
-00004110: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-00004120: 2061 7070 656e 6420 6576 656e 7473 206f   append events o
-00004130: 7065 7261 7469 6f6e 2069 7320 6174 6f6d  peration is atom
-00004140: 6963 2c20 736f 2074 6861 7420 6569 7468  ic, so that eith
-00004150: 6572 2061 6c6c 0a6f 7220 6e6f 6e65 206f  er all.or none o
-00004160: 6620 7468 6520 6769 7665 6e20 6e65 7720  f the given new 
-00004170: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-00004180: 6563 6f72 6465 642e 2042 7920 6465 7369  ecorded. By desi
-00004190: 676e 2c20 6974 2069 7320 6f6e 6c79 0a70  gn, it is only.p
-000041a0: 6f73 7369 626c 6520 7769 7468 2045 7665  ossible with Eve
-000041b0: 6e74 5374 6f72 6544 4220 746f 2061 746f  ntStoreDB to ato
-000041c0: 6d69 6361 6c6c 7920 7265 636f 7264 206e  mically record n
-000041d0: 6577 2065 7665 6e74 7320 696e 206f 6e65  ew events in one
-000041e0: 2073 7472 6561 6d2e 0a0a 496e 2074 6865   stream...In the
-000041f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
-00004200: 6120 6e65 7720 6576 656e 7420 6973 2061  a new event is a
-00004210: 7070 656e 6465 6420 746f 2061 206e 6577  ppended to a new
-00004220: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
-00004230: 686f 6e0a 6672 6f6d 2075 7569 6420 696d  hon.from uuid im
-00004240: 706f 7274 2075 7569 6434 0a0a 6672 6f6d  port uuid4..from
-00004250: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-00004260: 7274 204e 6577 4576 656e 740a 0a23 2043  rt NewEvent..# C
-00004270: 6f6e 7374 7275 6374 206e 6577 2065 7665  onstruct new eve
-00004280: 6e74 206f 626a 6563 742e 0a65 7665 6e74  nt object..event
-00004290: 3120 3d20 4e65 7745 7665 6e74 2874 7970  1 = NewEvent(typ
-000042a0: 653d 274f 7264 6572 4372 6561 7465 6427  e='OrderCreated'
-000042b0: 2c20 6461 7461 3d62 2764 6174 6131 2729  , data=b'data1')
-000042c0: 0a0a 2320 4465 6669 6e65 2073 7472 6561  ..# Define strea
-000042d0: 6d20 6e61 6d65 2e0a 7374 7265 616d 5f6e  m name..stream_n
-000042e0: 616d 6531 203d 2073 7472 2875 7569 6434  ame1 = str(uuid4
-000042f0: 2829 290a 0a23 2041 7070 656e 6420 6c69  ())..# Append li
-00004300: 7374 206f 6620 6576 656e 7473 2074 6f20  st of events to 
-00004310: 6e65 7720 7374 7265 616d 2e0a 636f 6d6d  new stream..comm
-00004320: 6974 5f70 6f73 6974 696f 6e31 203d 2063  it_position1 = c
-00004330: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-00004340: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-00004350: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00004360: 312c 0a20 2020 2065 7870 6563 7465 645f  1,.    expected_
-00004370: 706f 7369 7469 6f6e 3d4e 6f6e 652c 0a20  position=None,. 
-00004380: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-00004390: 315d 2c0a 290a 6060 600a 0a49 6e20 7468  1],.).```..In th
-000043a0: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
-000043b0: 2074 776f 2073 7562 7365 7175 656e 7420   two subsequent 
-000043c0: 6576 656e 7473 2061 7265 2061 7070 656e  events are appen
-000043d0: 6465 6420 746f 2061 6e20 6578 6973 7469  ded to an existi
-000043e0: 6e67 0a73 7472 6561 6d2e 0a0a 6060 6070  ng.stream...```p
-000043f0: 7974 686f 6e0a 6576 656e 7432 203d 204e  ython.event2 = N
-00004400: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
-00004410: 6465 7255 7064 6174 6564 272c 2064 6174  derUpdated', dat
-00004420: 613d 6227 6461 7461 3227 290a 6576 656e  a=b'data2').even
-00004430: 7433 203d 204e 6577 4576 656e 7428 7479  t3 = NewEvent(ty
-00004440: 7065 3d27 4f72 6465 7244 656c 6574 6564  pe='OrderDeleted
-00004450: 272c 2064 6174 613d 6227 6461 7461 3327  ', data=b'data3'
-00004460: 290a 0a63 6f6d 6d69 745f 706f 7369 7469  )..commit_positi
-00004470: 6f6e 3220 3d20 636c 6965 6e74 2e61 7070  on2 = client.app
-00004480: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
-00004490: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-000044a0: 616d 5f6e 616d 6531 2c0a 2020 2020 6578  am_name1,.    ex
-000044b0: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-000044c0: 302c 0a20 2020 2065 7665 6e74 733d 5b65  0,.    events=[e
-000044d0: 7665 6e74 322c 2065 7665 6e74 335d 2c0a  vent2, event3],.
-000044e0: 290a 6060 600a 0a49 6620 7468 6520 6f70  ).```..If the op
-000044f0: 6572 6174 696f 6e20 6973 2073 7563 6365  eration is succe
-00004500: 7373 6675 6c2c 2074 6869 7320 6d65 7468  ssful, this meth
-00004510: 6f64 2072 6574 7572 6e73 2061 6e20 696e  od returns an in
-00004520: 7465 6765 720a 7265 7072 6573 656e 7469  teger.representi
-00004530: 6e67 2074 6865 2064 6174 6162 6173 6520  ng the database 
-00004540: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
-00004550: 2220 6173 2069 7420 7761 7320 7768 656e  " as it was when
-00004560: 2074 6865 206f 7065 7261 7469 6f6e 0a77   the operation.w
-00004570: 6173 2063 6f6d 706c 6574 6564 2e0a 0a41  as completed...A
-00004580: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-00004590: 6e22 2069 7320 6120 6d6f 6e6f 746f 6e69  n" is a monotoni
-000045a0: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
-000045b0: 2069 6e74 6567 6572 2072 6570 7265 7365   integer represe
-000045c0: 6e74 696e 670a 7468 6520 706f 7369 7469  nting.the positi
-000045d0: 6f6e 206f 6620 7468 6520 7265 636f 7264  on of the record
-000045e0: 6564 2065 7665 6e74 2069 6e20 6120 2274  ed event in a "t
-000045f0: 6f74 616c 206f 7264 6572 2220 6f66 2061  otal order" of a
-00004600: 6c6c 2072 6563 6f72 6465 640a 6576 656e  ll recorded.even
-00004610: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
-00004620: 7365 2061 6372 6f73 7320 616c 6c20 7374  se across all st
-00004630: 7265 616d 732e 2049 7420 6973 2074 6865  reams. It is the
-00004640: 2061 6374 7561 6c20 706f 7369 7469 6f6e   actual position
-00004650: 0a6f 6620 7468 6520 6576 656e 7420 7265  .of the event re
-00004660: 636f 7264 206f 6e20 6469 736b 2e20 496e  cord on disk. In
-00004670: 2063 6f6e 7365 7175 656e 6365 2c20 7468   consequence, th
-00004680: 6520 7365 7175 656e 6365 206f 6620 636f  e sequence of co
-00004690: 6d6d 6974 0a70 6f73 6974 696f 6e73 2069  mmit.positions i
-000046a0: 7320 6e6f 7420 6761 706c 6573 732e 2049  s not gapless. I
-000046b0: 6e64 6565 642c 2074 6865 7265 2061 7265  ndeed, there are
-000046c0: 2075 7375 616c 6c79 206c 6172 6765 2064   usually large d
-000046d0: 6966 6665 7265 6e63 6573 0a62 6574 7765  ifferences.betwe
-000046e0: 656e 2074 6865 2063 6f6d 6d69 7420 706f  en the commit po
-000046f0: 7369 7469 6f6e 7320 6f66 2073 7563 6365  sitions of succe
-00004700: 7373 6976 6520 7265 636f 7264 6564 2065  ssive recorded e
-00004710: 7665 6e74 732e 0a0a 5468 6520 2263 6f6d  vents...The "com
-00004720: 6d69 7420 706f 7369 7469 6f6e 2220 7265  mit position" re
-00004730: 7475 726e 6564 2062 7920 6061 7070 656e  turned by `appen
-00004740: 645f 6576 656e 7473 2829 6020 6973 2074  d_events()` is t
-00004750: 6861 7420 6f66 2074 6865 206c 6173 740a  hat of the last.
-00004760: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
-00004770: 6e20 7468 6520 6769 7665 6e20 6261 7463  n the given batc
-00004780: 6820 6f66 206e 6577 2065 7665 6e74 732e  h of new events.
-00004790: 0a0a 5468 6520 2263 6f6d 6d69 7420 706f  ..The "commit po
-000047a0: 7369 7469 6f6e 2220 7265 7475 726e 6564  sition" returned
-000047b0: 2069 6e20 7468 6973 2077 6179 2063 616e   in this way can
-000047c0: 2074 6865 7265 666f 7265 2062 6520 7573   therefore be us
-000047d0: 6564 2074 6f20 7761 6974 0a66 6f72 2061  ed to wait.for a
-000047e0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-000047f0: 6f6e 656e 7420 746f 2068 6176 6520 7072  onent to have pr
-00004800: 6f63 6573 7365 6420 616c 6c20 7468 6520  ocessed all the 
-00004810: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-00004820: 2072 6563 6f72 6465 642e 0a0a 466f 7220   recorded...For 
-00004830: 6578 616d 706c 652c 2063 6f6e 7369 6465  example, conside
-00004840: 7220 6120 7573 6572 2069 6e74 6572 6661  r a user interfa
-00004850: 6365 2063 6f6d 6d61 6e64 2074 6861 7420  ce command that 
-00004860: 7265 7375 6c74 7320 696e 2074 6865 2072  results in the r
-00004870: 6563 6f72 6469 6e67 0a6f 6620 6e65 7720  ecording.of new 
-00004880: 6576 656e 7473 2c20 616e 6420 6120 7175  events, and a qu
-00004890: 6572 7920 696e 746f 2061 6e20 6576 656e  ery into an even
-000048a0: 7475 616c 6c79 2063 6f6e 7369 7374 656e  tually consisten
-000048b0: 7420 6d61 7465 7269 616c 697a 6564 0a76  t materialized.v
-000048c0: 6965 7720 696e 2061 2064 6f77 6e73 7472  iew in a downstr
-000048d0: 6561 6d20 636f 6d70 6f6e 656e 7420 7468  eam component th
-000048e0: 6174 2069 7320 7570 6461 7465 6420 6672  at is updated fr
-000048f0: 6f6d 2074 6865 7365 2065 7665 6e74 732e  om these events.
-00004900: 2049 6620 7468 6520 6e65 770a 6576 656e   If the new.even
-00004910: 7473 2068 6176 6520 6e6f 7420 7965 7420  ts have not yet 
-00004920: 6265 656e 2070 726f 6365 7373 6564 2c20  been processed, 
-00004930: 7468 6520 7669 6577 2077 6f75 6c64 2062  the view would b
-00004940: 6520 7374 616c 652e 2054 6865 2022 636f  e stale. The "co
-00004950: 6d6d 6974 2070 6f73 6974 696f 6e22 0a63  mmit position".c
-00004960: 616e 2062 6520 7573 6564 2062 7920 7468  an be used by th
-00004970: 6520 7573 6572 2069 6e74 6572 6661 6365  e user interface
-00004980: 2074 6f20 706f 6c6c 2074 6865 2064 6f77   to poll the dow
-00004990: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-000049a0: 7420 756e 7469 6c20 6974 2068 6173 0a70  t until it has.p
-000049b0: 726f 6365 7373 6564 2074 686f 7365 206e  rocessed those n
-000049c0: 6577 2065 7665 6e74 732c 2061 6674 6572  ew events, after
-000049d0: 2077 6869 6368 2074 696d 6520 7468 6520   which time the 
-000049e0: 7669 6577 2077 696c 6c20 6e6f 7420 6265  view will not be
-000049f0: 2073 7461 6c65 2e0a 0a0a 2323 2320 4170   stale....### Ap
-00004a00: 7065 6e64 2065 7665 6e74 0a0a 2a72 6571  pend event..*req
-00004a10: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-00004a20: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
-00004a30: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00004a40: 6520 7573 6564 2074 6f20 7772 6974 6520  e used to write 
-00004a50: 6120 7369 6e67 6c65 206e 6577 2065 7665  a single new eve
-00004a60: 6e74 2074 6f20 6120 7374 7265 616d 2e0a  nt to a stream..
-00004a70: 0a54 6872 6565 2061 7267 756d 656e 7473  .Three arguments
-00004a80: 2061 7265 2072 6571 7569 7265 642c 2060   are required, `
-00004a90: 7374 7265 616d 5f6e 616d 6560 2c20 6065  stream_name`, `e
-00004aa0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00004ab0: 6020 616e 6420 6065 7665 6e74 602e 0a0a  ` and `event`...
-00004ac0: 5468 6973 206d 6574 686f 6420 776f 726b  This method work
-00004ad0: 7320 696e 2074 6865 2073 616d 6520 7761  s in the same wa
-00004ae0: 7920 6173 2060 6170 7065 6e64 5f65 7665  y as `append_eve
-00004af0: 6e74 7328 2960 2c20 686f 7765 7665 7220  nts()`, however 
-00004b00: 6065 7665 6e74 6020 6973 2065 7870 6563  `event` is expec
-00004b10: 7465 640a 746f 2062 6520 6120 7369 6e67  ted.to be a sing
-00004b20: 6c65 2060 4e65 7745 7665 6e74 602e 0a0a  le `NewEvent`...
-00004b30: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-00004b40: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-00004b50: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-00004b60: 2c20 7768 6963 6820 6973 2061 2050 7974  , which is a Pyt
-00004b70: 686f 6e20 6066 6c6f 6174 6020 7468 6174  hon `float` that
-00004b80: 2073 6574 730a 6120 6465 6164 6c69 6e65   sets.a deadline
-00004b90: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-00004ba0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00004bb0: 6f70 6572 6174 696f 6e2e 0a0a 4966 2074  operation...If t
-00004bc0: 6865 206f 7065 7261 7469 6f6e 2069 7320  he operation is 
-00004bd0: 7375 6363 6573 7366 756c 2c20 7468 6973  successful, this
-00004be0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
-00004bf0: 616e 2069 6e74 6567 6572 0a72 6570 7265  an integer.repre
-00004c00: 7365 6e74 696e 6720 7468 6520 6461 7461  senting the data
-00004c10: 6261 7365 2022 636f 6d6d 6974 2070 6f73  base "commit pos
-00004c20: 6974 696f 6e22 2061 7320 6974 2077 6173  ition" as it was
-00004c30: 2077 6865 6e20 7468 6520 6f70 6572 6174   when the operat
-00004c40: 696f 6e0a 7761 7320 636f 6d70 6c65 7465  ion.was complete
-00004c50: 642e 0a0a 5369 6e63 6520 7468 6520 6861  d...Since the ha
-00004c60: 6e64 6c69 6e67 206f 6620 6120 636f 6d6d  ndling of a comm
-00004c70: 616e 6420 696e 2079 6f75 7220 6170 706c  and in your appl
-00004c80: 6963 6174 696f 6e20 6d61 7920 7265 7375  ication may resu
-00004c90: 6c74 2069 6e20 6f6e 6520 6f72 206d 616e  lt in one or man
-00004ca0: 790a 6e65 7720 6576 656e 7473 2c20 616e  y.new events, an
-00004cb0: 6420 7468 6520 7265 7375 6c74 7320 6f66  d the results of
-00004cc0: 2068 616e 646c 696e 6720 6120 636f 6d6d   handling a comm
-00004cd0: 616e 6420 7368 6f75 6c64 2062 6520 7265  and should be re
-00004ce0: 636f 7264 6564 2061 746f 6d69 6361 6c6c  corded atomicall
-00004cf0: 792c 0a61 6e64 2074 6865 2077 7269 7469  y,.and the writi
-00004d00: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
-00004d10: 2067 656e 6572 6174 6564 2062 7920 6120   generated by a 
-00004d20: 636f 6d6d 616e 6420 6861 6e64 6c65 7220  command handler 
-00004d30: 6973 2075 7375 616c 6c79 2061 2063 6f6e  is usually a con
-00004d40: 6365 726e 0a74 6861 7420 6973 2066 6163  cern.that is fac
-00004d50: 746f 7265 6420 6f75 7420 616e 6420 7573  tored out and us
-00004d60: 6564 2065 7665 7279 7768 6572 6520 696e  ed everywhere in
-00004d70: 2061 2070 726f 6a65 6374 2c20 6974 2069   a project, it i
-00004d80: 7320 6d6f 7265 2075 7375 616c 2069 6e20  s more usual in 
-00004d90: 6120 7072 6f6a 6563 740a 746f 2075 7365  a project.to use
-00004da0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
-00004db0: 2960 2074 6f20 7265 636f 7264 206e 6577  )` to record new
-00004dc0: 2065 7665 6e74 732e 2048 6f77 6576 6572   events. However
-00004dd0: 2c20 7468 6973 206d 6574 686f 6420 6d61  , this method ma
-00004de0: 7920 6f63 6361 7369 6f6e 616c 6c79 0a62  y occasionally.b
-00004df0: 6520 7573 6566 756c 2c20 616e 6420 696e  e useful, and in
-00004e00: 6465 6564 2069 7420 6973 2075 7365 6420  deed it is used 
-00004e10: 6279 2060 7365 745f 7374 7265 616d 5f6d  by `set_stream_m
-00004e20: 6574 6164 6174 6128 2960 2e0a 0a0a 2323  etadata()`....##
-00004e30: 2320 4964 656d 706f 7465 6e74 2061 7070  # Idempotent app
-00004e40: 656e 6420 6f70 6572 6174 696f 6e73 0a0a  end operations..
-00004e50: 536f 6d65 7469 6d65 7320 6974 206d 6179  Sometimes it may
-00004e60: 2068 6170 7065 6e20 7468 6174 2c20 7768   happen that, wh
-00004e70: 656e 2063 616c 6c69 6e67 2060 6170 7065  en calling `appe
-00004e80: 6e64 5f65 7665 6e74 7328 2960 206f 7220  nd_events()` or 
-00004e90: 6061 7070 656e 645f 6576 656e 7428 2960  `append_event()`
-00004ea0: 2c0a 7468 6520 6e65 7720 6576 656e 7473  ,.the new events
-00004eb0: 2061 7265 2073 7563 6365 7373 6675 6c6c   are successfull
-00004ec0: 7920 7265 636f 7264 6564 2c20 6275 7420  y recorded, but 
-00004ed0: 7468 656e 2073 6f6d 6568 6f77 2074 6865  then somehow the
-00004ee0: 2063 6f6e 6e65 6374 696f 6e20 746f 2074   connection to t
-00004ef0: 6865 0a64 6174 6162 6173 6520 6765 7473  he.database gets
-00004f00: 2069 6e74 6572 7275 7074 6564 2062 6566   interrupted bef
-00004f10: 6f72 6520 7468 6520 7375 6363 6573 7366  ore the successf
-00004f20: 756c 2063 616c 6c20 6361 6e20 7265 7475  ul call can retu
-00004f30: 726e 2073 7563 6365 7373 6675 6c6c 7920  rn successfully 
-00004f40: 746f 0a74 6865 2063 6c69 656e 742e 2049  to.the client. I
-00004f50: 6e20 6361 7365 206f 6620 616e 2065 7272  n case of an err
-00004f60: 6f72 2077 6865 6e20 6170 7065 6e64 696e  or when appendin
-00004f70: 6720 616e 2065 7665 6e74 2c20 6974 2069  g an event, it i
-00004f80: 7320 6465 7369 7261 626c 6520 746f 0a72  s desirable to.r
-00004f90: 6574 7279 2061 7070 656e 6469 6e67 2074  etry appending t
-00004fa0: 6865 2073 616d 6520 6576 656e 7420 6174  he same event at
-00004fb0: 2074 6865 2073 616d 6520 706f 7369 7469   the same positi
-00004fc0: 6f6e 2e20 4966 2074 6865 2065 7665 6e74  on. If the event
-00004fd0: 2077 6173 2069 6e20 6661 6374 0a73 7563   was in fact.suc
-00004fe0: 6365 7373 6675 6c6c 7920 7265 636f 7264  cessfully record
-00004ff0: 6564 2c20 6974 2069 7320 636f 6e76 656e  ed, it is conven
-00005000: 6965 6e74 2066 6f72 2074 6865 2072 6574  ient for the ret
-00005010: 7269 6564 206f 7065 7261 7469 6f6e 2074  ried operation t
-00005020: 6f20 7265 7475 726e 0a73 7563 6365 7373  o return.success
-00005030: 6675 6c6c 7920 7769 7468 6f75 7420 7261  fully without ra
-00005040: 6973 696e 6720 616e 2065 7272 6f72 2064  ising an error d
-00005050: 7565 2074 6f20 6f70 7469 6d69 7374 6963  ue to optimistic
-00005060: 2063 6f6e 6375 7272 656e 6379 2063 6f6e   concurrency con
-00005070: 7472 6f6c 0a28 6173 2064 6573 6372 6962  trol.(as describ
-00005080: 6564 2061 626f 7665 292e 0a0a 5468 6520  ed above)...The 
-00005090: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-000050a0: 6f77 7320 7468 6520 6061 7070 656e 645f  ows the `append_
-000050b0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
-000050c0: 2062 6569 6e67 2063 616c 6c65 6420 6167   being called ag
-000050d0: 6169 6e20 7769 7468 0a60 6576 656e 7433  ain with.`event3
-000050e0: 6020 616e 6420 6065 7870 6563 7465 645f  ` and `expected_
-000050f0: 706f 7369 7469 6f6e 3d32 602e 2057 6520  position=2`. We 
-00005100: 6361 6e20 7365 6520 7468 6174 2072 6570  can see that rep
-00005110: 6561 7469 6e67 2074 6865 2063 616c 6c20  eating the call 
-00005120: 746f 0a60 6170 7065 6e64 5f65 7665 6e74  to.`append_event
-00005130: 7328 2960 2072 6574 7572 6e73 2073 7563  s()` returns suc
-00005140: 6365 7373 6675 6c6c 792e 0a0a 6060 6070  cessfully...```p
-00005150: 7974 686f 6e0a 2320 5265 7472 7920 6170  ython.# Retry ap
-00005160: 7065 6e64 696e 6720 6576 656e 7433 2e0a  pending event3..
-00005170: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5f  commit_position_
-00005180: 7265 7472 7920 3d20 636c 6965 6e74 2e61  retry = client.a
-00005190: 7070 656e 645f 6576 656e 7473 280a 2020  ppend_events(.  
-000051a0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-000051b0: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
-000051c0: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-000051d0: 6e3d 302c 0a20 2020 2065 7665 6e74 733d  n=0,.    events=
-000051e0: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
-000051f0: 2c0a 290a 6060 600a 0a57 6520 6361 6e20  ,.).```..We can 
-00005200: 7365 6520 7468 6174 2074 6865 2073 616d  see that the sam
-00005210: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00005220: 6e20 6973 2072 6574 7572 6e65 6420 6173  n is returned as
-00005230: 2061 626f 7665 2e0a 0a60 6060 7079 7468   above...```pyth
-00005240: 6f6e 0a61 7373 6572 7420 636f 6d6d 6974  on.assert commit
-00005250: 5f70 6f73 6974 696f 6e5f 7265 7472 7920  _position_retry 
-00005260: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
-00005270: 6f6e 320a 6060 600a 0a42 7920 6361 6c6c  on2.```..By call
-00005280: 696e 6720 6072 6561 645f 7374 7265 616d  ing `read_stream
-00005290: 5f65 7665 6e74 7328 2960 2c20 7765 2063  _events()`, we c
-000052a0: 616e 2061 6c73 6f20 7365 6520 7468 6520  an also see the 
-000052b0: 7374 7265 616d 2068 6173 2062 6565 6e20  stream has been 
-000052c0: 756e 6368 616e 6765 640a 6465 7370 6974  unchanged.despit
-000052d0: 6520 7468 6520 6061 7070 656e 645f 6576  e the `append_ev
-000052e0: 656e 7473 2829 6020 6d65 7468 6f64 2068  ents()` method h
-000052f0: 6176 696e 6720 6265 656e 2063 616c 6c65  aving been calle
-00005300: 6420 7477 6963 6520 7769 7468 2074 6865  d twice with the
-00005310: 2073 616d 6520 6172 6775 6d65 6e74 732e   same arguments.
-00005320: 0a54 6861 7420 6973 2c20 7468 6572 6520  .That is, there 
-00005330: 6172 6520 7374 696c 6c20 6f6e 6c79 2074  are still only t
-00005340: 6872 6565 2065 7665 6e74 7320 696e 2074  hree events in t
-00005350: 6865 2073 7472 6561 6d2e 0a0a 6060 6070  he stream...```p
-00005360: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
-00005370: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
-00005380: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
-00005390: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-000053a0: 5f6e 616d 6531 0a29 0a0a 6173 7365 7274  _name1.)..assert
-000053b0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-000053c0: 330a 6060 600a 0a54 6869 7320 6964 656d  3.```..This idem
-000053d0: 706f 7465 6e74 2062 6568 6176 696f 7572  potent behaviour
-000053e0: 2069 7320 6163 7469 7661 7465 6420 6265   is activated be
-000053f0: 6361 7573 6520 7468 6520 604e 6577 4576  cause the `NewEv
-00005400: 656e 7460 2063 6c61 7373 2068 6173 2061  ent` class has a
-00005410: 6e20 6069 6460 0a61 7474 7269 6275 7465  n `id`.attribute
-00005420: 2074 6861 742c 2062 7920 6465 6661 756c   that, by defaul
-00005430: 742c 2069 7320 6173 7369 676e 6564 2061  t, is assigned a
-00005440: 206e 6577 2061 6e64 2075 6e69 7175 6520   new and unique 
-00005450: 7665 7273 696f 6e2d 3420 5555 4944 2077  version-4 UUID w
-00005460: 6865 6e20 616e 0a69 6e73 7461 6e63 6520  hen an.instance 
-00005470: 6f66 2060 4e65 7745 7665 6e74 6020 6973  of `NewEvent` is
-00005480: 2063 6f6e 7374 7275 6374 6564 2e20 4966   constructed. If
-00005490: 2065 7665 6e74 7320 7769 7468 2074 6865   events with the
-000054a0: 2073 616d 6520 6069 6460 2061 7265 2061   same `id` are a
-000054b0: 7070 656e 6465 640a 6174 2074 6865 2073  ppended.at the s
-000054c0: 616d 6520 6065 7870 6563 7465 645f 706f  ame `expected_po
-000054d0: 7369 7469 6f6e 602c 2074 6865 2073 7472  sition`, the str
-000054e0: 6561 6d20 7769 6c6c 2062 6520 756e 6368  eam will be unch
-000054f0: 616e 6765 642c 2074 6865 206f 7065 7261  anged, the opera
-00005500: 7469 6f6e 2077 696c 6c0a 636f 6d70 6c65  tion will.comple
-00005510: 7465 2073 7563 6365 7373 6675 6c6c 792c  te successfully,
-00005520: 2061 6e64 2074 6865 2073 616d 6520 636f   and the same co
-00005530: 6d6d 6974 2070 6f73 6974 696f 6e20 7769  mmit position wi
-00005540: 6c6c 2062 6520 7265 7475 726e 6564 2074  ll be returned t
-00005550: 6f20 7468 6520 6361 6c6c 6572 2e0a 0a60  o the caller...`
-00005560: 6060 7079 7468 6f6e 0a66 726f 6d20 7575  ``python.from uu
-00005570: 6964 2069 6d70 6f72 7420 5555 4944 0a0a  id import UUID..
-00005580: 0a61 7373 6572 7420 6973 696e 7374 616e  .assert isinstan
-00005590: 6365 2865 7665 6e74 312e 6964 2c20 5555  ce(event1.id, UU
-000055a0: 4944 290a 6173 7365 7274 2069 7369 6e73  ID).assert isins
-000055b0: 7461 6e63 6528 6576 656e 7432 2e69 642c  tance(event2.id,
-000055c0: 2055 5549 4429 0a61 7373 6572 7420 6973   UUID).assert is
-000055d0: 696e 7374 616e 6365 2865 7665 6e74 332e  instance(event3.
-000055e0: 6964 2c20 5555 4944 290a 0a61 7373 6572  id, UUID)..asser
-000055f0: 7420 6576 656e 7431 2e69 6420 213d 2065  t event1.id != e
-00005600: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
-00005610: 6576 656e 7432 2e69 6420 213d 2065 7665  event2.id != eve
-00005620: 6e74 332e 6964 0a0a 6173 7365 7274 2065  nt3.id..assert e
-00005630: 7665 6e74 735b 305d 2e69 6420 3d3d 2065  vents[0].id == e
-00005640: 7665 6e74 312e 6964 0a61 7373 6572 7420  vent1.id.assert 
-00005650: 6576 656e 7473 5b31 5d2e 6964 203d 3d20  events[1].id == 
-00005660: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
-00005670: 2065 7665 6e74 735b 325d 2e69 6420 3d3d   events[2].id ==
-00005680: 2065 7665 6e74 332e 6964 0a60 6060 0a0a   event3.id.```..
-00005690: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
-000056a0: 6f20 7365 7420 7468 6520 6069 6460 2063  o set the `id` c
-000056b0: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
-000056c0: 656e 7420 6f66 2060 4e65 7745 7665 6e74  ent of `NewEvent
-000056d0: 6020 7768 656e 2069 6e73 7461 6e74 6961  ` when instantia
-000056e0: 7469 6e67 0a74 6865 2060 4e65 7745 7665  ting.the `NewEve
-000056f0: 6e74 6020 636c 6173 732c 2062 7574 2069  nt` class, but i
-00005700: 6e20 7468 6520 6578 616d 706c 6573 2061  n the examples a
-00005710: 626f 7665 2077 6520 6861 7665 2062 6565  bove we have bee
-00005720: 6e20 7573 696e 6720 7468 6520 6465 6661  n using the defa
-00005730: 756c 740a 6265 6861 7669 6f75 722c 2077  ult.behaviour, w
-00005740: 6869 6368 2069 7320 7468 6174 2074 6865  hich is that the
-00005750: 2060 6964 6020 7661 6c75 6520 6973 2067   `id` value is g
-00005760: 656e 6572 6174 6564 2077 6865 6e20 7468  enerated when th
-00005770: 6520 604e 6577 4576 656e 7460 2063 6c61  e `NewEvent` cla
-00005780: 7373 2069 730a 696e 7374 616e 7469 6174  ss is.instantiat
-00005790: 6564 2e0a 0a0a 2323 2320 5265 6164 2073  ed....### Read s
-000057a0: 7472 6561 6d20 6576 656e 7473 0a0a 5468  tream events..Th
-000057b0: 6520 6072 6561 645f 7374 7265 616d 5f65  e `read_stream_e
-000057c0: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
-000057d0: 6361 6e20 6265 2075 7365 6420 746f 206f  can be used to o
-000057e0: 6274 6169 6e20 7468 6520 7265 636f 7264  btain the record
-000057f0: 6564 2065 7665 6e74 7320 696e 2061 0a73  ed events in a.s
-00005800: 7472 6561 6d2e 2049 7420 7265 7475 726e  tream. It return
-00005810: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-00005820: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-00005830: 6f62 6a65 6374 732e 2054 6865 2072 6563  objects. The rec
-00005840: 6569 7665 6420 7265 636f 7264 6564 2065  eived recorded e
-00005850: 7665 6e74 0a6f 626a 6563 7420 6172 6520  vent.object are 
-00005860: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-00005870: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00005880: 2063 6c61 7373 2028 7365 6520 7468 6520   class (see the 
-00005890: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-000058a0: 6c6f 7720 666f 720a 6465 7461 696c 7320  low for.details 
-000058b0: 6f66 2074 6869 7320 636c 6173 7329 2e0a  of this class)..
-000058c0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-000058d0: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
-000058e0: 6775 6d65 6e74 2c20 6073 7472 6561 6d5f  gument, `stream_
-000058f0: 6e61 6d65 602c 2077 6869 6368 2069 7320  name`, which is 
-00005900: 7468 6520 6e61 6d65 206f 660a 7468 6520  the name of.the 
-00005910: 7374 7265 616d 2066 726f 6d20 7768 6963  stream from whic
-00005920: 6820 746f 2072 6561 6420 6576 656e 7473  h to read events
-00005930: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
-00005940: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00005950: 7320 696e 2074 6865 0a73 7472 6561 6d20  s in the.stream 
-00005960: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
-00005970: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
-00005980: 6572 6520 7265 636f 7264 6564 2e0a 0a54  ere recorded...T
-00005990: 6865 206d 6574 686f 6420 6072 6561 645f  he method `read_
-000059a0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-000059b0: 2061 6c73 6f20 7375 7070 6f72 7473 2066   also supports f
-000059c0: 6f75 7220 6f70 7469 6f6e 616c 2061 7267  our optional arg
-000059d0: 756d 656e 7473 2c0a 6073 7472 6561 6d5f  uments,.`stream_
-000059e0: 706f 7369 7469 6f6e 602c 2060 6261 636b  position`, `back
-000059f0: 7761 7264 7360 2c20 606c 696d 6974 602c  wards`, `limit`,
-00005a00: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
-00005a10: 0a54 6865 206f 7074 696f 6e61 6c20 6073  .The optional `s
-00005a20: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
-00005a30: 6172 6775 6d65 6e74 2069 7320 616e 206f  argument is an o
-00005a40: 7074 696f 6e61 6c20 696e 7465 6765 7220  ptional integer 
-00005a50: 7468 6174 2063 616e 2062 6520 7573 6564  that can be used
-00005a60: 2074 6f0a 696e 6469 6361 7465 2074 6865   to.indicate the
-00005a70: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-00005a80: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
-00005a90: 6368 2074 6f20 7374 6172 7420 7265 6164  ch to start read
-00005aa0: 696e 672e 2054 6869 7320 6172 6775 6d65  ing. This argume
-00005ab0: 6e74 2069 730a 604e 6f6e 6560 2062 7920  nt is.`None` by 
-00005ac0: 6465 6661 756c 742c 2077 6869 6368 206d  default, which m
-00005ad0: 6561 6e73 2074 6865 2073 7472 6561 6d20  eans the stream 
-00005ae0: 7769 6c6c 2062 6520 7265 6164 2065 6974  will be read eit
-00005af0: 6865 7220 6672 6f6d 2074 6865 2073 7461  her from the sta
-00005b00: 7274 206f 6620 7468 650a 7374 7265 616d  rt of the.stream
-00005b10: 2028 7468 6520 6465 6661 756c 7420 6265   (the default be
-00005b20: 6861 7669 6f75 7229 2c20 6f72 2066 726f  haviour), or fro
-00005b30: 6d20 7468 6520 656e 6420 6f66 2074 6865  m the end of the
-00005b40: 2073 7472 6561 6d20 6966 2060 6261 636b   stream if `back
-00005b50: 7761 7264 7360 2069 730a 6054 7275 6560  wards` is.`True`
-00005b60: 2e20 5768 656e 2072 6561 6469 6e67 2061  . When reading a
-00005b70: 2073 7472 6561 6d20 6672 6f6d 2061 2073   stream from a s
-00005b80: 7065 6369 6669 6320 706f 7369 7469 6f6e  pecific position
-00005b90: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
-00005ba0: 7468 650a 7265 636f 7264 6564 2065 7665  the.recorded eve
-00005bb0: 6e74 2061 7420 7468 6174 2070 6f73 6974  nt at that posit
-00005bc0: 696f 6e20 7769 6c6c 2062 6520 696e 636c  ion will be incl
-00005bd0: 7564 6564 2c20 626f 7468 2077 6865 6e20  uded, both when 
-00005be0: 7265 6164 696e 6720 666f 7277 6172 6473  reading forwards
-00005bf0: 0a66 726f 6d20 7468 6174 2070 6f73 6974  .from that posit
-00005c00: 696f 6e2c 2061 6e64 2077 6865 6e20 7265  ion, and when re
-00005c10: 6164 696e 6720 6261 636b 7761 7264 7320  ading backwards 
-00005c20: 6672 6f6d 2074 6861 7420 706f 7369 7469  from that positi
-00005c30: 6f6e 2e0a 0a54 6865 206f 7074 696f 6e61  on...The optiona
-00005c40: 6c20 6062 6163 6b77 6172 6473 6020 6172  l `backwards` ar
-00005c50: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-00005c60: 6f6e 2060 626f 6f6c 602e 2054 6865 2064  on `bool`. The d
-00005c70: 6566 6175 6c74 2069 7320 6046 616c 7365  efault is `False
-00005c80: 602c 2077 6869 6368 0a6d 6561 6e73 2074  `, which.means t
-00005c90: 6865 2073 7472 6561 6d20 7769 6c6c 2062  he stream will b
-00005ca0: 6520 7265 6164 2066 6f72 7761 7264 7320  e read forwards 
-00005cb0: 6279 2064 6566 6175 6c74 2c20 736f 2074  by default, so t
-00005cc0: 6861 7420 6576 656e 7473 2061 7265 2072  hat events are r
-00005cd0: 6574 7572 6e65 6420 696e 2074 6865 0a6f  eturned in the.o
-00005ce0: 7264 6572 2074 6865 7920 7765 7265 2061  rder they were a
-00005cf0: 7070 656e 6465 642c 2049 6620 6062 6163  ppended, If `bac
-00005d00: 6b77 6172 6473 6020 6973 2060 5472 7565  kwards` is `True
-00005d10: 602c 2074 6865 2065 7665 6e74 7320 6172  `, the events ar
-00005d20: 6520 7265 7475 726e 6564 2069 6e20 7265  e returned in re
-00005d30: 7665 7273 650a 6f72 6465 722e 0a0a 5468  verse.order...Th
-00005d40: 6520 6f70 7469 6f6e 616c 2060 6c69 6d69  e optional `limi
-00005d50: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-00005d60: 6e20 696e 7465 6765 7220 7768 6963 6820  n integer which 
-00005d70: 7265 7374 7269 6374 7320 7468 6520 6e75  restricts the nu
-00005d80: 6d62 6572 206f 6620 6576 656e 7473 2074  mber of events t
-00005d90: 6861 740a 7769 6c6c 2062 6520 7265 7475  hat.will be retu
-00005da0: 726e 6564 2e20 5468 6520 6465 6661 756c  rned. The defaul
-00005db0: 7420 7661 6c75 6520 6973 2060 7379 732e  t value is `sys.
-00005dc0: 6d61 7869 6e74 602e 0a0a 5468 6520 6f70  maxint`...The op
-00005dd0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00005de0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-00005df0: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
-00005e00: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-00005e10: 696e 6520 666f 720a 7468 6520 636f 6d70  ine for.the comp
-00005e20: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-00005e30: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
-00005e40: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00005e50: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
-00005e60: 6164 2074 6865 2072 6563 6f72 6465 6420  ad the recorded 
-00005e70: 6576 656e 7473 206f 6620 6120 7374 7265  events of a stre
-00005e80: 616d 0a66 6f72 7761 7264 7320 6672 6f6d  am.forwards from
-00005e90: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
-00005ea0: 6520 7374 7265 616d 2074 6f20 7468 6520  e stream to the 
-00005eb0: 656e 6420 6f66 2074 6865 2073 7472 6561  end of the strea
-00005ec0: 6d2e 2054 6865 0a6e 616d 6520 6f66 2061  m. The.name of a
-00005ed0: 2073 7472 6561 6d20 6973 2067 6976 656e   stream is given
-00005ee0: 2077 6865 6e20 6361 6c6c 696e 6720 7468   when calling th
-00005ef0: 6520 6d65 7468 6f64 2e0a 0a60 6060 7079  e method...```py
-00005f00: 7468 6f6e 0a65 7665 6e74 7320 3d20 636c  thon.events = cl
-00005f10: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
-00005f20: 5f65 7665 6e74 7328 0a20 2020 2073 7472  _events(.    str
-00005f30: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00005f40: 6e61 6d65 310a 290a 6060 600a 0a4e 6f77  name1.).```..Now
-00005f50: 2074 6861 7420 7765 2068 6176 6520 6120   that we have a 
-00005f60: 7365 7175 656e 6365 206f 6620 6576 656e  sequence of even
-00005f70: 7420 6f62 6a65 6374 732c 2077 6520 6361  t objects, we ca
-00005f80: 6e20 6368 6563 6b20 7765 2067 6f74 2074  n check we got t
-00005f90: 6865 0a74 6872 6565 2065 7665 6e74 7320  he.three events 
-00005fa0: 7468 6174 2077 6572 6520 6170 7065 6e64  that were append
-00005fb0: 6564 2074 6f20 7468 6520 7374 7265 616d  ed to the stream
-00005fc0: 2c20 616e 6420 7468 6174 2074 6865 7920  , and that they 
-00005fd0: 6172 650a 6f72 6465 7265 6420 6578 6163  are.ordered exac
-00005fe0: 746c 7920 6173 2074 6865 7920 7765 7265  tly as they were
-00005ff0: 2061 7070 656e 6465 642e 0a0a 6060 6070   appended...```p
-00006000: 7974 686f 6e0a 6173 7365 7274 206c 656e  ython.assert len
-00006010: 2865 7665 6e74 7329 203d 3d20 330a 0a61  (events) == 3..a
-00006020: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006030: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00006040: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-00006050: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
-00006060: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00006070: 300a 6173 7365 7274 2065 7665 6e74 735b  0.assert events[
-00006080: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
-00006090: 312e 7479 7065 0a61 7373 6572 7420 6576  1.type.assert ev
-000060a0: 656e 7473 5b30 5d2e 6461 7461 203d 3d20  ents[0].data == 
-000060b0: 6576 656e 7431 2e64 6174 610a 0a61 7373  event1.data..ass
-000060c0: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
-000060d0: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-000060e0: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
-000060f0: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00006100: 6d5f 706f 7369 7469 6f6e 203d 3d20 310a  m_position == 1.
-00006110: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00006120: 2e74 7970 6520 3d3d 2065 7665 6e74 322e  .type == event2.
-00006130: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
-00006140: 7473 5b31 5d2e 6461 7461 203d 3d20 6576  ts[1].data == ev
-00006150: 656e 7432 2e64 6174 610a 0a61 7373 6572  ent2.data..asser
-00006160: 7420 6576 656e 7473 5b32 5d2e 7374 7265  t events[2].stre
-00006170: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-00006180: 6d5f 6e61 6d65 310a 6173 7365 7274 2065  m_name1.assert e
-00006190: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
-000061a0: 706f 7369 7469 6f6e 203d 3d20 320a 6173  position == 2.as
-000061b0: 7365 7274 2065 7665 6e74 735b 325d 2e74  sert events[2].t
-000061c0: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
-000061d0: 7065 0a61 7373 6572 7420 6576 656e 7473  pe.assert events
-000061e0: 5b32 5d2e 6461 7461 203d 3d20 6576 656e  [2].data == even
-000061f0: 7433 2e64 6174 610a 6060 600a 0a54 6865  t3.data.```..The
-00006200: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-00006210: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-00006220: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00006230: 2069 6e20 6120 7374 7265 616d 2066 6f72   in a stream for
-00006240: 7761 7264 7320 6672 6f6d 0a61 2073 7065  wards from.a spe
-00006250: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
-00006260: 6974 696f 6e20 746f 2074 6865 2065 6e64  ition to the end
-00006270: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
-00006280: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
-00006290: 7320 3d20 636c 6965 6e74 2e72 6561 645f  s = client.read_
-000062a0: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
-000062b0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-000062c0: 7472 6561 6d5f 6e61 6d65 312c 0a20 2020  tream_name1,.   
-000062d0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
-000062e0: 3d31 2c0a 290a 0a61 7373 6572 7420 6c65  =1,.)..assert le
-000062f0: 6e28 6576 656e 7473 2920 3d3d 2032 0a0a  n(events) == 2..
-00006300: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006310: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00006320: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00006330: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
-00006340: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00006350: 2031 0a61 7373 6572 7420 6576 656e 7473   1.assert events
-00006360: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-00006370: 7432 2e74 7970 650a 6173 7365 7274 2065  t2.type.assert e
-00006380: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
-00006390: 2065 7665 6e74 322e 6461 7461 0a0a 6173   event2.data..as
-000063a0: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-000063b0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-000063c0: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-000063d0: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
-000063e0: 616d 5f70 6f73 6974 696f 6e20 3d3d 2032  am_position == 2
-000063f0: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00006400: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
-00006410: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00006420: 6e74 735b 315d 2e64 6174 6120 3d3d 2065  nts[1].data == e
-00006430: 7665 6e74 332e 6461 7461 0a60 6060 0a0a  vent3.data.```..
-00006440: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-00006450: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
-00006460: 6561 6420 7468 6520 7265 636f 7264 6564  ead the recorded
-00006470: 2065 7665 6e74 7320 696e 2061 2073 7472   events in a str
-00006480: 6561 6d20 6261 636b 7761 7264 7320 6672  eam backwards fr
-00006490: 6f6d 0a74 6865 2065 6e64 206f 6620 7468  om.the end of th
-000064a0: 6520 7374 7265 616d 2074 6f20 7468 6520  e stream to the 
-000064b0: 7374 6172 7420 6f66 2074 6865 2073 7472  start of the str
-000064c0: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
-000064d0: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
-000064e0: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-000064f0: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-00006500: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00006510: 2c0a 2020 2020 6261 636b 7761 7264 733d  ,.    backwards=
-00006520: 5472 7565 2c0a 290a 0a61 7373 6572 7420  True,.)..assert 
-00006530: 6c65 6e28 6576 656e 7473 2920 3d3d 2033  len(events) == 3
-00006540: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-00006550: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-00006560: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
-00006570: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006580: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00006590: 3d3d 2032 0a61 7373 6572 7420 6576 656e  == 2.assert even
-000065a0: 7473 5b30 5d2e 7479 7065 203d 3d20 6576  ts[0].type == ev
-000065b0: 656e 7433 2e74 7970 650a 6173 7365 7274  ent3.type.assert
-000065c0: 2065 7665 6e74 735b 305d 2e64 6174 6120   events[0].data 
-000065d0: 3d3d 2065 7665 6e74 332e 6461 7461 0a0a  == event3.data..
-000065e0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-000065f0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00006600: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00006610: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
-00006620: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00006630: 2031 0a61 7373 6572 7420 6576 656e 7473   1.assert events
-00006640: 5b31 5d2e 7479 7065 203d 3d20 6576 656e  [1].type == even
-00006650: 7432 2e74 7970 650a 6173 7365 7274 2065  t2.type.assert e
-00006660: 7665 6e74 735b 315d 2e64 6174 6120 3d3d  vents[1].data ==
-00006670: 2065 7665 6e74 322e 6461 7461 0a60 6060   event2.data.```
-00006680: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-00006690: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-000066a0: 2072 6561 6420 6120 6c69 6d69 7465 6420   read a limited 
-000066b0: 6e75 6d62 6572 2028 7477 6f29 206f 6620  number (two) of 
-000066c0: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-000066d0: 6e74 730a 696e 2061 2073 7472 6561 6d20  nts.in a stream 
-000066e0: 666f 7277 6172 6473 2066 726f 6d20 7468  forwards from th
-000066f0: 6520 7374 6172 7420 6f66 2074 6865 2073  e start of the s
-00006700: 7472 6561 6d2e 0a0a 6060 6070 7974 686f  tream...```pytho
-00006710: 6e0a 6576 656e 7473 203d 2063 6c69 656e  n.events = clien
-00006720: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
-00006730: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-00006740: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00006750: 6531 2c0a 2020 2020 6c69 6d69 743d 322c  e1,.    limit=2,
-00006760: 0a29 0a0a 6173 7365 7274 206c 656e 2865  .)..assert len(e
-00006770: 7665 6e74 7329 203d 3d20 320a 0a61 7373  vents) == 2..ass
-00006780: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
-00006790: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-000067a0: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
-000067b0: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
-000067c0: 6d5f 706f 7369 7469 6f6e 203d 3d20 300a  m_position == 0.
-000067d0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-000067e0: 2e74 7970 6520 3d3d 2065 7665 6e74 312e  .type == event1.
-000067f0: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
-00006800: 7473 5b30 5d2e 6461 7461 203d 3d20 6576  ts[0].data == ev
-00006810: 656e 7431 2e64 6174 610a 0a61 7373 6572  ent1.data..asser
-00006820: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
-00006830: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-00006840: 6d5f 6e61 6d65 310a 6173 7365 7274 2065  m_name1.assert e
-00006850: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
-00006860: 706f 7369 7469 6f6e 203d 3d20 310a 6173  position == 1.as
-00006870: 7365 7274 2065 7665 6e74 735b 315d 2e74  sert events[1].t
-00006880: 7970 6520 3d3d 2065 7665 6e74 322e 7479  ype == event2.ty
-00006890: 7065 0a61 7373 6572 7420 6576 656e 7473  pe.assert events
-000068a0: 5b31 5d2e 6461 7461 203d 3d20 6576 656e  [1].data == even
-000068b0: 7432 2e64 6174 610a 6060 600a 0a54 6865  t2.data.```..The
-000068c0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-000068d0: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-000068e0: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
-000068f0: 7220 286f 6e65 2920 6f66 2074 6865 2072  r (one) of the r
-00006900: 6563 6f72 6465 640a 6576 656e 7473 2069  ecorded.events i
-00006910: 6e20 6120 7374 7265 616d 2062 6163 6b77  n a stream backw
-00006920: 6172 6473 2066 726f 6d20 6120 6769 7665  ards from a give
-00006930: 6e20 7374 7265 616d 2070 6f73 6974 696f  n stream positio
-00006940: 6e2e 0a0a 6060 6070 7974 686f 6e0a 6576  n...```python.ev
-00006950: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
-00006960: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00006970: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-00006980: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
-00006990: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
-000069a0: 696f 6e3d 322c 0a20 2020 2062 6163 6b77  ion=2,.    backw
-000069b0: 6172 6473 3d54 7275 652c 0a20 2020 206c  ards=True,.    l
-000069c0: 696d 6974 3d31 2c0a 290a 0a61 7373 6572  imit=1,.)..asser
-000069d0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-000069e0: 2031 0a0a 6173 7365 7274 2065 7665 6e74   1..assert event
-000069f0: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
-00006a00: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-00006a10: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006a20: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00006a30: 6e20 3d3d 2032 0a61 7373 6572 7420 6576  n == 2.assert ev
-00006a40: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-00006a50: 6576 656e 7433 2e74 7970 650a 6173 7365  event3.type.asse
-00006a60: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00006a70: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-00006a80: 0a60 6060 0a0a 5468 6520 6072 6561 645f  .```..The `read_
-00006a90: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-00006aa0: 206d 6574 686f 6420 7769 6c6c 2072 6169   method will rai
-00006ab0: 7365 2061 2060 4e6f 7446 6f75 6e64 6020  se a `NotFound` 
-00006ac0: 6578 6365 7074 696f 6e20 6966 2074 6865  exception if the
-00006ad0: 2073 7472 6561 6d0a 646f 6573 206e 6f74   stream.does not
-00006ae0: 2065 7869 7374 2e0a 0a60 6060 7079 7468   exist...```pyth
-00006af0: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
-00006b00: 6e74 2e65 7863 6570 7469 6f6e 7320 696d  nt.exceptions im
-00006b10: 706f 7274 204e 6f74 466f 756e 640a 0a0a  port NotFound...
-00006b20: 7472 793a 0a20 2020 2063 6c69 656e 742e  try:.    client.
-00006b30: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00006b40: 7473 2827 6e6f 742d 612d 7374 7265 616d  ts('not-a-stream
-00006b50: 2729 0a65 7863 6570 7420 4e6f 7446 6f75  ').except NotFou
-00006b60: 6e64 3a0a 2020 2020 7061 7373 2020 2320  nd:.    pass  # 
-00006b70: 5468 6520 7374 7265 616d 2027 6e6f 742d  The stream 'not-
-00006b80: 612d 7374 7265 616d 2720 646f 6573 206e  a-stream' does n
-00006b90: 6f74 2065 7869 7374 2e0a 656c 7365 3a0a  ot exist..else:.
-00006ba0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-00006bb0: 696f 6e28 2253 686f 756c 646e 2774 2067  ion("Shouldn't g
-00006bc0: 6574 2068 6572 6522 290a 6060 600a 0a23  et here").```..#
-00006bd0: 2323 2048 6f77 2074 6f20 696d 706c 656d  ## How to implem
-00006be0: 656e 7420 736e 6170 7368 6f74 7469 6e67  ent snapshotting
-00006bf0: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
-00006c00: 4442 0a0a 4576 656e 742d 736f 7572 6365  DB..Event-source
-00006c10: 6420 6167 6772 6567 6174 6573 2061 7265  d aggregates are
-00006c20: 2074 7970 6963 616c 6c79 2072 6563 6f6e   typically recon
-00006c30: 7374 7275 6374 6564 2066 726f 6d20 7265  structed from re
-00006c40: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
-00006c50: 2063 616c 6c69 6e67 0a61 206d 7574 6174   calling.a mutat
-00006c60: 6f72 2066 756e 6374 696f 6e20 666f 7220  or function for 
-00006c70: 6561 6368 2072 6563 6f72 6465 6420 6576  each recorded ev
-00006c80: 656e 742c 2065 766f 6c76 696e 6720 6672  ent, evolving fr
-00006c90: 6f6d 2061 6e20 696e 6974 6961 6c20 7374  om an initial st
-00006ca0: 6174 650a 604e 6f6e 6560 2074 6f20 7468  ate.`None` to th
-00006cb0: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
-00006cc0: 6f66 2074 6865 2061 6767 7265 6761 7465  of the aggregate
-00006cd0: 2e20 5468 6520 6675 6e63 7469 6f6e 2060  . The function `
-00006ce0: 6765 745f 6167 6772 6567 6174 6528 2960  get_aggregate()`
-00006cf0: 2073 686f 7773 0a68 6f77 2074 6869 7320   shows.how this 
-00006d00: 6361 6e20 6265 2064 6f6e 652e 2054 6865  can be done. The
-00006d10: 2061 6767 7265 6761 7465 2049 4420 6973   aggregate ID is
-00006d20: 2075 7365 6420 6173 2061 2073 7472 6561   used as a strea
-00006d30: 6d20 6e61 6d65 2e20 5468 6520 6578 6365  m name. The exce
-00006d40: 7074 696f 6e0a 6041 6767 7265 6761 7465  ption.`Aggregate
-00006d50: 4e6f 7446 6f75 6e64 6020 6973 2072 6169  NotFound` is rai
-00006d60: 7365 6420 6966 2074 6865 2061 6767 7265  sed if the aggre
-00006d70: 6761 7465 2073 7472 6561 6d20 6973 206e  gate stream is n
-00006d80: 6f74 2066 6f75 6e64 2e0a 0a60 6060 7079  ot found...```py
-00006d90: 7468 6f6e 0a64 6566 2067 6574 5f61 6767  thon.def get_agg
-00006da0: 7265 6761 7465 2861 6767 7265 6761 7465  regate(aggregate
-00006db0: 5f69 642c 206d 7574 6174 6f72 5f66 756e  _id, mutator_fun
-00006dc0: 6329 3a0a 2020 2020 7374 7265 616d 5f6e  c):.    stream_n
-00006dd0: 616d 6520 3d20 6167 6772 6567 6174 655f  ame = aggregate_
-00006de0: 6964 0a0a 2020 2020 2320 4765 7420 7265  id..    # Get re
-00006df0: 636f 7264 6564 2065 7665 6e74 732e 0a20  corded events.. 
-00006e00: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00006e10: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
-00006e20: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00006e30: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-00006e40: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00006e50: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
-00006e60: 2020 2020 2073 7472 6561 6d5f 706f 7369       stream_posi
-00006e70: 7469 6f6e 3d4e 6f6e 650a 2020 2020 2020  tion=None.      
-00006e80: 2020 290a 2020 2020 6578 6365 7074 204e    ).    except N
-00006e90: 6f74 466f 756e 6420 6173 2065 3a0a 2020  otFound as e:.  
-00006ea0: 2020 2020 2020 7261 6973 6520 4167 6772        raise Aggr
-00006eb0: 6567 6174 654e 6f74 466f 756e 6428 6167  egateNotFound(ag
-00006ec0: 6772 6567 6174 655f 6964 2920 6672 6f6d  gregate_id) from
-00006ed0: 2065 0a20 2020 2065 6c73 653a 0a20 2020   e.    else:.   
-00006ee0: 2020 2020 2023 2052 6563 6f6e 7374 7275       # Reconstru
-00006ef0: 6374 2061 6767 7265 6761 7465 2066 726f  ct aggregate fro
-00006f00: 6d20 7265 636f 7264 6564 2065 7665 6e74  m recorded event
-00006f10: 732e 0a20 2020 2020 2020 2061 6767 7265  s..        aggre
-00006f20: 6761 7465 203d 204e 6f6e 650a 2020 2020  gate = None.    
-00006f30: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
-00006f40: 2065 7665 6e74 733a 0a20 2020 2020 2020   events:.       
-00006f50: 2020 2020 2061 6767 7265 6761 7465 203d       aggregate =
-00006f60: 206d 7574 6174 6f72 5f66 756e 6328 6167   mutator_func(ag
-00006f70: 6772 6567 6174 652c 2065 7665 6e74 290a  gregate, event).
-00006f80: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00006f90: 6767 7265 6761 7465 0a0a 0a63 6c61 7373  ggregate...class
-00006fa0: 2041 6767 7265 6761 7465 4e6f 7446 6f75   AggregateNotFou
-00006fb0: 6e64 2845 7863 6570 7469 6f6e 293a 0a20  nd(Exception):. 
-00006fc0: 2020 2022 2222 5261 6973 6564 2077 6865     """Raised whe
-00006fd0: 6e20 616e 2061 6767 7265 6761 7465 2069  n an aggregate i
-00006fe0: 7320 6e6f 7420 666f 756e 642e 2222 220a  s not found.""".
-00006ff0: 6060 600a 0a53 6e61 7073 686f 7473 2063  ```..Snapshots c
-00007000: 616e 2069 6d70 726f 7665 2074 6865 2070  an improve the p
-00007010: 6572 666f 726d 616e 6365 206f 6620 6167  erformance of ag
-00007020: 6772 6567 6174 6573 2074 6861 7420 776f  gregates that wo
-00007030: 756c 6420 6f74 6865 7277 6973 6520 6265  uld otherwise be
-00007040: 0a72 6563 6f6e 7374 7275 6374 6564 2066  .reconstructed f
-00007050: 726f 6d20 7665 7279 206c 6f6e 6720 7374  rom very long st
-00007060: 7265 616d 732e 2048 6f77 6576 6572 2c20  reams. However, 
-00007070: 6974 2069 7320 6765 6e65 7261 6c6c 7920  it is generally 
-00007080: 7265 636f 6d6d 656e 6465 6420 746f 0a64  recommended to.d
-00007090: 6573 6967 6e20 6167 6772 6567 6174 6573  esign aggregates
-000070a0: 2074 6f20 6861 7665 2061 2066 696e 6974   to have a finit
-000070b0: 6520 6c69 6665 6379 636c 652c 2061 6e64  e lifecycle, and
-000070c0: 2068 656e 6365 2072 656c 6174 6976 656c   hence relativel
-000070d0: 7920 7368 6f72 7420 7374 7265 616d 732c  y short streams,
-000070e0: 0a74 6865 7265 6279 2061 766f 6964 696e  .thereby avoidin
-000070f0: 6720 7468 6520 6e65 6564 2066 6f72 2073  g the need for s
-00007100: 6e61 7073 686f 7474 696e 672e 2054 6869  napshotting. Thi
-00007110: 7320 2268 6f77 2074 6f22 2073 6563 7469  s "how to" secti
-00007120: 6f6e 2069 7320 696e 7465 6e64 6564 0a6d  on is intended.m
-00007130: 6572 656c 7920 746f 2073 686f 7720 686f  erely to show ho
-00007140: 7720 736e 6170 7368 6f74 7469 6e67 206f  w snapshotting o
-00007150: 6620 6167 6772 6567 6174 6573 2063 616e  f aggregates can
-00007160: 2062 6520 696d 706c 656d 656e 7465 6420   be implemented 
-00007170: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
-00007180: 420a 7573 696e 6720 7468 6973 2050 7974  B.using this Pyt
-00007190: 686f 6e20 636c 6965 6e74 2e0a 0a53 6e61  hon client...Sna
-000071a0: 7073 686f 7474 696e 6720 6f66 2061 6767  pshotting of agg
-000071b0: 7265 6761 7465 7320 6361 6e20 6265 2069  regates can be i
-000071c0: 6d70 6c65 6d65 6e74 6564 2062 7920 7265  mplemented by re
-000071d0: 636f 7264 696e 6720 7468 6520 6375 7272  cording the curr
-000071e0: 656e 7420 7374 6174 6520 6f66 0a61 6e20  ent state of.an 
-000071f0: 6167 6772 6567 6174 6520 6173 2061 206e  aggregate as a n
-00007200: 6577 2065 7665 6e74 2e0a 0a49 6620 616e  ew event...If an
-00007210: 2061 6767 7265 6761 7465 206f 626a 6563   aggregate objec
-00007220: 7420 6861 7320 6120 7665 7273 696f 6e20  t has a version 
-00007230: 6e75 6d62 6572 2074 6861 7420 636f 7272  number that corr
-00007240: 6573 706f 6e64 7320 746f 2074 6865 2073  esponds to the s
-00007250: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
-00007260: 660a 7468 6520 6c61 7374 2065 7665 6e74  f.the last event
-00007270: 2074 6861 7420 7761 7320 7573 6564 2074   that was used t
-00007280: 6f20 7265 636f 6e73 7472 7563 7420 7468  o reconstruct th
-00007290: 6520 6167 6772 6567 6174 652c 2061 6e64  e aggregate, and
-000072a0: 2074 6869 7320 7665 7273 696f 6e20 6e75   this version nu
-000072b0: 6d62 6572 0a69 7320 7265 636f 7264 6564  mber.is recorded
-000072c0: 2069 6e20 7468 6520 736e 6170 7368 6f74   in the snapshot
-000072d0: 206d 6574 6164 6174 612c 2074 6865 6e20   metadata, then 
-000072e0: 616e 7920 6576 656e 7473 2074 6861 7420  any events that 
-000072f0: 6172 6520 7265 636f 7264 6564 2061 6674  are recorded aft
-00007300: 6572 2074 6865 0a73 6e61 7073 686f 7420  er the.snapshot 
-00007310: 6361 6e20 6265 2073 656c 6563 7465 6420  can be selected 
-00007320: 7573 696e 6720 7468 6973 2076 6572 7369  using this versi
-00007330: 6f6e 206e 756d 6265 722e 2054 6865 2061  on number. The a
-00007340: 6767 7265 6761 7465 2063 616e 2074 6865  ggregate can the
-00007350: 6e20 6265 0a72 6563 6f6e 7374 7275 6374  n be.reconstruct
-00007360: 6564 2066 726f 6d20 7468 6520 6c61 7374  ed from the last
-00007370: 2073 6e61 7073 686f 7420 616e 6420 616e   snapshot and an
-00007380: 7920 7375 6273 6571 7565 6e74 2065 7665  y subsequent eve
-00007390: 6e74 732c 2077 6974 686f 7574 2068 6176  nts, without hav
-000073a0: 696e 670a 746f 2072 6570 6c61 7920 7468  ing.to replay th
-000073b0: 6520 656e 7469 7265 2068 6973 746f 7279  e entire history
-000073c0: 2e0a 0a57 6520 7769 6c6c 2075 7365 2061  ...We will use a
-000073d0: 2073 6570 6172 6174 6520 7374 7265 616d   separate stream
-000073e0: 2066 6f72 2061 6e20 6167 6772 6567 6174   for an aggregat
-000073f0: 6527 7320 736e 6170 7368 6f74 7320 7468  e's snapshots th
-00007400: 6174 2069 7320 6e61 6d65 6420 6166 7465  at is named afte
-00007410: 7220 7468 650a 7374 7265 616d 2075 7365  r the.stream use
-00007420: 6420 666f 7220 7265 636f 7264 696e 6720  d for recording 
-00007430: 6974 7320 6576 656e 7473 2e20 5468 6520  its events. The 
-00007440: 6e61 6d65 206f 6620 7468 6520 736e 6170  name of the snap
-00007450: 7368 6f74 2073 7472 6561 6d20 7769 6c6c  shot stream will
-00007460: 2062 650a 636f 6e73 7472 7563 7465 6420   be.constructed 
-00007470: 6279 2070 7265 6669 7869 6e67 2074 6865  by prefixing the
-00007480: 2061 6767 7265 6761 7465 2773 2073 7472   aggregate's str
-00007490: 6561 6d20 6e61 6d65 2077 6974 6820 6027  eam name with `'
-000074a0: 2473 6e61 7073 686f 742d 2760 2e0a 0a60  $snapshot-'`...`
-000074b0: 6060 7079 7468 6f6e 0a53 4e41 5053 484f  ``python.SNAPSHO
-000074c0: 545f 5052 4546 4958 203d 2027 2473 6e61  T_PREFIX = '$sna
-000074d0: 7073 686f 742d 270a 0a64 6566 206d 616b  pshot-'..def mak
-000074e0: 655f 736e 6170 7368 6f74 5f73 7472 6561  e_snapshot_strea
-000074f0: 6d5f 6e61 6d65 2873 7472 6561 6d5f 6e61  m_name(stream_na
-00007500: 6d65 293a 0a20 2020 2072 6574 7572 6e20  me):.    return 
-00007510: 6627 7b53 4e41 5053 484f 545f 5052 4546  f'{SNAPSHOT_PREF
-00007520: 4958 7d7b 7374 7265 616d 5f6e 616d 657d  IX}{stream_name}
-00007530: 270a 0a0a 6465 6620 7374 7269 705f 736e  '...def strip_sn
-00007540: 6170 7368 6f74 5f73 7472 6561 6d5f 6e61  apshot_stream_na
-00007550: 6d65 2873 6e61 7073 686f 745f 7374 7265  me(snapshot_stre
-00007560: 616d 5f6e 616d 6529 3a0a 2020 2020 7265  am_name):.    re
-00007570: 7475 726e 2073 6e61 7073 686f 745f 7374  turn snapshot_st
-00007580: 7265 616d 5f6e 616d 652e 6c73 7472 6970  ream_name.lstrip
-00007590: 2853 4e41 5053 484f 545f 5052 4546 4958  (SNAPSHOT_PREFIX
-000075a0: 290a 6060 600a 0a4c 6574 2773 2072 6564  ).```..Let's red
-000075b0: 6566 696e 6520 7468 6520 6067 6574 5f61  efine the `get_a
-000075c0: 6767 7265 6761 7465 2829 6020 6675 6e63  ggregate()` func
-000075d0: 7469 6f6e 2c20 736f 2074 6861 7420 6974  tion, so that it
-000075e0: 206c 6f6f 6b73 2066 6f72 2061 2073 6e61   looks for a sna
-000075f0: 7073 686f 7420 6576 656e 742c 0a74 6865  pshot event,.the
-00007600: 6e20 7365 6c65 6374 7320 7375 6273 6571  n selects subseq
-00007610: 7565 6e74 2061 6767 7265 6761 7465 2065  uent aggregate e
-00007620: 7665 6e74 732c 2061 6e64 2074 6865 6e20  vents, and then 
-00007630: 6361 6c6c 7320 6120 6d75 7461 746f 7220  calls a mutator 
-00007640: 6675 6e63 7469 6f6e 2066 6f72 2065 6163  function for eac
-00007650: 680a 7265 636f 7264 6564 2065 7665 6e74  h.recorded event
-00007660: 2e20 5765 2077 696c 6c20 7573 6520 4a53  . We will use JS
-00007670: 4f4e 2074 6f20 7365 7269 616c 697a 6520  ON to serialize 
-00007680: 616e 6420 6465 7365 7269 616c 697a 6520  and deserialize 
-00007690: 5079 7468 6f6e 2060 6469 6374 6020 6f62  Python `dict` ob
-000076a0: 6a65 6374 732e 0a0a 4e6f 7469 6365 2074  jects...Notice t
-000076b0: 6861 7420 7468 6520 6167 6772 6567 6174  hat the aggregat
-000076c0: 6520 6576 656e 7473 2061 7265 2072 6561  e events are rea
-000076d0: 6420 6672 6f6d 2061 2073 7472 6561 6d20  d from a stream 
-000076e0: 666f 7220 6167 6772 6567 6174 650a 6576  for aggregate.ev
-000076f0: 656e 7473 2c20 7768 696c 7374 2074 6865  ents, whilst the
-00007700: 2073 6e61 7073 686f 7420 6973 2072 6561   snapshot is rea
-00007710: 6420 6672 6f6d 2061 2073 6570 6172 6174  d from a separat
-00007720: 6520 7374 7265 616d 2066 6f72 2061 6767  e stream for agg
-00007730: 7265 6761 7465 2073 6e61 7073 686f 7473  regate snapshots
-00007740: 2e0a 0a60 6060 7079 7468 6f6e 0a69 6d70  ...```python.imp
-00007750: 6f72 7420 6a73 6f6e 0a0a 0a64 6566 2067  ort json...def g
-00007760: 6574 5f61 6767 7265 6761 7465 2861 6767  et_aggregate(agg
-00007770: 7265 6761 7465 5f69 642c 206d 7574 6174  regate_id, mutat
-00007780: 6f72 5f66 756e 6329 3a0a 2020 2020 7374  or_func):.    st
-00007790: 7265 616d 5f6e 616d 6520 3d20 6167 6772  ream_name = aggr
-000077a0: 6567 6174 655f 6964 0a20 2020 2072 6563  egate_id.    rec
-000077b0: 6f72 6465 645f 6576 656e 7473 203d 205b  orded_events = [
-000077c0: 5d0a 0a20 2020 2023 204c 6f6f 6b20 666f  ]..    # Look fo
-000077d0: 7220 6120 736e 6170 7368 6f74 2e0a 2020  r a snapshot..  
-000077e0: 2020 7472 793a 0a20 2020 2020 2020 2073    try:.        s
-000077f0: 6e61 7073 686f 7473 203d 2063 6c69 656e  napshots = clien
-00007800: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
-00007810: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
-00007820: 2020 7374 7265 616d 5f6e 616d 653d 6d61    stream_name=ma
-00007830: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
-00007840: 616d 5f6e 616d 6528 7374 7265 616d 5f6e  am_name(stream_n
-00007850: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
-00007860: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
-00007870: 2c0a 2020 2020 2020 2020 2020 2020 6c69  ,.            li
-00007880: 6d69 743d 310a 2020 2020 2020 2020 290a  mit=1.        ).
-00007890: 2020 2020 6578 6365 7074 204e 6f74 466f      except NotFo
-000078a0: 756e 643a 0a20 2020 2020 2020 2073 7472  und:.        str
-000078b0: 6561 6d5f 706f 7369 7469 6f6e 203d 204e  eam_position = N
-000078c0: 6f6e 650a 2020 2020 656c 7365 3a0a 2020  one.    else:.  
-000078d0: 2020 2020 2020 736e 6170 7368 6f74 203d        snapshot =
-000078e0: 2073 6e61 7073 686f 7473 5b30 5d0a 2020   snapshots[0].  
-000078f0: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
-00007900: 6974 696f 6e20 3d20 6465 7365 7269 616c  ition = deserial
-00007910: 697a 6528 736e 6170 7368 6f74 2e6d 6574  ize(snapshot.met
-00007920: 6164 6174 6129 5b27 7665 7273 696f 6e27  adata)['version'
-00007930: 5d20 2b20 310a 2020 2020 2020 2020 7265  ] + 1.        re
-00007940: 636f 7264 6564 5f65 7665 6e74 732e 6170  corded_events.ap
-00007950: 7065 6e64 2873 6e61 7073 686f 7429 0a0a  pend(snapshot)..
-00007960: 2020 2020 2320 4765 7420 7375 6273 6571      # Get subseq
-00007970: 7565 6e74 2065 7665 6e74 732e 0a20 2020  uent events..   
-00007980: 2074 7279 3a0a 2020 2020 2020 2020 6576   try:.        ev
-00007990: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
-000079a0: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-000079b0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
-000079c0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-000079d0: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-000079e0: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
-000079f0: 6f6e 3d73 7472 6561 6d5f 706f 7369 7469  on=stream_positi
-00007a00: 6f6e 0a20 2020 2020 2020 2029 0a20 2020  on.        ).   
-00007a10: 2065 7863 6570 7420 4e6f 7446 6f75 6e64   except NotFound
-00007a20: 2061 7320 653a 0a20 2020 2020 2020 2072   as e:.        r
-00007a30: 6169 7365 2041 6767 7265 6761 7465 4e6f  aise AggregateNo
-00007a40: 7446 6f75 6e64 2861 6767 7265 6761 7465  tFound(aggregate
-00007a50: 5f69 6429 2066 726f 6d20 650a 2020 2020  _id) from e.    
-00007a60: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
-00007a70: 636f 7264 6564 5f65 7665 6e74 7320 2b3d  corded_events +=
-00007a80: 2065 7665 6e74 730a 0a20 2020 2023 2052   events..    # R
-00007a90: 6563 6f6e 7374 7275 6374 2061 6767 7265  econstruct aggre
-00007aa0: 6761 7465 2066 726f 6d20 7265 636f 7264  gate from record
-00007ab0: 6564 2065 7665 6e74 732e 0a20 2020 2061  ed events..    a
-00007ac0: 6767 7265 6761 7465 203d 204e 6f6e 650a  ggregate = None.
-00007ad0: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
-00007ae0: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
-00007af0: 3a0a 2020 2020 2020 2020 6167 6772 6567  :.        aggreg
-00007b00: 6174 6520 3d20 6d75 7461 746f 725f 6675  ate = mutator_fu
-00007b10: 6e63 2861 6767 7265 6761 7465 2c20 6576  nc(aggregate, ev
-00007b20: 656e 7429 0a0a 2020 2020 7265 7475 726e  ent)..    return
-00007b30: 2061 6767 7265 6761 7465 0a0a 0a64 6566   aggregate...def
-00007b40: 2073 6572 6961 6c69 7a65 2864 293a 0a20   serialize(d):. 
-00007b50: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
-00007b60: 756d 7073 2864 292e 656e 636f 6465 2829  umps(d).encode()
-00007b70: 0a0a 0a64 6566 2064 6573 6572 6961 6c69  ...def deseriali
-00007b80: 7a65 2873 293a 0a20 2020 2072 6574 7572  ze(s):.    retur
-00007b90: 6e20 6a73 6f6e 2e6c 6f61 6473 2873 2e64  n json.loads(s.d
-00007ba0: 6563 6f64 6528 2929 0a60 6060 0a0a 546f  ecode()).```..To
-00007bb0: 2073 686f 7720 686f 7720 7468 6973 2063   show how this c
-00007bc0: 616e 2062 6520 7573 6564 2c20 6c65 7427  an be used, let'
-00007bd0: 7320 6465 6669 6e65 2061 6e20 2269 6d6d  s define an "imm
-00007be0: 7574 6162 6c65 2220 6044 6f67 6020 6167  utable" `Dog` ag
-00007bf0: 6772 6567 6174 6520 636c 6173 732c 2077  gregate class, w
-00007c00: 6974 680a 6174 7472 6962 7574 6573 2060  ith.attributes `
-00007c10: 6e61 6d65 6020 616e 6420 6074 7269 636b  name` and `trick
-00007c20: 7360 2e20 5468 6520 6174 7472 6962 7574  s`. The attribut
-00007c30: 6573 2060 6964 6020 616e 6420 6076 6572  es `id` and `ver
-00007c40: 7369 6f6e 6020 7769 6c6c 2069 6e64 6963  sion` will indic
-00007c50: 6174 6520 616e 0a61 6767 7265 6761 7465  ate an.aggregate
-00007c60: 206f 626a 6563 7427 7320 4944 2061 6e64   object's ID and
-00007c70: 2076 6572 7369 6f6e 206e 756d 6265 722e   version number.
-00007c80: 2054 6865 2061 7474 7269 6275 7465 2060   The attribute `
-00007c90: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-00007ca0: 6020 6973 2061 6464 6564 0a68 6572 6520  ` is added.here 
-00007cb0: 6d65 7265 6c79 2074 6f20 6465 6d6f 6e73  merely to demons
-00007cc0: 7472 6174 6520 6265 6c6f 7720 7768 656e  trate below when
-00007cd0: 2061 6e20 6167 6772 6567 6174 6520 6f62   an aggregate ob
-00007ce0: 6a65 6374 2068 6173 2062 6565 6e20 7265  ject has been re
-00007cf0: 636f 6e73 7472 7563 7465 6420 7573 696e  constructed usin
-00007d00: 670a 6120 736e 6170 7368 6f74 2e0a 0a60  g.a snapshot...`
-00007d10: 6060 7079 7468 6f6e 0a66 726f 6d20 6461  ``python.from da
-00007d20: 7461 636c 6173 7365 7320 696d 706f 7274  taclasses import
-00007d30: 2064 6174 6163 6c61 7373 0a0a 0a40 6461   dataclass...@da
-00007d40: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
-00007d50: 7275 6529 0a63 6c61 7373 2041 6767 7265  rue).class Aggre
-00007d60: 6761 7465 3a0a 2020 2020 6964 3a20 7374  gate:.    id: st
-00007d70: 720a 2020 2020 7665 7273 696f 6e3a 2069  r.    version: i
-00007d80: 6e74 0a20 2020 2069 735f 6672 6f6d 5f73  nt.    is_from_s
-00007d90: 6e61 7073 686f 743a 2062 6f6f 6c0a 0a0a  napshot: bool...
-00007da0: 4064 6174 6163 6c61 7373 2866 726f 7a65  @dataclass(froze
-00007db0: 6e3d 5472 7565 290a 636c 6173 7320 446f  n=True).class Do
-00007dc0: 6728 4167 6772 6567 6174 6529 3a0a 2020  g(Aggregate):.  
-00007dd0: 2020 6e61 6d65 3a20 7374 720a 2020 2020    name: str.    
-00007de0: 7472 6963 6b73 3a20 6c69 7374 0a0a 6060  tricks: list..``
-00007df0: 600a 0a4c 6574 2773 2061 6c73 6f20 6465  `..Let's also de
-00007e00: 6669 6e65 2061 206d 7574 6174 6f72 2066  fine a mutator f
-00007e10: 756e 6374 696f 6e20 606d 7574 6174 655f  unction `mutate_
-00007e20: 646f 6728 2960 2074 6861 7420 6361 6e20  dog()` that can 
-00007e30: 6576 6f6c 7665 2074 6865 2073 7461 7465  evolve the state
-00007e40: 206f 6620 610a 6044 6f67 6020 6167 6772   of a.`Dog` aggr
-00007e50: 6567 6174 6520 6769 7665 6e20 7661 7269  egate given vari
-00007e60: 6f75 7320 6469 6666 6572 656e 7420 7479  ous different ty
-00007e70: 7065 7320 6f66 2065 7665 6e74 732c 2060  pes of events, `
-00007e80: 2744 6f67 5265 6769 7374 6572 6564 2760  'DogRegistered'`
-00007e90: 2c0a 6027 446f 674c 6561 726e 6564 5472  ,.`'DogLearnedTr
-00007ea0: 6963 6b27 602c 2061 6e64 2060 2724 536e  ick'`, and `'$Sn
-00007eb0: 6170 7368 6f74 6027 2e20 5468 6520 736e  apshot`'. The sn
-00007ec0: 6170 7368 6f74 2065 7665 6e74 2074 7970  apshot event typ
-00007ed0: 6520 6973 2070 7265 6669 7865 6420 7769  e is prefixed wi
-00007ee0: 7468 0a60 2724 2760 2073 6f20 7468 6174  th.`'$'` so that
-00007ef0: 2069 7420 6361 6e20 6265 2066 696c 7465   it can be filte
-00007f00: 7265 6420 6f75 7420 7768 656e 2072 6561  red out when rea
-00007f10: 6469 6e67 2061 6c6c 2065 7665 6e74 7320  ding all events 
-00007f20: 6672 6f6d 2074 6865 2064 6174 6162 6173  from the databas
-00007f30: 652e 0a0a 6060 6070 7974 686f 6e0a 6465  e...```python.de
-00007f40: 6620 6d75 7461 7465 5f64 6f67 2864 6f67  f mutate_dog(dog
-00007f50: 2c20 6576 656e 7429 3a0a 2020 2020 6461  , event):.    da
-00007f60: 7461 203d 2064 6573 6572 6961 6c69 7a65  ta = deserialize
-00007f70: 2865 7665 6e74 2e64 6174 6129 0a20 2020  (event.data).   
-00007f80: 2069 6620 6576 656e 742e 7479 7065 203d   if event.type =
-00007f90: 3d20 2744 6f67 5265 6769 7374 6572 6564  = 'DogRegistered
-00007fa0: 273a 0a20 2020 2020 2020 2072 6574 7572  ':.        retur
-00007fb0: 6e20 446f 6728 0a20 2020 2020 2020 2020  n Dog(.         
-00007fc0: 2020 2069 643d 6576 656e 742e 7374 7265     id=event.stre
-00007fd0: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
-00007fe0: 2020 2020 2076 6572 7369 6f6e 3d65 7665       version=eve
-00007ff0: 6e74 2e73 7472 6561 6d5f 706f 7369 7469  nt.stream_positi
-00008000: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00008010: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-00008020: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00008030: 2020 2020 6e61 6d65 3d64 6174 615b 276e      name=data['n
-00008040: 616d 6527 5d2c 0a20 2020 2020 2020 2020  ame'],.         
-00008050: 2020 2074 7269 636b 733d 5b5d 2c0a 2020     tricks=[],.  
-00008060: 2020 2020 2020 290a 2020 2020 656c 6966        ).    elif
-00008070: 2065 7665 6e74 2e74 7970 6520 3d3d 2027   event.type == '
-00008080: 446f 674c 6561 726e 6564 5472 6963 6b27  DogLearnedTrick'
-00008090: 3a0a 2020 2020 2020 2020 6173 7365 7274  :.        assert
-000080a0: 2065 7665 6e74 2e73 7472 6561 6d5f 706f   event.stream_po
-000080b0: 7369 7469 6f6e 203d 3d20 646f 672e 7665  sition == dog.ve
-000080c0: 7273 696f 6e20 2b20 310a 2020 2020 2020  rsion + 1.      
-000080d0: 2020 6173 7365 7274 2065 7665 6e74 2e73    assert event.s
-000080e0: 7472 6561 6d5f 6e61 6d65 203d 3d20 646f  tream_name == do
-000080f0: 672e 6964 0a20 2020 2020 2020 2072 6574  g.id.        ret
-00008100: 7572 6e20 446f 6728 0a20 2020 2020 2020  urn Dog(.       
-00008110: 2020 2020 2069 643d 646f 672e 6964 2c0a       id=dog.id,.
-00008120: 2020 2020 2020 2020 2020 2020 7665 7273              vers
-00008130: 696f 6e3d 6576 656e 742e 7374 7265 616d  ion=event.stream
-00008140: 5f70 6f73 6974 696f 6e2c 0a20 2020 2020  _position,.     
-00008150: 2020 2020 2020 2069 735f 6672 6f6d 5f73         is_from_s
-00008160: 6e61 7073 686f 743d 646f 672e 6973 5f66  napshot=dog.is_f
-00008170: 726f 6d5f 736e 6170 7368 6f74 2c0a 2020  rom_snapshot,.  
-00008180: 2020 2020 2020 2020 2020 6e61 6d65 3d64            name=d
-00008190: 6f67 2e6e 616d 652c 0a20 2020 2020 2020  og.name,.       
-000081a0: 2020 2020 2074 7269 636b 733d 646f 672e       tricks=dog.
-000081b0: 7472 6963 6b73 202b 205b 6461 7461 5b27  tricks + [data['
-000081c0: 7472 6963 6b27 5d5d 2c0a 2020 2020 2020  trick']],.      
-000081d0: 2020 290a 2020 2020 656c 6966 2065 7665    ).    elif eve
-000081e0: 6e74 2e74 7970 6520 3d3d 2027 2453 6e61  nt.type == '$Sna
-000081f0: 7073 686f 7427 3a0a 2020 2020 2020 2020  pshot':.        
-00008200: 7265 7475 726e 2044 6f67 280a 2020 2020  return Dog(.    
-00008210: 2020 2020 2020 2020 6964 3d73 7472 6970          id=strip
-00008220: 5f73 6e61 7073 686f 745f 7374 7265 616d  _snapshot_stream
-00008230: 5f6e 616d 6528 6576 656e 742e 7374 7265  _name(event.stre
-00008240: 616d 5f6e 616d 6529 2c0a 2020 2020 2020  am_name),.      
-00008250: 2020 2020 2020 7665 7273 696f 6e3d 6465        version=de
-00008260: 7365 7269 616c 697a 6528 6576 656e 742e  serialize(event.
-00008270: 6d65 7461 6461 7461 295b 2776 6572 7369  metadata)['versi
-00008280: 6f6e 275d 2c0a 2020 2020 2020 2020 2020  on'],.          
-00008290: 2020 6973 5f66 726f 6d5f 736e 6170 7368    is_from_snapsh
-000082a0: 6f74 3d54 7275 652c 0a20 2020 2020 2020  ot=True,.       
-000082b0: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
-000082c0: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
-000082d0: 2020 2020 7472 6963 6b73 3d64 6174 615b      tricks=data[
-000082e0: 2774 7269 636b 7327 5d2c 0a20 2020 2020  'tricks'],.     
-000082f0: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
-00008300: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-00008310: 6570 7469 6f6e 2866 2255 6e6b 6e6f 776e  eption(f"Unknown
-00008320: 2065 7665 6e74 2074 7970 653a 207b 6576   event type: {ev
-00008330: 656e 742e 7479 7065 7d22 290a 6060 600a  ent.type}").```.
-00008340: 0a46 6f72 2063 6f6e 7665 6e69 656e 6365  .For convenience
-00008350: 2c20 6c65 7427 7320 616c 736f 2064 6566  , let's also def
-00008360: 696e 6520 6120 6067 6574 5f64 6f67 2829  ine a `get_dog()
-00008370: 6020 6675 6e63 7469 6f6e 2074 6861 7420  ` function that 
-00008380: 6361 6c6c 7320 6067 6574 5f61 6767 7265  calls `get_aggre
-00008390: 6761 7465 2829 600a 7769 7468 2074 6865  gate()`.with the
-000083a0: 2060 6d75 7461 7465 5f64 6f67 2829 6020   `mutate_dog()` 
-000083b0: 6675 6e63 7469 6f6e 2061 7320 7468 6520  function as the 
-000083c0: 606d 7574 6174 6f72 5f66 756e 6360 2061  `mutator_func` a
-000083d0: 7267 756d 656e 742e 0a0a 6060 6070 7974  rgument...```pyt
-000083e0: 686f 6e0a 6465 6620 6765 745f 646f 6728  hon.def get_dog(
-000083f0: 646f 675f 6964 293a 0a20 2020 2072 6574  dog_id):.    ret
-00008400: 7572 6e20 6765 745f 6167 6772 6567 6174  urn get_aggregat
-00008410: 6528 0a20 2020 2020 2020 2061 6767 7265  e(.        aggre
-00008420: 6761 7465 5f69 643d 646f 675f 6964 2c0a  gate_id=dog_id,.
-00008430: 2020 2020 2020 2020 6d75 7461 746f 725f          mutator_
-00008440: 6675 6e63 3d6d 7574 6174 655f 646f 672c  func=mutate_dog,
-00008450: 0a20 2020 2029 0a60 6060 0a0a 5765 2063  .    ).```..We c
-00008460: 616e 2061 6c73 6f20 6465 6669 6e65 2073  an also define s
-00008470: 6f6d 6520 2263 6f6d 6d61 6e64 2220 6675  ome "command" fu
-00008480: 6e63 7469 6f6e 7320 7468 6174 2061 7070  nctions that app
-00008490: 656e 6420 6e65 7720 6576 656e 7473 2074  end new events t
-000084a0: 6f20 7468 650a 6461 7461 6261 7365 2e20  o the.database. 
-000084b0: 5468 6520 6072 6567 6973 7465 725f 646f  The `register_do
-000084c0: 6728 2960 2066 756e 6374 696f 6e20 6170  g()` function ap
-000084d0: 7065 6e64 7320 6120 6044 6f67 5265 6769  pends a `DogRegi
-000084e0: 7374 6572 6564 6020 6576 656e 742e 2054  stered` event. T
-000084f0: 6865 0a60 7265 636f 7264 5f74 7269 636b  he.`record_trick
-00008500: 5f6c 6561 726e 6564 2829 6020 6170 7065  _learned()` appe
-00008510: 6e64 7320 6120 6044 6f67 4c65 6172 6e65  nds a `DogLearne
-00008520: 6454 7269 636b 6020 6576 656e 742e 2054  dTrick` event. T
-00008530: 6865 2066 756e 6374 696f 6e0a 6073 6e61  he function.`sna
-00008540: 7073 686f 745f 646f 6728 2960 2061 7070  pshot_dog()` app
-00008550: 656e 6473 2061 2060 2453 6e61 7073 686f  ends a `$Snapsho
-00008560: 7460 2065 7665 6e74 2e20 4e6f 7469 6365  t` event. Notice
-00008570: 2074 6861 7420 7468 650a 6072 6563 6f72   that the.`recor
-00008580: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
-00008590: 2960 2061 6e64 2060 736e 6170 7368 6f74  )` and `snapshot
-000085a0: 5f64 6f67 2829 6020 6675 6e63 7469 6f6e  _dog()` function
-000085b0: 7320 7573 6520 6067 6574 5f64 6f67 2829  s use `get_dog()
-000085c0: 602e 0a0a 4e6f 7469 6365 2061 6c73 6f20  `...Notice also 
-000085d0: 7468 6174 2074 6865 2060 446f 6752 6567  that the `DogReg
-000085e0: 6973 7465 7265 6460 2061 6e64 2060 446f  istered` and `Do
-000085f0: 674c 6561 726e 6564 5472 6963 6b60 2065  gLearnedTrick` e
-00008600: 7665 6e74 7320 6172 6520 6170 7065 6e64  vents are append
-00008610: 6564 2074 6f20 610a 7374 7265 616d 2066  ed to a.stream f
-00008620: 6f72 2061 6767 7265 6761 7465 2065 7665  or aggregate eve
-00008630: 6e74 732c 2077 6869 6c73 7420 7468 6520  nts, whilst the 
-00008640: 6024 536e 6170 7368 6f74 6020 6973 2061  `$Snapshot` is a
-00008650: 7070 656e 6465 6420 746f 2061 2073 6570  ppended to a sep
-00008660: 6172 6174 6520 7374 7265 616d 0a66 6f72  arate stream.for
-00008670: 2061 6767 7265 6761 7465 2073 6e61 7073   aggregate snaps
-00008680: 686f 7473 2e20 5468 6520 736e 6170 7368  hots. The snapsh
-00008690: 6f74 2065 7665 6e74 2074 7970 6520 6973  ot event type is
-000086a0: 2070 7265 6669 7865 6420 7769 7468 2060   prefixed with `
-000086b0: 2724 2760 2073 6f20 7468 6174 2069 7420  '$'` so that it 
-000086c0: 6361 6e0a 6265 2066 696c 7465 7265 6420  can.be filtered 
-000086d0: 6f75 7420 7768 656e 2072 6561 6469 6e67  out when reading
-000086e0: 2061 6c6c 2065 7665 6e74 7320 6672 6f6d   all events from
-000086f0: 2074 6865 2064 6174 6162 6173 652e 0a0a   the database...
-00008700: 6060 6070 7974 686f 6e0a 6465 6620 7265  ```python.def re
-00008710: 6769 7374 6572 5f64 6f67 286e 616d 6529  gister_dog(name)
-00008720: 3a0a 2020 2020 646f 675f 6964 203d 2073  :.    dog_id = s
-00008730: 7472 2875 7569 6434 2829 290a 2020 2020  tr(uuid4()).    
-00008740: 6576 656e 7420 3d20 4e65 7745 7665 6e74  event = NewEvent
-00008750: 280a 2020 2020 2020 2020 7479 7065 3d27  (.        type='
-00008760: 446f 6752 6567 6973 7465 7265 6427 2c0a  DogRegistered',.
-00008770: 2020 2020 2020 2020 6461 7461 3d73 6572          data=ser
-00008780: 6961 6c69 7a65 287b 276e 616d 6527 3a20  ialize({'name': 
-00008790: 6e61 6d65 7d29 2c0a 2020 2020 290a 2020  name}),.    ).  
-000087a0: 2020 636c 6965 6e74 2e61 7070 656e 645f    client.append_
-000087b0: 6576 656e 7428 0a20 2020 2020 2020 2073  event(.        s
-000087c0: 7472 6561 6d5f 6e61 6d65 3d64 6f67 5f69  tream_name=dog_i
-000087d0: 642c 0a20 2020 2020 2020 2065 7870 6563  d,.        expec
-000087e0: 7465 645f 706f 7369 7469 6f6e 3d4e 6f6e  ted_position=Non
-000087f0: 652c 0a20 2020 2020 2020 2065 7665 6e74  e,.        event
-00008800: 3d65 7665 6e74 2c0a 2020 2020 290a 2020  =event,.    ).  
-00008810: 2020 7265 7475 726e 2064 6f67 5f69 640a    return dog_id.
-00008820: 0a0a 6465 6620 7265 636f 7264 5f74 7269  ..def record_tri
-00008830: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
-00008840: 642c 2074 7269 636b 293a 0a20 2020 2064  d, trick):.    d
-00008850: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
-00008860: 5f69 6429 0a20 2020 2065 7665 6e74 203d  _id).    event =
-00008870: 204e 6577 4576 656e 7428 0a20 2020 2020   NewEvent(.     
-00008880: 2020 2074 7970 653d 2744 6f67 4c65 6172     type='DogLear
-00008890: 6e65 6454 7269 636b 272c 0a20 2020 2020  nedTrick',.     
-000088a0: 2020 2064 6174 613d 7365 7269 616c 697a     data=serializ
-000088b0: 6528 7b27 7472 6963 6b27 3a20 7472 6963  e({'trick': tric
-000088c0: 6b7d 292c 0a20 2020 2029 0a20 2020 2063  k}),.    ).    c
-000088d0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-000088e0: 6e74 280a 2020 2020 2020 2020 7374 7265  nt(.        stre
-000088f0: 616d 5f6e 616d 653d 646f 675f 6964 2c0a  am_name=dog_id,.
-00008900: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00008910: 5f70 6f73 6974 696f 6e3d 646f 672e 7665  _position=dog.ve
-00008920: 7273 696f 6e2c 0a20 2020 2020 2020 2065  rsion,.        e
-00008930: 7665 6e74 3d65 7665 6e74 2c0a 2020 2020  vent=event,.    
-00008940: 290a 0a0a 6465 6620 736e 6170 7368 6f74  )...def snapshot
-00008950: 5f64 6f67 2864 6f67 5f69 6429 3a0a 2020  _dog(dog_id):.  
-00008960: 2020 646f 6720 3d20 6765 745f 646f 6728    dog = get_dog(
-00008970: 646f 675f 6964 290a 2020 2020 6576 656e  dog_id).    even
-00008980: 7420 3d20 4e65 7745 7665 6e74 280a 2020  t = NewEvent(.  
-00008990: 2020 2020 2020 7479 7065 3d27 2453 6e61        type='$Sna
-000089a0: 7073 686f 7427 2c0a 2020 2020 2020 2020  pshot',.        
-000089b0: 6461 7461 3d73 6572 6961 6c69 7a65 287b  data=serialize({
-000089c0: 276e 616d 6527 3a20 646f 672e 6e61 6d65  'name': dog.name
-000089d0: 2c20 2774 7269 636b 7327 3a20 646f 672e  , 'tricks': dog.
-000089e0: 7472 6963 6b73 7d29 2c0a 2020 2020 2020  tricks}),.      
-000089f0: 2020 6d65 7461 6461 7461 3d73 6572 6961    metadata=seria
-00008a00: 6c69 7a65 287b 2776 6572 7369 6f6e 273a  lize({'version':
-00008a10: 2064 6f67 2e76 6572 7369 6f6e 7d29 2c0a   dog.version}),.
-00008a20: 2020 2020 290a 2020 2020 636c 6965 6e74      ).    client
-00008a30: 2e61 7070 656e 645f 6576 656e 7428 0a20  .append_event(. 
-00008a40: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
-00008a50: 6d65 3d6d 616b 655f 736e 6170 7368 6f74  me=make_snapshot
-00008a60: 5f73 7472 6561 6d5f 6e61 6d65 2864 6f67  _stream_name(dog
-00008a70: 5f69 6429 2c0a 2020 2020 2020 2020 6578  _id),.        ex
-00008a80: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-00008a90: 2d31 2c0a 2020 2020 2020 2020 6576 656e  -1,.        even
-00008aa0: 743d 6576 656e 742c 0a20 2020 2029 0a60  t=event,.    ).`
-00008ab0: 6060 0a0a 4e6f 7720 7765 2063 616e 2072  ``..Now we can r
-00008ac0: 6567 6973 7465 7220 6120 6e65 7720 646f  egister a new do
-00008ad0: 672c 2061 6e64 2072 6563 6f72 6420 7468  g, and record th
-00008ae0: 6174 2073 6f6d 6520 7472 6963 6b73 2068  at some tricks h
-00008af0: 6176 6520 6265 656e 206c 6561 726e 6564  ave been learned
-00008b00: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2052  ...```python.# R
-00008b10: 6567 6973 7465 7220 6120 6e65 7720 646f  egister a new do
-00008b20: 672e 0a64 6f67 5f69 6420 3d20 7265 6769  g..dog_id = regi
-00008b30: 7374 6572 5f64 6f67 2827 4669 646f 2729  ster_dog('Fido')
-00008b40: 0a0a 646f 6720 3d20 6765 745f 646f 6728  ..dog = get_dog(
-00008b50: 646f 675f 6964 290a 6173 7365 7274 2064  dog_id).assert d
-00008b60: 6f67 2e6e 616d 6520 3d3d 2027 4669 646f  og.name == 'Fido
-00008b70: 270a 6173 7365 7274 2064 6f67 2e74 7269  '.assert dog.tri
-00008b80: 636b 7320 3d3d 205b 5d0a 6173 7365 7274  cks == [].assert
-00008b90: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
-00008ba0: 300a 6173 7365 7274 2064 6f67 2e69 735f  0.assert dog.is_
-00008bb0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
-00008bc0: 2046 616c 7365 0a0a 0a23 2052 6563 6f72   False...# Recor
-00008bd0: 6420 7468 6174 2027 4669 646f 2720 6c65  d that 'Fido' le
-00008be0: 6172 6e65 6420 6120 6e65 7720 7472 6963  arned a new tric
-00008bf0: 6b2e 0a72 6563 6f72 645f 7472 6963 6b5f  k..record_trick_
-00008c00: 6c65 6172 6e65 6428 646f 675f 6964 2c20  learned(dog_id, 
-00008c10: 7472 6963 6b3d 2772 6f6c 6c20 6f76 6572  trick='roll over
-00008c20: 2729 0a0a 646f 6720 3d20 6765 745f 646f  ')..dog = get_do
-00008c30: 6728 646f 675f 6964 290a 6173 7365 7274  g(dog_id).assert
-00008c40: 2064 6f67 2e6e 616d 6520 3d3d 2027 4669   dog.name == 'Fi
-00008c50: 646f 270a 6173 7365 7274 2064 6f67 2e74  do'.assert dog.t
-00008c60: 7269 636b 7320 3d3d 205b 2772 6f6c 6c20  ricks == ['roll 
-00008c70: 6f76 6572 275d 0a61 7373 6572 7420 646f  over'].assert do
-00008c80: 672e 7665 7273 696f 6e20 3d3d 2031 0a61  g.version == 1.a
-00008c90: 7373 6572 7420 646f 672e 6973 5f66 726f  ssert dog.is_fro
-00008ca0: 6d5f 736e 6170 7368 6f74 2069 7320 4661  m_snapshot is Fa
-00008cb0: 6c73 650a 0a0a 2320 5265 636f 7264 2074  lse...# Record t
-00008cc0: 6861 7420 2746 6964 6f27 206c 6561 726e  hat 'Fido' learn
-00008cd0: 6564 2061 6e6f 7468 6572 206e 6577 2074  ed another new t
-00008ce0: 7269 636b 2e0a 7265 636f 7264 5f74 7269  rick..record_tri
-00008cf0: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
-00008d00: 642c 2074 7269 636b 3d27 6665 7463 6820  d, trick='fetch 
-00008d10: 6261 6c6c 2729 0a0a 646f 6720 3d20 6765  ball')..dog = ge
-00008d20: 745f 646f 6728 646f 675f 6964 290a 6173  t_dog(dog_id).as
-00008d30: 7365 7274 2064 6f67 2e6e 616d 6520 3d3d  sert dog.name ==
-00008d40: 2027 4669 646f 270a 6173 7365 7274 2064   'Fido'.assert d
-00008d50: 6f67 2e74 7269 636b 7320 3d3d 205b 2772  og.tricks == ['r
-00008d60: 6f6c 6c20 6f76 6572 272c 2027 6665 7463  oll over', 'fetc
-00008d70: 6820 6261 6c6c 275d 0a61 7373 6572 7420  h ball'].assert 
-00008d80: 646f 672e 7665 7273 696f 6e20 3d3d 2032  dog.version == 2
-00008d90: 0a61 7373 6572 7420 646f 672e 6973 5f66  .assert dog.is_f
-00008da0: 726f 6d5f 736e 6170 7368 6f74 2069 7320  rom_snapshot is 
-00008db0: 4661 6c73 650a 6060 600a 0a41 6674 6572  False.```..After
-00008dc0: 2077 6520 6361 6c6c 2060 736e 6170 7368   we call `snapsh
-00008dd0: 6f74 5f64 6f67 2829 602c 2074 6865 2060  ot_dog()`, the `
-00008de0: 6765 745f 646f 6728 2960 2066 756e 6374  get_dog()` funct
-00008df0: 696f 6e20 7769 6c6c 2072 6574 7572 6e20  ion will return 
-00008e00: 6120 6044 6f67 600a 6f62 6a65 6374 2074  a `Dog`.object t
-00008e10: 6861 7420 6861 7320 6265 656e 2063 6f6e  hat has been con
-00008e20: 7374 7275 6374 6564 2075 7369 6e67 2074  structed using t
-00008e30: 6865 2060 2453 6e61 7073 686f 7460 2065  he `$Snapshot` e
-00008e40: 7665 6e74 2e0a 0a60 6060 7079 7468 6f6e  vent...```python
-00008e50: 0a23 2053 6e61 7073 686f 7420 2746 6964  .# Snapshot 'Fid
-00008e60: 6f27 2e0a 736e 6170 7368 6f74 5f64 6f67  o'..snapshot_dog
-00008e70: 2864 6f67 5f69 6429 0a0a 646f 6720 3d20  (dog_id)..dog = 
-00008e80: 6765 745f 646f 6728 646f 675f 6964 290a  get_dog(dog_id).
-00008e90: 6173 7365 7274 2064 6f67 2e6e 616d 6520  assert dog.name 
-00008ea0: 3d3d 2027 4669 646f 270a 6173 7365 7274  == 'Fido'.assert
-00008eb0: 2064 6f67 2e74 7269 636b 7320 3d3d 205b   dog.tricks == [
-00008ec0: 2772 6f6c 6c20 6f76 6572 272c 2027 6665  'roll over', 'fe
-00008ed0: 7463 6820 6261 6c6c 275d 0a61 7373 6572  tch ball'].asser
-00008ee0: 7420 646f 672e 7665 7273 696f 6e20 3d3d  t dog.version ==
-00008ef0: 2032 0a61 7373 6572 7420 646f 672e 6973   2.assert dog.is
-00008f00: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
-00008f10: 7320 5472 7565 0a60 6060 0a0a 5765 2063  s True.```..We c
-00008f20: 616e 2063 6f6e 7469 6e75 6520 746f 2065  an continue to e
-00008f30: 766f 6c76 6520 7468 6520 7374 6174 6520  volve the state 
-00008f40: 6f66 2074 6865 2060 446f 6760 2061 6767  of the `Dog` agg
-00008f50: 7265 6761 7465 2c20 7573 696e 670a 7468  regate, using.th
-00008f60: 6520 736e 6170 7368 6f74 2062 6f74 6820  e snapshot both 
-00008f70: 6475 7269 6e67 2074 6865 2063 616c 6c20  during the call 
-00008f80: 7468 6520 6072 6563 6f72 645f 7472 6963  the `record_tric
-00008f90: 6b5f 6c65 6172 6e65 6428 2960 2061 6e64  k_learned()` and
-00008fa0: 0a77 6865 6e20 6361 6c6c 696e 6720 6067  .when calling `g
-00008fb0: 6574 5f64 6f67 2829 602e 0a0a 6060 6070  et_dog()`...```p
-00008fc0: 7974 686f 6e0a 7265 636f 7264 5f74 7269  ython.record_tri
-00008fd0: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
-00008fe0: 642c 2074 7269 636b 3d27 7369 7427 290a  d, trick='sit').
-00008ff0: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
-00009000: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
-00009010: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
-00009020: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
-00009030: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
-00009040: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
-00009050: 2c20 2773 6974 275d 0a61 7373 6572 7420  , 'sit'].assert 
-00009060: 646f 672e 7665 7273 696f 6e20 3d3d 2033  dog.version == 3
-00009070: 0a61 7373 6572 7420 646f 672e 6973 5f66  .assert dog.is_f
-00009080: 726f 6d5f 736e 6170 7368 6f74 2069 7320  rom_snapshot is 
-00009090: 5472 7565 0a60 6060 0a0a 5765 2063 616e  True.```..We can
-000090a0: 2073 6565 2066 726f 6d20 7468 6520 6069   see from the `i
-000090b0: 735f 6672 6f6d 5f73 6e61 7073 686f 7460  s_from_snapshot`
-000090c0: 2061 7474 7269 6275 7465 2074 6861 7420   attribute that 
-000090d0: 7468 6520 6044 6f67 6020 6f62 6a65 6374  the `Dog` object
-000090e0: 2077 6173 2069 6e64 6565 640a 7265 636f   was indeed.reco
-000090f0: 6e73 7472 7563 7465 6420 6672 6f6d 2074  nstructed from t
-00009100: 6865 2073 6e61 7073 686f 742e 0a0a 0a23  he snapshot....#
-00009110: 2323 2052 6561 6420 616c 6c20 6576 656e  ## Read all even
-00009120: 7473 0a0a 5468 6520 6d65 7468 6f64 2060  ts..The method `
-00009130: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-00009140: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
-00009150: 6f20 7265 6164 2061 6c6c 2072 6563 6f72  o read all recor
-00009160: 6465 6420 6576 656e 7473 0a69 6e20 7468  ded events.in th
-00009170: 6520 6461 7461 6261 7365 2069 6e20 7468  e database in th
-00009180: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
-00009190: 6520 7265 636f 7264 6564 2e20 4974 2072  e recorded. It r
-000091a0: 6574 7572 6e73 2061 6e20 6974 6572 6162  eturns an iterab
-000091b0: 6c65 206f 660a 6576 656e 7473 2074 6861  le of.events tha
-000091c0: 7420 6861 7665 2062 6565 6e20 7265 636f  t have been reco
-000091d0: 7264 6564 2069 6e20 7468 6520 6461 7461  rded in the data
-000091e0: 6261 7365 2e20 4974 6572 6174 696e 6720  base. Iterating 
-000091f0: 6f76 6572 2074 6869 7320 6974 6572 6162  over this iterab
-00009200: 6c65 0a6f 626a 6563 7420 7769 6c6c 2073  le.object will s
-00009210: 746f 7020 7768 656e 2069 7420 6861 7320  top when it has 
-00009220: 7969 656c 6465 6420 7468 6520 6c61 7374  yielded the last
-00009230: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
-00009240: 2054 6865 2072 6563 6569 7665 640a 7265   The received.re
-00009250: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
-00009260: 6563 7420 6172 6520 696e 7374 616e 6365  ect are instance
-00009270: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
-00009280: 6564 4576 656e 7460 2063 6c61 7373 2028  edEvent` class (
-00009290: 7365 6520 7468 650a 4e6f 7465 7320 7365  see the.Notes se
-000092a0: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-000092b0: 6465 7461 696c 7320 6f66 2074 6869 7320  details of this 
-000092c0: 636c 6173 7329 2e0a 0a54 6869 7320 6d65  class)...This me
-000092d0: 7468 6f64 2073 7570 706f 7274 7320 7365  thod supports se
-000092e0: 7665 6e20 6f70 7469 6f6e 616c 2061 7267  ven optional arg
-000092f0: 756d 656e 7473 2c20 6063 6f6d 6d69 745f  uments, `commit_
-00009300: 706f 7369 7469 6f6e 602c 2060 6261 636b  position`, `back
-00009310: 7761 7264 7360 2c0a 6066 696c 7465 725f  wards`,.`filter_
-00009320: 6578 636c 7564 6560 2c20 6066 696c 7465  exclude`, `filte
-00009330: 725f 696e 636c 7564 6560 2c20 6066 696c  r_include`, `fil
-00009340: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
-00009350: 6d65 602c 2060 6c69 6d69 7460 2c20 616e  me`, `limit`, an
-00009360: 6420 6074 696d 656f 7574 602e 0a0a 5468  d `timeout`...Th
-00009370: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
-00009380: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
-00009390: 756d 656e 7420 6973 2061 6e20 6f70 7469  ument is an opti
-000093a0: 6f6e 616c 2069 6e74 6567 6572 2074 6861  onal integer tha
-000093b0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-000093c0: 0a73 7065 6369 6679 2074 6865 2063 6f6d  .specify the com
-000093d0: 6d69 7420 706f 7369 7469 6f6e 2066 726f  mit position fro
-000093e0: 6d20 7768 6963 6820 746f 2073 7461 7274  m which to start
-000093f0: 2072 6561 6469 6e67 2e20 5468 6973 2061   reading. This a
-00009400: 7267 756d 656e 7420 6973 2060 4e6f 6e65  rgument is `None
-00009410: 6020 6279 0a64 6566 6175 6c74 2c20 6d65  ` by.default, me
-00009420: 616e 696e 6720 7468 6174 2061 6c6c 2074  aning that all t
-00009430: 6865 2065 7665 6e74 7320 7769 6c6c 2062  he events will b
-00009440: 6520 7265 6164 2065 6974 6865 7220 6672  e read either fr
-00009450: 6f6d 2074 6865 2073 7461 7274 2c20 6f72  om the start, or
-00009460: 0a66 726f 6d20 7468 6520 656e 6420 6966  .from the end if
-00009470: 2060 6261 636b 7761 7264 7360 2069 7320   `backwards` is 
-00009480: 6054 7275 6560 2e20 506c 6561 7365 206e  `True`. Please n
-00009490: 6f74 652c 2069 6620 6120 636f 6d6d 6974  ote, if a commit
-000094a0: 2070 6f73 6974 696f 6e20 6973 2073 7065   position is spe
-000094b0: 6369 6669 6564 2c0a 6974 206d 7573 7420  cified,.it must 
-000094c0: 6265 2061 6e20 6163 7475 616c 6c79 2065  be an actually e
-000094d0: 7869 7374 696e 6720 636f 6d6d 6974 2070  xisting commit p
-000094e0: 6f73 6974 696f 6e20 696e 2074 6865 2064  osition in the d
-000094f0: 6174 6162 6173 652e 0a41 6e79 206f 7468  atabase..Any oth
-00009500: 6572 206e 756d 6265 7220 7769 6c6c 2072  er number will r
-00009510: 6573 756c 7420 696e 2061 2073 6572 7665  esult in a serve
-00009520: 7220 6572 726f 7220 2861 7420 6c65 6173  r error (at leas
-00009530: 7420 696e 2045 7665 6e74 5374 6f72 6544  t in EventStoreD
-00009540: 4220 7632 312e 3130 292e 0a0a 5468 6520  B v21.10)...The 
-00009550: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
-00009560: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
-00009570: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
-00009580: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00009590: 2060 4661 6c73 6560 2c20 7768 6963 680a   `False`, which.
-000095a0: 6d65 616e 7320 7468 6520 6461 7461 6261  means the databa
-000095b0: 7365 2077 696c 6c20 6265 2072 6561 6420  se will be read 
-000095c0: 666f 7277 6172 6473 2062 7920 6465 6661  forwards by defa
-000095d0: 756c 742c 2073 6f20 7468 6174 2065 7665  ult, so that eve
-000095e0: 6e74 7320 6172 6520 7265 7475 726e 6564  nts are returned
-000095f0: 2069 6e20 7468 650a 6f72 6465 7220 7468   in the.order th
-00009600: 6579 2077 6572 6520 7265 636f 7264 6564  ey were recorded
-00009610: 2c20 4966 2060 6261 636b 7761 7264 7360  , If `backwards`
-00009620: 2069 7320 6054 7275 6560 2c20 7468 6520   is `True`, the 
-00009630: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
-00009640: 6e65 6420 696e 2072 6576 6572 7365 0a6f  ned in reverse.o
-00009650: 7264 6572 2e0a 0a54 6865 206f 7074 696f  rder...The optio
-00009660: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
-00009670: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
-00009680: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-00009690: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-000096a0: 6e73 2074 6861 740a 6d61 7463 6820 7265  ns that.match re
-000096b0: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
-000096c0: 6174 2073 686f 756c 6420 6e6f 7420 6265  at should not be
-000096d0: 2069 6e63 6c75 6465 642e 2054 6869 7320   included. This 
-000096e0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-000096f0: 7265 640a 6966 2060 6669 6c74 6572 5f69  red.if `filter_i
-00009700: 6e63 6c75 6465 6020 6973 2073 6574 2074  nclude` is set t
-00009710: 6f20 6120 6e6f 6e2d 656d 7074 7920 7365  o a non-empty se
-00009720: 7175 656e 6365 2e20 4279 2064 6566 6175  quence. By defau
-00009730: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
-00009740: 7420 6973 2073 6574 0a74 6f20 6d61 7463  t is set.to matc
-00009750: 6820 7468 6520 6576 656e 7420 7479 7065  h the event type
-00009760: 7320 6f66 2022 7379 7374 656d 2065 7665  s of "system eve
-00009770: 6e74 7322 2c20 736f 2074 6861 7420 4576  nts", so that Ev
-00009780: 656e 7453 746f 7265 4442 2073 7973 7465  entStoreDB syste
-00009790: 6d20 6576 656e 7473 0a77 696c 6c20 6e6f  m events.will no
-000097a0: 7420 6e6f 726d 616c 6c79 2062 6520 696e  t normally be in
-000097b0: 636c 7564 6564 2e20 5365 6520 7468 6520  cluded. See the 
-000097c0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-000097d0: 6c6f 7720 666f 7220 6d6f 7265 2069 6e66  low for more inf
-000097e0: 6f72 6d61 7469 6f6e 0a61 626f 7574 2066  ormation.about f
-000097f0: 696c 7465 7220 6578 7072 6573 7369 6f6e  ilter expression
-00009800: 732e 0a0a 5468 6520 6f70 7469 6f6e 616c  s...The optional
-00009810: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
-00009820: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00009830: 7365 7175 656e 6365 206f 6620 7265 6775  sequence of regu
-00009840: 6c61 7220 6578 7072 6573 7369 6f6e 730a  lar expressions.
-00009850: 7468 6174 206d 6174 6368 2072 6563 6f72  that match recor
-00009860: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
-00009870: 7368 6f75 6c64 2062 6520 696e 636c 7564  should be includ
-00009880: 6564 2e20 4279 2064 6566 6175 6c74 2c20  ed. By default, 
-00009890: 7468 6973 2061 7267 756d 656e 740a 6973  this argument.is
-000098a0: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
-000098b0: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
-000098c0: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
-000098d0: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
-000098e0: 2c20 7468 650a 6066 696c 7465 725f 6578  , the.`filter_ex
-000098f0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
-00009900: 6973 2069 676e 6f72 6564 2e0a 0a54 6865  is ignored...The
-00009910: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
-00009920: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
-00009930: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00009940: 5079 7468 6f6e 2060 626f 6f6c 6020 7468  Python `bool` th
-00009950: 6174 2069 6e64 6963 6174 6573 2077 6865  at indicates whe
-00009960: 7468 6572 0a74 6865 2066 696c 7465 7220  ther.the filter 
-00009970: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
-00009980: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
-00009990: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
-000099a0: 6661 756c 742c 2074 6869 7320 7661 6c75  fault, this valu
-000099b0: 6520 6973 2060 4661 6c73 6560 0a61 6e64  e is `False`.and
-000099c0: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
-000099d0: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
-000099e0: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
-000099f0: 7472 696e 6773 206f 6620 7265 636f 7264  trings of record
-00009a00: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
-00009a10: 6f70 7469 6f6e 616c 2060 6c69 6d69 7460  optional `limit`
-00009a20: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
-00009a30: 696e 7465 6765 7220 7768 6963 6820 7265  integer which re
-00009a40: 7374 7269 6374 7320 7468 6520 6e75 6d62  stricts the numb
-00009a50: 6572 206f 6620 6576 656e 7473 2074 6861  er of events tha
-00009a60: 740a 7769 6c6c 2062 6520 7265 7475 726e  t.will be return
-00009a70: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
-00009a80: 7661 6c75 6520 6973 2060 7379 732e 6d61  value is `sys.ma
-00009a90: 7869 6e74 602e 0a0a 5468 6520 6f70 7469  xint`...The opti
-00009aa0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00009ab0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00009ac0: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
-00009ad0: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
-00009ae0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-00009af0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00009b00: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
-00009b10: 2066 696c 7465 7269 6e67 206f 6620 6576   filtering of ev
-00009b20: 656e 7473 2069 7320 646f 6e65 206f 6e20  ents is done on 
-00009b30: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
-00009b40: 2073 6572 7665 722e 2054 6865 0a60 6c69   server. The.`li
-00009b50: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
-00009b60: 2061 7070 6c69 6564 206f 6e20 7468 6520   applied on the 
-00009b70: 7365 7276 6572 2061 6674 6572 2066 696c  server after fil
-00009b80: 7465 7269 6e67 2e0a 0a57 6865 6e20 7265  tering...When re
-00009b90: 6164 696e 6720 666f 7277 6172 6473 2066  ading forwards f
-00009ba0: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-00009bb0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
-00009bc0: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
-00009bd0: 2073 7065 6369 6669 6564 0a70 6f73 6974   specified.posit
-00009be0: 696f 6e20 5749 4c4c 2062 6520 696e 636c  ion WILL be incl
-00009bf0: 7564 6564 2e20 486f 7765 7665 722c 2077  uded. However, w
-00009c00: 6865 6e20 7265 6164 696e 6720 6261 636b  hen reading back
-00009c10: 7761 7264 732c 2074 6865 2065 7665 6e74  wards, the event
-00009c20: 2061 7420 7468 650a 7370 6563 6966 6965   at the.specifie
-00009c30: 6420 706f 7369 7469 6f6e 2077 696c 6c20  d position will 
-00009c40: 4e4f 5420 6265 2069 6e63 6c75 6465 642e  NOT be included.
-00009c50: 2028 5468 6973 206e 6f6e 2d69 6e63 6c75   (This non-inclu
-00009c60: 7369 7665 2062 6568 6176 696f 7572 2c20  sive behaviour, 
-00009c70: 6f66 2065 7863 6c75 6469 6e67 0a74 6865  of excluding.the
-00009c80: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-00009c90: 7420 706f 7369 7469 6f6e 2077 6865 6e20  t position when 
-00009ca0: 7265 6164 696e 6720 616c 6c20 7374 7265  reading all stre
-00009cb0: 616d 7320 6261 636b 7761 7264 732c 2064  ams backwards, d
-00009cc0: 6966 6665 7273 2066 726f 6d20 7468 650a  iffers from the.
-00009cd0: 6265 6861 7669 6f75 7220 7768 656e 2072  behaviour when r
-00009ce0: 6561 6469 6e67 2061 2073 7472 6561 6d20  eading a stream 
-00009cf0: 6261 636b 7761 7264 7320 6672 6f6d 2061  backwards from a
-00009d00: 2073 7065 6369 6669 6320 7374 7265 616d   specific stream
-00009d10: 2070 6f73 6974 696f 6e2e 290a 0a54 6865   position.)..The
-00009d20: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-00009d30: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-00009d40: 2061 6c6c 2065 7665 6e74 7320 696e 2074   all events in t
-00009d50: 6865 2064 6174 6162 6173 6520 696e 2074  he database in t
-00009d60: 6865 0a6f 7264 6572 2074 6865 7920 7765  he.order they we
-00009d70: 7265 2072 6563 6f72 6465 642e 0a0a 6060  re recorded...``
-00009d80: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
-00009d90: 206c 6973 7428 636c 6965 6e74 2e72 6561   list(client.rea
-00009da0: 645f 616c 6c5f 6576 656e 7473 2829 290a  d_all_events()).
-00009db0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-00009dc0: 7473 2920 3e3d 2033 0a60 6060 0a0a 5468  ts) >= 3.```..Th
-00009dd0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00009de0: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-00009df0: 6420 616c 6c20 7265 636f 7264 6564 2065  d all recorded e
-00009e00: 7665 6e74 7320 6672 6f6d 2061 2073 7065  vents from a spe
-00009e10: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
-00009e20: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
-00009e30: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
-00009e40: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
-00009e50: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
-00009e60: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
-00009e70: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
-00009e80: 7469 6f6e 310a 2020 2020 290a 290a 0a61  tion1.    ).)..a
-00009e90: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00009ea0: 2920 3d3d 2037 0a0a 6173 7365 7274 2065  ) == 7..assert e
-00009eb0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-00009ec0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-00009ed0: 616d 6531 0a61 7373 6572 7420 6576 656e  ame1.assert even
-00009ee0: 7473 5b30 5d2e 7374 7265 616d 5f70 6f73  ts[0].stream_pos
-00009ef0: 6974 696f 6e20 3d3d 2030 0a61 7373 6572  ition == 0.asser
-00009f00: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
-00009f10: 203d 3d20 6576 656e 7431 2e74 7970 650a   == event1.type.
-00009f20: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00009f30: 2e64 6174 6120 3d3d 2065 7665 6e74 312e  .data == event1.
-00009f40: 6461 7461 0a0a 6173 7365 7274 2065 7665  data..assert eve
-00009f50: 6e74 735b 315d 2e73 7472 6561 6d5f 6e61  nts[1].stream_na
-00009f60: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-00009f70: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
-00009f80: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
-00009f90: 696f 6e20 3d3d 2031 0a61 7373 6572 7420  ion == 1.assert 
-00009fa0: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
-00009fb0: 3d20 6576 656e 7432 2e74 7970 650a 6173  = event2.type.as
-00009fc0: 7365 7274 2065 7665 6e74 735b 315d 2e64  sert events[1].d
-00009fd0: 6174 6120 3d3d 2065 7665 6e74 322e 6461  ata == event2.da
-00009fe0: 7461 0a0a 6173 7365 7274 2065 7665 6e74  ta..assert event
-00009ff0: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
-0000a000: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-0000a010: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
-0000a020: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-0000a030: 6e20 3d3d 2032 0a61 7373 6572 7420 6576  n == 2.assert ev
-0000a040: 656e 7473 5b32 5d2e 7479 7065 203d 3d20  ents[2].type == 
-0000a050: 6576 656e 7433 2e74 7970 650a 6173 7365  event3.type.asse
-0000a060: 7274 2065 7665 6e74 735b 325d 2e64 6174  rt events[2].dat
-0000a070: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-0000a080: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-0000a090: 335d 2e74 7970 6520 3d3d 2022 446f 6752  3].type == "DogR
-0000a0a0: 6567 6973 7465 7265 6422 0a61 7373 6572  egistered".asser
-0000a0b0: 7420 6576 656e 7473 5b34 5d2e 7479 7065  t events[4].type
-0000a0c0: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
-0000a0d0: 7269 636b 220a 6173 7365 7274 2065 7665  rick".assert eve
-0000a0e0: 6e74 735b 355d 2e74 7970 6520 3d3d 2022  nts[5].type == "
-0000a0f0: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
-0000a100: 0a61 7373 6572 7420 6576 656e 7473 5b36  .assert events[6
-0000a110: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-0000a120: 6172 6e65 6454 7269 636b 220a 6060 600a  arnedTrick".```.
-0000a130: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000a140: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-0000a150: 7265 6164 2061 6c6c 2072 6563 6f72 6465  read all recorde
-0000a160: 6420 6576 656e 7473 2069 6e20 7265 7665  d events in reve
-0000a170: 7273 6520 6f72 6465 722e 0a0a 6060 6070  rse order...```p
-0000a180: 7974 686f 6e0a 6576 656e 7473 203d 206c  ython.events = l
-0000a190: 6973 7428 0a20 2020 2063 6c69 656e 742e  ist(.    client.
-0000a1a0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-0000a1b0: 0a20 2020 2020 2020 2062 6163 6b77 6172  .        backwar
-0000a1c0: 6473 3d54 7275 650a 2020 2020 290a 290a  ds=True.    ).).
-0000a1d0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-0000a1e0: 7473 2920 3e3d 2033 0a0a 6173 7365 7274  ts) >= 3..assert
-0000a1f0: 2065 7665 6e74 735b 305d 2e74 7970 6520   events[0].type 
-0000a200: 3d3d 2022 446f 674c 6561 726e 6564 5472  == "DogLearnedTr
-0000a210: 6963 6b22 0a61 7373 6572 7420 6576 656e  ick".assert even
-0000a220: 7473 5b31 5d2e 7479 7065 203d 3d20 2244  ts[1].type == "D
-0000a230: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
-0000a240: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-0000a250: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
-0000a260: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
-0000a270: 7420 6576 656e 7473 5b33 5d2e 7479 7065  t events[3].type
-0000a280: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
-0000a290: 6564 220a 0a61 7373 6572 7420 6576 656e  ed"..assert even
-0000a2a0: 7473 5b34 5d2e 7374 7265 616d 5f6e 616d  ts[4].stream_nam
-0000a2b0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-0000a2c0: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-0000a2d0: 345d 2e73 7472 6561 6d5f 706f 7369 7469  4].stream_positi
-0000a2e0: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
-0000a2f0: 7665 6e74 735b 345d 2e74 7970 6520 3d3d  vents[4].type ==
-0000a300: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
-0000a310: 6572 7420 6576 656e 7473 5b34 5d2e 6461  ert events[4].da
-0000a320: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
-0000a330: 610a 0a61 7373 6572 7420 6576 656e 7473  a..assert events
-0000a340: 5b35 5d2e 7374 7265 616d 5f6e 616d 6520  [5].stream_name 
-0000a350: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
-0000a360: 6173 7365 7274 2065 7665 6e74 735b 355d  assert events[5]
-0000a370: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-0000a380: 203d 3d20 310a 6173 7365 7274 2065 7665   == 1.assert eve
-0000a390: 6e74 735b 355d 2e74 7970 6520 3d3d 2065  nts[5].type == e
-0000a3a0: 7665 6e74 322e 7479 7065 0a61 7373 6572  vent2.type.asser
-0000a3b0: 7420 6576 656e 7473 5b35 5d2e 6461 7461  t events[5].data
-0000a3c0: 203d 3d20 6576 656e 7432 2e64 6174 610a   == event2.data.
-0000a3d0: 0a61 7373 6572 7420 6576 656e 7473 5b36  .assert events[6
-0000a3e0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-0000a3f0: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-0000a400: 7365 7274 2065 7665 6e74 735b 365d 2e73  sert events[6].s
-0000a410: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-0000a420: 3d20 300a 6173 7365 7274 2065 7665 6e74  = 0.assert event
-0000a430: 735b 365d 2e74 7970 6520 3d3d 2065 7665  s[6].type == eve
-0000a440: 6e74 312e 7479 7065 0a61 7373 6572 7420  nt1.type.assert 
-0000a450: 6576 656e 7473 5b36 5d2e 6461 7461 203d  events[6].data =
-0000a460: 3d20 6576 656e 7431 2e64 6174 610a 0a60  = event1.data..`
-0000a470: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
-0000a480: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-0000a490: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
-0000a4a0: 6420 6e75 6d62 6572 2028 6f6e 6529 206f  d number (one) o
-0000a4b0: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-0000a4c0: 7665 6e74 730a 696e 2074 6865 2064 6174  vents.in the dat
-0000a4d0: 6162 6173 6520 666f 7277 6172 6473 2066  abase forwards f
-0000a4e0: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-0000a4f0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e20  ommit position. 
-0000a500: 506c 6561 7365 206e 6f74 652c 2077 6865  Please note, whe
-0000a510: 6e20 7265 6164 696e 670a 616c 6c20 6576  n reading.all ev
-0000a520: 656e 7473 2066 6f72 7761 7264 7320 6672  ents forwards fr
-0000a530: 6f6d 2061 2073 7065 6369 6669 6320 636f  om a specific co
-0000a540: 6d6d 6974 2070 6f73 6974 696f 6e2c 2074  mmit position, t
-0000a550: 6865 2065 7665 6e74 2061 7420 7468 6520  he event at the 
-0000a560: 7370 6563 6966 6965 640a 706f 7369 7469  specified.positi
-0000a570: 6f6e 2057 494c 4c20 6265 2069 6e63 6c75  on WILL be inclu
-0000a580: 6465 642e 0a0a 0a60 6060 7079 7468 6f6e  ded....```python
-0000a590: 0a65 7665 6e74 7320 3d20 6c69 7374 280a  .events = list(.
-0000a5a0: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
-0000a5b0: 616c 6c5f 6576 656e 7473 280a 2020 2020  all_events(.    
-0000a5c0: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
-0000a5d0: 696f 6e3d 636f 6d6d 6974 5f70 6f73 6974  ion=commit_posit
-0000a5e0: 696f 6e31 2c0a 2020 2020 2020 2020 6c69  ion1,.        li
-0000a5f0: 6d69 743d 312c 0a20 2020 2029 0a29 0a0a  mit=1,.    ).)..
-0000a600: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-0000a610: 7329 203d 3d20 310a 0a61 7373 6572 7420  s) == 1..assert 
-0000a620: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-0000a630: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000a640: 6e61 6d65 310a 6173 7365 7274 2065 7665  name1.assert eve
-0000a650: 6e74 735b 305d 2e73 7472 6561 6d5f 706f  nts[0].stream_po
-0000a660: 7369 7469 6f6e 203d 3d20 300a 6173 7365  sition == 0.asse
-0000a670: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
-0000a680: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
-0000a690: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-0000a6a0: 5d2e 6461 7461 203d 3d20 6576 656e 7431  ].data == event1
-0000a6b0: 2e64 6174 610a 0a61 7373 6572 7420 6576  .data..assert ev
-0000a6c0: 656e 7473 5b30 5d2e 636f 6d6d 6974 5f70  ents[0].commit_p
-0000a6d0: 6f73 6974 696f 6e20 3d3d 2063 6f6d 6d69  osition == commi
-0000a6e0: 745f 706f 7369 7469 6f6e 310a 6060 600a  t_position1.```.
-0000a6f0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000a700: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-0000a710: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
-0000a720: 756d 6265 7220 286f 6e65 2920 6f66 2074  umber (one) of t
-0000a730: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000a740: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
-0000a750: 7365 2062 6163 6b77 6172 6473 2066 726f  se backwards fro
-0000a760: 6d20 7468 6520 656e 642e 2054 6869 7320  m the end. This 
-0000a770: 6769 7665 7320 7468 6520 6c61 7374 2072  gives the last r
-0000a780: 6563 6f72 6465 6420 6576 656e 742e 0a0a  ecorded event...
-0000a790: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
-0000a7a0: 203d 206c 6973 7428 0a20 2020 2063 6c69   = list(.    cli
-0000a7b0: 656e 742e 7265 6164 5f61 6c6c 5f65 7665  ent.read_all_eve
-0000a7c0: 6e74 7328 0a20 2020 2020 2020 2062 6163  nts(.        bac
-0000a7d0: 6b77 6172 6473 3d54 7275 652c 0a20 2020  kwards=True,.   
-0000a7e0: 2020 2020 206c 696d 6974 3d31 2c0a 2020       limit=1,.  
-0000a7f0: 2020 290a 290a 0a61 7373 6572 7420 6c65    ).)..assert le
-0000a800: 6e28 6576 656e 7473 2920 3d3d 2031 0a0a  n(events) == 1..
-0000a810: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-0000a820: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
-0000a830: 726e 6564 5472 6963 6b22 0a60 6060 0a0a  rnedTrick".```..
-0000a840: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-0000a850: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
-0000a860: 6561 6420 6120 6c69 6d69 7465 6420 6e75  ead a limited nu
-0000a870: 6d62 6572 2028 6f6e 6529 206f 6620 7468  mber (one) of th
-0000a880: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-0000a890: 730a 696e 2074 6865 2064 6174 6162 6173  s.in the databas
-0000a8a0: 6520 6261 636b 7761 7264 7320 6672 6f6d  e backwards from
-0000a8b0: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
-0000a8c0: 6974 2070 6f73 6974 696f 6e2e 2050 6c65  it position. Ple
-0000a8d0: 6173 6520 6e6f 7465 2c20 7768 656e 2072  ase note, when r
-0000a8e0: 6561 6469 6e67 0a61 6c6c 2065 7665 6e74  eading.all event
-0000a8f0: 7320 6261 636b 7761 7264 7320 6672 6f6d  s backwards from
-0000a900: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
-0000a910: 6974 2070 6f73 6974 696f 6e2c 2074 6865  it position, the
-0000a920: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
-0000a930: 6563 6966 6965 640a 706f 7369 7469 6f6e  ecified.position
-0000a940: 2057 494c 4c20 4e4f 5420 6265 2069 6e63   WILL NOT be inc
-0000a950: 6c75 6465 642e 0a0a 6060 6070 7974 686f  luded...```pytho
-0000a960: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
-0000a970: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
-0000a980: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
-0000a990: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
-0000a9a0: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
-0000a9b0: 7469 6f6e 322c 0a20 2020 2020 2020 2062  tion2,.        b
-0000a9c0: 6163 6b77 6172 6473 3d54 7275 652c 0a20  ackwards=True,. 
-0000a9d0: 2020 2020 2020 206c 696d 6974 3d31 2c0a         limit=1,.
-0000a9e0: 2020 2020 290a 290a 0a61 7373 6572 7420      ).)..assert 
-0000a9f0: 6c65 6e28 6576 656e 7473 2920 3d3d 2031  len(events) == 1
-0000aa00: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-0000aa10: 305d 2e63 6f6d 6d69 745f 706f 7369 7469  0].commit_positi
-0000aa20: 6f6e 203c 2063 6f6d 6d69 745f 706f 7369  on < commit_posi
-0000aa30: 7469 6f6e 320a 6060 600a 0a0a 2323 2320  tion2.```...### 
-0000aa40: 4765 7420 6375 7272 656e 7420 7374 7265  Get current stre
-0000aa50: 616d 2070 6f73 6974 696f 6e0a 0a54 6865  am position..The
-0000aa60: 2060 6765 745f 7374 7265 616d 5f70 6f73   `get_stream_pos
-0000aa70: 6974 696f 6e28 2960 206d 6574 686f 6420  ition()` method 
-0000aa80: 6361 6e20 6265 2075 7365 6420 746f 0a67  can be used to.g
-0000aa90: 6574 2074 6865 2022 7374 7265 616d 2070  et the "stream p
-0000aaa0: 6f73 6974 696f 6e22 206f 6620 7468 6520  osition" of the 
-0000aab0: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
-0000aac0: 656e 7420 696e 2061 2073 7472 6561 6d2e  ent in a stream.
-0000aad0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
-0000aae0: 7320 6120 6073 7472 6561 6d5f 6e61 6d65  s a `stream_name
-0000aaf0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-0000ab00: 6820 6973 2072 6571 7569 7265 642e 0a0a  h is required...
-0000ab10: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-0000ab20: 2074 616b 6573 2061 6e20 6f70 7469 6f6e   takes an option
-0000ab30: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-0000ab40: 756d 656e 742c 2074 6861 740a 6973 2065  ument, that.is e
-0000ab50: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-0000ab60: 5079 7468 6f6e 2060 666c 6f61 7460 2c20  Python `float`, 
-0000ab70: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
-0000ab80: 646c 696e 650a 666f 7220 7468 6520 636f  dline.for the co
-0000ab90: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-0000aba0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
-0000abb0: 0a54 6865 2073 6571 7565 6e63 6520 6f66  .The sequence of
-0000abc0: 2070 6f73 6974 696f 6e73 2069 6e20 6120   positions in a 
-0000abd0: 7374 7265 616d 2069 7320 6761 706c 6573  stream is gaples
-0000abe0: 732e 2049 7420 6973 207a 6572 6f2d 6261  s. It is zero-ba
-0000abf0: 7365 642c 0a73 6f20 7468 6174 2061 2073  sed,.so that a s
-0000ac00: 7472 6561 6d20 7769 7468 206f 6e65 2072  tream with one r
-0000ac10: 6563 6f72 6465 6420 6576 656e 7420 6861  ecorded event ha
-0000ac20: 7320 6120 6375 7272 656e 7420 7374 7265  s a current stre
-0000ac30: 616d 0a70 6f73 6974 696f 6e20 6f66 2060  am.position of `
-0000ac40: 3060 2e20 5468 6520 6375 7272 656e 7420  0`. The current 
-0000ac50: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-0000ac60: 6973 2060 3160 2077 6865 6e20 6120 7374  is `1` when a st
-0000ac70: 7265 616d 2068 6173 0a74 776f 2065 7665  ream has.two eve
-0000ac80: 6e74 732c 2061 6e64 2069 7420 6973 2060  nts, and it is `
-0000ac90: 3260 2077 6865 6e20 7468 6572 6520 6172  2` when there ar
-0000aca0: 6520 6576 656e 7473 2c20 616e 6420 736f  e events, and so
-0000acb0: 206f 6e2e 0a0a 496e 2074 6865 2065 7861   on...In the exa
-0000acc0: 6d70 6c65 2062 656c 6f77 2c20 7468 6520  mple below, the 
-0000acd0: 6375 7272 656e 7420 7374 7265 616d 2070  current stream p
-0000ace0: 6f73 6974 696f 6e20 6973 206f 6274 6169  osition is obtai
-0000acf0: 6e65 6420 6f66 2074 6865 0a73 7472 6561  ned of the.strea
-0000ad00: 6d20 746f 2077 6869 6368 2065 7665 6e74  m to which event
-0000ad10: 7320 7765 7265 2061 7070 656e 6465 6420  s were appended 
-0000ad20: 696e 2074 6865 2065 7861 6d70 6c65 7320  in the examples 
-0000ad30: 6162 6f76 652e 0a42 6563 6175 7365 2074  above..Because t
-0000ad40: 6865 2073 6571 7565 6e63 6520 6f66 2073  he sequence of s
-0000ad50: 7472 6561 6d20 706f 7369 7469 6f6e 7320  tream positions 
-0000ad60: 6973 207a 6572 6f2d 6261 7365 642c 2061  is zero-based, a
-0000ad70: 6e64 2062 6563 6175 7365 0a74 6872 6565  nd because.three
-0000ad80: 2065 7665 6e74 7320 7765 7265 2061 7070   events were app
-0000ad90: 656e 6465 642c 2073 6f20 7468 6520 6375  ended, so the cu
-0000ada0: 7272 656e 7420 7374 7265 616d 2070 6f73  rrent stream pos
-0000adb0: 6974 696f 6e20 6973 2060 3260 2e0a 0a60  ition is `2`...`
-0000adc0: 6060 7079 7468 6f6e 0a73 7472 6561 6d5f  ``python.stream_
-0000add0: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
-0000ade0: 742e 6765 745f 7374 7265 616d 5f70 6f73  t.get_stream_pos
-0000adf0: 6974 696f 6e28 0a20 2020 2073 7472 6561  ition(.    strea
-0000ae00: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000ae10: 6d65 310a 290a 0a61 7373 6572 7420 7374  me1.)..assert st
-0000ae20: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-0000ae30: 2032 0a60 6060 0a0a 4966 2061 2073 7472   2.```..If a str
-0000ae40: 6561 6d20 646f 6573 206e 6f74 2065 7869  eam does not exi
-0000ae50: 7374 2c20 7468 6520 7265 7475 726e 6564  st, the returned
-0000ae60: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-0000ae70: 2076 616c 7565 2069 7320 604e 6f6e 6560   value is `None`
-0000ae80: 2c0a 7768 6963 6820 6d61 7463 6865 7320  ,.which matches 
-0000ae90: 7468 6520 7265 7175 6972 6564 2065 7870  the required exp
-0000aea0: 6563 7465 6420 706f 7369 7469 6f6e 2077  ected position w
-0000aeb0: 6865 6e20 6170 7065 6e64 696e 6720 7468  hen appending th
-0000aec0: 6520 6669 7273 7420 6576 656e 740a 6f66  e first event.of
-0000aed0: 2061 206e 6577 2073 7472 6561 6d20 2873   a new stream (s
-0000aee0: 6565 2061 626f 7665 292e 0a0a 6060 6070  ee above)...```p
-0000aef0: 7974 686f 6e0a 7374 7265 616d 5f70 6f73  ython.stream_pos
-0000af00: 6974 696f 6e20 3d20 636c 6965 6e74 2e67  ition = client.g
-0000af10: 6574 5f73 7472 6561 6d5f 706f 7369 7469  et_stream_positi
-0000af20: 6f6e 280a 2020 2020 7374 7265 616d 5f6e  on(.    stream_n
-0000af30: 616d 653d 7374 7228 7575 6964 3428 2929  ame=str(uuid4())
-0000af40: 0a29 0a0a 6173 7365 7274 2073 7472 6561  .)..assert strea
-0000af50: 6d5f 706f 7369 7469 6f6e 203d 3d20 4e6f  m_position == No
-0000af60: 6e65 0a60 6060 0a0a 5468 6973 206d 6574  ne.```..This met
-0000af70: 686f 6420 7461 6b65 7320 616e 206f 7074  hod takes an opt
-0000af80: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
-0000af90: 7469 6d65 6f75 7460 2077 6869 6368 2069  timeout` which i
-0000afa0: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
-0000afb0: 7460 2074 6861 7420 7365 7473 0a61 2064  t` that sets.a d
-0000afc0: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000afd0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000afe0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000aff0: 2e0a 0a0a 2323 2320 4765 7420 6375 7272  ....### Get curr
-0000b000: 656e 7420 636f 6d6d 6974 2070 6f73 6974  ent commit posit
-0000b010: 696f 6e0a 0a54 6865 206d 6574 686f 6420  ion..The method 
-0000b020: 6067 6574 5f63 6f6d 6d69 745f 706f 7369  `get_commit_posi
-0000b030: 7469 6f6e 2829 6020 6361 6e20 6265 2075  tion()` can be u
-0000b040: 7365 6420 746f 2067 6574 2074 6865 2063  sed to get the c
-0000b050: 7572 7265 6e74 0a63 6f6d 6d69 7420 706f  urrent.commit po
-0000b060: 7369 7469 6f6e 206f 6620 7468 6520 6461  sition of the da
-0000b070: 7461 6261 7365 2e0a 0a60 6060 7079 7468  tabase...```pyth
-0000b080: 6f6e 0a63 6f6d 6d69 745f 706f 7369 7469  on.commit_positi
-0000b090: 6f6e 203d 2063 6c69 656e 742e 6765 745f  on = client.get_
-0000b0a0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
-0000b0b0: 290a 6060 600a 0a54 6869 7320 6d65 7468  ).```..This meth
-0000b0c0: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
-0000b0d0: 6f6e 616c 2061 7267 756d 656e 7420 6074  onal argument `t
-0000b0e0: 696d 656f 7574 6020 7768 6963 6820 6973  imeout` which is
-0000b0f0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-0000b100: 6020 7468 6174 2073 6574 730a 6120 6465  ` that sets.a de
-0000b110: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
-0000b120: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-0000b130: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-0000b140: 0a0a 5468 6973 206d 6574 686f 6420 6361  ..This method ca
-0000b150: 6e20 6265 2075 7365 6675 6c20 746f 206d  n be useful to m
-0000b160: 6561 7375 7265 2070 726f 6772 6573 7320  easure progress 
-0000b170: 6f66 2061 2064 6f77 6e73 7472 6561 6d20  of a downstream 
-0000b180: 636f 6d70 6f6e 656e 740a 7468 6174 2069  component.that i
-0000b190: 7320 7072 6f63 6573 7369 6e67 2061 6c6c  s processing all
-0000b1a0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000b1b0: 2c20 6279 2063 6f6d 7061 7269 6e67 2074  , by comparing t
-0000b1c0: 6865 2063 7572 7265 6e74 2063 6f6d 6d69  he current commi
-0000b1d0: 740a 706f 7369 7469 6f6e 2077 6974 6820  t.position with 
-0000b1e0: 7468 6520 7265 636f 7264 6564 2063 6f6d  the recorded com
-0000b1f0: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
-0000b200: 7468 6520 6c61 7374 2073 7563 6365 7373  the last success
-0000b210: 6675 6c6c 7920 7072 6f63 6573 7365 640a  fully processed.
-0000b220: 6576 656e 7420 696e 2061 2064 6f77 6e73  event in a downs
-0000b230: 7472 6561 6d20 636f 6d70 6f6e 656e 742e  tream component.
-0000b240: 0a0a 5468 6520 7661 6c75 6520 6f66 2074  ..The value of t
-0000b250: 6865 2060 636f 6d6d 6974 5f70 6f73 6974  he `commit_posit
-0000b260: 696f 6e60 2061 7267 756d 656e 7420 7768  ion` argument wh
-0000b270: 656e 2072 6561 6469 6e67 2065 7665 6e74  en reading event
-0000b280: 7320 6569 7468 6572 2062 7920 7573 696e  s either by usin
-0000b290: 670a 7468 6520 6072 6561 645f 616c 6c5f  g.the `read_all_
-0000b2a0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
-0000b2b0: 206f 7220 6279 2075 7369 6e67 2061 2063   or by using a c
-0000b2c0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000b2d0: 7469 6f6e 2077 6f75 6c64 2075 7375 616c  tion would usual
-0000b2e0: 6c79 0a62 6520 6465 7465 726d 696e 6564  ly.be determined
-0000b2f0: 2062 7920 7468 6520 7265 636f 7264 6564   by the recorded
-0000b300: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000b310: 206f 6620 7468 6520 6c61 7374 2073 7563   of the last suc
-0000b320: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
-0000b330: 7365 640a 6576 656e 7420 696e 2061 2064  sed.event in a d
-0000b340: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-0000b350: 656e 742e 0a0a 0a23 2323 2047 6574 2073  ent....### Get s
-0000b360: 7472 6561 6d20 6d65 7461 6461 7461 0a0a  tream metadata..
-0000b370: 5468 6520 6d65 7468 6f64 2060 6765 745f  The method `get_
-0000b380: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
-0000b390: 2960 2067 6574 7320 7468 6520 6d65 7461  )` gets the meta
-0000b3a0: 6461 7461 2066 6f72 2061 2073 7472 6561  data for a strea
-0000b3b0: 6d2c 2061 6c6f 6e67 0a77 6974 6820 7468  m, along.with th
-0000b3c0: 6520 7665 7273 696f 6e20 6f66 2074 6865  e version of the
-0000b3d0: 2073 7472 6561 6d20 6d65 7461 6461 7461   stream metadata
-0000b3e0: 2e0a 0a60 6060 7079 7468 6f6e 0a6d 6574  ...```python.met
-0000b3f0: 6164 6174 612c 206d 6574 6164 6174 615f  adata, metadata_
-0000b400: 7665 7273 696f 6e20 3d20 636c 6965 6e74  version = client
-0000b410: 2e67 6574 5f73 7472 6561 6d5f 6d65 7461  .get_stream_meta
-0000b420: 6461 7461 2873 7472 6561 6d5f 6e61 6d65  data(stream_name
-0000b430: 3d73 7472 6561 6d5f 6e61 6d65 3129 0a60  =stream_name1).`
-0000b440: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
-0000b450: 2060 6d65 7461 6461 7461 6020 7661 6c75   `metadata` valu
-0000b460: 6520 6973 2061 2050 7974 686f 6e20 6064  e is a Python `d
-0000b470: 6963 7460 2e20 5468 6520 7265 7475 726e  ict`. The return
-0000b480: 6564 2060 6d65 7461 6461 7461 5f76 6572  ed `metadata_ver
-0000b490: 7369 6f6e 600a 7661 6c75 6520 6973 2065  sion`.value is e
-0000b4a0: 6974 6865 7220 616e 2060 696e 7460 2c20  ither an `int`, 
-0000b4b0: 6f72 2060 4e6f 6e65 6020 6966 2074 6865  or `None` if the
-0000b4c0: 2073 7472 6561 6d20 646f 6573 206e 6f74   stream does not
-0000b4d0: 2065 7869 7374 2e20 5468 6573 6520 7661   exist. These va
-0000b4e0: 6c75 6573 2063 616e 0a62 6520 7061 7373  lues can.be pass
-0000b4f0: 6564 2069 6e74 6f20 6073 6574 5f73 7472  ed into `set_str
-0000b500: 6561 6d5f 6d65 7461 6461 7461 2829 602e  eam_metadata()`.
-0000b510: 0a0a 0a23 2323 2053 6574 2073 7472 6561  ...### Set strea
-0000b520: 6d20 6d65 7461 6461 7461 0a0a 2a72 6571  m metadata..*req
-0000b530: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-0000b540: 6865 206d 6574 686f 6420 6073 6574 5f73  he method `set_s
-0000b550: 7472 6561 6d5f 6d65 7461 6461 7461 2829  tream_metadata()
-0000b560: 6020 7365 7473 2074 6865 206d 6574 6164  ` sets the metad
-0000b570: 6174 6120 666f 7220 6120 7374 7265 616d  ata for a stream
-0000b580: 2c20 616c 6f6e 670a 7769 7468 2074 6865  , along.with the
-0000b590: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
-0000b5a0: 7374 7265 616d 206d 6574 6164 6174 612e  stream metadata.
-0000b5b0: 0a0a 6060 6070 7974 686f 6e0a 6d65 7461  ..```python.meta
-0000b5c0: 6461 7461 5b22 666f 6f22 5d20 3d20 2262  data["foo"] = "b
-0000b5d0: 6172 220a 0a63 6c69 656e 742e 7365 745f  ar"..client.set_
-0000b5e0: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
-0000b5f0: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
-0000b600: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
-0000b610: 2020 206d 6574 6164 6174 613d 6d65 7461     metadata=meta
-0000b620: 6461 7461 2c0a 2020 2020 6578 7065 6374  data,.    expect
-0000b630: 6564 5f70 6f73 6974 696f 6e3d 6d65 7461  ed_position=meta
-0000b640: 6461 7461 5f76 6572 7369 6f6e 2c0a 290a  data_version,.).
-0000b650: 6060 600a 0a54 6865 2060 6578 7065 6374  ```..The `expect
-0000b660: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
-0000b670: 756d 656e 7420 7368 6f75 6c64 2062 6520  ument should be 
-0000b680: 7468 6520 6375 7272 656e 7420 7665 7273  the current vers
-0000b690: 696f 6e20 6f66 2074 6865 2073 7472 6561  ion of the strea
-0000b6a0: 6d20 6d65 7461 6461 7461 2e0a 0a50 6c65  m metadata...Ple
-0000b6b0: 6173 6520 7265 6665 7220 746f 2074 6865  ase refer to the
-0000b6c0: 2045 7665 6e74 5374 6f72 6544 4220 646f   EventStoreDB do
-0000b6d0: 6375 6d65 6e74 6174 696f 6e20 666f 7220  cumentation for 
-0000b6e0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-0000b6f0: 2061 626f 7574 2073 7472 6561 6d0a 6d65   about stream.me
-0000b700: 7461 6461 7461 2e0a 0a23 2323 2044 656c  tadata...### Del
-0000b710: 6574 6520 7374 7265 616d 0a0a 2a72 6571  ete stream..*req
-0000b720: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-0000b730: 6865 206d 6574 686f 6420 6064 656c 6574  he method `delet
-0000b740: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
-0000b750: 6265 2075 7365 6420 746f 2022 6465 6c65  be used to "dele
-0000b760: 7465 2220 6120 7374 7265 616d 2e0a 0a60  te" a stream...`
-0000b770: 6060 7079 7468 6f6e 0a63 6f6d 6d69 745f  ``python.commit_
-0000b780: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
-0000b790: 742e 6465 6c65 7465 5f73 7472 6561 6d28  t.delete_stream(
-0000b7a0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000b7b0: 616d 5f6e 616d 6531 2c20 6578 7065 6374  am_name1, expect
-0000b7c0: 6564 5f70 6f73 6974 696f 6e3d 3229 0a60  ed_position=2).`
-0000b7d0: 6060 0a0a 4166 7465 7220 6465 6c65 7469  ``..After deleti
-0000b7e0: 6e67 2061 2073 7472 6561 6d2c 2069 7427  ng a stream, it'
-0000b7f0: 7320 7374 696c 6c20 706f 7373 6962 6c65  s still possible
-0000b800: 2074 6f20 6170 7065 6e64 206e 6577 2065   to append new e
-0000b810: 7665 6e74 732e 2052 6561 6469 6e67 2066  vents. Reading f
-0000b820: 726f 6d20 610a 6465 6c65 7465 6420 7374  rom a.deleted st
-0000b830: 7265 616d 2077 696c 6c20 7265 7475 726e  ream will return
-0000b840: 206f 6e6c 7920 6576 656e 7473 2074 6861   only events tha
-0000b850: 7420 6861 7665 2062 6565 6e20 6170 7065  t have been appe
-0000b860: 6e64 6564 2061 6674 6572 2069 7420 7761  nded after it wa
-0000b870: 730a 6465 6c65 7465 642e 0a0a 2323 2320  s.deleted...### 
-0000b880: 546f 6d62 7374 6f6e 6520 7374 7265 616d  Tombstone stream
-0000b890: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-0000b8a0: 6572 2a0a 0a54 6865 206d 6574 686f 6420  er*..The method 
-0000b8b0: 6074 6f6d 6273 746f 6e65 5f73 7472 6561  `tombstone_strea
-0000b8c0: 6d28 2960 2063 616e 2062 6520 7573 6564  m()` can be used
-0000b8d0: 2074 6f20 2274 6f6d 6273 746f 6e65 2220   to "tombstone" 
-0000b8e0: 6120 7374 7265 616d 2e0a 0a60 6060 7079  a stream...```py
-0000b8f0: 7468 6f6e 0a63 6f6d 6d69 745f 706f 7369  thon.commit_posi
-0000b900: 7469 6f6e 203d 2063 6c69 656e 742e 746f  tion = client.to
-0000b910: 6d62 7374 6f6e 655f 7374 7265 616d 2873  mbstone_stream(s
-0000b920: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-0000b930: 6d5f 6e61 6d65 312c 2065 7870 6563 7465  m_name1, expecte
-0000b940: 645f 706f 7369 7469 6f6e 3d32 290a 6060  d_position=2).``
-0000b950: 600a 0a41 6674 6572 2074 6f6d 6273 746f  `..After tombsto
-0000b960: 6e69 6e67 2061 2073 7472 6561 6d2c 2069  ning a stream, i
-0000b970: 7427 7320 6e6f 7420 706f 7373 6962 6c65  t's not possible
-0000b980: 2074 6f20 6170 7065 6e64 206e 6577 2065   to append new e
-0000b990: 7665 6e74 732e 0a0a 0a23 2320 4361 7463  vents....## Catc
-0000b9a0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-0000b9b0: 6e73 0a0a 2243 6174 6368 2d75 7022 2073  ns.."Catch-up" s
-0000b9c0: 7562 7363 7269 7074 696f 6e73 2063 616e  ubscriptions can
-0000b9d0: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
-0000b9e0: 6976 6520 6576 656e 7473 2074 6861 7420  ive events that 
-0000b9f0: 6861 7665 2062 6565 6e20 7265 636f 7264  have been record
-0000ba00: 6564 0a69 6e20 7468 6520 6461 7461 6261  ed.in the databa
-0000ba10: 7365 2c20 616e 6420 616c 736f 2065 7665  se, and also eve
-0000ba20: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
-0000ba30: 6f72 6465 6420 6166 7465 7220 6120 7375  orded after a su
-0000ba40: 6273 6372 6970 7469 6f6e 2077 6173 2073  bscription was s
-0000ba50: 7461 7274 6564 2e0a 0a54 6865 206d 6574  tarted...The met
-0000ba60: 686f 6420 6073 7562 7363 7269 6265 5f61  hod `subscribe_a
-0000ba70: 6c6c 5f65 7665 6e74 7328 2960 2073 7461  ll_events()` sta
-0000ba80: 7274 7320 6120 6361 7463 682d 7570 2073  rts a catch-up s
-0000ba90: 7562 7363 7269 7074 696f 6e20 746f 2072  ubscription to r
-0000baa0: 6563 6569 7665 2061 6c6c 0a65 7665 6e74  eceive all.event
-0000bab0: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
-0000bac0: 2061 6e64 2077 696c 6c20 6265 2072 6563   and will be rec
-0000bad0: 6f72 6465 6420 696e 2074 6865 2064 6174  orded in the dat
-0000bae0: 6162 6173 652e 2054 6865 206d 6574 686f  abase. The metho
-0000baf0: 640a 6073 7562 7363 7269 6265 5f73 7472  d.`subscribe_str
-0000bb00: 6561 6d5f 6576 656e 7473 2829 6020 7374  eam_events()` st
-0000bb10: 6172 7473 2061 2063 6174 6368 2d75 7020  arts a catch-up 
-0000bb20: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-0000bb30: 7265 6365 6976 6520 6576 656e 7473 2066  receive events f
-0000bb40: 726f 6d0a 6120 7370 6563 6966 6963 2073  rom.a specific s
-0000bb50: 7472 6561 6d2e 0a0a 4361 7463 682d 7570  tream...Catch-up
-0000bb60: 2073 7562 7363 7269 7074 696f 6e73 2065   subscriptions e
-0000bb70: 6e63 6170 7375 6c61 7465 2061 2073 7472  ncapsulate a str
-0000bb80: 6561 6d69 6e67 2067 5250 4320 6361 6c6c  eaming gRPC call
-0000bb90: 2077 6869 6368 2069 730a 6b65 7074 206f   which is.kept o
-0000bba0: 7065 6e20 6279 2074 6865 2073 6572 7665  pen by the serve
-0000bbb0: 722c 2077 6974 6820 6e65 776c 7920 7265  r, with newly re
-0000bbc0: 636f 7264 6564 2065 7665 6e74 7320 7365  corded events se
-0000bbd0: 6e74 2074 6f20 7468 6520 636c 6965 6e74  nt to the client
-0000bbe0: 0a61 7320 7468 6520 636c 6965 6e74 2069  .as the client i
-0000bbf0: 7465 7261 7465 7320 6f76 6572 2074 6865  terates over the
-0000bc00: 2073 7562 7363 7269 7074 696f 6e20 7265   subscription re
-0000bc10: 7370 6f6e 7365 2e0a 0a4d 616e 7920 6361  sponse...Many ca
-0000bc20: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-0000bc30: 696f 6e73 2063 616e 2062 6520 6372 6561  ions can be crea
-0000bc40: 7465 642c 2063 6f6e 6375 7272 656e 746c  ted, concurrentl
-0000bc50: 7920 6f72 2073 7563 6365 7373 6976 656c  y or successivel
-0000bc60: 792c 2061 6e64 2061 6c6c 0a77 696c 6c20  y, and all.will 
-0000bc70: 7265 6365 6976 6520 616c 6c20 7468 6520  receive all the 
-0000bc80: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000bc90: 7468 6579 2068 6176 6520 6265 656e 2072  they have been r
-0000bca0: 6571 7565 7374 6564 2074 6f20 7265 6365  equested to rece
-0000bcb0: 6976 652e 0a0a 5468 6520 7265 6365 6976  ive...The receiv
-0000bcc0: 6564 2072 6563 6f72 6465 6420 6576 656e  ed recorded even
-0000bcd0: 7420 6f62 6a65 6374 2061 7265 2069 6e73  t object are ins
-0000bce0: 7461 6e63 6573 206f 6620 7468 6520 6052  tances of the `R
-0000bcf0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
-0000bd00: 6173 730a 2873 6565 2074 6865 204e 6f74  ass.(see the Not
-0000bd10: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
-0000bd20: 2066 6f72 2064 6574 6169 6c73 206f 6620   for details of 
-0000bd30: 7468 6973 2063 6c61 7373 292e 0a0a 2323  this class)...##
-0000bd40: 2320 486f 7720 746f 2069 6d70 6c65 6d65  # How to impleme
-0000bd50: 6e74 2065 7861 6374 6c79 2d6f 6e63 6520  nt exactly-once 
-0000bd60: 6576 656e 7420 7072 6f63 6573 7369 6e67  event processing
-0000bd70: 0a0a 5468 6520 636f 6d6d 6974 2070 6f73  ..The commit pos
-0000bd80: 6974 696f 6e73 206f 6620 7265 636f 7264  itions of record
-0000bd90: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
-0000bda0: 7265 2072 6563 6569 7665 6420 616e 6420  re received and 
-0000bdb0: 7072 6f63 6573 7365 6420 6279 2061 0a64  processed by a.d
-0000bdc0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-0000bdd0: 656e 7420 6172 6520 7573 6566 756c 6c79  ent are usefully
-0000bde0: 2072 6563 6f72 6465 6420 6279 2074 6865   recorded by the
-0000bdf0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000be00: 6f6e 656e 7420 736f 2074 6861 740a 7468  onent so that.th
-0000be10: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-0000be20: 6e20 6f66 206c 6173 7420 7072 6f63 6573  n of last proces
-0000be30: 7365 6420 6576 656e 7420 6361 6e20 6265  sed event can be
-0000be40: 2064 6574 6572 6d69 6e65 642e 0a0a 5468   determined...Th
-0000be50: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
-0000be60: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000be70: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
-0000be80: 7065 6369 6679 2074 6865 2063 6f6d 6d69  pecify the commi
-0000be90: 7420 706f 7369 7469 6f6e 2066 726f 6d20  t position from 
-0000bea0: 7768 6963 680a 746f 2073 7562 7363 7269  which.to subscri
-0000beb0: 6265 2077 6865 6e20 7072 6f63 6573 7369  be when processi
-0000bec0: 6e67 2069 7320 7265 7375 6d65 642e 2053  ng is resumed. S
-0000bed0: 696e 6365 2074 6869 7320 636f 6d6d 6974  ince this commit
-0000bee0: 2070 6f73 6974 696f 6e20 7769 6c6c 2072   position will r
-0000bef0: 6570 7265 7365 6e74 2074 6865 0a70 6f73  epresent the.pos
-0000bf00: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
-0000bf10: 7420 7375 6363 6573 7366 756c 6c79 2070  t successfully p
-0000bf20: 726f 6365 7373 6564 2065 7665 6e74 2069  rocessed event i
-0000bf30: 6e20 6120 646f 776e 7374 7265 616d 2063  n a downstream c
-0000bf40: 6f6d 706f 6e65 6e74 2c20 736f 2069 740a  omponent, so it.
-0000bf50: 7769 6c6c 2062 6520 7573 7561 6c20 746f  will be usual to
-0000bf60: 2077 616e 7420 7468 6520 6e65 7874 2065   want the next e
-0000bf70: 7665 6e74 2061 6674 6572 2074 6869 7320  vent after this 
-0000bf80: 706f 7369 7469 6f6e 2c20 6265 6361 7573  position, becaus
-0000bf90: 6520 7468 6174 2069 7320 7468 6520 6e65  e that is the ne
-0000bfa0: 7874 0a65 7665 6e74 2074 6861 7420 6861  xt.event that ha
-0000bfb0: 7320 6e6f 7420 7965 7420 6265 656e 2070  s not yet been p
-0000bfc0: 726f 6365 7373 6564 2e20 466f 7220 7468  rocessed. For th
-0000bfd0: 6973 2072 6561 736f 6e2c 2077 6865 6e20  is reason, when 
-0000bfe0: 7375 6273 6372 6962 696e 6720 666f 7220  subscribing for 
-0000bff0: 6576 656e 7473 0a66 726f 6d20 6120 7370  events.from a sp
-0000c000: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
-0000c010: 7369 7469 6f6e 2075 7369 6e67 2061 2063  sition using a c
-0000c020: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000c030: 7469 6f6e 2069 6e20 4576 656e 7453 746f  tion in EventSto
-0000c040: 7265 4442 2c20 7468 650a 7265 636f 7264  reDB, the.record
-0000c050: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
-0000c060: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
-0000c070: 2070 6f73 6974 696f 6e20 7769 6c6c 204e   position will N
-0000c080: 4f54 2062 6520 696e 636c 7564 6564 2069  OT be included i
-0000c090: 6e20 7468 6520 7365 7175 656e 6365 0a6f  n the sequence.o
-0000c0a0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-0000c0b0: 7320 7468 6174 2061 7265 2072 6563 6569  s that are recei
-0000c0c0: 7665 642e 0a0a 546f 2061 6363 6f6d 706c  ved...To accompl
-0000c0d0: 6973 6820 2265 7861 6374 6c79 2d6f 6e63  ish "exactly-onc
-0000c0e0: 6522 2070 726f 6365 7373 696e 6720 6f66  e" processing of
-0000c0f0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000c100: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-0000c110: 0a63 6f6d 706f 6e65 6e74 2077 6865 6e20  .component when 
-0000c120: 7573 696e 6720 6120 6361 7463 682d 7570  using a catch-up
-0000c130: 2073 7562 7363 7269 7074 696f 6e2c 2074   subscription, t
-0000c140: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000c150: 6f6e 206f 6620 6120 7265 636f 7264 6564  on of a recorded
-0000c160: 0a65 7665 6e74 2073 686f 756c 6420 6265  .event should be
-0000c170: 2072 6563 6f72 6465 6420 6174 6f6d 6963   recorded atomic
-0000c180: 616c 6c79 2061 6e64 2075 6e69 7175 656c  ally and uniquel
-0000c190: 7920 616c 6f6e 6720 7769 7468 2074 6865  y along with the
-0000c1a0: 2072 6573 756c 7420 6f66 2070 726f 6365   result of proce
-0000c1b0: 7373 696e 670a 7265 636f 7264 6564 2065  ssing.recorded e
-0000c1c0: 7665 6e74 732c 2066 6f72 2065 7861 6d70  vents, for examp
-0000c1d0: 6c65 2069 6e20 7468 6520 7361 6d65 2064  le in the same d
-0000c1e0: 6174 6162 6173 6520 6173 206d 6174 6572  atabase as mater
-0000c1f0: 6961 6c69 7365 6420 7669 6577 7320 7768  ialised views wh
-0000c200: 656e 0a69 6d70 6c65 6d65 6e74 696e 6720  en.implementing 
-0000c210: 6576 656e 7475 616c 6c79 2d63 6f6e 7369  eventually-consi
-0000c220: 7374 656e 7420 4351 5253 2c20 6f72 2069  stent CQRS, or i
-0000c230: 6e20 7468 6520 7361 6d65 2064 6174 6162  n the same datab
-0000c240: 6173 6520 6173 2061 2064 6f77 6e73 7472  ase as a downstr
-0000c250: 6561 6d0a 616e 616c 7974 6963 7320 6f72  eam.analytics or
-0000c260: 2072 6570 6f72 7469 6e67 206f 7220 6172   reporting or ar
-0000c270: 6368 6976 696e 6720 6170 706c 6963 6174  chiving applicat
-0000c280: 696f 6e2e 2042 7920 7265 636f 7264 696e  ion. By recordin
-0000c290: 6720 7468 6520 636f 6d6d 6974 2070 6f73  g the commit pos
-0000c2a0: 6974 696f 6e0a 6f66 2072 6563 6f72 6465  ition.of recorde
-0000c2b0: 6420 6576 656e 7473 2061 746f 6d69 6361  d events atomica
-0000c2c0: 6c6c 7920 7769 7468 2074 6865 206e 6577  lly with the new
-0000c2d0: 2073 7461 7465 2074 6861 7420 7265 7375   state that resu
-0000c2e0: 6c74 7320 6672 6f6d 2070 726f 6365 7373  lts from process
-0000c2f0: 696e 670a 7265 636f 7264 6564 2065 7665  ing.recorded eve
-0000c300: 6e74 732c 2022 6475 616c 2077 7269 7469  nts, "dual writi
-0000c310: 6e67 2220 696e 2074 6865 2063 6f6e 7375  ng" in the consu
-0000c320: 6d70 7469 6f6e 206f 6620 7265 636f 7264  mption of record
-0000c330: 6564 2065 7665 6e74 7320 6361 6e20 6265  ed events can be
-0000c340: 0a61 766f 6964 6564 2e20 4279 2061 6c73  .avoided. By als
-0000c350: 6f20 7265 636f 7264 696e 6720 7468 6520  o recording the 
-0000c360: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000c370: 756e 6971 7565 6c79 2c20 7468 6520 6e65  uniquely, the ne
-0000c380: 7720 7374 6174 6520 6361 6e6e 6f74 2062  w state cannot b
-0000c390: 650a 7265 636f 7264 6564 2074 7769 6365  e.recorded twice
-0000c3a0: 2c20 616e 6420 6865 6e63 6520 7468 6520  , and hence the 
-0000c3b0: 7265 636f 7264 6564 2073 7461 7465 206f  recorded state o
-0000c3c0: 6620 7468 6520 646f 776e 7374 7265 616d  f the downstream
-0000c3d0: 2063 6f6d 706f 6e65 6e74 2077 696c 6c20   component will 
-0000c3e0: 6265 0a75 7064 6174 6564 206f 6e6c 7920  be.updated only 
-0000c3f0: 6f6e 6365 2066 6f72 2061 6e79 2072 6563  once for any rec
-0000c400: 6f72 6465 6420 6576 656e 742e 2042 7920  orded event. By 
-0000c410: 7573 696e 6720 7468 6520 6772 6561 7465  using the greate
-0000c420: 7374 2072 6563 6f72 6465 6420 636f 6d6d  st recorded comm
-0000c430: 6974 0a70 6f73 6974 696f 6e20 746f 2072  it.position to r
-0000c440: 6573 756d 6520 6120 6361 7463 682d 7570  esume a catch-up
-0000c450: 2073 7562 7363 7269 7074 696f 6e2c 2061   subscription, a
-0000c460: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
-0000c470: 7473 2077 696c 6c20 6576 656e 7475 616c  ts will eventual
-0000c480: 6c79 0a62 6520 7072 6f63 6573 7365 642e  ly.be processed.
-0000c490: 2054 6865 2063 6f6d 6269 6e61 7469 6f6e   The combination
-0000c4a0: 206f 6620 7468 6520 2261 742d 6d6f 7374   of the "at-most
-0000c4b0: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
-0000c4c0: 2061 6e64 2074 6865 2022 6174 2d6c 6561   and the "at-lea
-0000c4d0: 7374 2d6f 6e63 6522 0a63 6f6e 6469 7469  st-once".conditi
-0000c4e0: 6f6e 2067 6976 6573 2074 6865 2022 6578  on gives the "ex
-0000c4f0: 6163 746c 792d 6f6e 6365 2220 636f 6e64  actly-once" cond
-0000c500: 6974 696f 6e2e 0a0a 5468 6520 6461 6e67  ition...The dang
-0000c510: 6572 2077 6974 6820 2264 7561 6c20 7772  er with "dual wr
-0000c520: 6974 696e 6722 2069 6e20 7468 6520 636f  iting" in the co
-0000c530: 6e73 756d 7074 696f 6e20 6f66 2072 6563  nsumption of rec
-0000c540: 6f72 6465 6420 6576 656e 7473 2069 7320  orded events is 
-0000c550: 7468 6174 2069 6620 610a 7265 636f 7264  that if a.record
-0000c560: 6564 2065 7665 6e74 2069 7320 7375 6363  ed event is succ
-0000c570: 6573 7366 756c 6c79 2070 726f 6365 7373  essfully process
-0000c580: 6564 2061 6e64 206e 6577 2073 7461 7465  ed and new state
-0000c590: 2072 6563 6f72 6465 6420 6174 6f6d 6963   recorded atomic
-0000c5a0: 616c 6c79 2069 6e20 6f6e 650a 7472 616e  ally in one.tran
-0000c5b0: 7361 6374 696f 6e20 7769 7468 2074 6865  saction with the
-0000c5c0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000c5d0: 2072 6563 6f72 6465 6420 696e 2061 2073   recorded in a s
-0000c5e0: 6570 6172 6174 6520 7472 616e 7361 6374  eparate transact
-0000c5f0: 696f 6e2c 206f 6e65 206d 6179 0a68 6170  ion, one may.hap
-0000c600: 7065 6e20 616e 6420 6e6f 7420 7468 6520  pen and not the 
-0000c610: 6f74 6865 722e 2049 6620 7468 6520 6e65  other. If the ne
-0000c620: 7720 7374 6174 6520 6973 2072 6563 6f72  w state is recor
-0000c630: 6465 6420 6275 7420 7468 6520 706f 7369  ded but the posi
-0000c640: 7469 6f6e 2069 7320 6c6f 7374 2c0a 616e  tion is lost,.an
-0000c650: 6420 7468 656e 2074 6865 2070 726f 6365  d then the proce
-0000c660: 7373 696e 6720 6973 2073 746f 7070 6564  ssing is stopped
-0000c670: 2061 6e64 2072 6573 756d 6564 2c20 7468   and resumed, th
-0000c680: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-0000c690: 206d 6179 2062 6520 7072 6f63 6573 7365   may be processe
-0000c6a0: 640a 7477 6963 652e 204f 6e20 7468 6520  d.twice. On the 
-0000c6b0: 6f74 6865 7220 6861 6e64 2c20 6966 2074  other hand, if t
-0000c6c0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000c6d0: 6f6e 2069 7320 7265 636f 7264 6564 2062  on is recorded b
-0000c6e0: 7574 2074 6865 206e 6577 2073 7461 7465  ut the new state
-0000c6f0: 2069 730a 6c6f 7374 2c20 7468 6520 7265   is.lost, the re
-0000c700: 636f 7264 6564 2065 7665 6e74 206d 6179  corded event may
-0000c710: 2065 6666 6563 7469 7665 6c79 206e 6f74   effectively not
-0000c720: 2062 6520 7072 6f63 6573 7365 6420 6174   be processed at
-0000c730: 2061 6c6c 2e20 4279 2065 6974 6865 720a   all. By either.
-0000c740: 7072 6f63 6573 7369 6e67 2061 6e20 6576  processing an ev
-0000c750: 656e 7420 6d6f 7265 2074 6861 6e20 6f6e  ent more than on
-0000c760: 6365 2c20 6f72 2062 7920 6661 696c 696e  ce, or by failin
-0000c770: 6720 746f 2070 726f 6365 7373 2061 6e20  g to process an 
-0000c780: 6576 656e 742c 2074 6865 2072 6563 6f72  event, the recor
-0000c790: 6465 640a 7374 6174 6520 6f66 2074 6865  ded.state of the
-0000c7a0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000c7b0: 6f6e 656e 7420 6d69 6768 7420 6265 2069  onent might be i
-0000c7c0: 6e61 6363 7572 6174 652c 206f 7220 706f  naccurate, or po
-0000c7d0: 7373 6962 6c79 2069 6e63 6f6e 7369 7374  ssibly inconsist
-0000c7e0: 656e 742c 2061 6e64 0a70 6572 6861 7073  ent, and.perhaps
-0000c7f0: 2063 6174 6173 7472 6f70 6869 6361 6c6c   catastrophicall
-0000c800: 7920 736f 2e20 5375 6368 2063 6f6e 7365  y so. Such conse
-0000c810: 7175 656e 6365 7320 6d61 7920 6f72 206d  quences may or m
-0000c820: 6179 206e 6f74 206d 6174 7465 7220 696e  ay not matter in
-0000c830: 2079 6f75 7220 7369 7475 6174 696f 6e2e   your situation.
-0000c840: 0a42 7574 2073 6f6d 6574 696d 6573 2069  .But sometimes i
-0000c850: 6e63 6f6e 7369 7374 656e 6369 6573 206d  nconsistencies m
-0000c860: 6179 2068 616c 7420 7072 6f63 6573 7369  ay halt processi
-0000c870: 6e67 2075 6e74 696c 2074 6865 2069 7373  ng until the iss
-0000c880: 7565 2069 7320 7265 736f 6c76 6564 2e20  ue is resolved. 
-0000c890: 596f 7520 6361 6e0a 6176 6f69 6420 2264  You can.avoid "d
-0000c8a0: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
-0000c8b0: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
-0000c8c0: 6f66 2065 7665 6e74 7320 6279 2061 746f  of events by ato
-0000c8d0: 6d69 6361 6c6c 7920 7265 636f 7264 696e  mically recordin
-0000c8e0: 6720 7468 6520 636f 6d6d 6974 0a70 6f73  g the commit.pos
-0000c8f0: 6974 696f 6e20 6f66 2061 2072 6563 6f72  ition of a recor
-0000c900: 6465 6420 6576 656e 7420 616c 6f6e 6720  ded event along 
-0000c910: 7769 7468 2074 6865 206e 6577 2073 7461  with the new sta
-0000c920: 7465 2074 6861 7420 7265 7375 6c74 7320  te that results 
-0000c930: 6672 6f6d 2070 726f 6365 7373 696e 6720  from processing 
-0000c940: 7468 6174 0a65 7665 6e74 2069 6e20 7468  that.event in th
-0000c950: 6520 7361 6d65 2061 746f 6d69 6320 7472  e same atomic tr
-0000c960: 616e 7361 6374 696f 6e2e 2042 7920 6d61  ansaction. By ma
-0000c970: 6b69 6e67 2074 6865 2072 6563 6f72 6469  king the recordi
-0000c980: 6e67 206f 6620 7468 6520 636f 6d6d 6974  ng of the commit
-0000c990: 2070 6f73 6974 696f 6e73 0a75 6e69 7175   positions.uniqu
-0000c9a0: 652c 2073 6f20 7468 6174 2074 7261 6e73  e, so that trans
-0000c9b0: 6163 7469 6f6e 7320 7769 6c6c 2062 6520  actions will be 
-0000c9c0: 726f 6c6c 6564 2062 6163 6b20 7768 656e  rolled back when
-0000c9d0: 2074 6865 7265 2069 7320 6120 636f 6e66   there is a conf
-0000c9e0: 6c69 6374 2c20 796f 7520 7769 6c6c 0a70  lict, you will.p
-0000c9f0: 7265 7665 6e74 2074 6865 2072 6573 756c  revent the resul
-0000ca00: 7473 206f 6620 616e 7920 6475 706c 6963  ts of any duplic
-0000ca10: 6174 6520 7072 6f63 6573 7369 6e67 206f  ate processing o
-0000ca20: 6620 6120 7265 636f 7264 6564 2065 7665  f a recorded eve
-0000ca30: 6e74 2062 6569 6e67 2063 6f6d 6d69 7474  nt being committ
-0000ca40: 6564 2e0a 0a52 6563 6f72 6465 6420 6576  ed...Recorded ev
-0000ca50: 656e 7473 2072 6563 6569 7665 6420 6672  ents received fr
-0000ca60: 6f6d 2061 2063 6174 6368 2d75 7020 7375  om a catch-up su
-0000ca70: 6273 6372 6970 7469 6f6e 2063 616e 6e6f  bscription canno
-0000ca80: 7420 6265 2061 636b 6e6f 776c 6564 6765  t be acknowledge
-0000ca90: 6420 6261 636b 0a74 6f20 7468 6520 4576  d back.to the Ev
-0000caa0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-0000cab0: 722e 2041 636b 6e6f 776c 6564 6769 6e67  r. Acknowledging
-0000cac0: 2065 7665 6e74 732c 2068 6f77 6576 6572   events, however
-0000cad0: 2c20 6973 2061 6e20 6173 7065 6374 206f  , is an aspect o
-0000cae0: 6620 2270 6572 7369 7374 656e 740a 7375  f "persistent.su
-0000caf0: 6273 6372 6970 7469 6f6e 7322 2e20 486f  bscriptions". Ho
-0000cb00: 7069 6e67 2074 6f20 7265 6c79 206f 6e20  ping to rely on 
-0000cb10: 6163 6b6e 6f77 6c65 6467 696e 6720 6576  acknowledging ev
-0000cb20: 656e 7473 2074 6f20 616e 2075 7073 7472  ents to an upstr
-0000cb30: 6561 6d0a 636f 6d70 6f6e 656e 7420 6973  eam.component is
-0000cb40: 2061 6e20 6578 616d 706c 6520 6f66 2064   an example of d
-0000cb50: 7561 6c20 7772 6974 696e 672e 0a0a 2323  ual writing...##
-0000cb60: 2320 5375 6273 6372 6962 6520 616c 6c20  # Subscribe all 
-0000cb70: 6576 656e 7473 0a0a 5468 6560 7375 6273  events..The`subs
-0000cb80: 6372 6962 655f 616c 6c5f 6576 656e 7473  cribe_all_events
-0000cb90: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-0000cba0: 6520 7573 6564 2074 6f20 7374 6172 7420  e used to start 
-0000cbb0: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
-0000cbc0: 7363 7269 7074 696f 6e0a 7468 6174 2063  scription.that c
-0000cbd0: 616e 2072 6574 7572 6e20 6576 656e 7473  an return events
-0000cbe0: 2066 726f 6d20 616c 6c20 7374 7265 616d   from all stream
-0000cbf0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
-0000cc00: 652e 0a0a 5468 6973 206d 6574 686f 6420  e...This method 
-0000cc10: 6361 6e20 6265 2075 7365 6420 6279 2061  can be used by a
-0000cc20: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000cc30: 6f6e 656e 740a 746f 2070 726f 6365 7373  onent.to process
-0000cc40: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000cc50: 2077 6974 6820 6578 6163 746c 792d 6f6e   with exactly-on
-0000cc60: 6365 2073 656d 616e 7469 6373 2e0a 0a54  ce semantics...T
-0000cc70: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
-0000cc80: 2061 6e20 6f70 7469 6f6e 616c 2060 636f   an optional `co
-0000cc90: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
-0000cca0: 7267 756d 656e 742c 2077 6869 6368 2063  rgument, which c
-0000ccb0: 616e 2062 650a 7573 6564 2074 6f20 7370  an be.used to sp
-0000ccc0: 6563 6966 7920 6120 636f 6d6d 6974 2070  ecify a commit p
-0000ccd0: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
-0000cce0: 6368 2074 6f20 7375 6273 6372 6962 652e  ch to subscribe.
-0000ccf0: 2054 6865 2064 6566 6175 6c74 0a76 616c   The default.val
-0000cd00: 7565 2069 7320 604e 6f6e 6560 2c20 7768  ue is `None`, wh
-0000cd10: 6963 6820 6d65 616e 7320 7468 6520 7375  ich means the su
-0000cd20: 6273 6372 6970 7469 6f6e 2077 696c 6c20  bscription will 
-0000cd30: 6f70 6572 6174 6520 6672 6f6d 2074 6865  operate from the
-0000cd40: 2066 6972 7374 0a72 6563 6f72 6465 6420   first.recorded 
-0000cd50: 6576 656e 7420 696e 2074 6865 2064 6174  event in the dat
-0000cd60: 6162 6173 652e 2049 6620 6120 636f 6d6d  abase. If a comm
-0000cd70: 6974 2070 6f73 6974 696f 6e20 6973 2067  it position is g
-0000cd80: 6976 656e 2c20 6974 206d 7573 7420 6d61  iven, it must ma
-0000cd90: 7463 680a 616e 2061 6374 7561 6c6c 7920  tch.an actually 
-0000cda0: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
-0000cdb0: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
-0000cdc0: 6461 7461 6261 7365 2e20 5468 6520 7265  database. The re
-0000cdd0: 636f 6465 6420 6576 656e 7473 2074 6861  coded events tha
-0000cde0: 740a 6172 6520 6f62 7461 696e 6564 2077  t.are obtained w
-0000cdf0: 696c 6c20 6e6f 7420 696e 636c 7564 6520  ill not include 
-0000ce00: 7468 6520 6576 656e 7420 7265 636f 7264  the event record
-0000ce10: 6564 2061 7420 7468 6174 2063 6f6d 6d69  ed at that commi
-0000ce20: 7420 706f 7369 7469 6f6e 2e0a 0a54 6869  t position...Thi
-0000ce30: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-0000ce40: 6b65 7320 666f 7572 206f 7468 6572 206f  kes four other o
-0000ce50: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-0000ce60: 732c 2060 6669 6c74 6572 5f65 7863 6c75  s, `filter_exclu
-0000ce70: 6465 602c 0a60 6669 6c74 6572 5f69 6e63  de`,.`filter_inc
-0000ce80: 6c75 6465 602c 2060 6669 6c74 6572 5f62  lude`, `filter_b
-0000ce90: 795f 7374 7265 616d 5f6e 616d 6560 2c20  y_stream_name`, 
-0000cea0: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
-0000ceb0: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
-0000cec0: 756d 656e 7420 6066 696c 7465 725f 6578  ument `filter_ex
-0000ced0: 636c 7564 6560 2069 7320 6120 7365 7175  clude` is a sequ
-0000cee0: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
-0000cef0: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
-0000cf00: 0a6d 6174 6368 2072 6563 6f72 6465 6420  .match recorded 
-0000cf10: 6576 656e 7473 2074 6861 7420 7368 6f75  events that shou
-0000cf20: 6c64 206e 6f74 2062 6520 696e 636c 7564  ld not be includ
-0000cf30: 6564 2e20 5468 6973 2061 7267 756d 656e  ed. This argumen
-0000cf40: 7420 6973 2069 676e 6f72 6564 0a69 6620  t is ignored.if 
-0000cf50: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-0000cf60: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
-0000cf70: 2d65 6d70 7479 2073 6571 7565 6e63 652e  -empty sequence.
-0000cf80: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
-0000cf90: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000cfa0: 740a 746f 206d 6174 6368 2074 6865 2065  t.to match the e
-0000cfb0: 7665 6e74 2074 7970 6573 206f 6620 2273  vent types of "s
-0000cfc0: 7973 7465 6d20 6576 656e 7473 222c 2073  ystem events", s
-0000cfd0: 6f20 7468 6174 2045 7665 6e74 5374 6f72  o that EventStor
-0000cfe0: 6544 4220 7379 7374 656d 2065 7665 6e74  eDB system event
-0000cff0: 730a 7769 6c6c 206e 6f74 206e 6f72 6d61  s.will not norma
-0000d000: 6c6c 7920 6265 2069 6e63 6c75 6465 642e  lly be included.
-0000d010: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
-0000d020: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
-0000d030: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0000d040: 6e0a 6162 6f75 7420 6669 6c74 6572 2065  n.about filter e
-0000d050: 7870 7265 7373 696f 6e73 2e0a 0a54 6865  xpressions...The
-0000d060: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000d070: 6e74 2060 6669 6c74 6572 5f69 6e63 6c75  nt `filter_inclu
-0000d080: 6465 6020 6973 2061 2073 6571 7565 6e63  de` is a sequenc
-0000d090: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
-0000d0a0: 7265 7373 696f 6e73 0a74 6861 7420 6d61  ressions.that ma
-0000d0b0: 7463 6820 7265 636f 7264 6564 2065 7665  tch recorded eve
-0000d0c0: 6e74 7320 7468 6174 2073 686f 756c 6420  nts that should 
-0000d0d0: 6265 2069 6e63 6c75 6465 642e 2042 7920  be included. By 
-0000d0e0: 6465 6661 756c 742c 2074 6869 7320 6172  default, this ar
-0000d0f0: 6775 6d65 6e74 0a69 7320 616e 2065 6d70  gument.is an emp
-0000d100: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
-0000d110: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000d120: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
-0000d130: 2073 6571 7565 6e63 652c 2074 6865 0a60   sequence, the.`
-0000d140: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
-0000d150: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-0000d160: 7265 642e 0a0a 5468 6520 6f70 7469 6f6e  red...The option
-0000d170: 616c 2061 7267 756d 656e 7420 6066 696c  al argument `fil
-0000d180: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
-0000d190: 6d65 6020 6973 2061 2050 7974 686f 6e20  me` is a Python 
-0000d1a0: 6062 6f6f 6c60 2074 6861 7420 696e 6469  `bool` that indi
-0000d1b0: 6361 7465 7320 7768 6574 6865 720a 7468  cates whether.th
-0000d1c0: 6520 6669 6c74 6572 2077 696c 6c20 6170  e filter will ap
-0000d1d0: 706c 7920 746f 2065 7665 6e74 2074 7970  ply to event typ
-0000d1e0: 6573 206f 7220 7374 7265 616d 206e 616d  es or stream nam
-0000d1f0: 6573 2e20 4279 2064 6566 6175 6c74 2c20  es. By default, 
-0000d200: 7468 6973 2076 616c 7565 2069 7320 6046  this value is `F
-0000d210: 616c 7365 600a 616e 6420 736f 2074 6865  alse`.and so the
-0000d220: 2066 696c 7465 7269 6e67 2077 696c 6c20   filtering will 
-0000d230: 6170 706c 7920 746f 2074 6865 2065 7665  apply to the eve
-0000d240: 6e74 2074 7970 6520 7374 7269 6e67 7320  nt type strings 
-0000d250: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-0000d260: 7473 2e0a 0a50 6c65 6173 6520 6e6f 7465  ts...Please note
-0000d270: 2c20 7468 6520 6669 6c74 6572 696e 6720  , the filtering 
-0000d280: 6861 7070 656e 7320 6f6e 2074 6865 2045  happens on the E
-0000d290: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-0000d2a0: 6572 2c20 616e 6420 7468 650a 606c 696d  er, and the.`lim
-0000d2b0: 6974 6020 6172 6775 6d65 6e74 2069 7320  it` argument is 
-0000d2c0: 6170 706c 6965 6420 6f6e 2074 6865 2073  applied on the s
-0000d2d0: 6572 7665 7220 6166 7465 7220 6669 6c74  erver after filt
-0000d2e0: 6572 696e 672e 0a0a 5468 6520 6f70 7469  ering...The opti
-0000d2f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-0000d300: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-0000d310: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
-0000d320: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
-0000d330: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-0000d340: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-0000d350: 206f 7065 7261 7469 6f6e 2e0a 0a54 6869   operation...Thi
-0000d360: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
-0000d370: 2061 2050 7974 686f 6e20 6974 6572 6174   a Python iterat
-0000d380: 6f72 2074 6861 7420 7969 656c 6473 2072  or that yields r
-0000d390: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
-0000d3a0: 696e 636c 7564 696e 6720 6576 656e 7473  including events
-0000d3b0: 0a74 6861 7420 6172 6520 7265 636f 7264  .that are record
-0000d3c0: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-0000d3d0: 7363 7269 7074 696f 6e20 7761 7320 6372  scription was cr
-0000d3e0: 6561 7465 642e 2049 7465 7261 7469 6e67  eated. Iterating
-0000d3f0: 206f 7665 7220 7468 6973 206f 626a 6563   over this objec
-0000d400: 7420 7769 6c6c 0a74 6865 7265 666f 7265  t will.therefore
-0000d410: 206e 6f74 2073 746f 702c 2075 6e6c 6573   not stop, unles
-0000d420: 7320 7468 6520 636f 6e6e 6563 7469 6f6e  s the connection
-0000d430: 2074 6f20 7468 6520 6461 7461 6261 7365   to the database
-0000d440: 2069 7320 6c6f 7374 2e20 5468 6520 6361   is lost. The ca
-0000d450: 6c6c 2077 696c 6c0a 6265 2065 6e64 6564  ll will.be ended
-0000d460: 2077 6865 6e20 7468 6520 6974 6572 6174   when the iterat
-0000d470: 6f72 206f 626a 6563 7420 6973 2064 656c  or object is del
-0000d480: 6574 6564 2066 726f 6d20 6d65 6d6f 7279  eted from memory
-0000d490: 2c20 7768 6963 6820 7769 6c6c 2068 6170  , which will hap
-0000d4a0: 7065 6e20 7768 656e 2074 6865 0a69 7465  pen when the.ite
-0000d4b0: 7261 746f 7220 6f62 6a65 6374 2067 6f65  rator object goe
-0000d4c0: 7320 6f75 7420 6f66 2073 636f 7065 206f  s out of scope o
-0000d4d0: 7220 6973 2065 7870 6c69 6369 746c 7920  r is explicitly 
-0000d4e0: 6465 6c65 7465 642e 2054 6865 2063 616c  deleted. The cal
-0000d4f0: 6c20 6d61 7920 616c 736f 2062 650a 636c  l may also be.cl
-0000d500: 6f73 6564 2062 7920 7468 6520 7365 7276  osed by the serv
-0000d510: 6572 2e0a 0a54 6865 2073 7562 7363 7269  er...The subscri
-0000d520: 7074 696f 6e20 6f62 6a65 6374 2063 616e  ption object can
-0000d530: 2062 6520 7573 6564 2064 6972 6563 746c   be used directl
-0000d540: 792c 2062 7574 2069 7420 6d69 6768 7420  y, but it might 
-0000d550: 6265 2075 7365 6420 7769 7468 696e 2061  be used within a
-0000d560: 2074 6872 6561 6465 640a 6c6f 6f70 2064   threaded.loop d
-0000d570: 6564 6963 6174 6564 2074 6f20 7265 6365  edicated to rece
-0000d580: 6976 696e 6720 6576 656e 7473 2074 6861  iving events tha
-0000d590: 7420 6361 6e20 6265 2073 746f 7070 6564  t can be stopped
-0000d5a0: 2069 6e20 6120 636f 6e74 726f 6c6c 6564   in a controlled
-0000d5b0: 2077 6179 2c20 7769 7468 0a72 6563 6f72   way, with.recor
-0000d5c0: 6465 6420 6576 656e 7473 2070 7574 206f  ded events put o
-0000d5d0: 6e20 6120 7175 6575 6520 666f 7220 7072  n a queue for pr
-0000d5e0: 6f63 6573 7369 6e67 2069 6e20 6120 6469  ocessing in a di
-0000d5f0: 6666 6572 656e 7420 7468 7265 6164 2e20  fferent thread. 
-0000d600: 5468 6973 2070 6163 6b61 6765 0a64 6f65  This package.doe
-0000d610: 736e 2774 2070 726f 7669 6465 2073 7563  sn't provide suc
-0000d620: 6820 6120 7468 7265 6164 6564 206f 7220  h a threaded or 
-0000d630: 7175 6575 696e 6720 6f62 6a65 6374 2063  queuing object c
-0000d640: 6c61 7373 2e20 4a75 7374 206d 616b 6520  lass. Just make 
-0000d650: 7375 7265 2074 6f20 7265 636f 6e73 7472  sure to reconstr
-0000d660: 7563 740a 7468 6520 7375 6273 6372 6970  uct.the subscrip
-0000d670: 7469 6f6e 2028 616e 6420 7468 6520 7175  tion (and the qu
-0000d680: 6575 6529 2075 7369 6e67 2074 6865 206c  eue) using the l
-0000d690: 6173 7420 7265 636f 7264 6564 2063 6f6d  ast recorded com
-0000d6a0: 6d69 7420 706f 7369 7469 6f6e 2077 6865  mit position whe
-0000d6b0: 6e20 7265 7375 6d69 6e67 0a74 6865 2073  n resuming.the s
-0000d6c0: 7562 7363 7269 7074 696f 6e20 6166 7465  ubscription afte
-0000d6d0: 7220 616e 2065 7272 6f72 2c20 746f 2062  r an error, to b
-0000d6e0: 6520 7375 7265 2061 6c6c 2065 7665 6e74  e sure all event
-0000d6f0: 7320 6172 6520 7072 6f63 6573 7365 6420  s are processed 
-0000d700: 6f6e 6365 2e0a 0a54 6865 2065 7861 6d70  once...The examp
-0000d710: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-0000d720: 6f77 2074 6f20 7375 6273 6372 6962 6520  ow to subscribe 
-0000d730: 746f 2072 6563 6569 7665 2061 6c6c 2072  to receive all r
-0000d740: 6563 6f72 6465 640a 6576 656e 7473 2066  ecorded.events f
-0000d750: 726f 6d20 7468 6520 7374 6172 742c 2061  rom the start, a
-0000d760: 6e64 2074 6865 6e20 7265 7375 6d69 6e67  nd then resuming
-0000d770: 2066 726f 6d20 6120 7370 6563 6966 6963   from a specific
-0000d780: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000d790: 2e0a 5468 7265 6520 616c 7265 6164 792d  ..Three already-
-0000d7a0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000d7b0: 6172 6520 7265 6365 6976 6564 2c20 616e  are received, an
-0000d7c0: 6420 7468 656e 2074 6872 6565 206e 6577  d then three new
-0000d7d0: 2065 7665 6e74 7320 6172 650a 7265 636f   events are.reco
-0000d7e0: 7264 6564 2c20 7768 6963 6820 6172 6520  rded, which are 
-0000d7f0: 7468 656e 2072 6563 6569 7665 6420 7669  then received vi
-0000d800: 6120 7468 6520 7375 6273 6372 6970 7469  a the subscripti
-0000d810: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a0a  on...```python..
-0000d820: 2320 4170 7065 6e64 2061 6e20 6576 656e  # Append an even
-0000d830: 7420 746f 2061 206e 6577 2073 7472 6561  t to a new strea
-0000d840: 6d2e 0a73 7472 6561 6d5f 6e61 6d65 3220  m..stream_name2 
-0000d850: 3d20 7374 7228 7575 6964 3428 2929 0a65  = str(uuid4()).e
-0000d860: 7665 6e74 3420 3d20 4e65 7745 7665 6e74  vent4 = NewEvent
-0000d870: 2874 7970 653d 274f 7264 6572 4372 6561  (type='OrderCrea
-0000d880: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
-0000d890: 6134 2729 0a63 6c69 656e 742e 6170 7065  a4').client.appe
-0000d8a0: 6e64 5f65 7665 6e74 7328 0a20 2020 2073  nd_events(.    s
-0000d8b0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-0000d8c0: 6d5f 6e61 6d65 322c 0a20 2020 2065 7870  m_name2,.    exp
-0000d8d0: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
-0000d8e0: 6f6e 652c 0a20 2020 2065 7665 6e74 733d  one,.    events=
-0000d8f0: 5b65 7665 6e74 345d 2c0a 290a 0a23 2053  [event4],.)..# S
-0000d900: 7562 7363 7269 6265 2066 726f 6d20 7468  ubscribe from th
-0000d910: 6520 6669 7273 7420 7265 636f 7264 6564  e first recorded
-0000d920: 2065 7665 6e74 2069 6e20 7468 6520 6461   event in the da
-0000d930: 7461 6261 7365 2e0a 7375 6273 6372 6970  tabase..subscrip
-0000d940: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
-0000d950: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
-0000d960: 7473 2829 0a72 6563 6569 7665 645f 6576  ts().received_ev
-0000d970: 656e 7473 203d 205b 5d0a 0a23 2050 726f  ents = []..# Pro
-0000d980: 6365 7373 2065 7665 6e74 7320 7265 6365  cess events rece
-0000d990: 6976 6564 2066 726f 6d20 7468 6520 6361  ived from the ca
-0000d9a0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-0000d9b0: 696f 6e2e 0a66 6f72 2065 7665 6e74 2069  ion..for event i
-0000d9c0: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
-0000d9d0: 2020 2020 6c61 7374 5f63 6f6d 6d69 745f      last_commit_
-0000d9e0: 706f 7369 7469 6f6e 203d 2065 7665 6e74  position = event
-0000d9f0: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-0000da00: 0a20 2020 2072 6563 6569 7665 645f 6576  .    received_ev
-0000da10: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
-0000da20: 7429 0a20 2020 2069 6620 6576 656e 742e  t).    if event.
-0000da30: 6964 203d 3d20 6576 656e 7434 2e69 643a  id == event4.id:
-0000da40: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
-0000da50: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000da60: 6576 656e 7473 5b2d 385d 2e69 6420 3d3d  events[-8].id ==
-0000da70: 2065 7665 6e74 312e 6964 0a61 7373 6572   event1.id.asser
-0000da80: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000da90: 735b 2d37 5d2e 6964 203d 3d20 6576 656e  s[-7].id == even
-0000daa0: 7432 2e69 640a 6173 7365 7274 2072 6563  t2.id.assert rec
-0000dab0: 6569 7665 645f 6576 656e 7473 5b2d 365d  eived_events[-6]
-0000dac0: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
-0000dad0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000dae0: 5f65 7665 6e74 735b 2d35 5d2e 7479 7065  _events[-5].type
-0000daf0: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
-0000db00: 6564 220a 6173 7365 7274 2072 6563 6569  ed".assert recei
-0000db10: 7665 645f 6576 656e 7473 5b2d 345d 2e74  ved_events[-4].t
-0000db20: 7970 6520 3d3d 2022 446f 674c 6561 726e  ype == "DogLearn
-0000db30: 6564 5472 6963 6b22 0a61 7373 6572 7420  edTrick".assert 
-0000db40: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000db50: 2d33 5d2e 7479 7065 203d 3d20 2244 6f67  -3].type == "Dog
-0000db60: 4c65 6172 6e65 6454 7269 636b 220a 6173  LearnedTrick".as
-0000db70: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000db80: 656e 7473 5b2d 325d 2e74 7970 6520 3d3d  ents[-2].type ==
-0000db90: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
-0000dba0: 6b22 0a61 7373 6572 7420 7265 6365 6976  k".assert receiv
-0000dbb0: 6564 5f65 7665 6e74 735b 2d31 5d2e 6964  ed_events[-1].id
-0000dbc0: 203d 3d20 6576 656e 7434 2e69 640a 0a23   == event4.id..#
-0000dbd0: 2041 7070 656e 6420 7375 6273 6571 7565   Append subseque
-0000dbe0: 6e74 2065 7665 6e74 7320 746f 2074 6865  nt events to the
-0000dbf0: 2073 7472 6561 6d2e 0a65 7665 6e74 3520   stream..event5 
-0000dc00: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
-0000dc10: 274f 7264 6572 5570 6461 7465 6427 2c20  'OrderUpdated', 
-0000dc20: 6461 7461 3d62 2764 6174 6135 2729 0a63  data=b'data5').c
-0000dc30: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-0000dc40: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-0000dc50: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000dc60: 322c 0a20 2020 2065 7870 6563 7465 645f  2,.    expected_
-0000dc70: 706f 7369 7469 6f6e 3d30 2c0a 2020 2020  position=0,.    
-0000dc80: 6576 656e 7473 3d5b 6576 656e 7435 5d2c  events=[event5],
-0000dc90: 0a29 0a0a 2320 5265 6365 6976 6520 7375  .)..# Receive su
-0000dca0: 6273 6571 7565 6e74 2065 7665 6e74 7320  bsequent events 
-0000dcb0: 6672 6f6d 2074 6865 2073 7562 7363 7269  from the subscri
-0000dcc0: 7074 696f 6e2e 0a66 6f72 2065 7665 6e74  ption..for event
-0000dcd0: 2069 6e20 7375 6273 6372 6970 7469 6f6e   in subscription
-0000dce0: 3a0a 2020 2020 6c61 7374 5f63 6f6d 6d69  :.    last_commi
-0000dcf0: 745f 706f 7369 7469 6f6e 203d 2065 7665  t_position = eve
-0000dd00: 6e74 2e63 6f6d 6d69 745f 706f 7369 7469  nt.commit_positi
-0000dd10: 6f6e 0a20 2020 2072 6563 6569 7665 645f  on.    received_
-0000dd20: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-0000dd30: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-0000dd40: 742e 6964 203d 3d20 6576 656e 7435 2e69  t.id == event5.i
-0000dd50: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
-0000dd60: 0a0a 0a0a 6173 7365 7274 2072 6563 6569  ....assert recei
-0000dd70: 7665 645f 6576 656e 7473 5b2d 325d 2e69  ved_events[-2].i
-0000dd80: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
-0000dd90: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000dda0: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
-0000ddb0: 6576 656e 7435 2e69 640a 0a0a 2320 4170  event5.id...# Ap
-0000ddc0: 7065 6e64 206d 6f72 6520 6576 656e 7473  pend more events
-0000ddd0: 2074 6f20 7468 6520 7374 7265 616d 2e0a   to the stream..
-0000dde0: 6576 656e 7436 203d 204e 6577 4576 656e  event6 = NewEven
-0000ddf0: 7428 7479 7065 3d27 4f72 6465 7244 656c  t(type='OrderDel
-0000de00: 6574 6564 272c 2064 6174 613d 6227 6461  eted', data=b'da
-0000de10: 7461 3627 290a 636c 6965 6e74 2e61 7070  ta6').client.app
-0000de20: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
-0000de30: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000de40: 616d 5f6e 616d 6532 2c0a 2020 2020 6578  am_name2,.    ex
-0000de50: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-0000de60: 312c 0a20 2020 2065 7665 6e74 733d 5b65  1,.    events=[e
-0000de70: 7665 6e74 365d 2c0a 290a 0a0a 2320 5265  vent6],.)...# Re
-0000de80: 7375 6d65 2073 7562 7363 7269 6269 6e67  sume subscribing
-0000de90: 2066 726f 6d20 7468 6520 6c61 7374 2063   from the last c
-0000dea0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e0a  ommit position..
-0000deb0: 7375 6273 6372 6970 7469 6f6e 203d 2063  subscription = c
-0000dec0: 6c69 656e 742e 7375 6273 6372 6962 655f  lient.subscribe_
-0000ded0: 616c 6c5f 6576 656e 7473 280a 2020 2020  all_events(.    
-0000dee0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
-0000def0: 6c61 7374 5f63 6f6d 6d69 745f 706f 7369  last_commit_posi
-0000df00: 7469 6f6e 0a29 0a0a 0a23 2043 6174 6368  tion.)...# Catch
-0000df10: 2075 7020 6279 2072 6563 6569 7669 6e67   up by receiving
-0000df20: 2074 6865 206e 6577 2065 7665 6e74 2066   the new event f
-0000df30: 726f 6d20 7468 6520 7375 6273 6372 6970  rom the subscrip
-0000df40: 7469 6f6e 2e0a 666f 7220 6576 656e 7420  tion..for event 
-0000df50: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
-0000df60: 0a20 2020 2072 6563 6569 7665 645f 6576  .    received_ev
-0000df70: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
-0000df80: 7429 0a20 2020 2069 6620 6576 656e 742e  t).    if event.
-0000df90: 6964 203d 3d20 6576 656e 7436 2e69 643a  id == event6.id:
-0000dfa0: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
-0000dfb0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000dfc0: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
-0000dfd0: 2065 7665 6e74 342e 6964 0a61 7373 6572   event4.id.asser
-0000dfe0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000dff0: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
-0000e000: 7435 2e69 640a 6173 7365 7274 2072 6563  t5.id.assert rec
-0000e010: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
-0000e020: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-0000e030: 0a0a 0a23 2041 7070 656e 6420 7468 7265  ...# Append thre
-0000e040: 6520 6d6f 7265 2065 7665 6e74 7320 746f  e more events to
-0000e050: 2061 206e 6577 2073 7472 6561 6d2e 0a73   a new stream..s
-0000e060: 7472 6561 6d5f 6e61 6d65 3320 3d20 7374  tream_name3 = st
-0000e070: 7228 7575 6964 3428 2929 0a65 7665 6e74  r(uuid4()).event
-0000e080: 3720 3d20 4e65 7745 7665 6e74 2874 7970  7 = NewEvent(typ
-0000e090: 653d 274f 7264 6572 4372 6561 7465 6427  e='OrderCreated'
-0000e0a0: 2c20 6461 7461 3d62 2764 6174 6137 2729  , data=b'data7')
-0000e0b0: 0a65 7665 6e74 3820 3d20 4e65 7745 7665  .event8 = NewEve
-0000e0c0: 6e74 2874 7970 653d 274f 7264 6572 5570  nt(type='OrderUp
-0000e0d0: 6461 7465 6427 2c20 6461 7461 3d62 2764  dated', data=b'd
-0000e0e0: 6174 6138 2729 0a65 7665 6e74 3920 3d20  ata8').event9 = 
-0000e0f0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
-0000e100: 7264 6572 4465 6c65 7465 6427 2c20 6461  rderDeleted', da
-0000e110: 7461 3d62 2764 6174 6139 2729 0a0a 636c  ta=b'data9')..cl
-0000e120: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-0000e130: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-0000e140: 616d 653d 7374 7265 616d 5f6e 616d 6533  ame=stream_name3
-0000e150: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
-0000e160: 6f73 6974 696f 6e3d 4e6f 6e65 2c0a 2020  osition=None,.  
-0000e170: 2020 6576 656e 7473 3d5b 6576 656e 7437    events=[event7
-0000e180: 2c20 6576 656e 7438 2c20 6576 656e 7439  , event8, event9
-0000e190: 5d2c 0a29 0a0a 2320 5265 6365 6976 6520  ],.)..# Receive 
-0000e1a0: 7468 6520 7468 7265 6520 6e65 7720 6576  the three new ev
-0000e1b0: 656e 7473 2066 726f 6d20 7468 6520 7265  ents from the re
-0000e1c0: 7375 6d65 6420 7375 6273 6372 6970 7469  sumed subscripti
-0000e1d0: 6f6e 2e0a 666f 7220 6576 656e 7420 696e  on..for event in
-0000e1e0: 2073 7562 7363 7269 7074 696f 6e3a 0a20   subscription:. 
-0000e1f0: 2020 2072 6563 6569 7665 645f 6576 656e     received_even
-0000e200: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
-0000e210: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-0000e220: 203d 3d20 6576 656e 7439 2e69 643a 0a20   == event9.id:. 
-0000e230: 2020 2020 2020 2062 7265 616b 0a0a 6173         break..as
-0000e240: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000e250: 656e 7473 5b2d 365d 2e69 6420 3d3d 2065  ents[-6].id == e
-0000e260: 7665 6e74 342e 6964 0a61 7373 6572 7420  vent4.id.assert 
-0000e270: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000e280: 2d35 5d2e 6964 203d 3d20 6576 656e 7435  -5].id == event5
-0000e290: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
-0000e2a0: 7665 645f 6576 656e 7473 5b2d 345d 2e69  ved_events[-4].i
-0000e2b0: 6420 3d3d 2065 7665 6e74 362e 6964 0a61  d == event6.id.a
-0000e2c0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000e2d0: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
-0000e2e0: 6576 656e 7437 2e69 640a 6173 7365 7274  event7.id.assert
-0000e2f0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000e300: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
-0000e310: 382e 6964 0a61 7373 6572 7420 7265 6365  8.id.assert rece
-0000e320: 6976 6564 5f65 7665 6e74 735b 2d31 5d2e  ived_events[-1].
-0000e330: 6964 203d 3d20 6576 656e 7439 2e69 640a  id == event9.id.
-0000e340: 6060 600a 0a54 6865 2063 6174 6368 2d75  ```..The catch-u
-0000e350: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
-0000e360: 616c 6c20 6973 2065 6e64 6564 2061 7320  all is ended as 
-0000e370: 736f 6f6e 2061 7320 7468 6520 7375 6273  soon as the subs
-0000e380: 6372 6970 7469 6f6e 206f 626a 6563 740a  cription object.
-0000e390: 676f 6573 206f 7574 206f 6620 7363 6f70  goes out of scop
-0000e3a0: 6520 6f72 2069 7320 6578 706c 6963 6974  e or is explicit
-0000e3b0: 6c79 2064 656c 6574 6564 2066 726f 6d20  ly deleted from 
-0000e3c0: 6d65 6d6f 7279 2e0a 0a60 6060 7079 7468  memory...```pyth
-0000e3d0: 6f6e 0a23 2045 6e64 2074 6865 2073 7562  on.# End the sub
-0000e3e0: 7363 7269 7074 696f 6e2e 0a64 656c 2073  scription..del s
-0000e3f0: 7562 7363 7269 7074 696f 6e0a 6060 600a  ubscription.```.
-0000e400: 0a23 2323 2053 7562 7363 7269 6265 2073  .### Subscribe s
-0000e410: 7472 6561 6d20 6576 656e 7473 0a0a 5468  tream events..Th
-0000e420: 6560 7375 6273 6372 6962 655f 7374 7265  e`subscribe_stre
-0000e430: 616d 5f65 7665 6e74 7328 2960 206d 6574  am_events()` met
-0000e440: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
-0000e450: 746f 2073 7461 7274 2061 2022 6361 7463  to start a "catc
-0000e460: 682d 7570 2220 7375 6273 6372 6970 7469  h-up" subscripti
-0000e470: 6f6e 0a74 6861 7420 6361 6e20 7265 7475  on.that can retu
-0000e480: 726e 2065 7665 6e74 7320 7468 6174 2061  rn events that a
-0000e490: 7265 2072 6563 6f72 6465 6420 696e 2061  re recorded in a
-0000e4a0: 2073 696e 676c 6520 7374 7265 616d 2e0a   single stream..
-0000e4b0: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
-0000e4c0: 6573 2061 2072 6571 7569 7265 6420 6073  es a required `s
-0000e4d0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
-0000e4e0: 6d65 6e74 2c20 7768 6963 6820 7370 6563  ment, which spec
-0000e4f0: 6966 6965 7320 7468 6520 6e61 6d65 206f  ifies the name o
-0000e500: 6620 7468 6520 7374 7265 616d 0a66 726f  f the stream.fro
-0000e510: 6d20 7768 6963 6820 7265 636f 7264 6564  m which recorded
-0000e520: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-0000e530: 7265 6365 6976 6564 2e0a 0a54 6869 7320  received...This 
-0000e540: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-0000e550: 7320 7477 6f20 6f70 7469 6f6e 616c 2061  s two optional a
-0000e560: 7267 756d 656e 7473 2c20 6073 7472 6561  rguments, `strea
-0000e570: 6d5f 706f 7369 7469 6f6e 602c 2061 6e64  m_position`, and
-0000e580: 2060 7469 6d65 6f75 7460 2e0a 0a54 6865   `timeout`...The
-0000e590: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
-0000e5a0: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
-0000e5b0: 6d65 6e74 2073 7065 6369 6669 6573 2061  ment specifies a
-0000e5c0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-0000e5d0: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
-0000e5e0: 6368 0a72 6563 6f72 6465 6420 6576 656e  ch.recorded even
-0000e5f0: 7473 2077 696c 6c20 6265 2072 6563 6569  ts will be recei
-0000e600: 7665 642e 2054 6865 2065 7665 6e74 2061  ved. The event a
-0000e610: 7420 7468 6520 7370 6563 6966 6965 6420  t the specified 
-0000e620: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-0000e630: 7769 6c6c 206e 6f74 0a62 6520 696e 636c  will not.be incl
-0000e640: 7564 6564 2e0a 0a54 6865 206f 7074 696f  uded...The optio
-0000e650: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-0000e660: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-0000e670: 6f6e 2060 666c 6f61 7460 2074 6861 7420  on `float` that 
-0000e680: 7365 7473 0a61 2064 6561 646c 696e 6520  sets.a deadline 
-0000e690: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-0000e6a0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-0000e6b0: 7065 7261 7469 6f6e 2e0a 0a54 6865 2065  peration...The e
-0000e6c0: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-0000e6d0: 7773 2068 6f77 2074 6f20 7374 6172 7420  ws how to start 
-0000e6e0: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
-0000e6f0: 7269 7074 696f 6e20 746f 2061 2073 7472  ription to a str
-0000e700: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
-0000e710: 0a23 2053 7562 7363 7269 6265 2074 6f20  .# Subscribe to 
-0000e720: 6576 656e 7473 2066 726f 6d20 7374 7265  events from stre
-0000e730: 616d 322c 2066 726f 6d20 7468 6520 7374  am2, from the st
-0000e740: 6172 742e 0a73 7562 7363 7269 7074 696f  art..subscriptio
-0000e750: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
-0000e760: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
-0000e770: 7473 2873 7472 6561 6d5f 6e61 6d65 3d73  ts(stream_name=s
-0000e780: 7472 6561 6d5f 6e61 6d65 3229 0a0a 2320  tream_name2)..# 
-0000e790: 5265 6164 2066 726f 6d20 7468 6520 7375  Read from the su
-0000e7a0: 6273 6372 6970 7469 6f6e 2e0a 6576 656e  bscription..even
-0000e7b0: 7473 203d 205b 5d0a 666f 7220 6576 656e  ts = [].for even
-0000e7c0: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
-0000e7d0: 6e3a 0a20 2020 2065 7665 6e74 732e 6170  n:.    events.ap
-0000e7e0: 7065 6e64 2865 7665 6e74 290a 2020 2020  pend(event).    
-0000e7f0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
-0000e800: 7665 6e74 362e 6964 3a0a 2020 2020 2020  vent6.id:.      
-0000e810: 2020 6272 6561 6b0a 0a23 2043 6865 636b    break..# Check
-0000e820: 2077 6520 676f 7420 6576 656e 7473 206f   we got events o
-0000e830: 6e6c 7920 6672 6f6d 2073 7472 6561 6d32  nly from stream2
-0000e840: 2e0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-0000e850: 6e74 7329 203d 3d20 330a 6576 656e 7473  nts) == 3.events
-0000e860: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
-0000e870: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-0000e880: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
-0000e890: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000e8a0: 6e61 6d65 320a 6576 656e 7473 5b32 5d2e  name2.events[2].
-0000e8b0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-0000e8c0: 7472 6561 6d5f 6e61 6d65 320a 0a23 2041  tream_name2..# A
-0000e8d0: 7070 656e 6420 616e 6f74 6865 7220 6576  ppend another ev
-0000e8e0: 656e 7420 746f 2073 7472 6561 6d33 2e0a  ent to stream3..
-0000e8f0: 6576 656e 7431 3020 3d20 4e65 7745 7665  event10 = NewEve
-0000e900: 6e74 2874 7970 653d 224f 7264 6572 556e  nt(type="OrderUn
-0000e910: 6465 6c65 7465 6422 2c20 6461 7461 3d62  deleted", data=b
-0000e920: 2764 6174 6131 3027 290a 636c 6965 6e74  'data10').client
-0000e930: 2e61 7070 656e 645f 6576 656e 7473 280a  .append_events(.
-0000e940: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000e950: 7374 7265 616d 5f6e 616d 6533 2c0a 2020  stream_name3,.  
-0000e960: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
-0000e970: 696f 6e3d 322c 0a20 2020 2065 7665 6e74  ion=2,.    event
-0000e980: 733d 5b65 7665 6e74 3130 5d2c 0a29 0a0a  s=[event10],.)..
-0000e990: 2320 4170 7065 6e64 2061 6e6f 7468 6572  # Append another
-0000e9a0: 2065 7665 6e74 2074 6f20 7374 7265 616d   event to stream
-0000e9b0: 322e 0a65 7665 6e74 3131 203d 204e 6577  2..event11 = New
-0000e9c0: 4576 656e 7428 7479 7065 3d22 4f72 6465  Event(type="Orde
-0000e9d0: 7255 6e64 656c 6574 6564 222c 2064 6174  rUndeleted", dat
-0000e9e0: 613d 6227 6461 7461 3131 2729 0a63 6c69  a=b'data11').cli
-0000e9f0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
-0000ea00: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-0000ea10: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-0000ea20: 0a20 2020 2065 7870 6563 7465 645f 706f  .    expected_po
-0000ea30: 7369 7469 6f6e 3d32 2c0a 2020 2020 6576  sition=2,.    ev
-0000ea40: 656e 7473 3d5b 6576 656e 7431 315d 0a29  ents=[event11].)
-0000ea50: 0a0a 2320 436f 6e74 696e 7565 2072 6561  ..# Continue rea
-0000ea60: 6469 6e67 2066 726f 6d20 7468 6520 7375  ding from the su
-0000ea70: 6273 6372 6970 7469 6f6e 2e0a 666f 7220  bscription..for 
-0000ea80: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
-0000ea90: 7074 696f 6e3a 0a20 2020 2065 7665 6e74  ption:.    event
-0000eaa0: 732e 6170 7065 6e64 2865 7665 6e74 290a  s.append(event).
-0000eab0: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-0000eac0: 3d3d 2065 7665 6e74 3131 2e69 643a 0a20  == event11.id:. 
-0000ead0: 2020 2020 2020 2062 7265 616b 0a0a 2320         break..# 
-0000eae0: 4368 6563 6b20 7765 2067 6f74 2065 7665  Check we got eve
-0000eaf0: 6e74 7320 6f6e 6c79 2066 726f 6d20 7374  nts only from st
-0000eb00: 7265 616d 322e 0a61 7373 6572 7420 6c65  ream2..assert le
-0000eb10: 6e28 6576 656e 7473 2920 3d3d 2034 0a65  n(events) == 4.e
-0000eb20: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-0000eb30: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-0000eb40: 616d 6532 0a65 7665 6e74 735b 315d 2e73  ame2.events[1].s
-0000eb50: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-0000eb60: 7265 616d 5f6e 616d 6532 0a65 7665 6e74  ream_name2.event
-0000eb70: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
-0000eb80: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-0000eb90: 0a65 7665 6e74 735b 335d 2e73 7472 6561  .events[3].strea
-0000eba0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000ebb0: 5f6e 616d 6532 0a60 6060 0a0a 5468 6520  _name2.```..The 
-0000ebc0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000ebd0: 6f77 7320 686f 7720 746f 2073 7461 7274  ows how to start
-0000ebe0: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-0000ebf0: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
-0000ec00: 7265 616d 2066 726f 6d20 610a 7370 6563  ream from a.spec
-0000ec10: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
-0000ec20: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
-0000ec30: 0a0a 2320 5375 6273 6372 6962 6520 746f  ..# Subscribe to
-0000ec40: 2065 7665 6e74 7320 6672 6f6d 2073 7472   events from str
-0000ec50: 6561 6d32 2c20 6672 6f6d 2074 6865 2073  eam2, from the s
-0000ec60: 7461 7274 2e0a 7375 6273 6372 6970 7469  tart..subscripti
-0000ec70: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
-0000ec80: 6372 6962 655f 7374 7265 616d 5f65 7665  cribe_stream_eve
-0000ec90: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-0000eca0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000ecb0: 322c 0a20 2020 2073 7472 6561 6d5f 706f  2,.    stream_po
-0000ecc0: 7369 7469 6f6e 3d31 2c0a 290a 0a23 2052  sition=1,.)..# R
-0000ecd0: 6561 6420 6576 656e 7420 6672 6f6d 2074  ead event from t
-0000ece0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-0000ecf0: 0a65 7665 6e74 7320 3d20 5b5d 0a66 6f72  .events = [].for
-0000ed00: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
-0000ed10: 6970 7469 6f6e 3a0a 2020 2020 6576 656e  iption:.    even
-0000ed20: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
-0000ed30: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-0000ed40: 203d 3d20 6576 656e 7431 312e 6964 3a0a   == event11.id:.
-0000ed50: 2020 2020 2020 2020 6272 6561 6b0a 0a23          break..#
-0000ed60: 2043 6865 636b 2077 6520 676f 7420 6576   Check we got ev
-0000ed70: 656e 7473 206f 6e6c 7920 6166 7465 7220  ents only after 
-0000ed80: 706f 7369 7469 6f6e 2031 2e0a 6173 7365  position 1..asse
-0000ed90: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-0000eda0: 3d20 320a 6576 656e 7473 5b30 5d2e 6964  = 2.events[0].id
-0000edb0: 203d 3d20 6576 656e 7436 2e69 640a 6576   == event6.id.ev
-0000edc0: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-0000edd0: 6f73 6974 696f 6e20 3d3d 2032 0a65 7665  osition == 2.eve
-0000ede0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
-0000edf0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-0000ee00: 6532 0a65 7665 6e74 735b 315d 2e69 6420  e2.events[1].id 
-0000ee10: 3d3d 2065 7665 6e74 3131 2e69 640a 6576  == event11.id.ev
-0000ee20: 656e 7473 5b31 5d2e 7374 7265 616d 5f70  ents[1].stream_p
-0000ee30: 6f73 6974 696f 6e20 3d3d 2033 0a65 7665  osition == 3.eve
-0000ee40: 6e74 735b 315d 2e73 7472 6561 6d5f 6e61  nts[1].stream_na
-0000ee50: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-0000ee60: 6532 0a60 6060 0a0a 2323 2050 6572 7369  e2.```..## Persi
-0000ee70: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-0000ee80: 6f6e 730a 0a23 2323 2043 7265 6174 6520  ons..### Create 
-0000ee90: 7375 6273 6372 6970 7469 6f6e 0a0a 2a72  subscription..*r
-0000eea0: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
-0000eeb0: 0a54 6865 206d 6574 686f 6420 6063 7265  .The method `cre
-0000eec0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-0000eed0: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
-0000eee0: 746f 2063 7265 6174 6520 610a 2270 6572  to create a."per
-0000eef0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000ef00: 7469 6f6e 2220 746f 2045 7665 6e74 5374  tion" to EventSt
-0000ef10: 6f72 6544 422e 0a0a 5468 6973 206d 6574  oreDB...This met
-0000ef20: 686f 6420 7461 6b65 7320 6120 7265 7175  hod takes a requ
-0000ef30: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
-0000ef40: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-0000ef50: 6820 6973 2074 6865 0a6e 616d 6520 6f66  h is the.name of
-0000ef60: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
-0000ef70: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
-0000ef80: 7562 7363 7269 7074 696f 6e2e 0a0a 5468  ubscription...Th
-0000ef90: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
-0000efa0: 616b 6573 2073 6576 656e 206f 7074 696f  akes seven optio
-0000efb0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
-0000efc0: 6672 6f6d 5f65 6e64 602c 2060 636f 6d6d  from_end`, `comm
-0000efd0: 6974 5f70 6f73 6974 696f 6e60 2c0a 6066  it_position`,.`f
-0000efe0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
-0000eff0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-0000f000: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
-0000f010: 6561 6d5f 6e61 6d65 602c 2060 636f 6e73  eam_name`, `cons
-0000f020: 756d 6572 5f73 7472 6174 6567 7960 2c0a  umer_strategy`,.
-0000f030: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
-0000f040: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
-0000f050: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
-0000f060: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0000f070: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
-0000f080: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-0000f090: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
-0000f0a0: 7269 7074 696f 6e20 7368 6f75 6c64 206f  ription should o
-0000f0b0: 6e6c 7920 7265 6365 6976 6520 6576 656e  nly receive even
-0000f0c0: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
-0000f0d0: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
-0000f0e0: 7375 6273 6372 6970 7469 6f6e 0a77 6173  subscription.was
-0000f0f0: 2063 7265 6174 6564 2e0a 0a41 6c74 6572   created...Alter
-0000f100: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
-0000f110: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
-0000f120: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-0000f130: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-0000f140: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
-0000f150: 740a 706f 7369 7469 6f6e 2066 726f 6d20  t.position from 
-0000f160: 7768 6963 6820 636f 6d6d 6974 2070 6f73  which commit pos
-0000f170: 6974 696f 6e20 7468 6520 6772 6f75 7020  ition the group 
-0000f180: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-0000f190: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f1a0: 2073 686f 756c 640a 7265 6365 6976 6520   should.receive 
-0000f1b0: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
-0000f1c0: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
-0000f1d0: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
-0000f1e0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
-0000f1f0: 706f 7369 7469 6f6e 206d 6967 6874 0a62  position might.b
-0000f200: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
-0000f210: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-0000f220: 7320 7265 6365 6976 6564 2062 7920 7468  s received by th
-0000f230: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
-0000f240: 6d65 7273 2e0a 0a49 6620 6e65 6974 6865  mers...If neithe
-0000f250: 7220 6066 726f 6d5f 656e 6460 206f 7220  r `from_end` or 
-0000f260: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-0000f270: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
-0000f280: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-0000f290: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
-0000f2a0: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
-0000f2b0: 2070 6f74 656e 7469 616c 6c79 2072 6563   potentially rec
-0000f2c0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
-0000f2d0: 6420 6576 656e 7473 2069 6e20 7468 6520  d events in the 
-0000f2e0: 6461 7461 6261 7365 2e0a 0a54 6865 206f  database...The o
-0000f2f0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
-0000f300: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
-0000f310: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
-0000f320: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
-0000f330: 7373 696f 6e73 2074 6861 740a 6d61 7463  ssions that.matc
-0000f340: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
-0000f350: 7320 7468 6174 2073 686f 756c 6420 6e6f  s that should no
-0000f360: 7420 6265 2069 6e63 6c75 6465 642e 2054  t be included. T
-0000f370: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
-0000f380: 6967 6e6f 7265 640a 6966 2060 6669 6c74  ignored.if `filt
-0000f390: 6572 5f69 6e63 6c75 6465 6020 6973 2073  er_include` is s
-0000f3a0: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
-0000f3b0: 7920 7365 7175 656e 6365 2e20 4279 2064  y sequence. By d
-0000f3c0: 6566 6175 6c74 2c20 7468 6973 2061 7267  efault, this arg
-0000f3d0: 756d 656e 7420 6973 2073 6574 0a74 6f20  ument is set.to 
-0000f3e0: 6d61 7463 6820 7468 6520 6576 656e 7420  match the event 
-0000f3f0: 7479 7065 7320 6f66 2022 7379 7374 656d  types of "system
-0000f400: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
-0000f410: 7420 4576 656e 7453 746f 7265 4442 2073  t EventStoreDB s
-0000f420: 7973 7465 6d20 6576 656e 7473 0a77 696c  ystem events.wil
-0000f430: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
-0000f440: 6520 7265 6365 6976 6564 2e20 5365 6520  e received. See 
-0000f450: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
-0000f460: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
-0000f470: 2069 6e66 6f72 6d61 7469 6f6e 0a61 626f   information.abo
-0000f480: 7574 2066 696c 7465 7220 6578 7072 6573  ut filter expres
-0000f490: 7369 6f6e 732e 0a0a 5468 6520 6f70 7469  sions...The opti
-0000f4a0: 6f6e 616c 2060 6669 6c74 6572 5f69 6e63  onal `filter_inc
-0000f4b0: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
-0000f4c0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-0000f4d0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-0000f4e0: 6f6e 730a 7468 6174 206d 6174 6368 2072  ons.that match r
-0000f4f0: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-0000f500: 6861 7420 7368 6f75 6c64 2062 6520 7265  hat should be re
-0000f510: 6365 6976 6564 2e20 4279 2064 6566 6175  ceived. By defau
-0000f520: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
-0000f530: 740a 6973 2061 6e20 656d 7074 7920 7475  t.is an empty tu
-0000f540: 706c 652e 2049 6620 7468 6973 2061 7267  ple. If this arg
-0000f550: 756d 656e 7420 6973 2073 6574 2074 6f20  ument is set to 
-0000f560: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
-0000f570: 656e 6365 2c20 7468 650a 6066 696c 7465  ence, the.`filte
-0000f580: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
-0000f590: 656e 7420 6973 2069 676e 6f72 6564 2e0a  ent is ignored..
-0000f5a0: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
-0000f5b0: 696c 7465 725f 6279 5f73 7472 6561 6d5f  ilter_by_stream_
-0000f5c0: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
-0000f5d0: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
-0000f5e0: 6020 7468 6174 2069 6e64 6963 6174 6573  ` that indicates
-0000f5f0: 2077 6865 7468 6572 0a74 6865 2066 696c   whether.the fil
-0000f600: 7465 7220 7769 6c6c 2061 7070 6c79 2074  ter will apply t
-0000f610: 6f20 6576 656e 7420 7479 7065 7320 6f72  o event types or
-0000f620: 2073 7472 6561 6d20 6e61 6d65 732e 2042   stream names. B
-0000f630: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
-0000f640: 7661 6c75 6520 6973 2060 4661 6c73 6560  value is `False`
-0000f650: 0a61 6e64 2073 6f20 7468 6520 6669 6c74  .and so the filt
-0000f660: 6572 696e 6720 7769 6c6c 2061 7070 6c79  ering will apply
-0000f670: 2074 6f20 7468 6520 6576 656e 7420 7479   to the event ty
-0000f680: 7065 2073 7472 696e 6773 206f 6620 7265  pe strings of re
-0000f690: 636f 7264 6564 2065 7665 6e74 732e 0a0a  corded events...
-0000f6a0: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
-0000f6b0: 6e73 756d 6572 5f73 7472 6174 6567 7960  nsumer_strategy`
-0000f6c0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-0000f6d0: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
-0000f6e0: 2064 6566 696e 6573 0a74 6865 2063 6f6e   defines.the con
-0000f6f0: 7375 6d65 7220 7374 7261 7465 6779 2066  sumer strategy f
-0000f700: 6f72 2074 6869 7320 7065 7273 6973 7465  or this persiste
-0000f710: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
-0000f720: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
-0000f730: 6973 2061 7267 756d 656e 740a 6361 6e20  is argument.can 
-0000f740: 6265 2060 2744 6973 7061 7463 6854 6f53  be `'DispatchToS
-0000f750: 696e 676c 6527 602c 2060 2752 6f75 6e64  ingle'`, `'Round
-0000f760: 526f 6269 6e27 602c 2060 2750 696e 6e65  Robin'`, `'Pinne
-0000f770: 6427 602c 206f 7220 6027 5069 6e6e 6564  d'`, or `'Pinned
-0000f780: 4279 436f 7272 656c 6174 696f 6e27 602e  ByCorrelation'`.
-0000f790: 2054 6865 0a64 6566 6175 6c74 2076 616c   The.default val
-0000f7a0: 7565 2069 7320 6027 4469 7370 6174 6368  ue is `'Dispatch
-0000f7b0: 546f 5369 6e67 6c65 2760 2e0a 0a54 6865  ToSingle'`...The
-0000f7c0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-0000f7d0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
-0000f7e0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-0000f7f0: 2077 6869 6368 2073 6574 7320 610a 6465   which sets a.de
-0000f800: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
-0000f810: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-0000f820: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-0000f830: 0a0a 5468 6520 6d65 7468 6f64 2060 6372  ..The method `cr
-0000f840: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-0000f850: 6e28 2960 2064 6f65 7320 6e6f 7420 7265  n()` does not re
-0000f860: 7475 726e 2061 2076 616c 7565 2c20 6265  turn a value, be
-0000f870: 6361 7573 650a 7265 636f 7264 6564 2065  cause.recorded e
-0000f880: 7665 6e74 7320 6172 6520 6f62 7461 696e  vents are obtain
-0000f890: 6564 2062 7920 7468 6520 6772 6f75 7020  ed by the group 
-0000f8a0: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-0000f8b0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f8c0: 0a75 7369 6e67 2074 6865 2060 7265 6164  .using the `read
-0000f8d0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-0000f8e0: 206d 6574 686f 642e 0a0a 496e 2074 6865   method...In the
-0000f8f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
-0000f900: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
-0000f910: 7363 7269 7074 696f 6e20 6973 2063 7265  scription is cre
-0000f920: 6174 6564 2e0a 0a60 6060 7079 7468 6f6e  ated...```python
-0000f930: 0a23 2043 7265 6174 6520 6120 7065 7273  .# Create a pers
-0000f940: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000f950: 696f 6e2e 0a67 726f 7570 5f6e 616d 6520  ion..group_name 
-0000f960: 3d20 6622 6772 6f75 702d 7b75 7569 6434  = f"group-{uuid4
-0000f970: 2829 7d22 0a63 6c69 656e 742e 6372 6561  ()}".client.crea
-0000f980: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
-0000f990: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-0000f9a0: 5f6e 616d 6529 0a60 6060 0a0a 2323 2320  _name).```..### 
-0000f9b0: 5265 6164 2073 7562 7363 7269 7074 696f  Read subscriptio
-0000f9c0: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
-0000f9d0: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-0000f9e0: 2060 7265 6164 5f73 7562 7363 7269 7074   `read_subscript
-0000f9f0: 696f 6e28 2960 2063 616e 2062 6520 7573  ion()` can be us
-0000fa00: 6564 2062 7920 6120 6772 6f75 7020 6f66  ed by a group of
-0000fa10: 2063 6f6e 7375 6d65 7273 2074 6f20 7265   consumers to re
-0000fa20: 6365 6976 650a 7265 636f 7264 6564 2065  ceive.recorded e
-0000fa30: 7665 6e74 7320 6672 6f6d 2061 2070 6572  vents from a per
-0000fa40: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000fa50: 7469 6f6e 2063 7265 6174 6564 2075 7369  tion created usi
-0000fa60: 6e67 2060 6372 6561 7465 5f73 7562 7363  ng `create_subsc
-0000fa70: 7269 7074 696f 6e60 2e0a 0a54 6869 7320  ription`...This 
-0000fa80: 6d65 7468 6f64 2074 616b 6573 2061 2072  method takes a r
-0000fa90: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
-0000faa0: 616d 6560 2061 7267 756d 656e 742c 2077  ame` argument, w
-0000fab0: 6869 6368 2069 730a 7468 6520 6e61 6d65  hich is.the name
-0000fac0: 206f 6620 6120 2267 726f 7570 2220 6f66   of a "group" of
-0000fad0: 2063 6f6e 7375 6d65 7273 206f 6620 7468   consumers of th
-0000fae0: 6520 7375 6273 6372 6970 7469 6f6e 2073  e subscription s
-0000faf0: 7065 6369 6669 6564 0a77 6865 6e20 6063  pecified.when `c
-0000fb00: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-0000fb10: 6f6e 2829 6020 7761 7320 6361 6c6c 6564  on()` was called
-0000fb20: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-0000fb30: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
-0000fb40: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000fb50: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
-0000fb60: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-0000fb70: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-0000fb80: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
-0000fb90: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
-0000fba0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-0000fbb0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-0000fbc0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-0000fbd0: 7265 7475 726e 7320 6120 6050 6572 7369  returns a `Persi
-0000fbe0: 7374 656e 7453 7562 7363 7269 7074 696f  stentSubscriptio
-0000fbf0: 6e60 206f 626a 6563 742c 2077 6869 6368  n` object, which
-0000fc00: 2069 7320 616e 2069 7465 7261 746f 720a   is an iterator.
-0000fc10: 6769 7669 6e67 2060 5265 636f 7264 6564  giving `Recorded
-0000fc20: 4576 656e 7460 206f 626a 6563 7473 2c20  Event` objects, 
-0000fc30: 7468 6174 2061 6c73 6f20 6861 7320 6061  that also has `a
-0000fc40: 636b 2829 602c 2060 6e61 636b 2829 6020  ck()`, `nack()` 
-0000fc50: 616e 6420 6073 746f 7028 2960 0a6d 6574  and `stop()`.met
-0000fc60: 686f 6473 2e0a 0a60 6060 7079 7468 6f6e  hods...```python
-0000fc70: 0a73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
-0000fc80: 636c 6965 6e74 2e72 6561 645f 7375 6273  client.read_subs
-0000fc90: 6372 6970 7469 6f6e 2867 726f 7570 5f6e  cription(group_n
-0000fca0: 616d 653d 6772 6f75 705f 6e61 6d65 290a  ame=group_name).
-0000fcb0: 6060 600a 0a54 6865 2060 6163 6b28 2960  ```..The `ack()`
-0000fcc0: 206d 6574 686f 6420 7368 6f75 6c64 2062   method should b
-0000fcd0: 6520 7573 6564 2062 7920 6120 636f 6e73  e used by a cons
-0000fce0: 756d 6572 2074 6f20 696e 6469 6361 7465  umer to indicate
-0000fcf0: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
-0000fd00: 6861 7420 6974 0a68 6173 2072 6563 6569  hat it.has recei
-0000fd10: 7665 6420 616e 6420 7375 6363 6573 7366  ved and successf
-0000fd20: 756c 6c79 2070 726f 6365 7373 6564 2061  ully processed a
-0000fd30: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
-0000fd40: 2054 6869 7320 7769 6c6c 2070 7265 7665   This will preve
-0000fd50: 6e74 2074 6861 740a 7265 636f 7264 6564  nt that.recorded
-0000fd60: 2065 7665 6e74 2062 6569 6e67 2072 6563   event being rec
-0000fd70: 6569 7665 6420 6279 2061 6e6f 7468 6572  eived by another
-0000fd80: 2063 6f6e 7375 6d65 7220 696e 2074 6865   consumer in the
-0000fd90: 2073 616d 6520 6772 6f75 702e 2054 6865   same group. The
-0000fda0: 2060 6163 6b28 2960 0a6d 6574 686f 6420   `ack()`.method 
-0000fdb0: 7461 6b65 7320 616e 2060 6576 656e 745f  takes an `event_
-0000fdc0: 6964 6020 6172 6775 6d65 6e74 2c20 7768  id` argument, wh
-0000fdd0: 6963 6820 6973 2074 6865 2049 4420 6f66  ich is the ID of
-0000fde0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-0000fdf0: 656e 7420 7468 6174 0a68 6173 2062 6565  ent that.has bee
-0000fe00: 6e20 7265 6365 6976 6564 2e0a 0a54 6865  n received...The
-0000fe10: 2065 7861 6d70 6c65 2062 656c 6f77 2069   example below i
-0000fe20: 7465 7261 7465 7320 6f76 6572 2074 6865  terates over the
-0000fe30: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
-0000fe40: 6a65 6374 2c20 616e 6420 6361 6c6c 7320  ject, and calls 
-0000fe50: 6061 636b 2829 602e 2054 6865 0a60 7374  `ack()`. The.`st
-0000fe60: 6f70 2829 6020 6d65 7468 6f64 2069 7320  op()` method is 
-0000fe70: 6361 6c6c 6564 2077 6865 6e20 7765 2068  called when we h
-0000fe80: 6176 6520 7265 6365 6976 6564 2074 6865  ave received the
-0000fe90: 206c 6173 7420 6576 656e 742c 2073 6f20   last event, so 
-0000fea0: 7468 6174 2077 6520 6361 6e0a 636f 6e74  that we can.cont
-0000feb0: 696e 7565 2077 6974 6820 7468 6520 6578  inue with the ex
-0000fec0: 616d 706c 6573 2062 656c 6f77 2e0a 0a60  amples below...`
-0000fed0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
-0000fee0: 3d20 5b5d 0a66 6f72 2065 7665 6e74 2069  = [].for event i
-0000fef0: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
-0000ff00: 2020 2020 6576 656e 7473 2e61 7070 656e      events.appen
-0000ff10: 6428 6576 656e 7429 0a0a 2020 2020 2320  d(event)..    # 
-0000ff20: 4163 6b6e 6f77 6c65 6467 6520 7468 6520  Acknowledge the 
-0000ff30: 7265 6365 6976 6564 2065 7665 6e74 2e0a  received event..
-0000ff40: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
-0000ff50: 2e61 636b 2865 7665 6e74 5f69 643d 6576  .ack(event_id=ev
-0000ff60: 656e 742e 6964 290a 0a20 2020 2023 2042  ent.id)..    # B
-0000ff70: 7265 616b 2077 6865 6e20 7468 6520 6c61  reak when the la
-0000ff80: 7374 2065 7665 6e74 2068 6173 2062 6565  st event has bee
-0000ff90: 6e20 7265 6365 6976 6564 2e0a 2020 2020  n received..    
-0000ffa0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
-0000ffb0: 7665 6e74 3131 2e69 643a 0a20 2020 2020  vent11.id:.     
-0000ffc0: 2020 2073 7562 7363 7269 7074 696f 6e2e     subscription.
-0000ffd0: 7374 6f70 2829 0a60 6060 0a0a 5468 6520  stop().```..The 
-0000ffe0: 7265 6365 6976 6564 2065 7665 6e74 7320  received events 
-0000fff0: 6172 6520 7468 6520 6576 656e 7473 2077  are the events w
-00010000: 6520 6170 7065 6e64 6564 2061 626f 7665  e appended above
-00010010: 2e0a 0a60 6060 7079 7468 6f6e 0a61 7373  ...```python.ass
-00010020: 6572 7420 6576 656e 7473 5b2d 3135 5d2e  ert events[-15].
-00010030: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-00010040: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
-00010050: 345d 2e69 6420 3d3d 2065 7665 6e74 322e  4].id == event2.
-00010060: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
-00010070: 5b2d 3133 5d2e 6964 203d 3d20 6576 656e  [-13].id == even
-00010080: 7433 2e69 640a 6173 7365 7274 2065 7665  t3.id.assert eve
-00010090: 6e74 735b 2d31 325d 2e74 7970 6520 3d3d  nts[-12].type ==
-000100a0: 2022 446f 6752 6567 6973 7465 7265 6422   "DogRegistered"
-000100b0: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
-000100c0: 3131 5d2e 7479 7065 203d 3d20 2244 6f67  11].type == "Dog
-000100d0: 4c65 6172 6e65 6454 7269 636b 220a 6173  LearnedTrick".as
-000100e0: 7365 7274 2065 7665 6e74 735b 2d31 305d  sert events[-10]
-000100f0: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
-00010100: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
-00010110: 7420 6576 656e 7473 5b2d 395d 2e74 7970  t events[-9].typ
-00010120: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
-00010130: 5472 6963 6b22 0a61 7373 6572 7420 6576  Trick".assert ev
-00010140: 656e 7473 5b2d 385d 2e69 6420 3d3d 2065  ents[-8].id == e
-00010150: 7665 6e74 342e 6964 0a61 7373 6572 7420  vent4.id.assert 
-00010160: 6576 656e 7473 5b2d 375d 2e69 6420 3d3d  events[-7].id ==
-00010170: 2065 7665 6e74 352e 6964 0a61 7373 6572   event5.id.asser
-00010180: 7420 6576 656e 7473 5b2d 365d 2e69 6420  t events[-6].id 
-00010190: 3d3d 2065 7665 6e74 362e 6964 0a61 7373  == event6.id.ass
-000101a0: 6572 7420 6576 656e 7473 5b2d 355d 2e69  ert events[-5].i
-000101b0: 6420 3d3d 2065 7665 6e74 372e 6964 0a61  d == event7.id.a
-000101c0: 7373 6572 7420 6576 656e 7473 5b2d 345d  ssert events[-4]
-000101d0: 2e69 6420 3d3d 2065 7665 6e74 382e 6964  .id == event8.id
-000101e0: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
-000101f0: 335d 2e69 6420 3d3d 2065 7665 6e74 392e  3].id == event9.
-00010200: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
-00010210: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
-00010220: 3130 2e69 640a 6173 7365 7274 2065 7665  10.id.assert eve
-00010230: 6e74 735b 2d31 5d2e 6964 203d 3d20 6576  nts[-1].id == ev
-00010240: 656e 7431 312e 6964 0a60 6060 0a0a 5468  ent11.id.```..Th
-00010250: 6520 2273 7562 7363 7269 7074 696f 6e22  e "subscription"
-00010260: 206f 626a 6563 7420 616c 736f 2068 6173   object also has
-00010270: 2061 6e20 606e 6163 6b28 2960 206d 6574   an `nack()` met
-00010280: 686f 6420 7468 6174 2073 686f 756c 6420  hod that should 
-00010290: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
-000102a0: 7375 6d65 720a 746f 206e 6567 6174 6976  sumer.to negativ
-000102b0: 656c 7920 6163 6b6e 6f77 6c65 6467 6520  ely acknowledge 
-000102c0: 746f 2074 6865 2073 6572 7665 7220 7468  to the server th
-000102d0: 6174 2069 7420 6861 7320 7265 6365 6976  at it has receiv
-000102e0: 6564 2062 7574 206e 6f74 2073 7563 6365  ed but not succe
-000102f0: 7373 6675 6c6c 790a 7072 6f63 6573 7365  ssfully.processe
-00010300: 6420 6120 7265 636f 7264 6564 2065 7665  d a recorded eve
-00010310: 6e74 2e20 5468 6520 606e 6163 6b28 2960  nt. The `nack()`
-00010320: 206d 6574 686f 6420 7461 6b65 7320 616e   method takes an
-00010330: 2060 6576 656e 745f 6964 6020 6172 6775   `event_id` argu
-00010340: 6d65 6e74 2c20 7768 6963 6820 6973 0a74  ment, which is.t
-00010350: 6865 2049 4420 6f66 2074 6865 2072 6563  he ID of the rec
-00010360: 6f72 6465 6420 6576 656e 7420 7468 6174  orded event that
-00010370: 2068 6173 2062 6565 6e20 7265 6365 6976   has been receiv
-00010380: 6564 2c20 616e 6420 616e 2060 6163 7469  ed, and an `acti
-00010390: 6f6e 6020 6172 6775 6d65 6e74 2c20 7768  on` argument, wh
-000103a0: 6963 680a 7368 6f75 6c64 2062 6520 6120  ich.should be a 
-000103b0: 5079 7468 6f6e 2060 7374 7260 2c20 6569  Python `str`, ei
-000103c0: 7468 6572 2060 2775 6e6b 6e6f 776e 2760  ther `'unknown'`
-000103d0: 2c20 6027 7061 726b 2760 2c20 6027 7265  , `'park'`, `'re
-000103e0: 7472 7927 602c 2060 2773 6b69 7027 602c  try'`, `'skip'`,
-000103f0: 206f 7220 6027 7374 6f70 2760 2e0a 0a57   or `'stop'`...W
-00010400: 6869 6c73 7420 7468 6572 6520 6172 6520  hilst there are 
-00010410: 736f 6d65 2061 6476 616e 7461 6765 7320  some advantages 
-00010420: 6f66 2070 6572 7369 7374 656e 7420 7375  of persistent su
-00010430: 6273 6372 6970 7469 6f6e 732c 2069 6e20  bscriptions, in 
-00010440: 7061 7274 6963 756c 6172 2074 6865 0a70  particular the.p
-00010450: 726f 6365 7373 696e 6720 6f66 2072 6563  rocessing of rec
-00010460: 6f72 6465 6420 6576 656e 7473 2062 7920  orded events by 
-00010470: 6120 6772 6f75 7020 6f66 2063 6f6e 7375  a group of consu
-00010480: 6d65 7273 2c20 6279 2074 7261 636b 696e  mers, by trackin
-00010490: 6720 696e 2074 6865 2073 6572 7665 720a  g in the server.
-000104a0: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
-000104b0: 7468 6520 636f 6d6d 6974 2073 6571 7565  the commit seque
-000104c0: 6e63 6520 6f66 2065 7665 6e74 7320 7468  nce of events th
-000104d0: 6174 2068 6176 6520 6265 656e 2070 726f  at have been pro
-000104e0: 6365 7373 6564 2c20 7468 6572 6520 6973  cessed, there is
-000104f0: 0a74 6865 2064 616e 6765 7220 6f66 2022  .the danger of "
-00010500: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
-00010510: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
-00010520: 206f 6620 6576 656e 7473 2e20 5265 6c69   of events. Reli
-00010530: 6162 696c 6974 7920 696e 2070 726f 6365  ability in proce
-00010540: 7373 696e 670a 6f66 2072 6563 6f72 6465  ssing.of recorde
-00010550: 6420 6576 656e 7473 2062 7920 6120 6772  d events by a gr
-00010560: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00010570: 2077 696c 6c20 7265 6c79 2069 6e73 7465   will rely inste
-00010580: 6164 206f 6e20 6964 656d 706f 7465 6e74  ad on idempotent
-00010590: 2068 616e 646c 696e 670a 6f66 2064 7570   handling.of dup
-000105a0: 6c69 6361 7465 206d 6573 7361 6765 732c  licate messages,
-000105b0: 2061 6e64 2072 6573 696c 6965 6e63 6520   and resilience 
-000105c0: 746f 206f 7574 2d6f 662d 6f72 6465 7220  to out-of-order 
-000105d0: 6465 6c69 7665 7279 2e0a 0a23 2323 2047  delivery...### G
-000105e0: 6574 2073 7562 7363 7269 7074 696f 6e20  et subscription 
-000105f0: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
-00010600: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
-00010610: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
-00010620: 6e66 6f28 2960 206d 6574 686f 6420 6361  nfo()` method ca
-00010630: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
-00010640: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
-00010650: 2061 0a70 6572 7369 7374 656e 7420 7375   a.persistent su
-00010660: 6273 6372 6970 7469 6f6e 2e0a 0a54 6869  bscription...Thi
-00010670: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
-00010680: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-00010690: 6e74 2c20 6067 726f 7570 5f6e 616d 6560  nt, `group_name`
-000106a0: 2c20 7768 6963 680a 7368 6f75 6c64 206d  , which.should m
-000106b0: 6174 6368 2074 6865 2076 616c 7565 206f  atch the value o
-000106c0: 6620 7468 6520 6172 6775 6d65 6e74 2075  f the argument u
-000106d0: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
-000106e0: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-000106f0: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
-00010700: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-00010710: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-00010720: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-00010730: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
-00010740: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-00010750: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-00010760: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-00010770: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
-00010780: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00010790: 6f70 6572 6174 696f 6e2e 0a0a 6060 6070  operation...```p
-000107a0: 7974 686f 6e0a 7375 6273 6372 6970 7469  ython.subscripti
-000107b0: 6f6e 5f69 6e66 6f20 3d20 636c 6965 6e74  on_info = client
-000107c0: 2e67 6574 5f73 7562 7363 7269 7074 696f  .get_subscriptio
-000107d0: 6e5f 696e 666f 280a 2020 2020 6772 6f75  n_info(.    grou
-000107e0: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-000107f0: 652c 0a29 0a60 6060 0a0a 5468 6520 7265  e,.).```..The re
-00010800: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
-00010810: 6120 6053 7562 7363 7269 7074 696f 6e49  a `SubscriptionI
-00010820: 6e66 6f60 206f 626a 6563 742e 0a0a 2323  nfo` object...##
-00010830: 2320 4c69 7374 2073 7562 7363 7269 7074  # List subscript
-00010840: 696f 6e73 0a0a 2a72 6571 7569 7265 7320  ions..*requires 
-00010850: 6c65 6164 6572 2a0a 0a54 6865 2060 6c69  leader*..The `li
-00010860: 7374 5f73 7562 7363 7269 7074 696f 6e73  st_subscriptions
-00010870: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00010880: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
-00010890: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
-000108a0: 6c0a 6578 6973 7469 6e67 2070 6572 7369  l.existing persi
-000108b0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-000108c0: 6f6e 732e 0a0a 5468 6973 206d 6574 686f  ons...This metho
-000108d0: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
-000108e0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-000108f0: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
-00010900: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-00010910: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
-00010920: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
-00010930: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
-00010940: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-00010950: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-00010960: 0a0a 6060 6070 7974 686f 6e0a 7375 6273  ..```python.subs
-00010970: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
-00010980: 6e74 2e6c 6973 745f 7375 6273 6372 6970  nt.list_subscrip
-00010990: 7469 6f6e 7328 290a 6060 600a 0a54 6865  tions().```..The
-000109a0: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
-000109b0: 6973 2061 206c 6973 7420 6f66 2060 5375  is a list of `Su
-000109c0: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
-000109d0: 6f62 6a65 6374 732e 0a0a 2323 2320 5570  objects...### Up
-000109e0: 6461 7465 2073 7562 7363 7269 7074 696f  date subscriptio
-000109f0: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
-00010a00: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-00010a10: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
-00010a20: 7074 696f 6e28 2960 2063 616e 2062 6520  ption()` can be 
-00010a30: 7573 6564 2074 6f20 7570 6461 7465 2061  used to update a
-00010a40: 0a22 7065 7273 6973 7465 6e74 2073 7562  ."persistent sub
-00010a50: 7363 7269 7074 696f 6e22 2e0a 0a54 6869  scription"...Thi
-00010a60: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-00010a70: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
-00010a80: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
-00010a90: 2077 6869 6368 2069 7320 7468 650a 6e61   which is the.na
-00010aa0: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
-00010ab0: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-00010ac0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00010ad0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-00010ae0: 6c73 6f20 7461 6b65 7320 7468 7265 6520  lso takes three 
-00010af0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-00010b00: 7473 2c20 6066 726f 6d5f 656e 6460 2c20  ts, `from_end`, 
-00010b10: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-00010b20: 602c 0a61 6e64 2060 7469 6d65 6f75 7460  `,.and `timeout`
-00010b30: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00010b40: 6066 726f 6d5f 656e 6460 2061 7267 756d  `from_end` argum
-00010b50: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
-00010b60: 746f 2073 7065 6369 6679 2074 6861 7420  to specify that 
-00010b70: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
-00010b80: 7375 6d65 7273 0a6f 6620 7468 6520 7375  sumers.of the su
-00010b90: 6273 6372 6970 7469 6f6e 2073 686f 756c  bscription shoul
-00010ba0: 6420 6f6e 6c79 2072 6563 6569 7665 2065  d only receive e
-00010bb0: 7665 6e74 7320 7468 6174 2077 6572 6520  vents that were 
-00010bc0: 7265 636f 7264 6564 2061 6674 6572 2074  recorded after t
-00010bd0: 6865 2073 7562 7363 7269 7074 696f 6e0a  he subscription.
-00010be0: 7761 7320 7570 6461 7465 642e 0a0a 416c  was updated...Al
-00010bf0: 7465 726e 6174 6976 656c 792c 2074 6865  ternatively, the
-00010c00: 206f 7074 696f 6e61 6c20 6063 6f6d 6d69   optional `commi
-00010c10: 745f 706f 7369 7469 6f6e 6020 6172 6775  t_position` argu
-00010c20: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
-00010c30: 2074 6f20 7370 6563 6966 7920 6120 636f   to specify a co
-00010c40: 6d6d 6974 0a70 6f73 6974 696f 6e20 6672  mmit.position fr
-00010c50: 6f6d 2077 6869 6368 2063 6f6d 6d69 7420  om which commit 
-00010c60: 706f 7369 7469 6f6e 2074 6865 2067 726f  position the gro
-00010c70: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
-00010c80: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-00010c90: 696f 6e20 7368 6f75 6c64 0a72 6563 6569  ion should.recei
-00010ca0: 7665 2065 7665 6e74 732e 2050 6c65 6173  ve events. Pleas
-00010cb0: 6520 6e6f 7465 2c20 7468 6520 7265 636f  e note, the reco
-00010cc0: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
-00010cd0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
-00010ce0: 6974 2070 6f73 6974 696f 6e20 6d69 6768  it position migh
-00010cf0: 740a 6265 2069 6e63 6c75 6465 6420 696e  t.be included in
-00010d00: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00010d10: 656e 7473 2072 6563 6569 7665 6420 6279  ents received by
-00010d20: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-00010d30: 6e73 756d 6572 732e 0a0a 4966 206e 6569  nsumers...If nei
-00010d40: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
-00010d50: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
-00010d60: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
-00010d70: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
-00010d80: 2063 6f6e 7375 6d65 7273 0a6f 6620 7468   consumers.of th
-00010d90: 6520 7375 6273 6372 6970 7469 6f6e 2077  e subscription w
-00010da0: 696c 6c20 706f 7465 6e74 6961 6c6c 7920  ill potentially 
-00010db0: 7265 6365 6976 6520 616c 6c20 7265 636f  receive all reco
-00010dc0: 7264 6564 2065 7665 6e74 7320 696e 2074  rded events in t
-00010dd0: 6865 2064 6174 6162 6173 652e 0a0a 506c  he database...Pl
-00010de0: 6561 7365 206e 6f74 652c 2074 6865 2066  ease note, the f
-00010df0: 696c 7465 7220 6f70 7469 6f6e 7320 616e  ilter options an
-00010e00: 6420 636f 6e73 756d 6572 2073 7472 6174  d consumer strat
-00010e10: 6567 7920 6361 6e6e 6f74 2062 6520 6164  egy cannot be ad
-00010e20: 6a75 7374 6564 2e0a 0a54 6865 206f 7074  justed...The opt
-00010e30: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00010e40: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-00010e50: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-00010e60: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
-00010e70: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-00010e80: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-00010e90: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-00010ea0: 6520 6d65 7468 6f64 2060 7570 6461 7465  e method `update
-00010eb0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00010ec0: 2064 6f65 7320 6e6f 7420 7265 7475 726e   does not return
-00010ed0: 2061 2076 616c 7565 2e0a 0a49 6e20 7468   a value...In th
-00010ee0: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
-00010ef0: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
-00010f00: 6273 6372 6970 7469 6f6e 2069 7320 7570  bscription is up
-00010f10: 6461 7465 6420 746f 2072 756e 2066 726f  dated to run fro
-00010f20: 6d20 7468 6520 656e 6420 6f66 2074 6865  m the end of the
-00010f30: 0a64 6174 6162 6173 652e 0a0a 6060 6070  .database...```p
-00010f40: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
-00010f50: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00010f60: 6372 6970 7469 6f6e 2e0a 636c 6965 6e74  cription..client
-00010f70: 2e75 7064 6174 655f 7375 6273 6372 6970  .update_subscrip
-00010f80: 7469 6f6e 2867 726f 7570 5f6e 616d 653d  tion(group_name=
-00010f90: 6772 6f75 705f 6e61 6d65 2c20 6672 6f6d  group_name, from
-00010fa0: 5f65 6e64 3d54 7275 6529 0a60 6060 0a0a  _end=True).```..
-00010fb0: 2323 2320 4465 6c65 7465 2073 7562 7363  ### Delete subsc
-00010fc0: 7269 7074 696f 6e0a 0a2a 7265 7175 6972  ription..*requir
-00010fd0: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
-00010fe0: 6064 656c 6574 655f 7375 6273 6372 6970  `delete_subscrip
-00010ff0: 7469 6f6e 2829 6020 6d65 7468 6f64 2063  tion()` method c
-00011000: 616e 2062 6520 7573 6564 2074 6f20 6465  an be used to de
-00011010: 6c65 7465 2061 2070 6572 7369 7374 656e  lete a persisten
-00011020: 740a 7375 6273 6372 6970 7469 6f6e 2e0a  t.subscription..
-00011030: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-00011040: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
-00011050: 6775 6d65 6e74 2c20 6067 726f 7570 5f6e  gument, `group_n
-00011060: 616d 6560 2c20 7768 6963 680a 7368 6f75  ame`, which.shou
-00011070: 6c64 206d 6174 6368 2074 6865 2076 616c  ld match the val
-00011080: 7565 206f 6620 6172 6775 6d65 6e74 2075  ue of argument u
-00011090: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
-000110a0: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-000110b0: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
-000110c0: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-000110d0: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-000110e0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-000110f0: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
-00011100: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-00011110: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-00011120: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-00011130: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
-00011140: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00011150: 6f70 6572 6174 696f 6e2e 0a0a 6060 6070  operation...```p
-00011160: 7974 686f 6e0a 636c 6965 6e74 2e64 656c  ython.client.del
-00011170: 6574 655f 7375 6273 6372 6970 7469 6f6e  ete_subscription
-00011180: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
-00011190: 3d67 726f 7570 5f6e 616d 652c 0a29 0a60  =group_name,.).`
-000111a0: 6060 0a0a 2323 2320 4372 6561 7465 2073  ``..### Create s
-000111b0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-000111c0: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
-000111d0: 6164 6572 2a0a 0a54 6865 2060 6372 6561  ader*..The `crea
-000111e0: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
-000111f0: 6970 7469 6f6e 2829 6020 6d65 7468 6f64  iption()` method
-00011200: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00011210: 6372 6561 7465 2061 2070 6572 7369 7374  create a persist
-00011220: 656e 740a 7375 6273 6372 6970 7469 6f6e  ent.subscription
-00011230: 2066 6f72 2061 2073 7472 6561 6d2e 0a0a   for a stream...
-00011240: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00011250: 7477 6f20 7265 7175 6972 6564 2061 7267  two required arg
-00011260: 756d 656e 7473 2c20 6067 726f 7570 5f6e  uments, `group_n
-00011270: 616d 6560 2061 6e64 2060 7374 7265 616d  ame` and `stream
-00011280: 5f6e 616d 6560 2e20 5468 650a 6067 726f  _name`. The.`gro
-00011290: 7570 5f6e 616d 6560 2061 7267 756d 656e  up_name` argumen
-000112a0: 7420 6e61 6d65 7320 7468 6520 6772 6f75  t names the grou
-000112b0: 7020 6f66 2063 6f6e 7375 6d65 7273 2074  p of consumers t
-000112c0: 6861 7420 7769 6c6c 2072 6563 6569 7665  hat will receive
-000112d0: 2065 7665 6e74 730a 6672 6f6d 2074 6869   events.from thi
-000112e0: 7320 7375 6273 6372 6970 7469 6f6e 2e20  s subscription. 
-000112f0: 5468 6520 6073 7472 6561 6d5f 6e61 6d65  The `stream_name
-00011300: 6020 6172 6775 6d65 6e74 2073 7065 6369  ` argument speci
-00011310: 6669 6573 2077 6869 6368 2073 7472 6561  fies which strea
-00011320: 6d0a 7468 6520 7375 6273 6372 6970 7469  m.the subscripti
-00011330: 6f6e 2077 696c 6c20 666f 6c6c 6f77 2e20  on will follow. 
-00011340: 5468 6520 7661 6c75 6573 206f 6620 626f  The values of bo
-00011350: 7468 2074 6865 7365 2061 7267 756d 656e  th these argumen
-00011360: 7473 2061 7265 2065 7870 6563 7465 640a  ts are expected.
-00011370: 746f 2062 6520 5079 7468 6f6e 2060 7374  to be Python `st
-00011380: 7260 206f 626a 6563 7473 2e0a 0a54 6865  r` objects...The
-00011390: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-000113a0: 6573 2066 6f75 7220 6f70 7469 6f6e 616c  es four optional
-000113b0: 2061 7267 756d 656e 7473 2c20 6073 7472   arguments, `str
-000113c0: 6561 6d5f 706f 7369 7469 6f6e 602c 2060  eam_position`, `
-000113d0: 6672 6f6d 5f65 6e64 602c 0a60 636f 6e73  from_end`,.`cons
-000113e0: 756d 6572 5f73 7472 6174 6567 7960 2c20  umer_strategy`, 
-000113f0: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
-00011400: 5468 6973 206f 7074 696f 6e61 6c20 6073  This optional `s
-00011410: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
-00011420: 6172 6775 6d65 6e74 2073 7065 6369 6669  argument specifi
-00011430: 6573 2061 2073 7472 6561 6d20 706f 7369  es a stream posi
-00011440: 7469 6f6e 2066 726f 6d0a 7768 6963 6820  tion from.which 
-00011450: 746f 2073 7562 7363 7269 6265 2e20 5468  to subscribe. Th
-00011460: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00011470: 2061 7420 7468 6973 2073 7472 6561 6d0a   at this stream.
-00011480: 706f 7369 7469 6f6e 2077 696c 6c20 6265  position will be
-00011490: 2072 6563 6569 7665 6420 7768 656e 2072   received when r
-000114a0: 6561 6469 6e67 2074 6865 2073 7562 7363  eading the subsc
-000114b0: 7269 7074 696f 6e2e 0a0a 5468 6973 206f  ription...This o
-000114c0: 7074 696f 6e61 6c20 6066 726f 6d5f 656e  ptional `from_en
-000114d0: 6460 2061 7267 756d 656e 7420 6973 2061  d` argument is a
-000114e0: 2050 7974 686f 6e20 6062 6f6f 6c60 2e0a   Python `bool`..
-000114f0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
-00011500: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
-00011510: 6775 6d65 6e74 2069 7320 6046 616c 7365  gument is `False
-00011520: 602e 2049 6620 7468 6973 2061 7267 756d  `. If this argum
-00011530: 656e 7420 6973 2073 6574 0a74 6f20 6054  ent is set.to `T
-00011540: 7275 6560 2c20 7265 6164 696e 6720 6672  rue`, reading fr
-00011550: 6f6d 2074 6865 2073 7562 7363 7269 7074  om the subscript
-00011560: 696f 6e20 7769 6c6c 2072 6563 6569 7665  ion will receive
-00011570: 206f 6e6c 7920 6576 656e 7473 0a72 6563   only events.rec
-00011580: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
-00011590: 7375 6273 6372 6970 7469 6f6e 2077 6173  subscription was
-000115a0: 2063 7265 6174 6564 2e20 5468 6174 2069   created. That i
-000115b0: 732c 2069 7420 6973 206e 6f74 2069 6e63  s, it is not inc
-000115c0: 6c75 7369 7665 0a6f 6620 7468 6520 6375  lusive.of the cu
-000115d0: 7272 656e 7420 7374 7265 616d 2070 6f73  rrent stream pos
-000115e0: 6974 696f 6e2e 0a0a 5468 6520 6f70 7469  ition...The opti
-000115f0: 6f6e 616c 2060 636f 6e73 756d 6572 5f73  onal `consumer_s
-00011600: 7472 6174 6567 7960 2061 7267 756d 656e  trategy` argumen
-00011610: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
-00011620: 7472 6020 7468 6174 2064 6566 696e 6573  tr` that defines
-00011630: 0a74 6865 2063 6f6e 7375 6d65 7220 7374  .the consumer st
-00011640: 7261 7465 6779 2066 6f72 2074 6869 7320  rategy for this 
-00011650: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00011660: 7269 7074 696f 6e2e 2054 6865 2076 616c  ription. The val
-00011670: 7565 206f 6620 7468 6973 2061 7267 756d  ue of this argum
-00011680: 656e 740a 6361 6e20 6265 2060 2744 6973  ent.can be `'Dis
-00011690: 7061 7463 6854 6f53 696e 676c 6527 602c  patchToSingle'`,
-000116a0: 2060 2752 6f75 6e64 526f 6269 6e27 602c   `'RoundRobin'`,
-000116b0: 2060 2750 696e 6e65 6427 602c 206f 7220   `'Pinned'`, or 
-000116c0: 6027 5069 6e6e 6564 4279 436f 7272 656c  `'PinnedByCorrel
-000116d0: 6174 696f 6e27 602e 2054 6865 0a64 6566  ation'`. The.def
-000116e0: 6175 6c74 2076 616c 7565 2069 7320 6027  ault value is `'
-000116f0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
-00011700: 2760 2e0a 0a54 6869 7320 6d65 7468 6f64  '`...This method
-00011710: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
-00011720: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-00011730: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
-00011740: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
-00011750: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-00011760: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-00011770: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
-00011780: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-00011790: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-000117a0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
-000117b0: 6420 646f 6573 206e 6f74 2072 6574 7572  d does not retur
-000117c0: 6e20 6120 7661 6c75 652e 2045 7665 6e74  n a value. Event
-000117d0: 7320 6361 6e20 6265 2072 6563 6569 7665  s can be receive
-000117e0: 6420 6279 2069 7465 7261 7469 6e67 0a6f  d by iterating.o
-000117f0: 7665 7220 7468 6520 7661 6c75 6520 7265  ver the value re
-00011800: 7475 726e 6564 2062 7920 6361 6c6c 696e  turned by callin
-00011810: 6720 6072 6561 645f 7374 7265 616d 5f73  g `read_stream_s
-00011820: 7562 7363 7269 7074 696f 6e28 2960 2e0a  ubscription()`..
-00011830: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-00011840: 6f77 2063 7265 6174 6573 2061 2070 6572  ow creates a per
-00011850: 7369 7374 656e 7420 7374 7265 616d 2073  sistent stream s
-00011860: 7562 7363 7269 7074 696f 6e20 6672 6f6d  ubscription from
-00011870: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
-00011880: 6520 7374 7265 616d 2e0a 0a60 6060 7079  e stream...```py
-00011890: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
-000118a0: 7065 7273 6973 7465 6e74 2073 7472 6561  persistent strea
-000118b0: 6d20 7375 6273 6372 6970 7469 6f6e 2066  m subscription f
-000118c0: 726f 6d20 7374 6172 7420 6f66 2074 6865  rom start of the
-000118d0: 2073 7472 6561 6d2e 0a67 726f 7570 5f6e   stream..group_n
-000118e0: 616d 6531 203d 2066 2267 726f 7570 2d7b  ame1 = f"group-{
-000118f0: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
-00011900: 2e63 7265 6174 655f 7374 7265 616d 5f73  .create_stream_s
-00011910: 7562 7363 7269 7074 696f 6e28 0a20 2020  ubscription(.   
-00011920: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
-00011930: 705f 6e61 6d65 312c 0a20 2020 2073 7472  p_name1,.    str
-00011940: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00011950: 6e61 6d65 322c 0a29 0a60 6060 0a0a 5468  name2,.).```..Th
-00011960: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00011970: 6372 6561 7465 7320 6120 7065 7273 6973  creates a persis
-00011980: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
-00011990: 6372 6970 7469 6f6e 2066 726f 6d20 6120  cription from a 
-000119a0: 7374 7265 616d 2070 6f73 6974 696f 6e2e  stream position.
-000119b0: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
-000119c0: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
-000119d0: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
-000119e0: 7074 696f 6e20 6672 6f6d 2061 2073 7472  ption from a str
-000119f0: 6561 6d20 706f 7369 7469 6f6e 2e0a 6772  eam position..gr
-00011a00: 6f75 705f 6e61 6d65 3220 3d20 6622 6772  oup_name2 = f"gr
-00011a10: 6f75 702d 7b75 7569 6434 2829 7d22 0a63  oup-{uuid4()}".c
-00011a20: 6c69 656e 742e 6372 6561 7465 5f73 7472  lient.create_str
-00011a30: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00011a40: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
-00011a50: 3d67 726f 7570 5f6e 616d 6532 2c0a 2020  =group_name2,.  
-00011a60: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00011a70: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
-00011a80: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
-00011a90: 320a 290a 6060 600a 0a54 6865 2065 7861  2.).```..The exa
-00011aa0: 6d70 6c65 2062 656c 6f77 2063 7265 6174  mple below creat
-00011ab0: 6573 2061 2070 6572 7369 7374 656e 7420  es a persistent 
-00011ac0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00011ad0: 696f 6e20 6672 6f6d 2074 6865 2065 6e64  ion from the end
-00011ae0: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
-00011af0: 0a60 6060 7079 7468 6f6e 0a23 2043 7265  .```python.# Cre
-00011b00: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
-00011b10: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00011b20: 7469 6f6e 2066 726f 6d20 656e 6420 6f66  tion from end of
-00011b30: 2074 6865 2073 7472 6561 6d2e 0a67 726f   the stream..gro
-00011b40: 7570 5f6e 616d 6533 203d 2066 2267 726f  up_name3 = f"gro
-00011b50: 7570 2d7b 7575 6964 3428 297d 220a 636c  up-{uuid4()}".cl
-00011b60: 6965 6e74 2e63 7265 6174 655f 7374 7265  ient.create_stre
-00011b70: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
-00011b80: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
-00011b90: 6772 6f75 705f 6e61 6d65 332c 0a20 2020  group_name3,.   
-00011ba0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00011bb0: 6561 6d5f 6e61 6d65 322c 0a20 2020 2066  eam_name2,.    f
-00011bc0: 726f 6d5f 656e 643d 5472 7565 0a29 0a60  rom_end=True.).`
-00011bd0: 6060 0a0a 2323 2320 5265 6164 2073 7472  ``..### Read str
-00011be0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00011bf0: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-00011c00: 6572 2a0a 0a54 6865 2060 7265 6164 5f73  er*..The `read_s
-00011c10: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-00011c20: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
-00011c30: 2062 6520 7573 6564 2074 6f20 7265 6164   be used to read
-00011c40: 2061 2070 6572 7369 7374 656e 740a 7374   a persistent.st
-00011c50: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00011c60: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-00011c70: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-00011c80: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-00011c90: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-00011ca0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
-00011cb0: 680a 7368 6f75 6c64 206d 6174 6368 2074  h.should match t
-00011cc0: 6865 2076 616c 7565 7320 6f66 2061 7267  he values of arg
-00011cd0: 756d 656e 7473 2075 7365 6420 7768 656e  uments used when
-00011ce0: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
-00011cf0: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
-00011d00: 7469 6f6e 2829 602e 0a0a 5468 6973 206d  tion()`...This m
-00011d10: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
-00011d20: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-00011d30: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-00011d40: 2074 6861 740a 6973 2065 7870 6563 7465   that.is expecte
-00011d50: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
-00011d60: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
-00011d70: 7365 7473 2061 2064 6561 646c 696e 650a  sets a deadline.
-00011d80: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00011d90: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00011da0: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
-00011db0: 6d65 7468 6f64 2072 6574 7572 6e73 2061  method returns a
-00011dc0: 2060 5065 7273 6973 7465 6e74 5375 6273   `PersistentSubs
-00011dd0: 6372 6970 7469 6f6e 6020 6f62 6a65 6374  cription` object
-00011de0: 2c20 7768 6963 6820 6973 2061 6e20 6974  , which is an it
-00011df0: 6572 6174 6f72 0a67 6976 696e 6720 6052  erator.giving `R
-00011e00: 6563 6f72 6465 6445 7665 6e74 6020 6f62  ecordedEvent` ob
-00011e10: 6a65 6374 732c 2074 6861 7420 616c 736f  jects, that also
-00011e20: 2068 6173 2060 6163 6b28 2960 2c20 606e   has `ack()`, `n
-00011e30: 6163 6b28 2960 2061 6e64 2060 7374 6f70  ack()` and `stop
-00011e40: 2829 600a 6d65 7468 6f64 732e 0a0a 6060  ()`.methods...``
-00011e50: 6070 7974 686f 6e0a 7375 6273 6372 6970  `python.subscrip
-00011e60: 7469 6f6e 203d 2063 6c69 656e 742e 7265  tion = client.re
-00011e70: 6164 5f73 7472 6561 6d5f 7375 6273 6372  ad_stream_subscr
-00011e80: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
-00011e90: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-00011ea0: 6531 2c0a 2020 2020 7374 7265 616d 5f6e  e1,.    stream_n
-00011eb0: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00011ec0: 2c0a 290a 6060 600a 0a54 6865 2065 7861  ,.).```..The exa
-00011ed0: 6d70 6c65 2062 656c 6f77 2069 7465 7261  mple below itera
-00011ee0: 7465 7320 6f76 6572 2074 6865 2073 7562  tes over the sub
-00011ef0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-00011f00: 2c20 616e 6420 6361 6c6c 7320 6061 636b  , and calls `ack
-00011f10: 2829 602e 0a54 6865 2066 6f72 206c 6f6f  ()`..The for loo
-00011f20: 7020 6272 6561 6b73 2077 6865 6e20 7765  p breaks when we
-00011f30: 2068 6176 6520 7265 6365 6976 6564 2074   have received t
-00011f40: 6865 206c 6173 7420 6576 656e 7420 696e  he last event in
-00011f50: 2074 6865 2073 7472 6561 6d2c 2073 6f0a   the stream, so.
-00011f60: 7468 6174 2077 6520 6361 6e20 6669 6e69  that we can fini
-00011f70: 7368 2074 6865 2065 7861 6d70 6c65 7320  sh the examples 
-00011f80: 696e 2074 6869 7320 646f 6375 6d65 6e74  in this document
-00011f90: 6174 696f 6e2e 0a0a 6060 6070 7974 686f  ation...```pytho
-00011fa0: 6e0a 6576 656e 7473 203d 205b 5d0a 666f  n.events = [].fo
-00011fb0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-00011fc0: 7269 7074 696f 6e3a 0a20 2020 2065 7665  ription:.    eve
-00011fd0: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-00011fe0: 290a 0a20 2020 2023 2041 636b 6e6f 776c  )..    # Acknowl
-00011ff0: 6564 6765 2074 6865 2072 6563 6569 7665  edge the receive
-00012000: 6420 6576 656e 742e 0a20 2020 2073 7562  d event..    sub
-00012010: 7363 7269 7074 696f 6e2e 6163 6b28 6576  scription.ack(ev
-00012020: 656e 745f 6964 3d65 7665 6e74 2e69 6429  ent_id=event.id)
-00012030: 0a0a 2020 2020 2320 5374 6f70 2077 6865  ..    # Stop whe
-00012040: 6e20 2765 7665 6e74 3131 2720 6861 7320  n 'event11' has 
-00012050: 6265 656e 2072 6563 6569 7665 642e 0a20  been received.. 
-00012060: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
-00012070: 3d20 6576 656e 7431 312e 6964 3a0a 2020  = event11.id:.  
-00012080: 2020 2020 2020 7375 6273 6372 6970 7469        subscripti
-00012090: 6f6e 2e73 746f 7028 290a 6060 600a 0a57  on.stop().```..W
-000120a0: 6520 6361 6e20 6368 6563 6b20 7765 2072  e can check we r
-000120b0: 6563 6569 7665 6420 616c 6c20 7468 6520  eceived all the 
-000120c0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-000120d0: 2061 7070 656e 6465 6420 746f 2060 7374   appended to `st
-000120e0: 7265 616d 5f6e 616d 6532 600a 696e 2074  ream_name2`.in t
-000120f0: 6865 2065 7861 6d70 6c65 7320 6162 6f76  he examples abov
-00012100: 652e 0a0a 6060 6070 7974 686f 6e0a 6173  e...```python.as
-00012110: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00012120: 203d 3d20 340a 6173 7365 7274 2065 7665   == 4.assert eve
-00012130: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
-00012140: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-00012150: 6532 0a61 7373 6572 7420 6576 656e 7473  e2.assert events
-00012160: 5b30 5d2e 6964 203d 3d20 6576 656e 7434  [0].id == event4
-00012170: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
-00012180: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
-00012190: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-000121a0: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-000121b0: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
-000121c0: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
-000121d0: 325d 2e73 7472 6561 6d5f 6e61 6d65 203d  2].stream_name =
-000121e0: 3d20 7374 7265 616d 5f6e 616d 6532 0a61  = stream_name2.a
-000121f0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00012200: 6964 203d 3d20 6576 656e 7436 2e69 640a  id == event6.id.
-00012210: 6173 7365 7274 2065 7665 6e74 735b 335d  assert events[3]
-00012220: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00012230: 7374 7265 616d 5f6e 616d 6532 0a61 7373  stream_name2.ass
-00012240: 6572 7420 6576 656e 7473 5b33 5d2e 6964  ert events[3].id
-00012250: 203d 3d20 6576 656e 7431 312e 6964 0a60   == event11.id.`
-00012260: 6060 0a0a 2323 2320 4765 7420 7374 7265  ``..### Get stre
-00012270: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
-00012280: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
-00012290: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
-000122a0: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
-000122b0: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
-000122c0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-000122d0: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
-000122e0: 696f 6e20 666f 7220 610a 7065 7273 6973  ion for a.persis
-000122f0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00012300: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
-00012310: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-00012320: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
-00012330: 6775 6d65 6e74 732c 2060 6772 6f75 705f  guments, `group_
-00012340: 6e61 6d65 6020 616e 6420 6073 7472 6561  name` and `strea
-00012350: 6d5f 6e61 6d65 602c 2077 6869 6368 0a73  m_name`, which.s
-00012360: 686f 756c 6420 6d61 7463 6820 7468 6520  hould match the 
-00012370: 7661 6c75 6573 206f 6620 6172 6775 6d65  values of argume
-00012380: 6e74 7320 7573 6564 2077 6865 6e20 6361  nts used when ca
-00012390: 6c6c 696e 6720 6063 7265 6174 655f 7374  lling `create_st
-000123a0: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-000123b0: 6e28 2960 2e0a 0a54 6869 7320 6d65 7468  n()`...This meth
-000123c0: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
-000123d0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-000123e0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
-000123f0: 6174 0a69 7320 6578 7065 6374 6564 2074  at.is expected t
-00012400: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
-00012410: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
-00012420: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
-00012430: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-00012440: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-00012450: 6174 696f 6e2e 0a0a 6060 6070 7974 686f  ation...```pytho
-00012460: 6e0a 7375 6273 6372 6970 7469 6f6e 5f69  n.subscription_i
-00012470: 6e66 6f20 3d20 636c 6965 6e74 2e67 6574  nfo = client.get
-00012480: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
-00012490: 7469 6f6e 5f69 6e66 6f28 0a20 2020 2067  tion_info(.    g
-000124a0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-000124b0: 6e61 6d65 312c 0a20 2020 2073 7472 6561  name1,.    strea
-000124c0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-000124d0: 6d65 322c 0a29 0a60 6060 0a0a 5468 6520  me2,.).```..The 
-000124e0: 7265 7475 726e 6564 2076 616c 7565 2069  returned value i
-000124f0: 7320 6120 6053 7562 7363 7269 7074 696f  s a `Subscriptio
-00012500: 6e49 6e66 6f60 206f 626a 6563 742e 0a0a  nInfo` object...
-00012510: 2323 2320 4c69 7374 2073 7472 6561 6d20  ### List stream 
-00012520: 7375 6273 6372 6970 7469 6f6e 730a 0a2a  subscriptions..*
-00012530: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
-00012540: 0a0a 5468 6520 606c 6973 745f 7374 7265  ..The `list_stre
-00012550: 616d 5f73 7562 7363 7269 7074 696f 6e73  am_subscriptions
-00012560: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00012570: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
-00012580: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
-00012590: 6c0a 7468 6520 7065 7273 6973 7465 6e74  l.the persistent
-000125a0: 2073 7562 7363 7269 7074 696f 6e73 2066   subscriptions f
-000125b0: 6f72 2061 2073 7472 6561 6d2e 0a0a 5468  or a stream...Th
-000125c0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
-000125d0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
-000125e0: 656e 742c 2060 7374 7265 616d 5f6e 616d  ent, `stream_nam
-000125f0: 6560 2e0a 0a54 6869 7320 6d65 7468 6f64  e`...This method
-00012600: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
-00012610: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-00012620: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
-00012630: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
-00012640: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-00012650: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-00012660: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
-00012670: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-00012680: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-00012690: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
-000126a0: 7375 6273 6372 6970 7469 6f6e 7320 3d20  subscriptions = 
-000126b0: 636c 6965 6e74 2e6c 6973 745f 7374 7265  client.list_stre
-000126c0: 616d 5f73 7562 7363 7269 7074 696f 6e73  am_subscriptions
-000126d0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-000126e0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
-000126f0: 290a 6060 600a 0a54 6865 2072 6574 7572  ).```..The retur
-00012700: 6e65 6420 7661 6c75 6520 6973 2061 206c  ned value is a l
-00012710: 6973 7420 6f66 2060 5375 6273 6372 6970  ist of `Subscrip
-00012720: 7469 6f6e 496e 666f 6020 6f62 6a65 6374  tionInfo` object
-00012730: 732e 0a0a 2323 2320 5570 6461 7465 2073  s...### Update s
-00012740: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00012750: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
-00012760: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
-00012770: 6420 6075 7064 6174 655f 7374 7265 616d  d `update_stream
-00012780: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00012790: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-000127a0: 7570 6461 7465 2061 0a70 6572 7369 7374  update a.persist
-000127b0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-000127c0: 2066 6f72 2061 2073 7472 6561 6d2e 0a0a   for a stream...
-000127d0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-000127e0: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
-000127f0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
-00012800: 6e74 2c20 7768 6963 6820 6973 2074 6865  nt, which is the
-00012810: 0a6e 616d 6520 6f66 2061 2022 6772 6f75  .name of a "grou
-00012820: 7022 206f 6620 636f 6e73 756d 6572 7320  p" of consumers 
-00012830: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-00012840: 696f 6e2c 2061 6e64 2061 2072 6571 7569  ion, and a requi
-00012850: 7265 640a 6073 7472 6561 6d5f 6e61 6d65  red.`stream_name
-00012860: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-00012870: 6820 6973 2074 6865 206e 616d 6520 6f66  h is the name of
-00012880: 2061 2073 7472 6561 6d2e 0a0a 5468 6973   a stream...This
-00012890: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-000128a0: 6573 2074 6872 6565 206f 7074 696f 6e61  es three optiona
-000128b0: 6c20 6172 6775 6d65 6e74 732c 2060 6672  l arguments, `fr
-000128c0: 6f6d 5f65 6e64 602c 2060 7374 7265 616d  om_end`, `stream
-000128d0: 5f70 6f73 6974 696f 6e60 2c0a 616e 6420  _position`,.and 
-000128e0: 6074 696d 656f 7574 602e 0a0a 5468 6520  `timeout`...The 
-000128f0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-00012900: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
-00012910: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
-00012920: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
-00012930: 7570 206f 6620 636f 6e73 756d 6572 730a  up of consumers.
-00012940: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-00012950: 696f 6e20 7368 6f75 6c64 206f 6e6c 7920  ion should only 
-00012960: 7265 6365 6976 6520 6576 656e 7473 2074  receive events t
-00012970: 6861 7420 7765 7265 2072 6563 6f72 6465  hat were recorde
-00012980: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
-00012990: 6372 6970 7469 6f6e 0a77 6173 2075 7064  cription.was upd
-000129a0: 6174 6564 2e0a 0a41 6c74 6572 6e61 7469  ated...Alternati
-000129b0: 7665 6c79 2c20 7468 6520 6f70 7469 6f6e  vely, the option
-000129c0: 616c 2060 7374 7265 616d 5f70 6f73 6974  al `stream_posit
-000129d0: 696f 6e60 2061 7267 756d 656e 7420 6361  ion` argument ca
-000129e0: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
-000129f0: 6369 6679 2061 2073 7472 6561 6d0a 706f  cify a stream.po
-00012a00: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
-00012a10: 6820 636f 6d6d 6974 2070 6f73 6974 696f  h commit positio
-00012a20: 6e20 7468 6520 6772 6f75 7020 6f66 2063  n the group of c
-00012a30: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
-00012a40: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
-00012a50: 756c 640a 7265 6365 6976 6520 6576 656e  uld.receive even
-00012a60: 7473 2e20 506c 6561 7365 206e 6f74 652c  ts. Please note,
-00012a70: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00012a80: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
-00012a90: 6669 6564 2073 7472 6561 6d20 706f 7369  fied stream posi
-00012aa0: 7469 6f6e 206d 6967 6874 0a62 6520 696e  tion might.be in
-00012ab0: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
-00012ac0: 636f 7264 6564 2065 7665 6e74 7320 7265  corded events re
-00012ad0: 6365 6976 6564 2062 7920 7468 6520 6772  ceived by the gr
-00012ae0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00012af0: 2e0a 0a49 6620 6e65 6974 6865 7220 6066  ...If neither `f
-00012b00: 726f 6d5f 656e 6460 206f 7220 6063 6f6d  rom_end` or `com
-00012b10: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-00012b20: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
-00012b30: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-00012b40: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
-00012b50: 7269 7074 696f 6e20 7769 6c6c 2070 6f74  ription will pot
-00012b60: 656e 7469 616c 6c79 2072 6563 6569 7665  entially receive
-00012b70: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
-00012b80: 656e 7473 2069 6e20 7468 6520 7374 7265  ents in the stre
-00012b90: 616d 2e0a 0a50 6c65 6173 6520 6e6f 7465  am...Please note
-00012ba0: 2c20 7468 6520 636f 6e73 756d 6572 2073  , the consumer s
-00012bb0: 7472 6174 6567 7920 6361 6e6e 6f74 2062  trategy cannot b
-00012bc0: 6520 6164 6a75 7374 6564 2e0a 0a54 6865  e adjusted...The
-00012bd0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00012be0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
-00012bf0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00012c00: 2077 6869 6368 2073 6574 7320 610a 6465   which sets a.de
-00012c10: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
-00012c20: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-00012c30: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-00012c40: 0a0a 5468 6520 6d65 7468 6f64 2060 7570  ..The method `up
-00012c50: 6461 7465 5f73 7472 6561 6d5f 7375 6273  date_stream_subs
-00012c60: 6372 6970 7469 6f6e 2829 6020 646f 6573  cription()` does
-00012c70: 206e 6f74 2072 6574 7572 6e20 6120 7661   not return a va
-00012c80: 6c75 652e 0a0a 496e 2074 6865 2065 7861  lue...In the exa
-00012c90: 6d70 6c65 2062 656c 6f77 2c20 6120 7065  mple below, a pe
-00012ca0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00012cb0: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
-00012cc0: 616d 2069 7320 7570 6461 7465 6420 746f  am is updated to
-00012cd0: 2072 756e 2066 726f 6d20 7468 650a 656e   run from the.en
-00012ce0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-00012cf0: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
-00012d00: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
-00012d10: 7420 7375 6273 6372 6970 7469 6f6e 2e0a  t subscription..
-00012d20: 636c 6965 6e74 2e75 7064 6174 655f 7374  client.update_st
-00012d30: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00012d40: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
-00012d50: 653d 6772 6f75 705f 6e61 6d65 312c 0a20  e=group_name1,. 
-00012d60: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00012d70: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
-00012d80: 2066 726f 6d5f 656e 643d 5472 7565 2c0a   from_end=True,.
-00012d90: 290a 6060 600a 0a23 2323 2044 656c 6574  ).```..### Delet
-00012da0: 6520 7374 7265 616d 2073 7562 7363 7269  e stream subscri
-00012db0: 7074 696f 6e0a 0a2a 7265 7175 6972 6573  ption..*requires
-00012dc0: 206c 6561 6465 722a 0a0a 5468 6520 6064   leader*..The `d
-00012dd0: 656c 6574 655f 7374 7265 616d 5f73 7562  elete_stream_sub
-00012de0: 7363 7269 7074 696f 6e28 2960 206d 6574  scription()` met
-00012df0: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
-00012e00: 746f 2064 656c 6574 6520 6120 7065 7273  to delete a pers
-00012e10: 6973 7465 6e74 0a73 7562 7363 7269 7074  istent.subscript
-00012e20: 696f 6e20 666f 7220 6120 7374 7265 616d  ion for a stream
-00012e30: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
-00012e40: 6173 2074 776f 2072 6571 7569 7265 6420  as two required 
-00012e50: 6172 6775 6d65 6e74 732c 2060 6772 6f75  arguments, `grou
-00012e60: 705f 6e61 6d65 6020 616e 6420 6073 7472  p_name` and `str
-00012e70: 6561 6d5f 6e61 6d65 602c 2077 6869 6368  eam_name`, which
-00012e80: 0a73 686f 756c 6420 6d61 7463 6820 7468  .should match th
-00012e90: 6520 7661 6c75 6573 206f 6620 6172 6775  e values of argu
-00012ea0: 6d65 6e74 7320 7573 6564 2077 6865 6e20  ments used when 
-00012eb0: 6361 6c6c 696e 6720 6063 7265 6174 655f  calling `create_
-00012ec0: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
-00012ed0: 696f 6e28 2960 2e0a 0a54 6869 7320 6d65  ion()`...This me
-00012ee0: 7468 6f64 2061 6c73 6f20 7461 6b65 7320  thod also takes 
-00012ef0: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
-00012f00: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
-00012f10: 7468 6174 0a69 7320 6578 7065 6374 6564  that.is expected
-00012f20: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-00012f30: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-00012f40: 6574 7320 6120 6465 6164 6c69 6e65 0a66  ets a deadline.f
-00012f50: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00012f60: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00012f70: 6572 6174 696f 6e2e 0a0a 6060 6070 7974  eration...```pyt
-00012f80: 686f 6e0a 636c 6965 6e74 2e64 656c 6574  hon.client.delet
-00012f90: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-00012fa0: 7074 696f 6e28 0a20 2020 2067 726f 7570  ption(.    group
-00012fb0: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-00012fc0: 312c 0a20 2020 2073 7472 6561 6d5f 6e61  1,.    stream_na
-00012fd0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-00012fe0: 0a29 0a60 6060 0a0a 2323 2320 5065 7273  .).```..### Pers
-00012ff0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00013000: 696f 6e20 636f 6e73 756d 6572 0a0a 5468  ion consumer..Th
-00013010: 6520 7265 6164 696e 6720 6f66 2061 2070  e reading of a p
-00013020: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00013030: 6970 7469 6f6e 2063 616e 2062 6520 656e  iption can be en
-00013040: 6361 7073 756c 6174 6564 2069 6e20 6120  capsulated in a 
-00013050: 2263 6f6e 7375 6d65 7222 2074 6861 7420  "consumer" that 
-00013060: 6361 6c6c 730a 6120 2270 6f6c 6963 7922  calls.a "policy"
-00013070: 2066 756e 6374 696f 6e20 7768 656e 2061   function when a
-00013080: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00013090: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
-000130a0: 7468 656e 2061 7574 6f6d 6174 6963 616c  then automatical
-000130b0: 6c79 2063 616c 6c73 0a60 6163 6b28 2960  ly calls.`ack()`
-000130c0: 2069 6620 7468 6520 706f 6c69 6379 2066   if the policy f
-000130d0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-000130e0: 6e6f 726d 616c 6c79 2c20 616e 6420 606e  normally, and `n
-000130f0: 6163 6b28 2960 2069 6620 6974 2072 6169  ack()` if it rai
-00013100: 7365 7320 616e 2065 7863 6570 7469 6f6e  ses an exception
-00013110: 2c0a 7065 7268 6170 7320 7265 7472 7969  ,.perhaps retryi
-00013120: 6e67 2074 6865 2065 7665 6e74 2066 6f72  ng the event for
-00013130: 2061 2063 6572 7461 696e 206e 756d 6265   a certain numbe
-00013140: 7220 6f66 2074 696d 6573 2c20 616e 6420  r of times, and 
-00013150: 7468 656e 2070 6172 6b69 6e67 2074 6865  then parking the
-00013160: 2065 7665 6e74 2e0a 0a54 6865 2073 696d   event...The sim
-00013170: 706c 6520 6578 616d 706c 6520 6265 6c6f  ple example belo
-00013180: 7720 7368 6f77 7320 686f 7720 7468 6973  w shows how this
-00013190: 206d 6967 6874 2062 6520 646f 6e65 2e20   might be done. 
-000131a0: 5765 2063 616e 2073 6565 2074 6861 7420  We can see that 
-000131b0: 2765 7665 6e74 3131 2720 6973 0a61 636b  'event11' is.ack
-000131c0: 6e6f 776c 6564 6765 6420 6265 666f 7265  nowledged before
-000131d0: 2027 6576 656e 7435 2720 6973 2066 696e   'event5' is fin
-000131e0: 616c 6c79 2070 6172 6b65 642e 0a0a 0a60  ally parked....`
-000131f0: 6060 7079 7468 6f6e 0a61 636b 6564 5f65  ``python.acked_e
-00013200: 7665 6e74 7320 3d20 7b7d 0a6e 6163 6b65  vents = {}.nacke
-00013210: 645f 6576 656e 7473 203d 207b 7d0a 0a0a  d_events = {}...
-00013220: 636c 6173 7320 4578 616d 706c 6543 6f6e  class ExampleCon
-00013230: 7375 6d65 723a 0a20 2020 2064 6566 205f  sumer:.    def _
-00013240: 5f69 6e69 745f 5f28 7365 6c66 2c20 7375  _init__(self, su
-00013250: 6273 6372 6970 7469 6f6e 2c20 6d61 785f  bscription, max_
-00013260: 7265 7472 6965 732c 2066 696e 616c 5f61  retries, final_a
-00013270: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
-00013280: 7365 6c66 2e73 7562 7363 7269 7074 696f  self.subscriptio
-00013290: 6e20 3d20 7375 6273 6372 6970 7469 6f6e  n = subscription
-000132a0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-000132b0: 785f 7265 7472 6965 7320 3d20 6d61 785f  x_retries = max_
-000132c0: 7265 7472 6965 730a 2020 2020 2020 2020  retries.        
-000132d0: 7365 6c66 2e66 696e 616c 5f61 6374 696f  self.final_actio
-000132e0: 6e20 3d20 6669 6e61 6c5f 6163 7469 6f6e  n = final_action
-000132f0: 0a20 2020 2020 2020 2073 656c 662e 6572  .        self.er
-00013300: 726f 7220 3d20 4e6f 6e65 0a0a 2020 2020  ror = None..    
-00013310: 6465 6620 7275 6e28 7365 6c66 293a 0a20  def run(self):. 
-00013320: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00013330: 2020 2020 2020 2020 666f 7220 6576 656e          for even
-00013340: 7420 696e 2073 656c 662e 7375 6273 6372  t in self.subscr
-00013350: 6970 7469 6f6e 3a0a 2020 2020 2020 2020  iption:.        
-00013360: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00013370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013380: 2073 656c 662e 706f 6c69 6379 2865 7665   self.policy(eve
-00013390: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-000133a0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000133b0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-000133c0: 2020 2020 2020 2020 2020 6966 2065 7665            if eve
-000133d0: 6e74 2e72 6574 7279 5f63 6f75 6e74 203c  nt.retry_count <
-000133e0: 2073 656c 662e 6d61 785f 7265 7472 6965   self.max_retrie
-000133f0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00013400: 2020 2020 2020 2020 2020 2061 6374 696f             actio
-00013410: 6e20 3d20 2272 6574 7279 220a 2020 2020  n = "retry".    
-00013420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013430: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00013440: 2020 2020 2020 2020 2020 2020 2020 6163                ac
-00013450: 7469 6f6e 203d 2073 656c 662e 6669 6e61  tion = self.fina
-00013460: 6c5f 6163 7469 6f6e 0a20 2020 2020 2020  l_action.       
-00013470: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00013480: 662e 7375 6273 6372 6970 7469 6f6e 2e6e  f.subscription.n
-00013490: 6163 6b28 6576 656e 742e 6964 2c20 6163  ack(event.id, ac
-000134a0: 7469 6f6e 3d61 6374 696f 6e29 0a20 2020  tion=action).   
-000134b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134c0: 2073 656c 662e 6166 7465 725f 6e61 636b   self.after_nack
-000134d0: 2865 7665 6e74 2c20 6163 7469 6f6e 290a  (event, action).
-000134e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00013500: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00013510: 7562 7363 7269 7074 696f 6e2e 6163 6b28  ubscription.ack(
-00013520: 6576 656e 742e 6964 290a 2020 2020 2020  event.id).      
-00013530: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00013540: 6c66 2e61 6674 6572 5f61 636b 2865 7665  lf.after_ack(eve
-00013550: 6e74 290a 2020 2020 2020 2020 6578 6365  nt).        exce
-00013560: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
-00013570: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00013580: 7562 7363 7269 7074 696f 6e2e 7374 6f70  ubscription.stop
-00013590: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-000135a0: 6169 7365 0a0a 2020 2020 6465 6620 7374  aise..    def st
-000135b0: 6f70 2873 656c 6629 3a0a 2020 2020 2020  op(self):.      
-000135c0: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
-000135d0: 696f 6e2e 7374 6f70 2829 0a0a 2020 2020  ion.stop()..    
-000135e0: 6465 6620 706f 6c69 6379 2873 656c 662c  def policy(self,
-000135f0: 2065 7665 6e74 293a 0a20 2020 2020 2020   event):.       
-00013600: 2023 2052 6169 7365 2061 6e20 6578 6365   # Raise an exce
-00013610: 7074 696f 6e20 7768 656e 2077 6520 7365  ption when we se
-00013620: 6520 2265 7665 6e74 3522 2e0a 2020 2020  e "event5"..    
-00013630: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-00013640: 3d3d 2065 7665 6e74 352e 6964 3a0a 2020  == event5.id:.  
-00013650: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00013660: 4578 6365 7074 696f 6e28 290a 0a20 2020  Exception()..   
-00013670: 2064 6566 2061 6674 6572 5f61 636b 2873   def after_ack(s
-00013680: 656c 662c 2065 7665 6e74 293a 0a20 2020  elf, event):.   
-00013690: 2020 2020 2023 2054 7261 636b 2072 6574       # Track ret
-000136a0: 7279 2063 6f75 6e74 206f 6620 6163 6b65  ry count of acke
-000136b0: 6420 6576 656e 7473 2e0a 2020 2020 2020  d events..      
-000136c0: 2020 6163 6b65 645f 6576 656e 7473 5b65    acked_events[e
-000136d0: 7665 6e74 2e69 645d 203d 2065 7665 6e74  vent.id] = event
-000136e0: 2e72 6574 7279 5f63 6f75 6e74 0a0a 2020  .retry_count..  
-000136f0: 2020 6465 6620 6166 7465 725f 6e61 636b    def after_nack
-00013700: 2873 656c 662c 2065 7665 6e74 2c20 6163  (self, event, ac
-00013710: 7469 6f6e 293a 0a20 2020 2020 2020 2023  tion):.        #
-00013720: 2054 7261 636b 2072 6574 7279 2063 6f75   Track retry cou
-00013730: 6e74 206f 6620 6e61 636b 6564 2065 7665  nt of nacked eve
-00013740: 6e74 732e 0a20 2020 2020 2020 206e 6163  nts..        nac
-00013750: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
-00013760: 2e69 645d 203d 2065 7665 6e74 2e72 6574  .id] = event.ret
-00013770: 7279 5f63 6f75 6e74 0a0a 2020 2020 2020  ry_count..      
-00013780: 2020 6966 2061 6374 696f 6e20 3d3d 2073    if action == s
-00013790: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
-000137a0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000137b0: 5374 6f70 2074 6865 2063 6f6e 7375 6d65  Stop the consume
-000137c0: 722c 2073 6f20 7765 2063 616e 2063 6f6e  r, so we can con
-000137d0: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
-000137e0: 7861 6d70 6c65 732e 0a20 2020 2020 2020  xamples..       
-000137f0: 2020 2020 2073 656c 662e 7374 6f70 2829       self.stop()
-00013800: 0a0a 0a23 2043 7265 6174 6520 7375 6273  ...# Create subs
-00013810: 6372 6970 7469 6f6e 2e0a 6772 6f75 705f  cription..group_
-00013820: 6e61 6d65 203d 2066 2267 726f 7570 2d7b  name = f"group-{
-00013830: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
-00013840: 2e63 7265 6174 655f 7375 6273 6372 6970  .create_subscrip
-00013850: 7469 6f6e 2867 726f 7570 5f6e 616d 652c  tion(group_name,
-00013860: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
-00013870: 3d63 6f6d 6d69 745f 706f 7369 7469 6f6e  =commit_position
-00013880: 3129 0a0a 2320 5265 6164 2073 7562 7363  1)..# Read subsc
-00013890: 7269 7074 696f 6e2e 0a73 7562 7363 7269  ription..subscri
-000138a0: 7074 696f 6e20 3d20 636c 6965 6e74 2e72  ption = client.r
-000138b0: 6561 645f 7375 6273 6372 6970 7469 6f6e  ead_subscription
-000138c0: 2867 726f 7570 5f6e 616d 6529 0a0a 2320  (group_name)..# 
-000138d0: 436f 6e73 7472 7563 7420 636f 6e73 756d  Construct consum
-000138e0: 6572 2e0a 636f 6e73 756d 6572 203d 2045  er..consumer = E
-000138f0: 7861 6d70 6c65 436f 6e73 756d 6572 280a  xampleConsumer(.
-00013900: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
-00013910: 3d73 7562 7363 7269 7074 696f 6e2c 0a20  =subscription,. 
-00013920: 2020 206d 6178 5f72 6574 7269 6573 3d35     max_retries=5
-00013930: 2c0a 2020 2020 6669 6e61 6c5f 6163 7469  ,.    final_acti
-00013940: 6f6e 3d22 7061 726b 222c 0a29 0a0a 2320  on="park",.)..# 
-00013950: 5275 6e20 636f 6e73 756d 6572 2e0a 636f  Run consumer..co
-00013960: 6e73 756d 6572 2e72 756e 2829 0a0a 2320  nsumer.run()..# 
-00013970: 4368 6563 6b20 2765 7665 6e74 3131 2720  Check 'event11' 
-00013980: 7761 7320 6163 6b65 6420 616e 6420 6e65  was acked and ne
-00013990: 7665 7220 7265 7472 6965 642e 0a61 7373  ver retried..ass
-000139a0: 6572 7420 6163 6b65 645f 6576 656e 7473  ert acked_events
-000139b0: 5b65 7665 6e74 3131 2e69 645d 203d 3d20  [event11.id] == 
-000139c0: 300a 6173 7365 7274 2065 7665 6e74 3131  0.assert event11
-000139d0: 2e69 6420 6e6f 7420 696e 206e 6163 6b65  .id not in nacke
-000139e0: 645f 6576 656e 7473 0a0a 2320 4368 6563  d_events..# Chec
-000139f0: 6b20 2765 7665 6e74 3527 2077 6173 2072  k 'event5' was r
-00013a00: 6574 7269 6564 2066 6976 6520 7469 6d65  etried five time
-00013a10: 7320 616e 6420 6e65 7665 7220 6163 6b65  s and never acke
-00013a20: 642e 0a61 7373 6572 7420 6e61 636b 6564  d..assert nacked
-00013a30: 5f65 7665 6e74 735b 6576 656e 7435 2e69  _events[event5.i
-00013a40: 645d 203d 3d20 350a 6173 7365 7274 2065  d] == 5.assert e
-00013a50: 7665 6e74 352e 6964 206e 6f74 2069 6e20  vent5.id not in 
-00013a60: 6163 6b65 645f 6576 656e 7473 0a60 6060  acked_events.```
-00013a70: 0a0a 2323 2043 6f6e 6e65 6374 696f 6e0a  ..## Connection.
-00013a80: 0a23 2323 2052 6563 6f6e 6e65 6374 0a0a  .### Reconnect..
-00013a90: 5468 6520 6072 6563 6f6e 6e65 6374 2829  The `reconnect()
-00013aa0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-00013ab0: 7573 6564 2074 6f20 6d61 6e75 616c 6c79  used to manually
-00013ac0: 2072 6563 6f6e 6e65 6374 2074 6865 2063   reconnect the c
-00013ad0: 6c69 656e 7420 746f 2061 0a73 7569 7461  lient to a.suita
-00013ae0: 626c 6520 4576 656e 7453 746f 7265 4442  ble EventStoreDB
-00013af0: 206e 6f64 652e 2054 6869 7320 6d65 7468   node. This meth
-00013b00: 6f64 2075 7365 7320 7468 6520 7361 6d65  od uses the same
-00013b10: 2072 6f75 7469 6e65 2066 6f72 2072 6561   routine for rea
-00013b20: 6469 6e67 2074 6865 0a63 6c75 7374 6572  ding the.cluster
-00013b30: 206e 6f64 6520 7374 6174 6573 2061 6e64   node states and
-00013b40: 2074 6865 6e20 636f 6e6e 6563 7469 6e67   then connecting
-00013b50: 2074 6f20 6120 7375 6974 6162 6c65 206e   to a suitable n
-00013b60: 6f64 6520 6163 636f 7264 696e 6720 746f  ode according to
-00013b70: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
-00013b80: 6465 2070 7265 6665 7265 6e63 6520 7468  de preference th
-00013b90: 6174 2069 7320 7370 6563 6966 6965 6420  at is specified 
-00013ba0: 696e 2074 6865 2063 6f6e 6e65 6374 696f  in the connectio
-00013bb0: 6e20 7374 7269 6e67 2055 5249 2077 6865  n string URI whe
-00013bc0: 6e0a 7468 6520 636c 6965 6e74 2069 7320  n.the client is 
-00013bd0: 636f 6e73 7472 7563 7465 642e 2054 6869  constructed. Thi
-00013be0: 7320 6d65 7468 6f64 2069 7320 7468 7265  s method is thre
-00013bf0: 6164 2d73 6166 652c 2061 6e64 2069 7420  ad-safe, and it 
-00013c00: 6973 2022 636f 6e73 6572 7661 7469 7665  is "conservative
-00013c10: 220a 696e 2074 6861 742c 2077 6865 6e20  ".in that, when 
-00013c20: 6974 2069 7320 6361 6c6c 6564 2062 7920  it is called by 
-00013c30: 7365 7665 7261 6c20 7468 7265 6164 7320  several threads 
-00013c40: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
-00013c50: 2c20 6f6e 6c79 206f 6e65 0a72 6563 6f6e  , only one.recon
-00013c60: 6e65 6374 696f 6e20 7769 6c6c 206f 6363  nection will occ
-00013c70: 7572 2e20 436f 6e63 7572 7265 6e74 2061  ur. Concurrent a
-00013c80: 7474 656d 7074 7320 746f 2072 6563 6f6e  ttempts to recon
-00013c90: 6e65 6374 2077 696c 6c20 626c 6f63 6b20  nect will block 
-00013ca0: 756e 7469 6c0a 7468 6520 636c 6965 6e74  until.the client
-00013cb0: 2068 6173 2072 6563 6f6e 6e65 6374 6564   has reconnected
-00013cc0: 2073 7563 6365 7373 6675 6c6c 792c 2061   successfully, a
-00013cd0: 6e64 2074 6865 6e20 7468 6579 2077 696c  nd then they wil
-00013ce0: 6c20 616c 6c20 7265 7475 726e 206e 6f72  l all return nor
-00013cf0: 6d61 6c6c 792e 0a0a 6060 6070 7974 686f  mally...```pytho
-00013d00: 6e0a 636c 6965 6e74 2e72 6563 6f6e 6e65  n.client.reconne
-00013d10: 6374 2829 0a60 6060 0a0a 416e 2065 7861  ct().```..An exa
-00013d20: 6d70 6c65 206f 6620 7768 656e 2069 7420  mple of when it 
-00013d30: 6d69 6768 7420 6265 2064 6573 6972 6162  might be desirab
-00013d40: 6c65 2074 6f20 7265 636f 6e6e 6563 7420  le to reconnect 
-00013d50: 6d61 6e75 616c 6c79 2069 7320 7768 656e  manually is when
-00013d60: 2028 666f 7220 7065 7266 6f72 6d61 6e63   (for performanc
-00013d70: 650a 7265 6173 6f6e 7329 2074 6865 2063  e.reasons) the c
-00013d80: 6c69 656e 7427 7320 6e6f 6465 2070 7265  lient's node pre
-00013d90: 6665 7265 6e63 6520 6973 2074 6f20 6265  ference is to be
-00013da0: 2063 6f6e 6e65 6374 6564 2074 6f20 6120   connected to a 
-00013db0: 666f 6c6c 6f77 6572 206e 6f64 6520 696e  follower node in
-00013dc0: 2074 6865 0a63 6c75 7374 6572 2c20 616e   the.cluster, an
-00013dd0: 642c 2061 6674 6572 2061 2063 6c75 7374  d, after a clust
-00013de0: 6572 206c 6561 6465 7220 656c 6563 7469  er leader electi
-00013df0: 6f6e 2c20 7468 6520 666f 6c6c 6f77 6572  on, the follower
-00013e00: 2062 6563 6f6d 6573 2074 6865 206c 6561   becomes the lea
-00013e10: 6465 722e 0a52 6563 6f6e 6e65 6374 696e  der..Reconnectin
-00013e20: 6720 746f 2061 2066 6f6c 6c6f 7765 7220  g to a follower 
-00013e30: 6e6f 6465 2069 6e20 7468 6973 2063 6173  node in this cas
-00013e40: 6520 6973 2063 7572 7265 6e74 6c79 2062  e is currently b
-00013e50: 6579 6f6e 6420 7468 6520 6361 7061 6269  eyond the capabi
-00013e60: 6c69 7469 6573 206f 660a 7468 6973 2063  lities of.this c
-00013e70: 6c69 656e 742c 2062 7574 2074 6869 7320  lient, but this 
-00013e80: 6265 6861 7669 6f72 206d 6967 6874 2062  behavior might b
-00013e90: 6520 696d 706c 656d 656e 7465 6420 696e  e implemented in
-00013ea0: 2061 2066 7574 7572 6520 7265 6c65 6173   a future releas
-00013eb0: 652e 0a0a 506c 6561 7365 206e 6f74 652c  e...Please note,
-00013ec0: 206e 6561 726c 7920 616c 6c20 7468 6520   nearly all the 
-00013ed0: 636c 6965 6e74 206d 6574 686f 6473 2061  client methods a
-00013ee0: 7265 2064 6563 6f72 6174 6564 2077 6974  re decorated wit
-00013ef0: 6820 6040 6175 746f 7265 636f 6e6e 6563  h `@autoreconnec
-00013f00: 7460 2028 7768 6963 680a 6361 6c6c 7320  t` (which.calls 
-00013f10: 7468 6520 6072 6563 6f6e 6e65 6374 2829  the `reconnect()
-00013f20: 6020 6d65 7468 6f64 2077 6865 6e20 7468  ` method when th
-00013f30: 6520 636c 6965 6e74 2064 6574 6563 7473  e client detects
-00013f40: 2074 6861 7420 7265 636f 6e6e 6563 7469   that reconnecti
-00013f50: 6e67 2069 7320 7265 7175 6972 6564 290a  ng is required).
-00013f60: 616e 6420 6120 6040 7265 7472 7960 2064  and a `@retry` d
-00013f70: 6563 6f72 6174 6f72 2074 6861 7420 6d6f  ecorator that mo
-00013f80: 7265 2067 656e 6572 616c 6c79 2077 696c  re generally wil
-00013f90: 6c20 7265 7472 7920 6f70 6572 6174 696f  l retry operatio
-00013fa0: 6e73 2074 6861 7420 6661 696c 2064 7565  ns that fail due
-00013fb0: 2074 6f0a 636f 6e6e 6563 7469 6f6e 2069   to.connection i
-00013fc0: 7373 7565 732e 0a0a 5468 6520 6040 6175  ssues...The `@au
-00013fd0: 746f 7265 636f 6e6e 6563 7460 2064 6563  toreconnect` dec
-00013fe0: 6f72 6174 6f72 2077 696c 6c20 7265 636f  orator will reco
-00013ff0: 6e6e 6563 7420 746f 2061 2073 7569 7461  nnect to a suita
-00014000: 626c 6520 6e6f 6465 2069 6e20 7468 6520  ble node in the 
-00014010: 636c 7573 7465 7220 7768 656e 0a74 6865  cluster when.the
-00014020: 2073 6572 7665 7220 746f 2077 6869 6368   server to which
-00014030: 2074 6865 2063 6c69 656e 7420 6861 7320   the client has 
-00014040: 6265 656e 2063 6f6e 6e65 6374 6564 2068  been connected h
-00014050: 6173 2062 6563 6f6d 6520 756e 6176 6169  as become unavai
-00014060: 6c61 626c 652c 206f 7220 7768 656e 2074  lable, or when t
-00014070: 6865 0a63 6c69 656e 7427 7320 6752 5043  he.client's gRPC
-00014080: 2063 6861 6e6e 656c 2068 6170 7065 6e73   channel happens
-00014090: 2074 6f20 6861 7665 2062 6565 6e20 636c   to have been cl
-000140a0: 6f73 6564 2e20 5468 6520 636c 6965 6e74  osed. The client
-000140b0: 2077 696c 6c20 616c 736f 2072 6563 6f6e   will also recon
-000140c0: 6e65 6374 2077 6865 6e0a 6120 6d65 7468  nect when.a meth
-000140d0: 6f64 2069 7320 6361 6c6c 6564 2074 6861  od is called tha
-000140e0: 7420 7265 7175 6972 6573 2061 206c 6561  t requires a lea
-000140f0: 6465 722c 2061 6e64 2074 6865 2063 6c69  der, and the cli
-00014100: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
-00014110: 7265 6e63 6520 6973 2074 6f20 6265 0a63  rence is to be.c
-00014120: 6f6e 6e65 6374 6564 2074 6f20 6120 6c65  onnected to a le
-00014130: 6164 6572 2c20 6275 7420 7468 6520 6e6f  ader, but the no
-00014140: 6465 2074 6861 7420 7468 6520 636c 6965  de that the clie
-00014150: 6e74 2068 6173 2062 6565 6e20 636f 6e6e  nt has been conn
-00014160: 6563 7465 6420 746f 2073 746f 7073 2062  ected to stops b
-00014170: 6569 6e67 0a74 6865 206c 6561 6465 722e  eing.the leader.
-00014180: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-00014190: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
-000141a0: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
-000141b0: 6375 7272 656e 7420 6c65 6164 6572 2e20  current leader. 
-000141c0: 4166 7465 720a 7265 636f 6e6e 6563 7469  After.reconnecti
-000141d0: 6e67 2c20 7468 6520 6661 696c 6564 206f  ng, the failed o
-000141e0: 7065 7261 7469 6f6e 2077 696c 6c20 6265  peration will be
-000141f0: 2072 6574 7269 6564 2e0a 0a54 6865 2060   retried...The `
-00014200: 4072 6574 7279 6020 6465 636f 7261 746f  @retry` decorato
-00014210: 7220 7265 7472 6965 7320 6f70 6572 6174  r retries operat
-00014220: 696f 6e73 2074 6861 7420 6861 7665 2066  ions that have f
-00014230: 6169 6c65 6420 6475 6520 746f 206d 6f72  ailed due to mor
-00014240: 6520 6765 6e65 7261 6c0a 636f 6e6e 6563  e general.connec
-00014250: 7469 6f6e 2069 7373 7565 732c 2073 7563  tion issues, suc
-00014260: 6820 6173 2061 2064 6561 646c 696e 6520  h as a deadline 
-00014270: 6265 696e 6720 7265 6163 6865 6420 2873  being reached (s
-00014280: 6f20 7468 6174 2074 6865 206f 7065 7261  o that the opera
-00014290: 7469 6f6e 2074 696d 6573 0a6f 7574 292c  tion times.out),
-000142a0: 206f 7220 696e 2063 6173 6520 7468 6520   or in case the 
-000142b0: 7365 7276 6572 2074 6872 6f77 7320 616e  server throws an
-000142c0: 2065 7863 6570 7469 6f6e 2077 6865 6e20   exception when 
-000142d0: 6861 6e64 6c69 6e67 2061 2063 6c69 656e  handling a clien
-000142e0: 7420 7265 7175 6573 742e 0a0a 506c 6561  t request...Plea
-000142f0: 7365 2061 6c73 6f20 6e6f 7465 2c20 7468  se also note, th
-00014300: 6520 6173 7065 6374 7320 6e6f 7420 636f  e aspects not co
-00014310: 7665 7265 6420 6279 2074 6865 2072 6563  vered by the rec
-00014320: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
-00014330: 2064 6563 6f72 6174 6f72 0a62 6568 6176   decorator.behav
-00014340: 696f 7572 7320 6861 7665 2074 6f20 646f  iours have to do
-00014350: 2077 6974 6820 6d65 7468 6f64 7320 7468   with methods th
-00014360: 6174 2072 6574 7572 6e20 6974 6572 6174  at return iterat
-00014370: 6f72 732e 2046 6f72 2065 7861 6d70 6c65  ors. For example
-00014380: 2c20 636f 6e73 6964 6572 0a74 6865 2060  , consider.the `
-00014390: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-000143a0: 2960 206d 6574 686f 642c 2077 6869 6368  )` method, which
-000143b0: 2072 6574 7572 6e73 2061 6e20 6974 6572   returns an iter
-000143c0: 6174 6f72 206f 6620 6052 6563 6f72 6465  ator of `Recorde
-000143d0: 6445 7665 6e74 6020 6f62 6a65 6374 732e  dEvent` objects.
-000143e0: 0a54 6865 206d 6574 686f 6420 6861 7320  .The method has 
-000143f0: 7265 7475 726e 6564 2061 6e64 2074 6865  returned and the
-00014400: 206d 6574 686f 6420 6465 636f 7261 746f   method decorato
-00014410: 7273 2068 6176 6520 7468 6572 6566 6f72  rs have therefor
-00014420: 6520 6578 6974 6564 2062 6566 6f72 6520  e exited before 
-00014430: 7468 650a 6974 6572 6174 696e 6720 6f66  the.iterating of
-00014440: 2074 6865 2072 6573 706f 6e73 6520 6265   the response be
-00014450: 6769 6e73 2e20 5468 6572 6566 6f72 652c  gins. Therefore,
-00014460: 2069 7420 6973 6e27 7420 706f 7373 6962   it isn't possib
-00014470: 6c65 2066 6f72 2074 6869 7320 6d65 7468  le for this meth
-00014480: 6f64 2074 6f0a 7472 6967 6765 7220 6120  od to.trigger a 
-00014490: 7265 636f 6e6e 6563 7469 6f6e 206f 7220  reconnection or 
-000144a0: 666f 7220 6974 2074 6f20 7265 7472 792c  for it to retry,
-000144b0: 2077 6865 6e20 7468 6520 7374 7265 616d   when the stream
-000144c0: 696e 6720 7265 7370 6f6e 7365 2073 6f6d  ing response som
-000144d0: 6568 6f77 2066 6169 6c73 2e0a 0a41 6e6f  ehow fails...Ano
-000144e0: 7468 6572 2065 7861 6d70 6c65 2069 7320  ther example is 
-000144f0: 7468 6520 2263 6174 6368 2d75 7022 2061  the "catch-up" a
-00014500: 6e64 2070 6572 7369 7374 656e 7420 7375  nd persistent su
-00014510: 6273 6372 6970 7469 6f6e 2072 6561 6420  bscription read 
-00014520: 6d65 7468 6f64 732c 2061 6c74 686f 7567  methods, althoug
-00014530: 680a 7769 7468 2074 6865 7365 206d 6574  h.with these met
-00014540: 686f 6473 2074 6865 7265 2069 7320 616e  hods there is an
-00014550: 2069 6e69 7469 616c 2022 636f 6e66 6972   initial "confir
-00014560: 6d61 7469 6f6e 2220 7265 7370 6f6e 7365  mation" response
-00014570: 2066 726f 6d20 7468 6520 7365 7276 6572   from the server
-00014580: 2077 6869 6368 0a69 7320 7265 6365 6976   which.is receiv
-00014590: 6564 2061 6e64 2063 6865 636b 6564 2062  ed and checked b
-000145a0: 7920 7468 6520 636c 6965 6e74 2062 6566  y the client bef
-000145b0: 6f72 6520 7468 6520 6d65 7468 6f64 2072  ore the method r
-000145c0: 6574 7572 6e73 2c20 736f 2069 6620 7468  eturns, so if th
-000145d0: 6520 7365 7276 6572 2069 730a 756e 6176  e server is.unav
-000145e0: 6169 6c61 626c 6520 7768 656e 2074 6865  ailable when the
-000145f0: 2063 616c 6c20 6973 206d 6164 652c 206f   call is made, o
-00014600: 7220 6966 2074 6865 2063 6861 6e6e 656c  r if the channel
-00014610: 2069 7320 736f 6d65 686f 7720 636c 6f73   is somehow clos
-00014620: 6564 2c20 6f72 2069 6620 7468 650a 7365  ed, or if the.se
-00014630: 7276 6572 2074 6872 6f77 7320 616e 2065  rver throws an e
-00014640: 7272 6f72 2066 6f72 2073 6f6d 6520 7265  rror for some re
-00014650: 6173 6f6e 2c20 7468 656e 2074 6865 2063  ason, then the c
-00014660: 6c69 656e 7420 7769 6c6c 2065 6974 6865  lient will eithe
-00014670: 7220 7265 636f 6e6e 6563 7420 616e 640a  r reconnect and.
-00014680: 7265 7472 792c 206f 7220 6d6f 7265 2073  retry, or more s
-00014690: 696d 706c 7920 6a75 7374 2072 6574 7279  imply just retry
-000146a0: 2074 6865 206f 7065 7261 7469 6f6e 2c20   the operation, 
-000146b0: 6163 636f 7264 696e 6720 7468 6520 7479  according the ty
-000146c0: 7065 206f 6620 6572 726f 7220 7468 6174  pe of error that
-000146d0: 0a77 6173 2065 6e63 6f75 6e74 6572 6564  .was encountered
-000146e0: 2e20 486f 7765 7665 722c 2061 6e20 6576  . However, an ev
-000146f0: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
-00014700: 6f6d 706f 6e65 6e74 2074 6861 7420 6974  omponent that it
-00014710: 6572 6174 6573 206f 7665 7220 610a 7375  erates over a.su
-00014720: 6363 6573 7366 756c 6c79 2072 6574 7572  ccessfully retur
-00014730: 6e65 6420 2263 6174 6368 2d75 7022 2073  ned "catch-up" s
-00014740: 7562 7363 7269 7074 696f 6e20 7265 7370  ubscription resp
-00014750: 6f6e 7365 2077 696c 6c20 6e65 6564 2074  onse will need t
-00014760: 6f20 6265 206d 6f6e 6974 6f72 6564 2066  o be monitored f
-00014770: 6f72 0a65 7272 6f72 732c 2061 6e64 2c20  or.errors, and, 
-00014780: 6966 2069 7420 6661 696c 7320 6166 7465  if it fails afte
-00014790: 7220 6974 2068 6173 2073 7461 7274 6564  r it has started
-000147a0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-000147b0: 7468 6520 7265 7370 6f6e 7365 2c20 7468  the response, th
-000147c0: 6520 6361 7463 682d 7570 0a73 7562 7363  e catch-up.subsc
-000147d0: 7269 7074 696f 6e20 7769 6c6c 206e 6565  ription will nee
-000147e0: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
-000147f0: 6420 6672 6f6d 2074 6865 2065 7665 6e74  d from the event
-00014800: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-00014810: 6f6e 656e 7427 7320 226c 6173 740a 7361  onent's "last.sa
-00014820: 7665 6420 636f 6d6d 6974 2070 6f73 6974  ved commit posit
-00014830: 696f 6e22 2e20 4966 2074 6865 2065 7665  ion". If the eve
-00014840: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
-00014850: 6d70 6f6e 656e 7420 6973 2072 6563 6f72  mponent is recor
-00014860: 6469 6e67 2074 6865 2063 6f6d 6d69 740a  ding the commit.
-00014870: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
-00014880: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00014890: 6174 6f6d 6963 616c 6c79 2061 6c6f 6e67  atomically along
-000148a0: 2077 6974 6820 616e 7920 6e65 7720 7374   with any new st
-000148b0: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
-000148c0: 2066 726f 6d0a 7072 6f63 6573 7369 6e67   from.processing
-000148d0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-000148e0: 656e 7473 2c20 616e 6420 7468 6520 636f  ents, and the co
-000148f0: 6d6d 6974 2070 6f73 6974 696f 6e73 2061  mmit positions a
-00014900: 7265 2072 6563 6f72 6465 6420 7769 7468  re recorded with
-00014910: 2061 2075 6e69 7175 656e 6573 730a 636f   a uniqueness.co
-00014920: 6e73 7472 6169 6e74 2c20 7468 656e 2074  nstraint, then t
-00014930: 6865 7265 2077 696c 6c20 6e6f 2064 616e  here will no dan
-00014940: 6765 7220 746f 2074 6865 2070 726f 6a65  ger to the proje
-00014950: 6374 6564 2073 7461 7465 2062 6563 6f6d  cted state becom
-00014960: 696e 6720 696e 636f 6e73 6973 7465 6e74  ing inconsistent
-00014970: 2064 7565 0a74 6f20 7468 6573 6520 636f   due.to these co
-00014980: 6e6e 6563 7469 6f6e 2069 7373 7565 732e  nnection issues.
-00014990: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-000149a0: 6865 2063 6c69 656e 7420 7769 6c6c 2061  he client will a
-000149b0: 7574 6f6d 6174 6963 616c 6c79 2072 6563  utomatically rec
-000149c0: 6f6e 6e65 6374 2074 6f20 610a 6e6f 6465  onnect to a.node
-000149d0: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
-000149e0: 7768 656e 2074 6865 2073 7562 7365 7175  when the subsequ
-000149f0: 656e 7420 6361 6c6c 2074 6f20 6120 6361  ent call to a ca
-00014a00: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00014a10: 696f 6e20 6d65 7468 6f64 2069 7320 6d61  ion method is ma
-00014a20: 6465 2e0a 596f 7520 6a75 7374 206e 6565  de..You just nee
-00014a30: 6420 746f 2068 616e 646c 6520 7468 6520  d to handle the 
-00014a40: 6578 6365 7074 696f 6e20 7468 6174 206f  exception that o
-00014a50: 6363 7572 7320 6672 6f6d 2074 6865 2069  ccurs from the i
-00014a60: 7465 7261 746f 722c 2074 6865 6e20 7265  terator, then re
-00014a70: 6164 2079 6f75 7220 6c61 7374 0a73 6176  ad your last.sav
-00014a80: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
-00014a90: 6f6e 2c20 616e 6420 7468 656e 2072 6573  on, and then res
-00014aa0: 7461 7274 2079 6f75 7220 6576 656e 742d  tart your event-
-00014ab0: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
-00014ac0: 6e65 6e74 2c20 7573 696e 6720 7468 6520  nent, using the 
-00014ad0: 7361 6d65 0a63 6c69 656e 7420 6f62 6a65  same.client obje
-00014ae0: 6374 2e20 5468 6520 636c 6965 6e74 2077  ct. The client w
-00014af0: 696c 6c20 7265 636f 6e6e 6563 7420 6966  ill reconnect if
-00014b00: 2074 6865 7265 2069 7320 6120 6e65 6564   there is a need
-00014b10: 2074 6f20 646f 2073 6f20 7768 656e 2074   to do so when t
-00014b20: 6865 2073 7562 7365 7175 656e 740a 6361  he subsequent.ca
-00014b30: 6c6c 2069 7320 6d61 6465 2e20 5369 6d69  ll is made. Simi
-00014b40: 6c61 726c 792c 2077 6865 6e20 7265 6164  larly, when read
-00014b50: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
-00014b60: 7562 7363 7269 7074 696f 6e73 2c20 6966  ubscriptions, if
-00014b70: 2074 6865 7265 2061 7265 0a63 6f6e 6e65   there are.conne
-00014b80: 6374 6976 6974 7920 6973 7375 6573 2061  ctivity issues a
-00014b90: 6674 6572 2079 6f75 2068 6176 6520 7374  fter you have st
-00014ba0: 6172 7465 6420 6974 6572 6174 696e 6720  arted iterating 
-00014bb0: 6f76 6572 2061 2073 7563 6365 7373 6675  over a successfu
-00014bc0: 6c6c 7920 7265 6365 6976 6564 0a72 6573  lly received.res
-00014bd0: 706f 6e73 652c 2074 6865 6e20 7468 6520  ponse, then the 
-00014be0: 7365 7276 6572 2063 616c 6c20 7769 6c6c  server call will
-00014bf0: 206e 6565 6420 746f 2062 6520 7265 7374   need to be rest
-00014c00: 6172 7465 642e 2049 6e20 7468 6973 2063  arted. In this c
-00014c10: 6173 652c 2074 6865 2072 6563 6569 7665  ase, the receive
-00014c20: 640a 6576 656e 7473 2077 696c 6c20 7374  d.events will st
-00014c30: 6172 7420 7769 7468 2074 6865 206c 6173  art with the las
-00014c40: 7420 7361 7665 6420 6368 6563 6b70 6f69  t saved checkpoi
-00014c50: 6e74 206f 6e20 7468 6520 7365 7276 6572  nt on the server
-00014c60: 2028 706f 7465 6e74 6961 6c6c 7920 7265   (potentially re
-00014c70: 7475 726e 696e 670a 6576 656e 7473 2074  turning.events t
-00014c80: 6861 7420 7765 7265 2069 6e20 6661 6374  hat were in fact
-00014c90: 2073 7563 6365 7373 6675 6c6c 7920 7072   successfully pr
-00014ca0: 6f63 6573 7365 6429 2e0a 0a0a 2323 2320  ocessed)....### 
-00014cb0: 436c 6f73 650a 0a54 6865 2060 636c 6f73  Close..The `clos
-00014cc0: 6528 2960 206d 6574 686f 6420 6361 6e20  e()` method can 
-00014cd0: 6265 2075 7365 6420 746f 2063 6c65 616e  be used to clean
-00014ce0: 6c79 2063 6c6f 7365 2074 6865 2067 5250  ly close the gRP
-00014cf0: 4320 636f 6e6e 6563 7469 6f6e 2e0a 0a60  C connection...`
-00014d00: 6060 7079 7468 6f6e 0a63 6c69 656e 742e  ``python.client.
-00014d10: 636c 6f73 6528 290a 6060 600a 0a23 2320  close().```..## 
-00014d20: 4e6f 7465 730a 0a23 2323 2043 6f6e 6e65  Notes..### Conne
-00014d30: 6374 696f 6e20 7374 7269 6e67 730a 0a54  ction strings..T
-00014d40: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00014d50: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00014d60: 6720 6973 2061 2055 5249 2074 6861 7420  g is a URI that 
-00014d70: 636f 6e66 6f72 6d73 2077 6974 6820 6f6e  conforms with on
-00014d80: 6520 6f66 2074 776f 2070 6f73 7369 626c  e of two possibl
-00014d90: 650a 7363 6865 6d65 732c 2065 6974 6865  e.schemes, eithe
-00014da0: 7220 7468 6520 2265 7364 6222 2073 6368  r the "esdb" sch
-00014db0: 656d 6520 6f72 2074 6865 2022 6573 6462  eme or the "esdb
-00014dc0: 2b64 6973 636f 7665 7222 2073 6368 656d  +discover" schem
-00014dd0: 652e 2054 6865 2073 796e 7461 7820 616e  e. The syntax an
-00014de0: 640a 7365 6d61 6e74 6963 7320 6f66 2074  d.semantics of t
-00014df0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00014e00: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
-00014e10: 6578 706c 6169 6e65 6420 6265 6c6f 772e  explained below.
-00014e20: 2054 6865 2073 796e 7461 7820 6973 0a64   The syntax is.d
-00014e30: 6566 696e 6564 2075 7369 6e67 205b 4542  efined using [EB
-00014e40: 4e46 5d28 6874 7470 733a 2f2f 656e 2e77  NF](https://en.w
-00014e50: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
-00014e60: 692f 4578 7465 6e64 6564 5f42 6163 6b75  i/Extended_Backu
-00014e70: 73e2 8093 4e61 7572 5f66 6f72 6d29 2e0a  s...Naur_form)..
-00014e80: 0a54 6865 2022 6573 6462 2220 5552 4920  .The "esdb" URI 
-00014e90: 7363 6865 6d65 2063 616e 2062 6520 6465  scheme can be de
-00014ea0: 6669 6e65 6420 696e 2074 6865 2066 6f6c  fined in the fol
-00014eb0: 6c6f 7769 6e67 2077 6179 2e0a 0a20 2020  lowing way...   
-00014ec0: 2065 7364 622d 7572 6920 3d20 2265 7364   esdb-uri = "esd
-00014ed0: 623a 2f2f 2220 2c20 5b20 7573 6572 2d69  b://" , [ user-i
-00014ee0: 6e66 6f20 2c20 2240 2220 5d20 2c20 6772  nfo , "@" ] , gr
-00014ef0: 7063 2d74 6172 6765 742c 207b 2022 2c22  pc-target, { ","
-00014f00: 202c 2067 7270 632d 7461 7267 6574 207d   , grpc-target }
-00014f10: 202c 205b 2022 3f22 202c 2071 7565 7279   , [ "?" , query
-00014f20: 2d73 7472 696e 6720 5d20 3b0a 0a49 6e20  -string ] ;..In 
-00014f30: 7468 6520 2265 7364 6222 2055 5249 2073  the "esdb" URI s
-00014f40: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
-00014f50: 206f 7074 696f 6e61 6c20 7573 6572 2069   optional user i
-00014f60: 6e66 6f20 7374 7269 6e67 2c20 7468 6572  nfo string, ther
-00014f70: 6520 6d75 7374 2062 6520 6174 206c 6561  e must be at lea
-00014f80: 7374 0a6f 6e65 2067 5250 4320 7461 7267  st.one gRPC targ
-00014f90: 6574 2e20 4966 2074 6865 7265 2061 7265  et. If there are
-00014fa0: 2073 6576 6572 616c 2067 5250 4320 7461   several gRPC ta
-00014fb0: 7267 6574 732c 2074 6865 7920 6d75 7374  rgets, they must
-00014fc0: 2062 6520 7365 7061 7261 7465 6420 6672   be separated fr
-00014fd0: 6f6d 2065 6163 680a 6f74 6865 7220 7769  om each.other wi
-00014fe0: 7468 2074 6865 2022 2c22 2063 6861 7261  th the "," chara
-00014ff0: 6374 6572 2e20 4561 6368 2067 5250 4320  cter. Each gRPC 
-00015000: 7461 7267 6574 2073 686f 756c 6420 696e  target should in
-00015010: 6469 6361 7465 2061 6e20 4576 656e 7453  dicate an EventS
-00015020: 746f 7265 4442 2067 5250 430a 7365 7276  toreDB gRPC.serv
-00015030: 6572 2073 6f63 6b65 742c 2062 7920 7370  er socket, by sp
-00015040: 6563 6966 7969 6e67 2061 2068 6f73 7420  ecifying a host 
-00015050: 616e 6420 6120 706f 7274 206e 756d 6265  and a port numbe
-00015060: 7220 7365 7061 7261 7465 6420 7769 7468  r separated with
-00015070: 2074 6865 2022 3a22 2063 6861 7261 6374   the ":" charact
-00015080: 6572 2e0a 5468 6520 686f 7374 206d 6179  er..The host may
-00015090: 2062 6520 6120 686f 7374 6e61 6d65 2074   be a hostname t
-000150a0: 6861 7420 6361 6e20 6265 2072 6573 6f6c  hat can be resol
-000150b0: 7665 6420 746f 2061 6e20 4950 2061 6464  ved to an IP add
-000150c0: 7265 7373 2c20 6f72 2061 6e20 4950 2061  ress, or an IP a
-000150d0: 6464 7265 7373 2e0a 0a20 2020 2067 7270  ddress...    grp
-000150e0: 632d 7461 7267 6574 203d 2028 2068 6f73  c-target = ( hos
-000150f0: 746e 616d 6520 7c20 6970 2d61 6464 7265  tname | ip-addre
-00015100: 7373 2029 202c 2022 3a22 202c 2070 6f72  ss ) , ":" , por
-00015110: 742d 6e75 6d62 6572 203b 0a0a 0a54 6865  t-number ;...The
-00015120: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-00015130: 2055 5249 2073 6368 656d 6520 6361 6e20   URI scheme can 
-00015140: 6265 2064 6566 696e 6564 2069 6e20 7468  be defined in th
-00015150: 6520 666f 6c6c 6f77 696e 6720 7761 792e  e following way.
-00015160: 0a0a 2020 2020 6573 6462 2d64 6973 636f  ..    esdb-disco
-00015170: 7665 722d 7572 6920 3d20 2265 7364 622b  ver-uri = "esdb+
-00015180: 6469 7363 6f76 6572 3a2f 2f22 202c 205b  discover://" , [
-00015190: 2075 7365 722d 696e 666f 2c20 2240 2220   user-info, "@" 
-000151a0: 5d20 2c20 636c 7573 7465 722d 646f 6d61  ] , cluster-doma
-000151b0: 696e 6e61 6d65 202c 205b 2022 3f22 202c  inname , [ "?" ,
-000151c0: 2071 7565 7279 2d73 7472 696e 6720 5d20   query-string ] 
-000151d0: 3b0a 0a49 6e20 7468 6520 2265 7364 622b  ;..In the "esdb+
-000151e0: 6469 7363 6f76 6572 2220 5552 4920 7363  discover" URI sc
-000151f0: 6865 6d65 2c20 6166 7465 7220 7468 6520  heme, after the 
-00015200: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-00015210: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
-00015220: 6120 646f 6d61 696e 0a6e 616d 6520 7768  a domain.name wh
-00015230: 6963 6820 7368 6f75 6c64 2069 6465 6e74  ich should ident
-00015240: 6966 7920 6120 636c 7573 7465 7220 6f66  ify a cluster of
-00015250: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-00015260: 7276 6572 732e 2054 6865 2063 6c69 656e  rvers. The clien
-00015270: 7420 7769 6c6c 2075 7365 2061 2044 4e53  t will use a DNS
-00015280: 0a73 6572 7665 7220 746f 2072 6573 6f6c  .server to resol
-00015290: 7665 2074 6865 2064 6f6d 6169 6e20 6e61  ve the domain na
-000152a0: 6d65 2074 6f20 6120 6c69 7374 206f 6620  me to a list of 
-000152b0: 6164 6472 6573 7365 7320 6f66 2045 7665  addresses of Eve
-000152c0: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-000152d0: 732c 0a62 7920 7175 6572 7969 6e67 2066  s,.by querying f
-000152e0: 6f72 2027 4127 2072 6563 6f72 6473 2e20  or 'A' records. 
-000152f0: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
-00015300: 6520 706f 7274 206e 756d 6265 7220 2232  e port number "2
-00015310: 3131 3322 2077 696c 6c20 6265 2075 7365  113" will be use
-00015320: 6420 746f 0a63 6f6e 7374 7275 6374 2067  d to.construct g
-00015330: 5250 4320 7461 7267 6574 7320 6672 6f6d  RPC targets from
-00015340: 2074 6865 2061 6464 7265 7373 6573 206f   the addresses o
-00015350: 6274 6169 6e65 6420 6672 6f6d 2027 4127  btained from 'A'
-00015360: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
-00015370: 6420 6279 2074 6865 0a44 4e53 2073 6572  d by the.DNS ser
-00015380: 7665 722e 2054 6865 7265 666f 7265 2c20  ver. Therefore, 
-00015390: 6966 2079 6f75 2077 616e 7420 746f 2075  if you want to u
-000153a0: 7365 2074 6865 2022 6573 6462 2b64 6973  se the "esdb+dis
-000153b0: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
-000153c0: 652c 2079 6f75 2077 696c 6c0a 6e65 6564  e, you will.need
-000153d0: 2074 6f20 636f 6e66 6967 7572 6520 444e   to configure DN
-000153e0: 5320 7768 656e 2073 6574 7469 6e67 2075  S when setting u
-000153f0: 7020 796f 7572 2045 7665 6e74 5374 6f72  p your EventStor
-00015400: 6544 4220 636c 7573 7465 722e 0a0a 5769  eDB cluster...Wi
-00015410: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
-00015420: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
-00015430: 6f63 7665 7222 2055 5249 2073 6368 656d  ocver" URI schem
-00015440: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
-00015450: 6972 7374 6c79 206f 6274 6169 6e73 0a61  irstly obtains.a
-00015460: 206c 6973 7420 6f66 2067 5250 4320 7461   list of gRPC ta
-00015470: 7267 6574 733a 2065 6974 6865 7220 6469  rgets: either di
-00015480: 7265 6374 6c79 2066 726f 6d20 2265 7364  rectly from "esd
-00015490: 6222 2063 6f6e 6e65 6374 696f 6e20 7374  b" connection st
-000154a0: 7269 6e67 733b 206f 7220 696e 6469 7265  rings; or indire
-000154b0: 6374 6c79 0a66 726f 6d20 2265 7364 622b  ctly.from "esdb+
-000154c0: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
-000154d0: 7469 6f6e 2073 7472 696e 6773 2076 6961  tion strings via
-000154e0: 2044 4e53 2e20 5468 6973 206c 6973 7420   DNS. This list 
-000154f0: 6f66 2074 6172 6765 7473 2069 7320 6b6e  of targets is kn
-00015500: 6f77 6e20 6173 2074 6865 0a22 676f 7373  own as the."goss
-00015510: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
-00015520: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
-00015530: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
-00015540: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
-00015550: 6172 6765 7420 696e 2074 7572 6e2c 0a61  arget in turn,.a
-00015560: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
-00015570: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
-00015580: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
-00015590: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
-000155a0: 696f 6e20 6162 6f75 7420 7468 650a 4576  ion about the.Ev
-000155b0: 656e 7453 746f 7265 4442 2063 6c75 7374  entStoreDB clust
-000155c0: 6572 2e20 4120 6d65 6d62 6572 206f 6620  er. A member of 
-000155d0: 7468 6520 636c 7573 7465 7220 6973 2073  the cluster is s
-000155e0: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
-000155f0: 6c69 656e 742c 2061 6363 6f72 6469 6e67  lient, according
-00015600: 0a74 6f20 7468 6520 226e 6f64 6520 7072  .to the "node pr
-00015610: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
-00015620: 2e20 5468 6520 636c 6965 6e74 206d 6179  . The client may
-00015630: 2074 6865 6e20 6e65 6564 2074 6f20 636c   then need to cl
-00015640: 6f73 6520 6974 730a 636f 6e6e 6563 7469  ose its.connecti
-00015650: 6f6e 2061 6e64 2072 6563 6f6e 6e65 6374  on and reconnect
-00015660: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
-00015670: 2073 6572 7665 722e 0a0a 496e 2062 6f74   server...In bot
-00015680: 6820 7468 6520 2265 7364 6222 2061 6e64  h the "esdb" and
-00015690: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-000156a0: 2073 6368 656d 6573 2c20 7468 6520 5552   schemes, the UR
-000156b0: 4920 6d61 7920 696e 636c 7564 6520 6120  I may include a 
-000156c0: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-000156d0: 2e0a 4966 2069 7420 6578 6973 7473 2069  ..If it exists i
-000156e0: 6e20 7468 6520 5552 492c 2074 6865 2075  n the URI, the u
-000156f0: 7365 7220 696e 666f 2073 7472 696e 6720  ser info string 
-00015700: 6d75 7374 2062 6520 7365 7061 7261 7465  must be separate
-00015710: 6420 6672 6f6d 2074 6865 2072 6573 7420  d from the rest 
-00015720: 6f66 2074 6865 2055 5249 0a77 6974 6820  of the URI.with 
-00015730: 7468 6520 2240 2220 6368 6172 6163 7465  the "@" characte
-00015740: 722e 2054 6865 2075 7365 7220 696e 666f  r. The user info
-00015750: 2073 7472 696e 6720 6d75 7374 2069 6e63   string must inc
-00015760: 6c75 6465 2061 2075 7365 726e 616d 6520  lude a username 
-00015770: 616e 6420 6120 7061 7373 776f 7264 2c0a  and a password,.
-00015780: 7365 7061 7261 7465 6420 7769 7468 2074  separated with t
-00015790: 6865 2022 3a22 2063 6861 7261 6374 6572  he ":" character
-000157a0: 2e0a 0a20 2020 2075 7365 722d 696e 666f  ...    user-info
-000157b0: 203d 2075 7365 726e 616d 6520 2c20 223a   = username , ":
-000157c0: 2220 2c20 7061 7373 776f 7264 203b 0a0a  " , password ;..
-000157d0: 5468 6520 7573 6572 2069 6e66 6f20 6973  The user info is
-000157e0: 2073 656e 7420 6279 2074 6865 2063 6c69   sent by the cli
-000157f0: 656e 7420 6173 2022 6361 6c6c 2063 7265  ent as "call cre
-00015800: 6465 6e74 6961 6c73 2220 696e 2065 6163  dentials" in eac
-00015810: 6820 6361 6c6c 2074 6f20 6120 2273 6563  h call to a "sec
-00015820: 7572 6522 0a73 6572 7665 722c 2069 6e20  ure".server, in 
-00015830: 6120 2262 6173 6963 2061 7574 6822 2061  a "basic auth" a
-00015840: 7574 686f 7269 7a61 7469 6f6e 2068 6561  uthorization hea
-00015850: 6465 722e 2054 6869 7320 6175 7468 6f72  der. This author
-00015860: 697a 6174 696f 6e20 6865 6164 6572 2069  ization header i
-00015870: 7320 7573 6564 2062 790a 7468 6520 7365  s used by.the se
-00015880: 7276 6572 2074 6f20 6175 7468 656e 7469  rver to authenti
-00015890: 6361 7465 2074 6865 2063 6c69 656e 742e  cate the client.
-000158a0: 2054 6865 2061 7574 686f 7269 7a61 7469   The authorizati
-000158b0: 6f6e 2068 6561 6465 7220 6973 206e 6f74  on header is not
-000158c0: 2073 656e 7420 746f 0a22 696e 7365 6375   sent to."insecu
-000158d0: 7265 2220 7365 7276 6572 732e 0a0a 496e  re" servers...In
-000158e0: 2062 6f74 6820 7468 6520 2265 7364 6222   both the "esdb"
-000158f0: 2061 6e64 2022 6573 6462 2b64 6973 636f   and "esdb+disco
-00015900: 7665 7222 2073 6368 656d 6573 2c20 7468  ver" schemes, th
-00015910: 6520 6f70 7469 6f6e 616c 2071 7565 7279  e optional query
-00015920: 2073 7472 696e 6720 6d75 7374 2062 6520   string must be 
-00015930: 6f6e 650a 6f72 206d 616e 7920 6669 656c  one.or many fiel
-00015940: 642d 7661 6c75 6520 6172 6775 6d65 6e74  d-value argument
-00015950: 732c 2073 6570 6172 6174 6564 2066 726f  s, separated fro
-00015960: 6d20 6561 6368 206f 7468 6572 2077 6974  m each other wit
-00015970: 6820 7468 6520 2226 2220 6368 6172 6163  h the "&" charac
-00015980: 7465 722e 0a0a 2020 2020 7175 6572 792d  ter...    query-
-00015990: 7374 7269 6e67 203d 2066 6965 6c64 2d76  string = field-v
-000159a0: 616c 7565 2c20 7b20 2226 222c 2066 6965  alue, { "&", fie
-000159b0: 6c64 2d76 616c 7565 207d 203b 0a0a 4561  ld-value } ;..Ea
-000159c0: 6368 2066 6965 6c64 2d76 616c 7565 2061  ch field-value a
-000159d0: 7267 756d 656e 7420 6d75 7374 2062 6520  rgument must be 
-000159e0: 6f6e 6520 6f66 2074 6865 2073 7570 706f  one of the suppo
-000159f0: 7274 6564 2066 6965 6c64 732c 2061 6e64  rted fields, and
-00015a00: 2061 6e0a 6170 7072 6f70 7269 6174 6520   an.appropriate 
-00015a10: 7661 6c75 652c 2073 6570 6172 6174 6564  value, separated
-00015a20: 2077 6974 6820 7468 6520 223d 2220 6368   with the "=" ch
-00015a30: 6172 6163 7465 722e 0a0a 2020 2020 6669  aracter...    fi
-00015a40: 656c 642d 7661 6c75 6520 3d20 2820 2254  eld-value = ( "T
-00015a50: 6c73 222c 2022 3d22 202c 2022 7472 7565  ls", "=" , "true
-00015a60: 2220 7c20 2266 616c 7365 2220 290a 2020  " | "false" ).  
-00015a70: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00015a80: 2820 2254 6c73 5665 7269 6679 4365 7274  ( "TlsVerifyCert
-00015a90: 222c 2022 3d22 202c 2022 7472 7565 2220  ", "=" , "true" 
-00015aa0: 7c20 2266 616c 7365 2220 290a 2020 2020  | "false" ).    
-00015ab0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00015ac0: 2243 6f6e 6e65 6374 696f 6e4e 616d 6522  "ConnectionName"
-00015ad0: 2c20 223d 2220 2c20 7374 7269 6e67 2029  , "=" , string )
-00015ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015af0: 207c 2028 2022 4e6f 6465 5072 6566 6572   | ( "NodePrefer
-00015b00: 656e 6365 222c 2022 3d22 202c 2022 6c65  ence", "=" , "le
-00015b10: 6164 6572 2220 7c20 2266 6f6c 6c6f 7765  ader" | "followe
-00015b20: 7222 207c 2022 7265 6164 6f6e 6c79 7265  r" | "readonlyre
-00015b30: 706c 6963 6122 207c 2022 7261 6e64 6f6d  plica" | "random
-00015b40: 2220 290a 2020 2020 2020 2020 2020 2020  " ).            
-00015b50: 2020 2020 7c20 2820 2244 6566 6175 6c74      | ( "Default
-00015b60: 4465 6164 6c69 6e65 222c 2022 3d22 202c  Deadline", "=" ,
-00015b70: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
-00015b80: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-00015b90: 476f 7373 6970 5469 6d65 6f75 7422 2c20  GossipTimeout", 
-00015ba0: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
-00015bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bc0: 7c20 2820 224d 6178 4469 7363 6f76 6572  | ( "MaxDiscover
-00015bd0: 4174 7465 6d70 7473 222c 2022 3d22 202c  Attempts", "=" ,
-00015be0: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
-00015bf0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-00015c00: 4469 7363 6f76 6572 7949 6e74 6572 7661  DiscoveryInterva
-00015c10: 6c22 2c20 223d 2220 2c20 696e 7465 6765  l", "=" , intege
-00015c20: 7220 290a 2020 2020 2020 2020 2020 2020  r ).            
-00015c30: 2020 2020 7c20 2820 224d 6178 4469 7363      | ( "MaxDisc
-00015c40: 6f76 6572 4174 7465 6d70 7473 222c 2022  overAttempts", "
-00015c50: 3d22 202c 2069 6e74 6567 6572 2029 0a20  =" , integer ). 
-00015c60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00015c70: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
-00015c80: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
-00015c90: 7465 6765 7220 290a 2020 2020 2020 2020  teger ).        
-00015ca0: 2020 2020 2020 2020 7c20 2820 224b 6565          | ( "Kee
-00015cb0: 7041 6c69 7665 496e 7465 7276 616c 222c  pAliveInterval",
-00015cc0: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
-00015cd0: 203b 0a0a 5468 6520 7461 626c 6520 6265   ;..The table be
-00015ce0: 6c6f 7720 6465 7363 7269 6265 7320 7468  low describes th
-00015cf0: 6520 7175 6572 7920 6669 656c 642d 7661  e query field-va
-00015d00: 6c75 6573 2073 7570 706f 7274 6564 2062  lues supported b
-00015d10: 7920 7468 6973 2063 6c69 656e 742e 0a0a  y this client...
-00015d20: 7c20 4669 656c 6420 2020 2020 2020 2020  | Field         
-00015d30: 2020 2020 2020 7c20 5661 6c75 6520 2020        | Value   
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d70: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00015d80: 4465 7363 7269 7074 696f 6e20 2020 2020  Description     
-00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e20: 2020 7c0a 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d    |.|-----------
-00015e30: 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d  ----------|-----
-00015e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015e80: 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  --|-------------
-00015e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f20: 2d2d 2d2d 2d2d 7c0a 7c20 546c 7320 2020  ------|.| Tls   
-00015f30: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00015f40: 2274 7275 6522 2c20 2266 616c 7365 2220  "true", "false" 
-00015f50: 2864 6566 6175 6c74 3a20 2274 7275 6522  (default: "true"
-00015f60: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-00015f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f80: 2020 2020 2020 7c20 4966 2022 7472 7565        | If "true
-00015f90: 2220 7468 6520 636c 6965 6e74 2077 696c  " the client wil
-00015fa0: 6c20 6372 6561 7465 2061 2022 7365 6375  l create a "secu
-00015fb0: 7265 2220 6752 5043 2063 6861 6e6e 656c  re" gRPC channel
-00015fc0: 2e20 4966 2022 6661 6c73 6522 2074 6865  . If "false" the
-00015fd0: 2063 6c69 656e 7420 7769 6c6c 2063 7265   client will cre
-00015fe0: 6174 6520 616e 2022 696e 7365 6375 7265  ate an "insecure
-00015ff0: 2220 6752 5043 2063 6861 6e6e 656c 2e20  " gRPC channel. 
-00016000: 5468 6973 206d 7573 7420 6d61 7463 6820  This must match 
-00016010: 7468 6520 7365 7276 6572 2063 6f6e 6669  the server confi
-00016020: 6775 7261 7469 6f6e 2e20 7c0a 7c20 546c  guration. |.| Tl
-00016030: 7356 6572 6966 7943 6572 7420 2020 2020  sVerifyCert     
-00016040: 2020 7c20 2274 7275 6522 2c20 2266 616c    | "true", "fal
-00016050: 7365 2220 2864 6566 6175 6c74 3a20 2274  se" (default: "t
-00016060: 7275 6522 2920 2020 2020 2020 2020 2020  rue")           
-00016070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016080: 2020 2020 2020 2020 2020 7c20 5468 6973            | This
-00016090: 2076 616c 7565 2069 7320 6375 7272 656e   value is curren
-000160a0: 746c 7920 6967 6e6f 7265 642e 2020 2020  tly ignored.    
-000160b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016120: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00016130: 7c20 436f 6e6e 6563 7469 6f6e 4e61 6d65  | ConnectionName
-00016140: 2020 2020 2020 7c20 7374 7269 6e67 2028        | string (
-00016150: 6465 6661 756c 743a 2061 7574 6f2d 6765  default: auto-ge
-00016160: 6e65 7261 7465 6420 7665 7273 696f 6e2d  nerated version-
-00016170: 3420 5555 4944 2920 2020 2020 2020 2020  4 UUID)         
-00016180: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00016190: 5365 6e74 2069 6e20 6361 6c6c 206d 6574  Sent in call met
-000161a0: 6164 6174 6120 666f 7220 6576 6572 7920  adata for every 
-000161b0: 6361 6c6c 2c20 746f 2069 6465 6e74 6966  call, to identif
-000161c0: 7920 7468 6520 636c 6965 6e74 2074 6f20  y the client to 
-000161d0: 7468 6520 636c 7573 7465 722e 2020 2020  the cluster.    
-000161e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016230: 2020 7c0a 7c20 4e6f 6465 5072 6566 6572    |.| NodePrefer
-00016240: 656e 6365 2020 2020 2020 7c20 226c 6561  ence      | "lea
-00016250: 6465 7222 2c20 2266 6f6c 6c6f 7765 7222  der", "follower"
-00016260: 2c20 2272 6561 646f 6e6c 7972 6570 6c69  , "readonlyrepli
-00016270: 6361 222c 2022 7261 6e64 6f6d 2220 2864  ca", "random" (d
-00016280: 6566 6175 6c74 3a20 226c 6561 6465 7222  efault: "leader"
-00016290: 2920 7c20 5468 6520 6e6f 6465 2073 7461  ) | The node sta
-000162a0: 7465 2070 7265 6665 7272 6564 2062 7920  te preferred by 
-000162b0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
-000162c0: 636c 6965 6e74 2077 696c 6c20 7365 6c65  client will sele
-000162d0: 6374 2061 206e 6f64 6520 6672 6f6d 2074  ct a node from t
-000162e0: 6865 2063 6c75 7374 6572 2069 6e66 6f20  he cluster info 
-000162f0: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
-00016300: 6520 476f 7373 6970 2041 5049 2061 6363  e Gossip API acc
-00016310: 6f72 6469 6e67 2074 6f20 7468 6973 2070  ording to this p
-00016320: 7265 6665 7265 6e63 652e 2020 2020 2020  reference.      
-00016330: 2020 2020 2020 7c0a 7c20 4465 6661 756c        |.| Defaul
-00016340: 7444 6561 646c 696e 6520 2020 2020 7c20  tDeadline     | 
-00016350: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00016360: 3a20 604e 6f6e 6560 2920 2020 2020 2020  : `None`)       
-00016370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016390: 2020 2020 2020 7c20 5468 6520 6465 6661        | The defa
-000163a0: 756c 7420 7661 6c75 6520 2869 6e20 7365  ult value (in se
-000163b0: 636f 6e64 7329 206f 6620 7468 6520 6074  conds) of the `t
-000163c0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-000163d0: 206f 6620 636c 6965 6e74 2022 7772 6974   of client "writ
-000163e0: 6522 206d 6574 686f 6473 2073 7563 6820  e" methods such 
-000163f0: 6173 2060 6170 7065 6e64 5f65 7665 6e74  as `append_event
-00016400: 7328 2960 2e20 2020 2020 2020 2020 2020  s()`.           
-00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016430: 2020 2020 2020 2020 2020 7c0a 7c20 476f            |.| Go
-00016440: 7373 6970 5469 6d65 6f75 7420 2020 2020  ssipTimeout     
-00016450: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
-00016460: 6175 6c74 3a20 3529 2020 2020 2020 2020  ault: 5)        
-00016470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016490: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
-000164a0: 6465 6661 756c 7420 7661 6c75 6520 2869  default value (i
-000164b0: 6e20 7365 636f 6e64 7329 206f 6620 7468  n seconds) of th
-000164c0: 6520 6074 696d 656f 7574 6020 6172 6775  e `timeout` argu
-000164d0: 6d65 6e74 206f 6620 676f 7373 6970 2072  ment of gossip r
-000164e0: 6561 6420 6d65 7468 6f64 732c 2073 7563  ead methods, suc
-000164f0: 6820 6173 2060 7265 6164 5f67 6f73 7369  h as `read_gossi
-00016500: 7028 2960 2e20 2020 2020 2020 2020 2020  p()`.           
-00016510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016530: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00016540: 7c20 4d61 7844 6973 636f 7665 7241 7474  | MaxDiscoverAtt
-00016550: 656d 7074 7320 7c20 696e 7465 6765 7220  empts | integer 
-00016560: 2864 6566 6175 6c74 3a20 3130 2920 2020  (default: 10)   
-00016570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016590: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-000165a0: 5468 6520 6e75 6d62 6572 206f 6620 6174  The number of at
-000165b0: 7465 6d70 7473 2074 6f20 7265 6164 2067  tempts to read g
-000165c0: 6f73 7369 7020 7768 656e 2063 6f6e 6e65  ossip when conne
-000165d0: 6374 696e 6720 6f72 2072 6563 6f6e 6e65  cting or reconne
-000165e0: 6374 696e 6720 746f 2061 2063 6c75 7374  cting to a clust
-000165f0: 6572 206d 656d 6265 722e 2020 2020 2020  er member.      
-00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016640: 2020 7c0a 7c20 4469 7363 6f76 6572 7949    |.| DiscoveryI
-00016650: 6e74 6572 7661 6c20 2020 7c20 696e 7465  nterval   | inte
-00016660: 6765 7220 2864 6566 6175 6c74 3a20 3130  ger (default: 10
-00016670: 3029 2020 2020 2020 2020 2020 2020 2020  0)              
-00016680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166a0: 2020 7c20 486f 7720 6c6f 6e67 2074 6f20    | How long to 
-000166b0: 7761 6974 2028 696e 206d 696c 6c69 7365  wait (in millise
-000166c0: 636f 6e64 7329 2062 6574 7765 656e 2067  conds) between g
-000166d0: 6f73 7369 7020 7265 7472 6965 732e 2020  ossip retries.  
-000166e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016740: 2020 2020 2020 7c0a 7c20 4b65 6570 416c        |.| KeepAl
-00016750: 6976 6549 6e74 6572 7661 6c20 2020 7c20  iveInterval   | 
-00016760: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00016770: 3a20 604e 6f6e 6560 2920 2020 2020 2020  : `None`)       
-00016780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167a0: 2020 2020 2020 7c20 5468 6520 7661 6c75        | The valu
-000167b0: 6520 6f66 2074 6865 2022 6772 7063 2e6b  e of the "grpc.k
-000167c0: 6565 7061 6c69 7665 5f6d 7322 2067 5250  eepalive_ms" gRP
-000167d0: 4320 6368 616e 6e65 6c20 6f70 7469 6f6e  C channel option
-000167e0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016840: 2020 2020 2020 2020 2020 7c0a 7c20 4b65            |.| Ke
-00016850: 6570 416c 6976 6554 696d 656f 7574 2020  epAliveTimeout  
-00016860: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
-00016870: 6175 6c74 3a20 604e 6f6e 6560 2920 2020  ault: `None`)   
-00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168a0: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
-000168b0: 7661 6c75 6520 6f66 2074 6865 2022 6772  value of the "gr
-000168c0: 7063 2e6b 6565 7061 6c69 7665 5f74 696d  pc.keepalive_tim
-000168d0: 656f 7574 5f6d 7322 2067 5250 4320 6368  eout_ms" gRPC ch
-000168e0: 616e 6e65 6c20 6f70 7469 6f6e 2e20 2020  annel option.   
-000168f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016940: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00016950: 0a0a 4865 7265 2061 7265 2073 6f6d 6520  ..Here are some 
-00016960: 6578 616d 706c 6573 206f 6620 4576 656e  examples of Even
-00016970: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
-00016980: 696f 6e20 7374 7269 6e67 2055 5249 732e  ion string URIs.
-00016990: 0a0a 2020 2020 2320 4765 7420 636c 7573  ..    # Get clus
-000169a0: 7465 7220 696e 666f 2066 726f 6d20 7365  ter info from se
-000169b0: 6375 7265 2073 6572 7665 7220 736f 636b  cure server sock
-000169c0: 6574 206c 6f63 616c 686f 7374 3a32 3131  et localhost:211
-000169d0: 332c 0a20 2020 2023 2061 6e64 2075 7365  3,.    # and use
-000169e0: 2022 6164 6d69 6e22 2061 6e64 2022 6368   "admin" and "ch
-000169f0: 616e 6765 6974 2220 6173 2075 7365 726e  angeit" as usern
-00016a00: 616d 6520 616e 6420 7061 7373 776f 7264  ame and password
-00016a10: 0a20 2020 2023 2077 6865 6e20 6d61 6b69  .    # when maki
-00016a20: 6e67 2063 616c 6c73 2074 6f20 4576 656e  ng calls to Even
-00016a30: 7453 746f 7265 4442 2041 5049 206d 6574  tStoreDB API met
-00016a40: 686f 6473 2e0a 0a20 2020 2065 7364 623a  hods...    esdb:
-00016a50: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
-00016a60: 406c 6f63 616c 686f 7374 3a32 3131 330a  @localhost:2113.
-00016a70: 0a0a 2020 2020 2320 4765 7420 636c 7573  ..    # Get clus
-00016a80: 7465 7220 696e 666f 2066 726f 6d20 696e  ter info from in
-00016a90: 7365 6375 7265 2073 6572 7665 7220 736f  secure server so
-00016aa0: 636b 6574 2031 3237 2e30 2e30 2e31 3a32  cket 127.0.0.1:2
-00016ab0: 3131 340a 0a20 2020 2065 7364 623a 2f2f  114..    esdb://
-00016ac0: 3132 372e 302e 302e 313a 3231 3134 3f54  127.0.0.1:2114?T
-00016ad0: 6c73 3d66 616c 7365 0a0a 0a20 2020 2023  ls=false...    #
-00016ae0: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
-00016af0: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
-00016b00: 2069 6e20 2741 2720 7265 636f 7264 7320   in 'A' records 
-00016b10: 666f 7220 636c 7573 7465 7231 2e65 7861  for cluster1.exa
-00016b20: 6d70 6c65 2e63 6f6d 2c0a 2020 2020 2320  mple.com,.    # 
-00016b30: 616e 6420 7573 6520 6120 6465 6661 756c  and use a defaul
-00016b40: 7420 6465 6164 6c69 6e65 2066 6f72 206d  t deadline for m
-00016b50: 616b 696e 6720 6361 6c6c 7320 746f 2045  aking calls to E
-00016b60: 7665 6e74 5374 6f72 6520 4150 4920 6d65  ventStore API me
-00016b70: 7468 6f64 2e0a 0a20 2020 2065 7364 622b  thod...    esdb+
-00016b80: 6469 7363 6f76 6572 3a2f 2f61 646d 696e  discover://admin
-00016b90: 3a63 6861 6e67 6569 7440 636c 7573 7465  :changeit@cluste
-00016ba0: 7231 2e65 7861 6d70 6c65 2e63 6f6d 3f44  r1.example.com?D
-00016bb0: 6566 6175 6c74 4465 6164 6c69 6e65 3d35  efaultDeadline=5
-00016bc0: 0a0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
-00016bd0: 7374 6572 2069 6e66 6f20 6672 6f6d 2065  ster info from e
-00016be0: 6974 6865 7220 6c6f 6361 6c68 6f73 743a  ither localhost:
-00016bf0: 3231 3131 206f 7220 6c6f 6361 6c68 6f73  2111 or localhos
-00016c00: 743a 3231 3132 206f 720a 2020 2020 2320  t:2112 or.    # 
-00016c10: 6c6f 6361 6c68 6f73 743a 3231 3133 2c20  localhost:2113, 
-00016c20: 616e 6420 7468 656e 2063 6f6e 6e65 6374  and then connect
-00016c30: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
-00016c40: 6f64 6520 696e 2074 6865 2063 6c75 7374  ode in the clust
-00016c50: 6572 2e0a 0a20 2020 2065 7364 623a 2f2f  er...    esdb://
-00016c60: 6164 6d69 6e3a 6368 616e 6765 6974 406c  admin:changeit@l
-00016c70: 6f63 616c 686f 7374 3a32 3131 312c 6c6f  ocalhost:2111,lo
-00016c80: 6361 6c68 6f73 743a 3231 3132 2c6c 6f63  calhost:2112,loc
-00016c90: 616c 686f 7374 3a32 3131 333f 4e6f 6465  alhost:2113?Node
-00016ca0: 5072 6566 6572 656e 6365 3d66 6f6c 6c6f  Preference=follo
-00016cb0: 7765 720a 0a0a 2020 2020 2320 4765 7420  wer...    # Get 
-00016cc0: 636c 7573 7465 7220 696e 666f 2066 726f  cluster info fro
-00016cd0: 6d20 6164 6472 6573 7365 7320 696e 2027  m addresses in '
-00016ce0: 4127 2072 6563 6f72 6473 2066 6f72 2063  A' records for c
-00016cf0: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
-00016d00: 636f 6d2c 0a20 2020 2023 2061 6e64 2063  com,.    # and c
-00016d10: 6f6e 6669 6775 7265 2022 6b65 6570 2061  onfigure "keep a
-00016d20: 6c69 7665 2220 7469 6d65 6f75 7420 616e  live" timeout an
-00016d30: 6420 696e 7465 7276 616c 2069 6e20 7468  d interval in th
-00016d40: 6520 6752 5043 2063 6861 6e6e 656c 2e0a  e gRPC channel..
-00016d50: 0a20 2020 2065 7364 622b 6469 7363 6f76  .    esdb+discov
-00016d60: 6572 3a2f 2f61 646d 696e 3a63 6861 6e67  er://admin:chang
-00016d70: 6569 7440 636c 7573 7465 7231 2e65 7861  eit@cluster1.exa
-00016d80: 6d70 6c65 2e63 6f6d 3f4b 6565 7041 6c69  mple.com?KeepAli
-00016d90: 7665 496e 7465 7276 616c 3d31 3030 3030  veInterval=10000
-00016da0: 264b 6565 7041 6c69 7665 5469 6d65 6f75  &KeepAliveTimeou
-00016db0: 743d 3130 3030 300a 0a0a 506c 6561 7365  t=10000...Please
-00016dc0: 206e 6f74 652c 2074 6865 2063 6c69 656e   note, the clien
-00016dd0: 7420 6973 2069 6e73 656e 7369 7469 7665  t is insensitive
-00016de0: 2074 6f20 7468 6520 6361 7365 206f 6620   to the case of 
-00016df0: 6669 656c 6473 2061 6e64 2076 616c 7565  fields and value
-00016e00: 732e 2049 6620 6669 656c 6473 2061 7265  s. If fields are
-00016e10: 0a72 6570 6561 7465 6420 696e 2074 6865  .repeated in the
-00016e20: 2071 7565 7279 2073 7472 696e 672c 2074   query string, t
-00016e30: 6865 2071 7565 7279 2073 7472 696e 6720  he query string 
-00016e40: 7769 6c6c 2062 6520 7061 7273 6564 2077  will be parsed w
-00016e50: 6974 686f 7574 2065 7272 6f72 2e20 486f  ithout error. Ho
-00016e60: 7765 7665 722c 0a74 6865 2063 6f6e 6e65  wever,.the conne
-00016e70: 6374 696f 6e20 6f70 7469 6f6e 7320 7573  ction options us
-00016e80: 6564 2062 7920 7468 6520 636c 6965 6e74  ed by the client
-00016e90: 2077 696c 6c20 7573 6520 7468 6520 7661   will use the va
-00016ea0: 6c75 6520 6f66 2074 6865 2066 6972 7374  lue of the first
-00016eb0: 2066 6965 6c64 2e20 416c 6c0a 7468 6520   field. All.the 
-00016ec0: 6f74 6865 7220 6669 656c 642d 7661 6c75  other field-valu
-00016ed0: 6573 2069 6e20 7468 6520 7175 6572 7920  es in the query 
-00016ee0: 7374 7269 6e67 2077 6974 6820 7468 6520  string with the 
-00016ef0: 7361 6d65 2066 6965 6c64 206e 616d 6520  same field name 
-00016f00: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
-00016f10: 0a46 6965 6c64 7320 7769 7468 6f75 7420  .Fields without 
-00016f20: 7661 6c75 6573 2077 696c 6c20 616c 736f  values will also
-00016f30: 2062 6520 6967 6e6f 7265 642e 0a0a 4966   be ignored...If
-00016f40: 2074 6865 2063 6c69 656e 7427 7320 6e6f   the client's no
-00016f50: 6465 2070 7265 6665 7265 6e63 6520 6973  de preference is
-00016f60: 2022 6c65 6164 6572 2220 616e 6420 7468   "leader" and th
-00016f70: 6520 6e6f 6465 2062 6563 6f6d 6573 2061  e node becomes a
-00016f80: 0a22 666f 6c6c 6f77 6572 222c 2074 6865  ."follower", the
-00016f90: 2063 6c69 656e 7420 7769 6c6c 2061 7474   client will att
-00016fa0: 656d 7074 2074 6f20 7265 636f 6e6e 6563  empt to reconnec
-00016fb0: 7420 746f 2074 6865 2063 7572 7265 6e74  t to the current
-00016fc0: 206c 6561 6465 7220 7768 656e 2061 206d   leader when a m
-00016fd0: 6574 686f 640a 6973 2063 616c 6c65 6420  ethod.is called 
-00016fe0: 7468 6174 2065 7870 6563 7473 2074 6f20  that expects to 
-00016ff0: 6361 6c6c 2061 206c 6561 6465 722e 204d  call a leader. M
-00017000: 6574 686f 6473 2077 6869 6368 206d 7574  ethods which mut
-00017010: 6174 6520 7468 6520 7374 6174 6520 6f66  ate the state of
-00017020: 2074 6865 2064 6174 6162 6173 650a 6578   the database.ex
-00017030: 7065 6374 2074 6f20 6361 6c6c 2061 206c  pect to call a l
-00017040: 6561 6465 722e 2046 6f72 2073 7563 6820  eader. For such 
-00017050: 6d65 7468 6f64 732c 2074 6865 2048 5454  methods, the HTT
-00017060: 5020 6865 6164 6572 2272 6571 7569 7265  P header"require
-00017070: 732d 6c65 6164 6572 2220 6973 2073 6574  s-leader" is set
-00017080: 2074 6f0a 2274 7275 6522 2c20 616e 6420   to."true", and 
-00017090: 7468 6973 2068 6561 6465 7220 6973 206f  this header is o
-000170a0: 6273 6572 7665 6420 6279 2074 6865 2073  bserved by the s
-000170b0: 6572 7665 722c 2061 6e64 2073 6f20 6120  erver, and so a 
-000170c0: 6e6f 6465 2077 6869 6368 2069 7320 6e6f  node which is no
-000170d0: 7420 6120 6c65 6164 6572 0a74 6861 7420  t a leader.that 
-000170e0: 7265 6365 6976 6573 2073 7563 6820 6120  receives such a 
-000170f0: 7265 7175 6573 7420 7769 6c6c 2072 6574  request will ret
-00017100: 7572 6e20 616e 2065 7272 6f72 2e20 5468  urn an error. Th
-00017110: 6973 2065 7272 6f72 2069 7320 6465 7465  is error is dete
-00017120: 6374 6564 2062 7920 7468 6520 636c 6965  cted by the clie
-00017130: 6e74 2c0a 7768 6963 6820 7769 6c6c 2074  nt,.which will t
-00017140: 6865 6e20 636c 6f73 6520 7468 6520 6375  hen close the cu
-00017150: 7272 656e 7420 6752 5043 2063 6f6e 6e65  rrent gRPC conne
-00017160: 6374 696f 6e20 616e 6420 6372 6561 7465  ction and create
-00017170: 2061 206e 6577 2063 6f6e 6e65 6374 696f   a new connectio
-00017180: 6e20 746f 2074 6865 0a6c 6561 6465 722e  n to the.leader.
-00017190: 2054 6865 2072 6571 7565 7374 2077 696c   The request wil
-000171a0: 6c20 7468 656e 2062 6520 7265 7472 6965  l then be retrie
-000171b0: 6420 7769 7468 2074 6865 206c 6561 6465  d with the leade
-000171c0: 722e 0a0a 4966 2074 6865 2063 6c69 656e  r...If the clien
-000171d0: 7427 7320 6e6f 6465 2070 7265 6665 7265  t's node prefere
-000171e0: 6e63 6520 6973 2022 666f 6c6c 6f77 6572  nce is "follower
-000171f0: 2220 616e 6420 7468 6572 6520 6172 6520  " and there are 
-00017200: 6e6f 2066 6f6c 6c6f 7765 720a 6e6f 6465  no follower.node
-00017210: 7320 696e 2074 6865 2063 6c75 7374 6572  s in the cluster
-00017220: 2c20 7468 656e 2074 6865 2063 6c69 656e  , then the clien
-00017230: 7420 7769 6c6c 2072 6169 7365 2061 6e20  t will raise an 
-00017240: 6578 6365 7074 696f 6e2e 2053 696d 696c  exception. Simil
-00017250: 6172 6c79 2c20 6966 2074 6865 0a63 6c69  arly, if the.cli
-00017260: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
-00017270: 7265 6e63 6520 6973 2022 7265 6164 6f6e  rence is "readon
-00017280: 6c79 7265 706c 6963 6122 2061 6e64 2074  lyreplica" and t
-00017290: 6865 7265 2061 7265 206e 6f20 7265 6164  here are no read
-000172a0: 2d6f 6e6c 7920 7265 706c 6963 610a 6e6f  -only replica.no
-000172b0: 6465 7320 696e 2074 6865 2063 6c75 7374  des in the clust
-000172c0: 6572 2c20 7468 656e 2074 6865 2063 6c69  er, then the cli
-000172d0: 656e 7420 7769 6c6c 2061 6c73 6f20 7261  ent will also ra
-000172e0: 6973 6520 616e 2065 7863 6570 7469 6f6e  ise an exception
-000172f0: 2e0a 0a54 6865 2067 5250 4320 6368 616e  ...The gRPC chan
-00017300: 6e65 6c20 6f70 7469 6f6e 2022 6772 7063  nel option "grpc
-00017310: 2e6d 6178 5f72 6563 6569 7665 5f6d 6573  .max_receive_mes
-00017320: 7361 6765 5f6c 656e 6774 6822 2069 7320  sage_length" is 
-00017330: 6175 746f 6d61 7469 6361 6c6c 790a 636f  automatically.co
-00017340: 6e66 6967 7572 6564 2074 6f20 7468 6520  nfigured to the 
-00017350: 7661 6c75 6520 6031 3720 2a20 3130 3234  value `17 * 1024
-00017360: 202a 2031 3032 3460 2e20 5468 6973 2076   * 1024`. This v
-00017370: 616c 7565 2063 616e 6e6f 7420 6265 2063  alue cannot be c
-00017380: 6861 6e67 6564 2e0a 0a0a 2323 2320 5265  hanged....### Re
-00017390: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
-000173a0: 2066 696c 7465 7273 0a0a 5468 6520 6669   filters..The fi
-000173b0: 6c74 6572 2061 7267 756d 656e 7473 2069  lter arguments i
-000173c0: 6e20 6072 6561 645f 616c 6c5f 6576 656e  n `read_all_even
-000173d0: 7473 2829 602c 2060 7375 6273 6372 6962  ts()`, `subscrib
-000173e0: 655f 616c 6c5f 6576 656e 7473 2829 602c  e_all_events()`,
-000173f0: 0a60 6372 6561 7465 5f73 7562 7363 7269  .`create_subscri
-00017400: 7074 696f 6e28 2960 2061 6e64 2060 6765  ption()` and `ge
-00017410: 745f 636f 6d6d 6974 5f70 6f73 6974 696f  t_commit_positio
-00017420: 6e28 2960 2061 7265 2061 7070 6c69 6564  n()` are applied
-00017430: 2074 6f20 7468 6520 6074 7970 6560 0a61   to the `type`.a
-00017440: 7474 7269 6275 7465 206f 6620 7265 636f  ttribute of reco
-00017450: 7264 6564 2065 7665 6e74 732e 0a0a 5468  rded events...Th
-00017460: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-00017470: 6f66 2074 6865 2060 6669 6c74 6572 5f65  of the `filter_e
-00017480: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
-00017490: 7320 6973 2064 6573 6967 6e65 6420 746f  s is designed to
-000174a0: 2065 7863 6c75 6465 0a45 7665 6e74 5374   exclude.EventSt
-000174b0: 6f72 6544 4220 2273 7973 7465 6d22 2061  oreDB "system" a
-000174c0: 6e64 2022 7065 7273 6973 7465 6e63 6520  nd "persistence 
-000174d0: 7375 6273 6372 6970 7469 6f6e 2063 6f6e  subscription con
-000174e0: 6669 6722 2065 7665 6e74 732c 2077 6869  fig" events, whi
-000174f0: 6368 0a6f 7468 6572 7769 7365 2077 6f75  ch.otherwise wou
-00017500: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
-00017510: 5379 7374 656d 2065 7665 6e74 7320 6765  System events ge
-00017520: 6e65 7261 7465 6420 6279 2045 7665 6e74  nerated by Event
-00017530: 5374 6f72 6544 4220 616c 6c0a 6861 7665  StoreDB all.have
-00017540: 2060 7479 7065 6020 7374 7269 6e67 7320   `type` strings 
-00017550: 7468 6174 2073 7461 7274 2077 6974 6820  that start with 
-00017560: 7468 6520 6024 6020 7369 676e 2e20 5065  the `$` sign. Pe
-00017570: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
-00017580: 6970 7469 6f6e 0a65 7665 6e74 7320 6765  iption.events ge
-00017590: 6e65 7261 7465 6420 7768 656e 206d 616e  nerated when man
-000175a0: 6970 756c 6174 696e 6720 7065 7273 6973  ipulating persis
-000175b0: 7465 6e63 6520 7375 6273 6372 6970 7469  tence subscripti
-000175c0: 6f6e 7320 616c 6c20 6861 7665 2060 7479  ons all have `ty
-000175d0: 7065 600a 7374 7269 6e67 7320 7468 6174  pe`.strings that
-000175e0: 2073 7461 7274 2077 6974 6820 6050 6572   start with `Per
-000175f0: 7369 7374 656e 7443 6f6e 6669 6760 2e0a  sistentConfig`..
-00017600: 0a46 6f72 2065 7861 6d70 6c65 2c20 746f  .For example, to
-00017610: 206d 6174 6368 2074 6865 2074 7970 6520   match the type 
-00017620: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
-00017630: 7379 7374 656d 2065 7665 6e74 732c 2075  system events, u
-00017640: 7365 2074 6865 2072 6567 756c 6172 0a65  se the regular.e
-00017650: 7870 7265 7373 696f 6e20 6072 275c 242e  xpression `r'\$.
-00017660: 2b27 602e 2050 6c65 6173 6520 6e6f 7465  +'`. Please note
-00017670: 2c20 7468 6520 636f 6e73 7461 6e74 2060  , the constant `
-00017680: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
-00017690: 5453 5f52 4547 4558 6020 6973 0a73 6574  TS_REGEX` is.set
-000176a0: 2074 6f20 6072 275c 242e 2b27 602e 2059   to `r'\$.+'`. Y
-000176b0: 6f75 2063 616e 2069 6d70 6f72 7420 7468  ou can import th
-000176c0: 6973 2076 616c 7565 0a28 6066 726f 6d20  is value.(`from 
-000176d0: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
-000176e0: 7420 4553 4442 5f53 5953 5445 4d5f 4556  t ESDB_SYSTEM_EV
-000176f0: 454e 5453 5f52 4547 4558 6029 2061 6e64  ENTS_REGEX`) and
-00017700: 2075 7365 0a69 7420 7768 656e 2062 7569   use.it when bui
-00017710: 6c64 696e 6720 6c6f 6e67 6572 2073 6571  lding longer seq
-00017720: 7565 6e63 6573 206f 6620 7265 6775 6c61  uences of regula
-00017730: 7220 6578 7072 6573 7369 6f6e 732e 0a0a  r expressions...
-00017740: 5369 6d69 6c61 726c 792c 2074 6f20 6d61  Similarly, to ma
-00017750: 7463 6820 7468 6520 7479 7065 206f 6620  tch the type of 
-00017760: 4576 656e 7453 746f 7265 4442 2070 6572  EventStoreDB per
-00017770: 7369 7374 656e 6365 2073 7562 7363 7269  sistence subscri
-00017780: 7074 696f 6e20 6576 656e 7473 2c20 7573  ption events, us
-00017790: 6520 7468 650a 7265 6775 6c61 7220 6578  e the.regular ex
-000177a0: 7072 6573 7369 6f6e 2060 7227 5065 7273  pression `r'Pers
-000177b0: 6973 7465 6e74 436f 6e66 6967 5c64 2b27  istentConfig\d+'
-000177c0: 602e 2054 6865 2063 6f6e 7374 616e 7420  `. The constant 
-000177d0: 6045 5344 425f 5045 5253 4953 5445 4e54  `ESDB_PERSISTENT
-000177e0: 5f43 4f4e 4649 475f 4556 454e 5453 5f52  _CONFIG_EVENTS_R
-000177f0: 4547 4558 600a 6973 2073 6574 2074 6f20  EGEX`.is set to 
-00017800: 6072 2750 6572 7369 7374 656e 7443 6f6e  `r'PersistentCon
-00017810: 6669 675c 642b 2760 2e20 596f 7520 6361  fig\d+'`. You ca
-00017820: 6e20 616c 736f 2069 6d70 6f72 7420 7468  n also import th
-00017830: 6973 2076 616c 7565 0a28 6066 726f 6d20  is value.(`from 
-00017840: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
-00017850: 7420 4553 4442 5f50 4552 5349 5354 454e  t ESDB_PERSISTEN
-00017860: 545f 434f 4e46 4947 5f45 5645 4e54 535f  T_CONFIG_EVENTS_
-00017870: 5245 4745 5860 2920 616e 6420 7573 6520  REGEX`) and use 
-00017880: 6974 2077 6865 6e20 6275 696c 6469 6e67  it when building
-00017890: 0a6c 6f6e 6765 7220 7365 7175 656e 6365  .longer sequence
-000178a0: 7320 6f66 2072 6567 756c 6172 2065 7870  s of regular exp
-000178b0: 7265 7373 696f 6e73 2e0a 0a54 6865 2063  ressions...The c
-000178c0: 6f6e 7374 616e 7420 6044 4546 4155 4c54  onstant `DEFAULT
-000178d0: 5f45 5843 4c55 4445 5f46 494c 5445 5260  _EXCLUDE_FILTER`
-000178e0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
-000178f0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
-00017900: 7369 6f6e 7320 7468 6174 206d 6174 6368  sions that match
-00017910: 0a74 6865 2065 7665 6e74 7320 7468 6174  .the events that
-00017920: 2045 7665 6e74 5374 6f72 6544 4220 6765   EventStoreDB ge
-00017930: 6e65 7261 7465 7320 696e 7465 726e 616c  nerates internal
-00017940: 6c79 2c20 6576 656e 7473 2074 6861 7420  ly, events that 
-00017950: 6172 6520 6578 7472 616e 656f 7573 2074  are extraneous t
-00017960: 6f20 7468 6f73 650a 7768 6963 6820 796f  o those.which yo
-00017970: 7520 6170 7065 6e64 2075 7369 6e67 2074  u append using t
-00017980: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
-00017990: 7328 2960 206d 6574 686f 642e 0a0a 0a23  s()` method....#
-000179a0: 2323 204e 6577 2065 7665 6e74 206f 626a  ## New event obj
-000179b0: 6563 7473 0a0a 5468 6520 604e 6577 4576  ects..The `NewEv
-000179c0: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
-000179d0: 6564 2077 6865 6e20 6170 7065 6e64 696e  ed when appendin
-000179e0: 6720 6576 656e 7473 2e0a 0a54 6865 2072  g events...The r
-000179f0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-00017a00: 2060 7479 7065 6020 6973 2061 2050 7974   `type` is a Pyt
-00017a10: 686f 6e20 6073 7472 602c 2075 7365 6420  hon `str`, used 
-00017a20: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
-00017a30: 7479 7065 206f 660a 7468 6520 6576 656e  type of.the even
-00017a40: 7420 7468 6174 2077 696c 6c20 6265 2072  t that will be r
-00017a50: 6563 6f72 6465 642e 0a0a 5468 6520 7265  ecorded...The re
-00017a60: 7175 6972 6564 2061 7267 756d 656e 7420  quired argument 
-00017a70: 6064 6174 6160 2069 7320 6120 5079 7468  `data` is a Pyth
-00017a80: 6f6e 2060 6279 7465 7360 206f 626a 6563  on `bytes` objec
-00017a90: 742c 2075 7365 6420 746f 2069 6e64 6963  t, used to indic
-00017aa0: 6174 6520 7468 6520 6461 7461 206f 660a  ate the data of.
-00017ab0: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
-00017ac0: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
-00017ad0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2061  ..The optional a
-00017ae0: 7267 756d 656e 7420 606d 6574 6164 6174  rgument `metadat
-00017af0: 6160 2069 7320 6120 5079 7468 6f6e 2060  a` is a Python `
-00017b00: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
-00017b10: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00017b20: 616e 790a 6d65 7461 6461 7461 206f 6620  any.metadata of 
-00017b30: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
-00017b40: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
-00017b50: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
-00017b60: 7565 2069 7320 616e 2065 6d70 7479 2060  ue is an empty `
-00017b70: 6279 7465 7360 0a6f 626a 6563 742e 0a0a  bytes`.object...
-00017b80: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
-00017b90: 756d 656e 7420 6063 6f6e 7465 6e74 5f74  ument `content_t
-00017ba0: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
-00017bb0: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
-00017bc0: 696e 6469 6361 7465 2074 6865 0a74 7970  indicate the.typ
-00017bd0: 6520 6f66 2074 6865 2064 6174 6120 7468  e of the data th
-00017be0: 6174 2077 696c 6c20 6265 2072 6563 6f72  at will be recor
-00017bf0: 6465 6420 666f 7220 7468 6973 2065 7665  ded for this eve
-00017c00: 6e74 2e20 5468 6520 6465 6661 756c 7420  nt. The default 
-00017c10: 7661 6c75 6520 6973 0a60 6170 706c 6963  value is.`applic
-00017c20: 6174 696f 6e2f 6a73 6f6e 602c 2077 6869  ation/json`, whi
-00017c30: 6368 2069 6e64 6963 6174 6573 2074 6861  ch indicates tha
-00017c40: 7420 7468 6520 6064 6174 6160 2077 6173  t the `data` was
-00017c50: 2073 6572 6961 6c69 7365 6420 7573 696e   serialised usin
-00017c60: 6720 4a53 4f4e 2e0a 416e 2061 6c74 6572  g JSON..An alter
-00017c70: 6e61 7469 7665 2076 616c 7565 2066 6f72  native value for
-00017c80: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-00017c90: 7320 6061 7070 6c69 6361 7469 6f6e 2f6f  s `application/o
-00017ca0: 6374 6574 2d73 7472 6561 6d60 2e0a 0a54  ctet-stream`...T
-00017cb0: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
-00017cc0: 6d65 6e74 2060 6964 6020 6973 2061 2050  ment `id` is a P
-00017cd0: 7974 686f 6e20 6055 5549 4460 206f 626a  ython `UUID` obj
-00017ce0: 6563 742c 2075 7365 6420 746f 2073 7065  ect, used to spe
-00017cf0: 6369 6679 2074 6865 2075 6e69 7175 6520  cify the unique 
-00017d00: 4944 0a6f 6620 7468 6520 6576 656e 7420  ID.of the event 
-00017d10: 7468 6174 2077 696c 6c20 6265 2072 6563  that will be rec
-00017d20: 6f72 6465 642e 2054 6869 7320 7661 6c75  orded. This valu
-00017d30: 6520 7769 6c6c 2064 6566 6175 6c74 2074  e will default t
-00017d40: 6f20 6120 6e65 7720 7665 7273 696f 6e2d  o a new version-
-00017d50: 3420 5555 4944 2e0a 0a60 6060 7079 7468  4 UUID...```pyth
-00017d60: 6f6e 0a6e 6577 5f65 7665 6e74 3120 3d20  on.new_event1 = 
-00017d70: 4e65 7745 7665 6e74 280a 2020 2020 7479  NewEvent(.    ty
-00017d80: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
-00017d90: 272c 0a20 2020 2064 6174 613d 6227 7b22  ',.    data=b'{"
-00017da0: 6e61 6d65 223a 2022 4772 6567 227d 272c  name": "Greg"}',
-00017db0: 0a29 0a61 7373 6572 7420 6e65 775f 6576  .).assert new_ev
-00017dc0: 656e 7431 2e74 7970 6520 3d3d 2027 4f72  ent1.type == 'Or
-00017dd0: 6465 7243 7265 6174 6564 270a 6173 7365  derCreated'.asse
-00017de0: 7274 206e 6577 5f65 7665 6e74 312e 6461  rt new_event1.da
-00017df0: 7461 203d 3d20 6227 7b22 6e61 6d65 223a  ta == b'{"name":
-00017e00: 2022 4772 6567 227d 270a 6173 7365 7274   "Greg"}'.assert
-00017e10: 206e 6577 5f65 7665 6e74 312e 6d65 7461   new_event1.meta
-00017e20: 6461 7461 203d 3d20 6227 270a 6173 7365  data == b''.asse
-00017e30: 7274 206e 6577 5f65 7665 6e74 312e 636f  rt new_event1.co
-00017e40: 6e74 656e 745f 7479 7065 203d 3d20 2761  ntent_type == 'a
-00017e50: 7070 6c69 6361 7469 6f6e 2f6a 736f 6e27  pplication/json'
-00017e60: 0a61 7373 6572 7420 6973 696e 7374 616e  .assert isinstan
-00017e70: 6365 286e 6577 5f65 7665 6e74 312e 6964  ce(new_event1.id
-00017e80: 2c20 5555 4944 290a 0a65 7665 6e74 5f69  , UUID)..event_i
-00017e90: 6420 3d20 7575 6964 3428 290a 6e65 775f  d = uuid4().new_
-00017ea0: 6576 656e 7432 203d 204e 6577 4576 656e  event2 = NewEven
-00017eb0: 7428 0a20 2020 2074 7970 653d 2749 6d61  t(.    type='Ima
-00017ec0: 6765 4372 6561 7465 6427 2c0a 2020 2020  geCreated',.    
-00017ed0: 6461 7461 3d62 2730 3130 3130 3130 3130  data=b'010101010
-00017ee0: 3130 3130 3127 2c0a 2020 2020 6d65 7461  10101',.    meta
-00017ef0: 6461 7461 3d62 277b 2261 223a 2031 7d27  data=b'{"a": 1}'
-00017f00: 2c0a 2020 2020 636f 6e74 656e 745f 7479  ,.    content_ty
-00017f10: 7065 3d27 6170 706c 6963 6174 696f 6e2f  pe='application/
-00017f20: 6f63 7465 742d 7374 7265 616d 272c 0a20  octet-stream',. 
-00017f30: 2020 2069 643d 6576 656e 745f 6964 2c0a     id=event_id,.
-00017f40: 290a 6173 7365 7274 206e 6577 5f65 7665  ).assert new_eve
-00017f50: 6e74 322e 7479 7065 203d 3d20 2749 6d61  nt2.type == 'Ima
-00017f60: 6765 4372 6561 7465 6427 0a61 7373 6572  geCreated'.asser
-00017f70: 7420 6e65 775f 6576 656e 7432 2e64 6174  t new_event2.dat
-00017f80: 6120 3d3d 2062 2730 3130 3130 3130 3130  a == b'010101010
-00017f90: 3130 3130 3127 0a61 7373 6572 7420 6e65  10101'.assert ne
-00017fa0: 775f 6576 656e 7432 2e6d 6574 6164 6174  w_event2.metadat
-00017fb0: 6120 3d3d 2062 277b 2261 223a 2031 7d27  a == b'{"a": 1}'
-00017fc0: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
-00017fd0: 7432 2e63 6f6e 7465 6e74 5f74 7970 6520  t2.content_type 
-00017fe0: 3d3d 2027 6170 706c 6963 6174 696f 6e2f  == 'application/
-00017ff0: 6f63 7465 742d 7374 7265 616d 270a 6173  octet-stream'.as
-00018000: 7365 7274 206e 6577 5f65 7665 6e74 322e  sert new_event2.
-00018010: 6964 203d 3d20 6576 656e 745f 6964 0a60  id == event_id.`
-00018020: 6060 0a0a 2323 2320 5265 636f 7264 6564  ``..### Recorded
-00018030: 2065 7665 6e74 206f 626a 6563 7473 0a0a   event objects..
-00018040: 5468 6520 6052 6563 6f72 6465 6445 7665  The `RecordedEve
-00018050: 6e74 6020 636c 6173 7320 6973 2075 7365  nt` class is use
-00018060: 6420 7768 656e 2072 6561 6469 6e67 2065  d when reading e
-00018070: 7665 6e74 732e 0a0a 5468 6520 6174 7472  vents...The attr
-00018080: 6962 7574 6520 6074 7970 6560 2069 7320  ibute `type` is 
-00018090: 6120 5079 7468 6f6e 2060 7374 7260 2c20  a Python `str`, 
-000180a0: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-000180b0: 2074 6865 2074 7970 6520 6f66 2065 7665   the type of eve
-000180c0: 6e74 0a74 6861 7420 7761 7320 7265 636f  nt.that was reco
-000180d0: 7264 6564 2e0a 0a54 6865 2061 7474 7269  rded...The attri
-000180e0: 6275 7465 2060 6461 7461 6020 6973 2061  bute `data` is a
-000180f0: 2050 7974 686f 6e20 6062 7974 6573 6020   Python `bytes` 
-00018100: 6f62 6a65 6374 2c20 7573 6564 2074 6f20  object, used to 
-00018110: 696e 6469 6361 7465 2074 6865 2064 6174  indicate the dat
-00018120: 6120 6f66 2074 6865 0a65 7665 6e74 2074  a of the.event t
-00018130: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
-00018140: 2e0a 0a54 6865 2061 7474 7269 6275 7465  ...The attribute
-00018150: 2060 6d65 7461 6461 7461 6020 6973 2061   `metadata` is a
-00018160: 2050 7974 686f 6e20 6062 7974 6573 6020   Python `bytes` 
-00018170: 6f62 6a65 6374 2c20 7573 6564 2074 6f20  object, used to 
-00018180: 696e 6469 6361 7465 2074 6865 206d 6574  indicate the met
-00018190: 6164 6174 6120 6f66 0a74 6865 2065 7665  adata of.the eve
-000181a0: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
-000181b0: 7264 6564 2e0a 0a54 6865 2061 7474 7269  rded...The attri
-000181c0: 6275 7465 2060 636f 6e74 656e 745f 7479  bute `content_ty
-000181d0: 7065 6020 6973 2061 2050 7974 686f 6e20  pe` is a Python 
-000181e0: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
-000181f0: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
-00018200: 206f 660a 6461 7461 2074 6861 7420 7761   of.data that wa
-00018210: 7320 7265 636f 7264 6564 2066 6f72 2074  s recorded for t
-00018220: 6869 7320 6576 656e 7420 2875 7375 616c  his event (usual
-00018230: 6c79 2060 6170 706c 6963 6174 696f 6e2f  ly `application/
-00018240: 6a73 6f6e 6020 746f 2069 6e64 6963 6174  json` to indicat
-00018250: 6520 7468 6174 0a74 6869 7320 6461 7461  e that.this data
-00018260: 2063 616e 2062 6520 7061 7273 6564 2061   can be parsed a
-00018270: 7320 4a53 4f4e 2c20 6275 7420 616c 7465  s JSON, but alte
-00018280: 726e 6174 6976 656c 7920 6061 7070 6c69  rnatively `appli
-00018290: 6361 7469 6f6e 2f6f 6374 6574 2d73 7472  cation/octet-str
-000182a0: 6561 6d60 2074 6f0a 696e 6469 6361 7465  eam` to.indicate
-000182b0: 2074 6861 7420 6974 2069 7320 736f 6d65   that it is some
-000182c0: 7468 696e 6720 656c 7365 292e 0a0a 5468  thing else)...Th
-000182d0: 6520 6174 7472 6962 7574 6520 6069 6460  e attribute `id`
-000182e0: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
-000182f0: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
-00018300: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00018310: 2075 6e69 7175 6520 4944 206f 6620 7468   unique ID of th
-00018320: 650a 6576 656e 7420 7468 6174 2077 6173  e.event that was
-00018330: 2072 6563 6f72 6465 642e 2050 6c65 6173   recorded. Pleas
-00018340: 6520 6e6f 7465 2c20 7768 656e 2072 6563  e note, when rec
-00018350: 6f72 6465 6420 6576 656e 7473 2061 7265  orded events are
-00018360: 2072 6574 7572 6e65 6420 6672 6f6d 2061   returned from a
-00018370: 2063 616c 6c0a 746f 2060 7265 6164 5f73   call.to `read_s
-00018380: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
-00018390: 696e 2045 7665 6e74 5374 6f72 6544 4220  in EventStoreDB 
-000183a0: 7632 312e 3130 2c20 7468 6520 636f 6d6d  v21.10, the comm
-000183b0: 6974 2070 6f73 6974 696f 6e20 6973 206e  it position is n
-000183c0: 6f74 2061 6374 7561 6c6c 790a 7365 7420  ot actually.set 
-000183d0: 696e 2074 6865 2072 6573 706f 6e73 652e  in the response.
-000183e0: 2054 6869 7320 6174 7472 6962 7574 6520   This attribute 
-000183f0: 6973 2074 7970 6564 2061 7320 616e 206f  is typed as an o
-00018400: 7074 696f 6e61 6c20 7661 6c75 6520 2860  ptional value (`
-00018410: 4f70 7469 6f6e 616c 5b55 5549 445d 6029  Optional[UUID]`)
-00018420: 2c0a 616e 6420 696e 2074 6865 2063 6173  ,.and in the cas
-00018430: 6520 6f66 2075 7369 6e67 2045 7665 6e74  e of using Event
-00018440: 5374 6f72 6544 4220 7632 312e 3130 2074  StoreDB v21.10 t
-00018450: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
-00018460: 2061 7474 7269 6275 7465 2077 696c 6c20   attribute will 
-00018470: 6265 2060 4e6f 6e65 600a 7768 656e 2072  be `None`.when r
-00018480: 6561 6469 6e67 2072 6563 6f72 6465 6420  eading recorded 
-00018490: 6576 656e 7473 2066 726f 6d20 6120 7374  events from a st
-000184a0: 7265 616d 2e20 5265 636f 7264 6564 2065  ream. Recorded e
-000184b0: 7665 6e74 7320 7769 6c6c 2068 6f77 6576  vents will howev
-000184c0: 6572 2068 6176 6520 7468 6973 0a76 616c  er have this.val
-000184d0: 7565 7320 7365 7420 7768 656e 2072 6561  ues set when rea
-000184e0: 6469 6e67 2072 6563 6f72 6465 6420 6576  ding recorded ev
-000184f0: 656e 7473 2066 726f 6d20 6072 6561 645f  ents from `read_
-00018500: 616c 6c5f 6576 656e 7473 2829 6020 616e  all_events()` an
-00018510: 6420 6672 6f6d 2062 6f74 680a 6361 7463  d from both.catc
-00018520: 682d 7570 2061 6e64 2070 6572 7369 7374  h-up and persist
-00018530: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00018540: 732e 0a0a 5468 6520 6174 7472 6962 7574  s...The attribut
-00018550: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
-00018560: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
-00018570: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
-00018580: 6174 6520 7468 6520 6e61 6d65 206f 6620  ate the name of 
-00018590: 7468 650a 7374 7265 616d 2069 6e20 7768  the.stream in wh
-000185a0: 6963 6820 7468 6520 6576 656e 7420 7761  ich the event wa
-000185b0: 7320 7265 636f 7264 6564 2e0a 0a54 6865  s recorded...The
-000185c0: 2061 7474 7269 6275 7465 2060 7374 7265   attribute `stre
-000185d0: 616d 5f70 6f73 6974 696f 6e60 2069 7320  am_position` is 
-000185e0: 6120 5079 7468 6f6e 2060 696e 7460 2c20  a Python `int`, 
-000185f0: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-00018600: 2074 6865 2070 6f73 6974 696f 6e20 696e   the position in
-00018610: 2074 6865 0a73 7472 6561 6d20 6174 2077   the.stream at w
-00018620: 6869 6368 2074 6865 2065 7665 6e74 2077  hich the event w
-00018630: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
-00018640: 6520 6174 7472 6962 7574 6520 6063 6f6d  e attribute `com
-00018650: 6d69 745f 706f 7369 7469 6f6e 6020 6973  mit_position` is
-00018660: 2061 2050 7974 686f 6e20 6069 6e74 602c   a Python `int`,
-00018670: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-00018680: 6520 7468 6520 636f 6d6d 6974 2070 6f73  e the commit pos
-00018690: 6974 696f 6e0a 6174 2077 6869 6368 2074  ition.at which t
-000186a0: 6865 2065 7665 6e74 2077 6173 2072 6563  he event was rec
-000186b0: 6f72 6465 642e 0a0a 6060 6070 7974 686f  orded...```pytho
-000186c0: 6e0a 6672 6f6d 2065 7364 6263 6c69 656e  n.from esdbclien
-000186d0: 742e 6576 656e 7473 2069 6d70 6f72 7420  t.events import 
-000186e0: 5265 636f 7264 6564 4576 656e 740a 0a72  RecordedEvent..r
-000186f0: 6563 6f72 6465 645f 6576 656e 7420 3d20  ecorded_event = 
-00018700: 5265 636f 7264 6564 4576 656e 7428 0a20  RecordedEvent(. 
-00018710: 2020 2074 7970 653d 274f 7264 6572 4372     type='OrderCr
-00018720: 6561 7465 6427 2c0a 2020 2020 6461 7461  eated',.    data
-00018730: 3d62 277b 7d27 2c0a 2020 2020 6d65 7461  =b'{}',.    meta
-00018740: 6461 7461 3d62 2727 2c0a 2020 2020 636f  data=b'',.    co
-00018750: 6e74 656e 745f 7479 7065 3d27 6170 706c  ntent_type='appl
-00018760: 6963 6174 696f 6e2f 6a73 6f6e 272c 0a20  ication/json',. 
-00018770: 2020 2069 643d 7575 6964 3428 292c 0a20     id=uuid4(),. 
-00018780: 2020 2073 7472 6561 6d5f 6e61 6d65 3d27     stream_name='
-00018790: 7374 7265 616d 3127 2c0a 2020 2020 7374  stream1',.    st
-000187a0: 7265 616d 5f70 6f73 6974 696f 6e3d 302c  ream_position=0,
-000187b0: 0a20 2020 2063 6f6d 6d69 745f 706f 7369  .    commit_posi
-000187c0: 7469 6f6e 3d35 3132 2c0a 290a 6060 600a  tion=512,.).```.
-000187d0: 0a23 2323 2041 7379 6e63 696f 2063 6c69  .### Asyncio cli
-000187e0: 656e 740a 0a54 6865 2060 6573 6462 636c  ent..The `esdbcl
-000187f0: 6965 6e74 6020 7061 636b 6167 6520 616c  ient` package al
-00018800: 736f 2069 6e63 6c75 6465 7320 616e 2065  so includes an e
-00018810: 6172 6c79 2076 6572 7369 6f6e 206f 6620  arly version of 
-00018820: 616e 2061 7379 6e63 6872 6f6e 6f75 7320  an asynchronous 
-00018830: 492f 4f0a 6752 5043 2050 7974 686f 6e20  I/O.gRPC Python 
-00018840: 636c 6965 6e74 2e20 4974 2066 6f6c 6c6f  client. It follo
-00018850: 7773 2065 7861 6374 6c79 2074 6865 2073  ws exactly the s
-00018860: 616d 6520 6265 6861 7669 6f72 7320 6173  ame behaviors as
-00018870: 2074 6865 206d 756c 7469 7468 7265 6164   the multithread
-00018880: 6564 0a60 4553 4442 436c 6965 6e74 602c  ed.`ESDBClient`,
-00018890: 2062 7574 2075 7365 7320 7468 6520 6067   but uses the `g
-000188a0: 7270 632e 6169 6f60 2070 6163 6b61 6765  rpc.aio` package
-000188b0: 2061 6e64 2074 6865 2060 6173 796e 6369   and the `asynci
-000188c0: 6f60 206d 6f64 756c 652c 2069 6e73 7465  o` module, inste
-000188d0: 6164 206f 660a 6067 7270 6360 2061 6e64  ad of.`grpc` and
-000188e0: 2060 7468 7265 6164 696e 6760 2e0a 0a54   `threading`...T
-000188f0: 6865 2060 6173 796e 6360 2066 756e 6374  he `async` funct
-00018900: 696f 6e20 6041 7379 6e63 696f 4553 4442  ion `AsyncioESDB
-00018910: 436c 6965 6e74 6020 636f 6e73 7472 7563  Client` construc
-00018920: 7473 2074 6865 2063 6c69 656e 742c 2061  ts the client, a
-00018930: 6e64 2063 6f6e 6e65 6374 7320 746f 0a61  nd connects to.a
-00018940: 2073 6572 7665 722e 2049 7420 6361 6e20   server. It can 
-00018950: 6265 2069 6d70 6f72 7465 6420 6672 6f6d  be imported from
-00018960: 2060 6573 6462 636c 6965 6e74 602c 2061   `esdbclient`, a
-00018970: 6e64 2063 616e 2062 6520 6361 6c6c 6564  nd can be called
-00018980: 2077 6974 6820 7468 6520 7361 6d65 0a61   with the same.a
-00018990: 7267 756d 656e 7473 2061 7320 6045 5344  rguments as `ESD
-000189a0: 4243 6c69 656e 7460 2e20 4974 2073 7570  BClient`. It sup
-000189b0: 706f 7274 7320 626f 7468 2074 6865 2022  ports both the "
-000189c0: 6573 6462 2220 616e 6420 7468 6520 2265  esdb" and the "e
-000189d0: 7364 622b 6469 7363 6f76 6572 220a 636f  sdb+discover".co
-000189e0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
-000189f0: 5552 4920 7363 6865 6d65 732c 2061 6e64  URI schemes, and
-00018a00: 2072 6563 6f6e 6e65 6374 7320 616e 6420   reconnects and 
-00018a10: 7265 7472 6965 7320 6d65 7468 6f64 7320  retries methods 
-00018a20: 7768 656e 2063 6f6e 6e65 6374 696f 6e0a  when connection.
-00018a30: 6973 7375 6573 2061 7265 2065 6e63 6f75  issues are encou
-00018a40: 6e74 6572 6564 2c20 6a75 7374 206c 696b  ntered, just lik
-00018a50: 6520 6045 5344 4243 6c69 656e 7460 2e0a  e `ESDBClient`..
-00018a60: 0a60 6060 7079 7468 6f6e 0a66 726f 6d20  .```python.from 
-00018a70: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
-00018a80: 7420 4173 796e 6369 6f45 5344 4243 6c69  t AsyncioESDBCli
-00018a90: 656e 740a 6060 600a 0a54 6865 2061 7379  ent.```..The asy
-00018aa0: 6e63 6872 6f6e 6f75 7320 492f 4f20 636c  nchronous I/O cl
-00018ab0: 6965 6e74 2068 6173 2060 6173 796e 6360  ient has `async`
-00018ac0: 206d 6574 686f 6473 2060 6170 7065 6e64   methods `append
-00018ad0: 5f65 7665 6e74 7328 2960 2c0a 6072 6561  _events()`,.`rea
-00018ae0: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00018af0: 2960 2c20 6072 6561 645f 616c 6c5f 6576  )`, `read_all_ev
-00018b00: 656e 7473 2829 602c 2060 7375 6273 6372  ents()`, `subscr
-00018b10: 6962 655f 616c 6c5f 6576 656e 7473 2829  ibe_all_events()
-00018b20: 602c 0a60 6465 6c65 7465 5f73 7472 6561  `,.`delete_strea
-00018b30: 6d28 2960 2c20 6074 6f6d 6273 746f 6e65  m()`, `tombstone
-00018b40: 5f73 7472 6561 6d28 2960 2c20 616e 6420  _stream()`, and 
-00018b50: 6072 6563 6f6e 6e65 6374 2829 602e 0a0a  `reconnect()`...
-00018b60: 5468 6573 6520 6d65 7468 6f64 7320 6172  These methods ar
-00018b70: 6520 6571 7569 7661 6c65 6e74 2074 6f20  e equivalent to 
-00018b80: 7468 6520 6d65 7468 6f64 7320 6f6e 2060  the methods on `
-00018b90: 4553 4442 436c 6965 6e74 602e 2054 6865  ESDBClient`. The
-00018ba0: 7920 6861 7665 2074 6865 2073 616d 650a  y have the same.
-00018bb0: 6d65 7468 6f64 2073 6967 6e61 7475 7265  method signature
-00018bc0: 732c 2061 6e64 2063 616e 2062 6520 6361  s, and can be ca
-00018bd0: 6c6c 6564 2077 6974 6820 7468 6520 7361  lled with the sa
-00018be0: 6d65 2061 7267 756d 656e 7473 2c20 746f  me arguments, to
-00018bf0: 2074 6865 2073 616d 6520 6566 6665 6374   the same effect
-00018c00: 2e0a 5468 6520 6d65 7468 6f64 7320 7768  ..The methods wh
-00018c10: 6963 6820 6170 7065 6172 206f 6e20 6045  ich appear on `E
-00018c20: 5344 4243 6c69 656e 7460 2062 7574 206e  SDBClient` but n
-00018c30: 6f74 206f 6e20 6041 7379 6e63 696f 4553  ot on `AsyncioES
-00018c40: 4442 436c 6965 6e74 6020 7769 6c6c 2062  DBClient` will b
-00018c50: 650a 6164 6465 6420 736f 6f6e 2e0a 0a54  e.added soon...T
-00018c60: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00018c70: 2064 656d 6f6e 7374 7261 7465 7320 7468   demonstrates th
-00018c80: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
-00018c90: 2829 602c 2060 7265 6164 5f73 7472 6561  ()`, `read_strea
-00018ca0: 6d5f 6576 656e 7473 2829 6020 616e 640a  m_events()` and.
-00018cb0: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
-00018cc0: 7665 6e74 7328 2960 206d 6574 686f 6473  vents()` methods
-00018cd0: 2e20 5468 6573 6520 6172 6520 7468 6520  . These are the 
-00018ce0: 6d6f 7374 2075 7365 6675 6c20 6d65 7468  most useful meth
-00018cf0: 6f64 7320 666f 7220 7772 6974 696e 670a  ods for writing.
-00018d00: 616e 2065 7665 6e74 2d73 6f75 7263 6564  an event-sourced
-00018d10: 2061 7070 6c69 6361 7469 6f6e 2c20 616c   application, al
-00018d20: 6c6f 7769 6e67 206e 6577 2061 6767 7265  lowing new aggre
-00018d30: 6761 7465 2065 7665 6e74 7320 746f 2062  gate events to b
-00018d40: 6520 7265 636f 7264 6564 2c20 7468 650a  e recorded, the.
-00018d50: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-00018d60: 6f66 2061 6e20 6167 6772 6567 6174 6520  of an aggregate 
-00018d70: 746f 2062 6520 6f62 7461 696e 6564 2073  to be obtained s
-00018d80: 6f20 6167 6772 6567 6174 6573 2063 616e  o aggregates can
-00018d90: 2062 6520 7265 636f 6e73 7472 7563 7465   be reconstructe
-00018da0: 642c 0a61 6e64 2074 6865 2073 7461 7465  d,.and the state
-00018db0: 206f 6620 616e 2061 7070 6c69 6361 7469   of an applicati
-00018dc0: 6f6e 2074 6f20 7072 6f70 6167 6174 6564  on to propagated
-00018dd0: 2061 6e64 2070 726f 6365 7373 6564 2077   and processed w
-00018de0: 6974 6820 2265 7861 6374 6c79 2d6f 6e63  ith "exactly-onc
-00018df0: 6522 0a73 656d 616e 7469 6373 2e0a 0a60  e".semantics...`
-00018e00: 6060 7079 7468 6f6e 0a69 6d70 6f72 7420  ``python.import 
-00018e10: 6173 796e 6369 6f0a 0a61 7379 6e63 2064  asyncio..async d
-00018e20: 6566 2064 656d 6f6e 7374 7261 7465 5f61  ef demonstrate_a
-00018e30: 7379 6e63 696f 5f63 6c69 656e 7428 293a  syncio_client():
-00018e40: 0a0a 2020 2020 2320 436f 6e73 7472 7563  ..    # Construc
-00018e50: 7420 636c 6965 6e74 2e0a 2020 2020 636c  t client..    cl
-00018e60: 6965 6e74 203d 2061 7761 6974 2041 7379  ient = await Asy
-00018e70: 6e63 696f 4553 4442 436c 6965 6e74 280a  ncioESDBClient(.
-00018e80: 2020 2020 2020 2020 7572 693d 6f73 2e67          uri=os.g
-00018e90: 6574 656e 7628 2245 5344 425f 5552 4922  etenv("ESDB_URI"
-00018ea0: 292c 0a20 2020 2020 2020 2072 6f6f 745f  ),.        root_
-00018eb0: 6365 7274 6966 6963 6174 6573 3d6f 732e  certificates=os.
-00018ec0: 6765 7465 6e76 2822 4553 4442 5f52 4f4f  getenv("ESDB_ROO
-00018ed0: 545f 4345 5254 4946 4943 4154 4553 2229  T_CERTIFICATES")
-00018ee0: 2c0a 2020 2020 290a 0a20 2020 2023 2041  ,.    )..    # A
-00018ef0: 7070 656e 6420 6576 656e 7473 2e0a 2020  ppend events..  
-00018f00: 2020 7374 7265 616d 5f6e 616d 6520 3d20    stream_name = 
-00018f10: 7374 7228 7575 6964 3428 2929 0a20 2020  str(uuid4()).   
-00018f20: 2065 7665 6e74 3120 3d20 4e65 7745 7665   event1 = NewEve
-00018f30: 6e74 2822 4f72 6465 7243 7265 6174 6564  nt("OrderCreated
-00018f40: 222c 2064 6174 613d 6227 7b7d 2729 0a20  ", data=b'{}'). 
-00018f50: 2020 2065 7665 6e74 3220 3d20 4e65 7745     event2 = NewE
-00018f60: 7665 6e74 2822 4f72 6465 7255 7064 6174  vent("OrderUpdat
-00018f70: 6564 222c 2064 6174 613d 6227 7b7d 2729  ed", data=b'{}')
-00018f80: 0a20 2020 2065 7665 6e74 3320 3d20 4e65  .    event3 = Ne
-00018f90: 7745 7665 6e74 2822 4f72 6465 7244 656c  wEvent("OrderDel
-00018fa0: 6574 6564 222c 2064 6174 613d 6227 7b7d  eted", data=b'{}
-00018fb0: 2729 0a0a 2020 2020 6177 6169 7420 636c  ')..    await cl
-00018fc0: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-00018fd0: 7473 280a 2020 2020 2020 2020 7374 7265  ts(.        stre
-00018fe0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00018ff0: 616d 652c 0a20 2020 2020 2020 2065 7870  ame,.        exp
-00019000: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
-00019010: 6f6e 652c 0a20 2020 2020 2020 2065 7665  one,.        eve
-00019020: 6e74 733d 5b65 7665 6e74 312c 2065 7665  nts=[event1, eve
-00019030: 6e74 322c 2065 7665 6e74 335d 0a20 2020  nt2, event3].   
-00019040: 2029 0a0a 2020 2020 2320 5265 6164 2073   )..    # Read s
-00019050: 7472 6561 6d20 6576 656e 7473 2e0a 2020  tream events..  
-00019060: 2020 7265 636f 7264 6564 203d 2061 7761    recorded = awa
-00019070: 6974 2063 6c69 656e 742e 7265 6164 5f73  it client.read_s
-00019080: 7472 6561 6d5f 6576 656e 7473 2873 7472  tream_events(str
-00019090: 6561 6d5f 6e61 6d65 290a 2020 2020 6173  eam_name).    as
-000190a0: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
-000190b0: 6429 203d 3d20 330a 2020 2020 6173 7365  d) == 3.    asse
-000190c0: 7274 2072 6563 6f72 6465 645b 305d 2e69  rt recorded[0].i
-000190d0: 6420 3d3d 2065 7665 6e74 312e 6964 0a20  d == event1.id. 
-000190e0: 2020 2061 7373 6572 7420 7265 636f 7264     assert record
-000190f0: 6564 5b31 5d2e 6964 203d 3d20 6576 656e  ed[1].id == even
-00019100: 7432 2e69 640a 2020 2020 6173 7365 7274  t2.id.    assert
-00019110: 2072 6563 6f72 6465 645b 325d 2e69 6420   recorded[2].id 
-00019120: 3d3d 2065 7665 6e74 332e 6964 0a0a 0a20  == event3.id... 
-00019130: 2020 2023 2053 7562 7363 7269 6265 2061     # Subscribe a
-00019140: 6c6c 2065 7665 6e74 732e 0a20 2020 2072  ll events..    r
-00019150: 6563 6569 7665 6420 3d20 5b5d 0a20 2020  eceived = [].   
-00019160: 2061 7379 6e63 2066 6f72 2065 7665 6e74   async for event
-00019170: 2069 6e20 6177 6169 7420 636c 6965 6e74   in await client
-00019180: 2e73 7562 7363 7269 6265 5f61 6c6c 5f65  .subscribe_all_e
-00019190: 7665 6e74 7328 293a 0a20 2020 2020 2020  vents():.       
-000191a0: 2072 6563 6569 7665 642e 6170 7065 6e64   received.append
-000191b0: 2865 7665 6e74 290a 2020 2020 2020 2020  (event).        
-000191c0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
-000191d0: 7665 6e74 332e 6964 3a0a 2020 2020 2020  vent3.id:.      
-000191e0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-000191f0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00019200: 2d33 5d2e 6964 203d 3d20 6576 656e 7431  -3].id == event1
-00019210: 2e69 640a 2020 2020 6173 7365 7274 2072  .id.    assert r
-00019220: 6563 6569 7665 645b 2d32 5d2e 6964 203d  eceived[-2].id =
-00019230: 3d20 6576 656e 7432 2e69 640a 2020 2020  = event2.id.    
-00019240: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00019250: 2d31 5d2e 6964 203d 3d20 6576 656e 7433  -1].id == event3
-00019260: 2e69 640a 0a0a 2020 2020 2320 436c 6f73  .id...    # Clos
-00019270: 6520 7468 6520 636c 6965 6e74 2e0a 2020  e the client..  
-00019280: 2020 6177 6169 7420 636c 6965 6e74 2e63    await client.c
-00019290: 6c6f 7365 2829 0a0a 0a23 2052 756e 2074  lose()...# Run t
-000192a0: 6865 2064 656d 6f2e 0a61 7379 6e63 696f  he demo..asyncio
-000192b0: 2e67 6574 5f65 7665 6e74 5f6c 6f6f 7028  .get_event_loop(
-000192c0: 292e 7275 6e5f 756e 7469 6c5f 636f 6d70  ).run_until_comp
-000192d0: 6c65 7465 280a 2020 2020 6465 6d6f 6e73  lete(.    demons
-000192e0: 7472 6174 655f 6173 796e 6369 6f5f 636c  trate_asyncio_cl
-000192f0: 6965 6e74 2829 0a29 0a60 6060 0a0a 2323  ient().).```..##
-00019300: 2043 6f6e 7472 6962 7574 6f72 730a 0a23   Contributors..#
-00019310: 2323 2049 6e73 7461 6c6c 2050 6f65 7472  ## Install Poetr
-00019320: 790a 0a54 6865 2066 6972 7374 2074 6869  y..The first thi
-00019330: 6e67 2069 7320 746f 2063 6865 636b 2079  ng is to check y
-00019340: 6f75 2068 6176 6520 506f 6574 7279 2069  ou have Poetry i
-00019350: 6e73 7461 6c6c 6564 2e0a 0a20 2020 2024  nstalled...    $
-00019360: 2070 6f65 7472 7920 2d2d 7665 7273 696f   poetry --versio
-00019370: 6e0a 0a49 6620 796f 7520 646f 6e27 742c  n..If you don't,
-00019380: 2074 6865 6e20 706c 6561 7365 205b 696e   then please [in
-00019390: 7374 616c 6c20 506f 6574 7279 5d28 6874  stall Poetry](ht
-000193a0: 7470 733a 2f2f 7079 7468 6f6e 2d70 6f65  tps://python-poe
-000193b0: 7472 792e 6f72 672f 646f 6373 2f23 696e  try.org/docs/#in
-000193c0: 7374 616c 6c69 6e67 2d77 6974 682d 7468  stalling-with-th
-000193d0: 652d 6f66 6669 6369 616c 2d69 6e73 7461  e-official-insta
-000193e0: 6c6c 6572 292e 0a0a 2020 2020 2420 6375  ller)...    $ cu
-000193f0: 726c 202d 7353 4c20 6874 7470 733a 2f2f  rl -sSL https://
-00019400: 696e 7374 616c 6c2e 7079 7468 6f6e 2d70  install.python-p
-00019410: 6f65 7472 792e 6f72 6720 7c20 7079 7468  oetry.org | pyth
-00019420: 6f6e 3320 2d0a 0a49 7420 7769 6c6c 2068  on3 -..It will h
-00019430: 656c 7020 746f 206d 616b 6520 7375 7265  elp to make sure
-00019440: 2050 6f65 7472 7927 7320 6269 6e20 6469   Poetry's bin di
-00019450: 7265 6374 6f72 7920 6973 2069 6e20 796f  rectory is in yo
-00019460: 7572 2060 5041 5448 6020 656e 7669 726f  ur `PATH` enviro
-00019470: 6e6d 656e 7420 7661 7269 6162 6c65 2e0a  nment variable..
-00019480: 0a42 7574 2069 6e20 616e 7920 6361 7365  .But in any case
-00019490: 2c20 6d61 6b65 2073 7572 6520 796f 7520  , make sure you 
-000194a0: 6b6e 6f77 2074 6865 2070 6174 6820 746f  know the path to
-000194b0: 2074 6865 2060 706f 6574 7279 6020 6578   the `poetry` ex
-000194c0: 6563 7574 6162 6c65 2e20 5468 6520 506f  ecutable. The Po
-000194d0: 6574 7279 0a69 6e73 7461 6c6c 6572 2074  etry.installer t
-000194e0: 656c 6c73 2079 6f75 2077 6865 7265 2069  ells you where i
-000194f0: 7420 6861 7320 6265 656e 2069 6e73 7461  t has been insta
-00019500: 6c6c 6564 2c20 616e 6420 686f 7720 746f  lled, and how to
-00019510: 2063 6f6e 6669 6775 7265 2079 6f75 7220   configure your 
-00019520: 7368 656c 6c2e 0a0a 506c 6561 7365 2072  shell...Please r
-00019530: 6566 6572 2074 6f20 7468 6520 5b50 6f65  efer to the [Poe
-00019540: 7472 7920 646f 6373 5d28 6874 7470 733a  try docs](https:
-00019550: 2f2f 7079 7468 6f6e 2d70 6f65 7472 792e  //python-poetry.
-00019560: 6f72 672f 646f 6373 2f29 2066 6f72 2067  org/docs/) for g
-00019570: 7569 6461 6e63 6520 6f6e 0a75 7369 6e67  uidance on.using
-00019580: 2050 6f65 7472 792e 0a0a 2323 2320 5365   Poetry...### Se
-00019590: 7475 7020 666f 7220 5079 4368 6172 6d20  tup for PyCharm 
-000195a0: 7573 6572 730a 0a59 6f75 2063 616e 2065  users..You can e
-000195b0: 6173 696c 7920 6f62 7461 696e 2074 6865  asily obtain the
-000195c0: 2070 726f 6a65 6374 2066 696c 6573 2075   project files u
-000195d0: 7369 6e67 2050 7943 6861 726d 2028 6d65  sing PyCharm (me
-000195e0: 6e75 2022 4769 7420 3e20 436c 6f6e 652e  nu "Git > Clone.
-000195f0: 2e2e 2229 2e0a 5079 4368 6172 6d20 7769  ..")..PyCharm wi
-00019600: 6c6c 2074 6865 6e20 7573 7561 6c6c 7920  ll then usually 
-00019610: 7072 6f6d 7074 2079 6f75 2074 6f20 6f70  prompt you to op
-00019620: 656e 2074 6865 2070 726f 6a65 6374 2e0a  en the project..
-00019630: 0a4f 7065 6e20 7468 6520 7072 6f6a 6563  .Open the projec
-00019640: 7420 696e 2061 206e 6577 2077 696e 646f  t in a new windo
-00019650: 772e 2050 7943 6861 726d 2077 696c 6c20  w. PyCharm will 
-00019660: 7468 656e 2075 7375 616c 6c79 2070 726f  then usually pro
-00019670: 6d70 7420 796f 7520 746f 2063 7265 6174  mpt you to creat
-00019680: 650a 6120 6e65 7720 7669 7274 7561 6c20  e.a new virtual 
-00019690: 656e 7669 726f 6e6d 656e 742e 0a0a 4372  environment...Cr
-000196a0: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
-000196b0: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
-000196c0: 6e6d 656e 7420 666f 7220 7468 6520 7072  nment for the pr
-000196d0: 6f6a 6563 742e 2049 6620 5079 4368 6172  oject. If PyChar
-000196e0: 6d20 646f 6573 6e27 7420 616c 7265 6164  m doesn't alread
-000196f0: 790a 6b6e 6f77 2077 6865 7265 2079 6f75  y.know where you
-00019700: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
-00019710: 7461 626c 6520 6973 2c20 7468 656e 2073  table is, then s
-00019720: 6574 2074 6865 2070 6174 6820 746f 2079  et the path to y
-00019730: 6f75 7220 6070 6f65 7472 7960 2065 7865  our `poetry` exe
-00019740: 6375 7461 626c 650a 696e 2074 6865 2022  cutable.in the "
-00019750: 4e65 7720 506f 6574 7279 2045 6e76 6972  New Poetry Envir
-00019760: 6f6e 6d65 6e74 2220 666f 726d 2069 6e70  onment" form inp
-00019770: 7574 2066 6965 6c64 206c 6162 656c 6c65  ut field labelle
-00019780: 6420 2250 6f65 7472 7920 6578 6563 7574  d "Poetry execut
-00019790: 6162 6c65 222e 2049 6e20 7468 650a 224e  able". In the."N
-000197a0: 6577 2050 6f65 7472 7920 456e 7669 726f  ew Poetry Enviro
-000197b0: 6e6d 656e 7422 2066 6f72 6d2c 2079 6f75  nment" form, you
-000197c0: 2077 696c 6c20 616c 736f 2068 6176 6520   will also have 
-000197d0: 7468 6520 6f70 706f 7274 756e 6974 7920  the opportunity 
-000197e0: 746f 2073 656c 6563 7420 7768 6963 680a  to select which.
-000197f0: 5079 7468 6f6e 2065 7865 6375 7461 626c  Python executabl
-00019800: 6520 7769 6c6c 2062 6520 7573 6564 2062  e will be used b
-00019810: 7920 7468 6520 7669 7274 7561 6c20 656e  y the virtual en
-00019820: 7669 726f 6e6d 656e 742e 0a0a 5079 4368  vironment...PyCh
-00019830: 6172 6d20 7769 6c6c 2074 6865 6e20 6372  arm will then cr
-00019840: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
-00019850: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
-00019860: 6e6d 656e 7420 666f 7220 796f 7572 2070  nment for your p
-00019870: 726f 6a65 6374 2c20 7573 696e 670a 6120  roject, using.a 
-00019880: 7061 7274 6963 756c 6172 2076 6572 7369  particular versi
-00019890: 6f6e 206f 6620 5079 7468 6f6e 2c20 616e  on of Python, an
-000198a0: 6420 616c 736f 2069 6e73 7461 6c6c 2069  d also install i
-000198b0: 6e74 6f20 7468 6973 2076 6972 7475 616c  nto this virtual
-000198c0: 2065 6e76 6972 6f6e 6d65 6e74 2074 6865   environment the
-000198d0: 0a70 726f 6a65 6374 2773 2070 6163 6b61  .project's packa
-000198e0: 6765 2064 6570 656e 6465 6e63 6965 7320  ge dependencies 
-000198f0: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
-00019900: 2070 726f 6a65 6374 2773 2060 706f 6574   project's `poet
-00019910: 7279 2e6c 6f63 6b60 2066 696c 652e 0a0a  ry.lock` file...
-00019920: 596f 7520 6361 6e20 6164 6420 6469 6666  You can add diff
-00019930: 6572 656e 7420 506f 6574 7279 2065 6e76  erent Poetry env
-00019940: 6972 6f6e 6d65 6e74 7320 666f 7220 6469  ironments for di
-00019950: 6666 6572 656e 7420 5079 7468 6f6e 2076  fferent Python v
-00019960: 6572 7369 6f6e 732c 2061 6e64 2073 7769  ersions, and swi
-00019970: 7463 680a 6265 7477 6565 6e20 7468 656d  tch.between them
-00019980: 2075 7369 6e67 2074 6865 2022 5079 7468   using the "Pyth
-00019990: 6f6e 2049 6e74 6572 7072 6574 6572 2220  on Interpreter" 
-000199a0: 7365 7474 696e 6773 206f 6620 5079 4368  settings of PyCh
-000199b0: 6172 6d2e 2049 6620 796f 7520 7761 6e74  arm. If you want
-000199c0: 2074 6f20 7573 650a 6120 7665 7273 696f   to use.a versio
-000199d0: 6e20 6f66 2050 7974 686f 6e20 7468 6174  n of Python that
-000199e0: 2069 736e 2774 2069 6e73 7461 6c6c 6564   isn't installed
-000199f0: 2c20 6569 7468 6572 2075 7365 2079 6f75  , either use you
-00019a00: 7220 6661 766f 7572 6974 6520 7061 636b  r favourite pack
-00019a10: 6167 6520 6d61 6e61 6765 722c 0a6f 7220  age manager,.or 
-00019a20: 696e 7374 616c 6c20 5079 7468 6f6e 2062  install Python b
-00019a30: 7920 646f 776e 6c6f 6164 696e 6720 616e  y downloading an
-00019a40: 2069 6e73 7461 6c6c 6572 2066 6f72 2072   installer for r
-00019a50: 6563 656e 7420 7665 7273 696f 6e73 206f  ecent versions o
-00019a60: 6620 5079 7468 6f6e 2064 6972 6563 746c  f Python directl
-00019a70: 790a 6672 6f6d 2074 6865 205b 5079 7468  y.from the [Pyth
-00019a80: 6f6e 2077 6562 7369 7465 5d28 6874 7470  on website](http
-00019a90: 733a 2f2f 7777 772e 7079 7468 6f6e 2e6f  s://www.python.o
-00019aa0: 7267 2f64 6f77 6e6c 6f61 6473 2f29 2e0a  rg/downloads/)..
-00019ab0: 0a4f 6e63 6520 7072 6f6a 6563 7420 6465  .Once project de
-00019ac0: 7065 6e64 656e 6369 6573 2068 6176 6520  pendencies have 
-00019ad0: 6265 656e 2069 6e73 7461 6c6c 6564 2c20  been installed, 
-00019ae0: 796f 7520 7368 6f75 6c64 2062 6520 6162  you should be ab
-00019af0: 6c65 2074 6f20 7275 6e20 7465 7374 730a  le to run tests.
-00019b00: 6672 6f6d 2077 6974 6869 6e20 5079 4368  from within PyCh
-00019b10: 6172 6d20 2872 6967 6874 2d63 6c69 636b  arm (right-click
-00019b20: 206f 6e20 7468 6520 6074 6573 7473 6020   on the `tests` 
-00019b30: 666f 6c64 6572 2061 6e64 2073 656c 6563  folder and selec
-00019b40: 7420 7468 6520 2752 756e 2720 6f70 7469  t the 'Run' opti
-00019b50: 6f6e 292e 0a0a 4265 6361 7573 6520 6f66  on)...Because of
-00019b60: 2061 2063 6f6e 666c 6963 7420 6265 7477   a conflict betw
-00019b70: 6565 6e20 7079 7465 7374 2061 6e64 2050  een pytest and P
-00019b80: 7943 6861 726d 2773 2064 6562 7567 6765  yCharm's debugge
-00019b90: 7220 616e 6420 7468 6520 636f 7665 7261  r and the covera
-00019ba0: 6765 2074 6f6f 6c2c 0a79 6f75 206d 6179  ge tool,.you may
-00019bb0: 206e 6565 6420 746f 2061 6464 2060 602d   need to add ``-
-00019bc0: 2d6e 6f2d 636f 7660 6020 6173 2061 6e20  -no-cov`` as an 
-00019bd0: 6f70 7469 6f6e 2074 6f20 7468 6520 7465  option to the te
-00019be0: 7374 2072 756e 6e65 7220 7465 6d70 6c61  st runner templa
-00019bf0: 7465 2e20 416c 7465 726e 6174 6976 656c  te. Alternativel
-00019c00: 792c 0a6a 7573 7420 7573 6520 7468 6520  y,.just use the 
-00019c10: 5079 7468 6f6e 2053 7461 6e64 6172 6420  Python Standard 
-00019c20: 4c69 6272 6172 7927 7320 6060 756e 6974  Library's ``unit
-00019c30: 7465 7374 6060 206d 6f64 756c 652e 0a0a  test`` module...
-00019c40: 596f 7520 7368 6f75 6c64 2061 6c73 6f20  You should also 
-00019c50: 6265 2061 626c 6520 746f 206f 7065 6e20  be able to open 
-00019c60: 6120 7465 726d 696e 616c 2077 696e 646f  a terminal windo
-00019c70: 7720 696e 2050 7943 6861 726d 2c20 616e  w in PyCharm, an
-00019c80: 6420 7275 6e20 7468 6520 7072 6f6a 6563  d run the projec
-00019c90: 7427 730a 4d61 6b65 6669 6c65 2063 6f6d  t's.Makefile com
-00019ca0: 6d61 6e64 7320 6672 6f6d 2074 6865 2063  mands from the c
-00019cb0: 6f6d 6d61 6e64 206c 696e 6520 2873 6565  ommand line (see
-00019cc0: 2062 656c 6f77 292e 0a0a 2323 2320 5365   below)...### Se
-00019cd0: 7475 7020 6672 6f6d 2063 6f6d 6d61 6e64  tup from command
-00019ce0: 206c 696e 650a 0a4f 6274 6169 6e20 7468   line..Obtain th
-00019cf0: 6520 7072 6f6a 6563 7420 6669 6c65 732c  e project files,
-00019d00: 2075 7369 6e67 2047 6974 206f 7220 7375   using Git or su
-00019d10: 6974 6162 6c65 2061 6c74 6572 6e61 7469  itable alternati
-00019d20: 7665 2e0a 0a49 6e20 6120 7465 726d 696e  ve...In a termin
-00019d30: 616c 2061 7070 6c69 6361 7469 6f6e 2c20  al application, 
-00019d40: 6368 616e 6765 2079 6f75 7220 6375 7272  change your curr
-00019d50: 656e 7420 776f 726b 696e 6720 6469 7265  ent working dire
-00019d60: 6374 6f72 790a 746f 2074 6865 2072 6f6f  ctory.to the roo
-00019d70: 7420 666f 6c64 6572 206f 6620 7468 6520  t folder of the 
-00019d80: 7072 6f6a 6563 7420 6669 6c65 732e 2054  project files. T
-00019d90: 6865 7265 2073 686f 756c 6420 6265 2061  here should be a
-00019da0: 204d 616b 6566 696c 650a 696e 2074 6869   Makefile.in thi
-00019db0: 7320 666f 6c64 6572 2e0a 0a55 7365 2074  s folder...Use t
-00019dc0: 6865 204d 616b 6566 696c 6520 746f 2063  he Makefile to c
-00019dd0: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
-00019de0: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
-00019df0: 6f6e 6d65 6e74 2066 6f72 2074 6865 0a70  onment for the.p
-00019e00: 726f 6a65 6374 2061 6e64 2069 6e73 7461  roject and insta
-00019e10: 6c6c 2074 6865 2070 726f 6a65 6374 2773  ll the project's
-00019e20: 2070 6163 6b61 6765 2064 6570 656e 6465   package depende
-00019e30: 6e63 6965 7320 696e 746f 2069 742c 0a75  ncies into it,.u
-00019e40: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-00019e50: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
-00019e60: 2024 206d 616b 6520 696e 7374 616c 6c2d   $ make install-
-00019e70: 7061 636b 6167 6573 0a0a 4974 2773 2061  packages..It's a
-00019e80: 6c73 6f20 706f 7373 6962 6c65 2074 6f20  lso possible to 
-00019e90: 616c 736f 2069 6e73 7461 6c6c 2074 6865  also install the
-00019ea0: 2070 726f 6a65 6374 2069 6e20 2765 6469   project in 'edi
-00019eb0: 7461 626c 6520 6d6f 6465 272e 0a0a 2020  table mode'...  
-00019ec0: 2020 2420 6d61 6b65 2069 6e73 7461 6c6c    $ make install
-00019ed0: 0a0a 506c 6561 7365 206e 6f74 652c 2069  ..Please note, i
-00019ee0: 6620 796f 7520 6372 6561 7465 2074 6865  f you create the
-00019ef0: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
-00019f00: 6d65 6e74 2069 6e20 7468 6973 2077 6179  ment in this way
-00019f10: 2c20 616e 6420 7468 656e 2074 7279 2074  , and then try t
-00019f20: 6f0a 6f70 656e 2074 6865 2070 726f 6a65  o.open the proje
-00019f30: 6374 2069 6e20 5079 4368 6172 6d20 616e  ct in PyCharm an
-00019f40: 6420 636f 6e66 6967 7572 6520 7468 6520  d configure the 
-00019f50: 7072 6f6a 6563 7420 746f 2075 7365 2074  project to use t
-00019f60: 6869 7320 7669 7274 7561 6c0a 656e 7669  his virtual.envi
-00019f70: 726f 6e6d 656e 7420 6173 2061 6e20 2245  ronment as an "E
-00019f80: 7869 7374 696e 6720 506f 6574 7279 2045  xisting Poetry E
-00019f90: 6e76 6972 6f6e 6d65 6e74 222c 2050 7943  nvironment", PyC
-00019fa0: 6861 726d 2073 6f6d 6574 696d 6573 2068  harm sometimes h
-00019fb0: 6173 2073 6f6d 650a 6973 7375 6573 2028  as some.issues (
-00019fc0: 646f 6e27 7420 6b6e 6f77 2077 6879 2920  don't know why) 
-00019fd0: 7768 6963 6820 6d69 6768 7420 6265 2070  which might be p
-00019fe0: 726f 626c 656d 6174 6963 2e20 4966 2079  roblematic. If y
-00019ff0: 6f75 2065 6e63 6f75 6e74 6572 2073 7563  ou encounter suc
-0001a000: 680a 6973 7375 6573 2c20 796f 7520 6361  h.issues, you ca
-0001a010: 6e20 7265 736f 6c76 6520 7468 6573 6520  n resolve these 
-0001a020: 6973 7375 6573 2062 7920 6465 6c65 7469  issues by deleti
-0001a030: 6e67 2074 6865 2076 6972 7475 616c 2065  ng the virtual e
-0001a040: 6e76 6972 6f6e 6d65 6e74 0a61 6e64 2063  nvironment.and c
-0001a050: 7265 6174 696e 6720 7468 6520 506f 6574  reating the Poet
-0001a060: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
-0001a070: 6f6e 6d65 6e74 2075 7369 6e67 2050 7943  onment using PyC
-0001a080: 6861 726d 2028 7365 6520 6162 6f76 6529  harm (see above)
-0001a090: 2e0a 0a23 2323 2050 726f 6a65 6374 204d  ...### Project M
-0001a0a0: 616b 6566 696c 6520 636f 6d6d 616e 6473  akefile commands
-0001a0b0: 0a0a 596f 7520 6361 6e20 7374 6172 7420  ..You can start 
-0001a0c0: 4576 656e 7453 746f 7265 4442 2075 7369  EventStoreDB usi
-0001a0d0: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-0001a0e0: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
-0001a0f0: 206d 616b 6520 7374 6172 742d 6576 656e   make start-even
-0001a100: 7473 746f 7265 6462 0a0a 596f 7520 6361  tstoredb..You ca
-0001a110: 6e20 7275 6e20 7465 7374 7320 7573 696e  n run tests usin
-0001a120: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
-0001a130: 636f 6d6d 616e 6420 286e 6565 6473 2045  command (needs E
-0001a140: 7665 6e74 5374 6f72 6544 4220 746f 2062  ventStoreDB to b
-0001a150: 6520 7275 6e6e 696e 6729 2e0a 0a20 2020  e running)...   
-0001a160: 2024 206d 616b 6520 7465 7374 0a0a 596f   $ make test..Yo
-0001a170: 7520 6361 6e20 7374 6f70 2045 7665 6e74  u can stop Event
-0001a180: 5374 6f72 6544 4220 7573 696e 6720 7468  StoreDB using th
-0001a190: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
-0001a1a0: 616e 642e 0a0a 2020 2020 2420 6d61 6b65  and...    $ make
-0001a1b0: 2073 746f 702d 6576 656e 7473 746f 7265   stop-eventstore
-0001a1c0: 6462 0a0a 596f 7520 6361 6e20 6368 6563  db..You can chec
-0001a1d0: 6b20 7468 6520 666f 726d 6174 7469 6e67  k the formatting
-0001a1e0: 206f 6620 7468 6520 636f 6465 2075 7369   of the code usi
-0001a1f0: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-0001a200: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
-0001a210: 206d 616b 6520 6c69 6e74 0a0a 596f 7520   make lint..You 
-0001a220: 6361 6e20 7265 666f 726d 6174 2074 6865  can reformat the
-0001a230: 2063 6f64 6520 7573 696e 6720 7468 6520   code using the 
-0001a240: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-0001a250: 642e 0a0a 2020 2020 2420 6d61 6b65 2066  d...    $ make f
-0001a260: 6d74 0a0a 5465 7374 7320 6265 6c6f 6e67  mt..Tests belong
-0001a270: 2069 6e20 602e 2f74 6573 7473 602e 2043   in `./tests`. C
-0001a280: 6f64 652d 756e 6465 722d 7465 7374 2062  ode-under-test b
-0001a290: 656c 6f6e 6773 2069 6e20 602e 2f65 7364  elongs in `./esd
-0001a2a0: 6263 6c69 656e 7460 2e0a 0a45 6469 7420  bclient`...Edit 
-0001a2b0: 7061 636b 6167 6520 6465 7065 6e64 656e  package dependen
-0001a2c0: 6369 6573 2069 6e20 6070 7970 726f 6a65  cies in `pyproje
-0001a2d0: 6374 2e74 6f6d 6c60 2e20 5570 6461 7465  ct.toml`. Update
-0001a2e0: 2069 6e73 7461 6c6c 6564 2070 6163 6b61   installed packa
-0001a2f0: 6765 7320 2861 6e64 2074 6865 0a60 706f  ges (and the.`po
-0001a300: 6574 7279 2e6c 6f63 6b60 2066 696c 6529  etry.lock` file)
-0001a310: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
-0001a320: 7769 6e67 2063 6f6d 6d61 6e64 2e0a 0a20  wing command... 
-0001a330: 2020 2024 206d 616b 6520 7570 6461 7465     $ make update
-0001a340: 2d70 6163 6b61 6765 730a                 -packages.
+00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00000010: 3a20 322e 310a 4e61 6d65 3a20 6573 6462  : 2.1.Name: esdb
+00000020: 636c 6965 6e74 0a56 6572 7369 6f6e 3a20  client.Version: 
+00000030: 312e 3061 360a 5375 6d6d 6172 793a 2050  1.0a6.Summary: P
+00000040: 7974 686f 6e20 6752 5043 2043 6c69 656e  ython gRPC Clien
+00000050: 7420 666f 7220 4576 656e 7453 746f 7265  t for EventStore
+00000060: 4442 0a48 6f6d 652d 7061 6765 3a20 6874  DB.Home-page: ht
+00000070: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00000080: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
+00000090: 2f65 7364 6263 6c69 656e 740a 4c69 6365  /esdbclient.Lice
+000000a0: 6e73 653a 2042 5344 2033 2d43 6c61 7573  nse: BSD 3-Claus
+000000b0: 650a 4175 7468 6f72 3a20 4a6f 686e 2042  e.Author: John B
+000000c0: 7977 6174 6572 0a41 7574 686f 722d 656d  ywater.Author-em
+000000d0: 6169 6c3a 206a 6f68 6e2e 6279 7761 7465  ail: john.bywate
+000000e0: 7240 6170 7072 6f70 7269 6174 6573 6f66  r@appropriatesof
+000000f0: 7477 6172 652e 6e65 740a 5265 7175 6972  tware.net.Requir
+00000100: 6573 2d50 7974 686f 6e3a 203e 3d33 2e37  es-Python: >=3.7
+00000110: 2c3c 342e 300a 436c 6173 7369 6669 6572  ,<4.0.Classifier
+00000120: 3a20 4465 7665 6c6f 706d 656e 7420 5374  : Development St
+00000130: 6174 7573 203a 3a20 3320 2d20 416c 7068  atus :: 3 - Alph
+00000140: 610a 436c 6173 7369 6669 6572 3a20 4c69  a.Classifier: Li
+00000150: 6365 6e73 6520 3a3a 204f 5349 2041 7070  cense :: OSI App
+00000160: 726f 7665 6420 3a3a 2042 5344 204c 6963  roved :: BSD Lic
+00000170: 656e 7365 0a43 6c61 7373 6966 6965 723a  ense.Classifier:
+00000180: 204c 6963 656e 7365 203a 3a20 4f74 6865   License :: Othe
+00000190: 722f 5072 6f70 7269 6574 6172 7920 4c69  r/Proprietary Li
+000001a0: 6365 6e73 650a 436c 6173 7369 6669 6572  cense.Classifier
+000001b0: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
+000001c0: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+000001d0: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
+000001e0: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
+000001f0: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
+00000200: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
+00000210: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
+00000220: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
+00000230: 2e37 0a43 6c61 7373 6966 6965 723a 2050  .7.Classifier: P
+00000240: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
+00000250: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
+00000260: 2033 2e38 0a43 6c61 7373 6966 6965 723a   3.8.Classifier:
+00000270: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+00000280: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+00000290: 3a3a 2033 2e39 0a43 6c61 7373 6966 6965  :: 3.9.Classifie
+000002a0: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
+000002b0: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
+000002c0: 6e20 3a3a 2033 2e31 300a 436c 6173 7369  n :: 3.10.Classi
+000002d0: 6669 6572 3a20 5072 6f67 7261 6d6d 696e  fier: Programmin
+000002e0: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
+000002f0: 7468 6f6e 203a 3a20 332e 3131 0a43 6c61  thon :: 3.11.Cla
+00000300: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+00000310: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00000320: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
+00000330: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+00000340: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00000350: 2050 7974 686f 6e20 3a3a 2033 2e31 300a   Python :: 3.10.
+00000360: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+00000370: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+00000380: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+00000390: 3131 0a43 6c61 7373 6966 6965 723a 2050  11.Classifier: P
+000003a0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
+000003b0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
+000003c0: 2033 2e37 0a43 6c61 7373 6966 6965 723a   3.7.Classifier:
+000003d0: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+000003e0: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+000003f0: 3a3a 2033 2e38 0a43 6c61 7373 6966 6965  :: 3.8.Classifie
+00000400: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
+00000410: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
+00000420: 6e20 3a3a 2033 2e39 0a52 6571 7569 7265  n :: 3.9.Require
+00000430: 732d 4469 7374 3a20 646e 7370 7974 686f  s-Dist: dnspytho
+00000440: 6e20 283e 3d32 2e33 2e30 2c3c 332e 302e  n (>=2.3.0,<3.0.
+00000450: 3029 0a52 6571 7569 7265 732d 4469 7374  0).Requires-Dist
+00000460: 3a20 6772 7063 696f 2028 3e3d 312e 3531  : grpcio (>=1.51
+00000470: 2e30 2c21 3d31 2e35 322e 2a29 0a52 6571  .0,!=1.52.*).Req
+00000480: 7569 7265 732d 4469 7374 3a20 7072 6f74  uires-Dist: prot
+00000490: 6f62 7566 2028 3e3d 332e 3131 2e30 290a  obuf (>=3.11.0).
+000004a0: 5265 7175 6972 6573 2d44 6973 743a 2074  Requires-Dist: t
+000004b0: 7970 696e 675f 6578 7465 6e73 696f 6e73  yping_extensions
+000004c0: 0a50 726f 6a65 6374 2d55 524c 3a20 5265  .Project-URL: Re
+000004d0: 706f 7369 746f 7279 2c20 6874 7470 733a  pository, https:
+000004e0: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7965  //github.com/pye
+000004f0: 7665 6e74 736f 7572 6369 6e67 2f65 7364  ventsourcing/esd
+00000500: 6263 6c69 656e 740a 4465 7363 7269 7074  bclient.Descript
+00000510: 696f 6e2d 436f 6e74 656e 742d 5479 7065  ion-Content-Type
+00000520: 3a20 7465 7874 2f6d 6172 6b64 6f77 6e0a  : text/markdown.
+00000530: 0a23 2050 7974 686f 6e20 6752 5043 2043  .# Python gRPC C
+00000540: 6c69 656e 7420 666f 7220 4576 656e 7453  lient for EventS
+00000550: 746f 7265 4442 0a0a 5468 6973 205b 5079  toreDB..This [Py
+00000560: 7468 6f6e 2070 6163 6b61 6765 5d28 6874  thon package](ht
+00000570: 7470 733a 2f2f 7079 7069 2e6f 7267 2f70  tps://pypi.org/p
+00000580: 726f 6a65 6374 2f65 7364 6263 6c69 656e  roject/esdbclien
+00000590: 742f 2920 7072 6f76 6964 6573 2061 2050  t/) provides a P
+000005a0: 7974 686f 6e0a 6752 5043 2063 6c69 656e  ython.gRPC clien
+000005b0: 7420 666f 7220 5b45 7665 6e74 5374 6f72  t for [EventStor
+000005c0: 6544 425d 2868 7474 7073 3a2f 2f77 7777  eDB](https://www
+000005d0: 2e65 7665 6e74 7374 6f72 652e 636f 6d2f  .eventstore.com/
+000005e0: 292e 0a0a 5468 6973 2063 6c69 656e 7420  )...This client 
+000005f0: 6861 7320 6265 656e 2064 6576 656c 6f70  has been develop
+00000600: 6564 2069 6e20 636f 6c6c 6162 6f72 6174  ed in collaborat
+00000610: 696f 6e20 7769 7468 2074 6865 2045 7665  ion with the Eve
+00000620: 6e74 5374 6f72 6544 420a 7465 616d 2e20  ntStoreDB.team. 
+00000630: 416c 7468 6f75 6768 206e 6f74 2061 6c6c  Although not all
+00000640: 2074 6865 2066 6561 7475 7265 7320 6f66   the features of
+00000650: 2045 7665 6e74 5374 6f72 6544 4220 6172   EventStoreDB ar
+00000660: 6520 7375 7070 6f72 7465 640a 6279 2074  e supported.by t
+00000670: 6869 7320 636c 6965 6e74 2c20 6d61 6e79  his client, many
+00000680: 206f 6620 7468 6520 6d6f 7374 2075 7365   of the most use
+00000690: 6675 6c20 6665 6174 7572 6573 2061 7265  ful features are
+000006a0: 2070 7265 7365 6e74 6564 0a69 6e20 616e   presented.in an
+000006b0: 2065 6173 792d 746f 2d75 7365 2069 6e74   easy-to-use int
+000006c0: 6572 6661 6365 2e0a 0a54 6869 7320 636c  erface...This cl
+000006d0: 6965 6e74 2068 6173 2062 6565 6e20 7465  ient has been te
+000006e0: 7374 6564 2074 6f20 776f 726b 2077 6974  sted to work wit
+000006f0: 6820 4576 656e 7453 746f 7265 4442 204c  h EventStoreDB L
+00000700: 5453 2076 6572 7369 6f6e 7320 3231 2e31  TS versions 21.1
+00000710: 302c 0a77 6974 686f 7574 2061 6e64 2077  0,.without and w
+00000720: 6974 686f 7574 2053 534c 2f54 4c53 2c20  ithout SSL/TLS, 
+00000730: 616e 6420 7769 7468 2050 7974 686f 6e20  and with Python 
+00000740: 7665 7273 696f 6e73 2033 2e37 2074 6f20  versions 3.7 to 
+00000750: 332e 3131 2e20 5468 6572 650a 6973 2031  3.11. There.is 1
+00000760: 3030 2520 7465 7374 2063 6f76 6572 6167  00% test coverag
+00000770: 652e 2054 6865 2063 6f64 6520 6861 7320  e. The code has 
+00000780: 7479 7069 6e67 2061 6e6e 6f74 6174 696f  typing annotatio
+00000790: 6e73 2c20 6368 6563 6b65 6420 7769 7468  ns, checked with
+000007a0: 206d 7970 792e 0a54 6865 2063 6f64 6520   mypy..The code 
+000007b0: 6973 2066 6f72 6d61 7474 6564 2077 6974  is formatted wit
+000007c0: 6820 626c 6163 6b20 616e 6420 6973 6f72  h black and isor
+000007d0: 742c 2061 6e64 2063 6865 636b 6564 2077  t, and checked w
+000007e0: 6974 6820 666c 616b 6538 2e20 506f 6574  ith flake8. Poet
+000007f0: 7279 0a69 7320 7573 6564 2066 6f72 2070  ry.is used for p
+00000800: 6163 6b61 6765 206d 616e 6167 656d 656e  ackage managemen
+00000810: 7420 6475 7269 6e67 2064 6576 656c 6f70  t during develop
+00000820: 6d65 6e74 2c20 616e 6420 666f 7220 6275  ment, and for bu
+00000830: 696c 6469 6e67 2061 6e64 0a70 7562 6c69  ilding and.publi
+00000840: 7368 696e 6720 6469 7374 7269 6275 7469  shing distributi
+00000850: 6f6e 7320 746f 205b 5079 5049 5d28 6874  ons to [PyPI](ht
+00000860: 7470 733a 2f2f 7079 7069 2e6f 7267 2f70  tps://pypi.org/p
+00000870: 726f 6a65 6374 2f65 7364 6263 6c69 656e  roject/esdbclien
+00000880: 742f 292e 0a0a 2323 2053 796e 6f70 7369  t/)...## Synopsi
+00000890: 730a 0a54 6865 2060 4553 4442 436c 6965  s..The `ESDBClie
+000008a0: 6e74 6020 636c 6173 7320 6361 6e20 6265  nt` class can be
+000008b0: 2069 6d70 6f72 7465 6420 6672 6f6d 2074   imported from t
+000008c0: 6865 2060 6573 6462 636c 6965 6e74 6020  he `esdbclient` 
+000008d0: 7061 636b 6167 652e 0a0a 5072 6f62 6162  package...Probab
+000008e0: 6c79 2074 6865 2074 6872 6565 206d 6f73  ly the three mos
+000008f0: 7420 7573 6566 756c 206d 6574 686f 6473  t useful methods
+00000900: 206f 6620 6045 5344 4243 6c69 656e 7460   of `ESDBClient`
+00000910: 2061 7265 3a0a 0a2a 2060 6170 7065 6e64   are:..* `append
+00000920: 5f65 7665 6e74 7328 2960 2054 6869 7320  _events()` This 
+00000930: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00000940: 6564 2074 6f20 7265 636f 7264 2065 7665  ed to record eve
+00000950: 6e74 7320 696e 2061 2070 6172 7469 6375  nts in a particu
+00000960: 6c61 720a 2273 7472 6561 6d22 2e20 5468  lar."stream". Th
+00000970: 6973 2069 7320 7573 6566 756c 2066 6f72  is is useful for
+00000980: 2065 7861 6d70 6c65 2077 6865 6e20 6578   example when ex
+00000990: 6563 7574 696e 6720 6120 636f 6d6d 616e  ecuting a comman
+000009a0: 6420 696e 2061 6e20 6170 706c 6963 6174  d in an applicat
+000009b0: 696f 6e0a 7468 6174 206d 7574 6174 6573  ion.that mutates
+000009c0: 2061 6e20 6167 6772 6567 6174 652e 2054   an aggregate. T
+000009d0: 6869 7320 6d65 7468 6f64 2069 7320 2261  his method is "a
+000009e0: 746f 6d69 6322 2069 6e20 7468 6174 2065  tomic" in that e
+000009f0: 6974 6865 7220 616c 6c20 6f72 206e 6f6e  ither all or non
+00000a00: 6520 6f66 0a74 6865 2065 7665 6e74 7320  e of.the events 
+00000a10: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+00000a20: 2e0a 0a2a 2060 7265 6164 5f73 7472 6561  ...* `read_strea
+00000a30: 6d5f 6576 656e 7473 2829 6020 5468 6973  m_events()` This
+00000a40: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+00000a50: 7365 6420 746f 2072 6574 7269 6576 6520  sed to retrieve 
+00000a60: 616c 6c20 7468 6520 7265 636f 7264 6564  all the recorded
+00000a70: 0a65 7665 6e74 7320 696e 2061 2022 7374  .events in a "st
+00000a80: 7265 616d 222e 2054 6869 7320 6973 2075  ream". This is u
+00000a90: 7365 6675 6c20 666f 7220 6578 616d 706c  seful for exampl
+00000aa0: 6520 7768 656e 2072 6563 6f6e 7374 7275  e when reconstru
+00000ab0: 6374 696e 6720 616e 2061 6767 7265 6761  cting an aggrega
+00000ac0: 7465 0a62 6566 6f72 6520 6578 6563 7574  te.before execut
+00000ad0: 696e 6720 6120 636f 6d6d 616e 6420 696e  ing a command in
+00000ae0: 2061 6e20 6170 706c 6963 6174 696f 6e2e   an application.
+00000af0: 0a0a 2a20 6073 7562 7363 7269 6265 5f61  ..* `subscribe_a
+00000b00: 6c6c 5f65 7665 6e74 7328 2960 2054 6869  ll_events()` Thi
+00000b10: 7320 6d65 7468 6f64 2063 616e 2062 6520  s method can be 
+00000b20: 7573 6564 2074 6f20 7265 6365 6976 6520  used to receive 
+00000b30: 616c 6c20 7265 636f 7264 6564 0a65 7665  all recorded.eve
+00000b40: 6e74 7320 6163 726f 7373 2061 6c6c 2022  nts across all "
+00000b50: 7374 7265 616d 7322 2e20 5468 6973 2069  streams". This i
+00000b60: 7320 7573 6566 756c 2069 6e20 646f 776e  s useful in down
+00000b70: 7374 7265 616d 2065 7665 6e74 2d70 726f  stream event-pro
+00000b80: 6365 7373 696e 670a 636f 6d70 6f6e 656e  cessing.componen
+00000b90: 7473 2c20 616e 6420 7375 7070 6f72 7473  ts, and supports
+00000ba0: 2070 726f 6365 7373 696e 6720 6576 656e   processing even
+00000bb0: 7473 2077 6974 6820 2265 7861 6374 6c79  ts with "exactly
+00000bc0: 2d6f 6e63 6522 2073 656d 616e 7469 6373  -once" semantics
+00000bd0: 2028 7365 6520 6265 6c6f 7729 2e0a 0a54   (see below)...T
+00000be0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00000bf0: 2075 7365 7320 616e 2022 696e 7365 6375   uses an "insecu
+00000c00: 7265 2220 4576 656e 7453 746f 7265 4442  re" EventStoreDB
+00000c10: 2073 6572 7665 7220 7275 6e6e 696e 6720   server running 
+00000c20: 6c6f 6361 6c6c 7920 6f6e 2070 6f72 7420  locally on port 
+00000c30: 3231 3134 2e0a 0a60 6060 7079 7468 6f6e  2114...```python
+00000c40: 0a69 6d70 6f72 7420 7575 6964 0a0a 6672  .import uuid..fr
+00000c50: 6f6d 2065 7364 6263 6c69 656e 7420 696d  om esdbclient im
+00000c60: 706f 7274 2045 5344 4243 6c69 656e 742c  port ESDBClient,
+00000c70: 204e 6577 4576 656e 740a 0a0a 2320 436f   NewEvent...# Co
+00000c80: 6e73 7472 7563 7420 4553 4442 436c 6965  nstruct ESDBClie
+00000c90: 6e74 2077 6974 6820 616e 2045 7665 6e74  nt with an Event
+00000ca0: 5374 6f72 6544 4220 5552 492e 0a0a 636c  StoreDB URI...cl
+00000cb0: 6965 6e74 203d 2045 5344 4243 6c69 656e  ient = ESDBClien
+00000cc0: 7428 0a20 2020 2075 7269 3d22 6573 6462  t(.    uri="esdb
+00000cd0: 3a2f 2f6c 6f63 616c 686f 7374 3a32 3131  ://localhost:211
+00000ce0: 343f 546c 733d 6661 6c73 6522 0a29 0a0a  4?Tls=false".)..
+00000cf0: 0a23 2047 656e 6572 6174 6520 6e65 7720  .# Generate new 
+00000d00: 6576 656e 7473 2e20 5479 7069 6361 6c6c  events. Typicall
+00000d10: 792c 2064 6f6d 6169 6e20 6576 656e 7473  y, domain events
+00000d20: 206f 6620 6469 6666 6572 656e 740a 2320   of different.# 
+00000d30: 7479 7065 7320 6172 6520 6765 6e65 7261  types are genera
+00000d40: 7465 6420 696e 2061 2064 6f6d 6169 6e20  ted in a domain 
+00000d50: 6d6f 6465 6c2c 2061 6e64 2074 6865 6e20  model, and then 
+00000d60: 7365 7269 616c 697a 6564 0a23 2069 6e74  serialized.# int
+00000d70: 6f20 4e65 7745 7665 6e74 206f 626a 6563  o NewEvent objec
+00000d80: 7473 2e20 416e 2061 6767 7265 6761 7465  ts. An aggregate
+00000d90: 2049 4420 6d61 7920 6265 2075 7365 6420   ID may be used 
+00000da0: 6173 2074 6865 0a23 206e 616d 6520 6f66  as the.# name of
+00000db0: 2061 2073 7472 6561 6d20 696e 2045 7665   a stream in Eve
+00000dc0: 6e74 5374 6f72 6544 422e 0a0a 7374 7265  ntStoreDB...stre
+00000dd0: 616d 5f6e 616d 6531 203d 2073 7472 2875  am_name1 = str(u
+00000de0: 7569 642e 7575 6964 3428 2929 0a65 7665  uid.uuid4()).eve
+00000df0: 6e74 3120 3d20 4e65 7745 7665 6e74 280a  nt1 = NewEvent(.
+00000e00: 2020 2020 7479 7065 3d27 4f72 6465 7243      type='OrderC
+00000e10: 7265 6174 6564 272c 0a20 2020 2064 6174  reated',.    dat
+00000e20: 613d 6227 7b22 6f72 6465 725f 6e75 6d62  a=b'{"order_numb
+00000e30: 6572 223a 2022 3132 3334 3536 227d 270a  er": "123456"}'.
+00000e40: 290a 6576 656e 7432 203d 204e 6577 4576  ).event2 = NewEv
+00000e50: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
+00000e60: 7264 6572 5375 626d 6974 7465 6427 2c0a  rderSubmitted',.
+00000e70: 2020 2020 6461 7461 3d62 277b 7d27 0a29      data=b'{}'.)
+00000e80: 0a0a 0a23 2041 7070 656e 6420 6e65 7720  ...# Append new 
+00000e90: 6576 656e 7473 2074 6f20 6120 7374 7265  events to a stre
+00000ea0: 616d 2e20 5468 6520 7374 7265 616d 2064  am. The stream d
+00000eb0: 6f65 7320 6e6f 7420 6578 6973 7420 736f  oes not exist so
+00000ec0: 0a23 2074 6865 2022 6375 7272 656e 7420  .# the "current 
+00000ed0: 7665 7273 696f 6e22 2069 7320 4e6f 6e65  version" is None
+00000ee0: 2e20 5468 6520 7661 6c75 6520 7265 7475  . The value retu
+00000ef0: 726e 6564 2066 726f 6d20 7468 650a 2320  rned from the.# 
+00000f00: 6170 7065 6e64 5f65 7665 6e74 7328 2920  append_events() 
+00000f10: 6d65 7468 6f64 2069 7320 7468 6520 6f76  method is the ov
+00000f20: 6572 616c 6c20 706f 7369 7469 6f6e 2069  erall position i
+00000f30: 6e20 7468 6520 6461 7461 6261 7365 0a23  n the database.#
+00000f40: 206f 6620 7468 6520 6c61 7374 206e 6577   of the last new
+00000f50: 2065 7665 6e74 2072 6563 6f72 6465 6420   event recorded 
+00000f60: 6279 2074 6869 7320 6f70 6572 6174 696f  by this operatio
+00000f70: 6e2e 2054 6865 2072 6574 7572 6e65 640a  n. The returned.
+00000f80: 2320 2263 6f6d 6d69 7420 706f 7369 7469  # "commit positi
+00000f90: 6f6e 2220 7661 6c75 6520 6d61 7920 6265  on" value may be
+00000fa0: 2075 7365 6420 696e 2061 2075 7365 7220   used in a user 
+00000fb0: 696e 7465 7266 6163 6520 746f 2070 6f6c  interface to pol
+00000fc0: 6c0a 2320 6120 646f 776e 7374 7265 616d  l.# a downstream
+00000fd0: 2065 7665 6e74 2d70 726f 6365 7373 696e   event-processin
+00000fe0: 6720 636f 6d70 6f6e 656e 7420 6265 666f  g component befo
+00000ff0: 7265 2069 7420 7072 6573 656e 7473 2061  re it presents a
+00001000: 6e0a 2320 7570 2d74 6f2d 6461 7465 2065  n.# up-to-date e
+00001010: 7665 6e74 7561 6c6c 7920 636f 6e73 6973  ventually consis
+00001020: 7465 6e74 206d 6174 6572 6961 6c69 7a65  tent materialize
+00001030: 6420 7669 6577 2e0a 0a63 6f6d 6d69 745f  d view...commit_
+00001040: 706f 7369 7469 6f6e 3120 3d20 636c 6965  position1 = clie
+00001050: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+00001060: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+00001070: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
+00001080: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+00001090: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 6576  ion=None,.    ev
+000010a0: 656e 7473 3d5b 6576 656e 7431 2c20 6576  ents=[event1, ev
+000010b0: 656e 7432 5d2c 0a29 0a0a 2320 5468 6520  ent2],.)..# The 
+000010c0: 2263 7572 7265 6e74 2076 6572 7369 6f6e  "current version
+000010d0: 2220 6973 2074 6865 2022 7374 7265 616d  " is the "stream
+000010e0: 2070 6f73 6974 696f 6e22 206f 6620 7468   position" of th
+000010f0: 6520 6c61 7374 0a23 2072 6563 6f72 6465  e last.# recorde
+00001100: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
+00001110: 6561 6d2e 2053 7472 6561 6d20 706f 7369  eam. Stream posi
+00001120: 7469 6f6e 7320 6172 6520 7a65 726f 2d62  tions are zero-b
+00001130: 6173 6564 2e0a 2320 5765 2068 6176 6520  ased..# We have 
+00001140: 7265 636f 7264 6564 2074 776f 206e 6577  recorded two new
+00001150: 2065 7665 6e74 732c 2061 6e64 2073 6f20   events, and so 
+00001160: 7468 6520 2263 7572 7265 6e74 2076 6572  the "current ver
+00001170: 7369 6f6e 220a 2320 6f66 2074 6869 7320  sion".# of this 
+00001180: 7374 7265 616d 2069 7320 312e 2043 6f6e  stream is 1. Con
+00001190: 6375 7272 656e 6379 2069 7320 636f 6e74  currency is cont
+000011a0: 726f 6c6c 6564 2069 6e20 7468 6973 2077  rolled in this w
+000011b0: 6179 0a23 2074 6f20 656e 7375 7265 2074  ay.# to ensure t
+000011c0: 6865 2063 6f6e 7369 7374 656e 6379 206f  he consistency o
+000011d0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+000011e0: 732e 2041 6e20 696e 636f 7272 6563 740a  s. An incorrect.
+000011f0: 2320 7661 6c75 6520 7769 6c6c 2063 6175  # value will cau
+00001200: 7365 2061 2057 726f 6e67 4375 7272 656e  se a WrongCurren
+00001210: 7456 6572 7369 6f6e 2065 7863 6570 7469  tVersion excepti
+00001220: 6f6e 2074 6f20 6265 2072 6169 7365 642e  on to be raised.
+00001230: 0a0a 6576 656e 7433 203d 204e 6577 4576  ..event3 = NewEv
+00001240: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
+00001250: 7264 6572 4361 6e63 656c 6c65 6427 2c0a  rderCancelled',.
+00001260: 2020 2020 6461 7461 3d62 277b 7d27 0a29      data=b'{}'.)
+00001270: 0a0a 636f 6d6d 6974 5f70 6f73 6974 696f  ..commit_positio
+00001280: 6e32 203d 2063 6c69 656e 742e 6170 7065  n2 = client.appe
+00001290: 6e64 5f65 7665 6e74 7328 0a20 2020 2073  nd_events(.    s
+000012a0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+000012b0: 6d5f 6e61 6d65 312c 0a20 2020 2063 7572  m_name1,.    cur
+000012c0: 7265 6e74 5f76 6572 7369 6f6e 3d31 2c0a  rent_version=1,.
+000012d0: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+000012e0: 7433 5d2c 0a29 0a0a 0a23 2052 6561 6420  t3],.)...# Read 
+000012f0: 6576 656e 7473 2066 726f 6d20 6120 7374  events from a st
+00001300: 7265 616d 2e20 5468 6520 7265 636f 7264  ream. The record
+00001310: 6564 2065 7665 6e74 7320 6d61 7920 6265  ed events may be
+00001320: 0a23 2064 6573 6572 6961 6c69 7a65 6420  .# deserialized 
+00001330: 746f 2064 6f6d 6169 6e20 6576 656e 7473  to domain events
+00001340: 206f 626a 6563 7473 206f 6620 6469 6666   objects of diff
+00001350: 6572 656e 7420 7479 7065 732c 0a23 2074  erent types,.# t
+00001360: 6865 6e20 7573 6564 2074 6f20 7265 636f  hen used to reco
+00001370: 6e73 7472 7563 7420 616e 2061 6767 7265  nstruct an aggre
+00001380: 6761 7465 2069 6e20 6120 646f 6d61 696e  gate in a domain
+00001390: 206d 6f64 656c 2e0a 0a72 6563 6f72 6465   model...recorde
+000013a0: 6420 3d20 636c 6965 6e74 2e72 6561 645f  d = client.read_
+000013b0: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
+000013c0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+000013d0: 7472 6561 6d5f 6e61 6d65 310a 290a 0a61  tream_name1.)..a
+000013e0: 7373 6572 7420 6c65 6e28 7265 636f 7264  ssert len(record
+000013f0: 6564 2920 3d3d 2033 0a0a 6173 7365 7274  ed) == 3..assert
+00001400: 2072 6563 6f72 6465 645b 305d 2e73 7472   recorded[0].str
+00001410: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
+00001420: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
+00001430: 7265 636f 7264 6564 5b31 5d2e 7374 7265  recorded[1].stre
+00001440: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+00001450: 6d5f 6e61 6d65 310a 6173 7365 7274 2072  m_name1.assert r
+00001460: 6563 6f72 6465 645b 325d 2e73 7472 6561  ecorded[2].strea
+00001470: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+00001480: 5f6e 616d 6531 0a0a 6173 7365 7274 2072  _name1..assert r
+00001490: 6563 6f72 6465 645b 305d 2e73 7472 6561  ecorded[0].strea
+000014a0: 6d5f 706f 7369 7469 6f6e 203d 3d20 300a  m_position == 0.
+000014b0: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
+000014c0: 315d 2e73 7472 6561 6d5f 706f 7369 7469  1].stream_positi
+000014d0: 6f6e 203d 3d20 310a 6173 7365 7274 2072  on == 1.assert r
+000014e0: 6563 6f72 6465 645b 325d 2e73 7472 6561  ecorded[2].strea
+000014f0: 6d5f 706f 7369 7469 6f6e 203d 3d20 320a  m_position == 2.
+00001500: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
+00001510: 5b30 5d2e 7479 7065 203d 3d20 224f 7264  [0].type == "Ord
+00001520: 6572 4372 6561 7465 6422 0a61 7373 6572  erCreated".asser
+00001530: 7420 7265 636f 7264 6564 5b31 5d2e 7479  t recorded[1].ty
+00001540: 7065 203d 3d20 224f 7264 6572 5375 626d  pe == "OrderSubm
+00001550: 6974 7465 6422 0a61 7373 6572 7420 7265  itted".assert re
+00001560: 636f 7264 6564 5b32 5d2e 7479 7065 203d  corded[2].type =
+00001570: 3d20 224f 7264 6572 4361 6e63 656c 6c65  = "OrderCancelle
+00001580: 6422 0a0a 6173 7365 7274 2072 6563 6f72  d"..assert recor
+00001590: 6465 645b 305d 2e64 6174 6120 3d3d 2062  ded[0].data == b
+000015a0: 277b 226f 7264 6572 5f6e 756d 6265 7222  '{"order_number"
+000015b0: 3a20 2231 3233 3435 3622 7d27 0a0a 0a23  : "123456"}'...#
+000015c0: 2053 7461 7274 2061 2063 6174 6368 2d75   Start a catch-u
+000015d0: 7020 7375 6273 6372 6970 7469 6f6e 2074  p subscription t
+000015e0: 6f20 7265 6365 6976 6520 616c 6c20 7265  o receive all re
+000015f0: 636f 7264 6564 0a23 2065 7665 6e74 7320  corded.# events 
+00001600: 6163 726f 7373 2061 6c6c 2073 7472 6561  across all strea
+00001610: 6d73 2e20 4120 6361 7463 682d 7570 2073  ms. A catch-up s
+00001620: 7562 7363 7269 7074 696f 6e20 6d61 790a  ubscription may.
+00001630: 2320 6265 2075 7365 6420 696e 2061 2064  # be used in a d
+00001640: 6f77 6e73 7472 6561 6d20 6576 656e 742d  ownstream event-
+00001650: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
+00001660: 6e65 6e74 2074 6f0a 2320 7265 6365 6976  nent to.# receiv
+00001670: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00001680: 7320 6672 6f6d 2061 2070 6172 7469 6375  s from a particu
+00001690: 6c61 7220 636f 6d6d 6974 2070 6f73 6974  lar commit posit
+000016a0: 696f 6e2e 0a23 2054 6865 2066 6972 7374  ion..# The first
+000016b0: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+000016c0: 6e22 2069 6e20 616e 2045 7665 6e74 5374  n" in an EventSt
+000016d0: 6f72 6544 4220 6461 7461 6261 7365 2069  oreDB database i
+000016e0: 7320 302e 0a0a 6c61 7374 5f73 6176 6564  s 0...last_saved
+000016f0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
+00001700: 203d 2030 0a0a 6361 7463 685f 7375 6273   = 0..catch_subs
+00001710: 6372 6970 7469 6f6e 203d 2063 6c69 656e  cription = clien
+00001720: 742e 7375 6273 6372 6962 655f 616c 6c5f  t.subscribe_all_
+00001730: 6576 656e 7473 280a 2020 2020 636f 6d6d  events(.    comm
+00001740: 6974 5f70 6f73 6974 696f 6e3d 6c61 7374  it_position=last
+00001750: 5f73 6176 6564 5f63 6f6d 6d69 745f 706f  _saved_commit_po
+00001760: 7369 7469 6f6e 0a29 0a0a 0a23 2049 7465  sition.)...# Ite
+00001770: 7261 7465 206f 7665 7220 7468 6520 6361  rate over the ca
+00001780: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+00001790: 696f 6e2e 2050 726f 6365 7373 2065 6163  ion. Process eac
+000017a0: 680a 2320 7265 636f 7264 6564 2065 7665  h.# recorded eve
+000017b0: 6e74 2069 6e20 7475 726e 2e20 496e 2061  nt in turn. In a
+000017c0: 6e20 6174 6f6d 6963 2064 6174 6162 6173  n atomic databas
+000017d0: 6520 7472 616e 7361 6374 696f 6e0a 2320  e transaction.# 
+000017e0: 7361 7665 2074 6865 2065 7665 6e74 2773  save the event's
+000017f0: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00001800: 6e22 2077 6974 6820 616e 7920 6e65 7720  n" with any new 
+00001810: 7374 6174 650a 2320 6765 6e65 7261 7465  state.# generate
+00001820: 6420 6279 2070 726f 6365 7373 696e 6720  d by processing 
+00001830: 7468 6520 6576 656e 742e 2055 7365 2074  the event. Use t
+00001840: 6865 2063 6f6d 706f 6e65 6e74 2773 0a23  he component's.#
+00001850: 206c 6173 7420 7361 7665 6420 2263 6f6d   last saved "com
+00001860: 6d69 7420 706f 7369 7469 6f6e 2220 7768  mit position" wh
+00001870: 656e 2072 6573 7461 7274 696e 6720 7468  en restarting th
+00001880: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
+00001890: 0a0a 7265 6365 6976 6564 203d 205b 5d0a  ..received = [].
+000018a0: 666f 7220 6576 656e 7420 696e 2063 6174  for event in cat
+000018b0: 6368 5f73 7562 7363 7269 7074 696f 6e3a  ch_subscription:
+000018c0: 0a20 2020 206c 6173 745f 7361 7665 645f  .    last_saved_
+000018d0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+000018e0: 3d20 6576 656e 742e 636f 6d6d 6974 5f70  = event.commit_p
+000018f0: 6f73 6974 696f 6e0a 2020 2020 7265 6365  osition.    rece
+00001900: 6976 6564 2e61 7070 656e 6428 6576 656e  ived.append(even
+00001910: 7429 0a0a 2020 2020 6966 206c 6173 745f  t)..    if last_
+00001920: 7361 7665 645f 636f 6d6d 6974 5f70 6f73  saved_commit_pos
+00001930: 6974 696f 6e20 3d3d 2063 6f6d 6d69 745f  ition == commit_
+00001940: 706f 7369 7469 6f6e 323a 0a20 2020 2020  position2:.     
+00001950: 2020 2023 2053 746f 7020 736f 2077 6520     # Stop so we 
+00001960: 6361 6e20 636f 6e74 696e 7565 2077 6974  can continue wit
+00001970: 6820 7468 6520 6578 616d 706c 652e 0a20  h the example.. 
+00001980: 2020 2020 2020 2063 6174 6368 5f73 7562         catch_sub
+00001990: 7363 7269 7074 696f 6e2e 7374 6f70 2829  scription.stop()
+000019a0: 0a0a 0a61 7373 6572 7420 7265 6365 6976  ...assert receiv
+000019b0: 6564 5b2d 335d 2e74 7970 6520 3d3d 2022  ed[-3].type == "
+000019c0: 4f72 6465 7243 7265 6174 6564 220a 6173  OrderCreated".as
+000019d0: 7365 7274 2072 6563 6569 7665 645b 2d32  sert received[-2
+000019e0: 5d2e 7479 7065 203d 3d20 224f 7264 6572  ].type == "Order
+000019f0: 5375 626d 6974 7465 6422 0a61 7373 6572  Submitted".asser
+00001a00: 7420 7265 6365 6976 6564 5b2d 315d 2e74  t received[-1].t
+00001a10: 7970 6520 3d3d 2022 4f72 6465 7243 616e  ype == "OrderCan
+00001a20: 6365 6c6c 6564 220a 0a0a 2320 436c 6f73  celled"...# Clos
+00001a30: 6520 7468 6520 636c 6965 6e74 2061 6674  e the client aft
+00001a40: 6572 2075 7365 2e0a 0a63 6c69 656e 742e  er use...client.
+00001a50: 636c 6f73 6528 290a 6060 600a 0a53 6565  close().```..See
+00001a60: 2062 656c 6f77 2066 6f72 206d 6f72 6520   below for more 
+00001a70: 6465 7461 696c 732e 0a0a 466f 7220 616e  details...For an
+00001a80: 2065 7861 6d70 6c65 206f 6620 7573 6167   example of usag
+00001a90: 652c 2073 6565 2074 6865 205b 6576 656e  e, see the [even
+00001aa0: 7473 6f75 7263 696e 672d 6576 656e 7473  tsourcing-events
+00001ab0: 746f 7265 6462 5d28 0a68 7474 7073 3a2f  toredb](.https:/
+00001ac0: 2f67 6974 6875 622e 636f 6d2f 7079 6576  /github.com/pyev
+00001ad0: 656e 7473 6f75 7263 696e 672f 6576 656e  entsourcing/even
+00001ae0: 7473 6f75 7263 696e 672d 6576 656e 7473  tsourcing-events
+00001af0: 746f 7265 6462 2920 7061 636b 6167 652e  toredb) package.
+00001b00: 0a0a 2323 2054 6162 6c65 206f 6620 636f  ..## Table of co
+00001b10: 6e74 656e 7473 0a0a 3c21 2d2d 2054 4f43  ntents..<!-- TOC
+00001b20: 202d 2d3e 0a2a 205b 496e 7374 616c 6c20   -->.* [Install 
+00001b30: 7061 636b 6167 655d 2823 696e 7374 616c  package](#instal
+00001b40: 6c2d 7061 636b 6167 6529 0a20 202a 205b  l-package).  * [
+00001b50: 4672 6f6d 2050 7950 495d 2823 6672 6f6d  From PyPI](#from
+00001b60: 2d70 7970 6929 0a20 202a 205b 5769 7468  -pypi).  * [With
+00001b70: 2050 6f65 7472 795d 2823 7769 7468 2d70   Poetry](#with-p
+00001b80: 6f65 7472 7929 0a2a 205b 4576 656e 7453  oetry).* [EventS
+00001b90: 746f 7265 4442 2073 6572 7665 725d 2823  toreDB server](#
+00001ba0: 6576 656e 7473 746f 7265 6462 2d73 6572  eventstoredb-ser
+00001bb0: 7665 7229 0a20 202a 205b 5275 6e20 636f  ver).  * [Run co
+00001bc0: 6e74 6169 6e65 725d 2823 7275 6e2d 636f  ntainer](#run-co
+00001bd0: 6e74 6169 6e65 7229 0a20 202a 205b 5374  ntainer).  * [St
+00001be0: 6f70 2063 6f6e 7461 696e 6572 5d28 2373  op container](#s
+00001bf0: 746f 702d 636f 6e74 6169 6e65 7229 0a2a  top-container).*
+00001c00: 205b 4576 656e 7453 746f 7265 4442 2063   [EventStoreDB c
+00001c10: 6c69 656e 745d 2823 6576 656e 7473 746f  lient](#eventsto
+00001c20: 7265 6462 2d63 6c69 656e 7429 0a20 202a  redb-client).  *
+00001c30: 205b 496d 706f 7274 2063 6c61 7373 5d28   [Import class](
+00001c40: 2369 6d70 6f72 742d 636c 6173 7329 0a20  #import-class). 
+00001c50: 202a 205b 436f 6e73 7472 7563 7420 636c   * [Construct cl
+00001c60: 6965 6e74 5d28 2363 6f6e 7374 7275 6374  ient](#construct
+00001c70: 2d63 6c69 656e 7429 0a2a 205b 436f 6e6e  -client).* [Conn
+00001c80: 6563 7469 6f6e 2073 7472 696e 6773 5d28  ection strings](
+00001c90: 2363 6f6e 6e65 6374 696f 6e2d 7374 7269  #connection-stri
+00001ca0: 6e67 7329 0a20 202a 205b 5477 6f20 7363  ngs).  * [Two sc
+00001cb0: 6865 6d65 735d 2823 7477 6f2d 7363 6865  hemes](#two-sche
+00001cc0: 6d65 7329 0a20 202a 205b 5573 6572 2069  mes).  * [User i
+00001cd0: 6e66 6f20 7374 7269 6e67 5d28 2375 7365  nfo string](#use
+00001ce0: 722d 696e 666f 2d73 7472 696e 6729 0a20  r-info-string). 
+00001cf0: 202a 205b 5175 6572 7920 7374 7269 6e67   * [Query string
+00001d00: 5d28 2371 7565 7279 2d73 7472 696e 6729  ](#query-string)
+00001d10: 0a20 202a 205b 4578 616d 706c 6573 5d28  .  * [Examples](
+00001d20: 2365 7861 6d70 6c65 7329 0a2a 205b 4576  #examples).* [Ev
+00001d30: 656e 7420 6f62 6a65 6374 735d 2823 6576  ent objects](#ev
+00001d40: 656e 742d 6f62 6a65 6374 7329 0a20 202a  ent-objects).  *
+00001d50: 205b 5468 6520 4e65 7745 7665 6e74 2063   [The NewEvent c
+00001d60: 6c61 7373 5d28 2374 6865 2d6e 6577 6576  lass](#the-newev
+00001d70: 656e 742d 636c 6173 7329 0a20 202a 205b  ent-class).  * [
+00001d80: 5468 6520 5265 636f 7264 6564 4576 656e  The RecordedEven
+00001d90: 7420 636c 6173 735d 2823 7468 652d 7265  t class](#the-re
+00001da0: 636f 7264 6564 6576 656e 742d 636c 6173  cordedevent-clas
+00001db0: 7329 0a2a 205b 5374 7265 616d 735d 2823  s).* [Streams](#
+00001dc0: 7374 7265 616d 7329 0a20 202a 205b 4170  streams).  * [Ap
+00001dd0: 7065 6e64 2065 7665 6e74 735d 2823 6170  pend events](#ap
+00001de0: 7065 6e64 2d65 7665 6e74 7329 0a20 202a  pend-events).  *
+00001df0: 205b 4170 7065 6e64 2065 7665 6e74 5d28   [Append event](
+00001e00: 2361 7070 656e 642d 6576 656e 7429 0a20  #append-event). 
+00001e10: 202a 205b 4964 656d 706f 7465 6e74 2061   * [Idempotent a
+00001e20: 7070 656e 6420 6f70 6572 6174 696f 6e73  ppend operations
+00001e30: 5d28 2369 6465 6d70 6f74 656e 742d 6170  ](#idempotent-ap
+00001e40: 7065 6e64 2d6f 7065 7261 7469 6f6e 7329  pend-operations)
+00001e50: 0a20 202a 205b 5265 6164 2073 7472 6561  .  * [Read strea
+00001e60: 6d20 6576 656e 7473 5d28 2372 6561 642d  m events](#read-
+00001e70: 7374 7265 616d 2d65 7665 6e74 7329 0a20  stream-events). 
+00001e80: 202a 205b 4765 7420 6375 7272 656e 7420   * [Get current 
+00001e90: 7665 7273 696f 6e5d 2823 6765 742d 6375  version](#get-cu
+00001ea0: 7272 656e 742d 7665 7273 696f 6e29 0a20  rrent-version). 
+00001eb0: 202a 205b 486f 7720 746f 2069 6d70 6c65   * [How to imple
+00001ec0: 6d65 6e74 2073 6e61 7073 686f 7474 696e  ment snapshottin
+00001ed0: 6720 7769 7468 2045 7665 6e74 5374 6f72  g with EventStor
+00001ee0: 6544 425d 2823 686f 772d 746f 2d69 6d70  eDB](#how-to-imp
+00001ef0: 6c65 6d65 6e74 2d73 6e61 7073 686f 7474  lement-snapshott
+00001f00: 696e 672d 7769 7468 2d65 7665 6e74 7374  ing-with-eventst
+00001f10: 6f72 6564 6229 0a20 202a 205b 5265 6164  oredb).  * [Read
+00001f20: 2061 6c6c 2065 7665 6e74 735d 2823 7265   all events](#re
+00001f30: 6164 2d61 6c6c 2d65 7665 6e74 7329 0a20  ad-all-events). 
+00001f40: 202a 205b 4765 7420 636f 6d6d 6974 2070   * [Get commit p
+00001f50: 6f73 6974 696f 6e5d 2823 6765 742d 636f  osition](#get-co
+00001f60: 6d6d 6974 2d70 6f73 6974 696f 6e29 0a20  mmit-position). 
+00001f70: 202a 205b 4765 7420 7374 7265 616d 206d   * [Get stream m
+00001f80: 6574 6164 6174 615d 2823 6765 742d 7374  etadata](#get-st
+00001f90: 7265 616d 2d6d 6574 6164 6174 6129 0a20  ream-metadata). 
+00001fa0: 202a 205b 5365 7420 7374 7265 616d 206d   * [Set stream m
+00001fb0: 6574 6164 6174 615d 2823 7365 742d 7374  etadata](#set-st
+00001fc0: 7265 616d 2d6d 6574 6164 6174 6129 0a20  ream-metadata). 
+00001fd0: 202a 205b 4465 6c65 7465 2073 7472 6561   * [Delete strea
+00001fe0: 6d5d 2823 6465 6c65 7465 2d73 7472 6561  m](#delete-strea
+00001ff0: 6d29 0a20 202a 205b 546f 6d62 7374 6f6e  m).  * [Tombston
+00002000: 6520 7374 7265 616d 5d28 2374 6f6d 6273  e stream](#tombs
+00002010: 746f 6e65 2d73 7472 6561 6d29 0a2a 205b  tone-stream).* [
+00002020: 4361 7463 682d 7570 2073 7562 7363 7269  Catch-up subscri
+00002030: 7074 696f 6e73 5d28 2363 6174 6368 2d75  ptions](#catch-u
+00002040: 702d 7375 6273 6372 6970 7469 6f6e 7329  p-subscriptions)
+00002050: 0a20 202a 205b 5375 6273 6372 6962 6520  .  * [Subscribe 
+00002060: 616c 6c20 6576 656e 7473 5d28 2373 7562  all events](#sub
+00002070: 7363 7269 6265 2d61 6c6c 2d65 7665 6e74  scribe-all-event
+00002080: 7329 0a20 202a 205b 5375 6273 6372 6962  s).  * [Subscrib
+00002090: 6520 7374 7265 616d 2065 7665 6e74 735d  e stream events]
+000020a0: 2823 7375 6273 6372 6962 652d 7374 7265  (#subscribe-stre
+000020b0: 616d 2d65 7665 6e74 7329 0a20 202a 205b  am-events).  * [
+000020c0: 486f 7720 746f 2069 6d70 6c65 6d65 6e74  How to implement
+000020d0: 2065 7861 6374 6c79 2d6f 6e63 6520 6576   exactly-once ev
+000020e0: 656e 7420 7072 6f63 6573 7369 6e67 5d28  ent processing](
+000020f0: 2368 6f77 2d74 6f2d 696d 706c 656d 656e  #how-to-implemen
+00002100: 742d 6578 6163 746c 792d 6f6e 6365 2d65  t-exactly-once-e
+00002110: 7665 6e74 2d70 726f 6365 7373 696e 6729  vent-processing)
+00002120: 0a2a 205b 5065 7273 6973 7465 6e74 2073  .* [Persistent s
+00002130: 7562 7363 7269 7074 696f 6e73 5d28 2370  ubscriptions](#p
+00002140: 6572 7369 7374 656e 742d 7375 6273 6372  ersistent-subscr
+00002150: 6970 7469 6f6e 7329 0a20 202a 205b 4372  iptions).  * [Cr
+00002160: 6561 7465 2073 7562 7363 7269 7074 696f  eate subscriptio
+00002170: 6e5d 2823 6372 6561 7465 2d73 7562 7363  n](#create-subsc
+00002180: 7269 7074 696f 6e29 0a20 202a 205b 5265  ription).  * [Re
+00002190: 6164 2073 7562 7363 7269 7074 696f 6e5d  ad subscription]
+000021a0: 2823 7265 6164 2d73 7562 7363 7269 7074  (#read-subscript
+000021b0: 696f 6e29 0a20 202a 205b 486f 7720 746f  ion).  * [How to
+000021c0: 2077 7269 7465 2061 2070 6572 7369 7374   write a persist
+000021d0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+000021e0: 2063 6f6e 7375 6d65 725d 2823 686f 772d   consumer](#how-
+000021f0: 746f 2d77 7269 7465 2d61 2d70 6572 7369  to-write-a-persi
+00002200: 7374 656e 742d 7375 6273 6372 6970 7469  stent-subscripti
+00002210: 6f6e 2d63 6f6e 7375 6d65 7229 0a20 202a  on-consumer).  *
+00002220: 205b 4765 7420 7375 6273 6372 6970 7469   [Get subscripti
+00002230: 6f6e 2069 6e66 6f5d 2823 6765 742d 7375  on info](#get-su
+00002240: 6273 6372 6970 7469 6f6e 2d69 6e66 6f29  bscription-info)
+00002250: 0a20 202a 205b 4c69 7374 2073 7562 7363  .  * [List subsc
+00002260: 7269 7074 696f 6e73 5d28 236c 6973 742d  riptions](#list-
+00002270: 7375 6273 6372 6970 7469 6f6e 7329 0a20  subscriptions). 
+00002280: 202a 205b 5570 6461 7465 2073 7562 7363   * [Update subsc
+00002290: 7269 7074 696f 6e5d 2823 7570 6461 7465  ription](#update
+000022a0: 2d73 7562 7363 7269 7074 696f 6e29 0a20  -subscription). 
+000022b0: 202a 205b 4372 6561 7465 2073 7472 6561   * [Create strea
+000022c0: 6d20 7375 6273 6372 6970 7469 6f6e 5d28  m subscription](
+000022d0: 2363 7265 6174 652d 7374 7265 616d 2d73  #create-stream-s
+000022e0: 7562 7363 7269 7074 696f 6e29 0a20 202a  ubscription).  *
+000022f0: 205b 5265 6164 2073 7472 6561 6d20 7375   [Read stream su
+00002300: 6273 6372 6970 7469 6f6e 5d28 2372 6561  bscription](#rea
+00002310: 642d 7374 7265 616d 2d73 7562 7363 7269  d-stream-subscri
+00002320: 7074 696f 6e29 0a20 202a 205b 4765 7420  ption).  * [Get 
+00002330: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00002340: 696f 6e20 696e 666f 5d28 2367 6574 2d73  ion info](#get-s
+00002350: 7472 6561 6d2d 7375 6273 6372 6970 7469  tream-subscripti
+00002360: 6f6e 2d69 6e66 6f29 0a20 202a 205b 4c69  on-info).  * [Li
+00002370: 7374 2073 7472 6561 6d20 7375 6273 6372  st stream subscr
+00002380: 6970 7469 6f6e 735d 2823 6c69 7374 2d73  iptions](#list-s
+00002390: 7472 6561 6d2d 7375 6273 6372 6970 7469  tream-subscripti
+000023a0: 6f6e 7329 0a20 202a 205b 5570 6461 7465  ons).  * [Update
+000023b0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+000023c0: 7469 6f6e 5d28 2375 7064 6174 652d 7374  tion](#update-st
+000023d0: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
+000023e0: 6e29 0a20 202a 205b 5265 706c 6179 2070  n).  * [Replay p
+000023f0: 6172 6b65 6420 6576 656e 7473 5d28 2372  arked events](#r
+00002400: 6570 6c61 792d 7061 726b 6564 2d65 7665  eplay-parked-eve
+00002410: 6e74 7329 0a20 202a 205b 4465 6c65 7465  nts).  * [Delete
+00002420: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00002430: 6372 6970 7469 6f6e 5d28 2364 656c 6574  cription](#delet
+00002440: 652d 7065 7273 6973 7465 6e74 2d73 7562  e-persistent-sub
+00002450: 7363 7269 7074 696f 6e29 0a2a 205b 436f  scription).* [Co
+00002460: 6e6e 6563 7469 6f6e 5d28 2363 6f6e 6e65  nnection](#conne
+00002470: 6374 696f 6e29 0a20 202a 205b 5265 636f  ction).  * [Reco
+00002480: 6e6e 6563 745d 2823 7265 636f 6e6e 6563  nnect](#reconnec
+00002490: 7429 0a20 202a 205b 436c 6f73 655d 2823  t).  * [Close](#
+000024a0: 636c 6f73 6529 0a2a 205b 4173 796e 6369  close).* [Asynci
+000024b0: 6f20 636c 6965 6e74 5d28 2361 7379 6e63  o client](#async
+000024c0: 696f 2d63 6c69 656e 7429 0a20 202a 205b  io-client).  * [
+000024d0: 5379 6e6f 7073 6973 5d28 2373 796e 6f70  Synopsis](#synop
+000024e0: 7369 732d 3129 0a2a 205b 4e6f 7465 735d  sis-1).* [Notes]
+000024f0: 2823 6e6f 7465 7329 0a20 202a 205b 5265  (#notes).  * [Re
+00002500: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
+00002510: 2066 696c 7465 7273 5d28 2372 6567 756c   filters](#regul
+00002520: 6172 2d65 7870 7265 7373 696f 6e2d 6669  ar-expression-fi
+00002530: 6c74 6572 7329 0a2a 205b 436f 6e74 7269  lters).* [Contri
+00002540: 6275 746f 7273 5d28 2363 6f6e 7472 6962  butors](#contrib
+00002550: 7574 6f72 7329 0a20 202a 205b 496e 7374  utors).  * [Inst
+00002560: 616c 6c20 506f 6574 7279 5d28 2369 6e73  all Poetry](#ins
+00002570: 7461 6c6c 2d70 6f65 7472 7929 0a20 202a  tall-poetry).  *
+00002580: 205b 5365 7475 7020 666f 7220 5079 4368   [Setup for PyCh
+00002590: 6172 6d20 7573 6572 735d 2823 7365 7475  arm users](#setu
+000025a0: 702d 666f 722d 7079 6368 6172 6d2d 7573  p-for-pycharm-us
+000025b0: 6572 7329 0a20 202a 205b 5365 7475 7020  ers).  * [Setup 
+000025c0: 6672 6f6d 2063 6f6d 6d61 6e64 206c 696e  from command lin
+000025d0: 655d 2823 7365 7475 702d 6672 6f6d 2d63  e](#setup-from-c
+000025e0: 6f6d 6d61 6e64 2d6c 696e 6529 0a20 202a  ommand-line).  *
+000025f0: 205b 5072 6f6a 6563 7420 4d61 6b65 6669   [Project Makefi
+00002600: 6c65 2063 6f6d 6d61 6e64 735d 2823 7072  le commands](#pr
+00002610: 6f6a 6563 742d 6d61 6b65 6669 6c65 2d63  oject-makefile-c
+00002620: 6f6d 6d61 6e64 7329 0a3c 212d 2d20 544f  ommands).<!-- TO
+00002630: 4320 2d2d 3e0a 0a23 2320 496e 7374 616c  C -->..## Instal
+00002640: 6c20 7061 636b 6167 650a 0a49 7420 6973  l package..It is
+00002650: 2072 6563 6f6d 6d65 6e64 6564 2074 6f20   recommended to 
+00002660: 696e 7374 616c 6c20 5079 7468 6f6e 2070  install Python p
+00002670: 6163 6b61 6765 7320 696e 746f 2061 2050  ackages into a P
+00002680: 7974 686f 6e20 7669 7274 7561 6c20 656e  ython virtual en
+00002690: 7669 726f 6e6d 656e 742e 0a0a 2323 2320  vironment...### 
+000026a0: 4672 6f6d 2050 7950 490a 0a59 6f75 2063  From PyPI..You c
+000026b0: 616e 2075 7365 2070 6970 2074 6f20 696e  an use pip to in
+000026c0: 7374 616c 6c20 7468 6973 2070 6163 6b61  stall this packa
+000026d0: 6765 2064 6972 6563 746c 7920 6672 6f6d  ge directly from
+000026e0: 0a5b 7468 6520 5079 7468 6f6e 2050 6163  .[the Python Pac
+000026f0: 6b61 6765 2049 6e64 6578 5d28 6874 7470  kage Index](http
+00002700: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
+00002710: 6a65 6374 2f65 7364 6263 6c69 656e 742f  ject/esdbclient/
+00002720: 292e 0a0a 2020 2020 2420 7069 7020 696e  )...    $ pip in
+00002730: 7374 616c 6c20 6573 6462 636c 6965 6e74  stall esdbclient
+00002740: 0a0a 2323 2320 5769 7468 2050 6f65 7472  ..### With Poetr
+00002750: 790a 0a59 6f75 2063 616e 2075 7365 2050  y..You can use P
+00002760: 6f65 7472 7920 746f 2061 6464 2074 6869  oetry to add thi
+00002770: 7320 7061 636b 6167 6520 746f 2079 6f75  s package to you
+00002780: 7220 7079 7072 6f6a 6563 742e 746f 6d6c  r pyproject.toml
+00002790: 2061 6e64 2069 6e73 7461 6c6c 2069 742e   and install it.
+000027a0: 0a0a 2020 2020 2420 706f 6574 7279 2061  ..    $ poetry a
+000027b0: 6464 2065 7364 6263 6c69 656e 740a 0a23  dd esdbclient..#
+000027c0: 2320 4576 656e 7453 746f 7265 4442 2073  # EventStoreDB s
+000027d0: 6572 7665 720a 0a54 6865 2045 7665 6e74  erver..The Event
+000027e0: 5374 6f72 6544 4220 7365 7276 6572 2063  StoreDB server c
+000027f0: 616e 2062 6520 7275 6e20 6c6f 6361 6c6c  an be run locall
+00002800: 7920 7573 696e 6720 7468 6520 6f66 6669  y using the offi
+00002810: 6369 616c 2044 6f63 6b65 7220 636f 6e74  cial Docker cont
+00002820: 6169 6e65 7220 696d 6167 652e 0a0a 2323  ainer image...##
+00002830: 2320 5275 6e20 636f 6e74 6169 6e65 720a  # Run container.
+00002840: 0a46 6f72 2064 6576 656c 6f70 6d65 6e74  .For development
+00002850: 2c20 796f 7520 6361 6e20 7275 6e20 6120  , you can run a 
+00002860: 2273 6563 7572 6522 2045 7665 6e74 5374  "secure" EventSt
+00002870: 6f72 6544 4220 7365 7276 6572 2075 7369  oreDB server usi
+00002880: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+00002890: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
+000028a0: 2064 6f63 6b65 7220 7275 6e20 2d64 202d   docker run -d -
+000028b0: 2d6e 616d 6520 6576 656e 7473 746f 7265  -name eventstore
+000028c0: 6462 2d73 6563 7572 6520 2d69 7420 2d70  db-secure -it -p
+000028d0: 2032 3131 333a 3231 3133 202d 2d65 6e76   2113:2113 --env
+000028e0: 2022 484f 4d45 3d2f 746d 7022 2065 7665   "HOME=/tmp" eve
+000028f0: 6e74 7374 6f72 652f 6576 656e 7473 746f  ntstore/eventsto
+00002900: 7265 3a32 312e 3130 2e39 2d62 7573 7465  re:21.10.9-buste
+00002910: 722d 736c 696d 202d 2d64 6576 0a0a 4173  r-slim --dev..As
+00002920: 2077 6520 7769 6c6c 2073 6565 2c20 796f   we will see, yo
+00002930: 7572 2063 6c69 656e 7420 7769 6c6c 206e  ur client will n
+00002940: 6565 6420 616e 2045 7665 6e74 5374 6f72  eed an EventStor
+00002950: 6544 4220 636f 6e6e 6563 7469 6f6e 2073  eDB connection s
+00002960: 7472 696e 6720 5552 4920 6173 2074 6865  tring URI as the
+00002970: 2076 616c 7565 0a6f 6620 6974 7320 6075   value.of its `u
+00002980: 7269 6020 636f 6e73 7472 7563 746f 7220  ri` constructor 
+00002990: 6172 6775 6d65 6e74 2e20 5468 6520 636f  argument. The co
+000029a0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+000029b0: 666f 7220 7468 6973 2022 7365 6375 7265  for this "secure
+000029c0: 2220 4576 656e 7453 746f 7265 4442 0a73  " EventStoreDB.s
+000029d0: 6572 7665 7220 776f 756c 6420 6265 3a0a  erver would be:.
+000029e0: 0a20 2020 2065 7364 623a 2f2f 6164 6d69  .    esdb://admi
+000029f0: 6e3a 6368 616e 6765 6974 406c 6f63 616c  n:changeit@local
+00002a00: 686f 7374 3a32 3131 330a 0a54 6f20 636f  host:2113..To co
+00002a10: 6e6e 6563 7420 746f 2061 2022 7365 6375  nnect to a "secu
+00002a20: 7265 2220 7365 7276 6572 2c20 796f 7520  re" server, you 
+00002a30: 7769 6c6c 2075 7375 616c 6c79 206e 6565  will usually nee
+00002a40: 6420 746f 2069 6e63 6c75 6465 2061 2022  d to include a "
+00002a50: 7573 6572 6e61 6d65 220a 616e 6420 6120  username".and a 
+00002a60: 2270 6173 7377 6f72 6422 2069 6e20 7468  "password" in th
+00002a70: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00002a80: 696e 672c 2073 6f20 7468 6174 2074 6865  ing, so that the
+00002a90: 2073 6572 7665 7220 6361 6e20 6175 7468   server can auth
+00002aa0: 656e 7469 6361 7465 2074 6865 0a63 6c69  enticate the.cli
+00002ab0: 656e 742e 2057 6974 6820 4576 656e 7453  ent. With EventS
+00002ac0: 746f 7265 4442 2c20 7468 6520 6465 6661  toreDB, the defa
+00002ad0: 756c 7420 7573 6572 6e61 6d65 2069 7320  ult username is 
+00002ae0: 2261 646d 696e 2220 616e 6420 7468 6520  "admin" and the 
+00002af0: 6465 6661 756c 7420 7061 7373 776f 7264  default password
+00002b00: 0a69 7320 2263 6861 6e67 6569 7422 2e0a  .is "changeit"..
+00002b10: 0a57 6865 6e20 636f 6e6e 6563 7469 6e67  .When connecting
+00002b20: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
+00002b30: 6572 7665 722c 2079 6f75 7220 636c 6965  erver, your clie
+00002b40: 6e74 2077 696c 6c20 616c 736f 206e 6565  nt will also nee
+00002b50: 6420 616e 2053 534c 2f54 4c53 2063 6572  d an SSL/TLS cer
+00002b60: 7469 6669 6361 7465 0a61 7320 7468 6520  tificate.as the 
+00002b70: 7661 6c75 6520 6f66 2069 7473 2060 726f  value of its `ro
+00002b80: 6f74 5f63 6572 7469 6669 6361 7465 7360  ot_certificates`
+00002b90: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
+00002ba0: 756d 656e 742e 2054 6865 2063 6c69 656e  ument. The clien
+00002bb0: 7420 7573 6573 2074 6865 0a53 534c 2f54  t uses the.SSL/T
+00002bc0: 4c53 2063 6572 7469 6669 6361 7465 2074  LS certificate t
+00002bd0: 6f20 6175 7468 656e 7469 6361 7465 2074  o authenticate t
+00002be0: 6865 2073 6572 7665 722e 2046 6f72 2064  he server. For d
+00002bf0: 6576 656c 6f70 6d65 6e74 2c20 796f 7520  evelopment, you 
+00002c00: 6361 6e20 6569 7468 6572 2075 7365 2074  can either use t
+00002c10: 6865 0a53 534c 2f54 4c53 2063 6572 7469  he.SSL/TLS certi
+00002c20: 6669 6361 7465 206f 6620 7468 6520 6365  ficate of the ce
+00002c30: 7274 6966 6963 6174 6520 6175 7468 6f72  rtificate author
+00002c40: 6974 7920 7573 6564 2074 6f20 6372 6561  ity used to crea
+00002c50: 7465 2074 6865 2073 6572 7665 7227 7320  te the server's 
+00002c60: 6365 7274 6966 6963 6174 652c 0a6f 7220  certificate,.or 
+00002c70: 7768 656e 2075 7369 6e67 2061 2073 696e  when using a sin
+00002c80: 676c 652d 6e6f 6465 2063 6c75 7374 6572  gle-node cluster
+00002c90: 2c20 796f 7520 6361 6e20 7573 6520 7468  , you can use th
+00002ca0: 6520 7365 7276 6572 2063 6572 7469 6669  e server certifi
+00002cb0: 6361 7465 2069 7473 656c 662e 2059 6f75  cate itself. You
+00002cc0: 2063 616e 0a67 6574 2074 6865 2073 6572   can.get the ser
+00002cd0: 7665 7220 6365 7274 6966 6963 6174 6520  ver certificate 
+00002ce0: 7769 7468 2074 6865 2066 6f6c 6c6f 7769  with the followi
+00002cf0: 6e67 2050 7974 686f 6e20 636f 6465 2e0a  ng Python code..
+00002d00: 0a0a 6060 6070 7974 686f 6e0a 696d 706f  ..```python.impo
+00002d10: 7274 2073 736c 0a0a 7365 7276 6572 5f63  rt ssl..server_c
+00002d20: 6572 7469 6669 6361 7465 203d 2073 736c  ertificate = ssl
+00002d30: 2e67 6574 5f73 6572 7665 725f 6365 7274  .get_server_cert
+00002d40: 6966 6963 6174 6528 6164 6472 3d28 276c  ificate(addr=('l
+00002d50: 6f63 616c 686f 7374 272c 2032 3131 3329  ocalhost', 2113)
+00002d60: 290a 6060 600a 0a59 6f75 2063 616e 2061  ).```..You can a
+00002d70: 6c73 6f20 7374 6172 7420 616e 2022 696e  lso start an "in
+00002d80: 7365 6375 7265 2220 7365 7276 6572 2075  secure" server u
+00002d90: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
+00002da0: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
+00002db0: 2024 2064 6f63 6b65 7220 7275 6e20 2d64   $ docker run -d
+00002dc0: 202d 2d6e 616d 6520 6576 656e 7473 746f   --name eventsto
+00002dd0: 7265 6462 2d69 6e73 6563 7572 6520 2d69  redb-insecure -i
+00002de0: 7420 2d70 2032 3131 343a 3231 3133 2065  t -p 2114:2113 e
+00002df0: 7665 6e74 7374 6f72 652f 6576 656e 7473  ventstore/events
+00002e00: 746f 7265 3a32 312e 3130 2e39 2d62 7573  tore:21.10.9-bus
+00002e10: 7465 722d 736c 696d 202d 2d69 6e73 6563  ter-slim --insec
+00002e20: 7572 650a 0a54 6865 2063 6f6e 6e65 6374  ure..The connect
+00002e30: 696f 6e20 7374 7269 6e67 2055 5249 2066  ion string URI f
+00002e40: 6f72 2074 6869 7320 2269 6e73 6563 7572  or this "insecur
+00002e50: 6522 2073 6572 7665 7220 776f 756c 6420  e" server would 
+00002e60: 6265 3a0a 0a20 2020 2065 7364 623a 2f2f  be:..    esdb://
+00002e70: 6c6f 6361 6c68 6f73 743a 3231 3134 3f54  localhost:2114?T
+00002e80: 6c73 3d66 616c 7365 0a0a 4173 2077 6520  ls=false..As we 
+00002e90: 7769 6c6c 2073 6565 2c20 7768 656e 2063  will see, when c
+00002ea0: 6f6e 6e65 6374 696e 6720 746f 2061 6e20  onnecting to an 
+00002eb0: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
+00002ec0: 722c 2074 6865 7265 2069 7320 6e6f 206e  r, there is no n
+00002ed0: 6565 6420 746f 2069 6e63 6c75 6465 0a61  eed to include.a
+00002ee0: 2022 7573 6572 6e61 6d65 2220 616e 6420   "username" and 
+00002ef0: 6120 2270 6173 7377 6f72 6422 2069 6e20  a "password" in 
+00002f00: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
+00002f10: 7472 696e 672e 2049 6620 796f 7520 646f  tring. If you do
+00002f20: 2c20 7468 6573 6520 7661 6c75 6573 2077  , these values w
+00002f30: 696c 6c0a 6265 2069 676e 6f72 6564 2062  ill.be ignored b
+00002f40: 7920 7468 6520 636c 6965 6e74 2c20 736f  y the client, so
+00002f50: 2074 6861 7420 7468 6579 2061 7265 206e   that they are n
+00002f60: 6f74 2073 656e 7420 6f76 6572 2061 6e20  ot sent over an 
+00002f70: 696e 7365 6375 7265 2063 6861 6e6e 656c  insecure channel
+00002f80: 2e0a 0a50 6c65 6173 6520 6e6f 7465 2c20  ...Please note, 
+00002f90: 7468 6520 2269 6e73 6563 7572 6522 2063  the "insecure" c
+00002fa0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00002fb0: 2075 7365 7320 6120 7175 6572 7920 7374   uses a query st
+00002fc0: 7269 6e67 2077 6974 6820 7468 6520 6669  ring with the fi
+00002fd0: 656c 642d 7661 6c75 650a 6054 6c73 3d66  eld-value.`Tls=f
+00002fe0: 616c 7365 602e 2054 6865 2076 616c 7565  alse`. The value
+00002ff0: 206f 6620 7468 6973 2066 6965 6c64 2069   of this field i
+00003000: 7320 6279 2064 6566 6175 6c74 2060 7472  s by default `tr
+00003010: 7565 602e 0a0a 2323 2320 5374 6f70 2063  ue`...### Stop c
+00003020: 6f6e 7461 696e 6572 0a0a 546f 2073 746f  ontainer..To sto
+00003030: 7020 616e 6420 7265 6d6f 7665 2074 6865  p and remove the
+00003040: 2022 7365 6375 7265 2220 636f 6e74 6169   "secure" contai
+00003050: 6e65 722c 2075 7365 2074 6865 2066 6f6c  ner, use the fol
+00003060: 6c6f 7769 6e67 2044 6f63 6b65 7220 636f  lowing Docker co
+00003070: 6d6d 616e 6473 2e0a 0a20 2020 2024 2064  mmands...    $ d
+00003080: 6f63 6b65 7220 7374 6f70 2065 7665 6e74  ocker stop event
+00003090: 7374 6f72 6564 622d 7365 6375 7265 0a09  storedb-secure..
+000030a0: 2420 646f 636b 6572 2072 6d20 6576 656e  $ docker rm even
+000030b0: 7473 746f 7265 6462 2d73 6563 7572 650a  tstoredb-secure.
+000030c0: 0a54 6f20 7374 6f70 2061 6e64 2072 656d  .To stop and rem
+000030d0: 6f76 6520 7468 6520 2269 6e73 6563 7572  ove the "insecur
+000030e0: 6522 2063 6f6e 7461 696e 6572 2c20 7573  e" container, us
+000030f0: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
+00003100: 446f 636b 6572 2063 6f6d 6d61 6e64 732e  Docker commands.
+00003110: 0a0a 2020 2020 2420 646f 636b 6572 2073  ..    $ docker s
+00003120: 746f 7020 6576 656e 7473 746f 7265 6462  top eventstoredb
+00003130: 2d69 6e73 6563 7572 650a 0924 2064 6f63  -insecure..$ doc
+00003140: 6b65 7220 726d 2065 7665 6e74 7374 6f72  ker rm eventstor
+00003150: 6564 622d 696e 7365 6375 7265 0a0a 0a23  edb-insecure...#
+00003160: 2320 4576 656e 7453 746f 7265 4442 2063  # EventStoreDB c
+00003170: 6c69 656e 740a 0a54 6869 7320 4576 656e  lient..This Even
+00003180: 7453 746f 7265 4442 2063 6c69 656e 7420  tStoreDB client 
+00003190: 6973 2069 6d70 6c65 6d65 6e74 6564 2069  is implemented i
+000031a0: 6e20 7468 6520 6065 7364 6263 6c69 656e  n the `esdbclien
+000031b0: 7460 2070 6163 6b61 6765 2077 6974 680a  t` package with.
+000031c0: 7468 6520 6045 5344 4243 6c69 656e 7460  the `ESDBClient`
+000031d0: 2063 6c61 7373 2e0a 0a23 2323 2049 6d70   class...### Imp
+000031e0: 6f72 7420 636c 6173 730a 0a54 6865 2060  ort class..The `
+000031f0: 4553 4442 436c 6965 6e74 6020 636c 6173  ESDBClient` clas
+00003200: 7320 6361 6e20 6265 2069 6d70 6f72 7465  s can be importe
+00003210: 6420 6672 6f6d 2074 6865 2060 6573 6462  d from the `esdb
+00003220: 636c 6965 6e74 6020 7061 636b 6167 652e  client` package.
+00003230: 0a0a 6060 6070 7974 686f 6e0a 6672 6f6d  ..```python.from
+00003240: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
+00003250: 7274 2045 5344 4243 6c69 656e 740a 6060  rt ESDBClient.``
+00003260: 600a 0a23 2323 2043 6f6e 7374 7275 6374  `..### Construct
+00003270: 2063 6c69 656e 740a 0a54 6865 2060 4553   client..The `ES
+00003280: 4442 436c 6965 6e74 6020 636c 6173 7320  DBClient` class 
+00003290: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
+000032a0: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
+000032b0: 756d 656e 742c 2060 7572 6960 2c20 616e  ument, `uri`, an
+000032c0: 6420 6f6e 650a 6f70 7469 6f6e 616c 2063  d one.optional c
+000032d0: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
+000032e0: 656e 742c 2060 726f 6f74 5f63 6572 7469  ent, `root_certi
+000032f0: 6669 6361 7465 7360 2e0a 0a54 6865 2060  ficates`...The `
+00003300: 7572 6960 2061 7267 756d 656e 7420 6973  uri` argument is
+00003310: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+00003320: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
+00003330: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00003340: 6720 5552 4920 7468 6174 0a63 6f6e 666f  g URI that.confo
+00003350: 726d 7320 7769 7468 2074 6865 2073 7461  rms with the sta
+00003360: 6e64 6172 6420 4576 656e 7453 746f 7265  ndard EventStore
+00003370: 4442 2022 6573 6462 2220 6f72 2022 6573  DB "esdb" or "es
+00003380: 6462 2b64 6973 636f 7665 7222 2055 5249  db+discover" URI
+00003390: 2073 6368 656d 6573 2e0a 0a46 6f72 2065   schemes...For e
+000033a0: 7861 6d70 6c65 2c20 7468 6520 666f 6c6c  xample, the foll
+000033b0: 6f77 696e 6720 636f 6e6e 6563 7469 6f6e  owing connection
+000033c0: 2073 7472 696e 6720 7370 6563 6966 6965   string specifie
+000033d0: 7320 7468 6174 2074 6865 2063 6c69 656e  s that the clien
+000033e0: 7420 7368 6f75 6c64 0a61 7474 656d 7074  t should.attempt
+000033f0: 2074 6f20 6372 6561 7465 2061 2022 7365   to create a "se
+00003400: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+00003410: 2074 6f20 706f 7274 2032 3131 3320 6f6e   to port 2113 on
+00003420: 2022 6c6f 6361 6c68 6f73 7422 2c20 616e   "localhost", an
+00003430: 6420 7573 6520 7468 650a 636c 6965 6e74  d use the.client
+00003440: 2063 7265 6465 6e74 6961 6c73 2022 7573   credentials "us
+00003450: 6572 6e61 6d65 2220 616e 6420 2270 6173  ername" and "pas
+00003460: 7377 6f72 6422 2077 6865 6e20 6d61 6b69  sword" when maki
+00003470: 6e67 2063 616c 6c73 2074 6f20 7468 6520  ng calls to the 
+00003480: 7365 7276 6572 2e0a 0a20 2020 2065 7364  server...    esd
+00003490: 623a 2f2f 7573 6572 6e61 6d65 3a70 6173  b://username:pas
+000034a0: 7377 6f72 6440 6c6f 6361 6c68 6f73 743a  sword@localhost:
+000034b0: 3231 3133 3f54 6c73 3d74 7275 650a 0a54  2113?Tls=true..T
+000034c0: 6865 2063 6c69 656e 7420 6d75 7374 2062  he client must b
+000034d0: 6520 636f 6e66 6967 7572 6564 2074 6f20  e configured to 
+000034e0: 6372 6561 7465 2061 2022 7365 6375 7265  create a "secure
+000034f0: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
+00003500: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
+00003510: 722c 0a6f 7220 616c 7465 726e 6174 6976  r,.or alternativ
+00003520: 656c 7920 616e 2022 696e 7365 6375 7265  ely an "insecure
+00003530: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
+00003540: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
+00003550: 7276 6572 2e20 4279 2064 6566 6175 6c74  rver. By default
+00003560: 2c20 7468 650a 636c 6965 6e74 2077 696c  , the.client wil
+00003570: 6c20 6174 7465 6d70 7420 746f 2063 7265  l attempt to cre
+00003580: 6174 6520 6120 2273 6563 7572 6522 2063  ate a "secure" c
+00003590: 6f6e 6e65 6374 696f 6e2e 2041 6e64 2073  onnection. And s
+000035a0: 6f2c 2077 6865 6e20 636f 6e6e 6563 7469  o, when connecti
+000035b0: 6e67 2074 6f20 616e 0a22 696e 7365 6375  ng to an."insecu
+000035c0: 7265 2220 7365 7276 6572 2c20 7468 6520  re" server, the 
+000035d0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+000035e0: 6720 6d75 7374 2073 7065 6369 6679 2074  g must specify t
+000035f0: 6861 7420 7468 6520 636c 6965 6e74 2073  hat the client s
+00003600: 686f 756c 6420 6174 7465 6d70 740a 746f  hould attempt.to
+00003610: 206d 616b 6520 616e 2022 696e 7365 6375   make an "insecu
+00003620: 7265 2220 636f 6e6e 6563 7469 6f6e 2e0a  re" connection..
+00003630: 0a54 6865 2066 6f6c 6c6f 7769 6e67 2063  .The following c
+00003640: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00003650: 2073 7065 6369 6669 6573 2074 6861 7420   specifies that 
+00003660: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
+00003670: 640a 6174 7465 6d70 7420 746f 2063 7265  d.attempt to cre
+00003680: 6174 6520 616e 2022 696e 7365 6375 7265  ate an "insecure
+00003690: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
+000036a0: 706f 7274 2032 3131 3420 6f6e 2022 6c6f  port 2114 on "lo
+000036b0: 6361 6c68 6f73 7422 2e0a 5768 656e 2063  calhost"..When c
+000036c0: 6f6e 6e65 6374 696e 6720 746f 2061 6e20  onnecting to an 
+000036d0: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
+000036e0: 722c 2074 6865 2063 6c69 656e 7420 7769  r, the client wi
+000036f0: 6c6c 2069 676e 6f72 6520 616e 790a 7573  ll ignore any.us
+00003700: 6572 6e61 6d65 2061 6e64 2070 6173 7377  ername and passw
+00003710: 6f72 6420 696e 666f 726d 6174 696f 6e20  ord information 
+00003720: 696e 636c 7564 6564 2069 6e20 7468 6520  included in the 
+00003730: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00003740: 672c 0a73 6f20 7468 6174 2075 7365 726e  g,.so that usern
+00003750: 616d 6573 2061 6e64 2070 6173 7377 6f72  ames and passwor
+00003760: 6473 2061 7265 206e 6f74 2073 656e 7420  ds are not sent 
+00003770: 6f76 6572 2061 6e20 2269 6e73 6563 7572  over an "insecur
+00003780: 6522 2063 6f6e 6e65 6374 696f 6e2e 0a0a  e" connection...
+00003790: 2020 2020 6573 6462 3a2f 2f6c 6f63 616c      esdb://local
+000037a0: 686f 7374 3a32 3131 343f 546c 733d 6661  host:2114?Tls=fa
+000037b0: 6c73 650a 0a50 6c65 6173 6520 6e6f 7465  lse..Please note
+000037c0: 2c20 7468 6520 2269 6e73 6563 7572 6522  , the "insecure"
+000037d0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+000037e0: 6e67 2075 7365 7320 6120 7175 6572 7920  ng uses a query 
+000037f0: 7374 7269 6e67 2077 6974 6820 7468 6520  string with the 
+00003800: 6669 656c 642d 7661 6c75 650a 6054 6c73  field-value.`Tls
+00003810: 3d66 616c 7365 602e 2054 6865 2076 616c  =false`. The val
+00003820: 7565 206f 6620 7468 6973 2066 6965 6c64  ue of this field
+00003830: 2069 7320 6279 2064 6566 6175 6c74 2060   is by default `
+00003840: 7472 7565 602e 2055 6e6c 6573 7320 7468  true`. Unless th
+00003850: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00003860: 696e 670a 5552 4920 696e 636c 7564 6573  ing.URI includes
+00003870: 2074 6865 2066 6965 6c64 2d76 616c 7565   the field-value
+00003880: 2060 546c 733d 6661 6c73 6560 2069 6e20   `Tls=false` in 
+00003890: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
+000038a0: 2c20 7468 6520 6072 6f6f 745f 6365 7274  , the `root_cert
+000038b0: 6966 6963 6174 6573 600a 636f 6e73 7472  ificates`.constr
+000038c0: 7563 746f 7220 6172 6775 6d65 6e74 2069  uctor argument i
+000038d0: 7320 616c 736f 2072 6571 7569 7265 642e  s also required.
+000038e0: 0a0a 5768 656e 2063 6f6e 6e65 6374 696e  ..When connectin
+000038f0: 6720 746f 2061 2022 7365 6375 7265 2220  g to a "secure" 
+00003900: 7365 7276 6572 2c20 7468 6520 6072 6f6f  server, the `roo
+00003910: 745f 6365 7274 6966 6963 6174 6573 6020  t_certificates` 
+00003920: 6172 6775 6d65 6e74 2069 7320 6578 7065  argument is expe
+00003930: 6374 6564 2074 6f0a 6265 2061 2050 7974  cted to.be a Pyt
+00003940: 686f 6e20 6073 7472 6020 636f 6e74 6169  hon `str` contai
+00003950: 6e69 6e67 2050 454d 2065 6e63 6f64 6564  ning PEM encoded
+00003960: 2053 534c 2f54 4c53 2072 6f6f 7420 6365   SSL/TLS root ce
+00003970: 7274 6966 6963 6174 6573 2e20 5468 6973  rtificates. This
+00003980: 2076 616c 7565 2069 730a 7061 7373 6564   value is.passed
+00003990: 2064 6972 6563 746c 7920 746f 2060 6772   directly to `gr
+000039a0: 7063 2e73 736c 5f63 6861 6e6e 656c 5f63  pc.ssl_channel_c
+000039b0: 7265 6465 6e74 6961 6c73 2829 602e 2049  redentials()`. I
+000039c0: 7420 6973 2075 7365 6420 666f 7220 6175  t is used for au
+000039d0: 7468 656e 7469 6361 7469 6e67 2074 6865  thenticating the
+000039e0: 0a73 6572 7665 7220 746f 2074 6865 2063  .server to the c
+000039f0: 6c69 656e 742e 2049 7420 6973 2063 6f6d  lient. It is com
+00003a00: 6d6f 6e6c 7920 7468 6520 6365 7274 6966  monly the certif
+00003a10: 6963 6174 6520 6f66 2074 6865 2063 6572  icate of the cer
+00003a20: 7469 6669 6361 7465 2061 7574 686f 7269  tificate authori
+00003a30: 7479 2074 6861 740a 7761 7320 7265 7370  ty that.was resp
+00003a40: 6f6e 7369 626c 6520 666f 7220 6765 6e65  onsible for gene
+00003a50: 7261 7469 6e67 2074 6865 2053 534c 2f54  rating the SSL/T
+00003a60: 4c53 2063 6572 7469 6669 6361 7465 2075  LS certificate u
+00003a70: 7365 6420 6279 2074 6865 2045 7665 6e74  sed by the Event
+00003a80: 5374 6f72 6544 4220 7365 7276 6572 2e0a  StoreDB server..
+00003a90: 4275 742c 2061 6c74 6572 6e61 7469 7665  But, alternative
+00003aa0: 6c79 2066 6f72 2064 6576 656c 6f70 6d65  ly for developme
+00003ab0: 6e74 2c20 796f 7520 6361 6e20 7573 6520  nt, you can use 
+00003ac0: 7468 6520 7365 7276 6572 2773 2063 6572  the server's cer
+00003ad0: 7469 6669 6361 7465 2069 7473 656c 662e  tificate itself.
+00003ae0: 0a0a 496e 2074 6865 2065 7861 6d70 6c65  ..In the example
+00003af0: 2062 656c 6f77 2c20 7468 6520 636f 6e73   below, the cons
+00003b00: 7472 7563 746f 7220 6172 6775 6d65 6e74  tructor argument
+00003b10: 2076 616c 7565 7320 6172 6520 7461 6b65   values are take
+00003b20: 6e20 6672 6f6d 2074 6865 206f 7065 7261  n from the opera
+00003b30: 7469 6e67 0a73 7973 7465 6d20 656e 7669  ting.system envi
+00003b40: 726f 6e6d 656e 742e 2054 6869 7320 6973  ronment. This is
+00003b50: 2061 2074 7970 6963 616c 2061 7272 616e   a typical arran
+00003b60: 6765 6d65 6e74 2069 6e20 6120 7072 6f64  gement in a prod
+00003b70: 7563 7469 6f6e 2065 6e76 6972 6f6e 6d65  uction environme
+00003b80: 6e74 2e20 4974 2069 730a 646f 6e65 2074  nt. It is.done t
+00003b90: 6869 7320 7761 7920 6865 7265 2073 6f20  his way here so 
+00003ba0: 7468 6174 2074 6865 2063 6f64 6520 696e  that the code in
+00003bb0: 2074 6869 7320 646f 6375 6d65 6e74 6174   this documentat
+00003bc0: 696f 6e20 6361 6e20 6265 2074 6573 7465  ion can be teste
+00003bd0: 6420 7769 7468 2062 6f74 680a 6120 2273  d with both.a "s
+00003be0: 6563 7572 6522 2061 6e64 2061 6e20 2269  ecure" and an "i
+00003bf0: 6e73 6563 7572 6522 2073 6572 7665 722e  nsecure" server.
+00003c00: 0a0a 6060 6070 7974 686f 6e0a 696d 706f  ..```python.impo
+00003c10: 7274 206f 730a 0a63 6c69 656e 7420 3d20  rt os..client = 
+00003c20: 4553 4442 436c 6965 6e74 280a 2020 2020  ESDBClient(.    
+00003c30: 7572 693d 6f73 2e67 6574 656e 7628 2245  uri=os.getenv("E
+00003c40: 5344 425f 5552 4922 292c 0a20 2020 2072  SDB_URI"),.    r
+00003c50: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
+00003c60: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
+00003c70: 5f52 4f4f 545f 4345 5254 4946 4943 4154  _ROOT_CERTIFICAT
+00003c80: 4553 2229 2c0a 290a 6060 600a 0a23 2320  ES"),.).```..## 
+00003c90: 436f 6e6e 6563 7469 6f6e 2073 7472 696e  Connection strin
+00003ca0: 6773 0a0a 416e 2045 7665 6e74 5374 6f72  gs..An EventStor
+00003cb0: 6544 4220 636f 6e6e 6563 7469 6f6e 2073  eDB connection s
+00003cc0: 7472 696e 6720 6973 2061 2055 5249 2074  tring is a URI t
+00003cd0: 6861 7420 636f 6e66 6f72 6d73 2077 6974  hat conforms wit
+00003ce0: 6820 6f6e 6520 6f66 2074 776f 2070 6f73  h one of two pos
+00003cf0: 7369 626c 650a 7363 6865 6d65 733a 2065  sible.schemes: e
+00003d00: 6974 6865 7220 7468 6520 2265 7364 6222  ither the "esdb"
+00003d10: 2073 6368 656d 652c 206f 7220 7468 6520   scheme, or the 
+00003d20: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
+00003d30: 7363 6865 6d65 2e0a 0a54 6865 2073 796e  scheme...The syn
+00003d40: 7461 7820 616e 6420 7365 6d61 6e74 6963  tax and semantic
+00003d50: 7320 6f66 2074 6865 2045 7665 6e74 5374  s of the EventSt
+00003d60: 6f72 6544 4220 5552 4920 7363 6865 6d65  oreDB URI scheme
+00003d70: 7320 6172 6520 6465 7363 7269 6265 6420  s are described 
+00003d80: 6265 6c6f 772e 2054 6865 0a73 796e 7461  below. The.synta
+00003d90: 7820 6973 2064 6566 696e 6564 2075 7369  x is defined usi
+00003da0: 6e67 205b 4542 4e46 5d28 6874 7470 733a  ng [EBNF](https:
+00003db0: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
+00003dc0: 7267 2f77 696b 692f 4578 7465 6e64 6564  rg/wiki/Extended
+00003dd0: 5f42 6163 6b75 73e2 8093 4e61 7572 5f66  _Backus...Naur_f
+00003de0: 6f72 6d29 2e0a 0a23 2323 2054 776f 2073  orm)...### Two s
+00003df0: 6368 656d 6573 0a0a 5468 6520 2265 7364  chemes..The "esd
+00003e00: 6222 2055 5249 2073 6368 656d 6520 6361  b" URI scheme ca
+00003e10: 6e20 6265 2064 6566 696e 6564 2069 6e20  n be defined in 
+00003e20: 7468 6520 666f 6c6c 6f77 696e 6720 7761  the following wa
+00003e30: 792e 0a0a 2020 2020 6573 6462 2d75 7269  y...    esdb-uri
+00003e40: 203d 2022 6573 6462 3a2f 2f22 202c 205b   = "esdb://" , [
+00003e50: 2075 7365 722d 696e 666f 202c 2022 4022   user-info , "@"
+00003e60: 205d 202c 2067 7270 632d 7461 7267 6574   ] , grpc-target
+00003e70: 2c20 7b20 222c 2220 2c20 6772 7063 2d74  , { "," , grpc-t
+00003e80: 6172 6765 7420 7d20 2c20 5b20 223f 2220  arget } , [ "?" 
+00003e90: 2c20 7175 6572 792d 7374 7269 6e67 205d  , query-string ]
+00003ea0: 203b 0a0a 496e 2074 6865 2022 6573 6462   ;..In the "esdb
+00003eb0: 2220 5552 4920 7363 6865 6d65 2c20 6166  " URI scheme, af
+00003ec0: 7465 7220 7468 6520 6f70 7469 6f6e 616c  ter the optional
+00003ed0: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
+00003ee0: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
+00003ef0: 2061 7420 6c65 6173 740a 6f6e 6520 6752   at least.one gR
+00003f00: 5043 2074 6172 6765 742e 2049 6620 7468  PC target. If th
+00003f10: 6572 6520 6172 6520 7365 7665 7261 6c20  ere are several 
+00003f20: 6752 5043 2074 6172 6765 7473 2c20 7468  gRPC targets, th
+00003f30: 6579 206d 7573 7420 6265 2073 6570 6172  ey must be separ
+00003f40: 6174 6564 2066 726f 6d20 6561 6368 0a6f  ated from each.o
+00003f50: 7468 6572 2077 6974 6820 7468 6520 222c  ther with the ",
+00003f60: 2220 6368 6172 6163 7465 722e 2045 6163  " character. Eac
+00003f70: 6820 6752 5043 2074 6172 6765 7420 7368  h gRPC target sh
+00003f80: 6f75 6c64 2069 6e64 6963 6174 6520 616e  ould indicate an
+00003f90: 2045 7665 6e74 5374 6f72 6544 4220 6752   EventStoreDB gR
+00003fa0: 5043 0a73 6572 7665 7220 736f 636b 6574  PC.server socket
+00003fb0: 2c20 6279 2073 7065 6369 6679 696e 6720  , by specifying 
+00003fc0: 6120 686f 7374 2061 6e64 2061 2070 6f72  a host and a por
+00003fd0: 7420 6e75 6d62 6572 2073 6570 6172 6174  t number separat
+00003fe0: 6564 2077 6974 6820 7468 6520 223a 2220  ed with the ":" 
+00003ff0: 6368 6172 6163 7465 722e 0a54 6865 2068  character..The h
+00004000: 6f73 7420 6d61 7920 6265 2061 2068 6f73  ost may be a hos
+00004010: 746e 616d 6520 7468 6174 2063 616e 2062  tname that can b
+00004020: 6520 7265 736f 6c76 6564 2074 6f20 616e  e resolved to an
+00004030: 2049 5020 6164 6472 6573 732c 206f 7220   IP address, or 
+00004040: 616e 2049 5020 6164 6472 6573 732e 0a0a  an IP address...
+00004050: 2020 2020 6772 7063 2d74 6172 6765 7420      grpc-target 
+00004060: 3d20 2820 686f 7374 6e61 6d65 207c 2069  = ( hostname | i
+00004070: 702d 6164 6472 6573 7320 2920 2c20 223a  p-address ) , ":
+00004080: 2220 2c20 706f 7274 2d6e 756d 6265 7220  " , port-number 
+00004090: 3b0a 0a0a 5468 6520 2265 7364 622b 6469  ;...The "esdb+di
+000040a0: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
+000040b0: 6d65 2063 616e 2062 6520 6465 6669 6e65  me can be define
+000040c0: 6420 696e 2074 6865 2066 6f6c 6c6f 7769  d in the followi
+000040d0: 6e67 2077 6179 2e0a 0a20 2020 2065 7364  ng way...    esd
+000040e0: 622d 6469 7363 6f76 6572 2d75 7269 203d  b-discover-uri =
+000040f0: 2022 6573 6462 2b64 6973 636f 7665 723a   "esdb+discover:
+00004100: 2f2f 2220 2c20 5b20 7573 6572 2d69 6e66  //" , [ user-inf
+00004110: 6f2c 2022 4022 205d 202c 2063 6c75 7374  o, "@" ] , clust
+00004120: 6572 2d64 6f6d 6169 6e6e 616d 6520 2c20  er-domainname , 
+00004130: 5b20 223f 2220 2c20 7175 6572 792d 7374  [ "?" , query-st
+00004140: 7269 6e67 205d 203b 0a0a 496e 2074 6865  ring ] ;..In the
+00004150: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+00004160: 2055 5249 2073 6368 656d 652c 2061 6674   URI scheme, aft
+00004170: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
+00004180: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+00004190: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
+000041a0: 610a 646f 6d61 696e 206e 616d 6520 7768  a.domain name wh
+000041b0: 6963 6820 7368 6f75 6c64 2069 6465 6e74  ich should ident
+000041c0: 6966 7920 6120 636c 7573 7465 7220 6f66  ify a cluster of
+000041d0: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+000041e0: 7276 6572 732e 2054 6865 2063 6c69 656e  rvers. The clien
+000041f0: 7420 7769 6c6c 2075 7365 0a61 2044 4e53  t will use.a DNS
+00004200: 2073 6572 7665 7220 746f 2072 6573 6f6c   server to resol
+00004210: 7665 2074 6865 2064 6f6d 6169 6e20 6e61  ve the domain na
+00004220: 6d65 2074 6f20 6120 6c69 7374 206f 6620  me to a list of 
+00004230: 6164 6472 6573 7365 7320 6f66 2045 7665  addresses of Eve
+00004240: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
+00004250: 732c 0a62 7920 7175 6572 7969 6e67 2066  s,.by querying f
+00004260: 6f72 2027 4127 2072 6563 6f72 6473 2e20  or 'A' records. 
+00004270: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
+00004280: 6520 706f 7274 206e 756d 6265 7220 2232  e port number "2
+00004290: 3131 3322 2077 696c 6c20 6265 2075 7365  113" will be use
+000042a0: 6420 746f 0a63 6f6e 7374 7275 6374 2067  d to.construct g
+000042b0: 5250 4320 7461 7267 6574 7320 6672 6f6d  RPC targets from
+000042c0: 2074 6865 2061 6464 7265 7373 6573 206f   the addresses o
+000042d0: 6274 6169 6e65 6420 6672 6f6d 2027 4127  btained from 'A'
+000042e0: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
+000042f0: 6420 6279 2074 6865 0a44 4e53 2073 6572  d by the.DNS ser
+00004300: 7665 722e 2054 6865 7265 666f 7265 2c20  ver. Therefore, 
+00004310: 6966 2079 6f75 2077 616e 7420 746f 2075  if you want to u
+00004320: 7365 2074 6865 2022 6573 6462 2b64 6973  se the "esdb+dis
+00004330: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
+00004340: 652c 2079 6f75 2077 696c 6c0a 6e65 6564  e, you will.need
+00004350: 2074 6f20 636f 6e66 6967 7572 6520 444e   to configure DN
+00004360: 5320 7768 656e 2073 6574 7469 6e67 2075  S when setting u
+00004370: 7020 796f 7572 2045 7665 6e74 5374 6f72  p your EventStor
+00004380: 6544 4220 636c 7573 7465 722e 0a0a 5769  eDB cluster...Wi
+00004390: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
+000043a0: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
+000043b0: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
+000043c0: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
+000043d0: 6972 7374 6c79 206f 6274 6169 6e73 0a61  irstly obtains.a
+000043e0: 206c 6973 7420 6f66 2067 5250 4320 7461   list of gRPC ta
+000043f0: 7267 6574 733a 2065 6974 6865 7220 6469  rgets: either di
+00004400: 7265 6374 6c79 2066 726f 6d20 2265 7364  rectly from "esd
+00004410: 6222 2063 6f6e 6e65 6374 696f 6e20 7374  b" connection st
+00004420: 7269 6e67 733b 206f 7220 696e 6469 7265  rings; or indire
+00004430: 6374 6c79 0a66 726f 6d20 2265 7364 622b  ctly.from "esdb+
+00004440: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
+00004450: 7469 6f6e 2073 7472 696e 6773 2076 6961  tion strings via
+00004460: 2044 4e53 2e20 5468 6973 206c 6973 7420   DNS. This list 
+00004470: 6f66 2074 6172 6765 7473 2069 7320 6b6e  of targets is kn
+00004480: 6f77 6e20 6173 2074 6865 0a22 676f 7373  own as the."goss
+00004490: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
+000044a0: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
+000044b0: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
+000044c0: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
+000044d0: 6172 6765 7420 696e 2074 7572 6e2c 0a61  arget in turn,.a
+000044e0: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
+000044f0: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
+00004500: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
+00004510: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
+00004520: 696f 6e20 6162 6f75 7420 7468 650a 4576  ion about the.Ev
+00004530: 656e 7453 746f 7265 4442 2063 6c75 7374  entStoreDB clust
+00004540: 6572 2e20 4120 6d65 6d62 6572 206f 6620  er. A member of 
+00004550: 7468 6520 636c 7573 7465 7220 6973 2073  the cluster is s
+00004560: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
+00004570: 6c69 656e 742c 2061 6363 6f72 6469 6e67  lient, according
+00004580: 0a74 6f20 7468 6520 226e 6f64 6520 7072  .to the "node pr
+00004590: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
+000045a0: 2e20 5468 6520 636c 6965 6e74 206d 6179  . The client may
+000045b0: 2074 6865 6e20 6e65 6564 2074 6f20 636c   then need to cl
+000045c0: 6f73 6520 6974 730a 636f 6e6e 6563 7469  ose its.connecti
+000045d0: 6f6e 2061 6e64 2072 6563 6f6e 6e65 6374  on and reconnect
+000045e0: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
+000045f0: 2073 6572 7665 722e 0a0a 2323 2320 5573   server...### Us
+00004600: 6572 2069 6e66 6f20 7374 7269 6e67 0a0a  er info string..
+00004610: 496e 2062 6f74 6820 7468 6520 2265 7364  In both the "esd
+00004620: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
+00004630: 636f 7665 7222 2073 6368 656d 6573 2c20  cover" schemes, 
+00004640: 7468 6520 5552 4920 6d61 7920 696e 636c  the URI may incl
+00004650: 7564 6520 6120 7573 6572 2069 6e66 6f20  ude a user info 
+00004660: 7374 7269 6e67 2e0a 4966 2069 7420 6578  string..If it ex
+00004670: 6973 7473 2069 6e20 7468 6520 5552 492c  ists in the URI,
+00004680: 2074 6865 2075 7365 7220 696e 666f 2073   the user info s
+00004690: 7472 696e 6720 6d75 7374 2062 6520 7365  tring must be se
+000046a0: 7061 7261 7465 6420 6672 6f6d 2074 6865  parated from the
+000046b0: 2072 6573 7420 6f66 2074 6865 2055 5249   rest of the URI
+000046c0: 0a77 6974 6820 7468 6520 2240 2220 6368  .with the "@" ch
+000046d0: 6172 6163 7465 722e 2054 6865 2075 7365  aracter. The use
+000046e0: 7220 696e 666f 2073 7472 696e 6720 6d75  r info string mu
+000046f0: 7374 2069 6e63 6c75 6465 2061 2075 7365  st include a use
+00004700: 726e 616d 6520 616e 6420 6120 7061 7373  rname and a pass
+00004710: 776f 7264 2c0a 7365 7061 7261 7465 6420  word,.separated 
+00004720: 7769 7468 2074 6865 2022 3a22 2063 6861  with the ":" cha
+00004730: 7261 6374 6572 2e0a 0a20 2020 2075 7365  racter...    use
+00004740: 722d 696e 666f 203d 2075 7365 726e 616d  r-info = usernam
+00004750: 6520 2c20 223a 2220 2c20 7061 7373 776f  e , ":" , passwo
+00004760: 7264 203b 0a0a 5468 6520 7573 6572 2069  rd ;..The user i
+00004770: 6e66 6f20 6973 2073 656e 7420 6279 2074  nfo is sent by t
+00004780: 6865 2063 6c69 656e 7420 6173 2022 6361  he client as "ca
+00004790: 6c6c 2063 7265 6465 6e74 6961 6c73 2220  ll credentials" 
+000047a0: 696e 2065 6163 6820 6361 6c6c 2074 6f20  in each call to 
+000047b0: 6120 2273 6563 7572 6522 0a73 6572 7665  a "secure".serve
+000047c0: 722c 2069 6e20 6120 2262 6173 6963 2061  r, in a "basic a
+000047d0: 7574 6822 2061 7574 686f 7269 7a61 7469  uth" authorizati
+000047e0: 6f6e 2068 6561 6465 722e 2054 6869 7320  on header. This 
+000047f0: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
+00004800: 6164 6572 2069 7320 7573 6564 2062 790a  ader is used by.
+00004810: 7468 6520 7365 7276 6572 2074 6f20 6175  the server to au
+00004820: 7468 656e 7469 6361 7465 2074 6865 2063  thenticate the c
+00004830: 6c69 656e 742e 2054 6865 2061 7574 686f  lient. The autho
+00004840: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
+00004850: 6973 206e 6f74 2073 656e 7420 746f 0a22  is not sent to."
+00004860: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+00004870: 732e 0a0a 2323 2320 5175 6572 7920 7374  s...### Query st
+00004880: 7269 6e67 0a0a 496e 2062 6f74 6820 7468  ring..In both th
+00004890: 6520 2265 7364 6222 2061 6e64 2022 6573  e "esdb" and "es
+000048a0: 6462 2b64 6973 636f 7665 7222 2073 6368  db+discover" sch
+000048b0: 656d 6573 2c20 7468 6520 6f70 7469 6f6e  emes, the option
+000048c0: 616c 2071 7565 7279 2073 7472 696e 6720  al query string 
+000048d0: 6d75 7374 2062 6520 6f6e 650a 6f72 206d  must be one.or m
+000048e0: 616e 7920 6669 656c 642d 7661 6c75 6520  any field-value 
+000048f0: 6172 6775 6d65 6e74 732c 2073 6570 6172  arguments, separ
+00004900: 6174 6564 2066 726f 6d20 6561 6368 206f  ated from each o
+00004910: 7468 6572 2077 6974 6820 7468 6520 2226  ther with the "&
+00004920: 2220 6368 6172 6163 7465 722e 0a0a 2020  " character...  
+00004930: 2020 7175 6572 792d 7374 7269 6e67 203d    query-string =
+00004940: 2066 6965 6c64 2d76 616c 7565 2c20 7b20   field-value, { 
+00004950: 2226 222c 2066 6965 6c64 2d76 616c 7565  "&", field-value
+00004960: 207d 203b 0a0a 4561 6368 2066 6965 6c64   } ;..Each field
+00004970: 2d76 616c 7565 2061 7267 756d 656e 7420  -value argument 
+00004980: 6d75 7374 2062 6520 6f6e 6520 6f66 2074  must be one of t
+00004990: 6865 2073 7570 706f 7274 6564 2066 6965  he supported fie
+000049a0: 6c64 732c 2061 6e64 2061 6e0a 6170 7072  lds, and an.appr
+000049b0: 6f70 7269 6174 6520 7661 6c75 652c 2073  opriate value, s
+000049c0: 6570 6172 6174 6564 2077 6974 6820 7468  eparated with th
+000049d0: 6520 223d 2220 6368 6172 6163 7465 722e  e "=" character.
+000049e0: 0a0a 2020 2020 6669 656c 642d 7661 6c75  ..    field-valu
+000049f0: 6520 3d20 2820 2254 6c73 222c 2022 3d22  e = ( "Tls", "="
+00004a00: 202c 2022 7472 7565 2220 7c20 2266 616c   , "true" | "fal
+00004a10: 7365 2220 290a 2020 2020 2020 2020 2020  se" ).          
+00004a20: 2020 2020 2020 7c20 2820 2254 6c73 5665        | ( "TlsVe
+00004a30: 7269 6679 4365 7274 222c 2022 3d22 202c  rifyCert", "=" ,
+00004a40: 2022 7472 7565 2220 7c20 2266 616c 7365   "true" | "false
+00004a50: 2220 290a 2020 2020 2020 2020 2020 2020  " ).            
+00004a60: 2020 2020 7c20 2820 2243 6f6e 6e65 6374      | ( "Connect
+00004a70: 696f 6e4e 616d 6522 2c20 223d 2220 2c20  ionName", "=" , 
+00004a80: 7374 7269 6e67 2029 0a20 2020 2020 2020  string ).       
+00004a90: 2020 2020 2020 2020 207c 2028 2022 4e6f           | ( "No
+00004aa0: 6465 5072 6566 6572 656e 6365 222c 2022  dePreference", "
+00004ab0: 3d22 202c 2022 6c65 6164 6572 2220 7c20  =" , "leader" | 
+00004ac0: 2266 6f6c 6c6f 7765 7222 207c 2022 7265  "follower" | "re
+00004ad0: 6164 6f6e 6c79 7265 706c 6963 6122 207c  adonlyreplica" |
+00004ae0: 2022 7261 6e64 6f6d 2220 290a 2020 2020   "random" ).    
+00004af0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00004b00: 2244 6566 6175 6c74 4465 6164 6c69 6e65  "DefaultDeadline
+00004b10: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
+00004b20: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00004b30: 2020 207c 2028 2022 476f 7373 6970 5469     | ( "GossipTi
+00004b40: 6d65 6f75 7422 2c20 223d 2220 2c20 696e  meout", "=" , in
+00004b50: 7465 6765 7220 290a 2020 2020 2020 2020  teger ).        
+00004b60: 2020 2020 2020 2020 7c20 2820 224d 6178          | ( "Max
+00004b70: 4469 7363 6f76 6572 4174 7465 6d70 7473  DiscoverAttempts
+00004b80: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
+00004b90: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00004ba0: 2020 207c 2028 2022 4469 7363 6f76 6572     | ( "Discover
+00004bb0: 7949 6e74 6572 7661 6c22 2c20 223d 2220  yInterval", "=" 
+00004bc0: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
+00004bd0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00004be0: 224d 6178 4469 7363 6f76 6572 4174 7465  "MaxDiscoverAtte
+00004bf0: 6d70 7473 222c 2022 3d22 202c 2069 6e74  mpts", "=" , int
+00004c00: 6567 6572 2029 0a20 2020 2020 2020 2020  eger ).         
+00004c10: 2020 2020 2020 207c 2028 2022 4b65 6570         | ( "Keep
+00004c20: 416c 6976 6549 6e74 6572 7661 6c22 2c20  AliveInterval", 
+00004c30: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
+00004c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c50: 7c20 2820 224b 6565 7041 6c69 7665 496e  | ( "KeepAliveIn
+00004c60: 7465 7276 616c 222c 2022 3d22 202c 2069  terval", "=" , i
+00004c70: 6e74 6567 6572 2029 203b 0a0a 5468 6520  nteger ) ;..The 
+00004c80: 7461 626c 6520 6265 6c6f 7720 6465 7363  table below desc
+00004c90: 7269 6265 7320 7468 6520 7175 6572 7920  ribes the query 
+00004ca0: 6669 656c 642d 7661 6c75 6573 2073 7570  field-values sup
+00004cb0: 706f 7274 6564 2062 7920 7468 6973 2063  ported by this c
+00004cc0: 6c69 656e 742e 0a0a 7c20 4669 656c 6420  lient...| Field 
+00004cd0: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00004ce0: 5661 6c75 6520 2020 2020 2020 2020 2020  Value           
+00004cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d20: 2020 2020 2020 7c20 4465 7363 7269 7074        | Descript
+00004d30: 696f 6e20 2020 2020 2020 2020 2020 2020  ion             
+00004d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004dc0: 2020 2020 2020 2020 2020 7c0a 7c2d 2d2d            |.|---
+00004dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004de0: 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  --|-------------
+00004df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e20: 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d  ----------|-----
+00004e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c0a  --------------|.
+00004ed0: 7c20 546c 7320 2020 2020 2020 2020 2020  | Tls           
+00004ee0: 2020 2020 2020 7c20 2274 7275 6522 2c20        | "true", 
+00004ef0: 2266 616c 7365 2220 2864 6566 6175 6c74  "false" (default
+00004f00: 3a20 2274 7275 6522 2920 2020 2020 2020  : "true")       
+00004f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f20: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00004f30: 4966 2022 7472 7565 2220 7468 6520 636c  If "true" the cl
+00004f40: 6965 6e74 2077 696c 6c20 6372 6561 7465  ient will create
+00004f50: 2061 2022 7365 6375 7265 2220 6752 5043   a "secure" gRPC
+00004f60: 2063 6861 6e6e 656c 2e20 4966 2022 6661   channel. If "fa
+00004f70: 6c73 6522 2074 6865 2063 6c69 656e 7420  lse" the client 
+00004f80: 7769 6c6c 2063 7265 6174 6520 616e 2022  will create an "
+00004f90: 696e 7365 6375 7265 2220 6752 5043 2063  insecure" gRPC c
+00004fa0: 6861 6e6e 656c 2e20 5468 6973 206d 7573  hannel. This mus
+00004fb0: 7420 6d61 7463 6820 7468 6520 7365 7276  t match the serv
+00004fc0: 6572 2063 6f6e 6669 6775 7261 7469 6f6e  er configuration
+00004fd0: 2e20 7c0a 7c20 546c 7356 6572 6966 7943  . |.| TlsVerifyC
+00004fe0: 6572 7420 2020 2020 2020 7c20 2274 7275  ert       | "tru
+00004ff0: 6522 2c20 2266 616c 7365 2220 2864 6566  e", "false" (def
+00005000: 6175 6c74 3a20 2274 7275 6522 2920 2020  ault: "true")   
+00005010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005030: 2020 7c20 5468 6973 2076 616c 7565 2069    | This value i
+00005040: 7320 6375 7272 656e 746c 7920 6967 6e6f  s currently igno
+00005050: 7265 642e 2020 2020 2020 2020 2020 2020  red.            
+00005060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050d0: 2020 2020 2020 7c0a 7c20 436f 6e6e 6563        |.| Connec
+000050e0: 7469 6f6e 4e61 6d65 2020 2020 2020 7c20  tionName      | 
+000050f0: 7374 7269 6e67 2028 6465 6661 756c 743a  string (default:
+00005100: 2061 7574 6f2d 6765 6e65 7261 7465 6420   auto-generated 
+00005110: 7665 7273 696f 6e2d 3420 5555 4944 2920  version-4 UUID) 
+00005120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005130: 2020 2020 2020 7c20 5365 6e74 2069 6e20        | Sent in 
+00005140: 6361 6c6c 206d 6574 6164 6174 6120 666f  call metadata fo
+00005150: 7220 6576 6572 7920 6361 6c6c 2c20 746f  r every call, to
+00005160: 2069 6465 6e74 6966 7920 7468 6520 636c   identify the cl
+00005170: 6965 6e74 2074 6f20 7468 6520 636c 7573  ient to the clus
+00005180: 7465 722e 2020 2020 2020 2020 2020 2020  ter.            
+00005190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051d0: 2020 2020 2020 2020 2020 7c0a 7c20 4e6f            |.| No
+000051e0: 6465 5072 6566 6572 656e 6365 2020 2020  dePreference    
+000051f0: 2020 7c20 226c 6561 6465 7222 2c20 2266    | "leader", "f
+00005200: 6f6c 6c6f 7765 7222 2c20 2272 6561 646f  ollower", "reado
+00005210: 6e6c 7972 6570 6c69 6361 222c 2022 7261  nlyreplica", "ra
+00005220: 6e64 6f6d 2220 2864 6566 6175 6c74 3a20  ndom" (default: 
+00005230: 226c 6561 6465 7222 2920 7c20 5468 6520  "leader") | The 
+00005240: 6e6f 6465 2073 7461 7465 2070 7265 6665  node state prefe
+00005250: 7272 6564 2062 7920 7468 6520 636c 6965  rred by the clie
+00005260: 6e74 2e20 5468 6520 636c 6965 6e74 2077  nt. The client w
+00005270: 696c 6c20 7365 6c65 6374 2061 206e 6f64  ill select a nod
+00005280: 6520 6672 6f6d 2074 6865 2063 6c75 7374  e from the clust
+00005290: 6572 2069 6e66 6f20 7265 6365 6976 6564  er info received
+000052a0: 2066 726f 6d20 7468 6520 476f 7373 6970   from the Gossip
+000052b0: 2041 5049 2061 6363 6f72 6469 6e67 2074   API according t
+000052c0: 6f20 7468 6973 2070 7265 6665 7265 6e63  o this preferenc
+000052d0: 652e 2020 2020 2020 2020 2020 2020 7c0a  e.            |.
+000052e0: 7c20 4465 6661 756c 7444 6561 646c 696e  | DefaultDeadlin
+000052f0: 6520 2020 2020 7c20 696e 7465 6765 7220  e     | integer 
+00005300: 2864 6566 6175 6c74 3a20 604e 6f6e 6560  (default: `None`
+00005310: 2920 2020 2020 2020 2020 2020 2020 2020  )               
+00005320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005330: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00005340: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+00005350: 6520 2869 6e20 7365 636f 6e64 7329 206f  e (in seconds) o
+00005360: 6620 7468 6520 6074 696d 656f 7574 6020  f the `timeout` 
+00005370: 6172 6775 6d65 6e74 206f 6620 636c 6965  argument of clie
+00005380: 6e74 2022 7772 6974 6522 206d 6574 686f  nt "write" metho
+00005390: 6473 2073 7563 6820 6173 2060 6170 7065  ds such as `appe
+000053a0: 6e64 5f65 7665 6e74 7328 2960 2e20 2020  nd_events()`.   
+000053b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053e0: 2020 7c0a 7c20 476f 7373 6970 5469 6d65    |.| GossipTime
+000053f0: 6f75 7420 2020 2020 2020 7c20 696e 7465  out       | inte
+00005400: 6765 7220 2864 6566 6175 6c74 3a20 3529  ger (default: 5)
+00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005440: 2020 7c20 5468 6520 6465 6661 756c 7420    | The default 
+00005450: 7661 6c75 6520 2869 6e20 7365 636f 6e64  value (in second
+00005460: 7329 206f 6620 7468 6520 6074 696d 656f  s) of the `timeo
+00005470: 7574 6020 6172 6775 6d65 6e74 206f 6620  ut` argument of 
+00005480: 676f 7373 6970 2072 6561 6420 6d65 7468  gossip read meth
+00005490: 6f64 732c 2073 7563 6820 6173 2060 7265  ods, such as `re
+000054a0: 6164 5f67 6f73 7369 7028 2960 2e20 2020  ad_gossip()`.   
+000054b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054e0: 2020 2020 2020 7c0a 7c20 4d61 7844 6973        |.| MaxDis
+000054f0: 636f 7665 7241 7474 656d 7074 7320 7c20  coverAttempts | 
+00005500: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
+00005510: 3a20 3130 2920 2020 2020 2020 2020 2020  : 10)           
+00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005540: 2020 2020 2020 7c20 5468 6520 6e75 6d62        | The numb
+00005550: 6572 206f 6620 6174 7465 6d70 7473 2074  er of attempts t
+00005560: 6f20 7265 6164 2067 6f73 7369 7020 7768  o read gossip wh
+00005570: 656e 2063 6f6e 6e65 6374 696e 6720 6f72  en connecting or
+00005580: 2072 6563 6f6e 6e65 6374 696e 6720 746f   reconnecting to
+00005590: 2061 2063 6c75 7374 6572 206d 656d 6265   a cluster membe
+000055a0: 722e 2020 2020 2020 2020 2020 2020 2020  r.              
+000055b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055e0: 2020 2020 2020 2020 2020 7c0a 7c20 4469            |.| Di
+000055f0: 7363 6f76 6572 7949 6e74 6572 7661 6c20  scoveryInterval 
+00005600: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
+00005610: 6175 6c74 3a20 3130 3029 2020 2020 2020  ault: 100)      
+00005620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005640: 2020 2020 2020 2020 2020 7c20 486f 7720            | How 
+00005650: 6c6f 6e67 2074 6f20 7761 6974 2028 696e  long to wait (in
+00005660: 206d 696c 6c69 7365 636f 6e64 7329 2062   milliseconds) b
+00005670: 6574 7765 656e 2067 6f73 7369 7020 7265  etween gossip re
+00005680: 7472 6965 732e 2020 2020 2020 2020 2020  tries.          
+00005690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056e0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+000056f0: 7c20 4b65 6570 416c 6976 6549 6e74 6572  | KeepAliveInter
+00005700: 7661 6c20 2020 7c20 696e 7465 6765 7220  val   | integer 
+00005710: 2864 6566 6175 6c74 3a20 604e 6f6e 6560  (default: `None`
+00005720: 2920 2020 2020 2020 2020 2020 2020 2020  )               
+00005730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005740: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00005750: 5468 6520 7661 6c75 6520 6f66 2074 6865  The value of the
+00005760: 2022 6772 7063 2e6b 6565 7061 6c69 7665   "grpc.keepalive
+00005770: 5f6d 7322 2067 5250 4320 6368 616e 6e65  _ms" gRPC channe
+00005780: 6c20 6f70 7469 6f6e 2e20 2020 2020 2020  l option.       
+00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057f0: 2020 7c0a 7c20 4b65 6570 416c 6976 6554    |.| KeepAliveT
+00005800: 696d 656f 7574 2020 2020 7c20 696e 7465  imeout    | inte
+00005810: 6765 7220 2864 6566 6175 6c74 3a20 604e  ger (default: `N
+00005820: 6f6e 6560 2920 2020 2020 2020 2020 2020  one`)           
+00005830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005850: 2020 7c20 5468 6520 7661 6c75 6520 6f66    | The value of
+00005860: 2074 6865 2022 6772 7063 2e6b 6565 7061   the "grpc.keepa
+00005870: 6c69 7665 5f74 696d 656f 7574 5f6d 7322  live_timeout_ms"
+00005880: 2067 5250 4320 6368 616e 6e65 6c20 6f70   gRPC channel op
+00005890: 7469 6f6e 2e20 2020 2020 2020 2020 2020  tion.           
+000058a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058f0: 2020 2020 2020 7c0a 0a0a 2323 2320 4578        |...### Ex
+00005900: 616d 706c 6573 0a0a 4865 7265 2061 7265  amples..Here are
+00005910: 2073 6f6d 6520 6578 616d 706c 6573 206f   some examples o
+00005920: 6620 4576 656e 7453 746f 7265 4442 2063  f EventStoreDB c
+00005930: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00005940: 2055 5249 732e 0a0a 5468 6520 666f 6c6c   URIs...The foll
+00005950: 6f77 696e 6720 5552 4920 7769 6c6c 2063  owing URI will c
+00005960: 6175 7365 2074 6865 2063 6c69 656e 7420  ause the client 
+00005970: 746f 2063 6f6e 6e65 6374 2074 6f2c 2061  to connect to, a
+00005980: 6e64 2067 6574 0a63 6c75 7374 6572 2069  nd get.cluster i
+00005990: 6e66 6f2c 2066 726f 6d20 2273 6563 7572  nfo, from "secur
+000059a0: 6522 2073 6572 7665 7220 736f 636b 6574  e" server socket
+000059b0: 2060 6c6f 6361 6c68 6f73 743a 3231 3133   `localhost:2113
+000059c0: 602e 2041 6e64 0a74 6865 6e20 746f 2063  `. And.then to c
+000059d0: 6f6e 6e65 6374 2074 6f20 6120 226c 6561  onnect to a "lea
+000059e0: 6465 7222 206e 6f64 652e 2041 6e64 2061  der" node. And a
+000059f0: 6c73 6f20 746f 2075 7365 2022 6164 6d69  lso to use "admi
+00005a00: 6e22 2061 6e64 0a22 6368 616e 6765 6974  n" and."changeit
+00005a10: 2220 6173 2074 6865 2075 7365 726e 616d  " as the usernam
+00005a20: 6520 616e 6420 7061 7373 776f 7264 2077  e and password w
+00005a30: 6865 6e20 6d61 6b69 6e67 2063 616c 6c73  hen making calls
+00005a40: 2074 6f0a 4576 656e 7453 746f 7265 4442   to.EventStoreDB
+00005a50: 2041 5049 206d 6574 686f 6473 2e0a 0a20   API methods... 
+00005a60: 2020 2065 7364 623a 2f2f 6164 6d69 6e3a     esdb://admin:
+00005a70: 6368 616e 6765 6974 406c 6f63 616c 686f  changeit@localho
+00005a80: 7374 3a32 3131 330a 0a0a 5468 6520 666f  st:2113...The fo
+00005a90: 6c6c 6f77 696e 6720 5552 4920 7769 6c6c  llowing URI will
+00005aa0: 2063 6175 7365 2074 6865 2063 6c69 656e   cause the clien
+00005ab0: 7420 746f 2067 6574 2063 6c75 7374 6572  t to get cluster
+00005ac0: 2069 6e66 6f20 6672 6f6d 0a22 696e 7365   info from."inse
+00005ad0: 6375 7265 2220 7365 7276 6572 2073 6f63  cure" server soc
+00005ae0: 6b65 7420 3132 372e 302e 302e 313a 3231  ket 127.0.0.1:21
+00005af0: 3134 2e20 2041 6e64 2074 6865 6e20 746f  14.  And then to
+00005b00: 2063 6f6e 6e65 6374 2074 6f0a 6120 226c   connect to.a "l
+00005b10: 6561 6465 7222 206e 6f64 652e 0a0a 2020  eader" node...  
+00005b20: 2020 6573 6462 3a2f 2f31 3237 2e30 2e30    esdb://127.0.0
+00005b30: 2e31 3a32 3131 343f 546c 733d 6661 6c73  .1:2114?Tls=fals
+00005b40: 650a 0a0a 5468 6520 666f 6c6c 6f77 696e  e...The followin
+00005b50: 6720 5552 4920 7769 6c6c 2063 6175 7365  g URI will cause
+00005b60: 2074 6865 2063 6c69 656e 7420 746f 2067   the client to g
+00005b70: 6574 2063 6c75 7374 6572 2069 6e66 6f20  et cluster info 
+00005b80: 6672 6f6d 0a61 6464 7265 7373 6573 2069  from.addresses i
+00005b90: 6e20 444e 5320 2741 2720 7265 636f 7264  n DNS 'A' record
+00005ba0: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
+00005bb0: 7861 6d70 6c65 2e63 6f6d 2e20 416e 6420  xample.com. And 
+00005bc0: 7468 656e 0a74 6f20 636f 6e6e 6563 7420  then.to connect 
+00005bd0: 746f 2061 2022 6c65 6164 6572 2220 6e6f  to a "leader" no
+00005be0: 6465 2e20 416e 6420 7573 6520 6120 6465  de. And use a de
+00005bf0: 6661 756c 7420 6465 6164 6c69 6e65 206f  fault deadline o
+00005c00: 6620 350a 7365 636f 6e64 7320 7768 656e  f 5.seconds when
+00005c10: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
+00005c20: 2045 7665 6e74 5374 6f72 6520 4150 4920   EventStore API 
+00005c30: 2277 7269 7465 2220 6d65 7468 6f64 732e  "write" methods.
+00005c40: 0a0a 2020 2020 6573 6462 2b64 6973 636f  ..    esdb+disco
+00005c50: 7665 723a 2f2f 6164 6d69 6e3a 6368 616e  ver://admin:chan
+00005c60: 6765 6974 4063 6c75 7374 6572 312e 6578  geit@cluster1.ex
+00005c70: 616d 706c 652e 636f 6d3f 4465 6661 756c  ample.com?Defaul
+00005c80: 7444 6561 646c 696e 653d 350a 0a0a 5468  tDeadline=5...Th
+00005c90: 6520 666f 6c6c 6f77 696e 6720 5552 4920  e following URI 
+00005ca0: 7769 6c6c 2063 6175 7365 2074 6865 2063  will cause the c
+00005cb0: 6c69 656e 7420 746f 2067 6574 2063 6c75  lient to get clu
+00005cc0: 7374 6572 2069 6e66 6f20 6672 6f6d 2065  ster info from e
+00005cd0: 6974 6865 720a 6c6f 6361 6c68 6f73 743a  ither.localhost:
+00005ce0: 3231 3131 2c20 6f72 206c 6f63 616c 686f  2111, or localho
+00005cf0: 7374 3a32 3131 322c 206f 7220 6c6f 6361  st:2112, or loca
+00005d00: 6c68 6f73 743a 3231 3133 2e20 416e 6420  lhost:2113. And 
+00005d10: 7468 656e 2074 6f20 636f 6e6e 6563 740a  then to connect.
+00005d20: 746f 2061 2022 666f 6c6c 6f77 6572 2220  to a "follower" 
+00005d30: 6e6f 6465 2e0a 0a20 2020 2065 7364 623a  node...    esdb:
+00005d40: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
+00005d50: 406c 6f63 616c 686f 7374 3a32 3131 312c  @localhost:2111,
+00005d60: 6c6f 6361 6c68 6f73 743a 3231 3132 2c6c  localhost:2112,l
+00005d70: 6f63 616c 686f 7374 3a32 3131 333f 4e6f  ocalhost:2113?No
+00005d80: 6465 5072 6566 6572 656e 6365 3d66 6f6c  dePreference=fol
+00005d90: 6c6f 7765 720a 0a0a 5468 6520 666f 6c6c  lower...The foll
+00005da0: 6f77 696e 6720 5552 4920 7769 6c6c 2063  owing URI will c
+00005db0: 6175 7365 2074 6865 2063 6c69 656e 7420  ause the client 
+00005dc0: 746f 2067 6574 2063 6c75 7374 6572 2069  to get cluster i
+00005dd0: 6e66 6f20 6672 6f6d 2061 6464 7265 7373  nfo from address
+00005de0: 6573 2069 6e0a 444e 5320 2741 2720 7265  es in.DNS 'A' re
+00005df0: 636f 7264 7320 666f 7220 636c 7573 7465  cords for cluste
+00005e00: 7231 2e65 7861 6d70 6c65 2e63 6f6d 2e20  r1.example.com. 
+00005e10: 416e 6420 746f 2063 6f6e 6669 6775 7265  And to configure
+00005e20: 2022 6b65 6570 2061 6c69 7665 2220 7469   "keep alive" ti
+00005e30: 6d65 6f75 740a 616e 6420 696e 7465 7276  meout.and interv
+00005e40: 616c 2069 6e20 7468 6520 6752 5043 2063  al in the gRPC c
+00005e50: 6861 6e6e 656c 2e0a 0a20 2020 2065 7364  hannel...    esd
+00005e60: 622b 6469 7363 6f76 6572 3a2f 2f61 646d  b+discover://adm
+00005e70: 696e 3a63 6861 6e67 6569 7440 636c 7573  in:changeit@clus
+00005e80: 7465 7231 2e65 7861 6d70 6c65 2e63 6f6d  ter1.example.com
+00005e90: 3f4b 6565 7041 6c69 7665 496e 7465 7276  ?KeepAliveInterv
+00005ea0: 616c 3d31 3030 3030 264b 6565 7041 6c69  al=10000&KeepAli
+00005eb0: 7665 5469 6d65 6f75 743d 3130 3030 300a  veTimeout=10000.
+00005ec0: 0a0a 506c 6561 7365 206e 6f74 652c 2074  ..Please note, t
+00005ed0: 6865 2063 6c69 656e 7420 6973 2069 6e73  he client is ins
+00005ee0: 656e 7369 7469 7665 2074 6f20 7468 6520  ensitive to the 
+00005ef0: 6361 7365 206f 6620 6669 656c 6473 2061  case of fields a
+00005f00: 6e64 2076 616c 7565 732e 2049 6620 6669  nd values. If fi
+00005f10: 656c 6473 2061 7265 0a72 6570 6561 7465  elds are.repeate
+00005f20: 6420 696e 2074 6865 2071 7565 7279 2073  d in the query s
+00005f30: 7472 696e 672c 2074 6865 2071 7565 7279  tring, the query
+00005f40: 2073 7472 696e 6720 7769 6c6c 2062 6520   string will be 
+00005f50: 7061 7273 6564 2077 6974 686f 7574 2065  parsed without e
+00005f60: 7272 6f72 2e20 486f 7765 7665 722c 0a74  rror. However,.t
+00005f70: 6865 2063 6f6e 6e65 6374 696f 6e20 6f70  he connection op
+00005f80: 7469 6f6e 7320 7573 6564 2062 7920 7468  tions used by th
+00005f90: 6520 636c 6965 6e74 2077 696c 6c20 7573  e client will us
+00005fa0: 6520 7468 6520 7661 6c75 6520 6f66 2074  e the value of t
+00005fb0: 6865 2066 6972 7374 2066 6965 6c64 2e20  he first field. 
+00005fc0: 416c 6c0a 7468 6520 6f74 6865 7220 6669  All.the other fi
+00005fd0: 656c 642d 7661 6c75 6573 2069 6e20 7468  eld-values in th
+00005fe0: 6520 7175 6572 7920 7374 7269 6e67 2077  e query string w
+00005ff0: 6974 6820 7468 6520 7361 6d65 2066 6965  ith the same fie
+00006000: 6c64 206e 616d 6520 7769 6c6c 2062 6520  ld name will be 
+00006010: 6967 6e6f 7265 642e 0a46 6965 6c64 7320  ignored..Fields 
+00006020: 7769 7468 6f75 7420 7661 6c75 6573 2077  without values w
+00006030: 696c 6c20 616c 736f 2062 6520 6967 6e6f  ill also be igno
+00006040: 7265 642e 0a0a 4966 2074 6865 2063 6c69  red...If the cli
+00006050: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
+00006060: 7265 6e63 6520 6973 2022 6c65 6164 6572  rence is "leader
+00006070: 2220 616e 6420 7468 6520 6e6f 6465 2062  " and the node b
+00006080: 6563 6f6d 6573 2061 0a22 666f 6c6c 6f77  ecomes a."follow
+00006090: 6572 222c 2074 6865 2063 6c69 656e 7420  er", the client 
+000060a0: 7769 6c6c 2061 7474 656d 7074 2074 6f20  will attempt to 
+000060b0: 7265 636f 6e6e 6563 7420 746f 2074 6865  reconnect to the
+000060c0: 2063 7572 7265 6e74 206c 6561 6465 7220   current leader 
+000060d0: 7768 656e 2061 206d 6574 686f 640a 6973  when a method.is
+000060e0: 2063 616c 6c65 6420 7468 6174 2065 7870   called that exp
+000060f0: 6563 7473 2074 6f20 6361 6c6c 2061 206c  ects to call a l
+00006100: 6561 6465 722e 204d 6574 686f 6473 2077  eader. Methods w
+00006110: 6869 6368 206d 7574 6174 6520 7468 6520  hich mutate the 
+00006120: 7374 6174 6520 6f66 2074 6865 2064 6174  state of the dat
+00006130: 6162 6173 650a 6578 7065 6374 2074 6f20  abase.expect to 
+00006140: 6361 6c6c 2061 206c 6561 6465 722e 2046  call a leader. F
+00006150: 6f72 2073 7563 6820 6d65 7468 6f64 732c  or such methods,
+00006160: 2074 6865 2048 5454 5020 6865 6164 6572   the HTTP header
+00006170: 2022 7265 7175 6972 6573 2d6c 6561 6465   "requires-leade
+00006180: 7222 2069 7320 7365 7420 746f 0a22 7472  r" is set to."tr
+00006190: 7565 222c 2061 6e64 2074 6869 7320 6865  ue", and this he
+000061a0: 6164 6572 2069 7320 6f62 7365 7276 6564  ader is observed
+000061b0: 2062 7920 7468 6520 7365 7276 6572 2c20   by the server, 
+000061c0: 616e 6420 736f 2061 206e 6f64 6520 7768  and so a node wh
+000061d0: 6963 6820 6973 206e 6f74 2061 206c 6561  ich is not a lea
+000061e0: 6465 720a 7468 6174 2072 6563 6569 7665  der.that receive
+000061f0: 7320 7375 6368 2061 2072 6571 7565 7374  s such a request
+00006200: 2077 696c 6c20 7265 7475 726e 2061 6e20   will return an 
+00006210: 6572 726f 722e 2054 6869 7320 6572 726f  error. This erro
+00006220: 7220 6973 2064 6574 6563 7465 6420 6279  r is detected by
+00006230: 2074 6865 2063 6c69 656e 742c 0a77 6869   the client,.whi
+00006240: 6368 2077 696c 6c20 7468 656e 2063 6c6f  ch will then clo
+00006250: 7365 2074 6865 2063 7572 7265 6e74 2067  se the current g
+00006260: 5250 4320 636f 6e6e 6563 7469 6f6e 2061  RPC connection a
+00006270: 6e64 2063 7265 6174 6520 6120 6e65 7720  nd create a new 
+00006280: 636f 6e6e 6563 7469 6f6e 2074 6f20 7468  connection to th
+00006290: 650a 6c65 6164 6572 2e20 5468 6520 7265  e.leader. The re
+000062a0: 7175 6573 7420 7769 6c6c 2074 6865 6e20  quest will then 
+000062b0: 6265 2072 6574 7269 6564 2077 6974 6820  be retried with 
+000062c0: 7468 6520 6c65 6164 6572 2e0a 0a49 6620  the leader...If 
+000062d0: 7468 6520 636c 6965 6e74 2773 206e 6f64  the client's nod
+000062e0: 6520 7072 6566 6572 656e 6365 2069 7320  e preference is 
+000062f0: 2266 6f6c 6c6f 7765 7222 2061 6e64 2074  "follower" and t
+00006300: 6865 7265 2061 7265 206e 6f20 666f 6c6c  here are no foll
+00006310: 6f77 6572 0a6e 6f64 6573 2069 6e20 7468  ower.nodes in th
+00006320: 6520 636c 7573 7465 722c 2074 6865 6e20  e cluster, then 
+00006330: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
+00006340: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
+00006350: 6f6e 2e20 5369 6d69 6c61 726c 792c 2069  on. Similarly, i
+00006360: 6620 7468 650a 636c 6965 6e74 2773 206e  f the.client's n
+00006370: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
+00006380: 7320 2272 6561 646f 6e6c 7972 6570 6c69  s "readonlyrepli
+00006390: 6361 2220 616e 6420 7468 6572 6520 6172  ca" and there ar
+000063a0: 6520 6e6f 2072 6561 642d 6f6e 6c79 2072  e no read-only r
+000063b0: 6570 6c69 6361 0a6e 6f64 6573 2069 6e20  eplica.nodes in 
+000063c0: 7468 6520 636c 7573 7465 722c 2074 6865  the cluster, the
+000063d0: 6e20 7468 6520 636c 6965 6e74 2077 696c  n the client wil
+000063e0: 6c20 616c 736f 2072 6169 7365 2061 6e20  l also raise an 
+000063f0: 6578 6365 7074 696f 6e2e 0a0a 5468 6520  exception...The 
+00006400: 6752 5043 2063 6861 6e6e 656c 206f 7074  gRPC channel opt
+00006410: 696f 6e20 2267 7270 632e 6d61 785f 7265  ion "grpc.max_re
+00006420: 6365 6976 655f 6d65 7373 6167 655f 6c65  ceive_message_le
+00006430: 6e67 7468 2220 6973 2061 7574 6f6d 6174  ngth" is automat
+00006440: 6963 616c 6c79 0a63 6f6e 6669 6775 7265  ically.configure
+00006450: 6420 746f 2074 6865 2076 616c 7565 2060  d to the value `
+00006460: 3137 202a 2031 3032 3420 2a20 3130 3234  17 * 1024 * 1024
+00006470: 602e 2054 6869 7320 7661 6c75 6520 6361  `. This value ca
+00006480: 6e6e 6f74 2062 6520 6368 616e 6765 642e  nnot be changed.
+00006490: 0a0a 0a23 2320 4576 656e 7420 6f62 6a65  ...## Event obje
+000064a0: 6374 730a 0a54 6869 7320 7061 636b 6167  cts..This packag
+000064b0: 6520 6465 6669 6e65 7320 6120 604e 6577  e defines a `New
+000064c0: 4576 656e 7460 2063 6c61 7373 2061 6e64  Event` class and
+000064d0: 2061 2060 5265 636f 7264 6564 4576 656e   a `RecordedEven
+000064e0: 7460 2063 6c61 7373 2e20 5468 650a 604e  t` class. The.`N
+000064f0: 6577 4576 656e 7460 2063 6c61 7373 2073  ewEvent` class s
+00006500: 686f 756c 6420 6265 2075 7365 6420 7768  hould be used wh
+00006510: 656e 2077 7269 7469 6e67 2065 7665 6e74  en writing event
+00006520: 7320 746f 2074 6865 2064 6174 6162 6173  s to the databas
+00006530: 652e 2054 6865 0a60 5265 636f 7264 6564  e. The.`Recorded
+00006540: 4576 656e 7460 2063 6c61 7373 2069 7320  Event` class is 
+00006550: 7573 6564 2077 6865 6e20 7265 6164 696e  used when readin
+00006560: 6720 6576 656e 7473 2066 726f 6d20 7468  g events from th
+00006570: 6520 6461 7461 6261 7365 2e0a 0a23 2323  e database...###
+00006580: 204e 6577 2065 7665 6e74 730a 0a54 6865   New events..The
+00006590: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
+000065a0: 7320 7368 6f75 6c64 2062 6520 7573 6564  s should be used
+000065b0: 2077 6865 6e20 7772 6974 696e 6720 6576   when writing ev
+000065c0: 656e 7473 2074 6f20 616e 2045 7665 6e74  ents to an Event
+000065d0: 5374 6f72 6544 4220 6461 7461 6261 7365  StoreDB database
+000065e0: 2e0a 596f 7520 7769 6c6c 206e 6565 6420  ..You will need 
+000065f0: 746f 2063 6f6e 7374 7275 6374 206e 6577  to construct new
+00006600: 2065 7665 6e74 206f 626a 6563 7473 2062   event objects b
+00006610: 6566 6f72 6520 6361 6c6c 696e 6720 7468  efore calling th
+00006620: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+00006630: 2829 600a 616e 6420 6061 7070 656e 645f  ()`.and `append_
+00006640: 6576 656e 7428 2960 206d 6574 686f 6473  event()` methods
+00006650: 2e0a 0a54 6865 2060 4e65 7745 7665 6e74  ...The `NewEvent
+00006660: 6020 636c 6173 7320 6973 2061 2066 726f  ` class is a fro
+00006670: 7a65 6e20 5079 7468 6f6e 2064 6174 6162  zen Python datab
+00006680: 6173 652e 2049 7420 6861 7320 7477 6f20  ase. It has two 
+00006690: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
+000066a0: 6374 6f72 0a61 7267 756d 656e 7473 2028  ctor.arguments (
+000066b0: 6074 7970 6560 2061 6e64 2060 6461 7461  `type` and `data
+000066c0: 6029 2061 6e64 2074 6872 6565 206f 7074  `) and three opt
+000066d0: 696f 6e61 6c20 636f 6e73 7472 7563 746f  ional constructo
+000066e0: 7220 6172 6775 6d65 6e74 7320 2860 6d65  r arguments (`me
+000066f0: 7461 6461 7461 602c 0a60 636f 6e74 656e  tadata`,.`conten
+00006700: 745f 7479 7065 6020 616e 6420 6069 6460  t_type` and `id`
+00006710: 292e 0a0a 5468 6520 7265 7175 6972 6564  )...The required
+00006720: 2060 7479 7065 6020 6172 6775 6d65 6e74   `type` argument
+00006730: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+00006740: 7260 2c20 7573 6564 2074 6f20 6465 7363  r`, used to desc
+00006750: 7269 6265 2074 6865 2074 7970 6520 6f66  ribe the type of
+00006760: 0a64 6f6d 6169 6e20 6576 656e 7420 7468  .domain event th
+00006770: 6174 2069 7320 6265 696e 6720 7265 636f  at is being reco
+00006780: 7264 6564 2e0a 0a54 6865 2072 6571 7569  rded...The requi
+00006790: 7265 6420 6064 6174 6160 2061 7267 756d  red `data` argum
+000067a0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+000067b0: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
+000067c0: 7573 6564 2074 6f20 7374 6174 6520 7468  used to state th
+000067d0: 650a 7365 7269 616c 697a 6564 2064 6174  e.serialized dat
+000067e0: 6120 6f66 2074 6865 2064 6f6d 6169 6e20  a of the domain 
+000067f0: 6576 656e 7420 7468 6174 2069 7320 6265  event that is be
+00006800: 696e 6720 7265 636f 7264 6564 2e0a 0a54  ing recorded...T
+00006810: 6865 206f 7074 696f 6e61 6c20 606d 6574  he optional `met
+00006820: 6164 6174 6160 2061 7267 756d 656e 7420  adata` argument 
+00006830: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
+00006840: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
+00006850: 2074 6f20 696e 6469 6361 7465 2061 6e79   to indicate any
+00006860: 0a6d 6574 6164 6174 6120 6f66 2074 6865  .metadata of the
+00006870: 2065 7665 6e74 2074 6861 7420 7769 6c6c   event that will
+00006880: 2062 6520 7265 636f 7264 6564 2e20 5468   be recorded. Th
+00006890: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000068a0: 6973 2061 6e20 656d 7074 7920 6062 7974  is an empty `byt
+000068b0: 6573 600a 6f62 6a65 6374 2e0a 0a54 6865  es`.object...The
+000068c0: 206f 7074 696f 6e61 6c20 6063 6f6e 7465   optional `conte
+000068d0: 6e74 5f74 7970 6560 2061 7267 756d 656e  nt_type` argumen
+000068e0: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
+000068f0: 7472 602c 2075 7365 6420 746f 2069 6e64  tr`, used to ind
+00006900: 6963 6174 6520 7468 650a 6b69 6e64 206f  icate the.kind o
+00006910: 6620 6461 7461 2074 6861 7420 6973 2062  f data that is b
+00006920: 6569 6e67 2072 6563 6f72 6465 642e 2054  eing recorded. T
+00006930: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00006940: 2069 7320 6027 6170 706c 6963 6174 696f   is `'applicatio
+00006950: 6e2f 6a73 6f6e 2760 2c0a 7768 6963 6820  n/json'`,.which 
+00006960: 696e 6469 6361 7465 7320 7468 6174 2074  indicates that t
+00006970: 6865 2060 6461 7461 6020 7761 7320 7365  he `data` was se
+00006980: 7269 616c 6973 6564 2075 7369 6e67 204a  rialised using J
+00006990: 534f 4e2e 2041 6e20 616c 7465 726e 6174  SON. An alternat
+000069a0: 6976 6520 7661 6c75 650a 666f 7220 7468  ive value.for th
+000069b0: 6973 2061 7267 756d 656e 7420 6973 2074  is argument is t
+000069c0: 6865 206d 6f72 6520 6765 6e65 7261 6c20  he more general 
+000069d0: 696e 6469 6361 7469 6f6e 2060 2761 7070  indication `'app
+000069e0: 6c69 6361 7469 6f6e 2f6f 6374 6574 2d73  lication/octet-s
+000069f0: 7472 6561 6d27 602e 0a0a 5468 6520 6f70  tream'`...The op
+00006a00: 7469 6f6e 616c 2060 6964 6020 6172 6775  tional `id` argu
+00006a10: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00006a20: 2060 5555 4944 6020 6f62 6a65 6374 2c20   `UUID` object, 
+00006a30: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
+00006a40: 7468 6520 756e 6971 7565 2049 440a 6f66  the unique ID.of
+00006a50: 2074 6865 2065 7665 6e74 2074 6861 7420   the event that 
+00006a60: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+00006a70: 2e20 4966 206e 6f20 7661 6c75 6520 6973  . If no value is
+00006a80: 2070 726f 7669 6465 642c 2061 206e 6577   provided, a new
+00006a90: 2076 6572 7369 6f6e 2d34 2055 5549 440a   version-4 UUID.
+00006aa0: 7769 6c6c 2062 6520 6765 6e65 7261 7465  will be generate
+00006ab0: 642e 0a0a 6060 6070 7974 686f 6e0a 6e65  d...```python.ne
+00006ac0: 775f 6576 656e 7431 203d 204e 6577 4576  w_event1 = NewEv
+00006ad0: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
+00006ae0: 7264 6572 4372 6561 7465 6427 2c0a 2020  rderCreated',.  
+00006af0: 2020 6461 7461 3d62 277b 226e 616d 6522    data=b'{"name"
+00006b00: 3a20 2247 7265 6722 7d27 2c0a 290a 6173  : "Greg"}',.).as
+00006b10: 7365 7274 206e 6577 5f65 7665 6e74 312e  sert new_event1.
+00006b20: 7479 7065 203d 3d20 274f 7264 6572 4372  type == 'OrderCr
+00006b30: 6561 7465 6427 0a61 7373 6572 7420 6e65  eated'.assert ne
+00006b40: 775f 6576 656e 7431 2e64 6174 6120 3d3d  w_event1.data ==
+00006b50: 2062 277b 226e 616d 6522 3a20 2247 7265   b'{"name": "Gre
+00006b60: 6722 7d27 0a61 7373 6572 7420 6e65 775f  g"}'.assert new_
+00006b70: 6576 656e 7431 2e6d 6574 6164 6174 6120  event1.metadata 
+00006b80: 3d3d 2062 2727 0a61 7373 6572 7420 6e65  == b''.assert ne
+00006b90: 775f 6576 656e 7431 2e63 6f6e 7465 6e74  w_event1.content
+00006ba0: 5f74 7970 6520 3d3d 2027 6170 706c 6963  _type == 'applic
+00006bb0: 6174 696f 6e2f 6a73 6f6e 270a 6173 7365  ation/json'.asse
+00006bc0: 7274 2069 7369 6e73 7461 6e63 6528 6e65  rt isinstance(ne
+00006bd0: 775f 6576 656e 7431 2e69 642c 2075 7569  w_event1.id, uui
+00006be0: 642e 5555 4944 290a 0a65 7665 6e74 5f69  d.UUID)..event_i
+00006bf0: 6420 3d20 7575 6964 2e75 7569 6434 2829  d = uuid.uuid4()
+00006c00: 0a6e 6577 5f65 7665 6e74 3220 3d20 4e65  .new_event2 = Ne
+00006c10: 7745 7665 6e74 280a 2020 2020 7479 7065  wEvent(.    type
+00006c20: 3d27 496d 6167 6543 7265 6174 6564 272c  ='ImageCreated',
+00006c30: 0a20 2020 2064 6174 613d 6227 3031 3031  .    data=b'0101
+00006c40: 3031 3031 3031 3031 3031 272c 0a20 2020  0101010101',.   
+00006c50: 206d 6574 6164 6174 613d 6227 7b22 6122   metadata=b'{"a"
+00006c60: 3a20 317d 272c 0a20 2020 2063 6f6e 7465  : 1}',.    conte
+00006c70: 6e74 5f74 7970 653d 2761 7070 6c69 6361  nt_type='applica
+00006c80: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
+00006c90: 6d27 2c0a 2020 2020 6964 3d65 7665 6e74  m',.    id=event
+00006ca0: 5f69 642c 0a29 0a61 7373 6572 7420 6e65  _id,.).assert ne
+00006cb0: 775f 6576 656e 7432 2e74 7970 6520 3d3d  w_event2.type ==
+00006cc0: 2027 496d 6167 6543 7265 6174 6564 270a   'ImageCreated'.
+00006cd0: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
+00006ce0: 322e 6461 7461 203d 3d20 6227 3031 3031  2.data == b'0101
+00006cf0: 3031 3031 3031 3031 3031 270a 6173 7365  0101010101'.asse
+00006d00: 7274 206e 6577 5f65 7665 6e74 322e 6d65  rt new_event2.me
+00006d10: 7461 6461 7461 203d 3d20 6227 7b22 6122  tadata == b'{"a"
+00006d20: 3a20 317d 270a 6173 7365 7274 206e 6577  : 1}'.assert new
+00006d30: 5f65 7665 6e74 322e 636f 6e74 656e 745f  _event2.content_
+00006d40: 7479 7065 203d 3d20 2761 7070 6c69 6361  type == 'applica
+00006d50: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
+00006d60: 6d27 0a61 7373 6572 7420 6e65 775f 6576  m'.assert new_ev
+00006d70: 656e 7432 2e69 6420 3d3d 2065 7665 6e74  ent2.id == event
+00006d80: 5f69 640a 6060 600a 0a23 2323 2052 6563  _id.```..### Rec
+00006d90: 6f72 6465 6420 6576 656e 7473 0a0a 5468  orded events..Th
+00006da0: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
+00006db0: 6020 636c 6173 7320 6973 2075 7365 6420  ` class is used 
+00006dc0: 7768 656e 2072 6561 6469 6e67 2065 7665  when reading eve
+00006dd0: 6e74 7320 6672 6f6d 2061 6e20 4576 656e  nts from an Even
+00006de0: 7453 746f 7265 4442 0a64 6174 6162 6173  tStoreDB.databas
+00006df0: 652e 2054 6865 2063 6c69 656e 7420 7769  e. The client wi
+00006e00: 6c6c 2072 6574 7572 6e20 6576 656e 7420  ll return event 
+00006e10: 6f62 6a65 6374 7320 6f66 2074 6869 7320  objects of this 
+00006e20: 7479 7065 2066 726f 6d20 616c 6c20 6d65  type from all me
+00006e30: 7468 6f64 730a 7468 6174 2072 6574 7572  thods.that retur
+00006e40: 6e20 7265 636f 7264 6564 2065 7665 6e74  n recorded event
+00006e50: 732c 2073 7563 6820 6173 2060 7265 6164  s, such as `read
+00006e60: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00006e70: 602c 2060 7375 6273 6372 6962 655f 616c  `, `subscribe_al
+00006e80: 6c5f 6576 656e 7473 2829 602c 0a61 6e64  l_events()`,.and
+00006e90: 2060 7265 6164 5f73 7562 7363 7269 7074   `read_subscript
+00006ea0: 696f 6e28 2960 2e20 596f 7520 646f 206e  ion()`. You do n
+00006eb0: 6f74 206e 6565 6420 746f 2063 6f6e 7374  ot need to const
+00006ec0: 7275 6374 2072 6563 6f72 6465 6420 6576  ruct recorded ev
+00006ed0: 656e 7420 6f62 6a65 6374 732e 0a0a 4c69  ent objects...Li
+00006ee0: 6b65 2060 4e65 7745 7665 6e74 602c 2074  ke `NewEvent`, t
+00006ef0: 6865 2060 5265 636f 7264 6564 4576 656e  he `RecordedEven
+00006f00: 7460 2063 6c61 7373 2069 7320 616c 736f  t` class is also
+00006f10: 2061 2066 726f 7a65 6e20 5079 7468 6f6e   a frozen Python
+00006f20: 2064 6174 6162 6173 652e 2049 7420 6861   database. It ha
+00006f30: 730a 616c 6c20 7468 6520 6174 7472 6962  s.all the attrib
+00006f40: 7574 6573 2074 6861 7420 604e 6577 4576  utes that `NewEv
+00006f50: 656e 7460 2068 6173 2028 6074 7970 6560  ent` has (`type`
+00006f60: 2c20 6064 6174 6160 2c20 606d 6574 6164  , `data`, `metad
+00006f70: 6174 6160 2c20 6063 6f6e 7465 6e74 5f74  ata`, `content_t
+00006f80: 7970 6560 2c20 6069 6460 290a 616e 6420  ype`, `id`).and 
+00006f90: 736f 6d65 2061 6464 6974 696f 6e61 6c20  some additional 
+00006fa0: 6174 7472 6962 7574 6573 2074 6861 7420  attributes that 
+00006fb0: 666f 6c6c 6f77 2066 726f 6d20 7468 6520  follow from the 
+00006fc0: 6661 6374 2074 6861 7420 616e 2065 7665  fact that an eve
+00006fd0: 6e74 2077 6173 2072 6563 6f72 6465 640a  nt was recorded.
+00006fe0: 2860 7374 7265 616d 5f6e 616d 6560 2c20  (`stream_name`, 
+00006ff0: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
+00007000: 602c 2060 636f 6d6d 6974 5f70 6f73 6974  `, `commit_posit
+00007010: 696f 6e60 292e 0a0a 5468 6520 6074 7970  ion`)...The `typ
+00007020: 6560 2061 7474 7269 6275 7465 2069 7320  e` attribute is 
+00007030: 6120 5079 7468 6f6e 2060 7374 7260 2c20  a Python `str`, 
+00007040: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00007050: 2074 6865 2074 7970 6520 6f66 2061 6e20   the type of an 
+00007060: 6576 656e 740a 7468 6174 2077 6173 2072  event.that was r
+00007070: 6563 6f72 6465 642e 0a0a 5468 6520 6064  ecorded...The `d
+00007080: 6174 6160 2061 7474 7269 6275 7465 2069  ata` attribute i
+00007090: 7320 6120 5079 7468 6f6e 2060 6279 7465  s a Python `byte
+000070a0: 7360 206f 626a 6563 742c 2075 7365 6420  s` object, used 
+000070b0: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
+000070c0: 6461 7461 206f 6620 616e 0a65 7665 6e74  data of an.event
+000070d0: 2074 6861 7420 7761 7320 7265 636f 7264   that was record
+000070e0: 6564 2e0a 0a54 6865 2060 6d65 7461 6461  ed...The `metada
+000070f0: 7461 6020 6174 7472 6962 7574 6520 6973  ta` attribute is
+00007100: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
+00007110: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
+00007120: 6f20 696e 6469 6361 7465 2074 6865 206d  o indicate the m
+00007130: 6574 6164 6174 6120 6f66 0a61 6e20 6576  etadata of.an ev
+00007140: 656e 7420 7468 6174 2077 6173 2072 6563  ent that was rec
+00007150: 6f72 6465 642e 0a0a 5468 6520 6063 6f6e  orded...The `con
+00007160: 7465 6e74 5f74 7970 6560 2061 7474 7269  tent_type` attri
+00007170: 6275 7465 2069 7320 6120 5079 7468 6f6e  bute is a Python
+00007180: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
+00007190: 696e 6469 6361 7465 2074 6865 2074 7970  indicate the typ
+000071a0: 6520 6f66 0a64 6174 6120 7468 6174 2077  e of.data that w
+000071b0: 6173 2072 6563 6f72 6465 6420 666f 7220  as recorded for 
+000071c0: 616e 2065 7665 6e74 2e20 4974 2069 7320  an event. It is 
+000071d0: 7573 7561 6c6c 7920 6061 7070 6c69 6361  usually `applica
+000071e0: 7469 6f6e 2f6a 736f 6e60 2c20 696e 6469  tion/json`, indi
+000071f0: 6361 7469 6e67 0a74 6861 7420 7468 6520  cating.that the 
+00007200: 6461 7461 2063 616e 2062 6520 7061 7273  data can be pars
+00007210: 6564 2061 7320 4a53 4f4e 2e20 416c 7465  ed as JSON. Alte
+00007220: 726e 6174 6976 656c 792c 2069 7420 6973  rnatively, it is
+00007230: 2060 6170 706c 6963 6174 696f 6e2f 6f63   `application/oc
+00007240: 7465 742d 7374 7265 616d 602e 0a0a 5468  tet-stream`...Th
+00007250: 6520 6069 6460 2061 7474 7269 6275 7465  e `id` attribute
+00007260: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
+00007270: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
+00007280: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00007290: 2075 6e69 7175 6520 4944 206f 6620 616e   unique ID of an
+000072a0: 0a65 7665 6e74 2074 6861 7420 7761 7320  .event that was 
+000072b0: 7265 636f 7264 6564 2e0a 0a54 6865 2060  recorded...The `
+000072c0: 7374 7265 616d 5f6e 616d 6560 2061 7474  stream_name` att
+000072d0: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+000072e0: 6f6e 2060 7374 7260 2c20 7573 6564 2074  on `str`, used t
+000072f0: 6f20 696e 6469 6361 7465 2074 6865 206e  o indicate the n
+00007300: 616d 6520 6f66 2061 0a73 7472 6561 6d20  ame of a.stream 
+00007310: 696e 2077 6869 6368 2061 6e20 6576 656e  in which an even
+00007320: 7420 7761 7320 7265 636f 7264 6564 2e0a  t was recorded..
+00007330: 0a54 6865 2060 7374 7265 616d 5f70 6f73  .The `stream_pos
+00007340: 6974 696f 6e60 2061 7474 7269 6275 7465  ition` attribute
+00007350: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
+00007360: 7460 2c20 7573 6564 2074 6f20 696e 6469  t`, used to indi
+00007370: 6361 7465 2074 6865 2070 6f73 6974 696f  cate the positio
+00007380: 6e20 696e 2061 0a73 7472 6561 6d20 6174  n in a.stream at
+00007390: 2077 6869 6368 2061 6e20 6576 656e 7420   which an event 
+000073a0: 7761 7320 7265 636f 7264 6564 2e0a 0a49  was recorded...I
+000073b0: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
+000073c0: 6120 2273 7472 6561 6d20 706f 7369 7469  a "stream positi
+000073d0: 6f6e 2220 6973 2061 6e20 696e 7465 6765  on" is an intege
+000073e0: 7220 7265 7072 6573 656e 7469 6e67 2074  r representing t
+000073f0: 6865 2070 6f73 6974 696f 6e20 6f66 2061  he position of a
+00007400: 0a72 6563 6f72 6465 6420 6576 656e 7420  .recorded event 
+00007410: 696e 2061 2073 7472 6561 6d2e 2045 6163  in a stream. Eac
+00007420: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+00007430: 2069 7320 7265 636f 7264 6564 2061 7420   is recorded at 
+00007440: 6120 706f 7369 7469 6f6e 2069 6e20 6120  a position in a 
+00007450: 7374 7265 616d 2e0a 4561 6368 2073 7472  stream..Each str
+00007460: 6561 6d20 706f 7369 7469 6f6e 2069 7320  eam position is 
+00007470: 6f63 6375 7069 6564 2062 7920 6f6e 6c79  occupied by only
+00007480: 206f 6e65 2072 6563 6f72 6465 6420 6576   one recorded ev
+00007490: 656e 742e 204e 6577 2065 7665 6e74 7320  ent. New events 
+000074a0: 6172 6520 7265 636f 7264 6564 2061 7420  are recorded at 
+000074b0: 7468 650a 6e65 7874 2075 6e6f 6363 7570  the.next unoccup
+000074c0: 6965 6420 706f 7369 7469 6f6e 2e20 416c  ied position. Al
+000074d0: 6c20 7365 7175 656e 6365 7320 6f66 2073  l sequences of s
+000074e0: 7472 6561 6d20 706f 7369 7469 6f6e 7320  tream positions 
+000074f0: 6172 6520 7a65 726f 2d62 6173 6564 2061  are zero-based a
+00007500: 6e64 2067 6170 6c65 7373 2e0a 0a54 6865  nd gapless...The
+00007510: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00007520: 6e60 2061 7474 7269 6275 7465 2069 7320  n` attribute is 
+00007530: 6120 5079 7468 6f6e 2060 696e 7460 2c20  a Python `int`, 
+00007540: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00007550: 2074 6865 2070 6f73 6974 696f 6e20 696e   the position in
+00007560: 2074 6865 0a64 6174 6162 6173 6520 6174   the.database at
+00007570: 2077 6869 6368 2061 6e20 6576 656e 7420   which an event 
+00007580: 7761 7320 7265 636f 7264 6564 2e0a 0a49  was recorded...I
+00007590: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
+000075a0: 6120 2263 6f6d 6d69 7420 706f 7369 7469  a "commit positi
+000075b0: 6f6e 2220 6973 2061 6e20 696e 7465 6765  on" is an intege
+000075c0: 7220 7265 7072 6573 656e 7469 6e67 2074  r representing t
+000075d0: 6865 2070 6f73 6974 696f 6e20 6f66 2061  he position of a
+000075e0: 0a72 6563 6f72 6465 6420 6576 656e 7420  .recorded event 
+000075f0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+00007600: 2045 6163 6820 7265 636f 7264 6564 2065   Each recorded e
+00007610: 7665 6e74 2069 7320 7265 636f 7264 6564  vent is recorded
+00007620: 2061 7420 6120 706f 7369 7469 6f6e 2069   at a position i
+00007630: 6e20 7468 650a 6461 7461 6261 7365 2e20  n the.database. 
+00007640: 4561 6368 2063 6f6d 6d69 7420 706f 7369  Each commit posi
+00007650: 7469 6f6e 2069 7320 6f63 6375 7069 6564  tion is occupied
+00007660: 2062 7920 6f6e 6c79 206f 6e65 2072 6563   by only one rec
+00007670: 6f72 6465 6420 6576 656e 742e 2043 6f6d  orded event. Com
+00007680: 6d69 7420 706f 7369 7469 6f6e 730a 6172  mit positions.ar
+00007690: 6520 7a65 726f 2d62 6173 6564 2061 6e64  e zero-based and
+000076a0: 2069 6e63 7265 6173 6520 6d6f 6e6f 746f   increase monoto
+000076b0: 6e69 6361 6c6c 7920 6173 206e 6577 2065  nically as new e
+000076c0: 7665 6e74 7320 6172 6520 7265 636f 7264  vents are record
+000076d0: 6564 2e20 4275 742c 2075 6e6c 696b 6520  ed. But, unlike 
+000076e0: 7374 7265 616d 0a70 6f73 6974 696f 6e73  stream.positions
+000076f0: 2c20 7468 6520 7365 7175 656e 6365 206f  , the sequence o
+00007700: 6620 7375 6363 6573 7369 7665 2063 6f6d  f successive com
+00007710: 6d69 7420 706f 7369 7469 6f6e 7320 6973  mit positions is
+00007720: 206e 6f74 2067 6170 6c65 7373 2e20 496e   not gapless. In
+00007730: 6465 6564 2c20 7468 6572 6520 6172 650a  deed, there are.
+00007740: 7573 7561 6c6c 7920 6c61 7267 6520 6469  usually large di
+00007750: 6666 6572 656e 6365 7320 6265 7477 6565  fferences betwee
+00007760: 6e20 7468 6520 636f 6d6d 6974 2070 6f73  n the commit pos
+00007770: 6974 696f 6e73 206f 6620 7375 6363 6573  itions of succes
+00007780: 7369 7665 6c79 2072 6563 6f72 6465 6420  sively recorded 
+00007790: 6576 656e 7473 2e0a 0a0a 6060 6070 7974  events....```pyt
+000077a0: 686f 6e0a 6672 6f6d 2065 7364 6263 6c69  hon.from esdbcli
+000077b0: 656e 742e 6576 656e 7473 2069 6d70 6f72  ent.events impor
+000077c0: 7420 5265 636f 7264 6564 4576 656e 740a  t RecordedEvent.
+000077d0: 0a72 6563 6f72 6465 645f 6576 656e 7420  .recorded_event 
+000077e0: 3d20 5265 636f 7264 6564 4576 656e 7428  = RecordedEvent(
+000077f0: 0a20 2020 2074 7970 653d 274f 7264 6572  .    type='Order
+00007800: 4372 6561 7465 6427 2c0a 2020 2020 6461  Created',.    da
+00007810: 7461 3d62 277b 7d27 2c0a 2020 2020 6d65  ta=b'{}',.    me
+00007820: 7461 6461 7461 3d62 2727 2c0a 2020 2020  tadata=b'',.    
+00007830: 636f 6e74 656e 745f 7479 7065 3d27 6170  content_type='ap
+00007840: 706c 6963 6174 696f 6e2f 6a73 6f6e 272c  plication/json',
+00007850: 0a20 2020 2069 643d 7575 6964 2e75 7569  .    id=uuid.uui
+00007860: 6434 2829 2c0a 2020 2020 7374 7265 616d  d4(),.    stream
+00007870: 5f6e 616d 653d 2773 7472 6561 6d31 272c  _name='stream1',
+00007880: 0a20 2020 2073 7472 6561 6d5f 706f 7369  .    stream_posi
+00007890: 7469 6f6e 3d30 2c0a 2020 2020 636f 6d6d  tion=0,.    comm
+000078a0: 6974 5f70 6f73 6974 696f 6e3d 3531 322c  it_position=512,
+000078b0: 0a29 0a60 6060 0a0a 0a23 2320 5374 7265  .).```...## Stre
+000078c0: 616d 730a 0a49 6e20 4576 656e 7453 746f  ams..In EventSto
+000078d0: 7265 4442 2c20 6120 2273 7472 6561 6d22  reDB, a "stream"
+000078e0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+000078f0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+00007900: 7320 7468 6174 2061 6c6c 2068 6176 650a  s that all have.
+00007910: 7468 6520 7361 6d65 2022 7374 7265 616d  the same "stream
+00007920: 206e 616d 6522 2e20 5468 6572 6520 7769   name". There wi
+00007930: 6c6c 206e 6f72 6d61 6c6c 7920 6265 206d  ll normally be m
+00007940: 616e 7920 7374 7265 616d 7320 696e 2061  any streams in a
+00007950: 2064 6174 6162 6173 652c 0a65 6163 6820   database,.each 
+00007960: 7769 7468 206d 616e 7920 7265 636f 7264  with many record
+00007970: 6564 2065 7665 6e74 732e 2045 6163 6820  ed events. Each 
+00007980: 7265 636f 7264 6564 2065 7665 6e74 2068  recorded event h
+00007990: 6173 2061 2070 6f73 6974 696f 6e20 696e  as a position in
+000079a0: 2069 7473 2073 7472 6561 6d0a 2874 6865   its stream.(the
+000079b0: 2022 7374 7265 616d 2070 6f73 6974 696f   "stream positio
+000079c0: 6e22 292c 2061 6e64 2061 2070 6f73 6974  n"), and a posit
+000079d0: 696f 6e20 696e 2074 6865 2064 6174 6162  ion in the datab
+000079e0: 6173 6520 2874 6865 2022 636f 6d6d 6974  ase (the "commit
+000079f0: 2070 6f73 6974 696f 6e22 292e 0a53 7472   position")..Str
+00007a00: 6561 6d20 706f 7369 7469 6f6e 7320 6172  eam positions ar
+00007a10: 6520 7a65 726f 2d62 6173 6564 2061 6e64  e zero-based and
+00007a20: 2067 6170 6c65 7373 2e20 436f 6d6d 6974   gapless. Commit
+00007a30: 2070 6f73 6974 696f 6e73 2061 7265 2061   positions are a
+00007a40: 6c73 6f20 7a65 726f 2d62 6173 6564 2c0a  lso zero-based,.
+00007a50: 6275 7420 6172 6520 6e6f 7420 6761 706c  but are not gapl
+00007a60: 6573 732e 0a0a 5468 6520 6d65 7468 6f64  ess...The method
+00007a70: 7320 6061 7070 656e 645f 6576 656e 7473  s `append_events
+00007a80: 2829 602c 2060 7265 6164 5f73 7472 6561  ()`, `read_strea
+00007a90: 6d5f 6576 656e 7473 2829 6020 616e 6420  m_events()` and 
+00007aa0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00007ab0: 2829 6020 6361 6e0a 6265 2075 7365 6420  ()` can.be used 
+00007ac0: 746f 2072 6561 6420 616e 6420 7265 636f  to read and reco
+00007ad0: 7264 2069 6e20 7468 6520 6461 7461 6261  rd in the databa
+00007ae0: 7365 2e0a 0a23 2323 2041 7070 656e 6420  se...### Append 
+00007af0: 6576 656e 7473 0a0a 2a72 6571 7569 7265  events..*require
+00007b00: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+00007b10: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
+00007b20: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+00007b30: 7365 6420 6174 6f6d 6963 616c 6c79 2074  sed atomically t
+00007b40: 6f20 7265 636f 7264 2061 2073 6571 7565  o record a seque
+00007b50: 6e63 6520 6f66 206e 6577 2065 7665 6e74  nce of new event
+00007b60: 732e 0a49 6620 7468 6520 6f70 6572 6174  s..If the operat
+00007b70: 696f 6e20 6973 2073 7563 6365 7373 6675  ion is successfu
+00007b80: 6c2c 2069 7420 7265 7475 726e 7320 7468  l, it returns th
+00007b90: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00007ba0: 6e20 6f66 2074 6865 206c 6173 7420 6576  n of the last ev
+00007bb0: 656e 7420 696e 2074 6865 0a73 6571 7565  ent in the.seque
+00007bc0: 6e63 6520 7468 6174 2068 6173 2062 6565  nce that has bee
+00007bd0: 6e20 7265 636f 7264 6564 2e0a 0a54 6869  n recorded...Thi
+00007be0: 7320 6d65 7468 6f64 2068 6173 2074 6872  s method has thr
+00007bf0: 6565 2072 6571 7569 7265 6420 6172 6775  ee required argu
+00007c00: 6d65 6e74 732c 2060 7374 7265 616d 5f6e  ments, `stream_n
+00007c10: 616d 6560 2c20 6063 7572 7265 6e74 5f76  ame`, `current_v
+00007c20: 6572 7369 6f6e 600a 616e 6420 6065 7665  ersion`.and `eve
+00007c30: 6e74 7360 2e0a 0a54 6865 2072 6571 7569  nts`...The requi
+00007c40: 7265 6420 6073 7472 6561 6d5f 6e61 6d65  red `stream_name
+00007c50: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00007c60: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
+00007c70: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
+00007c80: 6966 6965 7320 610a 7374 7265 616d 2074  ifies a.stream t
+00007c90: 6f20 7768 6963 6820 6120 7365 7175 656e  o which a sequen
+00007ca0: 6365 206f 6620 6576 656e 7473 2077 696c  ce of events wil
+00007cb0: 6c20 6265 2061 7070 656e 6465 642e 0a0a  l be appended...
+00007cc0: 5468 6520 7265 7175 6972 6564 2060 6375  The required `cu
+00007cd0: 7272 656e 745f 7665 7273 696f 6e60 2061  rrent_version` a
+00007ce0: 7267 756d 656e 7420 6973 2065 7870 6563  rgument is expec
+00007cf0: 7465 6420 746f 2062 6520 6569 7468 6572  ted to be either
+00007d00: 2061 2050 7974 686f 6e20 6069 6e74 600a   a Python `int`.
+00007d10: 7468 6174 2069 6e64 6963 6174 6573 2074  that indicates t
+00007d20: 6865 2073 7472 6561 6d20 706f 7369 7469  he stream positi
+00007d30: 6f6e 206f 6620 7468 6520 6c61 7374 2072  on of the last r
+00007d40: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+00007d50: 2074 6865 2073 7472 6561 6d2c 206f 720a   the stream, or.
+00007d60: 604e 6f6e 6560 2069 6620 7468 6520 7374  `None` if the st
+00007d70: 7265 616d 2064 6f65 7320 6e6f 7420 7965  ream does not ye
+00007d80: 7420 6578 6973 7420 6f72 2068 6173 2062  t exist or has b
+00007d90: 6565 6e20 6465 6c65 7465 642e 2054 6865  een deleted. The
+00007da0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00007db0: 730a 6172 6520 7a65 726f 2d62 6173 6564  s.are zero-based
+00007dc0: 2061 6e64 2067 6170 6c65 7373 2c20 736f   and gapless, so
+00007dd0: 2074 6861 7420 6966 2061 2073 7472 6561   that if a strea
+00007de0: 6d20 6861 7320 7477 6f20 6576 656e 7473  m has two events
+00007df0: 2c20 7468 6520 6063 7572 7265 6e74 5f76  , the `current_v
+00007e00: 6572 7369 6f6e 600a 7368 6f75 6c64 2062  ersion`.should b
+00007e10: 6520 312e 2049 6620 616e 2069 6e63 6f72  e 1. If an incor
+00007e20: 7265 6374 2076 616c 7565 2069 7320 6769  rect value is gi
+00007e30: 7665 6e2c 2074 6869 7320 6d65 7468 6f64  ven, this method
+00007e40: 2077 696c 6c20 7261 6973 6520 610a 6057   will raise a.`W
+00007e50: 726f 6e67 4375 7272 656e 7456 6572 7369  rongCurrentVersi
+00007e60: 6f6e 6020 6578 6365 7074 696f 6e2e 2054  on` exception. T
+00007e70: 6869 7320 6265 6861 7669 6f72 2069 7320  his behavior is 
+00007e80: 6465 7369 676e 6564 2074 6f20 7072 6f76  designed to prov
+00007e90: 6964 6520 636f 6e63 7572 7265 6e63 790a  ide concurrency.
+00007ea0: 636f 6e74 726f 6c20 7768 656e 2072 6563  control when rec
+00007eb0: 6f72 6469 6e67 206e 6577 2065 7665 6e74  ording new event
+00007ec0: 732e 2054 6865 2063 6f72 7265 6374 2076  s. The correct v
+00007ed0: 616c 7565 206f 6620 6063 7572 7265 6e74  alue of `current
+00007ee0: 5f76 6572 7369 6f6e 6020 666f 7220 616e  _version` for an
+00007ef0: 7920 7374 7265 616d 0a63 616e 2062 6520  y stream.can be 
+00007f00: 6f62 7461 696e 6564 2062 7920 6361 6c6c  obtained by call
+00007f10: 696e 6720 6067 6574 5f63 7572 7265 6e74  ing `get_current
+00007f20: 5f76 6572 7369 6f6e 2829 602e 2048 6f77  _version()`. How
+00007f30: 6576 6572 2c20 7468 6520 7479 7069 6361  ever, the typica
+00007f40: 6c20 6170 7072 6f61 6368 2069 7320 746f  l approach is to
+00007f50: 0a75 7365 2074 6865 2073 7472 6561 6d20  .use the stream 
+00007f60: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
+00007f70: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00007f80: 6173 2074 6865 2076 6572 7369 6f6e 206e  as the version n
+00007f90: 756d 6265 7220 6f66 2061 2072 6563 6f6e  umber of a recon
+00007fa0: 7374 7275 6374 6564 0a61 6767 7265 6761  structed.aggrega
+00007fb0: 7465 2c20 616e 6420 746f 2075 7365 2074  te, and to use t
+00007fc0: 6865 2063 7572 7265 6e74 2076 6572 7369  he current versi
+00007fd0: 6f6e 206f 6620 7468 6520 6167 6772 6567  on of the aggreg
+00007fe0: 6174 6520 6173 2074 6865 2060 6375 7272  ate as the `curr
+00007ff0: 656e 745f 7665 7273 696f 6e60 2077 6865  ent_version` whe
+00008000: 6e0a 6170 7065 6e64 696e 6720 6e65 7720  n.appending new 
+00008010: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
+00008020: 2e20 5468 6973 2065 6e73 7572 6573 2074  . This ensures t
+00008030: 6865 2063 6f6e 7369 7374 656e 6379 206f  he consistency o
+00008040: 6620 7468 6520 7265 636f 7264 6564 2073  f the recorded s
+00008050: 7461 7465 206f 660a 7468 6520 6167 6772  tate of.the aggr
+00008060: 6567 6174 652c 2061 6e64 2066 6f72 6365  egate, and force
+00008070: 7320 6f70 6572 6174 696f 6e73 2074 6861  s operations tha
+00008080: 7420 6765 6e65 7261 7465 206e 6577 2061  t generate new a
+00008090: 6767 7265 6761 7465 2065 7665 6e74 7320  ggregate events 
+000080a0: 746f 2062 6520 7265 7472 6965 6420 7769  to be retried wi
+000080b0: 7468 2061 2066 7265 7368 6c79 0a72 6563  th a freshly.rec
+000080c0: 6f6e 7374 7275 6374 6564 2061 6767 7265  onstructed aggre
+000080d0: 6761 7465 2077 6865 6e20 6120 6057 726f  gate when a `Wro
+000080e0: 6e67 4375 7272 656e 7456 6572 7369 6f6e  ngCurrentVersion
+000080f0: 6020 6578 6365 7074 696f 6e20 6973 2065  ` exception is e
+00008100: 6e63 6f75 6e74 6572 6564 2e0a 5468 6973  ncountered..This
+00008110: 2063 6f6e 7472 6f6c 6c69 6e67 2062 6568   controlling beh
+00008120: 6176 696f 7220 6361 6e20 6265 2064 6973  avior can be dis
+00008130: 6162 6c65 6420 6279 2073 6574 7469 6e67  abled by setting
+00008140: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+00008150: 650a 6063 7572 7265 6e74 5f76 6572 7369  e.`current_versi
+00008160: 6f6e 6020 6172 6775 6d65 6e74 2074 6f20  on` argument to 
+00008170: 602d 3160 2e0a 0a54 6865 2072 6571 7569  `-1`...The requi
+00008180: 7265 6420 6065 7665 6e74 7360 2061 7267  red `events` arg
+00008190: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
+000081a0: 6420 746f 2062 6520 6120 7365 7175 656e  d to be a sequen
+000081b0: 6365 206f 6620 6e65 7720 6576 656e 7420  ce of new event 
+000081c0: 6f62 6a65 6374 732e 2054 6865 0a60 4e65  objects. The.`Ne
+000081d0: 7745 7665 6e74 6020 636c 6173 7320 7368  wEvent` class sh
+000081e0: 6f75 6c64 2062 6520 7573 6564 2074 6f20  ould be used to 
+000081f0: 636f 6e73 7472 7563 7420 6e65 7720 6576  construct new ev
+00008200: 656e 7420 6f62 6a65 6374 732e 2054 6865  ent objects. The
+00008210: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00008220: 2960 0a6f 7065 7261 7469 6f6e 2069 7320  )`.operation is 
+00008230: 6174 6f6d 6963 2c20 736f 2074 6861 7420  atomic, so that 
+00008240: 6569 7468 6572 2061 6c6c 206f 7220 6e6f  either all or no
+00008250: 6e65 206f 6620 7468 6520 6e65 7720 6576  ne of the new ev
+00008260: 656e 7473 2077 696c 6c20 6265 2072 6563  ents will be rec
+00008270: 6f72 6465 642e 2049 740a 6973 206e 6f74  orded. It.is not
+00008280: 2070 6f73 7369 626c 6520 7769 7468 2045   possible with E
+00008290: 7665 6e74 5374 6f72 6544 4220 6174 6f6d  ventStoreDB atom
+000082a0: 6963 616c 6c79 2074 6f20 7265 636f 7264  ically to record
+000082b0: 206e 6577 2065 7665 6e74 7320 696e 206d   new events in m
+000082c0: 6f72 6520 7468 616e 206f 6e65 2073 7472  ore than one str
+000082d0: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
+000082e0: 6420 616c 736f 2068 6173 2061 6e20 6f70  d also has an op
+000082f0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00008300: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00008310: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00008320: 6f61 7460 0a74 6861 7420 7365 7473 2061  oat`.that sets a
+00008330: 2064 6561 646c 696e 6520 666f 7220 7468   deadline for th
+00008340: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+00008350: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+00008360: 6f6e 2e0a 0a49 6e20 7468 6520 6578 616d  on...In the exam
+00008370: 706c 6520 6265 6c6f 772c 2061 206e 6577  ple below, a new
+00008380: 2065 7665 6e74 2c20 6065 7665 6e74 3160   event, `event1`
+00008390: 2c20 6973 2061 7070 656e 6465 6420 746f  , is appended to
+000083a0: 2061 206e 6577 2073 7472 6561 6d2e 2054   a new stream. T
+000083b0: 6865 0a73 7472 6561 6d20 646f 6573 206e  he.stream does n
+000083c0: 6f74 2079 6574 2065 7869 7374 2c20 736f  ot yet exist, so
+000083d0: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
+000083e0: 6e60 2069 7320 604e 6f6e 6560 2e0a 0a60  n` is `None`...`
+000083f0: 6060 7079 7468 6f6e 0a23 2043 6f6e 7374  ``python.# Const
+00008400: 7275 6374 2061 206e 6577 2065 7665 6e74  ruct a new event
+00008410: 206f 626a 6563 742e 0a65 7665 6e74 3120   object..event1 
+00008420: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
+00008430: 274f 7264 6572 4372 6561 7465 6427 2c20  'OrderCreated', 
+00008440: 6461 7461 3d62 2764 6174 6131 2729 0a0a  data=b'data1')..
+00008450: 2320 4465 6669 6e65 2061 206e 6577 2073  # Define a new s
+00008460: 7472 6561 6d20 6e61 6d65 2e0a 7374 7265  tream name..stre
+00008470: 616d 5f6e 616d 6531 203d 2073 7472 2875  am_name1 = str(u
+00008480: 7569 642e 7575 6964 3428 2929 0a0a 2320  uid.uuid4())..# 
+00008490: 4170 7065 6e64 2074 6865 206e 6577 2065  Append the new e
+000084a0: 7665 6e74 7320 746f 2074 6865 206e 6577  vents to the new
+000084b0: 2073 7472 6561 6d2e 0a63 6f6d 6d69 745f   stream..commit_
+000084c0: 706f 7369 7469 6f6e 3120 3d20 636c 6965  position1 = clie
+000084d0: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+000084e0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+000084f0: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
+00008500: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+00008510: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 6576  ion=None,.    ev
+00008520: 656e 7473 3d5b 6576 656e 7431 5d2c 0a29  ents=[event1],.)
+00008530: 0a60 6060 0a0a 496e 2074 6865 2065 7861  .```..In the exa
+00008540: 6d70 6c65 2062 656c 6f77 2c20 7477 6f20  mple below, two 
+00008550: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
+00008560: 7320 6172 6520 6170 7065 6e64 6564 2074  s are appended t
+00008570: 6f20 616e 2065 7869 7374 696e 670a 7374  o an existing.st
+00008580: 7265 616d 2e20 5468 6520 7374 7265 616d  ream. The stream
+00008590: 2c20 6073 7472 6561 6d5f 6e61 6d65 3160  , `stream_name1`
+000085a0: 2c20 736f 2066 6172 2068 6173 206f 6e65  , so far has one
+000085b0: 2072 6563 6f72 6465 6420 6576 656e 742c   recorded event,
+000085c0: 2061 6e64 2073 6f0a 7468 6520 636f 7272   and so.the corr
+000085d0: 6563 7420 7661 6c75 6520 6f66 2060 6375  ect value of `cu
+000085e0: 7272 656e 745f 7665 7273 696f 6e60 2069  rrent_version` i
+000085f0: 7320 6030 602e 0a0a 6060 6070 7974 686f  s `0`...```pytho
+00008600: 6e0a 6576 656e 7432 203d 204e 6577 4576  n.event2 = NewEv
+00008610: 656e 7428 7479 7065 3d27 4f72 6465 7255  ent(type='OrderU
+00008620: 7064 6174 6564 272c 2064 6174 613d 6227  pdated', data=b'
+00008630: 6461 7461 3227 290a 6576 656e 7433 203d  data2').event3 =
+00008640: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+00008650: 4f72 6465 7244 656c 6574 6564 272c 2064  OrderDeleted', d
+00008660: 6174 613d 6227 6461 7461 3327 290a 0a63  ata=b'data3')..c
+00008670: 6f6d 6d69 745f 706f 7369 7469 6f6e 3220  ommit_position2 
+00008680: 3d20 636c 6965 6e74 2e61 7070 656e 645f  = client.append_
+00008690: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
+000086a0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+000086b0: 616d 6531 2c0a 2020 2020 6375 7272 656e  ame1,.    curren
+000086c0: 745f 7665 7273 696f 6e3d 302c 0a20 2020  t_version=0,.   
+000086d0: 2065 7665 6e74 733d 5b65 7665 6e74 322c   events=[event2,
+000086e0: 2065 7665 6e74 335d 2c0a 290a 6060 600a   event3],.).```.
+000086f0: 0a54 6865 2072 6574 7572 6e65 6420 7661  .The returned va
+00008700: 6c75 6573 2c20 6063 6f6d 6d69 745f 706f  lues, `commit_po
+00008710: 7369 7469 6f6e 3160 2061 6e64 2060 636f  sition1` and `co
+00008720: 6d6d 6974 5f70 6f73 6974 696f 6e32 602c  mmit_position2`,
+00008730: 2061 7265 2074 6865 0a63 6f6d 6d69 7420   are the.commit 
+00008740: 706f 7369 7469 6f6e 7320 696e 2074 6865  positions in the
+00008750: 2064 6174 6162 6173 6520 6f66 2074 6865   database of the
+00008760: 206c 6173 7420 6576 656e 7473 2069 6e20   last events in 
+00008770: 7468 6520 7265 636f 7264 6564 2073 6571  the recorded seq
+00008780: 7565 6e63 6573 2e0a 5468 6174 2069 732c  uences..That is,
+00008790: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+000087a0: 6e31 6020 6973 2074 6865 2063 6f6d 6d69  n1` is the commi
+000087b0: 7420 706f 7369 7469 6f6e 206f 6620 6065  t position of `e
+000087c0: 7665 6e74 3160 2061 6e64 0a60 636f 6d6d  vent1` and.`comm
+000087d0: 6974 5f70 6f73 6974 696f 6e32 6020 6973  it_position2` is
+000087e0: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+000087f0: 7469 6f6e 206f 6620 6065 7665 6e74 3360  tion of `event3`
+00008800: 2e0a 0a43 6f6d 6d69 7420 706f 7369 7469  ...Commit positi
+00008810: 6f6e 7320 7468 6174 2061 7265 2072 6574  ons that are ret
+00008820: 7572 6e65 6420 696e 2074 6869 7320 7761  urned in this wa
+00008830: 7920 6361 6e20 6265 2075 7365 6420 6279  y can be used by
+00008840: 2061 2075 7365 7220 696e 7465 7266 6163   a user interfac
+00008850: 6520 746f 2070 6f6c 6c0a 6120 646f 776e  e to poll.a down
+00008860: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+00008870: 2075 6e74 696c 2069 7420 6861 7320 7072   until it has pr
+00008880: 6f63 6573 7365 6420 616c 6c20 7468 6520  ocessed all the 
+00008890: 6e65 776c 7920 7265 636f 7264 6564 2065  newly recorded e
+000088a0: 7665 6e74 732e 2046 6f72 2065 7861 6d70  vents. For examp
+000088b0: 6c65 2c0a 636f 6e73 6964 6572 2061 2075  le,.consider a u
+000088c0: 7365 7220 696e 7465 7266 6163 6520 636f  ser interface co
+000088d0: 6d6d 616e 6420 7468 6174 2072 6573 756c  mmand that resul
+000088e0: 7473 2069 6e20 7468 6520 7265 636f 7264  ts in the record
+000088f0: 696e 6720 6f66 206e 6577 2065 7665 6e74  ing of new event
+00008900: 732c 2061 6e64 2061 6e0a 6576 656e 7475  s, and an.eventu
+00008910: 616c 6c79 2063 6f6e 7369 7374 656e 7420  ally consistent 
+00008920: 6d61 7465 7269 616c 697a 6564 2076 6965  materialized vie
+00008930: 7720 696e 2061 2064 6f77 6e73 7472 6561  w in a downstrea
+00008940: 6d20 636f 6d70 6f6e 656e 7420 7468 6174  m component that
+00008950: 2069 7320 7570 6461 7465 6420 6672 6f6d   is updated from
+00008960: 0a74 6865 7365 2065 7665 6e74 732e 2049  .these events. I
+00008970: 6620 7468 6520 6e65 7720 6576 656e 7473  f the new events
+00008980: 2068 6176 6520 6e6f 7420 7965 7420 6265   have not yet be
+00008990: 656e 2070 726f 6365 7373 6564 2c20 7468  en processed, th
+000089a0: 6520 7669 6577 206d 6967 6874 2062 6520  e view might be 
+000089b0: 7374 616c 652c 0a6f 7220 6f75 742d 6f66  stale,.or out-of
+000089c0: 2d64 6174 652e 2049 6e73 7465 6164 206f  -date. Instead o
+000089d0: 6620 6469 7370 6c61 7969 6e67 2061 2073  f displaying a s
+000089e0: 7461 6c65 2076 6965 772c 2074 6865 2075  tale view, the u
+000089f0: 7365 7220 696e 7465 7266 6163 6520 6361  ser interface ca
+00008a00: 6e20 706f 6c6c 2074 6865 0a64 6f77 6e73  n poll the.downs
+00008a10: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
+00008a20: 756e 7469 6c20 6974 2068 6173 2070 726f  until it has pro
+00008a30: 6365 7373 6564 2074 6865 206e 6577 6c79  cessed the newly
+00008a40: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00008a50: 2c20 616e 6420 7468 656e 2064 6973 706c  , and then displ
+00008a60: 6179 0a61 6e20 7570 2d74 6f2d 6461 7465  ay.an up-to-date
+00008a70: 2076 6965 7720 746f 2074 6865 2075 7365   view to the use
+00008a80: 722e 0a0a 0a23 2323 2041 7070 656e 6420  r....### Append 
+00008a90: 6576 656e 740a 0a2a 7265 7175 6972 6573  event..*requires
+00008aa0: 206c 6561 6465 722a 0a0a 5468 6520 6061   leader*..The `a
+00008ab0: 7070 656e 645f 6576 656e 7428 2960 206d  ppend_event()` m
+00008ac0: 6574 686f 6420 6973 206c 696b 6520 6061  ethod is like `a
+00008ad0: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
+00008ae0: 6275 7420 6361 6e20 6265 2075 7365 6420  but can be used 
+00008af0: 6f6e 6c79 2074 6f20 7772 6974 6520 610a  only to write a.
+00008b00: 7369 6e67 6c65 206e 6577 2065 7665 6e74  single new event
+00008b10: 2074 6f20 6120 7374 7265 616d 2e20 4966   to a stream. If
+00008b20: 2074 6865 206f 7065 7261 7469 6f6e 2069   the operation i
+00008b30: 7320 7375 6363 6573 7366 756c 2c20 6974  s successful, it
+00008b40: 2072 6574 7572 6e73 2074 6865 2063 6f6d   returns the com
+00008b50: 6d69 740a 706f 7369 7469 6f6e 206f 6620  mit.position of 
+00008b60: 7468 6520 6e65 776c 7920 7265 636f 7264  the newly record
+00008b70: 6564 2065 7665 6e74 2e0a 0a54 6869 7320  ed event...This 
+00008b80: 6d65 7468 6f64 2068 6173 2074 6872 6565  method has three
+00008b90: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00008ba0: 6e74 732c 2060 7374 7265 616d 5f6e 616d  nts, `stream_nam
+00008bb0: 6560 2c20 6063 7572 7265 6e74 5f76 6572  e`, `current_ver
+00008bc0: 7369 6f6e 6020 616e 6420 6065 7665 6e74  sion` and `event
+00008bd0: 602e 0a0a 5468 6520 7265 7175 6972 6564  `...The required
+00008be0: 2060 7374 7265 616d 5f6e 616d 6560 2061   `stream_name` a
+00008bf0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00008c00: 686f 6e20 6073 7472 6020 7468 6174 2075  hon `str` that u
+00008c10: 6e69 7175 656c 7920 6964 656e 7469 6669  niquely identifi
+00008c20: 6573 2061 0a73 7472 6561 6d20 746f 2077  es a.stream to w
+00008c30: 6869 6368 2061 2073 6571 7565 6e63 6520  hich a sequence 
+00008c40: 6f66 2065 7665 6e74 7320 7769 6c6c 2062  of events will b
+00008c50: 6520 6170 7065 6e64 6564 2e0a 0a54 6865  e appended...The
+00008c60: 2072 6571 7569 7265 6420 6063 7572 7265   required `curre
+00008c70: 6e74 5f76 6572 7369 6f6e 6020 6172 6775  nt_version` argu
+00008c80: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
+00008c90: 2074 6f20 6265 2065 6974 6865 7220 6120   to be either a 
+00008ca0: 5079 7468 6f6e 2060 696e 7460 0a74 6861  Python `int`.tha
+00008cb0: 7420 696e 6469 6361 7465 7320 7468 6520  t indicates the 
+00008cc0: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+00008cd0: 6f66 2074 6865 206c 6173 7420 7265 636f  of the last reco
+00008ce0: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
+00008cf0: 6520 7374 7265 616d 2e0a 0a54 6865 2072  e stream...The r
+00008d00: 6571 7569 7265 6420 6065 7665 6e74 6020  equired `event` 
+00008d10: 6172 6775 6d65 6e74 2069 7320 6578 7065  argument is expe
+00008d20: 6374 6564 2074 6f20 6265 2061 2073 696e  cted to be a sin
+00008d30: 676c 6520 6e65 7720 6576 656e 7420 6f62  gle new event ob
+00008d40: 6a65 6374 2e20 5468 6520 6576 656e 740a  ject. The event.
+00008d50: 6f62 6a65 6374 2069 7320 6578 7065 6374  object is expect
+00008d60: 6564 2074 6f20 6265 2061 6e20 696e 7374  ed to be an inst
+00008d70: 616e 6365 206f 6620 7468 6520 604e 6577  ance of the `New
+00008d80: 4576 656e 7460 2063 6c61 7373 2e0a 0a54  Event` class...T
+00008d90: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
+00008da0: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+00008db0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+00008dc0: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+00008dd0: 7974 686f 6e20 6066 6c6f 6174 600a 7468  ython `float`.th
+00008de0: 6174 2073 6574 7320 6120 6465 6164 6c69  at sets a deadli
+00008df0: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+00008e00: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00008e10: 4320 6f70 6572 6174 696f 6e2e 0a0a 0a23  C operation....#
+00008e20: 2323 2049 6465 6d70 6f74 656e 7420 6170  ## Idempotent ap
+00008e30: 7065 6e64 206f 7065 7261 7469 6f6e 730a  pend operations.
+00008e40: 0a54 6865 2060 6170 7065 6e64 5f65 7665  .The `append_eve
+00008e50: 6e74 2829 6020 616e 6420 6061 7070 656e  nt()` and `appen
+00008e60: 645f 6576 656e 7473 2829 6020 616e 6420  d_events()` and 
+00008e70: 6d65 7468 6f64 7320 6172 6520 2269 6465  methods are "ide
+00008e80: 6d70 6f74 656e 7422 2c20 696e 2074 6861  mpotent", in tha
+00008e90: 740a 6966 2074 6865 206d 6574 686f 6473  t.if the methods
+00008ea0: 2061 7265 2063 616c 6c65 6420 7769 7468   are called with
+00008eb0: 206e 6577 2065 7665 6e74 7320 7768 6f73   new events whos
+00008ec0: 6520 6069 6460 2061 7474 7269 6275 7465  e `id` attribute
+00008ed0: 2076 616c 7565 7320 6571 7561 6c20 7468   values equal th
+00008ee0: 6f73 650a 6f66 2072 6563 6f72 6465 6420  ose.of recorded 
+00008ef0: 6576 656e 7473 2069 6e20 7468 6520 6e61  events in the na
+00008f00: 6d65 6420 7374 7265 616d 2069 6d6d 6564  med stream immed
+00008f10: 6961 7465 6c79 2061 6674 6572 2074 6865  iately after the
+00008f20: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00008f30: 2073 7065 6369 6669 6564 0a62 7920 7468   specified.by th
+00008f40: 6520 7661 6c75 6520 6f66 2074 6865 2060  e value of the `
+00008f50: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
+00008f60: 2061 7267 756d 656e 742c 2074 6865 6e20   argument, then 
+00008f70: 7468 6573 6520 6d65 7468 6f64 7320 7769  these methods wi
+00008f80: 6c6c 2072 6574 7572 6e20 7468 650a 636f  ll return the.co
+00008f90: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
+00008fa0: 2074 6865 206c 6173 7420 6e65 7720 6576   the last new ev
+00008fb0: 656e 742c 2077 6974 686f 7574 206d 616b  ent, without mak
+00008fc0: 696e 6720 616e 7920 6368 616e 6765 7320  ing any changes 
+00008fd0: 746f 2074 6865 2064 6174 6162 6173 652e  to the database.
+00008fe0: 0a0a 536f 6d65 7469 6d65 7320 6974 206d  ..Sometimes it m
+00008ff0: 6179 2068 6170 7065 6e2c 2077 6865 6e20  ay happen, when 
+00009000: 6361 6c6c 696e 6720 6061 7070 656e 645f  calling `append_
+00009010: 6576 656e 7428 2960 206f 7220 6061 7070  event()` or `app
+00009020: 656e 645f 6576 656e 7473 2829 602c 2074  end_events()`, t
+00009030: 6861 740a 7468 6520 6e65 7720 6576 656e  hat.the new even
+00009040: 7473 2061 7265 2073 7563 6365 7373 6675  ts are successfu
+00009050: 6c6c 7920 7265 636f 7264 6564 2062 7574  lly recorded but
+00009060: 2073 6f6d 6568 6f77 2061 2063 6f6e 6e65   somehow a conne
+00009070: 6374 696f 6e20 6973 7375 6520 6f63 6375  ction issue occu
+00009080: 7273 2062 6566 6f72 650a 7468 6520 7375  rs before.the su
+00009090: 6363 6573 7366 756c 2063 616c 6c20 6361  ccessful call ca
+000090a0: 6e20 7265 7475 726e 2073 7563 6365 7373  n return success
+000090b0: 6675 6c6c 7920 746f 2074 6865 2063 6c69  fully to the cli
+000090c0: 656e 742e 2057 6520 6361 6e6e 6f74 2062  ent. We cannot b
+000090d0: 6520 7375 7265 2069 660a 7468 6520 6576  e sure if.the ev
+000090e0: 656e 7473 2077 6572 6520 7265 636f 7264  ents were record
+000090f0: 6564 206f 7220 6e6f 742c 2061 6e64 2073  ed or not, and s
+00009100: 6f20 7765 206d 6179 2077 6973 6820 746f  o we may wish to
+00009110: 2072 6574 7279 2e20 4966 2074 6865 2065   retry. If the e
+00009120: 7665 6e74 7320 7765 7265 2069 6e0a 6661  vents were in.fa
+00009130: 6374 2073 7563 6365 7373 6675 6c6c 7920  ct successfully 
+00009140: 7265 636f 7264 6564 2c20 6974 2069 7320  recorded, it is 
+00009150: 636f 6e76 656e 6965 6e74 2066 6f72 2074  convenient for t
+00009160: 6865 2072 6574 7269 6564 206f 7065 7261  he retried opera
+00009170: 7469 6f6e 2074 6f20 7265 7475 726e 0a73  tion to return.s
+00009180: 7563 6365 7373 6675 6c6c 7920 7769 7468  uccessfully with
+00009190: 6f75 7420 7261 6973 696e 6720 616e 2065  out raising an e
+000091a0: 7863 6570 7469 6f6e 2e20 4966 2074 686f  xception. If tho
+000091b0: 7365 206e 6577 2065 7665 6e74 7320 7765  se new events we
+000091c0: 7265 2069 6e20 6661 6374 206e 6f74 2072  re in fact not r
+000091d0: 6563 6f72 6465 642c 0a61 6e64 2069 6e20  ecorded,.and in 
+000091e0: 7468 6520 6d65 616e 7469 6d65 206e 6f20  the meantime no 
+000091f0: 6f74 6865 7220 6e65 7720 6576 656e 7473  other new events
+00009200: 2077 6572 6520 7265 636f 7264 6564 2069   were recorded i
+00009210: 6e20 7468 6174 2073 7472 6561 6d2c 2074  n that stream, t
+00009220: 6865 6e20 6974 206d 616b 6573 2073 656e  hen it makes sen
+00009230: 7365 0a74 6861 7420 7468 6520 6e65 7720  se.that the new 
+00009240: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
+00009250: 6563 6f72 6465 6420 7768 656e 2074 6865  ecorded when the
+00009260: 2061 7070 656e 6420 6f70 6572 6174 696f   append operatio
+00009270: 6e20 6973 2072 6574 7269 6564 2e20 4f66  n is retried. Of
+00009280: 2063 6f75 7273 652c 0a69 6620 6120 6057   course,.if a `W
+00009290: 726f 6e67 4375 7272 656e 7456 6572 7369  rongCurrentVersi
+000092a0: 6f6e 6020 6578 6365 7074 696f 6e20 6973  on` exception is
+000092b0: 2072 6169 7365 6420 7768 656e 2072 6574   raised when ret
+000092c0: 7279 696e 6720 7468 6520 6f70 6572 6174  rying the operat
+000092d0: 696f 6e2c 2074 6865 6e20 616e 0a61 7070  ion, then an.app
+000092e0: 6c69 6361 7469 6f6e 2063 6f6d 6d61 6e64  lication command
+000092f0: 2077 6869 6368 2067 656e 6572 6174 6564   which generated
+00009300: 2074 6865 206e 6577 2065 7665 6e74 7320   the new events 
+00009310: 696e 2074 6865 2063 6f6e 7465 7874 206f  in the context o
+00009320: 6620 616c 7265 6164 7920 7265 636f 7264  f already record
+00009330: 6564 0a65 7665 6e74 7320 6d61 7920 6e65  ed.events may ne
+00009340: 6564 2074 6f20 6265 2065 7865 6375 7465  ed to be execute
+00009350: 6420 6167 6169 6e2e 2041 6c74 6572 6e61  d again. Alterna
+00009360: 7469 7665 6c79 2c20 6120 7375 6974 6162  tively, a suitab
+00009370: 6c65 2065 7272 6f72 206d 6967 6874 2062  le error might b
+00009380: 6520 6469 7370 6c61 7965 640a 6279 2074  e displayed.by t
+00009390: 6865 2061 7070 6c69 6361 7469 6f6e 2c20  he application, 
+000093a0: 7769 7468 2061 6e20 7570 2d74 6f2d 6461  with an up-to-da
+000093b0: 7465 2076 6965 7720 6f66 2074 6865 2072  te view of the r
+000093c0: 6563 6f72 6465 6420 6461 7461 2c20 6769  ecorded data, gi
+000093d0: 7669 6e67 2061 2075 7365 7220 6f66 2074  ving a user of t
+000093e0: 6865 0a61 7070 6c69 6361 7469 6f6e 2061  he.application a
+000093f0: 6e20 6f70 706f 7274 756e 6974 7920 746f  n opportunity to
+00009400: 2064 6563 6964 6520 6966 2074 6865 7920   decide if they 
+00009410: 7374 696c 6c20 7769 7368 2074 6f20 7072  still wish to pr
+00009420: 6f63 6565 6420 7769 7468 2074 6865 6972  oceed with their
+00009430: 206f 7269 6769 6e61 6c0a 696e 7465 6e74   original.intent
+00009440: 696f 6e2e 0a0a 5468 6520 6578 616d 706c  ion...The exampl
+00009450: 6520 6265 6c6f 7720 7368 6f77 7320 7468  e below shows th
+00009460: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+00009470: 2829 6020 6d65 7468 6f64 2062 6569 6e67  ()` method being
+00009480: 2063 616c 6c65 6420 6167 6169 6e20 7769   called again wi
+00009490: 7468 0a60 6576 656e 7433 6020 616e 6420  th.`event3` and 
+000094a0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+000094b0: 3d30 602e 2057 6520 6361 6e20 7365 6520  =0`. We can see 
+000094c0: 7468 6174 2072 6570 6561 7469 6e67 2074  that repeating t
+000094d0: 6865 2063 616c 6c20 746f 0a60 6170 7065  he call to.`appe
+000094e0: 6e64 5f65 7665 6e74 7328 2960 2072 6574  nd_events()` ret
+000094f0: 7572 6e73 2073 7563 6365 7373 6675 6c6c  urns successfull
+00009500: 792e 0a0a 6060 6070 7974 686f 6e0a 2320  y...```python.# 
+00009510: 5265 7472 7920 6170 7065 6e64 696e 6720  Retry appending 
+00009520: 6576 656e 7433 2e0a 636f 6d6d 6974 5f70  event3..commit_p
+00009530: 6f73 6974 696f 6e5f 7265 7472 7920 3d20  osition_retry = 
+00009540: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+00009550: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
+00009560: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00009570: 6531 2c0a 2020 2020 6375 7272 656e 745f  e1,.    current_
+00009580: 7665 7273 696f 6e3d 302c 0a20 2020 2065  version=0,.    e
+00009590: 7665 6e74 733d 5b65 7665 6e74 322c 2065  vents=[event2, e
+000095a0: 7665 6e74 335d 2c0a 290a 6060 600a 0a57  vent3],.).```..W
+000095b0: 6520 6361 6e20 7365 6520 7468 6174 2074  e can see that t
+000095c0: 6865 2073 616d 6520 636f 6d6d 6974 2070  he same commit p
+000095d0: 6f73 6974 696f 6e20 6973 2072 6574 7572  osition is retur
+000095e0: 6e65 6420 6173 2061 626f 7665 2e0a 0a60  ned as above...`
+000095f0: 6060 7079 7468 6f6e 0a61 7373 6572 7420  ``python.assert 
+00009600: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5f  commit_position_
+00009610: 7265 7472 7920 3d3d 2063 6f6d 6d69 745f  retry == commit_
+00009620: 706f 7369 7469 6f6e 320a 6060 600a 0a42  position2.```..B
+00009630: 7920 6361 6c6c 696e 6720 6072 6561 645f  y calling `read_
+00009640: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+00009650: 2c20 7765 2063 616e 2061 6c73 6f20 7365  , we can also se
+00009660: 6520 7468 6520 7374 7265 616d 2068 6173  e the stream has
+00009670: 2062 6565 6e20 756e 6368 616e 6765 640a   been unchanged.
+00009680: 6465 7370 6974 6520 7468 6520 6061 7070  despite the `app
+00009690: 656e 645f 6576 656e 7473 2829 6020 6d65  end_events()` me
+000096a0: 7468 6f64 2068 6176 696e 6720 6265 656e  thod having been
+000096b0: 2063 616c 6c65 6420 7477 6963 6520 7769   called twice wi
+000096c0: 7468 2074 6865 2073 616d 6520 6172 6775  th the same argu
+000096d0: 6d65 6e74 732e 0a54 6861 7420 6973 2c20  ments..That is, 
+000096e0: 7468 6572 6520 6172 6520 7374 696c 6c20  there are still 
+000096f0: 6f6e 6c79 2074 6872 6565 2065 7665 6e74  only three event
+00009700: 7320 696e 2074 6865 2073 7472 6561 6d2e  s in the stream.
+00009710: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
+00009720: 7473 203d 2063 6c69 656e 742e 7265 6164  ts = client.read
+00009730: 5f73 7472 6561 6d5f 6576 656e 7473 280a  _stream_events(.
+00009740: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+00009750: 7374 7265 616d 5f6e 616d 6531 0a29 0a0a  stream_name1.)..
+00009760: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
+00009770: 7329 203d 3d20 330a 6060 600a 0a54 6869  s) == 3.```..Thi
+00009780: 7320 6964 656d 706f 7465 6e74 2062 6568  s idempotent beh
+00009790: 6176 696f 7572 2064 6570 656e 6473 206f  aviour depends o
+000097a0: 6e20 7468 6520 6069 6460 2061 7474 7269  n the `id` attri
+000097b0: 6275 7465 206f 6620 7468 6520 604e 6577  bute of the `New
+000097c0: 4576 656e 7460 2063 6c61 7373 2e0a 5468  Event` class..Th
+000097d0: 6973 2061 7474 7269 6275 7465 2c20 6279  is attribute, by
+000097e0: 2064 6566 6175 6c74 2c20 6973 2061 7373   default, is ass
+000097f0: 6967 6e65 6420 6120 6e65 7720 616e 6420  igned a new and 
+00009800: 756e 6971 7565 2076 6572 7369 6f6e 2d34  unique version-4
+00009810: 2055 5549 4420 7768 656e 2061 6e0a 696e   UUID when an.in
+00009820: 7374 616e 6365 206f 6620 604e 6577 4576  stance of `NewEv
+00009830: 656e 7460 2069 7320 636f 6e73 7472 7563  ent` is construc
+00009840: 7465 642e 2054 6865 2060 6964 6020 6172  ted. The `id` ar
+00009850: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+00009860: 6564 2077 6865 6e0a 636f 6e73 7472 7563  ed when.construc
+00009870: 7469 6e67 2060 4e65 7745 7665 6e74 6020  ting `NewEvent` 
+00009880: 6f62 6a65 6374 7320 746f 2073 6574 2074  objects to set t
+00009890: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
+000098a0: 2061 7474 7269 6275 7465 2e0a 0a0a 2323   attribute....##
+000098b0: 2320 5265 6164 2073 7472 6561 6d20 6576  # Read stream ev
+000098c0: 656e 7473 0a0a 5468 6520 6072 6561 645f  ents..The `read_
+000098d0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000098e0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+000098f0: 7365 6420 746f 2067 6574 2065 7665 6e74  sed to get event
+00009900: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
+00009910: 2061 7070 656e 6465 640a 746f 2061 2073   appended.to a s
+00009920: 7472 6561 6d2e 2054 6869 7320 6d65 7468  tream. This meth
+00009930: 6f64 2072 6574 7572 6e73 2061 2050 7974  od returns a Pyt
+00009940: 686f 6e20 6074 7570 6c65 6020 6f66 2072  hon `tuple` of r
+00009950: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
+00009960: 6a65 6374 732e 2054 6865 0a72 6563 6f72  jects. The.recor
+00009970: 6465 6420 6576 656e 7420 6f62 6a65 6374  ded event object
+00009980: 7320 6172 6520 696e 7374 616e 6365 7320  s are instances 
+00009990: 6f66 2074 6865 2060 5265 636f 7264 6564  of the `Recorded
+000099a0: 4576 656e 7460 2063 6c61 7373 2e0a 0a54  Event` class...T
+000099b0: 6869 7320 6d65 7468 6f64 2068 6173 206f  his method has o
+000099c0: 6e65 2072 6571 7569 7265 6420 6172 6775  ne required argu
+000099d0: 6d65 6e74 2c20 6073 7472 6561 6d5f 6e61  ment, `stream_na
+000099e0: 6d65 602e 0a0a 5468 6520 7265 7175 6972  me`...The requir
+000099f0: 6564 2060 7374 7265 616d 5f6e 616d 6560  ed `stream_name`
+00009a00: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00009a10: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+00009a20: 2075 6e69 7175 656c 7920 6964 656e 7469   uniquely identi
+00009a30: 6669 6573 2061 0a73 7472 6561 6d20 6672  fies a.stream fr
+00009a40: 6f6d 2077 6869 6368 2072 6563 6f72 6465  om which recorde
+00009a50: 6420 6576 656e 7473 2077 696c 6c20 6265  d events will be
+00009a60: 2072 6574 7572 6e65 642e 0a0a 5468 6520   returned...The 
+00009a70: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
+00009a80: 6e74 7328 2960 206d 6574 686f 6420 616c  nts()` method al
+00009a90: 736f 2068 6173 2066 6f75 7220 6f70 7469  so has four opti
+00009aa0: 6f6e 616c 2061 7267 756d 656e 7473 2c0a  onal arguments,.
+00009ab0: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
+00009ac0: 602c 2060 6261 636b 7761 7264 7360 2c20  `, `backwards`, 
+00009ad0: 606c 696d 6974 602c 2061 6e64 2060 7469  `limit`, and `ti
+00009ae0: 6d65 6f75 7460 2e0a 0a54 6865 206f 7074  meout`...The opt
+00009af0: 696f 6e61 6c20 6073 7472 6561 6d5f 706f  ional `stream_po
+00009b00: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+00009b10: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
+00009b20: 7460 2074 6861 7420 6361 6e20 6265 2075  t` that can be u
+00009b30: 7365 6420 746f 0a69 6e64 6963 6174 6520  sed to.indicate 
+00009b40: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
+00009b50: 7468 6520 7374 7265 616d 2066 726f 6d20  the stream from 
+00009b60: 7768 6963 6820 746f 2073 7461 7274 2072  which to start r
+00009b70: 6561 6469 6e67 2e20 5468 6520 6465 6661  eading. The defa
+00009b80: 756c 7420 7661 6c75 650a 6f66 2060 7374  ult value.of `st
+00009b90: 7265 616d 5f70 6f73 6974 696f 6e60 2069  ream_position` i
+00009ba0: 7320 604e 6f6e 6560 2e20 5768 656e 2072  s `None`. When r
+00009bb0: 6561 6469 6e67 2061 2073 7472 6561 6d20  eading a stream 
+00009bc0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+00009bd0: 706f 7369 7469 6f6e 2069 6e20 7468 650a  position in the.
+00009be0: 7374 7265 616d 2c20 7468 6520 7265 636f  stream, the reco
+00009bf0: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
+00009c00: 6174 2070 6f73 6974 696f 6e20 7769 6c6c  at position will
+00009c10: 2062 6520 696e 636c 7564 6564 2c20 626f   be included, bo
+00009c20: 7468 2077 6865 6e20 7265 6164 696e 670a  th when reading.
+00009c30: 666f 7277 6172 6473 2066 726f 6d20 7468  forwards from th
+00009c40: 6174 2070 6f73 6974 696f 6e2c 2061 6e64  at position, and
+00009c50: 2077 6865 6e20 7265 6164 696e 6720 6261   when reading ba
+00009c60: 636b 7761 7264 732e 0a0a 5468 6520 6f70  ckwards...The op
+00009c70: 7469 6f6e 616c 2060 6261 636b 7761 7264  tional `backward
+00009c80: 7360 2061 7267 756d 656e 7420 6973 2061  s` argument is a
+00009c90: 2050 7974 686f 6e20 6062 6f6f 6c60 2e20   Python `bool`. 
+00009ca0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+00009cb0: 6520 6f66 2060 6261 636b 7761 7264 7360  e of `backwards`
+00009cc0: 0a69 7320 6046 616c 7365 602c 2077 6869  .is `False`, whi
+00009cd0: 6368 206d 6561 6e73 2074 6865 2073 7472  ch means the str
+00009ce0: 6561 6d20 7769 6c6c 2062 6520 7265 6164  eam will be read
+00009cf0: 2066 6f72 7761 7264 732c 2073 6f20 7468   forwards, so th
+00009d00: 6174 2065 7665 6e74 7320 6172 6520 7265  at events are re
+00009d10: 7475 726e 6564 0a69 6e20 7468 6520 6f72  turned.in the or
+00009d20: 6465 7220 7468 6579 2077 6572 6520 7265  der they were re
+00009d30: 636f 7264 6564 2e20 4966 2060 6261 636b  corded. If `back
+00009d40: 7761 7264 7360 2069 7320 6054 7275 6560  wards` is `True`
+00009d50: 2c20 7468 6520 6576 656e 7473 2061 7265  , the events are
+00009d60: 2072 6574 7572 6e65 6420 696e 0a72 6576   returned in.rev
+00009d70: 6572 7365 206f 7264 6572 2e0a 0a49 6620  erse order...If 
+00009d80: 6062 6163 6b77 6172 6473 6020 6973 2060  `backwards` is `
+00009d90: 4661 6c73 6560 2061 6e64 2060 7374 7265  False` and `stre
+00009da0: 616d 5f70 6f73 6974 696f 6e60 2069 7320  am_position` is 
+00009db0: 604e 6f6e 6560 2c20 7468 6520 7374 7265  `None`, the stre
+00009dc0: 616d 2773 2065 7665 6e74 7320 7769 6c6c  am's events will
+00009dd0: 2062 650a 7265 7475 726e 6564 2069 6e20   be.returned in 
+00009de0: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
+00009df0: 6572 6520 7265 636f 7264 6564 2c20 7374  ere recorded, st
+00009e00: 6172 7469 6e67 2066 726f 6d20 7468 6520  arting from the 
+00009e10: 6669 7273 7420 7265 636f 7264 6564 2065  first recorded e
+00009e20: 7665 6e74 2e20 5468 6973 0a69 7320 7468  vent. This.is th
+00009e30: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
+00009e40: 6f72 206f 6620 6072 6561 645f 7374 7265  or of `read_stre
+00009e50: 616d 5f65 7665 6e74 7328 2960 2e20 4966  am_events()`. If
+00009e60: 2060 6261 636b 7761 7264 7360 2069 7320   `backwards` is 
+00009e70: 6054 7275 6560 2061 6e64 0a60 7374 7265  `True` and.`stre
+00009e80: 616d 5f70 6f73 6974 696f 6e60 2069 7320  am_position` is 
+00009e90: 604e 6f6e 6560 2c20 7468 6520 7374 7265  `None`, the stre
+00009ea0: 616d 2773 2065 7665 6e74 7320 7769 6c6c  am's events will
+00009eb0: 2062 6520 7265 7475 726e 6564 2069 6e20   be returned in 
+00009ec0: 7265 7665 7273 6520 6f72 6465 722c 0a73  reverse order,.s
+00009ed0: 7461 7274 696e 6720 6672 6f6d 2074 6865  tarting from the
+00009ee0: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
+00009ef0: 7665 6e74 2e0a 0a54 6865 206f 7074 696f  vent...The optio
+00009f00: 6e61 6c20 606c 696d 6974 6020 6172 6775  nal `limit` argu
+00009f10: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00009f20: 2060 696e 7460 2077 6869 6368 2072 6573   `int` which res
+00009f30: 7472 6963 7473 2074 6865 206e 756d 6265  tricts the numbe
+00009f40: 7220 6f66 2065 7665 6e74 730a 7468 6174  r of events.that
+00009f50: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
+00009f60: 642e 2054 6865 2064 6566 6175 6c74 2076  d. The default v
+00009f70: 616c 7565 206f 6620 606c 696d 6974 6020  alue of `limit` 
+00009f80: 6973 2060 7379 732e 6d61 7869 6e74 602e  is `sys.maxint`.
+00009f90: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00009fa0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00009fb0: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+00009fc0: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+00009fd0: 2061 2064 6561 646c 696e 6520 666f 720a   a deadline for.
+00009fe0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00009ff0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0000a000: 7469 6f6e 2e0a 0a54 6865 2065 7861 6d70  tion...The examp
+0000a010: 6c65 2062 656c 6f77 2073 686f 7773 2074  le below shows t
+0000a020: 6865 2064 6566 6175 6c74 2062 6568 6176  he default behav
+0000a030: 696f 7220 6f66 2074 6869 7320 6d65 7468  ior of this meth
+0000a040: 6f64 2c20 7768 6963 6820 6973 2074 6f20  od, which is to 
+0000a050: 7265 7475 726e 2061 6c6c 0a74 6865 2072  return all.the r
+0000a060: 6563 6f72 6465 6420 6576 656e 7473 206f  ecorded events o
+0000a070: 6620 6120 7374 7265 616d 2066 6f72 7761  f a stream forwa
+0000a080: 7264 7320 6672 6f6d 2074 6865 2066 6972  rds from the fir
+0000a090: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+0000a0a0: 7473 2074 6f20 7468 6520 6c61 7374 2e0a  ts to the last..
+0000a0b0: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+0000a0c0: 7320 3d20 636c 6965 6e74 2e72 6561 645f  s = client.read_
+0000a0d0: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
+0000a0e0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+0000a0f0: 7472 6561 6d5f 6e61 6d65 310a 290a 0a61  tream_name1.)..a
+0000a100: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+0000a110: 2920 3d3d 2033 0a61 7373 6572 7420 6576  ) == 3.assert ev
+0000a120: 656e 7473 5b30 5d2e 6964 203d 3d20 6576  ents[0].id == ev
+0000a130: 656e 7431 2e69 640a 6173 7365 7274 2065  ent1.id.assert e
+0000a140: 7665 6e74 735b 315d 2e69 6420 3d3d 2065  vents[1].id == e
+0000a150: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
+0000a160: 6576 656e 7473 5b32 5d2e 6964 203d 3d20  events[2].id == 
+0000a170: 6576 656e 7433 2e69 640a 6060 600a 0a54  event3.id.```..T
+0000a180: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0000a190: 2073 686f 7773 2068 6f77 2074 6f20 7573   shows how to us
+0000a1a0: 6520 7468 6520 6073 7472 6561 6d5f 706f  e the `stream_po
+0000a1b0: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+0000a1c0: 2074 6f20 7265 6164 2061 2073 7472 6561   to read a strea
+0000a1d0: 6d0a 6672 6f6d 2061 2073 7065 6369 6669  m.from a specifi
+0000a1e0: 6320 7374 7265 616d 2070 6f73 6974 696f  c stream positio
+0000a1f0: 6e20 746f 2074 6865 2065 6e64 206f 6620  n to the end of 
+0000a200: 7468 6520 7374 7265 616d 2e20 5374 7265  the stream. Stre
+0000a210: 616d 2070 6f73 6974 696f 6e73 2061 7265  am positions are
+0000a220: 0a7a 6572 6f2d 6261 7365 642c 2061 6e64  .zero-based, and
+0000a230: 2073 6f20 6073 7472 6561 6d5f 706f 7369   so `stream_posi
+0000a240: 7469 6f6e 3d31 6020 636f 7272 6573 706f  tion=1` correspo
+0000a250: 6e64 7320 746f 2074 6865 2073 6563 6f6e  nds to the secon
+0000a260: 6420 6576 656e 7420 7468 6174 2077 6173  d event that was
+0000a270: 0a72 6563 6f72 6465 6420 696e 2074 6865  .recorded in the
+0000a280: 2073 7472 6561 6d2c 2069 6e20 7468 6973   stream, in this
+0000a290: 2063 6173 6520 6065 7665 6e74 3260 2e0a   case `event2`..
+0000a2a0: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+0000a2b0: 7320 3d20 636c 6965 6e74 2e72 6561 645f  s = client.read_
+0000a2c0: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
+0000a2d0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+0000a2e0: 7472 6561 6d5f 6e61 6d65 312c 0a20 2020  tream_name1,.   
+0000a2f0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
+0000a300: 3d31 2c0a 290a 0a61 7373 6572 7420 6c65  =1,.)..assert le
+0000a310: 6e28 6576 656e 7473 2920 3d3d 2032 0a61  n(events) == 2.a
+0000a320: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
+0000a330: 6964 203d 3d20 6576 656e 7432 2e69 640a  id == event2.id.
+0000a340: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+0000a350: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
+0000a360: 0a60 6060 0a0a 5468 6520 6578 616d 706c  .```..The exampl
+0000a370: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
+0000a380: 7720 746f 2075 7365 2074 6865 2060 6261  w to use the `ba
+0000a390: 636b 7761 7264 7360 2061 7267 756d 656e  ckwards` argumen
+0000a3a0: 7420 746f 2072 6561 6420 6120 7374 7265  t to read a stre
+0000a3b0: 616d 2062 6163 6b77 6172 6473 2e0a 0a60  am backwards...`
+0000a3c0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000a3d0: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
+0000a3e0: 7265 616d 5f65 7665 6e74 7328 0a20 2020  ream_events(.   
+0000a3f0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000a400: 6561 6d5f 6e61 6d65 312c 0a20 2020 2062  eam_name1,.    b
+0000a410: 6163 6b77 6172 6473 3d54 7275 652c 0a29  ackwards=True,.)
+0000a420: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000a430: 6e74 7329 203d 3d20 330a 6173 7365 7274  nts) == 3.assert
+0000a440: 2065 7665 6e74 735b 305d 2e69 6420 3d3d   events[0].id ==
+0000a450: 2065 7665 6e74 332e 6964 0a61 7373 6572   event3.id.asser
+0000a460: 7420 6576 656e 7473 5b31 5d2e 6964 203d  t events[1].id =
+0000a470: 3d20 6576 656e 7432 2e69 640a 6173 7365  = event2.id.asse
+0000a480: 7274 2065 7665 6e74 735b 325d 2e69 6420  rt events[2].id 
+0000a490: 3d3d 2065 7665 6e74 312e 6964 0a60 6060  == event1.id.```
+0000a4a0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+0000a4b0: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
+0000a4c0: 2075 7365 2074 6865 2060 6c69 6d69 7460   use the `limit`
+0000a4d0: 2061 7267 756d 656e 7420 746f 2072 6561   argument to rea
+0000a4e0: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
+0000a4f0: 6572 206f 660a 6576 656e 7473 2e0a 0a60  er of.events...`
+0000a500: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000a510: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
+0000a520: 7265 616d 5f65 7665 6e74 7328 0a20 2020  ream_events(.   
+0000a530: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000a540: 6561 6d5f 6e61 6d65 312c 0a20 2020 206c  eam_name1,.    l
+0000a550: 696d 6974 3d32 2c0a 290a 0a61 7373 6572  imit=2,.)..asser
+0000a560: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+0000a570: 2032 0a61 7373 6572 7420 6576 656e 7473   2.assert events
+0000a580: 5b30 5d2e 6964 203d 3d20 6576 656e 7431  [0].id == event1
+0000a590: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+0000a5a0: 735b 315d 2e69 6420 3d3d 2065 7665 6e74  s[1].id == event
+0000a5b0: 322e 6964 0a60 6060 0a0a 5468 6520 6072  2.id.```..The `r
+0000a5c0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+0000a5d0: 7328 2960 206d 6574 686f 6420 7769 6c6c  s()` method will
+0000a5e0: 2072 6169 7365 2061 2060 4e6f 7446 6f75   raise a `NotFou
+0000a5f0: 6e64 6020 6578 6365 7074 696f 6e20 6966  nd` exception if
+0000a600: 2074 6865 206e 616d 6564 2073 7472 6561   the named strea
+0000a610: 6d0a 6861 7320 6e65 7665 7220 6578 6973  m.has never exis
+0000a620: 7465 6420 6f72 2068 6173 2062 6565 6e20  ted or has been 
+0000a630: 6465 6c65 7465 642e 0a0a 6060 6070 7974  deleted...```pyt
+0000a640: 686f 6e0a 6672 6f6d 2065 7364 6263 6c69  hon.from esdbcli
+0000a650: 656e 742e 6578 6365 7074 696f 6e73 2069  ent.exceptions i
+0000a660: 6d70 6f72 7420 4e6f 7446 6f75 6e64 0a0a  mport NotFound..
+0000a670: 0a74 7279 3a0a 2020 2020 636c 6965 6e74  .try:.    client
+0000a680: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
+0000a690: 6e74 7328 2764 6f65 732d 6e6f 742d 6578  nts('does-not-ex
+0000a6a0: 6973 7427 290a 6578 6365 7074 204e 6f74  ist').except Not
+0000a6b0: 466f 756e 643a 0a20 2020 2070 6173 7320  Found:.    pass 
+0000a6c0: 2023 2054 6865 2073 7472 6561 6d20 646f   # The stream do
+0000a6d0: 6573 206e 6f74 2065 7869 7374 2e0a 656c  es not exist..el
+0000a6e0: 7365 3a0a 2020 2020 7261 6973 6520 4578  se:.    raise Ex
+0000a6f0: 6365 7074 696f 6e28 2253 686f 756c 646e  ception("Shouldn
+0000a700: 2774 2067 6574 2068 6572 6522 290a 6060  't get here").``
+0000a710: 600a 0a50 6c65 6173 6520 6e6f 7465 2c20  `..Please note, 
+0000a720: 7468 6973 206d 6574 686f 6420 7374 7265  this method stre
+0000a730: 616d 7320 7265 636f 7264 6564 2065 7665  ams recorded eve
+0000a740: 6e74 7320 6672 6f6d 2074 6865 2073 6572  nts from the ser
+0000a750: 7665 7220 616e 6420 7468 656e 0a63 6f6e  ver and then.con
+0000a760: 7374 7275 6374 7320 616e 6420 7265 7475  structs and retu
+0000a770: 726e 7320 6120 5079 7468 6f6e 2060 7475  rns a Python `tu
+0000a780: 706c 6560 2e20 496e 2063 6173 6520 796f  ple`. In case yo
+0000a790: 7520 646f 6e27 7420 7761 6e74 2074 6865  u don't want the
+0000a7a0: 2063 6c69 656e 7420 746f 0a66 696e 6973   client to.finis
+0000a7b0: 6820 7374 7265 616d 696e 6720 6576 656e  h streaming even
+0000a7c0: 7473 2066 726f 6d20 7468 6520 6461 7461  ts from the data
+0000a7d0: 6261 7365 2062 6566 6f72 6520 6974 2072  base before it r
+0000a7e0: 6574 7572 6e73 2c20 796f 7520 6361 6e20  eturns, you can 
+0000a7f0: 696e 7374 6561 640a 7573 6520 7468 6520  instead.use the 
+0000a800: 6069 7465 725f 7374 7265 616d 5f65 7665  `iter_stream_eve
+0000a810: 6e74 7328 2960 206d 6574 686f 642c 2077  nts()` method, w
+0000a820: 6869 6368 2072 6574 7572 6e73 2061 6e20  hich returns an 
+0000a830: 6974 6572 6162 6c65 2022 7265 6164 2072  iterable "read r
+0000a840: 6573 706f 6e73 6522 0a6f 626a 6563 742e  esponse".object.
+0000a850: 2041 2022 7265 6164 2072 6573 706f 6e73   A "read respons
+0000a860: 6522 2069 7320 616e 2069 7465 7261 746f  e" is an iterato
+0000a870: 722c 2061 6e64 206e 6f74 2061 2073 6571  r, and not a seq
+0000a880: 7565 6e63 652e 2052 6563 6f72 6465 6420  uence. Recorded 
+0000a890: 6576 656e 7473 2063 616e 0a62 6520 6f62  events can.be ob
+0000a8a0: 7461 696e 6564 2062 7920 6974 6572 6174  tained by iterat
+0000a8b0: 696e 6720 6f76 6572 2074 6865 2022 7265  ing over the "re
+0000a8c0: 6164 2072 6573 706f 6e73 6522 206f 626a  ad response" obj
+0000a8d0: 6563 742e 2049 7420 7374 7265 616d 7320  ect. It streams 
+0000a8e0: 7265 636f 7264 6564 2065 7665 6e74 730a  recorded events.
+0000a8f0: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
+0000a900: 6173 2074 6865 2069 7465 7261 7469 6f6e  as the iteration
+0000a910: 2070 726f 6365 6564 732e 2054 6865 2069   proceeds. The i
+0000a920: 7465 7261 7469 6f6e 2077 696c 6c20 6175  teration will au
+0000a930: 746f 6d61 7469 6361 6c6c 7920 7374 6f70  tomatically stop
+0000a940: 0a77 6865 6e20 7468 6572 6520 6172 6520  .when there are 
+0000a950: 6e6f 206d 6f72 6520 7265 636f 7264 6564  no more recorded
+0000a960: 2065 7665 6e74 7320 746f 2062 6520 7265   events to be re
+0000a970: 7475 726e 6564 2e20 5468 6520 7374 7265  turned. The stre
+0000a980: 616d 696e 6720 6f66 2065 7665 6e74 732c  aming of events,
+0000a990: 0a61 6e64 2068 656e 6365 2074 6865 2069  .and hence the i
+0000a9a0: 7465 7261 746f 722c 2063 616e 2061 6c73  terator, can als
+0000a9b0: 6f20 6265 2073 746f 7070 6564 2070 7265  o be stopped pre
+0000a9c0: 6d61 7475 7265 6c79 2062 7920 6361 6c6c  maturely by call
+0000a9d0: 696e 6720 7468 6520 6073 746f 7028 2960  ing the `stop()`
+0000a9e0: 0a6d 6574 686f 6420 6f6e 2074 6865 2022  .method on the "
+0000a9f0: 7265 6164 2072 6573 706f 6e73 6522 206f  read response" o
+0000aa00: 626a 6563 742e 0a0a 496e 2066 6163 742c  bject...In fact,
+0000aa10: 2074 6865 2060 7265 6164 5f73 7472 6561   the `read_strea
+0000aa20: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
+0000aa30: 6f64 2063 616c 6c73 2060 6974 6572 5f73  od calls `iter_s
+0000aa40: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+0000aa50: 616e 6420 7061 7373 6573 0a74 6865 2022  and passes.the "
+0000aa60: 7265 6164 2072 6573 706f 6e73 6522 2069  read response" i
+0000aa70: 7465 7261 746f 7220 696e 746f 2074 6865  terator into the
+0000aa80: 2050 7974 686f 6e20 6074 7570 6c65 6020   Python `tuple` 
+0000aa90: 636f 6e73 7472 7563 746f 722e 2048 6f77  constructor. How
+0000aaa0: 6576 6572 2c20 7468 650a 6072 6561 645f  ever, the.`read_
+0000aab0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+0000aac0: 206d 6574 686f 6420 6973 2064 6563 6f72   method is decor
+0000aad0: 6174 6564 2077 6974 6820 7265 7472 7920  ated with retry 
+0000aae0: 616e 6420 7265 636f 6e6e 6563 7420 6465  and reconnect de
+0000aaf0: 636f 7261 746f 7273 2c0a 7768 696c 7374  corators,.whilst
+0000ab00: 2074 6865 2060 6974 6572 5f73 7472 6561   the `iter_strea
+0000ab10: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
+0000ab20: 6f64 2069 7320 6e6f 742e 2054 6869 7320  od is not. This 
+0000ab30: 6d65 616e 7320 7468 6174 2061 6c6c 2065  means that all e
+0000ab40: 7272 6f72 7320 6475 6520 746f 0a63 6f6e  rrors due to.con
+0000ab50: 6e65 6374 696f 6e20 6973 7375 6573 2077  nection issues w
+0000ab60: 696c 6c20 6265 2063 6175 6768 7420 6279  ill be caught by
+0000ab70: 2074 6865 2072 6574 7279 2061 6e64 2072   the retry and r
+0000ab80: 6563 6f6e 6e65 6374 2064 6563 6f72 6174  econnect decorat
+0000ab90: 6f72 7320 7768 656e 2063 616c 6c69 6e67  ors when calling
+0000aba0: 0a74 6865 2060 7265 6164 5f73 7472 6561  .the `read_strea
+0000abb0: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
+0000abc0: 6f64 2c20 6275 7420 6e6f 7420 7768 656e  od, but not when
+0000abd0: 2063 616c 6c69 6e67 2060 6974 6572 5f73   calling `iter_s
+0000abe0: 7472 6561 6d5f 6576 656e 7473 2829 602e  tream_events()`.
+0000abf0: 2054 6865 0a60 6974 6572 5f73 7472 6561   The.`iter_strea
+0000ac00: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
+0000ac10: 6f64 2068 6173 206e 6f20 7375 6368 2064  od has no such d
+0000ac20: 6563 6f72 6174 6f72 7320 6265 6361 7573  ecorators becaus
+0000ac30: 6520 7468 6520 7374 7265 616d 696e 6720  e the streaming 
+0000ac40: 6f6e 6c79 2073 7461 7274 730a 7768 656e  only starts.when
+0000ac50: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+0000ac60: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+0000ac70: 7365 2220 7374 6172 7473 2c20 7768 6963  se" starts, whic
+0000ac80: 6820 6d65 616e 7320 7468 6174 2074 6865  h means that the
+0000ac90: 206d 6574 686f 6420 7265 7475 726e 730a   method returns.
+0000aca0: 6265 666f 7265 2074 6865 2073 7472 6561  before the strea
+0000acb0: 6d69 6e67 2073 7461 7274 732c 2061 6e64  ming starts, and
+0000acc0: 2073 6f20 7468 6572 6520 6973 206e 6f20   so there is no 
+0000acd0: 6368 616e 6365 2066 6f72 2061 6e79 2064  chance for any d
+0000ace0: 6563 6f72 6174 6f72 7320 746f 2063 6174  ecorators to cat
+0000acf0: 6368 0a61 6e79 2063 6f6e 6e65 6374 696f  ch.any connectio
+0000ad00: 6e20 6973 7375 6573 2e0a 0a4e 6576 6572  n issues...Never
+0000ad10: 7468 656c 6573 732c 2069 6620 796f 7520  theless, if you 
+0000ad20: 6172 6520 7265 6164 696e 6720 6120 7665  are reading a ve
+0000ad30: 7279 206c 6172 6765 2073 7472 6561 6d2c  ry large stream,
+0000ad40: 2074 6865 6e20 796f 7520 6d69 6768 7420   then you might 
+0000ad50: 7072 6566 6572 2074 6f20 6361 6c6c 0a60  prefer to call.`
+0000ad60: 6974 6572 5f73 7472 6561 6d5f 6576 656e  iter_stream_even
+0000ad70: 7473 2829 602c 2061 6e64 2074 6f20 6265  ts()`, and to be
+0000ad80: 6769 6e20 6974 6572 6174 696e 6720 7468  gin iterating th
+0000ad90: 726f 7567 6820 7468 6520 7265 636f 7264  rough the record
+0000ada0: 6564 2065 7665 6e74 7320 7768 696c 7374  ed events whilst
+0000adb0: 0a74 6865 7920 6172 6520 6265 696e 6720  .they are being 
+0000adc0: 7374 7265 616d 6564 2066 726f 6d20 7468  streamed from th
+0000add0: 6520 7365 7276 6572 2c20 7261 7468 6572  e server, rather
+0000ade0: 2074 6861 6e20 626f 7468 2077 6169 7469   than both waiti
+0000adf0: 6e67 2061 6e64 2068 6176 696e 6720 7468  ng and having th
+0000ae00: 656d 0a61 6c6c 2061 6363 756d 756c 6174  em.all accumulat
+0000ae10: 6520 696e 206d 656d 6f72 792e 2042 6563  e in memory. Bec
+0000ae20: 6175 7365 206f 6620 7468 6520 7269 736b  ause of the risk
+0000ae30: 206f 6620 636f 6e6e 6563 7469 6f6e 2069   of connection i
+0000ae40: 7373 7565 7320 6172 6973 696e 6720 6475  ssues arising du
+0000ae50: 7269 6e67 0a74 6865 2073 7472 6561 6d69  ring.the streami
+0000ae60: 6e67 206f 6620 7265 636f 7264 6564 2065  ng of recorded e
+0000ae70: 7665 6e74 7320 6672 6f6d 2074 6865 2073  vents from the s
+0000ae80: 6572 7665 722c 2079 6f75 2077 696c 6c20  erver, you will 
+0000ae90: 6e65 6564 2074 6f20 6361 7265 2061 626f  need to care abo
+0000aea0: 7574 0a63 6f6e 6e65 6374 696f 6e20 6973  ut.connection is
+0000aeb0: 7375 6573 2077 6865 6e20 6974 6572 6174  sues when iterat
+0000aec0: 696e 6720 6f76 6572 2074 6865 2022 7265  ing over the "re
+0000aed0: 6164 2072 6573 706f 6e73 6522 206f 626a  ad response" obj
+0000aee0: 6563 7420 7265 7475 726e 6564 2066 726f  ect returned fro
+0000aef0: 6d0a 6069 7465 725f 7374 7265 616d 5f65  m.`iter_stream_e
+0000af00: 7665 6e74 7328 2960 2e0a 0a23 2323 2047  vents()`...### G
+0000af10: 6574 2063 7572 7265 6e74 2076 6572 7369  et current versi
+0000af20: 6f6e 0a0a 5468 6520 6067 6574 5f63 7572  on..The `get_cur
+0000af30: 7265 6e74 5f76 6572 7369 6f6e 2829 6020  rent_version()` 
+0000af40: 6d65 7468 6f64 2069 7320 6120 636f 6e76  method is a conv
+0000af50: 656e 6965 6e63 6520 6d65 7468 6f64 2074  enience method t
+0000af60: 6861 7420 6573 7365 6e74 6961 6c6c 7920  hat essentially 
+0000af70: 6361 6c6c 730a 6072 6561 645f 7374 7265  calls.`read_stre
+0000af80: 616d 5f65 7665 6e74 7328 2960 2077 6974  am_events()` wit
+0000af90: 6820 6062 6163 6b77 6172 6473 3d54 7275  h `backwards=Tru
+0000afa0: 6560 2061 6e64 2060 6c69 6d69 743d 3160  e` and `limit=1`
+0000afb0: 2e20 5468 6973 206d 6574 686f 6420 7265  . This method re
+0000afc0: 7475 726e 730a 7468 6520 7661 6c75 6520  turns.the value 
+0000afd0: 6f66 2074 6865 2060 7374 7265 616d 5f70  of the `stream_p
+0000afe0: 6f73 6974 696f 6e60 2061 7474 7269 6275  osition` attribu
+0000aff0: 7465 206f 6620 7468 6520 6c61 7374 2072  te of the last r
+0000b000: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+0000b010: 2061 0a73 7472 6561 6d2e 2049 6620 6120   a.stream. If a 
+0000b020: 7374 7265 616d 2064 6f65 7320 6e6f 7420  stream does not 
+0000b030: 6578 6973 742c 2074 6865 2072 6574 7572  exist, the retur
+0000b040: 6e65 6420 7661 6c75 6520 6973 2060 4e6f  ned value is `No
+0000b050: 6e65 602e 2054 6865 2072 6574 7572 6e65  ne`. The returne
+0000b060: 640a 7661 6c75 6520 6973 2074 6865 2063  d.value is the c
+0000b070: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
+0000b080: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+0000b090: 6020 7768 656e 2061 7070 656e 6469 6e67  ` when appending
+0000b0a0: 206e 6577 2065 7665 6e74 7320 746f 0a61   new events to.a
+0000b0b0: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
+0000b0c0: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
+0000b0d0: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
+0000b0e0: 2060 7374 7265 616d 5f6e 616d 6560 2e0a   `stream_name`..
+0000b0f0: 0a54 6865 2072 6571 7569 7265 6420 6073  .The required `s
+0000b100: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+0000b110: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0000b120: 2060 7374 7260 2074 6861 7420 756e 6971   `str` that uniq
+0000b130: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
+0000b140: 610a 7374 7265 616d 2066 726f 6d20 7768  a.stream from wh
+0000b150: 6963 6820 6120 7374 7265 616d 2070 6f73  ich a stream pos
+0000b160: 6974 696f 6e20 7769 6c6c 2062 6520 7265  ition will be re
+0000b170: 7475 726e 6564 2e0a 0a54 6869 7320 6d65  turned...This me
+0000b180: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
+0000b190: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+0000b1a0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
+0000b1b0: 6174 0a69 7320 6578 7065 6374 6564 2074  at.is expected t
+0000b1c0: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
+0000b1d0: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
+0000b1e0: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
+0000b1f0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+0000b200: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+0000b210: 6174 696f 6e2e 0a0a 496e 2074 6865 2065  ation...In the e
+0000b220: 7861 6d70 6c65 2062 656c 6f77 2c20 7468  xample below, th
+0000b230: 6520 6c61 7374 2073 7472 6561 6d20 706f  e last stream po
+0000b240: 7369 7469 6f6e 206f 6620 6073 7472 6561  sition of `strea
+0000b250: 6d5f 6e61 6d65 3160 2069 7320 6f62 7461  m_name1` is obta
+0000b260: 696e 6564 2e0a 5369 6e63 6520 7468 7265  ined..Since thre
+0000b270: 6520 6576 656e 7473 2068 6176 6520 6265  e events have be
+0000b280: 656e 2061 7070 656e 6465 6420 746f 2060  en appended to `
+0000b290: 7374 7265 616d 5f6e 616d 6531 602c 2061  stream_name1`, a
+0000b2a0: 6e64 2062 6563 6175 7365 2070 6f73 6974  nd because posit
+0000b2b0: 696f 6e73 0a69 6e20 6120 7374 7265 616d  ions.in a stream
+0000b2c0: 2061 7265 207a 6572 6f2d 6261 7365 6420   are zero-based 
+0000b2d0: 616e 6420 6761 706c 6573 732c 2073 6f20  and gapless, so 
+0000b2e0: 7468 6520 6375 7272 656e 7420 7665 7273  the current vers
+0000b2f0: 696f 6e20 6973 2060 3260 2e0a 0a60 6060  ion is `2`...```
+0000b300: 7079 7468 6f6e 0a63 7572 7265 6e74 5f76  python.current_v
+0000b310: 6572 7369 6f6e 203d 2063 6c69 656e 742e  ersion = client.
+0000b320: 6765 745f 6375 7272 656e 745f 7665 7273  get_current_vers
+0000b330: 696f 6e28 0a20 2020 2073 7472 6561 6d5f  ion(.    stream_
+0000b340: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000b350: 310a 290a 0a61 7373 6572 7420 6375 7272  1.)..assert curr
+0000b360: 656e 745f 7665 7273 696f 6e20 3d3d 2032  ent_version == 2
+0000b370: 0a60 6060 0a0a 4966 2061 2073 7472 6561  .```..If a strea
+0000b380: 6d20 6861 7320 6e65 7665 7220 6578 6973  m has never exis
+0000b390: 7465 6420 6f72 2068 6173 2062 6565 6e20  ted or has been 
+0000b3a0: 6465 6c65 7465 642c 2074 6865 2072 6574  deleted, the ret
+0000b3b0: 7572 6e65 6420 7661 6c75 6520 6973 2060  urned value is `
+0000b3c0: 4e6f 6e65 602c 0a77 6869 6368 206d 6174  None`,.which mat
+0000b3d0: 6368 6573 2074 6865 2072 6571 7569 7265  ches the require
+0000b3e0: 6420 7661 6c75 6520 6f66 2074 6865 2060  d value of the `
+0000b3f0: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
+0000b400: 2061 7267 756d 656e 7420 626f 7468 2077   argument both w
+0000b410: 6865 6e0a 6170 7065 6e64 696e 6720 7468  hen.appending th
+0000b420: 6520 6669 7273 7420 6576 656e 7420 6f66  e first event of
+0000b430: 2061 206e 6577 2073 7472 6561 6d2c 2061   a new stream, a
+0000b440: 6e64 2061 6c73 6f20 7768 656e 2061 7070  nd also when app
+0000b450: 656e 6469 6e67 2065 7665 6e74 7320 746f  ending events to
+0000b460: 0a61 2073 7472 6561 6d20 7468 6174 2068  .a stream that h
+0000b470: 6173 2062 6565 6e20 6465 6c65 7465 642e  as been deleted.
+0000b480: 0a0a 6060 6070 7974 686f 6e0a 6375 7272  ..```python.curr
+0000b490: 656e 745f 7665 7273 696f 6e20 3d20 636c  ent_version = cl
+0000b4a0: 6965 6e74 2e67 6574 5f63 7572 7265 6e74  ient.get_current
+0000b4b0: 5f76 6572 7369 6f6e 280a 2020 2020 7374  _version(.    st
+0000b4c0: 7265 616d 5f6e 616d 653d 2764 6f65 732d  ream_name='does-
+0000b4d0: 6e6f 742d 6578 6973 7427 0a29 0a0a 6173  not-exist'.)..as
+0000b4e0: 7365 7274 2063 7572 7265 6e74 5f76 6572  sert current_ver
+0000b4f0: 7369 6f6e 2069 7320 4e6f 6e65 0a60 6060  sion is None.```
+0000b500: 0a0a 2323 2320 486f 7720 746f 2069 6d70  ..### How to imp
+0000b510: 6c65 6d65 6e74 2073 6e61 7073 686f 7474  lement snapshott
+0000b520: 696e 6720 7769 7468 2045 7665 6e74 5374  ing with EventSt
+0000b530: 6f72 6544 420a 0a53 6e61 7073 686f 7473  oreDB..Snapshots
+0000b540: 2063 616e 2069 6d70 726f 7665 2074 6865   can improve the
+0000b550: 2070 6572 666f 726d 616e 6365 206f 6620   performance of 
+0000b560: 6167 6772 6567 6174 6573 2074 6861 7420  aggregates that 
+0000b570: 776f 756c 6420 6f74 6865 7277 6973 6520  would otherwise 
+0000b580: 6265 0a72 6563 6f6e 7374 7275 6374 6564  be.reconstructed
+0000b590: 2066 726f 6d20 7665 7279 206c 6f6e 6720   from very long 
+0000b5a0: 7374 7265 616d 732e 2048 6f77 6576 6572  streams. However
+0000b5b0: 2c20 6974 2069 7320 6765 6e65 7261 6c6c  , it is generall
+0000b5c0: 7920 7265 636f 6d6d 656e 6465 6420 746f  y recommended to
+0000b5d0: 2064 6573 6967 6e0a 6167 6772 6567 6174   design.aggregat
+0000b5e0: 6573 2074 6f20 6861 7665 2061 2066 696e  es to have a fin
+0000b5f0: 6974 6520 6c69 6665 6379 636c 652c 2061  ite lifecycle, a
+0000b600: 6e64 2073 6f20 746f 2068 6176 6520 7265  nd so to have re
+0000b610: 6c61 7469 7665 6c79 2073 686f 7274 2073  latively short s
+0000b620: 7472 6561 6d73 2c0a 7468 6572 6562 7920  treams,.thereby 
+0000b630: 6176 6f69 6469 6e67 2074 6865 206e 6565  avoiding the nee
+0000b640: 6420 666f 7220 736e 6170 7368 6f74 7469  d for snapshotti
+0000b650: 6e67 2e20 5468 6973 2022 686f 7720 746f  ng. This "how to
+0000b660: 2220 7365 6374 696f 6e20 6973 2069 6e74  " section is int
+0000b670: 656e 6465 6420 6d65 7265 6c79 0a74 6f20  ended merely.to 
+0000b680: 7368 6f77 2068 6f77 2073 6e61 7073 686f  show how snapsho
+0000b690: 7474 696e 6720 6f66 2061 6767 7265 6761  tting of aggrega
+0000b6a0: 7465 7320 6361 6e20 6265 2069 6d70 6c65  tes can be imple
+0000b6b0: 6d65 6e74 6564 2077 6974 6820 4576 656e  mented with Even
+0000b6c0: 7453 746f 7265 4442 2075 7369 6e67 0a74  tStoreDB using.t
+0000b6d0: 6869 7320 5079 7468 6f6e 2063 6c69 656e  his Python clien
+0000b6e0: 742e 0a0a 4576 656e 742d 736f 7572 6365  t...Event-source
+0000b6f0: 6420 6167 6772 6567 6174 6573 2061 7265  d aggregates are
+0000b700: 2074 7970 6963 616c 6c79 2072 6563 6f6e   typically recon
+0000b710: 7374 7275 6374 6564 2066 726f 6d20 7265  structed from re
+0000b720: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
+0000b730: 2063 616c 6c69 6e67 0a61 206d 7574 6174   calling.a mutat
+0000b740: 6f72 2066 756e 6374 696f 6e20 666f 7220  or function for 
+0000b750: 6561 6368 2072 6563 6f72 6465 6420 6576  each recorded ev
+0000b760: 656e 742c 2065 766f 6c76 696e 6720 6672  ent, evolving fr
+0000b770: 6f6d 2061 6e20 696e 6974 6961 6c20 7374  om an initial st
+0000b780: 6174 650a 604e 6f6e 6560 2074 6f20 7468  ate.`None` to th
+0000b790: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
+0000b7a0: 6f66 2074 6865 2061 6767 7265 6761 7465  of the aggregate
+0000b7b0: 2e20 5468 6520 6675 6e63 7469 6f6e 2060  . The function `
+0000b7c0: 6765 745f 6167 6772 6567 6174 6528 2960  get_aggregate()`
+0000b7d0: 2073 686f 7773 0a68 6f77 2074 6869 7320   shows.how this 
+0000b7e0: 6361 6e20 6265 2064 6f6e 652e 2054 6865  can be done. The
+0000b7f0: 2061 6767 7265 6761 7465 2049 4420 6973   aggregate ID is
+0000b800: 2075 7365 6420 6173 2061 2073 7472 6561   used as a strea
+0000b810: 6d20 6e61 6d65 2e20 5468 6520 6578 6365  m name. The exce
+0000b820: 7074 696f 6e0a 6041 6767 7265 6761 7465  ption.`Aggregate
+0000b830: 4e6f 7446 6f75 6e64 6020 6973 2072 6169  NotFound` is rai
+0000b840: 7365 6420 6966 2074 6865 2061 6767 7265  sed if the aggre
+0000b850: 6761 7465 2073 7472 6561 6d20 6973 206e  gate stream is n
+0000b860: 6f74 2066 6f75 6e64 2e0a 0a60 6060 7079  ot found...```py
+0000b870: 7468 6f6e 0a63 6c61 7373 2041 6767 7265  thon.class Aggre
+0000b880: 6761 7465 4e6f 7446 6f75 6e64 2845 7863  gateNotFound(Exc
+0000b890: 6570 7469 6f6e 293a 0a20 2020 2022 2222  eption):.    """
+0000b8a0: 5261 6973 6564 2077 6865 6e20 616e 2061  Raised when an a
+0000b8b0: 6767 7265 6761 7465 2069 7320 6e6f 7420  ggregate is not 
+0000b8c0: 666f 756e 642e 2222 220a 0a0a 6465 6620  found."""...def 
+0000b8d0: 6765 745f 6167 6772 6567 6174 6528 6167  get_aggregate(ag
+0000b8e0: 6772 6567 6174 655f 6964 2c20 6d75 7461  gregate_id, muta
+0000b8f0: 746f 725f 6675 6e63 293a 0a20 2020 2073  tor_func):.    s
+0000b900: 7472 6561 6d5f 6e61 6d65 203d 2061 6767  tream_name = agg
+0000b910: 7265 6761 7465 5f69 640a 0a20 2020 2023  regate_id..    #
+0000b920: 2047 6574 2072 6563 6f72 6465 6420 6576   Get recorded ev
+0000b930: 656e 7473 2e0a 2020 2020 7472 793a 0a20  ents..    try:. 
+0000b940: 2020 2020 2020 2065 7665 6e74 7320 3d20         events = 
+0000b950: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
+0000b960: 616d 5f65 7665 6e74 7328 0a20 2020 2020  am_events(.     
+0000b970: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+0000b980: 6d65 3d73 7472 6561 6d5f 6e61 6d65 2c0a  me=stream_name,.
+0000b990: 2020 2020 2020 2020 2020 2020 7374 7265              stre
+0000b9a0: 616d 5f70 6f73 6974 696f 6e3d 4e6f 6e65  am_position=None
+0000b9b0: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
+0000b9c0: 7863 6570 7420 4e6f 7446 6f75 6e64 2061  xcept NotFound a
+0000b9d0: 7320 653a 0a20 2020 2020 2020 2072 6169  s e:.        rai
+0000b9e0: 7365 2041 6767 7265 6761 7465 4e6f 7446  se AggregateNotF
+0000b9f0: 6f75 6e64 2861 6767 7265 6761 7465 5f69  ound(aggregate_i
+0000ba00: 6429 2066 726f 6d20 650a 2020 2020 656c  d) from e.    el
+0000ba10: 7365 3a0a 2020 2020 2020 2020 2320 5265  se:.        # Re
+0000ba20: 636f 6e73 7472 7563 7420 6167 6772 6567  construct aggreg
+0000ba30: 6174 6520 6672 6f6d 2072 6563 6f72 6465  ate from recorde
+0000ba40: 6420 6576 656e 7473 2e0a 2020 2020 2020  d events..      
+0000ba50: 2020 6167 6772 6567 6174 6520 3d20 4e6f    aggregate = No
+0000ba60: 6e65 0a20 2020 2020 2020 2066 6f72 2065  ne.        for e
+0000ba70: 7665 6e74 2069 6e20 6576 656e 7473 3a0a  vent in events:.
+0000ba80: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+0000ba90: 6567 6174 6520 3d20 6d75 7461 746f 725f  egate = mutator_
+0000baa0: 6675 6e63 2861 6767 7265 6761 7465 2c20  func(aggregate, 
+0000bab0: 6576 656e 7429 0a20 2020 2020 2020 2072  event).        r
+0000bac0: 6574 7572 6e20 6167 6772 6567 6174 650a  eturn aggregate.
+0000bad0: 6060 600a 0a53 6e61 7073 686f 7474 696e  ```..Snapshottin
+0000bae0: 6720 6f66 2061 6767 7265 6761 7465 7320  g of aggregates 
+0000baf0: 6361 6e20 6265 2069 6d70 6c65 6d65 6e74  can be implement
+0000bb00: 6564 2062 7920 7265 636f 7264 696e 6720  ed by recording 
+0000bb10: 7468 6520 6375 7272 656e 7420 7374 6174  the current stat
+0000bb20: 6520 6f66 0a61 6e20 6167 6772 6567 6174  e of.an aggregat
+0000bb30: 6520 6173 2061 206e 6577 2065 7665 6e74  e as a new event
+0000bb40: 2e0a 0a49 6620 616e 2061 6767 7265 6761  ...If an aggrega
+0000bb50: 7465 206f 626a 6563 7420 6861 7320 6120  te object has a 
+0000bb60: 7665 7273 696f 6e20 6e75 6d62 6572 2074  version number t
+0000bb70: 6861 7420 636f 7272 6573 706f 6e64 7320  hat corresponds 
+0000bb80: 746f 2074 6865 2073 7472 6561 6d20 706f  to the stream po
+0000bb90: 7369 7469 6f6e 206f 660a 7468 6520 6c61  sition of.the la
+0000bba0: 7374 2065 7665 6e74 2074 6861 7420 7761  st event that wa
+0000bbb0: 7320 7573 6564 2074 6f20 7265 636f 6e73  s used to recons
+0000bbc0: 7472 7563 7420 7468 6520 6167 6772 6567  truct the aggreg
+0000bbd0: 6174 652c 2061 6e64 2074 6869 7320 7665  ate, and this ve
+0000bbe0: 7273 696f 6e20 6e75 6d62 6572 0a69 7320  rsion number.is 
+0000bbf0: 7265 636f 7264 6564 2069 6e20 7468 6520  recorded in the 
+0000bc00: 736e 6170 7368 6f74 206d 6574 6164 6174  snapshot metadat
+0000bc10: 612c 2074 6865 6e20 616e 7920 6576 656e  a, then any even
+0000bc20: 7473 2074 6861 7420 6172 6520 7265 636f  ts that are reco
+0000bc30: 7264 6564 2061 6674 6572 2074 6865 0a73  rded after the.s
+0000bc40: 6e61 7073 686f 7420 6361 6e20 6265 2073  napshot can be s
+0000bc50: 656c 6563 7465 6420 7573 696e 6720 7468  elected using th
+0000bc60: 6973 2076 6572 7369 6f6e 206e 756d 6265  is version numbe
+0000bc70: 722e 2054 6865 2061 6767 7265 6761 7465  r. The aggregate
+0000bc80: 2063 616e 2074 6865 6e20 6265 0a72 6563   can then be.rec
+0000bc90: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
+0000bca0: 7468 6520 6c61 7374 2073 6e61 7073 686f  the last snapsho
+0000bcb0: 7420 616e 6420 616e 7920 7375 6273 6571  t and any subseq
+0000bcc0: 7565 6e74 2065 7665 6e74 732c 2077 6974  uent events, wit
+0000bcd0: 686f 7574 2068 6176 696e 670a 746f 2072  hout having.to r
+0000bce0: 6570 6c61 7920 7468 6520 656e 7469 7265  eplay the entire
+0000bcf0: 2068 6973 746f 7279 2e0a 0a57 6520 7769   history...We wi
+0000bd00: 6c6c 2075 7365 2061 2073 6570 6172 6174  ll use a separat
+0000bd10: 6520 7374 7265 616d 2066 6f72 2061 6e20  e stream for an 
+0000bd20: 6167 6772 6567 6174 6527 7320 736e 6170  aggregate's snap
+0000bd30: 7368 6f74 7320 7468 6174 2069 7320 6e61  shots that is na
+0000bd40: 6d65 6420 6166 7465 7220 7468 650a 7374  med after the.st
+0000bd50: 7265 616d 2075 7365 6420 666f 7220 7265  ream used for re
+0000bd60: 636f 7264 696e 6720 6974 7320 6576 656e  cording its even
+0000bd70: 7473 2e20 5468 6520 6e61 6d65 206f 6620  ts. The name of 
+0000bd80: 7468 6520 736e 6170 7368 6f74 2073 7472  the snapshot str
+0000bd90: 6561 6d20 7769 6c6c 2062 650a 636f 6e73  eam will be.cons
+0000bda0: 7472 7563 7465 6420 6279 2070 7265 6669  tructed by prefi
+0000bdb0: 7869 6e67 2074 6865 2061 6767 7265 6761  xing the aggrega
+0000bdc0: 7465 2773 2073 7472 6561 6d20 6e61 6d65  te's stream name
+0000bdd0: 2077 6974 6820 6027 736e 6170 7368 6f74   with `'snapshot
+0000bde0: 2d24 2760 2e0a 0a60 6060 7079 7468 6f6e  -$'`...```python
+0000bdf0: 0a53 4e41 5053 484f 545f 5354 5245 414d  .SNAPSHOT_STREAM
+0000be00: 5f4e 414d 455f 5052 4546 4958 203d 2027  _NAME_PREFIX = '
+0000be10: 736e 6170 7368 6f74 2d24 270a 0a64 6566  snapshot-$'..def
+0000be20: 206d 616b 655f 736e 6170 7368 6f74 5f73   make_snapshot_s
+0000be30: 7472 6561 6d5f 6e61 6d65 2873 7472 6561  tream_name(strea
+0000be40: 6d5f 6e61 6d65 293a 0a20 2020 2072 6574  m_name):.    ret
+0000be50: 7572 6e20 6627 7b53 4e41 5053 484f 545f  urn f'{SNAPSHOT_
+0000be60: 5354 5245 414d 5f4e 414d 455f 5052 4546  STREAM_NAME_PREF
+0000be70: 4958 7d7b 7374 7265 616d 5f6e 616d 657d  IX}{stream_name}
+0000be80: 270a 0a0a 6465 6620 7265 6d6f 7665 5f73  '...def remove_s
+0000be90: 6e61 7073 686f 745f 7374 7265 616d 5f70  napshot_stream_p
+0000bea0: 7265 6669 7828 736e 6170 7368 6f74 5f73  refix(snapshot_s
+0000beb0: 7472 6561 6d5f 6e61 6d65 293a 0a20 2020  tream_name):.   
+0000bec0: 2061 7373 6572 7420 736e 6170 7368 6f74   assert snapshot
+0000bed0: 5f73 7472 6561 6d5f 6e61 6d65 2e73 7461  _stream_name.sta
+0000bee0: 7274 7377 6974 6828 534e 4150 5348 4f54  rtswith(SNAPSHOT
+0000bef0: 5f53 5452 4541 4d5f 4e41 4d45 5f50 5245  _STREAM_NAME_PRE
+0000bf00: 4649 5829 0a20 2020 2072 6574 7572 6e20  FIX).    return 
+0000bf10: 736e 6170 7368 6f74 5f73 7472 6561 6d5f  snapshot_stream_
+0000bf20: 6e61 6d65 5b6c 656e 2853 4e41 5053 484f  name[len(SNAPSHO
+0000bf30: 545f 5354 5245 414d 5f4e 414d 455f 5052  T_STREAM_NAME_PR
+0000bf40: 4546 4958 293a 5d0a 6060 600a 0a4e 6f77  EFIX):].```..Now
+0000bf50: 2c20 6c65 7427 7320 7265 6465 6669 6e65  , let's redefine
+0000bf60: 2074 6865 2060 6765 745f 6167 6772 6567   the `get_aggreg
+0000bf70: 6174 6528 2960 2066 756e 6374 696f 6e2c  ate()` function,
+0000bf80: 2073 6f20 7468 6174 2069 7420 6c6f 6f6b   so that it look
+0000bf90: 7320 666f 7220 6120 736e 6170 7368 6f74  s for a snapshot
+0000bfa0: 2065 7665 6e74 2c0a 7468 656e 2073 656c   event,.then sel
+0000bfb0: 6563 7473 2073 7562 7365 7175 656e 7420  ects subsequent 
+0000bfc0: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
+0000bfd0: 2c20 616e 6420 7468 656e 2063 616c 6c73  , and then calls
+0000bfe0: 2061 206d 7574 6174 6f72 2066 756e 6374   a mutator funct
+0000bff0: 696f 6e20 666f 7220 6561 6368 0a72 6563  ion for each.rec
+0000c000: 6f72 6465 6420 6576 656e 742e 0a0a 4e6f  orded event...No
+0000c010: 7469 6365 2074 6861 7420 7468 6520 6167  tice that the ag
+0000c020: 6772 6567 6174 6520 6576 656e 7473 2061  gregate events a
+0000c030: 7265 2072 6561 6420 6672 6f6d 2061 2073  re read from a s
+0000c040: 7472 6561 6d20 666f 7220 7365 7269 616c  tream for serial
+0000c050: 697a 6564 2061 6767 7265 6761 7465 0a65  ized aggregate.e
+0000c060: 7665 6e74 732c 2077 6869 6c73 7420 7468  vents, whilst th
+0000c070: 6520 736e 6170 7368 6f74 2069 7320 7265  e snapshot is re
+0000c080: 6164 2066 726f 6d20 6120 7365 7061 7261  ad from a separa
+0000c090: 7465 2073 7472 6561 6d20 666f 7220 7365  te stream for se
+0000c0a0: 7269 616c 697a 6564 2061 6767 7265 6761  rialized aggrega
+0000c0b0: 7465 0a73 6e61 7073 686f 7473 2e20 5765  te.snapshots. We
+0000c0c0: 2077 696c 6c20 7573 6520 4a53 4f4e 2074   will use JSON t
+0000c0d0: 6f20 7365 7269 616c 697a 6520 616e 6420  o serialize and 
+0000c0e0: 6465 7365 7269 616c 697a 6520 6576 656e  deserialize even
+0000c0f0: 7420 6461 7461 2e0a 0a0a 6060 6070 7974  t data....```pyt
+0000c100: 686f 6e0a 696d 706f 7274 206a 736f 6e0a  hon.import json.
+0000c110: 0a0a 6465 6620 6765 745f 6167 6772 6567  ..def get_aggreg
+0000c120: 6174 6528 6167 6772 6567 6174 655f 6964  ate(aggregate_id
+0000c130: 2c20 6d75 7461 746f 725f 6675 6e63 293a  , mutator_func):
+0000c140: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0000c150: 203d 2061 6767 7265 6761 7465 5f69 640a   = aggregate_id.
+0000c160: 2020 2020 7265 636f 7264 6564 5f65 7665      recorded_eve
+0000c170: 6e74 7320 3d20 5b5d 0a0a 2020 2020 2320  nts = []..    # 
+0000c180: 4c6f 6f6b 2066 6f72 2061 2073 6e61 7073  Look for a snaps
+0000c190: 686f 742e 0a20 2020 2074 7279 3a0a 2020  hot..    try:.  
+0000c1a0: 2020 2020 2020 736e 6170 7368 6f74 7320        snapshots 
+0000c1b0: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
+0000c1c0: 7265 616d 5f65 7665 6e74 7328 0a20 2020  ream_events(.   
+0000c1d0: 2020 2020 2020 2020 2073 7472 6561 6d5f           stream_
+0000c1e0: 6e61 6d65 3d6d 616b 655f 736e 6170 7368  name=make_snapsh
+0000c1f0: 6f74 5f73 7472 6561 6d5f 6e61 6d65 2873  ot_stream_name(s
+0000c200: 7472 6561 6d5f 6e61 6d65 292c 0a20 2020  tream_name),.   
+0000c210: 2020 2020 2020 2020 2062 6163 6b77 6172           backwar
+0000c220: 6473 3d54 7275 652c 0a20 2020 2020 2020  ds=True,.       
+0000c230: 2020 2020 206c 696d 6974 3d31 0a20 2020       limit=1.   
+0000c240: 2020 2020 2029 0a20 2020 2065 7863 6570       ).    excep
+0000c250: 7420 4e6f 7446 6f75 6e64 3a0a 2020 2020  t NotFound:.    
+0000c260: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+0000c270: 696f 6e20 3d20 4e6f 6e65 0a20 2020 2065  ion = None.    e
+0000c280: 6c73 653a 0a20 2020 2020 2020 2061 7373  lse:.        ass
+0000c290: 6572 7420 6c65 6e28 736e 6170 7368 6f74  ert len(snapshot
+0000c2a0: 7329 203d 3d20 310a 2020 2020 2020 2020  s) == 1.        
+0000c2b0: 736e 6170 7368 6f74 203d 2073 6e61 7073  snapshot = snaps
+0000c2c0: 686f 7473 5b30 5d0a 2020 2020 2020 2020  hots[0].        
+0000c2d0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+0000c2e0: 3d20 6465 7365 7269 616c 697a 6528 736e  = deserialize(sn
+0000c2f0: 6170 7368 6f74 2e6d 6574 6164 6174 6129  apshot.metadata)
+0000c300: 5b27 7665 7273 696f 6e27 5d20 2b20 310a  ['version'] + 1.
+0000c310: 2020 2020 2020 2020 7265 636f 7264 6564          recorded
+0000c320: 5f65 7665 6e74 732e 6170 7065 6e64 2873  _events.append(s
+0000c330: 6e61 7073 686f 7429 0a0a 2020 2020 2320  napshot)..    # 
+0000c340: 4765 7420 7375 6273 6571 7565 6e74 2065  Get subsequent e
+0000c350: 7665 6e74 732e 0a20 2020 2074 7279 3a0a  vents..    try:.
+0000c360: 2020 2020 2020 2020 6576 656e 7473 203d          events =
+0000c370: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+0000c380: 6561 6d5f 6576 656e 7473 280a 2020 2020  eam_events(.    
+0000c390: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+0000c3a0: 616d 653d 7374 7265 616d 5f6e 616d 652c  ame=stream_name,
+0000c3b0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0000c3c0: 6561 6d5f 706f 7369 7469 6f6e 3d73 7472  eam_position=str
+0000c3d0: 6561 6d5f 706f 7369 7469 6f6e 0a20 2020  eam_position.   
+0000c3e0: 2020 2020 2029 0a20 2020 2065 7863 6570       ).    excep
+0000c3f0: 7420 4e6f 7446 6f75 6e64 2061 7320 653a  t NotFound as e:
+0000c400: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
+0000c410: 6767 7265 6761 7465 4e6f 7446 6f75 6e64  ggregateNotFound
+0000c420: 2861 6767 7265 6761 7465 5f69 6429 2066  (aggregate_id) f
+0000c430: 726f 6d20 650a 2020 2020 656c 7365 3a0a  rom e.    else:.
+0000c440: 2020 2020 2020 2020 7265 636f 7264 6564          recorded
+0000c450: 5f65 7665 6e74 7320 2b3d 2065 7665 6e74  _events += event
+0000c460: 730a 0a20 2020 2023 2052 6563 6f6e 7374  s..    # Reconst
+0000c470: 7275 6374 2061 6767 7265 6761 7465 2066  ruct aggregate f
+0000c480: 726f 6d20 7265 636f 7264 6564 2065 7665  rom recorded eve
+0000c490: 6e74 732e 0a20 2020 2061 6767 7265 6761  nts..    aggrega
+0000c4a0: 7465 203d 204e 6f6e 650a 2020 2020 666f  te = None.    fo
+0000c4b0: 7220 6576 656e 7420 696e 2072 6563 6f72  r event in recor
+0000c4c0: 6465 645f 6576 656e 7473 3a0a 2020 2020  ded_events:.    
+0000c4d0: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
+0000c4e0: 6d75 7461 746f 725f 6675 6e63 2861 6767  mutator_func(agg
+0000c4f0: 7265 6761 7465 2c20 6576 656e 7429 0a0a  regate, event)..
+0000c500: 2020 2020 7265 7475 726e 2061 6767 7265      return aggre
+0000c510: 6761 7465 0a0a 0a64 6566 2073 6572 6961  gate...def seria
+0000c520: 6c69 7a65 2864 293a 0a20 2020 2072 6574  lize(d):.    ret
+0000c530: 7572 6e20 6a73 6f6e 2e64 756d 7073 2864  urn json.dumps(d
+0000c540: 292e 656e 636f 6465 2827 7574 6638 2729  ).encode('utf8')
+0000c550: 0a0a 0a64 6566 2064 6573 6572 6961 6c69  ...def deseriali
+0000c560: 7a65 2873 293a 0a20 2020 2072 6574 7572  ze(s):.    retur
+0000c570: 6e20 6a73 6f6e 2e6c 6f61 6473 2873 2e64  n json.loads(s.d
+0000c580: 6563 6f64 6528 2775 7466 3827 2929 0a60  ecode('utf8')).`
+0000c590: 6060 0a0a 546f 2073 686f 7720 686f 7720  ``..To show how 
+0000c5a0: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
+0000c5b0: 6020 6361 6e20 6265 2075 7365 642c 206c  ` can be used, l
+0000c5c0: 6574 2773 2064 6566 696e 6520 6120 6044  et's define a `D
+0000c5d0: 6f67 6020 6167 6772 6567 6174 6520 636c  og` aggregate cl
+0000c5e0: 6173 732c 2077 6974 680a 6174 7472 6962  ass, with.attrib
+0000c5f0: 7574 6573 2060 6e61 6d65 6020 616e 6420  utes `name` and 
+0000c600: 6074 7269 636b 7360 2e20 5468 6520 6174  `tricks`. The at
+0000c610: 7472 6962 7574 6573 2060 6964 6020 616e  tributes `id` an
+0000c620: 6420 6076 6572 7369 6f6e 6020 7769 6c6c  d `version` will
+0000c630: 2069 6e64 6963 6174 6520 616e 0a61 6767   indicate an.agg
+0000c640: 7265 6761 7465 206f 626a 6563 7427 7320  regate object's 
+0000c650: 4944 2061 6e64 2076 6572 7369 6f6e 206e  ID and version n
+0000c660: 756d 6265 722e 2054 6865 2061 7474 7269  umber. The attri
+0000c670: 6275 7465 2060 6973 5f66 726f 6d5f 736e  bute `is_from_sn
+0000c680: 6170 7368 6f74 6020 6973 2061 6464 6564  apshot` is added
+0000c690: 0a68 6572 6520 6d65 7265 6c79 2074 6f20  .here merely to 
+0000c6a0: 6465 6d6f 6e73 7472 6174 6520 6265 6c6f  demonstrate belo
+0000c6b0: 7720 7768 656e 2061 6e20 6167 6772 6567  w when an aggreg
+0000c6c0: 6174 6520 6f62 6a65 6374 2068 6173 2062  ate object has b
+0000c6d0: 6565 6e20 7265 636f 6e73 7472 7563 7465  een reconstructe
+0000c6e0: 6420 7573 696e 670a 6120 736e 6170 7368  d using.a snapsh
+0000c6f0: 6f74 2e0a 0a60 6060 7079 7468 6f6e 0a66  ot...```python.f
+0000c700: 726f 6d20 6461 7461 636c 6173 7365 7320  rom dataclasses 
+0000c710: 696d 706f 7274 2064 6174 6163 6c61 7373  import dataclass
+0000c720: 0a0a 0a40 6461 7461 636c 6173 7328 6672  ...@dataclass(fr
+0000c730: 6f7a 656e 3d54 7275 6529 0a63 6c61 7373  ozen=True).class
+0000c740: 2041 6767 7265 6761 7465 3a0a 2020 2020   Aggregate:.    
+0000c750: 6964 3a20 7374 720a 2020 2020 7665 7273  id: str.    vers
+0000c760: 696f 6e3a 2069 6e74 0a20 2020 2069 735f  ion: int.    is_
+0000c770: 6672 6f6d 5f73 6e61 7073 686f 743a 2062  from_snapshot: b
+0000c780: 6f6f 6c0a 0a0a 4064 6174 6163 6c61 7373  ool...@dataclass
+0000c790: 2866 726f 7a65 6e3d 5472 7565 290a 636c  (frozen=True).cl
+0000c7a0: 6173 7320 446f 6728 4167 6772 6567 6174  ass Dog(Aggregat
+0000c7b0: 6529 3a0a 2020 2020 6e61 6d65 3a20 7374  e):.    name: st
+0000c7c0: 720a 2020 2020 7472 6963 6b73 3a20 6c69  r.    tricks: li
+0000c7d0: 7374 0a60 6060 0a0a 4c65 7427 7320 616c  st.```..Let's al
+0000c7e0: 736f 2064 6566 696e 6520 6120 6d75 7461  so define a muta
+0000c7f0: 746f 7220 6675 6e63 7469 6f6e 2060 6d75  tor function `mu
+0000c800: 7461 7465 5f64 6f67 2829 6020 7468 6174  tate_dog()` that
+0000c810: 2063 616e 2065 766f 6c76 6520 7468 6520   can evolve the 
+0000c820: 7374 6174 6520 6f66 2061 0a60 446f 6760  state of a.`Dog`
+0000c830: 2061 6767 7265 6761 7465 2067 6976 656e   aggregate given
+0000c840: 2076 6172 696f 7573 2064 6966 6665 7265   various differe
+0000c850: 6e74 2074 7970 6573 206f 6620 6576 656e  nt types of even
+0000c860: 7473 2c20 6027 446f 6752 6567 6973 7465  ts, `'DogRegiste
+0000c870: 7265 6427 602c 0a60 2744 6f67 4c65 6172  red'`,.`'DogLear
+0000c880: 6e65 6454 7269 636b 2760 2c20 616e 6420  nedTrick'`, and 
+0000c890: 6027 536e 6170 7368 6f74 2760 2e0a 0a60  `'Snapshot'`...`
+0000c8a0: 6060 7079 7468 6f6e 0a64 6566 206d 7574  ``python.def mut
+0000c8b0: 6174 655f 646f 6728 646f 672c 2065 7665  ate_dog(dog, eve
+0000c8c0: 6e74 293a 0a20 2020 2064 6174 6120 3d20  nt):.    data = 
+0000c8d0: 6465 7365 7269 616c 697a 6528 6576 656e  deserialize(even
+0000c8e0: 742e 6461 7461 290a 2020 2020 6966 2065  t.data).    if e
+0000c8f0: 7665 6e74 2e74 7970 6520 3d3d 2027 446f  vent.type == 'Do
+0000c900: 6752 6567 6973 7465 7265 6427 3a0a 2020  gRegistered':.  
+0000c910: 2020 2020 2020 7265 7475 726e 2044 6f67        return Dog
+0000c920: 280a 2020 2020 2020 2020 2020 2020 6964  (.            id
+0000c930: 3d65 7665 6e74 2e73 7472 6561 6d5f 6e61  =event.stream_na
+0000c940: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0000c950: 7665 7273 696f 6e3d 6576 656e 742e 7374  version=event.st
+0000c960: 7265 616d 5f70 6f73 6974 696f 6e2c 0a20  ream_position,. 
+0000c970: 2020 2020 2020 2020 2020 2069 735f 6672             is_fr
+0000c980: 6f6d 5f73 6e61 7073 686f 743d 4661 6c73  om_snapshot=Fals
+0000c990: 652c 0a20 2020 2020 2020 2020 2020 206e  e,.            n
+0000c9a0: 616d 653d 6461 7461 5b27 6e61 6d65 275d  ame=data['name']
+0000c9b0: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
+0000c9c0: 6963 6b73 3d5b 5d2c 0a20 2020 2020 2020  icks=[],.       
+0000c9d0: 2029 0a20 2020 2065 6c69 6620 6576 656e   ).    elif even
+0000c9e0: 742e 7479 7065 203d 3d20 2744 6f67 4c65  t.type == 'DogLe
+0000c9f0: 6172 6e65 6454 7269 636b 273a 0a20 2020  arnedTrick':.   
+0000ca00: 2020 2020 2061 7373 6572 7420 6576 656e       assert even
+0000ca10: 742e 7374 7265 616d 5f70 6f73 6974 696f  t.stream_positio
+0000ca20: 6e20 3d3d 2064 6f67 2e76 6572 7369 6f6e  n == dog.version
+0000ca30: 202b 2031 0a20 2020 2020 2020 2061 7373   + 1.        ass
+0000ca40: 6572 7420 6576 656e 742e 7374 7265 616d  ert event.stream
+0000ca50: 5f6e 616d 6520 3d3d 2064 6f67 2e69 642c  _name == dog.id,
+0000ca60: 2028 6576 656e 742e 7374 7265 616d 5f6e   (event.stream_n
+0000ca70: 616d 652c 2064 6f67 2e69 6429 0a20 2020  ame, dog.id).   
+0000ca80: 2020 2020 2072 6574 7572 6e20 446f 6728       return Dog(
+0000ca90: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
+0000caa0: 646f 672e 6964 2c0a 2020 2020 2020 2020  dog.id,.        
+0000cab0: 2020 2020 7665 7273 696f 6e3d 6576 656e      version=even
+0000cac0: 742e 7374 7265 616d 5f70 6f73 6974 696f  t.stream_positio
+0000cad0: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
+0000cae0: 735f 6672 6f6d 5f73 6e61 7073 686f 743d  s_from_snapshot=
+0000caf0: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
+0000cb00: 7368 6f74 2c0a 2020 2020 2020 2020 2020  shot,.          
+0000cb10: 2020 6e61 6d65 3d64 6f67 2e6e 616d 652c    name=dog.name,
+0000cb20: 0a20 2020 2020 2020 2020 2020 2074 7269  .            tri
+0000cb30: 636b 733d 646f 672e 7472 6963 6b73 202b  cks=dog.tricks +
+0000cb40: 205b 6461 7461 5b27 7472 6963 6b27 5d5d   [data['trick']]
+0000cb50: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000cb60: 656c 6966 2065 7665 6e74 2e74 7970 6520  elif event.type 
+0000cb70: 3d3d 2027 536e 6170 7368 6f74 273a 0a20  == 'Snapshot':. 
+0000cb80: 2020 2020 2020 2072 6574 7572 6e20 446f         return Do
+0000cb90: 6728 0a20 2020 2020 2020 2020 2020 2069  g(.            i
+0000cba0: 643d 7265 6d6f 7665 5f73 6e61 7073 686f  d=remove_snapsho
+0000cbb0: 745f 7374 7265 616d 5f70 7265 6669 7828  t_stream_prefix(
+0000cbc0: 6576 656e 742e 7374 7265 616d 5f6e 616d  event.stream_nam
+0000cbd0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+0000cbe0: 7665 7273 696f 6e3d 6465 7365 7269 616c  version=deserial
+0000cbf0: 697a 6528 6576 656e 742e 6d65 7461 6461  ize(event.metada
+0000cc00: 7461 295b 2776 6572 7369 6f6e 275d 2c0a  ta)['version'],.
+0000cc10: 2020 2020 2020 2020 2020 2020 6973 5f66              is_f
+0000cc20: 726f 6d5f 736e 6170 7368 6f74 3d54 7275  rom_snapshot=Tru
+0000cc30: 652c 0a20 2020 2020 2020 2020 2020 206e  e,.            n
+0000cc40: 616d 653d 6461 7461 5b27 6e61 6d65 275d  ame=data['name']
+0000cc50: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
+0000cc60: 6963 6b73 3d64 6174 615b 2774 7269 636b  icks=data['trick
+0000cc70: 7327 5d2c 0a20 2020 2020 2020 2029 0a20  s'],.        ). 
+0000cc80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000cc90: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+0000cca0: 2866 2255 6e6b 6e6f 776e 2065 7665 6e74  (f"Unknown event
+0000ccb0: 2074 7970 653a 207b 6576 656e 742e 7479   type: {event.ty
+0000ccc0: 7065 7d22 290a 6060 600a 0a46 6f72 2063  pe}").```..For c
+0000ccd0: 6f6e 7665 6e69 656e 6365 2c20 6c65 7427  onvenience, let'
+0000cce0: 7320 616c 736f 2064 6566 696e 6520 6120  s also define a 
+0000ccf0: 6067 6574 5f64 6f67 2829 6020 6675 6e63  `get_dog()` func
+0000cd00: 7469 6f6e 2074 6861 7420 6361 6c6c 7320  tion that calls 
+0000cd10: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
+0000cd20: 600a 7769 7468 2074 6865 2060 6d75 7461  `.with the `muta
+0000cd30: 7465 5f64 6f67 2829 6020 6675 6e63 7469  te_dog()` functi
+0000cd40: 6f6e 2061 7320 7468 6520 7661 6c75 6520  on as the value 
+0000cd50: 6f66 2069 7473 2060 6d75 7461 746f 725f  of its `mutator_
+0000cd60: 6675 6e63 6020 6172 6775 6d65 6e74 2e0a  func` argument..
+0000cd70: 0a60 6060 7079 7468 6f6e 0a64 6566 2067  .```python.def g
+0000cd80: 6574 5f64 6f67 2864 6f67 5f69 6429 3a0a  et_dog(dog_id):.
+0000cd90: 2020 2020 7265 7475 726e 2067 6574 5f61      return get_a
+0000cda0: 6767 7265 6761 7465 280a 2020 2020 2020  ggregate(.      
+0000cdb0: 2020 6167 6772 6567 6174 655f 6964 3d64    aggregate_id=d
+0000cdc0: 6f67 5f69 642c 0a20 2020 2020 2020 206d  og_id,.        m
+0000cdd0: 7574 6174 6f72 5f66 756e 633d 6d75 7461  utator_func=muta
+0000cde0: 7465 5f64 6f67 2c0a 2020 2020 290a 6060  te_dog,.    ).``
+0000cdf0: 600a 0a57 6520 6361 6e20 616c 736f 2064  `..We can also d
+0000ce00: 6566 696e 6520 736f 6d65 2022 636f 6d6d  efine some "comm
+0000ce10: 616e 6422 2066 756e 6374 696f 6e73 2074  and" functions t
+0000ce20: 6861 7420 6170 7065 6e64 206e 6577 2065  hat append new e
+0000ce30: 7665 6e74 7320 746f 2074 6865 0a64 6174  vents to the.dat
+0000ce40: 6162 6173 652e 2054 6865 2060 7265 6769  abase. The `regi
+0000ce50: 7374 6572 5f64 6f67 2829 6020 6675 6e63  ster_dog()` func
+0000ce60: 7469 6f6e 2061 7070 656e 6473 2061 2060  tion appends a `
+0000ce70: 446f 6752 6567 6973 7465 7265 6460 2065  DogRegistered` e
+0000ce80: 7665 6e74 2e20 5468 650a 6072 6563 6f72  vent. The.`recor
+0000ce90: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+0000cea0: 2960 2061 7070 656e 6473 2061 2060 446f  )` appends a `Do
+0000ceb0: 674c 6561 726e 6564 5472 6963 6b60 2065  gLearnedTrick` e
+0000cec0: 7665 6e74 2e20 5468 6520 6675 6e63 7469  vent. The functi
+0000ced0: 6f6e 0a60 736e 6170 7368 6f74 5f64 6f67  on.`snapshot_dog
+0000cee0: 2829 6020 6170 7065 6e64 7320 6120 6053  ()` appends a `S
+0000cef0: 6e61 7073 686f 7460 2065 7665 6e74 2e20  napshot` event. 
+0000cf00: 4e6f 7469 6365 2074 6861 7420 7468 650a  Notice that the.
+0000cf10: 6072 6563 6f72 645f 7472 6963 6b5f 6c65  `record_trick_le
+0000cf20: 6172 6e65 6428 2960 2061 6e64 2060 736e  arned()` and `sn
+0000cf30: 6170 7368 6f74 5f64 6f67 2829 6020 6675  apshot_dog()` fu
+0000cf40: 6e63 7469 6f6e 7320 7573 6520 6067 6574  nctions use `get
+0000cf50: 5f64 6f67 2829 602e 0a0a 4e6f 7469 6365  _dog()`...Notice
+0000cf60: 2061 6c73 6f20 7468 6174 2074 6865 2060   also that the `
+0000cf70: 446f 6752 6567 6973 7465 7265 6460 2061  DogRegistered` a
+0000cf80: 6e64 2060 446f 674c 6561 726e 6564 5472  nd `DogLearnedTr
+0000cf90: 6963 6b60 2065 7665 6e74 7320 6172 6520  ick` events are 
+0000cfa0: 6170 7065 6e64 6564 2074 6f20 610a 7374  appended to a.st
+0000cfb0: 7265 616d 2066 6f72 2061 6767 7265 6761  ream for aggrega
+0000cfc0: 7465 2065 7665 6e74 732c 2077 6869 6c73  te events, whils
+0000cfd0: 7420 7468 6520 6053 6e61 7073 686f 7460  t the `Snapshot`
+0000cfe0: 2065 7665 6e74 2069 7320 6170 7065 6e64   event is append
+0000cff0: 6564 2074 6f20 6120 7365 7061 7261 7465  ed to a separate
+0000d000: 0a73 7472 6561 6d20 666f 7220 6167 6772  .stream for aggr
+0000d010: 6567 6174 6520 736e 6170 7368 6f74 732e  egate snapshots.
+0000d020: 0a0a 6060 6070 7974 686f 6e0a 6465 6620  ..```python.def 
+0000d030: 7265 6769 7374 6572 5f64 6f67 286e 616d  register_dog(nam
+0000d040: 6529 3a0a 2020 2020 646f 675f 6964 203d  e):.    dog_id =
+0000d050: 2073 7472 2875 7569 642e 7575 6964 3428   str(uuid.uuid4(
+0000d060: 2929 0a20 2020 2065 7665 6e74 203d 204e  )).    event = N
+0000d070: 6577 4576 656e 7428 0a20 2020 2020 2020  ewEvent(.       
+0000d080: 2074 7970 653d 2744 6f67 5265 6769 7374   type='DogRegist
+0000d090: 6572 6564 272c 0a20 2020 2020 2020 2064  ered',.        d
+0000d0a0: 6174 613d 7365 7269 616c 697a 6528 7b27  ata=serialize({'
+0000d0b0: 6e61 6d65 273a 206e 616d 657d 292c 0a20  name': name}),. 
+0000d0c0: 2020 2029 0a20 2020 2063 6c69 656e 742e     ).    client.
+0000d0d0: 6170 7065 6e64 5f65 7665 6e74 280a 2020  append_event(.  
+0000d0e0: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+0000d0f0: 653d 646f 675f 6964 2c0a 2020 2020 2020  e=dog_id,.      
+0000d100: 2020 6375 7272 656e 745f 7665 7273 696f    current_versio
+0000d110: 6e3d 4e6f 6e65 2c0a 2020 2020 2020 2020  n=None,.        
+0000d120: 6576 656e 743d 6576 656e 742c 0a20 2020  event=event,.   
+0000d130: 2029 0a20 2020 2072 6574 7572 6e20 646f   ).    return do
+0000d140: 675f 6964 0a0a 0a64 6566 2072 6563 6f72  g_id...def recor
+0000d150: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+0000d160: 646f 675f 6964 2c20 7472 6963 6b29 3a0a  dog_id, trick):.
+0000d170: 2020 2020 646f 6720 3d20 6765 745f 646f      dog = get_do
+0000d180: 6728 646f 675f 6964 290a 2020 2020 6576  g(dog_id).    ev
+0000d190: 656e 7420 3d20 4e65 7745 7665 6e74 280a  ent = NewEvent(.
+0000d1a0: 2020 2020 2020 2020 7479 7065 3d27 446f          type='Do
+0000d1b0: 674c 6561 726e 6564 5472 6963 6b27 2c0a  gLearnedTrick',.
+0000d1c0: 2020 2020 2020 2020 6461 7461 3d73 6572          data=ser
+0000d1d0: 6961 6c69 7a65 287b 2774 7269 636b 273a  ialize({'trick':
+0000d1e0: 2074 7269 636b 7d29 2c0a 2020 2020 290a   trick}),.    ).
+0000d1f0: 2020 2020 636c 6965 6e74 2e61 7070 656e      client.appen
+0000d200: 645f 6576 656e 7428 0a20 2020 2020 2020  d_event(.       
+0000d210: 2073 7472 6561 6d5f 6e61 6d65 3d64 6f67   stream_name=dog
+0000d220: 5f69 642c 0a20 2020 2020 2020 2063 7572  _id,.        cur
+0000d230: 7265 6e74 5f76 6572 7369 6f6e 3d64 6f67  rent_version=dog
+0000d240: 2e76 6572 7369 6f6e 2c0a 2020 2020 2020  .version,.      
+0000d250: 2020 6576 656e 743d 6576 656e 742c 0a20    event=event,. 
+0000d260: 2020 2029 0a0a 0a64 6566 2073 6e61 7073     )...def snaps
+0000d270: 686f 745f 646f 6728 646f 675f 6964 293a  hot_dog(dog_id):
+0000d280: 0a20 2020 2064 6f67 203d 2067 6574 5f64  .    dog = get_d
+0000d290: 6f67 2864 6f67 5f69 6429 0a20 2020 2065  og(dog_id).    e
+0000d2a0: 7665 6e74 203d 204e 6577 4576 656e 7428  vent = NewEvent(
+0000d2b0: 0a20 2020 2020 2020 2074 7970 653d 2753  .        type='S
+0000d2c0: 6e61 7073 686f 7427 2c0a 2020 2020 2020  napshot',.      
+0000d2d0: 2020 6461 7461 3d73 6572 6961 6c69 7a65    data=serialize
+0000d2e0: 287b 276e 616d 6527 3a20 646f 672e 6e61  ({'name': dog.na
+0000d2f0: 6d65 2c20 2774 7269 636b 7327 3a20 646f  me, 'tricks': do
+0000d300: 672e 7472 6963 6b73 7d29 2c0a 2020 2020  g.tricks}),.    
+0000d310: 2020 2020 6d65 7461 6461 7461 3d73 6572      metadata=ser
+0000d320: 6961 6c69 7a65 287b 2776 6572 7369 6f6e  ialize({'version
+0000d330: 273a 2064 6f67 2e76 6572 7369 6f6e 7d29  ': dog.version})
+0000d340: 2c0a 2020 2020 290a 2020 2020 636c 6965  ,.    ).    clie
+0000d350: 6e74 2e61 7070 656e 645f 6576 656e 7428  nt.append_event(
+0000d360: 0a20 2020 2020 2020 2073 7472 6561 6d5f  .        stream_
+0000d370: 6e61 6d65 3d6d 616b 655f 736e 6170 7368  name=make_snapsh
+0000d380: 6f74 5f73 7472 6561 6d5f 6e61 6d65 2864  ot_stream_name(d
+0000d390: 6f67 5f69 6429 2c0a 2020 2020 2020 2020  og_id),.        
+0000d3a0: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
+0000d3b0: 2d31 2c0a 2020 2020 2020 2020 6576 656e  -1,.        even
+0000d3c0: 743d 6576 656e 742c 0a20 2020 2029 0a60  t=event,.    ).`
+0000d3d0: 6060 0a0a 5765 2063 616e 2063 616c 6c20  ``..We can call 
+0000d3e0: 6072 6567 6973 7465 725f 646f 6728 2960  `register_dog()`
+0000d3f0: 2074 6f20 7265 6769 7374 6572 2061 206e   to register a n
+0000d400: 6577 2064 6f67 2e0a 0a60 6060 7079 7468  ew dog...```pyth
+0000d410: 6f6e 0a23 2052 6567 6973 7465 7220 6120  on.# Register a 
+0000d420: 6e65 7720 646f 672e 0a64 6f67 5f69 6420  new dog..dog_id 
+0000d430: 3d20 7265 6769 7374 6572 5f64 6f67 2827  = register_dog('
+0000d440: 4669 646f 2729 0a0a 646f 6720 3d20 6765  Fido')..dog = ge
+0000d450: 745f 646f 6728 646f 675f 6964 290a 6173  t_dog(dog_id).as
+0000d460: 7365 7274 2064 6f67 2e6e 616d 6520 3d3d  sert dog.name ==
+0000d470: 2027 4669 646f 270a 6173 7365 7274 2064   'Fido'.assert d
+0000d480: 6f67 2e74 7269 636b 7320 3d3d 205b 5d0a  og.tricks == [].
+0000d490: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+0000d4a0: 6f6e 203d 3d20 300a 6173 7365 7274 2064  on == 0.assert d
+0000d4b0: 6f67 2e69 735f 6672 6f6d 5f73 6e61 7073  og.is_from_snaps
+0000d4c0: 686f 7420 6973 2046 616c 7365 0a0a 6060  hot is False..``
+0000d4d0: 600a 0a57 6520 6361 6e20 6361 6c6c 2060  `..We can call `
+0000d4e0: 7265 636f 7264 5f74 7269 636b 5f6c 6561  record_trick_lea
+0000d4f0: 726e 6564 2829 6020 746f 2072 6563 6f72  rned()` to recor
+0000d500: 6420 7468 6174 2073 6f6d 6520 7472 6963  d that some tric
+0000d510: 6b73 2068 6176 6520 6265 656e 206c 6561  ks have been lea
+0000d520: 726e 6564 2e0a 0a60 6060 7079 7468 6f6e  rned...```python
+0000d530: 0a0a 2320 5265 636f 7264 2074 6861 7420  ..# Record that 
+0000d540: 2746 6964 6f27 206c 6561 726e 6564 2061  'Fido' learned a
+0000d550: 206e 6577 2074 7269 636b 2e0a 7265 636f   new trick..reco
+0000d560: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
+0000d570: 2864 6f67 5f69 642c 2074 7269 636b 3d27  (dog_id, trick='
+0000d580: 726f 6c6c 206f 7665 7227 290a 0a64 6f67  roll over')..dog
+0000d590: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
+0000d5a0: 6429 0a61 7373 6572 7420 646f 672e 6e61  d).assert dog.na
+0000d5b0: 6d65 203d 3d20 2746 6964 6f27 0a61 7373  me == 'Fido'.ass
+0000d5c0: 6572 7420 646f 672e 7472 6963 6b73 203d  ert dog.tricks =
+0000d5d0: 3d20 5b27 726f 6c6c 206f 7665 7227 5d0a  = ['roll over'].
+0000d5e0: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+0000d5f0: 6f6e 203d 3d20 310a 6173 7365 7274 2064  on == 1.assert d
+0000d600: 6f67 2e69 735f 6672 6f6d 5f73 6e61 7073  og.is_from_snaps
+0000d610: 686f 7420 6973 2046 616c 7365 0a0a 0a23  hot is False...#
+0000d620: 2052 6563 6f72 6420 7468 6174 2027 4669   Record that 'Fi
+0000d630: 646f 2720 6c65 6172 6e65 6420 616e 6f74  do' learned anot
+0000d640: 6865 7220 6e65 7720 7472 6963 6b2e 0a72  her new trick..r
+0000d650: 6563 6f72 645f 7472 6963 6b5f 6c65 6172  ecord_trick_lear
+0000d660: 6e65 6428 646f 675f 6964 2c20 7472 6963  ned(dog_id, tric
+0000d670: 6b3d 2766 6574 6368 2062 616c 6c27 290a  k='fetch ball').
+0000d680: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
+0000d690: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
+0000d6a0: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
+0000d6b0: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
+0000d6c0: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
+0000d6d0: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
+0000d6e0: 5d0a 6173 7365 7274 2064 6f67 2e76 6572  ].assert dog.ver
+0000d6f0: 7369 6f6e 203d 3d20 320a 6173 7365 7274  sion == 2.assert
+0000d700: 2064 6f67 2e69 735f 6672 6f6d 5f73 6e61   dog.is_from_sna
+0000d710: 7073 686f 7420 6973 2046 616c 7365 0a60  pshot is False.`
+0000d720: 6060 0a0a 5765 2063 616e 2063 616c 6c20  ``..We can call 
+0000d730: 6073 6e61 7073 686f 745f 646f 6728 2960  `snapshot_dog()`
+0000d740: 2074 6f20 7265 636f 7264 2061 2073 6e61   to record a sna
+0000d750: 7073 686f 7420 6f66 2074 6865 2063 7572  pshot of the cur
+0000d760: 7265 6e74 2073 7461 7465 206f 6620 7468  rent state of th
+0000d770: 6520 6044 6f67 600a 6167 6772 6567 6174  e `Dog`.aggregat
+0000d780: 652e 2041 6674 6572 2077 6520 6361 6c6c  e. After we call
+0000d790: 2060 736e 6170 7368 6f74 5f64 6f67 2829   `snapshot_dog()
+0000d7a0: 602c 2074 6865 2060 6765 745f 646f 6728  `, the `get_dog(
+0000d7b0: 2960 2066 756e 6374 696f 6e20 7769 6c6c  )` function will
+0000d7c0: 2072 6574 7572 6e20 6120 6044 6f67 600a   return a `Dog`.
+0000d7d0: 6f62 6a65 6374 2074 6861 7420 6861 7320  object that has 
+0000d7e0: 6265 656e 2063 6f6e 7374 7275 6374 6564  been constructed
+0000d7f0: 2075 7369 6e67 2074 6865 2060 536e 6170   using the `Snap
+0000d800: 7368 6f74 6020 6576 656e 742e 0a0a 6060  shot` event...``
+0000d810: 6070 7974 686f 6e0a 2320 536e 6170 7368  `python.# Snapsh
+0000d820: 6f74 2027 4669 646f 272e 0a73 6e61 7073  ot 'Fido'..snaps
+0000d830: 686f 745f 646f 6728 646f 675f 6964 290a  hot_dog(dog_id).
+0000d840: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
+0000d850: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
+0000d860: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
+0000d870: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
+0000d880: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
+0000d890: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
+0000d8a0: 5d0a 6173 7365 7274 2064 6f67 2e76 6572  ].assert dog.ver
+0000d8b0: 7369 6f6e 203d 3d20 320a 6173 7365 7274  sion == 2.assert
+0000d8c0: 2064 6f67 2e69 735f 6672 6f6d 5f73 6e61   dog.is_from_sna
+0000d8d0: 7073 686f 7420 6973 2054 7275 650a 6060  pshot is True.``
+0000d8e0: 600a 0a57 6520 6361 6e20 636f 6e74 696e  `..We can contin
+0000d8f0: 7565 2074 6f20 6576 6f6c 7665 2074 6865  ue to evolve the
+0000d900: 2073 7461 7465 206f 6620 7468 6520 6044   state of the `D
+0000d910: 6f67 6020 6167 6772 6567 6174 652c 2075  og` aggregate, u
+0000d920: 7369 6e67 0a74 6865 2073 6e61 7073 686f  sing.the snapsho
+0000d930: 7420 626f 7468 2064 7572 696e 6720 7468  t both during th
+0000d940: 6520 6361 6c6c 2074 6f20 6072 6563 6f72  e call to `recor
+0000d950: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+0000d960: 2960 2061 6e64 0a77 6865 6e20 6361 6c6c  )` and.when call
+0000d970: 696e 6720 6067 6574 5f64 6f67 2829 6020  ing `get_dog()` 
+0000d980: 6469 7265 6374 6c79 2e0a 0a60 6060 7079  directly...```py
+0000d990: 7468 6f6e 0a72 6563 6f72 645f 7472 6963  thon.record_tric
+0000d9a0: 6b5f 6c65 6172 6e65 6428 646f 675f 6964  k_learned(dog_id
+0000d9b0: 2c20 7472 6963 6b3d 2773 6974 2729 0a0a  , trick='sit')..
+0000d9c0: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000d9d0: 675f 6964 290a 6173 7365 7274 2064 6f67  g_id).assert dog
+0000d9e0: 2e6e 616d 6520 3d3d 2027 4669 646f 270a  .name == 'Fido'.
+0000d9f0: 6173 7365 7274 2064 6f67 2e74 7269 636b  assert dog.trick
+0000da00: 7320 3d3d 205b 2772 6f6c 6c20 6f76 6572  s == ['roll over
+0000da10: 272c 2027 6665 7463 6820 6261 6c6c 272c  ', 'fetch ball',
+0000da20: 2027 7369 7427 5d0a 6173 7365 7274 2064   'sit'].assert d
+0000da30: 6f67 2e76 6572 7369 6f6e 203d 3d20 330a  og.version == 3.
+0000da40: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
+0000da50: 6f6d 5f73 6e61 7073 686f 7420 6973 2054  om_snapshot is T
+0000da60: 7275 650a 6060 600a 0a57 6520 6361 6e20  rue.```..We can 
+0000da70: 7365 6520 6672 6f6d 2074 6865 2060 6973  see from the `is
+0000da80: 5f66 726f 6d5f 736e 6170 7368 6f74 6020  _from_snapshot` 
+0000da90: 6174 7472 6962 7574 6520 7468 6174 2074  attribute that t
+0000daa0: 6865 2060 446f 6760 206f 626a 6563 7420  he `Dog` object 
+0000dab0: 7761 7320 696e 6465 6564 0a72 6563 6f6e  was indeed.recon
+0000dac0: 7374 7275 6374 6564 2066 726f 6d20 7468  structed from th
+0000dad0: 6520 736e 6170 7368 6f74 2e0a 0a53 6e61  e snapshot...Sna
+0000dae0: 7073 686f 7473 2063 616e 2062 6520 6372  pshots can be cr
+0000daf0: 6561 7465 6420 6174 2066 6978 6564 2076  eated at fixed v
+0000db00: 6572 7369 6f6e 206e 756d 6265 7220 696e  ersion number in
+0000db10: 7465 7276 616c 732c 2066 6978 6564 2074  tervals, fixed t
+0000db20: 696d 650a 7065 7269 6f64 732c 2061 6674  ime.periods, aft
+0000db30: 6572 2061 2070 6172 7469 6375 6c61 7220  er a particular 
+0000db40: 7479 7065 206f 6620 6576 656e 742c 2069  type of event, i
+0000db50: 6d6d 6564 6961 7465 6c79 2061 6674 6572  mmediately after
+0000db60: 2065 7665 6e74 7320 6172 650a 6170 7065   events are.appe
+0000db70: 6e64 6564 2c20 6f72 2061 7320 6120 6261  nded, or as a ba
+0000db80: 636b 6772 6f75 6e64 2070 726f 6365 7373  ckground process
+0000db90: 2e0a 0a0a 2323 2320 5265 6164 2061 6c6c  ....### Read all
+0000dba0: 2065 7665 6e74 730a 0a54 6865 2060 7265   events..The `re
+0000dbb0: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+0000dbc0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+0000dbd0: 7365 6420 746f 2067 6574 2061 6c6c 2072  sed to get all r
+0000dbe0: 6563 6f72 6465 6420 6576 656e 7473 0a69  ecorded events.i
+0000dbf0: 6e20 7468 6520 6461 7461 6261 7365 2069  n the database i
+0000dc00: 6e20 7468 6520 6f72 6465 7220 7468 6579  n the order they
+0000dc10: 2077 6572 6520 7265 636f 7264 6564 2e20   were recorded. 
+0000dc20: 5468 6973 206d 6574 686f 6420 7769 6c6c  This method will
+0000dc30: 2072 6574 7572 6e0a 6120 2272 6561 6420   return.a "read 
+0000dc40: 7265 7370 6f6e 7365 2220 6f62 6a65 6374  response" object
+0000dc50: 2c20 6a75 7374 206c 696b 6520 6069 7465  , just like `ite
+0000dc60: 725f 7374 7265 616d 5f65 7665 6e74 7328  r_stream_events(
+0000dc70: 2960 2e0a 0a41 2022 7265 6164 2072 6573  )`...A "read res
+0000dc80: 706f 6e73 6522 2069 7320 616e 2069 7465  ponse" is an ite
+0000dc90: 7261 746f 722c 2061 6e64 206e 6f74 2061  rator, and not a
+0000dca0: 2073 6571 7565 6e63 652e 2052 6563 6f72   sequence. Recor
+0000dcb0: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
+0000dcc0: 650a 6f62 7461 696e 6564 2062 7920 6974  e.obtained by it
+0000dcd0: 6572 6174 696e 6720 6f76 6572 2074 6865  erating over the
+0000dce0: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+0000dcf0: 206f 626a 6563 742e 2049 7420 7374 7265   object. It stre
+0000dd00: 616d 7320 7265 636f 7264 6564 0a65 7665  ams recorded.eve
+0000dd10: 6e74 7320 6672 6f6d 2074 6865 2073 6572  nts from the ser
+0000dd20: 7665 7220 6173 2074 6865 2069 7465 7261  ver as the itera
+0000dd30: 7469 6f6e 2070 726f 6365 6564 732e 2054  tion proceeds. T
+0000dd40: 6865 2069 7465 7261 7469 6f6e 2077 696c  he iteration wil
+0000dd50: 6c20 6175 746f 6d61 7469 6361 6c6c 790a  l automatically.
+0000dd60: 7374 6f70 2077 6865 6e20 7468 6572 6520  stop when there 
+0000dd70: 6172 6520 6e6f 206d 6f72 6520 7265 636f  are no more reco
+0000dd80: 7264 6564 2065 7665 6e74 7320 746f 2062  rded events to b
+0000dd90: 6520 7265 7475 726e 6564 2e20 5468 6520  e returned. The 
+0000dda0: 7374 7265 616d 696e 6720 6f66 2065 7665  streaming of eve
+0000ddb0: 6e74 732c 0a61 6e64 2068 656e 6365 2074  nts,.and hence t
+0000ddc0: 6865 2069 7465 7261 746f 722c 2063 616e  he iterator, can
+0000ddd0: 2061 6c73 6f20 6265 2073 746f 7070 6564   also be stopped
+0000dde0: 2062 7920 6361 6c6c 696e 6720 7468 6520   by calling the 
+0000ddf0: 6073 746f 7028 2960 206d 6574 686f 6420  `stop()` method 
+0000de00: 6f6e 2074 6865 0a22 7265 6164 2072 6573  on the."read res
+0000de10: 706f 6e73 6522 206f 626a 6563 742e 0a0a  ponse" object...
+0000de20: 4a75 7374 206c 696b 6520 6072 6561 645f  Just like `read_
+0000de30: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+0000de40: 2061 6e64 2060 6974 6572 5f73 7472 6561   and `iter_strea
+0000de50: 6d5f 6576 656e 7473 2829 602c 2074 6865  m_events()`, the
+0000de60: 2072 6563 6569 7665 6420 6576 656e 7420   received event 
+0000de70: 6f62 6a65 6374 730a 6172 6520 696e 7374  objects.are inst
+0000de80: 616e 6365 7320 6f66 2074 6865 2060 5265  ances of the `Re
+0000de90: 636f 7264 6564 4576 656e 7460 2063 6c61  cordedEvent` cla
+0000dea0: 7373 2e0a 0a54 6869 7320 6d65 7468 6f64  ss...This method
+0000deb0: 2068 6173 2073 6576 656e 206f 7074 696f   has seven optio
+0000dec0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+0000ded0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+0000dee0: 2c20 6062 6163 6b77 6172 6473 602c 0a60  , `backwards`,.`
+0000def0: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+0000df00: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+0000df10: 602c 2060 6669 6c74 6572 5f62 795f 7374  `, `filter_by_st
+0000df20: 7265 616d 5f6e 616d 6560 2c20 606c 696d  ream_name`, `lim
+0000df30: 6974 602c 2061 6e64 2060 7469 6d65 6f75  it`, and `timeou
+0000df40: 7460 2e0a 0a54 6865 206f 7074 696f 6e61  t`...The optiona
+0000df50: 6c20 6063 6f6d 6d69 745f 706f 7369 7469  l `commit_positi
+0000df60: 6f6e 6020 6172 6775 6d65 6e74 2069 7320  on` argument is 
+0000df70: 6120 5079 7468 6f6e 2060 696e 7460 2074  a Python `int` t
+0000df80: 6861 7420 6361 6e20 6265 2075 7365 6420  hat can be used 
+0000df90: 746f 0a73 7065 6369 6679 2061 2063 6f6d  to.specify a com
+0000dfa0: 6d69 7420 706f 7369 7469 6f6e 2066 726f  mit position fro
+0000dfb0: 6d20 7768 6963 6820 746f 2073 7461 7274  m which to start
+0000dfc0: 2072 6561 6469 6e67 2e20 5468 6520 6465   reading. The de
+0000dfd0: 6661 756c 7420 7661 6c75 6520 6f66 0a60  fault value of.`
+0000dfe0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+0000dff0: 2069 7320 604e 6f6e 6560 2e20 506c 6561   is `None`. Plea
+0000e000: 7365 206e 6f74 652c 2069 6620 6120 636f  se note, if a co
+0000e010: 6d6d 6974 2070 6f73 6974 696f 6e20 6973  mmit position is
+0000e020: 2073 7065 6369 6669 6564 2c0a 6974 206d   specified,.it m
+0000e030: 7573 7420 6265 2061 6e20 6163 7475 616c  ust be an actual
+0000e040: 6c79 2065 7869 7374 696e 6720 636f 6d6d  ly existing comm
+0000e050: 6974 2070 6f73 6974 696f 6e20 696e 2074  it position in t
+0000e060: 6865 2064 6174 6162 6173 652e 0a0a 5468  he database...Th
+0000e070: 6520 6f70 7469 6f6e 616c 2060 6261 636b  e optional `back
+0000e080: 7761 7264 7360 2061 7267 756d 656e 7420  wards` argument 
+0000e090: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
+0000e0a0: 6c60 2e20 5468 6520 6465 6661 756c 7420  l`. The default 
+0000e0b0: 6f66 2060 6261 636b 7761 7264 7360 2069  of `backwards` i
+0000e0c0: 730a 6046 616c 7365 602c 2077 6869 6368  s.`False`, which
+0000e0d0: 206d 6561 6e73 2065 7665 6e74 7320 6172   means events ar
+0000e0e0: 6520 7265 7475 726e 6564 2069 6e20 7468  e returned in th
+0000e0f0: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
+0000e100: 6520 7265 636f 7264 6564 2c20 4966 0a60  e recorded, If.`
+0000e110: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
+0000e120: 7275 6560 2c20 7468 656e 2065 7665 6e74  rue`, then event
+0000e130: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
+0000e140: 6e20 7265 7665 7273 6520 6f72 6465 722e  n reverse order.
+0000e150: 0a0a 4966 2060 6261 636b 7761 7264 7360  ..If `backwards`
+0000e160: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
+0000e170: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+0000e180: 6020 6973 2060 4e6f 6e65 602c 2074 6865  ` is `None`, the
+0000e190: 2064 6174 6162 6173 6527 7320 6576 656e   database's even
+0000e1a0: 7473 2077 696c 6c0a 6265 2072 6574 7572  ts will.be retur
+0000e1b0: 6e65 6420 696e 2074 6865 206f 7264 6572  ned in the order
+0000e1c0: 2074 6865 7920 7765 7265 2072 6563 6f72   they were recor
+0000e1d0: 6465 642c 2073 7461 7274 696e 6720 6672  ded, starting fr
+0000e1e0: 6f6d 2074 6865 2066 6972 7374 2072 6563  om the first rec
+0000e1f0: 6f72 6465 6420 6576 656e 742e 0a54 6869  orded event..Thi
+0000e200: 7320 6973 2074 6865 2064 6566 6175 6c74  s is the default
+0000e210: 2062 6568 6176 696f 7220 6f66 2060 7265   behavior of `re
+0000e220: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+0000e230: 2e20 4966 2060 6261 636b 7761 7264 7360  . If `backwards`
+0000e240: 2069 7320 6054 7275 6560 2061 6e64 0a60   is `True` and.`
+0000e250: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+0000e260: 2069 7320 604e 6f6e 6560 2c20 7468 6520   is `None`, the 
+0000e270: 6461 7461 6261 7365 2773 2065 7665 6e74  database's event
+0000e280: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
+0000e290: 6564 2069 6e20 7265 7665 7273 6520 6f72  ed in reverse or
+0000e2a0: 6465 722c 0a73 7461 7274 696e 6720 6672  der,.starting fr
+0000e2b0: 6f6d 2074 6865 206c 6173 7420 7265 636f  om the last reco
+0000e2c0: 7264 6564 2065 7665 6e74 2e0a 0a54 6865  rded event...The
+0000e2d0: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
+0000e2e0: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+0000e2f0: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
+0000e300: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
+0000e310: 7265 7373 696f 6e73 2074 6861 740a 7370  ressions that.sp
+0000e320: 6563 6966 6965 7320 7768 6963 6820 7265  ecifies which re
+0000e330: 636f 7264 6564 2065 7665 6e74 7320 7368  corded events sh
+0000e340: 6f75 6c64 2062 6520 7265 7475 726e 6564  ould be returned
+0000e350: 2e20 5468 6973 2061 7267 756d 656e 7420  . This argument 
+0000e360: 6973 2069 676e 6f72 6564 0a69 6620 6066  is ignored.if `f
+0000e370: 696c 7465 725f 696e 636c 7564 6560 2069  ilter_include` i
+0000e380: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
+0000e390: 6d70 7479 2073 6571 7565 6e63 652e 2054  mpty sequence. T
+0000e3a0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0000e3b0: 206f 6620 7468 6973 0a61 7267 756d 656e   of this.argumen
+0000e3c0: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
+0000e3d0: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
+0000e3e0: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
+0000e3f0: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
+0000e400: 6174 2073 7973 7465 6d0a 6576 656e 7473  at system.events
+0000e410: 2077 696c 6c20 6e6f 7420 6e6f 726d 616c   will not normal
+0000e420: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
+0000e430: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
+0000e440: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
+0000e450: 6d6f 7265 0a69 6e66 6f72 6d61 7469 6f6e  more.information
+0000e460: 2061 626f 7574 2066 696c 7465 7220 6578   about filter ex
+0000e470: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
+0000e480: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+0000e490: 5f69 6e63 6c75 6465 6020 6172 6775 6d65  _include` argume
+0000e4a0: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+0000e4b0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+0000e4c0: 6573 7369 6f6e 730a 7468 6174 2073 7065  essions.that spe
+0000e4d0: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
+0000e4e0: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
+0000e4f0: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
+0000e500: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
+0000e510: 730a 6172 6775 6d65 6e74 2069 7320 616e  s.argument is an
+0000e520: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
+0000e530: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+0000e540: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
+0000e550: 6d70 7479 2073 6571 7565 6e63 652c 0a74  mpty sequence,.t
+0000e560: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
+0000e570: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
+0000e580: 6967 6e6f 7265 642e 0a0a 5468 6520 6f70  ignored...The op
+0000e590: 7469 6f6e 616c 2060 6669 6c74 6572 5f62  tional `filter_b
+0000e5a0: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
+0000e5b0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0000e5c0: 686f 6e20 6062 6f6f 6c60 2074 6861 7420  hon `bool` that 
+0000e5d0: 696e 6469 6361 7465 730a 7768 6574 6865  indicates.whethe
+0000e5e0: 7220 7468 6520 6669 6c74 6572 696e 6720  r the filtering 
+0000e5f0: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
+0000e600: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
+0000e610: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
+0000e620: 6661 756c 742c 2074 6869 730a 7661 6c75  fault, this.valu
+0000e630: 6520 6973 2060 4661 6c73 6560 2061 6e64  e is `False` and
+0000e640: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
+0000e650: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
+0000e660: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
+0000e670: 7472 696e 6773 206f 660a 7265 636f 7264  trings of.record
+0000e680: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
+0000e690: 6f70 7469 6f6e 616c 2060 6c69 6d69 7460  optional `limit`
+0000e6a0: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
+0000e6b0: 696e 7465 6765 7220 7768 6963 6820 7265  integer which re
+0000e6c0: 7374 7269 6374 7320 7468 6520 6e75 6d62  stricts the numb
+0000e6d0: 6572 206f 6620 6576 656e 7473 2074 6861  er of events tha
+0000e6e0: 740a 7769 6c6c 2062 6520 7265 7475 726e  t.will be return
+0000e6f0: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
+0000e700: 7661 6c75 6520 6973 2060 7379 732e 6d61  value is `sys.ma
+0000e710: 7869 6e74 602e 0a0a 5468 6520 6f70 7469  xint`...The opti
+0000e720: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0000e730: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0000e740: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+0000e750: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
+0000e760: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+0000e770: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+0000e780: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+0000e790: 2066 696c 7465 7269 6e67 206f 6620 6576   filtering of ev
+0000e7a0: 656e 7473 2069 7320 646f 6e65 206f 6e20  ents is done on 
+0000e7b0: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
+0000e7c0: 2073 6572 7665 722e 2054 6865 0a60 6c69   server. The.`li
+0000e7d0: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
+0000e7e0: 2061 7070 6c69 6564 206f 6e20 7468 6520   applied on the 
+0000e7f0: 7365 7276 6572 2061 6674 6572 2066 696c  server after fil
+0000e800: 7465 7269 6e67 2e0a 0a54 6865 2065 7861  tering...The exa
+0000e810: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000e820: 2068 6f77 2074 6f20 6765 7420 616c 6c20   how to get all 
+0000e830: 7468 6520 6576 656e 7473 2077 6520 6861  the events we ha
+0000e840: 7665 2072 6563 6f72 6465 6420 696e 2074  ve recorded in t
+0000e850: 6865 2064 6174 6162 6173 650a 736f 2066  he database.so f
+0000e860: 6172 2c20 696e 2074 6865 206f 7264 6572  ar, in the order
+0000e870: 2074 6865 7920 7765 7265 2072 6563 6f72   they were recor
+0000e880: 6465 642e 2057 6520 6361 6e20 7365 6520  ded. We can see 
+0000e890: 7468 6520 7468 7265 6520 6576 656e 7473  the three events
+0000e8a0: 206f 6620 6073 7472 6561 6d5f 6e61 6d65   of `stream_name
+0000e8b0: 3160 0a28 6065 7665 6e74 3160 2c20 6065  1`.(`event1`, `e
+0000e8c0: 7665 6e74 3260 2061 6e64 2060 6576 656e  vent2` and `even
+0000e8d0: 7433 6029 2061 7265 2069 6e63 6c75 6465  t3`) are include
+0000e8e0: 642c 2061 6c6f 6e67 2077 6974 6820 6f74  d, along with ot
+0000e8f0: 6865 7273 2e0a 0a60 6060 7079 7468 6f6e  hers...```python
+0000e900: 0a23 2052 6561 6420 616c 6c20 6576 656e  .# Read all even
+0000e910: 7473 2028 6372 6561 7465 7320 6120 7374  ts (creates a st
+0000e920: 7265 616d 696e 6720 6752 5043 2063 616c  reaming gRPC cal
+0000e930: 6c29 2e0a 7265 6164 5f72 6573 706f 6e73  l)..read_respons
+0000e940: 6520 3d20 636c 6965 6e74 2e72 6561 645f  e = client.read_
+0000e950: 616c 6c5f 6576 656e 7473 2829 0a0a 2320  all_events()..# 
+0000e960: 436f 6e76 6572 7420 7468 6520 6974 6572  Convert the iter
+0000e970: 6174 6f72 2069 6e74 6f20 6120 7365 7175  ator into a sequ
+0000e980: 656e 6365 206f 6620 7265 636f 7264 6564  ence of recorded
+0000e990: 2065 7665 6e74 732e 0a65 7665 6e74 7320   events..events 
+0000e9a0: 3d20 7475 706c 6528 7265 6164 5f72 6573  = tuple(read_res
+0000e9b0: 706f 6e73 6529 0a61 7373 6572 7420 6c65  ponse).assert le
+0000e9c0: 6e28 6576 656e 7473 2920 3e20 3320 2023  n(events) > 3  #
+0000e9d0: 206d 6f72 6520 7468 616e 2074 6872 6565   more than three
+0000e9e0: 0a0a 2320 436f 6e76 6572 7420 7468 6520  ..# Convert the 
+0000e9f0: 7365 7175 656e 6365 206f 6620 7265 636f  sequence of reco
+0000ea00: 7264 6564 2065 7665 6e74 7320 696e 746f  rded events into
+0000ea10: 2061 2073 6574 206f 6620 6576 656e 7420   a set of event 
+0000ea20: 4944 732e 0a65 7665 6e74 5f69 6473 203d  IDs..event_ids =
+0000ea30: 2073 6574 2865 2e69 6420 666f 7220 6520   set(e.id for e 
+0000ea40: 696e 2065 7665 6e74 7329 0a61 7373 6572  in events).asser
+0000ea50: 7420 6576 656e 7431 2e69 6420 696e 2065  t event1.id in e
+0000ea60: 7665 6e74 5f69 6473 0a61 7373 6572 7420  vent_ids.assert 
+0000ea70: 6576 656e 7432 2e69 6420 696e 2065 7665  event2.id in eve
+0000ea80: 6e74 5f69 6473 0a61 7373 6572 7420 6576  nt_ids.assert ev
+0000ea90: 656e 7433 2e69 6420 696e 2065 7665 6e74  ent3.id in event
+0000eaa0: 5f69 6473 0a60 6060 0a0a 5468 6520 6578  _ids.```..The ex
+0000eab0: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+0000eac0: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
+0000ead0: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
+0000eae0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+0000eaf0: 6520 6672 6f6d 0a61 2070 6172 7469 6375  e from.a particu
+0000eb00: 6c61 7220 636f 6d6d 6974 2070 6f73 6974  lar commit posit
+0000eb10: 696f 6e2c 2069 6e20 7468 6973 2063 6173  ion, in this cas
+0000eb20: 6520 6063 6f6d 6d69 745f 706f 7369 7469  e `commit_positi
+0000eb30: 6f6e 3160 2e20 5768 656e 2072 6561 6469  on1`. When readi
+0000eb40: 6e67 0a66 6f72 7761 7264 7320 6672 6f6d  ng.forwards from
+0000eb50: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
+0000eb60: 6974 2070 6f73 6974 696f 6e2c 2074 6865  it position, the
+0000eb70: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
+0000eb80: 6563 6966 6965 6420 706f 7369 7469 6f6e  ecified position
+0000eb90: 0a77 696c 6c20 6265 2069 6e63 6c75 6465  .will be include
+0000eba0: 642e 2054 6865 2076 616c 7565 206f 6620  d. The value of 
+0000ebb0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+0000ebc0: 3160 2069 7320 7468 6520 706f 7369 7469  1` is the positi
+0000ebd0: 6f6e 2077 6520 6f62 7461 696e 6564 0a77  on we obtained.w
+0000ebe0: 6865 6e20 6170 7065 6e64 696e 6720 6065  hen appending `e
+0000ebf0: 7665 6e74 3160 2e20 416e 6420 736f 2060  vent1`. And so `
+0000ec00: 6576 656e 7431 6020 6973 2074 6865 2066  event1` is the f
+0000ec10: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+0000ec20: 656e 7420 7765 2073 6861 6c6c 0a72 6563  ent we shall.rec
+0000ec30: 6569 7665 2c20 6065 7665 6e74 3260 2069  eive, `event2` i
+0000ec40: 7320 7468 6520 7365 636f 6e64 2c20 616e  s the second, an
+0000ec50: 6420 6065 7665 6e74 3360 2069 7320 7468  d `event3` is th
+0000ec60: 6520 7468 6972 642e 0a0a 6060 6070 7974  e third...```pyt
+0000ec70: 686f 6e0a 2320 5265 6164 2061 6c6c 2065  hon.# Read all e
+0000ec80: 7665 6e74 7320 666f 7277 6172 6473 2066  vents forwards f
+0000ec90: 726f 6d20 6120 636f 6d6d 6974 2070 6f73  rom a commit pos
+0000eca0: 6974 696f 6e2e 0a72 6561 645f 7265 7370  ition..read_resp
+0000ecb0: 6f6e 7365 203d 2063 6c69 656e 742e 7265  onse = client.re
+0000ecc0: 6164 5f61 6c6c 5f65 7665 6e74 7328 0a20  ad_all_events(. 
+0000ecd0: 2020 2063 6f6d 6d69 745f 706f 7369 7469     commit_positi
+0000ece0: 6f6e 3d63 6f6d 6d69 745f 706f 7369 7469  on=commit_positi
+0000ecf0: 6f6e 310a 290a 0a23 2053 7465 7020 7468  on1.)..# Step th
+0000ed00: 726f 7567 6820 7468 6520 2272 6561 6420  rough the "read 
+0000ed10: 7265 7370 6f6e 7365 2220 6974 6572 6174  response" iterat
+0000ed20: 6f72 2e0a 6173 7365 7274 206e 6578 7428  or..assert next(
+0000ed30: 7265 6164 5f72 6573 706f 6e73 6529 2e69  read_response).i
+0000ed40: 6420 3d3d 2065 7665 6e74 312e 6964 0a61  d == event1.id.a
+0000ed50: 7373 6572 7420 6e65 7874 2872 6561 645f  ssert next(read_
+0000ed60: 7265 7370 6f6e 7365 292e 6964 203d 3d20  response).id == 
+0000ed70: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
+0000ed80: 206e 6578 7428 7265 6164 5f72 6573 706f   next(read_respo
+0000ed90: 6e73 6529 2e69 6420 3d3d 2065 7665 6e74  nse).id == event
+0000eda0: 332e 6964 0a0a 2320 5374 6f70 2074 6865  3.id..# Stop the
+0000edb0: 2069 7465 7261 746f 722e 0a72 6561 645f   iterator..read_
+0000edc0: 7265 7370 6f6e 7365 2e73 746f 7028 290a  response.stop().
+0000edd0: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+0000ede0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
+0000edf0: 2074 6f20 7265 6164 2061 6c6c 2065 7665   to read all eve
+0000ee00: 6e74 7320 7265 636f 7264 6564 2069 6e20  nts recorded in 
+0000ee10: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
+0000ee20: 7265 7665 7273 650a 6f72 6465 722e 2057  reverse.order. W
+0000ee30: 6520 6361 6e20 7365 6520 7468 6174 2074  e can see that t
+0000ee40: 6865 2066 6972 7374 2065 7665 6e74 7320  he first events 
+0000ee50: 7765 2072 6563 6569 7665 2061 7265 2074  we receive are t
+0000ee60: 6865 206c 6173 7420 6576 656e 7473 2074  he last events t
+0000ee70: 6861 7420 7765 7265 0a72 6563 6f72 6465  hat were.recorde
+0000ee80: 643a 2074 6865 2065 7665 6e74 7320 6f66  d: the events of
+0000ee90: 2074 6865 2060 446f 6760 2061 6767 7265   the `Dog` aggre
+0000eea0: 6761 7465 2066 726f 6d20 7468 6520 7365  gate from the se
+0000eeb0: 6374 696f 6e20 6162 6f75 7420 736e 6170  ction about snap
+0000eec0: 7368 6f74 7469 6e67 0a61 6e64 2074 6865  shotting.and the
+0000eed0: 2073 6e61 7073 686f 742e 0a0a 6060 6070   snapshot...```p
+0000eee0: 7974 686f 6e0a 2320 5265 6164 2061 6c6c  ython.# Read all
+0000eef0: 2065 7665 6e74 7320 6261 636b 7761 7264   events backward
+0000ef00: 7320 6672 6f6d 2074 6865 2065 6e64 2e0a  s from the end..
+0000ef10: 7265 6164 5f72 6573 706f 6e73 6520 3d20  read_response = 
+0000ef20: 636c 6965 6e74 2e72 6561 645f 616c 6c5f  client.read_all_
+0000ef30: 6576 656e 7473 280a 2020 2020 6261 636b  events(.    back
+0000ef40: 7761 7264 733d 5472 7565 0a29 0a0a 2320  wards=True.)..# 
+0000ef50: 5374 6570 2074 6872 6f75 6768 2074 6865  Step through the
+0000ef60: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+0000ef70: 2069 7465 7261 746f 722e 0a61 7373 6572   iterator..asser
+0000ef80: 7420 6e65 7874 2872 6561 645f 7265 7370  t next(read_resp
+0000ef90: 6f6e 7365 292e 7479 7065 203d 3d20 2244  onse).type == "D
+0000efa0: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
+0000efb0: 6173 7365 7274 206e 6578 7428 7265 6164  assert next(read
+0000efc0: 5f72 6573 706f 6e73 6529 2e74 7970 6520  _response).type 
+0000efd0: 3d3d 2022 536e 6170 7368 6f74 220a 6173  == "Snapshot".as
+0000efe0: 7365 7274 206e 6578 7428 7265 6164 5f72  sert next(read_r
+0000eff0: 6573 706f 6e73 6529 2e74 7970 6520 3d3d  esponse).type ==
+0000f000: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+0000f010: 6b22 0a61 7373 6572 7420 6e65 7874 2872  k".assert next(r
+0000f020: 6561 645f 7265 7370 6f6e 7365 292e 7479  ead_response).ty
+0000f030: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+0000f040: 6454 7269 636b 220a 6173 7365 7274 206e  dTrick".assert n
+0000f050: 6578 7428 7265 6164 5f72 6573 706f 6e73  ext(read_respons
+0000f060: 6529 2e74 7970 6520 3d3d 2022 446f 6752  e).type == "DogR
+0000f070: 6567 6973 7465 7265 6422 0a0a 2320 5374  egistered"..# St
+0000f080: 6f70 2074 6865 2069 7465 7261 746f 722e  op the iterator.
+0000f090: 0a72 6561 645f 7265 7370 6f6e 7365 2e73  .read_response.s
+0000f0a0: 746f 7028 290a 6060 600a 0a54 6865 2065  top().```..The e
+0000f0b0: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+0000f0c0: 7773 2068 6f77 2074 6f20 7265 6164 2061  ws how to read a
+0000f0d0: 206c 696d 6974 6564 206e 756d 6265 7220   limited number 
+0000f0e0: 6f66 2065 7665 6e74 730a 666f 7277 6172  of events.forwar
+0000f0f0: 6473 2066 726f 6d20 6120 7370 6563 6966  ds from a specif
+0000f100: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
+0000f110: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
+0000f120: 7665 6e74 7320 3d20 7475 706c 6528 0a20  vents = tuple(. 
+0000f130: 2020 2063 6c69 656e 742e 7265 6164 5f61     client.read_a
+0000f140: 6c6c 5f65 7665 6e74 7328 0a20 2020 2020  ll_events(.     
+0000f150: 2020 2063 6f6d 6d69 745f 706f 7369 7469     commit_positi
+0000f160: 6f6e 3d63 6f6d 6d69 745f 706f 7369 7469  on=commit_positi
+0000f170: 6f6e 312c 0a20 2020 2020 2020 206c 696d  on1,.        lim
+0000f180: 6974 3d31 2c0a 2020 2020 290a 290a 0a61  it=1,.    ).)..a
+0000f190: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+0000f1a0: 2920 3d3d 2031 0a61 7373 6572 7420 6576  ) == 1.assert ev
+0000f1b0: 656e 7473 5b30 5d2e 6964 203d 3d20 6576  ents[0].id == ev
+0000f1c0: 656e 7431 2e69 640a 6060 600a 0a54 6865  ent1.id.```..The
+0000f1d0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+0000f1e0: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+0000f1f0: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
+0000f200: 7220 6f66 2074 6865 2072 6563 6f72 6465  r of the recorde
+0000f210: 6420 6576 656e 7473 0a69 6e20 7468 6520  d events.in the 
+0000f220: 6461 7461 6261 7365 2062 6163 6b77 6172  database backwar
+0000f230: 6473 2066 726f 6d20 7468 6520 656e 642e  ds from the end.
+0000f240: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+0000f250: 6865 206c 696d 6974 2069 7320 312c 2061  he limit is 1, a
+0000f260: 6e64 0a73 6f20 7765 2072 6563 6569 7665  nd.so we receive
+0000f270: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
+0000f280: 6564 2065 7665 6e74 2e0a 0a60 6060 7079  ed event...```py
+0000f290: 7468 6f6e 0a65 7665 6e74 7320 3d20 7475  thon.events = tu
+0000f2a0: 706c 6528 0a20 2020 2063 6c69 656e 742e  ple(.    client.
+0000f2b0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+0000f2c0: 0a20 2020 2020 2020 2062 6163 6b77 6172  .        backwar
+0000f2d0: 6473 3d54 7275 652c 0a20 2020 2020 2020  ds=True,.       
+0000f2e0: 206c 696d 6974 3d31 2c0a 2020 2020 290a   limit=1,.    ).
+0000f2f0: 290a 0a61 7373 6572 7420 6c65 6e28 6576  )..assert len(ev
+0000f300: 656e 7473 2920 3d3d 2031 0a0a 6173 7365  ents) == 1..asse
+0000f310: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
+0000f320: 6520 3d3d 2027 446f 674c 6561 726e 6564  e == 'DogLearned
+0000f330: 5472 6963 6b27 0a61 7373 6572 7420 6465  Trick'.assert de
+0000f340: 7365 7269 616c 697a 6528 6576 656e 7473  serialize(events
+0000f350: 5b30 5d2e 6461 7461 295b 2774 7269 636b  [0].data)['trick
+0000f360: 275d 203d 3d20 2773 6974 270a 6060 600a  '] == 'sit'.```.
+0000f370: 0a50 6c65 6173 6520 6e6f 7465 2c20 6c69  .Please note, li
+0000f380: 6b65 2074 6865 2060 6974 6572 5f73 7472  ke the `iter_str
+0000f390: 6561 6d5f 6576 656e 7473 2829 6020 6d65  eam_events()` me
+0000f3a0: 7468 6f64 2c20 7468 6520 6072 6561 645f  thod, the `read_
+0000f3b0: 616c 6c5f 6576 656e 7473 2829 6020 6d65  all_events()` me
+0000f3c0: 7468 6f64 0a69 7320 6e6f 7420 6465 636f  thod.is not deco
+0000f3d0: 7261 7465 6420 7769 7468 2072 6574 7279  rated with retry
+0000f3e0: 2061 6e64 2072 6563 6f6e 6e65 6374 2064   and reconnect d
+0000f3f0: 6563 6f72 6174 6f72 732c 2062 6563 6175  ecorators, becau
+0000f400: 7365 2074 6865 2073 7472 6561 6d69 6e67  se the streaming
+0000f410: 206f 6620 7265 636f 7264 6564 0a65 7665   of recorded.eve
+0000f420: 6e74 7320 6672 6f6d 2074 6865 2073 6572  nts from the ser
+0000f430: 7665 7220 6f6e 6c79 2073 7461 7274 7320  ver only starts 
+0000f440: 7768 656e 2069 7465 7261 7469 6e67 206f  when iterating o
+0000f450: 7665 7220 7468 6520 2272 6561 6420 7265  ver the "read re
+0000f460: 7370 6f6e 7365 2220 7374 6172 7473 2c20  sponse" starts, 
+0000f470: 7768 6963 680a 6d65 616e 7320 7468 6174  which.means that
+0000f480: 2074 6865 206d 6574 686f 6420 7265 7475   the method retu
+0000f490: 726e 7320 6265 666f 7265 2074 6865 2073  rns before the s
+0000f4a0: 7472 6561 6d69 6e67 2073 7461 7274 732c  treaming starts,
+0000f4b0: 2061 6e64 2073 6f20 7468 6572 6520 6973   and so there is
+0000f4c0: 206e 6f20 6368 616e 6365 2066 6f72 0a61   no chance for.a
+0000f4d0: 6e79 2064 6563 6f72 6174 6f72 7320 746f  ny decorators to
+0000f4e0: 2063 6174 6368 2061 6e79 2063 6f6e 6e65   catch any conne
+0000f4f0: 6374 696f 6e20 6973 7375 6573 2e0a 0a23  ction issues...#
+0000f500: 2323 2047 6574 2063 6f6d 6d69 7420 706f  ## Get commit po
+0000f510: 7369 7469 6f6e 0a0a 5468 6520 6067 6574  sition..The `get
+0000f520: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
+0000f530: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0000f540: 6520 7573 6564 2074 6f20 6765 7420 7468  e used to get th
+0000f550: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+0000f560: 6e20 6f66 2074 6865 0a6c 6173 7420 7265  n of the.last re
+0000f570: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
+0000f580: 7468 6520 6461 7461 6261 7365 2e20 4974  the database. It
+0000f590: 2073 696d 706c 7920 6361 6c6c 7320 6072   simply calls `r
+0000f5a0: 6561 645f 616c 6c5f 6576 656e 7473 2829  ead_all_events()
+0000f5b0: 6020 7769 7468 0a60 6261 636b 7761 7264  ` with.`backward
+0000f5c0: 733d 5472 7565 6020 616e 6420 606c 696d  s=True` and `lim
+0000f5d0: 6974 3d31 602c 2061 6e64 2072 6574 7572  it=1`, and retur
+0000f5e0: 6e73 2074 6865 2076 616c 7565 206f 6620  ns the value of 
+0000f5f0: 7468 6520 6063 6f6d 6d69 745f 706f 7369  the `commit_posi
+0000f600: 7469 6f6e 600a 6174 7472 6962 7574 6520  tion`.attribute 
+0000f610: 6f66 2074 6865 206c 6173 7420 7265 636f  of the last reco
+0000f620: 7264 6564 2065 7665 6e74 2e0a 0a60 6060  rded event...```
+0000f630: 7079 7468 6f6e 0a63 6f6d 6d69 745f 706f  python.commit_po
+0000f640: 7369 7469 6f6e 203d 2063 6c69 656e 742e  sition = client.
+0000f650: 6765 745f 636f 6d6d 6974 5f70 6f73 6974  get_commit_posit
+0000f660: 696f 6e28 290a 6060 600a 0a54 6869 7320  ion().```..This 
+0000f670: 6d65 7468 6f64 2068 6173 2066 6f75 7220  method has four 
+0000f680: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+0000f690: 7473 2c20 6066 696c 7465 725f 6578 636c  ts, `filter_excl
+0000f6a0: 7564 6560 2c20 6066 696c 7465 725f 696e  ude`, `filter_in
+0000f6b0: 636c 7564 6560 2c0a 6066 696c 7465 725f  clude`,.`filter_
+0000f6c0: 6279 5f73 7472 6561 6d5f 6e61 6d65 6020  by_stream_name` 
+0000f6d0: 616e 6420 6074 696d 656f 7574 602e 2054  and `timeout`. T
+0000f6e0: 6865 7365 2076 616c 7565 7320 6172 6520  hese values are 
+0000f6f0: 7061 7373 6564 2074 6f20 6072 6561 645f  passed to `read_
+0000f700: 616c 6c5f 6576 656e 7473 2829 602e 0a0a  all_events()`...
+0000f710: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
+0000f720: 6c74 6572 5f65 7863 6c75 6465 602c 2060  lter_exclude`, `
+0000f730: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
+0000f740: 616e 6420 6066 696c 7465 725f 6279 5f73  and `filter_by_s
+0000f750: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+0000f760: 6d65 6e74 730a 776f 726b 2069 6e20 7468  ments.work in th
+0000f770: 6520 7361 6d65 2077 6179 2061 7320 7468  e same way as th
+0000f780: 6579 2064 6f20 696e 2074 6865 2060 7265  ey do in the `re
+0000f790: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+0000f7a0: 206d 6574 686f 642e 0a0a 5468 6973 206f   method...This o
+0000f7b0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+0000f7c0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0000f7d0: 5079 7468 6f6e 2060 666c 6f61 7460 2074  Python `float` t
+0000f7e0: 6861 7420 7365 7473 0a61 2064 6561 646c  hat sets.a deadl
+0000f7f0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
+0000f800: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+0000f810: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+0000f820: 6869 7320 6d65 7468 6f64 206d 6967 6874  his method might
+0000f830: 2062 6520 7573 6564 2074 6f20 6d65 6173   be used to meas
+0000f840: 7572 6520 7072 6f67 7265 7373 206f 6620  ure progress of 
+0000f850: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
+0000f860: 706f 6e65 6e74 0a74 6861 7420 6973 2070  ponent.that is p
+0000f870: 726f 6365 7373 696e 6720 616c 6c20 7265  rocessing all re
+0000f880: 636f 7264 6564 2065 7665 6e74 732c 2062  corded events, b
+0000f890: 7920 636f 6d70 6172 696e 6720 7468 6520  y comparing the 
+0000f8a0: 6375 7272 656e 7420 636f 6d6d 6974 0a70  current commit.p
+0000f8b0: 6f73 6974 696f 6e20 7769 7468 2074 6865  osition with the
+0000f8c0: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+0000f8d0: 2070 6f73 6974 696f 6e20 6f66 2074 6865   position of the
+0000f8e0: 206c 6173 7420 7375 6363 6573 7366 756c   last successful
+0000f8f0: 6c79 2070 726f 6365 7373 6564 0a65 7665  ly processed.eve
+0000f900: 6e74 2069 6e20 6120 646f 776e 7374 7265  nt in a downstre
+0000f910: 616d 2063 6f6d 706f 6e65 6e74 2e20 496e  am component. In
+0000f920: 2074 6869 7320 6361 7365 2c20 7468 6520   this case, the 
+0000f930: 7661 6c75 6520 6f66 2074 6865 2060 6669  value of the `fi
+0000f940: 6c74 6572 5f65 7863 6c75 6465 602c 0a60  lter_exclude`,.`
+0000f950: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
+0000f960: 616e 6420 6066 696c 7465 725f 6279 5f73  and `filter_by_s
+0000f970: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+0000f980: 6d65 6e74 7320 7368 6f75 6c64 2065 7175  ments should equ
+0000f990: 616c 2074 686f 7365 2075 7365 640a 6279  al those used.by
+0000f9a0: 2074 6865 2064 6f77 6e73 7472 6561 6d20   the downstream 
+0000f9b0: 636f 6d70 6f6e 656e 7420 746f 206f 6274  component to obt
+0000f9c0: 6169 6e20 7265 636f 7264 6564 2065 7665  ain recorded eve
+0000f9d0: 6e74 732e 0a0a 0a23 2323 2047 6574 2073  nts....### Get s
+0000f9e0: 7472 6561 6d20 6d65 7461 6461 7461 0a0a  tream metadata..
+0000f9f0: 5468 6520 6067 6574 5f73 7472 6561 6d5f  The `get_stream_
+0000fa00: 6d65 7461 6461 7461 2829 6020 6d65 7468  metadata()` meth
+0000fa10: 6f64 2072 6574 7572 6e73 2074 6865 206d  od returns the m
+0000fa20: 6574 6164 6174 6120 666f 7220 6120 7374  etadata for a st
+0000fa30: 7265 616d 2c20 616c 6f6e 670a 7769 7468  ream, along.with
+0000fa40: 2074 6865 2076 6572 7369 6f6e 206f 6620   the version of 
+0000fa50: 7468 6520 7374 7265 616d 206d 6574 6164  the stream metad
+0000fa60: 6174 612e 0a0a 6060 6070 7974 686f 6e0a  ata...```python.
+0000fa70: 6d65 7461 6461 7461 2c20 6d65 7461 6461  metadata, metada
+0000fa80: 7461 5f76 6572 7369 6f6e 203d 2063 6c69  ta_version = cli
+0000fa90: 656e 742e 6765 745f 7374 7265 616d 5f6d  ent.get_stream_m
+0000faa0: 6574 6164 6174 6128 7374 7265 616d 5f6e  etadata(stream_n
+0000fab0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+0000fac0: 290a 6060 600a 0a54 6865 2072 6574 7572  ).```..The retur
+0000fad0: 6e65 6420 606d 6574 6164 6174 6160 2076  ned `metadata` v
+0000fae0: 616c 7565 2069 7320 6120 5079 7468 6f6e  alue is a Python
+0000faf0: 2060 6469 6374 602e 2054 6865 2072 6574   `dict`. The ret
+0000fb00: 7572 6e65 6420 606d 6574 6164 6174 615f  urned `metadata_
+0000fb10: 7665 7273 696f 6e60 0a76 616c 7565 2069  version`.value i
+0000fb20: 7320 6569 7468 6572 2061 6e20 6069 6e74  s either an `int
+0000fb30: 6020 6966 2074 6865 2073 7472 6561 6d20  ` if the stream 
+0000fb40: 6578 6973 7473 2c20 6f72 2060 4e6f 6e65  exists, or `None
+0000fb50: 6020 6966 2074 6865 2073 7472 6561 6d20  ` if the stream 
+0000fb60: 646f 6573 206e 6f74 2065 7869 7374 0a61  does not exist.a
+0000fb70: 6e64 206e 6f20 6d65 7461 6461 7461 2068  nd no metadata h
+0000fb80: 6173 2062 6565 6e20 7365 742e 2054 6865  as been set. The
+0000fb90: 7365 2076 616c 7565 7320 6361 6e20 6265  se values can be
+0000fba0: 2070 6173 7365 6420 696e 746f 2060 7365   passed into `se
+0000fbb0: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
+0000fbc0: 6128 2960 2e0a 0a0a 2323 2320 5365 7420  a()`....### Set 
+0000fbd0: 7374 7265 616d 206d 6574 6164 6174 610a  stream metadata.
+0000fbe0: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
+0000fbf0: 722a 0a0a 5468 6520 6d65 7468 6f64 2060  r*..The method `
+0000fc00: 7365 745f 7374 7265 616d 5f6d 6574 6164  set_stream_metad
+0000fc10: 6174 6128 2960 2073 6574 7320 7468 6520  ata()` sets the 
+0000fc20: 6d65 7461 6461 7461 2066 6f72 2061 2073  metadata for a s
+0000fc30: 7472 6561 6d2e 2053 7472 6561 6d20 6d65  tream. Stream me
+0000fc40: 7461 6461 7461 0a63 616e 2062 6520 7365  tadata.can be se
+0000fc50: 7420 6265 666f 7265 2061 7070 656e 6469  t before appendi
+0000fc60: 6e67 2065 7665 6e74 7320 746f 2061 2073  ng events to a s
+0000fc70: 7472 6561 6d2e 0a0a 6060 6070 7974 686f  tream...```pytho
+0000fc80: 6e0a 6d65 7461 6461 7461 5b22 666f 6f22  n.metadata["foo"
+0000fc90: 5d20 3d20 2262 6172 220a 0a63 6c69 656e  ] = "bar"..clien
+0000fca0: 742e 7365 745f 7374 7265 616d 5f6d 6574  t.set_stream_met
+0000fcb0: 6164 6174 6128 0a20 2020 2073 7472 6561  adata(.    strea
+0000fcc0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0000fcd0: 6d65 312c 0a20 2020 206d 6574 6164 6174  me1,.    metadat
+0000fce0: 613d 6d65 7461 6461 7461 2c0a 2020 2020  a=metadata,.    
+0000fcf0: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
+0000fd00: 6d65 7461 6461 7461 5f76 6572 7369 6f6e  metadata_version
+0000fd10: 2c0a 290a 6060 600a 0a54 6865 2060 6375  ,.).```..The `cu
+0000fd20: 7272 656e 745f 7665 7273 696f 6e60 2061  rrent_version` a
+0000fd30: 7267 756d 656e 7420 7368 6f75 6c64 2062  rgument should b
+0000fd40: 6520 7468 6520 6375 7272 656e 7420 7665  e the current ve
+0000fd50: 7273 696f 6e20 6f66 2074 6865 2073 7472  rsion of the str
+0000fd60: 6561 6d20 6d65 7461 6461 7461 0a6f 6274  eam metadata.obt
+0000fd70: 6169 6e65 6420 6672 6f6d 2060 6765 745f  ained from `get_
+0000fd80: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+0000fd90: 2960 2e0a 0a50 6c65 6173 6520 7265 6665  )`...Please refe
+0000fda0: 7220 746f 2074 6865 2045 7665 6e74 5374  r to the EventSt
+0000fdb0: 6f72 6544 4220 646f 6375 6d65 6e74 6174  oreDB documentat
+0000fdc0: 696f 6e20 666f 7220 6d6f 7265 2069 6e66  ion for more inf
+0000fdd0: 6f72 6d61 7469 6f6e 2061 626f 7574 2073  ormation about s
+0000fde0: 7472 6561 6d0a 6d65 7461 6461 7461 2e0a  tream.metadata..
+0000fdf0: 0a23 2323 2044 656c 6574 6520 7374 7265  .### Delete stre
+0000fe00: 616d 0a0a 2a72 6571 7569 7265 7320 6c65  am..*requires le
+0000fe10: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
+0000fe20: 6420 6064 656c 6574 655f 7374 7265 616d  d `delete_stream
+0000fe30: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
+0000fe40: 746f 2022 6465 6c65 7465 2220 6120 7374  to "delete" a st
+0000fe50: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+0000fe60: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+0000fe70: 203d 2063 6c69 656e 742e 6465 6c65 7465   = client.delete
+0000fe80: 5f73 7472 6561 6d28 7374 7265 616d 5f6e  _stream(stream_n
+0000fe90: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+0000fea0: 2c20 6375 7272 656e 745f 7665 7273 696f  , current_versio
+0000feb0: 6e3d 3229 0a60 6060 0a0a 4166 7465 7220  n=2).```..After 
+0000fec0: 6465 6c65 7469 6e67 2061 2073 7472 6561  deleting a strea
+0000fed0: 6d2c 2069 7427 7320 7374 696c 6c20 706f  m, it's still po
+0000fee0: 7373 6962 6c65 2074 6f20 6170 7065 6e64  ssible to append
+0000fef0: 206e 6577 2065 7665 6e74 732e 2052 6561   new events. Rea
+0000ff00: 6469 6e67 2066 726f 6d20 610a 6465 6c65  ding from a.dele
+0000ff10: 7465 6420 7374 7265 616d 2077 696c 6c20  ted stream will 
+0000ff20: 7265 7475 726e 206f 6e6c 7920 6576 656e  return only even
+0000ff30: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
+0000ff40: 6e20 6170 7065 6e64 6564 2061 6674 6572  n appended after
+0000ff50: 2069 7420 7761 730a 6465 6c65 7465 642e   it was.deleted.
+0000ff60: 0a0a 2323 2320 546f 6d62 7374 6f6e 6520  ..### Tombstone 
+0000ff70: 7374 7265 616d 0a0a 2a72 6571 7569 7265  stream..*require
+0000ff80: 7320 6c65 6164 6572 2a0a 0a54 6865 206d  s leader*..The m
+0000ff90: 6574 686f 6420 6074 6f6d 6273 746f 6e65  ethod `tombstone
+0000ffa0: 5f73 7472 6561 6d28 2960 2063 616e 2062  _stream()` can b
+0000ffb0: 6520 7573 6564 2074 6f20 2274 6f6d 6273  e used to "tombs
+0000ffc0: 746f 6e65 2220 6120 7374 7265 616d 2e0a  tone" a stream..
+0000ffd0: 0a60 6060 7079 7468 6f6e 0a63 6f6d 6d69  .```python.commi
+0000ffe0: 745f 706f 7369 7469 6f6e 203d 2063 6c69  t_position = cli
+0000fff0: 656e 742e 746f 6d62 7374 6f6e 655f 7374  ent.tombstone_st
+00010000: 7265 616d 2873 7472 6561 6d5f 6e61 6d65  ream(stream_name
+00010010: 3d73 7472 6561 6d5f 6e61 6d65 312c 2063  =stream_name1, c
+00010020: 7572 7265 6e74 5f76 6572 7369 6f6e 3d32  urrent_version=2
+00010030: 290a 6060 600a 0a41 6674 6572 2074 6f6d  ).```..After tom
+00010040: 6273 746f 6e69 6e67 2061 2073 7472 6561  bstoning a strea
+00010050: 6d2c 2069 7427 7320 6e6f 7420 706f 7373  m, it's not poss
+00010060: 6962 6c65 2074 6f20 6170 7065 6e64 206e  ible to append n
+00010070: 6577 2065 7665 6e74 732e 0a0a 0a23 2320  ew events....## 
+00010080: 4361 7463 682d 7570 2073 7562 7363 7269  Catch-up subscri
+00010090: 7074 696f 6e73 0a0a 4120 2263 6174 6368  ptions..A "catch
+000100a0: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
+000100b0: 6e20 6361 6e20 6265 2075 7365 6420 746f  n can be used to
+000100c0: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+000100d0: 7468 6174 2068 6176 6520 616c 7265 6164  that have alread
+000100e0: 7920 6265 656e 0a72 6563 6f72 6465 6420  y been.recorded 
+000100f0: 696e 2074 6865 2064 6174 6162 6173 652c  in the database,
+00010100: 2061 6e64 2061 6c73 6f20 6576 656e 7473   and also events
+00010110: 2074 6861 7420 6172 6520 7265 636f 7264   that are record
+00010120: 6564 2073 7562 7365 7175 656e 746c 792e  ed subsequently.
+00010130: 0a0a 5468 6520 6073 7562 7363 7269 6265  ..The `subscribe
+00010140: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
+00010150: 6574 686f 6420 7374 6172 7473 2061 2063  ethod starts a c
+00010160: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00010170: 7469 6f6e 2074 6861 7420 6361 6e20 7265  tion that can re
+00010180: 6365 6976 650a 616c 6c20 6576 656e 7473  ceive.all events
+00010190: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+000101a0: 2e20 5468 6520 6073 7562 7363 7269 6265  . The `subscribe
+000101b0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+000101c0: 6020 6d65 7468 6f64 2073 7461 7274 7320  ` method starts 
+000101d0: 6120 6361 7463 682d 7570 0a73 7562 7363  a catch-up.subsc
+000101e0: 7269 7074 696f 6e20 7468 6174 2063 616e  ription that can
+000101f0: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+00010200: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+00010210: 7374 7265 616d 2e0a 0a54 6865 2060 7375  stream...The `su
+00010220: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+00010230: 7473 2829 6020 616e 6420 6073 7562 7363  ts()` and `subsc
+00010240: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
+00010250: 7473 2829 6020 6d65 7468 6f64 7320 626f  ts()` methods bo
+00010260: 7468 2072 6574 7572 6e20 610a 2272 6561  th return a."rea
+00010270: 6420 7265 7370 6f6e 7365 2220 6974 6572  d response" iter
+00010280: 6174 6f72 2c20 6d75 6368 206c 696b 6520  ator, much like 
+00010290: 6069 7465 725f 7374 7265 616d 5f65 7665  `iter_stream_eve
+000102a0: 6e74 7328 2960 2061 6e64 2060 7265 6164  nts()` and `read
+000102b0: 5f61 6c6c 5f65 7665 6e74 7328 2960 2e0a  _all_events()`..
+000102c0: 5468 6520 6469 6666 6572 656e 6365 2069  The difference i
+000102d0: 7320 7468 6520 2272 6561 6420 7265 7370  s the "read resp
+000102e0: 6f6e 7365 2220 6974 6572 6174 6f72 2072  onse" iterator r
+000102f0: 6574 7572 6e65 6420 666f 7220 6120 6361  eturned for a ca
+00010300: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+00010310: 696f 6e0a 646f 6573 206e 6f74 2061 7574  ion.does not aut
+00010320: 6f6d 6174 6963 616c 6c79 2073 746f 7020  omatically stop 
+00010330: 7768 656e 2074 6865 7265 2061 7265 206e  when there are n
+00010340: 6f20 6d6f 7265 2072 6563 6f72 6465 6420  o more recorded 
+00010350: 6576 656e 7473 2074 6f20 6265 2072 6574  events to be ret
+00010360: 7572 6e65 642c 2062 7574 0a69 6e73 7465  urned, but.inste
+00010370: 6164 2062 6c6f 636b 7320 6f6e 2067 6574  ad blocks on get
+00010380: 7469 6e67 2074 6865 206e 6578 7420 6576  ting the next ev
+00010390: 656e 7420 756e 7469 6c20 6675 7274 6865  ent until furthe
+000103a0: 7220 6576 656e 7473 2061 7265 2072 6563  r events are rec
+000103b0: 6f72 6465 6420 696e 2074 6865 0a64 6174  orded in the.dat
+000103c0: 6162 6173 652e 2054 6865 7365 2073 7562  abase. These sub
+000103d0: 7365 7175 656e 746c 7920 7265 636f 7264  sequently record
+000103e0: 6564 2065 7665 6e74 7320 7769 6c6c 2074  ed events will t
+000103f0: 6865 6e20 6265 2073 7472 6561 6d65 6420  hen be streamed 
+00010400: 746f 2074 6865 2069 7465 7261 746f 722c  to the iterator,
+00010410: 0a77 6869 6368 2077 696c 6c20 7468 656e  .which will then
+00010420: 2063 6f6e 7469 6e75 652e 204c 696b 6520   continue. Like 
+00010430: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00010440: 2829 602c 2074 6865 2072 6574 7572 6e65  ()`, the returne
+00010450: 6420 2272 6561 6420 7265 7370 6f6e 7365  d "read response
+00010460: 2220 6861 730a 6120 6073 746f 7028 2960  " has.a `stop()`
+00010470: 206d 6574 686f 6420 7768 6963 6820 7769   method which wi
+00010480: 6c6c 2063 616e 6365 6c20 7468 6520 7374  ll cancel the st
+00010490: 7265 616d 696e 6720 6752 5043 206f 7065  reaming gRPC ope
+000104a0: 7261 7469 6f6e 2061 6e64 2063 6175 7365  ration and cause
+000104b0: 2074 6865 0a22 7265 6164 2072 6573 706f   the."read respo
+000104c0: 6e73 6522 2069 7465 7261 746f 7220 746f  nse" iterator to
+000104d0: 2073 746f 702e 0a0a 4c69 6b65 2077 6974   stop...Like wit
+000104e0: 6820 6072 6561 645f 7374 7265 616d 5f65  h `read_stream_e
+000104f0: 7665 6e74 7328 2960 2061 6e64 2060 7265  vents()` and `re
+00010500: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+00010510: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
+00010520: 7665 6e74 206f 626a 6563 7473 0a72 6563  vent objects.rec
+00010530: 6569 7665 6420 6672 6f6d 2061 2063 6174  eived from a cat
+00010540: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00010550: 6f6e 2061 7265 2069 6e73 7461 6e63 6573  on are instances
+00010560: 206f 6620 7468 6520 6052 6563 6f72 6465   of the `Recorde
+00010570: 6445 7665 6e74 6020 636c 6173 732e 0a0a  dEvent` class...
+00010580: 2323 2320 5375 6273 6372 6962 6520 616c  ### Subscribe al
+00010590: 6c20 6576 656e 7473 0a0a 5468 6560 7375  l events..The`su
+000105a0: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+000105b0: 7473 2829 6020 6d65 7468 6f64 2063 616e  ts()` method can
+000105c0: 2062 6520 7573 6564 2074 6f20 7374 6172   be used to star
+000105d0: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
+000105e0: 7363 7269 7074 696f 6e0a 6672 6f6d 2077  scription.from w
+000105f0: 6869 6368 2061 6c6c 2065 7665 6e74 7320  hich all events 
+00010600: 7265 636f 7264 6564 2069 6e20 7468 6520  recorded in the 
+00010610: 6461 7461 6261 7365 2063 616e 2062 6520  database can be 
+00010620: 7265 6365 6976 6564 2e0a 0a54 6869 7320  received...This 
+00010630: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00010640: 6564 2062 7920 6120 646f 776e 7374 7265  ed by a downstre
+00010650: 616d 2063 6f6d 706f 6e65 6e74 2074 6861  am component tha
+00010660: 7420 7072 6f63 6573 7365 7320 7265 636f  t processes reco
+00010670: 7264 6564 2065 7665 6e74 7320 7769 7468  rded events with
+00010680: 0a65 7861 6374 6c79 2d6f 6e63 6520 7365  .exactly-once se
+00010690: 6d61 6e74 6963 732e 0a0a 5468 6973 206d  mantics...This m
+000106a0: 6574 686f 6420 7265 7475 726e 7320 6120  ethod returns a 
+000106b0: 2272 6561 6420 7265 7370 6f6e 7365 222c  "read response",
+000106c0: 2066 726f 6d20 7768 6963 6820 7265 636f   from which reco
+000106d0: 7264 6564 2065 7665 6e74 7320 6361 6e20  rded events can 
+000106e0: 6265 0a6f 6274 6169 6e65 6420 6279 2069  be.obtained by i
+000106f0: 7465 7261 7469 6f6e 2c20 696e 636c 7564  teration, includ
+00010700: 696e 6720 6576 656e 7473 2074 6861 7420  ing events that 
+00010710: 6172 6520 7265 636f 7264 6564 2061 6674  are recorded aft
+00010720: 6572 2061 6c6c 2074 6865 0a72 6563 6f72  er all the.recor
+00010730: 6465 6420 6576 656e 7473 2068 6176 6520  ded events have 
+00010740: 6265 656e 2072 6563 6569 7665 642e 2049  been received. I
+00010750: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
+00010760: 6973 2022 7265 6164 2072 6573 706f 6e73  is "read respons
+00010770: 6522 0a6f 626a 6563 7420 7769 6c6c 2074  e".object will t
+00010780: 6865 7265 666f 7265 206e 6f74 2073 746f  herefore not sto
+00010790: 702c 2075 6e6c 6573 7320 7468 6520 6073  p, unless the `s
+000107a0: 746f 7028 2960 206d 6574 686f 6420 6f66  top()` method of
+000107b0: 2074 6865 0a22 7265 6164 2072 6573 706f   the."read respo
+000107c0: 6e73 6522 206f 626a 6563 7420 6973 2063  nse" object is c
+000107d0: 616c 6c65 642c 206f 7220 6120 636f 6e6e  alled, or a conn
+000107e0: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
+000107f0: 7572 732c 206f 720a 7468 6520 7265 7475  urs, or.the retu
+00010800: 726e 6564 206f 626a 6563 7420 6974 6572  rned object iter
+00010810: 6174 6f72 206f 626a 6563 7420 6973 2064  ator object is d
+00010820: 656c 6574 6564 2066 726f 6d20 6d65 6d6f  eleted from memo
+00010830: 7279 2e0a 0a54 6869 7320 6d65 7468 6f64  ry...This method
+00010840: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+00010850: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00010860: 6e60 2061 7267 756d 656e 742c 2077 6869  n` argument, whi
+00010870: 6368 2063 616e 2062 650a 7573 6564 2074  ch can be.used t
+00010880: 6f20 7370 6563 6966 7920 6120 636f 6d6d  o specify a comm
+00010890: 6974 2070 6f73 6974 696f 6e20 6672 6f6d  it position from
+000108a0: 2077 6869 6368 2074 6f20 7375 6273 6372   which to subscr
+000108b0: 6962 652e 2054 6865 2064 6566 6175 6c74  ibe. The default
+000108c0: 0a76 616c 7565 2069 7320 604e 6f6e 6560  .value is `None`
+000108d0: 2c20 7768 6963 6820 6d65 616e 7320 7468  , which means th
+000108e0: 6520 7375 6273 6372 6970 7469 6f6e 2077  e subscription w
+000108f0: 696c 6c20 6f70 6572 6174 6520 6672 6f6d  ill operate from
+00010900: 2074 6865 2066 6972 7374 0a72 6563 6f72   the first.recor
+00010910: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
+00010920: 2064 6174 6162 6173 652e 2049 6620 6120   database. If a 
+00010930: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+00010940: 6973 2067 6976 656e 2c20 6974 206d 7573  is given, it mus
+00010950: 7420 6d61 7463 680a 616e 2061 6374 7561  t match.an actua
+00010960: 6c6c 7920 6578 6973 7469 6e67 2063 6f6d  lly existing com
+00010970: 6d69 7420 706f 7369 7469 6f6e 2069 6e20  mit position in 
+00010980: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
+00010990: 6520 7265 636f 6465 6420 6576 656e 7473  e recoded events
+000109a0: 2074 6861 740a 6172 6520 6f62 7461 696e   that.are obtain
+000109b0: 6564 2077 696c 6c20 6e6f 7420 696e 636c  ed will not incl
+000109c0: 7564 6520 7468 6520 6576 656e 7420 7265  ude the event re
+000109d0: 636f 7264 6564 2061 7420 7468 6174 2063  corded at that c
+000109e0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e0a  ommit position..
+000109f0: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+00010a00: 6f20 6861 7320 666f 7572 206f 7468 6572  o has four other
+00010a10: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00010a20: 6e74 732c 2060 6669 6c74 6572 5f65 7863  nts, `filter_exc
+00010a30: 6c75 6465 602c 0a60 6669 6c74 6572 5f69  lude`,.`filter_i
+00010a40: 6e63 6c75 6465 602c 2060 6669 6c74 6572  nclude`, `filter
+00010a50: 5f62 795f 7374 7265 616d 5f6e 616d 6560  _by_stream_name`
+00010a60: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
+00010a70: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00010a80: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
+00010a90: 6172 6775 6d65 6e74 2069 7320 6120 7365  argument is a se
+00010aa0: 7175 656e 6365 206f 6620 7265 6775 6c61  quence of regula
+00010ab0: 7220 6578 7072 6573 7369 6f6e 7320 7468  r expressions th
+00010ac0: 6174 0a73 7065 6369 6669 6573 2077 6869  at.specifies whi
+00010ad0: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
+00010ae0: 7473 2073 686f 756c 6420 6265 2072 6574  ts should be ret
+00010af0: 7572 6e65 642e 2054 6869 7320 6172 6775  urned. This argu
+00010b00: 6d65 6e74 2069 7320 6967 6e6f 7265 640a  ment is ignored.
+00010b10: 6966 2060 6669 6c74 6572 5f69 6e63 6c75  if `filter_inclu
+00010b20: 6465 6020 6973 2073 6574 2074 6f20 6120  de` is set to a 
+00010b30: 6e6f 6e2d 656d 7074 7920 7365 7175 656e  non-empty sequen
+00010b40: 6365 2e20 5468 6520 6465 6661 756c 7420  ce. The default 
+00010b50: 7661 6c75 6520 6f66 2074 6869 730a 6172  value of this.ar
+00010b60: 6775 6d65 6e74 206d 6174 6368 6573 2074  gument matches t
+00010b70: 6865 2065 7665 6e74 2074 7970 6573 206f  he event types o
+00010b80: 6620 4576 656e 7453 746f 7265 4442 2022  f EventStoreDB "
+00010b90: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
+00010ba0: 736f 2074 6861 7420 7379 7374 656d 0a65  so that system.e
+00010bb0: 7665 6e74 7320 7769 6c6c 206e 6f74 206e  vents will not n
+00010bc0: 6f72 6d61 6c6c 7920 6265 2069 6e63 6c75  ormally be inclu
+00010bd0: 6465 642e 2053 6565 2074 6865 204e 6f74  ded. See the Not
+00010be0: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
+00010bf0: 2066 6f72 206d 6f72 650a 696e 666f 726d   for more.inform
+00010c00: 6174 696f 6e20 6162 6f75 7420 6669 6c74  ation about filt
+00010c10: 6572 2065 7870 7265 7373 696f 6e73 2e0a  er expressions..
+00010c20: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00010c30: 696c 7465 725f 696e 636c 7564 6560 2061  ilter_include` a
+00010c40: 7267 756d 656e 7420 6973 2061 2073 6571  rgument is a seq
+00010c50: 7565 6e63 6520 6f66 2072 6567 756c 6172  uence of regular
+00010c60: 2065 7870 7265 7373 696f 6e73 0a74 6861   expressions.tha
+00010c70: 7420 7370 6563 6966 6965 7320 7768 6963  t specifies whic
+00010c80: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+00010c90: 7320 7368 6f75 6c64 2062 6520 7265 7475  s should be retu
+00010ca0: 726e 6564 2e20 4279 2064 6566 6175 6c74  rned. By default
+00010cb0: 2c20 7468 6973 0a61 7267 756d 656e 7420  , this.argument 
+00010cc0: 6973 2061 6e20 656d 7074 7920 7475 706c  is an empty tupl
+00010cd0: 652e 2049 6620 7468 6973 2061 7267 756d  e. If this argum
+00010ce0: 656e 7420 6973 2073 6574 2074 6f20 6120  ent is set to a 
+00010cf0: 6e6f 6e2d 656d 7074 7920 7365 7175 656e  non-empty sequen
+00010d00: 6365 2c0a 7468 6520 6066 696c 7465 725f  ce,.the `filter_
+00010d10: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
+00010d20: 7420 6973 2069 676e 6f72 6564 2e0a 0a54  t is ignored...T
+00010d30: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
+00010d40: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
+00010d50: 6d65 6020 6172 6775 6d65 6e74 2069 7320  me` argument is 
+00010d60: 6120 5079 7468 6f6e 2060 626f 6f6c 6020  a Python `bool` 
+00010d70: 7468 6174 2069 6e64 6963 6174 6573 0a77  that indicates.w
+00010d80: 6865 7468 6572 2074 6865 2066 696c 7465  hether the filte
+00010d90: 7269 6e67 2077 696c 6c20 6170 706c 7920  ring will apply 
+00010da0: 746f 2065 7665 6e74 2074 7970 6573 206f  to event types o
+00010db0: 7220 7374 7265 616d 206e 616d 6573 2e20  r stream names. 
+00010dc0: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+00010dd0: 0a76 616c 7565 2069 7320 6046 616c 7365  .value is `False
+00010de0: 6020 616e 6420 736f 2074 6865 2066 696c  ` and so the fil
+00010df0: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
+00010e00: 7920 746f 2074 6865 2065 7665 6e74 2074  y to the event t
+00010e10: 7970 6520 7374 7269 6e67 7320 6f66 0a72  ype strings of.r
+00010e20: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
+00010e30: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
+00010e40: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00010e50: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00010e60: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+00010e70: 610a 6465 6164 6c69 6e65 2066 6f72 2074  a.deadline for t
+00010e80: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00010e90: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00010ea0: 696f 6e2e 0a0a 5468 6520 6578 616d 706c  ion...The exampl
+00010eb0: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
+00010ec0: 7720 746f 2073 7461 7274 2061 2063 6174  w to start a cat
+00010ed0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00010ee0: 6f6e 2074 6f20 7265 6365 6976 650a 6672  on to receive.fr
+00010ef0: 6f6d 2074 6865 2066 6972 7374 2072 6563  om the first rec
+00010f00: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
+00010f10: 6865 2064 6174 6162 6173 652e 0a0a 6060  he database...``
+00010f20: 6070 7974 686f 6e0a 2320 5375 6273 6372  `python.# Subscr
+00010f30: 6962 6520 6672 6f6d 2074 6865 2066 6972  ibe from the fir
+00010f40: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+00010f50: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
+00010f60: 652e 0a73 7562 7363 7269 7074 696f 6e20  e..subscription 
+00010f70: 3d20 636c 6965 6e74 2e73 7562 7363 7269  = client.subscri
+00010f80: 6265 5f61 6c6c 5f65 7665 6e74 7328 290a  be_all_events().
+00010f90: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+00010fa0: 2062 656c 6f77 2069 7320 6c6f 6e67 6572   below is longer
+00010fb0: 2c20 616e 6420 7368 6f77 7320 7468 6174  , and shows that
+00010fc0: 2074 6865 2063 6174 6368 2d75 7020 7375   the catch-up su
+00010fd0: 6273 6372 6970 7469 6f6e 0a64 6f65 7320  bscription.does 
+00010fe0: 6e6f 7420 7374 6f70 2061 7574 6f6d 6174  not stop automat
+00010ff0: 6963 616c 6c79 2c20 6275 7420 626c 6f63  ically, but bloc
+00011000: 6b73 2077 6865 6e20 7468 6520 6c61 7374  ks when the last
+00011010: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00011020: 6973 0a72 6563 6569 7665 642c 2061 6e64  is.received, and
+00011030: 2074 6865 6e20 636f 6e74 696e 7565 7320   then continues 
+00011040: 7768 656e 2073 7562 7365 7175 656e 7420  when subsequent 
+00011050: 6576 656e 7473 2061 7265 2072 6563 6f72  events are recor
+00011060: 6465 642e 0a0a 6060 6070 7974 686f 6e0a  ded...```python.
+00011070: 2320 4170 7065 6e64 2061 206e 6577 2065  # Append a new e
+00011080: 7665 6e74 2074 6f20 6120 6e65 7720 7374  vent to a new st
+00011090: 7265 616d 2e0a 7374 7265 616d 5f6e 616d  ream..stream_nam
+000110a0: 6532 203d 2073 7472 2875 7569 642e 7575  e2 = str(uuid.uu
+000110b0: 6964 3428 2929 0a65 7665 6e74 3420 3d20  id4()).event4 = 
+000110c0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+000110d0: 7264 6572 4372 6561 7465 6427 2c20 6461  rderCreated', da
+000110e0: 7461 3d62 2764 6174 6134 2729 0a63 6c69  ta=b'data4').cli
+000110f0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+00011100: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+00011110: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+00011120: 0a20 2020 2063 7572 7265 6e74 5f76 6572  .    current_ver
+00011130: 7369 6f6e 3d4e 6f6e 652c 0a20 2020 2065  sion=None,.    e
+00011140: 7665 6e74 733d 5b65 7665 6e74 345d 2c0a  vents=[event4],.
+00011150: 290a 0a23 2053 7562 7363 7269 6265 2066  )..# Subscribe f
+00011160: 726f 6d20 7468 6520 6669 7273 7420 7265  rom the first re
+00011170: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
+00011180: 7468 6520 6461 7461 6261 7365 2e0a 7375  the database..su
+00011190: 6273 6372 6970 7469 6f6e 203d 2063 6c69  bscription = cli
+000111a0: 656e 742e 7375 6273 6372 6962 655f 616c  ent.subscribe_al
+000111b0: 6c5f 6576 656e 7473 2829 0a72 6563 6569  l_events().recei
+000111c0: 7665 645f 6576 656e 7473 203d 205b 5d0a  ved_events = [].
+000111d0: 0a0a 2320 5265 6365 6976 6520 6576 656e  ..# Receive even
+000111e0: 7473 2066 726f 6d20 7468 6520 6361 7463  ts from the catc
+000111f0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+00011200: 6e20 696e 2061 2064 6966 6665 7265 6e74  n in a different
+00011210: 2074 6872 6561 642e 0a66 726f 6d20 6461   thread..from da
+00011220: 7465 7469 6d65 2069 6d70 6f72 7420 6461  tetime import da
+00011230: 7465 7469 6d65 0a66 726f 6d20 7468 7265  tetime.from thre
+00011240: 6164 696e 6720 696d 706f 7274 2054 6872  ading import Thr
+00011250: 6561 640a 0a6d 6172 6b20 3d20 6461 7465  ead..mark = date
+00011260: 7469 6d65 2e6e 6f77 2829 0a0a 6465 6620  time.now()..def 
+00011270: 7265 6365 6976 655f 6576 656e 7473 2829  receive_events()
+00011280: 3a0a 2020 2020 666f 7220 6576 656e 7420  :.    for event 
+00011290: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
+000112a0: 0a20 2020 2020 2020 2072 6563 6569 7665  .        receive
+000112b0: 645f 6576 656e 7473 2e61 7070 656e 6428  d_events.append(
+000112c0: 6576 656e 7429 0a20 2020 2020 2020 2067  event).        g
+000112d0: 6c6f 6261 6c20 6d61 726b 0a20 2020 2020  lobal mark.     
+000112e0: 2020 206d 6172 6b20 3d20 6461 7465 7469     mark = dateti
+000112f0: 6d65 2e6e 6f77 2829 0a0a 0a64 6566 2077  me.now()...def w
+00011300: 6169 745f 666f 725f 7375 6273 6372 6970  ait_for_subscrip
+00011310: 7469 6f6e 5f74 6f5f 626c 6f63 6b28 293a  tion_to_block():
+00011320: 0a20 2020 2077 6869 6c65 2054 7275 653a  .    while True:
+00011330: 0a20 2020 2020 2020 2020 6966 2028 6461  .         if (da
+00011340: 7465 7469 6d65 2e6e 6f77 2829 202d 206d  tetime.now() - m
+00011350: 6172 6b29 2e74 6f74 616c 5f73 6563 6f6e  ark).total_secon
+00011360: 6473 2829 203e 2031 3a0a 2020 2020 2020  ds() > 1:.      
+00011370: 2020 2020 2020 2062 7265 616b 0a0a 0a74         break...t
+00011380: 6872 6561 6420 3d20 5468 7265 6164 2874  hread = Thread(t
+00011390: 6172 6765 743d 7265 6365 6976 655f 6576  arget=receive_ev
+000113a0: 656e 7473 290a 7468 7265 6164 2e73 7461  ents).thread.sta
+000113b0: 7274 2829 0a0a 2320 5761 6974 2066 6f72  rt()..# Wait for
+000113c0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+000113d0: 6e20 746f 2062 6c6f 636b 2e0a 7761 6974  n to block..wait
+000113e0: 5f66 6f72 5f73 7562 7363 7269 7074 696f  _for_subscriptio
+000113f0: 6e5f 746f 5f62 6c6f 636b 2829 0a0a 2320  n_to_block()..# 
+00011400: 4368 6563 6b20 7468 6520 6c61 7374 2072  Check the last r
+00011410: 6563 6569 7665 6420 6576 656e 7420 6973  eceived event is
+00011420: 2027 6576 656e 7434 272e 0a61 7373 6572   'event4'..asser
+00011430: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00011440: 735b 2d31 5d2e 6964 203d 3d20 6576 656e  s[-1].id == even
+00011450: 7434 2e69 640a 0a23 2043 6865 636b 2077  t4.id..# Check w
+00011460: 6520 616c 736f 2072 6563 6569 7665 6420  e also received 
+00011470: 7468 6520 6f74 6865 7220 6576 656e 7473  the other events
+00011480: 2077 6520 6861 7665 2072 6563 6f72 6465   we have recorde
+00011490: 642e 0a61 7373 6572 7420 7265 6365 6976  d..assert receiv
+000114a0: 6564 5f65 7665 6e74 735b 2d39 5d2e 6964  ed_events[-9].id
+000114b0: 203d 3d20 6576 656e 7431 2e69 640a 6173   == event1.id.as
+000114c0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+000114d0: 656e 7473 5b2d 385d 2e69 6420 3d3d 2065  ents[-8].id == e
+000114e0: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
+000114f0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+00011500: 2d37 5d2e 6964 203d 3d20 6576 656e 7433  -7].id == event3
+00011510: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
+00011520: 7665 645f 6576 656e 7473 5b2d 365d 2e74  ved_events[-6].t
+00011530: 7970 6520 3d3d 2022 446f 6752 6567 6973  ype == "DogRegis
+00011540: 7465 7265 6422 0a61 7373 6572 7420 7265  tered".assert re
+00011550: 6365 6976 6564 5f65 7665 6e74 735b 2d35  ceived_events[-5
+00011560: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+00011570: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
+00011580: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+00011590: 7473 5b2d 345d 2e74 7970 6520 3d3d 2022  ts[-4].type == "
+000115a0: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
+000115b0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+000115c0: 5f65 7665 6e74 735b 2d33 5d2e 7479 7065  _events[-3].type
+000115d0: 203d 3d20 2253 6e61 7073 686f 7422 0a61   == "Snapshot".a
+000115e0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+000115f0: 7665 6e74 735b 2d32 5d2e 7479 7065 203d  vents[-2].type =
+00011600: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
+00011610: 636b 220a 0a23 2041 7070 656e 6420 616e  ck"..# Append an
+00011620: 6f74 6865 7220 6576 656e 7420 7768 696c  other event whil
+00011630: 7374 2074 6865 2073 7562 7363 7269 7074  st the subscript
+00011640: 696f 6e20 6973 2072 756e 6e69 6e67 2e0a  ion is running..
+00011650: 6d61 726b 203d 2064 6174 6574 696d 652e  mark = datetime.
+00011660: 6e6f 7728 290a 6576 656e 7435 203d 204e  now().event5 = N
+00011670: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
+00011680: 6465 7255 7064 6174 6564 272c 2064 6174  derUpdated', dat
+00011690: 613d 6227 6461 7461 3527 290a 636c 6965  a=b'data5').clie
+000116a0: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+000116b0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+000116c0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
+000116d0: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+000116e0: 696f 6e3d 302c 0a20 2020 2065 7665 6e74  ion=0,.    event
+000116f0: 733d 5b65 7665 6e74 355d 2c0a 290a 0a23  s=[event5],.)..#
+00011700: 2057 6169 7420 666f 7220 7468 6520 7375   Wait for the su
+00011710: 6273 6372 6970 7469 6f6e 2074 6f20 626c  bscription to bl
+00011720: 6f63 6b2e 0a77 6169 745f 666f 725f 7375  ock..wait_for_su
+00011730: 6273 6372 6970 7469 6f6e 5f74 6f5f 626c  bscription_to_bl
+00011740: 6f63 6b28 290a 0a23 2043 6865 636b 2074  ock()..# Check t
+00011750: 6865 206c 6173 7420 7265 6365 6976 6564  he last received
+00011760: 2065 7665 6e74 2069 7320 2765 7665 6e74   event is 'event
+00011770: 3527 2e0a 6173 7365 7274 2072 6563 6569  5'..assert recei
+00011780: 7665 645f 6576 656e 7473 5b2d 325d 2e69  ved_events[-2].i
+00011790: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
+000117a0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+000117b0: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
+000117c0: 6576 656e 7435 2e69 640a 0a23 2053 746f  event5.id..# Sto
+000117d0: 7020 7468 6520 7375 6273 6372 6970 7469  p the subscripti
+000117e0: 6f6e 2e0a 7375 6273 6372 6970 7469 6f6e  on..subscription
+000117f0: 2e73 746f 7028 290a 7468 7265 6164 2e6a  .stop().thread.j
+00011800: 6f69 6e28 290a 6060 600a 0a54 6865 2065  oin().```..The e
+00011810: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+00011820: 7773 2068 6f77 2074 6f20 7374 6172 7420  ws how to start 
+00011830: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
+00011840: 7269 7074 696f 6e20 746f 0a72 6563 6569  ription to.recei
+00011850: 7665 2066 726f 6d20 6120 7061 7274 6963  ve from a partic
+00011860: 756c 6172 2063 6f6d 6d69 7420 706f 7369  ular commit posi
+00011870: 7469 6f6e 2c20 696e 2074 6869 7320 6361  tion, in this ca
+00011880: 7365 2066 726f 6d20 7468 650a 636f 6d6d  se from the.comm
+00011890: 6974 2070 6f73 6974 696f 6e20 6f66 2074  it position of t
+000118a0: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+000118b0: 2065 7665 6e74 2074 6861 7420 7761 7320   event that was 
+000118c0: 7265 6365 6976 6564 2061 626f 7665 2e0a  received above..
+000118d0: 416e 6f74 6865 7220 6576 656e 7420 6973  Another event is
+000118e0: 2072 6563 6f72 6465 6420 6265 666f 7265   recorded before
+000118f0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00011900: 6e20 6973 2072 6573 7461 7274 6564 2e0a  n is restarted..
+00011910: 4675 7274 6865 7220 6576 656e 7473 2061  Further events a
+00011920: 7265 2072 6563 6f72 6465 6420 7768 696c  re recorded whil
+00011930: 7374 2074 6865 2073 7562 7363 7269 7074  st the subscript
+00011940: 696f 6e20 6973 2072 756e 6e69 6e67 2e0a  ion is running..
+00011950: 416c 6c20 7468 6520 7265 636f 7264 6564  All the recorded
+00011960: 2065 7665 6e74 7320 6172 6520 7265 6365   events are rece
+00011970: 6976 6564 2065 7861 6374 6c79 206f 6e63  ived exactly onc
+00011980: 652e 0a0a 6060 6070 7974 686f 6e0a 0a23  e...```python..#
+00011990: 2041 7070 656e 6420 616e 6f74 6865 7220   Append another 
+000119a0: 6576 656e 742e 0a65 7665 6e74 3620 3d20  event..event6 = 
+000119b0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+000119c0: 7264 6572 4465 6c65 7465 6427 2c20 6461  rderDeleted', da
+000119d0: 7461 3d62 2764 6174 6136 2729 0a63 6c69  ta=b'data6').cli
+000119e0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+000119f0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+00011a00: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+00011a10: 0a20 2020 2063 7572 7265 6e74 5f76 6572  .    current_ver
+00011a20: 7369 6f6e 3d31 2c0a 2020 2020 6576 656e  sion=1,.    even
+00011a30: 7473 3d5b 6576 656e 7436 5d2c 0a29 0a0a  ts=[event6],.)..
+00011a40: 2320 5265 7375 6d65 2073 7562 7363 7269  # Resume subscri
+00011a50: 6269 6e67 2066 726f 6d20 7468 6520 636f  bing from the co
+00011a60: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
+00011a70: 2074 6865 206c 6173 7420 7265 6365 6976   the last receiv
+00011a80: 6564 2065 7665 6e74 2e0a 7375 6273 6372  ed event..subscr
+00011a90: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00011aa0: 7375 6273 6372 6962 655f 616c 6c5f 6576  subscribe_all_ev
+00011ab0: 656e 7473 280a 2020 2020 636f 6d6d 6974  ents(.    commit
+00011ac0: 5f70 6f73 6974 696f 6e3d 7265 6365 6976  _position=receiv
+00011ad0: 6564 5f65 7665 6e74 735b 2d31 5d2e 636f  ed_events[-1].co
+00011ae0: 6d6d 6974 5f70 6f73 6974 696f 6e0a 290a  mmit_position.).
+00011af0: 0a6d 6172 6b20 3d20 6461 7465 7469 6d65  .mark = datetime
+00011b00: 2e6e 6f77 2829 0a74 6872 6561 6420 3d20  .now().thread = 
+00011b10: 5468 7265 6164 2874 6172 6765 743d 7265  Thread(target=re
+00011b20: 6365 6976 655f 6576 656e 7473 290a 7468  ceive_events).th
+00011b30: 7265 6164 2e73 7461 7274 2829 0a0a 2320  read.start()..# 
+00011b40: 5761 6974 2066 6f72 2074 6865 2073 7562  Wait for the sub
+00011b50: 7363 7269 7074 696f 6e20 746f 2062 6c6f  scription to blo
+00011b60: 636b 2e0a 7761 6974 5f66 6f72 5f73 7562  ck..wait_for_sub
+00011b70: 7363 7269 7074 696f 6e5f 746f 5f62 6c6f  scription_to_blo
+00011b80: 636b 2829 0a0a 2320 4368 6563 6b20 7468  ck()..# Check th
+00011b90: 6520 6c61 7374 2072 6563 6569 7665 6420  e last received 
+00011ba0: 6576 656e 7420 7761 7320 2765 7665 6e74  event was 'event
+00011bb0: 3627 2e0a 6173 7365 7274 2072 6563 6569  6'..assert recei
+00011bc0: 7665 645f 6576 656e 7473 5b2d 335d 2e69  ved_events[-3].i
+00011bd0: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
+00011be0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+00011bf0: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
+00011c00: 6576 656e 7435 2e69 640a 6173 7365 7274  event5.id.assert
+00011c10: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+00011c20: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
+00011c30: 362e 6964 0a0a 2320 4170 7065 6e64 2074  6.id..# Append t
+00011c40: 6872 6565 206d 6f72 6520 6576 656e 7473  hree more events
+00011c50: 2074 6f20 6120 6e65 7720 7374 7265 616d   to a new stream
+00011c60: 2e0a 6d61 726b 203d 2064 6174 6574 696d  ..mark = datetim
+00011c70: 652e 6e6f 7728 290a 7374 7265 616d 5f6e  e.now().stream_n
+00011c80: 616d 6533 203d 2073 7472 2875 7569 642e  ame3 = str(uuid.
+00011c90: 7575 6964 3428 2929 0a65 7665 6e74 3720  uuid4()).event7 
+00011ca0: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
+00011cb0: 274f 7264 6572 4372 6561 7465 6427 2c20  'OrderCreated', 
+00011cc0: 6461 7461 3d62 2764 6174 6137 2729 0a65  data=b'data7').e
+00011cd0: 7665 6e74 3820 3d20 4e65 7745 7665 6e74  vent8 = NewEvent
+00011ce0: 2874 7970 653d 274f 7264 6572 5570 6461  (type='OrderUpda
+00011cf0: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
+00011d00: 6138 2729 0a65 7665 6e74 3920 3d20 4e65  a8').event9 = Ne
+00011d10: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
+00011d20: 6572 4465 6c65 7465 6427 2c20 6461 7461  erDeleted', data
+00011d30: 3d62 2764 6174 6139 2729 0a0a 636c 6965  =b'data9')..clie
+00011d40: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+00011d50: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+00011d60: 653d 7374 7265 616d 5f6e 616d 6533 2c0a  e=stream_name3,.
+00011d70: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+00011d80: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 6576  ion=None,.    ev
+00011d90: 656e 7473 3d5b 6576 656e 7437 2c20 6576  ents=[event7, ev
+00011da0: 656e 7438 2c20 6576 656e 7439 5d2c 0a29  ent8, event9],.)
+00011db0: 0a0a 2320 5761 6974 2066 6f72 2074 6865  ..# Wait for the
+00011dc0: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
+00011dd0: 2062 6c6f 636b 2e0a 7761 6974 5f66 6f72   block..wait_for
+00011de0: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
+00011df0: 5f62 6c6f 636b 2829 0a0a 0a23 2043 6865  _block()...# Che
+00011e00: 636b 2061 6c6c 2074 6865 2065 7665 6e74  ck all the event
+00011e10: 7320 6861 7665 2062 6565 6e20 7265 6365  s have been rece
+00011e20: 6976 6564 2065 7861 6374 6c79 206f 6e63  ived exactly onc
+00011e30: 652e 0a61 7373 6572 7420 7265 6365 6976  e..assert receiv
+00011e40: 6564 5f65 7665 6e74 735b 2d36 5d2e 6964  ed_events[-6].id
+00011e50: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
+00011e60: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+00011e70: 656e 7473 5b2d 355d 2e69 6420 3d3d 2065  ents[-5].id == e
+00011e80: 7665 6e74 352e 6964 0a61 7373 6572 7420  vent5.id.assert 
+00011e90: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+00011ea0: 2d34 5d2e 6964 203d 3d20 6576 656e 7436  -4].id == event6
+00011eb0: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
+00011ec0: 7665 645f 6576 656e 7473 5b2d 335d 2e69  ved_events[-3].i
+00011ed0: 6420 3d3d 2065 7665 6e74 372e 6964 0a61  d == event7.id.a
+00011ee0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+00011ef0: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
+00011f00: 6576 656e 7438 2e69 640a 6173 7365 7274  event8.id.assert
+00011f10: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+00011f20: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
+00011f30: 392e 6964 0a0a 2320 5374 6f70 2074 6865  9.id..# Stop the
+00011f40: 2073 7562 7363 7269 7074 696f 6e2e 0a73   subscription..s
+00011f50: 7562 7363 7269 7074 696f 6e2e 7374 6f70  ubscription.stop
+00011f60: 2829 0a74 6872 6561 642e 6a6f 696e 2829  ().thread.join()
+00011f70: 0a60 6060 0a0a 5468 6520 6361 7463 682d  .```..The catch-
+00011f80: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
+00011f90: 6361 6c6c 2069 7320 656e 6465 6420 6173  call is ended as
+00011fa0: 2073 6f6f 6e20 6173 2074 6865 2073 7562   soon as the sub
+00011fb0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
+00011fc0: 2773 0a60 7374 6f70 2829 6020 6d65 7468  's.`stop()` meth
+00011fd0: 6f64 2069 7320 6361 6c6c 6564 2e20 5468  od is called. Th
+00011fe0: 6973 2068 6170 7065 6e73 2061 7574 6f6d  is happens autom
+00011ff0: 6174 6963 616c 6c79 2077 6865 6e20 6974  atically when it
+00012000: 2067 6f65 7320 6f75 7420 6f66 2073 636f   goes out of sco
+00012010: 7065 2c0a 6f72 2077 6865 6e20 6974 2069  pe,.or when it i
+00012020: 7320 6578 706c 6963 6974 6c79 2064 656c  s explicitly del
+00012030: 6574 6564 2066 726f 6d20 6d65 6d6f 7279  eted from memory
+00012040: 2075 7369 6e67 2074 6865 2050 7974 686f   using the Pytho
+00012050: 6e20 6064 656c 6020 6b65 7977 6f72 642e  n `del` keyword.
+00012060: 0a0a 2323 2320 5375 6273 6372 6962 6520  ..### Subscribe 
+00012070: 7374 7265 616d 2065 7665 6e74 730a 0a54  stream events..T
+00012080: 6865 2060 7375 6273 6372 6962 655f 7374  he `subscribe_st
+00012090: 7265 616d 5f65 7665 6e74 7328 2960 206d  ream_events()` m
+000120a0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+000120b0: 6420 746f 2073 7461 7274 2061 2063 6174  d to start a cat
+000120c0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+000120d0: 6f6e 0a74 6861 7420 6361 6e20 7265 7475  on.that can retu
+000120e0: 726e 2065 7665 6e74 7320 7468 6174 2061  rn events that a
+000120f0: 7265 2072 6563 6f72 6465 6420 696e 2061  re recorded in a
+00012100: 2073 696e 676c 6520 7374 7265 616d 2e0a   single stream..
+00012110: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00012120: 2061 2072 6571 7569 7265 6420 6073 7472   a required `str
+00012130: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
+00012140: 6e74 2c20 7768 6963 6820 7370 6563 6966  nt, which specif
+00012150: 6965 7320 7468 6520 6e61 6d65 206f 6620  ies the name of 
+00012160: 7468 650a 7374 7265 616d 2066 726f 6d20  the.stream from 
+00012170: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
+00012180: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
+00012190: 6365 6976 6564 2e0a 0a54 6869 7320 6d65  ceived...This me
+000121a0: 7468 6f64 2061 6c73 6f20 6861 7320 7477  thod also has tw
+000121b0: 6f20 6f70 7469 6f6e 616c 2061 7267 756d  o optional argum
+000121c0: 656e 7473 2c20 6073 7472 6561 6d5f 706f  ents, `stream_po
+000121d0: 7369 7469 6f6e 602c 2061 6e64 2060 7469  sition`, and `ti
+000121e0: 6d65 6f75 7460 2e0a 0a54 6865 206f 7074  meout`...The opt
+000121f0: 696f 6e61 6c20 6073 7472 6561 6d5f 706f  ional `stream_po
+00012200: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+00012210: 2073 7065 6369 6669 6573 2061 2070 6f73   specifies a pos
+00012220: 6974 696f 6e20 696e 2074 6865 2073 7472  ition in the str
+00012230: 6561 6d20 6672 6f6d 2077 6869 6368 0a72  eam from which.r
+00012240: 6563 6f72 6465 6420 6576 656e 7473 2077  ecorded events w
+00012250: 696c 6c20 6265 2072 6563 6569 7665 642e  ill be received.
+00012260: 2054 6865 2065 7665 6e74 2061 7420 7468   The event at th
+00012270: 6520 7370 6563 6966 6965 6420 7374 7265  e specified stre
+00012280: 616d 2070 6f73 6974 696f 6e20 7769 6c6c  am position will
+00012290: 206e 6f74 0a62 6520 696e 636c 7564 6564   not.be included
+000122a0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+000122b0: 6c75 6520 6f66 2060 7374 7265 616d 5f70  lue of `stream_p
+000122c0: 6f73 6974 696f 6e60 2069 7320 604e 6f6e  osition` is `Non
+000122d0: 6560 2c20 7768 6963 6820 6d65 616e 7320  e`, which means 
+000122e0: 7468 650a 7375 6273 6372 6970 7469 6f6e  the.subscription
+000122f0: 2077 696c 6c20 7374 6172 7420 6672 6f6d   will start from
+00012300: 2074 6865 2066 6972 7374 2072 6563 6f72   the first recor
+00012310: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
+00012320: 2073 7472 6561 6d2e 0a0a 5468 6520 6f70   stream...The op
+00012330: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00012340: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00012350: 7974 686f 6e20 6066 6c6f 6174 6020 7468  ython `float` th
+00012360: 6174 2073 6574 730a 6120 6465 6164 6c69  at sets.a deadli
+00012370: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+00012380: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00012390: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+000123a0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+000123b0: 7368 6f77 7320 686f 7720 746f 2073 7461  shows how to sta
+000123c0: 7274 2061 2063 6174 6368 2d75 7020 7375  rt a catch-up su
+000123d0: 6273 6372 6970 7469 6f6e 2066 726f 6d0a  bscription from.
+000123e0: 7468 6520 6669 7273 7420 7265 636f 7264  the first record
+000123f0: 6564 2065 7665 6e74 2069 6e20 6120 7374  ed event in a st
+00012400: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+00012410: 0a23 2053 7562 7363 7269 6265 2066 726f  .# Subscribe fro
+00012420: 6d20 7468 6520 7374 6172 7420 6f66 2027  m the start of '
+00012430: 7374 7265 616d 3227 2e0a 7375 6273 6372  stream2'..subscr
+00012440: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00012450: 7375 6273 6372 6962 655f 7374 7265 616d  subscribe_stream
+00012460: 5f65 7665 6e74 7328 7374 7265 616d 5f6e  _events(stream_n
+00012470: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00012480: 290a 6060 600a 0a54 6865 2065 7861 6d70  ).```..The examp
+00012490: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
+000124a0: 6f77 2074 6f20 7374 6172 7420 6120 6361  ow to start a ca
+000124b0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+000124c0: 696f 6e20 6672 6f6d 0a61 2070 6172 7469  ion from.a parti
+000124d0: 6375 6c61 7220 7374 7265 616d 2070 6f73  cular stream pos
+000124e0: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
+000124f0: 6e0a 2320 5375 6273 6372 6962 6520 746f  n.# Subscribe to
+00012500: 2073 7472 6561 6d32 2c20 6672 6f6d 2074   stream2, from t
+00012510: 6865 2073 6563 6f6e 6420 7265 636f 7264  he second record
+00012520: 6564 2065 7665 6e74 2e0a 7375 6273 6372  ed event..subscr
+00012530: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00012540: 7375 6273 6372 6962 655f 7374 7265 616d  subscribe_stream
+00012550: 5f65 7665 6e74 7328 0a20 2020 2073 7472  _events(.    str
+00012560: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00012570: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
+00012580: 6d5f 706f 7369 7469 6f6e 3d31 2c0a 290a  m_position=1,.).
+00012590: 6060 600a 0a23 2323 2048 6f77 2074 6f20  ```..### How to 
+000125a0: 696d 706c 656d 656e 7420 6578 6163 746c  implement exactl
+000125b0: 792d 6f6e 6365 2065 7665 6e74 2070 726f  y-once event pro
+000125c0: 6365 7373 696e 670a 0a54 6865 2063 6f6d  cessing..The com
+000125d0: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
+000125e0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000125f0: 2074 6861 7420 6172 6520 7265 6365 6976   that are receiv
+00012600: 6564 2061 6e64 2070 726f 6365 7373 6564  ed and processed
+00012610: 2062 7920 610a 646f 776e 7374 7265 616d   by a.downstream
+00012620: 2063 6f6d 706f 6e65 6e74 2061 7265 2075   component are u
+00012630: 7365 6675 6c6c 7920 7265 636f 7264 6564  sefully recorded
+00012640: 2062 7920 7468 6520 646f 776e 7374 7265   by the downstre
+00012650: 616d 2063 6f6d 706f 6e65 6e74 2c20 736f  am component, so
+00012660: 2074 6861 740a 7468 6520 636f 6d6d 6974   that.the commit
+00012670: 2070 6f73 6974 696f 6e20 6f66 206c 6173   position of las
+00012680: 7420 7072 6f63 6573 7365 6420 6576 656e  t processed even
+00012690: 7420 6361 6e20 6265 2064 6574 6572 6d69  t can be determi
+000126a0: 6e65 6420 7768 656e 2070 726f 6365 7373  ned when process
+000126b0: 696e 6720 6973 0a72 6573 756d 6564 2e0a  ing is.resumed..
+000126c0: 0a54 6865 206c 6173 7420 7265 636f 7264  .The last record
+000126d0: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
+000126e0: 6f6e 2063 616e 2062 6520 7573 6564 2074  on can be used t
+000126f0: 6f20 7370 6563 6966 7920 7468 6520 636f  o specify the co
+00012700: 6d6d 6974 2070 6f73 6974 696f 6e20 6672  mmit position fr
+00012710: 6f6d 2077 6869 6368 0a74 6f20 7375 6273  om which.to subs
+00012720: 6372 6962 6520 7768 656e 2070 726f 6365  cribe when proce
+00012730: 7373 696e 6720 6973 2072 6573 756d 6564  ssing is resumed
+00012740: 2e20 5369 6e63 6520 7468 6973 2063 6f6d  . Since this com
+00012750: 6d69 7420 706f 7369 7469 6f6e 2077 696c  mit position wil
+00012760: 6c20 7265 7072 6573 656e 7420 7468 650a  l represent the.
+00012770: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
+00012780: 6c61 7374 2073 7563 6365 7373 6675 6c6c  last successfull
+00012790: 7920 7072 6f63 6573 7365 6420 6576 656e  y processed even
+000127a0: 7420 696e 2061 2064 6f77 6e73 7472 6561  t in a downstrea
+000127b0: 6d20 636f 6d70 6f6e 656e 742c 2073 6f20  m component, so 
+000127c0: 6974 0a77 696c 6c20 6265 2075 7375 616c  it.will be usual
+000127d0: 2074 6f20 7761 6e74 2074 6865 206e 6578   to want the nex
+000127e0: 7420 6576 656e 7420 6166 7465 7220 7468  t event after th
+000127f0: 6973 2070 6f73 6974 696f 6e2c 2062 6563  is position, bec
+00012800: 6175 7365 2074 6861 7420 6973 2074 6865  ause that is the
+00012810: 206e 6578 740a 6576 656e 7420 7468 6174   next.event that
+00012820: 2068 6173 206e 6f74 2079 6574 2062 6565   has not yet bee
+00012830: 6e20 7072 6f63 6573 7365 642e 2046 6f72  n processed. For
+00012840: 2074 6869 7320 7265 6173 6f6e 2c20 7768   this reason, wh
+00012850: 656e 2073 7562 7363 7269 6269 6e67 2066  en subscribing f
+00012860: 6f72 2065 7665 6e74 730a 6672 6f6d 2061  or events.from a
+00012870: 2073 7065 6369 6669 6320 636f 6d6d 6974   specific commit
+00012880: 2070 6f73 6974 696f 6e20 7573 696e 6720   position using 
+00012890: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
+000128a0: 7269 7074 696f 6e20 696e 2045 7665 6e74  ription in Event
+000128b0: 5374 6f72 6544 422c 2074 6865 0a72 6563  StoreDB, the.rec
+000128c0: 6f72 6465 6420 6576 656e 7420 6174 2074  orded event at t
+000128d0: 6865 2073 7065 6369 6669 6564 2063 6f6d  he specified com
+000128e0: 6d69 7420 706f 7369 7469 6f6e 2077 696c  mit position wil
+000128f0: 6c20 4e4f 5420 6265 2069 6e63 6c75 6465  l NOT be include
+00012900: 6420 696e 2074 6865 2073 6571 7565 6e63  d in the sequenc
+00012910: 650a 6f66 2072 6563 6f72 6465 6420 6576  e.of recorded ev
+00012920: 656e 7473 2074 6861 7420 6172 6520 7265  ents that are re
+00012930: 6365 6976 6564 2e0a 0a54 6f20 6163 636f  ceived...To acco
+00012940: 6d70 6c69 7368 2022 6578 6163 746c 792d  mplish "exactly-
+00012950: 6f6e 6365 2220 7072 6f63 6573 7369 6e67  once" processing
+00012960: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
+00012970: 6e74 7320 696e 2061 2064 6f77 6e73 7472  nts in a downstr
+00012980: 6561 6d0a 636f 6d70 6f6e 656e 7420 7768  eam.component wh
+00012990: 656e 2075 7369 6e67 2061 2063 6174 6368  en using a catch
+000129a0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+000129b0: 2c20 7468 6520 636f 6d6d 6974 2070 6f73  , the commit pos
+000129c0: 6974 696f 6e20 6f66 2061 2072 6563 6f72  ition of a recor
+000129d0: 6465 640a 6576 656e 7420 7368 6f75 6c64  ded.event should
+000129e0: 2062 6520 7265 636f 7264 6564 2061 746f   be recorded ato
+000129f0: 6d69 6361 6c6c 7920 616e 6420 756e 6971  mically and uniq
+00012a00: 7565 6c79 2061 6c6f 6e67 2077 6974 6820  uely along with 
+00012a10: 7468 6520 7265 7375 6c74 206f 6620 7072  the result of pr
+00012a20: 6f63 6573 7369 6e67 0a72 6563 6f72 6465  ocessing.recorde
+00012a30: 6420 6576 656e 7473 2c20 666f 7220 6578  d events, for ex
+00012a40: 616d 706c 6520 696e 2074 6865 2073 616d  ample in the sam
+00012a50: 6520 6461 7461 6261 7365 2061 7320 6d61  e database as ma
+00012a60: 7465 7269 616c 6973 6564 2076 6965 7773  terialised views
+00012a70: 2077 6865 6e0a 696d 706c 656d 656e 7469   when.implementi
+00012a80: 6e67 2065 7665 6e74 7561 6c6c 792d 636f  ng eventually-co
+00012a90: 6e73 6973 7465 6e74 2043 5152 532c 206f  nsistent CQRS, o
+00012aa0: 7220 696e 2074 6865 2073 616d 6520 6461  r in the same da
+00012ab0: 7461 6261 7365 2061 7320 6120 646f 776e  tabase as a down
+00012ac0: 7374 7265 616d 0a61 6e61 6c79 7469 6373  stream.analytics
+00012ad0: 206f 7220 7265 706f 7274 696e 6720 6f72   or reporting or
+00012ae0: 2061 7263 6869 7669 6e67 2061 7070 6c69   archiving appli
+00012af0: 6361 7469 6f6e 2e20 4279 2072 6563 6f72  cation. By recor
+00012b00: 6469 6e67 2074 6865 2063 6f6d 6d69 7420  ding the commit 
+00012b10: 706f 7369 7469 6f6e 0a6f 6620 7265 636f  position.of reco
+00012b20: 7264 6564 2065 7665 6e74 7320 6174 6f6d  rded events atom
+00012b30: 6963 616c 6c79 2077 6974 6820 7468 6520  ically with the 
+00012b40: 6e65 7720 7374 6174 6520 7468 6174 2072  new state that r
+00012b50: 6573 756c 7473 2066 726f 6d20 7072 6f63  esults from proc
+00012b60: 6573 7369 6e67 0a72 6563 6f72 6465 6420  essing.recorded 
+00012b70: 6576 656e 7473 2c20 2264 7561 6c20 7772  events, "dual wr
+00012b80: 6974 696e 6722 2069 6e20 7468 6520 636f  iting" in the co
+00012b90: 6e73 756d 7074 696f 6e20 6f66 2072 6563  nsumption of rec
+00012ba0: 6f72 6465 6420 6576 656e 7473 2063 616e  orded events can
+00012bb0: 2062 650a 6176 6f69 6465 642e 2042 7920   be.avoided. By 
+00012bc0: 616c 736f 2072 6563 6f72 6469 6e67 2074  also recording t
+00012bd0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+00012be0: 6f6e 2075 6e69 7175 656c 792c 2074 6865  on uniquely, the
+00012bf0: 206e 6577 2073 7461 7465 2063 616e 6e6f   new state canno
+00012c00: 7420 6265 0a72 6563 6f72 6465 6420 7477  t be.recorded tw
+00012c10: 6963 652c 2061 6e64 2068 656e 6365 2074  ice, and hence t
+00012c20: 6865 2072 6563 6f72 6465 6420 7374 6174  he recorded stat
+00012c30: 6520 6f66 2074 6865 2064 6f77 6e73 7472  e of the downstr
+00012c40: 6561 6d20 636f 6d70 6f6e 656e 7420 7769  eam component wi
+00012c50: 6c6c 2062 650a 7570 6461 7465 6420 6f6e  ll be.updated on
+00012c60: 6c79 206f 6e63 6520 666f 7220 616e 7920  ly once for any 
+00012c70: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
+00012c80: 4279 2075 7369 6e67 2074 6865 2067 7265  By using the gre
+00012c90: 6174 6573 7420 7265 636f 7264 6564 2063  atest recorded c
+00012ca0: 6f6d 6d69 740a 706f 7369 7469 6f6e 2074  ommit.position t
+00012cb0: 6f20 7265 7375 6d65 2061 2063 6174 6368  o resume a catch
+00012cc0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00012cd0: 2c20 616c 6c20 7265 636f 7264 6564 2065  , all recorded e
+00012ce0: 7665 6e74 7320 7769 6c6c 2065 7665 6e74  vents will event
+00012cf0: 7561 6c6c 790a 6265 2070 726f 6365 7373  ually.be process
+00012d00: 6564 2e20 5468 6520 636f 6d62 696e 6174  ed. The combinat
+00012d10: 696f 6e20 6f66 2074 6865 2022 6174 2d6d  ion of the "at-m
+00012d20: 6f73 742d 6f6e 6365 2220 636f 6e64 6974  ost-once" condit
+00012d30: 696f 6e20 616e 6420 7468 6520 2261 742d  ion and the "at-
+00012d40: 6c65 6173 742d 6f6e 6365 220a 636f 6e64  least-once".cond
+00012d50: 6974 696f 6e20 6769 7665 7320 7468 6520  ition gives the 
+00012d60: 2265 7861 6374 6c79 2d6f 6e63 6522 2063  "exactly-once" c
+00012d70: 6f6e 6469 7469 6f6e 2e0a 0a54 6865 2064  ondition...The d
+00012d80: 616e 6765 7220 7769 7468 2022 6475 616c  anger with "dual
+00012d90: 2077 7269 7469 6e67 2220 696e 2074 6865   writing" in the
+00012da0: 2063 6f6e 7375 6d70 7469 6f6e 206f 6620   consumption of 
+00012db0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00012dc0: 6973 2074 6861 7420 6966 2061 0a72 6563  is that if a.rec
+00012dd0: 6f72 6465 6420 6576 656e 7420 6973 2073  orded event is s
+00012de0: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
+00012df0: 6573 7365 6420 616e 6420 6e65 7720 7374  essed and new st
+00012e00: 6174 6520 7265 636f 7264 6564 2061 746f  ate recorded ato
+00012e10: 6d69 6361 6c6c 7920 696e 206f 6e65 0a74  mically in one.t
+00012e20: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
+00012e30: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+00012e40: 696f 6e20 7265 636f 7264 6564 2069 6e20  ion recorded in 
+00012e50: 6120 7365 7061 7261 7465 2074 7261 6e73  a separate trans
+00012e60: 6163 7469 6f6e 2c20 6f6e 6520 6d61 790a  action, one may.
+00012e70: 6861 7070 656e 2061 6e64 206e 6f74 2074  happen and not t
+00012e80: 6865 206f 7468 6572 2e20 4966 2074 6865  he other. If the
+00012e90: 206e 6577 2073 7461 7465 2069 7320 7265   new state is re
+00012ea0: 636f 7264 6564 2062 7574 2074 6865 2070  corded but the p
+00012eb0: 6f73 6974 696f 6e20 6973 206c 6f73 742c  osition is lost,
+00012ec0: 0a61 6e64 2074 6865 6e20 7468 6520 7072  .and then the pr
+00012ed0: 6f63 6573 7369 6e67 2069 7320 7374 6f70  ocessing is stop
+00012ee0: 7065 6420 616e 6420 7265 7375 6d65 642c  ped and resumed,
+00012ef0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00012f00: 656e 7420 6d61 7920 6265 2070 726f 6365  ent may be proce
+00012f10: 7373 6564 0a74 7769 6365 2e20 4f6e 2074  ssed.twice. On t
+00012f20: 6865 206f 7468 6572 2068 616e 642c 2069  he other hand, i
+00012f30: 6620 7468 6520 636f 6d6d 6974 2070 6f73  f the commit pos
+00012f40: 6974 696f 6e20 6973 2072 6563 6f72 6465  ition is recorde
+00012f50: 6420 6275 7420 7468 6520 6e65 7720 7374  d but the new st
+00012f60: 6174 6520 6973 0a6c 6f73 742c 2074 6865  ate is.lost, the
+00012f70: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00012f80: 6d61 7920 6566 6665 6374 6976 656c 7920  may effectively 
+00012f90: 6e6f 7420 6265 2070 726f 6365 7373 6564  not be processed
+00012fa0: 2061 7420 616c 6c2e 2042 7920 6569 7468   at all. By eith
+00012fb0: 6572 0a70 726f 6365 7373 696e 6720 616e  er.processing an
+00012fc0: 2065 7665 6e74 206d 6f72 6520 7468 616e   event more than
+00012fd0: 206f 6e63 652c 206f 7220 6279 2066 6169   once, or by fai
+00012fe0: 6c69 6e67 2074 6f20 7072 6f63 6573 7320  ling to process 
+00012ff0: 616e 2065 7665 6e74 2c20 7468 6520 7265  an event, the re
+00013000: 636f 7264 6564 0a73 7461 7465 206f 6620  corded.state of 
+00013010: 7468 6520 646f 776e 7374 7265 616d 2063  the downstream c
+00013020: 6f6d 706f 6e65 6e74 206d 6967 6874 2062  omponent might b
+00013030: 6520 696e 6163 6375 7261 7465 2c20 6f72  e inaccurate, or
+00013040: 2070 6f73 7369 626c 7920 696e 636f 6e73   possibly incons
+00013050: 6973 7465 6e74 2c20 616e 640a 7065 7268  istent, and.perh
+00013060: 6170 7320 6361 7461 7374 726f 7068 6963  aps catastrophic
+00013070: 616c 6c79 2073 6f2e 2053 7563 6820 636f  ally so. Such co
+00013080: 6e73 6571 7565 6e63 6573 206d 6179 206f  nsequences may o
+00013090: 7220 6d61 7920 6e6f 7420 6d61 7474 6572  r may not matter
+000130a0: 2069 6e20 796f 7572 2073 6974 7561 7469   in your situati
+000130b0: 6f6e 2e0a 4275 7420 736f 6d65 7469 6d65  on..But sometime
+000130c0: 7320 696e 636f 6e73 6973 7465 6e63 6965  s inconsistencie
+000130d0: 7320 6d61 7920 6861 6c74 2070 726f 6365  s may halt proce
+000130e0: 7373 696e 6720 756e 7469 6c20 7468 6520  ssing until the 
+000130f0: 6973 7375 6520 6973 2072 6573 6f6c 7665  issue is resolve
+00013100: 642e 2059 6f75 2063 616e 0a61 766f 6964  d. You can.avoid
+00013110: 2022 6475 616c 2077 7269 7469 6e67 2220   "dual writing" 
+00013120: 696e 2074 6865 2063 6f6e 7375 6d70 7469  in the consumpti
+00013130: 6f6e 206f 6620 6576 656e 7473 2062 7920  on of events by 
+00013140: 6174 6f6d 6963 616c 6c79 2072 6563 6f72  atomically recor
+00013150: 6469 6e67 2074 6865 2063 6f6d 6d69 740a  ding the commit.
+00013160: 706f 7369 7469 6f6e 206f 6620 6120 7265  position of a re
+00013170: 636f 7264 6564 2065 7665 6e74 2061 6c6f  corded event alo
+00013180: 6e67 2077 6974 6820 7468 6520 6e65 7720  ng with the new 
+00013190: 7374 6174 6520 7468 6174 2072 6573 756c  state that resul
+000131a0: 7473 2066 726f 6d20 7072 6f63 6573 7369  ts from processi
+000131b0: 6e67 2074 6861 740a 6576 656e 7420 696e  ng that.event in
+000131c0: 2074 6865 2073 616d 6520 6174 6f6d 6963   the same atomic
+000131d0: 2074 7261 6e73 6163 7469 6f6e 2e20 4279   transaction. By
+000131e0: 206d 616b 696e 6720 7468 6520 7265 636f   making the reco
+000131f0: 7264 696e 6720 6f66 2074 6865 2063 6f6d  rding of the com
+00013200: 6d69 7420 706f 7369 7469 6f6e 730a 756e  mit positions.un
+00013210: 6971 7565 2c20 736f 2074 6861 7420 7472  ique, so that tr
+00013220: 616e 7361 6374 696f 6e73 2077 696c 6c20  ansactions will 
+00013230: 6265 2072 6f6c 6c65 6420 6261 636b 2077  be rolled back w
+00013240: 6865 6e20 7468 6572 6520 6973 2061 2063  hen there is a c
+00013250: 6f6e 666c 6963 742c 2079 6f75 2077 696c  onflict, you wil
+00013260: 6c0a 7072 6576 656e 7420 7468 6520 7265  l.prevent the re
+00013270: 7375 6c74 7320 6f66 2061 6e79 2064 7570  sults of any dup
+00013280: 6c69 6361 7465 2070 726f 6365 7373 696e  licate processin
+00013290: 6720 6f66 2061 2072 6563 6f72 6465 6420  g of a recorded 
+000132a0: 6576 656e 7420 6265 696e 6720 636f 6d6d  event being comm
+000132b0: 6974 7465 642e 0a0a 5265 636f 7264 6564  itted...Recorded
+000132c0: 2065 7665 6e74 7320 7265 6365 6976 6564   events received
+000132d0: 2066 726f 6d20 6120 6361 7463 682d 7570   from a catch-up
+000132e0: 2073 7562 7363 7269 7074 696f 6e20 6361   subscription ca
+000132f0: 6e6e 6f74 2062 6520 6163 6b6e 6f77 6c65  nnot be acknowle
+00013300: 6467 6564 2062 6163 6b0a 746f 2074 6865  dged back.to the
+00013310: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+00013320: 7276 6572 2e20 4163 6b6e 6f77 6c65 6467  rver. Acknowledg
+00013330: 696e 6720 6576 656e 7473 2c20 686f 7765  ing events, howe
+00013340: 7665 722c 2069 7320 616e 2061 7370 6563  ver, is an aspec
+00013350: 7420 6f66 2022 7065 7273 6973 7465 6e74  t of "persistent
+00013360: 0a73 7562 7363 7269 7074 696f 6e73 222e  .subscriptions".
+00013370: 2048 6f70 696e 6720 746f 2072 656c 7920   Hoping to rely 
+00013380: 6f6e 2061 636b 6e6f 776c 6564 6769 6e67  on acknowledging
+00013390: 2065 7665 6e74 7320 746f 2061 6e20 7570   events to an up
+000133a0: 7374 7265 616d 0a63 6f6d 706f 6e65 6e74  stream.component
+000133b0: 2069 7320 616e 2065 7861 6d70 6c65 206f   is an example o
+000133c0: 6620 6475 616c 2077 7269 7469 6e67 2e0a  f dual writing..
+000133d0: 0a0a 2323 2050 6572 7369 7374 656e 7420  ..## Persistent 
+000133e0: 7375 6273 6372 6970 7469 6f6e 730a 0a49  subscriptions..I
+000133f0: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
+00013400: 2270 6572 7369 7374 656e 7422 2073 7562  "persistent" sub
+00013410: 7363 7269 7074 696f 6e73 2061 7265 2073  scriptions are s
+00013420: 696d 696c 6172 2074 6f20 6361 7463 682d  imilar to catch-
+00013430: 7570 2073 7562 7363 7269 7074 696f 6e73  up subscriptions
+00013440: 2c0a 696e 2074 6861 7420 7265 6164 696e  ,.in that readin
+00013450: 6720 6120 7065 7273 6973 7465 6e74 2073  g a persistent s
+00013460: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+00013470: 2062 6c6f 636b 2077 6865 6e20 7468 6572   block when ther
+00013480: 6520 6172 6520 6e6f 206d 6f72 6520 7265  e are no more re
+00013490: 636f 7264 6564 0a65 7665 6e74 7320 746f  corded.events to
+000134a0: 2062 6520 7265 6365 6976 6564 2c20 616e   be received, an
+000134b0: 6420 7468 656e 2063 6f6e 7469 6e75 6520  d then continue 
+000134c0: 7768 656e 206e 6577 2065 7665 6e74 7320  when new events 
+000134d0: 6172 6520 7375 6273 6571 7565 6e74 6c79  are subsequently
+000134e0: 2072 6563 6f72 6465 642e 0a0a 5065 7273   recorded...Pers
+000134f0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00013500: 696f 6e73 2063 616e 0a0a 5065 7273 6973  ions can..Persis
+00013510: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00013520: 6e73 2063 616e 2062 6520 636f 6e73 756d  ns can be consum
+00013530: 6564 2062 7920 6120 6772 6f75 7020 6f66  ed by a group of
+00013540: 2063 6f6e 7375 6d65 7273 206f 7065 7261   consumers opera
+00013550: 7469 6e67 2077 6974 6820 6f6e 650a 6f66  ting with one.of
+00013560: 2074 6865 2073 7570 706f 7274 6564 2022   the supported "
+00013570: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
+00013580: 6965 7322 2e0a 0a54 6865 2073 6967 6e69  ies"...The signi
+00013590: 6669 6361 6e74 2064 6966 6665 7265 6e74  ficant different
+000135a0: 2077 6974 6820 7065 7273 6973 7465 6e74   with persistent
+000135b0: 2073 7562 7363 7269 7074 696f 6e73 2069   subscriptions i
+000135c0: 7320 7468 6520 7365 7276 6572 2077 696c  s the server wil
+000135d0: 6c20 6b65 6570 2074 7261 636b 0a6f 6620  l keep track.of 
+000135e0: 7468 6520 7072 6f67 7265 7373 206f 6620  the progress of 
+000135f0: 7468 6520 636f 6e73 756d 6572 732e 2054  the consumers. T
+00013600: 6865 2063 6f6e 7375 6d65 7220 6f66 2061  he consumer of a
+00013610: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00013620: 6372 6970 7469 6f6e 2077 696c 6c0a 7468  cription will.th
+00013630: 6572 6566 6f72 6520 6e65 6564 2074 6f20  erefore need to 
+00013640: 2261 636b 6e6f 776c 6564 6765 2220 7768  "acknowledge" wh
+00013650: 656e 2061 2072 6563 6f72 6465 6420 6576  en a recorded ev
+00013660: 656e 7420 6861 7320 6265 656e 2070 726f  ent has been pro
+00013670: 6365 7373 6564 2073 7563 6365 7373 6675  cessed successfu
+00013680: 6c6c 792c 0a61 6e64 206f 7468 6572 7769  lly,.and otherwi
+00013690: 7365 2022 6e65 6761 7469 7665 6c79 2061  se "negatively a
+000136a0: 636b 6e6f 776c 6564 6765 2220 6120 7265  cknowledge" a re
+000136b0: 636f 7264 6564 2065 7665 6e74 2074 6861  corded event tha
+000136c0: 7420 6861 7320 6265 656e 2072 6563 6569  t has been recei
+000136d0: 7665 6420 6275 7420 7761 730a 6e6f 7420  ved but was.not 
+000136e0: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+000136f0: 6365 7373 6564 2e0a 0a41 6c6c 206f 6620  cessed...All of 
+00013700: 7468 6973 206d 6561 6e73 2074 6861 7420  this means that 
+00013710: 666f 7220 7065 7273 6973 7465 6e74 2073  for persistent s
+00013720: 7562 7363 7269 7074 696f 6e73 2074 6865  ubscriptions the
+00013730: 7265 2061 7265 2022 6372 6561 7465 222c  re are "create",
+00013740: 2022 7265 6164 222c 2022 7570 6461 7465   "read", "update
+00013750: 220a 2264 656c 6574 6522 2c20 2261 636b  "."delete", "ack
+00013760: 222c 2061 6e64 2022 6e61 636b 2220 6f70  ", and "nack" op
+00013770: 6572 6174 696f 6e73 2074 6f20 636f 6e73  erations to cons
+00013780: 6964 6572 2e0a 0a57 6869 6c73 7420 7468  ider...Whilst th
+00013790: 6572 6520 6172 6520 736f 6d65 2061 6476  ere are some adv
+000137a0: 616e 7461 6765 7320 6f66 2070 6572 7369  antages of persi
+000137b0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+000137c0: 6f6e 732c 2069 6e20 7061 7274 6963 756c  ons, in particul
+000137d0: 6172 2074 6865 0a63 6f6e 6375 7272 656e  ar the.concurren
+000137e0: 7420 7072 6f63 6573 7369 6e67 206f 6620  t processing of 
+000137f0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00013800: 6279 2061 2067 726f 7570 206f 6620 636f  by a group of co
+00013810: 6e73 756d 6572 732c 2062 7920 7472 6163  nsumers, by trac
+00013820: 6b69 6e67 2069 6e0a 7468 6520 7365 7276  king in.the serv
+00013830: 6572 2074 6865 2070 6f73 6974 696f 6e20  er the position 
+00013840: 696e 2074 6865 2063 6f6d 6d69 7420 7365  in the commit se
+00013850: 7175 656e 6365 206f 6620 6576 656e 7473  quence of events
+00013860: 2074 6861 7420 6861 7665 2062 6565 6e20   that have been 
+00013870: 7072 6f63 6573 7365 642c 0a74 6865 2069  processed,.the i
+00013880: 7373 7565 206f 6620 2264 7561 6c20 7772  ssue of "dual wr
+00013890: 6974 696e 6722 2069 6e20 7468 6520 636f  iting" in the co
+000138a0: 6e73 756d 7074 696f 6e20 6f66 2065 7665  nsumption of eve
+000138b0: 6e74 7320 6172 6973 6573 2e20 5265 6c69  nts arises. Reli
+000138c0: 6162 696c 6974 7920 696e 2074 6865 0a70  ability in the.p
+000138d0: 726f 6365 7373 696e 6720 6f66 2072 6563  rocessing of rec
+000138e0: 6f72 6465 6420 6576 656e 7473 2062 7920  orded events by 
+000138f0: 6120 6772 6f75 7020 6f66 2070 6572 7369  a group of persi
+00013900: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00013910: 6f6e 2063 6f6e 7375 6d65 7273 2077 696c  on consumers wil
+00013920: 6c0a 7265 6c79 206f 6e20 7468 6569 7220  l.rely on their 
+00013930: 6964 656d 706f 7465 6e74 2068 616e 646c  idempotent handl
+00013940: 696e 6720 6f66 2064 7570 6c69 6361 7465  ing of duplicate
+00013950: 206d 6573 7361 6765 732c 2061 6e64 2074   messages, and t
+00013960: 6865 6972 2072 6573 696c 6965 6e63 6520  heir resilience 
+00013970: 746f 0a6f 7574 2d6f 662d 6f72 6465 7220  to.out-of-order 
+00013980: 6465 6c69 7665 7279 2e0a 0a0a 2323 2320  delivery....### 
+00013990: 4372 6561 7465 2073 7562 7363 7269 7074  Create subscript
+000139a0: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
+000139b0: 6561 6465 722a 0a0a 5468 6520 6063 7265  eader*..The `cre
+000139c0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+000139d0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+000139e0: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
+000139f0: 2061 2022 7065 7273 6973 7465 6e74 2073   a "persistent s
+00013a00: 7562 7363 7269 7074 696f 6e22 0a74 6f20  ubscription".to 
+00013a10: 616c 6c20 7468 6520 7265 636f 7264 6564  all the recorded
+00013a20: 2065 7665 6e74 7320 696e 2074 6865 2064   events in the d
+00013a30: 6174 6162 6173 6520 6163 726f 7373 2061  atabase across a
+00013a40: 6c6c 2073 7472 6561 6d73 2e0a 0a54 6869  ll streams...Thi
+00013a50: 7320 6d65 7468 6f64 2068 6173 2061 2072  s method has a r
+00013a60: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
+00013a70: 616d 6560 2061 7267 756d 656e 742c 2077  ame` argument, w
+00013a80: 6869 6368 2069 7320 7468 650a 6e61 6d65  hich is the.name
+00013a90: 206f 6620 6120 2267 726f 7570 2220 6f66   of a "group" of
+00013aa0: 2063 6f6e 7375 6d65 7273 206f 6620 7468   consumers of th
+00013ab0: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
+00013ac0: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+00013ad0: 6f20 6861 7320 7365 7665 6e20 6f70 7469  o has seven opti
+00013ae0: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
+00013af0: 6066 726f 6d5f 656e 6460 2c20 6063 6f6d  `from_end`, `com
+00013b00: 6d69 745f 706f 7369 7469 6f6e 602c 0a60  mit_position`,.`
+00013b10: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+00013b20: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+00013b30: 602c 2060 6669 6c74 6572 5f62 795f 7374  `, `filter_by_st
+00013b40: 7265 616d 5f6e 616d 6560 2c20 6063 6f6e  ream_name`, `con
+00013b50: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
+00013b60: 0a61 6e64 2060 7469 6d65 6f75 7460 2e0a  .and `timeout`..
+00013b70: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00013b80: 726f 6d5f 656e 6460 2061 7267 756d 656e  rom_end` argumen
+00013b90: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+00013ba0: 2073 7065 6369 6679 2074 6861 7420 7468   specify that th
+00013bb0: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+00013bc0: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
+00013bd0: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
+00013be0: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
+00013bf0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
+00013c00: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+00013c10: 2073 7562 7363 7269 7074 696f 6e0a 7761   subscription.wa
+00013c20: 7320 6372 6561 7465 642e 0a0a 416c 7465  s created...Alte
+00013c30: 726e 6174 6976 656c 792c 2074 6865 206f  rnatively, the o
+00013c40: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
+00013c50: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00013c60: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+00013c70: 6f20 7370 6563 6966 7920 6120 636f 6d6d  o specify a comm
+00013c80: 6974 0a70 6f73 6974 696f 6e20 6672 6f6d  it.position from
+00013c90: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
+00013ca0: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
+00013cb0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+00013cc0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00013cd0: 6e20 7368 6f75 6c64 0a72 6563 6569 7665  n should.receive
+00013ce0: 2065 7665 6e74 732e 2050 6c65 6173 6520   events. Please 
+00013cf0: 6e6f 7465 2c20 7468 6520 7265 636f 7264  note, the record
+00013d00: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
+00013d10: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
+00013d20: 2070 6f73 6974 696f 6e20 6d69 6768 740a   position might.
+00013d30: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+00013d40: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00013d50: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+00013d60: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00013d70: 756d 6572 732e 0a0a 4966 206e 6569 7468  umers...If neith
+00013d80: 6572 2060 6672 6f6d 5f65 6e64 6020 6f72  er `from_end` or
+00013d90: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00013da0: 6e60 2061 7265 2073 7065 6369 6669 6564  n` are specified
+00013db0: 2c20 7468 6520 6772 6f75 7020 6f66 2063  , the group of c
+00013dc0: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
+00013dd0: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+00013de0: 6c20 706f 7465 6e74 6961 6c6c 7920 7265  l potentially re
+00013df0: 6365 6976 6520 616c 6c20 7265 636f 7264  ceive all record
+00013e00: 6564 2065 7665 6e74 7320 696e 2074 6865  ed events in the
+00013e10: 2064 6174 6162 6173 652e 0a0a 5468 6520   database...The 
+00013e20: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+00013e30: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+00013e40: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+00013e50: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+00013e60: 6573 7369 6f6e 7320 7468 6174 0a73 7065  essions that.spe
+00013e70: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
+00013e80: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
+00013e90: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
+00013ea0: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
+00013eb0: 7320 6967 6e6f 7265 640a 6966 2060 6669  s ignored.if `fi
+00013ec0: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
+00013ed0: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+00013ee0: 7074 7920 7365 7175 656e 6365 2e20 5468  pty sequence. Th
+00013ef0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00013f00: 6f66 2074 6869 730a 6172 6775 6d65 6e74  of this.argument
+00013f10: 206d 6174 6368 6573 2074 6865 2065 7665   matches the eve
+00013f20: 6e74 2074 7970 6573 206f 6620 4576 656e  nt types of Even
+00013f30: 7453 746f 7265 4442 2022 7379 7374 656d  tStoreDB "system
+00013f40: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
+00013f50: 7420 7379 7374 656d 0a65 7665 6e74 7320  t system.events 
+00013f60: 7769 6c6c 206e 6f74 206e 6f72 6d61 6c6c  will not normall
+00013f70: 7920 6265 2069 6e63 6c75 6465 642e 2053  y be included. S
+00013f80: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
+00013f90: 7469 6f6e 2062 656c 6f77 2066 6f72 206d  tion below for m
+00013fa0: 6f72 650a 696e 666f 726d 6174 696f 6e20  ore.information 
+00013fb0: 6162 6f75 7420 6669 6c74 6572 2065 7870  about filter exp
+00013fc0: 7265 7373 696f 6e73 2e0a 0a54 6865 206f  ressions...The o
+00013fd0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+00013fe0: 696e 636c 7564 6560 2061 7267 756d 656e  include` argumen
+00013ff0: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+00014000: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+00014010: 7373 696f 6e73 0a74 6861 7420 7370 6563  ssions.that spec
+00014020: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
+00014030: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
+00014040: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
+00014050: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+00014060: 0a61 7267 756d 656e 7420 6973 2061 6e20  .argument is an 
+00014070: 656d 7074 7920 7475 706c 652e 2049 6620  empty tuple. If 
+00014080: 7468 6973 2061 7267 756d 656e 7420 6973  this argument is
+00014090: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+000140a0: 7074 7920 7365 7175 656e 6365 2c0a 7468  pty sequence,.th
+000140b0: 6520 6066 696c 7465 725f 6578 636c 7564  e `filter_exclud
+000140c0: 6560 2061 7267 756d 656e 7420 6973 2069  e` argument is i
+000140d0: 676e 6f72 6564 2e0a 0a54 6865 206f 7074  gnored...The opt
+000140e0: 696f 6e61 6c20 6066 696c 7465 725f 6279  ional `filter_by
+000140f0: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
+00014100: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00014110: 6f6e 2060 626f 6f6c 6020 7468 6174 2069  on `bool` that i
+00014120: 6e64 6963 6174 6573 0a77 6865 7468 6572  ndicates.whether
+00014130: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
+00014140: 696c 6c20 6170 706c 7920 746f 2065 7665  ill apply to eve
+00014150: 6e74 2074 7970 6573 206f 7220 7374 7265  nt types or stre
+00014160: 616d 206e 616d 6573 2e20 4279 2064 6566  am names. By def
+00014170: 6175 6c74 2c20 7468 6973 0a76 616c 7565  ault, this.value
+00014180: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
+00014190: 736f 2074 6865 2066 696c 7465 7269 6e67  so the filtering
+000141a0: 2077 696c 6c20 6170 706c 7920 746f 2074   will apply to t
+000141b0: 6865 2065 7665 6e74 2074 7970 6520 7374  he event type st
+000141c0: 7269 6e67 7320 6f66 0a72 6563 6f72 6465  rings of.recorde
+000141d0: 6420 6576 656e 7473 2e0a 0a54 6865 206f  d events...The o
+000141e0: 7074 696f 6e61 6c20 6063 6f6e 7375 6d65  ptional `consume
+000141f0: 725f 7374 7261 7465 6779 6020 6172 6775  r_strategy` argu
+00014200: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00014210: 2060 7374 7260 2074 6861 7420 6465 6669   `str` that defi
+00014220: 6e65 730a 7468 6520 636f 6e73 756d 6572  nes.the consumer
+00014230: 2073 7472 6174 6567 7920 666f 7220 7468   strategy for th
+00014240: 6973 2070 6572 7369 7374 656e 7420 7375  is persistent su
+00014250: 6273 6372 6970 7469 6f6e 2e20 5468 6520  bscription. The 
+00014260: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
+00014270: 6775 6d65 6e74 0a63 616e 2062 6520 6027  gument.can be `'
+00014280: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
+00014290: 2760 2c20 6027 526f 756e 6452 6f62 696e  '`, `'RoundRobin
+000142a0: 2760 2c20 6027 5069 6e6e 6564 2760 2c20  '`, `'Pinned'`, 
+000142b0: 6f72 2060 2750 696e 6e65 6442 7943 6f72  or `'PinnedByCor
+000142c0: 7265 6c61 7469 6f6e 2760 2e20 5468 650a  relation'`. The.
+000142d0: 6465 6661 756c 7420 7661 6c75 6520 6973  default value is
+000142e0: 2060 2744 6973 7061 7463 6854 6f53 696e   `'DispatchToSin
+000142f0: 676c 6527 602e 0a0a 5468 6520 6f70 7469  gle'`...The opti
+00014300: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00014310: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00014320: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+00014330: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
+00014340: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+00014350: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00014360: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+00014370: 206d 6574 686f 6420 6063 7265 6174 655f   method `create_
+00014380: 7375 6273 6372 6970 7469 6f6e 2829 6020  subscription()` 
+00014390: 646f 6573 206e 6f74 2072 6574 7572 6e20  does not return 
+000143a0: 6120 7661 6c75 652e 2052 6563 6f72 6465  a value. Recorde
+000143b0: 6420 6576 656e 7473 2061 7265 0a6f 6274  d events are.obt
+000143c0: 6169 6e65 6420 6279 2063 616c 6c69 6e67  ained by calling
+000143d0: 2074 6865 2060 7265 6164 5f73 7562 7363   the `read_subsc
+000143e0: 7269 7074 696f 6e28 2960 206d 6574 686f  ription()` metho
+000143f0: 642e 0a0a 496e 2074 6865 2065 7861 6d70  d...In the examp
+00014400: 6c65 2062 656c 6f77 2c20 6120 7065 7273  le below, a pers
+00014410: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00014420: 696f 6e20 6973 2063 7265 6174 6564 2074  ion is created t
+00014430: 6f20 6f70 6572 6174 6520 6672 6f6d 2074  o operate from t
+00014440: 6865 0a66 6972 7374 2072 6563 6f72 6465  he.first recorde
+00014450: 6420 6e6f 6e2d 7379 7374 656d 2065 7665  d non-system eve
+00014460: 6e74 2069 6e20 7468 6520 6461 7461 6261  nt in the databa
+00014470: 7365 2e0a 0a60 6060 7079 7468 6f6e 0a23  se...```python.#
+00014480: 2043 7265 6174 6520 6120 7065 7273 6973   Create a persis
+00014490: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+000144a0: 6e2e 0a67 726f 7570 5f6e 616d 6531 203d  n..group_name1 =
+000144b0: 2066 2267 726f 7570 2d7b 7575 6964 2e75   f"group-{uuid.u
+000144c0: 7569 6434 2829 7d22 0a63 6c69 656e 742e  uid4()}".client.
+000144d0: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+000144e0: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
+000144f0: 726f 7570 5f6e 616d 6531 290a 6060 600a  roup_name1).```.
+00014500: 0a23 2323 2052 6561 6420 7375 6273 6372  .### Read subscr
+00014510: 6970 7469 6f6e 0a0a 2a72 6571 7569 7265  iption..*require
+00014520: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+00014530: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
+00014540: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
+00014550: 6265 2075 7365 6420 6279 2061 2067 726f  be used by a gro
+00014560: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
+00014570: 746f 2072 6563 6569 7665 0a72 6563 6f72  to receive.recor
+00014580: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
+00014590: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+000145a0: 7363 7269 7074 696f 6e20 7468 6174 2068  scription that h
+000145b0: 6173 2062 6565 6e20 6372 6561 7465 6420  as been created 
+000145c0: 7573 696e 670a 7468 6520 6063 7265 6174  using.the `creat
+000145d0: 655f 7375 6273 6372 6970 7469 6f6e 2829  e_subscription()
+000145e0: 6020 6d65 7468 6f64 2e0a 0a54 6869 7320  ` method...This 
+000145f0: 6d65 7468 6f64 2068 6173 2061 2072 6571  method has a req
+00014600: 7569 7265 6420 6067 726f 7570 5f6e 616d  uired `group_nam
+00014610: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
+00014620: 6368 2069 730a 7468 6520 6e61 6d65 206f  ch is.the name o
+00014630: 6620 6120 2267 726f 7570 2220 6f66 2063  f a "group" of c
+00014640: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
+00014650: 7375 6273 6372 6970 7469 6f6e 2073 7065  subscription spe
+00014660: 6369 6669 6564 0a77 6865 6e20 6063 7265  cified.when `cre
+00014670: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00014680: 2829 6020 7761 7320 6361 6c6c 6564 2e0a  ()` was called..
+00014690: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+000146a0: 6f20 6861 7320 616e 206f 7074 696f 6e61  o has an optiona
+000146b0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+000146c0: 6d65 6e74 2c20 7468 6174 0a69 7320 6578  ment, that.is ex
+000146d0: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
+000146e0: 7974 686f 6e20 6066 6c6f 6174 602c 2077  ython `float`, w
+000146f0: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
+00014700: 6c69 6e65 0a66 6f72 2074 6865 2063 6f6d  line.for the com
+00014710: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00014720: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+00014730: 5468 6973 206d 6574 686f 6420 7265 7475  This method retu
+00014740: 726e 7320 6120 6050 6572 7369 7374 656e  rns a `Persisten
+00014750: 7453 7562 7363 7269 7074 696f 6e60 206f  tSubscription` o
+00014760: 626a 6563 742c 2077 6869 6368 2069 7320  bject, which is 
+00014770: 616e 2069 7465 7261 746f 720a 6769 7669  an iterator.givi
+00014780: 6e67 2060 5265 636f 7264 6564 4576 656e  ng `RecordedEven
+00014790: 7460 206f 626a 6563 7473 2e20 4974 2061  t` objects. It a
+000147a0: 6c73 6f20 6861 7320 6061 636b 2829 602c  lso has `ack()`,
+000147b0: 2060 6e61 636b 2829 6020 616e 6420 6073   `nack()` and `s
+000147c0: 746f 7028 2960 0a6d 6574 686f 6473 2e0a  top()`.methods..
+000147d0: 0a60 6060 7079 7468 6f6e 0a73 7562 7363  .```python.subsc
+000147e0: 7269 7074 696f 6e20 3d20 636c 6965 6e74  ription = client
+000147f0: 2e72 6561 645f 7375 6273 6372 6970 7469  .read_subscripti
+00014800: 6f6e 2867 726f 7570 5f6e 616d 653d 6772  on(group_name=gr
+00014810: 6f75 705f 6e61 6d65 3129 0a60 6060 0a0a  oup_name1).```..
+00014820: 5468 6520 6061 636b 2829 6020 6d65 7468  The `ack()` meth
+00014830: 6f64 2073 686f 756c 6420 6265 2075 7365  od should be use
+00014840: 6420 6279 2061 2063 6f6e 7375 6d65 7220  d by a consumer 
+00014850: 746f 2069 6e64 6963 6174 6520 746f 2074  to indicate to t
+00014860: 6865 2073 6572 7665 7220 7468 6174 2069  he server that i
+00014870: 740a 6861 7320 7265 6365 6976 6564 2061  t.has received a
+00014880: 6e64 2073 7563 6365 7373 6675 6c6c 7920  nd successfully 
+00014890: 7072 6f63 6573 7365 6420 6120 7265 636f  processed a reco
+000148a0: 7264 6564 2065 7665 6e74 2e20 5468 6973  rded event. This
+000148b0: 2077 696c 6c20 7072 6576 656e 7420 7468   will prevent th
+000148c0: 6174 0a72 6563 6f72 6465 6420 6576 656e  at.recorded even
+000148d0: 7420 6265 696e 6720 7265 6365 6976 6564  t being received
+000148e0: 2062 7920 616e 6f74 6865 7220 636f 6e73   by another cons
+000148f0: 756d 6572 2069 6e20 7468 6520 7361 6d65  umer in the same
+00014900: 2067 726f 7570 2e20 5468 6520 6061 636b   group. The `ack
+00014910: 2829 600a 6d65 7468 6f64 2074 616b 6573  ()`.method takes
+00014920: 2061 6e20 6065 7665 6e74 5f69 6460 2061   an `event_id` a
+00014930: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+00014940: 7320 7468 6520 4944 206f 6620 7468 6520  s the ID of the 
+00014950: 7265 636f 7264 6564 2065 7665 6e74 2074  recorded event t
+00014960: 6861 740a 6861 7320 6265 656e 2072 6563  hat.has been rec
+00014970: 6569 7665 642e 0a0a 5468 6520 6578 616d  eived...The exam
+00014980: 706c 6520 6265 6c6f 7720 6974 6572 6174  ple below iterat
+00014990: 6573 206f 7665 7220 7468 6520 7375 6273  es over the subs
+000149a0: 6372 6970 7469 6f6e 206f 626a 6563 742c  cription object,
+000149b0: 2061 6e64 2063 616c 6c73 2060 6163 6b28   and calls `ack(
+000149c0: 2960 2e20 5468 650a 6073 746f 7028 2960  )`. The.`stop()`
+000149d0: 206d 6574 686f 6420 6973 2063 616c 6c65   method is calle
+000149e0: 6420 7768 656e 2077 6520 6861 7665 2072  d when we have r
+000149f0: 6563 6569 7665 6420 7468 6520 6c61 7374  eceived the last
+00014a00: 2065 7665 6e74 2c20 736f 2074 6861 7420   event, so that 
+00014a10: 7765 2063 616e 0a63 6f6e 7469 6e75 6520  we can.continue 
+00014a20: 7769 7468 2074 6865 2065 7861 6d70 6c65  with the example
+00014a30: 7320 6265 6c6f 772e 0a0a 6060 6070 7974  s below...```pyt
+00014a40: 686f 6e0a 6576 656e 7473 203d 205b 5d0a  hon.events = [].
+00014a50: 666f 7220 6576 656e 7420 696e 2073 7562  for event in sub
+00014a60: 7363 7269 7074 696f 6e3a 0a20 2020 2065  scription:.    e
+00014a70: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
+00014a80: 6e74 290a 0a20 2020 2023 2041 636b 6e6f  nt)..    # Ackno
+00014a90: 776c 6564 6765 2074 6865 2072 6563 6569  wledge the recei
+00014aa0: 7665 6420 6576 656e 742e 0a20 2020 2073  ved event..    s
+00014ab0: 7562 7363 7269 7074 696f 6e2e 6163 6b28  ubscription.ack(
+00014ac0: 6576 656e 745f 6964 3d65 7665 6e74 2e69  event_id=event.i
+00014ad0: 6429 0a0a 2020 2020 2320 5374 6f70 2077  d)..    # Stop w
+00014ae0: 6865 6e20 2765 7665 6e74 3927 2068 6173  hen 'event9' has
+00014af0: 2062 6565 6e20 7265 6365 6976 6564 2e0a   been received..
+00014b00: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+00014b10: 3d3d 2065 7665 6e74 392e 6964 3a0a 2020  == event9.id:.  
+00014b20: 2020 2020 2020 7375 6273 6372 6970 7469        subscripti
+00014b30: 6f6e 2e73 746f 7028 290a 6060 600a 0a54  on.stop().```..T
+00014b40: 6865 2072 6563 6569 7665 6420 6576 656e  he received even
+00014b50: 7473 2061 7265 2074 6865 2065 7665 6e74  ts are the event
+00014b60: 7320 7765 2061 7070 656e 6465 6420 6162  s we appended ab
+00014b70: 6f76 652e 0a0a 6060 6070 7974 686f 6e0a  ove...```python.
+00014b80: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
+00014b90: 345d 2e69 6420 3d3d 2065 7665 6e74 312e  4].id == event1.
+00014ba0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00014bb0: 5b2d 3133 5d2e 6964 203d 3d20 6576 656e  [-13].id == even
+00014bc0: 7432 2e69 640a 6173 7365 7274 2065 7665  t2.id.assert eve
+00014bd0: 6e74 735b 2d31 325d 2e69 6420 3d3d 2065  nts[-12].id == e
+00014be0: 7665 6e74 332e 6964 0a61 7373 6572 7420  vent3.id.assert 
+00014bf0: 6576 656e 7473 5b2d 3131 5d2e 7479 7065  events[-11].type
+00014c00: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
+00014c10: 6564 220a 6173 7365 7274 2065 7665 6e74  ed".assert event
+00014c20: 735b 2d31 305d 2e74 7970 6520 3d3d 2022  s[-10].type == "
+00014c30: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
+00014c40: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+00014c50: 395d 2e74 7970 6520 3d3d 2022 446f 674c  9].type == "DogL
+00014c60: 6561 726e 6564 5472 6963 6b22 0a61 7373  earnedTrick".ass
+00014c70: 6572 7420 6576 656e 7473 5b2d 385d 2e74  ert events[-8].t
+00014c80: 7970 6520 3d3d 2022 536e 6170 7368 6f74  ype == "Snapshot
+00014c90: 220a 6173 7365 7274 2065 7665 6e74 735b  ".assert events[
+00014ca0: 2d37 5d2e 7479 7065 203d 3d20 2244 6f67  -7].type == "Dog
+00014cb0: 4c65 6172 6e65 6454 7269 636b 220a 6173  LearnedTrick".as
+00014cc0: 7365 7274 2065 7665 6e74 735b 2d36 5d2e  sert events[-6].
+00014cd0: 6964 203d 3d20 6576 656e 7434 2e69 640a  id == event4.id.
+00014ce0: 6173 7365 7274 2065 7665 6e74 735b 2d35  assert events[-5
+00014cf0: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
+00014d00: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
+00014d10: 2d34 5d2e 6964 203d 3d20 6576 656e 7436  -4].id == event6
+00014d20: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+00014d30: 735b 2d33 5d2e 6964 203d 3d20 6576 656e  s[-3].id == even
+00014d40: 7437 2e69 640a 6173 7365 7274 2065 7665  t7.id.assert eve
+00014d50: 6e74 735b 2d32 5d2e 6964 203d 3d20 6576  nts[-2].id == ev
+00014d60: 656e 7438 2e69 640a 6173 7365 7274 2065  ent8.id.assert e
+00014d70: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
+00014d80: 6576 656e 7439 2e69 640a 6060 600a 0a54  event9.id.```..T
+00014d90: 6865 2060 5065 7273 6973 7465 6e74 5375  he `PersistentSu
+00014da0: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
+00014db0: 6374 2061 6c73 6f20 6861 7320 616e 2060  ct also has an `
+00014dc0: 6e61 636b 2829 6020 6d65 7468 6f64 2074  nack()` method t
+00014dd0: 6861 7420 7368 6f75 6c64 2062 6520 7573  hat should be us
+00014de0: 6564 0a62 7920 6120 636f 6e73 756d 6572  ed.by a consumer
+00014df0: 2074 6f20 6e65 6761 7469 7665 6c79 2061   to negatively a
+00014e00: 636b 6e6f 776c 6564 6765 2074 6f20 7468  cknowledge to th
+00014e10: 6520 7365 7276 6572 2074 6861 7420 6974  e server that it
+00014e20: 2068 6173 2072 6563 6569 7665 6420 6275   has received bu
+00014e30: 7420 6e6f 740a 7375 6363 6573 7366 756c  t not.successful
+00014e40: 6c79 2070 726f 6365 7373 6564 2061 2072  ly processed a r
+00014e50: 6563 6f72 6465 6420 6576 656e 742e 2054  ecorded event. T
+00014e60: 6865 2060 6e61 636b 2829 6020 6d65 7468  he `nack()` meth
+00014e70: 6f64 2074 616b 6573 2061 6e20 6065 7665  od takes an `eve
+00014e80: 6e74 5f69 6460 0a61 7267 756d 656e 742c  nt_id`.argument,
+00014e90: 2077 6869 6368 2069 7320 7468 6520 4944   which is the ID
+00014ea0: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
+00014eb0: 2065 7665 6e74 2074 6861 7420 6861 7320   event that has 
+00014ec0: 6265 656e 2072 6563 6569 7665 642c 2061  been received, a
+00014ed0: 6e64 2061 6e20 6061 6374 696f 6e60 0a61  nd an `action`.a
+00014ee0: 7267 756d 656e 742c 2077 6869 6368 2073  rgument, which s
+00014ef0: 686f 756c 6420 6265 2061 2050 7974 686f  hould be a Pytho
+00014f00: 6e20 6073 7472 602c 2065 6974 6865 7220  n `str`, either 
+00014f10: 6027 756e 6b6e 6f77 6e27 602c 2060 2770  `'unknown'`, `'p
+00014f20: 6172 6b27 602c 2060 2772 6574 7279 2760  ark'`, `'retry'`
+00014f30: 2c0a 6027 736b 6970 2760 206f 7220 6027  ,.`'skip'` or `'
+00014f40: 7374 6f70 2760 2e0a 0a0a 2323 2320 486f  stop'`....### Ho
+00014f50: 7720 746f 2077 7269 7465 2061 2070 6572  w to write a per
+00014f60: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00014f70: 7469 6f6e 2063 6f6e 7375 6d65 720a 0a54  tion consumer..T
+00014f80: 6865 2072 6561 6469 6e67 206f 6620 6120  he reading of a 
+00014f90: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00014fa0: 7269 7074 696f 6e20 6361 6e20 6265 2065  ription can be e
+00014fb0: 6e63 6170 7375 6c61 7465 6420 696e 2061  ncapsulated in a
+00014fc0: 2022 636f 6e73 756d 6572 2220 7468 6174   "consumer" that
+00014fd0: 2063 616c 6c73 0a61 2022 706f 6c69 6379   calls.a "policy
+00014fe0: 2220 6675 6e63 7469 6f6e 2077 6865 6e20  " function when 
+00014ff0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+00015000: 2069 7320 7265 6365 6976 6564 2061 6e64   is received and
+00015010: 2074 6865 6e20 6175 746f 6d61 7469 6361   then automatica
+00015020: 6c6c 7920 6361 6c6c 730a 6061 636b 2829  lly calls.`ack()
+00015030: 6020 6966 2074 6865 2070 6f6c 6963 7920  ` if the policy 
+00015040: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
+00015050: 206e 6f72 6d61 6c6c 792c 2061 6e64 2060   normally, and `
+00015060: 6e61 636b 2829 6020 6966 2069 7420 7261  nack()` if it ra
+00015070: 6973 6573 2061 6e20 6578 6365 7074 696f  ises an exceptio
+00015080: 6e2c 0a70 6572 6861 7073 2072 6574 7279  n,.perhaps retry
+00015090: 696e 6720 7468 6520 6576 656e 7420 666f  ing the event fo
+000150a0: 7220 6120 6365 7274 6169 6e20 6e75 6d62  r a certain numb
+000150b0: 6572 206f 6620 7469 6d65 7320 6265 666f  er of times befo
+000150c0: 7265 2070 6172 6b69 6e67 2074 6865 2065  re parking the e
+000150d0: 7665 6e74 2e0a 0a54 6865 2073 696d 706c  vent...The simpl
+000150e0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+000150f0: 7368 6f77 7320 686f 7720 7468 6973 206d  shows how this m
+00015100: 6967 6874 2062 6520 646f 6e65 2e20 5765  ight be done. We
+00015110: 2063 616e 2073 6565 2074 6861 7420 2765   can see that 'e
+00015120: 7665 6e74 3927 2069 730a 6163 6b6e 6f77  vent9' is.acknow
+00015130: 6c65 6467 6564 2062 6566 6f72 6520 2765  ledged before 'e
+00015140: 7665 6e74 3527 2069 7320 6669 6e61 6c6c  vent5' is finall
+00015150: 7920 7061 726b 6564 2e0a 0a0a 6060 6070  y parked....```p
+00015160: 7974 686f 6e0a 6163 6b65 645f 6576 656e  ython.acked_even
+00015170: 7473 203d 207b 7d0a 6e61 636b 6564 5f65  ts = {}.nacked_e
+00015180: 7665 6e74 7320 3d20 7b7d 0a0a 0a63 6c61  vents = {}...cla
+00015190: 7373 2045 7861 6d70 6c65 436f 6e73 756d  ss ExampleConsum
+000151a0: 6572 3a0a 2020 2020 6465 6620 5f5f 696e  er:.    def __in
+000151b0: 6974 5f5f 2873 656c 662c 2073 7562 7363  it__(self, subsc
+000151c0: 7269 7074 696f 6e2c 206d 6178 5f72 6574  ription, max_ret
+000151d0: 7269 6573 2c20 6669 6e61 6c5f 6163 7469  ries, final_acti
+000151e0: 6f6e 293a 0a20 2020 2020 2020 2073 656c  on):.        sel
+000151f0: 662e 7375 6273 6372 6970 7469 6f6e 203d  f.subscription =
+00015200: 2073 7562 7363 7269 7074 696f 6e0a 2020   subscription.  
+00015210: 2020 2020 2020 7365 6c66 2e6d 6178 5f72        self.max_r
+00015220: 6574 7269 6573 203d 206d 6178 5f72 6574  etries = max_ret
+00015230: 7269 6573 0a20 2020 2020 2020 2073 656c  ries.        sel
+00015240: 662e 6669 6e61 6c5f 6163 7469 6f6e 203d  f.final_action =
+00015250: 2066 696e 616c 5f61 6374 696f 6e0a 2020   final_action.  
+00015260: 2020 2020 2020 7365 6c66 2e65 7272 6f72        self.error
+00015270: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
+00015280: 2072 756e 2873 656c 6629 3a0a 2020 2020   run(self):.    
+00015290: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+000152a0: 2020 2020 2066 6f72 2065 7665 6e74 2069       for event i
+000152b0: 6e20 7365 6c66 2e73 7562 7363 7269 7074  n self.subscript
+000152c0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+000152d0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+000152e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000152f0: 6c66 2e70 6f6c 6963 7928 6576 656e 7429  lf.policy(event)
+00015300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015310: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00015320: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+00015330: 2020 2020 2020 2069 6620 6576 656e 742e         if event.
+00015340: 7265 7472 795f 636f 756e 7420 3c20 7365  retry_count < se
+00015350: 6c66 2e6d 6178 5f72 6574 7269 6573 3a0a  lf.max_retries:.
+00015360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015370: 2020 2020 2020 2020 6163 7469 6f6e 203d          action =
+00015380: 2022 7265 7472 7922 0a20 2020 2020 2020   "retry".       
+00015390: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000153a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000153b0: 2020 2020 2020 2020 2020 2061 6374 696f             actio
+000153c0: 6e20 3d20 7365 6c66 2e66 696e 616c 5f61  n = self.final_a
+000153d0: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
+000153e0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+000153f0: 7562 7363 7269 7074 696f 6e2e 6e61 636b  ubscription.nack
+00015400: 2865 7665 6e74 2e69 642c 2061 6374 696f  (event.id, actio
+00015410: 6e3d 6163 7469 6f6e 290a 2020 2020 2020  n=action).      
+00015420: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00015430: 6c66 2e61 6674 6572 5f6e 6163 6b28 6576  lf.after_nack(ev
+00015440: 656e 742c 2061 6374 696f 6e29 0a20 2020  ent, action).   
+00015450: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00015460: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015470: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
+00015480: 6372 6970 7469 6f6e 2e61 636b 2865 7665  cription.ack(eve
+00015490: 6e74 2e69 6429 0a20 2020 2020 2020 2020  nt.id).         
+000154a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000154b0: 6166 7465 725f 6163 6b28 6576 656e 7429  after_ack(event)
+000154c0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+000154d0: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
+000154e0: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
+000154f0: 6372 6970 7469 6f6e 2e73 746f 7028 290a  cription.stop().
+00015500: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00015510: 650a 0a20 2020 2064 6566 2073 746f 7028  e..    def stop(
+00015520: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
+00015530: 656c 662e 7375 6273 6372 6970 7469 6f6e  elf.subscription
+00015540: 2e73 746f 7028 290a 0a20 2020 2064 6566  .stop()..    def
+00015550: 2070 6f6c 6963 7928 7365 6c66 2c20 6576   policy(self, ev
+00015560: 656e 7429 3a0a 2020 2020 2020 2020 2320  ent):.        # 
+00015570: 5261 6973 6520 616e 2065 7863 6570 7469  Raise an excepti
+00015580: 6f6e 2077 6865 6e20 7765 2073 6565 2022  on when we see "
+00015590: 6576 656e 7435 222e 0a20 2020 2020 2020  event5"..       
+000155a0: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
+000155b0: 6576 656e 7435 2e69 643a 0a20 2020 2020  event5.id:.     
+000155c0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+000155d0: 6570 7469 6f6e 2829 0a0a 2020 2020 6465  eption()..    de
+000155e0: 6620 6166 7465 725f 6163 6b28 7365 6c66  f after_ack(self
+000155f0: 2c20 6576 656e 7429 3a0a 2020 2020 2020  , event):.      
+00015600: 2020 2320 5472 6163 6b20 7265 7472 7920    # Track retry 
+00015610: 636f 756e 7420 6f66 2061 636b 6564 2065  count of acked e
+00015620: 7665 6e74 732e 0a20 2020 2020 2020 2061  vents..        a
+00015630: 636b 6564 5f65 7665 6e74 735b 6576 656e  cked_events[even
+00015640: 742e 6964 5d20 3d20 6576 656e 742e 7265  t.id] = event.re
+00015650: 7472 795f 636f 756e 740a 0a20 2020 2064  try_count..    d
+00015660: 6566 2061 6674 6572 5f6e 6163 6b28 7365  ef after_nack(se
+00015670: 6c66 2c20 6576 656e 742c 2061 6374 696f  lf, event, actio
+00015680: 6e29 3a0a 2020 2020 2020 2020 2320 5472  n):.        # Tr
+00015690: 6163 6b20 7265 7472 7920 636f 756e 7420  ack retry count 
+000156a0: 6f66 206e 6163 6b65 6420 6576 656e 7473  of nacked events
+000156b0: 2e0a 2020 2020 2020 2020 6e61 636b 6564  ..        nacked
+000156c0: 5f65 7665 6e74 735b 6576 656e 742e 6964  _events[event.id
+000156d0: 5d20 3d20 6576 656e 742e 7265 7472 795f  ] = event.retry_
+000156e0: 636f 756e 740a 0a20 2020 2020 2020 2069  count..        i
+000156f0: 6620 6163 7469 6f6e 203d 3d20 7365 6c66  f action == self
+00015700: 2e66 696e 616c 5f61 6374 696f 6e3a 0a20  .final_action:. 
+00015710: 2020 2020 2020 2020 2020 2023 2053 746f             # Sto
+00015720: 7020 7468 6520 636f 6e73 756d 6572 2c20  p the consumer, 
+00015730: 736f 2077 6520 6361 6e20 636f 6e74 696e  so we can contin
+00015740: 7565 2077 6974 6820 7468 6520 6578 616d  ue with the exam
+00015750: 706c 6573 2e0a 2020 2020 2020 2020 2020  ples..          
+00015760: 2020 7365 6c66 2e73 746f 7028 290a 0a0a    self.stop()...
+00015770: 2320 4372 6561 7465 2073 7562 7363 7269  # Create subscri
+00015780: 7074 696f 6e2e 0a67 726f 7570 5f6e 616d  ption..group_nam
+00015790: 6520 3d20 6622 6772 6f75 702d 7b75 7569  e = f"group-{uui
+000157a0: 642e 7575 6964 3428 297d 220a 636c 6965  d.uuid4()}".clie
+000157b0: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
+000157c0: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
+000157d0: 652c 2063 6f6d 6d69 745f 706f 7369 7469  e, commit_positi
+000157e0: 6f6e 3d63 6f6d 6d69 745f 706f 7369 7469  on=commit_positi
+000157f0: 6f6e 3129 0a0a 2320 5265 6164 2073 7562  on1)..# Read sub
+00015800: 7363 7269 7074 696f 6e2e 0a73 7562 7363  scription..subsc
+00015810: 7269 7074 696f 6e20 3d20 636c 6965 6e74  ription = client
+00015820: 2e72 6561 645f 7375 6273 6372 6970 7469  .read_subscripti
+00015830: 6f6e 2867 726f 7570 5f6e 616d 6529 0a0a  on(group_name)..
+00015840: 2320 436f 6e73 7472 7563 7420 636f 6e73  # Construct cons
+00015850: 756d 6572 2e0a 636f 6e73 756d 6572 203d  umer..consumer =
+00015860: 2045 7861 6d70 6c65 436f 6e73 756d 6572   ExampleConsumer
+00015870: 280a 2020 2020 7375 6273 6372 6970 7469  (.    subscripti
+00015880: 6f6e 3d73 7562 7363 7269 7074 696f 6e2c  on=subscription,
+00015890: 0a20 2020 206d 6178 5f72 6574 7269 6573  .    max_retries
+000158a0: 3d35 2c0a 2020 2020 6669 6e61 6c5f 6163  =5,.    final_ac
+000158b0: 7469 6f6e 3d22 7061 726b 222c 0a29 0a0a  tion="park",.)..
+000158c0: 2320 5275 6e20 636f 6e73 756d 6572 2e0a  # Run consumer..
+000158d0: 636f 6e73 756d 6572 2e72 756e 2829 0a0a  consumer.run()..
+000158e0: 2320 4368 6563 6b20 2765 7665 6e74 3927  # Check 'event9'
+000158f0: 2077 6173 2061 636b 6564 2061 6e64 206e   was acked and n
+00015900: 6576 6572 2072 6574 7269 6564 2e0a 6173  ever retried..as
+00015910: 7365 7274 2061 636b 6564 5f65 7665 6e74  sert acked_event
+00015920: 735b 6576 656e 7439 2e69 645d 203d 3d20  s[event9.id] == 
+00015930: 300a 6173 7365 7274 2065 7665 6e74 392e  0.assert event9.
+00015940: 6964 206e 6f74 2069 6e20 6e61 636b 6564  id not in nacked
+00015950: 5f65 7665 6e74 730a 0a23 2043 6865 636b  _events..# Check
+00015960: 2027 6576 656e 7435 2720 7761 7320 7265   'event5' was re
+00015970: 7472 6965 6420 6669 7665 2074 696d 6573  tried five times
+00015980: 2061 6e64 206e 6576 6572 2061 636b 6564   and never acked
+00015990: 2e0a 6173 7365 7274 206e 6163 6b65 645f  ..assert nacked_
+000159a0: 6576 656e 7473 5b65 7665 6e74 352e 6964  events[event5.id
+000159b0: 5d20 3d3d 2035 0a61 7373 6572 7420 6576  ] == 5.assert ev
+000159c0: 656e 7435 2e69 6420 6e6f 7420 696e 2061  ent5.id not in a
+000159d0: 636b 6564 5f65 7665 6e74 730a 6060 600a  cked_events.```.
+000159e0: 0a23 2323 2047 6574 2073 7562 7363 7269  .### Get subscri
+000159f0: 7074 696f 6e20 696e 666f 0a0a 2a72 6571  ption info..*req
+00015a00: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+00015a10: 6865 2060 6765 745f 7375 6273 6372 6970  he `get_subscrip
+00015a20: 7469 6f6e 5f69 6e66 6f28 2960 206d 6574  tion_info()` met
+00015a30: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00015a40: 746f 2067 6574 2069 6e66 6f72 6d61 7469  to get informati
+00015a50: 6f6e 2066 6f72 2061 0a70 6572 7369 7374  on for a.persist
+00015a60: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00015a70: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+00015a80: 6173 206f 6e65 2072 6571 7569 7265 6420  as one required 
+00015a90: 6172 6775 6d65 6e74 2c20 6067 726f 7570  argument, `group
+00015aa0: 5f6e 616d 6560 2c20 7768 6963 680a 7368  _name`, which.sh
+00015ab0: 6f75 6c64 206d 6174 6368 2074 6865 2076  ould match the v
+00015ac0: 616c 7565 206f 6620 7468 6520 6172 6775  alue of the argu
+00015ad0: 6d65 6e74 2075 7365 6420 7768 656e 2063  ment used when c
+00015ae0: 616c 6c69 6e67 2060 6372 6561 7465 5f73  alling `create_s
+00015af0: 7562 7363 7269 7074 696f 6e28 2960 2e0a  ubscription()`..
+00015b00: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+00015b10: 6f20 6861 7320 616e 206f 7074 696f 6e61  o has an optiona
+00015b20: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00015b30: 6d65 6e74 2c20 7468 6174 0a69 7320 6578  ment, that.is ex
+00015b40: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
+00015b50: 7974 686f 6e20 6066 6c6f 6174 602c 2077  ython `float`, w
+00015b60: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
+00015b70: 6c69 6e65 0a66 6f72 2074 6865 2063 6f6d  line.for the com
+00015b80: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00015b90: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+00015ba0: 6060 6070 7974 686f 6e0a 7375 6273 6372  ```python.subscr
+00015bb0: 6970 7469 6f6e 5f69 6e66 6f20 3d20 636c  iption_info = cl
+00015bc0: 6965 6e74 2e67 6574 5f73 7562 7363 7269  ient.get_subscri
+00015bd0: 7074 696f 6e5f 696e 666f 280a 2020 2020  ption_info(.    
+00015be0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+00015bf0: 5f6e 616d 6531 2c0a 290a 6060 600a 0a54  _name1,.).```..T
+00015c00: 6865 2072 6574 7572 6e65 6420 7661 6c75  he returned valu
+00015c10: 6520 6973 2061 2060 5375 6273 6372 6970  e is a `Subscrip
+00015c20: 7469 6f6e 496e 666f 6020 6f62 6a65 6374  tionInfo` object
+00015c30: 2e0a 0a23 2323 204c 6973 7420 7375 6273  ...### List subs
+00015c40: 6372 6970 7469 6f6e 730a 0a2a 7265 7175  criptions..*requ
+00015c50: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+00015c60: 6520 606c 6973 745f 7375 6273 6372 6970  e `list_subscrip
+00015c70: 7469 6f6e 7328 2960 206d 6574 686f 6420  tions()` method 
+00015c80: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
+00015c90: 6574 2069 6e66 6f72 6d61 7469 6f6e 2066  et information f
+00015ca0: 6f72 2061 6c6c 0a65 7869 7374 696e 6720  or all.existing 
+00015cb0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00015cc0: 7269 7074 696f 6e73 2e0a 0a54 6869 7320  riptions...This 
+00015cd0: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+00015ce0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00015cf0: 2061 7267 756d 656e 742c 2074 6861 740a   argument, that.
+00015d00: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+00015d10: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
+00015d20: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
+00015d30: 2064 6561 646c 696e 650a 666f 7220 7468   deadline.for th
+00015d40: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+00015d50: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+00015d60: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a73  on...```python.s
+00015d70: 7562 7363 7269 7074 696f 6e73 203d 2063  ubscriptions = c
+00015d80: 6c69 656e 742e 6c69 7374 5f73 7562 7363  lient.list_subsc
+00015d90: 7269 7074 696f 6e73 2829 0a60 6060 0a0a  riptions().```..
+00015da0: 5468 6520 7265 7475 726e 6564 2076 616c  The returned val
+00015db0: 7565 2069 7320 6120 6c69 7374 206f 6620  ue is a list of 
+00015dc0: 6053 7562 7363 7269 7074 696f 6e49 6e66  `SubscriptionInf
+00015dd0: 6f60 206f 626a 6563 7473 2e0a 0a23 2323  o` objects...###
+00015de0: 2055 7064 6174 6520 7375 6273 6372 6970   Update subscrip
+00015df0: 7469 6f6e 0a0a 2a72 6571 7569 7265 7320  tion..*requires 
+00015e00: 6c65 6164 6572 2a0a 0a54 6865 2060 7570  leader*..The `up
+00015e10: 6461 7465 5f73 7562 7363 7269 7074 696f  date_subscriptio
+00015e20: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
+00015e30: 6265 2075 7365 6420 746f 2075 7064 6174  be used to updat
+00015e40: 6520 610a 2270 6572 7369 7374 656e 7420  e a."persistent 
+00015e50: 7375 6273 6372 6970 7469 6f6e 222e 0a0a  subscription"...
+00015e60: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00015e70: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
+00015e80: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
+00015e90: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
+00015ea0: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
+00015eb0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+00015ec0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00015ed0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+00015ee0: 616c 736f 2068 6173 2074 6872 6565 206f  also has three o
+00015ef0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+00015f00: 732c 2060 6672 6f6d 5f65 6e64 602c 2060  s, `from_end`, `
+00015f10: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+00015f20: 2c0a 616e 6420 6074 696d 656f 7574 602e  ,.and `timeout`.
+00015f30: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00015f40: 6672 6f6d 5f65 6e64 6020 6172 6775 6d65  from_end` argume
+00015f50: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+00015f60: 6f20 7370 6563 6966 7920 7468 6174 2074  o specify that t
+00015f70: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00015f80: 756d 6572 730a 6f66 2074 6865 2073 7562  umers.of the sub
+00015f90: 7363 7269 7074 696f 6e20 7368 6f75 6c64  scription should
+00015fa0: 206f 6e6c 7920 7265 6365 6976 6520 6576   only receive ev
+00015fb0: 656e 7473 2074 6861 7420 7765 7265 2072  ents that were r
+00015fc0: 6563 6f72 6465 6420 6166 7465 7220 7468  ecorded after th
+00015fd0: 6520 7375 6273 6372 6970 7469 6f6e 0a77  e subscription.w
+00015fe0: 6173 2075 7064 6174 6564 2e0a 0a41 6c74  as updated...Alt
+00015ff0: 6572 6e61 7469 7665 6c79 2c20 7468 6520  ernatively, the 
+00016000: 6f70 7469 6f6e 616c 2060 636f 6d6d 6974  optional `commit
+00016010: 5f70 6f73 6974 696f 6e60 2061 7267 756d  _position` argum
+00016020: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+00016030: 746f 2073 7065 6369 6679 2061 2063 6f6d  to specify a com
+00016040: 6d69 740a 706f 7369 7469 6f6e 2066 726f  mit.position fro
+00016050: 6d20 7768 6963 6820 636f 6d6d 6974 2070  m which commit p
+00016060: 6f73 6974 696f 6e20 7468 6520 6772 6f75  osition the grou
+00016070: 7020 6f66 2063 6f6e 7375 6d65 7273 206f  p of consumers o
+00016080: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+00016090: 6f6e 2073 686f 756c 640a 7265 6365 6976  on should.receiv
+000160a0: 6520 6576 656e 7473 2e20 506c 6561 7365  e events. Please
+000160b0: 206e 6f74 652c 2074 6865 2072 6563 6f72   note, the recor
+000160c0: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
+000160d0: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+000160e0: 7420 706f 7369 7469 6f6e 206d 6967 6874  t position might
+000160f0: 0a62 6520 696e 636c 7564 6564 2069 6e20  .be included in 
+00016100: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+00016110: 6e74 7320 7265 6365 6976 6564 2062 7920  nts received by 
+00016120: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
+00016130: 7375 6d65 7273 2e0a 0a49 6620 6e65 6974  sumers...If neit
+00016140: 6865 7220 6066 726f 6d5f 656e 6460 206f  her `from_end` o
+00016150: 7220 6063 6f6d 6d69 745f 706f 7369 7469  r `commit_positi
+00016160: 6f6e 6020 6172 6520 7370 6563 6966 6965  on` are specifie
+00016170: 642c 2074 6865 2067 726f 7570 206f 6620  d, the group of 
+00016180: 636f 6e73 756d 6572 730a 6f66 2074 6865  consumers.of the
+00016190: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+000161a0: 6c6c 2070 6f74 656e 7469 616c 6c79 2072  ll potentially r
+000161b0: 6563 6569 7665 2061 6c6c 2072 6563 6f72  eceive all recor
+000161c0: 6465 6420 6576 656e 7473 2069 6e20 7468  ded events in th
+000161d0: 6520 6461 7461 6261 7365 2e0a 0a50 6c65  e database...Ple
+000161e0: 6173 6520 6e6f 7465 2c20 7468 6520 6669  ase note, the fi
+000161f0: 6c74 6572 206f 7074 696f 6e73 2061 6e64  lter options and
+00016200: 2063 6f6e 7375 6d65 7220 7374 7261 7465   consumer strate
+00016210: 6779 2063 616e 6e6f 7420 6265 2061 646a  gy cannot be adj
+00016220: 7573 7465 642e 0a0a 5468 6520 6f70 7469  usted...The opti
+00016230: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00016240: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00016250: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+00016260: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
+00016270: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+00016280: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00016290: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+000162a0: 206d 6574 686f 6420 6075 7064 6174 655f   method `update_
+000162b0: 7375 6273 6372 6970 7469 6f6e 2829 6020  subscription()` 
+000162c0: 646f 6573 206e 6f74 2072 6574 7572 6e20  does not return 
+000162d0: 6120 7661 6c75 652e 0a0a 496e 2074 6865  a value...In the
+000162e0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+000162f0: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+00016300: 7363 7269 7074 696f 6e20 6973 2075 7064  scription is upd
+00016310: 6174 6564 2074 6f20 7275 6e20 6672 6f6d  ated to run from
+00016320: 2074 6865 2065 6e64 206f 6620 7468 650a   the end of the.
+00016330: 6461 7461 6261 7365 2e0a 0a60 6060 7079  database...```py
+00016340: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
+00016350: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00016360: 7269 7074 696f 6e2e 0a63 6c69 656e 742e  ription..client.
+00016370: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+00016380: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
+00016390: 726f 7570 5f6e 616d 6531 2c20 6672 6f6d  roup_name1, from
+000163a0: 5f65 6e64 3d54 7275 6529 0a60 6060 0a0a  _end=True).```..
+000163b0: 2323 2320 4372 6561 7465 2073 7472 6561  ### Create strea
+000163c0: 6d20 7375 6273 6372 6970 7469 6f6e 0a0a  m subscription..
+000163d0: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+000163e0: 2a0a 0a54 6865 2060 6372 6561 7465 5f73  *..The `create_s
+000163f0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+00016400: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
+00016410: 2062 6520 7573 6564 2074 6f20 6372 6561   be used to crea
+00016420: 7465 2061 2070 6572 7369 7374 656e 740a  te a persistent.
+00016430: 7375 6273 6372 6970 7469 6f6e 2066 6f72  subscription for
+00016440: 2061 2073 7472 6561 6d2e 0a0a 5468 6973   a stream...This
+00016450: 206d 6574 686f 6420 6861 7320 7477 6f20   method has two 
+00016460: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+00016470: 7473 2c20 6067 726f 7570 5f6e 616d 6560  ts, `group_name`
+00016480: 2061 6e64 2060 7374 7265 616d 5f6e 616d   and `stream_nam
+00016490: 6560 2e20 5468 650a 6067 726f 7570 5f6e  e`. The.`group_n
+000164a0: 616d 6560 2061 7267 756d 656e 7420 6e61  ame` argument na
+000164b0: 6d65 7320 7468 6520 6772 6f75 7020 6f66  mes the group of
+000164c0: 2063 6f6e 7375 6d65 7273 2074 6861 7420   consumers that 
+000164d0: 7769 6c6c 2072 6563 6569 7665 2065 7665  will receive eve
+000164e0: 6e74 730a 6672 6f6d 2074 6869 7320 7375  nts.from this su
+000164f0: 6273 6372 6970 7469 6f6e 2e20 5468 6520  bscription. The 
+00016500: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
+00016510: 6775 6d65 6e74 2073 7065 6369 6669 6573  gument specifies
+00016520: 2077 6869 6368 2073 7472 6561 6d0a 7468   which stream.th
+00016530: 6520 7375 6273 6372 6970 7469 6f6e 2077  e subscription w
+00016540: 696c 6c20 666f 6c6c 6f77 2e20 5468 6520  ill follow. The 
+00016550: 7661 6c75 6573 206f 6620 626f 7468 2074  values of both t
+00016560: 6865 7365 2061 7267 756d 656e 7473 2061  hese arguments a
+00016570: 7265 2065 7870 6563 7465 640a 746f 2062  re expected.to b
+00016580: 6520 5079 7468 6f6e 2060 7374 7260 206f  e Python `str` o
+00016590: 626a 6563 7473 2e0a 0a54 6865 206d 6574  bjects...The met
+000165a0: 686f 6420 616c 736f 2068 6173 2066 6f75  hod also has fou
+000165b0: 7220 6f70 7469 6f6e 616c 2061 7267 756d  r optional argum
+000165c0: 656e 7473 2c20 6073 7472 6561 6d5f 706f  ents, `stream_po
+000165d0: 7369 7469 6f6e 602c 2060 6672 6f6d 5f65  sition`, `from_e
+000165e0: 6e64 602c 0a60 636f 6e73 756d 6572 5f73  nd`,.`consumer_s
+000165f0: 7472 6174 6567 7960 2c20 616e 6420 6074  trategy`, and `t
+00016600: 696d 656f 7574 602e 0a0a 5468 6973 206f  imeout`...This o
+00016610: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
+00016620: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00016630: 6e74 2073 7065 6369 6669 6573 2061 2073  nt specifies a s
+00016640: 7472 6561 6d20 706f 7369 7469 6f6e 2066  tream position f
+00016650: 726f 6d0a 7768 6963 6820 746f 2073 7562  rom.which to sub
+00016660: 7363 7269 6265 2e20 5468 6520 7265 636f  scribe. The reco
+00016670: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
+00016680: 6973 2073 7472 6561 6d0a 706f 7369 7469  is stream.positi
+00016690: 6f6e 2077 696c 6c20 6265 2072 6563 6569  on will be recei
+000166a0: 7665 6420 7768 656e 2072 6561 6469 6e67  ved when reading
+000166b0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+000166c0: 6e2e 0a0a 5468 6973 206f 7074 696f 6e61  n...This optiona
+000166d0: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
+000166e0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+000166f0: 6e20 6062 6f6f 6c60 2e0a 4279 2064 6566  n `bool`..By def
+00016700: 6175 6c74 2c20 7468 6520 7661 6c75 6520  ault, the value 
+00016710: 6f66 2074 6869 7320 6172 6775 6d65 6e74  of this argument
+00016720: 2069 7320 6046 616c 7365 602e 2049 6620   is `False`. If 
+00016730: 7468 6973 2061 7267 756d 656e 7420 6973  this argument is
+00016740: 2073 6574 0a74 6f20 6054 7275 6560 2c20   set.to `True`, 
+00016750: 7265 6164 696e 6720 6672 6f6d 2074 6865  reading from the
+00016760: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+00016770: 6c6c 2072 6563 6569 7665 206f 6e6c 7920  ll receive only 
+00016780: 6576 656e 7473 0a72 6563 6f72 6465 6420  events.recorded 
+00016790: 6166 7465 7220 7468 6520 7375 6273 6372  after the subscr
+000167a0: 6970 7469 6f6e 2077 6173 2063 7265 6174  iption was creat
+000167b0: 6564 2e20 5468 6174 2069 732c 2069 7420  ed. That is, it 
+000167c0: 6973 206e 6f74 2069 6e63 6c75 7369 7665  is not inclusive
+000167d0: 0a6f 6620 7468 6520 6375 7272 656e 7420  .of the current 
+000167e0: 7374 7265 616d 2070 6f73 6974 696f 6e2e  stream position.
+000167f0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00016800: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
+00016810: 7960 2061 7267 756d 656e 7420 6973 2061  y` argument is a
+00016820: 2050 7974 686f 6e20 6073 7472 6020 7468   Python `str` th
+00016830: 6174 2064 6566 696e 6573 0a74 6865 2063  at defines.the c
+00016840: 6f6e 7375 6d65 7220 7374 7261 7465 6779  onsumer strategy
+00016850: 2066 6f72 2074 6869 7320 7065 7273 6973   for this persis
+00016860: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00016870: 6e2e 2054 6865 2076 616c 7565 206f 6620  n. The value of 
+00016880: 7468 6973 2061 7267 756d 656e 740a 6361  this argument.ca
+00016890: 6e20 6265 2060 2744 6973 7061 7463 6854  n be `'DispatchT
+000168a0: 6f53 696e 676c 6527 602c 2060 2752 6f75  oSingle'`, `'Rou
+000168b0: 6e64 526f 6269 6e27 602c 2060 2750 696e  ndRobin'`, `'Pin
+000168c0: 6e65 6427 602c 206f 7220 6027 5069 6e6e  ned'`, or `'Pinn
+000168d0: 6564 4279 436f 7272 656c 6174 696f 6e27  edByCorrelation'
+000168e0: 602e 2054 6865 0a64 6566 6175 6c74 2076  `. The.default v
+000168f0: 616c 7565 2069 7320 6027 4469 7370 6174  alue is `'Dispat
+00016900: 6368 546f 5369 6e67 6c65 2760 2e0a 0a54  chToSingle'`...T
+00016910: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
+00016920: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
+00016930: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00016940: 6d65 6e74 2c20 7468 6174 0a69 7320 6578  ment, that.is ex
+00016950: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
+00016960: 7974 686f 6e20 6066 6c6f 6174 602c 2077  ython `float`, w
+00016970: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
+00016980: 6c69 6e65 0a66 6f72 2074 6865 2063 6f6d  line.for the com
+00016990: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+000169a0: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+000169b0: 5468 6973 206d 6574 686f 6420 646f 6573  This method does
+000169c0: 206e 6f74 2072 6574 7572 6e20 6120 7661   not return a va
+000169d0: 6c75 652e 2045 7665 6e74 7320 6361 6e20  lue. Events can 
+000169e0: 6265 2072 6563 6569 7665 6420 6279 2063  be received by c
+000169f0: 616c 6c69 6e67 0a60 7265 6164 5f73 7472  alling.`read_str
+00016a00: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+00016a10: 2829 602e 0a0a 5468 6520 6578 616d 706c  ()`...The exampl
+00016a20: 6520 6265 6c6f 7720 6372 6561 7465 7320  e below creates 
+00016a30: 6120 7065 7273 6973 7465 6e74 2073 7472  a persistent str
+00016a40: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00016a50: 2066 726f 6d20 7468 6520 7374 6172 7420   from the start 
+00016a60: 6f66 2074 6865 2073 7472 6561 6d2e 0a0a  of the stream...
+00016a70: 6060 6070 7974 686f 6e0a 2320 4372 6561  ```python.# Crea
+00016a80: 7465 2061 2070 6572 7369 7374 656e 7420  te a persistent 
+00016a90: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00016aa0: 696f 6e20 6672 6f6d 2073 7461 7274 206f  ion from start o
+00016ab0: 6620 7468 6520 7374 7265 616d 2e0a 6772  f the stream..gr
+00016ac0: 6f75 705f 6e61 6d65 3220 3d20 6622 6772  oup_name2 = f"gr
+00016ad0: 6f75 702d 7b75 7569 642e 7575 6964 3428  oup-{uuid.uuid4(
+00016ae0: 297d 220a 636c 6965 6e74 2e63 7265 6174  )}".client.creat
+00016af0: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
+00016b00: 7074 696f 6e28 0a20 2020 2067 726f 7570  ption(.    group
+00016b10: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
+00016b20: 322c 0a20 2020 2073 7472 6561 6d5f 6e61  2,.    stream_na
+00016b30: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+00016b40: 0a29 0a60 6060 0a0a 2323 2320 5265 6164  .).```..### Read
+00016b50: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00016b60: 7469 6f6e 0a0a 2a72 6571 7569 7265 7320  tion..*requires 
+00016b70: 6c65 6164 6572 2a0a 0a54 6865 2060 7265  leader*..The `re
+00016b80: 6164 5f73 7472 6561 6d5f 7375 6273 6372  ad_stream_subscr
+00016b90: 6970 7469 6f6e 2829 6020 6d65 7468 6f64  iption()` method
+00016ba0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00016bb0: 7265 6164 2061 2070 6572 7369 7374 656e  read a persisten
+00016bc0: 740a 7374 7265 616d 2073 7562 7363 7269  t.stream subscri
+00016bd0: 7074 696f 6e2e 0a0a 5468 6973 206d 6574  ption...This met
+00016be0: 686f 6420 6861 7320 7477 6f20 7265 7175  hod has two requ
+00016bf0: 6972 6564 2061 7267 756d 656e 7473 2c20  ired arguments, 
+00016c00: 6067 726f 7570 5f6e 616d 6560 2061 6e64  `group_name` and
+00016c10: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
+00016c20: 7768 6963 680a 7368 6f75 6c64 206d 6174  which.should mat
+00016c30: 6368 2074 6865 2076 616c 7565 7320 6f66  ch the values of
+00016c40: 2061 7267 756d 656e 7473 2075 7365 6420   arguments used 
+00016c50: 7768 656e 2063 616c 6c69 6e67 2060 6372  when calling `cr
+00016c60: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
+00016c70: 6372 6970 7469 6f6e 2829 602e 0a0a 5468  cription()`...Th
+00016c80: 6973 206d 6574 686f 6420 616c 736f 2068  is method also h
+00016c90: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
+00016ca0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00016cb0: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
+00016cc0: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+00016cd0: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+00016ce0: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+00016cf0: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
+00016d00: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00016d10: 206f 7065 7261 7469 6f6e 2e0a 0a54 6869   operation...Thi
+00016d20: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+00016d30: 2061 2060 5065 7273 6973 7465 6e74 5375   a `PersistentSu
+00016d40: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
+00016d50: 6374 2c20 7768 6963 6820 6973 2061 6e20  ct, which is an 
+00016d60: 6974 6572 6174 6f72 0a67 6976 696e 6720  iterator.giving 
+00016d70: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+00016d80: 6f62 6a65 6374 732c 2074 6861 7420 616c  objects, that al
+00016d90: 736f 2068 6173 2060 6163 6b28 2960 2c20  so has `ack()`, 
+00016da0: 606e 6163 6b28 2960 2061 6e64 2060 7374  `nack()` and `st
+00016db0: 6f70 2829 600a 6d65 7468 6f64 732e 0a0a  op()`.methods...
+00016dc0: 6060 6070 7974 686f 6e0a 7375 6273 6372  ```python.subscr
+00016dd0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00016de0: 7265 6164 5f73 7472 6561 6d5f 7375 6273  read_stream_subs
+00016df0: 6372 6970 7469 6f6e 280a 2020 2020 6772  cription(.    gr
+00016e00: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
+00016e10: 616d 6532 2c0a 2020 2020 7374 7265 616d  ame2,.    stream
+00016e20: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00016e30: 6532 2c0a 290a 6060 600a 0a54 6865 2065  e2,.).```..The e
+00016e40: 7861 6d70 6c65 2062 656c 6f77 2069 7465  xample below ite
+00016e50: 7261 7465 7320 6f76 6572 2074 6865 2073  rates over the s
+00016e60: 7562 7363 7269 7074 696f 6e20 6f62 6a65  ubscription obje
+00016e70: 6374 2c20 616e 6420 6361 6c6c 7320 6061  ct, and calls `a
+00016e80: 636b 2829 602e 0a54 6865 2066 6f72 206c  ck()`..The for l
+00016e90: 6f6f 7020 6272 6561 6b73 2077 6865 6e20  oop breaks when 
+00016ea0: 7765 2068 6176 6520 7265 6365 6976 6564  we have received
+00016eb0: 2074 6865 206c 6173 7420 6576 656e 7420   the last event 
+00016ec0: 696e 2074 6865 2073 7472 6561 6d2c 2073  in the stream, s
+00016ed0: 6f0a 7468 6174 2077 6520 6361 6e20 6669  o.that we can fi
+00016ee0: 6e69 7368 2074 6865 2065 7861 6d70 6c65  nish the example
+00016ef0: 7320 696e 2074 6869 7320 646f 6375 6d65  s in this docume
+00016f00: 6e74 6174 696f 6e2e 0a0a 6060 6070 7974  ntation...```pyt
+00016f10: 686f 6e0a 6576 656e 7473 203d 205b 5d0a  hon.events = [].
+00016f20: 666f 7220 6576 656e 7420 696e 2073 7562  for event in sub
+00016f30: 7363 7269 7074 696f 6e3a 0a20 2020 2065  scription:.    e
+00016f40: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
+00016f50: 6e74 290a 0a20 2020 2023 2041 636b 6e6f  nt)..    # Ackno
+00016f60: 776c 6564 6765 2074 6865 2072 6563 6569  wledge the recei
+00016f70: 7665 6420 6576 656e 742e 0a20 2020 2073  ved event..    s
+00016f80: 7562 7363 7269 7074 696f 6e2e 6163 6b28  ubscription.ack(
+00016f90: 6576 656e 745f 6964 3d65 7665 6e74 2e69  event_id=event.i
+00016fa0: 6429 0a0a 2020 2020 2320 5374 6f70 2077  d)..    # Stop w
+00016fb0: 6865 6e20 2765 7665 6e74 3627 2068 6173  hen 'event6' has
+00016fc0: 2062 6565 6e20 7265 6365 6976 6564 2e0a   been received..
+00016fd0: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+00016fe0: 3d3d 2065 7665 6e74 362e 6964 3a0a 2020  == event6.id:.  
+00016ff0: 2020 2020 2020 7375 6273 6372 6970 7469        subscripti
+00017000: 6f6e 2e73 746f 7028 290a 6060 600a 0a57  on.stop().```..W
+00017010: 6520 6361 6e20 6368 6563 6b20 7765 2072  e can check we r
+00017020: 6563 6569 7665 6420 616c 6c20 7468 6520  eceived all the 
+00017030: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
+00017040: 2061 7070 656e 6465 6420 746f 2060 7374   appended to `st
+00017050: 7265 616d 5f6e 616d 6532 600a 696e 2074  ream_name2`.in t
+00017060: 6865 2065 7861 6d70 6c65 7320 6162 6f76  he examples abov
+00017070: 652e 0a0a 6060 6070 7974 686f 6e0a 6173  e...```python.as
+00017080: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+00017090: 203d 3d20 330a 6173 7365 7274 2065 7665   == 3.assert eve
+000170a0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
+000170b0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+000170c0: 6532 0a61 7373 6572 7420 6576 656e 7473  e2.assert events
+000170d0: 5b30 5d2e 6964 203d 3d20 6576 656e 7434  [0].id == event4
+000170e0: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+000170f0: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
+00017100: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
+00017110: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
+00017120: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
+00017130: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
+00017140: 325d 2e73 7472 6561 6d5f 6e61 6d65 203d  2].stream_name =
+00017150: 3d20 7374 7265 616d 5f6e 616d 6532 0a61  = stream_name2.a
+00017160: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
+00017170: 6964 203d 3d20 6576 656e 7436 2e69 640a  id == event6.id.
+00017180: 6060 600a 0a23 2323 2047 6574 2073 7472  ```..### Get str
+00017190: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+000171a0: 2069 6e66 6f0a 0a2a 7265 7175 6972 6573   info..*requires
+000171b0: 206c 6561 6465 722a 0a0a 5468 6520 6067   leader*..The `g
+000171c0: 6574 5f73 7472 6561 6d5f 7375 6273 6372  et_stream_subscr
+000171d0: 6970 7469 6f6e 5f69 6e66 6f28 2960 206d  iption_info()` m
+000171e0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+000171f0: 6420 746f 2067 6574 2069 6e66 6f72 6d61  d to get informa
+00017200: 7469 6f6e 2066 6f72 2061 0a70 6572 7369  tion for a.persi
+00017210: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00017220: 6f6e 2066 6f72 2061 2073 7472 6561 6d2e  on for a stream.
+00017230: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00017240: 7320 7477 6f20 7265 7175 6972 6564 2061  s two required a
+00017250: 7267 756d 656e 7473 2c20 6067 726f 7570  rguments, `group
+00017260: 5f6e 616d 6560 2061 6e64 2060 7374 7265  _name` and `stre
+00017270: 616d 5f6e 616d 6560 2c20 7768 6963 680a  am_name`, which.
+00017280: 7368 6f75 6c64 206d 6174 6368 2074 6865  should match the
+00017290: 2076 616c 7565 7320 6f66 2061 7267 756d   values of argum
+000172a0: 656e 7473 2075 7365 6420 7768 656e 2063  ents used when c
+000172b0: 616c 6c69 6e67 2060 6372 6561 7465 5f73  alling `create_s
+000172c0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+000172d0: 6f6e 2829 602e 0a0a 5468 6973 206d 6574  on()`...This met
+000172e0: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
+000172f0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+00017300: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
+00017310: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
+00017320: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+00017330: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+00017340: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
+00017350: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00017360: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00017370: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
+00017380: 0a73 7562 7363 7269 7074 696f 6e5f 696e  .subscription_in
+00017390: 666f 203d 2063 6c69 656e 742e 6765 745f  fo = client.get_
+000173a0: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
+000173b0: 696f 6e5f 696e 666f 280a 2020 2020 6772  ion_info(.    gr
+000173c0: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
+000173d0: 616d 6532 2c0a 2020 2020 7374 7265 616d  ame2,.    stream
+000173e0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+000173f0: 6532 2c0a 290a 6060 600a 0a54 6865 2072  e2,.).```..The r
+00017400: 6574 7572 6e65 6420 7661 6c75 6520 6973  eturned value is
+00017410: 2061 2060 5375 6273 6372 6970 7469 6f6e   a `Subscription
+00017420: 496e 666f 6020 6f62 6a65 6374 2e0a 0a0a  Info` object....
+00017430: 2323 2320 4c69 7374 2073 7472 6561 6d20  ### List stream 
+00017440: 7375 6273 6372 6970 7469 6f6e 730a 0a2a  subscriptions..*
+00017450: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+00017460: 0a0a 5468 6520 606c 6973 745f 7374 7265  ..The `list_stre
+00017470: 616d 5f73 7562 7363 7269 7074 696f 6e73  am_subscriptions
+00017480: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00017490: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
+000174a0: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
+000174b0: 6c0a 7468 6520 7065 7273 6973 7465 6e74  l.the persistent
+000174c0: 2073 7562 7363 7269 7074 696f 6e73 2066   subscriptions f
+000174d0: 6f72 2061 2073 7472 6561 6d2e 0a0a 5468  or a stream...Th
+000174e0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+000174f0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+00017500: 656e 742c 2060 7374 7265 616d 5f6e 616d  ent, `stream_nam
+00017510: 6560 2e0a 0a54 6869 7320 6d65 7468 6f64  e`...This method
+00017520: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
+00017530: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00017540: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
+00017550: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
+00017560: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00017570: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
+00017580: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
+00017590: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+000175a0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+000175b0: 6e2e 0a0a 6060 6070 7974 686f 6e0a 7375  n...```python.su
+000175c0: 6273 6372 6970 7469 6f6e 7320 3d20 636c  bscriptions = cl
+000175d0: 6965 6e74 2e6c 6973 745f 7374 7265 616d  ient.list_stream
+000175e0: 5f73 7562 7363 7269 7074 696f 6e73 280a  _subscriptions(.
+000175f0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+00017600: 7374 7265 616d 5f6e 616d 6532 2c0a 290a  stream_name2,.).
+00017610: 6060 600a 0a54 6865 2072 6574 7572 6e65  ```..The returne
+00017620: 6420 7661 6c75 6520 6973 2061 206c 6973  d value is a lis
+00017630: 7420 6f66 2060 5375 6273 6372 6970 7469  t of `Subscripti
+00017640: 6f6e 496e 666f 6020 6f62 6a65 6374 732e  onInfo` objects.
+00017650: 0a0a 2323 2320 5570 6461 7465 2073 7472  ..### Update str
+00017660: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00017670: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
+00017680: 6572 2a0a 0a54 6865 2060 7570 6461 7465  er*..The `update
+00017690: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
+000176a0: 7469 6f6e 2829 6020 6d65 7468 6f64 2063  tion()` method c
+000176b0: 616e 2062 6520 7573 6564 2074 6f20 7570  an be used to up
+000176c0: 6461 7465 2061 0a70 6572 7369 7374 656e  date a.persisten
+000176d0: 7420 7375 6273 6372 6970 7469 6f6e 2066  t subscription f
+000176e0: 6f72 2061 2073 7472 6561 6d2e 0a0a 5468  or a stream...Th
+000176f0: 6973 206d 6574 686f 6420 6861 7320 6120  is method has a 
+00017700: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
+00017710: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
+00017720: 7768 6963 6820 6973 2074 6865 0a6e 616d  which is the.nam
+00017730: 6520 6f66 2061 2022 6772 6f75 7022 206f  e of a "group" o
+00017740: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+00017750: 6865 2073 7562 7363 7269 7074 696f 6e2c  he subscription,
+00017760: 2061 6e64 2061 2072 6571 7569 7265 640a   and a required.
+00017770: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
+00017780: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00017790: 2074 6865 206e 616d 6520 6f66 2061 2073   the name of a s
+000177a0: 7472 6561 6d2e 0a0a 5468 6973 206d 6574  tream...This met
+000177b0: 686f 6420 616c 736f 2068 6173 2074 6872  hod also has thr
+000177c0: 6565 206f 7074 696f 6e61 6c20 6172 6775  ee optional argu
+000177d0: 6d65 6e74 732c 2060 6672 6f6d 5f65 6e64  ments, `from_end
+000177e0: 602c 2060 7374 7265 616d 5f70 6f73 6974  `, `stream_posit
+000177f0: 696f 6e60 2c0a 616e 6420 6074 696d 656f  ion`,.and `timeo
+00017800: 7574 602e 0a0a 5468 6520 6f70 7469 6f6e  ut`...The option
+00017810: 616c 2060 6672 6f6d 5f65 6e64 6020 6172  al `from_end` ar
+00017820: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+00017830: 6564 2074 6f20 7370 6563 6966 7920 7468  ed to specify th
+00017840: 6174 2074 6865 2067 726f 7570 206f 6620  at the group of 
+00017850: 636f 6e73 756d 6572 730a 6f66 2074 6865  consumers.of the
+00017860: 2073 7562 7363 7269 7074 696f 6e20 7368   subscription sh
+00017870: 6f75 6c64 206f 6e6c 7920 7265 6365 6976  ould only receiv
+00017880: 6520 6576 656e 7473 2074 6861 7420 7765  e events that we
+00017890: 7265 2072 6563 6f72 6465 6420 6166 7465  re recorded afte
+000178a0: 7220 7468 6520 7375 6273 6372 6970 7469  r the subscripti
+000178b0: 6f6e 0a77 6173 2075 7064 6174 6564 2e0a  on.was updated..
+000178c0: 0a41 6c74 6572 6e61 7469 7665 6c79 2c20  .Alternatively, 
+000178d0: 7468 6520 6f70 7469 6f6e 616c 2060 7374  the optional `st
+000178e0: 7265 616d 5f70 6f73 6974 696f 6e60 2061  ream_position` a
+000178f0: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
+00017900: 7365 6420 746f 2073 7065 6369 6679 2061  sed to specify a
+00017910: 2073 7472 6561 6d0a 706f 7369 7469 6f6e   stream.position
+00017920: 2066 726f 6d20 7768 6963 6820 636f 6d6d   from which comm
+00017930: 6974 2070 6f73 6974 696f 6e20 7468 6520  it position the 
+00017940: 6772 6f75 7020 6f66 2063 6f6e 7375 6d65  group of consume
+00017950: 7273 206f 6620 7468 6520 7375 6273 6372  rs of the subscr
+00017960: 6970 7469 6f6e 2073 686f 756c 640a 7265  iption should.re
+00017970: 6365 6976 6520 6576 656e 7473 2e20 506c  ceive events. Pl
+00017980: 6561 7365 206e 6f74 652c 2074 6865 2072  ease note, the r
+00017990: 6563 6f72 6465 6420 6576 656e 7420 6174  ecorded event at
+000179a0: 2074 6865 2073 7065 6369 6669 6564 2073   the specified s
+000179b0: 7472 6561 6d20 706f 7369 7469 6f6e 206d  tream position m
+000179c0: 6967 6874 0a62 6520 696e 636c 7564 6564  ight.be included
+000179d0: 2069 6e20 7468 6520 7265 636f 7264 6564   in the recorded
+000179e0: 2065 7665 6e74 7320 7265 6365 6976 6564   events received
+000179f0: 2062 7920 7468 6520 6772 6f75 7020 6f66   by the group of
+00017a00: 2063 6f6e 7375 6d65 7273 2e0a 0a49 6620   consumers...If 
+00017a10: 6e65 6974 6865 7220 6066 726f 6d5f 656e  neither `from_en
+00017a20: 6460 206f 7220 6063 6f6d 6d69 745f 706f  d` or `commit_po
+00017a30: 7369 7469 6f6e 6020 6172 6520 7370 6563  sition` are spec
+00017a40: 6966 6965 642c 2074 6865 2067 726f 7570  ified, the group
+00017a50: 206f 6620 636f 6e73 756d 6572 730a 6f66   of consumers.of
+00017a60: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00017a70: 6e20 7769 6c6c 2070 6f74 656e 7469 616c  n will potential
+00017a80: 6c79 2072 6563 6569 7665 2061 6c6c 2072  ly receive all r
+00017a90: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+00017aa0: 6e20 7468 6520 7374 7265 616d 2e0a 0a50  n the stream...P
+00017ab0: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00017ac0: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
+00017ad0: 7920 6361 6e6e 6f74 2062 6520 6164 6a75  y cannot be adju
+00017ae0: 7374 6564 2e0a 0a54 6865 206f 7074 696f  sted...The optio
+00017af0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00017b00: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00017b10: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00017b20: 2073 6574 7320 610a 6465 6164 6c69 6e65   sets a.deadline
+00017b30: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+00017b40: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00017b50: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+00017b60: 6075 7064 6174 655f 7374 7265 616d 5f73  `update_stream_s
+00017b70: 7562 7363 7269 7074 696f 6e28 2960 206d  ubscription()` m
+00017b80: 6574 686f 6420 646f 6573 206e 6f74 2072  ethod does not r
+00017b90: 6574 7572 6e20 6120 7661 6c75 652e 0a0a  eturn a value...
+00017ba0: 496e 2074 6865 2065 7861 6d70 6c65 2062  In the example b
+00017bb0: 656c 6f77 2c20 6120 7065 7273 6973 7465  elow, a persiste
+00017bc0: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
+00017bd0: 666f 7220 6120 7374 7265 616d 2069 7320  for a stream is 
+00017be0: 7570 6461 7465 6420 746f 2072 756e 2066  updated to run f
+00017bf0: 726f 6d20 7468 650a 656e 6420 6f66 2074  rom the.end of t
+00017c00: 6865 2073 7472 6561 6d2e 0a0a 6060 6070  he stream...```p
+00017c10: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
+00017c20: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00017c30: 6372 6970 7469 6f6e 2e0a 636c 6965 6e74  cription..client
+00017c40: 2e75 7064 6174 655f 7374 7265 616d 5f73  .update_stream_s
+00017c50: 7562 7363 7269 7074 696f 6e28 0a20 2020  ubscription(.   
+00017c60: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
+00017c70: 705f 6e61 6d65 322c 0a20 2020 2073 7472  p_name2,.    str
+00017c80: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00017c90: 6e61 6d65 322c 0a20 2020 2066 726f 6d5f  name2,.    from_
+00017ca0: 656e 643d 5472 7565 2c0a 290a 6060 600a  end=True,.).```.
+00017cb0: 0a23 2323 2052 6570 6c61 7920 7061 726b  .### Replay park
+00017cc0: 6564 2065 7665 6e74 730a 0a2a 7265 7175  ed events..*requ
+00017cd0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+00017ce0: 6520 6072 6570 6c61 795f 7061 726b 6564  e `replay_parked
+00017cf0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+00017d00: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+00017d10: 2022 7265 706c 6179 2220 6576 656e 7473   "replay" events
+00017d20: 2074 6861 7420 6861 7665 0a62 6565 6e20   that have.been 
+00017d30: 2270 6172 6b65 6422 2028 6e65 6761 7469  "parked" (negati
+00017d40: 7665 6c79 2061 636b 6e6f 776c 6564 6765  vely acknowledge
+00017d50: 6420 7769 7468 2074 6865 2061 6374 696f  d with the actio
+00017d60: 6e20 6027 7061 726b 2760 2920 7768 656e  n `'park'`) when
+00017d70: 2072 6561 6469 6e67 0a61 2070 6572 7369   reading.a persi
+00017d80: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00017d90: 6f6e 2e20 5061 726b 6564 2065 7665 6e74  on. Parked event
+00017da0: 7320 7769 6c6c 2074 6865 6e20 6265 2072  s will then be r
+00017db0: 6563 6569 7665 6420 6279 2074 6865 2063  eceived by the c
+00017dc0: 6f6e 7375 6d65 7273 0a72 6561 6469 6e67  onsumers.reading
+00017dd0: 2066 726f 6d20 7468 6520 7065 7273 6973   from the persis
+00017de0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00017df0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+00017e00: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
+00017e10: 2061 7267 756d 656e 742c 2060 6772 6f75   argument, `grou
+00017e20: 705f 6e61 6d65 602e 2049 7420 6861 7320  p_name`. It has 
+00017e30: 6f6e 6520 6f70 7469 6f6e 616c 2061 7267  one optional arg
+00017e40: 756d 656e 742c 0a60 7374 7265 616d 5f6e  ument,.`stream_n
+00017e50: 616d 6560 2e20 5468 6520 7661 6c75 6573  ame`. The values
+00017e60: 206f 6620 7468 6573 6520 6172 6775 6d65   of these argume
+00017e70: 6e74 7320 7368 6f75 6c64 206d 6174 6368  nts should match
+00017e80: 2074 686f 7365 2075 7365 6420 7768 656e   those used when
+00017e90: 2063 616c 6c69 6e67 0a60 6372 6561 7465   calling.`create
+00017ea0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00017eb0: 206f 7220 6063 7265 6174 655f 7374 7265   or `create_stre
+00017ec0: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
+00017ed0: 2960 2e0a 0a54 6869 7320 6d65 7468 6f64  )`...This method
+00017ee0: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
+00017ef0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00017f00: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
+00017f10: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
+00017f20: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00017f30: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
+00017f40: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
+00017f50: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00017f60: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00017f70: 6e2e 0a0a 5468 6520 6578 616d 706c 6520  n...The example 
+00017f80: 6265 6c6f 7720 7265 706c 6179 7320 7061  below replays pa
+00017f90: 726b 6564 2065 7665 6e74 7320 666f 7220  rked events for 
+00017fa0: 6772 6f75 7020 6067 726f 7570 5f6e 616d  group `group_nam
+00017fb0: 6531 602e 0a0a 6060 6070 7974 686f 6e0a  e1`...```python.
+00017fc0: 636c 6965 6e74 2e72 6570 6c61 795f 7061  client.replay_pa
+00017fd0: 726b 6564 5f65 7665 6e74 7328 0a20 2020  rked_events(.   
+00017fe0: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
+00017ff0: 705f 6e61 6d65 312c 0a29 0a60 6060 0a0a  p_name1,.).```..
+00018000: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00018010: 7720 7265 706c 6179 7320 7061 726b 6564  w replays parked
+00018020: 2065 7665 6e74 7320 666f 7220 6772 6f75   events for grou
+00018030: 7020 6067 726f 7570 5f6e 616d 6532 602e  p `group_name2`.
+00018040: 0a0a 6060 6070 7974 686f 6e0a 636c 6965  ..```python.clie
+00018050: 6e74 2e72 6570 6c61 795f 7061 726b 6564  nt.replay_parked
+00018060: 5f65 7665 6e74 7328 0a20 2020 2067 726f  _events(.    gro
+00018070: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+00018080: 6d65 322c 0a20 2020 2073 7472 6561 6d5f  me2,.    stream_
+00018090: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+000180a0: 322c 0a29 0a60 6060 0a0a 2323 2320 4465  2,.).```..### De
+000180b0: 6c65 7465 2070 6572 7369 7374 656e 7420  lete persistent 
+000180c0: 7375 6273 6372 6970 7469 6f6e 0a0a 2a72  subscription..*r
+000180d0: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
+000180e0: 0a54 6865 2060 6465 6c65 7465 5f70 6572  .The `delete_per
+000180f0: 7369 7374 656e 745f 7375 6273 6372 6970  sistent_subscrip
+00018100: 7469 6f6e 2829 6020 6d65 7468 6f64 2063  tion()` method c
+00018110: 616e 2062 6520 7573 6564 2074 6f20 6465  an be used to de
+00018120: 6c65 7465 2061 2070 6572 7369 7374 656e  lete a persisten
+00018130: 740a 7375 6273 6372 6970 7469 6f6e 2e0a  t.subscription..
+00018140: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00018150: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
+00018160: 6775 6d65 6e74 2c20 6067 726f 7570 5f6e  gument, `group_n
+00018170: 616d 6560 2e20 4974 2068 6173 206f 6e65  ame`. It has one
+00018180: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00018190: 6e74 2c0a 6073 7472 6561 6d5f 6e61 6d65  nt,.`stream_name
+000181a0: 602e 2054 6865 2076 616c 7565 7320 6f66  `. The values of
+000181b0: 2074 6865 7365 2061 7267 756d 656e 7473   these arguments
+000181c0: 2073 686f 756c 6420 6d61 7463 6820 7468   should match th
+000181d0: 6f73 6520 7573 6564 2077 6865 6e20 6361  ose used when ca
+000181e0: 6c6c 696e 670a 6063 7265 6174 655f 7375  lling.`create_su
+000181f0: 6273 6372 6970 7469 6f6e 2829 6020 6f72  bscription()` or
+00018200: 2060 6372 6561 7465 5f73 7472 6561 6d5f   `create_stream_
+00018210: 7375 6273 6372 6970 7469 6f6e 2829 602e  subscription()`.
+00018220: 0a0a 5468 6973 206d 6574 686f 6420 616c  ..This method al
+00018230: 736f 2068 6173 2061 6e20 6f70 7469 6f6e  so has an option
+00018240: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+00018250: 756d 656e 742c 2074 6861 740a 6973 2065  ument, that.is e
+00018260: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
+00018270: 5079 7468 6f6e 2060 666c 6f61 7460 2c20  Python `float`, 
+00018280: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
+00018290: 646c 696e 650a 666f 7220 7468 6520 636f  dline.for the co
+000182a0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+000182b0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
+000182c0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+000182d0: 6f77 2064 656c 6574 6573 2074 6865 2073  ow deletes the s
+000182e0: 7562 7363 7269 7074 696f 6e20 666f 7220  ubscription for 
+000182f0: 6772 6f75 7020 6067 726f 7570 5f6e 616d  group `group_nam
+00018300: 6531 6020 7768 6963 6820 7761 7320 6372  e1` which was cr
+00018310: 6561 7465 640a 6279 2063 616c 6c69 6e67  eated.by calling
+00018320: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+00018330: 7074 696f 6e28 2960 2e0a 0a60 6060 7079  ption()`...```py
+00018340: 7468 6f6e 0a63 6c69 656e 742e 6465 6c65  thon.client.dele
+00018350: 7465 5f70 6572 7369 7374 656e 745f 7375  te_persistent_su
+00018360: 6273 6372 6970 7469 6f6e 280a 2020 2020  bscription(.    
+00018370: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+00018380: 5f6e 616d 6531 2c0a 290a 6060 600a 0a54  _name1,.).```..T
+00018390: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+000183a0: 2064 656c 6574 6573 2074 6865 2073 7562   deletes the sub
+000183b0: 7363 7269 7074 696f 6e20 666f 7220 6772  scription for gr
+000183c0: 6f75 7020 6067 726f 7570 5f6e 616d 6532  oup `group_name2
+000183d0: 6020 7768 6963 6820 7761 7320 6372 6561  ` which was crea
+000183e0: 7465 640a 6279 2063 616c 6c69 6e67 2060  ted.by calling `
+000183f0: 6372 6561 7465 5f73 7472 6561 6d5f 7375  create_stream_su
+00018400: 6273 6372 6970 7469 6f6e 2829 602e 0a0a  bscription()`...
+00018410: 6060 6070 7974 686f 6e0a 636c 6965 6e74  ```python.client
+00018420: 2e64 656c 6574 655f 7065 7273 6973 7465  .delete_persiste
+00018430: 6e74 5f73 7562 7363 7269 7074 696f 6e28  nt_subscription(
+00018440: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
+00018450: 6772 6f75 705f 6e61 6d65 322c 0a20 2020  group_name2,.   
+00018460: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+00018470: 6561 6d5f 6e61 6d65 322c 0a29 0a60 6060  eam_name2,.).```
+00018480: 0a0a 2323 2043 6f6e 6e65 6374 696f 6e0a  ..## Connection.
+00018490: 0a23 2323 2052 6563 6f6e 6e65 6374 0a0a  .### Reconnect..
+000184a0: 5468 6520 6072 6563 6f6e 6e65 6374 2829  The `reconnect()
+000184b0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+000184c0: 7573 6564 2074 6f20 6d61 6e75 616c 6c79  used to manually
+000184d0: 2072 6563 6f6e 6e65 6374 2074 6865 2063   reconnect the c
+000184e0: 6c69 656e 7420 746f 2061 0a73 7569 7461  lient to a.suita
+000184f0: 626c 6520 4576 656e 7453 746f 7265 4442  ble EventStoreDB
+00018500: 206e 6f64 652e 2054 6869 7320 6d65 7468   node. This meth
+00018510: 6f64 2075 7365 7320 7468 6520 7361 6d65  od uses the same
+00018520: 2072 6f75 7469 6e65 2066 6f72 2072 6561   routine for rea
+00018530: 6469 6e67 2074 6865 0a63 6c75 7374 6572  ding the.cluster
+00018540: 206e 6f64 6520 7374 6174 6573 2061 6e64   node states and
+00018550: 2074 6865 6e20 636f 6e6e 6563 7469 6e67   then connecting
+00018560: 2074 6f20 6120 7375 6974 6162 6c65 206e   to a suitable n
+00018570: 6f64 6520 6163 636f 7264 696e 6720 746f  ode according to
+00018580: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
+00018590: 6465 2070 7265 6665 7265 6e63 6520 7468  de preference th
+000185a0: 6174 2069 7320 7370 6563 6966 6965 6420  at is specified 
+000185b0: 696e 2074 6865 2063 6f6e 6e65 6374 696f  in the connectio
+000185c0: 6e20 7374 7269 6e67 2055 5249 2077 6865  n string URI whe
+000185d0: 6e0a 7468 6520 636c 6965 6e74 2069 7320  n.the client is 
+000185e0: 636f 6e73 7472 7563 7465 642e 2054 6869  constructed. Thi
+000185f0: 7320 6d65 7468 6f64 2069 7320 7468 7265  s method is thre
+00018600: 6164 2d73 6166 652c 2069 6e20 7468 6174  ad-safe, in that
+00018610: 2077 6865 6e20 6974 2069 7320 6361 6c6c   when it is call
+00018620: 6564 0a62 7920 7365 7665 7261 6c20 7468  ed.by several th
+00018630: 7265 6164 7320 6174 2074 6865 2073 616d  reads at the sam
+00018640: 6520 7469 6d65 2c20 6f6e 6c79 206f 6e65  e time, only one
+00018650: 2072 6563 6f6e 6e65 6374 696f 6e20 7769   reconnection wi
+00018660: 6c6c 206f 6363 7572 2e20 436f 6e63 7572  ll occur. Concur
+00018670: 7265 6e74 0a61 7474 656d 7074 7320 746f  rent.attempts to
+00018680: 2072 6563 6f6e 6e65 6374 2077 696c 6c20   reconnect will 
+00018690: 626c 6f63 6b20 756e 7469 6c20 7468 6520  block until the 
+000186a0: 636c 6965 6e74 2068 6173 2072 6563 6f6e  client has recon
+000186b0: 6e65 6374 6564 2073 7563 6365 7373 6675  nected successfu
+000186c0: 6c6c 792c 0a61 6e64 2074 6865 6e20 7468  lly,.and then th
+000186d0: 6579 2077 696c 6c20 616c 6c20 7265 7475  ey will all retu
+000186e0: 726e 206e 6f72 6d61 6c6c 792e 0a0a 6060  rn normally...``
+000186f0: 6070 7974 686f 6e0a 636c 6965 6e74 2e72  `python.client.r
+00018700: 6563 6f6e 6e65 6374 2829 0a60 6060 0a0a  econnect().```..
+00018710: 416e 2065 7861 6d70 6c65 206f 6620 7768  An example of wh
+00018720: 656e 2069 7420 6d69 6768 7420 6265 2064  en it might be d
+00018730: 6573 6972 6162 6c65 2074 6f20 7265 636f  esirable to reco
+00018740: 6e6e 6563 7420 6d61 6e75 616c 6c79 2069  nnect manually i
+00018750: 7320 7768 656e 2028 666f 7220 7065 7266  s when (for perf
+00018760: 6f72 6d61 6e63 650a 7265 6173 6f6e 7329  ormance.reasons)
+00018770: 2074 6865 2063 6c69 656e 7427 7320 6e6f   the client's no
+00018780: 6465 2070 7265 6665 7265 6e63 6520 6973  de preference is
+00018790: 2074 6f20 6265 2063 6f6e 6e65 6374 6564   to be connected
+000187a0: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
+000187b0: 6f64 6520 696e 2074 6865 0a63 6c75 7374  ode in the.clust
+000187c0: 6572 2c20 616e 642c 2061 6674 6572 2061  er, and, after a
+000187d0: 2063 6c75 7374 6572 206c 6561 6465 7220   cluster leader 
+000187e0: 656c 6563 7469 6f6e 2c20 7468 6520 666f  election, the fo
+000187f0: 6c6c 6f77 6572 2062 6563 6f6d 6573 2074  llower becomes t
+00018800: 6865 206c 6561 6465 722e 0a52 6563 6f6e  he leader..Recon
+00018810: 6e65 6374 696e 6720 746f 2061 2066 6f6c  necting to a fol
+00018820: 6c6f 7765 7220 6e6f 6465 2069 6e20 7468  lower node in th
+00018830: 6973 2063 6173 6520 6973 2063 7572 7265  is case is curre
+00018840: 6e74 6c79 2062 6579 6f6e 6420 7468 6520  ntly beyond the 
+00018850: 6361 7061 6269 6c69 7469 6573 206f 660a  capabilities of.
+00018860: 7468 6973 2063 6c69 656e 742c 2062 7574  this client, but
+00018870: 2074 6869 7320 6265 6861 7669 6f72 206d   this behavior m
+00018880: 6967 6874 2062 6520 696d 706c 656d 656e  ight be implemen
+00018890: 7465 6420 696e 2061 2066 7574 7572 6520  ted in a future 
+000188a0: 7265 6c65 6173 652e 0a0a 506c 6561 7365  release...Please
+000188b0: 206e 6f74 652c 206e 6561 726c 7920 616c   note, nearly al
+000188c0: 6c20 7468 6520 636c 6965 6e74 206d 6574  l the client met
+000188d0: 686f 6473 2061 7265 2064 6563 6f72 6174  hods are decorat
+000188e0: 6564 2077 6974 6820 6040 6175 746f 7265  ed with `@autore
+000188f0: 636f 6e6e 6563 7460 2028 7768 6963 680a  connect` (which.
+00018900: 6361 6c6c 7320 7468 6520 6072 6563 6f6e  calls the `recon
+00018910: 6e65 6374 2829 6020 6d65 7468 6f64 2077  nect()` method w
+00018920: 6865 6e20 7468 6520 636c 6965 6e74 2064  hen the client d
+00018930: 6574 6563 7473 2074 6861 7420 7265 636f  etects that reco
+00018940: 6e6e 6563 7469 6e67 2069 7320 7265 7175  nnecting is requ
+00018950: 6972 6564 290a 616e 6420 6120 6040 7265  ired).and a `@re
+00018960: 7472 7960 2064 6563 6f72 6174 6f72 2074  try` decorator t
+00018970: 6861 7420 6d6f 7265 2067 656e 6572 616c  hat more general
+00018980: 6c79 2077 696c 6c20 7265 7472 7920 6f70  ly will retry op
+00018990: 6572 6174 696f 6e73 2074 6861 7420 6661  erations that fa
+000189a0: 696c 2064 7565 2074 6f0a 636f 6e6e 6563  il due to.connec
+000189b0: 7469 6f6e 2069 7373 7565 732e 0a0a 5468  tion issues...Th
+000189c0: 6520 6040 6175 746f 7265 636f 6e6e 6563  e `@autoreconnec
+000189d0: 7460 2064 6563 6f72 6174 6f72 2077 696c  t` decorator wil
+000189e0: 6c20 7265 636f 6e6e 6563 7420 746f 2061  l reconnect to a
+000189f0: 2073 7569 7461 626c 6520 6e6f 6465 2069   suitable node i
+00018a00: 6e20 7468 6520 636c 7573 7465 7220 7768  n the cluster wh
+00018a10: 656e 0a74 6865 2073 6572 7665 7220 746f  en.the server to
+00018a20: 2077 6869 6368 2074 6865 2063 6c69 656e   which the clien
+00018a30: 7420 6861 7320 6265 656e 2063 6f6e 6e65  t has been conne
+00018a40: 6374 6564 2068 6173 2062 6563 6f6d 6520  cted has become 
+00018a50: 756e 6176 6169 6c61 626c 652c 206f 7220  unavailable, or 
+00018a60: 7768 656e 2074 6865 0a63 6c69 656e 7427  when the.client'
+00018a70: 7320 6752 5043 2063 6861 6e6e 656c 2068  s gRPC channel h
+00018a80: 6170 7065 6e73 2074 6f20 6861 7665 2062  appens to have b
+00018a90: 6565 6e20 636c 6f73 6564 2e20 5468 6520  een closed. The 
+00018aa0: 636c 6965 6e74 2077 696c 6c20 616c 736f  client will also
+00018ab0: 2072 6563 6f6e 6e65 6374 2077 6865 6e0a   reconnect when.
+00018ac0: 6120 6d65 7468 6f64 2069 7320 6361 6c6c  a method is call
+00018ad0: 6564 2074 6861 7420 7265 7175 6972 6573  ed that requires
+00018ae0: 2061 206c 6561 6465 722c 2061 6e64 2074   a leader, and t
+00018af0: 6865 2063 6c69 656e 7427 7320 6e6f 6465  he client's node
+00018b00: 2070 7265 6665 7265 6e63 6520 6973 2074   preference is t
+00018b10: 6f20 6265 0a63 6f6e 6e65 6374 6564 2074  o be.connected t
+00018b20: 6f20 6120 6c65 6164 6572 2c20 6275 7420  o a leader, but 
+00018b30: 7468 6520 6e6f 6465 2074 6861 7420 7468  the node that th
+00018b40: 6520 636c 6965 6e74 2068 6173 2062 6565  e client has bee
+00018b50: 6e20 636f 6e6e 6563 7465 6420 746f 2073  n connected to s
+00018b60: 746f 7073 2062 6569 6e67 0a74 6865 206c  tops being.the l
+00018b70: 6561 6465 722e 2049 6e20 7468 6973 2063  eader. In this c
+00018b80: 6173 652c 2074 6865 2063 6c69 656e 7420  ase, the client 
+00018b90: 7769 6c6c 2072 6563 6f6e 6e65 6374 2074  will reconnect t
+00018ba0: 6f20 7468 6520 6375 7272 656e 7420 6c65  o the current le
+00018bb0: 6164 6572 2e20 4166 7465 720a 7265 636f  ader. After.reco
+00018bc0: 6e6e 6563 7469 6e67 2c20 7468 6520 6661  nnecting, the fa
+00018bd0: 696c 6564 206f 7065 7261 7469 6f6e 2077  iled operation w
+00018be0: 696c 6c20 6265 2072 6574 7269 6564 2e0a  ill be retried..
+00018bf0: 0a54 6865 2060 4072 6574 7279 6020 6465  .The `@retry` de
+00018c00: 636f 7261 746f 7220 7265 7472 6965 7320  corator retries 
+00018c10: 6f70 6572 6174 696f 6e73 2074 6861 7420  operations that 
+00018c20: 6861 7665 2066 6169 6c65 6420 6475 6520  have failed due 
+00018c30: 746f 206d 6f72 6520 6765 6e65 7261 6c0a  to more general.
+00018c40: 636f 6e6e 6563 7469 6f6e 2069 7373 7565  connection issue
+00018c50: 732c 2073 7563 6820 6173 2061 2064 6561  s, such as a dea
+00018c60: 646c 696e 6520 6265 696e 6720 7265 6163  dline being reac
+00018c70: 6865 6420 2873 6f20 7468 6174 2074 6865  hed (so that the
+00018c80: 206f 7065 7261 7469 6f6e 2074 696d 6573   operation times
+00018c90: 0a6f 7574 292c 206f 7220 696e 2063 6173  .out), or in cas
+00018ca0: 6520 7468 6520 7365 7276 6572 2074 6872  e the server thr
+00018cb0: 6f77 7320 616e 2065 7863 6570 7469 6f6e  ows an exception
+00018cc0: 2077 6865 6e20 6861 6e64 6c69 6e67 2061   when handling a
+00018cd0: 2063 6c69 656e 7420 7265 7175 6573 742e   client request.
+00018ce0: 0a0a 506c 6561 7365 2061 6c73 6f20 6e6f  ..Please also no
+00018cf0: 7465 2c20 7468 6520 6173 7065 6374 7320  te, the aspects 
+00018d00: 6e6f 7420 636f 7665 7265 6420 6279 2074  not covered by t
+00018d10: 6865 2072 6563 6f6e 6e65 6374 2061 6e64  he reconnect and
+00018d20: 2072 6574 7279 2064 6563 6f72 6174 6f72   retry decorator
+00018d30: 0a62 6568 6176 696f 7572 7320 6861 7665  .behaviours have
+00018d40: 2074 6f20 646f 2077 6974 6820 6d65 7468   to do with meth
+00018d50: 6f64 7320 7468 6174 2072 6574 7572 6e20  ods that return 
+00018d60: 6974 6572 6174 6f72 732e 2046 6f72 2065  iterators. For e
+00018d70: 7861 6d70 6c65 2c20 636f 6e73 6964 6572  xample, consider
+00018d80: 0a74 6865 2022 7265 6164 2072 6573 706f  .the "read respo
+00018d90: 6e73 6522 2069 7465 7261 746f 7220 7265  nse" iterator re
+00018da0: 7475 726e 6564 2066 726f 6d20 7468 6520  turned from the 
+00018db0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00018dc0: 2829 6020 6d65 7468 6f64 2e20 5468 650a  ()` method. The.
+00018dd0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00018de0: 2829 6020 6d65 7468 6f64 2077 696c 6c20  ()` method will 
+00018df0: 6861 7665 2072 6574 7572 6e65 642c 2061  have returned, a
+00018e00: 6e64 2074 6865 206d 6574 686f 6420 6465  nd the method de
+00018e10: 636f 7261 746f 7273 2077 696c 6c20 7468  corators will th
+00018e20: 6572 6566 6f72 650a 6861 7665 2065 7869  erefore.have exi
+00018e30: 7465 642c 2062 6566 6f72 6520 6974 6572  ted, before iter
+00018e40: 6174 696e 6720 6f76 6572 2074 6865 2022  ating over the "
+00018e50: 7265 6164 2072 6573 706f 6e73 6522 2062  read response" b
+00018e60: 6567 696e 732e 2054 6865 7265 666f 7265  egins. Therefore
+00018e70: 2c20 6966 2061 0a63 6f6e 6e65 6374 696f  , if a.connectio
+00018e80: 6e20 6973 7375 6573 206f 6363 7572 7320  n issues occurs 
+00018e90: 7768 696c 7374 2069 7465 7261 7469 6e67  whilst iterating
+00018ea0: 206f 7665 7220 7468 6520 2272 6561 6420   over the "read 
+00018eb0: 7265 7370 6f6e 7365 222c 2069 7420 6973  response", it is
+00018ec0: 6e27 7420 706f 7373 6962 6c65 0a66 6f72  n't possible.for
+00018ed0: 2061 6e79 2064 6563 6f72 6174 6f72 206f   any decorator o
+00018ee0: 6e20 7468 6520 6072 6561 645f 616c 6c5f  n the `read_all_
+00018ef0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+00018f00: 2074 6f20 7472 6967 6765 7220 6120 7265   to trigger a re
+00018f10: 636f 6e6e 6563 7469 6f6e 2e0a 0a41 6e6f  connection...Ano
+00018f20: 7468 6572 2065 7861 6d70 6c65 2069 7320  ther example is 
+00018f30: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
+00018f40: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
+00018f50: 6522 2066 726f 6d20 6120 6361 7463 682d  e" from a catch-
+00018f60: 7570 2073 7562 7363 7269 7074 696f 6e2e  up subscription.
+00018f70: 0a41 6c74 686f 7567 682c 2077 6974 6820  .Although, with 
+00018f80: 7468 6573 6520 6d65 7468 6f64 7320 7468  these methods th
+00018f90: 6572 6520 6973 2061 6e20 696e 6974 6961  ere is an initia
+00018fa0: 6c20 2263 6f6e 6669 726d 6174 696f 6e22  l "confirmation"
+00018fb0: 2072 6573 706f 6e73 6520 6672 6f6d 2074   response from t
+00018fc0: 6865 2073 6572 7665 720a 7768 6963 6820  he server.which 
+00018fd0: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
+00018fe0: 6368 6563 6b65 6420 6279 2074 6865 2063  checked by the c
+00018ff0: 6c69 656e 7420 6265 666f 7265 2074 6865  lient before the
+00019000: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
+00019010: 7468 650a 2272 6561 6420 7265 7370 6f6e  the."read respon
+00019020: 7365 2220 6974 6572 6174 6f72 2e20 416e  se" iterator. An
+00019030: 6420 736f 2c20 7768 656e 2074 6865 2063  d so, when the c
+00019040: 616c 6c20 6973 206d 6164 652c 2069 6620  all is made, if 
+00019050: 7468 6520 7365 7276 6572 2069 7320 756e  the server is un
+00019060: 6176 6169 6c61 626c 652c 0a6f 7220 6966  available,.or if
+00019070: 2074 6865 2063 6861 6e6e 656c 2068 6173   the channel has
+00019080: 2073 6f6d 6568 6f77 2062 6565 6e20 636c   somehow been cl
+00019090: 6f73 6564 2c20 7468 656e 2074 6865 2063  osed, then the c
+000190a0: 6c69 656e 7420 7769 6c6c 2072 6563 6f6e  lient will recon
+000190b0: 6e65 6374 2061 6e64 2072 6574 7279 2e0a  nect and retry..
+000190c0: 486f 7765 7665 722c 2069 6620 616e 2065  However, if an e
+000190d0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+000190e0: 636f 6d70 6f6e 656e 7420 7468 6174 2069  component that i
+000190f0: 7320 6974 6572 6174 696e 6720 6f76 6572  s iterating over
+00019100: 2061 2073 7563 6365 7373 6675 6c6c 7920   a successfully 
+00019110: 7265 7475 726e 6564 0a63 6174 6368 2d75  returned.catch-u
+00019120: 7020 7375 6273 6372 6970 7469 6f6e 2022  p subscription "
+00019130: 7265 6164 2072 6573 706f 6e73 6522 2073  read response" s
+00019140: 6f6d 6568 6f77 2066 6169 6c73 2c20 7468  omehow fails, th
+00019150: 6520 6361 7463 682d 7570 2073 7562 7363  e catch-up subsc
+00019160: 7269 7074 696f 6e20 7769 6c6c 0a6e 6565  ription will.nee
+00019170: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
+00019180: 642c 2075 7369 6e67 2074 6865 2065 7665  d, using the eve
+00019190: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
+000191a0: 6d70 6f6e 656e 7427 7320 226c 6173 7420  mponent's "last 
+000191b0: 7361 7665 6420 636f 6d6d 6974 2070 6f73  saved commit pos
+000191c0: 6974 696f 6e22 2e0a 5468 6973 2069 7320  ition"..This is 
+000191d0: 636f 6d70 6c65 7465 6c79 2073 6166 652c  completely safe,
+000191e0: 2073 6f20 6c6f 6e67 2061 7320 7468 6520   so long as the 
+000191f0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00019200: 2063 6f6d 706f 6e65 6e74 2068 6173 2062   component has b
+00019210: 6565 6e20 7265 636f 7264 696e 670a 7468  een recording.th
+00019220: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00019230: 6e20 6f66 2065 6163 6820 7265 636f 7264  n of each record
+00019240: 6564 2065 7665 6e74 2061 746f 6d69 6361  ed event atomica
+00019250: 6c6c 7920 616e 6420 756e 6971 7565 6c79  lly and uniquely
+00019260: 2061 6c6f 6e67 2077 6974 6820 616e 7920   along with any 
+00019270: 6e65 770a 7374 6174 6520 7468 6174 2072  new.state that r
+00019280: 6573 756c 7473 2066 726f 6d20 7072 6f63  esults from proc
+00019290: 6573 7369 6e67 2074 6865 2072 6563 6f72  essing the recor
+000192a0: 6465 6420 6576 656e 7473 2061 6e64 2074  ded events and t
+000192b0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+000192c0: 6f6e 7320 6172 650a 7265 636f 7264 6564  ons are.recorded
+000192d0: 2077 6974 6820 6120 756e 6971 7565 6e65   with a uniquene
+000192e0: 7373 2063 6f6e 7374 7261 696e 742e 2049  ss constraint. I
+000192f0: 6e20 7468 6973 2063 6173 652c 2074 6865  n this case, the
+00019300: 2063 6c69 656e 7420 7769 6c6c 2061 7574   client will aut
+00019310: 6f6d 6174 6963 616c 6c79 0a72 6563 6f6e  omatically.recon
+00019320: 6e65 6374 2074 6f20 6120 6e6f 6465 2069  nect to a node i
+00019330: 6e20 7468 6520 636c 7573 7465 7220 7768  n the cluster wh
+00019340: 656e 2074 6865 2073 7562 7365 7175 656e  en the subsequen
+00019350: 7420 6361 6c6c 2074 6f20 6120 6361 7463  t call to a catc
+00019360: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+00019370: 6e0a 6d65 7468 6f64 2069 7320 6d61 6465  n.method is made
+00019380: 2e20 5369 6d69 6c61 726c 792c 2077 6865  . Similarly, whe
+00019390: 6e20 7265 6164 696e 6720 7065 7273 6973  n reading persis
+000193a0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+000193b0: 6e73 2c20 6966 2074 6865 7265 2061 7265  ns, if there are
+000193c0: 0a63 6f6e 6e65 6374 6976 6974 7920 6973  .connectivity is
+000193d0: 7375 6573 2061 6674 6572 2079 6f75 2068  sues after you h
+000193e0: 6176 6520 7374 6172 7465 6420 6974 6572  ave started iter
+000193f0: 6174 696e 6720 6f76 6572 2061 2073 7563  ating over a suc
+00019400: 6365 7373 6675 6c6c 7920 7265 6365 6976  cessfully receiv
+00019410: 6564 0a72 6573 706f 6e73 652c 2074 6865  ed.response, the
+00019420: 6e20 7468 6520 636f 6e73 756d 6572 2077  n the consumer w
+00019430: 696c 6c20 6e65 6564 2074 6f20 6265 2072  ill need to be r
+00019440: 6573 7461 7274 6564 2e0a 0a0a 2323 2320  estarted....### 
+00019450: 436c 6f73 650a 0a54 6865 2060 636c 6f73  Close..The `clos
+00019460: 6528 2960 206d 6574 686f 6420 6361 6e20  e()` method can 
+00019470: 6265 2075 7365 6420 746f 2063 6c65 616e  be used to clean
+00019480: 6c79 2063 6c6f 7365 2074 6865 2063 6c69  ly close the cli
+00019490: 656e 7427 7320 6752 5043 2063 6f6e 6e65  ent's gRPC conne
+000194a0: 6374 696f 6e2e 0a0a 6060 6070 7974 686f  ction...```pytho
+000194b0: 6e0a 636c 6965 6e74 2e63 6c6f 7365 2829  n.client.close()
+000194c0: 0a60 6060 0a0a 0a23 2320 4173 796e 6369  .```...## Asynci
+000194d0: 6f20 636c 6965 6e74 0a0a 5468 6520 6065  o client..The `e
+000194e0: 7364 6263 6c69 656e 7460 2070 6163 6b61  sdbclient` packa
+000194f0: 6765 2061 6c73 6f20 696e 636c 7564 6573  ge also includes
+00019500: 2061 6e20 6561 726c 7920 7665 7273 696f   an early versio
+00019510: 6e20 6f66 2061 6e20 6173 796e 6368 726f  n of an asynchro
+00019520: 6e6f 7573 2049 2f4f 0a67 5250 4320 5079  nous I/O.gRPC Py
+00019530: 7468 6f6e 2063 6c69 656e 742e 2049 7420  thon client. It 
+00019540: 666f 6c6c 6f77 7320 6578 6163 746c 7920  follows exactly 
+00019550: 7468 6520 7361 6d65 2062 6568 6176 696f  the same behavio
+00019560: 7273 2061 7320 7468 6520 6d75 6c74 6974  rs as the multit
+00019570: 6872 6561 6465 640a 6045 5344 4243 6c69  hreaded.`ESDBCli
+00019580: 656e 7460 2c20 6275 7420 7573 6573 2074  ent`, but uses t
+00019590: 6865 2060 6772 7063 2e61 696f 6020 7061  he `grpc.aio` pa
+000195a0: 636b 6167 6520 616e 6420 7468 6520 6061  ckage and the `a
+000195b0: 7379 6e63 696f 6020 6d6f 6475 6c65 2c20  syncio` module, 
+000195c0: 696e 7374 6561 6420 6f66 0a60 6772 7063  instead of.`grpc
+000195d0: 6020 616e 6420 6074 6872 6561 6469 6e67  ` and `threading
+000195e0: 602e 0a0a 5468 6520 6173 796e 6320 6675  `...The async fu
+000195f0: 6e63 7469 6f6e 2060 4173 796e 6369 6f45  nction `AsyncioE
+00019600: 5344 4243 6c69 656e 7460 2063 6f6e 7374  SDBClient` const
+00019610: 7275 6374 7320 7468 6520 636c 6965 6e74  ructs the client
+00019620: 2c20 616e 6420 636f 6e6e 6563 7473 2074  , and connects t
+00019630: 6f0a 6120 7365 7276 6572 2e20 4974 2063  o.a server. It c
+00019640: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
+00019650: 726f 6d20 6065 7364 6263 6c69 656e 7460  rom `esdbclient`
+00019660: 2c20 616e 6420 6361 6e20 6265 2063 616c  , and can be cal
+00019670: 6c65 6420 7769 7468 2074 6865 2073 616d  led with the sam
+00019680: 650a 6172 6775 6d65 6e74 7320 6173 2060  e.arguments as `
+00019690: 4553 4442 436c 6965 6e74 602e 2049 7420  ESDBClient`. It 
+000196a0: 7375 7070 6f72 7473 2062 6f74 6820 7468  supports both th
+000196b0: 6520 2265 7364 6222 2061 6e64 2074 6865  e "esdb" and the
+000196c0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+000196d0: 0a63 6f6e 6e65 6374 696f 6e20 7374 7269  .connection stri
+000196e0: 6e67 2055 5249 2073 6368 656d 6573 2c20  ng URI schemes, 
+000196f0: 616e 6420 6361 6e20 636f 6e6e 6563 7420  and can connect 
+00019700: 746f 2062 6f74 6820 2273 6563 7572 6522  to both "secure"
+00019710: 2061 6e64 2022 696e 7365 6375 7265 220a   and "insecure".
+00019720: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00019730: 7665 7273 2e20 4974 2072 6563 6f6e 6e65  vers. It reconne
+00019740: 6374 7320 6f72 2072 6574 7269 6573 2077  cts or retries w
+00019750: 6865 6e20 636f 6e6e 6563 7469 6f6e 2069  hen connection i
+00019760: 7373 7565 7320 6f72 2073 6572 7665 720a  ssues or server.
+00019770: 6572 726f 7273 2061 7265 2065 6e63 6f75  errors are encou
+00019780: 6e74 6572 6564 2e0a 0a60 6060 7079 7468  ntered...```pyth
+00019790: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+000197a0: 6e74 2069 6d70 6f72 7420 4173 796e 6369  nt import Asynci
+000197b0: 6f45 5344 4243 6c69 656e 740a 6060 600a  oESDBClient.```.
+000197c0: 0a54 6865 2061 7379 6e63 6872 6f6e 6f75  .The asynchronou
+000197d0: 7320 492f 4f20 636c 6965 6e74 2068 6173  s I/O client has
+000197e0: 2074 6865 2066 6f6c 6c6f 7769 6e67 206d   the following m
+000197f0: 6574 686f 6473 3a20 6061 7070 656e 645f  ethods: `append_
+00019800: 6576 656e 7473 2829 602c 0a60 7265 6164  events()`,.`read
+00019810: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00019820: 602c 2060 7265 6164 5f61 6c6c 5f65 7665  `, `read_all_eve
+00019830: 6e74 7328 2960 2c20 6073 7562 7363 7269  nts()`, `subscri
+00019840: 6265 5f61 6c6c 5f65 7665 6e74 7328 2960  be_all_events()`
+00019850: 2c0a 6064 656c 6574 655f 7374 7265 616d  ,.`delete_stream
+00019860: 2829 602c 2060 746f 6d62 7374 6f6e 655f  ()`, `tombstone_
+00019870: 7374 7265 616d 2829 602c 2061 6e64 2060  stream()`, and `
+00019880: 7265 636f 6e6e 6563 7428 2960 2e0a 0a54  reconnect()`...T
+00019890: 6865 7365 206d 6574 686f 6473 2061 7265  hese methods are
+000198a0: 2065 7175 6976 616c 656e 7420 746f 2074   equivalent to t
+000198b0: 6865 206d 6574 686f 6473 206f 6e20 6045  he methods on `E
+000198c0: 5344 4243 6c69 656e 7460 2e20 5468 6579  SDBClient`. They
+000198d0: 2068 6176 6520 7468 6520 7361 6d65 0a6d   have the same.m
+000198e0: 6574 686f 6420 7369 676e 6174 7572 6573  ethod signatures
+000198f0: 2c20 616e 6420 6361 6e20 6265 2063 616c  , and can be cal
+00019900: 6c65 6420 7769 7468 2074 6865 2073 616d  led with the sam
+00019910: 6520 6172 6775 6d65 6e74 732c 2074 6f20  e arguments, to 
+00019920: 7468 6520 7361 6d65 2065 6666 6563 742e  the same effect.
+00019930: 0a54 6865 206d 6574 686f 6473 2077 6869  .The methods whi
+00019940: 6368 2061 7070 6561 7220 6f6e 2060 4553  ch appear on `ES
+00019950: 4442 436c 6965 6e74 6020 6275 7420 6e6f  DBClient` but no
+00019960: 7420 6f6e 2060 4173 796e 6369 6f45 5344  t on `AsyncioESD
+00019970: 4243 6c69 656e 7460 2077 696c 6c20 6265  BClient` will be
+00019980: 0a61 6464 6564 2073 6f6f 6e2e 0a0a 2323  .added soon...##
+00019990: 2320 5379 6e6f 7073 6973 0a0a 5468 6520  # Synopsis..The 
+000199a0: 6578 616d 706c 6520 6265 6c6f 7720 6465  example below de
+000199b0: 6d6f 6e73 7472 6174 6573 2074 6865 2060  monstrates the `
+000199c0: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
+000199d0: 2c20 6072 6561 645f 7374 7265 616d 5f65  , `read_stream_e
+000199e0: 7665 6e74 7328 2960 2061 6e64 0a60 7375  vents()` and.`su
+000199f0: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+00019a00: 7473 2829 6020 6d65 7468 6f64 732e 2054  ts()` methods. T
+00019a10: 6865 7365 2061 7265 2074 6865 206d 6f73  hese are the mos
+00019a20: 7420 7573 6566 756c 206d 6574 686f 6473  t useful methods
+00019a30: 2066 6f72 2077 7269 7469 6e67 0a61 6e20   for writing.an 
+00019a40: 6576 656e 742d 736f 7572 6365 6420 6170  event-sourced ap
+00019a50: 706c 6963 6174 696f 6e2c 2061 6c6c 6f77  plication, allow
+00019a60: 696e 6720 6e65 7720 6167 6772 6567 6174  ing new aggregat
+00019a70: 6520 6576 656e 7473 2074 6f20 6265 2072  e events to be r
+00019a80: 6563 6f72 6465 642c 2074 6865 0a72 6563  ecorded, the.rec
+00019a90: 6f72 6465 6420 6576 656e 7473 206f 6620  orded events of 
+00019aa0: 616e 2061 6767 7265 6761 7465 2074 6f20  an aggregate to 
+00019ab0: 6265 206f 6274 6169 6e65 6420 736f 2061  be obtained so a
+00019ac0: 6767 7265 6761 7465 7320 6361 6e20 6265  ggregates can be
+00019ad0: 2072 6563 6f6e 7374 7275 6374 6564 2c0a   reconstructed,.
+00019ae0: 616e 6420 7468 6520 7374 6174 6520 6f66  and the state of
+00019af0: 2061 6e20 6170 706c 6963 6174 696f 6e20   an application 
+00019b00: 746f 2070 726f 7061 6761 7465 6420 616e  to propagated an
+00019b10: 6420 7072 6f63 6573 7365 6420 7769 7468  d processed with
+00019b20: 2022 6578 6163 746c 792d 6f6e 6365 220a   "exactly-once".
+00019b30: 7365 6d61 6e74 6963 732e 0a0a 6060 6070  semantics...```p
+00019b40: 7974 686f 6e0a 696d 706f 7274 2061 7379  ython.import asy
+00019b50: 6e63 696f 0a0a 6173 796e 6320 6465 6620  ncio..async def 
+00019b60: 6465 6d6f 6e73 7472 6174 655f 6173 796e  demonstrate_asyn
+00019b70: 6369 6f5f 636c 6965 6e74 2829 3a0a 0a20  cio_client():.. 
+00019b80: 2020 2023 2043 6f6e 7374 7275 6374 2063     # Construct c
+00019b90: 6c69 656e 742e 0a20 2020 2063 6c69 656e  lient..    clien
+00019ba0: 7420 3d20 6177 6169 7420 4173 796e 6369  t = await Asynci
+00019bb0: 6f45 5344 4243 6c69 656e 7428 0a20 2020  oESDBClient(.   
+00019bc0: 2020 2020 2075 7269 3d6f 732e 6765 7465       uri=os.gete
+00019bd0: 6e76 2822 4553 4442 5f55 5249 2229 2c0a  nv("ESDB_URI"),.
+00019be0: 2020 2020 2020 2020 726f 6f74 5f63 6572          root_cer
+00019bf0: 7469 6669 6361 7465 733d 6f73 2e67 6574  tificates=os.get
+00019c00: 656e 7628 2245 5344 425f 524f 4f54 5f43  env("ESDB_ROOT_C
+00019c10: 4552 5449 4649 4341 5445 5322 292c 0a20  ERTIFICATES"),. 
+00019c20: 2020 2029 0a0a 2020 2020 2320 4170 7065     )..    # Appe
+00019c30: 6e64 2065 7665 6e74 732e 0a20 2020 2073  nd events..    s
+00019c40: 7472 6561 6d5f 6e61 6d65 203d 2073 7472  tream_name = str
+00019c50: 2875 7569 642e 7575 6964 3428 2929 0a20  (uuid.uuid4()). 
+00019c60: 2020 2065 7665 6e74 3120 3d20 4e65 7745     event1 = NewE
+00019c70: 7665 6e74 2822 4f72 6465 7243 7265 6174  vent("OrderCreat
+00019c80: 6564 222c 2064 6174 613d 6227 7b7d 2729  ed", data=b'{}')
+00019c90: 0a20 2020 2065 7665 6e74 3220 3d20 4e65  .    event2 = Ne
+00019ca0: 7745 7665 6e74 2822 4f72 6465 7255 7064  wEvent("OrderUpd
+00019cb0: 6174 6564 222c 2064 6174 613d 6227 7b7d  ated", data=b'{}
+00019cc0: 2729 0a20 2020 2065 7665 6e74 3320 3d20  ').    event3 = 
+00019cd0: 4e65 7745 7665 6e74 2822 4f72 6465 7244  NewEvent("OrderD
+00019ce0: 656c 6574 6564 222c 2064 6174 613d 6227  eleted", data=b'
+00019cf0: 7b7d 2729 0a0a 2020 2020 636f 6d6d 6974  {}')..    commit
+00019d00: 5f70 6f73 6974 696f 6e20 3d20 6177 6169  _position = awai
+00019d10: 7420 636c 6965 6e74 2e61 7070 656e 645f  t client.append_
+00019d20: 6576 656e 7473 280a 2020 2020 2020 2020  events(.        
+00019d30: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00019d40: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
+00019d50: 2063 7572 7265 6e74 5f76 6572 7369 6f6e   current_version
+00019d60: 3d4e 6f6e 652c 0a20 2020 2020 2020 2065  =None,.        e
+00019d70: 7665 6e74 733d 5b65 7665 6e74 312c 2065  vents=[event1, e
+00019d80: 7665 6e74 322c 2065 7665 6e74 335d 0a20  vent2, event3]. 
+00019d90: 2020 2029 0a0a 2020 2020 2320 5265 6164     )..    # Read
+00019da0: 2073 7472 6561 6d20 6576 656e 7473 2e0a   stream events..
+00019db0: 2020 2020 7265 636f 7264 6564 203d 2061      recorded = a
+00019dc0: 7761 6974 2063 6c69 656e 742e 7265 6164  wait client.read
+00019dd0: 5f73 7472 6561 6d5f 6576 656e 7473 2873  _stream_events(s
+00019de0: 7472 6561 6d5f 6e61 6d65 290a 2020 2020  tream_name).    
+00019df0: 6173 7365 7274 206c 656e 2872 6563 6f72  assert len(recor
+00019e00: 6465 6429 203d 3d20 330a 2020 2020 6173  ded) == 3.    as
+00019e10: 7365 7274 2072 6563 6f72 6465 645b 305d  sert recorded[0]
+00019e20: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
+00019e30: 0a20 2020 2061 7373 6572 7420 7265 636f  .    assert reco
+00019e40: 7264 6564 5b31 5d2e 6964 203d 3d20 6576  rded[1].id == ev
+00019e50: 656e 7432 2e69 640a 2020 2020 6173 7365  ent2.id.    asse
+00019e60: 7274 2072 6563 6f72 6465 645b 325d 2e69  rt recorded[2].i
+00019e70: 6420 3d3d 2065 7665 6e74 332e 6964 0a0a  d == event3.id..
+00019e80: 0a20 2020 2023 2053 7562 7363 7269 6265  .    # Subscribe
+00019e90: 2061 6c6c 2065 7665 6e74 732e 0a20 2020   all events..   
+00019ea0: 2072 6563 6569 7665 6420 3d20 5b5d 0a20   received = []. 
+00019eb0: 2020 2061 7379 6e63 2066 6f72 2065 7665     async for eve
+00019ec0: 6e74 2069 6e20 6177 6169 7420 636c 6965  nt in await clie
+00019ed0: 6e74 2e73 7562 7363 7269 6265 5f61 6c6c  nt.subscribe_all
+00019ee0: 5f65 7665 6e74 7328 293a 0a20 2020 2020  _events():.     
+00019ef0: 2020 2072 6563 6569 7665 642e 6170 7065     received.appe
+00019f00: 6e64 2865 7665 6e74 290a 2020 2020 2020  nd(event).      
+00019f10: 2020 6966 2065 7665 6e74 2e63 6f6d 6d69    if event.commi
+00019f20: 745f 706f 7369 7469 6f6e 203d 3d20 636f  t_position == co
+00019f30: 6d6d 6974 5f70 6f73 6974 696f 6e3a 0a20  mmit_position:. 
+00019f40: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00019f50: 0a20 2020 2061 7373 6572 7420 7265 6365  .    assert rece
+00019f60: 6976 6564 5b2d 335d 2e69 6420 3d3d 2065  ived[-3].id == e
+00019f70: 7665 6e74 312e 6964 0a20 2020 2061 7373  vent1.id.    ass
+00019f80: 6572 7420 7265 6365 6976 6564 5b2d 325d  ert received[-2]
+00019f90: 2e69 6420 3d3d 2065 7665 6e74 322e 6964  .id == event2.id
+00019fa0: 0a20 2020 2061 7373 6572 7420 7265 6365  .    assert rece
+00019fb0: 6976 6564 5b2d 315d 2e69 6420 3d3d 2065  ived[-1].id == e
+00019fc0: 7665 6e74 332e 6964 0a0a 0a20 2020 2023  vent3.id...    #
+00019fd0: 2043 6c6f 7365 2074 6865 2063 6c69 656e   Close the clien
+00019fe0: 742e 0a20 2020 2061 7761 6974 2063 6c69  t..    await cli
+00019ff0: 656e 742e 636c 6f73 6528 290a 0a0a 2320  ent.close()...# 
+0001a000: 5275 6e20 7468 6520 6465 6d6f 2e0a 6173  Run the demo..as
+0001a010: 796e 6369 6f2e 6765 745f 6576 656e 745f  yncio.get_event_
+0001a020: 6c6f 6f70 2829 2e72 756e 5f75 6e74 696c  loop().run_until
+0001a030: 5f63 6f6d 706c 6574 6528 0a20 2020 2064  _complete(.    d
+0001a040: 656d 6f6e 7374 7261 7465 5f61 7379 6e63  emonstrate_async
+0001a050: 696f 5f63 6c69 656e 7428 290a 290a 6060  io_client().).``
+0001a060: 600a 0a23 2320 4e6f 7465 730a 0a23 2323  `..## Notes..###
+0001a070: 2052 6567 756c 6172 2065 7870 7265 7373   Regular express
+0001a080: 696f 6e20 6669 6c74 6572 730a 0a54 6865  ion filters..The
+0001a090: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
+0001a0a0: 7328 2960 2c20 6073 7562 7363 7269 6265  s()`, `subscribe
+0001a0b0: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c20  _all_events()`, 
+0001a0c0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
+0001a0d0: 7469 6f6e 2829 600a 616e 6420 6067 6574  tion()`.and `get
+0001a0e0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
+0001a0f0: 2829 6020 6d65 7468 6f64 7320 6861 7665  ()` methods have
+0001a100: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
+0001a110: 6020 616e 6420 6066 696c 7465 725f 696e  ` and `filter_in
+0001a120: 636c 7564 6560 0a61 7267 756d 656e 7473  clude`.arguments
+0001a130: 2e20 5468 6973 2073 6563 7469 6f6e 2070  . This section p
+0001a140: 726f 7669 6465 7320 736f 6d65 206d 6f72  rovides some mor
+0001a150: 6520 6465 7461 696c 7320 6162 6f75 7420  e details about 
+0001a160: 7468 6520 7661 6c75 6573 206f 6620 7468  the values of th
+0001a170: 6573 650a 6172 6775 6d65 6e74 732e 0a0a  ese.arguments...
+0001a180: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0001a190: 6520 6f66 2074 6865 2060 6669 6c74 6572  e of the `filter
+0001a1a0: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+0001a1b0: 6e74 7320 6973 2064 6573 6967 6e65 6420  nts is designed 
+0001a1c0: 746f 2065 7863 6c75 6465 0a45 7665 6e74  to exclude.Event
+0001a1d0: 5374 6f72 6544 4220 2273 7973 7465 6d22  StoreDB "system"
+0001a1e0: 2061 6e64 2022 7065 7273 6973 7465 6e63   and "persistenc
+0001a1f0: 6520 7375 6273 6372 6970 7469 6f6e 2063  e subscription c
+0001a200: 6f6e 6669 6722 2065 7665 6e74 732c 2077  onfig" events, w
+0001a210: 6869 6368 0a6f 7468 6572 7769 7365 2077  hich.otherwise w
+0001a220: 6f75 6c64 2062 6520 696e 636c 7564 6564  ould be included
+0001a230: 2e0a 0a53 7973 7465 6d20 6576 656e 7473  ...System events
+0001a240: 2067 656e 6572 6174 6564 2062 7920 4576   generated by Ev
+0001a250: 656e 7453 746f 7265 4442 2068 6176 6520  entStoreDB have 
+0001a260: 6074 7970 6560 2073 7472 696e 6773 2074  `type` strings t
+0001a270: 6861 7420 7374 6172 7420 7769 7468 0a74  hat start with.t
+0001a280: 6865 2060 2460 2073 6967 6e2e 2050 6572  he `$` sign. Per
+0001a290: 7369 7374 656e 6365 2073 7562 7363 7269  sistence subscri
+0001a2a0: 7074 696f 6e20 6576 656e 7473 2067 656e  ption events gen
+0001a2b0: 6572 6174 6564 2077 6865 6e20 6d61 6e69  erated when mani
+0001a2c0: 7075 6c61 7469 6e67 0a70 6572 7369 7374  pulating.persist
+0001a2d0: 656e 6365 2073 7562 7363 7269 7074 696f  ence subscriptio
+0001a2e0: 6e73 2068 6176 6520 6074 7970 6560 2073  ns have `type` s
+0001a2f0: 7472 696e 6773 2074 6861 7420 7374 6172  trings that star
+0001a300: 7420 7769 7468 2060 5065 7273 6973 7465  t with `Persiste
+0001a310: 6e74 436f 6e66 6967 602e 0a0a 466f 7220  ntConfig`...For 
+0001a320: 6578 616d 706c 652c 2074 6f20 6d61 7463  example, to matc
+0001a330: 6820 7468 6520 7479 7065 206f 6620 4576  h the type of Ev
+0001a340: 656e 7453 746f 7265 4442 2073 7973 7465  entStoreDB syste
+0001a350: 6d20 6576 656e 7473 2c20 7573 6520 7468  m events, use th
+0001a360: 6520 7265 6775 6c61 720a 6578 7072 6573  e regular.expres
+0001a370: 7369 6f6e 2073 7472 696e 6720 6072 275c  sion string `r'\
+0001a380: 242e 2b27 602e 2050 6c65 6173 6520 6e6f  $.+'`. Please no
+0001a390: 7465 2c20 7468 6520 636f 6e73 7461 6e74  te, the constant
+0001a3a0: 2060 4553 4442 5f53 5953 5445 4d5f 4556   `ESDB_SYSTEM_EV
+0001a3b0: 454e 5453 5f52 4547 4558 6020 6973 0a73  ENTS_REGEX` is.s
+0001a3c0: 6574 2074 6f20 7468 6973 2076 616c 7565  et to this value
+0001a3d0: 2e20 596f 7520 6361 6e20 696d 706f 7274  . You can import
+0001a3e0: 2074 6869 7320 636f 6e73 7461 6e74 2066   this constant f
+0001a3f0: 726f 6d20 6065 7364 6263 6c69 656e 7460  rom `esdbclient`
+0001a400: 2061 6e64 2075 7365 2069 7420 7768 656e   and use it when
+0001a410: 0a62 7569 6c64 696e 6720 6c6f 6e67 6572  .building longer
+0001a420: 2073 6571 7565 6e63 6573 206f 6620 7265   sequences of re
+0001a430: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
+0001a440: 732e 0a0a 5369 6d69 6c61 726c 792c 2074  s...Similarly, t
+0001a450: 6f20 6d61 7463 6820 7468 6520 7479 7065  o match the type
+0001a460: 206f 6620 4576 656e 7453 746f 7265 4442   of EventStoreDB
+0001a470: 2070 6572 7369 7374 656e 6365 2073 7562   persistence sub
+0001a480: 7363 7269 7074 696f 6e20 6576 656e 7473  scription events
+0001a490: 2c20 7573 6520 7468 650a 7265 6775 6c61  , use the.regula
+0001a4a0: 7220 6578 7072 6573 7369 6f6e 2060 7227  r expression `r'
+0001a4b0: 5065 7273 6973 7465 6e74 436f 6e66 6967  PersistentConfig
+0001a4c0: 5c64 2b27 602e 2054 6865 2063 6f6e 7374  \d+'`. The const
+0001a4d0: 616e 7420 6045 5344 425f 5045 5253 4953  ant `ESDB_PERSIS
+0001a4e0: 5445 4e54 5f43 4f4e 4649 475f 4556 454e  TENT_CONFIG_EVEN
+0001a4f0: 5453 5f52 4547 4558 600a 6973 2073 6574  TS_REGEX`.is set
+0001a500: 2074 6f20 7468 6973 2076 616c 7565 2e20   to this value. 
+0001a510: 596f 7520 6361 6e20 696d 706f 7274 2074  You can import t
+0001a520: 6869 7320 636f 6e73 7461 6e74 2066 726f  his constant fro
+0001a530: 6d20 6065 7364 6263 6c69 656e 7460 2020  m `esdbclient`  
+0001a540: 616e 6420 7573 6520 6974 2077 6865 6e0a  and use it when.
+0001a550: 6275 696c 6469 6e67 206c 6f6e 6765 7220  building longer 
+0001a560: 7365 7175 656e 6365 7320 6f66 2072 6567  sequences of reg
+0001a570: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
+0001a580: 2e0a 0a54 6865 2063 6f6e 7374 616e 7420  ...The constant 
+0001a590: 6044 4546 4155 4c54 5f45 5843 4c55 4445  `DEFAULT_EXCLUDE
+0001a5a0: 5f46 494c 5445 5260 2069 7320 6120 7365  _FILTER` is a se
+0001a5b0: 7175 656e 6365 206f 6620 7265 6775 6c61  quence of regula
+0001a5c0: 7220 6578 7072 6573 7369 6f6e 7320 7468  r expressions th
+0001a5d0: 6174 2069 6e63 6c75 6465 730a 626f 7468  at includes.both
+0001a5e0: 2060 4553 4442 5f53 5953 5445 4d5f 4556   `ESDB_SYSTEM_EV
+0001a5f0: 454e 5453 5f52 4547 4558 6020 616e 6420  ENTS_REGEX` and 
+0001a600: 6045 5344 425f 5045 5253 4953 5445 4e54  `ESDB_PERSISTENT
+0001a610: 5f43 4f4e 4649 475f 4556 454e 5453 5f52  _CONFIG_EVENTS_R
+0001a620: 4547 4558 602e 2049 7420 6973 2075 7365  EGEX`. It is use
+0001a630: 640a 6173 2074 6865 2064 6566 6175 6c74  d.as the default
+0001a640: 2076 616c 7565 206f 6620 6066 696c 7465   value of `filte
+0001a650: 725f 6578 636c 7564 6560 2073 6f20 7468  r_exclude` so th
+0001a660: 6174 2074 6865 2065 7665 6e74 7320 7468  at the events th
+0001a670: 6174 2045 7665 6e74 5374 6f72 6544 4220  at EventStoreDB 
+0001a680: 6765 6e65 7261 7465 730a 696e 7465 726e  generates.intern
+0001a690: 616c 6c79 2061 7265 2065 7863 6c75 6465  ally are exclude
+0001a6a0: 6420 6279 2064 6566 6175 6c74 2c20 6576  d by default, ev
+0001a6b0: 656e 7473 206f 7468 6572 2074 6861 6e20  ents other than 
+0001a6c0: 746f 2074 686f 7365 2077 6869 6368 2079  to those which y
+0001a6d0: 6f75 2072 6563 6f72 6420 7573 696e 670a  ou record using.
+0001a6e0: 7468 6520 6061 7070 656e 645f 6576 656e  the `append_even
+0001a6f0: 7473 2829 6020 6d65 7468 6f64 2e0a 0a49  ts()` method...I
+0001a700: 6620 796f 7520 7761 6e74 2074 6f20 6578  f you want to ex
+0001a710: 636c 7564 652c 2066 6f72 2065 7861 6d70  clude, for examp
+0001a720: 6c65 2c20 736e 6170 7368 6f74 7320 6672  le, snapshots fr
+0001a730: 6f6d 2074 6865 2072 6563 6f72 6465 6420  om the recorded 
+0001a740: 6576 656e 7473 2072 6574 7572 6e65 6420  events returned 
+0001a750: 7768 656e 0a72 6561 6469 6e67 2065 7665  when.reading eve
+0001a760: 6e74 7320 6672 6f6d 2074 6865 2064 6174  nts from the dat
+0001a770: 6162 6173 652c 2074 6865 6e20 796f 7520  abase, then you 
+0001a780: 6d61 7920 7769 7368 2074 6f20 7573 6520  may wish to use 
+0001a790: 6120 6170 7072 6f70 7269 6174 656c 7920  a appropriately 
+0001a7a0: 6578 7465 6e64 6564 0a63 6f70 7920 6f66  extended.copy of
+0001a7b0: 2060 4445 4641 554c 545f 4558 434c 5544   `DEFAULT_EXCLUD
+0001a7c0: 455f 4649 4c54 4552 6020 6173 2074 6865  E_FILTER` as the
+0001a7d0: 2076 616c 7565 206f 6620 7468 6520 6066   value of the `f
+0001a7e0: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
+0001a7f0: 7267 756d 656e 7473 2e0a 0a0a 2323 2043  rguments....## C
+0001a800: 6f6e 7472 6962 7574 6f72 730a 0a23 2323  ontributors..###
+0001a810: 2049 6e73 7461 6c6c 2050 6f65 7472 790a   Install Poetry.
+0001a820: 0a54 6865 2066 6972 7374 2074 6869 6e67  .The first thing
+0001a830: 2069 7320 746f 2063 6865 636b 2079 6f75   is to check you
+0001a840: 2068 6176 6520 506f 6574 7279 2069 6e73   have Poetry ins
+0001a850: 7461 6c6c 6564 2e0a 0a20 2020 2024 2070  talled...    $ p
+0001a860: 6f65 7472 7920 2d2d 7665 7273 696f 6e0a  oetry --version.
+0001a870: 0a49 6620 796f 7520 646f 6e27 742c 2074  .If you don't, t
+0001a880: 6865 6e20 706c 6561 7365 205b 696e 7374  hen please [inst
+0001a890: 616c 6c20 506f 6574 7279 5d28 6874 7470  all Poetry](http
+0001a8a0: 733a 2f2f 7079 7468 6f6e 2d70 6f65 7472  s://python-poetr
+0001a8b0: 792e 6f72 672f 646f 6373 2f23 696e 7374  y.org/docs/#inst
+0001a8c0: 616c 6c69 6e67 2d77 6974 682d 7468 652d  alling-with-the-
+0001a8d0: 6f66 6669 6369 616c 2d69 6e73 7461 6c6c  official-install
+0001a8e0: 6572 292e 0a0a 2020 2020 2420 6375 726c  er)...    $ curl
+0001a8f0: 202d 7353 4c20 6874 7470 733a 2f2f 696e   -sSL https://in
+0001a900: 7374 616c 6c2e 7079 7468 6f6e 2d70 6f65  stall.python-poe
+0001a910: 7472 792e 6f72 6720 7c20 7079 7468 6f6e  try.org | python
+0001a920: 3320 2d0a 0a49 7420 7769 6c6c 2068 656c  3 -..It will hel
+0001a930: 7020 746f 206d 616b 6520 7375 7265 2050  p to make sure P
+0001a940: 6f65 7472 7927 7320 6269 6e20 6469 7265  oetry's bin dire
+0001a950: 6374 6f72 7920 6973 2069 6e20 796f 7572  ctory is in your
+0001a960: 2060 5041 5448 6020 656e 7669 726f 6e6d   `PATH` environm
+0001a970: 656e 7420 7661 7269 6162 6c65 2e0a 0a42  ent variable...B
+0001a980: 7574 2069 6e20 616e 7920 6361 7365 2c20  ut in any case, 
+0001a990: 6d61 6b65 2073 7572 6520 796f 7520 6b6e  make sure you kn
+0001a9a0: 6f77 2074 6865 2070 6174 6820 746f 2074  ow the path to t
+0001a9b0: 6865 2060 706f 6574 7279 6020 6578 6563  he `poetry` exec
+0001a9c0: 7574 6162 6c65 2e20 5468 6520 506f 6574  utable. The Poet
+0001a9d0: 7279 0a69 6e73 7461 6c6c 6572 2074 656c  ry.installer tel
+0001a9e0: 6c73 2079 6f75 2077 6865 7265 2069 7420  ls you where it 
+0001a9f0: 6861 7320 6265 656e 2069 6e73 7461 6c6c  has been install
+0001aa00: 6564 2c20 616e 6420 686f 7720 746f 2063  ed, and how to c
+0001aa10: 6f6e 6669 6775 7265 2079 6f75 7220 7368  onfigure your sh
+0001aa20: 656c 6c2e 0a0a 506c 6561 7365 2072 6566  ell...Please ref
+0001aa30: 6572 2074 6f20 7468 6520 5b50 6f65 7472  er to the [Poetr
+0001aa40: 7920 646f 6373 5d28 6874 7470 733a 2f2f  y docs](https://
+0001aa50: 7079 7468 6f6e 2d70 6f65 7472 792e 6f72  python-poetry.or
+0001aa60: 672f 646f 6373 2f29 2066 6f72 2067 7569  g/docs/) for gui
+0001aa70: 6461 6e63 6520 6f6e 0a75 7369 6e67 2050  dance on.using P
+0001aa80: 6f65 7472 792e 0a0a 2323 2320 5365 7475  oetry...### Setu
+0001aa90: 7020 666f 7220 5079 4368 6172 6d20 7573  p for PyCharm us
+0001aaa0: 6572 730a 0a59 6f75 2063 616e 2065 6173  ers..You can eas
+0001aab0: 696c 7920 6f62 7461 696e 2074 6865 2070  ily obtain the p
+0001aac0: 726f 6a65 6374 2066 696c 6573 2075 7369  roject files usi
+0001aad0: 6e67 2050 7943 6861 726d 2028 6d65 6e75  ng PyCharm (menu
+0001aae0: 2022 4769 7420 3e20 436c 6f6e 652e 2e2e   "Git > Clone...
+0001aaf0: 2229 2e0a 5079 4368 6172 6d20 7769 6c6c  ")..PyCharm will
+0001ab00: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
+0001ab10: 6f6d 7074 2079 6f75 2074 6f20 6f70 656e  ompt you to open
+0001ab20: 2074 6865 2070 726f 6a65 6374 2e0a 0a4f   the project...O
+0001ab30: 7065 6e20 7468 6520 7072 6f6a 6563 7420  pen the project 
+0001ab40: 696e 2061 206e 6577 2077 696e 646f 772e  in a new window.
+0001ab50: 2050 7943 6861 726d 2077 696c 6c20 7468   PyCharm will th
+0001ab60: 656e 2075 7375 616c 6c79 2070 726f 6d70  en usually promp
+0001ab70: 7420 796f 7520 746f 2063 7265 6174 650a  t you to create.
+0001ab80: 6120 6e65 7720 7669 7274 7561 6c20 656e  a new virtual en
+0001ab90: 7669 726f 6e6d 656e 742e 0a0a 4372 6561  vironment...Crea
+0001aba0: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
+0001abb0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+0001abc0: 656e 7420 666f 7220 7468 6520 7072 6f6a  ent for the proj
+0001abd0: 6563 742e 2049 6620 5079 4368 6172 6d20  ect. If PyCharm 
+0001abe0: 646f 6573 6e27 7420 616c 7265 6164 790a  doesn't already.
+0001abf0: 6b6e 6f77 2077 6865 7265 2079 6f75 7220  know where your 
+0001ac00: 6070 6f65 7472 7960 2065 7865 6375 7461  `poetry` executa
+0001ac10: 626c 6520 6973 2c20 7468 656e 2073 6574  ble is, then set
+0001ac20: 2074 6865 2070 6174 6820 746f 2079 6f75   the path to you
+0001ac30: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
+0001ac40: 7461 626c 650a 696e 2074 6865 2022 4e65  table.in the "Ne
+0001ac50: 7720 506f 6574 7279 2045 6e76 6972 6f6e  w Poetry Environ
+0001ac60: 6d65 6e74 2220 666f 726d 2069 6e70 7574  ment" form input
+0001ac70: 2066 6965 6c64 206c 6162 656c 6c65 6420   field labelled 
+0001ac80: 2250 6f65 7472 7920 6578 6563 7574 6162  "Poetry executab
+0001ac90: 6c65 222e 2049 6e20 7468 650a 224e 6577  le". In the."New
+0001aca0: 2050 6f65 7472 7920 456e 7669 726f 6e6d   Poetry Environm
+0001acb0: 656e 7422 2066 6f72 6d2c 2079 6f75 2077  ent" form, you w
+0001acc0: 696c 6c20 616c 736f 2068 6176 6520 7468  ill also have th
+0001acd0: 6520 6f70 706f 7274 756e 6974 7920 746f  e opportunity to
+0001ace0: 2073 656c 6563 7420 7768 6963 680a 5079   select which.Py
+0001acf0: 7468 6f6e 2065 7865 6375 7461 626c 6520  thon executable 
+0001ad00: 7769 6c6c 2062 6520 7573 6564 2062 7920  will be used by 
+0001ad10: 7468 6520 7669 7274 7561 6c20 656e 7669  the virtual envi
+0001ad20: 726f 6e6d 656e 742e 0a0a 5079 4368 6172  ronment...PyChar
+0001ad30: 6d20 7769 6c6c 2074 6865 6e20 6372 6561  m will then crea
+0001ad40: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
+0001ad50: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+0001ad60: 656e 7420 666f 7220 796f 7572 2070 726f  ent for your pro
+0001ad70: 6a65 6374 2c20 7573 696e 670a 6120 7061  ject, using.a pa
+0001ad80: 7274 6963 756c 6172 2076 6572 7369 6f6e  rticular version
+0001ad90: 206f 6620 5079 7468 6f6e 2c20 616e 6420   of Python, and 
+0001ada0: 616c 736f 2069 6e73 7461 6c6c 2069 6e74  also install int
+0001adb0: 6f20 7468 6973 2076 6972 7475 616c 2065  o this virtual e
+0001adc0: 6e76 6972 6f6e 6d65 6e74 2074 6865 0a70  nvironment the.p
+0001add0: 726f 6a65 6374 2773 2070 6163 6b61 6765  roject's package
+0001ade0: 2064 6570 656e 6465 6e63 6965 7320 6163   dependencies ac
+0001adf0: 636f 7264 696e 6720 746f 2074 6865 2070  cording to the p
+0001ae00: 726f 6a65 6374 2773 2060 706f 6574 7279  roject's `poetry
+0001ae10: 2e6c 6f63 6b60 2066 696c 652e 0a0a 596f  .lock` file...Yo
+0001ae20: 7520 6361 6e20 6164 6420 6469 6666 6572  u can add differ
+0001ae30: 656e 7420 506f 6574 7279 2065 6e76 6972  ent Poetry envir
+0001ae40: 6f6e 6d65 6e74 7320 666f 7220 6469 6666  onments for diff
+0001ae50: 6572 656e 7420 5079 7468 6f6e 2076 6572  erent Python ver
+0001ae60: 7369 6f6e 732c 2061 6e64 2073 7769 7463  sions, and switc
+0001ae70: 680a 6265 7477 6565 6e20 7468 656d 2075  h.between them u
+0001ae80: 7369 6e67 2074 6865 2022 5079 7468 6f6e  sing the "Python
+0001ae90: 2049 6e74 6572 7072 6574 6572 2220 7365   Interpreter" se
+0001aea0: 7474 696e 6773 206f 6620 5079 4368 6172  ttings of PyChar
+0001aeb0: 6d2e 2049 6620 796f 7520 7761 6e74 2074  m. If you want t
+0001aec0: 6f20 7573 650a 6120 7665 7273 696f 6e20  o use.a version 
+0001aed0: 6f66 2050 7974 686f 6e20 7468 6174 2069  of Python that i
+0001aee0: 736e 2774 2069 6e73 7461 6c6c 6564 2c20  sn't installed, 
+0001aef0: 6569 7468 6572 2075 7365 2079 6f75 7220  either use your 
+0001af00: 6661 766f 7572 6974 6520 7061 636b 6167  favourite packag
+0001af10: 6520 6d61 6e61 6765 722c 0a6f 7220 696e  e manager,.or in
+0001af20: 7374 616c 6c20 5079 7468 6f6e 2062 7920  stall Python by 
+0001af30: 646f 776e 6c6f 6164 696e 6720 616e 2069  downloading an i
+0001af40: 6e73 7461 6c6c 6572 2066 6f72 2072 6563  nstaller for rec
+0001af50: 656e 7420 7665 7273 696f 6e73 206f 6620  ent versions of 
+0001af60: 5079 7468 6f6e 2064 6972 6563 746c 790a  Python directly.
+0001af70: 6672 6f6d 2074 6865 205b 5079 7468 6f6e  from the [Python
+0001af80: 2077 6562 7369 7465 5d28 6874 7470 733a   website](https:
+0001af90: 2f2f 7777 772e 7079 7468 6f6e 2e6f 7267  //www.python.org
+0001afa0: 2f64 6f77 6e6c 6f61 6473 2f29 2e0a 0a4f  /downloads/)...O
+0001afb0: 6e63 6520 7072 6f6a 6563 7420 6465 7065  nce project depe
+0001afc0: 6e64 656e 6369 6573 2068 6176 6520 6265  ndencies have be
+0001afd0: 656e 2069 6e73 7461 6c6c 6564 2c20 796f  en installed, yo
+0001afe0: 7520 7368 6f75 6c64 2062 6520 6162 6c65  u should be able
+0001aff0: 2074 6f20 7275 6e20 7465 7374 730a 6672   to run tests.fr
+0001b000: 6f6d 2077 6974 6869 6e20 5079 4368 6172  om within PyChar
+0001b010: 6d20 2872 6967 6874 2d63 6c69 636b 206f  m (right-click o
+0001b020: 6e20 7468 6520 6074 6573 7473 6020 666f  n the `tests` fo
+0001b030: 6c64 6572 2061 6e64 2073 656c 6563 7420  lder and select 
+0001b040: 7468 6520 2752 756e 2720 6f70 7469 6f6e  the 'Run' option
+0001b050: 292e 0a0a 4265 6361 7573 6520 6f66 2061  )...Because of a
+0001b060: 2063 6f6e 666c 6963 7420 6265 7477 6565   conflict betwee
+0001b070: 6e20 7079 7465 7374 2061 6e64 2050 7943  n pytest and PyC
+0001b080: 6861 726d 2773 2064 6562 7567 6765 7220  harm's debugger 
+0001b090: 616e 6420 7468 6520 636f 7665 7261 6765  and the coverage
+0001b0a0: 2074 6f6f 6c2c 0a79 6f75 206d 6179 206e   tool,.you may n
+0001b0b0: 6565 6420 746f 2061 6464 2060 602d 2d6e  eed to add ``--n
+0001b0c0: 6f2d 636f 7660 6020 6173 2061 6e20 6f70  o-cov`` as an op
+0001b0d0: 7469 6f6e 2074 6f20 7468 6520 7465 7374  tion to the test
+0001b0e0: 2072 756e 6e65 7220 7465 6d70 6c61 7465   runner template
+0001b0f0: 2e20 416c 7465 726e 6174 6976 656c 792c  . Alternatively,
+0001b100: 0a6a 7573 7420 7573 6520 7468 6520 5079  .just use the Py
+0001b110: 7468 6f6e 2053 7461 6e64 6172 6420 4c69  thon Standard Li
+0001b120: 6272 6172 7927 7320 6060 756e 6974 7465  brary's ``unitte
+0001b130: 7374 6060 206d 6f64 756c 652e 0a0a 596f  st`` module...Yo
+0001b140: 7520 7368 6f75 6c64 2061 6c73 6f20 6265  u should also be
+0001b150: 2061 626c 6520 746f 206f 7065 6e20 6120   able to open a 
+0001b160: 7465 726d 696e 616c 2077 696e 646f 7720  terminal window 
+0001b170: 696e 2050 7943 6861 726d 2c20 616e 6420  in PyCharm, and 
+0001b180: 7275 6e20 7468 6520 7072 6f6a 6563 7427  run the project'
+0001b190: 730a 4d61 6b65 6669 6c65 2063 6f6d 6d61  s.Makefile comma
+0001b1a0: 6e64 7320 6672 6f6d 2074 6865 2063 6f6d  nds from the com
+0001b1b0: 6d61 6e64 206c 696e 6520 2873 6565 2062  mand line (see b
+0001b1c0: 656c 6f77 292e 0a0a 2323 2320 5365 7475  elow)...### Setu
+0001b1d0: 7020 6672 6f6d 2063 6f6d 6d61 6e64 206c  p from command l
+0001b1e0: 696e 650a 0a4f 6274 6169 6e20 7468 6520  ine..Obtain the 
+0001b1f0: 7072 6f6a 6563 7420 6669 6c65 732c 2075  project files, u
+0001b200: 7369 6e67 2047 6974 206f 7220 7375 6974  sing Git or suit
+0001b210: 6162 6c65 2061 6c74 6572 6e61 7469 7665  able alternative
+0001b220: 2e0a 0a49 6e20 6120 7465 726d 696e 616c  ...In a terminal
+0001b230: 2061 7070 6c69 6361 7469 6f6e 2c20 6368   application, ch
+0001b240: 616e 6765 2079 6f75 7220 6375 7272 656e  ange your curren
+0001b250: 7420 776f 726b 696e 6720 6469 7265 6374  t working direct
+0001b260: 6f72 790a 746f 2074 6865 2072 6f6f 7420  ory.to the root 
+0001b270: 666f 6c64 6572 206f 6620 7468 6520 7072  folder of the pr
+0001b280: 6f6a 6563 7420 6669 6c65 732e 2054 6865  oject files. The
+0001b290: 7265 2073 686f 756c 6420 6265 2061 204d  re should be a M
+0001b2a0: 616b 6566 696c 650a 696e 2074 6869 7320  akefile.in this 
+0001b2b0: 666f 6c64 6572 2e0a 0a55 7365 2074 6865  folder...Use the
+0001b2c0: 204d 616b 6566 696c 6520 746f 2063 7265   Makefile to cre
+0001b2d0: 6174 6520 6120 6e65 7720 506f 6574 7279  ate a new Poetry
+0001b2e0: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
+0001b2f0: 6d65 6e74 2066 6f72 2074 6865 0a70 726f  ment for the.pro
+0001b300: 6a65 6374 2061 6e64 2069 6e73 7461 6c6c  ject and install
+0001b310: 2074 6865 2070 726f 6a65 6374 2773 2070   the project's p
+0001b320: 6163 6b61 6765 2064 6570 656e 6465 6e63  ackage dependenc
+0001b330: 6965 7320 696e 746f 2069 742c 0a75 7369  ies into it,.usi
+0001b340: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+0001b350: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
+0001b360: 206d 616b 6520 696e 7374 616c 6c2d 7061   make install-pa
+0001b370: 636b 6167 6573 0a0a 4974 2773 2061 6c73  ckages..It's als
+0001b380: 6f20 706f 7373 6962 6c65 2074 6f20 616c  o possible to al
+0001b390: 736f 2069 6e73 7461 6c6c 2074 6865 2070  so install the p
+0001b3a0: 726f 6a65 6374 2069 6e20 2765 6469 7461  roject in 'edita
+0001b3b0: 626c 6520 6d6f 6465 272e 0a0a 2020 2020  ble mode'...    
+0001b3c0: 2420 6d61 6b65 2069 6e73 7461 6c6c 0a0a  $ make install..
+0001b3d0: 506c 6561 7365 206e 6f74 652c 2069 6620  Please note, if 
+0001b3e0: 796f 7520 6372 6561 7465 2074 6865 2076  you create the v
+0001b3f0: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
+0001b400: 6e74 2069 6e20 7468 6973 2077 6179 2c20  nt in this way, 
+0001b410: 616e 6420 7468 656e 2074 7279 2074 6f0a  and then try to.
+0001b420: 6f70 656e 2074 6865 2070 726f 6a65 6374  open the project
+0001b430: 2069 6e20 5079 4368 6172 6d20 616e 6420   in PyCharm and 
+0001b440: 636f 6e66 6967 7572 6520 7468 6520 7072  configure the pr
+0001b450: 6f6a 6563 7420 746f 2075 7365 2074 6869  oject to use thi
+0001b460: 7320 7669 7274 7561 6c0a 656e 7669 726f  s virtual.enviro
+0001b470: 6e6d 656e 7420 6173 2061 6e20 2245 7869  nment as an "Exi
+0001b480: 7374 696e 6720 506f 6574 7279 2045 6e76  sting Poetry Env
+0001b490: 6972 6f6e 6d65 6e74 222c 2050 7943 6861  ironment", PyCha
+0001b4a0: 726d 2073 6f6d 6574 696d 6573 2068 6173  rm sometimes has
+0001b4b0: 2073 6f6d 650a 6973 7375 6573 2028 646f   some.issues (do
+0001b4c0: 6e27 7420 6b6e 6f77 2077 6879 2920 7768  n't know why) wh
+0001b4d0: 6963 6820 6d69 6768 7420 6265 2070 726f  ich might be pro
+0001b4e0: 626c 656d 6174 6963 2e20 4966 2079 6f75  blematic. If you
+0001b4f0: 2065 6e63 6f75 6e74 6572 2073 7563 680a   encounter such.
+0001b500: 6973 7375 6573 2c20 796f 7520 6361 6e20  issues, you can 
+0001b510: 7265 736f 6c76 6520 7468 6573 6520 6973  resolve these is
+0001b520: 7375 6573 2062 7920 6465 6c65 7469 6e67  sues by deleting
+0001b530: 2074 6865 2076 6972 7475 616c 2065 6e76   the virtual env
+0001b540: 6972 6f6e 6d65 6e74 0a61 6e64 2063 7265  ironment.and cre
+0001b550: 6174 696e 6720 7468 6520 506f 6574 7279  ating the Poetry
+0001b560: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
+0001b570: 6d65 6e74 2075 7369 6e67 2050 7943 6861  ment using PyCha
+0001b580: 726d 2028 7365 6520 6162 6f76 6529 2e0a  rm (see above)..
+0001b590: 0a23 2323 2050 726f 6a65 6374 204d 616b  .### Project Mak
+0001b5a0: 6566 696c 6520 636f 6d6d 616e 6473 0a0a  efile commands..
+0001b5b0: 596f 7520 6361 6e20 7374 6172 7420 4576  You can start Ev
+0001b5c0: 656e 7453 746f 7265 4442 2075 7369 6e67  entStoreDB using
+0001b5d0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
+0001b5e0: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 206d  ommand...    $ m
+0001b5f0: 616b 6520 7374 6172 742d 6576 656e 7473  ake start-events
+0001b600: 746f 7265 6462 0a0a 596f 7520 6361 6e20  toredb..You can 
+0001b610: 7275 6e20 7465 7374 7320 7573 696e 6720  run tests using 
+0001b620: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+0001b630: 6d6d 616e 6420 286e 6565 6473 2045 7665  mmand (needs Eve
+0001b640: 6e74 5374 6f72 6544 4220 746f 2062 6520  ntStoreDB to be 
+0001b650: 7275 6e6e 696e 6729 2e0a 0a20 2020 2024  running)...    $
+0001b660: 206d 616b 6520 7465 7374 0a0a 596f 7520   make test..You 
+0001b670: 6361 6e20 7374 6f70 2045 7665 6e74 5374  can stop EventSt
+0001b680: 6f72 6544 4220 7573 696e 6720 7468 6520  oreDB using the 
+0001b690: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
+0001b6a0: 642e 0a0a 2020 2020 2420 6d61 6b65 2073  d...    $ make s
+0001b6b0: 746f 702d 6576 656e 7473 746f 7265 6462  top-eventstoredb
+0001b6c0: 0a0a 596f 7520 6361 6e20 6368 6563 6b20  ..You can check 
+0001b6d0: 7468 6520 666f 726d 6174 7469 6e67 206f  the formatting o
+0001b6e0: 6620 7468 6520 636f 6465 2075 7369 6e67  f the code using
+0001b6f0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
+0001b700: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 206d  ommand...    $ m
+0001b710: 616b 6520 6c69 6e74 0a0a 596f 7520 6361  ake lint..You ca
+0001b720: 6e20 7265 666f 726d 6174 2074 6865 2063  n reformat the c
+0001b730: 6f64 6520 7573 696e 6720 7468 6520 666f  ode using the fo
+0001b740: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
+0001b750: 0a0a 2020 2020 2420 6d61 6b65 2066 6d74  ..    $ make fmt
+0001b760: 0a0a 5465 7374 7320 6265 6c6f 6e67 2069  ..Tests belong i
+0001b770: 6e20 602e 2f74 6573 7473 602e 2043 6f64  n `./tests`. Cod
+0001b780: 652d 756e 6465 722d 7465 7374 2062 656c  e-under-test bel
+0001b790: 6f6e 6773 2069 6e20 602e 2f65 7364 6263  ongs in `./esdbc
+0001b7a0: 6c69 656e 7460 2e0a 0a45 6469 7420 7061  lient`...Edit pa
+0001b7b0: 636b 6167 6520 6465 7065 6e64 656e 6369  ckage dependenci
+0001b7c0: 6573 2069 6e20 6070 7970 726f 6a65 6374  es in `pyproject
+0001b7d0: 2e74 6f6d 6c60 2e20 5570 6461 7465 2069  .toml`. Update i
+0001b7e0: 6e73 7461 6c6c 6564 2070 6163 6b61 6765  nstalled package
+0001b7f0: 7320 2861 6e64 2074 6865 0a60 706f 6574  s (and the.`poet
+0001b800: 7279 2e6c 6f63 6b60 2066 696c 6529 2075  ry.lock` file) u
+0001b810: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
+0001b820: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
+0001b830: 2024 206d 616b 6520 7570 6461 7465 2d70   $ make update-p
+0001b840: 6163 6b61 6765 730a 0a                   ackages..
```

### Comparing `esdbclient-1.0a5/esdbclient/__init__.py` & `esdbclient-1.0a6/esdbclient/__init__.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/asyncio_client.py` & `esdbclient-1.0a6/esdbclient/asyncio_client.py`

 * *Files 4% similar despite different names*

```diff
@@ -15,15 +15,14 @@
     TypeVar,
     cast,
 )
 
 import dns
 import dns.asyncresolver
 import grpc.aio
-from grpc.aio import UsageError
 
 from esdbclient.client import DEFAULT_EXCLUDE_FILTER, BaseESDBClient
 from esdbclient.connection import (
     NODE_PREFERENCE_FOLLOWER,
     NODE_PREFERENCE_LEADER,
     NODE_PREFERENCE_RANDOM,
     NODE_PREFERENCE_REPLICA,
@@ -65,15 +64,15 @@
             if client.connection_spec.options.NodePreference == NODE_PREFERENCE_LEADER:
                 await client.reconnect()
                 await asyncio.sleep(0.1)
                 return await f(client, *args, **kwargs)
             else:
                 raise
 
-        except UsageError as e:
+        except grpc.aio.UsageError as e:
             if "Channel is closed" in str(e):
                 await client.reconnect()
                 await asyncio.sleep(0.1)
                 return await f(client, *args, **kwargs)
             else:  # pragma: no cover
                 raise
 
@@ -248,22 +247,22 @@
         return AsyncioESDBConnection(grpc_channel=grpc_channel, grpc_target=grpc_target)
 
     @retrygrpc
     @autoreconnect
     async def append_events(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
     ) -> int:
         timeout = timeout if timeout is not None else self._default_deadline
         result = await self._connection.streams.batch_append(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             events=events,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
         return result.commit_position
 
@@ -361,39 +360,39 @@
         )
 
     @retrygrpc
     @autoreconnect
     async def delete_stream(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
     ) -> None:
-        # Todo: Reconsider using expected_position=None to indicate "stream exists"?
+        # Todo: Reconsider using current_version=None to indicate "stream exists"?
         timeout = timeout if timeout is not None else self._default_deadline
         await self._connection.streams.delete(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
     async def tombstone_stream(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
     ) -> None:
         timeout = timeout if timeout is not None else self._default_deadline
         await self._connection.streams.tombstone(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     async def close(self) -> None:
         await self._connection.close()
```

### Comparing `esdbclient-1.0a5/esdbclient/client.py` & `esdbclient-1.0a6/esdbclient/client.py`

 * *Files 5% similar despite different names*

```diff
@@ -17,15 +17,14 @@
     cast,
     overload,
 )
 
 import dns.exception
 import dns.resolver
 import grpc
-from grpc import CallCredentials
 
 from esdbclient.connection import (
     NODE_PREFERENCE_FOLLOWER,
     NODE_PREFERENCE_LEADER,
     NODE_PREFERENCE_RANDOM,
     NODE_PREFERENCE_REPLICA,
     URI_SCHEME_ESDB,
@@ -54,15 +53,15 @@
     ClusterMember,
 )
 from esdbclient.persistent import (
     ConsumerStrategy,
     PersistentSubscription,
     SubscriptionInfo,
 )
-from esdbclient.streams import ReadResponse
+from esdbclient.streams import CatchupSubscription, ReadResponse
 
 # Matches the 'type' of "system" events.
 ESDB_SYSTEM_EVENTS_REGEX = r"\$.+"
 # Matches the 'type' of "PersistentConfig" events.
 ESDB_PERSISTENT_CONFIG_EVENTS_REGEX = r"PersistentConfig\d+"
 
 DEFAULT_EXCLUDE_FILTER = (ESDB_SYSTEM_EVENTS_REGEX, ESDB_PERSISTENT_CONFIG_EVENTS_REGEX)
@@ -145,15 +144,15 @@
                 self.connection_spec.username, self.connection_spec.password
             )
         else:
             self._call_credentials = None
 
     def _construct_call_credentials(
         self, username: Optional[str], password: Optional[str]
-    ) -> Optional[CallCredentials]:
+    ) -> Optional[grpc.CallCredentials]:
         if username and password:
             return grpc.metadata_call_credentials(
                 BasicAuthCallCredentials(username, password)
             )
         else:
             return None
 
@@ -337,100 +336,100 @@
     #                 future.set_exception(error)  # pragma: no cover
     #         except Empty:
     #             pass
     #
     # def append_events_multiplexed(
     #     self,
     #     stream_name: str,
-    #     expected_position: Optional[int],
+    #     current_version: Optional[int],
     #     events: Iterable[NewEvent],
     #     timeout: Optional[float] = None,
     # ) -> int:
     #     timeout = timeout if timeout is not None else self._default_deadline
     #     batch_append_request = BatchAppendRequest(
-    #         stream_name=stream_name, expected_position=expected_position, events=events
+    #         stream_name=stream_name, current_version=current_version, events=events
     #     )
     #     future = BatchAppendFuture(batch_append_request=batch_append_request)
     #     with self._batch_append_futures_lock:
     #         self._batch_append_futures_queue.put(future)
     #     response = future.result(timeout=timeout)
     #     assert isinstance(response.commit_position, int)
     #     return response.commit_position
 
     @retrygrpc
     @autoreconnect
     def append_events(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
     ) -> int:
         timeout = timeout if timeout is not None else self._default_deadline
         return self._connection.streams.batch_append(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             events=events,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         ).commit_position
 
     @retrygrpc
     @autoreconnect
     def append_event(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         event: NewEvent,
         timeout: Optional[float] = None,
     ) -> int:
         """
         Appends a new event to the named stream.
         """
         timeout = timeout if timeout is not None else self._default_deadline
         return self._connection.streams.append(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             events=[event],
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
     def delete_stream(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
     ) -> None:
-        # Todo: Reconsider using expected_position=None to indicate "stream exists"?
+        # Todo: Reconsider using current_version=None to indicate "stream exists"?
         timeout = timeout if timeout is not None else self._default_deadline
         self._connection.streams.delete(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
     def tombstone_stream(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
     ) -> None:
         timeout = timeout if timeout is not None else self._default_deadline
         self._connection.streams.tombstone(
             stream_name=stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
@@ -458,15 +457,15 @@
     def iter_stream_events(
         self,
         stream_name: str,
         stream_position: Optional[int] = None,
         backwards: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Reads recorded events from the named stream.
         """
         return self._connection.streams.read(
             stream_name=stream_name,
             stream_position=stream_position,
             backwards=backwards,
@@ -499,15 +498,15 @@
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
-    def get_stream_position(
+    def get_current_version(
         self,
         stream_name: str,
         timeout: Optional[float] = None,
     ) -> Optional[int]:
         """
         Returns the current position of the end of a stream.
         """
@@ -532,21 +531,25 @@
 
     @retrygrpc
     @autoreconnect
     def get_commit_position(
         self,
         timeout: Optional[float] = None,
         filter_exclude: Sequence[str] = DEFAULT_EXCLUDE_FILTER,
+        filter_include: Sequence[str] = (),
+        filter_by_stream_name: bool = False,
     ) -> int:
         """
         Returns the current commit position of the database.
         """
         recorded_events = self.read_all_events(
             backwards=True,
             filter_exclude=filter_exclude,
+            filter_include=filter_include,
+            filter_by_stream_name=filter_by_stream_name,
             limit=1,
             timeout=timeout,
         )
         commit_position = 0
         for ev in recorded_events:
             assert ev.commit_position is not None
             commit_position = ev.commit_position
@@ -576,44 +579,44 @@
             metadata_event = metadata_events[0]
             return json.loads(metadata_event.data), metadata_event.stream_position
 
     def set_stream_metadata(
         self,
         stream_name: str,
         metadata: Dict[str, Any],
-        expected_position: Optional[int] = -1,
+        current_version: Optional[int] = -1,
         timeout: Optional[float] = None,
     ) -> None:
         """
         Sets the stream metadata.
         """
         timeout = timeout if timeout is not None else self._default_deadline
 
         metadata_stream_name = f"$${stream_name}"
         metadata_event = NewEvent(
             type="$metadata",
             data=json.dumps(metadata).encode("utf8"),
         )
         self.append_event(
             stream_name=metadata_stream_name,
-            expected_position=expected_position,
+            current_version=current_version,
             event=metadata_event,
             timeout=timeout,
         )
 
     @retrygrpc
     @autoreconnect
     def subscribe_all_events(
         self,
         commit_position: Optional[int] = None,
         filter_exclude: Sequence[str] = DEFAULT_EXCLUDE_FILTER,
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         timeout: Optional[float] = None,
-    ) -> ReadResponse:
+    ) -> CatchupSubscription:
         """
         Starts a catch-up subscription, from which all
         recorded events in the database can be received.
         """
         return self._connection.streams.read(
             commit_position=commit_position,
             filter_exclude=filter_exclude,
@@ -628,15 +631,15 @@
     @retrygrpc
     @autoreconnect
     def subscribe_stream_events(
         self,
         stream_name: str,
         stream_position: Optional[int] = None,
         timeout: Optional[float] = None,
-    ) -> ReadResponse:
+    ) -> CatchupSubscription:
         """
         Starts a catch-up subscription from which
         recorded events in a stream can be received.
         """
         return self._connection.streams.read(
             stream_name=stream_name,
             stream_position=stream_position,
@@ -1008,36 +1011,40 @@
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
-    def delete_subscription(
-        self, group_name: str, timeout: Optional[float] = None
+    def replay_parked_events(
+        self,
+        group_name: str,
+        stream_name: Optional[str] = None,
+        timeout: Optional[float] = None,
     ) -> None:
-        """
-        Creates a persistent subscription on all streams.
-        """
         timeout = timeout if timeout is not None else self._default_deadline
 
-        self._connection.persistent_subscriptions.delete(
+        self._connection.persistent_subscriptions.replay_parked(
             group_name=group_name,
+            stream_name=stream_name,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
-    def delete_stream_subscription(
-        self, group_name: str, stream_name: str, timeout: Optional[float] = None
+    def delete_persistent_subscription(
+        self,
+        group_name: str,
+        stream_name: Optional[str] = None,
+        timeout: Optional[float] = None,
     ) -> None:
         """
-        Creates a persistent subscription on all streams.
+        Deletes a persistent subscription.
         """
         timeout = timeout if timeout is not None else self._default_deadline
 
         self._connection.persistent_subscriptions.delete(
             group_name=group_name,
             stream_name=stream_name,
             timeout=timeout,
```

### Comparing `esdbclient-1.0a5/esdbclient/connection.py` & `esdbclient-1.0a6/esdbclient/connection.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 # -*- coding: utf-8 -*-
 from typing import Any, Dict, Optional, Sequence
 from urllib.parse import ParseResult, parse_qs, urlparse
 from uuid import uuid4
 
+import grpc
 import grpc.aio
-from grpc import Channel
 
 from esdbclient.gossip import (
     AsyncioClusterGossipService,
     AsyncioGossipService,
     ClusterGossipService,
     GossipService,
 )
@@ -63,15 +63,16 @@
         self._set_GossipTimeout(options)
         self._set_NodePreference(options)
         self._set_TlsVerifyCert(options)
         self._set_DefaultDeadline(options)
         self._set_KeepAliveInterval(options)
         self._set_KeepAliveTimeout(options)
 
-    def _validate_field_names(self, options: Dict[str, Any]) -> None:
+    @staticmethod
+    def _validate_field_names(options: Dict[str, Any]) -> None:
         valid_fields = [s.upper() for s in VALID_CONNECTION_QUERY_STRING_FIELDS]
         invalid_fields = []
         for field in options.keys():
             if field not in valid_fields:
                 invalid_fields.append(field)
         if len(invalid_fields) > 0:
             plural = "s" if len(invalid_fields) > 1 else ""
@@ -307,15 +308,15 @@
 
     @property
     def options(self) -> ConnectionOptions:
         return self._options
 
 
 class ESDBConnection:
-    def __init__(self, grpc_channel: Channel, grpc_target: str) -> None:
+    def __init__(self, grpc_channel: grpc.Channel, grpc_target: str) -> None:
         self.grpc_channel = grpc_channel
         self.grpc_target = grpc_target
         self.streams = StreamsService(grpc_channel)
         self.persistent_subscriptions = PersistentSubscriptionsService(grpc_channel)
         self.gossip = GossipService(grpc_channel)
         self.cluster_gossip = ClusterGossipService(grpc_channel)
         # self._channel_connectivity_state: Optional[ChannelConnectivity] = None
```

### Comparing `esdbclient-1.0a5/esdbclient/esdbapibase.py` & `esdbclient-1.0a6/esdbclient/esdbapibase.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,14 +1,13 @@
 # -*- coding: utf-8 -*-
 from base64 import b64encode
 from typing import TYPE_CHECKING, Optional, Tuple
 
 import grpc
-from grpc import AuthMetadataContext, AuthMetadataPluginCallback, RpcError, StatusCode
-from grpc.aio import AioRpcError
+import grpc.aio
 
 from esdbclient.exceptions import (
     CancelledByClient,
     DeadlineExceeded,
     ESDBClientException,
     ExceptionThrownByHandler,
     GrpcError,
@@ -19,51 +18,55 @@
 
 if TYPE_CHECKING:  # pragma: no cover
     from grpc import Metadata
 
 else:
     Metadata = Tuple[Tuple[str, str], ...]
 
-__all__ = ["Metadata"]
+__all__ = ["handle_rpc_error", "BasicAuthCallCredentials", "ESDBService", "Metadata"]
 
 
 class BasicAuthCallCredentials(grpc.AuthMetadataPlugin):
     def __init__(self, username: str, password: str):
         credentials = b64encode(f"{username}:{password}".encode())
         self._metadata = (("authorization", (b"Basic " + credentials)),)
 
     def __call__(
-        self, context: AuthMetadataContext, callback: AuthMetadataPluginCallback
+        self,
+        context: grpc.AuthMetadataContext,
+        callback: grpc.AuthMetadataPluginCallback,
     ) -> None:
         callback(self._metadata, None)
 
 
-def handle_rpc_error(e: RpcError) -> ESDBClientException:
+def handle_rpc_error(e: grpc.RpcError) -> ESDBClientException:
     """
     Converts gRPC errors to client exceptions.
     """
-    if isinstance(e, (grpc.Call, AioRpcError)):
-        if e.code() == StatusCode.UNKNOWN and "Exception was thrown by handler" in str(
-            e.details()
+    if isinstance(e, (grpc.Call, grpc.aio.AioRpcError)):
+        if (
+            e.code() == grpc.StatusCode.UNKNOWN
+            and "Exception was thrown by handler" in str(e.details())
         ):
             return ExceptionThrownByHandler(e)
         elif (
-            e.code() == StatusCode.CANCELLED
+            e.code() == grpc.StatusCode.CANCELLED
             and e.details() == "Locally cancelled by application!"
         ):
             return CancelledByClient(e)
-        elif e.code() == StatusCode.DEADLINE_EXCEEDED:
+        elif e.code() == grpc.StatusCode.DEADLINE_EXCEEDED:
             return DeadlineExceeded(e)
-        elif e.code() == StatusCode.UNAVAILABLE:
+        elif e.code() == grpc.StatusCode.UNAVAILABLE:
             return ServiceUnavailable(e)
         elif (
-            e.code() == StatusCode.NOT_FOUND and e.details() == "Leader info available"
+            e.code() == grpc.StatusCode.NOT_FOUND
+            and e.details() == "Leader info available"
         ):
             return NodeIsNotLeader(e)
-        elif e.code() == StatusCode.NOT_FOUND:
+        elif e.code() == grpc.StatusCode.NOT_FOUND:
             return NotFound()
     return GrpcError(e)
 
 
 class ESDBService:
     def _metadata(
         self, metadata: Optional[Metadata], requires_leader: bool = False
```

### Comparing `esdbclient-1.0a5/esdbclient/events.py` & `esdbclient-1.0a6/esdbclient/events.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/exceptions.py` & `esdbclient-1.0a6/esdbclient/exceptions.py`

 * *Files 26% similar despite different names*

```diff
@@ -50,34 +50,35 @@
 
 class SubscriptionConfirmationError(ESDBClientException):
     """
     Raised when subscription confirmation fails.
     """
 
 
-class WrongExpectedPosition(ESDBClientException):
+class WrongCurrentVersion(ESDBClientException):
     """
     Raised when expected position does not match the
     actual position of the last event in a stream.
     """
 
 
 class AccessDeniedError(ESDBClientException):
     """
     Raised when access is denied by the server.
     """
 
 
 class StreamIsDeleted(ESDBClientException):
     """
-    Raised when a deleted stream is encountered, for example when
-    appending to a stream that has been deleted, or when reading
-    from a tombstoned stream (reading from a "soft deleted" stream
-    causes a StreamNotFound exception), or when deleting or tombstoning
-    a stream that has been deleeted or tomebstoned.
+    Raised when reading from or appending to a stream that has been
+    tombstoned, and when deleting a stream that has been deleted
+    whilst expecting the stream exists, and when getting or setting
+    metadata for a stream that has been tombstoned, and when deleting
+    a stream that has been tombstoned, and when tombstoning a stream
+    that has been tombstoned.
     """
 
 
 class TimeoutError(ESDBClientException):
     """
     Raised when append operation is timed out by the server.
     """
```

### Comparing `esdbclient-1.0a5/esdbclient/gossip.py` & `esdbclient-1.0a6/esdbclient/gossip.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 # -*- coding: utf-8 -*-
 from dataclasses import dataclass
 from typing import Optional, Sequence, Union
 
 import grpc
-from grpc import CallCredentials, RpcError
+import grpc.aio
 
 from esdbclient.esdbapibase import ESDBService, Metadata, handle_rpc_error
 from esdbclient.protos.Grpc import (
     cluster_pb2,
     cluster_pb2_grpc,
     gossip_pb2,
     gossip_pb2_grpc,
@@ -33,16 +33,17 @@
 }
 
 
 class BaseGossipService(ESDBService):
     def __init__(self, channel: Union[grpc.Channel, grpc.aio.Channel]):
         self._stub = gossip_pb2_grpc.GossipStub(channel)
 
+    @staticmethod
     def _construct_cluster_members(
-        self, cluster_info: gossip_pb2.ClusterInfo
+        cluster_info: gossip_pb2.ClusterInfo,
     ) -> Sequence[ClusterMember]:
         members = []
         for member_info in cluster_info.members:
             member = ClusterMember(
                 GOSSIP_API_NODE_STATES_MAPPING.get(member_info.state, NODE_STATE_OTHER),
                 member_info.http_end_point.address,
                 member_info.http_end_point.port,
@@ -52,48 +53,48 @@
 
 
 class AsyncioGossipService(BaseGossipService):
     async def read(
         self,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> Sequence[ClusterMember]:
         try:
             read_resp = await self._stub.Read(
                 shared_pb2.Empty(),
                 timeout=timeout,
                 metadata=self._metadata(metadata),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
 
         return self._construct_cluster_members(read_resp)
 
 
 class GossipService(BaseGossipService):
     """
     Encapsulates the 'gossip.Gossip' gRPC service.
     """
 
     def read(
         self,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> Sequence[ClusterMember]:
         try:
             read_resp = self._stub.Read(
                 shared_pb2.Empty(),
                 timeout=timeout,
                 metadata=self._metadata(metadata),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
 
         return self._construct_cluster_members(read_resp)
 
 
 CLUSTER_GOSSIP_NODE_STATES_MAPPING = {
     cluster_pb2.MemberInfo.VNodeState.Follower: NODE_STATE_FOLLOWER,
@@ -116,28 +117,28 @@
     Encapsulates the 'cluster.Gossip' gRPC service.
     """
 
     def read(
         self,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> Sequence[ClusterMember]:
         """
         Returns a sequence of ClusterMember
         """
 
         try:
             read_resp = self._stub.Read(
                 shared_pb2.Empty(),
                 timeout=timeout,
                 metadata=self._metadata(metadata),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
 
         assert isinstance(read_resp, cluster_pb2.ClusterInfo)
 
         members = []
         for member_info in read_resp.members:
             assert isinstance(member_info, cluster_pb2.MemberInfo)
```

### Comparing `esdbclient-1.0a5/esdbclient/persistent.py` & `esdbclient-1.0a6/esdbclient/persistent.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,28 +1,35 @@
 # -*- coding: utf-8 -*-
 import queue
+from abc import abstractmethod
 from dataclasses import dataclass
 from typing import Iterator, List, Optional, Sequence, Tuple, Union, overload
 from uuid import UUID
 
 import grpc
-from grpc import CallCredentials, RpcError, StatusCode
-from grpc._channel import _MultiThreadedRendezvous
-from typing_extensions import Literal
+from typing_extensions import Literal, Protocol, runtime_checkable
 
 from esdbclient.esdbapibase import ESDBService, Metadata, handle_rpc_error
 from esdbclient.events import RecordedEvent
 from esdbclient.exceptions import (
     CancelledByClient,
     ESDBClientException,
     NodeIsNotLeader,
     SubscriptionConfirmationError,
 )
 from esdbclient.protos.Grpc import persistent_pb2, persistent_pb2_grpc, shared_pb2
 
+
+@runtime_checkable
+class _ReadResps(Iterator[persistent_pb2.ReadResp], Protocol):
+    @abstractmethod
+    def cancel(self) -> None:
+        ...  # pragma: no cover
+
+
 ConsumerStrategy = Literal[
     "DispatchToSingle", "RoundRobin", "Pinned", "PinnedByCorrelation"
 ]
 
 
 class BaseSubscriptionReadReqs:
     def __init__(
@@ -359,14 +366,34 @@
                 stream_identifier=shared_pb2.StreamIdentifier(
                     stream_name=stream_name.encode("utf8")
                 ),
                 group_name=group_name,
             )
         return persistent_pb2.DeleteReq(options=options)
 
+    @staticmethod
+    def _construct_replay_parked_req(
+        group_name: str, stream_name: Optional[str]
+    ) -> persistent_pb2.ReplayParkedReq:
+        if stream_name is None:
+            options = persistent_pb2.ReplayParkedReq.Options(
+                group_name=group_name,
+                all=shared_pb2.Empty(),
+                no_limit=shared_pb2.Empty(),
+            )
+        else:
+            options = persistent_pb2.ReplayParkedReq.Options(
+                group_name=group_name,
+                stream_identifier=shared_pb2.StreamIdentifier(
+                    stream_name=stream_name.encode("utf8")
+                ),
+                no_limit=shared_pb2.Empty(),
+            )
+        return persistent_pb2.ReplayParkedReq(options=options)
+
     def _construct_subscription_infos(
         self, resp: persistent_pb2.ListResp
     ) -> List[SubscriptionInfo]:
         return [self._construct_subscription_info(s) for s in resp.subscriptions]
 
     @staticmethod
     def _construct_subscription_info(
@@ -466,35 +493,37 @@
 class AsyncioPersistentSubscriptionsService(BasePersistentSubscriptionsService):
     pass
 
 
 class PersistentSubscription(Iterator[RecordedEvent], BasePersistentSubscription):
     def __init__(
         self,
-        reqs: SubscriptionReadReqs,
-        resps: _MultiThreadedRendezvous,
-        group_name: str,
+        read_reqs: SubscriptionReadReqs,
+        read_resps: _ReadResps,
+        expected_group_name: str,
         stream_name: Optional[str],
     ):
-        self.reqs = reqs
-        self.resps = resps
-        read_resp = self._get_next_read_resp()
-        content_oneof = read_resp.WhichOneof("content")
-
-        if content_oneof == "subscription_confirmation":
-            confirmed_stream_name, _, confirmed_group_name = (
-                read_resp.subscription_confirmation.subscription_id.partition("::")
+        self.read_reqs = read_reqs
+        self.read_resps = read_resps
+
+        first_read_resp = self._get_next_read_resp()
+        if first_read_resp.WhichOneof("content") == "subscription_confirmation":
+            expected_stream_name = stream_name if stream_name is not None else "$all"
+            subscription_id = first_read_resp.subscription_confirmation.subscription_id
+            confirmed_stream_name, _, confirmed_group_name = subscription_id.partition(
+                "::"
             )
-            if confirmed_group_name != group_name or confirmed_stream_name != (
-                stream_name if stream_name is not None else "$all"
+            if (
+                confirmed_group_name != expected_group_name
+                or confirmed_stream_name != expected_stream_name
             ):  # pragma: no cover
                 raise SubscriptionConfirmationError()
         else:  # pragma: no cover
             raise ESDBClientException(
-                f"Expected subscription confirmation, got: {read_resp}"
+                f"Expected subscription confirmation, got: {first_read_resp}"
             )
 
     def __iter__(self) -> Iterator[RecordedEvent]:
         return self
 
     def __next__(self) -> RecordedEvent:
         while True:
@@ -506,33 +535,33 @@
             if content_oneof == "event":
                 return self._construct_recorded_event(read_resp)
             else:  # pragma: no cover
                 pass
 
     def _get_next_read_resp(self) -> persistent_pb2.ReadResp:
         try:
-            read_resp = next(self.resps)
-        except RpcError as e:
+            read_resp = next(self.read_resps)
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
         assert isinstance(read_resp, persistent_pb2.ReadResp)
         return read_resp
 
     def stop(self) -> None:
-        self.reqs.stop()
-        self.resps.cancel()
+        self.read_reqs.stop()
+        self.read_resps.cancel()
 
     def ack(self, event_id: UUID) -> None:
-        self.reqs.ack(event_id)
+        self.read_reqs.ack(event_id)
 
     def nack(
         self,
         event_id: UUID,
         action: Literal["unknown", "park", "retry", "skip", "stop"],
     ) -> None:
-        self.reqs.nack(event_id, action=action)
+        self.read_reqs.nack(event_id, action=action)
 
     def __del__(self) -> None:
         self.stop()
 
 
 class PersistentSubscriptionsService(BasePersistentSubscriptionsService):
     """
@@ -548,15 +577,15 @@
         commit_position: Optional[int] = None,
         consumer_strategy: ConsumerStrategy = "DispatchToSingle",
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         """
         Signature for creating a persistent "all streams" subscription.
         """
 
     @overload
     def create(
@@ -565,15 +594,15 @@
         *,
         stream_name: Optional[str] = None,
         from_end: bool = False,
         stream_position: Optional[int] = None,
         consumer_strategy: ConsumerStrategy = "DispatchToSingle",
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         """
         Signature for creating a persistent stream subscription.
         """
 
     def create(
         self,
@@ -584,15 +613,15 @@
         stream_position: Optional[int] = None,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         consumer_strategy: ConsumerStrategy = "DispatchToSingle",
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         request = self._construct_create_req(
             group_name=group_name,
             stream_name=stream_name,
             from_end=from_end,
             commit_position=commit_position,
             stream_position=stream_position,
@@ -605,93 +634,95 @@
         try:
             response = self._stub.Create(
                 request,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
         assert isinstance(response, persistent_pb2.CreateResp)
 
     def read(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         buffer_size: int = 100,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> PersistentSubscription:
         read_reqs = SubscriptionReadReqs(
             group_name=group_name,
             stream_name=stream_name,
             buffer_size=buffer_size,
         )
-        read_resps: _MultiThreadedRendezvous = self._stub.Read(
+        read_resps = self._stub.Read(
             read_reqs,
             timeout=timeout,
             metadata=self._metadata(metadata, requires_leader=True),
             credentials=credentials,
         )
+        assert isinstance(read_resps, _ReadResps)
+
         return PersistentSubscription(
-            reqs=read_reqs,
-            resps=read_resps,
-            group_name=group_name,
+            read_reqs=read_reqs,
+            read_resps=read_resps,
+            expected_group_name=group_name,
             stream_name=stream_name,
         )
 
     def get_info(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> SubscriptionInfo:
         req = self._construct_get_info_req(group_name, stream_name)
         try:
             resp = self._stub.GetInfo(
                 req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             if (
-                e.code() == StatusCode.UNAVAILABLE
+                e.code() == grpc.StatusCode.UNAVAILABLE
                 and e.details() == "Server Is Not Ready"
             ):
                 raise NodeIsNotLeader() from e
             raise handle_rpc_error(e) from e
 
         else:
             assert isinstance(resp, persistent_pb2.GetInfoResp)
             return self._construct_subscription_info(resp.subscription_info)
 
     def list(
         self,
         stream_name: Optional[str] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> List[SubscriptionInfo]:
         req = self._construct_list_req(stream_name)
         try:
             resp = self._stub.List(
                 req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
-            if e.code() == StatusCode.NOT_FOUND:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.NOT_FOUND:
                 return []
             elif (
-                e.code() == StatusCode.UNAVAILABLE
+                e.code() == grpc.StatusCode.UNAVAILABLE
                 and e.details() == "Server Is Not Ready"
             ):
                 raise NodeIsNotLeader() from e
             else:
                 raise handle_rpc_error(e) from e
 
         assert isinstance(resp, persistent_pb2.ListResp)
@@ -702,15 +733,15 @@
         self,
         group_name: str,
         *,
         from_end: bool = False,
         commit_position: Optional[int] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         """
         Signature for updating a persistent "all streams" subscription.
         """
 
     @overload
     def update(
@@ -718,30 +749,30 @@
         group_name: str,
         *,
         stream_name: Optional[str] = None,
         from_end: bool = False,
         stream_position: Optional[int] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         """
         Signature for updating a persistent stream subscription.
         """
 
     def update(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         from_end: bool = False,
         commit_position: Optional[int] = None,
         stream_position: Optional[int] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         request = self._construct_update_req(
             group_name=group_name,
             stream_name=stream_name,
             from_end=from_end,
             commit_position=commit_position,
             stream_position=stream_position,
@@ -750,30 +781,50 @@
         try:
             response = self._stub.Update(
                 request,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
         assert isinstance(response, persistent_pb2.UpdateResp)
 
     def delete(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
         req = self._construct_delete_req(group_name, stream_name)
         try:
             resp = self._stub.Delete(
                 req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
         assert isinstance(resp, persistent_pb2.DeleteResp)
+
+    def replay_parked(
+        self,
+        group_name: str,
+        stream_name: Optional[str] = None,
+        timeout: Optional[float] = None,
+        metadata: Optional[Metadata] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
+    ) -> None:
+        req = self._construct_replay_parked_req(group_name, stream_name)
+        try:
+            resp = self._stub.ReplayParked(
+                req,
+                timeout=timeout,
+                metadata=self._metadata(metadata, requires_leader=True),
+                credentials=credentials,
+            )
+        except grpc.RpcError as e:
+            raise handle_rpc_error(e) from e
+        assert isinstance(resp, persistent_pb2.ReplayParkedResp)
```

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2_grpc.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/cluster_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/code_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/code_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2_grpc.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/gossip_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2_grpc.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/persistent_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/shared_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/shared_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/status_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/status_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.pyi` & `esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2_grpc.py` & `esdbclient-1.0a6/esdbclient/protos/Grpc/streams_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a5/esdbclient/streams.py` & `esdbclient-1.0a6/esdbclient/streams.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,26 +1,26 @@
 # -*- coding: utf-8 -*-
 import sys
+from abc import abstractmethod
 from dataclasses import dataclass
 from typing import (
     AsyncIterable,
     Iterable,
     Iterator,
     Optional,
     Sequence,
     Union,
     overload,
 )
 from uuid import UUID, uuid4
 
+import grpc
 import grpc.aio
 from google.protobuf import duration_pb2, empty_pb2
-from grpc import CallCredentials, RpcError, StatusCode
-from grpc._channel import _MultiThreadedRendezvous
-from typing_extensions import Literal
+from typing_extensions import Literal, Protocol, runtime_checkable
 
 from esdbclient.esdbapibase import ESDBService, Metadata, handle_rpc_error
 from esdbclient.events import NewEvent, RecordedEvent
 from esdbclient.exceptions import (
     AccessDeniedError,
     BadRequestError,
     CancelledByClient,
@@ -28,19 +28,26 @@
     InvalidTransactionError,
     MaximumAppendSizeExceededError,
     NotFound,
     StreamIsDeleted,
     SubscriptionConfirmationError,
     TimeoutError,
     UnknownError,
-    WrongExpectedPosition,
+    WrongCurrentVersion,
 )
 from esdbclient.protos.Grpc import shared_pb2, status_pb2, streams_pb2, streams_pb2_grpc
 
 
+@runtime_checkable
+class _ReadResps(Iterator[streams_pb2.ReadResp], Protocol):
+    @abstractmethod
+    def cancel(self) -> None:
+        ...  # pragma: no cover
+
+
 class AsyncioReadResponse:
     def __init__(
         self,
         read_resp_iter: AsyncIterable[streams_pb2.ReadResp],
         stream_name: Optional[str],
         is_subscription: bool,
     ):
@@ -48,16 +55,16 @@
         self.stream_name = stream_name
         self.subscription_id: Optional[UUID] = None
         self.is_subscription = is_subscription
 
     async def _get_next_read_resp(self) -> streams_pb2.ReadResp:
         try:
             read_resp = await self.read_resp_iter.__anext__()
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if self.stream_name and details and "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
@@ -118,31 +125,19 @@
                 # Todo: Not sure how to request to get first_stream_position,
                 #   last_stream_position, first_all_stream_position.
 
 
 class ReadResponse(Iterator[RecordedEvent]):
     def __init__(
         self,
-        read_resps: _MultiThreadedRendezvous,
+        read_resps: _ReadResps,
         stream_name: Optional[str],
-        is_subscription: bool,
     ):
         self.read_resps = read_resps
         self.stream_name = stream_name
-        self.subscription_id: Optional[UUID] = None
-        if is_subscription:
-            read_resp = self._get_next_read_resp()
-            content_oneof = read_resp.WhichOneof("content")
-            if content_oneof == "confirmation":
-                pass
-                # Todo: What is 'read_resp.confirmation.subscription_id' for?
-            else:  # pragma: no cover
-                raise SubscriptionConfirmationError(
-                    f"Expected subscription confirmation, got: {read_resp}"
-                )
 
     def __iter__(self) -> "ReadResponse":
         return self
 
     def __next__(self) -> RecordedEvent:
         while True:
             try:
@@ -187,16 +182,16 @@
                 #
                 # Todo: Not sure how to request to get first_stream_position,
                 #   last_stream_position, first_all_stream_position.
 
     def _get_next_read_resp(self) -> streams_pb2.ReadResp:
         try:
             read_resp = next(self.read_resps)
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if self.stream_name and details and "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
@@ -206,20 +201,39 @@
     def stop(self) -> None:
         self.read_resps.cancel()
 
     def __del__(self) -> None:
         self.stop()
 
 
+class CatchupSubscription(ReadResponse):
+    def __init__(
+        self,
+        read_resps: _ReadResps,
+        stream_name: Optional[str],
+    ):
+        super().__init__(read_resps=read_resps, stream_name=stream_name)
+        self.subscription_id: Optional[UUID] = None
+        first_read_resp = self._get_next_read_resp()
+        content_oneof = first_read_resp.WhichOneof("content")
+        if content_oneof == "confirmation":
+            pass
+            # Todo: What is '.confirmation.subscription_id' for?
+        else:  # pragma: no cover
+            raise SubscriptionConfirmationError(
+                f"Expected subscription confirmation, got: {first_read_resp}"
+            )
+
+
 DEFAULT_BATCH_APPEND_REQUEST_DEADLINE = 315576000000
 
 # @dataclass
 # class BatchAppendRequest:
 #     stream_name: str
-#     expected_position: Optional[int]
+#     current_version: Optional[int]
 #     events: Iterable[NewEvent]
 #     correlation_id: UUID = field(default_factory=uuid4)
 #     deadline: int = DEFAULT_BATCH_APPEND_REQUEST_DEADLINE
 
 
 # if TYPE_CHECKING:  # pragma: no cover
 #
@@ -264,16 +278,16 @@
 #         return self.futures_by_correlation_id.pop(correlation_id)
 
 
 class BaseStreamsService(ESDBService):
     def __init__(self, channel: Union[grpc.Channel, grpc.aio.Channel]):
         self._stub = streams_pb2_grpc.StreamsStub(channel)
 
+    @staticmethod
     def _construct_read_request(
-        self,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         commit_position: Optional[int] = None,
         backwards: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
@@ -384,15 +398,15 @@
         )
 
         return streams_pb2.ReadReq(options=options)
 
     @staticmethod
     def _construct_batch_append_req(
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         deadline: int,
         correlation_id: UUID,
     ) -> streams_pb2.BatchAppendReq:
         # Construct batch request 'options'.
         options = streams_pb2.BatchAppendReq.Options(
             stream_identifier=shared_pb2.StreamIdentifier(
@@ -400,18 +414,18 @@
             ),
             deadline=duration_pb2.Duration(
                 seconds=deadline,
                 nanos=0,
             ),
         )
         # Decide options 'expected_stream_revision'.
-        if isinstance(expected_position, int):
-            if expected_position >= 0:
+        if isinstance(current_version, int):
+            if current_version >= 0:
                 # Stream is expected to exist.
-                options.stream_position = expected_position
+                options.stream_position = current_version
             else:
                 # Disable optimistic concurrency control.
                 options.any.CopyFrom(empty_pb2.Empty())
         else:
             # Stream is expected not to exist.
             options.no_stream.CopyFrom(empty_pb2.Empty())
         # Construct batch request 'proposed_messages'.
@@ -428,16 +442,17 @@
         return streams_pb2.BatchAppendReq(
             correlation_id=shared_pb2.UUID(string=str(correlation_id)),
             options=options,
             proposed_messages=proposed_messages,
             is_final=True,  # This specifies the end of an atomic transaction.
         )
 
+    @staticmethod
     def _convert_batch_append_resp(
-        self, response: streams_pb2.BatchAppendResp, stream_name: str
+        response: streams_pb2.BatchAppendResp, stream_name: str
     ) -> Union[BatchAppendResponse, ESDBClientException]:
         result: Union[BatchAppendResponse, ESDBClientException]
         # Response 'result' is either 'success' or 'error'.
         result_oneof = response.WhichOneof("result")
         if result_oneof == "success":
             # Construct response object.
             result = BatchAppendResponse(
@@ -455,15 +470,15 @@
 
                 csro_oneof = wrong_version.WhichOneof("current_stream_revision_option")
                 if csro_oneof == "current_no_stream":
                     result = NotFound(f"Stream {stream_name !r} not found")
                 else:
                     assert csro_oneof == "current_stream_revision"
                     psn = wrong_version.current_stream_revision
-                    result = WrongExpectedPosition(f"Current position is {psn}")
+                    result = WrongCurrentVersion(f"Current position is {psn}")
 
             # Todo: Write tests to cover all of this:
             elif error_details.Is(
                 shared_pb2.AccessDenied.DESCRIPTOR
             ):  # pragma: no cover
                 result = AccessDeniedError()
             elif error_details.Is(shared_pb2.StreamDeleted.DESCRIPTOR):
@@ -492,72 +507,74 @@
                 error_details.Unpack(bad_request)
                 result = BadRequestError(f"Bad request: {bad_request.message}")
             else:
                 # Unexpected error details type.
                 result = ESDBClientException(error_details)  # pragma: no cover
         return result
 
+    @staticmethod
     def _construct_delete_req(
-        self, stream_name: str, expected_position: Optional[int]
+        stream_name: str, current_version: Optional[int]
     ) -> streams_pb2.DeleteReq:
         options = streams_pb2.DeleteReq.Options(
             stream_identifier=shared_pb2.StreamIdentifier(
                 stream_name=stream_name.encode("utf8")
             )
         )
         # Decide 'expected_stream_revision'.
-        if isinstance(expected_position, int):
-            if expected_position >= 0:
+        if isinstance(current_version, int):
+            if current_version >= 0:
                 # Stream position is expected to be a certain value.
-                options.revision = expected_position
+                options.revision = current_version
             else:
                 # Disable optimistic concurrency control.
                 options.any.CopyFrom(shared_pb2.Empty())
         else:
             # Stream is expected to exist.
             options.stream_exists.CopyFrom(shared_pb2.Empty())
         return streams_pb2.DeleteReq(options=options)
 
+    @staticmethod
     def _construct_tombstone_req(
-        self, stream_name: str, expected_position: Optional[int]
+        stream_name: str, current_version: Optional[int]
     ) -> streams_pb2.TombstoneReq:
         options = streams_pb2.TombstoneReq.Options(
             stream_identifier=shared_pb2.StreamIdentifier(
                 stream_name=stream_name.encode("utf8")
             )
         )
         # Decide 'expected_stream_revision'.
-        if isinstance(expected_position, int):
-            if expected_position >= 0:
+        if isinstance(current_version, int):
+            if current_version >= 0:
                 # Stream position is expected to be a certain value.
-                options.revision = expected_position
+                options.revision = current_version
             else:
                 # Disable optimistic concurrency control.
                 options.any.CopyFrom(shared_pb2.Empty())
         else:
             # Stream is expected to exist.
             options.stream_exists.CopyFrom(shared_pb2.Empty())
         return streams_pb2.TombstoneReq(options=options)
 
 
 class AsyncioStreamsService(BaseStreamsService):
     async def batch_append(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> BatchAppendResponse:
         # Call the gRPC method.
         try:
             req = self._construct_batch_append_req(
                 stream_name=stream_name,
-                expected_position=expected_position,
+                current_version=current_version,
                 events=events,
                 deadline=DEFAULT_BATCH_APPEND_REQUEST_DEADLINE,
                 correlation_id=uuid4(),
             )
             async for response in self._stub.BatchAppend(
                 iter([req]),
                 timeout=timeout,
@@ -570,43 +587,43 @@
                     return result
                 else:
                     assert isinstance(result, ESDBClientException)
                     raise result
             else:  # pragma: no cover
                 raise ESDBClientException("Batch append response not received")
 
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
 
     @overload
     async def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         backwards: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncIterable[RecordedEvent]:
         """
         Signature for reading events from a stream.
         """
 
     @overload
     async def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncIterable[RecordedEvent]:
         """
         Signature for reading events from a stream with a catch-up subscription.
         """
 
     @overload
     async def read(
@@ -616,15 +633,15 @@
         backwards: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncIterable[RecordedEvent]:
         """
         Signature for reading all events.
         """
 
     @overload
     async def read(
@@ -633,15 +650,15 @@
         commit_position: Optional[int] = None,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncIterable[RecordedEvent]:
         """
         Signature for reading all events with a catch-up subscription.
         """
 
     async def read(
         self,
@@ -653,15 +670,15 @@
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncIterable[RecordedEvent]:
         """
         Constructs and sends a gRPC 'ReadReq' to the 'Read' rpc.
 
         Returns a generator which yields RecordedEvent objects.
         """
 
@@ -691,70 +708,70 @@
         )
         await response.check_confirmation()
         return response
 
     async def delete(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
-        delete_req = self._construct_delete_req(stream_name, expected_position)
+        delete_req = self._construct_delete_req(stream_name, current_version)
 
         try:
             delete_resp = await self._stub.Delete(
                 delete_req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
                         raise NotFound() from e
                     else:
-                        raise WrongExpectedPosition() from e
+                        raise WrongCurrentVersion() from e
                 elif "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
         else:
             assert isinstance(delete_resp, streams_pb2.DeleteResp), delete_resp
 
     async def tombstone(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
-        tombstone_req = self._construct_tombstone_req(stream_name, expected_position)
+        tombstone_req = self._construct_tombstone_req(stream_name, current_version)
 
         try:
             tombstone_resp = await self._stub.Tombstone(
                 tombstone_req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
                         raise NotFound() from e
                     else:
-                        raise WrongExpectedPosition() from e
+                        raise WrongCurrentVersion() from e
                 elif "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
         else:
@@ -772,31 +789,31 @@
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         backwards: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> ReadResponse:
         """
         Signature for reading events from a stream.
         """
 
     @overload
     def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
-    ) -> ReadResponse:
+        credentials: Optional[grpc.CallCredentials] = None,
+    ) -> CatchupSubscription:
         """
         Signature for reading events from a stream with a catch-up subscription.
         """
 
     @overload
     def read(
         self,
@@ -805,15 +822,15 @@
         backwards: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> ReadResponse:
         """
         Signature for reading all events.
         """
 
     @overload
     def read(
@@ -822,16 +839,16 @@
         commit_position: Optional[int] = None,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
-    ) -> ReadResponse:
+        credentials: Optional[grpc.CallCredentials] = None,
+    ) -> CatchupSubscription:
         """
         Signature for reading all events with a catch-up subscription.
         """
 
     def read(
         self,
         *,
@@ -842,16 +859,16 @@
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
-    ) -> ReadResponse:
+        credentials: Optional[grpc.CallCredentials] = None,
+    ) -> Union[ReadResponse, CatchupSubscription]:
         """
         Constructs and sends a gRPC 'ReadReq' to the 'Read' rpc.
 
         Returns a generator which yields RecordedEvent objects.
         """
 
         # Construct read request.
@@ -864,89 +881,89 @@
             filter_include=filter_include,
             filter_by_stream_name=filter_by_stream_name,
             limit=limit,
             subscribe=subscribe,
         )
 
         # Send the read request, and iterate over the response.
-        read_resp = self._stub.Read(
+        read_resps = self._stub.Read(
             read_req,
             timeout=timeout,
             metadata=self._metadata(metadata),
             credentials=credentials,
         )
+        assert isinstance(read_resps, _ReadResps)  # a _MultiThreadedRendezvous
 
-        return ReadResponse(
-            read_resp, stream_name=stream_name, is_subscription=subscribe
-        )
+        if subscribe is False:
+            return ReadResponse(read_resps, stream_name=stream_name)
+        else:
+            return CatchupSubscription(read_resps, stream_name=stream_name)
 
     def append(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> int:
         """
         Constructs and sends a stream of gRPC 'AppendReq' to the 'Append' rpc.
 
         Returns the commit position of the last appended event.
         """
         try:
             response = self._stub.Append(
                 self._generate_append_requests(
                     stream_name=stream_name,
-                    expected_position=expected_position,
+                    current_version=current_version,
                     events=events,
                 ),
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
         else:
             assert isinstance(response, streams_pb2.AppendResp)
             # Response 'result' is either 'success' or 'wrong_expected_version'.
             result_oneof = response.WhichOneof("result")
             if result_oneof == "success":
                 return response.success.position.commit_position
             else:
                 assert result_oneof == "wrong_expected_version", result_oneof
                 wev = response.wrong_expected_version
                 cro_oneof = wev.WhichOneof("current_revision_option")
                 if cro_oneof == "current_revision":
-                    raise WrongExpectedPosition(
+                    raise WrongCurrentVersion(
                         f"Current position is {wev.current_revision}"
                     )
                 else:
                     assert cro_oneof == "current_no_stream", cro_oneof
-                    raise WrongExpectedPosition(
-                        f"Stream {stream_name!r} does not exist"
-                    )
+                    raise WrongCurrentVersion(f"Stream {stream_name!r} does not exist")
 
+    @staticmethod
     def _generate_append_requests(
-        self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
     ) -> Iterator[streams_pb2.AppendReq]:
         # First, define append request that has 'content' as 'options'.
         options = streams_pb2.AppendReq.Options(
             stream_identifier=shared_pb2.StreamIdentifier(
                 stream_name=stream_name.encode("utf8")
             )
         )
         # Decide 'expected_stream_revision'.
-        if isinstance(expected_position, int):
-            if expected_position >= 0:
+        if isinstance(current_version, int):
+            if current_version >= 0:
                 # Stream is expected to exist.
-                options.revision = expected_position
+                options.revision = current_version
             else:
                 # Disable optimistic concurrency control.
                 options.any.CopyFrom(shared_pb2.Empty())
         else:
             # Stream is expected not to exist.
             options.no_stream.CopyFrom(shared_pb2.Empty())
 
@@ -963,15 +980,15 @@
             yield streams_pb2.AppendReq(proposed_message=proposed_message)
 
     # def batch_append_multiplexed(
     #     self,
     #     futures_queue: BatchAppendFutureQueue,
     #     timeout: Optional[float] = None,
     #     metadata: Optional[Metadata] = None,
-    #     credentials: Optional[CallCredentials] = None,
+    #     credentials: Optional[grpc.CallCredentials] = None,
     # ) -> None:
     #     # Construct batch append requests iterator.
     #     requests = BatchAppendFutureIterator(futures_queue)
     #
     #     # Call the gRPC method.
     #     try:
     #         for response in self._stub.BatchAppend(
@@ -1002,40 +1019,40 @@
     #                 correlation_id
     #             ) in requests.futures_by_correlation_id:  # pragma: no cover
     #                 future = requests.pop_future(correlation_id)
     #                 future.set_exception(
     #                     ESDBClientException("Batch append response not received")
     #                 )
     #
-    #     except RpcError as rpc_error:
+    #     except grpc.RpcError as rpc_error:
     #         # The response stream ended with an RPC error.
     #         try:
     #             raise handle_rpc_error(rpc_error) from rpc_error
     #         except GrpcError as grpc_error:
     #             for (
     #                 correlation_id
     #             ) in requests.futures_by_correlation_id:  # pragma: no cover
     #                 future = requests.pop_future(correlation_id)
     #                 future.set_exception(grpc_error)
     #             raise
 
     def batch_append(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> BatchAppendResponse:
         # Call the gRPC method.
         try:
             req = self._construct_batch_append_req(
                 stream_name=stream_name,
-                expected_position=expected_position,
+                current_version=current_version,
                 events=events,
                 deadline=DEFAULT_BATCH_APPEND_REQUEST_DEADLINE,
                 correlation_id=uuid4(),
             )
             for response in self._stub.BatchAppend(
                 iter([req]),
                 timeout=timeout,
@@ -1048,42 +1065,42 @@
                     return result
                 else:
                     assert isinstance(result, ESDBClientException)
                     raise result
             else:  # pragma: no cover
                 raise ESDBClientException("Batch append response not received")
 
-        except RpcError as e:
+        except grpc.RpcError as e:
             raise handle_rpc_error(e) from e
 
     def delete(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
-        delete_req = self._construct_delete_req(stream_name, expected_position)
+        delete_req = self._construct_delete_req(stream_name, current_version)
 
         try:
             delete_resp = self._stub.Delete(
                 delete_req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
                         raise NotFound() from e
                     else:
-                        raise WrongExpectedPosition() from e
+                        raise WrongCurrentVersion() from e
                 elif "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
         else:
@@ -1093,36 +1110,36 @@
             #     return delete_resp.position
             # else:
             #     return delete_resp.no_position
 
     def tombstone(
         self,
         stream_name: str,
-        expected_position: Optional[int],
+        current_version: Optional[int],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
-        credentials: Optional[CallCredentials] = None,
+        credentials: Optional[grpc.CallCredentials] = None,
     ) -> None:
-        tombstone_req = self._construct_tombstone_req(stream_name, expected_position)
+        tombstone_req = self._construct_tombstone_req(stream_name, current_version)
 
         try:
             tombstone_resp = self._stub.Tombstone(
                 tombstone_req,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
-        except RpcError as e:
-            if e.code() == StatusCode.FAILED_PRECONDITION:
+        except grpc.RpcError as e:
+            if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
                         raise NotFound() from e
                     else:
-                        raise WrongExpectedPosition() from e
+                        raise WrongCurrentVersion() from e
                 elif "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
         else:
```

### Comparing `esdbclient-1.0a5/pyproject.toml` & `esdbclient-1.0a6/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "esdbclient"
-version = "1.0a5"
+version = "1.0a6"
 description = "Python gRPC Client for EventStoreDB"
 authors = [
     "John Bywater <john.bywater@appropriatesoftware.net>",
 ]
 license = "BSD 3-Clause"
 classifiers = [
     "Development Status :: 3 - Alpha",
```

### Comparing `esdbclient-1.0a5/setup.py` & `esdbclient-1.0a6/setup.py`

 * *Files 5% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 000000d0: 2e35 322e 2a27 2c0a 2027 7072 6f74 6f62  .52.*',. 'protob
 000000e0: 7566 3e3d 332e 3131 2e30 272c 0a20 2774  uf>=3.11.0',. 't
 000000f0: 7970 696e 675f 6578 7465 6e73 696f 6e73  yping_extensions
 00000100: 275d 0a0a 7365 7475 705f 6b77 6172 6773  ']..setup_kwargs
 00000110: 203d 207b 0a20 2020 2027 6e61 6d65 273a   = {.    'name':
 00000120: 2027 6573 6462 636c 6965 6e74 272c 0a20   'esdbclient',. 
 00000130: 2020 2027 7665 7273 696f 6e27 3a20 2731     'version': '1
-00000140: 2e30 6135 272c 0a20 2020 2027 6465 7363  .0a5',.    'desc
+00000140: 2e30 6136 272c 0a20 2020 2027 6465 7363  .0a6',.    'desc
 00000150: 7269 7074 696f 6e27 3a20 2750 7974 686f  ription': 'Pytho
 00000160: 6e20 6752 5043 2043 6c69 656e 7420 666f  n gRPC Client fo
 00000170: 7220 4576 656e 7453 746f 7265 4442 272c  r EventStoreDB',
 00000180: 0a20 2020 2027 6c6f 6e67 5f64 6573 6372  .    'long_descr
 00000190: 6970 7469 6f6e 273a 2027 2320 5079 7468  iption': '# Pyth
 000001a0: 6f6e 2067 5250 4320 436c 6965 6e74 2066  on gRPC Client f
 000001b0: 6f72 2045 7665 6e74 5374 6f72 6544 425c  or EventStoreDB\
@@ -42,6913 +42,7166 @@
 00000290: 5374 6f72 6544 425c 6e74 6561 6d2e 2041  StoreDB\nteam. A
 000002a0: 6c74 686f 7567 6820 6e6f 7420 616c 6c20  lthough not all 
 000002b0: 7468 6520 6665 6174 7572 6573 206f 6620  the features of 
 000002c0: 4576 656e 7453 746f 7265 4442 2061 7265  EventStoreDB are
 000002d0: 2073 7570 706f 7274 6564 5c6e 6279 2074   supported\nby t
 000002e0: 6869 7320 636c 6965 6e74 2c20 6d61 6e79  his client, many
 000002f0: 206f 6620 7468 6520 6d6f 7374 2075 7365   of the most use
-00000300: 6675 6c20 6f6e 6573 2061 7265 2070 7265  ful ones are pre
-00000310: 7365 6e74 6564 5c6e 696e 2061 6e20 6561  sented\nin an ea
-00000320: 7379 2d74 6f2d 7573 6520 696e 7465 7266  sy-to-use interf
-00000330: 6163 652e 5c6e 5c6e 5468 6973 2063 6c69  ace.\n\nThis cli
-00000340: 656e 7420 6861 7320 6265 656e 2074 6573  ent has been tes
-00000350: 7465 6420 746f 2077 6f72 6b20 7769 7468  ted to work with
-00000360: 2045 7665 6e74 5374 6f72 6544 4220 4c54   EventStoreDB LT
-00000370: 5320 7665 7273 696f 6e73 2032 312e 3130  S versions 21.10
-00000380: 2c5c 6e77 6974 686f 7574 2061 6e64 2077  ,\nwithout and w
-00000390: 6974 686f 7574 2053 534c 2f54 4c53 2c20  ithout SSL/TLS, 
-000003a0: 616e 6420 7769 7468 2050 7974 686f 6e20  and with Python 
-000003b0: 7665 7273 696f 6e73 2033 2e37 2074 6f20  versions 3.7 to 
-000003c0: 332e 3131 2e20 5468 6572 655c 6e69 7320  3.11. There\nis 
-000003d0: 3130 3025 2074 6573 7420 636f 7665 7261  100% test covera
-000003e0: 6765 2e20 5468 6520 636f 6465 2068 6173  ge. The code has
-000003f0: 2074 7970 696e 6720 616e 6e6f 7461 7469   typing annotati
-00000400: 6f6e 732c 2063 6865 636b 6564 2077 6974  ons, checked wit
-00000410: 6820 6d79 7079 2e5c 6e54 6865 2063 6f64  h mypy.\nThe cod
-00000420: 6520 6973 2066 6f72 6d61 7474 6564 2077  e is formatted w
-00000430: 6974 6820 626c 6163 6b20 616e 6420 6973  ith black and is
-00000440: 6f72 742c 2061 6e64 2063 6865 636b 6564  ort, and checked
-00000450: 2077 6974 6820 666c 616b 6538 2e20 506f   with flake8. Po
-00000460: 6574 7279 5c6e 6973 2075 7365 6420 666f  etry\nis used fo
-00000470: 7220 7061 636b 6167 6520 6d61 6e61 6765  r package manage
-00000480: 6d65 6e74 2064 7572 696e 6720 6465 7665  ment during deve
-00000490: 6c6f 706d 656e 742c 2061 6e64 2066 6f72  lopment, and for
-000004a0: 2062 7569 6c64 696e 6720 616e 645c 6e70   building and\np
-000004b0: 7562 6c69 7368 696e 6720 6469 7374 7269  ublishing distri
-000004c0: 6275 7469 6f6e 7320 746f 205b 5079 5049  butions to [PyPI
-000004d0: 5d28 6874 7470 733a 2f2f 7079 7069 2e6f  ](https://pypi.o
-000004e0: 7267 2f70 726f 6a65 6374 2f65 7364 6263  rg/project/esdbc
-000004f0: 6c69 656e 742f 292e 5c6e 5c6e 2323 2053  lient/).\n\n## S
-00000500: 796e 6f70 7369 735c 6e5c 6e54 6865 2060  ynopsis\n\nThe `
-00000510: 4553 4442 436c 6965 6e74 6020 636c 6173  ESDBClient` clas
-00000520: 7320 6361 6e20 6265 2069 6d70 6f72 7465  s can be importe
-00000530: 6420 6672 6f6d 2074 6865 2060 6573 6462  d from the `esdb
-00000540: 636c 6965 6e74 6020 7061 636b 6167 652e  client` package.
-00000550: 5c6e 5c6e 546f 2072 756e 2074 6865 2063  \n\nTo run the c
-00000560: 6c69 656e 742c 2079 6f75 2077 696c 6c20  lient, you will 
-00000570: 6e65 6564 2061 2063 6f6e 6e65 6374 696f  need a connectio
-00000580: 6e20 7374 7269 6e67 2055 5249 2e20 416e  n string URI. An
-00000590: 642c 2074 6f5c 6e63 6f6e 6e65 6374 2074  d, to\nconnect t
-000005a0: 6f20 6120 2273 6563 7572 6522 2045 7665  o a "secure" Eve
-000005b0: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-000005c0: 2c20 796f 7520 7769 6c6c 2061 6c73 6f20  , you will also 
-000005d0: 6e65 6564 2061 6e5c 6e53 534c 2f54 4c53  need an\nSSL/TLS
-000005e0: 2063 6572 7469 6669 6361 7465 2e5c 6e5c   certificate.\n\
-000005f0: 6e50 726f 6261 626c 7920 7468 6520 7468  nProbably the th
-00000600: 7265 6520 6d6f 7374 2075 7365 6675 6c20  ree most useful 
-00000610: 6d65 7468 6f64 7320 6f66 2060 4553 4442  methods of `ESDB
-00000620: 436c 6965 6e74 6020 6172 653a 5c6e 5c6e  Client` are:\n\n
-00000630: 2a20 6061 7070 656e 645f 6576 656e 7473  * `append_events
-00000640: 2829 6020 5468 6973 206d 6574 686f 6420  ()` This method 
-00000650: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
-00000660: 6563 6f72 6420 6576 656e 7473 2069 6e20  ecord events in 
-00000670: 6120 7061 7274 6963 756c 6172 5c6e 2273  a particular\n"s
-00000680: 7472 6561 6d22 2e20 5468 6973 2069 7320  tream". This is 
-00000690: 7573 6566 756c 2066 6f72 2065 7861 6d70  useful for examp
-000006a0: 6c65 2077 6865 6e20 6578 6563 7574 696e  le when executin
-000006b0: 6720 6120 636f 6d6d 616e 6420 696e 2061  g a command in a
-000006c0: 6e20 6170 706c 6963 6174 696f 6e5c 6e74  n application\nt
-000006d0: 6861 7420 6d75 7461 7465 7320 616e 2061  hat mutates an a
-000006e0: 6767 7265 6761 7465 2e20 5468 6973 206d  ggregate. This m
-000006f0: 6574 686f 6420 6973 2022 6174 6f6d 6963  ethod is "atomic
-00000700: 2220 696e 2074 6861 7420 6569 7468 6572  " in that either
-00000710: 2061 6c6c 206f 7220 6e6f 6e65 206f 665c   all or none of\
-00000720: 6e74 6865 2065 7665 6e74 7320 7769 6c6c  nthe events will
-00000730: 2062 6520 7265 636f 7264 6564 2e5c 6e5c   be recorded.\n\
-00000740: 6e2a 2060 7265 6164 5f73 7472 6561 6d5f  n* `read_stream_
-00000750: 6576 656e 7473 2829 6020 5468 6973 206d  events()` This m
-00000760: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00000770: 6420 746f 2072 6574 7269 6576 6520 616c  d to retrieve al
-00000780: 6c20 7468 6520 7265 636f 7264 6564 5c6e  l the recorded\n
-00000790: 6576 656e 7473 2069 6e20 6120 2273 7472  events in a "str
-000007a0: 6561 6d22 2e20 5468 6973 2069 7320 7573  eam". This is us
-000007b0: 6566 756c 2066 6f72 2065 7861 6d70 6c65  eful for example
-000007c0: 2077 6865 6e20 7265 636f 6e73 7472 7563   when reconstruc
-000007d0: 7469 6e67 2061 6e20 6167 6772 6567 6174  ting an aggregat
-000007e0: 655c 6e62 6566 6f72 6520 6578 6563 7574  e\nbefore execut
-000007f0: 696e 6720 6120 636f 6d6d 616e 6420 696e  ing a command in
-00000800: 2061 6e20 6170 706c 6963 6174 696f 6e2e   an application.
-00000810: 5c6e 5c6e 2a20 6073 7562 7363 7269 6265  \n\n* `subscribe
-00000820: 5f61 6c6c 5f65 7665 6e74 7328 2960 2054  _all_events()` T
-00000830: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
-00000840: 6520 7573 6564 2074 6f20 7265 6365 6976  e used to receiv
-00000850: 6520 616c 6c20 7265 636f 7264 6564 5c6e  e all recorded\n
-00000860: 6576 656e 7473 2061 6372 6f73 7320 616c  events across al
-00000870: 6c20 2273 7472 6561 6d73 222e 2054 6869  l "streams". Thi
-00000880: 7320 6973 2075 7365 6675 6c20 696e 2064  s is useful in d
-00000890: 6f77 6e73 7472 6561 6d20 6576 656e 742d  ownstream event-
-000008a0: 7072 6f63 6573 7369 6e67 5c6e 636f 6d70  processing\ncomp
-000008b0: 6f6e 656e 7473 2c20 616e 6420 7375 7070  onents, and supp
-000008c0: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
-000008d0: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
-000008e0: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
-000008f0: 7469 6373 2028 7365 6520 6265 6c6f 7729  tics (see below)
-00000900: 2e5c 6e5c 6e54 6865 2065 7861 6d70 6c65  .\n\nThe example
-00000910: 2062 656c 6f77 2075 7365 7320 616e 2022   below uses an "
-00000920: 696e 7365 6375 7265 2220 4576 656e 7453  insecure" EventS
-00000930: 746f 7265 4442 2073 6572 7665 7220 7275  toreDB server ru
-00000940: 6e6e 696e 6720 6c6f 6361 6c6c 7920 6f6e  nning locally on
-00000950: 2070 6f72 7420 3231 3134 2e5c 6e5c 6e60   port 2114.\n\n`
-00000960: 6060 7079 7468 6f6e 5c6e 696d 706f 7274  ``python\nimport
-00000970: 2065 7364 6263 6c69 656e 742c 2075 7569   esdbclient, uui
-00000980: 645c 6e5c 6e5c 6e23 2043 6f6e 7374 7275  d\n\n\n# Constru
-00000990: 6374 2045 5344 4243 6c69 656e 7420 7769  ct ESDBClient wi
-000009a0: 7468 2061 6e20 4576 656e 7453 746f 7265  th an EventStore
-000009b0: 4442 2055 5249 2e5c 6e5c 6e63 6c69 656e  DB URI.\n\nclien
-000009c0: 7420 3d20 6573 6462 636c 6965 6e74 2e45  t = esdbclient.E
-000009d0: 5344 4243 6c69 656e 7428 7572 693d 2265  SDBClient(uri="e
-000009e0: 7364 623a 2f2f 6c6f 6361 6c68 6f73 743a  sdb://localhost:
-000009f0: 3231 3134 3f54 6c73 3d66 616c 7365 2229  2114?Tls=false")
-00000a00: 5c6e 5c6e 5c6e 2320 4170 7065 6e64 2065  \n\n\n# Append e
-00000a10: 7665 6e74 7320 746f 2061 206e 6577 2073  vents to a new s
-00000a20: 7472 6561 6d2e 5c6e 5c6e 7374 7265 616d  tream.\n\nstream
-00000a30: 5f6e 616d 6520 3d20 7374 7228 7575 6964  _name = str(uuid
-00000a40: 2e75 7569 6434 2829 295c 6e5c 6e65 7665  .uuid4())\n\neve
-00000a50: 6e74 3120 3d20 6573 6462 636c 6965 6e74  nt1 = esdbclient
-00000a60: 2e4e 6577 4576 656e 7428 7479 7065 3d5c  .NewEvent(type=\
-00000a70: 274f 7264 6572 4372 6561 7465 645c 272c  'OrderCreated\',
-00000a80: 2064 6174 613d 625c 2764 6174 6131 5c27   data=b\'data1\'
-00000a90: 295c 6e5c 6e63 6c69 656e 742e 6170 7065  )\n\nclient.appe
-00000aa0: 6e64 5f65 7665 6e74 7328 5c6e 2020 2020  nd_events(\n    
-00000ab0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00000ac0: 616d 5f6e 616d 652c 5c6e 2020 2020 6578  am_name,\n    ex
-00000ad0: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-00000ae0: 4e6f 6e65 2c5c 6e20 2020 2065 7665 6e74  None,\n    event
-00000af0: 733d 5b65 7665 6e74 315d 2c5c 6e29 5c6e  s=[event1],\n)\n
-00000b00: 5c6e 5c6e 2320 4170 7065 6e64 206d 6f72  \n\n# Append mor
-00000b10: 6520 6576 656e 7473 2074 6f20 616e 2065  e events to an e
-00000b20: 7869 7374 696e 6720 7374 7265 616d 2e5c  xisting stream.\
-00000b30: 6e5c 6e65 7665 6e74 3220 3d20 6573 6462  n\nevent2 = esdb
-00000b40: 636c 6965 6e74 2e4e 6577 4576 656e 7428  client.NewEvent(
-00000b50: 7479 7065 3d5c 274f 7264 6572 5570 6461  type=\'OrderUpda
-00000b60: 7465 645c 272c 2064 6174 613d 625c 2764  ted\', data=b\'d
-00000b70: 6174 6132 5c27 295c 6e65 7665 6e74 3320  ata2\')\nevent3 
-00000b80: 3d20 6573 6462 636c 6965 6e74 2e4e 6577  = esdbclient.New
-00000b90: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
-00000ba0: 6572 4465 6c65 7465 645c 272c 2064 6174  erDeleted\', dat
-00000bb0: 613d 625c 2764 6174 6133 5c27 295c 6e5c  a=b\'data3\')\n\
-00000bc0: 6e63 6c69 656e 742e 6170 7065 6e64 5f65  nclient.append_e
-00000bd0: 7665 6e74 7328 5c6e 2020 2020 7374 7265  vents(\n    stre
-00000be0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00000bf0: 616d 652c 5c6e 2020 2020 6578 7065 6374  ame,\n    expect
-00000c00: 6564 5f70 6f73 6974 696f 6e3d 302c 5c6e  ed_position=0,\n
-00000c10: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-00000c20: 7432 2c20 6576 656e 7433 5d2c 5c6e 295c  t2, event3],\n)\
-00000c30: 6e5c 6e5c 6e23 2052 6561 6420 616c 6c20  n\n\n# Read all 
-00000c40: 6576 656e 7473 2072 6563 6f72 6465 6420  events recorded 
-00000c50: 696e 2061 2073 7472 6561 6d2e 5c6e 5c6e  in a stream.\n\n
-00000c60: 7265 636f 7264 6564 203d 2063 6c69 656e  recorded = clien
-00000c70: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
-00000c80: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
-00000c90: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00000ca0: 6d65 5c6e 295c 6e5c 6e61 7373 6572 7420  me\n)\n\nassert 
-00000cb0: 6c65 6e28 7265 636f 7264 6564 2920 3d3d  len(recorded) ==
-00000cc0: 2033 5c6e 6173 7365 7274 2072 6563 6f72   3\nassert recor
-00000cd0: 6465 645b 305d 2e64 6174 6120 3d3d 2065  ded[0].data == e
-00000ce0: 7665 6e74 312e 6461 7461 5c6e 6173 7365  vent1.data\nasse
-00000cf0: 7274 2072 6563 6f72 6465 645b 315d 2e64  rt recorded[1].d
-00000d00: 6174 6120 3d3d 2065 7665 6e74 322e 6461  ata == event2.da
-00000d10: 7461 5c6e 6173 7365 7274 2072 6563 6f72  ta\nassert recor
-00000d20: 6465 645b 325d 2e64 6174 6120 3d3d 2065  ded[2].data == e
-00000d30: 7665 6e74 332e 6461 7461 5c6e 6173 7365  vent3.data\nasse
-00000d40: 7274 2072 6563 6f72 6465 645b 305d 2e74  rt recorded[0].t
-00000d50: 7970 6520 3d3d 2065 7665 6e74 312e 7479  ype == event1.ty
-00000d60: 7065 5c6e 6173 7365 7274 2072 6563 6f72  pe\nassert recor
-00000d70: 6465 645b 315d 2e74 7970 6520 3d3d 2065  ded[1].type == e
-00000d80: 7665 6e74 322e 7479 7065 5c6e 6173 7365  vent2.type\nasse
-00000d90: 7274 2072 6563 6f72 6465 645b 325d 2e74  rt recorded[2].t
-00000da0: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
-00000db0: 7065 5c6e 5c6e 5c6e 2320 496e 2061 6e20  pe\n\n\n# In an 
-00000dc0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
-00000dd0: 2063 6f6d 706f 6e65 6e74 2c20 7573 6520   component, use 
-00000de0: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
-00000df0: 7363 7269 7074 696f 6e5c 6e23 2074 6f20  scription\n# to 
-00000e00: 7265 6365 6976 6520 616c 6c20 6576 656e  receive all even
-00000e10: 7473 2061 6372 6f73 7320 616c 6c20 7374  ts across all st
-00000e20: 7265 616d 732c 2069 6e63 6c75 6469 6e67  reams, including
-00000e30: 2065 7665 6e74 7320 7468 6174 5c6e 2320   events that\n# 
-00000e40: 6861 7665 206e 6f74 2079 6574 2062 6565  have not yet bee
-00000e50: 6e20 7265 636f 7264 6564 2c20 7374 6172  n recorded, star
-00000e60: 7469 6e67 2066 726f 6d20 7468 6520 636f  ting from the co
-00000e70: 6d70 6f6e 656e 745c 2773 206c 6173 745c  mponent\'s last\
-00000e80: 6e23 2073 6176 6564 2022 636f 6d6d 6974  n# saved "commit
-00000e90: 2070 6f73 6974 696f 6e22 2e5c 6e5c 6e6c   position".\n\nl
-00000ea0: 6173 745f 7361 7665 645f 636f 6d6d 6974  ast_saved_commit
-00000eb0: 5f70 6f73 6974 696f 6e20 3d20 305c 6e5c  _position = 0\n\
-00000ec0: 6e73 7562 7363 7269 7074 696f 6e20 3d20  nsubscription = 
-00000ed0: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
-00000ee0: 5f61 6c6c 5f65 7665 6e74 7328 5c6e 2020  _all_events(\n  
-00000ef0: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
-00000f00: 6e3d 6c61 7374 5f73 6176 6564 5f63 6f6d  n=last_saved_com
-00000f10: 6d69 745f 706f 7369 7469 6f6e 5c6e 295c  mit_position\n)\
-00000f20: 6e5c 6e23 2054 6f20 696d 706c 656d 656e  n\n# To implemen
-00000f30: 7420 2265 7861 6374 6c79 2d6f 6e63 6522  t "exactly-once"
-00000f40: 2073 656d 616e 7469 6373 2c20 6974 6572   semantics, iter
-00000f50: 6174 6520 6f76 6572 2074 6865 5c6e 2320  ate over the\n# 
-00000f60: 2263 6174 6368 2d75 7022 2073 7562 7363  "catch-up" subsc
-00000f70: 7269 7074 696f 6e2e 2050 726f 6365 7373  ription. Process
-00000f80: 2065 6163 6820 7265 6365 6976 6564 2065   each received e
-00000f90: 7665 6e74 2c5c 6e23 2069 6e20 7475 726e  vent,\n# in turn
-00000fa0: 2c20 7468 726f 7567 6820 616e 2065 7665  , through an eve
-00000fb0: 6e74 2d70 726f 6365 7373 696e 6720 706f  nt-processing po
-00000fc0: 6c69 6379 2e20 5361 7665 2074 6865 5c6e  licy. Save the\n
-00000fd0: 2320 7661 6c75 6520 6f66 2074 6865 2063  # value of the c
-00000fe0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2061  ommit_position a
-00000ff0: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
-00001000: 7072 6f63 6573 7365 645c 6e23 2065 7665  processed\n# eve
-00001010: 6e74 2077 6974 6820 6e65 7720 7374 6174  nt with new stat
-00001020: 6520 6765 6e65 7261 7465 6420 6279 2074  e generated by t
-00001030: 6865 2070 6f6c 6963 7920 696e 2074 6865  he policy in the
-00001040: 2073 616d 655c 6e23 2061 746f 6d69 6320   same\n# atomic 
-00001050: 7472 616e 7361 6374 696f 6e2e 2055 7365  transaction. Use
-00001060: 2074 6865 206c 6173 7420 7361 7665 6420   the last saved 
-00001070: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
-00001080: 225c 6e23 2077 6865 6e20 7265 7374 6172  "\n# when restar
-00001090: 7469 6e67 2074 6865 2022 6361 7463 682d  ting the "catch-
-000010a0: 7570 2220 7375 6273 6372 6970 7469 6f6e  up" subscription
-000010b0: 2e5c 6e5c 6e72 6563 6569 7665 6420 3d20  .\n\nreceived = 
-000010c0: 5b5d 5c6e 666f 7220 6576 656e 7420 696e  []\nfor event in
-000010d0: 2073 7562 7363 7269 7074 696f 6e3a 5c6e   subscription:\n
-000010e0: 2020 2020 7265 6365 6976 6564 2e61 7070      received.app
-000010f0: 656e 6428 6576 656e 7429 5c6e 2020 2020  end(event)\n    
-00001100: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
-00001110: 7665 6e74 332e 6964 3a5c 6e20 2020 2020  vent3.id:\n     
-00001120: 2020 2062 7265 616b 5c6e 5c6e 6173 7365     break\n\nasse
-00001130: 7274 2072 6563 6569 7665 645b 2d33 5d2e  rt received[-3].
-00001140: 6461 7461 203d 3d20 6576 656e 7431 2e64  data == event1.d
-00001150: 6174 615c 6e61 7373 6572 7420 7265 6365  ata\nassert rece
-00001160: 6976 6564 5b2d 325d 2e64 6174 6120 3d3d  ived[-2].data ==
-00001170: 2065 7665 6e74 322e 6461 7461 5c6e 6173   event2.data\nas
-00001180: 7365 7274 2072 6563 6569 7665 645b 2d31  sert received[-1
-00001190: 5d2e 6461 7461 203d 3d20 6576 656e 7433  ].data == event3
-000011a0: 2e64 6174 615c 6e61 7373 6572 7420 7265  .data\nassert re
-000011b0: 6365 6976 6564 5b2d 335d 2e74 7970 6520  ceived[-3].type 
-000011c0: 3d3d 2065 7665 6e74 312e 7479 7065 5c6e  == event1.type\n
-000011d0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-000011e0: 2d32 5d2e 7479 7065 203d 3d20 6576 656e  -2].type == even
-000011f0: 7432 2e74 7970 655c 6e61 7373 6572 7420  t2.type\nassert 
-00001200: 7265 6365 6976 6564 5b2d 315d 2e74 7970  received[-1].typ
-00001210: 6520 3d3d 2065 7665 6e74 332e 7479 7065  e == event3.type
-00001220: 5c6e 5c6e 6173 7365 7274 2072 6563 6569  \n\nassert recei
-00001230: 7665 645b 2d33 5d2e 636f 6d6d 6974 5f70  ved[-3].commit_p
-00001240: 6f73 6974 696f 6e20 3e20 305c 6e61 7373  osition > 0\nass
-00001250: 6572 7420 7265 6365 6976 6564 5b2d 325d  ert received[-2]
-00001260: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-00001270: 203e 2072 6563 6569 7665 645b 2d33 5d2e   > received[-3].
-00001280: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5c  commit_position\
-00001290: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-000012a0: 5b2d 315d 2e63 6f6d 6d69 745f 706f 7369  [-1].commit_posi
-000012b0: 7469 6f6e 203e 2072 6563 6569 7665 645b  tion > received[
-000012c0: 2d32 5d2e 636f 6d6d 6974 5f70 6f73 6974  -2].commit_posit
-000012d0: 696f 6e5c 6e5c 6e5c 6e23 2043 6c6f 7365  ion\n\n\n# Close
-000012e0: 2074 6865 2063 6c69 656e 7420 6166 7465   the client afte
-000012f0: 7220 7573 652e 5c6e 5c6e 636c 6965 6e74  r use.\n\nclient
-00001300: 2e63 6c6f 7365 2829 5c6e 6060 605c 6e5c  .close()\n```\n\
-00001310: 6e53 6565 2062 656c 6f77 2066 6f72 206d  nSee below for m
-00001320: 6f72 6520 6465 7461 696c 732e 5c6e 5c6e  ore details.\n\n
-00001330: 466f 7220 616e 2065 7861 6d70 6c65 206f  For an example o
-00001340: 6620 7573 6167 652c 2073 6565 2074 6865  f usage, see the
-00001350: 205b 6576 656e 7473 6f75 7263 696e 672d   [eventsourcing-
-00001360: 6576 656e 7473 746f 7265 6462 5d28 5c6e  eventstoredb](\n
-00001370: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00001380: 6f6d 2f70 7965 7665 6e74 736f 7572 6369  om/pyeventsourci
-00001390: 6e67 2f65 7665 6e74 736f 7572 6369 6e67  ng/eventsourcing
-000013a0: 2d65 7665 6e74 7374 6f72 6564 6229 2070  -eventstoredb) p
-000013b0: 6163 6b61 6765 2e5c 6e5c 6e23 2320 5461  ackage.\n\n## Ta
-000013c0: 626c 6520 6f66 2063 6f6e 7465 6e74 735c  ble of contents\
-000013d0: 6e5c 6e3c 212d 2d20 544f 4320 2d2d 3e5c  n\n<!-- TOC -->\
-000013e0: 6e2a 205b 496e 7374 616c 6c20 7061 636b  n* [Install pack
-000013f0: 6167 655d 2823 696e 7374 616c 6c2d 7061  age](#install-pa
-00001400: 636b 6167 6529 5c6e 2020 2a20 5b46 726f  ckage)\n  * [Fro
-00001410: 6d20 5079 5049 5d28 2366 726f 6d2d 7079  m PyPI](#from-py
-00001420: 7069 295c 6e20 202a 205b 5769 7468 2050  pi)\n  * [With P
-00001430: 6f65 7472 795d 2823 7769 7468 2d70 6f65  oetry](#with-poe
-00001440: 7472 7929 5c6e 2a20 5b45 7665 6e74 5374  try)\n* [EventSt
-00001450: 6f72 6544 4220 7365 7276 6572 5d28 2365  oreDB server](#e
-00001460: 7665 6e74 7374 6f72 6564 622d 7365 7276  ventstoredb-serv
-00001470: 6572 295c 6e20 202a 205b 5275 6e20 636f  er)\n  * [Run co
-00001480: 6e74 6169 6e65 725d 2823 7275 6e2d 636f  ntainer](#run-co
-00001490: 6e74 6169 6e65 7229 5c6e 2020 2a20 5b53  ntainer)\n  * [S
-000014a0: 746f 7020 636f 6e74 6169 6e65 725d 2823  top container](#
-000014b0: 7374 6f70 2d63 6f6e 7461 696e 6572 295c  stop-container)\
-000014c0: 6e2a 205b 4576 656e 7453 746f 7265 4442  n* [EventStoreDB
-000014d0: 2063 6c69 656e 745d 2823 6576 656e 7473   client](#events
-000014e0: 746f 7265 6462 2d63 6c69 656e 7429 5c6e  toredb-client)\n
-000014f0: 2020 2a20 5b49 6d70 6f72 7420 636c 6173    * [Import clas
-00001500: 735d 2823 696d 706f 7274 2d63 6c61 7373  s](#import-class
-00001510: 295c 6e20 202a 205b 436f 6e73 7472 7563  )\n  * [Construc
-00001520: 7420 636c 6965 6e74 5d28 2363 6f6e 7374  t client](#const
-00001530: 7275 6374 2d63 6c69 656e 7429 5c6e 2a20  ruct-client)\n* 
-00001540: 5b53 7472 6561 6d73 5d28 2373 7472 6561  [Streams](#strea
-00001550: 6d73 295c 6e20 202a 205b 4170 7065 6e64  ms)\n  * [Append
-00001560: 2065 7665 6e74 735d 2823 6170 7065 6e64   events](#append
-00001570: 2d65 7665 6e74 7329 5c6e 2020 2a20 5b41  -events)\n  * [A
-00001580: 7070 656e 6420 6576 656e 745d 2823 6170  ppend event](#ap
-00001590: 7065 6e64 2d65 7665 6e74 295c 6e20 202a  pend-event)\n  *
-000015a0: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
-000015b0: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
-000015c0: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
-000015d0: 6e64 2d6f 7065 7261 7469 6f6e 7329 5c6e  nd-operations)\n
-000015e0: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
-000015f0: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
-00001600: 7472 6561 6d2d 6576 656e 7473 295c 6e20  tream-events)\n 
-00001610: 202a 205b 486f 7720 746f 2069 6d70 6c65   * [How to imple
-00001620: 6d65 6e74 2073 6e61 7073 686f 7474 696e  ment snapshottin
-00001630: 6720 7769 7468 2045 7665 6e74 5374 6f72  g with EventStor
-00001640: 6544 425d 2823 686f 772d 746f 2d69 6d70  eDB](#how-to-imp
-00001650: 6c65 6d65 6e74 2d73 6e61 7073 686f 7474  lement-snapshott
-00001660: 696e 672d 7769 7468 2d65 7665 6e74 7374  ing-with-eventst
-00001670: 6f72 6564 6229 5c6e 2020 2a20 5b52 6561  oredb)\n  * [Rea
-00001680: 6420 616c 6c20 6576 656e 7473 5d28 2372  d all events](#r
-00001690: 6561 642d 616c 6c2d 6576 656e 7473 295c  ead-all-events)\
-000016a0: 6e20 202a 205b 4765 7420 6375 7272 656e  n  * [Get curren
-000016b0: 7420 7374 7265 616d 2070 6f73 6974 696f  t stream positio
-000016c0: 6e5d 2823 6765 742d 6375 7272 656e 742d  n](#get-current-
-000016d0: 7374 7265 616d 2d70 6f73 6974 696f 6e29  stream-position)
-000016e0: 5c6e 2020 2a20 5b47 6574 2063 7572 7265  \n  * [Get curre
-000016f0: 6e74 2063 6f6d 6d69 7420 706f 7369 7469  nt commit positi
-00001700: 6f6e 5d28 2367 6574 2d63 7572 7265 6e74  on](#get-current
-00001710: 2d63 6f6d 6d69 742d 706f 7369 7469 6f6e  -commit-position
-00001720: 295c 6e20 202a 205b 4765 7420 7374 7265  )\n  * [Get stre
-00001730: 616d 206d 6574 6164 6174 615d 2823 6765  am metadata](#ge
-00001740: 742d 7374 7265 616d 2d6d 6574 6164 6174  t-stream-metadat
-00001750: 6129 5c6e 2020 2a20 5b53 6574 2073 7472  a)\n  * [Set str
-00001760: 6561 6d20 6d65 7461 6461 7461 5d28 2373  eam metadata](#s
-00001770: 6574 2d73 7472 6561 6d2d 6d65 7461 6461  et-stream-metada
-00001780: 7461 295c 6e20 202a 205b 4465 6c65 7465  ta)\n  * [Delete
-00001790: 2073 7472 6561 6d5d 2823 6465 6c65 7465   stream](#delete
-000017a0: 2d73 7472 6561 6d29 5c6e 2020 2a20 5b54  -stream)\n  * [T
-000017b0: 6f6d 6273 746f 6e65 2073 7472 6561 6d5d  ombstone stream]
-000017c0: 2823 746f 6d62 7374 6f6e 652d 7374 7265  (#tombstone-stre
-000017d0: 616d 295c 6e2a 205b 4361 7463 682d 7570  am)\n* [Catch-up
-000017e0: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
-000017f0: 2363 6174 6368 2d75 702d 7375 6273 6372  #catch-up-subscr
-00001800: 6970 7469 6f6e 7329 5c6e 2020 2a20 5b48  iptions)\n  * [H
-00001810: 6f77 2074 6f20 696d 706c 656d 656e 7420  ow to implement 
-00001820: 6578 6163 746c 792d 6f6e 6365 2065 7665  exactly-once eve
-00001830: 6e74 2070 726f 6365 7373 696e 675d 2823  nt processing](#
-00001840: 686f 772d 746f 2d69 6d70 6c65 6d65 6e74  how-to-implement
-00001850: 2d65 7861 6374 6c79 2d6f 6e63 652d 6576  -exactly-once-ev
-00001860: 656e 742d 7072 6f63 6573 7369 6e67 295c  ent-processing)\
-00001870: 6e20 202a 205b 5375 6273 6372 6962 6520  n  * [Subscribe 
-00001880: 616c 6c20 6576 656e 7473 5d28 2373 7562  all events](#sub
-00001890: 7363 7269 6265 2d61 6c6c 2d65 7665 6e74  scribe-all-event
-000018a0: 7329 5c6e 2020 2a20 5b53 7562 7363 7269  s)\n  * [Subscri
-000018b0: 6265 2073 7472 6561 6d20 6576 656e 7473  be stream events
-000018c0: 5d28 2373 7562 7363 7269 6265 2d73 7472  ](#subscribe-str
-000018d0: 6561 6d2d 6576 656e 7473 295c 6e2a 205b  eam-events)\n* [
-000018e0: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
-000018f0: 7269 7074 696f 6e73 5d28 2370 6572 7369  riptions](#persi
-00001900: 7374 656e 742d 7375 6273 6372 6970 7469  stent-subscripti
-00001910: 6f6e 7329 5c6e 2020 2a20 5b43 7265 6174  ons)\n  * [Creat
-00001920: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
-00001930: 2363 7265 6174 652d 7375 6273 6372 6970  #create-subscrip
-00001940: 7469 6f6e 295c 6e20 202a 205b 5265 6164  tion)\n  * [Read
-00001950: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
-00001960: 7265 6164 2d73 7562 7363 7269 7074 696f  read-subscriptio
-00001970: 6e29 5c6e 2020 2a20 5b47 6574 2073 7562  n)\n  * [Get sub
-00001980: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
-00001990: 2367 6574 2d73 7562 7363 7269 7074 696f  #get-subscriptio
-000019a0: 6e2d 696e 666f 295c 6e20 202a 205b 4c69  n-info)\n  * [Li
-000019b0: 7374 2073 7562 7363 7269 7074 696f 6e73  st subscriptions
-000019c0: 5d28 236c 6973 742d 7375 6273 6372 6970  ](#list-subscrip
-000019d0: 7469 6f6e 7329 5c6e 2020 2a20 5b44 656c  tions)\n  * [Del
-000019e0: 6574 6520 7375 6273 6372 6970 7469 6f6e  ete subscription
-000019f0: 5d28 2364 656c 6574 652d 7375 6273 6372  ](#delete-subscr
-00001a00: 6970 7469 6f6e 295c 6e20 202a 205b 5570  iption)\n  * [Up
-00001a10: 6461 7465 2073 7562 7363 7269 7074 696f  date subscriptio
-00001a20: 6e5d 2823 7570 6461 7465 2d73 7562 7363  n](#update-subsc
-00001a30: 7269 7074 696f 6e29 5c6e 2020 2a20 5b43  ription)\n  * [C
-00001a40: 7265 6174 6520 7374 7265 616d 2073 7562  reate stream sub
-00001a50: 7363 7269 7074 696f 6e5d 2823 6372 6561  scription](#crea
-00001a60: 7465 2d73 7472 6561 6d2d 7375 6273 6372  te-stream-subscr
-00001a70: 6970 7469 6f6e 295c 6e20 202a 205b 5265  iption)\n  * [Re
-00001a80: 6164 2073 7472 6561 6d20 7375 6273 6372  ad stream subscr
-00001a90: 6970 7469 6f6e 5d28 2372 6561 642d 7374  iption](#read-st
-00001aa0: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
-00001ab0: 6e29 5c6e 2020 2a20 5b47 6574 2073 7472  n)\n  * [Get str
-00001ac0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00001ad0: 2069 6e66 6f5d 2823 6765 742d 7374 7265   info](#get-stre
-00001ae0: 616d 2d73 7562 7363 7269 7074 696f 6e2d  am-subscription-
-00001af0: 696e 666f 295c 6e20 202a 205b 4c69 7374  info)\n  * [List
-00001b00: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00001b10: 7469 6f6e 735d 2823 6c69 7374 2d73 7472  tions](#list-str
-00001b20: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
-00001b30: 7329 5c6e 2020 2a20 5b55 7064 6174 6520  s)\n  * [Update 
-00001b40: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00001b50: 696f 6e5d 2823 7570 6461 7465 2d73 7472  ion](#update-str
-00001b60: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
-00001b70: 295c 6e20 202a 205b 4465 6c65 7465 2073  )\n  * [Delete s
-00001b80: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00001b90: 6f6e 5d28 2364 656c 6574 652d 7374 7265  on](#delete-stre
-00001ba0: 616d 2d73 7562 7363 7269 7074 696f 6e29  am-subscription)
-00001bb0: 5c6e 2020 2a20 5b50 6572 7369 7374 656e  \n  * [Persisten
-00001bc0: 7420 7375 6273 6372 6970 7469 6f6e 2063  t subscription c
-00001bd0: 6f6e 7375 6d65 725d 2823 7065 7273 6973  onsumer](#persis
-00001be0: 7465 6e74 2d73 7562 7363 7269 7074 696f  tent-subscriptio
-00001bf0: 6e2d 636f 6e73 756d 6572 295c 6e2a 205b  n-consumer)\n* [
-00001c00: 436f 6e6e 6563 7469 6f6e 5d28 2363 6f6e  Connection](#con
-00001c10: 6e65 6374 696f 6e29 5c6e 2020 2a20 5b52  nection)\n  * [R
-00001c20: 6563 6f6e 6e65 6374 5d28 2372 6563 6f6e  econnect](#recon
-00001c30: 6e65 6374 295c 6e20 202a 205b 436c 6f73  nect)\n  * [Clos
-00001c40: 655d 2823 636c 6f73 6529 5c6e 2a20 5b4e  e](#close)\n* [N
-00001c50: 6f74 6573 5d28 236e 6f74 6573 295c 6e20  otes](#notes)\n 
-00001c60: 202a 205b 436f 6e6e 6563 7469 6f6e 2073   * [Connection s
-00001c70: 7472 696e 6773 5d28 2363 6f6e 6e65 6374  trings](#connect
-00001c80: 696f 6e2d 7374 7269 6e67 7329 5c6e 2020  ion-strings)\n  
-00001c90: 2a20 5b52 6567 756c 6172 2065 7870 7265  * [Regular expre
-00001ca0: 7373 696f 6e20 6669 6c74 6572 735d 2823  ssion filters](#
-00001cb0: 7265 6775 6c61 722d 6578 7072 6573 7369  regular-expressi
-00001cc0: 6f6e 2d66 696c 7465 7273 295c 6e20 202a  on-filters)\n  *
-00001cd0: 205b 4e65 7720 6576 656e 7420 6f62 6a65   [New event obje
-00001ce0: 6374 735d 2823 6e65 772d 6576 656e 742d  cts](#new-event-
-00001cf0: 6f62 6a65 6374 7329 5c6e 2020 2a20 5b52  objects)\n  * [R
-00001d00: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
-00001d10: 6a65 6374 735d 2823 7265 636f 7264 6564  jects](#recorded
-00001d20: 2d65 7665 6e74 2d6f 626a 6563 7473 295c  -event-objects)\
-00001d30: 6e20 202a 205b 4173 796e 6369 6f20 636c  n  * [Asyncio cl
-00001d40: 6965 6e74 5d28 2361 7379 6e63 696f 2d63  ient](#asyncio-c
-00001d50: 6c69 656e 7429 5c6e 2a20 5b43 6f6e 7472  lient)\n* [Contr
-00001d60: 6962 7574 6f72 735d 2823 636f 6e74 7269  ibutors](#contri
-00001d70: 6275 746f 7273 295c 6e20 202a 205b 496e  butors)\n  * [In
-00001d80: 7374 616c 6c20 506f 6574 7279 5d28 2369  stall Poetry](#i
-00001d90: 6e73 7461 6c6c 2d70 6f65 7472 7929 5c6e  nstall-poetry)\n
-00001da0: 2020 2a20 5b53 6574 7570 2066 6f72 2050    * [Setup for P
-00001db0: 7943 6861 726d 2075 7365 7273 5d28 2373  yCharm users](#s
-00001dc0: 6574 7570 2d66 6f72 2d70 7963 6861 726d  etup-for-pycharm
-00001dd0: 2d75 7365 7273 295c 6e20 202a 205b 5365  -users)\n  * [Se
-00001de0: 7475 7020 6672 6f6d 2063 6f6d 6d61 6e64  tup from command
-00001df0: 206c 696e 655d 2823 7365 7475 702d 6672   line](#setup-fr
-00001e00: 6f6d 2d63 6f6d 6d61 6e64 2d6c 696e 6529  om-command-line)
-00001e10: 5c6e 2020 2a20 5b50 726f 6a65 6374 204d  \n  * [Project M
-00001e20: 616b 6566 696c 6520 636f 6d6d 616e 6473  akefile commands
-00001e30: 5d28 2370 726f 6a65 6374 2d6d 616b 6566  ](#project-makef
-00001e40: 696c 652d 636f 6d6d 616e 6473 295c 6e3c  ile-commands)\n<
-00001e50: 212d 2d20 544f 4320 2d2d 3e5c 6e5c 6e23  !-- TOC -->\n\n#
-00001e60: 2320 496e 7374 616c 6c20 7061 636b 6167  # Install packag
-00001e70: 655c 6e5c 6e49 7420 6973 2072 6563 6f6d  e\n\nIt is recom
-00001e80: 6d65 6e64 6564 2074 6f20 696e 7374 616c  mended to instal
-00001e90: 6c20 5079 7468 6f6e 2070 6163 6b61 6765  l Python package
-00001ea0: 7320 696e 746f 2061 2050 7974 686f 6e20  s into a Python 
-00001eb0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-00001ec0: 656e 742e 5c6e 5c6e 2323 2320 4672 6f6d  ent.\n\n### From
-00001ed0: 2050 7950 495c 6e5c 6e59 6f75 2063 616e   PyPI\n\nYou can
-00001ee0: 2075 7365 2070 6970 2074 6f20 696e 7374   use pip to inst
-00001ef0: 616c 6c20 7468 6973 2070 6163 6b61 6765  all this package
-00001f00: 2064 6972 6563 746c 7920 6672 6f6d 5c6e   directly from\n
-00001f10: 5b74 6865 2050 7974 686f 6e20 5061 636b  [the Python Pack
-00001f20: 6167 6520 496e 6465 785d 2868 7474 7073  age Index](https
-00001f30: 3a2f 2f70 7970 692e 6f72 672f 7072 6f6a  ://pypi.org/proj
-00001f40: 6563 742f 6573 6462 636c 6965 6e74 2f29  ect/esdbclient/)
-00001f50: 2e5c 6e5c 6e20 2020 2024 2070 6970 2069  .\n\n    $ pip i
-00001f60: 6e73 7461 6c6c 2065 7364 6263 6c69 656e  nstall esdbclien
-00001f70: 745c 6e5c 6e23 2323 2057 6974 6820 506f  t\n\n### With Po
-00001f80: 6574 7279 5c6e 5c6e 596f 7520 6361 6e20  etry\n\nYou can 
-00001f90: 7573 6520 506f 6574 7279 2074 6f20 6164  use Poetry to ad
-00001fa0: 6420 7468 6973 2070 6163 6b61 6765 2074  d this package t
-00001fb0: 6f20 796f 7572 2070 7970 726f 6a65 6374  o your pyproject
-00001fc0: 2e74 6f6d 6c20 616e 6420 696e 7374 616c  .toml and instal
-00001fd0: 6c20 6974 2e5c 6e5c 6e20 2020 2024 2070  l it.\n\n    $ p
-00001fe0: 6f65 7472 7920 6164 6420 6573 6462 636c  oetry add esdbcl
-00001ff0: 6965 6e74 5c6e 5c6e 2323 2045 7665 6e74  ient\n\n## Event
-00002000: 5374 6f72 6544 4220 7365 7276 6572 5c6e  StoreDB server\n
-00002010: 5c6e 5468 6520 4576 656e 7453 746f 7265  \nThe EventStore
-00002020: 4442 2073 6572 7665 7220 6361 6e20 6265  DB server can be
-00002030: 2072 756e 206c 6f63 616c 6c79 2075 7369   run locally usi
-00002040: 6e67 2074 6865 206f 6666 6963 6961 6c20  ng the official 
-00002050: 446f 636b 6572 2063 6f6e 7461 696e 6572  Docker container
-00002060: 2069 6d61 6765 2e5c 6e5c 6e23 2323 2052   image.\n\n### R
-00002070: 756e 2063 6f6e 7461 696e 6572 5c6e 5c6e  un container\n\n
-00002080: 466f 7220 6465 7665 6c6f 706d 656e 742c  For development,
-00002090: 2079 6f75 2063 616e 2072 756e 2061 2022   you can run a "
-000020a0: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
-000020b0: 7265 4442 2073 6572 7665 7220 7573 696e  reDB server usin
-000020c0: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
-000020d0: 636f 6d6d 616e 642e 5c6e 5c6e 2020 2020  command.\n\n    
-000020e0: 2420 646f 636b 6572 2072 756e 202d 6420  $ docker run -d 
-000020f0: 2d2d 6e61 6d65 2065 7665 6e74 7374 6f72  --name eventstor
-00002100: 6564 622d 7365 6375 7265 202d 6974 202d  edb-secure -it -
-00002110: 7020 3231 3133 3a32 3131 3320 2d2d 656e  p 2113:2113 --en
-00002120: 7620 2248 4f4d 453d 2f74 6d70 2220 6576  v "HOME=/tmp" ev
-00002130: 656e 7473 746f 7265 2f65 7665 6e74 7374  entstore/eventst
-00002140: 6f72 653a 3231 2e31 302e 392d 6275 7374  ore:21.10.9-bust
-00002150: 6572 2d73 6c69 6d20 2d2d 6465 765c 6e5c  er-slim --dev\n\
-00002160: 6e41 7320 7765 2077 696c 6c20 7365 652c  nAs we will see,
-00002170: 2074 6865 2063 6c69 656e 7420 6e65 6564   the client need
-00002180: 7320 616e 2045 7665 6e74 5374 6f72 6544  s an EventStoreD
-00002190: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-000021a0: 696e 6720 5552 4920 6173 2074 6865 2076  ing URI as the v
-000021b0: 616c 7565 206f 665c 6e69 7473 2060 7572  alue of\nits `ur
-000021c0: 6960 2063 6f6e 7374 7275 6374 6f72 2061  i` constructor a
-000021d0: 7267 756d 656e 742e 2053 6565 2074 6865  rgument. See the
-000021e0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-000021f0: 656c 6f77 2066 6f72 2064 6574 6169 6c65  elow for detaile
-00002200: 6420 696e 666f 726d 6174 696f 6e5c 6e61  d information\na
-00002210: 626f 7574 2045 7665 6e74 5374 6f72 6544  bout EventStoreD
-00002220: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-00002230: 696e 6720 5552 4973 2e5c 6e5c 6e54 6865  ing URIs.\n\nThe
-00002240: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00002250: 6e67 2066 6f72 2074 6869 7320 2273 6563  ng for this "sec
-00002260: 7572 6522 2045 7665 6e74 5374 6f72 6544  ure" EventStoreD
-00002270: 4220 7365 7276 6572 2077 6f75 6c64 2062  B server would b
-00002280: 653a 5c6e 5c6e 2020 2020 6573 6462 3a2f  e:\n\n    esdb:/
-00002290: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
-000022a0: 6c6f 6361 6c68 6f73 743a 3231 3133 5c6e  localhost:2113\n
-000022b0: 5c6e 546f 2063 6f6e 6e65 6374 2074 6f20  \nTo connect to 
-000022c0: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
-000022d0: 722c 2079 6f75 2077 696c 6c20 7573 7561  r, you will usua
-000022e0: 6c6c 7920 6e65 6564 2074 6f20 696e 636c  lly need to incl
-000022f0: 7564 6520 6120 2275 7365 726e 616d 6522  ude a "username"
-00002300: 5c6e 616e 6420 6120 2270 6173 7377 6f72  \nand a "passwor
-00002310: 6422 2069 6e20 7468 6520 636f 6e6e 6563  d" in the connec
-00002320: 7469 6f6e 2073 7472 696e 672c 2073 6f20  tion string, so 
-00002330: 7468 6174 2074 6865 2073 6572 7665 7220  that the server 
-00002340: 6361 6e20 6175 7468 656e 7469 6361 7465  can authenticate
-00002350: 2074 6865 5c6e 636c 6965 6e74 2e20 5468   the\nclient. Th
-00002360: 6520 6465 6661 756c 7420 7573 6572 6e61  e default userna
-00002370: 6d65 2069 7320 2261 646d 696e 2220 616e  me is "admin" an
-00002380: 6420 7468 6520 6465 6661 756c 7420 7061  d the default pa
-00002390: 7373 776f 7264 2069 7320 2263 6861 6e67  ssword is "chang
-000023a0: 6569 7422 2e5c 6e5c 6e57 6865 6e20 636f  eit".\n\nWhen co
-000023b0: 6e6e 6563 7469 6e67 2074 6f20 6120 2273  nnecting to a "s
-000023c0: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
-000023d0: 6865 2063 6c69 656e 7420 616c 736f 206e  he client also n
-000023e0: 6565 6473 2061 6e20 5353 4c2f 544c 535c  eeds an SSL/TLS\
-000023f0: 6e63 6572 7469 6669 6361 7465 2061 7320  ncertificate as 
-00002400: 7468 6520 7661 6c75 6520 6f66 2069 7473  the value of its
-00002410: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
-00002420: 7465 7360 2063 6f6e 7374 7275 6374 6f72  tes` constructor
-00002430: 2061 7267 756d 656e 742e 2054 6f20 636f   argument. To co
-00002440: 6e6e 6563 745c 6e74 6f20 6120 2273 6563  nnect\nto a "sec
-00002450: 7572 6522 2073 6572 7665 7220 796f 7520  ure" server you 
-00002460: 7769 6c6c 206e 6565 6420 616e 2053 534c  will need an SSL
-00002470: 2f54 4c53 2063 6572 7469 6669 6361 7465  /TLS certificate
-00002480: 2073 6f20 7468 6174 2074 6865 2063 6c69   so that the cli
-00002490: 656e 7420 6361 6e5c 6e61 7574 6865 6e74  ent can\nauthent
-000024a0: 6963 6174 6520 7468 6520 7365 7276 6572  icate the server
-000024b0: 2e20 466f 7220 6465 7665 6c6f 706d 656e  . For developmen
-000024c0: 742c 2079 6f75 2063 616e 2065 6974 6865  t, you can eithe
-000024d0: 7220 7573 6520 7468 6520 5353 4c2f 544c  r use the SSL/TL
-000024e0: 5320 6365 7274 6966 6963 6174 655c 6e6f  S certificate\no
-000024f0: 6620 7468 6520 6365 7274 6966 6963 6174  f the certificat
-00002500: 6520 6175 7468 6f72 6974 7920 7573 6564  e authority used
-00002510: 2074 6f20 6372 6561 7465 2074 6865 2073   to create the s
-00002520: 6572 7665 725c 2773 2063 6572 7469 6669  erver\'s certifi
-00002530: 6361 7465 2c20 6f72 2077 6865 6e20 7573  cate, or when us
-00002540: 696e 6720 615c 6e73 696e 676c 652d 6e6f  ing a\nsingle-no
-00002550: 6465 2063 6c75 7374 6572 2c20 796f 7520  de cluster, you 
-00002560: 6361 6e20 7573 6520 7468 6520 7365 7276  can use the serv
-00002570: 6572 2063 6572 7469 6669 6361 7465 2069  er certificate i
-00002580: 7473 656c 662e 2059 6f75 2063 616e 2067  tself. You can g
-00002590: 6574 2074 6865 5c6e 7365 7276 6572 2063  et the\nserver c
-000025a0: 6572 7469 6669 6361 7465 2077 6974 6820  ertificate with 
-000025b0: 7468 6520 666f 6c6c 6f77 696e 6720 5079  the following Py
-000025c0: 7468 6f6e 2063 6f64 652e 5c6e 5c6e 5c6e  thon code.\n\n\n
-000025d0: 6060 6070 7974 686f 6e5c 6e69 6d70 6f72  ```python\nimpor
-000025e0: 7420 7373 6c5c 6e5c 6e73 6572 7665 725f  t ssl\n\nserver_
-000025f0: 6365 7274 6966 6963 6174 6520 3d20 7373  certificate = ss
-00002600: 6c2e 6765 745f 7365 7276 6572 5f63 6572  l.get_server_cer
-00002610: 7469 6669 6361 7465 2861 6464 723d 285c  tificate(addr=(\
-00002620: 276c 6f63 616c 686f 7374 5c27 2c20 3231  'localhost\', 21
-00002630: 3133 2929 5c6e 6060 605c 6e5c 6e59 6f75  13))\n```\n\nYou
-00002640: 2063 616e 2061 6c73 6f20 7374 6172 7420   can also start 
-00002650: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
-00002660: 7276 6572 2075 7369 6e67 2074 6865 2066  rver using the f
-00002670: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
-00002680: 2e5c 6e5c 6e20 2020 2024 2064 6f63 6b65  .\n\n    $ docke
-00002690: 7220 7275 6e20 2d64 202d 2d6e 616d 6520  r run -d --name 
-000026a0: 6576 656e 7473 746f 7265 6462 2d69 6e73  eventstoredb-ins
-000026b0: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
-000026c0: 343a 3231 3133 2065 7665 6e74 7374 6f72  4:2113 eventstor
-000026d0: 652f 6576 656e 7473 746f 7265 3a32 312e  e/eventstore:21.
-000026e0: 3130 2e39 2d62 7573 7465 722d 736c 696d  10.9-buster-slim
-000026f0: 202d 2d69 6e73 6563 7572 655c 6e5c 6e54   --insecure\n\nT
-00002700: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00002710: 7269 6e67 2055 5249 2066 6f72 2074 6869  ring URI for thi
-00002720: 7320 2269 6e73 6563 7572 6522 2073 6572  s "insecure" ser
-00002730: 7665 7220 776f 756c 6420 6265 3a5c 6e5c  ver would be:\n\
-00002740: 6e20 2020 2065 7364 623a 2f2f 6c6f 6361  n    esdb://loca
-00002750: 6c68 6f73 743a 3231 3134 3f54 6c73 3d66  lhost:2114?Tls=f
-00002760: 616c 7365 5c6e 5c6e 4173 2077 6520 7769  alse\n\nAs we wi
-00002770: 6c6c 2073 6565 2c20 7768 656e 2063 6f6e  ll see, when con
-00002780: 6e65 6374 696e 6720 746f 2061 6e20 2269  necting to an "i
-00002790: 6e73 6563 7572 6522 2073 6572 7665 722c  nsecure" server,
-000027a0: 2074 6865 7265 2069 7320 6e6f 206e 6565   there is no nee
-000027b0: 6420 746f 2069 6e63 6c75 6465 5c6e 6120  d to include\na 
-000027c0: 2275 7365 726e 616d 6522 2061 6e64 2061  "username" and a
-000027d0: 2022 7061 7373 776f 7264 2220 696e 2074   "password" in t
-000027e0: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-000027f0: 7269 6e67 2e20 4966 2079 6f75 2064 6f2c  ring. If you do,
-00002800: 2074 6865 7365 2076 616c 7565 7320 7769   these values wi
-00002810: 6c6c 5c6e 6265 2069 676e 6f72 6564 2062  ll\nbe ignored b
-00002820: 7920 7468 6520 636c 6965 6e74 2c20 736f  y the client, so
-00002830: 2074 6861 7420 7468 6579 2077 696c 6c20   that they will 
-00002840: 6e6f 7420 6265 2073 656e 7420 746f 2074  not be sent to t
-00002850: 6865 2073 6572 7665 7220 6f76 6572 2061  he server over a
-00002860: 6e5c 6e69 6e73 6563 7572 6520 6368 616e  n\ninsecure chan
-00002870: 6e65 6c2e 5c6e 5c6e 506c 6561 7365 206e  nel.\n\nPlease n
-00002880: 6f74 652c 2074 6865 2022 696e 7365 6375  ote, the "insecu
-00002890: 7265 2220 636f 6e6e 6563 7469 6f6e 2073  re" connection s
-000028a0: 7472 696e 6720 7573 6573 2061 2071 7565  tring uses a que
-000028b0: 7279 2073 7472 696e 6720 7769 7468 2074  ry string with t
-000028c0: 6865 2066 6965 6c64 2d76 616c 7565 5c6e  he field-value\n
-000028d0: 6054 6c73 3d66 616c 7365 602e 2054 6865  `Tls=false`. The
-000028e0: 2076 616c 7565 206f 6620 7468 6973 2066   value of this f
-000028f0: 6965 6c64 2069 7320 6279 2064 6566 6175  ield is by defau
-00002900: 6c74 2060 7472 7565 602e 2053 6565 2074  lt `true`. See t
-00002910: 6865 204e 6f74 6573 2073 6563 7469 6f6e  he Notes section
-00002920: 2062 656c 6f77 5c6e 666f 7220 6d6f 7265   below\nfor more
-00002930: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
-00002940: 7574 2045 7665 6e74 5374 6f72 6544 4220  ut EventStoreDB 
-00002950: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00002960: 6773 2061 6e64 2074 6865 2066 6965 6c64  gs and the field
-00002970: 7320 7468 6174 2063 616e 2062 655c 6e75  s that can be\nu
-00002980: 7365 6420 696e 2074 6865 2071 7565 7279  sed in the query
-00002990: 2073 7472 696e 6720 746f 2073 7065 6369   string to speci
-000029a0: 6679 2063 6f6e 6e65 6374 696f 6e20 6f70  fy connection op
-000029b0: 7469 6f6e 732e 5c6e 5c6e 2323 2320 5374  tions.\n\n### St
-000029c0: 6f70 2063 6f6e 7461 696e 6572 5c6e 5c6e  op container\n\n
-000029d0: 546f 2073 746f 7020 616e 6420 7265 6d6f  To stop and remo
-000029e0: 7665 2074 6865 2022 7365 6375 7265 2220  ve the "secure" 
-000029f0: 636f 6e74 6169 6e65 722c 2075 7365 2074  container, use t
-00002a00: 6865 2066 6f6c 6c6f 7769 6e67 2044 6f63  he following Doc
-00002a10: 6b65 7220 636f 6d6d 616e 6473 2e5c 6e5c  ker commands.\n\
-00002a20: 6e20 2020 2024 2064 6f63 6b65 7220 7374  n    $ docker st
-00002a30: 6f70 2065 7665 6e74 7374 6f72 6564 622d  op eventstoredb-
-00002a40: 7365 6375 7265 5c6e 5c74 2420 646f 636b  secure\n\t$ dock
-00002a50: 6572 2072 6d20 6576 656e 7473 746f 7265  er rm eventstore
-00002a60: 6462 2d73 6563 7572 655c 6e5c 6e54 6f20  db-secure\n\nTo 
-00002a70: 7374 6f70 2061 6e64 2072 656d 6f76 6520  stop and remove 
-00002a80: 7468 6520 2269 6e73 6563 7572 6522 2063  the "insecure" c
-00002a90: 6f6e 7461 696e 6572 2c20 7573 6520 7468  ontainer, use th
-00002aa0: 6520 666f 6c6c 6f77 696e 6720 446f 636b  e following Dock
-00002ab0: 6572 2063 6f6d 6d61 6e64 732e 5c6e 5c6e  er commands.\n\n
-00002ac0: 2020 2020 2420 646f 636b 6572 2073 746f      $ docker sto
-00002ad0: 7020 6576 656e 7473 746f 7265 6462 2d69  p eventstoredb-i
-00002ae0: 6e73 6563 7572 655c 6e5c 7424 2064 6f63  nsecure\n\t$ doc
-00002af0: 6b65 7220 726d 2065 7665 6e74 7374 6f72  ker rm eventstor
-00002b00: 6564 622d 696e 7365 6375 7265 5c6e 5c6e  edb-insecure\n\n
-00002b10: 5c6e 2323 2045 7665 6e74 5374 6f72 6544  \n## EventStoreD
-00002b20: 4220 636c 6965 6e74 5c6e 5c6e 5468 6973  B client\n\nThis
-00002b30: 2045 7665 6e74 5374 6f72 6544 4220 636c   EventStoreDB cl
-00002b40: 6965 6e74 2069 7320 696d 706c 656d 656e  ient is implemen
-00002b50: 7465 6420 696e 2074 6865 2060 6573 6462  ted in the `esdb
-00002b60: 636c 6965 6e74 6020 7061 636b 6167 6520  client` package 
-00002b70: 7769 7468 5c6e 7468 6520 6045 5344 4243  with\nthe `ESDBC
-00002b80: 6c69 656e 7460 2063 6c61 7373 2e5c 6e5c  lient` class.\n\
-00002b90: 6e23 2323 2049 6d70 6f72 7420 636c 6173  n### Import clas
-00002ba0: 735c 6e5c 6e54 6865 2060 4553 4442 436c  s\n\nThe `ESDBCl
-00002bb0: 6965 6e74 6020 636c 6173 7320 6361 6e20  ient` class can 
-00002bc0: 6265 2069 6d70 6f72 7465 6420 6672 6f6d  be imported from
-00002bd0: 2074 6865 2060 6573 6462 636c 6965 6e74   the `esdbclient
-00002be0: 6020 7061 636b 6167 652e 5c6e 5c6e 6060  ` package.\n\n``
-00002bf0: 6070 7974 686f 6e5c 6e66 726f 6d20 6573  `python\nfrom es
-00002c00: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
-00002c10: 4553 4442 436c 6965 6e74 5c6e 6060 605c  ESDBClient\n```\
-00002c20: 6e5c 6e23 2323 2043 6f6e 7374 7275 6374  n\n### Construct
-00002c30: 2063 6c69 656e 745c 6e5c 6e54 6865 2060   client\n\nThe `
-00002c40: 4553 4442 436c 6965 6e74 6020 636c 6173  ESDBClient` clas
-00002c50: 7320 6361 6e20 6265 2063 6f6e 7374 7275  s can be constru
-00002c60: 6374 6564 2077 6974 6820 6120 6075 7269  cted with a `uri
-00002c70: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-00002c80: 6820 6973 2072 6571 7569 7265 642e 5c6e  h is required.\n
-00002c90: 416e 642c 2074 6f20 636f 6e6e 6563 7420  And, to connect 
-00002ca0: 746f 2061 2022 7365 6375 7265 2220 4576  to a "secure" Ev
-00002cb0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00002cc0: 722c 2074 6865 206f 7074 696f 6e61 6c20  r, the optional 
-00002cd0: 6072 6f6f 745f 6365 7274 6966 6963 6174  `root_certificat
-00002ce0: 6573 605c 6e61 7267 756d 656e 7420 6973  es`\nargument is
-00002cf0: 2061 6c73 6f20 7265 7175 6972 6564 2e5c   also required.\
-00002d00: 6e5c 6e54 6865 2060 7572 6960 2061 7267  n\nThe `uri` arg
-00002d10: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
-00002d20: 6420 746f 2062 6520 616e 2045 7665 6e74  d to be an Event
-00002d30: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
-00002d40: 6f6e 2073 7472 696e 6720 5552 4920 7468  on string URI th
-00002d50: 6174 5c6e 636f 6e66 6f72 6d73 2077 6974  at\nconforms wit
-00002d60: 6820 7468 6520 7374 616e 6461 7264 2045  h the standard E
-00002d70: 7665 6e74 5374 6f72 6544 4220 2265 7364  ventStoreDB "esd
-00002d80: 6222 206f 7220 2265 7364 622b 6469 7363  b" or "esdb+disc
-00002d90: 6f76 6572 2220 5552 4920 7363 6865 6d65  over" URI scheme
-00002da0: 732e 2054 6865 5c6e 7379 6e74 6178 2061  s. The\nsyntax a
-00002db0: 6e64 2073 656d 616e 7469 6373 206f 6620  nd semantics of 
-00002dc0: 4576 656e 7453 746f 7265 4442 2063 6f6e  EventStoreDB con
-00002dd0: 6e65 6374 696f 6e20 7374 7269 6e67 7320  nection strings 
-00002de0: 6172 6520 6578 706c 6169 6e65 6420 696e  are explained in
-00002df0: 2074 6865 204e 6f74 6573 5c6e 7365 6374   the Notes\nsect
-00002e00: 696f 6e20 6265 6c6f 772e 5c6e 5c6e 466f  ion below.\n\nFo
-00002e10: 7220 6578 616d 706c 652c 2074 6865 2066  r example, the f
-00002e20: 6f6c 6c6f 7769 6e67 2063 6f6e 6e65 6374  ollowing connect
-00002e30: 696f 6e20 7374 7269 6e67 2073 7065 6369  ion string speci
-00002e40: 6669 6573 2074 6861 7420 7468 6520 636c  fies that the cl
-00002e50: 6965 6e74 2073 686f 756c 645c 6e61 7474  ient should\natt
-00002e60: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
-00002e70: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
-00002e80: 7469 6f6e 2074 6f20 706f 7274 2032 3131  tion to port 211
-00002e90: 3320 6f6e 2022 6c6f 6361 6c68 6f73 7422  3 on "localhost"
-00002ea0: 2c20 616e 6420 7573 6520 7468 655c 6e63  , and use the\nc
-00002eb0: 6c69 656e 7420 6372 6564 656e 7469 616c  lient credential
-00002ec0: 7320 2275 7365 726e 616d 6522 2061 6e64  s "username" and
-00002ed0: 2022 7061 7373 776f 7264 2220 7768 656e   "password" when
-00002ee0: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
-00002ef0: 2074 6865 2073 6572 7665 722e 5c6e 5c6e   the server.\n\n
-00002f00: 2020 2020 6573 6462 3a2f 2f75 7365 726e      esdb://usern
-00002f10: 616d 653a 7061 7373 776f 7264 406c 6f63  ame:password@loc
-00002f20: 616c 686f 7374 3a32 3131 333f 546c 733d  alhost:2113?Tls=
-00002f30: 7472 7565 5c6e 5c6e 5468 6520 636c 6965  true\n\nThe clie
-00002f40: 6e74 206d 7573 7420 6265 2063 6f6e 6669  nt must be confi
-00002f50: 6775 7265 6420 746f 2063 7265 6174 6520  gured to create 
-00002f60: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
-00002f70: 6374 696f 6e20 746f 2061 2022 7365 6375  ction to a "secu
-00002f80: 7265 2220 7365 7276 6572 2c5c 6e6f 7220  re" server,\nor 
-00002f90: 616c 7465 726e 6174 6976 656c 7920 616e  alternatively an
-00002fa0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
-00002fb0: 6563 7469 6f6e 2074 6f20 616e 2022 696e  ection to an "in
-00002fc0: 7365 6375 7265 2220 7365 7276 6572 2e20  secure" server. 
-00002fd0: 4279 2064 6566 6175 6c74 2c20 7468 655c  By default, the\
-00002fe0: 6e63 6c69 656e 7420 7769 6c6c 2061 7474  nclient will att
-00002ff0: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
-00003000: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
-00003010: 7469 6f6e 2e20 416e 6420 736f 2c20 7768  tion. And so, wh
-00003020: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
-00003030: 2061 6e5c 6e22 696e 7365 6375 7265 2220   an\n"insecure" 
-00003040: 7365 7276 6572 2c20 7468 6520 636f 6e6e  server, the conn
-00003050: 6563 7469 6f6e 2073 7472 696e 6720 6d75  ection string mu
-00003060: 7374 2073 7065 6369 6679 2074 6861 7420  st specify that 
-00003070: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
-00003080: 6420 6174 7465 6d70 745c 6e74 6f20 6d61  d attempt\nto ma
-00003090: 6b65 2061 6e20 2269 6e73 6563 7572 6522  ke an "insecure"
-000030a0: 2063 6f6e 6e65 6374 696f 6e2e 5c6e 5c6e   connection.\n\n
-000030b0: 5468 6520 666f 6c6c 6f77 696e 6720 636f  The following co
-000030c0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
-000030d0: 7370 6563 6966 6965 7320 7468 6174 2074  specifies that t
-000030e0: 6865 2063 6c69 656e 7420 7368 6f75 6c64  he client should
-000030f0: 5c6e 6174 7465 6d70 7420 746f 2063 7265  \nattempt to cre
-00003100: 6174 6520 616e 2022 696e 7365 6375 7265  ate an "insecure
-00003110: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
-00003120: 706f 7274 2032 3131 3420 6f6e 2022 6c6f  port 2114 on "lo
-00003130: 6361 6c68 6f73 7422 2e5c 6e57 6865 6e20  calhost".\nWhen 
-00003140: 636f 6e6e 6563 7469 6e67 2074 6f20 616e  connecting to an
-00003150: 2022 696e 7365 6375 7265 2220 7365 7276   "insecure" serv
-00003160: 6572 2c20 7468 6520 636c 6965 6e74 2077  er, the client w
-00003170: 696c 6c20 6967 6e6f 7265 2061 6e79 5c6e  ill ignore any\n
-00003180: 7573 6572 6e61 6d65 2061 6e64 2070 6173  username and pas
-00003190: 7377 6f72 6420 696e 666f 726d 6174 696f  sword informatio
-000031a0: 6e20 696e 636c 7564 6564 2069 6e20 7468  n included in th
-000031b0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-000031c0: 696e 672c 5c6e 736f 2074 6861 7420 7573  ing,\nso that us
-000031d0: 6572 6e61 6d65 7320 616e 6420 7061 7373  ernames and pass
-000031e0: 776f 7264 7320 6172 6520 6e6f 7420 7365  words are not se
-000031f0: 6e74 206f 7665 7220 616e 2022 696e 7365  nt over an "inse
-00003200: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
-00003210: 2e5c 6e5c 6e20 2020 2065 7364 623a 2f2f  .\n\n    esdb://
-00003220: 6c6f 6361 6c68 6f73 743a 3231 3134 3f54  localhost:2114?T
-00003230: 6c73 3d66 616c 7365 5c6e 5c6e 506c 6561  ls=false\n\nPlea
-00003240: 7365 206e 6f74 652c 2074 6865 2022 696e  se note, the "in
-00003250: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-00003260: 6f6e 2073 7472 696e 6720 7573 6573 2061  on string uses a
-00003270: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
-00003280: 7468 2074 6865 2066 6965 6c64 2d76 616c  th the field-val
-00003290: 7565 5c6e 6054 6c73 3d66 616c 7365 602e  ue\n`Tls=false`.
-000032a0: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
-000032b0: 6973 2066 6965 6c64 2069 7320 6279 2064  is field is by d
-000032c0: 6566 6175 6c74 2060 7472 7565 602e 2055  efault `true`. U
-000032d0: 6e6c 6573 7320 7468 6520 636f 6e6e 6563  nless the connec
-000032e0: 7469 6f6e 2073 7472 696e 675c 6e55 5249  tion string\nURI
-000032f0: 2069 6e63 6c75 6465 7320 7468 6520 6669   includes the fi
-00003300: 656c 642d 7661 6c75 6520 6054 6c73 3d66  eld-value `Tls=f
-00003310: 616c 7365 6020 696e 2074 6865 2071 7565  alse` in the que
-00003320: 7279 2073 7472 696e 672c 2074 6865 2060  ry string, the `
-00003330: 726f 6f74 5f63 6572 7469 6669 6361 7465  root_certificate
-00003340: 7360 5c6e 636f 6e73 7472 7563 746f 7220  s`\nconstructor 
-00003350: 6172 6775 6d65 6e74 2069 7320 616c 736f  argument is also
-00003360: 2072 6571 7569 7265 642e 5c6e 5c6e 5768   required.\n\nWh
-00003370: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
-00003380: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
-00003390: 6572 2c20 7468 6520 6072 6f6f 745f 6365  er, the `root_ce
-000033a0: 7274 6966 6963 6174 6573 6020 6172 6775  rtificates` argu
-000033b0: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
-000033c0: 2074 6f5c 6e62 6520 6120 5079 7468 6f6e   to\nbe a Python
-000033d0: 2060 7374 7260 2063 6f6e 7461 696e 696e   `str` containin
-000033e0: 6720 5045 4d20 656e 636f 6465 6420 5353  g PEM encoded SS
-000033f0: 4c2f 544c 5320 726f 6f74 2063 6572 7469  L/TLS root certi
-00003400: 6669 6361 7465 732e 2054 6869 7320 7661  ficates. This va
-00003410: 6c75 6520 6973 5c6e 7061 7373 6564 2064  lue is\npassed d
-00003420: 6972 6563 746c 7920 746f 2060 6772 7063  irectly to `grpc
-00003430: 2e73 736c 5f63 6861 6e6e 656c 5f63 7265  .ssl_channel_cre
-00003440: 6465 6e74 6961 6c73 2829 602e 2049 7420  dentials()`. It 
-00003450: 6973 2075 7365 6420 666f 7220 6175 7468  is used for auth
-00003460: 656e 7469 6361 7469 6e67 2074 6865 5c6e  enticating the\n
-00003470: 7365 7276 6572 2074 6f20 7468 6520 636c  server to the cl
-00003480: 6965 6e74 2e20 4974 2069 7320 636f 6d6d  ient. It is comm
-00003490: 6f6e 6c79 2074 6865 2063 6572 7469 6669  only the certifi
-000034a0: 6361 7465 206f 6620 7468 6520 6365 7274  cate of the cert
-000034b0: 6966 6963 6174 6520 6175 7468 6f72 6974  ificate authorit
-000034c0: 7920 7468 6174 5c6e 7761 7320 7265 7370  y that\nwas resp
-000034d0: 6f6e 7369 626c 6520 666f 7220 6765 6e65  onsible for gene
-000034e0: 7261 7469 6e67 2074 6865 2053 534c 2f54  rating the SSL/T
-000034f0: 4c53 2063 6572 7469 6669 6361 7465 2075  LS certificate u
-00003500: 7365 6420 6279 2074 6865 2045 7665 6e74  sed by the Event
-00003510: 5374 6f72 6544 4220 7365 7276 6572 2e5c  StoreDB server.\
-00003520: 6e42 7574 2c20 616c 7465 726e 6174 6976  nBut, alternativ
-00003530: 656c 7920 666f 7220 6465 7665 6c6f 706d  ely for developm
-00003540: 656e 742c 2079 6f75 2063 616e 2075 7365  ent, you can use
-00003550: 2074 6865 2073 6572 7665 725c 2773 2063   the server\'s c
-00003560: 6572 7469 6669 6361 7465 2069 7473 656c  ertificate itsel
-00003570: 662e 5c6e 5c6e 496e 2074 6865 2065 7861  f.\n\nIn the exa
-00003580: 6d70 6c65 2062 656c 6f77 2c20 7468 6520  mple below, the 
-00003590: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
-000035a0: 6d65 6e74 2076 616c 7565 7320 6172 6520  ment values are 
-000035b0: 7461 6b65 6e20 6672 6f6d 2074 6865 206f  taken from the o
-000035c0: 7065 7261 7469 6e67 5c6e 7379 7374 656d  perating\nsystem
-000035d0: 2065 6e76 6972 6f6e 6d65 6e74 2e20 5468   environment. Th
-000035e0: 6973 2069 7320 6120 7479 7069 6361 6c20  is is a typical 
-000035f0: 6172 7261 6e67 656d 656e 7420 696e 2061  arrangement in a
-00003600: 2070 726f 6475 6374 696f 6e20 656e 7669   production envi
-00003610: 726f 6e6d 656e 742e 2049 7420 6973 5c6e  ronment. It is\n
-00003620: 646f 6e65 2074 6869 7320 7761 7920 6865  done this way he
-00003630: 7265 2073 6f20 7468 6174 2074 6865 2063  re so that the c
-00003640: 6f64 6520 696e 2074 6869 7320 646f 6375  ode in this docu
-00003650: 6d65 6e74 6174 696f 6e20 6361 6e20 6265  mentation can be
-00003660: 2074 6573 7465 6420 7769 7468 2062 6f74   tested with bot
-00003670: 685c 6e61 2022 7365 6375 7265 2220 616e  h\na "secure" an
-00003680: 6420 616e 2022 696e 7365 6375 7265 2220  d an "insecure" 
-00003690: 7365 7276 6572 2e5c 6e5c 6e60 6060 7079  server.\n\n```py
-000036a0: 7468 6f6e 5c6e 696d 706f 7274 206f 735c  thon\nimport os\
-000036b0: 6e5c 6e63 6c69 656e 7420 3d20 4553 4442  n\nclient = ESDB
-000036c0: 436c 6965 6e74 285c 6e20 2020 2075 7269  Client(\n    uri
-000036d0: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
-000036e0: 5f55 5249 2229 2c5c 6e20 2020 2072 6f6f  _URI"),\n    roo
-000036f0: 745f 6365 7274 6966 6963 6174 6573 3d6f  t_certificates=o
-00003700: 732e 6765 7465 6e76 2822 4553 4442 5f52  s.getenv("ESDB_R
-00003710: 4f4f 545f 4345 5254 4946 4943 4154 4553  OOT_CERTIFICATES
-00003720: 2229 2c5c 6e29 5c6e 6060 605c 6e5c 6e53  "),\n)\n```\n\nS
-00003730: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
-00003740: 7469 6f6e 2062 656c 6f77 2066 6f72 2064  tion below for d
-00003750: 6574 6169 6c65 6420 696e 666f 726d 6174  etailed informat
-00003760: 696f 6e20 6162 6f75 7420 4576 656e 7453  ion about EventS
-00003770: 746f 7265 4442 2063 6f6e 6e65 6374 696f  toreDB connectio
-00003780: 6e5c 6e73 7472 696e 6773 2061 6e64 2074  n\nstrings and t
-00003790: 6865 2066 6965 6c64 7320 7468 6174 2063  he fields that c
-000037a0: 616e 2062 6520 7573 6564 2069 6e20 7468  an be used in th
-000037b0: 6520 7175 6572 7920 7374 7269 6e67 2074  e query string t
-000037c0: 6f20 7370 6563 6966 7920 636f 6e6e 6563  o specify connec
-000037d0: 7469 6f6e 5c6e 6f70 7469 6f6e 732e 5c6e  tion\noptions.\n
-000037e0: 5c6e 2323 2053 7472 6561 6d73 5c6e 5c6e  \n## Streams\n\n
-000037f0: 496e 2045 7665 6e74 5374 6f72 6544 422c  In EventStoreDB,
-00003800: 2061 2022 7374 7265 616d 2220 6973 2061   a "stream" is a
-00003810: 2073 6571 7565 6e63 6520 6f66 2072 6563   sequence of rec
-00003820: 6f72 6465 6420 6576 656e 7473 2074 6861  orded events tha
-00003830: 7420 616c 6c20 6861 7665 5c6e 7468 6520  t all have\nthe 
-00003840: 7361 6d65 2022 7374 7265 616d 206e 616d  same "stream nam
-00003850: 6522 2e20 5468 6572 6520 7769 6c6c 206e  e". There will n
-00003860: 6f72 6d61 6c6c 7920 6265 206d 616e 7920  ormally be many 
-00003870: 7374 7265 616d 7320 696e 2061 2064 6174  streams in a dat
-00003880: 6162 6173 652e 5c6e 4561 6368 2072 6563  abase.\nEach rec
-00003890: 6f72 6465 6420 6576 656e 7420 6861 7320  orded event has 
-000038a0: 6120 2273 7472 6561 6d20 706f 7369 7469  a "stream positi
-000038b0: 6f6e 2220 696e 2069 7473 2073 7472 6561  on" in its strea
-000038c0: 6d2c 2061 6e64 2061 2022 636f 6d6d 6974  m, and a "commit
-000038d0: 2070 6f73 6974 696f 6e22 5c6e 696e 2074   position"\nin t
-000038e0: 6865 2064 6174 6162 6173 652e 2054 6865  he database. The
-000038f0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00003900: 7320 6f66 2074 6865 2072 6563 6f72 6465  s of the recorde
-00003910: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
-00003920: 7265 616d 2069 7320 6120 6761 706c 6573  ream is a gaples
-00003930: 735c 6e73 6571 7565 6e63 6520 7374 6172  s\nsequence star
-00003940: 7469 6e67 2066 726f 6d20 7a65 726f 2e20  ting from zero. 
-00003950: 5468 6520 636f 6d6d 6974 2070 6f73 6974  The commit posit
-00003960: 696f 6e73 206f 6620 7468 6520 7265 636f  ions of the reco
-00003970: 7264 6564 2065 7665 6e74 7320 696e 2074  rded events in t
-00003980: 6865 2064 6174 6162 6173 655c 6e66 6f72  he database\nfor
-00003990: 6d20 6120 7365 7175 656e 6365 2074 6861  m a sequence tha
-000039a0: 7420 6973 206e 6f74 2067 6170 6c65 7373  t is not gapless
-000039b0: 2e5c 6e5c 6e54 6865 206d 6574 686f 6473  .\n\nThe methods
-000039c0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
-000039d0: 2960 2c20 6072 6561 645f 7374 7265 616d  )`, `read_stream
-000039e0: 5f65 7665 6e74 7328 2960 2061 6e64 2060  _events()` and `
-000039f0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-00003a00: 2960 2063 616e 5c6e 6265 2075 7365 6420  )` can\nbe used 
-00003a10: 746f 2072 6563 6f72 6420 616e 6420 7265  to record and re
-00003a20: 6164 2065 7665 6e74 7320 696e 2074 6865  ad events in the
-00003a30: 2064 6174 6162 6173 652e 5c6e 5c6e 2323   database.\n\n##
-00003a40: 2320 4170 7065 6e64 2065 7665 6e74 735c  # Append events\
-00003a50: 6e5c 6e2a 7265 7175 6972 6573 206c 6561  n\n*requires lea
-00003a60: 6465 722a 5c6e 5c6e 5468 6520 6061 7070  der*\n\nThe `app
-00003a70: 656e 645f 6576 656e 7473 2829 6020 6d65  end_events()` me
-00003a80: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00003a90: 2074 6f20 7772 6974 6520 6120 7365 7175   to write a sequ
-00003aa0: 656e 6365 206f 6620 6e65 7720 6576 656e  ence of new even
-00003ab0: 7473 2061 746f 6d69 6361 6c6c 795c 6e74  ts atomically\nt
-00003ac0: 6f20 6120 2273 7472 6561 6d22 2e20 5772  o a "stream". Wr
-00003ad0: 6974 696e 6720 6e65 7720 6576 656e 7473  iting new events
-00003ae0: 2065 6974 6865 7220 6372 6561 7465 7320   either creates 
-00003af0: 6120 7374 7265 616d 2c20 6f72 2061 7070  a stream, or app
-00003b00: 656e 6473 2065 7665 6e74 7320 746f 2074  ends events to t
-00003b10: 6865 2065 6e64 5c6e 6f66 2061 2073 7472  he end\nof a str
-00003b20: 6561 6d2e 2054 6869 7320 6d65 7468 6f64  eam. This method
-00003b30: 2069 7320 6964 656d 706f 7465 6e74 2e5c   is idempotent.\
-00003b40: 6e5c 6e54 6869 7320 6d65 7468 6f64 2063  n\nThis method c
-00003b50: 616e 2062 6520 7573 6564 2074 6f20 7265  an be used to re
-00003b60: 636f 7264 2061 746f 6d69 6361 6c6c 7920  cord atomically 
-00003b70: 616c 6c20 7468 6520 6e65 775c 6e65 7665  all the new\neve
-00003b80: 6e74 7320 7468 6174 2061 7265 2067 656e  nts that are gen
-00003b90: 6572 6174 6564 2077 6865 6e20 6578 6563  erated when exec
-00003ba0: 7574 696e 6720 6120 636f 6d6d 616e 6420  uting a command 
-00003bb0: 696e 2061 6e20 6170 706c 6963 6174 696f  in an applicatio
-00003bc0: 6e2e 5c6e 5c6e 5468 7265 6520 6172 6775  n.\n\nThree argu
-00003bd0: 6d65 6e74 7320 6172 6520 7265 7175 6972  ments are requir
-00003be0: 6564 2c20 6073 7472 6561 6d5f 6e61 6d65  ed, `stream_name
-00003bf0: 602c 2060 6578 7065 6374 6564 5f70 6f73  `, `expected_pos
-00003c00: 6974 696f 6e60 5c6e 616e 6420 6065 7665  ition`\nand `eve
-00003c10: 6e74 7360 2e5c 6e5c 6e54 6865 2060 7374  nts`.\n\nThe `st
-00003c20: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-00003c30: 656e 7420 6973 2072 6571 7569 7265 642c  ent is required,
-00003c40: 2061 6e64 2069 7320 6578 7065 6374 6564   and is expected
-00003c50: 2074 6f20 6265 2061 2050 7974 686f 6e5c   to be a Python\
-00003c60: 6e60 7374 7260 2074 6861 7420 756e 6971  n`str` that uniq
-00003c70: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
-00003c80: 7468 6520 7374 7265 616d 2069 6e20 7468  the stream in th
-00003c90: 6520 6461 7461 6261 7365 2e5c 6e5c 6e54  e database.\n\nT
-00003ca0: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003cb0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
-00003cc0: 6973 2072 6571 7569 7265 642c 2069 7320  is required, is 
-00003cd0: 6578 7065 6374 6564 2074 6f20 6265 3a20  expected to be: 
-00003ce0: 604e 6f6e 6560 5c6e 6966 2065 7665 6e74  `None`\nif event
-00003cf0: 7320 6172 6520 6265 696e 6720 7772 6974  s are being writ
-00003d00: 7465 6e20 746f 2061 206e 6577 2073 7472  ten to a new str
-00003d10: 6561 6d2c 2061 6e64 206f 7468 6572 7769  eam, and otherwi
-00003d20: 7365 2061 6e20 5079 7468 6f6e 2060 696e  se an Python `in
-00003d30: 7460 5c6e 6571 7561 6c20 746f 2074 6865  t`\nequal to the
-00003d40: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-00003d50: 2073 7472 6561 6d20 6f66 2074 6865 206c   stream of the l
-00003d60: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-00003d70: 6e74 2069 6e20 7468 6520 7374 7265 616d  nt in the stream
-00003d80: 2e5c 6e5c 6e54 6865 2060 6576 656e 7473  .\n\nThe `events
-00003d90: 6020 6172 6775 6d65 6e74 2069 7320 7265  ` argument is re
-00003da0: 7175 6972 6564 2c20 616e 6420 6973 2065  quired, and is e
-00003db0: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-00003dc0: 7365 7175 656e 6365 206f 6620 6e65 775c  sequence of new\
-00003dd0: 6e65 7665 6e74 206f 626a 6563 7473 2074  nevent objects t
-00003de0: 6f20 6265 2061 7070 656e 6465 6420 746f  o be appended to
-00003df0: 2074 6865 206e 616d 6564 2073 7472 6561   the named strea
-00003e00: 6d2e 2054 6865 2060 4e65 7745 7665 6e74  m. The `NewEvent
-00003e10: 6020 636c 6173 7320 7368 6f75 6c64 5c6e  ` class should\n
-00003e20: 6265 2075 7365 6420 746f 2063 6f6e 7374  be used to const
-00003e30: 7275 6374 206e 6577 2065 7665 6e74 206f  ruct new event o
-00003e40: 626a 6563 7473 2028 7365 6520 7468 6520  bjects (see the 
-00003e50: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-00003e60: 6c6f 7720 666f 7220 6465 7461 696c 735c  low for details\
-00003e70: 6e6f 6620 7468 6973 2063 6c61 7373 292e  nof this class).
-00003e80: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00003e90: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
-00003ea0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
-00003eb0: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
-00003ec0: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-00003ed0: 7468 6174 2073 6574 735c 6e61 2064 6561  that sets\na dea
-00003ee0: 646c 696e 6520 666f 7220 7468 6520 636f  dline for the co
-00003ef0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-00003f00: 6752 5043 206f 7065 7261 7469 6f6e 2e5c  gRPC operation.\
-00003f10: 6e5c 6e53 7472 6561 6d73 2061 7265 2063  n\nStreams are c
-00003f20: 7265 6174 6564 2062 7920 7772 6974 696e  reated by writin
-00003f30: 6720 6576 656e 7473 2e20 5468 6520 636f  g events. The co
-00003f40: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
-00003f50: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003f60: 6974 696f 6e60 5c6e 6172 6775 6d65 6e74  ition`\nargument
-00003f70: 2077 6865 6e20 7772 6974 696e 6720 7468   when writing th
-00003f80: 6520 6669 7273 7420 6576 656e 7420 6f66  e first event of
-00003f90: 2061 206e 6577 2073 7472 6561 6d20 6973   a new stream is
-00003fa0: 2060 4e6f 6e65 602e 2050 6c65 6173 6520   `None`. Please 
-00003fb0: 6e6f 7465 2c20 6974 2069 735c 6e6e 6f74  note, it is\nnot
-00003fc0: 2070 6f73 7369 626c 6520 746f 2073 6f6d   possible to som
-00003fd0: 6568 6f77 2063 7265 6174 6520 616e 2022  ehow create an "
-00003fe0: 656d 7074 7922 2073 7472 6561 6d20 696e  empty" stream in
-00003ff0: 2045 7665 6e74 5374 6f72 6544 422e 5c6e   EventStoreDB.\n
-00004000: 5c6e 5468 6520 7374 7265 616d 2070 6f73  \nThe stream pos
-00004010: 6974 696f 6e73 206f 6620 7265 636f 7264  itions of record
-00004020: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
-00004030: 7472 6561 6d20 7374 6172 7420 6672 6f6d  tream start from
-00004040: 207a 6572 6f2c 2061 6e64 2066 6f72 6d20   zero, and form 
-00004050: 6120 6761 706c 6573 735c 6e73 6571 7565  a gapless\nseque
-00004060: 6e63 6520 6f66 2069 6e74 6567 6572 732e  nce of integers.
-00004070: 2054 6865 2073 7472 6561 6d20 706f 7369   The stream posi
-00004080: 7469 6f6e 206f 6620 7468 6520 6669 7273  tion of the firs
-00004090: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-000040a0: 2069 6e20 6120 7374 7265 616d 2069 735c   in a stream is\
-000040b0: 6e60 3060 2e20 416e 6420 736f 2077 6865  n`0`. And so whe
-000040c0: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
-000040d0: 7365 636f 6e64 206e 6577 2065 7665 6e74  second new event
-000040e0: 2074 6f20 6120 7374 7265 616d 2074 6861   to a stream tha
-000040f0: 7420 6861 7320 6f6e 6520 7265 636f 7264  t has one record
-00004100: 6564 2065 7665 6e74 2c5c 6e74 6865 2063  ed event,\nthe c
-00004110: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
-00004120: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-00004130: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00004140: 2069 7320 6030 602e 2053 696d 696c 6172   is `0`. Similar
-00004150: 6c79 2c20 7468 6520 7374 7265 616d 5c6e  ly, the stream\n
-00004160: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
-00004170: 7365 636f 6e64 2072 6563 6f72 6465 6420  second recorded 
-00004180: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
-00004190: 6d20 6973 2060 3160 2c20 616e 6420 736f  m is `1`, and so
-000041a0: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
-000041b0: 7468 655c 6e74 6869 7264 206e 6577 2065  the\nthird new e
-000041c0: 7665 6e74 2074 6f20 6120 7374 7265 616d  vent to a stream
-000041d0: 2074 6861 7420 6861 7320 7477 6f20 7265   that has two re
-000041e0: 636f 7264 6564 2065 7665 6e74 732c 2074  corded events, t
-000041f0: 6865 2063 6f72 7265 6374 2076 616c 7565  he correct value
-00004200: 206f 6620 7468 655c 6e60 6578 7065 6374   of the\n`expect
-00004210: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
-00004220: 756d 656e 7420 6973 2060 3160 2e20 416e  ument is `1`. An
-00004230: 6420 736f 206f 6e2e 2e2e 5c6e 5c6e 4966  d so on...\n\nIf
-00004240: 2074 6865 7265 2069 7320 6120 6d69 736d   there is a mism
-00004250: 6174 6368 2062 6574 7765 656e 2074 6865  atch between the
-00004260: 2067 6976 656e 2076 616c 7565 206f 6620   given value of 
-00004270: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-00004280: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00004290: 5c6e 616e 6420 7468 6520 706f 7369 7469  \nand the positi
-000042a0: 6f6e 206f 6620 7468 6520 6c61 7374 2072  on of the last r
-000042b0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
-000042c0: 2061 2073 7472 6561 6d2c 2074 6865 6e20   a stream, then 
-000042d0: 616e 2060 4578 7065 6374 6564 506f 7369  an `ExpectedPosi
-000042e0: 7469 6f6e 4572 726f 7260 5c6e 6578 6365  tionError`\nexce
-000042f0: 7074 696f 6e20 7769 6c6c 2062 6520 7261  ption will be ra
-00004300: 6973 6564 2e20 5468 6973 2065 6666 6563  ised. This effec
-00004310: 7469 7665 6c79 2061 6363 6f6d 706c 6973  tively accomplis
-00004320: 6865 7320 6f70 7469 6d69 7374 6963 2063  hes optimistic c
-00004330: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
-00004340: 6f6c 2e5c 6e5c 6e49 6620 796f 7520 7769  ol.\n\nIf you wi
-00004350: 7368 2074 6f20 6469 7361 626c 6520 6f70  sh to disable op
-00004360: 7469 6d69 7374 6963 2063 6f6e 6375 7272  timistic concurr
-00004370: 656e 6379 2063 6f6e 7472 6f6c 2077 6865  ency control whe
-00004380: 6e20 6170 7065 6e64 696e 6720 6e65 7720  n appending new 
-00004390: 6576 656e 7473 2c20 796f 755c 6e63 616e  events, you\ncan
-000043a0: 2073 6574 2074 6865 2060 6578 7065 6374   set the `expect
-000043b0: 6564 5f70 6f73 6974 696f 6e60 2074 6f20  ed_position` to 
-000043c0: 6120 6e65 6761 7469 7665 2069 6e74 6567  a negative integ
-000043d0: 6572 2e5c 6e5c 6e49 6620 796f 7520 6e65  er.\n\nIf you ne
-000043e0: 6564 2074 6f20 6469 7363 6f76 6572 2074  ed to discover t
-000043f0: 6865 2063 7572 7265 6e74 2070 6f73 6974  he current posit
-00004400: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
-00004410: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
-00004420: 6e20 6120 7374 7265 616d 2c5c 6e79 6f75  n a stream,\nyou
-00004430: 2063 616e 2075 7365 2074 6865 2060 6765   can use the `ge
-00004440: 745f 7374 7265 616d 5f70 6f73 6974 696f  t_stream_positio
-00004450: 6e28 2960 206d 6574 686f 642e 5c6e 5c6e  n()` method.\n\n
-00004460: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-00004470: 2061 7070 656e 6420 6576 656e 7473 206f   append events o
-00004480: 7065 7261 7469 6f6e 2069 7320 6174 6f6d  peration is atom
-00004490: 6963 2c20 736f 2074 6861 7420 6569 7468  ic, so that eith
-000044a0: 6572 2061 6c6c 5c6e 6f72 206e 6f6e 6520  er all\nor none 
-000044b0: 6f66 2074 6865 2067 6976 656e 206e 6577  of the given new
-000044c0: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-000044d0: 7265 636f 7264 6564 2e20 4279 2064 6573  recorded. By des
-000044e0: 6967 6e2c 2069 7420 6973 206f 6e6c 795c  ign, it is only\
-000044f0: 6e70 6f73 7369 626c 6520 7769 7468 2045  npossible with E
-00004500: 7665 6e74 5374 6f72 6544 4220 746f 2061  ventStoreDB to a
-00004510: 746f 6d69 6361 6c6c 7920 7265 636f 7264  tomically record
-00004520: 206e 6577 2065 7665 6e74 7320 696e 206f   new events in o
-00004530: 6e65 2073 7472 6561 6d2e 5c6e 5c6e 496e  ne stream.\n\nIn
-00004540: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
-00004550: 6f77 2c20 6120 6e65 7720 6576 656e 7420  ow, a new event 
-00004560: 6973 2061 7070 656e 6465 6420 746f 2061  is appended to a
-00004570: 206e 6577 2073 7472 6561 6d2e 5c6e 5c6e   new stream.\n\n
-00004580: 6060 6070 7974 686f 6e5c 6e66 726f 6d20  ```python\nfrom 
-00004590: 7575 6964 2069 6d70 6f72 7420 7575 6964  uuid import uuid
-000045a0: 345c 6e5c 6e66 726f 6d20 6573 6462 636c  4\n\nfrom esdbcl
-000045b0: 6965 6e74 2069 6d70 6f72 7420 4e65 7745  ient import NewE
-000045c0: 7665 6e74 5c6e 5c6e 2320 436f 6e73 7472  vent\n\n# Constr
-000045d0: 7563 7420 6e65 7720 6576 656e 7420 6f62  uct new event ob
-000045e0: 6a65 6374 2e5c 6e65 7665 6e74 3120 3d20  ject.\nevent1 = 
-000045f0: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
-00004600: 4f72 6465 7243 7265 6174 6564 5c27 2c20  OrderCreated\', 
-00004610: 6461 7461 3d62 5c27 6461 7461 315c 2729  data=b\'data1\')
-00004620: 5c6e 5c6e 2320 4465 6669 6e65 2073 7472  \n\n# Define str
-00004630: 6561 6d20 6e61 6d65 2e5c 6e73 7472 6561  eam name.\nstrea
-00004640: 6d5f 6e61 6d65 3120 3d20 7374 7228 7575  m_name1 = str(uu
-00004650: 6964 3428 2929 5c6e 5c6e 2320 4170 7065  id4())\n\n# Appe
-00004660: 6e64 206c 6973 7420 6f66 2065 7665 6e74  nd list of event
-00004670: 7320 746f 206e 6577 2073 7472 6561 6d2e  s to new stream.
-00004680: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
-00004690: 6e31 203d 2063 6c69 656e 742e 6170 7065  n1 = client.appe
-000046a0: 6e64 5f65 7665 6e74 7328 5c6e 2020 2020  nd_events(\n    
-000046b0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-000046c0: 616d 5f6e 616d 6531 2c5c 6e20 2020 2065  am_name1,\n    e
-000046d0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-000046e0: 3d4e 6f6e 652c 5c6e 2020 2020 6576 656e  =None,\n    even
-000046f0: 7473 3d5b 6576 656e 7431 5d2c 5c6e 295c  ts=[event1],\n)\
-00004700: 6e60 6060 5c6e 5c6e 496e 2074 6865 2065  n```\n\nIn the e
-00004710: 7861 6d70 6c65 2062 656c 6f77 2c20 7477  xample below, tw
-00004720: 6f20 7375 6273 6571 7565 6e74 2065 7665  o subsequent eve
-00004730: 6e74 7320 6172 6520 6170 7065 6e64 6564  nts are appended
-00004740: 2074 6f20 616e 2065 7869 7374 696e 675c   to an existing\
-00004750: 6e73 7472 6561 6d2e 5c6e 5c6e 6060 6070  nstream.\n\n```p
-00004760: 7974 686f 6e5c 6e65 7665 6e74 3220 3d20  ython\nevent2 = 
-00004770: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
-00004780: 4f72 6465 7255 7064 6174 6564 5c27 2c20  OrderUpdated\', 
-00004790: 6461 7461 3d62 5c27 6461 7461 325c 2729  data=b\'data2\')
-000047a0: 5c6e 6576 656e 7433 203d 204e 6577 4576  \nevent3 = NewEv
-000047b0: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
-000047c0: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
-000047d0: 625c 2764 6174 6133 5c27 295c 6e5c 6e63  b\'data3\')\n\nc
-000047e0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3220  ommit_position2 
-000047f0: 3d20 636c 6965 6e74 2e61 7070 656e 645f  = client.append_
-00004800: 6576 656e 7473 285c 6e20 2020 2073 7472  events(\n    str
-00004810: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00004820: 6e61 6d65 312c 5c6e 2020 2020 6578 7065  name1,\n    expe
-00004830: 6374 6564 5f70 6f73 6974 696f 6e3d 302c  cted_position=0,
-00004840: 5c6e 2020 2020 6576 656e 7473 3d5b 6576  \n    events=[ev
-00004850: 656e 7432 2c20 6576 656e 7433 5d2c 5c6e  ent2, event3],\n
-00004860: 295c 6e60 6060 5c6e 5c6e 4966 2074 6865  )\n```\n\nIf the
-00004870: 206f 7065 7261 7469 6f6e 2069 7320 7375   operation is su
-00004880: 6363 6573 7366 756c 2c20 7468 6973 206d  ccessful, this m
-00004890: 6574 686f 6420 7265 7475 726e 7320 616e  ethod returns an
-000048a0: 2069 6e74 6567 6572 5c6e 7265 7072 6573   integer\nrepres
-000048b0: 656e 7469 6e67 2074 6865 2064 6174 6162  enting the datab
-000048c0: 6173 6520 2263 6f6d 6d69 7420 706f 7369  ase "commit posi
-000048d0: 7469 6f6e 2220 6173 2069 7420 7761 7320  tion" as it was 
-000048e0: 7768 656e 2074 6865 206f 7065 7261 7469  when the operati
-000048f0: 6f6e 5c6e 7761 7320 636f 6d70 6c65 7465  on\nwas complete
-00004900: 642e 5c6e 5c6e 4120 2263 6f6d 6d69 7420  d.\n\nA "commit 
-00004910: 706f 7369 7469 6f6e 2220 6973 2061 206d  position" is a m
-00004920: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
-00004930: 7265 6173 696e 6720 696e 7465 6765 7220  reasing integer 
-00004940: 7265 7072 6573 656e 7469 6e67 5c6e 7468  representing\nth
-00004950: 6520 706f 7369 7469 6f6e 206f 6620 7468  e position of th
-00004960: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00004970: 2069 6e20 6120 2274 6f74 616c 206f 7264   in a "total ord
-00004980: 6572 2220 6f66 2061 6c6c 2072 6563 6f72  er" of all recor
-00004990: 6465 645c 6e65 7665 6e74 7320 696e 2074  ded\nevents in t
-000049a0: 6865 2064 6174 6162 6173 6520 6163 726f  he database acro
-000049b0: 7373 2061 6c6c 2073 7472 6561 6d73 2e20  ss all streams. 
-000049c0: 4974 2069 7320 7468 6520 6163 7475 616c  It is the actual
-000049d0: 2070 6f73 6974 696f 6e5c 6e6f 6620 7468   position\nof th
-000049e0: 6520 6576 656e 7420 7265 636f 7264 206f  e event record o
-000049f0: 6e20 6469 736b 2e20 496e 2063 6f6e 7365  n disk. In conse
-00004a00: 7175 656e 6365 2c20 7468 6520 7365 7175  quence, the sequ
-00004a10: 656e 6365 206f 6620 636f 6d6d 6974 5c6e  ence of commit\n
-00004a20: 706f 7369 7469 6f6e 7320 6973 206e 6f74  positions is not
-00004a30: 2067 6170 6c65 7373 2e20 496e 6465 6564   gapless. Indeed
-00004a40: 2c20 7468 6572 6520 6172 6520 7573 7561  , there are usua
-00004a50: 6c6c 7920 6c61 7267 6520 6469 6666 6572  lly large differ
-00004a60: 656e 6365 735c 6e62 6574 7765 656e 2074  ences\nbetween t
-00004a70: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-00004a80: 6f6e 7320 6f66 2073 7563 6365 7373 6976  ons of successiv
-00004a90: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00004aa0: 732e 5c6e 5c6e 5468 6520 2263 6f6d 6d69  s.\n\nThe "commi
-00004ab0: 7420 706f 7369 7469 6f6e 2220 7265 7475  t position" retu
-00004ac0: 726e 6564 2062 7920 6061 7070 656e 645f  rned by `append_
-00004ad0: 6576 656e 7473 2829 6020 6973 2074 6861  events()` is tha
-00004ae0: 7420 6f66 2074 6865 206c 6173 745c 6e72  t of the last\nr
-00004af0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
-00004b00: 2074 6865 2067 6976 656e 2062 6174 6368   the given batch
-00004b10: 206f 6620 6e65 7720 6576 656e 7473 2e5c   of new events.\
-00004b20: 6e5c 6e54 6865 2022 636f 6d6d 6974 2070  n\nThe "commit p
-00004b30: 6f73 6974 696f 6e22 2072 6574 7572 6e65  osition" returne
-00004b40: 6420 696e 2074 6869 7320 7761 7920 6361  d in this way ca
-00004b50: 6e20 7468 6572 6566 6f72 6520 6265 2075  n therefore be u
-00004b60: 7365 6420 746f 2077 6169 745c 6e66 6f72  sed to wait\nfor
-00004b70: 2061 2064 6f77 6e73 7472 6561 6d20 636f   a downstream co
-00004b80: 6d70 6f6e 656e 7420 746f 2068 6176 6520  mponent to have 
-00004b90: 7072 6f63 6573 7365 6420 616c 6c20 7468  processed all th
-00004ba0: 6520 6576 656e 7473 2074 6861 7420 7765  e events that we
-00004bb0: 7265 2072 6563 6f72 6465 642e 5c6e 5c6e  re recorded.\n\n
-00004bc0: 466f 7220 6578 616d 706c 652c 2063 6f6e  For example, con
-00004bd0: 7369 6465 7220 6120 7573 6572 2069 6e74  sider a user int
-00004be0: 6572 6661 6365 2063 6f6d 6d61 6e64 2074  erface command t
-00004bf0: 6861 7420 7265 7375 6c74 7320 696e 2074  hat results in t
-00004c00: 6865 2072 6563 6f72 6469 6e67 5c6e 6f66  he recording\nof
-00004c10: 206e 6577 2065 7665 6e74 732c 2061 6e64   new events, and
-00004c20: 2061 2071 7565 7279 2069 6e74 6f20 616e   a query into an
-00004c30: 2065 7665 6e74 7561 6c6c 7920 636f 6e73   eventually cons
-00004c40: 6973 7465 6e74 206d 6174 6572 6961 6c69  istent materiali
-00004c50: 7a65 645c 6e76 6965 7720 696e 2061 2064  zed\nview in a d
-00004c60: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-00004c70: 656e 7420 7468 6174 2069 7320 7570 6461  ent that is upda
-00004c80: 7465 6420 6672 6f6d 2074 6865 7365 2065  ted from these e
-00004c90: 7665 6e74 732e 2049 6620 7468 6520 6e65  vents. If the ne
-00004ca0: 775c 6e65 7665 6e74 7320 6861 7665 206e  w\nevents have n
-00004cb0: 6f74 2079 6574 2062 6565 6e20 7072 6f63  ot yet been proc
-00004cc0: 6573 7365 642c 2074 6865 2076 6965 7720  essed, the view 
-00004cd0: 776f 756c 6420 6265 2073 7461 6c65 2e20  would be stale. 
-00004ce0: 5468 6520 2263 6f6d 6d69 7420 706f 7369  The "commit posi
-00004cf0: 7469 6f6e 225c 6e63 616e 2062 6520 7573  tion"\ncan be us
-00004d00: 6564 2062 7920 7468 6520 7573 6572 2069  ed by the user i
-00004d10: 6e74 6572 6661 6365 2074 6f20 706f 6c6c  nterface to poll
-00004d20: 2074 6865 2064 6f77 6e73 7472 6561 6d20   the downstream 
-00004d30: 636f 6d70 6f6e 656e 7420 756e 7469 6c20  component until 
-00004d40: 6974 2068 6173 5c6e 7072 6f63 6573 7365  it has\nprocesse
-00004d50: 6420 7468 6f73 6520 6e65 7720 6576 656e  d those new even
-00004d60: 7473 2c20 6166 7465 7220 7768 6963 6820  ts, after which 
-00004d70: 7469 6d65 2074 6865 2076 6965 7720 7769  time the view wi
-00004d80: 6c6c 206e 6f74 2062 6520 7374 616c 652e  ll not be stale.
-00004d90: 5c6e 5c6e 5c6e 2323 2320 4170 7065 6e64  \n\n\n### Append
-00004da0: 2065 7665 6e74 5c6e 5c6e 2a72 6571 7569   event\n\n*requi
-00004db0: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
-00004dc0: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
-00004dd0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00004de0: 6520 7573 6564 2074 6f20 7772 6974 6520  e used to write 
-00004df0: 6120 7369 6e67 6c65 206e 6577 2065 7665  a single new eve
-00004e00: 6e74 2074 6f20 6120 7374 7265 616d 2e5c  nt to a stream.\
-00004e10: 6e5c 6e54 6872 6565 2061 7267 756d 656e  n\nThree argumen
-00004e20: 7473 2061 7265 2072 6571 7569 7265 642c  ts are required,
-00004e30: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
-00004e40: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
-00004e50: 6f6e 6020 616e 6420 6065 7665 6e74 602e  on` and `event`.
-00004e60: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00004e70: 776f 726b 7320 696e 2074 6865 2073 616d  works in the sam
-00004e80: 6520 7761 7920 6173 2060 6170 7065 6e64  e way as `append
-00004e90: 5f65 7665 6e74 7328 2960 2c20 686f 7765  _events()`, howe
-00004ea0: 7665 7220 6065 7665 6e74 6020 6973 2065  ver `event` is e
-00004eb0: 7870 6563 7465 645c 6e74 6f20 6265 2061  xpected\nto be a
-00004ec0: 2073 696e 676c 6520 604e 6577 4576 656e   single `NewEven
-00004ed0: 7460 2e5c 6e5c 6e54 6869 7320 6d65 7468  t`.\n\nThis meth
-00004ee0: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
-00004ef0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00004f00: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
-00004f10: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
-00004f20: 7460 2074 6861 7420 7365 7473 5c6e 6120  t` that sets\na 
-00004f30: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
-00004f40: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00004f50: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00004f60: 6e2e 5c6e 5c6e 4966 2074 6865 206f 7065  n.\n\nIf the ope
-00004f70: 7261 7469 6f6e 2069 7320 7375 6363 6573  ration is succes
-00004f80: 7366 756c 2c20 7468 6973 206d 6574 686f  sful, this metho
-00004f90: 6420 7265 7475 726e 7320 616e 2069 6e74  d returns an int
-00004fa0: 6567 6572 5c6e 7265 7072 6573 656e 7469  eger\nrepresenti
-00004fb0: 6e67 2074 6865 2064 6174 6162 6173 6520  ng the database 
-00004fc0: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
-00004fd0: 2220 6173 2069 7420 7761 7320 7768 656e  " as it was when
-00004fe0: 2074 6865 206f 7065 7261 7469 6f6e 5c6e   the operation\n
-00004ff0: 7761 7320 636f 6d70 6c65 7465 642e 5c6e  was completed.\n
-00005000: 5c6e 5369 6e63 6520 7468 6520 6861 6e64  \nSince the hand
-00005010: 6c69 6e67 206f 6620 6120 636f 6d6d 616e  ling of a comman
-00005020: 6420 696e 2079 6f75 7220 6170 706c 6963  d in your applic
-00005030: 6174 696f 6e20 6d61 7920 7265 7375 6c74  ation may result
-00005040: 2069 6e20 6f6e 6520 6f72 206d 616e 795c   in one or many\
-00005050: 6e6e 6577 2065 7665 6e74 732c 2061 6e64  nnew events, and
-00005060: 2074 6865 2072 6573 756c 7473 206f 6620   the results of 
-00005070: 6861 6e64 6c69 6e67 2061 2063 6f6d 6d61  handling a comma
-00005080: 6e64 2073 686f 756c 6420 6265 2072 6563  nd should be rec
-00005090: 6f72 6465 6420 6174 6f6d 6963 616c 6c79  orded atomically
-000050a0: 2c5c 6e61 6e64 2074 6865 2077 7269 7469  ,\nand the writi
-000050b0: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
-000050c0: 2067 656e 6572 6174 6564 2062 7920 6120   generated by a 
-000050d0: 636f 6d6d 616e 6420 6861 6e64 6c65 7220  command handler 
-000050e0: 6973 2075 7375 616c 6c79 2061 2063 6f6e  is usually a con
-000050f0: 6365 726e 5c6e 7468 6174 2069 7320 6661  cern\nthat is fa
-00005100: 6374 6f72 6564 206f 7574 2061 6e64 2075  ctored out and u
-00005110: 7365 6420 6576 6572 7977 6865 7265 2069  sed everywhere i
-00005120: 6e20 6120 7072 6f6a 6563 742c 2069 7420  n a project, it 
-00005130: 6973 206d 6f72 6520 7573 7561 6c20 696e  is more usual in
-00005140: 2061 2070 726f 6a65 6374 5c6e 746f 2075   a project\nto u
-00005150: 7365 2060 6170 7065 6e64 5f65 7665 6e74  se `append_event
-00005160: 7328 2960 2074 6f20 7265 636f 7264 206e  s()` to record n
-00005170: 6577 2065 7665 6e74 732e 2048 6f77 6576  ew events. Howev
-00005180: 6572 2c20 7468 6973 206d 6574 686f 6420  er, this method 
-00005190: 6d61 7920 6f63 6361 7369 6f6e 616c 6c79  may occasionally
-000051a0: 5c6e 6265 2075 7365 6675 6c2c 2061 6e64  \nbe useful, and
-000051b0: 2069 6e64 6565 6420 6974 2069 7320 7573   indeed it is us
-000051c0: 6564 2062 7920 6073 6574 5f73 7472 6561  ed by `set_strea
-000051d0: 6d5f 6d65 7461 6461 7461 2829 602e 5c6e  m_metadata()`.\n
-000051e0: 5c6e 5c6e 2323 2320 4964 656d 706f 7465  \n\n### Idempote
-000051f0: 6e74 2061 7070 656e 6420 6f70 6572 6174  nt append operat
-00005200: 696f 6e73 5c6e 5c6e 536f 6d65 7469 6d65  ions\n\nSometime
-00005210: 7320 6974 206d 6179 2068 6170 7065 6e20  s it may happen 
-00005220: 7468 6174 2c20 7768 656e 2063 616c 6c69  that, when calli
-00005230: 6e67 2060 6170 7065 6e64 5f65 7665 6e74  ng `append_event
-00005240: 7328 2960 206f 7220 6061 7070 656e 645f  s()` or `append_
-00005250: 6576 656e 7428 2960 2c5c 6e74 6865 206e  event()`,\nthe n
-00005260: 6577 2065 7665 6e74 7320 6172 6520 7375  ew events are su
-00005270: 6363 6573 7366 756c 6c79 2072 6563 6f72  ccessfully recor
-00005280: 6465 642c 2062 7574 2074 6865 6e20 736f  ded, but then so
-00005290: 6d65 686f 7720 7468 6520 636f 6e6e 6563  mehow the connec
-000052a0: 7469 6f6e 2074 6f20 7468 655c 6e64 6174  tion to the\ndat
-000052b0: 6162 6173 6520 6765 7473 2069 6e74 6572  abase gets inter
-000052c0: 7275 7074 6564 2062 6566 6f72 6520 7468  rupted before th
-000052d0: 6520 7375 6363 6573 7366 756c 2063 616c  e successful cal
-000052e0: 6c20 6361 6e20 7265 7475 726e 2073 7563  l can return suc
-000052f0: 6365 7373 6675 6c6c 7920 746f 5c6e 7468  cessfully to\nth
-00005300: 6520 636c 6965 6e74 2e20 496e 2063 6173  e client. In cas
-00005310: 6520 6f66 2061 6e20 6572 726f 7220 7768  e of an error wh
-00005320: 656e 2061 7070 656e 6469 6e67 2061 6e20  en appending an 
-00005330: 6576 656e 742c 2069 7420 6973 2064 6573  event, it is des
-00005340: 6972 6162 6c65 2074 6f5c 6e72 6574 7279  irable to\nretry
-00005350: 2061 7070 656e 6469 6e67 2074 6865 2073   appending the s
-00005360: 616d 6520 6576 656e 7420 6174 2074 6865  ame event at the
-00005370: 2073 616d 6520 706f 7369 7469 6f6e 2e20   same position. 
-00005380: 4966 2074 6865 2065 7665 6e74 2077 6173  If the event was
-00005390: 2069 6e20 6661 6374 5c6e 7375 6363 6573   in fact\nsucces
-000053a0: 7366 756c 6c79 2072 6563 6f72 6465 642c  sfully recorded,
-000053b0: 2069 7420 6973 2063 6f6e 7665 6e69 656e   it is convenien
-000053c0: 7420 666f 7220 7468 6520 7265 7472 6965  t for the retrie
-000053d0: 6420 6f70 6572 6174 696f 6e20 746f 2072  d operation to r
-000053e0: 6574 7572 6e5c 6e73 7563 6365 7373 6675  eturn\nsuccessfu
-000053f0: 6c6c 7920 7769 7468 6f75 7420 7261 6973  lly without rais
-00005400: 696e 6720 616e 2065 7272 6f72 2064 7565  ing an error due
-00005410: 2074 6f20 6f70 7469 6d69 7374 6963 2063   to optimistic c
-00005420: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
-00005430: 6f6c 5c6e 2861 7320 6465 7363 7269 6265  ol\n(as describe
-00005440: 6420 6162 6f76 6529 2e5c 6e5c 6e54 6865  d above).\n\nThe
-00005450: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-00005460: 686f 7773 2074 6865 2060 6170 7065 6e64  hows the `append
-00005470: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
-00005480: 6420 6265 696e 6720 6361 6c6c 6564 2061  d being called a
-00005490: 6761 696e 2077 6974 685c 6e60 6576 656e  gain with\n`even
-000054a0: 7433 6020 616e 6420 6065 7870 6563 7465  t3` and `expecte
-000054b0: 645f 706f 7369 7469 6f6e 3d32 602e 2057  d_position=2`. W
-000054c0: 6520 6361 6e20 7365 6520 7468 6174 2072  e can see that r
-000054d0: 6570 6561 7469 6e67 2074 6865 2063 616c  epeating the cal
-000054e0: 6c20 746f 5c6e 6061 7070 656e 645f 6576  l to\n`append_ev
-000054f0: 656e 7473 2829 6020 7265 7475 726e 7320  ents()` returns 
-00005500: 7375 6363 6573 7366 756c 6c79 2e5c 6e5c  successfully.\n\
-00005510: 6e60 6060 7079 7468 6f6e 5c6e 2320 5265  n```python\n# Re
-00005520: 7472 7920 6170 7065 6e64 696e 6720 6576  try appending ev
-00005530: 656e 7433 2e5c 6e63 6f6d 6d69 745f 706f  ent3.\ncommit_po
-00005540: 7369 7469 6f6e 5f72 6574 7279 203d 2063  sition_retry = c
-00005550: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-00005560: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
-00005570: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00005580: 6531 2c5c 6e20 2020 2065 7870 6563 7465  e1,\n    expecte
-00005590: 645f 706f 7369 7469 6f6e 3d30 2c5c 6e20  d_position=0,\n 
-000055a0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-000055b0: 322c 2065 7665 6e74 335d 2c5c 6e29 5c6e  2, event3],\n)\n
-000055c0: 6060 605c 6e5c 6e57 6520 6361 6e20 7365  ```\n\nWe can se
-000055d0: 6520 7468 6174 2074 6865 2073 616d 6520  e that the same 
-000055e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-000055f0: 6973 2072 6574 7572 6e65 6420 6173 2061  is returned as a
-00005600: 626f 7665 2e5c 6e5c 6e60 6060 7079 7468  bove.\n\n```pyth
-00005610: 6f6e 5c6e 6173 7365 7274 2063 6f6d 6d69  on\nassert commi
-00005620: 745f 706f 7369 7469 6f6e 5f72 6574 7279  t_position_retry
-00005630: 203d 3d20 636f 6d6d 6974 5f70 6f73 6974   == commit_posit
-00005640: 696f 6e32 5c6e 6060 605c 6e5c 6e42 7920  ion2\n```\n\nBy 
-00005650: 6361 6c6c 696e 6720 6072 6561 645f 7374  calling `read_st
-00005660: 7265 616d 5f65 7665 6e74 7328 2960 2c20  ream_events()`, 
-00005670: 7765 2063 616e 2061 6c73 6f20 7365 6520  we can also see 
-00005680: 7468 6520 7374 7265 616d 2068 6173 2062  the stream has b
-00005690: 6565 6e20 756e 6368 616e 6765 645c 6e64  een unchanged\nd
-000056a0: 6573 7069 7465 2074 6865 2060 6170 7065  espite the `appe
-000056b0: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
-000056c0: 686f 6420 6861 7669 6e67 2062 6565 6e20  hod having been 
-000056d0: 6361 6c6c 6564 2074 7769 6365 2077 6974  called twice wit
-000056e0: 6820 7468 6520 7361 6d65 2061 7267 756d  h the same argum
-000056f0: 656e 7473 2e5c 6e54 6861 7420 6973 2c20  ents.\nThat is, 
-00005700: 7468 6572 6520 6172 6520 7374 696c 6c20  there are still 
-00005710: 6f6e 6c79 2074 6872 6565 2065 7665 6e74  only three event
-00005720: 7320 696e 2074 6865 2073 7472 6561 6d2e  s in the stream.
-00005730: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e65  \n\n```python\ne
-00005740: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-00005750: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-00005760: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-00005770: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00005780: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-00005790: 6e28 6576 656e 7473 2920 3d3d 2033 5c6e  n(events) == 3\n
-000057a0: 6060 605c 6e5c 6e54 6869 7320 6964 656d  ```\n\nThis idem
-000057b0: 706f 7465 6e74 2062 6568 6176 696f 7572  potent behaviour
-000057c0: 2069 7320 6163 7469 7661 7465 6420 6265   is activated be
-000057d0: 6361 7573 6520 7468 6520 604e 6577 4576  cause the `NewEv
-000057e0: 656e 7460 2063 6c61 7373 2068 6173 2061  ent` class has a
-000057f0: 6e20 6069 6460 5c6e 6174 7472 6962 7574  n `id`\nattribut
-00005800: 6520 7468 6174 2c20 6279 2064 6566 6175  e that, by defau
-00005810: 6c74 2c20 6973 2061 7373 6967 6e65 6420  lt, is assigned 
-00005820: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
-00005830: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
-00005840: 7768 656e 2061 6e5c 6e69 6e73 7461 6e63  when an\ninstanc
-00005850: 6520 6f66 2060 4e65 7745 7665 6e74 6020  e of `NewEvent` 
-00005860: 6973 2063 6f6e 7374 7275 6374 6564 2e20  is constructed. 
-00005870: 4966 2065 7665 6e74 7320 7769 7468 2074  If events with t
-00005880: 6865 2073 616d 6520 6069 6460 2061 7265  he same `id` are
-00005890: 2061 7070 656e 6465 645c 6e61 7420 7468   appended\nat th
-000058a0: 6520 7361 6d65 2060 6578 7065 6374 6564  e same `expected
-000058b0: 5f70 6f73 6974 696f 6e60 2c20 7468 6520  _position`, the 
-000058c0: 7374 7265 616d 2077 696c 6c20 6265 2075  stream will be u
-000058d0: 6e63 6861 6e67 6564 2c20 7468 6520 6f70  nchanged, the op
-000058e0: 6572 6174 696f 6e20 7769 6c6c 5c6e 636f  eration will\nco
-000058f0: 6d70 6c65 7465 2073 7563 6365 7373 6675  mplete successfu
-00005900: 6c6c 792c 2061 6e64 2074 6865 2073 616d  lly, and the sam
-00005910: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00005920: 6e20 7769 6c6c 2062 6520 7265 7475 726e  n will be return
-00005930: 6564 2074 6f20 7468 6520 6361 6c6c 6572  ed to the caller
-00005940: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00005950: 6672 6f6d 2075 7569 6420 696d 706f 7274  from uuid import
-00005960: 2055 5549 445c 6e5c 6e5c 6e61 7373 6572   UUID\n\n\nasser
-00005970: 7420 6973 696e 7374 616e 6365 2865 7665  t isinstance(eve
-00005980: 6e74 312e 6964 2c20 5555 4944 295c 6e61  nt1.id, UUID)\na
-00005990: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-000059a0: 2865 7665 6e74 322e 6964 2c20 5555 4944  (event2.id, UUID
-000059b0: 295c 6e61 7373 6572 7420 6973 696e 7374  )\nassert isinst
-000059c0: 616e 6365 2865 7665 6e74 332e 6964 2c20  ance(event3.id, 
-000059d0: 5555 4944 295c 6e5c 6e61 7373 6572 7420  UUID)\n\nassert 
-000059e0: 6576 656e 7431 2e69 6420 213d 2065 7665  event1.id != eve
-000059f0: 6e74 322e 6964 5c6e 6173 7365 7274 2065  nt2.id\nassert e
-00005a00: 7665 6e74 322e 6964 2021 3d20 6576 656e  vent2.id != even
-00005a10: 7433 2e69 645c 6e5c 6e61 7373 6572 7420  t3.id\n\nassert 
-00005a20: 6576 656e 7473 5b30 5d2e 6964 203d 3d20  events[0].id == 
-00005a30: 6576 656e 7431 2e69 645c 6e61 7373 6572  event1.id\nasser
-00005a40: 7420 6576 656e 7473 5b31 5d2e 6964 203d  t events[1].id =
-00005a50: 3d20 6576 656e 7432 2e69 645c 6e61 7373  = event2.id\nass
-00005a60: 6572 7420 6576 656e 7473 5b32 5d2e 6964  ert events[2].id
-00005a70: 203d 3d20 6576 656e 7433 2e69 645c 6e60   == event3.id\n`
-00005a80: 6060 5c6e 5c6e 4974 2069 7320 706f 7373  ``\n\nIt is poss
-00005a90: 6962 6c65 2074 6f20 7365 7420 7468 6520  ible to set the 
-00005aa0: 6069 6460 2063 6f6e 7374 7275 6374 6f72  `id` constructor
-00005ab0: 2061 7267 756d 656e 7420 6f66 2060 4e65   argument of `Ne
-00005ac0: 7745 7665 6e74 6020 7768 656e 2069 6e73  wEvent` when ins
-00005ad0: 7461 6e74 6961 7469 6e67 5c6e 7468 6520  tantiating\nthe 
-00005ae0: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
-00005af0: 2c20 6275 7420 696e 2074 6865 2065 7861  , but in the exa
-00005b00: 6d70 6c65 7320 6162 6f76 6520 7765 2068  mples above we h
-00005b10: 6176 6520 6265 656e 2075 7369 6e67 2074  ave been using t
-00005b20: 6865 2064 6566 6175 6c74 5c6e 6265 6861  he default\nbeha
-00005b30: 7669 6f75 722c 2077 6869 6368 2069 7320  viour, which is 
-00005b40: 7468 6174 2074 6865 2060 6964 6020 7661  that the `id` va
-00005b50: 6c75 6520 6973 2067 656e 6572 6174 6564  lue is generated
-00005b60: 2077 6865 6e20 7468 6520 604e 6577 4576   when the `NewEv
-00005b70: 656e 7460 2063 6c61 7373 2069 735c 6e69  ent` class is\ni
-00005b80: 6e73 7461 6e74 6961 7465 642e 5c6e 5c6e  nstantiated.\n\n
-00005b90: 5c6e 2323 2320 5265 6164 2073 7472 6561  \n### Read strea
-00005ba0: 6d20 6576 656e 7473 5c6e 5c6e 5468 6520  m events\n\nThe 
-00005bb0: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
-00005bc0: 6e74 7328 2960 206d 6574 686f 6420 6361  nts()` method ca
-00005bd0: 6e20 6265 2075 7365 6420 746f 206f 6274  n be used to obt
-00005be0: 6169 6e20 7468 6520 7265 636f 7264 6564  ain the recorded
-00005bf0: 2065 7665 6e74 7320 696e 2061 5c6e 7374   events in a\nst
-00005c00: 7265 616d 2e20 4974 2072 6574 7572 6e73  ream. It returns
-00005c10: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-00005c20: 6563 6f72 6465 6420 6576 656e 7473 206f  ecorded events o
-00005c30: 626a 6563 7473 2e20 5468 6520 7265 6365  bjects. The rece
-00005c40: 6976 6564 2072 6563 6f72 6465 6420 6576  ived recorded ev
-00005c50: 656e 745c 6e6f 626a 6563 7420 6172 6520  ent\nobject are 
-00005c60: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-00005c70: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00005c80: 2063 6c61 7373 2028 7365 6520 7468 6520   class (see the 
-00005c90: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-00005ca0: 6c6f 7720 666f 725c 6e64 6574 6169 6c73  low for\ndetails
-00005cb0: 206f 6620 7468 6973 2063 6c61 7373 292e   of this class).
-00005cc0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00005cd0: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
-00005ce0: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
-00005cf0: 616d 5f6e 616d 6560 2c20 7768 6963 6820  am_name`, which 
-00005d00: 6973 2074 6865 206e 616d 6520 6f66 5c6e  is the name of\n
-00005d10: 7468 6520 7374 7265 616d 2066 726f 6d20  the stream from 
-00005d20: 7768 6963 6820 746f 2072 6561 6420 6576  which to read ev
-00005d30: 656e 7473 2e20 4279 2064 6566 6175 6c74  ents. By default
-00005d40: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
-00005d50: 7665 6e74 7320 696e 2074 6865 5c6e 7374  vents in the\nst
-00005d60: 7265 616d 2061 7265 2072 6574 7572 6e65  ream are returne
-00005d70: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
-00005d80: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
-00005d90: 642e 5c6e 5c6e 5468 6520 6d65 7468 6f64  d.\n\nThe method
-00005da0: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
-00005db0: 656e 7473 2829 6020 616c 736f 2073 7570  ents()` also sup
-00005dc0: 706f 7274 7320 666f 7572 206f 7074 696f  ports four optio
-00005dd0: 6e61 6c20 6172 6775 6d65 6e74 732c 5c6e  nal arguments,\n
-00005de0: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
-00005df0: 602c 2060 6261 636b 7761 7264 7360 2c20  `, `backwards`, 
-00005e00: 606c 696d 6974 602c 2061 6e64 2060 7469  `limit`, and `ti
-00005e10: 6d65 6f75 7460 2e5c 6e5c 6e54 6865 206f  meout`.\n\nThe o
-00005e20: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
-00005e30: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-00005e40: 6e74 2069 7320 616e 206f 7074 696f 6e61  nt is an optiona
-00005e50: 6c20 696e 7465 6765 7220 7468 6174 2063  l integer that c
-00005e60: 616e 2062 6520 7573 6564 2074 6f5c 6e69  an be used to\ni
-00005e70: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
-00005e80: 7469 6f6e 2069 6e20 7468 6520 7374 7265  tion in the stre
-00005e90: 616d 2066 726f 6d20 7768 6963 6820 746f  am from which to
-00005ea0: 2073 7461 7274 2072 6561 6469 6e67 2e20   start reading. 
-00005eb0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
-00005ec0: 5c6e 604e 6f6e 6560 2062 7920 6465 6661  \n`None` by defa
-00005ed0: 756c 742c 2077 6869 6368 206d 6561 6e73  ult, which means
-00005ee0: 2074 6865 2073 7472 6561 6d20 7769 6c6c   the stream will
-00005ef0: 2062 6520 7265 6164 2065 6974 6865 7220   be read either 
-00005f00: 6672 6f6d 2074 6865 2073 7461 7274 206f  from the start o
-00005f10: 6620 7468 655c 6e73 7472 6561 6d20 2874  f the\nstream (t
-00005f20: 6865 2064 6566 6175 6c74 2062 6568 6176  he default behav
-00005f30: 696f 7572 292c 206f 7220 6672 6f6d 2074  iour), or from t
-00005f40: 6865 2065 6e64 206f 6620 7468 6520 7374  he end of the st
-00005f50: 7265 616d 2069 6620 6062 6163 6b77 6172  ream if `backwar
-00005f60: 6473 6020 6973 5c6e 6054 7275 6560 2e20  ds` is\n`True`. 
-00005f70: 5768 656e 2072 6561 6469 6e67 2061 2073  When reading a s
-00005f80: 7472 6561 6d20 6672 6f6d 2061 2073 7065  tream from a spe
-00005f90: 6369 6669 6320 706f 7369 7469 6f6e 2069  cific position i
-00005fa0: 6e20 7468 6520 7374 7265 616d 2c20 7468  n the stream, th
-00005fb0: 655c 6e72 6563 6f72 6465 6420 6576 656e  e\nrecorded even
-00005fc0: 7420 6174 2074 6861 7420 706f 7369 7469  t at that positi
-00005fd0: 6f6e 2077 696c 6c20 6265 2069 6e63 6c75  on will be inclu
-00005fe0: 6465 642c 2062 6f74 6820 7768 656e 2072  ded, both when r
-00005ff0: 6561 6469 6e67 2066 6f72 7761 7264 735c  eading forwards\
-00006000: 6e66 726f 6d20 7468 6174 2070 6f73 6974  nfrom that posit
-00006010: 696f 6e2c 2061 6e64 2077 6865 6e20 7265  ion, and when re
-00006020: 6164 696e 6720 6261 636b 7761 7264 7320  ading backwards 
-00006030: 6672 6f6d 2074 6861 7420 706f 7369 7469  from that positi
-00006040: 6f6e 2e5c 6e5c 6e54 6865 206f 7074 696f  on.\n\nThe optio
-00006050: 6e61 6c20 6062 6163 6b77 6172 6473 6020  nal `backwards` 
-00006060: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-00006070: 7468 6f6e 2060 626f 6f6c 602e 2054 6865  thon `bool`. The
-00006080: 2064 6566 6175 6c74 2069 7320 6046 616c   default is `Fal
-00006090: 7365 602c 2077 6869 6368 5c6e 6d65 616e  se`, which\nmean
-000060a0: 7320 7468 6520 7374 7265 616d 2077 696c  s the stream wil
-000060b0: 6c20 6265 2072 6561 6420 666f 7277 6172  l be read forwar
-000060c0: 6473 2062 7920 6465 6661 756c 742c 2073  ds by default, s
-000060d0: 6f20 7468 6174 2065 7665 6e74 7320 6172  o that events ar
-000060e0: 6520 7265 7475 726e 6564 2069 6e20 7468  e returned in th
-000060f0: 655c 6e6f 7264 6572 2074 6865 7920 7765  e\norder they we
-00006100: 7265 2061 7070 656e 6465 642c 2049 6620  re appended, If 
-00006110: 6062 6163 6b77 6172 6473 6020 6973 2060  `backwards` is `
-00006120: 5472 7565 602c 2074 6865 2065 7665 6e74  True`, the event
-00006130: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
-00006140: 6e20 7265 7665 7273 655c 6e6f 7264 6572  n reverse\norder
-00006150: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-00006160: 6c20 606c 696d 6974 6020 6172 6775 6d65  l `limit` argume
-00006170: 6e74 2069 7320 616e 2069 6e74 6567 6572  nt is an integer
-00006180: 2077 6869 6368 2072 6573 7472 6963 7473   which restricts
-00006190: 2074 6865 206e 756d 6265 7220 6f66 2065   the number of e
-000061a0: 7665 6e74 7320 7468 6174 5c6e 7769 6c6c  vents that\nwill
-000061b0: 2062 6520 7265 7475 726e 6564 2e20 5468   be returned. Th
-000061c0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-000061d0: 6973 2060 7379 732e 6d61 7869 6e74 602e  is `sys.maxint`.
-000061e0: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-000061f0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
-00006200: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-00006210: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
-00006220: 7473 2061 2064 6561 646c 696e 6520 666f  ts a deadline fo
-00006230: 725c 6e74 6865 2063 6f6d 706c 6574 696f  r\nthe completio
-00006240: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00006250: 6572 6174 696f 6e2e 5c6e 5c6e 5468 6520  eration.\n\nThe 
-00006260: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-00006270: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
-00006280: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00006290: 6e74 7320 6f66 2061 2073 7472 6561 6d5c  nts of a stream\
-000062a0: 6e66 6f72 7761 7264 7320 6672 6f6d 2074  nforwards from t
-000062b0: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
-000062c0: 7374 7265 616d 2074 6f20 7468 6520 656e  stream to the en
-000062d0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-000062e0: 2054 6865 5c6e 6e61 6d65 206f 6620 6120   The\nname of a 
-000062f0: 7374 7265 616d 2069 7320 6769 7665 6e20  stream is given 
-00006300: 7768 656e 2063 616c 6c69 6e67 2074 6865  when calling the
-00006310: 206d 6574 686f 642e 5c6e 5c6e 6060 6070   method.\n\n```p
-00006320: 7974 686f 6e5c 6e65 7665 6e74 7320 3d20  ython\nevents = 
-00006330: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
-00006340: 616d 5f65 7665 6e74 7328 5c6e 2020 2020  am_events(\n    
-00006350: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00006360: 616d 5f6e 616d 6531 5c6e 295c 6e60 6060  am_name1\n)\n```
-00006370: 5c6e 5c6e 4e6f 7720 7468 6174 2077 6520  \n\nNow that we 
-00006380: 6861 7665 2061 2073 6571 7565 6e63 6520  have a sequence 
-00006390: 6f66 2065 7665 6e74 206f 626a 6563 7473  of event objects
-000063a0: 2c20 7765 2063 616e 2063 6865 636b 2077  , we can check w
-000063b0: 6520 676f 7420 7468 655c 6e74 6872 6565  e got the\nthree
-000063c0: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
-000063d0: 6520 6170 7065 6e64 6564 2074 6f20 7468  e appended to th
-000063e0: 6520 7374 7265 616d 2c20 616e 6420 7468  e stream, and th
-000063f0: 6174 2074 6865 7920 6172 655c 6e6f 7264  at they are\nord
-00006400: 6572 6564 2065 7861 6374 6c79 2061 7320  ered exactly as 
-00006410: 7468 6579 2077 6572 6520 6170 7065 6e64  they were append
-00006420: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
-00006430: 5c6e 6173 7365 7274 206c 656e 2865 7665  \nassert len(eve
-00006440: 6e74 7329 203d 3d20 335c 6e5c 6e61 7373  nts) == 3\n\nass
-00006450: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
-00006460: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-00006470: 6561 6d5f 6e61 6d65 315c 6e61 7373 6572  eam_name1\nasser
-00006480: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00006490: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
-000064a0: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-000064b0: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
-000064c0: 312e 7479 7065 5c6e 6173 7365 7274 2065  1.type\nassert e
-000064d0: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
-000064e0: 2065 7665 6e74 312e 6461 7461 5c6e 5c6e   event1.data\n\n
-000064f0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00006500: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00006510: 7374 7265 616d 5f6e 616d 6531 5c6e 6173  stream_name1\nas
-00006520: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-00006530: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-00006540: 3d20 315c 6e61 7373 6572 7420 6576 656e  = 1\nassert even
-00006550: 7473 5b31 5d2e 7479 7065 203d 3d20 6576  ts[1].type == ev
-00006560: 656e 7432 2e74 7970 655c 6e61 7373 6572  ent2.type\nasser
-00006570: 7420 6576 656e 7473 5b31 5d2e 6461 7461  t events[1].data
-00006580: 203d 3d20 6576 656e 7432 2e64 6174 615c   == event2.data\
-00006590: 6e5c 6e61 7373 6572 7420 6576 656e 7473  n\nassert events
-000065a0: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
-000065b0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 315c  == stream_name1\
-000065c0: 6e61 7373 6572 7420 6576 656e 7473 5b32  nassert events[2
-000065d0: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-000065e0: 6e20 3d3d 2032 5c6e 6173 7365 7274 2065  n == 2\nassert e
-000065f0: 7665 6e74 735b 325d 2e74 7970 6520 3d3d  vents[2].type ==
-00006600: 2065 7665 6e74 332e 7479 7065 5c6e 6173   event3.type\nas
-00006610: 7365 7274 2065 7665 6e74 735b 325d 2e64  sert events[2].d
-00006620: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
-00006630: 7461 5c6e 6060 605c 6e5c 6e54 6865 2065  ta\n```\n\nThe e
-00006640: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-00006650: 7773 2068 6f77 2074 6f20 7265 6164 2072  ws how to read r
-00006660: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
-00006670: 6e20 6120 7374 7265 616d 2066 6f72 7761  n a stream forwa
-00006680: 7264 7320 6672 6f6d 5c6e 6120 7370 6563  rds from\na spec
-00006690: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
-000066a0: 7469 6f6e 2074 6f20 7468 6520 656e 6420  tion to the end 
-000066b0: 6f66 2074 6865 2073 7472 6561 6d2e 5c6e  of the stream.\n
-000066c0: 5c6e 6060 6070 7974 686f 6e5c 6e65 7665  \n```python\neve
-000066d0: 6e74 7320 3d20 636c 6965 6e74 2e72 6561  nts = client.rea
-000066e0: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-000066f0: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
-00006700: 653d 7374 7265 616d 5f6e 616d 6531 2c5c  e=stream_name1,\
-00006710: 6e20 2020 2073 7472 6561 6d5f 706f 7369  n    stream_posi
-00006720: 7469 6f6e 3d31 2c5c 6e29 5c6e 5c6e 6173  tion=1,\n)\n\nas
-00006730: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00006740: 203d 3d20 325c 6e5c 6e61 7373 6572 7420   == 2\n\nassert 
-00006750: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00006760: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-00006770: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
-00006780: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-00006790: 6f73 6974 696f 6e20 3d3d 2031 5c6e 6173  osition == 1\nas
-000067a0: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-000067b0: 7970 6520 3d3d 2065 7665 6e74 322e 7479  ype == event2.ty
-000067c0: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
-000067d0: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-000067e0: 6e74 322e 6461 7461 5c6e 5c6e 6173 7365  nt2.data\n\nasse
-000067f0: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00006800: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-00006810: 616d 5f6e 616d 6531 5c6e 6173 7365 7274  am_name1\nassert
-00006820: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00006830: 6d5f 706f 7369 7469 6f6e 203d 3d20 325c  m_position == 2\
-00006840: 6e61 7373 6572 7420 6576 656e 7473 5b31  nassert events[1
-00006850: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
-00006860: 2e74 7970 655c 6e61 7373 6572 7420 6576  .type\nassert ev
-00006870: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-00006880: 6576 656e 7433 2e64 6174 615c 6e60 6060  event3.data\n```
-00006890: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-000068a0: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-000068b0: 746f 2072 6561 6420 7468 6520 7265 636f  to read the reco
-000068c0: 7264 6564 2065 7665 6e74 7320 696e 2061  rded events in a
-000068d0: 2073 7472 6561 6d20 6261 636b 7761 7264   stream backward
-000068e0: 7320 6672 6f6d 5c6e 7468 6520 656e 6420  s from\nthe end 
-000068f0: 6f66 2074 6865 2073 7472 6561 6d20 746f  of the stream to
-00006900: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
-00006910: 6520 7374 7265 616d 2e5c 6e5c 6e60 6060  e stream.\n\n```
-00006920: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
-00006930: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
-00006940: 6561 6d5f 6576 656e 7473 285c 6e20 2020  eam_events(\n   
-00006950: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00006960: 6561 6d5f 6e61 6d65 312c 5c6e 2020 2020  eam_name1,\n    
-00006970: 6261 636b 7761 7264 733d 5472 7565 2c5c  backwards=True,\
-00006980: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-00006990: 2865 7665 6e74 7329 203d 3d20 335c 6e5c  (events) == 3\n\
-000069a0: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
-000069b0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-000069c0: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
-000069d0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-000069e0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-000069f0: 3d3d 2032 5c6e 6173 7365 7274 2065 7665  == 2\nassert eve
-00006a00: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
-00006a10: 7665 6e74 332e 7479 7065 5c6e 6173 7365  vent3.type\nasse
-00006a20: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00006a30: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-00006a40: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
-00006a50: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
-00006a60: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-00006a70: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00006a80: 315d 2e73 7472 6561 6d5f 706f 7369 7469  1].stream_positi
-00006a90: 6f6e 203d 3d20 315c 6e61 7373 6572 7420  on == 1\nassert 
-00006aa0: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
-00006ab0: 3d20 6576 656e 7432 2e74 7970 655c 6e61  = event2.type\na
-00006ac0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-00006ad0: 6461 7461 203d 3d20 6576 656e 7432 2e64  data == event2.d
-00006ae0: 6174 615c 6e60 6060 5c6e 5c6e 5468 6520  ata\n```\n\nThe 
-00006af0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-00006b00: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
-00006b10: 6120 6c69 6d69 7465 6420 6e75 6d62 6572  a limited number
-00006b20: 2028 7477 6f29 206f 6620 7468 6520 7265   (two) of the re
-00006b30: 636f 7264 6564 2065 7665 6e74 735c 6e69  corded events\ni
-00006b40: 6e20 6120 7374 7265 616d 2066 6f72 7761  n a stream forwa
-00006b50: 7264 7320 6672 6f6d 2074 6865 2073 7461  rds from the sta
-00006b60: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
-00006b70: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00006b80: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
-00006b90: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00006ba0: 7473 285c 6e20 2020 2073 7472 6561 6d5f  ts(\n    stream_
-00006bb0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00006bc0: 312c 5c6e 2020 2020 6c69 6d69 743d 322c  1,\n    limit=2,
-00006bd0: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-00006be0: 6e28 6576 656e 7473 2920 3d3d 2032 5c6e  n(events) == 2\n
-00006bf0: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00006c00: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-00006c10: 3d20 7374 7265 616d 5f6e 616d 6531 5c6e  = stream_name1\n
-00006c20: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006c30: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-00006c40: 203d 3d20 305c 6e61 7373 6572 7420 6576   == 0\nassert ev
-00006c50: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-00006c60: 6576 656e 7431 2e74 7970 655c 6e61 7373  event1.type\nass
-00006c70: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-00006c80: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
-00006c90: 615c 6e5c 6e61 7373 6572 7420 6576 656e  a\n\nassert even
-00006ca0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
-00006cb0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00006cc0: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
-00006cd0: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
-00006ce0: 696f 6e20 3d3d 2031 5c6e 6173 7365 7274  ion == 1\nassert
-00006cf0: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
-00006d00: 3d3d 2065 7665 6e74 322e 7479 7065 5c6e  == event2.type\n
-00006d10: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00006d20: 2e64 6174 6120 3d3d 2065 7665 6e74 322e  .data == event2.
-00006d30: 6461 7461 5c6e 6060 605c 6e5c 6e54 6865  data\n```\n\nThe
-00006d40: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-00006d50: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-00006d60: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
-00006d70: 7220 286f 6e65 2920 6f66 2074 6865 2072  r (one) of the r
-00006d80: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
-00006d90: 696e 2061 2073 7472 6561 6d20 6261 636b  in a stream back
-00006da0: 7761 7264 7320 6672 6f6d 2061 2067 6976  wards from a giv
-00006db0: 656e 2073 7472 6561 6d20 706f 7369 7469  en stream positi
-00006dc0: 6f6e 2e5c 6e5c 6e60 6060 7079 7468 6f6e  on.\n\n```python
-00006dd0: 5c6e 6576 656e 7473 203d 2063 6c69 656e  \nevents = clien
-00006de0: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
-00006df0: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
-00006e00: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00006e10: 6d65 312c 5c6e 2020 2020 7374 7265 616d  me1,\n    stream
-00006e20: 5f70 6f73 6974 696f 6e3d 322c 5c6e 2020  _position=2,\n  
-00006e30: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
-00006e40: 2c5c 6e20 2020 206c 696d 6974 3d31 2c5c  ,\n    limit=1,\
-00006e50: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-00006e60: 2865 7665 6e74 7329 203d 3d20 315c 6e5c  (events) == 1\n\
-00006e70: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
-00006e80: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00006e90: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
-00006ea0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006eb0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00006ec0: 3d3d 2032 5c6e 6173 7365 7274 2065 7665  == 2\nassert eve
-00006ed0: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
-00006ee0: 7665 6e74 332e 7479 7065 5c6e 6173 7365  vent3.type\nasse
-00006ef0: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00006f00: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-00006f10: 5c6e 6060 605c 6e5c 6e54 6865 2060 7265  \n```\n\nThe `re
-00006f20: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00006f30: 2829 6020 6d65 7468 6f64 2077 696c 6c20  ()` method will 
-00006f40: 7261 6973 6520 6120 604e 6f74 466f 756e  raise a `NotFoun
-00006f50: 6460 2065 7863 6570 7469 6f6e 2069 6620  d` exception if 
-00006f60: 7468 6520 7374 7265 616d 5c6e 646f 6573  the stream\ndoes
-00006f70: 206e 6f74 2065 7869 7374 2e5c 6e5c 6e60   not exist.\n\n`
-00006f80: 6060 7079 7468 6f6e 5c6e 6672 6f6d 2065  ``python\nfrom e
-00006f90: 7364 6263 6c69 656e 742e 6578 6365 7074  sdbclient.except
-00006fa0: 696f 6e73 2069 6d70 6f72 7420 4e6f 7446  ions import NotF
-00006fb0: 6f75 6e64 5c6e 5c6e 5c6e 7472 793a 5c6e  ound\n\n\ntry:\n
-00006fc0: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
-00006fd0: 7374 7265 616d 5f65 7665 6e74 7328 5c27  stream_events(\'
-00006fe0: 6e6f 742d 612d 7374 7265 616d 5c27 295c  not-a-stream\')\
-00006ff0: 6e65 7863 6570 7420 4e6f 7446 6f75 6e64  nexcept NotFound
-00007000: 3a5c 6e20 2020 2070 6173 7320 2023 2054  :\n    pass  # T
-00007010: 6865 2073 7472 6561 6d20 5c27 6e6f 742d  he stream \'not-
-00007020: 612d 7374 7265 616d 5c27 2064 6f65 7320  a-stream\' does 
-00007030: 6e6f 7420 6578 6973 742e 5c6e 656c 7365  not exist.\nelse
-00007040: 3a5c 6e20 2020 2072 6169 7365 2045 7863  :\n    raise Exc
-00007050: 6570 7469 6f6e 2822 5368 6f75 6c64 6e5c  eption("Shouldn\
-00007060: 2774 2067 6574 2068 6572 6522 295c 6e60  't get here")\n`
-00007070: 6060 5c6e 5c6e 2323 2320 486f 7720 746f  ``\n\n### How to
-00007080: 2069 6d70 6c65 6d65 6e74 2073 6e61 7073   implement snaps
-00007090: 686f 7474 696e 6720 7769 7468 2045 7665  hotting with Eve
-000070a0: 6e74 5374 6f72 6544 425c 6e5c 6e45 7665  ntStoreDB\n\nEve
-000070b0: 6e74 2d73 6f75 7263 6564 2061 6767 7265  nt-sourced aggre
-000070c0: 6761 7465 7320 6172 6520 7479 7069 6361  gates are typica
-000070d0: 6c6c 7920 7265 636f 6e73 7472 7563 7465  lly reconstructe
-000070e0: 6420 6672 6f6d 2072 6563 6f72 6465 6420  d from recorded 
-000070f0: 6576 656e 7473 2062 7920 6361 6c6c 696e  events by callin
-00007100: 675c 6e61 206d 7574 6174 6f72 2066 756e  g\na mutator fun
-00007110: 6374 696f 6e20 666f 7220 6561 6368 2072  ction for each r
-00007120: 6563 6f72 6465 6420 6576 656e 742c 2065  ecorded event, e
-00007130: 766f 6c76 696e 6720 6672 6f6d 2061 6e20  volving from an 
-00007140: 696e 6974 6961 6c20 7374 6174 655c 6e60  initial state\n`
-00007150: 4e6f 6e65 6020 746f 2074 6865 2063 7572  None` to the cur
-00007160: 7265 6e74 2073 7461 7465 206f 6620 7468  rent state of th
-00007170: 6520 6167 6772 6567 6174 652e 2054 6865  e aggregate. The
-00007180: 2066 756e 6374 696f 6e20 6067 6574 5f61   function `get_a
-00007190: 6767 7265 6761 7465 2829 6020 7368 6f77  ggregate()` show
-000071a0: 735c 6e68 6f77 2074 6869 7320 6361 6e20  s\nhow this can 
-000071b0: 6265 2064 6f6e 652e 2054 6865 2061 6767  be done. The agg
-000071c0: 7265 6761 7465 2049 4420 6973 2075 7365  regate ID is use
-000071d0: 6420 6173 2061 2073 7472 6561 6d20 6e61  d as a stream na
-000071e0: 6d65 2e20 5468 6520 6578 6365 7074 696f  me. The exceptio
-000071f0: 6e5c 6e60 4167 6772 6567 6174 654e 6f74  n\n`AggregateNot
-00007200: 466f 756e 6460 2069 7320 7261 6973 6564  Found` is raised
-00007210: 2069 6620 7468 6520 6167 6772 6567 6174   if the aggregat
-00007220: 6520 7374 7265 616d 2069 7320 6e6f 7420  e stream is not 
-00007230: 666f 756e 642e 5c6e 5c6e 6060 6070 7974  found.\n\n```pyt
-00007240: 686f 6e5c 6e64 6566 2067 6574 5f61 6767  hon\ndef get_agg
-00007250: 7265 6761 7465 2861 6767 7265 6761 7465  regate(aggregate
-00007260: 5f69 642c 206d 7574 6174 6f72 5f66 756e  _id, mutator_fun
-00007270: 6329 3a5c 6e20 2020 2073 7472 6561 6d5f  c):\n    stream_
-00007280: 6e61 6d65 203d 2061 6767 7265 6761 7465  name = aggregate
-00007290: 5f69 645c 6e5c 6e20 2020 2023 2047 6574  _id\n\n    # Get
-000072a0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-000072b0: 2e5c 6e20 2020 2074 7279 3a5c 6e20 2020  .\n    try:\n   
-000072c0: 2020 2020 2065 7665 6e74 7320 3d20 636c       events = cl
-000072d0: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
-000072e0: 5f65 7665 6e74 7328 5c6e 2020 2020 2020  _events(\n      
-000072f0: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
-00007300: 653d 7374 7265 616d 5f6e 616d 652c 5c6e  e=stream_name,\n
-00007310: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-00007320: 616d 5f70 6f73 6974 696f 6e3d 4e6f 6e65  am_position=None
-00007330: 5c6e 2020 2020 2020 2020 295c 6e20 2020  \n        )\n   
-00007340: 2065 7863 6570 7420 4e6f 7446 6f75 6e64   except NotFound
-00007350: 2061 7320 653a 5c6e 2020 2020 2020 2020   as e:\n        
-00007360: 7261 6973 6520 4167 6772 6567 6174 654e  raise AggregateN
-00007370: 6f74 466f 756e 6428 6167 6772 6567 6174  otFound(aggregat
-00007380: 655f 6964 2920 6672 6f6d 2065 5c6e 2020  e_id) from e\n  
-00007390: 2020 656c 7365 3a5c 6e20 2020 2020 2020    else:\n       
-000073a0: 2023 2052 6563 6f6e 7374 7275 6374 2061   # Reconstruct a
-000073b0: 6767 7265 6761 7465 2066 726f 6d20 7265  ggregate from re
-000073c0: 636f 7264 6564 2065 7665 6e74 732e 5c6e  corded events.\n
-000073d0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-000073e0: 6520 3d20 4e6f 6e65 5c6e 2020 2020 2020  e = None\n      
-000073f0: 2020 666f 7220 6576 656e 7420 696e 2065    for event in e
-00007400: 7665 6e74 733a 5c6e 2020 2020 2020 2020  vents:\n        
-00007410: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
-00007420: 6d75 7461 746f 725f 6675 6e63 2861 6767  mutator_func(agg
-00007430: 7265 6761 7465 2c20 6576 656e 7429 5c6e  regate, event)\n
-00007440: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00007450: 6767 7265 6761 7465 5c6e 5c6e 5c6e 636c  ggregate\n\n\ncl
-00007460: 6173 7320 4167 6772 6567 6174 654e 6f74  ass AggregateNot
-00007470: 466f 756e 6428 4578 6365 7074 696f 6e29  Found(Exception)
-00007480: 3a5c 6e20 2020 2022 2222 5261 6973 6564  :\n    """Raised
-00007490: 2077 6865 6e20 616e 2061 6767 7265 6761   when an aggrega
-000074a0: 7465 2069 7320 6e6f 7420 666f 756e 642e  te is not found.
-000074b0: 2222 225c 6e60 6060 5c6e 5c6e 536e 6170  """\n```\n\nSnap
-000074c0: 7368 6f74 7320 6361 6e20 696d 7072 6f76  shots can improv
-000074d0: 6520 7468 6520 7065 7266 6f72 6d61 6e63  e the performanc
-000074e0: 6520 6f66 2061 6767 7265 6761 7465 7320  e of aggregates 
-000074f0: 7468 6174 2077 6f75 6c64 206f 7468 6572  that would other
-00007500: 7769 7365 2062 655c 6e72 6563 6f6e 7374  wise be\nreconst
-00007510: 7275 6374 6564 2066 726f 6d20 7665 7279  ructed from very
-00007520: 206c 6f6e 6720 7374 7265 616d 732e 2048   long streams. H
-00007530: 6f77 6576 6572 2c20 6974 2069 7320 6765  owever, it is ge
-00007540: 6e65 7261 6c6c 7920 7265 636f 6d6d 656e  nerally recommen
-00007550: 6465 6420 746f 5c6e 6465 7369 676e 2061  ded to\ndesign a
-00007560: 6767 7265 6761 7465 7320 746f 2068 6176  ggregates to hav
-00007570: 6520 6120 6669 6e69 7465 206c 6966 6563  e a finite lifec
-00007580: 7963 6c65 2c20 616e 6420 6865 6e63 6520  ycle, and hence 
-00007590: 7265 6c61 7469 7665 6c79 2073 686f 7274  relatively short
-000075a0: 2073 7472 6561 6d73 2c5c 6e74 6865 7265   streams,\nthere
-000075b0: 6279 2061 766f 6964 696e 6720 7468 6520  by avoiding the 
-000075c0: 6e65 6564 2066 6f72 2073 6e61 7073 686f  need for snapsho
-000075d0: 7474 696e 672e 2054 6869 7320 2268 6f77  tting. This "how
-000075e0: 2074 6f22 2073 6563 7469 6f6e 2069 7320   to" section is 
-000075f0: 696e 7465 6e64 6564 5c6e 6d65 7265 6c79  intended\nmerely
-00007600: 2074 6f20 7368 6f77 2068 6f77 2073 6e61   to show how sna
-00007610: 7073 686f 7474 696e 6720 6f66 2061 6767  pshotting of agg
-00007620: 7265 6761 7465 7320 6361 6e20 6265 2069  regates can be i
-00007630: 6d70 6c65 6d65 6e74 6564 2077 6974 6820  mplemented with 
-00007640: 4576 656e 7453 746f 7265 4442 5c6e 7573  EventStoreDB\nus
-00007650: 696e 6720 7468 6973 2050 7974 686f 6e20  ing this Python 
-00007660: 636c 6965 6e74 2e5c 6e5c 6e53 6e61 7073  client.\n\nSnaps
-00007670: 686f 7474 696e 6720 6f66 2061 6767 7265  hotting of aggre
-00007680: 6761 7465 7320 6361 6e20 6265 2069 6d70  gates can be imp
-00007690: 6c65 6d65 6e74 6564 2062 7920 7265 636f  lemented by reco
-000076a0: 7264 696e 6720 7468 6520 6375 7272 656e  rding the curren
-000076b0: 7420 7374 6174 6520 6f66 5c6e 616e 2061  t state of\nan a
-000076c0: 6767 7265 6761 7465 2061 7320 6120 6e65  ggregate as a ne
-000076d0: 7720 6576 656e 742e 5c6e 5c6e 4966 2061  w event.\n\nIf a
-000076e0: 6e20 6167 6772 6567 6174 6520 6f62 6a65  n aggregate obje
-000076f0: 6374 2068 6173 2061 2076 6572 7369 6f6e  ct has a version
-00007700: 206e 756d 6265 7220 7468 6174 2063 6f72   number that cor
-00007710: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
-00007720: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-00007730: 6f66 5c6e 7468 6520 6c61 7374 2065 7665  of\nthe last eve
-00007740: 6e74 2074 6861 7420 7761 7320 7573 6564  nt that was used
-00007750: 2074 6f20 7265 636f 6e73 7472 7563 7420   to reconstruct 
-00007760: 7468 6520 6167 6772 6567 6174 652c 2061  the aggregate, a
-00007770: 6e64 2074 6869 7320 7665 7273 696f 6e20  nd this version 
-00007780: 6e75 6d62 6572 5c6e 6973 2072 6563 6f72  number\nis recor
-00007790: 6465 6420 696e 2074 6865 2073 6e61 7073  ded in the snaps
-000077a0: 686f 7420 6d65 7461 6461 7461 2c20 7468  hot metadata, th
-000077b0: 656e 2061 6e79 2065 7665 6e74 7320 7468  en any events th
-000077c0: 6174 2061 7265 2072 6563 6f72 6465 6420  at are recorded 
-000077d0: 6166 7465 7220 7468 655c 6e73 6e61 7073  after the\nsnaps
-000077e0: 686f 7420 6361 6e20 6265 2073 656c 6563  hot can be selec
-000077f0: 7465 6420 7573 696e 6720 7468 6973 2076  ted using this v
-00007800: 6572 7369 6f6e 206e 756d 6265 722e 2054  ersion number. T
-00007810: 6865 2061 6767 7265 6761 7465 2063 616e  he aggregate can
-00007820: 2074 6865 6e20 6265 5c6e 7265 636f 6e73   then be\nrecons
-00007830: 7472 7563 7465 6420 6672 6f6d 2074 6865  tructed from the
-00007840: 206c 6173 7420 736e 6170 7368 6f74 2061   last snapshot a
-00007850: 6e64 2061 6e79 2073 7562 7365 7175 656e  nd any subsequen
-00007860: 7420 6576 656e 7473 2c20 7769 7468 6f75  t events, withou
-00007870: 7420 6861 7669 6e67 5c6e 746f 2072 6570  t having\nto rep
-00007880: 6c61 7920 7468 6520 656e 7469 7265 2068  lay the entire h
-00007890: 6973 746f 7279 2e5c 6e5c 6e57 6520 7769  istory.\n\nWe wi
-000078a0: 6c6c 2075 7365 2061 2073 6570 6172 6174  ll use a separat
-000078b0: 6520 7374 7265 616d 2066 6f72 2061 6e20  e stream for an 
-000078c0: 6167 6772 6567 6174 655c 2773 2073 6e61  aggregate\'s sna
-000078d0: 7073 686f 7473 2074 6861 7420 6973 206e  pshots that is n
-000078e0: 616d 6564 2061 6674 6572 2074 6865 5c6e  amed after the\n
-000078f0: 7374 7265 616d 2075 7365 6420 666f 7220  stream used for 
-00007900: 7265 636f 7264 696e 6720 6974 7320 6576  recording its ev
-00007910: 656e 7473 2e20 5468 6520 6e61 6d65 206f  ents. The name o
-00007920: 6620 7468 6520 736e 6170 7368 6f74 2073  f the snapshot s
-00007930: 7472 6561 6d20 7769 6c6c 2062 655c 6e63  tream will be\nc
-00007940: 6f6e 7374 7275 6374 6564 2062 7920 7072  onstructed by pr
-00007950: 6566 6978 696e 6720 7468 6520 6167 6772  efixing the aggr
-00007960: 6567 6174 655c 2773 2073 7472 6561 6d20  egate\'s stream 
-00007970: 6e61 6d65 2077 6974 6820 605c 2724 736e  name with `\'$sn
-00007980: 6170 7368 6f74 2d5c 2760 2e5c 6e5c 6e60  apshot-\'`.\n\n`
-00007990: 6060 7079 7468 6f6e 5c6e 534e 4150 5348  ``python\nSNAPSH
-000079a0: 4f54 5f50 5245 4649 5820 3d20 5c27 2473  OT_PREFIX = \'$s
-000079b0: 6e61 7073 686f 742d 5c27 5c6e 5c6e 6465  napshot-\'\n\nde
-000079c0: 6620 6d61 6b65 5f73 6e61 7073 686f 745f  f make_snapshot_
-000079d0: 7374 7265 616d 5f6e 616d 6528 7374 7265  stream_name(stre
-000079e0: 616d 5f6e 616d 6529 3a5c 6e20 2020 2072  am_name):\n    r
-000079f0: 6574 7572 6e20 665c 277b 534e 4150 5348  eturn f\'{SNAPSH
-00007a00: 4f54 5f50 5245 4649 587d 7b73 7472 6561  OT_PREFIX}{strea
-00007a10: 6d5f 6e61 6d65 7d5c 275c 6e5c 6e5c 6e64  m_name}\'\n\n\nd
-00007a20: 6566 2073 7472 6970 5f73 6e61 7073 686f  ef strip_snapsho
-00007a30: 745f 7374 7265 616d 5f6e 616d 6528 736e  t_stream_name(sn
-00007a40: 6170 7368 6f74 5f73 7472 6561 6d5f 6e61  apshot_stream_na
-00007a50: 6d65 293a 5c6e 2020 2020 7265 7475 726e  me):\n    return
-00007a60: 2073 6e61 7073 686f 745f 7374 7265 616d   snapshot_stream
-00007a70: 5f6e 616d 652e 6c73 7472 6970 2853 4e41  _name.lstrip(SNA
-00007a80: 5053 484f 545f 5052 4546 4958 295c 6e60  PSHOT_PREFIX)\n`
-00007a90: 6060 5c6e 5c6e 4c65 745c 2773 2072 6564  ``\n\nLet\'s red
-00007aa0: 6566 696e 6520 7468 6520 6067 6574 5f61  efine the `get_a
-00007ab0: 6767 7265 6761 7465 2829 6020 6675 6e63  ggregate()` func
-00007ac0: 7469 6f6e 2c20 736f 2074 6861 7420 6974  tion, so that it
-00007ad0: 206c 6f6f 6b73 2066 6f72 2061 2073 6e61   looks for a sna
-00007ae0: 7073 686f 7420 6576 656e 742c 5c6e 7468  pshot event,\nth
-00007af0: 656e 2073 656c 6563 7473 2073 7562 7365  en selects subse
-00007b00: 7175 656e 7420 6167 6772 6567 6174 6520  quent aggregate 
-00007b10: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
-00007b20: 2063 616c 6c73 2061 206d 7574 6174 6f72   calls a mutator
-00007b30: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
-00007b40: 6368 5c6e 7265 636f 7264 6564 2065 7665  ch\nrecorded eve
-00007b50: 6e74 2e20 5765 2077 696c 6c20 7573 6520  nt. We will use 
-00007b60: 4a53 4f4e 2074 6f20 7365 7269 616c 697a  JSON to serializ
-00007b70: 6520 616e 6420 6465 7365 7269 616c 697a  e and deserializ
-00007b80: 6520 5079 7468 6f6e 2060 6469 6374 6020  e Python `dict` 
-00007b90: 6f62 6a65 6374 732e 5c6e 5c6e 4e6f 7469  objects.\n\nNoti
-00007ba0: 6365 2074 6861 7420 7468 6520 6167 6772  ce that the aggr
-00007bb0: 6567 6174 6520 6576 656e 7473 2061 7265  egate events are
-00007bc0: 2072 6561 6420 6672 6f6d 2061 2073 7472   read from a str
-00007bd0: 6561 6d20 666f 7220 6167 6772 6567 6174  eam for aggregat
-00007be0: 655c 6e65 7665 6e74 732c 2077 6869 6c73  e\nevents, whils
-00007bf0: 7420 7468 6520 736e 6170 7368 6f74 2069  t the snapshot i
-00007c00: 7320 7265 6164 2066 726f 6d20 6120 7365  s read from a se
-00007c10: 7061 7261 7465 2073 7472 6561 6d20 666f  parate stream fo
-00007c20: 7220 6167 6772 6567 6174 6520 736e 6170  r aggregate snap
-00007c30: 7368 6f74 732e 5c6e 5c6e 6060 6070 7974  shots.\n\n```pyt
-00007c40: 686f 6e5c 6e69 6d70 6f72 7420 6a73 6f6e  hon\nimport json
-00007c50: 5c6e 5c6e 5c6e 6465 6620 6765 745f 6167  \n\n\ndef get_ag
-00007c60: 6772 6567 6174 6528 6167 6772 6567 6174  gregate(aggregat
-00007c70: 655f 6964 2c20 6d75 7461 746f 725f 6675  e_id, mutator_fu
-00007c80: 6e63 293a 5c6e 2020 2020 7374 7265 616d  nc):\n    stream
-00007c90: 5f6e 616d 6520 3d20 6167 6772 6567 6174  _name = aggregat
-00007ca0: 655f 6964 5c6e 2020 2020 7265 636f 7264  e_id\n    record
-00007cb0: 6564 5f65 7665 6e74 7320 3d20 5b5d 5c6e  ed_events = []\n
-00007cc0: 5c6e 2020 2020 2320 4c6f 6f6b 2066 6f72  \n    # Look for
-00007cd0: 2061 2073 6e61 7073 686f 742e 5c6e 2020   a snapshot.\n  
-00007ce0: 2020 7472 793a 5c6e 2020 2020 2020 2020    try:\n        
-00007cf0: 736e 6170 7368 6f74 7320 3d20 636c 6965  snapshots = clie
-00007d00: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
-00007d10: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
-00007d20: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-00007d30: 6d61 6b65 5f73 6e61 7073 686f 745f 7374  make_snapshot_st
-00007d40: 7265 616d 5f6e 616d 6528 7374 7265 616d  ream_name(stream
-00007d50: 5f6e 616d 6529 2c5c 6e20 2020 2020 2020  _name),\n       
-00007d60: 2020 2020 2062 6163 6b77 6172 6473 3d54       backwards=T
-00007d70: 7275 652c 5c6e 2020 2020 2020 2020 2020  rue,\n          
-00007d80: 2020 6c69 6d69 743d 315c 6e20 2020 2020    limit=1\n     
-00007d90: 2020 2029 5c6e 2020 2020 6578 6365 7074     )\n    except
-00007da0: 204e 6f74 466f 756e 643a 5c6e 2020 2020   NotFound:\n    
-00007db0: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
-00007dc0: 696f 6e20 3d20 4e6f 6e65 5c6e 2020 2020  ion = None\n    
-00007dd0: 656c 7365 3a5c 6e20 2020 2020 2020 2073  else:\n        s
-00007de0: 6e61 7073 686f 7420 3d20 736e 6170 7368  napshot = snapsh
-00007df0: 6f74 735b 305d 5c6e 2020 2020 2020 2020  ots[0]\n        
-00007e00: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00007e10: 3d20 6465 7365 7269 616c 697a 6528 736e  = deserialize(sn
-00007e20: 6170 7368 6f74 2e6d 6574 6164 6174 6129  apshot.metadata)
-00007e30: 5b5c 2776 6572 7369 6f6e 5c27 5d20 2b20  [\'version\'] + 
-00007e40: 315c 6e20 2020 2020 2020 2072 6563 6f72  1\n        recor
-00007e50: 6465 645f 6576 656e 7473 2e61 7070 656e  ded_events.appen
-00007e60: 6428 736e 6170 7368 6f74 295c 6e5c 6e20  d(snapshot)\n\n 
-00007e70: 2020 2023 2047 6574 2073 7562 7365 7175     # Get subsequ
-00007e80: 656e 7420 6576 656e 7473 2e5c 6e20 2020  ent events.\n   
-00007e90: 2074 7279 3a5c 6e20 2020 2020 2020 2065   try:\n        e
-00007ea0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-00007eb0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-00007ec0: 7328 5c6e 2020 2020 2020 2020 2020 2020  s(\n            
-00007ed0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00007ee0: 616d 5f6e 616d 652c 5c6e 2020 2020 2020  am_name,\n      
-00007ef0: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
-00007f00: 6974 696f 6e3d 7374 7265 616d 5f70 6f73  ition=stream_pos
-00007f10: 6974 696f 6e5c 6e20 2020 2020 2020 2029  ition\n        )
-00007f20: 5c6e 2020 2020 6578 6365 7074 204e 6f74  \n    except Not
-00007f30: 466f 756e 6420 6173 2065 3a5c 6e20 2020  Found as e:\n   
-00007f40: 2020 2020 2072 6169 7365 2041 6767 7265       raise Aggre
-00007f50: 6761 7465 4e6f 7446 6f75 6e64 2861 6767  gateNotFound(agg
-00007f60: 7265 6761 7465 5f69 6429 2066 726f 6d20  regate_id) from 
-00007f70: 655c 6e20 2020 2065 6c73 653a 5c6e 2020  e\n    else:\n  
-00007f80: 2020 2020 2020 7265 636f 7264 6564 5f65        recorded_e
-00007f90: 7665 6e74 7320 2b3d 2065 7665 6e74 735c  vents += events\
-00007fa0: 6e5c 6e20 2020 2023 2052 6563 6f6e 7374  n\n    # Reconst
-00007fb0: 7275 6374 2061 6767 7265 6761 7465 2066  ruct aggregate f
-00007fc0: 726f 6d20 7265 636f 7264 6564 2065 7665  rom recorded eve
-00007fd0: 6e74 732e 5c6e 2020 2020 6167 6772 6567  nts.\n    aggreg
-00007fe0: 6174 6520 3d20 4e6f 6e65 5c6e 2020 2020  ate = None\n    
-00007ff0: 666f 7220 6576 656e 7420 696e 2072 6563  for event in rec
-00008000: 6f72 6465 645f 6576 656e 7473 3a5c 6e20  orded_events:\n 
-00008010: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-00008020: 203d 206d 7574 6174 6f72 5f66 756e 6328   = mutator_func(
-00008030: 6167 6772 6567 6174 652c 2065 7665 6e74  aggregate, event
-00008040: 295c 6e5c 6e20 2020 2072 6574 7572 6e20  )\n\n    return 
-00008050: 6167 6772 6567 6174 655c 6e5c 6e5c 6e64  aggregate\n\n\nd
-00008060: 6566 2073 6572 6961 6c69 7a65 2864 293a  ef serialize(d):
-00008070: 5c6e 2020 2020 7265 7475 726e 206a 736f  \n    return jso
-00008080: 6e2e 6475 6d70 7328 6429 2e65 6e63 6f64  n.dumps(d).encod
-00008090: 6528 295c 6e5c 6e5c 6e64 6566 2064 6573  e()\n\n\ndef des
-000080a0: 6572 6961 6c69 7a65 2873 293a 5c6e 2020  erialize(s):\n  
-000080b0: 2020 7265 7475 726e 206a 736f 6e2e 6c6f    return json.lo
-000080c0: 6164 7328 732e 6465 636f 6465 2829 295c  ads(s.decode())\
-000080d0: 6e60 6060 5c6e 5c6e 546f 2073 686f 7720  n```\n\nTo show 
-000080e0: 686f 7720 7468 6973 2063 616e 2062 6520  how this can be 
-000080f0: 7573 6564 2c20 6c65 745c 2773 2064 6566  used, let\'s def
-00008100: 696e 6520 616e 2022 696d 6d75 7461 626c  ine an "immutabl
-00008110: 6522 2060 446f 6760 2061 6767 7265 6761  e" `Dog` aggrega
-00008120: 7465 2063 6c61 7373 2c20 7769 7468 5c6e  te class, with\n
-00008130: 6174 7472 6962 7574 6573 2060 6e61 6d65  attributes `name
-00008140: 6020 616e 6420 6074 7269 636b 7360 2e20  ` and `tricks`. 
-00008150: 5468 6520 6174 7472 6962 7574 6573 2060  The attributes `
-00008160: 6964 6020 616e 6420 6076 6572 7369 6f6e  id` and `version
-00008170: 6020 7769 6c6c 2069 6e64 6963 6174 6520  ` will indicate 
-00008180: 616e 5c6e 6167 6772 6567 6174 6520 6f62  an\naggregate ob
-00008190: 6a65 6374 5c27 7320 4944 2061 6e64 2076  ject\'s ID and v
-000081a0: 6572 7369 6f6e 206e 756d 6265 722e 2054  ersion number. T
-000081b0: 6865 2061 7474 7269 6275 7465 2060 6973  he attribute `is
-000081c0: 5f66 726f 6d5f 736e 6170 7368 6f74 6020  _from_snapshot` 
-000081d0: 6973 2061 6464 6564 5c6e 6865 7265 206d  is added\nhere m
-000081e0: 6572 656c 7920 746f 2064 656d 6f6e 7374  erely to demonst
-000081f0: 7261 7465 2062 656c 6f77 2077 6865 6e20  rate below when 
-00008200: 616e 2061 6767 7265 6761 7465 206f 626a  an aggregate obj
-00008210: 6563 7420 6861 7320 6265 656e 2072 6563  ect has been rec
-00008220: 6f6e 7374 7275 6374 6564 2075 7369 6e67  onstructed using
-00008230: 5c6e 6120 736e 6170 7368 6f74 2e5c 6e5c  \na snapshot.\n\
-00008240: 6e60 6060 7079 7468 6f6e 5c6e 6672 6f6d  n```python\nfrom
-00008250: 2064 6174 6163 6c61 7373 6573 2069 6d70   dataclasses imp
-00008260: 6f72 7420 6461 7461 636c 6173 735c 6e5c  ort dataclass\n\
-00008270: 6e5c 6e40 6461 7461 636c 6173 7328 6672  n\n@dataclass(fr
-00008280: 6f7a 656e 3d54 7275 6529 5c6e 636c 6173  ozen=True)\nclas
-00008290: 7320 4167 6772 6567 6174 653a 5c6e 2020  s Aggregate:\n  
-000082a0: 2020 6964 3a20 7374 725c 6e20 2020 2076    id: str\n    v
-000082b0: 6572 7369 6f6e 3a20 696e 745c 6e20 2020  ersion: int\n   
-000082c0: 2069 735f 6672 6f6d 5f73 6e61 7073 686f   is_from_snapsho
-000082d0: 743a 2062 6f6f 6c5c 6e5c 6e5c 6e40 6461  t: bool\n\n\n@da
-000082e0: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
-000082f0: 7275 6529 5c6e 636c 6173 7320 446f 6728  rue)\nclass Dog(
-00008300: 4167 6772 6567 6174 6529 3a5c 6e20 2020  Aggregate):\n   
-00008310: 206e 616d 653a 2073 7472 5c6e 2020 2020   name: str\n    
-00008320: 7472 6963 6b73 3a20 6c69 7374 5c6e 5c6e  tricks: list\n\n
-00008330: 6060 605c 6e5c 6e4c 6574 5c27 7320 616c  ```\n\nLet\'s al
-00008340: 736f 2064 6566 696e 6520 6120 6d75 7461  so define a muta
-00008350: 746f 7220 6675 6e63 7469 6f6e 2060 6d75  tor function `mu
-00008360: 7461 7465 5f64 6f67 2829 6020 7468 6174  tate_dog()` that
-00008370: 2063 616e 2065 766f 6c76 6520 7468 6520   can evolve the 
-00008380: 7374 6174 6520 6f66 2061 5c6e 6044 6f67  state of a\n`Dog
-00008390: 6020 6167 6772 6567 6174 6520 6769 7665  ` aggregate give
-000083a0: 6e20 7661 7269 6f75 7320 6469 6666 6572  n various differ
-000083b0: 656e 7420 7479 7065 7320 6f66 2065 7665  ent types of eve
-000083c0: 6e74 732c 2060 5c27 446f 6752 6567 6973  nts, `\'DogRegis
-000083d0: 7465 7265 645c 2760 2c5c 6e60 5c27 446f  tered\'`,\n`\'Do
-000083e0: 674c 6561 726e 6564 5472 6963 6b5c 2760  gLearnedTrick\'`
-000083f0: 2c20 616e 6420 605c 2724 536e 6170 7368  , and `\'$Snapsh
-00008400: 6f74 605c 272e 2054 6865 2073 6e61 7073  ot`\'. The snaps
-00008410: 686f 7420 6576 656e 7420 7479 7065 2069  hot event type i
-00008420: 7320 7072 6566 6978 6564 2077 6974 685c  s prefixed with\
-00008430: 6e60 5c27 245c 2760 2073 6f20 7468 6174  n`\'$\'` so that
-00008440: 2069 7420 6361 6e20 6265 2066 696c 7465   it can be filte
-00008450: 7265 6420 6f75 7420 7768 656e 2072 6561  red out when rea
-00008460: 6469 6e67 2061 6c6c 2065 7665 6e74 7320  ding all events 
-00008470: 6672 6f6d 2074 6865 2064 6174 6162 6173  from the databas
-00008480: 652e 5c6e 5c6e 6060 6070 7974 686f 6e5c  e.\n\n```python\
-00008490: 6e64 6566 206d 7574 6174 655f 646f 6728  ndef mutate_dog(
-000084a0: 646f 672c 2065 7665 6e74 293a 5c6e 2020  dog, event):\n  
-000084b0: 2020 6461 7461 203d 2064 6573 6572 6961    data = deseria
-000084c0: 6c69 7a65 2865 7665 6e74 2e64 6174 6129  lize(event.data)
-000084d0: 5c6e 2020 2020 6966 2065 7665 6e74 2e74  \n    if event.t
-000084e0: 7970 6520 3d3d 205c 2744 6f67 5265 6769  ype == \'DogRegi
-000084f0: 7374 6572 6564 5c27 3a5c 6e20 2020 2020  stered\':\n     
-00008500: 2020 2072 6574 7572 6e20 446f 6728 5c6e     return Dog(\n
-00008510: 2020 2020 2020 2020 2020 2020 6964 3d65              id=e
-00008520: 7665 6e74 2e73 7472 6561 6d5f 6e61 6d65  vent.stream_name
-00008530: 2c5c 6e20 2020 2020 2020 2020 2020 2076  ,\n            v
-00008540: 6572 7369 6f6e 3d65 7665 6e74 2e73 7472  ersion=event.str
-00008550: 6561 6d5f 706f 7369 7469 6f6e 2c5c 6e20  eam_position,\n 
-00008560: 2020 2020 2020 2020 2020 2069 735f 6672             is_fr
-00008570: 6f6d 5f73 6e61 7073 686f 743d 4661 6c73  om_snapshot=Fals
-00008580: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
-00008590: 6e61 6d65 3d64 6174 615b 5c27 6e61 6d65  name=data[\'name
-000085a0: 5c27 5d2c 5c6e 2020 2020 2020 2020 2020  \'],\n          
-000085b0: 2020 7472 6963 6b73 3d5b 5d2c 5c6e 2020    tricks=[],\n  
-000085c0: 2020 2020 2020 295c 6e20 2020 2065 6c69        )\n    eli
-000085d0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
-000085e0: 5c27 446f 674c 6561 726e 6564 5472 6963  \'DogLearnedTric
-000085f0: 6b5c 273a 5c6e 2020 2020 2020 2020 6173  k\':\n        as
-00008600: 7365 7274 2065 7665 6e74 2e73 7472 6561  sert event.strea
-00008610: 6d5f 706f 7369 7469 6f6e 203d 3d20 646f  m_position == do
-00008620: 672e 7665 7273 696f 6e20 2b20 315c 6e20  g.version + 1\n 
-00008630: 2020 2020 2020 2061 7373 6572 7420 6576         assert ev
-00008640: 656e 742e 7374 7265 616d 5f6e 616d 6520  ent.stream_name 
-00008650: 3d3d 2064 6f67 2e69 645c 6e20 2020 2020  == dog.id\n     
-00008660: 2020 2072 6574 7572 6e20 446f 6728 5c6e     return Dog(\n
-00008670: 2020 2020 2020 2020 2020 2020 6964 3d64              id=d
-00008680: 6f67 2e69 642c 5c6e 2020 2020 2020 2020  og.id,\n        
-00008690: 2020 2020 7665 7273 696f 6e3d 6576 656e      version=even
-000086a0: 742e 7374 7265 616d 5f70 6f73 6974 696f  t.stream_positio
-000086b0: 6e2c 5c6e 2020 2020 2020 2020 2020 2020  n,\n            
-000086c0: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-000086d0: 3d64 6f67 2e69 735f 6672 6f6d 5f73 6e61  =dog.is_from_sna
-000086e0: 7073 686f 742c 5c6e 2020 2020 2020 2020  pshot,\n        
-000086f0: 2020 2020 6e61 6d65 3d64 6f67 2e6e 616d      name=dog.nam
-00008700: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
-00008710: 7472 6963 6b73 3d64 6f67 2e74 7269 636b  tricks=dog.trick
-00008720: 7320 2b20 5b64 6174 615b 5c27 7472 6963  s + [data[\'tric
-00008730: 6b5c 275d 5d2c 5c6e 2020 2020 2020 2020  k\']],\n        
-00008740: 295c 6e20 2020 2065 6c69 6620 6576 656e  )\n    elif even
-00008750: 742e 7479 7065 203d 3d20 5c27 2453 6e61  t.type == \'$Sna
-00008760: 7073 686f 745c 273a 5c6e 2020 2020 2020  pshot\':\n      
-00008770: 2020 7265 7475 726e 2044 6f67 285c 6e20    return Dog(\n 
-00008780: 2020 2020 2020 2020 2020 2069 643d 7374             id=st
-00008790: 7269 705f 736e 6170 7368 6f74 5f73 7472  rip_snapshot_str
-000087a0: 6561 6d5f 6e61 6d65 2865 7665 6e74 2e73  eam_name(event.s
-000087b0: 7472 6561 6d5f 6e61 6d65 292c 5c6e 2020  tream_name),\n  
-000087c0: 2020 2020 2020 2020 2020 7665 7273 696f            versio
-000087d0: 6e3d 6465 7365 7269 616c 697a 6528 6576  n=deserialize(ev
-000087e0: 656e 742e 6d65 7461 6461 7461 295b 5c27  ent.metadata)[\'
-000087f0: 7665 7273 696f 6e5c 275d 2c5c 6e20 2020  version\'],\n   
-00008800: 2020 2020 2020 2020 2069 735f 6672 6f6d           is_from
-00008810: 5f73 6e61 7073 686f 743d 5472 7565 2c5c  _snapshot=True,\
-00008820: 6e20 2020 2020 2020 2020 2020 206e 616d  n            nam
-00008830: 653d 6461 7461 5b5c 276e 616d 655c 275d  e=data[\'name\']
-00008840: 2c5c 6e20 2020 2020 2020 2020 2020 2074  ,\n            t
-00008850: 7269 636b 733d 6461 7461 5b5c 2774 7269  ricks=data[\'tri
-00008860: 636b 735c 275d 2c5c 6e20 2020 2020 2020  cks\'],\n       
-00008870: 2029 5c6e 2020 2020 656c 7365 3a5c 6e20   )\n    else:\n 
-00008880: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-00008890: 6570 7469 6f6e 2866 2255 6e6b 6e6f 776e  eption(f"Unknown
-000088a0: 2065 7665 6e74 2074 7970 653a 207b 6576   event type: {ev
-000088b0: 656e 742e 7479 7065 7d22 295c 6e60 6060  ent.type}")\n```
-000088c0: 5c6e 5c6e 466f 7220 636f 6e76 656e 6965  \n\nFor convenie
-000088d0: 6e63 652c 206c 6574 5c27 7320 616c 736f  nce, let\'s also
-000088e0: 2064 6566 696e 6520 6120 6067 6574 5f64   define a `get_d
-000088f0: 6f67 2829 6020 6675 6e63 7469 6f6e 2074  og()` function t
-00008900: 6861 7420 6361 6c6c 7320 6067 6574 5f61  hat calls `get_a
-00008910: 6767 7265 6761 7465 2829 605c 6e77 6974  ggregate()`\nwit
-00008920: 6820 7468 6520 606d 7574 6174 655f 646f  h the `mutate_do
-00008930: 6728 2960 2066 756e 6374 696f 6e20 6173  g()` function as
-00008940: 2074 6865 2060 6d75 7461 746f 725f 6675   the `mutator_fu
-00008950: 6e63 6020 6172 6775 6d65 6e74 2e5c 6e5c  nc` argument.\n\
-00008960: 6e60 6060 7079 7468 6f6e 5c6e 6465 6620  n```python\ndef 
-00008970: 6765 745f 646f 6728 646f 675f 6964 293a  get_dog(dog_id):
-00008980: 5c6e 2020 2020 7265 7475 726e 2067 6574  \n    return get
-00008990: 5f61 6767 7265 6761 7465 285c 6e20 2020  _aggregate(\n   
-000089a0: 2020 2020 2061 6767 7265 6761 7465 5f69       aggregate_i
-000089b0: 643d 646f 675f 6964 2c5c 6e20 2020 2020  d=dog_id,\n     
-000089c0: 2020 206d 7574 6174 6f72 5f66 756e 633d     mutator_func=
-000089d0: 6d75 7461 7465 5f64 6f67 2c5c 6e20 2020  mutate_dog,\n   
-000089e0: 2029 5c6e 6060 605c 6e5c 6e57 6520 6361   )\n```\n\nWe ca
-000089f0: 6e20 616c 736f 2064 6566 696e 6520 736f  n also define so
-00008a00: 6d65 2022 636f 6d6d 616e 6422 2066 756e  me "command" fun
-00008a10: 6374 696f 6e73 2074 6861 7420 6170 7065  ctions that appe
-00008a20: 6e64 206e 6577 2065 7665 6e74 7320 746f  nd new events to
-00008a30: 2074 6865 5c6e 6461 7461 6261 7365 2e20   the\ndatabase. 
-00008a40: 5468 6520 6072 6567 6973 7465 725f 646f  The `register_do
-00008a50: 6728 2960 2066 756e 6374 696f 6e20 6170  g()` function ap
-00008a60: 7065 6e64 7320 6120 6044 6f67 5265 6769  pends a `DogRegi
-00008a70: 7374 6572 6564 6020 6576 656e 742e 2054  stered` event. T
-00008a80: 6865 5c6e 6072 6563 6f72 645f 7472 6963  he\n`record_tric
-00008a90: 6b5f 6c65 6172 6e65 6428 2960 2061 7070  k_learned()` app
-00008aa0: 656e 6473 2061 2060 446f 674c 6561 726e  ends a `DogLearn
-00008ab0: 6564 5472 6963 6b60 2065 7665 6e74 2e20  edTrick` event. 
-00008ac0: 5468 6520 6675 6e63 7469 6f6e 5c6e 6073  The function\n`s
-00008ad0: 6e61 7073 686f 745f 646f 6728 2960 2061  napshot_dog()` a
-00008ae0: 7070 656e 6473 2061 2060 2453 6e61 7073  ppends a `$Snaps
-00008af0: 686f 7460 2065 7665 6e74 2e20 4e6f 7469  hot` event. Noti
-00008b00: 6365 2074 6861 7420 7468 655c 6e60 7265  ce that the\n`re
-00008b10: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
-00008b20: 6564 2829 6020 616e 6420 6073 6e61 7073  ed()` and `snaps
-00008b30: 686f 745f 646f 6728 2960 2066 756e 6374  hot_dog()` funct
-00008b40: 696f 6e73 2075 7365 2060 6765 745f 646f  ions use `get_do
-00008b50: 6728 2960 2e5c 6e5c 6e4e 6f74 6963 6520  g()`.\n\nNotice 
-00008b60: 616c 736f 2074 6861 7420 7468 6520 6044  also that the `D
-00008b70: 6f67 5265 6769 7374 6572 6564 6020 616e  ogRegistered` an
-00008b80: 6420 6044 6f67 4c65 6172 6e65 6454 7269  d `DogLearnedTri
-00008b90: 636b 6020 6576 656e 7473 2061 7265 2061  ck` events are a
-00008ba0: 7070 656e 6465 6420 746f 2061 5c6e 7374  ppended to a\nst
-00008bb0: 7265 616d 2066 6f72 2061 6767 7265 6761  ream for aggrega
-00008bc0: 7465 2065 7665 6e74 732c 2077 6869 6c73  te events, whils
-00008bd0: 7420 7468 6520 6024 536e 6170 7368 6f74  t the `$Snapshot
-00008be0: 6020 6973 2061 7070 656e 6465 6420 746f  ` is appended to
-00008bf0: 2061 2073 6570 6172 6174 6520 7374 7265   a separate stre
-00008c00: 616d 5c6e 666f 7220 6167 6772 6567 6174  am\nfor aggregat
-00008c10: 6520 736e 6170 7368 6f74 732e 2054 6865  e snapshots. The
-00008c20: 2073 6e61 7073 686f 7420 6576 656e 7420   snapshot event 
-00008c30: 7479 7065 2069 7320 7072 6566 6978 6564  type is prefixed
-00008c40: 2077 6974 6820 605c 2724 5c27 6020 736f   with `\'$\'` so
-00008c50: 2074 6861 7420 6974 2063 616e 5c6e 6265   that it can\nbe
-00008c60: 2066 696c 7465 7265 6420 6f75 7420 7768   filtered out wh
-00008c70: 656e 2072 6561 6469 6e67 2061 6c6c 2065  en reading all e
-00008c80: 7665 6e74 7320 6672 6f6d 2074 6865 2064  vents from the d
-00008c90: 6174 6162 6173 652e 5c6e 5c6e 6060 6070  atabase.\n\n```p
-00008ca0: 7974 686f 6e5c 6e64 6566 2072 6567 6973  ython\ndef regis
-00008cb0: 7465 725f 646f 6728 6e61 6d65 293a 5c6e  ter_dog(name):\n
-00008cc0: 2020 2020 646f 675f 6964 203d 2073 7472      dog_id = str
-00008cd0: 2875 7569 6434 2829 295c 6e20 2020 2065  (uuid4())\n    e
-00008ce0: 7665 6e74 203d 204e 6577 4576 656e 7428  vent = NewEvent(
-00008cf0: 5c6e 2020 2020 2020 2020 7479 7065 3d5c  \n        type=\
-00008d00: 2744 6f67 5265 6769 7374 6572 6564 5c27  'DogRegistered\'
-00008d10: 2c5c 6e20 2020 2020 2020 2064 6174 613d  ,\n        data=
-00008d20: 7365 7269 616c 697a 6528 7b5c 276e 616d  serialize({\'nam
-00008d30: 655c 273a 206e 616d 657d 292c 5c6e 2020  e\': name}),\n  
-00008d40: 2020 295c 6e20 2020 2063 6c69 656e 742e    )\n    client.
-00008d50: 6170 7065 6e64 5f65 7665 6e74 285c 6e20  append_event(\n 
-00008d60: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
-00008d70: 6d65 3d64 6f67 5f69 642c 5c6e 2020 2020  me=dog_id,\n    
-00008d80: 2020 2020 6578 7065 6374 6564 5f70 6f73      expected_pos
-00008d90: 6974 696f 6e3d 4e6f 6e65 2c5c 6e20 2020  ition=None,\n   
-00008da0: 2020 2020 2065 7665 6e74 3d65 7665 6e74       event=event
-00008db0: 2c5c 6e20 2020 2029 5c6e 2020 2020 7265  ,\n    )\n    re
-00008dc0: 7475 726e 2064 6f67 5f69 645c 6e5c 6e5c  turn dog_id\n\n\
-00008dd0: 6e64 6566 2072 6563 6f72 645f 7472 6963  ndef record_tric
-00008de0: 6b5f 6c65 6172 6e65 6428 646f 675f 6964  k_learned(dog_id
-00008df0: 2c20 7472 6963 6b29 3a5c 6e20 2020 2064  , trick):\n    d
-00008e00: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
-00008e10: 5f69 6429 5c6e 2020 2020 6576 656e 7420  _id)\n    event 
-00008e20: 3d20 4e65 7745 7665 6e74 285c 6e20 2020  = NewEvent(\n   
-00008e30: 2020 2020 2074 7970 653d 5c27 446f 674c       type=\'DogL
-00008e40: 6561 726e 6564 5472 6963 6b5c 272c 5c6e  earnedTrick\',\n
-00008e50: 2020 2020 2020 2020 6461 7461 3d73 6572          data=ser
-00008e60: 6961 6c69 7a65 287b 5c27 7472 6963 6b5c  ialize({\'trick\
-00008e70: 273a 2074 7269 636b 7d29 2c5c 6e20 2020  ': trick}),\n   
-00008e80: 2029 5c6e 2020 2020 636c 6965 6e74 2e61   )\n    client.a
-00008e90: 7070 656e 645f 6576 656e 7428 5c6e 2020  ppend_event(\n  
-00008ea0: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
-00008eb0: 653d 646f 675f 6964 2c5c 6e20 2020 2020  e=dog_id,\n     
-00008ec0: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-00008ed0: 7469 6f6e 3d64 6f67 2e76 6572 7369 6f6e  tion=dog.version
-00008ee0: 2c5c 6e20 2020 2020 2020 2065 7665 6e74  ,\n        event
-00008ef0: 3d65 7665 6e74 2c5c 6e20 2020 2029 5c6e  =event,\n    )\n
-00008f00: 5c6e 5c6e 6465 6620 736e 6170 7368 6f74  \n\ndef snapshot
-00008f10: 5f64 6f67 2864 6f67 5f69 6429 3a5c 6e20  _dog(dog_id):\n 
-00008f20: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
-00008f30: 2864 6f67 5f69 6429 5c6e 2020 2020 6576  (dog_id)\n    ev
-00008f40: 656e 7420 3d20 4e65 7745 7665 6e74 285c  ent = NewEvent(\
-00008f50: 6e20 2020 2020 2020 2074 7970 653d 5c27  n        type=\'
-00008f60: 2453 6e61 7073 686f 745c 272c 5c6e 2020  $Snapshot\',\n  
-00008f70: 2020 2020 2020 6461 7461 3d73 6572 6961        data=seria
-00008f80: 6c69 7a65 287b 5c27 6e61 6d65 5c27 3a20  lize({\'name\': 
-00008f90: 646f 672e 6e61 6d65 2c20 5c27 7472 6963  dog.name, \'tric
-00008fa0: 6b73 5c27 3a20 646f 672e 7472 6963 6b73  ks\': dog.tricks
-00008fb0: 7d29 2c5c 6e20 2020 2020 2020 206d 6574  }),\n        met
-00008fc0: 6164 6174 613d 7365 7269 616c 697a 6528  adata=serialize(
-00008fd0: 7b5c 2776 6572 7369 6f6e 5c27 3a20 646f  {\'version\': do
-00008fe0: 672e 7665 7273 696f 6e7d 292c 5c6e 2020  g.version}),\n  
-00008ff0: 2020 295c 6e20 2020 2063 6c69 656e 742e    )\n    client.
-00009000: 6170 7065 6e64 5f65 7665 6e74 285c 6e20  append_event(\n 
-00009010: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
-00009020: 6d65 3d6d 616b 655f 736e 6170 7368 6f74  me=make_snapshot
-00009030: 5f73 7472 6561 6d5f 6e61 6d65 2864 6f67  _stream_name(dog
-00009040: 5f69 6429 2c5c 6e20 2020 2020 2020 2065  _id),\n        e
-00009050: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00009060: 3d2d 312c 5c6e 2020 2020 2020 2020 6576  =-1,\n        ev
-00009070: 656e 743d 6576 656e 742c 5c6e 2020 2020  ent=event,\n    
-00009080: 295c 6e60 6060 5c6e 5c6e 4e6f 7720 7765  )\n```\n\nNow we
-00009090: 2063 616e 2072 6567 6973 7465 7220 6120   can register a 
-000090a0: 6e65 7720 646f 672c 2061 6e64 2072 6563  new dog, and rec
-000090b0: 6f72 6420 7468 6174 2073 6f6d 6520 7472  ord that some tr
-000090c0: 6963 6b73 2068 6176 6520 6265 656e 206c  icks have been l
-000090d0: 6561 726e 6564 2e5c 6e5c 6e60 6060 7079  earned.\n\n```py
-000090e0: 7468 6f6e 5c6e 2320 5265 6769 7374 6572  thon\n# Register
-000090f0: 2061 206e 6577 2064 6f67 2e5c 6e64 6f67   a new dog.\ndog
-00009100: 5f69 6420 3d20 7265 6769 7374 6572 5f64  _id = register_d
-00009110: 6f67 285c 2746 6964 6f5c 2729 5c6e 5c6e  og(\'Fido\')\n\n
-00009120: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
-00009130: 675f 6964 295c 6e61 7373 6572 7420 646f  g_id)\nassert do
-00009140: 672e 6e61 6d65 203d 3d20 5c27 4669 646f  g.name == \'Fido
-00009150: 5c27 5c6e 6173 7365 7274 2064 6f67 2e74  \'\nassert dog.t
-00009160: 7269 636b 7320 3d3d 205b 5d5c 6e61 7373  ricks == []\nass
-00009170: 6572 7420 646f 672e 7665 7273 696f 6e20  ert dog.version 
-00009180: 3d3d 2030 5c6e 6173 7365 7274 2064 6f67  == 0\nassert dog
-00009190: 2e69 735f 6672 6f6d 5f73 6e61 7073 686f  .is_from_snapsho
-000091a0: 7420 6973 2046 616c 7365 5c6e 5c6e 5c6e  t is False\n\n\n
-000091b0: 2320 5265 636f 7264 2074 6861 7420 5c27  # Record that \'
-000091c0: 4669 646f 5c27 206c 6561 726e 6564 2061  Fido\' learned a
-000091d0: 206e 6577 2074 7269 636b 2e5c 6e72 6563   new trick.\nrec
-000091e0: 6f72 645f 7472 6963 6b5f 6c65 6172 6e65  ord_trick_learne
-000091f0: 6428 646f 675f 6964 2c20 7472 6963 6b3d  d(dog_id, trick=
-00009200: 5c27 726f 6c6c 206f 7665 725c 2729 5c6e  \'roll over\')\n
-00009210: 5c6e 646f 6720 3d20 6765 745f 646f 6728  \ndog = get_dog(
-00009220: 646f 675f 6964 295c 6e61 7373 6572 7420  dog_id)\nassert 
-00009230: 646f 672e 6e61 6d65 203d 3d20 5c27 4669  dog.name == \'Fi
-00009240: 646f 5c27 5c6e 6173 7365 7274 2064 6f67  do\'\nassert dog
-00009250: 2e74 7269 636b 7320 3d3d 205b 5c27 726f  .tricks == [\'ro
-00009260: 6c6c 206f 7665 725c 275d 5c6e 6173 7365  ll over\']\nasse
-00009270: 7274 2064 6f67 2e76 6572 7369 6f6e 203d  rt dog.version =
-00009280: 3d20 315c 6e61 7373 6572 7420 646f 672e  = 1\nassert dog.
-00009290: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-000092a0: 2069 7320 4661 6c73 655c 6e5c 6e5c 6e23   is False\n\n\n#
-000092b0: 2052 6563 6f72 6420 7468 6174 205c 2746   Record that \'F
-000092c0: 6964 6f5c 2720 6c65 6172 6e65 6420 616e  ido\' learned an
-000092d0: 6f74 6865 7220 6e65 7720 7472 6963 6b2e  other new trick.
-000092e0: 5c6e 7265 636f 7264 5f74 7269 636b 5f6c  \nrecord_trick_l
-000092f0: 6561 726e 6564 2864 6f67 5f69 642c 2074  earned(dog_id, t
-00009300: 7269 636b 3d5c 2766 6574 6368 2062 616c  rick=\'fetch bal
-00009310: 6c5c 2729 5c6e 5c6e 646f 6720 3d20 6765  l\')\n\ndog = ge
-00009320: 745f 646f 6728 646f 675f 6964 295c 6e61  t_dog(dog_id)\na
-00009330: 7373 6572 7420 646f 672e 6e61 6d65 203d  ssert dog.name =
-00009340: 3d20 5c27 4669 646f 5c27 5c6e 6173 7365  = \'Fido\'\nasse
-00009350: 7274 2064 6f67 2e74 7269 636b 7320 3d3d  rt dog.tricks ==
-00009360: 205b 5c27 726f 6c6c 206f 7665 725c 272c   [\'roll over\',
-00009370: 205c 2766 6574 6368 2062 616c 6c5c 275d   \'fetch ball\']
-00009380: 5c6e 6173 7365 7274 2064 6f67 2e76 6572  \nassert dog.ver
-00009390: 7369 6f6e 203d 3d20 325c 6e61 7373 6572  sion == 2\nasser
-000093a0: 7420 646f 672e 6973 5f66 726f 6d5f 736e  t dog.is_from_sn
-000093b0: 6170 7368 6f74 2069 7320 4661 6c73 655c  apshot is False\
-000093c0: 6e60 6060 5c6e 5c6e 4166 7465 7220 7765  n```\n\nAfter we
-000093d0: 2063 616c 6c20 6073 6e61 7073 686f 745f   call `snapshot_
-000093e0: 646f 6728 2960 2c20 7468 6520 6067 6574  dog()`, the `get
-000093f0: 5f64 6f67 2829 6020 6675 6e63 7469 6f6e  _dog()` function
-00009400: 2077 696c 6c20 7265 7475 726e 2061 2060   will return a `
-00009410: 446f 6760 5c6e 6f62 6a65 6374 2074 6861  Dog`\nobject tha
-00009420: 7420 6861 7320 6265 656e 2063 6f6e 7374  t has been const
-00009430: 7275 6374 6564 2075 7369 6e67 2074 6865  ructed using the
-00009440: 2060 2453 6e61 7073 686f 7460 2065 7665   `$Snapshot` eve
-00009450: 6e74 2e5c 6e5c 6e60 6060 7079 7468 6f6e  nt.\n\n```python
-00009460: 5c6e 2320 536e 6170 7368 6f74 205c 2746  \n# Snapshot \'F
-00009470: 6964 6f5c 272e 5c6e 736e 6170 7368 6f74  ido\'.\nsnapshot
-00009480: 5f64 6f67 2864 6f67 5f69 6429 5c6e 5c6e  _dog(dog_id)\n\n
-00009490: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
-000094a0: 675f 6964 295c 6e61 7373 6572 7420 646f  g_id)\nassert do
-000094b0: 672e 6e61 6d65 203d 3d20 5c27 4669 646f  g.name == \'Fido
-000094c0: 5c27 5c6e 6173 7365 7274 2064 6f67 2e74  \'\nassert dog.t
-000094d0: 7269 636b 7320 3d3d 205b 5c27 726f 6c6c  ricks == [\'roll
-000094e0: 206f 7665 725c 272c 205c 2766 6574 6368   over\', \'fetch
-000094f0: 2062 616c 6c5c 275d 5c6e 6173 7365 7274   ball\']\nassert
-00009500: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
-00009510: 325c 6e61 7373 6572 7420 646f 672e 6973  2\nassert dog.is
-00009520: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
-00009530: 7320 5472 7565 5c6e 6060 605c 6e5c 6e57  s True\n```\n\nW
-00009540: 6520 6361 6e20 636f 6e74 696e 7565 2074  e can continue t
-00009550: 6f20 6576 6f6c 7665 2074 6865 2073 7461  o evolve the sta
-00009560: 7465 206f 6620 7468 6520 6044 6f67 6020  te of the `Dog` 
-00009570: 6167 6772 6567 6174 652c 2075 7369 6e67  aggregate, using
-00009580: 5c6e 7468 6520 736e 6170 7368 6f74 2062  \nthe snapshot b
-00009590: 6f74 6820 6475 7269 6e67 2074 6865 2063  oth during the c
-000095a0: 616c 6c20 7468 6520 6072 6563 6f72 645f  all the `record_
-000095b0: 7472 6963 6b5f 6c65 6172 6e65 6428 2960  trick_learned()`
-000095c0: 2061 6e64 5c6e 7768 656e 2063 616c 6c69   and\nwhen calli
-000095d0: 6e67 2060 6765 745f 646f 6728 2960 2e5c  ng `get_dog()`.\
-000095e0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 7265  n\n```python\nre
-000095f0: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
-00009600: 6564 2864 6f67 5f69 642c 2074 7269 636b  ed(dog_id, trick
-00009610: 3d5c 2773 6974 5c27 295c 6e5c 6e64 6f67  =\'sit\')\n\ndog
-00009620: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
-00009630: 6429 5c6e 6173 7365 7274 2064 6f67 2e6e  d)\nassert dog.n
-00009640: 616d 6520 3d3d 205c 2746 6964 6f5c 275c  ame == \'Fido\'\
-00009650: 6e61 7373 6572 7420 646f 672e 7472 6963  nassert dog.tric
-00009660: 6b73 203d 3d20 5b5c 2772 6f6c 6c20 6f76  ks == [\'roll ov
-00009670: 6572 5c27 2c20 5c27 6665 7463 6820 6261  er\', \'fetch ba
-00009680: 6c6c 5c27 2c20 5c27 7369 745c 275d 5c6e  ll\', \'sit\']\n
-00009690: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
-000096a0: 6f6e 203d 3d20 335c 6e61 7373 6572 7420  on == 3\nassert 
-000096b0: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
-000096c0: 7368 6f74 2069 7320 5472 7565 5c6e 6060  shot is True\n``
-000096d0: 605c 6e5c 6e57 6520 6361 6e20 7365 6520  `\n\nWe can see 
-000096e0: 6672 6f6d 2074 6865 2060 6973 5f66 726f  from the `is_fro
-000096f0: 6d5f 736e 6170 7368 6f74 6020 6174 7472  m_snapshot` attr
-00009700: 6962 7574 6520 7468 6174 2074 6865 2060  ibute that the `
-00009710: 446f 6760 206f 626a 6563 7420 7761 7320  Dog` object was 
-00009720: 696e 6465 6564 5c6e 7265 636f 6e73 7472  indeed\nreconstr
-00009730: 7563 7465 6420 6672 6f6d 2074 6865 2073  ucted from the s
-00009740: 6e61 7073 686f 742e 5c6e 5c6e 5c6e 2323  napshot.\n\n\n##
-00009750: 2320 5265 6164 2061 6c6c 2065 7665 6e74  # Read all event
-00009760: 735c 6e5c 6e54 6865 206d 6574 686f 6420  s\n\nThe method 
-00009770: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-00009780: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
-00009790: 746f 2072 6561 6420 616c 6c20 7265 636f  to read all reco
-000097a0: 7264 6564 2065 7665 6e74 735c 6e69 6e20  rded events\nin 
-000097b0: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
-000097c0: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
-000097d0: 6572 6520 7265 636f 7264 6564 2e20 4974  ere recorded. It
-000097e0: 2072 6574 7572 6e73 2061 6e20 6974 6572   returns an iter
-000097f0: 6162 6c65 206f 665c 6e65 7665 6e74 7320  able of\nevents 
-00009800: 7468 6174 2068 6176 6520 6265 656e 2072  that have been r
-00009810: 6563 6f72 6465 6420 696e 2074 6865 2064  ecorded in the d
-00009820: 6174 6162 6173 652e 2049 7465 7261 7469  atabase. Iterati
-00009830: 6e67 206f 7665 7220 7468 6973 2069 7465  ng over this ite
-00009840: 7261 626c 655c 6e6f 626a 6563 7420 7769  rable\nobject wi
-00009850: 6c6c 2073 746f 7020 7768 656e 2069 7420  ll stop when it 
-00009860: 6861 7320 7969 656c 6465 6420 7468 6520  has yielded the 
-00009870: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
-00009880: 656e 742e 2054 6865 2072 6563 6569 7665  ent. The receive
-00009890: 645c 6e72 6563 6f72 6465 6420 6576 656e  d\nrecorded even
-000098a0: 7420 6f62 6a65 6374 2061 7265 2069 6e73  t object are ins
-000098b0: 7461 6e63 6573 206f 6620 7468 6520 6052  tances of the `R
-000098c0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
-000098d0: 6173 7320 2873 6565 2074 6865 5c6e 4e6f  ass (see the\nNo
-000098e0: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
-000098f0: 7720 666f 7220 6465 7461 696c 7320 6f66  w for details of
-00009900: 2074 6869 7320 636c 6173 7329 2e5c 6e5c   this class).\n\
-00009910: 6e54 6869 7320 6d65 7468 6f64 2073 7570  nThis method sup
-00009920: 706f 7274 7320 7365 7665 6e20 6f70 7469  ports seven opti
-00009930: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
-00009940: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-00009950: 602c 2060 6261 636b 7761 7264 7360 2c5c  `, `backwards`,\
-00009960: 6e60 6669 6c74 6572 5f65 7863 6c75 6465  n`filter_exclude
-00009970: 602c 2060 6669 6c74 6572 5f69 6e63 6c75  `, `filter_inclu
-00009980: 6465 602c 2060 6669 6c74 6572 5f62 795f  de`, `filter_by_
-00009990: 7374 7265 616d 5f6e 616d 6560 2c20 606c  stream_name`, `l
-000099a0: 696d 6974 602c 2061 6e64 2060 7469 6d65  imit`, and `time
-000099b0: 6f75 7460 2e5c 6e5c 6e54 6865 206f 7074  out`.\n\nThe opt
-000099c0: 696f 6e61 6c20 6063 6f6d 6d69 745f 706f  ional `commit_po
-000099d0: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-000099e0: 2069 7320 616e 206f 7074 696f 6e61 6c20   is an optional 
-000099f0: 696e 7465 6765 7220 7468 6174 2063 616e  integer that can
-00009a00: 2062 6520 7573 6564 2074 6f5c 6e73 7065   be used to\nspe
-00009a10: 6369 6679 2074 6865 2063 6f6d 6d69 7420  cify the commit 
-00009a20: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
-00009a30: 6963 6820 746f 2073 7461 7274 2072 6561  ich to start rea
-00009a40: 6469 6e67 2e20 5468 6973 2061 7267 756d  ding. This argum
-00009a50: 656e 7420 6973 2060 4e6f 6e65 6020 6279  ent is `None` by
-00009a60: 5c6e 6465 6661 756c 742c 206d 6561 6e69  \ndefault, meani
-00009a70: 6e67 2074 6861 7420 616c 6c20 7468 6520  ng that all the 
-00009a80: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-00009a90: 6561 6420 6569 7468 6572 2066 726f 6d20  ead either from 
-00009aa0: 7468 6520 7374 6172 742c 206f 725c 6e66  the start, or\nf
-00009ab0: 726f 6d20 7468 6520 656e 6420 6966 2060  rom the end if `
-00009ac0: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
-00009ad0: 7275 6560 2e20 506c 6561 7365 206e 6f74  rue`. Please not
-00009ae0: 652c 2069 6620 6120 636f 6d6d 6974 2070  e, if a commit p
-00009af0: 6f73 6974 696f 6e20 6973 2073 7065 6369  osition is speci
-00009b00: 6669 6564 2c5c 6e69 7420 6d75 7374 2062  fied,\nit must b
-00009b10: 6520 616e 2061 6374 7561 6c6c 7920 6578  e an actually ex
-00009b20: 6973 7469 6e67 2063 6f6d 6d69 7420 706f  isting commit po
-00009b30: 7369 7469 6f6e 2069 6e20 7468 6520 6461  sition in the da
-00009b40: 7461 6261 7365 2e5c 6e41 6e79 206f 7468  tabase.\nAny oth
-00009b50: 6572 206e 756d 6265 7220 7769 6c6c 2072  er number will r
-00009b60: 6573 756c 7420 696e 2061 2073 6572 7665  esult in a serve
-00009b70: 7220 6572 726f 7220 2861 7420 6c65 6173  r error (at leas
-00009b80: 7420 696e 2045 7665 6e74 5374 6f72 6544  t in EventStoreD
-00009b90: 4220 7632 312e 3130 292e 5c6e 5c6e 5468  B v21.10).\n\nTh
-00009ba0: 6520 6f70 7469 6f6e 616c 2060 6261 636b  e optional `back
-00009bb0: 7761 7264 7360 2061 7267 756d 656e 7420  wards` argument 
-00009bc0: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
-00009bd0: 6c60 2e20 5468 6520 6465 6661 756c 7420  l`. The default 
-00009be0: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
-00009bf0: 685c 6e6d 6561 6e73 2074 6865 2064 6174  h\nmeans the dat
-00009c00: 6162 6173 6520 7769 6c6c 2062 6520 7265  abase will be re
-00009c10: 6164 2066 6f72 7761 7264 7320 6279 2064  ad forwards by d
-00009c20: 6566 6175 6c74 2c20 736f 2074 6861 7420  efault, so that 
-00009c30: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
-00009c40: 6e65 6420 696e 2074 6865 5c6e 6f72 6465  ned in the\norde
-00009c50: 7220 7468 6579 2077 6572 6520 7265 636f  r they were reco
-00009c60: 7264 6564 2c20 4966 2060 6261 636b 7761  rded, If `backwa
-00009c70: 7264 7360 2069 7320 6054 7275 6560 2c20  rds` is `True`, 
-00009c80: 7468 6520 6576 656e 7473 2061 7265 2072  the events are r
-00009c90: 6574 7572 6e65 6420 696e 2072 6576 6572  eturned in rever
-00009ca0: 7365 5c6e 6f72 6465 722e 5c6e 5c6e 5468  se\norder.\n\nTh
-00009cb0: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
-00009cc0: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
-00009cd0: 6d65 6e74 2069 7320 6120 7365 7175 656e  ment is a sequen
-00009ce0: 6365 206f 6620 7265 6775 6c61 7220 6578  ce of regular ex
-00009cf0: 7072 6573 7369 6f6e 7320 7468 6174 5c6e  pressions that\n
-00009d00: 6d61 7463 6820 7265 636f 7264 6564 2065  match recorded e
-00009d10: 7665 6e74 7320 7468 6174 2073 686f 756c  vents that shoul
-00009d20: 6420 6e6f 7420 6265 2069 6e63 6c75 6465  d not be include
-00009d30: 642e 2054 6869 7320 6172 6775 6d65 6e74  d. This argument
-00009d40: 2069 7320 6967 6e6f 7265 645c 6e69 6620   is ignored\nif 
-00009d50: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-00009d60: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
-00009d70: 2d65 6d70 7479 2073 6571 7565 6e63 652e  -empty sequence.
-00009d80: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
-00009d90: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-00009da0: 745c 6e74 6f20 6d61 7463 6820 7468 6520  t\nto match the 
-00009db0: 6576 656e 7420 7479 7065 7320 6f66 2022  event types of "
-00009dc0: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
-00009dd0: 736f 2074 6861 7420 4576 656e 7453 746f  so that EventSto
-00009de0: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
-00009df0: 7473 5c6e 7769 6c6c 206e 6f74 206e 6f72  ts\nwill not nor
-00009e00: 6d61 6c6c 7920 6265 2069 6e63 6c75 6465  mally be include
-00009e10: 642e 2053 6565 2074 6865 204e 6f74 6573  d. See the Notes
-00009e20: 2073 6563 7469 6f6e 2062 656c 6f77 2066   section below f
-00009e30: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
-00009e40: 696f 6e5c 6e61 626f 7574 2066 696c 7465  ion\nabout filte
-00009e50: 7220 6578 7072 6573 7369 6f6e 732e 5c6e  r expressions.\n
-00009e60: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
-00009e70: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
-00009e80: 6172 6775 6d65 6e74 2069 7320 6120 7365  argument is a se
-00009e90: 7175 656e 6365 206f 6620 7265 6775 6c61  quence of regula
-00009ea0: 7220 6578 7072 6573 7369 6f6e 735c 6e74  r expressions\nt
-00009eb0: 6861 7420 6d61 7463 6820 7265 636f 7264  hat match record
-00009ec0: 6564 2065 7665 6e74 7320 7468 6174 2073  ed events that s
-00009ed0: 686f 756c 6420 6265 2069 6e63 6c75 6465  hould be include
-00009ee0: 642e 2042 7920 6465 6661 756c 742c 2074  d. By default, t
-00009ef0: 6869 7320 6172 6775 6d65 6e74 5c6e 6973  his argument\nis
-00009f00: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
-00009f10: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
-00009f20: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
-00009f30: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
-00009f40: 2c20 7468 655c 6e60 6669 6c74 6572 5f65  , the\n`filter_e
-00009f50: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
-00009f60: 2069 7320 6967 6e6f 7265 642e 5c6e 5c6e   is ignored.\n\n
-00009f70: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
-00009f80: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
-00009f90: 616d 6560 2061 7267 756d 656e 7420 6973  ame` argument is
-00009fa0: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
-00009fb0: 2074 6861 7420 696e 6469 6361 7465 7320   that indicates 
-00009fc0: 7768 6574 6865 725c 6e74 6865 2066 696c  whether\nthe fil
-00009fd0: 7465 7220 7769 6c6c 2061 7070 6c79 2074  ter will apply t
-00009fe0: 6f20 6576 656e 7420 7479 7065 7320 6f72  o event types or
-00009ff0: 2073 7472 6561 6d20 6e61 6d65 732e 2042   stream names. B
-0000a000: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
-0000a010: 7661 6c75 6520 6973 2060 4661 6c73 6560  value is `False`
-0000a020: 5c6e 616e 6420 736f 2074 6865 2066 696c  \nand so the fil
-0000a030: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
-0000a040: 7920 746f 2074 6865 2065 7665 6e74 2074  y to the event t
-0000a050: 7970 6520 7374 7269 6e67 7320 6f66 2072  ype strings of r
-0000a060: 6563 6f72 6465 6420 6576 656e 7473 2e5c  ecorded events.\
-0000a070: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-0000a080: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
-0000a090: 2069 7320 616e 2069 6e74 6567 6572 2077   is an integer w
-0000a0a0: 6869 6368 2072 6573 7472 6963 7473 2074  hich restricts t
-0000a0b0: 6865 206e 756d 6265 7220 6f66 2065 7665  he number of eve
-0000a0c0: 6e74 7320 7468 6174 5c6e 7769 6c6c 2062  nts that\nwill b
-0000a0d0: 6520 7265 7475 726e 6564 2e20 5468 6520  e returned. The 
-0000a0e0: 6465 6661 756c 7420 7661 6c75 6520 6973  default value is
-0000a0f0: 2060 7379 732e 6d61 7869 6e74 602e 5c6e   `sys.maxint`.\n
-0000a100: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
-0000a110: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-0000a120: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
-0000a130: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
-0000a140: 2061 5c6e 6465 6164 6c69 6e65 2066 6f72   a\ndeadline for
-0000a150: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-0000a160: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-0000a170: 6174 696f 6e2e 5c6e 5c6e 5468 6520 6669  ation.\n\nThe fi
-0000a180: 6c74 6572 696e 6720 6f66 2065 7665 6e74  ltering of event
-0000a190: 7320 6973 2064 6f6e 6520 6f6e 2074 6865  s is done on the
-0000a1a0: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-0000a1b0: 7276 6572 2e20 5468 655c 6e60 6c69 6d69  rver. The\n`limi
-0000a1c0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-0000a1d0: 7070 6c69 6564 206f 6e20 7468 6520 7365  pplied on the se
-0000a1e0: 7276 6572 2061 6674 6572 2066 696c 7465  rver after filte
-0000a1f0: 7269 6e67 2e5c 6e5c 6e57 6865 6e20 7265  ring.\n\nWhen re
-0000a200: 6164 696e 6720 666f 7277 6172 6473 2066  ading forwards f
-0000a210: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-0000a220: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
-0000a230: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
-0000a240: 2073 7065 6369 6669 6564 5c6e 706f 7369   specified\nposi
-0000a250: 7469 6f6e 2057 494c 4c20 6265 2069 6e63  tion WILL be inc
-0000a260: 6c75 6465 642e 2048 6f77 6576 6572 2c20  luded. However, 
-0000a270: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
-0000a280: 6b77 6172 6473 2c20 7468 6520 6576 656e  kwards, the even
-0000a290: 7420 6174 2074 6865 5c6e 7370 6563 6966  t at the\nspecif
-0000a2a0: 6965 6420 706f 7369 7469 6f6e 2077 696c  ied position wil
-0000a2b0: 6c20 4e4f 5420 6265 2069 6e63 6c75 6465  l NOT be include
-0000a2c0: 642e 2028 5468 6973 206e 6f6e 2d69 6e63  d. (This non-inc
-0000a2d0: 6c75 7369 7665 2062 6568 6176 696f 7572  lusive behaviour
-0000a2e0: 2c20 6f66 2065 7863 6c75 6469 6e67 5c6e  , of excluding\n
-0000a2f0: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
-0000a300: 6d6d 6974 2070 6f73 6974 696f 6e20 7768  mmit position wh
-0000a310: 656e 2072 6561 6469 6e67 2061 6c6c 2073  en reading all s
-0000a320: 7472 6561 6d73 2062 6163 6b77 6172 6473  treams backwards
-0000a330: 2c20 6469 6666 6572 7320 6672 6f6d 2074  , differs from t
-0000a340: 6865 5c6e 6265 6861 7669 6f75 7220 7768  he\nbehaviour wh
-0000a350: 656e 2072 6561 6469 6e67 2061 2073 7472  en reading a str
-0000a360: 6561 6d20 6261 636b 7761 7264 7320 6672  eam backwards fr
-0000a370: 6f6d 2061 2073 7065 6369 6669 6320 7374  om a specific st
-0000a380: 7265 616d 2070 6f73 6974 696f 6e2e 295c  ream position.)\
-0000a390: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-0000a3a0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-0000a3b0: 6f20 7265 6164 2061 6c6c 2065 7665 6e74  o read all event
-0000a3c0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
-0000a3d0: 6520 696e 2074 6865 5c6e 6f72 6465 7220  e in the\norder 
-0000a3e0: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
-0000a3f0: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
-0000a400: 5c6e 6576 656e 7473 203d 206c 6973 7428  \nevents = list(
-0000a410: 636c 6965 6e74 2e72 6561 645f 616c 6c5f  client.read_all_
-0000a420: 6576 656e 7473 2829 295c 6e5c 6e61 7373  events())\n\nass
-0000a430: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-0000a440: 3e3d 2033 5c6e 6060 605c 6e5c 6e54 6865  >= 3\n```\n\nThe
-0000a450: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000a460: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-0000a470: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
-0000a480: 656e 7473 2066 726f 6d20 6120 7370 6563  ents from a spec
-0000a490: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-0000a4a0: 7469 6f6e 2e5c 6e5c 6e60 6060 7079 7468  tion.\n\n```pyth
-0000a4b0: 6f6e 5c6e 6576 656e 7473 203d 206c 6973  on\nevents = lis
-0000a4c0: 7428 5c6e 2020 2020 636c 6965 6e74 2e72  t(\n    client.r
-0000a4d0: 6561 645f 616c 6c5f 6576 656e 7473 285c  ead_all_events(\
-0000a4e0: 6e20 2020 2020 2020 2063 6f6d 6d69 745f  n        commit_
-0000a4f0: 706f 7369 7469 6f6e 3d63 6f6d 6d69 745f  position=commit_
-0000a500: 706f 7369 7469 6f6e 315c 6e20 2020 2029  position1\n    )
-0000a510: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-0000a520: 6e28 6576 656e 7473 2920 3d3d 2037 5c6e  n(events) == 7\n
-0000a530: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000a540: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-0000a550: 3d20 7374 7265 616d 5f6e 616d 6531 5c6e  = stream_name1\n
-0000a560: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-0000a570: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-0000a580: 203d 3d20 305c 6e61 7373 6572 7420 6576   == 0\nassert ev
-0000a590: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-0000a5a0: 6576 656e 7431 2e74 7970 655c 6e61 7373  event1.type\nass
-0000a5b0: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-0000a5c0: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
-0000a5d0: 615c 6e5c 6e61 7373 6572 7420 6576 656e  a\n\nassert even
-0000a5e0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
-0000a5f0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-0000a600: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
-0000a610: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
-0000a620: 696f 6e20 3d3d 2031 5c6e 6173 7365 7274  ion == 1\nassert
-0000a630: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
-0000a640: 3d3d 2065 7665 6e74 322e 7479 7065 5c6e  == event2.type\n
-0000a650: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-0000a660: 2e64 6174 6120 3d3d 2065 7665 6e74 322e  .data == event2.
-0000a670: 6461 7461 5c6e 5c6e 6173 7365 7274 2065  data\n\nassert e
-0000a680: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
-0000a690: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-0000a6a0: 616d 6531 5c6e 6173 7365 7274 2065 7665  ame1\nassert eve
-0000a6b0: 6e74 735b 325d 2e73 7472 6561 6d5f 706f  nts[2].stream_po
-0000a6c0: 7369 7469 6f6e 203d 3d20 325c 6e61 7373  sition == 2\nass
-0000a6d0: 6572 7420 6576 656e 7473 5b32 5d2e 7479  ert events[2].ty
-0000a6e0: 7065 203d 3d20 6576 656e 7433 2e74 7970  pe == event3.typ
-0000a6f0: 655c 6e61 7373 6572 7420 6576 656e 7473  e\nassert events
-0000a700: 5b32 5d2e 6461 7461 203d 3d20 6576 656e  [2].data == even
-0000a710: 7433 2e64 6174 615c 6e5c 6e61 7373 6572  t3.data\n\nasser
-0000a720: 7420 6576 656e 7473 5b33 5d2e 7479 7065  t events[3].type
-0000a730: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
-0000a740: 6564 225c 6e61 7373 6572 7420 6576 656e  ed"\nassert even
-0000a750: 7473 5b34 5d2e 7479 7065 203d 3d20 2244  ts[4].type == "D
-0000a760: 6f67 4c65 6172 6e65 6454 7269 636b 225c  ogLearnedTrick"\
-0000a770: 6e61 7373 6572 7420 6576 656e 7473 5b35  nassert events[5
-0000a780: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-0000a790: 6172 6e65 6454 7269 636b 225c 6e61 7373  arnedTrick"\nass
-0000a7a0: 6572 7420 6576 656e 7473 5b36 5d2e 7479  ert events[6].ty
-0000a7b0: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
-0000a7c0: 6454 7269 636b 225c 6e60 6060 5c6e 5c6e  dTrick"\n```\n\n
-0000a7d0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-0000a7e0: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
-0000a7f0: 6561 6420 616c 6c20 7265 636f 7264 6564  ead all recorded
-0000a800: 2065 7665 6e74 7320 696e 2072 6576 6572   events in rever
-0000a810: 7365 206f 7264 6572 2e5c 6e5c 6e60 6060  se order.\n\n```
-0000a820: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
-0000a830: 206c 6973 7428 5c6e 2020 2020 636c 6965   list(\n    clie
-0000a840: 6e74 2e72 6561 645f 616c 6c5f 6576 656e  nt.read_all_even
-0000a850: 7473 285c 6e20 2020 2020 2020 2062 6163  ts(\n        bac
-0000a860: 6b77 6172 6473 3d54 7275 655c 6e20 2020  kwards=True\n   
-0000a870: 2029 5c6e 295c 6e5c 6e61 7373 6572 7420   )\n)\n\nassert 
-0000a880: 6c65 6e28 6576 656e 7473 2920 3e3d 2033  len(events) >= 3
-0000a890: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
-0000a8a0: 735b 305d 2e74 7970 6520 3d3d 2022 446f  s[0].type == "Do
-0000a8b0: 674c 6561 726e 6564 5472 6963 6b22 5c6e  gLearnedTrick"\n
-0000a8c0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-0000a8d0: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
-0000a8e0: 726e 6564 5472 6963 6b22 5c6e 6173 7365  rnedTrick"\nasse
-0000a8f0: 7274 2065 7665 6e74 735b 325d 2e74 7970  rt events[2].typ
-0000a900: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
-0000a910: 5472 6963 6b22 5c6e 6173 7365 7274 2065  Trick"\nassert e
-0000a920: 7665 6e74 735b 335d 2e74 7970 6520 3d3d  vents[3].type ==
-0000a930: 2022 446f 6752 6567 6973 7465 7265 6422   "DogRegistered"
-0000a940: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
-0000a950: 735b 345d 2e73 7472 6561 6d5f 6e61 6d65  s[4].stream_name
-0000a960: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-0000a970: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000a980: 345d 2e73 7472 6561 6d5f 706f 7369 7469  4].stream_positi
-0000a990: 6f6e 203d 3d20 325c 6e61 7373 6572 7420  on == 2\nassert 
-0000a9a0: 6576 656e 7473 5b34 5d2e 7479 7065 203d  events[4].type =
-0000a9b0: 3d20 6576 656e 7433 2e74 7970 655c 6e61  = event3.type\na
-0000a9c0: 7373 6572 7420 6576 656e 7473 5b34 5d2e  ssert events[4].
-0000a9d0: 6461 7461 203d 3d20 6576 656e 7433 2e64  data == event3.d
-0000a9e0: 6174 615c 6e5c 6e61 7373 6572 7420 6576  ata\n\nassert ev
-0000a9f0: 656e 7473 5b35 5d2e 7374 7265 616d 5f6e  ents[5].stream_n
-0000aa00: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000aa10: 6d65 315c 6e61 7373 6572 7420 6576 656e  me1\nassert even
-0000aa20: 7473 5b35 5d2e 7374 7265 616d 5f70 6f73  ts[5].stream_pos
-0000aa30: 6974 696f 6e20 3d3d 2031 5c6e 6173 7365  ition == 1\nasse
-0000aa40: 7274 2065 7665 6e74 735b 355d 2e74 7970  rt events[5].typ
-0000aa50: 6520 3d3d 2065 7665 6e74 322e 7479 7065  e == event2.type
-0000aa60: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000aa70: 355d 2e64 6174 6120 3d3d 2065 7665 6e74  5].data == event
-0000aa80: 322e 6461 7461 5c6e 5c6e 6173 7365 7274  2.data\n\nassert
-0000aa90: 2065 7665 6e74 735b 365d 2e73 7472 6561   events[6].strea
-0000aaa0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000aab0: 5f6e 616d 6531 5c6e 6173 7365 7274 2065  _name1\nassert e
-0000aac0: 7665 6e74 735b 365d 2e73 7472 6561 6d5f  vents[6].stream_
-0000aad0: 706f 7369 7469 6f6e 203d 3d20 305c 6e61  position == 0\na
-0000aae0: 7373 6572 7420 6576 656e 7473 5b36 5d2e  ssert events[6].
-0000aaf0: 7479 7065 203d 3d20 6576 656e 7431 2e74  type == event1.t
-0000ab00: 7970 655c 6e61 7373 6572 7420 6576 656e  ype\nassert even
-0000ab10: 7473 5b36 5d2e 6461 7461 203d 3d20 6576  ts[6].data == ev
-0000ab20: 656e 7431 2e64 6174 615c 6e5c 6e60 6060  ent1.data\n\n```
-0000ab30: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-0000ab40: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-0000ab50: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
-0000ab60: 6420 6e75 6d62 6572 2028 6f6e 6529 206f  d number (one) o
-0000ab70: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-0000ab80: 7665 6e74 735c 6e69 6e20 7468 6520 6461  vents\nin the da
-0000ab90: 7461 6261 7365 2066 6f72 7761 7264 7320  tabase forwards 
-0000aba0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-0000abb0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
-0000abc0: 2050 6c65 6173 6520 6e6f 7465 2c20 7768   Please note, wh
-0000abd0: 656e 2072 6561 6469 6e67 5c6e 616c 6c20  en reading\nall 
-0000abe0: 6576 656e 7473 2066 6f72 7761 7264 7320  events forwards 
-0000abf0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-0000ac00: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
-0000ac10: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
-0000ac20: 6520 7370 6563 6966 6965 645c 6e70 6f73  e specified\npos
-0000ac30: 6974 696f 6e20 5749 4c4c 2062 6520 696e  ition WILL be in
-0000ac40: 636c 7564 6564 2e5c 6e5c 6e5c 6e60 6060  cluded.\n\n\n```
-0000ac50: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
-0000ac60: 206c 6973 7428 5c6e 2020 2020 636c 6965   list(\n    clie
-0000ac70: 6e74 2e72 6561 645f 616c 6c5f 6576 656e  nt.read_all_even
-0000ac80: 7473 285c 6e20 2020 2020 2020 2063 6f6d  ts(\n        com
-0000ac90: 6d69 745f 706f 7369 7469 6f6e 3d63 6f6d  mit_position=com
-0000aca0: 6d69 745f 706f 7369 7469 6f6e 312c 5c6e  mit_position1,\n
-0000acb0: 2020 2020 2020 2020 6c69 6d69 743d 312c          limit=1,
-0000acc0: 5c6e 2020 2020 295c 6e29 5c6e 5c6e 6173  \n    )\n)\n\nas
-0000acd0: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-0000ace0: 203d 3d20 315c 6e5c 6e61 7373 6572 7420   == 1\n\nassert 
-0000acf0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-0000ad00: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000ad10: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
-0000ad20: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-0000ad30: 6f73 6974 696f 6e20 3d3d 2030 5c6e 6173  osition == 0\nas
-0000ad40: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-0000ad50: 7970 6520 3d3d 2065 7665 6e74 312e 7479  ype == event1.ty
-0000ad60: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
-0000ad70: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-0000ad80: 6e74 312e 6461 7461 5c6e 5c6e 6173 7365  nt1.data\n\nasse
-0000ad90: 7274 2065 7665 6e74 735b 305d 2e63 6f6d  rt events[0].com
-0000ada0: 6d69 745f 706f 7369 7469 6f6e 203d 3d20  mit_position == 
-0000adb0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-0000adc0: 5c6e 6060 605c 6e5c 6e54 6865 2065 7861  \n```\n\nThe exa
-0000add0: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-0000ade0: 2068 6f77 2074 6f20 7265 6164 2061 206c   how to read a l
-0000adf0: 696d 6974 6564 206e 756d 6265 7220 286f  imited number (o
-0000ae00: 6e65 2920 6f66 2074 6865 2072 6563 6f72  ne) of the recor
-0000ae10: 6465 6420 6576 656e 7473 5c6e 696e 2074  ded events\nin t
-0000ae20: 6865 2064 6174 6162 6173 6520 6261 636b  he database back
-0000ae30: 7761 7264 7320 6672 6f6d 2074 6865 2065  wards from the e
-0000ae40: 6e64 2e20 5468 6973 2067 6976 6573 2074  nd. This gives t
-0000ae50: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-0000ae60: 2065 7665 6e74 2e5c 6e5c 6e60 6060 7079   event.\n\n```py
-0000ae70: 7468 6f6e 5c6e 6576 656e 7473 203d 206c  thon\nevents = l
-0000ae80: 6973 7428 5c6e 2020 2020 636c 6965 6e74  ist(\n    client
-0000ae90: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
-0000aea0: 285c 6e20 2020 2020 2020 2062 6163 6b77  (\n        backw
-0000aeb0: 6172 6473 3d54 7275 652c 5c6e 2020 2020  ards=True,\n    
-0000aec0: 2020 2020 6c69 6d69 743d 312c 5c6e 2020      limit=1,\n  
-0000aed0: 2020 295c 6e29 5c6e 5c6e 6173 7365 7274    )\n)\n\nassert
-0000aee0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-0000aef0: 315c 6e5c 6e61 7373 6572 7420 6576 656e  1\n\nassert even
-0000af00: 7473 5b30 5d2e 7479 7065 203d 3d20 2244  ts[0].type == "D
-0000af10: 6f67 4c65 6172 6e65 6454 7269 636b 225c  ogLearnedTrick"\
-0000af20: 6e60 6060 5c6e 5c6e 5468 6520 6578 616d  n```\n\nThe exam
-0000af30: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
-0000af40: 686f 7720 746f 2072 6561 6420 6120 6c69  how to read a li
-0000af50: 6d69 7465 6420 6e75 6d62 6572 2028 6f6e  mited number (on
-0000af60: 6529 206f 6620 7468 6520 7265 636f 7264  e) of the record
-0000af70: 6564 2065 7665 6e74 735c 6e69 6e20 7468  ed events\nin th
-0000af80: 6520 6461 7461 6261 7365 2062 6163 6b77  e database backw
-0000af90: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
-0000afa0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-0000afb0: 7469 6f6e 2e20 506c 6561 7365 206e 6f74  tion. Please not
-0000afc0: 652c 2077 6865 6e20 7265 6164 696e 675c  e, when reading\
-0000afd0: 6e61 6c6c 2065 7665 6e74 7320 6261 636b  nall events back
-0000afe0: 7761 7264 7320 6672 6f6d 2061 2073 7065  wards from a spe
-0000aff0: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
-0000b000: 6974 696f 6e2c 2074 6865 2065 7665 6e74  ition, the event
-0000b010: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
-0000b020: 645c 6e70 6f73 6974 696f 6e20 5749 4c4c  d\nposition WILL
-0000b030: 204e 4f54 2062 6520 696e 636c 7564 6564   NOT be included
-0000b040: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0000b050: 6576 656e 7473 203d 206c 6973 7428 5c6e  events = list(\n
-0000b060: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
-0000b070: 616c 6c5f 6576 656e 7473 285c 6e20 2020  all_events(\n   
-0000b080: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
-0000b090: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
-0000b0a0: 7469 6f6e 322c 5c6e 2020 2020 2020 2020  tion2,\n        
-0000b0b0: 6261 636b 7761 7264 733d 5472 7565 2c5c  backwards=True,\
-0000b0c0: 6e20 2020 2020 2020 206c 696d 6974 3d31  n        limit=1
-0000b0d0: 2c5c 6e20 2020 2029 5c6e 295c 6e5c 6e61  ,\n    )\n)\n\na
-0000b0e0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-0000b0f0: 2920 3d3d 2031 5c6e 5c6e 6173 7365 7274  ) == 1\n\nassert
-0000b100: 2065 7665 6e74 735b 305d 2e63 6f6d 6d69   events[0].commi
-0000b110: 745f 706f 7369 7469 6f6e 203c 2063 6f6d  t_position < com
-0000b120: 6d69 745f 706f 7369 7469 6f6e 325c 6e60  mit_position2\n`
-0000b130: 6060 5c6e 5c6e 5c6e 2323 2320 4765 7420  ``\n\n\n### Get 
-0000b140: 6375 7272 656e 7420 7374 7265 616d 2070  current stream p
-0000b150: 6f73 6974 696f 6e5c 6e5c 6e54 6865 2060  osition\n\nThe `
-0000b160: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
-0000b170: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
-0000b180: 6e20 6265 2075 7365 6420 746f 5c6e 6765  n be used to\nge
-0000b190: 7420 7468 6520 2273 7472 6561 6d20 706f  t the "stream po
-0000b1a0: 7369 7469 6f6e 2220 6f66 2074 6865 206c  sition" of the l
-0000b1b0: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-0000b1c0: 6e74 2069 6e20 6120 7374 7265 616d 2e5c  nt in a stream.\
-0000b1d0: 6e5c 6e54 6869 7320 6d65 7468 6f64 2068  n\nThis method h
-0000b1e0: 6173 2061 2060 7374 7265 616d 5f6e 616d  as a `stream_nam
-0000b1f0: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
-0000b200: 6368 2069 7320 7265 7175 6972 6564 2e5c  ch is required.\
-0000b210: 6e5c 6e54 6869 7320 6d65 7468 6f64 2061  n\nThis method a
-0000b220: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
-0000b230: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000b240: 6172 6775 6d65 6e74 2c20 7468 6174 5c6e  argument, that\n
-0000b250: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-0000b260: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
-0000b270: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
-0000b280: 2064 6561 646c 696e 655c 6e66 6f72 2074   deadline\nfor t
-0000b290: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-0000b2a0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-0000b2b0: 696f 6e2e 5c6e 5c6e 5468 6520 7365 7175  ion.\n\nThe sequ
-0000b2c0: 656e 6365 206f 6620 706f 7369 7469 6f6e  ence of position
-0000b2d0: 7320 696e 2061 2073 7472 6561 6d20 6973  s in a stream is
-0000b2e0: 2067 6170 6c65 7373 2e20 4974 2069 7320   gapless. It is 
-0000b2f0: 7a65 726f 2d62 6173 6564 2c5c 6e73 6f20  zero-based,\nso 
-0000b300: 7468 6174 2061 2073 7472 6561 6d20 7769  that a stream wi
-0000b310: 7468 206f 6e65 2072 6563 6f72 6465 6420  th one recorded 
-0000b320: 6576 656e 7420 6861 7320 6120 6375 7272  event has a curr
-0000b330: 656e 7420 7374 7265 616d 5c6e 706f 7369  ent stream\nposi
-0000b340: 7469 6f6e 206f 6620 6030 602e 2054 6865  tion of `0`. The
-0000b350: 2063 7572 7265 6e74 2073 7472 6561 6d20   current stream 
-0000b360: 706f 7369 7469 6f6e 2069 7320 6031 6020  position is `1` 
-0000b370: 7768 656e 2061 2073 7472 6561 6d20 6861  when a stream ha
-0000b380: 735c 6e74 776f 2065 7665 6e74 732c 2061  s\ntwo events, a
-0000b390: 6e64 2069 7420 6973 2060 3260 2077 6865  nd it is `2` whe
-0000b3a0: 6e20 7468 6572 6520 6172 6520 6576 656e  n there are even
-0000b3b0: 7473 2c20 616e 6420 736f 206f 6e2e 5c6e  ts, and so on.\n
-0000b3c0: 5c6e 496e 2074 6865 2065 7861 6d70 6c65  \nIn the example
-0000b3d0: 2062 656c 6f77 2c20 7468 6520 6375 7272   below, the curr
-0000b3e0: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
-0000b3f0: 696f 6e20 6973 206f 6274 6169 6e65 6420  ion is obtained 
-0000b400: 6f66 2074 6865 5c6e 7374 7265 616d 2074  of the\nstream t
-0000b410: 6f20 7768 6963 6820 6576 656e 7473 2077  o which events w
-0000b420: 6572 6520 6170 7065 6e64 6564 2069 6e20  ere appended in 
-0000b430: 7468 6520 6578 616d 706c 6573 2061 626f  the examples abo
-0000b440: 7665 2e5c 6e42 6563 6175 7365 2074 6865  ve.\nBecause the
-0000b450: 2073 6571 7565 6e63 6520 6f66 2073 7472   sequence of str
-0000b460: 6561 6d20 706f 7369 7469 6f6e 7320 6973  eam positions is
-0000b470: 207a 6572 6f2d 6261 7365 642c 2061 6e64   zero-based, and
-0000b480: 2062 6563 6175 7365 5c6e 7468 7265 6520   because\nthree 
-0000b490: 6576 656e 7473 2077 6572 6520 6170 7065  events were appe
-0000b4a0: 6e64 6564 2c20 736f 2074 6865 2063 7572  nded, so the cur
-0000b4b0: 7265 6e74 2073 7472 6561 6d20 706f 7369  rent stream posi
-0000b4c0: 7469 6f6e 2069 7320 6032 602e 5c6e 5c6e  tion is `2`.\n\n
-0000b4d0: 6060 6070 7974 686f 6e5c 6e73 7472 6561  ```python\nstrea
-0000b4e0: 6d5f 706f 7369 7469 6f6e 203d 2063 6c69  m_position = cli
-0000b4f0: 656e 742e 6765 745f 7374 7265 616d 5f70  ent.get_stream_p
-0000b500: 6f73 6974 696f 6e28 5c6e 2020 2020 7374  osition(\n    st
-0000b510: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-0000b520: 5f6e 616d 6531 5c6e 295c 6e5c 6e61 7373  _name1\n)\n\nass
-0000b530: 6572 7420 7374 7265 616d 5f70 6f73 6974  ert stream_posit
-0000b540: 696f 6e20 3d3d 2032 5c6e 6060 605c 6e5c  ion == 2\n```\n\
-0000b550: 6e49 6620 6120 7374 7265 616d 2064 6f65  nIf a stream doe
-0000b560: 7320 6e6f 7420 6578 6973 742c 2074 6865  s not exist, the
-0000b570: 2072 6574 7572 6e65 6420 7374 7265 616d   returned stream
-0000b580: 2070 6f73 6974 696f 6e20 7661 6c75 6520   position value 
-0000b590: 6973 2060 4e6f 6e65 602c 5c6e 7768 6963  is `None`,\nwhic
-0000b5a0: 6820 6d61 7463 6865 7320 7468 6520 7265  h matches the re
-0000b5b0: 7175 6972 6564 2065 7870 6563 7465 6420  quired expected 
-0000b5c0: 706f 7369 7469 6f6e 2077 6865 6e20 6170  position when ap
-0000b5d0: 7065 6e64 696e 6720 7468 6520 6669 7273  pending the firs
-0000b5e0: 7420 6576 656e 745c 6e6f 6620 6120 6e65  t event\nof a ne
-0000b5f0: 7720 7374 7265 616d 2028 7365 6520 6162  w stream (see ab
-0000b600: 6f76 6529 2e5c 6e5c 6e60 6060 7079 7468  ove).\n\n```pyth
-0000b610: 6f6e 5c6e 7374 7265 616d 5f70 6f73 6974  on\nstream_posit
-0000b620: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
-0000b630: 5f73 7472 6561 6d5f 706f 7369 7469 6f6e  _stream_position
-0000b640: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-0000b650: 6d65 3d73 7472 2875 7569 6434 2829 295c  me=str(uuid4())\
-0000b660: 6e29 5c6e 5c6e 6173 7365 7274 2073 7472  n)\n\nassert str
-0000b670: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-0000b680: 4e6f 6e65 5c6e 6060 605c 6e5c 6e54 6869  None\n```\n\nThi
-0000b690: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-0000b6a0: 6e20 6f70 7469 6f6e 616c 2061 7267 756d  n optional argum
-0000b6b0: 656e 7420 6074 696d 656f 7574 6020 7768  ent `timeout` wh
-0000b6c0: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
-0000b6d0: 6066 6c6f 6174 6020 7468 6174 2073 6574  `float` that set
-0000b6e0: 735c 6e61 2064 6561 646c 696e 6520 666f  s\na deadline fo
-0000b6f0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-0000b700: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-0000b710: 7261 7469 6f6e 2e5c 6e5c 6e5c 6e23 2323  ration.\n\n\n###
-0000b720: 2047 6574 2063 7572 7265 6e74 2063 6f6d   Get current com
-0000b730: 6d69 7420 706f 7369 7469 6f6e 5c6e 5c6e  mit position\n\n
-0000b740: 5468 6520 6d65 7468 6f64 2060 6765 745f  The method `get_
-0000b750: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
-0000b760: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
-0000b770: 6f20 6765 7420 7468 6520 6375 7272 656e  o get the curren
-0000b780: 745c 6e63 6f6d 6d69 7420 706f 7369 7469  t\ncommit positi
-0000b790: 6f6e 206f 6620 7468 6520 6461 7461 6261  on of the databa
-0000b7a0: 7365 2e5c 6e5c 6e60 6060 7079 7468 6f6e  se.\n\n```python
-0000b7b0: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
-0000b7c0: 6e20 3d20 636c 6965 6e74 2e67 6574 5f63  n = client.get_c
-0000b7d0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2829  ommit_position()
-0000b7e0: 5c6e 6060 605c 6e5c 6e54 6869 7320 6d65  \n```\n\nThis me
-0000b7f0: 7468 6f64 2074 616b 6573 2061 6e20 6f70  thod takes an op
-0000b800: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
-0000b810: 6074 696d 656f 7574 6020 7768 6963 6820  `timeout` which 
-0000b820: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
-0000b830: 6174 6020 7468 6174 2073 6574 735c 6e61  at` that sets\na
-0000b840: 2064 6561 646c 696e 6520 666f 7220 7468   deadline for th
-0000b850: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-0000b860: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-0000b870: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
-0000b880: 6f64 2063 616e 2062 6520 7573 6566 756c  od can be useful
-0000b890: 2074 6f20 6d65 6173 7572 6520 7072 6f67   to measure prog
-0000b8a0: 7265 7373 206f 6620 6120 646f 776e 7374  ress of a downst
-0000b8b0: 7265 616d 2063 6f6d 706f 6e65 6e74 5c6e  ream component\n
-0000b8c0: 7468 6174 2069 7320 7072 6f63 6573 7369  that is processi
-0000b8d0: 6e67 2061 6c6c 2072 6563 6f72 6465 6420  ng all recorded 
-0000b8e0: 6576 656e 7473 2c20 6279 2063 6f6d 7061  events, by compa
-0000b8f0: 7269 6e67 2074 6865 2063 7572 7265 6e74  ring the current
-0000b900: 2063 6f6d 6d69 745c 6e70 6f73 6974 696f   commit\npositio
-0000b910: 6e20 7769 7468 2074 6865 2072 6563 6f72  n with the recor
-0000b920: 6465 6420 636f 6d6d 6974 2070 6f73 6974  ded commit posit
-0000b930: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
-0000b940: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-0000b950: 6365 7373 6564 5c6e 6576 656e 7420 696e  cessed\nevent in
-0000b960: 2061 2064 6f77 6e73 7472 6561 6d20 636f   a downstream co
-0000b970: 6d70 6f6e 656e 742e 5c6e 5c6e 5468 6520  mponent.\n\nThe 
-0000b980: 7661 6c75 6520 6f66 2074 6865 2060 636f  value of the `co
-0000b990: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
-0000b9a0: 7267 756d 656e 7420 7768 656e 2072 6561  rgument when rea
-0000b9b0: 6469 6e67 2065 7665 6e74 7320 6569 7468  ding events eith
-0000b9c0: 6572 2062 7920 7573 696e 675c 6e74 6865  er by using\nthe
-0000b9d0: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
-0000b9e0: 7328 2960 206d 6574 686f 6420 6f72 2062  s()` method or b
-0000b9f0: 7920 7573 696e 6720 6120 6361 7463 682d  y using a catch-
-0000ba00: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-0000ba10: 776f 756c 6420 7573 7561 6c6c 795c 6e62  would usually\nb
-0000ba20: 6520 6465 7465 726d 696e 6564 2062 7920  e determined by 
-0000ba30: 7468 6520 7265 636f 7264 6564 2063 6f6d  the recorded com
-0000ba40: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
-0000ba50: 7468 6520 6c61 7374 2073 7563 6365 7373  the last success
-0000ba60: 6675 6c6c 7920 7072 6f63 6573 7365 645c  fully processed\
-0000ba70: 6e65 7665 6e74 2069 6e20 6120 646f 776e  nevent in a down
-0000ba80: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000ba90: 2e5c 6e5c 6e5c 6e23 2323 2047 6574 2073  .\n\n\n### Get s
-0000baa0: 7472 6561 6d20 6d65 7461 6461 7461 5c6e  tream metadata\n
-0000bab0: 5c6e 5468 6520 6d65 7468 6f64 2060 6765  \nThe method `ge
-0000bac0: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
-0000bad0: 6128 2960 2067 6574 7320 7468 6520 6d65  a()` gets the me
-0000bae0: 7461 6461 7461 2066 6f72 2061 2073 7472  tadata for a str
-0000baf0: 6561 6d2c 2061 6c6f 6e67 5c6e 7769 7468  eam, along\nwith
-0000bb00: 2074 6865 2076 6572 7369 6f6e 206f 6620   the version of 
-0000bb10: 7468 6520 7374 7265 616d 206d 6574 6164  the stream metad
-0000bb20: 6174 612e 5c6e 5c6e 6060 6070 7974 686f  ata.\n\n```pytho
-0000bb30: 6e5c 6e6d 6574 6164 6174 612c 206d 6574  n\nmetadata, met
-0000bb40: 6164 6174 615f 7665 7273 696f 6e20 3d20  adata_version = 
-0000bb50: 636c 6965 6e74 2e67 6574 5f73 7472 6561  client.get_strea
-0000bb60: 6d5f 6d65 7461 6461 7461 2873 7472 6561  m_metadata(strea
-0000bb70: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000bb80: 6d65 3129 5c6e 6060 605c 6e5c 6e54 6865  me1)\n```\n\nThe
-0000bb90: 2072 6574 7572 6e65 6420 606d 6574 6164   returned `metad
-0000bba0: 6174 6160 2076 616c 7565 2069 7320 6120  ata` value is a 
-0000bbb0: 5079 7468 6f6e 2060 6469 6374 602e 2054  Python `dict`. T
-0000bbc0: 6865 2072 6574 7572 6e65 6420 606d 6574  he returned `met
-0000bbd0: 6164 6174 615f 7665 7273 696f 6e60 5c6e  adata_version`\n
-0000bbe0: 7661 6c75 6520 6973 2065 6974 6865 7220  value is either 
-0000bbf0: 616e 2060 696e 7460 2c20 6f72 2060 4e6f  an `int`, or `No
-0000bc00: 6e65 6020 6966 2074 6865 2073 7472 6561  ne` if the strea
-0000bc10: 6d20 646f 6573 206e 6f74 2065 7869 7374  m does not exist
-0000bc20: 2e20 5468 6573 6520 7661 6c75 6573 2063  . These values c
-0000bc30: 616e 5c6e 6265 2070 6173 7365 6420 696e  an\nbe passed in
-0000bc40: 746f 2060 7365 745f 7374 7265 616d 5f6d  to `set_stream_m
-0000bc50: 6574 6164 6174 6128 2960 2e5c 6e5c 6e5c  etadata()`.\n\n\
-0000bc60: 6e23 2323 2053 6574 2073 7472 6561 6d20  n### Set stream 
-0000bc70: 6d65 7461 6461 7461 5c6e 5c6e 2a72 6571  metadata\n\n*req
-0000bc80: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-0000bc90: 6e54 6865 206d 6574 686f 6420 6073 6574  nThe method `set
-0000bca0: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
-0000bcb0: 2829 6020 7365 7473 2074 6865 206d 6574  ()` sets the met
-0000bcc0: 6164 6174 6120 666f 7220 6120 7374 7265  adata for a stre
-0000bcd0: 616d 2c20 616c 6f6e 675c 6e77 6974 6820  am, along\nwith 
-0000bce0: 7468 6520 7665 7273 696f 6e20 6f66 2074  the version of t
-0000bcf0: 6865 2073 7472 6561 6d20 6d65 7461 6461  he stream metada
-0000bd00: 7461 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ta.\n\n```python
-0000bd10: 5c6e 6d65 7461 6461 7461 5b22 666f 6f22  \nmetadata["foo"
-0000bd20: 5d20 3d20 2262 6172 225c 6e5c 6e63 6c69  ] = "bar"\n\ncli
-0000bd30: 656e 742e 7365 745f 7374 7265 616d 5f6d  ent.set_stream_m
-0000bd40: 6574 6164 6174 6128 5c6e 2020 2020 7374  etadata(\n    st
-0000bd50: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-0000bd60: 5f6e 616d 6531 2c5c 6e20 2020 206d 6574  _name1,\n    met
-0000bd70: 6164 6174 613d 6d65 7461 6461 7461 2c5c  adata=metadata,\
-0000bd80: 6e20 2020 2065 7870 6563 7465 645f 706f  n    expected_po
-0000bd90: 7369 7469 6f6e 3d6d 6574 6164 6174 615f  sition=metadata_
-0000bda0: 7665 7273 696f 6e2c 5c6e 295c 6e60 6060  version,\n)\n```
-0000bdb0: 5c6e 5c6e 5468 6520 6065 7870 6563 7465  \n\nThe `expecte
-0000bdc0: 645f 706f 7369 7469 6f6e 6020 6172 6775  d_position` argu
-0000bdd0: 6d65 6e74 2073 686f 756c 6420 6265 2074  ment should be t
-0000bde0: 6865 2063 7572 7265 6e74 2076 6572 7369  he current versi
-0000bdf0: 6f6e 206f 6620 7468 6520 7374 7265 616d  on of the stream
-0000be00: 206d 6574 6164 6174 612e 5c6e 5c6e 506c   metadata.\n\nPl
-0000be10: 6561 7365 2072 6566 6572 2074 6f20 7468  ease refer to th
-0000be20: 6520 4576 656e 7453 746f 7265 4442 2064  e EventStoreDB d
-0000be30: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
-0000be40: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0000be50: 6e20 6162 6f75 7420 7374 7265 616d 5c6e  n about stream\n
-0000be60: 6d65 7461 6461 7461 2e5c 6e5c 6e23 2323  metadata.\n\n###
-0000be70: 2044 656c 6574 6520 7374 7265 616d 5c6e   Delete stream\n
-0000be80: 5c6e 2a72 6571 7569 7265 7320 6c65 6164  \n*requires lead
-0000be90: 6572 2a5c 6e5c 6e54 6865 206d 6574 686f  er*\n\nThe metho
-0000bea0: 6420 6064 656c 6574 655f 7374 7265 616d  d `delete_stream
-0000beb0: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
-0000bec0: 746f 2022 6465 6c65 7465 2220 6120 7374  to "delete" a st
-0000bed0: 7265 616d 2e5c 6e5c 6e60 6060 7079 7468  ream.\n\n```pyth
-0000bee0: 6f6e 5c6e 636f 6d6d 6974 5f70 6f73 6974  on\ncommit_posit
-0000bef0: 696f 6e20 3d20 636c 6965 6e74 2e64 656c  ion = client.del
-0000bf00: 6574 655f 7374 7265 616d 2873 7472 6561  ete_stream(strea
-0000bf10: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000bf20: 6d65 312c 2065 7870 6563 7465 645f 706f  me1, expected_po
-0000bf30: 7369 7469 6f6e 3d32 295c 6e60 6060 5c6e  sition=2)\n```\n
-0000bf40: 5c6e 4166 7465 7220 6465 6c65 7469 6e67  \nAfter deleting
-0000bf50: 2061 2073 7472 6561 6d2c 2069 745c 2773   a stream, it\'s
-0000bf60: 2073 7469 6c6c 2070 6f73 7369 626c 6520   still possible 
-0000bf70: 746f 2061 7070 656e 6420 6e65 7720 6576  to append new ev
-0000bf80: 656e 7473 2e20 5265 6164 696e 6720 6672  ents. Reading fr
-0000bf90: 6f6d 2061 5c6e 6465 6c65 7465 6420 7374  om a\ndeleted st
-0000bfa0: 7265 616d 2077 696c 6c20 7265 7475 726e  ream will return
-0000bfb0: 206f 6e6c 7920 6576 656e 7473 2074 6861   only events tha
-0000bfc0: 7420 6861 7665 2062 6565 6e20 6170 7065  t have been appe
-0000bfd0: 6e64 6564 2061 6674 6572 2069 7420 7761  nded after it wa
-0000bfe0: 735c 6e64 656c 6574 6564 2e5c 6e5c 6e23  s\ndeleted.\n\n#
-0000bff0: 2323 2054 6f6d 6273 746f 6e65 2073 7472  ## Tombstone str
-0000c000: 6561 6d5c 6e5c 6e2a 7265 7175 6972 6573  eam\n\n*requires
-0000c010: 206c 6561 6465 722a 5c6e 5c6e 5468 6520   leader*\n\nThe 
-0000c020: 6d65 7468 6f64 2060 746f 6d62 7374 6f6e  method `tombston
-0000c030: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
-0000c040: 6265 2075 7365 6420 746f 2022 746f 6d62  be used to "tomb
-0000c050: 7374 6f6e 6522 2061 2073 7472 6561 6d2e  stone" a stream.
-0000c060: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e63  \n\n```python\nc
-0000c070: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
-0000c080: 2063 6c69 656e 742e 746f 6d62 7374 6f6e   client.tombston
-0000c090: 655f 7374 7265 616d 2873 7472 6561 6d5f  e_stream(stream_
-0000c0a0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000c0b0: 312c 2065 7870 6563 7465 645f 706f 7369  1, expected_posi
-0000c0c0: 7469 6f6e 3d32 295c 6e60 6060 5c6e 5c6e  tion=2)\n```\n\n
-0000c0d0: 4166 7465 7220 746f 6d62 7374 6f6e 696e  After tombstonin
-0000c0e0: 6720 6120 7374 7265 616d 2c20 6974 5c27  g a stream, it\'
-0000c0f0: 7320 6e6f 7420 706f 7373 6962 6c65 2074  s not possible t
-0000c100: 6f20 6170 7065 6e64 206e 6577 2065 7665  o append new eve
-0000c110: 6e74 732e 5c6e 5c6e 5c6e 2323 2043 6174  nts.\n\n\n## Cat
-0000c120: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-0000c130: 6f6e 735c 6e5c 6e22 4361 7463 682d 7570  ons\n\n"Catch-up
-0000c140: 2220 7375 6273 6372 6970 7469 6f6e 7320  " subscriptions 
-0000c150: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
-0000c160: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
-0000c170: 6174 2068 6176 6520 6265 656e 2072 6563  at have been rec
-0000c180: 6f72 6465 645c 6e69 6e20 7468 6520 6461  orded\nin the da
-0000c190: 7461 6261 7365 2c20 616e 6420 616c 736f  tabase, and also
-0000c1a0: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
-0000c1b0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
-0000c1c0: 6120 7375 6273 6372 6970 7469 6f6e 2077  a subscription w
-0000c1d0: 6173 2073 7461 7274 6564 2e5c 6e5c 6e54  as started.\n\nT
-0000c1e0: 6865 206d 6574 686f 6420 6073 7562 7363  he method `subsc
-0000c1f0: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
-0000c200: 2960 2073 7461 7274 7320 6120 6361 7463  )` starts a catc
-0000c210: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-0000c220: 6e20 746f 2072 6563 6569 7665 2061 6c6c  n to receive all
-0000c230: 5c6e 6576 656e 7473 2074 6861 7420 6861  \nevents that ha
-0000c240: 7665 2062 6565 6e20 616e 6420 7769 6c6c  ve been and will
-0000c250: 2062 6520 7265 636f 7264 6564 2069 6e20   be recorded in 
-0000c260: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
-0000c270: 6520 6d65 7468 6f64 5c6e 6073 7562 7363  e method\n`subsc
-0000c280: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
-0000c290: 7473 2829 6020 7374 6172 7473 2061 2063  ts()` starts a c
-0000c2a0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000c2b0: 7469 6f6e 2074 6f20 7265 6365 6976 6520  tion to receive 
-0000c2c0: 6576 656e 7473 2066 726f 6d5c 6e61 2073  events from\na s
-0000c2d0: 7065 6369 6669 6320 7374 7265 616d 2e5c  pecific stream.\
-0000c2e0: 6e5c 6e43 6174 6368 2d75 7020 7375 6273  n\nCatch-up subs
-0000c2f0: 6372 6970 7469 6f6e 7320 656e 6361 7073  criptions encaps
-0000c300: 756c 6174 6520 6120 7374 7265 616d 696e  ulate a streamin
-0000c310: 6720 6752 5043 2063 616c 6c20 7768 6963  g gRPC call whic
-0000c320: 6820 6973 5c6e 6b65 7074 206f 7065 6e20  h is\nkept open 
-0000c330: 6279 2074 6865 2073 6572 7665 722c 2077  by the server, w
-0000c340: 6974 6820 6e65 776c 7920 7265 636f 7264  ith newly record
-0000c350: 6564 2065 7665 6e74 7320 7365 6e74 2074  ed events sent t
-0000c360: 6f20 7468 6520 636c 6965 6e74 5c6e 6173  o the client\nas
-0000c370: 2074 6865 2063 6c69 656e 7420 6974 6572   the client iter
-0000c380: 6174 6573 206f 7665 7220 7468 6520 7375  ates over the su
-0000c390: 6273 6372 6970 7469 6f6e 2072 6573 706f  bscription respo
-0000c3a0: 6e73 652e 5c6e 5c6e 4d61 6e79 2063 6174  nse.\n\nMany cat
-0000c3b0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-0000c3c0: 6f6e 7320 6361 6e20 6265 2063 7265 6174  ons can be creat
-0000c3d0: 6564 2c20 636f 6e63 7572 7265 6e74 6c79  ed, concurrently
-0000c3e0: 206f 7220 7375 6363 6573 7369 7665 6c79   or successively
-0000c3f0: 2c20 616e 6420 616c 6c5c 6e77 696c 6c20  , and all\nwill 
-0000c400: 7265 6365 6976 6520 616c 6c20 7468 6520  receive all the 
-0000c410: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000c420: 7468 6579 2068 6176 6520 6265 656e 2072  they have been r
-0000c430: 6571 7565 7374 6564 2074 6f20 7265 6365  equested to rece
-0000c440: 6976 652e 5c6e 5c6e 5468 6520 7265 6365  ive.\n\nThe rece
-0000c450: 6976 6564 2072 6563 6f72 6465 6420 6576  ived recorded ev
-0000c460: 656e 7420 6f62 6a65 6374 2061 7265 2069  ent object are i
-0000c470: 6e73 7461 6e63 6573 206f 6620 7468 6520  nstances of the 
-0000c480: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
-0000c490: 636c 6173 735c 6e28 7365 6520 7468 6520  class\n(see the 
-0000c4a0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-0000c4b0: 6c6f 7720 666f 7220 6465 7461 696c 7320  low for details 
-0000c4c0: 6f66 2074 6869 7320 636c 6173 7329 2e5c  of this class).\
-0000c4d0: 6e5c 6e23 2323 2048 6f77 2074 6f20 696d  n\n### How to im
-0000c4e0: 706c 656d 656e 7420 6578 6163 746c 792d  plement exactly-
-0000c4f0: 6f6e 6365 2065 7665 6e74 2070 726f 6365  once event proce
-0000c500: 7373 696e 675c 6e5c 6e54 6865 2063 6f6d  ssing\n\nThe com
-0000c510: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
-0000c520: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000c530: 2074 6861 7420 6172 6520 7265 6365 6976   that are receiv
-0000c540: 6564 2061 6e64 2070 726f 6365 7373 6564  ed and processed
-0000c550: 2062 7920 615c 6e64 6f77 6e73 7472 6561   by a\ndownstrea
-0000c560: 6d20 636f 6d70 6f6e 656e 7420 6172 6520  m component are 
-0000c570: 7573 6566 756c 6c79 2072 6563 6f72 6465  usefully recorde
-0000c580: 6420 6279 2074 6865 2064 6f77 6e73 7472  d by the downstr
-0000c590: 6561 6d20 636f 6d70 6f6e 656e 7420 736f  eam component so
-0000c5a0: 2074 6861 745c 6e74 6865 2063 6f6d 6d69   that\nthe commi
-0000c5b0: 7420 706f 7369 7469 6f6e 206f 6620 6c61  t position of la
-0000c5c0: 7374 2070 726f 6365 7373 6564 2065 7665  st processed eve
-0000c5d0: 6e74 2063 616e 2062 6520 6465 7465 726d  nt can be determ
-0000c5e0: 696e 6564 2e5c 6e5c 6e54 6865 206c 6173  ined.\n\nThe las
-0000c5f0: 7420 7265 636f 7264 6564 2063 6f6d 6d69  t recorded commi
-0000c600: 7420 706f 7369 7469 6f6e 2063 616e 2062  t position can b
-0000c610: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
-0000c620: 7920 7468 6520 636f 6d6d 6974 2070 6f73  y the commit pos
-0000c630: 6974 696f 6e20 6672 6f6d 2077 6869 6368  ition from which
-0000c640: 5c6e 746f 2073 7562 7363 7269 6265 2077  \nto subscribe w
-0000c650: 6865 6e20 7072 6f63 6573 7369 6e67 2069  hen processing i
-0000c660: 7320 7265 7375 6d65 642e 2053 696e 6365  s resumed. Since
-0000c670: 2074 6869 7320 636f 6d6d 6974 2070 6f73   this commit pos
-0000c680: 6974 696f 6e20 7769 6c6c 2072 6570 7265  ition will repre
-0000c690: 7365 6e74 2074 6865 5c6e 706f 7369 7469  sent the\npositi
-0000c6a0: 6f6e 206f 6620 7468 6520 6c61 7374 2073  on of the last s
-0000c6b0: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
-0000c6c0: 6573 7365 6420 6576 656e 7420 696e 2061  essed event in a
-0000c6d0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000c6e0: 6f6e 656e 742c 2073 6f20 6974 5c6e 7769  onent, so it\nwi
-0000c6f0: 6c6c 2062 6520 7573 7561 6c20 746f 2077  ll be usual to w
-0000c700: 616e 7420 7468 6520 6e65 7874 2065 7665  ant the next eve
-0000c710: 6e74 2061 6674 6572 2074 6869 7320 706f  nt after this po
-0000c720: 7369 7469 6f6e 2c20 6265 6361 7573 6520  sition, because 
-0000c730: 7468 6174 2069 7320 7468 6520 6e65 7874  that is the next
-0000c740: 5c6e 6576 656e 7420 7468 6174 2068 6173  \nevent that has
-0000c750: 206e 6f74 2079 6574 2062 6565 6e20 7072   not yet been pr
-0000c760: 6f63 6573 7365 642e 2046 6f72 2074 6869  ocessed. For thi
-0000c770: 7320 7265 6173 6f6e 2c20 7768 656e 2073  s reason, when s
-0000c780: 7562 7363 7269 6269 6e67 2066 6f72 2065  ubscribing for e
-0000c790: 7665 6e74 735c 6e66 726f 6d20 6120 7370  vents\nfrom a sp
-0000c7a0: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
-0000c7b0: 7369 7469 6f6e 2075 7369 6e67 2061 2063  sition using a c
-0000c7c0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000c7d0: 7469 6f6e 2069 6e20 4576 656e 7453 746f  tion in EventSto
-0000c7e0: 7265 4442 2c20 7468 655c 6e72 6563 6f72  reDB, the\nrecor
-0000c7f0: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
-0000c800: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-0000c810: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
-0000c820: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
-0000c830: 696e 2074 6865 2073 6571 7565 6e63 655c  in the sequence\
-0000c840: 6e6f 6620 7265 636f 7264 6564 2065 7665  nof recorded eve
-0000c850: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
-0000c860: 6569 7665 642e 5c6e 5c6e 546f 2061 6363  eived.\n\nTo acc
-0000c870: 6f6d 706c 6973 6820 2265 7861 6374 6c79  omplish "exactly
-0000c880: 2d6f 6e63 6522 2070 726f 6365 7373 696e  -once" processin
-0000c890: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
-0000c8a0: 656e 7473 2069 6e20 6120 646f 776e 7374  ents in a downst
-0000c8b0: 7265 616d 5c6e 636f 6d70 6f6e 656e 7420  ream\ncomponent 
-0000c8c0: 7768 656e 2075 7369 6e67 2061 2063 6174  when using a cat
-0000c8d0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-0000c8e0: 6f6e 2c20 7468 6520 636f 6d6d 6974 2070  on, the commit p
-0000c8f0: 6f73 6974 696f 6e20 6f66 2061 2072 6563  osition of a rec
-0000c900: 6f72 6465 645c 6e65 7665 6e74 2073 686f  orded\nevent sho
-0000c910: 756c 6420 6265 2072 6563 6f72 6465 6420  uld be recorded 
-0000c920: 6174 6f6d 6963 616c 6c79 2061 6e64 2075  atomically and u
-0000c930: 6e69 7175 656c 7920 616c 6f6e 6720 7769  niquely along wi
-0000c940: 7468 2074 6865 2072 6573 756c 7420 6f66  th the result of
-0000c950: 2070 726f 6365 7373 696e 675c 6e72 6563   processing\nrec
-0000c960: 6f72 6465 6420 6576 656e 7473 2c20 666f  orded events, fo
-0000c970: 7220 6578 616d 706c 6520 696e 2074 6865  r example in the
-0000c980: 2073 616d 6520 6461 7461 6261 7365 2061   same database a
-0000c990: 7320 6d61 7465 7269 616c 6973 6564 2076  s materialised v
-0000c9a0: 6965 7773 2077 6865 6e5c 6e69 6d70 6c65  iews when\nimple
-0000c9b0: 6d65 6e74 696e 6720 6576 656e 7475 616c  menting eventual
-0000c9c0: 6c79 2d63 6f6e 7369 7374 656e 7420 4351  ly-consistent CQ
-0000c9d0: 5253 2c20 6f72 2069 6e20 7468 6520 7361  RS, or in the sa
-0000c9e0: 6d65 2064 6174 6162 6173 6520 6173 2061  me database as a
-0000c9f0: 2064 6f77 6e73 7472 6561 6d5c 6e61 6e61   downstream\nana
-0000ca00: 6c79 7469 6373 206f 7220 7265 706f 7274  lytics or report
-0000ca10: 696e 6720 6f72 2061 7263 6869 7669 6e67  ing or archiving
-0000ca20: 2061 7070 6c69 6361 7469 6f6e 2e20 4279   application. By
-0000ca30: 2072 6563 6f72 6469 6e67 2074 6865 2063   recording the c
-0000ca40: 6f6d 6d69 7420 706f 7369 7469 6f6e 5c6e  ommit position\n
-0000ca50: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-0000ca60: 7473 2061 746f 6d69 6361 6c6c 7920 7769  ts atomically wi
-0000ca70: 7468 2074 6865 206e 6577 2073 7461 7465  th the new state
-0000ca80: 2074 6861 7420 7265 7375 6c74 7320 6672   that results fr
-0000ca90: 6f6d 2070 726f 6365 7373 696e 675c 6e72  om processing\nr
-0000caa0: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
-0000cab0: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
-0000cac0: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
-0000cad0: 6e20 6f66 2072 6563 6f72 6465 6420 6576  n of recorded ev
-0000cae0: 656e 7473 2063 616e 2062 655c 6e61 766f  ents can be\navo
-0000caf0: 6964 6564 2e20 4279 2061 6c73 6f20 7265  ided. By also re
-0000cb00: 636f 7264 696e 6720 7468 6520 636f 6d6d  cording the comm
-0000cb10: 6974 2070 6f73 6974 696f 6e20 756e 6971  it position uniq
-0000cb20: 7565 6c79 2c20 7468 6520 6e65 7720 7374  uely, the new st
-0000cb30: 6174 6520 6361 6e6e 6f74 2062 655c 6e72  ate cannot be\nr
-0000cb40: 6563 6f72 6465 6420 7477 6963 652c 2061  ecorded twice, a
-0000cb50: 6e64 2068 656e 6365 2074 6865 2072 6563  nd hence the rec
-0000cb60: 6f72 6465 6420 7374 6174 6520 6f66 2074  orded state of t
-0000cb70: 6865 2064 6f77 6e73 7472 6561 6d20 636f  he downstream co
-0000cb80: 6d70 6f6e 656e 7420 7769 6c6c 2062 655c  mponent will be\
-0000cb90: 6e75 7064 6174 6564 206f 6e6c 7920 6f6e  nupdated only on
-0000cba0: 6365 2066 6f72 2061 6e79 2072 6563 6f72  ce for any recor
-0000cbb0: 6465 6420 6576 656e 742e 2042 7920 7573  ded event. By us
-0000cbc0: 696e 6720 7468 6520 6772 6561 7465 7374  ing the greatest
-0000cbd0: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
-0000cbe0: 5c6e 706f 7369 7469 6f6e 2074 6f20 7265  \nposition to re
-0000cbf0: 7375 6d65 2061 2063 6174 6368 2d75 7020  sume a catch-up 
-0000cc00: 7375 6273 6372 6970 7469 6f6e 2c20 616c  subscription, al
-0000cc10: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-0000cc20: 7320 7769 6c6c 2065 7665 6e74 7561 6c6c  s will eventuall
-0000cc30: 795c 6e62 6520 7072 6f63 6573 7365 642e  y\nbe processed.
-0000cc40: 2054 6865 2063 6f6d 6269 6e61 7469 6f6e   The combination
-0000cc50: 206f 6620 7468 6520 2261 742d 6d6f 7374   of the "at-most
-0000cc60: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
-0000cc70: 2061 6e64 2074 6865 2022 6174 2d6c 6561   and the "at-lea
-0000cc80: 7374 2d6f 6e63 6522 5c6e 636f 6e64 6974  st-once"\ncondit
-0000cc90: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
-0000cca0: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
-0000ccb0: 6469 7469 6f6e 2e5c 6e5c 6e54 6865 2064  dition.\n\nThe d
-0000ccc0: 616e 6765 7220 7769 7468 2022 6475 616c  anger with "dual
-0000ccd0: 2077 7269 7469 6e67 2220 696e 2074 6865   writing" in the
-0000cce0: 2063 6f6e 7375 6d70 7469 6f6e 206f 6620   consumption of 
-0000ccf0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000cd00: 6973 2074 6861 7420 6966 2061 5c6e 7265  is that if a\nre
-0000cd10: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
-0000cd20: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-0000cd30: 6365 7373 6564 2061 6e64 206e 6577 2073  cessed and new s
-0000cd40: 7461 7465 2072 6563 6f72 6465 6420 6174  tate recorded at
-0000cd50: 6f6d 6963 616c 6c79 2069 6e20 6f6e 655c  omically in one\
-0000cd60: 6e74 7261 6e73 6163 7469 6f6e 2077 6974  ntransaction wit
-0000cd70: 6820 7468 6520 636f 6d6d 6974 2070 6f73  h the commit pos
-0000cd80: 6974 696f 6e20 7265 636f 7264 6564 2069  ition recorded i
-0000cd90: 6e20 6120 7365 7061 7261 7465 2074 7261  n a separate tra
-0000cda0: 6e73 6163 7469 6f6e 2c20 6f6e 6520 6d61  nsaction, one ma
-0000cdb0: 795c 6e68 6170 7065 6e20 616e 6420 6e6f  y\nhappen and no
-0000cdc0: 7420 7468 6520 6f74 6865 722e 2049 6620  t the other. If 
-0000cdd0: 7468 6520 6e65 7720 7374 6174 6520 6973  the new state is
-0000cde0: 2072 6563 6f72 6465 6420 6275 7420 7468   recorded but th
-0000cdf0: 6520 706f 7369 7469 6f6e 2069 7320 6c6f  e position is lo
-0000ce00: 7374 2c5c 6e61 6e64 2074 6865 6e20 7468  st,\nand then th
-0000ce10: 6520 7072 6f63 6573 7369 6e67 2069 7320  e processing is 
-0000ce20: 7374 6f70 7065 6420 616e 6420 7265 7375  stopped and resu
-0000ce30: 6d65 642c 2074 6865 2072 6563 6f72 6465  med, the recorde
-0000ce40: 6420 6576 656e 7420 6d61 7920 6265 2070  d event may be p
-0000ce50: 726f 6365 7373 6564 5c6e 7477 6963 652e  rocessed\ntwice.
-0000ce60: 204f 6e20 7468 6520 6f74 6865 7220 6861   On the other ha
-0000ce70: 6e64 2c20 6966 2074 6865 2063 6f6d 6d69  nd, if the commi
-0000ce80: 7420 706f 7369 7469 6f6e 2069 7320 7265  t position is re
-0000ce90: 636f 7264 6564 2062 7574 2074 6865 206e  corded but the n
-0000cea0: 6577 2073 7461 7465 2069 735c 6e6c 6f73  ew state is\nlos
-0000ceb0: 742c 2074 6865 2072 6563 6f72 6465 6420  t, the recorded 
-0000cec0: 6576 656e 7420 6d61 7920 6566 6665 6374  event may effect
-0000ced0: 6976 656c 7920 6e6f 7420 6265 2070 726f  ively not be pro
-0000cee0: 6365 7373 6564 2061 7420 616c 6c2e 2042  cessed at all. B
-0000cef0: 7920 6569 7468 6572 5c6e 7072 6f63 6573  y either\nproces
-0000cf00: 7369 6e67 2061 6e20 6576 656e 7420 6d6f  sing an event mo
-0000cf10: 7265 2074 6861 6e20 6f6e 6365 2c20 6f72  re than once, or
-0000cf20: 2062 7920 6661 696c 696e 6720 746f 2070   by failing to p
-0000cf30: 726f 6365 7373 2061 6e20 6576 656e 742c  rocess an event,
-0000cf40: 2074 6865 2072 6563 6f72 6465 645c 6e73   the recorded\ns
-0000cf50: 7461 7465 206f 6620 7468 6520 646f 776e  tate of the down
-0000cf60: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000cf70: 206d 6967 6874 2062 6520 696e 6163 6375   might be inaccu
-0000cf80: 7261 7465 2c20 6f72 2070 6f73 7369 626c  rate, or possibl
-0000cf90: 7920 696e 636f 6e73 6973 7465 6e74 2c20  y inconsistent, 
-0000cfa0: 616e 645c 6e70 6572 6861 7073 2063 6174  and\nperhaps cat
-0000cfb0: 6173 7472 6f70 6869 6361 6c6c 7920 736f  astrophically so
-0000cfc0: 2e20 5375 6368 2063 6f6e 7365 7175 656e  . Such consequen
-0000cfd0: 6365 7320 6d61 7920 6f72 206d 6179 206e  ces may or may n
-0000cfe0: 6f74 206d 6174 7465 7220 696e 2079 6f75  ot matter in you
-0000cff0: 7220 7369 7475 6174 696f 6e2e 5c6e 4275  r situation.\nBu
-0000d000: 7420 736f 6d65 7469 6d65 7320 696e 636f  t sometimes inco
-0000d010: 6e73 6973 7465 6e63 6965 7320 6d61 7920  nsistencies may 
-0000d020: 6861 6c74 2070 726f 6365 7373 696e 6720  halt processing 
-0000d030: 756e 7469 6c20 7468 6520 6973 7375 6520  until the issue 
-0000d040: 6973 2072 6573 6f6c 7665 642e 2059 6f75  is resolved. You
-0000d050: 2063 616e 5c6e 6176 6f69 6420 2264 7561   can\navoid "dua
-0000d060: 6c20 7772 6974 696e 6722 2069 6e20 7468  l writing" in th
-0000d070: 6520 636f 6e73 756d 7074 696f 6e20 6f66  e consumption of
-0000d080: 2065 7665 6e74 7320 6279 2061 746f 6d69   events by atomi
-0000d090: 6361 6c6c 7920 7265 636f 7264 696e 6720  cally recording 
-0000d0a0: 7468 6520 636f 6d6d 6974 5c6e 706f 7369  the commit\nposi
-0000d0b0: 7469 6f6e 206f 6620 6120 7265 636f 7264  tion of a record
-0000d0c0: 6564 2065 7665 6e74 2061 6c6f 6e67 2077  ed event along w
-0000d0d0: 6974 6820 7468 6520 6e65 7720 7374 6174  ith the new stat
-0000d0e0: 6520 7468 6174 2072 6573 756c 7473 2066  e that results f
-0000d0f0: 726f 6d20 7072 6f63 6573 7369 6e67 2074  rom processing t
-0000d100: 6861 745c 6e65 7665 6e74 2069 6e20 7468  hat\nevent in th
-0000d110: 6520 7361 6d65 2061 746f 6d69 6320 7472  e same atomic tr
-0000d120: 616e 7361 6374 696f 6e2e 2042 7920 6d61  ansaction. By ma
-0000d130: 6b69 6e67 2074 6865 2072 6563 6f72 6469  king the recordi
-0000d140: 6e67 206f 6620 7468 6520 636f 6d6d 6974  ng of the commit
-0000d150: 2070 6f73 6974 696f 6e73 5c6e 756e 6971   positions\nuniq
-0000d160: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
-0000d170: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
-0000d180: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
-0000d190: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
-0000d1a0: 666c 6963 742c 2079 6f75 2077 696c 6c5c  flict, you will\
-0000d1b0: 6e70 7265 7665 6e74 2074 6865 2072 6573  nprevent the res
-0000d1c0: 756c 7473 206f 6620 616e 7920 6475 706c  ults of any dupl
-0000d1d0: 6963 6174 6520 7072 6f63 6573 7369 6e67  icate processing
-0000d1e0: 206f 6620 6120 7265 636f 7264 6564 2065   of a recorded e
-0000d1f0: 7665 6e74 2062 6569 6e67 2063 6f6d 6d69  vent being commi
-0000d200: 7474 6564 2e5c 6e5c 6e52 6563 6f72 6465  tted.\n\nRecorde
-0000d210: 6420 6576 656e 7473 2072 6563 6569 7665  d events receive
-0000d220: 6420 6672 6f6d 2061 2063 6174 6368 2d75  d from a catch-u
-0000d230: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
-0000d240: 616e 6e6f 7420 6265 2061 636b 6e6f 776c  annot be acknowl
-0000d250: 6564 6765 6420 6261 636b 5c6e 746f 2074  edged back\nto t
-0000d260: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-0000d270: 7365 7276 6572 2e20 4163 6b6e 6f77 6c65  server. Acknowle
-0000d280: 6467 696e 6720 6576 656e 7473 2c20 686f  dging events, ho
-0000d290: 7765 7665 722c 2069 7320 616e 2061 7370  wever, is an asp
-0000d2a0: 6563 7420 6f66 2022 7065 7273 6973 7465  ect of "persiste
-0000d2b0: 6e74 5c6e 7375 6273 6372 6970 7469 6f6e  nt\nsubscription
-0000d2c0: 7322 2e20 486f 7069 6e67 2074 6f20 7265  s". Hoping to re
-0000d2d0: 6c79 206f 6e20 6163 6b6e 6f77 6c65 6467  ly on acknowledg
-0000d2e0: 696e 6720 6576 656e 7473 2074 6f20 616e  ing events to an
-0000d2f0: 2075 7073 7472 6561 6d5c 6e63 6f6d 706f   upstream\ncompo
-0000d300: 6e65 6e74 2069 7320 616e 2065 7861 6d70  nent is an examp
-0000d310: 6c65 206f 6620 6475 616c 2077 7269 7469  le of dual writi
-0000d320: 6e67 2e5c 6e5c 6e23 2323 2053 7562 7363  ng.\n\n### Subsc
-0000d330: 7269 6265 2061 6c6c 2065 7665 6e74 735c  ribe all events\
-0000d340: 6e5c 6e54 6865 6073 7562 7363 7269 6265  n\nThe`subscribe
-0000d350: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
-0000d360: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-0000d370: 6420 746f 2073 7461 7274 2061 2022 6361  d to start a "ca
-0000d380: 7463 682d 7570 2220 7375 6273 6372 6970  tch-up" subscrip
-0000d390: 7469 6f6e 5c6e 7468 6174 2063 616e 2072  tion\nthat can r
-0000d3a0: 6574 7572 6e20 6576 656e 7473 2066 726f  eturn events fro
-0000d3b0: 6d20 616c 6c20 7374 7265 616d 7320 696e  m all streams in
-0000d3c0: 2074 6865 2064 6174 6162 6173 652e 5c6e   the database.\n
-0000d3d0: 5c6e 5468 6973 206d 6574 686f 6420 6361  \nThis method ca
-0000d3e0: 6e20 6265 2075 7365 6420 6279 2061 2064  n be used by a d
-0000d3f0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-0000d400: 656e 745c 6e74 6f20 7072 6f63 6573 7320  ent\nto process 
-0000d410: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000d420: 7769 7468 2065 7861 6374 6c79 2d6f 6e63  with exactly-onc
-0000d430: 6520 7365 6d61 6e74 6963 732e 5c6e 5c6e  e semantics.\n\n
-0000d440: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-0000d450: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
-0000d460: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
-0000d470: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-0000d480: 6361 6e20 6265 5c6e 7573 6564 2074 6f20  can be\nused to 
-0000d490: 7370 6563 6966 7920 6120 636f 6d6d 6974  specify a commit
-0000d4a0: 2070 6f73 6974 696f 6e20 6672 6f6d 2077   position from w
-0000d4b0: 6869 6368 2074 6f20 7375 6273 6372 6962  hich to subscrib
-0000d4c0: 652e 2054 6865 2064 6566 6175 6c74 5c6e  e. The default\n
-0000d4d0: 7661 6c75 6520 6973 2060 4e6f 6e65 602c  value is `None`,
-0000d4e0: 2077 6869 6368 206d 6561 6e73 2074 6865   which means the
-0000d4f0: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
-0000d500: 6c6c 206f 7065 7261 7465 2066 726f 6d20  ll operate from 
-0000d510: 7468 6520 6669 7273 745c 6e72 6563 6f72  the first\nrecor
-0000d520: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
-0000d530: 2064 6174 6162 6173 652e 2049 6620 6120   database. If a 
-0000d540: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000d550: 6973 2067 6976 656e 2c20 6974 206d 7573  is given, it mus
-0000d560: 7420 6d61 7463 685c 6e61 6e20 6163 7475  t match\nan actu
-0000d570: 616c 6c79 2065 7869 7374 696e 6720 636f  ally existing co
-0000d580: 6d6d 6974 2070 6f73 6974 696f 6e20 696e  mmit position in
-0000d590: 2074 6865 2064 6174 6162 6173 652e 2054   the database. T
-0000d5a0: 6865 2072 6563 6f64 6564 2065 7665 6e74  he recoded event
-0000d5b0: 7320 7468 6174 5c6e 6172 6520 6f62 7461  s that\nare obta
-0000d5c0: 696e 6564 2077 696c 6c20 6e6f 7420 696e  ined will not in
-0000d5d0: 636c 7564 6520 7468 6520 6576 656e 7420  clude the event 
-0000d5e0: 7265 636f 7264 6564 2061 7420 7468 6174  recorded at that
-0000d5f0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000d600: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-0000d610: 2061 6c73 6f20 7461 6b65 7320 666f 7572   also takes four
-0000d620: 206f 7468 6572 206f 7074 696f 6e61 6c20   other optional 
-0000d630: 6172 6775 6d65 6e74 732c 2060 6669 6c74  arguments, `filt
-0000d640: 6572 5f65 7863 6c75 6465 602c 5c6e 6066  er_exclude`,\n`f
-0000d650: 696c 7465 725f 696e 636c 7564 6560 2c20  ilter_include`, 
-0000d660: 6066 696c 7465 725f 6279 5f73 7472 6561  `filter_by_strea
-0000d670: 6d5f 6e61 6d65 602c 2061 6e64 2060 7469  m_name`, and `ti
-0000d680: 6d65 6f75 7460 2e5c 6e5c 6e54 6865 206f  meout`.\n\nThe o
-0000d690: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-0000d6a0: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
-0000d6b0: 6020 6973 2061 2073 6571 7565 6e63 6520  ` is a sequence 
-0000d6c0: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
-0000d6d0: 7373 696f 6e73 2074 6861 745c 6e6d 6174  ssions that\nmat
-0000d6e0: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
-0000d6f0: 7473 2074 6861 7420 7368 6f75 6c64 206e  ts that should n
-0000d700: 6f74 2062 6520 696e 636c 7564 6564 2e20  ot be included. 
-0000d710: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
-0000d720: 2069 676e 6f72 6564 5c6e 6966 2060 6669   ignored\nif `fi
-0000d730: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
-0000d740: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
-0000d750: 7074 7920 7365 7175 656e 6365 2e20 4279  pty sequence. By
-0000d760: 2064 6566 6175 6c74 2c20 7468 6973 2061   default, this a
-0000d770: 7267 756d 656e 7420 6973 2073 6574 5c6e  rgument is set\n
-0000d780: 746f 206d 6174 6368 2074 6865 2065 7665  to match the eve
-0000d790: 6e74 2074 7970 6573 206f 6620 2273 7973  nt types of "sys
-0000d7a0: 7465 6d20 6576 656e 7473 222c 2073 6f20  tem events", so 
-0000d7b0: 7468 6174 2045 7665 6e74 5374 6f72 6544  that EventStoreD
-0000d7c0: 4220 7379 7374 656d 2065 7665 6e74 735c  B system events\
-0000d7d0: 6e77 696c 6c20 6e6f 7420 6e6f 726d 616c  nwill not normal
-0000d7e0: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
-0000d7f0: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-0000d800: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-0000d810: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-0000d820: 5c6e 6162 6f75 7420 6669 6c74 6572 2065  \nabout filter e
-0000d830: 7870 7265 7373 696f 6e73 2e5c 6e5c 6e54  xpressions.\n\nT
-0000d840: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
-0000d850: 6d65 6e74 2060 6669 6c74 6572 5f69 6e63  ment `filter_inc
-0000d860: 6c75 6465 6020 6973 2061 2073 6571 7565  lude` is a seque
-0000d870: 6e63 6520 6f66 2072 6567 756c 6172 2065  nce of regular e
-0000d880: 7870 7265 7373 696f 6e73 5c6e 7468 6174  xpressions\nthat
-0000d890: 206d 6174 6368 2072 6563 6f72 6465 6420   match recorded 
-0000d8a0: 6576 656e 7473 2074 6861 7420 7368 6f75  events that shou
-0000d8b0: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
-0000d8c0: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
-0000d8d0: 2061 7267 756d 656e 745c 6e69 7320 616e   argument\nis an
-0000d8e0: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
-0000d8f0: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-0000d900: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
-0000d910: 6d70 7479 2073 6571 7565 6e63 652c 2074  mpty sequence, t
-0000d920: 6865 5c6e 6066 696c 7465 725f 6578 636c  he\n`filter_excl
-0000d930: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
-0000d940: 2069 676e 6f72 6564 2e5c 6e5c 6e54 6865   ignored.\n\nThe
-0000d950: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000d960: 6e74 2060 6669 6c74 6572 5f62 795f 7374  nt `filter_by_st
-0000d970: 7265 616d 5f6e 616d 6560 2069 7320 6120  ream_name` is a 
-0000d980: 5079 7468 6f6e 2060 626f 6f6c 6020 7468  Python `bool` th
-0000d990: 6174 2069 6e64 6963 6174 6573 2077 6865  at indicates whe
-0000d9a0: 7468 6572 5c6e 7468 6520 6669 6c74 6572  ther\nthe filter
-0000d9b0: 2077 696c 6c20 6170 706c 7920 746f 2065   will apply to e
-0000d9c0: 7665 6e74 2074 7970 6573 206f 7220 7374  vent types or st
-0000d9d0: 7265 616d 206e 616d 6573 2e20 4279 2064  ream names. By d
-0000d9e0: 6566 6175 6c74 2c20 7468 6973 2076 616c  efault, this val
-0000d9f0: 7565 2069 7320 6046 616c 7365 605c 6e61  ue is `False`\na
-0000da00: 6e64 2073 6f20 7468 6520 6669 6c74 6572  nd so the filter
-0000da10: 696e 6720 7769 6c6c 2061 7070 6c79 2074  ing will apply t
-0000da20: 6f20 7468 6520 6576 656e 7420 7479 7065  o the event type
-0000da30: 2073 7472 696e 6773 206f 6620 7265 636f   strings of reco
-0000da40: 7264 6564 2065 7665 6e74 732e 5c6e 5c6e  rded events.\n\n
-0000da50: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-0000da60: 2066 696c 7465 7269 6e67 2068 6170 7065   filtering happe
-0000da70: 6e73 206f 6e20 7468 6520 4576 656e 7453  ns on the EventS
-0000da80: 746f 7265 4442 2073 6572 7665 722c 2061  toreDB server, a
-0000da90: 6e64 2074 6865 5c6e 606c 696d 6974 6020  nd the\n`limit` 
-0000daa0: 6172 6775 6d65 6e74 2069 7320 6170 706c  argument is appl
-0000dab0: 6965 6420 6f6e 2074 6865 2073 6572 7665  ied on the serve
-0000dac0: 7220 6166 7465 7220 6669 6c74 6572 696e  r after filterin
-0000dad0: 672e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  g.\n\nThe option
-0000dae0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-0000daf0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-0000db00: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
-0000db10: 7365 7473 2061 5c6e 6465 6164 6c69 6e65  sets a\ndeadline
-0000db20: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-0000db30: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-0000db40: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
-0000db50: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
-0000db60: 7320 6120 5079 7468 6f6e 2069 7465 7261  s a Python itera
-0000db70: 746f 7220 7468 6174 2079 6965 6c64 7320  tor that yields 
-0000db80: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
-0000db90: 2069 6e63 6c75 6469 6e67 2065 7665 6e74   including event
-0000dba0: 735c 6e74 6861 7420 6172 6520 7265 636f  s\nthat are reco
-0000dbb0: 7264 6564 2061 6674 6572 2074 6865 2073  rded after the s
-0000dbc0: 7562 7363 7269 7074 696f 6e20 7761 7320  ubscription was 
-0000dbd0: 6372 6561 7465 642e 2049 7465 7261 7469  created. Iterati
-0000dbe0: 6e67 206f 7665 7220 7468 6973 206f 626a  ng over this obj
-0000dbf0: 6563 7420 7769 6c6c 5c6e 7468 6572 6566  ect will\ntheref
-0000dc00: 6f72 6520 6e6f 7420 7374 6f70 2c20 756e  ore not stop, un
-0000dc10: 6c65 7373 2074 6865 2063 6f6e 6e65 6374  less the connect
-0000dc20: 696f 6e20 746f 2074 6865 2064 6174 6162  ion to the datab
-0000dc30: 6173 6520 6973 206c 6f73 742e 2054 6865  ase is lost. The
-0000dc40: 2063 616c 6c20 7769 6c6c 5c6e 6265 2065   call will\nbe e
-0000dc50: 6e64 6564 2077 6865 6e20 7468 6520 6974  nded when the it
-0000dc60: 6572 6174 6f72 206f 626a 6563 7420 6973  erator object is
-0000dc70: 2064 656c 6574 6564 2066 726f 6d20 6d65   deleted from me
-0000dc80: 6d6f 7279 2c20 7768 6963 6820 7769 6c6c  mory, which will
-0000dc90: 2068 6170 7065 6e20 7768 656e 2074 6865   happen when the
-0000dca0: 5c6e 6974 6572 6174 6f72 206f 626a 6563  \niterator objec
-0000dcb0: 7420 676f 6573 206f 7574 206f 6620 7363  t goes out of sc
-0000dcc0: 6f70 6520 6f72 2069 7320 6578 706c 6963  ope or is explic
-0000dcd0: 6974 6c79 2064 656c 6574 6564 2e20 5468  itly deleted. Th
-0000dce0: 6520 6361 6c6c 206d 6179 2061 6c73 6f20  e call may also 
-0000dcf0: 6265 5c6e 636c 6f73 6564 2062 7920 7468  be\nclosed by th
-0000dd00: 6520 7365 7276 6572 2e5c 6e5c 6e54 6865  e server.\n\nThe
-0000dd10: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
-0000dd20: 6a65 6374 2063 616e 2062 6520 7573 6564  ject can be used
-0000dd30: 2064 6972 6563 746c 792c 2062 7574 2069   directly, but i
-0000dd40: 7420 6d69 6768 7420 6265 2075 7365 6420  t might be used 
-0000dd50: 7769 7468 696e 2061 2074 6872 6561 6465  within a threade
-0000dd60: 645c 6e6c 6f6f 7020 6465 6469 6361 7465  d\nloop dedicate
-0000dd70: 6420 746f 2072 6563 6569 7669 6e67 2065  d to receiving e
-0000dd80: 7665 6e74 7320 7468 6174 2063 616e 2062  vents that can b
-0000dd90: 6520 7374 6f70 7065 6420 696e 2061 2063  e stopped in a c
-0000dda0: 6f6e 7472 6f6c 6c65 6420 7761 792c 2077  ontrolled way, w
-0000ddb0: 6974 685c 6e72 6563 6f72 6465 6420 6576  ith\nrecorded ev
-0000ddc0: 656e 7473 2070 7574 206f 6e20 6120 7175  ents put on a qu
-0000ddd0: 6575 6520 666f 7220 7072 6f63 6573 7369  eue for processi
-0000dde0: 6e67 2069 6e20 6120 6469 6666 6572 656e  ng in a differen
-0000ddf0: 7420 7468 7265 6164 2e20 5468 6973 2070  t thread. This p
-0000de00: 6163 6b61 6765 5c6e 646f 6573 6e5c 2774  ackage\ndoesn\'t
-0000de10: 2070 726f 7669 6465 2073 7563 6820 6120   provide such a 
-0000de20: 7468 7265 6164 6564 206f 7220 7175 6575  threaded or queu
-0000de30: 696e 6720 6f62 6a65 6374 2063 6c61 7373  ing object class
-0000de40: 2e20 4a75 7374 206d 616b 6520 7375 7265  . Just make sure
-0000de50: 2074 6f20 7265 636f 6e73 7472 7563 745c   to reconstruct\
-0000de60: 6e74 6865 2073 7562 7363 7269 7074 696f  nthe subscriptio
-0000de70: 6e20 2861 6e64 2074 6865 2071 7565 7565  n (and the queue
-0000de80: 2920 7573 696e 6720 7468 6520 6c61 7374  ) using the last
-0000de90: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
-0000dea0: 2070 6f73 6974 696f 6e20 7768 656e 2072   position when r
-0000deb0: 6573 756d 696e 675c 6e74 6865 2073 7562  esuming\nthe sub
-0000dec0: 7363 7269 7074 696f 6e20 6166 7465 7220  scription after 
-0000ded0: 616e 2065 7272 6f72 2c20 746f 2062 6520  an error, to be 
-0000dee0: 7375 7265 2061 6c6c 2065 7665 6e74 7320  sure all events 
-0000def0: 6172 6520 7072 6f63 6573 7365 6420 6f6e  are processed on
-0000df00: 6365 2e5c 6e5c 6e54 6865 2065 7861 6d70  ce.\n\nThe examp
-0000df10: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-0000df20: 6f77 2074 6f20 7375 6273 6372 6962 6520  ow to subscribe 
-0000df30: 746f 2072 6563 6569 7665 2061 6c6c 2072  to receive all r
-0000df40: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
-0000df50: 6672 6f6d 2074 6865 2073 7461 7274 2c20  from the start, 
-0000df60: 616e 6420 7468 656e 2072 6573 756d 696e  and then resumin
-0000df70: 6720 6672 6f6d 2061 2073 7065 6369 6669  g from a specifi
-0000df80: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
-0000df90: 6e2e 5c6e 5468 7265 6520 616c 7265 6164  n.\nThree alread
-0000dfa0: 792d 7265 636f 7264 6564 2065 7665 6e74  y-recorded event
-0000dfb0: 7320 6172 6520 7265 6365 6976 6564 2c20  s are received, 
-0000dfc0: 616e 6420 7468 656e 2074 6872 6565 206e  and then three n
-0000dfd0: 6577 2065 7665 6e74 7320 6172 655c 6e72  ew events are\nr
-0000dfe0: 6563 6f72 6465 642c 2077 6869 6368 2061  ecorded, which a
-0000dff0: 7265 2074 6865 6e20 7265 6365 6976 6564  re then received
-0000e000: 2076 6961 2074 6865 2073 7562 7363 7269   via the subscri
-0000e010: 7074 696f 6e2e 5c6e 5c6e 6060 6070 7974  ption.\n\n```pyt
-0000e020: 686f 6e5c 6e5c 6e23 2041 7070 656e 6420  hon\n\n# Append 
-0000e030: 616e 2065 7665 6e74 2074 6f20 6120 6e65  an event to a ne
-0000e040: 7720 7374 7265 616d 2e5c 6e73 7472 6561  w stream.\nstrea
-0000e050: 6d5f 6e61 6d65 3220 3d20 7374 7228 7575  m_name2 = str(uu
-0000e060: 6964 3428 2929 5c6e 6576 656e 7434 203d  id4())\nevent4 =
-0000e070: 204e 6577 4576 656e 7428 7479 7065 3d5c   NewEvent(type=\
-0000e080: 274f 7264 6572 4372 6561 7465 645c 272c  'OrderCreated\',
-0000e090: 2064 6174 613d 625c 2764 6174 6134 5c27   data=b\'data4\'
-0000e0a0: 295c 6e63 6c69 656e 742e 6170 7065 6e64  )\nclient.append
-0000e0b0: 5f65 7665 6e74 7328 5c6e 2020 2020 7374  _events(\n    st
-0000e0c0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-0000e0d0: 5f6e 616d 6532 2c5c 6e20 2020 2065 7870  _name2,\n    exp
-0000e0e0: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
-0000e0f0: 6f6e 652c 5c6e 2020 2020 6576 656e 7473  one,\n    events
-0000e100: 3d5b 6576 656e 7434 5d2c 5c6e 295c 6e5c  =[event4],\n)\n\
-0000e110: 6e23 2053 7562 7363 7269 6265 2066 726f  n# Subscribe fro
-0000e120: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
-0000e130: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
-0000e140: 6520 6461 7461 6261 7365 2e5c 6e73 7562  e database.\nsub
-0000e150: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
-0000e160: 6e74 2e73 7562 7363 7269 6265 5f61 6c6c  nt.subscribe_all
-0000e170: 5f65 7665 6e74 7328 295c 6e72 6563 6569  _events()\nrecei
-0000e180: 7665 645f 6576 656e 7473 203d 205b 5d5c  ved_events = []\
-0000e190: 6e5c 6e23 2050 726f 6365 7373 2065 7665  n\n# Process eve
-0000e1a0: 6e74 7320 7265 6365 6976 6564 2066 726f  nts received fro
-0000e1b0: 6d20 7468 6520 6361 7463 682d 7570 2073  m the catch-up s
-0000e1c0: 7562 7363 7269 7074 696f 6e2e 5c6e 666f  ubscription.\nfo
-0000e1d0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-0000e1e0: 7269 7074 696f 6e3a 5c6e 2020 2020 6c61  ription:\n    la
-0000e1f0: 7374 5f63 6f6d 6d69 745f 706f 7369 7469  st_commit_positi
-0000e200: 6f6e 203d 2065 7665 6e74 2e63 6f6d 6d69  on = event.commi
-0000e210: 745f 706f 7369 7469 6f6e 5c6e 2020 2020  t_position\n    
-0000e220: 7265 6365 6976 6564 5f65 7665 6e74 732e  received_events.
-0000e230: 6170 7065 6e64 2865 7665 6e74 295c 6e20  append(event)\n 
-0000e240: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
-0000e250: 3d20 6576 656e 7434 2e69 643a 5c6e 2020  = event4.id:\n  
-0000e260: 2020 2020 2020 6272 6561 6b5c 6e5c 6e61        break\n\na
-0000e270: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000e280: 7665 6e74 735b 2d38 5d2e 6964 203d 3d20  vents[-8].id == 
-0000e290: 6576 656e 7431 2e69 645c 6e61 7373 6572  event1.id\nasser
-0000e2a0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000e2b0: 735b 2d37 5d2e 6964 203d 3d20 6576 656e  s[-7].id == even
-0000e2c0: 7432 2e69 645c 6e61 7373 6572 7420 7265  t2.id\nassert re
-0000e2d0: 6365 6976 6564 5f65 7665 6e74 735b 2d36  ceived_events[-6
-0000e2e0: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
-0000e2f0: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
-0000e300: 6564 5f65 7665 6e74 735b 2d35 5d2e 7479  ed_events[-5].ty
-0000e310: 7065 203d 3d20 2244 6f67 5265 6769 7374  pe == "DogRegist
-0000e320: 6572 6564 225c 6e61 7373 6572 7420 7265  ered"\nassert re
-0000e330: 6365 6976 6564 5f65 7665 6e74 735b 2d34  ceived_events[-4
-0000e340: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-0000e350: 6172 6e65 6454 7269 636b 225c 6e61 7373  arnedTrick"\nass
-0000e360: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000e370: 6e74 735b 2d33 5d2e 7479 7065 203d 3d20  nts[-3].type == 
-0000e380: 2244 6f67 4c65 6172 6e65 6454 7269 636b  "DogLearnedTrick
-0000e390: 225c 6e61 7373 6572 7420 7265 6365 6976  "\nassert receiv
-0000e3a0: 6564 5f65 7665 6e74 735b 2d32 5d2e 7479  ed_events[-2].ty
-0000e3b0: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
-0000e3c0: 6454 7269 636b 225c 6e61 7373 6572 7420  dTrick"\nassert 
-0000e3d0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000e3e0: 2d31 5d2e 6964 203d 3d20 6576 656e 7434  -1].id == event4
-0000e3f0: 2e69 645c 6e5c 6e23 2041 7070 656e 6420  .id\n\n# Append 
-0000e400: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
-0000e410: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
-0000e420: 5c6e 6576 656e 7435 203d 204e 6577 4576  \nevent5 = NewEv
-0000e430: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
-0000e440: 5570 6461 7465 645c 272c 2064 6174 613d  Updated\', data=
-0000e450: 625c 2764 6174 6135 5c27 295c 6e63 6c69  b\'data5\')\ncli
-0000e460: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
-0000e470: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-0000e480: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0000e490: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
-0000e4a0: 706f 7369 7469 6f6e 3d30 2c5c 6e20 2020  position=0,\n   
-0000e4b0: 2065 7665 6e74 733d 5b65 7665 6e74 355d   events=[event5]
-0000e4c0: 2c5c 6e29 5c6e 5c6e 2320 5265 6365 6976  ,\n)\n\n# Receiv
-0000e4d0: 6520 7375 6273 6571 7565 6e74 2065 7665  e subsequent eve
-0000e4e0: 6e74 7320 6672 6f6d 2074 6865 2073 7562  nts from the sub
-0000e4f0: 7363 7269 7074 696f 6e2e 5c6e 666f 7220  scription.\nfor 
-0000e500: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
-0000e510: 7074 696f 6e3a 5c6e 2020 2020 6c61 7374  ption:\n    last
-0000e520: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
-0000e530: 203d 2065 7665 6e74 2e63 6f6d 6d69 745f   = event.commit_
-0000e540: 706f 7369 7469 6f6e 5c6e 2020 2020 7265  position\n    re
-0000e550: 6365 6976 6564 5f65 7665 6e74 732e 6170  ceived_events.ap
-0000e560: 7065 6e64 2865 7665 6e74 295c 6e20 2020  pend(event)\n   
-0000e570: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
-0000e580: 6576 656e 7435 2e69 643a 5c6e 2020 2020  event5.id:\n    
-0000e590: 2020 2020 6272 6561 6b5c 6e5c 6e5c 6e5c      break\n\n\n\
-0000e5a0: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-0000e5b0: 5f65 7665 6e74 735b 2d32 5d2e 6964 203d  _events[-2].id =
-0000e5c0: 3d20 6576 656e 7434 2e69 645c 6e61 7373  = event4.id\nass
-0000e5d0: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000e5e0: 6e74 735b 2d31 5d2e 6964 203d 3d20 6576  nts[-1].id == ev
-0000e5f0: 656e 7435 2e69 645c 6e5c 6e5c 6e23 2041  ent5.id\n\n\n# A
-0000e600: 7070 656e 6420 6d6f 7265 2065 7665 6e74  ppend more event
-0000e610: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
-0000e620: 5c6e 6576 656e 7436 203d 204e 6577 4576  \nevent6 = NewEv
-0000e630: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
-0000e640: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
-0000e650: 625c 2764 6174 6136 5c27 295c 6e63 6c69  b\'data6\')\ncli
-0000e660: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
-0000e670: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-0000e680: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0000e690: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
-0000e6a0: 706f 7369 7469 6f6e 3d31 2c5c 6e20 2020  position=1,\n   
-0000e6b0: 2065 7665 6e74 733d 5b65 7665 6e74 365d   events=[event6]
-0000e6c0: 2c5c 6e29 5c6e 5c6e 5c6e 2320 5265 7375  ,\n)\n\n\n# Resu
-0000e6d0: 6d65 2073 7562 7363 7269 6269 6e67 2066  me subscribing f
-0000e6e0: 726f 6d20 7468 6520 6c61 7374 2063 6f6d  rom the last com
-0000e6f0: 6d69 7420 706f 7369 7469 6f6e 2e5c 6e73  mit position.\ns
-0000e700: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
-0000e710: 6965 6e74 2e73 7562 7363 7269 6265 5f61  ient.subscribe_a
-0000e720: 6c6c 5f65 7665 6e74 7328 5c6e 2020 2020  ll_events(\n    
-0000e730: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
-0000e740: 6c61 7374 5f63 6f6d 6d69 745f 706f 7369  last_commit_posi
-0000e750: 7469 6f6e 5c6e 295c 6e5c 6e5c 6e23 2043  tion\n)\n\n\n# C
-0000e760: 6174 6368 2075 7020 6279 2072 6563 6569  atch up by recei
-0000e770: 7669 6e67 2074 6865 206e 6577 2065 7665  ving the new eve
-0000e780: 6e74 2066 726f 6d20 7468 6520 7375 6273  nt from the subs
-0000e790: 6372 6970 7469 6f6e 2e5c 6e66 6f72 2065  cription.\nfor e
-0000e7a0: 7665 6e74 2069 6e20 7375 6273 6372 6970  vent in subscrip
-0000e7b0: 7469 6f6e 3a5c 6e20 2020 2072 6563 6569  tion:\n    recei
-0000e7c0: 7665 645f 6576 656e 7473 2e61 7070 656e  ved_events.appen
-0000e7d0: 6428 6576 656e 7429 5c6e 2020 2020 6966  d(event)\n    if
-0000e7e0: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
-0000e7f0: 6e74 362e 6964 3a5c 6e20 2020 2020 2020  nt6.id:\n       
-0000e800: 2062 7265 616b 5c6e 5c6e 6173 7365 7274   break\n\nassert
-0000e810: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000e820: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
-0000e830: 342e 6964 5c6e 6173 7365 7274 2072 6563  4.id\nassert rec
-0000e840: 6569 7665 645f 6576 656e 7473 5b2d 325d  eived_events[-2]
-0000e850: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
-0000e860: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
-0000e870: 645f 6576 656e 7473 5b2d 315d 2e69 6420  d_events[-1].id 
-0000e880: 3d3d 2065 7665 6e74 362e 6964 5c6e 5c6e  == event6.id\n\n
-0000e890: 5c6e 2320 4170 7065 6e64 2074 6872 6565  \n# Append three
-0000e8a0: 206d 6f72 6520 6576 656e 7473 2074 6f20   more events to 
-0000e8b0: 6120 6e65 7720 7374 7265 616d 2e5c 6e73  a new stream.\ns
-0000e8c0: 7472 6561 6d5f 6e61 6d65 3320 3d20 7374  tream_name3 = st
-0000e8d0: 7228 7575 6964 3428 2929 5c6e 6576 656e  r(uuid4())\neven
-0000e8e0: 7437 203d 204e 6577 4576 656e 7428 7479  t7 = NewEvent(ty
-0000e8f0: 7065 3d5c 274f 7264 6572 4372 6561 7465  pe=\'OrderCreate
-0000e900: 645c 272c 2064 6174 613d 625c 2764 6174  d\', data=b\'dat
-0000e910: 6137 5c27 295c 6e65 7665 6e74 3820 3d20  a7\')\nevent8 = 
-0000e920: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
-0000e930: 4f72 6465 7255 7064 6174 6564 5c27 2c20  OrderUpdated\', 
-0000e940: 6461 7461 3d62 5c27 6461 7461 385c 2729  data=b\'data8\')
-0000e950: 5c6e 6576 656e 7439 203d 204e 6577 4576  \nevent9 = NewEv
-0000e960: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
-0000e970: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
-0000e980: 625c 2764 6174 6139 5c27 295c 6e5c 6e63  b\'data9\')\n\nc
-0000e990: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-0000e9a0: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
-0000e9b0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000e9c0: 6533 2c5c 6e20 2020 2065 7870 6563 7465  e3,\n    expecte
-0000e9d0: 645f 706f 7369 7469 6f6e 3d4e 6f6e 652c  d_position=None,
-0000e9e0: 5c6e 2020 2020 6576 656e 7473 3d5b 6576  \n    events=[ev
-0000e9f0: 656e 7437 2c20 6576 656e 7438 2c20 6576  ent7, event8, ev
-0000ea00: 656e 7439 5d2c 5c6e 295c 6e5c 6e23 2052  ent9],\n)\n\n# R
-0000ea10: 6563 6569 7665 2074 6865 2074 6872 6565  eceive the three
-0000ea20: 206e 6577 2065 7665 6e74 7320 6672 6f6d   new events from
-0000ea30: 2074 6865 2072 6573 756d 6564 2073 7562   the resumed sub
-0000ea40: 7363 7269 7074 696f 6e2e 5c6e 666f 7220  scription.\nfor 
-0000ea50: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
-0000ea60: 7074 696f 6e3a 5c6e 2020 2020 7265 6365  ption:\n    rece
-0000ea70: 6976 6564 5f65 7665 6e74 732e 6170 7065  ived_events.appe
-0000ea80: 6e64 2865 7665 6e74 295c 6e20 2020 2069  nd(event)\n    i
-0000ea90: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
-0000eaa0: 656e 7439 2e69 643a 5c6e 2020 2020 2020  ent9.id:\n      
-0000eab0: 2020 6272 6561 6b5c 6e5c 6e61 7373 6572    break\n\nasser
-0000eac0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000ead0: 735b 2d36 5d2e 6964 203d 3d20 6576 656e  s[-6].id == even
-0000eae0: 7434 2e69 645c 6e61 7373 6572 7420 7265  t4.id\nassert re
-0000eaf0: 6365 6976 6564 5f65 7665 6e74 735b 2d35  ceived_events[-5
-0000eb00: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
-0000eb10: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
-0000eb20: 6564 5f65 7665 6e74 735b 2d34 5d2e 6964  ed_events[-4].id
-0000eb30: 203d 3d20 6576 656e 7436 2e69 645c 6e61   == event6.id\na
-0000eb40: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000eb50: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
-0000eb60: 6576 656e 7437 2e69 645c 6e61 7373 6572  event7.id\nasser
-0000eb70: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000eb80: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
-0000eb90: 7438 2e69 645c 6e61 7373 6572 7420 7265  t8.id\nassert re
-0000eba0: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
-0000ebb0: 5d2e 6964 203d 3d20 6576 656e 7439 2e69  ].id == event9.i
-0000ebc0: 645c 6e60 6060 5c6e 5c6e 5468 6520 6361  d\n```\n\nThe ca
-0000ebd0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-0000ebe0: 696f 6e20 6361 6c6c 2069 7320 656e 6465  ion call is ende
-0000ebf0: 6420 6173 2073 6f6f 6e20 6173 2074 6865  d as soon as the
-0000ec00: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
-0000ec10: 6a65 6374 5c6e 676f 6573 206f 7574 206f  ject\ngoes out o
-0000ec20: 6620 7363 6f70 6520 6f72 2069 7320 6578  f scope or is ex
-0000ec30: 706c 6963 6974 6c79 2064 656c 6574 6564  plicitly deleted
-0000ec40: 2066 726f 6d20 6d65 6d6f 7279 2e5c 6e5c   from memory.\n\
-0000ec50: 6e60 6060 7079 7468 6f6e 5c6e 2320 456e  n```python\n# En
-0000ec60: 6420 7468 6520 7375 6273 6372 6970 7469  d the subscripti
-0000ec70: 6f6e 2e5c 6e64 656c 2073 7562 7363 7269  on.\ndel subscri
-0000ec80: 7074 696f 6e5c 6e60 6060 5c6e 5c6e 2323  ption\n```\n\n##
-0000ec90: 2320 5375 6273 6372 6962 6520 7374 7265  # Subscribe stre
-0000eca0: 616d 2065 7665 6e74 735c 6e5c 6e54 6865  am events\n\nThe
-0000ecb0: 6073 7562 7363 7269 6265 5f73 7472 6561  `subscribe_strea
-0000ecc0: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
-0000ecd0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-0000ece0: 6f20 7374 6172 7420 6120 2263 6174 6368  o start a "catch
-0000ecf0: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
-0000ed00: 6e5c 6e74 6861 7420 6361 6e20 7265 7475  n\nthat can retu
-0000ed10: 726e 2065 7665 6e74 7320 7468 6174 2061  rn events that a
-0000ed20: 7265 2072 6563 6f72 6465 6420 696e 2061  re recorded in a
-0000ed30: 2073 696e 676c 6520 7374 7265 616d 2e5c   single stream.\
-0000ed40: 6e5c 6e54 6869 7320 6d65 7468 6f64 2074  n\nThis method t
-0000ed50: 616b 6573 2061 2072 6571 7569 7265 6420  akes a required 
-0000ed60: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
-0000ed70: 6775 6d65 6e74 2c20 7768 6963 6820 7370  gument, which sp
-0000ed80: 6563 6966 6965 7320 7468 6520 6e61 6d65  ecifies the name
-0000ed90: 206f 6620 7468 6520 7374 7265 616d 5c6e   of the stream\n
-0000eda0: 6672 6f6d 2077 6869 6368 2072 6563 6f72  from which recor
-0000edb0: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
-0000edc0: 6265 2072 6563 6569 7665 642e 5c6e 5c6e  be received.\n\n
-0000edd0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-0000ede0: 2074 616b 6573 2074 776f 206f 7074 696f   takes two optio
-0000edf0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
-0000ee00: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-0000ee10: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
-0000ee20: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-0000ee30: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
-0000ee40: 6e60 2061 7267 756d 656e 7420 7370 6563  n` argument spec
-0000ee50: 6966 6965 7320 6120 706f 7369 7469 6f6e  ifies a position
-0000ee60: 2069 6e20 7468 6520 7374 7265 616d 2066   in the stream f
-0000ee70: 726f 6d20 7768 6963 685c 6e72 6563 6f72  rom which\nrecor
-0000ee80: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
-0000ee90: 6265 2072 6563 6569 7665 642e 2054 6865  be received. The
-0000eea0: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
-0000eeb0: 6563 6966 6965 6420 7374 7265 616d 2070  ecified stream p
-0000eec0: 6f73 6974 696f 6e20 7769 6c6c 206e 6f74  osition will not
-0000eed0: 5c6e 6265 2069 6e63 6c75 6465 642e 5c6e  \nbe included.\n
-0000eee0: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
-0000eef0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-0000ef00: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
-0000ef10: 6c6f 6174 6020 7468 6174 2073 6574 735c  loat` that sets\
-0000ef20: 6e61 2064 6561 646c 696e 6520 666f 7220  na deadline for 
-0000ef30: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-0000ef40: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-0000ef50: 7469 6f6e 2e5c 6e5c 6e54 6865 2065 7861  tion.\n\nThe exa
-0000ef60: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-0000ef70: 2068 6f77 2074 6f20 7374 6172 7420 6120   how to start a 
-0000ef80: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-0000ef90: 7074 696f 6e20 746f 2061 2073 7472 6561  ption to a strea
-0000efa0: 6d2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  m.\n\n```python\
-0000efb0: 6e5c 6e23 2053 7562 7363 7269 6265 2074  n\n# Subscribe t
-0000efc0: 6f20 6576 656e 7473 2066 726f 6d20 7374  o events from st
-0000efd0: 7265 616d 322c 2066 726f 6d20 7468 6520  ream2, from the 
-0000efe0: 7374 6172 742e 5c6e 7375 6273 6372 6970  start.\nsubscrip
-0000eff0: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
-0000f000: 6273 6372 6962 655f 7374 7265 616d 5f65  bscribe_stream_e
-0000f010: 7665 6e74 7328 7374 7265 616d 5f6e 616d  vents(stream_nam
-0000f020: 653d 7374 7265 616d 5f6e 616d 6532 295c  e=stream_name2)\
-0000f030: 6e5c 6e23 2052 6561 6420 6672 6f6d 2074  n\n# Read from t
-0000f040: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-0000f050: 5c6e 6576 656e 7473 203d 205b 5d5c 6e66  \nevents = []\nf
-0000f060: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
-0000f070: 6372 6970 7469 6f6e 3a5c 6e20 2020 2065  cription:\n    e
-0000f080: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000f090: 6e74 295c 6e20 2020 2069 6620 6576 656e  nt)\n    if even
-0000f0a0: 742e 6964 203d 3d20 6576 656e 7436 2e69  t.id == event6.i
-0000f0b0: 643a 5c6e 2020 2020 2020 2020 6272 6561  d:\n        brea
-0000f0c0: 6b5c 6e5c 6e23 2043 6865 636b 2077 6520  k\n\n# Check we 
-0000f0d0: 676f 7420 6576 656e 7473 206f 6e6c 7920  got events only 
-0000f0e0: 6672 6f6d 2073 7472 6561 6d32 2e5c 6e61  from stream2.\na
-0000f0f0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-0000f100: 2920 3d3d 2033 5c6e 6576 656e 7473 5b30  ) == 3\nevents[0
-0000f110: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-0000f120: 2073 7472 6561 6d5f 6e61 6d65 325c 6e65   stream_name2\ne
-0000f130: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
-0000f140: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-0000f150: 616d 6532 5c6e 6576 656e 7473 5b32 5d2e  ame2\nevents[2].
-0000f160: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-0000f170: 7472 6561 6d5f 6e61 6d65 325c 6e5c 6e23  tream_name2\n\n#
-0000f180: 2041 7070 656e 6420 616e 6f74 6865 7220   Append another 
-0000f190: 6576 656e 7420 746f 2073 7472 6561 6d33  event to stream3
-0000f1a0: 2e5c 6e65 7665 6e74 3130 203d 204e 6577  .\nevent10 = New
-0000f1b0: 4576 656e 7428 7479 7065 3d22 4f72 6465  Event(type="Orde
-0000f1c0: 7255 6e64 656c 6574 6564 222c 2064 6174  rUndeleted", dat
-0000f1d0: 613d 625c 2764 6174 6131 305c 2729 5c6e  a=b\'data10\')\n
-0000f1e0: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-0000f1f0: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
-0000f200: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000f210: 6d65 332c 5c6e 2020 2020 6578 7065 6374  me3,\n    expect
-0000f220: 6564 5f70 6f73 6974 696f 6e3d 322c 5c6e  ed_position=2,\n
-0000f230: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-0000f240: 7431 305d 2c5c 6e29 5c6e 5c6e 2320 4170  t10],\n)\n\n# Ap
-0000f250: 7065 6e64 2061 6e6f 7468 6572 2065 7665  pend another eve
-0000f260: 6e74 2074 6f20 7374 7265 616d 322e 5c6e  nt to stream2.\n
-0000f270: 6576 656e 7431 3120 3d20 4e65 7745 7665  event11 = NewEve
-0000f280: 6e74 2874 7970 653d 224f 7264 6572 556e  nt(type="OrderUn
-0000f290: 6465 6c65 7465 6422 2c20 6461 7461 3d62  deleted", data=b
-0000f2a0: 5c27 6461 7461 3131 5c27 295c 6e63 6c69  \'data11\')\ncli
-0000f2b0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
-0000f2c0: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-0000f2d0: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0000f2e0: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
-0000f2f0: 706f 7369 7469 6f6e 3d32 2c5c 6e20 2020  position=2,\n   
-0000f300: 2065 7665 6e74 733d 5b65 7665 6e74 3131   events=[event11
-0000f310: 5d5c 6e29 5c6e 5c6e 2320 436f 6e74 696e  ]\n)\n\n# Contin
-0000f320: 7565 2072 6561 6469 6e67 2066 726f 6d20  ue reading from 
-0000f330: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f340: 2e5c 6e66 6f72 2065 7665 6e74 2069 6e20  .\nfor event in 
-0000f350: 7375 6273 6372 6970 7469 6f6e 3a5c 6e20  subscription:\n 
-0000f360: 2020 2065 7665 6e74 732e 6170 7065 6e64     events.append
-0000f370: 2865 7665 6e74 295c 6e20 2020 2069 6620  (event)\n    if 
-0000f380: 6576 656e 742e 6964 203d 3d20 6576 656e  event.id == even
-0000f390: 7431 312e 6964 3a5c 6e20 2020 2020 2020  t11.id:\n       
-0000f3a0: 2062 7265 616b 5c6e 5c6e 2320 4368 6563   break\n\n# Chec
-0000f3b0: 6b20 7765 2067 6f74 2065 7665 6e74 7320  k we got events 
-0000f3c0: 6f6e 6c79 2066 726f 6d20 7374 7265 616d  only from stream
-0000f3d0: 322e 5c6e 6173 7365 7274 206c 656e 2865  2.\nassert len(e
-0000f3e0: 7665 6e74 7329 203d 3d20 345c 6e65 7665  vents) == 4\neve
-0000f3f0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
-0000f400: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-0000f410: 6532 5c6e 6576 656e 7473 5b31 5d2e 7374  e2\nevents[1].st
-0000f420: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-0000f430: 6561 6d5f 6e61 6d65 325c 6e65 7665 6e74  eam_name2\nevent
-0000f440: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
-0000f450: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-0000f460: 5c6e 6576 656e 7473 5b33 5d2e 7374 7265  \nevents[3].stre
-0000f470: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-0000f480: 6d5f 6e61 6d65 325c 6e60 6060 5c6e 5c6e  m_name2\n```\n\n
-0000f490: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-0000f4a0: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
-0000f4b0: 7461 7274 2061 2063 6174 6368 2d75 7020  tart a catch-up 
-0000f4c0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-0000f4d0: 6120 7374 7265 616d 2066 726f 6d20 615c  a stream from a\
-0000f4e0: 6e73 7065 6369 6669 6320 7374 7265 616d  nspecific stream
-0000f4f0: 2070 6f73 6974 696f 6e2e 5c6e 5c6e 6060   position.\n\n``
-0000f500: 6070 7974 686f 6e5c 6e5c 6e23 2053 7562  `python\n\n# Sub
-0000f510: 7363 7269 6265 2074 6f20 6576 656e 7473  scribe to events
-0000f520: 2066 726f 6d20 7374 7265 616d 322c 2066   from stream2, f
-0000f530: 726f 6d20 7468 6520 7374 6172 742e 5c6e  rom the start.\n
-0000f540: 7375 6273 6372 6970 7469 6f6e 203d 2063  subscription = c
-0000f550: 6c69 656e 742e 7375 6273 6372 6962 655f  lient.subscribe_
-0000f560: 7374 7265 616d 5f65 7665 6e74 7328 5c6e  stream_events(\n
-0000f570: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000f580: 7374 7265 616d 5f6e 616d 6532 2c5c 6e20  stream_name2,\n 
-0000f590: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
-0000f5a0: 6f6e 3d31 2c5c 6e29 5c6e 5c6e 2320 5265  on=1,\n)\n\n# Re
-0000f5b0: 6164 2065 7665 6e74 2066 726f 6d20 7468  ad event from th
-0000f5c0: 6520 7375 6273 6372 6970 7469 6f6e 2e5c  e subscription.\
-0000f5d0: 6e65 7665 6e74 7320 3d20 5b5d 5c6e 666f  nevents = []\nfo
-0000f5e0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-0000f5f0: 7269 7074 696f 6e3a 5c6e 2020 2020 6576  ription:\n    ev
-0000f600: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
-0000f610: 7429 5c6e 2020 2020 6966 2065 7665 6e74  t)\n    if event
-0000f620: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
-0000f630: 643a 5c6e 2020 2020 2020 2020 6272 6561  d:\n        brea
-0000f640: 6b5c 6e5c 6e23 2043 6865 636b 2077 6520  k\n\n# Check we 
-0000f650: 676f 7420 6576 656e 7473 206f 6e6c 7920  got events only 
-0000f660: 6166 7465 7220 706f 7369 7469 6f6e 2031  after position 1
-0000f670: 2e5c 6e61 7373 6572 7420 6c65 6e28 6576  .\nassert len(ev
-0000f680: 656e 7473 2920 3d3d 2032 5c6e 6576 656e  ents) == 2\neven
-0000f690: 7473 5b30 5d2e 6964 203d 3d20 6576 656e  ts[0].id == even
-0000f6a0: 7436 2e69 645c 6e65 7665 6e74 735b 305d  t6.id\nevents[0]
-0000f6b0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-0000f6c0: 203d 3d20 325c 6e65 7665 6e74 735b 305d   == 2\nevents[0]
-0000f6d0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-0000f6e0: 7374 7265 616d 5f6e 616d 6532 5c6e 6576  stream_name2\nev
-0000f6f0: 656e 7473 5b31 5d2e 6964 203d 3d20 6576  ents[1].id == ev
-0000f700: 656e 7431 312e 6964 5c6e 6576 656e 7473  ent11.id\nevents
-0000f710: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
-0000f720: 696f 6e20 3d3d 2033 5c6e 6576 656e 7473  ion == 3\nevents
-0000f730: 5b31 5d2e 7374 7265 616d 5f6e 616d 6520  [1].stream_name 
-0000f740: 3d3d 2073 7472 6561 6d5f 6e61 6d65 325c  == stream_name2\
-0000f750: 6e60 6060 5c6e 5c6e 2323 2050 6572 7369  n```\n\n## Persi
-0000f760: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-0000f770: 6f6e 735c 6e5c 6e23 2323 2043 7265 6174  ons\n\n### Creat
-0000f780: 6520 7375 6273 6372 6970 7469 6f6e 5c6e  e subscription\n
-0000f790: 5c6e 2a72 6571 7569 7265 7320 6c65 6164  \n*requires lead
-0000f7a0: 6572 2a5c 6e5c 6e54 6865 206d 6574 686f  er*\n\nThe metho
-0000f7b0: 6420 6063 7265 6174 655f 7375 6273 6372  d `create_subscr
-0000f7c0: 6970 7469 6f6e 2829 6020 6361 6e20 6265  iption()` can be
-0000f7d0: 2075 7365 6420 746f 2063 7265 6174 6520   used to create 
-0000f7e0: 615c 6e22 7065 7273 6973 7465 6e74 2073  a\n"persistent s
-0000f7f0: 7562 7363 7269 7074 696f 6e22 2074 6f20  ubscription" to 
-0000f800: 4576 656e 7453 746f 7265 4442 2e5c 6e5c  EventStoreDB.\n\
-0000f810: 6e54 6869 7320 6d65 7468 6f64 2074 616b  nThis method tak
-0000f820: 6573 2061 2072 6571 7569 7265 6420 6067  es a required `g
-0000f830: 726f 7570 5f6e 616d 6560 2061 7267 756d  roup_name` argum
-0000f840: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
-0000f850: 655c 6e6e 616d 6520 6f66 2061 2022 6772  e\nname of a "gr
-0000f860: 6f75 7022 206f 6620 636f 6e73 756d 6572  oup" of consumer
-0000f870: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
-0000f880: 7074 696f 6e2e 5c6e 5c6e 5468 6973 206d  ption.\n\nThis m
-0000f890: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
-0000f8a0: 2073 6576 656e 206f 7074 696f 6e61 6c20   seven optional 
-0000f8b0: 6172 6775 6d65 6e74 732c 2060 6672 6f6d  arguments, `from
-0000f8c0: 5f65 6e64 602c 2060 636f 6d6d 6974 5f70  _end`, `commit_p
-0000f8d0: 6f73 6974 696f 6e60 2c5c 6e60 6669 6c74  osition`,\n`filt
-0000f8e0: 6572 5f65 7863 6c75 6465 602c 2060 6669  er_exclude`, `fi
-0000f8f0: 6c74 6572 5f69 6e63 6c75 6465 602c 2060  lter_include`, `
-0000f900: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
-0000f910: 5f6e 616d 6560 2c20 6063 6f6e 7375 6d65  _name`, `consume
-0000f920: 725f 7374 7261 7465 6779 602c 5c6e 616e  r_strategy`,\nan
-0000f930: 6420 6074 696d 656f 7574 602e 5c6e 5c6e  d `timeout`.\n\n
-0000f940: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
-0000f950: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
-0000f960: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0000f970: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
-0000f980: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-0000f990: 6572 735c 6e6f 6620 7468 6520 7375 6273  ers\nof the subs
-0000f9a0: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
-0000f9b0: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
-0000f9c0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
-0000f9d0: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
-0000f9e0: 2073 7562 7363 7269 7074 696f 6e5c 6e77   subscription\nw
-0000f9f0: 6173 2063 7265 6174 6564 2e5c 6e5c 6e41  as created.\n\nA
-0000fa00: 6c74 6572 6e61 7469 7665 6c79 2c20 7468  lternatively, th
-0000fa10: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
-0000fa20: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
-0000fa30: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
-0000fa40: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
-0000fa50: 6f6d 6d69 745c 6e70 6f73 6974 696f 6e20  ommit\nposition 
-0000fa60: 6672 6f6d 2077 6869 6368 2063 6f6d 6d69  from which commi
-0000fa70: 7420 706f 7369 7469 6f6e 2074 6865 2067  t position the g
-0000fa80: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-0000fa90: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
-0000faa0: 7074 696f 6e20 7368 6f75 6c64 5c6e 7265  ption should\nre
-0000fab0: 6365 6976 6520 6576 656e 7473 2e20 506c  ceive events. Pl
-0000fac0: 6561 7365 206e 6f74 652c 2074 6865 2072  ease note, the r
-0000fad0: 6563 6f72 6465 6420 6576 656e 7420 6174  ecorded event at
-0000fae0: 2074 6865 2073 7065 6369 6669 6564 2063   the specified c
-0000faf0: 6f6d 6d69 7420 706f 7369 7469 6f6e 206d  ommit position m
-0000fb00: 6967 6874 5c6e 6265 2069 6e63 6c75 6465  ight\nbe include
-0000fb10: 6420 696e 2074 6865 2072 6563 6f72 6465  d in the recorde
-0000fb20: 6420 6576 656e 7473 2072 6563 6569 7665  d events receive
-0000fb30: 6420 6279 2074 6865 2067 726f 7570 206f  d by the group o
-0000fb40: 6620 636f 6e73 756d 6572 732e 5c6e 5c6e  f consumers.\n\n
-0000fb50: 4966 206e 6569 7468 6572 2060 6672 6f6d  If neither `from
-0000fb60: 5f65 6e64 6020 6f72 2060 636f 6d6d 6974  _end` or `commit
-0000fb70: 5f70 6f73 6974 696f 6e60 2061 7265 2073  _position` are s
-0000fb80: 7065 6369 6669 6564 2c20 7468 6520 6772  pecified, the gr
-0000fb90: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-0000fba0: 5c6e 6f66 2074 6865 2073 7562 7363 7269  \nof the subscri
-0000fbb0: 7074 696f 6e20 7769 6c6c 2070 6f74 656e  ption will poten
-0000fbc0: 7469 616c 6c79 2072 6563 6569 7665 2061  tially receive a
-0000fbd0: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
-0000fbe0: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
-0000fbf0: 7365 2e5c 6e5c 6e54 6865 206f 7074 696f  se.\n\nThe optio
-0000fc00: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
-0000fc10: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
-0000fc20: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-0000fc30: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0000fc40: 6e73 2074 6861 745c 6e6d 6174 6368 2072  ns that\nmatch r
-0000fc50: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-0000fc60: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
-0000fc70: 6520 696e 636c 7564 6564 2e20 5468 6973  e included. This
-0000fc80: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
-0000fc90: 6f72 6564 5c6e 6966 2060 6669 6c74 6572  ored\nif `filter
-0000fca0: 5f69 6e63 6c75 6465 6020 6973 2073 6574  _include` is set
-0000fcb0: 2074 6f20 6120 6e6f 6e2d 656d 7074 7920   to a non-empty 
-0000fcc0: 7365 7175 656e 6365 2e20 4279 2064 6566  sequence. By def
-0000fcd0: 6175 6c74 2c20 7468 6973 2061 7267 756d  ault, this argum
-0000fce0: 656e 7420 6973 2073 6574 5c6e 746f 206d  ent is set\nto m
-0000fcf0: 6174 6368 2074 6865 2065 7665 6e74 2074  atch the event t
-0000fd00: 7970 6573 206f 6620 2273 7973 7465 6d20  ypes of "system 
-0000fd10: 6576 656e 7473 222c 2073 6f20 7468 6174  events", so that
-0000fd20: 2045 7665 6e74 5374 6f72 6544 4220 7379   EventStoreDB sy
-0000fd30: 7374 656d 2065 7665 6e74 735c 6e77 696c  stem events\nwil
-0000fd40: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
-0000fd50: 6520 7265 6365 6976 6564 2e20 5365 6520  e received. See 
-0000fd60: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
-0000fd70: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
-0000fd80: 2069 6e66 6f72 6d61 7469 6f6e 5c6e 6162   information\nab
-0000fd90: 6f75 7420 6669 6c74 6572 2065 7870 7265  out filter expre
-0000fda0: 7373 696f 6e73 2e5c 6e5c 6e54 6865 206f  ssions.\n\nThe o
-0000fdb0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
-0000fdc0: 696e 636c 7564 6560 2061 7267 756d 656e  include` argumen
-0000fdd0: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
-0000fde0: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
-0000fdf0: 7373 696f 6e73 5c6e 7468 6174 206d 6174  ssions\nthat mat
-0000fe00: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
-0000fe10: 7473 2074 6861 7420 7368 6f75 6c64 2062  ts that should b
-0000fe20: 6520 7265 6365 6976 6564 2e20 4279 2064  e received. By d
-0000fe30: 6566 6175 6c74 2c20 7468 6973 2061 7267  efault, this arg
-0000fe40: 756d 656e 745c 6e69 7320 616e 2065 6d70  ument\nis an emp
-0000fe50: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
-0000fe60: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000fe70: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
-0000fe80: 2073 6571 7565 6e63 652c 2074 6865 5c6e   sequence, the\n
-0000fe90: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
-0000fea0: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
-0000feb0: 6f72 6564 2e5c 6e5c 6e54 6865 206f 7074  ored.\n\nThe opt
-0000fec0: 696f 6e61 6c20 6066 696c 7465 725f 6279  ional `filter_by
-0000fed0: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
-0000fee0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-0000fef0: 6f6e 2060 626f 6f6c 6020 7468 6174 2069  on `bool` that i
-0000ff00: 6e64 6963 6174 6573 2077 6865 7468 6572  ndicates whether
-0000ff10: 5c6e 7468 6520 6669 6c74 6572 2077 696c  \nthe filter wil
-0000ff20: 6c20 6170 706c 7920 746f 2065 7665 6e74  l apply to event
-0000ff30: 2074 7970 6573 206f 7220 7374 7265 616d   types or stream
-0000ff40: 206e 616d 6573 2e20 4279 2064 6566 6175   names. By defau
-0000ff50: 6c74 2c20 7468 6973 2076 616c 7565 2069  lt, this value i
-0000ff60: 7320 6046 616c 7365 605c 6e61 6e64 2073  s `False`\nand s
-0000ff70: 6f20 7468 6520 6669 6c74 6572 696e 6720  o the filtering 
-0000ff80: 7769 6c6c 2061 7070 6c79 2074 6f20 7468  will apply to th
-0000ff90: 6520 6576 656e 7420 7479 7065 2073 7472  e event type str
-0000ffa0: 696e 6773 206f 6620 7265 636f 7264 6564  ings of recorded
-0000ffb0: 2065 7665 6e74 732e 5c6e 5c6e 5468 6520   events.\n\nThe 
-0000ffc0: 6f70 7469 6f6e 616c 2060 636f 6e73 756d  optional `consum
-0000ffd0: 6572 5f73 7472 6174 6567 7960 2061 7267  er_strategy` arg
-0000ffe0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-0000fff0: 6e20 6073 7472 6020 7468 6174 2064 6566  n `str` that def
-00010000: 696e 6573 5c6e 7468 6520 636f 6e73 756d  ines\nthe consum
-00010010: 6572 2073 7472 6174 6567 7920 666f 7220  er strategy for 
-00010020: 7468 6973 2070 6572 7369 7374 656e 7420  this persistent 
-00010030: 7375 6273 6372 6970 7469 6f6e 2e20 5468  subscription. Th
-00010040: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
-00010050: 6172 6775 6d65 6e74 5c6e 6361 6e20 6265  argument\ncan be
-00010060: 2060 5c27 4469 7370 6174 6368 546f 5369   `\'DispatchToSi
-00010070: 6e67 6c65 5c27 602c 2060 5c27 526f 756e  ngle\'`, `\'Roun
-00010080: 6452 6f62 696e 5c27 602c 2060 5c27 5069  dRobin\'`, `\'Pi
-00010090: 6e6e 6564 5c27 602c 206f 7220 605c 2750  nned\'`, or `\'P
-000100a0: 696e 6e65 6442 7943 6f72 7265 6c61 7469  innedByCorrelati
-000100b0: 6f6e 5c27 602e 2054 6865 5c6e 6465 6661  on\'`. The\ndefa
-000100c0: 756c 7420 7661 6c75 6520 6973 2060 5c27  ult value is `\'
-000100d0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
-000100e0: 5c27 602e 5c6e 5c6e 5468 6520 6f70 7469  \'`.\n\nThe opti
-000100f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00010100: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00010110: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
-00010120: 6820 7365 7473 2061 5c6e 6465 6164 6c69  h sets a\ndeadli
-00010130: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-00010140: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-00010150: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
-00010160: 5468 6520 6d65 7468 6f64 2060 6372 6561  The method `crea
-00010170: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
-00010180: 2960 2064 6f65 7320 6e6f 7420 7265 7475  )` does not retu
-00010190: 726e 2061 2076 616c 7565 2c20 6265 6361  rn a value, beca
-000101a0: 7573 655c 6e72 6563 6f72 6465 6420 6576  use\nrecorded ev
-000101b0: 656e 7473 2061 7265 206f 6274 6169 6e65  ents are obtaine
-000101c0: 6420 6279 2074 6865 2067 726f 7570 206f  d by the group o
-000101d0: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
-000101e0: 6865 2073 7562 7363 7269 7074 696f 6e5c  he subscription\
-000101f0: 6e75 7369 6e67 2074 6865 2060 7265 6164  nusing the `read
-00010200: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00010210: 206d 6574 686f 642e 5c6e 5c6e 496e 2074   method.\n\nIn t
-00010220: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00010230: 2c20 6120 7065 7273 6973 7465 6e74 2073  , a persistent s
-00010240: 7562 7363 7269 7074 696f 6e20 6973 2063  ubscription is c
-00010250: 7265 6174 6564 2e5c 6e5c 6e60 6060 7079  reated.\n\n```py
-00010260: 7468 6f6e 5c6e 2320 4372 6561 7465 2061  thon\n# Create a
-00010270: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00010280: 6372 6970 7469 6f6e 2e5c 6e67 726f 7570  cription.\ngroup
-00010290: 5f6e 616d 6520 3d20 6622 6772 6f75 702d  _name = f"group-
-000102a0: 7b75 7569 6434 2829 7d22 5c6e 636c 6965  {uuid4()}"\nclie
-000102b0: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
-000102c0: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
-000102d0: 653d 6772 6f75 705f 6e61 6d65 295c 6e60  e=group_name)\n`
-000102e0: 6060 5c6e 5c6e 2323 2320 5265 6164 2073  ``\n\n### Read s
-000102f0: 7562 7363 7269 7074 696f 6e5c 6e5c 6e2a  ubscription\n\n*
-00010300: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
-00010310: 5c6e 5c6e 5468 6520 6d65 7468 6f64 2060  \n\nThe method `
-00010320: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-00010330: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
-00010340: 2062 7920 6120 6772 6f75 7020 6f66 2063   by a group of c
-00010350: 6f6e 7375 6d65 7273 2074 6f20 7265 6365  onsumers to rece
-00010360: 6976 655c 6e72 6563 6f72 6465 6420 6576  ive\nrecorded ev
-00010370: 656e 7473 2066 726f 6d20 6120 7065 7273  ents from a pers
-00010380: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00010390: 696f 6e20 6372 6561 7465 6420 7573 696e  ion created usin
-000103a0: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
-000103b0: 6970 7469 6f6e 602e 5c6e 5c6e 5468 6973  iption`.\n\nThis
-000103c0: 206d 6574 686f 6420 7461 6b65 7320 6120   method takes a 
-000103d0: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
-000103e0: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
-000103f0: 7768 6963 6820 6973 5c6e 7468 6520 6e61  which is\nthe na
-00010400: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
-00010410: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-00010420: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00010430: 2073 7065 6369 6669 6564 5c6e 7768 656e   specified\nwhen
-00010440: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-00010450: 7074 696f 6e28 2960 2077 6173 2063 616c  ption()` was cal
-00010460: 6c65 642e 5c6e 5c6e 5468 6973 206d 6574  led.\n\nThis met
-00010470: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-00010480: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00010490: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-000104a0: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
-000104b0: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-000104c0: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-000104d0: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
-000104e0: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-000104f0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00010500: 7065 7261 7469 6f6e 2e5c 6e5c 6e54 6869  peration.\n\nThi
-00010510: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
-00010520: 2061 2060 5065 7273 6973 7465 6e74 5375   a `PersistentSu
-00010530: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
-00010540: 6374 2c20 7768 6963 6820 6973 2061 6e20  ct, which is an 
-00010550: 6974 6572 6174 6f72 5c6e 6769 7669 6e67  iterator\ngiving
-00010560: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00010570: 206f 626a 6563 7473 2c20 7468 6174 2061   objects, that a
-00010580: 6c73 6f20 6861 7320 6061 636b 2829 602c  lso has `ack()`,
-00010590: 2060 6e61 636b 2829 6020 616e 6420 6073   `nack()` and `s
-000105a0: 746f 7028 2960 5c6e 6d65 7468 6f64 732e  top()`\nmethods.
-000105b0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e73  \n\n```python\ns
-000105c0: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
-000105d0: 6965 6e74 2e72 6561 645f 7375 6273 6372  ient.read_subscr
-000105e0: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
-000105f0: 653d 6772 6f75 705f 6e61 6d65 295c 6e60  e=group_name)\n`
-00010600: 6060 5c6e 5c6e 5468 6520 6061 636b 2829  ``\n\nThe `ack()
-00010610: 6020 6d65 7468 6f64 2073 686f 756c 6420  ` method should 
-00010620: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
-00010630: 7375 6d65 7220 746f 2069 6e64 6963 6174  sumer to indicat
-00010640: 6520 746f 2074 6865 2073 6572 7665 7220  e to the server 
-00010650: 7468 6174 2069 745c 6e68 6173 2072 6563  that it\nhas rec
-00010660: 6569 7665 6420 616e 6420 7375 6363 6573  eived and succes
-00010670: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-00010680: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
-00010690: 742e 2054 6869 7320 7769 6c6c 2070 7265  t. This will pre
-000106a0: 7665 6e74 2074 6861 745c 6e72 6563 6f72  vent that\nrecor
-000106b0: 6465 6420 6576 656e 7420 6265 696e 6720  ded event being 
-000106c0: 7265 6365 6976 6564 2062 7920 616e 6f74  received by anot
-000106d0: 6865 7220 636f 6e73 756d 6572 2069 6e20  her consumer in 
-000106e0: 7468 6520 7361 6d65 2067 726f 7570 2e20  the same group. 
-000106f0: 5468 6520 6061 636b 2829 605c 6e6d 6574  The `ack()`\nmet
-00010700: 686f 6420 7461 6b65 7320 616e 2060 6576  hod takes an `ev
-00010710: 656e 745f 6964 6020 6172 6775 6d65 6e74  ent_id` argument
-00010720: 2c20 7768 6963 6820 6973 2074 6865 2049  , which is the I
-00010730: 4420 6f66 2074 6865 2072 6563 6f72 6465  D of the recorde
-00010740: 6420 6576 656e 7420 7468 6174 5c6e 6861  d event that\nha
-00010750: 7320 6265 656e 2072 6563 6569 7665 642e  s been received.
-00010760: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-00010770: 6265 6c6f 7720 6974 6572 6174 6573 206f  below iterates o
-00010780: 7665 7220 7468 6520 7375 6273 6372 6970  ver the subscrip
-00010790: 7469 6f6e 206f 626a 6563 742c 2061 6e64  tion object, and
-000107a0: 2063 616c 6c73 2060 6163 6b28 2960 2e20   calls `ack()`. 
-000107b0: 5468 655c 6e60 7374 6f70 2829 6020 6d65  The\n`stop()` me
-000107c0: 7468 6f64 2069 7320 6361 6c6c 6564 2077  thod is called w
-000107d0: 6865 6e20 7765 2068 6176 6520 7265 6365  hen we have rece
-000107e0: 6976 6564 2074 6865 206c 6173 7420 6576  ived the last ev
-000107f0: 656e 742c 2073 6f20 7468 6174 2077 6520  ent, so that we 
-00010800: 6361 6e5c 6e63 6f6e 7469 6e75 6520 7769  can\ncontinue wi
-00010810: 7468 2074 6865 2065 7861 6d70 6c65 7320  th the examples 
-00010820: 6265 6c6f 772e 5c6e 5c6e 6060 6070 7974  below.\n\n```pyt
-00010830: 686f 6e5c 6e65 7665 6e74 7320 3d20 5b5d  hon\nevents = []
-00010840: 5c6e 666f 7220 6576 656e 7420 696e 2073  \nfor event in s
-00010850: 7562 7363 7269 7074 696f 6e3a 5c6e 2020  ubscription:\n  
-00010860: 2020 6576 656e 7473 2e61 7070 656e 6428    events.append(
-00010870: 6576 656e 7429 5c6e 5c6e 2020 2020 2320  event)\n\n    # 
-00010880: 4163 6b6e 6f77 6c65 6467 6520 7468 6520  Acknowledge the 
-00010890: 7265 6365 6976 6564 2065 7665 6e74 2e5c  received event.\
-000108a0: 6e20 2020 2073 7562 7363 7269 7074 696f  n    subscriptio
-000108b0: 6e2e 6163 6b28 6576 656e 745f 6964 3d65  n.ack(event_id=e
-000108c0: 7665 6e74 2e69 6429 5c6e 5c6e 2020 2020  vent.id)\n\n    
-000108d0: 2320 4272 6561 6b20 7768 656e 2074 6865  # Break when the
-000108e0: 206c 6173 7420 6576 656e 7420 6861 7320   last event has 
-000108f0: 6265 656e 2072 6563 6569 7665 642e 5c6e  been received.\n
-00010900: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-00010910: 3d3d 2065 7665 6e74 3131 2e69 643a 5c6e  == event11.id:\n
-00010920: 2020 2020 2020 2020 7375 6273 6372 6970          subscrip
-00010930: 7469 6f6e 2e73 746f 7028 295c 6e60 6060  tion.stop()\n```
-00010940: 5c6e 5c6e 5468 6520 7265 6365 6976 6564  \n\nThe received
-00010950: 2065 7665 6e74 7320 6172 6520 7468 6520   events are the 
-00010960: 6576 656e 7473 2077 6520 6170 7065 6e64  events we append
-00010970: 6564 2061 626f 7665 2e5c 6e5c 6e60 6060  ed above.\n\n```
-00010980: 7079 7468 6f6e 5c6e 6173 7365 7274 2065  python\nassert e
-00010990: 7665 6e74 735b 2d31 355d 2e69 6420 3d3d  vents[-15].id ==
-000109a0: 2065 7665 6e74 312e 6964 5c6e 6173 7365   event1.id\nasse
-000109b0: 7274 2065 7665 6e74 735b 2d31 345d 2e69  rt events[-14].i
-000109c0: 6420 3d3d 2065 7665 6e74 322e 6964 5c6e  d == event2.id\n
-000109d0: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
-000109e0: 335d 2e69 6420 3d3d 2065 7665 6e74 332e  3].id == event3.
-000109f0: 6964 5c6e 6173 7365 7274 2065 7665 6e74  id\nassert event
-00010a00: 735b 2d31 325d 2e74 7970 6520 3d3d 2022  s[-12].type == "
-00010a10: 446f 6752 6567 6973 7465 7265 6422 5c6e  DogRegistered"\n
-00010a20: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
-00010a30: 315d 2e74 7970 6520 3d3d 2022 446f 674c  1].type == "DogL
-00010a40: 6561 726e 6564 5472 6963 6b22 5c6e 6173  earnedTrick"\nas
-00010a50: 7365 7274 2065 7665 6e74 735b 2d31 305d  sert events[-10]
-00010a60: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
-00010a70: 726e 6564 5472 6963 6b22 5c6e 6173 7365  rnedTrick"\nasse
-00010a80: 7274 2065 7665 6e74 735b 2d39 5d2e 7479  rt events[-9].ty
-00010a90: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
-00010aa0: 6454 7269 636b 225c 6e61 7373 6572 7420  dTrick"\nassert 
-00010ab0: 6576 656e 7473 5b2d 385d 2e69 6420 3d3d  events[-8].id ==
-00010ac0: 2065 7665 6e74 342e 6964 5c6e 6173 7365   event4.id\nasse
-00010ad0: 7274 2065 7665 6e74 735b 2d37 5d2e 6964  rt events[-7].id
-00010ae0: 203d 3d20 6576 656e 7435 2e69 645c 6e61   == event5.id\na
-00010af0: 7373 6572 7420 6576 656e 7473 5b2d 365d  ssert events[-6]
-00010b00: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-00010b10: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00010b20: 2d35 5d2e 6964 203d 3d20 6576 656e 7437  -5].id == event7
-00010b30: 2e69 645c 6e61 7373 6572 7420 6576 656e  .id\nassert even
-00010b40: 7473 5b2d 345d 2e69 6420 3d3d 2065 7665  ts[-4].id == eve
-00010b50: 6e74 382e 6964 5c6e 6173 7365 7274 2065  nt8.id\nassert e
-00010b60: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
-00010b70: 6576 656e 7439 2e69 645c 6e61 7373 6572  event9.id\nasser
-00010b80: 7420 6576 656e 7473 5b2d 325d 2e69 6420  t events[-2].id 
-00010b90: 3d3d 2065 7665 6e74 3130 2e69 645c 6e61  == event10.id\na
-00010ba0: 7373 6572 7420 6576 656e 7473 5b2d 315d  ssert events[-1]
-00010bb0: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
-00010bc0: 645c 6e60 6060 5c6e 5c6e 5468 6520 2273  d\n```\n\nThe "s
-00010bd0: 7562 7363 7269 7074 696f 6e22 206f 626a  ubscription" obj
-00010be0: 6563 7420 616c 736f 2068 6173 2061 6e20  ect also has an 
-00010bf0: 606e 6163 6b28 2960 206d 6574 686f 6420  `nack()` method 
-00010c00: 7468 6174 2073 686f 756c 6420 6265 2075  that should be u
-00010c10: 7365 6420 6279 2061 2063 6f6e 7375 6d65  sed by a consume
-00010c20: 725c 6e74 6f20 6e65 6761 7469 7665 6c79  r\nto negatively
-00010c30: 2061 636b 6e6f 776c 6564 6765 2074 6f20   acknowledge to 
-00010c40: 7468 6520 7365 7276 6572 2074 6861 7420  the server that 
-00010c50: 6974 2068 6173 2072 6563 6569 7665 6420  it has received 
-00010c60: 6275 7420 6e6f 7420 7375 6363 6573 7366  but not successf
-00010c70: 756c 6c79 5c6e 7072 6f63 6573 7365 6420  ully\nprocessed 
-00010c80: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
-00010c90: 2e20 5468 6520 606e 6163 6b28 2960 206d  . The `nack()` m
-00010ca0: 6574 686f 6420 7461 6b65 7320 616e 2060  ethod takes an `
-00010cb0: 6576 656e 745f 6964 6020 6172 6775 6d65  event_id` argume
-00010cc0: 6e74 2c20 7768 6963 6820 6973 5c6e 7468  nt, which is\nth
-00010cd0: 6520 4944 206f 6620 7468 6520 7265 636f  e ID of the reco
-00010ce0: 7264 6564 2065 7665 6e74 2074 6861 7420  rded event that 
-00010cf0: 6861 7320 6265 656e 2072 6563 6569 7665  has been receive
-00010d00: 642c 2061 6e64 2061 6e20 6061 6374 696f  d, and an `actio
-00010d10: 6e60 2061 7267 756d 656e 742c 2077 6869  n` argument, whi
-00010d20: 6368 5c6e 7368 6f75 6c64 2062 6520 6120  ch\nshould be a 
-00010d30: 5079 7468 6f6e 2060 7374 7260 2c20 6569  Python `str`, ei
-00010d40: 7468 6572 2060 5c27 756e 6b6e 6f77 6e5c  ther `\'unknown\
-00010d50: 2760 2c20 605c 2770 6172 6b5c 2760 2c20  '`, `\'park\'`, 
-00010d60: 605c 2772 6574 7279 5c27 602c 2060 5c27  `\'retry\'`, `\'
-00010d70: 736b 6970 5c27 602c 206f 7220 605c 2773  skip\'`, or `\'s
-00010d80: 746f 705c 2760 2e5c 6e5c 6e57 6869 6c73  top\'`.\n\nWhils
-00010d90: 7420 7468 6572 6520 6172 6520 736f 6d65  t there are some
-00010da0: 2061 6476 616e 7461 6765 7320 6f66 2070   advantages of p
-00010db0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00010dc0: 6970 7469 6f6e 732c 2069 6e20 7061 7274  iptions, in part
-00010dd0: 6963 756c 6172 2074 6865 5c6e 7072 6f63  icular the\nproc
-00010de0: 6573 7369 6e67 206f 6620 7265 636f 7264  essing of record
-00010df0: 6564 2065 7665 6e74 7320 6279 2061 2067  ed events by a g
-00010e00: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-00010e10: 732c 2062 7920 7472 6163 6b69 6e67 2069  s, by tracking i
-00010e20: 6e20 7468 6520 7365 7276 6572 5c6e 7468  n the server\nth
-00010e30: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
-00010e40: 6520 636f 6d6d 6974 2073 6571 7565 6e63  e commit sequenc
-00010e50: 6520 6f66 2065 7665 6e74 7320 7468 6174  e of events that
-00010e60: 2068 6176 6520 6265 656e 2070 726f 6365   have been proce
-00010e70: 7373 6564 2c20 7468 6572 6520 6973 5c6e  ssed, there is\n
-00010e80: 7468 6520 6461 6e67 6572 206f 6620 2264  the danger of "d
-00010e90: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
-00010ea0: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
-00010eb0: 6f66 2065 7665 6e74 732e 2052 656c 6961  of events. Relia
-00010ec0: 6269 6c69 7479 2069 6e20 7072 6f63 6573  bility in proces
-00010ed0: 7369 6e67 5c6e 6f66 2072 6563 6f72 6465  sing\nof recorde
-00010ee0: 6420 6576 656e 7473 2062 7920 6120 6772  d events by a gr
-00010ef0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00010f00: 2077 696c 6c20 7265 6c79 2069 6e73 7465   will rely inste
-00010f10: 6164 206f 6e20 6964 656d 706f 7465 6e74  ad on idempotent
-00010f20: 2068 616e 646c 696e 675c 6e6f 6620 6475   handling\nof du
-00010f30: 706c 6963 6174 6520 6d65 7373 6167 6573  plicate messages
-00010f40: 2c20 616e 6420 7265 7369 6c69 656e 6365  , and resilience
-00010f50: 2074 6f20 6f75 742d 6f66 2d6f 7264 6572   to out-of-order
-00010f60: 2064 656c 6976 6572 792e 5c6e 5c6e 2323   delivery.\n\n##
-00010f70: 2320 4765 7420 7375 6273 6372 6970 7469  # Get subscripti
-00010f80: 6f6e 2069 6e66 6f5c 6e5c 6e2a 7265 7175  on info\n\n*requ
-00010f90: 6972 6573 206c 6561 6465 722a 5c6e 5c6e  ires leader*\n\n
-00010fa0: 5468 6520 6067 6574 5f73 7562 7363 7269  The `get_subscri
-00010fb0: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
-00010fc0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00010fd0: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
-00010fe0: 696f 6e20 666f 7220 615c 6e70 6572 7369  ion for a\npersi
-00010ff0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-00011000: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
-00011010: 6f64 2068 6173 206f 6e65 2072 6571 7569  od has one requi
-00011020: 7265 6420 6172 6775 6d65 6e74 2c20 6067  red argument, `g
-00011030: 726f 7570 5f6e 616d 6560 2c20 7768 6963  roup_name`, whic
-00011040: 685c 6e73 686f 756c 6420 6d61 7463 6820  h\nshould match 
-00011050: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-00011060: 2061 7267 756d 656e 7420 7573 6564 2077   argument used w
-00011070: 6865 6e20 6361 6c6c 696e 6720 6063 7265  hen calling `cre
-00011080: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00011090: 2829 602e 5c6e 5c6e 5468 6973 206d 6574  ()`.\n\nThis met
-000110a0: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-000110b0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-000110c0: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-000110d0: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
-000110e0: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-000110f0: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-00011100: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
-00011110: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00011120: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00011130: 7065 7261 7469 6f6e 2e5c 6e5c 6e60 6060  peration.\n\n```
-00011140: 7079 7468 6f6e 5c6e 7375 6273 6372 6970  python\nsubscrip
-00011150: 7469 6f6e 5f69 6e66 6f20 3d20 636c 6965  tion_info = clie
-00011160: 6e74 2e67 6574 5f73 7562 7363 7269 7074  nt.get_subscript
-00011170: 696f 6e5f 696e 666f 285c 6e20 2020 2067  ion_info(\n    g
-00011180: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-00011190: 6e61 6d65 2c5c 6e29 5c6e 6060 605c 6e5c  name,\n)\n```\n\
-000111a0: 6e54 6865 2072 6574 7572 6e65 6420 7661  nThe returned va
-000111b0: 6c75 6520 6973 2061 2060 5375 6273 6372  lue is a `Subscr
-000111c0: 6970 7469 6f6e 496e 666f 6020 6f62 6a65  iptionInfo` obje
-000111d0: 6374 2e5c 6e5c 6e23 2323 204c 6973 7420  ct.\n\n### List 
-000111e0: 7375 6273 6372 6970 7469 6f6e 735c 6e5c  subscriptions\n\
-000111f0: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
-00011200: 722a 5c6e 5c6e 5468 6520 606c 6973 745f  r*\n\nThe `list_
-00011210: 7375 6273 6372 6970 7469 6f6e 7328 2960  subscriptions()`
-00011220: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00011230: 7365 6420 746f 2067 6574 2069 6e66 6f72  sed to get infor
-00011240: 6d61 7469 6f6e 2066 6f72 2061 6c6c 5c6e  mation for all\n
-00011250: 6578 6973 7469 6e67 2070 6572 7369 7374  existing persist
-00011260: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00011270: 732e 5c6e 5c6e 5468 6973 206d 6574 686f  s.\n\nThis metho
-00011280: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
-00011290: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-000112a0: 6775 6d65 6e74 2c20 7468 6174 5c6e 6973  gument, that\nis
-000112b0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-000112c0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-000112d0: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-000112e0: 6561 646c 696e 655c 6e66 6f72 2074 6865  eadline\nfor the
-000112f0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00011300: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00011310: 6e2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  n.\n\n```python\
-00011320: 6e73 7562 7363 7269 7074 696f 6e73 203d  nsubscriptions =
-00011330: 2063 6c69 656e 742e 6c69 7374 5f73 7562   client.list_sub
-00011340: 7363 7269 7074 696f 6e73 2829 5c6e 6060  scriptions()\n``
-00011350: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
-00011360: 6420 7661 6c75 6520 6973 2061 206c 6973  d value is a lis
-00011370: 7420 6f66 2060 5375 6273 6372 6970 7469  t of `Subscripti
-00011380: 6f6e 496e 666f 6020 6f62 6a65 6374 732e  onInfo` objects.
-00011390: 5c6e 5c6e 2323 2320 5570 6461 7465 2073  \n\n### Update s
-000113a0: 7562 7363 7269 7074 696f 6e5c 6e5c 6e2a  ubscription\n\n*
-000113b0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
-000113c0: 5c6e 5c6e 5468 6520 6d65 7468 6f64 2060  \n\nThe method `
-000113d0: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
-000113e0: 696f 6e28 2960 2063 616e 2062 6520 7573  ion()` can be us
-000113f0: 6564 2074 6f20 7570 6461 7465 2061 5c6e  ed to update a\n
-00011400: 2270 6572 7369 7374 656e 7420 7375 6273  "persistent subs
-00011410: 6372 6970 7469 6f6e 222e 5c6e 5c6e 5468  cription".\n\nTh
-00011420: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
-00011430: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
-00011440: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
-00011450: 2c20 7768 6963 6820 6973 2074 6865 5c6e  , which is the\n
-00011460: 6e61 6d65 206f 6620 6120 2267 726f 7570  name of a "group
-00011470: 2220 6f66 2063 6f6e 7375 6d65 7273 206f  " of consumers o
-00011480: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-00011490: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
-000114a0: 6f64 2061 6c73 6f20 7461 6b65 7320 7468  od also takes th
-000114b0: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
-000114c0: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
-000114d0: 6460 2c20 6063 6f6d 6d69 745f 706f 7369  d`, `commit_posi
-000114e0: 7469 6f6e 602c 5c6e 616e 6420 6074 696d  tion`,\nand `tim
-000114f0: 656f 7574 602e 5c6e 5c6e 5468 6520 6f70  eout`.\n\nThe op
-00011500: 7469 6f6e 616c 2060 6672 6f6d 5f65 6e64  tional `from_end
-00011510: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
-00011520: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
-00011530: 7920 7468 6174 2074 6865 2067 726f 7570  y that the group
-00011540: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
-00011550: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-00011560: 6f6e 2073 686f 756c 6420 6f6e 6c79 2072  on should only r
-00011570: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
-00011580: 6174 2077 6572 6520 7265 636f 7264 6564  at were recorded
-00011590: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
-000115a0: 7269 7074 696f 6e5c 6e77 6173 2075 7064  ription\nwas upd
-000115b0: 6174 6564 2e5c 6e5c 6e41 6c74 6572 6e61  ated.\n\nAlterna
-000115c0: 7469 7665 6c79 2c20 7468 6520 6f70 7469  tively, the opti
-000115d0: 6f6e 616c 2060 636f 6d6d 6974 5f70 6f73  onal `commit_pos
-000115e0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
-000115f0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
-00011600: 7065 6369 6679 2061 2063 6f6d 6d69 745c  pecify a commit\
-00011610: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
-00011620: 6869 6368 2063 6f6d 6d69 7420 706f 7369  hich commit posi
-00011630: 7469 6f6e 2074 6865 2067 726f 7570 206f  tion the group o
-00011640: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
-00011650: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00011660: 7368 6f75 6c64 5c6e 7265 6365 6976 6520  should\nreceive 
-00011670: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
-00011680: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
-00011690: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
-000116a0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
-000116b0: 706f 7369 7469 6f6e 206d 6967 6874 5c6e  position might\n
-000116c0: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
-000116d0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-000116e0: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
-000116f0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
-00011700: 756d 6572 732e 5c6e 5c6e 4966 206e 6569  umers.\n\nIf nei
-00011710: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
-00011720: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
-00011730: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
-00011740: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
-00011750: 2063 6f6e 7375 6d65 7273 5c6e 6f66 2074   consumers\nof t
-00011760: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00011770: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
-00011780: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
-00011790: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-000117a0: 7468 6520 6461 7461 6261 7365 2e5c 6e5c  the database.\n\
-000117b0: 6e50 6c65 6173 6520 6e6f 7465 2c20 7468  nPlease note, th
-000117c0: 6520 6669 6c74 6572 206f 7074 696f 6e73  e filter options
-000117d0: 2061 6e64 2063 6f6e 7375 6d65 7220 7374   and consumer st
-000117e0: 7261 7465 6779 2063 616e 6e6f 7420 6265  rategy cannot be
-000117f0: 2061 646a 7573 7465 642e 5c6e 5c6e 5468   adjusted.\n\nTh
-00011800: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
-00011810: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
-00011820: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00011830: 6020 7768 6963 6820 7365 7473 2061 5c6e  ` which sets a\n
-00011840: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
-00011850: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00011860: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00011870: 6e2e 5c6e 5c6e 5468 6520 6d65 7468 6f64  n.\n\nThe method
-00011880: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
-00011890: 7074 696f 6e28 2960 2064 6f65 7320 6e6f  ption()` does no
-000118a0: 7420 7265 7475 726e 2061 2076 616c 7565  t return a value
-000118b0: 2e5c 6e5c 6e49 6e20 7468 6520 6578 616d  .\n\nIn the exam
-000118c0: 706c 6520 6265 6c6f 772c 2061 2070 6572  ple below, a per
-000118d0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-000118e0: 7469 6f6e 2069 7320 7570 6461 7465 6420  tion is updated 
-000118f0: 746f 2072 756e 2066 726f 6d20 7468 6520  to run from the 
-00011900: 656e 6420 6f66 2074 6865 5c6e 6461 7461  end of the\ndata
-00011910: 6261 7365 2e5c 6e5c 6e60 6060 7079 7468  base.\n\n```pyth
-00011920: 6f6e 5c6e 2320 4372 6561 7465 2061 2070  on\n# Create a p
-00011930: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00011940: 6970 7469 6f6e 2e5c 6e63 6c69 656e 742e  iption.\nclient.
-00011950: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
-00011960: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
-00011970: 726f 7570 5f6e 616d 652c 2066 726f 6d5f  roup_name, from_
-00011980: 656e 643d 5472 7565 295c 6e60 6060 5c6e  end=True)\n```\n
-00011990: 5c6e 2323 2320 4465 6c65 7465 2073 7562  \n### Delete sub
-000119a0: 7363 7269 7074 696f 6e5c 6e5c 6e2a 7265  scription\n\n*re
-000119b0: 7175 6972 6573 206c 6561 6465 722a 5c6e  quires leader*\n
-000119c0: 5c6e 5468 6520 6064 656c 6574 655f 7375  \nThe `delete_su
-000119d0: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
-000119e0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-000119f0: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
-00011a00: 7369 7374 656e 745c 6e73 7562 7363 7269  sistent\nsubscri
-00011a10: 7074 696f 6e2e 5c6e 5c6e 5468 6973 206d  ption.\n\nThis m
-00011a20: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
-00011a30: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
-00011a40: 2060 6772 6f75 705f 6e61 6d65 602c 2077   `group_name`, w
-00011a50: 6869 6368 5c6e 7368 6f75 6c64 206d 6174  hich\nshould mat
-00011a60: 6368 2074 6865 2076 616c 7565 206f 6620  ch the value of 
-00011a70: 6172 6775 6d65 6e74 2075 7365 6420 7768  argument used wh
-00011a80: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
-00011a90: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
-00011aa0: 2960 2e5c 6e5c 6e54 6869 7320 6d65 7468  )`.\n\nThis meth
-00011ab0: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
-00011ac0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00011ad0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
-00011ae0: 6174 5c6e 6973 2065 7870 6563 7465 6420  at\nis expected 
-00011af0: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
-00011b00: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
-00011b10: 7473 2061 2064 6561 646c 696e 655c 6e66  ts a deadline\nf
-00011b20: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00011b30: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00011b40: 6572 6174 696f 6e2e 5c6e 5c6e 6060 6070  eration.\n\n```p
-00011b50: 7974 686f 6e5c 6e63 6c69 656e 742e 6465  ython\nclient.de
-00011b60: 6c65 7465 5f73 7562 7363 7269 7074 696f  lete_subscriptio
-00011b70: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
-00011b80: 6d65 3d67 726f 7570 5f6e 616d 652c 5c6e  me=group_name,\n
-00011b90: 295c 6e60 6060 5c6e 5c6e 2323 2320 4372  )\n```\n\n### Cr
-00011ba0: 6561 7465 2073 7472 6561 6d20 7375 6273  eate stream subs
-00011bb0: 6372 6970 7469 6f6e 5c6e 5c6e 2a72 6571  cription\n\n*req
-00011bc0: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00011bd0: 6e54 6865 2060 6372 6561 7465 5f73 7472  nThe `create_str
-00011be0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00011bf0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00011c00: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
-00011c10: 2061 2070 6572 7369 7374 656e 745c 6e73   a persistent\ns
-00011c20: 7562 7363 7269 7074 696f 6e20 666f 7220  ubscription for 
-00011c30: 6120 7374 7265 616d 2e5c 6e5c 6e54 6869  a stream.\n\nThi
-00011c40: 7320 6d65 7468 6f64 2068 6173 2074 776f  s method has two
-00011c50: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-00011c60: 6e74 732c 2060 6772 6f75 705f 6e61 6d65  nts, `group_name
-00011c70: 6020 616e 6420 6073 7472 6561 6d5f 6e61  ` and `stream_na
-00011c80: 6d65 602e 2054 6865 5c6e 6067 726f 7570  me`. The\n`group
-00011c90: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
-00011ca0: 6e61 6d65 7320 7468 6520 6772 6f75 7020  names the group 
-00011cb0: 6f66 2063 6f6e 7375 6d65 7273 2074 6861  of consumers tha
-00011cc0: 7420 7769 6c6c 2072 6563 6569 7665 2065  t will receive e
-00011cd0: 7665 6e74 735c 6e66 726f 6d20 7468 6973  vents\nfrom this
-00011ce0: 2073 7562 7363 7269 7074 696f 6e2e 2054   subscription. T
-00011cf0: 6865 2060 7374 7265 616d 5f6e 616d 6560  he `stream_name`
-00011d00: 2061 7267 756d 656e 7420 7370 6563 6966   argument specif
-00011d10: 6965 7320 7768 6963 6820 7374 7265 616d  ies which stream
-00011d20: 5c6e 7468 6520 7375 6273 6372 6970 7469  \nthe subscripti
-00011d30: 6f6e 2077 696c 6c20 666f 6c6c 6f77 2e20  on will follow. 
-00011d40: 5468 6520 7661 6c75 6573 206f 6620 626f  The values of bo
-00011d50: 7468 2074 6865 7365 2061 7267 756d 656e  th these argumen
-00011d60: 7473 2061 7265 2065 7870 6563 7465 645c  ts are expected\
-00011d70: 6e74 6f20 6265 2050 7974 686f 6e20 6073  nto be Python `s
-00011d80: 7472 6020 6f62 6a65 6374 732e 5c6e 5c6e  tr` objects.\n\n
-00011d90: 5468 6520 6d65 7468 6f64 2061 6c73 6f20  The method also 
-00011da0: 7461 6b65 7320 666f 7572 206f 7074 696f  takes four optio
-00011db0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
-00011dc0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-00011dd0: 2c20 6066 726f 6d5f 656e 6460 2c5c 6e60  , `from_end`,\n`
-00011de0: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
-00011df0: 7960 2c20 616e 6420 6074 696d 656f 7574  y`, and `timeout
-00011e00: 602e 5c6e 5c6e 5468 6973 206f 7074 696f  `.\n\nThis optio
-00011e10: 6e61 6c20 6073 7472 6561 6d5f 706f 7369  nal `stream_posi
-00011e20: 7469 6f6e 6020 6172 6775 6d65 6e74 2073  tion` argument s
-00011e30: 7065 6369 6669 6573 2061 2073 7472 6561  pecifies a strea
-00011e40: 6d20 706f 7369 7469 6f6e 2066 726f 6d5c  m position from\
-00011e50: 6e77 6869 6368 2074 6f20 7375 6273 6372  nwhich to subscr
-00011e60: 6962 652e 2054 6865 2072 6563 6f72 6465  ibe. The recorde
-00011e70: 6420 6576 656e 7420 6174 2074 6869 7320  d event at this 
-00011e80: 7374 7265 616d 5c6e 706f 7369 7469 6f6e  stream\nposition
-00011e90: 2077 696c 6c20 6265 2072 6563 6569 7665   will be receive
-00011ea0: 6420 7768 656e 2072 6561 6469 6e67 2074  d when reading t
-00011eb0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-00011ec0: 5c6e 5c6e 5468 6973 206f 7074 696f 6e61  \n\nThis optiona
-00011ed0: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
-00011ee0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-00011ef0: 6e20 6062 6f6f 6c60 2e5c 6e42 7920 6465  n `bool`.\nBy de
-00011f00: 6661 756c 742c 2074 6865 2076 616c 7565  fault, the value
-00011f10: 206f 6620 7468 6973 2061 7267 756d 656e   of this argumen
-00011f20: 7420 6973 2060 4661 6c73 6560 2e20 4966  t is `False`. If
-00011f30: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-00011f40: 7320 7365 745c 6e74 6f20 6054 7275 6560  s set\nto `True`
-00011f50: 2c20 7265 6164 696e 6720 6672 6f6d 2074  , reading from t
-00011f60: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00011f70: 7769 6c6c 2072 6563 6569 7665 206f 6e6c  will receive onl
-00011f80: 7920 6576 656e 7473 5c6e 7265 636f 7264  y events\nrecord
-00011f90: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-00011fa0: 7363 7269 7074 696f 6e20 7761 7320 6372  scription was cr
-00011fb0: 6561 7465 642e 2054 6861 7420 6973 2c20  eated. That is, 
-00011fc0: 6974 2069 7320 6e6f 7420 696e 636c 7573  it is not inclus
-00011fd0: 6976 655c 6e6f 6620 7468 6520 6375 7272  ive\nof the curr
-00011fe0: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
-00011ff0: 696f 6e2e 5c6e 5c6e 5468 6520 6f70 7469  ion.\n\nThe opti
-00012000: 6f6e 616c 2060 636f 6e73 756d 6572 5f73  onal `consumer_s
-00012010: 7472 6174 6567 7960 2061 7267 756d 656e  trategy` argumen
-00012020: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
-00012030: 7472 6020 7468 6174 2064 6566 696e 6573  tr` that defines
-00012040: 5c6e 7468 6520 636f 6e73 756d 6572 2073  \nthe consumer s
-00012050: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
-00012060: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00012070: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
-00012080: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
-00012090: 6d65 6e74 5c6e 6361 6e20 6265 2060 5c27  ment\ncan be `\'
-000120a0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
-000120b0: 5c27 602c 2060 5c27 526f 756e 6452 6f62  \'`, `\'RoundRob
-000120c0: 696e 5c27 602c 2060 5c27 5069 6e6e 6564  in\'`, `\'Pinned
-000120d0: 5c27 602c 206f 7220 605c 2750 696e 6e65  \'`, or `\'Pinne
-000120e0: 6442 7943 6f72 7265 6c61 7469 6f6e 5c27  dByCorrelation\'
-000120f0: 602e 2054 6865 5c6e 6465 6661 756c 7420  `. The\ndefault 
-00012100: 7661 6c75 6520 6973 2060 5c27 4469 7370  value is `\'Disp
-00012110: 6174 6368 546f 5369 6e67 6c65 5c27 602e  atchToSingle\'`.
-00012120: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00012130: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
-00012140: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00012150: 2061 7267 756d 656e 742c 2074 6861 745c   argument, that\
-00012160: 6e69 7320 6578 7065 6374 6564 2074 6f20  nis expected to 
-00012170: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-00012180: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-00012190: 6120 6465 6164 6c69 6e65 5c6e 666f 7220  a deadline\nfor 
-000121a0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-000121b0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-000121c0: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
-000121d0: 7468 6f64 2064 6f65 7320 6e6f 7420 7265  thod does not re
-000121e0: 7475 726e 2061 2076 616c 7565 2e20 4576  turn a value. Ev
-000121f0: 656e 7473 2063 616e 2062 6520 7265 6365  ents can be rece
-00012200: 6976 6564 2062 7920 6974 6572 6174 696e  ived by iteratin
-00012210: 675c 6e6f 7665 7220 7468 6520 7661 6c75  g\nover the valu
-00012220: 6520 7265 7475 726e 6564 2062 7920 6361  e returned by ca
-00012230: 6c6c 696e 6720 6072 6561 645f 7374 7265  lling `read_stre
-00012240: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
-00012250: 2960 2e5c 6e5c 6e54 6865 2065 7861 6d70  )`.\n\nThe examp
-00012260: 6c65 2062 656c 6f77 2063 7265 6174 6573  le below creates
-00012270: 2061 2070 6572 7369 7374 656e 7420 7374   a persistent st
-00012280: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00012290: 6e20 6672 6f6d 2074 6865 2073 7461 7274  n from the start
-000122a0: 206f 6620 7468 6520 7374 7265 616d 2e5c   of the stream.\
-000122b0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 2320  n\n```python\n# 
-000122c0: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
-000122d0: 656e 7420 7374 7265 616d 2073 7562 7363  ent stream subsc
-000122e0: 7269 7074 696f 6e20 6672 6f6d 2073 7461  ription from sta
-000122f0: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
-00012300: 2e5c 6e67 726f 7570 5f6e 616d 6531 203d  .\ngroup_name1 =
-00012310: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
-00012320: 297d 225c 6e63 6c69 656e 742e 6372 6561  )}"\nclient.crea
-00012330: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
-00012340: 6970 7469 6f6e 285c 6e20 2020 2067 726f  iption(\n    gro
-00012350: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-00012360: 6d65 312c 5c6e 2020 2020 7374 7265 616d  me1,\n    stream
-00012370: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00012380: 6532 2c5c 6e29 5c6e 6060 605c 6e5c 6e54  e2,\n)\n```\n\nT
-00012390: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-000123a0: 2063 7265 6174 6573 2061 2070 6572 7369   creates a persi
-000123b0: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
-000123c0: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
-000123d0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-000123e0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-000123f0: 2320 4372 6561 7465 2061 2070 6572 7369  # Create a persi
-00012400: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
-00012410: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
-00012420: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00012430: 2e5c 6e67 726f 7570 5f6e 616d 6532 203d  .\ngroup_name2 =
-00012440: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
-00012450: 297d 225c 6e63 6c69 656e 742e 6372 6561  )}"\nclient.crea
-00012460: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
-00012470: 6970 7469 6f6e 285c 6e20 2020 2067 726f  iption(\n    gro
-00012480: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-00012490: 6d65 322c 5c6e 2020 2020 7374 7265 616d  me2,\n    stream
-000124a0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-000124b0: 6532 2c5c 6e20 2020 2073 7472 6561 6d5f  e2,\n    stream_
-000124c0: 706f 7369 7469 6f6e 3d32 5c6e 295c 6e60  position=2\n)\n`
-000124d0: 6060 5c6e 5c6e 5468 6520 6578 616d 706c  ``\n\nThe exampl
-000124e0: 6520 6265 6c6f 7720 6372 6561 7465 7320  e below creates 
-000124f0: 6120 7065 7273 6973 7465 6e74 2073 7472  a persistent str
-00012500: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00012510: 2066 726f 6d20 7468 6520 656e 6420 6f66   from the end of
-00012520: 2074 6865 2073 7472 6561 6d2e 5c6e 5c6e   the stream.\n\n
-00012530: 6060 6070 7974 686f 6e5c 6e23 2043 7265  ```python\n# Cre
-00012540: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
-00012550: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00012560: 7469 6f6e 2066 726f 6d20 656e 6420 6f66  tion from end of
-00012570: 2074 6865 2073 7472 6561 6d2e 5c6e 6772   the stream.\ngr
-00012580: 6f75 705f 6e61 6d65 3320 3d20 6622 6772  oup_name3 = f"gr
-00012590: 6f75 702d 7b75 7569 6434 2829 7d22 5c6e  oup-{uuid4()}"\n
-000125a0: 636c 6965 6e74 2e63 7265 6174 655f 7374  client.create_st
-000125b0: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-000125c0: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
-000125d0: 6d65 3d67 726f 7570 5f6e 616d 6533 2c5c  me=group_name3,\
-000125e0: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
-000125f0: 3d73 7472 6561 6d5f 6e61 6d65 322c 5c6e  =stream_name2,\n
-00012600: 2020 2020 6672 6f6d 5f65 6e64 3d54 7275      from_end=Tru
-00012610: 655c 6e29 5c6e 6060 605c 6e5c 6e23 2323  e\n)\n```\n\n###
-00012620: 2052 6561 6420 7374 7265 616d 2073 7562   Read stream sub
-00012630: 7363 7269 7074 696f 6e5c 6e5c 6e2a 7265  scription\n\n*re
-00012640: 7175 6972 6573 206c 6561 6465 722a 5c6e  quires leader*\n
-00012650: 5c6e 5468 6520 6072 6561 645f 7374 7265  \nThe `read_stre
-00012660: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
-00012670: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-00012680: 2075 7365 6420 746f 2072 6561 6420 6120   used to read a 
-00012690: 7065 7273 6973 7465 6e74 5c6e 7374 7265  persistent\nstre
-000126a0: 616d 2073 7562 7363 7269 7074 696f 6e2e  am subscription.
-000126b0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-000126c0: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-000126d0: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-000126e0: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-000126f0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
-00012700: 685c 6e73 686f 756c 6420 6d61 7463 6820  h\nshould match 
-00012710: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
-00012720: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
-00012730: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
-00012740: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-00012750: 7074 696f 6e28 2960 2e5c 6e5c 6e54 6869  ption()`.\n\nThi
-00012760: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-00012770: 6b65 7320 616e 206f 7074 696f 6e61 6c20  kes an optional 
-00012780: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00012790: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-000127a0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-000127b0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-000127c0: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-000127d0: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-000127e0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-000127f0: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-00012800: 5c6e 5468 6973 206d 6574 686f 6420 7265  \nThis method re
-00012810: 7475 726e 7320 6120 6050 6572 7369 7374  turns a `Persist
-00012820: 656e 7453 7562 7363 7269 7074 696f 6e60  entSubscription`
-00012830: 206f 626a 6563 742c 2077 6869 6368 2069   object, which i
-00012840: 7320 616e 2069 7465 7261 746f 725c 6e67  s an iterator\ng
-00012850: 6976 696e 6720 6052 6563 6f72 6465 6445  iving `RecordedE
-00012860: 7665 6e74 6020 6f62 6a65 6374 732c 2074  vent` objects, t
-00012870: 6861 7420 616c 736f 2068 6173 2060 6163  hat also has `ac
-00012880: 6b28 2960 2c20 606e 6163 6b28 2960 2061  k()`, `nack()` a
-00012890: 6e64 2060 7374 6f70 2829 605c 6e6d 6574  nd `stop()`\nmet
-000128a0: 686f 6473 2e5c 6e5c 6e60 6060 7079 7468  hods.\n\n```pyth
-000128b0: 6f6e 5c6e 7375 6273 6372 6970 7469 6f6e  on\nsubscription
-000128c0: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
-000128d0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-000128e0: 6f6e 285c 6e20 2020 2067 726f 7570 5f6e  on(\n    group_n
-000128f0: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
-00012900: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
-00012910: 653d 7374 7265 616d 5f6e 616d 6532 2c5c  e=stream_name2,\
-00012920: 6e29 5c6e 6060 605c 6e5c 6e54 6865 2065  n)\n```\n\nThe e
-00012930: 7861 6d70 6c65 2062 656c 6f77 2069 7465  xample below ite
-00012940: 7261 7465 7320 6f76 6572 2074 6865 2073  rates over the s
-00012950: 7562 7363 7269 7074 696f 6e20 6f62 6a65  ubscription obje
-00012960: 6374 2c20 616e 6420 6361 6c6c 7320 6061  ct, and calls `a
-00012970: 636b 2829 602e 5c6e 5468 6520 666f 7220  ck()`.\nThe for 
-00012980: 6c6f 6f70 2062 7265 616b 7320 7768 656e  loop breaks when
-00012990: 2077 6520 6861 7665 2072 6563 6569 7665   we have receive
-000129a0: 6420 7468 6520 6c61 7374 2065 7665 6e74  d the last event
-000129b0: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
-000129c0: 736f 5c6e 7468 6174 2077 6520 6361 6e20  so\nthat we can 
-000129d0: 6669 6e69 7368 2074 6865 2065 7861 6d70  finish the examp
-000129e0: 6c65 7320 696e 2074 6869 7320 646f 6375  les in this docu
-000129f0: 6d65 6e74 6174 696f 6e2e 5c6e 5c6e 6060  mentation.\n\n``
-00012a00: 6070 7974 686f 6e5c 6e65 7665 6e74 7320  `python\nevents 
-00012a10: 3d20 5b5d 5c6e 666f 7220 6576 656e 7420  = []\nfor event 
-00012a20: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
-00012a30: 5c6e 2020 2020 6576 656e 7473 2e61 7070  \n    events.app
-00012a40: 656e 6428 6576 656e 7429 5c6e 5c6e 2020  end(event)\n\n  
-00012a50: 2020 2320 4163 6b6e 6f77 6c65 6467 6520    # Acknowledge 
-00012a60: 7468 6520 7265 6365 6976 6564 2065 7665  the received eve
-00012a70: 6e74 2e5c 6e20 2020 2073 7562 7363 7269  nt.\n    subscri
-00012a80: 7074 696f 6e2e 6163 6b28 6576 656e 745f  ption.ack(event_
-00012a90: 6964 3d65 7665 6e74 2e69 6429 5c6e 5c6e  id=event.id)\n\n
-00012aa0: 2020 2020 2320 5374 6f70 2077 6865 6e20      # Stop when 
-00012ab0: 5c27 6576 656e 7431 315c 2720 6861 7320  \'event11\' has 
-00012ac0: 6265 656e 2072 6563 6569 7665 642e 5c6e  been received.\n
-00012ad0: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-00012ae0: 3d3d 2065 7665 6e74 3131 2e69 643a 5c6e  == event11.id:\n
-00012af0: 2020 2020 2020 2020 7375 6273 6372 6970          subscrip
-00012b00: 7469 6f6e 2e73 746f 7028 295c 6e60 6060  tion.stop()\n```
-00012b10: 5c6e 5c6e 5765 2063 616e 2063 6865 636b  \n\nWe can check
-00012b20: 2077 6520 7265 6365 6976 6564 2061 6c6c   we received all
-00012b30: 2074 6865 2065 7665 6e74 7320 7468 6174   the events that
-00012b40: 2077 6572 6520 6170 7065 6e64 6564 2074   were appended t
-00012b50: 6f20 6073 7472 6561 6d5f 6e61 6d65 3260  o `stream_name2`
-00012b60: 5c6e 696e 2074 6865 2065 7861 6d70 6c65  \nin the example
-00012b70: 7320 6162 6f76 652e 5c6e 5c6e 6060 6070  s above.\n\n```p
-00012b80: 7974 686f 6e5c 6e61 7373 6572 7420 6c65  ython\nassert le
-00012b90: 6e28 6576 656e 7473 2920 3d3d 2034 5c6e  n(events) == 4\n
-00012ba0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00012bb0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00012bc0: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
-00012bd0: 7365 7274 2065 7665 6e74 735b 305d 2e69  sert events[0].i
-00012be0: 6420 3d3d 2065 7665 6e74 342e 6964 5c6e  d == event4.id\n
-00012bf0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00012c00: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00012c10: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
-00012c20: 7365 7274 2065 7665 6e74 735b 315d 2e69  sert events[1].i
-00012c30: 6420 3d3d 2065 7665 6e74 352e 6964 5c6e  d == event5.id\n
-00012c40: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00012c50: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00012c60: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
-00012c70: 7365 7274 2065 7665 6e74 735b 325d 2e69  sert events[2].i
-00012c80: 6420 3d3d 2065 7665 6e74 362e 6964 5c6e  d == event6.id\n
-00012c90: 6173 7365 7274 2065 7665 6e74 735b 335d  assert events[3]
-00012ca0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00012cb0: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
-00012cc0: 7365 7274 2065 7665 6e74 735b 335d 2e69  sert events[3].i
-00012cd0: 6420 3d3d 2065 7665 6e74 3131 2e69 645c  d == event11.id\
-00012ce0: 6e60 6060 5c6e 5c6e 2323 2320 4765 7420  n```\n\n### Get 
-00012cf0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00012d00: 696f 6e20 696e 666f 5c6e 5c6e 2a72 6571  ion info\n\n*req
-00012d10: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00012d20: 6e54 6865 2060 6765 745f 7374 7265 616d  nThe `get_stream
-00012d30: 5f73 7562 7363 7269 7074 696f 6e5f 696e  _subscription_in
-00012d40: 666f 2829 6020 6d65 7468 6f64 2063 616e  fo()` method can
-00012d50: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
-00012d60: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
-00012d70: 615c 6e70 6572 7369 7374 656e 7420 7375  a\npersistent su
-00012d80: 6273 6372 6970 7469 6f6e 2066 6f72 2061  bscription for a
-00012d90: 2073 7472 6561 6d2e 5c6e 5c6e 5468 6973   stream.\n\nThis
-00012da0: 206d 6574 686f 6420 6861 7320 7477 6f20   method has two 
-00012db0: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00012dc0: 7473 2c20 6067 726f 7570 5f6e 616d 6560  ts, `group_name`
-00012dd0: 2061 6e64 2060 7374 7265 616d 5f6e 616d   and `stream_nam
-00012de0: 6560 2c20 7768 6963 685c 6e73 686f 756c  e`, which\nshoul
-00012df0: 6420 6d61 7463 6820 7468 6520 7661 6c75  d match the valu
-00012e00: 6573 206f 6620 6172 6775 6d65 6e74 7320  es of arguments 
-00012e10: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00012e20: 6720 6063 7265 6174 655f 7374 7265 616d  g `create_stream
-00012e30: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00012e40: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00012e50: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
-00012e60: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-00012e70: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
-00012e80: 5c6e 6973 2065 7870 6563 7465 6420 746f  \nis expected to
-00012e90: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
-00012ea0: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
-00012eb0: 2061 2064 6561 646c 696e 655c 6e66 6f72   a deadline\nfor
-00012ec0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-00012ed0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-00012ee0: 6174 696f 6e2e 5c6e 5c6e 6060 6070 7974  ation.\n\n```pyt
-00012ef0: 686f 6e5c 6e73 7562 7363 7269 7074 696f  hon\nsubscriptio
-00012f00: 6e5f 696e 666f 203d 2063 6c69 656e 742e  n_info = client.
-00012f10: 6765 745f 7374 7265 616d 5f73 7562 7363  get_stream_subsc
-00012f20: 7269 7074 696f 6e5f 696e 666f 285c 6e20  ription_info(\n 
-00012f30: 2020 2067 726f 7570 5f6e 616d 653d 6772     group_name=gr
-00012f40: 6f75 705f 6e61 6d65 312c 5c6e 2020 2020  oup_name1,\n    
-00012f50: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00012f60: 616d 5f6e 616d 6532 2c5c 6e29 5c6e 6060  am_name2,\n)\n``
-00012f70: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
-00012f80: 6420 7661 6c75 6520 6973 2061 2060 5375  d value is a `Su
-00012f90: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
-00012fa0: 6f62 6a65 6374 2e5c 6e5c 6e23 2323 204c  object.\n\n### L
-00012fb0: 6973 7420 7374 7265 616d 2073 7562 7363  ist stream subsc
-00012fc0: 7269 7074 696f 6e73 5c6e 5c6e 2a72 6571  riptions\n\n*req
-00012fd0: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00012fe0: 6e54 6865 2060 6c69 7374 5f73 7472 6561  nThe `list_strea
-00012ff0: 6d5f 7375 6273 6372 6970 7469 6f6e 7328  m_subscriptions(
-00013000: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-00013010: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
-00013020: 6f72 6d61 7469 6f6e 2066 6f72 2061 6c6c  ormation for all
-00013030: 5c6e 7468 6520 7065 7273 6973 7465 6e74  \nthe persistent
-00013040: 2073 7562 7363 7269 7074 696f 6e73 2066   subscriptions f
-00013050: 6f72 2061 2073 7472 6561 6d2e 5c6e 5c6e  or a stream.\n\n
-00013060: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00013070: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
-00013080: 756d 656e 742c 2060 7374 7265 616d 5f6e  ument, `stream_n
-00013090: 616d 6560 2e5c 6e5c 6e54 6869 7320 6d65  ame`.\n\nThis me
-000130a0: 7468 6f64 2061 6c73 6f20 7461 6b65 7320  thod also takes 
-000130b0: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
-000130c0: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
-000130d0: 7468 6174 5c6e 6973 2065 7870 6563 7465  that\nis expecte
-000130e0: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
-000130f0: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
-00013100: 7365 7473 2061 2064 6561 646c 696e 655c  sets a deadline\
-00013110: 6e66 6f72 2074 6865 2063 6f6d 706c 6574  nfor the complet
-00013120: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00013130: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 6060  operation.\n\n``
-00013140: 6070 7974 686f 6e5c 6e73 7562 7363 7269  `python\nsubscri
-00013150: 7074 696f 6e73 203d 2063 6c69 656e 742e  ptions = client.
-00013160: 6c69 7374 5f73 7472 6561 6d5f 7375 6273  list_stream_subs
-00013170: 6372 6970 7469 6f6e 7328 5c6e 2020 2020  criptions(\n    
-00013180: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00013190: 616d 5f6e 616d 6532 2c5c 6e29 5c6e 6060  am_name2,\n)\n``
-000131a0: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
-000131b0: 6420 7661 6c75 6520 6973 2061 206c 6973  d value is a lis
-000131c0: 7420 6f66 2060 5375 6273 6372 6970 7469  t of `Subscripti
-000131d0: 6f6e 496e 666f 6020 6f62 6a65 6374 732e  onInfo` objects.
-000131e0: 5c6e 5c6e 2323 2320 5570 6461 7465 2073  \n\n### Update s
-000131f0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00013200: 6f6e 5c6e 5c6e 2a72 6571 7569 7265 7320  on\n\n*requires 
-00013210: 6c65 6164 6572 2a5c 6e5c 6e54 6865 206d  leader*\n\nThe m
-00013220: 6574 686f 6420 6075 7064 6174 655f 7374  ethod `update_st
-00013230: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00013240: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
-00013250: 2074 6f20 7570 6461 7465 2061 5c6e 7065   to update a\npe
-00013260: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00013270: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
-00013280: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
-00013290: 6f64 2074 616b 6573 2061 2072 6571 7569  od takes a requi
-000132a0: 7265 6420 6067 726f 7570 5f6e 616d 6560  red `group_name`
-000132b0: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
-000132c0: 2069 7320 7468 655c 6e6e 616d 6520 6f66   is the\nname of
-000132d0: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
-000132e0: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
-000132f0: 7562 7363 7269 7074 696f 6e2c 2061 6e64  ubscription, and
-00013300: 2061 2072 6571 7569 7265 645c 6e60 7374   a required\n`st
-00013310: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-00013320: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
-00013330: 6520 6e61 6d65 206f 6620 6120 7374 7265  e name of a stre
-00013340: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
-00013350: 6f64 2061 6c73 6f20 7461 6b65 7320 7468  od also takes th
-00013360: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
-00013370: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
-00013380: 6460 2c20 6073 7472 6561 6d5f 706f 7369  d`, `stream_posi
-00013390: 7469 6f6e 602c 5c6e 616e 6420 6074 696d  tion`,\nand `tim
-000133a0: 656f 7574 602e 5c6e 5c6e 5468 6520 6f70  eout`.\n\nThe op
-000133b0: 7469 6f6e 616c 2060 6672 6f6d 5f65 6e64  tional `from_end
-000133c0: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
-000133d0: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
-000133e0: 7920 7468 6174 2074 6865 2067 726f 7570  y that the group
-000133f0: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
-00013400: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-00013410: 6f6e 2073 686f 756c 6420 6f6e 6c79 2072  on should only r
-00013420: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
-00013430: 6174 2077 6572 6520 7265 636f 7264 6564  at were recorded
-00013440: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
-00013450: 7269 7074 696f 6e5c 6e77 6173 2075 7064  ription\nwas upd
-00013460: 6174 6564 2e5c 6e5c 6e41 6c74 6572 6e61  ated.\n\nAlterna
-00013470: 7469 7665 6c79 2c20 7468 6520 6f70 7469  tively, the opti
-00013480: 6f6e 616c 2060 7374 7265 616d 5f70 6f73  onal `stream_pos
-00013490: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
-000134a0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
-000134b0: 7065 6369 6679 2061 2073 7472 6561 6d5c  pecify a stream\
-000134c0: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
-000134d0: 6869 6368 2063 6f6d 6d69 7420 706f 7369  hich commit posi
-000134e0: 7469 6f6e 2074 6865 2067 726f 7570 206f  tion the group o
-000134f0: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
-00013500: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00013510: 7368 6f75 6c64 5c6e 7265 6365 6976 6520  should\nreceive 
-00013520: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
-00013530: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
-00013540: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
-00013550: 7065 6369 6669 6564 2073 7472 6561 6d20  pecified stream 
-00013560: 706f 7369 7469 6f6e 206d 6967 6874 5c6e  position might\n
-00013570: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
-00013580: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00013590: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
-000135a0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
-000135b0: 756d 6572 732e 5c6e 5c6e 4966 206e 6569  umers.\n\nIf nei
-000135c0: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
-000135d0: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
-000135e0: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
-000135f0: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
-00013600: 2063 6f6e 7375 6d65 7273 5c6e 6f66 2074   consumers\nof t
-00013610: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00013620: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
-00013630: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
-00013640: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-00013650: 7468 6520 7374 7265 616d 2e5c 6e5c 6e50  the stream.\n\nP
-00013660: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
-00013670: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
-00013680: 7920 6361 6e6e 6f74 2062 6520 6164 6a75  y cannot be adju
-00013690: 7374 6564 2e5c 6e5c 6e54 6865 206f 7074  sted.\n\nThe opt
-000136a0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-000136b0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-000136c0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-000136d0: 6368 2073 6574 7320 615c 6e64 6561 646c  ch sets a\ndeadl
-000136e0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-000136f0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-00013700: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-00013710: 6e54 6865 206d 6574 686f 6420 6075 7064  nThe method `upd
-00013720: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
-00013730: 7269 7074 696f 6e28 2960 2064 6f65 7320  ription()` does 
-00013740: 6e6f 7420 7265 7475 726e 2061 2076 616c  not return a val
-00013750: 7565 2e5c 6e5c 6e49 6e20 7468 6520 6578  ue.\n\nIn the ex
-00013760: 616d 706c 6520 6265 6c6f 772c 2061 2070  ample below, a p
-00013770: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00013780: 6970 7469 6f6e 2066 6f72 2061 2073 7472  iption for a str
-00013790: 6561 6d20 6973 2075 7064 6174 6564 2074  eam is updated t
-000137a0: 6f20 7275 6e20 6672 6f6d 2074 6865 5c6e  o run from the\n
-000137b0: 656e 6420 6f66 2074 6865 2073 7472 6561  end of the strea
-000137c0: 6d2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  m.\n\n```python\
-000137d0: 6e23 2043 7265 6174 6520 6120 7065 7273  n# Create a pers
-000137e0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-000137f0: 696f 6e2e 5c6e 636c 6965 6e74 2e75 7064  ion.\nclient.upd
-00013800: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
-00013810: 7269 7074 696f 6e28 5c6e 2020 2020 6772  ription(\n    gr
-00013820: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
-00013830: 616d 6531 2c5c 6e20 2020 2073 7472 6561  ame1,\n    strea
-00013840: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00013850: 6d65 322c 5c6e 2020 2020 6672 6f6d 5f65  me2,\n    from_e
-00013860: 6e64 3d54 7275 652c 5c6e 295c 6e60 6060  nd=True,\n)\n```
-00013870: 5c6e 5c6e 2323 2320 4465 6c65 7465 2073  \n\n### Delete s
-00013880: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00013890: 6f6e 5c6e 5c6e 2a72 6571 7569 7265 7320  on\n\n*requires 
-000138a0: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
-000138b0: 6465 6c65 7465 5f73 7472 6561 6d5f 7375  delete_stream_su
-000138c0: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
-000138d0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-000138e0: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
-000138f0: 7369 7374 656e 745c 6e73 7562 7363 7269  sistent\nsubscri
-00013900: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
-00013910: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
-00013920: 6f64 2068 6173 2074 776f 2072 6571 7569  od has two requi
-00013930: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
-00013940: 6772 6f75 705f 6e61 6d65 6020 616e 6420  group_name` and 
-00013950: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
-00013960: 6869 6368 5c6e 7368 6f75 6c64 206d 6174  hich\nshould mat
-00013970: 6368 2074 6865 2076 616c 7565 7320 6f66  ch the values of
-00013980: 2061 7267 756d 656e 7473 2075 7365 6420   arguments used 
-00013990: 7768 656e 2063 616c 6c69 6e67 2060 6372  when calling `cr
-000139a0: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
-000139b0: 6372 6970 7469 6f6e 2829 602e 5c6e 5c6e  cription()`.\n\n
-000139c0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-000139d0: 2074 616b 6573 2061 6e20 6f70 7469 6f6e   takes an option
-000139e0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-000139f0: 756d 656e 742c 2074 6861 745c 6e69 7320  ument, that\nis 
-00013a00: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-00013a10: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
-00013a20: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
-00013a30: 6164 6c69 6e65 5c6e 666f 7220 7468 6520  adline\nfor the 
-00013a40: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00013a50: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00013a60: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00013a70: 636c 6965 6e74 2e64 656c 6574 655f 7374  client.delete_st
-00013a80: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00013a90: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
-00013aa0: 6d65 3d67 726f 7570 5f6e 616d 6531 2c5c  me=group_name1,\
-00013ab0: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
-00013ac0: 3d73 7472 6561 6d5f 6e61 6d65 322c 5c6e  =stream_name2,\n
-00013ad0: 295c 6e60 6060 5c6e 5c6e 2323 2320 5065  )\n```\n\n### Pe
-00013ae0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00013af0: 7074 696f 6e20 636f 6e73 756d 6572 5c6e  ption consumer\n
-00013b00: 5c6e 5468 6520 7265 6164 696e 6720 6f66  \nThe reading of
-00013b10: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
-00013b20: 6273 6372 6970 7469 6f6e 2063 616e 2062  bscription can b
-00013b30: 6520 656e 6361 7073 756c 6174 6564 2069  e encapsulated i
-00013b40: 6e20 6120 2263 6f6e 7375 6d65 7222 2074  n a "consumer" t
-00013b50: 6861 7420 6361 6c6c 735c 6e61 2022 706f  hat calls\na "po
-00013b60: 6c69 6379 2220 6675 6e63 7469 6f6e 2077  licy" function w
-00013b70: 6865 6e20 6120 7265 636f 7264 6564 2065  hen a recorded e
-00013b80: 7665 6e74 2069 7320 7265 6365 6976 6564  vent is received
-00013b90: 2061 6e64 2074 6865 6e20 6175 746f 6d61   and then automa
-00013ba0: 7469 6361 6c6c 7920 6361 6c6c 735c 6e60  tically calls\n`
-00013bb0: 6163 6b28 2960 2069 6620 7468 6520 706f  ack()` if the po
-00013bc0: 6c69 6379 2066 756e 6374 696f 6e20 7265  licy function re
-00013bd0: 7475 726e 7320 6e6f 726d 616c 6c79 2c20  turns normally, 
-00013be0: 616e 6420 606e 6163 6b28 2960 2069 6620  and `nack()` if 
-00013bf0: 6974 2072 6169 7365 7320 616e 2065 7863  it raises an exc
-00013c00: 6570 7469 6f6e 2c5c 6e70 6572 6861 7073  eption,\nperhaps
-00013c10: 2072 6574 7279 696e 6720 7468 6520 6576   retrying the ev
-00013c20: 656e 7420 666f 7220 6120 6365 7274 6169  ent for a certai
-00013c30: 6e20 6e75 6d62 6572 206f 6620 7469 6d65  n number of time
-00013c40: 732c 2061 6e64 2074 6865 6e20 7061 726b  s, and then park
-00013c50: 696e 6720 7468 6520 6576 656e 742e 5c6e  ing the event.\n
-00013c60: 5c6e 5468 6520 7369 6d70 6c65 2065 7861  \nThe simple exa
-00013c70: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-00013c80: 2068 6f77 2074 6869 7320 6d69 6768 7420   how this might 
-00013c90: 6265 2064 6f6e 652e 2057 6520 6361 6e20  be done. We can 
-00013ca0: 7365 6520 7468 6174 205c 2765 7665 6e74  see that \'event
-00013cb0: 3131 5c27 2069 735c 6e61 636b 6e6f 776c  11\' is\nacknowl
-00013cc0: 6564 6765 6420 6265 666f 7265 205c 2765  edged before \'e
-00013cd0: 7665 6e74 355c 2720 6973 2066 696e 616c  vent5\' is final
-00013ce0: 6c79 2070 6172 6b65 642e 5c6e 5c6e 5c6e  ly parked.\n\n\n
-00013cf0: 6060 6070 7974 686f 6e5c 6e61 636b 6564  ```python\nacked
-00013d00: 5f65 7665 6e74 7320 3d20 7b7d 5c6e 6e61  _events = {}\nna
-00013d10: 636b 6564 5f65 7665 6e74 7320 3d20 7b7d  cked_events = {}
-00013d20: 5c6e 5c6e 5c6e 636c 6173 7320 4578 616d  \n\n\nclass Exam
-00013d30: 706c 6543 6f6e 7375 6d65 723a 5c6e 2020  pleConsumer:\n  
-00013d40: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00013d50: 656c 662c 2073 7562 7363 7269 7074 696f  elf, subscriptio
-00013d60: 6e2c 206d 6178 5f72 6574 7269 6573 2c20  n, max_retries, 
-00013d70: 6669 6e61 6c5f 6163 7469 6f6e 293a 5c6e  final_action):\n
-00013d80: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
-00013d90: 7363 7269 7074 696f 6e20 3d20 7375 6273  scription = subs
-00013da0: 6372 6970 7469 6f6e 5c6e 2020 2020 2020  cription\n      
-00013db0: 2020 7365 6c66 2e6d 6178 5f72 6574 7269    self.max_retri
-00013dc0: 6573 203d 206d 6178 5f72 6574 7269 6573  es = max_retries
-00013dd0: 5c6e 2020 2020 2020 2020 7365 6c66 2e66  \n        self.f
-00013de0: 696e 616c 5f61 6374 696f 6e20 3d20 6669  inal_action = fi
-00013df0: 6e61 6c5f 6163 7469 6f6e 5c6e 2020 2020  nal_action\n    
-00013e00: 2020 2020 7365 6c66 2e65 7272 6f72 203d      self.error =
-00013e10: 204e 6f6e 655c 6e5c 6e20 2020 2064 6566   None\n\n    def
-00013e20: 2072 756e 2873 656c 6629 3a5c 6e20 2020   run(self):\n   
-00013e30: 2020 2020 2074 7279 3a5c 6e20 2020 2020       try:\n     
-00013e40: 2020 2020 2020 2066 6f72 2065 7665 6e74         for event
-00013e50: 2069 6e20 7365 6c66 2e73 7562 7363 7269   in self.subscri
-00013e60: 7074 696f 6e3a 5c6e 2020 2020 2020 2020  ption:\n        
-00013e70: 2020 2020 2020 2020 7472 793a 5c6e 2020          try:\n  
-00013e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e90: 2020 7365 6c66 2e70 6f6c 6963 7928 6576    self.policy(ev
-00013ea0: 656e 7429 5c6e 2020 2020 2020 2020 2020  ent)\n          
-00013eb0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00013ec0: 6570 7469 6f6e 3a5c 6e20 2020 2020 2020  eption:\n       
-00013ed0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00013ee0: 6576 656e 742e 7265 7472 795f 636f 756e  event.retry_coun
-00013ef0: 7420 3c20 7365 6c66 2e6d 6178 5f72 6574  t < self.max_ret
-00013f00: 7269 6573 3a5c 6e20 2020 2020 2020 2020  ries:\n         
-00013f10: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00013f20: 6374 696f 6e20 3d20 2272 6574 7279 225c  ction = "retry"\
-00013f30: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
-00013f40: 2020 2020 2065 6c73 653a 5c6e 2020 2020       else:\n    
-00013f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f60: 2020 2020 6163 7469 6f6e 203d 2073 656c      action = sel
-00013f70: 662e 6669 6e61 6c5f 6163 7469 6f6e 5c6e  f.final_action\n
-00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f90: 2020 2020 7365 6c66 2e73 7562 7363 7269      self.subscri
-00013fa0: 7074 696f 6e2e 6e61 636b 2865 7665 6e74  ption.nack(event
-00013fb0: 2e69 642c 2061 6374 696f 6e3d 6163 7469  .id, action=acti
-00013fc0: 6f6e 295c 6e20 2020 2020 2020 2020 2020  on)\n           
-00013fd0: 2020 2020 2020 2020 2073 656c 662e 6166           self.af
-00013fe0: 7465 725f 6e61 636b 2865 7665 6e74 2c20  ter_nack(event, 
-00013ff0: 6163 7469 6f6e 295c 6e20 2020 2020 2020  action)\n       
-00014000: 2020 2020 2020 2020 2065 6c73 653a 5c6e           else:\n
-00014010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014020: 2020 2020 7365 6c66 2e73 7562 7363 7269      self.subscri
-00014030: 7074 696f 6e2e 6163 6b28 6576 656e 742e  ption.ack(event.
-00014040: 6964 295c 6e20 2020 2020 2020 2020 2020  id)\n           
-00014050: 2020 2020 2020 2020 2073 656c 662e 6166           self.af
-00014060: 7465 725f 6163 6b28 6576 656e 7429 5c6e  ter_ack(event)\n
-00014070: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00014080: 7863 6570 7469 6f6e 3a5c 6e20 2020 2020  xception:\n     
-00014090: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
-000140a0: 6372 6970 7469 6f6e 2e73 746f 7028 295c  cription.stop()\
-000140b0: 6e20 2020 2020 2020 2020 2020 2072 6169  n            rai
-000140c0: 7365 5c6e 5c6e 2020 2020 6465 6620 7374  se\n\n    def st
-000140d0: 6f70 2873 656c 6629 3a5c 6e20 2020 2020  op(self):\n     
-000140e0: 2020 2073 656c 662e 7375 6273 6372 6970     self.subscrip
-000140f0: 7469 6f6e 2e73 746f 7028 295c 6e5c 6e20  tion.stop()\n\n 
-00014100: 2020 2064 6566 2070 6f6c 6963 7928 7365     def policy(se
-00014110: 6c66 2c20 6576 656e 7429 3a5c 6e20 2020  lf, event):\n   
-00014120: 2020 2020 2023 2052 6169 7365 2061 6e20       # Raise an 
-00014130: 6578 6365 7074 696f 6e20 7768 656e 2077  exception when w
-00014140: 6520 7365 6520 2265 7665 6e74 3522 2e5c  e see "event5".\
-00014150: 6e20 2020 2020 2020 2069 6620 6576 656e  n        if even
-00014160: 742e 6964 203d 3d20 6576 656e 7435 2e69  t.id == event5.i
-00014170: 643a 5c6e 2020 2020 2020 2020 2020 2020  d:\n            
-00014180: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-00014190: 295c 6e5c 6e20 2020 2064 6566 2061 6674  )\n\n    def aft
-000141a0: 6572 5f61 636b 2873 656c 662c 2065 7665  er_ack(self, eve
-000141b0: 6e74 293a 5c6e 2020 2020 2020 2020 2320  nt):\n        # 
-000141c0: 5472 6163 6b20 7265 7472 7920 636f 756e  Track retry coun
-000141d0: 7420 6f66 2061 636b 6564 2065 7665 6e74  t of acked event
-000141e0: 732e 5c6e 2020 2020 2020 2020 6163 6b65  s.\n        acke
-000141f0: 645f 6576 656e 7473 5b65 7665 6e74 2e69  d_events[event.i
-00014200: 645d 203d 2065 7665 6e74 2e72 6574 7279  d] = event.retry
-00014210: 5f63 6f75 6e74 5c6e 5c6e 2020 2020 6465  _count\n\n    de
-00014220: 6620 6166 7465 725f 6e61 636b 2873 656c  f after_nack(sel
-00014230: 662c 2065 7665 6e74 2c20 6163 7469 6f6e  f, event, action
-00014240: 293a 5c6e 2020 2020 2020 2020 2320 5472  ):\n        # Tr
-00014250: 6163 6b20 7265 7472 7920 636f 756e 7420  ack retry count 
-00014260: 6f66 206e 6163 6b65 6420 6576 656e 7473  of nacked events
-00014270: 2e5c 6e20 2020 2020 2020 206e 6163 6b65  .\n        nacke
-00014280: 645f 6576 656e 7473 5b65 7665 6e74 2e69  d_events[event.i
-00014290: 645d 203d 2065 7665 6e74 2e72 6574 7279  d] = event.retry
-000142a0: 5f63 6f75 6e74 5c6e 5c6e 2020 2020 2020  _count\n\n      
-000142b0: 2020 6966 2061 6374 696f 6e20 3d3d 2073    if action == s
-000142c0: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
-000142d0: 3a5c 6e20 2020 2020 2020 2020 2020 2023  :\n            #
-000142e0: 2053 746f 7020 7468 6520 636f 6e73 756d   Stop the consum
-000142f0: 6572 2c20 736f 2077 6520 6361 6e20 636f  er, so we can co
-00014300: 6e74 696e 7565 2077 6974 6820 7468 6520  ntinue with the 
-00014310: 6578 616d 706c 6573 2e5c 6e20 2020 2020  examples.\n     
-00014320: 2020 2020 2020 2073 656c 662e 7374 6f70         self.stop
-00014330: 2829 5c6e 5c6e 5c6e 2320 4372 6561 7465  ()\n\n\n# Create
-00014340: 2073 7562 7363 7269 7074 696f 6e2e 5c6e   subscription.\n
-00014350: 6772 6f75 705f 6e61 6d65 203d 2066 2267  group_name = f"g
-00014360: 726f 7570 2d7b 7575 6964 3428 297d 225c  roup-{uuid4()}"\
-00014370: 6e63 6c69 656e 742e 6372 6561 7465 5f73  nclient.create_s
-00014380: 7562 7363 7269 7074 696f 6e28 6772 6f75  ubscription(grou
-00014390: 705f 6e61 6d65 2c20 636f 6d6d 6974 5f70  p_name, commit_p
-000143a0: 6f73 6974 696f 6e3d 636f 6d6d 6974 5f70  osition=commit_p
-000143b0: 6f73 6974 696f 6e31 295c 6e5c 6e23 2052  osition1)\n\n# R
-000143c0: 6561 6420 7375 6273 6372 6970 7469 6f6e  ead subscription
-000143d0: 2e5c 6e73 7562 7363 7269 7074 696f 6e20  .\nsubscription 
-000143e0: 3d20 636c 6965 6e74 2e72 6561 645f 7375  = client.read_su
-000143f0: 6273 6372 6970 7469 6f6e 2867 726f 7570  bscription(group
-00014400: 5f6e 616d 6529 5c6e 5c6e 2320 436f 6e73  _name)\n\n# Cons
-00014410: 7472 7563 7420 636f 6e73 756d 6572 2e5c  truct consumer.\
-00014420: 6e63 6f6e 7375 6d65 7220 3d20 4578 616d  nconsumer = Exam
-00014430: 706c 6543 6f6e 7375 6d65 7228 5c6e 2020  pleConsumer(\n  
-00014440: 2020 7375 6273 6372 6970 7469 6f6e 3d73    subscription=s
-00014450: 7562 7363 7269 7074 696f 6e2c 5c6e 2020  ubscription,\n  
-00014460: 2020 6d61 785f 7265 7472 6965 733d 352c    max_retries=5,
-00014470: 5c6e 2020 2020 6669 6e61 6c5f 6163 7469  \n    final_acti
-00014480: 6f6e 3d22 7061 726b 222c 5c6e 295c 6e5c  on="park",\n)\n\
-00014490: 6e23 2052 756e 2063 6f6e 7375 6d65 722e  n# Run consumer.
-000144a0: 5c6e 636f 6e73 756d 6572 2e72 756e 2829  \nconsumer.run()
-000144b0: 5c6e 5c6e 2320 4368 6563 6b20 5c27 6576  \n\n# Check \'ev
-000144c0: 656e 7431 315c 2720 7761 7320 6163 6b65  ent11\' was acke
-000144d0: 6420 616e 6420 6e65 7665 7220 7265 7472  d and never retr
-000144e0: 6965 642e 5c6e 6173 7365 7274 2061 636b  ied.\nassert ack
-000144f0: 6564 5f65 7665 6e74 735b 6576 656e 7431  ed_events[event1
-00014500: 312e 6964 5d20 3d3d 2030 5c6e 6173 7365  1.id] == 0\nasse
-00014510: 7274 2065 7665 6e74 3131 2e69 6420 6e6f  rt event11.id no
-00014520: 7420 696e 206e 6163 6b65 645f 6576 656e  t in nacked_even
-00014530: 7473 5c6e 5c6e 2320 4368 6563 6b20 5c27  ts\n\n# Check \'
-00014540: 6576 656e 7435 5c27 2077 6173 2072 6574  event5\' was ret
-00014550: 7269 6564 2066 6976 6520 7469 6d65 7320  ried five times 
-00014560: 616e 6420 6e65 7665 7220 6163 6b65 642e  and never acked.
-00014570: 5c6e 6173 7365 7274 206e 6163 6b65 645f  \nassert nacked_
-00014580: 6576 656e 7473 5b65 7665 6e74 352e 6964  events[event5.id
-00014590: 5d20 3d3d 2035 5c6e 6173 7365 7274 2065  ] == 5\nassert e
-000145a0: 7665 6e74 352e 6964 206e 6f74 2069 6e20  vent5.id not in 
-000145b0: 6163 6b65 645f 6576 656e 7473 5c6e 6060  acked_events\n``
-000145c0: 605c 6e5c 6e23 2320 436f 6e6e 6563 7469  `\n\n## Connecti
-000145d0: 6f6e 5c6e 5c6e 2323 2320 5265 636f 6e6e  on\n\n### Reconn
-000145e0: 6563 745c 6e5c 6e54 6865 2060 7265 636f  ect\n\nThe `reco
-000145f0: 6e6e 6563 7428 2960 206d 6574 686f 6420  nnect()` method 
-00014600: 6361 6e20 6265 2075 7365 6420 746f 206d  can be used to m
-00014610: 616e 7561 6c6c 7920 7265 636f 6e6e 6563  anually reconnec
-00014620: 7420 7468 6520 636c 6965 6e74 2074 6f20  t the client to 
-00014630: 615c 6e73 7569 7461 626c 6520 4576 656e  a\nsuitable Even
-00014640: 7453 746f 7265 4442 206e 6f64 652e 2054  tStoreDB node. T
-00014650: 6869 7320 6d65 7468 6f64 2075 7365 7320  his method uses 
-00014660: 7468 6520 7361 6d65 2072 6f75 7469 6e65  the same routine
-00014670: 2066 6f72 2072 6561 6469 6e67 2074 6865   for reading the
-00014680: 5c6e 636c 7573 7465 7220 6e6f 6465 2073  \ncluster node s
-00014690: 7461 7465 7320 616e 6420 7468 656e 2063  tates and then c
-000146a0: 6f6e 6e65 6374 696e 6720 746f 2061 2073  onnecting to a s
-000146b0: 7569 7461 626c 6520 6e6f 6465 2061 6363  uitable node acc
-000146c0: 6f72 6469 6e67 2074 6f20 7468 655c 6e63  ording to the\nc
-000146d0: 6c69 656e 745c 2773 206e 6f64 6520 7072  lient\'s node pr
-000146e0: 6566 6572 656e 6365 2074 6861 7420 6973  eference that is
-000146f0: 2073 7065 6369 6669 6564 2069 6e20 7468   specified in th
-00014700: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-00014710: 696e 6720 5552 4920 7768 656e 5c6e 7468  ing URI when\nth
-00014720: 6520 636c 6965 6e74 2069 7320 636f 6e73  e client is cons
-00014730: 7472 7563 7465 642e 2054 6869 7320 6d65  tructed. This me
-00014740: 7468 6f64 2069 7320 7468 7265 6164 2d73  thod is thread-s
-00014750: 6166 652c 2061 6e64 2069 7420 6973 2022  afe, and it is "
-00014760: 636f 6e73 6572 7661 7469 7665 225c 6e69  conservative"\ni
-00014770: 6e20 7468 6174 2c20 7768 656e 2069 7420  n that, when it 
-00014780: 6973 2063 616c 6c65 6420 6279 2073 6576  is called by sev
-00014790: 6572 616c 2074 6872 6561 6473 2061 7420  eral threads at 
-000147a0: 7468 6520 7361 6d65 2074 696d 652c 206f  the same time, o
-000147b0: 6e6c 7920 6f6e 655c 6e72 6563 6f6e 6e65  nly one\nreconne
-000147c0: 6374 696f 6e20 7769 6c6c 206f 6363 7572  ction will occur
-000147d0: 2e20 436f 6e63 7572 7265 6e74 2061 7474  . Concurrent att
-000147e0: 656d 7074 7320 746f 2072 6563 6f6e 6e65  empts to reconne
-000147f0: 6374 2077 696c 6c20 626c 6f63 6b20 756e  ct will block un
-00014800: 7469 6c5c 6e74 6865 2063 6c69 656e 7420  til\nthe client 
-00014810: 6861 7320 7265 636f 6e6e 6563 7465 6420  has reconnected 
-00014820: 7375 6363 6573 7366 756c 6c79 2c20 616e  successfully, an
-00014830: 6420 7468 656e 2074 6865 7920 7769 6c6c  d then they will
-00014840: 2061 6c6c 2072 6574 7572 6e20 6e6f 726d   all return norm
-00014850: 616c 6c79 2e5c 6e5c 6e60 6060 7079 7468  ally.\n\n```pyth
-00014860: 6f6e 5c6e 636c 6965 6e74 2e72 6563 6f6e  on\nclient.recon
-00014870: 6e65 6374 2829 5c6e 6060 605c 6e5c 6e41  nect()\n```\n\nA
-00014880: 6e20 6578 616d 706c 6520 6f66 2077 6865  n example of whe
-00014890: 6e20 6974 206d 6967 6874 2062 6520 6465  n it might be de
-000148a0: 7369 7261 626c 6520 746f 2072 6563 6f6e  sirable to recon
-000148b0: 6e65 6374 206d 616e 7561 6c6c 7920 6973  nect manually is
-000148c0: 2077 6865 6e20 2866 6f72 2070 6572 666f   when (for perfo
-000148d0: 726d 616e 6365 5c6e 7265 6173 6f6e 7329  rmance\nreasons)
-000148e0: 2074 6865 2063 6c69 656e 745c 2773 206e   the client\'s n
-000148f0: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
-00014900: 7320 746f 2062 6520 636f 6e6e 6563 7465  s to be connecte
-00014910: 6420 746f 2061 2066 6f6c 6c6f 7765 7220  d to a follower 
-00014920: 6e6f 6465 2069 6e20 7468 655c 6e63 6c75  node in the\nclu
-00014930: 7374 6572 2c20 616e 642c 2061 6674 6572  ster, and, after
-00014940: 2061 2063 6c75 7374 6572 206c 6561 6465   a cluster leade
-00014950: 7220 656c 6563 7469 6f6e 2c20 7468 6520  r election, the 
-00014960: 666f 6c6c 6f77 6572 2062 6563 6f6d 6573  follower becomes
-00014970: 2074 6865 206c 6561 6465 722e 5c6e 5265   the leader.\nRe
-00014980: 636f 6e6e 6563 7469 6e67 2074 6f20 6120  connecting to a 
-00014990: 666f 6c6c 6f77 6572 206e 6f64 6520 696e  follower node in
-000149a0: 2074 6869 7320 6361 7365 2069 7320 6375   this case is cu
-000149b0: 7272 656e 746c 7920 6265 796f 6e64 2074  rrently beyond t
-000149c0: 6865 2063 6170 6162 696c 6974 6965 7320  he capabilities 
-000149d0: 6f66 5c6e 7468 6973 2063 6c69 656e 742c  of\nthis client,
-000149e0: 2062 7574 2074 6869 7320 6265 6861 7669   but this behavi
-000149f0: 6f72 206d 6967 6874 2062 6520 696d 706c  or might be impl
-00014a00: 656d 656e 7465 6420 696e 2061 2066 7574  emented in a fut
-00014a10: 7572 6520 7265 6c65 6173 652e 5c6e 5c6e  ure release.\n\n
-00014a20: 506c 6561 7365 206e 6f74 652c 206e 6561  Please note, nea
-00014a30: 726c 7920 616c 6c20 7468 6520 636c 6965  rly all the clie
-00014a40: 6e74 206d 6574 686f 6473 2061 7265 2064  nt methods are d
-00014a50: 6563 6f72 6174 6564 2077 6974 6820 6040  ecorated with `@
-00014a60: 6175 746f 7265 636f 6e6e 6563 7460 2028  autoreconnect` (
-00014a70: 7768 6963 685c 6e63 616c 6c73 2074 6865  which\ncalls the
-00014a80: 2060 7265 636f 6e6e 6563 7428 2960 206d   `reconnect()` m
-00014a90: 6574 686f 6420 7768 656e 2074 6865 2063  ethod when the c
-00014aa0: 6c69 656e 7420 6465 7465 6374 7320 7468  lient detects th
-00014ab0: 6174 2072 6563 6f6e 6e65 6374 696e 6720  at reconnecting 
-00014ac0: 6973 2072 6571 7569 7265 6429 5c6e 616e  is required)\nan
-00014ad0: 6420 6120 6040 7265 7472 7960 2064 6563  d a `@retry` dec
-00014ae0: 6f72 6174 6f72 2074 6861 7420 6d6f 7265  orator that more
-00014af0: 2067 656e 6572 616c 6c79 2077 696c 6c20   generally will 
-00014b00: 7265 7472 7920 6f70 6572 6174 696f 6e73  retry operations
-00014b10: 2074 6861 7420 6661 696c 2064 7565 2074   that fail due t
-00014b20: 6f5c 6e63 6f6e 6e65 6374 696f 6e20 6973  o\nconnection is
-00014b30: 7375 6573 2e5c 6e5c 6e54 6865 2060 4061  sues.\n\nThe `@a
-00014b40: 7574 6f72 6563 6f6e 6e65 6374 6020 6465  utoreconnect` de
-00014b50: 636f 7261 746f 7220 7769 6c6c 2072 6563  corator will rec
-00014b60: 6f6e 6e65 6374 2074 6f20 6120 7375 6974  onnect to a suit
-00014b70: 6162 6c65 206e 6f64 6520 696e 2074 6865  able node in the
-00014b80: 2063 6c75 7374 6572 2077 6865 6e5c 6e74   cluster when\nt
-00014b90: 6865 2073 6572 7665 7220 746f 2077 6869  he server to whi
-00014ba0: 6368 2074 6865 2063 6c69 656e 7420 6861  ch the client ha
-00014bb0: 7320 6265 656e 2063 6f6e 6e65 6374 6564  s been connected
-00014bc0: 2068 6173 2062 6563 6f6d 6520 756e 6176   has become unav
-00014bd0: 6169 6c61 626c 652c 206f 7220 7768 656e  ailable, or when
-00014be0: 2074 6865 5c6e 636c 6965 6e74 5c27 7320   the\nclient\'s 
-00014bf0: 6752 5043 2063 6861 6e6e 656c 2068 6170  gRPC channel hap
-00014c00: 7065 6e73 2074 6f20 6861 7665 2062 6565  pens to have bee
-00014c10: 6e20 636c 6f73 6564 2e20 5468 6520 636c  n closed. The cl
-00014c20: 6965 6e74 2077 696c 6c20 616c 736f 2072  ient will also r
-00014c30: 6563 6f6e 6e65 6374 2077 6865 6e5c 6e61  econnect when\na
-00014c40: 206d 6574 686f 6420 6973 2063 616c 6c65   method is calle
-00014c50: 6420 7468 6174 2072 6571 7569 7265 7320  d that requires 
-00014c60: 6120 6c65 6164 6572 2c20 616e 6420 7468  a leader, and th
-00014c70: 6520 636c 6965 6e74 5c27 7320 6e6f 6465  e client\'s node
-00014c80: 2070 7265 6665 7265 6e63 6520 6973 2074   preference is t
-00014c90: 6f20 6265 5c6e 636f 6e6e 6563 7465 6420  o be\nconnected 
-00014ca0: 746f 2061 206c 6561 6465 722c 2062 7574  to a leader, but
-00014cb0: 2074 6865 206e 6f64 6520 7468 6174 2074   the node that t
-00014cc0: 6865 2063 6c69 656e 7420 6861 7320 6265  he client has be
-00014cd0: 656e 2063 6f6e 6e65 6374 6564 2074 6f20  en connected to 
-00014ce0: 7374 6f70 7320 6265 696e 675c 6e74 6865  stops being\nthe
-00014cf0: 206c 6561 6465 722e 2049 6e20 7468 6973   leader. In this
-00014d00: 2063 6173 652c 2074 6865 2063 6c69 656e   case, the clien
-00014d10: 7420 7769 6c6c 2072 6563 6f6e 6e65 6374  t will reconnect
-00014d20: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
-00014d30: 6c65 6164 6572 2e20 4166 7465 725c 6e72  leader. After\nr
-00014d40: 6563 6f6e 6e65 6374 696e 672c 2074 6865  econnecting, the
-00014d50: 2066 6169 6c65 6420 6f70 6572 6174 696f   failed operatio
-00014d60: 6e20 7769 6c6c 2062 6520 7265 7472 6965  n will be retrie
-00014d70: 642e 5c6e 5c6e 5468 6520 6040 7265 7472  d.\n\nThe `@retr
-00014d80: 7960 2064 6563 6f72 6174 6f72 2072 6574  y` decorator ret
-00014d90: 7269 6573 206f 7065 7261 7469 6f6e 7320  ries operations 
-00014da0: 7468 6174 2068 6176 6520 6661 696c 6564  that have failed
-00014db0: 2064 7565 2074 6f20 6d6f 7265 2067 656e   due to more gen
-00014dc0: 6572 616c 5c6e 636f 6e6e 6563 7469 6f6e  eral\nconnection
-00014dd0: 2069 7373 7565 732c 2073 7563 6820 6173   issues, such as
-00014de0: 2061 2064 6561 646c 696e 6520 6265 696e   a deadline bein
-00014df0: 6720 7265 6163 6865 6420 2873 6f20 7468  g reached (so th
-00014e00: 6174 2074 6865 206f 7065 7261 7469 6f6e  at the operation
-00014e10: 2074 696d 6573 5c6e 6f75 7429 2c20 6f72   times\nout), or
-00014e20: 2069 6e20 6361 7365 2074 6865 2073 6572   in case the ser
-00014e30: 7665 7220 7468 726f 7773 2061 6e20 6578  ver throws an ex
-00014e40: 6365 7074 696f 6e20 7768 656e 2068 616e  ception when han
-00014e50: 646c 696e 6720 6120 636c 6965 6e74 2072  dling a client r
-00014e60: 6571 7565 7374 2e5c 6e5c 6e50 6c65 6173  equest.\n\nPleas
-00014e70: 6520 616c 736f 206e 6f74 652c 2074 6865  e also note, the
-00014e80: 2061 7370 6563 7473 206e 6f74 2063 6f76   aspects not cov
-00014e90: 6572 6564 2062 7920 7468 6520 7265 636f  ered by the reco
-00014ea0: 6e6e 6563 7420 616e 6420 7265 7472 7920  nnect and retry 
-00014eb0: 6465 636f 7261 746f 725c 6e62 6568 6176  decorator\nbehav
-00014ec0: 696f 7572 7320 6861 7665 2074 6f20 646f  iours have to do
-00014ed0: 2077 6974 6820 6d65 7468 6f64 7320 7468   with methods th
-00014ee0: 6174 2072 6574 7572 6e20 6974 6572 6174  at return iterat
-00014ef0: 6f72 732e 2046 6f72 2065 7861 6d70 6c65  ors. For example
-00014f00: 2c20 636f 6e73 6964 6572 5c6e 7468 6520  , consider\nthe 
-00014f10: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-00014f20: 2829 6020 6d65 7468 6f64 2c20 7768 6963  ()` method, whic
-00014f30: 6820 7265 7475 726e 7320 616e 2069 7465  h returns an ite
-00014f40: 7261 746f 7220 6f66 2060 5265 636f 7264  rator of `Record
-00014f50: 6564 4576 656e 7460 206f 626a 6563 7473  edEvent` objects
-00014f60: 2e5c 6e54 6865 206d 6574 686f 6420 6861  .\nThe method ha
-00014f70: 7320 7265 7475 726e 6564 2061 6e64 2074  s returned and t
-00014f80: 6865 206d 6574 686f 6420 6465 636f 7261  he method decora
-00014f90: 746f 7273 2068 6176 6520 7468 6572 6566  tors have theref
-00014fa0: 6f72 6520 6578 6974 6564 2062 6566 6f72  ore exited befor
-00014fb0: 6520 7468 655c 6e69 7465 7261 7469 6e67  e the\niterating
-00014fc0: 206f 6620 7468 6520 7265 7370 6f6e 7365   of the response
-00014fd0: 2062 6567 696e 732e 2054 6865 7265 666f   begins. Therefo
-00014fe0: 7265 2c20 6974 2069 736e 5c27 7420 706f  re, it isn\'t po
-00014ff0: 7373 6962 6c65 2066 6f72 2074 6869 7320  ssible for this 
-00015000: 6d65 7468 6f64 2074 6f5c 6e74 7269 6767  method to\ntrigg
-00015010: 6572 2061 2072 6563 6f6e 6e65 6374 696f  er a reconnectio
-00015020: 6e20 6f72 2066 6f72 2069 7420 746f 2072  n or for it to r
-00015030: 6574 7279 2c20 7768 656e 2074 6865 2073  etry, when the s
-00015040: 7472 6561 6d69 6e67 2072 6573 706f 6e73  treaming respons
-00015050: 6520 736f 6d65 686f 7720 6661 696c 732e  e somehow fails.
-00015060: 5c6e 5c6e 416e 6f74 6865 7220 6578 616d  \n\nAnother exam
-00015070: 706c 6520 6973 2074 6865 2022 6361 7463  ple is the "catc
-00015080: 682d 7570 2220 616e 6420 7065 7273 6973  h-up" and persis
-00015090: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-000150a0: 6e20 7265 6164 206d 6574 686f 6473 2c20  n read methods, 
-000150b0: 616c 7468 6f75 6768 5c6e 7769 7468 2074  although\nwith t
-000150c0: 6865 7365 206d 6574 686f 6473 2074 6865  hese methods the
-000150d0: 7265 2069 7320 616e 2069 6e69 7469 616c  re is an initial
-000150e0: 2022 636f 6e66 6972 6d61 7469 6f6e 2220   "confirmation" 
-000150f0: 7265 7370 6f6e 7365 2066 726f 6d20 7468  response from th
-00015100: 6520 7365 7276 6572 2077 6869 6368 5c6e  e server which\n
-00015110: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
-00015120: 6368 6563 6b65 6420 6279 2074 6865 2063  checked by the c
-00015130: 6c69 656e 7420 6265 666f 7265 2074 6865  lient before the
-00015140: 206d 6574 686f 6420 7265 7475 726e 732c   method returns,
-00015150: 2073 6f20 6966 2074 6865 2073 6572 7665   so if the serve
-00015160: 7220 6973 5c6e 756e 6176 6169 6c61 626c  r is\nunavailabl
-00015170: 6520 7768 656e 2074 6865 2063 616c 6c20  e when the call 
-00015180: 6973 206d 6164 652c 206f 7220 6966 2074  is made, or if t
-00015190: 6865 2063 6861 6e6e 656c 2069 7320 736f  he channel is so
-000151a0: 6d65 686f 7720 636c 6f73 6564 2c20 6f72  mehow closed, or
-000151b0: 2069 6620 7468 655c 6e73 6572 7665 7220   if the\nserver 
-000151c0: 7468 726f 7773 2061 6e20 6572 726f 7220  throws an error 
-000151d0: 666f 7220 736f 6d65 2072 6561 736f 6e2c  for some reason,
-000151e0: 2074 6865 6e20 7468 6520 636c 6965 6e74   then the client
-000151f0: 2077 696c 6c20 6569 7468 6572 2072 6563   will either rec
-00015200: 6f6e 6e65 6374 2061 6e64 5c6e 7265 7472  onnect and\nretr
-00015210: 792c 206f 7220 6d6f 7265 2073 696d 706c  y, or more simpl
-00015220: 7920 6a75 7374 2072 6574 7279 2074 6865  y just retry the
-00015230: 206f 7065 7261 7469 6f6e 2c20 6163 636f   operation, acco
-00015240: 7264 696e 6720 7468 6520 7479 7065 206f  rding the type o
-00015250: 6620 6572 726f 7220 7468 6174 5c6e 7761  f error that\nwa
-00015260: 7320 656e 636f 756e 7465 7265 642e 2048  s encountered. H
-00015270: 6f77 6576 6572 2c20 616e 2065 7665 6e74  owever, an event
-00015280: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-00015290: 6f6e 656e 7420 7468 6174 2069 7465 7261  onent that itera
-000152a0: 7465 7320 6f76 6572 2061 5c6e 7375 6363  tes over a\nsucc
-000152b0: 6573 7366 756c 6c79 2072 6574 7572 6e65  essfully returne
-000152c0: 6420 2263 6174 6368 2d75 7022 2073 7562  d "catch-up" sub
-000152d0: 7363 7269 7074 696f 6e20 7265 7370 6f6e  scription respon
-000152e0: 7365 2077 696c 6c20 6e65 6564 2074 6f20  se will need to 
-000152f0: 6265 206d 6f6e 6974 6f72 6564 2066 6f72  be monitored for
-00015300: 5c6e 6572 726f 7273 2c20 616e 642c 2069  \nerrors, and, i
-00015310: 6620 6974 2066 6169 6c73 2061 6674 6572  f it fails after
-00015320: 2069 7420 6861 7320 7374 6172 7465 6420   it has started 
-00015330: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
-00015340: 6865 2072 6573 706f 6e73 652c 2074 6865  he response, the
-00015350: 2063 6174 6368 2d75 705c 6e73 7562 7363   catch-up\nsubsc
-00015360: 7269 7074 696f 6e20 7769 6c6c 206e 6565  ription will nee
-00015370: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
-00015380: 6420 6672 6f6d 2074 6865 2065 7665 6e74  d from the event
-00015390: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-000153a0: 6f6e 656e 745c 2773 2022 6c61 7374 5c6e  onent\'s "last\n
-000153b0: 7361 7665 6420 636f 6d6d 6974 2070 6f73  saved commit pos
-000153c0: 6974 696f 6e22 2e20 4966 2074 6865 2065  ition". If the e
-000153d0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
-000153e0: 636f 6d70 6f6e 656e 7420 6973 2072 6563  component is rec
-000153f0: 6f72 6469 6e67 2074 6865 2063 6f6d 6d69  ording the commi
-00015400: 745c 6e70 6f73 6974 696f 6e20 6f66 2065  t\nposition of e
-00015410: 6163 6820 7265 636f 7264 6564 2065 7665  ach recorded eve
-00015420: 6e74 2061 746f 6d69 6361 6c6c 7920 616c  nt atomically al
-00015430: 6f6e 6720 7769 7468 2061 6e79 206e 6577  ong with any new
-00015440: 2073 7461 7465 2074 6861 7420 7265 7375   state that resu
-00015450: 6c74 7320 6672 6f6d 5c6e 7072 6f63 6573  lts from\nproces
-00015460: 7369 6e67 2074 6865 2072 6563 6f72 6465  sing the recorde
-00015470: 6420 6576 656e 7473 2c20 616e 6420 7468  d events, and th
-00015480: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00015490: 6e73 2061 7265 2072 6563 6f72 6465 6420  ns are recorded 
-000154a0: 7769 7468 2061 2075 6e69 7175 656e 6573  with a uniquenes
-000154b0: 735c 6e63 6f6e 7374 7261 696e 742c 2074  s\nconstraint, t
-000154c0: 6865 6e20 7468 6572 6520 7769 6c6c 206e  hen there will n
-000154d0: 6f20 6461 6e67 6572 2074 6f20 7468 6520  o danger to the 
-000154e0: 7072 6f6a 6563 7465 6420 7374 6174 6520  projected state 
-000154f0: 6265 636f 6d69 6e67 2069 6e63 6f6e 7369  becoming inconsi
-00015500: 7374 656e 7420 6475 655c 6e74 6f20 7468  stent due\nto th
-00015510: 6573 6520 636f 6e6e 6563 7469 6f6e 2069  ese connection i
-00015520: 7373 7565 732e 2049 6e20 7468 6973 2063  ssues. In this c
-00015530: 6173 652c 2074 6865 2063 6c69 656e 7420  ase, the client 
-00015540: 7769 6c6c 2061 7574 6f6d 6174 6963 616c  will automatical
-00015550: 6c79 2072 6563 6f6e 6e65 6374 2074 6f20  ly reconnect to 
-00015560: 615c 6e6e 6f64 6520 696e 2074 6865 2063  a\nnode in the c
-00015570: 6c75 7374 6572 2077 6865 6e20 7468 6520  luster when the 
-00015580: 7375 6273 6571 7565 6e74 2063 616c 6c20  subsequent call 
-00015590: 746f 2061 2063 6174 6368 2d75 7020 7375  to a catch-up su
-000155a0: 6273 6372 6970 7469 6f6e 206d 6574 686f  bscription metho
-000155b0: 6420 6973 206d 6164 652e 5c6e 596f 7520  d is made.\nYou 
-000155c0: 6a75 7374 206e 6565 6420 746f 2068 616e  just need to han
-000155d0: 646c 6520 7468 6520 6578 6365 7074 696f  dle the exceptio
-000155e0: 6e20 7468 6174 206f 6363 7572 7320 6672  n that occurs fr
-000155f0: 6f6d 2074 6865 2069 7465 7261 746f 722c  om the iterator,
-00015600: 2074 6865 6e20 7265 6164 2079 6f75 7220   then read your 
-00015610: 6c61 7374 5c6e 7361 7665 6420 636f 6d6d  last\nsaved comm
-00015620: 6974 2070 6f73 6974 696f 6e2c 2061 6e64  it position, and
-00015630: 2074 6865 6e20 7265 7374 6172 7420 796f   then restart yo
-00015640: 7572 2065 7665 6e74 2d70 726f 6365 7373  ur event-process
-00015650: 696e 6720 636f 6d70 6f6e 656e 742c 2075  ing component, u
-00015660: 7369 6e67 2074 6865 2073 616d 655c 6e63  sing the same\nc
-00015670: 6c69 656e 7420 6f62 6a65 6374 2e20 5468  lient object. Th
-00015680: 6520 636c 6965 6e74 2077 696c 6c20 7265  e client will re
-00015690: 636f 6e6e 6563 7420 6966 2074 6865 7265  connect if there
-000156a0: 2069 7320 6120 6e65 6564 2074 6f20 646f   is a need to do
-000156b0: 2073 6f20 7768 656e 2074 6865 2073 7562   so when the sub
-000156c0: 7365 7175 656e 745c 6e63 616c 6c20 6973  sequent\ncall is
-000156d0: 206d 6164 652e 2053 696d 696c 6172 6c79   made. Similarly
-000156e0: 2c20 7768 656e 2072 6561 6469 6e67 2070  , when reading p
-000156f0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00015700: 6970 7469 6f6e 732c 2069 6620 7468 6572  iptions, if ther
-00015710: 6520 6172 655c 6e63 6f6e 6e65 6374 6976  e are\nconnectiv
-00015720: 6974 7920 6973 7375 6573 2061 6674 6572  ity issues after
-00015730: 2079 6f75 2068 6176 6520 7374 6172 7465   you have starte
-00015740: 6420 6974 6572 6174 696e 6720 6f76 6572  d iterating over
-00015750: 2061 2073 7563 6365 7373 6675 6c6c 7920   a successfully 
-00015760: 7265 6365 6976 6564 5c6e 7265 7370 6f6e  received\nrespon
-00015770: 7365 2c20 7468 656e 2074 6865 2073 6572  se, then the ser
-00015780: 7665 7220 6361 6c6c 2077 696c 6c20 6e65  ver call will ne
-00015790: 6564 2074 6f20 6265 2072 6573 7461 7274  ed to be restart
-000157a0: 6564 2e20 496e 2074 6869 7320 6361 7365  ed. In this case
-000157b0: 2c20 7468 6520 7265 6365 6976 6564 5c6e  , the received\n
-000157c0: 6576 656e 7473 2077 696c 6c20 7374 6172  events will star
-000157d0: 7420 7769 7468 2074 6865 206c 6173 7420  t with the last 
-000157e0: 7361 7665 6420 6368 6563 6b70 6f69 6e74  saved checkpoint
-000157f0: 206f 6e20 7468 6520 7365 7276 6572 2028   on the server (
-00015800: 706f 7465 6e74 6961 6c6c 7920 7265 7475  potentially retu
-00015810: 726e 696e 675c 6e65 7665 6e74 7320 7468  rning\nevents th
-00015820: 6174 2077 6572 6520 696e 2066 6163 7420  at were in fact 
-00015830: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-00015840: 6365 7373 6564 292e 5c6e 5c6e 5c6e 2323  cessed).\n\n\n##
-00015850: 2320 436c 6f73 655c 6e5c 6e54 6865 2060  # Close\n\nThe `
-00015860: 636c 6f73 6528 2960 206d 6574 686f 6420  close()` method 
-00015870: 6361 6e20 6265 2075 7365 6420 746f 2063  can be used to c
-00015880: 6c65 616e 6c79 2063 6c6f 7365 2074 6865  leanly close the
-00015890: 2067 5250 4320 636f 6e6e 6563 7469 6f6e   gRPC connection
-000158a0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-000158b0: 636c 6965 6e74 2e63 6c6f 7365 2829 5c6e  client.close()\n
-000158c0: 6060 605c 6e5c 6e23 2320 4e6f 7465 735c  ```\n\n## Notes\
-000158d0: 6e5c 6e23 2323 2043 6f6e 6e65 6374 696f  n\n### Connectio
-000158e0: 6e20 7374 7269 6e67 735c 6e5c 6e54 6865  n strings\n\nThe
-000158f0: 2045 7665 6e74 5374 6f72 6544 4220 636f   EventStoreDB co
-00015900: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
-00015910: 6973 2061 2055 5249 2074 6861 7420 636f  is a URI that co
-00015920: 6e66 6f72 6d73 2077 6974 6820 6f6e 6520  nforms with one 
-00015930: 6f66 2074 776f 2070 6f73 7369 626c 655c  of two possible\
-00015940: 6e73 6368 656d 6573 2c20 6569 7468 6572  nschemes, either
-00015950: 2074 6865 2022 6573 6462 2220 7363 6865   the "esdb" sche
-00015960: 6d65 206f 7220 7468 6520 2265 7364 622b  me or the "esdb+
-00015970: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
-00015980: 2e20 5468 6520 7379 6e74 6178 2061 6e64  . The syntax and
-00015990: 5c6e 7365 6d61 6e74 6963 7320 6f66 2074  \nsemantics of t
-000159a0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-000159b0: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
-000159c0: 6578 706c 6169 6e65 6420 6265 6c6f 772e  explained below.
-000159d0: 2054 6865 2073 796e 7461 7820 6973 5c6e   The syntax is\n
-000159e0: 6465 6669 6e65 6420 7573 696e 6720 5b45  defined using [E
-000159f0: 424e 465d 2868 7474 7073 3a2f 2f65 6e2e  BNF](https://en.
-00015a00: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00015a10: 6b69 2f45 7874 656e 6465 645f 4261 636b  ki/Extended_Back
-00015a20: 7573 e280 934e 6175 725f 666f 726d 292e  us...Naur_form).
-00015a30: 5c6e 5c6e 5468 6520 2265 7364 6222 2055  \n\nThe "esdb" U
-00015a40: 5249 2073 6368 656d 6520 6361 6e20 6265  RI scheme can be
-00015a50: 2064 6566 696e 6564 2069 6e20 7468 6520   defined in the 
-00015a60: 666f 6c6c 6f77 696e 6720 7761 792e 5c6e  following way.\n
-00015a70: 5c6e 2020 2020 6573 6462 2d75 7269 203d  \n    esdb-uri =
-00015a80: 2022 6573 6462 3a2f 2f22 202c 205b 2075   "esdb://" , [ u
-00015a90: 7365 722d 696e 666f 202c 2022 4022 205d  ser-info , "@" ]
-00015aa0: 202c 2067 7270 632d 7461 7267 6574 2c20   , grpc-target, 
-00015ab0: 7b20 222c 2220 2c20 6772 7063 2d74 6172  { "," , grpc-tar
-00015ac0: 6765 7420 7d20 2c20 5b20 223f 2220 2c20  get } , [ "?" , 
-00015ad0: 7175 6572 792d 7374 7269 6e67 205d 203b  query-string ] ;
-00015ae0: 5c6e 5c6e 496e 2074 6865 2022 6573 6462  \n\nIn the "esdb
-00015af0: 2220 5552 4920 7363 6865 6d65 2c20 6166  " URI scheme, af
-00015b00: 7465 7220 7468 6520 6f70 7469 6f6e 616c  ter the optional
-00015b10: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
-00015b20: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
-00015b30: 2061 7420 6c65 6173 745c 6e6f 6e65 2067   at least\none g
-00015b40: 5250 4320 7461 7267 6574 2e20 4966 2074  RPC target. If t
-00015b50: 6865 7265 2061 7265 2073 6576 6572 616c  here are several
-00015b60: 2067 5250 4320 7461 7267 6574 732c 2074   gRPC targets, t
-00015b70: 6865 7920 6d75 7374 2062 6520 7365 7061  hey must be sepa
-00015b80: 7261 7465 6420 6672 6f6d 2065 6163 685c  rated from each\
-00015b90: 6e6f 7468 6572 2077 6974 6820 7468 6520  nother with the 
-00015ba0: 222c 2220 6368 6172 6163 7465 722e 2045  "," character. E
-00015bb0: 6163 6820 6752 5043 2074 6172 6765 7420  ach gRPC target 
-00015bc0: 7368 6f75 6c64 2069 6e64 6963 6174 6520  should indicate 
-00015bd0: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
-00015be0: 6752 5043 5c6e 7365 7276 6572 2073 6f63  gRPC\nserver soc
-00015bf0: 6b65 742c 2062 7920 7370 6563 6966 7969  ket, by specifyi
-00015c00: 6e67 2061 2068 6f73 7420 616e 6420 6120  ng a host and a 
-00015c10: 706f 7274 206e 756d 6265 7220 7365 7061  port number sepa
-00015c20: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
-00015c30: 3a22 2063 6861 7261 6374 6572 2e5c 6e54  :" character.\nT
-00015c40: 6865 2068 6f73 7420 6d61 7920 6265 2061  he host may be a
-00015c50: 2068 6f73 746e 616d 6520 7468 6174 2063   hostname that c
-00015c60: 616e 2062 6520 7265 736f 6c76 6564 2074  an be resolved t
-00015c70: 6f20 616e 2049 5020 6164 6472 6573 732c  o an IP address,
-00015c80: 206f 7220 616e 2049 5020 6164 6472 6573   or an IP addres
-00015c90: 732e 5c6e 5c6e 2020 2020 6772 7063 2d74  s.\n\n    grpc-t
-00015ca0: 6172 6765 7420 3d20 2820 686f 7374 6e61  arget = ( hostna
-00015cb0: 6d65 207c 2069 702d 6164 6472 6573 7320  me | ip-address 
-00015cc0: 2920 2c20 223a 2220 2c20 706f 7274 2d6e  ) , ":" , port-n
-00015cd0: 756d 6265 7220 3b5c 6e5c 6e5c 6e54 6865  umber ;\n\n\nThe
-00015ce0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-00015cf0: 2055 5249 2073 6368 656d 6520 6361 6e20   URI scheme can 
-00015d00: 6265 2064 6566 696e 6564 2069 6e20 7468  be defined in th
-00015d10: 6520 666f 6c6c 6f77 696e 6720 7761 792e  e following way.
-00015d20: 5c6e 5c6e 2020 2020 6573 6462 2d64 6973  \n\n    esdb-dis
-00015d30: 636f 7665 722d 7572 6920 3d20 2265 7364  cover-uri = "esd
-00015d40: 622b 6469 7363 6f76 6572 3a2f 2f22 202c  b+discover://" ,
-00015d50: 205b 2075 7365 722d 696e 666f 2c20 2240   [ user-info, "@
-00015d60: 2220 5d20 2c20 636c 7573 7465 722d 646f  " ] , cluster-do
-00015d70: 6d61 696e 6e61 6d65 202c 205b 2022 3f22  mainname , [ "?"
-00015d80: 202c 2071 7565 7279 2d73 7472 696e 6720   , query-string 
-00015d90: 5d20 3b5c 6e5c 6e49 6e20 7468 6520 2265  ] ;\n\nIn the "e
-00015da0: 7364 622b 6469 7363 6f76 6572 2220 5552  sdb+discover" UR
-00015db0: 4920 7363 6865 6d65 2c20 6166 7465 7220  I scheme, after 
-00015dc0: 7468 6520 7573 6572 2069 6e66 6f20 7374  the user info st
-00015dd0: 7269 6e67 2c20 7468 6572 6520 6d75 7374  ring, there must
-00015de0: 2062 6520 6120 646f 6d61 696e 5c6e 6e61   be a domain\nna
-00015df0: 6d65 2077 6869 6368 2073 686f 756c 6420  me which should 
-00015e00: 6964 656e 7469 6679 2061 2063 6c75 7374  identify a clust
-00015e10: 6572 206f 6620 4576 656e 7453 746f 7265  er of EventStore
-00015e20: 4442 2073 6572 7665 7273 2e20 5468 6520  DB servers. The 
-00015e30: 636c 6965 6e74 2077 696c 6c20 7573 6520  client will use 
-00015e40: 6120 444e 535c 6e73 6572 7665 7220 746f  a DNS\nserver to
-00015e50: 2072 6573 6f6c 7665 2074 6865 2064 6f6d   resolve the dom
-00015e60: 6169 6e20 6e61 6d65 2074 6f20 6120 6c69  ain name to a li
-00015e70: 7374 206f 6620 6164 6472 6573 7365 7320  st of addresses 
-00015e80: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
-00015e90: 7365 7276 6572 732c 5c6e 6279 2071 7565  servers,\nby que
-00015ea0: 7279 696e 6720 666f 7220 5c27 415c 2720  rying for \'A\' 
-00015eb0: 7265 636f 7264 732e 2049 6e20 7468 6973  records. In this
-00015ec0: 2063 6173 652c 2074 6865 2070 6f72 7420   case, the port 
-00015ed0: 6e75 6d62 6572 2022 3231 3133 2220 7769  number "2113" wi
-00015ee0: 6c6c 2062 6520 7573 6564 2074 6f5c 6e63  ll be used to\nc
-00015ef0: 6f6e 7374 7275 6374 2067 5250 4320 7461  onstruct gRPC ta
-00015f00: 7267 6574 7320 6672 6f6d 2074 6865 2061  rgets from the a
-00015f10: 6464 7265 7373 6573 206f 6274 6169 6e65  ddresses obtaine
-00015f20: 6420 6672 6f6d 205c 2741 5c27 2072 6563  d from \'A\' rec
-00015f30: 6f72 6473 2070 726f 7669 6465 6420 6279  ords provided by
-00015f40: 2074 6865 5c6e 444e 5320 7365 7276 6572   the\nDNS server
-00015f50: 2e20 5468 6572 6566 6f72 652c 2069 6620  . Therefore, if 
-00015f60: 796f 7520 7761 6e74 2074 6f20 7573 6520  you want to use 
-00015f70: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
-00015f80: 6572 2220 5552 4920 7363 6865 6d65 2c20  er" URI scheme, 
-00015f90: 796f 7520 7769 6c6c 5c6e 6e65 6564 2074  you will\nneed t
-00015fa0: 6f20 636f 6e66 6967 7572 6520 444e 5320  o configure DNS 
-00015fb0: 7768 656e 2073 6574 7469 6e67 2075 7020  when setting up 
-00015fc0: 796f 7572 2045 7665 6e74 5374 6f72 6544  your EventStoreD
-00015fd0: 4220 636c 7573 7465 722e 5c6e 5c6e 5769  B cluster.\n\nWi
-00015fe0: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
-00015ff0: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
-00016000: 6f63 7665 7222 2055 5249 2073 6368 656d  ocver" URI schem
-00016010: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
-00016020: 6972 7374 6c79 206f 6274 6169 6e73 5c6e  irstly obtains\n
-00016030: 6120 6c69 7374 206f 6620 6752 5043 2074  a list of gRPC t
-00016040: 6172 6765 7473 3a20 6569 7468 6572 2064  argets: either d
-00016050: 6972 6563 746c 7920 6672 6f6d 2022 6573  irectly from "es
-00016060: 6462 2220 636f 6e6e 6563 7469 6f6e 2073  db" connection s
-00016070: 7472 696e 6773 3b20 6f72 2069 6e64 6972  trings; or indir
-00016080: 6563 746c 795c 6e66 726f 6d20 2265 7364  ectly\nfrom "esd
-00016090: 622b 6469 7363 6f76 6572 2220 636f 6e6e  b+discover" conn
-000160a0: 6563 7469 6f6e 2073 7472 696e 6773 2076  ection strings v
-000160b0: 6961 2044 4e53 2e20 5468 6973 206c 6973  ia DNS. This lis
-000160c0: 7420 6f66 2074 6172 6765 7473 2069 7320  t of targets is 
-000160d0: 6b6e 6f77 6e20 6173 2074 6865 5c6e 2267  known as the\n"g
-000160e0: 6f73 7369 7020 7365 6564 222e 2054 6865  ossip seed". The
-000160f0: 2063 6c69 656e 7420 7769 6c6c 2074 6865   client will the
-00016100: 6e20 6174 7465 6d70 7420 746f 2063 6f6e  n attempt to con
-00016110: 6e65 6374 2074 6f20 6561 6368 2067 5250  nect to each gRP
-00016120: 4320 7461 7267 6574 2069 6e20 7475 726e  C target in turn
-00016130: 2c5c 6e61 7474 656d 7074 696e 6720 746f  ,\nattempting to
-00016140: 2063 616c 6c20 7468 6520 4576 656e 7453   call the EventS
-00016150: 746f 7265 4442 2047 6f73 7369 7020 4150  toreDB Gossip AP
-00016160: 4920 746f 206f 6274 6169 6e20 696e 666f  I to obtain info
-00016170: 726d 6174 696f 6e20 6162 6f75 7420 7468  rmation about th
-00016180: 655c 6e45 7665 6e74 5374 6f72 6544 4220  e\nEventStoreDB 
-00016190: 636c 7573 7465 722e 2041 206d 656d 6265  cluster. A membe
-000161a0: 7220 6f66 2074 6865 2063 6c75 7374 6572  r of the cluster
-000161b0: 2069 7320 7365 6c65 6374 6564 2062 7920   is selected by 
-000161c0: 7468 6520 636c 6965 6e74 2c20 6163 636f  the client, acco
-000161d0: 7264 696e 675c 6e74 6f20 7468 6520 226e  rding\nto the "n
-000161e0: 6f64 6520 7072 6566 6572 656e 6365 2220  ode preference" 
-000161f0: 6f70 7469 6f6e 2e20 5468 6520 636c 6965  option. The clie
-00016200: 6e74 206d 6179 2074 6865 6e20 6e65 6564  nt may then need
-00016210: 2074 6f20 636c 6f73 6520 6974 735c 6e63   to close its\nc
-00016220: 6f6e 6e65 6374 696f 6e20 616e 6420 7265  onnection and re
-00016230: 636f 6e6e 6563 7420 746f 2074 6865 2073  connect to the s
-00016240: 656c 6563 7465 6420 7365 7276 6572 2e5c  elected server.\
-00016250: 6e5c 6e49 6e20 626f 7468 2074 6865 2022  n\nIn both the "
-00016260: 6573 6462 2220 616e 6420 2265 7364 622b  esdb" and "esdb+
-00016270: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
-00016280: 732c 2074 6865 2055 5249 206d 6179 2069  s, the URI may i
-00016290: 6e63 6c75 6465 2061 2075 7365 7220 696e  nclude a user in
-000162a0: 666f 2073 7472 696e 672e 5c6e 4966 2069  fo string.\nIf i
-000162b0: 7420 6578 6973 7473 2069 6e20 7468 6520  t exists in the 
-000162c0: 5552 492c 2074 6865 2075 7365 7220 696e  URI, the user in
-000162d0: 666f 2073 7472 696e 6720 6d75 7374 2062  fo string must b
-000162e0: 6520 7365 7061 7261 7465 6420 6672 6f6d  e separated from
-000162f0: 2074 6865 2072 6573 7420 6f66 2074 6865   the rest of the
-00016300: 2055 5249 5c6e 7769 7468 2074 6865 2022   URI\nwith the "
-00016310: 4022 2063 6861 7261 6374 6572 2e20 5468  @" character. Th
-00016320: 6520 7573 6572 2069 6e66 6f20 7374 7269  e user info stri
-00016330: 6e67 206d 7573 7420 696e 636c 7564 6520  ng must include 
-00016340: 6120 7573 6572 6e61 6d65 2061 6e64 2061  a username and a
-00016350: 2070 6173 7377 6f72 642c 5c6e 7365 7061   password,\nsepa
-00016360: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
-00016370: 3a22 2063 6861 7261 6374 6572 2e5c 6e5c  :" character.\n\
-00016380: 6e20 2020 2075 7365 722d 696e 666f 203d  n    user-info =
-00016390: 2075 7365 726e 616d 6520 2c20 223a 2220   username , ":" 
-000163a0: 2c20 7061 7373 776f 7264 203b 5c6e 5c6e  , password ;\n\n
-000163b0: 5468 6520 7573 6572 2069 6e66 6f20 6973  The user info is
-000163c0: 2073 656e 7420 6279 2074 6865 2063 6c69   sent by the cli
-000163d0: 656e 7420 6173 2022 6361 6c6c 2063 7265  ent as "call cre
-000163e0: 6465 6e74 6961 6c73 2220 696e 2065 6163  dentials" in eac
-000163f0: 6820 6361 6c6c 2074 6f20 6120 2273 6563  h call to a "sec
-00016400: 7572 6522 5c6e 7365 7276 6572 2c20 696e  ure"\nserver, in
-00016410: 2061 2022 6261 7369 6320 6175 7468 2220   a "basic auth" 
-00016420: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
-00016430: 6164 6572 2e20 5468 6973 2061 7574 686f  ader. This autho
-00016440: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
-00016450: 6973 2075 7365 6420 6279 5c6e 7468 6520  is used by\nthe 
-00016460: 7365 7276 6572 2074 6f20 6175 7468 656e  server to authen
-00016470: 7469 6361 7465 2074 6865 2063 6c69 656e  ticate the clien
-00016480: 742e 2054 6865 2061 7574 686f 7269 7a61  t. The authoriza
-00016490: 7469 6f6e 2068 6561 6465 7220 6973 206e  tion header is n
-000164a0: 6f74 2073 656e 7420 746f 5c6e 2269 6e73  ot sent to\n"ins
-000164b0: 6563 7572 6522 2073 6572 7665 7273 2e5c  ecure" servers.\
-000164c0: 6e5c 6e49 6e20 626f 7468 2074 6865 2022  n\nIn both the "
-000164d0: 6573 6462 2220 616e 6420 2265 7364 622b  esdb" and "esdb+
-000164e0: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
-000164f0: 732c 2074 6865 206f 7074 696f 6e61 6c20  s, the optional 
-00016500: 7175 6572 7920 7374 7269 6e67 206d 7573  query string mus
-00016510: 7420 6265 206f 6e65 5c6e 6f72 206d 616e  t be one\nor man
-00016520: 7920 6669 656c 642d 7661 6c75 6520 6172  y field-value ar
-00016530: 6775 6d65 6e74 732c 2073 6570 6172 6174  guments, separat
-00016540: 6564 2066 726f 6d20 6561 6368 206f 7468  ed from each oth
-00016550: 6572 2077 6974 6820 7468 6520 2226 2220  er with the "&" 
-00016560: 6368 6172 6163 7465 722e 5c6e 5c6e 2020  character.\n\n  
-00016570: 2020 7175 6572 792d 7374 7269 6e67 203d    query-string =
-00016580: 2066 6965 6c64 2d76 616c 7565 2c20 7b20   field-value, { 
-00016590: 2226 222c 2066 6965 6c64 2d76 616c 7565  "&", field-value
-000165a0: 207d 203b 5c6e 5c6e 4561 6368 2066 6965   } ;\n\nEach fie
-000165b0: 6c64 2d76 616c 7565 2061 7267 756d 656e  ld-value argumen
-000165c0: 7420 6d75 7374 2062 6520 6f6e 6520 6f66  t must be one of
-000165d0: 2074 6865 2073 7570 706f 7274 6564 2066   the supported f
-000165e0: 6965 6c64 732c 2061 6e64 2061 6e5c 6e61  ields, and an\na
-000165f0: 7070 726f 7072 6961 7465 2076 616c 7565  ppropriate value
-00016600: 2c20 7365 7061 7261 7465 6420 7769 7468  , separated with
-00016610: 2074 6865 2022 3d22 2063 6861 7261 6374   the "=" charact
-00016620: 6572 2e5c 6e5c 6e20 2020 2066 6965 6c64  er.\n\n    field
-00016630: 2d76 616c 7565 203d 2028 2022 546c 7322  -value = ( "Tls"
-00016640: 2c20 223d 2220 2c20 2274 7275 6522 207c  , "=" , "true" |
-00016650: 2022 6661 6c73 6522 2029 5c6e 2020 2020   "false" )\n    
-00016660: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00016670: 2254 6c73 5665 7269 6679 4365 7274 222c  "TlsVerifyCert",
-00016680: 2022 3d22 202c 2022 7472 7565 2220 7c20   "=" , "true" | 
-00016690: 2266 616c 7365 2220 295c 6e20 2020 2020  "false" )\n     
-000166a0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-000166b0: 436f 6e6e 6563 7469 6f6e 4e61 6d65 222c  ConnectionName",
-000166c0: 2022 3d22 202c 2073 7472 696e 6720 295c   "=" , string )\
-000166d0: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
-000166e0: 207c 2028 2022 4e6f 6465 5072 6566 6572   | ( "NodePrefer
-000166f0: 656e 6365 222c 2022 3d22 202c 2022 6c65  ence", "=" , "le
-00016700: 6164 6572 2220 7c20 2266 6f6c 6c6f 7765  ader" | "followe
-00016710: 7222 207c 2022 7265 6164 6f6e 6c79 7265  r" | "readonlyre
-00016720: 706c 6963 6122 207c 2022 7261 6e64 6f6d  plica" | "random
-00016730: 2220 295c 6e20 2020 2020 2020 2020 2020  " )\n           
-00016740: 2020 2020 207c 2028 2022 4465 6661 756c       | ( "Defaul
-00016750: 7444 6561 646c 696e 6522 2c20 223d 2220  tDeadline", "=" 
-00016760: 2c20 696e 7465 6765 7220 295c 6e20 2020  , integer )\n   
-00016770: 2020 2020 2020 2020 2020 2020 207c 2028               | (
-00016780: 2022 476f 7373 6970 5469 6d65 6f75 7422   "GossipTimeout"
-00016790: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
-000167a0: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
-000167b0: 2020 207c 2028 2022 4d61 7844 6973 636f     | ( "MaxDisco
-000167c0: 7665 7241 7474 656d 7074 7322 2c20 223d  verAttempts", "=
-000167d0: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
-000167e0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000167f0: 2028 2022 4469 7363 6f76 6572 7949 6e74   ( "DiscoveryInt
-00016800: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
-00016810: 7465 6765 7220 295c 6e20 2020 2020 2020  teger )\n       
-00016820: 2020 2020 2020 2020 207c 2028 2022 4d61           | ( "Ma
-00016830: 7844 6973 636f 7665 7241 7474 656d 7074  xDiscoverAttempt
-00016840: 7322 2c20 223d 2220 2c20 696e 7465 6765  s", "=" , intege
-00016850: 7220 295c 6e20 2020 2020 2020 2020 2020  r )\n           
-00016860: 2020 2020 207c 2028 2022 4b65 6570 416c       | ( "KeepAl
-00016870: 6976 6549 6e74 6572 7661 6c22 2c20 223d  iveInterval", "=
-00016880: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
-00016890: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000168a0: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
-000168b0: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
-000168c0: 7465 6765 7220 2920 3b5c 6e5c 6e54 6865  teger ) ;\n\nThe
-000168d0: 2074 6162 6c65 2062 656c 6f77 2064 6573   table below des
-000168e0: 6372 6962 6573 2074 6865 2071 7565 7279  cribes the query
-000168f0: 2066 6965 6c64 2d76 616c 7565 7320 7375   field-values su
-00016900: 7070 6f72 7465 6420 6279 2074 6869 7320  pported by this 
-00016910: 636c 6965 6e74 2e5c 6e5c 6e7c 2046 6965  client.\n\n| Fie
-00016920: 6c64 2020 2020 2020 2020 2020 2020 2020  ld              
-00016930: 207c 2056 616c 7565 2020 2020 2020 2020   | Value        
-00016940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016970: 2020 2020 2020 2020 207c 2044 6573 6372           | Descr
-00016980: 6970 7469 6f6e 2020 2020 2020 2020 2020  iption          
-00016990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a10: 2020 2020 2020 2020 2020 2020 207c 5c6e               |\n
-00016a20: 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  |---------------
-00016a30: 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d  ------|---------
-00016a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016a70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d  --------------|-
-00016a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016b20: 2d2d 7c5c 6e7c 2054 6c73 2020 2020 2020  --|\n| Tls      
-00016b30: 2020 2020 2020 2020 2020 207c 2022 7472             | "tr
-00016b40: 7565 222c 2022 6661 6c73 6522 2028 6465  ue", "false" (de
-00016b50: 6661 756c 743a 2022 7472 7565 2229 2020  fault: "true")  
-00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b80: 2020 207c 2049 6620 2274 7275 6522 2074     | If "true" t
-00016b90: 6865 2063 6c69 656e 7420 7769 6c6c 2063  he client will c
-00016ba0: 7265 6174 6520 6120 2273 6563 7572 6522  reate a "secure"
-00016bb0: 2067 5250 4320 6368 616e 6e65 6c2e 2049   gRPC channel. I
-00016bc0: 6620 2266 616c 7365 2220 7468 6520 636c  f "false" the cl
-00016bd0: 6965 6e74 2077 696c 6c20 6372 6561 7465  ient will create
-00016be0: 2061 6e20 2269 6e73 6563 7572 6522 2067   an "insecure" g
-00016bf0: 5250 4320 6368 616e 6e65 6c2e 2054 6869  RPC channel. Thi
-00016c00: 7320 6d75 7374 206d 6174 6368 2074 6865  s must match the
-00016c10: 2073 6572 7665 7220 636f 6e66 6967 7572   server configur
-00016c20: 6174 696f 6e2e 207c 5c6e 7c20 546c 7356  ation. |\n| TlsV
-00016c30: 6572 6966 7943 6572 7420 2020 2020 2020  erifyCert       
-00016c40: 7c20 2274 7275 6522 2c20 2266 616c 7365  | "true", "false
-00016c50: 2220 2864 6566 6175 6c74 3a20 2274 7275  " (default: "tru
-00016c60: 6522 2920 2020 2020 2020 2020 2020 2020  e")             
-00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c80: 2020 2020 2020 2020 7c20 5468 6973 2076          | This v
-00016c90: 616c 7565 2069 7320 6375 7272 656e 746c  alue is currentl
-00016ca0: 7920 6967 6e6f 7265 642e 2020 2020 2020  y ignored.      
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d20: 2020 2020 2020 2020 2020 2020 7c5c 6e7c              |\n|
-00016d30: 2043 6f6e 6e65 6374 696f 6e4e 616d 6520   ConnectionName 
-00016d40: 2020 2020 207c 2073 7472 696e 6720 2864       | string (d
-00016d50: 6566 6175 6c74 3a20 6175 746f 2d67 656e  efault: auto-gen
-00016d60: 6572 6174 6564 2076 6572 7369 6f6e 2d34  erated version-4
-00016d70: 2055 5549 4429 2020 2020 2020 2020 2020   UUID)          
-00016d80: 2020 2020 2020 2020 2020 2020 207c 2053               | S
-00016d90: 656e 7420 696e 2063 616c 6c20 6d65 7461  ent in call meta
-00016da0: 6461 7461 2066 6f72 2065 7665 7279 2063  data for every c
-00016db0: 616c 6c2c 2074 6f20 6964 656e 7469 6679  all, to identify
-00016dc0: 2074 6865 2063 6c69 656e 7420 746f 2074   the client to t
-00016dd0: 6865 2063 6c75 7374 6572 2e20 2020 2020  he cluster.     
-00016de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e30: 207c 5c6e 7c20 4e6f 6465 5072 6566 6572   |\n| NodePrefer
-00016e40: 656e 6365 2020 2020 2020 7c20 226c 6561  ence      | "lea
-00016e50: 6465 7222 2c20 2266 6f6c 6c6f 7765 7222  der", "follower"
-00016e60: 2c20 2272 6561 646f 6e6c 7972 6570 6c69  , "readonlyrepli
-00016e70: 6361 222c 2022 7261 6e64 6f6d 2220 2864  ca", "random" (d
-00016e80: 6566 6175 6c74 3a20 226c 6561 6465 7222  efault: "leader"
-00016e90: 2920 7c20 5468 6520 6e6f 6465 2073 7461  ) | The node sta
-00016ea0: 7465 2070 7265 6665 7272 6564 2062 7920  te preferred by 
-00016eb0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
-00016ec0: 636c 6965 6e74 2077 696c 6c20 7365 6c65  client will sele
-00016ed0: 6374 2061 206e 6f64 6520 6672 6f6d 2074  ct a node from t
-00016ee0: 6865 2063 6c75 7374 6572 2069 6e66 6f20  he cluster info 
-00016ef0: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
-00016f00: 6520 476f 7373 6970 2041 5049 2061 6363  e Gossip API acc
-00016f10: 6f72 6469 6e67 2074 6f20 7468 6973 2070  ording to this p
-00016f20: 7265 6665 7265 6e63 652e 2020 2020 2020  reference.      
-00016f30: 2020 2020 2020 7c5c 6e7c 2044 6566 6175        |\n| Defau
-00016f40: 6c74 4465 6164 6c69 6e65 2020 2020 207c  ltDeadline     |
-00016f50: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
-00016f60: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
-00016f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f90: 2020 2020 2020 207c 2054 6865 2064 6566         | The def
-00016fa0: 6175 6c74 2076 616c 7565 2028 696e 2073  ault value (in s
-00016fb0: 6563 6f6e 6473 2920 6f66 2074 6865 2060  econds) of the `
-00016fc0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00016fd0: 7420 6f66 2063 6c69 656e 7420 2277 7269  t of client "wri
-00016fe0: 7465 2220 6d65 7468 6f64 7320 7375 6368  te" methods such
-00016ff0: 2061 7320 6061 7070 656e 645f 6576 656e   as `append_even
-00017000: 7473 2829 602e 2020 2020 2020 2020 2020  ts()`.          
-00017010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017030: 2020 2020 2020 2020 2020 207c 5c6e 7c20             |\n| 
-00017040: 476f 7373 6970 5469 6d65 6f75 7420 2020  GossipTimeout   
-00017050: 2020 2020 7c20 696e 7465 6765 7220 2864      | integer (d
-00017060: 6566 6175 6c74 3a20 3529 2020 2020 2020  efault: 5)      
-00017070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017090: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
-000170a0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-000170b0: 2869 6e20 7365 636f 6e64 7329 206f 6620  (in seconds) of 
-000170c0: 7468 6520 6074 696d 656f 7574 6020 6172  the `timeout` ar
-000170d0: 6775 6d65 6e74 206f 6620 676f 7373 6970  gument of gossip
-000170e0: 2072 6561 6420 6d65 7468 6f64 732c 2073   read methods, s
-000170f0: 7563 6820 6173 2060 7265 6164 5f67 6f73  uch as `read_gos
-00017100: 7369 7028 2960 2e20 2020 2020 2020 2020  sip()`.         
-00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017140: 7c5c 6e7c 204d 6178 4469 7363 6f76 6572  |\n| MaxDiscover
-00017150: 4174 7465 6d70 7473 207c 2069 6e74 6567  Attempts | integ
-00017160: 6572 2028 6465 6661 756c 743a 2031 3029  er (default: 10)
-00017170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171a0: 207c 2054 6865 206e 756d 6265 7220 6f66   | The number of
-000171b0: 2061 7474 656d 7074 7320 746f 2072 6561   attempts to rea
-000171c0: 6420 676f 7373 6970 2077 6865 6e20 636f  d gossip when co
-000171d0: 6e6e 6563 7469 6e67 206f 7220 7265 636f  nnecting or reco
-000171e0: 6e6e 6563 7469 6e67 2074 6f20 6120 636c  nnecting to a cl
-000171f0: 7573 7465 7220 6d65 6d62 6572 2e20 2020  uster member.   
-00017200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017240: 2020 2020 207c 5c6e 7c20 4469 7363 6f76       |\n| Discov
-00017250: 6572 7949 6e74 6572 7661 6c20 2020 7c20  eryInterval   | 
-00017260: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00017270: 3a20 3130 3029 2020 2020 2020 2020 2020  : 100)          
-00017280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172a0: 2020 2020 2020 7c20 486f 7720 6c6f 6e67        | How long
-000172b0: 2074 6f20 7761 6974 2028 696e 206d 696c   to wait (in mil
-000172c0: 6c69 7365 636f 6e64 7329 2062 6574 7765  liseconds) betwe
-000172d0: 656e 2067 6f73 7369 7020 7265 7472 6965  en gossip retrie
-000172e0: 732e 2020 2020 2020 2020 2020 2020 2020  s.              
-000172f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017340: 2020 2020 2020 2020 2020 7c5c 6e7c 204b            |\n| K
-00017350: 6565 7041 6c69 7665 496e 7465 7276 616c  eepAliveInterval
-00017360: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
-00017370: 6661 756c 743a 2060 4e6f 6e65 6029 2020  fault: `None`)  
-00017380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173a0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
-000173b0: 2076 616c 7565 206f 6620 7468 6520 2267   value of the "g
-000173c0: 7270 632e 6b65 6570 616c 6976 655f 6d73  rpc.keepalive_ms
-000173d0: 2220 6752 5043 2063 6861 6e6e 656c 206f  " gRPC channel o
-000173e0: 7074 696f 6e2e 2020 2020 2020 2020 2020  ption.          
-000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017440: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00017450: 5c6e 7c20 4b65 6570 416c 6976 6554 696d  \n| KeepAliveTim
-00017460: 656f 7574 2020 2020 7c20 696e 7465 6765  eout    | intege
-00017470: 7220 2864 6566 6175 6c74 3a20 604e 6f6e  r (default: `Non
-00017480: 6560 2920 2020 2020 2020 2020 2020 2020  e`)             
-00017490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174b0: 7c20 5468 6520 7661 6c75 6520 6f66 2074  | The value of t
-000174c0: 6865 2022 6772 7063 2e6b 6565 7061 6c69  he "grpc.keepali
-000174d0: 7665 5f74 696d 656f 7574 5f6d 7322 2067  ve_timeout_ms" g
-000174e0: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
-000174f0: 6f6e 2e20 2020 2020 2020 2020 2020 2020  on.             
-00017500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017550: 2020 2020 7c5c 6e5c 6e5c 6e48 6572 6520      |\n\n\nHere 
-00017560: 6172 6520 736f 6d65 2065 7861 6d70 6c65  are some example
-00017570: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
-00017580: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-00017590: 696e 6720 5552 4973 2e5c 6e5c 6e20 2020  ing URIs.\n\n   
-000175a0: 2023 2047 6574 2063 6c75 7374 6572 2069   # Get cluster i
-000175b0: 6e66 6f20 6672 6f6d 2073 6563 7572 6520  nfo from secure 
-000175c0: 7365 7276 6572 2073 6f63 6b65 7420 6c6f  server socket lo
-000175d0: 6361 6c68 6f73 743a 3231 3133 2c5c 6e20  calhost:2113,\n 
-000175e0: 2020 2023 2061 6e64 2075 7365 2022 6164     # and use "ad
-000175f0: 6d69 6e22 2061 6e64 2022 6368 616e 6765  min" and "change
-00017600: 6974 2220 6173 2075 7365 726e 616d 6520  it" as username 
-00017610: 616e 6420 7061 7373 776f 7264 5c6e 2020  and password\n  
-00017620: 2020 2320 7768 656e 206d 616b 696e 6720    # when making 
-00017630: 6361 6c6c 7320 746f 2045 7665 6e74 5374  calls to EventSt
-00017640: 6f72 6544 4220 4150 4920 6d65 7468 6f64  oreDB API method
-00017650: 732e 5c6e 5c6e 2020 2020 6573 6462 3a2f  s.\n\n    esdb:/
-00017660: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
-00017670: 6c6f 6361 6c68 6f73 743a 3231 3133 5c6e  localhost:2113\n
-00017680: 5c6e 5c6e 2020 2020 2320 4765 7420 636c  \n\n    # Get cl
-00017690: 7573 7465 7220 696e 666f 2066 726f 6d20  uster info from 
-000176a0: 696e 7365 6375 7265 2073 6572 7665 7220  insecure server 
-000176b0: 736f 636b 6574 2031 3237 2e30 2e30 2e31  socket 127.0.0.1
-000176c0: 3a32 3131 345c 6e5c 6e20 2020 2065 7364  :2114\n\n    esd
-000176d0: 623a 2f2f 3132 372e 302e 302e 313a 3231  b://127.0.0.1:21
-000176e0: 3134 3f54 6c73 3d66 616c 7365 5c6e 5c6e  14?Tls=false\n\n
-000176f0: 5c6e 2020 2020 2320 4765 7420 636c 7573  \n    # Get clus
-00017700: 7465 7220 696e 666f 2066 726f 6d20 6164  ter info from ad
-00017710: 6472 6573 7365 7320 696e 205c 2741 5c27  dresses in \'A\'
-00017720: 2072 6563 6f72 6473 2066 6f72 2063 6c75   records for clu
-00017730: 7374 6572 312e 6578 616d 706c 652e 636f  ster1.example.co
-00017740: 6d2c 5c6e 2020 2020 2320 616e 6420 7573  m,\n    # and us
-00017750: 6520 6120 6465 6661 756c 7420 6465 6164  e a default dead
-00017760: 6c69 6e65 2066 6f72 206d 616b 696e 6720  line for making 
-00017770: 6361 6c6c 7320 746f 2045 7665 6e74 5374  calls to EventSt
-00017780: 6f72 6520 4150 4920 6d65 7468 6f64 2e5c  ore API method.\
-00017790: 6e5c 6e20 2020 2065 7364 622b 6469 7363  n\n    esdb+disc
-000177a0: 6f76 6572 3a2f 2f61 646d 696e 3a63 6861  over://admin:cha
-000177b0: 6e67 6569 7440 636c 7573 7465 7231 2e65  ngeit@cluster1.e
-000177c0: 7861 6d70 6c65 2e63 6f6d 3f44 6566 6175  xample.com?Defau
-000177d0: 6c74 4465 6164 6c69 6e65 3d35 5c6e 5c6e  ltDeadline=5\n\n
-000177e0: 5c6e 2020 2020 2320 4765 7420 636c 7573  \n    # Get clus
-000177f0: 7465 7220 696e 666f 2066 726f 6d20 6569  ter info from ei
-00017800: 7468 6572 206c 6f63 616c 686f 7374 3a32  ther localhost:2
-00017810: 3131 3120 6f72 206c 6f63 616c 686f 7374  111 or localhost
-00017820: 3a32 3131 3220 6f72 5c6e 2020 2020 2320  :2112 or\n    # 
-00017830: 6c6f 6361 6c68 6f73 743a 3231 3133 2c20  localhost:2113, 
-00017840: 616e 6420 7468 656e 2063 6f6e 6e65 6374  and then connect
-00017850: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
-00017860: 6f64 6520 696e 2074 6865 2063 6c75 7374  ode in the clust
-00017870: 6572 2e5c 6e5c 6e20 2020 2065 7364 623a  er.\n\n    esdb:
-00017880: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
-00017890: 406c 6f63 616c 686f 7374 3a32 3131 312c  @localhost:2111,
-000178a0: 6c6f 6361 6c68 6f73 743a 3231 3132 2c6c  localhost:2112,l
-000178b0: 6f63 616c 686f 7374 3a32 3131 333f 4e6f  ocalhost:2113?No
-000178c0: 6465 5072 6566 6572 656e 6365 3d66 6f6c  dePreference=fol
-000178d0: 6c6f 7765 725c 6e5c 6e5c 6e20 2020 2023  lower\n\n\n    #
-000178e0: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
-000178f0: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
-00017900: 2069 6e20 5c27 415c 2720 7265 636f 7264   in \'A\' record
-00017910: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
-00017920: 7861 6d70 6c65 2e63 6f6d 2c5c 6e20 2020  xample.com,\n   
-00017930: 2023 2061 6e64 2063 6f6e 6669 6775 7265   # and configure
-00017940: 2022 6b65 6570 2061 6c69 7665 2220 7469   "keep alive" ti
-00017950: 6d65 6f75 7420 616e 6420 696e 7465 7276  meout and interv
-00017960: 616c 2069 6e20 7468 6520 6752 5043 2063  al in the gRPC c
-00017970: 6861 6e6e 656c 2e5c 6e5c 6e20 2020 2065  hannel.\n\n    e
-00017980: 7364 622b 6469 7363 6f76 6572 3a2f 2f61  sdb+discover://a
-00017990: 646d 696e 3a63 6861 6e67 6569 7440 636c  dmin:changeit@cl
-000179a0: 7573 7465 7231 2e65 7861 6d70 6c65 2e63  uster1.example.c
-000179b0: 6f6d 3f4b 6565 7041 6c69 7665 496e 7465  om?KeepAliveInte
-000179c0: 7276 616c 3d31 3030 3030 264b 6565 7041  rval=10000&KeepA
-000179d0: 6c69 7665 5469 6d65 6f75 743d 3130 3030  liveTimeout=1000
-000179e0: 305c 6e5c 6e5c 6e50 6c65 6173 6520 6e6f  0\n\n\nPlease no
-000179f0: 7465 2c20 7468 6520 636c 6965 6e74 2069  te, the client i
-00017a00: 7320 696e 7365 6e73 6974 6976 6520 746f  s insensitive to
-00017a10: 2074 6865 2063 6173 6520 6f66 2066 6965   the case of fie
-00017a20: 6c64 7320 616e 6420 7661 6c75 6573 2e20  lds and values. 
-00017a30: 4966 2066 6965 6c64 7320 6172 655c 6e72  If fields are\nr
-00017a40: 6570 6561 7465 6420 696e 2074 6865 2071  epeated in the q
-00017a50: 7565 7279 2073 7472 696e 672c 2074 6865  uery string, the
-00017a60: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
-00017a70: 6c6c 2062 6520 7061 7273 6564 2077 6974  ll be parsed wit
-00017a80: 686f 7574 2065 7272 6f72 2e20 486f 7765  hout error. Howe
-00017a90: 7665 722c 5c6e 7468 6520 636f 6e6e 6563  ver,\nthe connec
-00017aa0: 7469 6f6e 206f 7074 696f 6e73 2075 7365  tion options use
-00017ab0: 6420 6279 2074 6865 2063 6c69 656e 7420  d by the client 
-00017ac0: 7769 6c6c 2075 7365 2074 6865 2076 616c  will use the val
-00017ad0: 7565 206f 6620 7468 6520 6669 7273 7420  ue of the first 
-00017ae0: 6669 656c 642e 2041 6c6c 5c6e 7468 6520  field. All\nthe 
-00017af0: 6f74 6865 7220 6669 656c 642d 7661 6c75  other field-valu
-00017b00: 6573 2069 6e20 7468 6520 7175 6572 7920  es in the query 
-00017b10: 7374 7269 6e67 2077 6974 6820 7468 6520  string with the 
-00017b20: 7361 6d65 2066 6965 6c64 206e 616d 6520  same field name 
-00017b30: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
-00017b40: 5c6e 4669 656c 6473 2077 6974 686f 7574  \nFields without
-00017b50: 2076 616c 7565 7320 7769 6c6c 2061 6c73   values will als
-00017b60: 6f20 6265 2069 676e 6f72 6564 2e5c 6e5c  o be ignored.\n\
-00017b70: 6e49 6620 7468 6520 636c 6965 6e74 5c27  nIf the client\'
-00017b80: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
-00017b90: 6520 6973 2022 6c65 6164 6572 2220 616e  e is "leader" an
-00017ba0: 6420 7468 6520 6e6f 6465 2062 6563 6f6d  d the node becom
-00017bb0: 6573 2061 5c6e 2266 6f6c 6c6f 7765 7222  es a\n"follower"
-00017bc0: 2c20 7468 6520 636c 6965 6e74 2077 696c  , the client wil
-00017bd0: 6c20 6174 7465 6d70 7420 746f 2072 6563  l attempt to rec
-00017be0: 6f6e 6e65 6374 2074 6f20 7468 6520 6375  onnect to the cu
-00017bf0: 7272 656e 7420 6c65 6164 6572 2077 6865  rrent leader whe
-00017c00: 6e20 6120 6d65 7468 6f64 5c6e 6973 2063  n a method\nis c
-00017c10: 616c 6c65 6420 7468 6174 2065 7870 6563  alled that expec
-00017c20: 7473 2074 6f20 6361 6c6c 2061 206c 6561  ts to call a lea
-00017c30: 6465 722e 204d 6574 686f 6473 2077 6869  der. Methods whi
-00017c40: 6368 206d 7574 6174 6520 7468 6520 7374  ch mutate the st
-00017c50: 6174 6520 6f66 2074 6865 2064 6174 6162  ate of the datab
-00017c60: 6173 655c 6e65 7870 6563 7420 746f 2063  ase\nexpect to c
-00017c70: 616c 6c20 6120 6c65 6164 6572 2e20 466f  all a leader. Fo
-00017c80: 7220 7375 6368 206d 6574 686f 6473 2c20  r such methods, 
-00017c90: 7468 6520 4854 5450 2068 6561 6465 7222  the HTTP header"
-00017ca0: 7265 7175 6972 6573 2d6c 6561 6465 7222  requires-leader"
-00017cb0: 2069 7320 7365 7420 746f 5c6e 2274 7275   is set to\n"tru
-00017cc0: 6522 2c20 616e 6420 7468 6973 2068 6561  e", and this hea
-00017cd0: 6465 7220 6973 206f 6273 6572 7665 6420  der is observed 
-00017ce0: 6279 2074 6865 2073 6572 7665 722c 2061  by the server, a
-00017cf0: 6e64 2073 6f20 6120 6e6f 6465 2077 6869  nd so a node whi
-00017d00: 6368 2069 7320 6e6f 7420 6120 6c65 6164  ch is not a lead
-00017d10: 6572 5c6e 7468 6174 2072 6563 6569 7665  er\nthat receive
-00017d20: 7320 7375 6368 2061 2072 6571 7565 7374  s such a request
-00017d30: 2077 696c 6c20 7265 7475 726e 2061 6e20   will return an 
-00017d40: 6572 726f 722e 2054 6869 7320 6572 726f  error. This erro
-00017d50: 7220 6973 2064 6574 6563 7465 6420 6279  r is detected by
-00017d60: 2074 6865 2063 6c69 656e 742c 5c6e 7768   the client,\nwh
-00017d70: 6963 6820 7769 6c6c 2074 6865 6e20 636c  ich will then cl
-00017d80: 6f73 6520 7468 6520 6375 7272 656e 7420  ose the current 
-00017d90: 6752 5043 2063 6f6e 6e65 6374 696f 6e20  gRPC connection 
-00017da0: 616e 6420 6372 6561 7465 2061 206e 6577  and create a new
-00017db0: 2063 6f6e 6e65 6374 696f 6e20 746f 2074   connection to t
-00017dc0: 6865 5c6e 6c65 6164 6572 2e20 5468 6520  he\nleader. The 
-00017dd0: 7265 7175 6573 7420 7769 6c6c 2074 6865  request will the
-00017de0: 6e20 6265 2072 6574 7269 6564 2077 6974  n be retried wit
-00017df0: 6820 7468 6520 6c65 6164 6572 2e5c 6e5c  h the leader.\n\
-00017e00: 6e49 6620 7468 6520 636c 6965 6e74 5c27  nIf the client\'
-00017e10: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
-00017e20: 6520 6973 2022 666f 6c6c 6f77 6572 2220  e is "follower" 
-00017e30: 616e 6420 7468 6572 6520 6172 6520 6e6f  and there are no
-00017e40: 2066 6f6c 6c6f 7765 725c 6e6e 6f64 6573   follower\nnodes
-00017e50: 2069 6e20 7468 6520 636c 7573 7465 722c   in the cluster,
-00017e60: 2074 6865 6e20 7468 6520 636c 6965 6e74   then the client
-00017e70: 2077 696c 6c20 7261 6973 6520 616e 2065   will raise an e
-00017e80: 7863 6570 7469 6f6e 2e20 5369 6d69 6c61  xception. Simila
-00017e90: 726c 792c 2069 6620 7468 655c 6e63 6c69  rly, if the\ncli
-00017ea0: 656e 745c 2773 206e 6f64 6520 7072 6566  ent\'s node pref
-00017eb0: 6572 656e 6365 2069 7320 2272 6561 646f  erence is "reado
-00017ec0: 6e6c 7972 6570 6c69 6361 2220 616e 6420  nlyreplica" and 
-00017ed0: 7468 6572 6520 6172 6520 6e6f 2072 6561  there are no rea
-00017ee0: 642d 6f6e 6c79 2072 6570 6c69 6361 5c6e  d-only replica\n
-00017ef0: 6e6f 6465 7320 696e 2074 6865 2063 6c75  nodes in the clu
-00017f00: 7374 6572 2c20 7468 656e 2074 6865 2063  ster, then the c
-00017f10: 6c69 656e 7420 7769 6c6c 2061 6c73 6f20  lient will also 
-00017f20: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
-00017f30: 6f6e 2e5c 6e5c 6e54 6865 2067 5250 4320  on.\n\nThe gRPC 
-00017f40: 6368 616e 6e65 6c20 6f70 7469 6f6e 2022  channel option "
-00017f50: 6772 7063 2e6d 6178 5f72 6563 6569 7665  grpc.max_receive
-00017f60: 5f6d 6573 7361 6765 5f6c 656e 6774 6822  _message_length"
-00017f70: 2069 7320 6175 746f 6d61 7469 6361 6c6c   is automaticall
-00017f80: 795c 6e63 6f6e 6669 6775 7265 6420 746f  y\nconfigured to
-00017f90: 2074 6865 2076 616c 7565 2060 3137 202a   the value `17 *
-00017fa0: 2031 3032 3420 2a20 3130 3234 602e 2054   1024 * 1024`. T
-00017fb0: 6869 7320 7661 6c75 6520 6361 6e6e 6f74  his value cannot
-00017fc0: 2062 6520 6368 616e 6765 642e 5c6e 5c6e   be changed.\n\n
-00017fd0: 5c6e 2323 2320 5265 6775 6c61 7220 6578  \n### Regular ex
-00017fe0: 7072 6573 7369 6f6e 2066 696c 7465 7273  pression filters
-00017ff0: 5c6e 5c6e 5468 6520 6669 6c74 6572 2061  \n\nThe filter a
-00018000: 7267 756d 656e 7473 2069 6e20 6072 6561  rguments in `rea
-00018010: 645f 616c 6c5f 6576 656e 7473 2829 602c  d_all_events()`,
-00018020: 2060 7375 6273 6372 6962 655f 616c 6c5f   `subscribe_all_
-00018030: 6576 656e 7473 2829 602c 5c6e 6063 7265  events()`,\n`cre
-00018040: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00018050: 2829 6020 616e 6420 6067 6574 5f63 6f6d  ()` and `get_com
-00018060: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
-00018070: 6172 6520 6170 706c 6965 6420 746f 2074  are applied to t
-00018080: 6865 2060 7479 7065 605c 6e61 7474 7269  he `type`\nattri
-00018090: 6275 7465 206f 6620 7265 636f 7264 6564  bute of recorded
-000180a0: 2065 7665 6e74 732e 5c6e 5c6e 5468 6520   events.\n\nThe 
-000180b0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
-000180c0: 2074 6865 2060 6669 6c74 6572 5f65 7863   the `filter_exc
-000180d0: 6c75 6465 6020 6172 6775 6d65 6e74 7320  lude` arguments 
-000180e0: 6973 2064 6573 6967 6e65 6420 746f 2065  is designed to e
-000180f0: 7863 6c75 6465 5c6e 4576 656e 7453 746f  xclude\nEventSto
-00018100: 7265 4442 2022 7379 7374 656d 2220 616e  reDB "system" an
-00018110: 6420 2270 6572 7369 7374 656e 6365 2073  d "persistence s
-00018120: 7562 7363 7269 7074 696f 6e20 636f 6e66  ubscription conf
-00018130: 6967 2220 6576 656e 7473 2c20 7768 6963  ig" events, whic
-00018140: 685c 6e6f 7468 6572 7769 7365 2077 6f75  h\notherwise wou
-00018150: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
-00018160: 5379 7374 656d 2065 7665 6e74 7320 6765  System events ge
-00018170: 6e65 7261 7465 6420 6279 2045 7665 6e74  nerated by Event
-00018180: 5374 6f72 6544 4220 616c 6c5c 6e68 6176  StoreDB all\nhav
-00018190: 6520 6074 7970 6560 2073 7472 696e 6773  e `type` strings
-000181a0: 2074 6861 7420 7374 6172 7420 7769 7468   that start with
-000181b0: 2074 6865 2060 2460 2073 6967 6e2e 2050   the `$` sign. P
-000181c0: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-000181d0: 7269 7074 696f 6e5c 6e65 7665 6e74 7320  ription\nevents 
-000181e0: 6765 6e65 7261 7465 6420 7768 656e 206d  generated when m
-000181f0: 616e 6970 756c 6174 696e 6720 7065 7273  anipulating pers
-00018200: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
-00018210: 7469 6f6e 7320 616c 6c20 6861 7665 2060  tions all have `
-00018220: 7479 7065 605c 6e73 7472 696e 6773 2074  type`\nstrings t
-00018230: 6861 7420 7374 6172 7420 7769 7468 2060  hat start with `
-00018240: 5065 7273 6973 7465 6e74 436f 6e66 6967  PersistentConfig
-00018250: 602e 5c6e 5c6e 466f 7220 6578 616d 706c  `.\n\nFor exampl
-00018260: 652c 2074 6f20 6d61 7463 6820 7468 6520  e, to match the 
-00018270: 7479 7065 206f 6620 4576 656e 7453 746f  type of EventSto
-00018280: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
-00018290: 7473 2c20 7573 6520 7468 6520 7265 6775  ts, use the regu
-000182a0: 6c61 725c 6e65 7870 7265 7373 696f 6e20  lar\nexpression 
-000182b0: 6072 5c27 5c5c 242e 2b5c 2760 2e20 506c  `r\'\\$.+\'`. Pl
-000182c0: 6561 7365 206e 6f74 652c 2074 6865 2063  ease note, the c
-000182d0: 6f6e 7374 616e 7420 6045 5344 425f 5359  onstant `ESDB_SY
-000182e0: 5354 454d 5f45 5645 4e54 535f 5245 4745  STEM_EVENTS_REGE
-000182f0: 5860 2069 735c 6e73 6574 2074 6f20 6072  X` is\nset to `r
-00018300: 5c27 5c5c 242e 2b5c 2760 2e20 596f 7520  \'\\$.+\'`. You 
-00018310: 6361 6e20 696d 706f 7274 2074 6869 7320  can import this 
-00018320: 7661 6c75 655c 6e28 6066 726f 6d20 6573  value\n(`from es
-00018330: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
-00018340: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
-00018350: 5453 5f52 4547 4558 6029 2061 6e64 2075  TS_REGEX`) and u
-00018360: 7365 5c6e 6974 2077 6865 6e20 6275 696c  se\nit when buil
-00018370: 6469 6e67 206c 6f6e 6765 7220 7365 7175  ding longer sequ
-00018380: 656e 6365 7320 6f66 2072 6567 756c 6172  ences of regular
-00018390: 2065 7870 7265 7373 696f 6e73 2e5c 6e5c   expressions.\n\
-000183a0: 6e53 696d 696c 6172 6c79 2c20 746f 206d  nSimilarly, to m
-000183b0: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
-000183c0: 2045 7665 6e74 5374 6f72 6544 4220 7065   EventStoreDB pe
-000183d0: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
-000183e0: 6970 7469 6f6e 2065 7665 6e74 732c 2075  iption events, u
-000183f0: 7365 2074 6865 5c6e 7265 6775 6c61 7220  se the\nregular 
-00018400: 6578 7072 6573 7369 6f6e 2060 725c 2750  expression `r\'P
-00018410: 6572 7369 7374 656e 7443 6f6e 6669 675c  ersistentConfig\
-00018420: 5c64 2b5c 2760 2e20 5468 6520 636f 6e73  \d+\'`. The cons
-00018430: 7461 6e74 2060 4553 4442 5f50 4552 5349  tant `ESDB_PERSI
-00018440: 5354 454e 545f 434f 4e46 4947 5f45 5645  STENT_CONFIG_EVE
-00018450: 4e54 535f 5245 4745 5860 5c6e 6973 2073  NTS_REGEX`\nis s
-00018460: 6574 2074 6f20 6072 5c27 5065 7273 6973  et to `r\'Persis
-00018470: 7465 6e74 436f 6e66 6967 5c5c 642b 5c27  tentConfig\\d+\'
-00018480: 602e 2059 6f75 2063 616e 2061 6c73 6f20  `. You can also 
-00018490: 696d 706f 7274 2074 6869 7320 7661 6c75  import this valu
-000184a0: 655c 6e28 6066 726f 6d20 6573 6462 636c  e\n(`from esdbcl
-000184b0: 6965 6e74 2069 6d70 6f72 7420 4553 4442  ient import ESDB
-000184c0: 5f50 4552 5349 5354 454e 545f 434f 4e46  _PERSISTENT_CONF
-000184d0: 4947 5f45 5645 4e54 535f 5245 4745 5860  IG_EVENTS_REGEX`
-000184e0: 2920 616e 6420 7573 6520 6974 2077 6865  ) and use it whe
-000184f0: 6e20 6275 696c 6469 6e67 5c6e 6c6f 6e67  n building\nlong
-00018500: 6572 2073 6571 7565 6e63 6573 206f 6620  er sequences of 
-00018510: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-00018520: 6f6e 732e 5c6e 5c6e 5468 6520 636f 6e73  ons.\n\nThe cons
-00018530: 7461 6e74 2060 4445 4641 554c 545f 4558  tant `DEFAULT_EX
-00018540: 434c 5544 455f 4649 4c54 4552 6020 6973  CLUDE_FILTER` is
-00018550: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-00018560: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-00018570: 6e73 2074 6861 7420 6d61 7463 685c 6e74  ns that match\nt
-00018580: 6865 2065 7665 6e74 7320 7468 6174 2045  he events that E
-00018590: 7665 6e74 5374 6f72 6544 4220 6765 6e65  ventStoreDB gene
-000185a0: 7261 7465 7320 696e 7465 726e 616c 6c79  rates internally
-000185b0: 2c20 6576 656e 7473 2074 6861 7420 6172  , events that ar
-000185c0: 6520 6578 7472 616e 656f 7573 2074 6f20  e extraneous to 
-000185d0: 7468 6f73 655c 6e77 6869 6368 2079 6f75  those\nwhich you
-000185e0: 2061 7070 656e 6420 7573 696e 6720 7468   append using th
-000185f0: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
-00018600: 2829 6020 6d65 7468 6f64 2e5c 6e5c 6e5c  ()` method.\n\n\
-00018610: 6e23 2323 204e 6577 2065 7665 6e74 206f  n### New event o
-00018620: 626a 6563 7473 5c6e 5c6e 5468 6520 604e  bjects\n\nThe `N
-00018630: 6577 4576 656e 7460 2063 6c61 7373 2069  ewEvent` class i
-00018640: 7320 7573 6564 2077 6865 6e20 6170 7065  s used when appe
-00018650: 6e64 696e 6720 6576 656e 7473 2e5c 6e5c  nding events.\n\
-00018660: 6e54 6865 2072 6571 7569 7265 6420 6172  nThe required ar
-00018670: 6775 6d65 6e74 2060 7479 7065 6020 6973  gument `type` is
-00018680: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
-00018690: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-000186a0: 6520 7468 6520 7479 7065 206f 665c 6e74  e the type of\nt
-000186b0: 6865 2065 7665 6e74 2074 6861 7420 7769  he event that wi
-000186c0: 6c6c 2062 6520 7265 636f 7264 6564 2e5c  ll be recorded.\
-000186d0: 6e5c 6e54 6865 2072 6571 7569 7265 6420  n\nThe required 
-000186e0: 6172 6775 6d65 6e74 2060 6461 7461 6020  argument `data` 
-000186f0: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
-00018700: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
-00018710: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00018720: 2064 6174 6120 6f66 5c6e 7468 6520 6576   data of\nthe ev
-00018730: 656e 7420 7468 6174 2077 696c 6c20 6265  ent that will be
-00018740: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
-00018750: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
-00018760: 656e 7420 606d 6574 6164 6174 6160 2069  ent `metadata` i
-00018770: 7320 6120 5079 7468 6f6e 2060 6279 7465  s a Python `byte
-00018780: 7360 206f 626a 6563 742c 2075 7365 6420  s` object, used 
-00018790: 746f 2069 6e64 6963 6174 6520 616e 795c  to indicate any\
-000187a0: 6e6d 6574 6164 6174 6120 6f66 2074 6865  nmetadata of the
-000187b0: 2065 7665 6e74 2074 6861 7420 7769 6c6c   event that will
-000187c0: 2062 6520 7265 636f 7264 6564 2e20 5468   be recorded. Th
-000187d0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-000187e0: 6973 2061 6e20 656d 7074 7920 6062 7974  is an empty `byt
-000187f0: 6573 605c 6e6f 626a 6563 742e 5c6e 5c6e  es`\nobject.\n\n
-00018800: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
-00018810: 756d 656e 7420 6063 6f6e 7465 6e74 5f74  ument `content_t
-00018820: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
-00018830: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
-00018840: 696e 6469 6361 7465 2074 6865 5c6e 7479  indicate the\nty
-00018850: 7065 206f 6620 7468 6520 6461 7461 2074  pe of the data t
-00018860: 6861 7420 7769 6c6c 2062 6520 7265 636f  hat will be reco
-00018870: 7264 6564 2066 6f72 2074 6869 7320 6576  rded for this ev
-00018880: 656e 742e 2054 6865 2064 6566 6175 6c74  ent. The default
-00018890: 2076 616c 7565 2069 735c 6e60 6170 706c   value is\n`appl
-000188a0: 6963 6174 696f 6e2f 6a73 6f6e 602c 2077  ication/json`, w
-000188b0: 6869 6368 2069 6e64 6963 6174 6573 2074  hich indicates t
-000188c0: 6861 7420 7468 6520 6064 6174 6160 2077  hat the `data` w
-000188d0: 6173 2073 6572 6961 6c69 7365 6420 7573  as serialised us
-000188e0: 696e 6720 4a53 4f4e 2e5c 6e41 6e20 616c  ing JSON.\nAn al
-000188f0: 7465 726e 6174 6976 6520 7661 6c75 6520  ternative value 
-00018900: 666f 7220 7468 6973 2061 7267 756d 656e  for this argumen
-00018910: 7420 6973 2060 6170 706c 6963 6174 696f  t is `applicatio
-00018920: 6e2f 6f63 7465 742d 7374 7265 616d 602e  n/octet-stream`.
-00018930: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-00018940: 2061 7267 756d 656e 7420 6069 6460 2069   argument `id` i
-00018950: 7320 6120 5079 7468 6f6e 2060 5555 4944  s a Python `UUID
-00018960: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
-00018970: 6f20 7370 6563 6966 7920 7468 6520 756e  o specify the un
-00018980: 6971 7565 2049 445c 6e6f 6620 7468 6520  ique ID\nof the 
-00018990: 6576 656e 7420 7468 6174 2077 696c 6c20  event that will 
-000189a0: 6265 2072 6563 6f72 6465 642e 2054 6869  be recorded. Thi
-000189b0: 7320 7661 6c75 6520 7769 6c6c 2064 6566  s value will def
-000189c0: 6175 6c74 2074 6f20 6120 6e65 7720 7665  ault to a new ve
-000189d0: 7273 696f 6e2d 3420 5555 4944 2e5c 6e5c  rsion-4 UUID.\n\
-000189e0: 6e60 6060 7079 7468 6f6e 5c6e 6e65 775f  n```python\nnew_
-000189f0: 6576 656e 7431 203d 204e 6577 4576 656e  event1 = NewEven
-00018a00: 7428 5c6e 2020 2020 7479 7065 3d5c 274f  t(\n    type=\'O
-00018a10: 7264 6572 4372 6561 7465 645c 272c 5c6e  rderCreated\',\n
-00018a20: 2020 2020 6461 7461 3d62 5c27 7b22 6e61      data=b\'{"na
-00018a30: 6d65 223a 2022 4772 6567 227d 5c27 2c5c  me": "Greg"}\',\
-00018a40: 6e29 5c6e 6173 7365 7274 206e 6577 5f65  n)\nassert new_e
-00018a50: 7665 6e74 312e 7479 7065 203d 3d20 5c27  vent1.type == \'
-00018a60: 4f72 6465 7243 7265 6174 6564 5c27 5c6e  OrderCreated\'\n
-00018a70: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
-00018a80: 312e 6461 7461 203d 3d20 625c 277b 226e  1.data == b\'{"n
-00018a90: 616d 6522 3a20 2247 7265 6722 7d5c 275c  ame": "Greg"}\'\
-00018aa0: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
-00018ab0: 7431 2e6d 6574 6164 6174 6120 3d3d 2062  t1.metadata == b
-00018ac0: 5c27 5c27 5c6e 6173 7365 7274 206e 6577  \'\'\nassert new
-00018ad0: 5f65 7665 6e74 312e 636f 6e74 656e 745f  _event1.content_
-00018ae0: 7479 7065 203d 3d20 5c27 6170 706c 6963  type == \'applic
-00018af0: 6174 696f 6e2f 6a73 6f6e 5c27 5c6e 6173  ation/json\'\nas
-00018b00: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00018b10: 6e65 775f 6576 656e 7431 2e69 642c 2055  new_event1.id, U
-00018b20: 5549 4429 5c6e 5c6e 6576 656e 745f 6964  UID)\n\nevent_id
-00018b30: 203d 2075 7569 6434 2829 5c6e 6e65 775f   = uuid4()\nnew_
-00018b40: 6576 656e 7432 203d 204e 6577 4576 656e  event2 = NewEven
-00018b50: 7428 5c6e 2020 2020 7479 7065 3d5c 2749  t(\n    type=\'I
-00018b60: 6d61 6765 4372 6561 7465 645c 272c 5c6e  mageCreated\',\n
-00018b70: 2020 2020 6461 7461 3d62 5c27 3031 3031      data=b\'0101
-00018b80: 3031 3031 3031 3031 3031 5c27 2c5c 6e20  0101010101\',\n 
-00018b90: 2020 206d 6574 6164 6174 613d 625c 277b     metadata=b\'{
-00018ba0: 2261 223a 2031 7d5c 272c 5c6e 2020 2020  "a": 1}\',\n    
-00018bb0: 636f 6e74 656e 745f 7479 7065 3d5c 2761  content_type=\'a
-00018bc0: 7070 6c69 6361 7469 6f6e 2f6f 6374 6574  pplication/octet
-00018bd0: 2d73 7472 6561 6d5c 272c 5c6e 2020 2020  -stream\',\n    
-00018be0: 6964 3d65 7665 6e74 5f69 642c 5c6e 295c  id=event_id,\n)\
-00018bf0: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
-00018c00: 7432 2e74 7970 6520 3d3d 205c 2749 6d61  t2.type == \'Ima
-00018c10: 6765 4372 6561 7465 645c 275c 6e61 7373  geCreated\'\nass
-00018c20: 6572 7420 6e65 775f 6576 656e 7432 2e64  ert new_event2.d
-00018c30: 6174 6120 3d3d 2062 5c27 3031 3031 3031  ata == b\'010101
-00018c40: 3031 3031 3031 3031 5c27 5c6e 6173 7365  01010101\'\nasse
-00018c50: 7274 206e 6577 5f65 7665 6e74 322e 6d65  rt new_event2.me
-00018c60: 7461 6461 7461 203d 3d20 625c 277b 2261  tadata == b\'{"a
-00018c70: 223a 2031 7d5c 275c 6e61 7373 6572 7420  ": 1}\'\nassert 
-00018c80: 6e65 775f 6576 656e 7432 2e63 6f6e 7465  new_event2.conte
-00018c90: 6e74 5f74 7970 6520 3d3d 205c 2761 7070  nt_type == \'app
-00018ca0: 6c69 6361 7469 6f6e 2f6f 6374 6574 2d73  lication/octet-s
-00018cb0: 7472 6561 6d5c 275c 6e61 7373 6572 7420  tream\'\nassert 
-00018cc0: 6e65 775f 6576 656e 7432 2e69 6420 3d3d  new_event2.id ==
-00018cd0: 2065 7665 6e74 5f69 645c 6e60 6060 5c6e   event_id\n```\n
-00018ce0: 5c6e 2323 2320 5265 636f 7264 6564 2065  \n### Recorded e
-00018cf0: 7665 6e74 206f 626a 6563 7473 5c6e 5c6e  vent objects\n\n
-00018d00: 5468 6520 6052 6563 6f72 6465 6445 7665  The `RecordedEve
-00018d10: 6e74 6020 636c 6173 7320 6973 2075 7365  nt` class is use
-00018d20: 6420 7768 656e 2072 6561 6469 6e67 2065  d when reading e
-00018d30: 7665 6e74 732e 5c6e 5c6e 5468 6520 6174  vents.\n\nThe at
-00018d40: 7472 6962 7574 6520 6074 7970 6560 2069  tribute `type` i
-00018d50: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-00018d60: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-00018d70: 7465 2074 6865 2074 7970 6520 6f66 2065  te the type of e
-00018d80: 7665 6e74 5c6e 7468 6174 2077 6173 2072  vent\nthat was r
-00018d90: 6563 6f72 6465 642e 5c6e 5c6e 5468 6520  ecorded.\n\nThe 
-00018da0: 6174 7472 6962 7574 6520 6064 6174 6160  attribute `data`
-00018db0: 2069 7320 6120 5079 7468 6f6e 2060 6279   is a Python `by
-00018dc0: 7465 7360 206f 626a 6563 742c 2075 7365  tes` object, use
-00018dd0: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
-00018de0: 6520 6461 7461 206f 6620 7468 655c 6e65  e data of the\ne
-00018df0: 7665 6e74 2074 6861 7420 7761 7320 7265  vent that was re
-00018e00: 636f 7264 6564 2e5c 6e5c 6e54 6865 2061  corded.\n\nThe a
-00018e10: 7474 7269 6275 7465 2060 6d65 7461 6461  ttribute `metada
-00018e20: 7461 6020 6973 2061 2050 7974 686f 6e20  ta` is a Python 
-00018e30: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
-00018e40: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-00018e50: 2074 6865 206d 6574 6164 6174 6120 6f66   the metadata of
-00018e60: 5c6e 7468 6520 6576 656e 7420 7468 6174  \nthe event that
-00018e70: 2077 6173 2072 6563 6f72 6465 642e 5c6e   was recorded.\n
-00018e80: 5c6e 5468 6520 6174 7472 6962 7574 6520  \nThe attribute 
-00018e90: 6063 6f6e 7465 6e74 5f74 7970 6560 2069  `content_type` i
-00018ea0: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-00018eb0: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-00018ec0: 7465 2074 6865 2074 7970 6520 6f66 5c6e  te the type of\n
-00018ed0: 6461 7461 2074 6861 7420 7761 7320 7265  data that was re
-00018ee0: 636f 7264 6564 2066 6f72 2074 6869 7320  corded for this 
-00018ef0: 6576 656e 7420 2875 7375 616c 6c79 2060  event (usually `
-00018f00: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
-00018f10: 6020 746f 2069 6e64 6963 6174 6520 7468  ` to indicate th
-00018f20: 6174 5c6e 7468 6973 2064 6174 6120 6361  at\nthis data ca
-00018f30: 6e20 6265 2070 6172 7365 6420 6173 204a  n be parsed as J
-00018f40: 534f 4e2c 2062 7574 2061 6c74 6572 6e61  SON, but alterna
-00018f50: 7469 7665 6c79 2060 6170 706c 6963 6174  tively `applicat
-00018f60: 696f 6e2f 6f63 7465 742d 7374 7265 616d  ion/octet-stream
-00018f70: 6020 746f 5c6e 696e 6469 6361 7465 2074  ` to\nindicate t
-00018f80: 6861 7420 6974 2069 7320 736f 6d65 7468  hat it is someth
-00018f90: 696e 6720 656c 7365 292e 5c6e 5c6e 5468  ing else).\n\nTh
-00018fa0: 6520 6174 7472 6962 7574 6520 6069 6460  e attribute `id`
-00018fb0: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
-00018fc0: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
-00018fd0: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00018fe0: 2075 6e69 7175 6520 4944 206f 6620 7468   unique ID of th
-00018ff0: 655c 6e65 7665 6e74 2074 6861 7420 7761  e\nevent that wa
-00019000: 7320 7265 636f 7264 6564 2e20 506c 6561  s recorded. Plea
-00019010: 7365 206e 6f74 652c 2077 6865 6e20 7265  se note, when re
-00019020: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
-00019030: 6520 7265 7475 726e 6564 2066 726f 6d20  e returned from 
-00019040: 6120 6361 6c6c 5c6e 746f 2060 7265 6164  a call\nto `read
-00019050: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00019060: 6020 696e 2045 7665 6e74 5374 6f72 6544  ` in EventStoreD
-00019070: 4220 7632 312e 3130 2c20 7468 6520 636f  B v21.10, the co
-00019080: 6d6d 6974 2070 6f73 6974 696f 6e20 6973  mmit position is
-00019090: 206e 6f74 2061 6374 7561 6c6c 795c 6e73   not actually\ns
-000190a0: 6574 2069 6e20 7468 6520 7265 7370 6f6e  et in the respon
-000190b0: 7365 2e20 5468 6973 2061 7474 7269 6275  se. This attribu
-000190c0: 7465 2069 7320 7479 7065 6420 6173 2061  te is typed as a
-000190d0: 6e20 6f70 7469 6f6e 616c 2076 616c 7565  n optional value
-000190e0: 2028 604f 7074 696f 6e61 6c5b 5555 4944   (`Optional[UUID
-000190f0: 5d60 292c 5c6e 616e 6420 696e 2074 6865  ]`),\nand in the
-00019100: 2063 6173 6520 6f66 2075 7369 6e67 2045   case of using E
-00019110: 7665 6e74 5374 6f72 6544 4220 7632 312e  ventStoreDB v21.
-00019120: 3130 2074 6865 2076 616c 7565 206f 6620  10 the value of 
-00019130: 7468 6973 2061 7474 7269 6275 7465 2077  this attribute w
-00019140: 696c 6c20 6265 2060 4e6f 6e65 605c 6e77  ill be `None`\nw
-00019150: 6865 6e20 7265 6164 696e 6720 7265 636f  hen reading reco
-00019160: 7264 6564 2065 7665 6e74 7320 6672 6f6d  rded events from
-00019170: 2061 2073 7472 6561 6d2e 2052 6563 6f72   a stream. Recor
-00019180: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
-00019190: 686f 7765 7665 7220 6861 7665 2074 6869  however have thi
-000191a0: 735c 6e76 616c 7565 7320 7365 7420 7768  s\nvalues set wh
-000191b0: 656e 2072 6561 6469 6e67 2072 6563 6f72  en reading recor
-000191c0: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
-000191d0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-000191e0: 2829 6020 616e 6420 6672 6f6d 2062 6f74  ()` and from bot
-000191f0: 685c 6e63 6174 6368 2d75 7020 616e 6420  h\ncatch-up and 
-00019200: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00019210: 7269 7074 696f 6e73 2e5c 6e5c 6e54 6865  riptions.\n\nThe
-00019220: 2061 7474 7269 6275 7465 2060 7374 7265   attribute `stre
-00019230: 616d 5f6e 616d 6560 2069 7320 6120 5079  am_name` is a Py
-00019240: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
-00019250: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00019260: 206e 616d 6520 6f66 2074 6865 5c6e 7374   name of the\nst
-00019270: 7265 616d 2069 6e20 7768 6963 6820 7468  ream in which th
-00019280: 6520 6576 656e 7420 7761 7320 7265 636f  e event was reco
-00019290: 7264 6564 2e5c 6e5c 6e54 6865 2061 7474  rded.\n\nThe att
-000192a0: 7269 6275 7465 2060 7374 7265 616d 5f70  ribute `stream_p
-000192b0: 6f73 6974 696f 6e60 2069 7320 6120 5079  osition` is a Py
-000192c0: 7468 6f6e 2060 696e 7460 2c20 7573 6564  thon `int`, used
-000192d0: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-000192e0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-000192f0: 5c6e 7374 7265 616d 2061 7420 7768 6963  \nstream at whic
-00019300: 6820 7468 6520 6576 656e 7420 7761 7320  h the event was 
-00019310: 7265 636f 7264 6564 2e5c 6e5c 6e54 6865  recorded.\n\nThe
-00019320: 2061 7474 7269 6275 7465 2060 636f 6d6d   attribute `comm
-00019330: 6974 5f70 6f73 6974 696f 6e60 2069 7320  it_position` is 
-00019340: 6120 5079 7468 6f6e 2060 696e 7460 2c20  a Python `int`, 
-00019350: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-00019360: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
-00019370: 7469 6f6e 5c6e 6174 2077 6869 6368 2074  tion\nat which t
-00019380: 6865 2065 7665 6e74 2077 6173 2072 6563  he event was rec
-00019390: 6f72 6465 642e 5c6e 5c6e 6060 6070 7974  orded.\n\n```pyt
-000193a0: 686f 6e5c 6e66 726f 6d20 6573 6462 636c  hon\nfrom esdbcl
-000193b0: 6965 6e74 2e65 7665 6e74 7320 696d 706f  ient.events impo
-000193c0: 7274 2052 6563 6f72 6465 6445 7665 6e74  rt RecordedEvent
-000193d0: 5c6e 5c6e 7265 636f 7264 6564 5f65 7665  \n\nrecorded_eve
-000193e0: 6e74 203d 2052 6563 6f72 6465 6445 7665  nt = RecordedEve
-000193f0: 6e74 285c 6e20 2020 2074 7970 653d 5c27  nt(\n    type=\'
-00019400: 4f72 6465 7243 7265 6174 6564 5c27 2c5c  OrderCreated\',\
-00019410: 6e20 2020 2064 6174 613d 625c 277b 7d5c  n    data=b\'{}\
-00019420: 272c 5c6e 2020 2020 6d65 7461 6461 7461  ',\n    metadata
-00019430: 3d62 5c27 5c27 2c5c 6e20 2020 2063 6f6e  =b\'\',\n    con
-00019440: 7465 6e74 5f74 7970 653d 5c27 6170 706c  tent_type=\'appl
-00019450: 6963 6174 696f 6e2f 6a73 6f6e 5c27 2c5c  ication/json\',\
-00019460: 6e20 2020 2069 643d 7575 6964 3428 292c  n    id=uuid4(),
-00019470: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
-00019480: 653d 5c27 7374 7265 616d 315c 272c 5c6e  e=\'stream1\',\n
-00019490: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
-000194a0: 696f 6e3d 302c 5c6e 2020 2020 636f 6d6d  ion=0,\n    comm
-000194b0: 6974 5f70 6f73 6974 696f 6e3d 3531 322c  it_position=512,
-000194c0: 5c6e 295c 6e60 6060 5c6e 5c6e 2323 2320  \n)\n```\n\n### 
-000194d0: 4173 796e 6369 6f20 636c 6965 6e74 5c6e  Asyncio client\n
-000194e0: 5c6e 5468 6520 6065 7364 6263 6c69 656e  \nThe `esdbclien
-000194f0: 7460 2070 6163 6b61 6765 2061 6c73 6f20  t` package also 
-00019500: 696e 636c 7564 6573 2061 6e20 6561 726c  includes an earl
-00019510: 7920 7665 7273 696f 6e20 6f66 2061 6e20  y version of an 
-00019520: 6173 796e 6368 726f 6e6f 7573 2049 2f4f  asynchronous I/O
-00019530: 5c6e 6752 5043 2050 7974 686f 6e20 636c  \ngRPC Python cl
-00019540: 6965 6e74 2e20 4974 2066 6f6c 6c6f 7773  ient. It follows
-00019550: 2065 7861 6374 6c79 2074 6865 2073 616d   exactly the sam
-00019560: 6520 6265 6861 7669 6f72 7320 6173 2074  e behaviors as t
-00019570: 6865 206d 756c 7469 7468 7265 6164 6564  he multithreaded
-00019580: 5c6e 6045 5344 4243 6c69 656e 7460 2c20  \n`ESDBClient`, 
-00019590: 6275 7420 7573 6573 2074 6865 2060 6772  but uses the `gr
-000195a0: 7063 2e61 696f 6020 7061 636b 6167 6520  pc.aio` package 
-000195b0: 616e 6420 7468 6520 6061 7379 6e63 696f  and the `asyncio
-000195c0: 6020 6d6f 6475 6c65 2c20 696e 7374 6561  ` module, instea
-000195d0: 6420 6f66 5c6e 6067 7270 6360 2061 6e64  d of\n`grpc` and
-000195e0: 2060 7468 7265 6164 696e 6760 2e5c 6e5c   `threading`.\n\
-000195f0: 6e54 6865 2060 6173 796e 6360 2066 756e  nThe `async` fun
-00019600: 6374 696f 6e20 6041 7379 6e63 696f 4553  ction `AsyncioES
-00019610: 4442 436c 6965 6e74 6020 636f 6e73 7472  DBClient` constr
-00019620: 7563 7473 2074 6865 2063 6c69 656e 742c  ucts the client,
-00019630: 2061 6e64 2063 6f6e 6e65 6374 7320 746f   and connects to
-00019640: 5c6e 6120 7365 7276 6572 2e20 4974 2063  \na server. It c
-00019650: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
-00019660: 726f 6d20 6065 7364 6263 6c69 656e 7460  rom `esdbclient`
-00019670: 2c20 616e 6420 6361 6e20 6265 2063 616c  , and can be cal
-00019680: 6c65 6420 7769 7468 2074 6865 2073 616d  led with the sam
-00019690: 655c 6e61 7267 756d 656e 7473 2061 7320  e\narguments as 
-000196a0: 6045 5344 4243 6c69 656e 7460 2e20 4974  `ESDBClient`. It
-000196b0: 2073 7570 706f 7274 7320 626f 7468 2074   supports both t
-000196c0: 6865 2022 6573 6462 2220 616e 6420 7468  he "esdb" and th
-000196d0: 6520 2265 7364 622b 6469 7363 6f76 6572  e "esdb+discover
-000196e0: 225c 6e63 6f6e 6e65 6374 696f 6e20 7374  "\nconnection st
-000196f0: 7269 6e67 2055 5249 2073 6368 656d 6573  ring URI schemes
-00019700: 2c20 616e 6420 7265 636f 6e6e 6563 7473  , and reconnects
-00019710: 2061 6e64 2072 6574 7269 6573 206d 6574   and retries met
-00019720: 686f 6473 2077 6865 6e20 636f 6e6e 6563  hods when connec
-00019730: 7469 6f6e 5c6e 6973 7375 6573 2061 7265  tion\nissues are
-00019740: 2065 6e63 6f75 6e74 6572 6564 2c20 6a75   encountered, ju
-00019750: 7374 206c 696b 6520 6045 5344 4243 6c69  st like `ESDBCli
-00019760: 656e 7460 2e5c 6e5c 6e60 6060 7079 7468  ent`.\n\n```pyth
-00019770: 6f6e 5c6e 6672 6f6d 2065 7364 6263 6c69  on\nfrom esdbcli
-00019780: 656e 7420 696d 706f 7274 2041 7379 6e63  ent import Async
-00019790: 696f 4553 4442 436c 6965 6e74 5c6e 6060  ioESDBClient\n``
-000197a0: 605c 6e5c 6e54 6865 2061 7379 6e63 6872  `\n\nThe asynchr
-000197b0: 6f6e 6f75 7320 492f 4f20 636c 6965 6e74  onous I/O client
-000197c0: 2068 6173 2060 6173 796e 6360 206d 6574   has `async` met
-000197d0: 686f 6473 2060 6170 7065 6e64 5f65 7665  hods `append_eve
-000197e0: 6e74 7328 2960 2c5c 6e60 7265 6164 5f73  nts()`,\n`read_s
-000197f0: 7472 6561 6d5f 6576 656e 7473 2829 602c  tream_events()`,
-00019800: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
-00019810: 7328 2960 2c20 6073 7562 7363 7269 6265  s()`, `subscribe
-00019820: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c5c  _all_events()`,\
-00019830: 6e60 6465 6c65 7465 5f73 7472 6561 6d28  n`delete_stream(
-00019840: 2960 2c20 6074 6f6d 6273 746f 6e65 5f73  )`, `tombstone_s
-00019850: 7472 6561 6d28 2960 2c20 616e 6420 6072  tream()`, and `r
-00019860: 6563 6f6e 6e65 6374 2829 602e 5c6e 5c6e  econnect()`.\n\n
-00019870: 5468 6573 6520 6d65 7468 6f64 7320 6172  These methods ar
-00019880: 6520 6571 7569 7661 6c65 6e74 2074 6f20  e equivalent to 
-00019890: 7468 6520 6d65 7468 6f64 7320 6f6e 2060  the methods on `
-000198a0: 4553 4442 436c 6965 6e74 602e 2054 6865  ESDBClient`. The
-000198b0: 7920 6861 7665 2074 6865 2073 616d 655c  y have the same\
-000198c0: 6e6d 6574 686f 6420 7369 676e 6174 7572  nmethod signatur
-000198d0: 6573 2c20 616e 6420 6361 6e20 6265 2063  es, and can be c
-000198e0: 616c 6c65 6420 7769 7468 2074 6865 2073  alled with the s
-000198f0: 616d 6520 6172 6775 6d65 6e74 732c 2074  ame arguments, t
-00019900: 6f20 7468 6520 7361 6d65 2065 6666 6563  o the same effec
-00019910: 742e 5c6e 5468 6520 6d65 7468 6f64 7320  t.\nThe methods 
-00019920: 7768 6963 6820 6170 7065 6172 206f 6e20  which appear on 
-00019930: 6045 5344 4243 6c69 656e 7460 2062 7574  `ESDBClient` but
-00019940: 206e 6f74 206f 6e20 6041 7379 6e63 696f   not on `Asyncio
-00019950: 4553 4442 436c 6965 6e74 6020 7769 6c6c  ESDBClient` will
-00019960: 2062 655c 6e61 6464 6564 2073 6f6f 6e2e   be\nadded soon.
-00019970: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-00019980: 6265 6c6f 7720 6465 6d6f 6e73 7472 6174  below demonstrat
-00019990: 6573 2074 6865 2060 6170 7065 6e64 5f65  es the `append_e
-000199a0: 7665 6e74 7328 2960 2c20 6072 6561 645f  vents()`, `read_
-000199b0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-000199c0: 2061 6e64 5c6e 6073 7562 7363 7269 6265   and\n`subscribe
-000199d0: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
-000199e0: 6574 686f 6473 2e20 5468 6573 6520 6172  ethods. These ar
-000199f0: 6520 7468 6520 6d6f 7374 2075 7365 6675  e the most usefu
-00019a00: 6c20 6d65 7468 6f64 7320 666f 7220 7772  l methods for wr
-00019a10: 6974 696e 675c 6e61 6e20 6576 656e 742d  iting\nan event-
-00019a20: 736f 7572 6365 6420 6170 706c 6963 6174  sourced applicat
-00019a30: 696f 6e2c 2061 6c6c 6f77 696e 6720 6e65  ion, allowing ne
-00019a40: 7720 6167 6772 6567 6174 6520 6576 656e  w aggregate even
-00019a50: 7473 2074 6f20 6265 2072 6563 6f72 6465  ts to be recorde
-00019a60: 642c 2074 6865 5c6e 7265 636f 7264 6564  d, the\nrecorded
-00019a70: 2065 7665 6e74 7320 6f66 2061 6e20 6167   events of an ag
-00019a80: 6772 6567 6174 6520 746f 2062 6520 6f62  gregate to be ob
-00019a90: 7461 696e 6564 2073 6f20 6167 6772 6567  tained so aggreg
-00019aa0: 6174 6573 2063 616e 2062 6520 7265 636f  ates can be reco
-00019ab0: 6e73 7472 7563 7465 642c 5c6e 616e 6420  nstructed,\nand 
-00019ac0: 7468 6520 7374 6174 6520 6f66 2061 6e20  the state of an 
-00019ad0: 6170 706c 6963 6174 696f 6e20 746f 2070  application to p
-00019ae0: 726f 7061 6761 7465 6420 616e 6420 7072  ropagated and pr
-00019af0: 6f63 6573 7365 6420 7769 7468 2022 6578  ocessed with "ex
-00019b00: 6163 746c 792d 6f6e 6365 225c 6e73 656d  actly-once"\nsem
-00019b10: 616e 7469 6373 2e5c 6e5c 6e60 6060 7079  antics.\n\n```py
-00019b20: 7468 6f6e 5c6e 696d 706f 7274 2061 7379  thon\nimport asy
-00019b30: 6e63 696f 5c6e 5c6e 6173 796e 6320 6465  ncio\n\nasync de
-00019b40: 6620 6465 6d6f 6e73 7472 6174 655f 6173  f demonstrate_as
-00019b50: 796e 6369 6f5f 636c 6965 6e74 2829 3a5c  yncio_client():\
-00019b60: 6e5c 6e20 2020 2023 2043 6f6e 7374 7275  n\n    # Constru
-00019b70: 6374 2063 6c69 656e 742e 5c6e 2020 2020  ct client.\n    
-00019b80: 636c 6965 6e74 203d 2061 7761 6974 2041  client = await A
-00019b90: 7379 6e63 696f 4553 4442 436c 6965 6e74  syncioESDBClient
-00019ba0: 285c 6e20 2020 2020 2020 2075 7269 3d6f  (\n        uri=o
-00019bb0: 732e 6765 7465 6e76 2822 4553 4442 5f55  s.getenv("ESDB_U
-00019bc0: 5249 2229 2c5c 6e20 2020 2020 2020 2072  RI"),\n        r
-00019bd0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-00019be0: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
-00019bf0: 5f52 4f4f 545f 4345 5254 4946 4943 4154  _ROOT_CERTIFICAT
-00019c00: 4553 2229 2c5c 6e20 2020 2029 5c6e 5c6e  ES"),\n    )\n\n
-00019c10: 2020 2020 2320 4170 7065 6e64 2065 7665      # Append eve
-00019c20: 6e74 732e 5c6e 2020 2020 7374 7265 616d  nts.\n    stream
-00019c30: 5f6e 616d 6520 3d20 7374 7228 7575 6964  _name = str(uuid
-00019c40: 3428 2929 5c6e 2020 2020 6576 656e 7431  4())\n    event1
-00019c50: 203d 204e 6577 4576 656e 7428 224f 7264   = NewEvent("Ord
-00019c60: 6572 4372 6561 7465 6422 2c20 6461 7461  erCreated", data
-00019c70: 3d62 5c27 7b7d 5c27 295c 6e20 2020 2065  =b\'{}\')\n    e
-00019c80: 7665 6e74 3220 3d20 4e65 7745 7665 6e74  vent2 = NewEvent
-00019c90: 2822 4f72 6465 7255 7064 6174 6564 222c  ("OrderUpdated",
-00019ca0: 2064 6174 613d 625c 277b 7d5c 2729 5c6e   data=b\'{}\')\n
-00019cb0: 2020 2020 6576 656e 7433 203d 204e 6577      event3 = New
-00019cc0: 4576 656e 7428 224f 7264 6572 4465 6c65  Event("OrderDele
-00019cd0: 7465 6422 2c20 6461 7461 3d62 5c27 7b7d  ted", data=b\'{}
-00019ce0: 5c27 295c 6e5c 6e20 2020 2061 7761 6974  \')\n\n    await
-00019cf0: 2063 6c69 656e 742e 6170 7065 6e64 5f65   client.append_e
-00019d00: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
-00019d10: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00019d20: 616d 5f6e 616d 652c 5c6e 2020 2020 2020  am_name,\n      
-00019d30: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
-00019d40: 696f 6e3d 4e6f 6e65 2c5c 6e20 2020 2020  ion=None,\n     
-00019d50: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-00019d60: 312c 2065 7665 6e74 322c 2065 7665 6e74  1, event2, event
-00019d70: 335d 5c6e 2020 2020 295c 6e5c 6e20 2020  3]\n    )\n\n   
-00019d80: 2023 2052 6561 6420 7374 7265 616d 2065   # Read stream e
-00019d90: 7665 6e74 732e 5c6e 2020 2020 7265 636f  vents.\n    reco
-00019da0: 7264 6564 203d 2061 7761 6974 2063 6c69  rded = await cli
-00019db0: 656e 742e 7265 6164 5f73 7472 6561 6d5f  ent.read_stream_
-00019dc0: 6576 656e 7473 2873 7472 6561 6d5f 6e61  events(stream_na
-00019dd0: 6d65 295c 6e20 2020 2061 7373 6572 7420  me)\n    assert 
-00019de0: 6c65 6e28 7265 636f 7264 6564 2920 3d3d  len(recorded) ==
-00019df0: 2033 5c6e 2020 2020 6173 7365 7274 2072   3\n    assert r
-00019e00: 6563 6f72 6465 645b 305d 2e69 6420 3d3d  ecorded[0].id ==
-00019e10: 2065 7665 6e74 312e 6964 5c6e 2020 2020   event1.id\n    
-00019e20: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
-00019e30: 315d 2e69 6420 3d3d 2065 7665 6e74 322e  1].id == event2.
-00019e40: 6964 5c6e 2020 2020 6173 7365 7274 2072  id\n    assert r
-00019e50: 6563 6f72 6465 645b 325d 2e69 6420 3d3d  ecorded[2].id ==
-00019e60: 2065 7665 6e74 332e 6964 5c6e 5c6e 5c6e   event3.id\n\n\n
-00019e70: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
-00019e80: 616c 6c20 6576 656e 7473 2e5c 6e20 2020  all events.\n   
-00019e90: 2072 6563 6569 7665 6420 3d20 5b5d 5c6e   received = []\n
-00019ea0: 2020 2020 6173 796e 6320 666f 7220 6576      async for ev
-00019eb0: 656e 7420 696e 2061 7761 6974 2063 6c69  ent in await cli
-00019ec0: 656e 742e 7375 6273 6372 6962 655f 616c  ent.subscribe_al
-00019ed0: 6c5f 6576 656e 7473 2829 3a5c 6e20 2020  l_events():\n   
-00019ee0: 2020 2020 2072 6563 6569 7665 642e 6170       received.ap
-00019ef0: 7065 6e64 2865 7665 6e74 295c 6e20 2020  pend(event)\n   
-00019f00: 2020 2020 2069 6620 6576 656e 742e 6964       if event.id
-00019f10: 203d 3d20 6576 656e 7433 2e69 643a 5c6e   == event3.id:\n
-00019f20: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00019f30: 6b5c 6e20 2020 2061 7373 6572 7420 7265  k\n    assert re
-00019f40: 6365 6976 6564 5b2d 335d 2e69 6420 3d3d  ceived[-3].id ==
-00019f50: 2065 7665 6e74 312e 6964 5c6e 2020 2020   event1.id\n    
-00019f60: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00019f70: 2d32 5d2e 6964 203d 3d20 6576 656e 7432  -2].id == event2
-00019f80: 2e69 645c 6e20 2020 2061 7373 6572 7420  .id\n    assert 
-00019f90: 7265 6365 6976 6564 5b2d 315d 2e69 6420  received[-1].id 
-00019fa0: 3d3d 2065 7665 6e74 332e 6964 5c6e 5c6e  == event3.id\n\n
-00019fb0: 5c6e 2020 2020 2320 436c 6f73 6520 7468  \n    # Close th
-00019fc0: 6520 636c 6965 6e74 2e5c 6e20 2020 2061  e client.\n    a
-00019fd0: 7761 6974 2063 6c69 656e 742e 636c 6f73  wait client.clos
-00019fe0: 6528 295c 6e5c 6e5c 6e23 2052 756e 2074  e()\n\n\n# Run t
-00019ff0: 6865 2064 656d 6f2e 5c6e 6173 796e 6369  he demo.\nasynci
-0001a000: 6f2e 6765 745f 6576 656e 745f 6c6f 6f70  o.get_event_loop
-0001a010: 2829 2e72 756e 5f75 6e74 696c 5f63 6f6d  ().run_until_com
-0001a020: 706c 6574 6528 5c6e 2020 2020 6465 6d6f  plete(\n    demo
-0001a030: 6e73 7472 6174 655f 6173 796e 6369 6f5f  nstrate_asyncio_
-0001a040: 636c 6965 6e74 2829 5c6e 295c 6e60 6060  client()\n)\n```
-0001a050: 5c6e 5c6e 2323 2043 6f6e 7472 6962 7574  \n\n## Contribut
-0001a060: 6f72 735c 6e5c 6e23 2323 2049 6e73 7461  ors\n\n### Insta
-0001a070: 6c6c 2050 6f65 7472 795c 6e5c 6e54 6865  ll Poetry\n\nThe
-0001a080: 2066 6972 7374 2074 6869 6e67 2069 7320   first thing is 
-0001a090: 746f 2063 6865 636b 2079 6f75 2068 6176  to check you hav
-0001a0a0: 6520 506f 6574 7279 2069 6e73 7461 6c6c  e Poetry install
-0001a0b0: 6564 2e5c 6e5c 6e20 2020 2024 2070 6f65  ed.\n\n    $ poe
-0001a0c0: 7472 7920 2d2d 7665 7273 696f 6e5c 6e5c  try --version\n\
-0001a0d0: 6e49 6620 796f 7520 646f 6e5c 2774 2c20  nIf you don\'t, 
-0001a0e0: 7468 656e 2070 6c65 6173 6520 5b69 6e73  then please [ins
-0001a0f0: 7461 6c6c 2050 6f65 7472 795d 2868 7474  tall Poetry](htt
-0001a100: 7073 3a2f 2f70 7974 686f 6e2d 706f 6574  ps://python-poet
-0001a110: 7279 2e6f 7267 2f64 6f63 732f 2369 6e73  ry.org/docs/#ins
-0001a120: 7461 6c6c 696e 672d 7769 7468 2d74 6865  talling-with-the
-0001a130: 2d6f 6666 6963 6961 6c2d 696e 7374 616c  -official-instal
-0001a140: 6c65 7229 2e5c 6e5c 6e20 2020 2024 2063  ler).\n\n    $ c
-0001a150: 7572 6c20 2d73 534c 2068 7474 7073 3a2f  url -sSL https:/
-0001a160: 2f69 6e73 7461 6c6c 2e70 7974 686f 6e2d  /install.python-
-0001a170: 706f 6574 7279 2e6f 7267 207c 2070 7974  poetry.org | pyt
-0001a180: 686f 6e33 202d 5c6e 5c6e 4974 2077 696c  hon3 -\n\nIt wil
-0001a190: 6c20 6865 6c70 2074 6f20 6d61 6b65 2073  l help to make s
-0001a1a0: 7572 6520 506f 6574 7279 5c27 7320 6269  ure Poetry\'s bi
-0001a1b0: 6e20 6469 7265 6374 6f72 7920 6973 2069  n directory is i
-0001a1c0: 6e20 796f 7572 2060 5041 5448 6020 656e  n your `PATH` en
-0001a1d0: 7669 726f 6e6d 656e 7420 7661 7269 6162  vironment variab
-0001a1e0: 6c65 2e5c 6e5c 6e42 7574 2069 6e20 616e  le.\n\nBut in an
-0001a1f0: 7920 6361 7365 2c20 6d61 6b65 2073 7572  y case, make sur
-0001a200: 6520 796f 7520 6b6e 6f77 2074 6865 2070  e you know the p
-0001a210: 6174 6820 746f 2074 6865 2060 706f 6574  ath to the `poet
-0001a220: 7279 6020 6578 6563 7574 6162 6c65 2e20  ry` executable. 
-0001a230: 5468 6520 506f 6574 7279 5c6e 696e 7374  The Poetry\ninst
-0001a240: 616c 6c65 7220 7465 6c6c 7320 796f 7520  aller tells you 
-0001a250: 7768 6572 6520 6974 2068 6173 2062 6565  where it has bee
-0001a260: 6e20 696e 7374 616c 6c65 642c 2061 6e64  n installed, and
-0001a270: 2068 6f77 2074 6f20 636f 6e66 6967 7572   how to configur
-0001a280: 6520 796f 7572 2073 6865 6c6c 2e5c 6e5c  e your shell.\n\
-0001a290: 6e50 6c65 6173 6520 7265 6665 7220 746f  nPlease refer to
-0001a2a0: 2074 6865 205b 506f 6574 7279 2064 6f63   the [Poetry doc
-0001a2b0: 735d 2868 7474 7073 3a2f 2f70 7974 686f  s](https://pytho
-0001a2c0: 6e2d 706f 6574 7279 2e6f 7267 2f64 6f63  n-poetry.org/doc
-0001a2d0: 732f 2920 666f 7220 6775 6964 616e 6365  s/) for guidance
-0001a2e0: 206f 6e5c 6e75 7369 6e67 2050 6f65 7472   on\nusing Poetr
-0001a2f0: 792e 5c6e 5c6e 2323 2320 5365 7475 7020  y.\n\n### Setup 
-0001a300: 666f 7220 5079 4368 6172 6d20 7573 6572  for PyCharm user
-0001a310: 735c 6e5c 6e59 6f75 2063 616e 2065 6173  s\n\nYou can eas
-0001a320: 696c 7920 6f62 7461 696e 2074 6865 2070  ily obtain the p
-0001a330: 726f 6a65 6374 2066 696c 6573 2075 7369  roject files usi
-0001a340: 6e67 2050 7943 6861 726d 2028 6d65 6e75  ng PyCharm (menu
-0001a350: 2022 4769 7420 3e20 436c 6f6e 652e 2e2e   "Git > Clone...
-0001a360: 2229 2e5c 6e50 7943 6861 726d 2077 696c  ").\nPyCharm wil
-0001a370: 6c20 7468 656e 2075 7375 616c 6c79 2070  l then usually p
-0001a380: 726f 6d70 7420 796f 7520 746f 206f 7065  rompt you to ope
-0001a390: 6e20 7468 6520 7072 6f6a 6563 742e 5c6e  n the project.\n
-0001a3a0: 5c6e 4f70 656e 2074 6865 2070 726f 6a65  \nOpen the proje
-0001a3b0: 6374 2069 6e20 6120 6e65 7720 7769 6e64  ct in a new wind
-0001a3c0: 6f77 2e20 5079 4368 6172 6d20 7769 6c6c  ow. PyCharm will
-0001a3d0: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
-0001a3e0: 6f6d 7074 2079 6f75 2074 6f20 6372 6561  ompt you to crea
-0001a3f0: 7465 5c6e 6120 6e65 7720 7669 7274 7561  te\na new virtua
-0001a400: 6c20 656e 7669 726f 6e6d 656e 742e 5c6e  l environment.\n
-0001a410: 5c6e 4372 6561 7465 2061 206e 6577 2050  \nCreate a new P
-0001a420: 6f65 7472 7920 7669 7274 7561 6c20 656e  oetry virtual en
-0001a430: 7669 726f 6e6d 656e 7420 666f 7220 7468  vironment for th
-0001a440: 6520 7072 6f6a 6563 742e 2049 6620 5079  e project. If Py
-0001a450: 4368 6172 6d20 646f 6573 6e5c 2774 2061  Charm doesn\'t a
-0001a460: 6c72 6561 6479 5c6e 6b6e 6f77 2077 6865  lready\nknow whe
-0001a470: 7265 2079 6f75 7220 6070 6f65 7472 7960  re your `poetry`
-0001a480: 2065 7865 6375 7461 626c 6520 6973 2c20   executable is, 
-0001a490: 7468 656e 2073 6574 2074 6865 2070 6174  then set the pat
-0001a4a0: 6820 746f 2079 6f75 7220 6070 6f65 7472  h to your `poetr
-0001a4b0: 7960 2065 7865 6375 7461 626c 655c 6e69  y` executable\ni
-0001a4c0: 6e20 7468 6520 224e 6577 2050 6f65 7472  n the "New Poetr
-0001a4d0: 7920 456e 7669 726f 6e6d 656e 7422 2066  y Environment" f
-0001a4e0: 6f72 6d20 696e 7075 7420 6669 656c 6420  orm input field 
-0001a4f0: 6c61 6265 6c6c 6564 2022 506f 6574 7279  labelled "Poetry
-0001a500: 2065 7865 6375 7461 626c 6522 2e20 496e   executable". In
-0001a510: 2074 6865 5c6e 224e 6577 2050 6f65 7472   the\n"New Poetr
-0001a520: 7920 456e 7669 726f 6e6d 656e 7422 2066  y Environment" f
-0001a530: 6f72 6d2c 2079 6f75 2077 696c 6c20 616c  orm, you will al
-0001a540: 736f 2068 6176 6520 7468 6520 6f70 706f  so have the oppo
-0001a550: 7274 756e 6974 7920 746f 2073 656c 6563  rtunity to selec
-0001a560: 7420 7768 6963 685c 6e50 7974 686f 6e20  t which\nPython 
-0001a570: 6578 6563 7574 6162 6c65 2077 696c 6c20  executable will 
-0001a580: 6265 2075 7365 6420 6279 2074 6865 2076  be used by the v
-0001a590: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-0001a5a0: 6e74 2e5c 6e5c 6e50 7943 6861 726d 2077  nt.\n\nPyCharm w
-0001a5b0: 696c 6c20 7468 656e 2063 7265 6174 6520  ill then create 
-0001a5c0: 6120 6e65 7720 506f 6574 7279 2076 6972  a new Poetry vir
-0001a5d0: 7475 616c 2065 6e76 6972 6f6e 6d65 6e74  tual environment
-0001a5e0: 2066 6f72 2079 6f75 7220 7072 6f6a 6563   for your projec
-0001a5f0: 742c 2075 7369 6e67 5c6e 6120 7061 7274  t, using\na part
-0001a600: 6963 756c 6172 2076 6572 7369 6f6e 206f  icular version o
-0001a610: 6620 5079 7468 6f6e 2c20 616e 6420 616c  f Python, and al
-0001a620: 736f 2069 6e73 7461 6c6c 2069 6e74 6f20  so install into 
-0001a630: 7468 6973 2076 6972 7475 616c 2065 6e76  this virtual env
-0001a640: 6972 6f6e 6d65 6e74 2074 6865 5c6e 7072  ironment the\npr
-0001a650: 6f6a 6563 745c 2773 2070 6163 6b61 6765  oject\'s package
-0001a660: 2064 6570 656e 6465 6e63 6965 7320 6163   dependencies ac
-0001a670: 636f 7264 696e 6720 746f 2074 6865 2070  cording to the p
-0001a680: 726f 6a65 6374 5c27 7320 6070 6f65 7472  roject\'s `poetr
-0001a690: 792e 6c6f 636b 6020 6669 6c65 2e5c 6e5c  y.lock` file.\n\
-0001a6a0: 6e59 6f75 2063 616e 2061 6464 2064 6966  nYou can add dif
-0001a6b0: 6665 7265 6e74 2050 6f65 7472 7920 656e  ferent Poetry en
-0001a6c0: 7669 726f 6e6d 656e 7473 2066 6f72 2064  vironments for d
-0001a6d0: 6966 6665 7265 6e74 2050 7974 686f 6e20  ifferent Python 
-0001a6e0: 7665 7273 696f 6e73 2c20 616e 6420 7377  versions, and sw
-0001a6f0: 6974 6368 5c6e 6265 7477 6565 6e20 7468  itch\nbetween th
-0001a700: 656d 2075 7369 6e67 2074 6865 2022 5079  em using the "Py
-0001a710: 7468 6f6e 2049 6e74 6572 7072 6574 6572  thon Interpreter
-0001a720: 2220 7365 7474 696e 6773 206f 6620 5079  " settings of Py
-0001a730: 4368 6172 6d2e 2049 6620 796f 7520 7761  Charm. If you wa
-0001a740: 6e74 2074 6f20 7573 655c 6e61 2076 6572  nt to use\na ver
-0001a750: 7369 6f6e 206f 6620 5079 7468 6f6e 2074  sion of Python t
-0001a760: 6861 7420 6973 6e5c 2774 2069 6e73 7461  hat isn\'t insta
-0001a770: 6c6c 6564 2c20 6569 7468 6572 2075 7365  lled, either use
-0001a780: 2079 6f75 7220 6661 766f 7572 6974 6520   your favourite 
-0001a790: 7061 636b 6167 6520 6d61 6e61 6765 722c  package manager,
-0001a7a0: 5c6e 6f72 2069 6e73 7461 6c6c 2050 7974  \nor install Pyt
-0001a7b0: 686f 6e20 6279 2064 6f77 6e6c 6f61 6469  hon by downloadi
-0001a7c0: 6e67 2061 6e20 696e 7374 616c 6c65 7220  ng an installer 
-0001a7d0: 666f 7220 7265 6365 6e74 2076 6572 7369  for recent versi
-0001a7e0: 6f6e 7320 6f66 2050 7974 686f 6e20 6469  ons of Python di
-0001a7f0: 7265 6374 6c79 5c6e 6672 6f6d 2074 6865  rectly\nfrom the
-0001a800: 205b 5079 7468 6f6e 2077 6562 7369 7465   [Python website
-0001a810: 5d28 6874 7470 733a 2f2f 7777 772e 7079  ](https://www.py
-0001a820: 7468 6f6e 2e6f 7267 2f64 6f77 6e6c 6f61  thon.org/downloa
-0001a830: 6473 2f29 2e5c 6e5c 6e4f 6e63 6520 7072  ds/).\n\nOnce pr
-0001a840: 6f6a 6563 7420 6465 7065 6e64 656e 6369  oject dependenci
-0001a850: 6573 2068 6176 6520 6265 656e 2069 6e73  es have been ins
-0001a860: 7461 6c6c 6564 2c20 796f 7520 7368 6f75  talled, you shou
-0001a870: 6c64 2062 6520 6162 6c65 2074 6f20 7275  ld be able to ru
-0001a880: 6e20 7465 7374 735c 6e66 726f 6d20 7769  n tests\nfrom wi
-0001a890: 7468 696e 2050 7943 6861 726d 2028 7269  thin PyCharm (ri
-0001a8a0: 6768 742d 636c 6963 6b20 6f6e 2074 6865  ght-click on the
-0001a8b0: 2060 7465 7374 7360 2066 6f6c 6465 7220   `tests` folder 
-0001a8c0: 616e 6420 7365 6c65 6374 2074 6865 205c  and select the \
-0001a8d0: 2752 756e 5c27 206f 7074 696f 6e29 2e5c  'Run\' option).\
-0001a8e0: 6e5c 6e42 6563 6175 7365 206f 6620 6120  n\nBecause of a 
-0001a8f0: 636f 6e66 6c69 6374 2062 6574 7765 656e  conflict between
-0001a900: 2070 7974 6573 7420 616e 6420 5079 4368   pytest and PyCh
-0001a910: 6172 6d5c 2773 2064 6562 7567 6765 7220  arm\'s debugger 
-0001a920: 616e 6420 7468 6520 636f 7665 7261 6765  and the coverage
-0001a930: 2074 6f6f 6c2c 5c6e 796f 7520 6d61 7920   tool,\nyou may 
-0001a940: 6e65 6564 2074 6f20 6164 6420 6060 2d2d  need to add ``--
-0001a950: 6e6f 2d63 6f76 6060 2061 7320 616e 206f  no-cov`` as an o
-0001a960: 7074 696f 6e20 746f 2074 6865 2074 6573  ption to the tes
-0001a970: 7420 7275 6e6e 6572 2074 656d 706c 6174  t runner templat
-0001a980: 652e 2041 6c74 6572 6e61 7469 7665 6c79  e. Alternatively
-0001a990: 2c5c 6e6a 7573 7420 7573 6520 7468 6520  ,\njust use the 
-0001a9a0: 5079 7468 6f6e 2053 7461 6e64 6172 6420  Python Standard 
-0001a9b0: 4c69 6272 6172 795c 2773 2060 6075 6e69  Library\'s ``uni
-0001a9c0: 7474 6573 7460 6020 6d6f 6475 6c65 2e5c  ttest`` module.\
-0001a9d0: 6e5c 6e59 6f75 2073 686f 756c 6420 616c  n\nYou should al
-0001a9e0: 736f 2062 6520 6162 6c65 2074 6f20 6f70  so be able to op
-0001a9f0: 656e 2061 2074 6572 6d69 6e61 6c20 7769  en a terminal wi
-0001aa00: 6e64 6f77 2069 6e20 5079 4368 6172 6d2c  ndow in PyCharm,
-0001aa10: 2061 6e64 2072 756e 2074 6865 2070 726f   and run the pro
-0001aa20: 6a65 6374 5c27 735c 6e4d 616b 6566 696c  ject\'s\nMakefil
-0001aa30: 6520 636f 6d6d 616e 6473 2066 726f 6d20  e commands from 
-0001aa40: 7468 6520 636f 6d6d 616e 6420 6c69 6e65  the command line
-0001aa50: 2028 7365 6520 6265 6c6f 7729 2e5c 6e5c   (see below).\n\
-0001aa60: 6e23 2323 2053 6574 7570 2066 726f 6d20  n### Setup from 
-0001aa70: 636f 6d6d 616e 6420 6c69 6e65 5c6e 5c6e  command line\n\n
-0001aa80: 4f62 7461 696e 2074 6865 2070 726f 6a65  Obtain the proje
-0001aa90: 6374 2066 696c 6573 2c20 7573 696e 6720  ct files, using 
-0001aaa0: 4769 7420 6f72 2073 7569 7461 626c 6520  Git or suitable 
-0001aab0: 616c 7465 726e 6174 6976 652e 5c6e 5c6e  alternative.\n\n
-0001aac0: 496e 2061 2074 6572 6d69 6e61 6c20 6170  In a terminal ap
-0001aad0: 706c 6963 6174 696f 6e2c 2063 6861 6e67  plication, chang
-0001aae0: 6520 796f 7572 2063 7572 7265 6e74 2077  e your current w
-0001aaf0: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
-0001ab00: 5c6e 746f 2074 6865 2072 6f6f 7420 666f  \nto the root fo
-0001ab10: 6c64 6572 206f 6620 7468 6520 7072 6f6a  lder of the proj
-0001ab20: 6563 7420 6669 6c65 732e 2054 6865 7265  ect files. There
-0001ab30: 2073 686f 756c 6420 6265 2061 204d 616b   should be a Mak
-0001ab40: 6566 696c 655c 6e69 6e20 7468 6973 2066  efile\nin this f
-0001ab50: 6f6c 6465 722e 5c6e 5c6e 5573 6520 7468  older.\n\nUse th
-0001ab60: 6520 4d61 6b65 6669 6c65 2074 6f20 6372  e Makefile to cr
-0001ab70: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
-0001ab80: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
-0001ab90: 6e6d 656e 7420 666f 7220 7468 655c 6e70  nment for the\np
-0001aba0: 726f 6a65 6374 2061 6e64 2069 6e73 7461  roject and insta
-0001abb0: 6c6c 2074 6865 2070 726f 6a65 6374 5c27  ll the project\'
-0001abc0: 7320 7061 636b 6167 6520 6465 7065 6e64  s package depend
-0001abd0: 656e 6369 6573 2069 6e74 6f20 6974 2c5c  encies into it,\
-0001abe0: 6e75 7369 6e67 2074 6865 2066 6f6c 6c6f  nusing the follo
-0001abf0: 7769 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c  wing command.\n\
-0001ac00: 6e20 2020 2024 206d 616b 6520 696e 7374  n    $ make inst
-0001ac10: 616c 6c2d 7061 636b 6167 6573 5c6e 5c6e  all-packages\n\n
-0001ac20: 4974 5c27 7320 616c 736f 2070 6f73 7369  It\'s also possi
-0001ac30: 626c 6520 746f 2061 6c73 6f20 696e 7374  ble to also inst
-0001ac40: 616c 6c20 7468 6520 7072 6f6a 6563 7420  all the project 
-0001ac50: 696e 205c 2765 6469 7461 626c 6520 6d6f  in \'editable mo
-0001ac60: 6465 5c27 2e5c 6e5c 6e20 2020 2024 206d  de\'.\n\n    $ m
-0001ac70: 616b 6520 696e 7374 616c 6c5c 6e5c 6e50  ake install\n\nP
-0001ac80: 6c65 6173 6520 6e6f 7465 2c20 6966 2079  lease note, if y
-0001ac90: 6f75 2063 7265 6174 6520 7468 6520 7669  ou create the vi
-0001aca0: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
-0001acb0: 7420 696e 2074 6869 7320 7761 792c 2061  t in this way, a
-0001acc0: 6e64 2074 6865 6e20 7472 7920 746f 5c6e  nd then try to\n
-0001acd0: 6f70 656e 2074 6865 2070 726f 6a65 6374  open the project
-0001ace0: 2069 6e20 5079 4368 6172 6d20 616e 6420   in PyCharm and 
-0001acf0: 636f 6e66 6967 7572 6520 7468 6520 7072  configure the pr
-0001ad00: 6f6a 6563 7420 746f 2075 7365 2074 6869  oject to use thi
-0001ad10: 7320 7669 7274 7561 6c5c 6e65 6e76 6972  s virtual\nenvir
-0001ad20: 6f6e 6d65 6e74 2061 7320 616e 2022 4578  onment as an "Ex
-0001ad30: 6973 7469 6e67 2050 6f65 7472 7920 456e  isting Poetry En
-0001ad40: 7669 726f 6e6d 656e 7422 2c20 5079 4368  vironment", PyCh
-0001ad50: 6172 6d20 736f 6d65 7469 6d65 7320 6861  arm sometimes ha
-0001ad60: 7320 736f 6d65 5c6e 6973 7375 6573 2028  s some\nissues (
-0001ad70: 646f 6e5c 2774 206b 6e6f 7720 7768 7929  don\'t know why)
-0001ad80: 2077 6869 6368 206d 6967 6874 2062 6520   which might be 
-0001ad90: 7072 6f62 6c65 6d61 7469 632e 2049 6620  problematic. If 
-0001ada0: 796f 7520 656e 636f 756e 7465 7220 7375  you encounter su
-0001adb0: 6368 5c6e 6973 7375 6573 2c20 796f 7520  ch\nissues, you 
-0001adc0: 6361 6e20 7265 736f 6c76 6520 7468 6573  can resolve thes
-0001add0: 6520 6973 7375 6573 2062 7920 6465 6c65  e issues by dele
-0001ade0: 7469 6e67 2074 6865 2076 6972 7475 616c  ting the virtual
-0001adf0: 2065 6e76 6972 6f6e 6d65 6e74 5c6e 616e   environment\nan
-0001ae00: 6420 6372 6561 7469 6e67 2074 6865 2050  d creating the P
-0001ae10: 6f65 7472 7920 7669 7274 7561 6c20 656e  oetry virtual en
-0001ae20: 7669 726f 6e6d 656e 7420 7573 696e 6720  vironment using 
-0001ae30: 5079 4368 6172 6d20 2873 6565 2061 626f  PyCharm (see abo
-0001ae40: 7665 292e 5c6e 5c6e 2323 2320 5072 6f6a  ve).\n\n### Proj
-0001ae50: 6563 7420 4d61 6b65 6669 6c65 2063 6f6d  ect Makefile com
-0001ae60: 6d61 6e64 735c 6e5c 6e59 6f75 2063 616e  mands\n\nYou can
-0001ae70: 2073 7461 7274 2045 7665 6e74 5374 6f72   start EventStor
-0001ae80: 6544 4220 7573 696e 6720 7468 6520 666f  eDB using the fo
-0001ae90: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
-0001aea0: 5c6e 5c6e 2020 2020 2420 6d61 6b65 2073  \n\n    $ make s
-0001aeb0: 7461 7274 2d65 7665 6e74 7374 6f72 6564  tart-eventstored
-0001aec0: 625c 6e5c 6e59 6f75 2063 616e 2072 756e  b\n\nYou can run
-0001aed0: 2074 6573 7473 2075 7369 6e67 2074 6865   tests using the
-0001aee0: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-0001aef0: 6e64 2028 6e65 6564 7320 4576 656e 7453  nd (needs EventS
-0001af00: 746f 7265 4442 2074 6f20 6265 2072 756e  toreDB to be run
-0001af10: 6e69 6e67 292e 5c6e 5c6e 2020 2020 2420  ning).\n\n    $ 
-0001af20: 6d61 6b65 2074 6573 745c 6e5c 6e59 6f75  make test\n\nYou
-0001af30: 2063 616e 2073 746f 7020 4576 656e 7453   can stop EventS
-0001af40: 746f 7265 4442 2075 7369 6e67 2074 6865  toreDB using the
-0001af50: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-0001af60: 6e64 2e5c 6e5c 6e20 2020 2024 206d 616b  nd.\n\n    $ mak
-0001af70: 6520 7374 6f70 2d65 7665 6e74 7374 6f72  e stop-eventstor
-0001af80: 6564 625c 6e5c 6e59 6f75 2063 616e 2063  edb\n\nYou can c
-0001af90: 6865 636b 2074 6865 2066 6f72 6d61 7474  heck the formatt
-0001afa0: 696e 6720 6f66 2074 6865 2063 6f64 6520  ing of the code 
-0001afb0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
-0001afc0: 696e 6720 636f 6d6d 616e 642e 5c6e 5c6e  ing command.\n\n
-0001afd0: 2020 2020 2420 6d61 6b65 206c 696e 745c      $ make lint\
-0001afe0: 6e5c 6e59 6f75 2063 616e 2072 6566 6f72  n\nYou can refor
-0001aff0: 6d61 7420 7468 6520 636f 6465 2075 7369  mat the code usi
-0001b000: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-0001b010: 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20 2020   command.\n\n   
-0001b020: 2024 206d 616b 6520 666d 745c 6e5c 6e54   $ make fmt\n\nT
-0001b030: 6573 7473 2062 656c 6f6e 6720 696e 2060  ests belong in `
-0001b040: 2e2f 7465 7374 7360 2e20 436f 6465 2d75  ./tests`. Code-u
-0001b050: 6e64 6572 2d74 6573 7420 6265 6c6f 6e67  nder-test belong
-0001b060: 7320 696e 2060 2e2f 6573 6462 636c 6965  s in `./esdbclie
-0001b070: 6e74 602e 5c6e 5c6e 4564 6974 2070 6163  nt`.\n\nEdit pac
-0001b080: 6b61 6765 2064 6570 656e 6465 6e63 6965  kage dependencie
-0001b090: 7320 696e 2060 7079 7072 6f6a 6563 742e  s in `pyproject.
-0001b0a0: 746f 6d6c 602e 2055 7064 6174 6520 696e  toml`. Update in
-0001b0b0: 7374 616c 6c65 6420 7061 636b 6167 6573  stalled packages
-0001b0c0: 2028 616e 6420 7468 655c 6e60 706f 6574   (and the\n`poet
-0001b0d0: 7279 2e6c 6f63 6b60 2066 696c 6529 2075  ry.lock` file) u
-0001b0e0: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-0001b0f0: 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20  ng command.\n\n 
-0001b100: 2020 2024 206d 616b 6520 7570 6461 7465     $ make update
-0001b110: 2d70 6163 6b61 6765 735c 6e27 2c0a 2020  -packages\n',.  
-0001b120: 2020 2761 7574 686f 7227 3a20 274a 6f68    'author': 'Joh
-0001b130: 6e20 4279 7761 7465 7227 2c0a 2020 2020  n Bywater',.    
-0001b140: 2761 7574 686f 725f 656d 6169 6c27 3a20  'author_email': 
-0001b150: 276a 6f68 6e2e 6279 7761 7465 7240 6170  'john.bywater@ap
-0001b160: 7072 6f70 7269 6174 6573 6f66 7477 6172  propriatesoftwar
-0001b170: 652e 6e65 7427 2c0a 2020 2020 276d 6169  e.net',.    'mai
-0001b180: 6e74 6169 6e65 7227 3a20 274e 6f6e 6527  ntainer': 'None'
-0001b190: 2c0a 2020 2020 276d 6169 6e74 6169 6e65  ,.    'maintaine
-0001b1a0: 725f 656d 6169 6c27 3a20 274e 6f6e 6527  r_email': 'None'
-0001b1b0: 2c0a 2020 2020 2775 726c 273a 2027 6874  ,.    'url': 'ht
-0001b1c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-0001b1d0: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
-0001b1e0: 2f65 7364 6263 6c69 656e 7427 2c0a 2020  /esdbclient',.  
-0001b1f0: 2020 2770 6163 6b61 6765 7327 3a20 7061    'packages': pa
-0001b200: 636b 6167 6573 2c0a 2020 2020 2770 6163  ckages,.    'pac
-0001b210: 6b61 6765 5f64 6174 6127 3a20 7061 636b  kage_data': pack
-0001b220: 6167 655f 6461 7461 2c0a 2020 2020 2769  age_data,.    'i
-0001b230: 6e73 7461 6c6c 5f72 6571 7569 7265 7327  nstall_requires'
-0001b240: 3a20 696e 7374 616c 6c5f 7265 7175 6972  : install_requir
-0001b250: 6573 2c0a 2020 2020 2770 7974 686f 6e5f  es,.    'python_
-0001b260: 7265 7175 6972 6573 273a 2027 3e3d 332e  requires': '>=3.
-0001b270: 372c 3c34 2e30 272c 0a7d 0a0a 0a73 6574  7,<4.0',.}...set
-0001b280: 7570 282a 2a73 6574 7570 5f6b 7761 7267  up(**setup_kwarg
-0001b290: 7329 0a                                  s).
+00000300: 6675 6c20 6665 6174 7572 6573 2061 7265  ful features are
+00000310: 2070 7265 7365 6e74 6564 5c6e 696e 2061   presented\nin a
+00000320: 6e20 6561 7379 2d74 6f2d 7573 6520 696e  n easy-to-use in
+00000330: 7465 7266 6163 652e 5c6e 5c6e 5468 6973  terface.\n\nThis
+00000340: 2063 6c69 656e 7420 6861 7320 6265 656e   client has been
+00000350: 2074 6573 7465 6420 746f 2077 6f72 6b20   tested to work 
+00000360: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
+00000370: 4220 4c54 5320 7665 7273 696f 6e73 2032  B LTS versions 2
+00000380: 312e 3130 2c5c 6e77 6974 686f 7574 2061  1.10,\nwithout a
+00000390: 6e64 2077 6974 686f 7574 2053 534c 2f54  nd without SSL/T
+000003a0: 4c53 2c20 616e 6420 7769 7468 2050 7974  LS, and with Pyt
+000003b0: 686f 6e20 7665 7273 696f 6e73 2033 2e37  hon versions 3.7
+000003c0: 2074 6f20 332e 3131 2e20 5468 6572 655c   to 3.11. There\
+000003d0: 6e69 7320 3130 3025 2074 6573 7420 636f  nis 100% test co
+000003e0: 7665 7261 6765 2e20 5468 6520 636f 6465  verage. The code
+000003f0: 2068 6173 2074 7970 696e 6720 616e 6e6f   has typing anno
+00000400: 7461 7469 6f6e 732c 2063 6865 636b 6564  tations, checked
+00000410: 2077 6974 6820 6d79 7079 2e5c 6e54 6865   with mypy.\nThe
+00000420: 2063 6f64 6520 6973 2066 6f72 6d61 7474   code is formatt
+00000430: 6564 2077 6974 6820 626c 6163 6b20 616e  ed with black an
+00000440: 6420 6973 6f72 742c 2061 6e64 2063 6865  d isort, and che
+00000450: 636b 6564 2077 6974 6820 666c 616b 6538  cked with flake8
+00000460: 2e20 506f 6574 7279 5c6e 6973 2075 7365  . Poetry\nis use
+00000470: 6420 666f 7220 7061 636b 6167 6520 6d61  d for package ma
+00000480: 6e61 6765 6d65 6e74 2064 7572 696e 6720  nagement during 
+00000490: 6465 7665 6c6f 706d 656e 742c 2061 6e64  development, and
+000004a0: 2066 6f72 2062 7569 6c64 696e 6720 616e   for building an
+000004b0: 645c 6e70 7562 6c69 7368 696e 6720 6469  d\npublishing di
+000004c0: 7374 7269 6275 7469 6f6e 7320 746f 205b  stributions to [
+000004d0: 5079 5049 5d28 6874 7470 733a 2f2f 7079  PyPI](https://py
+000004e0: 7069 2e6f 7267 2f70 726f 6a65 6374 2f65  pi.org/project/e
+000004f0: 7364 6263 6c69 656e 742f 292e 5c6e 5c6e  sdbclient/).\n\n
+00000500: 2323 2053 796e 6f70 7369 735c 6e5c 6e54  ## Synopsis\n\nT
+00000510: 6865 2060 4553 4442 436c 6965 6e74 6020  he `ESDBClient` 
+00000520: 636c 6173 7320 6361 6e20 6265 2069 6d70  class can be imp
+00000530: 6f72 7465 6420 6672 6f6d 2074 6865 2060  orted from the `
+00000540: 6573 6462 636c 6965 6e74 6020 7061 636b  esdbclient` pack
+00000550: 6167 652e 5c6e 5c6e 5072 6f62 6162 6c79  age.\n\nProbably
+00000560: 2074 6865 2074 6872 6565 206d 6f73 7420   the three most 
+00000570: 7573 6566 756c 206d 6574 686f 6473 206f  useful methods o
+00000580: 6620 6045 5344 4243 6c69 656e 7460 2061  f `ESDBClient` a
+00000590: 7265 3a5c 6e5c 6e2a 2060 6170 7065 6e64  re:\n\n* `append
+000005a0: 5f65 7665 6e74 7328 2960 2054 6869 7320  _events()` This 
+000005b0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+000005c0: 6564 2074 6f20 7265 636f 7264 2065 7665  ed to record eve
+000005d0: 6e74 7320 696e 2061 2070 6172 7469 6375  nts in a particu
+000005e0: 6c61 725c 6e22 7374 7265 616d 222e 2054  lar\n"stream". T
+000005f0: 6869 7320 6973 2075 7365 6675 6c20 666f  his is useful fo
+00000600: 7220 6578 616d 706c 6520 7768 656e 2065  r example when e
+00000610: 7865 6375 7469 6e67 2061 2063 6f6d 6d61  xecuting a comma
+00000620: 6e64 2069 6e20 616e 2061 7070 6c69 6361  nd in an applica
+00000630: 7469 6f6e 5c6e 7468 6174 206d 7574 6174  tion\nthat mutat
+00000640: 6573 2061 6e20 6167 6772 6567 6174 652e  es an aggregate.
+00000650: 2054 6869 7320 6d65 7468 6f64 2069 7320   This method is 
+00000660: 2261 746f 6d69 6322 2069 6e20 7468 6174  "atomic" in that
+00000670: 2065 6974 6865 7220 616c 6c20 6f72 206e   either all or n
+00000680: 6f6e 6520 6f66 5c6e 7468 6520 6576 656e  one of\nthe even
+00000690: 7473 2077 696c 6c20 6265 2072 6563 6f72  ts will be recor
+000006a0: 6465 642e 5c6e 5c6e 2a20 6072 6561 645f  ded.\n\n* `read_
+000006b0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000006c0: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
+000006d0: 2062 6520 7573 6564 2074 6f20 7265 7472   be used to retr
+000006e0: 6965 7665 2061 6c6c 2074 6865 2072 6563  ieve all the rec
+000006f0: 6f72 6465 645c 6e65 7665 6e74 7320 696e  orded\nevents in
+00000700: 2061 2022 7374 7265 616d 222e 2054 6869   a "stream". Thi
+00000710: 7320 6973 2075 7365 6675 6c20 666f 7220  s is useful for 
+00000720: 6578 616d 706c 6520 7768 656e 2072 6563  example when rec
+00000730: 6f6e 7374 7275 6374 696e 6720 616e 2061  onstructing an a
+00000740: 6767 7265 6761 7465 5c6e 6265 666f 7265  ggregate\nbefore
+00000750: 2065 7865 6375 7469 6e67 2061 2063 6f6d   executing a com
+00000760: 6d61 6e64 2069 6e20 616e 2061 7070 6c69  mand in an appli
+00000770: 6361 7469 6f6e 2e5c 6e5c 6e2a 2060 7375  cation.\n\n* `su
+00000780: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+00000790: 7473 2829 6020 5468 6973 206d 6574 686f  ts()` This metho
+000007a0: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+000007b0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+000007c0: 6f72 6465 645c 6e65 7665 6e74 7320 6163  orded\nevents ac
+000007d0: 726f 7373 2061 6c6c 2022 7374 7265 616d  ross all "stream
+000007e0: 7322 2e20 5468 6973 2069 7320 7573 6566  s". This is usef
+000007f0: 756c 2069 6e20 646f 776e 7374 7265 616d  ul in downstream
+00000800: 2065 7665 6e74 2d70 726f 6365 7373 696e   event-processin
+00000810: 675c 6e63 6f6d 706f 6e65 6e74 732c 2061  g\ncomponents, a
+00000820: 6e64 2073 7570 706f 7274 7320 7072 6f63  nd supports proc
+00000830: 6573 7369 6e67 2065 7665 6e74 7320 7769  essing events wi
+00000840: 7468 2022 6578 6163 746c 792d 6f6e 6365  th "exactly-once
+00000850: 2220 7365 6d61 6e74 6963 7320 2873 6565  " semantics (see
+00000860: 2062 656c 6f77 292e 5c6e 5c6e 5468 6520   below).\n\nThe 
+00000870: 6578 616d 706c 6520 6265 6c6f 7720 7573  example below us
+00000880: 6573 2061 6e20 2269 6e73 6563 7572 6522  es an "insecure"
+00000890: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+000008a0: 7276 6572 2072 756e 6e69 6e67 206c 6f63  rver running loc
+000008b0: 616c 6c79 206f 6e20 706f 7274 2032 3131  ally on port 211
+000008c0: 342e 5c6e 5c6e 6060 6070 7974 686f 6e5c  4.\n\n```python\
+000008d0: 6e69 6d70 6f72 7420 7575 6964 5c6e 5c6e  nimport uuid\n\n
+000008e0: 6672 6f6d 2065 7364 6263 6c69 656e 7420  from esdbclient 
+000008f0: 696d 706f 7274 2045 5344 4243 6c69 656e  import ESDBClien
+00000900: 742c 204e 6577 4576 656e 745c 6e5c 6e5c  t, NewEvent\n\n\
+00000910: 6e23 2043 6f6e 7374 7275 6374 2045 5344  n# Construct ESD
+00000920: 4243 6c69 656e 7420 7769 7468 2061 6e20  BClient with an 
+00000930: 4576 656e 7453 746f 7265 4442 2055 5249  EventStoreDB URI
+00000940: 2e5c 6e5c 6e63 6c69 656e 7420 3d20 4553  .\n\nclient = ES
+00000950: 4442 436c 6965 6e74 285c 6e20 2020 2075  DBClient(\n    u
+00000960: 7269 3d22 6573 6462 3a2f 2f6c 6f63 616c  ri="esdb://local
+00000970: 686f 7374 3a32 3131 343f 546c 733d 6661  host:2114?Tls=fa
+00000980: 6c73 6522 5c6e 295c 6e5c 6e5c 6e23 2047  lse"\n)\n\n\n# G
+00000990: 656e 6572 6174 6520 6e65 7720 6576 656e  enerate new even
+000009a0: 7473 2e20 5479 7069 6361 6c6c 792c 2064  ts. Typically, d
+000009b0: 6f6d 6169 6e20 6576 656e 7473 206f 6620  omain events of 
+000009c0: 6469 6666 6572 656e 745c 6e23 2074 7970  different\n# typ
+000009d0: 6573 2061 7265 2067 656e 6572 6174 6564  es are generated
+000009e0: 2069 6e20 6120 646f 6d61 696e 206d 6f64   in a domain mod
+000009f0: 656c 2c20 616e 6420 7468 656e 2073 6572  el, and then ser
+00000a00: 6961 6c69 7a65 645c 6e23 2069 6e74 6f20  ialized\n# into 
+00000a10: 4e65 7745 7665 6e74 206f 626a 6563 7473  NewEvent objects
+00000a20: 2e20 416e 2061 6767 7265 6761 7465 2049  . An aggregate I
+00000a30: 4420 6d61 7920 6265 2075 7365 6420 6173  D may be used as
+00000a40: 2074 6865 5c6e 2320 6e61 6d65 206f 6620   the\n# name of 
+00000a50: 6120 7374 7265 616d 2069 6e20 4576 656e  a stream in Even
+00000a60: 7453 746f 7265 4442 2e5c 6e5c 6e73 7472  tStoreDB.\n\nstr
+00000a70: 6561 6d5f 6e61 6d65 3120 3d20 7374 7228  eam_name1 = str(
+00000a80: 7575 6964 2e75 7569 6434 2829 295c 6e65  uuid.uuid4())\ne
+00000a90: 7665 6e74 3120 3d20 4e65 7745 7665 6e74  vent1 = NewEvent
+00000aa0: 285c 6e20 2020 2074 7970 653d 5c27 4f72  (\n    type=\'Or
+00000ab0: 6465 7243 7265 6174 6564 5c27 2c5c 6e20  derCreated\',\n 
+00000ac0: 2020 2064 6174 613d 625c 277b 226f 7264     data=b\'{"ord
+00000ad0: 6572 5f6e 756d 6265 7222 3a20 2231 3233  er_number": "123
+00000ae0: 3435 3622 7d5c 275c 6e29 5c6e 6576 656e  456"}\'\n)\neven
+00000af0: 7432 203d 204e 6577 4576 656e 7428 5c6e  t2 = NewEvent(\n
+00000b00: 2020 2020 7479 7065 3d5c 274f 7264 6572      type=\'Order
+00000b10: 5375 626d 6974 7465 645c 272c 5c6e 2020  Submitted\',\n  
+00000b20: 2020 6461 7461 3d62 5c27 7b7d 5c27 5c6e    data=b\'{}\'\n
+00000b30: 295c 6e5c 6e5c 6e23 2041 7070 656e 6420  )\n\n\n# Append 
+00000b40: 6e65 7720 6576 656e 7473 2074 6f20 6120  new events to a 
+00000b50: 7374 7265 616d 2e20 5468 6520 7374 7265  stream. The stre
+00000b60: 616d 2064 6f65 7320 6e6f 7420 6578 6973  am does not exis
+00000b70: 7420 736f 5c6e 2320 7468 6520 2263 7572  t so\n# the "cur
+00000b80: 7265 6e74 2076 6572 7369 6f6e 2220 6973  rent version" is
+00000b90: 204e 6f6e 652e 2054 6865 2076 616c 7565   None. The value
+00000ba0: 2072 6574 7572 6e65 6420 6672 6f6d 2074   returned from t
+00000bb0: 6865 5c6e 2320 6170 7065 6e64 5f65 7665  he\n# append_eve
+00000bc0: 6e74 7328 2920 6d65 7468 6f64 2069 7320  nts() method is 
+00000bd0: 7468 6520 6f76 6572 616c 6c20 706f 7369  the overall posi
+00000be0: 7469 6f6e 2069 6e20 7468 6520 6461 7461  tion in the data
+00000bf0: 6261 7365 5c6e 2320 6f66 2074 6865 206c  base\n# of the l
+00000c00: 6173 7420 6e65 7720 6576 656e 7420 7265  ast new event re
+00000c10: 636f 7264 6564 2062 7920 7468 6973 206f  corded by this o
+00000c20: 7065 7261 7469 6f6e 2e20 5468 6520 7265  peration. The re
+00000c30: 7475 726e 6564 5c6e 2320 2263 6f6d 6d69  turned\n# "commi
+00000c40: 7420 706f 7369 7469 6f6e 2220 7661 6c75  t position" valu
+00000c50: 6520 6d61 7920 6265 2075 7365 6420 696e  e may be used in
+00000c60: 2061 2075 7365 7220 696e 7465 7266 6163   a user interfac
+00000c70: 6520 746f 2070 6f6c 6c5c 6e23 2061 2064  e to poll\n# a d
+00000c80: 6f77 6e73 7472 6561 6d20 6576 656e 742d  ownstream event-
+00000c90: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
+00000ca0: 6e65 6e74 2062 6566 6f72 6520 6974 2070  nent before it p
+00000cb0: 7265 7365 6e74 7320 616e 5c6e 2320 7570  resents an\n# up
+00000cc0: 2d74 6f2d 6461 7465 2065 7665 6e74 7561  -to-date eventua
+00000cd0: 6c6c 7920 636f 6e73 6973 7465 6e74 206d  lly consistent m
+00000ce0: 6174 6572 6961 6c69 7a65 6420 7669 6577  aterialized view
+00000cf0: 2e5c 6e5c 6e63 6f6d 6d69 745f 706f 7369  .\n\ncommit_posi
+00000d00: 7469 6f6e 3120 3d20 636c 6965 6e74 2e61  tion1 = client.a
+00000d10: 7070 656e 645f 6576 656e 7473 285c 6e20  ppend_events(\n 
+00000d20: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+00000d30: 7472 6561 6d5f 6e61 6d65 312c 5c6e 2020  tream_name1,\n  
+00000d40: 2020 6375 7272 656e 745f 7665 7273 696f    current_versio
+00000d50: 6e3d 4e6f 6e65 2c5c 6e20 2020 2065 7665  n=None,\n    eve
+00000d60: 6e74 733d 5b65 7665 6e74 312c 2065 7665  nts=[event1, eve
+00000d70: 6e74 325d 2c5c 6e29 5c6e 5c6e 2320 5468  nt2],\n)\n\n# Th
+00000d80: 6520 2263 7572 7265 6e74 2076 6572 7369  e "current versi
+00000d90: 6f6e 2220 6973 2074 6865 2022 7374 7265  on" is the "stre
+00000da0: 616d 2070 6f73 6974 696f 6e22 206f 6620  am position" of 
+00000db0: 7468 6520 6c61 7374 5c6e 2320 7265 636f  the last\n# reco
+00000dc0: 7264 6564 2065 7665 6e74 2069 6e20 6120  rded event in a 
+00000dd0: 7374 7265 616d 2e20 5374 7265 616d 2070  stream. Stream p
+00000de0: 6f73 6974 696f 6e73 2061 7265 207a 6572  ositions are zer
+00000df0: 6f2d 6261 7365 642e 5c6e 2320 5765 2068  o-based.\n# We h
+00000e00: 6176 6520 7265 636f 7264 6564 2074 776f  ave recorded two
+00000e10: 206e 6577 2065 7665 6e74 732c 2061 6e64   new events, and
+00000e20: 2073 6f20 7468 6520 2263 7572 7265 6e74   so the "current
+00000e30: 2076 6572 7369 6f6e 225c 6e23 206f 6620   version"\n# of 
+00000e40: 7468 6973 2073 7472 6561 6d20 6973 2031  this stream is 1
+00000e50: 2e20 436f 6e63 7572 7265 6e63 7920 6973  . Concurrency is
+00000e60: 2063 6f6e 7472 6f6c 6c65 6420 696e 2074   controlled in t
+00000e70: 6869 7320 7761 795c 6e23 2074 6f20 656e  his way\n# to en
+00000e80: 7375 7265 2074 6865 2063 6f6e 7369 7374  sure the consist
+00000e90: 656e 6379 206f 6620 7265 636f 7264 6564  ency of recorded
+00000ea0: 2065 7665 6e74 732e 2041 6e20 696e 636f   events. An inco
+00000eb0: 7272 6563 745c 6e23 2076 616c 7565 2077  rrect\n# value w
+00000ec0: 696c 6c20 6361 7573 6520 6120 5772 6f6e  ill cause a Wron
+00000ed0: 6743 7572 7265 6e74 5665 7273 696f 6e20  gCurrentVersion 
+00000ee0: 6578 6365 7074 696f 6e20 746f 2062 6520  exception to be 
+00000ef0: 7261 6973 6564 2e5c 6e5c 6e65 7665 6e74  raised.\n\nevent
+00000f00: 3320 3d20 4e65 7745 7665 6e74 285c 6e20  3 = NewEvent(\n 
+00000f10: 2020 2074 7970 653d 5c27 4f72 6465 7243     type=\'OrderC
+00000f20: 616e 6365 6c6c 6564 5c27 2c5c 6e20 2020  ancelled\',\n   
+00000f30: 2064 6174 613d 625c 277b 7d5c 275c 6e29   data=b\'{}\'\n)
+00000f40: 5c6e 5c6e 636f 6d6d 6974 5f70 6f73 6974  \n\ncommit_posit
+00000f50: 696f 6e32 203d 2063 6c69 656e 742e 6170  ion2 = client.ap
+00000f60: 7065 6e64 5f65 7665 6e74 7328 5c6e 2020  pend_events(\n  
+00000f70: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00000f80: 7265 616d 5f6e 616d 6531 2c5c 6e20 2020  ream_name1,\n   
+00000f90: 2063 7572 7265 6e74 5f76 6572 7369 6f6e   current_version
+00000fa0: 3d31 2c5c 6e20 2020 2065 7665 6e74 733d  =1,\n    events=
+00000fb0: 5b65 7665 6e74 335d 2c5c 6e29 5c6e 5c6e  [event3],\n)\n\n
+00000fc0: 5c6e 2320 5265 6164 2065 7665 6e74 7320  \n# Read events 
+00000fd0: 6672 6f6d 2061 2073 7472 6561 6d2e 2054  from a stream. T
+00000fe0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00000ff0: 7473 206d 6179 2062 655c 6e23 2064 6573  ts may be\n# des
+00001000: 6572 6961 6c69 7a65 6420 746f 2064 6f6d  erialized to dom
+00001010: 6169 6e20 6576 656e 7473 206f 626a 6563  ain events objec
+00001020: 7473 206f 6620 6469 6666 6572 656e 7420  ts of different 
+00001030: 7479 7065 732c 5c6e 2320 7468 656e 2075  types,\n# then u
+00001040: 7365 6420 746f 2072 6563 6f6e 7374 7275  sed to reconstru
+00001050: 6374 2061 6e20 6167 6772 6567 6174 6520  ct an aggregate 
+00001060: 696e 2061 2064 6f6d 6169 6e20 6d6f 6465  in a domain mode
+00001070: 6c2e 5c6e 5c6e 7265 636f 7264 6564 203d  l.\n\nrecorded =
+00001080: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+00001090: 6561 6d5f 6576 656e 7473 285c 6e20 2020  eam_events(\n   
+000010a0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+000010b0: 6561 6d5f 6e61 6d65 315c 6e29 5c6e 5c6e  eam_name1\n)\n\n
+000010c0: 6173 7365 7274 206c 656e 2872 6563 6f72  assert len(recor
+000010d0: 6465 6429 203d 3d20 335c 6e5c 6e61 7373  ded) == 3\n\nass
+000010e0: 6572 7420 7265 636f 7264 6564 5b30 5d2e  ert recorded[0].
+000010f0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+00001100: 7472 6561 6d5f 6e61 6d65 315c 6e61 7373  tream_name1\nass
+00001110: 6572 7420 7265 636f 7264 6564 5b31 5d2e  ert recorded[1].
+00001120: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+00001130: 7472 6561 6d5f 6e61 6d65 315c 6e61 7373  tream_name1\nass
+00001140: 6572 7420 7265 636f 7264 6564 5b32 5d2e  ert recorded[2].
+00001150: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+00001160: 7472 6561 6d5f 6e61 6d65 315c 6e5c 6e61  tream_name1\n\na
+00001170: 7373 6572 7420 7265 636f 7264 6564 5b30  ssert recorded[0
+00001180: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+00001190: 6e20 3d3d 2030 5c6e 6173 7365 7274 2072  n == 0\nassert r
+000011a0: 6563 6f72 6465 645b 315d 2e73 7472 6561  ecorded[1].strea
+000011b0: 6d5f 706f 7369 7469 6f6e 203d 3d20 315c  m_position == 1\
+000011c0: 6e61 7373 6572 7420 7265 636f 7264 6564  nassert recorded
+000011d0: 5b32 5d2e 7374 7265 616d 5f70 6f73 6974  [2].stream_posit
+000011e0: 696f 6e20 3d3d 2032 5c6e 5c6e 6173 7365  ion == 2\n\nasse
+000011f0: 7274 2072 6563 6f72 6465 645b 305d 2e74  rt recorded[0].t
+00001200: 7970 6520 3d3d 2022 4f72 6465 7243 7265  ype == "OrderCre
+00001210: 6174 6564 225c 6e61 7373 6572 7420 7265  ated"\nassert re
+00001220: 636f 7264 6564 5b31 5d2e 7479 7065 203d  corded[1].type =
+00001230: 3d20 224f 7264 6572 5375 626d 6974 7465  = "OrderSubmitte
+00001240: 6422 5c6e 6173 7365 7274 2072 6563 6f72  d"\nassert recor
+00001250: 6465 645b 325d 2e74 7970 6520 3d3d 2022  ded[2].type == "
+00001260: 4f72 6465 7243 616e 6365 6c6c 6564 225c  OrderCancelled"\
+00001270: 6e5c 6e61 7373 6572 7420 7265 636f 7264  n\nassert record
+00001280: 6564 5b30 5d2e 6461 7461 203d 3d20 625c  ed[0].data == b\
+00001290: 277b 226f 7264 6572 5f6e 756d 6265 7222  '{"order_number"
+000012a0: 3a20 2231 3233 3435 3622 7d5c 275c 6e5c  : "123456"}\'\n\
+000012b0: 6e5c 6e23 2053 7461 7274 2061 2063 6174  n\n# Start a cat
+000012c0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+000012d0: 6f6e 2074 6f20 7265 6365 6976 6520 616c  on to receive al
+000012e0: 6c20 7265 636f 7264 6564 5c6e 2320 6576  l recorded\n# ev
+000012f0: 656e 7473 2061 6372 6f73 7320 616c 6c20  ents across all 
+00001300: 7374 7265 616d 732e 2041 2063 6174 6368  streams. A catch
+00001310: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00001320: 206d 6179 5c6e 2320 6265 2075 7365 6420   may\n# be used 
+00001330: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
+00001340: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00001350: 2063 6f6d 706f 6e65 6e74 2074 6f5c 6e23   component to\n#
+00001360: 2072 6563 6569 7665 2072 6563 6f72 6465   receive recorde
+00001370: 6420 6576 656e 7473 2066 726f 6d20 6120  d events from a 
+00001380: 7061 7274 6963 756c 6172 2063 6f6d 6d69  particular commi
+00001390: 7420 706f 7369 7469 6f6e 2e5c 6e23 2054  t position.\n# T
+000013a0: 6865 2066 6972 7374 2022 636f 6d6d 6974  he first "commit
+000013b0: 2070 6f73 6974 696f 6e22 2069 6e20 616e   position" in an
+000013c0: 2045 7665 6e74 5374 6f72 6544 4220 6461   EventStoreDB da
+000013d0: 7461 6261 7365 2069 7320 302e 5c6e 5c6e  tabase is 0.\n\n
+000013e0: 6c61 7374 5f73 6176 6564 5f63 6f6d 6d69  last_saved_commi
+000013f0: 745f 706f 7369 7469 6f6e 203d 2030 5c6e  t_position = 0\n
+00001400: 5c6e 6361 7463 685f 7375 6273 6372 6970  \ncatch_subscrip
+00001410: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
+00001420: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+00001430: 7473 285c 6e20 2020 2063 6f6d 6d69 745f  ts(\n    commit_
+00001440: 706f 7369 7469 6f6e 3d6c 6173 745f 7361  position=last_sa
+00001450: 7665 645f 636f 6d6d 6974 5f70 6f73 6974  ved_commit_posit
+00001460: 696f 6e5c 6e29 5c6e 5c6e 5c6e 2320 4974  ion\n)\n\n\n# It
+00001470: 6572 6174 6520 6f76 6572 2074 6865 2063  erate over the c
+00001480: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00001490: 7469 6f6e 2e20 5072 6f63 6573 7320 6561  tion. Process ea
+000014a0: 6368 5c6e 2320 7265 636f 7264 6564 2065  ch\n# recorded e
+000014b0: 7665 6e74 2069 6e20 7475 726e 2e20 496e  vent in turn. In
+000014c0: 2061 6e20 6174 6f6d 6963 2064 6174 6162   an atomic datab
+000014d0: 6173 6520 7472 616e 7361 6374 696f 6e5c  ase transaction\
+000014e0: 6e23 2073 6176 6520 7468 6520 6576 656e  n# save the even
+000014f0: 745c 2773 2022 636f 6d6d 6974 2070 6f73  t\'s "commit pos
+00001500: 6974 696f 6e22 2077 6974 6820 616e 7920  ition" with any 
+00001510: 6e65 7720 7374 6174 655c 6e23 2067 656e  new state\n# gen
+00001520: 6572 6174 6564 2062 7920 7072 6f63 6573  erated by proces
+00001530: 7369 6e67 2074 6865 2065 7665 6e74 2e20  sing the event. 
+00001540: 5573 6520 7468 6520 636f 6d70 6f6e 656e  Use the componen
+00001550: 745c 2773 5c6e 2320 6c61 7374 2073 6176  t\'s\n# last sav
+00001560: 6564 2022 636f 6d6d 6974 2070 6f73 6974  ed "commit posit
+00001570: 696f 6e22 2077 6865 6e20 7265 7374 6172  ion" when restar
+00001580: 7469 6e67 2074 6865 2073 7562 7363 7269  ting the subscri
+00001590: 7074 696f 6e2e 5c6e 5c6e 5c6e 7265 6365  ption.\n\n\nrece
+000015a0: 6976 6564 203d 205b 5d5c 6e66 6f72 2065  ived = []\nfor e
+000015b0: 7665 6e74 2069 6e20 6361 7463 685f 7375  vent in catch_su
+000015c0: 6273 6372 6970 7469 6f6e 3a5c 6e20 2020  bscription:\n   
+000015d0: 206c 6173 745f 7361 7665 645f 636f 6d6d   last_saved_comm
+000015e0: 6974 5f70 6f73 6974 696f 6e20 3d20 6576  it_position = ev
+000015f0: 656e 742e 636f 6d6d 6974 5f70 6f73 6974  ent.commit_posit
+00001600: 696f 6e5c 6e20 2020 2072 6563 6569 7665  ion\n    receive
+00001610: 642e 6170 7065 6e64 2865 7665 6e74 295c  d.append(event)\
+00001620: 6e5c 6e20 2020 2069 6620 6c61 7374 5f73  n\n    if last_s
+00001630: 6176 6564 5f63 6f6d 6d69 745f 706f 7369  aved_commit_posi
+00001640: 7469 6f6e 203d 3d20 636f 6d6d 6974 5f70  tion == commit_p
+00001650: 6f73 6974 696f 6e32 3a5c 6e20 2020 2020  osition2:\n     
+00001660: 2020 2023 2053 746f 7020 736f 2077 6520     # Stop so we 
+00001670: 6361 6e20 636f 6e74 696e 7565 2077 6974  can continue wit
+00001680: 6820 7468 6520 6578 616d 706c 652e 5c6e  h the example.\n
+00001690: 2020 2020 2020 2020 6361 7463 685f 7375          catch_su
+000016a0: 6273 6372 6970 7469 6f6e 2e73 746f 7028  bscription.stop(
+000016b0: 295c 6e5c 6e5c 6e61 7373 6572 7420 7265  )\n\n\nassert re
+000016c0: 6365 6976 6564 5b2d 335d 2e74 7970 6520  ceived[-3].type 
+000016d0: 3d3d 2022 4f72 6465 7243 7265 6174 6564  == "OrderCreated
+000016e0: 225c 6e61 7373 6572 7420 7265 6365 6976  "\nassert receiv
+000016f0: 6564 5b2d 325d 2e74 7970 6520 3d3d 2022  ed[-2].type == "
+00001700: 4f72 6465 7253 7562 6d69 7474 6564 225c  OrderSubmitted"\
+00001710: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
+00001720: 5b2d 315d 2e74 7970 6520 3d3d 2022 4f72  [-1].type == "Or
+00001730: 6465 7243 616e 6365 6c6c 6564 225c 6e5c  derCancelled"\n\
+00001740: 6e5c 6e23 2043 6c6f 7365 2074 6865 2063  n\n# Close the c
+00001750: 6c69 656e 7420 6166 7465 7220 7573 652e  lient after use.
+00001760: 5c6e 5c6e 636c 6965 6e74 2e63 6c6f 7365  \n\nclient.close
+00001770: 2829 5c6e 6060 605c 6e5c 6e53 6565 2062  ()\n```\n\nSee b
+00001780: 656c 6f77 2066 6f72 206d 6f72 6520 6465  elow for more de
+00001790: 7461 696c 732e 5c6e 5c6e 466f 7220 616e  tails.\n\nFor an
+000017a0: 2065 7861 6d70 6c65 206f 6620 7573 6167   example of usag
+000017b0: 652c 2073 6565 2074 6865 205b 6576 656e  e, see the [even
+000017c0: 7473 6f75 7263 696e 672d 6576 656e 7473  tsourcing-events
+000017d0: 746f 7265 6462 5d28 5c6e 6874 7470 733a  toredb](\nhttps:
+000017e0: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7965  //github.com/pye
+000017f0: 7665 6e74 736f 7572 6369 6e67 2f65 7665  ventsourcing/eve
+00001800: 6e74 736f 7572 6369 6e67 2d65 7665 6e74  ntsourcing-event
+00001810: 7374 6f72 6564 6229 2070 6163 6b61 6765  storedb) package
+00001820: 2e5c 6e5c 6e23 2320 5461 626c 6520 6f66  .\n\n## Table of
+00001830: 2063 6f6e 7465 6e74 735c 6e5c 6e3c 212d   contents\n\n<!-
+00001840: 2d20 544f 4320 2d2d 3e5c 6e2a 205b 496e  - TOC -->\n* [In
+00001850: 7374 616c 6c20 7061 636b 6167 655d 2823  stall package](#
+00001860: 696e 7374 616c 6c2d 7061 636b 6167 6529  install-package)
+00001870: 5c6e 2020 2a20 5b46 726f 6d20 5079 5049  \n  * [From PyPI
+00001880: 5d28 2366 726f 6d2d 7079 7069 295c 6e20  ](#from-pypi)\n 
+00001890: 202a 205b 5769 7468 2050 6f65 7472 795d   * [With Poetry]
+000018a0: 2823 7769 7468 2d70 6f65 7472 7929 5c6e  (#with-poetry)\n
+000018b0: 2a20 5b45 7665 6e74 5374 6f72 6544 4220  * [EventStoreDB 
+000018c0: 7365 7276 6572 5d28 2365 7665 6e74 7374  server](#eventst
+000018d0: 6f72 6564 622d 7365 7276 6572 295c 6e20  oredb-server)\n 
+000018e0: 202a 205b 5275 6e20 636f 6e74 6169 6e65   * [Run containe
+000018f0: 725d 2823 7275 6e2d 636f 6e74 6169 6e65  r](#run-containe
+00001900: 7229 5c6e 2020 2a20 5b53 746f 7020 636f  r)\n  * [Stop co
+00001910: 6e74 6169 6e65 725d 2823 7374 6f70 2d63  ntainer](#stop-c
+00001920: 6f6e 7461 696e 6572 295c 6e2a 205b 4576  ontainer)\n* [Ev
+00001930: 656e 7453 746f 7265 4442 2063 6c69 656e  entStoreDB clien
+00001940: 745d 2823 6576 656e 7473 746f 7265 6462  t](#eventstoredb
+00001950: 2d63 6c69 656e 7429 5c6e 2020 2a20 5b49  -client)\n  * [I
+00001960: 6d70 6f72 7420 636c 6173 735d 2823 696d  mport class](#im
+00001970: 706f 7274 2d63 6c61 7373 295c 6e20 202a  port-class)\n  *
+00001980: 205b 436f 6e73 7472 7563 7420 636c 6965   [Construct clie
+00001990: 6e74 5d28 2363 6f6e 7374 7275 6374 2d63  nt](#construct-c
+000019a0: 6c69 656e 7429 5c6e 2a20 5b43 6f6e 6e65  lient)\n* [Conne
+000019b0: 6374 696f 6e20 7374 7269 6e67 735d 2823  ction strings](#
+000019c0: 636f 6e6e 6563 7469 6f6e 2d73 7472 696e  connection-strin
+000019d0: 6773 295c 6e20 202a 205b 5477 6f20 7363  gs)\n  * [Two sc
+000019e0: 6865 6d65 735d 2823 7477 6f2d 7363 6865  hemes](#two-sche
+000019f0: 6d65 7329 5c6e 2020 2a20 5b55 7365 7220  mes)\n  * [User 
+00001a00: 696e 666f 2073 7472 696e 675d 2823 7573  info string](#us
+00001a10: 6572 2d69 6e66 6f2d 7374 7269 6e67 295c  er-info-string)\
+00001a20: 6e20 202a 205b 5175 6572 7920 7374 7269  n  * [Query stri
+00001a30: 6e67 5d28 2371 7565 7279 2d73 7472 696e  ng](#query-strin
+00001a40: 6729 5c6e 2020 2a20 5b45 7861 6d70 6c65  g)\n  * [Example
+00001a50: 735d 2823 6578 616d 706c 6573 295c 6e2a  s](#examples)\n*
+00001a60: 205b 4576 656e 7420 6f62 6a65 6374 735d   [Event objects]
+00001a70: 2823 6576 656e 742d 6f62 6a65 6374 7329  (#event-objects)
+00001a80: 5c6e 2020 2a20 5b54 6865 204e 6577 4576  \n  * [The NewEv
+00001a90: 656e 7420 636c 6173 735d 2823 7468 652d  ent class](#the-
+00001aa0: 6e65 7765 7665 6e74 2d63 6c61 7373 295c  newevent-class)\
+00001ab0: 6e20 202a 205b 5468 6520 5265 636f 7264  n  * [The Record
+00001ac0: 6564 4576 656e 7420 636c 6173 735d 2823  edEvent class](#
+00001ad0: 7468 652d 7265 636f 7264 6564 6576 656e  the-recordedeven
+00001ae0: 742d 636c 6173 7329 5c6e 2a20 5b53 7472  t-class)\n* [Str
+00001af0: 6561 6d73 5d28 2373 7472 6561 6d73 295c  eams](#streams)\
+00001b00: 6e20 202a 205b 4170 7065 6e64 2065 7665  n  * [Append eve
+00001b10: 6e74 735d 2823 6170 7065 6e64 2d65 7665  nts](#append-eve
+00001b20: 6e74 7329 5c6e 2020 2a20 5b41 7070 656e  nts)\n  * [Appen
+00001b30: 6420 6576 656e 745d 2823 6170 7065 6e64  d event](#append
+00001b40: 2d65 7665 6e74 295c 6e20 202a 205b 4964  -event)\n  * [Id
+00001b50: 656d 706f 7465 6e74 2061 7070 656e 6420  empotent append 
+00001b60: 6f70 6572 6174 696f 6e73 5d28 2369 6465  operations](#ide
+00001b70: 6d70 6f74 656e 742d 6170 7065 6e64 2d6f  mpotent-append-o
+00001b80: 7065 7261 7469 6f6e 7329 5c6e 2020 2a20  perations)\n  * 
+00001b90: 5b52 6561 6420 7374 7265 616d 2065 7665  [Read stream eve
+00001ba0: 6e74 735d 2823 7265 6164 2d73 7472 6561  nts](#read-strea
+00001bb0: 6d2d 6576 656e 7473 295c 6e20 202a 205b  m-events)\n  * [
+00001bc0: 4765 7420 6375 7272 656e 7420 7665 7273  Get current vers
+00001bd0: 696f 6e5d 2823 6765 742d 6375 7272 656e  ion](#get-curren
+00001be0: 742d 7665 7273 696f 6e29 5c6e 2020 2a20  t-version)\n  * 
+00001bf0: 5b48 6f77 2074 6f20 696d 706c 656d 656e  [How to implemen
+00001c00: 7420 736e 6170 7368 6f74 7469 6e67 2077  t snapshotting w
+00001c10: 6974 6820 4576 656e 7453 746f 7265 4442  ith EventStoreDB
+00001c20: 5d28 2368 6f77 2d74 6f2d 696d 706c 656d  ](#how-to-implem
+00001c30: 656e 742d 736e 6170 7368 6f74 7469 6e67  ent-snapshotting
+00001c40: 2d77 6974 682d 6576 656e 7473 746f 7265  -with-eventstore
+00001c50: 6462 295c 6e20 202a 205b 5265 6164 2061  db)\n  * [Read a
+00001c60: 6c6c 2065 7665 6e74 735d 2823 7265 6164  ll events](#read
+00001c70: 2d61 6c6c 2d65 7665 6e74 7329 5c6e 2020  -all-events)\n  
+00001c80: 2a20 5b47 6574 2063 6f6d 6d69 7420 706f  * [Get commit po
+00001c90: 7369 7469 6f6e 5d28 2367 6574 2d63 6f6d  sition](#get-com
+00001ca0: 6d69 742d 706f 7369 7469 6f6e 295c 6e20  mit-position)\n 
+00001cb0: 202a 205b 4765 7420 7374 7265 616d 206d   * [Get stream m
+00001cc0: 6574 6164 6174 615d 2823 6765 742d 7374  etadata](#get-st
+00001cd0: 7265 616d 2d6d 6574 6164 6174 6129 5c6e  ream-metadata)\n
+00001ce0: 2020 2a20 5b53 6574 2073 7472 6561 6d20    * [Set stream 
+00001cf0: 6d65 7461 6461 7461 5d28 2373 6574 2d73  metadata](#set-s
+00001d00: 7472 6561 6d2d 6d65 7461 6461 7461 295c  tream-metadata)\
+00001d10: 6e20 202a 205b 4465 6c65 7465 2073 7472  n  * [Delete str
+00001d20: 6561 6d5d 2823 6465 6c65 7465 2d73 7472  eam](#delete-str
+00001d30: 6561 6d29 5c6e 2020 2a20 5b54 6f6d 6273  eam)\n  * [Tombs
+00001d40: 746f 6e65 2073 7472 6561 6d5d 2823 746f  tone stream](#to
+00001d50: 6d62 7374 6f6e 652d 7374 7265 616d 295c  mbstone-stream)\
+00001d60: 6e2a 205b 4361 7463 682d 7570 2073 7562  n* [Catch-up sub
+00001d70: 7363 7269 7074 696f 6e73 5d28 2363 6174  scriptions](#cat
+00001d80: 6368 2d75 702d 7375 6273 6372 6970 7469  ch-up-subscripti
+00001d90: 6f6e 7329 5c6e 2020 2a20 5b53 7562 7363  ons)\n  * [Subsc
+00001da0: 7269 6265 2061 6c6c 2065 7665 6e74 735d  ribe all events]
+00001db0: 2823 7375 6273 6372 6962 652d 616c 6c2d  (#subscribe-all-
+00001dc0: 6576 656e 7473 295c 6e20 202a 205b 5375  events)\n  * [Su
+00001dd0: 6273 6372 6962 6520 7374 7265 616d 2065  bscribe stream e
+00001de0: 7665 6e74 735d 2823 7375 6273 6372 6962  vents](#subscrib
+00001df0: 652d 7374 7265 616d 2d65 7665 6e74 7329  e-stream-events)
+00001e00: 5c6e 2020 2a20 5b48 6f77 2074 6f20 696d  \n  * [How to im
+00001e10: 706c 656d 656e 7420 6578 6163 746c 792d  plement exactly-
+00001e20: 6f6e 6365 2065 7665 6e74 2070 726f 6365  once event proce
+00001e30: 7373 696e 675d 2823 686f 772d 746f 2d69  ssing](#how-to-i
+00001e40: 6d70 6c65 6d65 6e74 2d65 7861 6374 6c79  mplement-exactly
+00001e50: 2d6f 6e63 652d 6576 656e 742d 7072 6f63  -once-event-proc
+00001e60: 6573 7369 6e67 295c 6e2a 205b 5065 7273  essing)\n* [Pers
+00001e70: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00001e80: 696f 6e73 5d28 2370 6572 7369 7374 656e  ions](#persisten
+00001e90: 742d 7375 6273 6372 6970 7469 6f6e 7329  t-subscriptions)
+00001ea0: 5c6e 2020 2a20 5b43 7265 6174 6520 7375  \n  * [Create su
+00001eb0: 6273 6372 6970 7469 6f6e 5d28 2363 7265  bscription](#cre
+00001ec0: 6174 652d 7375 6273 6372 6970 7469 6f6e  ate-subscription
+00001ed0: 295c 6e20 202a 205b 5265 6164 2073 7562  )\n  * [Read sub
+00001ee0: 7363 7269 7074 696f 6e5d 2823 7265 6164  scription](#read
+00001ef0: 2d73 7562 7363 7269 7074 696f 6e29 5c6e  -subscription)\n
+00001f00: 2020 2a20 5b48 6f77 2074 6f20 7772 6974    * [How to writ
+00001f10: 6520 6120 7065 7273 6973 7465 6e74 2073  e a persistent s
+00001f20: 7562 7363 7269 7074 696f 6e20 636f 6e73  ubscription cons
+00001f30: 756d 6572 5d28 2368 6f77 2d74 6f2d 7772  umer](#how-to-wr
+00001f40: 6974 652d 612d 7065 7273 6973 7465 6e74  ite-a-persistent
+00001f50: 2d73 7562 7363 7269 7074 696f 6e2d 636f  -subscription-co
+00001f60: 6e73 756d 6572 295c 6e20 202a 205b 4765  nsumer)\n  * [Ge
+00001f70: 7420 7375 6273 6372 6970 7469 6f6e 2069  t subscription i
+00001f80: 6e66 6f5d 2823 6765 742d 7375 6273 6372  nfo](#get-subscr
+00001f90: 6970 7469 6f6e 2d69 6e66 6f29 5c6e 2020  iption-info)\n  
+00001fa0: 2a20 5b4c 6973 7420 7375 6273 6372 6970  * [List subscrip
+00001fb0: 7469 6f6e 735d 2823 6c69 7374 2d73 7562  tions](#list-sub
+00001fc0: 7363 7269 7074 696f 6e73 295c 6e20 202a  scriptions)\n  *
+00001fd0: 205b 5570 6461 7465 2073 7562 7363 7269   [Update subscri
+00001fe0: 7074 696f 6e5d 2823 7570 6461 7465 2d73  ption](#update-s
+00001ff0: 7562 7363 7269 7074 696f 6e29 5c6e 2020  ubscription)\n  
+00002000: 2a20 5b43 7265 6174 6520 7374 7265 616d  * [Create stream
+00002010: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+00002020: 6372 6561 7465 2d73 7472 6561 6d2d 7375  create-stream-su
+00002030: 6273 6372 6970 7469 6f6e 295c 6e20 202a  bscription)\n  *
+00002040: 205b 5265 6164 2073 7472 6561 6d20 7375   [Read stream su
+00002050: 6273 6372 6970 7469 6f6e 5d28 2372 6561  bscription](#rea
+00002060: 642d 7374 7265 616d 2d73 7562 7363 7269  d-stream-subscri
+00002070: 7074 696f 6e29 5c6e 2020 2a20 5b47 6574  ption)\n  * [Get
+00002080: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00002090: 7469 6f6e 2069 6e66 6f5d 2823 6765 742d  tion info](#get-
+000020a0: 7374 7265 616d 2d73 7562 7363 7269 7074  stream-subscript
+000020b0: 696f 6e2d 696e 666f 295c 6e20 202a 205b  ion-info)\n  * [
+000020c0: 4c69 7374 2073 7472 6561 6d20 7375 6273  List stream subs
+000020d0: 6372 6970 7469 6f6e 735d 2823 6c69 7374  criptions](#list
+000020e0: 2d73 7472 6561 6d2d 7375 6273 6372 6970  -stream-subscrip
+000020f0: 7469 6f6e 7329 5c6e 2020 2a20 5b55 7064  tions)\n  * [Upd
+00002100: 6174 6520 7374 7265 616d 2073 7562 7363  ate stream subsc
+00002110: 7269 7074 696f 6e5d 2823 7570 6461 7465  ription](#update
+00002120: 2d73 7472 6561 6d2d 7375 6273 6372 6970  -stream-subscrip
+00002130: 7469 6f6e 295c 6e20 202a 205b 5265 706c  tion)\n  * [Repl
+00002140: 6179 2070 6172 6b65 6420 6576 656e 7473  ay parked events
+00002150: 5d28 2372 6570 6c61 792d 7061 726b 6564  ](#replay-parked
+00002160: 2d65 7665 6e74 7329 5c6e 2020 2a20 5b44  -events)\n  * [D
+00002170: 656c 6574 6520 7065 7273 6973 7465 6e74  elete persistent
+00002180: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+00002190: 6465 6c65 7465 2d70 6572 7369 7374 656e  delete-persisten
+000021a0: 742d 7375 6273 6372 6970 7469 6f6e 295c  t-subscription)\
+000021b0: 6e2a 205b 436f 6e6e 6563 7469 6f6e 5d28  n* [Connection](
+000021c0: 2363 6f6e 6e65 6374 696f 6e29 5c6e 2020  #connection)\n  
+000021d0: 2a20 5b52 6563 6f6e 6e65 6374 5d28 2372  * [Reconnect](#r
+000021e0: 6563 6f6e 6e65 6374 295c 6e20 202a 205b  econnect)\n  * [
+000021f0: 436c 6f73 655d 2823 636c 6f73 6529 5c6e  Close](#close)\n
+00002200: 2a20 5b41 7379 6e63 696f 2063 6c69 656e  * [Asyncio clien
+00002210: 745d 2823 6173 796e 6369 6f2d 636c 6965  t](#asyncio-clie
+00002220: 6e74 295c 6e20 202a 205b 5379 6e6f 7073  nt)\n  * [Synops
+00002230: 6973 5d28 2373 796e 6f70 7369 732d 3129  is](#synopsis-1)
+00002240: 5c6e 2a20 5b4e 6f74 6573 5d28 236e 6f74  \n* [Notes](#not
+00002250: 6573 295c 6e20 202a 205b 5265 6775 6c61  es)\n  * [Regula
+00002260: 7220 6578 7072 6573 7369 6f6e 2066 696c  r expression fil
+00002270: 7465 7273 5d28 2372 6567 756c 6172 2d65  ters](#regular-e
+00002280: 7870 7265 7373 696f 6e2d 6669 6c74 6572  xpression-filter
+00002290: 7329 5c6e 2a20 5b43 6f6e 7472 6962 7574  s)\n* [Contribut
+000022a0: 6f72 735d 2823 636f 6e74 7269 6275 746f  ors](#contributo
+000022b0: 7273 295c 6e20 202a 205b 496e 7374 616c  rs)\n  * [Instal
+000022c0: 6c20 506f 6574 7279 5d28 2369 6e73 7461  l Poetry](#insta
+000022d0: 6c6c 2d70 6f65 7472 7929 5c6e 2020 2a20  ll-poetry)\n  * 
+000022e0: 5b53 6574 7570 2066 6f72 2050 7943 6861  [Setup for PyCha
+000022f0: 726d 2075 7365 7273 5d28 2373 6574 7570  rm users](#setup
+00002300: 2d66 6f72 2d70 7963 6861 726d 2d75 7365  -for-pycharm-use
+00002310: 7273 295c 6e20 202a 205b 5365 7475 7020  rs)\n  * [Setup 
+00002320: 6672 6f6d 2063 6f6d 6d61 6e64 206c 696e  from command lin
+00002330: 655d 2823 7365 7475 702d 6672 6f6d 2d63  e](#setup-from-c
+00002340: 6f6d 6d61 6e64 2d6c 696e 6529 5c6e 2020  ommand-line)\n  
+00002350: 2a20 5b50 726f 6a65 6374 204d 616b 6566  * [Project Makef
+00002360: 696c 6520 636f 6d6d 616e 6473 5d28 2370  ile commands](#p
+00002370: 726f 6a65 6374 2d6d 616b 6566 696c 652d  roject-makefile-
+00002380: 636f 6d6d 616e 6473 295c 6e3c 212d 2d20  commands)\n<!-- 
+00002390: 544f 4320 2d2d 3e5c 6e5c 6e23 2320 496e  TOC -->\n\n## In
+000023a0: 7374 616c 6c20 7061 636b 6167 655c 6e5c  stall package\n\
+000023b0: 6e49 7420 6973 2072 6563 6f6d 6d65 6e64  nIt is recommend
+000023c0: 6564 2074 6f20 696e 7374 616c 6c20 5079  ed to install Py
+000023d0: 7468 6f6e 2070 6163 6b61 6765 7320 696e  thon packages in
+000023e0: 746f 2061 2050 7974 686f 6e20 7669 7274  to a Python virt
+000023f0: 7561 6c20 656e 7669 726f 6e6d 656e 742e  ual environment.
+00002400: 5c6e 5c6e 2323 2320 4672 6f6d 2050 7950  \n\n### From PyP
+00002410: 495c 6e5c 6e59 6f75 2063 616e 2075 7365  I\n\nYou can use
+00002420: 2070 6970 2074 6f20 696e 7374 616c 6c20   pip to install 
+00002430: 7468 6973 2070 6163 6b61 6765 2064 6972  this package dir
+00002440: 6563 746c 7920 6672 6f6d 5c6e 5b74 6865  ectly from\n[the
+00002450: 2050 7974 686f 6e20 5061 636b 6167 6520   Python Package 
+00002460: 496e 6465 785d 2868 7474 7073 3a2f 2f70  Index](https://p
+00002470: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
+00002480: 6573 6462 636c 6965 6e74 2f29 2e5c 6e5c  esdbclient/).\n\
+00002490: 6e20 2020 2024 2070 6970 2069 6e73 7461  n    $ pip insta
+000024a0: 6c6c 2065 7364 6263 6c69 656e 745c 6e5c  ll esdbclient\n\
+000024b0: 6e23 2323 2057 6974 6820 506f 6574 7279  n### With Poetry
+000024c0: 5c6e 5c6e 596f 7520 6361 6e20 7573 6520  \n\nYou can use 
+000024d0: 506f 6574 7279 2074 6f20 6164 6420 7468  Poetry to add th
+000024e0: 6973 2070 6163 6b61 6765 2074 6f20 796f  is package to yo
+000024f0: 7572 2070 7970 726f 6a65 6374 2e74 6f6d  ur pyproject.tom
+00002500: 6c20 616e 6420 696e 7374 616c 6c20 6974  l and install it
+00002510: 2e5c 6e5c 6e20 2020 2024 2070 6f65 7472  .\n\n    $ poetr
+00002520: 7920 6164 6420 6573 6462 636c 6965 6e74  y add esdbclient
+00002530: 5c6e 5c6e 2323 2045 7665 6e74 5374 6f72  \n\n## EventStor
+00002540: 6544 4220 7365 7276 6572 5c6e 5c6e 5468  eDB server\n\nTh
+00002550: 6520 4576 656e 7453 746f 7265 4442 2073  e EventStoreDB s
+00002560: 6572 7665 7220 6361 6e20 6265 2072 756e  erver can be run
+00002570: 206c 6f63 616c 6c79 2075 7369 6e67 2074   locally using t
+00002580: 6865 206f 6666 6963 6961 6c20 446f 636b  he official Dock
+00002590: 6572 2063 6f6e 7461 696e 6572 2069 6d61  er container ima
+000025a0: 6765 2e5c 6e5c 6e23 2323 2052 756e 2063  ge.\n\n### Run c
+000025b0: 6f6e 7461 696e 6572 5c6e 5c6e 466f 7220  ontainer\n\nFor 
+000025c0: 6465 7665 6c6f 706d 656e 742c 2079 6f75  development, you
+000025d0: 2063 616e 2072 756e 2061 2022 7365 6375   can run a "secu
+000025e0: 7265 2220 4576 656e 7453 746f 7265 4442  re" EventStoreDB
+000025f0: 2073 6572 7665 7220 7573 696e 6720 7468   server using th
+00002600: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
+00002610: 616e 642e 5c6e 5c6e 2020 2020 2420 646f  and.\n\n    $ do
+00002620: 636b 6572 2072 756e 202d 6420 2d2d 6e61  cker run -d --na
+00002630: 6d65 2065 7665 6e74 7374 6f72 6564 622d  me eventstoredb-
+00002640: 7365 6375 7265 202d 6974 202d 7020 3231  secure -it -p 21
+00002650: 3133 3a32 3131 3320 2d2d 656e 7620 2248  13:2113 --env "H
+00002660: 4f4d 453d 2f74 6d70 2220 6576 656e 7473  OME=/tmp" events
+00002670: 746f 7265 2f65 7665 6e74 7374 6f72 653a  tore/eventstore:
+00002680: 3231 2e31 302e 392d 6275 7374 6572 2d73  21.10.9-buster-s
+00002690: 6c69 6d20 2d2d 6465 765c 6e5c 6e41 7320  lim --dev\n\nAs 
+000026a0: 7765 2077 696c 6c20 7365 652c 2079 6f75  we will see, you
+000026b0: 7220 636c 6965 6e74 2077 696c 6c20 6e65  r client will ne
+000026c0: 6564 2061 6e20 4576 656e 7453 746f 7265  ed an EventStore
+000026d0: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
+000026e0: 7269 6e67 2055 5249 2061 7320 7468 6520  ring URI as the 
+000026f0: 7661 6c75 655c 6e6f 6620 6974 7320 6075  value\nof its `u
+00002700: 7269 6020 636f 6e73 7472 7563 746f 7220  ri` constructor 
+00002710: 6172 6775 6d65 6e74 2e20 5468 6520 636f  argument. The co
+00002720: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00002730: 666f 7220 7468 6973 2022 7365 6375 7265  for this "secure
+00002740: 2220 4576 656e 7453 746f 7265 4442 5c6e  " EventStoreDB\n
+00002750: 7365 7276 6572 2077 6f75 6c64 2062 653a  server would be:
+00002760: 5c6e 5c6e 2020 2020 6573 6462 3a2f 2f61  \n\n    esdb://a
+00002770: 646d 696e 3a63 6861 6e67 6569 7440 6c6f  dmin:changeit@lo
+00002780: 6361 6c68 6f73 743a 3231 3133 5c6e 5c6e  calhost:2113\n\n
+00002790: 546f 2063 6f6e 6e65 6374 2074 6f20 6120  To connect to a 
+000027a0: 2273 6563 7572 6522 2073 6572 7665 722c  "secure" server,
+000027b0: 2079 6f75 2077 696c 6c20 7573 7561 6c6c   you will usuall
+000027c0: 7920 6e65 6564 2074 6f20 696e 636c 7564  y need to includ
+000027d0: 6520 6120 2275 7365 726e 616d 6522 5c6e  e a "username"\n
+000027e0: 616e 6420 6120 2270 6173 7377 6f72 6422  and a "password"
+000027f0: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
+00002800: 6f6e 2073 7472 696e 672c 2073 6f20 7468  on string, so th
+00002810: 6174 2074 6865 2073 6572 7665 7220 6361  at the server ca
+00002820: 6e20 6175 7468 656e 7469 6361 7465 2074  n authenticate t
+00002830: 6865 5c6e 636c 6965 6e74 2e20 5769 7468  he\nclient. With
+00002840: 2045 7665 6e74 5374 6f72 6544 422c 2074   EventStoreDB, t
+00002850: 6865 2064 6566 6175 6c74 2075 7365 726e  he default usern
+00002860: 616d 6520 6973 2022 6164 6d69 6e22 2061  ame is "admin" a
+00002870: 6e64 2074 6865 2064 6566 6175 6c74 2070  nd the default p
+00002880: 6173 7377 6f72 645c 6e69 7320 2263 6861  assword\nis "cha
+00002890: 6e67 6569 7422 2e5c 6e5c 6e57 6865 6e20  ngeit".\n\nWhen 
+000028a0: 636f 6e6e 6563 7469 6e67 2074 6f20 6120  connecting to a 
+000028b0: 2273 6563 7572 6522 2073 6572 7665 722c  "secure" server,
+000028c0: 2079 6f75 7220 636c 6965 6e74 2077 696c   your client wil
+000028d0: 6c20 616c 736f 206e 6565 6420 616e 2053  l also need an S
+000028e0: 534c 2f54 4c53 2063 6572 7469 6669 6361  SL/TLS certifica
+000028f0: 7465 5c6e 6173 2074 6865 2076 616c 7565  te\nas the value
+00002900: 206f 6620 6974 7320 6072 6f6f 745f 6365   of its `root_ce
+00002910: 7274 6966 6963 6174 6573 6020 636f 6e73  rtificates` cons
+00002920: 7472 7563 746f 7220 6172 6775 6d65 6e74  tructor argument
+00002930: 2e20 5468 6520 636c 6965 6e74 2075 7365  . The client use
+00002940: 7320 7468 655c 6e53 534c 2f54 4c53 2063  s the\nSSL/TLS c
+00002950: 6572 7469 6669 6361 7465 2074 6f20 6175  ertificate to au
+00002960: 7468 656e 7469 6361 7465 2074 6865 2073  thenticate the s
+00002970: 6572 7665 722e 2046 6f72 2064 6576 656c  erver. For devel
+00002980: 6f70 6d65 6e74 2c20 796f 7520 6361 6e20  opment, you can 
+00002990: 6569 7468 6572 2075 7365 2074 6865 5c6e  either use the\n
+000029a0: 5353 4c2f 544c 5320 6365 7274 6966 6963  SSL/TLS certific
+000029b0: 6174 6520 6f66 2074 6865 2063 6572 7469  ate of the certi
+000029c0: 6669 6361 7465 2061 7574 686f 7269 7479  ficate authority
+000029d0: 2075 7365 6420 746f 2063 7265 6174 6520   used to create 
+000029e0: 7468 6520 7365 7276 6572 5c27 7320 6365  the server\'s ce
+000029f0: 7274 6966 6963 6174 652c 5c6e 6f72 2077  rtificate,\nor w
+00002a00: 6865 6e20 7573 696e 6720 6120 7369 6e67  hen using a sing
+00002a10: 6c65 2d6e 6f64 6520 636c 7573 7465 722c  le-node cluster,
+00002a20: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
+00002a30: 2073 6572 7665 7220 6365 7274 6966 6963   server certific
+00002a40: 6174 6520 6974 7365 6c66 2e20 596f 7520  ate itself. You 
+00002a50: 6361 6e5c 6e67 6574 2074 6865 2073 6572  can\nget the ser
+00002a60: 7665 7220 6365 7274 6966 6963 6174 6520  ver certificate 
+00002a70: 7769 7468 2074 6865 2066 6f6c 6c6f 7769  with the followi
+00002a80: 6e67 2050 7974 686f 6e20 636f 6465 2e5c  ng Python code.\
+00002a90: 6e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  n\n\n```python\n
+00002aa0: 696d 706f 7274 2073 736c 5c6e 5c6e 7365  import ssl\n\nse
+00002ab0: 7276 6572 5f63 6572 7469 6669 6361 7465  rver_certificate
+00002ac0: 203d 2073 736c 2e67 6574 5f73 6572 7665   = ssl.get_serve
+00002ad0: 725f 6365 7274 6966 6963 6174 6528 6164  r_certificate(ad
+00002ae0: 6472 3d28 5c27 6c6f 6361 6c68 6f73 745c  dr=(\'localhost\
+00002af0: 272c 2032 3131 3329 295c 6e60 6060 5c6e  ', 2113))\n```\n
+00002b00: 5c6e 596f 7520 6361 6e20 616c 736f 2073  \nYou can also s
+00002b10: 7461 7274 2061 6e20 2269 6e73 6563 7572  tart an "insecur
+00002b20: 6522 2073 6572 7665 7220 7573 696e 6720  e" server using 
+00002b30: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+00002b40: 6d6d 616e 642e 5c6e 5c6e 2020 2020 2420  mmand.\n\n    $ 
+00002b50: 646f 636b 6572 2072 756e 202d 6420 2d2d  docker run -d --
+00002b60: 6e61 6d65 2065 7665 6e74 7374 6f72 6564  name eventstored
+00002b70: 622d 696e 7365 6375 7265 202d 6974 202d  b-insecure -it -
+00002b80: 7020 3231 3134 3a32 3131 3320 6576 656e  p 2114:2113 even
+00002b90: 7473 746f 7265 2f65 7665 6e74 7374 6f72  tstore/eventstor
+00002ba0: 653a 3231 2e31 302e 392d 6275 7374 6572  e:21.10.9-buster
+00002bb0: 2d73 6c69 6d20 2d2d 696e 7365 6375 7265  -slim --insecure
+00002bc0: 5c6e 5c6e 5468 6520 636f 6e6e 6563 7469  \n\nThe connecti
+00002bd0: 6f6e 2073 7472 696e 6720 5552 4920 666f  on string URI fo
+00002be0: 7220 7468 6973 2022 696e 7365 6375 7265  r this "insecure
+00002bf0: 2220 7365 7276 6572 2077 6f75 6c64 2062  " server would b
+00002c00: 653a 5c6e 5c6e 2020 2020 6573 6462 3a2f  e:\n\n    esdb:/
+00002c10: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
+00002c20: 546c 733d 6661 6c73 655c 6e5c 6e41 7320  Tls=false\n\nAs 
+00002c30: 7765 2077 696c 6c20 7365 652c 2077 6865  we will see, whe
+00002c40: 6e20 636f 6e6e 6563 7469 6e67 2074 6f20  n connecting to 
+00002c50: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
+00002c60: 7276 6572 2c20 7468 6572 6520 6973 206e  rver, there is n
+00002c70: 6f20 6e65 6564 2074 6f20 696e 636c 7564  o need to includ
+00002c80: 655c 6e61 2022 7573 6572 6e61 6d65 2220  e\na "username" 
+00002c90: 616e 6420 6120 2270 6173 7377 6f72 6422  and a "password"
+00002ca0: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
+00002cb0: 6f6e 2073 7472 696e 672e 2049 6620 796f  on string. If yo
+00002cc0: 7520 646f 2c20 7468 6573 6520 7661 6c75  u do, these valu
+00002cd0: 6573 2077 696c 6c5c 6e62 6520 6967 6e6f  es will\nbe igno
+00002ce0: 7265 6420 6279 2074 6865 2063 6c69 656e  red by the clien
+00002cf0: 742c 2073 6f20 7468 6174 2074 6865 7920  t, so that they 
+00002d00: 6172 6520 6e6f 7420 7365 6e74 206f 7665  are not sent ove
+00002d10: 7220 616e 2069 6e73 6563 7572 6520 6368  r an insecure ch
+00002d20: 616e 6e65 6c2e 5c6e 5c6e 506c 6561 7365  annel.\n\nPlease
+00002d30: 206e 6f74 652c 2074 6865 2022 696e 7365   note, the "inse
+00002d40: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+00002d50: 2073 7472 696e 6720 7573 6573 2061 2071   string uses a q
+00002d60: 7565 7279 2073 7472 696e 6720 7769 7468  uery string with
+00002d70: 2074 6865 2066 6965 6c64 2d76 616c 7565   the field-value
+00002d80: 5c6e 6054 6c73 3d66 616c 7365 602e 2054  \n`Tls=false`. T
+00002d90: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
+00002da0: 2066 6965 6c64 2069 7320 6279 2064 6566   field is by def
+00002db0: 6175 6c74 2060 7472 7565 602e 5c6e 5c6e  ault `true`.\n\n
+00002dc0: 2323 2320 5374 6f70 2063 6f6e 7461 696e  ### Stop contain
+00002dd0: 6572 5c6e 5c6e 546f 2073 746f 7020 616e  er\n\nTo stop an
+00002de0: 6420 7265 6d6f 7665 2074 6865 2022 7365  d remove the "se
+00002df0: 6375 7265 2220 636f 6e74 6169 6e65 722c  cure" container,
+00002e00: 2075 7365 2074 6865 2066 6f6c 6c6f 7769   use the followi
+00002e10: 6e67 2044 6f63 6b65 7220 636f 6d6d 616e  ng Docker comman
+00002e20: 6473 2e5c 6e5c 6e20 2020 2024 2064 6f63  ds.\n\n    $ doc
+00002e30: 6b65 7220 7374 6f70 2065 7665 6e74 7374  ker stop eventst
+00002e40: 6f72 6564 622d 7365 6375 7265 5c6e 5c74  oredb-secure\n\t
+00002e50: 2420 646f 636b 6572 2072 6d20 6576 656e  $ docker rm even
+00002e60: 7473 746f 7265 6462 2d73 6563 7572 655c  tstoredb-secure\
+00002e70: 6e5c 6e54 6f20 7374 6f70 2061 6e64 2072  n\nTo stop and r
+00002e80: 656d 6f76 6520 7468 6520 2269 6e73 6563  emove the "insec
+00002e90: 7572 6522 2063 6f6e 7461 696e 6572 2c20  ure" container, 
+00002ea0: 7573 6520 7468 6520 666f 6c6c 6f77 696e  use the followin
+00002eb0: 6720 446f 636b 6572 2063 6f6d 6d61 6e64  g Docker command
+00002ec0: 732e 5c6e 5c6e 2020 2020 2420 646f 636b  s.\n\n    $ dock
+00002ed0: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
+00002ee0: 7265 6462 2d69 6e73 6563 7572 655c 6e5c  redb-insecure\n\
+00002ef0: 7424 2064 6f63 6b65 7220 726d 2065 7665  t$ docker rm eve
+00002f00: 6e74 7374 6f72 6564 622d 696e 7365 6375  ntstoredb-insecu
+00002f10: 7265 5c6e 5c6e 5c6e 2323 2045 7665 6e74  re\n\n\n## Event
+00002f20: 5374 6f72 6544 4220 636c 6965 6e74 5c6e  StoreDB client\n
+00002f30: 5c6e 5468 6973 2045 7665 6e74 5374 6f72  \nThis EventStor
+00002f40: 6544 4220 636c 6965 6e74 2069 7320 696d  eDB client is im
+00002f50: 706c 656d 656e 7465 6420 696e 2074 6865  plemented in the
+00002f60: 2060 6573 6462 636c 6965 6e74 6020 7061   `esdbclient` pa
+00002f70: 636b 6167 6520 7769 7468 5c6e 7468 6520  ckage with\nthe 
+00002f80: 6045 5344 4243 6c69 656e 7460 2063 6c61  `ESDBClient` cla
+00002f90: 7373 2e5c 6e5c 6e23 2323 2049 6d70 6f72  ss.\n\n### Impor
+00002fa0: 7420 636c 6173 735c 6e5c 6e54 6865 2060  t class\n\nThe `
+00002fb0: 4553 4442 436c 6965 6e74 6020 636c 6173  ESDBClient` clas
+00002fc0: 7320 6361 6e20 6265 2069 6d70 6f72 7465  s can be importe
+00002fd0: 6420 6672 6f6d 2074 6865 2060 6573 6462  d from the `esdb
+00002fe0: 636c 6965 6e74 6020 7061 636b 6167 652e  client` package.
+00002ff0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e66  \n\n```python\nf
+00003000: 726f 6d20 6573 6462 636c 6965 6e74 2069  rom esdbclient i
+00003010: 6d70 6f72 7420 4553 4442 436c 6965 6e74  mport ESDBClient
+00003020: 5c6e 6060 605c 6e5c 6e23 2323 2043 6f6e  \n```\n\n### Con
+00003030: 7374 7275 6374 2063 6c69 656e 745c 6e5c  struct client\n\
+00003040: 6e54 6865 2060 4553 4442 436c 6965 6e74  nThe `ESDBClient
+00003050: 6020 636c 6173 7320 6861 7320 6f6e 6520  ` class has one 
+00003060: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
+00003070: 6374 6f72 2061 7267 756d 656e 742c 2060  ctor argument, `
+00003080: 7572 6960 2c20 616e 6420 6f6e 655c 6e6f  uri`, and one\no
+00003090: 7074 696f 6e61 6c20 636f 6e73 7472 7563  ptional construc
+000030a0: 746f 7220 6172 6775 6d65 6e74 2c20 6072  tor argument, `r
+000030b0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
+000030c0: 602e 5c6e 5c6e 5468 6520 6075 7269 6020  `.\n\nThe `uri` 
+000030d0: 6172 6775 6d65 6e74 2069 7320 6578 7065  argument is expe
+000030e0: 6374 6564 2074 6f20 6265 2061 6e20 4576  cted to be an Ev
+000030f0: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+00003100: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00003110: 2074 6861 745c 6e63 6f6e 666f 726d 7320   that\nconforms 
+00003120: 7769 7468 2074 6865 2073 7461 6e64 6172  with the standar
+00003130: 6420 4576 656e 7453 746f 7265 4442 2022  d EventStoreDB "
+00003140: 6573 6462 2220 6f72 2022 6573 6462 2b64  esdb" or "esdb+d
+00003150: 6973 636f 7665 7222 2055 5249 2073 6368  iscover" URI sch
+00003160: 656d 6573 2e5c 6e5c 6e46 6f72 2065 7861  emes.\n\nFor exa
+00003170: 6d70 6c65 2c20 7468 6520 666f 6c6c 6f77  mple, the follow
+00003180: 696e 6720 636f 6e6e 6563 7469 6f6e 2073  ing connection s
+00003190: 7472 696e 6720 7370 6563 6966 6965 7320  tring specifies 
+000031a0: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
+000031b0: 7368 6f75 6c64 5c6e 6174 7465 6d70 7420  should\nattempt 
+000031c0: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
+000031d0: 7572 6522 2063 6f6e 6e65 6374 696f 6e20  ure" connection 
+000031e0: 746f 2070 6f72 7420 3231 3133 206f 6e20  to port 2113 on 
+000031f0: 226c 6f63 616c 686f 7374 222c 2061 6e64  "localhost", and
+00003200: 2075 7365 2074 6865 5c6e 636c 6965 6e74   use the\nclient
+00003210: 2063 7265 6465 6e74 6961 6c73 2022 7573   credentials "us
+00003220: 6572 6e61 6d65 2220 616e 6420 2270 6173  ername" and "pas
+00003230: 7377 6f72 6422 2077 6865 6e20 6d61 6b69  sword" when maki
+00003240: 6e67 2063 616c 6c73 2074 6f20 7468 6520  ng calls to the 
+00003250: 7365 7276 6572 2e5c 6e5c 6e20 2020 2065  server.\n\n    e
+00003260: 7364 623a 2f2f 7573 6572 6e61 6d65 3a70  sdb://username:p
+00003270: 6173 7377 6f72 6440 6c6f 6361 6c68 6f73  assword@localhos
+00003280: 743a 3231 3133 3f54 6c73 3d74 7275 655c  t:2113?Tls=true\
+00003290: 6e5c 6e54 6865 2063 6c69 656e 7420 6d75  n\nThe client mu
+000032a0: 7374 2062 6520 636f 6e66 6967 7572 6564  st be configured
+000032b0: 2074 6f20 6372 6561 7465 2061 2022 7365   to create a "se
+000032c0: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+000032d0: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
+000032e0: 6572 7665 722c 5c6e 6f72 2061 6c74 6572  erver,\nor alter
+000032f0: 6e61 7469 7665 6c79 2061 6e20 2269 6e73  natively an "ins
+00003300: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
+00003310: 6e20 746f 2061 6e20 2269 6e73 6563 7572  n to an "insecur
+00003320: 6522 2073 6572 7665 722e 2042 7920 6465  e" server. By de
+00003330: 6661 756c 742c 2074 6865 5c6e 636c 6965  fault, the\nclie
+00003340: 6e74 2077 696c 6c20 6174 7465 6d70 7420  nt will attempt 
+00003350: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
+00003360: 7572 6522 2063 6f6e 6e65 6374 696f 6e2e  ure" connection.
+00003370: 2041 6e64 2073 6f2c 2077 6865 6e20 636f   And so, when co
+00003380: 6e6e 6563 7469 6e67 2074 6f20 616e 5c6e  nnecting to an\n
+00003390: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
+000033a0: 722c 2074 6865 2063 6f6e 6e65 6374 696f  r, the connectio
+000033b0: 6e20 7374 7269 6e67 206d 7573 7420 7370  n string must sp
+000033c0: 6563 6966 7920 7468 6174 2074 6865 2063  ecify that the c
+000033d0: 6c69 656e 7420 7368 6f75 6c64 2061 7474  lient should att
+000033e0: 656d 7074 5c6e 746f 206d 616b 6520 616e  empt\nto make an
+000033f0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
+00003400: 6563 7469 6f6e 2e5c 6e5c 6e54 6865 2066  ection.\n\nThe f
+00003410: 6f6c 6c6f 7769 6e67 2063 6f6e 6e65 6374  ollowing connect
+00003420: 696f 6e20 7374 7269 6e67 2073 7065 6369  ion string speci
+00003430: 6669 6573 2074 6861 7420 7468 6520 636c  fies that the cl
+00003440: 6965 6e74 2073 686f 756c 645c 6e61 7474  ient should\natt
+00003450: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
+00003460: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
+00003470: 6e65 6374 696f 6e20 746f 2070 6f72 7420  nection to port 
+00003480: 3231 3134 206f 6e20 226c 6f63 616c 686f  2114 on "localho
+00003490: 7374 222e 5c6e 5768 656e 2063 6f6e 6e65  st".\nWhen conne
+000034a0: 6374 696e 6720 746f 2061 6e20 2269 6e73  cting to an "ins
+000034b0: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
+000034c0: 6865 2063 6c69 656e 7420 7769 6c6c 2069  he client will i
+000034d0: 676e 6f72 6520 616e 795c 6e75 7365 726e  gnore any\nusern
+000034e0: 616d 6520 616e 6420 7061 7373 776f 7264  ame and password
+000034f0: 2069 6e66 6f72 6d61 7469 6f6e 2069 6e63   information inc
+00003500: 6c75 6465 6420 696e 2074 6865 2063 6f6e  luded in the con
+00003510: 6e65 6374 696f 6e20 7374 7269 6e67 2c5c  nection string,\
+00003520: 6e73 6f20 7468 6174 2075 7365 726e 616d  nso that usernam
+00003530: 6573 2061 6e64 2070 6173 7377 6f72 6473  es and passwords
+00003540: 2061 7265 206e 6f74 2073 656e 7420 6f76   are not sent ov
+00003550: 6572 2061 6e20 2269 6e73 6563 7572 6522  er an "insecure"
+00003560: 2063 6f6e 6e65 6374 696f 6e2e 5c6e 5c6e   connection.\n\n
+00003570: 2020 2020 6573 6462 3a2f 2f6c 6f63 616c      esdb://local
+00003580: 686f 7374 3a32 3131 343f 546c 733d 6661  host:2114?Tls=fa
+00003590: 6c73 655c 6e5c 6e50 6c65 6173 6520 6e6f  lse\n\nPlease no
+000035a0: 7465 2c20 7468 6520 2269 6e73 6563 7572  te, the "insecur
+000035b0: 6522 2063 6f6e 6e65 6374 696f 6e20 7374  e" connection st
+000035c0: 7269 6e67 2075 7365 7320 6120 7175 6572  ring uses a quer
+000035d0: 7920 7374 7269 6e67 2077 6974 6820 7468  y string with th
+000035e0: 6520 6669 656c 642d 7661 6c75 655c 6e60  e field-value\n`
+000035f0: 546c 733d 6661 6c73 6560 2e20 5468 6520  Tls=false`. The 
+00003600: 7661 6c75 6520 6f66 2074 6869 7320 6669  value of this fi
+00003610: 656c 6420 6973 2062 7920 6465 6661 756c  eld is by defaul
+00003620: 7420 6074 7275 6560 2e20 556e 6c65 7373  t `true`. Unless
+00003630: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00003640: 7374 7269 6e67 5c6e 5552 4920 696e 636c  string\nURI incl
+00003650: 7564 6573 2074 6865 2066 6965 6c64 2d76  udes the field-v
+00003660: 616c 7565 2060 546c 733d 6661 6c73 6560  alue `Tls=false`
+00003670: 2069 6e20 7468 6520 7175 6572 7920 7374   in the query st
+00003680: 7269 6e67 2c20 7468 6520 6072 6f6f 745f  ring, the `root_
+00003690: 6365 7274 6966 6963 6174 6573 605c 6e63  certificates`\nc
+000036a0: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
+000036b0: 656e 7420 6973 2061 6c73 6f20 7265 7175  ent is also requ
+000036c0: 6972 6564 2e5c 6e5c 6e57 6865 6e20 636f  ired.\n\nWhen co
+000036d0: 6e6e 6563 7469 6e67 2074 6f20 6120 2273  nnecting to a "s
+000036e0: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
+000036f0: 6865 2060 726f 6f74 5f63 6572 7469 6669  he `root_certifi
+00003700: 6361 7465 7360 2061 7267 756d 656e 7420  cates` argument 
+00003710: 6973 2065 7870 6563 7465 6420 746f 5c6e  is expected to\n
+00003720: 6265 2061 2050 7974 686f 6e20 6073 7472  be a Python `str
+00003730: 6020 636f 6e74 6169 6e69 6e67 2050 454d  ` containing PEM
+00003740: 2065 6e63 6f64 6564 2053 534c 2f54 4c53   encoded SSL/TLS
+00003750: 2072 6f6f 7420 6365 7274 6966 6963 6174   root certificat
+00003760: 6573 2e20 5468 6973 2076 616c 7565 2069  es. This value i
+00003770: 735c 6e70 6173 7365 6420 6469 7265 6374  s\npassed direct
+00003780: 6c79 2074 6f20 6067 7270 632e 7373 6c5f  ly to `grpc.ssl_
+00003790: 6368 616e 6e65 6c5f 6372 6564 656e 7469  channel_credenti
+000037a0: 616c 7328 2960 2e20 4974 2069 7320 7573  als()`. It is us
+000037b0: 6564 2066 6f72 2061 7574 6865 6e74 6963  ed for authentic
+000037c0: 6174 696e 6720 7468 655c 6e73 6572 7665  ating the\nserve
+000037d0: 7220 746f 2074 6865 2063 6c69 656e 742e  r to the client.
+000037e0: 2049 7420 6973 2063 6f6d 6d6f 6e6c 7920   It is commonly 
+000037f0: 7468 6520 6365 7274 6966 6963 6174 6520  the certificate 
+00003800: 6f66 2074 6865 2063 6572 7469 6669 6361  of the certifica
+00003810: 7465 2061 7574 686f 7269 7479 2074 6861  te authority tha
+00003820: 745c 6e77 6173 2072 6573 706f 6e73 6962  t\nwas responsib
+00003830: 6c65 2066 6f72 2067 656e 6572 6174 696e  le for generatin
+00003840: 6720 7468 6520 5353 4c2f 544c 5320 6365  g the SSL/TLS ce
+00003850: 7274 6966 6963 6174 6520 7573 6564 2062  rtificate used b
+00003860: 7920 7468 6520 4576 656e 7453 746f 7265  y the EventStore
+00003870: 4442 2073 6572 7665 722e 5c6e 4275 742c  DB server.\nBut,
+00003880: 2061 6c74 6572 6e61 7469 7665 6c79 2066   alternatively f
+00003890: 6f72 2064 6576 656c 6f70 6d65 6e74 2c20  or development, 
+000038a0: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
+000038b0: 7365 7276 6572 5c27 7320 6365 7274 6966  server\'s certif
+000038c0: 6963 6174 6520 6974 7365 6c66 2e5c 6e5c  icate itself.\n\
+000038d0: 6e49 6e20 7468 6520 6578 616d 706c 6520  nIn the example 
+000038e0: 6265 6c6f 772c 2074 6865 2063 6f6e 7374  below, the const
+000038f0: 7275 6374 6f72 2061 7267 756d 656e 7420  ructor argument 
+00003900: 7661 6c75 6573 2061 7265 2074 616b 656e  values are taken
+00003910: 2066 726f 6d20 7468 6520 6f70 6572 6174   from the operat
+00003920: 696e 675c 6e73 7973 7465 6d20 656e 7669  ing\nsystem envi
+00003930: 726f 6e6d 656e 742e 2054 6869 7320 6973  ronment. This is
+00003940: 2061 2074 7970 6963 616c 2061 7272 616e   a typical arran
+00003950: 6765 6d65 6e74 2069 6e20 6120 7072 6f64  gement in a prod
+00003960: 7563 7469 6f6e 2065 6e76 6972 6f6e 6d65  uction environme
+00003970: 6e74 2e20 4974 2069 735c 6e64 6f6e 6520  nt. It is\ndone 
+00003980: 7468 6973 2077 6179 2068 6572 6520 736f  this way here so
+00003990: 2074 6861 7420 7468 6520 636f 6465 2069   that the code i
+000039a0: 6e20 7468 6973 2064 6f63 756d 656e 7461  n this documenta
+000039b0: 7469 6f6e 2063 616e 2062 6520 7465 7374  tion can be test
+000039c0: 6564 2077 6974 6820 626f 7468 5c6e 6120  ed with both\na 
+000039d0: 2273 6563 7572 6522 2061 6e64 2061 6e20  "secure" and an 
+000039e0: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
+000039f0: 722e 5c6e 5c6e 6060 6070 7974 686f 6e5c  r.\n\n```python\
+00003a00: 6e69 6d70 6f72 7420 6f73 5c6e 5c6e 636c  nimport os\n\ncl
+00003a10: 6965 6e74 203d 2045 5344 4243 6c69 656e  ient = ESDBClien
+00003a20: 7428 5c6e 2020 2020 7572 693d 6f73 2e67  t(\n    uri=os.g
+00003a30: 6574 656e 7628 2245 5344 425f 5552 4922  etenv("ESDB_URI"
+00003a40: 292c 5c6e 2020 2020 726f 6f74 5f63 6572  ),\n    root_cer
+00003a50: 7469 6669 6361 7465 733d 6f73 2e67 6574  tificates=os.get
+00003a60: 656e 7628 2245 5344 425f 524f 4f54 5f43  env("ESDB_ROOT_C
+00003a70: 4552 5449 4649 4341 5445 5322 292c 5c6e  ERTIFICATES"),\n
+00003a80: 295c 6e60 6060 5c6e 5c6e 2323 2043 6f6e  )\n```\n\n## Con
+00003a90: 6e65 6374 696f 6e20 7374 7269 6e67 735c  nection strings\
+00003aa0: 6e5c 6e41 6e20 4576 656e 7453 746f 7265  n\nAn EventStore
+00003ab0: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
+00003ac0: 7269 6e67 2069 7320 6120 5552 4920 7468  ring is a URI th
+00003ad0: 6174 2063 6f6e 666f 726d 7320 7769 7468  at conforms with
+00003ae0: 206f 6e65 206f 6620 7477 6f20 706f 7373   one of two poss
+00003af0: 6962 6c65 5c6e 7363 6865 6d65 733a 2065  ible\nschemes: e
+00003b00: 6974 6865 7220 7468 6520 2265 7364 6222  ither the "esdb"
+00003b10: 2073 6368 656d 652c 206f 7220 7468 6520   scheme, or the 
+00003b20: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
+00003b30: 7363 6865 6d65 2e5c 6e5c 6e54 6865 2073  scheme.\n\nThe s
+00003b40: 796e 7461 7820 616e 6420 7365 6d61 6e74  yntax and semant
+00003b50: 6963 7320 6f66 2074 6865 2045 7665 6e74  ics of the Event
+00003b60: 5374 6f72 6544 4220 5552 4920 7363 6865  StoreDB URI sche
+00003b70: 6d65 7320 6172 6520 6465 7363 7269 6265  mes are describe
+00003b80: 6420 6265 6c6f 772e 2054 6865 5c6e 7379  d below. The\nsy
+00003b90: 6e74 6178 2069 7320 6465 6669 6e65 6420  ntax is defined 
+00003ba0: 7573 696e 6720 5b45 424e 465d 2868 7474  using [EBNF](htt
+00003bb0: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
+00003bc0: 612e 6f72 672f 7769 6b69 2f45 7874 656e  a.org/wiki/Exten
+00003bd0: 6465 645f 4261 636b 7573 e280 934e 6175  ded_Backus...Nau
+00003be0: 725f 666f 726d 292e 5c6e 5c6e 2323 2320  r_form).\n\n### 
+00003bf0: 5477 6f20 7363 6865 6d65 735c 6e5c 6e54  Two schemes\n\nT
+00003c00: 6865 2022 6573 6462 2220 5552 4920 7363  he "esdb" URI sc
+00003c10: 6865 6d65 2063 616e 2062 6520 6465 6669  heme can be defi
+00003c20: 6e65 6420 696e 2074 6865 2066 6f6c 6c6f  ned in the follo
+00003c30: 7769 6e67 2077 6179 2e5c 6e5c 6e20 2020  wing way.\n\n   
+00003c40: 2065 7364 622d 7572 6920 3d20 2265 7364   esdb-uri = "esd
+00003c50: 623a 2f2f 2220 2c20 5b20 7573 6572 2d69  b://" , [ user-i
+00003c60: 6e66 6f20 2c20 2240 2220 5d20 2c20 6772  nfo , "@" ] , gr
+00003c70: 7063 2d74 6172 6765 742c 207b 2022 2c22  pc-target, { ","
+00003c80: 202c 2067 7270 632d 7461 7267 6574 207d   , grpc-target }
+00003c90: 202c 205b 2022 3f22 202c 2071 7565 7279   , [ "?" , query
+00003ca0: 2d73 7472 696e 6720 5d20 3b5c 6e5c 6e49  -string ] ;\n\nI
+00003cb0: 6e20 7468 6520 2265 7364 6222 2055 5249  n the "esdb" URI
+00003cc0: 2073 6368 656d 652c 2061 6674 6572 2074   scheme, after t
+00003cd0: 6865 206f 7074 696f 6e61 6c20 7573 6572  he optional user
+00003ce0: 2069 6e66 6f20 7374 7269 6e67 2c20 7468   info string, th
+00003cf0: 6572 6520 6d75 7374 2062 6520 6174 206c  ere must be at l
+00003d00: 6561 7374 5c6e 6f6e 6520 6752 5043 2074  east\none gRPC t
+00003d10: 6172 6765 742e 2049 6620 7468 6572 6520  arget. If there 
+00003d20: 6172 6520 7365 7665 7261 6c20 6752 5043  are several gRPC
+00003d30: 2074 6172 6765 7473 2c20 7468 6579 206d   targets, they m
+00003d40: 7573 7420 6265 2073 6570 6172 6174 6564  ust be separated
+00003d50: 2066 726f 6d20 6561 6368 5c6e 6f74 6865   from each\nothe
+00003d60: 7220 7769 7468 2074 6865 2022 2c22 2063  r with the "," c
+00003d70: 6861 7261 6374 6572 2e20 4561 6368 2067  haracter. Each g
+00003d80: 5250 4320 7461 7267 6574 2073 686f 756c  RPC target shoul
+00003d90: 6420 696e 6469 6361 7465 2061 6e20 4576  d indicate an Ev
+00003da0: 656e 7453 746f 7265 4442 2067 5250 435c  entStoreDB gRPC\
+00003db0: 6e73 6572 7665 7220 736f 636b 6574 2c20  nserver socket, 
+00003dc0: 6279 2073 7065 6369 6679 696e 6720 6120  by specifying a 
+00003dd0: 686f 7374 2061 6e64 2061 2070 6f72 7420  host and a port 
+00003de0: 6e75 6d62 6572 2073 6570 6172 6174 6564  number separated
+00003df0: 2077 6974 6820 7468 6520 223a 2220 6368   with the ":" ch
+00003e00: 6172 6163 7465 722e 5c6e 5468 6520 686f  aracter.\nThe ho
+00003e10: 7374 206d 6179 2062 6520 6120 686f 7374  st may be a host
+00003e20: 6e61 6d65 2074 6861 7420 6361 6e20 6265  name that can be
+00003e30: 2072 6573 6f6c 7665 6420 746f 2061 6e20   resolved to an 
+00003e40: 4950 2061 6464 7265 7373 2c20 6f72 2061  IP address, or a
+00003e50: 6e20 4950 2061 6464 7265 7373 2e5c 6e5c  n IP address.\n\
+00003e60: 6e20 2020 2067 7270 632d 7461 7267 6574  n    grpc-target
+00003e70: 203d 2028 2068 6f73 746e 616d 6520 7c20   = ( hostname | 
+00003e80: 6970 2d61 6464 7265 7373 2029 202c 2022  ip-address ) , "
+00003e90: 3a22 202c 2070 6f72 742d 6e75 6d62 6572  :" , port-number
+00003ea0: 203b 5c6e 5c6e 5c6e 5468 6520 2265 7364   ;\n\n\nThe "esd
+00003eb0: 622b 6469 7363 6f76 6572 2220 5552 4920  b+discover" URI 
+00003ec0: 7363 6865 6d65 2063 616e 2062 6520 6465  scheme can be de
+00003ed0: 6669 6e65 6420 696e 2074 6865 2066 6f6c  fined in the fol
+00003ee0: 6c6f 7769 6e67 2077 6179 2e5c 6e5c 6e20  lowing way.\n\n 
+00003ef0: 2020 2065 7364 622d 6469 7363 6f76 6572     esdb-discover
+00003f00: 2d75 7269 203d 2022 6573 6462 2b64 6973  -uri = "esdb+dis
+00003f10: 636f 7665 723a 2f2f 2220 2c20 5b20 7573  cover://" , [ us
+00003f20: 6572 2d69 6e66 6f2c 2022 4022 205d 202c  er-info, "@" ] ,
+00003f30: 2063 6c75 7374 6572 2d64 6f6d 6169 6e6e   cluster-domainn
+00003f40: 616d 6520 2c20 5b20 223f 2220 2c20 7175  ame , [ "?" , qu
+00003f50: 6572 792d 7374 7269 6e67 205d 203b 5c6e  ery-string ] ;\n
+00003f60: 5c6e 496e 2074 6865 2022 6573 6462 2b64  \nIn the "esdb+d
+00003f70: 6973 636f 7665 7222 2055 5249 2073 6368  iscover" URI sch
+00003f80: 656d 652c 2061 6674 6572 2074 6865 206f  eme, after the o
+00003f90: 7074 696f 6e61 6c20 7573 6572 2069 6e66  ptional user inf
+00003fa0: 6f20 7374 7269 6e67 2c20 7468 6572 6520  o string, there 
+00003fb0: 6d75 7374 2062 6520 615c 6e64 6f6d 6169  must be a\ndomai
+00003fc0: 6e20 6e61 6d65 2077 6869 6368 2073 686f  n name which sho
+00003fd0: 756c 6420 6964 656e 7469 6679 2061 2063  uld identify a c
+00003fe0: 6c75 7374 6572 206f 6620 4576 656e 7453  luster of EventS
+00003ff0: 746f 7265 4442 2073 6572 7665 7273 2e20  toreDB servers. 
+00004000: 5468 6520 636c 6965 6e74 2077 696c 6c20  The client will 
+00004010: 7573 655c 6e61 2044 4e53 2073 6572 7665  use\na DNS serve
+00004020: 7220 746f 2072 6573 6f6c 7665 2074 6865  r to resolve the
+00004030: 2064 6f6d 6169 6e20 6e61 6d65 2074 6f20   domain name to 
+00004040: 6120 6c69 7374 206f 6620 6164 6472 6573  a list of addres
+00004050: 7365 7320 6f66 2045 7665 6e74 5374 6f72  ses of EventStor
+00004060: 6544 4220 7365 7276 6572 732c 5c6e 6279  eDB servers,\nby
+00004070: 2071 7565 7279 696e 6720 666f 7220 5c27   querying for \'
+00004080: 415c 2720 7265 636f 7264 732e 2049 6e20  A\' records. In 
+00004090: 7468 6973 2063 6173 652c 2074 6865 2070  this case, the p
+000040a0: 6f72 7420 6e75 6d62 6572 2022 3231 3133  ort number "2113
+000040b0: 2220 7769 6c6c 2062 6520 7573 6564 2074  " will be used t
+000040c0: 6f5c 6e63 6f6e 7374 7275 6374 2067 5250  o\nconstruct gRP
+000040d0: 4320 7461 7267 6574 7320 6672 6f6d 2074  C targets from t
+000040e0: 6865 2061 6464 7265 7373 6573 206f 6274  he addresses obt
+000040f0: 6169 6e65 6420 6672 6f6d 205c 2741 5c27  ained from \'A\'
+00004100: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
+00004110: 6420 6279 2074 6865 5c6e 444e 5320 7365  d by the\nDNS se
+00004120: 7276 6572 2e20 5468 6572 6566 6f72 652c  rver. Therefore,
+00004130: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+00004140: 7573 6520 7468 6520 2265 7364 622b 6469  use the "esdb+di
+00004150: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
+00004160: 6d65 2c20 796f 7520 7769 6c6c 5c6e 6e65  me, you will\nne
+00004170: 6564 2074 6f20 636f 6e66 6967 7572 6520  ed to configure 
+00004180: 444e 5320 7768 656e 2073 6574 7469 6e67  DNS when setting
+00004190: 2075 7020 796f 7572 2045 7665 6e74 5374   up your EventSt
+000041a0: 6f72 6544 4220 636c 7573 7465 722e 5c6e  oreDB cluster.\n
+000041b0: 5c6e 5769 7468 2062 6f74 6820 7468 6520  \nWith both the 
+000041c0: 2265 7364 6222 2061 6e64 2022 6573 6462  "esdb" and "esdb
+000041d0: 2b64 6973 636f 7665 7222 2055 5249 2073  +discover" URI s
+000041e0: 6368 656d 6573 2c20 7468 6520 636c 6965  chemes, the clie
+000041f0: 6e74 2066 6972 7374 6c79 206f 6274 6169  nt firstly obtai
+00004200: 6e73 5c6e 6120 6c69 7374 206f 6620 6752  ns\na list of gR
+00004210: 5043 2074 6172 6765 7473 3a20 6569 7468  PC targets: eith
+00004220: 6572 2064 6972 6563 746c 7920 6672 6f6d  er directly from
+00004230: 2022 6573 6462 2220 636f 6e6e 6563 7469   "esdb" connecti
+00004240: 6f6e 2073 7472 696e 6773 3b20 6f72 2069  on strings; or i
+00004250: 6e64 6972 6563 746c 795c 6e66 726f 6d20  ndirectly\nfrom 
+00004260: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
+00004270: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00004280: 6773 2076 6961 2044 4e53 2e20 5468 6973  gs via DNS. This
+00004290: 206c 6973 7420 6f66 2074 6172 6765 7473   list of targets
+000042a0: 2069 7320 6b6e 6f77 6e20 6173 2074 6865   is known as the
+000042b0: 5c6e 2267 6f73 7369 7020 7365 6564 222e  \n"gossip seed".
+000042c0: 2054 6865 2063 6c69 656e 7420 7769 6c6c   The client will
+000042d0: 2074 6865 6e20 6174 7465 6d70 7420 746f   then attempt to
+000042e0: 2063 6f6e 6e65 6374 2074 6f20 6561 6368   connect to each
+000042f0: 2067 5250 4320 7461 7267 6574 2069 6e20   gRPC target in 
+00004300: 7475 726e 2c5c 6e61 7474 656d 7074 696e  turn,\nattemptin
+00004310: 6720 746f 2063 616c 6c20 7468 6520 4576  g to call the Ev
+00004320: 656e 7453 746f 7265 4442 2047 6f73 7369  entStoreDB Gossi
+00004330: 7020 4150 4920 746f 206f 6274 6169 6e20  p API to obtain 
+00004340: 696e 666f 726d 6174 696f 6e20 6162 6f75  information abou
+00004350: 7420 7468 655c 6e45 7665 6e74 5374 6f72  t the\nEventStor
+00004360: 6544 4220 636c 7573 7465 722e 2041 206d  eDB cluster. A m
+00004370: 656d 6265 7220 6f66 2074 6865 2063 6c75  ember of the clu
+00004380: 7374 6572 2069 7320 7365 6c65 6374 6564  ster is selected
+00004390: 2062 7920 7468 6520 636c 6965 6e74 2c20   by the client, 
+000043a0: 6163 636f 7264 696e 675c 6e74 6f20 7468  according\nto th
+000043b0: 6520 226e 6f64 6520 7072 6566 6572 656e  e "node preferen
+000043c0: 6365 2220 6f70 7469 6f6e 2e20 5468 6520  ce" option. The 
+000043d0: 636c 6965 6e74 206d 6179 2074 6865 6e20  client may then 
+000043e0: 6e65 6564 2074 6f20 636c 6f73 6520 6974  need to close it
+000043f0: 735c 6e63 6f6e 6e65 6374 696f 6e20 616e  s\nconnection an
+00004400: 6420 7265 636f 6e6e 6563 7420 746f 2074  d reconnect to t
+00004410: 6865 2073 656c 6563 7465 6420 7365 7276  he selected serv
+00004420: 6572 2e5c 6e5c 6e23 2323 2055 7365 7220  er.\n\n### User 
+00004430: 696e 666f 2073 7472 696e 675c 6e5c 6e49  info string\n\nI
+00004440: 6e20 626f 7468 2074 6865 2022 6573 6462  n both the "esdb
+00004450: 2220 616e 6420 2265 7364 622b 6469 7363  " and "esdb+disc
+00004460: 6f76 6572 2220 7363 6865 6d65 732c 2074  over" schemes, t
+00004470: 6865 2055 5249 206d 6179 2069 6e63 6c75  he URI may inclu
+00004480: 6465 2061 2075 7365 7220 696e 666f 2073  de a user info s
+00004490: 7472 696e 672e 5c6e 4966 2069 7420 6578  tring.\nIf it ex
+000044a0: 6973 7473 2069 6e20 7468 6520 5552 492c  ists in the URI,
+000044b0: 2074 6865 2075 7365 7220 696e 666f 2073   the user info s
+000044c0: 7472 696e 6720 6d75 7374 2062 6520 7365  tring must be se
+000044d0: 7061 7261 7465 6420 6672 6f6d 2074 6865  parated from the
+000044e0: 2072 6573 7420 6f66 2074 6865 2055 5249   rest of the URI
+000044f0: 5c6e 7769 7468 2074 6865 2022 4022 2063  \nwith the "@" c
+00004500: 6861 7261 6374 6572 2e20 5468 6520 7573  haracter. The us
+00004510: 6572 2069 6e66 6f20 7374 7269 6e67 206d  er info string m
+00004520: 7573 7420 696e 636c 7564 6520 6120 7573  ust include a us
+00004530: 6572 6e61 6d65 2061 6e64 2061 2070 6173  ername and a pas
+00004540: 7377 6f72 642c 5c6e 7365 7061 7261 7465  sword,\nseparate
+00004550: 6420 7769 7468 2074 6865 2022 3a22 2063  d with the ":" c
+00004560: 6861 7261 6374 6572 2e5c 6e5c 6e20 2020  haracter.\n\n   
+00004570: 2075 7365 722d 696e 666f 203d 2075 7365   user-info = use
+00004580: 726e 616d 6520 2c20 223a 2220 2c20 7061  rname , ":" , pa
+00004590: 7373 776f 7264 203b 5c6e 5c6e 5468 6520  ssword ;\n\nThe 
+000045a0: 7573 6572 2069 6e66 6f20 6973 2073 656e  user info is sen
+000045b0: 7420 6279 2074 6865 2063 6c69 656e 7420  t by the client 
+000045c0: 6173 2022 6361 6c6c 2063 7265 6465 6e74  as "call credent
+000045d0: 6961 6c73 2220 696e 2065 6163 6820 6361  ials" in each ca
+000045e0: 6c6c 2074 6f20 6120 2273 6563 7572 6522  ll to a "secure"
+000045f0: 5c6e 7365 7276 6572 2c20 696e 2061 2022  \nserver, in a "
+00004600: 6261 7369 6320 6175 7468 2220 6175 7468  basic auth" auth
+00004610: 6f72 697a 6174 696f 6e20 6865 6164 6572  orization header
+00004620: 2e20 5468 6973 2061 7574 686f 7269 7a61  . This authoriza
+00004630: 7469 6f6e 2068 6561 6465 7220 6973 2075  tion header is u
+00004640: 7365 6420 6279 5c6e 7468 6520 7365 7276  sed by\nthe serv
+00004650: 6572 2074 6f20 6175 7468 656e 7469 6361  er to authentica
+00004660: 7465 2074 6865 2063 6c69 656e 742e 2054  te the client. T
+00004670: 6865 2061 7574 686f 7269 7a61 7469 6f6e  he authorization
+00004680: 2068 6561 6465 7220 6973 206e 6f74 2073   header is not s
+00004690: 656e 7420 746f 5c6e 2269 6e73 6563 7572  ent to\n"insecur
+000046a0: 6522 2073 6572 7665 7273 2e5c 6e5c 6e23  e" servers.\n\n#
+000046b0: 2323 2051 7565 7279 2073 7472 696e 675c  ## Query string\
+000046c0: 6e5c 6e49 6e20 626f 7468 2074 6865 2022  n\nIn both the "
+000046d0: 6573 6462 2220 616e 6420 2265 7364 622b  esdb" and "esdb+
+000046e0: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
+000046f0: 732c 2074 6865 206f 7074 696f 6e61 6c20  s, the optional 
+00004700: 7175 6572 7920 7374 7269 6e67 206d 7573  query string mus
+00004710: 7420 6265 206f 6e65 5c6e 6f72 206d 616e  t be one\nor man
+00004720: 7920 6669 656c 642d 7661 6c75 6520 6172  y field-value ar
+00004730: 6775 6d65 6e74 732c 2073 6570 6172 6174  guments, separat
+00004740: 6564 2066 726f 6d20 6561 6368 206f 7468  ed from each oth
+00004750: 6572 2077 6974 6820 7468 6520 2226 2220  er with the "&" 
+00004760: 6368 6172 6163 7465 722e 5c6e 5c6e 2020  character.\n\n  
+00004770: 2020 7175 6572 792d 7374 7269 6e67 203d    query-string =
+00004780: 2066 6965 6c64 2d76 616c 7565 2c20 7b20   field-value, { 
+00004790: 2226 222c 2066 6965 6c64 2d76 616c 7565  "&", field-value
+000047a0: 207d 203b 5c6e 5c6e 4561 6368 2066 6965   } ;\n\nEach fie
+000047b0: 6c64 2d76 616c 7565 2061 7267 756d 656e  ld-value argumen
+000047c0: 7420 6d75 7374 2062 6520 6f6e 6520 6f66  t must be one of
+000047d0: 2074 6865 2073 7570 706f 7274 6564 2066   the supported f
+000047e0: 6965 6c64 732c 2061 6e64 2061 6e5c 6e61  ields, and an\na
+000047f0: 7070 726f 7072 6961 7465 2076 616c 7565  ppropriate value
+00004800: 2c20 7365 7061 7261 7465 6420 7769 7468  , separated with
+00004810: 2074 6865 2022 3d22 2063 6861 7261 6374   the "=" charact
+00004820: 6572 2e5c 6e5c 6e20 2020 2066 6965 6c64  er.\n\n    field
+00004830: 2d76 616c 7565 203d 2028 2022 546c 7322  -value = ( "Tls"
+00004840: 2c20 223d 2220 2c20 2274 7275 6522 207c  , "=" , "true" |
+00004850: 2022 6661 6c73 6522 2029 5c6e 2020 2020   "false" )\n    
+00004860: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00004870: 2254 6c73 5665 7269 6679 4365 7274 222c  "TlsVerifyCert",
+00004880: 2022 3d22 202c 2022 7472 7565 2220 7c20   "=" , "true" | 
+00004890: 2266 616c 7365 2220 295c 6e20 2020 2020  "false" )\n     
+000048a0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+000048b0: 436f 6e6e 6563 7469 6f6e 4e61 6d65 222c  ConnectionName",
+000048c0: 2022 3d22 202c 2073 7472 696e 6720 295c   "=" , string )\
+000048d0: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
+000048e0: 207c 2028 2022 4e6f 6465 5072 6566 6572   | ( "NodePrefer
+000048f0: 656e 6365 222c 2022 3d22 202c 2022 6c65  ence", "=" , "le
+00004900: 6164 6572 2220 7c20 2266 6f6c 6c6f 7765  ader" | "followe
+00004910: 7222 207c 2022 7265 6164 6f6e 6c79 7265  r" | "readonlyre
+00004920: 706c 6963 6122 207c 2022 7261 6e64 6f6d  plica" | "random
+00004930: 2220 295c 6e20 2020 2020 2020 2020 2020  " )\n           
+00004940: 2020 2020 207c 2028 2022 4465 6661 756c       | ( "Defaul
+00004950: 7444 6561 646c 696e 6522 2c20 223d 2220  tDeadline", "=" 
+00004960: 2c20 696e 7465 6765 7220 295c 6e20 2020  , integer )\n   
+00004970: 2020 2020 2020 2020 2020 2020 207c 2028               | (
+00004980: 2022 476f 7373 6970 5469 6d65 6f75 7422   "GossipTimeout"
+00004990: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+000049a0: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
+000049b0: 2020 207c 2028 2022 4d61 7844 6973 636f     | ( "MaxDisco
+000049c0: 7665 7241 7474 656d 7074 7322 2c20 223d  verAttempts", "=
+000049d0: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
+000049e0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000049f0: 2028 2022 4469 7363 6f76 6572 7949 6e74   ( "DiscoveryInt
+00004a00: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00004a10: 7465 6765 7220 295c 6e20 2020 2020 2020  teger )\n       
+00004a20: 2020 2020 2020 2020 207c 2028 2022 4d61           | ( "Ma
+00004a30: 7844 6973 636f 7665 7241 7474 656d 7074  xDiscoverAttempt
+00004a40: 7322 2c20 223d 2220 2c20 696e 7465 6765  s", "=" , intege
+00004a50: 7220 295c 6e20 2020 2020 2020 2020 2020  r )\n           
+00004a60: 2020 2020 207c 2028 2022 4b65 6570 416c       | ( "KeepAl
+00004a70: 6976 6549 6e74 6572 7661 6c22 2c20 223d  iveInterval", "=
+00004a80: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
+00004a90: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00004aa0: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
+00004ab0: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00004ac0: 7465 6765 7220 2920 3b5c 6e5c 6e54 6865  teger ) ;\n\nThe
+00004ad0: 2074 6162 6c65 2062 656c 6f77 2064 6573   table below des
+00004ae0: 6372 6962 6573 2074 6865 2071 7565 7279  cribes the query
+00004af0: 2066 6965 6c64 2d76 616c 7565 7320 7375   field-values su
+00004b00: 7070 6f72 7465 6420 6279 2074 6869 7320  pported by this 
+00004b10: 636c 6965 6e74 2e5c 6e5c 6e7c 2046 6965  client.\n\n| Fie
+00004b20: 6c64 2020 2020 2020 2020 2020 2020 2020  ld              
+00004b30: 207c 2056 616c 7565 2020 2020 2020 2020   | Value        
+00004b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b70: 2020 2020 2020 2020 207c 2044 6573 6372           | Descr
+00004b80: 6970 7469 6f6e 2020 2020 2020 2020 2020  iption          
+00004b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c10: 2020 2020 2020 2020 2020 2020 207c 5c6e               |\n
+00004c20: 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  |---------------
+00004c30: 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d  ------|---------
+00004c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d  --------------|-
+00004c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004d20: 2d2d 7c5c 6e7c 2054 6c73 2020 2020 2020  --|\n| Tls      
+00004d30: 2020 2020 2020 2020 2020 207c 2022 7472             | "tr
+00004d40: 7565 222c 2022 6661 6c73 6522 2028 6465  ue", "false" (de
+00004d50: 6661 756c 743a 2022 7472 7565 2229 2020  fault: "true")  
+00004d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d80: 2020 207c 2049 6620 2274 7275 6522 2074     | If "true" t
+00004d90: 6865 2063 6c69 656e 7420 7769 6c6c 2063  he client will c
+00004da0: 7265 6174 6520 6120 2273 6563 7572 6522  reate a "secure"
+00004db0: 2067 5250 4320 6368 616e 6e65 6c2e 2049   gRPC channel. I
+00004dc0: 6620 2266 616c 7365 2220 7468 6520 636c  f "false" the cl
+00004dd0: 6965 6e74 2077 696c 6c20 6372 6561 7465  ient will create
+00004de0: 2061 6e20 2269 6e73 6563 7572 6522 2067   an "insecure" g
+00004df0: 5250 4320 6368 616e 6e65 6c2e 2054 6869  RPC channel. Thi
+00004e00: 7320 6d75 7374 206d 6174 6368 2074 6865  s must match the
+00004e10: 2073 6572 7665 7220 636f 6e66 6967 7572   server configur
+00004e20: 6174 696f 6e2e 207c 5c6e 7c20 546c 7356  ation. |\n| TlsV
+00004e30: 6572 6966 7943 6572 7420 2020 2020 2020  erifyCert       
+00004e40: 7c20 2274 7275 6522 2c20 2266 616c 7365  | "true", "false
+00004e50: 2220 2864 6566 6175 6c74 3a20 2274 7275  " (default: "tru
+00004e60: 6522 2920 2020 2020 2020 2020 2020 2020  e")             
+00004e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e80: 2020 2020 2020 2020 7c20 5468 6973 2076          | This v
+00004e90: 616c 7565 2069 7320 6375 7272 656e 746c  alue is currentl
+00004ea0: 7920 6967 6e6f 7265 642e 2020 2020 2020  y ignored.      
+00004eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f20: 2020 2020 2020 2020 2020 2020 7c5c 6e7c              |\n|
+00004f30: 2043 6f6e 6e65 6374 696f 6e4e 616d 6520   ConnectionName 
+00004f40: 2020 2020 207c 2073 7472 696e 6720 2864       | string (d
+00004f50: 6566 6175 6c74 3a20 6175 746f 2d67 656e  efault: auto-gen
+00004f60: 6572 6174 6564 2076 6572 7369 6f6e 2d34  erated version-4
+00004f70: 2055 5549 4429 2020 2020 2020 2020 2020   UUID)          
+00004f80: 2020 2020 2020 2020 2020 2020 207c 2053               | S
+00004f90: 656e 7420 696e 2063 616c 6c20 6d65 7461  ent in call meta
+00004fa0: 6461 7461 2066 6f72 2065 7665 7279 2063  data for every c
+00004fb0: 616c 6c2c 2074 6f20 6964 656e 7469 6679  all, to identify
+00004fc0: 2074 6865 2063 6c69 656e 7420 746f 2074   the client to t
+00004fd0: 6865 2063 6c75 7374 6572 2e20 2020 2020  he cluster.     
+00004fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005030: 207c 5c6e 7c20 4e6f 6465 5072 6566 6572   |\n| NodePrefer
+00005040: 656e 6365 2020 2020 2020 7c20 226c 6561  ence      | "lea
+00005050: 6465 7222 2c20 2266 6f6c 6c6f 7765 7222  der", "follower"
+00005060: 2c20 2272 6561 646f 6e6c 7972 6570 6c69  , "readonlyrepli
+00005070: 6361 222c 2022 7261 6e64 6f6d 2220 2864  ca", "random" (d
+00005080: 6566 6175 6c74 3a20 226c 6561 6465 7222  efault: "leader"
+00005090: 2920 7c20 5468 6520 6e6f 6465 2073 7461  ) | The node sta
+000050a0: 7465 2070 7265 6665 7272 6564 2062 7920  te preferred by 
+000050b0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
+000050c0: 636c 6965 6e74 2077 696c 6c20 7365 6c65  client will sele
+000050d0: 6374 2061 206e 6f64 6520 6672 6f6d 2074  ct a node from t
+000050e0: 6865 2063 6c75 7374 6572 2069 6e66 6f20  he cluster info 
+000050f0: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
+00005100: 6520 476f 7373 6970 2041 5049 2061 6363  e Gossip API acc
+00005110: 6f72 6469 6e67 2074 6f20 7468 6973 2070  ording to this p
+00005120: 7265 6665 7265 6e63 652e 2020 2020 2020  reference.      
+00005130: 2020 2020 2020 7c5c 6e7c 2044 6566 6175        |\n| Defau
+00005140: 6c74 4465 6164 6c69 6e65 2020 2020 207c  ltDeadline     |
+00005150: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
+00005160: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
+00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005190: 2020 2020 2020 207c 2054 6865 2064 6566         | The def
+000051a0: 6175 6c74 2076 616c 7565 2028 696e 2073  ault value (in s
+000051b0: 6563 6f6e 6473 2920 6f66 2074 6865 2060  econds) of the `
+000051c0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+000051d0: 7420 6f66 2063 6c69 656e 7420 2277 7269  t of client "wri
+000051e0: 7465 2220 6d65 7468 6f64 7320 7375 6368  te" methods such
+000051f0: 2061 7320 6061 7070 656e 645f 6576 656e   as `append_even
+00005200: 7473 2829 602e 2020 2020 2020 2020 2020  ts()`.          
+00005210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005230: 2020 2020 2020 2020 2020 207c 5c6e 7c20             |\n| 
+00005240: 476f 7373 6970 5469 6d65 6f75 7420 2020  GossipTimeout   
+00005250: 2020 2020 7c20 696e 7465 6765 7220 2864      | integer (d
+00005260: 6566 6175 6c74 3a20 3529 2020 2020 2020  efault: 5)      
+00005270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005290: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
+000052a0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000052b0: 2869 6e20 7365 636f 6e64 7329 206f 6620  (in seconds) of 
+000052c0: 7468 6520 6074 696d 656f 7574 6020 6172  the `timeout` ar
+000052d0: 6775 6d65 6e74 206f 6620 676f 7373 6970  gument of gossip
+000052e0: 2072 6561 6420 6d65 7468 6f64 732c 2073   read methods, s
+000052f0: 7563 6820 6173 2060 7265 6164 5f67 6f73  uch as `read_gos
+00005300: 7369 7028 2960 2e20 2020 2020 2020 2020  sip()`.         
+00005310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005340: 7c5c 6e7c 204d 6178 4469 7363 6f76 6572  |\n| MaxDiscover
+00005350: 4174 7465 6d70 7473 207c 2069 6e74 6567  Attempts | integ
+00005360: 6572 2028 6465 6661 756c 743a 2031 3029  er (default: 10)
+00005370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053a0: 207c 2054 6865 206e 756d 6265 7220 6f66   | The number of
+000053b0: 2061 7474 656d 7074 7320 746f 2072 6561   attempts to rea
+000053c0: 6420 676f 7373 6970 2077 6865 6e20 636f  d gossip when co
+000053d0: 6e6e 6563 7469 6e67 206f 7220 7265 636f  nnecting or reco
+000053e0: 6e6e 6563 7469 6e67 2074 6f20 6120 636c  nnecting to a cl
+000053f0: 7573 7465 7220 6d65 6d62 6572 2e20 2020  uster member.   
+00005400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005440: 2020 2020 207c 5c6e 7c20 4469 7363 6f76       |\n| Discov
+00005450: 6572 7949 6e74 6572 7661 6c20 2020 7c20  eryInterval   | 
+00005460: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
+00005470: 3a20 3130 3029 2020 2020 2020 2020 2020  : 100)          
+00005480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054a0: 2020 2020 2020 7c20 486f 7720 6c6f 6e67        | How long
+000054b0: 2074 6f20 7761 6974 2028 696e 206d 696c   to wait (in mil
+000054c0: 6c69 7365 636f 6e64 7329 2062 6574 7765  liseconds) betwe
+000054d0: 656e 2067 6f73 7369 7020 7265 7472 6965  en gossip retrie
+000054e0: 732e 2020 2020 2020 2020 2020 2020 2020  s.              
+000054f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005540: 2020 2020 2020 2020 2020 7c5c 6e7c 204b            |\n| K
+00005550: 6565 7041 6c69 7665 496e 7465 7276 616c  eepAliveInterval
+00005560: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
+00005570: 6661 756c 743a 2060 4e6f 6e65 6029 2020  fault: `None`)  
+00005580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055a0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
+000055b0: 2076 616c 7565 206f 6620 7468 6520 2267   value of the "g
+000055c0: 7270 632e 6b65 6570 616c 6976 655f 6d73  rpc.keepalive_ms
+000055d0: 2220 6752 5043 2063 6861 6e6e 656c 206f  " gRPC channel o
+000055e0: 7074 696f 6e2e 2020 2020 2020 2020 2020  ption.          
+000055f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005640: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00005650: 5c6e 7c20 4b65 6570 416c 6976 6554 696d  \n| KeepAliveTim
+00005660: 656f 7574 2020 2020 7c20 696e 7465 6765  eout    | intege
+00005670: 7220 2864 6566 6175 6c74 3a20 604e 6f6e  r (default: `Non
+00005680: 6560 2920 2020 2020 2020 2020 2020 2020  e`)             
+00005690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056b0: 7c20 5468 6520 7661 6c75 6520 6f66 2074  | The value of t
+000056c0: 6865 2022 6772 7063 2e6b 6565 7061 6c69  he "grpc.keepali
+000056d0: 7665 5f74 696d 656f 7574 5f6d 7322 2067  ve_timeout_ms" g
+000056e0: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
+000056f0: 6f6e 2e20 2020 2020 2020 2020 2020 2020  on.             
+00005700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005750: 2020 2020 7c5c 6e5c 6e5c 6e23 2323 2045      |\n\n\n### E
+00005760: 7861 6d70 6c65 735c 6e5c 6e48 6572 6520  xamples\n\nHere 
+00005770: 6172 6520 736f 6d65 2065 7861 6d70 6c65  are some example
+00005780: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
+00005790: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
+000057a0: 696e 6720 5552 4973 2e5c 6e5c 6e54 6865  ing URIs.\n\nThe
+000057b0: 2066 6f6c 6c6f 7769 6e67 2055 5249 2077   following URI w
+000057c0: 696c 6c20 6361 7573 6520 7468 6520 636c  ill cause the cl
+000057d0: 6965 6e74 2074 6f20 636f 6e6e 6563 7420  ient to connect 
+000057e0: 746f 2c20 616e 6420 6765 745c 6e63 6c75  to, and get\nclu
+000057f0: 7374 6572 2069 6e66 6f2c 2066 726f 6d20  ster info, from 
+00005800: 2273 6563 7572 6522 2073 6572 7665 7220  "secure" server 
+00005810: 736f 636b 6574 2060 6c6f 6361 6c68 6f73  socket `localhos
+00005820: 743a 3231 3133 602e 2041 6e64 5c6e 7468  t:2113`. And\nth
+00005830: 656e 2074 6f20 636f 6e6e 6563 7420 746f  en to connect to
+00005840: 2061 2022 6c65 6164 6572 2220 6e6f 6465   a "leader" node
+00005850: 2e20 416e 6420 616c 736f 2074 6f20 7573  . And also to us
+00005860: 6520 2261 646d 696e 2220 616e 645c 6e22  e "admin" and\n"
+00005870: 6368 616e 6765 6974 2220 6173 2074 6865  changeit" as the
+00005880: 2075 7365 726e 616d 6520 616e 6420 7061   username and pa
+00005890: 7373 776f 7264 2077 6865 6e20 6d61 6b69  ssword when maki
+000058a0: 6e67 2063 616c 6c73 2074 6f5c 6e45 7665  ng calls to\nEve
+000058b0: 6e74 5374 6f72 6544 4220 4150 4920 6d65  ntStoreDB API me
+000058c0: 7468 6f64 732e 5c6e 5c6e 2020 2020 6573  thods.\n\n    es
+000058d0: 6462 3a2f 2f61 646d 696e 3a63 6861 6e67  db://admin:chang
+000058e0: 6569 7440 6c6f 6361 6c68 6f73 743a 3231  eit@localhost:21
+000058f0: 3133 5c6e 5c6e 5c6e 5468 6520 666f 6c6c  13\n\n\nThe foll
+00005900: 6f77 696e 6720 5552 4920 7769 6c6c 2063  owing URI will c
+00005910: 6175 7365 2074 6865 2063 6c69 656e 7420  ause the client 
+00005920: 746f 2067 6574 2063 6c75 7374 6572 2069  to get cluster i
+00005930: 6e66 6f20 6672 6f6d 5c6e 2269 6e73 6563  nfo from\n"insec
+00005940: 7572 6522 2073 6572 7665 7220 736f 636b  ure" server sock
+00005950: 6574 2031 3237 2e30 2e30 2e31 3a32 3131  et 127.0.0.1:211
+00005960: 342e 2020 416e 6420 7468 656e 2074 6f20  4.  And then to 
+00005970: 636f 6e6e 6563 7420 746f 5c6e 6120 226c  connect to\na "l
+00005980: 6561 6465 7222 206e 6f64 652e 5c6e 5c6e  eader" node.\n\n
+00005990: 2020 2020 6573 6462 3a2f 2f31 3237 2e30      esdb://127.0
+000059a0: 2e30 2e31 3a32 3131 343f 546c 733d 6661  .0.1:2114?Tls=fa
+000059b0: 6c73 655c 6e5c 6e5c 6e54 6865 2066 6f6c  lse\n\n\nThe fol
+000059c0: 6c6f 7769 6e67 2055 5249 2077 696c 6c20  lowing URI will 
+000059d0: 6361 7573 6520 7468 6520 636c 6965 6e74  cause the client
+000059e0: 2074 6f20 6765 7420 636c 7573 7465 7220   to get cluster 
+000059f0: 696e 666f 2066 726f 6d5c 6e61 6464 7265  info from\naddre
+00005a00: 7373 6573 2069 6e20 444e 5320 5c27 415c  sses in DNS \'A\
+00005a10: 2720 7265 636f 7264 7320 666f 7220 636c  ' records for cl
+00005a20: 7573 7465 7231 2e65 7861 6d70 6c65 2e63  uster1.example.c
+00005a30: 6f6d 2e20 416e 6420 7468 656e 5c6e 746f  om. And then\nto
+00005a40: 2063 6f6e 6e65 6374 2074 6f20 6120 226c   connect to a "l
+00005a50: 6561 6465 7222 206e 6f64 652e 2041 6e64  eader" node. And
+00005a60: 2075 7365 2061 2064 6566 6175 6c74 2064   use a default d
+00005a70: 6561 646c 696e 6520 6f66 2035 5c6e 7365  eadline of 5\nse
+00005a80: 636f 6e64 7320 7768 656e 206d 616b 696e  conds when makin
+00005a90: 6720 6361 6c6c 7320 746f 2045 7665 6e74  g calls to Event
+00005aa0: 5374 6f72 6520 4150 4920 2277 7269 7465  Store API "write
+00005ab0: 2220 6d65 7468 6f64 732e 5c6e 5c6e 2020  " methods.\n\n  
+00005ac0: 2020 6573 6462 2b64 6973 636f 7665 723a    esdb+discover:
+00005ad0: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
+00005ae0: 4063 6c75 7374 6572 312e 6578 616d 706c  @cluster1.exampl
+00005af0: 652e 636f 6d3f 4465 6661 756c 7444 6561  e.com?DefaultDea
+00005b00: 646c 696e 653d 355c 6e5c 6e5c 6e54 6865  dline=5\n\n\nThe
+00005b10: 2066 6f6c 6c6f 7769 6e67 2055 5249 2077   following URI w
+00005b20: 696c 6c20 6361 7573 6520 7468 6520 636c  ill cause the cl
+00005b30: 6965 6e74 2074 6f20 6765 7420 636c 7573  ient to get clus
+00005b40: 7465 7220 696e 666f 2066 726f 6d20 6569  ter info from ei
+00005b50: 7468 6572 5c6e 6c6f 6361 6c68 6f73 743a  ther\nlocalhost:
+00005b60: 3231 3131 2c20 6f72 206c 6f63 616c 686f  2111, or localho
+00005b70: 7374 3a32 3131 322c 206f 7220 6c6f 6361  st:2112, or loca
+00005b80: 6c68 6f73 743a 3231 3133 2e20 416e 6420  lhost:2113. And 
+00005b90: 7468 656e 2074 6f20 636f 6e6e 6563 745c  then to connect\
+00005ba0: 6e74 6f20 6120 2266 6f6c 6c6f 7765 7222  nto a "follower"
+00005bb0: 206e 6f64 652e 5c6e 5c6e 2020 2020 6573   node.\n\n    es
+00005bc0: 6462 3a2f 2f61 646d 696e 3a63 6861 6e67  db://admin:chang
+00005bd0: 6569 7440 6c6f 6361 6c68 6f73 743a 3231  eit@localhost:21
+00005be0: 3131 2c6c 6f63 616c 686f 7374 3a32 3131  11,localhost:211
+00005bf0: 322c 6c6f 6361 6c68 6f73 743a 3231 3133  2,localhost:2113
+00005c00: 3f4e 6f64 6550 7265 6665 7265 6e63 653d  ?NodePreference=
+00005c10: 666f 6c6c 6f77 6572 5c6e 5c6e 5c6e 5468  follower\n\n\nTh
+00005c20: 6520 666f 6c6c 6f77 696e 6720 5552 4920  e following URI 
+00005c30: 7769 6c6c 2063 6175 7365 2074 6865 2063  will cause the c
+00005c40: 6c69 656e 7420 746f 2067 6574 2063 6c75  lient to get clu
+00005c50: 7374 6572 2069 6e66 6f20 6672 6f6d 2061  ster info from a
+00005c60: 6464 7265 7373 6573 2069 6e5c 6e44 4e53  ddresses in\nDNS
+00005c70: 205c 2741 5c27 2072 6563 6f72 6473 2066   \'A\' records f
+00005c80: 6f72 2063 6c75 7374 6572 312e 6578 616d  or cluster1.exam
+00005c90: 706c 652e 636f 6d2e 2041 6e64 2074 6f20  ple.com. And to 
+00005ca0: 636f 6e66 6967 7572 6520 226b 6565 7020  configure "keep 
+00005cb0: 616c 6976 6522 2074 696d 656f 7574 5c6e  alive" timeout\n
+00005cc0: 616e 6420 696e 7465 7276 616c 2069 6e20  and interval in 
+00005cd0: 7468 6520 6752 5043 2063 6861 6e6e 656c  the gRPC channel
+00005ce0: 2e5c 6e5c 6e20 2020 2065 7364 622b 6469  .\n\n    esdb+di
+00005cf0: 7363 6f76 6572 3a2f 2f61 646d 696e 3a63  scover://admin:c
+00005d00: 6861 6e67 6569 7440 636c 7573 7465 7231  hangeit@cluster1
+00005d10: 2e65 7861 6d70 6c65 2e63 6f6d 3f4b 6565  .example.com?Kee
+00005d20: 7041 6c69 7665 496e 7465 7276 616c 3d31  pAliveInterval=1
+00005d30: 3030 3030 264b 6565 7041 6c69 7665 5469  0000&KeepAliveTi
+00005d40: 6d65 6f75 743d 3130 3030 305c 6e5c 6e5c  meout=10000\n\n\
+00005d50: 6e50 6c65 6173 6520 6e6f 7465 2c20 7468  nPlease note, th
+00005d60: 6520 636c 6965 6e74 2069 7320 696e 7365  e client is inse
+00005d70: 6e73 6974 6976 6520 746f 2074 6865 2063  nsitive to the c
+00005d80: 6173 6520 6f66 2066 6965 6c64 7320 616e  ase of fields an
+00005d90: 6420 7661 6c75 6573 2e20 4966 2066 6965  d values. If fie
+00005da0: 6c64 7320 6172 655c 6e72 6570 6561 7465  lds are\nrepeate
+00005db0: 6420 696e 2074 6865 2071 7565 7279 2073  d in the query s
+00005dc0: 7472 696e 672c 2074 6865 2071 7565 7279  tring, the query
+00005dd0: 2073 7472 696e 6720 7769 6c6c 2062 6520   string will be 
+00005de0: 7061 7273 6564 2077 6974 686f 7574 2065  parsed without e
+00005df0: 7272 6f72 2e20 486f 7765 7665 722c 5c6e  rror. However,\n
+00005e00: 7468 6520 636f 6e6e 6563 7469 6f6e 206f  the connection o
+00005e10: 7074 696f 6e73 2075 7365 6420 6279 2074  ptions used by t
+00005e20: 6865 2063 6c69 656e 7420 7769 6c6c 2075  he client will u
+00005e30: 7365 2074 6865 2076 616c 7565 206f 6620  se the value of 
+00005e40: 7468 6520 6669 7273 7420 6669 656c 642e  the first field.
+00005e50: 2041 6c6c 5c6e 7468 6520 6f74 6865 7220   All\nthe other 
+00005e60: 6669 656c 642d 7661 6c75 6573 2069 6e20  field-values in 
+00005e70: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
+00005e80: 2077 6974 6820 7468 6520 7361 6d65 2066   with the same f
+00005e90: 6965 6c64 206e 616d 6520 7769 6c6c 2062  ield name will b
+00005ea0: 6520 6967 6e6f 7265 642e 5c6e 4669 656c  e ignored.\nFiel
+00005eb0: 6473 2077 6974 686f 7574 2076 616c 7565  ds without value
+00005ec0: 7320 7769 6c6c 2061 6c73 6f20 6265 2069  s will also be i
+00005ed0: 676e 6f72 6564 2e5c 6e5c 6e49 6620 7468  gnored.\n\nIf th
+00005ee0: 6520 636c 6965 6e74 5c27 7320 6e6f 6465  e client\'s node
+00005ef0: 2070 7265 6665 7265 6e63 6520 6973 2022   preference is "
+00005f00: 6c65 6164 6572 2220 616e 6420 7468 6520  leader" and the 
+00005f10: 6e6f 6465 2062 6563 6f6d 6573 2061 5c6e  node becomes a\n
+00005f20: 2266 6f6c 6c6f 7765 7222 2c20 7468 6520  "follower", the 
+00005f30: 636c 6965 6e74 2077 696c 6c20 6174 7465  client will atte
+00005f40: 6d70 7420 746f 2072 6563 6f6e 6e65 6374  mpt to reconnect
+00005f50: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
+00005f60: 6c65 6164 6572 2077 6865 6e20 6120 6d65  leader when a me
+00005f70: 7468 6f64 5c6e 6973 2063 616c 6c65 6420  thod\nis called 
+00005f80: 7468 6174 2065 7870 6563 7473 2074 6f20  that expects to 
+00005f90: 6361 6c6c 2061 206c 6561 6465 722e 204d  call a leader. M
+00005fa0: 6574 686f 6473 2077 6869 6368 206d 7574  ethods which mut
+00005fb0: 6174 6520 7468 6520 7374 6174 6520 6f66  ate the state of
+00005fc0: 2074 6865 2064 6174 6162 6173 655c 6e65   the database\ne
+00005fd0: 7870 6563 7420 746f 2063 616c 6c20 6120  xpect to call a 
+00005fe0: 6c65 6164 6572 2e20 466f 7220 7375 6368  leader. For such
+00005ff0: 206d 6574 686f 6473 2c20 7468 6520 4854   methods, the HT
+00006000: 5450 2068 6561 6465 7220 2272 6571 7569  TP header "requi
+00006010: 7265 732d 6c65 6164 6572 2220 6973 2073  res-leader" is s
+00006020: 6574 2074 6f5c 6e22 7472 7565 222c 2061  et to\n"true", a
+00006030: 6e64 2074 6869 7320 6865 6164 6572 2069  nd this header i
+00006040: 7320 6f62 7365 7276 6564 2062 7920 7468  s observed by th
+00006050: 6520 7365 7276 6572 2c20 616e 6420 736f  e server, and so
+00006060: 2061 206e 6f64 6520 7768 6963 6820 6973   a node which is
+00006070: 206e 6f74 2061 206c 6561 6465 725c 6e74   not a leader\nt
+00006080: 6861 7420 7265 6365 6976 6573 2073 7563  hat receives suc
+00006090: 6820 6120 7265 7175 6573 7420 7769 6c6c  h a request will
+000060a0: 2072 6574 7572 6e20 616e 2065 7272 6f72   return an error
+000060b0: 2e20 5468 6973 2065 7272 6f72 2069 7320  . This error is 
+000060c0: 6465 7465 6374 6564 2062 7920 7468 6520  detected by the 
+000060d0: 636c 6965 6e74 2c5c 6e77 6869 6368 2077  client,\nwhich w
+000060e0: 696c 6c20 7468 656e 2063 6c6f 7365 2074  ill then close t
+000060f0: 6865 2063 7572 7265 6e74 2067 5250 4320  he current gRPC 
+00006100: 636f 6e6e 6563 7469 6f6e 2061 6e64 2063  connection and c
+00006110: 7265 6174 6520 6120 6e65 7720 636f 6e6e  reate a new conn
+00006120: 6563 7469 6f6e 2074 6f20 7468 655c 6e6c  ection to the\nl
+00006130: 6561 6465 722e 2054 6865 2072 6571 7565  eader. The reque
+00006140: 7374 2077 696c 6c20 7468 656e 2062 6520  st will then be 
+00006150: 7265 7472 6965 6420 7769 7468 2074 6865  retried with the
+00006160: 206c 6561 6465 722e 5c6e 5c6e 4966 2074   leader.\n\nIf t
+00006170: 6865 2063 6c69 656e 745c 2773 206e 6f64  he client\'s nod
+00006180: 6520 7072 6566 6572 656e 6365 2069 7320  e preference is 
+00006190: 2266 6f6c 6c6f 7765 7222 2061 6e64 2074  "follower" and t
+000061a0: 6865 7265 2061 7265 206e 6f20 666f 6c6c  here are no foll
+000061b0: 6f77 6572 5c6e 6e6f 6465 7320 696e 2074  ower\nnodes in t
+000061c0: 6865 2063 6c75 7374 6572 2c20 7468 656e  he cluster, then
+000061d0: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+000061e0: 2072 6169 7365 2061 6e20 6578 6365 7074   raise an except
+000061f0: 696f 6e2e 2053 696d 696c 6172 6c79 2c20  ion. Similarly, 
+00006200: 6966 2074 6865 5c6e 636c 6965 6e74 5c27  if the\nclient\'
+00006210: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
+00006220: 6520 6973 2022 7265 6164 6f6e 6c79 7265  e is "readonlyre
+00006230: 706c 6963 6122 2061 6e64 2074 6865 7265  plica" and there
+00006240: 2061 7265 206e 6f20 7265 6164 2d6f 6e6c   are no read-onl
+00006250: 7920 7265 706c 6963 615c 6e6e 6f64 6573  y replica\nnodes
+00006260: 2069 6e20 7468 6520 636c 7573 7465 722c   in the cluster,
+00006270: 2074 6865 6e20 7468 6520 636c 6965 6e74   then the client
+00006280: 2077 696c 6c20 616c 736f 2072 6169 7365   will also raise
+00006290: 2061 6e20 6578 6365 7074 696f 6e2e 5c6e   an exception.\n
+000062a0: 5c6e 5468 6520 6752 5043 2063 6861 6e6e  \nThe gRPC chann
+000062b0: 656c 206f 7074 696f 6e20 2267 7270 632e  el option "grpc.
+000062c0: 6d61 785f 7265 6365 6976 655f 6d65 7373  max_receive_mess
+000062d0: 6167 655f 6c65 6e67 7468 2220 6973 2061  age_length" is a
+000062e0: 7574 6f6d 6174 6963 616c 6c79 5c6e 636f  utomatically\nco
+000062f0: 6e66 6967 7572 6564 2074 6f20 7468 6520  nfigured to the 
+00006300: 7661 6c75 6520 6031 3720 2a20 3130 3234  value `17 * 1024
+00006310: 202a 2031 3032 3460 2e20 5468 6973 2076   * 1024`. This v
+00006320: 616c 7565 2063 616e 6e6f 7420 6265 2063  alue cannot be c
+00006330: 6861 6e67 6564 2e5c 6e5c 6e5c 6e23 2320  hanged.\n\n\n## 
+00006340: 4576 656e 7420 6f62 6a65 6374 735c 6e5c  Event objects\n\
+00006350: 6e54 6869 7320 7061 636b 6167 6520 6465  nThis package de
+00006360: 6669 6e65 7320 6120 604e 6577 4576 656e  fines a `NewEven
+00006370: 7460 2063 6c61 7373 2061 6e64 2061 2060  t` class and a `
+00006380: 5265 636f 7264 6564 4576 656e 7460 2063  RecordedEvent` c
+00006390: 6c61 7373 2e20 5468 655c 6e60 4e65 7745  lass. The\n`NewE
+000063a0: 7665 6e74 6020 636c 6173 7320 7368 6f75  vent` class shou
+000063b0: 6c64 2062 6520 7573 6564 2077 6865 6e20  ld be used when 
+000063c0: 7772 6974 696e 6720 6576 656e 7473 2074  writing events t
+000063d0: 6f20 7468 6520 6461 7461 6261 7365 2e20  o the database. 
+000063e0: 5468 655c 6e60 5265 636f 7264 6564 4576  The\n`RecordedEv
+000063f0: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
+00006400: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
+00006410: 6576 656e 7473 2066 726f 6d20 7468 6520  events from the 
+00006420: 6461 7461 6261 7365 2e5c 6e5c 6e23 2323  database.\n\n###
+00006430: 204e 6577 2065 7665 6e74 735c 6e5c 6e54   New events\n\nT
+00006440: 6865 2060 4e65 7745 7665 6e74 6020 636c  he `NewEvent` cl
+00006450: 6173 7320 7368 6f75 6c64 2062 6520 7573  ass should be us
+00006460: 6564 2077 6865 6e20 7772 6974 696e 6720  ed when writing 
+00006470: 6576 656e 7473 2074 6f20 616e 2045 7665  events to an Eve
+00006480: 6e74 5374 6f72 6544 4220 6461 7461 6261  ntStoreDB databa
+00006490: 7365 2e5c 6e59 6f75 2077 696c 6c20 6e65  se.\nYou will ne
+000064a0: 6564 2074 6f20 636f 6e73 7472 7563 7420  ed to construct 
+000064b0: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
+000064c0: 7320 6265 666f 7265 2063 616c 6c69 6e67  s before calling
+000064d0: 2074 6865 2060 6170 7065 6e64 5f65 7665   the `append_eve
+000064e0: 6e74 7328 2960 5c6e 616e 6420 6061 7070  nts()`\nand `app
+000064f0: 656e 645f 6576 656e 7428 2960 206d 6574  end_event()` met
+00006500: 686f 6473 2e5c 6e5c 6e54 6865 2060 4e65  hods.\n\nThe `Ne
+00006510: 7745 7665 6e74 6020 636c 6173 7320 6973  wEvent` class is
+00006520: 2061 2066 726f 7a65 6e20 5079 7468 6f6e   a frozen Python
+00006530: 2064 6174 6162 6173 652e 2049 7420 6861   database. It ha
+00006540: 7320 7477 6f20 7265 7175 6972 6564 2063  s two required c
+00006550: 6f6e 7374 7275 6374 6f72 5c6e 6172 6775  onstructor\nargu
+00006560: 6d65 6e74 7320 2860 7479 7065 6020 616e  ments (`type` an
+00006570: 6420 6064 6174 6160 2920 616e 6420 7468  d `data`) and th
+00006580: 7265 6520 6f70 7469 6f6e 616c 2063 6f6e  ree optional con
+00006590: 7374 7275 6374 6f72 2061 7267 756d 656e  structor argumen
+000065a0: 7473 2028 606d 6574 6164 6174 6160 2c5c  ts (`metadata`,\
+000065b0: 6e60 636f 6e74 656e 745f 7479 7065 6020  n`content_type` 
+000065c0: 616e 6420 6069 6460 292e 5c6e 5c6e 5468  and `id`).\n\nTh
+000065d0: 6520 7265 7175 6972 6564 2060 7479 7065  e required `type
+000065e0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+000065f0: 5079 7468 6f6e 2060 7374 7260 2c20 7573  Python `str`, us
+00006600: 6564 2074 6f20 6465 7363 7269 6265 2074  ed to describe t
+00006610: 6865 2074 7970 6520 6f66 5c6e 646f 6d61  he type of\ndoma
+00006620: 696e 2065 7665 6e74 2074 6861 7420 6973  in event that is
+00006630: 2062 6569 6e67 2072 6563 6f72 6465 642e   being recorded.
+00006640: 5c6e 5c6e 5468 6520 7265 7175 6972 6564  \n\nThe required
+00006650: 2060 6461 7461 6020 6172 6775 6d65 6e74   `data` argument
+00006660: 2069 7320 6120 5079 7468 6f6e 2060 6279   is a Python `by
+00006670: 7465 7360 206f 626a 6563 742c 2075 7365  tes` object, use
+00006680: 6420 746f 2073 7461 7465 2074 6865 5c6e  d to state the\n
+00006690: 7365 7269 616c 697a 6564 2064 6174 6120  serialized data 
+000066a0: 6f66 2074 6865 2064 6f6d 6169 6e20 6576  of the domain ev
+000066b0: 656e 7420 7468 6174 2069 7320 6265 696e  ent that is bein
+000066c0: 6720 7265 636f 7264 6564 2e5c 6e5c 6e54  g recorded.\n\nT
+000066d0: 6865 206f 7074 696f 6e61 6c20 606d 6574  he optional `met
+000066e0: 6164 6174 6160 2061 7267 756d 656e 7420  adata` argument 
+000066f0: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
+00006700: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
+00006710: 2074 6f20 696e 6469 6361 7465 2061 6e79   to indicate any
+00006720: 5c6e 6d65 7461 6461 7461 206f 6620 7468  \nmetadata of th
+00006730: 6520 6576 656e 7420 7468 6174 2077 696c  e event that wil
+00006740: 6c20 6265 2072 6563 6f72 6465 642e 2054  l be recorded. T
+00006750: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00006760: 2069 7320 616e 2065 6d70 7479 2060 6279   is an empty `by
+00006770: 7465 7360 5c6e 6f62 6a65 6374 2e5c 6e5c  tes`\nobject.\n\
+00006780: 6e54 6865 206f 7074 696f 6e61 6c20 6063  nThe optional `c
+00006790: 6f6e 7465 6e74 5f74 7970 6560 2061 7267  ontent_type` arg
+000067a0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+000067b0: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
+000067c0: 2069 6e64 6963 6174 6520 7468 655c 6e6b   indicate the\nk
+000067d0: 696e 6420 6f66 2064 6174 6120 7468 6174  ind of data that
+000067e0: 2069 7320 6265 696e 6720 7265 636f 7264   is being record
+000067f0: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
+00006800: 7661 6c75 6520 6973 2060 5c27 6170 706c  value is `\'appl
+00006810: 6963 6174 696f 6e2f 6a73 6f6e 5c27 602c  ication/json\'`,
+00006820: 5c6e 7768 6963 6820 696e 6469 6361 7465  \nwhich indicate
+00006830: 7320 7468 6174 2074 6865 2060 6461 7461  s that the `data
+00006840: 6020 7761 7320 7365 7269 616c 6973 6564  ` was serialised
+00006850: 2075 7369 6e67 204a 534f 4e2e 2041 6e20   using JSON. An 
+00006860: 616c 7465 726e 6174 6976 6520 7661 6c75  alternative valu
+00006870: 655c 6e66 6f72 2074 6869 7320 6172 6775  e\nfor this argu
+00006880: 6d65 6e74 2069 7320 7468 6520 6d6f 7265  ment is the more
+00006890: 2067 656e 6572 616c 2069 6e64 6963 6174   general indicat
+000068a0: 696f 6e20 605c 2761 7070 6c69 6361 7469  ion `\'applicati
+000068b0: 6f6e 2f6f 6374 6574 2d73 7472 6561 6d5c  on/octet-stream\
+000068c0: 2760 2e5c 6e5c 6e54 6865 206f 7074 696f  '`.\n\nThe optio
+000068d0: 6e61 6c20 6069 6460 2061 7267 756d 656e  nal `id` argumen
+000068e0: 7420 6973 2061 2050 7974 686f 6e20 6055  t is a Python `U
+000068f0: 5549 4460 206f 626a 6563 742c 2075 7365  UID` object, use
+00006900: 6420 746f 2073 7065 6369 6679 2074 6865  d to specify the
+00006910: 2075 6e69 7175 6520 4944 5c6e 6f66 2074   unique ID\nof t
+00006920: 6865 2065 7665 6e74 2074 6861 7420 7769  he event that wi
+00006930: 6c6c 2062 6520 7265 636f 7264 6564 2e20  ll be recorded. 
+00006940: 4966 206e 6f20 7661 6c75 6520 6973 2070  If no value is p
+00006950: 726f 7669 6465 642c 2061 206e 6577 2076  rovided, a new v
+00006960: 6572 7369 6f6e 2d34 2055 5549 445c 6e77  ersion-4 UUID\nw
+00006970: 696c 6c20 6265 2067 656e 6572 6174 6564  ill be generated
+00006980: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+00006990: 6e65 775f 6576 656e 7431 203d 204e 6577  new_event1 = New
+000069a0: 4576 656e 7428 5c6e 2020 2020 7479 7065  Event(\n    type
+000069b0: 3d5c 274f 7264 6572 4372 6561 7465 645c  =\'OrderCreated\
+000069c0: 272c 5c6e 2020 2020 6461 7461 3d62 5c27  ',\n    data=b\'
+000069d0: 7b22 6e61 6d65 223a 2022 4772 6567 227d  {"name": "Greg"}
+000069e0: 5c27 2c5c 6e29 5c6e 6173 7365 7274 206e  \',\n)\nassert n
+000069f0: 6577 5f65 7665 6e74 312e 7479 7065 203d  ew_event1.type =
+00006a00: 3d20 5c27 4f72 6465 7243 7265 6174 6564  = \'OrderCreated
+00006a10: 5c27 5c6e 6173 7365 7274 206e 6577 5f65  \'\nassert new_e
+00006a20: 7665 6e74 312e 6461 7461 203d 3d20 625c  vent1.data == b\
+00006a30: 277b 226e 616d 6522 3a20 2247 7265 6722  '{"name": "Greg"
+00006a40: 7d5c 275c 6e61 7373 6572 7420 6e65 775f  }\'\nassert new_
+00006a50: 6576 656e 7431 2e6d 6574 6164 6174 6120  event1.metadata 
+00006a60: 3d3d 2062 5c27 5c27 5c6e 6173 7365 7274  == b\'\'\nassert
+00006a70: 206e 6577 5f65 7665 6e74 312e 636f 6e74   new_event1.cont
+00006a80: 656e 745f 7479 7065 203d 3d20 5c27 6170  ent_type == \'ap
+00006a90: 706c 6963 6174 696f 6e2f 6a73 6f6e 5c27  plication/json\'
+00006aa0: 5c6e 6173 7365 7274 2069 7369 6e73 7461  \nassert isinsta
+00006ab0: 6e63 6528 6e65 775f 6576 656e 7431 2e69  nce(new_event1.i
+00006ac0: 642c 2075 7569 642e 5555 4944 295c 6e5c  d, uuid.UUID)\n\
+00006ad0: 6e65 7665 6e74 5f69 6420 3d20 7575 6964  nevent_id = uuid
+00006ae0: 2e75 7569 6434 2829 5c6e 6e65 775f 6576  .uuid4()\nnew_ev
+00006af0: 656e 7432 203d 204e 6577 4576 656e 7428  ent2 = NewEvent(
+00006b00: 5c6e 2020 2020 7479 7065 3d5c 2749 6d61  \n    type=\'Ima
+00006b10: 6765 4372 6561 7465 645c 272c 5c6e 2020  geCreated\',\n  
+00006b20: 2020 6461 7461 3d62 5c27 3031 3031 3031    data=b\'010101
+00006b30: 3031 3031 3031 3031 5c27 2c5c 6e20 2020  01010101\',\n   
+00006b40: 206d 6574 6164 6174 613d 625c 277b 2261   metadata=b\'{"a
+00006b50: 223a 2031 7d5c 272c 5c6e 2020 2020 636f  ": 1}\',\n    co
+00006b60: 6e74 656e 745f 7479 7065 3d5c 2761 7070  ntent_type=\'app
+00006b70: 6c69 6361 7469 6f6e 2f6f 6374 6574 2d73  lication/octet-s
+00006b80: 7472 6561 6d5c 272c 5c6e 2020 2020 6964  tream\',\n    id
+00006b90: 3d65 7665 6e74 5f69 642c 5c6e 295c 6e61  =event_id,\n)\na
+00006ba0: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
+00006bb0: 2e74 7970 6520 3d3d 205c 2749 6d61 6765  .type == \'Image
+00006bc0: 4372 6561 7465 645c 275c 6e61 7373 6572  Created\'\nasser
+00006bd0: 7420 6e65 775f 6576 656e 7432 2e64 6174  t new_event2.dat
+00006be0: 6120 3d3d 2062 5c27 3031 3031 3031 3031  a == b\'01010101
+00006bf0: 3031 3031 3031 5c27 5c6e 6173 7365 7274  010101\'\nassert
+00006c00: 206e 6577 5f65 7665 6e74 322e 6d65 7461   new_event2.meta
+00006c10: 6461 7461 203d 3d20 625c 277b 2261 223a  data == b\'{"a":
+00006c20: 2031 7d5c 275c 6e61 7373 6572 7420 6e65   1}\'\nassert ne
+00006c30: 775f 6576 656e 7432 2e63 6f6e 7465 6e74  w_event2.content
+00006c40: 5f74 7970 6520 3d3d 205c 2761 7070 6c69  _type == \'appli
+00006c50: 6361 7469 6f6e 2f6f 6374 6574 2d73 7472  cation/octet-str
+00006c60: 6561 6d5c 275c 6e61 7373 6572 7420 6e65  eam\'\nassert ne
+00006c70: 775f 6576 656e 7432 2e69 6420 3d3d 2065  w_event2.id == e
+00006c80: 7665 6e74 5f69 645c 6e60 6060 5c6e 5c6e  vent_id\n```\n\n
+00006c90: 2323 2320 5265 636f 7264 6564 2065 7665  ### Recorded eve
+00006ca0: 6e74 735c 6e5c 6e54 6865 2060 5265 636f  nts\n\nThe `Reco
+00006cb0: 7264 6564 4576 656e 7460 2063 6c61 7373  rdedEvent` class
+00006cc0: 2069 7320 7573 6564 2077 6865 6e20 7265   is used when re
+00006cd0: 6164 696e 6720 6576 656e 7473 2066 726f  ading events fro
+00006ce0: 6d20 616e 2045 7665 6e74 5374 6f72 6544  m an EventStoreD
+00006cf0: 425c 6e64 6174 6162 6173 652e 2054 6865  B\ndatabase. The
+00006d00: 2063 6c69 656e 7420 7769 6c6c 2072 6574   client will ret
+00006d10: 7572 6e20 6576 656e 7420 6f62 6a65 6374  urn event object
+00006d20: 7320 6f66 2074 6869 7320 7479 7065 2066  s of this type f
+00006d30: 726f 6d20 616c 6c20 6d65 7468 6f64 735c  rom all methods\
+00006d40: 6e74 6861 7420 7265 7475 726e 2072 6563  nthat return rec
+00006d50: 6f72 6465 6420 6576 656e 7473 2c20 7375  orded events, su
+00006d60: 6368 2061 7320 6072 6561 645f 7374 7265  ch as `read_stre
+00006d70: 616d 5f65 7665 6e74 7328 2960 2c20 6073  am_events()`, `s
+00006d80: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
+00006d90: 6e74 7328 2960 2c5c 6e61 6e64 2060 7265  nts()`,\nand `re
+00006da0: 6164 5f73 7562 7363 7269 7074 696f 6e28  ad_subscription(
+00006db0: 2960 2e20 596f 7520 646f 206e 6f74 206e  )`. You do not n
+00006dc0: 6565 6420 746f 2063 6f6e 7374 7275 6374  eed to construct
+00006dd0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00006de0: 6f62 6a65 6374 732e 5c6e 5c6e 4c69 6b65  objects.\n\nLike
+00006df0: 2060 4e65 7745 7665 6e74 602c 2074 6865   `NewEvent`, the
+00006e00: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00006e10: 2063 6c61 7373 2069 7320 616c 736f 2061   class is also a
+00006e20: 2066 726f 7a65 6e20 5079 7468 6f6e 2064   frozen Python d
+00006e30: 6174 6162 6173 652e 2049 7420 6861 735c  atabase. It has\
+00006e40: 6e61 6c6c 2074 6865 2061 7474 7269 6275  nall the attribu
+00006e50: 7465 7320 7468 6174 2060 4e65 7745 7665  tes that `NewEve
+00006e60: 6e74 6020 6861 7320 2860 7479 7065 602c  nt` has (`type`,
+00006e70: 2060 6461 7461 602c 2060 6d65 7461 6461   `data`, `metada
+00006e80: 7461 602c 2060 636f 6e74 656e 745f 7479  ta`, `content_ty
+00006e90: 7065 602c 2060 6964 6029 5c6e 616e 6420  pe`, `id`)\nand 
+00006ea0: 736f 6d65 2061 6464 6974 696f 6e61 6c20  some additional 
+00006eb0: 6174 7472 6962 7574 6573 2074 6861 7420  attributes that 
+00006ec0: 666f 6c6c 6f77 2066 726f 6d20 7468 6520  follow from the 
+00006ed0: 6661 6374 2074 6861 7420 616e 2065 7665  fact that an eve
+00006ee0: 6e74 2077 6173 2072 6563 6f72 6465 645c  nt was recorded\
+00006ef0: 6e28 6073 7472 6561 6d5f 6e61 6d65 602c  n(`stream_name`,
+00006f00: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
+00006f10: 6e60 2c20 6063 6f6d 6d69 745f 706f 7369  n`, `commit_posi
+00006f20: 7469 6f6e 6029 2e5c 6e5c 6e54 6865 2060  tion`).\n\nThe `
+00006f30: 7479 7065 6020 6174 7472 6962 7574 6520  type` attribute 
+00006f40: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+00006f50: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
+00006f60: 6174 6520 7468 6520 7479 7065 206f 6620  ate the type of 
+00006f70: 616e 2065 7665 6e74 5c6e 7468 6174 2077  an event\nthat w
+00006f80: 6173 2072 6563 6f72 6465 642e 5c6e 5c6e  as recorded.\n\n
+00006f90: 5468 6520 6064 6174 6160 2061 7474 7269  The `data` attri
+00006fa0: 6275 7465 2069 7320 6120 5079 7468 6f6e  bute is a Python
+00006fb0: 2060 6279 7465 7360 206f 626a 6563 742c   `bytes` object,
+00006fc0: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00006fd0: 6520 7468 6520 6461 7461 206f 6620 616e  e the data of an
+00006fe0: 5c6e 6576 656e 7420 7468 6174 2077 6173  \nevent that was
+00006ff0: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
+00007000: 6520 606d 6574 6164 6174 6160 2061 7474  e `metadata` att
+00007010: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+00007020: 6f6e 2060 6279 7465 7360 206f 626a 6563  on `bytes` objec
+00007030: 742c 2075 7365 6420 746f 2069 6e64 6963  t, used to indic
+00007040: 6174 6520 7468 6520 6d65 7461 6461 7461  ate the metadata
+00007050: 206f 665c 6e61 6e20 6576 656e 7420 7468   of\nan event th
+00007060: 6174 2077 6173 2072 6563 6f72 6465 642e  at was recorded.
+00007070: 5c6e 5c6e 5468 6520 6063 6f6e 7465 6e74  \n\nThe `content
+00007080: 5f74 7970 6560 2061 7474 7269 6275 7465  _type` attribute
+00007090: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+000070a0: 7260 2c20 7573 6564 2074 6f20 696e 6469  r`, used to indi
+000070b0: 6361 7465 2074 6865 2074 7970 6520 6f66  cate the type of
+000070c0: 5c6e 6461 7461 2074 6861 7420 7761 7320  \ndata that was 
+000070d0: 7265 636f 7264 6564 2066 6f72 2061 6e20  recorded for an 
+000070e0: 6576 656e 742e 2049 7420 6973 2075 7375  event. It is usu
+000070f0: 616c 6c79 2060 6170 706c 6963 6174 696f  ally `applicatio
+00007100: 6e2f 6a73 6f6e 602c 2069 6e64 6963 6174  n/json`, indicat
+00007110: 696e 675c 6e74 6861 7420 7468 6520 6461  ing\nthat the da
+00007120: 7461 2063 616e 2062 6520 7061 7273 6564  ta can be parsed
+00007130: 2061 7320 4a53 4f4e 2e20 416c 7465 726e   as JSON. Altern
+00007140: 6174 6976 656c 792c 2069 7420 6973 2060  atively, it is `
+00007150: 6170 706c 6963 6174 696f 6e2f 6f63 7465  application/octe
+00007160: 742d 7374 7265 616d 602e 5c6e 5c6e 5468  t-stream`.\n\nTh
+00007170: 6520 6069 6460 2061 7474 7269 6275 7465  e `id` attribute
+00007180: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
+00007190: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
+000071a0: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+000071b0: 2075 6e69 7175 6520 4944 206f 6620 616e   unique ID of an
+000071c0: 5c6e 6576 656e 7420 7468 6174 2077 6173  \nevent that was
+000071d0: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
+000071e0: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
+000071f0: 6174 7472 6962 7574 6520 6973 2061 2050  attribute is a P
+00007200: 7974 686f 6e20 6073 7472 602c 2075 7365  ython `str`, use
+00007210: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
+00007220: 6520 6e61 6d65 206f 6620 615c 6e73 7472  e name of a\nstr
+00007230: 6561 6d20 696e 2077 6869 6368 2061 6e20  eam in which an 
+00007240: 6576 656e 7420 7761 7320 7265 636f 7264  event was record
+00007250: 6564 2e5c 6e5c 6e54 6865 2060 7374 7265  ed.\n\nThe `stre
+00007260: 616d 5f70 6f73 6974 696f 6e60 2061 7474  am_position` att
+00007270: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+00007280: 6f6e 2060 696e 7460 2c20 7573 6564 2074  on `int`, used t
+00007290: 6f20 696e 6469 6361 7465 2074 6865 2070  o indicate the p
+000072a0: 6f73 6974 696f 6e20 696e 2061 5c6e 7374  osition in a\nst
+000072b0: 7265 616d 2061 7420 7768 6963 6820 616e  ream at which an
+000072c0: 2065 7665 6e74 2077 6173 2072 6563 6f72   event was recor
+000072d0: 6465 642e 5c6e 5c6e 496e 2045 7665 6e74  ded.\n\nIn Event
+000072e0: 5374 6f72 6544 422c 2061 2022 7374 7265  StoreDB, a "stre
+000072f0: 616d 2070 6f73 6974 696f 6e22 2069 7320  am position" is 
+00007300: 616e 2069 6e74 6567 6572 2072 6570 7265  an integer repre
+00007310: 7365 6e74 696e 6720 7468 6520 706f 7369  senting the posi
+00007320: 7469 6f6e 206f 6620 615c 6e72 6563 6f72  tion of a\nrecor
+00007330: 6465 6420 6576 656e 7420 696e 2061 2073  ded event in a s
+00007340: 7472 6561 6d2e 2045 6163 6820 7265 636f  tream. Each reco
+00007350: 7264 6564 2065 7665 6e74 2069 7320 7265  rded event is re
+00007360: 636f 7264 6564 2061 7420 6120 706f 7369  corded at a posi
+00007370: 7469 6f6e 2069 6e20 6120 7374 7265 616d  tion in a stream
+00007380: 2e5c 6e45 6163 6820 7374 7265 616d 2070  .\nEach stream p
+00007390: 6f73 6974 696f 6e20 6973 206f 6363 7570  osition is occup
+000073a0: 6965 6420 6279 206f 6e6c 7920 6f6e 6520  ied by only one 
+000073b0: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
+000073c0: 4e65 7720 6576 656e 7473 2061 7265 2072  New events are r
+000073d0: 6563 6f72 6465 6420 6174 2074 6865 5c6e  ecorded at the\n
+000073e0: 6e65 7874 2075 6e6f 6363 7570 6965 6420  next unoccupied 
+000073f0: 706f 7369 7469 6f6e 2e20 416c 6c20 7365  position. All se
+00007400: 7175 656e 6365 7320 6f66 2073 7472 6561  quences of strea
+00007410: 6d20 706f 7369 7469 6f6e 7320 6172 6520  m positions are 
+00007420: 7a65 726f 2d62 6173 6564 2061 6e64 2067  zero-based and g
+00007430: 6170 6c65 7373 2e5c 6e5c 6e54 6865 2060  apless.\n\nThe `
+00007440: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+00007450: 2061 7474 7269 6275 7465 2069 7320 6120   attribute is a 
+00007460: 5079 7468 6f6e 2060 696e 7460 2c20 7573  Python `int`, us
+00007470: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
+00007480: 6865 2070 6f73 6974 696f 6e20 696e 2074  he position in t
+00007490: 6865 5c6e 6461 7461 6261 7365 2061 7420  he\ndatabase at 
+000074a0: 7768 6963 6820 616e 2065 7665 6e74 2077  which an event w
+000074b0: 6173 2072 6563 6f72 6465 642e 5c6e 5c6e  as recorded.\n\n
+000074c0: 496e 2045 7665 6e74 5374 6f72 6544 422c  In EventStoreDB,
+000074d0: 2061 2022 636f 6d6d 6974 2070 6f73 6974   a "commit posit
+000074e0: 696f 6e22 2069 7320 616e 2069 6e74 6567  ion" is an integ
+000074f0: 6572 2072 6570 7265 7365 6e74 696e 6720  er representing 
+00007500: 7468 6520 706f 7369 7469 6f6e 206f 6620  the position of 
+00007510: 615c 6e72 6563 6f72 6465 6420 6576 656e  a\nrecorded even
+00007520: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
+00007530: 652e 2045 6163 6820 7265 636f 7264 6564  e. Each recorded
+00007540: 2065 7665 6e74 2069 7320 7265 636f 7264   event is record
+00007550: 6564 2061 7420 6120 706f 7369 7469 6f6e  ed at a position
+00007560: 2069 6e20 7468 655c 6e64 6174 6162 6173   in the\ndatabas
+00007570: 652e 2045 6163 6820 636f 6d6d 6974 2070  e. Each commit p
+00007580: 6f73 6974 696f 6e20 6973 206f 6363 7570  osition is occup
+00007590: 6965 6420 6279 206f 6e6c 7920 6f6e 6520  ied by only one 
+000075a0: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
+000075b0: 436f 6d6d 6974 2070 6f73 6974 696f 6e73  Commit positions
+000075c0: 5c6e 6172 6520 7a65 726f 2d62 6173 6564  \nare zero-based
+000075d0: 2061 6e64 2069 6e63 7265 6173 6520 6d6f   and increase mo
+000075e0: 6e6f 746f 6e69 6361 6c6c 7920 6173 206e  notonically as n
+000075f0: 6577 2065 7665 6e74 7320 6172 6520 7265  ew events are re
+00007600: 636f 7264 6564 2e20 4275 742c 2075 6e6c  corded. But, unl
+00007610: 696b 6520 7374 7265 616d 5c6e 706f 7369  ike stream\nposi
+00007620: 7469 6f6e 732c 2074 6865 2073 6571 7565  tions, the seque
+00007630: 6e63 6520 6f66 2073 7563 6365 7373 6976  nce of successiv
+00007640: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00007650: 6e73 2069 7320 6e6f 7420 6761 706c 6573  ns is not gaples
+00007660: 732e 2049 6e64 6565 642c 2074 6865 7265  s. Indeed, there
+00007670: 2061 7265 5c6e 7573 7561 6c6c 7920 6c61   are\nusually la
+00007680: 7267 6520 6469 6666 6572 656e 6365 7320  rge differences 
+00007690: 6265 7477 6565 6e20 7468 6520 636f 6d6d  between the comm
+000076a0: 6974 2070 6f73 6974 696f 6e73 206f 6620  it positions of 
+000076b0: 7375 6363 6573 7369 7665 6c79 2072 6563  successively rec
+000076c0: 6f72 6465 6420 6576 656e 7473 2e5c 6e5c  orded events.\n\
+000076d0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 6672  n\n```python\nfr
+000076e0: 6f6d 2065 7364 6263 6c69 656e 742e 6576  om esdbclient.ev
+000076f0: 656e 7473 2069 6d70 6f72 7420 5265 636f  ents import Reco
+00007700: 7264 6564 4576 656e 745c 6e5c 6e72 6563  rdedEvent\n\nrec
+00007710: 6f72 6465 645f 6576 656e 7420 3d20 5265  orded_event = Re
+00007720: 636f 7264 6564 4576 656e 7428 5c6e 2020  cordedEvent(\n  
+00007730: 2020 7479 7065 3d5c 274f 7264 6572 4372    type=\'OrderCr
+00007740: 6561 7465 645c 272c 5c6e 2020 2020 6461  eated\',\n    da
+00007750: 7461 3d62 5c27 7b7d 5c27 2c5c 6e20 2020  ta=b\'{}\',\n   
+00007760: 206d 6574 6164 6174 613d 625c 275c 272c   metadata=b\'\',
+00007770: 5c6e 2020 2020 636f 6e74 656e 745f 7479  \n    content_ty
+00007780: 7065 3d5c 2761 7070 6c69 6361 7469 6f6e  pe=\'application
+00007790: 2f6a 736f 6e5c 272c 5c6e 2020 2020 6964  /json\',\n    id
+000077a0: 3d75 7569 642e 7575 6964 3428 292c 5c6e  =uuid.uuid4(),\n
+000077b0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+000077c0: 5c27 7374 7265 616d 315c 272c 5c6e 2020  \'stream1\',\n  
+000077d0: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
+000077e0: 6e3d 302c 5c6e 2020 2020 636f 6d6d 6974  n=0,\n    commit
+000077f0: 5f70 6f73 6974 696f 6e3d 3531 322c 5c6e  _position=512,\n
+00007800: 295c 6e60 6060 5c6e 5c6e 5c6e 2323 2053  )\n```\n\n\n## S
+00007810: 7472 6561 6d73 5c6e 5c6e 496e 2045 7665  treams\n\nIn Eve
+00007820: 6e74 5374 6f72 6544 422c 2061 2022 7374  ntStoreDB, a "st
+00007830: 7265 616d 2220 6973 2061 2073 6571 7565  ream" is a seque
+00007840: 6e63 6520 6f66 2072 6563 6f72 6465 6420  nce of recorded 
+00007850: 6576 656e 7473 2074 6861 7420 616c 6c20  events that all 
+00007860: 6861 7665 5c6e 7468 6520 7361 6d65 2022  have\nthe same "
+00007870: 7374 7265 616d 206e 616d 6522 2e20 5468  stream name". Th
+00007880: 6572 6520 7769 6c6c 206e 6f72 6d61 6c6c  ere will normall
+00007890: 7920 6265 206d 616e 7920 7374 7265 616d  y be many stream
+000078a0: 7320 696e 2061 2064 6174 6162 6173 652c  s in a database,
+000078b0: 5c6e 6561 6368 2077 6974 6820 6d61 6e79  \neach with many
+000078c0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000078d0: 2e20 4561 6368 2072 6563 6f72 6465 6420  . Each recorded 
+000078e0: 6576 656e 7420 6861 7320 6120 706f 7369  event has a posi
+000078f0: 7469 6f6e 2069 6e20 6974 7320 7374 7265  tion in its stre
+00007900: 616d 5c6e 2874 6865 2022 7374 7265 616d  am\n(the "stream
+00007910: 2070 6f73 6974 696f 6e22 292c 2061 6e64   position"), and
+00007920: 2061 2070 6f73 6974 696f 6e20 696e 2074   a position in t
+00007930: 6865 2064 6174 6162 6173 6520 2874 6865  he database (the
+00007940: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00007950: 6e22 292e 5c6e 5374 7265 616d 2070 6f73  n").\nStream pos
+00007960: 6974 696f 6e73 2061 7265 207a 6572 6f2d  itions are zero-
+00007970: 6261 7365 6420 616e 6420 6761 706c 6573  based and gaples
+00007980: 732e 2043 6f6d 6d69 7420 706f 7369 7469  s. Commit positi
+00007990: 6f6e 7320 6172 6520 616c 736f 207a 6572  ons are also zer
+000079a0: 6f2d 6261 7365 642c 5c6e 6275 7420 6172  o-based,\nbut ar
+000079b0: 6520 6e6f 7420 6761 706c 6573 732e 5c6e  e not gapless.\n
+000079c0: 5c6e 5468 6520 6d65 7468 6f64 7320 6061  \nThe methods `a
+000079d0: 7070 656e 645f 6576 656e 7473 2829 602c  ppend_events()`,
+000079e0: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
+000079f0: 656e 7473 2829 6020 616e 6420 6072 6561  ents()` and `rea
+00007a00: 645f 616c 6c5f 6576 656e 7473 2829 6020  d_all_events()` 
+00007a10: 6361 6e5c 6e62 6520 7573 6564 2074 6f20  can\nbe used to 
+00007a20: 7265 6164 2061 6e64 2072 6563 6f72 6420  read and record 
+00007a30: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+00007a40: 5c6e 5c6e 2323 2320 4170 7065 6e64 2065  \n\n### Append e
+00007a50: 7665 6e74 735c 6e5c 6e2a 7265 7175 6972  vents\n\n*requir
+00007a60: 6573 206c 6561 6465 722a 5c6e 5c6e 5468  es leader*\n\nTh
+00007a70: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+00007a80: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00007a90: 6520 7573 6564 2061 746f 6d69 6361 6c6c  e used atomicall
+00007aa0: 7920 746f 2072 6563 6f72 6420 6120 7365  y to record a se
+00007ab0: 7175 656e 6365 206f 6620 6e65 7720 6576  quence of new ev
+00007ac0: 656e 7473 2e5c 6e49 6620 7468 6520 6f70  ents.\nIf the op
+00007ad0: 6572 6174 696f 6e20 6973 2073 7563 6365  eration is succe
+00007ae0: 7373 6675 6c2c 2069 7420 7265 7475 726e  ssful, it return
+00007af0: 7320 7468 6520 636f 6d6d 6974 2070 6f73  s the commit pos
+00007b00: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
+00007b10: 7420 6576 656e 7420 696e 2074 6865 5c6e  t event in the\n
+00007b20: 7365 7175 656e 6365 2074 6861 7420 6861  sequence that ha
+00007b30: 7320 6265 656e 2072 6563 6f72 6465 642e  s been recorded.
+00007b40: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00007b50: 6861 7320 7468 7265 6520 7265 7175 6972  has three requir
+00007b60: 6564 2061 7267 756d 656e 7473 2c20 6073  ed arguments, `s
+00007b70: 7472 6561 6d5f 6e61 6d65 602c 2060 6375  tream_name`, `cu
+00007b80: 7272 656e 745f 7665 7273 696f 6e60 5c6e  rrent_version`\n
+00007b90: 616e 6420 6065 7665 6e74 7360 2e5c 6e5c  and `events`.\n\
+00007ba0: 6e54 6865 2072 6571 7569 7265 6420 6073  nThe required `s
+00007bb0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+00007bc0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00007bd0: 2060 7374 7260 2074 6861 7420 756e 6971   `str` that uniq
+00007be0: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
+00007bf0: 615c 6e73 7472 6561 6d20 746f 2077 6869  a\nstream to whi
+00007c00: 6368 2061 2073 6571 7565 6e63 6520 6f66  ch a sequence of
+00007c10: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+00007c20: 6170 7065 6e64 6564 2e5c 6e5c 6e54 6865  appended.\n\nThe
+00007c30: 2072 6571 7569 7265 6420 6063 7572 7265   required `curre
+00007c40: 6e74 5f76 6572 7369 6f6e 6020 6172 6775  nt_version` argu
+00007c50: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
+00007c60: 2074 6f20 6265 2065 6974 6865 7220 6120   to be either a 
+00007c70: 5079 7468 6f6e 2060 696e 7460 5c6e 7468  Python `int`\nth
+00007c80: 6174 2069 6e64 6963 6174 6573 2074 6865  at indicates the
+00007c90: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00007ca0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
+00007cb0: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
+00007cc0: 6865 2073 7472 6561 6d2c 206f 725c 6e60  he stream, or\n`
+00007cd0: 4e6f 6e65 6020 6966 2074 6865 2073 7472  None` if the str
+00007ce0: 6561 6d20 646f 6573 206e 6f74 2079 6574  eam does not yet
+00007cf0: 2065 7869 7374 206f 7220 6861 7320 6265   exist or has be
+00007d00: 656e 2064 656c 6574 6564 2e20 5468 6520  en deleted. The 
+00007d10: 7374 7265 616d 2070 6f73 6974 696f 6e73  stream positions
+00007d20: 5c6e 6172 6520 7a65 726f 2d62 6173 6564  \nare zero-based
+00007d30: 2061 6e64 2067 6170 6c65 7373 2c20 736f   and gapless, so
+00007d40: 2074 6861 7420 6966 2061 2073 7472 6561   that if a strea
+00007d50: 6d20 6861 7320 7477 6f20 6576 656e 7473  m has two events
+00007d60: 2c20 7468 6520 6063 7572 7265 6e74 5f76  , the `current_v
+00007d70: 6572 7369 6f6e 605c 6e73 686f 756c 6420  ersion`\nshould 
+00007d80: 6265 2031 2e20 4966 2061 6e20 696e 636f  be 1. If an inco
+00007d90: 7272 6563 7420 7661 6c75 6520 6973 2067  rrect value is g
+00007da0: 6976 656e 2c20 7468 6973 206d 6574 686f  iven, this metho
+00007db0: 6420 7769 6c6c 2072 6169 7365 2061 5c6e  d will raise a\n
+00007dc0: 6057 726f 6e67 4375 7272 656e 7456 6572  `WrongCurrentVer
+00007dd0: 7369 6f6e 6020 6578 6365 7074 696f 6e2e  sion` exception.
+00007de0: 2054 6869 7320 6265 6861 7669 6f72 2069   This behavior i
+00007df0: 7320 6465 7369 676e 6564 2074 6f20 7072  s designed to pr
+00007e00: 6f76 6964 6520 636f 6e63 7572 7265 6e63  ovide concurrenc
+00007e10: 795c 6e63 6f6e 7472 6f6c 2077 6865 6e20  y\ncontrol when 
+00007e20: 7265 636f 7264 696e 6720 6e65 7720 6576  recording new ev
+00007e30: 656e 7473 2e20 5468 6520 636f 7272 6563  ents. The correc
+00007e40: 7420 7661 6c75 6520 6f66 2060 6375 7272  t value of `curr
+00007e50: 656e 745f 7665 7273 696f 6e60 2066 6f72  ent_version` for
+00007e60: 2061 6e79 2073 7472 6561 6d5c 6e63 616e   any stream\ncan
+00007e70: 2062 6520 6f62 7461 696e 6564 2062 7920   be obtained by 
+00007e80: 6361 6c6c 696e 6720 6067 6574 5f63 7572  calling `get_cur
+00007e90: 7265 6e74 5f76 6572 7369 6f6e 2829 602e  rent_version()`.
+00007ea0: 2048 6f77 6576 6572 2c20 7468 6520 7479   However, the ty
+00007eb0: 7069 6361 6c20 6170 7072 6f61 6368 2069  pical approach i
+00007ec0: 7320 746f 5c6e 7573 6520 7468 6520 7374  s to\nuse the st
+00007ed0: 7265 616d 2070 6f73 6974 696f 6e20 6f66  ream position of
+00007ee0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00007ef0: 656e 7473 2061 7320 7468 6520 7665 7273  ents as the vers
+00007f00: 696f 6e20 6e75 6d62 6572 206f 6620 6120  ion number of a 
+00007f10: 7265 636f 6e73 7472 7563 7465 645c 6e61  reconstructed\na
+00007f20: 6767 7265 6761 7465 2c20 616e 6420 746f  ggregate, and to
+00007f30: 2075 7365 2074 6865 2063 7572 7265 6e74   use the current
+00007f40: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+00007f50: 6167 6772 6567 6174 6520 6173 2074 6865  aggregate as the
+00007f60: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
+00007f70: 6e60 2077 6865 6e5c 6e61 7070 656e 6469  n` when\nappendi
+00007f80: 6e67 206e 6577 2061 6767 7265 6761 7465  ng new aggregate
+00007f90: 2065 7665 6e74 732e 2054 6869 7320 656e   events. This en
+00007fa0: 7375 7265 7320 7468 6520 636f 6e73 6973  sures the consis
+00007fb0: 7465 6e63 7920 6f66 2074 6865 2072 6563  tency of the rec
+00007fc0: 6f72 6465 6420 7374 6174 6520 6f66 5c6e  orded state of\n
+00007fd0: 7468 6520 6167 6772 6567 6174 652c 2061  the aggregate, a
+00007fe0: 6e64 2066 6f72 6365 7320 6f70 6572 6174  nd forces operat
+00007ff0: 696f 6e73 2074 6861 7420 6765 6e65 7261  ions that genera
+00008000: 7465 206e 6577 2061 6767 7265 6761 7465  te new aggregate
+00008010: 2065 7665 6e74 7320 746f 2062 6520 7265   events to be re
+00008020: 7472 6965 6420 7769 7468 2061 2066 7265  tried with a fre
+00008030: 7368 6c79 5c6e 7265 636f 6e73 7472 7563  shly\nreconstruc
+00008040: 7465 6420 6167 6772 6567 6174 6520 7768  ted aggregate wh
+00008050: 656e 2061 2060 5772 6f6e 6743 7572 7265  en a `WrongCurre
+00008060: 6e74 5665 7273 696f 6e60 2065 7863 6570  ntVersion` excep
+00008070: 7469 6f6e 2069 7320 656e 636f 756e 7465  tion is encounte
+00008080: 7265 642e 5c6e 5468 6973 2063 6f6e 7472  red.\nThis contr
+00008090: 6f6c 6c69 6e67 2062 6568 6176 696f 7220  olling behavior 
+000080a0: 6361 6e20 6265 2064 6973 6162 6c65 6420  can be disabled 
+000080b0: 6279 2073 6574 7469 6e67 2074 6865 2076  by setting the v
+000080c0: 616c 7565 206f 6620 7468 655c 6e60 6375  alue of the\n`cu
+000080d0: 7272 656e 745f 7665 7273 696f 6e60 2061  rrent_version` a
+000080e0: 7267 756d 656e 7420 746f 2060 2d31 602e  rgument to `-1`.
+000080f0: 5c6e 5c6e 5468 6520 7265 7175 6972 6564  \n\nThe required
+00008100: 2060 6576 656e 7473 6020 6172 6775 6d65   `events` argume
+00008110: 6e74 2069 7320 6578 7065 6374 6564 2074  nt is expected t
+00008120: 6f20 6265 2061 2073 6571 7565 6e63 6520  o be a sequence 
+00008130: 6f66 206e 6577 2065 7665 6e74 206f 626a  of new event obj
+00008140: 6563 7473 2e20 5468 655c 6e60 4e65 7745  ects. The\n`NewE
+00008150: 7665 6e74 6020 636c 6173 7320 7368 6f75  vent` class shou
+00008160: 6c64 2062 6520 7573 6564 2074 6f20 636f  ld be used to co
+00008170: 6e73 7472 7563 7420 6e65 7720 6576 656e  nstruct new even
+00008180: 7420 6f62 6a65 6374 732e 2054 6865 2060  t objects. The `
+00008190: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
+000081a0: 5c6e 6f70 6572 6174 696f 6e20 6973 2061  \noperation is a
+000081b0: 746f 6d69 632c 2073 6f20 7468 6174 2065  tomic, so that e
+000081c0: 6974 6865 7220 616c 6c20 6f72 206e 6f6e  ither all or non
+000081d0: 6520 6f66 2074 6865 206e 6577 2065 7665  e of the new eve
+000081e0: 6e74 7320 7769 6c6c 2062 6520 7265 636f  nts will be reco
+000081f0: 7264 6564 2e20 4974 5c6e 6973 206e 6f74  rded. It\nis not
+00008200: 2070 6f73 7369 626c 6520 7769 7468 2045   possible with E
+00008210: 7665 6e74 5374 6f72 6544 4220 6174 6f6d  ventStoreDB atom
+00008220: 6963 616c 6c79 2074 6f20 7265 636f 7264  ically to record
+00008230: 206e 6577 2065 7665 6e74 7320 696e 206d   new events in m
+00008240: 6f72 6520 7468 616e 206f 6e65 2073 7472  ore than one str
+00008250: 6561 6d2e 5c6e 5c6e 5468 6973 206d 6574  eam.\n\nThis met
+00008260: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
+00008270: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+00008280: 7460 2061 7267 756d 656e 742c 2077 6869  t` argument, whi
+00008290: 6368 2069 7320 6120 5079 7468 6f6e 2060  ch is a Python `
+000082a0: 666c 6f61 7460 5c6e 7468 6174 2073 6574  float`\nthat set
+000082b0: 7320 6120 6465 6164 6c69 6e65 2066 6f72  s a deadline for
+000082c0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+000082d0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+000082e0: 6174 696f 6e2e 5c6e 5c6e 496e 2074 6865  ation.\n\nIn the
+000082f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00008300: 6120 6e65 7720 6576 656e 742c 2060 6576  a new event, `ev
+00008310: 656e 7431 602c 2069 7320 6170 7065 6e64  ent1`, is append
+00008320: 6564 2074 6f20 6120 6e65 7720 7374 7265  ed to a new stre
+00008330: 616d 2e20 5468 655c 6e73 7472 6561 6d20  am. The\nstream 
+00008340: 646f 6573 206e 6f74 2079 6574 2065 7869  does not yet exi
+00008350: 7374 2c20 736f 2060 6375 7272 656e 745f  st, so `current_
+00008360: 7665 7273 696f 6e60 2069 7320 604e 6f6e  version` is `Non
+00008370: 6560 2e5c 6e5c 6e60 6060 7079 7468 6f6e  e`.\n\n```python
+00008380: 5c6e 2320 436f 6e73 7472 7563 7420 6120  \n# Construct a 
+00008390: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
+000083a0: 2e5c 6e65 7665 6e74 3120 3d20 4e65 7745  .\nevent1 = NewE
+000083b0: 7665 6e74 2874 7970 653d 5c27 4f72 6465  vent(type=\'Orde
+000083c0: 7243 7265 6174 6564 5c27 2c20 6461 7461  rCreated\', data
+000083d0: 3d62 5c27 6461 7461 315c 2729 5c6e 5c6e  =b\'data1\')\n\n
+000083e0: 2320 4465 6669 6e65 2061 206e 6577 2073  # Define a new s
+000083f0: 7472 6561 6d20 6e61 6d65 2e5c 6e73 7472  tream name.\nstr
+00008400: 6561 6d5f 6e61 6d65 3120 3d20 7374 7228  eam_name1 = str(
+00008410: 7575 6964 2e75 7569 6434 2829 295c 6e5c  uuid.uuid4())\n\
+00008420: 6e23 2041 7070 656e 6420 7468 6520 6e65  n# Append the ne
+00008430: 7720 6576 656e 7473 2074 6f20 7468 6520  w events to the 
+00008440: 6e65 7720 7374 7265 616d 2e5c 6e63 6f6d  new stream.\ncom
+00008450: 6d69 745f 706f 7369 7469 6f6e 3120 3d20  mit_position1 = 
+00008460: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+00008470: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
+00008480: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00008490: 6d65 312c 5c6e 2020 2020 6375 7272 656e  me1,\n    curren
+000084a0: 745f 7665 7273 696f 6e3d 4e6f 6e65 2c5c  t_version=None,\
+000084b0: 6e20 2020 2065 7665 6e74 733d 5b65 7665  n    events=[eve
+000084c0: 6e74 315d 2c5c 6e29 5c6e 6060 605c 6e5c  nt1],\n)\n```\n\
+000084d0: 6e49 6e20 7468 6520 6578 616d 706c 6520  nIn the example 
+000084e0: 6265 6c6f 772c 2074 776f 2073 7562 7365  below, two subse
+000084f0: 7175 656e 7420 6576 656e 7473 2061 7265  quent events are
+00008500: 2061 7070 656e 6465 6420 746f 2061 6e20   appended to an 
+00008510: 6578 6973 7469 6e67 5c6e 7374 7265 616d  existing\nstream
+00008520: 2e20 5468 6520 7374 7265 616d 2c20 6073  . The stream, `s
+00008530: 7472 6561 6d5f 6e61 6d65 3160 2c20 736f  tream_name1`, so
+00008540: 2066 6172 2068 6173 206f 6e65 2072 6563   far has one rec
+00008550: 6f72 6465 6420 6576 656e 742c 2061 6e64  orded event, and
+00008560: 2073 6f5c 6e74 6865 2063 6f72 7265 6374   so\nthe correct
+00008570: 2076 616c 7565 206f 6620 6063 7572 7265   value of `curre
+00008580: 6e74 5f76 6572 7369 6f6e 6020 6973 2060  nt_version` is `
+00008590: 3060 2e5c 6e5c 6e60 6060 7079 7468 6f6e  0`.\n\n```python
+000085a0: 5c6e 6576 656e 7432 203d 204e 6577 4576  \nevent2 = NewEv
+000085b0: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+000085c0: 5570 6461 7465 645c 272c 2064 6174 613d  Updated\', data=
+000085d0: 625c 2764 6174 6132 5c27 295c 6e65 7665  b\'data2\')\neve
+000085e0: 6e74 3320 3d20 4e65 7745 7665 6e74 2874  nt3 = NewEvent(t
+000085f0: 7970 653d 5c27 4f72 6465 7244 656c 6574  ype=\'OrderDelet
+00008600: 6564 5c27 2c20 6461 7461 3d62 5c27 6461  ed\', data=b\'da
+00008610: 7461 335c 2729 5c6e 5c6e 636f 6d6d 6974  ta3\')\n\ncommit
+00008620: 5f70 6f73 6974 696f 6e32 203d 2063 6c69  _position2 = cli
+00008630: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+00008640: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
+00008650: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+00008660: 2c5c 6e20 2020 2063 7572 7265 6e74 5f76  ,\n    current_v
+00008670: 6572 7369 6f6e 3d30 2c5c 6e20 2020 2065  ersion=0,\n    e
+00008680: 7665 6e74 733d 5b65 7665 6e74 322c 2065  vents=[event2, e
+00008690: 7665 6e74 335d 2c5c 6e29 5c6e 6060 605c  vent3],\n)\n```\
+000086a0: 6e5c 6e54 6865 2072 6574 7572 6e65 6420  n\nThe returned 
+000086b0: 7661 6c75 6573 2c20 6063 6f6d 6d69 745f  values, `commit_
+000086c0: 706f 7369 7469 6f6e 3160 2061 6e64 2060  position1` and `
+000086d0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e32  commit_position2
+000086e0: 602c 2061 7265 2074 6865 5c6e 636f 6d6d  `, are the\ncomm
+000086f0: 6974 2070 6f73 6974 696f 6e73 2069 6e20  it positions in 
+00008700: 7468 6520 6461 7461 6261 7365 206f 6620  the database of 
+00008710: 7468 6520 6c61 7374 2065 7665 6e74 7320  the last events 
+00008720: 696e 2074 6865 2072 6563 6f72 6465 6420  in the recorded 
+00008730: 7365 7175 656e 6365 732e 5c6e 5468 6174  sequences.\nThat
+00008740: 2069 732c 2060 636f 6d6d 6974 5f70 6f73   is, `commit_pos
+00008750: 6974 696f 6e31 6020 6973 2074 6865 2063  ition1` is the c
+00008760: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
+00008770: 6620 6065 7665 6e74 3160 2061 6e64 5c6e  f `event1` and\n
+00008780: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00008790: 3260 2069 7320 7468 6520 636f 6d6d 6974  2` is the commit
+000087a0: 2070 6f73 6974 696f 6e20 6f66 2060 6576   position of `ev
+000087b0: 656e 7433 602e 5c6e 5c6e 436f 6d6d 6974  ent3`.\n\nCommit
+000087c0: 2070 6f73 6974 696f 6e73 2074 6861 7420   positions that 
+000087d0: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
+000087e0: 7468 6973 2077 6179 2063 616e 2062 6520  this way can be 
+000087f0: 7573 6564 2062 7920 6120 7573 6572 2069  used by a user i
+00008800: 6e74 6572 6661 6365 2074 6f20 706f 6c6c  nterface to poll
+00008810: 5c6e 6120 646f 776e 7374 7265 616d 2063  \na downstream c
+00008820: 6f6d 706f 6e65 6e74 2075 6e74 696c 2069  omponent until i
+00008830: 7420 6861 7320 7072 6f63 6573 7365 6420  t has processed 
+00008840: 616c 6c20 7468 6520 6e65 776c 7920 7265  all the newly re
+00008850: 636f 7264 6564 2065 7665 6e74 732e 2046  corded events. F
+00008860: 6f72 2065 7861 6d70 6c65 2c5c 6e63 6f6e  or example,\ncon
+00008870: 7369 6465 7220 6120 7573 6572 2069 6e74  sider a user int
+00008880: 6572 6661 6365 2063 6f6d 6d61 6e64 2074  erface command t
+00008890: 6861 7420 7265 7375 6c74 7320 696e 2074  hat results in t
+000088a0: 6865 2072 6563 6f72 6469 6e67 206f 6620  he recording of 
+000088b0: 6e65 7720 6576 656e 7473 2c20 616e 6420  new events, and 
+000088c0: 616e 5c6e 6576 656e 7475 616c 6c79 2063  an\neventually c
+000088d0: 6f6e 7369 7374 656e 7420 6d61 7465 7269  onsistent materi
+000088e0: 616c 697a 6564 2076 6965 7720 696e 2061  alized view in a
+000088f0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+00008900: 6f6e 656e 7420 7468 6174 2069 7320 7570  onent that is up
+00008910: 6461 7465 6420 6672 6f6d 5c6e 7468 6573  dated from\nthes
+00008920: 6520 6576 656e 7473 2e20 4966 2074 6865  e events. If the
+00008930: 206e 6577 2065 7665 6e74 7320 6861 7665   new events have
+00008940: 206e 6f74 2079 6574 2062 6565 6e20 7072   not yet been pr
+00008950: 6f63 6573 7365 642c 2074 6865 2076 6965  ocessed, the vie
+00008960: 7720 6d69 6768 7420 6265 2073 7461 6c65  w might be stale
+00008970: 2c5c 6e6f 7220 6f75 742d 6f66 2d64 6174  ,\nor out-of-dat
+00008980: 652e 2049 6e73 7465 6164 206f 6620 6469  e. Instead of di
+00008990: 7370 6c61 7969 6e67 2061 2073 7461 6c65  splaying a stale
+000089a0: 2076 6965 772c 2074 6865 2075 7365 7220   view, the user 
+000089b0: 696e 7465 7266 6163 6520 6361 6e20 706f  interface can po
+000089c0: 6c6c 2074 6865 5c6e 646f 776e 7374 7265  ll the\ndownstre
+000089d0: 616d 2063 6f6d 706f 6e65 6e74 2075 6e74  am component unt
+000089e0: 696c 2069 7420 6861 7320 7072 6f63 6573  il it has proces
+000089f0: 7365 6420 7468 6520 6e65 776c 7920 7265  sed the newly re
+00008a00: 636f 7264 6564 2065 7665 6e74 732c 2061  corded events, a
+00008a10: 6e64 2074 6865 6e20 6469 7370 6c61 795c  nd then display\
+00008a20: 6e61 6e20 7570 2d74 6f2d 6461 7465 2076  nan up-to-date v
+00008a30: 6965 7720 746f 2074 6865 2075 7365 722e  iew to the user.
+00008a40: 5c6e 5c6e 5c6e 2323 2320 4170 7065 6e64  \n\n\n### Append
+00008a50: 2065 7665 6e74 5c6e 5c6e 2a72 6571 7569   event\n\n*requi
+00008a60: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
+00008a70: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+00008a80: 2829 6020 6d65 7468 6f64 2069 7320 6c69  ()` method is li
+00008a90: 6b65 2060 6170 7065 6e64 5f65 7665 6e74  ke `append_event
+00008aa0: 7328 2960 2062 7574 2063 616e 2062 6520  s()` but can be 
+00008ab0: 7573 6564 206f 6e6c 7920 746f 2077 7269  used only to wri
+00008ac0: 7465 2061 5c6e 7369 6e67 6c65 206e 6577  te a\nsingle new
+00008ad0: 2065 7665 6e74 2074 6f20 6120 7374 7265   event to a stre
+00008ae0: 616d 2e20 4966 2074 6865 206f 7065 7261  am. If the opera
+00008af0: 7469 6f6e 2069 7320 7375 6363 6573 7366  tion is successf
+00008b00: 756c 2c20 6974 2072 6574 7572 6e73 2074  ul, it returns t
+00008b10: 6865 2063 6f6d 6d69 745c 6e70 6f73 6974  he commit\nposit
+00008b20: 696f 6e20 6f66 2074 6865 206e 6577 6c79  ion of the newly
+00008b30: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+00008b40: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00008b50: 6861 7320 7468 7265 6520 7265 7175 6972  has three requir
+00008b60: 6564 2061 7267 756d 656e 7473 2c20 6073  ed arguments, `s
+00008b70: 7472 6561 6d5f 6e61 6d65 602c 2060 6375  tream_name`, `cu
+00008b80: 7272 656e 745f 7665 7273 696f 6e60 2061  rrent_version` a
+00008b90: 6e64 2060 6576 656e 7460 2e5c 6e5c 6e54  nd `event`.\n\nT
+00008ba0: 6865 2072 6571 7569 7265 6420 6073 7472  he required `str
+00008bb0: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
+00008bc0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00008bd0: 7374 7260 2074 6861 7420 756e 6971 7565  str` that unique
+00008be0: 6c79 2069 6465 6e74 6966 6965 7320 615c  ly identifies a\
+00008bf0: 6e73 7472 6561 6d20 746f 2077 6869 6368  nstream to which
+00008c00: 2061 2073 6571 7565 6e63 6520 6f66 2065   a sequence of e
+00008c10: 7665 6e74 7320 7769 6c6c 2062 6520 6170  vents will be ap
+00008c20: 7065 6e64 6564 2e5c 6e5c 6e54 6865 2072  pended.\n\nThe r
+00008c30: 6571 7569 7265 6420 6063 7572 7265 6e74  equired `current
+00008c40: 5f76 6572 7369 6f6e 6020 6172 6775 6d65  _version` argume
+00008c50: 6e74 2069 7320 6578 7065 6374 6564 2074  nt is expected t
+00008c60: 6f20 6265 2065 6974 6865 7220 6120 5079  o be either a Py
+00008c70: 7468 6f6e 2060 696e 7460 5c6e 7468 6174  thon `int`\nthat
+00008c80: 2069 6e64 6963 6174 6573 2074 6865 2073   indicates the s
+00008c90: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
+00008ca0: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
+00008cb0: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
+00008cc0: 2073 7472 6561 6d2e 5c6e 5c6e 5468 6520   stream.\n\nThe 
+00008cd0: 7265 7175 6972 6564 2060 6576 656e 7460  required `event`
+00008ce0: 2061 7267 756d 656e 7420 6973 2065 7870   argument is exp
+00008cf0: 6563 7465 6420 746f 2062 6520 6120 7369  ected to be a si
+00008d00: 6e67 6c65 206e 6577 2065 7665 6e74 206f  ngle new event o
+00008d10: 626a 6563 742e 2054 6865 2065 7665 6e74  bject. The event
+00008d20: 5c6e 6f62 6a65 6374 2069 7320 6578 7065  \nobject is expe
+00008d30: 6374 6564 2074 6f20 6265 2061 6e20 696e  cted to be an in
+00008d40: 7374 616e 6365 206f 6620 7468 6520 604e  stance of the `N
+00008d50: 6577 4576 656e 7460 2063 6c61 7373 2e5c  ewEvent` class.\
+00008d60: 6e5c 6e54 6869 7320 6d65 7468 6f64 2061  n\nThis method a
+00008d70: 6c73 6f20 6861 7320 616e 206f 7074 696f  lso has an optio
+00008d80: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00008d90: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00008da0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00008db0: 605c 6e74 6861 7420 7365 7473 2061 2064  `\nthat sets a d
+00008dc0: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
+00008dd0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00008de0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00008df0: 2e5c 6e5c 6e5c 6e23 2323 2049 6465 6d70  .\n\n\n### Idemp
+00008e00: 6f74 656e 7420 6170 7065 6e64 206f 7065  otent append ope
+00008e10: 7261 7469 6f6e 735c 6e5c 6e54 6865 2060  rations\n\nThe `
+00008e20: 6170 7065 6e64 5f65 7665 6e74 2829 6020  append_event()` 
+00008e30: 616e 6420 6061 7070 656e 645f 6576 656e  and `append_even
+00008e40: 7473 2829 6020 616e 6420 6d65 7468 6f64  ts()` and method
+00008e50: 7320 6172 6520 2269 6465 6d70 6f74 656e  s are "idempoten
+00008e60: 7422 2c20 696e 2074 6861 745c 6e69 6620  t", in that\nif 
+00008e70: 7468 6520 6d65 7468 6f64 7320 6172 6520  the methods are 
+00008e80: 6361 6c6c 6564 2077 6974 6820 6e65 7720  called with new 
+00008e90: 6576 656e 7473 2077 686f 7365 2060 6964  events whose `id
+00008ea0: 6020 6174 7472 6962 7574 6520 7661 6c75  ` attribute valu
+00008eb0: 6573 2065 7175 616c 2074 686f 7365 5c6e  es equal those\n
+00008ec0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+00008ed0: 7473 2069 6e20 7468 6520 6e61 6d65 6420  ts in the named 
+00008ee0: 7374 7265 616d 2069 6d6d 6564 6961 7465  stream immediate
+00008ef0: 6c79 2061 6674 6572 2074 6865 2073 7472  ly after the str
+00008f00: 6561 6d20 706f 7369 7469 6f6e 2073 7065  eam position spe
+00008f10: 6369 6669 6564 5c6e 6279 2074 6865 2076  cified\nby the v
+00008f20: 616c 7565 206f 6620 7468 6520 6063 7572  alue of the `cur
+00008f30: 7265 6e74 5f76 6572 7369 6f6e 6020 6172  rent_version` ar
+00008f40: 6775 6d65 6e74 2c20 7468 656e 2074 6865  gument, then the
+00008f50: 7365 206d 6574 686f 6473 2077 696c 6c20  se methods will 
+00008f60: 7265 7475 726e 2074 6865 5c6e 636f 6d6d  return the\ncomm
+00008f70: 6974 2070 6f73 6974 696f 6e20 6f66 2074  it position of t
+00008f80: 6865 206c 6173 7420 6e65 7720 6576 656e  he last new even
+00008f90: 742c 2077 6974 686f 7574 206d 616b 696e  t, without makin
+00008fa0: 6720 616e 7920 6368 616e 6765 7320 746f  g any changes to
+00008fb0: 2074 6865 2064 6174 6162 6173 652e 5c6e   the database.\n
+00008fc0: 5c6e 536f 6d65 7469 6d65 7320 6974 206d  \nSometimes it m
+00008fd0: 6179 2068 6170 7065 6e2c 2077 6865 6e20  ay happen, when 
+00008fe0: 6361 6c6c 696e 6720 6061 7070 656e 645f  calling `append_
+00008ff0: 6576 656e 7428 2960 206f 7220 6061 7070  event()` or `app
+00009000: 656e 645f 6576 656e 7473 2829 602c 2074  end_events()`, t
+00009010: 6861 745c 6e74 6865 206e 6577 2065 7665  hat\nthe new eve
+00009020: 6e74 7320 6172 6520 7375 6363 6573 7366  nts are successf
+00009030: 756c 6c79 2072 6563 6f72 6465 6420 6275  ully recorded bu
+00009040: 7420 736f 6d65 686f 7720 6120 636f 6e6e  t somehow a conn
+00009050: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
+00009060: 7572 7320 6265 666f 7265 5c6e 7468 6520  urs before\nthe 
+00009070: 7375 6363 6573 7366 756c 2063 616c 6c20  successful call 
+00009080: 6361 6e20 7265 7475 726e 2073 7563 6365  can return succe
+00009090: 7373 6675 6c6c 7920 746f 2074 6865 2063  ssfully to the c
+000090a0: 6c69 656e 742e 2057 6520 6361 6e6e 6f74  lient. We cannot
+000090b0: 2062 6520 7375 7265 2069 665c 6e74 6865   be sure if\nthe
+000090c0: 2065 7665 6e74 7320 7765 7265 2072 6563   events were rec
+000090d0: 6f72 6465 6420 6f72 206e 6f74 2c20 616e  orded or not, an
+000090e0: 6420 736f 2077 6520 6d61 7920 7769 7368  d so we may wish
+000090f0: 2074 6f20 7265 7472 792e 2049 6620 7468   to retry. If th
+00009100: 6520 6576 656e 7473 2077 6572 6520 696e  e events were in
+00009110: 5c6e 6661 6374 2073 7563 6365 7373 6675  \nfact successfu
+00009120: 6c6c 7920 7265 636f 7264 6564 2c20 6974  lly recorded, it
+00009130: 2069 7320 636f 6e76 656e 6965 6e74 2066   is convenient f
+00009140: 6f72 2074 6865 2072 6574 7269 6564 206f  or the retried o
+00009150: 7065 7261 7469 6f6e 2074 6f20 7265 7475  peration to retu
+00009160: 726e 5c6e 7375 6363 6573 7366 756c 6c79  rn\nsuccessfully
+00009170: 2077 6974 686f 7574 2072 6169 7369 6e67   without raising
+00009180: 2061 6e20 6578 6365 7074 696f 6e2e 2049   an exception. I
+00009190: 6620 7468 6f73 6520 6e65 7720 6576 656e  f those new even
+000091a0: 7473 2077 6572 6520 696e 2066 6163 7420  ts were in fact 
+000091b0: 6e6f 7420 7265 636f 7264 6564 2c5c 6e61  not recorded,\na
+000091c0: 6e64 2069 6e20 7468 6520 6d65 616e 7469  nd in the meanti
+000091d0: 6d65 206e 6f20 6f74 6865 7220 6e65 7720  me no other new 
+000091e0: 6576 656e 7473 2077 6572 6520 7265 636f  events were reco
+000091f0: 7264 6564 2069 6e20 7468 6174 2073 7472  rded in that str
+00009200: 6561 6d2c 2074 6865 6e20 6974 206d 616b  eam, then it mak
+00009210: 6573 2073 656e 7365 5c6e 7468 6174 2074  es sense\nthat t
+00009220: 6865 206e 6577 2065 7665 6e74 7320 7769  he new events wi
+00009230: 6c6c 2062 6520 7265 636f 7264 6564 2077  ll be recorded w
+00009240: 6865 6e20 7468 6520 6170 7065 6e64 206f  hen the append o
+00009250: 7065 7261 7469 6f6e 2069 7320 7265 7472  peration is retr
+00009260: 6965 642e 204f 6620 636f 7572 7365 2c5c  ied. Of course,\
+00009270: 6e69 6620 6120 6057 726f 6e67 4375 7272  nif a `WrongCurr
+00009280: 656e 7456 6572 7369 6f6e 6020 6578 6365  entVersion` exce
+00009290: 7074 696f 6e20 6973 2072 6169 7365 6420  ption is raised 
+000092a0: 7768 656e 2072 6574 7279 696e 6720 7468  when retrying th
+000092b0: 6520 6f70 6572 6174 696f 6e2c 2074 6865  e operation, the
+000092c0: 6e20 616e 5c6e 6170 706c 6963 6174 696f  n an\napplicatio
+000092d0: 6e20 636f 6d6d 616e 6420 7768 6963 6820  n command which 
+000092e0: 6765 6e65 7261 7465 6420 7468 6520 6e65  generated the ne
+000092f0: 7720 6576 656e 7473 2069 6e20 7468 6520  w events in the 
+00009300: 636f 6e74 6578 7420 6f66 2061 6c72 6561  context of alrea
+00009310: 6479 2072 6563 6f72 6465 645c 6e65 7665  dy recorded\neve
+00009320: 6e74 7320 6d61 7920 6e65 6564 2074 6f20  nts may need to 
+00009330: 6265 2065 7865 6375 7465 6420 6167 6169  be executed agai
+00009340: 6e2e 2041 6c74 6572 6e61 7469 7665 6c79  n. Alternatively
+00009350: 2c20 6120 7375 6974 6162 6c65 2065 7272  , a suitable err
+00009360: 6f72 206d 6967 6874 2062 6520 6469 7370  or might be disp
+00009370: 6c61 7965 645c 6e62 7920 7468 6520 6170  layed\nby the ap
+00009380: 706c 6963 6174 696f 6e2c 2077 6974 6820  plication, with 
+00009390: 616e 2075 702d 746f 2d64 6174 6520 7669  an up-to-date vi
+000093a0: 6577 206f 6620 7468 6520 7265 636f 7264  ew of the record
+000093b0: 6564 2064 6174 612c 2067 6976 696e 6720  ed data, giving 
+000093c0: 6120 7573 6572 206f 6620 7468 655c 6e61  a user of the\na
+000093d0: 7070 6c69 6361 7469 6f6e 2061 6e20 6f70  pplication an op
+000093e0: 706f 7274 756e 6974 7920 746f 2064 6563  portunity to dec
+000093f0: 6964 6520 6966 2074 6865 7920 7374 696c  ide if they stil
+00009400: 6c20 7769 7368 2074 6f20 7072 6f63 6565  l wish to procee
+00009410: 6420 7769 7468 2074 6865 6972 206f 7269  d with their ori
+00009420: 6769 6e61 6c5c 6e69 6e74 656e 7469 6f6e  ginal\nintention
+00009430: 2e5c 6e5c 6e54 6865 2065 7861 6d70 6c65  .\n\nThe example
+00009440: 2062 656c 6f77 2073 686f 7773 2074 6865   below shows the
+00009450: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00009460: 2960 206d 6574 686f 6420 6265 696e 6720  )` method being 
+00009470: 6361 6c6c 6564 2061 6761 696e 2077 6974  called again wit
+00009480: 685c 6e60 6576 656e 7433 6020 616e 6420  h\n`event3` and 
+00009490: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+000094a0: 3d30 602e 2057 6520 6361 6e20 7365 6520  =0`. We can see 
+000094b0: 7468 6174 2072 6570 6561 7469 6e67 2074  that repeating t
+000094c0: 6865 2063 616c 6c20 746f 5c6e 6061 7070  he call to\n`app
+000094d0: 656e 645f 6576 656e 7473 2829 6020 7265  end_events()` re
+000094e0: 7475 726e 7320 7375 6363 6573 7366 756c  turns successful
+000094f0: 6c79 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ly.\n\n```python
+00009500: 5c6e 2320 5265 7472 7920 6170 7065 6e64  \n# Retry append
+00009510: 696e 6720 6576 656e 7433 2e5c 6e63 6f6d  ing event3.\ncom
+00009520: 6d69 745f 706f 7369 7469 6f6e 5f72 6574  mit_position_ret
+00009530: 7279 203d 2063 6c69 656e 742e 6170 7065  ry = client.appe
+00009540: 6e64 5f65 7665 6e74 7328 5c6e 2020 2020  nd_events(\n    
+00009550: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00009560: 616d 5f6e 616d 6531 2c5c 6e20 2020 2063  am_name1,\n    c
+00009570: 7572 7265 6e74 5f76 6572 7369 6f6e 3d30  urrent_version=0
+00009580: 2c5c 6e20 2020 2065 7665 6e74 733d 5b65  ,\n    events=[e
+00009590: 7665 6e74 322c 2065 7665 6e74 335d 2c5c  vent2, event3],\
+000095a0: 6e29 5c6e 6060 605c 6e5c 6e57 6520 6361  n)\n```\n\nWe ca
+000095b0: 6e20 7365 6520 7468 6174 2074 6865 2073  n see that the s
+000095c0: 616d 6520 636f 6d6d 6974 2070 6f73 6974  ame commit posit
+000095d0: 696f 6e20 6973 2072 6574 7572 6e65 6420  ion is returned 
+000095e0: 6173 2061 626f 7665 2e5c 6e5c 6e60 6060  as above.\n\n```
+000095f0: 7079 7468 6f6e 5c6e 6173 7365 7274 2063  python\nassert c
+00009600: 6f6d 6d69 745f 706f 7369 7469 6f6e 5f72  ommit_position_r
+00009610: 6574 7279 203d 3d20 636f 6d6d 6974 5f70  etry == commit_p
+00009620: 6f73 6974 696f 6e32 5c6e 6060 605c 6e5c  osition2\n```\n\
+00009630: 6e42 7920 6361 6c6c 696e 6720 6072 6561  nBy calling `rea
+00009640: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
+00009650: 2960 2c20 7765 2063 616e 2061 6c73 6f20  )`, we can also 
+00009660: 7365 6520 7468 6520 7374 7265 616d 2068  see the stream h
+00009670: 6173 2062 6565 6e20 756e 6368 616e 6765  as been unchange
+00009680: 645c 6e64 6573 7069 7465 2074 6865 2060  d\ndespite the `
+00009690: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
+000096a0: 206d 6574 686f 6420 6861 7669 6e67 2062   method having b
+000096b0: 6565 6e20 6361 6c6c 6564 2074 7769 6365  een called twice
+000096c0: 2077 6974 6820 7468 6520 7361 6d65 2061   with the same a
+000096d0: 7267 756d 656e 7473 2e5c 6e54 6861 7420  rguments.\nThat 
+000096e0: 6973 2c20 7468 6572 6520 6172 6520 7374  is, there are st
+000096f0: 696c 6c20 6f6e 6c79 2074 6872 6565 2065  ill only three e
+00009700: 7665 6e74 7320 696e 2074 6865 2073 7472  vents in the str
+00009710: 6561 6d2e 5c6e 5c6e 6060 6070 7974 686f  eam.\n\n```pytho
+00009720: 6e5c 6e65 7665 6e74 7320 3d20 636c 6965  n\nevents = clie
+00009730: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
+00009740: 7665 6e74 7328 5c6e 2020 2020 7374 7265  vents(\n    stre
+00009750: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00009760: 616d 6531 5c6e 295c 6e5c 6e61 7373 6572  ame1\n)\n\nasser
+00009770: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+00009780: 2033 5c6e 6060 605c 6e5c 6e54 6869 7320   3\n```\n\nThis 
+00009790: 6964 656d 706f 7465 6e74 2062 6568 6176  idempotent behav
+000097a0: 696f 7572 2064 6570 656e 6473 206f 6e20  iour depends on 
+000097b0: 7468 6520 6069 6460 2061 7474 7269 6275  the `id` attribu
+000097c0: 7465 206f 6620 7468 6520 604e 6577 4576  te of the `NewEv
+000097d0: 656e 7460 2063 6c61 7373 2e5c 6e54 6869  ent` class.\nThi
+000097e0: 7320 6174 7472 6962 7574 652c 2062 7920  s attribute, by 
+000097f0: 6465 6661 756c 742c 2069 7320 6173 7369  default, is assi
+00009800: 676e 6564 2061 206e 6577 2061 6e64 2075  gned a new and u
+00009810: 6e69 7175 6520 7665 7273 696f 6e2d 3420  nique version-4 
+00009820: 5555 4944 2077 6865 6e20 616e 5c6e 696e  UUID when an\nin
+00009830: 7374 616e 6365 206f 6620 604e 6577 4576  stance of `NewEv
+00009840: 656e 7460 2069 7320 636f 6e73 7472 7563  ent` is construc
+00009850: 7465 642e 2054 6865 2060 6964 6020 6172  ted. The `id` ar
+00009860: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+00009870: 6564 2077 6865 6e5c 6e63 6f6e 7374 7275  ed when\nconstru
+00009880: 6374 696e 6720 604e 6577 4576 656e 7460  cting `NewEvent`
+00009890: 206f 626a 6563 7473 2074 6f20 7365 7420   objects to set 
+000098a0: 7468 6520 7661 6c75 6520 6f66 2074 6869  the value of thi
+000098b0: 7320 6174 7472 6962 7574 652e 5c6e 5c6e  s attribute.\n\n
+000098c0: 5c6e 2323 2320 5265 6164 2073 7472 6561  \n### Read strea
+000098d0: 6d20 6576 656e 7473 5c6e 5c6e 5468 6520  m events\n\nThe 
+000098e0: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
+000098f0: 6e74 7328 2960 206d 6574 686f 6420 6361  nts()` method ca
+00009900: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+00009910: 2065 7665 6e74 7320 7468 6174 2068 6176   events that hav
+00009920: 6520 6265 656e 2061 7070 656e 6465 645c  e been appended\
+00009930: 6e74 6f20 6120 7374 7265 616d 2e20 5468  nto a stream. Th
+00009940: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
+00009950: 7320 6120 5079 7468 6f6e 2060 7475 706c  s a Python `tupl
+00009960: 6560 206f 6620 7265 636f 7264 6564 2065  e` of recorded e
+00009970: 7665 6e74 206f 626a 6563 7473 2e20 5468  vent objects. Th
+00009980: 655c 6e72 6563 6f72 6465 6420 6576 656e  e\nrecorded even
+00009990: 7420 6f62 6a65 6374 7320 6172 6520 696e  t objects are in
+000099a0: 7374 616e 6365 7320 6f66 2074 6865 2060  stances of the `
+000099b0: 5265 636f 7264 6564 4576 656e 7460 2063  RecordedEvent` c
+000099c0: 6c61 7373 2e5c 6e5c 6e54 6869 7320 6d65  lass.\n\nThis me
+000099d0: 7468 6f64 2068 6173 206f 6e65 2072 6571  thod has one req
+000099e0: 7569 7265 6420 6172 6775 6d65 6e74 2c20  uired argument, 
+000099f0: 6073 7472 6561 6d5f 6e61 6d65 602e 5c6e  `stream_name`.\n
+00009a00: 5c6e 5468 6520 7265 7175 6972 6564 2060  \nThe required `
+00009a10: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+00009a20: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00009a30: 6e20 6073 7472 6020 7468 6174 2075 6e69  n `str` that uni
+00009a40: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
+00009a50: 2061 5c6e 7374 7265 616d 2066 726f 6d20   a\nstream from 
+00009a60: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
+00009a70: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
+00009a80: 7475 726e 6564 2e5c 6e5c 6e54 6865 2060  turned.\n\nThe `
+00009a90: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+00009aa0: 7473 2829 6020 6d65 7468 6f64 2061 6c73  ts()` method als
+00009ab0: 6f20 6861 7320 666f 7572 206f 7074 696f  o has four optio
+00009ac0: 6e61 6c20 6172 6775 6d65 6e74 732c 5c6e  nal arguments,\n
+00009ad0: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
+00009ae0: 602c 2060 6261 636b 7761 7264 7360 2c20  `, `backwards`, 
+00009af0: 606c 696d 6974 602c 2061 6e64 2060 7469  `limit`, and `ti
+00009b00: 6d65 6f75 7460 2e5c 6e5c 6e54 6865 206f  meout`.\n\nThe o
+00009b10: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
+00009b20: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00009b30: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00009b40: 696e 7460 2074 6861 7420 6361 6e20 6265  int` that can be
+00009b50: 2075 7365 6420 746f 5c6e 696e 6469 6361   used to\nindica
+00009b60: 7465 2074 6865 2070 6f73 6974 696f 6e20  te the position 
+00009b70: 696e 2074 6865 2073 7472 6561 6d20 6672  in the stream fr
+00009b80: 6f6d 2077 6869 6368 2074 6f20 7374 6172  om which to star
+00009b90: 7420 7265 6164 696e 672e 2054 6865 2064  t reading. The d
+00009ba0: 6566 6175 6c74 2076 616c 7565 5c6e 6f66  efault value\nof
+00009bb0: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
+00009bc0: 6e60 2069 7320 604e 6f6e 6560 2e20 5768  n` is `None`. Wh
+00009bd0: 656e 2072 6561 6469 6e67 2061 2073 7472  en reading a str
+00009be0: 6561 6d20 6672 6f6d 2061 2073 7065 6369  eam from a speci
+00009bf0: 6669 6320 706f 7369 7469 6f6e 2069 6e20  fic position in 
+00009c00: 7468 655c 6e73 7472 6561 6d2c 2074 6865  the\nstream, the
+00009c10: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00009c20: 6174 2074 6861 7420 706f 7369 7469 6f6e  at that position
+00009c30: 2077 696c 6c20 6265 2069 6e63 6c75 6465   will be include
+00009c40: 642c 2062 6f74 6820 7768 656e 2072 6561  d, both when rea
+00009c50: 6469 6e67 5c6e 666f 7277 6172 6473 2066  ding\nforwards f
+00009c60: 726f 6d20 7468 6174 2070 6f73 6974 696f  rom that positio
+00009c70: 6e2c 2061 6e64 2077 6865 6e20 7265 6164  n, and when read
+00009c80: 696e 6720 6261 636b 7761 7264 732e 5c6e  ing backwards.\n
+00009c90: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
+00009ca0: 6261 636b 7761 7264 7360 2061 7267 756d  backwards` argum
+00009cb0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00009cc0: 6062 6f6f 6c60 2e20 5468 6520 6465 6661  `bool`. The defa
+00009cd0: 756c 7420 7661 6c75 6520 6f66 2060 6261  ult value of `ba
+00009ce0: 636b 7761 7264 7360 5c6e 6973 2060 4661  ckwards`\nis `Fa
+00009cf0: 6c73 6560 2c20 7768 6963 6820 6d65 616e  lse`, which mean
+00009d00: 7320 7468 6520 7374 7265 616d 2077 696c  s the stream wil
+00009d10: 6c20 6265 2072 6561 6420 666f 7277 6172  l be read forwar
+00009d20: 6473 2c20 736f 2074 6861 7420 6576 656e  ds, so that even
+00009d30: 7473 2061 7265 2072 6574 7572 6e65 645c  ts are returned\
+00009d40: 6e69 6e20 7468 6520 6f72 6465 7220 7468  nin the order th
+00009d50: 6579 2077 6572 6520 7265 636f 7264 6564  ey were recorded
+00009d60: 2e20 4966 2060 6261 636b 7761 7264 7360  . If `backwards`
+00009d70: 2069 7320 6054 7275 6560 2c20 7468 6520   is `True`, the 
+00009d80: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
+00009d90: 6e65 6420 696e 5c6e 7265 7665 7273 6520  ned in\nreverse 
+00009da0: 6f72 6465 722e 5c6e 5c6e 4966 2060 6261  order.\n\nIf `ba
+00009db0: 636b 7761 7264 7360 2069 7320 6046 616c  ckwards` is `Fal
+00009dc0: 7365 6020 616e 6420 6073 7472 6561 6d5f  se` and `stream_
+00009dd0: 706f 7369 7469 6f6e 6020 6973 2060 4e6f  position` is `No
+00009de0: 6e65 602c 2074 6865 2073 7472 6561 6d5c  ne`, the stream\
+00009df0: 2773 2065 7665 6e74 7320 7769 6c6c 2062  's events will b
+00009e00: 655c 6e72 6574 7572 6e65 6420 696e 2074  e\nreturned in t
+00009e10: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
+00009e20: 7265 2072 6563 6f72 6465 642c 2073 7461  re recorded, sta
+00009e30: 7274 696e 6720 6672 6f6d 2074 6865 2066  rting from the f
+00009e40: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+00009e50: 656e 742e 2054 6869 735c 6e69 7320 7468  ent. This\nis th
+00009e60: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
+00009e70: 6f72 206f 6620 6072 6561 645f 7374 7265  or of `read_stre
+00009e80: 616d 5f65 7665 6e74 7328 2960 2e20 4966  am_events()`. If
+00009e90: 2060 6261 636b 7761 7264 7360 2069 7320   `backwards` is 
+00009ea0: 6054 7275 6560 2061 6e64 5c6e 6073 7472  `True` and\n`str
+00009eb0: 6561 6d5f 706f 7369 7469 6f6e 6020 6973  eam_position` is
+00009ec0: 2060 4e6f 6e65 602c 2074 6865 2073 7472   `None`, the str
+00009ed0: 6561 6d5c 2773 2065 7665 6e74 7320 7769  eam\'s events wi
+00009ee0: 6c6c 2062 6520 7265 7475 726e 6564 2069  ll be returned i
+00009ef0: 6e20 7265 7665 7273 6520 6f72 6465 722c  n reverse order,
+00009f00: 5c6e 7374 6172 7469 6e67 2066 726f 6d20  \nstarting from 
+00009f10: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
+00009f20: 6420 6576 656e 742e 5c6e 5c6e 5468 6520  d event.\n\nThe 
+00009f30: 6f70 7469 6f6e 616c 2060 6c69 6d69 7460  optional `limit`
+00009f40: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00009f50: 7974 686f 6e20 6069 6e74 6020 7768 6963  ython `int` whic
+00009f60: 6820 7265 7374 7269 6374 7320 7468 6520  h restricts the 
+00009f70: 6e75 6d62 6572 206f 6620 6576 656e 7473  number of events
+00009f80: 5c6e 7468 6174 2077 696c 6c20 6265 2072  \nthat will be r
+00009f90: 6574 7572 6e65 642e 2054 6865 2064 6566  eturned. The def
+00009fa0: 6175 6c74 2076 616c 7565 206f 6620 606c  ault value of `l
+00009fb0: 696d 6974 6020 6973 2060 7379 732e 6d61  imit` is `sys.ma
+00009fc0: 7869 6e74 602e 5c6e 5c6e 5468 6520 6f70  xint`.\n\nThe op
+00009fd0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00009fe0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00009ff0: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+0000a000: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+0000a010: 696e 6520 666f 725c 6e74 6865 2063 6f6d  ine for\nthe com
+0000a020: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+0000a030: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
+0000a040: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
+0000a050: 6c6f 7720 7368 6f77 7320 7468 6520 6465  low shows the de
+0000a060: 6661 756c 7420 6265 6861 7669 6f72 206f  fault behavior o
+0000a070: 6620 7468 6973 206d 6574 686f 642c 2077  f this method, w
+0000a080: 6869 6368 2069 7320 746f 2072 6574 7572  hich is to retur
+0000a090: 6e20 616c 6c5c 6e74 6865 2072 6563 6f72  n all\nthe recor
+0000a0a0: 6465 6420 6576 656e 7473 206f 6620 6120  ded events of a 
+0000a0b0: 7374 7265 616d 2066 6f72 7761 7264 7320  stream forwards 
+0000a0c0: 6672 6f6d 2074 6865 2066 6972 7374 2072  from the first r
+0000a0d0: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+0000a0e0: 6f20 7468 6520 6c61 7374 2e5c 6e5c 6e60  o the last.\n\n`
+0000a0f0: 6060 7079 7468 6f6e 5c6e 6576 656e 7473  ``python\nevents
+0000a100: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+0000a110: 7472 6561 6d5f 6576 656e 7473 285c 6e20  tream_events(\n 
+0000a120: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+0000a130: 7472 6561 6d5f 6e61 6d65 315c 6e29 5c6e  tream_name1\n)\n
+0000a140: 5c6e 6173 7365 7274 206c 656e 2865 7665  \nassert len(eve
+0000a150: 6e74 7329 203d 3d20 335c 6e61 7373 6572  nts) == 3\nasser
+0000a160: 7420 6576 656e 7473 5b30 5d2e 6964 203d  t events[0].id =
+0000a170: 3d20 6576 656e 7431 2e69 645c 6e61 7373  = event1.id\nass
+0000a180: 6572 7420 6576 656e 7473 5b31 5d2e 6964  ert events[1].id
+0000a190: 203d 3d20 6576 656e 7432 2e69 645c 6e61   == event2.id\na
+0000a1a0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
+0000a1b0: 6964 203d 3d20 6576 656e 7433 2e69 645c  id == event3.id\
+0000a1c0: 6e60 6060 5c6e 5c6e 5468 6520 6578 616d  n```\n\nThe exam
+0000a1d0: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+0000a1e0: 686f 7720 746f 2075 7365 2074 6865 2060  how to use the `
+0000a1f0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+0000a200: 2061 7267 756d 656e 7420 746f 2072 6561   argument to rea
+0000a210: 6420 6120 7374 7265 616d 5c6e 6672 6f6d  d a stream\nfrom
+0000a220: 2061 2073 7065 6369 6669 6320 7374 7265   a specific stre
+0000a230: 616d 2070 6f73 6974 696f 6e20 746f 2074  am position to t
+0000a240: 6865 2065 6e64 206f 6620 7468 6520 7374  he end of the st
+0000a250: 7265 616d 2e20 5374 7265 616d 2070 6f73  ream. Stream pos
+0000a260: 6974 696f 6e73 2061 7265 5c6e 7a65 726f  itions are\nzero
+0000a270: 2d62 6173 6564 2c20 616e 6420 736f 2060  -based, and so `
+0000a280: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
+0000a290: 3160 2063 6f72 7265 7370 6f6e 6473 2074  1` corresponds t
+0000a2a0: 6f20 7468 6520 7365 636f 6e64 2065 7665  o the second eve
+0000a2b0: 6e74 2074 6861 7420 7761 735c 6e72 6563  nt that was\nrec
+0000a2c0: 6f72 6465 6420 696e 2074 6865 2073 7472  orded in the str
+0000a2d0: 6561 6d2c 2069 6e20 7468 6973 2063 6173  eam, in this cas
+0000a2e0: 6520 6065 7665 6e74 3260 2e5c 6e5c 6e60  e `event2`.\n\n`
+0000a2f0: 6060 7079 7468 6f6e 5c6e 6576 656e 7473  ``python\nevents
+0000a300: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+0000a310: 7472 6561 6d5f 6576 656e 7473 285c 6e20  tream_events(\n 
+0000a320: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+0000a330: 7472 6561 6d5f 6e61 6d65 312c 5c6e 2020  tream_name1,\n  
+0000a340: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
+0000a350: 6e3d 312c 5c6e 295c 6e5c 6e61 7373 6572  n=1,\n)\n\nasser
+0000a360: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+0000a370: 2032 5c6e 6173 7365 7274 2065 7665 6e74   2\nassert event
+0000a380: 735b 305d 2e69 6420 3d3d 2065 7665 6e74  s[0].id == event
+0000a390: 322e 6964 5c6e 6173 7365 7274 2065 7665  2.id\nassert eve
+0000a3a0: 6e74 735b 315d 2e69 6420 3d3d 2065 7665  nts[1].id == eve
+0000a3b0: 6e74 332e 6964 5c6e 6060 605c 6e5c 6e54  nt3.id\n```\n\nT
+0000a3c0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0000a3d0: 2073 686f 7773 2068 6f77 2074 6f20 7573   shows how to us
+0000a3e0: 6520 7468 6520 6062 6163 6b77 6172 6473  e the `backwards
+0000a3f0: 6020 6172 6775 6d65 6e74 2074 6f20 7265  ` argument to re
+0000a400: 6164 2061 2073 7472 6561 6d20 6261 636b  ad a stream back
+0000a410: 7761 7264 732e 5c6e 5c6e 6060 6070 7974  wards.\n\n```pyt
+0000a420: 686f 6e5c 6e65 7665 6e74 7320 3d20 636c  hon\nevents = cl
+0000a430: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
+0000a440: 5f65 7665 6e74 7328 5c6e 2020 2020 7374  _events(\n    st
+0000a450: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000a460: 5f6e 616d 6531 2c5c 6e20 2020 2062 6163  _name1,\n    bac
+0000a470: 6b77 6172 6473 3d54 7275 652c 5c6e 295c  kwards=True,\n)\
+0000a480: 6e5c 6e61 7373 6572 7420 6c65 6e28 6576  n\nassert len(ev
+0000a490: 656e 7473 2920 3d3d 2033 5c6e 6173 7365  ents) == 3\nasse
+0000a4a0: 7274 2065 7665 6e74 735b 305d 2e69 6420  rt events[0].id 
+0000a4b0: 3d3d 2065 7665 6e74 332e 6964 5c6e 6173  == event3.id\nas
+0000a4c0: 7365 7274 2065 7665 6e74 735b 315d 2e69  sert events[1].i
+0000a4d0: 6420 3d3d 2065 7665 6e74 322e 6964 5c6e  d == event2.id\n
+0000a4e0: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
+0000a4f0: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
+0000a500: 5c6e 6060 605c 6e5c 6e54 6865 2065 7861  \n```\n\nThe exa
+0000a510: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000a520: 2068 6f77 2074 6f20 7573 6520 7468 6520   how to use the 
+0000a530: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
+0000a540: 2074 6f20 7265 6164 2061 206c 696d 6974   to read a limit
+0000a550: 6564 206e 756d 6265 7220 6f66 5c6e 6576  ed number of\nev
+0000a560: 656e 7473 2e5c 6e5c 6e60 6060 7079 7468  ents.\n\n```pyth
+0000a570: 6f6e 5c6e 6576 656e 7473 203d 2063 6c69  on\nevents = cli
+0000a580: 656e 742e 7265 6164 5f73 7472 6561 6d5f  ent.read_stream_
+0000a590: 6576 656e 7473 285c 6e20 2020 2073 7472  events(\n    str
+0000a5a0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+0000a5b0: 6e61 6d65 312c 5c6e 2020 2020 6c69 6d69  name1,\n    limi
+0000a5c0: 743d 322c 5c6e 295c 6e5c 6e61 7373 6572  t=2,\n)\n\nasser
+0000a5d0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+0000a5e0: 2032 5c6e 6173 7365 7274 2065 7665 6e74   2\nassert event
+0000a5f0: 735b 305d 2e69 6420 3d3d 2065 7665 6e74  s[0].id == event
+0000a600: 312e 6964 5c6e 6173 7365 7274 2065 7665  1.id\nassert eve
+0000a610: 6e74 735b 315d 2e69 6420 3d3d 2065 7665  nts[1].id == eve
+0000a620: 6e74 322e 6964 5c6e 6060 605c 6e5c 6e54  nt2.id\n```\n\nT
+0000a630: 6865 2060 7265 6164 5f73 7472 6561 6d5f  he `read_stream_
+0000a640: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+0000a650: 2077 696c 6c20 7261 6973 6520 6120 604e   will raise a `N
+0000a660: 6f74 466f 756e 6460 2065 7863 6570 7469  otFound` excepti
+0000a670: 6f6e 2069 6620 7468 6520 6e61 6d65 6420  on if the named 
+0000a680: 7374 7265 616d 5c6e 6861 7320 6e65 7665  stream\nhas neve
+0000a690: 7220 6578 6973 7465 6420 6f72 2068 6173  r existed or has
+0000a6a0: 2062 6565 6e20 6465 6c65 7465 642e 5c6e   been deleted.\n
+0000a6b0: 5c6e 6060 6070 7974 686f 6e5c 6e66 726f  \n```python\nfro
+0000a6c0: 6d20 6573 6462 636c 6965 6e74 2e65 7863  m esdbclient.exc
+0000a6d0: 6570 7469 6f6e 7320 696d 706f 7274 204e  eptions import N
+0000a6e0: 6f74 466f 756e 645c 6e5c 6e5c 6e74 7279  otFound\n\n\ntry
+0000a6f0: 3a5c 6e20 2020 2063 6c69 656e 742e 7265  :\n    client.re
+0000a700: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+0000a710: 285c 2764 6f65 732d 6e6f 742d 6578 6973  (\'does-not-exis
+0000a720: 745c 2729 5c6e 6578 6365 7074 204e 6f74  t\')\nexcept Not
+0000a730: 466f 756e 643a 5c6e 2020 2020 7061 7373  Found:\n    pass
+0000a740: 2020 2320 5468 6520 7374 7265 616d 2064    # The stream d
+0000a750: 6f65 7320 6e6f 7420 6578 6973 742e 5c6e  oes not exist.\n
+0000a760: 656c 7365 3a5c 6e20 2020 2072 6169 7365  else:\n    raise
+0000a770: 2045 7863 6570 7469 6f6e 2822 5368 6f75   Exception("Shou
+0000a780: 6c64 6e5c 2774 2067 6574 2068 6572 6522  ldn\'t get here"
+0000a790: 295c 6e60 6060 5c6e 5c6e 506c 6561 7365  )\n```\n\nPlease
+0000a7a0: 206e 6f74 652c 2074 6869 7320 6d65 7468   note, this meth
+0000a7b0: 6f64 2073 7472 6561 6d73 2072 6563 6f72  od streams recor
+0000a7c0: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
+0000a7d0: 7468 6520 7365 7276 6572 2061 6e64 2074  the server and t
+0000a7e0: 6865 6e5c 6e63 6f6e 7374 7275 6374 7320  hen\nconstructs 
+0000a7f0: 616e 6420 7265 7475 726e 7320 6120 5079  and returns a Py
+0000a800: 7468 6f6e 2060 7475 706c 6560 2e20 496e  thon `tuple`. In
+0000a810: 2063 6173 6520 796f 7520 646f 6e5c 2774   case you don\'t
+0000a820: 2077 616e 7420 7468 6520 636c 6965 6e74   want the client
+0000a830: 2074 6f5c 6e66 696e 6973 6820 7374 7265   to\nfinish stre
+0000a840: 616d 696e 6720 6576 656e 7473 2066 726f  aming events fro
+0000a850: 6d20 7468 6520 6461 7461 6261 7365 2062  m the database b
+0000a860: 6566 6f72 6520 6974 2072 6574 7572 6e73  efore it returns
+0000a870: 2c20 796f 7520 6361 6e20 696e 7374 6561  , you can instea
+0000a880: 645c 6e75 7365 2074 6865 2060 6974 6572  d\nuse the `iter
+0000a890: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+0000a8a0: 6020 6d65 7468 6f64 2c20 7768 6963 6820  ` method, which 
+0000a8b0: 7265 7475 726e 7320 616e 2069 7465 7261  returns an itera
+0000a8c0: 626c 6520 2272 6561 6420 7265 7370 6f6e  ble "read respon
+0000a8d0: 7365 225c 6e6f 626a 6563 742e 2041 2022  se"\nobject. A "
+0000a8e0: 7265 6164 2072 6573 706f 6e73 6522 2069  read response" i
+0000a8f0: 7320 616e 2069 7465 7261 746f 722c 2061  s an iterator, a
+0000a900: 6e64 206e 6f74 2061 2073 6571 7565 6e63  nd not a sequenc
+0000a910: 652e 2052 6563 6f72 6465 6420 6576 656e  e. Recorded even
+0000a920: 7473 2063 616e 5c6e 6265 206f 6274 6169  ts can\nbe obtai
+0000a930: 6e65 6420 6279 2069 7465 7261 7469 6e67  ned by iterating
+0000a940: 206f 7665 7220 7468 6520 2272 6561 6420   over the "read 
+0000a950: 7265 7370 6f6e 7365 2220 6f62 6a65 6374  response" object
+0000a960: 2e20 4974 2073 7472 6561 6d73 2072 6563  . It streams rec
+0000a970: 6f72 6465 6420 6576 656e 7473 5c6e 6672  orded events\nfr
+0000a980: 6f6d 2074 6865 2073 6572 7665 7220 6173  om the server as
+0000a990: 2074 6865 2069 7465 7261 7469 6f6e 2070   the iteration p
+0000a9a0: 726f 6365 6564 732e 2054 6865 2069 7465  roceeds. The ite
+0000a9b0: 7261 7469 6f6e 2077 696c 6c20 6175 746f  ration will auto
+0000a9c0: 6d61 7469 6361 6c6c 7920 7374 6f70 5c6e  matically stop\n
+0000a9d0: 7768 656e 2074 6865 7265 2061 7265 206e  when there are n
+0000a9e0: 6f20 6d6f 7265 2072 6563 6f72 6465 6420  o more recorded 
+0000a9f0: 6576 656e 7473 2074 6f20 6265 2072 6574  events to be ret
+0000aa00: 7572 6e65 642e 2054 6865 2073 7472 6561  urned. The strea
+0000aa10: 6d69 6e67 206f 6620 6576 656e 7473 2c5c  ming of events,\
+0000aa20: 6e61 6e64 2068 656e 6365 2074 6865 2069  nand hence the i
+0000aa30: 7465 7261 746f 722c 2063 616e 2061 6c73  terator, can als
+0000aa40: 6f20 6265 2073 746f 7070 6564 2070 7265  o be stopped pre
+0000aa50: 6d61 7475 7265 6c79 2062 7920 6361 6c6c  maturely by call
+0000aa60: 696e 6720 7468 6520 6073 746f 7028 2960  ing the `stop()`
+0000aa70: 5c6e 6d65 7468 6f64 206f 6e20 7468 6520  \nmethod on the 
+0000aa80: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
+0000aa90: 6f62 6a65 6374 2e5c 6e5c 6e49 6e20 6661  object.\n\nIn fa
+0000aaa0: 6374 2c20 7468 6520 6072 6561 645f 7374  ct, the `read_st
+0000aab0: 7265 616d 5f65 7665 6e74 7328 2960 206d  ream_events()` m
+0000aac0: 6574 686f 6420 6361 6c6c 7320 6069 7465  ethod calls `ite
+0000aad0: 725f 7374 7265 616d 5f65 7665 6e74 7328  r_stream_events(
+0000aae0: 2960 2061 6e64 2070 6173 7365 735c 6e74  )` and passes\nt
+0000aaf0: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
+0000ab00: 6522 2069 7465 7261 746f 7220 696e 746f  e" iterator into
+0000ab10: 2074 6865 2050 7974 686f 6e20 6074 7570   the Python `tup
+0000ab20: 6c65 6020 636f 6e73 7472 7563 746f 722e  le` constructor.
+0000ab30: 2048 6f77 6576 6572 2c20 7468 655c 6e60   However, the\n`
+0000ab40: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+0000ab50: 7473 2829 6020 6d65 7468 6f64 2069 7320  ts()` method is 
+0000ab60: 6465 636f 7261 7465 6420 7769 7468 2072  decorated with r
+0000ab70: 6574 7279 2061 6e64 2072 6563 6f6e 6e65  etry and reconne
+0000ab80: 6374 2064 6563 6f72 6174 6f72 732c 5c6e  ct decorators,\n
+0000ab90: 7768 696c 7374 2074 6865 2060 6974 6572  whilst the `iter
+0000aba0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+0000abb0: 6020 6d65 7468 6f64 2069 7320 6e6f 742e  ` method is not.
+0000abc0: 2054 6869 7320 6d65 616e 7320 7468 6174   This means that
+0000abd0: 2061 6c6c 2065 7272 6f72 7320 6475 6520   all errors due 
+0000abe0: 746f 5c6e 636f 6e6e 6563 7469 6f6e 2069  to\nconnection i
+0000abf0: 7373 7565 7320 7769 6c6c 2062 6520 6361  ssues will be ca
+0000ac00: 7567 6874 2062 7920 7468 6520 7265 7472  ught by the retr
+0000ac10: 7920 616e 6420 7265 636f 6e6e 6563 7420  y and reconnect 
+0000ac20: 6465 636f 7261 746f 7273 2077 6865 6e20  decorators when 
+0000ac30: 6361 6c6c 696e 675c 6e74 6865 2060 7265  calling\nthe `re
+0000ac40: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+0000ac50: 2829 6020 6d65 7468 6f64 2c20 6275 7420  ()` method, but 
+0000ac60: 6e6f 7420 7768 656e 2063 616c 6c69 6e67  not when calling
+0000ac70: 2060 6974 6572 5f73 7472 6561 6d5f 6576   `iter_stream_ev
+0000ac80: 656e 7473 2829 602e 2054 6865 5c6e 6069  ents()`. The\n`i
+0000ac90: 7465 725f 7374 7265 616d 5f65 7665 6e74  ter_stream_event
+0000aca0: 7328 2960 206d 6574 686f 6420 6861 7320  s()` method has 
+0000acb0: 6e6f 2073 7563 6820 6465 636f 7261 746f  no such decorato
+0000acc0: 7273 2062 6563 6175 7365 2074 6865 2073  rs because the s
+0000acd0: 7472 6561 6d69 6e67 206f 6e6c 7920 7374  treaming only st
+0000ace0: 6172 7473 5c6e 7768 656e 2069 7465 7261  arts\nwhen itera
+0000acf0: 7469 6e67 206f 7665 7220 7468 6520 2272  ting over the "r
+0000ad00: 6561 6420 7265 7370 6f6e 7365 2220 7374  ead response" st
+0000ad10: 6172 7473 2c20 7768 6963 6820 6d65 616e  arts, which mean
+0000ad20: 7320 7468 6174 2074 6865 206d 6574 686f  s that the metho
+0000ad30: 6420 7265 7475 726e 735c 6e62 6566 6f72  d returns\nbefor
+0000ad40: 6520 7468 6520 7374 7265 616d 696e 6720  e the streaming 
+0000ad50: 7374 6172 7473 2c20 616e 6420 736f 2074  starts, and so t
+0000ad60: 6865 7265 2069 7320 6e6f 2063 6861 6e63  here is no chanc
+0000ad70: 6520 666f 7220 616e 7920 6465 636f 7261  e for any decora
+0000ad80: 746f 7273 2074 6f20 6361 7463 685c 6e61  tors to catch\na
+0000ad90: 6e79 2063 6f6e 6e65 6374 696f 6e20 6973  ny connection is
+0000ada0: 7375 6573 2e5c 6e5c 6e4e 6576 6572 7468  sues.\n\nNeverth
+0000adb0: 656c 6573 732c 2069 6620 796f 7520 6172  eless, if you ar
+0000adc0: 6520 7265 6164 696e 6720 6120 7665 7279  e reading a very
+0000add0: 206c 6172 6765 2073 7472 6561 6d2c 2074   large stream, t
+0000ade0: 6865 6e20 796f 7520 6d69 6768 7420 7072  hen you might pr
+0000adf0: 6566 6572 2074 6f20 6361 6c6c 5c6e 6069  efer to call\n`i
+0000ae00: 7465 725f 7374 7265 616d 5f65 7665 6e74  ter_stream_event
+0000ae10: 7328 2960 2c20 616e 6420 746f 2062 6567  s()`, and to beg
+0000ae20: 696e 2069 7465 7261 7469 6e67 2074 6872  in iterating thr
+0000ae30: 6f75 6768 2074 6865 2072 6563 6f72 6465  ough the recorde
+0000ae40: 6420 6576 656e 7473 2077 6869 6c73 745c  d events whilst\
+0000ae50: 6e74 6865 7920 6172 6520 6265 696e 6720  nthey are being 
+0000ae60: 7374 7265 616d 6564 2066 726f 6d20 7468  streamed from th
+0000ae70: 6520 7365 7276 6572 2c20 7261 7468 6572  e server, rather
+0000ae80: 2074 6861 6e20 626f 7468 2077 6169 7469   than both waiti
+0000ae90: 6e67 2061 6e64 2068 6176 696e 6720 7468  ng and having th
+0000aea0: 656d 5c6e 616c 6c20 6163 6375 6d75 6c61  em\nall accumula
+0000aeb0: 7465 2069 6e20 6d65 6d6f 7279 2e20 4265  te in memory. Be
+0000aec0: 6361 7573 6520 6f66 2074 6865 2072 6973  cause of the ris
+0000aed0: 6b20 6f66 2063 6f6e 6e65 6374 696f 6e20  k of connection 
+0000aee0: 6973 7375 6573 2061 7269 7369 6e67 2064  issues arising d
+0000aef0: 7572 696e 675c 6e74 6865 2073 7472 6561  uring\nthe strea
+0000af00: 6d69 6e67 206f 6620 7265 636f 7264 6564  ming of recorded
+0000af10: 2065 7665 6e74 7320 6672 6f6d 2074 6865   events from the
+0000af20: 2073 6572 7665 722c 2079 6f75 2077 696c   server, you wil
+0000af30: 6c20 6e65 6564 2074 6f20 6361 7265 2061  l need to care a
+0000af40: 626f 7574 5c6e 636f 6e6e 6563 7469 6f6e  bout\nconnection
+0000af50: 2069 7373 7565 7320 7768 656e 2069 7465   issues when ite
+0000af60: 7261 7469 6e67 206f 7665 7220 7468 6520  rating over the 
+0000af70: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
+0000af80: 6f62 6a65 6374 2072 6574 7572 6e65 6420  object returned 
+0000af90: 6672 6f6d 5c6e 6069 7465 725f 7374 7265  from\n`iter_stre
+0000afa0: 616d 5f65 7665 6e74 7328 2960 2e5c 6e5c  am_events()`.\n\
+0000afb0: 6e23 2323 2047 6574 2063 7572 7265 6e74  n### Get current
+0000afc0: 2076 6572 7369 6f6e 5c6e 5c6e 5468 6520   version\n\nThe 
+0000afd0: 6067 6574 5f63 7572 7265 6e74 5f76 6572  `get_current_ver
+0000afe0: 7369 6f6e 2829 6020 6d65 7468 6f64 2069  sion()` method i
+0000aff0: 7320 6120 636f 6e76 656e 6965 6e63 6520  s a convenience 
+0000b000: 6d65 7468 6f64 2074 6861 7420 6573 7365  method that esse
+0000b010: 6e74 6961 6c6c 7920 6361 6c6c 735c 6e60  ntially calls\n`
+0000b020: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+0000b030: 7473 2829 6020 7769 7468 2060 6261 636b  ts()` with `back
+0000b040: 7761 7264 733d 5472 7565 6020 616e 6420  wards=True` and 
+0000b050: 606c 696d 6974 3d31 602e 2054 6869 7320  `limit=1`. This 
+0000b060: 6d65 7468 6f64 2072 6574 7572 6e73 5c6e  method returns\n
+0000b070: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+0000b080: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
+0000b090: 6e60 2061 7474 7269 6275 7465 206f 6620  n` attribute of 
+0000b0a0: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
+0000b0b0: 6420 6576 656e 7420 696e 2061 5c6e 7374  d event in a\nst
+0000b0c0: 7265 616d 2e20 4966 2061 2073 7472 6561  ream. If a strea
+0000b0d0: 6d20 646f 6573 206e 6f74 2065 7869 7374  m does not exist
+0000b0e0: 2c20 7468 6520 7265 7475 726e 6564 2076  , the returned v
+0000b0f0: 616c 7565 2069 7320 604e 6f6e 6560 2e20  alue is `None`. 
+0000b100: 5468 6520 7265 7475 726e 6564 5c6e 7661  The returned\nva
+0000b110: 6c75 6520 6973 2074 6865 2063 6f72 7265  lue is the corre
+0000b120: 6374 2076 616c 7565 206f 6620 6063 7572  ct value of `cur
+0000b130: 7265 6e74 5f76 6572 7369 6f6e 6020 7768  rent_version` wh
+0000b140: 656e 2061 7070 656e 6469 6e67 206e 6577  en appending new
+0000b150: 2065 7665 6e74 7320 746f 5c6e 6120 7374   events to\na st
+0000b160: 7265 616d 2e5c 6e5c 6e54 6869 7320 6d65  ream.\n\nThis me
+0000b170: 7468 6f64 2068 6173 206f 6e65 2072 6571  thod has one req
+0000b180: 7569 7265 6420 6172 6775 6d65 6e74 2c20  uired argument, 
+0000b190: 6073 7472 6561 6d5f 6e61 6d65 602e 5c6e  `stream_name`.\n
+0000b1a0: 5c6e 5468 6520 7265 7175 6972 6564 2060  \nThe required `
+0000b1b0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+0000b1c0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0000b1d0: 6e20 6073 7472 6020 7468 6174 2075 6e69  n `str` that uni
+0000b1e0: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
+0000b1f0: 2061 5c6e 7374 7265 616d 2066 726f 6d20   a\nstream from 
+0000b200: 7768 6963 6820 6120 7374 7265 616d 2070  which a stream p
+0000b210: 6f73 6974 696f 6e20 7769 6c6c 2062 6520  osition will be 
+0000b220: 7265 7475 726e 6564 2e5c 6e5c 6e54 6869  returned.\n\nThi
+0000b230: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
+0000b240: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+0000b250: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+0000b260: 2c20 7468 6174 5c6e 6973 2065 7870 6563  , that\nis expec
+0000b270: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+0000b280: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+0000b290: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+0000b2a0: 655c 6e66 6f72 2074 6865 2063 6f6d 706c  e\nfor the compl
+0000b2b0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0000b2c0: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
+0000b2d0: 496e 2074 6865 2065 7861 6d70 6c65 2062  In the example b
+0000b2e0: 656c 6f77 2c20 7468 6520 6c61 7374 2073  elow, the last s
+0000b2f0: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
+0000b300: 6620 6073 7472 6561 6d5f 6e61 6d65 3160  f `stream_name1`
+0000b310: 2069 7320 6f62 7461 696e 6564 2e5c 6e53   is obtained.\nS
+0000b320: 696e 6365 2074 6872 6565 2065 7665 6e74  ince three event
+0000b330: 7320 6861 7665 2062 6565 6e20 6170 7065  s have been appe
+0000b340: 6e64 6564 2074 6f20 6073 7472 6561 6d5f  nded to `stream_
+0000b350: 6e61 6d65 3160 2c20 616e 6420 6265 6361  name1`, and beca
+0000b360: 7573 6520 706f 7369 7469 6f6e 735c 6e69  use positions\ni
+0000b370: 6e20 6120 7374 7265 616d 2061 7265 207a  n a stream are z
+0000b380: 6572 6f2d 6261 7365 6420 616e 6420 6761  ero-based and ga
+0000b390: 706c 6573 732c 2073 6f20 7468 6520 6375  pless, so the cu
+0000b3a0: 7272 656e 7420 7665 7273 696f 6e20 6973  rrent version is
+0000b3b0: 2060 3260 2e5c 6e5c 6e60 6060 7079 7468   `2`.\n\n```pyth
+0000b3c0: 6f6e 5c6e 6375 7272 656e 745f 7665 7273  on\ncurrent_vers
+0000b3d0: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
+0000b3e0: 5f63 7572 7265 6e74 5f76 6572 7369 6f6e  _current_version
+0000b3f0: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
+0000b400: 6d65 3d73 7472 6561 6d5f 6e61 6d65 315c  me=stream_name1\
+0000b410: 6e29 5c6e 5c6e 6173 7365 7274 2063 7572  n)\n\nassert cur
+0000b420: 7265 6e74 5f76 6572 7369 6f6e 203d 3d20  rent_version == 
+0000b430: 325c 6e60 6060 5c6e 5c6e 4966 2061 2073  2\n```\n\nIf a s
+0000b440: 7472 6561 6d20 6861 7320 6e65 7665 7220  tream has never 
+0000b450: 6578 6973 7465 6420 6f72 2068 6173 2062  existed or has b
+0000b460: 6565 6e20 6465 6c65 7465 642c 2074 6865  een deleted, the
+0000b470: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
+0000b480: 6973 2060 4e6f 6e65 602c 5c6e 7768 6963  is `None`,\nwhic
+0000b490: 6820 6d61 7463 6865 7320 7468 6520 7265  h matches the re
+0000b4a0: 7175 6972 6564 2076 616c 7565 206f 6620  quired value of 
+0000b4b0: 7468 6520 6063 7572 7265 6e74 5f76 6572  the `current_ver
+0000b4c0: 7369 6f6e 6020 6172 6775 6d65 6e74 2062  sion` argument b
+0000b4d0: 6f74 6820 7768 656e 5c6e 6170 7065 6e64  oth when\nappend
+0000b4e0: 696e 6720 7468 6520 6669 7273 7420 6576  ing the first ev
+0000b4f0: 656e 7420 6f66 2061 206e 6577 2073 7472  ent of a new str
+0000b500: 6561 6d2c 2061 6e64 2061 6c73 6f20 7768  eam, and also wh
+0000b510: 656e 2061 7070 656e 6469 6e67 2065 7665  en appending eve
+0000b520: 6e74 7320 746f 5c6e 6120 7374 7265 616d  nts to\na stream
+0000b530: 2074 6861 7420 6861 7320 6265 656e 2064   that has been d
+0000b540: 656c 6574 6564 2e5c 6e5c 6e60 6060 7079  eleted.\n\n```py
+0000b550: 7468 6f6e 5c6e 6375 7272 656e 745f 7665  thon\ncurrent_ve
+0000b560: 7273 696f 6e20 3d20 636c 6965 6e74 2e67  rsion = client.g
+0000b570: 6574 5f63 7572 7265 6e74 5f76 6572 7369  et_current_versi
+0000b580: 6f6e 285c 6e20 2020 2073 7472 6561 6d5f  on(\n    stream_
+0000b590: 6e61 6d65 3d5c 2764 6f65 732d 6e6f 742d  name=\'does-not-
+0000b5a0: 6578 6973 745c 275c 6e29 5c6e 5c6e 6173  exist\'\n)\n\nas
+0000b5b0: 7365 7274 2063 7572 7265 6e74 5f76 6572  sert current_ver
+0000b5c0: 7369 6f6e 2069 7320 4e6f 6e65 5c6e 6060  sion is None\n``
+0000b5d0: 605c 6e5c 6e23 2323 2048 6f77 2074 6f20  `\n\n### How to 
+0000b5e0: 696d 706c 656d 656e 7420 736e 6170 7368  implement snapsh
+0000b5f0: 6f74 7469 6e67 2077 6974 6820 4576 656e  otting with Even
+0000b600: 7453 746f 7265 4442 5c6e 5c6e 536e 6170  tStoreDB\n\nSnap
+0000b610: 7368 6f74 7320 6361 6e20 696d 7072 6f76  shots can improv
+0000b620: 6520 7468 6520 7065 7266 6f72 6d61 6e63  e the performanc
+0000b630: 6520 6f66 2061 6767 7265 6761 7465 7320  e of aggregates 
+0000b640: 7468 6174 2077 6f75 6c64 206f 7468 6572  that would other
+0000b650: 7769 7365 2062 655c 6e72 6563 6f6e 7374  wise be\nreconst
+0000b660: 7275 6374 6564 2066 726f 6d20 7665 7279  ructed from very
+0000b670: 206c 6f6e 6720 7374 7265 616d 732e 2048   long streams. H
+0000b680: 6f77 6576 6572 2c20 6974 2069 7320 6765  owever, it is ge
+0000b690: 6e65 7261 6c6c 7920 7265 636f 6d6d 656e  nerally recommen
+0000b6a0: 6465 6420 746f 2064 6573 6967 6e5c 6e61  ded to design\na
+0000b6b0: 6767 7265 6761 7465 7320 746f 2068 6176  ggregates to hav
+0000b6c0: 6520 6120 6669 6e69 7465 206c 6966 6563  e a finite lifec
+0000b6d0: 7963 6c65 2c20 616e 6420 736f 2074 6f20  ycle, and so to 
+0000b6e0: 6861 7665 2072 656c 6174 6976 656c 7920  have relatively 
+0000b6f0: 7368 6f72 7420 7374 7265 616d 732c 5c6e  short streams,\n
+0000b700: 7468 6572 6562 7920 6176 6f69 6469 6e67  thereby avoiding
+0000b710: 2074 6865 206e 6565 6420 666f 7220 736e   the need for sn
+0000b720: 6170 7368 6f74 7469 6e67 2e20 5468 6973  apshotting. This
+0000b730: 2022 686f 7720 746f 2220 7365 6374 696f   "how to" sectio
+0000b740: 6e20 6973 2069 6e74 656e 6465 6420 6d65  n is intended me
+0000b750: 7265 6c79 5c6e 746f 2073 686f 7720 686f  rely\nto show ho
+0000b760: 7720 736e 6170 7368 6f74 7469 6e67 206f  w snapshotting o
+0000b770: 6620 6167 6772 6567 6174 6573 2063 616e  f aggregates can
+0000b780: 2062 6520 696d 706c 656d 656e 7465 6420   be implemented 
+0000b790: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
+0000b7a0: 4220 7573 696e 675c 6e74 6869 7320 5079  B using\nthis Py
+0000b7b0: 7468 6f6e 2063 6c69 656e 742e 5c6e 5c6e  thon client.\n\n
+0000b7c0: 4576 656e 742d 736f 7572 6365 6420 6167  Event-sourced ag
+0000b7d0: 6772 6567 6174 6573 2061 7265 2074 7970  gregates are typ
+0000b7e0: 6963 616c 6c79 2072 6563 6f6e 7374 7275  ically reconstru
+0000b7f0: 6374 6564 2066 726f 6d20 7265 636f 7264  cted from record
+0000b800: 6564 2065 7665 6e74 7320 6279 2063 616c  ed events by cal
+0000b810: 6c69 6e67 5c6e 6120 6d75 7461 746f 7220  ling\na mutator 
+0000b820: 6675 6e63 7469 6f6e 2066 6f72 2065 6163  function for eac
+0000b830: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+0000b840: 2c20 6576 6f6c 7669 6e67 2066 726f 6d20  , evolving from 
+0000b850: 616e 2069 6e69 7469 616c 2073 7461 7465  an initial state
+0000b860: 5c6e 604e 6f6e 6560 2074 6f20 7468 6520  \n`None` to the 
+0000b870: 6375 7272 656e 7420 7374 6174 6520 6f66  current state of
+0000b880: 2074 6865 2061 6767 7265 6761 7465 2e20   the aggregate. 
+0000b890: 5468 6520 6675 6e63 7469 6f6e 2060 6765  The function `ge
+0000b8a0: 745f 6167 6772 6567 6174 6528 2960 2073  t_aggregate()` s
+0000b8b0: 686f 7773 5c6e 686f 7720 7468 6973 2063  hows\nhow this c
+0000b8c0: 616e 2062 6520 646f 6e65 2e20 5468 6520  an be done. The 
+0000b8d0: 6167 6772 6567 6174 6520 4944 2069 7320  aggregate ID is 
+0000b8e0: 7573 6564 2061 7320 6120 7374 7265 616d  used as a stream
+0000b8f0: 206e 616d 652e 2054 6865 2065 7863 6570   name. The excep
+0000b900: 7469 6f6e 5c6e 6041 6767 7265 6761 7465  tion\n`Aggregate
+0000b910: 4e6f 7446 6f75 6e64 6020 6973 2072 6169  NotFound` is rai
+0000b920: 7365 6420 6966 2074 6865 2061 6767 7265  sed if the aggre
+0000b930: 6761 7465 2073 7472 6561 6d20 6973 206e  gate stream is n
+0000b940: 6f74 2066 6f75 6e64 2e5c 6e5c 6e60 6060  ot found.\n\n```
+0000b950: 7079 7468 6f6e 5c6e 636c 6173 7320 4167  python\nclass Ag
+0000b960: 6772 6567 6174 654e 6f74 466f 756e 6428  gregateNotFound(
+0000b970: 4578 6365 7074 696f 6e29 3a5c 6e20 2020  Exception):\n   
+0000b980: 2022 2222 5261 6973 6564 2077 6865 6e20   """Raised when 
+0000b990: 616e 2061 6767 7265 6761 7465 2069 7320  an aggregate is 
+0000b9a0: 6e6f 7420 666f 756e 642e 2222 225c 6e5c  not found."""\n\
+0000b9b0: 6e5c 6e64 6566 2067 6574 5f61 6767 7265  n\ndef get_aggre
+0000b9c0: 6761 7465 2861 6767 7265 6761 7465 5f69  gate(aggregate_i
+0000b9d0: 642c 206d 7574 6174 6f72 5f66 756e 6329  d, mutator_func)
+0000b9e0: 3a5c 6e20 2020 2073 7472 6561 6d5f 6e61  :\n    stream_na
+0000b9f0: 6d65 203d 2061 6767 7265 6761 7465 5f69  me = aggregate_i
+0000ba00: 645c 6e5c 6e20 2020 2023 2047 6574 2072  d\n\n    # Get r
+0000ba10: 6563 6f72 6465 6420 6576 656e 7473 2e5c  ecorded events.\
+0000ba20: 6e20 2020 2074 7279 3a5c 6e20 2020 2020  n    try:\n     
+0000ba30: 2020 2065 7665 6e74 7320 3d20 636c 6965     events = clie
+0000ba40: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
+0000ba50: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
+0000ba60: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+0000ba70: 7374 7265 616d 5f6e 616d 652c 5c6e 2020  stream_name,\n  
+0000ba80: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000ba90: 5f70 6f73 6974 696f 6e3d 4e6f 6e65 5c6e  _position=None\n
+0000baa0: 2020 2020 2020 2020 295c 6e20 2020 2065          )\n    e
+0000bab0: 7863 6570 7420 4e6f 7446 6f75 6e64 2061  xcept NotFound a
+0000bac0: 7320 653a 5c6e 2020 2020 2020 2020 7261  s e:\n        ra
+0000bad0: 6973 6520 4167 6772 6567 6174 654e 6f74  ise AggregateNot
+0000bae0: 466f 756e 6428 6167 6772 6567 6174 655f  Found(aggregate_
+0000baf0: 6964 2920 6672 6f6d 2065 5c6e 2020 2020  id) from e\n    
+0000bb00: 656c 7365 3a5c 6e20 2020 2020 2020 2023  else:\n        #
+0000bb10: 2052 6563 6f6e 7374 7275 6374 2061 6767   Reconstruct agg
+0000bb20: 7265 6761 7465 2066 726f 6d20 7265 636f  regate from reco
+0000bb30: 7264 6564 2065 7665 6e74 732e 5c6e 2020  rded events.\n  
+0000bb40: 2020 2020 2020 6167 6772 6567 6174 6520        aggregate 
+0000bb50: 3d20 4e6f 6e65 5c6e 2020 2020 2020 2020  = None\n        
+0000bb60: 666f 7220 6576 656e 7420 696e 2065 7665  for event in eve
+0000bb70: 6e74 733a 5c6e 2020 2020 2020 2020 2020  nts:\n          
+0000bb80: 2020 6167 6772 6567 6174 6520 3d20 6d75    aggregate = mu
+0000bb90: 7461 746f 725f 6675 6e63 2861 6767 7265  tator_func(aggre
+0000bba0: 6761 7465 2c20 6576 656e 7429 5c6e 2020  gate, event)\n  
+0000bbb0: 2020 2020 2020 7265 7475 726e 2061 6767        return agg
+0000bbc0: 7265 6761 7465 5c6e 6060 605c 6e5c 6e53  regate\n```\n\nS
+0000bbd0: 6e61 7073 686f 7474 696e 6720 6f66 2061  napshotting of a
+0000bbe0: 6767 7265 6761 7465 7320 6361 6e20 6265  ggregates can be
+0000bbf0: 2069 6d70 6c65 6d65 6e74 6564 2062 7920   implemented by 
+0000bc00: 7265 636f 7264 696e 6720 7468 6520 6375  recording the cu
+0000bc10: 7272 656e 7420 7374 6174 6520 6f66 5c6e  rrent state of\n
+0000bc20: 616e 2061 6767 7265 6761 7465 2061 7320  an aggregate as 
+0000bc30: 6120 6e65 7720 6576 656e 742e 5c6e 5c6e  a new event.\n\n
+0000bc40: 4966 2061 6e20 6167 6772 6567 6174 6520  If an aggregate 
+0000bc50: 6f62 6a65 6374 2068 6173 2061 2076 6572  object has a ver
+0000bc60: 7369 6f6e 206e 756d 6265 7220 7468 6174  sion number that
+0000bc70: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
+0000bc80: 7468 6520 7374 7265 616d 2070 6f73 6974  the stream posit
+0000bc90: 696f 6e20 6f66 5c6e 7468 6520 6c61 7374  ion of\nthe last
+0000bca0: 2065 7665 6e74 2074 6861 7420 7761 7320   event that was 
+0000bcb0: 7573 6564 2074 6f20 7265 636f 6e73 7472  used to reconstr
+0000bcc0: 7563 7420 7468 6520 6167 6772 6567 6174  uct the aggregat
+0000bcd0: 652c 2061 6e64 2074 6869 7320 7665 7273  e, and this vers
+0000bce0: 696f 6e20 6e75 6d62 6572 5c6e 6973 2072  ion number\nis r
+0000bcf0: 6563 6f72 6465 6420 696e 2074 6865 2073  ecorded in the s
+0000bd00: 6e61 7073 686f 7420 6d65 7461 6461 7461  napshot metadata
+0000bd10: 2c20 7468 656e 2061 6e79 2065 7665 6e74  , then any event
+0000bd20: 7320 7468 6174 2061 7265 2072 6563 6f72  s that are recor
+0000bd30: 6465 6420 6166 7465 7220 7468 655c 6e73  ded after the\ns
+0000bd40: 6e61 7073 686f 7420 6361 6e20 6265 2073  napshot can be s
+0000bd50: 656c 6563 7465 6420 7573 696e 6720 7468  elected using th
+0000bd60: 6973 2076 6572 7369 6f6e 206e 756d 6265  is version numbe
+0000bd70: 722e 2054 6865 2061 6767 7265 6761 7465  r. The aggregate
+0000bd80: 2063 616e 2074 6865 6e20 6265 5c6e 7265   can then be\nre
+0000bd90: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
+0000bda0: 2074 6865 206c 6173 7420 736e 6170 7368   the last snapsh
+0000bdb0: 6f74 2061 6e64 2061 6e79 2073 7562 7365  ot and any subse
+0000bdc0: 7175 656e 7420 6576 656e 7473 2c20 7769  quent events, wi
+0000bdd0: 7468 6f75 7420 6861 7669 6e67 5c6e 746f  thout having\nto
+0000bde0: 2072 6570 6c61 7920 7468 6520 656e 7469   replay the enti
+0000bdf0: 7265 2068 6973 746f 7279 2e5c 6e5c 6e57  re history.\n\nW
+0000be00: 6520 7769 6c6c 2075 7365 2061 2073 6570  e will use a sep
+0000be10: 6172 6174 6520 7374 7265 616d 2066 6f72  arate stream for
+0000be20: 2061 6e20 6167 6772 6567 6174 655c 2773   an aggregate\'s
+0000be30: 2073 6e61 7073 686f 7473 2074 6861 7420   snapshots that 
+0000be40: 6973 206e 616d 6564 2061 6674 6572 2074  is named after t
+0000be50: 6865 5c6e 7374 7265 616d 2075 7365 6420  he\nstream used 
+0000be60: 666f 7220 7265 636f 7264 696e 6720 6974  for recording it
+0000be70: 7320 6576 656e 7473 2e20 5468 6520 6e61  s events. The na
+0000be80: 6d65 206f 6620 7468 6520 736e 6170 7368  me of the snapsh
+0000be90: 6f74 2073 7472 6561 6d20 7769 6c6c 2062  ot stream will b
+0000bea0: 655c 6e63 6f6e 7374 7275 6374 6564 2062  e\nconstructed b
+0000beb0: 7920 7072 6566 6978 696e 6720 7468 6520  y prefixing the 
+0000bec0: 6167 6772 6567 6174 655c 2773 2073 7472  aggregate\'s str
+0000bed0: 6561 6d20 6e61 6d65 2077 6974 6820 605c  eam name with `\
+0000bee0: 2773 6e61 7073 686f 742d 245c 2760 2e5c  'snapshot-$\'`.\
+0000bef0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 534e  n\n```python\nSN
+0000bf00: 4150 5348 4f54 5f53 5452 4541 4d5f 4e41  APSHOT_STREAM_NA
+0000bf10: 4d45 5f50 5245 4649 5820 3d20 5c27 736e  ME_PREFIX = \'sn
+0000bf20: 6170 7368 6f74 2d24 5c27 5c6e 5c6e 6465  apshot-$\'\n\nde
+0000bf30: 6620 6d61 6b65 5f73 6e61 7073 686f 745f  f make_snapshot_
+0000bf40: 7374 7265 616d 5f6e 616d 6528 7374 7265  stream_name(stre
+0000bf50: 616d 5f6e 616d 6529 3a5c 6e20 2020 2072  am_name):\n    r
+0000bf60: 6574 7572 6e20 665c 277b 534e 4150 5348  eturn f\'{SNAPSH
+0000bf70: 4f54 5f53 5452 4541 4d5f 4e41 4d45 5f50  OT_STREAM_NAME_P
+0000bf80: 5245 4649 587d 7b73 7472 6561 6d5f 6e61  REFIX}{stream_na
+0000bf90: 6d65 7d5c 275c 6e5c 6e5c 6e64 6566 2072  me}\'\n\n\ndef r
+0000bfa0: 656d 6f76 655f 736e 6170 7368 6f74 5f73  emove_snapshot_s
+0000bfb0: 7472 6561 6d5f 7072 6566 6978 2873 6e61  tream_prefix(sna
+0000bfc0: 7073 686f 745f 7374 7265 616d 5f6e 616d  pshot_stream_nam
+0000bfd0: 6529 3a5c 6e20 2020 2061 7373 6572 7420  e):\n    assert 
+0000bfe0: 736e 6170 7368 6f74 5f73 7472 6561 6d5f  snapshot_stream_
+0000bff0: 6e61 6d65 2e73 7461 7274 7377 6974 6828  name.startswith(
+0000c000: 534e 4150 5348 4f54 5f53 5452 4541 4d5f  SNAPSHOT_STREAM_
+0000c010: 4e41 4d45 5f50 5245 4649 5829 5c6e 2020  NAME_PREFIX)\n  
+0000c020: 2020 7265 7475 726e 2073 6e61 7073 686f    return snapsho
+0000c030: 745f 7374 7265 616d 5f6e 616d 655b 6c65  t_stream_name[le
+0000c040: 6e28 534e 4150 5348 4f54 5f53 5452 4541  n(SNAPSHOT_STREA
+0000c050: 4d5f 4e41 4d45 5f50 5245 4649 5829 3a5d  M_NAME_PREFIX):]
+0000c060: 5c6e 6060 605c 6e5c 6e4e 6f77 2c20 6c65  \n```\n\nNow, le
+0000c070: 745c 2773 2072 6564 6566 696e 6520 7468  t\'s redefine th
+0000c080: 6520 6067 6574 5f61 6767 7265 6761 7465  e `get_aggregate
+0000c090: 2829 6020 6675 6e63 7469 6f6e 2c20 736f  ()` function, so
+0000c0a0: 2074 6861 7420 6974 206c 6f6f 6b73 2066   that it looks f
+0000c0b0: 6f72 2061 2073 6e61 7073 686f 7420 6576  or a snapshot ev
+0000c0c0: 656e 742c 5c6e 7468 656e 2073 656c 6563  ent,\nthen selec
+0000c0d0: 7473 2073 7562 7365 7175 656e 7420 6167  ts subsequent ag
+0000c0e0: 6772 6567 6174 6520 6576 656e 7473 2c20  gregate events, 
+0000c0f0: 616e 6420 7468 656e 2063 616c 6c73 2061  and then calls a
+0000c100: 206d 7574 6174 6f72 2066 756e 6374 696f   mutator functio
+0000c110: 6e20 666f 7220 6561 6368 5c6e 7265 636f  n for each\nreco
+0000c120: 7264 6564 2065 7665 6e74 2e5c 6e5c 6e4e  rded event.\n\nN
+0000c130: 6f74 6963 6520 7468 6174 2074 6865 2061  otice that the a
+0000c140: 6767 7265 6761 7465 2065 7665 6e74 7320  ggregate events 
+0000c150: 6172 6520 7265 6164 2066 726f 6d20 6120  are read from a 
+0000c160: 7374 7265 616d 2066 6f72 2073 6572 6961  stream for seria
+0000c170: 6c69 7a65 6420 6167 6772 6567 6174 655c  lized aggregate\
+0000c180: 6e65 7665 6e74 732c 2077 6869 6c73 7420  nevents, whilst 
+0000c190: 7468 6520 736e 6170 7368 6f74 2069 7320  the snapshot is 
+0000c1a0: 7265 6164 2066 726f 6d20 6120 7365 7061  read from a sepa
+0000c1b0: 7261 7465 2073 7472 6561 6d20 666f 7220  rate stream for 
+0000c1c0: 7365 7269 616c 697a 6564 2061 6767 7265  serialized aggre
+0000c1d0: 6761 7465 5c6e 736e 6170 7368 6f74 732e  gate\nsnapshots.
+0000c1e0: 2057 6520 7769 6c6c 2075 7365 204a 534f   We will use JSO
+0000c1f0: 4e20 746f 2073 6572 6961 6c69 7a65 2061  N to serialize a
+0000c200: 6e64 2064 6573 6572 6961 6c69 7a65 2065  nd deserialize e
+0000c210: 7665 6e74 2064 6174 612e 5c6e 5c6e 5c6e  vent data.\n\n\n
+0000c220: 6060 6070 7974 686f 6e5c 6e69 6d70 6f72  ```python\nimpor
+0000c230: 7420 6a73 6f6e 5c6e 5c6e 5c6e 6465 6620  t json\n\n\ndef 
+0000c240: 6765 745f 6167 6772 6567 6174 6528 6167  get_aggregate(ag
+0000c250: 6772 6567 6174 655f 6964 2c20 6d75 7461  gregate_id, muta
+0000c260: 746f 725f 6675 6e63 293a 5c6e 2020 2020  tor_func):\n    
+0000c270: 7374 7265 616d 5f6e 616d 6520 3d20 6167  stream_name = ag
+0000c280: 6772 6567 6174 655f 6964 5c6e 2020 2020  gregate_id\n    
+0000c290: 7265 636f 7264 6564 5f65 7665 6e74 7320  recorded_events 
+0000c2a0: 3d20 5b5d 5c6e 5c6e 2020 2020 2320 4c6f  = []\n\n    # Lo
+0000c2b0: 6f6b 2066 6f72 2061 2073 6e61 7073 686f  ok for a snapsho
+0000c2c0: 742e 5c6e 2020 2020 7472 793a 5c6e 2020  t.\n    try:\n  
+0000c2d0: 2020 2020 2020 736e 6170 7368 6f74 7320        snapshots 
+0000c2e0: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
+0000c2f0: 7265 616d 5f65 7665 6e74 7328 5c6e 2020  ream_events(\n  
+0000c300: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000c310: 5f6e 616d 653d 6d61 6b65 5f73 6e61 7073  _name=make_snaps
+0000c320: 686f 745f 7374 7265 616d 5f6e 616d 6528  hot_stream_name(
+0000c330: 7374 7265 616d 5f6e 616d 6529 2c5c 6e20  stream_name),\n 
+0000c340: 2020 2020 2020 2020 2020 2062 6163 6b77             backw
+0000c350: 6172 6473 3d54 7275 652c 5c6e 2020 2020  ards=True,\n    
+0000c360: 2020 2020 2020 2020 6c69 6d69 743d 315c          limit=1\
+0000c370: 6e20 2020 2020 2020 2029 5c6e 2020 2020  n        )\n    
+0000c380: 6578 6365 7074 204e 6f74 466f 756e 643a  except NotFound:
+0000c390: 5c6e 2020 2020 2020 2020 7374 7265 616d  \n        stream
+0000c3a0: 5f70 6f73 6974 696f 6e20 3d20 4e6f 6e65  _position = None
+0000c3b0: 5c6e 2020 2020 656c 7365 3a5c 6e20 2020  \n    else:\n   
+0000c3c0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0000c3d0: 736e 6170 7368 6f74 7329 203d 3d20 315c  snapshots) == 1\
+0000c3e0: 6e20 2020 2020 2020 2073 6e61 7073 686f  n        snapsho
+0000c3f0: 7420 3d20 736e 6170 7368 6f74 735b 305d  t = snapshots[0]
+0000c400: 5c6e 2020 2020 2020 2020 7374 7265 616d  \n        stream
+0000c410: 5f70 6f73 6974 696f 6e20 3d20 6465 7365  _position = dese
+0000c420: 7269 616c 697a 6528 736e 6170 7368 6f74  rialize(snapshot
+0000c430: 2e6d 6574 6164 6174 6129 5b5c 2776 6572  .metadata)[\'ver
+0000c440: 7369 6f6e 5c27 5d20 2b20 315c 6e20 2020  sion\'] + 1\n   
+0000c450: 2020 2020 2072 6563 6f72 6465 645f 6576       recorded_ev
+0000c460: 656e 7473 2e61 7070 656e 6428 736e 6170  ents.append(snap
+0000c470: 7368 6f74 295c 6e5c 6e20 2020 2023 2047  shot)\n\n    # G
+0000c480: 6574 2073 7562 7365 7175 656e 7420 6576  et subsequent ev
+0000c490: 656e 7473 2e5c 6e20 2020 2074 7279 3a5c  ents.\n    try:\
+0000c4a0: 6e20 2020 2020 2020 2065 7665 6e74 7320  n        events 
+0000c4b0: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
+0000c4c0: 7265 616d 5f65 7665 6e74 7328 5c6e 2020  ream_events(\n  
+0000c4d0: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000c4e0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000c4f0: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
+0000c500: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
+0000c510: 7374 7265 616d 5f70 6f73 6974 696f 6e5c  stream_position\
+0000c520: 6e20 2020 2020 2020 2029 5c6e 2020 2020  n        )\n    
+0000c530: 6578 6365 7074 204e 6f74 466f 756e 6420  except NotFound 
+0000c540: 6173 2065 3a5c 6e20 2020 2020 2020 2072  as e:\n        r
+0000c550: 6169 7365 2041 6767 7265 6761 7465 4e6f  aise AggregateNo
+0000c560: 7446 6f75 6e64 2861 6767 7265 6761 7465  tFound(aggregate
+0000c570: 5f69 6429 2066 726f 6d20 655c 6e20 2020  _id) from e\n   
+0000c580: 2065 6c73 653a 5c6e 2020 2020 2020 2020   else:\n        
+0000c590: 7265 636f 7264 6564 5f65 7665 6e74 7320  recorded_events 
+0000c5a0: 2b3d 2065 7665 6e74 735c 6e5c 6e20 2020  += events\n\n   
+0000c5b0: 2023 2052 6563 6f6e 7374 7275 6374 2061   # Reconstruct a
+0000c5c0: 6767 7265 6761 7465 2066 726f 6d20 7265  ggregate from re
+0000c5d0: 636f 7264 6564 2065 7665 6e74 732e 5c6e  corded events.\n
+0000c5e0: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
+0000c5f0: 4e6f 6e65 5c6e 2020 2020 666f 7220 6576  None\n    for ev
+0000c600: 656e 7420 696e 2072 6563 6f72 6465 645f  ent in recorded_
+0000c610: 6576 656e 7473 3a5c 6e20 2020 2020 2020  events:\n       
+0000c620: 2061 6767 7265 6761 7465 203d 206d 7574   aggregate = mut
+0000c630: 6174 6f72 5f66 756e 6328 6167 6772 6567  ator_func(aggreg
+0000c640: 6174 652c 2065 7665 6e74 295c 6e5c 6e20  ate, event)\n\n 
+0000c650: 2020 2072 6574 7572 6e20 6167 6772 6567     return aggreg
+0000c660: 6174 655c 6e5c 6e5c 6e64 6566 2073 6572  ate\n\n\ndef ser
+0000c670: 6961 6c69 7a65 2864 293a 5c6e 2020 2020  ialize(d):\n    
+0000c680: 7265 7475 726e 206a 736f 6e2e 6475 6d70  return json.dump
+0000c690: 7328 6429 2e65 6e63 6f64 6528 5c27 7574  s(d).encode(\'ut
+0000c6a0: 6638 5c27 295c 6e5c 6e5c 6e64 6566 2064  f8\')\n\n\ndef d
+0000c6b0: 6573 6572 6961 6c69 7a65 2873 293a 5c6e  eserialize(s):\n
+0000c6c0: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
+0000c6d0: 6c6f 6164 7328 732e 6465 636f 6465 285c  loads(s.decode(\
+0000c6e0: 2775 7466 385c 2729 295c 6e60 6060 5c6e  'utf8\'))\n```\n
+0000c6f0: 5c6e 546f 2073 686f 7720 686f 7720 6067  \nTo show how `g
+0000c700: 6574 5f61 6767 7265 6761 7465 2829 6020  et_aggregate()` 
+0000c710: 6361 6e20 6265 2075 7365 642c 206c 6574  can be used, let
+0000c720: 5c27 7320 6465 6669 6e65 2061 2060 446f  \'s define a `Do
+0000c730: 6760 2061 6767 7265 6761 7465 2063 6c61  g` aggregate cla
+0000c740: 7373 2c20 7769 7468 5c6e 6174 7472 6962  ss, with\nattrib
+0000c750: 7574 6573 2060 6e61 6d65 6020 616e 6420  utes `name` and 
+0000c760: 6074 7269 636b 7360 2e20 5468 6520 6174  `tricks`. The at
+0000c770: 7472 6962 7574 6573 2060 6964 6020 616e  tributes `id` an
+0000c780: 6420 6076 6572 7369 6f6e 6020 7769 6c6c  d `version` will
+0000c790: 2069 6e64 6963 6174 6520 616e 5c6e 6167   indicate an\nag
+0000c7a0: 6772 6567 6174 6520 6f62 6a65 6374 5c27  gregate object\'
+0000c7b0: 7320 4944 2061 6e64 2076 6572 7369 6f6e  s ID and version
+0000c7c0: 206e 756d 6265 722e 2054 6865 2061 7474   number. The att
+0000c7d0: 7269 6275 7465 2060 6973 5f66 726f 6d5f  ribute `is_from_
+0000c7e0: 736e 6170 7368 6f74 6020 6973 2061 6464  snapshot` is add
+0000c7f0: 6564 5c6e 6865 7265 206d 6572 656c 7920  ed\nhere merely 
+0000c800: 746f 2064 656d 6f6e 7374 7261 7465 2062  to demonstrate b
+0000c810: 656c 6f77 2077 6865 6e20 616e 2061 6767  elow when an agg
+0000c820: 7265 6761 7465 206f 626a 6563 7420 6861  regate object ha
+0000c830: 7320 6265 656e 2072 6563 6f6e 7374 7275  s been reconstru
+0000c840: 6374 6564 2075 7369 6e67 5c6e 6120 736e  cted using\na sn
+0000c850: 6170 7368 6f74 2e5c 6e5c 6e60 6060 7079  apshot.\n\n```py
+0000c860: 7468 6f6e 5c6e 6672 6f6d 2064 6174 6163  thon\nfrom datac
+0000c870: 6c61 7373 6573 2069 6d70 6f72 7420 6461  lasses import da
+0000c880: 7461 636c 6173 735c 6e5c 6e5c 6e40 6461  taclass\n\n\n@da
+0000c890: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
+0000c8a0: 7275 6529 5c6e 636c 6173 7320 4167 6772  rue)\nclass Aggr
+0000c8b0: 6567 6174 653a 5c6e 2020 2020 6964 3a20  egate:\n    id: 
+0000c8c0: 7374 725c 6e20 2020 2076 6572 7369 6f6e  str\n    version
+0000c8d0: 3a20 696e 745c 6e20 2020 2069 735f 6672  : int\n    is_fr
+0000c8e0: 6f6d 5f73 6e61 7073 686f 743a 2062 6f6f  om_snapshot: boo
+0000c8f0: 6c5c 6e5c 6e5c 6e40 6461 7461 636c 6173  l\n\n\n@dataclas
+0000c900: 7328 6672 6f7a 656e 3d54 7275 6529 5c6e  s(frozen=True)\n
+0000c910: 636c 6173 7320 446f 6728 4167 6772 6567  class Dog(Aggreg
+0000c920: 6174 6529 3a5c 6e20 2020 206e 616d 653a  ate):\n    name:
+0000c930: 2073 7472 5c6e 2020 2020 7472 6963 6b73   str\n    tricks
+0000c940: 3a20 6c69 7374 5c6e 6060 605c 6e5c 6e4c  : list\n```\n\nL
+0000c950: 6574 5c27 7320 616c 736f 2064 6566 696e  et\'s also defin
+0000c960: 6520 6120 6d75 7461 746f 7220 6675 6e63  e a mutator func
+0000c970: 7469 6f6e 2060 6d75 7461 7465 5f64 6f67  tion `mutate_dog
+0000c980: 2829 6020 7468 6174 2063 616e 2065 766f  ()` that can evo
+0000c990: 6c76 6520 7468 6520 7374 6174 6520 6f66  lve the state of
+0000c9a0: 2061 5c6e 6044 6f67 6020 6167 6772 6567   a\n`Dog` aggreg
+0000c9b0: 6174 6520 6769 7665 6e20 7661 7269 6f75  ate given variou
+0000c9c0: 7320 6469 6666 6572 656e 7420 7479 7065  s different type
+0000c9d0: 7320 6f66 2065 7665 6e74 732c 2060 5c27  s of events, `\'
+0000c9e0: 446f 6752 6567 6973 7465 7265 645c 2760  DogRegistered\'`
+0000c9f0: 2c5c 6e60 5c27 446f 674c 6561 726e 6564  ,\n`\'DogLearned
+0000ca00: 5472 6963 6b5c 2760 2c20 616e 6420 605c  Trick\'`, and `\
+0000ca10: 2753 6e61 7073 686f 745c 2760 2e5c 6e5c  'Snapshot\'`.\n\
+0000ca20: 6e60 6060 7079 7468 6f6e 5c6e 6465 6620  n```python\ndef 
+0000ca30: 6d75 7461 7465 5f64 6f67 2864 6f67 2c20  mutate_dog(dog, 
+0000ca40: 6576 656e 7429 3a5c 6e20 2020 2064 6174  event):\n    dat
+0000ca50: 6120 3d20 6465 7365 7269 616c 697a 6528  a = deserialize(
+0000ca60: 6576 656e 742e 6461 7461 295c 6e20 2020  event.data)\n   
+0000ca70: 2069 6620 6576 656e 742e 7479 7065 203d   if event.type =
+0000ca80: 3d20 5c27 446f 6752 6567 6973 7465 7265  = \'DogRegistere
+0000ca90: 645c 273a 5c6e 2020 2020 2020 2020 7265  d\':\n        re
+0000caa0: 7475 726e 2044 6f67 285c 6e20 2020 2020  turn Dog(\n     
+0000cab0: 2020 2020 2020 2069 643d 6576 656e 742e         id=event.
+0000cac0: 7374 7265 616d 5f6e 616d 652c 5c6e 2020  stream_name,\n  
+0000cad0: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+0000cae0: 6e3d 6576 656e 742e 7374 7265 616d 5f70  n=event.stream_p
+0000caf0: 6f73 6974 696f 6e2c 5c6e 2020 2020 2020  osition,\n      
+0000cb00: 2020 2020 2020 6973 5f66 726f 6d5f 736e        is_from_sn
+0000cb10: 6170 7368 6f74 3d46 616c 7365 2c5c 6e20  apshot=False,\n 
+0000cb20: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+0000cb30: 6461 7461 5b5c 276e 616d 655c 275d 2c5c  data[\'name\'],\
+0000cb40: 6e20 2020 2020 2020 2020 2020 2074 7269  n            tri
+0000cb50: 636b 733d 5b5d 2c5c 6e20 2020 2020 2020  cks=[],\n       
+0000cb60: 2029 5c6e 2020 2020 656c 6966 2065 7665   )\n    elif eve
+0000cb70: 6e74 2e74 7970 6520 3d3d 205c 2744 6f67  nt.type == \'Dog
+0000cb80: 4c65 6172 6e65 6454 7269 636b 5c27 3a5c  LearnedTrick\':\
+0000cb90: 6e20 2020 2020 2020 2061 7373 6572 7420  n        assert 
+0000cba0: 6576 656e 742e 7374 7265 616d 5f70 6f73  event.stream_pos
+0000cbb0: 6974 696f 6e20 3d3d 2064 6f67 2e76 6572  ition == dog.ver
+0000cbc0: 7369 6f6e 202b 2031 5c6e 2020 2020 2020  sion + 1\n      
+0000cbd0: 2020 6173 7365 7274 2065 7665 6e74 2e73    assert event.s
+0000cbe0: 7472 6561 6d5f 6e61 6d65 203d 3d20 646f  tream_name == do
+0000cbf0: 672e 6964 2c20 2865 7665 6e74 2e73 7472  g.id, (event.str
+0000cc00: 6561 6d5f 6e61 6d65 2c20 646f 672e 6964  eam_name, dog.id
+0000cc10: 295c 6e20 2020 2020 2020 2072 6574 7572  )\n        retur
+0000cc20: 6e20 446f 6728 5c6e 2020 2020 2020 2020  n Dog(\n        
+0000cc30: 2020 2020 6964 3d64 6f67 2e69 642c 5c6e      id=dog.id,\n
+0000cc40: 2020 2020 2020 2020 2020 2020 7665 7273              vers
+0000cc50: 696f 6e3d 6576 656e 742e 7374 7265 616d  ion=event.stream
+0000cc60: 5f70 6f73 6974 696f 6e2c 5c6e 2020 2020  _position,\n    
+0000cc70: 2020 2020 2020 2020 6973 5f66 726f 6d5f          is_from_
+0000cc80: 736e 6170 7368 6f74 3d64 6f67 2e69 735f  snapshot=dog.is_
+0000cc90: 6672 6f6d 5f73 6e61 7073 686f 742c 5c6e  from_snapshot,\n
+0000cca0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0000ccb0: 3d64 6f67 2e6e 616d 652c 5c6e 2020 2020  =dog.name,\n    
+0000ccc0: 2020 2020 2020 2020 7472 6963 6b73 3d64          tricks=d
+0000ccd0: 6f67 2e74 7269 636b 7320 2b20 5b64 6174  og.tricks + [dat
+0000cce0: 615b 5c27 7472 6963 6b5c 275d 5d2c 5c6e  a[\'trick\']],\n
+0000ccf0: 2020 2020 2020 2020 295c 6e20 2020 2065          )\n    e
+0000cd00: 6c69 6620 6576 656e 742e 7479 7065 203d  lif event.type =
+0000cd10: 3d20 5c27 536e 6170 7368 6f74 5c27 3a5c  = \'Snapshot\':\
+0000cd20: 6e20 2020 2020 2020 2072 6574 7572 6e20  n        return 
+0000cd30: 446f 6728 5c6e 2020 2020 2020 2020 2020  Dog(\n          
+0000cd40: 2020 6964 3d72 656d 6f76 655f 736e 6170    id=remove_snap
+0000cd50: 7368 6f74 5f73 7472 6561 6d5f 7072 6566  shot_stream_pref
+0000cd60: 6978 2865 7665 6e74 2e73 7472 6561 6d5f  ix(event.stream_
+0000cd70: 6e61 6d65 292c 5c6e 2020 2020 2020 2020  name),\n        
+0000cd80: 2020 2020 7665 7273 696f 6e3d 6465 7365      version=dese
+0000cd90: 7269 616c 697a 6528 6576 656e 742e 6d65  rialize(event.me
+0000cda0: 7461 6461 7461 295b 5c27 7665 7273 696f  tadata)[\'versio
+0000cdb0: 6e5c 275d 2c5c 6e20 2020 2020 2020 2020  n\'],\n         
+0000cdc0: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
+0000cdd0: 686f 743d 5472 7565 2c5c 6e20 2020 2020  hot=True,\n     
+0000cde0: 2020 2020 2020 206e 616d 653d 6461 7461         name=data
+0000cdf0: 5b5c 276e 616d 655c 275d 2c5c 6e20 2020  [\'name\'],\n   
+0000ce00: 2020 2020 2020 2020 2074 7269 636b 733d           tricks=
+0000ce10: 6461 7461 5b5c 2774 7269 636b 735c 275d  data[\'tricks\']
+0000ce20: 2c5c 6e20 2020 2020 2020 2029 5c6e 2020  ,\n        )\n  
+0000ce30: 2020 656c 7365 3a5c 6e20 2020 2020 2020    else:\n       
+0000ce40: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+0000ce50: 2866 2255 6e6b 6e6f 776e 2065 7665 6e74  (f"Unknown event
+0000ce60: 2074 7970 653a 207b 6576 656e 742e 7479   type: {event.ty
+0000ce70: 7065 7d22 295c 6e60 6060 5c6e 5c6e 466f  pe}")\n```\n\nFo
+0000ce80: 7220 636f 6e76 656e 6965 6e63 652c 206c  r convenience, l
+0000ce90: 6574 5c27 7320 616c 736f 2064 6566 696e  et\'s also defin
+0000cea0: 6520 6120 6067 6574 5f64 6f67 2829 6020  e a `get_dog()` 
+0000ceb0: 6675 6e63 7469 6f6e 2074 6861 7420 6361  function that ca
+0000cec0: 6c6c 7320 6067 6574 5f61 6767 7265 6761  lls `get_aggrega
+0000ced0: 7465 2829 605c 6e77 6974 6820 7468 6520  te()`\nwith the 
+0000cee0: 606d 7574 6174 655f 646f 6728 2960 2066  `mutate_dog()` f
+0000cef0: 756e 6374 696f 6e20 6173 2074 6865 2076  unction as the v
+0000cf00: 616c 7565 206f 6620 6974 7320 606d 7574  alue of its `mut
+0000cf10: 6174 6f72 5f66 756e 6360 2061 7267 756d  ator_func` argum
+0000cf20: 656e 742e 5c6e 5c6e 6060 6070 7974 686f  ent.\n\n```pytho
+0000cf30: 6e5c 6e64 6566 2067 6574 5f64 6f67 2864  n\ndef get_dog(d
+0000cf40: 6f67 5f69 6429 3a5c 6e20 2020 2072 6574  og_id):\n    ret
+0000cf50: 7572 6e20 6765 745f 6167 6772 6567 6174  urn get_aggregat
+0000cf60: 6528 5c6e 2020 2020 2020 2020 6167 6772  e(\n        aggr
+0000cf70: 6567 6174 655f 6964 3d64 6f67 5f69 642c  egate_id=dog_id,
+0000cf80: 5c6e 2020 2020 2020 2020 6d75 7461 746f  \n        mutato
+0000cf90: 725f 6675 6e63 3d6d 7574 6174 655f 646f  r_func=mutate_do
+0000cfa0: 672c 5c6e 2020 2020 295c 6e60 6060 5c6e  g,\n    )\n```\n
+0000cfb0: 5c6e 5765 2063 616e 2061 6c73 6f20 6465  \nWe can also de
+0000cfc0: 6669 6e65 2073 6f6d 6520 2263 6f6d 6d61  fine some "comma
+0000cfd0: 6e64 2220 6675 6e63 7469 6f6e 7320 7468  nd" functions th
+0000cfe0: 6174 2061 7070 656e 6420 6e65 7720 6576  at append new ev
+0000cff0: 656e 7473 2074 6f20 7468 655c 6e64 6174  ents to the\ndat
+0000d000: 6162 6173 652e 2054 6865 2060 7265 6769  abase. The `regi
+0000d010: 7374 6572 5f64 6f67 2829 6020 6675 6e63  ster_dog()` func
+0000d020: 7469 6f6e 2061 7070 656e 6473 2061 2060  tion appends a `
+0000d030: 446f 6752 6567 6973 7465 7265 6460 2065  DogRegistered` e
+0000d040: 7665 6e74 2e20 5468 655c 6e60 7265 636f  vent. The\n`reco
+0000d050: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
+0000d060: 2829 6020 6170 7065 6e64 7320 6120 6044  ()` appends a `D
+0000d070: 6f67 4c65 6172 6e65 6454 7269 636b 6020  ogLearnedTrick` 
+0000d080: 6576 656e 742e 2054 6865 2066 756e 6374  event. The funct
+0000d090: 696f 6e5c 6e60 736e 6170 7368 6f74 5f64  ion\n`snapshot_d
+0000d0a0: 6f67 2829 6020 6170 7065 6e64 7320 6120  og()` appends a 
+0000d0b0: 6053 6e61 7073 686f 7460 2065 7665 6e74  `Snapshot` event
+0000d0c0: 2e20 4e6f 7469 6365 2074 6861 7420 7468  . Notice that th
+0000d0d0: 655c 6e60 7265 636f 7264 5f74 7269 636b  e\n`record_trick
+0000d0e0: 5f6c 6561 726e 6564 2829 6020 616e 6420  _learned()` and 
+0000d0f0: 6073 6e61 7073 686f 745f 646f 6728 2960  `snapshot_dog()`
+0000d100: 2066 756e 6374 696f 6e73 2075 7365 2060   functions use `
+0000d110: 6765 745f 646f 6728 2960 2e5c 6e5c 6e4e  get_dog()`.\n\nN
+0000d120: 6f74 6963 6520 616c 736f 2074 6861 7420  otice also that 
+0000d130: 7468 6520 6044 6f67 5265 6769 7374 6572  the `DogRegister
+0000d140: 6564 6020 616e 6420 6044 6f67 4c65 6172  ed` and `DogLear
+0000d150: 6e65 6454 7269 636b 6020 6576 656e 7473  nedTrick` events
+0000d160: 2061 7265 2061 7070 656e 6465 6420 746f   are appended to
+0000d170: 2061 5c6e 7374 7265 616d 2066 6f72 2061   a\nstream for a
+0000d180: 6767 7265 6761 7465 2065 7665 6e74 732c  ggregate events,
+0000d190: 2077 6869 6c73 7420 7468 6520 6053 6e61   whilst the `Sna
+0000d1a0: 7073 686f 7460 2065 7665 6e74 2069 7320  pshot` event is 
+0000d1b0: 6170 7065 6e64 6564 2074 6f20 6120 7365  appended to a se
+0000d1c0: 7061 7261 7465 5c6e 7374 7265 616d 2066  parate\nstream f
+0000d1d0: 6f72 2061 6767 7265 6761 7465 2073 6e61  or aggregate sna
+0000d1e0: 7073 686f 7473 2e5c 6e5c 6e60 6060 7079  pshots.\n\n```py
+0000d1f0: 7468 6f6e 5c6e 6465 6620 7265 6769 7374  thon\ndef regist
+0000d200: 6572 5f64 6f67 286e 616d 6529 3a5c 6e20  er_dog(name):\n 
+0000d210: 2020 2064 6f67 5f69 6420 3d20 7374 7228     dog_id = str(
+0000d220: 7575 6964 2e75 7569 6434 2829 295c 6e20  uuid.uuid4())\n 
+0000d230: 2020 2065 7665 6e74 203d 204e 6577 4576     event = NewEv
+0000d240: 656e 7428 5c6e 2020 2020 2020 2020 7479  ent(\n        ty
+0000d250: 7065 3d5c 2744 6f67 5265 6769 7374 6572  pe=\'DogRegister
+0000d260: 6564 5c27 2c5c 6e20 2020 2020 2020 2064  ed\',\n        d
+0000d270: 6174 613d 7365 7269 616c 697a 6528 7b5c  ata=serialize({\
+0000d280: 276e 616d 655c 273a 206e 616d 657d 292c  'name\': name}),
+0000d290: 5c6e 2020 2020 295c 6e20 2020 2063 6c69  \n    )\n    cli
+0000d2a0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+0000d2b0: 285c 6e20 2020 2020 2020 2073 7472 6561  (\n        strea
+0000d2c0: 6d5f 6e61 6d65 3d64 6f67 5f69 642c 5c6e  m_name=dog_id,\n
+0000d2d0: 2020 2020 2020 2020 6375 7272 656e 745f          current_
+0000d2e0: 7665 7273 696f 6e3d 4e6f 6e65 2c5c 6e20  version=None,\n 
+0000d2f0: 2020 2020 2020 2065 7665 6e74 3d65 7665         event=eve
+0000d300: 6e74 2c5c 6e20 2020 2029 5c6e 2020 2020  nt,\n    )\n    
+0000d310: 7265 7475 726e 2064 6f67 5f69 645c 6e5c  return dog_id\n\
+0000d320: 6e5c 6e64 6566 2072 6563 6f72 645f 7472  n\ndef record_tr
+0000d330: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
+0000d340: 6964 2c20 7472 6963 6b29 3a5c 6e20 2020  id, trick):\n   
+0000d350: 2064 6f67 203d 2067 6574 5f64 6f67 2864   dog = get_dog(d
+0000d360: 6f67 5f69 6429 5c6e 2020 2020 6576 656e  og_id)\n    even
+0000d370: 7420 3d20 4e65 7745 7665 6e74 285c 6e20  t = NewEvent(\n 
+0000d380: 2020 2020 2020 2074 7970 653d 5c27 446f         type=\'Do
+0000d390: 674c 6561 726e 6564 5472 6963 6b5c 272c  gLearnedTrick\',
+0000d3a0: 5c6e 2020 2020 2020 2020 6461 7461 3d73  \n        data=s
+0000d3b0: 6572 6961 6c69 7a65 287b 5c27 7472 6963  erialize({\'tric
+0000d3c0: 6b5c 273a 2074 7269 636b 7d29 2c5c 6e20  k\': trick}),\n 
+0000d3d0: 2020 2029 5c6e 2020 2020 636c 6965 6e74     )\n    client
+0000d3e0: 2e61 7070 656e 645f 6576 656e 7428 5c6e  .append_event(\n
+0000d3f0: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+0000d400: 616d 653d 646f 675f 6964 2c5c 6e20 2020  ame=dog_id,\n   
+0000d410: 2020 2020 2063 7572 7265 6e74 5f76 6572       current_ver
+0000d420: 7369 6f6e 3d64 6f67 2e76 6572 7369 6f6e  sion=dog.version
+0000d430: 2c5c 6e20 2020 2020 2020 2065 7665 6e74  ,\n        event
+0000d440: 3d65 7665 6e74 2c5c 6e20 2020 2029 5c6e  =event,\n    )\n
+0000d450: 5c6e 5c6e 6465 6620 736e 6170 7368 6f74  \n\ndef snapshot
+0000d460: 5f64 6f67 2864 6f67 5f69 6429 3a5c 6e20  _dog(dog_id):\n 
+0000d470: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
+0000d480: 2864 6f67 5f69 6429 5c6e 2020 2020 6576  (dog_id)\n    ev
+0000d490: 656e 7420 3d20 4e65 7745 7665 6e74 285c  ent = NewEvent(\
+0000d4a0: 6e20 2020 2020 2020 2074 7970 653d 5c27  n        type=\'
+0000d4b0: 536e 6170 7368 6f74 5c27 2c5c 6e20 2020  Snapshot\',\n   
+0000d4c0: 2020 2020 2064 6174 613d 7365 7269 616c       data=serial
+0000d4d0: 697a 6528 7b5c 276e 616d 655c 273a 2064  ize({\'name\': d
+0000d4e0: 6f67 2e6e 616d 652c 205c 2774 7269 636b  og.name, \'trick
+0000d4f0: 735c 273a 2064 6f67 2e74 7269 636b 737d  s\': dog.tricks}
+0000d500: 292c 5c6e 2020 2020 2020 2020 6d65 7461  ),\n        meta
+0000d510: 6461 7461 3d73 6572 6961 6c69 7a65 287b  data=serialize({
+0000d520: 5c27 7665 7273 696f 6e5c 273a 2064 6f67  \'version\': dog
+0000d530: 2e76 6572 7369 6f6e 7d29 2c5c 6e20 2020  .version}),\n   
+0000d540: 2029 5c6e 2020 2020 636c 6965 6e74 2e61   )\n    client.a
+0000d550: 7070 656e 645f 6576 656e 7428 5c6e 2020  ppend_event(\n  
+0000d560: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+0000d570: 653d 6d61 6b65 5f73 6e61 7073 686f 745f  e=make_snapshot_
+0000d580: 7374 7265 616d 5f6e 616d 6528 646f 675f  stream_name(dog_
+0000d590: 6964 292c 5c6e 2020 2020 2020 2020 6375  id),\n        cu
+0000d5a0: 7272 656e 745f 7665 7273 696f 6e3d 2d31  rrent_version=-1
+0000d5b0: 2c5c 6e20 2020 2020 2020 2065 7665 6e74  ,\n        event
+0000d5c0: 3d65 7665 6e74 2c5c 6e20 2020 2029 5c6e  =event,\n    )\n
+0000d5d0: 6060 605c 6e5c 6e57 6520 6361 6e20 6361  ```\n\nWe can ca
+0000d5e0: 6c6c 2060 7265 6769 7374 6572 5f64 6f67  ll `register_dog
+0000d5f0: 2829 6020 746f 2072 6567 6973 7465 7220  ()` to register 
+0000d600: 6120 6e65 7720 646f 672e 5c6e 5c6e 6060  a new dog.\n\n``
+0000d610: 6070 7974 686f 6e5c 6e23 2052 6567 6973  `python\n# Regis
+0000d620: 7465 7220 6120 6e65 7720 646f 672e 5c6e  ter a new dog.\n
+0000d630: 646f 675f 6964 203d 2072 6567 6973 7465  dog_id = registe
+0000d640: 725f 646f 6728 5c27 4669 646f 5c27 295c  r_dog(\'Fido\')\
+0000d650: 6e5c 6e64 6f67 203d 2067 6574 5f64 6f67  n\ndog = get_dog
+0000d660: 2864 6f67 5f69 6429 5c6e 6173 7365 7274  (dog_id)\nassert
+0000d670: 2064 6f67 2e6e 616d 6520 3d3d 205c 2746   dog.name == \'F
+0000d680: 6964 6f5c 275c 6e61 7373 6572 7420 646f  ido\'\nassert do
+0000d690: 672e 7472 6963 6b73 203d 3d20 5b5d 5c6e  g.tricks == []\n
+0000d6a0: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+0000d6b0: 6f6e 203d 3d20 305c 6e61 7373 6572 7420  on == 0\nassert 
+0000d6c0: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
+0000d6d0: 7368 6f74 2069 7320 4661 6c73 655c 6e5c  shot is False\n\
+0000d6e0: 6e60 6060 5c6e 5c6e 5765 2063 616e 2063  n```\n\nWe can c
+0000d6f0: 616c 6c20 6072 6563 6f72 645f 7472 6963  all `record_tric
+0000d700: 6b5f 6c65 6172 6e65 6428 2960 2074 6f20  k_learned()` to 
+0000d710: 7265 636f 7264 2074 6861 7420 736f 6d65  record that some
+0000d720: 2074 7269 636b 7320 6861 7665 2062 6565   tricks have bee
+0000d730: 6e20 6c65 6172 6e65 642e 5c6e 5c6e 6060  n learned.\n\n``
+0000d740: 6070 7974 686f 6e5c 6e5c 6e23 2052 6563  `python\n\n# Rec
+0000d750: 6f72 6420 7468 6174 205c 2746 6964 6f5c  ord that \'Fido\
+0000d760: 2720 6c65 6172 6e65 6420 6120 6e65 7720  ' learned a new 
+0000d770: 7472 6963 6b2e 5c6e 7265 636f 7264 5f74  trick.\nrecord_t
+0000d780: 7269 636b 5f6c 6561 726e 6564 2864 6f67  rick_learned(dog
+0000d790: 5f69 642c 2074 7269 636b 3d5c 2772 6f6c  _id, trick=\'rol
+0000d7a0: 6c20 6f76 6572 5c27 295c 6e5c 6e64 6f67  l over\')\n\ndog
+0000d7b0: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
+0000d7c0: 6429 5c6e 6173 7365 7274 2064 6f67 2e6e  d)\nassert dog.n
+0000d7d0: 616d 6520 3d3d 205c 2746 6964 6f5c 275c  ame == \'Fido\'\
+0000d7e0: 6e61 7373 6572 7420 646f 672e 7472 6963  nassert dog.tric
+0000d7f0: 6b73 203d 3d20 5b5c 2772 6f6c 6c20 6f76  ks == [\'roll ov
+0000d800: 6572 5c27 5d5c 6e61 7373 6572 7420 646f  er\']\nassert do
+0000d810: 672e 7665 7273 696f 6e20 3d3d 2031 5c6e  g.version == 1\n
+0000d820: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
+0000d830: 6f6d 5f73 6e61 7073 686f 7420 6973 2046  om_snapshot is F
+0000d840: 616c 7365 5c6e 5c6e 5c6e 2320 5265 636f  alse\n\n\n# Reco
+0000d850: 7264 2074 6861 7420 5c27 4669 646f 5c27  rd that \'Fido\'
+0000d860: 206c 6561 726e 6564 2061 6e6f 7468 6572   learned another
+0000d870: 206e 6577 2074 7269 636b 2e5c 6e72 6563   new trick.\nrec
+0000d880: 6f72 645f 7472 6963 6b5f 6c65 6172 6e65  ord_trick_learne
+0000d890: 6428 646f 675f 6964 2c20 7472 6963 6b3d  d(dog_id, trick=
+0000d8a0: 5c27 6665 7463 6820 6261 6c6c 5c27 295c  \'fetch ball\')\
+0000d8b0: 6e5c 6e64 6f67 203d 2067 6574 5f64 6f67  n\ndog = get_dog
+0000d8c0: 2864 6f67 5f69 6429 5c6e 6173 7365 7274  (dog_id)\nassert
+0000d8d0: 2064 6f67 2e6e 616d 6520 3d3d 205c 2746   dog.name == \'F
+0000d8e0: 6964 6f5c 275c 6e61 7373 6572 7420 646f  ido\'\nassert do
+0000d8f0: 672e 7472 6963 6b73 203d 3d20 5b5c 2772  g.tricks == [\'r
+0000d900: 6f6c 6c20 6f76 6572 5c27 2c20 5c27 6665  oll over\', \'fe
+0000d910: 7463 6820 6261 6c6c 5c27 5d5c 6e61 7373  tch ball\']\nass
+0000d920: 6572 7420 646f 672e 7665 7273 696f 6e20  ert dog.version 
+0000d930: 3d3d 2032 5c6e 6173 7365 7274 2064 6f67  == 2\nassert dog
+0000d940: 2e69 735f 6672 6f6d 5f73 6e61 7073 686f  .is_from_snapsho
+0000d950: 7420 6973 2046 616c 7365 5c6e 6060 605c  t is False\n```\
+0000d960: 6e5c 6e57 6520 6361 6e20 6361 6c6c 2060  n\nWe can call `
+0000d970: 736e 6170 7368 6f74 5f64 6f67 2829 6020  snapshot_dog()` 
+0000d980: 746f 2072 6563 6f72 6420 6120 736e 6170  to record a snap
+0000d990: 7368 6f74 206f 6620 7468 6520 6375 7272  shot of the curr
+0000d9a0: 656e 7420 7374 6174 6520 6f66 2074 6865  ent state of the
+0000d9b0: 2060 446f 6760 5c6e 6167 6772 6567 6174   `Dog`\naggregat
+0000d9c0: 652e 2041 6674 6572 2077 6520 6361 6c6c  e. After we call
+0000d9d0: 2060 736e 6170 7368 6f74 5f64 6f67 2829   `snapshot_dog()
+0000d9e0: 602c 2074 6865 2060 6765 745f 646f 6728  `, the `get_dog(
+0000d9f0: 2960 2066 756e 6374 696f 6e20 7769 6c6c  )` function will
+0000da00: 2072 6574 7572 6e20 6120 6044 6f67 605c   return a `Dog`\
+0000da10: 6e6f 626a 6563 7420 7468 6174 2068 6173  nobject that has
+0000da20: 2062 6565 6e20 636f 6e73 7472 7563 7465   been constructe
+0000da30: 6420 7573 696e 6720 7468 6520 6053 6e61  d using the `Sna
+0000da40: 7073 686f 7460 2065 7665 6e74 2e5c 6e5c  pshot` event.\n\
+0000da50: 6e60 6060 7079 7468 6f6e 5c6e 2320 536e  n```python\n# Sn
+0000da60: 6170 7368 6f74 205c 2746 6964 6f5c 272e  apshot \'Fido\'.
+0000da70: 5c6e 736e 6170 7368 6f74 5f64 6f67 2864  \nsnapshot_dog(d
+0000da80: 6f67 5f69 6429 5c6e 5c6e 646f 6720 3d20  og_id)\n\ndog = 
+0000da90: 6765 745f 646f 6728 646f 675f 6964 295c  get_dog(dog_id)\
+0000daa0: 6e61 7373 6572 7420 646f 672e 6e61 6d65  nassert dog.name
+0000dab0: 203d 3d20 5c27 4669 646f 5c27 5c6e 6173   == \'Fido\'\nas
+0000dac0: 7365 7274 2064 6f67 2e74 7269 636b 7320  sert dog.tricks 
+0000dad0: 3d3d 205b 5c27 726f 6c6c 206f 7665 725c  == [\'roll over\
+0000dae0: 272c 205c 2766 6574 6368 2062 616c 6c5c  ', \'fetch ball\
+0000daf0: 275d 5c6e 6173 7365 7274 2064 6f67 2e76  ']\nassert dog.v
+0000db00: 6572 7369 6f6e 203d 3d20 325c 6e61 7373  ersion == 2\nass
+0000db10: 6572 7420 646f 672e 6973 5f66 726f 6d5f  ert dog.is_from_
+0000db20: 736e 6170 7368 6f74 2069 7320 5472 7565  snapshot is True
+0000db30: 5c6e 6060 605c 6e5c 6e57 6520 6361 6e20  \n```\n\nWe can 
+0000db40: 636f 6e74 696e 7565 2074 6f20 6576 6f6c  continue to evol
+0000db50: 7665 2074 6865 2073 7461 7465 206f 6620  ve the state of 
+0000db60: 7468 6520 6044 6f67 6020 6167 6772 6567  the `Dog` aggreg
+0000db70: 6174 652c 2075 7369 6e67 5c6e 7468 6520  ate, using\nthe 
+0000db80: 736e 6170 7368 6f74 2062 6f74 6820 6475  snapshot both du
+0000db90: 7269 6e67 2074 6865 2063 616c 6c20 746f  ring the call to
+0000dba0: 2060 7265 636f 7264 5f74 7269 636b 5f6c   `record_trick_l
+0000dbb0: 6561 726e 6564 2829 6020 616e 645c 6e77  earned()` and\nw
+0000dbc0: 6865 6e20 6361 6c6c 696e 6720 6067 6574  hen calling `get
+0000dbd0: 5f64 6f67 2829 6020 6469 7265 6374 6c79  _dog()` directly
+0000dbe0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+0000dbf0: 7265 636f 7264 5f74 7269 636b 5f6c 6561  record_trick_lea
+0000dc00: 726e 6564 2864 6f67 5f69 642c 2074 7269  rned(dog_id, tri
+0000dc10: 636b 3d5c 2773 6974 5c27 295c 6e5c 6e64  ck=\'sit\')\n\nd
+0000dc20: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
+0000dc30: 5f69 6429 5c6e 6173 7365 7274 2064 6f67  _id)\nassert dog
+0000dc40: 2e6e 616d 6520 3d3d 205c 2746 6964 6f5c  .name == \'Fido\
+0000dc50: 275c 6e61 7373 6572 7420 646f 672e 7472  '\nassert dog.tr
+0000dc60: 6963 6b73 203d 3d20 5b5c 2772 6f6c 6c20  icks == [\'roll 
+0000dc70: 6f76 6572 5c27 2c20 5c27 6665 7463 6820  over\', \'fetch 
+0000dc80: 6261 6c6c 5c27 2c20 5c27 7369 745c 275d  ball\', \'sit\']
+0000dc90: 5c6e 6173 7365 7274 2064 6f67 2e76 6572  \nassert dog.ver
+0000dca0: 7369 6f6e 203d 3d20 335c 6e61 7373 6572  sion == 3\nasser
+0000dcb0: 7420 646f 672e 6973 5f66 726f 6d5f 736e  t dog.is_from_sn
+0000dcc0: 6170 7368 6f74 2069 7320 5472 7565 5c6e  apshot is True\n
+0000dcd0: 6060 605c 6e5c 6e57 6520 6361 6e20 7365  ```\n\nWe can se
+0000dce0: 6520 6672 6f6d 2074 6865 2060 6973 5f66  e from the `is_f
+0000dcf0: 726f 6d5f 736e 6170 7368 6f74 6020 6174  rom_snapshot` at
+0000dd00: 7472 6962 7574 6520 7468 6174 2074 6865  tribute that the
+0000dd10: 2060 446f 6760 206f 626a 6563 7420 7761   `Dog` object wa
+0000dd20: 7320 696e 6465 6564 5c6e 7265 636f 6e73  s indeed\nrecons
+0000dd30: 7472 7563 7465 6420 6672 6f6d 2074 6865  tructed from the
+0000dd40: 2073 6e61 7073 686f 742e 5c6e 5c6e 536e   snapshot.\n\nSn
+0000dd50: 6170 7368 6f74 7320 6361 6e20 6265 2063  apshots can be c
+0000dd60: 7265 6174 6564 2061 7420 6669 7865 6420  reated at fixed 
+0000dd70: 7665 7273 696f 6e20 6e75 6d62 6572 2069  version number i
+0000dd80: 6e74 6572 7661 6c73 2c20 6669 7865 6420  ntervals, fixed 
+0000dd90: 7469 6d65 5c6e 7065 7269 6f64 732c 2061  time\nperiods, a
+0000dda0: 6674 6572 2061 2070 6172 7469 6375 6c61  fter a particula
+0000ddb0: 7220 7479 7065 206f 6620 6576 656e 742c  r type of event,
+0000ddc0: 2069 6d6d 6564 6961 7465 6c79 2061 6674   immediately aft
+0000ddd0: 6572 2065 7665 6e74 7320 6172 655c 6e61  er events are\na
+0000dde0: 7070 656e 6465 642c 206f 7220 6173 2061  ppended, or as a
+0000ddf0: 2062 6163 6b67 726f 756e 6420 7072 6f63   background proc
+0000de00: 6573 732e 5c6e 5c6e 5c6e 2323 2320 5265  ess.\n\n\n### Re
+0000de10: 6164 2061 6c6c 2065 7665 6e74 735c 6e5c  ad all events\n\
+0000de20: 6e54 6865 2060 7265 6164 5f61 6c6c 5f65  nThe `read_all_e
+0000de30: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
+0000de40: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
+0000de50: 6574 2061 6c6c 2072 6563 6f72 6465 6420  et all recorded 
+0000de60: 6576 656e 7473 5c6e 696e 2074 6865 2064  events\nin the d
+0000de70: 6174 6162 6173 6520 696e 2074 6865 206f  atabase in the o
+0000de80: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
+0000de90: 6563 6f72 6465 642e 2054 6869 7320 6d65  ecorded. This me
+0000dea0: 7468 6f64 2077 696c 6c20 7265 7475 726e  thod will return
+0000deb0: 5c6e 6120 2272 6561 6420 7265 7370 6f6e  \na "read respon
+0000dec0: 7365 2220 6f62 6a65 6374 2c20 6a75 7374  se" object, just
+0000ded0: 206c 696b 6520 6069 7465 725f 7374 7265   like `iter_stre
+0000dee0: 616d 5f65 7665 6e74 7328 2960 2e5c 6e5c  am_events()`.\n\
+0000def0: 6e41 2022 7265 6164 2072 6573 706f 6e73  nA "read respons
+0000df00: 6522 2069 7320 616e 2069 7465 7261 746f  e" is an iterato
+0000df10: 722c 2061 6e64 206e 6f74 2061 2073 6571  r, and not a seq
+0000df20: 7565 6e63 652e 2052 6563 6f72 6465 6420  uence. Recorded 
+0000df30: 6576 656e 7473 2063 616e 2062 655c 6e6f  events can be\no
+0000df40: 6274 6169 6e65 6420 6279 2069 7465 7261  btained by itera
+0000df50: 7469 6e67 206f 7665 7220 7468 6520 2272  ting over the "r
+0000df60: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
+0000df70: 6a65 6374 2e20 4974 2073 7472 6561 6d73  ject. It streams
+0000df80: 2072 6563 6f72 6465 645c 6e65 7665 6e74   recorded\nevent
+0000df90: 7320 6672 6f6d 2074 6865 2073 6572 7665  s from the serve
+0000dfa0: 7220 6173 2074 6865 2069 7465 7261 7469  r as the iterati
+0000dfb0: 6f6e 2070 726f 6365 6564 732e 2054 6865  on proceeds. The
+0000dfc0: 2069 7465 7261 7469 6f6e 2077 696c 6c20   iteration will 
+0000dfd0: 6175 746f 6d61 7469 6361 6c6c 795c 6e73  automatically\ns
+0000dfe0: 746f 7020 7768 656e 2074 6865 7265 2061  top when there a
+0000dff0: 7265 206e 6f20 6d6f 7265 2072 6563 6f72  re no more recor
+0000e000: 6465 6420 6576 656e 7473 2074 6f20 6265  ded events to be
+0000e010: 2072 6574 7572 6e65 642e 2054 6865 2073   returned. The s
+0000e020: 7472 6561 6d69 6e67 206f 6620 6576 656e  treaming of even
+0000e030: 7473 2c5c 6e61 6e64 2068 656e 6365 2074  ts,\nand hence t
+0000e040: 6865 2069 7465 7261 746f 722c 2063 616e  he iterator, can
+0000e050: 2061 6c73 6f20 6265 2073 746f 7070 6564   also be stopped
+0000e060: 2062 7920 6361 6c6c 696e 6720 7468 6520   by calling the 
+0000e070: 6073 746f 7028 2960 206d 6574 686f 6420  `stop()` method 
+0000e080: 6f6e 2074 6865 5c6e 2272 6561 6420 7265  on the\n"read re
+0000e090: 7370 6f6e 7365 2220 6f62 6a65 6374 2e5c  sponse" object.\
+0000e0a0: 6e5c 6e4a 7573 7420 6c69 6b65 2060 7265  n\nJust like `re
+0000e0b0: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+0000e0c0: 2829 6020 616e 6420 6069 7465 725f 7374  ()` and `iter_st
+0000e0d0: 7265 616d 5f65 7665 6e74 7328 2960 2c20  ream_events()`, 
+0000e0e0: 7468 6520 7265 6365 6976 6564 2065 7665  the received eve
+0000e0f0: 6e74 206f 626a 6563 7473 5c6e 6172 6520  nt objects\nare 
+0000e100: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+0000e110: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+0000e120: 2063 6c61 7373 2e5c 6e5c 6e54 6869 7320   class.\n\nThis 
+0000e130: 6d65 7468 6f64 2068 6173 2073 6576 656e  method has seven
+0000e140: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000e150: 6e74 732c 2060 636f 6d6d 6974 5f70 6f73  nts, `commit_pos
+0000e160: 6974 696f 6e60 2c20 6062 6163 6b77 6172  ition`, `backwar
+0000e170: 6473 602c 5c6e 6066 696c 7465 725f 6578  ds`,\n`filter_ex
+0000e180: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
+0000e190: 696e 636c 7564 6560 2c20 6066 696c 7465  include`, `filte
+0000e1a0: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
+0000e1b0: 602c 2060 6c69 6d69 7460 2c20 616e 6420  `, `limit`, and 
+0000e1c0: 6074 696d 656f 7574 602e 5c6e 5c6e 5468  `timeout`.\n\nTh
+0000e1d0: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
+0000e1e0: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
+0000e1f0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0000e200: 6e20 6069 6e74 6020 7468 6174 2063 616e  n `int` that can
+0000e210: 2062 6520 7573 6564 2074 6f5c 6e73 7065   be used to\nspe
+0000e220: 6369 6679 2061 2063 6f6d 6d69 7420 706f  cify a commit po
+0000e230: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
+0000e240: 6820 746f 2073 7461 7274 2072 6561 6469  h to start readi
+0000e250: 6e67 2e20 5468 6520 6465 6661 756c 7420  ng. The default 
+0000e260: 7661 6c75 6520 6f66 5c6e 6063 6f6d 6d69  value of\n`commi
+0000e270: 745f 706f 7369 7469 6f6e 6020 6973 2060  t_position` is `
+0000e280: 4e6f 6e65 602e 2050 6c65 6173 6520 6e6f  None`. Please no
+0000e290: 7465 2c20 6966 2061 2063 6f6d 6d69 7420  te, if a commit 
+0000e2a0: 706f 7369 7469 6f6e 2069 7320 7370 6563  position is spec
+0000e2b0: 6966 6965 642c 5c6e 6974 206d 7573 7420  ified,\nit must 
+0000e2c0: 6265 2061 6e20 6163 7475 616c 6c79 2065  be an actually e
+0000e2d0: 7869 7374 696e 6720 636f 6d6d 6974 2070  xisting commit p
+0000e2e0: 6f73 6974 696f 6e20 696e 2074 6865 2064  osition in the d
+0000e2f0: 6174 6162 6173 652e 5c6e 5c6e 5468 6520  atabase.\n\nThe 
+0000e300: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
+0000e310: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
+0000e320: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0000e330: 2e20 5468 6520 6465 6661 756c 7420 6f66  . The default of
+0000e340: 2060 6261 636b 7761 7264 7360 2069 735c   `backwards` is\
+0000e350: 6e60 4661 6c73 6560 2c20 7768 6963 6820  n`False`, which 
+0000e360: 6d65 616e 7320 6576 656e 7473 2061 7265  means events are
+0000e370: 2072 6574 7572 6e65 6420 696e 2074 6865   returned in the
+0000e380: 206f 7264 6572 2074 6865 7920 7765 7265   order they were
+0000e390: 2072 6563 6f72 6465 642c 2049 665c 6e60   recorded, If\n`
+0000e3a0: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
+0000e3b0: 7275 6560 2c20 7468 656e 2065 7665 6e74  rue`, then event
+0000e3c0: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
+0000e3d0: 6e20 7265 7665 7273 6520 6f72 6465 722e  n reverse order.
+0000e3e0: 5c6e 5c6e 4966 2060 6261 636b 7761 7264  \n\nIf `backward
+0000e3f0: 7360 2069 7320 6046 616c 7365 6020 616e  s` is `False` an
+0000e400: 6420 6063 6f6d 6d69 745f 706f 7369 7469  d `commit_positi
+0000e410: 6f6e 6020 6973 2060 4e6f 6e65 602c 2074  on` is `None`, t
+0000e420: 6865 2064 6174 6162 6173 655c 2773 2065  he database\'s e
+0000e430: 7665 6e74 7320 7769 6c6c 5c6e 6265 2072  vents will\nbe r
+0000e440: 6574 7572 6e65 6420 696e 2074 6865 206f  eturned in the o
+0000e450: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
+0000e460: 6563 6f72 6465 642c 2073 7461 7274 696e  ecorded, startin
+0000e470: 6720 6672 6f6d 2074 6865 2066 6972 7374  g from the first
+0000e480: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+0000e490: 5c6e 5468 6973 2069 7320 7468 6520 6465  \nThis is the de
+0000e4a0: 6661 756c 7420 6265 6861 7669 6f72 206f  fault behavior o
+0000e4b0: 6620 6072 6561 645f 616c 6c5f 6576 656e  f `read_all_even
+0000e4c0: 7473 2829 602e 2049 6620 6062 6163 6b77  ts()`. If `backw
+0000e4d0: 6172 6473 6020 6973 2060 5472 7565 6020  ards` is `True` 
+0000e4e0: 616e 645c 6e60 636f 6d6d 6974 5f70 6f73  and\n`commit_pos
+0000e4f0: 6974 696f 6e60 2069 7320 604e 6f6e 6560  ition` is `None`
+0000e500: 2c20 7468 6520 6461 7461 6261 7365 5c27  , the database\'
+0000e510: 7320 6576 656e 7473 2077 696c 6c20 6265  s events will be
+0000e520: 2072 6574 7572 6e65 6420 696e 2072 6576   returned in rev
+0000e530: 6572 7365 206f 7264 6572 2c5c 6e73 7461  erse order,\nsta
+0000e540: 7274 696e 6720 6672 6f6d 2074 6865 206c  rting from the l
+0000e550: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+0000e560: 6e74 2e5c 6e5c 6e54 6865 206f 7074 696f  nt.\n\nThe optio
+0000e570: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
+0000e580: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
+0000e590: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+0000e5a0: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+0000e5b0: 6e73 2074 6861 745c 6e73 7065 6369 6669  ns that\nspecifi
+0000e5c0: 6573 2077 6869 6368 2072 6563 6f72 6465  es which recorde
+0000e5d0: 6420 6576 656e 7473 2073 686f 756c 6420  d events should 
+0000e5e0: 6265 2072 6574 7572 6e65 642e 2054 6869  be returned. Thi
+0000e5f0: 7320 6172 6775 6d65 6e74 2069 7320 6967  s argument is ig
+0000e600: 6e6f 7265 645c 6e69 6620 6066 696c 7465  nored\nif `filte
+0000e610: 725f 696e 636c 7564 6560 2069 7320 7365  r_include` is se
+0000e620: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
+0000e630: 2073 6571 7565 6e63 652e 2054 6865 2064   sequence. The d
+0000e640: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0000e650: 7468 6973 5c6e 6172 6775 6d65 6e74 206d  this\nargument m
+0000e660: 6174 6368 6573 2074 6865 2065 7665 6e74  atches the event
+0000e670: 2074 7970 6573 206f 6620 4576 656e 7453   types of EventS
+0000e680: 746f 7265 4442 2022 7379 7374 656d 2065  toreDB "system e
+0000e690: 7665 6e74 7322 2c20 736f 2074 6861 7420  vents", so that 
+0000e6a0: 7379 7374 656d 5c6e 6576 656e 7473 2077  system\nevents w
+0000e6b0: 696c 6c20 6e6f 7420 6e6f 726d 616c 6c79  ill not normally
+0000e6c0: 2062 6520 696e 636c 7564 6564 2e20 5365   be included. Se
+0000e6d0: 6520 7468 6520 4e6f 7465 7320 7365 6374  e the Notes sect
+0000e6e0: 696f 6e20 6265 6c6f 7720 666f 7220 6d6f  ion below for mo
+0000e6f0: 7265 5c6e 696e 666f 726d 6174 696f 6e20  re\ninformation 
+0000e700: 6162 6f75 7420 6669 6c74 6572 2065 7870  about filter exp
+0000e710: 7265 7373 696f 6e73 2e5c 6e5c 6e54 6865  ressions.\n\nThe
+0000e720: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
+0000e730: 725f 696e 636c 7564 6560 2061 7267 756d  r_include` argum
+0000e740: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
+0000e750: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
+0000e760: 7265 7373 696f 6e73 5c6e 7468 6174 2073  ressions\nthat s
+0000e770: 7065 6369 6669 6573 2077 6869 6368 2072  pecifies which r
+0000e780: 6563 6f72 6465 6420 6576 656e 7473 2073  ecorded events s
+0000e790: 686f 756c 6420 6265 2072 6574 7572 6e65  hould be returne
+0000e7a0: 642e 2042 7920 6465 6661 756c 742c 2074  d. By default, t
+0000e7b0: 6869 735c 6e61 7267 756d 656e 7420 6973  his\nargument is
+0000e7c0: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
+0000e7d0: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
+0000e7e0: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
+0000e7f0: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
+0000e800: 2c5c 6e74 6865 2060 6669 6c74 6572 5f65  ,\nthe `filter_e
+0000e810: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+0000e820: 2069 7320 6967 6e6f 7265 642e 5c6e 5c6e   is ignored.\n\n
+0000e830: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
+0000e840: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
+0000e850: 616d 6560 2061 7267 756d 656e 7420 6973  ame` argument is
+0000e860: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0000e870: 2074 6861 7420 696e 6469 6361 7465 735c   that indicates\
+0000e880: 6e77 6865 7468 6572 2074 6865 2066 696c  nwhether the fil
+0000e890: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
+0000e8a0: 7920 746f 2065 7665 6e74 2074 7970 6573  y to event types
+0000e8b0: 206f 7220 7374 7265 616d 206e 616d 6573   or stream names
+0000e8c0: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+0000e8d0: 6973 5c6e 7661 6c75 6520 6973 2060 4661  is\nvalue is `Fa
+0000e8e0: 6c73 6560 2061 6e64 2073 6f20 7468 6520  lse` and so the 
+0000e8f0: 6669 6c74 6572 696e 6720 7769 6c6c 2061  filtering will a
+0000e900: 7070 6c79 2074 6f20 7468 6520 6576 656e  pply to the even
+0000e910: 7420 7479 7065 2073 7472 696e 6773 206f  t type strings o
+0000e920: 665c 6e72 6563 6f72 6465 6420 6576 656e  f\nrecorded even
+0000e930: 7473 2e5c 6e5c 6e54 6865 206f 7074 696f  ts.\n\nThe optio
+0000e940: 6e61 6c20 606c 696d 6974 6020 6172 6775  nal `limit` argu
+0000e950: 6d65 6e74 2069 7320 616e 2069 6e74 6567  ment is an integ
+0000e960: 6572 2077 6869 6368 2072 6573 7472 6963  er which restric
+0000e970: 7473 2074 6865 206e 756d 6265 7220 6f66  ts the number of
+0000e980: 2065 7665 6e74 7320 7468 6174 5c6e 7769   events that\nwi
+0000e990: 6c6c 2062 6520 7265 7475 726e 6564 2e20  ll be returned. 
+0000e9a0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0000e9b0: 6520 6973 2060 7379 732e 6d61 7869 6e74  e is `sys.maxint
+0000e9c0: 602e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  `.\n\nThe option
+0000e9d0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0000e9e0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0000e9f0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+0000ea00: 7365 7473 2061 5c6e 6465 6164 6c69 6e65  sets a\ndeadline
+0000ea10: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0000ea20: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0000ea30: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
+0000ea40: 6520 6669 6c74 6572 696e 6720 6f66 2065  e filtering of e
+0000ea50: 7665 6e74 7320 6973 2064 6f6e 6520 6f6e  vents is done on
+0000ea60: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
+0000ea70: 4220 7365 7276 6572 2e20 5468 655c 6e60  B server. The\n`
+0000ea80: 6c69 6d69 7460 2061 7267 756d 656e 7420  limit` argument 
+0000ea90: 6973 2061 7070 6c69 6564 206f 6e20 7468  is applied on th
+0000eaa0: 6520 7365 7276 6572 2061 6674 6572 2066  e server after f
+0000eab0: 696c 7465 7269 6e67 2e5c 6e5c 6e54 6865  iltering.\n\nThe
+0000eac0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+0000ead0: 686f 7773 2068 6f77 2074 6f20 6765 7420  hows how to get 
+0000eae0: 616c 6c20 7468 6520 6576 656e 7473 2077  all the events w
+0000eaf0: 6520 6861 7665 2072 6563 6f72 6465 6420  e have recorded 
+0000eb00: 696e 2074 6865 2064 6174 6162 6173 655c  in the database\
+0000eb10: 6e73 6f20 6661 722c 2069 6e20 7468 6520  nso far, in the 
+0000eb20: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+0000eb30: 7265 636f 7264 6564 2e20 5765 2063 616e  recorded. We can
+0000eb40: 2073 6565 2074 6865 2074 6872 6565 2065   see the three e
+0000eb50: 7665 6e74 7320 6f66 2060 7374 7265 616d  vents of `stream
+0000eb60: 5f6e 616d 6531 605c 6e28 6065 7665 6e74  _name1`\n(`event
+0000eb70: 3160 2c20 6065 7665 6e74 3260 2061 6e64  1`, `event2` and
+0000eb80: 2060 6576 656e 7433 6029 2061 7265 2069   `event3`) are i
+0000eb90: 6e63 6c75 6465 642c 2061 6c6f 6e67 2077  ncluded, along w
+0000eba0: 6974 6820 6f74 6865 7273 2e5c 6e5c 6e60  ith others.\n\n`
+0000ebb0: 6060 7079 7468 6f6e 5c6e 2320 5265 6164  ``python\n# Read
+0000ebc0: 2061 6c6c 2065 7665 6e74 7320 2863 7265   all events (cre
+0000ebd0: 6174 6573 2061 2073 7472 6561 6d69 6e67  ates a streaming
+0000ebe0: 2067 5250 4320 6361 6c6c 292e 5c6e 7265   gRPC call).\nre
+0000ebf0: 6164 5f72 6573 706f 6e73 6520 3d20 636c  ad_response = cl
+0000ec00: 6965 6e74 2e72 6561 645f 616c 6c5f 6576  ient.read_all_ev
+0000ec10: 656e 7473 2829 5c6e 5c6e 2320 436f 6e76  ents()\n\n# Conv
+0000ec20: 6572 7420 7468 6520 6974 6572 6174 6f72  ert the iterator
+0000ec30: 2069 6e74 6f20 6120 7365 7175 656e 6365   into a sequence
+0000ec40: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
+0000ec50: 6e74 732e 5c6e 6576 656e 7473 203d 2074  nts.\nevents = t
+0000ec60: 7570 6c65 2872 6561 645f 7265 7370 6f6e  uple(read_respon
+0000ec70: 7365 295c 6e61 7373 6572 7420 6c65 6e28  se)\nassert len(
+0000ec80: 6576 656e 7473 2920 3e20 3320 2023 206d  events) > 3  # m
+0000ec90: 6f72 6520 7468 616e 2074 6872 6565 5c6e  ore than three\n
+0000eca0: 5c6e 2320 436f 6e76 6572 7420 7468 6520  \n# Convert the 
+0000ecb0: 7365 7175 656e 6365 206f 6620 7265 636f  sequence of reco
+0000ecc0: 7264 6564 2065 7665 6e74 7320 696e 746f  rded events into
+0000ecd0: 2061 2073 6574 206f 6620 6576 656e 7420   a set of event 
+0000ece0: 4944 732e 5c6e 6576 656e 745f 6964 7320  IDs.\nevent_ids 
+0000ecf0: 3d20 7365 7428 652e 6964 2066 6f72 2065  = set(e.id for e
+0000ed00: 2069 6e20 6576 656e 7473 295c 6e61 7373   in events)\nass
+0000ed10: 6572 7420 6576 656e 7431 2e69 6420 696e  ert event1.id in
+0000ed20: 2065 7665 6e74 5f69 6473 5c6e 6173 7365   event_ids\nasse
+0000ed30: 7274 2065 7665 6e74 322e 6964 2069 6e20  rt event2.id in 
+0000ed40: 6576 656e 745f 6964 735c 6e61 7373 6572  event_ids\nasser
+0000ed50: 7420 6576 656e 7433 2e69 6420 696e 2065  t event3.id in e
+0000ed60: 7665 6e74 5f69 6473 5c6e 6060 605c 6e5c  vent_ids\n```\n\
+0000ed70: 6e54 6865 2065 7861 6d70 6c65 2062 656c  nThe example bel
+0000ed80: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+0000ed90: 7265 6164 2061 6c6c 2072 6563 6f72 6465  read all recorde
+0000eda0: 6420 6576 656e 7473 2069 6e20 7468 6520  d events in the 
+0000edb0: 6461 7461 6261 7365 2066 726f 6d5c 6e61  database from\na
+0000edc0: 2070 6172 7469 6375 6c61 7220 636f 6d6d   particular comm
+0000edd0: 6974 2070 6f73 6974 696f 6e2c 2069 6e20  it position, in 
+0000ede0: 7468 6973 2063 6173 6520 6063 6f6d 6d69  this case `commi
+0000edf0: 745f 706f 7369 7469 6f6e 3160 2e20 5768  t_position1`. Wh
+0000ee00: 656e 2072 6561 6469 6e67 5c6e 666f 7277  en reading\nforw
+0000ee10: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
+0000ee20: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
+0000ee30: 7469 6f6e 2c20 7468 6520 6576 656e 7420  tion, the event 
+0000ee40: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
+0000ee50: 2070 6f73 6974 696f 6e5c 6e77 696c 6c20   position\nwill 
+0000ee60: 6265 2069 6e63 6c75 6465 642e 2054 6865  be included. The
+0000ee70: 2076 616c 7565 206f 6620 6063 6f6d 6d69   value of `commi
+0000ee80: 745f 706f 7369 7469 6f6e 3160 2069 7320  t_position1` is 
+0000ee90: 7468 6520 706f 7369 7469 6f6e 2077 6520  the position we 
+0000eea0: 6f62 7461 696e 6564 5c6e 7768 656e 2061  obtained\nwhen a
+0000eeb0: 7070 656e 6469 6e67 2060 6576 656e 7431  ppending `event1
+0000eec0: 602e 2041 6e64 2073 6f20 6065 7665 6e74  `. And so `event
+0000eed0: 3160 2069 7320 7468 6520 6669 7273 7420  1` is the first 
+0000eee0: 7265 636f 7264 6564 2065 7665 6e74 2077  recorded event w
+0000eef0: 6520 7368 616c 6c5c 6e72 6563 6569 7665  e shall\nreceive
+0000ef00: 2c20 6065 7665 6e74 3260 2069 7320 7468  , `event2` is th
+0000ef10: 6520 7365 636f 6e64 2c20 616e 6420 6065  e second, and `e
+0000ef20: 7665 6e74 3360 2069 7320 7468 6520 7468  vent3` is the th
+0000ef30: 6972 642e 5c6e 5c6e 6060 6070 7974 686f  ird.\n\n```pytho
+0000ef40: 6e5c 6e23 2052 6561 6420 616c 6c20 6576  n\n# Read all ev
+0000ef50: 656e 7473 2066 6f72 7761 7264 7320 6672  ents forwards fr
+0000ef60: 6f6d 2061 2063 6f6d 6d69 7420 706f 7369  om a commit posi
+0000ef70: 7469 6f6e 2e5c 6e72 6561 645f 7265 7370  tion.\nread_resp
+0000ef80: 6f6e 7365 203d 2063 6c69 656e 742e 7265  onse = client.re
+0000ef90: 6164 5f61 6c6c 5f65 7665 6e74 7328 5c6e  ad_all_events(\n
+0000efa0: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
+0000efb0: 696f 6e3d 636f 6d6d 6974 5f70 6f73 6974  ion=commit_posit
+0000efc0: 696f 6e31 5c6e 295c 6e5c 6e23 2053 7465  ion1\n)\n\n# Ste
+0000efd0: 7020 7468 726f 7567 6820 7468 6520 2272  p through the "r
+0000efe0: 6561 6420 7265 7370 6f6e 7365 2220 6974  ead response" it
+0000eff0: 6572 6174 6f72 2e5c 6e61 7373 6572 7420  erator.\nassert 
+0000f000: 6e65 7874 2872 6561 645f 7265 7370 6f6e  next(read_respon
+0000f010: 7365 292e 6964 203d 3d20 6576 656e 7431  se).id == event1
+0000f020: 2e69 645c 6e61 7373 6572 7420 6e65 7874  .id\nassert next
+0000f030: 2872 6561 645f 7265 7370 6f6e 7365 292e  (read_response).
+0000f040: 6964 203d 3d20 6576 656e 7432 2e69 645c  id == event2.id\
+0000f050: 6e61 7373 6572 7420 6e65 7874 2872 6561  nassert next(rea
+0000f060: 645f 7265 7370 6f6e 7365 292e 6964 203d  d_response).id =
+0000f070: 3d20 6576 656e 7433 2e69 645c 6e5c 6e23  = event3.id\n\n#
+0000f080: 2053 746f 7020 7468 6520 6974 6572 6174   Stop the iterat
+0000f090: 6f72 2e5c 6e72 6561 645f 7265 7370 6f6e  or.\nread_respon
+0000f0a0: 7365 2e73 746f 7028 295c 6e60 6060 5c6e  se.stop()\n```\n
+0000f0b0: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
+0000f0c0: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
+0000f0d0: 2072 6561 6420 616c 6c20 6576 656e 7473   read all events
+0000f0e0: 2072 6563 6f72 6465 6420 696e 2074 6865   recorded in the
+0000f0f0: 2064 6174 6162 6173 6520 696e 2072 6576   database in rev
+0000f100: 6572 7365 5c6e 6f72 6465 722e 2057 6520  erse\norder. We 
+0000f110: 6361 6e20 7365 6520 7468 6174 2074 6865  can see that the
+0000f120: 2066 6972 7374 2065 7665 6e74 7320 7765   first events we
+0000f130: 2072 6563 6569 7665 2061 7265 2074 6865   receive are the
+0000f140: 206c 6173 7420 6576 656e 7473 2074 6861   last events tha
+0000f150: 7420 7765 7265 5c6e 7265 636f 7264 6564  t were\nrecorded
+0000f160: 3a20 7468 6520 6576 656e 7473 206f 6620  : the events of 
+0000f170: 7468 6520 6044 6f67 6020 6167 6772 6567  the `Dog` aggreg
+0000f180: 6174 6520 6672 6f6d 2074 6865 2073 6563  ate from the sec
+0000f190: 7469 6f6e 2061 626f 7574 2073 6e61 7073  tion about snaps
+0000f1a0: 686f 7474 696e 675c 6e61 6e64 2074 6865  hotting\nand the
+0000f1b0: 2073 6e61 7073 686f 742e 5c6e 5c6e 6060   snapshot.\n\n``
+0000f1c0: 6070 7974 686f 6e5c 6e23 2052 6561 6420  `python\n# Read 
+0000f1d0: 616c 6c20 6576 656e 7473 2062 6163 6b77  all events backw
+0000f1e0: 6172 6473 2066 726f 6d20 7468 6520 656e  ards from the en
+0000f1f0: 642e 5c6e 7265 6164 5f72 6573 706f 6e73  d.\nread_respons
+0000f200: 6520 3d20 636c 6965 6e74 2e72 6561 645f  e = client.read_
+0000f210: 616c 6c5f 6576 656e 7473 285c 6e20 2020  all_events(\n   
+0000f220: 2062 6163 6b77 6172 6473 3d54 7275 655c   backwards=True\
+0000f230: 6e29 5c6e 5c6e 2320 5374 6570 2074 6872  n)\n\n# Step thr
+0000f240: 6f75 6768 2074 6865 2022 7265 6164 2072  ough the "read r
+0000f250: 6573 706f 6e73 6522 2069 7465 7261 746f  esponse" iterato
+0000f260: 722e 5c6e 6173 7365 7274 206e 6578 7428  r.\nassert next(
+0000f270: 7265 6164 5f72 6573 706f 6e73 6529 2e74  read_response).t
+0000f280: 7970 6520 3d3d 2022 446f 674c 6561 726e  ype == "DogLearn
+0000f290: 6564 5472 6963 6b22 5c6e 6173 7365 7274  edTrick"\nassert
+0000f2a0: 206e 6578 7428 7265 6164 5f72 6573 706f   next(read_respo
+0000f2b0: 6e73 6529 2e74 7970 6520 3d3d 2022 536e  nse).type == "Sn
+0000f2c0: 6170 7368 6f74 225c 6e61 7373 6572 7420  apshot"\nassert 
+0000f2d0: 6e65 7874 2872 6561 645f 7265 7370 6f6e  next(read_respon
+0000f2e0: 7365 292e 7479 7065 203d 3d20 2244 6f67  se).type == "Dog
+0000f2f0: 4c65 6172 6e65 6454 7269 636b 225c 6e61  LearnedTrick"\na
+0000f300: 7373 6572 7420 6e65 7874 2872 6561 645f  ssert next(read_
+0000f310: 7265 7370 6f6e 7365 292e 7479 7065 203d  response).type =
+0000f320: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
+0000f330: 636b 225c 6e61 7373 6572 7420 6e65 7874  ck"\nassert next
+0000f340: 2872 6561 645f 7265 7370 6f6e 7365 292e  (read_response).
+0000f350: 7479 7065 203d 3d20 2244 6f67 5265 6769  type == "DogRegi
+0000f360: 7374 6572 6564 225c 6e5c 6e23 2053 746f  stered"\n\n# Sto
+0000f370: 7020 7468 6520 6974 6572 6174 6f72 2e5c  p the iterator.\
+0000f380: 6e72 6561 645f 7265 7370 6f6e 7365 2e73  nread_response.s
+0000f390: 746f 7028 295c 6e60 6060 5c6e 5c6e 5468  top()\n```\n\nTh
+0000f3a0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+0000f3b0: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+0000f3c0: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
+0000f3d0: 6572 206f 6620 6576 656e 7473 5c6e 666f  er of events\nfo
+0000f3e0: 7277 6172 6473 2066 726f 6d20 6120 7370  rwards from a sp
+0000f3f0: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
+0000f400: 7369 7469 6f6e 2e5c 6e5c 6e60 6060 7079  sition.\n\n```py
+0000f410: 7468 6f6e 5c6e 6576 656e 7473 203d 2074  thon\nevents = t
+0000f420: 7570 6c65 285c 6e20 2020 2063 6c69 656e  uple(\n    clien
+0000f430: 742e 7265 6164 5f61 6c6c 5f65 7665 6e74  t.read_all_event
+0000f440: 7328 5c6e 2020 2020 2020 2020 636f 6d6d  s(\n        comm
+0000f450: 6974 5f70 6f73 6974 696f 6e3d 636f 6d6d  it_position=comm
+0000f460: 6974 5f70 6f73 6974 696f 6e31 2c5c 6e20  it_position1,\n 
+0000f470: 2020 2020 2020 206c 696d 6974 3d31 2c5c         limit=1,\
+0000f480: 6e20 2020 2029 5c6e 295c 6e5c 6e61 7373  n    )\n)\n\nass
+0000f490: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+0000f4a0: 3d3d 2031 5c6e 6173 7365 7274 2065 7665  == 1\nassert eve
+0000f4b0: 6e74 735b 305d 2e69 6420 3d3d 2065 7665  nts[0].id == eve
+0000f4c0: 6e74 312e 6964 5c6e 6060 605c 6e5c 6e54  nt1.id\n```\n\nT
+0000f4d0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0000f4e0: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
+0000f4f0: 6164 2061 206c 696d 6974 6564 206e 756d  ad a limited num
+0000f500: 6265 7220 6f66 2074 6865 2072 6563 6f72  ber of the recor
+0000f510: 6465 6420 6576 656e 7473 5c6e 696e 2074  ded events\nin t
+0000f520: 6865 2064 6174 6162 6173 6520 6261 636b  he database back
+0000f530: 7761 7264 7320 6672 6f6d 2074 6865 2065  wards from the e
+0000f540: 6e64 2e20 496e 2074 6869 7320 6361 7365  nd. In this case
+0000f550: 2c20 7468 6520 6c69 6d69 7420 6973 2031  , the limit is 1
+0000f560: 2c20 616e 645c 6e73 6f20 7765 2072 6563  , and\nso we rec
+0000f570: 6569 7665 2074 6865 206c 6173 7420 7265  eive the last re
+0000f580: 636f 7264 6564 2065 7665 6e74 2e5c 6e5c  corded event.\n\
+0000f590: 6e60 6060 7079 7468 6f6e 5c6e 6576 656e  n```python\neven
+0000f5a0: 7473 203d 2074 7570 6c65 285c 6e20 2020  ts = tuple(\n   
+0000f5b0: 2063 6c69 656e 742e 7265 6164 5f61 6c6c   client.read_all
+0000f5c0: 5f65 7665 6e74 7328 5c6e 2020 2020 2020  _events(\n      
+0000f5d0: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
+0000f5e0: 2c5c 6e20 2020 2020 2020 206c 696d 6974  ,\n        limit
+0000f5f0: 3d31 2c5c 6e20 2020 2029 5c6e 295c 6e5c  =1,\n    )\n)\n\
+0000f600: 6e61 7373 6572 7420 6c65 6e28 6576 656e  nassert len(even
+0000f610: 7473 2920 3d3d 2031 5c6e 5c6e 6173 7365  ts) == 1\n\nasse
+0000f620: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
+0000f630: 6520 3d3d 205c 2744 6f67 4c65 6172 6e65  e == \'DogLearne
+0000f640: 6454 7269 636b 5c27 5c6e 6173 7365 7274  dTrick\'\nassert
+0000f650: 2064 6573 6572 6961 6c69 7a65 2865 7665   deserialize(eve
+0000f660: 6e74 735b 305d 2e64 6174 6129 5b5c 2774  nts[0].data)[\'t
+0000f670: 7269 636b 5c27 5d20 3d3d 205c 2773 6974  rick\'] == \'sit
+0000f680: 5c27 5c6e 6060 605c 6e5c 6e50 6c65 6173  \'\n```\n\nPleas
+0000f690: 6520 6e6f 7465 2c20 6c69 6b65 2074 6865  e note, like the
+0000f6a0: 2060 6974 6572 5f73 7472 6561 6d5f 6576   `iter_stream_ev
+0000f6b0: 656e 7473 2829 6020 6d65 7468 6f64 2c20  ents()` method, 
+0000f6c0: 7468 6520 6072 6561 645f 616c 6c5f 6576  the `read_all_ev
+0000f6d0: 656e 7473 2829 6020 6d65 7468 6f64 5c6e  ents()` method\n
+0000f6e0: 6973 206e 6f74 2064 6563 6f72 6174 6564  is not decorated
+0000f6f0: 2077 6974 6820 7265 7472 7920 616e 6420   with retry and 
+0000f700: 7265 636f 6e6e 6563 7420 6465 636f 7261  reconnect decora
+0000f710: 746f 7273 2c20 6265 6361 7573 6520 7468  tors, because th
+0000f720: 6520 7374 7265 616d 696e 6720 6f66 2072  e streaming of r
+0000f730: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
+0000f740: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
+0000f750: 6f6e 6c79 2073 7461 7274 7320 7768 656e  only starts when
+0000f760: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+0000f770: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+0000f780: 7365 2220 7374 6172 7473 2c20 7768 6963  se" starts, whic
+0000f790: 685c 6e6d 6561 6e73 2074 6861 7420 7468  h\nmeans that th
+0000f7a0: 6520 6d65 7468 6f64 2072 6574 7572 6e73  e method returns
+0000f7b0: 2062 6566 6f72 6520 7468 6520 7374 7265   before the stre
+0000f7c0: 616d 696e 6720 7374 6172 7473 2c20 616e  aming starts, an
+0000f7d0: 6420 736f 2074 6865 7265 2069 7320 6e6f  d so there is no
+0000f7e0: 2063 6861 6e63 6520 666f 725c 6e61 6e79   chance for\nany
+0000f7f0: 2064 6563 6f72 6174 6f72 7320 746f 2063   decorators to c
+0000f800: 6174 6368 2061 6e79 2063 6f6e 6e65 6374  atch any connect
+0000f810: 696f 6e20 6973 7375 6573 2e5c 6e5c 6e23  ion issues.\n\n#
+0000f820: 2323 2047 6574 2063 6f6d 6d69 7420 706f  ## Get commit po
+0000f830: 7369 7469 6f6e 5c6e 5c6e 5468 6520 6067  sition\n\nThe `g
+0000f840: 6574 5f63 6f6d 6d69 745f 706f 7369 7469  et_commit_positi
+0000f850: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
+0000f860: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
+0000f870: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+0000f880: 696f 6e20 6f66 2074 6865 5c6e 6c61 7374  ion of the\nlast
+0000f890: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+0000f8a0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+0000f8b0: 2049 7420 7369 6d70 6c79 2063 616c 6c73   It simply calls
+0000f8c0: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
+0000f8d0: 7328 2960 2077 6974 685c 6e60 6261 636b  s()` with\n`back
+0000f8e0: 7761 7264 733d 5472 7565 6020 616e 6420  wards=True` and 
+0000f8f0: 606c 696d 6974 3d31 602c 2061 6e64 2072  `limit=1`, and r
+0000f900: 6574 7572 6e73 2074 6865 2076 616c 7565  eturns the value
+0000f910: 206f 6620 7468 6520 6063 6f6d 6d69 745f   of the `commit_
+0000f920: 706f 7369 7469 6f6e 605c 6e61 7474 7269  position`\nattri
+0000f930: 6275 7465 206f 6620 7468 6520 6c61 7374  bute of the last
+0000f940: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+0000f950: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e63  \n\n```python\nc
+0000f960: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
+0000f970: 2063 6c69 656e 742e 6765 745f 636f 6d6d   client.get_comm
+0000f980: 6974 5f70 6f73 6974 696f 6e28 295c 6e60  it_position()\n`
+0000f990: 6060 5c6e 5c6e 5468 6973 206d 6574 686f  ``\n\nThis metho
+0000f9a0: 6420 6861 7320 666f 7572 206f 7074 696f  d has four optio
+0000f9b0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+0000f9c0: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+0000f9d0: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+0000f9e0: 602c 5c6e 6066 696c 7465 725f 6279 5f73  `,\n`filter_by_s
+0000f9f0: 7472 6561 6d5f 6e61 6d65 6020 616e 6420  tream_name` and 
+0000fa00: 6074 696d 656f 7574 602e 2054 6865 7365  `timeout`. These
+0000fa10: 2076 616c 7565 7320 6172 6520 7061 7373   values are pass
+0000fa20: 6564 2074 6f20 6072 6561 645f 616c 6c5f  ed to `read_all_
+0000fa30: 6576 656e 7473 2829 602e 5c6e 5c6e 5468  events()`.\n\nTh
+0000fa40: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
+0000fa50: 6572 5f65 7863 6c75 6465 602c 2060 6669  er_exclude`, `fi
+0000fa60: 6c74 6572 5f69 6e63 6c75 6465 6020 616e  lter_include` an
+0000fa70: 6420 6066 696c 7465 725f 6279 5f73 7472  d `filter_by_str
+0000fa80: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
+0000fa90: 6e74 735c 6e77 6f72 6b20 696e 2074 6865  nts\nwork in the
+0000faa0: 2073 616d 6520 7761 7920 6173 2074 6865   same way as the
+0000fab0: 7920 646f 2069 6e20 7468 6520 6072 6561  y do in the `rea
+0000fac0: 645f 616c 6c5f 6576 656e 7473 2829 6020  d_all_events()` 
+0000fad0: 6d65 7468 6f64 2e5c 6e5c 6e54 6869 7320  method.\n\nThis 
+0000fae0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+0000faf0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+0000fb00: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
+0000fb10: 7468 6174 2073 6574 735c 6e61 2064 6561  that sets\na dea
+0000fb20: 646c 696e 6520 666f 7220 7468 6520 636f  dline for the co
+0000fb30: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+0000fb40: 6752 5043 206f 7065 7261 7469 6f6e 2e5c  gRPC operation.\
+0000fb50: 6e5c 6e54 6869 7320 6d65 7468 6f64 206d  n\nThis method m
+0000fb60: 6967 6874 2062 6520 7573 6564 2074 6f20  ight be used to 
+0000fb70: 6d65 6173 7572 6520 7072 6f67 7265 7373  measure progress
+0000fb80: 206f 6620 6120 646f 776e 7374 7265 616d   of a downstream
+0000fb90: 2063 6f6d 706f 6e65 6e74 5c6e 7468 6174   component\nthat
+0000fba0: 2069 7320 7072 6f63 6573 7369 6e67 2061   is processing a
+0000fbb0: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
+0000fbc0: 7473 2c20 6279 2063 6f6d 7061 7269 6e67  ts, by comparing
+0000fbd0: 2074 6865 2063 7572 7265 6e74 2063 6f6d   the current com
+0000fbe0: 6d69 745c 6e70 6f73 6974 696f 6e20 7769  mit\nposition wi
+0000fbf0: 7468 2074 6865 2072 6563 6f72 6465 6420  th the recorded 
+0000fc00: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+0000fc10: 6f66 2074 6865 206c 6173 7420 7375 6363  of the last succ
+0000fc20: 6573 7366 756c 6c79 2070 726f 6365 7373  essfully process
+0000fc30: 6564 5c6e 6576 656e 7420 696e 2061 2064  ed\nevent in a d
+0000fc40: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+0000fc50: 656e 742e 2049 6e20 7468 6973 2063 6173  ent. In this cas
+0000fc60: 652c 2074 6865 2076 616c 7565 206f 6620  e, the value of 
+0000fc70: 7468 6520 6066 696c 7465 725f 6578 636c  the `filter_excl
+0000fc80: 7564 6560 2c5c 6e60 6669 6c74 6572 5f69  ude`,\n`filter_i
+0000fc90: 6e63 6c75 6465 6020 616e 6420 6066 696c  nclude` and `fil
+0000fca0: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
+0000fcb0: 6d65 6020 6172 6775 6d65 6e74 7320 7368  me` arguments sh
+0000fcc0: 6f75 6c64 2065 7175 616c 2074 686f 7365  ould equal those
+0000fcd0: 2075 7365 645c 6e62 7920 7468 6520 646f   used\nby the do
+0000fce0: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
+0000fcf0: 6e74 2074 6f20 6f62 7461 696e 2072 6563  nt to obtain rec
+0000fd00: 6f72 6465 6420 6576 656e 7473 2e5c 6e5c  orded events.\n\
+0000fd10: 6e5c 6e23 2323 2047 6574 2073 7472 6561  n\n### Get strea
+0000fd20: 6d20 6d65 7461 6461 7461 5c6e 5c6e 5468  m metadata\n\nTh
+0000fd30: 6520 6067 6574 5f73 7472 6561 6d5f 6d65  e `get_stream_me
+0000fd40: 7461 6461 7461 2829 6020 6d65 7468 6f64  tadata()` method
+0000fd50: 2072 6574 7572 6e73 2074 6865 206d 6574   returns the met
+0000fd60: 6164 6174 6120 666f 7220 6120 7374 7265  adata for a stre
+0000fd70: 616d 2c20 616c 6f6e 675c 6e77 6974 6820  am, along\nwith 
+0000fd80: 7468 6520 7665 7273 696f 6e20 6f66 2074  the version of t
+0000fd90: 6865 2073 7472 6561 6d20 6d65 7461 6461  he stream metada
+0000fda0: 7461 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ta.\n\n```python
+0000fdb0: 5c6e 6d65 7461 6461 7461 2c20 6d65 7461  \nmetadata, meta
+0000fdc0: 6461 7461 5f76 6572 7369 6f6e 203d 2063  data_version = c
+0000fdd0: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
+0000fde0: 5f6d 6574 6164 6174 6128 7374 7265 616d  _metadata(stream
+0000fdf0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000fe00: 6531 295c 6e60 6060 5c6e 5c6e 5468 6520  e1)\n```\n\nThe 
+0000fe10: 7265 7475 726e 6564 2060 6d65 7461 6461  returned `metada
+0000fe20: 7461 6020 7661 6c75 6520 6973 2061 2050  ta` value is a P
+0000fe30: 7974 686f 6e20 6064 6963 7460 2e20 5468  ython `dict`. Th
+0000fe40: 6520 7265 7475 726e 6564 2060 6d65 7461  e returned `meta
+0000fe50: 6461 7461 5f76 6572 7369 6f6e 605c 6e76  data_version`\nv
+0000fe60: 616c 7565 2069 7320 6569 7468 6572 2061  alue is either a
+0000fe70: 6e20 6069 6e74 6020 6966 2074 6865 2073  n `int` if the s
+0000fe80: 7472 6561 6d20 6578 6973 7473 2c20 6f72  tream exists, or
+0000fe90: 2060 4e6f 6e65 6020 6966 2074 6865 2073   `None` if the s
+0000fea0: 7472 6561 6d20 646f 6573 206e 6f74 2065  tream does not e
+0000feb0: 7869 7374 5c6e 616e 6420 6e6f 206d 6574  xist\nand no met
+0000fec0: 6164 6174 6120 6861 7320 6265 656e 2073  adata has been s
+0000fed0: 6574 2e20 5468 6573 6520 7661 6c75 6573  et. These values
+0000fee0: 2063 616e 2062 6520 7061 7373 6564 2069   can be passed i
+0000fef0: 6e74 6f20 6073 6574 5f73 7472 6561 6d5f  nto `set_stream_
+0000ff00: 6d65 7461 6461 7461 2829 602e 5c6e 5c6e  metadata()`.\n\n
+0000ff10: 5c6e 2323 2320 5365 7420 7374 7265 616d  \n### Set stream
+0000ff20: 206d 6574 6164 6174 615c 6e5c 6e2a 7265   metadata\n\n*re
+0000ff30: 7175 6972 6573 206c 6561 6465 722a 5c6e  quires leader*\n
+0000ff40: 5c6e 5468 6520 6d65 7468 6f64 2060 7365  \nThe method `se
+0000ff50: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
+0000ff60: 6128 2960 2073 6574 7320 7468 6520 6d65  a()` sets the me
+0000ff70: 7461 6461 7461 2066 6f72 2061 2073 7472  tadata for a str
+0000ff80: 6561 6d2e 2053 7472 6561 6d20 6d65 7461  eam. Stream meta
+0000ff90: 6461 7461 5c6e 6361 6e20 6265 2073 6574  data\ncan be set
+0000ffa0: 2062 6566 6f72 6520 6170 7065 6e64 696e   before appendin
+0000ffb0: 6720 6576 656e 7473 2074 6f20 6120 7374  g events to a st
+0000ffc0: 7265 616d 2e5c 6e5c 6e60 6060 7079 7468  ream.\n\n```pyth
+0000ffd0: 6f6e 5c6e 6d65 7461 6461 7461 5b22 666f  on\nmetadata["fo
+0000ffe0: 6f22 5d20 3d20 2262 6172 225c 6e5c 6e63  o"] = "bar"\n\nc
+0000fff0: 6c69 656e 742e 7365 745f 7374 7265 616d  lient.set_stream
+00010000: 5f6d 6574 6164 6174 6128 5c6e 2020 2020  _metadata(\n    
+00010010: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00010020: 616d 5f6e 616d 6531 2c5c 6e20 2020 206d  am_name1,\n    m
+00010030: 6574 6164 6174 613d 6d65 7461 6461 7461  etadata=metadata
+00010040: 2c5c 6e20 2020 2063 7572 7265 6e74 5f76  ,\n    current_v
+00010050: 6572 7369 6f6e 3d6d 6574 6164 6174 615f  ersion=metadata_
+00010060: 7665 7273 696f 6e2c 5c6e 295c 6e60 6060  version,\n)\n```
+00010070: 5c6e 5c6e 5468 6520 6063 7572 7265 6e74  \n\nThe `current
+00010080: 5f76 6572 7369 6f6e 6020 6172 6775 6d65  _version` argume
+00010090: 6e74 2073 686f 756c 6420 6265 2074 6865  nt should be the
+000100a0: 2063 7572 7265 6e74 2076 6572 7369 6f6e   current version
+000100b0: 206f 6620 7468 6520 7374 7265 616d 206d   of the stream m
+000100c0: 6574 6164 6174 615c 6e6f 6274 6169 6e65  etadata\nobtaine
+000100d0: 6420 6672 6f6d 2060 6765 745f 7374 7265  d from `get_stre
+000100e0: 616d 5f6d 6574 6164 6174 6128 2960 2e5c  am_metadata()`.\
+000100f0: 6e5c 6e50 6c65 6173 6520 7265 6665 7220  n\nPlease refer 
+00010100: 746f 2074 6865 2045 7665 6e74 5374 6f72  to the EventStor
+00010110: 6544 4220 646f 6375 6d65 6e74 6174 696f  eDB documentatio
+00010120: 6e20 666f 7220 6d6f 7265 2069 6e66 6f72  n for more infor
+00010130: 6d61 7469 6f6e 2061 626f 7574 2073 7472  mation about str
+00010140: 6561 6d5c 6e6d 6574 6164 6174 612e 5c6e  eam\nmetadata.\n
+00010150: 5c6e 2323 2320 4465 6c65 7465 2073 7472  \n### Delete str
+00010160: 6561 6d5c 6e5c 6e2a 7265 7175 6972 6573  eam\n\n*requires
+00010170: 206c 6561 6465 722a 5c6e 5c6e 5468 6520   leader*\n\nThe 
+00010180: 6d65 7468 6f64 2060 6465 6c65 7465 5f73  method `delete_s
+00010190: 7472 6561 6d28 2960 2063 616e 2062 6520  tream()` can be 
+000101a0: 7573 6564 2074 6f20 2264 656c 6574 6522  used to "delete"
+000101b0: 2061 2073 7472 6561 6d2e 5c6e 5c6e 6060   a stream.\n\n``
+000101c0: 6070 7974 686f 6e5c 6e63 6f6d 6d69 745f  `python\ncommit_
+000101d0: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
+000101e0: 742e 6465 6c65 7465 5f73 7472 6561 6d28  t.delete_stream(
+000101f0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00010200: 616d 5f6e 616d 6531 2c20 6375 7272 656e  am_name1, curren
+00010210: 745f 7665 7273 696f 6e3d 3229 5c6e 6060  t_version=2)\n``
+00010220: 605c 6e5c 6e41 6674 6572 2064 656c 6574  `\n\nAfter delet
+00010230: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
+00010240: 5c27 7320 7374 696c 6c20 706f 7373 6962  \'s still possib
+00010250: 6c65 2074 6f20 6170 7065 6e64 206e 6577  le to append new
+00010260: 2065 7665 6e74 732e 2052 6561 6469 6e67   events. Reading
+00010270: 2066 726f 6d20 615c 6e64 656c 6574 6564   from a\ndeleted
+00010280: 2073 7472 6561 6d20 7769 6c6c 2072 6574   stream will ret
+00010290: 7572 6e20 6f6e 6c79 2065 7665 6e74 7320  urn only events 
+000102a0: 7468 6174 2068 6176 6520 6265 656e 2061  that have been a
+000102b0: 7070 656e 6465 6420 6166 7465 7220 6974  ppended after it
+000102c0: 2077 6173 5c6e 6465 6c65 7465 642e 5c6e   was\ndeleted.\n
+000102d0: 5c6e 2323 2320 546f 6d62 7374 6f6e 6520  \n### Tombstone 
+000102e0: 7374 7265 616d 5c6e 5c6e 2a72 6571 7569  stream\n\n*requi
+000102f0: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
+00010300: 6865 206d 6574 686f 6420 6074 6f6d 6273  he method `tombs
+00010310: 746f 6e65 5f73 7472 6561 6d28 2960 2063  tone_stream()` c
+00010320: 616e 2062 6520 7573 6564 2074 6f20 2274  an be used to "t
+00010330: 6f6d 6273 746f 6e65 2220 6120 7374 7265  ombstone" a stre
+00010340: 616d 2e5c 6e5c 6e60 6060 7079 7468 6f6e  am.\n\n```python
+00010350: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
+00010360: 6e20 3d20 636c 6965 6e74 2e74 6f6d 6273  n = client.tombs
+00010370: 746f 6e65 5f73 7472 6561 6d28 7374 7265  tone_stream(stre
+00010380: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00010390: 616d 6531 2c20 6375 7272 656e 745f 7665  ame1, current_ve
+000103a0: 7273 696f 6e3d 3229 5c6e 6060 605c 6e5c  rsion=2)\n```\n\
+000103b0: 6e41 6674 6572 2074 6f6d 6273 746f 6e69  nAfter tombstoni
+000103c0: 6e67 2061 2073 7472 6561 6d2c 2069 745c  ng a stream, it\
+000103d0: 2773 206e 6f74 2070 6f73 7369 626c 6520  's not possible 
+000103e0: 746f 2061 7070 656e 6420 6e65 7720 6576  to append new ev
+000103f0: 656e 7473 2e5c 6e5c 6e5c 6e23 2320 4361  ents.\n\n\n## Ca
+00010400: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+00010410: 696f 6e73 5c6e 5c6e 4120 2263 6174 6368  ions\n\nA "catch
+00010420: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
+00010430: 6e20 6361 6e20 6265 2075 7365 6420 746f  n can be used to
+00010440: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+00010450: 7468 6174 2068 6176 6520 616c 7265 6164  that have alread
+00010460: 7920 6265 656e 5c6e 7265 636f 7264 6564  y been\nrecorded
+00010470: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+00010480: 2c20 616e 6420 616c 736f 2065 7665 6e74  , and also event
+00010490: 7320 7468 6174 2061 7265 2072 6563 6f72  s that are recor
+000104a0: 6465 6420 7375 6273 6571 7565 6e74 6c79  ded subsequently
+000104b0: 2e5c 6e5c 6e54 6865 2060 7375 6273 6372  .\n\nThe `subscr
+000104c0: 6962 655f 616c 6c5f 6576 656e 7473 2829  ibe_all_events()
+000104d0: 6020 6d65 7468 6f64 2073 7461 7274 7320  ` method starts 
+000104e0: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
+000104f0: 7269 7074 696f 6e20 7468 6174 2063 616e  ription that can
+00010500: 2072 6563 6569 7665 5c6e 616c 6c20 6576   receive\nall ev
+00010510: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
+00010520: 6261 7365 2e20 5468 6520 6073 7562 7363  base. The `subsc
+00010530: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
+00010540: 7473 2829 6020 6d65 7468 6f64 2073 7461  ts()` method sta
+00010550: 7274 7320 6120 6361 7463 682d 7570 5c6e  rts a catch-up\n
+00010560: 7375 6273 6372 6970 7469 6f6e 2074 6861  subscription tha
+00010570: 7420 6361 6e20 7265 6365 6976 6520 6576  t can receive ev
+00010580: 656e 7473 2066 726f 6d20 6120 7370 6563  ents from a spec
+00010590: 6966 6963 2073 7472 6561 6d2e 5c6e 5c6e  ific stream.\n\n
+000105a0: 5468 6520 6073 7562 7363 7269 6265 5f61  The `subscribe_a
+000105b0: 6c6c 5f65 7665 6e74 7328 2960 2061 6e64  ll_events()` and
+000105c0: 2060 7375 6273 6372 6962 655f 7374 7265   `subscribe_stre
+000105d0: 616d 5f65 7665 6e74 7328 2960 206d 6574  am_events()` met
+000105e0: 686f 6473 2062 6f74 6820 7265 7475 726e  hods both return
+000105f0: 2061 5c6e 2272 6561 6420 7265 7370 6f6e   a\n"read respon
+00010600: 7365 2220 6974 6572 6174 6f72 2c20 6d75  se" iterator, mu
+00010610: 6368 206c 696b 6520 6069 7465 725f 7374  ch like `iter_st
+00010620: 7265 616d 5f65 7665 6e74 7328 2960 2061  ream_events()` a
+00010630: 6e64 2060 7265 6164 5f61 6c6c 5f65 7665  nd `read_all_eve
+00010640: 6e74 7328 2960 2e5c 6e54 6865 2064 6966  nts()`.\nThe dif
+00010650: 6665 7265 6e63 6520 6973 2074 6865 2022  ference is the "
+00010660: 7265 6164 2072 6573 706f 6e73 6522 2069  read response" i
+00010670: 7465 7261 746f 7220 7265 7475 726e 6564  terator returned
+00010680: 2066 6f72 2061 2063 6174 6368 2d75 7020   for a catch-up 
+00010690: 7375 6273 6372 6970 7469 6f6e 5c6e 646f  subscription\ndo
+000106a0: 6573 206e 6f74 2061 7574 6f6d 6174 6963  es not automatic
+000106b0: 616c 6c79 2073 746f 7020 7768 656e 2074  ally stop when t
+000106c0: 6865 7265 2061 7265 206e 6f20 6d6f 7265  here are no more
+000106d0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000106e0: 2074 6f20 6265 2072 6574 7572 6e65 642c   to be returned,
+000106f0: 2062 7574 5c6e 696e 7374 6561 6420 626c   but\ninstead bl
+00010700: 6f63 6b73 206f 6e20 6765 7474 696e 6720  ocks on getting 
+00010710: 7468 6520 6e65 7874 2065 7665 6e74 2075  the next event u
+00010720: 6e74 696c 2066 7572 7468 6572 2065 7665  ntil further eve
+00010730: 6e74 7320 6172 6520 7265 636f 7264 6564  nts are recorded
+00010740: 2069 6e20 7468 655c 6e64 6174 6162 6173   in the\ndatabas
+00010750: 652e 2054 6865 7365 2073 7562 7365 7175  e. These subsequ
+00010760: 656e 746c 7920 7265 636f 7264 6564 2065  ently recorded e
+00010770: 7665 6e74 7320 7769 6c6c 2074 6865 6e20  vents will then 
+00010780: 6265 2073 7472 6561 6d65 6420 746f 2074  be streamed to t
+00010790: 6865 2069 7465 7261 746f 722c 5c6e 7768  he iterator,\nwh
+000107a0: 6963 6820 7769 6c6c 2074 6865 6e20 636f  ich will then co
+000107b0: 6e74 696e 7565 2e20 4c69 6b65 2060 7265  ntinue. Like `re
+000107c0: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+000107d0: 2c20 7468 6520 7265 7475 726e 6564 2022  , the returned "
+000107e0: 7265 6164 2072 6573 706f 6e73 6522 2068  read response" h
+000107f0: 6173 5c6e 6120 6073 746f 7028 2960 206d  as\na `stop()` m
+00010800: 6574 686f 6420 7768 6963 6820 7769 6c6c  ethod which will
+00010810: 2063 616e 6365 6c20 7468 6520 7374 7265   cancel the stre
+00010820: 616d 696e 6720 6752 5043 206f 7065 7261  aming gRPC opera
+00010830: 7469 6f6e 2061 6e64 2063 6175 7365 2074  tion and cause t
+00010840: 6865 5c6e 2272 6561 6420 7265 7370 6f6e  he\n"read respon
+00010850: 7365 2220 6974 6572 6174 6f72 2074 6f20  se" iterator to 
+00010860: 7374 6f70 2e5c 6e5c 6e4c 696b 6520 7769  stop.\n\nLike wi
+00010870: 7468 2060 7265 6164 5f73 7472 6561 6d5f  th `read_stream_
+00010880: 6576 656e 7473 2829 6020 616e 6420 6072  events()` and `r
+00010890: 6561 645f 616c 6c5f 6576 656e 7473 2829  ead_all_events()
+000108a0: 602c 2074 6865 2072 6563 6f72 6465 6420  `, the recorded 
+000108b0: 6576 656e 7420 6f62 6a65 6374 735c 6e72  event objects\nr
+000108c0: 6563 6569 7665 6420 6672 6f6d 2061 2063  eceived from a c
+000108d0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+000108e0: 7469 6f6e 2061 7265 2069 6e73 7461 6e63  tion are instanc
+000108f0: 6573 206f 6620 7468 6520 6052 6563 6f72  es of the `Recor
+00010900: 6465 6445 7665 6e74 6020 636c 6173 732e  dedEvent` class.
+00010910: 5c6e 5c6e 2323 2320 5375 6273 6372 6962  \n\n### Subscrib
+00010920: 6520 616c 6c20 6576 656e 7473 5c6e 5c6e  e all events\n\n
+00010930: 5468 6560 7375 6273 6372 6962 655f 616c  The`subscribe_al
+00010940: 6c5f 6576 656e 7473 2829 6020 6d65 7468  l_events()` meth
+00010950: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+00010960: 6f20 7374 6172 7420 6120 6361 7463 682d  o start a catch-
+00010970: 7570 2073 7562 7363 7269 7074 696f 6e5c  up subscription\
+00010980: 6e66 726f 6d20 7768 6963 6820 616c 6c20  nfrom which all 
+00010990: 6576 656e 7473 2072 6563 6f72 6465 6420  events recorded 
+000109a0: 696e 2074 6865 2064 6174 6162 6173 6520  in the database 
+000109b0: 6361 6e20 6265 2072 6563 6569 7665 642e  can be received.
+000109c0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+000109d0: 6361 6e20 6265 2075 7365 6420 6279 2061  can be used by a
+000109e0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+000109f0: 6f6e 656e 7420 7468 6174 2070 726f 6365  onent that proce
+00010a00: 7373 6573 2072 6563 6f72 6465 6420 6576  sses recorded ev
+00010a10: 656e 7473 2077 6974 685c 6e65 7861 6374  ents with\nexact
+00010a20: 6c79 2d6f 6e63 6520 7365 6d61 6e74 6963  ly-once semantic
+00010a30: 732e 5c6e 5c6e 5468 6973 206d 6574 686f  s.\n\nThis metho
+00010a40: 6420 7265 7475 726e 7320 6120 2272 6561  d returns a "rea
+00010a50: 6420 7265 7370 6f6e 7365 222c 2066 726f  d response", fro
+00010a60: 6d20 7768 6963 6820 7265 636f 7264 6564  m which recorded
+00010a70: 2065 7665 6e74 7320 6361 6e20 6265 5c6e   events can be\n
+00010a80: 6f62 7461 696e 6564 2062 7920 6974 6572  obtained by iter
+00010a90: 6174 696f 6e2c 2069 6e63 6c75 6469 6e67  ation, including
+00010aa0: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
+00010ab0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
+00010ac0: 616c 6c20 7468 655c 6e72 6563 6f72 6465  all the\nrecorde
+00010ad0: 6420 6576 656e 7473 2068 6176 6520 6265  d events have be
+00010ae0: 656e 2072 6563 6569 7665 642e 2049 7465  en received. Ite
+00010af0: 7261 7469 6e67 206f 7665 7220 7468 6973  rating over this
+00010b00: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+00010b10: 5c6e 6f62 6a65 6374 2077 696c 6c20 7468  \nobject will th
+00010b20: 6572 6566 6f72 6520 6e6f 7420 7374 6f70  erefore not stop
+00010b30: 2c20 756e 6c65 7373 2074 6865 2060 7374  , unless the `st
+00010b40: 6f70 2829 6020 6d65 7468 6f64 206f 6620  op()` method of 
+00010b50: 7468 655c 6e22 7265 6164 2072 6573 706f  the\n"read respo
+00010b60: 6e73 6522 206f 626a 6563 7420 6973 2063  nse" object is c
+00010b70: 616c 6c65 642c 206f 7220 6120 636f 6e6e  alled, or a conn
+00010b80: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
+00010b90: 7572 732c 206f 725c 6e74 6865 2072 6574  urs, or\nthe ret
+00010ba0: 7572 6e65 6420 6f62 6a65 6374 2069 7465  urned object ite
+00010bb0: 7261 746f 7220 6f62 6a65 6374 2069 7320  rator object is 
+00010bc0: 6465 6c65 7465 6420 6672 6f6d 206d 656d  deleted from mem
+00010bd0: 6f72 792e 5c6e 5c6e 5468 6973 206d 6574  ory.\n\nThis met
+00010be0: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+00010bf0: 6e61 6c20 6063 6f6d 6d69 745f 706f 7369  nal `commit_posi
+00010c00: 7469 6f6e 6020 6172 6775 6d65 6e74 2c20  tion` argument, 
+00010c10: 7768 6963 6820 6361 6e20 6265 5c6e 7573  which can be\nus
+00010c20: 6564 2074 6f20 7370 6563 6966 7920 6120  ed to specify a 
+00010c30: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+00010c40: 6672 6f6d 2077 6869 6368 2074 6f20 7375  from which to su
+00010c50: 6273 6372 6962 652e 2054 6865 2064 6566  bscribe. The def
+00010c60: 6175 6c74 5c6e 7661 6c75 6520 6973 2060  ault\nvalue is `
+00010c70: 4e6f 6e65 602c 2077 6869 6368 206d 6561  None`, which mea
+00010c80: 6e73 2074 6865 2073 7562 7363 7269 7074  ns the subscript
+00010c90: 696f 6e20 7769 6c6c 206f 7065 7261 7465  ion will operate
+00010ca0: 2066 726f 6d20 7468 6520 6669 7273 745c   from the first\
+00010cb0: 6e72 6563 6f72 6465 6420 6576 656e 7420  nrecorded event 
+00010cc0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+00010cd0: 2049 6620 6120 636f 6d6d 6974 2070 6f73   If a commit pos
+00010ce0: 6974 696f 6e20 6973 2067 6976 656e 2c20  ition is given, 
+00010cf0: 6974 206d 7573 7420 6d61 7463 685c 6e61  it must match\na
+00010d00: 6e20 6163 7475 616c 6c79 2065 7869 7374  n actually exist
+00010d10: 696e 6720 636f 6d6d 6974 2070 6f73 6974  ing commit posit
+00010d20: 696f 6e20 696e 2074 6865 2064 6174 6162  ion in the datab
+00010d30: 6173 652e 2054 6865 2072 6563 6f64 6564  ase. The recoded
+00010d40: 2065 7665 6e74 7320 7468 6174 5c6e 6172   events that\nar
+00010d50: 6520 6f62 7461 696e 6564 2077 696c 6c20  e obtained will 
+00010d60: 6e6f 7420 696e 636c 7564 6520 7468 6520  not include the 
+00010d70: 6576 656e 7420 7265 636f 7264 6564 2061  event recorded a
+00010d80: 7420 7468 6174 2063 6f6d 6d69 7420 706f  t that commit po
+00010d90: 7369 7469 6f6e 2e5c 6e5c 6e54 6869 7320  sition.\n\nThis 
+00010da0: 6d65 7468 6f64 2061 6c73 6f20 6861 7320  method also has 
+00010db0: 666f 7572 206f 7468 6572 206f 7074 696f  four other optio
+00010dc0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+00010dd0: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+00010de0: 5c6e 6066 696c 7465 725f 696e 636c 7564  \n`filter_includ
+00010df0: 6560 2c20 6066 696c 7465 725f 6279 5f73  e`, `filter_by_s
+00010e00: 7472 6561 6d5f 6e61 6d65 602c 2061 6e64  tream_name`, and
+00010e10: 2060 7469 6d65 6f75 7460 2e5c 6e5c 6e54   `timeout`.\n\nT
+00010e20: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
+00010e30: 7465 725f 6578 636c 7564 6560 2061 7267  ter_exclude` arg
+00010e40: 756d 656e 7420 6973 2061 2073 6571 7565  ument is a seque
+00010e50: 6e63 6520 6f66 2072 6567 756c 6172 2065  nce of regular e
+00010e60: 7870 7265 7373 696f 6e73 2074 6861 745c  xpressions that\
+00010e70: 6e73 7065 6369 6669 6573 2077 6869 6368  nspecifies which
+00010e80: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00010e90: 2073 686f 756c 6420 6265 2072 6574 7572   should be retur
+00010ea0: 6e65 642e 2054 6869 7320 6172 6775 6d65  ned. This argume
+00010eb0: 6e74 2069 7320 6967 6e6f 7265 645c 6e69  nt is ignored\ni
+00010ec0: 6620 6066 696c 7465 725f 696e 636c 7564  f `filter_includ
+00010ed0: 6560 2069 7320 7365 7420 746f 2061 206e  e` is set to a n
+00010ee0: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
+00010ef0: 652e 2054 6865 2064 6566 6175 6c74 2076  e. The default v
+00010f00: 616c 7565 206f 6620 7468 6973 5c6e 6172  alue of this\nar
+00010f10: 6775 6d65 6e74 206d 6174 6368 6573 2074  gument matches t
+00010f20: 6865 2065 7665 6e74 2074 7970 6573 206f  he event types o
+00010f30: 6620 4576 656e 7453 746f 7265 4442 2022  f EventStoreDB "
+00010f40: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
+00010f50: 736f 2074 6861 7420 7379 7374 656d 5c6e  so that system\n
+00010f60: 6576 656e 7473 2077 696c 6c20 6e6f 7420  events will not 
+00010f70: 6e6f 726d 616c 6c79 2062 6520 696e 636c  normally be incl
+00010f80: 7564 6564 2e20 5365 6520 7468 6520 4e6f  uded. See the No
+00010f90: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
+00010fa0: 7720 666f 7220 6d6f 7265 5c6e 696e 666f  w for more\ninfo
+00010fb0: 726d 6174 696f 6e20 6162 6f75 7420 6669  rmation about fi
+00010fc0: 6c74 6572 2065 7870 7265 7373 696f 6e73  lter expressions
+00010fd0: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
+00010fe0: 6c20 6066 696c 7465 725f 696e 636c 7564  l `filter_includ
+00010ff0: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+00011000: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
+00011010: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
+00011020: 5c6e 7468 6174 2073 7065 6369 6669 6573  \nthat specifies
+00011030: 2077 6869 6368 2072 6563 6f72 6465 6420   which recorded 
+00011040: 6576 656e 7473 2073 686f 756c 6420 6265  events should be
+00011050: 2072 6574 7572 6e65 642e 2042 7920 6465   returned. By de
+00011060: 6661 756c 742c 2074 6869 735c 6e61 7267  fault, this\narg
+00011070: 756d 656e 7420 6973 2061 6e20 656d 7074  ument is an empt
+00011080: 7920 7475 706c 652e 2049 6620 7468 6973  y tuple. If this
+00011090: 2061 7267 756d 656e 7420 6973 2073 6574   argument is set
+000110a0: 2074 6f20 6120 6e6f 6e2d 656d 7074 7920   to a non-empty 
+000110b0: 7365 7175 656e 6365 2c5c 6e74 6865 2060  sequence,\nthe `
+000110c0: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
+000110d0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
+000110e0: 7265 642e 5c6e 5c6e 5468 6520 6f70 7469  red.\n\nThe opti
+000110f0: 6f6e 616c 2060 6669 6c74 6572 5f62 795f  onal `filter_by_
+00011100: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+00011110: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00011120: 6e20 6062 6f6f 6c60 2074 6861 7420 696e  n `bool` that in
+00011130: 6469 6361 7465 735c 6e77 6865 7468 6572  dicates\nwhether
+00011140: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
+00011150: 696c 6c20 6170 706c 7920 746f 2065 7665  ill apply to eve
+00011160: 6e74 2074 7970 6573 206f 7220 7374 7265  nt types or stre
+00011170: 616d 206e 616d 6573 2e20 4279 2064 6566  am names. By def
+00011180: 6175 6c74 2c20 7468 6973 5c6e 7661 6c75  ault, this\nvalu
+00011190: 6520 6973 2060 4661 6c73 6560 2061 6e64  e is `False` and
+000111a0: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
+000111b0: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
+000111c0: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
+000111d0: 7472 696e 6773 206f 665c 6e72 6563 6f72  trings of\nrecor
+000111e0: 6465 6420 6576 656e 7473 2e5c 6e5c 6e54  ded events.\n\nT
+000111f0: 6865 206f 7074 696f 6e61 6c20 6074 696d  he optional `tim
+00011200: 656f 7574 6020 6172 6775 6d65 6e74 2069  eout` argument i
+00011210: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+00011220: 7460 2077 6869 6368 2073 6574 7320 615c  t` which sets a\
+00011230: 6e64 6561 646c 696e 6520 666f 7220 7468  ndeadline for th
+00011240: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+00011250: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+00011260: 6f6e 2e5c 6e5c 6e54 6865 2065 7861 6d70  on.\n\nThe examp
+00011270: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
+00011280: 6f77 2074 6f20 7374 6172 7420 6120 6361  ow to start a ca
+00011290: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+000112a0: 696f 6e20 746f 2072 6563 6569 7665 5c6e  ion to receive\n
+000112b0: 6672 6f6d 2074 6865 2066 6972 7374 2072  from the first r
+000112c0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+000112d0: 2074 6865 2064 6174 6162 6173 652e 5c6e   the database.\n
+000112e0: 5c6e 6060 6070 7974 686f 6e5c 6e23 2053  \n```python\n# S
+000112f0: 7562 7363 7269 6265 2066 726f 6d20 7468  ubscribe from th
+00011300: 6520 6669 7273 7420 7265 636f 7264 6564  e first recorded
+00011310: 2065 7665 6e74 2069 6e20 7468 6520 6461   event in the da
+00011320: 7461 6261 7365 2e5c 6e73 7562 7363 7269  tabase.\nsubscri
+00011330: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+00011340: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
+00011350: 6e74 7328 295c 6e60 6060 5c6e 5c6e 5468  nts()\n```\n\nTh
+00011360: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00011370: 6973 206c 6f6e 6765 722c 2061 6e64 2073  is longer, and s
+00011380: 686f 7773 2074 6861 7420 7468 6520 6361  hows that the ca
+00011390: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+000113a0: 696f 6e5c 6e64 6f65 7320 6e6f 7420 7374  ion\ndoes not st
+000113b0: 6f70 2061 7574 6f6d 6174 6963 616c 6c79  op automatically
+000113c0: 2c20 6275 7420 626c 6f63 6b73 2077 6865  , but blocks whe
+000113d0: 6e20 7468 6520 6c61 7374 2072 6563 6f72  n the last recor
+000113e0: 6465 6420 6576 656e 7420 6973 5c6e 7265  ded event is\nre
+000113f0: 6365 6976 6564 2c20 616e 6420 7468 656e  ceived, and then
+00011400: 2063 6f6e 7469 6e75 6573 2077 6865 6e20   continues when 
+00011410: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
+00011420: 7320 6172 6520 7265 636f 7264 6564 2e5c  s are recorded.\
+00011430: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 2320  n\n```python\n# 
+00011440: 4170 7065 6e64 2061 206e 6577 2065 7665  Append a new eve
+00011450: 6e74 2074 6f20 6120 6e65 7720 7374 7265  nt to a new stre
+00011460: 616d 2e5c 6e73 7472 6561 6d5f 6e61 6d65  am.\nstream_name
+00011470: 3220 3d20 7374 7228 7575 6964 2e75 7569  2 = str(uuid.uui
+00011480: 6434 2829 295c 6e65 7665 6e74 3420 3d20  d4())\nevent4 = 
+00011490: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
+000114a0: 4f72 6465 7243 7265 6174 6564 5c27 2c20  OrderCreated\', 
+000114b0: 6461 7461 3d62 5c27 6461 7461 345c 2729  data=b\'data4\')
+000114c0: 5c6e 636c 6965 6e74 2e61 7070 656e 645f  \nclient.append_
+000114d0: 6576 656e 7473 285c 6e20 2020 2073 7472  events(\n    str
+000114e0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+000114f0: 6e61 6d65 322c 5c6e 2020 2020 6375 7272  name2,\n    curr
+00011500: 656e 745f 7665 7273 696f 6e3d 4e6f 6e65  ent_version=None
+00011510: 2c5c 6e20 2020 2065 7665 6e74 733d 5b65  ,\n    events=[e
+00011520: 7665 6e74 345d 2c5c 6e29 5c6e 5c6e 2320  vent4],\n)\n\n# 
+00011530: 5375 6273 6372 6962 6520 6672 6f6d 2074  Subscribe from t
+00011540: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
+00011550: 6420 6576 656e 7420 696e 2074 6865 2064  d event in the d
+00011560: 6174 6162 6173 652e 5c6e 7375 6273 6372  atabase.\nsubscr
+00011570: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00011580: 7375 6273 6372 6962 655f 616c 6c5f 6576  subscribe_all_ev
+00011590: 656e 7473 2829 5c6e 7265 6365 6976 6564  ents()\nreceived
+000115a0: 5f65 7665 6e74 7320 3d20 5b5d 5c6e 5c6e  _events = []\n\n
+000115b0: 5c6e 2320 5265 6365 6976 6520 6576 656e  \n# Receive even
+000115c0: 7473 2066 726f 6d20 7468 6520 6361 7463  ts from the catc
+000115d0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+000115e0: 6e20 696e 2061 2064 6966 6665 7265 6e74  n in a different
+000115f0: 2074 6872 6561 642e 5c6e 6672 6f6d 2064   thread.\nfrom d
+00011600: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
+00011610: 6174 6574 696d 655c 6e66 726f 6d20 7468  atetime\nfrom th
+00011620: 7265 6164 696e 6720 696d 706f 7274 2054  reading import T
+00011630: 6872 6561 645c 6e5c 6e6d 6172 6b20 3d20  hread\n\nmark = 
+00011640: 6461 7465 7469 6d65 2e6e 6f77 2829 5c6e  datetime.now()\n
+00011650: 5c6e 6465 6620 7265 6365 6976 655f 6576  \ndef receive_ev
+00011660: 656e 7473 2829 3a5c 6e20 2020 2066 6f72  ents():\n    for
+00011670: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
+00011680: 6970 7469 6f6e 3a5c 6e20 2020 2020 2020  iption:\n       
+00011690: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+000116a0: 2e61 7070 656e 6428 6576 656e 7429 5c6e  .append(event)\n
+000116b0: 2020 2020 2020 2020 676c 6f62 616c 206d          global m
+000116c0: 6172 6b5c 6e20 2020 2020 2020 206d 6172  ark\n        mar
+000116d0: 6b20 3d20 6461 7465 7469 6d65 2e6e 6f77  k = datetime.now
+000116e0: 2829 5c6e 5c6e 5c6e 6465 6620 7761 6974  ()\n\n\ndef wait
+000116f0: 5f66 6f72 5f73 7562 7363 7269 7074 696f  _for_subscriptio
+00011700: 6e5f 746f 5f62 6c6f 636b 2829 3a5c 6e20  n_to_block():\n 
+00011710: 2020 2077 6869 6c65 2054 7275 653a 5c6e     while True:\n
+00011720: 2020 2020 2020 2020 2069 6620 2864 6174           if (dat
+00011730: 6574 696d 652e 6e6f 7728 2920 2d20 6d61  etime.now() - ma
+00011740: 726b 292e 746f 7461 6c5f 7365 636f 6e64  rk).total_second
+00011750: 7328 2920 3e20 313a 5c6e 2020 2020 2020  s() > 1:\n      
+00011760: 2020 2020 2020 2062 7265 616b 5c6e 5c6e         break\n\n
+00011770: 5c6e 7468 7265 6164 203d 2054 6872 6561  \nthread = Threa
+00011780: 6428 7461 7267 6574 3d72 6563 6569 7665  d(target=receive
+00011790: 5f65 7665 6e74 7329 5c6e 7468 7265 6164  _events)\nthread
+000117a0: 2e73 7461 7274 2829 5c6e 5c6e 2320 5761  .start()\n\n# Wa
+000117b0: 6974 2066 6f72 2074 6865 2073 7562 7363  it for the subsc
+000117c0: 7269 7074 696f 6e20 746f 2062 6c6f 636b  ription to block
+000117d0: 2e5c 6e77 6169 745f 666f 725f 7375 6273  .\nwait_for_subs
+000117e0: 6372 6970 7469 6f6e 5f74 6f5f 626c 6f63  cription_to_bloc
+000117f0: 6b28 295c 6e5c 6e23 2043 6865 636b 2074  k()\n\n# Check t
+00011800: 6865 206c 6173 7420 7265 6365 6976 6564  he last received
+00011810: 2065 7665 6e74 2069 7320 5c27 6576 656e   event is \'even
+00011820: 7434 5c27 2e5c 6e61 7373 6572 7420 7265  t4\'.\nassert re
+00011830: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
+00011840: 5d2e 6964 203d 3d20 6576 656e 7434 2e69  ].id == event4.i
+00011850: 645c 6e5c 6e23 2043 6865 636b 2077 6520  d\n\n# Check we 
+00011860: 616c 736f 2072 6563 6569 7665 6420 7468  also received th
+00011870: 6520 6f74 6865 7220 6576 656e 7473 2077  e other events w
+00011880: 6520 6861 7665 2072 6563 6f72 6465 642e  e have recorded.
+00011890: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
+000118a0: 645f 6576 656e 7473 5b2d 395d 2e69 6420  d_events[-9].id 
+000118b0: 3d3d 2065 7665 6e74 312e 6964 5c6e 6173  == event1.id\nas
+000118c0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+000118d0: 656e 7473 5b2d 385d 2e69 6420 3d3d 2065  ents[-8].id == e
+000118e0: 7665 6e74 322e 6964 5c6e 6173 7365 7274  vent2.id\nassert
+000118f0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+00011900: 5b2d 375d 2e69 6420 3d3d 2065 7665 6e74  [-7].id == event
+00011910: 332e 6964 5c6e 6173 7365 7274 2072 6563  3.id\nassert rec
+00011920: 6569 7665 645f 6576 656e 7473 5b2d 365d  eived_events[-6]
+00011930: 2e74 7970 6520 3d3d 2022 446f 6752 6567  .type == "DogReg
+00011940: 6973 7465 7265 6422 5c6e 6173 7365 7274  istered"\nassert
+00011950: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+00011960: 5b2d 355d 2e74 7970 6520 3d3d 2022 446f  [-5].type == "Do
+00011970: 674c 6561 726e 6564 5472 6963 6b22 5c6e  gLearnedTrick"\n
+00011980: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+00011990: 6576 656e 7473 5b2d 345d 2e74 7970 6520  events[-4].type 
+000119a0: 3d3d 2022 446f 674c 6561 726e 6564 5472  == "DogLearnedTr
+000119b0: 6963 6b22 5c6e 6173 7365 7274 2072 6563  ick"\nassert rec
+000119c0: 6569 7665 645f 6576 656e 7473 5b2d 335d  eived_events[-3]
+000119d0: 2e74 7970 6520 3d3d 2022 536e 6170 7368  .type == "Snapsh
+000119e0: 6f74 225c 6e61 7373 6572 7420 7265 6365  ot"\nassert rece
+000119f0: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
+00011a00: 7479 7065 203d 3d20 2244 6f67 4c65 6172  type == "DogLear
+00011a10: 6e65 6454 7269 636b 225c 6e5c 6e23 2041  nedTrick"\n\n# A
+00011a20: 7070 656e 6420 616e 6f74 6865 7220 6576  ppend another ev
+00011a30: 656e 7420 7768 696c 7374 2074 6865 2073  ent whilst the s
+00011a40: 7562 7363 7269 7074 696f 6e20 6973 2072  ubscription is r
+00011a50: 756e 6e69 6e67 2e5c 6e6d 6172 6b20 3d20  unning.\nmark = 
+00011a60: 6461 7465 7469 6d65 2e6e 6f77 2829 5c6e  datetime.now()\n
+00011a70: 6576 656e 7435 203d 204e 6577 4576 656e  event5 = NewEven
+00011a80: 7428 7479 7065 3d5c 274f 7264 6572 5570  t(type=\'OrderUp
+00011a90: 6461 7465 645c 272c 2064 6174 613d 625c  dated\', data=b\
+00011aa0: 2764 6174 6135 5c27 295c 6e63 6c69 656e  'data5\')\nclien
+00011ab0: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+00011ac0: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
+00011ad0: 653d 7374 7265 616d 5f6e 616d 6532 2c5c  e=stream_name2,\
+00011ae0: 6e20 2020 2063 7572 7265 6e74 5f76 6572  n    current_ver
+00011af0: 7369 6f6e 3d30 2c5c 6e20 2020 2065 7665  sion=0,\n    eve
+00011b00: 6e74 733d 5b65 7665 6e74 355d 2c5c 6e29  nts=[event5],\n)
+00011b10: 5c6e 5c6e 2320 5761 6974 2066 6f72 2074  \n\n# Wait for t
+00011b20: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00011b30: 746f 2062 6c6f 636b 2e5c 6e77 6169 745f  to block.\nwait_
+00011b40: 666f 725f 7375 6273 6372 6970 7469 6f6e  for_subscription
+00011b50: 5f74 6f5f 626c 6f63 6b28 295c 6e5c 6e23  _to_block()\n\n#
+00011b60: 2043 6865 636b 2074 6865 206c 6173 7420   Check the last 
+00011b70: 7265 6365 6976 6564 2065 7665 6e74 2069  received event i
+00011b80: 7320 5c27 6576 656e 7435 5c27 2e5c 6e61  s \'event5\'.\na
+00011b90: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+00011ba0: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
+00011bb0: 6576 656e 7434 2e69 645c 6e61 7373 6572  event4.id\nasser
+00011bc0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00011bd0: 735b 2d31 5d2e 6964 203d 3d20 6576 656e  s[-1].id == even
+00011be0: 7435 2e69 645c 6e5c 6e23 2053 746f 7020  t5.id\n\n# Stop 
+00011bf0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00011c00: 2e5c 6e73 7562 7363 7269 7074 696f 6e2e  .\nsubscription.
+00011c10: 7374 6f70 2829 5c6e 7468 7265 6164 2e6a  stop()\nthread.j
+00011c20: 6f69 6e28 295c 6e60 6060 5c6e 5c6e 5468  oin()\n```\n\nTh
+00011c30: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00011c40: 7368 6f77 7320 686f 7720 746f 2073 7461  shows how to sta
+00011c50: 7274 2061 2063 6174 6368 2d75 7020 7375  rt a catch-up su
+00011c60: 6273 6372 6970 7469 6f6e 2074 6f5c 6e72  bscription to\nr
+00011c70: 6563 6569 7665 2066 726f 6d20 6120 7061  eceive from a pa
+00011c80: 7274 6963 756c 6172 2063 6f6d 6d69 7420  rticular commit 
+00011c90: 706f 7369 7469 6f6e 2c20 696e 2074 6869  position, in thi
+00011ca0: 7320 6361 7365 2066 726f 6d20 7468 655c  s case from the\
+00011cb0: 6e63 6f6d 6d69 7420 706f 7369 7469 6f6e  ncommit position
+00011cc0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
+00011cd0: 6f72 6465 6420 6576 656e 7420 7468 6174  orded event that
+00011ce0: 2077 6173 2072 6563 6569 7665 6420 6162   was received ab
+00011cf0: 6f76 652e 5c6e 416e 6f74 6865 7220 6576  ove.\nAnother ev
+00011d00: 656e 7420 6973 2072 6563 6f72 6465 6420  ent is recorded 
+00011d10: 6265 666f 7265 2074 6865 2073 7562 7363  before the subsc
+00011d20: 7269 7074 696f 6e20 6973 2072 6573 7461  ription is resta
+00011d30: 7274 6564 2e5c 6e46 7572 7468 6572 2065  rted.\nFurther e
+00011d40: 7665 6e74 7320 6172 6520 7265 636f 7264  vents are record
+00011d50: 6564 2077 6869 6c73 7420 7468 6520 7375  ed whilst the su
+00011d60: 6273 6372 6970 7469 6f6e 2069 7320 7275  bscription is ru
+00011d70: 6e6e 696e 672e 5c6e 416c 6c20 7468 6520  nning.\nAll the 
+00011d80: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00011d90: 6172 6520 7265 6365 6976 6564 2065 7861  are received exa
+00011da0: 6374 6c79 206f 6e63 652e 5c6e 5c6e 6060  ctly once.\n\n``
+00011db0: 6070 7974 686f 6e5c 6e5c 6e23 2041 7070  `python\n\n# App
+00011dc0: 656e 6420 616e 6f74 6865 7220 6576 656e  end another even
+00011dd0: 742e 5c6e 6576 656e 7436 203d 204e 6577  t.\nevent6 = New
+00011de0: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
+00011df0: 6572 4465 6c65 7465 645c 272c 2064 6174  erDeleted\', dat
+00011e00: 613d 625c 2764 6174 6136 5c27 295c 6e63  a=b\'data6\')\nc
+00011e10: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00011e20: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
+00011e30: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00011e40: 6532 2c5c 6e20 2020 2063 7572 7265 6e74  e2,\n    current
+00011e50: 5f76 6572 7369 6f6e 3d31 2c5c 6e20 2020  _version=1,\n   
+00011e60: 2065 7665 6e74 733d 5b65 7665 6e74 365d   events=[event6]
+00011e70: 2c5c 6e29 5c6e 5c6e 2320 5265 7375 6d65  ,\n)\n\n# Resume
+00011e80: 2073 7562 7363 7269 6269 6e67 2066 726f   subscribing fro
+00011e90: 6d20 7468 6520 636f 6d6d 6974 2070 6f73  m the commit pos
+00011ea0: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
+00011eb0: 7420 7265 6365 6976 6564 2065 7665 6e74  t received event
+00011ec0: 2e5c 6e73 7562 7363 7269 7074 696f 6e20  .\nsubscription 
+00011ed0: 3d20 636c 6965 6e74 2e73 7562 7363 7269  = client.subscri
+00011ee0: 6265 5f61 6c6c 5f65 7665 6e74 7328 5c6e  be_all_events(\n
+00011ef0: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
+00011f00: 696f 6e3d 7265 6365 6976 6564 5f65 7665  ion=received_eve
+00011f10: 6e74 735b 2d31 5d2e 636f 6d6d 6974 5f70  nts[-1].commit_p
+00011f20: 6f73 6974 696f 6e5c 6e29 5c6e 5c6e 6d61  osition\n)\n\nma
+00011f30: 726b 203d 2064 6174 6574 696d 652e 6e6f  rk = datetime.no
+00011f40: 7728 295c 6e74 6872 6561 6420 3d20 5468  w()\nthread = Th
+00011f50: 7265 6164 2874 6172 6765 743d 7265 6365  read(target=rece
+00011f60: 6976 655f 6576 656e 7473 295c 6e74 6872  ive_events)\nthr
+00011f70: 6561 642e 7374 6172 7428 295c 6e5c 6e23  ead.start()\n\n#
+00011f80: 2057 6169 7420 666f 7220 7468 6520 7375   Wait for the su
+00011f90: 6273 6372 6970 7469 6f6e 2074 6f20 626c  bscription to bl
+00011fa0: 6f63 6b2e 5c6e 7761 6974 5f66 6f72 5f73  ock.\nwait_for_s
+00011fb0: 7562 7363 7269 7074 696f 6e5f 746f 5f62  ubscription_to_b
+00011fc0: 6c6f 636b 2829 5c6e 5c6e 2320 4368 6563  lock()\n\n# Chec
+00011fd0: 6b20 7468 6520 6c61 7374 2072 6563 6569  k the last recei
+00011fe0: 7665 6420 6576 656e 7420 7761 7320 5c27  ved event was \'
+00011ff0: 6576 656e 7436 5c27 2e5c 6e61 7373 6572  event6\'.\nasser
+00012000: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00012010: 735b 2d33 5d2e 6964 203d 3d20 6576 656e  s[-3].id == even
+00012020: 7434 2e69 645c 6e61 7373 6572 7420 7265  t4.id\nassert re
+00012030: 6365 6976 6564 5f65 7665 6e74 735b 2d32  ceived_events[-2
+00012040: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
+00012050: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
+00012060: 6564 5f65 7665 6e74 735b 2d31 5d2e 6964  ed_events[-1].id
+00012070: 203d 3d20 6576 656e 7436 2e69 645c 6e5c   == event6.id\n\
+00012080: 6e23 2041 7070 656e 6420 7468 7265 6520  n# Append three 
+00012090: 6d6f 7265 2065 7665 6e74 7320 746f 2061  more events to a
+000120a0: 206e 6577 2073 7472 6561 6d2e 5c6e 6d61   new stream.\nma
+000120b0: 726b 203d 2064 6174 6574 696d 652e 6e6f  rk = datetime.no
+000120c0: 7728 295c 6e73 7472 6561 6d5f 6e61 6d65  w()\nstream_name
+000120d0: 3320 3d20 7374 7228 7575 6964 2e75 7569  3 = str(uuid.uui
+000120e0: 6434 2829 295c 6e65 7665 6e74 3720 3d20  d4())\nevent7 = 
+000120f0: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
+00012100: 4f72 6465 7243 7265 6174 6564 5c27 2c20  OrderCreated\', 
+00012110: 6461 7461 3d62 5c27 6461 7461 375c 2729  data=b\'data7\')
+00012120: 5c6e 6576 656e 7438 203d 204e 6577 4576  \nevent8 = NewEv
+00012130: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+00012140: 5570 6461 7465 645c 272c 2064 6174 613d  Updated\', data=
+00012150: 625c 2764 6174 6138 5c27 295c 6e65 7665  b\'data8\')\neve
+00012160: 6e74 3920 3d20 4e65 7745 7665 6e74 2874  nt9 = NewEvent(t
+00012170: 7970 653d 5c27 4f72 6465 7244 656c 6574  ype=\'OrderDelet
+00012180: 6564 5c27 2c20 6461 7461 3d62 5c27 6461  ed\', data=b\'da
+00012190: 7461 395c 2729 5c6e 5c6e 636c 6965 6e74  ta9\')\n\nclient
+000121a0: 2e61 7070 656e 645f 6576 656e 7473 285c  .append_events(\
+000121b0: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
+000121c0: 3d73 7472 6561 6d5f 6e61 6d65 332c 5c6e  =stream_name3,\n
+000121d0: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+000121e0: 696f 6e3d 4e6f 6e65 2c5c 6e20 2020 2065  ion=None,\n    e
+000121f0: 7665 6e74 733d 5b65 7665 6e74 372c 2065  vents=[event7, e
+00012200: 7665 6e74 382c 2065 7665 6e74 395d 2c5c  vent8, event9],\
+00012210: 6e29 5c6e 5c6e 2320 5761 6974 2066 6f72  n)\n\n# Wait for
+00012220: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00012230: 6e20 746f 2062 6c6f 636b 2e5c 6e77 6169  n to block.\nwai
+00012240: 745f 666f 725f 7375 6273 6372 6970 7469  t_for_subscripti
+00012250: 6f6e 5f74 6f5f 626c 6f63 6b28 295c 6e5c  on_to_block()\n\
+00012260: 6e5c 6e23 2043 6865 636b 2061 6c6c 2074  n\n# Check all t
+00012270: 6865 2065 7665 6e74 7320 6861 7665 2062  he events have b
+00012280: 6565 6e20 7265 6365 6976 6564 2065 7861  een received exa
+00012290: 6374 6c79 206f 6e63 652e 5c6e 6173 7365  ctly once.\nasse
+000122a0: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+000122b0: 7473 5b2d 365d 2e69 6420 3d3d 2065 7665  ts[-6].id == eve
+000122c0: 6e74 342e 6964 5c6e 6173 7365 7274 2072  nt4.id\nassert r
+000122d0: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+000122e0: 355d 2e69 6420 3d3d 2065 7665 6e74 352e  5].id == event5.
+000122f0: 6964 5c6e 6173 7365 7274 2072 6563 6569  id\nassert recei
+00012300: 7665 645f 6576 656e 7473 5b2d 345d 2e69  ved_events[-4].i
+00012310: 6420 3d3d 2065 7665 6e74 362e 6964 5c6e  d == event6.id\n
+00012320: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+00012330: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
+00012340: 2065 7665 6e74 372e 6964 5c6e 6173 7365   event7.id\nasse
+00012350: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+00012360: 7473 5b2d 325d 2e69 6420 3d3d 2065 7665  ts[-2].id == eve
+00012370: 6e74 382e 6964 5c6e 6173 7365 7274 2072  nt8.id\nassert r
+00012380: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+00012390: 315d 2e69 6420 3d3d 2065 7665 6e74 392e  1].id == event9.
+000123a0: 6964 5c6e 5c6e 2320 5374 6f70 2074 6865  id\n\n# Stop the
+000123b0: 2073 7562 7363 7269 7074 696f 6e2e 5c6e   subscription.\n
+000123c0: 7375 6273 6372 6970 7469 6f6e 2e73 746f  subscription.sto
+000123d0: 7028 295c 6e74 6872 6561 642e 6a6f 696e  p()\nthread.join
+000123e0: 2829 5c6e 6060 605c 6e5c 6e54 6865 2063  ()\n```\n\nThe c
+000123f0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00012400: 7469 6f6e 2063 616c 6c20 6973 2065 6e64  tion call is end
+00012410: 6564 2061 7320 736f 6f6e 2061 7320 7468  ed as soon as th
+00012420: 6520 7375 6273 6372 6970 7469 6f6e 206f  e subscription o
+00012430: 626a 6563 745c 2773 5c6e 6073 746f 7028  bject\'s\n`stop(
+00012440: 2960 206d 6574 686f 6420 6973 2063 616c  )` method is cal
+00012450: 6c65 642e 2054 6869 7320 6861 7070 656e  led. This happen
+00012460: 7320 6175 746f 6d61 7469 6361 6c6c 7920  s automatically 
+00012470: 7768 656e 2069 7420 676f 6573 206f 7574  when it goes out
+00012480: 206f 6620 7363 6f70 652c 5c6e 6f72 2077   of scope,\nor w
+00012490: 6865 6e20 6974 2069 7320 6578 706c 6963  hen it is explic
+000124a0: 6974 6c79 2064 656c 6574 6564 2066 726f  itly deleted fro
+000124b0: 6d20 6d65 6d6f 7279 2075 7369 6e67 2074  m memory using t
+000124c0: 6865 2050 7974 686f 6e20 6064 656c 6020  he Python `del` 
+000124d0: 6b65 7977 6f72 642e 5c6e 5c6e 2323 2320  keyword.\n\n### 
+000124e0: 5375 6273 6372 6962 6520 7374 7265 616d  Subscribe stream
+000124f0: 2065 7665 6e74 735c 6e5c 6e54 6865 2060   events\n\nThe `
+00012500: 7375 6273 6372 6962 655f 7374 7265 616d  subscribe_stream
+00012510: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+00012520: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+00012530: 2073 7461 7274 2061 2063 6174 6368 2d75   start a catch-u
+00012540: 7020 7375 6273 6372 6970 7469 6f6e 5c6e  p subscription\n
+00012550: 7468 6174 2063 616e 2072 6574 7572 6e20  that can return 
+00012560: 6576 656e 7473 2074 6861 7420 6172 6520  events that are 
+00012570: 7265 636f 7264 6564 2069 6e20 6120 7369  recorded in a si
+00012580: 6e67 6c65 2073 7472 6561 6d2e 5c6e 5c6e  ngle stream.\n\n
+00012590: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+000125a0: 6120 7265 7175 6972 6564 2060 7374 7265  a required `stre
+000125b0: 616d 5f6e 616d 6560 2061 7267 756d 656e  am_name` argumen
+000125c0: 742c 2077 6869 6368 2073 7065 6369 6669  t, which specifi
+000125d0: 6573 2074 6865 206e 616d 6520 6f66 2074  es the name of t
+000125e0: 6865 5c6e 7374 7265 616d 2066 726f 6d20  he\nstream from 
+000125f0: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
+00012600: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
+00012610: 6365 6976 6564 2e5c 6e5c 6e54 6869 7320  ceived.\n\nThis 
+00012620: 6d65 7468 6f64 2061 6c73 6f20 6861 7320  method also has 
+00012630: 7477 6f20 6f70 7469 6f6e 616c 2061 7267  two optional arg
+00012640: 756d 656e 7473 2c20 6073 7472 6561 6d5f  uments, `stream_
+00012650: 706f 7369 7469 6f6e 602c 2061 6e64 2060  position`, and `
+00012660: 7469 6d65 6f75 7460 2e5c 6e5c 6e54 6865  timeout`.\n\nThe
+00012670: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
+00012680: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
+00012690: 6d65 6e74 2073 7065 6369 6669 6573 2061  ment specifies a
+000126a0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+000126b0: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
+000126c0: 6368 5c6e 7265 636f 7264 6564 2065 7665  ch\nrecorded eve
+000126d0: 6e74 7320 7769 6c6c 2062 6520 7265 6365  nts will be rece
+000126e0: 6976 6564 2e20 5468 6520 6576 656e 7420  ived. The event 
+000126f0: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
+00012700: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00012710: 2077 696c 6c20 6e6f 745c 6e62 6520 696e   will not\nbe in
+00012720: 636c 7564 6564 2e20 5468 6520 6465 6661  cluded. The defa
+00012730: 756c 7420 7661 6c75 6520 6f66 2060 7374  ult value of `st
+00012740: 7265 616d 5f70 6f73 6974 696f 6e60 2069  ream_position` i
+00012750: 7320 604e 6f6e 6560 2c20 7768 6963 6820  s `None`, which 
+00012760: 6d65 616e 7320 7468 655c 6e73 7562 7363  means the\nsubsc
+00012770: 7269 7074 696f 6e20 7769 6c6c 2073 7461  ription will sta
+00012780: 7274 2066 726f 6d20 7468 6520 6669 7273  rt from the firs
+00012790: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+000127a0: 2069 6e20 7468 6520 7374 7265 616d 2e5c   in the stream.\
+000127b0: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
+000127c0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+000127d0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+000127e0: 666c 6f61 7460 2074 6861 7420 7365 7473  float` that sets
+000127f0: 5c6e 6120 6465 6164 6c69 6e65 2066 6f72  \na deadline for
+00012800: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00012810: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00012820: 6174 696f 6e2e 5c6e 5c6e 5468 6520 6578  ation.\n\nThe ex
+00012830: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+00012840: 7320 686f 7720 746f 2073 7461 7274 2061  s how to start a
+00012850: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+00012860: 6970 7469 6f6e 2066 726f 6d5c 6e74 6865  iption from\nthe
+00012870: 2066 6972 7374 2072 6563 6f72 6465 6420   first recorded 
+00012880: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
+00012890: 6d2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  m.\n\n```python\
+000128a0: 6e23 2053 7562 7363 7269 6265 2066 726f  n# Subscribe fro
+000128b0: 6d20 7468 6520 7374 6172 7420 6f66 205c  m the start of \
+000128c0: 2773 7472 6561 6d32 5c27 2e5c 6e73 7562  'stream2\'.\nsub
+000128d0: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
+000128e0: 6e74 2e73 7562 7363 7269 6265 5f73 7472  nt.subscribe_str
+000128f0: 6561 6d5f 6576 656e 7473 2873 7472 6561  eam_events(strea
+00012900: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00012910: 6d65 3229 5c6e 6060 605c 6e5c 6e54 6865  me2)\n```\n\nThe
+00012920: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00012930: 686f 7773 2068 6f77 2074 6f20 7374 6172  hows how to star
+00012940: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
+00012950: 7363 7269 7074 696f 6e20 6672 6f6d 5c6e  scription from\n
+00012960: 6120 7061 7274 6963 756c 6172 2073 7472  a particular str
+00012970: 6561 6d20 706f 7369 7469 6f6e 2e5c 6e5c  eam position.\n\
+00012980: 6e60 6060 7079 7468 6f6e 5c6e 2320 5375  n```python\n# Su
+00012990: 6273 6372 6962 6520 746f 2073 7472 6561  bscribe to strea
+000129a0: 6d32 2c20 6672 6f6d 2074 6865 2073 6563  m2, from the sec
+000129b0: 6f6e 6420 7265 636f 7264 6564 2065 7665  ond recorded eve
+000129c0: 6e74 2e5c 6e73 7562 7363 7269 7074 696f  nt.\nsubscriptio
+000129d0: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
+000129e0: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
+000129f0: 7473 285c 6e20 2020 2073 7472 6561 6d5f  ts(\n    stream_
+00012a00: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00012a10: 322c 5c6e 2020 2020 7374 7265 616d 5f70  2,\n    stream_p
+00012a20: 6f73 6974 696f 6e3d 312c 5c6e 295c 6e60  osition=1,\n)\n`
+00012a30: 6060 5c6e 5c6e 2323 2320 486f 7720 746f  ``\n\n### How to
+00012a40: 2069 6d70 6c65 6d65 6e74 2065 7861 6374   implement exact
+00012a50: 6c79 2d6f 6e63 6520 6576 656e 7420 7072  ly-once event pr
+00012a60: 6f63 6573 7369 6e67 5c6e 5c6e 5468 6520  ocessing\n\nThe 
+00012a70: 636f 6d6d 6974 2070 6f73 6974 696f 6e73  commit positions
+00012a80: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
+00012a90: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
+00012aa0: 6569 7665 6420 616e 6420 7072 6f63 6573  eived and proces
+00012ab0: 7365 6420 6279 2061 5c6e 646f 776e 7374  sed by a\ndownst
+00012ac0: 7265 616d 2063 6f6d 706f 6e65 6e74 2061  ream component a
+00012ad0: 7265 2075 7365 6675 6c6c 7920 7265 636f  re usefully reco
+00012ae0: 7264 6564 2062 7920 7468 6520 646f 776e  rded by the down
+00012af0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+00012b00: 2c20 736f 2074 6861 745c 6e74 6865 2063  , so that\nthe c
+00012b10: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
+00012b20: 6620 6c61 7374 2070 726f 6365 7373 6564  f last processed
+00012b30: 2065 7665 6e74 2063 616e 2062 6520 6465   event can be de
+00012b40: 7465 726d 696e 6564 2077 6865 6e20 7072  termined when pr
+00012b50: 6f63 6573 7369 6e67 2069 735c 6e72 6573  ocessing is\nres
+00012b60: 756d 6564 2e5c 6e5c 6e54 6865 206c 6173  umed.\n\nThe las
+00012b70: 7420 7265 636f 7264 6564 2063 6f6d 6d69  t recorded commi
+00012b80: 7420 706f 7369 7469 6f6e 2063 616e 2062  t position can b
+00012b90: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+00012ba0: 7920 7468 6520 636f 6d6d 6974 2070 6f73  y the commit pos
+00012bb0: 6974 696f 6e20 6672 6f6d 2077 6869 6368  ition from which
+00012bc0: 5c6e 746f 2073 7562 7363 7269 6265 2077  \nto subscribe w
+00012bd0: 6865 6e20 7072 6f63 6573 7369 6e67 2069  hen processing i
+00012be0: 7320 7265 7375 6d65 642e 2053 696e 6365  s resumed. Since
+00012bf0: 2074 6869 7320 636f 6d6d 6974 2070 6f73   this commit pos
+00012c00: 6974 696f 6e20 7769 6c6c 2072 6570 7265  ition will repre
+00012c10: 7365 6e74 2074 6865 5c6e 706f 7369 7469  sent the\npositi
+00012c20: 6f6e 206f 6620 7468 6520 6c61 7374 2073  on of the last s
+00012c30: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
+00012c40: 6573 7365 6420 6576 656e 7420 696e 2061  essed event in a
+00012c50: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+00012c60: 6f6e 656e 742c 2073 6f20 6974 5c6e 7769  onent, so it\nwi
+00012c70: 6c6c 2062 6520 7573 7561 6c20 746f 2077  ll be usual to w
+00012c80: 616e 7420 7468 6520 6e65 7874 2065 7665  ant the next eve
+00012c90: 6e74 2061 6674 6572 2074 6869 7320 706f  nt after this po
+00012ca0: 7369 7469 6f6e 2c20 6265 6361 7573 6520  sition, because 
+00012cb0: 7468 6174 2069 7320 7468 6520 6e65 7874  that is the next
+00012cc0: 5c6e 6576 656e 7420 7468 6174 2068 6173  \nevent that has
+00012cd0: 206e 6f74 2079 6574 2062 6565 6e20 7072   not yet been pr
+00012ce0: 6f63 6573 7365 642e 2046 6f72 2074 6869  ocessed. For thi
+00012cf0: 7320 7265 6173 6f6e 2c20 7768 656e 2073  s reason, when s
+00012d00: 7562 7363 7269 6269 6e67 2066 6f72 2065  ubscribing for e
+00012d10: 7665 6e74 735c 6e66 726f 6d20 6120 7370  vents\nfrom a sp
+00012d20: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
+00012d30: 7369 7469 6f6e 2075 7369 6e67 2061 2063  sition using a c
+00012d40: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00012d50: 7469 6f6e 2069 6e20 4576 656e 7453 746f  tion in EventSto
+00012d60: 7265 4442 2c20 7468 655c 6e72 6563 6f72  reDB, the\nrecor
+00012d70: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
+00012d80: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+00012d90: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+00012da0: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
+00012db0: 696e 2074 6865 2073 6571 7565 6e63 655c  in the sequence\
+00012dc0: 6e6f 6620 7265 636f 7264 6564 2065 7665  nof recorded eve
+00012dd0: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
+00012de0: 6569 7665 642e 5c6e 5c6e 546f 2061 6363  eived.\n\nTo acc
+00012df0: 6f6d 706c 6973 6820 2265 7861 6374 6c79  omplish "exactly
+00012e00: 2d6f 6e63 6522 2070 726f 6365 7373 696e  -once" processin
+00012e10: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
+00012e20: 656e 7473 2069 6e20 6120 646f 776e 7374  ents in a downst
+00012e30: 7265 616d 5c6e 636f 6d70 6f6e 656e 7420  ream\ncomponent 
+00012e40: 7768 656e 2075 7369 6e67 2061 2063 6174  when using a cat
+00012e50: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00012e60: 6f6e 2c20 7468 6520 636f 6d6d 6974 2070  on, the commit p
+00012e70: 6f73 6974 696f 6e20 6f66 2061 2072 6563  osition of a rec
+00012e80: 6f72 6465 645c 6e65 7665 6e74 2073 686f  orded\nevent sho
+00012e90: 756c 6420 6265 2072 6563 6f72 6465 6420  uld be recorded 
+00012ea0: 6174 6f6d 6963 616c 6c79 2061 6e64 2075  atomically and u
+00012eb0: 6e69 7175 656c 7920 616c 6f6e 6720 7769  niquely along wi
+00012ec0: 7468 2074 6865 2072 6573 756c 7420 6f66  th the result of
+00012ed0: 2070 726f 6365 7373 696e 675c 6e72 6563   processing\nrec
+00012ee0: 6f72 6465 6420 6576 656e 7473 2c20 666f  orded events, fo
+00012ef0: 7220 6578 616d 706c 6520 696e 2074 6865  r example in the
+00012f00: 2073 616d 6520 6461 7461 6261 7365 2061   same database a
+00012f10: 7320 6d61 7465 7269 616c 6973 6564 2076  s materialised v
+00012f20: 6965 7773 2077 6865 6e5c 6e69 6d70 6c65  iews when\nimple
+00012f30: 6d65 6e74 696e 6720 6576 656e 7475 616c  menting eventual
+00012f40: 6c79 2d63 6f6e 7369 7374 656e 7420 4351  ly-consistent CQ
+00012f50: 5253 2c20 6f72 2069 6e20 7468 6520 7361  RS, or in the sa
+00012f60: 6d65 2064 6174 6162 6173 6520 6173 2061  me database as a
+00012f70: 2064 6f77 6e73 7472 6561 6d5c 6e61 6e61   downstream\nana
+00012f80: 6c79 7469 6373 206f 7220 7265 706f 7274  lytics or report
+00012f90: 696e 6720 6f72 2061 7263 6869 7669 6e67  ing or archiving
+00012fa0: 2061 7070 6c69 6361 7469 6f6e 2e20 4279   application. By
+00012fb0: 2072 6563 6f72 6469 6e67 2074 6865 2063   recording the c
+00012fc0: 6f6d 6d69 7420 706f 7369 7469 6f6e 5c6e  ommit position\n
+00012fd0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+00012fe0: 7473 2061 746f 6d69 6361 6c6c 7920 7769  ts atomically wi
+00012ff0: 7468 2074 6865 206e 6577 2073 7461 7465  th the new state
+00013000: 2074 6861 7420 7265 7375 6c74 7320 6672   that results fr
+00013010: 6f6d 2070 726f 6365 7373 696e 675c 6e72  om processing\nr
+00013020: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
+00013030: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
+00013040: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
+00013050: 6e20 6f66 2072 6563 6f72 6465 6420 6576  n of recorded ev
+00013060: 656e 7473 2063 616e 2062 655c 6e61 766f  ents can be\navo
+00013070: 6964 6564 2e20 4279 2061 6c73 6f20 7265  ided. By also re
+00013080: 636f 7264 696e 6720 7468 6520 636f 6d6d  cording the comm
+00013090: 6974 2070 6f73 6974 696f 6e20 756e 6971  it position uniq
+000130a0: 7565 6c79 2c20 7468 6520 6e65 7720 7374  uely, the new st
+000130b0: 6174 6520 6361 6e6e 6f74 2062 655c 6e72  ate cannot be\nr
+000130c0: 6563 6f72 6465 6420 7477 6963 652c 2061  ecorded twice, a
+000130d0: 6e64 2068 656e 6365 2074 6865 2072 6563  nd hence the rec
+000130e0: 6f72 6465 6420 7374 6174 6520 6f66 2074  orded state of t
+000130f0: 6865 2064 6f77 6e73 7472 6561 6d20 636f  he downstream co
+00013100: 6d70 6f6e 656e 7420 7769 6c6c 2062 655c  mponent will be\
+00013110: 6e75 7064 6174 6564 206f 6e6c 7920 6f6e  nupdated only on
+00013120: 6365 2066 6f72 2061 6e79 2072 6563 6f72  ce for any recor
+00013130: 6465 6420 6576 656e 742e 2042 7920 7573  ded event. By us
+00013140: 696e 6720 7468 6520 6772 6561 7465 7374  ing the greatest
+00013150: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+00013160: 5c6e 706f 7369 7469 6f6e 2074 6f20 7265  \nposition to re
+00013170: 7375 6d65 2061 2063 6174 6368 2d75 7020  sume a catch-up 
+00013180: 7375 6273 6372 6970 7469 6f6e 2c20 616c  subscription, al
+00013190: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
+000131a0: 7320 7769 6c6c 2065 7665 6e74 7561 6c6c  s will eventuall
+000131b0: 795c 6e62 6520 7072 6f63 6573 7365 642e  y\nbe processed.
+000131c0: 2054 6865 2063 6f6d 6269 6e61 7469 6f6e   The combination
+000131d0: 206f 6620 7468 6520 2261 742d 6d6f 7374   of the "at-most
+000131e0: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
+000131f0: 2061 6e64 2074 6865 2022 6174 2d6c 6561   and the "at-lea
+00013200: 7374 2d6f 6e63 6522 5c6e 636f 6e64 6974  st-once"\ncondit
+00013210: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
+00013220: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
+00013230: 6469 7469 6f6e 2e5c 6e5c 6e54 6865 2064  dition.\n\nThe d
+00013240: 616e 6765 7220 7769 7468 2022 6475 616c  anger with "dual
+00013250: 2077 7269 7469 6e67 2220 696e 2074 6865   writing" in the
+00013260: 2063 6f6e 7375 6d70 7469 6f6e 206f 6620   consumption of 
+00013270: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00013280: 6973 2074 6861 7420 6966 2061 5c6e 7265  is that if a\nre
+00013290: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
+000132a0: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+000132b0: 6365 7373 6564 2061 6e64 206e 6577 2073  cessed and new s
+000132c0: 7461 7465 2072 6563 6f72 6465 6420 6174  tate recorded at
+000132d0: 6f6d 6963 616c 6c79 2069 6e20 6f6e 655c  omically in one\
+000132e0: 6e74 7261 6e73 6163 7469 6f6e 2077 6974  ntransaction wit
+000132f0: 6820 7468 6520 636f 6d6d 6974 2070 6f73  h the commit pos
+00013300: 6974 696f 6e20 7265 636f 7264 6564 2069  ition recorded i
+00013310: 6e20 6120 7365 7061 7261 7465 2074 7261  n a separate tra
+00013320: 6e73 6163 7469 6f6e 2c20 6f6e 6520 6d61  nsaction, one ma
+00013330: 795c 6e68 6170 7065 6e20 616e 6420 6e6f  y\nhappen and no
+00013340: 7420 7468 6520 6f74 6865 722e 2049 6620  t the other. If 
+00013350: 7468 6520 6e65 7720 7374 6174 6520 6973  the new state is
+00013360: 2072 6563 6f72 6465 6420 6275 7420 7468   recorded but th
+00013370: 6520 706f 7369 7469 6f6e 2069 7320 6c6f  e position is lo
+00013380: 7374 2c5c 6e61 6e64 2074 6865 6e20 7468  st,\nand then th
+00013390: 6520 7072 6f63 6573 7369 6e67 2069 7320  e processing is 
+000133a0: 7374 6f70 7065 6420 616e 6420 7265 7375  stopped and resu
+000133b0: 6d65 642c 2074 6865 2072 6563 6f72 6465  med, the recorde
+000133c0: 6420 6576 656e 7420 6d61 7920 6265 2070  d event may be p
+000133d0: 726f 6365 7373 6564 5c6e 7477 6963 652e  rocessed\ntwice.
+000133e0: 204f 6e20 7468 6520 6f74 6865 7220 6861   On the other ha
+000133f0: 6e64 2c20 6966 2074 6865 2063 6f6d 6d69  nd, if the commi
+00013400: 7420 706f 7369 7469 6f6e 2069 7320 7265  t position is re
+00013410: 636f 7264 6564 2062 7574 2074 6865 206e  corded but the n
+00013420: 6577 2073 7461 7465 2069 735c 6e6c 6f73  ew state is\nlos
+00013430: 742c 2074 6865 2072 6563 6f72 6465 6420  t, the recorded 
+00013440: 6576 656e 7420 6d61 7920 6566 6665 6374  event may effect
+00013450: 6976 656c 7920 6e6f 7420 6265 2070 726f  ively not be pro
+00013460: 6365 7373 6564 2061 7420 616c 6c2e 2042  cessed at all. B
+00013470: 7920 6569 7468 6572 5c6e 7072 6f63 6573  y either\nproces
+00013480: 7369 6e67 2061 6e20 6576 656e 7420 6d6f  sing an event mo
+00013490: 7265 2074 6861 6e20 6f6e 6365 2c20 6f72  re than once, or
+000134a0: 2062 7920 6661 696c 696e 6720 746f 2070   by failing to p
+000134b0: 726f 6365 7373 2061 6e20 6576 656e 742c  rocess an event,
+000134c0: 2074 6865 2072 6563 6f72 6465 645c 6e73   the recorded\ns
+000134d0: 7461 7465 206f 6620 7468 6520 646f 776e  tate of the down
+000134e0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+000134f0: 206d 6967 6874 2062 6520 696e 6163 6375   might be inaccu
+00013500: 7261 7465 2c20 6f72 2070 6f73 7369 626c  rate, or possibl
+00013510: 7920 696e 636f 6e73 6973 7465 6e74 2c20  y inconsistent, 
+00013520: 616e 645c 6e70 6572 6861 7073 2063 6174  and\nperhaps cat
+00013530: 6173 7472 6f70 6869 6361 6c6c 7920 736f  astrophically so
+00013540: 2e20 5375 6368 2063 6f6e 7365 7175 656e  . Such consequen
+00013550: 6365 7320 6d61 7920 6f72 206d 6179 206e  ces may or may n
+00013560: 6f74 206d 6174 7465 7220 696e 2079 6f75  ot matter in you
+00013570: 7220 7369 7475 6174 696f 6e2e 5c6e 4275  r situation.\nBu
+00013580: 7420 736f 6d65 7469 6d65 7320 696e 636f  t sometimes inco
+00013590: 6e73 6973 7465 6e63 6965 7320 6d61 7920  nsistencies may 
+000135a0: 6861 6c74 2070 726f 6365 7373 696e 6720  halt processing 
+000135b0: 756e 7469 6c20 7468 6520 6973 7375 6520  until the issue 
+000135c0: 6973 2072 6573 6f6c 7665 642e 2059 6f75  is resolved. You
+000135d0: 2063 616e 5c6e 6176 6f69 6420 2264 7561   can\navoid "dua
+000135e0: 6c20 7772 6974 696e 6722 2069 6e20 7468  l writing" in th
+000135f0: 6520 636f 6e73 756d 7074 696f 6e20 6f66  e consumption of
+00013600: 2065 7665 6e74 7320 6279 2061 746f 6d69   events by atomi
+00013610: 6361 6c6c 7920 7265 636f 7264 696e 6720  cally recording 
+00013620: 7468 6520 636f 6d6d 6974 5c6e 706f 7369  the commit\nposi
+00013630: 7469 6f6e 206f 6620 6120 7265 636f 7264  tion of a record
+00013640: 6564 2065 7665 6e74 2061 6c6f 6e67 2077  ed event along w
+00013650: 6974 6820 7468 6520 6e65 7720 7374 6174  ith the new stat
+00013660: 6520 7468 6174 2072 6573 756c 7473 2066  e that results f
+00013670: 726f 6d20 7072 6f63 6573 7369 6e67 2074  rom processing t
+00013680: 6861 745c 6e65 7665 6e74 2069 6e20 7468  hat\nevent in th
+00013690: 6520 7361 6d65 2061 746f 6d69 6320 7472  e same atomic tr
+000136a0: 616e 7361 6374 696f 6e2e 2042 7920 6d61  ansaction. By ma
+000136b0: 6b69 6e67 2074 6865 2072 6563 6f72 6469  king the recordi
+000136c0: 6e67 206f 6620 7468 6520 636f 6d6d 6974  ng of the commit
+000136d0: 2070 6f73 6974 696f 6e73 5c6e 756e 6971   positions\nuniq
+000136e0: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
+000136f0: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
+00013700: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
+00013710: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
+00013720: 666c 6963 742c 2079 6f75 2077 696c 6c5c  flict, you will\
+00013730: 6e70 7265 7665 6e74 2074 6865 2072 6573  nprevent the res
+00013740: 756c 7473 206f 6620 616e 7920 6475 706c  ults of any dupl
+00013750: 6963 6174 6520 7072 6f63 6573 7369 6e67  icate processing
+00013760: 206f 6620 6120 7265 636f 7264 6564 2065   of a recorded e
+00013770: 7665 6e74 2062 6569 6e67 2063 6f6d 6d69  vent being commi
+00013780: 7474 6564 2e5c 6e5c 6e52 6563 6f72 6465  tted.\n\nRecorde
+00013790: 6420 6576 656e 7473 2072 6563 6569 7665  d events receive
+000137a0: 6420 6672 6f6d 2061 2063 6174 6368 2d75  d from a catch-u
+000137b0: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
+000137c0: 616e 6e6f 7420 6265 2061 636b 6e6f 776c  annot be acknowl
+000137d0: 6564 6765 6420 6261 636b 5c6e 746f 2074  edged back\nto t
+000137e0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+000137f0: 7365 7276 6572 2e20 4163 6b6e 6f77 6c65  server. Acknowle
+00013800: 6467 696e 6720 6576 656e 7473 2c20 686f  dging events, ho
+00013810: 7765 7665 722c 2069 7320 616e 2061 7370  wever, is an asp
+00013820: 6563 7420 6f66 2022 7065 7273 6973 7465  ect of "persiste
+00013830: 6e74 5c6e 7375 6273 6372 6970 7469 6f6e  nt\nsubscription
+00013840: 7322 2e20 486f 7069 6e67 2074 6f20 7265  s". Hoping to re
+00013850: 6c79 206f 6e20 6163 6b6e 6f77 6c65 6467  ly on acknowledg
+00013860: 696e 6720 6576 656e 7473 2074 6f20 616e  ing events to an
+00013870: 2075 7073 7472 6561 6d5c 6e63 6f6d 706f   upstream\ncompo
+00013880: 6e65 6e74 2069 7320 616e 2065 7861 6d70  nent is an examp
+00013890: 6c65 206f 6620 6475 616c 2077 7269 7469  le of dual writi
+000138a0: 6e67 2e5c 6e5c 6e5c 6e23 2320 5065 7273  ng.\n\n\n## Pers
+000138b0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+000138c0: 696f 6e73 5c6e 5c6e 496e 2045 7665 6e74  ions\n\nIn Event
+000138d0: 5374 6f72 6544 422c 2022 7065 7273 6973  StoreDB, "persis
+000138e0: 7465 6e74 2220 7375 6273 6372 6970 7469  tent" subscripti
+000138f0: 6f6e 7320 6172 6520 7369 6d69 6c61 7220  ons are similar 
+00013900: 746f 2063 6174 6368 2d75 7020 7375 6273  to catch-up subs
+00013910: 6372 6970 7469 6f6e 732c 5c6e 696e 2074  criptions,\nin t
+00013920: 6861 7420 7265 6164 696e 6720 6120 7065  hat reading a pe
+00013930: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00013940: 7074 696f 6e20 7769 6c6c 2062 6c6f 636b  ption will block
+00013950: 2077 6865 6e20 7468 6572 6520 6172 6520   when there are 
+00013960: 6e6f 206d 6f72 6520 7265 636f 7264 6564  no more recorded
+00013970: 5c6e 6576 656e 7473 2074 6f20 6265 2072  \nevents to be r
+00013980: 6563 6569 7665 642c 2061 6e64 2074 6865  eceived, and the
+00013990: 6e20 636f 6e74 696e 7565 2077 6865 6e20  n continue when 
+000139a0: 6e65 7720 6576 656e 7473 2061 7265 2073  new events are s
+000139b0: 7562 7365 7175 656e 746c 7920 7265 636f  ubsequently reco
+000139c0: 7264 6564 2e5c 6e5c 6e50 6572 7369 7374  rded.\n\nPersist
+000139d0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+000139e0: 7320 6361 6e5c 6e5c 6e50 6572 7369 7374  s can\n\nPersist
+000139f0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00013a00: 7320 6361 6e20 6265 2063 6f6e 7375 6d65  s can be consume
+00013a10: 6420 6279 2061 2067 726f 7570 206f 6620  d by a group of 
+00013a20: 636f 6e73 756d 6572 7320 6f70 6572 6174  consumers operat
+00013a30: 696e 6720 7769 7468 206f 6e65 5c6e 6f66  ing with one\nof
+00013a40: 2074 6865 2073 7570 706f 7274 6564 2022   the supported "
+00013a50: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
+00013a60: 6965 7322 2e5c 6e5c 6e54 6865 2073 6967  ies".\n\nThe sig
+00013a70: 6e69 6669 6361 6e74 2064 6966 6665 7265  nificant differe
+00013a80: 6e74 2077 6974 6820 7065 7273 6973 7465  nt with persiste
+00013a90: 6e74 2073 7562 7363 7269 7074 696f 6e73  nt subscriptions
+00013aa0: 2069 7320 7468 6520 7365 7276 6572 2077   is the server w
+00013ab0: 696c 6c20 6b65 6570 2074 7261 636b 5c6e  ill keep track\n
+00013ac0: 6f66 2074 6865 2070 726f 6772 6573 7320  of the progress 
+00013ad0: 6f66 2074 6865 2063 6f6e 7375 6d65 7273  of the consumers
+00013ae0: 2e20 5468 6520 636f 6e73 756d 6572 206f  . The consumer o
+00013af0: 6620 6120 7065 7273 6973 7465 6e74 2073  f a persistent s
+00013b00: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+00013b10: 5c6e 7468 6572 6566 6f72 6520 6e65 6564  \ntherefore need
+00013b20: 2074 6f20 2261 636b 6e6f 776c 6564 6765   to "acknowledge
+00013b30: 2220 7768 656e 2061 2072 6563 6f72 6465  " when a recorde
+00013b40: 6420 6576 656e 7420 6861 7320 6265 656e  d event has been
+00013b50: 2070 726f 6365 7373 6564 2073 7563 6365   processed succe
+00013b60: 7373 6675 6c6c 792c 5c6e 616e 6420 6f74  ssfully,\nand ot
+00013b70: 6865 7277 6973 6520 226e 6567 6174 6976  herwise "negativ
+00013b80: 656c 7920 6163 6b6e 6f77 6c65 6467 6522  ely acknowledge"
+00013b90: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
+00013ba0: 7420 7468 6174 2068 6173 2062 6565 6e20  t that has been 
+00013bb0: 7265 6365 6976 6564 2062 7574 2077 6173  received but was
+00013bc0: 5c6e 6e6f 7420 7375 6363 6573 7366 756c  \nnot successful
+00013bd0: 6c79 2070 726f 6365 7373 6564 2e5c 6e5c  ly processed.\n\
+00013be0: 6e41 6c6c 206f 6620 7468 6973 206d 6561  nAll of this mea
+00013bf0: 6e73 2074 6861 7420 666f 7220 7065 7273  ns that for pers
+00013c00: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00013c10: 696f 6e73 2074 6865 7265 2061 7265 2022  ions there are "
+00013c20: 6372 6561 7465 222c 2022 7265 6164 222c  create", "read",
+00013c30: 2022 7570 6461 7465 225c 6e22 6465 6c65   "update"\n"dele
+00013c40: 7465 222c 2022 6163 6b22 2c20 616e 6420  te", "ack", and 
+00013c50: 226e 6163 6b22 206f 7065 7261 7469 6f6e  "nack" operation
+00013c60: 7320 746f 2063 6f6e 7369 6465 722e 5c6e  s to consider.\n
+00013c70: 5c6e 5768 696c 7374 2074 6865 7265 2061  \nWhilst there a
+00013c80: 7265 2073 6f6d 6520 6164 7661 6e74 6167  re some advantag
+00013c90: 6573 206f 6620 7065 7273 6973 7465 6e74  es of persistent
+00013ca0: 2073 7562 7363 7269 7074 696f 6e73 2c20   subscriptions, 
+00013cb0: 696e 2070 6172 7469 6375 6c61 7220 7468  in particular th
+00013cc0: 655c 6e63 6f6e 6375 7272 656e 7420 7072  e\nconcurrent pr
+00013cd0: 6f63 6573 7369 6e67 206f 6620 7265 636f  ocessing of reco
+00013ce0: 7264 6564 2065 7665 6e74 7320 6279 2061  rded events by a
+00013cf0: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+00013d00: 6572 732c 2062 7920 7472 6163 6b69 6e67  ers, by tracking
+00013d10: 2069 6e5c 6e74 6865 2073 6572 7665 7220   in\nthe server 
+00013d20: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
+00013d30: 7468 6520 636f 6d6d 6974 2073 6571 7565  the commit seque
+00013d40: 6e63 6520 6f66 2065 7665 6e74 7320 7468  nce of events th
+00013d50: 6174 2068 6176 6520 6265 656e 2070 726f  at have been pro
+00013d60: 6365 7373 6564 2c5c 6e74 6865 2069 7373  cessed,\nthe iss
+00013d70: 7565 206f 6620 2264 7561 6c20 7772 6974  ue of "dual writ
+00013d80: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
+00013d90: 756d 7074 696f 6e20 6f66 2065 7665 6e74  umption of event
+00013da0: 7320 6172 6973 6573 2e20 5265 6c69 6162  s arises. Reliab
+00013db0: 696c 6974 7920 696e 2074 6865 5c6e 7072  ility in the\npr
+00013dc0: 6f63 6573 7369 6e67 206f 6620 7265 636f  ocessing of reco
+00013dd0: 7264 6564 2065 7665 6e74 7320 6279 2061  rded events by a
+00013de0: 2067 726f 7570 206f 6620 7065 7273 6973   group of persis
+00013df0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00013e00: 6e20 636f 6e73 756d 6572 7320 7769 6c6c  n consumers will
+00013e10: 5c6e 7265 6c79 206f 6e20 7468 6569 7220  \nrely on their 
+00013e20: 6964 656d 706f 7465 6e74 2068 616e 646c  idempotent handl
+00013e30: 696e 6720 6f66 2064 7570 6c69 6361 7465  ing of duplicate
+00013e40: 206d 6573 7361 6765 732c 2061 6e64 2074   messages, and t
+00013e50: 6865 6972 2072 6573 696c 6965 6e63 6520  heir resilience 
+00013e60: 746f 5c6e 6f75 742d 6f66 2d6f 7264 6572  to\nout-of-order
+00013e70: 2064 656c 6976 6572 792e 5c6e 5c6e 5c6e   delivery.\n\n\n
+00013e80: 2323 2320 4372 6561 7465 2073 7562 7363  ### Create subsc
+00013e90: 7269 7074 696f 6e5c 6e5c 6e2a 7265 7175  ription\n\n*requ
+00013ea0: 6972 6573 206c 6561 6465 722a 5c6e 5c6e  ires leader*\n\n
+00013eb0: 5468 6520 6063 7265 6174 655f 7375 6273  The `create_subs
+00013ec0: 6372 6970 7469 6f6e 2829 6020 6d65 7468  cription()` meth
+00013ed0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+00013ee0: 6f20 6372 6561 7465 2061 2022 7065 7273  o create a "pers
+00013ef0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00013f00: 696f 6e22 5c6e 746f 2061 6c6c 2074 6865  ion"\nto all the
+00013f10: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00013f20: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+00013f30: 2061 6372 6f73 7320 616c 6c20 7374 7265   across all stre
+00013f40: 616d 732e 5c6e 5c6e 5468 6973 206d 6574  ams.\n\nThis met
+00013f50: 686f 6420 6861 7320 6120 7265 7175 6972  hod has a requir
+00013f60: 6564 2060 6772 6f75 705f 6e61 6d65 6020  ed `group_name` 
+00013f70: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+00013f80: 6973 2074 6865 5c6e 6e61 6d65 206f 6620  is the\nname of 
+00013f90: 6120 2267 726f 7570 2220 6f66 2063 6f6e  a "group" of con
+00013fa0: 7375 6d65 7273 206f 6620 7468 6520 7375  sumers of the su
+00013fb0: 6273 6372 6970 7469 6f6e 2e5c 6e5c 6e54  bscription.\n\nT
+00013fc0: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
+00013fd0: 6861 7320 7365 7665 6e20 6f70 7469 6f6e  has seven option
+00013fe0: 616c 2061 7267 756d 656e 7473 2c20 6066  al arguments, `f
+00013ff0: 726f 6d5f 656e 6460 2c20 6063 6f6d 6d69  rom_end`, `commi
+00014000: 745f 706f 7369 7469 6f6e 602c 5c6e 6066  t_position`,\n`f
+00014010: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+00014020: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+00014030: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
+00014040: 6561 6d5f 6e61 6d65 602c 2060 636f 6e73  eam_name`, `cons
+00014050: 756d 6572 5f73 7472 6174 6567 7960 2c5c  umer_strategy`,\
+00014060: 6e61 6e64 2060 7469 6d65 6f75 7460 2e5c  nand `timeout`.\
+00014070: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
+00014080: 6066 726f 6d5f 656e 6460 2061 7267 756d  `from_end` argum
+00014090: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+000140a0: 746f 2073 7065 6369 6679 2074 6861 7420  to specify that 
+000140b0: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
+000140c0: 7375 6d65 7273 5c6e 6f66 2074 6865 2073  sumers\nof the s
+000140d0: 7562 7363 7269 7074 696f 6e20 7368 6f75  ubscription shou
+000140e0: 6c64 206f 6e6c 7920 7265 6365 6976 6520  ld only receive 
+000140f0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
+00014100: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
+00014110: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00014120: 5c6e 7761 7320 6372 6561 7465 642e 5c6e  \nwas created.\n
+00014130: 5c6e 416c 7465 726e 6174 6976 656c 792c  \nAlternatively,
+00014140: 2074 6865 206f 7074 696f 6e61 6c20 6063   the optional `c
+00014150: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+00014160: 6172 6775 6d65 6e74 2063 616e 2062 6520  argument can be 
+00014170: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
+00014180: 6120 636f 6d6d 6974 5c6e 706f 7369 7469  a commit\npositi
+00014190: 6f6e 2066 726f 6d20 7768 6963 6820 636f  on from which co
+000141a0: 6d6d 6974 2070 6f73 6974 696f 6e20 7468  mmit position th
+000141b0: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+000141c0: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
+000141d0: 6372 6970 7469 6f6e 2073 686f 756c 645c  cription should\
+000141e0: 6e72 6563 6569 7665 2065 7665 6e74 732e  nreceive events.
+000141f0: 2050 6c65 6173 6520 6e6f 7465 2c20 7468   Please note, th
+00014200: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00014210: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
+00014220: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
+00014230: 6e20 6d69 6768 745c 6e62 6520 696e 636c  n might\nbe incl
+00014240: 7564 6564 2069 6e20 7468 6520 7265 636f  uded in the reco
+00014250: 7264 6564 2065 7665 6e74 7320 7265 6365  rded events rece
+00014260: 6976 6564 2062 7920 7468 6520 6772 6f75  ived by the grou
+00014270: 7020 6f66 2063 6f6e 7375 6d65 7273 2e5c  p of consumers.\
+00014280: 6e5c 6e49 6620 6e65 6974 6865 7220 6066  n\nIf neither `f
+00014290: 726f 6d5f 656e 6460 206f 7220 6063 6f6d  rom_end` or `com
+000142a0: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
+000142b0: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
+000142c0: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+000142d0: 6572 735c 6e6f 6620 7468 6520 7375 6273  ers\nof the subs
+000142e0: 6372 6970 7469 6f6e 2077 696c 6c20 706f  cription will po
+000142f0: 7465 6e74 6961 6c6c 7920 7265 6365 6976  tentially receiv
+00014300: 6520 616c 6c20 7265 636f 7264 6564 2065  e all recorded e
+00014310: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
+00014320: 6162 6173 652e 5c6e 5c6e 5468 6520 6f70  abase.\n\nThe op
+00014330: 7469 6f6e 616c 2060 6669 6c74 6572 5f65  tional `filter_e
+00014340: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00014350: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+00014360: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
+00014370: 7369 6f6e 7320 7468 6174 5c6e 7370 6563  sions that\nspec
+00014380: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
+00014390: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
+000143a0: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
+000143b0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+000143c0: 2069 676e 6f72 6564 5c6e 6966 2060 6669   ignored\nif `fi
+000143d0: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
+000143e0: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+000143f0: 7074 7920 7365 7175 656e 6365 2e20 5468  pty sequence. Th
+00014400: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00014410: 6f66 2074 6869 735c 6e61 7267 756d 656e  of this\nargumen
+00014420: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
+00014430: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
+00014440: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
+00014450: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
+00014460: 6174 2073 7973 7465 6d5c 6e65 7665 6e74  at system\nevent
+00014470: 7320 7769 6c6c 206e 6f74 206e 6f72 6d61  s will not norma
+00014480: 6c6c 7920 6265 2069 6e63 6c75 6465 642e  lly be included.
+00014490: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
+000144a0: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
+000144b0: 206d 6f72 655c 6e69 6e66 6f72 6d61 7469   more\ninformati
+000144c0: 6f6e 2061 626f 7574 2066 696c 7465 7220  on about filter 
+000144d0: 6578 7072 6573 7369 6f6e 732e 5c6e 5c6e  expressions.\n\n
+000144e0: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
+000144f0: 6c74 6572 5f69 6e63 6c75 6465 6020 6172  lter_include` ar
+00014500: 6775 6d65 6e74 2069 7320 6120 7365 7175  gument is a sequ
+00014510: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
+00014520: 6578 7072 6573 7369 6f6e 735c 6e74 6861  expressions\ntha
+00014530: 7420 7370 6563 6966 6965 7320 7768 6963  t specifies whic
+00014540: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+00014550: 7320 7368 6f75 6c64 2062 6520 7265 7475  s should be retu
+00014560: 726e 6564 2e20 4279 2064 6566 6175 6c74  rned. By default
+00014570: 2c20 7468 6973 5c6e 6172 6775 6d65 6e74  , this\nargument
+00014580: 2069 7320 616e 2065 6d70 7479 2074 7570   is an empty tup
+00014590: 6c65 2e20 4966 2074 6869 7320 6172 6775  le. If this argu
+000145a0: 6d65 6e74 2069 7320 7365 7420 746f 2061  ment is set to a
+000145b0: 206e 6f6e 2d65 6d70 7479 2073 6571 7565   non-empty seque
+000145c0: 6e63 652c 5c6e 7468 6520 6066 696c 7465  nce,\nthe `filte
+000145d0: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+000145e0: 656e 7420 6973 2069 676e 6f72 6564 2e5c  ent is ignored.\
+000145f0: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
+00014600: 6066 696c 7465 725f 6279 5f73 7472 6561  `filter_by_strea
+00014610: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
+00014620: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
+00014630: 6f6c 6020 7468 6174 2069 6e64 6963 6174  ol` that indicat
+00014640: 6573 5c6e 7768 6574 6865 7220 7468 6520  es\nwhether the 
+00014650: 6669 6c74 6572 696e 6720 7769 6c6c 2061  filtering will a
+00014660: 7070 6c79 2074 6f20 6576 656e 7420 7479  pply to event ty
+00014670: 7065 7320 6f72 2073 7472 6561 6d20 6e61  pes or stream na
+00014680: 6d65 732e 2042 7920 6465 6661 756c 742c  mes. By default,
+00014690: 2074 6869 735c 6e76 616c 7565 2069 7320   this\nvalue is 
+000146a0: 6046 616c 7365 6020 616e 6420 736f 2074  `False` and so t
+000146b0: 6865 2066 696c 7465 7269 6e67 2077 696c  he filtering wil
+000146c0: 6c20 6170 706c 7920 746f 2074 6865 2065  l apply to the e
+000146d0: 7665 6e74 2074 7970 6520 7374 7269 6e67  vent type string
+000146e0: 7320 6f66 5c6e 7265 636f 7264 6564 2065  s of\nrecorded e
+000146f0: 7665 6e74 732e 5c6e 5c6e 5468 6520 6f70  vents.\n\nThe op
+00014700: 7469 6f6e 616c 2060 636f 6e73 756d 6572  tional `consumer
+00014710: 5f73 7472 6174 6567 7960 2061 7267 756d  _strategy` argum
+00014720: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00014730: 6073 7472 6020 7468 6174 2064 6566 696e  `str` that defin
+00014740: 6573 5c6e 7468 6520 636f 6e73 756d 6572  es\nthe consumer
+00014750: 2073 7472 6174 6567 7920 666f 7220 7468   strategy for th
+00014760: 6973 2070 6572 7369 7374 656e 7420 7375  is persistent su
+00014770: 6273 6372 6970 7469 6f6e 2e20 5468 6520  bscription. The 
+00014780: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
+00014790: 6775 6d65 6e74 5c6e 6361 6e20 6265 2060  gument\ncan be `
+000147a0: 5c27 4469 7370 6174 6368 546f 5369 6e67  \'DispatchToSing
+000147b0: 6c65 5c27 602c 2060 5c27 526f 756e 6452  le\'`, `\'RoundR
+000147c0: 6f62 696e 5c27 602c 2060 5c27 5069 6e6e  obin\'`, `\'Pinn
+000147d0: 6564 5c27 602c 206f 7220 605c 2750 696e  ed\'`, or `\'Pin
+000147e0: 6e65 6442 7943 6f72 7265 6c61 7469 6f6e  nedByCorrelation
+000147f0: 5c27 602e 2054 6865 5c6e 6465 6661 756c  \'`. The\ndefaul
+00014800: 7420 7661 6c75 6520 6973 2060 5c27 4469  t value is `\'Di
+00014810: 7370 6174 6368 546f 5369 6e67 6c65 5c27  spatchToSingle\'
+00014820: 602e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  `.\n\nThe option
+00014830: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+00014840: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00014850: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+00014860: 7365 7473 2061 5c6e 6465 6164 6c69 6e65  sets a\ndeadline
+00014870: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+00014880: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00014890: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
+000148a0: 6520 6d65 7468 6f64 2060 6372 6561 7465  e method `create
+000148b0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+000148c0: 2064 6f65 7320 6e6f 7420 7265 7475 726e   does not return
+000148d0: 2061 2076 616c 7565 2e20 5265 636f 7264   a value. Record
+000148e0: 6564 2065 7665 6e74 7320 6172 655c 6e6f  ed events are\no
+000148f0: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
+00014900: 6e67 2074 6865 2060 7265 6164 5f73 7562  ng the `read_sub
+00014910: 7363 7269 7074 696f 6e28 2960 206d 6574  scription()` met
+00014920: 686f 642e 5c6e 5c6e 496e 2074 6865 2065  hod.\n\nIn the e
+00014930: 7861 6d70 6c65 2062 656c 6f77 2c20 6120  xample below, a 
+00014940: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00014950: 7269 7074 696f 6e20 6973 2063 7265 6174  ription is creat
+00014960: 6564 2074 6f20 6f70 6572 6174 6520 6672  ed to operate fr
+00014970: 6f6d 2074 6865 5c6e 6669 7273 7420 7265  om the\nfirst re
+00014980: 636f 7264 6564 206e 6f6e 2d73 7973 7465  corded non-syste
+00014990: 6d20 6576 656e 7420 696e 2074 6865 2064  m event in the d
+000149a0: 6174 6162 6173 652e 5c6e 5c6e 6060 6070  atabase.\n\n```p
+000149b0: 7974 686f 6e5c 6e23 2043 7265 6174 6520  ython\n# Create 
+000149c0: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+000149d0: 7363 7269 7074 696f 6e2e 5c6e 6772 6f75  scription.\ngrou
+000149e0: 705f 6e61 6d65 3120 3d20 6622 6772 6f75  p_name1 = f"grou
+000149f0: 702d 7b75 7569 642e 7575 6964 3428 297d  p-{uuid.uuid4()}
+00014a00: 225c 6e63 6c69 656e 742e 6372 6561 7465  "\nclient.create
+00014a10: 5f73 7562 7363 7269 7074 696f 6e28 6772  _subscription(gr
+00014a20: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
+00014a30: 616d 6531 295c 6e60 6060 5c6e 5c6e 2323  ame1)\n```\n\n##
+00014a40: 2320 5265 6164 2073 7562 7363 7269 7074  # Read subscript
+00014a50: 696f 6e5c 6e5c 6e2a 7265 7175 6972 6573  ion\n\n*requires
+00014a60: 206c 6561 6465 722a 5c6e 5c6e 5468 6520   leader*\n\nThe 
+00014a70: 6072 6561 645f 7375 6273 6372 6970 7469  `read_subscripti
+00014a80: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
+00014a90: 2062 6520 7573 6564 2062 7920 6120 6772   be used by a gr
+00014aa0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00014ab0: 2074 6f20 7265 6365 6976 655c 6e72 6563   to receive\nrec
+00014ac0: 6f72 6465 6420 6576 656e 7473 2066 726f  orded events fro
+00014ad0: 6d20 6120 7065 7273 6973 7465 6e74 2073  m a persistent s
+00014ae0: 7562 7363 7269 7074 696f 6e20 7468 6174  ubscription that
+00014af0: 2068 6173 2062 6565 6e20 6372 6561 7465   has been create
+00014b00: 6420 7573 696e 675c 6e74 6865 2060 6372  d using\nthe `cr
+00014b10: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
+00014b20: 6e28 2960 206d 6574 686f 642e 5c6e 5c6e  n()` method.\n\n
+00014b30: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00014b40: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
+00014b50: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
+00014b60: 2c20 7768 6963 6820 6973 5c6e 7468 6520  , which is\nthe 
+00014b70: 6e61 6d65 206f 6620 6120 2267 726f 7570  name of a "group
+00014b80: 2220 6f66 2063 6f6e 7375 6d65 7273 206f  " of consumers o
+00014b90: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+00014ba0: 6f6e 2073 7065 6369 6669 6564 5c6e 7768  on specified\nwh
+00014bb0: 656e 2060 6372 6561 7465 5f73 7562 7363  en `create_subsc
+00014bc0: 7269 7074 696f 6e28 2960 2077 6173 2063  ription()` was c
+00014bd0: 616c 6c65 642e 5c6e 5c6e 5468 6973 206d  alled.\n\nThis m
+00014be0: 6574 686f 6420 616c 736f 2068 6173 2061  ethod also has a
+00014bf0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+00014c00: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
+00014c10: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
+00014c20: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
+00014c30: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
+00014c40: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
+00014c50: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00014c60: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00014c70: 7065 7261 7469 6f6e 2e5c 6e5c 6e54 6869  peration.\n\nThi
+00014c80: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+00014c90: 2061 2060 5065 7273 6973 7465 6e74 5375   a `PersistentSu
+00014ca0: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
+00014cb0: 6374 2c20 7768 6963 6820 6973 2061 6e20  ct, which is an 
+00014cc0: 6974 6572 6174 6f72 5c6e 6769 7669 6e67  iterator\ngiving
+00014cd0: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00014ce0: 206f 626a 6563 7473 2e20 4974 2061 6c73   objects. It als
+00014cf0: 6f20 6861 7320 6061 636b 2829 602c 2060  o has `ack()`, `
+00014d00: 6e61 636b 2829 6020 616e 6420 6073 746f  nack()` and `sto
+00014d10: 7028 2960 5c6e 6d65 7468 6f64 732e 5c6e  p()`\nmethods.\n
+00014d20: 5c6e 6060 6070 7974 686f 6e5c 6e73 7562  \n```python\nsub
+00014d30: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
+00014d40: 6e74 2e72 6561 645f 7375 6273 6372 6970  nt.read_subscrip
+00014d50: 7469 6f6e 2867 726f 7570 5f6e 616d 653d  tion(group_name=
+00014d60: 6772 6f75 705f 6e61 6d65 3129 5c6e 6060  group_name1)\n``
+00014d70: 605c 6e5c 6e54 6865 2060 6163 6b28 2960  `\n\nThe `ack()`
+00014d80: 206d 6574 686f 6420 7368 6f75 6c64 2062   method should b
+00014d90: 6520 7573 6564 2062 7920 6120 636f 6e73  e used by a cons
+00014da0: 756d 6572 2074 6f20 696e 6469 6361 7465  umer to indicate
+00014db0: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
+00014dc0: 6861 7420 6974 5c6e 6861 7320 7265 6365  hat it\nhas rece
+00014dd0: 6976 6564 2061 6e64 2073 7563 6365 7373  ived and success
+00014de0: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
+00014df0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+00014e00: 2e20 5468 6973 2077 696c 6c20 7072 6576  . This will prev
+00014e10: 656e 7420 7468 6174 5c6e 7265 636f 7264  ent that\nrecord
+00014e20: 6564 2065 7665 6e74 2062 6569 6e67 2072  ed event being r
+00014e30: 6563 6569 7665 6420 6279 2061 6e6f 7468  eceived by anoth
+00014e40: 6572 2063 6f6e 7375 6d65 7220 696e 2074  er consumer in t
+00014e50: 6865 2073 616d 6520 6772 6f75 702e 2054  he same group. T
+00014e60: 6865 2060 6163 6b28 2960 5c6e 6d65 7468  he `ack()`\nmeth
+00014e70: 6f64 2074 616b 6573 2061 6e20 6065 7665  od takes an `eve
+00014e80: 6e74 5f69 6460 2061 7267 756d 656e 742c  nt_id` argument,
+00014e90: 2077 6869 6368 2069 7320 7468 6520 4944   which is the ID
+00014ea0: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
+00014eb0: 2065 7665 6e74 2074 6861 745c 6e68 6173   event that\nhas
+00014ec0: 2062 6565 6e20 7265 6365 6976 6564 2e5c   been received.\
+00014ed0: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
+00014ee0: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
+00014ef0: 6572 2074 6865 2073 7562 7363 7269 7074  er the subscript
+00014f00: 696f 6e20 6f62 6a65 6374 2c20 616e 6420  ion object, and 
+00014f10: 6361 6c6c 7320 6061 636b 2829 602e 2054  calls `ack()`. T
+00014f20: 6865 5c6e 6073 746f 7028 2960 206d 6574  he\n`stop()` met
+00014f30: 686f 6420 6973 2063 616c 6c65 6420 7768  hod is called wh
+00014f40: 656e 2077 6520 6861 7665 2072 6563 6569  en we have recei
+00014f50: 7665 6420 7468 6520 6c61 7374 2065 7665  ved the last eve
+00014f60: 6e74 2c20 736f 2074 6861 7420 7765 2063  nt, so that we c
+00014f70: 616e 5c6e 636f 6e74 696e 7565 2077 6974  an\ncontinue wit
+00014f80: 6820 7468 6520 6578 616d 706c 6573 2062  h the examples b
+00014f90: 656c 6f77 2e5c 6e5c 6e60 6060 7079 7468  elow.\n\n```pyth
+00014fa0: 6f6e 5c6e 6576 656e 7473 203d 205b 5d5c  on\nevents = []\
+00014fb0: 6e66 6f72 2065 7665 6e74 2069 6e20 7375  nfor event in su
+00014fc0: 6273 6372 6970 7469 6f6e 3a5c 6e20 2020  bscription:\n   
+00014fd0: 2065 7665 6e74 732e 6170 7065 6e64 2865   events.append(e
+00014fe0: 7665 6e74 295c 6e5c 6e20 2020 2023 2041  vent)\n\n    # A
+00014ff0: 636b 6e6f 776c 6564 6765 2074 6865 2072  cknowledge the r
+00015000: 6563 6569 7665 6420 6576 656e 742e 5c6e  eceived event.\n
+00015010: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+00015020: 2e61 636b 2865 7665 6e74 5f69 643d 6576  .ack(event_id=ev
+00015030: 656e 742e 6964 295c 6e5c 6e20 2020 2023  ent.id)\n\n    #
+00015040: 2053 746f 7020 7768 656e 205c 2765 7665   Stop when \'eve
+00015050: 6e74 395c 2720 6861 7320 6265 656e 2072  nt9\' has been r
+00015060: 6563 6569 7665 642e 5c6e 2020 2020 6966  eceived.\n    if
+00015070: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
+00015080: 6e74 392e 6964 3a5c 6e20 2020 2020 2020  nt9.id:\n       
+00015090: 2073 7562 7363 7269 7074 696f 6e2e 7374   subscription.st
+000150a0: 6f70 2829 5c6e 6060 605c 6e5c 6e54 6865  op()\n```\n\nThe
+000150b0: 2072 6563 6569 7665 6420 6576 656e 7473   received events
+000150c0: 2061 7265 2074 6865 2065 7665 6e74 7320   are the events 
+000150d0: 7765 2061 7070 656e 6465 6420 6162 6f76  we appended abov
+000150e0: 652e 5c6e 5c6e 6060 6070 7974 686f 6e5c  e.\n\n```python\
+000150f0: 6e61 7373 6572 7420 6576 656e 7473 5b2d  nassert events[-
+00015100: 3134 5d2e 6964 203d 3d20 6576 656e 7431  14].id == event1
+00015110: 2e69 645c 6e61 7373 6572 7420 6576 656e  .id\nassert even
+00015120: 7473 5b2d 3133 5d2e 6964 203d 3d20 6576  ts[-13].id == ev
+00015130: 656e 7432 2e69 645c 6e61 7373 6572 7420  ent2.id\nassert 
+00015140: 6576 656e 7473 5b2d 3132 5d2e 6964 203d  events[-12].id =
+00015150: 3d20 6576 656e 7433 2e69 645c 6e61 7373  = event3.id\nass
+00015160: 6572 7420 6576 656e 7473 5b2d 3131 5d2e  ert events[-11].
+00015170: 7479 7065 203d 3d20 2244 6f67 5265 6769  type == "DogRegi
+00015180: 7374 6572 6564 225c 6e61 7373 6572 7420  stered"\nassert 
+00015190: 6576 656e 7473 5b2d 3130 5d2e 7479 7065  events[-10].type
+000151a0: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
+000151b0: 7269 636b 225c 6e61 7373 6572 7420 6576  rick"\nassert ev
+000151c0: 656e 7473 5b2d 395d 2e74 7970 6520 3d3d  ents[-9].type ==
+000151d0: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+000151e0: 6b22 5c6e 6173 7365 7274 2065 7665 6e74  k"\nassert event
+000151f0: 735b 2d38 5d2e 7479 7065 203d 3d20 2253  s[-8].type == "S
+00015200: 6e61 7073 686f 7422 5c6e 6173 7365 7274  napshot"\nassert
+00015210: 2065 7665 6e74 735b 2d37 5d2e 7479 7065   events[-7].type
+00015220: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
+00015230: 7269 636b 225c 6e61 7373 6572 7420 6576  rick"\nassert ev
+00015240: 656e 7473 5b2d 365d 2e69 6420 3d3d 2065  ents[-6].id == e
+00015250: 7665 6e74 342e 6964 5c6e 6173 7365 7274  vent4.id\nassert
+00015260: 2065 7665 6e74 735b 2d35 5d2e 6964 203d   events[-5].id =
+00015270: 3d20 6576 656e 7435 2e69 645c 6e61 7373  = event5.id\nass
+00015280: 6572 7420 6576 656e 7473 5b2d 345d 2e69  ert events[-4].i
+00015290: 6420 3d3d 2065 7665 6e74 362e 6964 5c6e  d == event6.id\n
+000152a0: 6173 7365 7274 2065 7665 6e74 735b 2d33  assert events[-3
+000152b0: 5d2e 6964 203d 3d20 6576 656e 7437 2e69  ].id == event7.i
+000152c0: 645c 6e61 7373 6572 7420 6576 656e 7473  d\nassert events
+000152d0: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
+000152e0: 382e 6964 5c6e 6173 7365 7274 2065 7665  8.id\nassert eve
+000152f0: 6e74 735b 2d31 5d2e 6964 203d 3d20 6576  nts[-1].id == ev
+00015300: 656e 7439 2e69 645c 6e60 6060 5c6e 5c6e  ent9.id\n```\n\n
+00015310: 5468 6520 6050 6572 7369 7374 656e 7453  The `PersistentS
+00015320: 7562 7363 7269 7074 696f 6e60 206f 626a  ubscription` obj
+00015330: 6563 7420 616c 736f 2068 6173 2061 6e20  ect also has an 
+00015340: 606e 6163 6b28 2960 206d 6574 686f 6420  `nack()` method 
+00015350: 7468 6174 2073 686f 756c 6420 6265 2075  that should be u
+00015360: 7365 645c 6e62 7920 6120 636f 6e73 756d  sed\nby a consum
+00015370: 6572 2074 6f20 6e65 6761 7469 7665 6c79  er to negatively
+00015380: 2061 636b 6e6f 776c 6564 6765 2074 6f20   acknowledge to 
+00015390: 7468 6520 7365 7276 6572 2074 6861 7420  the server that 
+000153a0: 6974 2068 6173 2072 6563 6569 7665 6420  it has received 
+000153b0: 6275 7420 6e6f 745c 6e73 7563 6365 7373  but not\nsuccess
+000153c0: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
+000153d0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+000153e0: 2e20 5468 6520 606e 6163 6b28 2960 206d  . The `nack()` m
+000153f0: 6574 686f 6420 7461 6b65 7320 616e 2060  ethod takes an `
+00015400: 6576 656e 745f 6964 605c 6e61 7267 756d  event_id`\nargum
+00015410: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
+00015420: 6520 4944 206f 6620 7468 6520 7265 636f  e ID of the reco
+00015430: 7264 6564 2065 7665 6e74 2074 6861 7420  rded event that 
+00015440: 6861 7320 6265 656e 2072 6563 6569 7665  has been receive
+00015450: 642c 2061 6e64 2061 6e20 6061 6374 696f  d, and an `actio
+00015460: 6e60 5c6e 6172 6775 6d65 6e74 2c20 7768  n`\nargument, wh
+00015470: 6963 6820 7368 6f75 6c64 2062 6520 6120  ich should be a 
+00015480: 5079 7468 6f6e 2060 7374 7260 2c20 6569  Python `str`, ei
+00015490: 7468 6572 2060 5c27 756e 6b6e 6f77 6e5c  ther `\'unknown\
+000154a0: 2760 2c20 605c 2770 6172 6b5c 2760 2c20  '`, `\'park\'`, 
+000154b0: 605c 2772 6574 7279 5c27 602c 5c6e 605c  `\'retry\'`,\n`\
+000154c0: 2773 6b69 705c 2760 206f 7220 605c 2773  'skip\'` or `\'s
+000154d0: 746f 705c 2760 2e5c 6e5c 6e5c 6e23 2323  top\'`.\n\n\n###
+000154e0: 2048 6f77 2074 6f20 7772 6974 6520 6120   How to write a 
+000154f0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00015500: 7269 7074 696f 6e20 636f 6e73 756d 6572  ription consumer
+00015510: 5c6e 5c6e 5468 6520 7265 6164 696e 6720  \n\nThe reading 
+00015520: 6f66 2061 2070 6572 7369 7374 656e 7420  of a persistent 
+00015530: 7375 6273 6372 6970 7469 6f6e 2063 616e  subscription can
+00015540: 2062 6520 656e 6361 7073 756c 6174 6564   be encapsulated
+00015550: 2069 6e20 6120 2263 6f6e 7375 6d65 7222   in a "consumer"
+00015560: 2074 6861 7420 6361 6c6c 735c 6e61 2022   that calls\na "
+00015570: 706f 6c69 6379 2220 6675 6e63 7469 6f6e  policy" function
+00015580: 2077 6865 6e20 6120 7265 636f 7264 6564   when a recorded
+00015590: 2065 7665 6e74 2069 7320 7265 6365 6976   event is receiv
+000155a0: 6564 2061 6e64 2074 6865 6e20 6175 746f  ed and then auto
+000155b0: 6d61 7469 6361 6c6c 7920 6361 6c6c 735c  matically calls\
+000155c0: 6e60 6163 6b28 2960 2069 6620 7468 6520  n`ack()` if the 
+000155d0: 706f 6c69 6379 2066 756e 6374 696f 6e20  policy function 
+000155e0: 7265 7475 726e 7320 6e6f 726d 616c 6c79  returns normally
+000155f0: 2c20 616e 6420 606e 6163 6b28 2960 2069  , and `nack()` i
+00015600: 6620 6974 2072 6169 7365 7320 616e 2065  f it raises an e
+00015610: 7863 6570 7469 6f6e 2c5c 6e70 6572 6861  xception,\nperha
+00015620: 7073 2072 6574 7279 696e 6720 7468 6520  ps retrying the 
+00015630: 6576 656e 7420 666f 7220 6120 6365 7274  event for a cert
+00015640: 6169 6e20 6e75 6d62 6572 206f 6620 7469  ain number of ti
+00015650: 6d65 7320 6265 666f 7265 2070 6172 6b69  mes before parki
+00015660: 6e67 2074 6865 2065 7665 6e74 2e5c 6e5c  ng the event.\n\
+00015670: 6e54 6865 2073 696d 706c 6520 6578 616d  nThe simple exam
+00015680: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+00015690: 686f 7720 7468 6973 206d 6967 6874 2062  how this might b
+000156a0: 6520 646f 6e65 2e20 5765 2063 616e 2073  e done. We can s
+000156b0: 6565 2074 6861 7420 5c27 6576 656e 7439  ee that \'event9
+000156c0: 5c27 2069 735c 6e61 636b 6e6f 776c 6564  \' is\nacknowled
+000156d0: 6765 6420 6265 666f 7265 205c 2765 7665  ged before \'eve
+000156e0: 6e74 355c 2720 6973 2066 696e 616c 6c79  nt5\' is finally
+000156f0: 2070 6172 6b65 642e 5c6e 5c6e 5c6e 6060   parked.\n\n\n``
+00015700: 6070 7974 686f 6e5c 6e61 636b 6564 5f65  `python\nacked_e
+00015710: 7665 6e74 7320 3d20 7b7d 5c6e 6e61 636b  vents = {}\nnack
+00015720: 6564 5f65 7665 6e74 7320 3d20 7b7d 5c6e  ed_events = {}\n
+00015730: 5c6e 5c6e 636c 6173 7320 4578 616d 706c  \n\nclass Exampl
+00015740: 6543 6f6e 7375 6d65 723a 5c6e 2020 2020  eConsumer:\n    
+00015750: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00015760: 662c 2073 7562 7363 7269 7074 696f 6e2c  f, subscription,
+00015770: 206d 6178 5f72 6574 7269 6573 2c20 6669   max_retries, fi
+00015780: 6e61 6c5f 6163 7469 6f6e 293a 5c6e 2020  nal_action):\n  
+00015790: 2020 2020 2020 7365 6c66 2e73 7562 7363        self.subsc
+000157a0: 7269 7074 696f 6e20 3d20 7375 6273 6372  ription = subscr
+000157b0: 6970 7469 6f6e 5c6e 2020 2020 2020 2020  iption\n        
+000157c0: 7365 6c66 2e6d 6178 5f72 6574 7269 6573  self.max_retries
+000157d0: 203d 206d 6178 5f72 6574 7269 6573 5c6e   = max_retries\n
+000157e0: 2020 2020 2020 2020 7365 6c66 2e66 696e          self.fin
+000157f0: 616c 5f61 6374 696f 6e20 3d20 6669 6e61  al_action = fina
+00015800: 6c5f 6163 7469 6f6e 5c6e 2020 2020 2020  l_action\n      
+00015810: 2020 7365 6c66 2e65 7272 6f72 203d 204e    self.error = N
+00015820: 6f6e 655c 6e5c 6e20 2020 2064 6566 2072  one\n\n    def r
+00015830: 756e 2873 656c 6629 3a5c 6e20 2020 2020  un(self):\n     
+00015840: 2020 2074 7279 3a5c 6e20 2020 2020 2020     try:\n       
+00015850: 2020 2020 2066 6f72 2065 7665 6e74 2069       for event i
+00015860: 6e20 7365 6c66 2e73 7562 7363 7269 7074  n self.subscript
+00015870: 696f 6e3a 5c6e 2020 2020 2020 2020 2020  ion:\n          
+00015880: 2020 2020 2020 7472 793a 5c6e 2020 2020        try:\n    
+00015890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158a0: 7365 6c66 2e70 6f6c 6963 7928 6576 656e  self.policy(even
+000158b0: 7429 5c6e 2020 2020 2020 2020 2020 2020  t)\n            
+000158c0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000158d0: 7469 6f6e 3a5c 6e20 2020 2020 2020 2020  tion:\n         
+000158e0: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
+000158f0: 656e 742e 7265 7472 795f 636f 756e 7420  ent.retry_count 
+00015900: 3c20 7365 6c66 2e6d 6178 5f72 6574 7269  < self.max_retri
+00015910: 6573 3a5c 6e20 2020 2020 2020 2020 2020  es:\n           
+00015920: 2020 2020 2020 2020 2020 2020 2061 6374               act
+00015930: 696f 6e20 3d20 2272 6574 7279 225c 6e20  ion = "retry"\n 
+00015940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015950: 2020 2065 6c73 653a 5c6e 2020 2020 2020     else:\n      
+00015960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015970: 2020 6163 7469 6f6e 203d 2073 656c 662e    action = self.
+00015980: 6669 6e61 6c5f 6163 7469 6f6e 5c6e 2020  final_action\n  
+00015990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159a0: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
+000159b0: 696f 6e2e 6e61 636b 2865 7665 6e74 2e69  ion.nack(event.i
+000159c0: 642c 2061 6374 696f 6e3d 6163 7469 6f6e  d, action=action
+000159d0: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
+000159e0: 2020 2020 2020 2073 656c 662e 6166 7465         self.afte
+000159f0: 725f 6e61 636b 2865 7665 6e74 2c20 6163  r_nack(event, ac
+00015a00: 7469 6f6e 295c 6e20 2020 2020 2020 2020  tion)\n         
+00015a10: 2020 2020 2020 2065 6c73 653a 5c6e 2020         else:\n  
+00015a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a30: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
+00015a40: 696f 6e2e 6163 6b28 6576 656e 742e 6964  ion.ack(event.id
+00015a50: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
+00015a60: 2020 2020 2020 2073 656c 662e 6166 7465         self.afte
+00015a70: 725f 6163 6b28 6576 656e 7429 5c6e 2020  r_ack(event)\n  
+00015a80: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00015a90: 6570 7469 6f6e 3a5c 6e20 2020 2020 2020  eption:\n       
+00015aa0: 2020 2020 2073 656c 662e 7375 6273 6372       self.subscr
+00015ab0: 6970 7469 6f6e 2e73 746f 7028 295c 6e20  iption.stop()\n 
+00015ac0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00015ad0: 5c6e 5c6e 2020 2020 6465 6620 7374 6f70  \n\n    def stop
+00015ae0: 2873 656c 6629 3a5c 6e20 2020 2020 2020  (self):\n       
+00015af0: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
+00015b00: 6f6e 2e73 746f 7028 295c 6e5c 6e20 2020  on.stop()\n\n   
+00015b10: 2064 6566 2070 6f6c 6963 7928 7365 6c66   def policy(self
+00015b20: 2c20 6576 656e 7429 3a5c 6e20 2020 2020  , event):\n     
+00015b30: 2020 2023 2052 6169 7365 2061 6e20 6578     # Raise an ex
+00015b40: 6365 7074 696f 6e20 7768 656e 2077 6520  ception when we 
+00015b50: 7365 6520 2265 7665 6e74 3522 2e5c 6e20  see "event5".\n 
+00015b60: 2020 2020 2020 2069 6620 6576 656e 742e         if event.
+00015b70: 6964 203d 3d20 6576 656e 7435 2e69 643a  id == event5.id:
+00015b80: 5c6e 2020 2020 2020 2020 2020 2020 7261  \n            ra
+00015b90: 6973 6520 4578 6365 7074 696f 6e28 295c  ise Exception()\
+00015ba0: 6e5c 6e20 2020 2064 6566 2061 6674 6572  n\n    def after
+00015bb0: 5f61 636b 2873 656c 662c 2065 7665 6e74  _ack(self, event
+00015bc0: 293a 5c6e 2020 2020 2020 2020 2320 5472  ):\n        # Tr
+00015bd0: 6163 6b20 7265 7472 7920 636f 756e 7420  ack retry count 
+00015be0: 6f66 2061 636b 6564 2065 7665 6e74 732e  of acked events.
+00015bf0: 5c6e 2020 2020 2020 2020 6163 6b65 645f  \n        acked_
+00015c00: 6576 656e 7473 5b65 7665 6e74 2e69 645d  events[event.id]
+00015c10: 203d 2065 7665 6e74 2e72 6574 7279 5f63   = event.retry_c
+00015c20: 6f75 6e74 5c6e 5c6e 2020 2020 6465 6620  ount\n\n    def 
+00015c30: 6166 7465 725f 6e61 636b 2873 656c 662c  after_nack(self,
+00015c40: 2065 7665 6e74 2c20 6163 7469 6f6e 293a   event, action):
+00015c50: 5c6e 2020 2020 2020 2020 2320 5472 6163  \n        # Trac
+00015c60: 6b20 7265 7472 7920 636f 756e 7420 6f66  k retry count of
+00015c70: 206e 6163 6b65 6420 6576 656e 7473 2e5c   nacked events.\
+00015c80: 6e20 2020 2020 2020 206e 6163 6b65 645f  n        nacked_
+00015c90: 6576 656e 7473 5b65 7665 6e74 2e69 645d  events[event.id]
+00015ca0: 203d 2065 7665 6e74 2e72 6574 7279 5f63   = event.retry_c
+00015cb0: 6f75 6e74 5c6e 5c6e 2020 2020 2020 2020  ount\n\n        
+00015cc0: 6966 2061 6374 696f 6e20 3d3d 2073 656c  if action == sel
+00015cd0: 662e 6669 6e61 6c5f 6163 7469 6f6e 3a5c  f.final_action:\
+00015ce0: 6e20 2020 2020 2020 2020 2020 2023 2053  n            # S
+00015cf0: 746f 7020 7468 6520 636f 6e73 756d 6572  top the consumer
+00015d00: 2c20 736f 2077 6520 6361 6e20 636f 6e74  , so we can cont
+00015d10: 696e 7565 2077 6974 6820 7468 6520 6578  inue with the ex
+00015d20: 616d 706c 6573 2e5c 6e20 2020 2020 2020  amples.\n       
+00015d30: 2020 2020 2073 656c 662e 7374 6f70 2829       self.stop()
+00015d40: 5c6e 5c6e 5c6e 2320 4372 6561 7465 2073  \n\n\n# Create s
+00015d50: 7562 7363 7269 7074 696f 6e2e 5c6e 6772  ubscription.\ngr
+00015d60: 6f75 705f 6e61 6d65 203d 2066 2267 726f  oup_name = f"gro
+00015d70: 7570 2d7b 7575 6964 2e75 7569 6434 2829  up-{uuid.uuid4()
+00015d80: 7d22 5c6e 636c 6965 6e74 2e63 7265 6174  }"\nclient.creat
+00015d90: 655f 7375 6273 6372 6970 7469 6f6e 2867  e_subscription(g
+00015da0: 726f 7570 5f6e 616d 652c 2063 6f6d 6d69  roup_name, commi
+00015db0: 745f 706f 7369 7469 6f6e 3d63 6f6d 6d69  t_position=commi
+00015dc0: 745f 706f 7369 7469 6f6e 3129 5c6e 5c6e  t_position1)\n\n
+00015dd0: 2320 5265 6164 2073 7562 7363 7269 7074  # Read subscript
+00015de0: 696f 6e2e 5c6e 7375 6273 6372 6970 7469  ion.\nsubscripti
+00015df0: 6f6e 203d 2063 6c69 656e 742e 7265 6164  on = client.read
+00015e00: 5f73 7562 7363 7269 7074 696f 6e28 6772  _subscription(gr
+00015e10: 6f75 705f 6e61 6d65 295c 6e5c 6e23 2043  oup_name)\n\n# C
+00015e20: 6f6e 7374 7275 6374 2063 6f6e 7375 6d65  onstruct consume
+00015e30: 722e 5c6e 636f 6e73 756d 6572 203d 2045  r.\nconsumer = E
+00015e40: 7861 6d70 6c65 436f 6e73 756d 6572 285c  xampleConsumer(\
+00015e50: 6e20 2020 2073 7562 7363 7269 7074 696f  n    subscriptio
+00015e60: 6e3d 7375 6273 6372 6970 7469 6f6e 2c5c  n=subscription,\
+00015e70: 6e20 2020 206d 6178 5f72 6574 7269 6573  n    max_retries
+00015e80: 3d35 2c5c 6e20 2020 2066 696e 616c 5f61  =5,\n    final_a
+00015e90: 6374 696f 6e3d 2270 6172 6b22 2c5c 6e29  ction="park",\n)
+00015ea0: 5c6e 5c6e 2320 5275 6e20 636f 6e73 756d  \n\n# Run consum
+00015eb0: 6572 2e5c 6e63 6f6e 7375 6d65 722e 7275  er.\nconsumer.ru
+00015ec0: 6e28 295c 6e5c 6e23 2043 6865 636b 205c  n()\n\n# Check \
+00015ed0: 2765 7665 6e74 395c 2720 7761 7320 6163  'event9\' was ac
+00015ee0: 6b65 6420 616e 6420 6e65 7665 7220 7265  ked and never re
+00015ef0: 7472 6965 642e 5c6e 6173 7365 7274 2061  tried.\nassert a
+00015f00: 636b 6564 5f65 7665 6e74 735b 6576 656e  cked_events[even
+00015f10: 7439 2e69 645d 203d 3d20 305c 6e61 7373  t9.id] == 0\nass
+00015f20: 6572 7420 6576 656e 7439 2e69 6420 6e6f  ert event9.id no
+00015f30: 7420 696e 206e 6163 6b65 645f 6576 656e  t in nacked_even
+00015f40: 7473 5c6e 5c6e 2320 4368 6563 6b20 5c27  ts\n\n# Check \'
+00015f50: 6576 656e 7435 5c27 2077 6173 2072 6574  event5\' was ret
+00015f60: 7269 6564 2066 6976 6520 7469 6d65 7320  ried five times 
+00015f70: 616e 6420 6e65 7665 7220 6163 6b65 642e  and never acked.
+00015f80: 5c6e 6173 7365 7274 206e 6163 6b65 645f  \nassert nacked_
+00015f90: 6576 656e 7473 5b65 7665 6e74 352e 6964  events[event5.id
+00015fa0: 5d20 3d3d 2035 5c6e 6173 7365 7274 2065  ] == 5\nassert e
+00015fb0: 7665 6e74 352e 6964 206e 6f74 2069 6e20  vent5.id not in 
+00015fc0: 6163 6b65 645f 6576 656e 7473 5c6e 6060  acked_events\n``
+00015fd0: 605c 6e5c 6e23 2323 2047 6574 2073 7562  `\n\n### Get sub
+00015fe0: 7363 7269 7074 696f 6e20 696e 666f 5c6e  scription info\n
+00015ff0: 5c6e 2a72 6571 7569 7265 7320 6c65 6164  \n*requires lead
+00016000: 6572 2a5c 6e5c 6e54 6865 2060 6765 745f  er*\n\nThe `get_
+00016010: 7375 6273 6372 6970 7469 6f6e 5f69 6e66  subscription_inf
+00016020: 6f28 2960 206d 6574 686f 6420 6361 6e20  o()` method can 
+00016030: 6265 2075 7365 6420 746f 2067 6574 2069  be used to get i
+00016040: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2061  nformation for a
+00016050: 5c6e 7065 7273 6973 7465 6e74 2073 7562  \npersistent sub
+00016060: 7363 7269 7074 696f 6e2e 5c6e 5c6e 5468  scription.\n\nTh
+00016070: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+00016080: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+00016090: 656e 742c 2060 6772 6f75 705f 6e61 6d65  ent, `group_name
+000160a0: 602c 2077 6869 6368 5c6e 7368 6f75 6c64  `, which\nshould
+000160b0: 206d 6174 6368 2074 6865 2076 616c 7565   match the value
+000160c0: 206f 6620 7468 6520 6172 6775 6d65 6e74   of the argument
+000160d0: 2075 7365 6420 7768 656e 2063 616c 6c69   used when calli
+000160e0: 6e67 2060 6372 6561 7465 5f73 7562 7363  ng `create_subsc
+000160f0: 7269 7074 696f 6e28 2960 2e5c 6e5c 6e54  ription()`.\n\nT
+00016100: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
+00016110: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+00016120: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+00016130: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
+00016140: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+00016150: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
+00016160: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+00016170: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
+00016180: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00016190: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
+000161a0: 5c6e 6060 6070 7974 686f 6e5c 6e73 7562  \n```python\nsub
+000161b0: 7363 7269 7074 696f 6e5f 696e 666f 203d  scription_info =
+000161c0: 2063 6c69 656e 742e 6765 745f 7375 6273   client.get_subs
+000161d0: 6372 6970 7469 6f6e 5f69 6e66 6f28 5c6e  cription_info(\n
+000161e0: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
+000161f0: 726f 7570 5f6e 616d 6531 2c5c 6e29 5c6e  roup_name1,\n)\n
+00016200: 6060 605c 6e5c 6e54 6865 2072 6574 7572  ```\n\nThe retur
+00016210: 6e65 6420 7661 6c75 6520 6973 2061 2060  ned value is a `
+00016220: 5375 6273 6372 6970 7469 6f6e 496e 666f  SubscriptionInfo
+00016230: 6020 6f62 6a65 6374 2e5c 6e5c 6e23 2323  ` object.\n\n###
+00016240: 204c 6973 7420 7375 6273 6372 6970 7469   List subscripti
+00016250: 6f6e 735c 6e5c 6e2a 7265 7175 6972 6573  ons\n\n*requires
+00016260: 206c 6561 6465 722a 5c6e 5c6e 5468 6520   leader*\n\nThe 
+00016270: 606c 6973 745f 7375 6273 6372 6970 7469  `list_subscripti
+00016280: 6f6e 7328 2960 206d 6574 686f 6420 6361  ons()` method ca
+00016290: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+000162a0: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
+000162b0: 2061 6c6c 5c6e 6578 6973 7469 6e67 2070   all\nexisting p
+000162c0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+000162d0: 6970 7469 6f6e 732e 5c6e 5c6e 5468 6973  iptions.\n\nThis
+000162e0: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+000162f0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00016300: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
+00016310: 5c6e 6973 2065 7870 6563 7465 6420 746f  \nis expected to
+00016320: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+00016330: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+00016340: 2061 2064 6561 646c 696e 655c 6e66 6f72   a deadline\nfor
+00016350: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00016360: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00016370: 6174 696f 6e2e 5c6e 5c6e 6060 6070 7974  ation.\n\n```pyt
+00016380: 686f 6e5c 6e73 7562 7363 7269 7074 696f  hon\nsubscriptio
+00016390: 6e73 203d 2063 6c69 656e 742e 6c69 7374  ns = client.list
+000163a0: 5f73 7562 7363 7269 7074 696f 6e73 2829  _subscriptions()
+000163b0: 5c6e 6060 605c 6e5c 6e54 6865 2072 6574  \n```\n\nThe ret
+000163c0: 7572 6e65 6420 7661 6c75 6520 6973 2061  urned value is a
+000163d0: 206c 6973 7420 6f66 2060 5375 6273 6372   list of `Subscr
+000163e0: 6970 7469 6f6e 496e 666f 6020 6f62 6a65  iptionInfo` obje
+000163f0: 6374 732e 5c6e 5c6e 2323 2320 5570 6461  cts.\n\n### Upda
+00016400: 7465 2073 7562 7363 7269 7074 696f 6e5c  te subscription\
+00016410: 6e5c 6e2a 7265 7175 6972 6573 206c 6561  n\n*requires lea
+00016420: 6465 722a 5c6e 5c6e 5468 6520 6075 7064  der*\n\nThe `upd
+00016430: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00016440: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00016450: 6520 7573 6564 2074 6f20 7570 6461 7465  e used to update
+00016460: 2061 5c6e 2270 6572 7369 7374 656e 7420   a\n"persistent 
+00016470: 7375 6273 6372 6970 7469 6f6e 222e 5c6e  subscription".\n
+00016480: 5c6e 5468 6973 206d 6574 686f 6420 6861  \nThis method ha
+00016490: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
+000164a0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+000164b0: 6e74 2c20 7768 6963 6820 6973 2074 6865  nt, which is the
+000164c0: 5c6e 6e61 6d65 206f 6620 6120 2267 726f  \nname of a "gro
+000164d0: 7570 2220 6f66 2063 6f6e 7375 6d65 7273  up" of consumers
+000164e0: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
+000164f0: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
+00016500: 7468 6f64 2061 6c73 6f20 6861 7320 7468  thod also has th
+00016510: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
+00016520: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
+00016530: 6460 2c20 6063 6f6d 6d69 745f 706f 7369  d`, `commit_posi
+00016540: 7469 6f6e 602c 5c6e 616e 6420 6074 696d  tion`,\nand `tim
+00016550: 656f 7574 602e 5c6e 5c6e 5468 6520 6f70  eout`.\n\nThe op
+00016560: 7469 6f6e 616c 2060 6672 6f6d 5f65 6e64  tional `from_end
+00016570: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+00016580: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+00016590: 7920 7468 6174 2074 6865 2067 726f 7570  y that the group
+000165a0: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
+000165b0: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+000165c0: 6f6e 2073 686f 756c 6420 6f6e 6c79 2072  on should only r
+000165d0: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
+000165e0: 6174 2077 6572 6520 7265 636f 7264 6564  at were recorded
+000165f0: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
+00016600: 7269 7074 696f 6e5c 6e77 6173 2075 7064  ription\nwas upd
+00016610: 6174 6564 2e5c 6e5c 6e41 6c74 6572 6e61  ated.\n\nAlterna
+00016620: 7469 7665 6c79 2c20 7468 6520 6f70 7469  tively, the opti
+00016630: 6f6e 616c 2060 636f 6d6d 6974 5f70 6f73  onal `commit_pos
+00016640: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+00016650: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
+00016660: 7065 6369 6679 2061 2063 6f6d 6d69 745c  pecify a commit\
+00016670: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
+00016680: 6869 6368 2063 6f6d 6d69 7420 706f 7369  hich commit posi
+00016690: 7469 6f6e 2074 6865 2067 726f 7570 206f  tion the group o
+000166a0: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+000166b0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+000166c0: 7368 6f75 6c64 5c6e 7265 6365 6976 6520  should\nreceive 
+000166d0: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
+000166e0: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
+000166f0: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
+00016700: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
+00016710: 706f 7369 7469 6f6e 206d 6967 6874 5c6e  position might\n
+00016720: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+00016730: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00016740: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+00016750: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00016760: 756d 6572 732e 5c6e 5c6e 4966 206e 6569  umers.\n\nIf nei
+00016770: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
+00016780: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
+00016790: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
+000167a0: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
+000167b0: 2063 6f6e 7375 6d65 7273 5c6e 6f66 2074   consumers\nof t
+000167c0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+000167d0: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
+000167e0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+000167f0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
+00016800: 7468 6520 6461 7461 6261 7365 2e5c 6e5c  the database.\n\
+00016810: 6e50 6c65 6173 6520 6e6f 7465 2c20 7468  nPlease note, th
+00016820: 6520 6669 6c74 6572 206f 7074 696f 6e73  e filter options
+00016830: 2061 6e64 2063 6f6e 7375 6d65 7220 7374   and consumer st
+00016840: 7261 7465 6779 2063 616e 6e6f 7420 6265  rategy cannot be
+00016850: 2061 646a 7573 7465 642e 5c6e 5c6e 5468   adjusted.\n\nTh
+00016860: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+00016870: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+00016880: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00016890: 6020 7768 6963 6820 7365 7473 2061 5c6e  ` which sets a\n
+000168a0: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
+000168b0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+000168c0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+000168d0: 6e2e 5c6e 5c6e 5468 6520 6d65 7468 6f64  n.\n\nThe method
+000168e0: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
+000168f0: 7074 696f 6e28 2960 2064 6f65 7320 6e6f  ption()` does no
+00016900: 7420 7265 7475 726e 2061 2076 616c 7565  t return a value
+00016910: 2e5c 6e5c 6e49 6e20 7468 6520 6578 616d  .\n\nIn the exam
+00016920: 706c 6520 6265 6c6f 772c 2061 2070 6572  ple below, a per
+00016930: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00016940: 7469 6f6e 2069 7320 7570 6461 7465 6420  tion is updated 
+00016950: 746f 2072 756e 2066 726f 6d20 7468 6520  to run from the 
+00016960: 656e 6420 6f66 2074 6865 5c6e 6461 7461  end of the\ndata
+00016970: 6261 7365 2e5c 6e5c 6e60 6060 7079 7468  base.\n\n```pyth
+00016980: 6f6e 5c6e 2320 4372 6561 7465 2061 2070  on\n# Create a p
+00016990: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+000169a0: 6970 7469 6f6e 2e5c 6e63 6c69 656e 742e  iption.\nclient.
+000169b0: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+000169c0: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
+000169d0: 726f 7570 5f6e 616d 6531 2c20 6672 6f6d  roup_name1, from
+000169e0: 5f65 6e64 3d54 7275 6529 5c6e 6060 605c  _end=True)\n```\
+000169f0: 6e5c 6e23 2323 2043 7265 6174 6520 7374  n\n### Create st
+00016a00: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
+00016a10: 6e5c 6e5c 6e2a 7265 7175 6972 6573 206c  n\n\n*requires l
+00016a20: 6561 6465 722a 5c6e 5c6e 5468 6520 6063  eader*\n\nThe `c
+00016a30: 7265 6174 655f 7374 7265 616d 5f73 7562  reate_stream_sub
+00016a40: 7363 7269 7074 696f 6e28 2960 206d 6574  scription()` met
+00016a50: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00016a60: 746f 2063 7265 6174 6520 6120 7065 7273  to create a pers
+00016a70: 6973 7465 6e74 5c6e 7375 6273 6372 6970  istent\nsubscrip
+00016a80: 7469 6f6e 2066 6f72 2061 2073 7472 6561  tion for a strea
+00016a90: 6d2e 5c6e 5c6e 5468 6973 206d 6574 686f  m.\n\nThis metho
+00016aa0: 6420 6861 7320 7477 6f20 7265 7175 6972  d has two requir
+00016ab0: 6564 2061 7267 756d 656e 7473 2c20 6067  ed arguments, `g
+00016ac0: 726f 7570 5f6e 616d 6560 2061 6e64 2060  roup_name` and `
+00016ad0: 7374 7265 616d 5f6e 616d 6560 2e20 5468  stream_name`. Th
+00016ae0: 655c 6e60 6772 6f75 705f 6e61 6d65 6020  e\n`group_name` 
+00016af0: 6172 6775 6d65 6e74 206e 616d 6573 2074  argument names t
+00016b00: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00016b10: 756d 6572 7320 7468 6174 2077 696c 6c20  umers that will 
+00016b20: 7265 6365 6976 6520 6576 656e 7473 5c6e  receive events\n
+00016b30: 6672 6f6d 2074 6869 7320 7375 6273 6372  from this subscr
+00016b40: 6970 7469 6f6e 2e20 5468 6520 6073 7472  iption. The `str
+00016b50: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
+00016b60: 6e74 2073 7065 6369 6669 6573 2077 6869  nt specifies whi
+00016b70: 6368 2073 7472 6561 6d5c 6e74 6865 2073  ch stream\nthe s
+00016b80: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+00016b90: 2066 6f6c 6c6f 772e 2054 6865 2076 616c   follow. The val
+00016ba0: 7565 7320 6f66 2062 6f74 6820 7468 6573  ues of both thes
+00016bb0: 6520 6172 6775 6d65 6e74 7320 6172 6520  e arguments are 
+00016bc0: 6578 7065 6374 6564 5c6e 746f 2062 6520  expected\nto be 
+00016bd0: 5079 7468 6f6e 2060 7374 7260 206f 626a  Python `str` obj
+00016be0: 6563 7473 2e5c 6e5c 6e54 6865 206d 6574  ects.\n\nThe met
+00016bf0: 686f 6420 616c 736f 2068 6173 2066 6f75  hod also has fou
+00016c00: 7220 6f70 7469 6f6e 616c 2061 7267 756d  r optional argum
+00016c10: 656e 7473 2c20 6073 7472 6561 6d5f 706f  ents, `stream_po
+00016c20: 7369 7469 6f6e 602c 2060 6672 6f6d 5f65  sition`, `from_e
+00016c30: 6e64 602c 5c6e 6063 6f6e 7375 6d65 725f  nd`,\n`consumer_
+00016c40: 7374 7261 7465 6779 602c 2061 6e64 2060  strategy`, and `
+00016c50: 7469 6d65 6f75 7460 2e5c 6e5c 6e54 6869  timeout`.\n\nThi
+00016c60: 7320 6f70 7469 6f6e 616c 2060 7374 7265  s optional `stre
+00016c70: 616d 5f70 6f73 6974 696f 6e60 2061 7267  am_position` arg
+00016c80: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
+00016c90: 6120 7374 7265 616d 2070 6f73 6974 696f  a stream positio
+00016ca0: 6e20 6672 6f6d 5c6e 7768 6963 6820 746f  n from\nwhich to
+00016cb0: 2073 7562 7363 7269 6265 2e20 5468 6520   subscribe. The 
+00016cc0: 7265 636f 7264 6564 2065 7665 6e74 2061  recorded event a
+00016cd0: 7420 7468 6973 2073 7472 6561 6d5c 6e70  t this stream\np
+00016ce0: 6f73 6974 696f 6e20 7769 6c6c 2062 6520  osition will be 
+00016cf0: 7265 6365 6976 6564 2077 6865 6e20 7265  received when re
+00016d00: 6164 696e 6720 7468 6520 7375 6273 6372  ading the subscr
+00016d10: 6970 7469 6f6e 2e5c 6e5c 6e54 6869 7320  iption.\n\nThis 
+00016d20: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
+00016d30: 6e64 6020 6172 6775 6d65 6e74 2069 7320  nd` argument is 
+00016d40: 6120 5079 7468 6f6e 2060 626f 6f6c 602e  a Python `bool`.
+00016d50: 5c6e 4279 2064 6566 6175 6c74 2c20 7468  \nBy default, th
+00016d60: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
+00016d70: 6172 6775 6d65 6e74 2069 7320 6046 616c  argument is `Fal
+00016d80: 7365 602e 2049 6620 7468 6973 2061 7267  se`. If this arg
+00016d90: 756d 656e 7420 6973 2073 6574 5c6e 746f  ument is set\nto
+00016da0: 2060 5472 7565 602c 2072 6561 6469 6e67   `True`, reading
+00016db0: 2066 726f 6d20 7468 6520 7375 6273 6372   from the subscr
+00016dc0: 6970 7469 6f6e 2077 696c 6c20 7265 6365  iption will rece
+00016dd0: 6976 6520 6f6e 6c79 2065 7665 6e74 735c  ive only events\
+00016de0: 6e72 6563 6f72 6465 6420 6166 7465 7220  nrecorded after 
+00016df0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00016e00: 2077 6173 2063 7265 6174 6564 2e20 5468   was created. Th
+00016e10: 6174 2069 732c 2069 7420 6973 206e 6f74  at is, it is not
+00016e20: 2069 6e63 6c75 7369 7665 5c6e 6f66 2074   inclusive\nof t
+00016e30: 6865 2063 7572 7265 6e74 2073 7472 6561  he current strea
+00016e40: 6d20 706f 7369 7469 6f6e 2e5c 6e5c 6e54  m position.\n\nT
+00016e50: 6865 206f 7074 696f 6e61 6c20 6063 6f6e  he optional `con
+00016e60: 7375 6d65 725f 7374 7261 7465 6779 6020  sumer_strategy` 
+00016e70: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00016e80: 7468 6f6e 2060 7374 7260 2074 6861 7420  thon `str` that 
+00016e90: 6465 6669 6e65 735c 6e74 6865 2063 6f6e  defines\nthe con
+00016ea0: 7375 6d65 7220 7374 7261 7465 6779 2066  sumer strategy f
+00016eb0: 6f72 2074 6869 7320 7065 7273 6973 7465  or this persiste
+00016ec0: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
+00016ed0: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
+00016ee0: 6973 2061 7267 756d 656e 745c 6e63 616e  is argument\ncan
+00016ef0: 2062 6520 605c 2744 6973 7061 7463 6854   be `\'DispatchT
+00016f00: 6f53 696e 676c 655c 2760 2c20 605c 2752  oSingle\'`, `\'R
+00016f10: 6f75 6e64 526f 6269 6e5c 2760 2c20 605c  oundRobin\'`, `\
+00016f20: 2750 696e 6e65 645c 2760 2c20 6f72 2060  'Pinned\'`, or `
+00016f30: 5c27 5069 6e6e 6564 4279 436f 7272 656c  \'PinnedByCorrel
+00016f40: 6174 696f 6e5c 2760 2e20 5468 655c 6e64  ation\'`. The\nd
+00016f50: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
+00016f60: 605c 2744 6973 7061 7463 6854 6f53 696e  `\'DispatchToSin
+00016f70: 676c 655c 2760 2e5c 6e5c 6e54 6869 7320  gle\'`.\n\nThis 
+00016f80: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
+00016f90: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00016fa0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00016fb0: 2c20 7468 6174 5c6e 6973 2065 7870 6563  , that\nis expec
+00016fc0: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+00016fd0: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+00016fe0: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+00016ff0: 655c 6e66 6f72 2074 6865 2063 6f6d 706c  e\nfor the compl
+00017000: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00017010: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
+00017020: 5468 6973 206d 6574 686f 6420 646f 6573  This method does
+00017030: 206e 6f74 2072 6574 7572 6e20 6120 7661   not return a va
+00017040: 6c75 652e 2045 7665 6e74 7320 6361 6e20  lue. Events can 
+00017050: 6265 2072 6563 6569 7665 6420 6279 2063  be received by c
+00017060: 616c 6c69 6e67 5c6e 6072 6561 645f 7374  alling\n`read_st
+00017070: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00017080: 6e28 2960 2e5c 6e5c 6e54 6865 2065 7861  n()`.\n\nThe exa
+00017090: 6d70 6c65 2062 656c 6f77 2063 7265 6174  mple below creat
+000170a0: 6573 2061 2070 6572 7369 7374 656e 7420  es a persistent 
+000170b0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+000170c0: 696f 6e20 6672 6f6d 2074 6865 2073 7461  ion from the sta
+000170d0: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
+000170e0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+000170f0: 2320 4372 6561 7465 2061 2070 6572 7369  # Create a persi
+00017100: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
+00017110: 7363 7269 7074 696f 6e20 6672 6f6d 2073  scription from s
+00017120: 7461 7274 206f 6620 7468 6520 7374 7265  tart of the stre
+00017130: 616d 2e5c 6e67 726f 7570 5f6e 616d 6532  am.\ngroup_name2
+00017140: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
+00017150: 2e75 7569 6434 2829 7d22 5c6e 636c 6965  .uuid4()}"\nclie
+00017160: 6e74 2e63 7265 6174 655f 7374 7265 616d  nt.create_stream
+00017170: 5f73 7562 7363 7269 7074 696f 6e28 5c6e  _subscription(\n
+00017180: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
+00017190: 726f 7570 5f6e 616d 6532 2c5c 6e20 2020  roup_name2,\n   
+000171a0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+000171b0: 6561 6d5f 6e61 6d65 322c 5c6e 295c 6e60  eam_name2,\n)\n`
+000171c0: 6060 5c6e 5c6e 2323 2320 5265 6164 2073  ``\n\n### Read s
+000171d0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+000171e0: 6f6e 5c6e 5c6e 2a72 6571 7569 7265 7320  on\n\n*requires 
+000171f0: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
+00017200: 7265 6164 5f73 7472 6561 6d5f 7375 6273  read_stream_subs
+00017210: 6372 6970 7469 6f6e 2829 6020 6d65 7468  cription()` meth
+00017220: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+00017230: 6f20 7265 6164 2061 2070 6572 7369 7374  o read a persist
+00017240: 656e 745c 6e73 7472 6561 6d20 7375 6273  ent\nstream subs
+00017250: 6372 6970 7469 6f6e 2e5c 6e5c 6e54 6869  cription.\n\nThi
+00017260: 7320 6d65 7468 6f64 2068 6173 2074 776f  s method has two
+00017270: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00017280: 6e74 732c 2060 6772 6f75 705f 6e61 6d65  nts, `group_name
+00017290: 6020 616e 6420 6073 7472 6561 6d5f 6e61  ` and `stream_na
+000172a0: 6d65 602c 2077 6869 6368 5c6e 7368 6f75  me`, which\nshou
+000172b0: 6c64 206d 6174 6368 2074 6865 2076 616c  ld match the val
+000172c0: 7565 7320 6f66 2061 7267 756d 656e 7473  ues of arguments
+000172d0: 2075 7365 6420 7768 656e 2063 616c 6c69   used when calli
+000172e0: 6e67 2060 6372 6561 7465 5f73 7472 6561  ng `create_strea
+000172f0: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
+00017300: 602e 5c6e 5c6e 5468 6973 206d 6574 686f  `.\n\nThis metho
+00017310: 6420 616c 736f 2068 6173 2061 6e20 6f70  d also has an op
+00017320: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00017330: 2061 7267 756d 656e 742c 2074 6861 745c   argument, that\
+00017340: 6e69 7320 6578 7065 6374 6564 2074 6f20  nis expected to 
+00017350: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
+00017360: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
+00017370: 6120 6465 6164 6c69 6e65 5c6e 666f 7220  a deadline\nfor 
+00017380: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00017390: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+000173a0: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
+000173b0: 7468 6f64 2072 6574 7572 6e73 2061 2060  thod returns a `
+000173c0: 5065 7273 6973 7465 6e74 5375 6273 6372  PersistentSubscr
+000173d0: 6970 7469 6f6e 6020 6f62 6a65 6374 2c20  iption` object, 
+000173e0: 7768 6963 6820 6973 2061 6e20 6974 6572  which is an iter
+000173f0: 6174 6f72 5c6e 6769 7669 6e67 2060 5265  ator\ngiving `Re
+00017400: 636f 7264 6564 4576 656e 7460 206f 626a  cordedEvent` obj
+00017410: 6563 7473 2c20 7468 6174 2061 6c73 6f20  ects, that also 
+00017420: 6861 7320 6061 636b 2829 602c 2060 6e61  has `ack()`, `na
+00017430: 636b 2829 6020 616e 6420 6073 746f 7028  ck()` and `stop(
+00017440: 2960 5c6e 6d65 7468 6f64 732e 5c6e 5c6e  )`\nmethods.\n\n
+00017450: 6060 6070 7974 686f 6e5c 6e73 7562 7363  ```python\nsubsc
+00017460: 7269 7074 696f 6e20 3d20 636c 6965 6e74  ription = client
+00017470: 2e72 6561 645f 7374 7265 616d 5f73 7562  .read_stream_sub
+00017480: 7363 7269 7074 696f 6e28 5c6e 2020 2020  scription(\n    
+00017490: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+000174a0: 5f6e 616d 6532 2c5c 6e20 2020 2073 7472  _name2,\n    str
+000174b0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+000174c0: 6e61 6d65 322c 5c6e 295c 6e60 6060 5c6e  name2,\n)\n```\n
+000174d0: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
+000174e0: 6c6f 7720 6974 6572 6174 6573 206f 7665  low iterates ove
+000174f0: 7220 7468 6520 7375 6273 6372 6970 7469  r the subscripti
+00017500: 6f6e 206f 626a 6563 742c 2061 6e64 2063  on object, and c
+00017510: 616c 6c73 2060 6163 6b28 2960 2e5c 6e54  alls `ack()`.\nT
+00017520: 6865 2066 6f72 206c 6f6f 7020 6272 6561  he for loop brea
+00017530: 6b73 2077 6865 6e20 7765 2068 6176 6520  ks when we have 
+00017540: 7265 6365 6976 6564 2074 6865 206c 6173  received the las
+00017550: 7420 6576 656e 7420 696e 2074 6865 2073  t event in the s
+00017560: 7472 6561 6d2c 2073 6f5c 6e74 6861 7420  tream, so\nthat 
+00017570: 7765 2063 616e 2066 696e 6973 6820 7468  we can finish th
+00017580: 6520 6578 616d 706c 6573 2069 6e20 7468  e examples in th
+00017590: 6973 2064 6f63 756d 656e 7461 7469 6f6e  is documentation
+000175a0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+000175b0: 6576 656e 7473 203d 205b 5d5c 6e66 6f72  events = []\nfor
+000175c0: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
+000175d0: 6970 7469 6f6e 3a5c 6e20 2020 2065 7665  iption:\n    eve
+000175e0: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
+000175f0: 295c 6e5c 6e20 2020 2023 2041 636b 6e6f  )\n\n    # Ackno
+00017600: 776c 6564 6765 2074 6865 2072 6563 6569  wledge the recei
+00017610: 7665 6420 6576 656e 742e 5c6e 2020 2020  ved event.\n    
+00017620: 7375 6273 6372 6970 7469 6f6e 2e61 636b  subscription.ack
+00017630: 2865 7665 6e74 5f69 643d 6576 656e 742e  (event_id=event.
+00017640: 6964 295c 6e5c 6e20 2020 2023 2053 746f  id)\n\n    # Sto
+00017650: 7020 7768 656e 205c 2765 7665 6e74 365c  p when \'event6\
+00017660: 2720 6861 7320 6265 656e 2072 6563 6569  ' has been recei
+00017670: 7665 642e 5c6e 2020 2020 6966 2065 7665  ved.\n    if eve
+00017680: 6e74 2e69 6420 3d3d 2065 7665 6e74 362e  nt.id == event6.
+00017690: 6964 3a5c 6e20 2020 2020 2020 2073 7562  id:\n        sub
+000176a0: 7363 7269 7074 696f 6e2e 7374 6f70 2829  scription.stop()
+000176b0: 5c6e 6060 605c 6e5c 6e57 6520 6361 6e20  \n```\n\nWe can 
+000176c0: 6368 6563 6b20 7765 2072 6563 6569 7665  check we receive
+000176d0: 6420 616c 6c20 7468 6520 6576 656e 7473  d all the events
+000176e0: 2074 6861 7420 7765 7265 2061 7070 656e   that were appen
+000176f0: 6465 6420 746f 2060 7374 7265 616d 5f6e  ded to `stream_n
+00017700: 616d 6532 605c 6e69 6e20 7468 6520 6578  ame2`\nin the ex
+00017710: 616d 706c 6573 2061 626f 7665 2e5c 6e5c  amples above.\n\
+00017720: 6e60 6060 7079 7468 6f6e 5c6e 6173 7365  n```python\nasse
+00017730: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
+00017740: 3d20 335c 6e61 7373 6572 7420 6576 656e  = 3\nassert even
+00017750: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
+00017760: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+00017770: 325c 6e61 7373 6572 7420 6576 656e 7473  2\nassert events
+00017780: 5b30 5d2e 6964 203d 3d20 6576 656e 7434  [0].id == event4
+00017790: 2e69 645c 6e61 7373 6572 7420 6576 656e  .id\nassert even
+000177a0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
+000177b0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+000177c0: 325c 6e61 7373 6572 7420 6576 656e 7473  2\nassert events
+000177d0: 5b31 5d2e 6964 203d 3d20 6576 656e 7435  [1].id == event5
+000177e0: 2e69 645c 6e61 7373 6572 7420 6576 656e  .id\nassert even
+000177f0: 7473 5b32 5d2e 7374 7265 616d 5f6e 616d  ts[2].stream_nam
+00017800: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+00017810: 325c 6e61 7373 6572 7420 6576 656e 7473  2\nassert events
+00017820: 5b32 5d2e 6964 203d 3d20 6576 656e 7436  [2].id == event6
+00017830: 2e69 645c 6e60 6060 5c6e 5c6e 2323 2320  .id\n```\n\n### 
+00017840: 4765 7420 7374 7265 616d 2073 7562 7363  Get stream subsc
+00017850: 7269 7074 696f 6e20 696e 666f 5c6e 5c6e  ription info\n\n
+00017860: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+00017870: 2a5c 6e5c 6e54 6865 2060 6765 745f 7374  *\n\nThe `get_st
+00017880: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00017890: 6e5f 696e 666f 2829 6020 6d65 7468 6f64  n_info()` method
+000178a0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+000178b0: 6765 7420 696e 666f 726d 6174 696f 6e20  get information 
+000178c0: 666f 7220 615c 6e70 6572 7369 7374 656e  for a\npersisten
+000178d0: 7420 7375 6273 6372 6970 7469 6f6e 2066  t subscription f
+000178e0: 6f72 2061 2073 7472 6561 6d2e 5c6e 5c6e  or a stream.\n\n
+000178f0: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00017900: 7477 6f20 7265 7175 6972 6564 2061 7267  two required arg
+00017910: 756d 656e 7473 2c20 6067 726f 7570 5f6e  uments, `group_n
+00017920: 616d 6560 2061 6e64 2060 7374 7265 616d  ame` and `stream
+00017930: 5f6e 616d 6560 2c20 7768 6963 685c 6e73  _name`, which\ns
+00017940: 686f 756c 6420 6d61 7463 6820 7468 6520  hould match the 
+00017950: 7661 6c75 6573 206f 6620 6172 6775 6d65  values of argume
+00017960: 6e74 7320 7573 6564 2077 6865 6e20 6361  nts used when ca
+00017970: 6c6c 696e 6720 6063 7265 6174 655f 7374  lling `create_st
+00017980: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00017990: 6e28 2960 2e5c 6e5c 6e54 6869 7320 6d65  n()`.\n\nThis me
+000179a0: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
+000179b0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+000179c0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
+000179d0: 6174 5c6e 6973 2065 7870 6563 7465 6420  at\nis expected 
+000179e0: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
+000179f0: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
+00017a00: 7473 2061 2064 6561 646c 696e 655c 6e66  ts a deadline\nf
+00017a10: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+00017a20: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00017a30: 6572 6174 696f 6e2e 5c6e 5c6e 6060 6070  eration.\n\n```p
+00017a40: 7974 686f 6e5c 6e73 7562 7363 7269 7074  ython\nsubscript
+00017a50: 696f 6e5f 696e 666f 203d 2063 6c69 656e  ion_info = clien
+00017a60: 742e 6765 745f 7374 7265 616d 5f73 7562  t.get_stream_sub
+00017a70: 7363 7269 7074 696f 6e5f 696e 666f 285c  scription_info(\
+00017a80: 6e20 2020 2067 726f 7570 5f6e 616d 653d  n    group_name=
+00017a90: 6772 6f75 705f 6e61 6d65 322c 5c6e 2020  group_name2,\n  
+00017aa0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00017ab0: 7265 616d 5f6e 616d 6532 2c5c 6e29 5c6e  ream_name2,\n)\n
+00017ac0: 6060 605c 6e5c 6e54 6865 2072 6574 7572  ```\n\nThe retur
+00017ad0: 6e65 6420 7661 6c75 6520 6973 2061 2060  ned value is a `
+00017ae0: 5375 6273 6372 6970 7469 6f6e 496e 666f  SubscriptionInfo
+00017af0: 6020 6f62 6a65 6374 2e5c 6e5c 6e5c 6e23  ` object.\n\n\n#
+00017b00: 2323 204c 6973 7420 7374 7265 616d 2073  ## List stream s
+00017b10: 7562 7363 7269 7074 696f 6e73 5c6e 5c6e  ubscriptions\n\n
+00017b20: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+00017b30: 2a5c 6e5c 6e54 6865 2060 6c69 7374 5f73  *\n\nThe `list_s
+00017b40: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+00017b50: 6f6e 7328 2960 206d 6574 686f 6420 6361  ons()` method ca
+00017b60: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+00017b70: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
+00017b80: 2061 6c6c 5c6e 7468 6520 7065 7273 6973   all\nthe persis
+00017b90: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00017ba0: 6e73 2066 6f72 2061 2073 7472 6561 6d2e  ns for a stream.
+00017bb0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00017bc0: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
+00017bd0: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
+00017be0: 616d 5f6e 616d 6560 2e5c 6e5c 6e54 6869  am_name`.\n\nThi
+00017bf0: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
+00017c00: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00017c10: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00017c20: 2c20 7468 6174 5c6e 6973 2065 7870 6563  , that\nis expec
+00017c30: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+00017c40: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+00017c50: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+00017c60: 655c 6e66 6f72 2074 6865 2063 6f6d 706c  e\nfor the compl
+00017c70: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00017c80: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
+00017c90: 6060 6070 7974 686f 6e5c 6e73 7562 7363  ```python\nsubsc
+00017ca0: 7269 7074 696f 6e73 203d 2063 6c69 656e  riptions = clien
+00017cb0: 742e 6c69 7374 5f73 7472 6561 6d5f 7375  t.list_stream_su
+00017cc0: 6273 6372 6970 7469 6f6e 7328 5c6e 2020  bscriptions(\n  
+00017cd0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00017ce0: 7265 616d 5f6e 616d 6532 2c5c 6e29 5c6e  ream_name2,\n)\n
+00017cf0: 6060 605c 6e5c 6e54 6865 2072 6574 7572  ```\n\nThe retur
+00017d00: 6e65 6420 7661 6c75 6520 6973 2061 206c  ned value is a l
+00017d10: 6973 7420 6f66 2060 5375 6273 6372 6970  ist of `Subscrip
+00017d20: 7469 6f6e 496e 666f 6020 6f62 6a65 6374  tionInfo` object
+00017d30: 732e 5c6e 5c6e 2323 2320 5570 6461 7465  s.\n\n### Update
+00017d40: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00017d50: 7469 6f6e 5c6e 5c6e 2a72 6571 7569 7265  tion\n\n*require
+00017d60: 7320 6c65 6164 6572 2a5c 6e5c 6e54 6865  s leader*\n\nThe
+00017d70: 2060 7570 6461 7465 5f73 7472 6561 6d5f   `update_stream_
+00017d80: 7375 6273 6372 6970 7469 6f6e 2829 6020  subscription()` 
+00017d90: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00017da0: 6564 2074 6f20 7570 6461 7465 2061 5c6e  ed to update a\n
+00017db0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00017dc0: 7269 7074 696f 6e20 666f 7220 6120 7374  ription for a st
+00017dd0: 7265 616d 2e5c 6e5c 6e54 6869 7320 6d65  ream.\n\nThis me
+00017de0: 7468 6f64 2068 6173 2061 2072 6571 7569  thod has a requi
+00017df0: 7265 6420 6067 726f 7570 5f6e 616d 6560  red `group_name`
+00017e00: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00017e10: 2069 7320 7468 655c 6e6e 616d 6520 6f66   is the\nname of
+00017e20: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
+00017e30: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
+00017e40: 7562 7363 7269 7074 696f 6e2c 2061 6e64  ubscription, and
+00017e50: 2061 2072 6571 7569 7265 645c 6e60 7374   a required\n`st
+00017e60: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+00017e70: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
+00017e80: 6520 6e61 6d65 206f 6620 6120 7374 7265  e name of a stre
+00017e90: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
+00017ea0: 6f64 2061 6c73 6f20 6861 7320 7468 7265  od also has thre
+00017eb0: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
+00017ec0: 656e 7473 2c20 6066 726f 6d5f 656e 6460  ents, `from_end`
+00017ed0: 2c20 6073 7472 6561 6d5f 706f 7369 7469  , `stream_positi
+00017ee0: 6f6e 602c 5c6e 616e 6420 6074 696d 656f  on`,\nand `timeo
+00017ef0: 7574 602e 5c6e 5c6e 5468 6520 6f70 7469  ut`.\n\nThe opti
+00017f00: 6f6e 616c 2060 6672 6f6d 5f65 6e64 6020  onal `from_end` 
+00017f10: 6172 6775 6d65 6e74 2063 616e 2062 6520  argument can be 
+00017f20: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
+00017f30: 7468 6174 2074 6865 2067 726f 7570 206f  that the group o
+00017f40: 6620 636f 6e73 756d 6572 735c 6e6f 6620  f consumers\nof 
+00017f50: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00017f60: 2073 686f 756c 6420 6f6e 6c79 2072 6563   should only rec
+00017f70: 6569 7665 2065 7665 6e74 7320 7468 6174  eive events that
+00017f80: 2077 6572 6520 7265 636f 7264 6564 2061   were recorded a
+00017f90: 6674 6572 2074 6865 2073 7562 7363 7269  fter the subscri
+00017fa0: 7074 696f 6e5c 6e77 6173 2075 7064 6174  ption\nwas updat
+00017fb0: 6564 2e5c 6e5c 6e41 6c74 6572 6e61 7469  ed.\n\nAlternati
+00017fc0: 7665 6c79 2c20 7468 6520 6f70 7469 6f6e  vely, the option
+00017fd0: 616c 2060 7374 7265 616d 5f70 6f73 6974  al `stream_posit
+00017fe0: 696f 6e60 2061 7267 756d 656e 7420 6361  ion` argument ca
+00017ff0: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
+00018000: 6369 6679 2061 2073 7472 6561 6d5c 6e70  cify a stream\np
+00018010: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
+00018020: 6368 2063 6f6d 6d69 7420 706f 7369 7469  ch commit positi
+00018030: 6f6e 2074 6865 2067 726f 7570 206f 6620  on the group of 
+00018040: 636f 6e73 756d 6572 7320 6f66 2074 6865  consumers of the
+00018050: 2073 7562 7363 7269 7074 696f 6e20 7368   subscription sh
+00018060: 6f75 6c64 5c6e 7265 6365 6976 6520 6576  ould\nreceive ev
+00018070: 656e 7473 2e20 506c 6561 7365 206e 6f74  ents. Please not
+00018080: 652c 2074 6865 2072 6563 6f72 6465 6420  e, the recorded 
+00018090: 6576 656e 7420 6174 2074 6865 2073 7065  event at the spe
+000180a0: 6369 6669 6564 2073 7472 6561 6d20 706f  cified stream po
+000180b0: 7369 7469 6f6e 206d 6967 6874 5c6e 6265  sition might\nbe
+000180c0: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
+000180d0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000180e0: 2072 6563 6569 7665 6420 6279 2074 6865   received by the
+000180f0: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+00018100: 6572 732e 5c6e 5c6e 4966 206e 6569 7468  ers.\n\nIf neith
+00018110: 6572 2060 6672 6f6d 5f65 6e64 6020 6f72  er `from_end` or
+00018120: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00018130: 6e60 2061 7265 2073 7065 6369 6669 6564  n` are specified
+00018140: 2c20 7468 6520 6772 6f75 7020 6f66 2063  , the group of c
+00018150: 6f6e 7375 6d65 7273 5c6e 6f66 2074 6865  onsumers\nof the
+00018160: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+00018170: 6c6c 2070 6f74 656e 7469 616c 6c79 2072  ll potentially r
+00018180: 6563 6569 7665 2061 6c6c 2072 6563 6f72  eceive all recor
+00018190: 6465 6420 6576 656e 7473 2069 6e20 7468  ded events in th
+000181a0: 6520 7374 7265 616d 2e5c 6e5c 6e50 6c65  e stream.\n\nPle
+000181b0: 6173 6520 6e6f 7465 2c20 7468 6520 636f  ase note, the co
+000181c0: 6e73 756d 6572 2073 7472 6174 6567 7920  nsumer strategy 
+000181d0: 6361 6e6e 6f74 2062 6520 6164 6a75 7374  cannot be adjust
+000181e0: 6564 2e5c 6e5c 6e54 6865 206f 7074 696f  ed.\n\nThe optio
+000181f0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00018200: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00018210: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00018220: 2073 6574 7320 615c 6e64 6561 646c 696e   sets a\ndeadlin
+00018230: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+00018240: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00018250: 206f 7065 7261 7469 6f6e 2e5c 6e5c 6e54   operation.\n\nT
+00018260: 6865 2060 7570 6461 7465 5f73 7472 6561  he `update_strea
+00018270: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
+00018280: 6020 6d65 7468 6f64 2064 6f65 7320 6e6f  ` method does no
+00018290: 7420 7265 7475 726e 2061 2076 616c 7565  t return a value
+000182a0: 2e5c 6e5c 6e49 6e20 7468 6520 6578 616d  .\n\nIn the exam
+000182b0: 706c 6520 6265 6c6f 772c 2061 2070 6572  ple below, a per
+000182c0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+000182d0: 7469 6f6e 2066 6f72 2061 2073 7472 6561  tion for a strea
+000182e0: 6d20 6973 2075 7064 6174 6564 2074 6f20  m is updated to 
+000182f0: 7275 6e20 6672 6f6d 2074 6865 5c6e 656e  run from the\nen
+00018300: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
+00018310: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e23  \n\n```python\n#
+00018320: 2043 7265 6174 6520 6120 7065 7273 6973   Create a persis
+00018330: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00018340: 6e2e 5c6e 636c 6965 6e74 2e75 7064 6174  n.\nclient.updat
+00018350: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
+00018360: 7074 696f 6e28 5c6e 2020 2020 6772 6f75  ption(\n    grou
+00018370: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+00018380: 6532 2c5c 6e20 2020 2073 7472 6561 6d5f  e2,\n    stream_
+00018390: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+000183a0: 322c 5c6e 2020 2020 6672 6f6d 5f65 6e64  2,\n    from_end
+000183b0: 3d54 7275 652c 5c6e 295c 6e60 6060 5c6e  =True,\n)\n```\n
+000183c0: 5c6e 2323 2320 5265 706c 6179 2070 6172  \n### Replay par
+000183d0: 6b65 6420 6576 656e 7473 5c6e 5c6e 2a72  ked events\n\n*r
+000183e0: 6571 7569 7265 7320 6c65 6164 6572 2a5c  equires leader*\
+000183f0: 6e5c 6e54 6865 2060 7265 706c 6179 5f70  n\nThe `replay_p
+00018400: 6172 6b65 645f 6576 656e 7473 2829 6020  arked_events()` 
+00018410: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00018420: 6564 2074 6f20 2272 6570 6c61 7922 2065  ed to "replay" e
+00018430: 7665 6e74 7320 7468 6174 2068 6176 655c  vents that have\
+00018440: 6e62 6565 6e20 2270 6172 6b65 6422 2028  nbeen "parked" (
+00018450: 6e65 6761 7469 7665 6c79 2061 636b 6e6f  negatively ackno
+00018460: 776c 6564 6765 6420 7769 7468 2074 6865  wledged with the
+00018470: 2061 6374 696f 6e20 605c 2770 6172 6b5c   action `\'park\
+00018480: 2760 2920 7768 656e 2072 6561 6469 6e67  '`) when reading
+00018490: 5c6e 6120 7065 7273 6973 7465 6e74 2073  \na persistent s
+000184a0: 7562 7363 7269 7074 696f 6e2e 2050 6172  ubscription. Par
+000184b0: 6b65 6420 6576 656e 7473 2077 696c 6c20  ked events will 
+000184c0: 7468 656e 2062 6520 7265 6365 6976 6564  then be received
+000184d0: 2062 7920 7468 6520 636f 6e73 756d 6572   by the consumer
+000184e0: 735c 6e72 6561 6469 6e67 2066 726f 6d20  s\nreading from 
+000184f0: 7468 6520 7065 7273 6973 7465 6e74 2073  the persistent s
+00018500: 7562 7363 7269 7074 696f 6e2e 5c6e 5c6e  ubscription.\n\n
+00018510: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00018520: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
+00018530: 756d 656e 742c 2060 6772 6f75 705f 6e61  ument, `group_na
+00018540: 6d65 602e 2049 7420 6861 7320 6f6e 6520  me`. It has one 
+00018550: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+00018560: 742c 5c6e 6073 7472 6561 6d5f 6e61 6d65  t,\n`stream_name
+00018570: 602e 2054 6865 2076 616c 7565 7320 6f66  `. The values of
+00018580: 2074 6865 7365 2061 7267 756d 656e 7473   these arguments
+00018590: 2073 686f 756c 6420 6d61 7463 6820 7468   should match th
+000185a0: 6f73 6520 7573 6564 2077 6865 6e20 6361  ose used when ca
+000185b0: 6c6c 696e 675c 6e60 6372 6561 7465 5f73  lling\n`create_s
+000185c0: 7562 7363 7269 7074 696f 6e28 2960 206f  ubscription()` o
+000185d0: 7220 6063 7265 6174 655f 7374 7265 616d  r `create_stream
+000185e0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+000185f0: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
+00018600: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
+00018610: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00018620: 6172 6775 6d65 6e74 2c20 7468 6174 5c6e  argument, that\n
+00018630: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+00018640: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
+00018650: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
+00018660: 2064 6561 646c 696e 655c 6e66 6f72 2074   deadline\nfor t
+00018670: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00018680: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00018690: 696f 6e2e 5c6e 5c6e 5468 6520 6578 616d  ion.\n\nThe exam
+000186a0: 706c 6520 6265 6c6f 7720 7265 706c 6179  ple below replay
+000186b0: 7320 7061 726b 6564 2065 7665 6e74 7320  s parked events 
+000186c0: 666f 7220 6772 6f75 7020 6067 726f 7570  for group `group
+000186d0: 5f6e 616d 6531 602e 5c6e 5c6e 6060 6070  _name1`.\n\n```p
+000186e0: 7974 686f 6e5c 6e63 6c69 656e 742e 7265  ython\nclient.re
+000186f0: 706c 6179 5f70 6172 6b65 645f 6576 656e  play_parked_even
+00018700: 7473 285c 6e20 2020 2067 726f 7570 5f6e  ts(\n    group_n
+00018710: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
+00018720: 5c6e 295c 6e60 6060 5c6e 5c6e 5468 6520  \n)\n```\n\nThe 
+00018730: 6578 616d 706c 6520 6265 6c6f 7720 7265  example below re
+00018740: 706c 6179 7320 7061 726b 6564 2065 7665  plays parked eve
+00018750: 6e74 7320 666f 7220 6772 6f75 7020 6067  nts for group `g
+00018760: 726f 7570 5f6e 616d 6532 602e 5c6e 5c6e  roup_name2`.\n\n
+00018770: 6060 6070 7974 686f 6e5c 6e63 6c69 656e  ```python\nclien
+00018780: 742e 7265 706c 6179 5f70 6172 6b65 645f  t.replay_parked_
+00018790: 6576 656e 7473 285c 6e20 2020 2067 726f  events(\n    gro
+000187a0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+000187b0: 6d65 322c 5c6e 2020 2020 7374 7265 616d  me2,\n    stream
+000187c0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+000187d0: 6532 2c5c 6e29 5c6e 6060 605c 6e5c 6e23  e2,\n)\n```\n\n#
+000187e0: 2323 2044 656c 6574 6520 7065 7273 6973  ## Delete persis
+000187f0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00018800: 6e5c 6e5c 6e2a 7265 7175 6972 6573 206c  n\n\n*requires l
+00018810: 6561 6465 722a 5c6e 5c6e 5468 6520 6064  eader*\n\nThe `d
+00018820: 656c 6574 655f 7065 7273 6973 7465 6e74  elete_persistent
+00018830: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00018840: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+00018850: 7365 6420 746f 2064 656c 6574 6520 6120  sed to delete a 
+00018860: 7065 7273 6973 7465 6e74 5c6e 7375 6273  persistent\nsubs
+00018870: 6372 6970 7469 6f6e 2e5c 6e5c 6e54 6869  cription.\n\nThi
+00018880: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
+00018890: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+000188a0: 6e74 2c20 6067 726f 7570 5f6e 616d 6560  nt, `group_name`
+000188b0: 2e20 4974 2068 6173 206f 6e65 206f 7074  . It has one opt
+000188c0: 696f 6e61 6c20 6172 6775 6d65 6e74 2c5c  ional argument,\
+000188d0: 6e60 7374 7265 616d 5f6e 616d 6560 2e20  n`stream_name`. 
+000188e0: 5468 6520 7661 6c75 6573 206f 6620 7468  The values of th
+000188f0: 6573 6520 6172 6775 6d65 6e74 7320 7368  ese arguments sh
+00018900: 6f75 6c64 206d 6174 6368 2074 686f 7365  ould match those
+00018910: 2075 7365 6420 7768 656e 2063 616c 6c69   used when calli
+00018920: 6e67 5c6e 6063 7265 6174 655f 7375 6273  ng\n`create_subs
+00018930: 6372 6970 7469 6f6e 2829 6020 6f72 2060  cription()` or `
+00018940: 6372 6561 7465 5f73 7472 6561 6d5f 7375  create_stream_su
+00018950: 6273 6372 6970 7469 6f6e 2829 602e 5c6e  bscription()`.\n
+00018960: 5c6e 5468 6973 206d 6574 686f 6420 616c  \nThis method al
+00018970: 736f 2068 6173 2061 6e20 6f70 7469 6f6e  so has an option
+00018980: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+00018990: 756d 656e 742c 2074 6861 745c 6e69 7320  ument, that\nis 
+000189a0: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+000189b0: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
+000189c0: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
+000189d0: 6164 6c69 6e65 5c6e 666f 7220 7468 6520  adline\nfor the 
+000189e0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+000189f0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00018a00: 2e5c 6e5c 6e54 6865 2065 7861 6d70 6c65  .\n\nThe example
+00018a10: 2062 656c 6f77 2064 656c 6574 6573 2074   below deletes t
+00018a20: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00018a30: 666f 7220 6772 6f75 7020 6067 726f 7570  for group `group
+00018a40: 5f6e 616d 6531 6020 7768 6963 6820 7761  _name1` which wa
+00018a50: 7320 6372 6561 7465 645c 6e62 7920 6361  s created\nby ca
+00018a60: 6c6c 696e 6720 6063 7265 6174 655f 7375  lling `create_su
+00018a70: 6273 6372 6970 7469 6f6e 2829 602e 5c6e  bscription()`.\n
+00018a80: 5c6e 6060 6070 7974 686f 6e5c 6e63 6c69  \n```python\ncli
+00018a90: 656e 742e 6465 6c65 7465 5f70 6572 7369  ent.delete_persi
+00018aa0: 7374 656e 745f 7375 6273 6372 6970 7469  stent_subscripti
+00018ab0: 6f6e 285c 6e20 2020 2067 726f 7570 5f6e  on(\n    group_n
+00018ac0: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
+00018ad0: 5c6e 295c 6e60 6060 5c6e 5c6e 5468 6520  \n)\n```\n\nThe 
+00018ae0: 6578 616d 706c 6520 6265 6c6f 7720 6465  example below de
+00018af0: 6c65 7465 7320 7468 6520 7375 6273 6372  letes the subscr
+00018b00: 6970 7469 6f6e 2066 6f72 2067 726f 7570  iption for group
+00018b10: 2060 6772 6f75 705f 6e61 6d65 3260 2077   `group_name2` w
+00018b20: 6869 6368 2077 6173 2063 7265 6174 6564  hich was created
+00018b30: 5c6e 6279 2063 616c 6c69 6e67 2060 6372  \nby calling `cr
+00018b40: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
+00018b50: 6372 6970 7469 6f6e 2829 602e 5c6e 5c6e  cription()`.\n\n
+00018b60: 6060 6070 7974 686f 6e5c 6e63 6c69 656e  ```python\nclien
+00018b70: 742e 6465 6c65 7465 5f70 6572 7369 7374  t.delete_persist
+00018b80: 656e 745f 7375 6273 6372 6970 7469 6f6e  ent_subscription
+00018b90: 285c 6e20 2020 2067 726f 7570 5f6e 616d  (\n    group_nam
+00018ba0: 653d 6772 6f75 705f 6e61 6d65 322c 5c6e  e=group_name2,\n
+00018bb0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+00018bc0: 7374 7265 616d 5f6e 616d 6532 2c5c 6e29  stream_name2,\n)
+00018bd0: 5c6e 6060 605c 6e5c 6e23 2320 436f 6e6e  \n```\n\n## Conn
+00018be0: 6563 7469 6f6e 5c6e 5c6e 2323 2320 5265  ection\n\n### Re
+00018bf0: 636f 6e6e 6563 745c 6e5c 6e54 6865 2060  connect\n\nThe `
+00018c00: 7265 636f 6e6e 6563 7428 2960 206d 6574  reconnect()` met
+00018c10: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00018c20: 746f 206d 616e 7561 6c6c 7920 7265 636f  to manually reco
+00018c30: 6e6e 6563 7420 7468 6520 636c 6965 6e74  nnect the client
+00018c40: 2074 6f20 615c 6e73 7569 7461 626c 6520   to a\nsuitable 
+00018c50: 4576 656e 7453 746f 7265 4442 206e 6f64  EventStoreDB nod
+00018c60: 652e 2054 6869 7320 6d65 7468 6f64 2075  e. This method u
+00018c70: 7365 7320 7468 6520 7361 6d65 2072 6f75  ses the same rou
+00018c80: 7469 6e65 2066 6f72 2072 6561 6469 6e67  tine for reading
+00018c90: 2074 6865 5c6e 636c 7573 7465 7220 6e6f   the\ncluster no
+00018ca0: 6465 2073 7461 7465 7320 616e 6420 7468  de states and th
+00018cb0: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
+00018cc0: 2061 2073 7569 7461 626c 6520 6e6f 6465   a suitable node
+00018cd0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+00018ce0: 655c 6e63 6c69 656e 745c 2773 206e 6f64  e\nclient\'s nod
+00018cf0: 6520 7072 6566 6572 656e 6365 2074 6861  e preference tha
+00018d00: 7420 6973 2073 7065 6369 6669 6564 2069  t is specified i
+00018d10: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
+00018d20: 2073 7472 696e 6720 5552 4920 7768 656e   string URI when
+00018d30: 5c6e 7468 6520 636c 6965 6e74 2069 7320  \nthe client is 
+00018d40: 636f 6e73 7472 7563 7465 642e 2054 6869  constructed. Thi
+00018d50: 7320 6d65 7468 6f64 2069 7320 7468 7265  s method is thre
+00018d60: 6164 2d73 6166 652c 2069 6e20 7468 6174  ad-safe, in that
+00018d70: 2077 6865 6e20 6974 2069 7320 6361 6c6c   when it is call
+00018d80: 6564 5c6e 6279 2073 6576 6572 616c 2074  ed\nby several t
+00018d90: 6872 6561 6473 2061 7420 7468 6520 7361  hreads at the sa
+00018da0: 6d65 2074 696d 652c 206f 6e6c 7920 6f6e  me time, only on
+00018db0: 6520 7265 636f 6e6e 6563 7469 6f6e 2077  e reconnection w
+00018dc0: 696c 6c20 6f63 6375 722e 2043 6f6e 6375  ill occur. Concu
+00018dd0: 7272 656e 745c 6e61 7474 656d 7074 7320  rrent\nattempts 
+00018de0: 746f 2072 6563 6f6e 6e65 6374 2077 696c  to reconnect wil
+00018df0: 6c20 626c 6f63 6b20 756e 7469 6c20 7468  l block until th
+00018e00: 6520 636c 6965 6e74 2068 6173 2072 6563  e client has rec
+00018e10: 6f6e 6e65 6374 6564 2073 7563 6365 7373  onnected success
+00018e20: 6675 6c6c 792c 5c6e 616e 6420 7468 656e  fully,\nand then
+00018e30: 2074 6865 7920 7769 6c6c 2061 6c6c 2072   they will all r
+00018e40: 6574 7572 6e20 6e6f 726d 616c 6c79 2e5c  eturn normally.\
+00018e50: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 636c  n\n```python\ncl
+00018e60: 6965 6e74 2e72 6563 6f6e 6e65 6374 2829  ient.reconnect()
+00018e70: 5c6e 6060 605c 6e5c 6e41 6e20 6578 616d  \n```\n\nAn exam
+00018e80: 706c 6520 6f66 2077 6865 6e20 6974 206d  ple of when it m
+00018e90: 6967 6874 2062 6520 6465 7369 7261 626c  ight be desirabl
+00018ea0: 6520 746f 2072 6563 6f6e 6e65 6374 206d  e to reconnect m
+00018eb0: 616e 7561 6c6c 7920 6973 2077 6865 6e20  anually is when 
+00018ec0: 2866 6f72 2070 6572 666f 726d 616e 6365  (for performance
+00018ed0: 5c6e 7265 6173 6f6e 7329 2074 6865 2063  \nreasons) the c
+00018ee0: 6c69 656e 745c 2773 206e 6f64 6520 7072  lient\'s node pr
+00018ef0: 6566 6572 656e 6365 2069 7320 746f 2062  eference is to b
+00018f00: 6520 636f 6e6e 6563 7465 6420 746f 2061  e connected to a
+00018f10: 2066 6f6c 6c6f 7765 7220 6e6f 6465 2069   follower node i
+00018f20: 6e20 7468 655c 6e63 6c75 7374 6572 2c20  n the\ncluster, 
+00018f30: 616e 642c 2061 6674 6572 2061 2063 6c75  and, after a clu
+00018f40: 7374 6572 206c 6561 6465 7220 656c 6563  ster leader elec
+00018f50: 7469 6f6e 2c20 7468 6520 666f 6c6c 6f77  tion, the follow
+00018f60: 6572 2062 6563 6f6d 6573 2074 6865 206c  er becomes the l
+00018f70: 6561 6465 722e 5c6e 5265 636f 6e6e 6563  eader.\nReconnec
+00018f80: 7469 6e67 2074 6f20 6120 666f 6c6c 6f77  ting to a follow
+00018f90: 6572 206e 6f64 6520 696e 2074 6869 7320  er node in this 
+00018fa0: 6361 7365 2069 7320 6375 7272 656e 746c  case is currentl
+00018fb0: 7920 6265 796f 6e64 2074 6865 2063 6170  y beyond the cap
+00018fc0: 6162 696c 6974 6965 7320 6f66 5c6e 7468  abilities of\nth
+00018fd0: 6973 2063 6c69 656e 742c 2062 7574 2074  is client, but t
+00018fe0: 6869 7320 6265 6861 7669 6f72 206d 6967  his behavior mig
+00018ff0: 6874 2062 6520 696d 706c 656d 656e 7465  ht be implemente
+00019000: 6420 696e 2061 2066 7574 7572 6520 7265  d in a future re
+00019010: 6c65 6173 652e 5c6e 5c6e 506c 6561 7365  lease.\n\nPlease
+00019020: 206e 6f74 652c 206e 6561 726c 7920 616c   note, nearly al
+00019030: 6c20 7468 6520 636c 6965 6e74 206d 6574  l the client met
+00019040: 686f 6473 2061 7265 2064 6563 6f72 6174  hods are decorat
+00019050: 6564 2077 6974 6820 6040 6175 746f 7265  ed with `@autore
+00019060: 636f 6e6e 6563 7460 2028 7768 6963 685c  connect` (which\
+00019070: 6e63 616c 6c73 2074 6865 2060 7265 636f  ncalls the `reco
+00019080: 6e6e 6563 7428 2960 206d 6574 686f 6420  nnect()` method 
+00019090: 7768 656e 2074 6865 2063 6c69 656e 7420  when the client 
+000190a0: 6465 7465 6374 7320 7468 6174 2072 6563  detects that rec
+000190b0: 6f6e 6e65 6374 696e 6720 6973 2072 6571  onnecting is req
+000190c0: 7569 7265 6429 5c6e 616e 6420 6120 6040  uired)\nand a `@
+000190d0: 7265 7472 7960 2064 6563 6f72 6174 6f72  retry` decorator
+000190e0: 2074 6861 7420 6d6f 7265 2067 656e 6572   that more gener
+000190f0: 616c 6c79 2077 696c 6c20 7265 7472 7920  ally will retry 
+00019100: 6f70 6572 6174 696f 6e73 2074 6861 7420  operations that 
+00019110: 6661 696c 2064 7565 2074 6f5c 6e63 6f6e  fail due to\ncon
+00019120: 6e65 6374 696f 6e20 6973 7375 6573 2e5c  nection issues.\
+00019130: 6e5c 6e54 6865 2060 4061 7574 6f72 6563  n\nThe `@autorec
+00019140: 6f6e 6e65 6374 6020 6465 636f 7261 746f  onnect` decorato
+00019150: 7220 7769 6c6c 2072 6563 6f6e 6e65 6374  r will reconnect
+00019160: 2074 6f20 6120 7375 6974 6162 6c65 206e   to a suitable n
+00019170: 6f64 6520 696e 2074 6865 2063 6c75 7374  ode in the clust
+00019180: 6572 2077 6865 6e5c 6e74 6865 2073 6572  er when\nthe ser
+00019190: 7665 7220 746f 2077 6869 6368 2074 6865  ver to which the
+000191a0: 2063 6c69 656e 7420 6861 7320 6265 656e   client has been
+000191b0: 2063 6f6e 6e65 6374 6564 2068 6173 2062   connected has b
+000191c0: 6563 6f6d 6520 756e 6176 6169 6c61 626c  ecome unavailabl
+000191d0: 652c 206f 7220 7768 656e 2074 6865 5c6e  e, or when the\n
+000191e0: 636c 6965 6e74 5c27 7320 6752 5043 2063  client\'s gRPC c
+000191f0: 6861 6e6e 656c 2068 6170 7065 6e73 2074  hannel happens t
+00019200: 6f20 6861 7665 2062 6565 6e20 636c 6f73  o have been clos
+00019210: 6564 2e20 5468 6520 636c 6965 6e74 2077  ed. The client w
+00019220: 696c 6c20 616c 736f 2072 6563 6f6e 6e65  ill also reconne
+00019230: 6374 2077 6865 6e5c 6e61 206d 6574 686f  ct when\na metho
+00019240: 6420 6973 2063 616c 6c65 6420 7468 6174  d is called that
+00019250: 2072 6571 7569 7265 7320 6120 6c65 6164   requires a lead
+00019260: 6572 2c20 616e 6420 7468 6520 636c 6965  er, and the clie
+00019270: 6e74 5c27 7320 6e6f 6465 2070 7265 6665  nt\'s node prefe
+00019280: 7265 6e63 6520 6973 2074 6f20 6265 5c6e  rence is to be\n
+00019290: 636f 6e6e 6563 7465 6420 746f 2061 206c  connected to a l
+000192a0: 6561 6465 722c 2062 7574 2074 6865 206e  eader, but the n
+000192b0: 6f64 6520 7468 6174 2074 6865 2063 6c69  ode that the cli
+000192c0: 656e 7420 6861 7320 6265 656e 2063 6f6e  ent has been con
+000192d0: 6e65 6374 6564 2074 6f20 7374 6f70 7320  nected to stops 
+000192e0: 6265 696e 675c 6e74 6865 206c 6561 6465  being\nthe leade
+000192f0: 722e 2049 6e20 7468 6973 2063 6173 652c  r. In this case,
+00019300: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+00019310: 2072 6563 6f6e 6e65 6374 2074 6f20 7468   reconnect to th
+00019320: 6520 6375 7272 656e 7420 6c65 6164 6572  e current leader
+00019330: 2e20 4166 7465 725c 6e72 6563 6f6e 6e65  . After\nreconne
+00019340: 6374 696e 672c 2074 6865 2066 6169 6c65  cting, the faile
+00019350: 6420 6f70 6572 6174 696f 6e20 7769 6c6c  d operation will
+00019360: 2062 6520 7265 7472 6965 642e 5c6e 5c6e   be retried.\n\n
+00019370: 5468 6520 6040 7265 7472 7960 2064 6563  The `@retry` dec
+00019380: 6f72 6174 6f72 2072 6574 7269 6573 206f  orator retries o
+00019390: 7065 7261 7469 6f6e 7320 7468 6174 2068  perations that h
+000193a0: 6176 6520 6661 696c 6564 2064 7565 2074  ave failed due t
+000193b0: 6f20 6d6f 7265 2067 656e 6572 616c 5c6e  o more general\n
+000193c0: 636f 6e6e 6563 7469 6f6e 2069 7373 7565  connection issue
+000193d0: 732c 2073 7563 6820 6173 2061 2064 6561  s, such as a dea
+000193e0: 646c 696e 6520 6265 696e 6720 7265 6163  dline being reac
+000193f0: 6865 6420 2873 6f20 7468 6174 2074 6865  hed (so that the
+00019400: 206f 7065 7261 7469 6f6e 2074 696d 6573   operation times
+00019410: 5c6e 6f75 7429 2c20 6f72 2069 6e20 6361  \nout), or in ca
+00019420: 7365 2074 6865 2073 6572 7665 7220 7468  se the server th
+00019430: 726f 7773 2061 6e20 6578 6365 7074 696f  rows an exceptio
+00019440: 6e20 7768 656e 2068 616e 646c 696e 6720  n when handling 
+00019450: 6120 636c 6965 6e74 2072 6571 7565 7374  a client request
+00019460: 2e5c 6e5c 6e50 6c65 6173 6520 616c 736f  .\n\nPlease also
+00019470: 206e 6f74 652c 2074 6865 2061 7370 6563   note, the aspec
+00019480: 7473 206e 6f74 2063 6f76 6572 6564 2062  ts not covered b
+00019490: 7920 7468 6520 7265 636f 6e6e 6563 7420  y the reconnect 
+000194a0: 616e 6420 7265 7472 7920 6465 636f 7261  and retry decora
+000194b0: 746f 725c 6e62 6568 6176 696f 7572 7320  tor\nbehaviours 
+000194c0: 6861 7665 2074 6f20 646f 2077 6974 6820  have to do with 
+000194d0: 6d65 7468 6f64 7320 7468 6174 2072 6574  methods that ret
+000194e0: 7572 6e20 6974 6572 6174 6f72 732e 2046  urn iterators. F
+000194f0: 6f72 2065 7861 6d70 6c65 2c20 636f 6e73  or example, cons
+00019500: 6964 6572 5c6e 7468 6520 2272 6561 6420  ider\nthe "read 
+00019510: 7265 7370 6f6e 7365 2220 6974 6572 6174  response" iterat
+00019520: 6f72 2072 6574 7572 6e65 6420 6672 6f6d  or returned from
+00019530: 2074 6865 2060 7265 6164 5f61 6c6c 5f65   the `read_all_e
+00019540: 7665 6e74 7328 2960 206d 6574 686f 642e  vents()` method.
+00019550: 2054 6865 5c6e 6072 6561 645f 616c 6c5f   The\n`read_all_
+00019560: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+00019570: 2077 696c 6c20 6861 7665 2072 6574 7572   will have retur
+00019580: 6e65 642c 2061 6e64 2074 6865 206d 6574  ned, and the met
+00019590: 686f 6420 6465 636f 7261 746f 7273 2077  hod decorators w
+000195a0: 696c 6c20 7468 6572 6566 6f72 655c 6e68  ill therefore\nh
+000195b0: 6176 6520 6578 6974 6564 2c20 6265 666f  ave exited, befo
+000195c0: 7265 2069 7465 7261 7469 6e67 206f 7665  re iterating ove
+000195d0: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
+000195e0: 6f6e 7365 2220 6265 6769 6e73 2e20 5468  onse" begins. Th
+000195f0: 6572 6566 6f72 652c 2069 6620 615c 6e63  erefore, if a\nc
+00019600: 6f6e 6e65 6374 696f 6e20 6973 7375 6573  onnection issues
+00019610: 206f 6363 7572 7320 7768 696c 7374 2069   occurs whilst i
+00019620: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
+00019630: 6520 2272 6561 6420 7265 7370 6f6e 7365  e "read response
+00019640: 222c 2069 7420 6973 6e5c 2774 2070 6f73  ", it isn\'t pos
+00019650: 7369 626c 655c 6e66 6f72 2061 6e79 2064  sible\nfor any d
+00019660: 6563 6f72 6174 6f72 206f 6e20 7468 6520  ecorator on the 
+00019670: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00019680: 2829 6020 6d65 7468 6f64 2074 6f20 7472  ()` method to tr
+00019690: 6967 6765 7220 6120 7265 636f 6e6e 6563  igger a reconnec
+000196a0: 7469 6f6e 2e5c 6e5c 6e41 6e6f 7468 6572  tion.\n\nAnother
+000196b0: 2065 7861 6d70 6c65 2069 7320 6974 6572   example is iter
+000196c0: 6174 696e 6720 6f76 6572 2074 6865 2022  ating over the "
+000196d0: 7265 6164 2072 6573 706f 6e73 6522 2066  read response" f
+000196e0: 726f 6d20 6120 6361 7463 682d 7570 2073  rom a catch-up s
+000196f0: 7562 7363 7269 7074 696f 6e2e 5c6e 416c  ubscription.\nAl
+00019700: 7468 6f75 6768 2c20 7769 7468 2074 6865  though, with the
+00019710: 7365 206d 6574 686f 6473 2074 6865 7265  se methods there
+00019720: 2069 7320 616e 2069 6e69 7469 616c 2022   is an initial "
+00019730: 636f 6e66 6972 6d61 7469 6f6e 2220 7265  confirmation" re
+00019740: 7370 6f6e 7365 2066 726f 6d20 7468 6520  sponse from the 
+00019750: 7365 7276 6572 5c6e 7768 6963 6820 6973  server\nwhich is
+00019760: 2072 6563 6569 7665 6420 616e 6420 6368   received and ch
+00019770: 6563 6b65 6420 6279 2074 6865 2063 6c69  ecked by the cli
+00019780: 656e 7420 6265 666f 7265 2074 6865 206d  ent before the m
+00019790: 6574 686f 6420 7265 7475 726e 7320 7468  ethod returns th
+000197a0: 655c 6e22 7265 6164 2072 6573 706f 6e73  e\n"read respons
+000197b0: 6522 2069 7465 7261 746f 722e 2041 6e64  e" iterator. And
+000197c0: 2073 6f2c 2077 6865 6e20 7468 6520 6361   so, when the ca
+000197d0: 6c6c 2069 7320 6d61 6465 2c20 6966 2074  ll is made, if t
+000197e0: 6865 2073 6572 7665 7220 6973 2075 6e61  he server is una
+000197f0: 7661 696c 6162 6c65 2c5c 6e6f 7220 6966  vailable,\nor if
+00019800: 2074 6865 2063 6861 6e6e 656c 2068 6173   the channel has
+00019810: 2073 6f6d 6568 6f77 2062 6565 6e20 636c   somehow been cl
+00019820: 6f73 6564 2c20 7468 656e 2074 6865 2063  osed, then the c
+00019830: 6c69 656e 7420 7769 6c6c 2072 6563 6f6e  lient will recon
+00019840: 6e65 6374 2061 6e64 2072 6574 7279 2e5c  nect and retry.\
+00019850: 6e48 6f77 6576 6572 2c20 6966 2061 6e20  nHowever, if an 
+00019860: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00019870: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
+00019880: 6973 2069 7465 7261 7469 6e67 206f 7665  is iterating ove
+00019890: 7220 6120 7375 6363 6573 7366 756c 6c79  r a successfully
+000198a0: 2072 6574 7572 6e65 645c 6e63 6174 6368   returned\ncatch
+000198b0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+000198c0: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+000198d0: 2073 6f6d 6568 6f77 2066 6169 6c73 2c20   somehow fails, 
+000198e0: 7468 6520 6361 7463 682d 7570 2073 7562  the catch-up sub
+000198f0: 7363 7269 7074 696f 6e20 7769 6c6c 5c6e  scription will\n
+00019900: 6e65 6564 2074 6f20 6265 2072 6573 7461  need to be resta
+00019910: 7274 6564 2c20 7573 696e 6720 7468 6520  rted, using the 
+00019920: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00019930: 2063 6f6d 706f 6e65 6e74 5c27 7320 226c   component\'s "l
+00019940: 6173 7420 7361 7665 6420 636f 6d6d 6974  ast saved commit
+00019950: 2070 6f73 6974 696f 6e22 2e5c 6e54 6869   position".\nThi
+00019960: 7320 6973 2063 6f6d 706c 6574 656c 7920  s is completely 
+00019970: 7361 6665 2c20 736f 206c 6f6e 6720 6173  safe, so long as
+00019980: 2074 6865 2065 7665 6e74 2d70 726f 6365   the event-proce
+00019990: 7373 696e 6720 636f 6d70 6f6e 656e 7420  ssing component 
+000199a0: 6861 7320 6265 656e 2072 6563 6f72 6469  has been recordi
+000199b0: 6e67 5c6e 7468 6520 636f 6d6d 6974 2070  ng\nthe commit p
+000199c0: 6f73 6974 696f 6e20 6f66 2065 6163 6820  osition of each 
+000199d0: 7265 636f 7264 6564 2065 7665 6e74 2061  recorded event a
+000199e0: 746f 6d69 6361 6c6c 7920 616e 6420 756e  tomically and un
+000199f0: 6971 7565 6c79 2061 6c6f 6e67 2077 6974  iquely along wit
+00019a00: 6820 616e 7920 6e65 775c 6e73 7461 7465  h any new\nstate
+00019a10: 2074 6861 7420 7265 7375 6c74 7320 6672   that results fr
+00019a20: 6f6d 2070 726f 6365 7373 696e 6720 7468  om processing th
+00019a30: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00019a40: 7320 616e 6420 7468 6520 636f 6d6d 6974  s and the commit
+00019a50: 2070 6f73 6974 696f 6e73 2061 7265 5c6e   positions are\n
+00019a60: 7265 636f 7264 6564 2077 6974 6820 6120  recorded with a 
+00019a70: 756e 6971 7565 6e65 7373 2063 6f6e 7374  uniqueness const
+00019a80: 7261 696e 742e 2049 6e20 7468 6973 2063  raint. In this c
+00019a90: 6173 652c 2074 6865 2063 6c69 656e 7420  ase, the client 
+00019aa0: 7769 6c6c 2061 7574 6f6d 6174 6963 616c  will automatical
+00019ab0: 6c79 5c6e 7265 636f 6e6e 6563 7420 746f  ly\nreconnect to
+00019ac0: 2061 206e 6f64 6520 696e 2074 6865 2063   a node in the c
+00019ad0: 6c75 7374 6572 2077 6865 6e20 7468 6520  luster when the 
+00019ae0: 7375 6273 6571 7565 6e74 2063 616c 6c20  subsequent call 
+00019af0: 746f 2061 2063 6174 6368 2d75 7020 7375  to a catch-up su
+00019b00: 6273 6372 6970 7469 6f6e 5c6e 6d65 7468  bscription\nmeth
+00019b10: 6f64 2069 7320 6d61 6465 2e20 5369 6d69  od is made. Simi
+00019b20: 6c61 726c 792c 2077 6865 6e20 7265 6164  larly, when read
+00019b30: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
+00019b40: 7562 7363 7269 7074 696f 6e73 2c20 6966  ubscriptions, if
+00019b50: 2074 6865 7265 2061 7265 5c6e 636f 6e6e   there are\nconn
+00019b60: 6563 7469 7669 7479 2069 7373 7565 7320  ectivity issues 
+00019b70: 6166 7465 7220 796f 7520 6861 7665 2073  after you have s
+00019b80: 7461 7274 6564 2069 7465 7261 7469 6e67  tarted iterating
+00019b90: 206f 7665 7220 6120 7375 6363 6573 7366   over a successf
+00019ba0: 756c 6c79 2072 6563 6569 7665 645c 6e72  ully received\nr
+00019bb0: 6573 706f 6e73 652c 2074 6865 6e20 7468  esponse, then th
+00019bc0: 6520 636f 6e73 756d 6572 2077 696c 6c20  e consumer will 
+00019bd0: 6e65 6564 2074 6f20 6265 2072 6573 7461  need to be resta
+00019be0: 7274 6564 2e5c 6e5c 6e5c 6e23 2323 2043  rted.\n\n\n### C
+00019bf0: 6c6f 7365 5c6e 5c6e 5468 6520 6063 6c6f  lose\n\nThe `clo
+00019c00: 7365 2829 6020 6d65 7468 6f64 2063 616e  se()` method can
+00019c10: 2062 6520 7573 6564 2074 6f20 636c 6561   be used to clea
+00019c20: 6e6c 7920 636c 6f73 6520 7468 6520 636c  nly close the cl
+00019c30: 6965 6e74 5c27 7320 6752 5043 2063 6f6e  ient\'s gRPC con
+00019c40: 6e65 6374 696f 6e2e 5c6e 5c6e 6060 6070  nection.\n\n```p
+00019c50: 7974 686f 6e5c 6e63 6c69 656e 742e 636c  ython\nclient.cl
+00019c60: 6f73 6528 295c 6e60 6060 5c6e 5c6e 5c6e  ose()\n```\n\n\n
+00019c70: 2323 2041 7379 6e63 696f 2063 6c69 656e  ## Asyncio clien
+00019c80: 745c 6e5c 6e54 6865 2060 6573 6462 636c  t\n\nThe `esdbcl
+00019c90: 6965 6e74 6020 7061 636b 6167 6520 616c  ient` package al
+00019ca0: 736f 2069 6e63 6c75 6465 7320 616e 2065  so includes an e
+00019cb0: 6172 6c79 2076 6572 7369 6f6e 206f 6620  arly version of 
+00019cc0: 616e 2061 7379 6e63 6872 6f6e 6f75 7320  an asynchronous 
+00019cd0: 492f 4f5c 6e67 5250 4320 5079 7468 6f6e  I/O\ngRPC Python
+00019ce0: 2063 6c69 656e 742e 2049 7420 666f 6c6c   client. It foll
+00019cf0: 6f77 7320 6578 6163 746c 7920 7468 6520  ows exactly the 
+00019d00: 7361 6d65 2062 6568 6176 696f 7273 2061  same behaviors a
+00019d10: 7320 7468 6520 6d75 6c74 6974 6872 6561  s the multithrea
+00019d20: 6465 645c 6e60 4553 4442 436c 6965 6e74  ded\n`ESDBClient
+00019d30: 602c 2062 7574 2075 7365 7320 7468 6520  `, but uses the 
+00019d40: 6067 7270 632e 6169 6f60 2070 6163 6b61  `grpc.aio` packa
+00019d50: 6765 2061 6e64 2074 6865 2060 6173 796e  ge and the `asyn
+00019d60: 6369 6f60 206d 6f64 756c 652c 2069 6e73  cio` module, ins
+00019d70: 7465 6164 206f 665c 6e60 6772 7063 6020  tead of\n`grpc` 
+00019d80: 616e 6420 6074 6872 6561 6469 6e67 602e  and `threading`.
+00019d90: 5c6e 5c6e 5468 6520 6173 796e 6320 6675  \n\nThe async fu
+00019da0: 6e63 7469 6f6e 2060 4173 796e 6369 6f45  nction `AsyncioE
+00019db0: 5344 4243 6c69 656e 7460 2063 6f6e 7374  SDBClient` const
+00019dc0: 7275 6374 7320 7468 6520 636c 6965 6e74  ructs the client
+00019dd0: 2c20 616e 6420 636f 6e6e 6563 7473 2074  , and connects t
+00019de0: 6f5c 6e61 2073 6572 7665 722e 2049 7420  o\na server. It 
+00019df0: 6361 6e20 6265 2069 6d70 6f72 7465 6420  can be imported 
+00019e00: 6672 6f6d 2060 6573 6462 636c 6965 6e74  from `esdbclient
+00019e10: 602c 2061 6e64 2063 616e 2062 6520 6361  `, and can be ca
+00019e20: 6c6c 6564 2077 6974 6820 7468 6520 7361  lled with the sa
+00019e30: 6d65 5c6e 6172 6775 6d65 6e74 7320 6173  me\narguments as
+00019e40: 2060 4553 4442 436c 6965 6e74 602e 2049   `ESDBClient`. I
+00019e50: 7420 7375 7070 6f72 7473 2062 6f74 6820  t supports both 
+00019e60: 7468 6520 2265 7364 6222 2061 6e64 2074  the "esdb" and t
+00019e70: 6865 2022 6573 6462 2b64 6973 636f 7665  he "esdb+discove
+00019e80: 7222 5c6e 636f 6e6e 6563 7469 6f6e 2073  r"\nconnection s
+00019e90: 7472 696e 6720 5552 4920 7363 6865 6d65  tring URI scheme
+00019ea0: 732c 2061 6e64 2063 616e 2063 6f6e 6e65  s, and can conne
+00019eb0: 6374 2074 6f20 626f 7468 2022 7365 6375  ct to both "secu
+00019ec0: 7265 2220 616e 6420 2269 6e73 6563 7572  re" and "insecur
+00019ed0: 6522 5c6e 4576 656e 7453 746f 7265 4442  e"\nEventStoreDB
+00019ee0: 2073 6572 7665 7273 2e20 4974 2072 6563   servers. It rec
+00019ef0: 6f6e 6e65 6374 7320 6f72 2072 6574 7269  onnects or retri
+00019f00: 6573 2077 6865 6e20 636f 6e6e 6563 7469  es when connecti
+00019f10: 6f6e 2069 7373 7565 7320 6f72 2073 6572  on issues or ser
+00019f20: 7665 725c 6e65 7272 6f72 7320 6172 6520  ver\nerrors are 
+00019f30: 656e 636f 756e 7465 7265 642e 5c6e 5c6e  encountered.\n\n
+00019f40: 6060 6070 7974 686f 6e5c 6e66 726f 6d20  ```python\nfrom 
+00019f50: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
+00019f60: 7420 4173 796e 6369 6f45 5344 4243 6c69  t AsyncioESDBCli
+00019f70: 656e 745c 6e60 6060 5c6e 5c6e 5468 6520  ent\n```\n\nThe 
+00019f80: 6173 796e 6368 726f 6e6f 7573 2049 2f4f  asynchronous I/O
+00019f90: 2063 6c69 656e 7420 6861 7320 7468 6520   client has the 
+00019fa0: 666f 6c6c 6f77 696e 6720 6d65 7468 6f64  following method
+00019fb0: 733a 2060 6170 7065 6e64 5f65 7665 6e74  s: `append_event
+00019fc0: 7328 2960 2c5c 6e60 7265 6164 5f73 7472  s()`,\n`read_str
+00019fd0: 6561 6d5f 6576 656e 7473 2829 602c 2060  eam_events()`, `
+00019fe0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+00019ff0: 2960 2c20 6073 7562 7363 7269 6265 5f61  )`, `subscribe_a
+0001a000: 6c6c 5f65 7665 6e74 7328 2960 2c5c 6e60  ll_events()`,\n`
+0001a010: 6465 6c65 7465 5f73 7472 6561 6d28 2960  delete_stream()`
+0001a020: 2c20 6074 6f6d 6273 746f 6e65 5f73 7472  , `tombstone_str
+0001a030: 6561 6d28 2960 2c20 616e 6420 6072 6563  eam()`, and `rec
+0001a040: 6f6e 6e65 6374 2829 602e 5c6e 5c6e 5468  onnect()`.\n\nTh
+0001a050: 6573 6520 6d65 7468 6f64 7320 6172 6520  ese methods are 
+0001a060: 6571 7569 7661 6c65 6e74 2074 6f20 7468  equivalent to th
+0001a070: 6520 6d65 7468 6f64 7320 6f6e 2060 4553  e methods on `ES
+0001a080: 4442 436c 6965 6e74 602e 2054 6865 7920  DBClient`. They 
+0001a090: 6861 7665 2074 6865 2073 616d 655c 6e6d  have the same\nm
+0001a0a0: 6574 686f 6420 7369 676e 6174 7572 6573  ethod signatures
+0001a0b0: 2c20 616e 6420 6361 6e20 6265 2063 616c  , and can be cal
+0001a0c0: 6c65 6420 7769 7468 2074 6865 2073 616d  led with the sam
+0001a0d0: 6520 6172 6775 6d65 6e74 732c 2074 6f20  e arguments, to 
+0001a0e0: 7468 6520 7361 6d65 2065 6666 6563 742e  the same effect.
+0001a0f0: 5c6e 5468 6520 6d65 7468 6f64 7320 7768  \nThe methods wh
+0001a100: 6963 6820 6170 7065 6172 206f 6e20 6045  ich appear on `E
+0001a110: 5344 4243 6c69 656e 7460 2062 7574 206e  SDBClient` but n
+0001a120: 6f74 206f 6e20 6041 7379 6e63 696f 4553  ot on `AsyncioES
+0001a130: 4442 436c 6965 6e74 6020 7769 6c6c 2062  DBClient` will b
+0001a140: 655c 6e61 6464 6564 2073 6f6f 6e2e 5c6e  e\nadded soon.\n
+0001a150: 5c6e 2323 2320 5379 6e6f 7073 6973 5c6e  \n### Synopsis\n
+0001a160: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
+0001a170: 6c6f 7720 6465 6d6f 6e73 7472 6174 6573  low demonstrates
+0001a180: 2074 6865 2060 6170 7065 6e64 5f65 7665   the `append_eve
+0001a190: 6e74 7328 2960 2c20 6072 6561 645f 7374  nts()`, `read_st
+0001a1a0: 7265 616d 5f65 7665 6e74 7328 2960 2061  ream_events()` a
+0001a1b0: 6e64 5c6e 6073 7562 7363 7269 6265 5f61  nd\n`subscribe_a
+0001a1c0: 6c6c 5f65 7665 6e74 7328 2960 206d 6574  ll_events()` met
+0001a1d0: 686f 6473 2e20 5468 6573 6520 6172 6520  hods. These are 
+0001a1e0: 7468 6520 6d6f 7374 2075 7365 6675 6c20  the most useful 
+0001a1f0: 6d65 7468 6f64 7320 666f 7220 7772 6974  methods for writ
+0001a200: 696e 675c 6e61 6e20 6576 656e 742d 736f  ing\nan event-so
+0001a210: 7572 6365 6420 6170 706c 6963 6174 696f  urced applicatio
+0001a220: 6e2c 2061 6c6c 6f77 696e 6720 6e65 7720  n, allowing new 
+0001a230: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
+0001a240: 2074 6f20 6265 2072 6563 6f72 6465 642c   to be recorded,
+0001a250: 2074 6865 5c6e 7265 636f 7264 6564 2065   the\nrecorded e
+0001a260: 7665 6e74 7320 6f66 2061 6e20 6167 6772  vents of an aggr
+0001a270: 6567 6174 6520 746f 2062 6520 6f62 7461  egate to be obta
+0001a280: 696e 6564 2073 6f20 6167 6772 6567 6174  ined so aggregat
+0001a290: 6573 2063 616e 2062 6520 7265 636f 6e73  es can be recons
+0001a2a0: 7472 7563 7465 642c 5c6e 616e 6420 7468  tructed,\nand th
+0001a2b0: 6520 7374 6174 6520 6f66 2061 6e20 6170  e state of an ap
+0001a2c0: 706c 6963 6174 696f 6e20 746f 2070 726f  plication to pro
+0001a2d0: 7061 6761 7465 6420 616e 6420 7072 6f63  pagated and proc
+0001a2e0: 6573 7365 6420 7769 7468 2022 6578 6163  essed with "exac
+0001a2f0: 746c 792d 6f6e 6365 225c 6e73 656d 616e  tly-once"\nseman
+0001a300: 7469 6373 2e5c 6e5c 6e60 6060 7079 7468  tics.\n\n```pyth
+0001a310: 6f6e 5c6e 696d 706f 7274 2061 7379 6e63  on\nimport async
+0001a320: 696f 5c6e 5c6e 6173 796e 6320 6465 6620  io\n\nasync def 
+0001a330: 6465 6d6f 6e73 7472 6174 655f 6173 796e  demonstrate_asyn
+0001a340: 6369 6f5f 636c 6965 6e74 2829 3a5c 6e5c  cio_client():\n\
+0001a350: 6e20 2020 2023 2043 6f6e 7374 7275 6374  n    # Construct
+0001a360: 2063 6c69 656e 742e 5c6e 2020 2020 636c   client.\n    cl
+0001a370: 6965 6e74 203d 2061 7761 6974 2041 7379  ient = await Asy
+0001a380: 6e63 696f 4553 4442 436c 6965 6e74 285c  ncioESDBClient(\
+0001a390: 6e20 2020 2020 2020 2075 7269 3d6f 732e  n        uri=os.
+0001a3a0: 6765 7465 6e76 2822 4553 4442 5f55 5249  getenv("ESDB_URI
+0001a3b0: 2229 2c5c 6e20 2020 2020 2020 2072 6f6f  "),\n        roo
+0001a3c0: 745f 6365 7274 6966 6963 6174 6573 3d6f  t_certificates=o
+0001a3d0: 732e 6765 7465 6e76 2822 4553 4442 5f52  s.getenv("ESDB_R
+0001a3e0: 4f4f 545f 4345 5254 4946 4943 4154 4553  OOT_CERTIFICATES
+0001a3f0: 2229 2c5c 6e20 2020 2029 5c6e 5c6e 2020  "),\n    )\n\n  
+0001a400: 2020 2320 4170 7065 6e64 2065 7665 6e74    # Append event
+0001a410: 732e 5c6e 2020 2020 7374 7265 616d 5f6e  s.\n    stream_n
+0001a420: 616d 6520 3d20 7374 7228 7575 6964 2e75  ame = str(uuid.u
+0001a430: 7569 6434 2829 295c 6e20 2020 2065 7665  uid4())\n    eve
+0001a440: 6e74 3120 3d20 4e65 7745 7665 6e74 2822  nt1 = NewEvent("
+0001a450: 4f72 6465 7243 7265 6174 6564 222c 2064  OrderCreated", d
+0001a460: 6174 613d 625c 277b 7d5c 2729 5c6e 2020  ata=b\'{}\')\n  
+0001a470: 2020 6576 656e 7432 203d 204e 6577 4576    event2 = NewEv
+0001a480: 656e 7428 224f 7264 6572 5570 6461 7465  ent("OrderUpdate
+0001a490: 6422 2c20 6461 7461 3d62 5c27 7b7d 5c27  d", data=b\'{}\'
+0001a4a0: 295c 6e20 2020 2065 7665 6e74 3320 3d20  )\n    event3 = 
+0001a4b0: 4e65 7745 7665 6e74 2822 4f72 6465 7244  NewEvent("OrderD
+0001a4c0: 656c 6574 6564 222c 2064 6174 613d 625c  eleted", data=b\
+0001a4d0: 277b 7d5c 2729 5c6e 5c6e 2020 2020 636f  '{}\')\n\n    co
+0001a4e0: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
+0001a4f0: 6177 6169 7420 636c 6965 6e74 2e61 7070  await client.app
+0001a500: 656e 645f 6576 656e 7473 285c 6e20 2020  end_events(\n   
+0001a510: 2020 2020 2073 7472 6561 6d5f 6e61 6d65       stream_name
+0001a520: 3d73 7472 6561 6d5f 6e61 6d65 2c5c 6e20  =stream_name,\n 
+0001a530: 2020 2020 2020 2063 7572 7265 6e74 5f76         current_v
+0001a540: 6572 7369 6f6e 3d4e 6f6e 652c 5c6e 2020  ersion=None,\n  
+0001a550: 2020 2020 2020 6576 656e 7473 3d5b 6576        events=[ev
+0001a560: 656e 7431 2c20 6576 656e 7432 2c20 6576  ent1, event2, ev
+0001a570: 656e 7433 5d5c 6e20 2020 2029 5c6e 5c6e  ent3]\n    )\n\n
+0001a580: 2020 2020 2320 5265 6164 2073 7472 6561      # Read strea
+0001a590: 6d20 6576 656e 7473 2e5c 6e20 2020 2072  m events.\n    r
+0001a5a0: 6563 6f72 6465 6420 3d20 6177 6169 7420  ecorded = await 
+0001a5b0: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
+0001a5c0: 616d 5f65 7665 6e74 7328 7374 7265 616d  am_events(stream
+0001a5d0: 5f6e 616d 6529 5c6e 2020 2020 6173 7365  _name)\n    asse
+0001a5e0: 7274 206c 656e 2872 6563 6f72 6465 6429  rt len(recorded)
+0001a5f0: 203d 3d20 335c 6e20 2020 2061 7373 6572   == 3\n    asser
+0001a600: 7420 7265 636f 7264 6564 5b30 5d2e 6964  t recorded[0].id
+0001a610: 203d 3d20 6576 656e 7431 2e69 645c 6e20   == event1.id\n 
+0001a620: 2020 2061 7373 6572 7420 7265 636f 7264     assert record
+0001a630: 6564 5b31 5d2e 6964 203d 3d20 6576 656e  ed[1].id == even
+0001a640: 7432 2e69 645c 6e20 2020 2061 7373 6572  t2.id\n    asser
+0001a650: 7420 7265 636f 7264 6564 5b32 5d2e 6964  t recorded[2].id
+0001a660: 203d 3d20 6576 656e 7433 2e69 645c 6e5c   == event3.id\n\
+0001a670: 6e5c 6e20 2020 2023 2053 7562 7363 7269  n\n    # Subscri
+0001a680: 6265 2061 6c6c 2065 7665 6e74 732e 5c6e  be all events.\n
+0001a690: 2020 2020 7265 6365 6976 6564 203d 205b      received = [
+0001a6a0: 5d5c 6e20 2020 2061 7379 6e63 2066 6f72  ]\n    async for
+0001a6b0: 2065 7665 6e74 2069 6e20 6177 6169 7420   event in await 
+0001a6c0: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
+0001a6d0: 5f61 6c6c 5f65 7665 6e74 7328 293a 5c6e  _all_events():\n
+0001a6e0: 2020 2020 2020 2020 7265 6365 6976 6564          received
+0001a6f0: 2e61 7070 656e 6428 6576 656e 7429 5c6e  .append(event)\n
+0001a700: 2020 2020 2020 2020 6966 2065 7665 6e74          if event
+0001a710: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+0001a720: 203d 3d20 636f 6d6d 6974 5f70 6f73 6974   == commit_posit
+0001a730: 696f 6e3a 5c6e 2020 2020 2020 2020 2020  ion:\n          
+0001a740: 2020 6272 6561 6b5c 6e20 2020 2061 7373    break\n    ass
+0001a750: 6572 7420 7265 6365 6976 6564 5b2d 335d  ert received[-3]
+0001a760: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
+0001a770: 5c6e 2020 2020 6173 7365 7274 2072 6563  \n    assert rec
+0001a780: 6569 7665 645b 2d32 5d2e 6964 203d 3d20  eived[-2].id == 
+0001a790: 6576 656e 7432 2e69 645c 6e20 2020 2061  event2.id\n    a
+0001a7a0: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
+0001a7b0: 315d 2e69 6420 3d3d 2065 7665 6e74 332e  1].id == event3.
+0001a7c0: 6964 5c6e 5c6e 5c6e 2020 2020 2320 436c  id\n\n\n    # Cl
+0001a7d0: 6f73 6520 7468 6520 636c 6965 6e74 2e5c  ose the client.\
+0001a7e0: 6e20 2020 2061 7761 6974 2063 6c69 656e  n    await clien
+0001a7f0: 742e 636c 6f73 6528 295c 6e5c 6e5c 6e23  t.close()\n\n\n#
+0001a800: 2052 756e 2074 6865 2064 656d 6f2e 5c6e   Run the demo.\n
+0001a810: 6173 796e 6369 6f2e 6765 745f 6576 656e  asyncio.get_even
+0001a820: 745f 6c6f 6f70 2829 2e72 756e 5f75 6e74  t_loop().run_unt
+0001a830: 696c 5f63 6f6d 706c 6574 6528 5c6e 2020  il_complete(\n  
+0001a840: 2020 6465 6d6f 6e73 7472 6174 655f 6173    demonstrate_as
+0001a850: 796e 6369 6f5f 636c 6965 6e74 2829 5c6e  yncio_client()\n
+0001a860: 295c 6e60 6060 5c6e 5c6e 2323 204e 6f74  )\n```\n\n## Not
+0001a870: 6573 5c6e 5c6e 2323 2320 5265 6775 6c61  es\n\n### Regula
+0001a880: 7220 6578 7072 6573 7369 6f6e 2066 696c  r expression fil
+0001a890: 7465 7273 5c6e 5c6e 5468 6520 6072 6561  ters\n\nThe `rea
+0001a8a0: 645f 616c 6c5f 6576 656e 7473 2829 602c  d_all_events()`,
+0001a8b0: 2060 7375 6273 6372 6962 655f 616c 6c5f   `subscribe_all_
+0001a8c0: 6576 656e 7473 2829 602c 2060 6372 6561  events()`, `crea
+0001a8d0: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+0001a8e0: 2960 5c6e 616e 6420 6067 6574 5f63 6f6d  )`\nand `get_com
+0001a8f0: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
+0001a900: 6d65 7468 6f64 7320 6861 7665 2060 6669  methods have `fi
+0001a910: 6c74 6572 5f65 7863 6c75 6465 6020 616e  lter_exclude` an
+0001a920: 6420 6066 696c 7465 725f 696e 636c 7564  d `filter_includ
+0001a930: 6560 5c6e 6172 6775 6d65 6e74 732e 2054  e`\narguments. T
+0001a940: 6869 7320 7365 6374 696f 6e20 7072 6f76  his section prov
+0001a950: 6964 6573 2073 6f6d 6520 6d6f 7265 2064  ides some more d
+0001a960: 6574 6169 6c73 2061 626f 7574 2074 6865  etails about the
+0001a970: 2076 616c 7565 7320 6f66 2074 6865 7365   values of these
+0001a980: 5c6e 6172 6775 6d65 6e74 732e 5c6e 5c6e  \narguments.\n\n
+0001a990: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0001a9a0: 6520 6f66 2074 6865 2060 6669 6c74 6572  e of the `filter
+0001a9b0: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+0001a9c0: 6e74 7320 6973 2064 6573 6967 6e65 6420  nts is designed 
+0001a9d0: 746f 2065 7863 6c75 6465 5c6e 4576 656e  to exclude\nEven
+0001a9e0: 7453 746f 7265 4442 2022 7379 7374 656d  tStoreDB "system
+0001a9f0: 2220 616e 6420 2270 6572 7369 7374 656e  " and "persisten
+0001aa00: 6365 2073 7562 7363 7269 7074 696f 6e20  ce subscription 
+0001aa10: 636f 6e66 6967 2220 6576 656e 7473 2c20  config" events, 
+0001aa20: 7768 6963 685c 6e6f 7468 6572 7769 7365  which\notherwise
+0001aa30: 2077 6f75 6c64 2062 6520 696e 636c 7564   would be includ
+0001aa40: 6564 2e5c 6e5c 6e53 7973 7465 6d20 6576  ed.\n\nSystem ev
+0001aa50: 656e 7473 2067 656e 6572 6174 6564 2062  ents generated b
+0001aa60: 7920 4576 656e 7453 746f 7265 4442 2068  y EventStoreDB h
+0001aa70: 6176 6520 6074 7970 6560 2073 7472 696e  ave `type` strin
+0001aa80: 6773 2074 6861 7420 7374 6172 7420 7769  gs that start wi
+0001aa90: 7468 5c6e 7468 6520 6024 6020 7369 676e  th\nthe `$` sign
+0001aaa0: 2e20 5065 7273 6973 7465 6e63 6520 7375  . Persistence su
+0001aab0: 6273 6372 6970 7469 6f6e 2065 7665 6e74  bscription event
+0001aac0: 7320 6765 6e65 7261 7465 6420 7768 656e  s generated when
+0001aad0: 206d 616e 6970 756c 6174 696e 675c 6e70   manipulating\np
+0001aae0: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
+0001aaf0: 7269 7074 696f 6e73 2068 6176 6520 6074  riptions have `t
+0001ab00: 7970 6560 2073 7472 696e 6773 2074 6861  ype` strings tha
+0001ab10: 7420 7374 6172 7420 7769 7468 2060 5065  t start with `Pe
+0001ab20: 7273 6973 7465 6e74 436f 6e66 6967 602e  rsistentConfig`.
+0001ab30: 5c6e 5c6e 466f 7220 6578 616d 706c 652c  \n\nFor example,
+0001ab40: 2074 6f20 6d61 7463 6820 7468 6520 7479   to match the ty
+0001ab50: 7065 206f 6620 4576 656e 7453 746f 7265  pe of EventStore
+0001ab60: 4442 2073 7973 7465 6d20 6576 656e 7473  DB system events
+0001ab70: 2c20 7573 6520 7468 6520 7265 6775 6c61  , use the regula
+0001ab80: 725c 6e65 7870 7265 7373 696f 6e20 7374  r\nexpression st
+0001ab90: 7269 6e67 2060 725c 275c 5c24 2e2b 5c27  ring `r\'\\$.+\'
+0001aba0: 602e 2050 6c65 6173 6520 6e6f 7465 2c20  `. Please note, 
+0001abb0: 7468 6520 636f 6e73 7461 6e74 2060 4553  the constant `ES
+0001abc0: 4442 5f53 5953 5445 4d5f 4556 454e 5453  DB_SYSTEM_EVENTS
+0001abd0: 5f52 4547 4558 6020 6973 5c6e 7365 7420  _REGEX` is\nset 
+0001abe0: 746f 2074 6869 7320 7661 6c75 652e 2059  to this value. Y
+0001abf0: 6f75 2063 616e 2069 6d70 6f72 7420 7468  ou can import th
+0001ac00: 6973 2063 6f6e 7374 616e 7420 6672 6f6d  is constant from
+0001ac10: 2060 6573 6462 636c 6965 6e74 6020 616e   `esdbclient` an
+0001ac20: 6420 7573 6520 6974 2077 6865 6e5c 6e62  d use it when\nb
+0001ac30: 7569 6c64 696e 6720 6c6f 6e67 6572 2073  uilding longer s
+0001ac40: 6571 7565 6e63 6573 206f 6620 7265 6775  equences of regu
+0001ac50: 6c61 7220 6578 7072 6573 7369 6f6e 732e  lar expressions.
+0001ac60: 5c6e 5c6e 5369 6d69 6c61 726c 792c 2074  \n\nSimilarly, t
+0001ac70: 6f20 6d61 7463 6820 7468 6520 7479 7065  o match the type
+0001ac80: 206f 6620 4576 656e 7453 746f 7265 4442   of EventStoreDB
+0001ac90: 2070 6572 7369 7374 656e 6365 2073 7562   persistence sub
+0001aca0: 7363 7269 7074 696f 6e20 6576 656e 7473  scription events
+0001acb0: 2c20 7573 6520 7468 655c 6e72 6567 756c  , use the\nregul
+0001acc0: 6172 2065 7870 7265 7373 696f 6e20 6072  ar expression `r
+0001acd0: 5c27 5065 7273 6973 7465 6e74 436f 6e66  \'PersistentConf
+0001ace0: 6967 5c5c 642b 5c27 602e 2054 6865 2063  ig\\d+\'`. The c
+0001acf0: 6f6e 7374 616e 7420 6045 5344 425f 5045  onstant `ESDB_PE
+0001ad00: 5253 4953 5445 4e54 5f43 4f4e 4649 475f  RSISTENT_CONFIG_
+0001ad10: 4556 454e 5453 5f52 4547 4558 605c 6e69  EVENTS_REGEX`\ni
+0001ad20: 7320 7365 7420 746f 2074 6869 7320 7661  s set to this va
+0001ad30: 6c75 652e 2059 6f75 2063 616e 2069 6d70  lue. You can imp
+0001ad40: 6f72 7420 7468 6973 2063 6f6e 7374 616e  ort this constan
+0001ad50: 7420 6672 6f6d 2060 6573 6462 636c 6965  t from `esdbclie
+0001ad60: 6e74 6020 2061 6e64 2075 7365 2069 7420  nt`  and use it 
+0001ad70: 7768 656e 5c6e 6275 696c 6469 6e67 206c  when\nbuilding l
+0001ad80: 6f6e 6765 7220 7365 7175 656e 6365 7320  onger sequences 
+0001ad90: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0001ada0: 7373 696f 6e73 2e5c 6e5c 6e54 6865 2063  ssions.\n\nThe c
+0001adb0: 6f6e 7374 616e 7420 6044 4546 4155 4c54  onstant `DEFAULT
+0001adc0: 5f45 5843 4c55 4445 5f46 494c 5445 5260  _EXCLUDE_FILTER`
+0001add0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+0001ade0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
+0001adf0: 7369 6f6e 7320 7468 6174 2069 6e63 6c75  sions that inclu
+0001ae00: 6465 735c 6e62 6f74 6820 6045 5344 425f  des\nboth `ESDB_
+0001ae10: 5359 5354 454d 5f45 5645 4e54 535f 5245  SYSTEM_EVENTS_RE
+0001ae20: 4745 5860 2061 6e64 2060 4553 4442 5f50  GEX` and `ESDB_P
+0001ae30: 4552 5349 5354 454e 545f 434f 4e46 4947  ERSISTENT_CONFIG
+0001ae40: 5f45 5645 4e54 535f 5245 4745 5860 2e20  _EVENTS_REGEX`. 
+0001ae50: 4974 2069 7320 7573 6564 5c6e 6173 2074  It is used\nas t
+0001ae60: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0001ae70: 206f 6620 6066 696c 7465 725f 6578 636c   of `filter_excl
+0001ae80: 7564 6560 2073 6f20 7468 6174 2074 6865  ude` so that the
+0001ae90: 2065 7665 6e74 7320 7468 6174 2045 7665   events that Eve
+0001aea0: 6e74 5374 6f72 6544 4220 6765 6e65 7261  ntStoreDB genera
+0001aeb0: 7465 735c 6e69 6e74 6572 6e61 6c6c 7920  tes\ninternally 
+0001aec0: 6172 6520 6578 636c 7564 6564 2062 7920  are excluded by 
+0001aed0: 6465 6661 756c 742c 2065 7665 6e74 7320  default, events 
+0001aee0: 6f74 6865 7220 7468 616e 2074 6f20 7468  other than to th
+0001aef0: 6f73 6520 7768 6963 6820 796f 7520 7265  ose which you re
+0001af00: 636f 7264 2075 7369 6e67 5c6e 7468 6520  cord using\nthe 
+0001af10: 6061 7070 656e 645f 6576 656e 7473 2829  `append_events()
+0001af20: 6020 6d65 7468 6f64 2e5c 6e5c 6e49 6620  ` method.\n\nIf 
+0001af30: 796f 7520 7761 6e74 2074 6f20 6578 636c  you want to excl
+0001af40: 7564 652c 2066 6f72 2065 7861 6d70 6c65  ude, for example
+0001af50: 2c20 736e 6170 7368 6f74 7320 6672 6f6d  , snapshots from
+0001af60: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+0001af70: 656e 7473 2072 6574 7572 6e65 6420 7768  ents returned wh
+0001af80: 656e 5c6e 7265 6164 696e 6720 6576 656e  en\nreading even
+0001af90: 7473 2066 726f 6d20 7468 6520 6461 7461  ts from the data
+0001afa0: 6261 7365 2c20 7468 656e 2079 6f75 206d  base, then you m
+0001afb0: 6179 2077 6973 6820 746f 2075 7365 2061  ay wish to use a
+0001afc0: 2061 7070 726f 7072 6961 7465 6c79 2065   appropriately e
+0001afd0: 7874 656e 6465 645c 6e63 6f70 7920 6f66  xtended\ncopy of
+0001afe0: 2060 4445 4641 554c 545f 4558 434c 5544   `DEFAULT_EXCLUD
+0001aff0: 455f 4649 4c54 4552 6020 6173 2074 6865  E_FILTER` as the
+0001b000: 2076 616c 7565 206f 6620 7468 6520 6066   value of the `f
+0001b010: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
+0001b020: 7267 756d 656e 7473 2e5c 6e5c 6e5c 6e23  rguments.\n\n\n#
+0001b030: 2320 436f 6e74 7269 6275 746f 7273 5c6e  # Contributors\n
+0001b040: 5c6e 2323 2320 496e 7374 616c 6c20 506f  \n### Install Po
+0001b050: 6574 7279 5c6e 5c6e 5468 6520 6669 7273  etry\n\nThe firs
+0001b060: 7420 7468 696e 6720 6973 2074 6f20 6368  t thing is to ch
+0001b070: 6563 6b20 796f 7520 6861 7665 2050 6f65  eck you have Poe
+0001b080: 7472 7920 696e 7374 616c 6c65 642e 5c6e  try installed.\n
+0001b090: 5c6e 2020 2020 2420 706f 6574 7279 202d  \n    $ poetry -
+0001b0a0: 2d76 6572 7369 6f6e 5c6e 5c6e 4966 2079  -version\n\nIf y
+0001b0b0: 6f75 2064 6f6e 5c27 742c 2074 6865 6e20  ou don\'t, then 
+0001b0c0: 706c 6561 7365 205b 696e 7374 616c 6c20  please [install 
+0001b0d0: 506f 6574 7279 5d28 6874 7470 733a 2f2f  Poetry](https://
+0001b0e0: 7079 7468 6f6e 2d70 6f65 7472 792e 6f72  python-poetry.or
+0001b0f0: 672f 646f 6373 2f23 696e 7374 616c 6c69  g/docs/#installi
+0001b100: 6e67 2d77 6974 682d 7468 652d 6f66 6669  ng-with-the-offi
+0001b110: 6369 616c 2d69 6e73 7461 6c6c 6572 292e  cial-installer).
+0001b120: 5c6e 5c6e 2020 2020 2420 6375 726c 202d  \n\n    $ curl -
+0001b130: 7353 4c20 6874 7470 733a 2f2f 696e 7374  sSL https://inst
+0001b140: 616c 6c2e 7079 7468 6f6e 2d70 6f65 7472  all.python-poetr
+0001b150: 792e 6f72 6720 7c20 7079 7468 6f6e 3320  y.org | python3 
+0001b160: 2d5c 6e5c 6e49 7420 7769 6c6c 2068 656c  -\n\nIt will hel
+0001b170: 7020 746f 206d 616b 6520 7375 7265 2050  p to make sure P
+0001b180: 6f65 7472 795c 2773 2062 696e 2064 6972  oetry\'s bin dir
+0001b190: 6563 746f 7279 2069 7320 696e 2079 6f75  ectory is in you
+0001b1a0: 7220 6050 4154 4860 2065 6e76 6972 6f6e  r `PATH` environ
+0001b1b0: 6d65 6e74 2076 6172 6961 626c 652e 5c6e  ment variable.\n
+0001b1c0: 5c6e 4275 7420 696e 2061 6e79 2063 6173  \nBut in any cas
+0001b1d0: 652c 206d 616b 6520 7375 7265 2079 6f75  e, make sure you
+0001b1e0: 206b 6e6f 7720 7468 6520 7061 7468 2074   know the path t
+0001b1f0: 6f20 7468 6520 6070 6f65 7472 7960 2065  o the `poetry` e
+0001b200: 7865 6375 7461 626c 652e 2054 6865 2050  xecutable. The P
+0001b210: 6f65 7472 795c 6e69 6e73 7461 6c6c 6572  oetry\ninstaller
+0001b220: 2074 656c 6c73 2079 6f75 2077 6865 7265   tells you where
+0001b230: 2069 7420 6861 7320 6265 656e 2069 6e73   it has been ins
+0001b240: 7461 6c6c 6564 2c20 616e 6420 686f 7720  talled, and how 
+0001b250: 746f 2063 6f6e 6669 6775 7265 2079 6f75  to configure you
+0001b260: 7220 7368 656c 6c2e 5c6e 5c6e 506c 6561  r shell.\n\nPlea
+0001b270: 7365 2072 6566 6572 2074 6f20 7468 6520  se refer to the 
+0001b280: 5b50 6f65 7472 7920 646f 6373 5d28 6874  [Poetry docs](ht
+0001b290: 7470 733a 2f2f 7079 7468 6f6e 2d70 6f65  tps://python-poe
+0001b2a0: 7472 792e 6f72 672f 646f 6373 2f29 2066  try.org/docs/) f
+0001b2b0: 6f72 2067 7569 6461 6e63 6520 6f6e 5c6e  or guidance on\n
+0001b2c0: 7573 696e 6720 506f 6574 7279 2e5c 6e5c  using Poetry.\n\
+0001b2d0: 6e23 2323 2053 6574 7570 2066 6f72 2050  n### Setup for P
+0001b2e0: 7943 6861 726d 2075 7365 7273 5c6e 5c6e  yCharm users\n\n
+0001b2f0: 596f 7520 6361 6e20 6561 7369 6c79 206f  You can easily o
+0001b300: 6274 6169 6e20 7468 6520 7072 6f6a 6563  btain the projec
+0001b310: 7420 6669 6c65 7320 7573 696e 6720 5079  t files using Py
+0001b320: 4368 6172 6d20 286d 656e 7520 2247 6974  Charm (menu "Git
+0001b330: 203e 2043 6c6f 6e65 2e2e 2e22 292e 5c6e   > Clone...").\n
+0001b340: 5079 4368 6172 6d20 7769 6c6c 2074 6865  PyCharm will the
+0001b350: 6e20 7573 7561 6c6c 7920 7072 6f6d 7074  n usually prompt
+0001b360: 2079 6f75 2074 6f20 6f70 656e 2074 6865   you to open the
+0001b370: 2070 726f 6a65 6374 2e5c 6e5c 6e4f 7065   project.\n\nOpe
+0001b380: 6e20 7468 6520 7072 6f6a 6563 7420 696e  n the project in
+0001b390: 2061 206e 6577 2077 696e 646f 772e 2050   a new window. P
+0001b3a0: 7943 6861 726d 2077 696c 6c20 7468 656e  yCharm will then
+0001b3b0: 2075 7375 616c 6c79 2070 726f 6d70 7420   usually prompt 
+0001b3c0: 796f 7520 746f 2063 7265 6174 655c 6e61  you to create\na
+0001b3d0: 206e 6577 2076 6972 7475 616c 2065 6e76   new virtual env
+0001b3e0: 6972 6f6e 6d65 6e74 2e5c 6e5c 6e43 7265  ironment.\n\nCre
+0001b3f0: 6174 6520 6120 6e65 7720 506f 6574 7279  ate a new Poetry
+0001b400: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
+0001b410: 6d65 6e74 2066 6f72 2074 6865 2070 726f  ment for the pro
+0001b420: 6a65 6374 2e20 4966 2050 7943 6861 726d  ject. If PyCharm
+0001b430: 2064 6f65 736e 5c27 7420 616c 7265 6164   doesn\'t alread
+0001b440: 795c 6e6b 6e6f 7720 7768 6572 6520 796f  y\nknow where yo
+0001b450: 7572 2060 706f 6574 7279 6020 6578 6563  ur `poetry` exec
+0001b460: 7574 6162 6c65 2069 732c 2074 6865 6e20  utable is, then 
+0001b470: 7365 7420 7468 6520 7061 7468 2074 6f20  set the path to 
+0001b480: 796f 7572 2060 706f 6574 7279 6020 6578  your `poetry` ex
+0001b490: 6563 7574 6162 6c65 5c6e 696e 2074 6865  ecutable\nin the
+0001b4a0: 2022 4e65 7720 506f 6574 7279 2045 6e76   "New Poetry Env
+0001b4b0: 6972 6f6e 6d65 6e74 2220 666f 726d 2069  ironment" form i
+0001b4c0: 6e70 7574 2066 6965 6c64 206c 6162 656c  nput field label
+0001b4d0: 6c65 6420 2250 6f65 7472 7920 6578 6563  led "Poetry exec
+0001b4e0: 7574 6162 6c65 222e 2049 6e20 7468 655c  utable". In the\
+0001b4f0: 6e22 4e65 7720 506f 6574 7279 2045 6e76  n"New Poetry Env
+0001b500: 6972 6f6e 6d65 6e74 2220 666f 726d 2c20  ironment" form, 
+0001b510: 796f 7520 7769 6c6c 2061 6c73 6f20 6861  you will also ha
+0001b520: 7665 2074 6865 206f 7070 6f72 7475 6e69  ve the opportuni
+0001b530: 7479 2074 6f20 7365 6c65 6374 2077 6869  ty to select whi
+0001b540: 6368 5c6e 5079 7468 6f6e 2065 7865 6375  ch\nPython execu
+0001b550: 7461 626c 6520 7769 6c6c 2062 6520 7573  table will be us
+0001b560: 6564 2062 7920 7468 6520 7669 7274 7561  ed by the virtua
+0001b570: 6c20 656e 7669 726f 6e6d 656e 742e 5c6e  l environment.\n
+0001b580: 5c6e 5079 4368 6172 6d20 7769 6c6c 2074  \nPyCharm will t
+0001b590: 6865 6e20 6372 6561 7465 2061 206e 6577  hen create a new
+0001b5a0: 2050 6f65 7472 7920 7669 7274 7561 6c20   Poetry virtual 
+0001b5b0: 656e 7669 726f 6e6d 656e 7420 666f 7220  environment for 
+0001b5c0: 796f 7572 2070 726f 6a65 6374 2c20 7573  your project, us
+0001b5d0: 696e 675c 6e61 2070 6172 7469 6375 6c61  ing\na particula
+0001b5e0: 7220 7665 7273 696f 6e20 6f66 2050 7974  r version of Pyt
+0001b5f0: 686f 6e2c 2061 6e64 2061 6c73 6f20 696e  hon, and also in
+0001b600: 7374 616c 6c20 696e 746f 2074 6869 7320  stall into this 
+0001b610: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+0001b620: 656e 7420 7468 655c 6e70 726f 6a65 6374  ent the\nproject
+0001b630: 5c27 7320 7061 636b 6167 6520 6465 7065  \'s package depe
+0001b640: 6e64 656e 6369 6573 2061 6363 6f72 6469  ndencies accordi
+0001b650: 6e67 2074 6f20 7468 6520 7072 6f6a 6563  ng to the projec
+0001b660: 745c 2773 2060 706f 6574 7279 2e6c 6f63  t\'s `poetry.loc
+0001b670: 6b60 2066 696c 652e 5c6e 5c6e 596f 7520  k` file.\n\nYou 
+0001b680: 6361 6e20 6164 6420 6469 6666 6572 656e  can add differen
+0001b690: 7420 506f 6574 7279 2065 6e76 6972 6f6e  t Poetry environ
+0001b6a0: 6d65 6e74 7320 666f 7220 6469 6666 6572  ments for differ
+0001b6b0: 656e 7420 5079 7468 6f6e 2076 6572 7369  ent Python versi
+0001b6c0: 6f6e 732c 2061 6e64 2073 7769 7463 685c  ons, and switch\
+0001b6d0: 6e62 6574 7765 656e 2074 6865 6d20 7573  nbetween them us
+0001b6e0: 696e 6720 7468 6520 2250 7974 686f 6e20  ing the "Python 
+0001b6f0: 496e 7465 7270 7265 7465 7222 2073 6574  Interpreter" set
+0001b700: 7469 6e67 7320 6f66 2050 7943 6861 726d  tings of PyCharm
+0001b710: 2e20 4966 2079 6f75 2077 616e 7420 746f  . If you want to
+0001b720: 2075 7365 5c6e 6120 7665 7273 696f 6e20   use\na version 
+0001b730: 6f66 2050 7974 686f 6e20 7468 6174 2069  of Python that i
+0001b740: 736e 5c27 7420 696e 7374 616c 6c65 642c  sn\'t installed,
+0001b750: 2065 6974 6865 7220 7573 6520 796f 7572   either use your
+0001b760: 2066 6176 6f75 7269 7465 2070 6163 6b61   favourite packa
+0001b770: 6765 206d 616e 6167 6572 2c5c 6e6f 7220  ge manager,\nor 
+0001b780: 696e 7374 616c 6c20 5079 7468 6f6e 2062  install Python b
+0001b790: 7920 646f 776e 6c6f 6164 696e 6720 616e  y downloading an
+0001b7a0: 2069 6e73 7461 6c6c 6572 2066 6f72 2072   installer for r
+0001b7b0: 6563 656e 7420 7665 7273 696f 6e73 206f  ecent versions o
+0001b7c0: 6620 5079 7468 6f6e 2064 6972 6563 746c  f Python directl
+0001b7d0: 795c 6e66 726f 6d20 7468 6520 5b50 7974  y\nfrom the [Pyt
+0001b7e0: 686f 6e20 7765 6273 6974 655d 2868 7474  hon website](htt
+0001b7f0: 7073 3a2f 2f77 7777 2e70 7974 686f 6e2e  ps://www.python.
+0001b800: 6f72 672f 646f 776e 6c6f 6164 732f 292e  org/downloads/).
+0001b810: 5c6e 5c6e 4f6e 6365 2070 726f 6a65 6374  \n\nOnce project
+0001b820: 2064 6570 656e 6465 6e63 6965 7320 6861   dependencies ha
+0001b830: 7665 2062 6565 6e20 696e 7374 616c 6c65  ve been installe
+0001b840: 642c 2079 6f75 2073 686f 756c 6420 6265  d, you should be
+0001b850: 2061 626c 6520 746f 2072 756e 2074 6573   able to run tes
+0001b860: 7473 5c6e 6672 6f6d 2077 6974 6869 6e20  ts\nfrom within 
+0001b870: 5079 4368 6172 6d20 2872 6967 6874 2d63  PyCharm (right-c
+0001b880: 6c69 636b 206f 6e20 7468 6520 6074 6573  lick on the `tes
+0001b890: 7473 6020 666f 6c64 6572 2061 6e64 2073  ts` folder and s
+0001b8a0: 656c 6563 7420 7468 6520 5c27 5275 6e5c  elect the \'Run\
+0001b8b0: 2720 6f70 7469 6f6e 292e 5c6e 5c6e 4265  ' option).\n\nBe
+0001b8c0: 6361 7573 6520 6f66 2061 2063 6f6e 666c  cause of a confl
+0001b8d0: 6963 7420 6265 7477 6565 6e20 7079 7465  ict between pyte
+0001b8e0: 7374 2061 6e64 2050 7943 6861 726d 5c27  st and PyCharm\'
+0001b8f0: 7320 6465 6275 6767 6572 2061 6e64 2074  s debugger and t
+0001b900: 6865 2063 6f76 6572 6167 6520 746f 6f6c  he coverage tool
+0001b910: 2c5c 6e79 6f75 206d 6179 206e 6565 6420  ,\nyou may need 
+0001b920: 746f 2061 6464 2060 602d 2d6e 6f2d 636f  to add ``--no-co
+0001b930: 7660 6020 6173 2061 6e20 6f70 7469 6f6e  v`` as an option
+0001b940: 2074 6f20 7468 6520 7465 7374 2072 756e   to the test run
+0001b950: 6e65 7220 7465 6d70 6c61 7465 2e20 416c  ner template. Al
+0001b960: 7465 726e 6174 6976 656c 792c 5c6e 6a75  ternatively,\nju
+0001b970: 7374 2075 7365 2074 6865 2050 7974 686f  st use the Pytho
+0001b980: 6e20 5374 616e 6461 7264 204c 6962 7261  n Standard Libra
+0001b990: 7279 5c27 7320 6060 756e 6974 7465 7374  ry\'s ``unittest
+0001b9a0: 6060 206d 6f64 756c 652e 5c6e 5c6e 596f  `` module.\n\nYo
+0001b9b0: 7520 7368 6f75 6c64 2061 6c73 6f20 6265  u should also be
+0001b9c0: 2061 626c 6520 746f 206f 7065 6e20 6120   able to open a 
+0001b9d0: 7465 726d 696e 616c 2077 696e 646f 7720  terminal window 
+0001b9e0: 696e 2050 7943 6861 726d 2c20 616e 6420  in PyCharm, and 
+0001b9f0: 7275 6e20 7468 6520 7072 6f6a 6563 745c  run the project\
+0001ba00: 2773 5c6e 4d61 6b65 6669 6c65 2063 6f6d  's\nMakefile com
+0001ba10: 6d61 6e64 7320 6672 6f6d 2074 6865 2063  mands from the c
+0001ba20: 6f6d 6d61 6e64 206c 696e 6520 2873 6565  ommand line (see
+0001ba30: 2062 656c 6f77 292e 5c6e 5c6e 2323 2320   below).\n\n### 
+0001ba40: 5365 7475 7020 6672 6f6d 2063 6f6d 6d61  Setup from comma
+0001ba50: 6e64 206c 696e 655c 6e5c 6e4f 6274 6169  nd line\n\nObtai
+0001ba60: 6e20 7468 6520 7072 6f6a 6563 7420 6669  n the project fi
+0001ba70: 6c65 732c 2075 7369 6e67 2047 6974 206f  les, using Git o
+0001ba80: 7220 7375 6974 6162 6c65 2061 6c74 6572  r suitable alter
+0001ba90: 6e61 7469 7665 2e5c 6e5c 6e49 6e20 6120  native.\n\nIn a 
+0001baa0: 7465 726d 696e 616c 2061 7070 6c69 6361  terminal applica
+0001bab0: 7469 6f6e 2c20 6368 616e 6765 2079 6f75  tion, change you
+0001bac0: 7220 6375 7272 656e 7420 776f 726b 696e  r current workin
+0001bad0: 6720 6469 7265 6374 6f72 795c 6e74 6f20  g directory\nto 
+0001bae0: 7468 6520 726f 6f74 2066 6f6c 6465 7220  the root folder 
+0001baf0: 6f66 2074 6865 2070 726f 6a65 6374 2066  of the project f
+0001bb00: 696c 6573 2e20 5468 6572 6520 7368 6f75  iles. There shou
+0001bb10: 6c64 2062 6520 6120 4d61 6b65 6669 6c65  ld be a Makefile
+0001bb20: 5c6e 696e 2074 6869 7320 666f 6c64 6572  \nin this folder
+0001bb30: 2e5c 6e5c 6e55 7365 2074 6865 204d 616b  .\n\nUse the Mak
+0001bb40: 6566 696c 6520 746f 2063 7265 6174 6520  efile to create 
+0001bb50: 6120 6e65 7720 506f 6574 7279 2076 6972  a new Poetry vir
+0001bb60: 7475 616c 2065 6e76 6972 6f6e 6d65 6e74  tual environment
+0001bb70: 2066 6f72 2074 6865 5c6e 7072 6f6a 6563   for the\nprojec
+0001bb80: 7420 616e 6420 696e 7374 616c 6c20 7468  t and install th
+0001bb90: 6520 7072 6f6a 6563 745c 2773 2070 6163  e project\'s pac
+0001bba0: 6b61 6765 2064 6570 656e 6465 6e63 6965  kage dependencie
+0001bbb0: 7320 696e 746f 2069 742c 5c6e 7573 696e  s into it,\nusin
+0001bbc0: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+0001bbd0: 636f 6d6d 616e 642e 5c6e 5c6e 2020 2020  command.\n\n    
+0001bbe0: 2420 6d61 6b65 2069 6e73 7461 6c6c 2d70  $ make install-p
+0001bbf0: 6163 6b61 6765 735c 6e5c 6e49 745c 2773  ackages\n\nIt\'s
+0001bc00: 2061 6c73 6f20 706f 7373 6962 6c65 2074   also possible t
+0001bc10: 6f20 616c 736f 2069 6e73 7461 6c6c 2074  o also install t
+0001bc20: 6865 2070 726f 6a65 6374 2069 6e20 5c27  he project in \'
+0001bc30: 6564 6974 6162 6c65 206d 6f64 655c 272e  editable mode\'.
+0001bc40: 5c6e 5c6e 2020 2020 2420 6d61 6b65 2069  \n\n    $ make i
+0001bc50: 6e73 7461 6c6c 5c6e 5c6e 506c 6561 7365  nstall\n\nPlease
+0001bc60: 206e 6f74 652c 2069 6620 796f 7520 6372   note, if you cr
+0001bc70: 6561 7465 2074 6865 2076 6972 7475 616c  eate the virtual
+0001bc80: 2065 6e76 6972 6f6e 6d65 6e74 2069 6e20   environment in 
+0001bc90: 7468 6973 2077 6179 2c20 616e 6420 7468  this way, and th
+0001bca0: 656e 2074 7279 2074 6f5c 6e6f 7065 6e20  en try to\nopen 
+0001bcb0: 7468 6520 7072 6f6a 6563 7420 696e 2050  the project in P
+0001bcc0: 7943 6861 726d 2061 6e64 2063 6f6e 6669  yCharm and confi
+0001bcd0: 6775 7265 2074 6865 2070 726f 6a65 6374  gure the project
+0001bce0: 2074 6f20 7573 6520 7468 6973 2076 6972   to use this vir
+0001bcf0: 7475 616c 5c6e 656e 7669 726f 6e6d 656e  tual\nenvironmen
+0001bd00: 7420 6173 2061 6e20 2245 7869 7374 696e  t as an "Existin
+0001bd10: 6720 506f 6574 7279 2045 6e76 6972 6f6e  g Poetry Environ
+0001bd20: 6d65 6e74 222c 2050 7943 6861 726d 2073  ment", PyCharm s
+0001bd30: 6f6d 6574 696d 6573 2068 6173 2073 6f6d  ometimes has som
+0001bd40: 655c 6e69 7373 7565 7320 2864 6f6e 5c27  e\nissues (don\'
+0001bd50: 7420 6b6e 6f77 2077 6879 2920 7768 6963  t know why) whic
+0001bd60: 6820 6d69 6768 7420 6265 2070 726f 626c  h might be probl
+0001bd70: 656d 6174 6963 2e20 4966 2079 6f75 2065  ematic. If you e
+0001bd80: 6e63 6f75 6e74 6572 2073 7563 685c 6e69  ncounter such\ni
+0001bd90: 7373 7565 732c 2079 6f75 2063 616e 2072  ssues, you can r
+0001bda0: 6573 6f6c 7665 2074 6865 7365 2069 7373  esolve these iss
+0001bdb0: 7565 7320 6279 2064 656c 6574 696e 6720  ues by deleting 
+0001bdc0: 7468 6520 7669 7274 7561 6c20 656e 7669  the virtual envi
+0001bdd0: 726f 6e6d 656e 745c 6e61 6e64 2063 7265  ronment\nand cre
+0001bde0: 6174 696e 6720 7468 6520 506f 6574 7279  ating the Poetry
+0001bdf0: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
+0001be00: 6d65 6e74 2075 7369 6e67 2050 7943 6861  ment using PyCha
+0001be10: 726d 2028 7365 6520 6162 6f76 6529 2e5c  rm (see above).\
+0001be20: 6e5c 6e23 2323 2050 726f 6a65 6374 204d  n\n### Project M
+0001be30: 616b 6566 696c 6520 636f 6d6d 616e 6473  akefile commands
+0001be40: 5c6e 5c6e 596f 7520 6361 6e20 7374 6172  \n\nYou can star
+0001be50: 7420 4576 656e 7453 746f 7265 4442 2075  t EventStoreDB u
+0001be60: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
+0001be70: 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20  ng command.\n\n 
+0001be80: 2020 2024 206d 616b 6520 7374 6172 742d     $ make start-
+0001be90: 6576 656e 7473 746f 7265 6462 5c6e 5c6e  eventstoredb\n\n
+0001bea0: 596f 7520 6361 6e20 7275 6e20 7465 7374  You can run test
+0001beb0: 7320 7573 696e 6720 7468 6520 666f 6c6c  s using the foll
+0001bec0: 6f77 696e 6720 636f 6d6d 616e 6420 286e  owing command (n
+0001bed0: 6565 6473 2045 7665 6e74 5374 6f72 6544  eeds EventStoreD
+0001bee0: 4220 746f 2062 6520 7275 6e6e 696e 6729  B to be running)
+0001bef0: 2e5c 6e5c 6e20 2020 2024 206d 616b 6520  .\n\n    $ make 
+0001bf00: 7465 7374 5c6e 5c6e 596f 7520 6361 6e20  test\n\nYou can 
+0001bf10: 7374 6f70 2045 7665 6e74 5374 6f72 6544  stop EventStoreD
+0001bf20: 4220 7573 696e 6720 7468 6520 666f 6c6c  B using the foll
+0001bf30: 6f77 696e 6720 636f 6d6d 616e 642e 5c6e  owing command.\n
+0001bf40: 5c6e 2020 2020 2420 6d61 6b65 2073 746f  \n    $ make sto
+0001bf50: 702d 6576 656e 7473 746f 7265 6462 5c6e  p-eventstoredb\n
+0001bf60: 5c6e 596f 7520 6361 6e20 6368 6563 6b20  \nYou can check 
+0001bf70: 7468 6520 666f 726d 6174 7469 6e67 206f  the formatting o
+0001bf80: 6620 7468 6520 636f 6465 2075 7369 6e67  f the code using
+0001bf90: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
+0001bfa0: 6f6d 6d61 6e64 2e5c 6e5c 6e20 2020 2024  ommand.\n\n    $
+0001bfb0: 206d 616b 6520 6c69 6e74 5c6e 5c6e 596f   make lint\n\nYo
+0001bfc0: 7520 6361 6e20 7265 666f 726d 6174 2074  u can reformat t
+0001bfd0: 6865 2063 6f64 6520 7573 696e 6720 7468  he code using th
+0001bfe0: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
+0001bff0: 616e 642e 5c6e 5c6e 2020 2020 2420 6d61  and.\n\n    $ ma
+0001c000: 6b65 2066 6d74 5c6e 5c6e 5465 7374 7320  ke fmt\n\nTests 
+0001c010: 6265 6c6f 6e67 2069 6e20 602e 2f74 6573  belong in `./tes
+0001c020: 7473 602e 2043 6f64 652d 756e 6465 722d  ts`. Code-under-
+0001c030: 7465 7374 2062 656c 6f6e 6773 2069 6e20  test belongs in 
+0001c040: 602e 2f65 7364 6263 6c69 656e 7460 2e5c  `./esdbclient`.\
+0001c050: 6e5c 6e45 6469 7420 7061 636b 6167 6520  n\nEdit package 
+0001c060: 6465 7065 6e64 656e 6369 6573 2069 6e20  dependencies in 
+0001c070: 6070 7970 726f 6a65 6374 2e74 6f6d 6c60  `pyproject.toml`
+0001c080: 2e20 5570 6461 7465 2069 6e73 7461 6c6c  . Update install
+0001c090: 6564 2070 6163 6b61 6765 7320 2861 6e64  ed packages (and
+0001c0a0: 2074 6865 5c6e 6070 6f65 7472 792e 6c6f   the\n`poetry.lo
+0001c0b0: 636b 6020 6669 6c65 2920 7573 696e 6720  ck` file) using 
+0001c0c0: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+0001c0d0: 6d6d 616e 642e 5c6e 5c6e 2020 2020 2420  mmand.\n\n    $ 
+0001c0e0: 6d61 6b65 2075 7064 6174 652d 7061 636b  make update-pack
+0001c0f0: 6167 6573 5c6e 272c 0a20 2020 2027 6175  ages\n',.    'au
+0001c100: 7468 6f72 273a 2027 4a6f 686e 2042 7977  thor': 'John Byw
+0001c110: 6174 6572 272c 0a20 2020 2027 6175 7468  ater',.    'auth
+0001c120: 6f72 5f65 6d61 696c 273a 2027 6a6f 686e  or_email': 'john
+0001c130: 2e62 7977 6174 6572 4061 7070 726f 7072  .bywater@appropr
+0001c140: 6961 7465 736f 6674 7761 7265 2e6e 6574  iatesoftware.net
+0001c150: 272c 0a20 2020 2027 6d61 696e 7461 696e  ',.    'maintain
+0001c160: 6572 273a 2027 4e6f 6e65 272c 0a20 2020  er': 'None',.   
+0001c170: 2027 6d61 696e 7461 696e 6572 5f65 6d61   'maintainer_ema
+0001c180: 696c 273a 2027 4e6f 6e65 272c 0a20 2020  il': 'None',.   
+0001c190: 2027 7572 6c27 3a20 2768 7474 7073 3a2f   'url': 'https:/
+0001c1a0: 2f67 6974 6875 622e 636f 6d2f 7079 6576  /github.com/pyev
+0001c1b0: 656e 7473 6f75 7263 696e 672f 6573 6462  entsourcing/esdb
+0001c1c0: 636c 6965 6e74 272c 0a20 2020 2027 7061  client',.    'pa
+0001c1d0: 636b 6167 6573 273a 2070 6163 6b61 6765  ckages': package
+0001c1e0: 732c 0a20 2020 2027 7061 636b 6167 655f  s,.    'package_
+0001c1f0: 6461 7461 273a 2070 6163 6b61 6765 5f64  data': package_d
+0001c200: 6174 612c 0a20 2020 2027 696e 7374 616c  ata,.    'instal
+0001c210: 6c5f 7265 7175 6972 6573 273a 2069 6e73  l_requires': ins
+0001c220: 7461 6c6c 5f72 6571 7569 7265 732c 0a20  tall_requires,. 
+0001c230: 2020 2027 7079 7468 6f6e 5f72 6571 7569     'python_requi
+0001c240: 7265 7327 3a20 273e 3d33 2e37 2c3c 342e  res': '>=3.7,<4.
+0001c250: 3027 2c0a 7d0a 0a0a 7365 7475 7028 2a2a  0',.}...setup(**
+0001c260: 7365 7475 705f 6b77 6172 6773 290a       setup_kwargs).
```

### Comparing `esdbclient-1.0a5/PKG-INFO` & `esdbclient-1.0a6/README.md`

 * *Files 7% similar despite different names*

```diff
@@ -1,6792 +1,6962 @@
-00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00000010: 3a20 322e 310a 4e61 6d65 3a20 6573 6462  : 2.1.Name: esdb
-00000020: 636c 6965 6e74 0a56 6572 7369 6f6e 3a20  client.Version: 
-00000030: 312e 3061 350a 5375 6d6d 6172 793a 2050  1.0a5.Summary: P
-00000040: 7974 686f 6e20 6752 5043 2043 6c69 656e  ython gRPC Clien
-00000050: 7420 666f 7220 4576 656e 7453 746f 7265  t for EventStore
-00000060: 4442 0a48 6f6d 652d 7061 6765 3a20 6874  DB.Home-page: ht
-00000070: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00000080: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
-00000090: 2f65 7364 6263 6c69 656e 740a 4c69 6365  /esdbclient.Lice
-000000a0: 6e73 653a 2042 5344 2033 2d43 6c61 7573  nse: BSD 3-Claus
-000000b0: 650a 4175 7468 6f72 3a20 4a6f 686e 2042  e.Author: John B
-000000c0: 7977 6174 6572 0a41 7574 686f 722d 656d  ywater.Author-em
-000000d0: 6169 6c3a 206a 6f68 6e2e 6279 7761 7465  ail: john.bywate
-000000e0: 7240 6170 7072 6f70 7269 6174 6573 6f66  r@appropriatesof
-000000f0: 7477 6172 652e 6e65 740a 5265 7175 6972  tware.net.Requir
-00000100: 6573 2d50 7974 686f 6e3a 203e 3d33 2e37  es-Python: >=3.7
-00000110: 2c3c 342e 300a 436c 6173 7369 6669 6572  ,<4.0.Classifier
-00000120: 3a20 4465 7665 6c6f 706d 656e 7420 5374  : Development St
-00000130: 6174 7573 203a 3a20 3320 2d20 416c 7068  atus :: 3 - Alph
-00000140: 610a 436c 6173 7369 6669 6572 3a20 4c69  a.Classifier: Li
-00000150: 6365 6e73 6520 3a3a 204f 5349 2041 7070  cense :: OSI App
-00000160: 726f 7665 6420 3a3a 2042 5344 204c 6963  roved :: BSD Lic
-00000170: 656e 7365 0a43 6c61 7373 6966 6965 723a  ense.Classifier:
-00000180: 204c 6963 656e 7365 203a 3a20 4f74 6865   License :: Othe
-00000190: 722f 5072 6f70 7269 6574 6172 7920 4c69  r/Proprietary Li
-000001a0: 6365 6e73 650a 436c 6173 7369 6669 6572  cense.Classifier
-000001b0: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
-000001c0: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
-000001d0: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
-000001e0: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
-000001f0: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
-00000200: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
-00000210: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
-00000220: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
-00000230: 2e37 0a43 6c61 7373 6966 6965 723a 2050  .7.Classifier: P
-00000240: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-00000250: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00000260: 2033 2e38 0a43 6c61 7373 6966 6965 723a   3.8.Classifier:
-00000270: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
-00000280: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
-00000290: 3a3a 2033 2e39 0a43 6c61 7373 6966 6965  :: 3.9.Classifie
-000002a0: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
-000002b0: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-000002c0: 6e20 3a3a 2033 2e31 300a 436c 6173 7369  n :: 3.10.Classi
-000002d0: 6669 6572 3a20 5072 6f67 7261 6d6d 696e  fier: Programmin
-000002e0: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
-000002f0: 7468 6f6e 203a 3a20 332e 3131 0a43 6c61  thon :: 3.11.Cla
-00000300: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
-00000310: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-00000320: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
-00000330: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
-00000340: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-00000350: 2050 7974 686f 6e20 3a3a 2033 2e31 300a   Python :: 3.10.
-00000360: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
-00000370: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
-00000380: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
-00000390: 3131 0a43 6c61 7373 6966 6965 723a 2050  11.Classifier: P
-000003a0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-000003b0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-000003c0: 2033 2e37 0a43 6c61 7373 6966 6965 723a   3.7.Classifier:
-000003d0: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
-000003e0: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
-000003f0: 3a3a 2033 2e38 0a43 6c61 7373 6966 6965  :: 3.8.Classifie
-00000400: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
-00000410: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-00000420: 6e20 3a3a 2033 2e39 0a52 6571 7569 7265  n :: 3.9.Require
-00000430: 732d 4469 7374 3a20 646e 7370 7974 686f  s-Dist: dnspytho
-00000440: 6e20 283e 3d32 2e33 2e30 2c3c 332e 302e  n (>=2.3.0,<3.0.
-00000450: 3029 0a52 6571 7569 7265 732d 4469 7374  0).Requires-Dist
-00000460: 3a20 6772 7063 696f 2028 3e3d 312e 3531  : grpcio (>=1.51
-00000470: 2e30 2c21 3d31 2e35 322e 2a29 0a52 6571  .0,!=1.52.*).Req
-00000480: 7569 7265 732d 4469 7374 3a20 7072 6f74  uires-Dist: prot
-00000490: 6f62 7566 2028 3e3d 332e 3131 2e30 290a  obuf (>=3.11.0).
-000004a0: 5265 7175 6972 6573 2d44 6973 743a 2074  Requires-Dist: t
-000004b0: 7970 696e 675f 6578 7465 6e73 696f 6e73  yping_extensions
-000004c0: 0a50 726f 6a65 6374 2d55 524c 3a20 5265  .Project-URL: Re
-000004d0: 706f 7369 746f 7279 2c20 6874 7470 733a  pository, https:
-000004e0: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7965  //github.com/pye
-000004f0: 7665 6e74 736f 7572 6369 6e67 2f65 7364  ventsourcing/esd
-00000500: 6263 6c69 656e 740a 4465 7363 7269 7074  bclient.Descript
-00000510: 696f 6e2d 436f 6e74 656e 742d 5479 7065  ion-Content-Type
-00000520: 3a20 7465 7874 2f6d 6172 6b64 6f77 6e0a  : text/markdown.
-00000530: 0a23 2050 7974 686f 6e20 6752 5043 2043  .# Python gRPC C
-00000540: 6c69 656e 7420 666f 7220 4576 656e 7453  lient for EventS
-00000550: 746f 7265 4442 0a0a 5468 6973 205b 5079  toreDB..This [Py
-00000560: 7468 6f6e 2070 6163 6b61 6765 5d28 6874  thon package](ht
-00000570: 7470 733a 2f2f 7079 7069 2e6f 7267 2f70  tps://pypi.org/p
-00000580: 726f 6a65 6374 2f65 7364 6263 6c69 656e  roject/esdbclien
-00000590: 742f 2920 7072 6f76 6964 6573 2061 2050  t/) provides a P
-000005a0: 7974 686f 6e0a 6752 5043 2063 6c69 656e  ython.gRPC clien
-000005b0: 7420 666f 7220 5b45 7665 6e74 5374 6f72  t for [EventStor
-000005c0: 6544 425d 2868 7474 7073 3a2f 2f77 7777  eDB](https://www
-000005d0: 2e65 7665 6e74 7374 6f72 652e 636f 6d2f  .eventstore.com/
-000005e0: 292e 0a0a 5468 6973 2063 6c69 656e 7420  )...This client 
-000005f0: 6861 7320 6265 656e 2064 6576 656c 6f70  has been develop
-00000600: 6564 2069 6e20 636f 6c6c 6162 6f72 6174  ed in collaborat
-00000610: 696f 6e20 7769 7468 2074 6865 2045 7665  ion with the Eve
-00000620: 6e74 5374 6f72 6544 420a 7465 616d 2e20  ntStoreDB.team. 
-00000630: 416c 7468 6f75 6768 206e 6f74 2061 6c6c  Although not all
-00000640: 2074 6865 2066 6561 7475 7265 7320 6f66   the features of
-00000650: 2045 7665 6e74 5374 6f72 6544 4220 6172   EventStoreDB ar
-00000660: 6520 7375 7070 6f72 7465 640a 6279 2074  e supported.by t
-00000670: 6869 7320 636c 6965 6e74 2c20 6d61 6e79  his client, many
-00000680: 206f 6620 7468 6520 6d6f 7374 2075 7365   of the most use
-00000690: 6675 6c20 6f6e 6573 2061 7265 2070 7265  ful ones are pre
-000006a0: 7365 6e74 6564 0a69 6e20 616e 2065 6173  sented.in an eas
-000006b0: 792d 746f 2d75 7365 2069 6e74 6572 6661  y-to-use interfa
-000006c0: 6365 2e0a 0a54 6869 7320 636c 6965 6e74  ce...This client
-000006d0: 2068 6173 2062 6565 6e20 7465 7374 6564   has been tested
-000006e0: 2074 6f20 776f 726b 2077 6974 6820 4576   to work with Ev
-000006f0: 656e 7453 746f 7265 4442 204c 5453 2076  entStoreDB LTS v
-00000700: 6572 7369 6f6e 7320 3231 2e31 302c 0a77  ersions 21.10,.w
-00000710: 6974 686f 7574 2061 6e64 2077 6974 686f  ithout and witho
-00000720: 7574 2053 534c 2f54 4c53 2c20 616e 6420  ut SSL/TLS, and 
-00000730: 7769 7468 2050 7974 686f 6e20 7665 7273  with Python vers
-00000740: 696f 6e73 2033 2e37 2074 6f20 332e 3131  ions 3.7 to 3.11
-00000750: 2e20 5468 6572 650a 6973 2031 3030 2520  . There.is 100% 
-00000760: 7465 7374 2063 6f76 6572 6167 652e 2054  test coverage. T
-00000770: 6865 2063 6f64 6520 6861 7320 7479 7069  he code has typi
-00000780: 6e67 2061 6e6e 6f74 6174 696f 6e73 2c20  ng annotations, 
-00000790: 6368 6563 6b65 6420 7769 7468 206d 7970  checked with myp
-000007a0: 792e 0a54 6865 2063 6f64 6520 6973 2066  y..The code is f
-000007b0: 6f72 6d61 7474 6564 2077 6974 6820 626c  ormatted with bl
-000007c0: 6163 6b20 616e 6420 6973 6f72 742c 2061  ack and isort, a
-000007d0: 6e64 2063 6865 636b 6564 2077 6974 6820  nd checked with 
-000007e0: 666c 616b 6538 2e20 506f 6574 7279 0a69  flake8. Poetry.i
-000007f0: 7320 7573 6564 2066 6f72 2070 6163 6b61  s used for packa
-00000800: 6765 206d 616e 6167 656d 656e 7420 6475  ge management du
-00000810: 7269 6e67 2064 6576 656c 6f70 6d65 6e74  ring development
-00000820: 2c20 616e 6420 666f 7220 6275 696c 6469  , and for buildi
-00000830: 6e67 2061 6e64 0a70 7562 6c69 7368 696e  ng and.publishin
-00000840: 6720 6469 7374 7269 6275 7469 6f6e 7320  g distributions 
-00000850: 746f 205b 5079 5049 5d28 6874 7470 733a  to [PyPI](https:
-00000860: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
-00000870: 6374 2f65 7364 6263 6c69 656e 742f 292e  ct/esdbclient/).
-00000880: 0a0a 2323 2053 796e 6f70 7369 730a 0a54  ..## Synopsis..T
-00000890: 6865 2060 4553 4442 436c 6965 6e74 6020  he `ESDBClient` 
-000008a0: 636c 6173 7320 6361 6e20 6265 2069 6d70  class can be imp
-000008b0: 6f72 7465 6420 6672 6f6d 2074 6865 2060  orted from the `
-000008c0: 6573 6462 636c 6965 6e74 6020 7061 636b  esdbclient` pack
-000008d0: 6167 652e 0a0a 546f 2072 756e 2074 6865  age...To run the
-000008e0: 2063 6c69 656e 742c 2079 6f75 2077 696c   client, you wil
-000008f0: 6c20 6e65 6564 2061 2063 6f6e 6e65 6374  l need a connect
-00000900: 696f 6e20 7374 7269 6e67 2055 5249 2e20  ion string URI. 
-00000910: 416e 642c 2074 6f0a 636f 6e6e 6563 7420  And, to.connect 
-00000920: 746f 2061 2022 7365 6375 7265 2220 4576  to a "secure" Ev
-00000930: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00000940: 722c 2079 6f75 2077 696c 6c20 616c 736f  r, you will also
-00000950: 206e 6565 6420 616e 0a53 534c 2f54 4c53   need an.SSL/TLS
-00000960: 2063 6572 7469 6669 6361 7465 2e0a 0a50   certificate...P
-00000970: 726f 6261 626c 7920 7468 6520 7468 7265  robably the thre
-00000980: 6520 6d6f 7374 2075 7365 6675 6c20 6d65  e most useful me
-00000990: 7468 6f64 7320 6f66 2060 4553 4442 436c  thods of `ESDBCl
-000009a0: 6965 6e74 6020 6172 653a 0a0a 2a20 6061  ient` are:..* `a
-000009b0: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
-000009c0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-000009d0: 6265 2075 7365 6420 746f 2072 6563 6f72  be used to recor
-000009e0: 6420 6576 656e 7473 2069 6e20 6120 7061  d events in a pa
-000009f0: 7274 6963 756c 6172 0a22 7374 7265 616d  rticular."stream
-00000a00: 222e 2054 6869 7320 6973 2075 7365 6675  ". This is usefu
-00000a10: 6c20 666f 7220 6578 616d 706c 6520 7768  l for example wh
-00000a20: 656e 2065 7865 6375 7469 6e67 2061 2063  en executing a c
-00000a30: 6f6d 6d61 6e64 2069 6e20 616e 2061 7070  ommand in an app
-00000a40: 6c69 6361 7469 6f6e 0a74 6861 7420 6d75  lication.that mu
-00000a50: 7461 7465 7320 616e 2061 6767 7265 6761  tates an aggrega
-00000a60: 7465 2e20 5468 6973 206d 6574 686f 6420  te. This method 
-00000a70: 6973 2022 6174 6f6d 6963 2220 696e 2074  is "atomic" in t
-00000a80: 6861 7420 6569 7468 6572 2061 6c6c 206f  hat either all o
-00000a90: 7220 6e6f 6e65 206f 660a 7468 6520 6576  r none of.the ev
-00000aa0: 656e 7473 2077 696c 6c20 6265 2072 6563  ents will be rec
-00000ab0: 6f72 6465 642e 0a0a 2a20 6072 6561 645f  orded...* `read_
-00000ac0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-00000ad0: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
-00000ae0: 2062 6520 7573 6564 2074 6f20 7265 7472   be used to retr
-00000af0: 6965 7665 2061 6c6c 2074 6865 2072 6563  ieve all the rec
-00000b00: 6f72 6465 640a 6576 656e 7473 2069 6e20  orded.events in 
-00000b10: 6120 2273 7472 6561 6d22 2e20 5468 6973  a "stream". This
-00000b20: 2069 7320 7573 6566 756c 2066 6f72 2065   is useful for e
-00000b30: 7861 6d70 6c65 2077 6865 6e20 7265 636f  xample when reco
-00000b40: 6e73 7472 7563 7469 6e67 2061 6e20 6167  nstructing an ag
-00000b50: 6772 6567 6174 650a 6265 666f 7265 2065  gregate.before e
-00000b60: 7865 6375 7469 6e67 2061 2063 6f6d 6d61  xecuting a comma
-00000b70: 6e64 2069 6e20 616e 2061 7070 6c69 6361  nd in an applica
-00000b80: 7469 6f6e 2e0a 0a2a 2060 7375 6273 6372  tion...* `subscr
-00000b90: 6962 655f 616c 6c5f 6576 656e 7473 2829  ibe_all_events()
-00000ba0: 6020 5468 6973 206d 6574 686f 6420 6361  ` This method ca
-00000bb0: 6e20 6265 2075 7365 6420 746f 2072 6563  n be used to rec
-00000bc0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
-00000bd0: 640a 6576 656e 7473 2061 6372 6f73 7320  d.events across 
-00000be0: 616c 6c20 2273 7472 6561 6d73 222e 2054  all "streams". T
-00000bf0: 6869 7320 6973 2075 7365 6675 6c20 696e  his is useful in
-00000c00: 2064 6f77 6e73 7472 6561 6d20 6576 656e   downstream even
-00000c10: 742d 7072 6f63 6573 7369 6e67 0a63 6f6d  t-processing.com
-00000c20: 706f 6e65 6e74 732c 2061 6e64 2073 7570  ponents, and sup
-00000c30: 706f 7274 7320 7072 6f63 6573 7369 6e67  ports processing
-00000c40: 2065 7665 6e74 7320 7769 7468 2022 6578   events with "ex
-00000c50: 6163 746c 792d 6f6e 6365 2220 7365 6d61  actly-once" sema
-00000c60: 6e74 6963 7320 2873 6565 2062 656c 6f77  ntics (see below
-00000c70: 292e 0a0a 5468 6520 6578 616d 706c 6520  )...The example 
-00000c80: 6265 6c6f 7720 7573 6573 2061 6e20 2269  below uses an "i
-00000c90: 6e73 6563 7572 6522 2045 7665 6e74 5374  nsecure" EventSt
-00000ca0: 6f72 6544 4220 7365 7276 6572 2072 756e  oreDB server run
-00000cb0: 6e69 6e67 206c 6f63 616c 6c79 206f 6e20  ning locally on 
-00000cc0: 706f 7274 2032 3131 342e 0a0a 6060 6070  port 2114...```p
-00000cd0: 7974 686f 6e0a 696d 706f 7274 2065 7364  ython.import esd
-00000ce0: 6263 6c69 656e 742c 2075 7569 640a 0a0a  bclient, uuid...
-00000cf0: 2320 436f 6e73 7472 7563 7420 4553 4442  # Construct ESDB
-00000d00: 436c 6965 6e74 2077 6974 6820 616e 2045  Client with an E
-00000d10: 7665 6e74 5374 6f72 6544 4220 5552 492e  ventStoreDB URI.
-00000d20: 0a0a 636c 6965 6e74 203d 2065 7364 6263  ..client = esdbc
-00000d30: 6c69 656e 742e 4553 4442 436c 6965 6e74  lient.ESDBClient
-00000d40: 2875 7269 3d22 6573 6462 3a2f 2f6c 6f63  (uri="esdb://loc
-00000d50: 616c 686f 7374 3a32 3131 343f 546c 733d  alhost:2114?Tls=
-00000d60: 6661 6c73 6522 290a 0a0a 2320 4170 7065  false")...# Appe
-00000d70: 6e64 2065 7665 6e74 7320 746f 2061 206e  nd events to a n
-00000d80: 6577 2073 7472 6561 6d2e 0a0a 7374 7265  ew stream...stre
-00000d90: 616d 5f6e 616d 6520 3d20 7374 7228 7575  am_name = str(uu
-00000da0: 6964 2e75 7569 6434 2829 290a 0a65 7665  id.uuid4())..eve
-00000db0: 6e74 3120 3d20 6573 6462 636c 6965 6e74  nt1 = esdbclient
-00000dc0: 2e4e 6577 4576 656e 7428 7479 7065 3d27  .NewEvent(type='
-00000dd0: 4f72 6465 7243 7265 6174 6564 272c 2064  OrderCreated', d
-00000de0: 6174 613d 6227 6461 7461 3127 290a 0a63  ata=b'data1')..c
-00000df0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-00000e00: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-00000e10: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00000e20: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
-00000e30: 6f73 6974 696f 6e3d 4e6f 6e65 2c0a 2020  osition=None,.  
-00000e40: 2020 6576 656e 7473 3d5b 6576 656e 7431    events=[event1
-00000e50: 5d2c 0a29 0a0a 0a23 2041 7070 656e 6420  ],.)...# Append 
-00000e60: 6d6f 7265 2065 7665 6e74 7320 746f 2061  more events to a
-00000e70: 6e20 6578 6973 7469 6e67 2073 7472 6561  n existing strea
-00000e80: 6d2e 0a0a 6576 656e 7432 203d 2065 7364  m...event2 = esd
-00000e90: 6263 6c69 656e 742e 4e65 7745 7665 6e74  bclient.NewEvent
-00000ea0: 2874 7970 653d 274f 7264 6572 5570 6461  (type='OrderUpda
-00000eb0: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
-00000ec0: 6132 2729 0a65 7665 6e74 3320 3d20 6573  a2').event3 = es
-00000ed0: 6462 636c 6965 6e74 2e4e 6577 4576 656e  dbclient.NewEven
-00000ee0: 7428 7479 7065 3d27 4f72 6465 7244 656c  t(type='OrderDel
-00000ef0: 6574 6564 272c 2064 6174 613d 6227 6461  eted', data=b'da
-00000f00: 7461 3327 290a 0a63 6c69 656e 742e 6170  ta3')..client.ap
-00000f10: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
-00000f20: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00000f30: 6561 6d5f 6e61 6d65 2c0a 2020 2020 6578  eam_name,.    ex
-00000f40: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-00000f50: 302c 0a20 2020 2065 7665 6e74 733d 5b65  0,.    events=[e
-00000f60: 7665 6e74 322c 2065 7665 6e74 335d 2c0a  vent2, event3],.
-00000f70: 290a 0a0a 2320 5265 6164 2061 6c6c 2065  )...# Read all e
-00000f80: 7665 6e74 7320 7265 636f 7264 6564 2069  vents recorded i
-00000f90: 6e20 6120 7374 7265 616d 2e0a 0a72 6563  n a stream...rec
-00000fa0: 6f72 6465 6420 3d20 636c 6965 6e74 2e72  orded = client.r
-00000fb0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-00000fc0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-00000fd0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 0a29  me=stream_name.)
-00000fe0: 0a0a 6173 7365 7274 206c 656e 2872 6563  ..assert len(rec
-00000ff0: 6f72 6465 6429 203d 3d20 330a 6173 7365  orded) == 3.asse
-00001000: 7274 2072 6563 6f72 6465 645b 305d 2e64  rt recorded[0].d
-00001010: 6174 6120 3d3d 2065 7665 6e74 312e 6461  ata == event1.da
-00001020: 7461 0a61 7373 6572 7420 7265 636f 7264  ta.assert record
-00001030: 6564 5b31 5d2e 6461 7461 203d 3d20 6576  ed[1].data == ev
-00001040: 656e 7432 2e64 6174 610a 6173 7365 7274  ent2.data.assert
-00001050: 2072 6563 6f72 6465 645b 325d 2e64 6174   recorded[2].dat
-00001060: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-00001070: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
-00001080: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-00001090: 7431 2e74 7970 650a 6173 7365 7274 2072  t1.type.assert r
-000010a0: 6563 6f72 6465 645b 315d 2e74 7970 6520  ecorded[1].type 
-000010b0: 3d3d 2065 7665 6e74 322e 7479 7065 0a61  == event2.type.a
-000010c0: 7373 6572 7420 7265 636f 7264 6564 5b32  ssert recorded[2
-000010d0: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
-000010e0: 2e74 7970 650a 0a0a 2320 496e 2061 6e20  .type...# In an 
-000010f0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
-00001100: 2063 6f6d 706f 6e65 6e74 2c20 7573 6520   component, use 
-00001110: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
-00001120: 7363 7269 7074 696f 6e0a 2320 746f 2072  scription.# to r
-00001130: 6563 6569 7665 2061 6c6c 2065 7665 6e74  eceive all event
-00001140: 7320 6163 726f 7373 2061 6c6c 2073 7472  s across all str
-00001150: 6561 6d73 2c20 696e 636c 7564 696e 6720  eams, including 
-00001160: 6576 656e 7473 2074 6861 740a 2320 6861  events that.# ha
-00001170: 7665 206e 6f74 2079 6574 2062 6565 6e20  ve not yet been 
-00001180: 7265 636f 7264 6564 2c20 7374 6172 7469  recorded, starti
-00001190: 6e67 2066 726f 6d20 7468 6520 636f 6d70  ng from the comp
-000011a0: 6f6e 656e 7427 7320 6c61 7374 0a23 2073  onent's last.# s
-000011b0: 6176 6564 2022 636f 6d6d 6974 2070 6f73  aved "commit pos
-000011c0: 6974 696f 6e22 2e0a 0a6c 6173 745f 7361  ition"...last_sa
-000011d0: 7665 645f 636f 6d6d 6974 5f70 6f73 6974  ved_commit_posit
-000011e0: 696f 6e20 3d20 300a 0a73 7562 7363 7269  ion = 0..subscri
-000011f0: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
-00001200: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
-00001210: 6e74 7328 0a20 2020 2063 6f6d 6d69 745f  nts(.    commit_
-00001220: 706f 7369 7469 6f6e 3d6c 6173 745f 7361  position=last_sa
-00001230: 7665 645f 636f 6d6d 6974 5f70 6f73 6974  ved_commit_posit
-00001240: 696f 6e0a 290a 0a23 2054 6f20 696d 706c  ion.)..# To impl
-00001250: 656d 656e 7420 2265 7861 6374 6c79 2d6f  ement "exactly-o
-00001260: 6e63 6522 2073 656d 616e 7469 6373 2c20  nce" semantics, 
-00001270: 6974 6572 6174 6520 6f76 6572 2074 6865  iterate over the
-00001280: 0a23 2022 6361 7463 682d 7570 2220 7375  .# "catch-up" su
-00001290: 6273 6372 6970 7469 6f6e 2e20 5072 6f63  bscription. Proc
-000012a0: 6573 7320 6561 6368 2072 6563 6569 7665  ess each receive
-000012b0: 6420 6576 656e 742c 0a23 2069 6e20 7475  d event,.# in tu
-000012c0: 726e 2c20 7468 726f 7567 6820 616e 2065  rn, through an e
-000012d0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
-000012e0: 706f 6c69 6379 2e20 5361 7665 2074 6865  policy. Save the
-000012f0: 0a23 2076 616c 7565 206f 6620 7468 6520  .# value of the 
-00001300: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
-00001310: 6174 7472 6962 7574 6520 6f66 2074 6865  attribute of the
-00001320: 2070 726f 6365 7373 6564 0a23 2065 7665   processed.# eve
-00001330: 6e74 2077 6974 6820 6e65 7720 7374 6174  nt with new stat
-00001340: 6520 6765 6e65 7261 7465 6420 6279 2074  e generated by t
-00001350: 6865 2070 6f6c 6963 7920 696e 2074 6865  he policy in the
-00001360: 2073 616d 650a 2320 6174 6f6d 6963 2074   same.# atomic t
-00001370: 7261 6e73 6163 7469 6f6e 2e20 5573 6520  ransaction. Use 
-00001380: 7468 6520 6c61 7374 2073 6176 6564 2022  the last saved "
-00001390: 636f 6d6d 6974 2070 6f73 6974 696f 6e22  commit position"
-000013a0: 0a23 2077 6865 6e20 7265 7374 6172 7469  .# when restarti
-000013b0: 6e67 2074 6865 2022 6361 7463 682d 7570  ng the "catch-up
-000013c0: 2220 7375 6273 6372 6970 7469 6f6e 2e0a  " subscription..
-000013d0: 0a72 6563 6569 7665 6420 3d20 5b5d 0a66  .received = [].f
-000013e0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
-000013f0: 6372 6970 7469 6f6e 3a0a 2020 2020 7265  cription:.    re
-00001400: 6365 6976 6564 2e61 7070 656e 6428 6576  ceived.append(ev
-00001410: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-00001420: 742e 6964 203d 3d20 6576 656e 7433 2e69  t.id == event3.i
-00001430: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
-00001440: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
-00001450: 645b 2d33 5d2e 6461 7461 203d 3d20 6576  d[-3].data == ev
-00001460: 656e 7431 2e64 6174 610a 6173 7365 7274  ent1.data.assert
-00001470: 2072 6563 6569 7665 645b 2d32 5d2e 6461   received[-2].da
-00001480: 7461 203d 3d20 6576 656e 7432 2e64 6174  ta == event2.dat
-00001490: 610a 6173 7365 7274 2072 6563 6569 7665  a.assert receive
-000014a0: 645b 2d31 5d2e 6461 7461 203d 3d20 6576  d[-1].data == ev
-000014b0: 656e 7433 2e64 6174 610a 6173 7365 7274  ent3.data.assert
-000014c0: 2072 6563 6569 7665 645b 2d33 5d2e 7479   received[-3].ty
-000014d0: 7065 203d 3d20 6576 656e 7431 2e74 7970  pe == event1.typ
-000014e0: 650a 6173 7365 7274 2072 6563 6569 7665  e.assert receive
-000014f0: 645b 2d32 5d2e 7479 7065 203d 3d20 6576  d[-2].type == ev
-00001500: 656e 7432 2e74 7970 650a 6173 7365 7274  ent2.type.assert
-00001510: 2072 6563 6569 7665 645b 2d31 5d2e 7479   received[-1].ty
-00001520: 7065 203d 3d20 6576 656e 7433 2e74 7970  pe == event3.typ
-00001530: 650a 0a61 7373 6572 7420 7265 6365 6976  e..assert receiv
-00001540: 6564 5b2d 335d 2e63 6f6d 6d69 745f 706f  ed[-3].commit_po
-00001550: 7369 7469 6f6e 203e 2030 0a61 7373 6572  sition > 0.asser
-00001560: 7420 7265 6365 6976 6564 5b2d 325d 2e63  t received[-2].c
-00001570: 6f6d 6d69 745f 706f 7369 7469 6f6e 203e  ommit_position >
-00001580: 2072 6563 6569 7665 645b 2d33 5d2e 636f   received[-3].co
-00001590: 6d6d 6974 5f70 6f73 6974 696f 6e0a 6173  mmit_position.as
-000015a0: 7365 7274 2072 6563 6569 7665 645b 2d31  sert received[-1
-000015b0: 5d2e 636f 6d6d 6974 5f70 6f73 6974 696f  ].commit_positio
-000015c0: 6e20 3e20 7265 6365 6976 6564 5b2d 325d  n > received[-2]
-000015d0: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-000015e0: 0a0a 0a23 2043 6c6f 7365 2074 6865 2063  ...# Close the c
-000015f0: 6c69 656e 7420 6166 7465 7220 7573 652e  lient after use.
-00001600: 0a0a 636c 6965 6e74 2e63 6c6f 7365 2829  ..client.close()
-00001610: 0a60 6060 0a0a 5365 6520 6265 6c6f 7720  .```..See below 
-00001620: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-00001630: 2e0a 0a46 6f72 2061 6e20 6578 616d 706c  ...For an exampl
-00001640: 6520 6f66 2075 7361 6765 2c20 7365 6520  e of usage, see 
-00001650: 7468 6520 5b65 7665 6e74 736f 7572 6369  the [eventsourci
-00001660: 6e67 2d65 7665 6e74 7374 6f72 6564 625d  ng-eventstoredb]
-00001670: 280a 6874 7470 733a 2f2f 6769 7468 7562  (.https://github
-00001680: 2e63 6f6d 2f70 7965 7665 6e74 736f 7572  .com/pyeventsour
-00001690: 6369 6e67 2f65 7665 6e74 736f 7572 6369  cing/eventsourci
-000016a0: 6e67 2d65 7665 6e74 7374 6f72 6564 6229  ng-eventstoredb)
-000016b0: 2070 6163 6b61 6765 2e0a 0a23 2320 5461   package...## Ta
-000016c0: 626c 6520 6f66 2063 6f6e 7465 6e74 730a  ble of contents.
-000016d0: 0a3c 212d 2d20 544f 4320 2d2d 3e0a 2a20  .<!-- TOC -->.* 
-000016e0: 5b49 6e73 7461 6c6c 2070 6163 6b61 6765  [Install package
-000016f0: 5d28 2369 6e73 7461 6c6c 2d70 6163 6b61  ](#install-packa
-00001700: 6765 290a 2020 2a20 5b46 726f 6d20 5079  ge).  * [From Py
-00001710: 5049 5d28 2366 726f 6d2d 7079 7069 290a  PI](#from-pypi).
-00001720: 2020 2a20 5b57 6974 6820 506f 6574 7279    * [With Poetry
-00001730: 5d28 2377 6974 682d 706f 6574 7279 290a  ](#with-poetry).
-00001740: 2a20 5b45 7665 6e74 5374 6f72 6544 4220  * [EventStoreDB 
-00001750: 7365 7276 6572 5d28 2365 7665 6e74 7374  server](#eventst
-00001760: 6f72 6564 622d 7365 7276 6572 290a 2020  oredb-server).  
-00001770: 2a20 5b52 756e 2063 6f6e 7461 696e 6572  * [Run container
-00001780: 5d28 2372 756e 2d63 6f6e 7461 696e 6572  ](#run-container
-00001790: 290a 2020 2a20 5b53 746f 7020 636f 6e74  ).  * [Stop cont
-000017a0: 6169 6e65 725d 2823 7374 6f70 2d63 6f6e  ainer](#stop-con
-000017b0: 7461 696e 6572 290a 2a20 5b45 7665 6e74  tainer).* [Event
-000017c0: 5374 6f72 6544 4220 636c 6965 6e74 5d28  StoreDB client](
-000017d0: 2365 7665 6e74 7374 6f72 6564 622d 636c  #eventstoredb-cl
-000017e0: 6965 6e74 290a 2020 2a20 5b49 6d70 6f72  ient).  * [Impor
-000017f0: 7420 636c 6173 735d 2823 696d 706f 7274  t class](#import
-00001800: 2d63 6c61 7373 290a 2020 2a20 5b43 6f6e  -class).  * [Con
-00001810: 7374 7275 6374 2063 6c69 656e 745d 2823  struct client](#
-00001820: 636f 6e73 7472 7563 742d 636c 6965 6e74  construct-client
-00001830: 290a 2a20 5b53 7472 6561 6d73 5d28 2373  ).* [Streams](#s
-00001840: 7472 6561 6d73 290a 2020 2a20 5b41 7070  treams).  * [App
-00001850: 656e 6420 6576 656e 7473 5d28 2361 7070  end events](#app
-00001860: 656e 642d 6576 656e 7473 290a 2020 2a20  end-events).  * 
-00001870: 5b41 7070 656e 6420 6576 656e 745d 2823  [Append event](#
-00001880: 6170 7065 6e64 2d65 7665 6e74 290a 2020  append-event).  
-00001890: 2a20 5b49 6465 6d70 6f74 656e 7420 6170  * [Idempotent ap
-000018a0: 7065 6e64 206f 7065 7261 7469 6f6e 735d  pend operations]
-000018b0: 2823 6964 656d 706f 7465 6e74 2d61 7070  (#idempotent-app
-000018c0: 656e 642d 6f70 6572 6174 696f 6e73 290a  end-operations).
-000018d0: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
-000018e0: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
-000018f0: 7472 6561 6d2d 6576 656e 7473 290a 2020  tream-events).  
-00001900: 2a20 5b48 6f77 2074 6f20 696d 706c 656d  * [How to implem
-00001910: 656e 7420 736e 6170 7368 6f74 7469 6e67  ent snapshotting
-00001920: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
-00001930: 4442 5d28 2368 6f77 2d74 6f2d 696d 706c  DB](#how-to-impl
-00001940: 656d 656e 742d 736e 6170 7368 6f74 7469  ement-snapshotti
-00001950: 6e67 2d77 6974 682d 6576 656e 7473 746f  ng-with-eventsto
-00001960: 7265 6462 290a 2020 2a20 5b52 6561 6420  redb).  * [Read 
-00001970: 616c 6c20 6576 656e 7473 5d28 2372 6561  all events](#rea
-00001980: 642d 616c 6c2d 6576 656e 7473 290a 2020  d-all-events).  
-00001990: 2a20 5b47 6574 2063 7572 7265 6e74 2073  * [Get current s
-000019a0: 7472 6561 6d20 706f 7369 7469 6f6e 5d28  tream position](
-000019b0: 2367 6574 2d63 7572 7265 6e74 2d73 7472  #get-current-str
-000019c0: 6561 6d2d 706f 7369 7469 6f6e 290a 2020  eam-position).  
-000019d0: 2a20 5b47 6574 2063 7572 7265 6e74 2063  * [Get current c
-000019e0: 6f6d 6d69 7420 706f 7369 7469 6f6e 5d28  ommit position](
-000019f0: 2367 6574 2d63 7572 7265 6e74 2d63 6f6d  #get-current-com
-00001a00: 6d69 742d 706f 7369 7469 6f6e 290a 2020  mit-position).  
-00001a10: 2a20 5b47 6574 2073 7472 6561 6d20 6d65  * [Get stream me
-00001a20: 7461 6461 7461 5d28 2367 6574 2d73 7472  tadata](#get-str
-00001a30: 6561 6d2d 6d65 7461 6461 7461 290a 2020  eam-metadata).  
-00001a40: 2a20 5b53 6574 2073 7472 6561 6d20 6d65  * [Set stream me
-00001a50: 7461 6461 7461 5d28 2373 6574 2d73 7472  tadata](#set-str
+00000000: 2320 5079 7468 6f6e 2067 5250 4320 436c  # Python gRPC Cl
+00000010: 6965 6e74 2066 6f72 2045 7665 6e74 5374  ient for EventSt
+00000020: 6f72 6544 420a 0a54 6869 7320 5b50 7974  oreDB..This [Pyt
+00000030: 686f 6e20 7061 636b 6167 655d 2868 7474  hon package](htt
+00000040: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
+00000050: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
+00000060: 2f29 2070 726f 7669 6465 7320 6120 5079  /) provides a Py
+00000070: 7468 6f6e 0a67 5250 4320 636c 6965 6e74  thon.gRPC client
+00000080: 2066 6f72 205b 4576 656e 7453 746f 7265   for [EventStore
+00000090: 4442 5d28 6874 7470 733a 2f2f 7777 772e  DB](https://www.
+000000a0: 6576 656e 7473 746f 7265 2e63 6f6d 2f29  eventstore.com/)
+000000b0: 2e0a 0a54 6869 7320 636c 6965 6e74 2068  ...This client h
+000000c0: 6173 2062 6565 6e20 6465 7665 6c6f 7065  as been develope
+000000d0: 6420 696e 2063 6f6c 6c61 626f 7261 7469  d in collaborati
+000000e0: 6f6e 2077 6974 6820 7468 6520 4576 656e  on with the Even
+000000f0: 7453 746f 7265 4442 0a74 6561 6d2e 2041  tStoreDB.team. A
+00000100: 6c74 686f 7567 6820 6e6f 7420 616c 6c20  lthough not all 
+00000110: 7468 6520 6665 6174 7572 6573 206f 6620  the features of 
+00000120: 4576 656e 7453 746f 7265 4442 2061 7265  EventStoreDB are
+00000130: 2073 7570 706f 7274 6564 0a62 7920 7468   supported.by th
+00000140: 6973 2063 6c69 656e 742c 206d 616e 7920  is client, many 
+00000150: 6f66 2074 6865 206d 6f73 7420 7573 6566  of the most usef
+00000160: 756c 2066 6561 7475 7265 7320 6172 6520  ul features are 
+00000170: 7072 6573 656e 7465 640a 696e 2061 6e20  presented.in an 
+00000180: 6561 7379 2d74 6f2d 7573 6520 696e 7465  easy-to-use inte
+00000190: 7266 6163 652e 0a0a 5468 6973 2063 6c69  rface...This cli
+000001a0: 656e 7420 6861 7320 6265 656e 2074 6573  ent has been tes
+000001b0: 7465 6420 746f 2077 6f72 6b20 7769 7468  ted to work with
+000001c0: 2045 7665 6e74 5374 6f72 6544 4220 4c54   EventStoreDB LT
+000001d0: 5320 7665 7273 696f 6e73 2032 312e 3130  S versions 21.10
+000001e0: 2c0a 7769 7468 6f75 7420 616e 6420 7769  ,.without and wi
+000001f0: 7468 6f75 7420 5353 4c2f 544c 532c 2061  thout SSL/TLS, a
+00000200: 6e64 2077 6974 6820 5079 7468 6f6e 2076  nd with Python v
+00000210: 6572 7369 6f6e 7320 332e 3720 746f 2033  ersions 3.7 to 3
+00000220: 2e31 312e 2054 6865 7265 0a69 7320 3130  .11. There.is 10
+00000230: 3025 2074 6573 7420 636f 7665 7261 6765  0% test coverage
+00000240: 2e20 5468 6520 636f 6465 2068 6173 2074  . The code has t
+00000250: 7970 696e 6720 616e 6e6f 7461 7469 6f6e  yping annotation
+00000260: 732c 2063 6865 636b 6564 2077 6974 6820  s, checked with 
+00000270: 6d79 7079 2e0a 5468 6520 636f 6465 2069  mypy..The code i
+00000280: 7320 666f 726d 6174 7465 6420 7769 7468  s formatted with
+00000290: 2062 6c61 636b 2061 6e64 2069 736f 7274   black and isort
+000002a0: 2c20 616e 6420 6368 6563 6b65 6420 7769  , and checked wi
+000002b0: 7468 2066 6c61 6b65 382e 2050 6f65 7472  th flake8. Poetr
+000002c0: 790a 6973 2075 7365 6420 666f 7220 7061  y.is used for pa
+000002d0: 636b 6167 6520 6d61 6e61 6765 6d65 6e74  ckage management
+000002e0: 2064 7572 696e 6720 6465 7665 6c6f 706d   during developm
+000002f0: 656e 742c 2061 6e64 2066 6f72 2062 7569  ent, and for bui
+00000300: 6c64 696e 6720 616e 640a 7075 626c 6973  lding and.publis
+00000310: 6869 6e67 2064 6973 7472 6962 7574 696f  hing distributio
+00000320: 6e73 2074 6f20 5b50 7950 495d 2868 7474  ns to [PyPI](htt
+00000330: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
+00000340: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
+00000350: 2f29 2e0a 0a23 2320 5379 6e6f 7073 6973  /)...## Synopsis
+00000360: 0a0a 5468 6520 6045 5344 4243 6c69 656e  ..The `ESDBClien
+00000370: 7460 2063 6c61 7373 2063 616e 2062 6520  t` class can be 
+00000380: 696d 706f 7274 6564 2066 726f 6d20 7468  imported from th
+00000390: 6520 6065 7364 6263 6c69 656e 7460 2070  e `esdbclient` p
+000003a0: 6163 6b61 6765 2e0a 0a50 726f 6261 626c  ackage...Probabl
+000003b0: 7920 7468 6520 7468 7265 6520 6d6f 7374  y the three most
+000003c0: 2075 7365 6675 6c20 6d65 7468 6f64 7320   useful methods 
+000003d0: 6f66 2060 4553 4442 436c 6965 6e74 6020  of `ESDBClient` 
+000003e0: 6172 653a 0a0a 2a20 6061 7070 656e 645f  are:..* `append_
+000003f0: 6576 656e 7473 2829 6020 5468 6973 206d  events()` This m
+00000400: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00000410: 6420 746f 2072 6563 6f72 6420 6576 656e  d to record even
+00000420: 7473 2069 6e20 6120 7061 7274 6963 756c  ts in a particul
+00000430: 6172 0a22 7374 7265 616d 222e 2054 6869  ar."stream". Thi
+00000440: 7320 6973 2075 7365 6675 6c20 666f 7220  s is useful for 
+00000450: 6578 616d 706c 6520 7768 656e 2065 7865  example when exe
+00000460: 6375 7469 6e67 2061 2063 6f6d 6d61 6e64  cuting a command
+00000470: 2069 6e20 616e 2061 7070 6c69 6361 7469   in an applicati
+00000480: 6f6e 0a74 6861 7420 6d75 7461 7465 7320  on.that mutates 
+00000490: 616e 2061 6767 7265 6761 7465 2e20 5468  an aggregate. Th
+000004a0: 6973 206d 6574 686f 6420 6973 2022 6174  is method is "at
+000004b0: 6f6d 6963 2220 696e 2074 6861 7420 6569  omic" in that ei
+000004c0: 7468 6572 2061 6c6c 206f 7220 6e6f 6e65  ther all or none
+000004d0: 206f 660a 7468 6520 6576 656e 7473 2077   of.the events w
+000004e0: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
+000004f0: 0a0a 2a20 6072 6561 645f 7374 7265 616d  ..* `read_stream
+00000500: 5f65 7665 6e74 7328 2960 2054 6869 7320  _events()` This 
+00000510: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00000520: 6564 2074 6f20 7265 7472 6965 7665 2061  ed to retrieve a
+00000530: 6c6c 2074 6865 2072 6563 6f72 6465 640a  ll the recorded.
+00000540: 6576 656e 7473 2069 6e20 6120 2273 7472  events in a "str
+00000550: 6561 6d22 2e20 5468 6973 2069 7320 7573  eam". This is us
+00000560: 6566 756c 2066 6f72 2065 7861 6d70 6c65  eful for example
+00000570: 2077 6865 6e20 7265 636f 6e73 7472 7563   when reconstruc
+00000580: 7469 6e67 2061 6e20 6167 6772 6567 6174  ting an aggregat
+00000590: 650a 6265 666f 7265 2065 7865 6375 7469  e.before executi
+000005a0: 6e67 2061 2063 6f6d 6d61 6e64 2069 6e20  ng a command in 
+000005b0: 616e 2061 7070 6c69 6361 7469 6f6e 2e0a  an application..
+000005c0: 0a2a 2060 7375 6273 6372 6962 655f 616c  .* `subscribe_al
+000005d0: 6c5f 6576 656e 7473 2829 6020 5468 6973  l_events()` This
+000005e0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+000005f0: 7365 6420 746f 2072 6563 6569 7665 2061  sed to receive a
+00000600: 6c6c 2072 6563 6f72 6465 640a 6576 656e  ll recorded.even
+00000610: 7473 2061 6372 6f73 7320 616c 6c20 2273  ts across all "s
+00000620: 7472 6561 6d73 222e 2054 6869 7320 6973  treams". This is
+00000630: 2075 7365 6675 6c20 696e 2064 6f77 6e73   useful in downs
+00000640: 7472 6561 6d20 6576 656e 742d 7072 6f63  tream event-proc
+00000650: 6573 7369 6e67 0a63 6f6d 706f 6e65 6e74  essing.component
+00000660: 732c 2061 6e64 2073 7570 706f 7274 7320  s, and supports 
+00000670: 7072 6f63 6573 7369 6e67 2065 7665 6e74  processing event
+00000680: 7320 7769 7468 2022 6578 6163 746c 792d  s with "exactly-
+00000690: 6f6e 6365 2220 7365 6d61 6e74 6963 7320  once" semantics 
+000006a0: 2873 6565 2062 656c 6f77 292e 0a0a 5468  (see below)...Th
+000006b0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+000006c0: 7573 6573 2061 6e20 2269 6e73 6563 7572  uses an "insecur
+000006d0: 6522 2045 7665 6e74 5374 6f72 6544 4220  e" EventStoreDB 
+000006e0: 7365 7276 6572 2072 756e 6e69 6e67 206c  server running l
+000006f0: 6f63 616c 6c79 206f 6e20 706f 7274 2032  ocally on port 2
+00000700: 3131 342e 0a0a 6060 6070 7974 686f 6e0a  114...```python.
+00000710: 696d 706f 7274 2075 7569 640a 0a66 726f  import uuid..fro
+00000720: 6d20 6573 6462 636c 6965 6e74 2069 6d70  m esdbclient imp
+00000730: 6f72 7420 4553 4442 436c 6965 6e74 2c20  ort ESDBClient, 
+00000740: 4e65 7745 7665 6e74 0a0a 0a23 2043 6f6e  NewEvent...# Con
+00000750: 7374 7275 6374 2045 5344 4243 6c69 656e  struct ESDBClien
+00000760: 7420 7769 7468 2061 6e20 4576 656e 7453  t with an EventS
+00000770: 746f 7265 4442 2055 5249 2e0a 0a63 6c69  toreDB URI...cli
+00000780: 656e 7420 3d20 4553 4442 436c 6965 6e74  ent = ESDBClient
+00000790: 280a 2020 2020 7572 693d 2265 7364 623a  (.    uri="esdb:
+000007a0: 2f2f 6c6f 6361 6c68 6f73 743a 3231 3134  //localhost:2114
+000007b0: 3f54 6c73 3d66 616c 7365 220a 290a 0a0a  ?Tls=false".)...
+000007c0: 2320 4765 6e65 7261 7465 206e 6577 2065  # Generate new e
+000007d0: 7665 6e74 732e 2054 7970 6963 616c 6c79  vents. Typically
+000007e0: 2c20 646f 6d61 696e 2065 7665 6e74 7320  , domain events 
+000007f0: 6f66 2064 6966 6665 7265 6e74 0a23 2074  of different.# t
+00000800: 7970 6573 2061 7265 2067 656e 6572 6174  ypes are generat
+00000810: 6564 2069 6e20 6120 646f 6d61 696e 206d  ed in a domain m
+00000820: 6f64 656c 2c20 616e 6420 7468 656e 2073  odel, and then s
+00000830: 6572 6961 6c69 7a65 640a 2320 696e 746f  erialized.# into
+00000840: 204e 6577 4576 656e 7420 6f62 6a65 6374   NewEvent object
+00000850: 732e 2041 6e20 6167 6772 6567 6174 6520  s. An aggregate 
+00000860: 4944 206d 6179 2062 6520 7573 6564 2061  ID may be used a
+00000870: 7320 7468 650a 2320 6e61 6d65 206f 6620  s the.# name of 
+00000880: 6120 7374 7265 616d 2069 6e20 4576 656e  a stream in Even
+00000890: 7453 746f 7265 4442 2e0a 0a73 7472 6561  tStoreDB...strea
+000008a0: 6d5f 6e61 6d65 3120 3d20 7374 7228 7575  m_name1 = str(uu
+000008b0: 6964 2e75 7569 6434 2829 290a 6576 656e  id.uuid4()).even
+000008c0: 7431 203d 204e 6577 4576 656e 7428 0a20  t1 = NewEvent(. 
+000008d0: 2020 2074 7970 653d 274f 7264 6572 4372     type='OrderCr
+000008e0: 6561 7465 6427 2c0a 2020 2020 6461 7461  eated',.    data
+000008f0: 3d62 277b 226f 7264 6572 5f6e 756d 6265  =b'{"order_numbe
+00000900: 7222 3a20 2231 3233 3435 3622 7d27 0a29  r": "123456"}'.)
+00000910: 0a65 7665 6e74 3220 3d20 4e65 7745 7665  .event2 = NewEve
+00000920: 6e74 280a 2020 2020 7479 7065 3d27 4f72  nt(.    type='Or
+00000930: 6465 7253 7562 6d69 7474 6564 272c 0a20  derSubmitted',. 
+00000940: 2020 2064 6174 613d 6227 7b7d 270a 290a     data=b'{}'.).
+00000950: 0a0a 2320 4170 7065 6e64 206e 6577 2065  ..# Append new e
+00000960: 7665 6e74 7320 746f 2061 2073 7472 6561  vents to a strea
+00000970: 6d2e 2054 6865 2073 7472 6561 6d20 646f  m. The stream do
+00000980: 6573 206e 6f74 2065 7869 7374 2073 6f0a  es not exist so.
+00000990: 2320 7468 6520 2263 7572 7265 6e74 2076  # the "current v
+000009a0: 6572 7369 6f6e 2220 6973 204e 6f6e 652e  ersion" is None.
+000009b0: 2054 6865 2076 616c 7565 2072 6574 7572   The value retur
+000009c0: 6e65 6420 6672 6f6d 2074 6865 0a23 2061  ned from the.# a
+000009d0: 7070 656e 645f 6576 656e 7473 2829 206d  ppend_events() m
+000009e0: 6574 686f 6420 6973 2074 6865 206f 7665  ethod is the ove
+000009f0: 7261 6c6c 2070 6f73 6974 696f 6e20 696e  rall position in
+00000a00: 2074 6865 2064 6174 6162 6173 650a 2320   the database.# 
+00000a10: 6f66 2074 6865 206c 6173 7420 6e65 7720  of the last new 
+00000a20: 6576 656e 7420 7265 636f 7264 6564 2062  event recorded b
+00000a30: 7920 7468 6973 206f 7065 7261 7469 6f6e  y this operation
+00000a40: 2e20 5468 6520 7265 7475 726e 6564 0a23  . The returned.#
+00000a50: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00000a60: 6e22 2076 616c 7565 206d 6179 2062 6520  n" value may be 
+00000a70: 7573 6564 2069 6e20 6120 7573 6572 2069  used in a user i
+00000a80: 6e74 6572 6661 6365 2074 6f20 706f 6c6c  nterface to poll
+00000a90: 0a23 2061 2064 6f77 6e73 7472 6561 6d20  .# a downstream 
+00000aa0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00000ab0: 2063 6f6d 706f 6e65 6e74 2062 6566 6f72   component befor
+00000ac0: 6520 6974 2070 7265 7365 6e74 7320 616e  e it presents an
+00000ad0: 0a23 2075 702d 746f 2d64 6174 6520 6576  .# up-to-date ev
+00000ae0: 656e 7475 616c 6c79 2063 6f6e 7369 7374  entually consist
+00000af0: 656e 7420 6d61 7465 7269 616c 697a 6564  ent materialized
+00000b00: 2076 6965 772e 0a0a 636f 6d6d 6974 5f70   view...commit_p
+00000b10: 6f73 6974 696f 6e31 203d 2063 6c69 656e  osition1 = clien
+00000b20: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+00000b30: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00000b40: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
+00000b50: 2020 2063 7572 7265 6e74 5f76 6572 7369     current_versi
+00000b60: 6f6e 3d4e 6f6e 652c 0a20 2020 2065 7665  on=None,.    eve
+00000b70: 6e74 733d 5b65 7665 6e74 312c 2065 7665  nts=[event1, eve
+00000b80: 6e74 325d 2c0a 290a 0a23 2054 6865 2022  nt2],.)..# The "
+00000b90: 6375 7272 656e 7420 7665 7273 696f 6e22  current version"
+00000ba0: 2069 7320 7468 6520 2273 7472 6561 6d20   is the "stream 
+00000bb0: 706f 7369 7469 6f6e 2220 6f66 2074 6865  position" of the
+00000bc0: 206c 6173 740a 2320 7265 636f 7264 6564   last.# recorded
+00000bd0: 2065 7665 6e74 2069 6e20 6120 7374 7265   event in a stre
+00000be0: 616d 2e20 5374 7265 616d 2070 6f73 6974  am. Stream posit
+00000bf0: 696f 6e73 2061 7265 207a 6572 6f2d 6261  ions are zero-ba
+00000c00: 7365 642e 0a23 2057 6520 6861 7665 2072  sed..# We have r
+00000c10: 6563 6f72 6465 6420 7477 6f20 6e65 7720  ecorded two new 
+00000c20: 6576 656e 7473 2c20 616e 6420 736f 2074  events, and so t
+00000c30: 6865 2022 6375 7272 656e 7420 7665 7273  he "current vers
+00000c40: 696f 6e22 0a23 206f 6620 7468 6973 2073  ion".# of this s
+00000c50: 7472 6561 6d20 6973 2031 2e20 436f 6e63  tream is 1. Conc
+00000c60: 7572 7265 6e63 7920 6973 2063 6f6e 7472  urrency is contr
+00000c70: 6f6c 6c65 6420 696e 2074 6869 7320 7761  olled in this wa
+00000c80: 790a 2320 746f 2065 6e73 7572 6520 7468  y.# to ensure th
+00000c90: 6520 636f 6e73 6973 7465 6e63 7920 6f66  e consistency of
+00000ca0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00000cb0: 2e20 416e 2069 6e63 6f72 7265 6374 0a23  . An incorrect.#
+00000cc0: 2076 616c 7565 2077 696c 6c20 6361 7573   value will caus
+00000cd0: 6520 6120 5772 6f6e 6743 7572 7265 6e74  e a WrongCurrent
+00000ce0: 5665 7273 696f 6e20 6578 6365 7074 696f  Version exceptio
+00000cf0: 6e20 746f 2062 6520 7261 6973 6564 2e0a  n to be raised..
+00000d00: 0a65 7665 6e74 3320 3d20 4e65 7745 7665  .event3 = NewEve
+00000d10: 6e74 280a 2020 2020 7479 7065 3d27 4f72  nt(.    type='Or
+00000d20: 6465 7243 616e 6365 6c6c 6564 272c 0a20  derCancelled',. 
+00000d30: 2020 2064 6174 613d 6227 7b7d 270a 290a     data=b'{}'.).
+00000d40: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+00000d50: 3220 3d20 636c 6965 6e74 2e61 7070 656e  2 = client.appen
+00000d60: 645f 6576 656e 7473 280a 2020 2020 7374  d_events(.    st
+00000d70: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+00000d80: 5f6e 616d 6531 2c0a 2020 2020 6375 7272  _name1,.    curr
+00000d90: 656e 745f 7665 7273 696f 6e3d 312c 0a20  ent_version=1,. 
+00000da0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+00000db0: 335d 2c0a 290a 0a0a 2320 5265 6164 2065  3],.)...# Read e
+00000dc0: 7665 6e74 7320 6672 6f6d 2061 2073 7472  vents from a str
+00000dd0: 6561 6d2e 2054 6865 2072 6563 6f72 6465  eam. The recorde
+00000de0: 6420 6576 656e 7473 206d 6179 2062 650a  d events may be.
+00000df0: 2320 6465 7365 7269 616c 697a 6564 2074  # deserialized t
+00000e00: 6f20 646f 6d61 696e 2065 7665 6e74 7320  o domain events 
+00000e10: 6f62 6a65 6374 7320 6f66 2064 6966 6665  objects of diffe
+00000e20: 7265 6e74 2074 7970 6573 2c0a 2320 7468  rent types,.# th
+00000e30: 656e 2075 7365 6420 746f 2072 6563 6f6e  en used to recon
+00000e40: 7374 7275 6374 2061 6e20 6167 6772 6567  struct an aggreg
+00000e50: 6174 6520 696e 2061 2064 6f6d 6169 6e20  ate in a domain 
+00000e60: 6d6f 6465 6c2e 0a0a 7265 636f 7264 6564  model...recorded
+00000e70: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+00000e80: 7472 6561 6d5f 6576 656e 7473 280a 2020  tream_events(.  
+00000e90: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00000ea0: 7265 616d 5f6e 616d 6531 0a29 0a0a 6173  ream_name1.)..as
+00000eb0: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
+00000ec0: 6429 203d 3d20 330a 0a61 7373 6572 7420  d) == 3..assert 
+00000ed0: 7265 636f 7264 6564 5b30 5d2e 7374 7265  recorded[0].stre
+00000ee0: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+00000ef0: 6d5f 6e61 6d65 310a 6173 7365 7274 2072  m_name1.assert r
+00000f00: 6563 6f72 6465 645b 315d 2e73 7472 6561  ecorded[1].strea
+00000f10: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+00000f20: 5f6e 616d 6531 0a61 7373 6572 7420 7265  _name1.assert re
+00000f30: 636f 7264 6564 5b32 5d2e 7374 7265 616d  corded[2].stream
+00000f40: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+00000f50: 6e61 6d65 310a 0a61 7373 6572 7420 7265  name1..assert re
+00000f60: 636f 7264 6564 5b30 5d2e 7374 7265 616d  corded[0].stream
+00000f70: 5f70 6f73 6974 696f 6e20 3d3d 2030 0a61  _position == 0.a
+00000f80: 7373 6572 7420 7265 636f 7264 6564 5b31  ssert recorded[1
+00000f90: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+00000fa0: 6e20 3d3d 2031 0a61 7373 6572 7420 7265  n == 1.assert re
+00000fb0: 636f 7264 6564 5b32 5d2e 7374 7265 616d  corded[2].stream
+00000fc0: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a0a  _position == 2..
+00000fd0: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
+00000fe0: 305d 2e74 7970 6520 3d3d 2022 4f72 6465  0].type == "Orde
+00000ff0: 7243 7265 6174 6564 220a 6173 7365 7274  rCreated".assert
+00001000: 2072 6563 6f72 6465 645b 315d 2e74 7970   recorded[1].typ
+00001010: 6520 3d3d 2022 4f72 6465 7253 7562 6d69  e == "OrderSubmi
+00001020: 7474 6564 220a 6173 7365 7274 2072 6563  tted".assert rec
+00001030: 6f72 6465 645b 325d 2e74 7970 6520 3d3d  orded[2].type ==
+00001040: 2022 4f72 6465 7243 616e 6365 6c6c 6564   "OrderCancelled
+00001050: 220a 0a61 7373 6572 7420 7265 636f 7264  "..assert record
+00001060: 6564 5b30 5d2e 6461 7461 203d 3d20 6227  ed[0].data == b'
+00001070: 7b22 6f72 6465 725f 6e75 6d62 6572 223a  {"order_number":
+00001080: 2022 3132 3334 3536 227d 270a 0a0a 2320   "123456"}'...# 
+00001090: 5374 6172 7420 6120 6361 7463 682d 7570  Start a catch-up
+000010a0: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
+000010b0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+000010c0: 6f72 6465 640a 2320 6576 656e 7473 2061  orded.# events a
+000010d0: 6372 6f73 7320 616c 6c20 7374 7265 616d  cross all stream
+000010e0: 732e 2041 2063 6174 6368 2d75 7020 7375  s. A catch-up su
+000010f0: 6273 6372 6970 7469 6f6e 206d 6179 0a23  bscription may.#
+00001100: 2062 6520 7573 6564 2069 6e20 6120 646f   be used in a do
+00001110: 776e 7374 7265 616d 2065 7665 6e74 2d70  wnstream event-p
+00001120: 726f 6365 7373 696e 6720 636f 6d70 6f6e  rocessing compon
+00001130: 656e 7420 746f 0a23 2072 6563 6569 7665  ent to.# receive
+00001140: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00001150: 2066 726f 6d20 6120 7061 7274 6963 756c   from a particul
+00001160: 6172 2063 6f6d 6d69 7420 706f 7369 7469  ar commit positi
+00001170: 6f6e 2e0a 2320 5468 6520 6669 7273 7420  on..# The first 
+00001180: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+00001190: 2220 696e 2061 6e20 4576 656e 7453 746f  " in an EventSto
+000011a0: 7265 4442 2064 6174 6162 6173 6520 6973  reDB database is
+000011b0: 2030 2e0a 0a6c 6173 745f 7361 7665 645f   0...last_saved_
+000011c0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+000011d0: 3d20 300a 0a63 6174 6368 5f73 7562 7363  = 0..catch_subsc
+000011e0: 7269 7074 696f 6e20 3d20 636c 6965 6e74  ription = client
+000011f0: 2e73 7562 7363 7269 6265 5f61 6c6c 5f65  .subscribe_all_e
+00001200: 7665 6e74 7328 0a20 2020 2063 6f6d 6d69  vents(.    commi
+00001210: 745f 706f 7369 7469 6f6e 3d6c 6173 745f  t_position=last_
+00001220: 7361 7665 645f 636f 6d6d 6974 5f70 6f73  saved_commit_pos
+00001230: 6974 696f 6e0a 290a 0a0a 2320 4974 6572  ition.)...# Iter
+00001240: 6174 6520 6f76 6572 2074 6865 2063 6174  ate over the cat
+00001250: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00001260: 6f6e 2e20 5072 6f63 6573 7320 6561 6368  on. Process each
+00001270: 0a23 2072 6563 6f72 6465 6420 6576 656e  .# recorded even
+00001280: 7420 696e 2074 7572 6e2e 2049 6e20 616e  t in turn. In an
+00001290: 2061 746f 6d69 6320 6461 7461 6261 7365   atomic database
+000012a0: 2074 7261 6e73 6163 7469 6f6e 0a23 2073   transaction.# s
+000012b0: 6176 6520 7468 6520 6576 656e 7427 7320  ave the event's 
+000012c0: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+000012d0: 2220 7769 7468 2061 6e79 206e 6577 2073  " with any new s
+000012e0: 7461 7465 0a23 2067 656e 6572 6174 6564  tate.# generated
+000012f0: 2062 7920 7072 6f63 6573 7369 6e67 2074   by processing t
+00001300: 6865 2065 7665 6e74 2e20 5573 6520 7468  he event. Use th
+00001310: 6520 636f 6d70 6f6e 656e 7427 730a 2320  e component's.# 
+00001320: 6c61 7374 2073 6176 6564 2022 636f 6d6d  last saved "comm
+00001330: 6974 2070 6f73 6974 696f 6e22 2077 6865  it position" whe
+00001340: 6e20 7265 7374 6172 7469 6e67 2074 6865  n restarting the
+00001350: 2073 7562 7363 7269 7074 696f 6e2e 0a0a   subscription...
+00001360: 0a72 6563 6569 7665 6420 3d20 5b5d 0a66  .received = [].f
+00001370: 6f72 2065 7665 6e74 2069 6e20 6361 7463  or event in catc
+00001380: 685f 7375 6273 6372 6970 7469 6f6e 3a0a  h_subscription:.
+00001390: 2020 2020 6c61 7374 5f73 6176 6564 5f63      last_saved_c
+000013a0: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
+000013b0: 2065 7665 6e74 2e63 6f6d 6d69 745f 706f   event.commit_po
+000013c0: 7369 7469 6f6e 0a20 2020 2072 6563 6569  sition.    recei
+000013d0: 7665 642e 6170 7065 6e64 2865 7665 6e74  ved.append(event
+000013e0: 290a 0a20 2020 2069 6620 6c61 7374 5f73  )..    if last_s
+000013f0: 6176 6564 5f63 6f6d 6d69 745f 706f 7369  aved_commit_posi
+00001400: 7469 6f6e 203d 3d20 636f 6d6d 6974 5f70  tion == commit_p
+00001410: 6f73 6974 696f 6e32 3a0a 2020 2020 2020  osition2:.      
+00001420: 2020 2320 5374 6f70 2073 6f20 7765 2063    # Stop so we c
+00001430: 616e 2063 6f6e 7469 6e75 6520 7769 7468  an continue with
+00001440: 2074 6865 2065 7861 6d70 6c65 2e0a 2020   the example..  
+00001450: 2020 2020 2020 6361 7463 685f 7375 6273        catch_subs
+00001460: 6372 6970 7469 6f6e 2e73 746f 7028 290a  cription.stop().
+00001470: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
+00001480: 645b 2d33 5d2e 7479 7065 203d 3d20 224f  d[-3].type == "O
+00001490: 7264 6572 4372 6561 7465 6422 0a61 7373  rderCreated".ass
+000014a0: 6572 7420 7265 6365 6976 6564 5b2d 325d  ert received[-2]
+000014b0: 2e74 7970 6520 3d3d 2022 4f72 6465 7253  .type == "OrderS
+000014c0: 7562 6d69 7474 6564 220a 6173 7365 7274  ubmitted".assert
+000014d0: 2072 6563 6569 7665 645b 2d31 5d2e 7479   received[-1].ty
+000014e0: 7065 203d 3d20 224f 7264 6572 4361 6e63  pe == "OrderCanc
+000014f0: 656c 6c65 6422 0a0a 0a23 2043 6c6f 7365  elled"...# Close
+00001500: 2074 6865 2063 6c69 656e 7420 6166 7465   the client afte
+00001510: 7220 7573 652e 0a0a 636c 6965 6e74 2e63  r use...client.c
+00001520: 6c6f 7365 2829 0a60 6060 0a0a 5365 6520  lose().```..See 
+00001530: 6265 6c6f 7720 666f 7220 6d6f 7265 2064  below for more d
+00001540: 6574 6169 6c73 2e0a 0a46 6f72 2061 6e20  etails...For an 
+00001550: 6578 616d 706c 6520 6f66 2075 7361 6765  example of usage
+00001560: 2c20 7365 6520 7468 6520 5b65 7665 6e74  , see the [event
+00001570: 736f 7572 6369 6e67 2d65 7665 6e74 7374  sourcing-eventst
+00001580: 6f72 6564 625d 280a 6874 7470 733a 2f2f  oredb](.https://
+00001590: 6769 7468 7562 2e63 6f6d 2f70 7965 7665  github.com/pyeve
+000015a0: 6e74 736f 7572 6369 6e67 2f65 7665 6e74  ntsourcing/event
+000015b0: 736f 7572 6369 6e67 2d65 7665 6e74 7374  sourcing-eventst
+000015c0: 6f72 6564 6229 2070 6163 6b61 6765 2e0a  oredb) package..
+000015d0: 0a23 2320 5461 626c 6520 6f66 2063 6f6e  .## Table of con
+000015e0: 7465 6e74 730a 0a3c 212d 2d20 544f 4320  tents..<!-- TOC 
+000015f0: 2d2d 3e0a 2a20 5b49 6e73 7461 6c6c 2070  -->.* [Install p
+00001600: 6163 6b61 6765 5d28 2369 6e73 7461 6c6c  ackage](#install
+00001610: 2d70 6163 6b61 6765 290a 2020 2a20 5b46  -package).  * [F
+00001620: 726f 6d20 5079 5049 5d28 2366 726f 6d2d  rom PyPI](#from-
+00001630: 7079 7069 290a 2020 2a20 5b57 6974 6820  pypi).  * [With 
+00001640: 506f 6574 7279 5d28 2377 6974 682d 706f  Poetry](#with-po
+00001650: 6574 7279 290a 2a20 5b45 7665 6e74 5374  etry).* [EventSt
+00001660: 6f72 6544 4220 7365 7276 6572 5d28 2365  oreDB server](#e
+00001670: 7665 6e74 7374 6f72 6564 622d 7365 7276  ventstoredb-serv
+00001680: 6572 290a 2020 2a20 5b52 756e 2063 6f6e  er).  * [Run con
+00001690: 7461 696e 6572 5d28 2372 756e 2d63 6f6e  tainer](#run-con
+000016a0: 7461 696e 6572 290a 2020 2a20 5b53 746f  tainer).  * [Sto
+000016b0: 7020 636f 6e74 6169 6e65 725d 2823 7374  p container](#st
+000016c0: 6f70 2d63 6f6e 7461 696e 6572 290a 2a20  op-container).* 
+000016d0: 5b45 7665 6e74 5374 6f72 6544 4220 636c  [EventStoreDB cl
+000016e0: 6965 6e74 5d28 2365 7665 6e74 7374 6f72  ient](#eventstor
+000016f0: 6564 622d 636c 6965 6e74 290a 2020 2a20  edb-client).  * 
+00001700: 5b49 6d70 6f72 7420 636c 6173 735d 2823  [Import class](#
+00001710: 696d 706f 7274 2d63 6c61 7373 290a 2020  import-class).  
+00001720: 2a20 5b43 6f6e 7374 7275 6374 2063 6c69  * [Construct cli
+00001730: 656e 745d 2823 636f 6e73 7472 7563 742d  ent](#construct-
+00001740: 636c 6965 6e74 290a 2a20 5b43 6f6e 6e65  client).* [Conne
+00001750: 6374 696f 6e20 7374 7269 6e67 735d 2823  ction strings](#
+00001760: 636f 6e6e 6563 7469 6f6e 2d73 7472 696e  connection-strin
+00001770: 6773 290a 2020 2a20 5b54 776f 2073 6368  gs).  * [Two sch
+00001780: 656d 6573 5d28 2374 776f 2d73 6368 656d  emes](#two-schem
+00001790: 6573 290a 2020 2a20 5b55 7365 7220 696e  es).  * [User in
+000017a0: 666f 2073 7472 696e 675d 2823 7573 6572  fo string](#user
+000017b0: 2d69 6e66 6f2d 7374 7269 6e67 290a 2020  -info-string).  
+000017c0: 2a20 5b51 7565 7279 2073 7472 696e 675d  * [Query string]
+000017d0: 2823 7175 6572 792d 7374 7269 6e67 290a  (#query-string).
+000017e0: 2020 2a20 5b45 7861 6d70 6c65 735d 2823    * [Examples](#
+000017f0: 6578 616d 706c 6573 290a 2a20 5b45 7665  examples).* [Eve
+00001800: 6e74 206f 626a 6563 7473 5d28 2365 7665  nt objects](#eve
+00001810: 6e74 2d6f 626a 6563 7473 290a 2020 2a20  nt-objects).  * 
+00001820: 5b54 6865 204e 6577 4576 656e 7420 636c  [The NewEvent cl
+00001830: 6173 735d 2823 7468 652d 6e65 7765 7665  ass](#the-neweve
+00001840: 6e74 2d63 6c61 7373 290a 2020 2a20 5b54  nt-class).  * [T
+00001850: 6865 2052 6563 6f72 6465 6445 7665 6e74  he RecordedEvent
+00001860: 2063 6c61 7373 5d28 2374 6865 2d72 6563   class](#the-rec
+00001870: 6f72 6465 6465 7665 6e74 2d63 6c61 7373  ordedevent-class
+00001880: 290a 2a20 5b53 7472 6561 6d73 5d28 2373  ).* [Streams](#s
+00001890: 7472 6561 6d73 290a 2020 2a20 5b41 7070  treams).  * [App
+000018a0: 656e 6420 6576 656e 7473 5d28 2361 7070  end events](#app
+000018b0: 656e 642d 6576 656e 7473 290a 2020 2a20  end-events).  * 
+000018c0: 5b41 7070 656e 6420 6576 656e 745d 2823  [Append event](#
+000018d0: 6170 7065 6e64 2d65 7665 6e74 290a 2020  append-event).  
+000018e0: 2a20 5b49 6465 6d70 6f74 656e 7420 6170  * [Idempotent ap
+000018f0: 7065 6e64 206f 7065 7261 7469 6f6e 735d  pend operations]
+00001900: 2823 6964 656d 706f 7465 6e74 2d61 7070  (#idempotent-app
+00001910: 656e 642d 6f70 6572 6174 696f 6e73 290a  end-operations).
+00001920: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
+00001930: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
+00001940: 7472 6561 6d2d 6576 656e 7473 290a 2020  tream-events).  
+00001950: 2a20 5b47 6574 2063 7572 7265 6e74 2076  * [Get current v
+00001960: 6572 7369 6f6e 5d28 2367 6574 2d63 7572  ersion](#get-cur
+00001970: 7265 6e74 2d76 6572 7369 6f6e 290a 2020  rent-version).  
+00001980: 2a20 5b48 6f77 2074 6f20 696d 706c 656d  * [How to implem
+00001990: 656e 7420 736e 6170 7368 6f74 7469 6e67  ent snapshotting
+000019a0: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
+000019b0: 4442 5d28 2368 6f77 2d74 6f2d 696d 706c  DB](#how-to-impl
+000019c0: 656d 656e 742d 736e 6170 7368 6f74 7469  ement-snapshotti
+000019d0: 6e67 2d77 6974 682d 6576 656e 7473 746f  ng-with-eventsto
+000019e0: 7265 6462 290a 2020 2a20 5b52 6561 6420  redb).  * [Read 
+000019f0: 616c 6c20 6576 656e 7473 5d28 2372 6561  all events](#rea
+00001a00: 642d 616c 6c2d 6576 656e 7473 290a 2020  d-all-events).  
+00001a10: 2a20 5b47 6574 2063 6f6d 6d69 7420 706f  * [Get commit po
+00001a20: 7369 7469 6f6e 5d28 2367 6574 2d63 6f6d  sition](#get-com
+00001a30: 6d69 742d 706f 7369 7469 6f6e 290a 2020  mit-position).  
+00001a40: 2a20 5b47 6574 2073 7472 6561 6d20 6d65  * [Get stream me
+00001a50: 7461 6461 7461 5d28 2367 6574 2d73 7472  tadata](#get-str
 00001a60: 6561 6d2d 6d65 7461 6461 7461 290a 2020  eam-metadata).  
-00001a70: 2a20 5b44 656c 6574 6520 7374 7265 616d  * [Delete stream
-00001a80: 5d28 2364 656c 6574 652d 7374 7265 616d  ](#delete-stream
-00001a90: 290a 2020 2a20 5b54 6f6d 6273 746f 6e65  ).  * [Tombstone
-00001aa0: 2073 7472 6561 6d5d 2823 746f 6d62 7374   stream](#tombst
-00001ab0: 6f6e 652d 7374 7265 616d 290a 2a20 5b43  one-stream).* [C
-00001ac0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-00001ad0: 7469 6f6e 735d 2823 6361 7463 682d 7570  tions](#catch-up
-00001ae0: 2d73 7562 7363 7269 7074 696f 6e73 290a  -subscriptions).
-00001af0: 2020 2a20 5b48 6f77 2074 6f20 696d 706c    * [How to impl
-00001b00: 656d 656e 7420 6578 6163 746c 792d 6f6e  ement exactly-on
-00001b10: 6365 2065 7665 6e74 2070 726f 6365 7373  ce event process
-00001b20: 696e 675d 2823 686f 772d 746f 2d69 6d70  ing](#how-to-imp
-00001b30: 6c65 6d65 6e74 2d65 7861 6374 6c79 2d6f  lement-exactly-o
-00001b40: 6e63 652d 6576 656e 742d 7072 6f63 6573  nce-event-proces
-00001b50: 7369 6e67 290a 2020 2a20 5b53 7562 7363  sing).  * [Subsc
-00001b60: 7269 6265 2061 6c6c 2065 7665 6e74 735d  ribe all events]
-00001b70: 2823 7375 6273 6372 6962 652d 616c 6c2d  (#subscribe-all-
-00001b80: 6576 656e 7473 290a 2020 2a20 5b53 7562  events).  * [Sub
-00001b90: 7363 7269 6265 2073 7472 6561 6d20 6576  scribe stream ev
-00001ba0: 656e 7473 5d28 2373 7562 7363 7269 6265  ents](#subscribe
-00001bb0: 2d73 7472 6561 6d2d 6576 656e 7473 290a  -stream-events).
-00001bc0: 2a20 5b50 6572 7369 7374 656e 7420 7375  * [Persistent su
-00001bd0: 6273 6372 6970 7469 6f6e 735d 2823 7065  bscriptions](#pe
-00001be0: 7273 6973 7465 6e74 2d73 7562 7363 7269  rsistent-subscri
-00001bf0: 7074 696f 6e73 290a 2020 2a20 5b43 7265  ptions).  * [Cre
-00001c00: 6174 6520 7375 6273 6372 6970 7469 6f6e  ate subscription
-00001c10: 5d28 2363 7265 6174 652d 7375 6273 6372  ](#create-subscr
-00001c20: 6970 7469 6f6e 290a 2020 2a20 5b52 6561  iption).  * [Rea
-00001c30: 6420 7375 6273 6372 6970 7469 6f6e 5d28  d subscription](
-00001c40: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
-00001c50: 6f6e 290a 2020 2a20 5b47 6574 2073 7562  on).  * [Get sub
-00001c60: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
-00001c70: 2367 6574 2d73 7562 7363 7269 7074 696f  #get-subscriptio
-00001c80: 6e2d 696e 666f 290a 2020 2a20 5b4c 6973  n-info).  * [Lis
-00001c90: 7420 7375 6273 6372 6970 7469 6f6e 735d  t subscriptions]
-00001ca0: 2823 6c69 7374 2d73 7562 7363 7269 7074  (#list-subscript
-00001cb0: 696f 6e73 290a 2020 2a20 5b44 656c 6574  ions).  * [Delet
-00001cc0: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
-00001cd0: 2364 656c 6574 652d 7375 6273 6372 6970  #delete-subscrip
-00001ce0: 7469 6f6e 290a 2020 2a20 5b55 7064 6174  tion).  * [Updat
-00001cf0: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
-00001d00: 2375 7064 6174 652d 7375 6273 6372 6970  #update-subscrip
-00001d10: 7469 6f6e 290a 2020 2a20 5b43 7265 6174  tion).  * [Creat
-00001d20: 6520 7374 7265 616d 2073 7562 7363 7269  e stream subscri
-00001d30: 7074 696f 6e5d 2823 6372 6561 7465 2d73  ption](#create-s
-00001d40: 7472 6561 6d2d 7375 6273 6372 6970 7469  tream-subscripti
-00001d50: 6f6e 290a 2020 2a20 5b52 6561 6420 7374  on).  * [Read st
-00001d60: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00001d70: 6e5d 2823 7265 6164 2d73 7472 6561 6d2d  n](#read-stream-
-00001d80: 7375 6273 6372 6970 7469 6f6e 290a 2020  subscription).  
-00001d90: 2a20 5b47 6574 2073 7472 6561 6d20 7375  * [Get stream su
-00001da0: 6273 6372 6970 7469 6f6e 2069 6e66 6f5d  bscription info]
-00001db0: 2823 6765 742d 7374 7265 616d 2d73 7562  (#get-stream-sub
-00001dc0: 7363 7269 7074 696f 6e2d 696e 666f 290a  scription-info).
-00001dd0: 2020 2a20 5b4c 6973 7420 7374 7265 616d    * [List stream
-00001de0: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
-00001df0: 236c 6973 742d 7374 7265 616d 2d73 7562  #list-stream-sub
-00001e00: 7363 7269 7074 696f 6e73 290a 2020 2a20  scriptions).  * 
-00001e10: 5b55 7064 6174 6520 7374 7265 616d 2073  [Update stream s
-00001e20: 7562 7363 7269 7074 696f 6e5d 2823 7570  ubscription](#up
-00001e30: 6461 7465 2d73 7472 6561 6d2d 7375 6273  date-stream-subs
-00001e40: 6372 6970 7469 6f6e 290a 2020 2a20 5b44  cription).  * [D
-00001e50: 656c 6574 6520 7374 7265 616d 2073 7562  elete stream sub
-00001e60: 7363 7269 7074 696f 6e5d 2823 6465 6c65  scription](#dele
-00001e70: 7465 2d73 7472 6561 6d2d 7375 6273 6372  te-stream-subscr
-00001e80: 6970 7469 6f6e 290a 2020 2a20 5b50 6572  iption).  * [Per
-00001e90: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00001ea0: 7469 6f6e 2063 6f6e 7375 6d65 725d 2823  tion consumer](#
-00001eb0: 7065 7273 6973 7465 6e74 2d73 7562 7363  persistent-subsc
-00001ec0: 7269 7074 696f 6e2d 636f 6e73 756d 6572  ription-consumer
-00001ed0: 290a 2a20 5b43 6f6e 6e65 6374 696f 6e5d  ).* [Connection]
-00001ee0: 2823 636f 6e6e 6563 7469 6f6e 290a 2020  (#connection).  
-00001ef0: 2a20 5b52 6563 6f6e 6e65 6374 5d28 2372  * [Reconnect](#r
-00001f00: 6563 6f6e 6e65 6374 290a 2020 2a20 5b43  econnect).  * [C
-00001f10: 6c6f 7365 5d28 2363 6c6f 7365 290a 2a20  lose](#close).* 
-00001f20: 5b4e 6f74 6573 5d28 236e 6f74 6573 290a  [Notes](#notes).
-00001f30: 2020 2a20 5b43 6f6e 6e65 6374 696f 6e20    * [Connection 
-00001f40: 7374 7269 6e67 735d 2823 636f 6e6e 6563  strings](#connec
-00001f50: 7469 6f6e 2d73 7472 696e 6773 290a 2020  tion-strings).  
-00001f60: 2a20 5b52 6567 756c 6172 2065 7870 7265  * [Regular expre
-00001f70: 7373 696f 6e20 6669 6c74 6572 735d 2823  ssion filters](#
-00001f80: 7265 6775 6c61 722d 6578 7072 6573 7369  regular-expressi
-00001f90: 6f6e 2d66 696c 7465 7273 290a 2020 2a20  on-filters).  * 
-00001fa0: 5b4e 6577 2065 7665 6e74 206f 626a 6563  [New event objec
-00001fb0: 7473 5d28 236e 6577 2d65 7665 6e74 2d6f  ts](#new-event-o
-00001fc0: 626a 6563 7473 290a 2020 2a20 5b52 6563  bjects).  * [Rec
-00001fd0: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
-00001fe0: 6374 735d 2823 7265 636f 7264 6564 2d65  cts](#recorded-e
-00001ff0: 7665 6e74 2d6f 626a 6563 7473 290a 2020  vent-objects).  
-00002000: 2a20 5b41 7379 6e63 696f 2063 6c69 656e  * [Asyncio clien
-00002010: 745d 2823 6173 796e 6369 6f2d 636c 6965  t](#asyncio-clie
-00002020: 6e74 290a 2a20 5b43 6f6e 7472 6962 7574  nt).* [Contribut
-00002030: 6f72 735d 2823 636f 6e74 7269 6275 746f  ors](#contributo
-00002040: 7273 290a 2020 2a20 5b49 6e73 7461 6c6c  rs).  * [Install
-00002050: 2050 6f65 7472 795d 2823 696e 7374 616c   Poetry](#instal
-00002060: 6c2d 706f 6574 7279 290a 2020 2a20 5b53  l-poetry).  * [S
-00002070: 6574 7570 2066 6f72 2050 7943 6861 726d  etup for PyCharm
-00002080: 2075 7365 7273 5d28 2373 6574 7570 2d66   users](#setup-f
-00002090: 6f72 2d70 7963 6861 726d 2d75 7365 7273  or-pycharm-users
-000020a0: 290a 2020 2a20 5b53 6574 7570 2066 726f  ).  * [Setup fro
-000020b0: 6d20 636f 6d6d 616e 6420 6c69 6e65 5d28  m command line](
-000020c0: 2373 6574 7570 2d66 726f 6d2d 636f 6d6d  #setup-from-comm
-000020d0: 616e 642d 6c69 6e65 290a 2020 2a20 5b50  and-line).  * [P
-000020e0: 726f 6a65 6374 204d 616b 6566 696c 6520  roject Makefile 
-000020f0: 636f 6d6d 616e 6473 5d28 2370 726f 6a65  commands](#proje
-00002100: 6374 2d6d 616b 6566 696c 652d 636f 6d6d  ct-makefile-comm
-00002110: 616e 6473 290a 3c21 2d2d 2054 4f43 202d  ands).<!-- TOC -
-00002120: 2d3e 0a0a 2323 2049 6e73 7461 6c6c 2070  ->..## Install p
-00002130: 6163 6b61 6765 0a0a 4974 2069 7320 7265  ackage..It is re
-00002140: 636f 6d6d 656e 6465 6420 746f 2069 6e73  commended to ins
-00002150: 7461 6c6c 2050 7974 686f 6e20 7061 636b  tall Python pack
-00002160: 6167 6573 2069 6e74 6f20 6120 5079 7468  ages into a Pyth
-00002170: 6f6e 2076 6972 7475 616c 2065 6e76 6972  on virtual envir
-00002180: 6f6e 6d65 6e74 2e0a 0a23 2323 2046 726f  onment...### Fro
-00002190: 6d20 5079 5049 0a0a 596f 7520 6361 6e20  m PyPI..You can 
-000021a0: 7573 6520 7069 7020 746f 2069 6e73 7461  use pip to insta
-000021b0: 6c6c 2074 6869 7320 7061 636b 6167 6520  ll this package 
-000021c0: 6469 7265 6374 6c79 2066 726f 6d0a 5b74  directly from.[t
-000021d0: 6865 2050 7974 686f 6e20 5061 636b 6167  he Python Packag
-000021e0: 6520 496e 6465 785d 2868 7474 7073 3a2f  e Index](https:/
-000021f0: 2f70 7970 692e 6f72 672f 7072 6f6a 6563  /pypi.org/projec
-00002200: 742f 6573 6462 636c 6965 6e74 2f29 2e0a  t/esdbclient/)..
-00002210: 0a20 2020 2024 2070 6970 2069 6e73 7461  .    $ pip insta
-00002220: 6c6c 2065 7364 6263 6c69 656e 740a 0a23  ll esdbclient..#
-00002230: 2323 2057 6974 6820 506f 6574 7279 0a0a  ## With Poetry..
-00002240: 596f 7520 6361 6e20 7573 6520 506f 6574  You can use Poet
-00002250: 7279 2074 6f20 6164 6420 7468 6973 2070  ry to add this p
-00002260: 6163 6b61 6765 2074 6f20 796f 7572 2070  ackage to your p
-00002270: 7970 726f 6a65 6374 2e74 6f6d 6c20 616e  yproject.toml an
-00002280: 6420 696e 7374 616c 6c20 6974 2e0a 0a20  d install it... 
-00002290: 2020 2024 2070 6f65 7472 7920 6164 6420     $ poetry add 
-000022a0: 6573 6462 636c 6965 6e74 0a0a 2323 2045  esdbclient..## E
-000022b0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-000022c0: 6572 0a0a 5468 6520 4576 656e 7453 746f  er..The EventSto
-000022d0: 7265 4442 2073 6572 7665 7220 6361 6e20  reDB server can 
-000022e0: 6265 2072 756e 206c 6f63 616c 6c79 2075  be run locally u
-000022f0: 7369 6e67 2074 6865 206f 6666 6963 6961  sing the officia
-00002300: 6c20 446f 636b 6572 2063 6f6e 7461 696e  l Docker contain
-00002310: 6572 2069 6d61 6765 2e0a 0a23 2323 2052  er image...### R
-00002320: 756e 2063 6f6e 7461 696e 6572 0a0a 466f  un container..Fo
-00002330: 7220 6465 7665 6c6f 706d 656e 742c 2079  r development, y
-00002340: 6f75 2063 616e 2072 756e 2061 2022 7365  ou can run a "se
-00002350: 6375 7265 2220 4576 656e 7453 746f 7265  cure" EventStore
-00002360: 4442 2073 6572 7665 7220 7573 696e 6720  DB server using 
-00002370: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
-00002380: 6d6d 616e 642e 0a0a 2020 2020 2420 646f  mmand...    $ do
-00002390: 636b 6572 2072 756e 202d 6420 2d2d 6e61  cker run -d --na
-000023a0: 6d65 2065 7665 6e74 7374 6f72 6564 622d  me eventstoredb-
-000023b0: 7365 6375 7265 202d 6974 202d 7020 3231  secure -it -p 21
-000023c0: 3133 3a32 3131 3320 2d2d 656e 7620 2248  13:2113 --env "H
-000023d0: 4f4d 453d 2f74 6d70 2220 6576 656e 7473  OME=/tmp" events
-000023e0: 746f 7265 2f65 7665 6e74 7374 6f72 653a  tore/eventstore:
-000023f0: 3231 2e31 302e 392d 6275 7374 6572 2d73  21.10.9-buster-s
-00002400: 6c69 6d20 2d2d 6465 760a 0a41 7320 7765  lim --dev..As we
-00002410: 2077 696c 6c20 7365 652c 2074 6865 2063   will see, the c
-00002420: 6c69 656e 7420 6e65 6564 7320 616e 2045  lient needs an E
-00002430: 7665 6e74 5374 6f72 6544 4220 636f 6e6e  ventStoreDB conn
-00002440: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-00002450: 4920 6173 2074 6865 2076 616c 7565 206f  I as the value o
-00002460: 660a 6974 7320 6075 7269 6020 636f 6e73  f.its `uri` cons
-00002470: 7472 7563 746f 7220 6172 6775 6d65 6e74  tructor argument
-00002480: 2e20 5365 6520 7468 6520 4e6f 7465 7320  . See the Notes 
-00002490: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
-000024a0: 7220 6465 7461 696c 6564 2069 6e66 6f72  r detailed infor
-000024b0: 6d61 7469 6f6e 0a61 626f 7574 2045 7665  mation.about Eve
-000024c0: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
-000024d0: 7469 6f6e 2073 7472 696e 6720 5552 4973  tion string URIs
-000024e0: 2e0a 0a54 6865 2063 6f6e 6e65 6374 696f  ...The connectio
-000024f0: 6e20 7374 7269 6e67 2066 6f72 2074 6869  n string for thi
-00002500: 7320 2273 6563 7572 6522 2045 7665 6e74  s "secure" Event
-00002510: 5374 6f72 6544 4220 7365 7276 6572 2077  StoreDB server w
-00002520: 6f75 6c64 2062 653a 0a0a 2020 2020 6573  ould be:..    es
-00002530: 6462 3a2f 2f61 646d 696e 3a63 6861 6e67  db://admin:chang
-00002540: 6569 7440 6c6f 6361 6c68 6f73 743a 3231  eit@localhost:21
-00002550: 3133 0a0a 546f 2063 6f6e 6e65 6374 2074  13..To connect t
-00002560: 6f20 6120 2273 6563 7572 6522 2073 6572  o a "secure" ser
-00002570: 7665 722c 2079 6f75 2077 696c 6c20 7573  ver, you will us
-00002580: 7561 6c6c 7920 6e65 6564 2074 6f20 696e  ually need to in
-00002590: 636c 7564 6520 6120 2275 7365 726e 616d  clude a "usernam
-000025a0: 6522 0a61 6e64 2061 2022 7061 7373 776f  e".and a "passwo
-000025b0: 7264 2220 696e 2074 6865 2063 6f6e 6e65  rd" in the conne
-000025c0: 6374 696f 6e20 7374 7269 6e67 2c20 736f  ction string, so
-000025d0: 2074 6861 7420 7468 6520 7365 7276 6572   that the server
-000025e0: 2063 616e 2061 7574 6865 6e74 6963 6174   can authenticat
-000025f0: 6520 7468 650a 636c 6965 6e74 2e20 5468  e the.client. Th
-00002600: 6520 6465 6661 756c 7420 7573 6572 6e61  e default userna
-00002610: 6d65 2069 7320 2261 646d 696e 2220 616e  me is "admin" an
-00002620: 6420 7468 6520 6465 6661 756c 7420 7061  d the default pa
-00002630: 7373 776f 7264 2069 7320 2263 6861 6e67  ssword is "chang
-00002640: 6569 7422 2e0a 0a57 6865 6e20 636f 6e6e  eit"...When conn
-00002650: 6563 7469 6e67 2074 6f20 6120 2273 6563  ecting to a "sec
-00002660: 7572 6522 2073 6572 7665 722c 2074 6865  ure" server, the
-00002670: 2063 6c69 656e 7420 616c 736f 206e 6565   client also nee
-00002680: 6473 2061 6e20 5353 4c2f 544c 530a 6365  ds an SSL/TLS.ce
-00002690: 7274 6966 6963 6174 6520 6173 2074 6865  rtificate as the
-000026a0: 2076 616c 7565 206f 6620 6974 7320 6072   value of its `r
-000026b0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-000026c0: 6020 636f 6e73 7472 7563 746f 7220 6172  ` constructor ar
-000026d0: 6775 6d65 6e74 2e20 546f 2063 6f6e 6e65  gument. To conne
-000026e0: 6374 0a74 6f20 6120 2273 6563 7572 6522  ct.to a "secure"
-000026f0: 2073 6572 7665 7220 796f 7520 7769 6c6c   server you will
-00002700: 206e 6565 6420 616e 2053 534c 2f54 4c53   need an SSL/TLS
-00002710: 2063 6572 7469 6669 6361 7465 2073 6f20   certificate so 
-00002720: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
-00002730: 6361 6e0a 6175 7468 656e 7469 6361 7465  can.authenticate
-00002740: 2074 6865 2073 6572 7665 722e 2046 6f72   the server. For
-00002750: 2064 6576 656c 6f70 6d65 6e74 2c20 796f   development, yo
-00002760: 7520 6361 6e20 6569 7468 6572 2075 7365  u can either use
-00002770: 2074 6865 2053 534c 2f54 4c53 2063 6572   the SSL/TLS cer
-00002780: 7469 6669 6361 7465 0a6f 6620 7468 6520  tificate.of the 
-00002790: 6365 7274 6966 6963 6174 6520 6175 7468  certificate auth
-000027a0: 6f72 6974 7920 7573 6564 2074 6f20 6372  ority used to cr
-000027b0: 6561 7465 2074 6865 2073 6572 7665 7227  eate the server'
-000027c0: 7320 6365 7274 6966 6963 6174 652c 206f  s certificate, o
-000027d0: 7220 7768 656e 2075 7369 6e67 2061 0a73  r when using a.s
-000027e0: 696e 676c 652d 6e6f 6465 2063 6c75 7374  ingle-node clust
-000027f0: 6572 2c20 796f 7520 6361 6e20 7573 6520  er, you can use 
-00002800: 7468 6520 7365 7276 6572 2063 6572 7469  the server certi
-00002810: 6669 6361 7465 2069 7473 656c 662e 2059  ficate itself. Y
-00002820: 6f75 2063 616e 2067 6574 2074 6865 0a73  ou can get the.s
-00002830: 6572 7665 7220 6365 7274 6966 6963 6174  erver certificat
-00002840: 6520 7769 7468 2074 6865 2066 6f6c 6c6f  e with the follo
-00002850: 7769 6e67 2050 7974 686f 6e20 636f 6465  wing Python code
-00002860: 2e0a 0a0a 6060 6070 7974 686f 6e0a 696d  ....```python.im
-00002870: 706f 7274 2073 736c 0a0a 7365 7276 6572  port ssl..server
-00002880: 5f63 6572 7469 6669 6361 7465 203d 2073  _certificate = s
-00002890: 736c 2e67 6574 5f73 6572 7665 725f 6365  sl.get_server_ce
-000028a0: 7274 6966 6963 6174 6528 6164 6472 3d28  rtificate(addr=(
-000028b0: 276c 6f63 616c 686f 7374 272c 2032 3131  'localhost', 211
-000028c0: 3329 290a 6060 600a 0a59 6f75 2063 616e  3)).```..You can
-000028d0: 2061 6c73 6f20 7374 6172 7420 616e 2022   also start an "
-000028e0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-000028f0: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
-00002900: 7769 6e67 2063 6f6d 6d61 6e64 2e0a 0a20  wing command... 
-00002910: 2020 2024 2064 6f63 6b65 7220 7275 6e20     $ docker run 
-00002920: 2d64 202d 2d6e 616d 6520 6576 656e 7473  -d --name events
-00002930: 746f 7265 6462 2d69 6e73 6563 7572 6520  toredb-insecure 
-00002940: 2d69 7420 2d70 2032 3131 343a 3231 3133  -it -p 2114:2113
-00002950: 2065 7665 6e74 7374 6f72 652f 6576 656e   eventstore/even
-00002960: 7473 746f 7265 3a32 312e 3130 2e39 2d62  tstore:21.10.9-b
-00002970: 7573 7465 722d 736c 696d 202d 2d69 6e73  uster-slim --ins
-00002980: 6563 7572 650a 0a54 6865 2063 6f6e 6e65  ecure..The conne
-00002990: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-000029a0: 2066 6f72 2074 6869 7320 2269 6e73 6563   for this "insec
-000029b0: 7572 6522 2073 6572 7665 7220 776f 756c  ure" server woul
-000029c0: 6420 6265 3a0a 0a20 2020 2065 7364 623a  d be:..    esdb:
-000029d0: 2f2f 6c6f 6361 6c68 6f73 743a 3231 3134  //localhost:2114
-000029e0: 3f54 6c73 3d66 616c 7365 0a0a 4173 2077  ?Tls=false..As w
-000029f0: 6520 7769 6c6c 2073 6565 2c20 7768 656e  e will see, when
-00002a00: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
-00002a10: 6e20 2269 6e73 6563 7572 6522 2073 6572  n "insecure" ser
-00002a20: 7665 722c 2074 6865 7265 2069 7320 6e6f  ver, there is no
-00002a30: 206e 6565 6420 746f 2069 6e63 6c75 6465   need to include
-00002a40: 0a61 2022 7573 6572 6e61 6d65 2220 616e  .a "username" an
-00002a50: 6420 6120 2270 6173 7377 6f72 6422 2069  d a "password" i
-00002a60: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
-00002a70: 2073 7472 696e 672e 2049 6620 796f 7520   string. If you 
-00002a80: 646f 2c20 7468 6573 6520 7661 6c75 6573  do, these values
-00002a90: 2077 696c 6c0a 6265 2069 676e 6f72 6564   will.be ignored
-00002aa0: 2062 7920 7468 6520 636c 6965 6e74 2c20   by the client, 
-00002ab0: 736f 2074 6861 7420 7468 6579 2077 696c  so that they wil
-00002ac0: 6c20 6e6f 7420 6265 2073 656e 7420 746f  l not be sent to
-00002ad0: 2074 6865 2073 6572 7665 7220 6f76 6572   the server over
-00002ae0: 2061 6e0a 696e 7365 6375 7265 2063 6861   an.insecure cha
-00002af0: 6e6e 656c 2e0a 0a50 6c65 6173 6520 6e6f  nnel...Please no
-00002b00: 7465 2c20 7468 6520 2269 6e73 6563 7572  te, the "insecur
-00002b10: 6522 2063 6f6e 6e65 6374 696f 6e20 7374  e" connection st
-00002b20: 7269 6e67 2075 7365 7320 6120 7175 6572  ring uses a quer
-00002b30: 7920 7374 7269 6e67 2077 6974 6820 7468  y string with th
-00002b40: 6520 6669 656c 642d 7661 6c75 650a 6054  e field-value.`T
-00002b50: 6c73 3d66 616c 7365 602e 2054 6865 2076  ls=false`. The v
-00002b60: 616c 7565 206f 6620 7468 6973 2066 6965  alue of this fie
-00002b70: 6c64 2069 7320 6279 2064 6566 6175 6c74  ld is by default
-00002b80: 2060 7472 7565 602e 2053 6565 2074 6865   `true`. See the
-00002b90: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-00002ba0: 656c 6f77 0a66 6f72 206d 6f72 6520 696e  elow.for more in
-00002bb0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
-00002bc0: 4576 656e 7453 746f 7265 4442 2063 6f6e  EventStoreDB con
-00002bd0: 6e65 6374 696f 6e20 7374 7269 6e67 7320  nection strings 
-00002be0: 616e 6420 7468 6520 6669 656c 6473 2074  and the fields t
-00002bf0: 6861 7420 6361 6e20 6265 0a75 7365 6420  hat can be.used 
-00002c00: 696e 2074 6865 2071 7565 7279 2073 7472  in the query str
-00002c10: 696e 6720 746f 2073 7065 6369 6679 2063  ing to specify c
-00002c20: 6f6e 6e65 6374 696f 6e20 6f70 7469 6f6e  onnection option
-00002c30: 732e 0a0a 2323 2320 5374 6f70 2063 6f6e  s...### Stop con
-00002c40: 7461 696e 6572 0a0a 546f 2073 746f 7020  tainer..To stop 
-00002c50: 616e 6420 7265 6d6f 7665 2074 6865 2022  and remove the "
-00002c60: 7365 6375 7265 2220 636f 6e74 6169 6e65  secure" containe
-00002c70: 722c 2075 7365 2074 6865 2066 6f6c 6c6f  r, use the follo
-00002c80: 7769 6e67 2044 6f63 6b65 7220 636f 6d6d  wing Docker comm
-00002c90: 616e 6473 2e0a 0a20 2020 2024 2064 6f63  ands...    $ doc
-00002ca0: 6b65 7220 7374 6f70 2065 7665 6e74 7374  ker stop eventst
-00002cb0: 6f72 6564 622d 7365 6375 7265 0a09 2420  oredb-secure..$ 
-00002cc0: 646f 636b 6572 2072 6d20 6576 656e 7473  docker rm events
-00002cd0: 746f 7265 6462 2d73 6563 7572 650a 0a54  toredb-secure..T
-00002ce0: 6f20 7374 6f70 2061 6e64 2072 656d 6f76  o stop and remov
-00002cf0: 6520 7468 6520 2269 6e73 6563 7572 6522  e the "insecure"
-00002d00: 2063 6f6e 7461 696e 6572 2c20 7573 6520   container, use 
-00002d10: 7468 6520 666f 6c6c 6f77 696e 6720 446f  the following Do
-00002d20: 636b 6572 2063 6f6d 6d61 6e64 732e 0a0a  cker commands...
-00002d30: 2020 2020 2420 646f 636b 6572 2073 746f      $ docker sto
-00002d40: 7020 6576 656e 7473 746f 7265 6462 2d69  p eventstoredb-i
-00002d50: 6e73 6563 7572 650a 0924 2064 6f63 6b65  nsecure..$ docke
-00002d60: 7220 726d 2065 7665 6e74 7374 6f72 6564  r rm eventstored
-00002d70: 622d 696e 7365 6375 7265 0a0a 0a23 2320  b-insecure...## 
-00002d80: 4576 656e 7453 746f 7265 4442 2063 6c69  EventStoreDB cli
-00002d90: 656e 740a 0a54 6869 7320 4576 656e 7453  ent..This EventS
-00002da0: 746f 7265 4442 2063 6c69 656e 7420 6973  toreDB client is
-00002db0: 2069 6d70 6c65 6d65 6e74 6564 2069 6e20   implemented in 
-00002dc0: 7468 6520 6065 7364 6263 6c69 656e 7460  the `esdbclient`
-00002dd0: 2070 6163 6b61 6765 2077 6974 680a 7468   package with.th
-00002de0: 6520 6045 5344 4243 6c69 656e 7460 2063  e `ESDBClient` c
-00002df0: 6c61 7373 2e0a 0a23 2323 2049 6d70 6f72  lass...### Impor
-00002e00: 7420 636c 6173 730a 0a54 6865 2060 4553  t class..The `ES
-00002e10: 4442 436c 6965 6e74 6020 636c 6173 7320  DBClient` class 
-00002e20: 6361 6e20 6265 2069 6d70 6f72 7465 6420  can be imported 
-00002e30: 6672 6f6d 2074 6865 2060 6573 6462 636c  from the `esdbcl
-00002e40: 6965 6e74 6020 7061 636b 6167 652e 0a0a  ient` package...
-00002e50: 6060 6070 7974 686f 6e0a 6672 6f6d 2065  ```python.from e
-00002e60: 7364 6263 6c69 656e 7420 696d 706f 7274  sdbclient import
-00002e70: 2045 5344 4243 6c69 656e 740a 6060 600a   ESDBClient.```.
-00002e80: 0a23 2323 2043 6f6e 7374 7275 6374 2063  .### Construct c
-00002e90: 6c69 656e 740a 0a54 6865 2060 4553 4442  lient..The `ESDB
-00002ea0: 436c 6965 6e74 6020 636c 6173 7320 6361  Client` class ca
-00002eb0: 6e20 6265 2063 6f6e 7374 7275 6374 6564  n be constructed
-00002ec0: 2077 6974 6820 6120 6075 7269 6020 6172   with a `uri` ar
-00002ed0: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
-00002ee0: 2072 6571 7569 7265 642e 0a41 6e64 2c20   required..And, 
-00002ef0: 746f 2063 6f6e 6e65 6374 2074 6f20 6120  to connect to a 
-00002f00: 2273 6563 7572 6522 2045 7665 6e74 5374  "secure" EventSt
-00002f10: 6f72 6544 4220 7365 7276 6572 2c20 7468  oreDB server, th
-00002f20: 6520 6f70 7469 6f6e 616c 2060 726f 6f74  e optional `root
-00002f30: 5f63 6572 7469 6669 6361 7465 7360 0a61  _certificates`.a
-00002f40: 7267 756d 656e 7420 6973 2061 6c73 6f20  rgument is also 
-00002f50: 7265 7175 6972 6564 2e0a 0a54 6865 2060  required...The `
-00002f60: 7572 6960 2061 7267 756d 656e 7420 6973  uri` argument is
-00002f70: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00002f80: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
-00002f90: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00002fa0: 6720 5552 4920 7468 6174 0a63 6f6e 666f  g URI that.confo
-00002fb0: 726d 7320 7769 7468 2074 6865 2073 7461  rms with the sta
-00002fc0: 6e64 6172 6420 4576 656e 7453 746f 7265  ndard EventStore
-00002fd0: 4442 2022 6573 6462 2220 6f72 2022 6573  DB "esdb" or "es
-00002fe0: 6462 2b64 6973 636f 7665 7222 2055 5249  db+discover" URI
-00002ff0: 2073 6368 656d 6573 2e20 5468 650a 7379   schemes. The.sy
-00003000: 6e74 6178 2061 6e64 2073 656d 616e 7469  ntax and semanti
-00003010: 6373 206f 6620 4576 656e 7453 746f 7265  cs of EventStore
-00003020: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
-00003030: 7269 6e67 7320 6172 6520 6578 706c 6169  rings are explai
-00003040: 6e65 6420 696e 2074 6865 204e 6f74 6573  ned in the Notes
-00003050: 0a73 6563 7469 6f6e 2062 656c 6f77 2e0a  .section below..
-00003060: 0a46 6f72 2065 7861 6d70 6c65 2c20 7468  .For example, th
-00003070: 6520 666f 6c6c 6f77 696e 6720 636f 6e6e  e following conn
-00003080: 6563 7469 6f6e 2073 7472 696e 6720 7370  ection string sp
-00003090: 6563 6966 6965 7320 7468 6174 2074 6865  ecifies that the
-000030a0: 2063 6c69 656e 7420 7368 6f75 6c64 0a61   client should.a
-000030b0: 7474 656d 7074 2074 6f20 6372 6561 7465  ttempt to create
-000030c0: 2061 2022 7365 6375 7265 2220 636f 6e6e   a "secure" conn
-000030d0: 6563 7469 6f6e 2074 6f20 706f 7274 2032  ection to port 2
-000030e0: 3131 3320 6f6e 2022 6c6f 6361 6c68 6f73  113 on "localhos
-000030f0: 7422 2c20 616e 6420 7573 6520 7468 650a  t", and use the.
-00003100: 636c 6965 6e74 2063 7265 6465 6e74 6961  client credentia
-00003110: 6c73 2022 7573 6572 6e61 6d65 2220 616e  ls "username" an
-00003120: 6420 2270 6173 7377 6f72 6422 2077 6865  d "password" whe
-00003130: 6e20 6d61 6b69 6e67 2063 616c 6c73 2074  n making calls t
-00003140: 6f20 7468 6520 7365 7276 6572 2e0a 0a20  o the server... 
-00003150: 2020 2065 7364 623a 2f2f 7573 6572 6e61     esdb://userna
-00003160: 6d65 3a70 6173 7377 6f72 6440 6c6f 6361  me:password@loca
-00003170: 6c68 6f73 743a 3231 3133 3f54 6c73 3d74  lhost:2113?Tls=t
-00003180: 7275 650a 0a54 6865 2063 6c69 656e 7420  rue..The client 
-00003190: 6d75 7374 2062 6520 636f 6e66 6967 7572  must be configur
-000031a0: 6564 2074 6f20 6372 6561 7465 2061 2022  ed to create a "
-000031b0: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-000031c0: 6f6e 2074 6f20 6120 2273 6563 7572 6522  on to a "secure"
-000031d0: 2073 6572 7665 722c 0a6f 7220 616c 7465   server,.or alte
-000031e0: 726e 6174 6976 656c 7920 616e 2022 696e  rnatively an "in
-000031f0: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-00003200: 6f6e 2074 6f20 616e 2022 696e 7365 6375  on to an "insecu
-00003210: 7265 2220 7365 7276 6572 2e20 4279 2064  re" server. By d
-00003220: 6566 6175 6c74 2c20 7468 650a 636c 6965  efault, the.clie
-00003230: 6e74 2077 696c 6c20 6174 7465 6d70 7420  nt will attempt 
-00003240: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
-00003250: 7572 6522 2063 6f6e 6e65 6374 696f 6e2e  ure" connection.
-00003260: 2041 6e64 2073 6f2c 2077 6865 6e20 636f   And so, when co
-00003270: 6e6e 6563 7469 6e67 2074 6f20 616e 0a22  nnecting to an."
-00003280: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-00003290: 2c20 7468 6520 636f 6e6e 6563 7469 6f6e  , the connection
-000032a0: 2073 7472 696e 6720 6d75 7374 2073 7065   string must spe
-000032b0: 6369 6679 2074 6861 7420 7468 6520 636c  cify that the cl
-000032c0: 6965 6e74 2073 686f 756c 6420 6174 7465  ient should atte
-000032d0: 6d70 740a 746f 206d 616b 6520 616e 2022  mpt.to make an "
-000032e0: 696e 7365 6375 7265 2220 636f 6e6e 6563  insecure" connec
-000032f0: 7469 6f6e 2e0a 0a54 6865 2066 6f6c 6c6f  tion...The follo
-00003300: 7769 6e67 2063 6f6e 6e65 6374 696f 6e20  wing connection 
-00003310: 7374 7269 6e67 2073 7065 6369 6669 6573  string specifies
-00003320: 2074 6861 7420 7468 6520 636c 6965 6e74   that the client
-00003330: 2073 686f 756c 640a 6174 7465 6d70 7420   should.attempt 
-00003340: 746f 2063 7265 6174 6520 616e 2022 696e  to create an "in
-00003350: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-00003360: 6f6e 2074 6f20 706f 7274 2032 3131 3420  on to port 2114 
-00003370: 6f6e 2022 6c6f 6361 6c68 6f73 7422 2e0a  on "localhost"..
-00003380: 5768 656e 2063 6f6e 6e65 6374 696e 6720  When connecting 
-00003390: 746f 2061 6e20 2269 6e73 6563 7572 6522  to an "insecure"
-000033a0: 2073 6572 7665 722c 2074 6865 2063 6c69   server, the cli
-000033b0: 656e 7420 7769 6c6c 2069 676e 6f72 6520  ent will ignore 
-000033c0: 616e 790a 7573 6572 6e61 6d65 2061 6e64  any.username and
-000033d0: 2070 6173 7377 6f72 6420 696e 666f 726d   password inform
-000033e0: 6174 696f 6e20 696e 636c 7564 6564 2069  ation included i
-000033f0: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
-00003400: 2073 7472 696e 672c 0a73 6f20 7468 6174   string,.so that
-00003410: 2075 7365 726e 616d 6573 2061 6e64 2070   usernames and p
-00003420: 6173 7377 6f72 6473 2061 7265 206e 6f74  asswords are not
-00003430: 2073 656e 7420 6f76 6572 2061 6e20 2269   sent over an "i
-00003440: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
-00003450: 696f 6e2e 0a0a 2020 2020 6573 6462 3a2f  ion...    esdb:/
-00003460: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
-00003470: 546c 733d 6661 6c73 650a 0a50 6c65 6173  Tls=false..Pleas
-00003480: 6520 6e6f 7465 2c20 7468 6520 2269 6e73  e note, the "ins
-00003490: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-000034a0: 6e20 7374 7269 6e67 2075 7365 7320 6120  n string uses a 
-000034b0: 7175 6572 7920 7374 7269 6e67 2077 6974  query string wit
-000034c0: 6820 7468 6520 6669 656c 642d 7661 6c75  h the field-valu
-000034d0: 650a 6054 6c73 3d66 616c 7365 602e 2054  e.`Tls=false`. T
-000034e0: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
-000034f0: 2066 6965 6c64 2069 7320 6279 2064 6566   field is by def
-00003500: 6175 6c74 2060 7472 7565 602e 2055 6e6c  ault `true`. Unl
-00003510: 6573 7320 7468 6520 636f 6e6e 6563 7469  ess the connecti
-00003520: 6f6e 2073 7472 696e 670a 5552 4920 696e  on string.URI in
-00003530: 636c 7564 6573 2074 6865 2066 6965 6c64  cludes the field
-00003540: 2d76 616c 7565 2060 546c 733d 6661 6c73  -value `Tls=fals
-00003550: 6560 2069 6e20 7468 6520 7175 6572 7920  e` in the query 
-00003560: 7374 7269 6e67 2c20 7468 6520 6072 6f6f  string, the `roo
-00003570: 745f 6365 7274 6966 6963 6174 6573 600a  t_certificates`.
-00003580: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
-00003590: 6d65 6e74 2069 7320 616c 736f 2072 6571  ment is also req
-000035a0: 7569 7265 642e 0a0a 5768 656e 2063 6f6e  uired...When con
-000035b0: 6e65 6374 696e 6720 746f 2061 2022 7365  necting to a "se
-000035c0: 6375 7265 2220 7365 7276 6572 2c20 7468  cure" server, th
-000035d0: 6520 6072 6f6f 745f 6365 7274 6966 6963  e `root_certific
-000035e0: 6174 6573 6020 6172 6775 6d65 6e74 2069  ates` argument i
-000035f0: 7320 6578 7065 6374 6564 2074 6f0a 6265  s expected to.be
-00003600: 2061 2050 7974 686f 6e20 6073 7472 6020   a Python `str` 
-00003610: 636f 6e74 6169 6e69 6e67 2050 454d 2065  containing PEM e
-00003620: 6e63 6f64 6564 2053 534c 2f54 4c53 2072  ncoded SSL/TLS r
-00003630: 6f6f 7420 6365 7274 6966 6963 6174 6573  oot certificates
-00003640: 2e20 5468 6973 2076 616c 7565 2069 730a  . This value is.
-00003650: 7061 7373 6564 2064 6972 6563 746c 7920  passed directly 
-00003660: 746f 2060 6772 7063 2e73 736c 5f63 6861  to `grpc.ssl_cha
-00003670: 6e6e 656c 5f63 7265 6465 6e74 6961 6c73  nnel_credentials
-00003680: 2829 602e 2049 7420 6973 2075 7365 6420  ()`. It is used 
-00003690: 666f 7220 6175 7468 656e 7469 6361 7469  for authenticati
-000036a0: 6e67 2074 6865 0a73 6572 7665 7220 746f  ng the.server to
-000036b0: 2074 6865 2063 6c69 656e 742e 2049 7420   the client. It 
-000036c0: 6973 2063 6f6d 6d6f 6e6c 7920 7468 6520  is commonly the 
-000036d0: 6365 7274 6966 6963 6174 6520 6f66 2074  certificate of t
-000036e0: 6865 2063 6572 7469 6669 6361 7465 2061  he certificate a
-000036f0: 7574 686f 7269 7479 2074 6861 740a 7761  uthority that.wa
-00003700: 7320 7265 7370 6f6e 7369 626c 6520 666f  s responsible fo
-00003710: 7220 6765 6e65 7261 7469 6e67 2074 6865  r generating the
-00003720: 2053 534c 2f54 4c53 2063 6572 7469 6669   SSL/TLS certifi
-00003730: 6361 7465 2075 7365 6420 6279 2074 6865  cate used by the
-00003740: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-00003750: 7276 6572 2e0a 4275 742c 2061 6c74 6572  rver..But, alter
-00003760: 6e61 7469 7665 6c79 2066 6f72 2064 6576  natively for dev
-00003770: 656c 6f70 6d65 6e74 2c20 796f 7520 6361  elopment, you ca
-00003780: 6e20 7573 6520 7468 6520 7365 7276 6572  n use the server
-00003790: 2773 2063 6572 7469 6669 6361 7465 2069  's certificate i
-000037a0: 7473 656c 662e 0a0a 496e 2074 6865 2065  tself...In the e
-000037b0: 7861 6d70 6c65 2062 656c 6f77 2c20 7468  xample below, th
-000037c0: 6520 636f 6e73 7472 7563 746f 7220 6172  e constructor ar
-000037d0: 6775 6d65 6e74 2076 616c 7565 7320 6172  gument values ar
-000037e0: 6520 7461 6b65 6e20 6672 6f6d 2074 6865  e taken from the
-000037f0: 206f 7065 7261 7469 6e67 0a73 7973 7465   operating.syste
-00003800: 6d20 656e 7669 726f 6e6d 656e 742e 2054  m environment. T
-00003810: 6869 7320 6973 2061 2074 7970 6963 616c  his is a typical
-00003820: 2061 7272 616e 6765 6d65 6e74 2069 6e20   arrangement in 
-00003830: 6120 7072 6f64 7563 7469 6f6e 2065 6e76  a production env
-00003840: 6972 6f6e 6d65 6e74 2e20 4974 2069 730a  ironment. It is.
-00003850: 646f 6e65 2074 6869 7320 7761 7920 6865  done this way he
-00003860: 7265 2073 6f20 7468 6174 2074 6865 2063  re so that the c
-00003870: 6f64 6520 696e 2074 6869 7320 646f 6375  ode in this docu
-00003880: 6d65 6e74 6174 696f 6e20 6361 6e20 6265  mentation can be
-00003890: 2074 6573 7465 6420 7769 7468 2062 6f74   tested with bot
-000038a0: 680a 6120 2273 6563 7572 6522 2061 6e64  h.a "secure" and
-000038b0: 2061 6e20 2269 6e73 6563 7572 6522 2073   an "insecure" s
-000038c0: 6572 7665 722e 0a0a 6060 6070 7974 686f  erver...```pytho
-000038d0: 6e0a 696d 706f 7274 206f 730a 0a63 6c69  n.import os..cli
-000038e0: 656e 7420 3d20 4553 4442 436c 6965 6e74  ent = ESDBClient
-000038f0: 280a 2020 2020 7572 693d 6f73 2e67 6574  (.    uri=os.get
-00003900: 656e 7628 2245 5344 425f 5552 4922 292c  env("ESDB_URI"),
-00003910: 0a20 2020 2072 6f6f 745f 6365 7274 6966  .    root_certif
-00003920: 6963 6174 6573 3d6f 732e 6765 7465 6e76  icates=os.getenv
-00003930: 2822 4553 4442 5f52 4f4f 545f 4345 5254  ("ESDB_ROOT_CERT
-00003940: 4946 4943 4154 4553 2229 2c0a 290a 6060  IFICATES"),.).``
-00003950: 600a 0a53 6565 2074 6865 204e 6f74 6573  `..See the Notes
-00003960: 2073 6563 7469 6f6e 2062 656c 6f77 2066   section below f
-00003970: 6f72 2064 6574 6169 6c65 6420 696e 666f  or detailed info
-00003980: 726d 6174 696f 6e20 6162 6f75 7420 4576  rmation about Ev
-00003990: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-000039a0: 6374 696f 6e0a 7374 7269 6e67 7320 616e  ction.strings an
-000039b0: 6420 7468 6520 6669 656c 6473 2074 6861  d the fields tha
-000039c0: 7420 6361 6e20 6265 2075 7365 6420 696e  t can be used in
-000039d0: 2074 6865 2071 7565 7279 2073 7472 696e   the query strin
-000039e0: 6720 746f 2073 7065 6369 6679 2063 6f6e  g to specify con
-000039f0: 6e65 6374 696f 6e0a 6f70 7469 6f6e 732e  nection.options.
-00003a00: 0a0a 2323 2053 7472 6561 6d73 0a0a 496e  ..## Streams..In
-00003a10: 2045 7665 6e74 5374 6f72 6544 422c 2061   EventStoreDB, a
-00003a20: 2022 7374 7265 616d 2220 6973 2061 2073   "stream" is a s
-00003a30: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
-00003a40: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
-00003a50: 616c 6c20 6861 7665 0a74 6865 2073 616d  all have.the sam
-00003a60: 6520 2273 7472 6561 6d20 6e61 6d65 222e  e "stream name".
-00003a70: 2054 6865 7265 2077 696c 6c20 6e6f 726d   There will norm
-00003a80: 616c 6c79 2062 6520 6d61 6e79 2073 7472  ally be many str
-00003a90: 6561 6d73 2069 6e20 6120 6461 7461 6261  eams in a databa
-00003aa0: 7365 2e0a 4561 6368 2072 6563 6f72 6465  se..Each recorde
-00003ab0: 6420 6576 656e 7420 6861 7320 6120 2273  d event has a "s
-00003ac0: 7472 6561 6d20 706f 7369 7469 6f6e 2220  tream position" 
-00003ad0: 696e 2069 7473 2073 7472 6561 6d2c 2061  in its stream, a
-00003ae0: 6e64 2061 2022 636f 6d6d 6974 2070 6f73  nd a "commit pos
-00003af0: 6974 696f 6e22 0a69 6e20 7468 6520 6461  ition".in the da
-00003b00: 7461 6261 7365 2e20 5468 6520 7374 7265  tabase. The stre
-00003b10: 616d 2070 6f73 6974 696f 6e73 206f 6620  am positions of 
-00003b20: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00003b30: 6e74 7320 696e 2061 2073 7472 6561 6d20  nts in a stream 
-00003b40: 6973 2061 2067 6170 6c65 7373 0a73 6571  is a gapless.seq
-00003b50: 7565 6e63 6520 7374 6172 7469 6e67 2066  uence starting f
-00003b60: 726f 6d20 7a65 726f 2e20 5468 6520 636f  rom zero. The co
-00003b70: 6d6d 6974 2070 6f73 6974 696f 6e73 206f  mmit positions o
-00003b80: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-00003b90: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
-00003ba0: 6162 6173 650a 666f 726d 2061 2073 6571  abase.form a seq
-00003bb0: 7565 6e63 6520 7468 6174 2069 7320 6e6f  uence that is no
-00003bc0: 7420 6761 706c 6573 732e 0a0a 5468 6520  t gapless...The 
-00003bd0: 6d65 7468 6f64 7320 6061 7070 656e 645f  methods `append_
-00003be0: 6576 656e 7473 2829 602c 2060 7265 6164  events()`, `read
-00003bf0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00003c00: 6020 616e 6420 6072 6561 645f 616c 6c5f  ` and `read_all_
-00003c10: 6576 656e 7473 2829 6020 6361 6e0a 6265  events()` can.be
-00003c20: 2075 7365 6420 746f 2072 6563 6f72 6420   used to record 
-00003c30: 616e 6420 7265 6164 2065 7665 6e74 7320  and read events 
-00003c40: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-00003c50: 0a0a 2323 2320 4170 7065 6e64 2065 7665  ..### Append eve
-00003c60: 6e74 730a 0a2a 7265 7175 6972 6573 206c  nts..*requires l
-00003c70: 6561 6465 722a 0a0a 5468 6520 6061 7070  eader*..The `app
-00003c80: 656e 645f 6576 656e 7473 2829 6020 6d65  end_events()` me
-00003c90: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00003ca0: 2074 6f20 7772 6974 6520 6120 7365 7175   to write a sequ
-00003cb0: 656e 6365 206f 6620 6e65 7720 6576 656e  ence of new even
-00003cc0: 7473 2061 746f 6d69 6361 6c6c 790a 746f  ts atomically.to
-00003cd0: 2061 2022 7374 7265 616d 222e 2057 7269   a "stream". Wri
-00003ce0: 7469 6e67 206e 6577 2065 7665 6e74 7320  ting new events 
-00003cf0: 6569 7468 6572 2063 7265 6174 6573 2061  either creates a
-00003d00: 2073 7472 6561 6d2c 206f 7220 6170 7065   stream, or appe
-00003d10: 6e64 7320 6576 656e 7473 2074 6f20 7468  nds events to th
-00003d20: 6520 656e 640a 6f66 2061 2073 7472 6561  e end.of a strea
-00003d30: 6d2e 2054 6869 7320 6d65 7468 6f64 2069  m. This method i
-00003d40: 7320 6964 656d 706f 7465 6e74 2e0a 0a54  s idempotent...T
-00003d50: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
-00003d60: 6520 7573 6564 2074 6f20 7265 636f 7264  e used to record
-00003d70: 2061 746f 6d69 6361 6c6c 7920 616c 6c20   atomically all 
-00003d80: 7468 6520 6e65 770a 6576 656e 7473 2074  the new.events t
-00003d90: 6861 7420 6172 6520 6765 6e65 7261 7465  hat are generate
-00003da0: 6420 7768 656e 2065 7865 6375 7469 6e67  d when executing
-00003db0: 2061 2063 6f6d 6d61 6e64 2069 6e20 616e   a command in an
-00003dc0: 2061 7070 6c69 6361 7469 6f6e 2e0a 0a54   application...T
-00003dd0: 6872 6565 2061 7267 756d 656e 7473 2061  hree arguments a
-00003de0: 7265 2072 6571 7569 7265 642c 2060 7374  re required, `st
-00003df0: 7265 616d 5f6e 616d 6560 2c20 6065 7870  ream_name`, `exp
-00003e00: 6563 7465 645f 706f 7369 7469 6f6e 600a  ected_position`.
-00003e10: 616e 6420 6065 7665 6e74 7360 2e0a 0a54  and `events`...T
-00003e20: 6865 2060 7374 7265 616d 5f6e 616d 6560  he `stream_name`
-00003e30: 2061 7267 756d 656e 7420 6973 2072 6571   argument is req
-00003e40: 7569 7265 642c 2061 6e64 2069 7320 6578  uired, and is ex
-00003e50: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
-00003e60: 7974 686f 6e0a 6073 7472 6020 7468 6174  ython.`str` that
-00003e70: 2075 6e69 7175 656c 7920 6964 656e 7469   uniquely identi
-00003e80: 6669 6573 2074 6865 2073 7472 6561 6d20  fies the stream 
-00003e90: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-00003ea0: 0a0a 5468 6520 6065 7870 6563 7465 645f  ..The `expected_
-00003eb0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-00003ec0: 6e74 2069 7320 7265 7175 6972 6564 2c20  nt is required, 
-00003ed0: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-00003ee0: 653a 2060 4e6f 6e65 600a 6966 2065 7665  e: `None`.if eve
-00003ef0: 6e74 7320 6172 6520 6265 696e 6720 7772  nts are being wr
-00003f00: 6974 7465 6e20 746f 2061 206e 6577 2073  itten to a new s
-00003f10: 7472 6561 6d2c 2061 6e64 206f 7468 6572  tream, and other
-00003f20: 7769 7365 2061 6e20 5079 7468 6f6e 2060  wise an Python `
-00003f30: 696e 7460 0a65 7175 616c 2074 6f20 7468  int`.equal to th
-00003f40: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
-00003f50: 6520 7374 7265 616d 206f 6620 7468 6520  e stream of the 
-00003f60: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
-00003f70: 656e 7420 696e 2074 6865 2073 7472 6561  ent in the strea
-00003f80: 6d2e 0a0a 5468 6520 6065 7665 6e74 7360  m...The `events`
-00003f90: 2061 7267 756d 656e 7420 6973 2072 6571   argument is req
-00003fa0: 7569 7265 642c 2061 6e64 2069 7320 6578  uired, and is ex
-00003fb0: 7065 6374 6564 2074 6f20 6265 2061 2073  pected to be a s
-00003fc0: 6571 7565 6e63 6520 6f66 206e 6577 0a65  equence of new.e
-00003fd0: 7665 6e74 206f 626a 6563 7473 2074 6f20  vent objects to 
-00003fe0: 6265 2061 7070 656e 6465 6420 746f 2074  be appended to t
-00003ff0: 6865 206e 616d 6564 2073 7472 6561 6d2e  he named stream.
-00004000: 2054 6865 2060 4e65 7745 7665 6e74 6020   The `NewEvent` 
-00004010: 636c 6173 7320 7368 6f75 6c64 0a62 6520  class should.be 
-00004020: 7573 6564 2074 6f20 636f 6e73 7472 7563  used to construc
-00004030: 7420 6e65 7720 6576 656e 7420 6f62 6a65  t new event obje
-00004040: 6374 7320 2873 6565 2074 6865 204e 6f74  cts (see the Not
-00004050: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
-00004060: 2066 6f72 2064 6574 6169 6c73 0a6f 6620   for details.of 
-00004070: 7468 6973 2063 6c61 7373 292e 0a0a 5468  this class)...Th
-00004080: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
-00004090: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
-000040a0: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
-000040b0: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
-000040c0: 6e20 6066 6c6f 6174 6020 7468 6174 2073  n `float` that s
-000040d0: 6574 730a 6120 6465 6164 6c69 6e65 2066  ets.a deadline f
-000040e0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-000040f0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00004100: 6572 6174 696f 6e2e 0a0a 5374 7265 616d  eration...Stream
-00004110: 7320 6172 6520 6372 6561 7465 6420 6279  s are created by
-00004120: 2077 7269 7469 6e67 2065 7665 6e74 732e   writing events.
-00004130: 2054 6865 2063 6f72 7265 6374 2076 616c   The correct val
-00004140: 7565 206f 6620 7468 6520 6065 7870 6563  ue of the `expec
-00004150: 7465 645f 706f 7369 7469 6f6e 600a 6172  ted_position`.ar
-00004160: 6775 6d65 6e74 2077 6865 6e20 7772 6974  gument when writ
-00004170: 696e 6720 7468 6520 6669 7273 7420 6576  ing the first ev
-00004180: 656e 7420 6f66 2061 206e 6577 2073 7472  ent of a new str
-00004190: 6561 6d20 6973 2060 4e6f 6e65 602e 2050  eam is `None`. P
-000041a0: 6c65 6173 6520 6e6f 7465 2c20 6974 2069  lease note, it i
-000041b0: 730a 6e6f 7420 706f 7373 6962 6c65 2074  s.not possible t
-000041c0: 6f20 736f 6d65 686f 7720 6372 6561 7465  o somehow create
-000041d0: 2061 6e20 2265 6d70 7479 2220 7374 7265   an "empty" stre
-000041e0: 616d 2069 6e20 4576 656e 7453 746f 7265  am in EventStore
-000041f0: 4442 2e0a 0a54 6865 2073 7472 6561 6d20  DB...The stream 
-00004200: 706f 7369 7469 6f6e 7320 6f66 2072 6563  positions of rec
-00004210: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-00004220: 6120 7374 7265 616d 2073 7461 7274 2066  a stream start f
-00004230: 726f 6d20 7a65 726f 2c20 616e 6420 666f  rom zero, and fo
-00004240: 726d 2061 2067 6170 6c65 7373 0a73 6571  rm a gapless.seq
-00004250: 7565 6e63 6520 6f66 2069 6e74 6567 6572  uence of integer
-00004260: 732e 2054 6865 2073 7472 6561 6d20 706f  s. The stream po
-00004270: 7369 7469 6f6e 206f 6620 7468 6520 6669  sition of the fi
-00004280: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
-00004290: 6e74 2069 6e20 6120 7374 7265 616d 2069  nt in a stream i
-000042a0: 730a 6030 602e 2041 6e64 2073 6f20 7768  s.`0`. And so wh
-000042b0: 656e 2061 7070 656e 6469 6e67 2074 6865  en appending the
-000042c0: 2073 6563 6f6e 6420 6e65 7720 6576 656e   second new even
-000042d0: 7420 746f 2061 2073 7472 6561 6d20 7468  t to a stream th
-000042e0: 6174 2068 6173 206f 6e65 2072 6563 6f72  at has one recor
-000042f0: 6465 6420 6576 656e 742c 0a74 6865 2063  ded event,.the c
-00004300: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
-00004310: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-00004320: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00004330: 2069 7320 6030 602e 2053 696d 696c 6172   is `0`. Similar
-00004340: 6c79 2c20 7468 6520 7374 7265 616d 0a70  ly, the stream.p
-00004350: 6f73 6974 696f 6e20 6f66 2074 6865 2073  osition of the s
-00004360: 6563 6f6e 6420 7265 636f 7264 6564 2065  econd recorded e
-00004370: 7665 6e74 2069 6e20 6120 7374 7265 616d  vent in a stream
-00004380: 2069 7320 6031 602c 2061 6e64 2073 6f20   is `1`, and so 
-00004390: 7768 656e 2061 7070 656e 6469 6e67 2074  when appending t
-000043a0: 6865 0a74 6869 7264 206e 6577 2065 7665  he.third new eve
-000043b0: 6e74 2074 6f20 6120 7374 7265 616d 2074  nt to a stream t
-000043c0: 6861 7420 6861 7320 7477 6f20 7265 636f  hat has two reco
-000043d0: 7264 6564 2065 7665 6e74 732c 2074 6865  rded events, the
-000043e0: 2063 6f72 7265 6374 2076 616c 7565 206f   correct value o
-000043f0: 6620 7468 650a 6065 7870 6563 7465 645f  f the.`expected_
-00004400: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-00004410: 6e74 2069 7320 6031 602e 2041 6e64 2073  nt is `1`. And s
-00004420: 6f20 6f6e 2e2e 2e0a 0a49 6620 7468 6572  o on.....If ther
-00004430: 6520 6973 2061 206d 6973 6d61 7463 6820  e is a mismatch 
-00004440: 6265 7477 6565 6e20 7468 6520 6769 7665  between the give
-00004450: 6e20 7661 6c75 6520 6f66 2074 6865 2060  n value of the `
-00004460: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-00004470: 6e60 2061 7267 756d 656e 740a 616e 6420  n` argument.and 
-00004480: 7468 6520 706f 7369 7469 6f6e 206f 6620  the position of 
-00004490: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-000044a0: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
-000044b0: 6561 6d2c 2074 6865 6e20 616e 2060 4578  eam, then an `Ex
-000044c0: 7065 6374 6564 506f 7369 7469 6f6e 4572  pectedPositionEr
-000044d0: 726f 7260 0a65 7863 6570 7469 6f6e 2077  ror`.exception w
-000044e0: 696c 6c20 6265 2072 6169 7365 642e 2054  ill be raised. T
-000044f0: 6869 7320 6566 6665 6374 6976 656c 7920  his effectively 
-00004500: 6163 636f 6d70 6c69 7368 6573 206f 7074  accomplishes opt
-00004510: 696d 6973 7469 6320 636f 6e63 7572 7265  imistic concurre
-00004520: 6e63 7920 636f 6e74 726f 6c2e 0a0a 4966  ncy control...If
-00004530: 2079 6f75 2077 6973 6820 746f 2064 6973   you wish to dis
-00004540: 6162 6c65 206f 7074 696d 6973 7469 6320  able optimistic 
-00004550: 636f 6e63 7572 7265 6e63 7920 636f 6e74  concurrency cont
-00004560: 726f 6c20 7768 656e 2061 7070 656e 6469  rol when appendi
-00004570: 6e67 206e 6577 2065 7665 6e74 732c 2079  ng new events, y
-00004580: 6f75 0a63 616e 2073 6574 2074 6865 2060  ou.can set the `
-00004590: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-000045a0: 6e60 2074 6f20 6120 6e65 6761 7469 7665  n` to a negative
-000045b0: 2069 6e74 6567 6572 2e0a 0a49 6620 796f   integer...If yo
-000045c0: 7520 6e65 6564 2074 6f20 6469 7363 6f76  u need to discov
-000045d0: 6572 2074 6865 2063 7572 7265 6e74 2070  er the current p
-000045e0: 6f73 6974 696f 6e20 6f66 2074 6865 206c  osition of the l
-000045f0: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-00004600: 6e74 2069 6e20 6120 7374 7265 616d 2c0a  nt in a stream,.
-00004610: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
-00004620: 6067 6574 5f73 7472 6561 6d5f 706f 7369  `get_stream_posi
-00004630: 7469 6f6e 2829 6020 6d65 7468 6f64 2e0a  tion()` method..
-00004640: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
-00004650: 6520 6170 7065 6e64 2065 7665 6e74 7320  e append events 
-00004660: 6f70 6572 6174 696f 6e20 6973 2061 746f  operation is ato
-00004670: 6d69 632c 2073 6f20 7468 6174 2065 6974  mic, so that eit
-00004680: 6865 7220 616c 6c0a 6f72 206e 6f6e 6520  her all.or none 
-00004690: 6f66 2074 6865 2067 6976 656e 206e 6577  of the given new
-000046a0: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-000046b0: 7265 636f 7264 6564 2e20 4279 2064 6573  recorded. By des
-000046c0: 6967 6e2c 2069 7420 6973 206f 6e6c 790a  ign, it is only.
-000046d0: 706f 7373 6962 6c65 2077 6974 6820 4576  possible with Ev
-000046e0: 656e 7453 746f 7265 4442 2074 6f20 6174  entStoreDB to at
-000046f0: 6f6d 6963 616c 6c79 2072 6563 6f72 6420  omically record 
-00004700: 6e65 7720 6576 656e 7473 2069 6e20 6f6e  new events in on
-00004710: 6520 7374 7265 616d 2e0a 0a49 6e20 7468  e stream...In th
-00004720: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
-00004730: 2061 206e 6577 2065 7665 6e74 2069 7320   a new event is 
-00004740: 6170 7065 6e64 6564 2074 6f20 6120 6e65  appended to a ne
-00004750: 7720 7374 7265 616d 2e0a 0a60 6060 7079  w stream...```py
-00004760: 7468 6f6e 0a66 726f 6d20 7575 6964 2069  thon.from uuid i
-00004770: 6d70 6f72 7420 7575 6964 340a 0a66 726f  mport uuid4..fro
-00004780: 6d20 6573 6462 636c 6965 6e74 2069 6d70  m esdbclient imp
-00004790: 6f72 7420 4e65 7745 7665 6e74 0a0a 2320  ort NewEvent..# 
-000047a0: 436f 6e73 7472 7563 7420 6e65 7720 6576  Construct new ev
-000047b0: 656e 7420 6f62 6a65 6374 2e0a 6576 656e  ent object..even
-000047c0: 7431 203d 204e 6577 4576 656e 7428 7479  t1 = NewEvent(ty
-000047d0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
-000047e0: 272c 2064 6174 613d 6227 6461 7461 3127  ', data=b'data1'
-000047f0: 290a 0a23 2044 6566 696e 6520 7374 7265  )..# Define stre
-00004800: 616d 206e 616d 652e 0a73 7472 6561 6d5f  am name..stream_
-00004810: 6e61 6d65 3120 3d20 7374 7228 7575 6964  name1 = str(uuid
-00004820: 3428 2929 0a0a 2320 4170 7065 6e64 206c  4())..# Append l
-00004830: 6973 7420 6f66 2065 7665 6e74 7320 746f  ist of events to
-00004840: 206e 6577 2073 7472 6561 6d2e 0a63 6f6d   new stream..com
-00004850: 6d69 745f 706f 7369 7469 6f6e 3120 3d20  mit_position1 = 
-00004860: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-00004870: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-00004880: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00004890: 6531 2c0a 2020 2020 6578 7065 6374 6564  e1,.    expected
-000048a0: 5f70 6f73 6974 696f 6e3d 4e6f 6e65 2c0a  _position=None,.
-000048b0: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-000048c0: 7431 5d2c 0a29 0a60 6060 0a0a 496e 2074  t1],.).```..In t
-000048d0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-000048e0: 2c20 7477 6f20 7375 6273 6571 7565 6e74  , two subsequent
-000048f0: 2065 7665 6e74 7320 6172 6520 6170 7065   events are appe
-00004900: 6e64 6564 2074 6f20 616e 2065 7869 7374  nded to an exist
-00004910: 696e 670a 7374 7265 616d 2e0a 0a60 6060  ing.stream...```
-00004920: 7079 7468 6f6e 0a65 7665 6e74 3220 3d20  python.event2 = 
-00004930: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
-00004940: 7264 6572 5570 6461 7465 6427 2c20 6461  rderUpdated', da
-00004950: 7461 3d62 2764 6174 6132 2729 0a65 7665  ta=b'data2').eve
-00004960: 6e74 3320 3d20 4e65 7745 7665 6e74 2874  nt3 = NewEvent(t
-00004970: 7970 653d 274f 7264 6572 4465 6c65 7465  ype='OrderDelete
-00004980: 6427 2c20 6461 7461 3d62 2764 6174 6133  d', data=b'data3
-00004990: 2729 0a0a 636f 6d6d 6974 5f70 6f73 6974  ')..commit_posit
-000049a0: 696f 6e32 203d 2063 6c69 656e 742e 6170  ion2 = client.ap
-000049b0: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
-000049c0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-000049d0: 6561 6d5f 6e61 6d65 312c 0a20 2020 2065  eam_name1,.    e
-000049e0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-000049f0: 3d30 2c0a 2020 2020 6576 656e 7473 3d5b  =0,.    events=[
-00004a00: 6576 656e 7432 2c20 6576 656e 7433 5d2c  event2, event3],
-00004a10: 0a29 0a60 6060 0a0a 4966 2074 6865 206f  .).```..If the o
-00004a20: 7065 7261 7469 6f6e 2069 7320 7375 6363  peration is succ
-00004a30: 6573 7366 756c 2c20 7468 6973 206d 6574  essful, this met
-00004a40: 686f 6420 7265 7475 726e 7320 616e 2069  hod returns an i
-00004a50: 6e74 6567 6572 0a72 6570 7265 7365 6e74  nteger.represent
-00004a60: 696e 6720 7468 6520 6461 7461 6261 7365  ing the database
-00004a70: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-00004a80: 6e22 2061 7320 6974 2077 6173 2077 6865  n" as it was whe
-00004a90: 6e20 7468 6520 6f70 6572 6174 696f 6e0a  n the operation.
-00004aa0: 7761 7320 636f 6d70 6c65 7465 642e 0a0a  was completed...
-00004ab0: 4120 2263 6f6d 6d69 7420 706f 7369 7469  A "commit positi
-00004ac0: 6f6e 2220 6973 2061 206d 6f6e 6f74 6f6e  on" is a monoton
-00004ad0: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
-00004ae0: 6720 696e 7465 6765 7220 7265 7072 6573  g integer repres
-00004af0: 656e 7469 6e67 0a74 6865 2070 6f73 6974  enting.the posit
-00004b00: 696f 6e20 6f66 2074 6865 2072 6563 6f72  ion of the recor
-00004b10: 6465 6420 6576 656e 7420 696e 2061 2022  ded event in a "
-00004b20: 746f 7461 6c20 6f72 6465 7222 206f 6620  total order" of 
-00004b30: 616c 6c20 7265 636f 7264 6564 0a65 7665  all recorded.eve
-00004b40: 6e74 7320 696e 2074 6865 2064 6174 6162  nts in the datab
-00004b50: 6173 6520 6163 726f 7373 2061 6c6c 2073  ase across all s
-00004b60: 7472 6561 6d73 2e20 4974 2069 7320 7468  treams. It is th
-00004b70: 6520 6163 7475 616c 2070 6f73 6974 696f  e actual positio
-00004b80: 6e0a 6f66 2074 6865 2065 7665 6e74 2072  n.of the event r
-00004b90: 6563 6f72 6420 6f6e 2064 6973 6b2e 2049  ecord on disk. I
-00004ba0: 6e20 636f 6e73 6571 7565 6e63 652c 2074  n consequence, t
-00004bb0: 6865 2073 6571 7565 6e63 6520 6f66 2063  he sequence of c
-00004bc0: 6f6d 6d69 740a 706f 7369 7469 6f6e 7320  ommit.positions 
-00004bd0: 6973 206e 6f74 2067 6170 6c65 7373 2e20  is not gapless. 
-00004be0: 496e 6465 6564 2c20 7468 6572 6520 6172  Indeed, there ar
-00004bf0: 6520 7573 7561 6c6c 7920 6c61 7267 6520  e usually large 
-00004c00: 6469 6666 6572 656e 6365 730a 6265 7477  differences.betw
-00004c10: 6565 6e20 7468 6520 636f 6d6d 6974 2070  een the commit p
-00004c20: 6f73 6974 696f 6e73 206f 6620 7375 6363  ositions of succ
-00004c30: 6573 7369 7665 2072 6563 6f72 6465 6420  essive recorded 
-00004c40: 6576 656e 7473 2e0a 0a54 6865 2022 636f  events...The "co
-00004c50: 6d6d 6974 2070 6f73 6974 696f 6e22 2072  mmit position" r
-00004c60: 6574 7572 6e65 6420 6279 2060 6170 7065  eturned by `appe
-00004c70: 6e64 5f65 7665 6e74 7328 2960 2069 7320  nd_events()` is 
-00004c80: 7468 6174 206f 6620 7468 6520 6c61 7374  that of the last
-00004c90: 0a72 6563 6f72 6465 6420 6576 656e 7420  .recorded event 
-00004ca0: 696e 2074 6865 2067 6976 656e 2062 6174  in the given bat
-00004cb0: 6368 206f 6620 6e65 7720 6576 656e 7473  ch of new events
-00004cc0: 2e0a 0a54 6865 2022 636f 6d6d 6974 2070  ...The "commit p
-00004cd0: 6f73 6974 696f 6e22 2072 6574 7572 6e65  osition" returne
-00004ce0: 6420 696e 2074 6869 7320 7761 7920 6361  d in this way ca
-00004cf0: 6e20 7468 6572 6566 6f72 6520 6265 2075  n therefore be u
-00004d00: 7365 6420 746f 2077 6169 740a 666f 7220  sed to wait.for 
-00004d10: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
-00004d20: 706f 6e65 6e74 2074 6f20 6861 7665 2070  ponent to have p
-00004d30: 726f 6365 7373 6564 2061 6c6c 2074 6865  rocessed all the
-00004d40: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
-00004d50: 6520 7265 636f 7264 6564 2e0a 0a46 6f72  e recorded...For
-00004d60: 2065 7861 6d70 6c65 2c20 636f 6e73 6964   example, consid
-00004d70: 6572 2061 2075 7365 7220 696e 7465 7266  er a user interf
-00004d80: 6163 6520 636f 6d6d 616e 6420 7468 6174  ace command that
-00004d90: 2072 6573 756c 7473 2069 6e20 7468 6520   results in the 
-00004da0: 7265 636f 7264 696e 670a 6f66 206e 6577  recording.of new
-00004db0: 2065 7665 6e74 732c 2061 6e64 2061 2071   events, and a q
-00004dc0: 7565 7279 2069 6e74 6f20 616e 2065 7665  uery into an eve
-00004dd0: 6e74 7561 6c6c 7920 636f 6e73 6973 7465  ntually consiste
-00004de0: 6e74 206d 6174 6572 6961 6c69 7a65 640a  nt materialized.
-00004df0: 7669 6577 2069 6e20 6120 646f 776e 7374  view in a downst
-00004e00: 7265 616d 2063 6f6d 706f 6e65 6e74 2074  ream component t
-00004e10: 6861 7420 6973 2075 7064 6174 6564 2066  hat is updated f
-00004e20: 726f 6d20 7468 6573 6520 6576 656e 7473  rom these events
-00004e30: 2e20 4966 2074 6865 206e 6577 0a65 7665  . If the new.eve
-00004e40: 6e74 7320 6861 7665 206e 6f74 2079 6574  nts have not yet
-00004e50: 2062 6565 6e20 7072 6f63 6573 7365 642c   been processed,
-00004e60: 2074 6865 2076 6965 7720 776f 756c 6420   the view would 
-00004e70: 6265 2073 7461 6c65 2e20 5468 6520 2263  be stale. The "c
-00004e80: 6f6d 6d69 7420 706f 7369 7469 6f6e 220a  ommit position".
-00004e90: 6361 6e20 6265 2075 7365 6420 6279 2074  can be used by t
-00004ea0: 6865 2075 7365 7220 696e 7465 7266 6163  he user interfac
-00004eb0: 6520 746f 2070 6f6c 6c20 7468 6520 646f  e to poll the do
-00004ec0: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
-00004ed0: 6e74 2075 6e74 696c 2069 7420 6861 730a  nt until it has.
-00004ee0: 7072 6f63 6573 7365 6420 7468 6f73 6520  processed those 
-00004ef0: 6e65 7720 6576 656e 7473 2c20 6166 7465  new events, afte
-00004f00: 7220 7768 6963 6820 7469 6d65 2074 6865  r which time the
-00004f10: 2076 6965 7720 7769 6c6c 206e 6f74 2062   view will not b
-00004f20: 6520 7374 616c 652e 0a0a 0a23 2323 2041  e stale....### A
-00004f30: 7070 656e 6420 6576 656e 740a 0a2a 7265  ppend event..*re
-00004f40: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-00004f50: 5468 6520 6061 7070 656e 645f 6576 656e  The `append_even
-00004f60: 7428 2960 206d 6574 686f 6420 6361 6e20  t()` method can 
-00004f70: 6265 2075 7365 6420 746f 2077 7269 7465  be used to write
-00004f80: 2061 2073 696e 676c 6520 6e65 7720 6576   a single new ev
-00004f90: 656e 7420 746f 2061 2073 7472 6561 6d2e  ent to a stream.
-00004fa0: 0a0a 5468 7265 6520 6172 6775 6d65 6e74  ..Three argument
-00004fb0: 7320 6172 6520 7265 7175 6972 6564 2c20  s are required, 
-00004fc0: 6073 7472 6561 6d5f 6e61 6d65 602c 2060  `stream_name`, `
-00004fd0: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-00004fe0: 6e60 2061 6e64 2060 6576 656e 7460 2e0a  n` and `event`..
-00004ff0: 0a54 6869 7320 6d65 7468 6f64 2077 6f72  .This method wor
-00005000: 6b73 2069 6e20 7468 6520 7361 6d65 2077  ks in the same w
-00005010: 6179 2061 7320 6061 7070 656e 645f 6576  ay as `append_ev
-00005020: 656e 7473 2829 602c 2068 6f77 6576 6572  ents()`, however
-00005030: 2060 6576 656e 7460 2069 7320 6578 7065   `event` is expe
-00005040: 6374 6564 0a74 6f20 6265 2061 2073 696e  cted.to be a sin
-00005050: 676c 6520 604e 6577 4576 656e 7460 2e0a  gle `NewEvent`..
-00005060: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
-00005070: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-00005080: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00005090: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
-000050a0: 7468 6f6e 2060 666c 6f61 7460 2074 6861  thon `float` tha
-000050b0: 7420 7365 7473 0a61 2064 6561 646c 696e  t sets.a deadlin
-000050c0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-000050d0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-000050e0: 206f 7065 7261 7469 6f6e 2e0a 0a49 6620   operation...If 
-000050f0: 7468 6520 6f70 6572 6174 696f 6e20 6973  the operation is
-00005100: 2073 7563 6365 7373 6675 6c2c 2074 6869   successful, thi
-00005110: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
-00005120: 2061 6e20 696e 7465 6765 720a 7265 7072   an integer.repr
-00005130: 6573 656e 7469 6e67 2074 6865 2064 6174  esenting the dat
-00005140: 6162 6173 6520 2263 6f6d 6d69 7420 706f  abase "commit po
-00005150: 7369 7469 6f6e 2220 6173 2069 7420 7761  sition" as it wa
-00005160: 7320 7768 656e 2074 6865 206f 7065 7261  s when the opera
-00005170: 7469 6f6e 0a77 6173 2063 6f6d 706c 6574  tion.was complet
-00005180: 6564 2e0a 0a53 696e 6365 2074 6865 2068  ed...Since the h
-00005190: 616e 646c 696e 6720 6f66 2061 2063 6f6d  andling of a com
-000051a0: 6d61 6e64 2069 6e20 796f 7572 2061 7070  mand in your app
-000051b0: 6c69 6361 7469 6f6e 206d 6179 2072 6573  lication may res
-000051c0: 756c 7420 696e 206f 6e65 206f 7220 6d61  ult in one or ma
-000051d0: 6e79 0a6e 6577 2065 7665 6e74 732c 2061  ny.new events, a
-000051e0: 6e64 2074 6865 2072 6573 756c 7473 206f  nd the results o
-000051f0: 6620 6861 6e64 6c69 6e67 2061 2063 6f6d  f handling a com
-00005200: 6d61 6e64 2073 686f 756c 6420 6265 2072  mand should be r
-00005210: 6563 6f72 6465 6420 6174 6f6d 6963 616c  ecorded atomical
-00005220: 6c79 2c0a 616e 6420 7468 6520 7772 6974  ly,.and the writ
-00005230: 696e 6720 6f66 206e 6577 2065 7665 6e74  ing of new event
-00005240: 7320 6765 6e65 7261 7465 6420 6279 2061  s generated by a
-00005250: 2063 6f6d 6d61 6e64 2068 616e 646c 6572   command handler
-00005260: 2069 7320 7573 7561 6c6c 7920 6120 636f   is usually a co
-00005270: 6e63 6572 6e0a 7468 6174 2069 7320 6661  ncern.that is fa
-00005280: 6374 6f72 6564 206f 7574 2061 6e64 2075  ctored out and u
-00005290: 7365 6420 6576 6572 7977 6865 7265 2069  sed everywhere i
-000052a0: 6e20 6120 7072 6f6a 6563 742c 2069 7420  n a project, it 
-000052b0: 6973 206d 6f72 6520 7573 7561 6c20 696e  is more usual in
-000052c0: 2061 2070 726f 6a65 6374 0a74 6f20 7573   a project.to us
-000052d0: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
-000052e0: 2829 6020 746f 2072 6563 6f72 6420 6e65  ()` to record ne
-000052f0: 7720 6576 656e 7473 2e20 486f 7765 7665  w events. Howeve
-00005300: 722c 2074 6869 7320 6d65 7468 6f64 206d  r, this method m
-00005310: 6179 206f 6363 6173 696f 6e61 6c6c 790a  ay occasionally.
-00005320: 6265 2075 7365 6675 6c2c 2061 6e64 2069  be useful, and i
-00005330: 6e64 6565 6420 6974 2069 7320 7573 6564  ndeed it is used
-00005340: 2062 7920 6073 6574 5f73 7472 6561 6d5f   by `set_stream_
-00005350: 6d65 7461 6461 7461 2829 602e 0a0a 0a23  metadata()`....#
-00005360: 2323 2049 6465 6d70 6f74 656e 7420 6170  ## Idempotent ap
-00005370: 7065 6e64 206f 7065 7261 7469 6f6e 730a  pend operations.
-00005380: 0a53 6f6d 6574 696d 6573 2069 7420 6d61  .Sometimes it ma
-00005390: 7920 6861 7070 656e 2074 6861 742c 2077  y happen that, w
-000053a0: 6865 6e20 6361 6c6c 696e 6720 6061 7070  hen calling `app
-000053b0: 656e 645f 6576 656e 7473 2829 6020 6f72  end_events()` or
-000053c0: 2060 6170 7065 6e64 5f65 7665 6e74 2829   `append_event()
-000053d0: 602c 0a74 6865 206e 6577 2065 7665 6e74  `,.the new event
-000053e0: 7320 6172 6520 7375 6363 6573 7366 756c  s are successful
-000053f0: 6c79 2072 6563 6f72 6465 642c 2062 7574  ly recorded, but
-00005400: 2074 6865 6e20 736f 6d65 686f 7720 7468   then somehow th
-00005410: 6520 636f 6e6e 6563 7469 6f6e 2074 6f20  e connection to 
-00005420: 7468 650a 6461 7461 6261 7365 2067 6574  the.database get
-00005430: 7320 696e 7465 7272 7570 7465 6420 6265  s interrupted be
-00005440: 666f 7265 2074 6865 2073 7563 6365 7373  fore the success
-00005450: 6675 6c20 6361 6c6c 2063 616e 2072 6574  ful call can ret
-00005460: 7572 6e20 7375 6363 6573 7366 756c 6c79  urn successfully
-00005470: 2074 6f0a 7468 6520 636c 6965 6e74 2e20   to.the client. 
-00005480: 496e 2063 6173 6520 6f66 2061 6e20 6572  In case of an er
-00005490: 726f 7220 7768 656e 2061 7070 656e 6469  ror when appendi
-000054a0: 6e67 2061 6e20 6576 656e 742c 2069 7420  ng an event, it 
-000054b0: 6973 2064 6573 6972 6162 6c65 2074 6f0a  is desirable to.
-000054c0: 7265 7472 7920 6170 7065 6e64 696e 6720  retry appending 
-000054d0: 7468 6520 7361 6d65 2065 7665 6e74 2061  the same event a
-000054e0: 7420 7468 6520 7361 6d65 2070 6f73 6974  t the same posit
-000054f0: 696f 6e2e 2049 6620 7468 6520 6576 656e  ion. If the even
-00005500: 7420 7761 7320 696e 2066 6163 740a 7375  t was in fact.su
-00005510: 6363 6573 7366 756c 6c79 2072 6563 6f72  ccessfully recor
-00005520: 6465 642c 2069 7420 6973 2063 6f6e 7665  ded, it is conve
-00005530: 6e69 656e 7420 666f 7220 7468 6520 7265  nient for the re
-00005540: 7472 6965 6420 6f70 6572 6174 696f 6e20  tried operation 
-00005550: 746f 2072 6574 7572 6e0a 7375 6363 6573  to return.succes
-00005560: 7366 756c 6c79 2077 6974 686f 7574 2072  sfully without r
-00005570: 6169 7369 6e67 2061 6e20 6572 726f 7220  aising an error 
-00005580: 6475 6520 746f 206f 7074 696d 6973 7469  due to optimisti
-00005590: 6320 636f 6e63 7572 7265 6e63 7920 636f  c concurrency co
-000055a0: 6e74 726f 6c0a 2861 7320 6465 7363 7269  ntrol.(as descri
-000055b0: 6265 6420 6162 6f76 6529 2e0a 0a54 6865  bed above)...The
-000055c0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-000055d0: 686f 7773 2074 6865 2060 6170 7065 6e64  hows the `append
-000055e0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
-000055f0: 6420 6265 696e 6720 6361 6c6c 6564 2061  d being called a
-00005600: 6761 696e 2077 6974 680a 6065 7665 6e74  gain with.`event
-00005610: 3360 2061 6e64 2060 6578 7065 6374 6564  3` and `expected
-00005620: 5f70 6f73 6974 696f 6e3d 3260 2e20 5765  _position=2`. We
-00005630: 2063 616e 2073 6565 2074 6861 7420 7265   can see that re
-00005640: 7065 6174 696e 6720 7468 6520 6361 6c6c  peating the call
-00005650: 2074 6f0a 6061 7070 656e 645f 6576 656e   to.`append_even
-00005660: 7473 2829 6020 7265 7475 726e 7320 7375  ts()` returns su
-00005670: 6363 6573 7366 756c 6c79 2e0a 0a60 6060  ccessfully...```
-00005680: 7079 7468 6f6e 0a23 2052 6574 7279 2061  python.# Retry a
-00005690: 7070 656e 6469 6e67 2065 7665 6e74 332e  ppending event3.
-000056a0: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-000056b0: 5f72 6574 7279 203d 2063 6c69 656e 742e  _retry = client.
-000056c0: 6170 7065 6e64 5f65 7665 6e74 7328 0a20  append_events(. 
-000056d0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-000056e0: 7472 6561 6d5f 6e61 6d65 312c 0a20 2020  tream_name1,.   
-000056f0: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-00005700: 6f6e 3d30 2c0a 2020 2020 6576 656e 7473  on=0,.    events
-00005710: 3d5b 6576 656e 7432 2c20 6576 656e 7433  =[event2, event3
-00005720: 5d2c 0a29 0a60 6060 0a0a 5765 2063 616e  ],.).```..We can
-00005730: 2073 6565 2074 6861 7420 7468 6520 7361   see that the sa
-00005740: 6d65 2063 6f6d 6d69 7420 706f 7369 7469  me commit positi
-00005750: 6f6e 2069 7320 7265 7475 726e 6564 2061  on is returned a
-00005760: 7320 6162 6f76 652e 0a0a 6060 6070 7974  s above...```pyt
-00005770: 686f 6e0a 6173 7365 7274 2063 6f6d 6d69  hon.assert commi
-00005780: 745f 706f 7369 7469 6f6e 5f72 6574 7279  t_position_retry
-00005790: 203d 3d20 636f 6d6d 6974 5f70 6f73 6974   == commit_posit
-000057a0: 696f 6e32 0a60 6060 0a0a 4279 2063 616c  ion2.```..By cal
-000057b0: 6c69 6e67 2060 7265 6164 5f73 7472 6561  ling `read_strea
-000057c0: 6d5f 6576 656e 7473 2829 602c 2077 6520  m_events()`, we 
-000057d0: 6361 6e20 616c 736f 2073 6565 2074 6865  can also see the
-000057e0: 2073 7472 6561 6d20 6861 7320 6265 656e   stream has been
-000057f0: 2075 6e63 6861 6e67 6564 0a64 6573 7069   unchanged.despi
-00005800: 7465 2074 6865 2060 6170 7065 6e64 5f65  te the `append_e
-00005810: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
-00005820: 6861 7669 6e67 2062 6565 6e20 6361 6c6c  having been call
-00005830: 6564 2074 7769 6365 2077 6974 6820 7468  ed twice with th
-00005840: 6520 7361 6d65 2061 7267 756d 656e 7473  e same arguments
-00005850: 2e0a 5468 6174 2069 732c 2074 6865 7265  ..That is, there
-00005860: 2061 7265 2073 7469 6c6c 206f 6e6c 7920   are still only 
-00005870: 7468 7265 6520 6576 656e 7473 2069 6e20  three events in 
-00005880: 7468 6520 7374 7265 616d 2e0a 0a60 6060  the stream...```
-00005890: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
-000058a0: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
-000058b0: 616d 5f65 7665 6e74 7328 0a20 2020 2073  am_events(.    s
-000058c0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-000058d0: 6d5f 6e61 6d65 310a 290a 0a61 7373 6572  m_name1.)..asser
-000058e0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-000058f0: 2033 0a60 6060 0a0a 5468 6973 2069 6465   3.```..This ide
-00005900: 6d70 6f74 656e 7420 6265 6861 7669 6f75  mpotent behaviou
-00005910: 7220 6973 2061 6374 6976 6174 6564 2062  r is activated b
-00005920: 6563 6175 7365 2074 6865 2060 4e65 7745  ecause the `NewE
-00005930: 7665 6e74 6020 636c 6173 7320 6861 7320  vent` class has 
-00005940: 616e 2060 6964 600a 6174 7472 6962 7574  an `id`.attribut
-00005950: 6520 7468 6174 2c20 6279 2064 6566 6175  e that, by defau
-00005960: 6c74 2c20 6973 2061 7373 6967 6e65 6420  lt, is assigned 
-00005970: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
-00005980: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
-00005990: 7768 656e 2061 6e0a 696e 7374 616e 6365  when an.instance
-000059a0: 206f 6620 604e 6577 4576 656e 7460 2069   of `NewEvent` i
-000059b0: 7320 636f 6e73 7472 7563 7465 642e 2049  s constructed. I
-000059c0: 6620 6576 656e 7473 2077 6974 6820 7468  f events with th
-000059d0: 6520 7361 6d65 2060 6964 6020 6172 6520  e same `id` are 
-000059e0: 6170 7065 6e64 6564 0a61 7420 7468 6520  appended.at the 
-000059f0: 7361 6d65 2060 6578 7065 6374 6564 5f70  same `expected_p
-00005a00: 6f73 6974 696f 6e60 2c20 7468 6520 7374  osition`, the st
-00005a10: 7265 616d 2077 696c 6c20 6265 2075 6e63  ream will be unc
-00005a20: 6861 6e67 6564 2c20 7468 6520 6f70 6572  hanged, the oper
-00005a30: 6174 696f 6e20 7769 6c6c 0a63 6f6d 706c  ation will.compl
-00005a40: 6574 6520 7375 6363 6573 7366 756c 6c79  ete successfully
-00005a50: 2c20 616e 6420 7468 6520 7361 6d65 2063  , and the same c
-00005a60: 6f6d 6d69 7420 706f 7369 7469 6f6e 2077  ommit position w
-00005a70: 696c 6c20 6265 2072 6574 7572 6e65 6420  ill be returned 
-00005a80: 746f 2074 6865 2063 616c 6c65 722e 0a0a  to the caller...
-00005a90: 6060 6070 7974 686f 6e0a 6672 6f6d 2075  ```python.from u
-00005aa0: 7569 6420 696d 706f 7274 2055 5549 440a  uid import UUID.
-00005ab0: 0a0a 6173 7365 7274 2069 7369 6e73 7461  ..assert isinsta
-00005ac0: 6e63 6528 6576 656e 7431 2e69 642c 2055  nce(event1.id, U
-00005ad0: 5549 4429 0a61 7373 6572 7420 6973 696e  UID).assert isin
-00005ae0: 7374 616e 6365 2865 7665 6e74 322e 6964  stance(event2.id
-00005af0: 2c20 5555 4944 290a 6173 7365 7274 2069  , UUID).assert i
-00005b00: 7369 6e73 7461 6e63 6528 6576 656e 7433  sinstance(event3
-00005b10: 2e69 642c 2055 5549 4429 0a0a 6173 7365  .id, UUID)..asse
-00005b20: 7274 2065 7665 6e74 312e 6964 2021 3d20  rt event1.id != 
-00005b30: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
-00005b40: 2065 7665 6e74 322e 6964 2021 3d20 6576   event2.id != ev
-00005b50: 656e 7433 2e69 640a 0a61 7373 6572 7420  ent3.id..assert 
-00005b60: 6576 656e 7473 5b30 5d2e 6964 203d 3d20  events[0].id == 
-00005b70: 6576 656e 7431 2e69 640a 6173 7365 7274  event1.id.assert
-00005b80: 2065 7665 6e74 735b 315d 2e69 6420 3d3d   events[1].id ==
-00005b90: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
-00005ba0: 7420 6576 656e 7473 5b32 5d2e 6964 203d  t events[2].id =
-00005bb0: 3d20 6576 656e 7433 2e69 640a 6060 600a  = event3.id.```.
-00005bc0: 0a49 7420 6973 2070 6f73 7369 626c 6520  .It is possible 
-00005bd0: 746f 2073 6574 2074 6865 2060 6964 6020  to set the `id` 
-00005be0: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
-00005bf0: 6d65 6e74 206f 6620 604e 6577 4576 656e  ment of `NewEven
-00005c00: 7460 2077 6865 6e20 696e 7374 616e 7469  t` when instanti
-00005c10: 6174 696e 670a 7468 6520 604e 6577 4576  ating.the `NewEv
-00005c20: 656e 7460 2063 6c61 7373 2c20 6275 7420  ent` class, but 
-00005c30: 696e 2074 6865 2065 7861 6d70 6c65 7320  in the examples 
-00005c40: 6162 6f76 6520 7765 2068 6176 6520 6265  above we have be
-00005c50: 656e 2075 7369 6e67 2074 6865 2064 6566  en using the def
-00005c60: 6175 6c74 0a62 6568 6176 696f 7572 2c20  ault.behaviour, 
-00005c70: 7768 6963 6820 6973 2074 6861 7420 7468  which is that th
-00005c80: 6520 6069 6460 2076 616c 7565 2069 7320  e `id` value is 
-00005c90: 6765 6e65 7261 7465 6420 7768 656e 2074  generated when t
-00005ca0: 6865 2060 4e65 7745 7665 6e74 6020 636c  he `NewEvent` cl
-00005cb0: 6173 7320 6973 0a69 6e73 7461 6e74 6961  ass is.instantia
-00005cc0: 7465 642e 0a0a 0a23 2323 2052 6561 6420  ted....### Read 
-00005cd0: 7374 7265 616d 2065 7665 6e74 730a 0a54  stream events..T
-00005ce0: 6865 2060 7265 6164 5f73 7472 6561 6d5f  he `read_stream_
-00005cf0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
-00005d00: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00005d10: 6f62 7461 696e 2074 6865 2072 6563 6f72  obtain the recor
-00005d20: 6465 6420 6576 656e 7473 2069 6e20 610a  ded events in a.
-00005d30: 7374 7265 616d 2e20 4974 2072 6574 7572  stream. It retur
-00005d40: 6e73 2061 2073 6571 7565 6e63 6520 6f66  ns a sequence of
-00005d50: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00005d60: 206f 626a 6563 7473 2e20 5468 6520 7265   objects. The re
-00005d70: 6365 6976 6564 2072 6563 6f72 6465 6420  ceived recorded 
-00005d80: 6576 656e 740a 6f62 6a65 6374 2061 7265  event.object are
-00005d90: 2069 6e73 7461 6e63 6573 206f 6620 7468   instances of th
-00005da0: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
-00005db0: 6020 636c 6173 7320 2873 6565 2074 6865  ` class (see the
-00005dc0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-00005dd0: 656c 6f77 2066 6f72 0a64 6574 6169 6c73  elow for.details
-00005de0: 206f 6620 7468 6973 2063 6c61 7373 292e   of this class).
-00005df0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
-00005e00: 7320 6f6e 6520 7265 7175 6972 6564 2061  s one required a
-00005e10: 7267 756d 656e 742c 2060 7374 7265 616d  rgument, `stream
-00005e20: 5f6e 616d 6560 2c20 7768 6963 6820 6973  _name`, which is
-00005e30: 2074 6865 206e 616d 6520 6f66 0a74 6865   the name of.the
-00005e40: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
-00005e50: 6368 2074 6f20 7265 6164 2065 7665 6e74  ch to read event
-00005e60: 732e 2042 7920 6465 6661 756c 742c 2074  s. By default, t
-00005e70: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00005e80: 7473 2069 6e20 7468 650a 7374 7265 616d  ts in the.stream
-00005e90: 2061 7265 2072 6574 7572 6e65 6420 696e   are returned in
-00005ea0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
-00005eb0: 7765 7265 2072 6563 6f72 6465 642e 0a0a  were recorded...
-00005ec0: 5468 6520 6d65 7468 6f64 2060 7265 6164  The method `read
-00005ed0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00005ee0: 6020 616c 736f 2073 7570 706f 7274 7320  ` also supports 
-00005ef0: 666f 7572 206f 7074 696f 6e61 6c20 6172  four optional ar
-00005f00: 6775 6d65 6e74 732c 0a60 7374 7265 616d  guments,.`stream
-00005f10: 5f70 6f73 6974 696f 6e60 2c20 6062 6163  _position`, `bac
-00005f20: 6b77 6172 6473 602c 2060 6c69 6d69 7460  kwards`, `limit`
-00005f30: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
-00005f40: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00005f50: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-00005f60: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
-00005f70: 6f70 7469 6f6e 616c 2069 6e74 6567 6572  optional integer
-00005f80: 2074 6861 7420 6361 6e20 6265 2075 7365   that can be use
-00005f90: 6420 746f 0a69 6e64 6963 6174 6520 7468  d to.indicate th
-00005fa0: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
-00005fb0: 6520 7374 7265 616d 2066 726f 6d20 7768  e stream from wh
-00005fc0: 6963 6820 746f 2073 7461 7274 2072 6561  ich to start rea
-00005fd0: 6469 6e67 2e20 5468 6973 2061 7267 756d  ding. This argum
-00005fe0: 656e 7420 6973 0a60 4e6f 6e65 6020 6279  ent is.`None` by
-00005ff0: 2064 6566 6175 6c74 2c20 7768 6963 6820   default, which 
-00006000: 6d65 616e 7320 7468 6520 7374 7265 616d  means the stream
-00006010: 2077 696c 6c20 6265 2072 6561 6420 6569   will be read ei
-00006020: 7468 6572 2066 726f 6d20 7468 6520 7374  ther from the st
-00006030: 6172 7420 6f66 2074 6865 0a73 7472 6561  art of the.strea
-00006040: 6d20 2874 6865 2064 6566 6175 6c74 2062  m (the default b
-00006050: 6568 6176 696f 7572 292c 206f 7220 6672  ehaviour), or fr
-00006060: 6f6d 2074 6865 2065 6e64 206f 6620 7468  om the end of th
-00006070: 6520 7374 7265 616d 2069 6620 6062 6163  e stream if `bac
-00006080: 6b77 6172 6473 6020 6973 0a60 5472 7565  kwards` is.`True
-00006090: 602e 2057 6865 6e20 7265 6164 696e 6720  `. When reading 
-000060a0: 6120 7374 7265 616d 2066 726f 6d20 6120  a stream from a 
-000060b0: 7370 6563 6966 6963 2070 6f73 6974 696f  specific positio
-000060c0: 6e20 696e 2074 6865 2073 7472 6561 6d2c  n in the stream,
-000060d0: 2074 6865 0a72 6563 6f72 6465 6420 6576   the.recorded ev
-000060e0: 656e 7420 6174 2074 6861 7420 706f 7369  ent at that posi
-000060f0: 7469 6f6e 2077 696c 6c20 6265 2069 6e63  tion will be inc
-00006100: 6c75 6465 642c 2062 6f74 6820 7768 656e  luded, both when
-00006110: 2072 6561 6469 6e67 2066 6f72 7761 7264   reading forward
-00006120: 730a 6672 6f6d 2074 6861 7420 706f 7369  s.from that posi
-00006130: 7469 6f6e 2c20 616e 6420 7768 656e 2072  tion, and when r
-00006140: 6561 6469 6e67 2062 6163 6b77 6172 6473  eading backwards
-00006150: 2066 726f 6d20 7468 6174 2070 6f73 6974   from that posit
-00006160: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
-00006170: 616c 2060 6261 636b 7761 7264 7360 2061  al `backwards` a
-00006180: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00006190: 686f 6e20 6062 6f6f 6c60 2e20 5468 6520  hon `bool`. The 
-000061a0: 6465 6661 756c 7420 6973 2060 4661 6c73  default is `Fals
-000061b0: 6560 2c20 7768 6963 680a 6d65 616e 7320  e`, which.means 
-000061c0: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
-000061d0: 6265 2072 6561 6420 666f 7277 6172 6473  be read forwards
-000061e0: 2062 7920 6465 6661 756c 742c 2073 6f20   by default, so 
-000061f0: 7468 6174 2065 7665 6e74 7320 6172 6520  that events are 
-00006200: 7265 7475 726e 6564 2069 6e20 7468 650a  returned in the.
-00006210: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
-00006220: 6170 7065 6e64 6564 2c20 4966 2060 6261  appended, If `ba
-00006230: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
-00006240: 6560 2c20 7468 6520 6576 656e 7473 2061  e`, the events a
-00006250: 7265 2072 6574 7572 6e65 6420 696e 2072  re returned in r
-00006260: 6576 6572 7365 0a6f 7264 6572 2e0a 0a54  everse.order...T
-00006270: 6865 206f 7074 696f 6e61 6c20 606c 696d  he optional `lim
-00006280: 6974 6020 6172 6775 6d65 6e74 2069 7320  it` argument is 
-00006290: 616e 2069 6e74 6567 6572 2077 6869 6368  an integer which
-000062a0: 2072 6573 7472 6963 7473 2074 6865 206e   restricts the n
-000062b0: 756d 6265 7220 6f66 2065 7665 6e74 7320  umber of events 
-000062c0: 7468 6174 0a77 696c 6c20 6265 2072 6574  that.will be ret
-000062d0: 7572 6e65 642e 2054 6865 2064 6566 6175  urned. The defau
-000062e0: 6c74 2076 616c 7565 2069 7320 6073 7973  lt value is `sys
-000062f0: 2e6d 6178 696e 7460 2e0a 0a54 6865 206f  .maxint`...The o
-00006300: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-00006310: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00006320: 5079 7468 6f6e 2060 666c 6f61 7460 2077  Python `float` w
-00006330: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
-00006340: 6c69 6e65 2066 6f72 0a74 6865 2063 6f6d  line for.the com
-00006350: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00006360: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
-00006370: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-00006380: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
-00006390: 6561 6420 7468 6520 7265 636f 7264 6564  ead the recorded
-000063a0: 2065 7665 6e74 7320 6f66 2061 2073 7472   events of a str
-000063b0: 6561 6d0a 666f 7277 6172 6473 2066 726f  eam.forwards fro
-000063c0: 6d20 7468 6520 7374 6172 7420 6f66 2074  m the start of t
-000063d0: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
-000063e0: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
-000063f0: 616d 2e20 5468 650a 6e61 6d65 206f 6620  am. The.name of 
-00006400: 6120 7374 7265 616d 2069 7320 6769 7665  a stream is give
-00006410: 6e20 7768 656e 2063 616c 6c69 6e67 2074  n when calling t
-00006420: 6865 206d 6574 686f 642e 0a0a 6060 6070  he method...```p
-00006430: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
-00006440: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
-00006450: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
-00006460: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00006470: 5f6e 616d 6531 0a29 0a60 6060 0a0a 4e6f  _name1.).```..No
-00006480: 7720 7468 6174 2077 6520 6861 7665 2061  w that we have a
-00006490: 2073 6571 7565 6e63 6520 6f66 2065 7665   sequence of eve
-000064a0: 6e74 206f 626a 6563 7473 2c20 7765 2063  nt objects, we c
-000064b0: 616e 2063 6865 636b 2077 6520 676f 7420  an check we got 
-000064c0: 7468 650a 7468 7265 6520 6576 656e 7473  the.three events
-000064d0: 2074 6861 7420 7765 7265 2061 7070 656e   that were appen
-000064e0: 6465 6420 746f 2074 6865 2073 7472 6561  ded to the strea
-000064f0: 6d2c 2061 6e64 2074 6861 7420 7468 6579  m, and that they
-00006500: 2061 7265 0a6f 7264 6572 6564 2065 7861   are.ordered exa
-00006510: 6374 6c79 2061 7320 7468 6579 2077 6572  ctly as they wer
-00006520: 6520 6170 7065 6e64 6564 2e0a 0a60 6060  e appended...```
-00006530: 7079 7468 6f6e 0a61 7373 6572 7420 6c65  python.assert le
-00006540: 6e28 6576 656e 7473 2920 3d3d 2033 0a0a  n(events) == 3..
-00006550: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006560: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00006570: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00006580: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
-00006590: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-000065a0: 2030 0a61 7373 6572 7420 6576 656e 7473   0.assert events
-000065b0: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-000065c0: 7431 2e74 7970 650a 6173 7365 7274 2065  t1.type.assert e
-000065d0: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
-000065e0: 2065 7665 6e74 312e 6461 7461 0a0a 6173   event1.data..as
-000065f0: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-00006600: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00006610: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-00006620: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
-00006630: 616d 5f70 6f73 6974 696f 6e20 3d3d 2031  am_position == 1
-00006640: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00006650: 5d2e 7479 7065 203d 3d20 6576 656e 7432  ].type == event2
-00006660: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00006670: 6e74 735b 315d 2e64 6174 6120 3d3d 2065  nts[1].data == e
-00006680: 7665 6e74 322e 6461 7461 0a0a 6173 7365  vent2.data..asse
-00006690: 7274 2065 7665 6e74 735b 325d 2e73 7472  rt events[2].str
-000066a0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-000066b0: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
-000066c0: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
-000066d0: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a61  _position == 2.a
-000066e0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-000066f0: 7479 7065 203d 3d20 6576 656e 7433 2e74  type == event3.t
-00006700: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
-00006710: 735b 325d 2e64 6174 6120 3d3d 2065 7665  s[2].data == eve
-00006720: 6e74 332e 6461 7461 0a60 6060 0a0a 5468  nt3.data.```..Th
-00006730: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00006740: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-00006750: 6420 7265 636f 7264 6564 2065 7665 6e74  d recorded event
-00006760: 7320 696e 2061 2073 7472 6561 6d20 666f  s in a stream fo
-00006770: 7277 6172 6473 2066 726f 6d0a 6120 7370  rwards from.a sp
-00006780: 6563 6966 6963 2073 7472 6561 6d20 706f  ecific stream po
-00006790: 7369 7469 6f6e 2074 6f20 7468 6520 656e  sition to the en
-000067a0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-000067b0: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
-000067c0: 7473 203d 2063 6c69 656e 742e 7265 6164  ts = client.read
-000067d0: 5f73 7472 6561 6d5f 6576 656e 7473 280a  _stream_events(.
-000067e0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-000067f0: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
-00006800: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
-00006810: 6e3d 312c 0a29 0a0a 6173 7365 7274 206c  n=1,.)..assert l
-00006820: 656e 2865 7665 6e74 7329 203d 3d20 320a  en(events) == 2.
-00006830: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006840: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00006850: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-00006860: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00006870: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-00006880: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
-00006890: 735b 305d 2e74 7970 6520 3d3d 2065 7665  s[0].type == eve
-000068a0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
-000068b0: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
-000068c0: 3d20 6576 656e 7432 2e64 6174 610a 0a61  = event2.data..a
-000068d0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-000068e0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-000068f0: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-00006900: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00006910: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00006920: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
-00006930: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
-00006940: 332e 7479 7065 0a61 7373 6572 7420 6576  3.type.assert ev
-00006950: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-00006960: 6576 656e 7433 2e64 6174 610a 6060 600a  event3.data.```.
-00006970: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-00006980: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-00006990: 7265 6164 2074 6865 2072 6563 6f72 6465  read the recorde
-000069a0: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
-000069b0: 7265 616d 2062 6163 6b77 6172 6473 2066  ream backwards f
-000069c0: 726f 6d0a 7468 6520 656e 6420 6f66 2074  rom.the end of t
-000069d0: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
-000069e0: 2073 7461 7274 206f 6620 7468 6520 7374   start of the st
-000069f0: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
-00006a00: 0a65 7665 6e74 7320 3d20 636c 6965 6e74  .events = client
-00006a10: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
-00006a20: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-00006a30: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00006a40: 312c 0a20 2020 2062 6163 6b77 6172 6473  1,.    backwards
-00006a50: 3d54 7275 652c 0a29 0a0a 6173 7365 7274  =True,.)..assert
-00006a60: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-00006a70: 330a 0a61 7373 6572 7420 6576 656e 7473  3..assert events
-00006a80: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
-00006a90: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
-00006aa0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006ab0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-00006ac0: 203d 3d20 320a 6173 7365 7274 2065 7665   == 2.assert eve
-00006ad0: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
-00006ae0: 7665 6e74 332e 7479 7065 0a61 7373 6572  vent3.type.asser
-00006af0: 7420 6576 656e 7473 5b30 5d2e 6461 7461  t events[0].data
-00006b00: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
-00006b10: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00006b20: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00006b30: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-00006b40: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-00006b50: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-00006b60: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
-00006b70: 735b 315d 2e74 7970 6520 3d3d 2065 7665  s[1].type == eve
-00006b80: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
-00006b90: 6576 656e 7473 5b31 5d2e 6461 7461 203d  events[1].data =
-00006ba0: 3d20 6576 656e 7432 2e64 6174 610a 6060  = event2.data.``
-00006bb0: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
-00006bc0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-00006bd0: 6f20 7265 6164 2061 206c 696d 6974 6564  o read a limited
-00006be0: 206e 756d 6265 7220 2874 776f 2920 6f66   number (two) of
-00006bf0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00006c00: 656e 7473 0a69 6e20 6120 7374 7265 616d  ents.in a stream
-00006c10: 2066 6f72 7761 7264 7320 6672 6f6d 2074   forwards from t
-00006c20: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
-00006c30: 7374 7265 616d 2e0a 0a60 6060 7079 7468  stream...```pyth
-00006c40: 6f6e 0a65 7665 6e74 7320 3d20 636c 6965  on.events = clie
-00006c50: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
-00006c60: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-00006c70: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00006c80: 6d65 312c 0a20 2020 206c 696d 6974 3d32  me1,.    limit=2
-00006c90: 2c0a 290a 0a61 7373 6572 7420 6c65 6e28  ,.)..assert len(
-00006ca0: 6576 656e 7473 2920 3d3d 2032 0a0a 6173  events) == 2..as
-00006cb0: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00006cc0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00006cd0: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-00006ce0: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00006cf0: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
-00006d00: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006d10: 5d2e 7479 7065 203d 3d20 6576 656e 7431  ].type == event1
-00006d20: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00006d30: 6e74 735b 305d 2e64 6174 6120 3d3d 2065  nts[0].data == e
-00006d40: 7665 6e74 312e 6461 7461 0a0a 6173 7365  vent1.data..asse
-00006d50: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00006d60: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-00006d70: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
-00006d80: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
-00006d90: 5f70 6f73 6974 696f 6e20 3d3d 2031 0a61  _position == 1.a
-00006da0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-00006db0: 7479 7065 203d 3d20 6576 656e 7432 2e74  type == event2.t
-00006dc0: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
-00006dd0: 735b 315d 2e64 6174 6120 3d3d 2065 7665  s[1].data == eve
-00006de0: 6e74 322e 6461 7461 0a60 6060 0a0a 5468  nt2.data.```..Th
-00006df0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00006e00: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-00006e10: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
-00006e20: 6572 2028 6f6e 6529 206f 6620 7468 6520  er (one) of the 
-00006e30: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
-00006e40: 696e 2061 2073 7472 6561 6d20 6261 636b  in a stream back
-00006e50: 7761 7264 7320 6672 6f6d 2061 2067 6976  wards from a giv
-00006e60: 656e 2073 7472 6561 6d20 706f 7369 7469  en stream positi
-00006e70: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
-00006e80: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-00006e90: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-00006ea0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-00006eb0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
-00006ec0: 0a20 2020 2073 7472 6561 6d5f 706f 7369  .    stream_posi
-00006ed0: 7469 6f6e 3d32 2c0a 2020 2020 6261 636b  tion=2,.    back
-00006ee0: 7761 7264 733d 5472 7565 2c0a 2020 2020  wards=True,.    
-00006ef0: 6c69 6d69 743d 312c 0a29 0a0a 6173 7365  limit=1,.)..asse
-00006f00: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-00006f10: 3d20 310a 0a61 7373 6572 7420 6576 656e  = 1..assert even
-00006f20: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
-00006f30: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00006f40: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-00006f50: 305d 2e73 7472 6561 6d5f 706f 7369 7469  0].stream_positi
-00006f60: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
-00006f70: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
-00006f80: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
-00006f90: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-00006fa0: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
-00006fb0: 610a 6060 600a 0a54 6865 2060 7265 6164  a.```..The `read
-00006fc0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00006fd0: 6020 6d65 7468 6f64 2077 696c 6c20 7261  ` method will ra
-00006fe0: 6973 6520 6120 604e 6f74 466f 756e 6460  ise a `NotFound`
-00006ff0: 2065 7863 6570 7469 6f6e 2069 6620 7468   exception if th
-00007000: 6520 7374 7265 616d 0a64 6f65 7320 6e6f  e stream.does no
-00007010: 7420 6578 6973 742e 0a0a 6060 6070 7974  t exist...```pyt
-00007020: 686f 6e0a 6672 6f6d 2065 7364 6263 6c69  hon.from esdbcli
-00007030: 656e 742e 6578 6365 7074 696f 6e73 2069  ent.exceptions i
-00007040: 6d70 6f72 7420 4e6f 7446 6f75 6e64 0a0a  mport NotFound..
-00007050: 0a74 7279 3a0a 2020 2020 636c 6965 6e74  .try:.    client
-00007060: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
-00007070: 6e74 7328 276e 6f74 2d61 2d73 7472 6561  nts('not-a-strea
-00007080: 6d27 290a 6578 6365 7074 204e 6f74 466f  m').except NotFo
-00007090: 756e 643a 0a20 2020 2070 6173 7320 2023  und:.    pass  #
-000070a0: 2054 6865 2073 7472 6561 6d20 276e 6f74   The stream 'not
-000070b0: 2d61 2d73 7472 6561 6d27 2064 6f65 7320  -a-stream' does 
-000070c0: 6e6f 7420 6578 6973 742e 0a65 6c73 653a  not exist..else:
-000070d0: 0a20 2020 2072 6169 7365 2045 7863 6570  .    raise Excep
-000070e0: 7469 6f6e 2822 5368 6f75 6c64 6e27 7420  tion("Shouldn't 
-000070f0: 6765 7420 6865 7265 2229 0a60 6060 0a0a  get here").```..
-00007100: 2323 2320 486f 7720 746f 2069 6d70 6c65  ### How to imple
-00007110: 6d65 6e74 2073 6e61 7073 686f 7474 696e  ment snapshottin
-00007120: 6720 7769 7468 2045 7665 6e74 5374 6f72  g with EventStor
-00007130: 6544 420a 0a45 7665 6e74 2d73 6f75 7263  eDB..Event-sourc
-00007140: 6564 2061 6767 7265 6761 7465 7320 6172  ed aggregates ar
-00007150: 6520 7479 7069 6361 6c6c 7920 7265 636f  e typically reco
-00007160: 6e73 7472 7563 7465 6420 6672 6f6d 2072  nstructed from r
-00007170: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
-00007180: 7920 6361 6c6c 696e 670a 6120 6d75 7461  y calling.a muta
-00007190: 746f 7220 6675 6e63 7469 6f6e 2066 6f72  tor function for
-000071a0: 2065 6163 6820 7265 636f 7264 6564 2065   each recorded e
-000071b0: 7665 6e74 2c20 6576 6f6c 7669 6e67 2066  vent, evolving f
-000071c0: 726f 6d20 616e 2069 6e69 7469 616c 2073  rom an initial s
-000071d0: 7461 7465 0a60 4e6f 6e65 6020 746f 2074  tate.`None` to t
-000071e0: 6865 2063 7572 7265 6e74 2073 7461 7465  he current state
-000071f0: 206f 6620 7468 6520 6167 6772 6567 6174   of the aggregat
-00007200: 652e 2054 6865 2066 756e 6374 696f 6e20  e. The function 
-00007210: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
-00007220: 6020 7368 6f77 730a 686f 7720 7468 6973  ` shows.how this
-00007230: 2063 616e 2062 6520 646f 6e65 2e20 5468   can be done. Th
-00007240: 6520 6167 6772 6567 6174 6520 4944 2069  e aggregate ID i
-00007250: 7320 7573 6564 2061 7320 6120 7374 7265  s used as a stre
-00007260: 616d 206e 616d 652e 2054 6865 2065 7863  am name. The exc
-00007270: 6570 7469 6f6e 0a60 4167 6772 6567 6174  eption.`Aggregat
-00007280: 654e 6f74 466f 756e 6460 2069 7320 7261  eNotFound` is ra
-00007290: 6973 6564 2069 6620 7468 6520 6167 6772  ised if the aggr
-000072a0: 6567 6174 6520 7374 7265 616d 2069 7320  egate stream is 
-000072b0: 6e6f 7420 666f 756e 642e 0a0a 6060 6070  not found...```p
-000072c0: 7974 686f 6e0a 6465 6620 6765 745f 6167  ython.def get_ag
-000072d0: 6772 6567 6174 6528 6167 6772 6567 6174  gregate(aggregat
-000072e0: 655f 6964 2c20 6d75 7461 746f 725f 6675  e_id, mutator_fu
-000072f0: 6e63 293a 0a20 2020 2073 7472 6561 6d5f  nc):.    stream_
-00007300: 6e61 6d65 203d 2061 6767 7265 6761 7465  name = aggregate
-00007310: 5f69 640a 0a20 2020 2023 2047 6574 2072  _id..    # Get r
-00007320: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
-00007330: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00007340: 2065 7665 6e74 7320 3d20 636c 6965 6e74   events = client
-00007350: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
-00007360: 6e74 7328 0a20 2020 2020 2020 2020 2020  nts(.           
-00007370: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00007380: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
-00007390: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
-000073a0: 6974 696f 6e3d 4e6f 6e65 0a20 2020 2020  ition=None.     
-000073b0: 2020 2029 0a20 2020 2065 7863 6570 7420     ).    except 
-000073c0: 4e6f 7446 6f75 6e64 2061 7320 653a 0a20  NotFound as e:. 
-000073d0: 2020 2020 2020 2072 6169 7365 2041 6767         raise Agg
-000073e0: 7265 6761 7465 4e6f 7446 6f75 6e64 2861  regateNotFound(a
-000073f0: 6767 7265 6761 7465 5f69 6429 2066 726f  ggregate_id) fro
-00007400: 6d20 650a 2020 2020 656c 7365 3a0a 2020  m e.    else:.  
-00007410: 2020 2020 2020 2320 5265 636f 6e73 7472        # Reconstr
-00007420: 7563 7420 6167 6772 6567 6174 6520 6672  uct aggregate fr
-00007430: 6f6d 2072 6563 6f72 6465 6420 6576 656e  om recorded even
-00007440: 7473 2e0a 2020 2020 2020 2020 6167 6772  ts..        aggr
-00007450: 6567 6174 6520 3d20 4e6f 6e65 0a20 2020  egate = None.   
-00007460: 2020 2020 2066 6f72 2065 7665 6e74 2069       for event i
-00007470: 6e20 6576 656e 7473 3a0a 2020 2020 2020  n events:.      
-00007480: 2020 2020 2020 6167 6772 6567 6174 6520        aggregate 
-00007490: 3d20 6d75 7461 746f 725f 6675 6e63 2861  = mutator_func(a
-000074a0: 6767 7265 6761 7465 2c20 6576 656e 7429  ggregate, event)
-000074b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000074c0: 6167 6772 6567 6174 650a 0a0a 636c 6173  aggregate...clas
-000074d0: 7320 4167 6772 6567 6174 654e 6f74 466f  s AggregateNotFo
-000074e0: 756e 6428 4578 6365 7074 696f 6e29 3a0a  und(Exception):.
-000074f0: 2020 2020 2222 2252 6169 7365 6420 7768      """Raised wh
-00007500: 656e 2061 6e20 6167 6772 6567 6174 6520  en an aggregate 
-00007510: 6973 206e 6f74 2066 6f75 6e64 2e22 2222  is not found."""
-00007520: 0a60 6060 0a0a 536e 6170 7368 6f74 7320  .```..Snapshots 
-00007530: 6361 6e20 696d 7072 6f76 6520 7468 6520  can improve the 
-00007540: 7065 7266 6f72 6d61 6e63 6520 6f66 2061  performance of a
-00007550: 6767 7265 6761 7465 7320 7468 6174 2077  ggregates that w
-00007560: 6f75 6c64 206f 7468 6572 7769 7365 2062  ould otherwise b
-00007570: 650a 7265 636f 6e73 7472 7563 7465 6420  e.reconstructed 
-00007580: 6672 6f6d 2076 6572 7920 6c6f 6e67 2073  from very long s
-00007590: 7472 6561 6d73 2e20 486f 7765 7665 722c  treams. However,
-000075a0: 2069 7420 6973 2067 656e 6572 616c 6c79   it is generally
-000075b0: 2072 6563 6f6d 6d65 6e64 6564 2074 6f0a   recommended to.
-000075c0: 6465 7369 676e 2061 6767 7265 6761 7465  design aggregate
-000075d0: 7320 746f 2068 6176 6520 6120 6669 6e69  s to have a fini
-000075e0: 7465 206c 6966 6563 7963 6c65 2c20 616e  te lifecycle, an
-000075f0: 6420 6865 6e63 6520 7265 6c61 7469 7665  d hence relative
-00007600: 6c79 2073 686f 7274 2073 7472 6561 6d73  ly short streams
-00007610: 2c0a 7468 6572 6562 7920 6176 6f69 6469  ,.thereby avoidi
-00007620: 6e67 2074 6865 206e 6565 6420 666f 7220  ng the need for 
-00007630: 736e 6170 7368 6f74 7469 6e67 2e20 5468  snapshotting. Th
-00007640: 6973 2022 686f 7720 746f 2220 7365 6374  is "how to" sect
-00007650: 696f 6e20 6973 2069 6e74 656e 6465 640a  ion is intended.
-00007660: 6d65 7265 6c79 2074 6f20 7368 6f77 2068  merely to show h
-00007670: 6f77 2073 6e61 7073 686f 7474 696e 6720  ow snapshotting 
-00007680: 6f66 2061 6767 7265 6761 7465 7320 6361  of aggregates ca
-00007690: 6e20 6265 2069 6d70 6c65 6d65 6e74 6564  n be implemented
-000076a0: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
-000076b0: 4442 0a75 7369 6e67 2074 6869 7320 5079  DB.using this Py
-000076c0: 7468 6f6e 2063 6c69 656e 742e 0a0a 536e  thon client...Sn
-000076d0: 6170 7368 6f74 7469 6e67 206f 6620 6167  apshotting of ag
-000076e0: 6772 6567 6174 6573 2063 616e 2062 6520  gregates can be 
-000076f0: 696d 706c 656d 656e 7465 6420 6279 2072  implemented by r
-00007700: 6563 6f72 6469 6e67 2074 6865 2063 7572  ecording the cur
-00007710: 7265 6e74 2073 7461 7465 206f 660a 616e  rent state of.an
-00007720: 2061 6767 7265 6761 7465 2061 7320 6120   aggregate as a 
-00007730: 6e65 7720 6576 656e 742e 0a0a 4966 2061  new event...If a
-00007740: 6e20 6167 6772 6567 6174 6520 6f62 6a65  n aggregate obje
-00007750: 6374 2068 6173 2061 2076 6572 7369 6f6e  ct has a version
-00007760: 206e 756d 6265 7220 7468 6174 2063 6f72   number that cor
-00007770: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
-00007780: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-00007790: 6f66 0a74 6865 206c 6173 7420 6576 656e  of.the last even
-000077a0: 7420 7468 6174 2077 6173 2075 7365 6420  t that was used 
-000077b0: 746f 2072 6563 6f6e 7374 7275 6374 2074  to reconstruct t
-000077c0: 6865 2061 6767 7265 6761 7465 2c20 616e  he aggregate, an
-000077d0: 6420 7468 6973 2076 6572 7369 6f6e 206e  d this version n
-000077e0: 756d 6265 720a 6973 2072 6563 6f72 6465  umber.is recorde
-000077f0: 6420 696e 2074 6865 2073 6e61 7073 686f  d in the snapsho
-00007800: 7420 6d65 7461 6461 7461 2c20 7468 656e  t metadata, then
-00007810: 2061 6e79 2065 7665 6e74 7320 7468 6174   any events that
-00007820: 2061 7265 2072 6563 6f72 6465 6420 6166   are recorded af
-00007830: 7465 7220 7468 650a 736e 6170 7368 6f74  ter the.snapshot
-00007840: 2063 616e 2062 6520 7365 6c65 6374 6564   can be selected
-00007850: 2075 7369 6e67 2074 6869 7320 7665 7273   using this vers
-00007860: 696f 6e20 6e75 6d62 6572 2e20 5468 6520  ion number. The 
-00007870: 6167 6772 6567 6174 6520 6361 6e20 7468  aggregate can th
-00007880: 656e 2062 650a 7265 636f 6e73 7472 7563  en be.reconstruc
-00007890: 7465 6420 6672 6f6d 2074 6865 206c 6173  ted from the las
-000078a0: 7420 736e 6170 7368 6f74 2061 6e64 2061  t snapshot and a
-000078b0: 6e79 2073 7562 7365 7175 656e 7420 6576  ny subsequent ev
-000078c0: 656e 7473 2c20 7769 7468 6f75 7420 6861  ents, without ha
-000078d0: 7669 6e67 0a74 6f20 7265 706c 6179 2074  ving.to replay t
-000078e0: 6865 2065 6e74 6972 6520 6869 7374 6f72  he entire histor
-000078f0: 792e 0a0a 5765 2077 696c 6c20 7573 6520  y...We will use 
-00007900: 6120 7365 7061 7261 7465 2073 7472 6561  a separate strea
-00007910: 6d20 666f 7220 616e 2061 6767 7265 6761  m for an aggrega
-00007920: 7465 2773 2073 6e61 7073 686f 7473 2074  te's snapshots t
-00007930: 6861 7420 6973 206e 616d 6564 2061 6674  hat is named aft
-00007940: 6572 2074 6865 0a73 7472 6561 6d20 7573  er the.stream us
-00007950: 6564 2066 6f72 2072 6563 6f72 6469 6e67  ed for recording
-00007960: 2069 7473 2065 7665 6e74 732e 2054 6865   its events. The
-00007970: 206e 616d 6520 6f66 2074 6865 2073 6e61   name of the sna
-00007980: 7073 686f 7420 7374 7265 616d 2077 696c  pshot stream wil
-00007990: 6c20 6265 0a63 6f6e 7374 7275 6374 6564  l be.constructed
-000079a0: 2062 7920 7072 6566 6978 696e 6720 7468   by prefixing th
-000079b0: 6520 6167 6772 6567 6174 6527 7320 7374  e aggregate's st
-000079c0: 7265 616d 206e 616d 6520 7769 7468 2060  ream name with `
-000079d0: 2724 736e 6170 7368 6f74 2d27 602e 0a0a  '$snapshot-'`...
-000079e0: 6060 6070 7974 686f 6e0a 534e 4150 5348  ```python.SNAPSH
-000079f0: 4f54 5f50 5245 4649 5820 3d20 2724 736e  OT_PREFIX = '$sn
-00007a00: 6170 7368 6f74 2d27 0a0a 6465 6620 6d61  apshot-'..def ma
-00007a10: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
-00007a20: 616d 5f6e 616d 6528 7374 7265 616d 5f6e  am_name(stream_n
-00007a30: 616d 6529 3a0a 2020 2020 7265 7475 726e  ame):.    return
-00007a40: 2066 277b 534e 4150 5348 4f54 5f50 5245   f'{SNAPSHOT_PRE
-00007a50: 4649 587d 7b73 7472 6561 6d5f 6e61 6d65  FIX}{stream_name
-00007a60: 7d27 0a0a 0a64 6566 2073 7472 6970 5f73  }'...def strip_s
-00007a70: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
-00007a80: 616d 6528 736e 6170 7368 6f74 5f73 7472  ame(snapshot_str
-00007a90: 6561 6d5f 6e61 6d65 293a 0a20 2020 2072  eam_name):.    r
-00007aa0: 6574 7572 6e20 736e 6170 7368 6f74 5f73  eturn snapshot_s
-00007ab0: 7472 6561 6d5f 6e61 6d65 2e6c 7374 7269  tream_name.lstri
-00007ac0: 7028 534e 4150 5348 4f54 5f50 5245 4649  p(SNAPSHOT_PREFI
-00007ad0: 5829 0a60 6060 0a0a 4c65 7427 7320 7265  X).```..Let's re
-00007ae0: 6465 6669 6e65 2074 6865 2060 6765 745f  define the `get_
-00007af0: 6167 6772 6567 6174 6528 2960 2066 756e  aggregate()` fun
-00007b00: 6374 696f 6e2c 2073 6f20 7468 6174 2069  ction, so that i
-00007b10: 7420 6c6f 6f6b 7320 666f 7220 6120 736e  t looks for a sn
-00007b20: 6170 7368 6f74 2065 7665 6e74 2c0a 7468  apshot event,.th
-00007b30: 656e 2073 656c 6563 7473 2073 7562 7365  en selects subse
-00007b40: 7175 656e 7420 6167 6772 6567 6174 6520  quent aggregate 
-00007b50: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
-00007b60: 2063 616c 6c73 2061 206d 7574 6174 6f72   calls a mutator
-00007b70: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
-00007b80: 6368 0a72 6563 6f72 6465 6420 6576 656e  ch.recorded even
-00007b90: 742e 2057 6520 7769 6c6c 2075 7365 204a  t. We will use J
-00007ba0: 534f 4e20 746f 2073 6572 6961 6c69 7a65  SON to serialize
-00007bb0: 2061 6e64 2064 6573 6572 6961 6c69 7a65   and deserialize
-00007bc0: 2050 7974 686f 6e20 6064 6963 7460 206f   Python `dict` o
-00007bd0: 626a 6563 7473 2e0a 0a4e 6f74 6963 6520  bjects...Notice 
-00007be0: 7468 6174 2074 6865 2061 6767 7265 6761  that the aggrega
-00007bf0: 7465 2065 7665 6e74 7320 6172 6520 7265  te events are re
-00007c00: 6164 2066 726f 6d20 6120 7374 7265 616d  ad from a stream
-00007c10: 2066 6f72 2061 6767 7265 6761 7465 0a65   for aggregate.e
-00007c20: 7665 6e74 732c 2077 6869 6c73 7420 7468  vents, whilst th
-00007c30: 6520 736e 6170 7368 6f74 2069 7320 7265  e snapshot is re
-00007c40: 6164 2066 726f 6d20 6120 7365 7061 7261  ad from a separa
-00007c50: 7465 2073 7472 6561 6d20 666f 7220 6167  te stream for ag
-00007c60: 6772 6567 6174 6520 736e 6170 7368 6f74  gregate snapshot
-00007c70: 732e 0a0a 6060 6070 7974 686f 6e0a 696d  s...```python.im
-00007c80: 706f 7274 206a 736f 6e0a 0a0a 6465 6620  port json...def 
-00007c90: 6765 745f 6167 6772 6567 6174 6528 6167  get_aggregate(ag
-00007ca0: 6772 6567 6174 655f 6964 2c20 6d75 7461  gregate_id, muta
-00007cb0: 746f 725f 6675 6e63 293a 0a20 2020 2073  tor_func):.    s
-00007cc0: 7472 6561 6d5f 6e61 6d65 203d 2061 6767  tream_name = agg
-00007cd0: 7265 6761 7465 5f69 640a 2020 2020 7265  regate_id.    re
-00007ce0: 636f 7264 6564 5f65 7665 6e74 7320 3d20  corded_events = 
-00007cf0: 5b5d 0a0a 2020 2020 2320 4c6f 6f6b 2066  []..    # Look f
-00007d00: 6f72 2061 2073 6e61 7073 686f 742e 0a20  or a snapshot.. 
-00007d10: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00007d20: 736e 6170 7368 6f74 7320 3d20 636c 6965  snapshots = clie
-00007d30: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
-00007d40: 7665 6e74 7328 0a20 2020 2020 2020 2020  vents(.         
-00007d50: 2020 2073 7472 6561 6d5f 6e61 6d65 3d6d     stream_name=m
-00007d60: 616b 655f 736e 6170 7368 6f74 5f73 7472  ake_snapshot_str
-00007d70: 6561 6d5f 6e61 6d65 2873 7472 6561 6d5f  eam_name(stream_
-00007d80: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
-00007d90: 2020 2062 6163 6b77 6172 6473 3d54 7275     backwards=Tru
-00007da0: 652c 0a20 2020 2020 2020 2020 2020 206c  e,.            l
-00007db0: 696d 6974 3d31 0a20 2020 2020 2020 2029  imit=1.        )
-00007dc0: 0a20 2020 2065 7863 6570 7420 4e6f 7446  .    except NotF
-00007dd0: 6f75 6e64 3a0a 2020 2020 2020 2020 7374  ound:.        st
-00007de0: 7265 616d 5f70 6f73 6974 696f 6e20 3d20  ream_position = 
-00007df0: 4e6f 6e65 0a20 2020 2065 6c73 653a 0a20  None.    else:. 
-00007e00: 2020 2020 2020 2073 6e61 7073 686f 7420         snapshot 
-00007e10: 3d20 736e 6170 7368 6f74 735b 305d 0a20  = snapshots[0]. 
-00007e20: 2020 2020 2020 2073 7472 6561 6d5f 706f         stream_po
-00007e30: 7369 7469 6f6e 203d 2064 6573 6572 6961  sition = deseria
-00007e40: 6c69 7a65 2873 6e61 7073 686f 742e 6d65  lize(snapshot.me
-00007e50: 7461 6461 7461 295b 2776 6572 7369 6f6e  tadata)['version
-00007e60: 275d 202b 2031 0a20 2020 2020 2020 2072  '] + 1.        r
-00007e70: 6563 6f72 6465 645f 6576 656e 7473 2e61  ecorded_events.a
-00007e80: 7070 656e 6428 736e 6170 7368 6f74 290a  ppend(snapshot).
-00007e90: 0a20 2020 2023 2047 6574 2073 7562 7365  .    # Get subse
-00007ea0: 7175 656e 7420 6576 656e 7473 2e0a 2020  quent events..  
-00007eb0: 2020 7472 793a 0a20 2020 2020 2020 2065    try:.        e
-00007ec0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-00007ed0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-00007ee0: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
-00007ef0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-00007f00: 6d5f 6e61 6d65 2c0a 2020 2020 2020 2020  m_name,.        
-00007f10: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
-00007f20: 696f 6e3d 7374 7265 616d 5f70 6f73 6974  ion=stream_posit
-00007f30: 696f 6e0a 2020 2020 2020 2020 290a 2020  ion.        ).  
-00007f40: 2020 6578 6365 7074 204e 6f74 466f 756e    except NotFoun
-00007f50: 6420 6173 2065 3a0a 2020 2020 2020 2020  d as e:.        
-00007f60: 7261 6973 6520 4167 6772 6567 6174 654e  raise AggregateN
-00007f70: 6f74 466f 756e 6428 6167 6772 6567 6174  otFound(aggregat
-00007f80: 655f 6964 2920 6672 6f6d 2065 0a20 2020  e_id) from e.   
-00007f90: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-00007fa0: 6563 6f72 6465 645f 6576 656e 7473 202b  ecorded_events +
-00007fb0: 3d20 6576 656e 7473 0a0a 2020 2020 2320  = events..    # 
-00007fc0: 5265 636f 6e73 7472 7563 7420 6167 6772  Reconstruct aggr
-00007fd0: 6567 6174 6520 6672 6f6d 2072 6563 6f72  egate from recor
-00007fe0: 6465 6420 6576 656e 7473 2e0a 2020 2020  ded events..    
-00007ff0: 6167 6772 6567 6174 6520 3d20 4e6f 6e65  aggregate = None
-00008000: 0a20 2020 2066 6f72 2065 7665 6e74 2069  .    for event i
-00008010: 6e20 7265 636f 7264 6564 5f65 7665 6e74  n recorded_event
-00008020: 733a 0a20 2020 2020 2020 2061 6767 7265  s:.        aggre
-00008030: 6761 7465 203d 206d 7574 6174 6f72 5f66  gate = mutator_f
-00008040: 756e 6328 6167 6772 6567 6174 652c 2065  unc(aggregate, e
-00008050: 7665 6e74 290a 0a20 2020 2072 6574 7572  vent)..    retur
-00008060: 6e20 6167 6772 6567 6174 650a 0a0a 6465  n aggregate...de
-00008070: 6620 7365 7269 616c 697a 6528 6429 3a0a  f serialize(d):.
-00008080: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
-00008090: 6475 6d70 7328 6429 2e65 6e63 6f64 6528  dumps(d).encode(
-000080a0: 290a 0a0a 6465 6620 6465 7365 7269 616c  )...def deserial
-000080b0: 697a 6528 7329 3a0a 2020 2020 7265 7475  ize(s):.    retu
-000080c0: 726e 206a 736f 6e2e 6c6f 6164 7328 732e  rn json.loads(s.
-000080d0: 6465 636f 6465 2829 290a 6060 600a 0a54  decode()).```..T
-000080e0: 6f20 7368 6f77 2068 6f77 2074 6869 7320  o show how this 
-000080f0: 6361 6e20 6265 2075 7365 642c 206c 6574  can be used, let
-00008100: 2773 2064 6566 696e 6520 616e 2022 696d  's define an "im
-00008110: 6d75 7461 626c 6522 2060 446f 6760 2061  mutable" `Dog` a
-00008120: 6767 7265 6761 7465 2063 6c61 7373 2c20  ggregate class, 
-00008130: 7769 7468 0a61 7474 7269 6275 7465 7320  with.attributes 
-00008140: 606e 616d 6560 2061 6e64 2060 7472 6963  `name` and `tric
-00008150: 6b73 602e 2054 6865 2061 7474 7269 6275  ks`. The attribu
-00008160: 7465 7320 6069 6460 2061 6e64 2060 7665  tes `id` and `ve
-00008170: 7273 696f 6e60 2077 696c 6c20 696e 6469  rsion` will indi
-00008180: 6361 7465 2061 6e0a 6167 6772 6567 6174  cate an.aggregat
-00008190: 6520 6f62 6a65 6374 2773 2049 4420 616e  e object's ID an
-000081a0: 6420 7665 7273 696f 6e20 6e75 6d62 6572  d version number
-000081b0: 2e20 5468 6520 6174 7472 6962 7574 6520  . The attribute 
-000081c0: 6069 735f 6672 6f6d 5f73 6e61 7073 686f  `is_from_snapsho
-000081d0: 7460 2069 7320 6164 6465 640a 6865 7265  t` is added.here
-000081e0: 206d 6572 656c 7920 746f 2064 656d 6f6e   merely to demon
-000081f0: 7374 7261 7465 2062 656c 6f77 2077 6865  strate below whe
-00008200: 6e20 616e 2061 6767 7265 6761 7465 206f  n an aggregate o
-00008210: 626a 6563 7420 6861 7320 6265 656e 2072  bject has been r
-00008220: 6563 6f6e 7374 7275 6374 6564 2075 7369  econstructed usi
-00008230: 6e67 0a61 2073 6e61 7073 686f 742e 0a0a  ng.a snapshot...
-00008240: 6060 6070 7974 686f 6e0a 6672 6f6d 2064  ```python.from d
-00008250: 6174 6163 6c61 7373 6573 2069 6d70 6f72  ataclasses impor
-00008260: 7420 6461 7461 636c 6173 730a 0a0a 4064  t dataclass...@d
-00008270: 6174 6163 6c61 7373 2866 726f 7a65 6e3d  ataclass(frozen=
-00008280: 5472 7565 290a 636c 6173 7320 4167 6772  True).class Aggr
-00008290: 6567 6174 653a 0a20 2020 2069 643a 2073  egate:.    id: s
-000082a0: 7472 0a20 2020 2076 6572 7369 6f6e 3a20  tr.    version: 
-000082b0: 696e 740a 2020 2020 6973 5f66 726f 6d5f  int.    is_from_
-000082c0: 736e 6170 7368 6f74 3a20 626f 6f6c 0a0a  snapshot: bool..
-000082d0: 0a40 6461 7461 636c 6173 7328 6672 6f7a  .@dataclass(froz
-000082e0: 656e 3d54 7275 6529 0a63 6c61 7373 2044  en=True).class D
-000082f0: 6f67 2841 6767 7265 6761 7465 293a 0a20  og(Aggregate):. 
-00008300: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
-00008310: 2074 7269 636b 733a 206c 6973 740a 0a60   tricks: list..`
-00008320: 6060 0a0a 4c65 7427 7320 616c 736f 2064  ``..Let's also d
-00008330: 6566 696e 6520 6120 6d75 7461 746f 7220  efine a mutator 
-00008340: 6675 6e63 7469 6f6e 2060 6d75 7461 7465  function `mutate
-00008350: 5f64 6f67 2829 6020 7468 6174 2063 616e  _dog()` that can
-00008360: 2065 766f 6c76 6520 7468 6520 7374 6174   evolve the stat
-00008370: 6520 6f66 2061 0a60 446f 6760 2061 6767  e of a.`Dog` agg
-00008380: 7265 6761 7465 2067 6976 656e 2076 6172  regate given var
-00008390: 696f 7573 2064 6966 6665 7265 6e74 2074  ious different t
-000083a0: 7970 6573 206f 6620 6576 656e 7473 2c20  ypes of events, 
-000083b0: 6027 446f 6752 6567 6973 7465 7265 6427  `'DogRegistered'
-000083c0: 602c 0a60 2744 6f67 4c65 6172 6e65 6454  `,.`'DogLearnedT
-000083d0: 7269 636b 2760 2c20 616e 6420 6027 2453  rick'`, and `'$S
-000083e0: 6e61 7073 686f 7460 272e 2054 6865 2073  napshot`'. The s
-000083f0: 6e61 7073 686f 7420 6576 656e 7420 7479  napshot event ty
-00008400: 7065 2069 7320 7072 6566 6978 6564 2077  pe is prefixed w
-00008410: 6974 680a 6027 2427 6020 736f 2074 6861  ith.`'$'` so tha
-00008420: 7420 6974 2063 616e 2062 6520 6669 6c74  t it can be filt
-00008430: 6572 6564 206f 7574 2077 6865 6e20 7265  ered out when re
-00008440: 6164 696e 6720 616c 6c20 6576 656e 7473  ading all events
-00008450: 2066 726f 6d20 7468 6520 6461 7461 6261   from the databa
-00008460: 7365 2e0a 0a60 6060 7079 7468 6f6e 0a64  se...```python.d
-00008470: 6566 206d 7574 6174 655f 646f 6728 646f  ef mutate_dog(do
-00008480: 672c 2065 7665 6e74 293a 0a20 2020 2064  g, event):.    d
-00008490: 6174 6120 3d20 6465 7365 7269 616c 697a  ata = deserializ
-000084a0: 6528 6576 656e 742e 6461 7461 290a 2020  e(event.data).  
-000084b0: 2020 6966 2065 7665 6e74 2e74 7970 6520    if event.type 
-000084c0: 3d3d 2027 446f 6752 6567 6973 7465 7265  == 'DogRegistere
-000084d0: 6427 3a0a 2020 2020 2020 2020 7265 7475  d':.        retu
-000084e0: 726e 2044 6f67 280a 2020 2020 2020 2020  rn Dog(.        
-000084f0: 2020 2020 6964 3d65 7665 6e74 2e73 7472      id=event.str
-00008500: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
-00008510: 2020 2020 2020 7665 7273 696f 6e3d 6576        version=ev
-00008520: 656e 742e 7374 7265 616d 5f70 6f73 6974  ent.stream_posit
-00008530: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00008540: 2069 735f 6672 6f6d 5f73 6e61 7073 686f   is_from_snapsho
-00008550: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
-00008560: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
-00008570: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
-00008580: 2020 2020 7472 6963 6b73 3d5b 5d2c 0a20      tricks=[],. 
-00008590: 2020 2020 2020 2029 0a20 2020 2065 6c69         ).    eli
-000085a0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
-000085b0: 2744 6f67 4c65 6172 6e65 6454 7269 636b  'DogLearnedTrick
-000085c0: 273a 0a20 2020 2020 2020 2061 7373 6572  ':.        asser
-000085d0: 7420 6576 656e 742e 7374 7265 616d 5f70  t event.stream_p
-000085e0: 6f73 6974 696f 6e20 3d3d 2064 6f67 2e76  osition == dog.v
-000085f0: 6572 7369 6f6e 202b 2031 0a20 2020 2020  ersion + 1.     
-00008600: 2020 2061 7373 6572 7420 6576 656e 742e     assert event.
-00008610: 7374 7265 616d 5f6e 616d 6520 3d3d 2064  stream_name == d
-00008620: 6f67 2e69 640a 2020 2020 2020 2020 7265  og.id.        re
-00008630: 7475 726e 2044 6f67 280a 2020 2020 2020  turn Dog(.      
-00008640: 2020 2020 2020 6964 3d64 6f67 2e69 642c        id=dog.id,
-00008650: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
-00008660: 7369 6f6e 3d65 7665 6e74 2e73 7472 6561  sion=event.strea
-00008670: 6d5f 706f 7369 7469 6f6e 2c0a 2020 2020  m_position,.    
-00008680: 2020 2020 2020 2020 6973 5f66 726f 6d5f          is_from_
-00008690: 736e 6170 7368 6f74 3d64 6f67 2e69 735f  snapshot=dog.is_
-000086a0: 6672 6f6d 5f73 6e61 7073 686f 742c 0a20  from_snapshot,. 
-000086b0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-000086c0: 646f 672e 6e61 6d65 2c0a 2020 2020 2020  dog.name,.      
-000086d0: 2020 2020 2020 7472 6963 6b73 3d64 6f67        tricks=dog
-000086e0: 2e74 7269 636b 7320 2b20 5b64 6174 615b  .tricks + [data[
-000086f0: 2774 7269 636b 275d 5d2c 0a20 2020 2020  'trick']],.     
-00008700: 2020 2029 0a20 2020 2065 6c69 6620 6576     ).    elif ev
-00008710: 656e 742e 7479 7065 203d 3d20 2724 536e  ent.type == '$Sn
-00008720: 6170 7368 6f74 273a 0a20 2020 2020 2020  apshot':.       
-00008730: 2072 6574 7572 6e20 446f 6728 0a20 2020   return Dog(.   
-00008740: 2020 2020 2020 2020 2069 643d 7374 7269           id=stri
-00008750: 705f 736e 6170 7368 6f74 5f73 7472 6561  p_snapshot_strea
-00008760: 6d5f 6e61 6d65 2865 7665 6e74 2e73 7472  m_name(event.str
-00008770: 6561 6d5f 6e61 6d65 292c 0a20 2020 2020  eam_name),.     
-00008780: 2020 2020 2020 2076 6572 7369 6f6e 3d64         version=d
-00008790: 6573 6572 6961 6c69 7a65 2865 7665 6e74  eserialize(event
-000087a0: 2e6d 6574 6164 6174 6129 5b27 7665 7273  .metadata)['vers
-000087b0: 696f 6e27 5d2c 0a20 2020 2020 2020 2020  ion'],.         
-000087c0: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
-000087d0: 686f 743d 5472 7565 2c0a 2020 2020 2020  hot=True,.      
-000087e0: 2020 2020 2020 6e61 6d65 3d64 6174 615b        name=data[
-000087f0: 276e 616d 6527 5d2c 0a20 2020 2020 2020  'name'],.       
-00008800: 2020 2020 2074 7269 636b 733d 6461 7461       tricks=data
-00008810: 5b27 7472 6963 6b73 275d 2c0a 2020 2020  ['tricks'],.    
-00008820: 2020 2020 290a 2020 2020 656c 7365 3a0a      ).    else:.
-00008830: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-00008840: 6365 7074 696f 6e28 6622 556e 6b6e 6f77  ception(f"Unknow
-00008850: 6e20 6576 656e 7420 7479 7065 3a20 7b65  n event type: {e
-00008860: 7665 6e74 2e74 7970 657d 2229 0a60 6060  vent.type}").```
-00008870: 0a0a 466f 7220 636f 6e76 656e 6965 6e63  ..For convenienc
-00008880: 652c 206c 6574 2773 2061 6c73 6f20 6465  e, let's also de
-00008890: 6669 6e65 2061 2060 6765 745f 646f 6728  fine a `get_dog(
-000088a0: 2960 2066 756e 6374 696f 6e20 7468 6174  )` function that
-000088b0: 2063 616c 6c73 2060 6765 745f 6167 6772   calls `get_aggr
-000088c0: 6567 6174 6528 2960 0a77 6974 6820 7468  egate()`.with th
-000088d0: 6520 606d 7574 6174 655f 646f 6728 2960  e `mutate_dog()`
-000088e0: 2066 756e 6374 696f 6e20 6173 2074 6865   function as the
-000088f0: 2060 6d75 7461 746f 725f 6675 6e63 6020   `mutator_func` 
-00008900: 6172 6775 6d65 6e74 2e0a 0a60 6060 7079  argument...```py
-00008910: 7468 6f6e 0a64 6566 2067 6574 5f64 6f67  thon.def get_dog
-00008920: 2864 6f67 5f69 6429 3a0a 2020 2020 7265  (dog_id):.    re
-00008930: 7475 726e 2067 6574 5f61 6767 7265 6761  turn get_aggrega
-00008940: 7465 280a 2020 2020 2020 2020 6167 6772  te(.        aggr
-00008950: 6567 6174 655f 6964 3d64 6f67 5f69 642c  egate_id=dog_id,
-00008960: 0a20 2020 2020 2020 206d 7574 6174 6f72  .        mutator
-00008970: 5f66 756e 633d 6d75 7461 7465 5f64 6f67  _func=mutate_dog
-00008980: 2c0a 2020 2020 290a 6060 600a 0a57 6520  ,.    ).```..We 
-00008990: 6361 6e20 616c 736f 2064 6566 696e 6520  can also define 
-000089a0: 736f 6d65 2022 636f 6d6d 616e 6422 2066  some "command" f
-000089b0: 756e 6374 696f 6e73 2074 6861 7420 6170  unctions that ap
-000089c0: 7065 6e64 206e 6577 2065 7665 6e74 7320  pend new events 
-000089d0: 746f 2074 6865 0a64 6174 6162 6173 652e  to the.database.
-000089e0: 2054 6865 2060 7265 6769 7374 6572 5f64   The `register_d
-000089f0: 6f67 2829 6020 6675 6e63 7469 6f6e 2061  og()` function a
-00008a00: 7070 656e 6473 2061 2060 446f 6752 6567  ppends a `DogReg
-00008a10: 6973 7465 7265 6460 2065 7665 6e74 2e20  istered` event. 
-00008a20: 5468 650a 6072 6563 6f72 645f 7472 6963  The.`record_tric
-00008a30: 6b5f 6c65 6172 6e65 6428 2960 2061 7070  k_learned()` app
-00008a40: 656e 6473 2061 2060 446f 674c 6561 726e  ends a `DogLearn
-00008a50: 6564 5472 6963 6b60 2065 7665 6e74 2e20  edTrick` event. 
-00008a60: 5468 6520 6675 6e63 7469 6f6e 0a60 736e  The function.`sn
-00008a70: 6170 7368 6f74 5f64 6f67 2829 6020 6170  apshot_dog()` ap
-00008a80: 7065 6e64 7320 6120 6024 536e 6170 7368  pends a `$Snapsh
-00008a90: 6f74 6020 6576 656e 742e 204e 6f74 6963  ot` event. Notic
-00008aa0: 6520 7468 6174 2074 6865 0a60 7265 636f  e that the.`reco
-00008ab0: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
-00008ac0: 2829 6020 616e 6420 6073 6e61 7073 686f  ()` and `snapsho
-00008ad0: 745f 646f 6728 2960 2066 756e 6374 696f  t_dog()` functio
-00008ae0: 6e73 2075 7365 2060 6765 745f 646f 6728  ns use `get_dog(
-00008af0: 2960 2e0a 0a4e 6f74 6963 6520 616c 736f  )`...Notice also
-00008b00: 2074 6861 7420 7468 6520 6044 6f67 5265   that the `DogRe
-00008b10: 6769 7374 6572 6564 6020 616e 6420 6044  gistered` and `D
-00008b20: 6f67 4c65 6172 6e65 6454 7269 636b 6020  ogLearnedTrick` 
-00008b30: 6576 656e 7473 2061 7265 2061 7070 656e  events are appen
-00008b40: 6465 6420 746f 2061 0a73 7472 6561 6d20  ded to a.stream 
-00008b50: 666f 7220 6167 6772 6567 6174 6520 6576  for aggregate ev
-00008b60: 656e 7473 2c20 7768 696c 7374 2074 6865  ents, whilst the
-00008b70: 2060 2453 6e61 7073 686f 7460 2069 7320   `$Snapshot` is 
-00008b80: 6170 7065 6e64 6564 2074 6f20 6120 7365  appended to a se
-00008b90: 7061 7261 7465 2073 7472 6561 6d0a 666f  parate stream.fo
-00008ba0: 7220 6167 6772 6567 6174 6520 736e 6170  r aggregate snap
-00008bb0: 7368 6f74 732e 2054 6865 2073 6e61 7073  shots. The snaps
-00008bc0: 686f 7420 6576 656e 7420 7479 7065 2069  hot event type i
-00008bd0: 7320 7072 6566 6978 6564 2077 6974 6820  s prefixed with 
-00008be0: 6027 2427 6020 736f 2074 6861 7420 6974  `'$'` so that it
-00008bf0: 2063 616e 0a62 6520 6669 6c74 6572 6564   can.be filtered
-00008c00: 206f 7574 2077 6865 6e20 7265 6164 696e   out when readin
-00008c10: 6720 616c 6c20 6576 656e 7473 2066 726f  g all events fro
-00008c20: 6d20 7468 6520 6461 7461 6261 7365 2e0a  m the database..
-00008c30: 0a60 6060 7079 7468 6f6e 0a64 6566 2072  .```python.def r
-00008c40: 6567 6973 7465 725f 646f 6728 6e61 6d65  egister_dog(name
-00008c50: 293a 0a20 2020 2064 6f67 5f69 6420 3d20  ):.    dog_id = 
-00008c60: 7374 7228 7575 6964 3428 2929 0a20 2020  str(uuid4()).   
-00008c70: 2065 7665 6e74 203d 204e 6577 4576 656e   event = NewEven
-00008c80: 7428 0a20 2020 2020 2020 2074 7970 653d  t(.        type=
-00008c90: 2744 6f67 5265 6769 7374 6572 6564 272c  'DogRegistered',
-00008ca0: 0a20 2020 2020 2020 2064 6174 613d 7365  .        data=se
-00008cb0: 7269 616c 697a 6528 7b27 6e61 6d65 273a  rialize({'name':
-00008cc0: 206e 616d 657d 292c 0a20 2020 2029 0a20   name}),.    ). 
-00008cd0: 2020 2063 6c69 656e 742e 6170 7065 6e64     client.append
-00008ce0: 5f65 7665 6e74 280a 2020 2020 2020 2020  _event(.        
-00008cf0: 7374 7265 616d 5f6e 616d 653d 646f 675f  stream_name=dog_
-00008d00: 6964 2c0a 2020 2020 2020 2020 6578 7065  id,.        expe
-00008d10: 6374 6564 5f70 6f73 6974 696f 6e3d 4e6f  cted_position=No
-00008d20: 6e65 2c0a 2020 2020 2020 2020 6576 656e  ne,.        even
-00008d30: 743d 6576 656e 742c 0a20 2020 2029 0a20  t=event,.    ). 
-00008d40: 2020 2072 6574 7572 6e20 646f 675f 6964     return dog_id
-00008d50: 0a0a 0a64 6566 2072 6563 6f72 645f 7472  ...def record_tr
-00008d60: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
-00008d70: 6964 2c20 7472 6963 6b29 3a0a 2020 2020  id, trick):.    
-00008d80: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
-00008d90: 675f 6964 290a 2020 2020 6576 656e 7420  g_id).    event 
-00008da0: 3d20 4e65 7745 7665 6e74 280a 2020 2020  = NewEvent(.    
-00008db0: 2020 2020 7479 7065 3d27 446f 674c 6561      type='DogLea
-00008dc0: 726e 6564 5472 6963 6b27 2c0a 2020 2020  rnedTrick',.    
-00008dd0: 2020 2020 6461 7461 3d73 6572 6961 6c69      data=seriali
-00008de0: 7a65 287b 2774 7269 636b 273a 2074 7269  ze({'trick': tri
-00008df0: 636b 7d29 2c0a 2020 2020 290a 2020 2020  ck}),.    ).    
-00008e00: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-00008e10: 656e 7428 0a20 2020 2020 2020 2073 7472  ent(.        str
-00008e20: 6561 6d5f 6e61 6d65 3d64 6f67 5f69 642c  eam_name=dog_id,
-00008e30: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00008e40: 645f 706f 7369 7469 6f6e 3d64 6f67 2e76  d_position=dog.v
-00008e50: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-00008e60: 6576 656e 743d 6576 656e 742c 0a20 2020  event=event,.   
-00008e70: 2029 0a0a 0a64 6566 2073 6e61 7073 686f   )...def snapsho
-00008e80: 745f 646f 6728 646f 675f 6964 293a 0a20  t_dog(dog_id):. 
-00008e90: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
-00008ea0: 2864 6f67 5f69 6429 0a20 2020 2065 7665  (dog_id).    eve
-00008eb0: 6e74 203d 204e 6577 4576 656e 7428 0a20  nt = NewEvent(. 
-00008ec0: 2020 2020 2020 2074 7970 653d 2724 536e         type='$Sn
-00008ed0: 6170 7368 6f74 272c 0a20 2020 2020 2020  apshot',.       
-00008ee0: 2064 6174 613d 7365 7269 616c 697a 6528   data=serialize(
-00008ef0: 7b27 6e61 6d65 273a 2064 6f67 2e6e 616d  {'name': dog.nam
-00008f00: 652c 2027 7472 6963 6b73 273a 2064 6f67  e, 'tricks': dog
-00008f10: 2e74 7269 636b 737d 292c 0a20 2020 2020  .tricks}),.     
-00008f20: 2020 206d 6574 6164 6174 613d 7365 7269     metadata=seri
-00008f30: 616c 697a 6528 7b27 7665 7273 696f 6e27  alize({'version'
-00008f40: 3a20 646f 672e 7665 7273 696f 6e7d 292c  : dog.version}),
-00008f50: 0a20 2020 2029 0a20 2020 2063 6c69 656e  .    ).    clien
-00008f60: 742e 6170 7065 6e64 5f65 7665 6e74 280a  t.append_event(.
-00008f70: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
-00008f80: 616d 653d 6d61 6b65 5f73 6e61 7073 686f  ame=make_snapsho
-00008f90: 745f 7374 7265 616d 5f6e 616d 6528 646f  t_stream_name(do
-00008fa0: 675f 6964 292c 0a20 2020 2020 2020 2065  g_id),.        e
-00008fb0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00008fc0: 3d2d 312c 0a20 2020 2020 2020 2065 7665  =-1,.        eve
-00008fd0: 6e74 3d65 7665 6e74 2c0a 2020 2020 290a  nt=event,.    ).
-00008fe0: 6060 600a 0a4e 6f77 2077 6520 6361 6e20  ```..Now we can 
-00008ff0: 7265 6769 7374 6572 2061 206e 6577 2064  register a new d
-00009000: 6f67 2c20 616e 6420 7265 636f 7264 2074  og, and record t
-00009010: 6861 7420 736f 6d65 2074 7269 636b 7320  hat some tricks 
-00009020: 6861 7665 2062 6565 6e20 6c65 6172 6e65  have been learne
-00009030: 642e 0a0a 6060 6070 7974 686f 6e0a 2320  d...```python.# 
-00009040: 5265 6769 7374 6572 2061 206e 6577 2064  Register a new d
-00009050: 6f67 2e0a 646f 675f 6964 203d 2072 6567  og..dog_id = reg
-00009060: 6973 7465 725f 646f 6728 2746 6964 6f27  ister_dog('Fido'
-00009070: 290a 0a64 6f67 203d 2067 6574 5f64 6f67  )..dog = get_dog
-00009080: 2864 6f67 5f69 6429 0a61 7373 6572 7420  (dog_id).assert 
-00009090: 646f 672e 6e61 6d65 203d 3d20 2746 6964  dog.name == 'Fid
-000090a0: 6f27 0a61 7373 6572 7420 646f 672e 7472  o'.assert dog.tr
-000090b0: 6963 6b73 203d 3d20 5b5d 0a61 7373 6572  icks == [].asser
-000090c0: 7420 646f 672e 7665 7273 696f 6e20 3d3d  t dog.version ==
-000090d0: 2030 0a61 7373 6572 7420 646f 672e 6973   0.assert dog.is
-000090e0: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
-000090f0: 7320 4661 6c73 650a 0a0a 2320 5265 636f  s False...# Reco
-00009100: 7264 2074 6861 7420 2746 6964 6f27 206c  rd that 'Fido' l
-00009110: 6561 726e 6564 2061 206e 6577 2074 7269  earned a new tri
-00009120: 636b 2e0a 7265 636f 7264 5f74 7269 636b  ck..record_trick
-00009130: 5f6c 6561 726e 6564 2864 6f67 5f69 642c  _learned(dog_id,
-00009140: 2074 7269 636b 3d27 726f 6c6c 206f 7665   trick='roll ove
-00009150: 7227 290a 0a64 6f67 203d 2067 6574 5f64  r')..dog = get_d
-00009160: 6f67 2864 6f67 5f69 6429 0a61 7373 6572  og(dog_id).asser
-00009170: 7420 646f 672e 6e61 6d65 203d 3d20 2746  t dog.name == 'F
-00009180: 6964 6f27 0a61 7373 6572 7420 646f 672e  ido'.assert dog.
-00009190: 7472 6963 6b73 203d 3d20 5b27 726f 6c6c  tricks == ['roll
-000091a0: 206f 7665 7227 5d0a 6173 7365 7274 2064   over'].assert d
-000091b0: 6f67 2e76 6572 7369 6f6e 203d 3d20 310a  og.version == 1.
-000091c0: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
-000091d0: 6f6d 5f73 6e61 7073 686f 7420 6973 2046  om_snapshot is F
-000091e0: 616c 7365 0a0a 0a23 2052 6563 6f72 6420  alse...# Record 
-000091f0: 7468 6174 2027 4669 646f 2720 6c65 6172  that 'Fido' lear
-00009200: 6e65 6420 616e 6f74 6865 7220 6e65 7720  ned another new 
-00009210: 7472 6963 6b2e 0a72 6563 6f72 645f 7472  trick..record_tr
-00009220: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
-00009230: 6964 2c20 7472 6963 6b3d 2766 6574 6368  id, trick='fetch
-00009240: 2062 616c 6c27 290a 0a64 6f67 203d 2067   ball')..dog = g
-00009250: 6574 5f64 6f67 2864 6f67 5f69 6429 0a61  et_dog(dog_id).a
-00009260: 7373 6572 7420 646f 672e 6e61 6d65 203d  ssert dog.name =
-00009270: 3d20 2746 6964 6f27 0a61 7373 6572 7420  = 'Fido'.assert 
-00009280: 646f 672e 7472 6963 6b73 203d 3d20 5b27  dog.tricks == ['
-00009290: 726f 6c6c 206f 7665 7227 2c20 2766 6574  roll over', 'fet
-000092a0: 6368 2062 616c 6c27 5d0a 6173 7365 7274  ch ball'].assert
-000092b0: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
-000092c0: 320a 6173 7365 7274 2064 6f67 2e69 735f  2.assert dog.is_
-000092d0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
-000092e0: 2046 616c 7365 0a60 6060 0a0a 4166 7465   False.```..Afte
-000092f0: 7220 7765 2063 616c 6c20 6073 6e61 7073  r we call `snaps
-00009300: 686f 745f 646f 6728 2960 2c20 7468 6520  hot_dog()`, the 
-00009310: 6067 6574 5f64 6f67 2829 6020 6675 6e63  `get_dog()` func
-00009320: 7469 6f6e 2077 696c 6c20 7265 7475 726e  tion will return
-00009330: 2061 2060 446f 6760 0a6f 626a 6563 7420   a `Dog`.object 
-00009340: 7468 6174 2068 6173 2062 6565 6e20 636f  that has been co
-00009350: 6e73 7472 7563 7465 6420 7573 696e 6720  nstructed using 
-00009360: 7468 6520 6024 536e 6170 7368 6f74 6020  the `$Snapshot` 
-00009370: 6576 656e 742e 0a0a 6060 6070 7974 686f  event...```pytho
-00009380: 6e0a 2320 536e 6170 7368 6f74 2027 4669  n.# Snapshot 'Fi
-00009390: 646f 272e 0a73 6e61 7073 686f 745f 646f  do'..snapshot_do
-000093a0: 6728 646f 675f 6964 290a 0a64 6f67 203d  g(dog_id)..dog =
-000093b0: 2067 6574 5f64 6f67 2864 6f67 5f69 6429   get_dog(dog_id)
-000093c0: 0a61 7373 6572 7420 646f 672e 6e61 6d65  .assert dog.name
-000093d0: 203d 3d20 2746 6964 6f27 0a61 7373 6572   == 'Fido'.asser
-000093e0: 7420 646f 672e 7472 6963 6b73 203d 3d20  t dog.tricks == 
-000093f0: 5b27 726f 6c6c 206f 7665 7227 2c20 2766  ['roll over', 'f
-00009400: 6574 6368 2062 616c 6c27 5d0a 6173 7365  etch ball'].asse
-00009410: 7274 2064 6f67 2e76 6572 7369 6f6e 203d  rt dog.version =
-00009420: 3d20 320a 6173 7365 7274 2064 6f67 2e69  = 2.assert dog.i
-00009430: 735f 6672 6f6d 5f73 6e61 7073 686f 7420  s_from_snapshot 
-00009440: 6973 2054 7275 650a 6060 600a 0a57 6520  is True.```..We 
-00009450: 6361 6e20 636f 6e74 696e 7565 2074 6f20  can continue to 
-00009460: 6576 6f6c 7665 2074 6865 2073 7461 7465  evolve the state
-00009470: 206f 6620 7468 6520 6044 6f67 6020 6167   of the `Dog` ag
-00009480: 6772 6567 6174 652c 2075 7369 6e67 0a74  gregate, using.t
-00009490: 6865 2073 6e61 7073 686f 7420 626f 7468  he snapshot both
-000094a0: 2064 7572 696e 6720 7468 6520 6361 6c6c   during the call
-000094b0: 2074 6865 2060 7265 636f 7264 5f74 7269   the `record_tri
-000094c0: 636b 5f6c 6561 726e 6564 2829 6020 616e  ck_learned()` an
-000094d0: 640a 7768 656e 2063 616c 6c69 6e67 2060  d.when calling `
-000094e0: 6765 745f 646f 6728 2960 2e0a 0a60 6060  get_dog()`...```
-000094f0: 7079 7468 6f6e 0a72 6563 6f72 645f 7472  python.record_tr
-00009500: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
-00009510: 6964 2c20 7472 6963 6b3d 2773 6974 2729  id, trick='sit')
-00009520: 0a0a 646f 6720 3d20 6765 745f 646f 6728  ..dog = get_dog(
-00009530: 646f 675f 6964 290a 6173 7365 7274 2064  dog_id).assert d
-00009540: 6f67 2e6e 616d 6520 3d3d 2027 4669 646f  og.name == 'Fido
-00009550: 270a 6173 7365 7274 2064 6f67 2e74 7269  '.assert dog.tri
-00009560: 636b 7320 3d3d 205b 2772 6f6c 6c20 6f76  cks == ['roll ov
-00009570: 6572 272c 2027 6665 7463 6820 6261 6c6c  er', 'fetch ball
-00009580: 272c 2027 7369 7427 5d0a 6173 7365 7274  ', 'sit'].assert
-00009590: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
-000095a0: 330a 6173 7365 7274 2064 6f67 2e69 735f  3.assert dog.is_
-000095b0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
-000095c0: 2054 7275 650a 6060 600a 0a57 6520 6361   True.```..We ca
-000095d0: 6e20 7365 6520 6672 6f6d 2074 6865 2060  n see from the `
-000095e0: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-000095f0: 6020 6174 7472 6962 7574 6520 7468 6174  ` attribute that
-00009600: 2074 6865 2060 446f 6760 206f 626a 6563   the `Dog` objec
-00009610: 7420 7761 7320 696e 6465 6564 0a72 6563  t was indeed.rec
-00009620: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
-00009630: 7468 6520 736e 6170 7368 6f74 2e0a 0a0a  the snapshot....
-00009640: 2323 2320 5265 6164 2061 6c6c 2065 7665  ### Read all eve
-00009650: 6e74 730a 0a54 6865 206d 6574 686f 6420  nts..The method 
-00009660: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-00009670: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
-00009680: 746f 2072 6561 6420 616c 6c20 7265 636f  to read all reco
-00009690: 7264 6564 2065 7665 6e74 730a 696e 2074  rded events.in t
-000096a0: 6865 2064 6174 6162 6173 6520 696e 2074  he database in t
-000096b0: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
-000096c0: 7265 2072 6563 6f72 6465 642e 2049 7420  re recorded. It 
-000096d0: 7265 7475 726e 7320 616e 2069 7465 7261  returns an itera
-000096e0: 626c 6520 6f66 0a65 7665 6e74 7320 7468  ble of.events th
-000096f0: 6174 2068 6176 6520 6265 656e 2072 6563  at have been rec
-00009700: 6f72 6465 6420 696e 2074 6865 2064 6174  orded in the dat
-00009710: 6162 6173 652e 2049 7465 7261 7469 6e67  abase. Iterating
-00009720: 206f 7665 7220 7468 6973 2069 7465 7261   over this itera
-00009730: 626c 650a 6f62 6a65 6374 2077 696c 6c20  ble.object will 
-00009740: 7374 6f70 2077 6865 6e20 6974 2068 6173  stop when it has
-00009750: 2079 6965 6c64 6564 2074 6865 206c 6173   yielded the las
-00009760: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-00009770: 2e20 5468 6520 7265 6365 6976 6564 0a72  . The received.r
-00009780: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
-00009790: 6a65 6374 2061 7265 2069 6e73 7461 6e63  ject are instanc
-000097a0: 6573 206f 6620 7468 6520 6052 6563 6f72  es of the `Recor
-000097b0: 6465 6445 7665 6e74 6020 636c 6173 7320  dedEvent` class 
-000097c0: 2873 6565 2074 6865 0a4e 6f74 6573 2073  (see the.Notes s
-000097d0: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
-000097e0: 2064 6574 6169 6c73 206f 6620 7468 6973   details of this
-000097f0: 2063 6c61 7373 292e 0a0a 5468 6973 206d   class)...This m
-00009800: 6574 686f 6420 7375 7070 6f72 7473 2073  ethod supports s
-00009810: 6576 656e 206f 7074 696f 6e61 6c20 6172  even optional ar
-00009820: 6775 6d65 6e74 732c 2060 636f 6d6d 6974  guments, `commit
-00009830: 5f70 6f73 6974 696f 6e60 2c20 6062 6163  _position`, `bac
-00009840: 6b77 6172 6473 602c 0a60 6669 6c74 6572  kwards`,.`filter
-00009850: 5f65 7863 6c75 6465 602c 2060 6669 6c74  _exclude`, `filt
-00009860: 6572 5f69 6e63 6c75 6465 602c 2060 6669  er_include`, `fi
-00009870: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
-00009880: 616d 6560 2c20 606c 696d 6974 602c 2061  ame`, `limit`, a
-00009890: 6e64 2060 7469 6d65 6f75 7460 2e0a 0a54  nd `timeout`...T
-000098a0: 6865 206f 7074 696f 6e61 6c20 6063 6f6d  he optional `com
-000098b0: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-000098c0: 6775 6d65 6e74 2069 7320 616e 206f 7074  gument is an opt
-000098d0: 696f 6e61 6c20 696e 7465 6765 7220 7468  ional integer th
-000098e0: 6174 2063 616e 2062 6520 7573 6564 2074  at can be used t
-000098f0: 6f0a 7370 6563 6966 7920 7468 6520 636f  o.specify the co
-00009900: 6d6d 6974 2070 6f73 6974 696f 6e20 6672  mmit position fr
-00009910: 6f6d 2077 6869 6368 2074 6f20 7374 6172  om which to star
-00009920: 7420 7265 6164 696e 672e 2054 6869 7320  t reading. This 
-00009930: 6172 6775 6d65 6e74 2069 7320 604e 6f6e  argument is `Non
-00009940: 6560 2062 790a 6465 6661 756c 742c 206d  e` by.default, m
-00009950: 6561 6e69 6e67 2074 6861 7420 616c 6c20  eaning that all 
-00009960: 7468 6520 6576 656e 7473 2077 696c 6c20  the events will 
-00009970: 6265 2072 6561 6420 6569 7468 6572 2066  be read either f
-00009980: 726f 6d20 7468 6520 7374 6172 742c 206f  rom the start, o
-00009990: 720a 6672 6f6d 2074 6865 2065 6e64 2069  r.from the end i
-000099a0: 6620 6062 6163 6b77 6172 6473 6020 6973  f `backwards` is
-000099b0: 2060 5472 7565 602e 2050 6c65 6173 6520   `True`. Please 
-000099c0: 6e6f 7465 2c20 6966 2061 2063 6f6d 6d69  note, if a commi
-000099d0: 7420 706f 7369 7469 6f6e 2069 7320 7370  t position is sp
-000099e0: 6563 6966 6965 642c 0a69 7420 6d75 7374  ecified,.it must
-000099f0: 2062 6520 616e 2061 6374 7561 6c6c 7920   be an actually 
-00009a00: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
-00009a10: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
-00009a20: 6461 7461 6261 7365 2e0a 416e 7920 6f74  database..Any ot
-00009a30: 6865 7220 6e75 6d62 6572 2077 696c 6c20  her number will 
-00009a40: 7265 7375 6c74 2069 6e20 6120 7365 7276  result in a serv
-00009a50: 6572 2065 7272 6f72 2028 6174 206c 6561  er error (at lea
-00009a60: 7374 2069 6e20 4576 656e 7453 746f 7265  st in EventStore
-00009a70: 4442 2076 3231 2e31 3029 2e0a 0a54 6865  DB v21.10)...The
-00009a80: 206f 7074 696f 6e61 6c20 6062 6163 6b77   optional `backw
-00009a90: 6172 6473 6020 6172 6775 6d65 6e74 2069  ards` argument i
-00009aa0: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
-00009ab0: 602e 2054 6865 2064 6566 6175 6c74 2069  `. The default i
-00009ac0: 7320 6046 616c 7365 602c 2077 6869 6368  s `False`, which
-00009ad0: 0a6d 6561 6e73 2074 6865 2064 6174 6162  .means the datab
-00009ae0: 6173 6520 7769 6c6c 2062 6520 7265 6164  ase will be read
-00009af0: 2066 6f72 7761 7264 7320 6279 2064 6566   forwards by def
-00009b00: 6175 6c74 2c20 736f 2074 6861 7420 6576  ault, so that ev
-00009b10: 656e 7473 2061 7265 2072 6574 7572 6e65  ents are returne
-00009b20: 6420 696e 2074 6865 0a6f 7264 6572 2074  d in the.order t
-00009b30: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
-00009b40: 642c 2049 6620 6062 6163 6b77 6172 6473  d, If `backwards
-00009b50: 6020 6973 2060 5472 7565 602c 2074 6865  ` is `True`, the
-00009b60: 2065 7665 6e74 7320 6172 6520 7265 7475   events are retu
-00009b70: 726e 6564 2069 6e20 7265 7665 7273 650a  rned in reverse.
-00009b80: 6f72 6465 722e 0a0a 5468 6520 6f70 7469  order...The opti
-00009b90: 6f6e 616c 2060 6669 6c74 6572 5f65 7863  onal `filter_exc
-00009ba0: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
-00009bb0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-00009bc0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-00009bd0: 6f6e 7320 7468 6174 0a6d 6174 6368 2072  ons that.match r
-00009be0: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-00009bf0: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
-00009c00: 6520 696e 636c 7564 6564 2e20 5468 6973  e included. This
-00009c10: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
-00009c20: 6f72 6564 0a69 6620 6066 696c 7465 725f  ored.if `filter_
-00009c30: 696e 636c 7564 6560 2069 7320 7365 7420  include` is set 
-00009c40: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
-00009c50: 6571 7565 6e63 652e 2042 7920 6465 6661  equence. By defa
-00009c60: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
-00009c70: 6e74 2069 7320 7365 740a 746f 206d 6174  nt is set.to mat
-00009c80: 6368 2074 6865 2065 7665 6e74 2074 7970  ch the event typ
-00009c90: 6573 206f 6620 2273 7973 7465 6d20 6576  es of "system ev
-00009ca0: 656e 7473 222c 2073 6f20 7468 6174 2045  ents", so that E
-00009cb0: 7665 6e74 5374 6f72 6544 4220 7379 7374  ventStoreDB syst
-00009cc0: 656d 2065 7665 6e74 730a 7769 6c6c 206e  em events.will n
-00009cd0: 6f74 206e 6f72 6d61 6c6c 7920 6265 2069  ot normally be i
-00009ce0: 6e63 6c75 6465 642e 2053 6565 2074 6865  ncluded. See the
-00009cf0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-00009d00: 656c 6f77 2066 6f72 206d 6f72 6520 696e  elow for more in
-00009d10: 666f 726d 6174 696f 6e0a 6162 6f75 7420  formation.about 
-00009d20: 6669 6c74 6572 2065 7870 7265 7373 696f  filter expressio
-00009d30: 6e73 2e0a 0a54 6865 206f 7074 696f 6e61  ns...The optiona
-00009d40: 6c20 6066 696c 7465 725f 696e 636c 7564  l `filter_includ
-00009d50: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
-00009d60: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
-00009d70: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
-00009d80: 0a74 6861 7420 6d61 7463 6820 7265 636f  .that match reco
-00009d90: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
-00009da0: 2073 686f 756c 6420 6265 2069 6e63 6c75   should be inclu
-00009db0: 6465 642e 2042 7920 6465 6661 756c 742c  ded. By default,
-00009dc0: 2074 6869 7320 6172 6775 6d65 6e74 0a69   this argument.i
-00009dd0: 7320 616e 2065 6d70 7479 2074 7570 6c65  s an empty tuple
-00009de0: 2e20 4966 2074 6869 7320 6172 6775 6d65  . If this argume
-00009df0: 6e74 2069 7320 7365 7420 746f 2061 206e  nt is set to a n
-00009e00: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
-00009e10: 652c 2074 6865 0a60 6669 6c74 6572 5f65  e, the.`filter_e
-00009e20: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
-00009e30: 2069 7320 6967 6e6f 7265 642e 0a0a 5468   is ignored...Th
-00009e40: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
-00009e50: 6572 5f62 795f 7374 7265 616d 5f6e 616d  er_by_stream_nam
-00009e60: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
-00009e70: 2050 7974 686f 6e20 6062 6f6f 6c60 2074   Python `bool` t
-00009e80: 6861 7420 696e 6469 6361 7465 7320 7768  hat indicates wh
-00009e90: 6574 6865 720a 7468 6520 6669 6c74 6572  ether.the filter
-00009ea0: 2077 696c 6c20 6170 706c 7920 746f 2065   will apply to e
-00009eb0: 7665 6e74 2074 7970 6573 206f 7220 7374  vent types or st
-00009ec0: 7265 616d 206e 616d 6573 2e20 4279 2064  ream names. By d
-00009ed0: 6566 6175 6c74 2c20 7468 6973 2076 616c  efault, this val
-00009ee0: 7565 2069 7320 6046 616c 7365 600a 616e  ue is `False`.an
-00009ef0: 6420 736f 2074 6865 2066 696c 7465 7269  d so the filteri
-00009f00: 6e67 2077 696c 6c20 6170 706c 7920 746f  ng will apply to
-00009f10: 2074 6865 2065 7665 6e74 2074 7970 6520   the event type 
-00009f20: 7374 7269 6e67 7320 6f66 2072 6563 6f72  strings of recor
-00009f30: 6465 6420 6576 656e 7473 2e0a 0a54 6865  ded events...The
-00009f40: 206f 7074 696f 6e61 6c20 606c 696d 6974   optional `limit
-00009f50: 6020 6172 6775 6d65 6e74 2069 7320 616e  ` argument is an
-00009f60: 2069 6e74 6567 6572 2077 6869 6368 2072   integer which r
-00009f70: 6573 7472 6963 7473 2074 6865 206e 756d  estricts the num
-00009f80: 6265 7220 6f66 2065 7665 6e74 7320 7468  ber of events th
-00009f90: 6174 0a77 696c 6c20 6265 2072 6574 7572  at.will be retur
-00009fa0: 6e65 642e 2054 6865 2064 6566 6175 6c74  ned. The default
-00009fb0: 2076 616c 7565 2069 7320 6073 7973 2e6d   value is `sys.m
-00009fc0: 6178 696e 7460 2e0a 0a54 6865 206f 7074  axint`...The opt
-00009fd0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00009fe0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-00009ff0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-0000a000: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
-0000a010: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-0000a020: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-0000a030: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-0000a040: 6520 6669 6c74 6572 696e 6720 6f66 2065  e filtering of e
-0000a050: 7665 6e74 7320 6973 2064 6f6e 6520 6f6e  vents is done on
-0000a060: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
-0000a070: 4220 7365 7276 6572 2e20 5468 650a 606c  B server. The.`l
-0000a080: 696d 6974 6020 6172 6775 6d65 6e74 2069  imit` argument i
-0000a090: 7320 6170 706c 6965 6420 6f6e 2074 6865  s applied on the
-0000a0a0: 2073 6572 7665 7220 6166 7465 7220 6669   server after fi
-0000a0b0: 6c74 6572 696e 672e 0a0a 5768 656e 2072  ltering...When r
-0000a0c0: 6561 6469 6e67 2066 6f72 7761 7264 7320  eading forwards 
-0000a0d0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-0000a0e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
-0000a0f0: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
-0000a100: 6520 7370 6563 6966 6965 640a 706f 7369  e specified.posi
-0000a110: 7469 6f6e 2057 494c 4c20 6265 2069 6e63  tion WILL be inc
-0000a120: 6c75 6465 642e 2048 6f77 6576 6572 2c20  luded. However, 
-0000a130: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
-0000a140: 6b77 6172 6473 2c20 7468 6520 6576 656e  kwards, the even
-0000a150: 7420 6174 2074 6865 0a73 7065 6369 6669  t at the.specifi
-0000a160: 6564 2070 6f73 6974 696f 6e20 7769 6c6c  ed position will
-0000a170: 204e 4f54 2062 6520 696e 636c 7564 6564   NOT be included
-0000a180: 2e20 2854 6869 7320 6e6f 6e2d 696e 636c  . (This non-incl
-0000a190: 7573 6976 6520 6265 6861 7669 6f75 722c  usive behaviour,
-0000a1a0: 206f 6620 6578 636c 7564 696e 670a 7468   of excluding.th
-0000a1b0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
-0000a1c0: 6974 2070 6f73 6974 696f 6e20 7768 656e  it position when
-0000a1d0: 2072 6561 6469 6e67 2061 6c6c 2073 7472   reading all str
-0000a1e0: 6561 6d73 2062 6163 6b77 6172 6473 2c20  eams backwards, 
-0000a1f0: 6469 6666 6572 7320 6672 6f6d 2074 6865  differs from the
-0000a200: 0a62 6568 6176 696f 7572 2077 6865 6e20  .behaviour when 
-0000a210: 7265 6164 696e 6720 6120 7374 7265 616d  reading a stream
-0000a220: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
-0000a230: 6120 7370 6563 6966 6963 2073 7472 6561  a specific strea
-0000a240: 6d20 706f 7369 7469 6f6e 2e29 0a0a 5468  m position.)..Th
-0000a250: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-0000a260: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-0000a270: 6420 616c 6c20 6576 656e 7473 2069 6e20  d all events in 
-0000a280: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
-0000a290: 7468 650a 6f72 6465 7220 7468 6579 2077  the.order they w
-0000a2a0: 6572 6520 7265 636f 7264 6564 2e0a 0a60  ere recorded...`
-0000a2b0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
-0000a2c0: 3d20 6c69 7374 2863 6c69 656e 742e 7265  = list(client.re
-0000a2d0: 6164 5f61 6c6c 5f65 7665 6e74 7328 2929  ad_all_events())
-0000a2e0: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-0000a2f0: 6e74 7329 203e 3d20 330a 6060 600a 0a54  nts) >= 3.```..T
-0000a300: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0000a310: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
-0000a320: 6164 2061 6c6c 2072 6563 6f72 6465 6420  ad all recorded 
-0000a330: 6576 656e 7473 2066 726f 6d20 6120 7370  events from a sp
-0000a340: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
-0000a350: 7369 7469 6f6e 2e0a 0a60 6060 7079 7468  sition...```pyth
-0000a360: 6f6e 0a65 7665 6e74 7320 3d20 6c69 7374  on.events = list
-0000a370: 280a 2020 2020 636c 6965 6e74 2e72 6561  (.    client.rea
-0000a380: 645f 616c 6c5f 6576 656e 7473 280a 2020  d_all_events(.  
-0000a390: 2020 2020 2020 636f 6d6d 6974 5f70 6f73        commit_pos
-0000a3a0: 6974 696f 6e3d 636f 6d6d 6974 5f70 6f73  ition=commit_pos
-0000a3b0: 6974 696f 6e31 0a20 2020 2029 0a29 0a0a  ition1.    ).)..
-0000a3c0: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-0000a3d0: 7329 203d 3d20 370a 0a61 7373 6572 7420  s) == 7..assert 
-0000a3e0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-0000a3f0: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000a400: 6e61 6d65 310a 6173 7365 7274 2065 7665  name1.assert eve
-0000a410: 6e74 735b 305d 2e73 7472 6561 6d5f 706f  nts[0].stream_po
-0000a420: 7369 7469 6f6e 203d 3d20 300a 6173 7365  sition == 0.asse
-0000a430: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
-0000a440: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
-0000a450: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-0000a460: 5d2e 6461 7461 203d 3d20 6576 656e 7431  ].data == event1
-0000a470: 2e64 6174 610a 0a61 7373 6572 7420 6576  .data..assert ev
-0000a480: 656e 7473 5b31 5d2e 7374 7265 616d 5f6e  ents[1].stream_n
-0000a490: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000a4a0: 6d65 310a 6173 7365 7274 2065 7665 6e74  me1.assert event
-0000a4b0: 735b 315d 2e73 7472 6561 6d5f 706f 7369  s[1].stream_posi
-0000a4c0: 7469 6f6e 203d 3d20 310a 6173 7365 7274  tion == 1.assert
-0000a4d0: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
-0000a4e0: 3d3d 2065 7665 6e74 322e 7479 7065 0a61  == event2.type.a
-0000a4f0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-0000a500: 6461 7461 203d 3d20 6576 656e 7432 2e64  data == event2.d
-0000a510: 6174 610a 0a61 7373 6572 7420 6576 656e  ata..assert even
-0000a520: 7473 5b32 5d2e 7374 7265 616d 5f6e 616d  ts[2].stream_nam
-0000a530: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-0000a540: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-0000a550: 325d 2e73 7472 6561 6d5f 706f 7369 7469  2].stream_positi
-0000a560: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
-0000a570: 7665 6e74 735b 325d 2e74 7970 6520 3d3d  vents[2].type ==
-0000a580: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
-0000a590: 6572 7420 6576 656e 7473 5b32 5d2e 6461  ert events[2].da
-0000a5a0: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
-0000a5b0: 610a 0a61 7373 6572 7420 6576 656e 7473  a..assert events
-0000a5c0: 5b33 5d2e 7479 7065 203d 3d20 2244 6f67  [3].type == "Dog
-0000a5d0: 5265 6769 7374 6572 6564 220a 6173 7365  Registered".asse
-0000a5e0: 7274 2065 7665 6e74 735b 345d 2e74 7970  rt events[4].typ
-0000a5f0: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
-0000a600: 5472 6963 6b22 0a61 7373 6572 7420 6576  Trick".assert ev
-0000a610: 656e 7473 5b35 5d2e 7479 7065 203d 3d20  ents[5].type == 
-0000a620: 2244 6f67 4c65 6172 6e65 6454 7269 636b  "DogLearnedTrick
-0000a630: 220a 6173 7365 7274 2065 7665 6e74 735b  ".assert events[
-0000a640: 365d 2e74 7970 6520 3d3d 2022 446f 674c  6].type == "DogL
-0000a650: 6561 726e 6564 5472 6963 6b22 0a60 6060  earnedTrick".```
-0000a660: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-0000a670: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-0000a680: 2072 6561 6420 616c 6c20 7265 636f 7264   read all record
-0000a690: 6564 2065 7665 6e74 7320 696e 2072 6576  ed events in rev
-0000a6a0: 6572 7365 206f 7264 6572 2e0a 0a60 6060  erse order...```
-0000a6b0: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
-0000a6c0: 6c69 7374 280a 2020 2020 636c 6965 6e74  list(.    client
-0000a6d0: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
-0000a6e0: 280a 2020 2020 2020 2020 6261 636b 7761  (.        backwa
-0000a6f0: 7264 733d 5472 7565 0a20 2020 2029 0a29  rds=True.    ).)
-0000a700: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-0000a710: 6e74 7329 203e 3d20 330a 0a61 7373 6572  nts) >= 3..asser
-0000a720: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
-0000a730: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
-0000a740: 7269 636b 220a 6173 7365 7274 2065 7665  rick".assert eve
-0000a750: 6e74 735b 315d 2e74 7970 6520 3d3d 2022  nts[1].type == "
-0000a760: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
-0000a770: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
-0000a780: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-0000a790: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
-0000a7a0: 7274 2065 7665 6e74 735b 335d 2e74 7970  rt events[3].typ
-0000a7b0: 6520 3d3d 2022 446f 6752 6567 6973 7465  e == "DogRegiste
-0000a7c0: 7265 6422 0a0a 6173 7365 7274 2065 7665  red"..assert eve
-0000a7d0: 6e74 735b 345d 2e73 7472 6561 6d5f 6e61  nts[4].stream_na
-0000a7e0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-0000a7f0: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
-0000a800: 5b34 5d2e 7374 7265 616d 5f70 6f73 6974  [4].stream_posit
-0000a810: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
-0000a820: 6576 656e 7473 5b34 5d2e 7479 7065 203d  events[4].type =
-0000a830: 3d20 6576 656e 7433 2e74 7970 650a 6173  = event3.type.as
-0000a840: 7365 7274 2065 7665 6e74 735b 345d 2e64  sert events[4].d
-0000a850: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
-0000a860: 7461 0a0a 6173 7365 7274 2065 7665 6e74  ta..assert event
-0000a870: 735b 355d 2e73 7472 6561 6d5f 6e61 6d65  s[5].stream_name
-0000a880: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-0000a890: 0a61 7373 6572 7420 6576 656e 7473 5b35  .assert events[5
-0000a8a0: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-0000a8b0: 6e20 3d3d 2031 0a61 7373 6572 7420 6576  n == 1.assert ev
-0000a8c0: 656e 7473 5b35 5d2e 7479 7065 203d 3d20  ents[5].type == 
-0000a8d0: 6576 656e 7432 2e74 7970 650a 6173 7365  event2.type.asse
-0000a8e0: 7274 2065 7665 6e74 735b 355d 2e64 6174  rt events[5].dat
-0000a8f0: 6120 3d3d 2065 7665 6e74 322e 6461 7461  a == event2.data
-0000a900: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-0000a910: 365d 2e73 7472 6561 6d5f 6e61 6d65 203d  6].stream_name =
-0000a920: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
-0000a930: 7373 6572 7420 6576 656e 7473 5b36 5d2e  ssert events[6].
-0000a940: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-0000a950: 3d3d 2030 0a61 7373 6572 7420 6576 656e  == 0.assert even
-0000a960: 7473 5b36 5d2e 7479 7065 203d 3d20 6576  ts[6].type == ev
-0000a970: 656e 7431 2e74 7970 650a 6173 7365 7274  ent1.type.assert
-0000a980: 2065 7665 6e74 735b 365d 2e64 6174 6120   events[6].data 
-0000a990: 3d3d 2065 7665 6e74 312e 6461 7461 0a0a  == event1.data..
-0000a9a0: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
-0000a9b0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-0000a9c0: 2074 6f20 7265 6164 2061 206c 696d 6974   to read a limit
-0000a9d0: 6564 206e 756d 6265 7220 286f 6e65 2920  ed number (one) 
-0000a9e0: 6f66 2074 6865 2072 6563 6f72 6465 6420  of the recorded 
-0000a9f0: 6576 656e 7473 0a69 6e20 7468 6520 6461  events.in the da
-0000aa00: 7461 6261 7365 2066 6f72 7761 7264 7320  tabase forwards 
-0000aa10: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-0000aa20: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
-0000aa30: 2050 6c65 6173 6520 6e6f 7465 2c20 7768   Please note, wh
-0000aa40: 656e 2072 6561 6469 6e67 0a61 6c6c 2065  en reading.all e
-0000aa50: 7665 6e74 7320 666f 7277 6172 6473 2066  vents forwards f
-0000aa60: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-0000aa70: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
-0000aa80: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
-0000aa90: 2073 7065 6369 6669 6564 0a70 6f73 6974   specified.posit
-0000aaa0: 696f 6e20 5749 4c4c 2062 6520 696e 636c  ion WILL be incl
-0000aab0: 7564 6564 2e0a 0a0a 6060 6070 7974 686f  uded....```pytho
-0000aac0: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
-0000aad0: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
-0000aae0: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
-0000aaf0: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
-0000ab00: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
-0000ab10: 7469 6f6e 312c 0a20 2020 2020 2020 206c  tion1,.        l
-0000ab20: 696d 6974 3d31 2c0a 2020 2020 290a 290a  imit=1,.    ).).
-0000ab30: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-0000ab40: 7473 2920 3d3d 2031 0a0a 6173 7365 7274  ts) == 1..assert
-0000ab50: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
-0000ab60: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000ab70: 5f6e 616d 6531 0a61 7373 6572 7420 6576  _name1.assert ev
-0000ab80: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-0000ab90: 6f73 6974 696f 6e20 3d3d 2030 0a61 7373  osition == 0.ass
-0000aba0: 6572 7420 6576 656e 7473 5b30 5d2e 7479  ert events[0].ty
-0000abb0: 7065 203d 3d20 6576 656e 7431 2e74 7970  pe == event1.typ
-0000abc0: 650a 6173 7365 7274 2065 7665 6e74 735b  e.assert events[
-0000abd0: 305d 2e64 6174 6120 3d3d 2065 7665 6e74  0].data == event
-0000abe0: 312e 6461 7461 0a0a 6173 7365 7274 2065  1.data..assert e
-0000abf0: 7665 6e74 735b 305d 2e63 6f6d 6d69 745f  vents[0].commit_
-0000ac00: 706f 7369 7469 6f6e 203d 3d20 636f 6d6d  position == comm
-0000ac10: 6974 5f70 6f73 6974 696f 6e31 0a60 6060  it_position1.```
-0000ac20: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-0000ac30: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-0000ac40: 2072 6561 6420 6120 6c69 6d69 7465 6420   read a limited 
-0000ac50: 6e75 6d62 6572 2028 6f6e 6529 206f 6620  number (one) of 
-0000ac60: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-0000ac70: 6e74 730a 696e 2074 6865 2064 6174 6162  nts.in the datab
-0000ac80: 6173 6520 6261 636b 7761 7264 7320 6672  ase backwards fr
-0000ac90: 6f6d 2074 6865 2065 6e64 2e20 5468 6973  om the end. This
-0000aca0: 2067 6976 6573 2074 6865 206c 6173 7420   gives the last 
-0000acb0: 7265 636f 7264 6564 2065 7665 6e74 2e0a  recorded event..
-0000acc0: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
-0000acd0: 7320 3d20 6c69 7374 280a 2020 2020 636c  s = list(.    cl
-0000ace0: 6965 6e74 2e72 6561 645f 616c 6c5f 6576  ient.read_all_ev
-0000acf0: 656e 7473 280a 2020 2020 2020 2020 6261  ents(.        ba
-0000ad00: 636b 7761 7264 733d 5472 7565 2c0a 2020  ckwards=True,.  
-0000ad10: 2020 2020 2020 6c69 6d69 743d 312c 0a20        limit=1,. 
-0000ad20: 2020 2029 0a29 0a0a 6173 7365 7274 206c     ).)..assert l
-0000ad30: 656e 2865 7665 6e74 7329 203d 3d20 310a  en(events) == 1.
-0000ad40: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-0000ad50: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-0000ad60: 6172 6e65 6454 7269 636b 220a 6060 600a  arnedTrick".```.
-0000ad70: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000ad80: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-0000ad90: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
-0000ada0: 756d 6265 7220 286f 6e65 2920 6f66 2074  umber (one) of t
-0000adb0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000adc0: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
-0000add0: 7365 2062 6163 6b77 6172 6473 2066 726f  se backwards fro
-0000ade0: 6d20 6120 7370 6563 6966 6963 2063 6f6d  m a specific com
-0000adf0: 6d69 7420 706f 7369 7469 6f6e 2e20 506c  mit position. Pl
-0000ae00: 6561 7365 206e 6f74 652c 2077 6865 6e20  ease note, when 
-0000ae10: 7265 6164 696e 670a 616c 6c20 6576 656e  reading.all even
-0000ae20: 7473 2062 6163 6b77 6172 6473 2066 726f  ts backwards fro
-0000ae30: 6d20 6120 7370 6563 6966 6963 2063 6f6d  m a specific com
-0000ae40: 6d69 7420 706f 7369 7469 6f6e 2c20 7468  mit position, th
-0000ae50: 6520 6576 656e 7420 6174 2074 6865 2073  e event at the s
-0000ae60: 7065 6369 6669 6564 0a70 6f73 6974 696f  pecified.positio
-0000ae70: 6e20 5749 4c4c 204e 4f54 2062 6520 696e  n WILL NOT be in
-0000ae80: 636c 7564 6564 2e0a 0a60 6060 7079 7468  cluded...```pyth
-0000ae90: 6f6e 0a65 7665 6e74 7320 3d20 6c69 7374  on.events = list
-0000aea0: 280a 2020 2020 636c 6965 6e74 2e72 6561  (.    client.rea
-0000aeb0: 645f 616c 6c5f 6576 656e 7473 280a 2020  d_all_events(.  
-0000aec0: 2020 2020 2020 636f 6d6d 6974 5f70 6f73        commit_pos
-0000aed0: 6974 696f 6e3d 636f 6d6d 6974 5f70 6f73  ition=commit_pos
-0000aee0: 6974 696f 6e32 2c0a 2020 2020 2020 2020  ition2,.        
-0000aef0: 6261 636b 7761 7264 733d 5472 7565 2c0a  backwards=True,.
-0000af00: 2020 2020 2020 2020 6c69 6d69 743d 312c          limit=1,
-0000af10: 0a20 2020 2029 0a29 0a0a 6173 7365 7274  .    ).)..assert
-0000af20: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-0000af30: 310a 0a61 7373 6572 7420 6576 656e 7473  1..assert events
-0000af40: 5b30 5d2e 636f 6d6d 6974 5f70 6f73 6974  [0].commit_posit
-0000af50: 696f 6e20 3c20 636f 6d6d 6974 5f70 6f73  ion < commit_pos
-0000af60: 6974 696f 6e32 0a60 6060 0a0a 0a23 2323  ition2.```...###
-0000af70: 2047 6574 2063 7572 7265 6e74 2073 7472   Get current str
-0000af80: 6561 6d20 706f 7369 7469 6f6e 0a0a 5468  eam position..Th
-0000af90: 6520 6067 6574 5f73 7472 6561 6d5f 706f  e `get_stream_po
-0000afa0: 7369 7469 6f6e 2829 6020 6d65 7468 6f64  sition()` method
-0000afb0: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
-0000afc0: 6765 7420 7468 6520 2273 7472 6561 6d20  get the "stream 
-0000afd0: 706f 7369 7469 6f6e 2220 6f66 2074 6865  position" of the
-0000afe0: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
-0000aff0: 7665 6e74 2069 6e20 6120 7374 7265 616d  vent in a stream
-0000b000: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
-0000b010: 6173 2061 2060 7374 7265 616d 5f6e 616d  as a `stream_nam
-0000b020: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
-0000b030: 6368 2069 7320 7265 7175 6972 6564 2e0a  ch is required..
-0000b040: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
-0000b050: 6f20 7461 6b65 7320 616e 206f 7074 696f  o takes an optio
-0000b060: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-0000b070: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
-0000b080: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-0000b090: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
-0000b0a0: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
-0000b0b0: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
-0000b0c0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-0000b0d0: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-0000b0e0: 0a0a 5468 6520 7365 7175 656e 6365 206f  ..The sequence o
-0000b0f0: 6620 706f 7369 7469 6f6e 7320 696e 2061  f positions in a
-0000b100: 2073 7472 6561 6d20 6973 2067 6170 6c65   stream is gaple
-0000b110: 7373 2e20 4974 2069 7320 7a65 726f 2d62  ss. It is zero-b
-0000b120: 6173 6564 2c0a 736f 2074 6861 7420 6120  ased,.so that a 
-0000b130: 7374 7265 616d 2077 6974 6820 6f6e 6520  stream with one 
-0000b140: 7265 636f 7264 6564 2065 7665 6e74 2068  recorded event h
-0000b150: 6173 2061 2063 7572 7265 6e74 2073 7472  as a current str
-0000b160: 6561 6d0a 706f 7369 7469 6f6e 206f 6620  eam.position of 
-0000b170: 6030 602e 2054 6865 2063 7572 7265 6e74  `0`. The current
-0000b180: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-0000b190: 2069 7320 6031 6020 7768 656e 2061 2073   is `1` when a s
-0000b1a0: 7472 6561 6d20 6861 730a 7477 6f20 6576  tream has.two ev
-0000b1b0: 656e 7473 2c20 616e 6420 6974 2069 7320  ents, and it is 
-0000b1c0: 6032 6020 7768 656e 2074 6865 7265 2061  `2` when there a
-0000b1d0: 7265 2065 7665 6e74 732c 2061 6e64 2073  re events, and s
-0000b1e0: 6f20 6f6e 2e0a 0a49 6e20 7468 6520 6578  o on...In the ex
-0000b1f0: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
-0000b200: 2063 7572 7265 6e74 2073 7472 6561 6d20   current stream 
-0000b210: 706f 7369 7469 6f6e 2069 7320 6f62 7461  position is obta
-0000b220: 696e 6564 206f 6620 7468 650a 7374 7265  ined of the.stre
-0000b230: 616d 2074 6f20 7768 6963 6820 6576 656e  am to which even
-0000b240: 7473 2077 6572 6520 6170 7065 6e64 6564  ts were appended
-0000b250: 2069 6e20 7468 6520 6578 616d 706c 6573   in the examples
-0000b260: 2061 626f 7665 2e0a 4265 6361 7573 6520   above..Because 
-0000b270: 7468 6520 7365 7175 656e 6365 206f 6620  the sequence of 
-0000b280: 7374 7265 616d 2070 6f73 6974 696f 6e73  stream positions
-0000b290: 2069 7320 7a65 726f 2d62 6173 6564 2c20   is zero-based, 
-0000b2a0: 616e 6420 6265 6361 7573 650a 7468 7265  and because.thre
-0000b2b0: 6520 6576 656e 7473 2077 6572 6520 6170  e events were ap
-0000b2c0: 7065 6e64 6564 2c20 736f 2074 6865 2063  pended, so the c
-0000b2d0: 7572 7265 6e74 2073 7472 6561 6d20 706f  urrent stream po
-0000b2e0: 7369 7469 6f6e 2069 7320 6032 602e 0a0a  sition is `2`...
-0000b2f0: 6060 6070 7974 686f 6e0a 7374 7265 616d  ```python.stream
-0000b300: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
-0000b310: 6e74 2e67 6574 5f73 7472 6561 6d5f 706f  nt.get_stream_po
-0000b320: 7369 7469 6f6e 280a 2020 2020 7374 7265  sition(.    stre
-0000b330: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000b340: 616d 6531 0a29 0a0a 6173 7365 7274 2073  ame1.)..assert s
-0000b350: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-0000b360: 3d20 320a 6060 600a 0a49 6620 6120 7374  = 2.```..If a st
-0000b370: 7265 616d 2064 6f65 7320 6e6f 7420 6578  ream does not ex
-0000b380: 6973 742c 2074 6865 2072 6574 7572 6e65  ist, the returne
-0000b390: 6420 7374 7265 616d 2070 6f73 6974 696f  d stream positio
-0000b3a0: 6e20 7661 6c75 6520 6973 2060 4e6f 6e65  n value is `None
-0000b3b0: 602c 0a77 6869 6368 206d 6174 6368 6573  `,.which matches
-0000b3c0: 2074 6865 2072 6571 7569 7265 6420 6578   the required ex
-0000b3d0: 7065 6374 6564 2070 6f73 6974 696f 6e20  pected position 
-0000b3e0: 7768 656e 2061 7070 656e 6469 6e67 2074  when appending t
-0000b3f0: 6865 2066 6972 7374 2065 7665 6e74 0a6f  he first event.o
-0000b400: 6620 6120 6e65 7720 7374 7265 616d 2028  f a new stream (
-0000b410: 7365 6520 6162 6f76 6529 2e0a 0a60 6060  see above)...```
-0000b420: 7079 7468 6f6e 0a73 7472 6561 6d5f 706f  python.stream_po
-0000b430: 7369 7469 6f6e 203d 2063 6c69 656e 742e  sition = client.
-0000b440: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
-0000b450: 696f 6e28 0a20 2020 2073 7472 6561 6d5f  ion(.    stream_
-0000b460: 6e61 6d65 3d73 7472 2875 7569 6434 2829  name=str(uuid4()
-0000b470: 290a 290a 0a61 7373 6572 7420 7374 7265  ).)..assert stre
-0000b480: 616d 5f70 6f73 6974 696f 6e20 3d3d 204e  am_position == N
-0000b490: 6f6e 650a 6060 600a 0a54 6869 7320 6d65  one.```..This me
-0000b4a0: 7468 6f64 2074 616b 6573 2061 6e20 6f70  thod takes an op
-0000b4b0: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
-0000b4c0: 6074 696d 656f 7574 6020 7768 6963 6820  `timeout` which 
-0000b4d0: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
-0000b4e0: 6174 6020 7468 6174 2073 6574 730a 6120  at` that sets.a 
-0000b4f0: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
-0000b500: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-0000b510: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-0000b520: 6e2e 0a0a 0a23 2323 2047 6574 2063 7572  n....### Get cur
-0000b530: 7265 6e74 2063 6f6d 6d69 7420 706f 7369  rent commit posi
-0000b540: 7469 6f6e 0a0a 5468 6520 6d65 7468 6f64  tion..The method
-0000b550: 2060 6765 745f 636f 6d6d 6974 5f70 6f73   `get_commit_pos
-0000b560: 6974 696f 6e28 2960 2063 616e 2062 6520  ition()` can be 
-0000b570: 7573 6564 2074 6f20 6765 7420 7468 6520  used to get the 
-0000b580: 6375 7272 656e 740a 636f 6d6d 6974 2070  current.commit p
-0000b590: 6f73 6974 696f 6e20 6f66 2074 6865 2064  osition of the d
-0000b5a0: 6174 6162 6173 652e 0a0a 6060 6070 7974  atabase...```pyt
-0000b5b0: 686f 6e0a 636f 6d6d 6974 5f70 6f73 6974  hon.commit_posit
-0000b5c0: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
-0000b5d0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
-0000b5e0: 2829 0a60 6060 0a0a 5468 6973 206d 6574  ().```..This met
-0000b5f0: 686f 6420 7461 6b65 7320 616e 206f 7074  hod takes an opt
-0000b600: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
-0000b610: 7469 6d65 6f75 7460 2077 6869 6368 2069  timeout` which i
-0000b620: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
-0000b630: 7460 2074 6861 7420 7365 7473 0a61 2064  t` that sets.a d
-0000b640: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000b650: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000b660: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000b670: 2e0a 0a54 6869 7320 6d65 7468 6f64 2063  ...This method c
-0000b680: 616e 2062 6520 7573 6566 756c 2074 6f20  an be useful to 
-0000b690: 6d65 6173 7572 6520 7072 6f67 7265 7373  measure progress
-0000b6a0: 206f 6620 6120 646f 776e 7374 7265 616d   of a downstream
-0000b6b0: 2063 6f6d 706f 6e65 6e74 0a74 6861 7420   component.that 
-0000b6c0: 6973 2070 726f 6365 7373 696e 6720 616c  is processing al
-0000b6d0: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-0000b6e0: 732c 2062 7920 636f 6d70 6172 696e 6720  s, by comparing 
-0000b6f0: 7468 6520 6375 7272 656e 7420 636f 6d6d  the current comm
-0000b700: 6974 0a70 6f73 6974 696f 6e20 7769 7468  it.position with
-0000b710: 2074 6865 2072 6563 6f72 6465 6420 636f   the recorded co
-0000b720: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-0000b730: 2074 6865 206c 6173 7420 7375 6363 6573   the last succes
-0000b740: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-0000b750: 0a65 7665 6e74 2069 6e20 6120 646f 776e  .event in a down
-0000b760: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000b770: 2e0a 0a54 6865 2076 616c 7565 206f 6620  ...The value of 
-0000b780: 7468 6520 6063 6f6d 6d69 745f 706f 7369  the `commit_posi
-0000b790: 7469 6f6e 6020 6172 6775 6d65 6e74 2077  tion` argument w
-0000b7a0: 6865 6e20 7265 6164 696e 6720 6576 656e  hen reading even
-0000b7b0: 7473 2065 6974 6865 7220 6279 2075 7369  ts either by usi
-0000b7c0: 6e67 0a74 6865 2060 7265 6164 5f61 6c6c  ng.the `read_all
-0000b7d0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
-0000b7e0: 6420 6f72 2062 7920 7573 696e 6720 6120  d or by using a 
-0000b7f0: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-0000b800: 7074 696f 6e20 776f 756c 6420 7573 7561  ption would usua
-0000b810: 6c6c 790a 6265 2064 6574 6572 6d69 6e65  lly.be determine
-0000b820: 6420 6279 2074 6865 2072 6563 6f72 6465  d by the recorde
-0000b830: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-0000b840: 6e20 6f66 2074 6865 206c 6173 7420 7375  n of the last su
-0000b850: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-0000b860: 7373 6564 0a65 7665 6e74 2069 6e20 6120  ssed.event in a 
-0000b870: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-0000b880: 6e65 6e74 2e0a 0a0a 2323 2320 4765 7420  nent....### Get 
-0000b890: 7374 7265 616d 206d 6574 6164 6174 610a  stream metadata.
-0000b8a0: 0a54 6865 206d 6574 686f 6420 6067 6574  .The method `get
-0000b8b0: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
-0000b8c0: 2829 6020 6765 7473 2074 6865 206d 6574  ()` gets the met
-0000b8d0: 6164 6174 6120 666f 7220 6120 7374 7265  adata for a stre
-0000b8e0: 616d 2c20 616c 6f6e 670a 7769 7468 2074  am, along.with t
-0000b8f0: 6865 2076 6572 7369 6f6e 206f 6620 7468  he version of th
-0000b900: 6520 7374 7265 616d 206d 6574 6164 6174  e stream metadat
-0000b910: 612e 0a0a 6060 6070 7974 686f 6e0a 6d65  a...```python.me
-0000b920: 7461 6461 7461 2c20 6d65 7461 6461 7461  tadata, metadata
-0000b930: 5f76 6572 7369 6f6e 203d 2063 6c69 656e  _version = clien
-0000b940: 742e 6765 745f 7374 7265 616d 5f6d 6574  t.get_stream_met
-0000b950: 6164 6174 6128 7374 7265 616d 5f6e 616d  adata(stream_nam
-0000b960: 653d 7374 7265 616d 5f6e 616d 6531 290a  e=stream_name1).
-0000b970: 6060 600a 0a54 6865 2072 6574 7572 6e65  ```..The returne
-0000b980: 6420 606d 6574 6164 6174 6160 2076 616c  d `metadata` val
-0000b990: 7565 2069 7320 6120 5079 7468 6f6e 2060  ue is a Python `
-0000b9a0: 6469 6374 602e 2054 6865 2072 6574 7572  dict`. The retur
-0000b9b0: 6e65 6420 606d 6574 6164 6174 615f 7665  ned `metadata_ve
-0000b9c0: 7273 696f 6e60 0a76 616c 7565 2069 7320  rsion`.value is 
-0000b9d0: 6569 7468 6572 2061 6e20 6069 6e74 602c  either an `int`,
-0000b9e0: 206f 7220 604e 6f6e 6560 2069 6620 7468   or `None` if th
-0000b9f0: 6520 7374 7265 616d 2064 6f65 7320 6e6f  e stream does no
-0000ba00: 7420 6578 6973 742e 2054 6865 7365 2076  t exist. These v
-0000ba10: 616c 7565 7320 6361 6e0a 6265 2070 6173  alues can.be pas
-0000ba20: 7365 6420 696e 746f 2060 7365 745f 7374  sed into `set_st
-0000ba30: 7265 616d 5f6d 6574 6164 6174 6128 2960  ream_metadata()`
-0000ba40: 2e0a 0a0a 2323 2320 5365 7420 7374 7265  ....### Set stre
-0000ba50: 616d 206d 6574 6164 6174 610a 0a2a 7265  am metadata..*re
-0000ba60: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-0000ba70: 5468 6520 6d65 7468 6f64 2060 7365 745f  The method `set_
-0000ba80: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
-0000ba90: 2960 2073 6574 7320 7468 6520 6d65 7461  )` sets the meta
-0000baa0: 6461 7461 2066 6f72 2061 2073 7472 6561  data for a strea
-0000bab0: 6d2c 2061 6c6f 6e67 0a77 6974 6820 7468  m, along.with th
-0000bac0: 6520 7665 7273 696f 6e20 6f66 2074 6865  e version of the
-0000bad0: 2073 7472 6561 6d20 6d65 7461 6461 7461   stream metadata
-0000bae0: 2e0a 0a60 6060 7079 7468 6f6e 0a6d 6574  ...```python.met
-0000baf0: 6164 6174 615b 2266 6f6f 225d 203d 2022  adata["foo"] = "
-0000bb00: 6261 7222 0a0a 636c 6965 6e74 2e73 6574  bar"..client.set
-0000bb10: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
-0000bb20: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-0000bb30: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
-0000bb40: 2020 2020 6d65 7461 6461 7461 3d6d 6574      metadata=met
-0000bb50: 6164 6174 612c 0a20 2020 2065 7870 6563  adata,.    expec
-0000bb60: 7465 645f 706f 7369 7469 6f6e 3d6d 6574  ted_position=met
-0000bb70: 6164 6174 615f 7665 7273 696f 6e2c 0a29  adata_version,.)
-0000bb80: 0a60 6060 0a0a 5468 6520 6065 7870 6563  .```..The `expec
-0000bb90: 7465 645f 706f 7369 7469 6f6e 6020 6172  ted_position` ar
-0000bba0: 6775 6d65 6e74 2073 686f 756c 6420 6265  gument should be
-0000bbb0: 2074 6865 2063 7572 7265 6e74 2076 6572   the current ver
-0000bbc0: 7369 6f6e 206f 6620 7468 6520 7374 7265  sion of the stre
-0000bbd0: 616d 206d 6574 6164 6174 612e 0a0a 506c  am metadata...Pl
-0000bbe0: 6561 7365 2072 6566 6572 2074 6f20 7468  ease refer to th
-0000bbf0: 6520 4576 656e 7453 746f 7265 4442 2064  e EventStoreDB d
-0000bc00: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
-0000bc10: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0000bc20: 6e20 6162 6f75 7420 7374 7265 616d 0a6d  n about stream.m
-0000bc30: 6574 6164 6174 612e 0a0a 2323 2320 4465  etadata...### De
-0000bc40: 6c65 7465 2073 7472 6561 6d0a 0a2a 7265  lete stream..*re
-0000bc50: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-0000bc60: 5468 6520 6d65 7468 6f64 2060 6465 6c65  The method `dele
-0000bc70: 7465 5f73 7472 6561 6d28 2960 2063 616e  te_stream()` can
-0000bc80: 2062 6520 7573 6564 2074 6f20 2264 656c   be used to "del
-0000bc90: 6574 6522 2061 2073 7472 6561 6d2e 0a0a  ete" a stream...
-0000bca0: 6060 6070 7974 686f 6e0a 636f 6d6d 6974  ```python.commit
-0000bcb0: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
-0000bcc0: 6e74 2e64 656c 6574 655f 7374 7265 616d  nt.delete_stream
-0000bcd0: 2873 7472 6561 6d5f 6e61 6d65 3d73 7472  (stream_name=str
-0000bce0: 6561 6d5f 6e61 6d65 312c 2065 7870 6563  eam_name1, expec
-0000bcf0: 7465 645f 706f 7369 7469 6f6e 3d32 290a  ted_position=2).
-0000bd00: 6060 600a 0a41 6674 6572 2064 656c 6574  ```..After delet
-0000bd10: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
-0000bd20: 2773 2073 7469 6c6c 2070 6f73 7369 626c  's still possibl
-0000bd30: 6520 746f 2061 7070 656e 6420 6e65 7720  e to append new 
-0000bd40: 6576 656e 7473 2e20 5265 6164 696e 6720  events. Reading 
-0000bd50: 6672 6f6d 2061 0a64 656c 6574 6564 2073  from a.deleted s
-0000bd60: 7472 6561 6d20 7769 6c6c 2072 6574 7572  tream will retur
-0000bd70: 6e20 6f6e 6c79 2065 7665 6e74 7320 7468  n only events th
-0000bd80: 6174 2068 6176 6520 6265 656e 2061 7070  at have been app
-0000bd90: 656e 6465 6420 6166 7465 7220 6974 2077  ended after it w
-0000bda0: 6173 0a64 656c 6574 6564 2e0a 0a23 2323  as.deleted...###
-0000bdb0: 2054 6f6d 6273 746f 6e65 2073 7472 6561   Tombstone strea
-0000bdc0: 6d0a 0a2a 7265 7175 6972 6573 206c 6561  m..*requires lea
-0000bdd0: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-0000bde0: 2060 746f 6d62 7374 6f6e 655f 7374 7265   `tombstone_stre
-0000bdf0: 616d 2829 6020 6361 6e20 6265 2075 7365  am()` can be use
-0000be00: 6420 746f 2022 746f 6d62 7374 6f6e 6522  d to "tombstone"
-0000be10: 2061 2073 7472 6561 6d2e 0a0a 6060 6070   a stream...```p
-0000be20: 7974 686f 6e0a 636f 6d6d 6974 5f70 6f73  ython.commit_pos
-0000be30: 6974 696f 6e20 3d20 636c 6965 6e74 2e74  ition = client.t
-0000be40: 6f6d 6273 746f 6e65 5f73 7472 6561 6d28  ombstone_stream(
-0000be50: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000be60: 616d 5f6e 616d 6531 2c20 6578 7065 6374  am_name1, expect
-0000be70: 6564 5f70 6f73 6974 696f 6e3d 3229 0a60  ed_position=2).`
-0000be80: 6060 0a0a 4166 7465 7220 746f 6d62 7374  ``..After tombst
-0000be90: 6f6e 696e 6720 6120 7374 7265 616d 2c20  oning a stream, 
-0000bea0: 6974 2773 206e 6f74 2070 6f73 7369 626c  it's not possibl
-0000beb0: 6520 746f 2061 7070 656e 6420 6e65 7720  e to append new 
-0000bec0: 6576 656e 7473 2e0a 0a0a 2323 2043 6174  events....## Cat
-0000bed0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-0000bee0: 6f6e 730a 0a22 4361 7463 682d 7570 2220  ons.."Catch-up" 
-0000bef0: 7375 6273 6372 6970 7469 6f6e 7320 6361  subscriptions ca
-0000bf00: 6e20 6265 2075 7365 6420 746f 2072 6563  n be used to rec
-0000bf10: 6569 7665 2065 7665 6e74 7320 7468 6174  eive events that
-0000bf20: 2068 6176 6520 6265 656e 2072 6563 6f72   have been recor
-0000bf30: 6465 640a 696e 2074 6865 2064 6174 6162  ded.in the datab
-0000bf40: 6173 652c 2061 6e64 2061 6c73 6f20 6576  ase, and also ev
-0000bf50: 656e 7473 2074 6861 7420 6172 6520 7265  ents that are re
-0000bf60: 636f 7264 6564 2061 6674 6572 2061 2073  corded after a s
-0000bf70: 7562 7363 7269 7074 696f 6e20 7761 7320  ubscription was 
-0000bf80: 7374 6172 7465 642e 0a0a 5468 6520 6d65  started...The me
-0000bf90: 7468 6f64 2060 7375 6273 6372 6962 655f  thod `subscribe_
-0000bfa0: 616c 6c5f 6576 656e 7473 2829 6020 7374  all_events()` st
-0000bfb0: 6172 7473 2061 2063 6174 6368 2d75 7020  arts a catch-up 
-0000bfc0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-0000bfd0: 7265 6365 6976 6520 616c 6c0a 6576 656e  receive all.even
-0000bfe0: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
-0000bff0: 6e20 616e 6420 7769 6c6c 2062 6520 7265  n and will be re
-0000c000: 636f 7264 6564 2069 6e20 7468 6520 6461  corded in the da
-0000c010: 7461 6261 7365 2e20 5468 6520 6d65 7468  tabase. The meth
-0000c020: 6f64 0a60 7375 6273 6372 6962 655f 7374  od.`subscribe_st
-0000c030: 7265 616d 5f65 7665 6e74 7328 2960 2073  ream_events()` s
-0000c040: 7461 7274 7320 6120 6361 7463 682d 7570  tarts a catch-up
-0000c050: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
-0000c060: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-0000c070: 6672 6f6d 0a61 2073 7065 6369 6669 6320  from.a specific 
-0000c080: 7374 7265 616d 2e0a 0a43 6174 6368 2d75  stream...Catch-u
-0000c090: 7020 7375 6273 6372 6970 7469 6f6e 7320  p subscriptions 
-0000c0a0: 656e 6361 7073 756c 6174 6520 6120 7374  encapsulate a st
-0000c0b0: 7265 616d 696e 6720 6752 5043 2063 616c  reaming gRPC cal
-0000c0c0: 6c20 7768 6963 6820 6973 0a6b 6570 7420  l which is.kept 
-0000c0d0: 6f70 656e 2062 7920 7468 6520 7365 7276  open by the serv
-0000c0e0: 6572 2c20 7769 7468 206e 6577 6c79 2072  er, with newly r
-0000c0f0: 6563 6f72 6465 6420 6576 656e 7473 2073  ecorded events s
-0000c100: 656e 7420 746f 2074 6865 2063 6c69 656e  ent to the clien
-0000c110: 740a 6173 2074 6865 2063 6c69 656e 7420  t.as the client 
-0000c120: 6974 6572 6174 6573 206f 7665 7220 7468  iterates over th
-0000c130: 6520 7375 6273 6372 6970 7469 6f6e 2072  e subscription r
-0000c140: 6573 706f 6e73 652e 0a0a 4d61 6e79 2063  esponse...Many c
-0000c150: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000c160: 7469 6f6e 7320 6361 6e20 6265 2063 7265  tions can be cre
-0000c170: 6174 6564 2c20 636f 6e63 7572 7265 6e74  ated, concurrent
-0000c180: 6c79 206f 7220 7375 6363 6573 7369 7665  ly or successive
-0000c190: 6c79 2c20 616e 6420 616c 6c0a 7769 6c6c  ly, and all.will
-0000c1a0: 2072 6563 6569 7665 2061 6c6c 2074 6865   receive all the
-0000c1b0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000c1c0: 2074 6865 7920 6861 7665 2062 6565 6e20   they have been 
-0000c1d0: 7265 7175 6573 7465 6420 746f 2072 6563  requested to rec
-0000c1e0: 6569 7665 2e0a 0a54 6865 2072 6563 6569  eive...The recei
-0000c1f0: 7665 6420 7265 636f 7264 6564 2065 7665  ved recorded eve
-0000c200: 6e74 206f 626a 6563 7420 6172 6520 696e  nt object are in
-0000c210: 7374 616e 6365 7320 6f66 2074 6865 2060  stances of the `
-0000c220: 5265 636f 7264 6564 4576 656e 7460 2063  RecordedEvent` c
-0000c230: 6c61 7373 0a28 7365 6520 7468 6520 4e6f  lass.(see the No
-0000c240: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
-0000c250: 7720 666f 7220 6465 7461 696c 7320 6f66  w for details of
-0000c260: 2074 6869 7320 636c 6173 7329 2e0a 0a23   this class)...#
-0000c270: 2323 2048 6f77 2074 6f20 696d 706c 656d  ## How to implem
-0000c280: 656e 7420 6578 6163 746c 792d 6f6e 6365  ent exactly-once
-0000c290: 2065 7665 6e74 2070 726f 6365 7373 696e   event processin
-0000c2a0: 670a 0a54 6865 2063 6f6d 6d69 7420 706f  g..The commit po
-0000c2b0: 7369 7469 6f6e 7320 6f66 2072 6563 6f72  sitions of recor
-0000c2c0: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
-0000c2d0: 6172 6520 7265 6365 6976 6564 2061 6e64  are received and
-0000c2e0: 2070 726f 6365 7373 6564 2062 7920 610a   processed by a.
-0000c2f0: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-0000c300: 6e65 6e74 2061 7265 2075 7365 6675 6c6c  nent are usefull
-0000c310: 7920 7265 636f 7264 6564 2062 7920 7468  y recorded by th
-0000c320: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
-0000c330: 706f 6e65 6e74 2073 6f20 7468 6174 0a74  ponent so that.t
-0000c340: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000c350: 6f6e 206f 6620 6c61 7374 2070 726f 6365  on of last proce
-0000c360: 7373 6564 2065 7665 6e74 2063 616e 2062  ssed event can b
-0000c370: 6520 6465 7465 726d 696e 6564 2e0a 0a54  e determined...T
-0000c380: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-0000c390: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000c3a0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0000c3b0: 7370 6563 6966 7920 7468 6520 636f 6d6d  specify the comm
-0000c3c0: 6974 2070 6f73 6974 696f 6e20 6672 6f6d  it position from
-0000c3d0: 2077 6869 6368 0a74 6f20 7375 6273 6372   which.to subscr
-0000c3e0: 6962 6520 7768 656e 2070 726f 6365 7373  ibe when process
-0000c3f0: 696e 6720 6973 2072 6573 756d 6564 2e20  ing is resumed. 
-0000c400: 5369 6e63 6520 7468 6973 2063 6f6d 6d69  Since this commi
-0000c410: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
-0000c420: 7265 7072 6573 656e 7420 7468 650a 706f  represent the.po
-0000c430: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
-0000c440: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
-0000c450: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
-0000c460: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
-0000c470: 636f 6d70 6f6e 656e 742c 2073 6f20 6974  component, so it
-0000c480: 0a77 696c 6c20 6265 2075 7375 616c 2074  .will be usual t
-0000c490: 6f20 7761 6e74 2074 6865 206e 6578 7420  o want the next 
-0000c4a0: 6576 656e 7420 6166 7465 7220 7468 6973  event after this
-0000c4b0: 2070 6f73 6974 696f 6e2c 2062 6563 6175   position, becau
-0000c4c0: 7365 2074 6861 7420 6973 2074 6865 206e  se that is the n
-0000c4d0: 6578 740a 6576 656e 7420 7468 6174 2068  ext.event that h
-0000c4e0: 6173 206e 6f74 2079 6574 2062 6565 6e20  as not yet been 
-0000c4f0: 7072 6f63 6573 7365 642e 2046 6f72 2074  processed. For t
-0000c500: 6869 7320 7265 6173 6f6e 2c20 7768 656e  his reason, when
-0000c510: 2073 7562 7363 7269 6269 6e67 2066 6f72   subscribing for
-0000c520: 2065 7665 6e74 730a 6672 6f6d 2061 2073   events.from a s
-0000c530: 7065 6369 6669 6320 636f 6d6d 6974 2070  pecific commit p
-0000c540: 6f73 6974 696f 6e20 7573 696e 6720 6120  osition using a 
-0000c550: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-0000c560: 7074 696f 6e20 696e 2045 7665 6e74 5374  ption in EventSt
-0000c570: 6f72 6544 422c 2074 6865 0a72 6563 6f72  oreDB, the.recor
-0000c580: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
-0000c590: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-0000c5a0: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
-0000c5b0: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
-0000c5c0: 696e 2074 6865 2073 6571 7565 6e63 650a  in the sequence.
-0000c5d0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-0000c5e0: 7473 2074 6861 7420 6172 6520 7265 6365  ts that are rece
-0000c5f0: 6976 6564 2e0a 0a54 6f20 6163 636f 6d70  ived...To accomp
-0000c600: 6c69 7368 2022 6578 6163 746c 792d 6f6e  lish "exactly-on
-0000c610: 6365 2220 7072 6f63 6573 7369 6e67 206f  ce" processing o
-0000c620: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-0000c630: 7320 696e 2061 2064 6f77 6e73 7472 6561  s in a downstrea
-0000c640: 6d0a 636f 6d70 6f6e 656e 7420 7768 656e  m.component when
-0000c650: 2075 7369 6e67 2061 2063 6174 6368 2d75   using a catch-u
-0000c660: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
-0000c670: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-0000c680: 696f 6e20 6f66 2061 2072 6563 6f72 6465  ion of a recorde
-0000c690: 640a 6576 656e 7420 7368 6f75 6c64 2062  d.event should b
-0000c6a0: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
-0000c6b0: 6361 6c6c 7920 616e 6420 756e 6971 7565  cally and unique
-0000c6c0: 6c79 2061 6c6f 6e67 2077 6974 6820 7468  ly along with th
-0000c6d0: 6520 7265 7375 6c74 206f 6620 7072 6f63  e result of proc
-0000c6e0: 6573 7369 6e67 0a72 6563 6f72 6465 6420  essing.recorded 
-0000c6f0: 6576 656e 7473 2c20 666f 7220 6578 616d  events, for exam
-0000c700: 706c 6520 696e 2074 6865 2073 616d 6520  ple in the same 
-0000c710: 6461 7461 6261 7365 2061 7320 6d61 7465  database as mate
-0000c720: 7269 616c 6973 6564 2076 6965 7773 2077  rialised views w
-0000c730: 6865 6e0a 696d 706c 656d 656e 7469 6e67  hen.implementing
-0000c740: 2065 7665 6e74 7561 6c6c 792d 636f 6e73   eventually-cons
-0000c750: 6973 7465 6e74 2043 5152 532c 206f 7220  istent CQRS, or 
-0000c760: 696e 2074 6865 2073 616d 6520 6461 7461  in the same data
-0000c770: 6261 7365 2061 7320 6120 646f 776e 7374  base as a downst
-0000c780: 7265 616d 0a61 6e61 6c79 7469 6373 206f  ream.analytics o
-0000c790: 7220 7265 706f 7274 696e 6720 6f72 2061  r reporting or a
-0000c7a0: 7263 6869 7669 6e67 2061 7070 6c69 6361  rchiving applica
-0000c7b0: 7469 6f6e 2e20 4279 2072 6563 6f72 6469  tion. By recordi
-0000c7c0: 6e67 2074 6865 2063 6f6d 6d69 7420 706f  ng the commit po
-0000c7d0: 7369 7469 6f6e 0a6f 6620 7265 636f 7264  sition.of record
-0000c7e0: 6564 2065 7665 6e74 7320 6174 6f6d 6963  ed events atomic
-0000c7f0: 616c 6c79 2077 6974 6820 7468 6520 6e65  ally with the ne
-0000c800: 7720 7374 6174 6520 7468 6174 2072 6573  w state that res
-0000c810: 756c 7473 2066 726f 6d20 7072 6f63 6573  ults from proces
-0000c820: 7369 6e67 0a72 6563 6f72 6465 6420 6576  sing.recorded ev
-0000c830: 656e 7473 2c20 2264 7561 6c20 7772 6974  ents, "dual writ
-0000c840: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
-0000c850: 756d 7074 696f 6e20 6f66 2072 6563 6f72  umption of recor
-0000c860: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
-0000c870: 650a 6176 6f69 6465 642e 2042 7920 616c  e.avoided. By al
-0000c880: 736f 2072 6563 6f72 6469 6e67 2074 6865  so recording the
-0000c890: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000c8a0: 2075 6e69 7175 656c 792c 2074 6865 206e   uniquely, the n
-0000c8b0: 6577 2073 7461 7465 2063 616e 6e6f 7420  ew state cannot 
-0000c8c0: 6265 0a72 6563 6f72 6465 6420 7477 6963  be.recorded twic
-0000c8d0: 652c 2061 6e64 2068 656e 6365 2074 6865  e, and hence the
-0000c8e0: 2072 6563 6f72 6465 6420 7374 6174 6520   recorded state 
-0000c8f0: 6f66 2074 6865 2064 6f77 6e73 7472 6561  of the downstrea
-0000c900: 6d20 636f 6d70 6f6e 656e 7420 7769 6c6c  m component will
-0000c910: 2062 650a 7570 6461 7465 6420 6f6e 6c79   be.updated only
-0000c920: 206f 6e63 6520 666f 7220 616e 7920 7265   once for any re
-0000c930: 636f 7264 6564 2065 7665 6e74 2e20 4279  corded event. By
-0000c940: 2075 7369 6e67 2074 6865 2067 7265 6174   using the great
-0000c950: 6573 7420 7265 636f 7264 6564 2063 6f6d  est recorded com
-0000c960: 6d69 740a 706f 7369 7469 6f6e 2074 6f20  mit.position to 
-0000c970: 7265 7375 6d65 2061 2063 6174 6368 2d75  resume a catch-u
-0000c980: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
-0000c990: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
-0000c9a0: 6e74 7320 7769 6c6c 2065 7665 6e74 7561  nts will eventua
-0000c9b0: 6c6c 790a 6265 2070 726f 6365 7373 6564  lly.be processed
-0000c9c0: 2e20 5468 6520 636f 6d62 696e 6174 696f  . The combinatio
-0000c9d0: 6e20 6f66 2074 6865 2022 6174 2d6d 6f73  n of the "at-mos
-0000c9e0: 742d 6f6e 6365 2220 636f 6e64 6974 696f  t-once" conditio
-0000c9f0: 6e20 616e 6420 7468 6520 2261 742d 6c65  n and the "at-le
-0000ca00: 6173 742d 6f6e 6365 220a 636f 6e64 6974  ast-once".condit
-0000ca10: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
-0000ca20: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
-0000ca30: 6469 7469 6f6e 2e0a 0a54 6865 2064 616e  dition...The dan
-0000ca40: 6765 7220 7769 7468 2022 6475 616c 2077  ger with "dual w
-0000ca50: 7269 7469 6e67 2220 696e 2074 6865 2063  riting" in the c
-0000ca60: 6f6e 7375 6d70 7469 6f6e 206f 6620 7265  onsumption of re
-0000ca70: 636f 7264 6564 2065 7665 6e74 7320 6973  corded events is
-0000ca80: 2074 6861 7420 6966 2061 0a72 6563 6f72   that if a.recor
-0000ca90: 6465 6420 6576 656e 7420 6973 2073 7563  ded event is suc
-0000caa0: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
-0000cab0: 7365 6420 616e 6420 6e65 7720 7374 6174  sed and new stat
-0000cac0: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
-0000cad0: 6361 6c6c 7920 696e 206f 6e65 0a74 7261  cally in one.tra
-0000cae0: 6e73 6163 7469 6f6e 2077 6974 6820 7468  nsaction with th
-0000caf0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-0000cb00: 6e20 7265 636f 7264 6564 2069 6e20 6120  n recorded in a 
-0000cb10: 7365 7061 7261 7465 2074 7261 6e73 6163  separate transac
-0000cb20: 7469 6f6e 2c20 6f6e 6520 6d61 790a 6861  tion, one may.ha
-0000cb30: 7070 656e 2061 6e64 206e 6f74 2074 6865  ppen and not the
-0000cb40: 206f 7468 6572 2e20 4966 2074 6865 206e   other. If the n
-0000cb50: 6577 2073 7461 7465 2069 7320 7265 636f  ew state is reco
-0000cb60: 7264 6564 2062 7574 2074 6865 2070 6f73  rded but the pos
-0000cb70: 6974 696f 6e20 6973 206c 6f73 742c 0a61  ition is lost,.a
-0000cb80: 6e64 2074 6865 6e20 7468 6520 7072 6f63  nd then the proc
-0000cb90: 6573 7369 6e67 2069 7320 7374 6f70 7065  essing is stoppe
-0000cba0: 6420 616e 6420 7265 7375 6d65 642c 2074  d and resumed, t
-0000cbb0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000cbc0: 7420 6d61 7920 6265 2070 726f 6365 7373  t may be process
-0000cbd0: 6564 0a74 7769 6365 2e20 4f6e 2074 6865  ed.twice. On the
-0000cbe0: 206f 7468 6572 2068 616e 642c 2069 6620   other hand, if 
-0000cbf0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-0000cc00: 696f 6e20 6973 2072 6563 6f72 6465 6420  ion is recorded 
-0000cc10: 6275 7420 7468 6520 6e65 7720 7374 6174  but the new stat
-0000cc20: 6520 6973 0a6c 6f73 742c 2074 6865 2072  e is.lost, the r
-0000cc30: 6563 6f72 6465 6420 6576 656e 7420 6d61  ecorded event ma
-0000cc40: 7920 6566 6665 6374 6976 656c 7920 6e6f  y effectively no
-0000cc50: 7420 6265 2070 726f 6365 7373 6564 2061  t be processed a
-0000cc60: 7420 616c 6c2e 2042 7920 6569 7468 6572  t all. By either
-0000cc70: 0a70 726f 6365 7373 696e 6720 616e 2065  .processing an e
-0000cc80: 7665 6e74 206d 6f72 6520 7468 616e 206f  vent more than o
-0000cc90: 6e63 652c 206f 7220 6279 2066 6169 6c69  nce, or by faili
-0000cca0: 6e67 2074 6f20 7072 6f63 6573 7320 616e  ng to process an
-0000ccb0: 2065 7665 6e74 2c20 7468 6520 7265 636f   event, the reco
-0000ccc0: 7264 6564 0a73 7461 7465 206f 6620 7468  rded.state of th
-0000ccd0: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
-0000cce0: 706f 6e65 6e74 206d 6967 6874 2062 6520  ponent might be 
-0000ccf0: 696e 6163 6375 7261 7465 2c20 6f72 2070  inaccurate, or p
-0000cd00: 6f73 7369 626c 7920 696e 636f 6e73 6973  ossibly inconsis
-0000cd10: 7465 6e74 2c20 616e 640a 7065 7268 6170  tent, and.perhap
-0000cd20: 7320 6361 7461 7374 726f 7068 6963 616c  s catastrophical
-0000cd30: 6c79 2073 6f2e 2053 7563 6820 636f 6e73  ly so. Such cons
-0000cd40: 6571 7565 6e63 6573 206d 6179 206f 7220  equences may or 
-0000cd50: 6d61 7920 6e6f 7420 6d61 7474 6572 2069  may not matter i
-0000cd60: 6e20 796f 7572 2073 6974 7561 7469 6f6e  n your situation
-0000cd70: 2e0a 4275 7420 736f 6d65 7469 6d65 7320  ..But sometimes 
-0000cd80: 696e 636f 6e73 6973 7465 6e63 6965 7320  inconsistencies 
-0000cd90: 6d61 7920 6861 6c74 2070 726f 6365 7373  may halt process
-0000cda0: 696e 6720 756e 7469 6c20 7468 6520 6973  ing until the is
-0000cdb0: 7375 6520 6973 2072 6573 6f6c 7665 642e  sue is resolved.
-0000cdc0: 2059 6f75 2063 616e 0a61 766f 6964 2022   You can.avoid "
-0000cdd0: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
-0000cde0: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
-0000cdf0: 206f 6620 6576 656e 7473 2062 7920 6174   of events by at
-0000ce00: 6f6d 6963 616c 6c79 2072 6563 6f72 6469  omically recordi
-0000ce10: 6e67 2074 6865 2063 6f6d 6d69 740a 706f  ng the commit.po
-0000ce20: 7369 7469 6f6e 206f 6620 6120 7265 636f  sition of a reco
-0000ce30: 7264 6564 2065 7665 6e74 2061 6c6f 6e67  rded event along
-0000ce40: 2077 6974 6820 7468 6520 6e65 7720 7374   with the new st
-0000ce50: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
-0000ce60: 2066 726f 6d20 7072 6f63 6573 7369 6e67   from processing
-0000ce70: 2074 6861 740a 6576 656e 7420 696e 2074   that.event in t
-0000ce80: 6865 2073 616d 6520 6174 6f6d 6963 2074  he same atomic t
-0000ce90: 7261 6e73 6163 7469 6f6e 2e20 4279 206d  ransaction. By m
-0000cea0: 616b 696e 6720 7468 6520 7265 636f 7264  aking the record
-0000ceb0: 696e 6720 6f66 2074 6865 2063 6f6d 6d69  ing of the commi
-0000cec0: 7420 706f 7369 7469 6f6e 730a 756e 6971  t positions.uniq
-0000ced0: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
-0000cee0: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
-0000cef0: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
-0000cf00: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
-0000cf10: 666c 6963 742c 2079 6f75 2077 696c 6c0a  flict, you will.
-0000cf20: 7072 6576 656e 7420 7468 6520 7265 7375  prevent the resu
-0000cf30: 6c74 7320 6f66 2061 6e79 2064 7570 6c69  lts of any dupli
-0000cf40: 6361 7465 2070 726f 6365 7373 696e 6720  cate processing 
-0000cf50: 6f66 2061 2072 6563 6f72 6465 6420 6576  of a recorded ev
-0000cf60: 656e 7420 6265 696e 6720 636f 6d6d 6974  ent being commit
-0000cf70: 7465 642e 0a0a 5265 636f 7264 6564 2065  ted...Recorded e
-0000cf80: 7665 6e74 7320 7265 6365 6976 6564 2066  vents received f
-0000cf90: 726f 6d20 6120 6361 7463 682d 7570 2073  rom a catch-up s
-0000cfa0: 7562 7363 7269 7074 696f 6e20 6361 6e6e  ubscription cann
-0000cfb0: 6f74 2062 6520 6163 6b6e 6f77 6c65 6467  ot be acknowledg
-0000cfc0: 6564 2062 6163 6b0a 746f 2074 6865 2045  ed back.to the E
-0000cfd0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-0000cfe0: 6572 2e20 4163 6b6e 6f77 6c65 6467 696e  er. Acknowledgin
-0000cff0: 6720 6576 656e 7473 2c20 686f 7765 7665  g events, howeve
-0000d000: 722c 2069 7320 616e 2061 7370 6563 7420  r, is an aspect 
-0000d010: 6f66 2022 7065 7273 6973 7465 6e74 0a73  of "persistent.s
-0000d020: 7562 7363 7269 7074 696f 6e73 222e 2048  ubscriptions". H
-0000d030: 6f70 696e 6720 746f 2072 656c 7920 6f6e  oping to rely on
-0000d040: 2061 636b 6e6f 776c 6564 6769 6e67 2065   acknowledging e
-0000d050: 7665 6e74 7320 746f 2061 6e20 7570 7374  vents to an upst
-0000d060: 7265 616d 0a63 6f6d 706f 6e65 6e74 2069  ream.component i
-0000d070: 7320 616e 2065 7861 6d70 6c65 206f 6620  s an example of 
-0000d080: 6475 616c 2077 7269 7469 6e67 2e0a 0a23  dual writing...#
-0000d090: 2323 2053 7562 7363 7269 6265 2061 6c6c  ## Subscribe all
-0000d0a0: 2065 7665 6e74 730a 0a54 6865 6073 7562   events..The`sub
-0000d0b0: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
-0000d0c0: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
-0000d0d0: 6265 2075 7365 6420 746f 2073 7461 7274  be used to start
-0000d0e0: 2061 2022 6361 7463 682d 7570 2220 7375   a "catch-up" su
-0000d0f0: 6273 6372 6970 7469 6f6e 0a74 6861 7420  bscription.that 
-0000d100: 6361 6e20 7265 7475 726e 2065 7665 6e74  can return event
-0000d110: 7320 6672 6f6d 2061 6c6c 2073 7472 6561  s from all strea
-0000d120: 6d73 2069 6e20 7468 6520 6461 7461 6261  ms in the databa
-0000d130: 7365 2e0a 0a54 6869 7320 6d65 7468 6f64  se...This method
-0000d140: 2063 616e 2062 6520 7573 6564 2062 7920   can be used by 
-0000d150: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
-0000d160: 706f 6e65 6e74 0a74 6f20 7072 6f63 6573  ponent.to proces
-0000d170: 7320 7265 636f 7264 6564 2065 7665 6e74  s recorded event
-0000d180: 7320 7769 7468 2065 7861 6374 6c79 2d6f  s with exactly-o
-0000d190: 6e63 6520 7365 6d61 6e74 6963 732e 0a0a  nce semantics...
-0000d1a0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-0000d1b0: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
-0000d1c0: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
-0000d1d0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-0000d1e0: 6361 6e20 6265 0a75 7365 6420 746f 2073  can be.used to s
-0000d1f0: 7065 6369 6679 2061 2063 6f6d 6d69 7420  pecify a commit 
-0000d200: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
-0000d210: 6963 6820 746f 2073 7562 7363 7269 6265  ich to subscribe
-0000d220: 2e20 5468 6520 6465 6661 756c 740a 7661  . The default.va
-0000d230: 6c75 6520 6973 2060 4e6f 6e65 602c 2077  lue is `None`, w
-0000d240: 6869 6368 206d 6561 6e73 2074 6865 2073  hich means the s
-0000d250: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
-0000d260: 206f 7065 7261 7465 2066 726f 6d20 7468   operate from th
-0000d270: 6520 6669 7273 740a 7265 636f 7264 6564  e first.recorded
-0000d280: 2065 7665 6e74 2069 6e20 7468 6520 6461   event in the da
-0000d290: 7461 6261 7365 2e20 4966 2061 2063 6f6d  tabase. If a com
-0000d2a0: 6d69 7420 706f 7369 7469 6f6e 2069 7320  mit position is 
-0000d2b0: 6769 7665 6e2c 2069 7420 6d75 7374 206d  given, it must m
-0000d2c0: 6174 6368 0a61 6e20 6163 7475 616c 6c79  atch.an actually
-0000d2d0: 2065 7869 7374 696e 6720 636f 6d6d 6974   existing commit
-0000d2e0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-0000d2f0: 2064 6174 6162 6173 652e 2054 6865 2072   database. The r
-0000d300: 6563 6f64 6564 2065 7665 6e74 7320 7468  ecoded events th
-0000d310: 6174 0a61 7265 206f 6274 6169 6e65 6420  at.are obtained 
-0000d320: 7769 6c6c 206e 6f74 2069 6e63 6c75 6465  will not include
-0000d330: 2074 6865 2065 7665 6e74 2072 6563 6f72   the event recor
-0000d340: 6465 6420 6174 2074 6861 7420 636f 6d6d  ded at that comm
-0000d350: 6974 2070 6f73 6974 696f 6e2e 0a0a 5468  it position...Th
-0000d360: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
-0000d370: 616b 6573 2066 6f75 7220 6f74 6865 7220  akes four other 
-0000d380: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-0000d390: 7473 2c20 6066 696c 7465 725f 6578 636c  ts, `filter_excl
-0000d3a0: 7564 6560 2c0a 6066 696c 7465 725f 696e  ude`,.`filter_in
-0000d3b0: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
-0000d3c0: 6279 5f73 7472 6561 6d5f 6e61 6d65 602c  by_stream_name`,
-0000d3d0: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
-0000d3e0: 0a54 6865 206f 7074 696f 6e61 6c20 6172  .The optional ar
-0000d3f0: 6775 6d65 6e74 2060 6669 6c74 6572 5f65  gument `filter_e
-0000d400: 7863 6c75 6465 6020 6973 2061 2073 6571  xclude` is a seq
-0000d410: 7565 6e63 6520 6f66 2072 6567 756c 6172  uence of regular
-0000d420: 2065 7870 7265 7373 696f 6e73 2074 6861   expressions tha
-0000d430: 740a 6d61 7463 6820 7265 636f 7264 6564  t.match recorded
-0000d440: 2065 7665 6e74 7320 7468 6174 2073 686f   events that sho
-0000d450: 756c 6420 6e6f 7420 6265 2069 6e63 6c75  uld not be inclu
-0000d460: 6465 642e 2054 6869 7320 6172 6775 6d65  ded. This argume
-0000d470: 6e74 2069 7320 6967 6e6f 7265 640a 6966  nt is ignored.if
-0000d480: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
-0000d490: 6020 6973 2073 6574 2074 6f20 6120 6e6f  ` is set to a no
-0000d4a0: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
-0000d4b0: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
-0000d4c0: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
-0000d4d0: 6574 0a74 6f20 6d61 7463 6820 7468 6520  et.to match the 
-0000d4e0: 6576 656e 7420 7479 7065 7320 6f66 2022  event types of "
-0000d4f0: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
-0000d500: 736f 2074 6861 7420 4576 656e 7453 746f  so that EventSto
-0000d510: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
-0000d520: 7473 0a77 696c 6c20 6e6f 7420 6e6f 726d  ts.will not norm
-0000d530: 616c 6c79 2062 6520 696e 636c 7564 6564  ally be included
-0000d540: 2e20 5365 6520 7468 6520 4e6f 7465 7320  . See the Notes 
-0000d550: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
-0000d560: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-0000d570: 6f6e 0a61 626f 7574 2066 696c 7465 7220  on.about filter 
-0000d580: 6578 7072 6573 7369 6f6e 732e 0a0a 5468  expressions...Th
-0000d590: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
-0000d5a0: 656e 7420 6066 696c 7465 725f 696e 636c  ent `filter_incl
-0000d5b0: 7564 6560 2069 7320 6120 7365 7175 656e  ude` is a sequen
-0000d5c0: 6365 206f 6620 7265 6775 6c61 7220 6578  ce of regular ex
-0000d5d0: 7072 6573 7369 6f6e 730a 7468 6174 206d  pressions.that m
-0000d5e0: 6174 6368 2072 6563 6f72 6465 6420 6576  atch recorded ev
-0000d5f0: 656e 7473 2074 6861 7420 7368 6f75 6c64  ents that should
-0000d600: 2062 6520 696e 636c 7564 6564 2e20 4279   be included. By
-0000d610: 2064 6566 6175 6c74 2c20 7468 6973 2061   default, this a
-0000d620: 7267 756d 656e 740a 6973 2061 6e20 656d  rgument.is an em
-0000d630: 7074 7920 7475 706c 652e 2049 6620 7468  pty tuple. If th
-0000d640: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
-0000d650: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
-0000d660: 7920 7365 7175 656e 6365 2c20 7468 650a  y sequence, the.
-0000d670: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
-0000d680: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
-0000d690: 6f72 6564 2e0a 0a54 6865 206f 7074 696f  ored...The optio
-0000d6a0: 6e61 6c20 6172 6775 6d65 6e74 2060 6669  nal argument `fi
-0000d6b0: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
-0000d6c0: 616d 6560 2069 7320 6120 5079 7468 6f6e  ame` is a Python
-0000d6d0: 2060 626f 6f6c 6020 7468 6174 2069 6e64   `bool` that ind
-0000d6e0: 6963 6174 6573 2077 6865 7468 6572 0a74  icates whether.t
-0000d6f0: 6865 2066 696c 7465 7220 7769 6c6c 2061  he filter will a
-0000d700: 7070 6c79 2074 6f20 6576 656e 7420 7479  pply to event ty
-0000d710: 7065 7320 6f72 2073 7472 6561 6d20 6e61  pes or stream na
-0000d720: 6d65 732e 2042 7920 6465 6661 756c 742c  mes. By default,
-0000d730: 2074 6869 7320 7661 6c75 6520 6973 2060   this value is `
-0000d740: 4661 6c73 6560 0a61 6e64 2073 6f20 7468  False`.and so th
-0000d750: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
-0000d760: 2061 7070 6c79 2074 6f20 7468 6520 6576   apply to the ev
-0000d770: 656e 7420 7479 7065 2073 7472 696e 6773  ent type strings
-0000d780: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
-0000d790: 6e74 732e 0a0a 506c 6561 7365 206e 6f74  nts...Please not
-0000d7a0: 652c 2074 6865 2066 696c 7465 7269 6e67  e, the filtering
-0000d7b0: 2068 6170 7065 6e73 206f 6e20 7468 6520   happens on the 
-0000d7c0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-0000d7d0: 7665 722c 2061 6e64 2074 6865 0a60 6c69  ver, and the.`li
-0000d7e0: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
-0000d7f0: 2061 7070 6c69 6564 206f 6e20 7468 6520   applied on the 
-0000d800: 7365 7276 6572 2061 6674 6572 2066 696c  server after fil
-0000d810: 7465 7269 6e67 2e0a 0a54 6865 206f 7074  tering...The opt
-0000d820: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000d830: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-0000d840: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-0000d850: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
-0000d860: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-0000d870: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-0000d880: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-0000d890: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
-0000d8a0: 7320 6120 5079 7468 6f6e 2069 7465 7261  s a Python itera
-0000d8b0: 746f 7220 7468 6174 2079 6965 6c64 7320  tor that yields 
-0000d8c0: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
-0000d8d0: 2069 6e63 6c75 6469 6e67 2065 7665 6e74   including event
-0000d8e0: 730a 7468 6174 2061 7265 2072 6563 6f72  s.that are recor
-0000d8f0: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
-0000d900: 6273 6372 6970 7469 6f6e 2077 6173 2063  bscription was c
-0000d910: 7265 6174 6564 2e20 4974 6572 6174 696e  reated. Iteratin
-0000d920: 6720 6f76 6572 2074 6869 7320 6f62 6a65  g over this obje
-0000d930: 6374 2077 696c 6c0a 7468 6572 6566 6f72  ct will.therefor
-0000d940: 6520 6e6f 7420 7374 6f70 2c20 756e 6c65  e not stop, unle
-0000d950: 7373 2074 6865 2063 6f6e 6e65 6374 696f  ss the connectio
-0000d960: 6e20 746f 2074 6865 2064 6174 6162 6173  n to the databas
-0000d970: 6520 6973 206c 6f73 742e 2054 6865 2063  e is lost. The c
-0000d980: 616c 6c20 7769 6c6c 0a62 6520 656e 6465  all will.be ende
-0000d990: 6420 7768 656e 2074 6865 2069 7465 7261  d when the itera
-0000d9a0: 746f 7220 6f62 6a65 6374 2069 7320 6465  tor object is de
-0000d9b0: 6c65 7465 6420 6672 6f6d 206d 656d 6f72  leted from memor
-0000d9c0: 792c 2077 6869 6368 2077 696c 6c20 6861  y, which will ha
-0000d9d0: 7070 656e 2077 6865 6e20 7468 650a 6974  ppen when the.it
-0000d9e0: 6572 6174 6f72 206f 626a 6563 7420 676f  erator object go
-0000d9f0: 6573 206f 7574 206f 6620 7363 6f70 6520  es out of scope 
-0000da00: 6f72 2069 7320 6578 706c 6963 6974 6c79  or is explicitly
-0000da10: 2064 656c 6574 6564 2e20 5468 6520 6361   deleted. The ca
-0000da20: 6c6c 206d 6179 2061 6c73 6f20 6265 0a63  ll may also be.c
-0000da30: 6c6f 7365 6420 6279 2074 6865 2073 6572  losed by the ser
-0000da40: 7665 722e 0a0a 5468 6520 7375 6273 6372  ver...The subscr
-0000da50: 6970 7469 6f6e 206f 626a 6563 7420 6361  iption object ca
-0000da60: 6e20 6265 2075 7365 6420 6469 7265 6374  n be used direct
-0000da70: 6c79 2c20 6275 7420 6974 206d 6967 6874  ly, but it might
-0000da80: 2062 6520 7573 6564 2077 6974 6869 6e20   be used within 
-0000da90: 6120 7468 7265 6164 6564 0a6c 6f6f 7020  a threaded.loop 
-0000daa0: 6465 6469 6361 7465 6420 746f 2072 6563  dedicated to rec
-0000dab0: 6569 7669 6e67 2065 7665 6e74 7320 7468  eiving events th
-0000dac0: 6174 2063 616e 2062 6520 7374 6f70 7065  at can be stoppe
-0000dad0: 6420 696e 2061 2063 6f6e 7472 6f6c 6c65  d in a controlle
-0000dae0: 6420 7761 792c 2077 6974 680a 7265 636f  d way, with.reco
-0000daf0: 7264 6564 2065 7665 6e74 7320 7075 7420  rded events put 
-0000db00: 6f6e 2061 2071 7565 7565 2066 6f72 2070  on a queue for p
-0000db10: 726f 6365 7373 696e 6720 696e 2061 2064  rocessing in a d
-0000db20: 6966 6665 7265 6e74 2074 6872 6561 642e  ifferent thread.
-0000db30: 2054 6869 7320 7061 636b 6167 650a 646f   This package.do
-0000db40: 6573 6e27 7420 7072 6f76 6964 6520 7375  esn't provide su
-0000db50: 6368 2061 2074 6872 6561 6465 6420 6f72  ch a threaded or
-0000db60: 2071 7565 7569 6e67 206f 626a 6563 7420   queuing object 
-0000db70: 636c 6173 732e 204a 7573 7420 6d61 6b65  class. Just make
-0000db80: 2073 7572 6520 746f 2072 6563 6f6e 7374   sure to reconst
-0000db90: 7275 6374 0a74 6865 2073 7562 7363 7269  ruct.the subscri
-0000dba0: 7074 696f 6e20 2861 6e64 2074 6865 2071  ption (and the q
-0000dbb0: 7565 7565 2920 7573 696e 6720 7468 6520  ueue) using the 
-0000dbc0: 6c61 7374 2072 6563 6f72 6465 6420 636f  last recorded co
-0000dbd0: 6d6d 6974 2070 6f73 6974 696f 6e20 7768  mmit position wh
-0000dbe0: 656e 2072 6573 756d 696e 670a 7468 6520  en resuming.the 
-0000dbf0: 7375 6273 6372 6970 7469 6f6e 2061 6674  subscription aft
-0000dc00: 6572 2061 6e20 6572 726f 722c 2074 6f20  er an error, to 
-0000dc10: 6265 2073 7572 6520 616c 6c20 6576 656e  be sure all even
-0000dc20: 7473 2061 7265 2070 726f 6365 7373 6564  ts are processed
-0000dc30: 206f 6e63 652e 0a0a 5468 6520 6578 616d   once...The exam
-0000dc40: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
-0000dc50: 686f 7720 746f 2073 7562 7363 7269 6265  how to subscribe
-0000dc60: 2074 6f20 7265 6365 6976 6520 616c 6c20   to receive all 
-0000dc70: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
-0000dc80: 6672 6f6d 2074 6865 2073 7461 7274 2c20  from the start, 
-0000dc90: 616e 6420 7468 656e 2072 6573 756d 696e  and then resumin
-0000dca0: 6720 6672 6f6d 2061 2073 7065 6369 6669  g from a specifi
-0000dcb0: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
-0000dcc0: 6e2e 0a54 6872 6565 2061 6c72 6561 6479  n..Three already
-0000dcd0: 2d72 6563 6f72 6465 6420 6576 656e 7473  -recorded events
-0000dce0: 2061 7265 2072 6563 6569 7665 642c 2061   are received, a
-0000dcf0: 6e64 2074 6865 6e20 7468 7265 6520 6e65  nd then three ne
-0000dd00: 7720 6576 656e 7473 2061 7265 0a72 6563  w events are.rec
-0000dd10: 6f72 6465 642c 2077 6869 6368 2061 7265  orded, which are
-0000dd20: 2074 6865 6e20 7265 6365 6976 6564 2076   then received v
-0000dd30: 6961 2074 6865 2073 7562 7363 7269 7074  ia the subscript
-0000dd40: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
-0000dd50: 0a23 2041 7070 656e 6420 616e 2065 7665  .# Append an eve
-0000dd60: 6e74 2074 6f20 6120 6e65 7720 7374 7265  nt to a new stre
-0000dd70: 616d 2e0a 7374 7265 616d 5f6e 616d 6532  am..stream_name2
-0000dd80: 203d 2073 7472 2875 7569 6434 2829 290a   = str(uuid4()).
-0000dd90: 6576 656e 7434 203d 204e 6577 4576 656e  event4 = NewEven
-0000dda0: 7428 7479 7065 3d27 4f72 6465 7243 7265  t(type='OrderCre
-0000ddb0: 6174 6564 272c 2064 6174 613d 6227 6461  ated', data=b'da
-0000ddc0: 7461 3427 290a 636c 6965 6e74 2e61 7070  ta4').client.app
-0000ddd0: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
-0000dde0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000ddf0: 616d 5f6e 616d 6532 2c0a 2020 2020 6578  am_name2,.    ex
-0000de00: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-0000de10: 4e6f 6e65 2c0a 2020 2020 6576 656e 7473  None,.    events
-0000de20: 3d5b 6576 656e 7434 5d2c 0a29 0a0a 2320  =[event4],.)..# 
-0000de30: 5375 6273 6372 6962 6520 6672 6f6d 2074  Subscribe from t
-0000de40: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
-0000de50: 6420 6576 656e 7420 696e 2074 6865 2064  d event in the d
-0000de60: 6174 6162 6173 652e 0a73 7562 7363 7269  atabase..subscri
-0000de70: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
-0000de80: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
-0000de90: 6e74 7328 290a 7265 6365 6976 6564 5f65  nts().received_e
-0000dea0: 7665 6e74 7320 3d20 5b5d 0a0a 2320 5072  vents = []..# Pr
-0000deb0: 6f63 6573 7320 6576 656e 7473 2072 6563  ocess events rec
-0000dec0: 6569 7665 6420 6672 6f6d 2074 6865 2063  eived from the c
-0000ded0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-0000dee0: 7469 6f6e 2e0a 666f 7220 6576 656e 7420  tion..for event 
-0000def0: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
-0000df00: 0a20 2020 206c 6173 745f 636f 6d6d 6974  .    last_commit
-0000df10: 5f70 6f73 6974 696f 6e20 3d20 6576 656e  _position = even
-0000df20: 742e 636f 6d6d 6974 5f70 6f73 6974 696f  t.commit_positio
-0000df30: 6e0a 2020 2020 7265 6365 6976 6564 5f65  n.    received_e
-0000df40: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000df50: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
-0000df60: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
-0000df70: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
-0000df80: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000df90: 5f65 7665 6e74 735b 2d38 5d2e 6964 203d  _events[-8].id =
-0000dfa0: 3d20 6576 656e 7431 2e69 640a 6173 7365  = event1.id.asse
-0000dfb0: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
-0000dfc0: 7473 5b2d 375d 2e69 6420 3d3d 2065 7665  ts[-7].id == eve
-0000dfd0: 6e74 322e 6964 0a61 7373 6572 7420 7265  nt2.id.assert re
-0000dfe0: 6365 6976 6564 5f65 7665 6e74 735b 2d36  ceived_events[-6
-0000dff0: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
-0000e000: 640a 6173 7365 7274 2072 6563 6569 7665  d.assert receive
-0000e010: 645f 6576 656e 7473 5b2d 355d 2e74 7970  d_events[-5].typ
-0000e020: 6520 3d3d 2022 446f 6752 6567 6973 7465  e == "DogRegiste
-0000e030: 7265 6422 0a61 7373 6572 7420 7265 6365  red".assert rece
-0000e040: 6976 6564 5f65 7665 6e74 735b 2d34 5d2e  ived_events[-4].
-0000e050: 7479 7065 203d 3d20 2244 6f67 4c65 6172  type == "DogLear
-0000e060: 6e65 6454 7269 636b 220a 6173 7365 7274  nedTrick".assert
-0000e070: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000e080: 5b2d 335d 2e74 7970 6520 3d3d 2022 446f  [-3].type == "Do
-0000e090: 674c 6561 726e 6564 5472 6963 6b22 0a61  gLearnedTrick".a
-0000e0a0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000e0b0: 7665 6e74 735b 2d32 5d2e 7479 7065 203d  vents[-2].type =
-0000e0c0: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
-0000e0d0: 636b 220a 6173 7365 7274 2072 6563 6569  ck".assert recei
-0000e0e0: 7665 645f 6576 656e 7473 5b2d 315d 2e69  ved_events[-1].i
-0000e0f0: 6420 3d3d 2065 7665 6e74 342e 6964 0a0a  d == event4.id..
-0000e100: 2320 4170 7065 6e64 2073 7562 7365 7175  # Append subsequ
-0000e110: 656e 7420 6576 656e 7473 2074 6f20 7468  ent events to th
-0000e120: 6520 7374 7265 616d 2e0a 6576 656e 7435  e stream..event5
-0000e130: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
-0000e140: 3d27 4f72 6465 7255 7064 6174 6564 272c  ='OrderUpdated',
-0000e150: 2064 6174 613d 6227 6461 7461 3527 290a   data=b'data5').
-0000e160: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-0000e170: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-0000e180: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000e190: 6532 2c0a 2020 2020 6578 7065 6374 6564  e2,.    expected
-0000e1a0: 5f70 6f73 6974 696f 6e3d 302c 0a20 2020  _position=0,.   
-0000e1b0: 2065 7665 6e74 733d 5b65 7665 6e74 355d   events=[event5]
-0000e1c0: 2c0a 290a 0a23 2052 6563 6569 7665 2073  ,.)..# Receive s
-0000e1d0: 7562 7365 7175 656e 7420 6576 656e 7473  ubsequent events
-0000e1e0: 2066 726f 6d20 7468 6520 7375 6273 6372   from the subscr
-0000e1f0: 6970 7469 6f6e 2e0a 666f 7220 6576 656e  iption..for even
-0000e200: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
-0000e210: 6e3a 0a20 2020 206c 6173 745f 636f 6d6d  n:.    last_comm
-0000e220: 6974 5f70 6f73 6974 696f 6e20 3d20 6576  it_position = ev
-0000e230: 656e 742e 636f 6d6d 6974 5f70 6f73 6974  ent.commit_posit
-0000e240: 696f 6e0a 2020 2020 7265 6365 6976 6564  ion.    received
-0000e250: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
-0000e260: 7665 6e74 290a 2020 2020 6966 2065 7665  vent).    if eve
-0000e270: 6e74 2e69 6420 3d3d 2065 7665 6e74 352e  nt.id == event5.
-0000e280: 6964 3a0a 2020 2020 2020 2020 6272 6561  id:.        brea
-0000e290: 6b0a 0a0a 0a61 7373 6572 7420 7265 6365  k....assert rece
-0000e2a0: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
-0000e2b0: 6964 203d 3d20 6576 656e 7434 2e69 640a  id == event4.id.
-0000e2c0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000e2d0: 6576 656e 7473 5b2d 315d 2e69 6420 3d3d  events[-1].id ==
-0000e2e0: 2065 7665 6e74 352e 6964 0a0a 0a23 2041   event5.id...# A
-0000e2f0: 7070 656e 6420 6d6f 7265 2065 7665 6e74  ppend more event
-0000e300: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
-0000e310: 0a65 7665 6e74 3620 3d20 4e65 7745 7665  .event6 = NewEve
-0000e320: 6e74 2874 7970 653d 274f 7264 6572 4465  nt(type='OrderDe
-0000e330: 6c65 7465 6427 2c20 6461 7461 3d62 2764  leted', data=b'd
-0000e340: 6174 6136 2729 0a63 6c69 656e 742e 6170  ata6').client.ap
-0000e350: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
-0000e360: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-0000e370: 6561 6d5f 6e61 6d65 322c 0a20 2020 2065  eam_name2,.    e
-0000e380: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-0000e390: 3d31 2c0a 2020 2020 6576 656e 7473 3d5b  =1,.    events=[
-0000e3a0: 6576 656e 7436 5d2c 0a29 0a0a 0a23 2052  event6],.)...# R
-0000e3b0: 6573 756d 6520 7375 6273 6372 6962 696e  esume subscribin
-0000e3c0: 6720 6672 6f6d 2074 6865 206c 6173 7420  g from the last 
-0000e3d0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
-0000e3e0: 0a73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
-0000e3f0: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
-0000e400: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
-0000e410: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
-0000e420: 3d6c 6173 745f 636f 6d6d 6974 5f70 6f73  =last_commit_pos
-0000e430: 6974 696f 6e0a 290a 0a0a 2320 4361 7463  ition.)...# Catc
-0000e440: 6820 7570 2062 7920 7265 6365 6976 696e  h up by receivin
-0000e450: 6720 7468 6520 6e65 7720 6576 656e 7420  g the new event 
-0000e460: 6672 6f6d 2074 6865 2073 7562 7363 7269  from the subscri
-0000e470: 7074 696f 6e2e 0a66 6f72 2065 7665 6e74  ption..for event
-0000e480: 2069 6e20 7375 6273 6372 6970 7469 6f6e   in subscription
-0000e490: 3a0a 2020 2020 7265 6365 6976 6564 5f65  :.    received_e
-0000e4a0: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000e4b0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
-0000e4c0: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-0000e4d0: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
-0000e4e0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000e4f0: 5f65 7665 6e74 735b 2d33 5d2e 6964 203d  _events[-3].id =
-0000e500: 3d20 6576 656e 7434 2e69 640a 6173 7365  = event4.id.asse
-0000e510: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
-0000e520: 7473 5b2d 325d 2e69 6420 3d3d 2065 7665  ts[-2].id == eve
-0000e530: 6e74 352e 6964 0a61 7373 6572 7420 7265  nt5.id.assert re
-0000e540: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
-0000e550: 5d2e 6964 203d 3d20 6576 656e 7436 2e69  ].id == event6.i
-0000e560: 640a 0a0a 2320 4170 7065 6e64 2074 6872  d...# Append thr
-0000e570: 6565 206d 6f72 6520 6576 656e 7473 2074  ee more events t
-0000e580: 6f20 6120 6e65 7720 7374 7265 616d 2e0a  o a new stream..
-0000e590: 7374 7265 616d 5f6e 616d 6533 203d 2073  stream_name3 = s
-0000e5a0: 7472 2875 7569 6434 2829 290a 6576 656e  tr(uuid4()).even
-0000e5b0: 7437 203d 204e 6577 4576 656e 7428 7479  t7 = NewEvent(ty
-0000e5c0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
-0000e5d0: 272c 2064 6174 613d 6227 6461 7461 3727  ', data=b'data7'
-0000e5e0: 290a 6576 656e 7438 203d 204e 6577 4576  ).event8 = NewEv
-0000e5f0: 656e 7428 7479 7065 3d27 4f72 6465 7255  ent(type='OrderU
-0000e600: 7064 6174 6564 272c 2064 6174 613d 6227  pdated', data=b'
-0000e610: 6461 7461 3827 290a 6576 656e 7439 203d  data8').event9 =
-0000e620: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
-0000e630: 4f72 6465 7244 656c 6574 6564 272c 2064  OrderDeleted', d
-0000e640: 6174 613d 6227 6461 7461 3927 290a 0a63  ata=b'data9')..c
-0000e650: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-0000e660: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-0000e670: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000e680: 332c 0a20 2020 2065 7870 6563 7465 645f  3,.    expected_
-0000e690: 706f 7369 7469 6f6e 3d4e 6f6e 652c 0a20  position=None,. 
-0000e6a0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-0000e6b0: 372c 2065 7665 6e74 382c 2065 7665 6e74  7, event8, event
-0000e6c0: 395d 2c0a 290a 0a23 2052 6563 6569 7665  9],.)..# Receive
-0000e6d0: 2074 6865 2074 6872 6565 206e 6577 2065   the three new e
-0000e6e0: 7665 6e74 7320 6672 6f6d 2074 6865 2072  vents from the r
-0000e6f0: 6573 756d 6564 2073 7562 7363 7269 7074  esumed subscript
-0000e700: 696f 6e2e 0a66 6f72 2065 7665 6e74 2069  ion..for event i
-0000e710: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
-0000e720: 2020 2020 7265 6365 6976 6564 5f65 7665      received_eve
-0000e730: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-0000e740: 290a 2020 2020 6966 2065 7665 6e74 2e69  ).    if event.i
-0000e750: 6420 3d3d 2065 7665 6e74 392e 6964 3a0a  d == event9.id:.
-0000e760: 2020 2020 2020 2020 6272 6561 6b0a 0a61          break..a
-0000e770: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000e780: 7665 6e74 735b 2d36 5d2e 6964 203d 3d20  vents[-6].id == 
-0000e790: 6576 656e 7434 2e69 640a 6173 7365 7274  event4.id.assert
-0000e7a0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000e7b0: 5b2d 355d 2e69 6420 3d3d 2065 7665 6e74  [-5].id == event
-0000e7c0: 352e 6964 0a61 7373 6572 7420 7265 6365  5.id.assert rece
-0000e7d0: 6976 6564 5f65 7665 6e74 735b 2d34 5d2e  ived_events[-4].
-0000e7e0: 6964 203d 3d20 6576 656e 7436 2e69 640a  id == event6.id.
-0000e7f0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000e800: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
-0000e810: 2065 7665 6e74 372e 6964 0a61 7373 6572   event7.id.asser
-0000e820: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000e830: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
-0000e840: 7438 2e69 640a 6173 7365 7274 2072 6563  t8.id.assert rec
-0000e850: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
-0000e860: 2e69 6420 3d3d 2065 7665 6e74 392e 6964  .id == event9.id
-0000e870: 0a60 6060 0a0a 5468 6520 6361 7463 682d  .```..The catch-
-0000e880: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-0000e890: 6361 6c6c 2069 7320 656e 6465 6420 6173  call is ended as
-0000e8a0: 2073 6f6f 6e20 6173 2074 6865 2073 7562   soon as the sub
-0000e8b0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-0000e8c0: 0a67 6f65 7320 6f75 7420 6f66 2073 636f  .goes out of sco
-0000e8d0: 7065 206f 7220 6973 2065 7870 6c69 6369  pe or is explici
-0000e8e0: 746c 7920 6465 6c65 7465 6420 6672 6f6d  tly deleted from
-0000e8f0: 206d 656d 6f72 792e 0a0a 6060 6070 7974   memory...```pyt
-0000e900: 686f 6e0a 2320 456e 6420 7468 6520 7375  hon.# End the su
-0000e910: 6273 6372 6970 7469 6f6e 2e0a 6465 6c20  bscription..del 
-0000e920: 7375 6273 6372 6970 7469 6f6e 0a60 6060  subscription.```
-0000e930: 0a0a 2323 2320 5375 6273 6372 6962 6520  ..### Subscribe 
-0000e940: 7374 7265 616d 2065 7665 6e74 730a 0a54  stream events..T
-0000e950: 6865 6073 7562 7363 7269 6265 5f73 7472  he`subscribe_str
-0000e960: 6561 6d5f 6576 656e 7473 2829 6020 6d65  eam_events()` me
-0000e970: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-0000e980: 2074 6f20 7374 6172 7420 6120 2263 6174   to start a "cat
-0000e990: 6368 2d75 7022 2073 7562 7363 7269 7074  ch-up" subscript
-0000e9a0: 696f 6e0a 7468 6174 2063 616e 2072 6574  ion.that can ret
-0000e9b0: 7572 6e20 6576 656e 7473 2074 6861 7420  urn events that 
-0000e9c0: 6172 6520 7265 636f 7264 6564 2069 6e20  are recorded in 
-0000e9d0: 6120 7369 6e67 6c65 2073 7472 6561 6d2e  a single stream.
-0000e9e0: 0a0a 5468 6973 206d 6574 686f 6420 7461  ..This method ta
-0000e9f0: 6b65 7320 6120 7265 7175 6972 6564 2060  kes a required `
-0000ea00: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
-0000ea10: 756d 656e 742c 2077 6869 6368 2073 7065  ument, which spe
-0000ea20: 6369 6669 6573 2074 6865 206e 616d 6520  cifies the name 
-0000ea30: 6f66 2074 6865 2073 7472 6561 6d0a 6672  of the stream.fr
-0000ea40: 6f6d 2077 6869 6368 2072 6563 6f72 6465  om which recorde
-0000ea50: 6420 6576 656e 7473 2077 696c 6c20 6265  d events will be
-0000ea60: 2072 6563 6569 7665 642e 0a0a 5468 6973   received...This
-0000ea70: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-0000ea80: 6573 2074 776f 206f 7074 696f 6e61 6c20  es two optional 
-0000ea90: 6172 6775 6d65 6e74 732c 2060 7374 7265  arguments, `stre
-0000eaa0: 616d 5f70 6f73 6974 696f 6e60 2c20 616e  am_position`, an
-0000eab0: 6420 6074 696d 656f 7574 602e 0a0a 5468  d `timeout`...Th
-0000eac0: 6520 6f70 7469 6f6e 616c 2060 7374 7265  e optional `stre
-0000ead0: 616d 5f70 6f73 6974 696f 6e60 2061 7267  am_position` arg
-0000eae0: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
-0000eaf0: 6120 706f 7369 7469 6f6e 2069 6e20 7468  a position in th
-0000eb00: 6520 7374 7265 616d 2066 726f 6d20 7768  e stream from wh
-0000eb10: 6963 680a 7265 636f 7264 6564 2065 7665  ich.recorded eve
-0000eb20: 6e74 7320 7769 6c6c 2062 6520 7265 6365  nts will be rece
-0000eb30: 6976 6564 2e20 5468 6520 6576 656e 7420  ived. The event 
-0000eb40: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
-0000eb50: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-0000eb60: 2077 696c 6c20 6e6f 740a 6265 2069 6e63   will not.be inc
-0000eb70: 6c75 6465 642e 0a0a 5468 6520 6f70 7469  luded...The opti
-0000eb80: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-0000eb90: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-0000eba0: 686f 6e20 6066 6c6f 6174 6020 7468 6174  hon `float` that
-0000ebb0: 2073 6574 730a 6120 6465 6164 6c69 6e65   sets.a deadline
-0000ebc0: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-0000ebd0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-0000ebe0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
-0000ebf0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000ec00: 6f77 7320 686f 7720 746f 2073 7461 7274  ows how to start
-0000ec10: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-0000ec20: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
-0000ec30: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
-0000ec40: 0a0a 2320 5375 6273 6372 6962 6520 746f  ..# Subscribe to
-0000ec50: 2065 7665 6e74 7320 6672 6f6d 2073 7472   events from str
-0000ec60: 6561 6d32 2c20 6672 6f6d 2074 6865 2073  eam2, from the s
-0000ec70: 7461 7274 2e0a 7375 6273 6372 6970 7469  tart..subscripti
-0000ec80: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
-0000ec90: 6372 6962 655f 7374 7265 616d 5f65 7665  cribe_stream_eve
-0000eca0: 6e74 7328 7374 7265 616d 5f6e 616d 653d  nts(stream_name=
-0000ecb0: 7374 7265 616d 5f6e 616d 6532 290a 0a23  stream_name2)..#
-0000ecc0: 2052 6561 6420 6672 6f6d 2074 6865 2073   Read from the s
-0000ecd0: 7562 7363 7269 7074 696f 6e2e 0a65 7665  ubscription..eve
-0000ece0: 6e74 7320 3d20 5b5d 0a66 6f72 2065 7665  nts = [].for eve
-0000ecf0: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
-0000ed00: 6f6e 3a0a 2020 2020 6576 656e 7473 2e61  on:.    events.a
-0000ed10: 7070 656e 6428 6576 656e 7429 0a20 2020  ppend(event).   
-0000ed20: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
-0000ed30: 6576 656e 7436 2e69 643a 0a20 2020 2020  event6.id:.     
-0000ed40: 2020 2062 7265 616b 0a0a 2320 4368 6563     break..# Chec
-0000ed50: 6b20 7765 2067 6f74 2065 7665 6e74 7320  k we got events 
-0000ed60: 6f6e 6c79 2066 726f 6d20 7374 7265 616d  only from stream
-0000ed70: 322e 0a61 7373 6572 7420 6c65 6e28 6576  2..assert len(ev
-0000ed80: 656e 7473 2920 3d3d 2033 0a65 7665 6e74  ents) == 3.event
-0000ed90: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
-0000eda0: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-0000edb0: 0a65 7665 6e74 735b 315d 2e73 7472 6561  .events[1].strea
-0000edc0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000edd0: 5f6e 616d 6532 0a65 7665 6e74 735b 325d  _name2.events[2]
-0000ede0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-0000edf0: 7374 7265 616d 5f6e 616d 6532 0a0a 2320  stream_name2..# 
-0000ee00: 4170 7065 6e64 2061 6e6f 7468 6572 2065  Append another e
-0000ee10: 7665 6e74 2074 6f20 7374 7265 616d 332e  vent to stream3.
-0000ee20: 0a65 7665 6e74 3130 203d 204e 6577 4576  .event10 = NewEv
-0000ee30: 656e 7428 7479 7065 3d22 4f72 6465 7255  ent(type="OrderU
-0000ee40: 6e64 656c 6574 6564 222c 2064 6174 613d  ndeleted", data=
-0000ee50: 6227 6461 7461 3130 2729 0a63 6c69 656e  b'data10').clien
-0000ee60: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
-0000ee70: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
-0000ee80: 3d73 7472 6561 6d5f 6e61 6d65 332c 0a20  =stream_name3,. 
-0000ee90: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-0000eea0: 7469 6f6e 3d32 2c0a 2020 2020 6576 656e  tion=2,.    even
-0000eeb0: 7473 3d5b 6576 656e 7431 305d 2c0a 290a  ts=[event10],.).
-0000eec0: 0a23 2041 7070 656e 6420 616e 6f74 6865  .# Append anothe
-0000eed0: 7220 6576 656e 7420 746f 2073 7472 6561  r event to strea
-0000eee0: 6d32 2e0a 6576 656e 7431 3120 3d20 4e65  m2..event11 = Ne
-0000eef0: 7745 7665 6e74 2874 7970 653d 224f 7264  wEvent(type="Ord
-0000ef00: 6572 556e 6465 6c65 7465 6422 2c20 6461  erUndeleted", da
-0000ef10: 7461 3d62 2764 6174 6131 3127 290a 636c  ta=b'data11').cl
-0000ef20: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-0000ef30: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-0000ef40: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0000ef50: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
-0000ef60: 6f73 6974 696f 6e3d 322c 0a20 2020 2065  osition=2,.    e
-0000ef70: 7665 6e74 733d 5b65 7665 6e74 3131 5d0a  vents=[event11].
-0000ef80: 290a 0a23 2043 6f6e 7469 6e75 6520 7265  )..# Continue re
-0000ef90: 6164 696e 6720 6672 6f6d 2074 6865 2073  ading from the s
-0000efa0: 7562 7363 7269 7074 696f 6e2e 0a66 6f72  ubscription..for
-0000efb0: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
-0000efc0: 6970 7469 6f6e 3a0a 2020 2020 6576 656e  iption:.    even
-0000efd0: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
-0000efe0: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-0000eff0: 203d 3d20 6576 656e 7431 312e 6964 3a0a   == event11.id:.
-0000f000: 2020 2020 2020 2020 6272 6561 6b0a 0a23          break..#
-0000f010: 2043 6865 636b 2077 6520 676f 7420 6576   Check we got ev
-0000f020: 656e 7473 206f 6e6c 7920 6672 6f6d 2073  ents only from s
-0000f030: 7472 6561 6d32 2e0a 6173 7365 7274 206c  tream2..assert l
-0000f040: 656e 2865 7665 6e74 7329 203d 3d20 340a  en(events) == 4.
-0000f050: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-0000f060: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000f070: 6e61 6d65 320a 6576 656e 7473 5b31 5d2e  name2.events[1].
-0000f080: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-0000f090: 7472 6561 6d5f 6e61 6d65 320a 6576 656e  tream_name2.even
-0000f0a0: 7473 5b32 5d2e 7374 7265 616d 5f6e 616d  ts[2].stream_nam
-0000f0b0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-0000f0c0: 320a 6576 656e 7473 5b33 5d2e 7374 7265  2.events[3].stre
-0000f0d0: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-0000f0e0: 6d5f 6e61 6d65 320a 6060 600a 0a54 6865  m_name2.```..The
-0000f0f0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000f100: 686f 7773 2068 6f77 2074 6f20 7374 6172  hows how to star
-0000f110: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
-0000f120: 7363 7269 7074 696f 6e20 746f 2061 2073  scription to a s
-0000f130: 7472 6561 6d20 6672 6f6d 2061 0a73 7065  tream from a.spe
-0000f140: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
-0000f150: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
-0000f160: 6e0a 0a23 2053 7562 7363 7269 6265 2074  n..# Subscribe t
-0000f170: 6f20 6576 656e 7473 2066 726f 6d20 7374  o events from st
-0000f180: 7265 616d 322c 2066 726f 6d20 7468 6520  ream2, from the 
-0000f190: 7374 6172 742e 0a73 7562 7363 7269 7074  start..subscript
-0000f1a0: 696f 6e20 3d20 636c 6965 6e74 2e73 7562  ion = client.sub
-0000f1b0: 7363 7269 6265 5f73 7472 6561 6d5f 6576  scribe_stream_ev
-0000f1c0: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-0000f1d0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000f1e0: 6532 2c0a 2020 2020 7374 7265 616d 5f70  e2,.    stream_p
-0000f1f0: 6f73 6974 696f 6e3d 312c 0a29 0a0a 2320  osition=1,.)..# 
-0000f200: 5265 6164 2065 7665 6e74 2066 726f 6d20  Read event from 
-0000f210: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f220: 2e0a 6576 656e 7473 203d 205b 5d0a 666f  ..events = [].fo
-0000f230: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-0000f240: 7269 7074 696f 6e3a 0a20 2020 2065 7665  ription:.    eve
-0000f250: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-0000f260: 290a 2020 2020 6966 2065 7665 6e74 2e69  ).    if event.i
-0000f270: 6420 3d3d 2065 7665 6e74 3131 2e69 643a  d == event11.id:
-0000f280: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
-0000f290: 2320 4368 6563 6b20 7765 2067 6f74 2065  # Check we got e
-0000f2a0: 7665 6e74 7320 6f6e 6c79 2061 6674 6572  vents only after
-0000f2b0: 2070 6f73 6974 696f 6e20 312e 0a61 7373   position 1..ass
-0000f2c0: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-0000f2d0: 3d3d 2032 0a65 7665 6e74 735b 305d 2e69  == 2.events[0].i
-0000f2e0: 6420 3d3d 2065 7665 6e74 362e 6964 0a65  d == event6.id.e
-0000f2f0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-0000f300: 706f 7369 7469 6f6e 203d 3d20 320a 6576  position == 2.ev
-0000f310: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
-0000f320: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000f330: 6d65 320a 6576 656e 7473 5b31 5d2e 6964  me2.events[1].id
-0000f340: 203d 3d20 6576 656e 7431 312e 6964 0a65   == event11.id.e
-0000f350: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
-0000f360: 706f 7369 7469 6f6e 203d 3d20 330a 6576  position == 3.ev
-0000f370: 656e 7473 5b31 5d2e 7374 7265 616d 5f6e  ents[1].stream_n
-0000f380: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000f390: 6d65 320a 6060 600a 0a23 2320 5065 7273  me2.```..## Pers
-0000f3a0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000f3b0: 696f 6e73 0a0a 2323 2320 4372 6561 7465  ions..### Create
-0000f3c0: 2073 7562 7363 7269 7074 696f 6e0a 0a2a   subscription..*
-0000f3d0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
-0000f3e0: 0a0a 5468 6520 6d65 7468 6f64 2060 6372  ..The method `cr
-0000f3f0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-0000f400: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
-0000f410: 2074 6f20 6372 6561 7465 2061 0a22 7065   to create a."pe
-0000f420: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-0000f430: 7074 696f 6e22 2074 6f20 4576 656e 7453  ption" to EventS
-0000f440: 746f 7265 4442 2e0a 0a54 6869 7320 6d65  toreDB...This me
-0000f450: 7468 6f64 2074 616b 6573 2061 2072 6571  thod takes a req
-0000f460: 7569 7265 6420 6067 726f 7570 5f6e 616d  uired `group_nam
-0000f470: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
-0000f480: 6368 2069 7320 7468 650a 6e61 6d65 206f  ch is the.name o
-0000f490: 6620 6120 2267 726f 7570 2220 6f66 2063  f a "group" of c
-0000f4a0: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
-0000f4b0: 7375 6273 6372 6970 7469 6f6e 2e0a 0a54  subscription...T
-0000f4c0: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-0000f4d0: 7461 6b65 7320 7365 7665 6e20 6f70 7469  takes seven opti
-0000f4e0: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
-0000f4f0: 6066 726f 6d5f 656e 6460 2c20 6063 6f6d  `from_end`, `com
-0000f500: 6d69 745f 706f 7369 7469 6f6e 602c 0a60  mit_position`,.`
-0000f510: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
-0000f520: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
-0000f530: 602c 2060 6669 6c74 6572 5f62 795f 7374  `, `filter_by_st
-0000f540: 7265 616d 5f6e 616d 6560 2c20 6063 6f6e  ream_name`, `con
-0000f550: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
-0000f560: 0a61 6e64 2060 7469 6d65 6f75 7460 2e0a  .and `timeout`..
-0000f570: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
-0000f580: 726f 6d5f 656e 6460 2061 7267 756d 656e  rom_end` argumen
-0000f590: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-0000f5a0: 2073 7065 6369 6679 2074 6861 7420 7468   specify that th
-0000f5b0: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
-0000f5c0: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
-0000f5d0: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
-0000f5e0: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
-0000f5f0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
-0000f600: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
-0000f610: 2073 7562 7363 7269 7074 696f 6e0a 7761   subscription.wa
-0000f620: 7320 6372 6561 7465 642e 0a0a 416c 7465  s created...Alte
-0000f630: 726e 6174 6976 656c 792c 2074 6865 206f  rnatively, the o
-0000f640: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
-0000f650: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-0000f660: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
-0000f670: 6f20 7370 6563 6966 7920 6120 636f 6d6d  o specify a comm
-0000f680: 6974 0a70 6f73 6974 696f 6e20 6672 6f6d  it.position from
-0000f690: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
-0000f6a0: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
-0000f6b0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-0000f6c0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000f6d0: 6e20 7368 6f75 6c64 0a72 6563 6569 7665  n should.receive
-0000f6e0: 2065 7665 6e74 732e 2050 6c65 6173 6520   events. Please 
-0000f6f0: 6e6f 7465 2c20 7468 6520 7265 636f 7264  note, the record
-0000f700: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
-0000f710: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
-0000f720: 2070 6f73 6974 696f 6e20 6d69 6768 740a   position might.
-0000f730: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
-0000f740: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000f750: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
-0000f760: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
-0000f770: 756d 6572 732e 0a0a 4966 206e 6569 7468  umers...If neith
-0000f780: 6572 2060 6672 6f6d 5f65 6e64 6020 6f72  er `from_end` or
-0000f790: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
-0000f7a0: 6e60 2061 7265 2073 7065 6369 6669 6564  n` are specified
-0000f7b0: 2c20 7468 6520 6772 6f75 7020 6f66 2063  , the group of c
-0000f7c0: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
-0000f7d0: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
-0000f7e0: 6c20 706f 7465 6e74 6961 6c6c 7920 7265  l potentially re
-0000f7f0: 6365 6976 6520 616c 6c20 7265 636f 7264  ceive all record
-0000f800: 6564 2065 7665 6e74 7320 696e 2074 6865  ed events in the
-0000f810: 2064 6174 6162 6173 652e 0a0a 5468 6520   database...The 
-0000f820: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
-0000f830: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
-0000f840: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
-0000f850: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
-0000f860: 6573 7369 6f6e 7320 7468 6174 0a6d 6174  essions that.mat
-0000f870: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
-0000f880: 7473 2074 6861 7420 7368 6f75 6c64 206e  ts that should n
-0000f890: 6f74 2062 6520 696e 636c 7564 6564 2e20  ot be included. 
-0000f8a0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
-0000f8b0: 2069 676e 6f72 6564 0a69 6620 6066 696c   ignored.if `fil
-0000f8c0: 7465 725f 696e 636c 7564 6560 2069 7320  ter_include` is 
-0000f8d0: 7365 7420 746f 2061 206e 6f6e 2d65 6d70  set to a non-emp
-0000f8e0: 7479 2073 6571 7565 6e63 652e 2042 7920  ty sequence. By 
-0000f8f0: 6465 6661 756c 742c 2074 6869 7320 6172  default, this ar
-0000f900: 6775 6d65 6e74 2069 7320 7365 740a 746f  gument is set.to
-0000f910: 206d 6174 6368 2074 6865 2065 7665 6e74   match the event
-0000f920: 2074 7970 6573 206f 6620 2273 7973 7465   types of "syste
-0000f930: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
-0000f940: 6174 2045 7665 6e74 5374 6f72 6544 4220  at EventStoreDB 
-0000f950: 7379 7374 656d 2065 7665 6e74 730a 7769  system events.wi
-0000f960: 6c6c 206e 6f74 206e 6f72 6d61 6c6c 7920  ll not normally 
-0000f970: 6265 2072 6563 6569 7665 642e 2053 6565  be received. See
-0000f980: 2074 6865 204e 6f74 6573 2073 6563 7469   the Notes secti
-0000f990: 6f6e 2062 656c 6f77 2066 6f72 206d 6f72  on below for mor
-0000f9a0: 6520 696e 666f 726d 6174 696f 6e0a 6162  e information.ab
-0000f9b0: 6f75 7420 6669 6c74 6572 2065 7870 7265  out filter expre
-0000f9c0: 7373 696f 6e73 2e0a 0a54 6865 206f 7074  ssions...The opt
-0000f9d0: 696f 6e61 6c20 6066 696c 7465 725f 696e  ional `filter_in
-0000f9e0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
-0000f9f0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
-0000fa00: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
-0000fa10: 696f 6e73 0a74 6861 7420 6d61 7463 6820  ions.that match 
-0000fa20: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000fa30: 7468 6174 2073 686f 756c 6420 6265 2072  that should be r
-0000fa40: 6563 6569 7665 642e 2042 7920 6465 6661  eceived. By defa
-0000fa50: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
-0000fa60: 6e74 0a69 7320 616e 2065 6d70 7479 2074  nt.is an empty t
-0000fa70: 7570 6c65 2e20 4966 2074 6869 7320 6172  uple. If this ar
-0000fa80: 6775 6d65 6e74 2069 7320 7365 7420 746f  gument is set to
-0000fa90: 2061 206e 6f6e 2d65 6d70 7479 2073 6571   a non-empty seq
-0000faa0: 7565 6e63 652c 2074 6865 0a60 6669 6c74  uence, the.`filt
-0000fab0: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
-0000fac0: 6d65 6e74 2069 7320 6967 6e6f 7265 642e  ment is ignored.
-0000fad0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-0000fae0: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
-0000faf0: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
-0000fb00: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
-0000fb10: 6c60 2074 6861 7420 696e 6469 6361 7465  l` that indicate
-0000fb20: 7320 7768 6574 6865 720a 7468 6520 6669  s whether.the fi
-0000fb30: 6c74 6572 2077 696c 6c20 6170 706c 7920  lter will apply 
-0000fb40: 746f 2065 7665 6e74 2074 7970 6573 206f  to event types o
-0000fb50: 7220 7374 7265 616d 206e 616d 6573 2e20  r stream names. 
-0000fb60: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
-0000fb70: 2076 616c 7565 2069 7320 6046 616c 7365   value is `False
-0000fb80: 600a 616e 6420 736f 2074 6865 2066 696c  `.and so the fil
-0000fb90: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
-0000fba0: 7920 746f 2074 6865 2065 7665 6e74 2074  y to the event t
-0000fbb0: 7970 6520 7374 7269 6e67 7320 6f66 2072  ype strings of r
-0000fbc0: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
-0000fbd0: 0a54 6865 206f 7074 696f 6e61 6c20 6063  .The optional `c
-0000fbe0: 6f6e 7375 6d65 725f 7374 7261 7465 6779  onsumer_strategy
-0000fbf0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-0000fc00: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
-0000fc10: 7420 6465 6669 6e65 730a 7468 6520 636f  t defines.the co
-0000fc20: 6e73 756d 6572 2073 7472 6174 6567 7920  nsumer strategy 
-0000fc30: 666f 7220 7468 6973 2070 6572 7369 7374  for this persist
-0000fc40: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-0000fc50: 2e20 5468 6520 7661 6c75 6520 6f66 2074  . The value of t
-0000fc60: 6869 7320 6172 6775 6d65 6e74 0a63 616e  his argument.can
-0000fc70: 2062 6520 6027 4469 7370 6174 6368 546f   be `'DispatchTo
-0000fc80: 5369 6e67 6c65 2760 2c20 6027 526f 756e  Single'`, `'Roun
-0000fc90: 6452 6f62 696e 2760 2c20 6027 5069 6e6e  dRobin'`, `'Pinn
-0000fca0: 6564 2760 2c20 6f72 2060 2750 696e 6e65  ed'`, or `'Pinne
-0000fcb0: 6442 7943 6f72 7265 6c61 7469 6f6e 2760  dByCorrelation'`
-0000fcc0: 2e20 5468 650a 6465 6661 756c 7420 7661  . The.default va
-0000fcd0: 6c75 6520 6973 2060 2744 6973 7061 7463  lue is `'Dispatc
-0000fce0: 6854 6f53 696e 676c 6527 602e 0a0a 5468  hToSingle'`...Th
-0000fcf0: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
-0000fd00: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
-0000fd10: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-0000fd20: 6020 7768 6963 6820 7365 7473 2061 0a64  ` which sets a.d
-0000fd30: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000fd40: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000fd50: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000fd60: 2e0a 0a54 6865 206d 6574 686f 6420 6063  ...The method `c
-0000fd70: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-0000fd80: 6f6e 2829 6020 646f 6573 206e 6f74 2072  on()` does not r
-0000fd90: 6574 7572 6e20 6120 7661 6c75 652c 2062  eturn a value, b
-0000fda0: 6563 6175 7365 0a72 6563 6f72 6465 6420  ecause.recorded 
-0000fdb0: 6576 656e 7473 2061 7265 206f 6274 6169  events are obtai
-0000fdc0: 6e65 6420 6279 2074 6865 2067 726f 7570  ned by the group
-0000fdd0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-0000fde0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000fdf0: 6e0a 7573 696e 6720 7468 6520 6072 6561  n.using the `rea
-0000fe00: 645f 7375 6273 6372 6970 7469 6f6e 2829  d_subscription()
-0000fe10: 6020 6d65 7468 6f64 2e0a 0a49 6e20 7468  ` method...In th
-0000fe20: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
-0000fe30: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
-0000fe40: 6273 6372 6970 7469 6f6e 2069 7320 6372  bscription is cr
-0000fe50: 6561 7465 642e 0a0a 6060 6070 7974 686f  eated...```pytho
-0000fe60: 6e0a 2320 4372 6561 7465 2061 2070 6572  n.# Create a per
-0000fe70: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000fe80: 7469 6f6e 2e0a 6772 6f75 705f 6e61 6d65  tion..group_name
-0000fe90: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
-0000fea0: 3428 297d 220a 636c 6965 6e74 2e63 7265  4()}".client.cre
-0000feb0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-0000fec0: 2867 726f 7570 5f6e 616d 653d 6772 6f75  (group_name=grou
-0000fed0: 705f 6e61 6d65 290a 6060 600a 0a23 2323  p_name).```..###
-0000fee0: 2052 6561 6420 7375 6273 6372 6970 7469   Read subscripti
-0000fef0: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
-0000ff00: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
-0000ff10: 6420 6072 6561 645f 7375 6273 6372 6970  d `read_subscrip
-0000ff20: 7469 6f6e 2829 6020 6361 6e20 6265 2075  tion()` can be u
-0000ff30: 7365 6420 6279 2061 2067 726f 7570 206f  sed by a group o
-0000ff40: 6620 636f 6e73 756d 6572 7320 746f 2072  f consumers to r
-0000ff50: 6563 6569 7665 0a72 6563 6f72 6465 6420  eceive.recorded 
-0000ff60: 6576 656e 7473 2066 726f 6d20 6120 7065  events from a pe
-0000ff70: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-0000ff80: 7074 696f 6e20 6372 6561 7465 6420 7573  ption created us
-0000ff90: 696e 6720 6063 7265 6174 655f 7375 6273  ing `create_subs
-0000ffa0: 6372 6970 7469 6f6e 602e 0a0a 5468 6973  cription`...This
-0000ffb0: 206d 6574 686f 6420 7461 6b65 7320 6120   method takes a 
-0000ffc0: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
-0000ffd0: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
-0000ffe0: 7768 6963 6820 6973 0a74 6865 206e 616d  which is.the nam
-0000fff0: 6520 6f66 2061 2022 6772 6f75 7022 206f  e of a "group" o
-00010000: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
-00010010: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00010020: 7370 6563 6966 6965 640a 7768 656e 2060  specified.when `
-00010030: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-00010040: 696f 6e28 2960 2077 6173 2063 616c 6c65  ion()` was calle
-00010050: 642e 0a0a 5468 6973 206d 6574 686f 6420  d...This method 
-00010060: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
-00010070: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00010080: 2061 7267 756d 656e 742c 2074 6861 740a   argument, that.
-00010090: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-000100a0: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
-000100b0: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
-000100c0: 2064 6561 646c 696e 650a 666f 7220 7468   deadline.for th
-000100d0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-000100e0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-000100f0: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
-00010100: 2072 6574 7572 6e73 2061 2060 5065 7273   returns a `Pers
-00010110: 6973 7465 6e74 5375 6273 6372 6970 7469  istentSubscripti
-00010120: 6f6e 6020 6f62 6a65 6374 2c20 7768 6963  on` object, whic
-00010130: 6820 6973 2061 6e20 6974 6572 6174 6f72  h is an iterator
-00010140: 0a67 6976 696e 6720 6052 6563 6f72 6465  .giving `Recorde
-00010150: 6445 7665 6e74 6020 6f62 6a65 6374 732c  dEvent` objects,
-00010160: 2074 6861 7420 616c 736f 2068 6173 2060   that also has `
-00010170: 6163 6b28 2960 2c20 606e 6163 6b28 2960  ack()`, `nack()`
-00010180: 2061 6e64 2060 7374 6f70 2829 600a 6d65   and `stop()`.me
-00010190: 7468 6f64 732e 0a0a 6060 6070 7974 686f  thods...```pytho
-000101a0: 6e0a 7375 6273 6372 6970 7469 6f6e 203d  n.subscription =
-000101b0: 2063 6c69 656e 742e 7265 6164 5f73 7562   client.read_sub
-000101c0: 7363 7269 7074 696f 6e28 6772 6f75 705f  scription(group_
-000101d0: 6e61 6d65 3d67 726f 7570 5f6e 616d 6529  name=group_name)
-000101e0: 0a60 6060 0a0a 5468 6520 6061 636b 2829  .```..The `ack()
-000101f0: 6020 6d65 7468 6f64 2073 686f 756c 6420  ` method should 
-00010200: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
-00010210: 7375 6d65 7220 746f 2069 6e64 6963 6174  sumer to indicat
-00010220: 6520 746f 2074 6865 2073 6572 7665 7220  e to the server 
-00010230: 7468 6174 2069 740a 6861 7320 7265 6365  that it.has rece
-00010240: 6976 6564 2061 6e64 2073 7563 6365 7373  ived and success
-00010250: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
-00010260: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
-00010270: 2e20 5468 6973 2077 696c 6c20 7072 6576  . This will prev
-00010280: 656e 7420 7468 6174 0a72 6563 6f72 6465  ent that.recorde
-00010290: 6420 6576 656e 7420 6265 696e 6720 7265  d event being re
-000102a0: 6365 6976 6564 2062 7920 616e 6f74 6865  ceived by anothe
-000102b0: 7220 636f 6e73 756d 6572 2069 6e20 7468  r consumer in th
-000102c0: 6520 7361 6d65 2067 726f 7570 2e20 5468  e same group. Th
-000102d0: 6520 6061 636b 2829 600a 6d65 7468 6f64  e `ack()`.method
-000102e0: 2074 616b 6573 2061 6e20 6065 7665 6e74   takes an `event
-000102f0: 5f69 6460 2061 7267 756d 656e 742c 2077  _id` argument, w
-00010300: 6869 6368 2069 7320 7468 6520 4944 206f  hich is the ID o
-00010310: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-00010320: 7665 6e74 2074 6861 740a 6861 7320 6265  vent that.has be
-00010330: 656e 2072 6563 6569 7665 642e 0a0a 5468  en received...Th
-00010340: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00010350: 6974 6572 6174 6573 206f 7665 7220 7468  iterates over th
-00010360: 6520 7375 6273 6372 6970 7469 6f6e 206f  e subscription o
-00010370: 626a 6563 742c 2061 6e64 2063 616c 6c73  bject, and calls
-00010380: 2060 6163 6b28 2960 2e20 5468 650a 6073   `ack()`. The.`s
-00010390: 746f 7028 2960 206d 6574 686f 6420 6973  top()` method is
-000103a0: 2063 616c 6c65 6420 7768 656e 2077 6520   called when we 
-000103b0: 6861 7665 2072 6563 6569 7665 6420 7468  have received th
-000103c0: 6520 6c61 7374 2065 7665 6e74 2c20 736f  e last event, so
-000103d0: 2074 6861 7420 7765 2063 616e 0a63 6f6e   that we can.con
-000103e0: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
-000103f0: 7861 6d70 6c65 7320 6265 6c6f 772e 0a0a  xamples below...
-00010400: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
-00010410: 203d 205b 5d0a 666f 7220 6576 656e 7420   = [].for event 
-00010420: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
-00010430: 0a20 2020 2065 7665 6e74 732e 6170 7065  .    events.appe
-00010440: 6e64 2865 7665 6e74 290a 0a20 2020 2023  nd(event)..    #
-00010450: 2041 636b 6e6f 776c 6564 6765 2074 6865   Acknowledge the
-00010460: 2072 6563 6569 7665 6420 6576 656e 742e   received event.
-00010470: 0a20 2020 2073 7562 7363 7269 7074 696f  .    subscriptio
-00010480: 6e2e 6163 6b28 6576 656e 745f 6964 3d65  n.ack(event_id=e
-00010490: 7665 6e74 2e69 6429 0a0a 2020 2020 2320  vent.id)..    # 
-000104a0: 4272 6561 6b20 7768 656e 2074 6865 206c  Break when the l
-000104b0: 6173 7420 6576 656e 7420 6861 7320 6265  ast event has be
-000104c0: 656e 2072 6563 6569 7665 642e 0a20 2020  en received..   
-000104d0: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
-000104e0: 6576 656e 7431 312e 6964 3a0a 2020 2020  event11.id:.    
-000104f0: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
-00010500: 2e73 746f 7028 290a 6060 600a 0a54 6865  .stop().```..The
-00010510: 2072 6563 6569 7665 6420 6576 656e 7473   received events
-00010520: 2061 7265 2074 6865 2065 7665 6e74 7320   are the events 
-00010530: 7765 2061 7070 656e 6465 6420 6162 6f76  we appended abov
-00010540: 652e 0a0a 6060 6070 7974 686f 6e0a 6173  e...```python.as
-00010550: 7365 7274 2065 7665 6e74 735b 2d31 355d  sert events[-15]
-00010560: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
-00010570: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
-00010580: 3134 5d2e 6964 203d 3d20 6576 656e 7432  14].id == event2
-00010590: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
-000105a0: 735b 2d31 335d 2e69 6420 3d3d 2065 7665  s[-13].id == eve
-000105b0: 6e74 332e 6964 0a61 7373 6572 7420 6576  nt3.id.assert ev
-000105c0: 656e 7473 5b2d 3132 5d2e 7479 7065 203d  ents[-12].type =
-000105d0: 3d20 2244 6f67 5265 6769 7374 6572 6564  = "DogRegistered
-000105e0: 220a 6173 7365 7274 2065 7665 6e74 735b  ".assert events[
-000105f0: 2d31 315d 2e74 7970 6520 3d3d 2022 446f  -11].type == "Do
-00010600: 674c 6561 726e 6564 5472 6963 6b22 0a61  gLearnedTrick".a
-00010610: 7373 6572 7420 6576 656e 7473 5b2d 3130  ssert events[-10
-00010620: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
-00010630: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
-00010640: 7274 2065 7665 6e74 735b 2d39 5d2e 7479  rt events[-9].ty
-00010650: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
-00010660: 6454 7269 636b 220a 6173 7365 7274 2065  dTrick".assert e
-00010670: 7665 6e74 735b 2d38 5d2e 6964 203d 3d20  vents[-8].id == 
-00010680: 6576 656e 7434 2e69 640a 6173 7365 7274  event4.id.assert
-00010690: 2065 7665 6e74 735b 2d37 5d2e 6964 203d   events[-7].id =
-000106a0: 3d20 6576 656e 7435 2e69 640a 6173 7365  = event5.id.asse
-000106b0: 7274 2065 7665 6e74 735b 2d36 5d2e 6964  rt events[-6].id
-000106c0: 203d 3d20 6576 656e 7436 2e69 640a 6173   == event6.id.as
-000106d0: 7365 7274 2065 7665 6e74 735b 2d35 5d2e  sert events[-5].
-000106e0: 6964 203d 3d20 6576 656e 7437 2e69 640a  id == event7.id.
-000106f0: 6173 7365 7274 2065 7665 6e74 735b 2d34  assert events[-4
-00010700: 5d2e 6964 203d 3d20 6576 656e 7438 2e69  ].id == event8.i
-00010710: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
-00010720: 2d33 5d2e 6964 203d 3d20 6576 656e 7439  -3].id == event9
-00010730: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
-00010740: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
-00010750: 7431 302e 6964 0a61 7373 6572 7420 6576  t10.id.assert ev
-00010760: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
-00010770: 7665 6e74 3131 2e69 640a 6060 600a 0a54  vent11.id.```..T
-00010780: 6865 2022 7375 6273 6372 6970 7469 6f6e  he "subscription
-00010790: 2220 6f62 6a65 6374 2061 6c73 6f20 6861  " object also ha
-000107a0: 7320 616e 2060 6e61 636b 2829 6020 6d65  s an `nack()` me
-000107b0: 7468 6f64 2074 6861 7420 7368 6f75 6c64  thod that should
-000107c0: 2062 6520 7573 6564 2062 7920 6120 636f   be used by a co
-000107d0: 6e73 756d 6572 0a74 6f20 6e65 6761 7469  nsumer.to negati
-000107e0: 7665 6c79 2061 636b 6e6f 776c 6564 6765  vely acknowledge
-000107f0: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
-00010800: 6861 7420 6974 2068 6173 2072 6563 6569  hat it has recei
-00010810: 7665 6420 6275 7420 6e6f 7420 7375 6363  ved but not succ
-00010820: 6573 7366 756c 6c79 0a70 726f 6365 7373  essfully.process
-00010830: 6564 2061 2072 6563 6f72 6465 6420 6576  ed a recorded ev
-00010840: 656e 742e 2054 6865 2060 6e61 636b 2829  ent. The `nack()
-00010850: 6020 6d65 7468 6f64 2074 616b 6573 2061  ` method takes a
-00010860: 6e20 6065 7665 6e74 5f69 6460 2061 7267  n `event_id` arg
-00010870: 756d 656e 742c 2077 6869 6368 2069 730a  ument, which is.
-00010880: 7468 6520 4944 206f 6620 7468 6520 7265  the ID of the re
-00010890: 636f 7264 6564 2065 7665 6e74 2074 6861  corded event tha
-000108a0: 7420 6861 7320 6265 656e 2072 6563 6569  t has been recei
-000108b0: 7665 642c 2061 6e64 2061 6e20 6061 6374  ved, and an `act
-000108c0: 696f 6e60 2061 7267 756d 656e 742c 2077  ion` argument, w
-000108d0: 6869 6368 0a73 686f 756c 6420 6265 2061  hich.should be a
-000108e0: 2050 7974 686f 6e20 6073 7472 602c 2065   Python `str`, e
-000108f0: 6974 6865 7220 6027 756e 6b6e 6f77 6e27  ither `'unknown'
-00010900: 602c 2060 2770 6172 6b27 602c 2060 2772  `, `'park'`, `'r
-00010910: 6574 7279 2760 2c20 6027 736b 6970 2760  etry'`, `'skip'`
-00010920: 2c20 6f72 2060 2773 746f 7027 602e 0a0a  , or `'stop'`...
-00010930: 5768 696c 7374 2074 6865 7265 2061 7265  Whilst there are
-00010940: 2073 6f6d 6520 6164 7661 6e74 6167 6573   some advantages
-00010950: 206f 6620 7065 7273 6973 7465 6e74 2073   of persistent s
-00010960: 7562 7363 7269 7074 696f 6e73 2c20 696e  ubscriptions, in
-00010970: 2070 6172 7469 6375 6c61 7220 7468 650a   particular the.
-00010980: 7072 6f63 6573 7369 6e67 206f 6620 7265  processing of re
-00010990: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
-000109a0: 2061 2067 726f 7570 206f 6620 636f 6e73   a group of cons
-000109b0: 756d 6572 732c 2062 7920 7472 6163 6b69  umers, by tracki
-000109c0: 6e67 2069 6e20 7468 6520 7365 7276 6572  ng in the server
-000109d0: 0a74 6865 2070 6f73 6974 696f 6e20 696e  .the position in
-000109e0: 2074 6865 2063 6f6d 6d69 7420 7365 7175   the commit sequ
-000109f0: 656e 6365 206f 6620 6576 656e 7473 2074  ence of events t
-00010a00: 6861 7420 6861 7665 2062 6565 6e20 7072  hat have been pr
-00010a10: 6f63 6573 7365 642c 2074 6865 7265 2069  ocessed, there i
-00010a20: 730a 7468 6520 6461 6e67 6572 206f 6620  s.the danger of 
-00010a30: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
-00010a40: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
-00010a50: 6e20 6f66 2065 7665 6e74 732e 2052 656c  n of events. Rel
-00010a60: 6961 6269 6c69 7479 2069 6e20 7072 6f63  iability in proc
-00010a70: 6573 7369 6e67 0a6f 6620 7265 636f 7264  essing.of record
-00010a80: 6564 2065 7665 6e74 7320 6279 2061 2067  ed events by a g
-00010a90: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-00010aa0: 7320 7769 6c6c 2072 656c 7920 696e 7374  s will rely inst
-00010ab0: 6561 6420 6f6e 2069 6465 6d70 6f74 656e  ead on idempoten
-00010ac0: 7420 6861 6e64 6c69 6e67 0a6f 6620 6475  t handling.of du
-00010ad0: 706c 6963 6174 6520 6d65 7373 6167 6573  plicate messages
-00010ae0: 2c20 616e 6420 7265 7369 6c69 656e 6365  , and resilience
-00010af0: 2074 6f20 6f75 742d 6f66 2d6f 7264 6572   to out-of-order
-00010b00: 2064 656c 6976 6572 792e 0a0a 2323 2320   delivery...### 
-00010b10: 4765 7420 7375 6273 6372 6970 7469 6f6e  Get subscription
-00010b20: 2069 6e66 6f0a 0a2a 7265 7175 6972 6573   info..*requires
-00010b30: 206c 6561 6465 722a 0a0a 5468 6520 6067   leader*..The `g
-00010b40: 6574 5f73 7562 7363 7269 7074 696f 6e5f  et_subscription_
-00010b50: 696e 666f 2829 6020 6d65 7468 6f64 2063  info()` method c
-00010b60: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
-00010b70: 7420 696e 666f 726d 6174 696f 6e20 666f  t information fo
-00010b80: 7220 610a 7065 7273 6973 7465 6e74 2073  r a.persistent s
-00010b90: 7562 7363 7269 7074 696f 6e2e 0a0a 5468  ubscription...Th
-00010ba0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
-00010bb0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
-00010bc0: 656e 742c 2060 6772 6f75 705f 6e61 6d65  ent, `group_name
-00010bd0: 602c 2077 6869 6368 0a73 686f 756c 6420  `, which.should 
-00010be0: 6d61 7463 6820 7468 6520 7661 6c75 6520  match the value 
-00010bf0: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
-00010c00: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00010c10: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
-00010c20: 6970 7469 6f6e 2829 602e 0a0a 5468 6973  iption()`...This
-00010c30: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-00010c40: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-00010c50: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00010c60: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
-00010c70: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
-00010c80: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
-00010c90: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
-00010ca0: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
-00010cb0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00010cc0: 206f 7065 7261 7469 6f6e 2e0a 0a60 6060   operation...```
-00010cd0: 7079 7468 6f6e 0a73 7562 7363 7269 7074  python.subscript
-00010ce0: 696f 6e5f 696e 666f 203d 2063 6c69 656e  ion_info = clien
-00010cf0: 742e 6765 745f 7375 6273 6372 6970 7469  t.get_subscripti
-00010d00: 6f6e 5f69 6e66 6f28 0a20 2020 2067 726f  on_info(.    gro
-00010d10: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-00010d20: 6d65 2c0a 290a 6060 600a 0a54 6865 2072  me,.).```..The r
-00010d30: 6574 7572 6e65 6420 7661 6c75 6520 6973  eturned value is
-00010d40: 2061 2060 5375 6273 6372 6970 7469 6f6e   a `Subscription
-00010d50: 496e 666f 6020 6f62 6a65 6374 2e0a 0a23  Info` object...#
-00010d60: 2323 204c 6973 7420 7375 6273 6372 6970  ## List subscrip
-00010d70: 7469 6f6e 730a 0a2a 7265 7175 6972 6573  tions..*requires
-00010d80: 206c 6561 6465 722a 0a0a 5468 6520 606c   leader*..The `l
-00010d90: 6973 745f 7375 6273 6372 6970 7469 6f6e  ist_subscription
-00010da0: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
-00010db0: 6265 2075 7365 6420 746f 2067 6574 2069  be used to get i
-00010dc0: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2061  nformation for a
-00010dd0: 6c6c 0a65 7869 7374 696e 6720 7065 7273  ll.existing pers
-00010de0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00010df0: 696f 6e73 2e0a 0a54 6869 7320 6d65 7468  ions...This meth
-00010e00: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
-00010e10: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00010e20: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-00010e30: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00010e40: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00010e50: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00010e60: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-00010e70: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00010e80: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00010e90: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7562  ...```python.sub
-00010ea0: 7363 7269 7074 696f 6e73 203d 2063 6c69  scriptions = cli
-00010eb0: 656e 742e 6c69 7374 5f73 7562 7363 7269  ent.list_subscri
-00010ec0: 7074 696f 6e73 2829 0a60 6060 0a0a 5468  ptions().```..Th
-00010ed0: 6520 7265 7475 726e 6564 2076 616c 7565  e returned value
-00010ee0: 2069 7320 6120 6c69 7374 206f 6620 6053   is a list of `S
-00010ef0: 7562 7363 7269 7074 696f 6e49 6e66 6f60  ubscriptionInfo`
-00010f00: 206f 626a 6563 7473 2e0a 0a23 2323 2055   objects...### U
-00010f10: 7064 6174 6520 7375 6273 6372 6970 7469  pdate subscripti
-00010f20: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
-00010f30: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
-00010f40: 6420 6075 7064 6174 655f 7375 6273 6372  d `update_subscr
-00010f50: 6970 7469 6f6e 2829 6020 6361 6e20 6265  iption()` can be
-00010f60: 2075 7365 6420 746f 2075 7064 6174 6520   used to update 
-00010f70: 610a 2270 6572 7369 7374 656e 7420 7375  a."persistent su
-00010f80: 6273 6372 6970 7469 6f6e 222e 0a0a 5468  bscription"...Th
-00010f90: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
-00010fa0: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
-00010fb0: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
-00010fc0: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
-00010fd0: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
-00010fe0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-00010ff0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-00011000: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-00011010: 616c 736f 2074 616b 6573 2074 6872 6565  also takes three
-00011020: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-00011030: 6e74 732c 2060 6672 6f6d 5f65 6e64 602c  nts, `from_end`,
-00011040: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
-00011050: 6e60 2c0a 616e 6420 6074 696d 656f 7574  n`,.and `timeout
-00011060: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
-00011070: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
-00011080: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
-00011090: 2074 6f20 7370 6563 6966 7920 7468 6174   to specify that
-000110a0: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-000110b0: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
-000110c0: 7562 7363 7269 7074 696f 6e20 7368 6f75  ubscription shou
-000110d0: 6c64 206f 6e6c 7920 7265 6365 6976 6520  ld only receive 
-000110e0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-000110f0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
-00011100: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00011110: 0a77 6173 2075 7064 6174 6564 2e0a 0a41  .was updated...A
-00011120: 6c74 6572 6e61 7469 7665 6c79 2c20 7468  lternatively, th
-00011130: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
-00011140: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
-00011150: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
-00011160: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
-00011170: 6f6d 6d69 740a 706f 7369 7469 6f6e 2066  ommit.position f
-00011180: 726f 6d20 7768 6963 6820 636f 6d6d 6974  rom which commit
-00011190: 2070 6f73 6974 696f 6e20 7468 6520 6772   position the gr
-000111a0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-000111b0: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
-000111c0: 7469 6f6e 2073 686f 756c 640a 7265 6365  tion should.rece
-000111d0: 6976 6520 6576 656e 7473 2e20 506c 6561  ive events. Plea
-000111e0: 7365 206e 6f74 652c 2074 6865 2072 6563  se note, the rec
-000111f0: 6f72 6465 6420 6576 656e 7420 6174 2074  orded event at t
-00011200: 6865 2073 7065 6369 6669 6564 2063 6f6d  he specified com
-00011210: 6d69 7420 706f 7369 7469 6f6e 206d 6967  mit position mig
-00011220: 6874 0a62 6520 696e 636c 7564 6564 2069  ht.be included i
-00011230: 6e20 7468 6520 7265 636f 7264 6564 2065  n the recorded e
-00011240: 7665 6e74 7320 7265 6365 6976 6564 2062  vents received b
-00011250: 7920 7468 6520 6772 6f75 7020 6f66 2063  y the group of c
-00011260: 6f6e 7375 6d65 7273 2e0a 0a49 6620 6e65  onsumers...If ne
-00011270: 6974 6865 7220 6066 726f 6d5f 656e 6460  ither `from_end`
-00011280: 206f 7220 6063 6f6d 6d69 745f 706f 7369   or `commit_posi
-00011290: 7469 6f6e 6020 6172 6520 7370 6563 6966  tion` are specif
-000112a0: 6965 642c 2074 6865 2067 726f 7570 206f  ied, the group o
-000112b0: 6620 636f 6e73 756d 6572 730a 6f66 2074  f consumers.of t
-000112c0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-000112d0: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
-000112e0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
-000112f0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-00011300: 7468 6520 6461 7461 6261 7365 2e0a 0a50  the database...P
-00011310: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
-00011320: 6669 6c74 6572 206f 7074 696f 6e73 2061  filter options a
-00011330: 6e64 2063 6f6e 7375 6d65 7220 7374 7261  nd consumer stra
-00011340: 7465 6779 2063 616e 6e6f 7420 6265 2061  tegy cannot be a
-00011350: 646a 7573 7465 642e 0a0a 5468 6520 6f70  djusted...The op
-00011360: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00011370: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-00011380: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
-00011390: 6963 6820 7365 7473 2061 0a64 6561 646c  ich sets a.deadl
-000113a0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-000113b0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-000113c0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
-000113d0: 6865 206d 6574 686f 6420 6075 7064 6174  he method `updat
-000113e0: 655f 7375 6273 6372 6970 7469 6f6e 2829  e_subscription()
-000113f0: 6020 646f 6573 206e 6f74 2072 6574 7572  ` does not retur
-00011400: 6e20 6120 7661 6c75 652e 0a0a 496e 2074  n a value...In t
-00011410: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00011420: 2c20 6120 7065 7273 6973 7465 6e74 2073  , a persistent s
-00011430: 7562 7363 7269 7074 696f 6e20 6973 2075  ubscription is u
-00011440: 7064 6174 6564 2074 6f20 7275 6e20 6672  pdated to run fr
-00011450: 6f6d 2074 6865 2065 6e64 206f 6620 7468  om the end of th
-00011460: 650a 6461 7461 6261 7365 2e0a 0a60 6060  e.database...```
-00011470: 7079 7468 6f6e 0a23 2043 7265 6174 6520  python.# Create 
-00011480: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
-00011490: 7363 7269 7074 696f 6e2e 0a63 6c69 656e  scription..clien
-000114a0: 742e 7570 6461 7465 5f73 7562 7363 7269  t.update_subscri
-000114b0: 7074 696f 6e28 6772 6f75 705f 6e61 6d65  ption(group_name
-000114c0: 3d67 726f 7570 5f6e 616d 652c 2066 726f  =group_name, fro
-000114d0: 6d5f 656e 643d 5472 7565 290a 6060 600a  m_end=True).```.
-000114e0: 0a23 2323 2044 656c 6574 6520 7375 6273  .### Delete subs
-000114f0: 6372 6970 7469 6f6e 0a0a 2a72 6571 7569  cription..*requi
-00011500: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
-00011510: 2060 6465 6c65 7465 5f73 7562 7363 7269   `delete_subscri
-00011520: 7074 696f 6e28 2960 206d 6574 686f 6420  ption()` method 
-00011530: 6361 6e20 6265 2075 7365 6420 746f 2064  can be used to d
-00011540: 656c 6574 6520 6120 7065 7273 6973 7465  elete a persiste
-00011550: 6e74 0a73 7562 7363 7269 7074 696f 6e2e  nt.subscription.
-00011560: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
-00011570: 7320 6f6e 6520 7265 7175 6972 6564 2061  s one required a
-00011580: 7267 756d 656e 742c 2060 6772 6f75 705f  rgument, `group_
-00011590: 6e61 6d65 602c 2077 6869 6368 0a73 686f  name`, which.sho
-000115a0: 756c 6420 6d61 7463 6820 7468 6520 7661  uld match the va
-000115b0: 6c75 6520 6f66 2061 7267 756d 656e 7420  lue of argument 
-000115c0: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-000115d0: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
-000115e0: 6970 7469 6f6e 2829 602e 0a0a 5468 6973  iption()`...This
-000115f0: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-00011600: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-00011610: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00011620: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
-00011630: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
-00011640: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
-00011650: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
-00011660: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
-00011670: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00011680: 206f 7065 7261 7469 6f6e 2e0a 0a60 6060   operation...```
-00011690: 7079 7468 6f6e 0a63 6c69 656e 742e 6465  python.client.de
-000116a0: 6c65 7465 5f73 7562 7363 7269 7074 696f  lete_subscriptio
-000116b0: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
-000116c0: 653d 6772 6f75 705f 6e61 6d65 2c0a 290a  e=group_name,.).
-000116d0: 6060 600a 0a23 2323 2043 7265 6174 6520  ```..### Create 
-000116e0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-000116f0: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
-00011700: 6561 6465 722a 0a0a 5468 6520 6063 7265  eader*..The `cre
-00011710: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
-00011720: 7269 7074 696f 6e28 2960 206d 6574 686f  ription()` metho
-00011730: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00011740: 2063 7265 6174 6520 6120 7065 7273 6973   create a persis
-00011750: 7465 6e74 0a73 7562 7363 7269 7074 696f  tent.subscriptio
-00011760: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
-00011770: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-00011780: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
-00011790: 6775 6d65 6e74 732c 2060 6772 6f75 705f  guments, `group_
-000117a0: 6e61 6d65 6020 616e 6420 6073 7472 6561  name` and `strea
-000117b0: 6d5f 6e61 6d65 602e 2054 6865 0a60 6772  m_name`. The.`gr
-000117c0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
-000117d0: 6e74 206e 616d 6573 2074 6865 2067 726f  nt names the gro
-000117e0: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
-000117f0: 7468 6174 2077 696c 6c20 7265 6365 6976  that will receiv
-00011800: 6520 6576 656e 7473 0a66 726f 6d20 7468  e events.from th
-00011810: 6973 2073 7562 7363 7269 7074 696f 6e2e  is subscription.
-00011820: 2054 6865 2060 7374 7265 616d 5f6e 616d   The `stream_nam
-00011830: 6560 2061 7267 756d 656e 7420 7370 6563  e` argument spec
-00011840: 6966 6965 7320 7768 6963 6820 7374 7265  ifies which stre
-00011850: 616d 0a74 6865 2073 7562 7363 7269 7074  am.the subscript
-00011860: 696f 6e20 7769 6c6c 2066 6f6c 6c6f 772e  ion will follow.
-00011870: 2054 6865 2076 616c 7565 7320 6f66 2062   The values of b
-00011880: 6f74 6820 7468 6573 6520 6172 6775 6d65  oth these argume
-00011890: 6e74 7320 6172 6520 6578 7065 6374 6564  nts are expected
-000118a0: 0a74 6f20 6265 2050 7974 686f 6e20 6073  .to be Python `s
-000118b0: 7472 6020 6f62 6a65 6374 732e 0a0a 5468  tr` objects...Th
-000118c0: 6520 6d65 7468 6f64 2061 6c73 6f20 7461  e method also ta
-000118d0: 6b65 7320 666f 7572 206f 7074 696f 6e61  kes four optiona
-000118e0: 6c20 6172 6775 6d65 6e74 732c 2060 7374  l arguments, `st
-000118f0: 7265 616d 5f70 6f73 6974 696f 6e60 2c20  ream_position`, 
-00011900: 6066 726f 6d5f 656e 6460 2c0a 6063 6f6e  `from_end`,.`con
-00011910: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
-00011920: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
-00011930: 0a54 6869 7320 6f70 7469 6f6e 616c 2060  .This optional `
-00011940: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-00011950: 2061 7267 756d 656e 7420 7370 6563 6966   argument specif
-00011960: 6965 7320 6120 7374 7265 616d 2070 6f73  ies a stream pos
-00011970: 6974 696f 6e20 6672 6f6d 0a77 6869 6368  ition from.which
-00011980: 2074 6f20 7375 6273 6372 6962 652e 2054   to subscribe. T
-00011990: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-000119a0: 7420 6174 2074 6869 7320 7374 7265 616d  t at this stream
-000119b0: 0a70 6f73 6974 696f 6e20 7769 6c6c 2062  .position will b
-000119c0: 6520 7265 6365 6976 6564 2077 6865 6e20  e received when 
-000119d0: 7265 6164 696e 6720 7468 6520 7375 6273  reading the subs
-000119e0: 6372 6970 7469 6f6e 2e0a 0a54 6869 7320  cription...This 
-000119f0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-00011a00: 6e64 6020 6172 6775 6d65 6e74 2069 7320  nd` argument is 
-00011a10: 6120 5079 7468 6f6e 2060 626f 6f6c 602e  a Python `bool`.
-00011a20: 0a42 7920 6465 6661 756c 742c 2074 6865  .By default, the
-00011a30: 2076 616c 7565 206f 6620 7468 6973 2061   value of this a
-00011a40: 7267 756d 656e 7420 6973 2060 4661 6c73  rgument is `Fals
-00011a50: 6560 2e20 4966 2074 6869 7320 6172 6775  e`. If this argu
-00011a60: 6d65 6e74 2069 7320 7365 740a 746f 2060  ment is set.to `
-00011a70: 5472 7565 602c 2072 6561 6469 6e67 2066  True`, reading f
-00011a80: 726f 6d20 7468 6520 7375 6273 6372 6970  rom the subscrip
-00011a90: 7469 6f6e 2077 696c 6c20 7265 6365 6976  tion will receiv
-00011aa0: 6520 6f6e 6c79 2065 7665 6e74 730a 7265  e only events.re
-00011ab0: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
-00011ac0: 2073 7562 7363 7269 7074 696f 6e20 7761   subscription wa
-00011ad0: 7320 6372 6561 7465 642e 2054 6861 7420  s created. That 
-00011ae0: 6973 2c20 6974 2069 7320 6e6f 7420 696e  is, it is not in
-00011af0: 636c 7573 6976 650a 6f66 2074 6865 2063  clusive.of the c
-00011b00: 7572 7265 6e74 2073 7472 6561 6d20 706f  urrent stream po
-00011b10: 7369 7469 6f6e 2e0a 0a54 6865 206f 7074  sition...The opt
-00011b20: 696f 6e61 6c20 6063 6f6e 7375 6d65 725f  ional `consumer_
-00011b30: 7374 7261 7465 6779 6020 6172 6775 6d65  strategy` argume
-00011b40: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
-00011b50: 7374 7260 2074 6861 7420 6465 6669 6e65  str` that define
-00011b60: 730a 7468 6520 636f 6e73 756d 6572 2073  s.the consumer s
-00011b70: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
-00011b80: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00011b90: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
-00011ba0: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
-00011bb0: 6d65 6e74 0a63 616e 2062 6520 6027 4469  ment.can be `'Di
-00011bc0: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
-00011bd0: 2c20 6027 526f 756e 6452 6f62 696e 2760  , `'RoundRobin'`
-00011be0: 2c20 6027 5069 6e6e 6564 2760 2c20 6f72  , `'Pinned'`, or
-00011bf0: 2060 2750 696e 6e65 6442 7943 6f72 7265   `'PinnedByCorre
-00011c00: 6c61 7469 6f6e 2760 2e20 5468 650a 6465  lation'`. The.de
-00011c10: 6661 756c 7420 7661 6c75 6520 6973 2060  fault value is `
-00011c20: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
-00011c30: 6527 602e 0a0a 5468 6973 206d 6574 686f  e'`...This metho
-00011c40: 6420 616c 736f 2074 616b 6573 2061 6e20  d also takes an 
-00011c50: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-00011c60: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
-00011c70: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
-00011c80: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
-00011c90: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
-00011ca0: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
-00011cb0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-00011cc0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-00011cd0: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
-00011ce0: 6f64 2064 6f65 7320 6e6f 7420 7265 7475  od does not retu
-00011cf0: 726e 2061 2076 616c 7565 2e20 4576 656e  rn a value. Even
-00011d00: 7473 2063 616e 2062 6520 7265 6365 6976  ts can be receiv
-00011d10: 6564 2062 7920 6974 6572 6174 696e 670a  ed by iterating.
-00011d20: 6f76 6572 2074 6865 2076 616c 7565 2072  over the value r
-00011d30: 6574 7572 6e65 6420 6279 2063 616c 6c69  eturned by calli
-00011d40: 6e67 2060 7265 6164 5f73 7472 6561 6d5f  ng `read_stream_
-00011d50: 7375 6273 6372 6970 7469 6f6e 2829 602e  subscription()`.
-00011d60: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-00011d70: 6c6f 7720 6372 6561 7465 7320 6120 7065  low creates a pe
-00011d80: 7273 6973 7465 6e74 2073 7472 6561 6d20  rsistent stream 
-00011d90: 7375 6273 6372 6970 7469 6f6e 2066 726f  subscription fro
-00011da0: 6d20 7468 6520 7374 6172 7420 6f66 2074  m the start of t
-00011db0: 6865 2073 7472 6561 6d2e 0a0a 6060 6070  he stream...```p
-00011dc0: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
-00011dd0: 2070 6572 7369 7374 656e 7420 7374 7265   persistent stre
-00011de0: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
-00011df0: 6672 6f6d 2073 7461 7274 206f 6620 7468  from start of th
-00011e00: 6520 7374 7265 616d 2e0a 6772 6f75 705f  e stream..group_
-00011e10: 6e61 6d65 3120 3d20 6622 6772 6f75 702d  name1 = f"group-
-00011e20: 7b75 7569 6434 2829 7d22 0a63 6c69 656e  {uuid4()}".clien
-00011e30: 742e 6372 6561 7465 5f73 7472 6561 6d5f  t.create_stream_
-00011e40: 7375 6273 6372 6970 7469 6f6e 280a 2020  subscription(.  
-00011e50: 2020 6772 6f75 705f 6e61 6d65 3d67 726f    group_name=gro
-00011e60: 7570 5f6e 616d 6531 2c0a 2020 2020 7374  up_name1,.    st
-00011e70: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00011e80: 5f6e 616d 6532 2c0a 290a 6060 600a 0a54  _name2,.).```..T
-00011e90: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00011ea0: 2063 7265 6174 6573 2061 2070 6572 7369   creates a persi
-00011eb0: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
-00011ec0: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
-00011ed0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00011ee0: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2043  ...```python.# C
-00011ef0: 7265 6174 6520 6120 7065 7273 6973 7465  reate a persiste
-00011f00: 6e74 2073 7472 6561 6d20 7375 6273 6372  nt stream subscr
-00011f10: 6970 7469 6f6e 2066 726f 6d20 6120 7374  iption from a st
-00011f20: 7265 616d 2070 6f73 6974 696f 6e2e 0a67  ream position..g
-00011f30: 726f 7570 5f6e 616d 6532 203d 2066 2267  roup_name2 = f"g
-00011f40: 726f 7570 2d7b 7575 6964 3428 297d 220a  roup-{uuid4()}".
-00011f50: 636c 6965 6e74 2e63 7265 6174 655f 7374  client.create_st
-00011f60: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00011f70: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
-00011f80: 653d 6772 6f75 705f 6e61 6d65 322c 0a20  e=group_name2,. 
-00011f90: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00011fa0: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
-00011fb0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
-00011fc0: 3d32 0a29 0a60 6060 0a0a 5468 6520 6578  =2.).```..The ex
-00011fd0: 616d 706c 6520 6265 6c6f 7720 6372 6561  ample below crea
-00011fe0: 7465 7320 6120 7065 7273 6973 7465 6e74  tes a persistent
-00011ff0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00012000: 7469 6f6e 2066 726f 6d20 7468 6520 656e  tion from the en
-00012010: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-00012020: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
-00012030: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
-00012040: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
-00012050: 7074 696f 6e20 6672 6f6d 2065 6e64 206f  ption from end o
-00012060: 6620 7468 6520 7374 7265 616d 2e0a 6772  f the stream..gr
-00012070: 6f75 705f 6e61 6d65 3320 3d20 6622 6772  oup_name3 = f"gr
-00012080: 6f75 702d 7b75 7569 6434 2829 7d22 0a63  oup-{uuid4()}".c
-00012090: 6c69 656e 742e 6372 6561 7465 5f73 7472  lient.create_str
-000120a0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-000120b0: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
-000120c0: 3d67 726f 7570 5f6e 616d 6533 2c0a 2020  =group_name3,.  
-000120d0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-000120e0: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
-000120f0: 6672 6f6d 5f65 6e64 3d54 7275 650a 290a  from_end=True.).
-00012100: 6060 600a 0a23 2323 2052 6561 6420 7374  ```..### Read st
-00012110: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00012120: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
-00012130: 6465 722a 0a0a 5468 6520 6072 6561 645f  der*..The `read_
-00012140: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
-00012150: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
-00012160: 6e20 6265 2075 7365 6420 746f 2072 6561  n be used to rea
-00012170: 6420 6120 7065 7273 6973 7465 6e74 0a73  d a persistent.s
-00012180: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00012190: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
-000121a0: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
-000121b0: 6420 6172 6775 6d65 6e74 732c 2060 6772  d arguments, `gr
-000121c0: 6f75 705f 6e61 6d65 6020 616e 6420 6073  oup_name` and `s
-000121d0: 7472 6561 6d5f 6e61 6d65 602c 2077 6869  tream_name`, whi
-000121e0: 6368 0a73 686f 756c 6420 6d61 7463 6820  ch.should match 
-000121f0: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
-00012200: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
-00012210: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
-00012220: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-00012230: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
-00012240: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-00012250: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-00012260: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-00012270: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
-00012280: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-00012290: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-000122a0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-000122b0: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
-000122c0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-000122d0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
-000122e0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
-000122f0: 6120 6050 6572 7369 7374 656e 7453 7562  a `PersistentSub
-00012300: 7363 7269 7074 696f 6e60 206f 626a 6563  scription` objec
-00012310: 742c 2077 6869 6368 2069 7320 616e 2069  t, which is an i
-00012320: 7465 7261 746f 720a 6769 7669 6e67 2060  terator.giving `
-00012330: 5265 636f 7264 6564 4576 656e 7460 206f  RecordedEvent` o
-00012340: 626a 6563 7473 2c20 7468 6174 2061 6c73  bjects, that als
-00012350: 6f20 6861 7320 6061 636b 2829 602c 2060  o has `ack()`, `
-00012360: 6e61 636b 2829 6020 616e 6420 6073 746f  nack()` and `sto
-00012370: 7028 2960 0a6d 6574 686f 6473 2e0a 0a60  p()`.methods...`
-00012380: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
-00012390: 7074 696f 6e20 3d20 636c 6965 6e74 2e72  ption = client.r
-000123a0: 6561 645f 7374 7265 616d 5f73 7562 7363  ead_stream_subsc
-000123b0: 7269 7074 696f 6e28 0a20 2020 2067 726f  ription(.    gro
-000123c0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-000123d0: 6d65 312c 0a20 2020 2073 7472 6561 6d5f  me1,.    stream_
-000123e0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-000123f0: 322c 0a29 0a60 6060 0a0a 5468 6520 6578  2,.).```..The ex
-00012400: 616d 706c 6520 6265 6c6f 7720 6974 6572  ample below iter
-00012410: 6174 6573 206f 7665 7220 7468 6520 7375  ates over the su
-00012420: 6273 6372 6970 7469 6f6e 206f 626a 6563  bscription objec
-00012430: 742c 2061 6e64 2063 616c 6c73 2060 6163  t, and calls `ac
-00012440: 6b28 2960 2e0a 5468 6520 666f 7220 6c6f  k()`..The for lo
-00012450: 6f70 2062 7265 616b 7320 7768 656e 2077  op breaks when w
-00012460: 6520 6861 7665 2072 6563 6569 7665 6420  e have received 
-00012470: 7468 6520 6c61 7374 2065 7665 6e74 2069  the last event i
-00012480: 6e20 7468 6520 7374 7265 616d 2c20 736f  n the stream, so
-00012490: 0a74 6861 7420 7765 2063 616e 2066 696e  .that we can fin
-000124a0: 6973 6820 7468 6520 6578 616d 706c 6573  ish the examples
-000124b0: 2069 6e20 7468 6973 2064 6f63 756d 656e   in this documen
-000124c0: 7461 7469 6f6e 2e0a 0a60 6060 7079 7468  tation...```pyth
-000124d0: 6f6e 0a65 7665 6e74 7320 3d20 5b5d 0a66  on.events = [].f
-000124e0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
-000124f0: 6372 6970 7469 6f6e 3a0a 2020 2020 6576  cription:.    ev
-00012500: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
-00012510: 7429 0a0a 2020 2020 2320 4163 6b6e 6f77  t)..    # Acknow
-00012520: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
-00012530: 6564 2065 7665 6e74 2e0a 2020 2020 7375  ed event..    su
-00012540: 6273 6372 6970 7469 6f6e 2e61 636b 2865  bscription.ack(e
-00012550: 7665 6e74 5f69 643d 6576 656e 742e 6964  vent_id=event.id
-00012560: 290a 0a20 2020 2023 2053 746f 7020 7768  )..    # Stop wh
-00012570: 656e 2027 6576 656e 7431 3127 2068 6173  en 'event11' has
-00012580: 2062 6565 6e20 7265 6365 6976 6564 2e0a   been received..
-00012590: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-000125a0: 3d3d 2065 7665 6e74 3131 2e69 643a 0a20  == event11.id:. 
-000125b0: 2020 2020 2020 2073 7562 7363 7269 7074         subscript
-000125c0: 696f 6e2e 7374 6f70 2829 0a60 6060 0a0a  ion.stop().```..
-000125d0: 5765 2063 616e 2063 6865 636b 2077 6520  We can check we 
-000125e0: 7265 6365 6976 6564 2061 6c6c 2074 6865  received all the
-000125f0: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
-00012600: 6520 6170 7065 6e64 6564 2074 6f20 6073  e appended to `s
-00012610: 7472 6561 6d5f 6e61 6d65 3260 0a69 6e20  tream_name2`.in 
-00012620: 7468 6520 6578 616d 706c 6573 2061 626f  the examples abo
-00012630: 7665 2e0a 0a60 6060 7079 7468 6f6e 0a61  ve...```python.a
-00012640: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00012650: 2920 3d3d 2034 0a61 7373 6572 7420 6576  ) == 4.assert ev
-00012660: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
-00012670: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-00012680: 6d65 320a 6173 7365 7274 2065 7665 6e74  me2.assert event
-00012690: 735b 305d 2e69 6420 3d3d 2065 7665 6e74  s[0].id == event
-000126a0: 342e 6964 0a61 7373 6572 7420 6576 656e  4.id.assert even
-000126b0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
-000126c0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-000126d0: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
-000126e0: 315d 2e69 6420 3d3d 2065 7665 6e74 352e  1].id == event5.
-000126f0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
-00012700: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
-00012710: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-00012720: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00012730: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-00012740: 0a61 7373 6572 7420 6576 656e 7473 5b33  .assert events[3
-00012750: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00012760: 2073 7472 6561 6d5f 6e61 6d65 320a 6173   stream_name2.as
-00012770: 7365 7274 2065 7665 6e74 735b 335d 2e69  sert events[3].i
-00012780: 6420 3d3d 2065 7665 6e74 3131 2e69 640a  d == event11.id.
-00012790: 6060 600a 0a23 2323 2047 6574 2073 7472  ```..### Get str
-000127a0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-000127b0: 2069 6e66 6f0a 0a2a 7265 7175 6972 6573   info..*requires
-000127c0: 206c 6561 6465 722a 0a0a 5468 6520 6067   leader*..The `g
-000127d0: 6574 5f73 7472 6561 6d5f 7375 6273 6372  et_stream_subscr
-000127e0: 6970 7469 6f6e 5f69 6e66 6f28 2960 206d  iption_info()` m
-000127f0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00012800: 6420 746f 2067 6574 2069 6e66 6f72 6d61  d to get informa
-00012810: 7469 6f6e 2066 6f72 2061 0a70 6572 7369  tion for a.persi
-00012820: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-00012830: 6f6e 2066 6f72 2061 2073 7472 6561 6d2e  on for a stream.
-00012840: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
-00012850: 7320 7477 6f20 7265 7175 6972 6564 2061  s two required a
-00012860: 7267 756d 656e 7473 2c20 6067 726f 7570  rguments, `group
-00012870: 5f6e 616d 6560 2061 6e64 2060 7374 7265  _name` and `stre
-00012880: 616d 5f6e 616d 6560 2c20 7768 6963 680a  am_name`, which.
-00012890: 7368 6f75 6c64 206d 6174 6368 2074 6865  should match the
-000128a0: 2076 616c 7565 7320 6f66 2061 7267 756d   values of argum
-000128b0: 656e 7473 2075 7365 6420 7768 656e 2063  ents used when c
-000128c0: 616c 6c69 6e67 2060 6372 6561 7465 5f73  alling `create_s
-000128d0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-000128e0: 6f6e 2829 602e 0a0a 5468 6973 206d 6574  on()`...This met
-000128f0: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-00012900: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00012910: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-00012920: 6861 740a 6973 2065 7870 6563 7465 6420  hat.is expected 
-00012930: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
-00012940: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
-00012950: 7473 2061 2064 6561 646c 696e 650a 666f  ts a deadline.fo
-00012960: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00012970: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00012980: 7261 7469 6f6e 2e0a 0a60 6060 7079 7468  ration...```pyth
-00012990: 6f6e 0a73 7562 7363 7269 7074 696f 6e5f  on.subscription_
-000129a0: 696e 666f 203d 2063 6c69 656e 742e 6765  info = client.ge
-000129b0: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
-000129c0: 7074 696f 6e5f 696e 666f 280a 2020 2020  ption_info(.    
-000129d0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-000129e0: 5f6e 616d 6531 2c0a 2020 2020 7374 7265  _name1,.    stre
-000129f0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00012a00: 616d 6532 2c0a 290a 6060 600a 0a54 6865  ame2,.).```..The
-00012a10: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
-00012a20: 6973 2061 2060 5375 6273 6372 6970 7469  is a `Subscripti
-00012a30: 6f6e 496e 666f 6020 6f62 6a65 6374 2e0a  onInfo` object..
-00012a40: 0a23 2323 204c 6973 7420 7374 7265 616d  .### List stream
-00012a50: 2073 7562 7363 7269 7074 696f 6e73 0a0a   subscriptions..
-00012a60: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
-00012a70: 2a0a 0a54 6865 2060 6c69 7374 5f73 7472  *..The `list_str
-00012a80: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00012a90: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
-00012aa0: 6265 2075 7365 6420 746f 2067 6574 2069  be used to get i
-00012ab0: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2061  nformation for a
-00012ac0: 6c6c 0a74 6865 2070 6572 7369 7374 656e  ll.the persisten
-00012ad0: 7420 7375 6273 6372 6970 7469 6f6e 7320  t subscriptions 
-00012ae0: 666f 7220 6120 7374 7265 616d 2e0a 0a54  for a stream...T
-00012af0: 6869 7320 6d65 7468 6f64 2068 6173 206f  his method has o
-00012b00: 6e65 2072 6571 7569 7265 6420 6172 6775  ne required argu
-00012b10: 6d65 6e74 2c20 6073 7472 6561 6d5f 6e61  ment, `stream_na
-00012b20: 6d65 602e 0a0a 5468 6973 206d 6574 686f  me`...This metho
-00012b30: 6420 616c 736f 2074 616b 6573 2061 6e20  d also takes an 
-00012b40: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-00012b50: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
-00012b60: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
-00012b70: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
-00012b80: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
-00012b90: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
-00012ba0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-00012bb0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-00012bc0: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
-00012bd0: 0a73 7562 7363 7269 7074 696f 6e73 203d  .subscriptions =
-00012be0: 2063 6c69 656e 742e 6c69 7374 5f73 7472   client.list_str
-00012bf0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00012c00: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-00012c10: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-00012c20: 0a29 0a60 6060 0a0a 5468 6520 7265 7475  .).```..The retu
-00012c30: 726e 6564 2076 616c 7565 2069 7320 6120  rned value is a 
-00012c40: 6c69 7374 206f 6620 6053 7562 7363 7269  list of `Subscri
-00012c50: 7074 696f 6e49 6e66 6f60 206f 626a 6563  ptionInfo` objec
-00012c60: 7473 2e0a 0a23 2323 2055 7064 6174 6520  ts...### Update 
-00012c70: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00012c80: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
-00012c90: 6561 6465 722a 0a0a 5468 6520 6d65 7468  eader*..The meth
-00012ca0: 6f64 2060 7570 6461 7465 5f73 7472 6561  od `update_strea
-00012cb0: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
-00012cc0: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
-00012cd0: 2075 7064 6174 6520 610a 7065 7273 6973   update a.persis
-00012ce0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00012cf0: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
-00012d00: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
-00012d10: 6573 2061 2072 6571 7569 7265 6420 6067  es a required `g
-00012d20: 726f 7570 5f6e 616d 6560 2061 7267 756d  roup_name` argum
-00012d30: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
-00012d40: 650a 6e61 6d65 206f 6620 6120 2267 726f  e.name of a "gro
-00012d50: 7570 2220 6f66 2063 6f6e 7375 6d65 7273  up" of consumers
-00012d60: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
-00012d70: 7469 6f6e 2c20 616e 6420 6120 7265 7175  tion, and a requ
-00012d80: 6972 6564 0a60 7374 7265 616d 5f6e 616d  ired.`stream_nam
-00012d90: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
-00012da0: 6368 2069 7320 7468 6520 6e61 6d65 206f  ch is the name o
-00012db0: 6620 6120 7374 7265 616d 2e0a 0a54 6869  f a stream...Thi
-00012dc0: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-00012dd0: 6b65 7320 7468 7265 6520 6f70 7469 6f6e  kes three option
-00012de0: 616c 2061 7267 756d 656e 7473 2c20 6066  al arguments, `f
-00012df0: 726f 6d5f 656e 6460 2c20 6073 7472 6561  rom_end`, `strea
-00012e00: 6d5f 706f 7369 7469 6f6e 602c 0a61 6e64  m_position`,.and
-00012e10: 2060 7469 6d65 6f75 7460 2e0a 0a54 6865   `timeout`...The
-00012e20: 206f 7074 696f 6e61 6c20 6066 726f 6d5f   optional `from_
-00012e30: 656e 6460 2061 7267 756d 656e 7420 6361  end` argument ca
-00012e40: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
-00012e50: 6369 6679 2074 6861 7420 7468 6520 6772  cify that the gr
-00012e60: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00012e70: 0a6f 6620 7468 6520 7375 6273 6372 6970  .of the subscrip
-00012e80: 7469 6f6e 2073 686f 756c 6420 6f6e 6c79  tion should only
-00012e90: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-00012ea0: 7468 6174 2077 6572 6520 7265 636f 7264  that were record
-00012eb0: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-00012ec0: 7363 7269 7074 696f 6e0a 7761 7320 7570  scription.was up
-00012ed0: 6461 7465 642e 0a0a 416c 7465 726e 6174  dated...Alternat
-00012ee0: 6976 656c 792c 2074 6865 206f 7074 696f  ively, the optio
-00012ef0: 6e61 6c20 6073 7472 6561 6d5f 706f 7369  nal `stream_posi
-00012f00: 7469 6f6e 6020 6172 6775 6d65 6e74 2063  tion` argument c
-00012f10: 616e 2062 6520 7573 6564 2074 6f20 7370  an be used to sp
-00012f20: 6563 6966 7920 6120 7374 7265 616d 0a70  ecify a stream.p
-00012f30: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
-00012f40: 6368 2063 6f6d 6d69 7420 706f 7369 7469  ch commit positi
-00012f50: 6f6e 2074 6865 2067 726f 7570 206f 6620  on the group of 
-00012f60: 636f 6e73 756d 6572 7320 6f66 2074 6865  consumers of the
-00012f70: 2073 7562 7363 7269 7074 696f 6e20 7368   subscription sh
-00012f80: 6f75 6c64 0a72 6563 6569 7665 2065 7665  ould.receive eve
-00012f90: 6e74 732e 2050 6c65 6173 6520 6e6f 7465  nts. Please note
-00012fa0: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
-00012fb0: 7665 6e74 2061 7420 7468 6520 7370 6563  vent at the spec
-00012fc0: 6966 6965 6420 7374 7265 616d 2070 6f73  ified stream pos
-00012fd0: 6974 696f 6e20 6d69 6768 740a 6265 2069  ition might.be i
-00012fe0: 6e63 6c75 6465 6420 696e 2074 6865 2072  ncluded in the r
-00012ff0: 6563 6f72 6465 6420 6576 656e 7473 2072  ecorded events r
-00013000: 6563 6569 7665 6420 6279 2074 6865 2067  eceived by the g
-00013010: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-00013020: 732e 0a0a 4966 206e 6569 7468 6572 2060  s...If neither `
-00013030: 6672 6f6d 5f65 6e64 6020 6f72 2060 636f  from_end` or `co
-00013040: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
-00013050: 7265 2073 7065 6369 6669 6564 2c20 7468  re specified, th
-00013060: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
-00013070: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
-00013080: 6372 6970 7469 6f6e 2077 696c 6c20 706f  cription will po
-00013090: 7465 6e74 6961 6c6c 7920 7265 6365 6976  tentially receiv
-000130a0: 6520 616c 6c20 7265 636f 7264 6564 2065  e all recorded e
-000130b0: 7665 6e74 7320 696e 2074 6865 2073 7472  vents in the str
-000130c0: 6561 6d2e 0a0a 506c 6561 7365 206e 6f74  eam...Please not
-000130d0: 652c 2074 6865 2063 6f6e 7375 6d65 7220  e, the consumer 
-000130e0: 7374 7261 7465 6779 2063 616e 6e6f 7420  strategy cannot 
-000130f0: 6265 2061 646a 7573 7465 642e 0a0a 5468  be adjusted...Th
-00013100: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
-00013110: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
-00013120: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00013130: 6020 7768 6963 6820 7365 7473 2061 0a64  ` which sets a.d
-00013140: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-00013150: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00013160: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00013170: 2e0a 0a54 6865 206d 6574 686f 6420 6075  ...The method `u
-00013180: 7064 6174 655f 7374 7265 616d 5f73 7562  pdate_stream_sub
-00013190: 7363 7269 7074 696f 6e28 2960 2064 6f65  scription()` doe
-000131a0: 7320 6e6f 7420 7265 7475 726e 2061 2076  s not return a v
-000131b0: 616c 7565 2e0a 0a49 6e20 7468 6520 6578  alue...In the ex
-000131c0: 616d 706c 6520 6265 6c6f 772c 2061 2070  ample below, a p
-000131d0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-000131e0: 6970 7469 6f6e 2066 6f72 2061 2073 7472  iption for a str
-000131f0: 6561 6d20 6973 2075 7064 6174 6564 2074  eam is updated t
-00013200: 6f20 7275 6e20 6672 6f6d 2074 6865 0a65  o run from the.e
-00013210: 6e64 206f 6620 7468 6520 7374 7265 616d  nd of the stream
-00013220: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2043  ...```python.# C
-00013230: 7265 6174 6520 6120 7065 7273 6973 7465  reate a persiste
-00013240: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
-00013250: 0a63 6c69 656e 742e 7570 6461 7465 5f73  .client.update_s
-00013260: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-00013270: 6f6e 280a 2020 2020 6772 6f75 705f 6e61  on(.    group_na
-00013280: 6d65 3d67 726f 7570 5f6e 616d 6531 2c0a  me=group_name1,.
-00013290: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-000132a0: 7374 7265 616d 5f6e 616d 6532 2c0a 2020  stream_name2,.  
-000132b0: 2020 6672 6f6d 5f65 6e64 3d54 7275 652c    from_end=True,
-000132c0: 0a29 0a60 6060 0a0a 2323 2320 4465 6c65  .).```..### Dele
-000132d0: 7465 2073 7472 6561 6d20 7375 6273 6372  te stream subscr
-000132e0: 6970 7469 6f6e 0a0a 2a72 6571 7569 7265  iption..*require
-000132f0: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
-00013300: 6465 6c65 7465 5f73 7472 6561 6d5f 7375  delete_stream_su
-00013310: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
-00013320: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00013330: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
-00013340: 7369 7374 656e 740a 7375 6273 6372 6970  sistent.subscrip
-00013350: 7469 6f6e 2066 6f72 2061 2073 7472 6561  tion for a strea
-00013360: 6d2e 0a0a 5468 6973 206d 6574 686f 6420  m...This method 
-00013370: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-00013380: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-00013390: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-000133a0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
-000133b0: 680a 7368 6f75 6c64 206d 6174 6368 2074  h.should match t
-000133c0: 6865 2076 616c 7565 7320 6f66 2061 7267  he values of arg
-000133d0: 756d 656e 7473 2075 7365 6420 7768 656e  uments used when
-000133e0: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
-000133f0: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
-00013400: 7469 6f6e 2829 602e 0a0a 5468 6973 206d  tion()`...This m
-00013410: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
-00013420: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-00013430: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-00013440: 2074 6861 740a 6973 2065 7870 6563 7465   that.is expecte
-00013450: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
-00013460: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
-00013470: 7365 7473 2061 2064 6561 646c 696e 650a  sets a deadline.
-00013480: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00013490: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-000134a0: 7065 7261 7469 6f6e 2e0a 0a60 6060 7079  peration...```py
-000134b0: 7468 6f6e 0a63 6c69 656e 742e 6465 6c65  thon.client.dele
-000134c0: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
-000134d0: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
-000134e0: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-000134f0: 6531 2c0a 2020 2020 7374 7265 616d 5f6e  e1,.    stream_n
-00013500: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00013510: 2c0a 290a 6060 600a 0a23 2323 2050 6572  ,.).```..### Per
-00013520: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00013530: 7469 6f6e 2063 6f6e 7375 6d65 720a 0a54  tion consumer..T
-00013540: 6865 2072 6561 6469 6e67 206f 6620 6120  he reading of a 
-00013550: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00013560: 7269 7074 696f 6e20 6361 6e20 6265 2065  ription can be e
-00013570: 6e63 6170 7375 6c61 7465 6420 696e 2061  ncapsulated in a
-00013580: 2022 636f 6e73 756d 6572 2220 7468 6174   "consumer" that
-00013590: 2063 616c 6c73 0a61 2022 706f 6c69 6379   calls.a "policy
-000135a0: 2220 6675 6e63 7469 6f6e 2077 6865 6e20  " function when 
-000135b0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
-000135c0: 2069 7320 7265 6365 6976 6564 2061 6e64   is received and
-000135d0: 2074 6865 6e20 6175 746f 6d61 7469 6361   then automatica
-000135e0: 6c6c 7920 6361 6c6c 730a 6061 636b 2829  lly calls.`ack()
-000135f0: 6020 6966 2074 6865 2070 6f6c 6963 7920  ` if the policy 
-00013600: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
-00013610: 206e 6f72 6d61 6c6c 792c 2061 6e64 2060   normally, and `
-00013620: 6e61 636b 2829 6020 6966 2069 7420 7261  nack()` if it ra
-00013630: 6973 6573 2061 6e20 6578 6365 7074 696f  ises an exceptio
-00013640: 6e2c 0a70 6572 6861 7073 2072 6574 7279  n,.perhaps retry
-00013650: 696e 6720 7468 6520 6576 656e 7420 666f  ing the event fo
-00013660: 7220 6120 6365 7274 6169 6e20 6e75 6d62  r a certain numb
-00013670: 6572 206f 6620 7469 6d65 732c 2061 6e64  er of times, and
-00013680: 2074 6865 6e20 7061 726b 696e 6720 7468   then parking th
-00013690: 6520 6576 656e 742e 0a0a 5468 6520 7369  e event...The si
-000136a0: 6d70 6c65 2065 7861 6d70 6c65 2062 656c  mple example bel
-000136b0: 6f77 2073 686f 7773 2068 6f77 2074 6869  ow shows how thi
-000136c0: 7320 6d69 6768 7420 6265 2064 6f6e 652e  s might be done.
-000136d0: 2057 6520 6361 6e20 7365 6520 7468 6174   We can see that
-000136e0: 2027 6576 656e 7431 3127 2069 730a 6163   'event11' is.ac
-000136f0: 6b6e 6f77 6c65 6467 6564 2062 6566 6f72  knowledged befor
-00013700: 6520 2765 7665 6e74 3527 2069 7320 6669  e 'event5' is fi
-00013710: 6e61 6c6c 7920 7061 726b 6564 2e0a 0a0a  nally parked....
-00013720: 6060 6070 7974 686f 6e0a 6163 6b65 645f  ```python.acked_
-00013730: 6576 656e 7473 203d 207b 7d0a 6e61 636b  events = {}.nack
-00013740: 6564 5f65 7665 6e74 7320 3d20 7b7d 0a0a  ed_events = {}..
-00013750: 0a63 6c61 7373 2045 7861 6d70 6c65 436f  .class ExampleCo
-00013760: 6e73 756d 6572 3a0a 2020 2020 6465 6620  nsumer:.    def 
-00013770: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
-00013780: 7562 7363 7269 7074 696f 6e2c 206d 6178  ubscription, max
-00013790: 5f72 6574 7269 6573 2c20 6669 6e61 6c5f  _retries, final_
-000137a0: 6163 7469 6f6e 293a 0a20 2020 2020 2020  action):.       
-000137b0: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
-000137c0: 6f6e 203d 2073 7562 7363 7269 7074 696f  on = subscriptio
-000137d0: 6e0a 2020 2020 2020 2020 7365 6c66 2e6d  n.        self.m
-000137e0: 6178 5f72 6574 7269 6573 203d 206d 6178  ax_retries = max
-000137f0: 5f72 6574 7269 6573 0a20 2020 2020 2020  _retries.       
-00013800: 2073 656c 662e 6669 6e61 6c5f 6163 7469   self.final_acti
-00013810: 6f6e 203d 2066 696e 616c 5f61 6374 696f  on = final_actio
-00013820: 6e0a 2020 2020 2020 2020 7365 6c66 2e65  n.        self.e
-00013830: 7272 6f72 203d 204e 6f6e 650a 0a20 2020  rror = None..   
-00013840: 2064 6566 2072 756e 2873 656c 6629 3a0a   def run(self):.
-00013850: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00013860: 2020 2020 2020 2020 2066 6f72 2065 7665           for eve
-00013870: 6e74 2069 6e20 7365 6c66 2e73 7562 7363  nt in self.subsc
-00013880: 7269 7074 696f 6e3a 0a20 2020 2020 2020  ription:.       
-00013890: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138b0: 2020 7365 6c66 2e70 6f6c 6963 7928 6576    self.policy(ev
-000138c0: 656e 7429 0a20 2020 2020 2020 2020 2020  ent).           
-000138d0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-000138e0: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
-000138f0: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
-00013900: 656e 742e 7265 7472 795f 636f 756e 7420  ent.retry_count 
-00013910: 3c20 7365 6c66 2e6d 6178 5f72 6574 7269  < self.max_retri
-00013920: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00013930: 2020 2020 2020 2020 2020 2020 6163 7469              acti
-00013940: 6f6e 203d 2022 7265 7472 7922 0a20 2020  on = "retry".   
-00013950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013960: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00013970: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00013980: 6374 696f 6e20 3d20 7365 6c66 2e66 696e  ction = self.fin
-00013990: 616c 5f61 6374 696f 6e0a 2020 2020 2020  al_action.      
-000139a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000139b0: 6c66 2e73 7562 7363 7269 7074 696f 6e2e  lf.subscription.
-000139c0: 6e61 636b 2865 7665 6e74 2e69 642c 2061  nack(event.id, a
-000139d0: 6374 696f 6e3d 6163 7469 6f6e 290a 2020  ction=action).  
-000139e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139f0: 2020 7365 6c66 2e61 6674 6572 5f6e 6163    self.after_nac
-00013a00: 6b28 6576 656e 742c 2061 6374 696f 6e29  k(event, action)
-00013a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00013a30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00013a40: 7375 6273 6372 6970 7469 6f6e 2e61 636b  subscription.ack
-00013a50: 2865 7665 6e74 2e69 6429 0a20 2020 2020  (event.id).     
-00013a60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00013a70: 656c 662e 6166 7465 725f 6163 6b28 6576  elf.after_ack(ev
-00013a80: 656e 7429 0a20 2020 2020 2020 2065 7863  ent).        exc
-00013a90: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
-00013aa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00013ab0: 7375 6273 6372 6970 7469 6f6e 2e73 746f  subscription.sto
-00013ac0: 7028 290a 2020 2020 2020 2020 2020 2020  p().            
-00013ad0: 7261 6973 650a 0a20 2020 2064 6566 2073  raise..    def s
-00013ae0: 746f 7028 7365 6c66 293a 0a20 2020 2020  top(self):.     
-00013af0: 2020 2073 656c 662e 7375 6273 6372 6970     self.subscrip
-00013b00: 7469 6f6e 2e73 746f 7028 290a 0a20 2020  tion.stop()..   
-00013b10: 2064 6566 2070 6f6c 6963 7928 7365 6c66   def policy(self
-00013b20: 2c20 6576 656e 7429 3a0a 2020 2020 2020  , event):.      
-00013b30: 2020 2320 5261 6973 6520 616e 2065 7863    # Raise an exc
-00013b40: 6570 7469 6f6e 2077 6865 6e20 7765 2073  eption when we s
-00013b50: 6565 2022 6576 656e 7435 222e 0a20 2020  ee "event5"..   
-00013b60: 2020 2020 2069 6620 6576 656e 742e 6964       if event.id
-00013b70: 203d 3d20 6576 656e 7435 2e69 643a 0a20   == event5.id:. 
-00013b80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00013b90: 2045 7863 6570 7469 6f6e 2829 0a0a 2020   Exception()..  
-00013ba0: 2020 6465 6620 6166 7465 725f 6163 6b28    def after_ack(
-00013bb0: 7365 6c66 2c20 6576 656e 7429 3a0a 2020  self, event):.  
-00013bc0: 2020 2020 2020 2320 5472 6163 6b20 7265        # Track re
-00013bd0: 7472 7920 636f 756e 7420 6f66 2061 636b  try count of ack
-00013be0: 6564 2065 7665 6e74 732e 0a20 2020 2020  ed events..     
-00013bf0: 2020 2061 636b 6564 5f65 7665 6e74 735b     acked_events[
-00013c00: 6576 656e 742e 6964 5d20 3d20 6576 656e  event.id] = even
-00013c10: 742e 7265 7472 795f 636f 756e 740a 0a20  t.retry_count.. 
-00013c20: 2020 2064 6566 2061 6674 6572 5f6e 6163     def after_nac
-00013c30: 6b28 7365 6c66 2c20 6576 656e 742c 2061  k(self, event, a
-00013c40: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
-00013c50: 2320 5472 6163 6b20 7265 7472 7920 636f  # Track retry co
-00013c60: 756e 7420 6f66 206e 6163 6b65 6420 6576  unt of nacked ev
-00013c70: 656e 7473 2e0a 2020 2020 2020 2020 6e61  ents..        na
-00013c80: 636b 6564 5f65 7665 6e74 735b 6576 656e  cked_events[even
-00013c90: 742e 6964 5d20 3d20 6576 656e 742e 7265  t.id] = event.re
-00013ca0: 7472 795f 636f 756e 740a 0a20 2020 2020  try_count..     
-00013cb0: 2020 2069 6620 6163 7469 6f6e 203d 3d20     if action == 
-00013cc0: 7365 6c66 2e66 696e 616c 5f61 6374 696f  self.final_actio
-00013cd0: 6e3a 0a20 2020 2020 2020 2020 2020 2023  n:.            #
-00013ce0: 2053 746f 7020 7468 6520 636f 6e73 756d   Stop the consum
-00013cf0: 6572 2c20 736f 2077 6520 6361 6e20 636f  er, so we can co
-00013d00: 6e74 696e 7565 2077 6974 6820 7468 6520  ntinue with the 
-00013d10: 6578 616d 706c 6573 2e0a 2020 2020 2020  examples..      
-00013d20: 2020 2020 2020 7365 6c66 2e73 746f 7028        self.stop(
-00013d30: 290a 0a0a 2320 4372 6561 7465 2073 7562  )...# Create sub
-00013d40: 7363 7269 7074 696f 6e2e 0a67 726f 7570  scription..group
-00013d50: 5f6e 616d 6520 3d20 6622 6772 6f75 702d  _name = f"group-
-00013d60: 7b75 7569 6434 2829 7d22 0a63 6c69 656e  {uuid4()}".clien
-00013d70: 742e 6372 6561 7465 5f73 7562 7363 7269  t.create_subscri
-00013d80: 7074 696f 6e28 6772 6f75 705f 6e61 6d65  ption(group_name
-00013d90: 2c20 636f 6d6d 6974 5f70 6f73 6974 696f  , commit_positio
-00013da0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
-00013db0: 6e31 290a 0a23 2052 6561 6420 7375 6273  n1)..# Read subs
-00013dc0: 6372 6970 7469 6f6e 2e0a 7375 6273 6372  cription..subscr
-00013dd0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
-00013de0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-00013df0: 6e28 6772 6f75 705f 6e61 6d65 290a 0a23  n(group_name)..#
-00013e00: 2043 6f6e 7374 7275 6374 2063 6f6e 7375   Construct consu
-00013e10: 6d65 722e 0a63 6f6e 7375 6d65 7220 3d20  mer..consumer = 
-00013e20: 4578 616d 706c 6543 6f6e 7375 6d65 7228  ExampleConsumer(
-00013e30: 0a20 2020 2073 7562 7363 7269 7074 696f  .    subscriptio
-00013e40: 6e3d 7375 6273 6372 6970 7469 6f6e 2c0a  n=subscription,.
-00013e50: 2020 2020 6d61 785f 7265 7472 6965 733d      max_retries=
-00013e60: 352c 0a20 2020 2066 696e 616c 5f61 6374  5,.    final_act
-00013e70: 696f 6e3d 2270 6172 6b22 2c0a 290a 0a23  ion="park",.)..#
-00013e80: 2052 756e 2063 6f6e 7375 6d65 722e 0a63   Run consumer..c
-00013e90: 6f6e 7375 6d65 722e 7275 6e28 290a 0a23  onsumer.run()..#
-00013ea0: 2043 6865 636b 2027 6576 656e 7431 3127   Check 'event11'
-00013eb0: 2077 6173 2061 636b 6564 2061 6e64 206e   was acked and n
-00013ec0: 6576 6572 2072 6574 7269 6564 2e0a 6173  ever retried..as
-00013ed0: 7365 7274 2061 636b 6564 5f65 7665 6e74  sert acked_event
-00013ee0: 735b 6576 656e 7431 312e 6964 5d20 3d3d  s[event11.id] ==
-00013ef0: 2030 0a61 7373 6572 7420 6576 656e 7431   0.assert event1
-00013f00: 312e 6964 206e 6f74 2069 6e20 6e61 636b  1.id not in nack
-00013f10: 6564 5f65 7665 6e74 730a 0a23 2043 6865  ed_events..# Che
-00013f20: 636b 2027 6576 656e 7435 2720 7761 7320  ck 'event5' was 
-00013f30: 7265 7472 6965 6420 6669 7665 2074 696d  retried five tim
-00013f40: 6573 2061 6e64 206e 6576 6572 2061 636b  es and never ack
-00013f50: 6564 2e0a 6173 7365 7274 206e 6163 6b65  ed..assert nacke
-00013f60: 645f 6576 656e 7473 5b65 7665 6e74 352e  d_events[event5.
-00013f70: 6964 5d20 3d3d 2035 0a61 7373 6572 7420  id] == 5.assert 
-00013f80: 6576 656e 7435 2e69 6420 6e6f 7420 696e  event5.id not in
-00013f90: 2061 636b 6564 5f65 7665 6e74 730a 6060   acked_events.``
-00013fa0: 600a 0a23 2320 436f 6e6e 6563 7469 6f6e  `..## Connection
-00013fb0: 0a0a 2323 2320 5265 636f 6e6e 6563 740a  ..### Reconnect.
-00013fc0: 0a54 6865 2060 7265 636f 6e6e 6563 7428  .The `reconnect(
-00013fd0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-00013fe0: 2075 7365 6420 746f 206d 616e 7561 6c6c   used to manuall
-00013ff0: 7920 7265 636f 6e6e 6563 7420 7468 6520  y reconnect the 
-00014000: 636c 6965 6e74 2074 6f20 610a 7375 6974  client to a.suit
-00014010: 6162 6c65 2045 7665 6e74 5374 6f72 6544  able EventStoreD
-00014020: 4220 6e6f 6465 2e20 5468 6973 206d 6574  B node. This met
-00014030: 686f 6420 7573 6573 2074 6865 2073 616d  hod uses the sam
-00014040: 6520 726f 7574 696e 6520 666f 7220 7265  e routine for re
-00014050: 6164 696e 6720 7468 650a 636c 7573 7465  ading the.cluste
-00014060: 7220 6e6f 6465 2073 7461 7465 7320 616e  r node states an
-00014070: 6420 7468 656e 2063 6f6e 6e65 6374 696e  d then connectin
-00014080: 6720 746f 2061 2073 7569 7461 626c 6520  g to a suitable 
-00014090: 6e6f 6465 2061 6363 6f72 6469 6e67 2074  node according t
-000140a0: 6f20 7468 650a 636c 6965 6e74 2773 206e  o the.client's n
-000140b0: 6f64 6520 7072 6566 6572 656e 6365 2074  ode preference t
-000140c0: 6861 7420 6973 2073 7065 6369 6669 6564  hat is specified
-000140d0: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
-000140e0: 6f6e 2073 7472 696e 6720 5552 4920 7768  on string URI wh
-000140f0: 656e 0a74 6865 2063 6c69 656e 7420 6973  en.the client is
-00014100: 2063 6f6e 7374 7275 6374 6564 2e20 5468   constructed. Th
-00014110: 6973 206d 6574 686f 6420 6973 2074 6872  is method is thr
-00014120: 6561 642d 7361 6665 2c20 616e 6420 6974  ead-safe, and it
-00014130: 2069 7320 2263 6f6e 7365 7276 6174 6976   is "conservativ
-00014140: 6522 0a69 6e20 7468 6174 2c20 7768 656e  e".in that, when
-00014150: 2069 7420 6973 2063 616c 6c65 6420 6279   it is called by
-00014160: 2073 6576 6572 616c 2074 6872 6561 6473   several threads
-00014170: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
-00014180: 652c 206f 6e6c 7920 6f6e 650a 7265 636f  e, only one.reco
-00014190: 6e6e 6563 7469 6f6e 2077 696c 6c20 6f63  nnection will oc
-000141a0: 6375 722e 2043 6f6e 6375 7272 656e 7420  cur. Concurrent 
-000141b0: 6174 7465 6d70 7473 2074 6f20 7265 636f  attempts to reco
-000141c0: 6e6e 6563 7420 7769 6c6c 2062 6c6f 636b  nnect will block
-000141d0: 2075 6e74 696c 0a74 6865 2063 6c69 656e   until.the clien
-000141e0: 7420 6861 7320 7265 636f 6e6e 6563 7465  t has reconnecte
-000141f0: 6420 7375 6363 6573 7366 756c 6c79 2c20  d successfully, 
-00014200: 616e 6420 7468 656e 2074 6865 7920 7769  and then they wi
-00014210: 6c6c 2061 6c6c 2072 6574 7572 6e20 6e6f  ll all return no
-00014220: 726d 616c 6c79 2e0a 0a60 6060 7079 7468  rmally...```pyth
-00014230: 6f6e 0a63 6c69 656e 742e 7265 636f 6e6e  on.client.reconn
-00014240: 6563 7428 290a 6060 600a 0a41 6e20 6578  ect().```..An ex
-00014250: 616d 706c 6520 6f66 2077 6865 6e20 6974  ample of when it
-00014260: 206d 6967 6874 2062 6520 6465 7369 7261   might be desira
-00014270: 626c 6520 746f 2072 6563 6f6e 6e65 6374  ble to reconnect
-00014280: 206d 616e 7561 6c6c 7920 6973 2077 6865   manually is whe
-00014290: 6e20 2866 6f72 2070 6572 666f 726d 616e  n (for performan
-000142a0: 6365 0a72 6561 736f 6e73 2920 7468 6520  ce.reasons) the 
-000142b0: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
-000142c0: 6566 6572 656e 6365 2069 7320 746f 2062  eference is to b
-000142d0: 6520 636f 6e6e 6563 7465 6420 746f 2061  e connected to a
-000142e0: 2066 6f6c 6c6f 7765 7220 6e6f 6465 2069   follower node i
-000142f0: 6e20 7468 650a 636c 7573 7465 722c 2061  n the.cluster, a
-00014300: 6e64 2c20 6166 7465 7220 6120 636c 7573  nd, after a clus
-00014310: 7465 7220 6c65 6164 6572 2065 6c65 6374  ter leader elect
-00014320: 696f 6e2c 2074 6865 2066 6f6c 6c6f 7765  ion, the followe
-00014330: 7220 6265 636f 6d65 7320 7468 6520 6c65  r becomes the le
-00014340: 6164 6572 2e0a 5265 636f 6e6e 6563 7469  ader..Reconnecti
-00014350: 6e67 2074 6f20 6120 666f 6c6c 6f77 6572  ng to a follower
-00014360: 206e 6f64 6520 696e 2074 6869 7320 6361   node in this ca
-00014370: 7365 2069 7320 6375 7272 656e 746c 7920  se is currently 
-00014380: 6265 796f 6e64 2074 6865 2063 6170 6162  beyond the capab
-00014390: 696c 6974 6965 7320 6f66 0a74 6869 7320  ilities of.this 
-000143a0: 636c 6965 6e74 2c20 6275 7420 7468 6973  client, but this
-000143b0: 2062 6568 6176 696f 7220 6d69 6768 7420   behavior might 
-000143c0: 6265 2069 6d70 6c65 6d65 6e74 6564 2069  be implemented i
-000143d0: 6e20 6120 6675 7475 7265 2072 656c 6561  n a future relea
-000143e0: 7365 2e0a 0a50 6c65 6173 6520 6e6f 7465  se...Please note
-000143f0: 2c20 6e65 6172 6c79 2061 6c6c 2074 6865  , nearly all the
-00014400: 2063 6c69 656e 7420 6d65 7468 6f64 7320   client methods 
-00014410: 6172 6520 6465 636f 7261 7465 6420 7769  are decorated wi
-00014420: 7468 2060 4061 7574 6f72 6563 6f6e 6e65  th `@autoreconne
-00014430: 6374 6020 2877 6869 6368 0a63 616c 6c73  ct` (which.calls
-00014440: 2074 6865 2060 7265 636f 6e6e 6563 7428   the `reconnect(
-00014450: 2960 206d 6574 686f 6420 7768 656e 2074  )` method when t
-00014460: 6865 2063 6c69 656e 7420 6465 7465 6374  he client detect
-00014470: 7320 7468 6174 2072 6563 6f6e 6e65 6374  s that reconnect
-00014480: 696e 6720 6973 2072 6571 7569 7265 6429  ing is required)
-00014490: 0a61 6e64 2061 2060 4072 6574 7279 6020  .and a `@retry` 
-000144a0: 6465 636f 7261 746f 7220 7468 6174 206d  decorator that m
-000144b0: 6f72 6520 6765 6e65 7261 6c6c 7920 7769  ore generally wi
-000144c0: 6c6c 2072 6574 7279 206f 7065 7261 7469  ll retry operati
-000144d0: 6f6e 7320 7468 6174 2066 6169 6c20 6475  ons that fail du
-000144e0: 6520 746f 0a63 6f6e 6e65 6374 696f 6e20  e to.connection 
-000144f0: 6973 7375 6573 2e0a 0a54 6865 2060 4061  issues...The `@a
-00014500: 7574 6f72 6563 6f6e 6e65 6374 6020 6465  utoreconnect` de
-00014510: 636f 7261 746f 7220 7769 6c6c 2072 6563  corator will rec
-00014520: 6f6e 6e65 6374 2074 6f20 6120 7375 6974  onnect to a suit
-00014530: 6162 6c65 206e 6f64 6520 696e 2074 6865  able node in the
-00014540: 2063 6c75 7374 6572 2077 6865 6e0a 7468   cluster when.th
-00014550: 6520 7365 7276 6572 2074 6f20 7768 6963  e server to whic
-00014560: 6820 7468 6520 636c 6965 6e74 2068 6173  h the client has
-00014570: 2062 6565 6e20 636f 6e6e 6563 7465 6420   been connected 
-00014580: 6861 7320 6265 636f 6d65 2075 6e61 7661  has become unava
-00014590: 696c 6162 6c65 2c20 6f72 2077 6865 6e20  ilable, or when 
-000145a0: 7468 650a 636c 6965 6e74 2773 2067 5250  the.client's gRP
-000145b0: 4320 6368 616e 6e65 6c20 6861 7070 656e  C channel happen
-000145c0: 7320 746f 2068 6176 6520 6265 656e 2063  s to have been c
-000145d0: 6c6f 7365 642e 2054 6865 2063 6c69 656e  losed. The clien
-000145e0: 7420 7769 6c6c 2061 6c73 6f20 7265 636f  t will also reco
-000145f0: 6e6e 6563 7420 7768 656e 0a61 206d 6574  nnect when.a met
-00014600: 686f 6420 6973 2063 616c 6c65 6420 7468  hod is called th
-00014610: 6174 2072 6571 7569 7265 7320 6120 6c65  at requires a le
-00014620: 6164 6572 2c20 616e 6420 7468 6520 636c  ader, and the cl
-00014630: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
-00014640: 6572 656e 6365 2069 7320 746f 2062 650a  erence is to be.
-00014650: 636f 6e6e 6563 7465 6420 746f 2061 206c  connected to a l
-00014660: 6561 6465 722c 2062 7574 2074 6865 206e  eader, but the n
-00014670: 6f64 6520 7468 6174 2074 6865 2063 6c69  ode that the cli
-00014680: 656e 7420 6861 7320 6265 656e 2063 6f6e  ent has been con
-00014690: 6e65 6374 6564 2074 6f20 7374 6f70 7320  nected to stops 
-000146a0: 6265 696e 670a 7468 6520 6c65 6164 6572  being.the leader
-000146b0: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
-000146c0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
-000146d0: 7265 636f 6e6e 6563 7420 746f 2074 6865  reconnect to the
-000146e0: 2063 7572 7265 6e74 206c 6561 6465 722e   current leader.
-000146f0: 2041 6674 6572 0a72 6563 6f6e 6e65 6374   After.reconnect
-00014700: 696e 672c 2074 6865 2066 6169 6c65 6420  ing, the failed 
-00014710: 6f70 6572 6174 696f 6e20 7769 6c6c 2062  operation will b
-00014720: 6520 7265 7472 6965 642e 0a0a 5468 6520  e retried...The 
-00014730: 6040 7265 7472 7960 2064 6563 6f72 6174  `@retry` decorat
-00014740: 6f72 2072 6574 7269 6573 206f 7065 7261  or retries opera
-00014750: 7469 6f6e 7320 7468 6174 2068 6176 6520  tions that have 
-00014760: 6661 696c 6564 2064 7565 2074 6f20 6d6f  failed due to mo
-00014770: 7265 2067 656e 6572 616c 0a63 6f6e 6e65  re general.conne
-00014780: 6374 696f 6e20 6973 7375 6573 2c20 7375  ction issues, su
-00014790: 6368 2061 7320 6120 6465 6164 6c69 6e65  ch as a deadline
-000147a0: 2062 6569 6e67 2072 6561 6368 6564 2028   being reached (
-000147b0: 736f 2074 6861 7420 7468 6520 6f70 6572  so that the oper
-000147c0: 6174 696f 6e20 7469 6d65 730a 6f75 7429  ation times.out)
-000147d0: 2c20 6f72 2069 6e20 6361 7365 2074 6865  , or in case the
-000147e0: 2073 6572 7665 7220 7468 726f 7773 2061   server throws a
-000147f0: 6e20 6578 6365 7074 696f 6e20 7768 656e  n exception when
-00014800: 2068 616e 646c 696e 6720 6120 636c 6965   handling a clie
-00014810: 6e74 2072 6571 7565 7374 2e0a 0a50 6c65  nt request...Ple
-00014820: 6173 6520 616c 736f 206e 6f74 652c 2074  ase also note, t
-00014830: 6865 2061 7370 6563 7473 206e 6f74 2063  he aspects not c
-00014840: 6f76 6572 6564 2062 7920 7468 6520 7265  overed by the re
-00014850: 636f 6e6e 6563 7420 616e 6420 7265 7472  connect and retr
-00014860: 7920 6465 636f 7261 746f 720a 6265 6861  y decorator.beha
-00014870: 7669 6f75 7273 2068 6176 6520 746f 2064  viours have to d
-00014880: 6f20 7769 7468 206d 6574 686f 6473 2074  o with methods t
-00014890: 6861 7420 7265 7475 726e 2069 7465 7261  hat return itera
-000148a0: 746f 7273 2e20 466f 7220 6578 616d 706c  tors. For exampl
-000148b0: 652c 2063 6f6e 7369 6465 720a 7468 6520  e, consider.the 
-000148c0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-000148d0: 2829 6020 6d65 7468 6f64 2c20 7768 6963  ()` method, whic
-000148e0: 6820 7265 7475 726e 7320 616e 2069 7465  h returns an ite
-000148f0: 7261 746f 7220 6f66 2060 5265 636f 7264  rator of `Record
-00014900: 6564 4576 656e 7460 206f 626a 6563 7473  edEvent` objects
-00014910: 2e0a 5468 6520 6d65 7468 6f64 2068 6173  ..The method has
-00014920: 2072 6574 7572 6e65 6420 616e 6420 7468   returned and th
-00014930: 6520 6d65 7468 6f64 2064 6563 6f72 6174  e method decorat
-00014940: 6f72 7320 6861 7665 2074 6865 7265 666f  ors have therefo
-00014950: 7265 2065 7869 7465 6420 6265 666f 7265  re exited before
-00014960: 2074 6865 0a69 7465 7261 7469 6e67 206f   the.iterating o
-00014970: 6620 7468 6520 7265 7370 6f6e 7365 2062  f the response b
-00014980: 6567 696e 732e 2054 6865 7265 666f 7265  egins. Therefore
-00014990: 2c20 6974 2069 736e 2774 2070 6f73 7369  , it isn't possi
-000149a0: 626c 6520 666f 7220 7468 6973 206d 6574  ble for this met
-000149b0: 686f 6420 746f 0a74 7269 6767 6572 2061  hod to.trigger a
-000149c0: 2072 6563 6f6e 6e65 6374 696f 6e20 6f72   reconnection or
-000149d0: 2066 6f72 2069 7420 746f 2072 6574 7279   for it to retry
-000149e0: 2c20 7768 656e 2074 6865 2073 7472 6561  , when the strea
-000149f0: 6d69 6e67 2072 6573 706f 6e73 6520 736f  ming response so
-00014a00: 6d65 686f 7720 6661 696c 732e 0a0a 416e  mehow fails...An
-00014a10: 6f74 6865 7220 6578 616d 706c 6520 6973  other example is
-00014a20: 2074 6865 2022 6361 7463 682d 7570 2220   the "catch-up" 
-00014a30: 616e 6420 7065 7273 6973 7465 6e74 2073  and persistent s
-00014a40: 7562 7363 7269 7074 696f 6e20 7265 6164  ubscription read
-00014a50: 206d 6574 686f 6473 2c20 616c 7468 6f75   methods, althou
-00014a60: 6768 0a77 6974 6820 7468 6573 6520 6d65  gh.with these me
-00014a70: 7468 6f64 7320 7468 6572 6520 6973 2061  thods there is a
-00014a80: 6e20 696e 6974 6961 6c20 2263 6f6e 6669  n initial "confi
-00014a90: 726d 6174 696f 6e22 2072 6573 706f 6e73  rmation" respons
-00014aa0: 6520 6672 6f6d 2074 6865 2073 6572 7665  e from the serve
-00014ab0: 7220 7768 6963 680a 6973 2072 6563 6569  r which.is recei
-00014ac0: 7665 6420 616e 6420 6368 6563 6b65 6420  ved and checked 
-00014ad0: 6279 2074 6865 2063 6c69 656e 7420 6265  by the client be
-00014ae0: 666f 7265 2074 6865 206d 6574 686f 6420  fore the method 
-00014af0: 7265 7475 726e 732c 2073 6f20 6966 2074  returns, so if t
-00014b00: 6865 2073 6572 7665 7220 6973 0a75 6e61  he server is.una
-00014b10: 7661 696c 6162 6c65 2077 6865 6e20 7468  vailable when th
-00014b20: 6520 6361 6c6c 2069 7320 6d61 6465 2c20  e call is made, 
-00014b30: 6f72 2069 6620 7468 6520 6368 616e 6e65  or if the channe
-00014b40: 6c20 6973 2073 6f6d 6568 6f77 2063 6c6f  l is somehow clo
-00014b50: 7365 642c 206f 7220 6966 2074 6865 0a73  sed, or if the.s
-00014b60: 6572 7665 7220 7468 726f 7773 2061 6e20  erver throws an 
-00014b70: 6572 726f 7220 666f 7220 736f 6d65 2072  error for some r
-00014b80: 6561 736f 6e2c 2074 6865 6e20 7468 6520  eason, then the 
-00014b90: 636c 6965 6e74 2077 696c 6c20 6569 7468  client will eith
-00014ba0: 6572 2072 6563 6f6e 6e65 6374 2061 6e64  er reconnect and
-00014bb0: 0a72 6574 7279 2c20 6f72 206d 6f72 6520  .retry, or more 
-00014bc0: 7369 6d70 6c79 206a 7573 7420 7265 7472  simply just retr
-00014bd0: 7920 7468 6520 6f70 6572 6174 696f 6e2c  y the operation,
-00014be0: 2061 6363 6f72 6469 6e67 2074 6865 2074   according the t
-00014bf0: 7970 6520 6f66 2065 7272 6f72 2074 6861  ype of error tha
-00014c00: 740a 7761 7320 656e 636f 756e 7465 7265  t.was encountere
-00014c10: 642e 2048 6f77 6576 6572 2c20 616e 2065  d. However, an e
-00014c20: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
-00014c30: 636f 6d70 6f6e 656e 7420 7468 6174 2069  component that i
-00014c40: 7465 7261 7465 7320 6f76 6572 2061 0a73  terates over a.s
-00014c50: 7563 6365 7373 6675 6c6c 7920 7265 7475  uccessfully retu
-00014c60: 726e 6564 2022 6361 7463 682d 7570 2220  rned "catch-up" 
-00014c70: 7375 6273 6372 6970 7469 6f6e 2072 6573  subscription res
-00014c80: 706f 6e73 6520 7769 6c6c 206e 6565 6420  ponse will need 
-00014c90: 746f 2062 6520 6d6f 6e69 746f 7265 6420  to be monitored 
-00014ca0: 666f 720a 6572 726f 7273 2c20 616e 642c  for.errors, and,
-00014cb0: 2069 6620 6974 2066 6169 6c73 2061 6674   if it fails aft
-00014cc0: 6572 2069 7420 6861 7320 7374 6172 7465  er it has starte
-00014cd0: 6420 6974 6572 6174 696e 6720 6f76 6572  d iterating over
-00014ce0: 2074 6865 2072 6573 706f 6e73 652c 2074   the response, t
-00014cf0: 6865 2063 6174 6368 2d75 700a 7375 6273  he catch-up.subs
-00014d00: 6372 6970 7469 6f6e 2077 696c 6c20 6e65  cription will ne
-00014d10: 6564 2074 6f20 6265 2072 6573 7461 7274  ed to be restart
-00014d20: 6564 2066 726f 6d20 7468 6520 6576 656e  ed from the even
-00014d30: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
-00014d40: 706f 6e65 6e74 2773 2022 6c61 7374 0a73  ponent's "last.s
-00014d50: 6176 6564 2063 6f6d 6d69 7420 706f 7369  aved commit posi
-00014d60: 7469 6f6e 222e 2049 6620 7468 6520 6576  tion". If the ev
-00014d70: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
-00014d80: 6f6d 706f 6e65 6e74 2069 7320 7265 636f  omponent is reco
-00014d90: 7264 696e 6720 7468 6520 636f 6d6d 6974  rding the commit
-00014da0: 0a70 6f73 6974 696f 6e20 6f66 2065 6163  .position of eac
-00014db0: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
-00014dc0: 2061 746f 6d69 6361 6c6c 7920 616c 6f6e   atomically alon
-00014dd0: 6720 7769 7468 2061 6e79 206e 6577 2073  g with any new s
-00014de0: 7461 7465 2074 6861 7420 7265 7375 6c74  tate that result
-00014df0: 7320 6672 6f6d 0a70 726f 6365 7373 696e  s from.processin
-00014e00: 6720 7468 6520 7265 636f 7264 6564 2065  g the recorded e
-00014e10: 7665 6e74 732c 2061 6e64 2074 6865 2063  vents, and the c
-00014e20: 6f6d 6d69 7420 706f 7369 7469 6f6e 7320  ommit positions 
-00014e30: 6172 6520 7265 636f 7264 6564 2077 6974  are recorded wit
-00014e40: 6820 6120 756e 6971 7565 6e65 7373 0a63  h a uniqueness.c
-00014e50: 6f6e 7374 7261 696e 742c 2074 6865 6e20  onstraint, then 
-00014e60: 7468 6572 6520 7769 6c6c 206e 6f20 6461  there will no da
-00014e70: 6e67 6572 2074 6f20 7468 6520 7072 6f6a  nger to the proj
-00014e80: 6563 7465 6420 7374 6174 6520 6265 636f  ected state beco
-00014e90: 6d69 6e67 2069 6e63 6f6e 7369 7374 656e  ming inconsisten
-00014ea0: 7420 6475 650a 746f 2074 6865 7365 2063  t due.to these c
-00014eb0: 6f6e 6e65 6374 696f 6e20 6973 7375 6573  onnection issues
-00014ec0: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
-00014ed0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
-00014ee0: 6175 746f 6d61 7469 6361 6c6c 7920 7265  automatically re
-00014ef0: 636f 6e6e 6563 7420 746f 2061 0a6e 6f64  connect to a.nod
-00014f00: 6520 696e 2074 6865 2063 6c75 7374 6572  e in the cluster
-00014f10: 2077 6865 6e20 7468 6520 7375 6273 6571   when the subseq
-00014f20: 7565 6e74 2063 616c 6c20 746f 2061 2063  uent call to a c
-00014f30: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-00014f40: 7469 6f6e 206d 6574 686f 6420 6973 206d  tion method is m
-00014f50: 6164 652e 0a59 6f75 206a 7573 7420 6e65  ade..You just ne
-00014f60: 6564 2074 6f20 6861 6e64 6c65 2074 6865  ed to handle the
-00014f70: 2065 7863 6570 7469 6f6e 2074 6861 7420   exception that 
-00014f80: 6f63 6375 7273 2066 726f 6d20 7468 6520  occurs from the 
-00014f90: 6974 6572 6174 6f72 2c20 7468 656e 2072  iterator, then r
-00014fa0: 6561 6420 796f 7572 206c 6173 740a 7361  ead your last.sa
-00014fb0: 7665 6420 636f 6d6d 6974 2070 6f73 6974  ved commit posit
-00014fc0: 696f 6e2c 2061 6e64 2074 6865 6e20 7265  ion, and then re
-00014fd0: 7374 6172 7420 796f 7572 2065 7665 6e74  start your event
-00014fe0: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-00014ff0: 6f6e 656e 742c 2075 7369 6e67 2074 6865  onent, using the
-00015000: 2073 616d 650a 636c 6965 6e74 206f 626a   same.client obj
-00015010: 6563 742e 2054 6865 2063 6c69 656e 7420  ect. The client 
-00015020: 7769 6c6c 2072 6563 6f6e 6e65 6374 2069  will reconnect i
-00015030: 6620 7468 6572 6520 6973 2061 206e 6565  f there is a nee
-00015040: 6420 746f 2064 6f20 736f 2077 6865 6e20  d to do so when 
-00015050: 7468 6520 7375 6273 6571 7565 6e74 0a63  the subsequent.c
-00015060: 616c 6c20 6973 206d 6164 652e 2053 696d  all is made. Sim
-00015070: 696c 6172 6c79 2c20 7768 656e 2072 6561  ilarly, when rea
-00015080: 6469 6e67 2070 6572 7369 7374 656e 7420  ding persistent 
-00015090: 7375 6273 6372 6970 7469 6f6e 732c 2069  subscriptions, i
-000150a0: 6620 7468 6572 6520 6172 650a 636f 6e6e  f there are.conn
-000150b0: 6563 7469 7669 7479 2069 7373 7565 7320  ectivity issues 
-000150c0: 6166 7465 7220 796f 7520 6861 7665 2073  after you have s
-000150d0: 7461 7274 6564 2069 7465 7261 7469 6e67  tarted iterating
-000150e0: 206f 7665 7220 6120 7375 6363 6573 7366   over a successf
-000150f0: 756c 6c79 2072 6563 6569 7665 640a 7265  ully received.re
-00015100: 7370 6f6e 7365 2c20 7468 656e 2074 6865  sponse, then the
-00015110: 2073 6572 7665 7220 6361 6c6c 2077 696c   server call wil
-00015120: 6c20 6e65 6564 2074 6f20 6265 2072 6573  l need to be res
-00015130: 7461 7274 6564 2e20 496e 2074 6869 7320  tarted. In this 
-00015140: 6361 7365 2c20 7468 6520 7265 6365 6976  case, the receiv
-00015150: 6564 0a65 7665 6e74 7320 7769 6c6c 2073  ed.events will s
-00015160: 7461 7274 2077 6974 6820 7468 6520 6c61  tart with the la
-00015170: 7374 2073 6176 6564 2063 6865 636b 706f  st saved checkpo
-00015180: 696e 7420 6f6e 2074 6865 2073 6572 7665  int on the serve
-00015190: 7220 2870 6f74 656e 7469 616c 6c79 2072  r (potentially r
-000151a0: 6574 7572 6e69 6e67 0a65 7665 6e74 7320  eturning.events 
-000151b0: 7468 6174 2077 6572 6520 696e 2066 6163  that were in fac
-000151c0: 7420 7375 6363 6573 7366 756c 6c79 2070  t successfully p
-000151d0: 726f 6365 7373 6564 292e 0a0a 0a23 2323  rocessed)....###
-000151e0: 2043 6c6f 7365 0a0a 5468 6520 6063 6c6f   Close..The `clo
-000151f0: 7365 2829 6020 6d65 7468 6f64 2063 616e  se()` method can
-00015200: 2062 6520 7573 6564 2074 6f20 636c 6561   be used to clea
-00015210: 6e6c 7920 636c 6f73 6520 7468 6520 6752  nly close the gR
-00015220: 5043 2063 6f6e 6e65 6374 696f 6e2e 0a0a  PC connection...
-00015230: 6060 6070 7974 686f 6e0a 636c 6965 6e74  ```python.client
-00015240: 2e63 6c6f 7365 2829 0a60 6060 0a0a 2323  .close().```..##
-00015250: 204e 6f74 6573 0a0a 2323 2320 436f 6e6e   Notes..### Conn
-00015260: 6563 7469 6f6e 2073 7472 696e 6773 0a0a  ection strings..
-00015270: 5468 6520 4576 656e 7453 746f 7265 4442  The EventStoreDB
-00015280: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00015290: 6e67 2069 7320 6120 5552 4920 7468 6174  ng is a URI that
-000152a0: 2063 6f6e 666f 726d 7320 7769 7468 206f   conforms with o
-000152b0: 6e65 206f 6620 7477 6f20 706f 7373 6962  ne of two possib
-000152c0: 6c65 0a73 6368 656d 6573 2c20 6569 7468  le.schemes, eith
-000152d0: 6572 2074 6865 2022 6573 6462 2220 7363  er the "esdb" sc
-000152e0: 6865 6d65 206f 7220 7468 6520 2265 7364  heme or the "esd
-000152f0: 622b 6469 7363 6f76 6572 2220 7363 6865  b+discover" sche
-00015300: 6d65 2e20 5468 6520 7379 6e74 6178 2061  me. The syntax a
-00015310: 6e64 0a73 656d 616e 7469 6373 206f 6620  nd.semantics of 
-00015320: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
-00015330: 2055 5249 2073 6368 656d 6573 2061 7265   URI schemes are
-00015340: 2065 7870 6c61 696e 6564 2062 656c 6f77   explained below
-00015350: 2e20 5468 6520 7379 6e74 6178 2069 730a  . The syntax is.
-00015360: 6465 6669 6e65 6420 7573 696e 6720 5b45  defined using [E
-00015370: 424e 465d 2868 7474 7073 3a2f 2f65 6e2e  BNF](https://en.
-00015380: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00015390: 6b69 2f45 7874 656e 6465 645f 4261 636b  ki/Extended_Back
-000153a0: 7573 e280 934e 6175 725f 666f 726d 292e  us...Naur_form).
-000153b0: 0a0a 5468 6520 2265 7364 6222 2055 5249  ..The "esdb" URI
-000153c0: 2073 6368 656d 6520 6361 6e20 6265 2064   scheme can be d
-000153d0: 6566 696e 6564 2069 6e20 7468 6520 666f  efined in the fo
-000153e0: 6c6c 6f77 696e 6720 7761 792e 0a0a 2020  llowing way...  
-000153f0: 2020 6573 6462 2d75 7269 203d 2022 6573    esdb-uri = "es
-00015400: 6462 3a2f 2f22 202c 205b 2075 7365 722d  db://" , [ user-
-00015410: 696e 666f 202c 2022 4022 205d 202c 2067  info , "@" ] , g
-00015420: 7270 632d 7461 7267 6574 2c20 7b20 222c  rpc-target, { ",
-00015430: 2220 2c20 6772 7063 2d74 6172 6765 7420  " , grpc-target 
-00015440: 7d20 2c20 5b20 223f 2220 2c20 7175 6572  } , [ "?" , quer
-00015450: 792d 7374 7269 6e67 205d 203b 0a0a 496e  y-string ] ;..In
-00015460: 2074 6865 2022 6573 6462 2220 5552 4920   the "esdb" URI 
-00015470: 7363 6865 6d65 2c20 6166 7465 7220 7468  scheme, after th
-00015480: 6520 6f70 7469 6f6e 616c 2075 7365 7220  e optional user 
-00015490: 696e 666f 2073 7472 696e 672c 2074 6865  info string, the
-000154a0: 7265 206d 7573 7420 6265 2061 7420 6c65  re must be at le
-000154b0: 6173 740a 6f6e 6520 6752 5043 2074 6172  ast.one gRPC tar
-000154c0: 6765 742e 2049 6620 7468 6572 6520 6172  get. If there ar
-000154d0: 6520 7365 7665 7261 6c20 6752 5043 2074  e several gRPC t
-000154e0: 6172 6765 7473 2c20 7468 6579 206d 7573  argets, they mus
-000154f0: 7420 6265 2073 6570 6172 6174 6564 2066  t be separated f
-00015500: 726f 6d20 6561 6368 0a6f 7468 6572 2077  rom each.other w
-00015510: 6974 6820 7468 6520 222c 2220 6368 6172  ith the "," char
-00015520: 6163 7465 722e 2045 6163 6820 6752 5043  acter. Each gRPC
-00015530: 2074 6172 6765 7420 7368 6f75 6c64 2069   target should i
-00015540: 6e64 6963 6174 6520 616e 2045 7665 6e74  ndicate an Event
-00015550: 5374 6f72 6544 4220 6752 5043 0a73 6572  StoreDB gRPC.ser
-00015560: 7665 7220 736f 636b 6574 2c20 6279 2073  ver socket, by s
-00015570: 7065 6369 6679 696e 6720 6120 686f 7374  pecifying a host
-00015580: 2061 6e64 2061 2070 6f72 7420 6e75 6d62   and a port numb
-00015590: 6572 2073 6570 6172 6174 6564 2077 6974  er separated wit
-000155a0: 6820 7468 6520 223a 2220 6368 6172 6163  h the ":" charac
-000155b0: 7465 722e 0a54 6865 2068 6f73 7420 6d61  ter..The host ma
-000155c0: 7920 6265 2061 2068 6f73 746e 616d 6520  y be a hostname 
-000155d0: 7468 6174 2063 616e 2062 6520 7265 736f  that can be reso
-000155e0: 6c76 6564 2074 6f20 616e 2049 5020 6164  lved to an IP ad
-000155f0: 6472 6573 732c 206f 7220 616e 2049 5020  dress, or an IP 
-00015600: 6164 6472 6573 732e 0a0a 2020 2020 6772  address...    gr
-00015610: 7063 2d74 6172 6765 7420 3d20 2820 686f  pc-target = ( ho
-00015620: 7374 6e61 6d65 207c 2069 702d 6164 6472  stname | ip-addr
-00015630: 6573 7320 2920 2c20 223a 2220 2c20 706f  ess ) , ":" , po
-00015640: 7274 2d6e 756d 6265 7220 3b0a 0a0a 5468  rt-number ;...Th
-00015650: 6520 2265 7364 622b 6469 7363 6f76 6572  e "esdb+discover
-00015660: 2220 5552 4920 7363 6865 6d65 2063 616e  " URI scheme can
-00015670: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
-00015680: 6865 2066 6f6c 6c6f 7769 6e67 2077 6179  he following way
-00015690: 2e0a 0a20 2020 2065 7364 622d 6469 7363  ...    esdb-disc
-000156a0: 6f76 6572 2d75 7269 203d 2022 6573 6462  over-uri = "esdb
-000156b0: 2b64 6973 636f 7665 723a 2f2f 2220 2c20  +discover://" , 
-000156c0: 5b20 7573 6572 2d69 6e66 6f2c 2022 4022  [ user-info, "@"
-000156d0: 205d 202c 2063 6c75 7374 6572 2d64 6f6d   ] , cluster-dom
-000156e0: 6169 6e6e 616d 6520 2c20 5b20 223f 2220  ainname , [ "?" 
-000156f0: 2c20 7175 6572 792d 7374 7269 6e67 205d  , query-string ]
-00015700: 203b 0a0a 496e 2074 6865 2022 6573 6462   ;..In the "esdb
-00015710: 2b64 6973 636f 7665 7222 2055 5249 2073  +discover" URI s
-00015720: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
-00015730: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
-00015740: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
-00015750: 2061 2064 6f6d 6169 6e0a 6e61 6d65 2077   a domain.name w
-00015760: 6869 6368 2073 686f 756c 6420 6964 656e  hich should iden
-00015770: 7469 6679 2061 2063 6c75 7374 6572 206f  tify a cluster o
-00015780: 6620 4576 656e 7453 746f 7265 4442 2073  f EventStoreDB s
-00015790: 6572 7665 7273 2e20 5468 6520 636c 6965  ervers. The clie
-000157a0: 6e74 2077 696c 6c20 7573 6520 6120 444e  nt will use a DN
-000157b0: 530a 7365 7276 6572 2074 6f20 7265 736f  S.server to reso
-000157c0: 6c76 6520 7468 6520 646f 6d61 696e 206e  lve the domain n
-000157d0: 616d 6520 746f 2061 206c 6973 7420 6f66  ame to a list of
-000157e0: 2061 6464 7265 7373 6573 206f 6620 4576   addresses of Ev
-000157f0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00015800: 7273 2c0a 6279 2071 7565 7279 696e 6720  rs,.by querying 
-00015810: 666f 7220 2741 2720 7265 636f 7264 732e  for 'A' records.
-00015820: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-00015830: 6865 2070 6f72 7420 6e75 6d62 6572 2022  he port number "
-00015840: 3231 3133 2220 7769 6c6c 2062 6520 7573  2113" will be us
-00015850: 6564 2074 6f0a 636f 6e73 7472 7563 7420  ed to.construct 
-00015860: 6752 5043 2074 6172 6765 7473 2066 726f  gRPC targets fro
-00015870: 6d20 7468 6520 6164 6472 6573 7365 7320  m the addresses 
-00015880: 6f62 7461 696e 6564 2066 726f 6d20 2741  obtained from 'A
-00015890: 2720 7265 636f 7264 7320 7072 6f76 6964  ' records provid
-000158a0: 6564 2062 7920 7468 650a 444e 5320 7365  ed by the.DNS se
-000158b0: 7276 6572 2e20 5468 6572 6566 6f72 652c  rver. Therefore,
-000158c0: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-000158d0: 7573 6520 7468 6520 2265 7364 622b 6469  use the "esdb+di
-000158e0: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
-000158f0: 6d65 2c20 796f 7520 7769 6c6c 0a6e 6565  me, you will.nee
-00015900: 6420 746f 2063 6f6e 6669 6775 7265 2044  d to configure D
-00015910: 4e53 2077 6865 6e20 7365 7474 696e 6720  NS when setting 
-00015920: 7570 2079 6f75 7220 4576 656e 7453 746f  up your EventSto
-00015930: 7265 4442 2063 6c75 7374 6572 2e0a 0a57  reDB cluster...W
-00015940: 6974 6820 626f 7468 2074 6865 2022 6573  ith both the "es
-00015950: 6462 2220 616e 6420 2265 7364 622b 6469  db" and "esdb+di
-00015960: 736f 6376 6572 2220 5552 4920 7363 6865  socver" URI sche
-00015970: 6d65 732c 2074 6865 2063 6c69 656e 7420  mes, the client 
-00015980: 6669 7273 746c 7920 6f62 7461 696e 730a  firstly obtains.
-00015990: 6120 6c69 7374 206f 6620 6752 5043 2074  a list of gRPC t
-000159a0: 6172 6765 7473 3a20 6569 7468 6572 2064  argets: either d
-000159b0: 6972 6563 746c 7920 6672 6f6d 2022 6573  irectly from "es
-000159c0: 6462 2220 636f 6e6e 6563 7469 6f6e 2073  db" connection s
-000159d0: 7472 696e 6773 3b20 6f72 2069 6e64 6972  trings; or indir
-000159e0: 6563 746c 790a 6672 6f6d 2022 6573 6462  ectly.from "esdb
-000159f0: 2b64 6973 636f 7665 7222 2063 6f6e 6e65  +discover" conne
-00015a00: 6374 696f 6e20 7374 7269 6e67 7320 7669  ction strings vi
-00015a10: 6120 444e 532e 2054 6869 7320 6c69 7374  a DNS. This list
-00015a20: 206f 6620 7461 7267 6574 7320 6973 206b   of targets is k
-00015a30: 6e6f 776e 2061 7320 7468 650a 2267 6f73  nown as the."gos
-00015a40: 7369 7020 7365 6564 222e 2054 6865 2063  sip seed". The c
-00015a50: 6c69 656e 7420 7769 6c6c 2074 6865 6e20  lient will then 
-00015a60: 6174 7465 6d70 7420 746f 2063 6f6e 6e65  attempt to conne
-00015a70: 6374 2074 6f20 6561 6368 2067 5250 4320  ct to each gRPC 
-00015a80: 7461 7267 6574 2069 6e20 7475 726e 2c0a  target in turn,.
-00015a90: 6174 7465 6d70 7469 6e67 2074 6f20 6361  attempting to ca
-00015aa0: 6c6c 2074 6865 2045 7665 6e74 5374 6f72  ll the EventStor
-00015ab0: 6544 4220 476f 7373 6970 2041 5049 2074  eDB Gossip API t
-00015ac0: 6f20 6f62 7461 696e 2069 6e66 6f72 6d61  o obtain informa
-00015ad0: 7469 6f6e 2061 626f 7574 2074 6865 0a45  tion about the.E
-00015ae0: 7665 6e74 5374 6f72 6544 4220 636c 7573  ventStoreDB clus
-00015af0: 7465 722e 2041 206d 656d 6265 7220 6f66  ter. A member of
-00015b00: 2074 6865 2063 6c75 7374 6572 2069 7320   the cluster is 
-00015b10: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
-00015b20: 636c 6965 6e74 2c20 6163 636f 7264 696e  client, accordin
-00015b30: 670a 746f 2074 6865 2022 6e6f 6465 2070  g.to the "node p
-00015b40: 7265 6665 7265 6e63 6522 206f 7074 696f  reference" optio
-00015b50: 6e2e 2054 6865 2063 6c69 656e 7420 6d61  n. The client ma
-00015b60: 7920 7468 656e 206e 6565 6420 746f 2063  y then need to c
-00015b70: 6c6f 7365 2069 7473 0a63 6f6e 6e65 6374  lose its.connect
-00015b80: 696f 6e20 616e 6420 7265 636f 6e6e 6563  ion and reconnec
-00015b90: 7420 746f 2074 6865 2073 656c 6563 7465  t to the selecte
-00015ba0: 6420 7365 7276 6572 2e0a 0a49 6e20 626f  d server...In bo
-00015bb0: 7468 2074 6865 2022 6573 6462 2220 616e  th the "esdb" an
-00015bc0: 6420 2265 7364 622b 6469 7363 6f76 6572  d "esdb+discover
-00015bd0: 2220 7363 6865 6d65 732c 2074 6865 2055  " schemes, the U
-00015be0: 5249 206d 6179 2069 6e63 6c75 6465 2061  RI may include a
-00015bf0: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
-00015c00: 672e 0a49 6620 6974 2065 7869 7374 7320  g..If it exists 
-00015c10: 696e 2074 6865 2055 5249 2c20 7468 6520  in the URI, the 
-00015c20: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-00015c30: 206d 7573 7420 6265 2073 6570 6172 6174   must be separat
-00015c40: 6564 2066 726f 6d20 7468 6520 7265 7374  ed from the rest
-00015c50: 206f 6620 7468 6520 5552 490a 7769 7468   of the URI.with
-00015c60: 2074 6865 2022 4022 2063 6861 7261 6374   the "@" charact
-00015c70: 6572 2e20 5468 6520 7573 6572 2069 6e66  er. The user inf
-00015c80: 6f20 7374 7269 6e67 206d 7573 7420 696e  o string must in
-00015c90: 636c 7564 6520 6120 7573 6572 6e61 6d65  clude a username
-00015ca0: 2061 6e64 2061 2070 6173 7377 6f72 642c   and a password,
-00015cb0: 0a73 6570 6172 6174 6564 2077 6974 6820  .separated with 
-00015cc0: 7468 6520 223a 2220 6368 6172 6163 7465  the ":" characte
-00015cd0: 722e 0a0a 2020 2020 7573 6572 2d69 6e66  r...    user-inf
-00015ce0: 6f20 3d20 7573 6572 6e61 6d65 202c 2022  o = username , "
-00015cf0: 3a22 202c 2070 6173 7377 6f72 6420 3b0a  :" , password ;.
-00015d00: 0a54 6865 2075 7365 7220 696e 666f 2069  .The user info i
-00015d10: 7320 7365 6e74 2062 7920 7468 6520 636c  s sent by the cl
-00015d20: 6965 6e74 2061 7320 2263 616c 6c20 6372  ient as "call cr
-00015d30: 6564 656e 7469 616c 7322 2069 6e20 6561  edentials" in ea
-00015d40: 6368 2063 616c 6c20 746f 2061 2022 7365  ch call to a "se
-00015d50: 6375 7265 220a 7365 7276 6572 2c20 696e  cure".server, in
-00015d60: 2061 2022 6261 7369 6320 6175 7468 2220   a "basic auth" 
-00015d70: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
-00015d80: 6164 6572 2e20 5468 6973 2061 7574 686f  ader. This autho
-00015d90: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
-00015da0: 6973 2075 7365 6420 6279 0a74 6865 2073  is used by.the s
-00015db0: 6572 7665 7220 746f 2061 7574 6865 6e74  erver to authent
-00015dc0: 6963 6174 6520 7468 6520 636c 6965 6e74  icate the client
-00015dd0: 2e20 5468 6520 6175 7468 6f72 697a 6174  . The authorizat
-00015de0: 696f 6e20 6865 6164 6572 2069 7320 6e6f  ion header is no
-00015df0: 7420 7365 6e74 2074 6f0a 2269 6e73 6563  t sent to."insec
-00015e00: 7572 6522 2073 6572 7665 7273 2e0a 0a49  ure" servers...I
-00015e10: 6e20 626f 7468 2074 6865 2022 6573 6462  n both the "esdb
-00015e20: 2220 616e 6420 2265 7364 622b 6469 7363  " and "esdb+disc
-00015e30: 6f76 6572 2220 7363 6865 6d65 732c 2074  over" schemes, t
-00015e40: 6865 206f 7074 696f 6e61 6c20 7175 6572  he optional quer
-00015e50: 7920 7374 7269 6e67 206d 7573 7420 6265  y string must be
-00015e60: 206f 6e65 0a6f 7220 6d61 6e79 2066 6965   one.or many fie
-00015e70: 6c64 2d76 616c 7565 2061 7267 756d 656e  ld-value argumen
-00015e80: 7473 2c20 7365 7061 7261 7465 6420 6672  ts, separated fr
-00015e90: 6f6d 2065 6163 6820 6f74 6865 7220 7769  om each other wi
-00015ea0: 7468 2074 6865 2022 2622 2063 6861 7261  th the "&" chara
-00015eb0: 6374 6572 2e0a 0a20 2020 2071 7565 7279  cter...    query
-00015ec0: 2d73 7472 696e 6720 3d20 6669 656c 642d  -string = field-
-00015ed0: 7661 6c75 652c 207b 2022 2622 2c20 6669  value, { "&", fi
-00015ee0: 656c 642d 7661 6c75 6520 7d20 3b0a 0a45  eld-value } ;..E
-00015ef0: 6163 6820 6669 656c 642d 7661 6c75 6520  ach field-value 
-00015f00: 6172 6775 6d65 6e74 206d 7573 7420 6265  argument must be
-00015f10: 206f 6e65 206f 6620 7468 6520 7375 7070   one of the supp
-00015f20: 6f72 7465 6420 6669 656c 6473 2c20 616e  orted fields, an
-00015f30: 6420 616e 0a61 7070 726f 7072 6961 7465  d an.appropriate
-00015f40: 2076 616c 7565 2c20 7365 7061 7261 7465   value, separate
-00015f50: 6420 7769 7468 2074 6865 2022 3d22 2063  d with the "=" c
-00015f60: 6861 7261 6374 6572 2e0a 0a20 2020 2066  haracter...    f
-00015f70: 6965 6c64 2d76 616c 7565 203d 2028 2022  ield-value = ( "
-00015f80: 546c 7322 2c20 223d 2220 2c20 2274 7275  Tls", "=" , "tru
-00015f90: 6522 207c 2022 6661 6c73 6522 2029 0a20  e" | "false" ). 
-00015fa0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00015fb0: 2028 2022 546c 7356 6572 6966 7943 6572   ( "TlsVerifyCer
-00015fc0: 7422 2c20 223d 2220 2c20 2274 7275 6522  t", "=" , "true"
-00015fd0: 207c 2022 6661 6c73 6522 2029 0a20 2020   | "false" ).   
-00015fe0: 2020 2020 2020 2020 2020 2020 207c 2028               | (
-00015ff0: 2022 436f 6e6e 6563 7469 6f6e 4e61 6d65   "ConnectionName
-00016000: 222c 2022 3d22 202c 2073 7472 696e 6720  ", "=" , string 
-00016010: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016020: 2020 7c20 2820 224e 6f64 6550 7265 6665    | ( "NodePrefe
-00016030: 7265 6e63 6522 2c20 223d 2220 2c20 226c  rence", "=" , "l
-00016040: 6561 6465 7222 207c 2022 666f 6c6c 6f77  eader" | "follow
-00016050: 6572 2220 7c20 2272 6561 646f 6e6c 7972  er" | "readonlyr
-00016060: 6570 6c69 6361 2220 7c20 2272 616e 646f  eplica" | "rando
-00016070: 6d22 2029 0a20 2020 2020 2020 2020 2020  m" ).           
-00016080: 2020 2020 207c 2028 2022 4465 6661 756c       | ( "Defaul
-00016090: 7444 6561 646c 696e 6522 2c20 223d 2220  tDeadline", "=" 
-000160a0: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
-000160b0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-000160c0: 2247 6f73 7369 7054 696d 656f 7574 222c  "GossipTimeout",
-000160d0: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
-000160e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000160f0: 207c 2028 2022 4d61 7844 6973 636f 7665   | ( "MaxDiscove
-00016100: 7241 7474 656d 7074 7322 2c20 223d 2220  rAttempts", "=" 
-00016110: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
-00016120: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00016130: 2244 6973 636f 7665 7279 496e 7465 7276  "DiscoveryInterv
-00016140: 616c 222c 2022 3d22 202c 2069 6e74 6567  al", "=" , integ
-00016150: 6572 2029 0a20 2020 2020 2020 2020 2020  er ).           
-00016160: 2020 2020 207c 2028 2022 4d61 7844 6973       | ( "MaxDis
-00016170: 636f 7665 7241 7474 656d 7074 7322 2c20  coverAttempts", 
-00016180: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
-00016190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161a0: 7c20 2820 224b 6565 7041 6c69 7665 496e  | ( "KeepAliveIn
-000161b0: 7465 7276 616c 222c 2022 3d22 202c 2069  terval", "=" , i
-000161c0: 6e74 6567 6572 2029 0a20 2020 2020 2020  nteger ).       
-000161d0: 2020 2020 2020 2020 207c 2028 2022 4b65           | ( "Ke
-000161e0: 6570 416c 6976 6549 6e74 6572 7661 6c22  epAliveInterval"
-000161f0: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
-00016200: 2920 3b0a 0a54 6865 2074 6162 6c65 2062  ) ;..The table b
-00016210: 656c 6f77 2064 6573 6372 6962 6573 2074  elow describes t
-00016220: 6865 2071 7565 7279 2066 6965 6c64 2d76  he query field-v
-00016230: 616c 7565 7320 7375 7070 6f72 7465 6420  alues supported 
-00016240: 6279 2074 6869 7320 636c 6965 6e74 2e0a  by this client..
-00016250: 0a7c 2046 6965 6c64 2020 2020 2020 2020  .| Field        
-00016260: 2020 2020 2020 207c 2056 616c 7565 2020         | Value  
-00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162a0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000162b0: 2044 6573 6372 6970 7469 6f6e 2020 2020   Description    
-000162c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016350: 2020 207c 0a7c 2d2d 2d2d 2d2d 2d2d 2d2d     |.|----------
-00016360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d  -----------|----
-00016370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163b0: 2d2d 2d7c 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ---|------------
-000163c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016450: 2d2d 2d2d 2d2d 2d7c 0a7c 2054 6c73 2020  -------|.| Tls  
-00016460: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00016470: 2022 7472 7565 222c 2022 6661 6c73 6522   "true", "false"
-00016480: 2028 6465 6661 756c 743a 2022 7472 7565   (default: "true
-00016490: 2229 2020 2020 2020 2020 2020 2020 2020  ")              
-000164a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164b0: 2020 2020 2020 207c 2049 6620 2274 7275         | If "tru
-000164c0: 6522 2074 6865 2063 6c69 656e 7420 7769  e" the client wi
-000164d0: 6c6c 2063 7265 6174 6520 6120 2273 6563  ll create a "sec
-000164e0: 7572 6522 2067 5250 4320 6368 616e 6e65  ure" gRPC channe
-000164f0: 6c2e 2049 6620 2266 616c 7365 2220 7468  l. If "false" th
-00016500: 6520 636c 6965 6e74 2077 696c 6c20 6372  e client will cr
-00016510: 6561 7465 2061 6e20 2269 6e73 6563 7572  eate an "insecur
-00016520: 6522 2067 5250 4320 6368 616e 6e65 6c2e  e" gRPC channel.
-00016530: 2054 6869 7320 6d75 7374 206d 6174 6368   This must match
-00016540: 2074 6865 2073 6572 7665 7220 636f 6e66   the server conf
-00016550: 6967 7572 6174 696f 6e2e 207c 0a7c 2054  iguration. |.| T
-00016560: 6c73 5665 7269 6679 4365 7274 2020 2020  lsVerifyCert    
-00016570: 2020 207c 2022 7472 7565 222c 2022 6661     | "true", "fa
-00016580: 6c73 6522 2028 6465 6661 756c 743a 2022  lse" (default: "
-00016590: 7472 7565 2229 2020 2020 2020 2020 2020  true")          
-000165a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165b0: 2020 2020 2020 2020 2020 207c 2054 6869             | Thi
-000165c0: 7320 7661 6c75 6520 6973 2063 7572 7265  s value is curre
-000165d0: 6e74 6c79 2069 676e 6f72 6564 2e20 2020  ntly ignored.   
-000165e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016650: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00016660: 0a7c 2043 6f6e 6e65 6374 696f 6e4e 616d  .| ConnectionNam
-00016670: 6520 2020 2020 207c 2073 7472 696e 6720  e      | string 
-00016680: 2864 6566 6175 6c74 3a20 6175 746f 2d67  (default: auto-g
-00016690: 656e 6572 6174 6564 2076 6572 7369 6f6e  enerated version
-000166a0: 2d34 2055 5549 4429 2020 2020 2020 2020  -4 UUID)        
-000166b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000166c0: 2053 656e 7420 696e 2063 616c 6c20 6d65   Sent in call me
-000166d0: 7461 6461 7461 2066 6f72 2065 7665 7279  tadata for every
-000166e0: 2063 616c 6c2c 2074 6f20 6964 656e 7469   call, to identi
-000166f0: 6679 2074 6865 2063 6c69 656e 7420 746f  fy the client to
-00016700: 2074 6865 2063 6c75 7374 6572 2e20 2020   the cluster.   
-00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016760: 2020 207c 0a7c 204e 6f64 6550 7265 6665     |.| NodePrefe
-00016770: 7265 6e63 6520 2020 2020 207c 2022 6c65  rence      | "le
-00016780: 6164 6572 222c 2022 666f 6c6c 6f77 6572  ader", "follower
-00016790: 222c 2022 7265 6164 6f6e 6c79 7265 706c  ", "readonlyrepl
-000167a0: 6963 6122 2c20 2272 616e 646f 6d22 2028  ica", "random" (
-000167b0: 6465 6661 756c 743a 2022 6c65 6164 6572  default: "leader
-000167c0: 2229 207c 2054 6865 206e 6f64 6520 7374  ") | The node st
-000167d0: 6174 6520 7072 6566 6572 7265 6420 6279  ate preferred by
-000167e0: 2074 6865 2063 6c69 656e 742e 2054 6865   the client. The
-000167f0: 2063 6c69 656e 7420 7769 6c6c 2073 656c   client will sel
-00016800: 6563 7420 6120 6e6f 6465 2066 726f 6d20  ect a node from 
-00016810: 7468 6520 636c 7573 7465 7220 696e 666f  the cluster info
-00016820: 2072 6563 6569 7665 6420 6672 6f6d 2074   received from t
-00016830: 6865 2047 6f73 7369 7020 4150 4920 6163  he Gossip API ac
-00016840: 636f 7264 696e 6720 746f 2074 6869 7320  cording to this 
-00016850: 7072 6566 6572 656e 6365 2e20 2020 2020  preference.     
-00016860: 2020 2020 2020 207c 0a7c 2044 6566 6175         |.| Defau
-00016870: 6c74 4465 6164 6c69 6e65 2020 2020 207c  ltDeadline     |
-00016880: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
-00016890: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
-000168a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168c0: 2020 2020 2020 207c 2054 6865 2064 6566         | The def
-000168d0: 6175 6c74 2076 616c 7565 2028 696e 2073  ault value (in s
-000168e0: 6563 6f6e 6473 2920 6f66 2074 6865 2060  econds) of the `
-000168f0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00016900: 7420 6f66 2063 6c69 656e 7420 2277 7269  t of client "wri
-00016910: 7465 2220 6d65 7468 6f64 7320 7375 6368  te" methods such
-00016920: 2061 7320 6061 7070 656e 645f 6576 656e   as `append_even
-00016930: 7473 2829 602e 2020 2020 2020 2020 2020  ts()`.          
-00016940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016960: 2020 2020 2020 2020 2020 207c 0a7c 2047             |.| G
-00016970: 6f73 7369 7054 696d 656f 7574 2020 2020  ossipTimeout    
-00016980: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
-00016990: 6661 756c 743a 2035 2920 2020 2020 2020  fault: 5)       
-000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169c0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
-000169d0: 2064 6566 6175 6c74 2076 616c 7565 2028   default value (
-000169e0: 696e 2073 6563 6f6e 6473 2920 6f66 2074  in seconds) of t
-000169f0: 6865 2060 7469 6d65 6f75 7460 2061 7267  he `timeout` arg
-00016a00: 756d 656e 7420 6f66 2067 6f73 7369 7020  ument of gossip 
-00016a10: 7265 6164 206d 6574 686f 6473 2c20 7375  read methods, su
-00016a20: 6368 2061 7320 6072 6561 645f 676f 7373  ch as `read_goss
-00016a30: 6970 2829 602e 2020 2020 2020 2020 2020  ip()`.          
-00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00016a70: 0a7c 204d 6178 4469 7363 6f76 6572 4174  .| MaxDiscoverAt
-00016a80: 7465 6d70 7473 207c 2069 6e74 6567 6572  tempts | integer
-00016a90: 2028 6465 6661 756c 743a 2031 3029 2020   (default: 10)  
-00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ac0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00016ad0: 2054 6865 206e 756d 6265 7220 6f66 2061   The number of a
-00016ae0: 7474 656d 7074 7320 746f 2072 6561 6420  ttempts to read 
-00016af0: 676f 7373 6970 2077 6865 6e20 636f 6e6e  gossip when conn
-00016b00: 6563 7469 6e67 206f 7220 7265 636f 6e6e  ecting or reconn
-00016b10: 6563 7469 6e67 2074 6f20 6120 636c 7573  ecting to a clus
-00016b20: 7465 7220 6d65 6d62 6572 2e20 2020 2020  ter member.     
-00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b70: 2020 207c 0a7c 2044 6973 636f 7665 7279     |.| Discovery
-00016b80: 496e 7465 7276 616c 2020 207c 2069 6e74  Interval   | int
-00016b90: 6567 6572 2028 6465 6661 756c 743a 2031  eger (default: 1
-00016ba0: 3030 2920 2020 2020 2020 2020 2020 2020  00)             
-00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bd0: 2020 207c 2048 6f77 206c 6f6e 6720 746f     | How long to
-00016be0: 2077 6169 7420 2869 6e20 6d69 6c6c 6973   wait (in millis
-00016bf0: 6563 6f6e 6473 2920 6265 7477 6565 6e20  econds) between 
-00016c00: 676f 7373 6970 2072 6574 7269 6573 2e20  gossip retries. 
-00016c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c70: 2020 2020 2020 207c 0a7c 204b 6565 7041         |.| KeepA
-00016c80: 6c69 7665 496e 7465 7276 616c 2020 207c  liveInterval   |
-00016c90: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
-00016ca0: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cd0: 2020 2020 2020 207c 2054 6865 2076 616c         | The val
-00016ce0: 7565 206f 6620 7468 6520 2267 7270 632e  ue of the "grpc.
-00016cf0: 6b65 6570 616c 6976 655f 6d73 2220 6752  keepalive_ms" gR
-00016d00: 5043 2063 6861 6e6e 656c 206f 7074 696f  PC channel optio
-00016d10: 6e2e 2020 2020 2020 2020 2020 2020 2020  n.              
-00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d70: 2020 2020 2020 2020 2020 207c 0a7c 204b             |.| K
-00016d80: 6565 7041 6c69 7665 5469 6d65 6f75 7420  eepAliveTimeout 
-00016d90: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
-00016da0: 6661 756c 743a 2060 4e6f 6e65 6029 2020  fault: `None`)  
-00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dd0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
-00016de0: 2076 616c 7565 206f 6620 7468 6520 2267   value of the "g
-00016df0: 7270 632e 6b65 6570 616c 6976 655f 7469  rpc.keepalive_ti
-00016e00: 6d65 6f75 745f 6d73 2220 6752 5043 2063  meout_ms" gRPC c
-00016e10: 6861 6e6e 656c 206f 7074 696f 6e2e 2020  hannel option.  
-00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e70: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00016e80: 0a0a 0a48 6572 6520 6172 6520 736f 6d65  ...Here are some
-00016e90: 2065 7861 6d70 6c65 7320 6f66 2045 7665   examples of Eve
-00016ea0: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
-00016eb0: 7469 6f6e 2073 7472 696e 6720 5552 4973  tion string URIs
-00016ec0: 2e0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
-00016ed0: 7374 6572 2069 6e66 6f20 6672 6f6d 2073  ster info from s
-00016ee0: 6563 7572 6520 7365 7276 6572 2073 6f63  ecure server soc
-00016ef0: 6b65 7420 6c6f 6361 6c68 6f73 743a 3231  ket localhost:21
-00016f00: 3133 2c0a 2020 2020 2320 616e 6420 7573  13,.    # and us
-00016f10: 6520 2261 646d 696e 2220 616e 6420 2263  e "admin" and "c
-00016f20: 6861 6e67 6569 7422 2061 7320 7573 6572  hangeit" as user
-00016f30: 6e61 6d65 2061 6e64 2070 6173 7377 6f72  name and passwor
-00016f40: 640a 2020 2020 2320 7768 656e 206d 616b  d.    # when mak
-00016f50: 696e 6720 6361 6c6c 7320 746f 2045 7665  ing calls to Eve
-00016f60: 6e74 5374 6f72 6544 4220 4150 4920 6d65  ntStoreDB API me
-00016f70: 7468 6f64 732e 0a0a 2020 2020 6573 6462  thods...    esdb
-00016f80: 3a2f 2f61 646d 696e 3a63 6861 6e67 6569  ://admin:changei
-00016f90: 7440 6c6f 6361 6c68 6f73 743a 3231 3133  t@localhost:2113
-00016fa0: 0a0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
-00016fb0: 7374 6572 2069 6e66 6f20 6672 6f6d 2069  ster info from i
-00016fc0: 6e73 6563 7572 6520 7365 7276 6572 2073  nsecure server s
-00016fd0: 6f63 6b65 7420 3132 372e 302e 302e 313a  ocket 127.0.0.1:
-00016fe0: 3231 3134 0a0a 2020 2020 6573 6462 3a2f  2114..    esdb:/
-00016ff0: 2f31 3237 2e30 2e30 2e31 3a32 3131 343f  /127.0.0.1:2114?
-00017000: 546c 733d 6661 6c73 650a 0a0a 2020 2020  Tls=false...    
-00017010: 2320 4765 7420 636c 7573 7465 7220 696e  # Get cluster in
-00017020: 666f 2066 726f 6d20 6164 6472 6573 7365  fo from addresse
-00017030: 7320 696e 2027 4127 2072 6563 6f72 6473  s in 'A' records
-00017040: 2066 6f72 2063 6c75 7374 6572 312e 6578   for cluster1.ex
-00017050: 616d 706c 652e 636f 6d2c 0a20 2020 2023  ample.com,.    #
-00017060: 2061 6e64 2075 7365 2061 2064 6566 6175   and use a defau
-00017070: 6c74 2064 6561 646c 696e 6520 666f 7220  lt deadline for 
-00017080: 6d61 6b69 6e67 2063 616c 6c73 2074 6f20  making calls to 
-00017090: 4576 656e 7453 746f 7265 2041 5049 206d  EventStore API m
-000170a0: 6574 686f 642e 0a0a 2020 2020 6573 6462  ethod...    esdb
-000170b0: 2b64 6973 636f 7665 723a 2f2f 6164 6d69  +discover://admi
-000170c0: 6e3a 6368 616e 6765 6974 4063 6c75 7374  n:changeit@clust
-000170d0: 6572 312e 6578 616d 706c 652e 636f 6d3f  er1.example.com?
-000170e0: 4465 6661 756c 7444 6561 646c 696e 653d  DefaultDeadline=
-000170f0: 350a 0a0a 2020 2020 2320 4765 7420 636c  5...    # Get cl
-00017100: 7573 7465 7220 696e 666f 2066 726f 6d20  uster info from 
-00017110: 6569 7468 6572 206c 6f63 616c 686f 7374  either localhost
-00017120: 3a32 3131 3120 6f72 206c 6f63 616c 686f  :2111 or localho
-00017130: 7374 3a32 3131 3220 6f72 0a20 2020 2023  st:2112 or.    #
-00017140: 206c 6f63 616c 686f 7374 3a32 3131 332c   localhost:2113,
-00017150: 2061 6e64 2074 6865 6e20 636f 6e6e 6563   and then connec
-00017160: 7420 746f 2061 2066 6f6c 6c6f 7765 7220  t to a follower 
-00017170: 6e6f 6465 2069 6e20 7468 6520 636c 7573  node in the clus
-00017180: 7465 722e 0a0a 2020 2020 6573 6462 3a2f  ter...    esdb:/
-00017190: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
-000171a0: 6c6f 6361 6c68 6f73 743a 3231 3131 2c6c  localhost:2111,l
-000171b0: 6f63 616c 686f 7374 3a32 3131 322c 6c6f  ocalhost:2112,lo
-000171c0: 6361 6c68 6f73 743a 3231 3133 3f4e 6f64  calhost:2113?Nod
-000171d0: 6550 7265 6665 7265 6e63 653d 666f 6c6c  ePreference=foll
-000171e0: 6f77 6572 0a0a 0a20 2020 2023 2047 6574  ower...    # Get
-000171f0: 2063 6c75 7374 6572 2069 6e66 6f20 6672   cluster info fr
-00017200: 6f6d 2061 6464 7265 7373 6573 2069 6e20  om addresses in 
-00017210: 2741 2720 7265 636f 7264 7320 666f 7220  'A' records for 
-00017220: 636c 7573 7465 7231 2e65 7861 6d70 6c65  cluster1.example
-00017230: 2e63 6f6d 2c0a 2020 2020 2320 616e 6420  .com,.    # and 
-00017240: 636f 6e66 6967 7572 6520 226b 6565 7020  configure "keep 
-00017250: 616c 6976 6522 2074 696d 656f 7574 2061  alive" timeout a
-00017260: 6e64 2069 6e74 6572 7661 6c20 696e 2074  nd interval in t
-00017270: 6865 2067 5250 4320 6368 616e 6e65 6c2e  he gRPC channel.
-00017280: 0a0a 2020 2020 6573 6462 2b64 6973 636f  ..    esdb+disco
-00017290: 7665 723a 2f2f 6164 6d69 6e3a 6368 616e  ver://admin:chan
-000172a0: 6765 6974 4063 6c75 7374 6572 312e 6578  geit@cluster1.ex
-000172b0: 616d 706c 652e 636f 6d3f 4b65 6570 416c  ample.com?KeepAl
-000172c0: 6976 6549 6e74 6572 7661 6c3d 3130 3030  iveInterval=1000
-000172d0: 3026 4b65 6570 416c 6976 6554 696d 656f  0&KeepAliveTimeo
-000172e0: 7574 3d31 3030 3030 0a0a 0a50 6c65 6173  ut=10000...Pleas
-000172f0: 6520 6e6f 7465 2c20 7468 6520 636c 6965  e note, the clie
-00017300: 6e74 2069 7320 696e 7365 6e73 6974 6976  nt is insensitiv
-00017310: 6520 746f 2074 6865 2063 6173 6520 6f66  e to the case of
-00017320: 2066 6965 6c64 7320 616e 6420 7661 6c75   fields and valu
-00017330: 6573 2e20 4966 2066 6965 6c64 7320 6172  es. If fields ar
-00017340: 650a 7265 7065 6174 6564 2069 6e20 7468  e.repeated in th
-00017350: 6520 7175 6572 7920 7374 7269 6e67 2c20  e query string, 
-00017360: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
-00017370: 2077 696c 6c20 6265 2070 6172 7365 6420   will be parsed 
-00017380: 7769 7468 6f75 7420 6572 726f 722e 2048  without error. H
-00017390: 6f77 6576 6572 2c0a 7468 6520 636f 6e6e  owever,.the conn
-000173a0: 6563 7469 6f6e 206f 7074 696f 6e73 2075  ection options u
-000173b0: 7365 6420 6279 2074 6865 2063 6c69 656e  sed by the clien
-000173c0: 7420 7769 6c6c 2075 7365 2074 6865 2076  t will use the v
-000173d0: 616c 7565 206f 6620 7468 6520 6669 7273  alue of the firs
-000173e0: 7420 6669 656c 642e 2041 6c6c 0a74 6865  t field. All.the
-000173f0: 206f 7468 6572 2066 6965 6c64 2d76 616c   other field-val
-00017400: 7565 7320 696e 2074 6865 2071 7565 7279  ues in the query
-00017410: 2073 7472 696e 6720 7769 7468 2074 6865   string with the
-00017420: 2073 616d 6520 6669 656c 6420 6e61 6d65   same field name
-00017430: 2077 696c 6c20 6265 2069 676e 6f72 6564   will be ignored
-00017440: 2e0a 4669 656c 6473 2077 6974 686f 7574  ..Fields without
-00017450: 2076 616c 7565 7320 7769 6c6c 2061 6c73   values will als
-00017460: 6f20 6265 2069 676e 6f72 6564 2e0a 0a49  o be ignored...I
-00017470: 6620 7468 6520 636c 6965 6e74 2773 206e  f the client's n
-00017480: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
-00017490: 7320 226c 6561 6465 7222 2061 6e64 2074  s "leader" and t
-000174a0: 6865 206e 6f64 6520 6265 636f 6d65 7320  he node becomes 
-000174b0: 610a 2266 6f6c 6c6f 7765 7222 2c20 7468  a."follower", th
-000174c0: 6520 636c 6965 6e74 2077 696c 6c20 6174  e client will at
-000174d0: 7465 6d70 7420 746f 2072 6563 6f6e 6e65  tempt to reconne
-000174e0: 6374 2074 6f20 7468 6520 6375 7272 656e  ct to the curren
-000174f0: 7420 6c65 6164 6572 2077 6865 6e20 6120  t leader when a 
-00017500: 6d65 7468 6f64 0a69 7320 6361 6c6c 6564  method.is called
-00017510: 2074 6861 7420 6578 7065 6374 7320 746f   that expects to
-00017520: 2063 616c 6c20 6120 6c65 6164 6572 2e20   call a leader. 
-00017530: 4d65 7468 6f64 7320 7768 6963 6820 6d75  Methods which mu
-00017540: 7461 7465 2074 6865 2073 7461 7465 206f  tate the state o
-00017550: 6620 7468 6520 6461 7461 6261 7365 0a65  f the database.e
-00017560: 7870 6563 7420 746f 2063 616c 6c20 6120  xpect to call a 
-00017570: 6c65 6164 6572 2e20 466f 7220 7375 6368  leader. For such
-00017580: 206d 6574 686f 6473 2c20 7468 6520 4854   methods, the HT
-00017590: 5450 2068 6561 6465 7222 7265 7175 6972  TP header"requir
-000175a0: 6573 2d6c 6561 6465 7222 2069 7320 7365  es-leader" is se
-000175b0: 7420 746f 0a22 7472 7565 222c 2061 6e64  t to."true", and
-000175c0: 2074 6869 7320 6865 6164 6572 2069 7320   this header is 
-000175d0: 6f62 7365 7276 6564 2062 7920 7468 6520  observed by the 
-000175e0: 7365 7276 6572 2c20 616e 6420 736f 2061  server, and so a
-000175f0: 206e 6f64 6520 7768 6963 6820 6973 206e   node which is n
-00017600: 6f74 2061 206c 6561 6465 720a 7468 6174  ot a leader.that
-00017610: 2072 6563 6569 7665 7320 7375 6368 2061   receives such a
-00017620: 2072 6571 7565 7374 2077 696c 6c20 7265   request will re
-00017630: 7475 726e 2061 6e20 6572 726f 722e 2054  turn an error. T
-00017640: 6869 7320 6572 726f 7220 6973 2064 6574  his error is det
-00017650: 6563 7465 6420 6279 2074 6865 2063 6c69  ected by the cli
-00017660: 656e 742c 0a77 6869 6368 2077 696c 6c20  ent,.which will 
-00017670: 7468 656e 2063 6c6f 7365 2074 6865 2063  then close the c
-00017680: 7572 7265 6e74 2067 5250 4320 636f 6e6e  urrent gRPC conn
-00017690: 6563 7469 6f6e 2061 6e64 2063 7265 6174  ection and creat
-000176a0: 6520 6120 6e65 7720 636f 6e6e 6563 7469  e a new connecti
-000176b0: 6f6e 2074 6f20 7468 650a 6c65 6164 6572  on to the.leader
-000176c0: 2e20 5468 6520 7265 7175 6573 7420 7769  . The request wi
-000176d0: 6c6c 2074 6865 6e20 6265 2072 6574 7269  ll then be retri
-000176e0: 6564 2077 6974 6820 7468 6520 6c65 6164  ed with the lead
-000176f0: 6572 2e0a 0a49 6620 7468 6520 636c 6965  er...If the clie
-00017700: 6e74 2773 206e 6f64 6520 7072 6566 6572  nt's node prefer
-00017710: 656e 6365 2069 7320 2266 6f6c 6c6f 7765  ence is "followe
-00017720: 7222 2061 6e64 2074 6865 7265 2061 7265  r" and there are
-00017730: 206e 6f20 666f 6c6c 6f77 6572 0a6e 6f64   no follower.nod
-00017740: 6573 2069 6e20 7468 6520 636c 7573 7465  es in the cluste
-00017750: 722c 2074 6865 6e20 7468 6520 636c 6965  r, then the clie
-00017760: 6e74 2077 696c 6c20 7261 6973 6520 616e  nt will raise an
-00017770: 2065 7863 6570 7469 6f6e 2e20 5369 6d69   exception. Simi
-00017780: 6c61 726c 792c 2069 6620 7468 650a 636c  larly, if the.cl
-00017790: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
-000177a0: 6572 656e 6365 2069 7320 2272 6561 646f  erence is "reado
-000177b0: 6e6c 7972 6570 6c69 6361 2220 616e 6420  nlyreplica" and 
-000177c0: 7468 6572 6520 6172 6520 6e6f 2072 6561  there are no rea
-000177d0: 642d 6f6e 6c79 2072 6570 6c69 6361 0a6e  d-only replica.n
-000177e0: 6f64 6573 2069 6e20 7468 6520 636c 7573  odes in the clus
-000177f0: 7465 722c 2074 6865 6e20 7468 6520 636c  ter, then the cl
-00017800: 6965 6e74 2077 696c 6c20 616c 736f 2072  ient will also r
-00017810: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
-00017820: 6e2e 0a0a 5468 6520 6752 5043 2063 6861  n...The gRPC cha
-00017830: 6e6e 656c 206f 7074 696f 6e20 2267 7270  nnel option "grp
-00017840: 632e 6d61 785f 7265 6365 6976 655f 6d65  c.max_receive_me
-00017850: 7373 6167 655f 6c65 6e67 7468 2220 6973  ssage_length" is
-00017860: 2061 7574 6f6d 6174 6963 616c 6c79 0a63   automatically.c
-00017870: 6f6e 6669 6775 7265 6420 746f 2074 6865  onfigured to the
-00017880: 2076 616c 7565 2060 3137 202a 2031 3032   value `17 * 102
-00017890: 3420 2a20 3130 3234 602e 2054 6869 7320  4 * 1024`. This 
-000178a0: 7661 6c75 6520 6361 6e6e 6f74 2062 6520  value cannot be 
-000178b0: 6368 616e 6765 642e 0a0a 0a23 2323 2052  changed....### R
-000178c0: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-000178d0: 6e20 6669 6c74 6572 730a 0a54 6865 2066  n filters..The f
-000178e0: 696c 7465 7220 6172 6775 6d65 6e74 7320  ilter arguments 
-000178f0: 696e 2060 7265 6164 5f61 6c6c 5f65 7665  in `read_all_eve
-00017900: 6e74 7328 2960 2c20 6073 7562 7363 7269  nts()`, `subscri
-00017910: 6265 5f61 6c6c 5f65 7665 6e74 7328 2960  be_all_events()`
-00017920: 2c0a 6063 7265 6174 655f 7375 6273 6372  ,.`create_subscr
-00017930: 6970 7469 6f6e 2829 6020 616e 6420 6067  iption()` and `g
-00017940: 6574 5f63 6f6d 6d69 745f 706f 7369 7469  et_commit_positi
-00017950: 6f6e 2829 6020 6172 6520 6170 706c 6965  on()` are applie
-00017960: 6420 746f 2074 6865 2060 7479 7065 600a  d to the `type`.
-00017970: 6174 7472 6962 7574 6520 6f66 2072 6563  attribute of rec
-00017980: 6f72 6465 6420 6576 656e 7473 2e0a 0a54  orded events...T
-00017990: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-000179a0: 206f 6620 7468 6520 6066 696c 7465 725f   of the `filter_
-000179b0: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
-000179c0: 7473 2069 7320 6465 7369 676e 6564 2074  ts is designed t
-000179d0: 6f20 6578 636c 7564 650a 4576 656e 7453  o exclude.EventS
-000179e0: 746f 7265 4442 2022 7379 7374 656d 2220  toreDB "system" 
-000179f0: 616e 6420 2270 6572 7369 7374 656e 6365  and "persistence
-00017a00: 2073 7562 7363 7269 7074 696f 6e20 636f   subscription co
-00017a10: 6e66 6967 2220 6576 656e 7473 2c20 7768  nfig" events, wh
-00017a20: 6963 680a 6f74 6865 7277 6973 6520 776f  ich.otherwise wo
-00017a30: 756c 6420 6265 2069 6e63 6c75 6465 642e  uld be included.
-00017a40: 2053 7973 7465 6d20 6576 656e 7473 2067   System events g
-00017a50: 656e 6572 6174 6564 2062 7920 4576 656e  enerated by Even
-00017a60: 7453 746f 7265 4442 2061 6c6c 0a68 6176  tStoreDB all.hav
-00017a70: 6520 6074 7970 6560 2073 7472 696e 6773  e `type` strings
-00017a80: 2074 6861 7420 7374 6172 7420 7769 7468   that start with
-00017a90: 2074 6865 2060 2460 2073 6967 6e2e 2050   the `$` sign. P
-00017aa0: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-00017ab0: 7269 7074 696f 6e0a 6576 656e 7473 2067  ription.events g
-00017ac0: 656e 6572 6174 6564 2077 6865 6e20 6d61  enerated when ma
-00017ad0: 6e69 7075 6c61 7469 6e67 2070 6572 7369  nipulating persi
-00017ae0: 7374 656e 6365 2073 7562 7363 7269 7074  stence subscript
-00017af0: 696f 6e73 2061 6c6c 2068 6176 6520 6074  ions all have `t
-00017b00: 7970 6560 0a73 7472 696e 6773 2074 6861  ype`.strings tha
-00017b10: 7420 7374 6172 7420 7769 7468 2060 5065  t start with `Pe
-00017b20: 7273 6973 7465 6e74 436f 6e66 6967 602e  rsistentConfig`.
-00017b30: 0a0a 466f 7220 6578 616d 706c 652c 2074  ..For example, t
-00017b40: 6f20 6d61 7463 6820 7468 6520 7479 7065  o match the type
-00017b50: 206f 6620 4576 656e 7453 746f 7265 4442   of EventStoreDB
-00017b60: 2073 7973 7465 6d20 6576 656e 7473 2c20   system events, 
-00017b70: 7573 6520 7468 6520 7265 6775 6c61 720a  use the regular.
-00017b80: 6578 7072 6573 7369 6f6e 2060 7227 5c24  expression `r'\$
-00017b90: 2e2b 2760 2e20 506c 6561 7365 206e 6f74  .+'`. Please not
-00017ba0: 652c 2074 6865 2063 6f6e 7374 616e 7420  e, the constant 
-00017bb0: 6045 5344 425f 5359 5354 454d 5f45 5645  `ESDB_SYSTEM_EVE
-00017bc0: 4e54 535f 5245 4745 5860 2069 730a 7365  NTS_REGEX` is.se
-00017bd0: 7420 746f 2060 7227 5c24 2e2b 2760 2e20  t to `r'\$.+'`. 
-00017be0: 596f 7520 6361 6e20 696d 706f 7274 2074  You can import t
-00017bf0: 6869 7320 7661 6c75 650a 2860 6672 6f6d  his value.(`from
-00017c00: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-00017c10: 7274 2045 5344 425f 5359 5354 454d 5f45  rt ESDB_SYSTEM_E
-00017c20: 5645 4e54 535f 5245 4745 5860 2920 616e  VENTS_REGEX`) an
-00017c30: 6420 7573 650a 6974 2077 6865 6e20 6275  d use.it when bu
-00017c40: 696c 6469 6e67 206c 6f6e 6765 7220 7365  ilding longer se
-00017c50: 7175 656e 6365 7320 6f66 2072 6567 756c  quences of regul
-00017c60: 6172 2065 7870 7265 7373 696f 6e73 2e0a  ar expressions..
-00017c70: 0a53 696d 696c 6172 6c79 2c20 746f 206d  .Similarly, to m
-00017c80: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
-00017c90: 2045 7665 6e74 5374 6f72 6544 4220 7065   EventStoreDB pe
-00017ca0: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
-00017cb0: 6970 7469 6f6e 2065 7665 6e74 732c 2075  iption events, u
-00017cc0: 7365 2074 6865 0a72 6567 756c 6172 2065  se the.regular e
-00017cd0: 7870 7265 7373 696f 6e20 6072 2750 6572  xpression `r'Per
-00017ce0: 7369 7374 656e 7443 6f6e 6669 675c 642b  sistentConfig\d+
-00017cf0: 2760 2e20 5468 6520 636f 6e73 7461 6e74  '`. The constant
-00017d00: 2060 4553 4442 5f50 4552 5349 5354 454e   `ESDB_PERSISTEN
-00017d10: 545f 434f 4e46 4947 5f45 5645 4e54 535f  T_CONFIG_EVENTS_
-00017d20: 5245 4745 5860 0a69 7320 7365 7420 746f  REGEX`.is set to
-00017d30: 2060 7227 5065 7273 6973 7465 6e74 436f   `r'PersistentCo
-00017d40: 6e66 6967 5c64 2b27 602e 2059 6f75 2063  nfig\d+'`. You c
-00017d50: 616e 2061 6c73 6f20 696d 706f 7274 2074  an also import t
-00017d60: 6869 7320 7661 6c75 650a 2860 6672 6f6d  his value.(`from
-00017d70: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-00017d80: 7274 2045 5344 425f 5045 5253 4953 5445  rt ESDB_PERSISTE
-00017d90: 4e54 5f43 4f4e 4649 475f 4556 454e 5453  NT_CONFIG_EVENTS
-00017da0: 5f52 4547 4558 6029 2061 6e64 2075 7365  _REGEX`) and use
-00017db0: 2069 7420 7768 656e 2062 7569 6c64 696e   it when buildin
-00017dc0: 670a 6c6f 6e67 6572 2073 6571 7565 6e63  g.longer sequenc
-00017dd0: 6573 206f 6620 7265 6775 6c61 7220 6578  es of regular ex
-00017de0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
-00017df0: 636f 6e73 7461 6e74 2060 4445 4641 554c  constant `DEFAUL
-00017e00: 545f 4558 434c 5544 455f 4649 4c54 4552  T_EXCLUDE_FILTER
-00017e10: 6020 6973 2061 2073 6571 7565 6e63 6520  ` is a sequence 
-00017e20: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
-00017e30: 7373 696f 6e73 2074 6861 7420 6d61 7463  ssions that matc
-00017e40: 680a 7468 6520 6576 656e 7473 2074 6861  h.the events tha
-00017e50: 7420 4576 656e 7453 746f 7265 4442 2067  t EventStoreDB g
-00017e60: 656e 6572 6174 6573 2069 6e74 6572 6e61  enerates interna
-00017e70: 6c6c 792c 2065 7665 6e74 7320 7468 6174  lly, events that
-00017e80: 2061 7265 2065 7874 7261 6e65 6f75 7320   are extraneous 
-00017e90: 746f 2074 686f 7365 0a77 6869 6368 2079  to those.which y
-00017ea0: 6f75 2061 7070 656e 6420 7573 696e 6720  ou append using 
-00017eb0: 7468 6520 6061 7070 656e 645f 6576 656e  the `append_even
-00017ec0: 7473 2829 6020 6d65 7468 6f64 2e0a 0a0a  ts()` method....
-00017ed0: 2323 2320 4e65 7720 6576 656e 7420 6f62  ### New event ob
-00017ee0: 6a65 6374 730a 0a54 6865 2060 4e65 7745  jects..The `NewE
-00017ef0: 7665 6e74 6020 636c 6173 7320 6973 2075  vent` class is u
-00017f00: 7365 6420 7768 656e 2061 7070 656e 6469  sed when appendi
-00017f10: 6e67 2065 7665 6e74 732e 0a0a 5468 6520  ng events...The 
-00017f20: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00017f30: 7420 6074 7970 6560 2069 7320 6120 5079  t `type` is a Py
-00017f40: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
-00017f50: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00017f60: 2074 7970 6520 6f66 0a74 6865 2065 7665   type of.the eve
-00017f70: 6e74 2074 6861 7420 7769 6c6c 2062 6520  nt that will be 
-00017f80: 7265 636f 7264 6564 2e0a 0a54 6865 2072  recorded...The r
-00017f90: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-00017fa0: 2060 6461 7461 6020 6973 2061 2050 7974   `data` is a Pyt
-00017fb0: 686f 6e20 6062 7974 6573 6020 6f62 6a65  hon `bytes` obje
-00017fc0: 6374 2c20 7573 6564 2074 6f20 696e 6469  ct, used to indi
-00017fd0: 6361 7465 2074 6865 2064 6174 6120 6f66  cate the data of
-00017fe0: 0a74 6865 2065 7665 6e74 2074 6861 7420  .the event that 
-00017ff0: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
-00018000: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00018010: 6172 6775 6d65 6e74 2060 6d65 7461 6461  argument `metada
-00018020: 7461 6020 6973 2061 2050 7974 686f 6e20  ta` is a Python 
-00018030: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
-00018040: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
-00018050: 2061 6e79 0a6d 6574 6164 6174 6120 6f66   any.metadata of
-00018060: 2074 6865 2065 7665 6e74 2074 6861 7420   the event that 
-00018070: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
-00018080: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
-00018090: 6c75 6520 6973 2061 6e20 656d 7074 7920  lue is an empty 
-000180a0: 6062 7974 6573 600a 6f62 6a65 6374 2e0a  `bytes`.object..
-000180b0: 0a54 6865 206f 7074 696f 6e61 6c20 6172  .The optional ar
-000180c0: 6775 6d65 6e74 2060 636f 6e74 656e 745f  gument `content_
-000180d0: 7479 7065 6020 6973 2061 2050 7974 686f  type` is a Pytho
-000180e0: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
-000180f0: 2069 6e64 6963 6174 6520 7468 650a 7479   indicate the.ty
-00018100: 7065 206f 6620 7468 6520 6461 7461 2074  pe of the data t
-00018110: 6861 7420 7769 6c6c 2062 6520 7265 636f  hat will be reco
-00018120: 7264 6564 2066 6f72 2074 6869 7320 6576  rded for this ev
-00018130: 656e 742e 2054 6865 2064 6566 6175 6c74  ent. The default
-00018140: 2076 616c 7565 2069 730a 6061 7070 6c69   value is.`appli
-00018150: 6361 7469 6f6e 2f6a 736f 6e60 2c20 7768  cation/json`, wh
-00018160: 6963 6820 696e 6469 6361 7465 7320 7468  ich indicates th
-00018170: 6174 2074 6865 2060 6461 7461 6020 7761  at the `data` wa
-00018180: 7320 7365 7269 616c 6973 6564 2075 7369  s serialised usi
-00018190: 6e67 204a 534f 4e2e 0a41 6e20 616c 7465  ng JSON..An alte
-000181a0: 726e 6174 6976 6520 7661 6c75 6520 666f  rnative value fo
-000181b0: 7220 7468 6973 2061 7267 756d 656e 7420  r this argument 
-000181c0: 6973 2060 6170 706c 6963 6174 696f 6e2f  is `application/
-000181d0: 6f63 7465 742d 7374 7265 616d 602e 0a0a  octet-stream`...
-000181e0: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
-000181f0: 756d 656e 7420 6069 6460 2069 7320 6120  ument `id` is a 
-00018200: 5079 7468 6f6e 2060 5555 4944 6020 6f62  Python `UUID` ob
-00018210: 6a65 6374 2c20 7573 6564 2074 6f20 7370  ject, used to sp
-00018220: 6563 6966 7920 7468 6520 756e 6971 7565  ecify the unique
-00018230: 2049 440a 6f66 2074 6865 2065 7665 6e74   ID.of the event
-00018240: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
-00018250: 636f 7264 6564 2e20 5468 6973 2076 616c  corded. This val
-00018260: 7565 2077 696c 6c20 6465 6661 756c 7420  ue will default 
-00018270: 746f 2061 206e 6577 2076 6572 7369 6f6e  to a new version
-00018280: 2d34 2055 5549 442e 0a0a 6060 6070 7974  -4 UUID...```pyt
-00018290: 686f 6e0a 6e65 775f 6576 656e 7431 203d  hon.new_event1 =
-000182a0: 204e 6577 4576 656e 7428 0a20 2020 2074   NewEvent(.    t
-000182b0: 7970 653d 274f 7264 6572 4372 6561 7465  ype='OrderCreate
-000182c0: 6427 2c0a 2020 2020 6461 7461 3d62 277b  d',.    data=b'{
-000182d0: 226e 616d 6522 3a20 2247 7265 6722 7d27  "name": "Greg"}'
-000182e0: 2c0a 290a 6173 7365 7274 206e 6577 5f65  ,.).assert new_e
-000182f0: 7665 6e74 312e 7479 7065 203d 3d20 274f  vent1.type == 'O
-00018300: 7264 6572 4372 6561 7465 6427 0a61 7373  rderCreated'.ass
-00018310: 6572 7420 6e65 775f 6576 656e 7431 2e64  ert new_event1.d
-00018320: 6174 6120 3d3d 2062 277b 226e 616d 6522  ata == b'{"name"
-00018330: 3a20 2247 7265 6722 7d27 0a61 7373 6572  : "Greg"}'.asser
-00018340: 7420 6e65 775f 6576 656e 7431 2e6d 6574  t new_event1.met
-00018350: 6164 6174 6120 3d3d 2062 2727 0a61 7373  adata == b''.ass
-00018360: 6572 7420 6e65 775f 6576 656e 7431 2e63  ert new_event1.c
-00018370: 6f6e 7465 6e74 5f74 7970 6520 3d3d 2027  ontent_type == '
-00018380: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
-00018390: 270a 6173 7365 7274 2069 7369 6e73 7461  '.assert isinsta
-000183a0: 6e63 6528 6e65 775f 6576 656e 7431 2e69  nce(new_event1.i
-000183b0: 642c 2055 5549 4429 0a0a 6576 656e 745f  d, UUID)..event_
-000183c0: 6964 203d 2075 7569 6434 2829 0a6e 6577  id = uuid4().new
-000183d0: 5f65 7665 6e74 3220 3d20 4e65 7745 7665  _event2 = NewEve
-000183e0: 6e74 280a 2020 2020 7479 7065 3d27 496d  nt(.    type='Im
-000183f0: 6167 6543 7265 6174 6564 272c 0a20 2020  ageCreated',.   
-00018400: 2064 6174 613d 6227 3031 3031 3031 3031   data=b'01010101
-00018410: 3031 3031 3031 272c 0a20 2020 206d 6574  010101',.    met
-00018420: 6164 6174 613d 6227 7b22 6122 3a20 317d  adata=b'{"a": 1}
-00018430: 272c 0a20 2020 2063 6f6e 7465 6e74 5f74  ',.    content_t
-00018440: 7970 653d 2761 7070 6c69 6361 7469 6f6e  ype='application
-00018450: 2f6f 6374 6574 2d73 7472 6561 6d27 2c0a  /octet-stream',.
-00018460: 2020 2020 6964 3d65 7665 6e74 5f69 642c      id=event_id,
-00018470: 0a29 0a61 7373 6572 7420 6e65 775f 6576  .).assert new_ev
-00018480: 656e 7432 2e74 7970 6520 3d3d 2027 496d  ent2.type == 'Im
-00018490: 6167 6543 7265 6174 6564 270a 6173 7365  ageCreated'.asse
-000184a0: 7274 206e 6577 5f65 7665 6e74 322e 6461  rt new_event2.da
-000184b0: 7461 203d 3d20 6227 3031 3031 3031 3031  ta == b'01010101
-000184c0: 3031 3031 3031 270a 6173 7365 7274 206e  010101'.assert n
-000184d0: 6577 5f65 7665 6e74 322e 6d65 7461 6461  ew_event2.metada
-000184e0: 7461 203d 3d20 6227 7b22 6122 3a20 317d  ta == b'{"a": 1}
-000184f0: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
-00018500: 6e74 322e 636f 6e74 656e 745f 7479 7065  nt2.content_type
-00018510: 203d 3d20 2761 7070 6c69 6361 7469 6f6e   == 'application
-00018520: 2f6f 6374 6574 2d73 7472 6561 6d27 0a61  /octet-stream'.a
-00018530: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
-00018540: 2e69 6420 3d3d 2065 7665 6e74 5f69 640a  .id == event_id.
-00018550: 6060 600a 0a23 2323 2052 6563 6f72 6465  ```..### Recorde
-00018560: 6420 6576 656e 7420 6f62 6a65 6374 730a  d event objects.
-00018570: 0a54 6865 2060 5265 636f 7264 6564 4576  .The `RecordedEv
-00018580: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
-00018590: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
-000185a0: 6576 656e 7473 2e0a 0a54 6865 2061 7474  events...The att
-000185b0: 7269 6275 7465 2060 7479 7065 6020 6973  ribute `type` is
-000185c0: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
-000185d0: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-000185e0: 6520 7468 6520 7479 7065 206f 6620 6576  e the type of ev
-000185f0: 656e 740a 7468 6174 2077 6173 2072 6563  ent.that was rec
-00018600: 6f72 6465 642e 0a0a 5468 6520 6174 7472  orded...The attr
-00018610: 6962 7574 6520 6064 6174 6160 2069 7320  ibute `data` is 
-00018620: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
-00018630: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
-00018640: 2069 6e64 6963 6174 6520 7468 6520 6461   indicate the da
-00018650: 7461 206f 6620 7468 650a 6576 656e 7420  ta of the.event 
-00018660: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
-00018670: 642e 0a0a 5468 6520 6174 7472 6962 7574  d...The attribut
-00018680: 6520 606d 6574 6164 6174 6160 2069 7320  e `metadata` is 
-00018690: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
-000186a0: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
-000186b0: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
-000186c0: 7461 6461 7461 206f 660a 7468 6520 6576  tadata of.the ev
-000186d0: 656e 7420 7468 6174 2077 6173 2072 6563  ent that was rec
-000186e0: 6f72 6465 642e 0a0a 5468 6520 6174 7472  orded...The attr
-000186f0: 6962 7574 6520 6063 6f6e 7465 6e74 5f74  ibute `content_t
-00018700: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
-00018710: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
-00018720: 696e 6469 6361 7465 2074 6865 2074 7970  indicate the typ
-00018730: 6520 6f66 0a64 6174 6120 7468 6174 2077  e of.data that w
-00018740: 6173 2072 6563 6f72 6465 6420 666f 7220  as recorded for 
-00018750: 7468 6973 2065 7665 6e74 2028 7573 7561  this event (usua
-00018760: 6c6c 7920 6061 7070 6c69 6361 7469 6f6e  lly `application
-00018770: 2f6a 736f 6e60 2074 6f20 696e 6469 6361  /json` to indica
-00018780: 7465 2074 6861 740a 7468 6973 2064 6174  te that.this dat
-00018790: 6120 6361 6e20 6265 2070 6172 7365 6420  a can be parsed 
-000187a0: 6173 204a 534f 4e2c 2062 7574 2061 6c74  as JSON, but alt
-000187b0: 6572 6e61 7469 7665 6c79 2060 6170 706c  ernatively `appl
-000187c0: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
-000187d0: 7265 616d 6020 746f 0a69 6e64 6963 6174  ream` to.indicat
-000187e0: 6520 7468 6174 2069 7420 6973 2073 6f6d  e that it is som
-000187f0: 6574 6869 6e67 2065 6c73 6529 2e0a 0a54  ething else)...T
-00018800: 6865 2061 7474 7269 6275 7465 2060 6964  he attribute `id
-00018810: 6020 6973 2061 2050 7974 686f 6e20 6055  ` is a Python `U
-00018820: 5549 4460 206f 626a 6563 742c 2075 7365  UID` object, use
-00018830: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
-00018840: 6520 756e 6971 7565 2049 4420 6f66 2074  e unique ID of t
-00018850: 6865 0a65 7665 6e74 2074 6861 7420 7761  he.event that wa
-00018860: 7320 7265 636f 7264 6564 2e20 506c 6561  s recorded. Plea
-00018870: 7365 206e 6f74 652c 2077 6865 6e20 7265  se note, when re
-00018880: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
-00018890: 6520 7265 7475 726e 6564 2066 726f 6d20  e returned from 
-000188a0: 6120 6361 6c6c 0a74 6f20 6072 6561 645f  a call.to `read_
-000188b0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-000188c0: 2069 6e20 4576 656e 7453 746f 7265 4442   in EventStoreDB
-000188d0: 2076 3231 2e31 302c 2074 6865 2063 6f6d   v21.10, the com
-000188e0: 6d69 7420 706f 7369 7469 6f6e 2069 7320  mit position is 
-000188f0: 6e6f 7420 6163 7475 616c 6c79 0a73 6574  not actually.set
-00018900: 2069 6e20 7468 6520 7265 7370 6f6e 7365   in the response
-00018910: 2e20 5468 6973 2061 7474 7269 6275 7465  . This attribute
-00018920: 2069 7320 7479 7065 6420 6173 2061 6e20   is typed as an 
-00018930: 6f70 7469 6f6e 616c 2076 616c 7565 2028  optional value (
-00018940: 604f 7074 696f 6e61 6c5b 5555 4944 5d60  `Optional[UUID]`
-00018950: 292c 0a61 6e64 2069 6e20 7468 6520 6361  ),.and in the ca
-00018960: 7365 206f 6620 7573 696e 6720 4576 656e  se of using Even
-00018970: 7453 746f 7265 4442 2076 3231 2e31 3020  tStoreDB v21.10 
-00018980: 7468 6520 7661 6c75 6520 6f66 2074 6869  the value of thi
-00018990: 7320 6174 7472 6962 7574 6520 7769 6c6c  s attribute will
-000189a0: 2062 6520 604e 6f6e 6560 0a77 6865 6e20   be `None`.when 
-000189b0: 7265 6164 696e 6720 7265 636f 7264 6564  reading recorded
-000189c0: 2065 7665 6e74 7320 6672 6f6d 2061 2073   events from a s
-000189d0: 7472 6561 6d2e 2052 6563 6f72 6465 6420  tream. Recorded 
-000189e0: 6576 656e 7473 2077 696c 6c20 686f 7765  events will howe
-000189f0: 7665 7220 6861 7665 2074 6869 730a 7661  ver have this.va
-00018a00: 6c75 6573 2073 6574 2077 6865 6e20 7265  lues set when re
-00018a10: 6164 696e 6720 7265 636f 7264 6564 2065  ading recorded e
-00018a20: 7665 6e74 7320 6672 6f6d 2060 7265 6164  vents from `read
-00018a30: 5f61 6c6c 5f65 7665 6e74 7328 2960 2061  _all_events()` a
-00018a40: 6e64 2066 726f 6d20 626f 7468 0a63 6174  nd from both.cat
-00018a50: 6368 2d75 7020 616e 6420 7065 7273 6973  ch-up and persis
-00018a60: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00018a70: 6e73 2e0a 0a54 6865 2061 7474 7269 6275  ns...The attribu
-00018a80: 7465 2060 7374 7265 616d 5f6e 616d 6560  te `stream_name`
-00018a90: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
-00018aa0: 7260 2c20 7573 6564 2074 6f20 696e 6469  r`, used to indi
-00018ab0: 6361 7465 2074 6865 206e 616d 6520 6f66  cate the name of
-00018ac0: 2074 6865 0a73 7472 6561 6d20 696e 2077   the.stream in w
-00018ad0: 6869 6368 2074 6865 2065 7665 6e74 2077  hich the event w
-00018ae0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
-00018af0: 6520 6174 7472 6962 7574 6520 6073 7472  e attribute `str
-00018b00: 6561 6d5f 706f 7369 7469 6f6e 6020 6973  eam_position` is
-00018b10: 2061 2050 7974 686f 6e20 6069 6e74 602c   a Python `int`,
-00018b20: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-00018b30: 6520 7468 6520 706f 7369 7469 6f6e 2069  e the position i
-00018b40: 6e20 7468 650a 7374 7265 616d 2061 7420  n the.stream at 
-00018b50: 7768 6963 6820 7468 6520 6576 656e 7420  which the event 
-00018b60: 7761 7320 7265 636f 7264 6564 2e0a 0a54  was recorded...T
-00018b70: 6865 2061 7474 7269 6275 7465 2060 636f  he attribute `co
-00018b80: 6d6d 6974 5f70 6f73 6974 696f 6e60 2069  mmit_position` i
-00018b90: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
-00018ba0: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-00018bb0: 7465 2074 6865 2063 6f6d 6d69 7420 706f  te the commit po
-00018bc0: 7369 7469 6f6e 0a61 7420 7768 6963 6820  sition.at which 
-00018bd0: 7468 6520 6576 656e 7420 7761 7320 7265  the event was re
-00018be0: 636f 7264 6564 2e0a 0a60 6060 7079 7468  corded...```pyth
-00018bf0: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
-00018c00: 6e74 2e65 7665 6e74 7320 696d 706f 7274  nt.events import
-00018c10: 2052 6563 6f72 6465 6445 7665 6e74 0a0a   RecordedEvent..
-00018c20: 7265 636f 7264 6564 5f65 7665 6e74 203d  recorded_event =
-00018c30: 2052 6563 6f72 6465 6445 7665 6e74 280a   RecordedEvent(.
-00018c40: 2020 2020 7479 7065 3d27 4f72 6465 7243      type='OrderC
-00018c50: 7265 6174 6564 272c 0a20 2020 2064 6174  reated',.    dat
-00018c60: 613d 6227 7b7d 272c 0a20 2020 206d 6574  a=b'{}',.    met
-00018c70: 6164 6174 613d 6227 272c 0a20 2020 2063  adata=b'',.    c
-00018c80: 6f6e 7465 6e74 5f74 7970 653d 2761 7070  ontent_type='app
-00018c90: 6c69 6361 7469 6f6e 2f6a 736f 6e27 2c0a  lication/json',.
-00018ca0: 2020 2020 6964 3d75 7569 6434 2829 2c0a      id=uuid4(),.
-00018cb0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-00018cc0: 2773 7472 6561 6d31 272c 0a20 2020 2073  'stream1',.    s
-00018cd0: 7472 6561 6d5f 706f 7369 7469 6f6e 3d30  tream_position=0
-00018ce0: 2c0a 2020 2020 636f 6d6d 6974 5f70 6f73  ,.    commit_pos
-00018cf0: 6974 696f 6e3d 3531 322c 0a29 0a60 6060  ition=512,.).```
-00018d00: 0a0a 2323 2320 4173 796e 6369 6f20 636c  ..### Asyncio cl
-00018d10: 6965 6e74 0a0a 5468 6520 6065 7364 6263  ient..The `esdbc
-00018d20: 6c69 656e 7460 2070 6163 6b61 6765 2061  lient` package a
-00018d30: 6c73 6f20 696e 636c 7564 6573 2061 6e20  lso includes an 
-00018d40: 6561 726c 7920 7665 7273 696f 6e20 6f66  early version of
-00018d50: 2061 6e20 6173 796e 6368 726f 6e6f 7573   an asynchronous
-00018d60: 2049 2f4f 0a67 5250 4320 5079 7468 6f6e   I/O.gRPC Python
-00018d70: 2063 6c69 656e 742e 2049 7420 666f 6c6c   client. It foll
-00018d80: 6f77 7320 6578 6163 746c 7920 7468 6520  ows exactly the 
-00018d90: 7361 6d65 2062 6568 6176 696f 7273 2061  same behaviors a
-00018da0: 7320 7468 6520 6d75 6c74 6974 6872 6561  s the multithrea
-00018db0: 6465 640a 6045 5344 4243 6c69 656e 7460  ded.`ESDBClient`
-00018dc0: 2c20 6275 7420 7573 6573 2074 6865 2060  , but uses the `
-00018dd0: 6772 7063 2e61 696f 6020 7061 636b 6167  grpc.aio` packag
-00018de0: 6520 616e 6420 7468 6520 6061 7379 6e63  e and the `async
-00018df0: 696f 6020 6d6f 6475 6c65 2c20 696e 7374  io` module, inst
-00018e00: 6561 6420 6f66 0a60 6772 7063 6020 616e  ead of.`grpc` an
-00018e10: 6420 6074 6872 6561 6469 6e67 602e 0a0a  d `threading`...
-00018e20: 5468 6520 6061 7379 6e63 6020 6675 6e63  The `async` func
-00018e30: 7469 6f6e 2060 4173 796e 6369 6f45 5344  tion `AsyncioESD
-00018e40: 4243 6c69 656e 7460 2063 6f6e 7374 7275  BClient` constru
-00018e50: 6374 7320 7468 6520 636c 6965 6e74 2c20  cts the client, 
-00018e60: 616e 6420 636f 6e6e 6563 7473 2074 6f0a  and connects to.
-00018e70: 6120 7365 7276 6572 2e20 4974 2063 616e  a server. It can
-00018e80: 2062 6520 696d 706f 7274 6564 2066 726f   be imported fro
-00018e90: 6d20 6065 7364 6263 6c69 656e 7460 2c20  m `esdbclient`, 
-00018ea0: 616e 6420 6361 6e20 6265 2063 616c 6c65  and can be calle
-00018eb0: 6420 7769 7468 2074 6865 2073 616d 650a  d with the same.
-00018ec0: 6172 6775 6d65 6e74 7320 6173 2060 4553  arguments as `ES
-00018ed0: 4442 436c 6965 6e74 602e 2049 7420 7375  DBClient`. It su
-00018ee0: 7070 6f72 7473 2062 6f74 6820 7468 6520  pports both the 
-00018ef0: 2265 7364 6222 2061 6e64 2074 6865 2022  "esdb" and the "
-00018f00: 6573 6462 2b64 6973 636f 7665 7222 0a63  esdb+discover".c
-00018f10: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00018f20: 2055 5249 2073 6368 656d 6573 2c20 616e   URI schemes, an
-00018f30: 6420 7265 636f 6e6e 6563 7473 2061 6e64  d reconnects and
-00018f40: 2072 6574 7269 6573 206d 6574 686f 6473   retries methods
-00018f50: 2077 6865 6e20 636f 6e6e 6563 7469 6f6e   when connection
-00018f60: 0a69 7373 7565 7320 6172 6520 656e 636f  .issues are enco
-00018f70: 756e 7465 7265 642c 206a 7573 7420 6c69  untered, just li
-00018f80: 6b65 2060 4553 4442 436c 6965 6e74 602e  ke `ESDBClient`.
-00018f90: 0a0a 6060 6070 7974 686f 6e0a 6672 6f6d  ..```python.from
-00018fa0: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-00018fb0: 7274 2041 7379 6e63 696f 4553 4442 436c  rt AsyncioESDBCl
-00018fc0: 6965 6e74 0a60 6060 0a0a 5468 6520 6173  ient.```..The as
-00018fd0: 796e 6368 726f 6e6f 7573 2049 2f4f 2063  ynchronous I/O c
-00018fe0: 6c69 656e 7420 6861 7320 6061 7379 6e63  lient has `async
-00018ff0: 6020 6d65 7468 6f64 7320 6061 7070 656e  ` methods `appen
-00019000: 645f 6576 656e 7473 2829 602c 0a60 7265  d_events()`,.`re
-00019010: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00019020: 2829 602c 2060 7265 6164 5f61 6c6c 5f65  ()`, `read_all_e
-00019030: 7665 6e74 7328 2960 2c20 6073 7562 7363  vents()`, `subsc
-00019040: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
-00019050: 2960 2c0a 6064 656c 6574 655f 7374 7265  )`,.`delete_stre
-00019060: 616d 2829 602c 2060 746f 6d62 7374 6f6e  am()`, `tombston
-00019070: 655f 7374 7265 616d 2829 602c 2061 6e64  e_stream()`, and
-00019080: 2060 7265 636f 6e6e 6563 7428 2960 2e0a   `reconnect()`..
-00019090: 0a54 6865 7365 206d 6574 686f 6473 2061  .These methods a
-000190a0: 7265 2065 7175 6976 616c 656e 7420 746f  re equivalent to
-000190b0: 2074 6865 206d 6574 686f 6473 206f 6e20   the methods on 
-000190c0: 6045 5344 4243 6c69 656e 7460 2e20 5468  `ESDBClient`. Th
-000190d0: 6579 2068 6176 6520 7468 6520 7361 6d65  ey have the same
-000190e0: 0a6d 6574 686f 6420 7369 676e 6174 7572  .method signatur
-000190f0: 6573 2c20 616e 6420 6361 6e20 6265 2063  es, and can be c
-00019100: 616c 6c65 6420 7769 7468 2074 6865 2073  alled with the s
-00019110: 616d 6520 6172 6775 6d65 6e74 732c 2074  ame arguments, t
-00019120: 6f20 7468 6520 7361 6d65 2065 6666 6563  o the same effec
-00019130: 742e 0a54 6865 206d 6574 686f 6473 2077  t..The methods w
-00019140: 6869 6368 2061 7070 6561 7220 6f6e 2060  hich appear on `
-00019150: 4553 4442 436c 6965 6e74 6020 6275 7420  ESDBClient` but 
-00019160: 6e6f 7420 6f6e 2060 4173 796e 6369 6f45  not on `AsyncioE
-00019170: 5344 4243 6c69 656e 7460 2077 696c 6c20  SDBClient` will 
-00019180: 6265 0a61 6464 6564 2073 6f6f 6e2e 0a0a  be.added soon...
-00019190: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-000191a0: 7720 6465 6d6f 6e73 7472 6174 6573 2074  w demonstrates t
-000191b0: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
-000191c0: 7328 2960 2c20 6072 6561 645f 7374 7265  s()`, `read_stre
-000191d0: 616d 5f65 7665 6e74 7328 2960 2061 6e64  am_events()` and
-000191e0: 0a60 7375 6273 6372 6962 655f 616c 6c5f  .`subscribe_all_
-000191f0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
-00019200: 732e 2054 6865 7365 2061 7265 2074 6865  s. These are the
-00019210: 206d 6f73 7420 7573 6566 756c 206d 6574   most useful met
-00019220: 686f 6473 2066 6f72 2077 7269 7469 6e67  hods for writing
-00019230: 0a61 6e20 6576 656e 742d 736f 7572 6365  .an event-source
-00019240: 6420 6170 706c 6963 6174 696f 6e2c 2061  d application, a
-00019250: 6c6c 6f77 696e 6720 6e65 7720 6167 6772  llowing new aggr
-00019260: 6567 6174 6520 6576 656e 7473 2074 6f20  egate events to 
-00019270: 6265 2072 6563 6f72 6465 642c 2074 6865  be recorded, the
-00019280: 0a72 6563 6f72 6465 6420 6576 656e 7473  .recorded events
-00019290: 206f 6620 616e 2061 6767 7265 6761 7465   of an aggregate
-000192a0: 2074 6f20 6265 206f 6274 6169 6e65 6420   to be obtained 
-000192b0: 736f 2061 6767 7265 6761 7465 7320 6361  so aggregates ca
-000192c0: 6e20 6265 2072 6563 6f6e 7374 7275 6374  n be reconstruct
-000192d0: 6564 2c0a 616e 6420 7468 6520 7374 6174  ed,.and the stat
-000192e0: 6520 6f66 2061 6e20 6170 706c 6963 6174  e of an applicat
-000192f0: 696f 6e20 746f 2070 726f 7061 6761 7465  ion to propagate
-00019300: 6420 616e 6420 7072 6f63 6573 7365 6420  d and processed 
-00019310: 7769 7468 2022 6578 6163 746c 792d 6f6e  with "exactly-on
-00019320: 6365 220a 7365 6d61 6e74 6963 732e 0a0a  ce".semantics...
-00019330: 6060 6070 7974 686f 6e0a 696d 706f 7274  ```python.import
-00019340: 2061 7379 6e63 696f 0a0a 6173 796e 6320   asyncio..async 
-00019350: 6465 6620 6465 6d6f 6e73 7472 6174 655f  def demonstrate_
-00019360: 6173 796e 6369 6f5f 636c 6965 6e74 2829  asyncio_client()
-00019370: 3a0a 0a20 2020 2023 2043 6f6e 7374 7275  :..    # Constru
-00019380: 6374 2063 6c69 656e 742e 0a20 2020 2063  ct client..    c
-00019390: 6c69 656e 7420 3d20 6177 6169 7420 4173  lient = await As
-000193a0: 796e 6369 6f45 5344 4243 6c69 656e 7428  yncioESDBClient(
-000193b0: 0a20 2020 2020 2020 2075 7269 3d6f 732e  .        uri=os.
-000193c0: 6765 7465 6e76 2822 4553 4442 5f55 5249  getenv("ESDB_URI
-000193d0: 2229 2c0a 2020 2020 2020 2020 726f 6f74  "),.        root
-000193e0: 5f63 6572 7469 6669 6361 7465 733d 6f73  _certificates=os
-000193f0: 2e67 6574 656e 7628 2245 5344 425f 524f  .getenv("ESDB_RO
-00019400: 4f54 5f43 4552 5449 4649 4341 5445 5322  OT_CERTIFICATES"
-00019410: 292c 0a20 2020 2029 0a0a 2020 2020 2320  ),.    )..    # 
-00019420: 4170 7065 6e64 2065 7665 6e74 732e 0a20  Append events.. 
-00019430: 2020 2073 7472 6561 6d5f 6e61 6d65 203d     stream_name =
-00019440: 2073 7472 2875 7569 6434 2829 290a 2020   str(uuid4()).  
-00019450: 2020 6576 656e 7431 203d 204e 6577 4576    event1 = NewEv
-00019460: 656e 7428 224f 7264 6572 4372 6561 7465  ent("OrderCreate
-00019470: 6422 2c20 6461 7461 3d62 277b 7d27 290a  d", data=b'{}').
-00019480: 2020 2020 6576 656e 7432 203d 204e 6577      event2 = New
-00019490: 4576 656e 7428 224f 7264 6572 5570 6461  Event("OrderUpda
-000194a0: 7465 6422 2c20 6461 7461 3d62 277b 7d27  ted", data=b'{}'
-000194b0: 290a 2020 2020 6576 656e 7433 203d 204e  ).    event3 = N
-000194c0: 6577 4576 656e 7428 224f 7264 6572 4465  ewEvent("OrderDe
-000194d0: 6c65 7465 6422 2c20 6461 7461 3d62 277b  leted", data=b'{
-000194e0: 7d27 290a 0a20 2020 2061 7761 6974 2063  }')..    await c
-000194f0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-00019500: 6e74 7328 0a20 2020 2020 2020 2073 7472  nts(.        str
-00019510: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00019520: 6e61 6d65 2c0a 2020 2020 2020 2020 6578  name,.        ex
-00019530: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-00019540: 4e6f 6e65 2c0a 2020 2020 2020 2020 6576  None,.        ev
-00019550: 656e 7473 3d5b 6576 656e 7431 2c20 6576  ents=[event1, ev
-00019560: 656e 7432 2c20 6576 656e 7433 5d0a 2020  ent2, event3].  
-00019570: 2020 290a 0a20 2020 2023 2052 6561 6420    )..    # Read 
-00019580: 7374 7265 616d 2065 7665 6e74 732e 0a20  stream events.. 
-00019590: 2020 2072 6563 6f72 6465 6420 3d20 6177     recorded = aw
-000195a0: 6169 7420 636c 6965 6e74 2e72 6561 645f  ait client.read_
-000195b0: 7374 7265 616d 5f65 7665 6e74 7328 7374  stream_events(st
-000195c0: 7265 616d 5f6e 616d 6529 0a20 2020 2061  ream_name).    a
-000195d0: 7373 6572 7420 6c65 6e28 7265 636f 7264  ssert len(record
-000195e0: 6564 2920 3d3d 2033 0a20 2020 2061 7373  ed) == 3.    ass
-000195f0: 6572 7420 7265 636f 7264 6564 5b30 5d2e  ert recorded[0].
-00019600: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-00019610: 2020 2020 6173 7365 7274 2072 6563 6f72      assert recor
-00019620: 6465 645b 315d 2e69 6420 3d3d 2065 7665  ded[1].id == eve
-00019630: 6e74 322e 6964 0a20 2020 2061 7373 6572  nt2.id.    asser
-00019640: 7420 7265 636f 7264 6564 5b32 5d2e 6964  t recorded[2].id
-00019650: 203d 3d20 6576 656e 7433 2e69 640a 0a0a   == event3.id...
-00019660: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
-00019670: 616c 6c20 6576 656e 7473 2e0a 2020 2020  all events..    
-00019680: 7265 6365 6976 6564 203d 205b 5d0a 2020  received = [].  
-00019690: 2020 6173 796e 6320 666f 7220 6576 656e    async for even
-000196a0: 7420 696e 2061 7761 6974 2063 6c69 656e  t in await clien
-000196b0: 742e 7375 6273 6372 6962 655f 616c 6c5f  t.subscribe_all_
-000196c0: 6576 656e 7473 2829 3a0a 2020 2020 2020  events():.      
-000196d0: 2020 7265 6365 6976 6564 2e61 7070 656e    received.appen
-000196e0: 6428 6576 656e 7429 0a20 2020 2020 2020  d(event).       
-000196f0: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
-00019700: 6576 656e 7433 2e69 643a 0a20 2020 2020  event3.id:.     
-00019710: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-00019720: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
-00019730: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
-00019740: 312e 6964 0a20 2020 2061 7373 6572 7420  1.id.    assert 
-00019750: 7265 6365 6976 6564 5b2d 325d 2e69 6420  received[-2].id 
-00019760: 3d3d 2065 7665 6e74 322e 6964 0a20 2020  == event2.id.   
-00019770: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
-00019780: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
-00019790: 332e 6964 0a0a 0a20 2020 2023 2043 6c6f  3.id...    # Clo
-000197a0: 7365 2074 6865 2063 6c69 656e 742e 0a20  se the client.. 
-000197b0: 2020 2061 7761 6974 2063 6c69 656e 742e     await client.
-000197c0: 636c 6f73 6528 290a 0a0a 2320 5275 6e20  close()...# Run 
-000197d0: 7468 6520 6465 6d6f 2e0a 6173 796e 6369  the demo..asynci
-000197e0: 6f2e 6765 745f 6576 656e 745f 6c6f 6f70  o.get_event_loop
-000197f0: 2829 2e72 756e 5f75 6e74 696c 5f63 6f6d  ().run_until_com
-00019800: 706c 6574 6528 0a20 2020 2064 656d 6f6e  plete(.    demon
-00019810: 7374 7261 7465 5f61 7379 6e63 696f 5f63  strate_asyncio_c
-00019820: 6c69 656e 7428 290a 290a 6060 600a 0a23  lient().).```..#
-00019830: 2320 436f 6e74 7269 6275 746f 7273 0a0a  # Contributors..
-00019840: 2323 2320 496e 7374 616c 6c20 506f 6574  ### Install Poet
-00019850: 7279 0a0a 5468 6520 6669 7273 7420 7468  ry..The first th
-00019860: 696e 6720 6973 2074 6f20 6368 6563 6b20  ing is to check 
-00019870: 796f 7520 6861 7665 2050 6f65 7472 7920  you have Poetry 
-00019880: 696e 7374 616c 6c65 642e 0a0a 2020 2020  installed...    
-00019890: 2420 706f 6574 7279 202d 2d76 6572 7369  $ poetry --versi
-000198a0: 6f6e 0a0a 4966 2079 6f75 2064 6f6e 2774  on..If you don't
-000198b0: 2c20 7468 656e 2070 6c65 6173 6520 5b69  , then please [i
-000198c0: 6e73 7461 6c6c 2050 6f65 7472 795d 2868  nstall Poetry](h
-000198d0: 7474 7073 3a2f 2f70 7974 686f 6e2d 706f  ttps://python-po
-000198e0: 6574 7279 2e6f 7267 2f64 6f63 732f 2369  etry.org/docs/#i
-000198f0: 6e73 7461 6c6c 696e 672d 7769 7468 2d74  nstalling-with-t
-00019900: 6865 2d6f 6666 6963 6961 6c2d 696e 7374  he-official-inst
-00019910: 616c 6c65 7229 2e0a 0a20 2020 2024 2063  aller)...    $ c
-00019920: 7572 6c20 2d73 534c 2068 7474 7073 3a2f  url -sSL https:/
-00019930: 2f69 6e73 7461 6c6c 2e70 7974 686f 6e2d  /install.python-
-00019940: 706f 6574 7279 2e6f 7267 207c 2070 7974  poetry.org | pyt
-00019950: 686f 6e33 202d 0a0a 4974 2077 696c 6c20  hon3 -..It will 
-00019960: 6865 6c70 2074 6f20 6d61 6b65 2073 7572  help to make sur
-00019970: 6520 506f 6574 7279 2773 2062 696e 2064  e Poetry's bin d
-00019980: 6972 6563 746f 7279 2069 7320 696e 2079  irectory is in y
-00019990: 6f75 7220 6050 4154 4860 2065 6e76 6972  our `PATH` envir
-000199a0: 6f6e 6d65 6e74 2076 6172 6961 626c 652e  onment variable.
-000199b0: 0a0a 4275 7420 696e 2061 6e79 2063 6173  ..But in any cas
-000199c0: 652c 206d 616b 6520 7375 7265 2079 6f75  e, make sure you
-000199d0: 206b 6e6f 7720 7468 6520 7061 7468 2074   know the path t
-000199e0: 6f20 7468 6520 6070 6f65 7472 7960 2065  o the `poetry` e
-000199f0: 7865 6375 7461 626c 652e 2054 6865 2050  xecutable. The P
-00019a00: 6f65 7472 790a 696e 7374 616c 6c65 7220  oetry.installer 
-00019a10: 7465 6c6c 7320 796f 7520 7768 6572 6520  tells you where 
-00019a20: 6974 2068 6173 2062 6565 6e20 696e 7374  it has been inst
-00019a30: 616c 6c65 642c 2061 6e64 2068 6f77 2074  alled, and how t
-00019a40: 6f20 636f 6e66 6967 7572 6520 796f 7572  o configure your
-00019a50: 2073 6865 6c6c 2e0a 0a50 6c65 6173 6520   shell...Please 
-00019a60: 7265 6665 7220 746f 2074 6865 205b 506f  refer to the [Po
-00019a70: 6574 7279 2064 6f63 735d 2868 7474 7073  etry docs](https
-00019a80: 3a2f 2f70 7974 686f 6e2d 706f 6574 7279  ://python-poetry
-00019a90: 2e6f 7267 2f64 6f63 732f 2920 666f 7220  .org/docs/) for 
-00019aa0: 6775 6964 616e 6365 206f 6e0a 7573 696e  guidance on.usin
-00019ab0: 6720 506f 6574 7279 2e0a 0a23 2323 2053  g Poetry...### S
-00019ac0: 6574 7570 2066 6f72 2050 7943 6861 726d  etup for PyCharm
-00019ad0: 2075 7365 7273 0a0a 596f 7520 6361 6e20   users..You can 
-00019ae0: 6561 7369 6c79 206f 6274 6169 6e20 7468  easily obtain th
-00019af0: 6520 7072 6f6a 6563 7420 6669 6c65 7320  e project files 
-00019b00: 7573 696e 6720 5079 4368 6172 6d20 286d  using PyCharm (m
-00019b10: 656e 7520 2247 6974 203e 2043 6c6f 6e65  enu "Git > Clone
-00019b20: 2e2e 2e22 292e 0a50 7943 6861 726d 2077  ...")..PyCharm w
-00019b30: 696c 6c20 7468 656e 2075 7375 616c 6c79  ill then usually
-00019b40: 2070 726f 6d70 7420 796f 7520 746f 206f   prompt you to o
-00019b50: 7065 6e20 7468 6520 7072 6f6a 6563 742e  pen the project.
-00019b60: 0a0a 4f70 656e 2074 6865 2070 726f 6a65  ..Open the proje
-00019b70: 6374 2069 6e20 6120 6e65 7720 7769 6e64  ct in a new wind
-00019b80: 6f77 2e20 5079 4368 6172 6d20 7769 6c6c  ow. PyCharm will
-00019b90: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
-00019ba0: 6f6d 7074 2079 6f75 2074 6f20 6372 6561  ompt you to crea
-00019bb0: 7465 0a61 206e 6577 2076 6972 7475 616c  te.a new virtual
-00019bc0: 2065 6e76 6972 6f6e 6d65 6e74 2e0a 0a43   environment...C
-00019bd0: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
-00019be0: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
-00019bf0: 6f6e 6d65 6e74 2066 6f72 2074 6865 2070  onment for the p
-00019c00: 726f 6a65 6374 2e20 4966 2050 7943 6861  roject. If PyCha
-00019c10: 726d 2064 6f65 736e 2774 2061 6c72 6561  rm doesn't alrea
-00019c20: 6479 0a6b 6e6f 7720 7768 6572 6520 796f  dy.know where yo
-00019c30: 7572 2060 706f 6574 7279 6020 6578 6563  ur `poetry` exec
-00019c40: 7574 6162 6c65 2069 732c 2074 6865 6e20  utable is, then 
-00019c50: 7365 7420 7468 6520 7061 7468 2074 6f20  set the path to 
-00019c60: 796f 7572 2060 706f 6574 7279 6020 6578  your `poetry` ex
-00019c70: 6563 7574 6162 6c65 0a69 6e20 7468 6520  ecutable.in the 
-00019c80: 224e 6577 2050 6f65 7472 7920 456e 7669  "New Poetry Envi
-00019c90: 726f 6e6d 656e 7422 2066 6f72 6d20 696e  ronment" form in
-00019ca0: 7075 7420 6669 656c 6420 6c61 6265 6c6c  put field labell
-00019cb0: 6564 2022 506f 6574 7279 2065 7865 6375  ed "Poetry execu
-00019cc0: 7461 626c 6522 2e20 496e 2074 6865 0a22  table". In the."
-00019cd0: 4e65 7720 506f 6574 7279 2045 6e76 6972  New Poetry Envir
-00019ce0: 6f6e 6d65 6e74 2220 666f 726d 2c20 796f  onment" form, yo
-00019cf0: 7520 7769 6c6c 2061 6c73 6f20 6861 7665  u will also have
-00019d00: 2074 6865 206f 7070 6f72 7475 6e69 7479   the opportunity
-00019d10: 2074 6f20 7365 6c65 6374 2077 6869 6368   to select which
-00019d20: 0a50 7974 686f 6e20 6578 6563 7574 6162  .Python executab
-00019d30: 6c65 2077 696c 6c20 6265 2075 7365 6420  le will be used 
-00019d40: 6279 2074 6865 2076 6972 7475 616c 2065  by the virtual e
-00019d50: 6e76 6972 6f6e 6d65 6e74 2e0a 0a50 7943  nvironment...PyC
-00019d60: 6861 726d 2077 696c 6c20 7468 656e 2063  harm will then c
-00019d70: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
-00019d80: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
-00019d90: 6f6e 6d65 6e74 2066 6f72 2079 6f75 7220  onment for your 
-00019da0: 7072 6f6a 6563 742c 2075 7369 6e67 0a61  project, using.a
-00019db0: 2070 6172 7469 6375 6c61 7220 7665 7273   particular vers
-00019dc0: 696f 6e20 6f66 2050 7974 686f 6e2c 2061  ion of Python, a
-00019dd0: 6e64 2061 6c73 6f20 696e 7374 616c 6c20  nd also install 
-00019de0: 696e 746f 2074 6869 7320 7669 7274 7561  into this virtua
-00019df0: 6c20 656e 7669 726f 6e6d 656e 7420 7468  l environment th
-00019e00: 650a 7072 6f6a 6563 7427 7320 7061 636b  e.project's pack
-00019e10: 6167 6520 6465 7065 6e64 656e 6369 6573  age dependencies
-00019e20: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-00019e30: 6520 7072 6f6a 6563 7427 7320 6070 6f65  e project's `poe
-00019e40: 7472 792e 6c6f 636b 6020 6669 6c65 2e0a  try.lock` file..
-00019e50: 0a59 6f75 2063 616e 2061 6464 2064 6966  .You can add dif
-00019e60: 6665 7265 6e74 2050 6f65 7472 7920 656e  ferent Poetry en
-00019e70: 7669 726f 6e6d 656e 7473 2066 6f72 2064  vironments for d
-00019e80: 6966 6665 7265 6e74 2050 7974 686f 6e20  ifferent Python 
-00019e90: 7665 7273 696f 6e73 2c20 616e 6420 7377  versions, and sw
-00019ea0: 6974 6368 0a62 6574 7765 656e 2074 6865  itch.between the
-00019eb0: 6d20 7573 696e 6720 7468 6520 2250 7974  m using the "Pyt
-00019ec0: 686f 6e20 496e 7465 7270 7265 7465 7222  hon Interpreter"
-00019ed0: 2073 6574 7469 6e67 7320 6f66 2050 7943   settings of PyC
-00019ee0: 6861 726d 2e20 4966 2079 6f75 2077 616e  harm. If you wan
-00019ef0: 7420 746f 2075 7365 0a61 2076 6572 7369  t to use.a versi
-00019f00: 6f6e 206f 6620 5079 7468 6f6e 2074 6861  on of Python tha
-00019f10: 7420 6973 6e27 7420 696e 7374 616c 6c65  t isn't installe
-00019f20: 642c 2065 6974 6865 7220 7573 6520 796f  d, either use yo
-00019f30: 7572 2066 6176 6f75 7269 7465 2070 6163  ur favourite pac
-00019f40: 6b61 6765 206d 616e 6167 6572 2c0a 6f72  kage manager,.or
-00019f50: 2069 6e73 7461 6c6c 2050 7974 686f 6e20   install Python 
-00019f60: 6279 2064 6f77 6e6c 6f61 6469 6e67 2061  by downloading a
-00019f70: 6e20 696e 7374 616c 6c65 7220 666f 7220  n installer for 
-00019f80: 7265 6365 6e74 2076 6572 7369 6f6e 7320  recent versions 
-00019f90: 6f66 2050 7974 686f 6e20 6469 7265 6374  of Python direct
-00019fa0: 6c79 0a66 726f 6d20 7468 6520 5b50 7974  ly.from the [Pyt
-00019fb0: 686f 6e20 7765 6273 6974 655d 2868 7474  hon website](htt
-00019fc0: 7073 3a2f 2f77 7777 2e70 7974 686f 6e2e  ps://www.python.
-00019fd0: 6f72 672f 646f 776e 6c6f 6164 732f 292e  org/downloads/).
-00019fe0: 0a0a 4f6e 6365 2070 726f 6a65 6374 2064  ..Once project d
-00019ff0: 6570 656e 6465 6e63 6965 7320 6861 7665  ependencies have
-0001a000: 2062 6565 6e20 696e 7374 616c 6c65 642c   been installed,
-0001a010: 2079 6f75 2073 686f 756c 6420 6265 2061   you should be a
-0001a020: 626c 6520 746f 2072 756e 2074 6573 7473  ble to run tests
-0001a030: 0a66 726f 6d20 7769 7468 696e 2050 7943  .from within PyC
-0001a040: 6861 726d 2028 7269 6768 742d 636c 6963  harm (right-clic
-0001a050: 6b20 6f6e 2074 6865 2060 7465 7374 7360  k on the `tests`
-0001a060: 2066 6f6c 6465 7220 616e 6420 7365 6c65   folder and sele
-0001a070: 6374 2074 6865 2027 5275 6e27 206f 7074  ct the 'Run' opt
-0001a080: 696f 6e29 2e0a 0a42 6563 6175 7365 206f  ion)...Because o
-0001a090: 6620 6120 636f 6e66 6c69 6374 2062 6574  f a conflict bet
-0001a0a0: 7765 656e 2070 7974 6573 7420 616e 6420  ween pytest and 
-0001a0b0: 5079 4368 6172 6d27 7320 6465 6275 6767  PyCharm's debugg
-0001a0c0: 6572 2061 6e64 2074 6865 2063 6f76 6572  er and the cover
-0001a0d0: 6167 6520 746f 6f6c 2c0a 796f 7520 6d61  age tool,.you ma
-0001a0e0: 7920 6e65 6564 2074 6f20 6164 6420 6060  y need to add ``
-0001a0f0: 2d2d 6e6f 2d63 6f76 6060 2061 7320 616e  --no-cov`` as an
-0001a100: 206f 7074 696f 6e20 746f 2074 6865 2074   option to the t
-0001a110: 6573 7420 7275 6e6e 6572 2074 656d 706c  est runner templ
-0001a120: 6174 652e 2041 6c74 6572 6e61 7469 7665  ate. Alternative
-0001a130: 6c79 2c0a 6a75 7374 2075 7365 2074 6865  ly,.just use the
-0001a140: 2050 7974 686f 6e20 5374 616e 6461 7264   Python Standard
-0001a150: 204c 6962 7261 7279 2773 2060 6075 6e69   Library's ``uni
-0001a160: 7474 6573 7460 6020 6d6f 6475 6c65 2e0a  ttest`` module..
-0001a170: 0a59 6f75 2073 686f 756c 6420 616c 736f  .You should also
-0001a180: 2062 6520 6162 6c65 2074 6f20 6f70 656e   be able to open
-0001a190: 2061 2074 6572 6d69 6e61 6c20 7769 6e64   a terminal wind
-0001a1a0: 6f77 2069 6e20 5079 4368 6172 6d2c 2061  ow in PyCharm, a
-0001a1b0: 6e64 2072 756e 2074 6865 2070 726f 6a65  nd run the proje
-0001a1c0: 6374 2773 0a4d 616b 6566 696c 6520 636f  ct's.Makefile co
-0001a1d0: 6d6d 616e 6473 2066 726f 6d20 7468 6520  mmands from the 
-0001a1e0: 636f 6d6d 616e 6420 6c69 6e65 2028 7365  command line (se
-0001a1f0: 6520 6265 6c6f 7729 2e0a 0a23 2323 2053  e below)...### S
-0001a200: 6574 7570 2066 726f 6d20 636f 6d6d 616e  etup from comman
-0001a210: 6420 6c69 6e65 0a0a 4f62 7461 696e 2074  d line..Obtain t
-0001a220: 6865 2070 726f 6a65 6374 2066 696c 6573  he project files
-0001a230: 2c20 7573 696e 6720 4769 7420 6f72 2073  , using Git or s
-0001a240: 7569 7461 626c 6520 616c 7465 726e 6174  uitable alternat
-0001a250: 6976 652e 0a0a 496e 2061 2074 6572 6d69  ive...In a termi
-0001a260: 6e61 6c20 6170 706c 6963 6174 696f 6e2c  nal application,
-0001a270: 2063 6861 6e67 6520 796f 7572 2063 7572   change your cur
-0001a280: 7265 6e74 2077 6f72 6b69 6e67 2064 6972  rent working dir
-0001a290: 6563 746f 7279 0a74 6f20 7468 6520 726f  ectory.to the ro
-0001a2a0: 6f74 2066 6f6c 6465 7220 6f66 2074 6865  ot folder of the
-0001a2b0: 2070 726f 6a65 6374 2066 696c 6573 2e20   project files. 
-0001a2c0: 5468 6572 6520 7368 6f75 6c64 2062 6520  There should be 
-0001a2d0: 6120 4d61 6b65 6669 6c65 0a69 6e20 7468  a Makefile.in th
-0001a2e0: 6973 2066 6f6c 6465 722e 0a0a 5573 6520  is folder...Use 
-0001a2f0: 7468 6520 4d61 6b65 6669 6c65 2074 6f20  the Makefile to 
-0001a300: 6372 6561 7465 2061 206e 6577 2050 6f65  create a new Poe
-0001a310: 7472 7920 7669 7274 7561 6c20 656e 7669  try virtual envi
-0001a320: 726f 6e6d 656e 7420 666f 7220 7468 650a  ronment for the.
-0001a330: 7072 6f6a 6563 7420 616e 6420 696e 7374  project and inst
-0001a340: 616c 6c20 7468 6520 7072 6f6a 6563 7427  all the project'
-0001a350: 7320 7061 636b 6167 6520 6465 7065 6e64  s package depend
-0001a360: 656e 6369 6573 2069 6e74 6f20 6974 2c0a  encies into it,.
-0001a370: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
-0001a380: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
-0001a390: 2020 2420 6d61 6b65 2069 6e73 7461 6c6c    $ make install
-0001a3a0: 2d70 6163 6b61 6765 730a 0a49 7427 7320  -packages..It's 
-0001a3b0: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
-0001a3c0: 2061 6c73 6f20 696e 7374 616c 6c20 7468   also install th
-0001a3d0: 6520 7072 6f6a 6563 7420 696e 2027 6564  e project in 'ed
-0001a3e0: 6974 6162 6c65 206d 6f64 6527 2e0a 0a20  itable mode'... 
-0001a3f0: 2020 2024 206d 616b 6520 696e 7374 616c     $ make instal
-0001a400: 6c0a 0a50 6c65 6173 6520 6e6f 7465 2c20  l..Please note, 
-0001a410: 6966 2079 6f75 2063 7265 6174 6520 7468  if you create th
-0001a420: 6520 7669 7274 7561 6c20 656e 7669 726f  e virtual enviro
-0001a430: 6e6d 656e 7420 696e 2074 6869 7320 7761  nment in this wa
-0001a440: 792c 2061 6e64 2074 6865 6e20 7472 7920  y, and then try 
-0001a450: 746f 0a6f 7065 6e20 7468 6520 7072 6f6a  to.open the proj
-0001a460: 6563 7420 696e 2050 7943 6861 726d 2061  ect in PyCharm a
-0001a470: 6e64 2063 6f6e 6669 6775 7265 2074 6865  nd configure the
-0001a480: 2070 726f 6a65 6374 2074 6f20 7573 6520   project to use 
-0001a490: 7468 6973 2076 6972 7475 616c 0a65 6e76  this virtual.env
-0001a4a0: 6972 6f6e 6d65 6e74 2061 7320 616e 2022  ironment as an "
-0001a4b0: 4578 6973 7469 6e67 2050 6f65 7472 7920  Existing Poetry 
-0001a4c0: 456e 7669 726f 6e6d 656e 7422 2c20 5079  Environment", Py
-0001a4d0: 4368 6172 6d20 736f 6d65 7469 6d65 7320  Charm sometimes 
-0001a4e0: 6861 7320 736f 6d65 0a69 7373 7565 7320  has some.issues 
-0001a4f0: 2864 6f6e 2774 206b 6e6f 7720 7768 7929  (don't know why)
-0001a500: 2077 6869 6368 206d 6967 6874 2062 6520   which might be 
-0001a510: 7072 6f62 6c65 6d61 7469 632e 2049 6620  problematic. If 
-0001a520: 796f 7520 656e 636f 756e 7465 7220 7375  you encounter su
-0001a530: 6368 0a69 7373 7565 732c 2079 6f75 2063  ch.issues, you c
-0001a540: 616e 2072 6573 6f6c 7665 2074 6865 7365  an resolve these
-0001a550: 2069 7373 7565 7320 6279 2064 656c 6574   issues by delet
-0001a560: 696e 6720 7468 6520 7669 7274 7561 6c20  ing the virtual 
-0001a570: 656e 7669 726f 6e6d 656e 740a 616e 6420  environment.and 
-0001a580: 6372 6561 7469 6e67 2074 6865 2050 6f65  creating the Poe
-0001a590: 7472 7920 7669 7274 7561 6c20 656e 7669  try virtual envi
-0001a5a0: 726f 6e6d 656e 7420 7573 696e 6720 5079  ronment using Py
-0001a5b0: 4368 6172 6d20 2873 6565 2061 626f 7665  Charm (see above
-0001a5c0: 292e 0a0a 2323 2320 5072 6f6a 6563 7420  )...### Project 
-0001a5d0: 4d61 6b65 6669 6c65 2063 6f6d 6d61 6e64  Makefile command
-0001a5e0: 730a 0a59 6f75 2063 616e 2073 7461 7274  s..You can start
-0001a5f0: 2045 7665 6e74 5374 6f72 6544 4220 7573   EventStoreDB us
-0001a600: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-0001a610: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
-0001a620: 2420 6d61 6b65 2073 7461 7274 2d65 7665  $ make start-eve
-0001a630: 6e74 7374 6f72 6564 620a 0a59 6f75 2063  ntstoredb..You c
-0001a640: 616e 2072 756e 2074 6573 7473 2075 7369  an run tests usi
-0001a650: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-0001a660: 2063 6f6d 6d61 6e64 2028 6e65 6564 7320   command (needs 
-0001a670: 4576 656e 7453 746f 7265 4442 2074 6f20  EventStoreDB to 
-0001a680: 6265 2072 756e 6e69 6e67 292e 0a0a 2020  be running)...  
-0001a690: 2020 2420 6d61 6b65 2074 6573 740a 0a59    $ make test..Y
-0001a6a0: 6f75 2063 616e 2073 746f 7020 4576 656e  ou can stop Even
-0001a6b0: 7453 746f 7265 4442 2075 7369 6e67 2074  tStoreDB using t
-0001a6c0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
-0001a6d0: 6d61 6e64 2e0a 0a20 2020 2024 206d 616b  mand...    $ mak
-0001a6e0: 6520 7374 6f70 2d65 7665 6e74 7374 6f72  e stop-eventstor
-0001a6f0: 6564 620a 0a59 6f75 2063 616e 2063 6865  edb..You can che
-0001a700: 636b 2074 6865 2066 6f72 6d61 7474 696e  ck the formattin
-0001a710: 6720 6f66 2074 6865 2063 6f64 6520 7573  g of the code us
-0001a720: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-0001a730: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
-0001a740: 2420 6d61 6b65 206c 696e 740a 0a59 6f75  $ make lint..You
-0001a750: 2063 616e 2072 6566 6f72 6d61 7420 7468   can reformat th
-0001a760: 6520 636f 6465 2075 7369 6e67 2074 6865  e code using the
-0001a770: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-0001a780: 6e64 2e0a 0a20 2020 2024 206d 616b 6520  nd...    $ make 
-0001a790: 666d 740a 0a54 6573 7473 2062 656c 6f6e  fmt..Tests belon
-0001a7a0: 6720 696e 2060 2e2f 7465 7374 7360 2e20  g in `./tests`. 
-0001a7b0: 436f 6465 2d75 6e64 6572 2d74 6573 7420  Code-under-test 
-0001a7c0: 6265 6c6f 6e67 7320 696e 2060 2e2f 6573  belongs in `./es
-0001a7d0: 6462 636c 6965 6e74 602e 0a0a 4564 6974  dbclient`...Edit
-0001a7e0: 2070 6163 6b61 6765 2064 6570 656e 6465   package depende
-0001a7f0: 6e63 6965 7320 696e 2060 7079 7072 6f6a  ncies in `pyproj
-0001a800: 6563 742e 746f 6d6c 602e 2055 7064 6174  ect.toml`. Updat
-0001a810: 6520 696e 7374 616c 6c65 6420 7061 636b  e installed pack
-0001a820: 6167 6573 2028 616e 6420 7468 650a 6070  ages (and the.`p
-0001a830: 6f65 7472 792e 6c6f 636b 6020 6669 6c65  oetry.lock` file
-0001a840: 2920 7573 696e 6720 7468 6520 666f 6c6c  ) using the foll
-0001a850: 6f77 696e 6720 636f 6d6d 616e 642e 0a0a  owing command...
-0001a860: 2020 2020 2420 6d61 6b65 2075 7064 6174      $ make updat
-0001a870: 652d 7061 636b 6167 6573 0a0a            e-packages..
+00001a70: 2a20 5b53 6574 2073 7472 6561 6d20 6d65  * [Set stream me
+00001a80: 7461 6461 7461 5d28 2373 6574 2d73 7472  tadata](#set-str
+00001a90: 6561 6d2d 6d65 7461 6461 7461 290a 2020  eam-metadata).  
+00001aa0: 2a20 5b44 656c 6574 6520 7374 7265 616d  * [Delete stream
+00001ab0: 5d28 2364 656c 6574 652d 7374 7265 616d  ](#delete-stream
+00001ac0: 290a 2020 2a20 5b54 6f6d 6273 746f 6e65  ).  * [Tombstone
+00001ad0: 2073 7472 6561 6d5d 2823 746f 6d62 7374   stream](#tombst
+00001ae0: 6f6e 652d 7374 7265 616d 290a 2a20 5b43  one-stream).* [C
+00001af0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00001b00: 7469 6f6e 735d 2823 6361 7463 682d 7570  tions](#catch-up
+00001b10: 2d73 7562 7363 7269 7074 696f 6e73 290a  -subscriptions).
+00001b20: 2020 2a20 5b53 7562 7363 7269 6265 2061    * [Subscribe a
+00001b30: 6c6c 2065 7665 6e74 735d 2823 7375 6273  ll events](#subs
+00001b40: 6372 6962 652d 616c 6c2d 6576 656e 7473  cribe-all-events
+00001b50: 290a 2020 2a20 5b53 7562 7363 7269 6265  ).  * [Subscribe
+00001b60: 2073 7472 6561 6d20 6576 656e 7473 5d28   stream events](
+00001b70: 2373 7562 7363 7269 6265 2d73 7472 6561  #subscribe-strea
+00001b80: 6d2d 6576 656e 7473 290a 2020 2a20 5b48  m-events).  * [H
+00001b90: 6f77 2074 6f20 696d 706c 656d 656e 7420  ow to implement 
+00001ba0: 6578 6163 746c 792d 6f6e 6365 2065 7665  exactly-once eve
+00001bb0: 6e74 2070 726f 6365 7373 696e 675d 2823  nt processing](#
+00001bc0: 686f 772d 746f 2d69 6d70 6c65 6d65 6e74  how-to-implement
+00001bd0: 2d65 7861 6374 6c79 2d6f 6e63 652d 6576  -exactly-once-ev
+00001be0: 656e 742d 7072 6f63 6573 7369 6e67 290a  ent-processing).
+00001bf0: 2a20 5b50 6572 7369 7374 656e 7420 7375  * [Persistent su
+00001c00: 6273 6372 6970 7469 6f6e 735d 2823 7065  bscriptions](#pe
+00001c10: 7273 6973 7465 6e74 2d73 7562 7363 7269  rsistent-subscri
+00001c20: 7074 696f 6e73 290a 2020 2a20 5b43 7265  ptions).  * [Cre
+00001c30: 6174 6520 7375 6273 6372 6970 7469 6f6e  ate subscription
+00001c40: 5d28 2363 7265 6174 652d 7375 6273 6372  ](#create-subscr
+00001c50: 6970 7469 6f6e 290a 2020 2a20 5b52 6561  iption).  * [Rea
+00001c60: 6420 7375 6273 6372 6970 7469 6f6e 5d28  d subscription](
+00001c70: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
+00001c80: 6f6e 290a 2020 2a20 5b48 6f77 2074 6f20  on).  * [How to 
+00001c90: 7772 6974 6520 6120 7065 7273 6973 7465  write a persiste
+00001ca0: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
+00001cb0: 636f 6e73 756d 6572 5d28 2368 6f77 2d74  consumer](#how-t
+00001cc0: 6f2d 7772 6974 652d 612d 7065 7273 6973  o-write-a-persis
+00001cd0: 7465 6e74 2d73 7562 7363 7269 7074 696f  tent-subscriptio
+00001ce0: 6e2d 636f 6e73 756d 6572 290a 2020 2a20  n-consumer).  * 
+00001cf0: 5b47 6574 2073 7562 7363 7269 7074 696f  [Get subscriptio
+00001d00: 6e20 696e 666f 5d28 2367 6574 2d73 7562  n info](#get-sub
+00001d10: 7363 7269 7074 696f 6e2d 696e 666f 290a  scription-info).
+00001d20: 2020 2a20 5b4c 6973 7420 7375 6273 6372    * [List subscr
+00001d30: 6970 7469 6f6e 735d 2823 6c69 7374 2d73  iptions](#list-s
+00001d40: 7562 7363 7269 7074 696f 6e73 290a 2020  ubscriptions).  
+00001d50: 2a20 5b55 7064 6174 6520 7375 6273 6372  * [Update subscr
+00001d60: 6970 7469 6f6e 5d28 2375 7064 6174 652d  iption](#update-
+00001d70: 7375 6273 6372 6970 7469 6f6e 290a 2020  subscription).  
+00001d80: 2a20 5b43 7265 6174 6520 7374 7265 616d  * [Create stream
+00001d90: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+00001da0: 6372 6561 7465 2d73 7472 6561 6d2d 7375  create-stream-su
+00001db0: 6273 6372 6970 7469 6f6e 290a 2020 2a20  bscription).  * 
+00001dc0: 5b52 6561 6420 7374 7265 616d 2073 7562  [Read stream sub
+00001dd0: 7363 7269 7074 696f 6e5d 2823 7265 6164  scription](#read
+00001de0: 2d73 7472 6561 6d2d 7375 6273 6372 6970  -stream-subscrip
+00001df0: 7469 6f6e 290a 2020 2a20 5b47 6574 2073  tion).  * [Get s
+00001e00: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00001e10: 6f6e 2069 6e66 6f5d 2823 6765 742d 7374  on info](#get-st
+00001e20: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
+00001e30: 6e2d 696e 666f 290a 2020 2a20 5b4c 6973  n-info).  * [Lis
+00001e40: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
+00001e50: 7074 696f 6e73 5d28 236c 6973 742d 7374  ptions](#list-st
+00001e60: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
+00001e70: 6e73 290a 2020 2a20 5b55 7064 6174 6520  ns).  * [Update 
+00001e80: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00001e90: 696f 6e5d 2823 7570 6461 7465 2d73 7472  ion](#update-str
+00001ea0: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
+00001eb0: 290a 2020 2a20 5b52 6570 6c61 7920 7061  ).  * [Replay pa
+00001ec0: 726b 6564 2065 7665 6e74 735d 2823 7265  rked events](#re
+00001ed0: 706c 6179 2d70 6172 6b65 642d 6576 656e  play-parked-even
+00001ee0: 7473 290a 2020 2a20 5b44 656c 6574 6520  ts).  * [Delete 
+00001ef0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00001f00: 7269 7074 696f 6e5d 2823 6465 6c65 7465  ription](#delete
+00001f10: 2d70 6572 7369 7374 656e 742d 7375 6273  -persistent-subs
+00001f20: 6372 6970 7469 6f6e 290a 2a20 5b43 6f6e  cription).* [Con
+00001f30: 6e65 6374 696f 6e5d 2823 636f 6e6e 6563  nection](#connec
+00001f40: 7469 6f6e 290a 2020 2a20 5b52 6563 6f6e  tion).  * [Recon
+00001f50: 6e65 6374 5d28 2372 6563 6f6e 6e65 6374  nect](#reconnect
+00001f60: 290a 2020 2a20 5b43 6c6f 7365 5d28 2363  ).  * [Close](#c
+00001f70: 6c6f 7365 290a 2a20 5b41 7379 6e63 696f  lose).* [Asyncio
+00001f80: 2063 6c69 656e 745d 2823 6173 796e 6369   client](#asynci
+00001f90: 6f2d 636c 6965 6e74 290a 2020 2a20 5b53  o-client).  * [S
+00001fa0: 796e 6f70 7369 735d 2823 7379 6e6f 7073  ynopsis](#synops
+00001fb0: 6973 2d31 290a 2a20 5b4e 6f74 6573 5d28  is-1).* [Notes](
+00001fc0: 236e 6f74 6573 290a 2020 2a20 5b52 6567  #notes).  * [Reg
+00001fd0: 756c 6172 2065 7870 7265 7373 696f 6e20  ular expression 
+00001fe0: 6669 6c74 6572 735d 2823 7265 6775 6c61  filters](#regula
+00001ff0: 722d 6578 7072 6573 7369 6f6e 2d66 696c  r-expression-fil
+00002000: 7465 7273 290a 2a20 5b43 6f6e 7472 6962  ters).* [Contrib
+00002010: 7574 6f72 735d 2823 636f 6e74 7269 6275  utors](#contribu
+00002020: 746f 7273 290a 2020 2a20 5b49 6e73 7461  tors).  * [Insta
+00002030: 6c6c 2050 6f65 7472 795d 2823 696e 7374  ll Poetry](#inst
+00002040: 616c 6c2d 706f 6574 7279 290a 2020 2a20  all-poetry).  * 
+00002050: 5b53 6574 7570 2066 6f72 2050 7943 6861  [Setup for PyCha
+00002060: 726d 2075 7365 7273 5d28 2373 6574 7570  rm users](#setup
+00002070: 2d66 6f72 2d70 7963 6861 726d 2d75 7365  -for-pycharm-use
+00002080: 7273 290a 2020 2a20 5b53 6574 7570 2066  rs).  * [Setup f
+00002090: 726f 6d20 636f 6d6d 616e 6420 6c69 6e65  rom command line
+000020a0: 5d28 2373 6574 7570 2d66 726f 6d2d 636f  ](#setup-from-co
+000020b0: 6d6d 616e 642d 6c69 6e65 290a 2020 2a20  mmand-line).  * 
+000020c0: 5b50 726f 6a65 6374 204d 616b 6566 696c  [Project Makefil
+000020d0: 6520 636f 6d6d 616e 6473 5d28 2370 726f  e commands](#pro
+000020e0: 6a65 6374 2d6d 616b 6566 696c 652d 636f  ject-makefile-co
+000020f0: 6d6d 616e 6473 290a 3c21 2d2d 2054 4f43  mmands).<!-- TOC
+00002100: 202d 2d3e 0a0a 2323 2049 6e73 7461 6c6c   -->..## Install
+00002110: 2070 6163 6b61 6765 0a0a 4974 2069 7320   package..It is 
+00002120: 7265 636f 6d6d 656e 6465 6420 746f 2069  recommended to i
+00002130: 6e73 7461 6c6c 2050 7974 686f 6e20 7061  nstall Python pa
+00002140: 636b 6167 6573 2069 6e74 6f20 6120 5079  ckages into a Py
+00002150: 7468 6f6e 2076 6972 7475 616c 2065 6e76  thon virtual env
+00002160: 6972 6f6e 6d65 6e74 2e0a 0a23 2323 2046  ironment...### F
+00002170: 726f 6d20 5079 5049 0a0a 596f 7520 6361  rom PyPI..You ca
+00002180: 6e20 7573 6520 7069 7020 746f 2069 6e73  n use pip to ins
+00002190: 7461 6c6c 2074 6869 7320 7061 636b 6167  tall this packag
+000021a0: 6520 6469 7265 6374 6c79 2066 726f 6d0a  e directly from.
+000021b0: 5b74 6865 2050 7974 686f 6e20 5061 636b  [the Python Pack
+000021c0: 6167 6520 496e 6465 785d 2868 7474 7073  age Index](https
+000021d0: 3a2f 2f70 7970 692e 6f72 672f 7072 6f6a  ://pypi.org/proj
+000021e0: 6563 742f 6573 6462 636c 6965 6e74 2f29  ect/esdbclient/)
+000021f0: 2e0a 0a20 2020 2024 2070 6970 2069 6e73  ...    $ pip ins
+00002200: 7461 6c6c 2065 7364 6263 6c69 656e 740a  tall esdbclient.
+00002210: 0a23 2323 2057 6974 6820 506f 6574 7279  .### With Poetry
+00002220: 0a0a 596f 7520 6361 6e20 7573 6520 506f  ..You can use Po
+00002230: 6574 7279 2074 6f20 6164 6420 7468 6973  etry to add this
+00002240: 2070 6163 6b61 6765 2074 6f20 796f 7572   package to your
+00002250: 2070 7970 726f 6a65 6374 2e74 6f6d 6c20   pyproject.toml 
+00002260: 616e 6420 696e 7374 616c 6c20 6974 2e0a  and install it..
+00002270: 0a20 2020 2024 2070 6f65 7472 7920 6164  .    $ poetry ad
+00002280: 6420 6573 6462 636c 6965 6e74 0a0a 2323  d esdbclient..##
+00002290: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+000022a0: 7276 6572 0a0a 5468 6520 4576 656e 7453  rver..The EventS
+000022b0: 746f 7265 4442 2073 6572 7665 7220 6361  toreDB server ca
+000022c0: 6e20 6265 2072 756e 206c 6f63 616c 6c79  n be run locally
+000022d0: 2075 7369 6e67 2074 6865 206f 6666 6963   using the offic
+000022e0: 6961 6c20 446f 636b 6572 2063 6f6e 7461  ial Docker conta
+000022f0: 696e 6572 2069 6d61 6765 2e0a 0a23 2323  iner image...###
+00002300: 2052 756e 2063 6f6e 7461 696e 6572 0a0a   Run container..
+00002310: 466f 7220 6465 7665 6c6f 706d 656e 742c  For development,
+00002320: 2079 6f75 2063 616e 2072 756e 2061 2022   you can run a "
+00002330: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
+00002340: 7265 4442 2073 6572 7665 7220 7573 696e  reDB server usin
+00002350: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+00002360: 636f 6d6d 616e 642e 0a0a 2020 2020 2420  command...    $ 
+00002370: 646f 636b 6572 2072 756e 202d 6420 2d2d  docker run -d --
+00002380: 6e61 6d65 2065 7665 6e74 7374 6f72 6564  name eventstored
+00002390: 622d 7365 6375 7265 202d 6974 202d 7020  b-secure -it -p 
+000023a0: 3231 3133 3a32 3131 3320 2d2d 656e 7620  2113:2113 --env 
+000023b0: 2248 4f4d 453d 2f74 6d70 2220 6576 656e  "HOME=/tmp" even
+000023c0: 7473 746f 7265 2f65 7665 6e74 7374 6f72  tstore/eventstor
+000023d0: 653a 3231 2e31 302e 392d 6275 7374 6572  e:21.10.9-buster
+000023e0: 2d73 6c69 6d20 2d2d 6465 760a 0a41 7320  -slim --dev..As 
+000023f0: 7765 2077 696c 6c20 7365 652c 2079 6f75  we will see, you
+00002400: 7220 636c 6965 6e74 2077 696c 6c20 6e65  r client will ne
+00002410: 6564 2061 6e20 4576 656e 7453 746f 7265  ed an EventStore
+00002420: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
+00002430: 7269 6e67 2055 5249 2061 7320 7468 6520  ring URI as the 
+00002440: 7661 6c75 650a 6f66 2069 7473 2060 7572  value.of its `ur
+00002450: 6960 2063 6f6e 7374 7275 6374 6f72 2061  i` constructor a
+00002460: 7267 756d 656e 742e 2054 6865 2063 6f6e  rgument. The con
+00002470: 6e65 6374 696f 6e20 7374 7269 6e67 2066  nection string f
+00002480: 6f72 2074 6869 7320 2273 6563 7572 6522  or this "secure"
+00002490: 2045 7665 6e74 5374 6f72 6544 420a 7365   EventStoreDB.se
+000024a0: 7276 6572 2077 6f75 6c64 2062 653a 0a0a  rver would be:..
+000024b0: 2020 2020 6573 6462 3a2f 2f61 646d 696e      esdb://admin
+000024c0: 3a63 6861 6e67 6569 7440 6c6f 6361 6c68  :changeit@localh
+000024d0: 6f73 743a 3231 3133 0a0a 546f 2063 6f6e  ost:2113..To con
+000024e0: 6e65 6374 2074 6f20 6120 2273 6563 7572  nect to a "secur
+000024f0: 6522 2073 6572 7665 722c 2079 6f75 2077  e" server, you w
+00002500: 696c 6c20 7573 7561 6c6c 7920 6e65 6564  ill usually need
+00002510: 2074 6f20 696e 636c 7564 6520 6120 2275   to include a "u
+00002520: 7365 726e 616d 6522 0a61 6e64 2061 2022  sername".and a "
+00002530: 7061 7373 776f 7264 2220 696e 2074 6865  password" in the
+00002540: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+00002550: 6e67 2c20 736f 2074 6861 7420 7468 6520  ng, so that the 
+00002560: 7365 7276 6572 2063 616e 2061 7574 6865  server can authe
+00002570: 6e74 6963 6174 6520 7468 650a 636c 6965  nticate the.clie
+00002580: 6e74 2e20 5769 7468 2045 7665 6e74 5374  nt. With EventSt
+00002590: 6f72 6544 422c 2074 6865 2064 6566 6175  oreDB, the defau
+000025a0: 6c74 2075 7365 726e 616d 6520 6973 2022  lt username is "
+000025b0: 6164 6d69 6e22 2061 6e64 2074 6865 2064  admin" and the d
+000025c0: 6566 6175 6c74 2070 6173 7377 6f72 640a  efault password.
+000025d0: 6973 2022 6368 616e 6765 6974 222e 0a0a  is "changeit"...
+000025e0: 5768 656e 2063 6f6e 6e65 6374 696e 6720  When connecting 
+000025f0: 746f 2061 2022 7365 6375 7265 2220 7365  to a "secure" se
+00002600: 7276 6572 2c20 796f 7572 2063 6c69 656e  rver, your clien
+00002610: 7420 7769 6c6c 2061 6c73 6f20 6e65 6564  t will also need
+00002620: 2061 6e20 5353 4c2f 544c 5320 6365 7274   an SSL/TLS cert
+00002630: 6966 6963 6174 650a 6173 2074 6865 2076  ificate.as the v
+00002640: 616c 7565 206f 6620 6974 7320 6072 6f6f  alue of its `roo
+00002650: 745f 6365 7274 6966 6963 6174 6573 6020  t_certificates` 
+00002660: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
+00002670: 6d65 6e74 2e20 5468 6520 636c 6965 6e74  ment. The client
+00002680: 2075 7365 7320 7468 650a 5353 4c2f 544c   uses the.SSL/TL
+00002690: 5320 6365 7274 6966 6963 6174 6520 746f  S certificate to
+000026a0: 2061 7574 6865 6e74 6963 6174 6520 7468   authenticate th
+000026b0: 6520 7365 7276 6572 2e20 466f 7220 6465  e server. For de
+000026c0: 7665 6c6f 706d 656e 742c 2079 6f75 2063  velopment, you c
+000026d0: 616e 2065 6974 6865 7220 7573 6520 7468  an either use th
+000026e0: 650a 5353 4c2f 544c 5320 6365 7274 6966  e.SSL/TLS certif
+000026f0: 6963 6174 6520 6f66 2074 6865 2063 6572  icate of the cer
+00002700: 7469 6669 6361 7465 2061 7574 686f 7269  tificate authori
+00002710: 7479 2075 7365 6420 746f 2063 7265 6174  ty used to creat
+00002720: 6520 7468 6520 7365 7276 6572 2773 2063  e the server's c
+00002730: 6572 7469 6669 6361 7465 2c0a 6f72 2077  ertificate,.or w
+00002740: 6865 6e20 7573 696e 6720 6120 7369 6e67  hen using a sing
+00002750: 6c65 2d6e 6f64 6520 636c 7573 7465 722c  le-node cluster,
+00002760: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
+00002770: 2073 6572 7665 7220 6365 7274 6966 6963   server certific
+00002780: 6174 6520 6974 7365 6c66 2e20 596f 7520  ate itself. You 
+00002790: 6361 6e0a 6765 7420 7468 6520 7365 7276  can.get the serv
+000027a0: 6572 2063 6572 7469 6669 6361 7465 2077  er certificate w
+000027b0: 6974 6820 7468 6520 666f 6c6c 6f77 696e  ith the followin
+000027c0: 6720 5079 7468 6f6e 2063 6f64 652e 0a0a  g Python code...
+000027d0: 0a60 6060 7079 7468 6f6e 0a69 6d70 6f72  .```python.impor
+000027e0: 7420 7373 6c0a 0a73 6572 7665 725f 6365  t ssl..server_ce
+000027f0: 7274 6966 6963 6174 6520 3d20 7373 6c2e  rtificate = ssl.
+00002800: 6765 745f 7365 7276 6572 5f63 6572 7469  get_server_certi
+00002810: 6669 6361 7465 2861 6464 723d 2827 6c6f  ficate(addr=('lo
+00002820: 6361 6c68 6f73 7427 2c20 3231 3133 2929  calhost', 2113))
+00002830: 0a60 6060 0a0a 596f 7520 6361 6e20 616c  .```..You can al
+00002840: 736f 2073 7461 7274 2061 6e20 2269 6e73  so start an "ins
+00002850: 6563 7572 6522 2073 6572 7665 7220 7573  ecure" server us
+00002860: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+00002870: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
+00002880: 2420 646f 636b 6572 2072 756e 202d 6420  $ docker run -d 
+00002890: 2d2d 6e61 6d65 2065 7665 6e74 7374 6f72  --name eventstor
+000028a0: 6564 622d 696e 7365 6375 7265 202d 6974  edb-insecure -it
+000028b0: 202d 7020 3231 3134 3a32 3131 3320 6576   -p 2114:2113 ev
+000028c0: 656e 7473 746f 7265 2f65 7665 6e74 7374  entstore/eventst
+000028d0: 6f72 653a 3231 2e31 302e 392d 6275 7374  ore:21.10.9-bust
+000028e0: 6572 2d73 6c69 6d20 2d2d 696e 7365 6375  er-slim --insecu
+000028f0: 7265 0a0a 5468 6520 636f 6e6e 6563 7469  re..The connecti
+00002900: 6f6e 2073 7472 696e 6720 5552 4920 666f  on string URI fo
+00002910: 7220 7468 6973 2022 696e 7365 6375 7265  r this "insecure
+00002920: 2220 7365 7276 6572 2077 6f75 6c64 2062  " server would b
+00002930: 653a 0a0a 2020 2020 6573 6462 3a2f 2f6c  e:..    esdb://l
+00002940: 6f63 616c 686f 7374 3a32 3131 343f 546c  ocalhost:2114?Tl
+00002950: 733d 6661 6c73 650a 0a41 7320 7765 2077  s=false..As we w
+00002960: 696c 6c20 7365 652c 2077 6865 6e20 636f  ill see, when co
+00002970: 6e6e 6563 7469 6e67 2074 6f20 616e 2022  nnecting to an "
+00002980: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+00002990: 2c20 7468 6572 6520 6973 206e 6f20 6e65  , there is no ne
+000029a0: 6564 2074 6f20 696e 636c 7564 650a 6120  ed to include.a 
+000029b0: 2275 7365 726e 616d 6522 2061 6e64 2061  "username" and a
+000029c0: 2022 7061 7373 776f 7264 2220 696e 2074   "password" in t
+000029d0: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
+000029e0: 7269 6e67 2e20 4966 2079 6f75 2064 6f2c  ring. If you do,
+000029f0: 2074 6865 7365 2076 616c 7565 7320 7769   these values wi
+00002a00: 6c6c 0a62 6520 6967 6e6f 7265 6420 6279  ll.be ignored by
+00002a10: 2074 6865 2063 6c69 656e 742c 2073 6f20   the client, so 
+00002a20: 7468 6174 2074 6865 7920 6172 6520 6e6f  that they are no
+00002a30: 7420 7365 6e74 206f 7665 7220 616e 2069  t sent over an i
+00002a40: 6e73 6563 7572 6520 6368 616e 6e65 6c2e  nsecure channel.
+00002a50: 0a0a 506c 6561 7365 206e 6f74 652c 2074  ..Please note, t
+00002a60: 6865 2022 696e 7365 6375 7265 2220 636f  he "insecure" co
+00002a70: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00002a80: 7573 6573 2061 2071 7565 7279 2073 7472  uses a query str
+00002a90: 696e 6720 7769 7468 2074 6865 2066 6965  ing with the fie
+00002aa0: 6c64 2d76 616c 7565 0a60 546c 733d 6661  ld-value.`Tls=fa
+00002ab0: 6c73 6560 2e20 5468 6520 7661 6c75 6520  lse`. The value 
+00002ac0: 6f66 2074 6869 7320 6669 656c 6420 6973  of this field is
+00002ad0: 2062 7920 6465 6661 756c 7420 6074 7275   by default `tru
+00002ae0: 6560 2e0a 0a23 2323 2053 746f 7020 636f  e`...### Stop co
+00002af0: 6e74 6169 6e65 720a 0a54 6f20 7374 6f70  ntainer..To stop
+00002b00: 2061 6e64 2072 656d 6f76 6520 7468 6520   and remove the 
+00002b10: 2273 6563 7572 6522 2063 6f6e 7461 696e  "secure" contain
+00002b20: 6572 2c20 7573 6520 7468 6520 666f 6c6c  er, use the foll
+00002b30: 6f77 696e 6720 446f 636b 6572 2063 6f6d  owing Docker com
+00002b40: 6d61 6e64 732e 0a0a 2020 2020 2420 646f  mands...    $ do
+00002b50: 636b 6572 2073 746f 7020 6576 656e 7473  cker stop events
+00002b60: 746f 7265 6462 2d73 6563 7572 650a 0924  toredb-secure..$
+00002b70: 2064 6f63 6b65 7220 726d 2065 7665 6e74   docker rm event
+00002b80: 7374 6f72 6564 622d 7365 6375 7265 0a0a  storedb-secure..
+00002b90: 546f 2073 746f 7020 616e 6420 7265 6d6f  To stop and remo
+00002ba0: 7665 2074 6865 2022 696e 7365 6375 7265  ve the "insecure
+00002bb0: 2220 636f 6e74 6169 6e65 722c 2075 7365  " container, use
+00002bc0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2044   the following D
+00002bd0: 6f63 6b65 7220 636f 6d6d 616e 6473 2e0a  ocker commands..
+00002be0: 0a20 2020 2024 2064 6f63 6b65 7220 7374  .    $ docker st
+00002bf0: 6f70 2065 7665 6e74 7374 6f72 6564 622d  op eventstoredb-
+00002c00: 696e 7365 6375 7265 0a09 2420 646f 636b  insecure..$ dock
+00002c10: 6572 2072 6d20 6576 656e 7473 746f 7265  er rm eventstore
+00002c20: 6462 2d69 6e73 6563 7572 650a 0a0a 2323  db-insecure...##
+00002c30: 2045 7665 6e74 5374 6f72 6544 4220 636c   EventStoreDB cl
+00002c40: 6965 6e74 0a0a 5468 6973 2045 7665 6e74  ient..This Event
+00002c50: 5374 6f72 6544 4220 636c 6965 6e74 2069  StoreDB client i
+00002c60: 7320 696d 706c 656d 656e 7465 6420 696e  s implemented in
+00002c70: 2074 6865 2060 6573 6462 636c 6965 6e74   the `esdbclient
+00002c80: 6020 7061 636b 6167 6520 7769 7468 0a74  ` package with.t
+00002c90: 6865 2060 4553 4442 436c 6965 6e74 6020  he `ESDBClient` 
+00002ca0: 636c 6173 732e 0a0a 2323 2320 496d 706f  class...### Impo
+00002cb0: 7274 2063 6c61 7373 0a0a 5468 6520 6045  rt class..The `E
+00002cc0: 5344 4243 6c69 656e 7460 2063 6c61 7373  SDBClient` class
+00002cd0: 2063 616e 2062 6520 696d 706f 7274 6564   can be imported
+00002ce0: 2066 726f 6d20 7468 6520 6065 7364 6263   from the `esdbc
+00002cf0: 6c69 656e 7460 2070 6163 6b61 6765 2e0a  lient` package..
+00002d00: 0a60 6060 7079 7468 6f6e 0a66 726f 6d20  .```python.from 
+00002d10: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
+00002d20: 7420 4553 4442 436c 6965 6e74 0a60 6060  t ESDBClient.```
+00002d30: 0a0a 2323 2320 436f 6e73 7472 7563 7420  ..### Construct 
+00002d40: 636c 6965 6e74 0a0a 5468 6520 6045 5344  client..The `ESD
+00002d50: 4243 6c69 656e 7460 2063 6c61 7373 2068  BClient` class h
+00002d60: 6173 206f 6e65 2072 6571 7569 7265 6420  as one required 
+00002d70: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
+00002d80: 6d65 6e74 2c20 6075 7269 602c 2061 6e64  ment, `uri`, and
+00002d90: 206f 6e65 0a6f 7074 696f 6e61 6c20 636f   one.optional co
+00002da0: 6e73 7472 7563 746f 7220 6172 6775 6d65  nstructor argume
+00002db0: 6e74 2c20 6072 6f6f 745f 6365 7274 6966  nt, `root_certif
+00002dc0: 6963 6174 6573 602e 0a0a 5468 6520 6075  icates`...The `u
+00002dd0: 7269 6020 6172 6775 6d65 6e74 2069 7320  ri` argument is 
+00002de0: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+00002df0: 6e20 4576 656e 7453 746f 7265 4442 2063  n EventStoreDB c
+00002e00: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00002e10: 2055 5249 2074 6861 740a 636f 6e66 6f72   URI that.confor
+00002e20: 6d73 2077 6974 6820 7468 6520 7374 616e  ms with the stan
+00002e30: 6461 7264 2045 7665 6e74 5374 6f72 6544  dard EventStoreD
+00002e40: 4220 2265 7364 6222 206f 7220 2265 7364  B "esdb" or "esd
+00002e50: 622b 6469 7363 6f76 6572 2220 5552 4920  b+discover" URI 
+00002e60: 7363 6865 6d65 732e 0a0a 466f 7220 6578  schemes...For ex
+00002e70: 616d 706c 652c 2074 6865 2066 6f6c 6c6f  ample, the follo
+00002e80: 7769 6e67 2063 6f6e 6e65 6374 696f 6e20  wing connection 
+00002e90: 7374 7269 6e67 2073 7065 6369 6669 6573  string specifies
+00002ea0: 2074 6861 7420 7468 6520 636c 6965 6e74   that the client
+00002eb0: 2073 686f 756c 640a 6174 7465 6d70 7420   should.attempt 
+00002ec0: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
+00002ed0: 7572 6522 2063 6f6e 6e65 6374 696f 6e20  ure" connection 
+00002ee0: 746f 2070 6f72 7420 3231 3133 206f 6e20  to port 2113 on 
+00002ef0: 226c 6f63 616c 686f 7374 222c 2061 6e64  "localhost", and
+00002f00: 2075 7365 2074 6865 0a63 6c69 656e 7420   use the.client 
+00002f10: 6372 6564 656e 7469 616c 7320 2275 7365  credentials "use
+00002f20: 726e 616d 6522 2061 6e64 2022 7061 7373  rname" and "pass
+00002f30: 776f 7264 2220 7768 656e 206d 616b 696e  word" when makin
+00002f40: 6720 6361 6c6c 7320 746f 2074 6865 2073  g calls to the s
+00002f50: 6572 7665 722e 0a0a 2020 2020 6573 6462  erver...    esdb
+00002f60: 3a2f 2f75 7365 726e 616d 653a 7061 7373  ://username:pass
+00002f70: 776f 7264 406c 6f63 616c 686f 7374 3a32  word@localhost:2
+00002f80: 3131 333f 546c 733d 7472 7565 0a0a 5468  113?Tls=true..Th
+00002f90: 6520 636c 6965 6e74 206d 7573 7420 6265  e client must be
+00002fa0: 2063 6f6e 6669 6775 7265 6420 746f 2063   configured to c
+00002fb0: 7265 6174 6520 6120 2273 6563 7572 6522  reate a "secure"
+00002fc0: 2063 6f6e 6e65 6374 696f 6e20 746f 2061   connection to a
+00002fd0: 2022 7365 6375 7265 2220 7365 7276 6572   "secure" server
+00002fe0: 2c0a 6f72 2061 6c74 6572 6e61 7469 7665  ,.or alternative
+00002ff0: 6c79 2061 6e20 2269 6e73 6563 7572 6522  ly an "insecure"
+00003000: 2063 6f6e 6e65 6374 696f 6e20 746f 2061   connection to a
+00003010: 6e20 2269 6e73 6563 7572 6522 2073 6572  n "insecure" ser
+00003020: 7665 722e 2042 7920 6465 6661 756c 742c  ver. By default,
+00003030: 2074 6865 0a63 6c69 656e 7420 7769 6c6c   the.client will
+00003040: 2061 7474 656d 7074 2074 6f20 6372 6561   attempt to crea
+00003050: 7465 2061 2022 7365 6375 7265 2220 636f  te a "secure" co
+00003060: 6e6e 6563 7469 6f6e 2e20 416e 6420 736f  nnection. And so
+00003070: 2c20 7768 656e 2063 6f6e 6e65 6374 696e  , when connectin
+00003080: 6720 746f 2061 6e0a 2269 6e73 6563 7572  g to an."insecur
+00003090: 6522 2073 6572 7665 722c 2074 6865 2063  e" server, the c
+000030a0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+000030b0: 206d 7573 7420 7370 6563 6966 7920 7468   must specify th
+000030c0: 6174 2074 6865 2063 6c69 656e 7420 7368  at the client sh
+000030d0: 6f75 6c64 2061 7474 656d 7074 0a74 6f20  ould attempt.to 
+000030e0: 6d61 6b65 2061 6e20 2269 6e73 6563 7572  make an "insecur
+000030f0: 6522 2063 6f6e 6e65 6374 696f 6e2e 0a0a  e" connection...
+00003100: 5468 6520 666f 6c6c 6f77 696e 6720 636f  The following co
+00003110: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00003120: 7370 6563 6966 6965 7320 7468 6174 2074  specifies that t
+00003130: 6865 2063 6c69 656e 7420 7368 6f75 6c64  he client should
+00003140: 0a61 7474 656d 7074 2074 6f20 6372 6561  .attempt to crea
+00003150: 7465 2061 6e20 2269 6e73 6563 7572 6522  te an "insecure"
+00003160: 2063 6f6e 6e65 6374 696f 6e20 746f 2070   connection to p
+00003170: 6f72 7420 3231 3134 206f 6e20 226c 6f63  ort 2114 on "loc
+00003180: 616c 686f 7374 222e 0a57 6865 6e20 636f  alhost"..When co
+00003190: 6e6e 6563 7469 6e67 2074 6f20 616e 2022  nnecting to an "
+000031a0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+000031b0: 2c20 7468 6520 636c 6965 6e74 2077 696c  , the client wil
+000031c0: 6c20 6967 6e6f 7265 2061 6e79 0a75 7365  l ignore any.use
+000031d0: 726e 616d 6520 616e 6420 7061 7373 776f  rname and passwo
+000031e0: 7264 2069 6e66 6f72 6d61 7469 6f6e 2069  rd information i
+000031f0: 6e63 6c75 6465 6420 696e 2074 6865 2063  ncluded in the c
+00003200: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00003210: 2c0a 736f 2074 6861 7420 7573 6572 6e61  ,.so that userna
+00003220: 6d65 7320 616e 6420 7061 7373 776f 7264  mes and password
+00003230: 7320 6172 6520 6e6f 7420 7365 6e74 206f  s are not sent o
+00003240: 7665 7220 616e 2022 696e 7365 6375 7265  ver an "insecure
+00003250: 2220 636f 6e6e 6563 7469 6f6e 2e0a 0a20  " connection... 
+00003260: 2020 2065 7364 623a 2f2f 6c6f 6361 6c68     esdb://localh
+00003270: 6f73 743a 3231 3134 3f54 6c73 3d66 616c  ost:2114?Tls=fal
+00003280: 7365 0a0a 506c 6561 7365 206e 6f74 652c  se..Please note,
+00003290: 2074 6865 2022 696e 7365 6375 7265 2220   the "insecure" 
+000032a0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+000032b0: 6720 7573 6573 2061 2071 7565 7279 2073  g uses a query s
+000032c0: 7472 696e 6720 7769 7468 2074 6865 2066  tring with the f
+000032d0: 6965 6c64 2d76 616c 7565 0a60 546c 733d  ield-value.`Tls=
+000032e0: 6661 6c73 6560 2e20 5468 6520 7661 6c75  false`. The valu
+000032f0: 6520 6f66 2074 6869 7320 6669 656c 6420  e of this field 
+00003300: 6973 2062 7920 6465 6661 756c 7420 6074  is by default `t
+00003310: 7275 6560 2e20 556e 6c65 7373 2074 6865  rue`. Unless the
+00003320: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+00003330: 6e67 0a55 5249 2069 6e63 6c75 6465 7320  ng.URI includes 
+00003340: 7468 6520 6669 656c 642d 7661 6c75 6520  the field-value 
+00003350: 6054 6c73 3d66 616c 7365 6020 696e 2074  `Tls=false` in t
+00003360: 6865 2071 7565 7279 2073 7472 696e 672c  he query string,
+00003370: 2074 6865 2060 726f 6f74 5f63 6572 7469   the `root_certi
+00003380: 6669 6361 7465 7360 0a63 6f6e 7374 7275  ficates`.constru
+00003390: 6374 6f72 2061 7267 756d 656e 7420 6973  ctor argument is
+000033a0: 2061 6c73 6f20 7265 7175 6972 6564 2e0a   also required..
+000033b0: 0a57 6865 6e20 636f 6e6e 6563 7469 6e67  .When connecting
+000033c0: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
+000033d0: 6572 7665 722c 2074 6865 2060 726f 6f74  erver, the `root
+000033e0: 5f63 6572 7469 6669 6361 7465 7360 2061  _certificates` a
+000033f0: 7267 756d 656e 7420 6973 2065 7870 6563  rgument is expec
+00003400: 7465 6420 746f 0a62 6520 6120 5079 7468  ted to.be a Pyth
+00003410: 6f6e 2060 7374 7260 2063 6f6e 7461 696e  on `str` contain
+00003420: 696e 6720 5045 4d20 656e 636f 6465 6420  ing PEM encoded 
+00003430: 5353 4c2f 544c 5320 726f 6f74 2063 6572  SSL/TLS root cer
+00003440: 7469 6669 6361 7465 732e 2054 6869 7320  tificates. This 
+00003450: 7661 6c75 6520 6973 0a70 6173 7365 6420  value is.passed 
+00003460: 6469 7265 6374 6c79 2074 6f20 6067 7270  directly to `grp
+00003470: 632e 7373 6c5f 6368 616e 6e65 6c5f 6372  c.ssl_channel_cr
+00003480: 6564 656e 7469 616c 7328 2960 2e20 4974  edentials()`. It
+00003490: 2069 7320 7573 6564 2066 6f72 2061 7574   is used for aut
+000034a0: 6865 6e74 6963 6174 696e 6720 7468 650a  henticating the.
+000034b0: 7365 7276 6572 2074 6f20 7468 6520 636c  server to the cl
+000034c0: 6965 6e74 2e20 4974 2069 7320 636f 6d6d  ient. It is comm
+000034d0: 6f6e 6c79 2074 6865 2063 6572 7469 6669  only the certifi
+000034e0: 6361 7465 206f 6620 7468 6520 6365 7274  cate of the cert
+000034f0: 6966 6963 6174 6520 6175 7468 6f72 6974  ificate authorit
+00003500: 7920 7468 6174 0a77 6173 2072 6573 706f  y that.was respo
+00003510: 6e73 6962 6c65 2066 6f72 2067 656e 6572  nsible for gener
+00003520: 6174 696e 6720 7468 6520 5353 4c2f 544c  ating the SSL/TL
+00003530: 5320 6365 7274 6966 6963 6174 6520 7573  S certificate us
+00003540: 6564 2062 7920 7468 6520 4576 656e 7453  ed by the EventS
+00003550: 746f 7265 4442 2073 6572 7665 722e 0a42  toreDB server..B
+00003560: 7574 2c20 616c 7465 726e 6174 6976 656c  ut, alternativel
+00003570: 7920 666f 7220 6465 7665 6c6f 706d 656e  y for developmen
+00003580: 742c 2079 6f75 2063 616e 2075 7365 2074  t, you can use t
+00003590: 6865 2073 6572 7665 7227 7320 6365 7274  he server's cert
+000035a0: 6966 6963 6174 6520 6974 7365 6c66 2e0a  ificate itself..
+000035b0: 0a49 6e20 7468 6520 6578 616d 706c 6520  .In the example 
+000035c0: 6265 6c6f 772c 2074 6865 2063 6f6e 7374  below, the const
+000035d0: 7275 6374 6f72 2061 7267 756d 656e 7420  ructor argument 
+000035e0: 7661 6c75 6573 2061 7265 2074 616b 656e  values are taken
+000035f0: 2066 726f 6d20 7468 6520 6f70 6572 6174   from the operat
+00003600: 696e 670a 7379 7374 656d 2065 6e76 6972  ing.system envir
+00003610: 6f6e 6d65 6e74 2e20 5468 6973 2069 7320  onment. This is 
+00003620: 6120 7479 7069 6361 6c20 6172 7261 6e67  a typical arrang
+00003630: 656d 656e 7420 696e 2061 2070 726f 6475  ement in a produ
+00003640: 6374 696f 6e20 656e 7669 726f 6e6d 656e  ction environmen
+00003650: 742e 2049 7420 6973 0a64 6f6e 6520 7468  t. It is.done th
+00003660: 6973 2077 6179 2068 6572 6520 736f 2074  is way here so t
+00003670: 6861 7420 7468 6520 636f 6465 2069 6e20  hat the code in 
+00003680: 7468 6973 2064 6f63 756d 656e 7461 7469  this documentati
+00003690: 6f6e 2063 616e 2062 6520 7465 7374 6564  on can be tested
+000036a0: 2077 6974 6820 626f 7468 0a61 2022 7365   with both.a "se
+000036b0: 6375 7265 2220 616e 6420 616e 2022 696e  cure" and an "in
+000036c0: 7365 6375 7265 2220 7365 7276 6572 2e0a  secure" server..
+000036d0: 0a60 6060 7079 7468 6f6e 0a69 6d70 6f72  .```python.impor
+000036e0: 7420 6f73 0a0a 636c 6965 6e74 203d 2045  t os..client = E
+000036f0: 5344 4243 6c69 656e 7428 0a20 2020 2075  SDBClient(.    u
+00003700: 7269 3d6f 732e 6765 7465 6e76 2822 4553  ri=os.getenv("ES
+00003710: 4442 5f55 5249 2229 2c0a 2020 2020 726f  DB_URI"),.    ro
+00003720: 6f74 5f63 6572 7469 6669 6361 7465 733d  ot_certificates=
+00003730: 6f73 2e67 6574 656e 7628 2245 5344 425f  os.getenv("ESDB_
+00003740: 524f 4f54 5f43 4552 5449 4649 4341 5445  ROOT_CERTIFICATE
+00003750: 5322 292c 0a29 0a60 6060 0a0a 2323 2043  S"),.).```..## C
+00003760: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00003770: 730a 0a41 6e20 4576 656e 7453 746f 7265  s..An EventStore
+00003780: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
+00003790: 7269 6e67 2069 7320 6120 5552 4920 7468  ring is a URI th
+000037a0: 6174 2063 6f6e 666f 726d 7320 7769 7468  at conforms with
+000037b0: 206f 6e65 206f 6620 7477 6f20 706f 7373   one of two poss
+000037c0: 6962 6c65 0a73 6368 656d 6573 3a20 6569  ible.schemes: ei
+000037d0: 7468 6572 2074 6865 2022 6573 6462 2220  ther the "esdb" 
+000037e0: 7363 6865 6d65 2c20 6f72 2074 6865 2022  scheme, or the "
+000037f0: 6573 6462 2b64 6973 636f 7665 7222 2073  esdb+discover" s
+00003800: 6368 656d 652e 0a0a 5468 6520 7379 6e74  cheme...The synt
+00003810: 6178 2061 6e64 2073 656d 616e 7469 6373  ax and semantics
+00003820: 206f 6620 7468 6520 4576 656e 7453 746f   of the EventSto
+00003830: 7265 4442 2055 5249 2073 6368 656d 6573  reDB URI schemes
+00003840: 2061 7265 2064 6573 6372 6962 6564 2062   are described b
+00003850: 656c 6f77 2e20 5468 650a 7379 6e74 6178  elow. The.syntax
+00003860: 2069 7320 6465 6669 6e65 6420 7573 696e   is defined usin
+00003870: 6720 5b45 424e 465d 2868 7474 7073 3a2f  g [EBNF](https:/
+00003880: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+00003890: 672f 7769 6b69 2f45 7874 656e 6465 645f  g/wiki/Extended_
+000038a0: 4261 636b 7573 e280 934e 6175 725f 666f  Backus...Naur_fo
+000038b0: 726d 292e 0a0a 2323 2320 5477 6f20 7363  rm)...### Two sc
+000038c0: 6865 6d65 730a 0a54 6865 2022 6573 6462  hemes..The "esdb
+000038d0: 2220 5552 4920 7363 6865 6d65 2063 616e  " URI scheme can
+000038e0: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
+000038f0: 6865 2066 6f6c 6c6f 7769 6e67 2077 6179  he following way
+00003900: 2e0a 0a20 2020 2065 7364 622d 7572 6920  ...    esdb-uri 
+00003910: 3d20 2265 7364 623a 2f2f 2220 2c20 5b20  = "esdb://" , [ 
+00003920: 7573 6572 2d69 6e66 6f20 2c20 2240 2220  user-info , "@" 
+00003930: 5d20 2c20 6772 7063 2d74 6172 6765 742c  ] , grpc-target,
+00003940: 207b 2022 2c22 202c 2067 7270 632d 7461   { "," , grpc-ta
+00003950: 7267 6574 207d 202c 205b 2022 3f22 202c  rget } , [ "?" ,
+00003960: 2071 7565 7279 2d73 7472 696e 6720 5d20   query-string ] 
+00003970: 3b0a 0a49 6e20 7468 6520 2265 7364 6222  ;..In the "esdb"
+00003980: 2055 5249 2073 6368 656d 652c 2061 6674   URI scheme, aft
+00003990: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
+000039a0: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+000039b0: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
+000039c0: 6174 206c 6561 7374 0a6f 6e65 2067 5250  at least.one gRP
+000039d0: 4320 7461 7267 6574 2e20 4966 2074 6865  C target. If the
+000039e0: 7265 2061 7265 2073 6576 6572 616c 2067  re are several g
+000039f0: 5250 4320 7461 7267 6574 732c 2074 6865  RPC targets, the
+00003a00: 7920 6d75 7374 2062 6520 7365 7061 7261  y must be separa
+00003a10: 7465 6420 6672 6f6d 2065 6163 680a 6f74  ted from each.ot
+00003a20: 6865 7220 7769 7468 2074 6865 2022 2c22  her with the ","
+00003a30: 2063 6861 7261 6374 6572 2e20 4561 6368   character. Each
+00003a40: 2067 5250 4320 7461 7267 6574 2073 686f   gRPC target sho
+00003a50: 756c 6420 696e 6469 6361 7465 2061 6e20  uld indicate an 
+00003a60: 4576 656e 7453 746f 7265 4442 2067 5250  EventStoreDB gRP
+00003a70: 430a 7365 7276 6572 2073 6f63 6b65 742c  C.server socket,
+00003a80: 2062 7920 7370 6563 6966 7969 6e67 2061   by specifying a
+00003a90: 2068 6f73 7420 616e 6420 6120 706f 7274   host and a port
+00003aa0: 206e 756d 6265 7220 7365 7061 7261 7465   number separate
+00003ab0: 6420 7769 7468 2074 6865 2022 3a22 2063  d with the ":" c
+00003ac0: 6861 7261 6374 6572 2e0a 5468 6520 686f  haracter..The ho
+00003ad0: 7374 206d 6179 2062 6520 6120 686f 7374  st may be a host
+00003ae0: 6e61 6d65 2074 6861 7420 6361 6e20 6265  name that can be
+00003af0: 2072 6573 6f6c 7665 6420 746f 2061 6e20   resolved to an 
+00003b00: 4950 2061 6464 7265 7373 2c20 6f72 2061  IP address, or a
+00003b10: 6e20 4950 2061 6464 7265 7373 2e0a 0a20  n IP address... 
+00003b20: 2020 2067 7270 632d 7461 7267 6574 203d     grpc-target =
+00003b30: 2028 2068 6f73 746e 616d 6520 7c20 6970   ( hostname | ip
+00003b40: 2d61 6464 7265 7373 2029 202c 2022 3a22  -address ) , ":"
+00003b50: 202c 2070 6f72 742d 6e75 6d62 6572 203b   , port-number ;
+00003b60: 0a0a 0a54 6865 2022 6573 6462 2b64 6973  ...The "esdb+dis
+00003b70: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
+00003b80: 6520 6361 6e20 6265 2064 6566 696e 6564  e can be defined
+00003b90: 2069 6e20 7468 6520 666f 6c6c 6f77 696e   in the followin
+00003ba0: 6720 7761 792e 0a0a 2020 2020 6573 6462  g way...    esdb
+00003bb0: 2d64 6973 636f 7665 722d 7572 6920 3d20  -discover-uri = 
+00003bc0: 2265 7364 622b 6469 7363 6f76 6572 3a2f  "esdb+discover:/
+00003bd0: 2f22 202c 205b 2075 7365 722d 696e 666f  /" , [ user-info
+00003be0: 2c20 2240 2220 5d20 2c20 636c 7573 7465  , "@" ] , cluste
+00003bf0: 722d 646f 6d61 696e 6e61 6d65 202c 205b  r-domainname , [
+00003c00: 2022 3f22 202c 2071 7565 7279 2d73 7472   "?" , query-str
+00003c10: 696e 6720 5d20 3b0a 0a49 6e20 7468 6520  ing ] ;..In the 
+00003c20: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
+00003c30: 5552 4920 7363 6865 6d65 2c20 6166 7465  URI scheme, afte
+00003c40: 7220 7468 6520 6f70 7469 6f6e 616c 2075  r the optional u
+00003c50: 7365 7220 696e 666f 2073 7472 696e 672c  ser info string,
+00003c60: 2074 6865 7265 206d 7573 7420 6265 2061   there must be a
+00003c70: 0a64 6f6d 6169 6e20 6e61 6d65 2077 6869  .domain name whi
+00003c80: 6368 2073 686f 756c 6420 6964 656e 7469  ch should identi
+00003c90: 6679 2061 2063 6c75 7374 6572 206f 6620  fy a cluster of 
+00003ca0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00003cb0: 7665 7273 2e20 5468 6520 636c 6965 6e74  vers. The client
+00003cc0: 2077 696c 6c20 7573 650a 6120 444e 5320   will use.a DNS 
+00003cd0: 7365 7276 6572 2074 6f20 7265 736f 6c76  server to resolv
+00003ce0: 6520 7468 6520 646f 6d61 696e 206e 616d  e the domain nam
+00003cf0: 6520 746f 2061 206c 6973 7420 6f66 2061  e to a list of a
+00003d00: 6464 7265 7373 6573 206f 6620 4576 656e  ddresses of Even
+00003d10: 7453 746f 7265 4442 2073 6572 7665 7273  tStoreDB servers
+00003d20: 2c0a 6279 2071 7565 7279 696e 6720 666f  ,.by querying fo
+00003d30: 7220 2741 2720 7265 636f 7264 732e 2049  r 'A' records. I
+00003d40: 6e20 7468 6973 2063 6173 652c 2074 6865  n this case, the
+00003d50: 2070 6f72 7420 6e75 6d62 6572 2022 3231   port number "21
+00003d60: 3133 2220 7769 6c6c 2062 6520 7573 6564  13" will be used
+00003d70: 2074 6f0a 636f 6e73 7472 7563 7420 6752   to.construct gR
+00003d80: 5043 2074 6172 6765 7473 2066 726f 6d20  PC targets from 
+00003d90: 7468 6520 6164 6472 6573 7365 7320 6f62  the addresses ob
+00003da0: 7461 696e 6564 2066 726f 6d20 2741 2720  tained from 'A' 
+00003db0: 7265 636f 7264 7320 7072 6f76 6964 6564  records provided
+00003dc0: 2062 7920 7468 650a 444e 5320 7365 7276   by the.DNS serv
+00003dd0: 6572 2e20 5468 6572 6566 6f72 652c 2069  er. Therefore, i
+00003de0: 6620 796f 7520 7761 6e74 2074 6f20 7573  f you want to us
+00003df0: 6520 7468 6520 2265 7364 622b 6469 7363  e the "esdb+disc
+00003e00: 6f76 6572 2220 5552 4920 7363 6865 6d65  over" URI scheme
+00003e10: 2c20 796f 7520 7769 6c6c 0a6e 6565 6420  , you will.need 
+00003e20: 746f 2063 6f6e 6669 6775 7265 2044 4e53  to configure DNS
+00003e30: 2077 6865 6e20 7365 7474 696e 6720 7570   when setting up
+00003e40: 2079 6f75 7220 4576 656e 7453 746f 7265   your EventStore
+00003e50: 4442 2063 6c75 7374 6572 2e0a 0a57 6974  DB cluster...Wit
+00003e60: 6820 626f 7468 2074 6865 2022 6573 6462  h both the "esdb
+00003e70: 2220 616e 6420 2265 7364 622b 6469 7363  " and "esdb+disc
+00003e80: 6f76 6572 2220 5552 4920 7363 6865 6d65  over" URI scheme
+00003e90: 732c 2074 6865 2063 6c69 656e 7420 6669  s, the client fi
+00003ea0: 7273 746c 7920 6f62 7461 696e 730a 6120  rstly obtains.a 
+00003eb0: 6c69 7374 206f 6620 6752 5043 2074 6172  list of gRPC tar
+00003ec0: 6765 7473 3a20 6569 7468 6572 2064 6972  gets: either dir
+00003ed0: 6563 746c 7920 6672 6f6d 2022 6573 6462  ectly from "esdb
+00003ee0: 2220 636f 6e6e 6563 7469 6f6e 2073 7472  " connection str
+00003ef0: 696e 6773 3b20 6f72 2069 6e64 6972 6563  ings; or indirec
+00003f00: 746c 790a 6672 6f6d 2022 6573 6462 2b64  tly.from "esdb+d
+00003f10: 6973 636f 7665 7222 2063 6f6e 6e65 6374  iscover" connect
+00003f20: 696f 6e20 7374 7269 6e67 7320 7669 6120  ion strings via 
+00003f30: 444e 532e 2054 6869 7320 6c69 7374 206f  DNS. This list o
+00003f40: 6620 7461 7267 6574 7320 6973 206b 6e6f  f targets is kno
+00003f50: 776e 2061 7320 7468 650a 2267 6f73 7369  wn as the."gossi
+00003f60: 7020 7365 6564 222e 2054 6865 2063 6c69  p seed". The cli
+00003f70: 656e 7420 7769 6c6c 2074 6865 6e20 6174  ent will then at
+00003f80: 7465 6d70 7420 746f 2063 6f6e 6e65 6374  tempt to connect
+00003f90: 2074 6f20 6561 6368 2067 5250 4320 7461   to each gRPC ta
+00003fa0: 7267 6574 2069 6e20 7475 726e 2c0a 6174  rget in turn,.at
+00003fb0: 7465 6d70 7469 6e67 2074 6f20 6361 6c6c  tempting to call
+00003fc0: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
+00003fd0: 4220 476f 7373 6970 2041 5049 2074 6f20  B Gossip API to 
+00003fe0: 6f62 7461 696e 2069 6e66 6f72 6d61 7469  obtain informati
+00003ff0: 6f6e 2061 626f 7574 2074 6865 0a45 7665  on about the.Eve
+00004000: 6e74 5374 6f72 6544 4220 636c 7573 7465  ntStoreDB cluste
+00004010: 722e 2041 206d 656d 6265 7220 6f66 2074  r. A member of t
+00004020: 6865 2063 6c75 7374 6572 2069 7320 7365  he cluster is se
+00004030: 6c65 6374 6564 2062 7920 7468 6520 636c  lected by the cl
+00004040: 6965 6e74 2c20 6163 636f 7264 696e 670a  ient, according.
+00004050: 746f 2074 6865 2022 6e6f 6465 2070 7265  to the "node pre
+00004060: 6665 7265 6e63 6522 206f 7074 696f 6e2e  ference" option.
+00004070: 2054 6865 2063 6c69 656e 7420 6d61 7920   The client may 
+00004080: 7468 656e 206e 6565 6420 746f 2063 6c6f  then need to clo
+00004090: 7365 2069 7473 0a63 6f6e 6e65 6374 696f  se its.connectio
+000040a0: 6e20 616e 6420 7265 636f 6e6e 6563 7420  n and reconnect 
+000040b0: 746f 2074 6865 2073 656c 6563 7465 6420  to the selected 
+000040c0: 7365 7276 6572 2e0a 0a23 2323 2055 7365  server...### Use
+000040d0: 7220 696e 666f 2073 7472 696e 670a 0a49  r info string..I
+000040e0: 6e20 626f 7468 2074 6865 2022 6573 6462  n both the "esdb
+000040f0: 2220 616e 6420 2265 7364 622b 6469 7363  " and "esdb+disc
+00004100: 6f76 6572 2220 7363 6865 6d65 732c 2074  over" schemes, t
+00004110: 6865 2055 5249 206d 6179 2069 6e63 6c75  he URI may inclu
+00004120: 6465 2061 2075 7365 7220 696e 666f 2073  de a user info s
+00004130: 7472 696e 672e 0a49 6620 6974 2065 7869  tring..If it exi
+00004140: 7374 7320 696e 2074 6865 2055 5249 2c20  sts in the URI, 
+00004150: 7468 6520 7573 6572 2069 6e66 6f20 7374  the user info st
+00004160: 7269 6e67 206d 7573 7420 6265 2073 6570  ring must be sep
+00004170: 6172 6174 6564 2066 726f 6d20 7468 6520  arated from the 
+00004180: 7265 7374 206f 6620 7468 6520 5552 490a  rest of the URI.
+00004190: 7769 7468 2074 6865 2022 4022 2063 6861  with the "@" cha
+000041a0: 7261 6374 6572 2e20 5468 6520 7573 6572  racter. The user
+000041b0: 2069 6e66 6f20 7374 7269 6e67 206d 7573   info string mus
+000041c0: 7420 696e 636c 7564 6520 6120 7573 6572  t include a user
+000041d0: 6e61 6d65 2061 6e64 2061 2070 6173 7377  name and a passw
+000041e0: 6f72 642c 0a73 6570 6172 6174 6564 2077  ord,.separated w
+000041f0: 6974 6820 7468 6520 223a 2220 6368 6172  ith the ":" char
+00004200: 6163 7465 722e 0a0a 2020 2020 7573 6572  acter...    user
+00004210: 2d69 6e66 6f20 3d20 7573 6572 6e61 6d65  -info = username
+00004220: 202c 2022 3a22 202c 2070 6173 7377 6f72   , ":" , passwor
+00004230: 6420 3b0a 0a54 6865 2075 7365 7220 696e  d ;..The user in
+00004240: 666f 2069 7320 7365 6e74 2062 7920 7468  fo is sent by th
+00004250: 6520 636c 6965 6e74 2061 7320 2263 616c  e client as "cal
+00004260: 6c20 6372 6564 656e 7469 616c 7322 2069  l credentials" i
+00004270: 6e20 6561 6368 2063 616c 6c20 746f 2061  n each call to a
+00004280: 2022 7365 6375 7265 220a 7365 7276 6572   "secure".server
+00004290: 2c20 696e 2061 2022 6261 7369 6320 6175  , in a "basic au
+000042a0: 7468 2220 6175 7468 6f72 697a 6174 696f  th" authorizatio
+000042b0: 6e20 6865 6164 6572 2e20 5468 6973 2061  n header. This a
+000042c0: 7574 686f 7269 7a61 7469 6f6e 2068 6561  uthorization hea
+000042d0: 6465 7220 6973 2075 7365 6420 6279 0a74  der is used by.t
+000042e0: 6865 2073 6572 7665 7220 746f 2061 7574  he server to aut
+000042f0: 6865 6e74 6963 6174 6520 7468 6520 636c  henticate the cl
+00004300: 6965 6e74 2e20 5468 6520 6175 7468 6f72  ient. The author
+00004310: 697a 6174 696f 6e20 6865 6164 6572 2069  ization header i
+00004320: 7320 6e6f 7420 7365 6e74 2074 6f0a 2269  s not sent to."i
+00004330: 6e73 6563 7572 6522 2073 6572 7665 7273  nsecure" servers
+00004340: 2e0a 0a23 2323 2051 7565 7279 2073 7472  ...### Query str
+00004350: 696e 670a 0a49 6e20 626f 7468 2074 6865  ing..In both the
+00004360: 2022 6573 6462 2220 616e 6420 2265 7364   "esdb" and "esd
+00004370: 622b 6469 7363 6f76 6572 2220 7363 6865  b+discover" sche
+00004380: 6d65 732c 2074 6865 206f 7074 696f 6e61  mes, the optiona
+00004390: 6c20 7175 6572 7920 7374 7269 6e67 206d  l query string m
+000043a0: 7573 7420 6265 206f 6e65 0a6f 7220 6d61  ust be one.or ma
+000043b0: 6e79 2066 6965 6c64 2d76 616c 7565 2061  ny field-value a
+000043c0: 7267 756d 656e 7473 2c20 7365 7061 7261  rguments, separa
+000043d0: 7465 6420 6672 6f6d 2065 6163 6820 6f74  ted from each ot
+000043e0: 6865 7220 7769 7468 2074 6865 2022 2622  her with the "&"
+000043f0: 2063 6861 7261 6374 6572 2e0a 0a20 2020   character...   
+00004400: 2071 7565 7279 2d73 7472 696e 6720 3d20   query-string = 
+00004410: 6669 656c 642d 7661 6c75 652c 207b 2022  field-value, { "
+00004420: 2622 2c20 6669 656c 642d 7661 6c75 6520  &", field-value 
+00004430: 7d20 3b0a 0a45 6163 6820 6669 656c 642d  } ;..Each field-
+00004440: 7661 6c75 6520 6172 6775 6d65 6e74 206d  value argument m
+00004450: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
+00004460: 6520 7375 7070 6f72 7465 6420 6669 656c  e supported fiel
+00004470: 6473 2c20 616e 6420 616e 0a61 7070 726f  ds, and an.appro
+00004480: 7072 6961 7465 2076 616c 7565 2c20 7365  priate value, se
+00004490: 7061 7261 7465 6420 7769 7468 2074 6865  parated with the
+000044a0: 2022 3d22 2063 6861 7261 6374 6572 2e0a   "=" character..
+000044b0: 0a20 2020 2066 6965 6c64 2d76 616c 7565  .    field-value
+000044c0: 203d 2028 2022 546c 7322 2c20 223d 2220   = ( "Tls", "=" 
+000044d0: 2c20 2274 7275 6522 207c 2022 6661 6c73  , "true" | "fals
+000044e0: 6522 2029 0a20 2020 2020 2020 2020 2020  e" ).           
+000044f0: 2020 2020 207c 2028 2022 546c 7356 6572       | ( "TlsVer
+00004500: 6966 7943 6572 7422 2c20 223d 2220 2c20  ifyCert", "=" , 
+00004510: 2274 7275 6522 207c 2022 6661 6c73 6522  "true" | "false"
+00004520: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00004530: 2020 207c 2028 2022 436f 6e6e 6563 7469     | ( "Connecti
+00004540: 6f6e 4e61 6d65 222c 2022 3d22 202c 2073  onName", "=" , s
+00004550: 7472 696e 6720 290a 2020 2020 2020 2020  tring ).        
+00004560: 2020 2020 2020 2020 7c20 2820 224e 6f64          | ( "Nod
+00004570: 6550 7265 6665 7265 6e63 6522 2c20 223d  ePreference", "=
+00004580: 2220 2c20 226c 6561 6465 7222 207c 2022  " , "leader" | "
+00004590: 666f 6c6c 6f77 6572 2220 7c20 2272 6561  follower" | "rea
+000045a0: 646f 6e6c 7972 6570 6c69 6361 2220 7c20  donlyreplica" | 
+000045b0: 2272 616e 646f 6d22 2029 0a20 2020 2020  "random" ).     
+000045c0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+000045d0: 4465 6661 756c 7444 6561 646c 696e 6522  DefaultDeadline"
+000045e0: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+000045f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00004600: 2020 7c20 2820 2247 6f73 7369 7054 696d    | ( "GossipTim
+00004610: 656f 7574 222c 2022 3d22 202c 2069 6e74  eout", "=" , int
+00004620: 6567 6572 2029 0a20 2020 2020 2020 2020  eger ).         
+00004630: 2020 2020 2020 207c 2028 2022 4d61 7844         | ( "MaxD
+00004640: 6973 636f 7665 7241 7474 656d 7074 7322  iscoverAttempts"
+00004650: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+00004660: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00004670: 2020 7c20 2820 2244 6973 636f 7665 7279    | ( "Discovery
+00004680: 496e 7465 7276 616c 222c 2022 3d22 202c  Interval", "=" ,
+00004690: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
+000046a0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+000046b0: 4d61 7844 6973 636f 7665 7241 7474 656d  MaxDiscoverAttem
+000046c0: 7074 7322 2c20 223d 2220 2c20 696e 7465  pts", "=" , inte
+000046d0: 6765 7220 290a 2020 2020 2020 2020 2020  ger ).          
+000046e0: 2020 2020 2020 7c20 2820 224b 6565 7041        | ( "KeepA
+000046f0: 6c69 7665 496e 7465 7276 616c 222c 2022  liveInterval", "
+00004700: 3d22 202c 2069 6e74 6567 6572 2029 0a20  =" , integer ). 
+00004710: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00004720: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
+00004730: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00004740: 7465 6765 7220 2920 3b0a 0a54 6865 2074  teger ) ;..The t
+00004750: 6162 6c65 2062 656c 6f77 2064 6573 6372  able below descr
+00004760: 6962 6573 2074 6865 2071 7565 7279 2066  ibes the query f
+00004770: 6965 6c64 2d76 616c 7565 7320 7375 7070  ield-values supp
+00004780: 6f72 7465 6420 6279 2074 6869 7320 636c  orted by this cl
+00004790: 6965 6e74 2e0a 0a7c 2046 6965 6c64 2020  ient...| Field  
+000047a0: 2020 2020 2020 2020 2020 2020 207c 2056               | V
+000047b0: 616c 7565 2020 2020 2020 2020 2020 2020  alue            
+000047c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000047d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000047e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000047f0: 2020 2020 207c 2044 6573 6372 6970 7469       | Descripti
+00004800: 6f6e 2020 2020 2020 2020 2020 2020 2020  on              
+00004810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004890: 2020 2020 2020 2020 207c 0a7c 2d2d 2d2d           |.|----
+000048a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048b0: 2d7c 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  -|--------------
+000048c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048f0: 2d2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d 2d2d  ---------|------
+00004900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c 0a7c  -------------|.|
+000049a0: 2054 6c73 2020 2020 2020 2020 2020 2020   Tls            
+000049b0: 2020 2020 207c 2022 7472 7565 222c 2022       | "true", "
+000049c0: 6661 6c73 6522 2028 6465 6661 756c 743a  false" (default:
+000049d0: 2022 7472 7565 2229 2020 2020 2020 2020   "true")        
+000049e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049f0: 2020 2020 2020 2020 2020 2020 207c 2049               | I
+00004a00: 6620 2274 7275 6522 2074 6865 2063 6c69  f "true" the cli
+00004a10: 656e 7420 7769 6c6c 2063 7265 6174 6520  ent will create 
+00004a20: 6120 2273 6563 7572 6522 2067 5250 4320  a "secure" gRPC 
+00004a30: 6368 616e 6e65 6c2e 2049 6620 2266 616c  channel. If "fal
+00004a40: 7365 2220 7468 6520 636c 6965 6e74 2077  se" the client w
+00004a50: 696c 6c20 6372 6561 7465 2061 6e20 2269  ill create an "i
+00004a60: 6e73 6563 7572 6522 2067 5250 4320 6368  nsecure" gRPC ch
+00004a70: 616e 6e65 6c2e 2054 6869 7320 6d75 7374  annel. This must
+00004a80: 206d 6174 6368 2074 6865 2073 6572 7665   match the serve
+00004a90: 7220 636f 6e66 6967 7572 6174 696f 6e2e  r configuration.
+00004aa0: 207c 0a7c 2054 6c73 5665 7269 6679 4365   |.| TlsVerifyCe
+00004ab0: 7274 2020 2020 2020 207c 2022 7472 7565  rt       | "true
+00004ac0: 222c 2022 6661 6c73 6522 2028 6465 6661  ", "false" (defa
+00004ad0: 756c 743a 2022 7472 7565 2229 2020 2020  ult: "true")    
+00004ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b00: 207c 2054 6869 7320 7661 6c75 6520 6973   | This value is
+00004b10: 2063 7572 7265 6e74 6c79 2069 676e 6f72   currently ignor
+00004b20: 6564 2e20 2020 2020 2020 2020 2020 2020  ed.             
+00004b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ba0: 2020 2020 207c 0a7c 2043 6f6e 6e65 6374       |.| Connect
+00004bb0: 696f 6e4e 616d 6520 2020 2020 207c 2073  ionName      | s
+00004bc0: 7472 696e 6720 2864 6566 6175 6c74 3a20  tring (default: 
+00004bd0: 6175 746f 2d67 656e 6572 6174 6564 2076  auto-generated v
+00004be0: 6572 7369 6f6e 2d34 2055 5549 4429 2020  ersion-4 UUID)  
+00004bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c00: 2020 2020 207c 2053 656e 7420 696e 2063       | Sent in c
+00004c10: 616c 6c20 6d65 7461 6461 7461 2066 6f72  all metadata for
+00004c20: 2065 7665 7279 2063 616c 6c2c 2074 6f20   every call, to 
+00004c30: 6964 656e 7469 6679 2074 6865 2063 6c69  identify the cli
+00004c40: 656e 7420 746f 2074 6865 2063 6c75 7374  ent to the clust
+00004c50: 6572 2e20 2020 2020 2020 2020 2020 2020  er.             
+00004c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ca0: 2020 2020 2020 2020 207c 0a7c 204e 6f64           |.| Nod
+00004cb0: 6550 7265 6665 7265 6e63 6520 2020 2020  ePreference     
+00004cc0: 207c 2022 6c65 6164 6572 222c 2022 666f   | "leader", "fo
+00004cd0: 6c6c 6f77 6572 222c 2022 7265 6164 6f6e  llower", "readon
+00004ce0: 6c79 7265 706c 6963 6122 2c20 2272 616e  lyreplica", "ran
+00004cf0: 646f 6d22 2028 6465 6661 756c 743a 2022  dom" (default: "
+00004d00: 6c65 6164 6572 2229 207c 2054 6865 206e  leader") | The n
+00004d10: 6f64 6520 7374 6174 6520 7072 6566 6572  ode state prefer
+00004d20: 7265 6420 6279 2074 6865 2063 6c69 656e  red by the clien
+00004d30: 742e 2054 6865 2063 6c69 656e 7420 7769  t. The client wi
+00004d40: 6c6c 2073 656c 6563 7420 6120 6e6f 6465  ll select a node
+00004d50: 2066 726f 6d20 7468 6520 636c 7573 7465   from the cluste
+00004d60: 7220 696e 666f 2072 6563 6569 7665 6420  r info received 
+00004d70: 6672 6f6d 2074 6865 2047 6f73 7369 7020  from the Gossip 
+00004d80: 4150 4920 6163 636f 7264 696e 6720 746f  API according to
+00004d90: 2074 6869 7320 7072 6566 6572 656e 6365   this preference
+00004da0: 2e20 2020 2020 2020 2020 2020 207c 0a7c  .            |.|
+00004db0: 2044 6566 6175 6c74 4465 6164 6c69 6e65   DefaultDeadline
+00004dc0: 2020 2020 207c 2069 6e74 6567 6572 2028       | integer (
+00004dd0: 6465 6661 756c 743a 2060 4e6f 6e65 6029  default: `None`)
+00004de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e00: 2020 2020 2020 2020 2020 2020 207c 2054               | T
+00004e10: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00004e20: 2028 696e 2073 6563 6f6e 6473 2920 6f66   (in seconds) of
+00004e30: 2074 6865 2060 7469 6d65 6f75 7460 2061   the `timeout` a
+00004e40: 7267 756d 656e 7420 6f66 2063 6c69 656e  rgument of clien
+00004e50: 7420 2277 7269 7465 2220 6d65 7468 6f64  t "write" method
+00004e60: 7320 7375 6368 2061 7320 6061 7070 656e  s such as `appen
+00004e70: 645f 6576 656e 7473 2829 602e 2020 2020  d_events()`.    
+00004e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004eb0: 207c 0a7c 2047 6f73 7369 7054 696d 656f   |.| GossipTimeo
+00004ec0: 7574 2020 2020 2020 207c 2069 6e74 6567  ut       | integ
+00004ed0: 6572 2028 6465 6661 756c 743a 2035 2920  er (default: 5) 
+00004ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f10: 207c 2054 6865 2064 6566 6175 6c74 2076   | The default v
+00004f20: 616c 7565 2028 696e 2073 6563 6f6e 6473  alue (in seconds
+00004f30: 2920 6f66 2074 6865 2060 7469 6d65 6f75  ) of the `timeou
+00004f40: 7460 2061 7267 756d 656e 7420 6f66 2067  t` argument of g
+00004f50: 6f73 7369 7020 7265 6164 206d 6574 686f  ossip read metho
+00004f60: 6473 2c20 7375 6368 2061 7320 6072 6561  ds, such as `rea
+00004f70: 645f 676f 7373 6970 2829 602e 2020 2020  d_gossip()`.    
+00004f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004fb0: 2020 2020 207c 0a7c 204d 6178 4469 7363       |.| MaxDisc
+00004fc0: 6f76 6572 4174 7465 6d70 7473 207c 2069  overAttempts | i
+00004fd0: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
+00004fe0: 2031 3029 2020 2020 2020 2020 2020 2020   10)            
+00004ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005010: 2020 2020 207c 2054 6865 206e 756d 6265       | The numbe
+00005020: 7220 6f66 2061 7474 656d 7074 7320 746f  r of attempts to
+00005030: 2072 6561 6420 676f 7373 6970 2077 6865   read gossip whe
+00005040: 6e20 636f 6e6e 6563 7469 6e67 206f 7220  n connecting or 
+00005050: 7265 636f 6e6e 6563 7469 6e67 2074 6f20  reconnecting to 
+00005060: 6120 636c 7573 7465 7220 6d65 6d62 6572  a cluster member
+00005070: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+00005080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050b0: 2020 2020 2020 2020 207c 0a7c 2044 6973           |.| Dis
+000050c0: 636f 7665 7279 496e 7465 7276 616c 2020  coveryInterval  
+000050d0: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
+000050e0: 756c 743a 2031 3030 2920 2020 2020 2020  ult: 100)       
+000050f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005110: 2020 2020 2020 2020 207c 2048 6f77 206c           | How l
+00005120: 6f6e 6720 746f 2077 6169 7420 2869 6e20  ong to wait (in 
+00005130: 6d69 6c6c 6973 6563 6f6e 6473 2920 6265  milliseconds) be
+00005140: 7477 6565 6e20 676f 7373 6970 2072 6574  tween gossip ret
+00005150: 7269 6573 2e20 2020 2020 2020 2020 2020  ries.           
+00005160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051b0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
+000051c0: 204b 6565 7041 6c69 7665 496e 7465 7276   KeepAliveInterv
+000051d0: 616c 2020 207c 2069 6e74 6567 6572 2028  al   | integer (
+000051e0: 6465 6661 756c 743a 2060 4e6f 6e65 6029  default: `None`)
+000051f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005210: 2020 2020 2020 2020 2020 2020 207c 2054               | T
+00005220: 6865 2076 616c 7565 206f 6620 7468 6520  he value of the 
+00005230: 2267 7270 632e 6b65 6570 616c 6976 655f  "grpc.keepalive_
+00005240: 6d73 2220 6752 5043 2063 6861 6e6e 656c  ms" gRPC channel
+00005250: 206f 7074 696f 6e2e 2020 2020 2020 2020   option.        
+00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052c0: 207c 0a7c 204b 6565 7041 6c69 7665 5469   |.| KeepAliveTi
+000052d0: 6d65 6f75 7420 2020 207c 2069 6e74 6567  meout    | integ
+000052e0: 6572 2028 6465 6661 756c 743a 2060 4e6f  er (default: `No
+000052f0: 6e65 6029 2020 2020 2020 2020 2020 2020  ne`)            
+00005300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005320: 207c 2054 6865 2076 616c 7565 206f 6620   | The value of 
+00005330: 7468 6520 2267 7270 632e 6b65 6570 616c  the "grpc.keepal
+00005340: 6976 655f 7469 6d65 6f75 745f 6d73 2220  ive_timeout_ms" 
+00005350: 6752 5043 2063 6861 6e6e 656c 206f 7074  gRPC channel opt
+00005360: 696f 6e2e 2020 2020 2020 2020 2020 2020  ion.            
+00005370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053c0: 2020 2020 207c 0a0a 0a23 2323 2045 7861       |...### Exa
+000053d0: 6d70 6c65 730a 0a48 6572 6520 6172 6520  mples..Here are 
+000053e0: 736f 6d65 2065 7861 6d70 6c65 7320 6f66  some examples of
+000053f0: 2045 7665 6e74 5374 6f72 6544 4220 636f   EventStoreDB co
+00005400: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00005410: 5552 4973 2e0a 0a54 6865 2066 6f6c 6c6f  URIs...The follo
+00005420: 7769 6e67 2055 5249 2077 696c 6c20 6361  wing URI will ca
+00005430: 7573 6520 7468 6520 636c 6965 6e74 2074  use the client t
+00005440: 6f20 636f 6e6e 6563 7420 746f 2c20 616e  o connect to, an
+00005450: 6420 6765 740a 636c 7573 7465 7220 696e  d get.cluster in
+00005460: 666f 2c20 6672 6f6d 2022 7365 6375 7265  fo, from "secure
+00005470: 2220 7365 7276 6572 2073 6f63 6b65 7420  " server socket 
+00005480: 606c 6f63 616c 686f 7374 3a32 3131 3360  `localhost:2113`
+00005490: 2e20 416e 640a 7468 656e 2074 6f20 636f  . And.then to co
+000054a0: 6e6e 6563 7420 746f 2061 2022 6c65 6164  nnect to a "lead
+000054b0: 6572 2220 6e6f 6465 2e20 416e 6420 616c  er" node. And al
+000054c0: 736f 2074 6f20 7573 6520 2261 646d 696e  so to use "admin
+000054d0: 2220 616e 640a 2263 6861 6e67 6569 7422  " and."changeit"
+000054e0: 2061 7320 7468 6520 7573 6572 6e61 6d65   as the username
+000054f0: 2061 6e64 2070 6173 7377 6f72 6420 7768   and password wh
+00005500: 656e 206d 616b 696e 6720 6361 6c6c 7320  en making calls 
+00005510: 746f 0a45 7665 6e74 5374 6f72 6544 4220  to.EventStoreDB 
+00005520: 4150 4920 6d65 7468 6f64 732e 0a0a 2020  API methods...  
+00005530: 2020 6573 6462 3a2f 2f61 646d 696e 3a63    esdb://admin:c
+00005540: 6861 6e67 6569 7440 6c6f 6361 6c68 6f73  hangeit@localhos
+00005550: 743a 3231 3133 0a0a 0a54 6865 2066 6f6c  t:2113...The fol
+00005560: 6c6f 7769 6e67 2055 5249 2077 696c 6c20  lowing URI will 
+00005570: 6361 7573 6520 7468 6520 636c 6965 6e74  cause the client
+00005580: 2074 6f20 6765 7420 636c 7573 7465 7220   to get cluster 
+00005590: 696e 666f 2066 726f 6d0a 2269 6e73 6563  info from."insec
+000055a0: 7572 6522 2073 6572 7665 7220 736f 636b  ure" server sock
+000055b0: 6574 2031 3237 2e30 2e30 2e31 3a32 3131  et 127.0.0.1:211
+000055c0: 342e 2020 416e 6420 7468 656e 2074 6f20  4.  And then to 
+000055d0: 636f 6e6e 6563 7420 746f 0a61 2022 6c65  connect to.a "le
+000055e0: 6164 6572 2220 6e6f 6465 2e0a 0a20 2020  ader" node...   
+000055f0: 2065 7364 623a 2f2f 3132 372e 302e 302e   esdb://127.0.0.
+00005600: 313a 3231 3134 3f54 6c73 3d66 616c 7365  1:2114?Tls=false
+00005610: 0a0a 0a54 6865 2066 6f6c 6c6f 7769 6e67  ...The following
+00005620: 2055 5249 2077 696c 6c20 6361 7573 6520   URI will cause 
+00005630: 7468 6520 636c 6965 6e74 2074 6f20 6765  the client to ge
+00005640: 7420 636c 7573 7465 7220 696e 666f 2066  t cluster info f
+00005650: 726f 6d0a 6164 6472 6573 7365 7320 696e  rom.addresses in
+00005660: 2044 4e53 2027 4127 2072 6563 6f72 6473   DNS 'A' records
+00005670: 2066 6f72 2063 6c75 7374 6572 312e 6578   for cluster1.ex
+00005680: 616d 706c 652e 636f 6d2e 2041 6e64 2074  ample.com. And t
+00005690: 6865 6e0a 746f 2063 6f6e 6e65 6374 2074  hen.to connect t
+000056a0: 6f20 6120 226c 6561 6465 7222 206e 6f64  o a "leader" nod
+000056b0: 652e 2041 6e64 2075 7365 2061 2064 6566  e. And use a def
+000056c0: 6175 6c74 2064 6561 646c 696e 6520 6f66  ault deadline of
+000056d0: 2035 0a73 6563 6f6e 6473 2077 6865 6e20   5.seconds when 
+000056e0: 6d61 6b69 6e67 2063 616c 6c73 2074 6f20  making calls to 
+000056f0: 4576 656e 7453 746f 7265 2041 5049 2022  EventStore API "
+00005700: 7772 6974 6522 206d 6574 686f 6473 2e0a  write" methods..
+00005710: 0a20 2020 2065 7364 622b 6469 7363 6f76  .    esdb+discov
+00005720: 6572 3a2f 2f61 646d 696e 3a63 6861 6e67  er://admin:chang
+00005730: 6569 7440 636c 7573 7465 7231 2e65 7861  eit@cluster1.exa
+00005740: 6d70 6c65 2e63 6f6d 3f44 6566 6175 6c74  mple.com?Default
+00005750: 4465 6164 6c69 6e65 3d35 0a0a 0a54 6865  Deadline=5...The
+00005760: 2066 6f6c 6c6f 7769 6e67 2055 5249 2077   following URI w
+00005770: 696c 6c20 6361 7573 6520 7468 6520 636c  ill cause the cl
+00005780: 6965 6e74 2074 6f20 6765 7420 636c 7573  ient to get clus
+00005790: 7465 7220 696e 666f 2066 726f 6d20 6569  ter info from ei
+000057a0: 7468 6572 0a6c 6f63 616c 686f 7374 3a32  ther.localhost:2
+000057b0: 3131 312c 206f 7220 6c6f 6361 6c68 6f73  111, or localhos
+000057c0: 743a 3231 3132 2c20 6f72 206c 6f63 616c  t:2112, or local
+000057d0: 686f 7374 3a32 3131 332e 2041 6e64 2074  host:2113. And t
+000057e0: 6865 6e20 746f 2063 6f6e 6e65 6374 0a74  hen to connect.t
+000057f0: 6f20 6120 2266 6f6c 6c6f 7765 7222 206e  o a "follower" n
+00005800: 6f64 652e 0a0a 2020 2020 6573 6462 3a2f  ode...    esdb:/
+00005810: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
+00005820: 6c6f 6361 6c68 6f73 743a 3231 3131 2c6c  localhost:2111,l
+00005830: 6f63 616c 686f 7374 3a32 3131 322c 6c6f  ocalhost:2112,lo
+00005840: 6361 6c68 6f73 743a 3231 3133 3f4e 6f64  calhost:2113?Nod
+00005850: 6550 7265 6665 7265 6e63 653d 666f 6c6c  ePreference=foll
+00005860: 6f77 6572 0a0a 0a54 6865 2066 6f6c 6c6f  ower...The follo
+00005870: 7769 6e67 2055 5249 2077 696c 6c20 6361  wing URI will ca
+00005880: 7573 6520 7468 6520 636c 6965 6e74 2074  use the client t
+00005890: 6f20 6765 7420 636c 7573 7465 7220 696e  o get cluster in
+000058a0: 666f 2066 726f 6d20 6164 6472 6573 7365  fo from addresse
+000058b0: 7320 696e 0a44 4e53 2027 4127 2072 6563  s in.DNS 'A' rec
+000058c0: 6f72 6473 2066 6f72 2063 6c75 7374 6572  ords for cluster
+000058d0: 312e 6578 616d 706c 652e 636f 6d2e 2041  1.example.com. A
+000058e0: 6e64 2074 6f20 636f 6e66 6967 7572 6520  nd to configure 
+000058f0: 226b 6565 7020 616c 6976 6522 2074 696d  "keep alive" tim
+00005900: 656f 7574 0a61 6e64 2069 6e74 6572 7661  eout.and interva
+00005910: 6c20 696e 2074 6865 2067 5250 4320 6368  l in the gRPC ch
+00005920: 616e 6e65 6c2e 0a0a 2020 2020 6573 6462  annel...    esdb
+00005930: 2b64 6973 636f 7665 723a 2f2f 6164 6d69  +discover://admi
+00005940: 6e3a 6368 616e 6765 6974 4063 6c75 7374  n:changeit@clust
+00005950: 6572 312e 6578 616d 706c 652e 636f 6d3f  er1.example.com?
+00005960: 4b65 6570 416c 6976 6549 6e74 6572 7661  KeepAliveInterva
+00005970: 6c3d 3130 3030 3026 4b65 6570 416c 6976  l=10000&KeepAliv
+00005980: 6554 696d 656f 7574 3d31 3030 3030 0a0a  eTimeout=10000..
+00005990: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
+000059a0: 6520 636c 6965 6e74 2069 7320 696e 7365  e client is inse
+000059b0: 6e73 6974 6976 6520 746f 2074 6865 2063  nsitive to the c
+000059c0: 6173 6520 6f66 2066 6965 6c64 7320 616e  ase of fields an
+000059d0: 6420 7661 6c75 6573 2e20 4966 2066 6965  d values. If fie
+000059e0: 6c64 7320 6172 650a 7265 7065 6174 6564  lds are.repeated
+000059f0: 2069 6e20 7468 6520 7175 6572 7920 7374   in the query st
+00005a00: 7269 6e67 2c20 7468 6520 7175 6572 7920  ring, the query 
+00005a10: 7374 7269 6e67 2077 696c 6c20 6265 2070  string will be p
+00005a20: 6172 7365 6420 7769 7468 6f75 7420 6572  arsed without er
+00005a30: 726f 722e 2048 6f77 6576 6572 2c0a 7468  ror. However,.th
+00005a40: 6520 636f 6e6e 6563 7469 6f6e 206f 7074  e connection opt
+00005a50: 696f 6e73 2075 7365 6420 6279 2074 6865  ions used by the
+00005a60: 2063 6c69 656e 7420 7769 6c6c 2075 7365   client will use
+00005a70: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+00005a80: 6520 6669 7273 7420 6669 656c 642e 2041  e first field. A
+00005a90: 6c6c 0a74 6865 206f 7468 6572 2066 6965  ll.the other fie
+00005aa0: 6c64 2d76 616c 7565 7320 696e 2074 6865  ld-values in the
+00005ab0: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00005ac0: 7468 2074 6865 2073 616d 6520 6669 656c  th the same fiel
+00005ad0: 6420 6e61 6d65 2077 696c 6c20 6265 2069  d name will be i
+00005ae0: 676e 6f72 6564 2e0a 4669 656c 6473 2077  gnored..Fields w
+00005af0: 6974 686f 7574 2076 616c 7565 7320 7769  ithout values wi
+00005b00: 6c6c 2061 6c73 6f20 6265 2069 676e 6f72  ll also be ignor
+00005b10: 6564 2e0a 0a49 6620 7468 6520 636c 6965  ed...If the clie
+00005b20: 6e74 2773 206e 6f64 6520 7072 6566 6572  nt's node prefer
+00005b30: 656e 6365 2069 7320 226c 6561 6465 7222  ence is "leader"
+00005b40: 2061 6e64 2074 6865 206e 6f64 6520 6265   and the node be
+00005b50: 636f 6d65 7320 610a 2266 6f6c 6c6f 7765  comes a."followe
+00005b60: 7222 2c20 7468 6520 636c 6965 6e74 2077  r", the client w
+00005b70: 696c 6c20 6174 7465 6d70 7420 746f 2072  ill attempt to r
+00005b80: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
+00005b90: 6375 7272 656e 7420 6c65 6164 6572 2077  current leader w
+00005ba0: 6865 6e20 6120 6d65 7468 6f64 0a69 7320  hen a method.is 
+00005bb0: 6361 6c6c 6564 2074 6861 7420 6578 7065  called that expe
+00005bc0: 6374 7320 746f 2063 616c 6c20 6120 6c65  cts to call a le
+00005bd0: 6164 6572 2e20 4d65 7468 6f64 7320 7768  ader. Methods wh
+00005be0: 6963 6820 6d75 7461 7465 2074 6865 2073  ich mutate the s
+00005bf0: 7461 7465 206f 6620 7468 6520 6461 7461  tate of the data
+00005c00: 6261 7365 0a65 7870 6563 7420 746f 2063  base.expect to c
+00005c10: 616c 6c20 6120 6c65 6164 6572 2e20 466f  all a leader. Fo
+00005c20: 7220 7375 6368 206d 6574 686f 6473 2c20  r such methods, 
+00005c30: 7468 6520 4854 5450 2068 6561 6465 7220  the HTTP header 
+00005c40: 2272 6571 7569 7265 732d 6c65 6164 6572  "requires-leader
+00005c50: 2220 6973 2073 6574 2074 6f0a 2274 7275  " is set to."tru
+00005c60: 6522 2c20 616e 6420 7468 6973 2068 6561  e", and this hea
+00005c70: 6465 7220 6973 206f 6273 6572 7665 6420  der is observed 
+00005c80: 6279 2074 6865 2073 6572 7665 722c 2061  by the server, a
+00005c90: 6e64 2073 6f20 6120 6e6f 6465 2077 6869  nd so a node whi
+00005ca0: 6368 2069 7320 6e6f 7420 6120 6c65 6164  ch is not a lead
+00005cb0: 6572 0a74 6861 7420 7265 6365 6976 6573  er.that receives
+00005cc0: 2073 7563 6820 6120 7265 7175 6573 7420   such a request 
+00005cd0: 7769 6c6c 2072 6574 7572 6e20 616e 2065  will return an e
+00005ce0: 7272 6f72 2e20 5468 6973 2065 7272 6f72  rror. This error
+00005cf0: 2069 7320 6465 7465 6374 6564 2062 7920   is detected by 
+00005d00: 7468 6520 636c 6965 6e74 2c0a 7768 6963  the client,.whic
+00005d10: 6820 7769 6c6c 2074 6865 6e20 636c 6f73  h will then clos
+00005d20: 6520 7468 6520 6375 7272 656e 7420 6752  e the current gR
+00005d30: 5043 2063 6f6e 6e65 6374 696f 6e20 616e  PC connection an
+00005d40: 6420 6372 6561 7465 2061 206e 6577 2063  d create a new c
+00005d50: 6f6e 6e65 6374 696f 6e20 746f 2074 6865  onnection to the
+00005d60: 0a6c 6561 6465 722e 2054 6865 2072 6571  .leader. The req
+00005d70: 7565 7374 2077 696c 6c20 7468 656e 2062  uest will then b
+00005d80: 6520 7265 7472 6965 6420 7769 7468 2074  e retried with t
+00005d90: 6865 206c 6561 6465 722e 0a0a 4966 2074  he leader...If t
+00005da0: 6865 2063 6c69 656e 7427 7320 6e6f 6465  he client's node
+00005db0: 2070 7265 6665 7265 6e63 6520 6973 2022   preference is "
+00005dc0: 666f 6c6c 6f77 6572 2220 616e 6420 7468  follower" and th
+00005dd0: 6572 6520 6172 6520 6e6f 2066 6f6c 6c6f  ere are no follo
+00005de0: 7765 720a 6e6f 6465 7320 696e 2074 6865  wer.nodes in the
+00005df0: 2063 6c75 7374 6572 2c20 7468 656e 2074   cluster, then t
+00005e00: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
+00005e10: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
+00005e20: 6e2e 2053 696d 696c 6172 6c79 2c20 6966  n. Similarly, if
+00005e30: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
+00005e40: 6465 2070 7265 6665 7265 6e63 6520 6973  de preference is
+00005e50: 2022 7265 6164 6f6e 6c79 7265 706c 6963   "readonlyreplic
+00005e60: 6122 2061 6e64 2074 6865 7265 2061 7265  a" and there are
+00005e70: 206e 6f20 7265 6164 2d6f 6e6c 7920 7265   no read-only re
+00005e80: 706c 6963 610a 6e6f 6465 7320 696e 2074  plica.nodes in t
+00005e90: 6865 2063 6c75 7374 6572 2c20 7468 656e  he cluster, then
+00005ea0: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+00005eb0: 2061 6c73 6f20 7261 6973 6520 616e 2065   also raise an e
+00005ec0: 7863 6570 7469 6f6e 2e0a 0a54 6865 2067  xception...The g
+00005ed0: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
+00005ee0: 6f6e 2022 6772 7063 2e6d 6178 5f72 6563  on "grpc.max_rec
+00005ef0: 6569 7665 5f6d 6573 7361 6765 5f6c 656e  eive_message_len
+00005f00: 6774 6822 2069 7320 6175 746f 6d61 7469  gth" is automati
+00005f10: 6361 6c6c 790a 636f 6e66 6967 7572 6564  cally.configured
+00005f20: 2074 6f20 7468 6520 7661 6c75 6520 6031   to the value `1
+00005f30: 3720 2a20 3130 3234 202a 2031 3032 3460  7 * 1024 * 1024`
+00005f40: 2e20 5468 6973 2076 616c 7565 2063 616e  . This value can
+00005f50: 6e6f 7420 6265 2063 6861 6e67 6564 2e0a  not be changed..
+00005f60: 0a0a 2323 2045 7665 6e74 206f 626a 6563  ..## Event objec
+00005f70: 7473 0a0a 5468 6973 2070 6163 6b61 6765  ts..This package
+00005f80: 2064 6566 696e 6573 2061 2060 4e65 7745   defines a `NewE
+00005f90: 7665 6e74 6020 636c 6173 7320 616e 6420  vent` class and 
+00005fa0: 6120 6052 6563 6f72 6465 6445 7665 6e74  a `RecordedEvent
+00005fb0: 6020 636c 6173 732e 2054 6865 0a60 4e65  ` class. The.`Ne
+00005fc0: 7745 7665 6e74 6020 636c 6173 7320 7368  wEvent` class sh
+00005fd0: 6f75 6c64 2062 6520 7573 6564 2077 6865  ould be used whe
+00005fe0: 6e20 7772 6974 696e 6720 6576 656e 7473  n writing events
+00005ff0: 2074 6f20 7468 6520 6461 7461 6261 7365   to the database
+00006000: 2e20 5468 650a 6052 6563 6f72 6465 6445  . The.`RecordedE
+00006010: 7665 6e74 6020 636c 6173 7320 6973 2075  vent` class is u
+00006020: 7365 6420 7768 656e 2072 6561 6469 6e67  sed when reading
+00006030: 2065 7665 6e74 7320 6672 6f6d 2074 6865   events from the
+00006040: 2064 6174 6162 6173 652e 0a0a 2323 2320   database...### 
+00006050: 4e65 7720 6576 656e 7473 0a0a 5468 6520  New events..The 
+00006060: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
+00006070: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
+00006080: 7768 656e 2077 7269 7469 6e67 2065 7665  when writing eve
+00006090: 6e74 7320 746f 2061 6e20 4576 656e 7453  nts to an EventS
+000060a0: 746f 7265 4442 2064 6174 6162 6173 652e  toreDB database.
+000060b0: 0a59 6f75 2077 696c 6c20 6e65 6564 2074  .You will need t
+000060c0: 6f20 636f 6e73 7472 7563 7420 6e65 7720  o construct new 
+000060d0: 6576 656e 7420 6f62 6a65 6374 7320 6265  event objects be
+000060e0: 666f 7265 2063 616c 6c69 6e67 2074 6865  fore calling the
+000060f0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00006100: 2960 0a61 6e64 2060 6170 7065 6e64 5f65  )`.and `append_e
+00006110: 7665 6e74 2829 6020 6d65 7468 6f64 732e  vent()` methods.
+00006120: 0a0a 5468 6520 604e 6577 4576 656e 7460  ..The `NewEvent`
+00006130: 2063 6c61 7373 2069 7320 6120 6672 6f7a   class is a froz
+00006140: 656e 2050 7974 686f 6e20 6461 7461 6261  en Python databa
+00006150: 7365 2e20 4974 2068 6173 2074 776f 2072  se. It has two r
+00006160: 6571 7569 7265 6420 636f 6e73 7472 7563  equired construc
+00006170: 746f 720a 6172 6775 6d65 6e74 7320 2860  tor.arguments (`
+00006180: 7479 7065 6020 616e 6420 6064 6174 6160  type` and `data`
+00006190: 2920 616e 6420 7468 7265 6520 6f70 7469  ) and three opti
+000061a0: 6f6e 616c 2063 6f6e 7374 7275 6374 6f72  onal constructor
+000061b0: 2061 7267 756d 656e 7473 2028 606d 6574   arguments (`met
+000061c0: 6164 6174 6160 2c0a 6063 6f6e 7465 6e74  adata`,.`content
+000061d0: 5f74 7970 6560 2061 6e64 2060 6964 6029  _type` and `id`)
+000061e0: 2e0a 0a54 6865 2072 6571 7569 7265 6420  ...The required 
+000061f0: 6074 7970 6560 2061 7267 756d 656e 7420  `type` argument 
+00006200: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+00006210: 602c 2075 7365 6420 746f 2064 6573 6372  `, used to descr
+00006220: 6962 6520 7468 6520 7479 7065 206f 660a  ibe the type of.
+00006230: 646f 6d61 696e 2065 7665 6e74 2074 6861  domain event tha
+00006240: 7420 6973 2062 6569 6e67 2072 6563 6f72  t is being recor
+00006250: 6465 642e 0a0a 5468 6520 7265 7175 6972  ded...The requir
+00006260: 6564 2060 6461 7461 6020 6172 6775 6d65  ed `data` argume
+00006270: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00006280: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
+00006290: 7365 6420 746f 2073 7461 7465 2074 6865  sed to state the
+000062a0: 0a73 6572 6961 6c69 7a65 6420 6461 7461  .serialized data
+000062b0: 206f 6620 7468 6520 646f 6d61 696e 2065   of the domain e
+000062c0: 7665 6e74 2074 6861 7420 6973 2062 6569  vent that is bei
+000062d0: 6e67 2072 6563 6f72 6465 642e 0a0a 5468  ng recorded...Th
+000062e0: 6520 6f70 7469 6f6e 616c 2060 6d65 7461  e optional `meta
+000062f0: 6461 7461 6020 6172 6775 6d65 6e74 2069  data` argument i
+00006300: 7320 6120 5079 7468 6f6e 2060 6279 7465  s a Python `byte
+00006310: 7360 206f 626a 6563 742c 2075 7365 6420  s` object, used 
+00006320: 746f 2069 6e64 6963 6174 6520 616e 790a  to indicate any.
+00006330: 6d65 7461 6461 7461 206f 6620 7468 6520  metadata of the 
+00006340: 6576 656e 7420 7468 6174 2077 696c 6c20  event that will 
+00006350: 6265 2072 6563 6f72 6465 642e 2054 6865  be recorded. The
+00006360: 2064 6566 6175 6c74 2076 616c 7565 2069   default value i
+00006370: 7320 616e 2065 6d70 7479 2060 6279 7465  s an empty `byte
+00006380: 7360 0a6f 626a 6563 742e 0a0a 5468 6520  s`.object...The 
+00006390: 6f70 7469 6f6e 616c 2060 636f 6e74 656e  optional `conten
+000063a0: 745f 7479 7065 6020 6172 6775 6d65 6e74  t_type` argument
+000063b0: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+000063c0: 7260 2c20 7573 6564 2074 6f20 696e 6469  r`, used to indi
+000063d0: 6361 7465 2074 6865 0a6b 696e 6420 6f66  cate the.kind of
+000063e0: 2064 6174 6120 7468 6174 2069 7320 6265   data that is be
+000063f0: 696e 6720 7265 636f 7264 6564 2e20 5468  ing recorded. Th
+00006400: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00006410: 6973 2060 2761 7070 6c69 6361 7469 6f6e  is `'application
+00006420: 2f6a 736f 6e27 602c 0a77 6869 6368 2069  /json'`,.which i
+00006430: 6e64 6963 6174 6573 2074 6861 7420 7468  ndicates that th
+00006440: 6520 6064 6174 6160 2077 6173 2073 6572  e `data` was ser
+00006450: 6961 6c69 7365 6420 7573 696e 6720 4a53  ialised using JS
+00006460: 4f4e 2e20 416e 2061 6c74 6572 6e61 7469  ON. An alternati
+00006470: 7665 2076 616c 7565 0a66 6f72 2074 6869  ve value.for thi
+00006480: 7320 6172 6775 6d65 6e74 2069 7320 7468  s argument is th
+00006490: 6520 6d6f 7265 2067 656e 6572 616c 2069  e more general i
+000064a0: 6e64 6963 6174 696f 6e20 6027 6170 706c  ndication `'appl
+000064b0: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
+000064c0: 7265 616d 2760 2e0a 0a54 6865 206f 7074  ream'`...The opt
+000064d0: 696f 6e61 6c20 6069 6460 2061 7267 756d  ional `id` argum
+000064e0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+000064f0: 6055 5549 4460 206f 626a 6563 742c 2075  `UUID` object, u
+00006500: 7365 6420 746f 2073 7065 6369 6679 2074  sed to specify t
+00006510: 6865 2075 6e69 7175 6520 4944 0a6f 6620  he unique ID.of 
+00006520: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
+00006530: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
+00006540: 2049 6620 6e6f 2076 616c 7565 2069 7320   If no value is 
+00006550: 7072 6f76 6964 6564 2c20 6120 6e65 7720  provided, a new 
+00006560: 7665 7273 696f 6e2d 3420 5555 4944 0a77  version-4 UUID.w
+00006570: 696c 6c20 6265 2067 656e 6572 6174 6564  ill be generated
+00006580: 2e0a 0a60 6060 7079 7468 6f6e 0a6e 6577  ...```python.new
+00006590: 5f65 7665 6e74 3120 3d20 4e65 7745 7665  _event1 = NewEve
+000065a0: 6e74 280a 2020 2020 7479 7065 3d27 4f72  nt(.    type='Or
+000065b0: 6465 7243 7265 6174 6564 272c 0a20 2020  derCreated',.   
+000065c0: 2064 6174 613d 6227 7b22 6e61 6d65 223a   data=b'{"name":
+000065d0: 2022 4772 6567 227d 272c 0a29 0a61 7373   "Greg"}',.).ass
+000065e0: 6572 7420 6e65 775f 6576 656e 7431 2e74  ert new_event1.t
+000065f0: 7970 6520 3d3d 2027 4f72 6465 7243 7265  ype == 'OrderCre
+00006600: 6174 6564 270a 6173 7365 7274 206e 6577  ated'.assert new
+00006610: 5f65 7665 6e74 312e 6461 7461 203d 3d20  _event1.data == 
+00006620: 6227 7b22 6e61 6d65 223a 2022 4772 6567  b'{"name": "Greg
+00006630: 227d 270a 6173 7365 7274 206e 6577 5f65  "}'.assert new_e
+00006640: 7665 6e74 312e 6d65 7461 6461 7461 203d  vent1.metadata =
+00006650: 3d20 6227 270a 6173 7365 7274 206e 6577  = b''.assert new
+00006660: 5f65 7665 6e74 312e 636f 6e74 656e 745f  _event1.content_
+00006670: 7479 7065 203d 3d20 2761 7070 6c69 6361  type == 'applica
+00006680: 7469 6f6e 2f6a 736f 6e27 0a61 7373 6572  tion/json'.asser
+00006690: 7420 6973 696e 7374 616e 6365 286e 6577  t isinstance(new
+000066a0: 5f65 7665 6e74 312e 6964 2c20 7575 6964  _event1.id, uuid
+000066b0: 2e55 5549 4429 0a0a 6576 656e 745f 6964  .UUID)..event_id
+000066c0: 203d 2075 7569 642e 7575 6964 3428 290a   = uuid.uuid4().
+000066d0: 6e65 775f 6576 656e 7432 203d 204e 6577  new_event2 = New
+000066e0: 4576 656e 7428 0a20 2020 2074 7970 653d  Event(.    type=
+000066f0: 2749 6d61 6765 4372 6561 7465 6427 2c0a  'ImageCreated',.
+00006700: 2020 2020 6461 7461 3d62 2730 3130 3130      data=b'01010
+00006710: 3130 3130 3130 3130 3127 2c0a 2020 2020  101010101',.    
+00006720: 6d65 7461 6461 7461 3d62 277b 2261 223a  metadata=b'{"a":
+00006730: 2031 7d27 2c0a 2020 2020 636f 6e74 656e   1}',.    conten
+00006740: 745f 7479 7065 3d27 6170 706c 6963 6174  t_type='applicat
+00006750: 696f 6e2f 6f63 7465 742d 7374 7265 616d  ion/octet-stream
+00006760: 272c 0a20 2020 2069 643d 6576 656e 745f  ',.    id=event_
+00006770: 6964 2c0a 290a 6173 7365 7274 206e 6577  id,.).assert new
+00006780: 5f65 7665 6e74 322e 7479 7065 203d 3d20  _event2.type == 
+00006790: 2749 6d61 6765 4372 6561 7465 6427 0a61  'ImageCreated'.a
+000067a0: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
+000067b0: 2e64 6174 6120 3d3d 2062 2730 3130 3130  .data == b'01010
+000067c0: 3130 3130 3130 3130 3127 0a61 7373 6572  101010101'.asser
+000067d0: 7420 6e65 775f 6576 656e 7432 2e6d 6574  t new_event2.met
+000067e0: 6164 6174 6120 3d3d 2062 277b 2261 223a  adata == b'{"a":
+000067f0: 2031 7d27 0a61 7373 6572 7420 6e65 775f   1}'.assert new_
+00006800: 6576 656e 7432 2e63 6f6e 7465 6e74 5f74  event2.content_t
+00006810: 7970 6520 3d3d 2027 6170 706c 6963 6174  ype == 'applicat
+00006820: 696f 6e2f 6f63 7465 742d 7374 7265 616d  ion/octet-stream
+00006830: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
+00006840: 6e74 322e 6964 203d 3d20 6576 656e 745f  nt2.id == event_
+00006850: 6964 0a60 6060 0a0a 2323 2320 5265 636f  id.```..### Reco
+00006860: 7264 6564 2065 7665 6e74 730a 0a54 6865  rded events..The
+00006870: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00006880: 2063 6c61 7373 2069 7320 7573 6564 2077   class is used w
+00006890: 6865 6e20 7265 6164 696e 6720 6576 656e  hen reading even
+000068a0: 7473 2066 726f 6d20 616e 2045 7665 6e74  ts from an Event
+000068b0: 5374 6f72 6544 420a 6461 7461 6261 7365  StoreDB.database
+000068c0: 2e20 5468 6520 636c 6965 6e74 2077 696c  . The client wil
+000068d0: 6c20 7265 7475 726e 2065 7665 6e74 206f  l return event o
+000068e0: 626a 6563 7473 206f 6620 7468 6973 2074  bjects of this t
+000068f0: 7970 6520 6672 6f6d 2061 6c6c 206d 6574  ype from all met
+00006900: 686f 6473 0a74 6861 7420 7265 7475 726e  hods.that return
+00006910: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00006920: 2c20 7375 6368 2061 7320 6072 6561 645f  , such as `read_
+00006930: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+00006940: 2c20 6073 7562 7363 7269 6265 5f61 6c6c  , `subscribe_all
+00006950: 5f65 7665 6e74 7328 2960 2c0a 616e 6420  _events()`,.and 
+00006960: 6072 6561 645f 7375 6273 6372 6970 7469  `read_subscripti
+00006970: 6f6e 2829 602e 2059 6f75 2064 6f20 6e6f  on()`. You do no
+00006980: 7420 6e65 6564 2074 6f20 636f 6e73 7472  t need to constr
+00006990: 7563 7420 7265 636f 7264 6564 2065 7665  uct recorded eve
+000069a0: 6e74 206f 626a 6563 7473 2e0a 0a4c 696b  nt objects...Lik
+000069b0: 6520 604e 6577 4576 656e 7460 2c20 7468  e `NewEvent`, th
+000069c0: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
+000069d0: 6020 636c 6173 7320 6973 2061 6c73 6f20  ` class is also 
+000069e0: 6120 6672 6f7a 656e 2050 7974 686f 6e20  a frozen Python 
+000069f0: 6461 7461 6261 7365 2e20 4974 2068 6173  database. It has
+00006a00: 0a61 6c6c 2074 6865 2061 7474 7269 6275  .all the attribu
+00006a10: 7465 7320 7468 6174 2060 4e65 7745 7665  tes that `NewEve
+00006a20: 6e74 6020 6861 7320 2860 7479 7065 602c  nt` has (`type`,
+00006a30: 2060 6461 7461 602c 2060 6d65 7461 6461   `data`, `metada
+00006a40: 7461 602c 2060 636f 6e74 656e 745f 7479  ta`, `content_ty
+00006a50: 7065 602c 2060 6964 6029 0a61 6e64 2073  pe`, `id`).and s
+00006a60: 6f6d 6520 6164 6469 7469 6f6e 616c 2061  ome additional a
+00006a70: 7474 7269 6275 7465 7320 7468 6174 2066  ttributes that f
+00006a80: 6f6c 6c6f 7720 6672 6f6d 2074 6865 2066  ollow from the f
+00006a90: 6163 7420 7468 6174 2061 6e20 6576 656e  act that an even
+00006aa0: 7420 7761 7320 7265 636f 7264 6564 0a28  t was recorded.(
+00006ab0: 6073 7472 6561 6d5f 6e61 6d65 602c 2060  `stream_name`, `
+00006ac0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+00006ad0: 2c20 6063 6f6d 6d69 745f 706f 7369 7469  , `commit_positi
+00006ae0: 6f6e 6029 2e0a 0a54 6865 2060 7479 7065  on`)...The `type
+00006af0: 6020 6174 7472 6962 7574 6520 6973 2061  ` attribute is a
+00006b00: 2050 7974 686f 6e20 6073 7472 602c 2075   Python `str`, u
+00006b10: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00006b20: 7468 6520 7479 7065 206f 6620 616e 2065  the type of an e
+00006b30: 7665 6e74 0a74 6861 7420 7761 7320 7265  vent.that was re
+00006b40: 636f 7264 6564 2e0a 0a54 6865 2060 6461  corded...The `da
+00006b50: 7461 6020 6174 7472 6962 7574 6520 6973  ta` attribute is
+00006b60: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
+00006b70: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
+00006b80: 6f20 696e 6469 6361 7465 2074 6865 2064  o indicate the d
+00006b90: 6174 6120 6f66 2061 6e0a 6576 656e 7420  ata of an.event 
+00006ba0: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
+00006bb0: 642e 0a0a 5468 6520 606d 6574 6164 6174  d...The `metadat
+00006bc0: 6160 2061 7474 7269 6275 7465 2069 7320  a` attribute is 
+00006bd0: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
+00006be0: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
+00006bf0: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
+00006c00: 7461 6461 7461 206f 660a 616e 2065 7665  tadata of.an eve
+00006c10: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
+00006c20: 7264 6564 2e0a 0a54 6865 2060 636f 6e74  rded...The `cont
+00006c30: 656e 745f 7479 7065 6020 6174 7472 6962  ent_type` attrib
+00006c40: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
+00006c50: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
+00006c60: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
+00006c70: 206f 660a 6461 7461 2074 6861 7420 7761   of.data that wa
+00006c80: 7320 7265 636f 7264 6564 2066 6f72 2061  s recorded for a
+00006c90: 6e20 6576 656e 742e 2049 7420 6973 2075  n event. It is u
+00006ca0: 7375 616c 6c79 2060 6170 706c 6963 6174  sually `applicat
+00006cb0: 696f 6e2f 6a73 6f6e 602c 2069 6e64 6963  ion/json`, indic
+00006cc0: 6174 696e 670a 7468 6174 2074 6865 2064  ating.that the d
+00006cd0: 6174 6120 6361 6e20 6265 2070 6172 7365  ata can be parse
+00006ce0: 6420 6173 204a 534f 4e2e 2041 6c74 6572  d as JSON. Alter
+00006cf0: 6e61 7469 7665 6c79 2c20 6974 2069 7320  natively, it is 
+00006d00: 6061 7070 6c69 6361 7469 6f6e 2f6f 6374  `application/oct
+00006d10: 6574 2d73 7472 6561 6d60 2e0a 0a54 6865  et-stream`...The
+00006d20: 2060 6964 6020 6174 7472 6962 7574 6520   `id` attribute 
+00006d30: 6973 2061 2050 7974 686f 6e20 6055 5549  is a Python `UUI
+00006d40: 4460 206f 626a 6563 742c 2075 7365 6420  D` object, used 
+00006d50: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
+00006d60: 756e 6971 7565 2049 4420 6f66 2061 6e0a  unique ID of an.
+00006d70: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
+00006d80: 6563 6f72 6465 642e 0a0a 5468 6520 6073  ecorded...The `s
+00006d90: 7472 6561 6d5f 6e61 6d65 6020 6174 7472  tream_name` attr
+00006da0: 6962 7574 6520 6973 2061 2050 7974 686f  ibute is a Pytho
+00006db0: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
+00006dc0: 2069 6e64 6963 6174 6520 7468 6520 6e61   indicate the na
+00006dd0: 6d65 206f 6620 610a 7374 7265 616d 2069  me of a.stream i
+00006de0: 6e20 7768 6963 6820 616e 2065 7665 6e74  n which an event
+00006df0: 2077 6173 2072 6563 6f72 6465 642e 0a0a   was recorded...
+00006e00: 5468 6520 6073 7472 6561 6d5f 706f 7369  The `stream_posi
+00006e10: 7469 6f6e 6020 6174 7472 6962 7574 6520  tion` attribute 
+00006e20: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+00006e30: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
+00006e40: 6174 6520 7468 6520 706f 7369 7469 6f6e  ate the position
+00006e50: 2069 6e20 610a 7374 7265 616d 2061 7420   in a.stream at 
+00006e60: 7768 6963 6820 616e 2065 7665 6e74 2077  which an event w
+00006e70: 6173 2072 6563 6f72 6465 642e 0a0a 496e  as recorded...In
+00006e80: 2045 7665 6e74 5374 6f72 6544 422c 2061   EventStoreDB, a
+00006e90: 2022 7374 7265 616d 2070 6f73 6974 696f   "stream positio
+00006ea0: 6e22 2069 7320 616e 2069 6e74 6567 6572  n" is an integer
+00006eb0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+00006ec0: 6520 706f 7369 7469 6f6e 206f 6620 610a  e position of a.
+00006ed0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+00006ee0: 6e20 6120 7374 7265 616d 2e20 4561 6368  n a stream. Each
+00006ef0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00006f00: 6973 2072 6563 6f72 6465 6420 6174 2061  is recorded at a
+00006f10: 2070 6f73 6974 696f 6e20 696e 2061 2073   position in a s
+00006f20: 7472 6561 6d2e 0a45 6163 6820 7374 7265  tream..Each stre
+00006f30: 616d 2070 6f73 6974 696f 6e20 6973 206f  am position is o
+00006f40: 6363 7570 6965 6420 6279 206f 6e6c 7920  ccupied by only 
+00006f50: 6f6e 6520 7265 636f 7264 6564 2065 7665  one recorded eve
+00006f60: 6e74 2e20 4e65 7720 6576 656e 7473 2061  nt. New events a
+00006f70: 7265 2072 6563 6f72 6465 6420 6174 2074  re recorded at t
+00006f80: 6865 0a6e 6578 7420 756e 6f63 6375 7069  he.next unoccupi
+00006f90: 6564 2070 6f73 6974 696f 6e2e 2041 6c6c  ed position. All
+00006fa0: 2073 6571 7565 6e63 6573 206f 6620 7374   sequences of st
+00006fb0: 7265 616d 2070 6f73 6974 696f 6e73 2061  ream positions a
+00006fc0: 7265 207a 6572 6f2d 6261 7365 6420 616e  re zero-based an
+00006fd0: 6420 6761 706c 6573 732e 0a0a 5468 6520  d gapless...The 
+00006fe0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00006ff0: 6020 6174 7472 6962 7574 6520 6973 2061  ` attribute is a
+00007000: 2050 7974 686f 6e20 6069 6e74 602c 2075   Python `int`, u
+00007010: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00007020: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
+00007030: 7468 650a 6461 7461 6261 7365 2061 7420  the.database at 
+00007040: 7768 6963 6820 616e 2065 7665 6e74 2077  which an event w
+00007050: 6173 2072 6563 6f72 6465 642e 0a0a 496e  as recorded...In
+00007060: 2045 7665 6e74 5374 6f72 6544 422c 2061   EventStoreDB, a
+00007070: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00007080: 6e22 2069 7320 616e 2069 6e74 6567 6572  n" is an integer
+00007090: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+000070a0: 6520 706f 7369 7469 6f6e 206f 6620 610a  e position of a.
+000070b0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+000070c0: 6e20 7468 6520 6461 7461 6261 7365 2e20  n the database. 
+000070d0: 4561 6368 2072 6563 6f72 6465 6420 6576  Each recorded ev
+000070e0: 656e 7420 6973 2072 6563 6f72 6465 6420  ent is recorded 
+000070f0: 6174 2061 2070 6f73 6974 696f 6e20 696e  at a position in
+00007100: 2074 6865 0a64 6174 6162 6173 652e 2045   the.database. E
+00007110: 6163 6820 636f 6d6d 6974 2070 6f73 6974  ach commit posit
+00007120: 696f 6e20 6973 206f 6363 7570 6965 6420  ion is occupied 
+00007130: 6279 206f 6e6c 7920 6f6e 6520 7265 636f  by only one reco
+00007140: 7264 6564 2065 7665 6e74 2e20 436f 6d6d  rded event. Comm
+00007150: 6974 2070 6f73 6974 696f 6e73 0a61 7265  it positions.are
+00007160: 207a 6572 6f2d 6261 7365 6420 616e 6420   zero-based and 
+00007170: 696e 6372 6561 7365 206d 6f6e 6f74 6f6e  increase monoton
+00007180: 6963 616c 6c79 2061 7320 6e65 7720 6576  ically as new ev
+00007190: 656e 7473 2061 7265 2072 6563 6f72 6465  ents are recorde
+000071a0: 642e 2042 7574 2c20 756e 6c69 6b65 2073  d. But, unlike s
+000071b0: 7472 6561 6d0a 706f 7369 7469 6f6e 732c  tream.positions,
+000071c0: 2074 6865 2073 6571 7565 6e63 6520 6f66   the sequence of
+000071d0: 2073 7563 6365 7373 6976 6520 636f 6d6d   successive comm
+000071e0: 6974 2070 6f73 6974 696f 6e73 2069 7320  it positions is 
+000071f0: 6e6f 7420 6761 706c 6573 732e 2049 6e64  not gapless. Ind
+00007200: 6565 642c 2074 6865 7265 2061 7265 0a75  eed, there are.u
+00007210: 7375 616c 6c79 206c 6172 6765 2064 6966  sually large dif
+00007220: 6665 7265 6e63 6573 2062 6574 7765 656e  ferences between
+00007230: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+00007240: 7469 6f6e 7320 6f66 2073 7563 6365 7373  tions of success
+00007250: 6976 656c 7920 7265 636f 7264 6564 2065  ively recorded e
+00007260: 7665 6e74 732e 0a0a 0a60 6060 7079 7468  vents....```pyth
+00007270: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+00007280: 6e74 2e65 7665 6e74 7320 696d 706f 7274  nt.events import
+00007290: 2052 6563 6f72 6465 6445 7665 6e74 0a0a   RecordedEvent..
+000072a0: 7265 636f 7264 6564 5f65 7665 6e74 203d  recorded_event =
+000072b0: 2052 6563 6f72 6465 6445 7665 6e74 280a   RecordedEvent(.
+000072c0: 2020 2020 7479 7065 3d27 4f72 6465 7243      type='OrderC
+000072d0: 7265 6174 6564 272c 0a20 2020 2064 6174  reated',.    dat
+000072e0: 613d 6227 7b7d 272c 0a20 2020 206d 6574  a=b'{}',.    met
+000072f0: 6164 6174 613d 6227 272c 0a20 2020 2063  adata=b'',.    c
+00007300: 6f6e 7465 6e74 5f74 7970 653d 2761 7070  ontent_type='app
+00007310: 6c69 6361 7469 6f6e 2f6a 736f 6e27 2c0a  lication/json',.
+00007320: 2020 2020 6964 3d75 7569 642e 7575 6964      id=uuid.uuid
+00007330: 3428 292c 0a20 2020 2073 7472 6561 6d5f  4(),.    stream_
+00007340: 6e61 6d65 3d27 7374 7265 616d 3127 2c0a  name='stream1',.
+00007350: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+00007360: 696f 6e3d 302c 0a20 2020 2063 6f6d 6d69  ion=0,.    commi
+00007370: 745f 706f 7369 7469 6f6e 3d35 3132 2c0a  t_position=512,.
+00007380: 290a 6060 600a 0a0a 2323 2053 7472 6561  ).```...## Strea
+00007390: 6d73 0a0a 496e 2045 7665 6e74 5374 6f72  ms..In EventStor
+000073a0: 6544 422c 2061 2022 7374 7265 616d 2220  eDB, a "stream" 
+000073b0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
+000073c0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000073d0: 2074 6861 7420 616c 6c20 6861 7665 0a74   that all have.t
+000073e0: 6865 2073 616d 6520 2273 7472 6561 6d20  he same "stream 
+000073f0: 6e61 6d65 222e 2054 6865 7265 2077 696c  name". There wil
+00007400: 6c20 6e6f 726d 616c 6c79 2062 6520 6d61  l normally be ma
+00007410: 6e79 2073 7472 6561 6d73 2069 6e20 6120  ny streams in a 
+00007420: 6461 7461 6261 7365 2c0a 6561 6368 2077  database,.each w
+00007430: 6974 6820 6d61 6e79 2072 6563 6f72 6465  ith many recorde
+00007440: 6420 6576 656e 7473 2e20 4561 6368 2072  d events. Each r
+00007450: 6563 6f72 6465 6420 6576 656e 7420 6861  ecorded event ha
+00007460: 7320 6120 706f 7369 7469 6f6e 2069 6e20  s a position in 
+00007470: 6974 7320 7374 7265 616d 0a28 7468 6520  its stream.(the 
+00007480: 2273 7472 6561 6d20 706f 7369 7469 6f6e  "stream position
+00007490: 2229 2c20 616e 6420 6120 706f 7369 7469  "), and a positi
+000074a0: 6f6e 2069 6e20 7468 6520 6461 7461 6261  on in the databa
+000074b0: 7365 2028 7468 6520 2263 6f6d 6d69 7420  se (the "commit 
+000074c0: 706f 7369 7469 6f6e 2229 2e0a 5374 7265  position")..Stre
+000074d0: 616d 2070 6f73 6974 696f 6e73 2061 7265  am positions are
+000074e0: 207a 6572 6f2d 6261 7365 6420 616e 6420   zero-based and 
+000074f0: 6761 706c 6573 732e 2043 6f6d 6d69 7420  gapless. Commit 
+00007500: 706f 7369 7469 6f6e 7320 6172 6520 616c  positions are al
+00007510: 736f 207a 6572 6f2d 6261 7365 642c 0a62  so zero-based,.b
+00007520: 7574 2061 7265 206e 6f74 2067 6170 6c65  ut are not gaple
+00007530: 7373 2e0a 0a54 6865 206d 6574 686f 6473  ss...The methods
+00007540: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00007550: 2960 2c20 6072 6561 645f 7374 7265 616d  )`, `read_stream
+00007560: 5f65 7665 6e74 7328 2960 2061 6e64 2060  _events()` and `
+00007570: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+00007580: 2960 2063 616e 0a62 6520 7573 6564 2074  )` can.be used t
+00007590: 6f20 7265 6164 2061 6e64 2072 6563 6f72  o read and recor
+000075a0: 6420 696e 2074 6865 2064 6174 6162 6173  d in the databas
+000075b0: 652e 0a0a 2323 2320 4170 7065 6e64 2065  e...### Append e
+000075c0: 7665 6e74 730a 0a2a 7265 7175 6972 6573  vents..*requires
+000075d0: 206c 6561 6465 722a 0a0a 5468 6520 6061   leader*..The `a
+000075e0: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
+000075f0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00007600: 6564 2061 746f 6d69 6361 6c6c 7920 746f  ed atomically to
+00007610: 2072 6563 6f72 6420 6120 7365 7175 656e   record a sequen
+00007620: 6365 206f 6620 6e65 7720 6576 656e 7473  ce of new events
+00007630: 2e0a 4966 2074 6865 206f 7065 7261 7469  ..If the operati
+00007640: 6f6e 2069 7320 7375 6363 6573 7366 756c  on is successful
+00007650: 2c20 6974 2072 6574 7572 6e73 2074 6865  , it returns the
+00007660: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00007670: 206f 6620 7468 6520 6c61 7374 2065 7665   of the last eve
+00007680: 6e74 2069 6e20 7468 650a 7365 7175 656e  nt in the.sequen
+00007690: 6365 2074 6861 7420 6861 7320 6265 656e  ce that has been
+000076a0: 2072 6563 6f72 6465 642e 0a0a 5468 6973   recorded...This
+000076b0: 206d 6574 686f 6420 6861 7320 7468 7265   method has thre
+000076c0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+000076d0: 656e 7473 2c20 6073 7472 6561 6d5f 6e61  ents, `stream_na
+000076e0: 6d65 602c 2060 6375 7272 656e 745f 7665  me`, `current_ve
+000076f0: 7273 696f 6e60 0a61 6e64 2060 6576 656e  rsion`.and `even
+00007700: 7473 602e 0a0a 5468 6520 7265 7175 6972  ts`...The requir
+00007710: 6564 2060 7374 7265 616d 5f6e 616d 6560  ed `stream_name`
+00007720: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00007730: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+00007740: 2075 6e69 7175 656c 7920 6964 656e 7469   uniquely identi
+00007750: 6669 6573 2061 0a73 7472 6561 6d20 746f  fies a.stream to
+00007760: 2077 6869 6368 2061 2073 6571 7565 6e63   which a sequenc
+00007770: 6520 6f66 2065 7665 6e74 7320 7769 6c6c  e of events will
+00007780: 2062 6520 6170 7065 6e64 6564 2e0a 0a54   be appended...T
+00007790: 6865 2072 6571 7569 7265 6420 6063 7572  he required `cur
+000077a0: 7265 6e74 5f76 6572 7369 6f6e 6020 6172  rent_version` ar
+000077b0: 6775 6d65 6e74 2069 7320 6578 7065 6374  gument is expect
+000077c0: 6564 2074 6f20 6265 2065 6974 6865 7220  ed to be either 
+000077d0: 6120 5079 7468 6f6e 2060 696e 7460 0a74  a Python `int`.t
+000077e0: 6861 7420 696e 6469 6361 7465 7320 7468  hat indicates th
+000077f0: 6520 7374 7265 616d 2070 6f73 6974 696f  e stream positio
+00007800: 6e20 6f66 2074 6865 206c 6173 7420 7265  n of the last re
+00007810: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
+00007820: 7468 6520 7374 7265 616d 2c20 6f72 0a60  the stream, or.`
+00007830: 4e6f 6e65 6020 6966 2074 6865 2073 7472  None` if the str
+00007840: 6561 6d20 646f 6573 206e 6f74 2079 6574  eam does not yet
+00007850: 2065 7869 7374 206f 7220 6861 7320 6265   exist or has be
+00007860: 656e 2064 656c 6574 6564 2e20 5468 6520  en deleted. The 
+00007870: 7374 7265 616d 2070 6f73 6974 696f 6e73  stream positions
+00007880: 0a61 7265 207a 6572 6f2d 6261 7365 6420  .are zero-based 
+00007890: 616e 6420 6761 706c 6573 732c 2073 6f20  and gapless, so 
+000078a0: 7468 6174 2069 6620 6120 7374 7265 616d  that if a stream
+000078b0: 2068 6173 2074 776f 2065 7665 6e74 732c   has two events,
+000078c0: 2074 6865 2060 6375 7272 656e 745f 7665   the `current_ve
+000078d0: 7273 696f 6e60 0a73 686f 756c 6420 6265  rsion`.should be
+000078e0: 2031 2e20 4966 2061 6e20 696e 636f 7272   1. If an incorr
+000078f0: 6563 7420 7661 6c75 6520 6973 2067 6976  ect value is giv
+00007900: 656e 2c20 7468 6973 206d 6574 686f 6420  en, this method 
+00007910: 7769 6c6c 2072 6169 7365 2061 0a60 5772  will raise a.`Wr
+00007920: 6f6e 6743 7572 7265 6e74 5665 7273 696f  ongCurrentVersio
+00007930: 6e60 2065 7863 6570 7469 6f6e 2e20 5468  n` exception. Th
+00007940: 6973 2062 6568 6176 696f 7220 6973 2064  is behavior is d
+00007950: 6573 6967 6e65 6420 746f 2070 726f 7669  esigned to provi
+00007960: 6465 2063 6f6e 6375 7272 656e 6379 0a63  de concurrency.c
+00007970: 6f6e 7472 6f6c 2077 6865 6e20 7265 636f  ontrol when reco
+00007980: 7264 696e 6720 6e65 7720 6576 656e 7473  rding new events
+00007990: 2e20 5468 6520 636f 7272 6563 7420 7661  . The correct va
+000079a0: 6c75 6520 6f66 2060 6375 7272 656e 745f  lue of `current_
+000079b0: 7665 7273 696f 6e60 2066 6f72 2061 6e79  version` for any
+000079c0: 2073 7472 6561 6d0a 6361 6e20 6265 206f   stream.can be o
+000079d0: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
+000079e0: 6e67 2060 6765 745f 6375 7272 656e 745f  ng `get_current_
+000079f0: 7665 7273 696f 6e28 2960 2e20 486f 7765  version()`. Howe
+00007a00: 7665 722c 2074 6865 2074 7970 6963 616c  ver, the typical
+00007a10: 2061 7070 726f 6163 6820 6973 2074 6f0a   approach is to.
+00007a20: 7573 6520 7468 6520 7374 7265 616d 2070  use the stream p
+00007a30: 6f73 6974 696f 6e20 6f66 2074 6865 2072  osition of the r
+00007a40: 6563 6f72 6465 6420 6576 656e 7473 2061  ecorded events a
+00007a50: 7320 7468 6520 7665 7273 696f 6e20 6e75  s the version nu
+00007a60: 6d62 6572 206f 6620 6120 7265 636f 6e73  mber of a recons
+00007a70: 7472 7563 7465 640a 6167 6772 6567 6174  tructed.aggregat
+00007a80: 652c 2061 6e64 2074 6f20 7573 6520 7468  e, and to use th
+00007a90: 6520 6375 7272 656e 7420 7665 7273 696f  e current versio
+00007aa0: 6e20 6f66 2074 6865 2061 6767 7265 6761  n of the aggrega
+00007ab0: 7465 2061 7320 7468 6520 6063 7572 7265  te as the `curre
+00007ac0: 6e74 5f76 6572 7369 6f6e 6020 7768 656e  nt_version` when
+00007ad0: 0a61 7070 656e 6469 6e67 206e 6577 2061  .appending new a
+00007ae0: 6767 7265 6761 7465 2065 7665 6e74 732e  ggregate events.
+00007af0: 2054 6869 7320 656e 7375 7265 7320 7468   This ensures th
+00007b00: 6520 636f 6e73 6973 7465 6e63 7920 6f66  e consistency of
+00007b10: 2074 6865 2072 6563 6f72 6465 6420 7374   the recorded st
+00007b20: 6174 6520 6f66 0a74 6865 2061 6767 7265  ate of.the aggre
+00007b30: 6761 7465 2c20 616e 6420 666f 7263 6573  gate, and forces
+00007b40: 206f 7065 7261 7469 6f6e 7320 7468 6174   operations that
+00007b50: 2067 656e 6572 6174 6520 6e65 7720 6167   generate new ag
+00007b60: 6772 6567 6174 6520 6576 656e 7473 2074  gregate events t
+00007b70: 6f20 6265 2072 6574 7269 6564 2077 6974  o be retried wit
+00007b80: 6820 6120 6672 6573 686c 790a 7265 636f  h a freshly.reco
+00007b90: 6e73 7472 7563 7465 6420 6167 6772 6567  nstructed aggreg
+00007ba0: 6174 6520 7768 656e 2061 2060 5772 6f6e  ate when a `Wron
+00007bb0: 6743 7572 7265 6e74 5665 7273 696f 6e60  gCurrentVersion`
+00007bc0: 2065 7863 6570 7469 6f6e 2069 7320 656e   exception is en
+00007bd0: 636f 756e 7465 7265 642e 0a54 6869 7320  countered..This 
+00007be0: 636f 6e74 726f 6c6c 696e 6720 6265 6861  controlling beha
+00007bf0: 7669 6f72 2063 616e 2062 6520 6469 7361  vior can be disa
+00007c00: 626c 6564 2062 7920 7365 7474 696e 6720  bled by setting 
+00007c10: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00007c20: 0a60 6375 7272 656e 745f 7665 7273 696f  .`current_versio
+00007c30: 6e60 2061 7267 756d 656e 7420 746f 2060  n` argument to `
+00007c40: 2d31 602e 0a0a 5468 6520 7265 7175 6972  -1`...The requir
+00007c50: 6564 2060 6576 656e 7473 6020 6172 6775  ed `events` argu
+00007c60: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
+00007c70: 2074 6f20 6265 2061 2073 6571 7565 6e63   to be a sequenc
+00007c80: 6520 6f66 206e 6577 2065 7665 6e74 206f  e of new event o
+00007c90: 626a 6563 7473 2e20 5468 650a 604e 6577  bjects. The.`New
+00007ca0: 4576 656e 7460 2063 6c61 7373 2073 686f  Event` class sho
+00007cb0: 756c 6420 6265 2075 7365 6420 746f 2063  uld be used to c
+00007cc0: 6f6e 7374 7275 6374 206e 6577 2065 7665  onstruct new eve
+00007cd0: 6e74 206f 626a 6563 7473 2e20 5468 6520  nt objects. The 
+00007ce0: 6061 7070 656e 645f 6576 656e 7473 2829  `append_events()
+00007cf0: 600a 6f70 6572 6174 696f 6e20 6973 2061  `.operation is a
+00007d00: 746f 6d69 632c 2073 6f20 7468 6174 2065  tomic, so that e
+00007d10: 6974 6865 7220 616c 6c20 6f72 206e 6f6e  ither all or non
+00007d20: 6520 6f66 2074 6865 206e 6577 2065 7665  e of the new eve
+00007d30: 6e74 7320 7769 6c6c 2062 6520 7265 636f  nts will be reco
+00007d40: 7264 6564 2e20 4974 0a69 7320 6e6f 7420  rded. It.is not 
+00007d50: 706f 7373 6962 6c65 2077 6974 6820 4576  possible with Ev
+00007d60: 656e 7453 746f 7265 4442 2061 746f 6d69  entStoreDB atomi
+00007d70: 6361 6c6c 7920 746f 2072 6563 6f72 6420  cally to record 
+00007d80: 6e65 7720 6576 656e 7473 2069 6e20 6d6f  new events in mo
+00007d90: 7265 2074 6861 6e20 6f6e 6520 7374 7265  re than one stre
+00007da0: 616d 2e0a 0a54 6869 7320 6d65 7468 6f64  am...This method
+00007db0: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
+00007dc0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00007dd0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+00007de0: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
+00007df0: 6174 600a 7468 6174 2073 6574 7320 6120  at`.that sets a 
+00007e00: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
+00007e10: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00007e20: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00007e30: 6e2e 0a0a 496e 2074 6865 2065 7861 6d70  n...In the examp
+00007e40: 6c65 2062 656c 6f77 2c20 6120 6e65 7720  le below, a new 
+00007e50: 6576 656e 742c 2060 6576 656e 7431 602c  event, `event1`,
+00007e60: 2069 7320 6170 7065 6e64 6564 2074 6f20   is appended to 
+00007e70: 6120 6e65 7720 7374 7265 616d 2e20 5468  a new stream. Th
+00007e80: 650a 7374 7265 616d 2064 6f65 7320 6e6f  e.stream does no
+00007e90: 7420 7965 7420 6578 6973 742c 2073 6f20  t yet exist, so 
+00007ea0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+00007eb0: 6020 6973 2060 4e6f 6e65 602e 0a0a 6060  ` is `None`...``
+00007ec0: 6070 7974 686f 6e0a 2320 436f 6e73 7472  `python.# Constr
+00007ed0: 7563 7420 6120 6e65 7720 6576 656e 7420  uct a new event 
+00007ee0: 6f62 6a65 6374 2e0a 6576 656e 7431 203d  object..event1 =
+00007ef0: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+00007f00: 4f72 6465 7243 7265 6174 6564 272c 2064  OrderCreated', d
+00007f10: 6174 613d 6227 6461 7461 3127 290a 0a23  ata=b'data1')..#
+00007f20: 2044 6566 696e 6520 6120 6e65 7720 7374   Define a new st
+00007f30: 7265 616d 206e 616d 652e 0a73 7472 6561  ream name..strea
+00007f40: 6d5f 6e61 6d65 3120 3d20 7374 7228 7575  m_name1 = str(uu
+00007f50: 6964 2e75 7569 6434 2829 290a 0a23 2041  id.uuid4())..# A
+00007f60: 7070 656e 6420 7468 6520 6e65 7720 6576  ppend the new ev
+00007f70: 656e 7473 2074 6f20 7468 6520 6e65 7720  ents to the new 
+00007f80: 7374 7265 616d 2e0a 636f 6d6d 6974 5f70  stream..commit_p
+00007f90: 6f73 6974 696f 6e31 203d 2063 6c69 656e  osition1 = clien
+00007fa0: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+00007fb0: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00007fc0: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
+00007fd0: 2020 2063 7572 7265 6e74 5f76 6572 7369     current_versi
+00007fe0: 6f6e 3d4e 6f6e 652c 0a20 2020 2065 7665  on=None,.    eve
+00007ff0: 6e74 733d 5b65 7665 6e74 315d 2c0a 290a  nts=[event1],.).
+00008000: 6060 600a 0a49 6e20 7468 6520 6578 616d  ```..In the exam
+00008010: 706c 6520 6265 6c6f 772c 2074 776f 2073  ple below, two s
+00008020: 7562 7365 7175 656e 7420 6576 656e 7473  ubsequent events
+00008030: 2061 7265 2061 7070 656e 6465 6420 746f   are appended to
+00008040: 2061 6e20 6578 6973 7469 6e67 0a73 7472   an existing.str
+00008050: 6561 6d2e 2054 6865 2073 7472 6561 6d2c  eam. The stream,
+00008060: 2060 7374 7265 616d 5f6e 616d 6531 602c   `stream_name1`,
+00008070: 2073 6f20 6661 7220 6861 7320 6f6e 6520   so far has one 
+00008080: 7265 636f 7264 6564 2065 7665 6e74 2c20  recorded event, 
+00008090: 616e 6420 736f 0a74 6865 2063 6f72 7265  and so.the corre
+000080a0: 6374 2076 616c 7565 206f 6620 6063 7572  ct value of `cur
+000080b0: 7265 6e74 5f76 6572 7369 6f6e 6020 6973  rent_version` is
+000080c0: 2060 3060 2e0a 0a60 6060 7079 7468 6f6e   `0`...```python
+000080d0: 0a65 7665 6e74 3220 3d20 4e65 7745 7665  .event2 = NewEve
+000080e0: 6e74 2874 7970 653d 274f 7264 6572 5570  nt(type='OrderUp
+000080f0: 6461 7465 6427 2c20 6461 7461 3d62 2764  dated', data=b'd
+00008100: 6174 6132 2729 0a65 7665 6e74 3320 3d20  ata2').event3 = 
+00008110: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+00008120: 7264 6572 4465 6c65 7465 6427 2c20 6461  rderDeleted', da
+00008130: 7461 3d62 2764 6174 6133 2729 0a0a 636f  ta=b'data3')..co
+00008140: 6d6d 6974 5f70 6f73 6974 696f 6e32 203d  mmit_position2 =
+00008150: 2063 6c69 656e 742e 6170 7065 6e64 5f65   client.append_e
+00008160: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
+00008170: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00008180: 6d65 312c 0a20 2020 2063 7572 7265 6e74  me1,.    current
+00008190: 5f76 6572 7369 6f6e 3d30 2c0a 2020 2020  _version=0,.    
+000081a0: 6576 656e 7473 3d5b 6576 656e 7432 2c20  events=[event2, 
+000081b0: 6576 656e 7433 5d2c 0a29 0a60 6060 0a0a  event3],.).```..
+000081c0: 5468 6520 7265 7475 726e 6564 2076 616c  The returned val
+000081d0: 7565 732c 2060 636f 6d6d 6974 5f70 6f73  ues, `commit_pos
+000081e0: 6974 696f 6e31 6020 616e 6420 6063 6f6d  ition1` and `com
+000081f0: 6d69 745f 706f 7369 7469 6f6e 3260 2c20  mit_position2`, 
+00008200: 6172 6520 7468 650a 636f 6d6d 6974 2070  are the.commit p
+00008210: 6f73 6974 696f 6e73 2069 6e20 7468 6520  ositions in the 
+00008220: 6461 7461 6261 7365 206f 6620 7468 6520  database of the 
+00008230: 6c61 7374 2065 7665 6e74 7320 696e 2074  last events in t
+00008240: 6865 2072 6563 6f72 6465 6420 7365 7175  he recorded sequ
+00008250: 656e 6365 732e 0a54 6861 7420 6973 2c20  ences..That is, 
+00008260: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00008270: 3160 2069 7320 7468 6520 636f 6d6d 6974  1` is the commit
+00008280: 2070 6f73 6974 696f 6e20 6f66 2060 6576   position of `ev
+00008290: 656e 7431 6020 616e 640a 6063 6f6d 6d69  ent1` and.`commi
+000082a0: 745f 706f 7369 7469 6f6e 3260 2069 7320  t_position2` is 
+000082b0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+000082c0: 696f 6e20 6f66 2060 6576 656e 7433 602e  ion of `event3`.
+000082d0: 0a0a 436f 6d6d 6974 2070 6f73 6974 696f  ..Commit positio
+000082e0: 6e73 2074 6861 7420 6172 6520 7265 7475  ns that are retu
+000082f0: 726e 6564 2069 6e20 7468 6973 2077 6179  rned in this way
+00008300: 2063 616e 2062 6520 7573 6564 2062 7920   can be used by 
+00008310: 6120 7573 6572 2069 6e74 6572 6661 6365  a user interface
+00008320: 2074 6f20 706f 6c6c 0a61 2064 6f77 6e73   to poll.a downs
+00008330: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
+00008340: 756e 7469 6c20 6974 2068 6173 2070 726f  until it has pro
+00008350: 6365 7373 6564 2061 6c6c 2074 6865 206e  cessed all the n
+00008360: 6577 6c79 2072 6563 6f72 6465 6420 6576  ewly recorded ev
+00008370: 656e 7473 2e20 466f 7220 6578 616d 706c  ents. For exampl
+00008380: 652c 0a63 6f6e 7369 6465 7220 6120 7573  e,.consider a us
+00008390: 6572 2069 6e74 6572 6661 6365 2063 6f6d  er interface com
+000083a0: 6d61 6e64 2074 6861 7420 7265 7375 6c74  mand that result
+000083b0: 7320 696e 2074 6865 2072 6563 6f72 6469  s in the recordi
+000083c0: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
+000083d0: 2c20 616e 6420 616e 0a65 7665 6e74 7561  , and an.eventua
+000083e0: 6c6c 7920 636f 6e73 6973 7465 6e74 206d  lly consistent m
+000083f0: 6174 6572 6961 6c69 7a65 6420 7669 6577  aterialized view
+00008400: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
+00008410: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
+00008420: 6973 2075 7064 6174 6564 2066 726f 6d0a  is updated from.
+00008430: 7468 6573 6520 6576 656e 7473 2e20 4966  these events. If
+00008440: 2074 6865 206e 6577 2065 7665 6e74 7320   the new events 
+00008450: 6861 7665 206e 6f74 2079 6574 2062 6565  have not yet bee
+00008460: 6e20 7072 6f63 6573 7365 642c 2074 6865  n processed, the
+00008470: 2076 6965 7720 6d69 6768 7420 6265 2073   view might be s
+00008480: 7461 6c65 2c0a 6f72 206f 7574 2d6f 662d  tale,.or out-of-
+00008490: 6461 7465 2e20 496e 7374 6561 6420 6f66  date. Instead of
+000084a0: 2064 6973 706c 6179 696e 6720 6120 7374   displaying a st
+000084b0: 616c 6520 7669 6577 2c20 7468 6520 7573  ale view, the us
+000084c0: 6572 2069 6e74 6572 6661 6365 2063 616e  er interface can
+000084d0: 2070 6f6c 6c20 7468 650a 646f 776e 7374   poll the.downst
+000084e0: 7265 616d 2063 6f6d 706f 6e65 6e74 2075  ream component u
+000084f0: 6e74 696c 2069 7420 6861 7320 7072 6f63  ntil it has proc
+00008500: 6573 7365 6420 7468 6520 6e65 776c 7920  essed the newly 
+00008510: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
+00008520: 2061 6e64 2074 6865 6e20 6469 7370 6c61   and then displa
+00008530: 790a 616e 2075 702d 746f 2d64 6174 6520  y.an up-to-date 
+00008540: 7669 6577 2074 6f20 7468 6520 7573 6572  view to the user
+00008550: 2e0a 0a0a 2323 2320 4170 7065 6e64 2065  ....### Append e
+00008560: 7665 6e74 0a0a 2a72 6571 7569 7265 7320  vent..*requires 
+00008570: 6c65 6164 6572 2a0a 0a54 6865 2060 6170  leader*..The `ap
+00008580: 7065 6e64 5f65 7665 6e74 2829 6020 6d65  pend_event()` me
+00008590: 7468 6f64 2069 7320 6c69 6b65 2060 6170  thod is like `ap
+000085a0: 7065 6e64 5f65 7665 6e74 7328 2960 2062  pend_events()` b
+000085b0: 7574 2063 616e 2062 6520 7573 6564 206f  ut can be used o
+000085c0: 6e6c 7920 746f 2077 7269 7465 2061 0a73  nly to write a.s
+000085d0: 696e 676c 6520 6e65 7720 6576 656e 7420  ingle new event 
+000085e0: 746f 2061 2073 7472 6561 6d2e 2049 6620  to a stream. If 
+000085f0: 7468 6520 6f70 6572 6174 696f 6e20 6973  the operation is
+00008600: 2073 7563 6365 7373 6675 6c2c 2069 7420   successful, it 
+00008610: 7265 7475 726e 7320 7468 6520 636f 6d6d  returns the comm
+00008620: 6974 0a70 6f73 6974 696f 6e20 6f66 2074  it.position of t
+00008630: 6865 206e 6577 6c79 2072 6563 6f72 6465  he newly recorde
+00008640: 6420 6576 656e 742e 0a0a 5468 6973 206d  d event...This m
+00008650: 6574 686f 6420 6861 7320 7468 7265 6520  ethod has three 
+00008660: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+00008670: 7473 2c20 6073 7472 6561 6d5f 6e61 6d65  ts, `stream_name
+00008680: 602c 2060 6375 7272 656e 745f 7665 7273  `, `current_vers
+00008690: 696f 6e60 2061 6e64 2060 6576 656e 7460  ion` and `event`
+000086a0: 2e0a 0a54 6865 2072 6571 7569 7265 6420  ...The required 
+000086b0: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
+000086c0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+000086d0: 6f6e 2060 7374 7260 2074 6861 7420 756e  on `str` that un
+000086e0: 6971 7565 6c79 2069 6465 6e74 6966 6965  iquely identifie
+000086f0: 7320 610a 7374 7265 616d 2074 6f20 7768  s a.stream to wh
+00008700: 6963 6820 6120 7365 7175 656e 6365 206f  ich a sequence o
+00008710: 6620 6576 656e 7473 2077 696c 6c20 6265  f events will be
+00008720: 2061 7070 656e 6465 642e 0a0a 5468 6520   appended...The 
+00008730: 7265 7175 6972 6564 2060 6375 7272 656e  required `curren
+00008740: 745f 7665 7273 696f 6e60 2061 7267 756d  t_version` argum
+00008750: 656e 7420 6973 2065 7870 6563 7465 6420  ent is expected 
+00008760: 746f 2062 6520 6569 7468 6572 2061 2050  to be either a P
+00008770: 7974 686f 6e20 6069 6e74 600a 7468 6174  ython `int`.that
+00008780: 2069 6e64 6963 6174 6573 2074 6865 2073   indicates the s
+00008790: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
+000087a0: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
+000087b0: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
+000087c0: 2073 7472 6561 6d2e 0a0a 5468 6520 7265   stream...The re
+000087d0: 7175 6972 6564 2060 6576 656e 7460 2061  quired `event` a
+000087e0: 7267 756d 656e 7420 6973 2065 7870 6563  rgument is expec
+000087f0: 7465 6420 746f 2062 6520 6120 7369 6e67  ted to be a sing
+00008800: 6c65 206e 6577 2065 7665 6e74 206f 626a  le new event obj
+00008810: 6563 742e 2054 6865 2065 7665 6e74 0a6f  ect. The event.o
+00008820: 626a 6563 7420 6973 2065 7870 6563 7465  bject is expecte
+00008830: 6420 746f 2062 6520 616e 2069 6e73 7461  d to be an insta
+00008840: 6e63 6520 6f66 2074 6865 2060 4e65 7745  nce of the `NewE
+00008850: 7665 6e74 6020 636c 6173 732e 0a0a 5468  vent` class...Th
+00008860: 6973 206d 6574 686f 6420 616c 736f 2068  is method also h
+00008870: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
+00008880: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00008890: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
+000088a0: 7468 6f6e 2060 666c 6f61 7460 0a74 6861  thon `float`.tha
+000088b0: 7420 7365 7473 2061 2064 6561 646c 696e  t sets a deadlin
+000088c0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+000088d0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+000088e0: 206f 7065 7261 7469 6f6e 2e0a 0a0a 2323   operation....##
+000088f0: 2320 4964 656d 706f 7465 6e74 2061 7070  # Idempotent app
+00008900: 656e 6420 6f70 6572 6174 696f 6e73 0a0a  end operations..
+00008910: 5468 6520 6061 7070 656e 645f 6576 656e  The `append_even
+00008920: 7428 2960 2061 6e64 2060 6170 7065 6e64  t()` and `append
+00008930: 5f65 7665 6e74 7328 2960 2061 6e64 206d  _events()` and m
+00008940: 6574 686f 6473 2061 7265 2022 6964 656d  ethods are "idem
+00008950: 706f 7465 6e74 222c 2069 6e20 7468 6174  potent", in that
+00008960: 0a69 6620 7468 6520 6d65 7468 6f64 7320  .if the methods 
+00008970: 6172 6520 6361 6c6c 6564 2077 6974 6820  are called with 
+00008980: 6e65 7720 6576 656e 7473 2077 686f 7365  new events whose
+00008990: 2060 6964 6020 6174 7472 6962 7574 6520   `id` attribute 
+000089a0: 7661 6c75 6573 2065 7175 616c 2074 686f  values equal tho
+000089b0: 7365 0a6f 6620 7265 636f 7264 6564 2065  se.of recorded e
+000089c0: 7665 6e74 7320 696e 2074 6865 206e 616d  vents in the nam
+000089d0: 6564 2073 7472 6561 6d20 696d 6d65 6469  ed stream immedi
+000089e0: 6174 656c 7920 6166 7465 7220 7468 6520  ately after the 
+000089f0: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+00008a00: 7370 6563 6966 6965 640a 6279 2074 6865  specified.by the
+00008a10: 2076 616c 7565 206f 6620 7468 6520 6063   value of the `c
+00008a20: 7572 7265 6e74 5f76 6572 7369 6f6e 6020  urrent_version` 
+00008a30: 6172 6775 6d65 6e74 2c20 7468 656e 2074  argument, then t
+00008a40: 6865 7365 206d 6574 686f 6473 2077 696c  hese methods wil
+00008a50: 6c20 7265 7475 726e 2074 6865 0a63 6f6d  l return the.com
+00008a60: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+00008a70: 7468 6520 6c61 7374 206e 6577 2065 7665  the last new eve
+00008a80: 6e74 2c20 7769 7468 6f75 7420 6d61 6b69  nt, without maki
+00008a90: 6e67 2061 6e79 2063 6861 6e67 6573 2074  ng any changes t
+00008aa0: 6f20 7468 6520 6461 7461 6261 7365 2e0a  o the database..
+00008ab0: 0a53 6f6d 6574 696d 6573 2069 7420 6d61  .Sometimes it ma
+00008ac0: 7920 6861 7070 656e 2c20 7768 656e 2063  y happen, when c
+00008ad0: 616c 6c69 6e67 2060 6170 7065 6e64 5f65  alling `append_e
+00008ae0: 7665 6e74 2829 6020 6f72 2060 6170 7065  vent()` or `appe
+00008af0: 6e64 5f65 7665 6e74 7328 2960 2c20 7468  nd_events()`, th
+00008b00: 6174 0a74 6865 206e 6577 2065 7665 6e74  at.the new event
+00008b10: 7320 6172 6520 7375 6363 6573 7366 756c  s are successful
+00008b20: 6c79 2072 6563 6f72 6465 6420 6275 7420  ly recorded but 
+00008b30: 736f 6d65 686f 7720 6120 636f 6e6e 6563  somehow a connec
+00008b40: 7469 6f6e 2069 7373 7565 206f 6363 7572  tion issue occur
+00008b50: 7320 6265 666f 7265 0a74 6865 2073 7563  s before.the suc
+00008b60: 6365 7373 6675 6c20 6361 6c6c 2063 616e  cessful call can
+00008b70: 2072 6574 7572 6e20 7375 6363 6573 7366   return successf
+00008b80: 756c 6c79 2074 6f20 7468 6520 636c 6965  ully to the clie
+00008b90: 6e74 2e20 5765 2063 616e 6e6f 7420 6265  nt. We cannot be
+00008ba0: 2073 7572 6520 6966 0a74 6865 2065 7665   sure if.the eve
+00008bb0: 6e74 7320 7765 7265 2072 6563 6f72 6465  nts were recorde
+00008bc0: 6420 6f72 206e 6f74 2c20 616e 6420 736f  d or not, and so
+00008bd0: 2077 6520 6d61 7920 7769 7368 2074 6f20   we may wish to 
+00008be0: 7265 7472 792e 2049 6620 7468 6520 6576  retry. If the ev
+00008bf0: 656e 7473 2077 6572 6520 696e 0a66 6163  ents were in.fac
+00008c00: 7420 7375 6363 6573 7366 756c 6c79 2072  t successfully r
+00008c10: 6563 6f72 6465 642c 2069 7420 6973 2063  ecorded, it is c
+00008c20: 6f6e 7665 6e69 656e 7420 666f 7220 7468  onvenient for th
+00008c30: 6520 7265 7472 6965 6420 6f70 6572 6174  e retried operat
+00008c40: 696f 6e20 746f 2072 6574 7572 6e0a 7375  ion to return.su
+00008c50: 6363 6573 7366 756c 6c79 2077 6974 686f  ccessfully witho
+00008c60: 7574 2072 6169 7369 6e67 2061 6e20 6578  ut raising an ex
+00008c70: 6365 7074 696f 6e2e 2049 6620 7468 6f73  ception. If thos
+00008c80: 6520 6e65 7720 6576 656e 7473 2077 6572  e new events wer
+00008c90: 6520 696e 2066 6163 7420 6e6f 7420 7265  e in fact not re
+00008ca0: 636f 7264 6564 2c0a 616e 6420 696e 2074  corded,.and in t
+00008cb0: 6865 206d 6561 6e74 696d 6520 6e6f 206f  he meantime no o
+00008cc0: 7468 6572 206e 6577 2065 7665 6e74 7320  ther new events 
+00008cd0: 7765 7265 2072 6563 6f72 6465 6420 696e  were recorded in
+00008ce0: 2074 6861 7420 7374 7265 616d 2c20 7468   that stream, th
+00008cf0: 656e 2069 7420 6d61 6b65 7320 7365 6e73  en it makes sens
+00008d00: 650a 7468 6174 2074 6865 206e 6577 2065  e.that the new e
+00008d10: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
+00008d20: 636f 7264 6564 2077 6865 6e20 7468 6520  corded when the 
+00008d30: 6170 7065 6e64 206f 7065 7261 7469 6f6e  append operation
+00008d40: 2069 7320 7265 7472 6965 642e 204f 6620   is retried. Of 
+00008d50: 636f 7572 7365 2c0a 6966 2061 2060 5772  course,.if a `Wr
+00008d60: 6f6e 6743 7572 7265 6e74 5665 7273 696f  ongCurrentVersio
+00008d70: 6e60 2065 7863 6570 7469 6f6e 2069 7320  n` exception is 
+00008d80: 7261 6973 6564 2077 6865 6e20 7265 7472  raised when retr
+00008d90: 7969 6e67 2074 6865 206f 7065 7261 7469  ying the operati
+00008da0: 6f6e 2c20 7468 656e 2061 6e0a 6170 706c  on, then an.appl
+00008db0: 6963 6174 696f 6e20 636f 6d6d 616e 6420  ication command 
+00008dc0: 7768 6963 6820 6765 6e65 7261 7465 6420  which generated 
+00008dd0: 7468 6520 6e65 7720 6576 656e 7473 2069  the new events i
+00008de0: 6e20 7468 6520 636f 6e74 6578 7420 6f66  n the context of
+00008df0: 2061 6c72 6561 6479 2072 6563 6f72 6465   already recorde
+00008e00: 640a 6576 656e 7473 206d 6179 206e 6565  d.events may nee
+00008e10: 6420 746f 2062 6520 6578 6563 7574 6564  d to be executed
+00008e20: 2061 6761 696e 2e20 416c 7465 726e 6174   again. Alternat
+00008e30: 6976 656c 792c 2061 2073 7569 7461 626c  ively, a suitabl
+00008e40: 6520 6572 726f 7220 6d69 6768 7420 6265  e error might be
+00008e50: 2064 6973 706c 6179 6564 0a62 7920 7468   displayed.by th
+00008e60: 6520 6170 706c 6963 6174 696f 6e2c 2077  e application, w
+00008e70: 6974 6820 616e 2075 702d 746f 2d64 6174  ith an up-to-dat
+00008e80: 6520 7669 6577 206f 6620 7468 6520 7265  e view of the re
+00008e90: 636f 7264 6564 2064 6174 612c 2067 6976  corded data, giv
+00008ea0: 696e 6720 6120 7573 6572 206f 6620 7468  ing a user of th
+00008eb0: 650a 6170 706c 6963 6174 696f 6e20 616e  e.application an
+00008ec0: 206f 7070 6f72 7475 6e69 7479 2074 6f20   opportunity to 
+00008ed0: 6465 6369 6465 2069 6620 7468 6579 2073  decide if they s
+00008ee0: 7469 6c6c 2077 6973 6820 746f 2070 726f  till wish to pro
+00008ef0: 6365 6564 2077 6974 6820 7468 6569 7220  ceed with their 
+00008f00: 6f72 6967 696e 616c 0a69 6e74 656e 7469  original.intenti
+00008f10: 6f6e 2e0a 0a54 6865 2065 7861 6d70 6c65  on...The example
+00008f20: 2062 656c 6f77 2073 686f 7773 2074 6865   below shows the
+00008f30: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00008f40: 2960 206d 6574 686f 6420 6265 696e 6720  )` method being 
+00008f50: 6361 6c6c 6564 2061 6761 696e 2077 6974  called again wit
+00008f60: 680a 6065 7665 6e74 3360 2061 6e64 2060  h.`event3` and `
+00008f70: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
+00008f80: 3060 2e20 5765 2063 616e 2073 6565 2074  0`. We can see t
+00008f90: 6861 7420 7265 7065 6174 696e 6720 7468  hat repeating th
+00008fa0: 6520 6361 6c6c 2074 6f0a 6061 7070 656e  e call to.`appen
+00008fb0: 645f 6576 656e 7473 2829 6020 7265 7475  d_events()` retu
+00008fc0: 726e 7320 7375 6363 6573 7366 756c 6c79  rns successfully
+00008fd0: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2052  ...```python.# R
+00008fe0: 6574 7279 2061 7070 656e 6469 6e67 2065  etry appending e
+00008ff0: 7665 6e74 332e 0a63 6f6d 6d69 745f 706f  vent3..commit_po
+00009000: 7369 7469 6f6e 5f72 6574 7279 203d 2063  sition_retry = c
+00009010: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00009020: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+00009030: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00009040: 312c 0a20 2020 2063 7572 7265 6e74 5f76  1,.    current_v
+00009050: 6572 7369 6f6e 3d30 2c0a 2020 2020 6576  ersion=0,.    ev
+00009060: 656e 7473 3d5b 6576 656e 7432 2c20 6576  ents=[event2, ev
+00009070: 656e 7433 5d2c 0a29 0a60 6060 0a0a 5765  ent3],.).```..We
+00009080: 2063 616e 2073 6565 2074 6861 7420 7468   can see that th
+00009090: 6520 7361 6d65 2063 6f6d 6d69 7420 706f  e same commit po
+000090a0: 7369 7469 6f6e 2069 7320 7265 7475 726e  sition is return
+000090b0: 6564 2061 7320 6162 6f76 652e 0a0a 6060  ed as above...``
+000090c0: 6070 7974 686f 6e0a 6173 7365 7274 2063  `python.assert c
+000090d0: 6f6d 6d69 745f 706f 7369 7469 6f6e 5f72  ommit_position_r
+000090e0: 6574 7279 203d 3d20 636f 6d6d 6974 5f70  etry == commit_p
+000090f0: 6f73 6974 696f 6e32 0a60 6060 0a0a 4279  osition2.```..By
+00009100: 2063 616c 6c69 6e67 2060 7265 6164 5f73   calling `read_s
+00009110: 7472 6561 6d5f 6576 656e 7473 2829 602c  tream_events()`,
+00009120: 2077 6520 6361 6e20 616c 736f 2073 6565   we can also see
+00009130: 2074 6865 2073 7472 6561 6d20 6861 7320   the stream has 
+00009140: 6265 656e 2075 6e63 6861 6e67 6564 0a64  been unchanged.d
+00009150: 6573 7069 7465 2074 6865 2060 6170 7065  espite the `appe
+00009160: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
+00009170: 686f 6420 6861 7669 6e67 2062 6565 6e20  hod having been 
+00009180: 6361 6c6c 6564 2074 7769 6365 2077 6974  called twice wit
+00009190: 6820 7468 6520 7361 6d65 2061 7267 756d  h the same argum
+000091a0: 656e 7473 2e0a 5468 6174 2069 732c 2074  ents..That is, t
+000091b0: 6865 7265 2061 7265 2073 7469 6c6c 206f  here are still o
+000091c0: 6e6c 7920 7468 7265 6520 6576 656e 7473  nly three events
+000091d0: 2069 6e20 7468 6520 7374 7265 616d 2e0a   in the stream..
+000091e0: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+000091f0: 7320 3d20 636c 6965 6e74 2e72 6561 645f  s = client.read_
+00009200: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
+00009210: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+00009220: 7472 6561 6d5f 6e61 6d65 310a 290a 0a61  tream_name1.)..a
+00009230: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+00009240: 2920 3d3d 2033 0a60 6060 0a0a 5468 6973  ) == 3.```..This
+00009250: 2069 6465 6d70 6f74 656e 7420 6265 6861   idempotent beha
+00009260: 7669 6f75 7220 6465 7065 6e64 7320 6f6e  viour depends on
+00009270: 2074 6865 2060 6964 6020 6174 7472 6962   the `id` attrib
+00009280: 7574 6520 6f66 2074 6865 2060 4e65 7745  ute of the `NewE
+00009290: 7665 6e74 6020 636c 6173 732e 0a54 6869  vent` class..Thi
+000092a0: 7320 6174 7472 6962 7574 652c 2062 7920  s attribute, by 
+000092b0: 6465 6661 756c 742c 2069 7320 6173 7369  default, is assi
+000092c0: 676e 6564 2061 206e 6577 2061 6e64 2075  gned a new and u
+000092d0: 6e69 7175 6520 7665 7273 696f 6e2d 3420  nique version-4 
+000092e0: 5555 4944 2077 6865 6e20 616e 0a69 6e73  UUID when an.ins
+000092f0: 7461 6e63 6520 6f66 2060 4e65 7745 7665  tance of `NewEve
+00009300: 6e74 6020 6973 2063 6f6e 7374 7275 6374  nt` is construct
+00009310: 6564 2e20 5468 6520 6069 6460 2061 7267  ed. The `id` arg
+00009320: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+00009330: 6420 7768 656e 0a63 6f6e 7374 7275 6374  d when.construct
+00009340: 696e 6720 604e 6577 4576 656e 7460 206f  ing `NewEvent` o
+00009350: 626a 6563 7473 2074 6f20 7365 7420 7468  bjects to set th
+00009360: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
+00009370: 6174 7472 6962 7574 652e 0a0a 0a23 2323  attribute....###
+00009380: 2052 6561 6420 7374 7265 616d 2065 7665   Read stream eve
+00009390: 6e74 730a 0a54 6865 2060 7265 6164 5f73  nts..The `read_s
+000093a0: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+000093b0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+000093c0: 6564 2074 6f20 6765 7420 6576 656e 7473  ed to get events
+000093d0: 2074 6861 7420 6861 7665 2062 6565 6e20   that have been 
+000093e0: 6170 7065 6e64 6564 0a74 6f20 6120 7374  appended.to a st
+000093f0: 7265 616d 2e20 5468 6973 206d 6574 686f  ream. This metho
+00009400: 6420 7265 7475 726e 7320 6120 5079 7468  d returns a Pyth
+00009410: 6f6e 2060 7475 706c 6560 206f 6620 7265  on `tuple` of re
+00009420: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
+00009430: 6563 7473 2e20 5468 650a 7265 636f 7264  ects. The.record
+00009440: 6564 2065 7665 6e74 206f 626a 6563 7473  ed event objects
+00009450: 2061 7265 2069 6e73 7461 6e63 6573 206f   are instances o
+00009460: 6620 7468 6520 6052 6563 6f72 6465 6445  f the `RecordedE
+00009470: 7665 6e74 6020 636c 6173 732e 0a0a 5468  vent` class...Th
+00009480: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+00009490: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+000094a0: 656e 742c 2060 7374 7265 616d 5f6e 616d  ent, `stream_nam
+000094b0: 6560 2e0a 0a54 6865 2072 6571 7569 7265  e`...The require
+000094c0: 6420 6073 7472 6561 6d5f 6e61 6d65 6020  d `stream_name` 
+000094d0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+000094e0: 7468 6f6e 2060 7374 7260 2074 6861 7420  thon `str` that 
+000094f0: 756e 6971 7565 6c79 2069 6465 6e74 6966  uniquely identif
+00009500: 6965 7320 610a 7374 7265 616d 2066 726f  ies a.stream fro
+00009510: 6d20 7768 6963 6820 7265 636f 7264 6564  m which recorded
+00009520: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+00009530: 7265 7475 726e 6564 2e0a 0a54 6865 2060  returned...The `
+00009540: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+00009550: 7473 2829 6020 6d65 7468 6f64 2061 6c73  ts()` method als
+00009560: 6f20 6861 7320 666f 7572 206f 7074 696f  o has four optio
+00009570: 6e61 6c20 6172 6775 6d65 6e74 732c 0a60  nal arguments,.`
+00009580: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+00009590: 2c20 6062 6163 6b77 6172 6473 602c 2060  , `backwards`, `
+000095a0: 6c69 6d69 7460 2c20 616e 6420 6074 696d  limit`, and `tim
+000095b0: 656f 7574 602e 0a0a 5468 6520 6f70 7469  eout`...The opti
+000095c0: 6f6e 616c 2060 7374 7265 616d 5f70 6f73  onal `stream_pos
+000095d0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+000095e0: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+000095f0: 6020 7468 6174 2063 616e 2062 6520 7573  ` that can be us
+00009600: 6564 2074 6f0a 696e 6469 6361 7465 2074  ed to.indicate t
+00009610: 6865 2070 6f73 6974 696f 6e20 696e 2074  he position in t
+00009620: 6865 2073 7472 6561 6d20 6672 6f6d 2077  he stream from w
+00009630: 6869 6368 2074 6f20 7374 6172 7420 7265  hich to start re
+00009640: 6164 696e 672e 2054 6865 2064 6566 6175  ading. The defau
+00009650: 6c74 2076 616c 7565 0a6f 6620 6073 7472  lt value.of `str
+00009660: 6561 6d5f 706f 7369 7469 6f6e 6020 6973  eam_position` is
+00009670: 2060 4e6f 6e65 602e 2057 6865 6e20 7265   `None`. When re
+00009680: 6164 696e 6720 6120 7374 7265 616d 2066  ading a stream f
+00009690: 726f 6d20 6120 7370 6563 6966 6963 2070  rom a specific p
+000096a0: 6f73 6974 696f 6e20 696e 2074 6865 0a73  osition in the.s
+000096b0: 7472 6561 6d2c 2074 6865 2072 6563 6f72  tream, the recor
+000096c0: 6465 6420 6576 656e 7420 6174 2074 6861  ded event at tha
+000096d0: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+000096e0: 6265 2069 6e63 6c75 6465 642c 2062 6f74  be included, bot
+000096f0: 6820 7768 656e 2072 6561 6469 6e67 0a66  h when reading.f
+00009700: 6f72 7761 7264 7320 6672 6f6d 2074 6861  orwards from tha
+00009710: 7420 706f 7369 7469 6f6e 2c20 616e 6420  t position, and 
+00009720: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
+00009730: 6b77 6172 6473 2e0a 0a54 6865 206f 7074  kwards...The opt
+00009740: 696f 6e61 6c20 6062 6163 6b77 6172 6473  ional `backwards
+00009750: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00009760: 5079 7468 6f6e 2060 626f 6f6c 602e 2054  Python `bool`. T
+00009770: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00009780: 206f 6620 6062 6163 6b77 6172 6473 600a   of `backwards`.
+00009790: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
+000097a0: 6820 6d65 616e 7320 7468 6520 7374 7265  h means the stre
+000097b0: 616d 2077 696c 6c20 6265 2072 6561 6420  am will be read 
+000097c0: 666f 7277 6172 6473 2c20 736f 2074 6861  forwards, so tha
+000097d0: 7420 6576 656e 7473 2061 7265 2072 6574  t events are ret
+000097e0: 7572 6e65 640a 696e 2074 6865 206f 7264  urned.in the ord
+000097f0: 6572 2074 6865 7920 7765 7265 2072 6563  er they were rec
+00009800: 6f72 6465 642e 2049 6620 6062 6163 6b77  orded. If `backw
+00009810: 6172 6473 6020 6973 2060 5472 7565 602c  ards` is `True`,
+00009820: 2074 6865 2065 7665 6e74 7320 6172 6520   the events are 
+00009830: 7265 7475 726e 6564 2069 6e0a 7265 7665  returned in.reve
+00009840: 7273 6520 6f72 6465 722e 0a0a 4966 2060  rse order...If `
+00009850: 6261 636b 7761 7264 7360 2069 7320 6046  backwards` is `F
+00009860: 616c 7365 6020 616e 6420 6073 7472 6561  alse` and `strea
+00009870: 6d5f 706f 7369 7469 6f6e 6020 6973 2060  m_position` is `
+00009880: 4e6f 6e65 602c 2074 6865 2073 7472 6561  None`, the strea
+00009890: 6d27 7320 6576 656e 7473 2077 696c 6c20  m's events will 
+000098a0: 6265 0a72 6574 7572 6e65 6420 696e 2074  be.returned in t
+000098b0: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
+000098c0: 7265 2072 6563 6f72 6465 642c 2073 7461  re recorded, sta
+000098d0: 7274 696e 6720 6672 6f6d 2074 6865 2066  rting from the f
+000098e0: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+000098f0: 656e 742e 2054 6869 730a 6973 2074 6865  ent. This.is the
+00009900: 2064 6566 6175 6c74 2062 6568 6176 696f   default behavio
+00009910: 7220 6f66 2060 7265 6164 5f73 7472 6561  r of `read_strea
+00009920: 6d5f 6576 656e 7473 2829 602e 2049 6620  m_events()`. If 
+00009930: 6062 6163 6b77 6172 6473 6020 6973 2060  `backwards` is `
+00009940: 5472 7565 6020 616e 640a 6073 7472 6561  True` and.`strea
+00009950: 6d5f 706f 7369 7469 6f6e 6020 6973 2060  m_position` is `
+00009960: 4e6f 6e65 602c 2074 6865 2073 7472 6561  None`, the strea
+00009970: 6d27 7320 6576 656e 7473 2077 696c 6c20  m's events will 
+00009980: 6265 2072 6574 7572 6e65 6420 696e 2072  be returned in r
+00009990: 6576 6572 7365 206f 7264 6572 2c0a 7374  everse order,.st
+000099a0: 6172 7469 6e67 2066 726f 6d20 7468 6520  arting from the 
+000099b0: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
+000099c0: 656e 742e 0a0a 5468 6520 6f70 7469 6f6e  ent...The option
+000099d0: 616c 2060 6c69 6d69 7460 2061 7267 756d  al `limit` argum
+000099e0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+000099f0: 6069 6e74 6020 7768 6963 6820 7265 7374  `int` which rest
+00009a00: 7269 6374 7320 7468 6520 6e75 6d62 6572  ricts the number
+00009a10: 206f 6620 6576 656e 7473 0a74 6861 7420   of events.that 
+00009a20: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+00009a30: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+00009a40: 6c75 6520 6f66 2060 6c69 6d69 7460 2069  lue of `limit` i
+00009a50: 7320 6073 7973 2e6d 6178 696e 7460 2e0a  s `sys.maxint`..
+00009a60: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
+00009a70: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00009a80: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00009a90: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+00009aa0: 6120 6465 6164 6c69 6e65 2066 6f72 0a74  a deadline for.t
+00009ab0: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00009ac0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00009ad0: 696f 6e2e 0a0a 5468 6520 6578 616d 706c  ion...The exampl
+00009ae0: 6520 6265 6c6f 7720 7368 6f77 7320 7468  e below shows th
+00009af0: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
+00009b00: 6f72 206f 6620 7468 6973 206d 6574 686f  or of this metho
+00009b10: 642c 2077 6869 6368 2069 7320 746f 2072  d, which is to r
+00009b20: 6574 7572 6e20 616c 6c0a 7468 6520 7265  eturn all.the re
+00009b30: 636f 7264 6564 2065 7665 6e74 7320 6f66  corded events of
+00009b40: 2061 2073 7472 6561 6d20 666f 7277 6172   a stream forwar
+00009b50: 6473 2066 726f 6d20 7468 6520 6669 7273  ds from the firs
+00009b60: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+00009b70: 7320 746f 2074 6865 206c 6173 742e 0a0a  s to the last...
+00009b80: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
+00009b90: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+00009ba0: 7472 6561 6d5f 6576 656e 7473 280a 2020  tream_events(.  
+00009bb0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00009bc0: 7265 616d 5f6e 616d 6531 0a29 0a0a 6173  ream_name1.)..as
+00009bd0: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+00009be0: 203d 3d20 330a 6173 7365 7274 2065 7665   == 3.assert eve
+00009bf0: 6e74 735b 305d 2e69 6420 3d3d 2065 7665  nts[0].id == eve
+00009c00: 6e74 312e 6964 0a61 7373 6572 7420 6576  nt1.id.assert ev
+00009c10: 656e 7473 5b31 5d2e 6964 203d 3d20 6576  ents[1].id == ev
+00009c20: 656e 7432 2e69 640a 6173 7365 7274 2065  ent2.id.assert e
+00009c30: 7665 6e74 735b 325d 2e69 6420 3d3d 2065  vents[2].id == e
+00009c40: 7665 6e74 332e 6964 0a60 6060 0a0a 5468  vent3.id.```..Th
+00009c50: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00009c60: 7368 6f77 7320 686f 7720 746f 2075 7365  shows how to use
+00009c70: 2074 6865 2060 7374 7265 616d 5f70 6f73   the `stream_pos
+00009c80: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+00009c90: 746f 2072 6561 6420 6120 7374 7265 616d  to read a stream
+00009ca0: 0a66 726f 6d20 6120 7370 6563 6966 6963  .from a specific
+00009cb0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00009cc0: 2074 6f20 7468 6520 656e 6420 6f66 2074   to the end of t
+00009cd0: 6865 2073 7472 6561 6d2e 2053 7472 6561  he stream. Strea
+00009ce0: 6d20 706f 7369 7469 6f6e 7320 6172 650a  m positions are.
+00009cf0: 7a65 726f 2d62 6173 6564 2c20 616e 6420  zero-based, and 
+00009d00: 736f 2060 7374 7265 616d 5f70 6f73 6974  so `stream_posit
+00009d10: 696f 6e3d 3160 2063 6f72 7265 7370 6f6e  ion=1` correspon
+00009d20: 6473 2074 6f20 7468 6520 7365 636f 6e64  ds to the second
+00009d30: 2065 7665 6e74 2074 6861 7420 7761 730a   event that was.
+00009d40: 7265 636f 7264 6564 2069 6e20 7468 6520  recorded in the 
+00009d50: 7374 7265 616d 2c20 696e 2074 6869 7320  stream, in this 
+00009d60: 6361 7365 2060 6576 656e 7432 602e 0a0a  case `event2`...
+00009d70: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
+00009d80: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+00009d90: 7472 6561 6d5f 6576 656e 7473 280a 2020  tream_events(.  
+00009da0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00009db0: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
+00009dc0: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
+00009dd0: 312c 0a29 0a0a 6173 7365 7274 206c 656e  1,.)..assert len
+00009de0: 2865 7665 6e74 7329 203d 3d20 320a 6173  (events) == 2.as
+00009df0: 7365 7274 2065 7665 6e74 735b 305d 2e69  sert events[0].i
+00009e00: 6420 3d3d 2065 7665 6e74 322e 6964 0a61  d == event2.id.a
+00009e10: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
+00009e20: 6964 203d 3d20 6576 656e 7433 2e69 640a  id == event3.id.
+00009e30: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+00009e40: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
+00009e50: 2074 6f20 7573 6520 7468 6520 6062 6163   to use the `bac
+00009e60: 6b77 6172 6473 6020 6172 6775 6d65 6e74  kwards` argument
+00009e70: 2074 6f20 7265 6164 2061 2073 7472 6561   to read a strea
+00009e80: 6d20 6261 636b 7761 7264 732e 0a0a 6060  m backwards...``
+00009e90: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
+00009ea0: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+00009eb0: 6561 6d5f 6576 656e 7473 280a 2020 2020  eam_events(.    
+00009ec0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00009ed0: 616d 5f6e 616d 6531 2c0a 2020 2020 6261  am_name1,.    ba
+00009ee0: 636b 7761 7264 733d 5472 7565 2c0a 290a  ckwards=True,.).
+00009ef0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
+00009f00: 7473 2920 3d3d 2033 0a61 7373 6572 7420  ts) == 3.assert 
+00009f10: 6576 656e 7473 5b30 5d2e 6964 203d 3d20  events[0].id == 
+00009f20: 6576 656e 7433 2e69 640a 6173 7365 7274  event3.id.assert
+00009f30: 2065 7665 6e74 735b 315d 2e69 6420 3d3d   events[1].id ==
+00009f40: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
+00009f50: 7420 6576 656e 7473 5b32 5d2e 6964 203d  t events[2].id =
+00009f60: 3d20 6576 656e 7431 2e69 640a 6060 600a  = event1.id.```.
+00009f70: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+00009f80: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+00009f90: 7573 6520 7468 6520 606c 696d 6974 6020  use the `limit` 
+00009fa0: 6172 6775 6d65 6e74 2074 6f20 7265 6164  argument to read
+00009fb0: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
+00009fc0: 7220 6f66 0a65 7665 6e74 732e 0a0a 6060  r of.events...``
+00009fd0: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
+00009fe0: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+00009ff0: 6561 6d5f 6576 656e 7473 280a 2020 2020  eam_events(.    
+0000a000: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000a010: 616d 5f6e 616d 6531 2c0a 2020 2020 6c69  am_name1,.    li
+0000a020: 6d69 743d 322c 0a29 0a0a 6173 7365 7274  mit=2,.)..assert
+0000a030: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+0000a040: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
+0000a050: 305d 2e69 6420 3d3d 2065 7665 6e74 312e  0].id == event1.
+0000a060: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+0000a070: 5b31 5d2e 6964 203d 3d20 6576 656e 7432  [1].id == event2
+0000a080: 2e69 640a 6060 600a 0a54 6865 2060 7265  .id.```..The `re
+0000a090: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+0000a0a0: 2829 6020 6d65 7468 6f64 2077 696c 6c20  ()` method will 
+0000a0b0: 7261 6973 6520 6120 604e 6f74 466f 756e  raise a `NotFoun
+0000a0c0: 6460 2065 7863 6570 7469 6f6e 2069 6620  d` exception if 
+0000a0d0: 7468 6520 6e61 6d65 6420 7374 7265 616d  the named stream
+0000a0e0: 0a68 6173 206e 6576 6572 2065 7869 7374  .has never exist
+0000a0f0: 6564 206f 7220 6861 7320 6265 656e 2064  ed or has been d
+0000a100: 656c 6574 6564 2e0a 0a60 6060 7079 7468  eleted...```pyth
+0000a110: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+0000a120: 6e74 2e65 7863 6570 7469 6f6e 7320 696d  nt.exceptions im
+0000a130: 706f 7274 204e 6f74 466f 756e 640a 0a0a  port NotFound...
+0000a140: 7472 793a 0a20 2020 2063 6c69 656e 742e  try:.    client.
+0000a150: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+0000a160: 7473 2827 646f 6573 2d6e 6f74 2d65 7869  ts('does-not-exi
+0000a170: 7374 2729 0a65 7863 6570 7420 4e6f 7446  st').except NotF
+0000a180: 6f75 6e64 3a0a 2020 2020 7061 7373 2020  ound:.    pass  
+0000a190: 2320 5468 6520 7374 7265 616d 2064 6f65  # The stream doe
+0000a1a0: 7320 6e6f 7420 6578 6973 742e 0a65 6c73  s not exist..els
+0000a1b0: 653a 0a20 2020 2072 6169 7365 2045 7863  e:.    raise Exc
+0000a1c0: 6570 7469 6f6e 2822 5368 6f75 6c64 6e27  eption("Shouldn'
+0000a1d0: 7420 6765 7420 6865 7265 2229 0a60 6060  t get here").```
+0000a1e0: 0a0a 506c 6561 7365 206e 6f74 652c 2074  ..Please note, t
+0000a1f0: 6869 7320 6d65 7468 6f64 2073 7472 6561  his method strea
+0000a200: 6d73 2072 6563 6f72 6465 6420 6576 656e  ms recorded even
+0000a210: 7473 2066 726f 6d20 7468 6520 7365 7276  ts from the serv
+0000a220: 6572 2061 6e64 2074 6865 6e0a 636f 6e73  er and then.cons
+0000a230: 7472 7563 7473 2061 6e64 2072 6574 7572  tructs and retur
+0000a240: 6e73 2061 2050 7974 686f 6e20 6074 7570  ns a Python `tup
+0000a250: 6c65 602e 2049 6e20 6361 7365 2079 6f75  le`. In case you
+0000a260: 2064 6f6e 2774 2077 616e 7420 7468 6520   don't want the 
+0000a270: 636c 6965 6e74 2074 6f0a 6669 6e69 7368  client to.finish
+0000a280: 2073 7472 6561 6d69 6e67 2065 7665 6e74   streaming event
+0000a290: 7320 6672 6f6d 2074 6865 2064 6174 6162  s from the datab
+0000a2a0: 6173 6520 6265 666f 7265 2069 7420 7265  ase before it re
+0000a2b0: 7475 726e 732c 2079 6f75 2063 616e 2069  turns, you can i
+0000a2c0: 6e73 7465 6164 0a75 7365 2074 6865 2060  nstead.use the `
+0000a2d0: 6974 6572 5f73 7472 6561 6d5f 6576 656e  iter_stream_even
+0000a2e0: 7473 2829 6020 6d65 7468 6f64 2c20 7768  ts()` method, wh
+0000a2f0: 6963 6820 7265 7475 726e 7320 616e 2069  ich returns an i
+0000a300: 7465 7261 626c 6520 2272 6561 6420 7265  terable "read re
+0000a310: 7370 6f6e 7365 220a 6f62 6a65 6374 2e20  sponse".object. 
+0000a320: 4120 2272 6561 6420 7265 7370 6f6e 7365  A "read response
+0000a330: 2220 6973 2061 6e20 6974 6572 6174 6f72  " is an iterator
+0000a340: 2c20 616e 6420 6e6f 7420 6120 7365 7175  , and not a sequ
+0000a350: 656e 6365 2e20 5265 636f 7264 6564 2065  ence. Recorded e
+0000a360: 7665 6e74 7320 6361 6e0a 6265 206f 6274  vents can.be obt
+0000a370: 6169 6e65 6420 6279 2069 7465 7261 7469  ained by iterati
+0000a380: 6e67 206f 7665 7220 7468 6520 2272 6561  ng over the "rea
+0000a390: 6420 7265 7370 6f6e 7365 2220 6f62 6a65  d response" obje
+0000a3a0: 6374 2e20 4974 2073 7472 6561 6d73 2072  ct. It streams r
+0000a3b0: 6563 6f72 6465 6420 6576 656e 7473 0a66  ecorded events.f
+0000a3c0: 726f 6d20 7468 6520 7365 7276 6572 2061  rom the server a
+0000a3d0: 7320 7468 6520 6974 6572 6174 696f 6e20  s the iteration 
+0000a3e0: 7072 6f63 6565 6473 2e20 5468 6520 6974  proceeds. The it
+0000a3f0: 6572 6174 696f 6e20 7769 6c6c 2061 7574  eration will aut
+0000a400: 6f6d 6174 6963 616c 6c79 2073 746f 700a  omatically stop.
+0000a410: 7768 656e 2074 6865 7265 2061 7265 206e  when there are n
+0000a420: 6f20 6d6f 7265 2072 6563 6f72 6465 6420  o more recorded 
+0000a430: 6576 656e 7473 2074 6f20 6265 2072 6574  events to be ret
+0000a440: 7572 6e65 642e 2054 6865 2073 7472 6561  urned. The strea
+0000a450: 6d69 6e67 206f 6620 6576 656e 7473 2c0a  ming of events,.
+0000a460: 616e 6420 6865 6e63 6520 7468 6520 6974  and hence the it
+0000a470: 6572 6174 6f72 2c20 6361 6e20 616c 736f  erator, can also
+0000a480: 2062 6520 7374 6f70 7065 6420 7072 656d   be stopped prem
+0000a490: 6174 7572 656c 7920 6279 2063 616c 6c69  aturely by calli
+0000a4a0: 6e67 2074 6865 2060 7374 6f70 2829 600a  ng the `stop()`.
+0000a4b0: 6d65 7468 6f64 206f 6e20 7468 6520 2272  method on the "r
+0000a4c0: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
+0000a4d0: 6a65 6374 2e0a 0a49 6e20 6661 6374 2c20  ject...In fact, 
+0000a4e0: 7468 6520 6072 6561 645f 7374 7265 616d  the `read_stream
+0000a4f0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+0000a500: 6420 6361 6c6c 7320 6069 7465 725f 7374  d calls `iter_st
+0000a510: 7265 616d 5f65 7665 6e74 7328 2960 2061  ream_events()` a
+0000a520: 6e64 2070 6173 7365 730a 7468 6520 2272  nd passes.the "r
+0000a530: 6561 6420 7265 7370 6f6e 7365 2220 6974  ead response" it
+0000a540: 6572 6174 6f72 2069 6e74 6f20 7468 6520  erator into the 
+0000a550: 5079 7468 6f6e 2060 7475 706c 6560 2063  Python `tuple` c
+0000a560: 6f6e 7374 7275 6374 6f72 2e20 486f 7765  onstructor. Howe
+0000a570: 7665 722c 2074 6865 0a60 7265 6164 5f73  ver, the.`read_s
+0000a580: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+0000a590: 6d65 7468 6f64 2069 7320 6465 636f 7261  method is decora
+0000a5a0: 7465 6420 7769 7468 2072 6574 7279 2061  ted with retry a
+0000a5b0: 6e64 2072 6563 6f6e 6e65 6374 2064 6563  nd reconnect dec
+0000a5c0: 6f72 6174 6f72 732c 0a77 6869 6c73 7420  orators,.whilst 
+0000a5d0: 7468 6520 6069 7465 725f 7374 7265 616d  the `iter_stream
+0000a5e0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+0000a5f0: 6420 6973 206e 6f74 2e20 5468 6973 206d  d is not. This m
+0000a600: 6561 6e73 2074 6861 7420 616c 6c20 6572  eans that all er
+0000a610: 726f 7273 2064 7565 2074 6f0a 636f 6e6e  rors due to.conn
+0000a620: 6563 7469 6f6e 2069 7373 7565 7320 7769  ection issues wi
+0000a630: 6c6c 2062 6520 6361 7567 6874 2062 7920  ll be caught by 
+0000a640: 7468 6520 7265 7472 7920 616e 6420 7265  the retry and re
+0000a650: 636f 6e6e 6563 7420 6465 636f 7261 746f  connect decorato
+0000a660: 7273 2077 6865 6e20 6361 6c6c 696e 670a  rs when calling.
+0000a670: 7468 6520 6072 6561 645f 7374 7265 616d  the `read_stream
+0000a680: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+0000a690: 642c 2062 7574 206e 6f74 2077 6865 6e20  d, but not when 
+0000a6a0: 6361 6c6c 696e 6720 6069 7465 725f 7374  calling `iter_st
+0000a6b0: 7265 616d 5f65 7665 6e74 7328 2960 2e20  ream_events()`. 
+0000a6c0: 5468 650a 6069 7465 725f 7374 7265 616d  The.`iter_stream
+0000a6d0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+0000a6e0: 6420 6861 7320 6e6f 2073 7563 6820 6465  d has no such de
+0000a6f0: 636f 7261 746f 7273 2062 6563 6175 7365  corators because
+0000a700: 2074 6865 2073 7472 6561 6d69 6e67 206f   the streaming o
+0000a710: 6e6c 7920 7374 6172 7473 0a77 6865 6e20  nly starts.when 
+0000a720: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
+0000a730: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
+0000a740: 6522 2073 7461 7274 732c 2077 6869 6368  e" starts, which
+0000a750: 206d 6561 6e73 2074 6861 7420 7468 6520   means that the 
+0000a760: 6d65 7468 6f64 2072 6574 7572 6e73 0a62  method returns.b
+0000a770: 6566 6f72 6520 7468 6520 7374 7265 616d  efore the stream
+0000a780: 696e 6720 7374 6172 7473 2c20 616e 6420  ing starts, and 
+0000a790: 736f 2074 6865 7265 2069 7320 6e6f 2063  so there is no c
+0000a7a0: 6861 6e63 6520 666f 7220 616e 7920 6465  hance for any de
+0000a7b0: 636f 7261 746f 7273 2074 6f20 6361 7463  corators to catc
+0000a7c0: 680a 616e 7920 636f 6e6e 6563 7469 6f6e  h.any connection
+0000a7d0: 2069 7373 7565 732e 0a0a 4e65 7665 7274   issues...Nevert
+0000a7e0: 6865 6c65 7373 2c20 6966 2079 6f75 2061  heless, if you a
+0000a7f0: 7265 2072 6561 6469 6e67 2061 2076 6572  re reading a ver
+0000a800: 7920 6c61 7267 6520 7374 7265 616d 2c20  y large stream, 
+0000a810: 7468 656e 2079 6f75 206d 6967 6874 2070  then you might p
+0000a820: 7265 6665 7220 746f 2063 616c 6c0a 6069  refer to call.`i
+0000a830: 7465 725f 7374 7265 616d 5f65 7665 6e74  ter_stream_event
+0000a840: 7328 2960 2c20 616e 6420 746f 2062 6567  s()`, and to beg
+0000a850: 696e 2069 7465 7261 7469 6e67 2074 6872  in iterating thr
+0000a860: 6f75 6768 2074 6865 2072 6563 6f72 6465  ough the recorde
+0000a870: 6420 6576 656e 7473 2077 6869 6c73 740a  d events whilst.
+0000a880: 7468 6579 2061 7265 2062 6569 6e67 2073  they are being s
+0000a890: 7472 6561 6d65 6420 6672 6f6d 2074 6865  treamed from the
+0000a8a0: 2073 6572 7665 722c 2072 6174 6865 7220   server, rather 
+0000a8b0: 7468 616e 2062 6f74 6820 7761 6974 696e  than both waitin
+0000a8c0: 6720 616e 6420 6861 7669 6e67 2074 6865  g and having the
+0000a8d0: 6d0a 616c 6c20 6163 6375 6d75 6c61 7465  m.all accumulate
+0000a8e0: 2069 6e20 6d65 6d6f 7279 2e20 4265 6361   in memory. Beca
+0000a8f0: 7573 6520 6f66 2074 6865 2072 6973 6b20  use of the risk 
+0000a900: 6f66 2063 6f6e 6e65 6374 696f 6e20 6973  of connection is
+0000a910: 7375 6573 2061 7269 7369 6e67 2064 7572  sues arising dur
+0000a920: 696e 670a 7468 6520 7374 7265 616d 696e  ing.the streamin
+0000a930: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
+0000a940: 656e 7473 2066 726f 6d20 7468 6520 7365  ents from the se
+0000a950: 7276 6572 2c20 796f 7520 7769 6c6c 206e  rver, you will n
+0000a960: 6565 6420 746f 2063 6172 6520 6162 6f75  eed to care abou
+0000a970: 740a 636f 6e6e 6563 7469 6f6e 2069 7373  t.connection iss
+0000a980: 7565 7320 7768 656e 2069 7465 7261 7469  ues when iterati
+0000a990: 6e67 206f 7665 7220 7468 6520 2272 6561  ng over the "rea
+0000a9a0: 6420 7265 7370 6f6e 7365 2220 6f62 6a65  d response" obje
+0000a9b0: 6374 2072 6574 7572 6e65 6420 6672 6f6d  ct returned from
+0000a9c0: 0a60 6974 6572 5f73 7472 6561 6d5f 6576  .`iter_stream_ev
+0000a9d0: 656e 7473 2829 602e 0a0a 2323 2320 4765  ents()`...### Ge
+0000a9e0: 7420 6375 7272 656e 7420 7665 7273 696f  t current versio
+0000a9f0: 6e0a 0a54 6865 2060 6765 745f 6375 7272  n..The `get_curr
+0000aa00: 656e 745f 7665 7273 696f 6e28 2960 206d  ent_version()` m
+0000aa10: 6574 686f 6420 6973 2061 2063 6f6e 7665  ethod is a conve
+0000aa20: 6e69 656e 6365 206d 6574 686f 6420 7468  nience method th
+0000aa30: 6174 2065 7373 656e 7469 616c 6c79 2063  at essentially c
+0000aa40: 616c 6c73 0a60 7265 6164 5f73 7472 6561  alls.`read_strea
+0000aa50: 6d5f 6576 656e 7473 2829 6020 7769 7468  m_events()` with
+0000aa60: 2060 6261 636b 7761 7264 733d 5472 7565   `backwards=True
+0000aa70: 6020 616e 6420 606c 696d 6974 3d31 602e  ` and `limit=1`.
+0000aa80: 2054 6869 7320 6d65 7468 6f64 2072 6574   This method ret
+0000aa90: 7572 6e73 0a74 6865 2076 616c 7565 206f  urns.the value o
+0000aaa0: 6620 7468 6520 6073 7472 6561 6d5f 706f  f the `stream_po
+0000aab0: 7369 7469 6f6e 6020 6174 7472 6962 7574  sition` attribut
+0000aac0: 6520 6f66 2074 6865 206c 6173 7420 7265  e of the last re
+0000aad0: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
+0000aae0: 610a 7374 7265 616d 2e20 4966 2061 2073  a.stream. If a s
+0000aaf0: 7472 6561 6d20 646f 6573 206e 6f74 2065  tream does not e
+0000ab00: 7869 7374 2c20 7468 6520 7265 7475 726e  xist, the return
+0000ab10: 6564 2076 616c 7565 2069 7320 604e 6f6e  ed value is `Non
+0000ab20: 6560 2e20 5468 6520 7265 7475 726e 6564  e`. The returned
+0000ab30: 0a76 616c 7565 2069 7320 7468 6520 636f  .value is the co
+0000ab40: 7272 6563 7420 7661 6c75 6520 6f66 2060  rrect value of `
+0000ab50: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
+0000ab60: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
+0000ab70: 6e65 7720 6576 656e 7473 2074 6f0a 6120  new events to.a 
+0000ab80: 7374 7265 616d 2e0a 0a54 6869 7320 6d65  stream...This me
+0000ab90: 7468 6f64 2068 6173 206f 6e65 2072 6571  thod has one req
+0000aba0: 7569 7265 6420 6172 6775 6d65 6e74 2c20  uired argument, 
+0000abb0: 6073 7472 6561 6d5f 6e61 6d65 602e 0a0a  `stream_name`...
+0000abc0: 5468 6520 7265 7175 6972 6564 2060 7374  The required `st
+0000abd0: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+0000abe0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0000abf0: 6073 7472 6020 7468 6174 2075 6e69 7175  `str` that uniqu
+0000ac00: 656c 7920 6964 656e 7469 6669 6573 2061  ely identifies a
+0000ac10: 0a73 7472 6561 6d20 6672 6f6d 2077 6869  .stream from whi
+0000ac20: 6368 2061 2073 7472 6561 6d20 706f 7369  ch a stream posi
+0000ac30: 7469 6f6e 2077 696c 6c20 6265 2072 6574  tion will be ret
+0000ac40: 7572 6e65 642e 0a0a 5468 6973 206d 6574  urned...This met
+0000ac50: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
+0000ac60: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+0000ac70: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
+0000ac80: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
+0000ac90: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+0000aca0: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+0000acb0: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
+0000acc0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+0000acd0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0000ace0: 7469 6f6e 2e0a 0a49 6e20 7468 6520 6578  tion...In the ex
+0000acf0: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
+0000ad00: 206c 6173 7420 7374 7265 616d 2070 6f73   last stream pos
+0000ad10: 6974 696f 6e20 6f66 2060 7374 7265 616d  ition of `stream
+0000ad20: 5f6e 616d 6531 6020 6973 206f 6274 6169  _name1` is obtai
+0000ad30: 6e65 642e 0a53 696e 6365 2074 6872 6565  ned..Since three
+0000ad40: 2065 7665 6e74 7320 6861 7665 2062 6565   events have bee
+0000ad50: 6e20 6170 7065 6e64 6564 2074 6f20 6073  n appended to `s
+0000ad60: 7472 6561 6d5f 6e61 6d65 3160 2c20 616e  tream_name1`, an
+0000ad70: 6420 6265 6361 7573 6520 706f 7369 7469  d because positi
+0000ad80: 6f6e 730a 696e 2061 2073 7472 6561 6d20  ons.in a stream 
+0000ad90: 6172 6520 7a65 726f 2d62 6173 6564 2061  are zero-based a
+0000ada0: 6e64 2067 6170 6c65 7373 2c20 736f 2074  nd gapless, so t
+0000adb0: 6865 2063 7572 7265 6e74 2076 6572 7369  he current versi
+0000adc0: 6f6e 2069 7320 6032 602e 0a0a 6060 6070  on is `2`...```p
+0000add0: 7974 686f 6e0a 6375 7272 656e 745f 7665  ython.current_ve
+0000ade0: 7273 696f 6e20 3d20 636c 6965 6e74 2e67  rsion = client.g
+0000adf0: 6574 5f63 7572 7265 6e74 5f76 6572 7369  et_current_versi
+0000ae00: 6f6e 280a 2020 2020 7374 7265 616d 5f6e  on(.    stream_n
+0000ae10: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+0000ae20: 0a29 0a0a 6173 7365 7274 2063 7572 7265  .)..assert curre
+0000ae30: 6e74 5f76 6572 7369 6f6e 203d 3d20 320a  nt_version == 2.
+0000ae40: 6060 600a 0a49 6620 6120 7374 7265 616d  ```..If a stream
+0000ae50: 2068 6173 206e 6576 6572 2065 7869 7374   has never exist
+0000ae60: 6564 206f 7220 6861 7320 6265 656e 2064  ed or has been d
+0000ae70: 656c 6574 6564 2c20 7468 6520 7265 7475  eleted, the retu
+0000ae80: 726e 6564 2076 616c 7565 2069 7320 604e  rned value is `N
+0000ae90: 6f6e 6560 2c0a 7768 6963 6820 6d61 7463  one`,.which matc
+0000aea0: 6865 7320 7468 6520 7265 7175 6972 6564  hes the required
+0000aeb0: 2076 616c 7565 206f 6620 7468 6520 6063   value of the `c
+0000aec0: 7572 7265 6e74 5f76 6572 7369 6f6e 6020  urrent_version` 
+0000aed0: 6172 6775 6d65 6e74 2062 6f74 6820 7768  argument both wh
+0000aee0: 656e 0a61 7070 656e 6469 6e67 2074 6865  en.appending the
+0000aef0: 2066 6972 7374 2065 7665 6e74 206f 6620   first event of 
+0000af00: 6120 6e65 7720 7374 7265 616d 2c20 616e  a new stream, an
+0000af10: 6420 616c 736f 2077 6865 6e20 6170 7065  d also when appe
+0000af20: 6e64 696e 6720 6576 656e 7473 2074 6f0a  nding events to.
+0000af30: 6120 7374 7265 616d 2074 6861 7420 6861  a stream that ha
+0000af40: 7320 6265 656e 2064 656c 6574 6564 2e0a  s been deleted..
+0000af50: 0a60 6060 7079 7468 6f6e 0a63 7572 7265  .```python.curre
+0000af60: 6e74 5f76 6572 7369 6f6e 203d 2063 6c69  nt_version = cli
+0000af70: 656e 742e 6765 745f 6375 7272 656e 745f  ent.get_current_
+0000af80: 7665 7273 696f 6e28 0a20 2020 2073 7472  version(.    str
+0000af90: 6561 6d5f 6e61 6d65 3d27 646f 6573 2d6e  eam_name='does-n
+0000afa0: 6f74 2d65 7869 7374 270a 290a 0a61 7373  ot-exist'.)..ass
+0000afb0: 6572 7420 6375 7272 656e 745f 7665 7273  ert current_vers
+0000afc0: 696f 6e20 6973 204e 6f6e 650a 6060 600a  ion is None.```.
+0000afd0: 0a23 2323 2048 6f77 2074 6f20 696d 706c  .### How to impl
+0000afe0: 656d 656e 7420 736e 6170 7368 6f74 7469  ement snapshotti
+0000aff0: 6e67 2077 6974 6820 4576 656e 7453 746f  ng with EventSto
+0000b000: 7265 4442 0a0a 536e 6170 7368 6f74 7320  reDB..Snapshots 
+0000b010: 6361 6e20 696d 7072 6f76 6520 7468 6520  can improve the 
+0000b020: 7065 7266 6f72 6d61 6e63 6520 6f66 2061  performance of a
+0000b030: 6767 7265 6761 7465 7320 7468 6174 2077  ggregates that w
+0000b040: 6f75 6c64 206f 7468 6572 7769 7365 2062  ould otherwise b
+0000b050: 650a 7265 636f 6e73 7472 7563 7465 6420  e.reconstructed 
+0000b060: 6672 6f6d 2076 6572 7920 6c6f 6e67 2073  from very long s
+0000b070: 7472 6561 6d73 2e20 486f 7765 7665 722c  treams. However,
+0000b080: 2069 7420 6973 2067 656e 6572 616c 6c79   it is generally
+0000b090: 2072 6563 6f6d 6d65 6e64 6564 2074 6f20   recommended to 
+0000b0a0: 6465 7369 676e 0a61 6767 7265 6761 7465  design.aggregate
+0000b0b0: 7320 746f 2068 6176 6520 6120 6669 6e69  s to have a fini
+0000b0c0: 7465 206c 6966 6563 7963 6c65 2c20 616e  te lifecycle, an
+0000b0d0: 6420 736f 2074 6f20 6861 7665 2072 656c  d so to have rel
+0000b0e0: 6174 6976 656c 7920 7368 6f72 7420 7374  atively short st
+0000b0f0: 7265 616d 732c 0a74 6865 7265 6279 2061  reams,.thereby a
+0000b100: 766f 6964 696e 6720 7468 6520 6e65 6564  voiding the need
+0000b110: 2066 6f72 2073 6e61 7073 686f 7474 696e   for snapshottin
+0000b120: 672e 2054 6869 7320 2268 6f77 2074 6f22  g. This "how to"
+0000b130: 2073 6563 7469 6f6e 2069 7320 696e 7465   section is inte
+0000b140: 6e64 6564 206d 6572 656c 790a 746f 2073  nded merely.to s
+0000b150: 686f 7720 686f 7720 736e 6170 7368 6f74  how how snapshot
+0000b160: 7469 6e67 206f 6620 6167 6772 6567 6174  ting of aggregat
+0000b170: 6573 2063 616e 2062 6520 696d 706c 656d  es can be implem
+0000b180: 656e 7465 6420 7769 7468 2045 7665 6e74  ented with Event
+0000b190: 5374 6f72 6544 4220 7573 696e 670a 7468  StoreDB using.th
+0000b1a0: 6973 2050 7974 686f 6e20 636c 6965 6e74  is Python client
+0000b1b0: 2e0a 0a45 7665 6e74 2d73 6f75 7263 6564  ...Event-sourced
+0000b1c0: 2061 6767 7265 6761 7465 7320 6172 6520   aggregates are 
+0000b1d0: 7479 7069 6361 6c6c 7920 7265 636f 6e73  typically recons
+0000b1e0: 7472 7563 7465 6420 6672 6f6d 2072 6563  tructed from rec
+0000b1f0: 6f72 6465 6420 6576 656e 7473 2062 7920  orded events by 
+0000b200: 6361 6c6c 696e 670a 6120 6d75 7461 746f  calling.a mutato
+0000b210: 7220 6675 6e63 7469 6f6e 2066 6f72 2065  r function for e
+0000b220: 6163 6820 7265 636f 7264 6564 2065 7665  ach recorded eve
+0000b230: 6e74 2c20 6576 6f6c 7669 6e67 2066 726f  nt, evolving fro
+0000b240: 6d20 616e 2069 6e69 7469 616c 2073 7461  m an initial sta
+0000b250: 7465 0a60 4e6f 6e65 6020 746f 2074 6865  te.`None` to the
+0000b260: 2063 7572 7265 6e74 2073 7461 7465 206f   current state o
+0000b270: 6620 7468 6520 6167 6772 6567 6174 652e  f the aggregate.
+0000b280: 2054 6865 2066 756e 6374 696f 6e20 6067   The function `g
+0000b290: 6574 5f61 6767 7265 6761 7465 2829 6020  et_aggregate()` 
+0000b2a0: 7368 6f77 730a 686f 7720 7468 6973 2063  shows.how this c
+0000b2b0: 616e 2062 6520 646f 6e65 2e20 5468 6520  an be done. The 
+0000b2c0: 6167 6772 6567 6174 6520 4944 2069 7320  aggregate ID is 
+0000b2d0: 7573 6564 2061 7320 6120 7374 7265 616d  used as a stream
+0000b2e0: 206e 616d 652e 2054 6865 2065 7863 6570   name. The excep
+0000b2f0: 7469 6f6e 0a60 4167 6772 6567 6174 654e  tion.`AggregateN
+0000b300: 6f74 466f 756e 6460 2069 7320 7261 6973  otFound` is rais
+0000b310: 6564 2069 6620 7468 6520 6167 6772 6567  ed if the aggreg
+0000b320: 6174 6520 7374 7265 616d 2069 7320 6e6f  ate stream is no
+0000b330: 7420 666f 756e 642e 0a0a 6060 6070 7974  t found...```pyt
+0000b340: 686f 6e0a 636c 6173 7320 4167 6772 6567  hon.class Aggreg
+0000b350: 6174 654e 6f74 466f 756e 6428 4578 6365  ateNotFound(Exce
+0000b360: 7074 696f 6e29 3a0a 2020 2020 2222 2252  ption):.    """R
+0000b370: 6169 7365 6420 7768 656e 2061 6e20 6167  aised when an ag
+0000b380: 6772 6567 6174 6520 6973 206e 6f74 2066  gregate is not f
+0000b390: 6f75 6e64 2e22 2222 0a0a 0a64 6566 2067  ound."""...def g
+0000b3a0: 6574 5f61 6767 7265 6761 7465 2861 6767  et_aggregate(agg
+0000b3b0: 7265 6761 7465 5f69 642c 206d 7574 6174  regate_id, mutat
+0000b3c0: 6f72 5f66 756e 6329 3a0a 2020 2020 7374  or_func):.    st
+0000b3d0: 7265 616d 5f6e 616d 6520 3d20 6167 6772  ream_name = aggr
+0000b3e0: 6567 6174 655f 6964 0a0a 2020 2020 2320  egate_id..    # 
+0000b3f0: 4765 7420 7265 636f 7264 6564 2065 7665  Get recorded eve
+0000b400: 6e74 732e 0a20 2020 2074 7279 3a0a 2020  nts..    try:.  
+0000b410: 2020 2020 2020 6576 656e 7473 203d 2063        events = c
+0000b420: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
+0000b430: 6d5f 6576 656e 7473 280a 2020 2020 2020  m_events(.      
+0000b440: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+0000b450: 653d 7374 7265 616d 5f6e 616d 652c 0a20  e=stream_name,. 
+0000b460: 2020 2020 2020 2020 2020 2073 7472 6561             strea
+0000b470: 6d5f 706f 7369 7469 6f6e 3d4e 6f6e 650a  m_position=None.
+0000b480: 2020 2020 2020 2020 290a 2020 2020 6578          ).    ex
+0000b490: 6365 7074 204e 6f74 466f 756e 6420 6173  cept NotFound as
+0000b4a0: 2065 3a0a 2020 2020 2020 2020 7261 6973   e:.        rais
+0000b4b0: 6520 4167 6772 6567 6174 654e 6f74 466f  e AggregateNotFo
+0000b4c0: 756e 6428 6167 6772 6567 6174 655f 6964  und(aggregate_id
+0000b4d0: 2920 6672 6f6d 2065 0a20 2020 2065 6c73  ) from e.    els
+0000b4e0: 653a 0a20 2020 2020 2020 2023 2052 6563  e:.        # Rec
+0000b4f0: 6f6e 7374 7275 6374 2061 6767 7265 6761  onstruct aggrega
+0000b500: 7465 2066 726f 6d20 7265 636f 7264 6564  te from recorded
+0000b510: 2065 7665 6e74 732e 0a20 2020 2020 2020   events..       
+0000b520: 2061 6767 7265 6761 7465 203d 204e 6f6e   aggregate = Non
+0000b530: 650a 2020 2020 2020 2020 666f 7220 6576  e.        for ev
+0000b540: 656e 7420 696e 2065 7665 6e74 733a 0a20  ent in events:. 
+0000b550: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+0000b560: 6761 7465 203d 206d 7574 6174 6f72 5f66  gate = mutator_f
+0000b570: 756e 6328 6167 6772 6567 6174 652c 2065  unc(aggregate, e
+0000b580: 7665 6e74 290a 2020 2020 2020 2020 7265  vent).        re
+0000b590: 7475 726e 2061 6767 7265 6761 7465 0a60  turn aggregate.`
+0000b5a0: 6060 0a0a 536e 6170 7368 6f74 7469 6e67  ``..Snapshotting
+0000b5b0: 206f 6620 6167 6772 6567 6174 6573 2063   of aggregates c
+0000b5c0: 616e 2062 6520 696d 706c 656d 656e 7465  an be implemente
+0000b5d0: 6420 6279 2072 6563 6f72 6469 6e67 2074  d by recording t
+0000b5e0: 6865 2063 7572 7265 6e74 2073 7461 7465  he current state
+0000b5f0: 206f 660a 616e 2061 6767 7265 6761 7465   of.an aggregate
+0000b600: 2061 7320 6120 6e65 7720 6576 656e 742e   as a new event.
+0000b610: 0a0a 4966 2061 6e20 6167 6772 6567 6174  ..If an aggregat
+0000b620: 6520 6f62 6a65 6374 2068 6173 2061 2076  e object has a v
+0000b630: 6572 7369 6f6e 206e 756d 6265 7220 7468  ersion number th
+0000b640: 6174 2063 6f72 7265 7370 6f6e 6473 2074  at corresponds t
+0000b650: 6f20 7468 6520 7374 7265 616d 2070 6f73  o the stream pos
+0000b660: 6974 696f 6e20 6f66 0a74 6865 206c 6173  ition of.the las
+0000b670: 7420 6576 656e 7420 7468 6174 2077 6173  t event that was
+0000b680: 2075 7365 6420 746f 2072 6563 6f6e 7374   used to reconst
+0000b690: 7275 6374 2074 6865 2061 6767 7265 6761  ruct the aggrega
+0000b6a0: 7465 2c20 616e 6420 7468 6973 2076 6572  te, and this ver
+0000b6b0: 7369 6f6e 206e 756d 6265 720a 6973 2072  sion number.is r
+0000b6c0: 6563 6f72 6465 6420 696e 2074 6865 2073  ecorded in the s
+0000b6d0: 6e61 7073 686f 7420 6d65 7461 6461 7461  napshot metadata
+0000b6e0: 2c20 7468 656e 2061 6e79 2065 7665 6e74  , then any event
+0000b6f0: 7320 7468 6174 2061 7265 2072 6563 6f72  s that are recor
+0000b700: 6465 6420 6166 7465 7220 7468 650a 736e  ded after the.sn
+0000b710: 6170 7368 6f74 2063 616e 2062 6520 7365  apshot can be se
+0000b720: 6c65 6374 6564 2075 7369 6e67 2074 6869  lected using thi
+0000b730: 7320 7665 7273 696f 6e20 6e75 6d62 6572  s version number
+0000b740: 2e20 5468 6520 6167 6772 6567 6174 6520  . The aggregate 
+0000b750: 6361 6e20 7468 656e 2062 650a 7265 636f  can then be.reco
+0000b760: 6e73 7472 7563 7465 6420 6672 6f6d 2074  nstructed from t
+0000b770: 6865 206c 6173 7420 736e 6170 7368 6f74  he last snapshot
+0000b780: 2061 6e64 2061 6e79 2073 7562 7365 7175   and any subsequ
+0000b790: 656e 7420 6576 656e 7473 2c20 7769 7468  ent events, with
+0000b7a0: 6f75 7420 6861 7669 6e67 0a74 6f20 7265  out having.to re
+0000b7b0: 706c 6179 2074 6865 2065 6e74 6972 6520  play the entire 
+0000b7c0: 6869 7374 6f72 792e 0a0a 5765 2077 696c  history...We wil
+0000b7d0: 6c20 7573 6520 6120 7365 7061 7261 7465  l use a separate
+0000b7e0: 2073 7472 6561 6d20 666f 7220 616e 2061   stream for an a
+0000b7f0: 6767 7265 6761 7465 2773 2073 6e61 7073  ggregate's snaps
+0000b800: 686f 7473 2074 6861 7420 6973 206e 616d  hots that is nam
+0000b810: 6564 2061 6674 6572 2074 6865 0a73 7472  ed after the.str
+0000b820: 6561 6d20 7573 6564 2066 6f72 2072 6563  eam used for rec
+0000b830: 6f72 6469 6e67 2069 7473 2065 7665 6e74  ording its event
+0000b840: 732e 2054 6865 206e 616d 6520 6f66 2074  s. The name of t
+0000b850: 6865 2073 6e61 7073 686f 7420 7374 7265  he snapshot stre
+0000b860: 616d 2077 696c 6c20 6265 0a63 6f6e 7374  am will be.const
+0000b870: 7275 6374 6564 2062 7920 7072 6566 6978  ructed by prefix
+0000b880: 696e 6720 7468 6520 6167 6772 6567 6174  ing the aggregat
+0000b890: 6527 7320 7374 7265 616d 206e 616d 6520  e's stream name 
+0000b8a0: 7769 7468 2060 2773 6e61 7073 686f 742d  with `'snapshot-
+0000b8b0: 2427 602e 0a0a 6060 6070 7974 686f 6e0a  $'`...```python.
+0000b8c0: 534e 4150 5348 4f54 5f53 5452 4541 4d5f  SNAPSHOT_STREAM_
+0000b8d0: 4e41 4d45 5f50 5245 4649 5820 3d20 2773  NAME_PREFIX = 's
+0000b8e0: 6e61 7073 686f 742d 2427 0a0a 6465 6620  napshot-$'..def 
+0000b8f0: 6d61 6b65 5f73 6e61 7073 686f 745f 7374  make_snapshot_st
+0000b900: 7265 616d 5f6e 616d 6528 7374 7265 616d  ream_name(stream
+0000b910: 5f6e 616d 6529 3a0a 2020 2020 7265 7475  _name):.    retu
+0000b920: 726e 2066 277b 534e 4150 5348 4f54 5f53  rn f'{SNAPSHOT_S
+0000b930: 5452 4541 4d5f 4e41 4d45 5f50 5245 4649  TREAM_NAME_PREFI
+0000b940: 587d 7b73 7472 6561 6d5f 6e61 6d65 7d27  X}{stream_name}'
+0000b950: 0a0a 0a64 6566 2072 656d 6f76 655f 736e  ...def remove_sn
+0000b960: 6170 7368 6f74 5f73 7472 6561 6d5f 7072  apshot_stream_pr
+0000b970: 6566 6978 2873 6e61 7073 686f 745f 7374  efix(snapshot_st
+0000b980: 7265 616d 5f6e 616d 6529 3a0a 2020 2020  ream_name):.    
+0000b990: 6173 7365 7274 2073 6e61 7073 686f 745f  assert snapshot_
+0000b9a0: 7374 7265 616d 5f6e 616d 652e 7374 6172  stream_name.star
+0000b9b0: 7473 7769 7468 2853 4e41 5053 484f 545f  tswith(SNAPSHOT_
+0000b9c0: 5354 5245 414d 5f4e 414d 455f 5052 4546  STREAM_NAME_PREF
+0000b9d0: 4958 290a 2020 2020 7265 7475 726e 2073  IX).    return s
+0000b9e0: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
+0000b9f0: 616d 655b 6c65 6e28 534e 4150 5348 4f54  ame[len(SNAPSHOT
+0000ba00: 5f53 5452 4541 4d5f 4e41 4d45 5f50 5245  _STREAM_NAME_PRE
+0000ba10: 4649 5829 3a5d 0a60 6060 0a0a 4e6f 772c  FIX):].```..Now,
+0000ba20: 206c 6574 2773 2072 6564 6566 696e 6520   let's redefine 
+0000ba30: 7468 6520 6067 6574 5f61 6767 7265 6761  the `get_aggrega
+0000ba40: 7465 2829 6020 6675 6e63 7469 6f6e 2c20  te()` function, 
+0000ba50: 736f 2074 6861 7420 6974 206c 6f6f 6b73  so that it looks
+0000ba60: 2066 6f72 2061 2073 6e61 7073 686f 7420   for a snapshot 
+0000ba70: 6576 656e 742c 0a74 6865 6e20 7365 6c65  event,.then sele
+0000ba80: 6374 7320 7375 6273 6571 7565 6e74 2061  cts subsequent a
+0000ba90: 6767 7265 6761 7465 2065 7665 6e74 732c  ggregate events,
+0000baa0: 2061 6e64 2074 6865 6e20 6361 6c6c 7320   and then calls 
+0000bab0: 6120 6d75 7461 746f 7220 6675 6e63 7469  a mutator functi
+0000bac0: 6f6e 2066 6f72 2065 6163 680a 7265 636f  on for each.reco
+0000bad0: 7264 6564 2065 7665 6e74 2e0a 0a4e 6f74  rded event...Not
+0000bae0: 6963 6520 7468 6174 2074 6865 2061 6767  ice that the agg
+0000baf0: 7265 6761 7465 2065 7665 6e74 7320 6172  regate events ar
+0000bb00: 6520 7265 6164 2066 726f 6d20 6120 7374  e read from a st
+0000bb10: 7265 616d 2066 6f72 2073 6572 6961 6c69  ream for seriali
+0000bb20: 7a65 6420 6167 6772 6567 6174 650a 6576  zed aggregate.ev
+0000bb30: 656e 7473 2c20 7768 696c 7374 2074 6865  ents, whilst the
+0000bb40: 2073 6e61 7073 686f 7420 6973 2072 6561   snapshot is rea
+0000bb50: 6420 6672 6f6d 2061 2073 6570 6172 6174  d from a separat
+0000bb60: 6520 7374 7265 616d 2066 6f72 2073 6572  e stream for ser
+0000bb70: 6961 6c69 7a65 6420 6167 6772 6567 6174  ialized aggregat
+0000bb80: 650a 736e 6170 7368 6f74 732e 2057 6520  e.snapshots. We 
+0000bb90: 7769 6c6c 2075 7365 204a 534f 4e20 746f  will use JSON to
+0000bba0: 2073 6572 6961 6c69 7a65 2061 6e64 2064   serialize and d
+0000bbb0: 6573 6572 6961 6c69 7a65 2065 7665 6e74  eserialize event
+0000bbc0: 2064 6174 612e 0a0a 0a60 6060 7079 7468   data....```pyth
+0000bbd0: 6f6e 0a69 6d70 6f72 7420 6a73 6f6e 0a0a  on.import json..
+0000bbe0: 0a64 6566 2067 6574 5f61 6767 7265 6761  .def get_aggrega
+0000bbf0: 7465 2861 6767 7265 6761 7465 5f69 642c  te(aggregate_id,
+0000bc00: 206d 7574 6174 6f72 5f66 756e 6329 3a0a   mutator_func):.
+0000bc10: 2020 2020 7374 7265 616d 5f6e 616d 6520      stream_name 
+0000bc20: 3d20 6167 6772 6567 6174 655f 6964 0a20  = aggregate_id. 
+0000bc30: 2020 2072 6563 6f72 6465 645f 6576 656e     recorded_even
+0000bc40: 7473 203d 205b 5d0a 0a20 2020 2023 204c  ts = []..    # L
+0000bc50: 6f6f 6b20 666f 7220 6120 736e 6170 7368  ook for a snapsh
+0000bc60: 6f74 2e0a 2020 2020 7472 793a 0a20 2020  ot..    try:.   
+0000bc70: 2020 2020 2073 6e61 7073 686f 7473 203d       snapshots =
+0000bc80: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+0000bc90: 6561 6d5f 6576 656e 7473 280a 2020 2020  eam_events(.    
+0000bca0: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+0000bcb0: 616d 653d 6d61 6b65 5f73 6e61 7073 686f  ame=make_snapsho
+0000bcc0: 745f 7374 7265 616d 5f6e 616d 6528 7374  t_stream_name(st
+0000bcd0: 7265 616d 5f6e 616d 6529 2c0a 2020 2020  ream_name),.    
+0000bce0: 2020 2020 2020 2020 6261 636b 7761 7264          backward
+0000bcf0: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
+0000bd00: 2020 2020 6c69 6d69 743d 310a 2020 2020      limit=1.    
+0000bd10: 2020 2020 290a 2020 2020 6578 6365 7074      ).    except
+0000bd20: 204e 6f74 466f 756e 643a 0a20 2020 2020   NotFound:.     
+0000bd30: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
+0000bd40: 6f6e 203d 204e 6f6e 650a 2020 2020 656c  on = None.    el
+0000bd50: 7365 3a0a 2020 2020 2020 2020 6173 7365  se:.        asse
+0000bd60: 7274 206c 656e 2873 6e61 7073 686f 7473  rt len(snapshots
+0000bd70: 2920 3d3d 2031 0a20 2020 2020 2020 2073  ) == 1.        s
+0000bd80: 6e61 7073 686f 7420 3d20 736e 6170 7368  napshot = snapsh
+0000bd90: 6f74 735b 305d 0a20 2020 2020 2020 2073  ots[0].        s
+0000bda0: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+0000bdb0: 2064 6573 6572 6961 6c69 7a65 2873 6e61   deserialize(sna
+0000bdc0: 7073 686f 742e 6d65 7461 6461 7461 295b  pshot.metadata)[
+0000bdd0: 2776 6572 7369 6f6e 275d 202b 2031 0a20  'version'] + 1. 
+0000bde0: 2020 2020 2020 2072 6563 6f72 6465 645f         recorded_
+0000bdf0: 6576 656e 7473 2e61 7070 656e 6428 736e  events.append(sn
+0000be00: 6170 7368 6f74 290a 0a20 2020 2023 2047  apshot)..    # G
+0000be10: 6574 2073 7562 7365 7175 656e 7420 6576  et subsequent ev
+0000be20: 656e 7473 2e0a 2020 2020 7472 793a 0a20  ents..    try:. 
+0000be30: 2020 2020 2020 2065 7665 6e74 7320 3d20         events = 
+0000be40: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
+0000be50: 616d 5f65 7665 6e74 7328 0a20 2020 2020  am_events(.     
+0000be60: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+0000be70: 6d65 3d73 7472 6561 6d5f 6e61 6d65 2c0a  me=stream_name,.
+0000be80: 2020 2020 2020 2020 2020 2020 7374 7265              stre
+0000be90: 616d 5f70 6f73 6974 696f 6e3d 7374 7265  am_position=stre
+0000bea0: 616d 5f70 6f73 6974 696f 6e0a 2020 2020  am_position.    
+0000beb0: 2020 2020 290a 2020 2020 6578 6365 7074      ).    except
+0000bec0: 204e 6f74 466f 756e 6420 6173 2065 3a0a   NotFound as e:.
+0000bed0: 2020 2020 2020 2020 7261 6973 6520 4167          raise Ag
+0000bee0: 6772 6567 6174 654e 6f74 466f 756e 6428  gregateNotFound(
+0000bef0: 6167 6772 6567 6174 655f 6964 2920 6672  aggregate_id) fr
+0000bf00: 6f6d 2065 0a20 2020 2065 6c73 653a 0a20  om e.    else:. 
+0000bf10: 2020 2020 2020 2072 6563 6f72 6465 645f         recorded_
+0000bf20: 6576 656e 7473 202b 3d20 6576 656e 7473  events += events
+0000bf30: 0a0a 2020 2020 2320 5265 636f 6e73 7472  ..    # Reconstr
+0000bf40: 7563 7420 6167 6772 6567 6174 6520 6672  uct aggregate fr
+0000bf50: 6f6d 2072 6563 6f72 6465 6420 6576 656e  om recorded even
+0000bf60: 7473 2e0a 2020 2020 6167 6772 6567 6174  ts..    aggregat
+0000bf70: 6520 3d20 4e6f 6e65 0a20 2020 2066 6f72  e = None.    for
+0000bf80: 2065 7665 6e74 2069 6e20 7265 636f 7264   event in record
+0000bf90: 6564 5f65 7665 6e74 733a 0a20 2020 2020  ed_events:.     
+0000bfa0: 2020 2061 6767 7265 6761 7465 203d 206d     aggregate = m
+0000bfb0: 7574 6174 6f72 5f66 756e 6328 6167 6772  utator_func(aggr
+0000bfc0: 6567 6174 652c 2065 7665 6e74 290a 0a20  egate, event).. 
+0000bfd0: 2020 2072 6574 7572 6e20 6167 6772 6567     return aggreg
+0000bfe0: 6174 650a 0a0a 6465 6620 7365 7269 616c  ate...def serial
+0000bff0: 697a 6528 6429 3a0a 2020 2020 7265 7475  ize(d):.    retu
+0000c000: 726e 206a 736f 6e2e 6475 6d70 7328 6429  rn json.dumps(d)
+0000c010: 2e65 6e63 6f64 6528 2775 7466 3827 290a  .encode('utf8').
+0000c020: 0a0a 6465 6620 6465 7365 7269 616c 697a  ..def deserializ
+0000c030: 6528 7329 3a0a 2020 2020 7265 7475 726e  e(s):.    return
+0000c040: 206a 736f 6e2e 6c6f 6164 7328 732e 6465   json.loads(s.de
+0000c050: 636f 6465 2827 7574 6638 2729 290a 6060  code('utf8')).``
+0000c060: 600a 0a54 6f20 7368 6f77 2068 6f77 2060  `..To show how `
+0000c070: 6765 745f 6167 6772 6567 6174 6528 2960  get_aggregate()`
+0000c080: 2063 616e 2062 6520 7573 6564 2c20 6c65   can be used, le
+0000c090: 7427 7320 6465 6669 6e65 2061 2060 446f  t's define a `Do
+0000c0a0: 6760 2061 6767 7265 6761 7465 2063 6c61  g` aggregate cla
+0000c0b0: 7373 2c20 7769 7468 0a61 7474 7269 6275  ss, with.attribu
+0000c0c0: 7465 7320 606e 616d 6560 2061 6e64 2060  tes `name` and `
+0000c0d0: 7472 6963 6b73 602e 2054 6865 2061 7474  tricks`. The att
+0000c0e0: 7269 6275 7465 7320 6069 6460 2061 6e64  ributes `id` and
+0000c0f0: 2060 7665 7273 696f 6e60 2077 696c 6c20   `version` will 
+0000c100: 696e 6469 6361 7465 2061 6e0a 6167 6772  indicate an.aggr
+0000c110: 6567 6174 6520 6f62 6a65 6374 2773 2049  egate object's I
+0000c120: 4420 616e 6420 7665 7273 696f 6e20 6e75  D and version nu
+0000c130: 6d62 6572 2e20 5468 6520 6174 7472 6962  mber. The attrib
+0000c140: 7574 6520 6069 735f 6672 6f6d 5f73 6e61  ute `is_from_sna
+0000c150: 7073 686f 7460 2069 7320 6164 6465 640a  pshot` is added.
+0000c160: 6865 7265 206d 6572 656c 7920 746f 2064  here merely to d
+0000c170: 656d 6f6e 7374 7261 7465 2062 656c 6f77  emonstrate below
+0000c180: 2077 6865 6e20 616e 2061 6767 7265 6761   when an aggrega
+0000c190: 7465 206f 626a 6563 7420 6861 7320 6265  te object has be
+0000c1a0: 656e 2072 6563 6f6e 7374 7275 6374 6564  en reconstructed
+0000c1b0: 2075 7369 6e67 0a61 2073 6e61 7073 686f   using.a snapsho
+0000c1c0: 742e 0a0a 6060 6070 7974 686f 6e0a 6672  t...```python.fr
+0000c1d0: 6f6d 2064 6174 6163 6c61 7373 6573 2069  om dataclasses i
+0000c1e0: 6d70 6f72 7420 6461 7461 636c 6173 730a  mport dataclass.
+0000c1f0: 0a0a 4064 6174 6163 6c61 7373 2866 726f  ..@dataclass(fro
+0000c200: 7a65 6e3d 5472 7565 290a 636c 6173 7320  zen=True).class 
+0000c210: 4167 6772 6567 6174 653a 0a20 2020 2069  Aggregate:.    i
+0000c220: 643a 2073 7472 0a20 2020 2076 6572 7369  d: str.    versi
+0000c230: 6f6e 3a20 696e 740a 2020 2020 6973 5f66  on: int.    is_f
+0000c240: 726f 6d5f 736e 6170 7368 6f74 3a20 626f  rom_snapshot: bo
+0000c250: 6f6c 0a0a 0a40 6461 7461 636c 6173 7328  ol...@dataclass(
+0000c260: 6672 6f7a 656e 3d54 7275 6529 0a63 6c61  frozen=True).cla
+0000c270: 7373 2044 6f67 2841 6767 7265 6761 7465  ss Dog(Aggregate
+0000c280: 293a 0a20 2020 206e 616d 653a 2073 7472  ):.    name: str
+0000c290: 0a20 2020 2074 7269 636b 733a 206c 6973  .    tricks: lis
+0000c2a0: 740a 6060 600a 0a4c 6574 2773 2061 6c73  t.```..Let's als
+0000c2b0: 6f20 6465 6669 6e65 2061 206d 7574 6174  o define a mutat
+0000c2c0: 6f72 2066 756e 6374 696f 6e20 606d 7574  or function `mut
+0000c2d0: 6174 655f 646f 6728 2960 2074 6861 7420  ate_dog()` that 
+0000c2e0: 6361 6e20 6576 6f6c 7665 2074 6865 2073  can evolve the s
+0000c2f0: 7461 7465 206f 6620 610a 6044 6f67 6020  tate of a.`Dog` 
+0000c300: 6167 6772 6567 6174 6520 6769 7665 6e20  aggregate given 
+0000c310: 7661 7269 6f75 7320 6469 6666 6572 656e  various differen
+0000c320: 7420 7479 7065 7320 6f66 2065 7665 6e74  t types of event
+0000c330: 732c 2060 2744 6f67 5265 6769 7374 6572  s, `'DogRegister
+0000c340: 6564 2760 2c0a 6027 446f 674c 6561 726e  ed'`,.`'DogLearn
+0000c350: 6564 5472 6963 6b27 602c 2061 6e64 2060  edTrick'`, and `
+0000c360: 2753 6e61 7073 686f 7427 602e 0a0a 6060  'Snapshot'`...``
+0000c370: 6070 7974 686f 6e0a 6465 6620 6d75 7461  `python.def muta
+0000c380: 7465 5f64 6f67 2864 6f67 2c20 6576 656e  te_dog(dog, even
+0000c390: 7429 3a0a 2020 2020 6461 7461 203d 2064  t):.    data = d
+0000c3a0: 6573 6572 6961 6c69 7a65 2865 7665 6e74  eserialize(event
+0000c3b0: 2e64 6174 6129 0a20 2020 2069 6620 6576  .data).    if ev
+0000c3c0: 656e 742e 7479 7065 203d 3d20 2744 6f67  ent.type == 'Dog
+0000c3d0: 5265 6769 7374 6572 6564 273a 0a20 2020  Registered':.   
+0000c3e0: 2020 2020 2072 6574 7572 6e20 446f 6728       return Dog(
+0000c3f0: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
+0000c400: 6576 656e 742e 7374 7265 616d 5f6e 616d  event.stream_nam
+0000c410: 652c 0a20 2020 2020 2020 2020 2020 2076  e,.            v
+0000c420: 6572 7369 6f6e 3d65 7665 6e74 2e73 7472  ersion=event.str
+0000c430: 6561 6d5f 706f 7369 7469 6f6e 2c0a 2020  eam_position,.  
+0000c440: 2020 2020 2020 2020 2020 6973 5f66 726f            is_fro
+0000c450: 6d5f 736e 6170 7368 6f74 3d46 616c 7365  m_snapshot=False
+0000c460: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+0000c470: 6d65 3d64 6174 615b 276e 616d 6527 5d2c  me=data['name'],
+0000c480: 0a20 2020 2020 2020 2020 2020 2074 7269  .            tri
+0000c490: 636b 733d 5b5d 2c0a 2020 2020 2020 2020  cks=[],.        
+0000c4a0: 290a 2020 2020 656c 6966 2065 7665 6e74  ).    elif event
+0000c4b0: 2e74 7970 6520 3d3d 2027 446f 674c 6561  .type == 'DogLea
+0000c4c0: 726e 6564 5472 6963 6b27 3a0a 2020 2020  rnedTrick':.    
+0000c4d0: 2020 2020 6173 7365 7274 2065 7665 6e74      assert event
+0000c4e0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000c4f0: 203d 3d20 646f 672e 7665 7273 696f 6e20   == dog.version 
+0000c500: 2b20 310a 2020 2020 2020 2020 6173 7365  + 1.        asse
+0000c510: 7274 2065 7665 6e74 2e73 7472 6561 6d5f  rt event.stream_
+0000c520: 6e61 6d65 203d 3d20 646f 672e 6964 2c20  name == dog.id, 
+0000c530: 2865 7665 6e74 2e73 7472 6561 6d5f 6e61  (event.stream_na
+0000c540: 6d65 2c20 646f 672e 6964 290a 2020 2020  me, dog.id).    
+0000c550: 2020 2020 7265 7475 726e 2044 6f67 280a      return Dog(.
+0000c560: 2020 2020 2020 2020 2020 2020 6964 3d64              id=d
+0000c570: 6f67 2e69 642c 0a20 2020 2020 2020 2020  og.id,.         
+0000c580: 2020 2076 6572 7369 6f6e 3d65 7665 6e74     version=event
+0000c590: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000c5a0: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
+0000c5b0: 5f66 726f 6d5f 736e 6170 7368 6f74 3d64  _from_snapshot=d
+0000c5c0: 6f67 2e69 735f 6672 6f6d 5f73 6e61 7073  og.is_from_snaps
+0000c5d0: 686f 742c 0a20 2020 2020 2020 2020 2020  hot,.           
+0000c5e0: 206e 616d 653d 646f 672e 6e61 6d65 2c0a   name=dog.name,.
+0000c5f0: 2020 2020 2020 2020 2020 2020 7472 6963              tric
+0000c600: 6b73 3d64 6f67 2e74 7269 636b 7320 2b20  ks=dog.tricks + 
+0000c610: 5b64 6174 615b 2774 7269 636b 275d 5d2c  [data['trick']],
+0000c620: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
+0000c630: 6c69 6620 6576 656e 742e 7479 7065 203d  lif event.type =
+0000c640: 3d20 2753 6e61 7073 686f 7427 3a0a 2020  = 'Snapshot':.  
+0000c650: 2020 2020 2020 7265 7475 726e 2044 6f67        return Dog
+0000c660: 280a 2020 2020 2020 2020 2020 2020 6964  (.            id
+0000c670: 3d72 656d 6f76 655f 736e 6170 7368 6f74  =remove_snapshot
+0000c680: 5f73 7472 6561 6d5f 7072 6566 6978 2865  _stream_prefix(e
+0000c690: 7665 6e74 2e73 7472 6561 6d5f 6e61 6d65  vent.stream_name
+0000c6a0: 292c 0a20 2020 2020 2020 2020 2020 2076  ),.            v
+0000c6b0: 6572 7369 6f6e 3d64 6573 6572 6961 6c69  ersion=deseriali
+0000c6c0: 7a65 2865 7665 6e74 2e6d 6574 6164 6174  ze(event.metadat
+0000c6d0: 6129 5b27 7665 7273 696f 6e27 5d2c 0a20  a)['version'],. 
+0000c6e0: 2020 2020 2020 2020 2020 2069 735f 6672             is_fr
+0000c6f0: 6f6d 5f73 6e61 7073 686f 743d 5472 7565  om_snapshot=True
+0000c700: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+0000c710: 6d65 3d64 6174 615b 276e 616d 6527 5d2c  me=data['name'],
+0000c720: 0a20 2020 2020 2020 2020 2020 2074 7269  .            tri
+0000c730: 636b 733d 6461 7461 5b27 7472 6963 6b73  cks=data['tricks
+0000c740: 275d 2c0a 2020 2020 2020 2020 290a 2020  '],.        ).  
+0000c750: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000c760: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
+0000c770: 6622 556e 6b6e 6f77 6e20 6576 656e 7420  f"Unknown event 
+0000c780: 7479 7065 3a20 7b65 7665 6e74 2e74 7970  type: {event.typ
+0000c790: 657d 2229 0a60 6060 0a0a 466f 7220 636f  e}").```..For co
+0000c7a0: 6e76 656e 6965 6e63 652c 206c 6574 2773  nvenience, let's
+0000c7b0: 2061 6c73 6f20 6465 6669 6e65 2061 2060   also define a `
+0000c7c0: 6765 745f 646f 6728 2960 2066 756e 6374  get_dog()` funct
+0000c7d0: 696f 6e20 7468 6174 2063 616c 6c73 2060  ion that calls `
+0000c7e0: 6765 745f 6167 6772 6567 6174 6528 2960  get_aggregate()`
+0000c7f0: 0a77 6974 6820 7468 6520 606d 7574 6174  .with the `mutat
+0000c800: 655f 646f 6728 2960 2066 756e 6374 696f  e_dog()` functio
+0000c810: 6e20 6173 2074 6865 2076 616c 7565 206f  n as the value o
+0000c820: 6620 6974 7320 606d 7574 6174 6f72 5f66  f its `mutator_f
+0000c830: 756e 6360 2061 7267 756d 656e 742e 0a0a  unc` argument...
+0000c840: 6060 6070 7974 686f 6e0a 6465 6620 6765  ```python.def ge
+0000c850: 745f 646f 6728 646f 675f 6964 293a 0a20  t_dog(dog_id):. 
+0000c860: 2020 2072 6574 7572 6e20 6765 745f 6167     return get_ag
+0000c870: 6772 6567 6174 6528 0a20 2020 2020 2020  gregate(.       
+0000c880: 2061 6767 7265 6761 7465 5f69 643d 646f   aggregate_id=do
+0000c890: 675f 6964 2c0a 2020 2020 2020 2020 6d75  g_id,.        mu
+0000c8a0: 7461 746f 725f 6675 6e63 3d6d 7574 6174  tator_func=mutat
+0000c8b0: 655f 646f 672c 0a20 2020 2029 0a60 6060  e_dog,.    ).```
+0000c8c0: 0a0a 5765 2063 616e 2061 6c73 6f20 6465  ..We can also de
+0000c8d0: 6669 6e65 2073 6f6d 6520 2263 6f6d 6d61  fine some "comma
+0000c8e0: 6e64 2220 6675 6e63 7469 6f6e 7320 7468  nd" functions th
+0000c8f0: 6174 2061 7070 656e 6420 6e65 7720 6576  at append new ev
+0000c900: 656e 7473 2074 6f20 7468 650a 6461 7461  ents to the.data
+0000c910: 6261 7365 2e20 5468 6520 6072 6567 6973  base. The `regis
+0000c920: 7465 725f 646f 6728 2960 2066 756e 6374  ter_dog()` funct
+0000c930: 696f 6e20 6170 7065 6e64 7320 6120 6044  ion appends a `D
+0000c940: 6f67 5265 6769 7374 6572 6564 6020 6576  ogRegistered` ev
+0000c950: 656e 742e 2054 6865 0a60 7265 636f 7264  ent. The.`record
+0000c960: 5f74 7269 636b 5f6c 6561 726e 6564 2829  _trick_learned()
+0000c970: 6020 6170 7065 6e64 7320 6120 6044 6f67  ` appends a `Dog
+0000c980: 4c65 6172 6e65 6454 7269 636b 6020 6576  LearnedTrick` ev
+0000c990: 656e 742e 2054 6865 2066 756e 6374 696f  ent. The functio
+0000c9a0: 6e0a 6073 6e61 7073 686f 745f 646f 6728  n.`snapshot_dog(
+0000c9b0: 2960 2061 7070 656e 6473 2061 2060 536e  )` appends a `Sn
+0000c9c0: 6170 7368 6f74 6020 6576 656e 742e 204e  apshot` event. N
+0000c9d0: 6f74 6963 6520 7468 6174 2074 6865 0a60  otice that the.`
+0000c9e0: 7265 636f 7264 5f74 7269 636b 5f6c 6561  record_trick_lea
+0000c9f0: 726e 6564 2829 6020 616e 6420 6073 6e61  rned()` and `sna
+0000ca00: 7073 686f 745f 646f 6728 2960 2066 756e  pshot_dog()` fun
+0000ca10: 6374 696f 6e73 2075 7365 2060 6765 745f  ctions use `get_
+0000ca20: 646f 6728 2960 2e0a 0a4e 6f74 6963 6520  dog()`...Notice 
+0000ca30: 616c 736f 2074 6861 7420 7468 6520 6044  also that the `D
+0000ca40: 6f67 5265 6769 7374 6572 6564 6020 616e  ogRegistered` an
+0000ca50: 6420 6044 6f67 4c65 6172 6e65 6454 7269  d `DogLearnedTri
+0000ca60: 636b 6020 6576 656e 7473 2061 7265 2061  ck` events are a
+0000ca70: 7070 656e 6465 6420 746f 2061 0a73 7472  ppended to a.str
+0000ca80: 6561 6d20 666f 7220 6167 6772 6567 6174  eam for aggregat
+0000ca90: 6520 6576 656e 7473 2c20 7768 696c 7374  e events, whilst
+0000caa0: 2074 6865 2060 536e 6170 7368 6f74 6020   the `Snapshot` 
+0000cab0: 6576 656e 7420 6973 2061 7070 656e 6465  event is appende
+0000cac0: 6420 746f 2061 2073 6570 6172 6174 650a  d to a separate.
+0000cad0: 7374 7265 616d 2066 6f72 2061 6767 7265  stream for aggre
+0000cae0: 6761 7465 2073 6e61 7073 686f 7473 2e0a  gate snapshots..
+0000caf0: 0a60 6060 7079 7468 6f6e 0a64 6566 2072  .```python.def r
+0000cb00: 6567 6973 7465 725f 646f 6728 6e61 6d65  egister_dog(name
+0000cb10: 293a 0a20 2020 2064 6f67 5f69 6420 3d20  ):.    dog_id = 
+0000cb20: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
+0000cb30: 290a 2020 2020 6576 656e 7420 3d20 4e65  ).    event = Ne
+0000cb40: 7745 7665 6e74 280a 2020 2020 2020 2020  wEvent(.        
+0000cb50: 7479 7065 3d27 446f 6752 6567 6973 7465  type='DogRegiste
+0000cb60: 7265 6427 2c0a 2020 2020 2020 2020 6461  red',.        da
+0000cb70: 7461 3d73 6572 6961 6c69 7a65 287b 276e  ta=serialize({'n
+0000cb80: 616d 6527 3a20 6e61 6d65 7d29 2c0a 2020  ame': name}),.  
+0000cb90: 2020 290a 2020 2020 636c 6965 6e74 2e61    ).    client.a
+0000cba0: 7070 656e 645f 6576 656e 7428 0a20 2020  ppend_event(.   
+0000cbb0: 2020 2020 2073 7472 6561 6d5f 6e61 6d65       stream_name
+0000cbc0: 3d64 6f67 5f69 642c 0a20 2020 2020 2020  =dog_id,.       
+0000cbd0: 2063 7572 7265 6e74 5f76 6572 7369 6f6e   current_version
+0000cbe0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2065  =None,.        e
+0000cbf0: 7665 6e74 3d65 7665 6e74 2c0a 2020 2020  vent=event,.    
+0000cc00: 290a 2020 2020 7265 7475 726e 2064 6f67  ).    return dog
+0000cc10: 5f69 640a 0a0a 6465 6620 7265 636f 7264  _id...def record
+0000cc20: 5f74 7269 636b 5f6c 6561 726e 6564 2864  _trick_learned(d
+0000cc30: 6f67 5f69 642c 2074 7269 636b 293a 0a20  og_id, trick):. 
+0000cc40: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
+0000cc50: 2864 6f67 5f69 6429 0a20 2020 2065 7665  (dog_id).    eve
+0000cc60: 6e74 203d 204e 6577 4576 656e 7428 0a20  nt = NewEvent(. 
+0000cc70: 2020 2020 2020 2074 7970 653d 2744 6f67         type='Dog
+0000cc80: 4c65 6172 6e65 6454 7269 636b 272c 0a20  LearnedTrick',. 
+0000cc90: 2020 2020 2020 2064 6174 613d 7365 7269         data=seri
+0000cca0: 616c 697a 6528 7b27 7472 6963 6b27 3a20  alize({'trick': 
+0000ccb0: 7472 6963 6b7d 292c 0a20 2020 2029 0a20  trick}),.    ). 
+0000ccc0: 2020 2063 6c69 656e 742e 6170 7065 6e64     client.append
+0000ccd0: 5f65 7665 6e74 280a 2020 2020 2020 2020  _event(.        
+0000cce0: 7374 7265 616d 5f6e 616d 653d 646f 675f  stream_name=dog_
+0000ccf0: 6964 2c0a 2020 2020 2020 2020 6375 7272  id,.        curr
+0000cd00: 656e 745f 7665 7273 696f 6e3d 646f 672e  ent_version=dog.
+0000cd10: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0000cd20: 2065 7665 6e74 3d65 7665 6e74 2c0a 2020   event=event,.  
+0000cd30: 2020 290a 0a0a 6465 6620 736e 6170 7368    )...def snapsh
+0000cd40: 6f74 5f64 6f67 2864 6f67 5f69 6429 3a0a  ot_dog(dog_id):.
+0000cd50: 2020 2020 646f 6720 3d20 6765 745f 646f      dog = get_do
+0000cd60: 6728 646f 675f 6964 290a 2020 2020 6576  g(dog_id).    ev
+0000cd70: 656e 7420 3d20 4e65 7745 7665 6e74 280a  ent = NewEvent(.
+0000cd80: 2020 2020 2020 2020 7479 7065 3d27 536e          type='Sn
+0000cd90: 6170 7368 6f74 272c 0a20 2020 2020 2020  apshot',.       
+0000cda0: 2064 6174 613d 7365 7269 616c 697a 6528   data=serialize(
+0000cdb0: 7b27 6e61 6d65 273a 2064 6f67 2e6e 616d  {'name': dog.nam
+0000cdc0: 652c 2027 7472 6963 6b73 273a 2064 6f67  e, 'tricks': dog
+0000cdd0: 2e74 7269 636b 737d 292c 0a20 2020 2020  .tricks}),.     
+0000cde0: 2020 206d 6574 6164 6174 613d 7365 7269     metadata=seri
+0000cdf0: 616c 697a 6528 7b27 7665 7273 696f 6e27  alize({'version'
+0000ce00: 3a20 646f 672e 7665 7273 696f 6e7d 292c  : dog.version}),
+0000ce10: 0a20 2020 2029 0a20 2020 2063 6c69 656e  .    ).    clien
+0000ce20: 742e 6170 7065 6e64 5f65 7665 6e74 280a  t.append_event(.
+0000ce30: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+0000ce40: 616d 653d 6d61 6b65 5f73 6e61 7073 686f  ame=make_snapsho
+0000ce50: 745f 7374 7265 616d 5f6e 616d 6528 646f  t_stream_name(do
+0000ce60: 675f 6964 292c 0a20 2020 2020 2020 2063  g_id),.        c
+0000ce70: 7572 7265 6e74 5f76 6572 7369 6f6e 3d2d  urrent_version=-
+0000ce80: 312c 0a20 2020 2020 2020 2065 7665 6e74  1,.        event
+0000ce90: 3d65 7665 6e74 2c0a 2020 2020 290a 6060  =event,.    ).``
+0000cea0: 600a 0a57 6520 6361 6e20 6361 6c6c 2060  `..We can call `
+0000ceb0: 7265 6769 7374 6572 5f64 6f67 2829 6020  register_dog()` 
+0000cec0: 746f 2072 6567 6973 7465 7220 6120 6e65  to register a ne
+0000ced0: 7720 646f 672e 0a0a 6060 6070 7974 686f  w dog...```pytho
+0000cee0: 6e0a 2320 5265 6769 7374 6572 2061 206e  n.# Register a n
+0000cef0: 6577 2064 6f67 2e0a 646f 675f 6964 203d  ew dog..dog_id =
+0000cf00: 2072 6567 6973 7465 725f 646f 6728 2746   register_dog('F
+0000cf10: 6964 6f27 290a 0a64 6f67 203d 2067 6574  ido')..dog = get
+0000cf20: 5f64 6f67 2864 6f67 5f69 6429 0a61 7373  _dog(dog_id).ass
+0000cf30: 6572 7420 646f 672e 6e61 6d65 203d 3d20  ert dog.name == 
+0000cf40: 2746 6964 6f27 0a61 7373 6572 7420 646f  'Fido'.assert do
+0000cf50: 672e 7472 6963 6b73 203d 3d20 5b5d 0a61  g.tricks == [].a
+0000cf60: 7373 6572 7420 646f 672e 7665 7273 696f  ssert dog.versio
+0000cf70: 6e20 3d3d 2030 0a61 7373 6572 7420 646f  n == 0.assert do
+0000cf80: 672e 6973 5f66 726f 6d5f 736e 6170 7368  g.is_from_snapsh
+0000cf90: 6f74 2069 7320 4661 6c73 650a 0a60 6060  ot is False..```
+0000cfa0: 0a0a 5765 2063 616e 2063 616c 6c20 6072  ..We can call `r
+0000cfb0: 6563 6f72 645f 7472 6963 6b5f 6c65 6172  ecord_trick_lear
+0000cfc0: 6e65 6428 2960 2074 6f20 7265 636f 7264  ned()` to record
+0000cfd0: 2074 6861 7420 736f 6d65 2074 7269 636b   that some trick
+0000cfe0: 7320 6861 7665 2062 6565 6e20 6c65 6172  s have been lear
+0000cff0: 6e65 642e 0a0a 6060 6070 7974 686f 6e0a  ned...```python.
+0000d000: 0a23 2052 6563 6f72 6420 7468 6174 2027  .# Record that '
+0000d010: 4669 646f 2720 6c65 6172 6e65 6420 6120  Fido' learned a 
+0000d020: 6e65 7720 7472 6963 6b2e 0a72 6563 6f72  new trick..recor
+0000d030: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+0000d040: 646f 675f 6964 2c20 7472 6963 6b3d 2772  dog_id, trick='r
+0000d050: 6f6c 6c20 6f76 6572 2729 0a0a 646f 6720  oll over')..dog 
+0000d060: 3d20 6765 745f 646f 6728 646f 675f 6964  = get_dog(dog_id
+0000d070: 290a 6173 7365 7274 2064 6f67 2e6e 616d  ).assert dog.nam
+0000d080: 6520 3d3d 2027 4669 646f 270a 6173 7365  e == 'Fido'.asse
+0000d090: 7274 2064 6f67 2e74 7269 636b 7320 3d3d  rt dog.tricks ==
+0000d0a0: 205b 2772 6f6c 6c20 6f76 6572 275d 0a61   ['roll over'].a
+0000d0b0: 7373 6572 7420 646f 672e 7665 7273 696f  ssert dog.versio
+0000d0c0: 6e20 3d3d 2031 0a61 7373 6572 7420 646f  n == 1.assert do
+0000d0d0: 672e 6973 5f66 726f 6d5f 736e 6170 7368  g.is_from_snapsh
+0000d0e0: 6f74 2069 7320 4661 6c73 650a 0a0a 2320  ot is False...# 
+0000d0f0: 5265 636f 7264 2074 6861 7420 2746 6964  Record that 'Fid
+0000d100: 6f27 206c 6561 726e 6564 2061 6e6f 7468  o' learned anoth
+0000d110: 6572 206e 6577 2074 7269 636b 2e0a 7265  er new trick..re
+0000d120: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
+0000d130: 6564 2864 6f67 5f69 642c 2074 7269 636b  ed(dog_id, trick
+0000d140: 3d27 6665 7463 6820 6261 6c6c 2729 0a0a  ='fetch ball')..
+0000d150: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000d160: 675f 6964 290a 6173 7365 7274 2064 6f67  g_id).assert dog
+0000d170: 2e6e 616d 6520 3d3d 2027 4669 646f 270a  .name == 'Fido'.
+0000d180: 6173 7365 7274 2064 6f67 2e74 7269 636b  assert dog.trick
+0000d190: 7320 3d3d 205b 2772 6f6c 6c20 6f76 6572  s == ['roll over
+0000d1a0: 272c 2027 6665 7463 6820 6261 6c6c 275d  ', 'fetch ball']
+0000d1b0: 0a61 7373 6572 7420 646f 672e 7665 7273  .assert dog.vers
+0000d1c0: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
+0000d1d0: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
+0000d1e0: 7368 6f74 2069 7320 4661 6c73 650a 6060  shot is False.``
+0000d1f0: 600a 0a57 6520 6361 6e20 6361 6c6c 2060  `..We can call `
+0000d200: 736e 6170 7368 6f74 5f64 6f67 2829 6020  snapshot_dog()` 
+0000d210: 746f 2072 6563 6f72 6420 6120 736e 6170  to record a snap
+0000d220: 7368 6f74 206f 6620 7468 6520 6375 7272  shot of the curr
+0000d230: 656e 7420 7374 6174 6520 6f66 2074 6865  ent state of the
+0000d240: 2060 446f 6760 0a61 6767 7265 6761 7465   `Dog`.aggregate
+0000d250: 2e20 4166 7465 7220 7765 2063 616c 6c20  . After we call 
+0000d260: 6073 6e61 7073 686f 745f 646f 6728 2960  `snapshot_dog()`
+0000d270: 2c20 7468 6520 6067 6574 5f64 6f67 2829  , the `get_dog()
+0000d280: 6020 6675 6e63 7469 6f6e 2077 696c 6c20  ` function will 
+0000d290: 7265 7475 726e 2061 2060 446f 6760 0a6f  return a `Dog`.o
+0000d2a0: 626a 6563 7420 7468 6174 2068 6173 2062  bject that has b
+0000d2b0: 6565 6e20 636f 6e73 7472 7563 7465 6420  een constructed 
+0000d2c0: 7573 696e 6720 7468 6520 6053 6e61 7073  using the `Snaps
+0000d2d0: 686f 7460 2065 7665 6e74 2e0a 0a60 6060  hot` event...```
+0000d2e0: 7079 7468 6f6e 0a23 2053 6e61 7073 686f  python.# Snapsho
+0000d2f0: 7420 2746 6964 6f27 2e0a 736e 6170 7368  t 'Fido'..snapsh
+0000d300: 6f74 5f64 6f67 2864 6f67 5f69 6429 0a0a  ot_dog(dog_id)..
+0000d310: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000d320: 675f 6964 290a 6173 7365 7274 2064 6f67  g_id).assert dog
+0000d330: 2e6e 616d 6520 3d3d 2027 4669 646f 270a  .name == 'Fido'.
+0000d340: 6173 7365 7274 2064 6f67 2e74 7269 636b  assert dog.trick
+0000d350: 7320 3d3d 205b 2772 6f6c 6c20 6f76 6572  s == ['roll over
+0000d360: 272c 2027 6665 7463 6820 6261 6c6c 275d  ', 'fetch ball']
+0000d370: 0a61 7373 6572 7420 646f 672e 7665 7273  .assert dog.vers
+0000d380: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
+0000d390: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
+0000d3a0: 7368 6f74 2069 7320 5472 7565 0a60 6060  shot is True.```
+0000d3b0: 0a0a 5765 2063 616e 2063 6f6e 7469 6e75  ..We can continu
+0000d3c0: 6520 746f 2065 766f 6c76 6520 7468 6520  e to evolve the 
+0000d3d0: 7374 6174 6520 6f66 2074 6865 2060 446f  state of the `Do
+0000d3e0: 6760 2061 6767 7265 6761 7465 2c20 7573  g` aggregate, us
+0000d3f0: 696e 670a 7468 6520 736e 6170 7368 6f74  ing.the snapshot
+0000d400: 2062 6f74 6820 6475 7269 6e67 2074 6865   both during the
+0000d410: 2063 616c 6c20 746f 2060 7265 636f 7264   call to `record
+0000d420: 5f74 7269 636b 5f6c 6561 726e 6564 2829  _trick_learned()
+0000d430: 6020 616e 640a 7768 656e 2063 616c 6c69  ` and.when calli
+0000d440: 6e67 2060 6765 745f 646f 6728 2960 2064  ng `get_dog()` d
+0000d450: 6972 6563 746c 792e 0a0a 6060 6070 7974  irectly...```pyt
+0000d460: 686f 6e0a 7265 636f 7264 5f74 7269 636b  hon.record_trick
+0000d470: 5f6c 6561 726e 6564 2864 6f67 5f69 642c  _learned(dog_id,
+0000d480: 2074 7269 636b 3d27 7369 7427 290a 0a64   trick='sit')..d
+0000d490: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
+0000d4a0: 5f69 6429 0a61 7373 6572 7420 646f 672e  _id).assert dog.
+0000d4b0: 6e61 6d65 203d 3d20 2746 6964 6f27 0a61  name == 'Fido'.a
+0000d4c0: 7373 6572 7420 646f 672e 7472 6963 6b73  ssert dog.tricks
+0000d4d0: 203d 3d20 5b27 726f 6c6c 206f 7665 7227   == ['roll over'
+0000d4e0: 2c20 2766 6574 6368 2062 616c 6c27 2c20  , 'fetch ball', 
+0000d4f0: 2773 6974 275d 0a61 7373 6572 7420 646f  'sit'].assert do
+0000d500: 672e 7665 7273 696f 6e20 3d3d 2033 0a61  g.version == 3.a
+0000d510: 7373 6572 7420 646f 672e 6973 5f66 726f  ssert dog.is_fro
+0000d520: 6d5f 736e 6170 7368 6f74 2069 7320 5472  m_snapshot is Tr
+0000d530: 7565 0a60 6060 0a0a 5765 2063 616e 2073  ue.```..We can s
+0000d540: 6565 2066 726f 6d20 7468 6520 6069 735f  ee from the `is_
+0000d550: 6672 6f6d 5f73 6e61 7073 686f 7460 2061  from_snapshot` a
+0000d560: 7474 7269 6275 7465 2074 6861 7420 7468  ttribute that th
+0000d570: 6520 6044 6f67 6020 6f62 6a65 6374 2077  e `Dog` object w
+0000d580: 6173 2069 6e64 6565 640a 7265 636f 6e73  as indeed.recons
+0000d590: 7472 7563 7465 6420 6672 6f6d 2074 6865  tructed from the
+0000d5a0: 2073 6e61 7073 686f 742e 0a0a 536e 6170   snapshot...Snap
+0000d5b0: 7368 6f74 7320 6361 6e20 6265 2063 7265  shots can be cre
+0000d5c0: 6174 6564 2061 7420 6669 7865 6420 7665  ated at fixed ve
+0000d5d0: 7273 696f 6e20 6e75 6d62 6572 2069 6e74  rsion number int
+0000d5e0: 6572 7661 6c73 2c20 6669 7865 6420 7469  ervals, fixed ti
+0000d5f0: 6d65 0a70 6572 696f 6473 2c20 6166 7465  me.periods, afte
+0000d600: 7220 6120 7061 7274 6963 756c 6172 2074  r a particular t
+0000d610: 7970 6520 6f66 2065 7665 6e74 2c20 696d  ype of event, im
+0000d620: 6d65 6469 6174 656c 7920 6166 7465 7220  mediately after 
+0000d630: 6576 656e 7473 2061 7265 0a61 7070 656e  events are.appen
+0000d640: 6465 642c 206f 7220 6173 2061 2062 6163  ded, or as a bac
+0000d650: 6b67 726f 756e 6420 7072 6f63 6573 732e  kground process.
+0000d660: 0a0a 0a23 2323 2052 6561 6420 616c 6c20  ...### Read all 
+0000d670: 6576 656e 7473 0a0a 5468 6520 6072 6561  events..The `rea
+0000d680: 645f 616c 6c5f 6576 656e 7473 2829 6020  d_all_events()` 
+0000d690: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+0000d6a0: 6564 2074 6f20 6765 7420 616c 6c20 7265  ed to get all re
+0000d6b0: 636f 7264 6564 2065 7665 6e74 730a 696e  corded events.in
+0000d6c0: 2074 6865 2064 6174 6162 6173 6520 696e   the database in
+0000d6d0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
+0000d6e0: 7765 7265 2072 6563 6f72 6465 642e 2054  were recorded. T
+0000d6f0: 6869 7320 6d65 7468 6f64 2077 696c 6c20  his method will 
+0000d700: 7265 7475 726e 0a61 2022 7265 6164 2072  return.a "read r
+0000d710: 6573 706f 6e73 6522 206f 626a 6563 742c  esponse" object,
+0000d720: 206a 7573 7420 6c69 6b65 2060 6974 6572   just like `iter
+0000d730: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+0000d740: 602e 0a0a 4120 2272 6561 6420 7265 7370  `...A "read resp
+0000d750: 6f6e 7365 2220 6973 2061 6e20 6974 6572  onse" is an iter
+0000d760: 6174 6f72 2c20 616e 6420 6e6f 7420 6120  ator, and not a 
+0000d770: 7365 7175 656e 6365 2e20 5265 636f 7264  sequence. Record
+0000d780: 6564 2065 7665 6e74 7320 6361 6e20 6265  ed events can be
+0000d790: 0a6f 6274 6169 6e65 6420 6279 2069 7465  .obtained by ite
+0000d7a0: 7261 7469 6e67 206f 7665 7220 7468 6520  rating over the 
+0000d7b0: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
+0000d7c0: 6f62 6a65 6374 2e20 4974 2073 7472 6561  object. It strea
+0000d7d0: 6d73 2072 6563 6f72 6465 640a 6576 656e  ms recorded.even
+0000d7e0: 7473 2066 726f 6d20 7468 6520 7365 7276  ts from the serv
+0000d7f0: 6572 2061 7320 7468 6520 6974 6572 6174  er as the iterat
+0000d800: 696f 6e20 7072 6f63 6565 6473 2e20 5468  ion proceeds. Th
+0000d810: 6520 6974 6572 6174 696f 6e20 7769 6c6c  e iteration will
+0000d820: 2061 7574 6f6d 6174 6963 616c 6c79 0a73   automatically.s
+0000d830: 746f 7020 7768 656e 2074 6865 7265 2061  top when there a
+0000d840: 7265 206e 6f20 6d6f 7265 2072 6563 6f72  re no more recor
+0000d850: 6465 6420 6576 656e 7473 2074 6f20 6265  ded events to be
+0000d860: 2072 6574 7572 6e65 642e 2054 6865 2073   returned. The s
+0000d870: 7472 6561 6d69 6e67 206f 6620 6576 656e  treaming of even
+0000d880: 7473 2c0a 616e 6420 6865 6e63 6520 7468  ts,.and hence th
+0000d890: 6520 6974 6572 6174 6f72 2c20 6361 6e20  e iterator, can 
+0000d8a0: 616c 736f 2062 6520 7374 6f70 7065 6420  also be stopped 
+0000d8b0: 6279 2063 616c 6c69 6e67 2074 6865 2060  by calling the `
+0000d8c0: 7374 6f70 2829 6020 6d65 7468 6f64 206f  stop()` method o
+0000d8d0: 6e20 7468 650a 2272 6561 6420 7265 7370  n the."read resp
+0000d8e0: 6f6e 7365 2220 6f62 6a65 6374 2e0a 0a4a  onse" object...J
+0000d8f0: 7573 7420 6c69 6b65 2060 7265 6164 5f73  ust like `read_s
+0000d900: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+0000d910: 616e 6420 6069 7465 725f 7374 7265 616d  and `iter_stream
+0000d920: 5f65 7665 6e74 7328 2960 2c20 7468 6520  _events()`, the 
+0000d930: 7265 6365 6976 6564 2065 7665 6e74 206f  received event o
+0000d940: 626a 6563 7473 0a61 7265 2069 6e73 7461  bjects.are insta
+0000d950: 6e63 6573 206f 6620 7468 6520 6052 6563  nces of the `Rec
+0000d960: 6f72 6465 6445 7665 6e74 6020 636c 6173  ordedEvent` clas
+0000d970: 732e 0a0a 5468 6973 206d 6574 686f 6420  s...This method 
+0000d980: 6861 7320 7365 7665 6e20 6f70 7469 6f6e  has seven option
+0000d990: 616c 2061 7267 756d 656e 7473 2c20 6063  al arguments, `c
+0000d9a0: 6f6d 6d69 745f 706f 7369 7469 6f6e 602c  ommit_position`,
+0000d9b0: 2060 6261 636b 7761 7264 7360 2c0a 6066   `backwards`,.`f
+0000d9c0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+0000d9d0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+0000d9e0: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
+0000d9f0: 6561 6d5f 6e61 6d65 602c 2060 6c69 6d69  eam_name`, `limi
+0000da00: 7460 2c20 616e 6420 6074 696d 656f 7574  t`, and `timeout
+0000da10: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+0000da20: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+0000da30: 6e60 2061 7267 756d 656e 7420 6973 2061  n` argument is a
+0000da40: 2050 7974 686f 6e20 6069 6e74 6020 7468   Python `int` th
+0000da50: 6174 2063 616e 2062 6520 7573 6564 2074  at can be used t
+0000da60: 6f0a 7370 6563 6966 7920 6120 636f 6d6d  o.specify a comm
+0000da70: 6974 2070 6f73 6974 696f 6e20 6672 6f6d  it position from
+0000da80: 2077 6869 6368 2074 6f20 7374 6172 7420   which to start 
+0000da90: 7265 6164 696e 672e 2054 6865 2064 6566  reading. The def
+0000daa0: 6175 6c74 2076 616c 7565 206f 660a 6063  ault value of.`c
+0000dab0: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+0000dac0: 6973 2060 4e6f 6e65 602e 2050 6c65 6173  is `None`. Pleas
+0000dad0: 6520 6e6f 7465 2c20 6966 2061 2063 6f6d  e note, if a com
+0000dae0: 6d69 7420 706f 7369 7469 6f6e 2069 7320  mit position is 
+0000daf0: 7370 6563 6966 6965 642c 0a69 7420 6d75  specified,.it mu
+0000db00: 7374 2062 6520 616e 2061 6374 7561 6c6c  st be an actuall
+0000db10: 7920 6578 6973 7469 6e67 2063 6f6d 6d69  y existing commi
+0000db20: 7420 706f 7369 7469 6f6e 2069 6e20 7468  t position in th
+0000db30: 6520 6461 7461 6261 7365 2e0a 0a54 6865  e database...The
+0000db40: 206f 7074 696f 6e61 6c20 6062 6163 6b77   optional `backw
+0000db50: 6172 6473 6020 6172 6775 6d65 6e74 2069  ards` argument i
+0000db60: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+0000db70: 602e 2054 6865 2064 6566 6175 6c74 206f  `. The default o
+0000db80: 6620 6062 6163 6b77 6172 6473 6020 6973  f `backwards` is
+0000db90: 0a60 4661 6c73 6560 2c20 7768 6963 6820  .`False`, which 
+0000dba0: 6d65 616e 7320 6576 656e 7473 2061 7265  means events are
+0000dbb0: 2072 6574 7572 6e65 6420 696e 2074 6865   returned in the
+0000dbc0: 206f 7264 6572 2074 6865 7920 7765 7265   order they were
+0000dbd0: 2072 6563 6f72 6465 642c 2049 660a 6062   recorded, If.`b
+0000dbe0: 6163 6b77 6172 6473 6020 6973 2060 5472  ackwards` is `Tr
+0000dbf0: 7565 602c 2074 6865 6e20 6576 656e 7473  ue`, then events
+0000dc00: 2061 7265 2072 6574 7572 6e65 6420 696e   are returned in
+0000dc10: 2072 6576 6572 7365 206f 7264 6572 2e0a   reverse order..
+0000dc20: 0a49 6620 6062 6163 6b77 6172 6473 6020  .If `backwards` 
+0000dc30: 6973 2060 4661 6c73 6560 2061 6e64 2060  is `False` and `
+0000dc40: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+0000dc50: 2069 7320 604e 6f6e 6560 2c20 7468 6520   is `None`, the 
+0000dc60: 6461 7461 6261 7365 2773 2065 7665 6e74  database's event
+0000dc70: 7320 7769 6c6c 0a62 6520 7265 7475 726e  s will.be return
+0000dc80: 6564 2069 6e20 7468 6520 6f72 6465 7220  ed in the order 
+0000dc90: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
+0000dca0: 6564 2c20 7374 6172 7469 6e67 2066 726f  ed, starting fro
+0000dcb0: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
+0000dcc0: 7264 6564 2065 7665 6e74 2e0a 5468 6973  rded event..This
+0000dcd0: 2069 7320 7468 6520 6465 6661 756c 7420   is the default 
+0000dce0: 6265 6861 7669 6f72 206f 6620 6072 6561  behavior of `rea
+0000dcf0: 645f 616c 6c5f 6576 656e 7473 2829 602e  d_all_events()`.
+0000dd00: 2049 6620 6062 6163 6b77 6172 6473 6020   If `backwards` 
+0000dd10: 6973 2060 5472 7565 6020 616e 640a 6063  is `True` and.`c
+0000dd20: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+0000dd30: 6973 2060 4e6f 6e65 602c 2074 6865 2064  is `None`, the d
+0000dd40: 6174 6162 6173 6527 7320 6576 656e 7473  atabase's events
+0000dd50: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
+0000dd60: 6420 696e 2072 6576 6572 7365 206f 7264  d in reverse ord
+0000dd70: 6572 2c0a 7374 6172 7469 6e67 2066 726f  er,.starting fro
+0000dd80: 6d20 7468 6520 6c61 7374 2072 6563 6f72  m the last recor
+0000dd90: 6465 6420 6576 656e 742e 0a0a 5468 6520  ded event...The 
+0000dda0: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+0000ddb0: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+0000ddc0: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+0000ddd0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+0000dde0: 6573 7369 6f6e 7320 7468 6174 0a73 7065  essions that.spe
+0000ddf0: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
+0000de00: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
+0000de10: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
+0000de20: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
+0000de30: 7320 6967 6e6f 7265 640a 6966 2060 6669  s ignored.if `fi
+0000de40: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
+0000de50: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+0000de60: 7074 7920 7365 7175 656e 6365 2e20 5468  pty sequence. Th
+0000de70: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0000de80: 6f66 2074 6869 730a 6172 6775 6d65 6e74  of this.argument
+0000de90: 206d 6174 6368 6573 2074 6865 2065 7665   matches the eve
+0000dea0: 6e74 2074 7970 6573 206f 6620 4576 656e  nt types of Even
+0000deb0: 7453 746f 7265 4442 2022 7379 7374 656d  tStoreDB "system
+0000dec0: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
+0000ded0: 7420 7379 7374 656d 0a65 7665 6e74 7320  t system.events 
+0000dee0: 7769 6c6c 206e 6f74 206e 6f72 6d61 6c6c  will not normall
+0000def0: 7920 6265 2069 6e63 6c75 6465 642e 2053  y be included. S
+0000df00: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
+0000df10: 7469 6f6e 2062 656c 6f77 2066 6f72 206d  tion below for m
+0000df20: 6f72 650a 696e 666f 726d 6174 696f 6e20  ore.information 
+0000df30: 6162 6f75 7420 6669 6c74 6572 2065 7870  about filter exp
+0000df40: 7265 7373 696f 6e73 2e0a 0a54 6865 206f  ressions...The o
+0000df50: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+0000df60: 696e 636c 7564 6560 2061 7267 756d 656e  include` argumen
+0000df70: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+0000df80: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0000df90: 7373 696f 6e73 0a74 6861 7420 7370 6563  ssions.that spec
+0000dfa0: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
+0000dfb0: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
+0000dfc0: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
+0000dfd0: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+0000dfe0: 0a61 7267 756d 656e 7420 6973 2061 6e20  .argument is an 
+0000dff0: 656d 7074 7920 7475 706c 652e 2049 6620  empty tuple. If 
+0000e000: 7468 6973 2061 7267 756d 656e 7420 6973  this argument is
+0000e010: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+0000e020: 7074 7920 7365 7175 656e 6365 2c0a 7468  pty sequence,.th
+0000e030: 6520 6066 696c 7465 725f 6578 636c 7564  e `filter_exclud
+0000e040: 6560 2061 7267 756d 656e 7420 6973 2069  e` argument is i
+0000e050: 676e 6f72 6564 2e0a 0a54 6865 206f 7074  gnored...The opt
+0000e060: 696f 6e61 6c20 6066 696c 7465 725f 6279  ional `filter_by
+0000e070: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
+0000e080: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0000e090: 6f6e 2060 626f 6f6c 6020 7468 6174 2069  on `bool` that i
+0000e0a0: 6e64 6963 6174 6573 0a77 6865 7468 6572  ndicates.whether
+0000e0b0: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
+0000e0c0: 696c 6c20 6170 706c 7920 746f 2065 7665  ill apply to eve
+0000e0d0: 6e74 2074 7970 6573 206f 7220 7374 7265  nt types or stre
+0000e0e0: 616d 206e 616d 6573 2e20 4279 2064 6566  am names. By def
+0000e0f0: 6175 6c74 2c20 7468 6973 0a76 616c 7565  ault, this.value
+0000e100: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
+0000e110: 736f 2074 6865 2066 696c 7465 7269 6e67  so the filtering
+0000e120: 2077 696c 6c20 6170 706c 7920 746f 2074   will apply to t
+0000e130: 6865 2065 7665 6e74 2074 7970 6520 7374  he event type st
+0000e140: 7269 6e67 7320 6f66 0a72 6563 6f72 6465  rings of.recorde
+0000e150: 6420 6576 656e 7473 2e0a 0a54 6865 206f  d events...The o
+0000e160: 7074 696f 6e61 6c20 606c 696d 6974 6020  ptional `limit` 
+0000e170: 6172 6775 6d65 6e74 2069 7320 616e 2069  argument is an i
+0000e180: 6e74 6567 6572 2077 6869 6368 2072 6573  nteger which res
+0000e190: 7472 6963 7473 2074 6865 206e 756d 6265  tricts the numbe
+0000e1a0: 7220 6f66 2065 7665 6e74 7320 7468 6174  r of events that
+0000e1b0: 0a77 696c 6c20 6265 2072 6574 7572 6e65  .will be returne
+0000e1c0: 642e 2054 6865 2064 6566 6175 6c74 2076  d. The default v
+0000e1d0: 616c 7565 2069 7320 6073 7973 2e6d 6178  alue is `sys.max
+0000e1e0: 696e 7460 2e0a 0a54 6865 206f 7074 696f  int`...The optio
+0000e1f0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+0000e200: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0000e210: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+0000e220: 2073 6574 7320 610a 6465 6164 6c69 6e65   sets a.deadline
+0000e230: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0000e240: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0000e250: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0000e260: 6669 6c74 6572 696e 6720 6f66 2065 7665  filtering of eve
+0000e270: 6e74 7320 6973 2064 6f6e 6520 6f6e 2074  nts is done on t
+0000e280: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+0000e290: 7365 7276 6572 2e20 5468 650a 606c 696d  server. The.`lim
+0000e2a0: 6974 6020 6172 6775 6d65 6e74 2069 7320  it` argument is 
+0000e2b0: 6170 706c 6965 6420 6f6e 2074 6865 2073  applied on the s
+0000e2c0: 6572 7665 7220 6166 7465 7220 6669 6c74  erver after filt
+0000e2d0: 6572 696e 672e 0a0a 5468 6520 6578 616d  ering...The exam
+0000e2e0: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+0000e2f0: 686f 7720 746f 2067 6574 2061 6c6c 2074  how to get all t
+0000e300: 6865 2065 7665 6e74 7320 7765 2068 6176  he events we hav
+0000e310: 6520 7265 636f 7264 6564 2069 6e20 7468  e recorded in th
+0000e320: 6520 6461 7461 6261 7365 0a73 6f20 6661  e database.so fa
+0000e330: 722c 2069 6e20 7468 6520 6f72 6465 7220  r, in the order 
+0000e340: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
+0000e350: 6564 2e20 5765 2063 616e 2073 6565 2074  ed. We can see t
+0000e360: 6865 2074 6872 6565 2065 7665 6e74 7320  he three events 
+0000e370: 6f66 2060 7374 7265 616d 5f6e 616d 6531  of `stream_name1
+0000e380: 600a 2860 6576 656e 7431 602c 2060 6576  `.(`event1`, `ev
+0000e390: 656e 7432 6020 616e 6420 6065 7665 6e74  ent2` and `event
+0000e3a0: 3360 2920 6172 6520 696e 636c 7564 6564  3`) are included
+0000e3b0: 2c20 616c 6f6e 6720 7769 7468 206f 7468  , along with oth
+0000e3c0: 6572 732e 0a0a 6060 6070 7974 686f 6e0a  ers...```python.
+0000e3d0: 2320 5265 6164 2061 6c6c 2065 7665 6e74  # Read all event
+0000e3e0: 7320 2863 7265 6174 6573 2061 2073 7472  s (creates a str
+0000e3f0: 6561 6d69 6e67 2067 5250 4320 6361 6c6c  eaming gRPC call
+0000e400: 292e 0a72 6561 645f 7265 7370 6f6e 7365  )..read_response
+0000e410: 203d 2063 6c69 656e 742e 7265 6164 5f61   = client.read_a
+0000e420: 6c6c 5f65 7665 6e74 7328 290a 0a23 2043  ll_events()..# C
+0000e430: 6f6e 7665 7274 2074 6865 2069 7465 7261  onvert the itera
+0000e440: 746f 7220 696e 746f 2061 2073 6571 7565  tor into a seque
+0000e450: 6e63 6520 6f66 2072 6563 6f72 6465 6420  nce of recorded 
+0000e460: 6576 656e 7473 2e0a 6576 656e 7473 203d  events..events =
+0000e470: 2074 7570 6c65 2872 6561 645f 7265 7370   tuple(read_resp
+0000e480: 6f6e 7365 290a 6173 7365 7274 206c 656e  onse).assert len
+0000e490: 2865 7665 6e74 7329 203e 2033 2020 2320  (events) > 3  # 
+0000e4a0: 6d6f 7265 2074 6861 6e20 7468 7265 650a  more than three.
+0000e4b0: 0a23 2043 6f6e 7665 7274 2074 6865 2073  .# Convert the s
+0000e4c0: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
+0000e4d0: 6465 6420 6576 656e 7473 2069 6e74 6f20  ded events into 
+0000e4e0: 6120 7365 7420 6f66 2065 7665 6e74 2049  a set of event I
+0000e4f0: 4473 2e0a 6576 656e 745f 6964 7320 3d20  Ds..event_ids = 
+0000e500: 7365 7428 652e 6964 2066 6f72 2065 2069  set(e.id for e i
+0000e510: 6e20 6576 656e 7473 290a 6173 7365 7274  n events).assert
+0000e520: 2065 7665 6e74 312e 6964 2069 6e20 6576   event1.id in ev
+0000e530: 656e 745f 6964 730a 6173 7365 7274 2065  ent_ids.assert e
+0000e540: 7665 6e74 322e 6964 2069 6e20 6576 656e  vent2.id in even
+0000e550: 745f 6964 730a 6173 7365 7274 2065 7665  t_ids.assert eve
+0000e560: 6e74 332e 6964 2069 6e20 6576 656e 745f  nt3.id in event_
+0000e570: 6964 730a 6060 600a 0a54 6865 2065 7861  ids.```..The exa
+0000e580: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000e590: 2068 6f77 2074 6f20 7265 6164 2061 6c6c   how to read all
+0000e5a0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000e5b0: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+0000e5c0: 2066 726f 6d0a 6120 7061 7274 6963 756c   from.a particul
+0000e5d0: 6172 2063 6f6d 6d69 7420 706f 7369 7469  ar commit positi
+0000e5e0: 6f6e 2c20 696e 2074 6869 7320 6361 7365  on, in this case
+0000e5f0: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+0000e600: 6e31 602e 2057 6865 6e20 7265 6164 696e  n1`. When readin
+0000e610: 670a 666f 7277 6172 6473 2066 726f 6d20  g.forwards from 
+0000e620: 6120 7370 6563 6966 6963 2063 6f6d 6d69  a specific commi
+0000e630: 7420 706f 7369 7469 6f6e 2c20 7468 6520  t position, the 
+0000e640: 6576 656e 7420 6174 2074 6865 2073 7065  event at the spe
+0000e650: 6369 6669 6564 2070 6f73 6974 696f 6e0a  cified position.
+0000e660: 7769 6c6c 2062 6520 696e 636c 7564 6564  will be included
+0000e670: 2e20 5468 6520 7661 6c75 6520 6f66 2060  . The value of `
+0000e680: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
+0000e690: 6020 6973 2074 6865 2070 6f73 6974 696f  ` is the positio
+0000e6a0: 6e20 7765 206f 6274 6169 6e65 640a 7768  n we obtained.wh
+0000e6b0: 656e 2061 7070 656e 6469 6e67 2060 6576  en appending `ev
+0000e6c0: 656e 7431 602e 2041 6e64 2073 6f20 6065  ent1`. And so `e
+0000e6d0: 7665 6e74 3160 2069 7320 7468 6520 6669  vent1` is the fi
+0000e6e0: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
+0000e6f0: 6e74 2077 6520 7368 616c 6c0a 7265 6365  nt we shall.rece
+0000e700: 6976 652c 2060 6576 656e 7432 6020 6973  ive, `event2` is
+0000e710: 2074 6865 2073 6563 6f6e 642c 2061 6e64   the second, and
+0000e720: 2060 6576 656e 7433 6020 6973 2074 6865   `event3` is the
+0000e730: 2074 6869 7264 2e0a 0a60 6060 7079 7468   third...```pyth
+0000e740: 6f6e 0a23 2052 6561 6420 616c 6c20 6576  on.# Read all ev
+0000e750: 656e 7473 2066 6f72 7761 7264 7320 6672  ents forwards fr
+0000e760: 6f6d 2061 2063 6f6d 6d69 7420 706f 7369  om a commit posi
+0000e770: 7469 6f6e 2e0a 7265 6164 5f72 6573 706f  tion..read_respo
+0000e780: 6e73 6520 3d20 636c 6965 6e74 2e72 6561  nse = client.rea
+0000e790: 645f 616c 6c5f 6576 656e 7473 280a 2020  d_all_events(.  
+0000e7a0: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
+0000e7b0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
+0000e7c0: 6e31 0a29 0a0a 2320 5374 6570 2074 6872  n1.)..# Step thr
+0000e7d0: 6f75 6768 2074 6865 2022 7265 6164 2072  ough the "read r
+0000e7e0: 6573 706f 6e73 6522 2069 7465 7261 746f  esponse" iterato
+0000e7f0: 722e 0a61 7373 6572 7420 6e65 7874 2872  r..assert next(r
+0000e800: 6561 645f 7265 7370 6f6e 7365 292e 6964  ead_response).id
+0000e810: 203d 3d20 6576 656e 7431 2e69 640a 6173   == event1.id.as
+0000e820: 7365 7274 206e 6578 7428 7265 6164 5f72  sert next(read_r
+0000e830: 6573 706f 6e73 6529 2e69 6420 3d3d 2065  esponse).id == e
+0000e840: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
+0000e850: 6e65 7874 2872 6561 645f 7265 7370 6f6e  next(read_respon
+0000e860: 7365 292e 6964 203d 3d20 6576 656e 7433  se).id == event3
+0000e870: 2e69 640a 0a23 2053 746f 7020 7468 6520  .id..# Stop the 
+0000e880: 6974 6572 6174 6f72 2e0a 7265 6164 5f72  iterator..read_r
+0000e890: 6573 706f 6e73 652e 7374 6f70 2829 0a60  esponse.stop().`
+0000e8a0: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
+0000e8b0: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
+0000e8c0: 746f 2072 6561 6420 616c 6c20 6576 656e  to read all even
+0000e8d0: 7473 2072 6563 6f72 6465 6420 696e 2074  ts recorded in t
+0000e8e0: 6865 2064 6174 6162 6173 6520 696e 2072  he database in r
+0000e8f0: 6576 6572 7365 0a6f 7264 6572 2e20 5765  everse.order. We
+0000e900: 2063 616e 2073 6565 2074 6861 7420 7468   can see that th
+0000e910: 6520 6669 7273 7420 6576 656e 7473 2077  e first events w
+0000e920: 6520 7265 6365 6976 6520 6172 6520 7468  e receive are th
+0000e930: 6520 6c61 7374 2065 7665 6e74 7320 7468  e last events th
+0000e940: 6174 2077 6572 650a 7265 636f 7264 6564  at were.recorded
+0000e950: 3a20 7468 6520 6576 656e 7473 206f 6620  : the events of 
+0000e960: 7468 6520 6044 6f67 6020 6167 6772 6567  the `Dog` aggreg
+0000e970: 6174 6520 6672 6f6d 2074 6865 2073 6563  ate from the sec
+0000e980: 7469 6f6e 2061 626f 7574 2073 6e61 7073  tion about snaps
+0000e990: 686f 7474 696e 670a 616e 6420 7468 6520  hotting.and the 
+0000e9a0: 736e 6170 7368 6f74 2e0a 0a60 6060 7079  snapshot...```py
+0000e9b0: 7468 6f6e 0a23 2052 6561 6420 616c 6c20  thon.# Read all 
+0000e9c0: 6576 656e 7473 2062 6163 6b77 6172 6473  events backwards
+0000e9d0: 2066 726f 6d20 7468 6520 656e 642e 0a72   from the end..r
+0000e9e0: 6561 645f 7265 7370 6f6e 7365 203d 2063  ead_response = c
+0000e9f0: 6c69 656e 742e 7265 6164 5f61 6c6c 5f65  lient.read_all_e
+0000ea00: 7665 6e74 7328 0a20 2020 2062 6163 6b77  vents(.    backw
+0000ea10: 6172 6473 3d54 7275 650a 290a 0a23 2053  ards=True.)..# S
+0000ea20: 7465 7020 7468 726f 7567 6820 7468 6520  tep through the 
+0000ea30: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
+0000ea40: 6974 6572 6174 6f72 2e0a 6173 7365 7274  iterator..assert
+0000ea50: 206e 6578 7428 7265 6164 5f72 6573 706f   next(read_respo
+0000ea60: 6e73 6529 2e74 7970 6520 3d3d 2022 446f  nse).type == "Do
+0000ea70: 674c 6561 726e 6564 5472 6963 6b22 0a61  gLearnedTrick".a
+0000ea80: 7373 6572 7420 6e65 7874 2872 6561 645f  ssert next(read_
+0000ea90: 7265 7370 6f6e 7365 292e 7479 7065 203d  response).type =
+0000eaa0: 3d20 2253 6e61 7073 686f 7422 0a61 7373  = "Snapshot".ass
+0000eab0: 6572 7420 6e65 7874 2872 6561 645f 7265  ert next(read_re
+0000eac0: 7370 6f6e 7365 292e 7479 7065 203d 3d20  sponse).type == 
+0000ead0: 2244 6f67 4c65 6172 6e65 6454 7269 636b  "DogLearnedTrick
+0000eae0: 220a 6173 7365 7274 206e 6578 7428 7265  ".assert next(re
+0000eaf0: 6164 5f72 6573 706f 6e73 6529 2e74 7970  ad_response).typ
+0000eb00: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
+0000eb10: 5472 6963 6b22 0a61 7373 6572 7420 6e65  Trick".assert ne
+0000eb20: 7874 2872 6561 645f 7265 7370 6f6e 7365  xt(read_response
+0000eb30: 292e 7479 7065 203d 3d20 2244 6f67 5265  ).type == "DogRe
+0000eb40: 6769 7374 6572 6564 220a 0a23 2053 746f  gistered"..# Sto
+0000eb50: 7020 7468 6520 6974 6572 6174 6f72 2e0a  p the iterator..
+0000eb60: 7265 6164 5f72 6573 706f 6e73 652e 7374  read_response.st
+0000eb70: 6f70 2829 0a60 6060 0a0a 5468 6520 6578  op().```..The ex
+0000eb80: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+0000eb90: 7320 686f 7720 746f 2072 6561 6420 6120  s how to read a 
+0000eba0: 6c69 6d69 7465 6420 6e75 6d62 6572 206f  limited number o
+0000ebb0: 6620 6576 656e 7473 0a66 6f72 7761 7264  f events.forward
+0000ebc0: 7320 6672 6f6d 2061 2073 7065 6369 6669  s from a specifi
+0000ebd0: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
+0000ebe0: 6e2e 0a0a 6060 6070 7974 686f 6e0a 6576  n...```python.ev
+0000ebf0: 656e 7473 203d 2074 7570 6c65 280a 2020  ents = tuple(.  
+0000ec00: 2020 636c 6965 6e74 2e72 6561 645f 616c    client.read_al
+0000ec10: 6c5f 6576 656e 7473 280a 2020 2020 2020  l_events(.      
+0000ec20: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
+0000ec30: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
+0000ec40: 6e31 2c0a 2020 2020 2020 2020 6c69 6d69  n1,.        limi
+0000ec50: 743d 312c 0a20 2020 2029 0a29 0a0a 6173  t=1,.    ).)..as
+0000ec60: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+0000ec70: 203d 3d20 310a 6173 7365 7274 2065 7665   == 1.assert eve
+0000ec80: 6e74 735b 305d 2e69 6420 3d3d 2065 7665  nts[0].id == eve
+0000ec90: 6e74 312e 6964 0a60 6060 0a0a 5468 6520  nt1.id.```..The 
+0000eca0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+0000ecb0: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
+0000ecc0: 6120 6c69 6d69 7465 6420 6e75 6d62 6572  a limited number
+0000ecd0: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
+0000ece0: 2065 7665 6e74 730a 696e 2074 6865 2064   events.in the d
+0000ecf0: 6174 6162 6173 6520 6261 636b 7761 7264  atabase backward
+0000ed00: 7320 6672 6f6d 2074 6865 2065 6e64 2e20  s from the end. 
+0000ed10: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
+0000ed20: 6520 6c69 6d69 7420 6973 2031 2c20 616e  e limit is 1, an
+0000ed30: 640a 736f 2077 6520 7265 6365 6976 6520  d.so we receive 
+0000ed40: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
+0000ed50: 6420 6576 656e 742e 0a0a 6060 6070 7974  d event...```pyt
+0000ed60: 686f 6e0a 6576 656e 7473 203d 2074 7570  hon.events = tup
+0000ed70: 6c65 280a 2020 2020 636c 6965 6e74 2e72  le(.    client.r
+0000ed80: 6561 645f 616c 6c5f 6576 656e 7473 280a  ead_all_events(.
+0000ed90: 2020 2020 2020 2020 6261 636b 7761 7264          backward
+0000eda0: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
+0000edb0: 6c69 6d69 743d 312c 0a20 2020 2029 0a29  limit=1,.    ).)
+0000edc0: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000edd0: 6e74 7329 203d 3d20 310a 0a61 7373 6572  nts) == 1..asser
+0000ede0: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
+0000edf0: 203d 3d20 2744 6f67 4c65 6172 6e65 6454   == 'DogLearnedT
+0000ee00: 7269 636b 270a 6173 7365 7274 2064 6573  rick'.assert des
+0000ee10: 6572 6961 6c69 7a65 2865 7665 6e74 735b  erialize(events[
+0000ee20: 305d 2e64 6174 6129 5b27 7472 6963 6b27  0].data)['trick'
+0000ee30: 5d20 3d3d 2027 7369 7427 0a60 6060 0a0a  ] == 'sit'.```..
+0000ee40: 506c 6561 7365 206e 6f74 652c 206c 696b  Please note, lik
+0000ee50: 6520 7468 6520 6069 7465 725f 7374 7265  e the `iter_stre
+0000ee60: 616d 5f65 7665 6e74 7328 2960 206d 6574  am_events()` met
+0000ee70: 686f 642c 2074 6865 2060 7265 6164 5f61  hod, the `read_a
+0000ee80: 6c6c 5f65 7665 6e74 7328 2960 206d 6574  ll_events()` met
+0000ee90: 686f 640a 6973 206e 6f74 2064 6563 6f72  hod.is not decor
+0000eea0: 6174 6564 2077 6974 6820 7265 7472 7920  ated with retry 
+0000eeb0: 616e 6420 7265 636f 6e6e 6563 7420 6465  and reconnect de
+0000eec0: 636f 7261 746f 7273 2c20 6265 6361 7573  corators, becaus
+0000eed0: 6520 7468 6520 7374 7265 616d 696e 6720  e the streaming 
+0000eee0: 6f66 2072 6563 6f72 6465 640a 6576 656e  of recorded.even
+0000eef0: 7473 2066 726f 6d20 7468 6520 7365 7276  ts from the serv
+0000ef00: 6572 206f 6e6c 7920 7374 6172 7473 2077  er only starts w
+0000ef10: 6865 6e20 6974 6572 6174 696e 6720 6f76  hen iterating ov
+0000ef20: 6572 2074 6865 2022 7265 6164 2072 6573  er the "read res
+0000ef30: 706f 6e73 6522 2073 7461 7274 732c 2077  ponse" starts, w
+0000ef40: 6869 6368 0a6d 6561 6e73 2074 6861 7420  hich.means that 
+0000ef50: 7468 6520 6d65 7468 6f64 2072 6574 7572  the method retur
+0000ef60: 6e73 2062 6566 6f72 6520 7468 6520 7374  ns before the st
+0000ef70: 7265 616d 696e 6720 7374 6172 7473 2c20  reaming starts, 
+0000ef80: 616e 6420 736f 2074 6865 7265 2069 7320  and so there is 
+0000ef90: 6e6f 2063 6861 6e63 6520 666f 720a 616e  no chance for.an
+0000efa0: 7920 6465 636f 7261 746f 7273 2074 6f20  y decorators to 
+0000efb0: 6361 7463 6820 616e 7920 636f 6e6e 6563  catch any connec
+0000efc0: 7469 6f6e 2069 7373 7565 732e 0a0a 2323  tion issues...##
+0000efd0: 2320 4765 7420 636f 6d6d 6974 2070 6f73  # Get commit pos
+0000efe0: 6974 696f 6e0a 0a54 6865 2060 6765 745f  ition..The `get_
+0000eff0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
+0000f000: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+0000f010: 2075 7365 6420 746f 2067 6574 2074 6865   used to get the
+0000f020: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000f030: 206f 6620 7468 650a 6c61 7374 2072 6563   of the.last rec
+0000f040: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
+0000f050: 6865 2064 6174 6162 6173 652e 2049 7420  he database. It 
+0000f060: 7369 6d70 6c79 2063 616c 6c73 2060 7265  simply calls `re
+0000f070: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
+0000f080: 2077 6974 680a 6062 6163 6b77 6172 6473   with.`backwards
+0000f090: 3d54 7275 6560 2061 6e64 2060 6c69 6d69  =True` and `limi
+0000f0a0: 743d 3160 2c20 616e 6420 7265 7475 726e  t=1`, and return
+0000f0b0: 7320 7468 6520 7661 6c75 6520 6f66 2074  s the value of t
+0000f0c0: 6865 2060 636f 6d6d 6974 5f70 6f73 6974  he `commit_posit
+0000f0d0: 696f 6e60 0a61 7474 7269 6275 7465 206f  ion`.attribute o
+0000f0e0: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
+0000f0f0: 6465 6420 6576 656e 742e 0a0a 6060 6070  ded event...```p
+0000f100: 7974 686f 6e0a 636f 6d6d 6974 5f70 6f73  ython.commit_pos
+0000f110: 6974 696f 6e20 3d20 636c 6965 6e74 2e67  ition = client.g
+0000f120: 6574 5f63 6f6d 6d69 745f 706f 7369 7469  et_commit_positi
+0000f130: 6f6e 2829 0a60 6060 0a0a 5468 6973 206d  on().```..This m
+0000f140: 6574 686f 6420 6861 7320 666f 7572 206f  ethod has four o
+0000f150: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+0000f160: 732c 2060 6669 6c74 6572 5f65 7863 6c75  s, `filter_exclu
+0000f170: 6465 602c 2060 6669 6c74 6572 5f69 6e63  de`, `filter_inc
+0000f180: 6c75 6465 602c 0a60 6669 6c74 6572 5f62  lude`,.`filter_b
+0000f190: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
+0000f1a0: 6e64 2060 7469 6d65 6f75 7460 2e20 5468  nd `timeout`. Th
+0000f1b0: 6573 6520 7661 6c75 6573 2061 7265 2070  ese values are p
+0000f1c0: 6173 7365 6420 746f 2060 7265 6164 5f61  assed to `read_a
+0000f1d0: 6c6c 5f65 7665 6e74 7328 2960 2e0a 0a54  ll_events()`...T
+0000f1e0: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
+0000f1f0: 7465 725f 6578 636c 7564 6560 2c20 6066  ter_exclude`, `f
+0000f200: 696c 7465 725f 696e 636c 7564 6560 2061  ilter_include` a
+0000f210: 6e64 2060 6669 6c74 6572 5f62 795f 7374  nd `filter_by_st
+0000f220: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+0000f230: 656e 7473 0a77 6f72 6b20 696e 2074 6865  ents.work in the
+0000f240: 2073 616d 6520 7761 7920 6173 2074 6865   same way as the
+0000f250: 7920 646f 2069 6e20 7468 6520 6072 6561  y do in the `rea
+0000f260: 645f 616c 6c5f 6576 656e 7473 2829 6020  d_all_events()` 
+0000f270: 6d65 7468 6f64 2e0a 0a54 6869 7320 6f70  method...This op
+0000f280: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+0000f290: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0000f2a0: 7974 686f 6e20 6066 6c6f 6174 6020 7468  ython `float` th
+0000f2b0: 6174 2073 6574 730a 6120 6465 6164 6c69  at sets.a deadli
+0000f2c0: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+0000f2d0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0000f2e0: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+0000f2f0: 6973 206d 6574 686f 6420 6d69 6768 7420  is method might 
+0000f300: 6265 2075 7365 6420 746f 206d 6561 7375  be used to measu
+0000f310: 7265 2070 726f 6772 6573 7320 6f66 2061  re progress of a
+0000f320: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+0000f330: 6f6e 656e 740a 7468 6174 2069 7320 7072  onent.that is pr
+0000f340: 6f63 6573 7369 6e67 2061 6c6c 2072 6563  ocessing all rec
+0000f350: 6f72 6465 6420 6576 656e 7473 2c20 6279  orded events, by
+0000f360: 2063 6f6d 7061 7269 6e67 2074 6865 2063   comparing the c
+0000f370: 7572 7265 6e74 2063 6f6d 6d69 740a 706f  urrent commit.po
+0000f380: 7369 7469 6f6e 2077 6974 6820 7468 6520  sition with the 
+0000f390: 7265 636f 7264 6564 2063 6f6d 6d69 7420  recorded commit 
+0000f3a0: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
+0000f3b0: 6c61 7374 2073 7563 6365 7373 6675 6c6c  last successfull
+0000f3c0: 7920 7072 6f63 6573 7365 640a 6576 656e  y processed.even
+0000f3d0: 7420 696e 2061 2064 6f77 6e73 7472 6561  t in a downstrea
+0000f3e0: 6d20 636f 6d70 6f6e 656e 742e 2049 6e20  m component. In 
+0000f3f0: 7468 6973 2063 6173 652c 2074 6865 2076  this case, the v
+0000f400: 616c 7565 206f 6620 7468 6520 6066 696c  alue of the `fil
+0000f410: 7465 725f 6578 636c 7564 6560 2c0a 6066  ter_exclude`,.`f
+0000f420: 696c 7465 725f 696e 636c 7564 6560 2061  ilter_include` a
+0000f430: 6e64 2060 6669 6c74 6572 5f62 795f 7374  nd `filter_by_st
+0000f440: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+0000f450: 656e 7473 2073 686f 756c 6420 6571 7561  ents should equa
+0000f460: 6c20 7468 6f73 6520 7573 6564 0a62 7920  l those used.by 
+0000f470: 7468 6520 646f 776e 7374 7265 616d 2063  the downstream c
+0000f480: 6f6d 706f 6e65 6e74 2074 6f20 6f62 7461  omponent to obta
+0000f490: 696e 2072 6563 6f72 6465 6420 6576 656e  in recorded even
+0000f4a0: 7473 2e0a 0a0a 2323 2320 4765 7420 7374  ts....### Get st
+0000f4b0: 7265 616d 206d 6574 6164 6174 610a 0a54  ream metadata..T
+0000f4c0: 6865 2060 6765 745f 7374 7265 616d 5f6d  he `get_stream_m
+0000f4d0: 6574 6164 6174 6128 2960 206d 6574 686f  etadata()` metho
+0000f4e0: 6420 7265 7475 726e 7320 7468 6520 6d65  d returns the me
+0000f4f0: 7461 6461 7461 2066 6f72 2061 2073 7472  tadata for a str
+0000f500: 6561 6d2c 2061 6c6f 6e67 0a77 6974 6820  eam, along.with 
+0000f510: 7468 6520 7665 7273 696f 6e20 6f66 2074  the version of t
+0000f520: 6865 2073 7472 6561 6d20 6d65 7461 6461  he stream metada
+0000f530: 7461 2e0a 0a60 6060 7079 7468 6f6e 0a6d  ta...```python.m
+0000f540: 6574 6164 6174 612c 206d 6574 6164 6174  etadata, metadat
+0000f550: 615f 7665 7273 696f 6e20 3d20 636c 6965  a_version = clie
+0000f560: 6e74 2e67 6574 5f73 7472 6561 6d5f 6d65  nt.get_stream_me
+0000f570: 7461 6461 7461 2873 7472 6561 6d5f 6e61  tadata(stream_na
+0000f580: 6d65 3d73 7472 6561 6d5f 6e61 6d65 3129  me=stream_name1)
+0000f590: 0a60 6060 0a0a 5468 6520 7265 7475 726e  .```..The return
+0000f5a0: 6564 2060 6d65 7461 6461 7461 6020 7661  ed `metadata` va
+0000f5b0: 6c75 6520 6973 2061 2050 7974 686f 6e20  lue is a Python 
+0000f5c0: 6064 6963 7460 2e20 5468 6520 7265 7475  `dict`. The retu
+0000f5d0: 726e 6564 2060 6d65 7461 6461 7461 5f76  rned `metadata_v
+0000f5e0: 6572 7369 6f6e 600a 7661 6c75 6520 6973  ersion`.value is
+0000f5f0: 2065 6974 6865 7220 616e 2060 696e 7460   either an `int`
+0000f600: 2069 6620 7468 6520 7374 7265 616d 2065   if the stream e
+0000f610: 7869 7374 732c 206f 7220 604e 6f6e 6560  xists, or `None`
+0000f620: 2069 6620 7468 6520 7374 7265 616d 2064   if the stream d
+0000f630: 6f65 7320 6e6f 7420 6578 6973 740a 616e  oes not exist.an
+0000f640: 6420 6e6f 206d 6574 6164 6174 6120 6861  d no metadata ha
+0000f650: 7320 6265 656e 2073 6574 2e20 5468 6573  s been set. Thes
+0000f660: 6520 7661 6c75 6573 2063 616e 2062 6520  e values can be 
+0000f670: 7061 7373 6564 2069 6e74 6f20 6073 6574  passed into `set
+0000f680: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
+0000f690: 2829 602e 0a0a 0a23 2323 2053 6574 2073  ()`....### Set s
+0000f6a0: 7472 6561 6d20 6d65 7461 6461 7461 0a0a  tream metadata..
+0000f6b0: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+0000f6c0: 2a0a 0a54 6865 206d 6574 686f 6420 6073  *..The method `s
+0000f6d0: 6574 5f73 7472 6561 6d5f 6d65 7461 6461  et_stream_metada
+0000f6e0: 7461 2829 6020 7365 7473 2074 6865 206d  ta()` sets the m
+0000f6f0: 6574 6164 6174 6120 666f 7220 6120 7374  etadata for a st
+0000f700: 7265 616d 2e20 5374 7265 616d 206d 6574  ream. Stream met
+0000f710: 6164 6174 610a 6361 6e20 6265 2073 6574  adata.can be set
+0000f720: 2062 6566 6f72 6520 6170 7065 6e64 696e   before appendin
+0000f730: 6720 6576 656e 7473 2074 6f20 6120 7374  g events to a st
+0000f740: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+0000f750: 0a6d 6574 6164 6174 615b 2266 6f6f 225d  .metadata["foo"]
+0000f760: 203d 2022 6261 7222 0a0a 636c 6965 6e74   = "bar"..client
+0000f770: 2e73 6574 5f73 7472 6561 6d5f 6d65 7461  .set_stream_meta
+0000f780: 6461 7461 280a 2020 2020 7374 7265 616d  data(.    stream
+0000f790: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000f7a0: 6531 2c0a 2020 2020 6d65 7461 6461 7461  e1,.    metadata
+0000f7b0: 3d6d 6574 6164 6174 612c 0a20 2020 2063  =metadata,.    c
+0000f7c0: 7572 7265 6e74 5f76 6572 7369 6f6e 3d6d  urrent_version=m
+0000f7d0: 6574 6164 6174 615f 7665 7273 696f 6e2c  etadata_version,
+0000f7e0: 0a29 0a60 6060 0a0a 5468 6520 6063 7572  .).```..The `cur
+0000f7f0: 7265 6e74 5f76 6572 7369 6f6e 6020 6172  rent_version` ar
+0000f800: 6775 6d65 6e74 2073 686f 756c 6420 6265  gument should be
+0000f810: 2074 6865 2063 7572 7265 6e74 2076 6572   the current ver
+0000f820: 7369 6f6e 206f 6620 7468 6520 7374 7265  sion of the stre
+0000f830: 616d 206d 6574 6164 6174 610a 6f62 7461  am metadata.obta
+0000f840: 696e 6564 2066 726f 6d20 6067 6574 5f73  ined from `get_s
+0000f850: 7472 6561 6d5f 6d65 7461 6461 7461 2829  tream_metadata()
+0000f860: 602e 0a0a 506c 6561 7365 2072 6566 6572  `...Please refer
+0000f870: 2074 6f20 7468 6520 4576 656e 7453 746f   to the EventSto
+0000f880: 7265 4442 2064 6f63 756d 656e 7461 7469  reDB documentati
+0000f890: 6f6e 2066 6f72 206d 6f72 6520 696e 666f  on for more info
+0000f8a0: 726d 6174 696f 6e20 6162 6f75 7420 7374  rmation about st
+0000f8b0: 7265 616d 0a6d 6574 6164 6174 612e 0a0a  ream.metadata...
+0000f8c0: 2323 2320 4465 6c65 7465 2073 7472 6561  ### Delete strea
+0000f8d0: 6d0a 0a2a 7265 7175 6972 6573 206c 6561  m..*requires lea
+0000f8e0: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
+0000f8f0: 2060 6465 6c65 7465 5f73 7472 6561 6d28   `delete_stream(
+0000f900: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
+0000f910: 6f20 2264 656c 6574 6522 2061 2073 7472  o "delete" a str
+0000f920: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
+0000f930: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+0000f940: 3d20 636c 6965 6e74 2e64 656c 6574 655f  = client.delete_
+0000f950: 7374 7265 616d 2873 7472 6561 6d5f 6e61  stream(stream_na
+0000f960: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
+0000f970: 2063 7572 7265 6e74 5f76 6572 7369 6f6e   current_version
+0000f980: 3d32 290a 6060 600a 0a41 6674 6572 2064  =2).```..After d
+0000f990: 656c 6574 696e 6720 6120 7374 7265 616d  eleting a stream
+0000f9a0: 2c20 6974 2773 2073 7469 6c6c 2070 6f73  , it's still pos
+0000f9b0: 7369 626c 6520 746f 2061 7070 656e 6420  sible to append 
+0000f9c0: 6e65 7720 6576 656e 7473 2e20 5265 6164  new events. Read
+0000f9d0: 696e 6720 6672 6f6d 2061 0a64 656c 6574  ing from a.delet
+0000f9e0: 6564 2073 7472 6561 6d20 7769 6c6c 2072  ed stream will r
+0000f9f0: 6574 7572 6e20 6f6e 6c79 2065 7665 6e74  eturn only event
+0000fa00: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
+0000fa10: 2061 7070 656e 6465 6420 6166 7465 7220   appended after 
+0000fa20: 6974 2077 6173 0a64 656c 6574 6564 2e0a  it was.deleted..
+0000fa30: 0a23 2323 2054 6f6d 6273 746f 6e65 2073  .### Tombstone s
+0000fa40: 7472 6561 6d0a 0a2a 7265 7175 6972 6573  tream..*requires
+0000fa50: 206c 6561 6465 722a 0a0a 5468 6520 6d65   leader*..The me
+0000fa60: 7468 6f64 2060 746f 6d62 7374 6f6e 655f  thod `tombstone_
+0000fa70: 7374 7265 616d 2829 6020 6361 6e20 6265  stream()` can be
+0000fa80: 2075 7365 6420 746f 2022 746f 6d62 7374   used to "tombst
+0000fa90: 6f6e 6522 2061 2073 7472 6561 6d2e 0a0a  one" a stream...
+0000faa0: 6060 6070 7974 686f 6e0a 636f 6d6d 6974  ```python.commit
+0000fab0: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
+0000fac0: 6e74 2e74 6f6d 6273 746f 6e65 5f73 7472  nt.tombstone_str
+0000fad0: 6561 6d28 7374 7265 616d 5f6e 616d 653d  eam(stream_name=
+0000fae0: 7374 7265 616d 5f6e 616d 6531 2c20 6375  stream_name1, cu
+0000faf0: 7272 656e 745f 7665 7273 696f 6e3d 3229  rrent_version=2)
+0000fb00: 0a60 6060 0a0a 4166 7465 7220 746f 6d62  .```..After tomb
+0000fb10: 7374 6f6e 696e 6720 6120 7374 7265 616d  stoning a stream
+0000fb20: 2c20 6974 2773 206e 6f74 2070 6f73 7369  , it's not possi
+0000fb30: 626c 6520 746f 2061 7070 656e 6420 6e65  ble to append ne
+0000fb40: 7720 6576 656e 7473 2e0a 0a0a 2323 2043  w events....## C
+0000fb50: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000fb60: 7469 6f6e 730a 0a41 2022 6361 7463 682d  tions..A "catch-
+0000fb70: 7570 2220 7375 6273 6372 6970 7469 6f6e  up" subscription
+0000fb80: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0000fb90: 7265 6365 6976 6520 6576 656e 7473 2074  receive events t
+0000fba0: 6861 7420 6861 7665 2061 6c72 6561 6479  hat have already
+0000fbb0: 2062 6565 6e0a 7265 636f 7264 6564 2069   been.recorded i
+0000fbc0: 6e20 7468 6520 6461 7461 6261 7365 2c20  n the database, 
+0000fbd0: 616e 6420 616c 736f 2065 7665 6e74 7320  and also events 
+0000fbe0: 7468 6174 2061 7265 2072 6563 6f72 6465  that are recorde
+0000fbf0: 6420 7375 6273 6571 7565 6e74 6c79 2e0a  d subsequently..
+0000fc00: 0a54 6865 2060 7375 6273 6372 6962 655f  .The `subscribe_
+0000fc10: 616c 6c5f 6576 656e 7473 2829 6020 6d65  all_events()` me
+0000fc20: 7468 6f64 2073 7461 7274 7320 6120 6361  thod starts a ca
+0000fc30: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+0000fc40: 696f 6e20 7468 6174 2063 616e 2072 6563  ion that can rec
+0000fc50: 6569 7665 0a61 6c6c 2065 7665 6e74 7320  eive.all events 
+0000fc60: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+0000fc70: 2054 6865 2060 7375 6273 6372 6962 655f   The `subscribe_
+0000fc80: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+0000fc90: 206d 6574 686f 6420 7374 6172 7473 2061   method starts a
+0000fca0: 2063 6174 6368 2d75 700a 7375 6273 6372   catch-up.subscr
+0000fcb0: 6970 7469 6f6e 2074 6861 7420 6361 6e20  iption that can 
+0000fcc0: 7265 6365 6976 6520 6576 656e 7473 2066  receive events f
+0000fcd0: 726f 6d20 6120 7370 6563 6966 6963 2073  rom a specific s
+0000fce0: 7472 6561 6d2e 0a0a 5468 6520 6073 7562  tream...The `sub
+0000fcf0: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
+0000fd00: 7328 2960 2061 6e64 2060 7375 6273 6372  s()` and `subscr
+0000fd10: 6962 655f 7374 7265 616d 5f65 7665 6e74  ibe_stream_event
+0000fd20: 7328 2960 206d 6574 686f 6473 2062 6f74  s()` methods bot
+0000fd30: 6820 7265 7475 726e 2061 0a22 7265 6164  h return a."read
+0000fd40: 2072 6573 706f 6e73 6522 2069 7465 7261   response" itera
+0000fd50: 746f 722c 206d 7563 6820 6c69 6b65 2060  tor, much like `
+0000fd60: 6974 6572 5f73 7472 6561 6d5f 6576 656e  iter_stream_even
+0000fd70: 7473 2829 6020 616e 6420 6072 6561 645f  ts()` and `read_
+0000fd80: 616c 6c5f 6576 656e 7473 2829 602e 0a54  all_events()`..T
+0000fd90: 6865 2064 6966 6665 7265 6e63 6520 6973  he difference is
+0000fda0: 2074 6865 2022 7265 6164 2072 6573 706f   the "read respo
+0000fdb0: 6e73 6522 2069 7465 7261 746f 7220 7265  nse" iterator re
+0000fdc0: 7475 726e 6564 2066 6f72 2061 2063 6174  turned for a cat
+0000fdd0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+0000fde0: 6f6e 0a64 6f65 7320 6e6f 7420 6175 746f  on.does not auto
+0000fdf0: 6d61 7469 6361 6c6c 7920 7374 6f70 2077  matically stop w
+0000fe00: 6865 6e20 7468 6572 6520 6172 6520 6e6f  hen there are no
+0000fe10: 206d 6f72 6520 7265 636f 7264 6564 2065   more recorded e
+0000fe20: 7665 6e74 7320 746f 2062 6520 7265 7475  vents to be retu
+0000fe30: 726e 6564 2c20 6275 740a 696e 7374 6561  rned, but.instea
+0000fe40: 6420 626c 6f63 6b73 206f 6e20 6765 7474  d blocks on gett
+0000fe50: 696e 6720 7468 6520 6e65 7874 2065 7665  ing the next eve
+0000fe60: 6e74 2075 6e74 696c 2066 7572 7468 6572  nt until further
+0000fe70: 2065 7665 6e74 7320 6172 6520 7265 636f   events are reco
+0000fe80: 7264 6564 2069 6e20 7468 650a 6461 7461  rded in the.data
+0000fe90: 6261 7365 2e20 5468 6573 6520 7375 6273  base. These subs
+0000fea0: 6571 7565 6e74 6c79 2072 6563 6f72 6465  equently recorde
+0000feb0: 6420 6576 656e 7473 2077 696c 6c20 7468  d events will th
+0000fec0: 656e 2062 6520 7374 7265 616d 6564 2074  en be streamed t
+0000fed0: 6f20 7468 6520 6974 6572 6174 6f72 2c0a  o the iterator,.
+0000fee0: 7768 6963 6820 7769 6c6c 2074 6865 6e20  which will then 
+0000fef0: 636f 6e74 696e 7565 2e20 4c69 6b65 2060  continue. Like `
+0000ff00: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+0000ff10: 2960 2c20 7468 6520 7265 7475 726e 6564  )`, the returned
+0000ff20: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+0000ff30: 2068 6173 0a61 2060 7374 6f70 2829 6020   has.a `stop()` 
+0000ff40: 6d65 7468 6f64 2077 6869 6368 2077 696c  method which wil
+0000ff50: 6c20 6361 6e63 656c 2074 6865 2073 7472  l cancel the str
+0000ff60: 6561 6d69 6e67 2067 5250 4320 6f70 6572  eaming gRPC oper
+0000ff70: 6174 696f 6e20 616e 6420 6361 7573 6520  ation and cause 
+0000ff80: 7468 650a 2272 6561 6420 7265 7370 6f6e  the."read respon
+0000ff90: 7365 2220 6974 6572 6174 6f72 2074 6f20  se" iterator to 
+0000ffa0: 7374 6f70 2e0a 0a4c 696b 6520 7769 7468  stop...Like with
+0000ffb0: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
+0000ffc0: 656e 7473 2829 6020 616e 6420 6072 6561  ents()` and `rea
+0000ffd0: 645f 616c 6c5f 6576 656e 7473 2829 602c  d_all_events()`,
+0000ffe0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+0000fff0: 656e 7420 6f62 6a65 6374 730a 7265 6365  ent objects.rece
+00010000: 6976 6564 2066 726f 6d20 6120 6361 7463  ived from a catc
+00010010: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+00010020: 6e20 6172 6520 696e 7374 616e 6365 7320  n are instances 
+00010030: 6f66 2074 6865 2060 5265 636f 7264 6564  of the `Recorded
+00010040: 4576 656e 7460 2063 6c61 7373 2e0a 0a23  Event` class...#
+00010050: 2323 2053 7562 7363 7269 6265 2061 6c6c  ## Subscribe all
+00010060: 2065 7665 6e74 730a 0a54 6865 6073 7562   events..The`sub
+00010070: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
+00010080: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
+00010090: 6265 2075 7365 6420 746f 2073 7461 7274  be used to start
+000100a0: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+000100b0: 6372 6970 7469 6f6e 0a66 726f 6d20 7768  cription.from wh
+000100c0: 6963 6820 616c 6c20 6576 656e 7473 2072  ich all events r
+000100d0: 6563 6f72 6465 6420 696e 2074 6865 2064  ecorded in the d
+000100e0: 6174 6162 6173 6520 6361 6e20 6265 2072  atabase can be r
+000100f0: 6563 6569 7665 642e 0a0a 5468 6973 206d  eceived...This m
+00010100: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00010110: 6420 6279 2061 2064 6f77 6e73 7472 6561  d by a downstrea
+00010120: 6d20 636f 6d70 6f6e 656e 7420 7468 6174  m component that
+00010130: 2070 726f 6365 7373 6573 2072 6563 6f72   processes recor
+00010140: 6465 6420 6576 656e 7473 2077 6974 680a  ded events with.
+00010150: 6578 6163 746c 792d 6f6e 6365 2073 656d  exactly-once sem
+00010160: 616e 7469 6373 2e0a 0a54 6869 7320 6d65  antics...This me
+00010170: 7468 6f64 2072 6574 7572 6e73 2061 2022  thod returns a "
+00010180: 7265 6164 2072 6573 706f 6e73 6522 2c20  read response", 
+00010190: 6672 6f6d 2077 6869 6368 2072 6563 6f72  from which recor
+000101a0: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
+000101b0: 650a 6f62 7461 696e 6564 2062 7920 6974  e.obtained by it
+000101c0: 6572 6174 696f 6e2c 2069 6e63 6c75 6469  eration, includi
+000101d0: 6e67 2065 7665 6e74 7320 7468 6174 2061  ng events that a
+000101e0: 7265 2072 6563 6f72 6465 6420 6166 7465  re recorded afte
+000101f0: 7220 616c 6c20 7468 650a 7265 636f 7264  r all the.record
+00010200: 6564 2065 7665 6e74 7320 6861 7665 2062  ed events have b
+00010210: 6565 6e20 7265 6365 6976 6564 2e20 4974  een received. It
+00010220: 6572 6174 696e 6720 6f76 6572 2074 6869  erating over thi
+00010230: 7320 2272 6561 6420 7265 7370 6f6e 7365  s "read response
+00010240: 220a 6f62 6a65 6374 2077 696c 6c20 7468  ".object will th
+00010250: 6572 6566 6f72 6520 6e6f 7420 7374 6f70  erefore not stop
+00010260: 2c20 756e 6c65 7373 2074 6865 2060 7374  , unless the `st
+00010270: 6f70 2829 6020 6d65 7468 6f64 206f 6620  op()` method of 
+00010280: 7468 650a 2272 6561 6420 7265 7370 6f6e  the."read respon
+00010290: 7365 2220 6f62 6a65 6374 2069 7320 6361  se" object is ca
+000102a0: 6c6c 6564 2c20 6f72 2061 2063 6f6e 6e65  lled, or a conne
+000102b0: 6374 696f 6e20 6973 7375 6520 6f63 6375  ction issue occu
+000102c0: 7273 2c20 6f72 0a74 6865 2072 6574 7572  rs, or.the retur
+000102d0: 6e65 6420 6f62 6a65 6374 2069 7465 7261  ned object itera
+000102e0: 746f 7220 6f62 6a65 6374 2069 7320 6465  tor object is de
+000102f0: 6c65 7465 6420 6672 6f6d 206d 656d 6f72  leted from memor
+00010300: 792e 0a0a 5468 6973 206d 6574 686f 6420  y...This method 
+00010310: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+00010320: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00010330: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+00010340: 6820 6361 6e20 6265 0a75 7365 6420 746f  h can be.used to
+00010350: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
+00010360: 7420 706f 7369 7469 6f6e 2066 726f 6d20  t position from 
+00010370: 7768 6963 6820 746f 2073 7562 7363 7269  which to subscri
+00010380: 6265 2e20 5468 6520 6465 6661 756c 740a  be. The default.
+00010390: 7661 6c75 6520 6973 2060 4e6f 6e65 602c  value is `None`,
+000103a0: 2077 6869 6368 206d 6561 6e73 2074 6865   which means the
+000103b0: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+000103c0: 6c6c 206f 7065 7261 7465 2066 726f 6d20  ll operate from 
+000103d0: 7468 6520 6669 7273 740a 7265 636f 7264  the first.record
+000103e0: 6564 2065 7665 6e74 2069 6e20 7468 6520  ed event in the 
+000103f0: 6461 7461 6261 7365 2e20 4966 2061 2063  database. If a c
+00010400: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
+00010410: 7320 6769 7665 6e2c 2069 7420 6d75 7374  s given, it must
+00010420: 206d 6174 6368 0a61 6e20 6163 7475 616c   match.an actual
+00010430: 6c79 2065 7869 7374 696e 6720 636f 6d6d  ly existing comm
+00010440: 6974 2070 6f73 6974 696f 6e20 696e 2074  it position in t
+00010450: 6865 2064 6174 6162 6173 652e 2054 6865  he database. The
+00010460: 2072 6563 6f64 6564 2065 7665 6e74 7320   recoded events 
+00010470: 7468 6174 0a61 7265 206f 6274 6169 6e65  that.are obtaine
+00010480: 6420 7769 6c6c 206e 6f74 2069 6e63 6c75  d will not inclu
+00010490: 6465 2074 6865 2065 7665 6e74 2072 6563  de the event rec
+000104a0: 6f72 6465 6420 6174 2074 6861 7420 636f  orded at that co
+000104b0: 6d6d 6974 2070 6f73 6974 696f 6e2e 0a0a  mmit position...
+000104c0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+000104d0: 2068 6173 2066 6f75 7220 6f74 6865 7220   has four other 
+000104e0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+000104f0: 7473 2c20 6066 696c 7465 725f 6578 636c  ts, `filter_excl
+00010500: 7564 6560 2c0a 6066 696c 7465 725f 696e  ude`,.`filter_in
+00010510: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
+00010520: 6279 5f73 7472 6561 6d5f 6e61 6d65 602c  by_stream_name`,
+00010530: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
+00010540: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00010550: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
+00010560: 7267 756d 656e 7420 6973 2061 2073 6571  rgument is a seq
+00010570: 7565 6e63 6520 6f66 2072 6567 756c 6172  uence of regular
+00010580: 2065 7870 7265 7373 696f 6e73 2074 6861   expressions tha
+00010590: 740a 7370 6563 6966 6965 7320 7768 6963  t.specifies whic
+000105a0: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+000105b0: 7320 7368 6f75 6c64 2062 6520 7265 7475  s should be retu
+000105c0: 726e 6564 2e20 5468 6973 2061 7267 756d  rned. This argum
+000105d0: 656e 7420 6973 2069 676e 6f72 6564 0a69  ent is ignored.i
+000105e0: 6620 6066 696c 7465 725f 696e 636c 7564  f `filter_includ
+000105f0: 6560 2069 7320 7365 7420 746f 2061 206e  e` is set to a n
+00010600: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
+00010610: 652e 2054 6865 2064 6566 6175 6c74 2076  e. The default v
+00010620: 616c 7565 206f 6620 7468 6973 0a61 7267  alue of this.arg
+00010630: 756d 656e 7420 6d61 7463 6865 7320 7468  ument matches th
+00010640: 6520 6576 656e 7420 7479 7065 7320 6f66  e event types of
+00010650: 2045 7665 6e74 5374 6f72 6544 4220 2273   EventStoreDB "s
+00010660: 7973 7465 6d20 6576 656e 7473 222c 2073  ystem events", s
+00010670: 6f20 7468 6174 2073 7973 7465 6d0a 6576  o that system.ev
+00010680: 656e 7473 2077 696c 6c20 6e6f 7420 6e6f  ents will not no
+00010690: 726d 616c 6c79 2062 6520 696e 636c 7564  rmally be includ
+000106a0: 6564 2e20 5365 6520 7468 6520 4e6f 7465  ed. See the Note
+000106b0: 7320 7365 6374 696f 6e20 6265 6c6f 7720  s section below 
+000106c0: 666f 7220 6d6f 7265 0a69 6e66 6f72 6d61  for more.informa
+000106d0: 7469 6f6e 2061 626f 7574 2066 696c 7465  tion about filte
+000106e0: 7220 6578 7072 6573 7369 6f6e 732e 0a0a  r expressions...
+000106f0: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
+00010700: 6c74 6572 5f69 6e63 6c75 6465 6020 6172  lter_include` ar
+00010710: 6775 6d65 6e74 2069 7320 6120 7365 7175  gument is a sequ
+00010720: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
+00010730: 6578 7072 6573 7369 6f6e 730a 7468 6174  expressions.that
+00010740: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
+00010750: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00010760: 2073 686f 756c 6420 6265 2072 6574 7572   should be retur
+00010770: 6e65 642e 2042 7920 6465 6661 756c 742c  ned. By default,
+00010780: 2074 6869 730a 6172 6775 6d65 6e74 2069   this.argument i
+00010790: 7320 616e 2065 6d70 7479 2074 7570 6c65  s an empty tuple
+000107a0: 2e20 4966 2074 6869 7320 6172 6775 6d65  . If this argume
+000107b0: 6e74 2069 7320 7365 7420 746f 2061 206e  nt is set to a n
+000107c0: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
+000107d0: 652c 0a74 6865 2060 6669 6c74 6572 5f65  e,.the `filter_e
+000107e0: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+000107f0: 2069 7320 6967 6e6f 7265 642e 0a0a 5468   is ignored...Th
+00010800: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
+00010810: 6572 5f62 795f 7374 7265 616d 5f6e 616d  er_by_stream_nam
+00010820: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+00010830: 2050 7974 686f 6e20 6062 6f6f 6c60 2074   Python `bool` t
+00010840: 6861 7420 696e 6469 6361 7465 730a 7768  hat indicates.wh
+00010850: 6574 6865 7220 7468 6520 6669 6c74 6572  ether the filter
+00010860: 696e 6720 7769 6c6c 2061 7070 6c79 2074  ing will apply t
+00010870: 6f20 6576 656e 7420 7479 7065 7320 6f72  o event types or
+00010880: 2073 7472 6561 6d20 6e61 6d65 732e 2042   stream names. B
+00010890: 7920 6465 6661 756c 742c 2074 6869 730a  y default, this.
+000108a0: 7661 6c75 6520 6973 2060 4661 6c73 6560  value is `False`
+000108b0: 2061 6e64 2073 6f20 7468 6520 6669 6c74   and so the filt
+000108c0: 6572 696e 6720 7769 6c6c 2061 7070 6c79  ering will apply
+000108d0: 2074 6f20 7468 6520 6576 656e 7420 7479   to the event ty
+000108e0: 7065 2073 7472 696e 6773 206f 660a 7265  pe strings of.re
+000108f0: 636f 7264 6564 2065 7665 6e74 732e 0a0a  corded events...
+00010900: 5468 6520 6f70 7469 6f6e 616c 2060 7469  The optional `ti
+00010910: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
+00010920: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
+00010930: 6174 6020 7768 6963 6820 7365 7473 2061  at` which sets a
+00010940: 0a64 6561 646c 696e 6520 666f 7220 7468  .deadline for th
+00010950: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+00010960: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+00010970: 6f6e 2e0a 0a54 6865 2065 7861 6d70 6c65  on...The example
+00010980: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
+00010990: 2074 6f20 7374 6172 7420 6120 6361 7463   to start a catc
+000109a0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+000109b0: 6e20 746f 2072 6563 6569 7665 0a66 726f  n to receive.fro
+000109c0: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
+000109d0: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
+000109e0: 6520 6461 7461 6261 7365 2e0a 0a60 6060  e database...```
+000109f0: 7079 7468 6f6e 0a23 2053 7562 7363 7269  python.# Subscri
+00010a00: 6265 2066 726f 6d20 7468 6520 6669 7273  be from the firs
+00010a10: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+00010a20: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+00010a30: 2e0a 7375 6273 6372 6970 7469 6f6e 203d  ..subscription =
+00010a40: 2063 6c69 656e 742e 7375 6273 6372 6962   client.subscrib
+00010a50: 655f 616c 6c5f 6576 656e 7473 2829 0a60  e_all_events().`
+00010a60: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
+00010a70: 6265 6c6f 7720 6973 206c 6f6e 6765 722c  below is longer,
+00010a80: 2061 6e64 2073 686f 7773 2074 6861 7420   and shows that 
+00010a90: 7468 6520 6361 7463 682d 7570 2073 7562  the catch-up sub
+00010aa0: 7363 7269 7074 696f 6e0a 646f 6573 206e  scription.does n
+00010ab0: 6f74 2073 746f 7020 6175 746f 6d61 7469  ot stop automati
+00010ac0: 6361 6c6c 792c 2062 7574 2062 6c6f 636b  cally, but block
+00010ad0: 7320 7768 656e 2074 6865 206c 6173 7420  s when the last 
+00010ae0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+00010af0: 730a 7265 6365 6976 6564 2c20 616e 6420  s.received, and 
+00010b00: 7468 656e 2063 6f6e 7469 6e75 6573 2077  then continues w
+00010b10: 6865 6e20 7375 6273 6571 7565 6e74 2065  hen subsequent e
+00010b20: 7665 6e74 7320 6172 6520 7265 636f 7264  vents are record
+00010b30: 6564 2e0a 0a60 6060 7079 7468 6f6e 0a23  ed...```python.#
+00010b40: 2041 7070 656e 6420 6120 6e65 7720 6576   Append a new ev
+00010b50: 656e 7420 746f 2061 206e 6577 2073 7472  ent to a new str
+00010b60: 6561 6d2e 0a73 7472 6561 6d5f 6e61 6d65  eam..stream_name
+00010b70: 3220 3d20 7374 7228 7575 6964 2e75 7569  2 = str(uuid.uui
+00010b80: 6434 2829 290a 6576 656e 7434 203d 204e  d4()).event4 = N
+00010b90: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
+00010ba0: 6465 7243 7265 6174 6564 272c 2064 6174  derCreated', dat
+00010bb0: 613d 6227 6461 7461 3427 290a 636c 6965  a=b'data4').clie
+00010bc0: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+00010bd0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+00010be0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
+00010bf0: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+00010c00: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 6576  ion=None,.    ev
+00010c10: 656e 7473 3d5b 6576 656e 7434 5d2c 0a29  ents=[event4],.)
+00010c20: 0a0a 2320 5375 6273 6372 6962 6520 6672  ..# Subscribe fr
+00010c30: 6f6d 2074 6865 2066 6972 7374 2072 6563  om the first rec
+00010c40: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
+00010c50: 6865 2064 6174 6162 6173 652e 0a73 7562  he database..sub
+00010c60: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
+00010c70: 6e74 2e73 7562 7363 7269 6265 5f61 6c6c  nt.subscribe_all
+00010c80: 5f65 7665 6e74 7328 290a 7265 6365 6976  _events().receiv
+00010c90: 6564 5f65 7665 6e74 7320 3d20 5b5d 0a0a  ed_events = []..
+00010ca0: 0a23 2052 6563 6569 7665 2065 7665 6e74  .# Receive event
+00010cb0: 7320 6672 6f6d 2074 6865 2063 6174 6368  s from the catch
+00010cc0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00010cd0: 2069 6e20 6120 6469 6666 6572 656e 7420   in a different 
+00010ce0: 7468 7265 6164 2e0a 6672 6f6d 2064 6174  thread..from dat
+00010cf0: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
+00010d00: 6574 696d 650a 6672 6f6d 2074 6872 6561  etime.from threa
+00010d10: 6469 6e67 2069 6d70 6f72 7420 5468 7265  ding import Thre
+00010d20: 6164 0a0a 6d61 726b 203d 2064 6174 6574  ad..mark = datet
+00010d30: 696d 652e 6e6f 7728 290a 0a64 6566 2072  ime.now()..def r
+00010d40: 6563 6569 7665 5f65 7665 6e74 7328 293a  eceive_events():
+00010d50: 0a20 2020 2066 6f72 2065 7665 6e74 2069  .    for event i
+00010d60: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
+00010d70: 2020 2020 2020 2020 7265 6365 6976 6564          received
+00010d80: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
+00010d90: 7665 6e74 290a 2020 2020 2020 2020 676c  vent).        gl
+00010da0: 6f62 616c 206d 6172 6b0a 2020 2020 2020  obal mark.      
+00010db0: 2020 6d61 726b 203d 2064 6174 6574 696d    mark = datetim
+00010dc0: 652e 6e6f 7728 290a 0a0a 6465 6620 7761  e.now()...def wa
+00010dd0: 6974 5f66 6f72 5f73 7562 7363 7269 7074  it_for_subscript
+00010de0: 696f 6e5f 746f 5f62 6c6f 636b 2829 3a0a  ion_to_block():.
+00010df0: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
+00010e00: 2020 2020 2020 2020 2069 6620 2864 6174           if (dat
+00010e10: 6574 696d 652e 6e6f 7728 2920 2d20 6d61  etime.now() - ma
+00010e20: 726b 292e 746f 7461 6c5f 7365 636f 6e64  rk).total_second
+00010e30: 7328 2920 3e20 313a 0a20 2020 2020 2020  s() > 1:.       
+00010e40: 2020 2020 2020 6272 6561 6b0a 0a0a 7468        break...th
+00010e50: 7265 6164 203d 2054 6872 6561 6428 7461  read = Thread(ta
+00010e60: 7267 6574 3d72 6563 6569 7665 5f65 7665  rget=receive_eve
+00010e70: 6e74 7329 0a74 6872 6561 642e 7374 6172  nts).thread.star
+00010e80: 7428 290a 0a23 2057 6169 7420 666f 7220  t()..# Wait for 
+00010e90: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00010ea0: 2074 6f20 626c 6f63 6b2e 0a77 6169 745f   to block..wait_
+00010eb0: 666f 725f 7375 6273 6372 6970 7469 6f6e  for_subscription
+00010ec0: 5f74 6f5f 626c 6f63 6b28 290a 0a23 2043  _to_block()..# C
+00010ed0: 6865 636b 2074 6865 206c 6173 7420 7265  heck the last re
+00010ee0: 6365 6976 6564 2065 7665 6e74 2069 7320  ceived event is 
+00010ef0: 2765 7665 6e74 3427 2e0a 6173 7365 7274  'event4'..assert
+00010f00: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+00010f10: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
+00010f20: 342e 6964 0a0a 2320 4368 6563 6b20 7765  4.id..# Check we
+00010f30: 2061 6c73 6f20 7265 6365 6976 6564 2074   also received t
+00010f40: 6865 206f 7468 6572 2065 7665 6e74 7320  he other events 
+00010f50: 7765 2068 6176 6520 7265 636f 7264 6564  we have recorded
+00010f60: 2e0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
+00010f70: 645f 6576 656e 7473 5b2d 395d 2e69 6420  d_events[-9].id 
+00010f80: 3d3d 2065 7665 6e74 312e 6964 0a61 7373  == event1.id.ass
+00010f90: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
+00010fa0: 6e74 735b 2d38 5d2e 6964 203d 3d20 6576  nts[-8].id == ev
+00010fb0: 656e 7432 2e69 640a 6173 7365 7274 2072  ent2.id.assert r
+00010fc0: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+00010fd0: 375d 2e69 6420 3d3d 2065 7665 6e74 332e  7].id == event3.
+00010fe0: 6964 0a61 7373 6572 7420 7265 6365 6976  id.assert receiv
+00010ff0: 6564 5f65 7665 6e74 735b 2d36 5d2e 7479  ed_events[-6].ty
+00011000: 7065 203d 3d20 2244 6f67 5265 6769 7374  pe == "DogRegist
+00011010: 6572 6564 220a 6173 7365 7274 2072 6563  ered".assert rec
+00011020: 6569 7665 645f 6576 656e 7473 5b2d 355d  eived_events[-5]
+00011030: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+00011040: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
+00011050: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00011060: 735b 2d34 5d2e 7479 7065 203d 3d20 2244  s[-4].type == "D
+00011070: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
+00011080: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+00011090: 6576 656e 7473 5b2d 335d 2e74 7970 6520  events[-3].type 
+000110a0: 3d3d 2022 536e 6170 7368 6f74 220a 6173  == "Snapshot".as
+000110b0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+000110c0: 656e 7473 5b2d 325d 2e74 7970 6520 3d3d  ents[-2].type ==
+000110d0: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+000110e0: 6b22 0a0a 2320 4170 7065 6e64 2061 6e6f  k"..# Append ano
+000110f0: 7468 6572 2065 7665 6e74 2077 6869 6c73  ther event whils
+00011100: 7420 7468 6520 7375 6273 6372 6970 7469  t the subscripti
+00011110: 6f6e 2069 7320 7275 6e6e 696e 672e 0a6d  on is running..m
+00011120: 6172 6b20 3d20 6461 7465 7469 6d65 2e6e  ark = datetime.n
+00011130: 6f77 2829 0a65 7665 6e74 3520 3d20 4e65  ow().event5 = Ne
+00011140: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
+00011150: 6572 5570 6461 7465 6427 2c20 6461 7461  erUpdated', data
+00011160: 3d62 2764 6174 6135 2729 0a63 6c69 656e  =b'data5').clien
+00011170: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+00011180: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00011190: 3d73 7472 6561 6d5f 6e61 6d65 322c 0a20  =stream_name2,. 
+000111a0: 2020 2063 7572 7265 6e74 5f76 6572 7369     current_versi
+000111b0: 6f6e 3d30 2c0a 2020 2020 6576 656e 7473  on=0,.    events
+000111c0: 3d5b 6576 656e 7435 5d2c 0a29 0a0a 2320  =[event5],.)..# 
+000111d0: 5761 6974 2066 6f72 2074 6865 2073 7562  Wait for the sub
+000111e0: 7363 7269 7074 696f 6e20 746f 2062 6c6f  scription to blo
+000111f0: 636b 2e0a 7761 6974 5f66 6f72 5f73 7562  ck..wait_for_sub
+00011200: 7363 7269 7074 696f 6e5f 746f 5f62 6c6f  scription_to_blo
+00011210: 636b 2829 0a0a 2320 4368 6563 6b20 7468  ck()..# Check th
+00011220: 6520 6c61 7374 2072 6563 6569 7665 6420  e last received 
+00011230: 6576 656e 7420 6973 2027 6576 656e 7435  event is 'event5
+00011240: 272e 0a61 7373 6572 7420 7265 6365 6976  '..assert receiv
+00011250: 6564 5f65 7665 6e74 735b 2d32 5d2e 6964  ed_events[-2].id
+00011260: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
+00011270: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+00011280: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
+00011290: 7665 6e74 352e 6964 0a0a 2320 5374 6f70  vent5.id..# Stop
+000112a0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+000112b0: 6e2e 0a73 7562 7363 7269 7074 696f 6e2e  n..subscription.
+000112c0: 7374 6f70 2829 0a74 6872 6561 642e 6a6f  stop().thread.jo
+000112d0: 696e 2829 0a60 6060 0a0a 5468 6520 6578  in().```..The ex
+000112e0: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+000112f0: 7320 686f 7720 746f 2073 7461 7274 2061  s how to start a
+00011300: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+00011310: 6970 7469 6f6e 2074 6f0a 7265 6365 6976  iption to.receiv
+00011320: 6520 6672 6f6d 2061 2070 6172 7469 6375  e from a particu
+00011330: 6c61 7220 636f 6d6d 6974 2070 6f73 6974  lar commit posit
+00011340: 696f 6e2c 2069 6e20 7468 6973 2063 6173  ion, in this cas
+00011350: 6520 6672 6f6d 2074 6865 0a63 6f6d 6d69  e from the.commi
+00011360: 7420 706f 7369 7469 6f6e 206f 6620 7468  t position of th
+00011370: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
+00011380: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
+00011390: 6563 6569 7665 6420 6162 6f76 652e 0a41  eceived above..A
+000113a0: 6e6f 7468 6572 2065 7665 6e74 2069 7320  nother event is 
+000113b0: 7265 636f 7264 6564 2062 6566 6f72 6520  recorded before 
+000113c0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+000113d0: 2069 7320 7265 7374 6172 7465 642e 0a46   is restarted..F
+000113e0: 7572 7468 6572 2065 7665 6e74 7320 6172  urther events ar
+000113f0: 6520 7265 636f 7264 6564 2077 6869 6c73  e recorded whils
+00011400: 7420 7468 6520 7375 6273 6372 6970 7469  t the subscripti
+00011410: 6f6e 2069 7320 7275 6e6e 696e 672e 0a41  on is running..A
+00011420: 6c6c 2074 6865 2072 6563 6f72 6465 6420  ll the recorded 
+00011430: 6576 656e 7473 2061 7265 2072 6563 6569  events are recei
+00011440: 7665 6420 6578 6163 746c 7920 6f6e 6365  ved exactly once
+00011450: 2e0a 0a60 6060 7079 7468 6f6e 0a0a 2320  ...```python..# 
+00011460: 4170 7065 6e64 2061 6e6f 7468 6572 2065  Append another e
+00011470: 7665 6e74 2e0a 6576 656e 7436 203d 204e  vent..event6 = N
+00011480: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
+00011490: 6465 7244 656c 6574 6564 272c 2064 6174  derDeleted', dat
+000114a0: 613d 6227 6461 7461 3627 290a 636c 6965  a=b'data6').clie
+000114b0: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
+000114c0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+000114d0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
+000114e0: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
+000114f0: 696f 6e3d 312c 0a20 2020 2065 7665 6e74  ion=1,.    event
+00011500: 733d 5b65 7665 6e74 365d 2c0a 290a 0a23  s=[event6],.)..#
+00011510: 2052 6573 756d 6520 7375 6273 6372 6962   Resume subscrib
+00011520: 696e 6720 6672 6f6d 2074 6865 2063 6f6d  ing from the com
+00011530: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+00011540: 7468 6520 6c61 7374 2072 6563 6569 7665  the last receive
+00011550: 6420 6576 656e 742e 0a73 7562 7363 7269  d event..subscri
+00011560: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+00011570: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
+00011580: 6e74 7328 0a20 2020 2063 6f6d 6d69 745f  nts(.    commit_
+00011590: 706f 7369 7469 6f6e 3d72 6563 6569 7665  position=receive
+000115a0: 645f 6576 656e 7473 5b2d 315d 2e63 6f6d  d_events[-1].com
+000115b0: 6d69 745f 706f 7369 7469 6f6e 0a29 0a0a  mit_position.)..
+000115c0: 6d61 726b 203d 2064 6174 6574 696d 652e  mark = datetime.
+000115d0: 6e6f 7728 290a 7468 7265 6164 203d 2054  now().thread = T
+000115e0: 6872 6561 6428 7461 7267 6574 3d72 6563  hread(target=rec
+000115f0: 6569 7665 5f65 7665 6e74 7329 0a74 6872  eive_events).thr
+00011600: 6561 642e 7374 6172 7428 290a 0a23 2057  ead.start()..# W
+00011610: 6169 7420 666f 7220 7468 6520 7375 6273  ait for the subs
+00011620: 6372 6970 7469 6f6e 2074 6f20 626c 6f63  cription to bloc
+00011630: 6b2e 0a77 6169 745f 666f 725f 7375 6273  k..wait_for_subs
+00011640: 6372 6970 7469 6f6e 5f74 6f5f 626c 6f63  cription_to_bloc
+00011650: 6b28 290a 0a23 2043 6865 636b 2074 6865  k()..# Check the
+00011660: 206c 6173 7420 7265 6365 6976 6564 2065   last received e
+00011670: 7665 6e74 2077 6173 2027 6576 656e 7436  vent was 'event6
+00011680: 272e 0a61 7373 6572 7420 7265 6365 6976  '..assert receiv
+00011690: 6564 5f65 7665 6e74 735b 2d33 5d2e 6964  ed_events[-3].id
+000116a0: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
+000116b0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+000116c0: 656e 7473 5b2d 325d 2e69 6420 3d3d 2065  ents[-2].id == e
+000116d0: 7665 6e74 352e 6964 0a61 7373 6572 7420  vent5.id.assert 
+000116e0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+000116f0: 2d31 5d2e 6964 203d 3d20 6576 656e 7436  -1].id == event6
+00011700: 2e69 640a 0a23 2041 7070 656e 6420 7468  .id..# Append th
+00011710: 7265 6520 6d6f 7265 2065 7665 6e74 7320  ree more events 
+00011720: 746f 2061 206e 6577 2073 7472 6561 6d2e  to a new stream.
+00011730: 0a6d 6172 6b20 3d20 6461 7465 7469 6d65  .mark = datetime
+00011740: 2e6e 6f77 2829 0a73 7472 6561 6d5f 6e61  .now().stream_na
+00011750: 6d65 3320 3d20 7374 7228 7575 6964 2e75  me3 = str(uuid.u
+00011760: 7569 6434 2829 290a 6576 656e 7437 203d  uid4()).event7 =
+00011770: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+00011780: 4f72 6465 7243 7265 6174 6564 272c 2064  OrderCreated', d
+00011790: 6174 613d 6227 6461 7461 3727 290a 6576  ata=b'data7').ev
+000117a0: 656e 7438 203d 204e 6577 4576 656e 7428  ent8 = NewEvent(
+000117b0: 7479 7065 3d27 4f72 6465 7255 7064 6174  type='OrderUpdat
+000117c0: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
+000117d0: 3827 290a 6576 656e 7439 203d 204e 6577  8').event9 = New
+000117e0: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
+000117f0: 7244 656c 6574 6564 272c 2064 6174 613d  rDeleted', data=
+00011800: 6227 6461 7461 3927 290a 0a63 6c69 656e  b'data9')..clien
+00011810: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+00011820: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00011830: 3d73 7472 6561 6d5f 6e61 6d65 332c 0a20  =stream_name3,. 
+00011840: 2020 2063 7572 7265 6e74 5f76 6572 7369     current_versi
+00011850: 6f6e 3d4e 6f6e 652c 0a20 2020 2065 7665  on=None,.    eve
+00011860: 6e74 733d 5b65 7665 6e74 372c 2065 7665  nts=[event7, eve
+00011870: 6e74 382c 2065 7665 6e74 395d 2c0a 290a  nt8, event9],.).
+00011880: 0a23 2057 6169 7420 666f 7220 7468 6520  .# Wait for the 
+00011890: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
+000118a0: 626c 6f63 6b2e 0a77 6169 745f 666f 725f  block..wait_for_
+000118b0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+000118c0: 626c 6f63 6b28 290a 0a0a 2320 4368 6563  block()...# Chec
+000118d0: 6b20 616c 6c20 7468 6520 6576 656e 7473  k all the events
+000118e0: 2068 6176 6520 6265 656e 2072 6563 6569   have been recei
+000118f0: 7665 6420 6578 6163 746c 7920 6f6e 6365  ved exactly once
+00011900: 2e0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
+00011910: 645f 6576 656e 7473 5b2d 365d 2e69 6420  d_events[-6].id 
+00011920: 3d3d 2065 7665 6e74 342e 6964 0a61 7373  == event4.id.ass
+00011930: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
+00011940: 6e74 735b 2d35 5d2e 6964 203d 3d20 6576  nts[-5].id == ev
+00011950: 656e 7435 2e69 640a 6173 7365 7274 2072  ent5.id.assert r
+00011960: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+00011970: 345d 2e69 6420 3d3d 2065 7665 6e74 362e  4].id == event6.
+00011980: 6964 0a61 7373 6572 7420 7265 6365 6976  id.assert receiv
+00011990: 6564 5f65 7665 6e74 735b 2d33 5d2e 6964  ed_events[-3].id
+000119a0: 203d 3d20 6576 656e 7437 2e69 640a 6173   == event7.id.as
+000119b0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+000119c0: 656e 7473 5b2d 325d 2e69 6420 3d3d 2065  ents[-2].id == e
+000119d0: 7665 6e74 382e 6964 0a61 7373 6572 7420  vent8.id.assert 
+000119e0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+000119f0: 2d31 5d2e 6964 203d 3d20 6576 656e 7439  -1].id == event9
+00011a00: 2e69 640a 0a23 2053 746f 7020 7468 6520  .id..# Stop the 
+00011a10: 7375 6273 6372 6970 7469 6f6e 2e0a 7375  subscription..su
+00011a20: 6273 6372 6970 7469 6f6e 2e73 746f 7028  bscription.stop(
+00011a30: 290a 7468 7265 6164 2e6a 6f69 6e28 290a  ).thread.join().
+00011a40: 6060 600a 0a54 6865 2063 6174 6368 2d75  ```..The catch-u
+00011a50: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
+00011a60: 616c 6c20 6973 2065 6e64 6564 2061 7320  all is ended as 
+00011a70: 736f 6f6e 2061 7320 7468 6520 7375 6273  soon as the subs
+00011a80: 6372 6970 7469 6f6e 206f 626a 6563 7427  cription object'
+00011a90: 730a 6073 746f 7028 2960 206d 6574 686f  s.`stop()` metho
+00011aa0: 6420 6973 2063 616c 6c65 642e 2054 6869  d is called. Thi
+00011ab0: 7320 6861 7070 656e 7320 6175 746f 6d61  s happens automa
+00011ac0: 7469 6361 6c6c 7920 7768 656e 2069 7420  tically when it 
+00011ad0: 676f 6573 206f 7574 206f 6620 7363 6f70  goes out of scop
+00011ae0: 652c 0a6f 7220 7768 656e 2069 7420 6973  e,.or when it is
+00011af0: 2065 7870 6c69 6369 746c 7920 6465 6c65   explicitly dele
+00011b00: 7465 6420 6672 6f6d 206d 656d 6f72 7920  ted from memory 
+00011b10: 7573 696e 6720 7468 6520 5079 7468 6f6e  using the Python
+00011b20: 2060 6465 6c60 206b 6579 776f 7264 2e0a   `del` keyword..
+00011b30: 0a23 2323 2053 7562 7363 7269 6265 2073  .### Subscribe s
+00011b40: 7472 6561 6d20 6576 656e 7473 0a0a 5468  tream events..Th
+00011b50: 6520 6073 7562 7363 7269 6265 5f73 7472  e `subscribe_str
+00011b60: 6561 6d5f 6576 656e 7473 2829 6020 6d65  eam_events()` me
+00011b70: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00011b80: 2074 6f20 7374 6172 7420 6120 6361 7463   to start a catc
+00011b90: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+00011ba0: 6e0a 7468 6174 2063 616e 2072 6574 7572  n.that can retur
+00011bb0: 6e20 6576 656e 7473 2074 6861 7420 6172  n events that ar
+00011bc0: 6520 7265 636f 7264 6564 2069 6e20 6120  e recorded in a 
+00011bd0: 7369 6e67 6c65 2073 7472 6561 6d2e 0a0a  single stream...
+00011be0: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00011bf0: 6120 7265 7175 6972 6564 2060 7374 7265  a required `stre
+00011c00: 616d 5f6e 616d 6560 2061 7267 756d 656e  am_name` argumen
+00011c10: 742c 2077 6869 6368 2073 7065 6369 6669  t, which specifi
+00011c20: 6573 2074 6865 206e 616d 6520 6f66 2074  es the name of t
+00011c30: 6865 0a73 7472 6561 6d20 6672 6f6d 2077  he.stream from w
+00011c40: 6869 6368 2072 6563 6f72 6465 6420 6576  hich recorded ev
+00011c50: 656e 7473 2077 696c 6c20 6265 2072 6563  ents will be rec
+00011c60: 6569 7665 642e 0a0a 5468 6973 206d 6574  eived...This met
+00011c70: 686f 6420 616c 736f 2068 6173 2074 776f  hod also has two
+00011c80: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00011c90: 6e74 732c 2060 7374 7265 616d 5f70 6f73  nts, `stream_pos
+00011ca0: 6974 696f 6e60 2c20 616e 6420 6074 696d  ition`, and `tim
+00011cb0: 656f 7574 602e 0a0a 5468 6520 6f70 7469  eout`...The opti
+00011cc0: 6f6e 616c 2060 7374 7265 616d 5f70 6f73  onal `stream_pos
+00011cd0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+00011ce0: 7370 6563 6966 6965 7320 6120 706f 7369  specifies a posi
+00011cf0: 7469 6f6e 2069 6e20 7468 6520 7374 7265  tion in the stre
+00011d00: 616d 2066 726f 6d20 7768 6963 680a 7265  am from which.re
+00011d10: 636f 7264 6564 2065 7665 6e74 7320 7769  corded events wi
+00011d20: 6c6c 2062 6520 7265 6365 6976 6564 2e20  ll be received. 
+00011d30: 5468 6520 6576 656e 7420 6174 2074 6865  The event at the
+00011d40: 2073 7065 6369 6669 6564 2073 7472 6561   specified strea
+00011d50: 6d20 706f 7369 7469 6f6e 2077 696c 6c20  m position will 
+00011d60: 6e6f 740a 6265 2069 6e63 6c75 6465 642e  not.be included.
+00011d70: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+00011d80: 7565 206f 6620 6073 7472 6561 6d5f 706f  ue of `stream_po
+00011d90: 7369 7469 6f6e 6020 6973 2060 4e6f 6e65  sition` is `None
+00011da0: 602c 2077 6869 6368 206d 6561 6e73 2074  `, which means t
+00011db0: 6865 0a73 7562 7363 7269 7074 696f 6e20  he.subscription 
+00011dc0: 7769 6c6c 2073 7461 7274 2066 726f 6d20  will start from 
+00011dd0: 7468 6520 6669 7273 7420 7265 636f 7264  the first record
+00011de0: 6564 2065 7665 6e74 2069 6e20 7468 6520  ed event in the 
+00011df0: 7374 7265 616d 2e0a 0a54 6865 206f 7074  stream...The opt
+00011e00: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00011e10: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00011e20: 7468 6f6e 2060 666c 6f61 7460 2074 6861  thon `float` tha
+00011e30: 7420 7365 7473 0a61 2064 6561 646c 696e  t sets.a deadlin
+00011e40: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+00011e50: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00011e60: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+00011e70: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00011e80: 686f 7773 2068 6f77 2074 6f20 7374 6172  hows how to star
+00011e90: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
+00011ea0: 7363 7269 7074 696f 6e20 6672 6f6d 0a74  scription from.t
+00011eb0: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
+00011ec0: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
+00011ed0: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
+00011ee0: 2320 5375 6273 6372 6962 6520 6672 6f6d  # Subscribe from
+00011ef0: 2074 6865 2073 7461 7274 206f 6620 2773   the start of 's
+00011f00: 7472 6561 6d32 272e 0a73 7562 7363 7269  tream2'..subscri
+00011f10: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+00011f20: 7562 7363 7269 6265 5f73 7472 6561 6d5f  ubscribe_stream_
+00011f30: 6576 656e 7473 2873 7472 6561 6d5f 6e61  events(stream_na
+00011f40: 6d65 3d73 7472 6561 6d5f 6e61 6d65 3229  me=stream_name2)
+00011f50: 0a60 6060 0a0a 5468 6520 6578 616d 706c  .```..The exampl
+00011f60: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
+00011f70: 7720 746f 2073 7461 7274 2061 2063 6174  w to start a cat
+00011f80: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00011f90: 6f6e 2066 726f 6d0a 6120 7061 7274 6963  on from.a partic
+00011fa0: 756c 6172 2073 7472 6561 6d20 706f 7369  ular stream posi
+00011fb0: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
+00011fc0: 0a23 2053 7562 7363 7269 6265 2074 6f20  .# Subscribe to 
+00011fd0: 7374 7265 616d 322c 2066 726f 6d20 7468  stream2, from th
+00011fe0: 6520 7365 636f 6e64 2072 6563 6f72 6465  e second recorde
+00011ff0: 6420 6576 656e 742e 0a73 7562 7363 7269  d event..subscri
+00012000: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+00012010: 7562 7363 7269 6265 5f73 7472 6561 6d5f  ubscribe_stream_
+00012020: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
+00012030: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00012040: 616d 6532 2c0a 2020 2020 7374 7265 616d  ame2,.    stream
+00012050: 5f70 6f73 6974 696f 6e3d 312c 0a29 0a60  _position=1,.).`
+00012060: 6060 0a0a 2323 2320 486f 7720 746f 2069  ``..### How to i
+00012070: 6d70 6c65 6d65 6e74 2065 7861 6374 6c79  mplement exactly
+00012080: 2d6f 6e63 6520 6576 656e 7420 7072 6f63  -once event proc
+00012090: 6573 7369 6e67 0a0a 5468 6520 636f 6d6d  essing..The comm
+000120a0: 6974 2070 6f73 6974 696f 6e73 206f 6620  it positions of 
+000120b0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+000120c0: 7468 6174 2061 7265 2072 6563 6569 7665  that are receive
+000120d0: 6420 616e 6420 7072 6f63 6573 7365 6420  d and processed 
+000120e0: 6279 2061 0a64 6f77 6e73 7472 6561 6d20  by a.downstream 
+000120f0: 636f 6d70 6f6e 656e 7420 6172 6520 7573  component are us
+00012100: 6566 756c 6c79 2072 6563 6f72 6465 6420  efully recorded 
+00012110: 6279 2074 6865 2064 6f77 6e73 7472 6561  by the downstrea
+00012120: 6d20 636f 6d70 6f6e 656e 742c 2073 6f20  m component, so 
+00012130: 7468 6174 0a74 6865 2063 6f6d 6d69 7420  that.the commit 
+00012140: 706f 7369 7469 6f6e 206f 6620 6c61 7374  position of last
+00012150: 2070 726f 6365 7373 6564 2065 7665 6e74   processed event
+00012160: 2063 616e 2062 6520 6465 7465 726d 696e   can be determin
+00012170: 6564 2077 6865 6e20 7072 6f63 6573 7369  ed when processi
+00012180: 6e67 2069 730a 7265 7375 6d65 642e 0a0a  ng is.resumed...
+00012190: 5468 6520 6c61 7374 2072 6563 6f72 6465  The last recorde
+000121a0: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
+000121b0: 6e20 6361 6e20 6265 2075 7365 6420 746f  n can be used to
+000121c0: 2073 7065 6369 6679 2074 6865 2063 6f6d   specify the com
+000121d0: 6d69 7420 706f 7369 7469 6f6e 2066 726f  mit position fro
+000121e0: 6d20 7768 6963 680a 746f 2073 7562 7363  m which.to subsc
+000121f0: 7269 6265 2077 6865 6e20 7072 6f63 6573  ribe when proces
+00012200: 7369 6e67 2069 7320 7265 7375 6d65 642e  sing is resumed.
+00012210: 2053 696e 6365 2074 6869 7320 636f 6d6d   Since this comm
+00012220: 6974 2070 6f73 6974 696f 6e20 7769 6c6c  it position will
+00012230: 2072 6570 7265 7365 6e74 2074 6865 0a70   represent the.p
+00012240: 6f73 6974 696f 6e20 6f66 2074 6865 206c  osition of the l
+00012250: 6173 7420 7375 6363 6573 7366 756c 6c79  ast successfully
+00012260: 2070 726f 6365 7373 6564 2065 7665 6e74   processed event
+00012270: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
+00012280: 2063 6f6d 706f 6e65 6e74 2c20 736f 2069   component, so i
+00012290: 740a 7769 6c6c 2062 6520 7573 7561 6c20  t.will be usual 
+000122a0: 746f 2077 616e 7420 7468 6520 6e65 7874  to want the next
+000122b0: 2065 7665 6e74 2061 6674 6572 2074 6869   event after thi
+000122c0: 7320 706f 7369 7469 6f6e 2c20 6265 6361  s position, beca
+000122d0: 7573 6520 7468 6174 2069 7320 7468 6520  use that is the 
+000122e0: 6e65 7874 0a65 7665 6e74 2074 6861 7420  next.event that 
+000122f0: 6861 7320 6e6f 7420 7965 7420 6265 656e  has not yet been
+00012300: 2070 726f 6365 7373 6564 2e20 466f 7220   processed. For 
+00012310: 7468 6973 2072 6561 736f 6e2c 2077 6865  this reason, whe
+00012320: 6e20 7375 6273 6372 6962 696e 6720 666f  n subscribing fo
+00012330: 7220 6576 656e 7473 0a66 726f 6d20 6120  r events.from a 
+00012340: 7370 6563 6966 6963 2063 6f6d 6d69 7420  specific commit 
+00012350: 706f 7369 7469 6f6e 2075 7369 6e67 2061  position using a
+00012360: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+00012370: 6970 7469 6f6e 2069 6e20 4576 656e 7453  iption in EventS
+00012380: 746f 7265 4442 2c20 7468 650a 7265 636f  toreDB, the.reco
+00012390: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
+000123a0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
+000123b0: 6974 2070 6f73 6974 696f 6e20 7769 6c6c  it position will
+000123c0: 204e 4f54 2062 6520 696e 636c 7564 6564   NOT be included
+000123d0: 2069 6e20 7468 6520 7365 7175 656e 6365   in the sequence
+000123e0: 0a6f 6620 7265 636f 7264 6564 2065 7665  .of recorded eve
+000123f0: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
+00012400: 6569 7665 642e 0a0a 546f 2061 6363 6f6d  eived...To accom
+00012410: 706c 6973 6820 2265 7861 6374 6c79 2d6f  plish "exactly-o
+00012420: 6e63 6522 2070 726f 6365 7373 696e 6720  nce" processing 
+00012430: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+00012440: 7473 2069 6e20 6120 646f 776e 7374 7265  ts in a downstre
+00012450: 616d 0a63 6f6d 706f 6e65 6e74 2077 6865  am.component whe
+00012460: 6e20 7573 696e 6720 6120 6361 7463 682d  n using a catch-
+00012470: 7570 2073 7562 7363 7269 7074 696f 6e2c  up subscription,
+00012480: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+00012490: 7469 6f6e 206f 6620 6120 7265 636f 7264  tion of a record
+000124a0: 6564 0a65 7665 6e74 2073 686f 756c 6420  ed.event should 
+000124b0: 6265 2072 6563 6f72 6465 6420 6174 6f6d  be recorded atom
+000124c0: 6963 616c 6c79 2061 6e64 2075 6e69 7175  ically and uniqu
+000124d0: 656c 7920 616c 6f6e 6720 7769 7468 2074  ely along with t
+000124e0: 6865 2072 6573 756c 7420 6f66 2070 726f  he result of pro
+000124f0: 6365 7373 696e 670a 7265 636f 7264 6564  cessing.recorded
+00012500: 2065 7665 6e74 732c 2066 6f72 2065 7861   events, for exa
+00012510: 6d70 6c65 2069 6e20 7468 6520 7361 6d65  mple in the same
+00012520: 2064 6174 6162 6173 6520 6173 206d 6174   database as mat
+00012530: 6572 6961 6c69 7365 6420 7669 6577 7320  erialised views 
+00012540: 7768 656e 0a69 6d70 6c65 6d65 6e74 696e  when.implementin
+00012550: 6720 6576 656e 7475 616c 6c79 2d63 6f6e  g eventually-con
+00012560: 7369 7374 656e 7420 4351 5253 2c20 6f72  sistent CQRS, or
+00012570: 2069 6e20 7468 6520 7361 6d65 2064 6174   in the same dat
+00012580: 6162 6173 6520 6173 2061 2064 6f77 6e73  abase as a downs
+00012590: 7472 6561 6d0a 616e 616c 7974 6963 7320  tream.analytics 
+000125a0: 6f72 2072 6570 6f72 7469 6e67 206f 7220  or reporting or 
+000125b0: 6172 6368 6976 696e 6720 6170 706c 6963  archiving applic
+000125c0: 6174 696f 6e2e 2042 7920 7265 636f 7264  ation. By record
+000125d0: 696e 6720 7468 6520 636f 6d6d 6974 2070  ing the commit p
+000125e0: 6f73 6974 696f 6e0a 6f66 2072 6563 6f72  osition.of recor
+000125f0: 6465 6420 6576 656e 7473 2061 746f 6d69  ded events atomi
+00012600: 6361 6c6c 7920 7769 7468 2074 6865 206e  cally with the n
+00012610: 6577 2073 7461 7465 2074 6861 7420 7265  ew state that re
+00012620: 7375 6c74 7320 6672 6f6d 2070 726f 6365  sults from proce
+00012630: 7373 696e 670a 7265 636f 7264 6564 2065  ssing.recorded e
+00012640: 7665 6e74 732c 2022 6475 616c 2077 7269  vents, "dual wri
+00012650: 7469 6e67 2220 696e 2074 6865 2063 6f6e  ting" in the con
+00012660: 7375 6d70 7469 6f6e 206f 6620 7265 636f  sumption of reco
+00012670: 7264 6564 2065 7665 6e74 7320 6361 6e20  rded events can 
+00012680: 6265 0a61 766f 6964 6564 2e20 4279 2061  be.avoided. By a
+00012690: 6c73 6f20 7265 636f 7264 696e 6720 7468  lso recording th
+000126a0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+000126b0: 6e20 756e 6971 7565 6c79 2c20 7468 6520  n uniquely, the 
+000126c0: 6e65 7720 7374 6174 6520 6361 6e6e 6f74  new state cannot
+000126d0: 2062 650a 7265 636f 7264 6564 2074 7769   be.recorded twi
+000126e0: 6365 2c20 616e 6420 6865 6e63 6520 7468  ce, and hence th
+000126f0: 6520 7265 636f 7264 6564 2073 7461 7465  e recorded state
+00012700: 206f 6620 7468 6520 646f 776e 7374 7265   of the downstre
+00012710: 616d 2063 6f6d 706f 6e65 6e74 2077 696c  am component wil
+00012720: 6c20 6265 0a75 7064 6174 6564 206f 6e6c  l be.updated onl
+00012730: 7920 6f6e 6365 2066 6f72 2061 6e79 2072  y once for any r
+00012740: 6563 6f72 6465 6420 6576 656e 742e 2042  ecorded event. B
+00012750: 7920 7573 696e 6720 7468 6520 6772 6561  y using the grea
+00012760: 7465 7374 2072 6563 6f72 6465 6420 636f  test recorded co
+00012770: 6d6d 6974 0a70 6f73 6974 696f 6e20 746f  mmit.position to
+00012780: 2072 6573 756d 6520 6120 6361 7463 682d   resume a catch-
+00012790: 7570 2073 7562 7363 7269 7074 696f 6e2c  up subscription,
+000127a0: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
+000127b0: 656e 7473 2077 696c 6c20 6576 656e 7475  ents will eventu
+000127c0: 616c 6c79 0a62 6520 7072 6f63 6573 7365  ally.be processe
+000127d0: 642e 2054 6865 2063 6f6d 6269 6e61 7469  d. The combinati
+000127e0: 6f6e 206f 6620 7468 6520 2261 742d 6d6f  on of the "at-mo
+000127f0: 7374 2d6f 6e63 6522 2063 6f6e 6469 7469  st-once" conditi
+00012800: 6f6e 2061 6e64 2074 6865 2022 6174 2d6c  on and the "at-l
+00012810: 6561 7374 2d6f 6e63 6522 0a63 6f6e 6469  east-once".condi
+00012820: 7469 6f6e 2067 6976 6573 2074 6865 2022  tion gives the "
+00012830: 6578 6163 746c 792d 6f6e 6365 2220 636f  exactly-once" co
+00012840: 6e64 6974 696f 6e2e 0a0a 5468 6520 6461  ndition...The da
+00012850: 6e67 6572 2077 6974 6820 2264 7561 6c20  nger with "dual 
+00012860: 7772 6974 696e 6722 2069 6e20 7468 6520  writing" in the 
+00012870: 636f 6e73 756d 7074 696f 6e20 6f66 2072  consumption of r
+00012880: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+00012890: 7320 7468 6174 2069 6620 610a 7265 636f  s that if a.reco
+000128a0: 7264 6564 2065 7665 6e74 2069 7320 7375  rded event is su
+000128b0: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
+000128c0: 7373 6564 2061 6e64 206e 6577 2073 7461  ssed and new sta
+000128d0: 7465 2072 6563 6f72 6465 6420 6174 6f6d  te recorded atom
+000128e0: 6963 616c 6c79 2069 6e20 6f6e 650a 7472  ically in one.tr
+000128f0: 616e 7361 6374 696f 6e20 7769 7468 2074  ansaction with t
+00012900: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+00012910: 6f6e 2072 6563 6f72 6465 6420 696e 2061  on recorded in a
+00012920: 2073 6570 6172 6174 6520 7472 616e 7361   separate transa
+00012930: 6374 696f 6e2c 206f 6e65 206d 6179 0a68  ction, one may.h
+00012940: 6170 7065 6e20 616e 6420 6e6f 7420 7468  appen and not th
+00012950: 6520 6f74 6865 722e 2049 6620 7468 6520  e other. If the 
+00012960: 6e65 7720 7374 6174 6520 6973 2072 6563  new state is rec
+00012970: 6f72 6465 6420 6275 7420 7468 6520 706f  orded but the po
+00012980: 7369 7469 6f6e 2069 7320 6c6f 7374 2c0a  sition is lost,.
+00012990: 616e 6420 7468 656e 2074 6865 2070 726f  and then the pro
+000129a0: 6365 7373 696e 6720 6973 2073 746f 7070  cessing is stopp
+000129b0: 6564 2061 6e64 2072 6573 756d 6564 2c20  ed and resumed, 
+000129c0: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+000129d0: 6e74 206d 6179 2062 6520 7072 6f63 6573  nt may be proces
+000129e0: 7365 640a 7477 6963 652e 204f 6e20 7468  sed.twice. On th
+000129f0: 6520 6f74 6865 7220 6861 6e64 2c20 6966  e other hand, if
+00012a00: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+00012a10: 7469 6f6e 2069 7320 7265 636f 7264 6564  tion is recorded
+00012a20: 2062 7574 2074 6865 206e 6577 2073 7461   but the new sta
+00012a30: 7465 2069 730a 6c6f 7374 2c20 7468 6520  te is.lost, the 
+00012a40: 7265 636f 7264 6564 2065 7665 6e74 206d  recorded event m
+00012a50: 6179 2065 6666 6563 7469 7665 6c79 206e  ay effectively n
+00012a60: 6f74 2062 6520 7072 6f63 6573 7365 6420  ot be processed 
+00012a70: 6174 2061 6c6c 2e20 4279 2065 6974 6865  at all. By eithe
+00012a80: 720a 7072 6f63 6573 7369 6e67 2061 6e20  r.processing an 
+00012a90: 6576 656e 7420 6d6f 7265 2074 6861 6e20  event more than 
+00012aa0: 6f6e 6365 2c20 6f72 2062 7920 6661 696c  once, or by fail
+00012ab0: 696e 6720 746f 2070 726f 6365 7373 2061  ing to process a
+00012ac0: 6e20 6576 656e 742c 2074 6865 2072 6563  n event, the rec
+00012ad0: 6f72 6465 640a 7374 6174 6520 6f66 2074  orded.state of t
+00012ae0: 6865 2064 6f77 6e73 7472 6561 6d20 636f  he downstream co
+00012af0: 6d70 6f6e 656e 7420 6d69 6768 7420 6265  mponent might be
+00012b00: 2069 6e61 6363 7572 6174 652c 206f 7220   inaccurate, or 
+00012b10: 706f 7373 6962 6c79 2069 6e63 6f6e 7369  possibly inconsi
+00012b20: 7374 656e 742c 2061 6e64 0a70 6572 6861  stent, and.perha
+00012b30: 7073 2063 6174 6173 7472 6f70 6869 6361  ps catastrophica
+00012b40: 6c6c 7920 736f 2e20 5375 6368 2063 6f6e  lly so. Such con
+00012b50: 7365 7175 656e 6365 7320 6d61 7920 6f72  sequences may or
+00012b60: 206d 6179 206e 6f74 206d 6174 7465 7220   may not matter 
+00012b70: 696e 2079 6f75 7220 7369 7475 6174 696f  in your situatio
+00012b80: 6e2e 0a42 7574 2073 6f6d 6574 696d 6573  n..But sometimes
+00012b90: 2069 6e63 6f6e 7369 7374 656e 6369 6573   inconsistencies
+00012ba0: 206d 6179 2068 616c 7420 7072 6f63 6573   may halt proces
+00012bb0: 7369 6e67 2075 6e74 696c 2074 6865 2069  sing until the i
+00012bc0: 7373 7565 2069 7320 7265 736f 6c76 6564  ssue is resolved
+00012bd0: 2e20 596f 7520 6361 6e0a 6176 6f69 6420  . You can.avoid 
+00012be0: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
+00012bf0: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
+00012c00: 6e20 6f66 2065 7665 6e74 7320 6279 2061  n of events by a
+00012c10: 746f 6d69 6361 6c6c 7920 7265 636f 7264  tomically record
+00012c20: 696e 6720 7468 6520 636f 6d6d 6974 0a70  ing the commit.p
+00012c30: 6f73 6974 696f 6e20 6f66 2061 2072 6563  osition of a rec
+00012c40: 6f72 6465 6420 6576 656e 7420 616c 6f6e  orded event alon
+00012c50: 6720 7769 7468 2074 6865 206e 6577 2073  g with the new s
+00012c60: 7461 7465 2074 6861 7420 7265 7375 6c74  tate that result
+00012c70: 7320 6672 6f6d 2070 726f 6365 7373 696e  s from processin
+00012c80: 6720 7468 6174 0a65 7665 6e74 2069 6e20  g that.event in 
+00012c90: 7468 6520 7361 6d65 2061 746f 6d69 6320  the same atomic 
+00012ca0: 7472 616e 7361 6374 696f 6e2e 2042 7920  transaction. By 
+00012cb0: 6d61 6b69 6e67 2074 6865 2072 6563 6f72  making the recor
+00012cc0: 6469 6e67 206f 6620 7468 6520 636f 6d6d  ding of the comm
+00012cd0: 6974 2070 6f73 6974 696f 6e73 0a75 6e69  it positions.uni
+00012ce0: 7175 652c 2073 6f20 7468 6174 2074 7261  que, so that tra
+00012cf0: 6e73 6163 7469 6f6e 7320 7769 6c6c 2062  nsactions will b
+00012d00: 6520 726f 6c6c 6564 2062 6163 6b20 7768  e rolled back wh
+00012d10: 656e 2074 6865 7265 2069 7320 6120 636f  en there is a co
+00012d20: 6e66 6c69 6374 2c20 796f 7520 7769 6c6c  nflict, you will
+00012d30: 0a70 7265 7665 6e74 2074 6865 2072 6573  .prevent the res
+00012d40: 756c 7473 206f 6620 616e 7920 6475 706c  ults of any dupl
+00012d50: 6963 6174 6520 7072 6f63 6573 7369 6e67  icate processing
+00012d60: 206f 6620 6120 7265 636f 7264 6564 2065   of a recorded e
+00012d70: 7665 6e74 2062 6569 6e67 2063 6f6d 6d69  vent being commi
+00012d80: 7474 6564 2e0a 0a52 6563 6f72 6465 6420  tted...Recorded 
+00012d90: 6576 656e 7473 2072 6563 6569 7665 6420  events received 
+00012da0: 6672 6f6d 2061 2063 6174 6368 2d75 7020  from a catch-up 
+00012db0: 7375 6273 6372 6970 7469 6f6e 2063 616e  subscription can
+00012dc0: 6e6f 7420 6265 2061 636b 6e6f 776c 6564  not be acknowled
+00012dd0: 6765 6420 6261 636b 0a74 6f20 7468 6520  ged back.to the 
+00012de0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00012df0: 7665 722e 2041 636b 6e6f 776c 6564 6769  ver. Acknowledgi
+00012e00: 6e67 2065 7665 6e74 732c 2068 6f77 6576  ng events, howev
+00012e10: 6572 2c20 6973 2061 6e20 6173 7065 6374  er, is an aspect
+00012e20: 206f 6620 2270 6572 7369 7374 656e 740a   of "persistent.
+00012e30: 7375 6273 6372 6970 7469 6f6e 7322 2e20  subscriptions". 
+00012e40: 486f 7069 6e67 2074 6f20 7265 6c79 206f  Hoping to rely o
+00012e50: 6e20 6163 6b6e 6f77 6c65 6467 696e 6720  n acknowledging 
+00012e60: 6576 656e 7473 2074 6f20 616e 2075 7073  events to an ups
+00012e70: 7472 6561 6d0a 636f 6d70 6f6e 656e 7420  tream.component 
+00012e80: 6973 2061 6e20 6578 616d 706c 6520 6f66  is an example of
+00012e90: 2064 7561 6c20 7772 6974 696e 672e 0a0a   dual writing...
+00012ea0: 0a23 2320 5065 7273 6973 7465 6e74 2073  .## Persistent s
+00012eb0: 7562 7363 7269 7074 696f 6e73 0a0a 496e  ubscriptions..In
+00012ec0: 2045 7665 6e74 5374 6f72 6544 422c 2022   EventStoreDB, "
+00012ed0: 7065 7273 6973 7465 6e74 2220 7375 6273  persistent" subs
+00012ee0: 6372 6970 7469 6f6e 7320 6172 6520 7369  criptions are si
+00012ef0: 6d69 6c61 7220 746f 2063 6174 6368 2d75  milar to catch-u
+00012f00: 7020 7375 6273 6372 6970 7469 6f6e 732c  p subscriptions,
+00012f10: 0a69 6e20 7468 6174 2072 6561 6469 6e67  .in that reading
+00012f20: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+00012f30: 6273 6372 6970 7469 6f6e 2077 696c 6c20  bscription will 
+00012f40: 626c 6f63 6b20 7768 656e 2074 6865 7265  block when there
+00012f50: 2061 7265 206e 6f20 6d6f 7265 2072 6563   are no more rec
+00012f60: 6f72 6465 640a 6576 656e 7473 2074 6f20  orded.events to 
+00012f70: 6265 2072 6563 6569 7665 642c 2061 6e64  be received, and
+00012f80: 2074 6865 6e20 636f 6e74 696e 7565 2077   then continue w
+00012f90: 6865 6e20 6e65 7720 6576 656e 7473 2061  hen new events a
+00012fa0: 7265 2073 7562 7365 7175 656e 746c 7920  re subsequently 
+00012fb0: 7265 636f 7264 6564 2e0a 0a50 6572 7369  recorded...Persi
+00012fc0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00012fd0: 6f6e 7320 6361 6e0a 0a50 6572 7369 7374  ons can..Persist
+00012fe0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00012ff0: 7320 6361 6e20 6265 2063 6f6e 7375 6d65  s can be consume
+00013000: 6420 6279 2061 2067 726f 7570 206f 6620  d by a group of 
+00013010: 636f 6e73 756d 6572 7320 6f70 6572 6174  consumers operat
+00013020: 696e 6720 7769 7468 206f 6e65 0a6f 6620  ing with one.of 
+00013030: 7468 6520 7375 7070 6f72 7465 6420 2263  the supported "c
+00013040: 6f6e 7375 6d65 7220 7374 7261 7465 6769  onsumer strategi
+00013050: 6573 222e 0a0a 5468 6520 7369 676e 6966  es"...The signif
+00013060: 6963 616e 7420 6469 6666 6572 656e 7420  icant different 
+00013070: 7769 7468 2070 6572 7369 7374 656e 7420  with persistent 
+00013080: 7375 6273 6372 6970 7469 6f6e 7320 6973  subscriptions is
+00013090: 2074 6865 2073 6572 7665 7220 7769 6c6c   the server will
+000130a0: 206b 6565 7020 7472 6163 6b0a 6f66 2074   keep track.of t
+000130b0: 6865 2070 726f 6772 6573 7320 6f66 2074  he progress of t
+000130c0: 6865 2063 6f6e 7375 6d65 7273 2e20 5468  he consumers. Th
+000130d0: 6520 636f 6e73 756d 6572 206f 6620 6120  e consumer of a 
+000130e0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+000130f0: 7269 7074 696f 6e20 7769 6c6c 0a74 6865  ription will.the
+00013100: 7265 666f 7265 206e 6565 6420 746f 2022  refore need to "
+00013110: 6163 6b6e 6f77 6c65 6467 6522 2077 6865  acknowledge" whe
+00013120: 6e20 6120 7265 636f 7264 6564 2065 7665  n a recorded eve
+00013130: 6e74 2068 6173 2062 6565 6e20 7072 6f63  nt has been proc
+00013140: 6573 7365 6420 7375 6363 6573 7366 756c  essed successful
+00013150: 6c79 2c0a 616e 6420 6f74 6865 7277 6973  ly,.and otherwis
+00013160: 6520 226e 6567 6174 6976 656c 7920 6163  e "negatively ac
+00013170: 6b6e 6f77 6c65 6467 6522 2061 2072 6563  knowledge" a rec
+00013180: 6f72 6465 6420 6576 656e 7420 7468 6174  orded event that
+00013190: 2068 6173 2062 6565 6e20 7265 6365 6976   has been receiv
+000131a0: 6564 2062 7574 2077 6173 0a6e 6f74 2073  ed but was.not s
+000131b0: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
+000131c0: 6573 7365 642e 0a0a 416c 6c20 6f66 2074  essed...All of t
+000131d0: 6869 7320 6d65 616e 7320 7468 6174 2066  his means that f
+000131e0: 6f72 2070 6572 7369 7374 656e 7420 7375  or persistent su
+000131f0: 6273 6372 6970 7469 6f6e 7320 7468 6572  bscriptions ther
+00013200: 6520 6172 6520 2263 7265 6174 6522 2c20  e are "create", 
+00013210: 2272 6561 6422 2c20 2275 7064 6174 6522  "read", "update"
+00013220: 0a22 6465 6c65 7465 222c 2022 6163 6b22  ."delete", "ack"
+00013230: 2c20 616e 6420 226e 6163 6b22 206f 7065  , and "nack" ope
+00013240: 7261 7469 6f6e 7320 746f 2063 6f6e 7369  rations to consi
+00013250: 6465 722e 0a0a 5768 696c 7374 2074 6865  der...Whilst the
+00013260: 7265 2061 7265 2073 6f6d 6520 6164 7661  re are some adva
+00013270: 6e74 6167 6573 206f 6620 7065 7273 6973  ntages of persis
+00013280: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00013290: 6e73 2c20 696e 2070 6172 7469 6375 6c61  ns, in particula
+000132a0: 7220 7468 650a 636f 6e63 7572 7265 6e74  r the.concurrent
+000132b0: 2070 726f 6365 7373 696e 6720 6f66 2072   processing of r
+000132c0: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
+000132d0: 7920 6120 6772 6f75 7020 6f66 2063 6f6e  y a group of con
+000132e0: 7375 6d65 7273 2c20 6279 2074 7261 636b  sumers, by track
+000132f0: 696e 6720 696e 0a74 6865 2073 6572 7665  ing in.the serve
+00013300: 7220 7468 6520 706f 7369 7469 6f6e 2069  r the position i
+00013310: 6e20 7468 6520 636f 6d6d 6974 2073 6571  n the commit seq
+00013320: 7565 6e63 6520 6f66 2065 7665 6e74 7320  uence of events 
+00013330: 7468 6174 2068 6176 6520 6265 656e 2070  that have been p
+00013340: 726f 6365 7373 6564 2c0a 7468 6520 6973  rocessed,.the is
+00013350: 7375 6520 6f66 2022 6475 616c 2077 7269  sue of "dual wri
+00013360: 7469 6e67 2220 696e 2074 6865 2063 6f6e  ting" in the con
+00013370: 7375 6d70 7469 6f6e 206f 6620 6576 656e  sumption of even
+00013380: 7473 2061 7269 7365 732e 2052 656c 6961  ts arises. Relia
+00013390: 6269 6c69 7479 2069 6e20 7468 650a 7072  bility in the.pr
+000133a0: 6f63 6573 7369 6e67 206f 6620 7265 636f  ocessing of reco
+000133b0: 7264 6564 2065 7665 6e74 7320 6279 2061  rded events by a
+000133c0: 2067 726f 7570 206f 6620 7065 7273 6973   group of persis
+000133d0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+000133e0: 6e20 636f 6e73 756d 6572 7320 7769 6c6c  n consumers will
+000133f0: 0a72 656c 7920 6f6e 2074 6865 6972 2069  .rely on their i
+00013400: 6465 6d70 6f74 656e 7420 6861 6e64 6c69  dempotent handli
+00013410: 6e67 206f 6620 6475 706c 6963 6174 6520  ng of duplicate 
+00013420: 6d65 7373 6167 6573 2c20 616e 6420 7468  messages, and th
+00013430: 6569 7220 7265 7369 6c69 656e 6365 2074  eir resilience t
+00013440: 6f0a 6f75 742d 6f66 2d6f 7264 6572 2064  o.out-of-order d
+00013450: 656c 6976 6572 792e 0a0a 0a23 2323 2043  elivery....### C
+00013460: 7265 6174 6520 7375 6273 6372 6970 7469  reate subscripti
+00013470: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
+00013480: 6164 6572 2a0a 0a54 6865 2060 6372 6561  ader*..The `crea
+00013490: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+000134a0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+000134b0: 2075 7365 6420 746f 2063 7265 6174 6520   used to create 
+000134c0: 6120 2270 6572 7369 7374 656e 7420 7375  a "persistent su
+000134d0: 6273 6372 6970 7469 6f6e 220a 746f 2061  bscription".to a
+000134e0: 6c6c 2074 6865 2072 6563 6f72 6465 6420  ll the recorded 
+000134f0: 6576 656e 7473 2069 6e20 7468 6520 6461  events in the da
+00013500: 7461 6261 7365 2061 6372 6f73 7320 616c  tabase across al
+00013510: 6c20 7374 7265 616d 732e 0a0a 5468 6973  l streams...This
+00013520: 206d 6574 686f 6420 6861 7320 6120 7265   method has a re
+00013530: 7175 6972 6564 2060 6772 6f75 705f 6e61  quired `group_na
+00013540: 6d65 6020 6172 6775 6d65 6e74 2c20 7768  me` argument, wh
+00013550: 6963 6820 6973 2074 6865 0a6e 616d 6520  ich is the.name 
+00013560: 6f66 2061 2022 6772 6f75 7022 206f 6620  of a "group" of 
+00013570: 636f 6e73 756d 6572 7320 6f66 2074 6865  consumers of the
+00013580: 2073 7562 7363 7269 7074 696f 6e2e 0a0a   subscription...
+00013590: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+000135a0: 2068 6173 2073 6576 656e 206f 7074 696f   has seven optio
+000135b0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+000135c0: 6672 6f6d 5f65 6e64 602c 2060 636f 6d6d  from_end`, `comm
+000135d0: 6974 5f70 6f73 6974 696f 6e60 2c0a 6066  it_position`,.`f
+000135e0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+000135f0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+00013600: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
+00013610: 6561 6d5f 6e61 6d65 602c 2060 636f 6e73  eam_name`, `cons
+00013620: 756d 6572 5f73 7472 6174 6567 7960 2c0a  umer_strategy`,.
+00013630: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
+00013640: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
+00013650: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
+00013660: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00013670: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
+00013680: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+00013690: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
+000136a0: 7269 7074 696f 6e20 7368 6f75 6c64 206f  ription should o
+000136b0: 6e6c 7920 7265 6365 6976 6520 6576 656e  nly receive even
+000136c0: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
+000136d0: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
+000136e0: 7375 6273 6372 6970 7469 6f6e 0a77 6173  subscription.was
+000136f0: 2063 7265 6174 6564 2e0a 0a41 6c74 6572   created...Alter
+00013700: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
+00013710: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
+00013720: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+00013730: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+00013740: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
+00013750: 740a 706f 7369 7469 6f6e 2066 726f 6d20  t.position from 
+00013760: 7768 6963 6820 636f 6d6d 6974 2070 6f73  which commit pos
+00013770: 6974 696f 6e20 7468 6520 6772 6f75 7020  ition the group 
+00013780: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+00013790: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+000137a0: 2073 686f 756c 640a 7265 6365 6976 6520   should.receive 
+000137b0: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
+000137c0: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
+000137d0: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
+000137e0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
+000137f0: 706f 7369 7469 6f6e 206d 6967 6874 0a62  position might.b
+00013800: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
+00013810: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00013820: 7320 7265 6365 6976 6564 2062 7920 7468  s received by th
+00013830: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+00013840: 6d65 7273 2e0a 0a49 6620 6e65 6974 6865  mers...If neithe
+00013850: 7220 6066 726f 6d5f 656e 6460 206f 7220  r `from_end` or 
+00013860: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00013870: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
+00013880: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
+00013890: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
+000138a0: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+000138b0: 2070 6f74 656e 7469 616c 6c79 2072 6563   potentially rec
+000138c0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
+000138d0: 6420 6576 656e 7473 2069 6e20 7468 6520  d events in the 
+000138e0: 6461 7461 6261 7365 2e0a 0a54 6865 206f  database...The o
+000138f0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+00013900: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
+00013910: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+00013920: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+00013930: 7373 696f 6e73 2074 6861 740a 7370 6563  ssions that.spec
+00013940: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
+00013950: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
+00013960: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
+00013970: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+00013980: 2069 676e 6f72 6564 0a69 6620 6066 696c   ignored.if `fil
+00013990: 7465 725f 696e 636c 7564 6560 2069 7320  ter_include` is 
+000139a0: 7365 7420 746f 2061 206e 6f6e 2d65 6d70  set to a non-emp
+000139b0: 7479 2073 6571 7565 6e63 652e 2054 6865  ty sequence. The
+000139c0: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
+000139d0: 6620 7468 6973 0a61 7267 756d 656e 7420  f this.argument 
+000139e0: 6d61 7463 6865 7320 7468 6520 6576 656e  matches the even
+000139f0: 7420 7479 7065 7320 6f66 2045 7665 6e74  t types of Event
+00013a00: 5374 6f72 6544 4220 2273 7973 7465 6d20  StoreDB "system 
+00013a10: 6576 656e 7473 222c 2073 6f20 7468 6174  events", so that
+00013a20: 2073 7973 7465 6d0a 6576 656e 7473 2077   system.events w
+00013a30: 696c 6c20 6e6f 7420 6e6f 726d 616c 6c79  ill not normally
+00013a40: 2062 6520 696e 636c 7564 6564 2e20 5365   be included. Se
+00013a50: 6520 7468 6520 4e6f 7465 7320 7365 6374  e the Notes sect
+00013a60: 696f 6e20 6265 6c6f 7720 666f 7220 6d6f  ion below for mo
+00013a70: 7265 0a69 6e66 6f72 6d61 7469 6f6e 2061  re.information a
+00013a80: 626f 7574 2066 696c 7465 7220 6578 7072  bout filter expr
+00013a90: 6573 7369 6f6e 732e 0a0a 5468 6520 6f70  essions...The op
+00013aa0: 7469 6f6e 616c 2060 6669 6c74 6572 5f69  tional `filter_i
+00013ab0: 6e63 6c75 6465 6020 6172 6775 6d65 6e74  nclude` argument
+00013ac0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+00013ad0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
+00013ae0: 7369 6f6e 730a 7468 6174 2073 7065 6369  sions.that speci
+00013af0: 6669 6573 2077 6869 6368 2072 6563 6f72  fies which recor
+00013b00: 6465 6420 6576 656e 7473 2073 686f 756c  ded events shoul
+00013b10: 6420 6265 2072 6574 7572 6e65 642e 2042  d be returned. B
+00013b20: 7920 6465 6661 756c 742c 2074 6869 730a  y default, this.
+00013b30: 6172 6775 6d65 6e74 2069 7320 616e 2065  argument is an e
+00013b40: 6d70 7479 2074 7570 6c65 2e20 4966 2074  mpty tuple. If t
+00013b50: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
+00013b60: 7365 7420 746f 2061 206e 6f6e 2d65 6d70  set to a non-emp
+00013b70: 7479 2073 6571 7565 6e63 652c 0a74 6865  ty sequence,.the
+00013b80: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
+00013b90: 6020 6172 6775 6d65 6e74 2069 7320 6967  ` argument is ig
+00013ba0: 6e6f 7265 642e 0a0a 5468 6520 6f70 7469  nored...The opti
+00013bb0: 6f6e 616c 2060 6669 6c74 6572 5f62 795f  onal `filter_by_
+00013bc0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+00013bd0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00013be0: 6e20 6062 6f6f 6c60 2074 6861 7420 696e  n `bool` that in
+00013bf0: 6469 6361 7465 730a 7768 6574 6865 7220  dicates.whether 
+00013c00: 7468 6520 6669 6c74 6572 696e 6720 7769  the filtering wi
+00013c10: 6c6c 2061 7070 6c79 2074 6f20 6576 656e  ll apply to even
+00013c20: 7420 7479 7065 7320 6f72 2073 7472 6561  t types or strea
+00013c30: 6d20 6e61 6d65 732e 2042 7920 6465 6661  m names. By defa
+00013c40: 756c 742c 2074 6869 730a 7661 6c75 6520  ult, this.value 
+00013c50: 6973 2060 4661 6c73 6560 2061 6e64 2073  is `False` and s
+00013c60: 6f20 7468 6520 6669 6c74 6572 696e 6720  o the filtering 
+00013c70: 7769 6c6c 2061 7070 6c79 2074 6f20 7468  will apply to th
+00013c80: 6520 6576 656e 7420 7479 7065 2073 7472  e event type str
+00013c90: 696e 6773 206f 660a 7265 636f 7264 6564  ings of.recorded
+00013ca0: 2065 7665 6e74 732e 0a0a 5468 6520 6f70   events...The op
+00013cb0: 7469 6f6e 616c 2060 636f 6e73 756d 6572  tional `consumer
+00013cc0: 5f73 7472 6174 6567 7960 2061 7267 756d  _strategy` argum
+00013cd0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00013ce0: 6073 7472 6020 7468 6174 2064 6566 696e  `str` that defin
+00013cf0: 6573 0a74 6865 2063 6f6e 7375 6d65 7220  es.the consumer 
+00013d00: 7374 7261 7465 6779 2066 6f72 2074 6869  strategy for thi
+00013d10: 7320 7065 7273 6973 7465 6e74 2073 7562  s persistent sub
+00013d20: 7363 7269 7074 696f 6e2e 2054 6865 2076  scription. The v
+00013d30: 616c 7565 206f 6620 7468 6973 2061 7267  alue of this arg
+00013d40: 756d 656e 740a 6361 6e20 6265 2060 2744  ument.can be `'D
+00013d50: 6973 7061 7463 6854 6f53 696e 676c 6527  ispatchToSingle'
+00013d60: 602c 2060 2752 6f75 6e64 526f 6269 6e27  `, `'RoundRobin'
+00013d70: 602c 2060 2750 696e 6e65 6427 602c 206f  `, `'Pinned'`, o
+00013d80: 7220 6027 5069 6e6e 6564 4279 436f 7272  r `'PinnedByCorr
+00013d90: 656c 6174 696f 6e27 602e 2054 6865 0a64  elation'`. The.d
+00013da0: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
+00013db0: 6027 4469 7370 6174 6368 546f 5369 6e67  `'DispatchToSing
+00013dc0: 6c65 2760 2e0a 0a54 6865 206f 7074 696f  le'`...The optio
+00013dd0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00013de0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00013df0: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00013e00: 2073 6574 7320 610a 6465 6164 6c69 6e65   sets a.deadline
+00013e10: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+00013e20: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00013e30: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+00013e40: 6d65 7468 6f64 2060 6372 6561 7465 5f73  method `create_s
+00013e50: 7562 7363 7269 7074 696f 6e28 2960 2064  ubscription()` d
+00013e60: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
+00013e70: 2076 616c 7565 2e20 5265 636f 7264 6564   value. Recorded
+00013e80: 2065 7665 6e74 7320 6172 650a 6f62 7461   events are.obta
+00013e90: 696e 6564 2062 7920 6361 6c6c 696e 6720  ined by calling 
+00013ea0: 7468 6520 6072 6561 645f 7375 6273 6372  the `read_subscr
+00013eb0: 6970 7469 6f6e 2829 6020 6d65 7468 6f64  iption()` method
+00013ec0: 2e0a 0a49 6e20 7468 6520 6578 616d 706c  ...In the exampl
+00013ed0: 6520 6265 6c6f 772c 2061 2070 6572 7369  e below, a persi
+00013ee0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00013ef0: 6f6e 2069 7320 6372 6561 7465 6420 746f  on is created to
+00013f00: 206f 7065 7261 7465 2066 726f 6d20 7468   operate from th
+00013f10: 650a 6669 7273 7420 7265 636f 7264 6564  e.first recorded
+00013f20: 206e 6f6e 2d73 7973 7465 6d20 6576 656e   non-system even
+00013f30: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
+00013f40: 652e 0a0a 6060 6070 7974 686f 6e0a 2320  e...```python.# 
+00013f50: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
+00013f60: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00013f70: 2e0a 6772 6f75 705f 6e61 6d65 3120 3d20  ..group_name1 = 
+00013f80: 6622 6772 6f75 702d 7b75 7569 642e 7575  f"group-{uuid.uu
+00013f90: 6964 3428 297d 220a 636c 6965 6e74 2e63  id4()}".client.c
+00013fa0: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
+00013fb0: 6f6e 2867 726f 7570 5f6e 616d 653d 6772  on(group_name=gr
+00013fc0: 6f75 705f 6e61 6d65 3129 0a60 6060 0a0a  oup_name1).```..
+00013fd0: 2323 2320 5265 6164 2073 7562 7363 7269  ### Read subscri
+00013fe0: 7074 696f 6e0a 0a2a 7265 7175 6972 6573  ption..*requires
+00013ff0: 206c 6561 6465 722a 0a0a 5468 6520 6072   leader*..The `r
+00014000: 6561 645f 7375 6273 6372 6970 7469 6f6e  ead_subscription
+00014010: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00014020: 6520 7573 6564 2062 7920 6120 6772 6f75  e used by a grou
+00014030: 7020 6f66 2063 6f6e 7375 6d65 7273 2074  p of consumers t
+00014040: 6f20 7265 6365 6976 650a 7265 636f 7264  o receive.record
+00014050: 6564 2065 7665 6e74 7320 6672 6f6d 2061  ed events from a
+00014060: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00014070: 6372 6970 7469 6f6e 2074 6861 7420 6861  cription that ha
+00014080: 7320 6265 656e 2063 7265 6174 6564 2075  s been created u
+00014090: 7369 6e67 0a74 6865 2060 6372 6561 7465  sing.the `create
+000140a0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+000140b0: 206d 6574 686f 642e 0a0a 5468 6973 206d   method...This m
+000140c0: 6574 686f 6420 6861 7320 6120 7265 7175  ethod has a requ
+000140d0: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
+000140e0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+000140f0: 6820 6973 0a74 6865 206e 616d 6520 6f66  h is.the name of
+00014100: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
+00014110: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
+00014120: 7562 7363 7269 7074 696f 6e20 7370 6563  ubscription spec
+00014130: 6966 6965 640a 7768 656e 2060 6372 6561  ified.when `crea
+00014140: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+00014150: 2960 2077 6173 2063 616c 6c65 642e 0a0a  )` was called...
+00014160: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+00014170: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+00014180: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00014190: 656e 742c 2074 6861 740a 6973 2065 7870  ent, that.is exp
+000141a0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+000141b0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
+000141c0: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+000141d0: 696e 650a 666f 7220 7468 6520 636f 6d70  ine.for the comp
+000141e0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+000141f0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+00014200: 6869 7320 6d65 7468 6f64 2072 6574 7572  his method retur
+00014210: 6e73 2061 2060 5065 7273 6973 7465 6e74  ns a `Persistent
+00014220: 5375 6273 6372 6970 7469 6f6e 6020 6f62  Subscription` ob
+00014230: 6a65 6374 2c20 7768 6963 6820 6973 2061  ject, which is a
+00014240: 6e20 6974 6572 6174 6f72 0a67 6976 696e  n iterator.givin
+00014250: 6720 6052 6563 6f72 6465 6445 7665 6e74  g `RecordedEvent
+00014260: 6020 6f62 6a65 6374 732e 2049 7420 616c  ` objects. It al
+00014270: 736f 2068 6173 2060 6163 6b28 2960 2c20  so has `ack()`, 
+00014280: 606e 6163 6b28 2960 2061 6e64 2060 7374  `nack()` and `st
+00014290: 6f70 2829 600a 6d65 7468 6f64 732e 0a0a  op()`.methods...
+000142a0: 6060 6070 7974 686f 6e0a 7375 6273 6372  ```python.subscr
+000142b0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+000142c0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
+000142d0: 6e28 6772 6f75 705f 6e61 6d65 3d67 726f  n(group_name=gro
+000142e0: 7570 5f6e 616d 6531 290a 6060 600a 0a54  up_name1).```..T
+000142f0: 6865 2060 6163 6b28 2960 206d 6574 686f  he `ack()` metho
+00014300: 6420 7368 6f75 6c64 2062 6520 7573 6564  d should be used
+00014310: 2062 7920 6120 636f 6e73 756d 6572 2074   by a consumer t
+00014320: 6f20 696e 6469 6361 7465 2074 6f20 7468  o indicate to th
+00014330: 6520 7365 7276 6572 2074 6861 7420 6974  e server that it
+00014340: 0a68 6173 2072 6563 6569 7665 6420 616e  .has received an
+00014350: 6420 7375 6363 6573 7366 756c 6c79 2070  d successfully p
+00014360: 726f 6365 7373 6564 2061 2072 6563 6f72  rocessed a recor
+00014370: 6465 6420 6576 656e 742e 2054 6869 7320  ded event. This 
+00014380: 7769 6c6c 2070 7265 7665 6e74 2074 6861  will prevent tha
+00014390: 740a 7265 636f 7264 6564 2065 7665 6e74  t.recorded event
+000143a0: 2062 6569 6e67 2072 6563 6569 7665 6420   being received 
+000143b0: 6279 2061 6e6f 7468 6572 2063 6f6e 7375  by another consu
+000143c0: 6d65 7220 696e 2074 6865 2073 616d 6520  mer in the same 
+000143d0: 6772 6f75 702e 2054 6865 2060 6163 6b28  group. The `ack(
+000143e0: 2960 0a6d 6574 686f 6420 7461 6b65 7320  )`.method takes 
+000143f0: 616e 2060 6576 656e 745f 6964 6020 6172  an `event_id` ar
+00014400: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00014410: 2074 6865 2049 4420 6f66 2074 6865 2072   the ID of the r
+00014420: 6563 6f72 6465 6420 6576 656e 7420 7468  ecorded event th
+00014430: 6174 0a68 6173 2062 6565 6e20 7265 6365  at.has been rece
+00014440: 6976 6564 2e0a 0a54 6865 2065 7861 6d70  ived...The examp
+00014450: 6c65 2062 656c 6f77 2069 7465 7261 7465  le below iterate
+00014460: 7320 6f76 6572 2074 6865 2073 7562 7363  s over the subsc
+00014470: 7269 7074 696f 6e20 6f62 6a65 6374 2c20  ription object, 
+00014480: 616e 6420 6361 6c6c 7320 6061 636b 2829  and calls `ack()
+00014490: 602e 2054 6865 0a60 7374 6f70 2829 6020  `. The.`stop()` 
+000144a0: 6d65 7468 6f64 2069 7320 6361 6c6c 6564  method is called
+000144b0: 2077 6865 6e20 7765 2068 6176 6520 7265   when we have re
+000144c0: 6365 6976 6564 2074 6865 206c 6173 7420  ceived the last 
+000144d0: 6576 656e 742c 2073 6f20 7468 6174 2077  event, so that w
+000144e0: 6520 6361 6e0a 636f 6e74 696e 7565 2077  e can.continue w
+000144f0: 6974 6820 7468 6520 6578 616d 706c 6573  ith the examples
+00014500: 2062 656c 6f77 2e0a 0a60 6060 7079 7468   below...```pyth
+00014510: 6f6e 0a65 7665 6e74 7320 3d20 5b5d 0a66  on.events = [].f
+00014520: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
+00014530: 6372 6970 7469 6f6e 3a0a 2020 2020 6576  cription:.    ev
+00014540: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+00014550: 7429 0a0a 2020 2020 2320 4163 6b6e 6f77  t)..    # Acknow
+00014560: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
+00014570: 6564 2065 7665 6e74 2e0a 2020 2020 7375  ed event..    su
+00014580: 6273 6372 6970 7469 6f6e 2e61 636b 2865  bscription.ack(e
+00014590: 7665 6e74 5f69 643d 6576 656e 742e 6964  vent_id=event.id
+000145a0: 290a 0a20 2020 2023 2053 746f 7020 7768  )..    # Stop wh
+000145b0: 656e 2027 6576 656e 7439 2720 6861 7320  en 'event9' has 
+000145c0: 6265 656e 2072 6563 6569 7665 642e 0a20  been received.. 
+000145d0: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
+000145e0: 3d20 6576 656e 7439 2e69 643a 0a20 2020  = event9.id:.   
+000145f0: 2020 2020 2073 7562 7363 7269 7074 696f       subscriptio
+00014600: 6e2e 7374 6f70 2829 0a60 6060 0a0a 5468  n.stop().```..Th
+00014610: 6520 7265 6365 6976 6564 2065 7665 6e74  e received event
+00014620: 7320 6172 6520 7468 6520 6576 656e 7473  s are the events
+00014630: 2077 6520 6170 7065 6e64 6564 2061 626f   we appended abo
+00014640: 7665 2e0a 0a60 6060 7079 7468 6f6e 0a61  ve...```python.a
+00014650: 7373 6572 7420 6576 656e 7473 5b2d 3134  ssert events[-14
+00014660: 5d2e 6964 203d 3d20 6576 656e 7431 2e69  ].id == event1.i
+00014670: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
+00014680: 2d31 335d 2e69 6420 3d3d 2065 7665 6e74  -13].id == event
+00014690: 322e 6964 0a61 7373 6572 7420 6576 656e  2.id.assert even
+000146a0: 7473 5b2d 3132 5d2e 6964 203d 3d20 6576  ts[-12].id == ev
+000146b0: 656e 7433 2e69 640a 6173 7365 7274 2065  ent3.id.assert e
+000146c0: 7665 6e74 735b 2d31 315d 2e74 7970 6520  vents[-11].type 
+000146d0: 3d3d 2022 446f 6752 6567 6973 7465 7265  == "DogRegistere
+000146e0: 6422 0a61 7373 6572 7420 6576 656e 7473  d".assert events
+000146f0: 5b2d 3130 5d2e 7479 7065 203d 3d20 2244  [-10].type == "D
+00014700: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
+00014710: 6173 7365 7274 2065 7665 6e74 735b 2d39  assert events[-9
+00014720: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+00014730: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
+00014740: 7274 2065 7665 6e74 735b 2d38 5d2e 7479  rt events[-8].ty
+00014750: 7065 203d 3d20 2253 6e61 7073 686f 7422  pe == "Snapshot"
+00014760: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+00014770: 375d 2e74 7970 6520 3d3d 2022 446f 674c  7].type == "DogL
+00014780: 6561 726e 6564 5472 6963 6b22 0a61 7373  earnedTrick".ass
+00014790: 6572 7420 6576 656e 7473 5b2d 365d 2e69  ert events[-6].i
+000147a0: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
+000147b0: 7373 6572 7420 6576 656e 7473 5b2d 355d  ssert events[-5]
+000147c0: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
+000147d0: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+000147e0: 345d 2e69 6420 3d3d 2065 7665 6e74 362e  4].id == event6.
+000147f0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00014800: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
+00014810: 372e 6964 0a61 7373 6572 7420 6576 656e  7.id.assert even
+00014820: 7473 5b2d 325d 2e69 6420 3d3d 2065 7665  ts[-2].id == eve
+00014830: 6e74 382e 6964 0a61 7373 6572 7420 6576  nt8.id.assert ev
+00014840: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
+00014850: 7665 6e74 392e 6964 0a60 6060 0a0a 5468  vent9.id.```..Th
+00014860: 6520 6050 6572 7369 7374 656e 7453 7562  e `PersistentSub
+00014870: 7363 7269 7074 696f 6e60 206f 626a 6563  scription` objec
+00014880: 7420 616c 736f 2068 6173 2061 6e20 606e  t also has an `n
+00014890: 6163 6b28 2960 206d 6574 686f 6420 7468  ack()` method th
+000148a0: 6174 2073 686f 756c 6420 6265 2075 7365  at should be use
+000148b0: 640a 6279 2061 2063 6f6e 7375 6d65 7220  d.by a consumer 
+000148c0: 746f 206e 6567 6174 6976 656c 7920 6163  to negatively ac
+000148d0: 6b6e 6f77 6c65 6467 6520 746f 2074 6865  knowledge to the
+000148e0: 2073 6572 7665 7220 7468 6174 2069 7420   server that it 
+000148f0: 6861 7320 7265 6365 6976 6564 2062 7574  has received but
+00014900: 206e 6f74 0a73 7563 6365 7373 6675 6c6c   not.successfull
+00014910: 7920 7072 6f63 6573 7365 6420 6120 7265  y processed a re
+00014920: 636f 7264 6564 2065 7665 6e74 2e20 5468  corded event. Th
+00014930: 6520 606e 6163 6b28 2960 206d 6574 686f  e `nack()` metho
+00014940: 6420 7461 6b65 7320 616e 2060 6576 656e  d takes an `even
+00014950: 745f 6964 600a 6172 6775 6d65 6e74 2c20  t_id`.argument, 
+00014960: 7768 6963 6820 6973 2074 6865 2049 4420  which is the ID 
+00014970: 6f66 2074 6865 2072 6563 6f72 6465 6420  of the recorded 
+00014980: 6576 656e 7420 7468 6174 2068 6173 2062  event that has b
+00014990: 6565 6e20 7265 6365 6976 6564 2c20 616e  een received, an
+000149a0: 6420 616e 2060 6163 7469 6f6e 600a 6172  d an `action`.ar
+000149b0: 6775 6d65 6e74 2c20 7768 6963 6820 7368  gument, which sh
+000149c0: 6f75 6c64 2062 6520 6120 5079 7468 6f6e  ould be a Python
+000149d0: 2060 7374 7260 2c20 6569 7468 6572 2060   `str`, either `
+000149e0: 2775 6e6b 6e6f 776e 2760 2c20 6027 7061  'unknown'`, `'pa
+000149f0: 726b 2760 2c20 6027 7265 7472 7927 602c  rk'`, `'retry'`,
+00014a00: 0a60 2773 6b69 7027 6020 6f72 2060 2773  .`'skip'` or `'s
+00014a10: 746f 7027 602e 0a0a 0a23 2323 2048 6f77  top'`....### How
+00014a20: 2074 6f20 7772 6974 6520 6120 7065 7273   to write a pers
+00014a30: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00014a40: 696f 6e20 636f 6e73 756d 6572 0a0a 5468  ion consumer..Th
+00014a50: 6520 7265 6164 696e 6720 6f66 2061 2070  e reading of a p
+00014a60: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00014a70: 6970 7469 6f6e 2063 616e 2062 6520 656e  iption can be en
+00014a80: 6361 7073 756c 6174 6564 2069 6e20 6120  capsulated in a 
+00014a90: 2263 6f6e 7375 6d65 7222 2074 6861 7420  "consumer" that 
+00014aa0: 6361 6c6c 730a 6120 2270 6f6c 6963 7922  calls.a "policy"
+00014ab0: 2066 756e 6374 696f 6e20 7768 656e 2061   function when a
+00014ac0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00014ad0: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
+00014ae0: 7468 656e 2061 7574 6f6d 6174 6963 616c  then automatical
+00014af0: 6c79 2063 616c 6c73 0a60 6163 6b28 2960  ly calls.`ack()`
+00014b00: 2069 6620 7468 6520 706f 6c69 6379 2066   if the policy f
+00014b10: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+00014b20: 6e6f 726d 616c 6c79 2c20 616e 6420 606e  normally, and `n
+00014b30: 6163 6b28 2960 2069 6620 6974 2072 6169  ack()` if it rai
+00014b40: 7365 7320 616e 2065 7863 6570 7469 6f6e  ses an exception
+00014b50: 2c0a 7065 7268 6170 7320 7265 7472 7969  ,.perhaps retryi
+00014b60: 6e67 2074 6865 2065 7665 6e74 2066 6f72  ng the event for
+00014b70: 2061 2063 6572 7461 696e 206e 756d 6265   a certain numbe
+00014b80: 7220 6f66 2074 696d 6573 2062 6566 6f72  r of times befor
+00014b90: 6520 7061 726b 696e 6720 7468 6520 6576  e parking the ev
+00014ba0: 656e 742e 0a0a 5468 6520 7369 6d70 6c65  ent...The simple
+00014bb0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00014bc0: 686f 7773 2068 6f77 2074 6869 7320 6d69  hows how this mi
+00014bd0: 6768 7420 6265 2064 6f6e 652e 2057 6520  ght be done. We 
+00014be0: 6361 6e20 7365 6520 7468 6174 2027 6576  can see that 'ev
+00014bf0: 656e 7439 2720 6973 0a61 636b 6e6f 776c  ent9' is.acknowl
+00014c00: 6564 6765 6420 6265 666f 7265 2027 6576  edged before 'ev
+00014c10: 656e 7435 2720 6973 2066 696e 616c 6c79  ent5' is finally
+00014c20: 2070 6172 6b65 642e 0a0a 0a60 6060 7079   parked....```py
+00014c30: 7468 6f6e 0a61 636b 6564 5f65 7665 6e74  thon.acked_event
+00014c40: 7320 3d20 7b7d 0a6e 6163 6b65 645f 6576  s = {}.nacked_ev
+00014c50: 656e 7473 203d 207b 7d0a 0a0a 636c 6173  ents = {}...clas
+00014c60: 7320 4578 616d 706c 6543 6f6e 7375 6d65  s ExampleConsume
+00014c70: 723a 0a20 2020 2064 6566 205f 5f69 6e69  r:.    def __ini
+00014c80: 745f 5f28 7365 6c66 2c20 7375 6273 6372  t__(self, subscr
+00014c90: 6970 7469 6f6e 2c20 6d61 785f 7265 7472  iption, max_retr
+00014ca0: 6965 732c 2066 696e 616c 5f61 6374 696f  ies, final_actio
+00014cb0: 6e29 3a0a 2020 2020 2020 2020 7365 6c66  n):.        self
+00014cc0: 2e73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
+00014cd0: 7375 6273 6372 6970 7469 6f6e 0a20 2020  subscription.   
+00014ce0: 2020 2020 2073 656c 662e 6d61 785f 7265       self.max_re
+00014cf0: 7472 6965 7320 3d20 6d61 785f 7265 7472  tries = max_retr
+00014d00: 6965 730a 2020 2020 2020 2020 7365 6c66  ies.        self
+00014d10: 2e66 696e 616c 5f61 6374 696f 6e20 3d20  .final_action = 
+00014d20: 6669 6e61 6c5f 6163 7469 6f6e 0a20 2020  final_action.   
+00014d30: 2020 2020 2073 656c 662e 6572 726f 7220       self.error 
+00014d40: 3d20 4e6f 6e65 0a0a 2020 2020 6465 6620  = None..    def 
+00014d50: 7275 6e28 7365 6c66 293a 0a20 2020 2020  run(self):.     
+00014d60: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00014d70: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
+00014d80: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
+00014d90: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00014da0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00014db0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014dc0: 662e 706f 6c69 6379 2865 7665 6e74 290a  f.policy(event).
+00014dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014de0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00014df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014e00: 2020 2020 2020 6966 2065 7665 6e74 2e72        if event.r
+00014e10: 6574 7279 5f63 6f75 6e74 203c 2073 656c  etry_count < sel
+00014e20: 662e 6d61 785f 7265 7472 6965 733a 0a20  f.max_retries:. 
+00014e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e40: 2020 2020 2020 2061 6374 696f 6e20 3d20         action = 
+00014e50: 2272 6574 7279 220a 2020 2020 2020 2020  "retry".        
+00014e60: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00014e70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014e80: 2020 2020 2020 2020 2020 6163 7469 6f6e            action
+00014e90: 203d 2073 656c 662e 6669 6e61 6c5f 6163   = self.final_ac
+00014ea0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00014eb0: 2020 2020 2020 2020 2073 656c 662e 7375           self.su
+00014ec0: 6273 6372 6970 7469 6f6e 2e6e 6163 6b28  bscription.nack(
+00014ed0: 6576 656e 742e 6964 2c20 6163 7469 6f6e  event.id, action
+00014ee0: 3d61 6374 696f 6e29 0a20 2020 2020 2020  =action).       
+00014ef0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014f00: 662e 6166 7465 725f 6e61 636b 2865 7665  f.after_nack(eve
+00014f10: 6e74 2c20 6163 7469 6f6e 290a 2020 2020  nt, action).    
+00014f20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00014f30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014f40: 2020 2020 2020 7365 6c66 2e73 7562 7363        self.subsc
+00014f50: 7269 7074 696f 6e2e 6163 6b28 6576 656e  ription.ack(even
+00014f60: 742e 6964 290a 2020 2020 2020 2020 2020  t.id).          
+00014f70: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014f80: 6674 6572 5f61 636b 2865 7665 6e74 290a  fter_ack(event).
+00014f90: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+00014fa0: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
+00014fb0: 2020 2020 2020 7365 6c66 2e73 7562 7363        self.subsc
+00014fc0: 7269 7074 696f 6e2e 7374 6f70 2829 0a20  ription.stop(). 
+00014fd0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00014fe0: 0a0a 2020 2020 6465 6620 7374 6f70 2873  ..    def stop(s
+00014ff0: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
+00015000: 6c66 2e73 7562 7363 7269 7074 696f 6e2e  lf.subscription.
+00015010: 7374 6f70 2829 0a0a 2020 2020 6465 6620  stop()..    def 
+00015020: 706f 6c69 6379 2873 656c 662c 2065 7665  policy(self, eve
+00015030: 6e74 293a 0a20 2020 2020 2020 2023 2052  nt):.        # R
+00015040: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
+00015050: 6e20 7768 656e 2077 6520 7365 6520 2265  n when we see "e
+00015060: 7665 6e74 3522 2e0a 2020 2020 2020 2020  vent5"..        
+00015070: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
+00015080: 7665 6e74 352e 6964 3a0a 2020 2020 2020  vent5.id:.      
+00015090: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+000150a0: 7074 696f 6e28 290a 0a20 2020 2064 6566  ption()..    def
+000150b0: 2061 6674 6572 5f61 636b 2873 656c 662c   after_ack(self,
+000150c0: 2065 7665 6e74 293a 0a20 2020 2020 2020   event):.       
+000150d0: 2023 2054 7261 636b 2072 6574 7279 2063   # Track retry c
+000150e0: 6f75 6e74 206f 6620 6163 6b65 6420 6576  ount of acked ev
+000150f0: 656e 7473 2e0a 2020 2020 2020 2020 6163  ents..        ac
+00015100: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
+00015110: 2e69 645d 203d 2065 7665 6e74 2e72 6574  .id] = event.ret
+00015120: 7279 5f63 6f75 6e74 0a0a 2020 2020 6465  ry_count..    de
+00015130: 6620 6166 7465 725f 6e61 636b 2873 656c  f after_nack(sel
+00015140: 662c 2065 7665 6e74 2c20 6163 7469 6f6e  f, event, action
+00015150: 293a 0a20 2020 2020 2020 2023 2054 7261  ):.        # Tra
+00015160: 636b 2072 6574 7279 2063 6f75 6e74 206f  ck retry count o
+00015170: 6620 6e61 636b 6564 2065 7665 6e74 732e  f nacked events.
+00015180: 0a20 2020 2020 2020 206e 6163 6b65 645f  .        nacked_
+00015190: 6576 656e 7473 5b65 7665 6e74 2e69 645d  events[event.id]
+000151a0: 203d 2065 7665 6e74 2e72 6574 7279 5f63   = event.retry_c
+000151b0: 6f75 6e74 0a0a 2020 2020 2020 2020 6966  ount..        if
+000151c0: 2061 6374 696f 6e20 3d3d 2073 656c 662e   action == self.
+000151d0: 6669 6e61 6c5f 6163 7469 6f6e 3a0a 2020  final_action:.  
+000151e0: 2020 2020 2020 2020 2020 2320 5374 6f70            # Stop
+000151f0: 2074 6865 2063 6f6e 7375 6d65 722c 2073   the consumer, s
+00015200: 6f20 7765 2063 616e 2063 6f6e 7469 6e75  o we can continu
+00015210: 6520 7769 7468 2074 6865 2065 7861 6d70  e with the examp
+00015220: 6c65 732e 0a20 2020 2020 2020 2020 2020  les..           
+00015230: 2073 656c 662e 7374 6f70 2829 0a0a 0a23   self.stop()...#
+00015240: 2043 7265 6174 6520 7375 6273 6372 6970   Create subscrip
+00015250: 7469 6f6e 2e0a 6772 6f75 705f 6e61 6d65  tion..group_name
+00015260: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
+00015270: 2e75 7569 6434 2829 7d22 0a63 6c69 656e  .uuid4()}".clien
+00015280: 742e 6372 6561 7465 5f73 7562 7363 7269  t.create_subscri
+00015290: 7074 696f 6e28 6772 6f75 705f 6e61 6d65  ption(group_name
+000152a0: 2c20 636f 6d6d 6974 5f70 6f73 6974 696f  , commit_positio
+000152b0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
+000152c0: 6e31 290a 0a23 2052 6561 6420 7375 6273  n1)..# Read subs
+000152d0: 6372 6970 7469 6f6e 2e0a 7375 6273 6372  cription..subscr
+000152e0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+000152f0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
+00015300: 6e28 6772 6f75 705f 6e61 6d65 290a 0a23  n(group_name)..#
+00015310: 2043 6f6e 7374 7275 6374 2063 6f6e 7375   Construct consu
+00015320: 6d65 722e 0a63 6f6e 7375 6d65 7220 3d20  mer..consumer = 
+00015330: 4578 616d 706c 6543 6f6e 7375 6d65 7228  ExampleConsumer(
+00015340: 0a20 2020 2073 7562 7363 7269 7074 696f  .    subscriptio
+00015350: 6e3d 7375 6273 6372 6970 7469 6f6e 2c0a  n=subscription,.
+00015360: 2020 2020 6d61 785f 7265 7472 6965 733d      max_retries=
+00015370: 352c 0a20 2020 2066 696e 616c 5f61 6374  5,.    final_act
+00015380: 696f 6e3d 2270 6172 6b22 2c0a 290a 0a23  ion="park",.)..#
+00015390: 2052 756e 2063 6f6e 7375 6d65 722e 0a63   Run consumer..c
+000153a0: 6f6e 7375 6d65 722e 7275 6e28 290a 0a23  onsumer.run()..#
+000153b0: 2043 6865 636b 2027 6576 656e 7439 2720   Check 'event9' 
+000153c0: 7761 7320 6163 6b65 6420 616e 6420 6e65  was acked and ne
+000153d0: 7665 7220 7265 7472 6965 642e 0a61 7373  ver retried..ass
+000153e0: 6572 7420 6163 6b65 645f 6576 656e 7473  ert acked_events
+000153f0: 5b65 7665 6e74 392e 6964 5d20 3d3d 2030  [event9.id] == 0
+00015400: 0a61 7373 6572 7420 6576 656e 7439 2e69  .assert event9.i
+00015410: 6420 6e6f 7420 696e 206e 6163 6b65 645f  d not in nacked_
+00015420: 6576 656e 7473 0a0a 2320 4368 6563 6b20  events..# Check 
+00015430: 2765 7665 6e74 3527 2077 6173 2072 6574  'event5' was ret
+00015440: 7269 6564 2066 6976 6520 7469 6d65 7320  ried five times 
+00015450: 616e 6420 6e65 7665 7220 6163 6b65 642e  and never acked.
+00015460: 0a61 7373 6572 7420 6e61 636b 6564 5f65  .assert nacked_e
+00015470: 7665 6e74 735b 6576 656e 7435 2e69 645d  vents[event5.id]
+00015480: 203d 3d20 350a 6173 7365 7274 2065 7665   == 5.assert eve
+00015490: 6e74 352e 6964 206e 6f74 2069 6e20 6163  nt5.id not in ac
+000154a0: 6b65 645f 6576 656e 7473 0a60 6060 0a0a  ked_events.```..
+000154b0: 2323 2320 4765 7420 7375 6273 6372 6970  ### Get subscrip
+000154c0: 7469 6f6e 2069 6e66 6f0a 0a2a 7265 7175  tion info..*requ
+000154d0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+000154e0: 6520 6067 6574 5f73 7562 7363 7269 7074  e `get_subscript
+000154f0: 696f 6e5f 696e 666f 2829 6020 6d65 7468  ion_info()` meth
+00015500: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+00015510: 6f20 6765 7420 696e 666f 726d 6174 696f  o get informatio
+00015520: 6e20 666f 7220 610a 7065 7273 6973 7465  n for a.persiste
+00015530: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
+00015540: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00015550: 7320 6f6e 6520 7265 7175 6972 6564 2061  s one required a
+00015560: 7267 756d 656e 742c 2060 6772 6f75 705f  rgument, `group_
+00015570: 6e61 6d65 602c 2077 6869 6368 0a73 686f  name`, which.sho
+00015580: 756c 6420 6d61 7463 6820 7468 6520 7661  uld match the va
+00015590: 6c75 6520 6f66 2074 6865 2061 7267 756d  lue of the argum
+000155a0: 656e 7420 7573 6564 2077 6865 6e20 6361  ent used when ca
+000155b0: 6c6c 696e 6720 6063 7265 6174 655f 7375  lling `create_su
+000155c0: 6273 6372 6970 7469 6f6e 2829 602e 0a0a  bscription()`...
+000155d0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+000155e0: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+000155f0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00015600: 656e 742c 2074 6861 740a 6973 2065 7870  ent, that.is exp
+00015610: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+00015620: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
+00015630: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+00015640: 696e 650a 666f 7220 7468 6520 636f 6d70  ine.for the comp
+00015650: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+00015660: 5043 206f 7065 7261 7469 6f6e 2e0a 0a60  PC operation...`
+00015670: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
+00015680: 7074 696f 6e5f 696e 666f 203d 2063 6c69  ption_info = cli
+00015690: 656e 742e 6765 745f 7375 6273 6372 6970  ent.get_subscrip
+000156a0: 7469 6f6e 5f69 6e66 6f28 0a20 2020 2067  tion_info(.    g
+000156b0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+000156c0: 6e61 6d65 312c 0a29 0a60 6060 0a0a 5468  name1,.).```..Th
+000156d0: 6520 7265 7475 726e 6564 2076 616c 7565  e returned value
+000156e0: 2069 7320 6120 6053 7562 7363 7269 7074   is a `Subscript
+000156f0: 696f 6e49 6e66 6f60 206f 626a 6563 742e  ionInfo` object.
+00015700: 0a0a 2323 2320 4c69 7374 2073 7562 7363  ..### List subsc
+00015710: 7269 7074 696f 6e73 0a0a 2a72 6571 7569  riptions..*requi
+00015720: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
+00015730: 2060 6c69 7374 5f73 7562 7363 7269 7074   `list_subscript
+00015740: 696f 6e73 2829 6020 6d65 7468 6f64 2063  ions()` method c
+00015750: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
+00015760: 7420 696e 666f 726d 6174 696f 6e20 666f  t information fo
+00015770: 7220 616c 6c0a 6578 6973 7469 6e67 2070  r all.existing p
+00015780: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00015790: 6970 7469 6f6e 732e 0a0a 5468 6973 206d  iptions...This m
+000157a0: 6574 686f 6420 6861 7320 616e 206f 7074  ethod has an opt
+000157b0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+000157c0: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
+000157d0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
+000157e0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+000157f0: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
+00015800: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
+00015810: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00015820: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00015830: 6e2e 0a0a 6060 6070 7974 686f 6e0a 7375  n...```python.su
+00015840: 6273 6372 6970 7469 6f6e 7320 3d20 636c  bscriptions = cl
+00015850: 6965 6e74 2e6c 6973 745f 7375 6273 6372  ient.list_subscr
+00015860: 6970 7469 6f6e 7328 290a 6060 600a 0a54  iptions().```..T
+00015870: 6865 2072 6574 7572 6e65 6420 7661 6c75  he returned valu
+00015880: 6520 6973 2061 206c 6973 7420 6f66 2060  e is a list of `
+00015890: 5375 6273 6372 6970 7469 6f6e 496e 666f  SubscriptionInfo
+000158a0: 6020 6f62 6a65 6374 732e 0a0a 2323 2320  ` objects...### 
+000158b0: 5570 6461 7465 2073 7562 7363 7269 7074  Update subscript
+000158c0: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
+000158d0: 6561 6465 722a 0a0a 5468 6520 6075 7064  eader*..The `upd
+000158e0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+000158f0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00015900: 6520 7573 6564 2074 6f20 7570 6461 7465  e used to update
+00015910: 2061 0a22 7065 7273 6973 7465 6e74 2073   a."persistent s
+00015920: 7562 7363 7269 7074 696f 6e22 2e0a 0a54  ubscription"...T
+00015930: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+00015940: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
+00015950: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
+00015960: 2077 6869 6368 2069 7320 7468 650a 6e61   which is the.na
+00015970: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
+00015980: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+00015990: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+000159a0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+000159b0: 6c73 6f20 6861 7320 7468 7265 6520 6f70  lso has three op
+000159c0: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
+000159d0: 2c20 6066 726f 6d5f 656e 6460 2c20 6063  , `from_end`, `c
+000159e0: 6f6d 6d69 745f 706f 7369 7469 6f6e 602c  ommit_position`,
+000159f0: 0a61 6e64 2060 7469 6d65 6f75 7460 2e0a  .and `timeout`..
+00015a00: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00015a10: 726f 6d5f 656e 6460 2061 7267 756d 656e  rom_end` argumen
+00015a20: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+00015a30: 2073 7065 6369 6679 2074 6861 7420 7468   specify that th
+00015a40: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+00015a50: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
+00015a60: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
+00015a70: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
+00015a80: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
+00015a90: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+00015aa0: 2073 7562 7363 7269 7074 696f 6e0a 7761   subscription.wa
+00015ab0: 7320 7570 6461 7465 642e 0a0a 416c 7465  s updated...Alte
+00015ac0: 726e 6174 6976 656c 792c 2074 6865 206f  rnatively, the o
+00015ad0: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
+00015ae0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00015af0: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+00015b00: 6f20 7370 6563 6966 7920 6120 636f 6d6d  o specify a comm
+00015b10: 6974 0a70 6f73 6974 696f 6e20 6672 6f6d  it.position from
+00015b20: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
+00015b30: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
+00015b40: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+00015b50: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00015b60: 6e20 7368 6f75 6c64 0a72 6563 6569 7665  n should.receive
+00015b70: 2065 7665 6e74 732e 2050 6c65 6173 6520   events. Please 
+00015b80: 6e6f 7465 2c20 7468 6520 7265 636f 7264  note, the record
+00015b90: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
+00015ba0: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
+00015bb0: 2070 6f73 6974 696f 6e20 6d69 6768 740a   position might.
+00015bc0: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+00015bd0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00015be0: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+00015bf0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00015c00: 756d 6572 732e 0a0a 4966 206e 6569 7468  umers...If neith
+00015c10: 6572 2060 6672 6f6d 5f65 6e64 6020 6f72  er `from_end` or
+00015c20: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00015c30: 6e60 2061 7265 2073 7065 6369 6669 6564  n` are specified
+00015c40: 2c20 7468 6520 6772 6f75 7020 6f66 2063  , the group of c
+00015c50: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
+00015c60: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+00015c70: 6c20 706f 7465 6e74 6961 6c6c 7920 7265  l potentially re
+00015c80: 6365 6976 6520 616c 6c20 7265 636f 7264  ceive all record
+00015c90: 6564 2065 7665 6e74 7320 696e 2074 6865  ed events in the
+00015ca0: 2064 6174 6162 6173 652e 0a0a 506c 6561   database...Plea
+00015cb0: 7365 206e 6f74 652c 2074 6865 2066 696c  se note, the fil
+00015cc0: 7465 7220 6f70 7469 6f6e 7320 616e 6420  ter options and 
+00015cd0: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
+00015ce0: 7920 6361 6e6e 6f74 2062 6520 6164 6a75  y cannot be adju
+00015cf0: 7374 6564 2e0a 0a54 6865 206f 7074 696f  sted...The optio
+00015d00: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00015d10: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00015d20: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00015d30: 2073 6574 7320 610a 6465 6164 6c69 6e65   sets a.deadline
+00015d40: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+00015d50: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00015d60: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+00015d70: 6d65 7468 6f64 2060 7570 6461 7465 5f73  method `update_s
+00015d80: 7562 7363 7269 7074 696f 6e28 2960 2064  ubscription()` d
+00015d90: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
+00015da0: 2076 616c 7565 2e0a 0a49 6e20 7468 6520   value...In the 
+00015db0: 6578 616d 706c 6520 6265 6c6f 772c 2061  example below, a
+00015dc0: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00015dd0: 6372 6970 7469 6f6e 2069 7320 7570 6461  cription is upda
+00015de0: 7465 6420 746f 2072 756e 2066 726f 6d20  ted to run from 
+00015df0: 7468 6520 656e 6420 6f66 2074 6865 0a64  the end of the.d
+00015e00: 6174 6162 6173 652e 0a0a 6060 6070 7974  atabase...```pyt
+00015e10: 686f 6e0a 2320 4372 6561 7465 2061 2070  hon.# Create a p
+00015e20: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00015e30: 6970 7469 6f6e 2e0a 636c 6965 6e74 2e75  iption..client.u
+00015e40: 7064 6174 655f 7375 6273 6372 6970 7469  pdate_subscripti
+00015e50: 6f6e 2867 726f 7570 5f6e 616d 653d 6772  on(group_name=gr
+00015e60: 6f75 705f 6e61 6d65 312c 2066 726f 6d5f  oup_name1, from_
+00015e70: 656e 643d 5472 7565 290a 6060 600a 0a23  end=True).```..#
+00015e80: 2323 2043 7265 6174 6520 7374 7265 616d  ## Create stream
+00015e90: 2073 7562 7363 7269 7074 696f 6e0a 0a2a   subscription..*
+00015ea0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+00015eb0: 0a0a 5468 6520 6063 7265 6174 655f 7374  ..The `create_st
+00015ec0: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00015ed0: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
+00015ee0: 6265 2075 7365 6420 746f 2063 7265 6174  be used to creat
+00015ef0: 6520 6120 7065 7273 6973 7465 6e74 0a73  e a persistent.s
+00015f00: 7562 7363 7269 7074 696f 6e20 666f 7220  ubscription for 
+00015f10: 6120 7374 7265 616d 2e0a 0a54 6869 7320  a stream...This 
+00015f20: 6d65 7468 6f64 2068 6173 2074 776f 2072  method has two r
+00015f30: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
+00015f40: 732c 2060 6772 6f75 705f 6e61 6d65 6020  s, `group_name` 
+00015f50: 616e 6420 6073 7472 6561 6d5f 6e61 6d65  and `stream_name
+00015f60: 602e 2054 6865 0a60 6772 6f75 705f 6e61  `. The.`group_na
+00015f70: 6d65 6020 6172 6775 6d65 6e74 206e 616d  me` argument nam
+00015f80: 6573 2074 6865 2067 726f 7570 206f 6620  es the group of 
+00015f90: 636f 6e73 756d 6572 7320 7468 6174 2077  consumers that w
+00015fa0: 696c 6c20 7265 6365 6976 6520 6576 656e  ill receive even
+00015fb0: 7473 0a66 726f 6d20 7468 6973 2073 7562  ts.from this sub
+00015fc0: 7363 7269 7074 696f 6e2e 2054 6865 2060  scription. The `
+00015fd0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+00015fe0: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
+00015ff0: 7768 6963 6820 7374 7265 616d 0a74 6865  which stream.the
+00016000: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+00016010: 6c6c 2066 6f6c 6c6f 772e 2054 6865 2076  ll follow. The v
+00016020: 616c 7565 7320 6f66 2062 6f74 6820 7468  alues of both th
+00016030: 6573 6520 6172 6775 6d65 6e74 7320 6172  ese arguments ar
+00016040: 6520 6578 7065 6374 6564 0a74 6f20 6265  e expected.to be
+00016050: 2050 7974 686f 6e20 6073 7472 6020 6f62   Python `str` ob
+00016060: 6a65 6374 732e 0a0a 5468 6520 6d65 7468  jects...The meth
+00016070: 6f64 2061 6c73 6f20 6861 7320 666f 7572  od also has four
+00016080: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00016090: 6e74 732c 2060 7374 7265 616d 5f70 6f73  nts, `stream_pos
+000160a0: 6974 696f 6e60 2c20 6066 726f 6d5f 656e  ition`, `from_en
+000160b0: 6460 2c0a 6063 6f6e 7375 6d65 725f 7374  d`,.`consumer_st
+000160c0: 7261 7465 6779 602c 2061 6e64 2060 7469  rategy`, and `ti
+000160d0: 6d65 6f75 7460 2e0a 0a54 6869 7320 6f70  meout`...This op
+000160e0: 7469 6f6e 616c 2060 7374 7265 616d 5f70  tional `stream_p
+000160f0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+00016100: 7420 7370 6563 6966 6965 7320 6120 7374  t specifies a st
+00016110: 7265 616d 2070 6f73 6974 696f 6e20 6672  ream position fr
+00016120: 6f6d 0a77 6869 6368 2074 6f20 7375 6273  om.which to subs
+00016130: 6372 6962 652e 2054 6865 2072 6563 6f72  cribe. The recor
+00016140: 6465 6420 6576 656e 7420 6174 2074 6869  ded event at thi
+00016150: 7320 7374 7265 616d 0a70 6f73 6974 696f  s stream.positio
+00016160: 6e20 7769 6c6c 2062 6520 7265 6365 6976  n will be receiv
+00016170: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
+00016180: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00016190: 2e0a 0a54 6869 7320 6f70 7469 6f6e 616c  ...This optional
+000161a0: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
+000161b0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+000161c0: 2060 626f 6f6c 602e 0a42 7920 6465 6661   `bool`..By defa
+000161d0: 756c 742c 2074 6865 2076 616c 7565 206f  ult, the value o
+000161e0: 6620 7468 6973 2061 7267 756d 656e 7420  f this argument 
+000161f0: 6973 2060 4661 6c73 6560 2e20 4966 2074  is `False`. If t
+00016200: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
+00016210: 7365 740a 746f 2060 5472 7565 602c 2072  set.to `True`, r
+00016220: 6561 6469 6e67 2066 726f 6d20 7468 6520  eading from the 
+00016230: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+00016240: 6c20 7265 6365 6976 6520 6f6e 6c79 2065  l receive only e
+00016250: 7665 6e74 730a 7265 636f 7264 6564 2061  vents.recorded a
+00016260: 6674 6572 2074 6865 2073 7562 7363 7269  fter the subscri
+00016270: 7074 696f 6e20 7761 7320 6372 6561 7465  ption was create
+00016280: 642e 2054 6861 7420 6973 2c20 6974 2069  d. That is, it i
+00016290: 7320 6e6f 7420 696e 636c 7573 6976 650a  s not inclusive.
+000162a0: 6f66 2074 6865 2063 7572 7265 6e74 2073  of the current s
+000162b0: 7472 6561 6d20 706f 7369 7469 6f6e 2e0a  tream position..
+000162c0: 0a54 6865 206f 7074 696f 6e61 6c20 6063  .The optional `c
+000162d0: 6f6e 7375 6d65 725f 7374 7261 7465 6779  onsumer_strategy
+000162e0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+000162f0: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
+00016300: 7420 6465 6669 6e65 730a 7468 6520 636f  t defines.the co
+00016310: 6e73 756d 6572 2073 7472 6174 6567 7920  nsumer strategy 
+00016320: 666f 7220 7468 6973 2070 6572 7369 7374  for this persist
+00016330: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00016340: 2e20 5468 6520 7661 6c75 6520 6f66 2074  . The value of t
+00016350: 6869 7320 6172 6775 6d65 6e74 0a63 616e  his argument.can
+00016360: 2062 6520 6027 4469 7370 6174 6368 546f   be `'DispatchTo
+00016370: 5369 6e67 6c65 2760 2c20 6027 526f 756e  Single'`, `'Roun
+00016380: 6452 6f62 696e 2760 2c20 6027 5069 6e6e  dRobin'`, `'Pinn
+00016390: 6564 2760 2c20 6f72 2060 2750 696e 6e65  ed'`, or `'Pinne
+000163a0: 6442 7943 6f72 7265 6c61 7469 6f6e 2760  dByCorrelation'`
+000163b0: 2e20 5468 650a 6465 6661 756c 7420 7661  . The.default va
+000163c0: 6c75 6520 6973 2060 2744 6973 7061 7463  lue is `'Dispatc
+000163d0: 6854 6f53 696e 676c 6527 602e 0a0a 5468  hToSingle'`...Th
+000163e0: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
+000163f0: 616b 6573 2061 6e20 6f70 7469 6f6e 616c  akes an optional
+00016400: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00016410: 656e 742c 2074 6861 740a 6973 2065 7870  ent, that.is exp
+00016420: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+00016430: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
+00016440: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+00016450: 696e 650a 666f 7220 7468 6520 636f 6d70  ine.for the comp
+00016460: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+00016470: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+00016480: 6869 7320 6d65 7468 6f64 2064 6f65 7320  his method does 
+00016490: 6e6f 7420 7265 7475 726e 2061 2076 616c  not return a val
+000164a0: 7565 2e20 4576 656e 7473 2063 616e 2062  ue. Events can b
+000164b0: 6520 7265 6365 6976 6564 2062 7920 6361  e received by ca
+000164c0: 6c6c 696e 670a 6072 6561 645f 7374 7265  lling.`read_stre
+000164d0: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
+000164e0: 2960 2e0a 0a54 6865 2065 7861 6d70 6c65  )`...The example
+000164f0: 2062 656c 6f77 2063 7265 6174 6573 2061   below creates a
+00016500: 2070 6572 7369 7374 656e 7420 7374 7265   persistent stre
+00016510: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
+00016520: 6672 6f6d 2074 6865 2073 7461 7274 206f  from the start o
+00016530: 6620 7468 6520 7374 7265 616d 2e0a 0a60  f the stream...`
+00016540: 6060 7079 7468 6f6e 0a23 2043 7265 6174  ``python.# Creat
+00016550: 6520 6120 7065 7273 6973 7465 6e74 2073  e a persistent s
+00016560: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00016570: 6f6e 2066 726f 6d20 7374 6172 7420 6f66  on from start of
+00016580: 2074 6865 2073 7472 6561 6d2e 0a67 726f   the stream..gro
+00016590: 7570 5f6e 616d 6532 203d 2066 2267 726f  up_name2 = f"gro
+000165a0: 7570 2d7b 7575 6964 2e75 7569 6434 2829  up-{uuid.uuid4()
+000165b0: 7d22 0a63 6c69 656e 742e 6372 6561 7465  }".client.create
+000165c0: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
+000165d0: 7469 6f6e 280a 2020 2020 6772 6f75 705f  tion(.    group_
+000165e0: 6e61 6d65 3d67 726f 7570 5f6e 616d 6532  name=group_name2
+000165f0: 2c0a 2020 2020 7374 7265 616d 5f6e 616d  ,.    stream_nam
+00016600: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
+00016610: 290a 6060 600a 0a23 2323 2052 6561 6420  ).```..### Read 
+00016620: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00016630: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
+00016640: 6561 6465 722a 0a0a 5468 6520 6072 6561  eader*..The `rea
+00016650: 645f 7374 7265 616d 5f73 7562 7363 7269  d_stream_subscri
+00016660: 7074 696f 6e28 2960 206d 6574 686f 6420  ption()` method 
+00016670: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
+00016680: 6561 6420 6120 7065 7273 6973 7465 6e74  ead a persistent
+00016690: 0a73 7472 6561 6d20 7375 6273 6372 6970  .stream subscrip
+000166a0: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+000166b0: 6f64 2068 6173 2074 776f 2072 6571 7569  od has two requi
+000166c0: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
+000166d0: 6772 6f75 705f 6e61 6d65 6020 616e 6420  group_name` and 
+000166e0: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
+000166f0: 6869 6368 0a73 686f 756c 6420 6d61 7463  hich.should matc
+00016700: 6820 7468 6520 7661 6c75 6573 206f 6620  h the values of 
+00016710: 6172 6775 6d65 6e74 7320 7573 6564 2077  arguments used w
+00016720: 6865 6e20 6361 6c6c 696e 6720 6063 7265  hen calling `cre
+00016730: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
+00016740: 7269 7074 696f 6e28 2960 2e0a 0a54 6869  ription()`...Thi
+00016750: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
+00016760: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00016770: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00016780: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
+00016790: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
+000167a0: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
+000167b0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
+000167c0: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
+000167d0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+000167e0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
+000167f0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
+00016800: 6120 6050 6572 7369 7374 656e 7453 7562  a `PersistentSub
+00016810: 7363 7269 7074 696f 6e60 206f 626a 6563  scription` objec
+00016820: 742c 2077 6869 6368 2069 7320 616e 2069  t, which is an i
+00016830: 7465 7261 746f 720a 6769 7669 6e67 2060  terator.giving `
+00016840: 5265 636f 7264 6564 4576 656e 7460 206f  RecordedEvent` o
+00016850: 626a 6563 7473 2c20 7468 6174 2061 6c73  bjects, that als
+00016860: 6f20 6861 7320 6061 636b 2829 602c 2060  o has `ack()`, `
+00016870: 6e61 636b 2829 6020 616e 6420 6073 746f  nack()` and `sto
+00016880: 7028 2960 0a6d 6574 686f 6473 2e0a 0a60  p()`.methods...`
+00016890: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
+000168a0: 7074 696f 6e20 3d20 636c 6965 6e74 2e72  ption = client.r
+000168b0: 6561 645f 7374 7265 616d 5f73 7562 7363  ead_stream_subsc
+000168c0: 7269 7074 696f 6e28 0a20 2020 2067 726f  ription(.    gro
+000168d0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+000168e0: 6d65 322c 0a20 2020 2073 7472 6561 6d5f  me2,.    stream_
+000168f0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00016900: 322c 0a29 0a60 6060 0a0a 5468 6520 6578  2,.).```..The ex
+00016910: 616d 706c 6520 6265 6c6f 7720 6974 6572  ample below iter
+00016920: 6174 6573 206f 7665 7220 7468 6520 7375  ates over the su
+00016930: 6273 6372 6970 7469 6f6e 206f 626a 6563  bscription objec
+00016940: 742c 2061 6e64 2063 616c 6c73 2060 6163  t, and calls `ac
+00016950: 6b28 2960 2e0a 5468 6520 666f 7220 6c6f  k()`..The for lo
+00016960: 6f70 2062 7265 616b 7320 7768 656e 2077  op breaks when w
+00016970: 6520 6861 7665 2072 6563 6569 7665 6420  e have received 
+00016980: 7468 6520 6c61 7374 2065 7665 6e74 2069  the last event i
+00016990: 6e20 7468 6520 7374 7265 616d 2c20 736f  n the stream, so
+000169a0: 0a74 6861 7420 7765 2063 616e 2066 696e  .that we can fin
+000169b0: 6973 6820 7468 6520 6578 616d 706c 6573  ish the examples
+000169c0: 2069 6e20 7468 6973 2064 6f63 756d 656e   in this documen
+000169d0: 7461 7469 6f6e 2e0a 0a60 6060 7079 7468  tation...```pyth
+000169e0: 6f6e 0a65 7665 6e74 7320 3d20 5b5d 0a66  on.events = [].f
+000169f0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
+00016a00: 6372 6970 7469 6f6e 3a0a 2020 2020 6576  cription:.    ev
+00016a10: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+00016a20: 7429 0a0a 2020 2020 2320 4163 6b6e 6f77  t)..    # Acknow
+00016a30: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
+00016a40: 6564 2065 7665 6e74 2e0a 2020 2020 7375  ed event..    su
+00016a50: 6273 6372 6970 7469 6f6e 2e61 636b 2865  bscription.ack(e
+00016a60: 7665 6e74 5f69 643d 6576 656e 742e 6964  vent_id=event.id
+00016a70: 290a 0a20 2020 2023 2053 746f 7020 7768  )..    # Stop wh
+00016a80: 656e 2027 6576 656e 7436 2720 6861 7320  en 'event6' has 
+00016a90: 6265 656e 2072 6563 6569 7665 642e 0a20  been received.. 
+00016aa0: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
+00016ab0: 3d20 6576 656e 7436 2e69 643a 0a20 2020  = event6.id:.   
+00016ac0: 2020 2020 2073 7562 7363 7269 7074 696f       subscriptio
+00016ad0: 6e2e 7374 6f70 2829 0a60 6060 0a0a 5765  n.stop().```..We
+00016ae0: 2063 616e 2063 6865 636b 2077 6520 7265   can check we re
+00016af0: 6365 6976 6564 2061 6c6c 2074 6865 2065  ceived all the e
+00016b00: 7665 6e74 7320 7468 6174 2077 6572 6520  vents that were 
+00016b10: 6170 7065 6e64 6564 2074 6f20 6073 7472  appended to `str
+00016b20: 6561 6d5f 6e61 6d65 3260 0a69 6e20 7468  eam_name2`.in th
+00016b30: 6520 6578 616d 706c 6573 2061 626f 7665  e examples above
+00016b40: 2e0a 0a60 6060 7079 7468 6f6e 0a61 7373  ...```python.ass
+00016b50: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+00016b60: 3d3d 2033 0a61 7373 6572 7420 6576 656e  == 3.assert even
+00016b70: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
+00016b80: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+00016b90: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
+00016ba0: 305d 2e69 6420 3d3d 2065 7665 6e74 342e  0].id == event4.
+00016bb0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00016bc0: 5b31 5d2e 7374 7265 616d 5f6e 616d 6520  [1].stream_name 
+00016bd0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
+00016be0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+00016bf0: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
+00016c00: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
+00016c10: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+00016c20: 2073 7472 6561 6d5f 6e61 6d65 320a 6173   stream_name2.as
+00016c30: 7365 7274 2065 7665 6e74 735b 325d 2e69  sert events[2].i
+00016c40: 6420 3d3d 2065 7665 6e74 362e 6964 0a60  d == event6.id.`
+00016c50: 6060 0a0a 2323 2320 4765 7420 7374 7265  ``..### Get stre
+00016c60: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
+00016c70: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
+00016c80: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
+00016c90: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
+00016ca0: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
+00016cb0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00016cc0: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
+00016cd0: 696f 6e20 666f 7220 610a 7065 7273 6973  ion for a.persis
+00016ce0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00016cf0: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
+00016d00: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00016d10: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
+00016d20: 6775 6d65 6e74 732c 2060 6772 6f75 705f  guments, `group_
+00016d30: 6e61 6d65 6020 616e 6420 6073 7472 6561  name` and `strea
+00016d40: 6d5f 6e61 6d65 602c 2077 6869 6368 0a73  m_name`, which.s
+00016d50: 686f 756c 6420 6d61 7463 6820 7468 6520  hould match the 
+00016d60: 7661 6c75 6573 206f 6620 6172 6775 6d65  values of argume
+00016d70: 6e74 7320 7573 6564 2077 6865 6e20 6361  nts used when ca
+00016d80: 6c6c 696e 6720 6063 7265 6174 655f 7374  lling `create_st
+00016d90: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00016da0: 6e28 2960 2e0a 0a54 6869 7320 6d65 7468  n()`...This meth
+00016db0: 6f64 2061 6c73 6f20 6861 7320 616e 206f  od also has an o
+00016dc0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00016dd0: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
+00016de0: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
+00016df0: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
+00016e00: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
+00016e10: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
+00016e20: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00016e30: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00016e40: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
+00016e50: 7375 6273 6372 6970 7469 6f6e 5f69 6e66  subscription_inf
+00016e60: 6f20 3d20 636c 6965 6e74 2e67 6574 5f73  o = client.get_s
+00016e70: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+00016e80: 6f6e 5f69 6e66 6f28 0a20 2020 2067 726f  on_info(.    gro
+00016e90: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+00016ea0: 6d65 322c 0a20 2020 2073 7472 6561 6d5f  me2,.    stream_
+00016eb0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00016ec0: 322c 0a29 0a60 6060 0a0a 5468 6520 7265  2,.).```..The re
+00016ed0: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
+00016ee0: 6120 6053 7562 7363 7269 7074 696f 6e49  a `SubscriptionI
+00016ef0: 6e66 6f60 206f 626a 6563 742e 0a0a 0a23  nfo` object....#
+00016f00: 2323 204c 6973 7420 7374 7265 616d 2073  ## List stream s
+00016f10: 7562 7363 7269 7074 696f 6e73 0a0a 2a72  ubscriptions..*r
+00016f20: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
+00016f30: 0a54 6865 2060 6c69 7374 5f73 7472 6561  .The `list_strea
+00016f40: 6d5f 7375 6273 6372 6970 7469 6f6e 7328  m_subscriptions(
+00016f50: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+00016f60: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
+00016f70: 6f72 6d61 7469 6f6e 2066 6f72 2061 6c6c  ormation for all
+00016f80: 0a74 6865 2070 6572 7369 7374 656e 7420  .the persistent 
+00016f90: 7375 6273 6372 6970 7469 6f6e 7320 666f  subscriptions fo
+00016fa0: 7220 6120 7374 7265 616d 2e0a 0a54 6869  r a stream...Thi
+00016fb0: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
+00016fc0: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00016fd0: 6e74 2c20 6073 7472 6561 6d5f 6e61 6d65  nt, `stream_name
+00016fe0: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
+00016ff0: 616c 736f 2068 6173 2061 6e20 6f70 7469  also has an opti
+00017000: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00017010: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
+00017020: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+00017030: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+00017040: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
+00017050: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
+00017060: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00017070: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00017080: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7562  ...```python.sub
+00017090: 7363 7269 7074 696f 6e73 203d 2063 6c69  scriptions = cli
+000170a0: 656e 742e 6c69 7374 5f73 7472 6561 6d5f  ent.list_stream_
+000170b0: 7375 6273 6372 6970 7469 6f6e 7328 0a20  subscriptions(. 
+000170c0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+000170d0: 7472 6561 6d5f 6e61 6d65 322c 0a29 0a60  tream_name2,.).`
+000170e0: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
+000170f0: 2076 616c 7565 2069 7320 6120 6c69 7374   value is a list
+00017100: 206f 6620 6053 7562 7363 7269 7074 696f   of `Subscriptio
+00017110: 6e49 6e66 6f60 206f 626a 6563 7473 2e0a  nInfo` objects..
+00017120: 0a23 2323 2055 7064 6174 6520 7374 7265  .### Update stre
+00017130: 616d 2073 7562 7363 7269 7074 696f 6e0a  am subscription.
+00017140: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
+00017150: 722a 0a0a 5468 6520 6075 7064 6174 655f  r*..The `update_
+00017160: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
+00017170: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
+00017180: 6e20 6265 2075 7365 6420 746f 2075 7064  n be used to upd
+00017190: 6174 6520 610a 7065 7273 6973 7465 6e74  ate a.persistent
+000171a0: 2073 7562 7363 7269 7074 696f 6e20 666f   subscription fo
+000171b0: 7220 6120 7374 7265 616d 2e0a 0a54 6869  r a stream...Thi
+000171c0: 7320 6d65 7468 6f64 2068 6173 2061 2072  s method has a r
+000171d0: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
+000171e0: 616d 6560 2061 7267 756d 656e 742c 2077  ame` argument, w
+000171f0: 6869 6368 2069 7320 7468 650a 6e61 6d65  hich is the.name
+00017200: 206f 6620 6120 2267 726f 7570 2220 6f66   of a "group" of
+00017210: 2063 6f6e 7375 6d65 7273 206f 6620 7468   consumers of th
+00017220: 6520 7375 6273 6372 6970 7469 6f6e 2c20  e subscription, 
+00017230: 616e 6420 6120 7265 7175 6972 6564 0a60  and a required.`
+00017240: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+00017250: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+00017260: 7468 6520 6e61 6d65 206f 6620 6120 7374  the name of a st
+00017270: 7265 616d 2e0a 0a54 6869 7320 6d65 7468  ream...This meth
+00017280: 6f64 2061 6c73 6f20 6861 7320 7468 7265  od also has thre
+00017290: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
+000172a0: 656e 7473 2c20 6066 726f 6d5f 656e 6460  ents, `from_end`
+000172b0: 2c20 6073 7472 6561 6d5f 706f 7369 7469  , `stream_positi
+000172c0: 6f6e 602c 0a61 6e64 2060 7469 6d65 6f75  on`,.and `timeou
+000172d0: 7460 2e0a 0a54 6865 206f 7074 696f 6e61  t`...The optiona
+000172e0: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
+000172f0: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+00017300: 6420 746f 2073 7065 6369 6679 2074 6861  d to specify tha
+00017310: 7420 7468 6520 6772 6f75 7020 6f66 2063  t the group of c
+00017320: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
+00017330: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
+00017340: 756c 6420 6f6e 6c79 2072 6563 6569 7665  uld only receive
+00017350: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
+00017360: 6520 7265 636f 7264 6564 2061 6674 6572  e recorded after
+00017370: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00017380: 6e0a 7761 7320 7570 6461 7465 642e 0a0a  n.was updated...
+00017390: 416c 7465 726e 6174 6976 656c 792c 2074  Alternatively, t
+000173a0: 6865 206f 7074 696f 6e61 6c20 6073 7472  he optional `str
+000173b0: 6561 6d5f 706f 7369 7469 6f6e 6020 6172  eam_position` ar
+000173c0: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+000173d0: 6564 2074 6f20 7370 6563 6966 7920 6120  ed to specify a 
+000173e0: 7374 7265 616d 0a70 6f73 6974 696f 6e20  stream.position 
+000173f0: 6672 6f6d 2077 6869 6368 2063 6f6d 6d69  from which commi
+00017400: 7420 706f 7369 7469 6f6e 2074 6865 2067  t position the g
+00017410: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+00017420: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
+00017430: 7074 696f 6e20 7368 6f75 6c64 0a72 6563  ption should.rec
+00017440: 6569 7665 2065 7665 6e74 732e 2050 6c65  eive events. Ple
+00017450: 6173 6520 6e6f 7465 2c20 7468 6520 7265  ase note, the re
+00017460: 636f 7264 6564 2065 7665 6e74 2061 7420  corded event at 
+00017470: 7468 6520 7370 6563 6966 6965 6420 7374  the specified st
+00017480: 7265 616d 2070 6f73 6974 696f 6e20 6d69  ream position mi
+00017490: 6768 740a 6265 2069 6e63 6c75 6465 6420  ght.be included 
+000174a0: 696e 2074 6865 2072 6563 6f72 6465 6420  in the recorded 
+000174b0: 6576 656e 7473 2072 6563 6569 7665 6420  events received 
+000174c0: 6279 2074 6865 2067 726f 7570 206f 6620  by the group of 
+000174d0: 636f 6e73 756d 6572 732e 0a0a 4966 206e  consumers...If n
+000174e0: 6569 7468 6572 2060 6672 6f6d 5f65 6e64  either `from_end
+000174f0: 6020 6f72 2060 636f 6d6d 6974 5f70 6f73  ` or `commit_pos
+00017500: 6974 696f 6e60 2061 7265 2073 7065 6369  ition` are speci
+00017510: 6669 6564 2c20 7468 6520 6772 6f75 7020  fied, the group 
+00017520: 6f66 2063 6f6e 7375 6d65 7273 0a6f 6620  of consumers.of 
+00017530: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00017540: 2077 696c 6c20 706f 7465 6e74 6961 6c6c   will potentiall
+00017550: 7920 7265 6365 6976 6520 616c 6c20 7265  y receive all re
+00017560: 636f 7264 6564 2065 7665 6e74 7320 696e  corded events in
+00017570: 2074 6865 2073 7472 6561 6d2e 0a0a 506c   the stream...Pl
+00017580: 6561 7365 206e 6f74 652c 2074 6865 2063  ease note, the c
+00017590: 6f6e 7375 6d65 7220 7374 7261 7465 6779  onsumer strategy
+000175a0: 2063 616e 6e6f 7420 6265 2061 646a 7573   cannot be adjus
+000175b0: 7465 642e 0a0a 5468 6520 6f70 7469 6f6e  ted...The option
+000175c0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+000175d0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+000175e0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+000175f0: 7365 7473 2061 0a64 6561 646c 696e 6520  sets a.deadline 
+00017600: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00017610: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00017620: 7065 7261 7469 6f6e 2e0a 0a54 6865 2060  peration...The `
+00017630: 7570 6461 7465 5f73 7472 6561 6d5f 7375  update_stream_su
+00017640: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
+00017650: 7468 6f64 2064 6f65 7320 6e6f 7420 7265  thod does not re
+00017660: 7475 726e 2061 2076 616c 7565 2e0a 0a49  turn a value...I
+00017670: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
+00017680: 6c6f 772c 2061 2070 6572 7369 7374 656e  low, a persisten
+00017690: 7420 7375 6273 6372 6970 7469 6f6e 2066  t subscription f
+000176a0: 6f72 2061 2073 7472 6561 6d20 6973 2075  or a stream is u
+000176b0: 7064 6174 6564 2074 6f20 7275 6e20 6672  pdated to run fr
+000176c0: 6f6d 2074 6865 0a65 6e64 206f 6620 7468  om the.end of th
+000176d0: 6520 7374 7265 616d 2e0a 0a60 6060 7079  e stream...```py
+000176e0: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
+000176f0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00017700: 7269 7074 696f 6e2e 0a63 6c69 656e 742e  ription..client.
+00017710: 7570 6461 7465 5f73 7472 6561 6d5f 7375  update_stream_su
+00017720: 6273 6372 6970 7469 6f6e 280a 2020 2020  bscription(.    
+00017730: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+00017740: 5f6e 616d 6532 2c0a 2020 2020 7374 7265  _name2,.    stre
+00017750: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00017760: 616d 6532 2c0a 2020 2020 6672 6f6d 5f65  ame2,.    from_e
+00017770: 6e64 3d54 7275 652c 0a29 0a60 6060 0a0a  nd=True,.).```..
+00017780: 2323 2320 5265 706c 6179 2070 6172 6b65  ### Replay parke
+00017790: 6420 6576 656e 7473 0a0a 2a72 6571 7569  d events..*requi
+000177a0: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
+000177b0: 2060 7265 706c 6179 5f70 6172 6b65 645f   `replay_parked_
+000177c0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+000177d0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+000177e0: 2272 6570 6c61 7922 2065 7665 6e74 7320  "replay" events 
+000177f0: 7468 6174 2068 6176 650a 6265 656e 2022  that have.been "
+00017800: 7061 726b 6564 2220 286e 6567 6174 6976  parked" (negativ
+00017810: 656c 7920 6163 6b6e 6f77 6c65 6467 6564  ely acknowledged
+00017820: 2077 6974 6820 7468 6520 6163 7469 6f6e   with the action
+00017830: 2060 2770 6172 6b27 6029 2077 6865 6e20   `'park'`) when 
+00017840: 7265 6164 696e 670a 6120 7065 7273 6973  reading.a persis
+00017850: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00017860: 6e2e 2050 6172 6b65 6420 6576 656e 7473  n. Parked events
+00017870: 2077 696c 6c20 7468 656e 2062 6520 7265   will then be re
+00017880: 6365 6976 6564 2062 7920 7468 6520 636f  ceived by the co
+00017890: 6e73 756d 6572 730a 7265 6164 696e 6720  nsumers.reading 
+000178a0: 6672 6f6d 2074 6865 2070 6572 7369 7374  from the persist
+000178b0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+000178c0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+000178d0: 6173 206f 6e65 2072 6571 7569 7265 6420  as one required 
+000178e0: 6172 6775 6d65 6e74 2c20 6067 726f 7570  argument, `group
+000178f0: 5f6e 616d 6560 2e20 4974 2068 6173 206f  _name`. It has o
+00017900: 6e65 206f 7074 696f 6e61 6c20 6172 6775  ne optional argu
+00017910: 6d65 6e74 2c0a 6073 7472 6561 6d5f 6e61  ment,.`stream_na
+00017920: 6d65 602e 2054 6865 2076 616c 7565 7320  me`. The values 
+00017930: 6f66 2074 6865 7365 2061 7267 756d 656e  of these argumen
+00017940: 7473 2073 686f 756c 6420 6d61 7463 6820  ts should match 
+00017950: 7468 6f73 6520 7573 6564 2077 6865 6e20  those used when 
+00017960: 6361 6c6c 696e 670a 6063 7265 6174 655f  calling.`create_
+00017970: 7375 6273 6372 6970 7469 6f6e 2829 6020  subscription()` 
+00017980: 6f72 2060 6372 6561 7465 5f73 7472 6561  or `create_strea
+00017990: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
+000179a0: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
+000179b0: 616c 736f 2068 6173 2061 6e20 6f70 7469  also has an opti
+000179c0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+000179d0: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
+000179e0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+000179f0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+00017a00: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
+00017a10: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
+00017a20: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00017a30: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00017a40: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
+00017a50: 656c 6f77 2072 6570 6c61 7973 2070 6172  elow replays par
+00017a60: 6b65 6420 6576 656e 7473 2066 6f72 2067  ked events for g
+00017a70: 726f 7570 2060 6772 6f75 705f 6e61 6d65  roup `group_name
+00017a80: 3160 2e0a 0a60 6060 7079 7468 6f6e 0a63  1`...```python.c
+00017a90: 6c69 656e 742e 7265 706c 6179 5f70 6172  lient.replay_par
+00017aa0: 6b65 645f 6576 656e 7473 280a 2020 2020  ked_events(.    
+00017ab0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+00017ac0: 5f6e 616d 6531 2c0a 290a 6060 600a 0a54  _name1,.).```..T
+00017ad0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00017ae0: 2072 6570 6c61 7973 2070 6172 6b65 6420   replays parked 
+00017af0: 6576 656e 7473 2066 6f72 2067 726f 7570  events for group
+00017b00: 2060 6772 6f75 705f 6e61 6d65 3260 2e0a   `group_name2`..
+00017b10: 0a60 6060 7079 7468 6f6e 0a63 6c69 656e  .```python.clien
+00017b20: 742e 7265 706c 6179 5f70 6172 6b65 645f  t.replay_parked_
+00017b30: 6576 656e 7473 280a 2020 2020 6772 6f75  events(.    grou
+00017b40: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+00017b50: 6532 2c0a 2020 2020 7374 7265 616d 5f6e  e2,.    stream_n
+00017b60: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00017b70: 2c0a 290a 6060 600a 0a23 2323 2044 656c  ,.).```..### Del
+00017b80: 6574 6520 7065 7273 6973 7465 6e74 2073  ete persistent s
+00017b90: 7562 7363 7269 7074 696f 6e0a 0a2a 7265  ubscription..*re
+00017ba0: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
+00017bb0: 5468 6520 6064 656c 6574 655f 7065 7273  The `delete_pers
+00017bc0: 6973 7465 6e74 5f73 7562 7363 7269 7074  istent_subscript
+00017bd0: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
+00017be0: 6e20 6265 2075 7365 6420 746f 2064 656c  n be used to del
+00017bf0: 6574 6520 6120 7065 7273 6973 7465 6e74  ete a persistent
+00017c00: 0a73 7562 7363 7269 7074 696f 6e2e 0a0a  .subscription...
+00017c10: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00017c20: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
+00017c30: 756d 656e 742c 2060 6772 6f75 705f 6e61  ument, `group_na
+00017c40: 6d65 602e 2049 7420 6861 7320 6f6e 6520  me`. It has one 
+00017c50: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+00017c60: 742c 0a60 7374 7265 616d 5f6e 616d 6560  t,.`stream_name`
+00017c70: 2e20 5468 6520 7661 6c75 6573 206f 6620  . The values of 
+00017c80: 7468 6573 6520 6172 6775 6d65 6e74 7320  these arguments 
+00017c90: 7368 6f75 6c64 206d 6174 6368 2074 686f  should match tho
+00017ca0: 7365 2075 7365 6420 7768 656e 2063 616c  se used when cal
+00017cb0: 6c69 6e67 0a60 6372 6561 7465 5f73 7562  ling.`create_sub
+00017cc0: 7363 7269 7074 696f 6e28 2960 206f 7220  scription()` or 
+00017cd0: 6063 7265 6174 655f 7374 7265 616d 5f73  `create_stream_s
+00017ce0: 7562 7363 7269 7074 696f 6e28 2960 2e0a  ubscription()`..
+00017cf0: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+00017d00: 6f20 6861 7320 616e 206f 7074 696f 6e61  o has an optiona
+00017d10: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00017d20: 6d65 6e74 2c20 7468 6174 0a69 7320 6578  ment, that.is ex
+00017d30: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
+00017d40: 7974 686f 6e20 6066 6c6f 6174 602c 2077  ython `float`, w
+00017d50: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
+00017d60: 6c69 6e65 0a66 6f72 2074 6865 2063 6f6d  line.for the com
+00017d70: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00017d80: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+00017d90: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00017da0: 7720 6465 6c65 7465 7320 7468 6520 7375  w deletes the su
+00017db0: 6273 6372 6970 7469 6f6e 2066 6f72 2067  bscription for g
+00017dc0: 726f 7570 2060 6772 6f75 705f 6e61 6d65  roup `group_name
+00017dd0: 3160 2077 6869 6368 2077 6173 2063 7265  1` which was cre
+00017de0: 6174 6564 0a62 7920 6361 6c6c 696e 6720  ated.by calling 
+00017df0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
+00017e00: 7469 6f6e 2829 602e 0a0a 6060 6070 7974  tion()`...```pyt
+00017e10: 686f 6e0a 636c 6965 6e74 2e64 656c 6574  hon.client.delet
+00017e20: 655f 7065 7273 6973 7465 6e74 5f73 7562  e_persistent_sub
+00017e30: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
+00017e40: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+00017e50: 6e61 6d65 312c 0a29 0a60 6060 0a0a 5468  name1,.).```..Th
+00017e60: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00017e70: 6465 6c65 7465 7320 7468 6520 7375 6273  deletes the subs
+00017e80: 6372 6970 7469 6f6e 2066 6f72 2067 726f  cription for gro
+00017e90: 7570 2060 6772 6f75 705f 6e61 6d65 3260  up `group_name2`
+00017ea0: 2077 6869 6368 2077 6173 2063 7265 6174   which was creat
+00017eb0: 6564 0a62 7920 6361 6c6c 696e 6720 6063  ed.by calling `c
+00017ec0: 7265 6174 655f 7374 7265 616d 5f73 7562  reate_stream_sub
+00017ed0: 7363 7269 7074 696f 6e28 2960 2e0a 0a60  scription()`...`
+00017ee0: 6060 7079 7468 6f6e 0a63 6c69 656e 742e  ``python.client.
+00017ef0: 6465 6c65 7465 5f70 6572 7369 7374 656e  delete_persisten
+00017f00: 745f 7375 6273 6372 6970 7469 6f6e 280a  t_subscription(.
+00017f10: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
+00017f20: 726f 7570 5f6e 616d 6532 2c0a 2020 2020  roup_name2,.    
+00017f30: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00017f40: 616d 5f6e 616d 6532 2c0a 290a 6060 600a  am_name2,.).```.
+00017f50: 0a23 2320 436f 6e6e 6563 7469 6f6e 0a0a  .## Connection..
+00017f60: 2323 2320 5265 636f 6e6e 6563 740a 0a54  ### Reconnect..T
+00017f70: 6865 2060 7265 636f 6e6e 6563 7428 2960  he `reconnect()`
+00017f80: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+00017f90: 7365 6420 746f 206d 616e 7561 6c6c 7920  sed to manually 
+00017fa0: 7265 636f 6e6e 6563 7420 7468 6520 636c  reconnect the cl
+00017fb0: 6965 6e74 2074 6f20 610a 7375 6974 6162  ient to a.suitab
+00017fc0: 6c65 2045 7665 6e74 5374 6f72 6544 4220  le EventStoreDB 
+00017fd0: 6e6f 6465 2e20 5468 6973 206d 6574 686f  node. This metho
+00017fe0: 6420 7573 6573 2074 6865 2073 616d 6520  d uses the same 
+00017ff0: 726f 7574 696e 6520 666f 7220 7265 6164  routine for read
+00018000: 696e 6720 7468 650a 636c 7573 7465 7220  ing the.cluster 
+00018010: 6e6f 6465 2073 7461 7465 7320 616e 6420  node states and 
+00018020: 7468 656e 2063 6f6e 6e65 6374 696e 6720  then connecting 
+00018030: 746f 2061 2073 7569 7461 626c 6520 6e6f  to a suitable no
+00018040: 6465 2061 6363 6f72 6469 6e67 2074 6f20  de according to 
+00018050: 7468 650a 636c 6965 6e74 2773 206e 6f64  the.client's nod
+00018060: 6520 7072 6566 6572 656e 6365 2074 6861  e preference tha
+00018070: 7420 6973 2073 7065 6369 6669 6564 2069  t is specified i
+00018080: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
+00018090: 2073 7472 696e 6720 5552 4920 7768 656e   string URI when
+000180a0: 0a74 6865 2063 6c69 656e 7420 6973 2063  .the client is c
+000180b0: 6f6e 7374 7275 6374 6564 2e20 5468 6973  onstructed. This
+000180c0: 206d 6574 686f 6420 6973 2074 6872 6561   method is threa
+000180d0: 642d 7361 6665 2c20 696e 2074 6861 7420  d-safe, in that 
+000180e0: 7768 656e 2069 7420 6973 2063 616c 6c65  when it is calle
+000180f0: 640a 6279 2073 6576 6572 616c 2074 6872  d.by several thr
+00018100: 6561 6473 2061 7420 7468 6520 7361 6d65  eads at the same
+00018110: 2074 696d 652c 206f 6e6c 7920 6f6e 6520   time, only one 
+00018120: 7265 636f 6e6e 6563 7469 6f6e 2077 696c  reconnection wil
+00018130: 6c20 6f63 6375 722e 2043 6f6e 6375 7272  l occur. Concurr
+00018140: 656e 740a 6174 7465 6d70 7473 2074 6f20  ent.attempts to 
+00018150: 7265 636f 6e6e 6563 7420 7769 6c6c 2062  reconnect will b
+00018160: 6c6f 636b 2075 6e74 696c 2074 6865 2063  lock until the c
+00018170: 6c69 656e 7420 6861 7320 7265 636f 6e6e  lient has reconn
+00018180: 6563 7465 6420 7375 6363 6573 7366 756c  ected successful
+00018190: 6c79 2c0a 616e 6420 7468 656e 2074 6865  ly,.and then the
+000181a0: 7920 7769 6c6c 2061 6c6c 2072 6574 7572  y will all retur
+000181b0: 6e20 6e6f 726d 616c 6c79 2e0a 0a60 6060  n normally...```
+000181c0: 7079 7468 6f6e 0a63 6c69 656e 742e 7265  python.client.re
+000181d0: 636f 6e6e 6563 7428 290a 6060 600a 0a41  connect().```..A
+000181e0: 6e20 6578 616d 706c 6520 6f66 2077 6865  n example of whe
+000181f0: 6e20 6974 206d 6967 6874 2062 6520 6465  n it might be de
+00018200: 7369 7261 626c 6520 746f 2072 6563 6f6e  sirable to recon
+00018210: 6e65 6374 206d 616e 7561 6c6c 7920 6973  nect manually is
+00018220: 2077 6865 6e20 2866 6f72 2070 6572 666f   when (for perfo
+00018230: 726d 616e 6365 0a72 6561 736f 6e73 2920  rmance.reasons) 
+00018240: 7468 6520 636c 6965 6e74 2773 206e 6f64  the client's nod
+00018250: 6520 7072 6566 6572 656e 6365 2069 7320  e preference is 
+00018260: 746f 2062 6520 636f 6e6e 6563 7465 6420  to be connected 
+00018270: 746f 2061 2066 6f6c 6c6f 7765 7220 6e6f  to a follower no
+00018280: 6465 2069 6e20 7468 650a 636c 7573 7465  de in the.cluste
+00018290: 722c 2061 6e64 2c20 6166 7465 7220 6120  r, and, after a 
+000182a0: 636c 7573 7465 7220 6c65 6164 6572 2065  cluster leader e
+000182b0: 6c65 6374 696f 6e2c 2074 6865 2066 6f6c  lection, the fol
+000182c0: 6c6f 7765 7220 6265 636f 6d65 7320 7468  lower becomes th
+000182d0: 6520 6c65 6164 6572 2e0a 5265 636f 6e6e  e leader..Reconn
+000182e0: 6563 7469 6e67 2074 6f20 6120 666f 6c6c  ecting to a foll
+000182f0: 6f77 6572 206e 6f64 6520 696e 2074 6869  ower node in thi
+00018300: 7320 6361 7365 2069 7320 6375 7272 656e  s case is curren
+00018310: 746c 7920 6265 796f 6e64 2074 6865 2063  tly beyond the c
+00018320: 6170 6162 696c 6974 6965 7320 6f66 0a74  apabilities of.t
+00018330: 6869 7320 636c 6965 6e74 2c20 6275 7420  his client, but 
+00018340: 7468 6973 2062 6568 6176 696f 7220 6d69  this behavior mi
+00018350: 6768 7420 6265 2069 6d70 6c65 6d65 6e74  ght be implement
+00018360: 6564 2069 6e20 6120 6675 7475 7265 2072  ed in a future r
+00018370: 656c 6561 7365 2e0a 0a50 6c65 6173 6520  elease...Please 
+00018380: 6e6f 7465 2c20 6e65 6172 6c79 2061 6c6c  note, nearly all
+00018390: 2074 6865 2063 6c69 656e 7420 6d65 7468   the client meth
+000183a0: 6f64 7320 6172 6520 6465 636f 7261 7465  ods are decorate
+000183b0: 6420 7769 7468 2060 4061 7574 6f72 6563  d with `@autorec
+000183c0: 6f6e 6e65 6374 6020 2877 6869 6368 0a63  onnect` (which.c
+000183d0: 616c 6c73 2074 6865 2060 7265 636f 6e6e  alls the `reconn
+000183e0: 6563 7428 2960 206d 6574 686f 6420 7768  ect()` method wh
+000183f0: 656e 2074 6865 2063 6c69 656e 7420 6465  en the client de
+00018400: 7465 6374 7320 7468 6174 2072 6563 6f6e  tects that recon
+00018410: 6e65 6374 696e 6720 6973 2072 6571 7569  necting is requi
+00018420: 7265 6429 0a61 6e64 2061 2060 4072 6574  red).and a `@ret
+00018430: 7279 6020 6465 636f 7261 746f 7220 7468  ry` decorator th
+00018440: 6174 206d 6f72 6520 6765 6e65 7261 6c6c  at more generall
+00018450: 7920 7769 6c6c 2072 6574 7279 206f 7065  y will retry ope
+00018460: 7261 7469 6f6e 7320 7468 6174 2066 6169  rations that fai
+00018470: 6c20 6475 6520 746f 0a63 6f6e 6e65 6374  l due to.connect
+00018480: 696f 6e20 6973 7375 6573 2e0a 0a54 6865  ion issues...The
+00018490: 2060 4061 7574 6f72 6563 6f6e 6e65 6374   `@autoreconnect
+000184a0: 6020 6465 636f 7261 746f 7220 7769 6c6c  ` decorator will
+000184b0: 2072 6563 6f6e 6e65 6374 2074 6f20 6120   reconnect to a 
+000184c0: 7375 6974 6162 6c65 206e 6f64 6520 696e  suitable node in
+000184d0: 2074 6865 2063 6c75 7374 6572 2077 6865   the cluster whe
+000184e0: 6e0a 7468 6520 7365 7276 6572 2074 6f20  n.the server to 
+000184f0: 7768 6963 6820 7468 6520 636c 6965 6e74  which the client
+00018500: 2068 6173 2062 6565 6e20 636f 6e6e 6563   has been connec
+00018510: 7465 6420 6861 7320 6265 636f 6d65 2075  ted has become u
+00018520: 6e61 7661 696c 6162 6c65 2c20 6f72 2077  navailable, or w
+00018530: 6865 6e20 7468 650a 636c 6965 6e74 2773  hen the.client's
+00018540: 2067 5250 4320 6368 616e 6e65 6c20 6861   gRPC channel ha
+00018550: 7070 656e 7320 746f 2068 6176 6520 6265  ppens to have be
+00018560: 656e 2063 6c6f 7365 642e 2054 6865 2063  en closed. The c
+00018570: 6c69 656e 7420 7769 6c6c 2061 6c73 6f20  lient will also 
+00018580: 7265 636f 6e6e 6563 7420 7768 656e 0a61  reconnect when.a
+00018590: 206d 6574 686f 6420 6973 2063 616c 6c65   method is calle
+000185a0: 6420 7468 6174 2072 6571 7569 7265 7320  d that requires 
+000185b0: 6120 6c65 6164 6572 2c20 616e 6420 7468  a leader, and th
+000185c0: 6520 636c 6965 6e74 2773 206e 6f64 6520  e client's node 
+000185d0: 7072 6566 6572 656e 6365 2069 7320 746f  preference is to
+000185e0: 2062 650a 636f 6e6e 6563 7465 6420 746f   be.connected to
+000185f0: 2061 206c 6561 6465 722c 2062 7574 2074   a leader, but t
+00018600: 6865 206e 6f64 6520 7468 6174 2074 6865  he node that the
+00018610: 2063 6c69 656e 7420 6861 7320 6265 656e   client has been
+00018620: 2063 6f6e 6e65 6374 6564 2074 6f20 7374   connected to st
+00018630: 6f70 7320 6265 696e 670a 7468 6520 6c65  ops being.the le
+00018640: 6164 6572 2e20 496e 2074 6869 7320 6361  ader. In this ca
+00018650: 7365 2c20 7468 6520 636c 6965 6e74 2077  se, the client w
+00018660: 696c 6c20 7265 636f 6e6e 6563 7420 746f  ill reconnect to
+00018670: 2074 6865 2063 7572 7265 6e74 206c 6561   the current lea
+00018680: 6465 722e 2041 6674 6572 0a72 6563 6f6e  der. After.recon
+00018690: 6e65 6374 696e 672c 2074 6865 2066 6169  necting, the fai
+000186a0: 6c65 6420 6f70 6572 6174 696f 6e20 7769  led operation wi
+000186b0: 6c6c 2062 6520 7265 7472 6965 642e 0a0a  ll be retried...
+000186c0: 5468 6520 6040 7265 7472 7960 2064 6563  The `@retry` dec
+000186d0: 6f72 6174 6f72 2072 6574 7269 6573 206f  orator retries o
+000186e0: 7065 7261 7469 6f6e 7320 7468 6174 2068  perations that h
+000186f0: 6176 6520 6661 696c 6564 2064 7565 2074  ave failed due t
+00018700: 6f20 6d6f 7265 2067 656e 6572 616c 0a63  o more general.c
+00018710: 6f6e 6e65 6374 696f 6e20 6973 7375 6573  onnection issues
+00018720: 2c20 7375 6368 2061 7320 6120 6465 6164  , such as a dead
+00018730: 6c69 6e65 2062 6569 6e67 2072 6561 6368  line being reach
+00018740: 6564 2028 736f 2074 6861 7420 7468 6520  ed (so that the 
+00018750: 6f70 6572 6174 696f 6e20 7469 6d65 730a  operation times.
+00018760: 6f75 7429 2c20 6f72 2069 6e20 6361 7365  out), or in case
+00018770: 2074 6865 2073 6572 7665 7220 7468 726f   the server thro
+00018780: 7773 2061 6e20 6578 6365 7074 696f 6e20  ws an exception 
+00018790: 7768 656e 2068 616e 646c 696e 6720 6120  when handling a 
+000187a0: 636c 6965 6e74 2072 6571 7565 7374 2e0a  client request..
+000187b0: 0a50 6c65 6173 6520 616c 736f 206e 6f74  .Please also not
+000187c0: 652c 2074 6865 2061 7370 6563 7473 206e  e, the aspects n
+000187d0: 6f74 2063 6f76 6572 6564 2062 7920 7468  ot covered by th
+000187e0: 6520 7265 636f 6e6e 6563 7420 616e 6420  e reconnect and 
+000187f0: 7265 7472 7920 6465 636f 7261 746f 720a  retry decorator.
+00018800: 6265 6861 7669 6f75 7273 2068 6176 6520  behaviours have 
+00018810: 746f 2064 6f20 7769 7468 206d 6574 686f  to do with metho
+00018820: 6473 2074 6861 7420 7265 7475 726e 2069  ds that return i
+00018830: 7465 7261 746f 7273 2e20 466f 7220 6578  terators. For ex
+00018840: 616d 706c 652c 2063 6f6e 7369 6465 720a  ample, consider.
+00018850: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+00018860: 7365 2220 6974 6572 6174 6f72 2072 6574  se" iterator ret
+00018870: 7572 6e65 6420 6672 6f6d 2074 6865 2060  urned from the `
+00018880: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+00018890: 2960 206d 6574 686f 642e 2054 6865 0a60  )` method. The.`
+000188a0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+000188b0: 2960 206d 6574 686f 6420 7769 6c6c 2068  )` method will h
+000188c0: 6176 6520 7265 7475 726e 6564 2c20 616e  ave returned, an
+000188d0: 6420 7468 6520 6d65 7468 6f64 2064 6563  d the method dec
+000188e0: 6f72 6174 6f72 7320 7769 6c6c 2074 6865  orators will the
+000188f0: 7265 666f 7265 0a68 6176 6520 6578 6974  refore.have exit
+00018900: 6564 2c20 6265 666f 7265 2069 7465 7261  ed, before itera
+00018910: 7469 6e67 206f 7665 7220 7468 6520 2272  ting over the "r
+00018920: 6561 6420 7265 7370 6f6e 7365 2220 6265  ead response" be
+00018930: 6769 6e73 2e20 5468 6572 6566 6f72 652c  gins. Therefore,
+00018940: 2069 6620 610a 636f 6e6e 6563 7469 6f6e   if a.connection
+00018950: 2069 7373 7565 7320 6f63 6375 7273 2077   issues occurs w
+00018960: 6869 6c73 7420 6974 6572 6174 696e 6720  hilst iterating 
+00018970: 6f76 6572 2074 6865 2022 7265 6164 2072  over the "read r
+00018980: 6573 706f 6e73 6522 2c20 6974 2069 736e  esponse", it isn
+00018990: 2774 2070 6f73 7369 626c 650a 666f 7220  't possible.for 
+000189a0: 616e 7920 6465 636f 7261 746f 7220 6f6e  any decorator on
+000189b0: 2074 6865 2060 7265 6164 5f61 6c6c 5f65   the `read_all_e
+000189c0: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
+000189d0: 746f 2074 7269 6767 6572 2061 2072 6563  to trigger a rec
+000189e0: 6f6e 6e65 6374 696f 6e2e 0a0a 416e 6f74  onnection...Anot
+000189f0: 6865 7220 6578 616d 706c 6520 6973 2069  her example is i
+00018a00: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
+00018a10: 6520 2272 6561 6420 7265 7370 6f6e 7365  e "read response
+00018a20: 2220 6672 6f6d 2061 2063 6174 6368 2d75  " from a catch-u
+00018a30: 7020 7375 6273 6372 6970 7469 6f6e 2e0a  p subscription..
+00018a40: 416c 7468 6f75 6768 2c20 7769 7468 2074  Although, with t
+00018a50: 6865 7365 206d 6574 686f 6473 2074 6865  hese methods the
+00018a60: 7265 2069 7320 616e 2069 6e69 7469 616c  re is an initial
+00018a70: 2022 636f 6e66 6972 6d61 7469 6f6e 2220   "confirmation" 
+00018a80: 7265 7370 6f6e 7365 2066 726f 6d20 7468  response from th
+00018a90: 6520 7365 7276 6572 0a77 6869 6368 2069  e server.which i
+00018aa0: 7320 7265 6365 6976 6564 2061 6e64 2063  s received and c
+00018ab0: 6865 636b 6564 2062 7920 7468 6520 636c  hecked by the cl
+00018ac0: 6965 6e74 2062 6566 6f72 6520 7468 6520  ient before the 
+00018ad0: 6d65 7468 6f64 2072 6574 7572 6e73 2074  method returns t
+00018ae0: 6865 0a22 7265 6164 2072 6573 706f 6e73  he."read respons
+00018af0: 6522 2069 7465 7261 746f 722e 2041 6e64  e" iterator. And
+00018b00: 2073 6f2c 2077 6865 6e20 7468 6520 6361   so, when the ca
+00018b10: 6c6c 2069 7320 6d61 6465 2c20 6966 2074  ll is made, if t
+00018b20: 6865 2073 6572 7665 7220 6973 2075 6e61  he server is una
+00018b30: 7661 696c 6162 6c65 2c0a 6f72 2069 6620  vailable,.or if 
+00018b40: 7468 6520 6368 616e 6e65 6c20 6861 7320  the channel has 
+00018b50: 736f 6d65 686f 7720 6265 656e 2063 6c6f  somehow been clo
+00018b60: 7365 642c 2074 6865 6e20 7468 6520 636c  sed, then the cl
+00018b70: 6965 6e74 2077 696c 6c20 7265 636f 6e6e  ient will reconn
+00018b80: 6563 7420 616e 6420 7265 7472 792e 0a48  ect and retry..H
+00018b90: 6f77 6576 6572 2c20 6966 2061 6e20 6576  owever, if an ev
+00018ba0: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
+00018bb0: 6f6d 706f 6e65 6e74 2074 6861 7420 6973  omponent that is
+00018bc0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+00018bd0: 6120 7375 6363 6573 7366 756c 6c79 2072  a successfully r
+00018be0: 6574 7572 6e65 640a 6361 7463 682d 7570  eturned.catch-up
+00018bf0: 2073 7562 7363 7269 7074 696f 6e20 2272   subscription "r
+00018c00: 6561 6420 7265 7370 6f6e 7365 2220 736f  ead response" so
+00018c10: 6d65 686f 7720 6661 696c 732c 2074 6865  mehow fails, the
+00018c20: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+00018c30: 6970 7469 6f6e 2077 696c 6c0a 6e65 6564  iption will.need
+00018c40: 2074 6f20 6265 2072 6573 7461 7274 6564   to be restarted
+00018c50: 2c20 7573 696e 6720 7468 6520 6576 656e  , using the even
+00018c60: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
+00018c70: 706f 6e65 6e74 2773 2022 6c61 7374 2073  ponent's "last s
+00018c80: 6176 6564 2063 6f6d 6d69 7420 706f 7369  aved commit posi
+00018c90: 7469 6f6e 222e 0a54 6869 7320 6973 2063  tion"..This is c
+00018ca0: 6f6d 706c 6574 656c 7920 7361 6665 2c20  ompletely safe, 
+00018cb0: 736f 206c 6f6e 6720 6173 2074 6865 2065  so long as the e
+00018cc0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+00018cd0: 636f 6d70 6f6e 656e 7420 6861 7320 6265  component has be
+00018ce0: 656e 2072 6563 6f72 6469 6e67 0a74 6865  en recording.the
+00018cf0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00018d00: 206f 6620 6561 6368 2072 6563 6f72 6465   of each recorde
+00018d10: 6420 6576 656e 7420 6174 6f6d 6963 616c  d event atomical
+00018d20: 6c79 2061 6e64 2075 6e69 7175 656c 7920  ly and uniquely 
+00018d30: 616c 6f6e 6720 7769 7468 2061 6e79 206e  along with any n
+00018d40: 6577 0a73 7461 7465 2074 6861 7420 7265  ew.state that re
+00018d50: 7375 6c74 7320 6672 6f6d 2070 726f 6365  sults from proce
+00018d60: 7373 696e 6720 7468 6520 7265 636f 7264  ssing the record
+00018d70: 6564 2065 7665 6e74 7320 616e 6420 7468  ed events and th
+00018d80: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00018d90: 6e73 2061 7265 0a72 6563 6f72 6465 6420  ns are.recorded 
+00018da0: 7769 7468 2061 2075 6e69 7175 656e 6573  with a uniquenes
+00018db0: 7320 636f 6e73 7472 6169 6e74 2e20 496e  s constraint. In
+00018dc0: 2074 6869 7320 6361 7365 2c20 7468 6520   this case, the 
+00018dd0: 636c 6965 6e74 2077 696c 6c20 6175 746f  client will auto
+00018de0: 6d61 7469 6361 6c6c 790a 7265 636f 6e6e  matically.reconn
+00018df0: 6563 7420 746f 2061 206e 6f64 6520 696e  ect to a node in
+00018e00: 2074 6865 2063 6c75 7374 6572 2077 6865   the cluster whe
+00018e10: 6e20 7468 6520 7375 6273 6571 7565 6e74  n the subsequent
+00018e20: 2063 616c 6c20 746f 2061 2063 6174 6368   call to a catch
+00018e30: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00018e40: 0a6d 6574 686f 6420 6973 206d 6164 652e  .method is made.
+00018e50: 2053 696d 696c 6172 6c79 2c20 7768 656e   Similarly, when
+00018e60: 2072 6561 6469 6e67 2070 6572 7369 7374   reading persist
+00018e70: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00018e80: 732c 2069 6620 7468 6572 6520 6172 650a  s, if there are.
+00018e90: 636f 6e6e 6563 7469 7669 7479 2069 7373  connectivity iss
+00018ea0: 7565 7320 6166 7465 7220 796f 7520 6861  ues after you ha
+00018eb0: 7665 2073 7461 7274 6564 2069 7465 7261  ve started itera
+00018ec0: 7469 6e67 206f 7665 7220 6120 7375 6363  ting over a succ
+00018ed0: 6573 7366 756c 6c79 2072 6563 6569 7665  essfully receive
+00018ee0: 640a 7265 7370 6f6e 7365 2c20 7468 656e  d.response, then
+00018ef0: 2074 6865 2063 6f6e 7375 6d65 7220 7769   the consumer wi
+00018f00: 6c6c 206e 6565 6420 746f 2062 6520 7265  ll need to be re
+00018f10: 7374 6172 7465 642e 0a0a 0a23 2323 2043  started....### C
+00018f20: 6c6f 7365 0a0a 5468 6520 6063 6c6f 7365  lose..The `close
+00018f30: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00018f40: 6520 7573 6564 2074 6f20 636c 6561 6e6c  e used to cleanl
+00018f50: 7920 636c 6f73 6520 7468 6520 636c 6965  y close the clie
+00018f60: 6e74 2773 2067 5250 4320 636f 6e6e 6563  nt's gRPC connec
+00018f70: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
+00018f80: 0a63 6c69 656e 742e 636c 6f73 6528 290a  .client.close().
+00018f90: 6060 600a 0a0a 2323 2041 7379 6e63 696f  ```...## Asyncio
+00018fa0: 2063 6c69 656e 740a 0a54 6865 2060 6573   client..The `es
+00018fb0: 6462 636c 6965 6e74 6020 7061 636b 6167  dbclient` packag
+00018fc0: 6520 616c 736f 2069 6e63 6c75 6465 7320  e also includes 
+00018fd0: 616e 2065 6172 6c79 2076 6572 7369 6f6e  an early version
+00018fe0: 206f 6620 616e 2061 7379 6e63 6872 6f6e   of an asynchron
+00018ff0: 6f75 7320 492f 4f0a 6752 5043 2050 7974  ous I/O.gRPC Pyt
+00019000: 686f 6e20 636c 6965 6e74 2e20 4974 2066  hon client. It f
+00019010: 6f6c 6c6f 7773 2065 7861 6374 6c79 2074  ollows exactly t
+00019020: 6865 2073 616d 6520 6265 6861 7669 6f72  he same behavior
+00019030: 7320 6173 2074 6865 206d 756c 7469 7468  s as the multith
+00019040: 7265 6164 6564 0a60 4553 4442 436c 6965  readed.`ESDBClie
+00019050: 6e74 602c 2062 7574 2075 7365 7320 7468  nt`, but uses th
+00019060: 6520 6067 7270 632e 6169 6f60 2070 6163  e `grpc.aio` pac
+00019070: 6b61 6765 2061 6e64 2074 6865 2060 6173  kage and the `as
+00019080: 796e 6369 6f60 206d 6f64 756c 652c 2069  yncio` module, i
+00019090: 6e73 7465 6164 206f 660a 6067 7270 6360  nstead of.`grpc`
+000190a0: 2061 6e64 2060 7468 7265 6164 696e 6760   and `threading`
+000190b0: 2e0a 0a54 6865 2061 7379 6e63 2066 756e  ...The async fun
+000190c0: 6374 696f 6e20 6041 7379 6e63 696f 4553  ction `AsyncioES
+000190d0: 4442 436c 6965 6e74 6020 636f 6e73 7472  DBClient` constr
+000190e0: 7563 7473 2074 6865 2063 6c69 656e 742c  ucts the client,
+000190f0: 2061 6e64 2063 6f6e 6e65 6374 7320 746f   and connects to
+00019100: 0a61 2073 6572 7665 722e 2049 7420 6361  .a server. It ca
+00019110: 6e20 6265 2069 6d70 6f72 7465 6420 6672  n be imported fr
+00019120: 6f6d 2060 6573 6462 636c 6965 6e74 602c  om `esdbclient`,
+00019130: 2061 6e64 2063 616e 2062 6520 6361 6c6c   and can be call
+00019140: 6564 2077 6974 6820 7468 6520 7361 6d65  ed with the same
+00019150: 0a61 7267 756d 656e 7473 2061 7320 6045  .arguments as `E
+00019160: 5344 4243 6c69 656e 7460 2e20 4974 2073  SDBClient`. It s
+00019170: 7570 706f 7274 7320 626f 7468 2074 6865  upports both the
+00019180: 2022 6573 6462 2220 616e 6420 7468 6520   "esdb" and the 
+00019190: 2265 7364 622b 6469 7363 6f76 6572 220a  "esdb+discover".
+000191a0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+000191b0: 6720 5552 4920 7363 6865 6d65 732c 2061  g URI schemes, a
+000191c0: 6e64 2063 616e 2063 6f6e 6e65 6374 2074  nd can connect t
+000191d0: 6f20 626f 7468 2022 7365 6375 7265 2220  o both "secure" 
+000191e0: 616e 6420 2269 6e73 6563 7572 6522 0a45  and "insecure".E
+000191f0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+00019200: 6572 732e 2049 7420 7265 636f 6e6e 6563  ers. It reconnec
+00019210: 7473 206f 7220 7265 7472 6965 7320 7768  ts or retries wh
+00019220: 656e 2063 6f6e 6e65 6374 696f 6e20 6973  en connection is
+00019230: 7375 6573 206f 7220 7365 7276 6572 0a65  sues or server.e
+00019240: 7272 6f72 7320 6172 6520 656e 636f 756e  rrors are encoun
+00019250: 7465 7265 642e 0a0a 6060 6070 7974 686f  tered...```pytho
+00019260: 6e0a 6672 6f6d 2065 7364 6263 6c69 656e  n.from esdbclien
+00019270: 7420 696d 706f 7274 2041 7379 6e63 696f  t import Asyncio
+00019280: 4553 4442 436c 6965 6e74 0a60 6060 0a0a  ESDBClient.```..
+00019290: 5468 6520 6173 796e 6368 726f 6e6f 7573  The asynchronous
+000192a0: 2049 2f4f 2063 6c69 656e 7420 6861 7320   I/O client has 
+000192b0: 7468 6520 666f 6c6c 6f77 696e 6720 6d65  the following me
+000192c0: 7468 6f64 733a 2060 6170 7065 6e64 5f65  thods: `append_e
+000192d0: 7665 6e74 7328 2960 2c0a 6072 6561 645f  vents()`,.`read_
+000192e0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000192f0: 2c20 6072 6561 645f 616c 6c5f 6576 656e  , `read_all_even
+00019300: 7473 2829 602c 2060 7375 6273 6372 6962  ts()`, `subscrib
+00019310: 655f 616c 6c5f 6576 656e 7473 2829 602c  e_all_events()`,
+00019320: 0a60 6465 6c65 7465 5f73 7472 6561 6d28  .`delete_stream(
+00019330: 2960 2c20 6074 6f6d 6273 746f 6e65 5f73  )`, `tombstone_s
+00019340: 7472 6561 6d28 2960 2c20 616e 6420 6072  tream()`, and `r
+00019350: 6563 6f6e 6e65 6374 2829 602e 0a0a 5468  econnect()`...Th
+00019360: 6573 6520 6d65 7468 6f64 7320 6172 6520  ese methods are 
+00019370: 6571 7569 7661 6c65 6e74 2074 6f20 7468  equivalent to th
+00019380: 6520 6d65 7468 6f64 7320 6f6e 2060 4553  e methods on `ES
+00019390: 4442 436c 6965 6e74 602e 2054 6865 7920  DBClient`. They 
+000193a0: 6861 7665 2074 6865 2073 616d 650a 6d65  have the same.me
+000193b0: 7468 6f64 2073 6967 6e61 7475 7265 732c  thod signatures,
+000193c0: 2061 6e64 2063 616e 2062 6520 6361 6c6c   and can be call
+000193d0: 6564 2077 6974 6820 7468 6520 7361 6d65  ed with the same
+000193e0: 2061 7267 756d 656e 7473 2c20 746f 2074   arguments, to t
+000193f0: 6865 2073 616d 6520 6566 6665 6374 2e0a  he same effect..
+00019400: 5468 6520 6d65 7468 6f64 7320 7768 6963  The methods whic
+00019410: 6820 6170 7065 6172 206f 6e20 6045 5344  h appear on `ESD
+00019420: 4243 6c69 656e 7460 2062 7574 206e 6f74  BClient` but not
+00019430: 206f 6e20 6041 7379 6e63 696f 4553 4442   on `AsyncioESDB
+00019440: 436c 6965 6e74 6020 7769 6c6c 2062 650a  Client` will be.
+00019450: 6164 6465 6420 736f 6f6e 2e0a 0a23 2323  added soon...###
+00019460: 2053 796e 6f70 7369 730a 0a54 6865 2065   Synopsis..The e
+00019470: 7861 6d70 6c65 2062 656c 6f77 2064 656d  xample below dem
+00019480: 6f6e 7374 7261 7465 7320 7468 6520 6061  onstrates the `a
+00019490: 7070 656e 645f 6576 656e 7473 2829 602c  ppend_events()`,
+000194a0: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
+000194b0: 656e 7473 2829 6020 616e 640a 6073 7562  ents()` and.`sub
+000194c0: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
+000194d0: 7328 2960 206d 6574 686f 6473 2e20 5468  s()` methods. Th
+000194e0: 6573 6520 6172 6520 7468 6520 6d6f 7374  ese are the most
+000194f0: 2075 7365 6675 6c20 6d65 7468 6f64 7320   useful methods 
+00019500: 666f 7220 7772 6974 696e 670a 616e 2065  for writing.an e
+00019510: 7665 6e74 2d73 6f75 7263 6564 2061 7070  vent-sourced app
+00019520: 6c69 6361 7469 6f6e 2c20 616c 6c6f 7769  lication, allowi
+00019530: 6e67 206e 6577 2061 6767 7265 6761 7465  ng new aggregate
+00019540: 2065 7665 6e74 7320 746f 2062 6520 7265   events to be re
+00019550: 636f 7264 6564 2c20 7468 650a 7265 636f  corded, the.reco
+00019560: 7264 6564 2065 7665 6e74 7320 6f66 2061  rded events of a
+00019570: 6e20 6167 6772 6567 6174 6520 746f 2062  n aggregate to b
+00019580: 6520 6f62 7461 696e 6564 2073 6f20 6167  e obtained so ag
+00019590: 6772 6567 6174 6573 2063 616e 2062 6520  gregates can be 
+000195a0: 7265 636f 6e73 7472 7563 7465 642c 0a61  reconstructed,.a
+000195b0: 6e64 2074 6865 2073 7461 7465 206f 6620  nd the state of 
+000195c0: 616e 2061 7070 6c69 6361 7469 6f6e 2074  an application t
+000195d0: 6f20 7072 6f70 6167 6174 6564 2061 6e64  o propagated and
+000195e0: 2070 726f 6365 7373 6564 2077 6974 6820   processed with 
+000195f0: 2265 7861 6374 6c79 2d6f 6e63 6522 0a73  "exactly-once".s
+00019600: 656d 616e 7469 6373 2e0a 0a60 6060 7079  emantics...```py
+00019610: 7468 6f6e 0a69 6d70 6f72 7420 6173 796e  thon.import asyn
+00019620: 6369 6f0a 0a61 7379 6e63 2064 6566 2064  cio..async def d
+00019630: 656d 6f6e 7374 7261 7465 5f61 7379 6e63  emonstrate_async
+00019640: 696f 5f63 6c69 656e 7428 293a 0a0a 2020  io_client():..  
+00019650: 2020 2320 436f 6e73 7472 7563 7420 636c    # Construct cl
+00019660: 6965 6e74 2e0a 2020 2020 636c 6965 6e74  ient..    client
+00019670: 203d 2061 7761 6974 2041 7379 6e63 696f   = await Asyncio
+00019680: 4553 4442 436c 6965 6e74 280a 2020 2020  ESDBClient(.    
+00019690: 2020 2020 7572 693d 6f73 2e67 6574 656e      uri=os.geten
+000196a0: 7628 2245 5344 425f 5552 4922 292c 0a20  v("ESDB_URI"),. 
+000196b0: 2020 2020 2020 2072 6f6f 745f 6365 7274         root_cert
+000196c0: 6966 6963 6174 6573 3d6f 732e 6765 7465  ificates=os.gete
+000196d0: 6e76 2822 4553 4442 5f52 4f4f 545f 4345  nv("ESDB_ROOT_CE
+000196e0: 5254 4946 4943 4154 4553 2229 2c0a 2020  RTIFICATES"),.  
+000196f0: 2020 290a 0a20 2020 2023 2041 7070 656e    )..    # Appen
+00019700: 6420 6576 656e 7473 2e0a 2020 2020 7374  d events..    st
+00019710: 7265 616d 5f6e 616d 6520 3d20 7374 7228  ream_name = str(
+00019720: 7575 6964 2e75 7569 6434 2829 290a 2020  uuid.uuid4()).  
+00019730: 2020 6576 656e 7431 203d 204e 6577 4576    event1 = NewEv
+00019740: 656e 7428 224f 7264 6572 4372 6561 7465  ent("OrderCreate
+00019750: 6422 2c20 6461 7461 3d62 277b 7d27 290a  d", data=b'{}').
+00019760: 2020 2020 6576 656e 7432 203d 204e 6577      event2 = New
+00019770: 4576 656e 7428 224f 7264 6572 5570 6461  Event("OrderUpda
+00019780: 7465 6422 2c20 6461 7461 3d62 277b 7d27  ted", data=b'{}'
+00019790: 290a 2020 2020 6576 656e 7433 203d 204e  ).    event3 = N
+000197a0: 6577 4576 656e 7428 224f 7264 6572 4465  ewEvent("OrderDe
+000197b0: 6c65 7465 6422 2c20 6461 7461 3d62 277b  leted", data=b'{
+000197c0: 7d27 290a 0a20 2020 2063 6f6d 6d69 745f  }')..    commit_
+000197d0: 706f 7369 7469 6f6e 203d 2061 7761 6974  position = await
+000197e0: 2063 6c69 656e 742e 6170 7065 6e64 5f65   client.append_e
+000197f0: 7665 6e74 7328 0a20 2020 2020 2020 2073  vents(.        s
+00019800: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+00019810: 6d5f 6e61 6d65 2c0a 2020 2020 2020 2020  m_name,.        
+00019820: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
+00019830: 4e6f 6e65 2c0a 2020 2020 2020 2020 6576  None,.        ev
+00019840: 656e 7473 3d5b 6576 656e 7431 2c20 6576  ents=[event1, ev
+00019850: 656e 7432 2c20 6576 656e 7433 5d0a 2020  ent2, event3].  
+00019860: 2020 290a 0a20 2020 2023 2052 6561 6420    )..    # Read 
+00019870: 7374 7265 616d 2065 7665 6e74 732e 0a20  stream events.. 
+00019880: 2020 2072 6563 6f72 6465 6420 3d20 6177     recorded = aw
+00019890: 6169 7420 636c 6965 6e74 2e72 6561 645f  ait client.read_
+000198a0: 7374 7265 616d 5f65 7665 6e74 7328 7374  stream_events(st
+000198b0: 7265 616d 5f6e 616d 6529 0a20 2020 2061  ream_name).    a
+000198c0: 7373 6572 7420 6c65 6e28 7265 636f 7264  ssert len(record
+000198d0: 6564 2920 3d3d 2033 0a20 2020 2061 7373  ed) == 3.    ass
+000198e0: 6572 7420 7265 636f 7264 6564 5b30 5d2e  ert recorded[0].
+000198f0: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
+00019900: 2020 2020 6173 7365 7274 2072 6563 6f72      assert recor
+00019910: 6465 645b 315d 2e69 6420 3d3d 2065 7665  ded[1].id == eve
+00019920: 6e74 322e 6964 0a20 2020 2061 7373 6572  nt2.id.    asser
+00019930: 7420 7265 636f 7264 6564 5b32 5d2e 6964  t recorded[2].id
+00019940: 203d 3d20 6576 656e 7433 2e69 640a 0a0a   == event3.id...
+00019950: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
+00019960: 616c 6c20 6576 656e 7473 2e0a 2020 2020  all events..    
+00019970: 7265 6365 6976 6564 203d 205b 5d0a 2020  received = [].  
+00019980: 2020 6173 796e 6320 666f 7220 6576 656e    async for even
+00019990: 7420 696e 2061 7761 6974 2063 6c69 656e  t in await clien
+000199a0: 742e 7375 6273 6372 6962 655f 616c 6c5f  t.subscribe_all_
+000199b0: 6576 656e 7473 2829 3a0a 2020 2020 2020  events():.      
+000199c0: 2020 7265 6365 6976 6564 2e61 7070 656e    received.appen
+000199d0: 6428 6576 656e 7429 0a20 2020 2020 2020  d(event).       
+000199e0: 2069 6620 6576 656e 742e 636f 6d6d 6974   if event.commit
+000199f0: 5f70 6f73 6974 696f 6e20 3d3d 2063 6f6d  _position == com
+00019a00: 6d69 745f 706f 7369 7469 6f6e 3a0a 2020  mit_position:.  
+00019a10: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00019a20: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+00019a30: 7665 645b 2d33 5d2e 6964 203d 3d20 6576  ved[-3].id == ev
+00019a40: 656e 7431 2e69 640a 2020 2020 6173 7365  ent1.id.    asse
+00019a50: 7274 2072 6563 6569 7665 645b 2d32 5d2e  rt received[-2].
+00019a60: 6964 203d 3d20 6576 656e 7432 2e69 640a  id == event2.id.
+00019a70: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+00019a80: 7665 645b 2d31 5d2e 6964 203d 3d20 6576  ved[-1].id == ev
+00019a90: 656e 7433 2e69 640a 0a0a 2020 2020 2320  ent3.id...    # 
+00019aa0: 436c 6f73 6520 7468 6520 636c 6965 6e74  Close the client
+00019ab0: 2e0a 2020 2020 6177 6169 7420 636c 6965  ..    await clie
+00019ac0: 6e74 2e63 6c6f 7365 2829 0a0a 0a23 2052  nt.close()...# R
+00019ad0: 756e 2074 6865 2064 656d 6f2e 0a61 7379  un the demo..asy
+00019ae0: 6e63 696f 2e67 6574 5f65 7665 6e74 5f6c  ncio.get_event_l
+00019af0: 6f6f 7028 292e 7275 6e5f 756e 7469 6c5f  oop().run_until_
+00019b00: 636f 6d70 6c65 7465 280a 2020 2020 6465  complete(.    de
+00019b10: 6d6f 6e73 7472 6174 655f 6173 796e 6369  monstrate_asynci
+00019b20: 6f5f 636c 6965 6e74 2829 0a29 0a60 6060  o_client().).```
+00019b30: 0a0a 2323 204e 6f74 6573 0a0a 2323 2320  ..## Notes..### 
+00019b40: 5265 6775 6c61 7220 6578 7072 6573 7369  Regular expressi
+00019b50: 6f6e 2066 696c 7465 7273 0a0a 5468 6520  on filters..The 
+00019b60: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00019b70: 2829 602c 2060 7375 6273 6372 6962 655f  ()`, `subscribe_
+00019b80: 616c 6c5f 6576 656e 7473 2829 602c 2060  all_events()`, `
+00019b90: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+00019ba0: 696f 6e28 2960 0a61 6e64 2060 6765 745f  ion()`.and `get_
+00019bb0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
+00019bc0: 2960 206d 6574 686f 6473 2068 6176 6520  )` methods have 
+00019bd0: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+00019be0: 2061 6e64 2060 6669 6c74 6572 5f69 6e63   and `filter_inc
+00019bf0: 6c75 6465 600a 6172 6775 6d65 6e74 732e  lude`.arguments.
+00019c00: 2054 6869 7320 7365 6374 696f 6e20 7072   This section pr
+00019c10: 6f76 6964 6573 2073 6f6d 6520 6d6f 7265  ovides some more
+00019c20: 2064 6574 6169 6c73 2061 626f 7574 2074   details about t
+00019c30: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
+00019c40: 7365 0a61 7267 756d 656e 7473 2e0a 0a54  se.arguments...T
+00019c50: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00019c60: 206f 6620 7468 6520 6066 696c 7465 725f   of the `filter_
+00019c70: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
+00019c80: 7473 2069 7320 6465 7369 676e 6564 2074  ts is designed t
+00019c90: 6f20 6578 636c 7564 650a 4576 656e 7453  o exclude.EventS
+00019ca0: 746f 7265 4442 2022 7379 7374 656d 2220  toreDB "system" 
+00019cb0: 616e 6420 2270 6572 7369 7374 656e 6365  and "persistence
+00019cc0: 2073 7562 7363 7269 7074 696f 6e20 636f   subscription co
+00019cd0: 6e66 6967 2220 6576 656e 7473 2c20 7768  nfig" events, wh
+00019ce0: 6963 680a 6f74 6865 7277 6973 6520 776f  ich.otherwise wo
+00019cf0: 756c 6420 6265 2069 6e63 6c75 6465 642e  uld be included.
+00019d00: 0a0a 5379 7374 656d 2065 7665 6e74 7320  ..System events 
+00019d10: 6765 6e65 7261 7465 6420 6279 2045 7665  generated by Eve
+00019d20: 6e74 5374 6f72 6544 4220 6861 7665 2060  ntStoreDB have `
+00019d30: 7479 7065 6020 7374 7269 6e67 7320 7468  type` strings th
+00019d40: 6174 2073 7461 7274 2077 6974 680a 7468  at start with.th
+00019d50: 6520 6024 6020 7369 676e 2e20 5065 7273  e `$` sign. Pers
+00019d60: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
+00019d70: 7469 6f6e 2065 7665 6e74 7320 6765 6e65  tion events gene
+00019d80: 7261 7465 6420 7768 656e 206d 616e 6970  rated when manip
+00019d90: 756c 6174 696e 670a 7065 7273 6973 7465  ulating.persiste
+00019da0: 6e63 6520 7375 6273 6372 6970 7469 6f6e  nce subscription
+00019db0: 7320 6861 7665 2060 7479 7065 6020 7374  s have `type` st
+00019dc0: 7269 6e67 7320 7468 6174 2073 7461 7274  rings that start
+00019dd0: 2077 6974 6820 6050 6572 7369 7374 656e   with `Persisten
+00019de0: 7443 6f6e 6669 6760 2e0a 0a46 6f72 2065  tConfig`...For e
+00019df0: 7861 6d70 6c65 2c20 746f 206d 6174 6368  xample, to match
+00019e00: 2074 6865 2074 7970 6520 6f66 2045 7665   the type of Eve
+00019e10: 6e74 5374 6f72 6544 4220 7379 7374 656d  ntStoreDB system
+00019e20: 2065 7665 6e74 732c 2075 7365 2074 6865   events, use the
+00019e30: 2072 6567 756c 6172 0a65 7870 7265 7373   regular.express
+00019e40: 696f 6e20 7374 7269 6e67 2060 7227 5c24  ion string `r'\$
+00019e50: 2e2b 2760 2e20 506c 6561 7365 206e 6f74  .+'`. Please not
+00019e60: 652c 2074 6865 2063 6f6e 7374 616e 7420  e, the constant 
+00019e70: 6045 5344 425f 5359 5354 454d 5f45 5645  `ESDB_SYSTEM_EVE
+00019e80: 4e54 535f 5245 4745 5860 2069 730a 7365  NTS_REGEX` is.se
+00019e90: 7420 746f 2074 6869 7320 7661 6c75 652e  t to this value.
+00019ea0: 2059 6f75 2063 616e 2069 6d70 6f72 7420   You can import 
+00019eb0: 7468 6973 2063 6f6e 7374 616e 7420 6672  this constant fr
+00019ec0: 6f6d 2060 6573 6462 636c 6965 6e74 6020  om `esdbclient` 
+00019ed0: 616e 6420 7573 6520 6974 2077 6865 6e0a  and use it when.
+00019ee0: 6275 696c 6469 6e67 206c 6f6e 6765 7220  building longer 
+00019ef0: 7365 7175 656e 6365 7320 6f66 2072 6567  sequences of reg
+00019f00: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
+00019f10: 2e0a 0a53 696d 696c 6172 6c79 2c20 746f  ...Similarly, to
+00019f20: 206d 6174 6368 2074 6865 2074 7970 6520   match the type 
+00019f30: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
+00019f40: 7065 7273 6973 7465 6e63 6520 7375 6273  persistence subs
+00019f50: 6372 6970 7469 6f6e 2065 7665 6e74 732c  cription events,
+00019f60: 2075 7365 2074 6865 0a72 6567 756c 6172   use the.regular
+00019f70: 2065 7870 7265 7373 696f 6e20 6072 2750   expression `r'P
+00019f80: 6572 7369 7374 656e 7443 6f6e 6669 675c  ersistentConfig\
+00019f90: 642b 2760 2e20 5468 6520 636f 6e73 7461  d+'`. The consta
+00019fa0: 6e74 2060 4553 4442 5f50 4552 5349 5354  nt `ESDB_PERSIST
+00019fb0: 454e 545f 434f 4e46 4947 5f45 5645 4e54  ENT_CONFIG_EVENT
+00019fc0: 535f 5245 4745 5860 0a69 7320 7365 7420  S_REGEX`.is set 
+00019fd0: 746f 2074 6869 7320 7661 6c75 652e 2059  to this value. Y
+00019fe0: 6f75 2063 616e 2069 6d70 6f72 7420 7468  ou can import th
+00019ff0: 6973 2063 6f6e 7374 616e 7420 6672 6f6d  is constant from
+0001a000: 2060 6573 6462 636c 6965 6e74 6020 2061   `esdbclient`  a
+0001a010: 6e64 2075 7365 2069 7420 7768 656e 0a62  nd use it when.b
+0001a020: 7569 6c64 696e 6720 6c6f 6e67 6572 2073  uilding longer s
+0001a030: 6571 7565 6e63 6573 206f 6620 7265 6775  equences of regu
+0001a040: 6c61 7220 6578 7072 6573 7369 6f6e 732e  lar expressions.
+0001a050: 0a0a 5468 6520 636f 6e73 7461 6e74 2060  ..The constant `
+0001a060: 4445 4641 554c 545f 4558 434c 5544 455f  DEFAULT_EXCLUDE_
+0001a070: 4649 4c54 4552 6020 6973 2061 2073 6571  FILTER` is a seq
+0001a080: 7565 6e63 6520 6f66 2072 6567 756c 6172  uence of regular
+0001a090: 2065 7870 7265 7373 696f 6e73 2074 6861   expressions tha
+0001a0a0: 7420 696e 636c 7564 6573 0a62 6f74 6820  t includes.both 
+0001a0b0: 6045 5344 425f 5359 5354 454d 5f45 5645  `ESDB_SYSTEM_EVE
+0001a0c0: 4e54 535f 5245 4745 5860 2061 6e64 2060  NTS_REGEX` and `
+0001a0d0: 4553 4442 5f50 4552 5349 5354 454e 545f  ESDB_PERSISTENT_
+0001a0e0: 434f 4e46 4947 5f45 5645 4e54 535f 5245  CONFIG_EVENTS_RE
+0001a0f0: 4745 5860 2e20 4974 2069 7320 7573 6564  GEX`. It is used
+0001a100: 0a61 7320 7468 6520 6465 6661 756c 7420  .as the default 
+0001a110: 7661 6c75 6520 6f66 2060 6669 6c74 6572  value of `filter
+0001a120: 5f65 7863 6c75 6465 6020 736f 2074 6861  _exclude` so tha
+0001a130: 7420 7468 6520 6576 656e 7473 2074 6861  t the events tha
+0001a140: 7420 4576 656e 7453 746f 7265 4442 2067  t EventStoreDB g
+0001a150: 656e 6572 6174 6573 0a69 6e74 6572 6e61  enerates.interna
+0001a160: 6c6c 7920 6172 6520 6578 636c 7564 6564  lly are excluded
+0001a170: 2062 7920 6465 6661 756c 742c 2065 7665   by default, eve
+0001a180: 6e74 7320 6f74 6865 7220 7468 616e 2074  nts other than t
+0001a190: 6f20 7468 6f73 6520 7768 6963 6820 796f  o those which yo
+0001a1a0: 7520 7265 636f 7264 2075 7369 6e67 0a74  u record using.t
+0001a1b0: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+0001a1c0: 7328 2960 206d 6574 686f 642e 0a0a 4966  s()` method...If
+0001a1d0: 2079 6f75 2077 616e 7420 746f 2065 7863   you want to exc
+0001a1e0: 6c75 6465 2c20 666f 7220 6578 616d 706c  lude, for exampl
+0001a1f0: 652c 2073 6e61 7073 686f 7473 2066 726f  e, snapshots fro
+0001a200: 6d20 7468 6520 7265 636f 7264 6564 2065  m the recorded e
+0001a210: 7665 6e74 7320 7265 7475 726e 6564 2077  vents returned w
+0001a220: 6865 6e0a 7265 6164 696e 6720 6576 656e  hen.reading even
+0001a230: 7473 2066 726f 6d20 7468 6520 6461 7461  ts from the data
+0001a240: 6261 7365 2c20 7468 656e 2079 6f75 206d  base, then you m
+0001a250: 6179 2077 6973 6820 746f 2075 7365 2061  ay wish to use a
+0001a260: 2061 7070 726f 7072 6961 7465 6c79 2065   appropriately e
+0001a270: 7874 656e 6465 640a 636f 7079 206f 6620  xtended.copy of 
+0001a280: 6044 4546 4155 4c54 5f45 5843 4c55 4445  `DEFAULT_EXCLUDE
+0001a290: 5f46 494c 5445 5260 2061 7320 7468 6520  _FILTER` as the 
+0001a2a0: 7661 6c75 6520 6f66 2074 6865 2060 6669  value of the `fi
+0001a2b0: 6c74 6572 5f65 7863 6c75 6465 6020 6172  lter_exclude` ar
+0001a2c0: 6775 6d65 6e74 732e 0a0a 0a23 2320 436f  guments....## Co
+0001a2d0: 6e74 7269 6275 746f 7273 0a0a 2323 2320  ntributors..### 
+0001a2e0: 496e 7374 616c 6c20 506f 6574 7279 0a0a  Install Poetry..
+0001a2f0: 5468 6520 6669 7273 7420 7468 696e 6720  The first thing 
+0001a300: 6973 2074 6f20 6368 6563 6b20 796f 7520  is to check you 
+0001a310: 6861 7665 2050 6f65 7472 7920 696e 7374  have Poetry inst
+0001a320: 616c 6c65 642e 0a0a 2020 2020 2420 706f  alled...    $ po
+0001a330: 6574 7279 202d 2d76 6572 7369 6f6e 0a0a  etry --version..
+0001a340: 4966 2079 6f75 2064 6f6e 2774 2c20 7468  If you don't, th
+0001a350: 656e 2070 6c65 6173 6520 5b69 6e73 7461  en please [insta
+0001a360: 6c6c 2050 6f65 7472 795d 2868 7474 7073  ll Poetry](https
+0001a370: 3a2f 2f70 7974 686f 6e2d 706f 6574 7279  ://python-poetry
+0001a380: 2e6f 7267 2f64 6f63 732f 2369 6e73 7461  .org/docs/#insta
+0001a390: 6c6c 696e 672d 7769 7468 2d74 6865 2d6f  lling-with-the-o
+0001a3a0: 6666 6963 6961 6c2d 696e 7374 616c 6c65  fficial-installe
+0001a3b0: 7229 2e0a 0a20 2020 2024 2063 7572 6c20  r)...    $ curl 
+0001a3c0: 2d73 534c 2068 7474 7073 3a2f 2f69 6e73  -sSL https://ins
+0001a3d0: 7461 6c6c 2e70 7974 686f 6e2d 706f 6574  tall.python-poet
+0001a3e0: 7279 2e6f 7267 207c 2070 7974 686f 6e33  ry.org | python3
+0001a3f0: 202d 0a0a 4974 2077 696c 6c20 6865 6c70   -..It will help
+0001a400: 2074 6f20 6d61 6b65 2073 7572 6520 506f   to make sure Po
+0001a410: 6574 7279 2773 2062 696e 2064 6972 6563  etry's bin direc
+0001a420: 746f 7279 2069 7320 696e 2079 6f75 7220  tory is in your 
+0001a430: 6050 4154 4860 2065 6e76 6972 6f6e 6d65  `PATH` environme
+0001a440: 6e74 2076 6172 6961 626c 652e 0a0a 4275  nt variable...Bu
+0001a450: 7420 696e 2061 6e79 2063 6173 652c 206d  t in any case, m
+0001a460: 616b 6520 7375 7265 2079 6f75 206b 6e6f  ake sure you kno
+0001a470: 7720 7468 6520 7061 7468 2074 6f20 7468  w the path to th
+0001a480: 6520 6070 6f65 7472 7960 2065 7865 6375  e `poetry` execu
+0001a490: 7461 626c 652e 2054 6865 2050 6f65 7472  table. The Poetr
+0001a4a0: 790a 696e 7374 616c 6c65 7220 7465 6c6c  y.installer tell
+0001a4b0: 7320 796f 7520 7768 6572 6520 6974 2068  s you where it h
+0001a4c0: 6173 2062 6565 6e20 696e 7374 616c 6c65  as been installe
+0001a4d0: 642c 2061 6e64 2068 6f77 2074 6f20 636f  d, and how to co
+0001a4e0: 6e66 6967 7572 6520 796f 7572 2073 6865  nfigure your she
+0001a4f0: 6c6c 2e0a 0a50 6c65 6173 6520 7265 6665  ll...Please refe
+0001a500: 7220 746f 2074 6865 205b 506f 6574 7279  r to the [Poetry
+0001a510: 2064 6f63 735d 2868 7474 7073 3a2f 2f70   docs](https://p
+0001a520: 7974 686f 6e2d 706f 6574 7279 2e6f 7267  ython-poetry.org
+0001a530: 2f64 6f63 732f 2920 666f 7220 6775 6964  /docs/) for guid
+0001a540: 616e 6365 206f 6e0a 7573 696e 6720 506f  ance on.using Po
+0001a550: 6574 7279 2e0a 0a23 2323 2053 6574 7570  etry...### Setup
+0001a560: 2066 6f72 2050 7943 6861 726d 2075 7365   for PyCharm use
+0001a570: 7273 0a0a 596f 7520 6361 6e20 6561 7369  rs..You can easi
+0001a580: 6c79 206f 6274 6169 6e20 7468 6520 7072  ly obtain the pr
+0001a590: 6f6a 6563 7420 6669 6c65 7320 7573 696e  oject files usin
+0001a5a0: 6720 5079 4368 6172 6d20 286d 656e 7520  g PyCharm (menu 
+0001a5b0: 2247 6974 203e 2043 6c6f 6e65 2e2e 2e22  "Git > Clone..."
+0001a5c0: 292e 0a50 7943 6861 726d 2077 696c 6c20  )..PyCharm will 
+0001a5d0: 7468 656e 2075 7375 616c 6c79 2070 726f  then usually pro
+0001a5e0: 6d70 7420 796f 7520 746f 206f 7065 6e20  mpt you to open 
+0001a5f0: 7468 6520 7072 6f6a 6563 742e 0a0a 4f70  the project...Op
+0001a600: 656e 2074 6865 2070 726f 6a65 6374 2069  en the project i
+0001a610: 6e20 6120 6e65 7720 7769 6e64 6f77 2e20  n a new window. 
+0001a620: 5079 4368 6172 6d20 7769 6c6c 2074 6865  PyCharm will the
+0001a630: 6e20 7573 7561 6c6c 7920 7072 6f6d 7074  n usually prompt
+0001a640: 2079 6f75 2074 6f20 6372 6561 7465 0a61   you to create.a
+0001a650: 206e 6577 2076 6972 7475 616c 2065 6e76   new virtual env
+0001a660: 6972 6f6e 6d65 6e74 2e0a 0a43 7265 6174  ironment...Creat
+0001a670: 6520 6120 6e65 7720 506f 6574 7279 2076  e a new Poetry v
+0001a680: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
+0001a690: 6e74 2066 6f72 2074 6865 2070 726f 6a65  nt for the proje
+0001a6a0: 6374 2e20 4966 2050 7943 6861 726d 2064  ct. If PyCharm d
+0001a6b0: 6f65 736e 2774 2061 6c72 6561 6479 0a6b  oesn't already.k
+0001a6c0: 6e6f 7720 7768 6572 6520 796f 7572 2060  now where your `
+0001a6d0: 706f 6574 7279 6020 6578 6563 7574 6162  poetry` executab
+0001a6e0: 6c65 2069 732c 2074 6865 6e20 7365 7420  le is, then set 
+0001a6f0: 7468 6520 7061 7468 2074 6f20 796f 7572  the path to your
+0001a700: 2060 706f 6574 7279 6020 6578 6563 7574   `poetry` execut
+0001a710: 6162 6c65 0a69 6e20 7468 6520 224e 6577  able.in the "New
+0001a720: 2050 6f65 7472 7920 456e 7669 726f 6e6d   Poetry Environm
+0001a730: 656e 7422 2066 6f72 6d20 696e 7075 7420  ent" form input 
+0001a740: 6669 656c 6420 6c61 6265 6c6c 6564 2022  field labelled "
+0001a750: 506f 6574 7279 2065 7865 6375 7461 626c  Poetry executabl
+0001a760: 6522 2e20 496e 2074 6865 0a22 4e65 7720  e". In the."New 
+0001a770: 506f 6574 7279 2045 6e76 6972 6f6e 6d65  Poetry Environme
+0001a780: 6e74 2220 666f 726d 2c20 796f 7520 7769  nt" form, you wi
+0001a790: 6c6c 2061 6c73 6f20 6861 7665 2074 6865  ll also have the
+0001a7a0: 206f 7070 6f72 7475 6e69 7479 2074 6f20   opportunity to 
+0001a7b0: 7365 6c65 6374 2077 6869 6368 0a50 7974  select which.Pyt
+0001a7c0: 686f 6e20 6578 6563 7574 6162 6c65 2077  hon executable w
+0001a7d0: 696c 6c20 6265 2075 7365 6420 6279 2074  ill be used by t
+0001a7e0: 6865 2076 6972 7475 616c 2065 6e76 6972  he virtual envir
+0001a7f0: 6f6e 6d65 6e74 2e0a 0a50 7943 6861 726d  onment...PyCharm
+0001a800: 2077 696c 6c20 7468 656e 2063 7265 6174   will then creat
+0001a810: 6520 6120 6e65 7720 506f 6574 7279 2076  e a new Poetry v
+0001a820: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
+0001a830: 6e74 2066 6f72 2079 6f75 7220 7072 6f6a  nt for your proj
+0001a840: 6563 742c 2075 7369 6e67 0a61 2070 6172  ect, using.a par
+0001a850: 7469 6375 6c61 7220 7665 7273 696f 6e20  ticular version 
+0001a860: 6f66 2050 7974 686f 6e2c 2061 6e64 2061  of Python, and a
+0001a870: 6c73 6f20 696e 7374 616c 6c20 696e 746f  lso install into
+0001a880: 2074 6869 7320 7669 7274 7561 6c20 656e   this virtual en
+0001a890: 7669 726f 6e6d 656e 7420 7468 650a 7072  vironment the.pr
+0001a8a0: 6f6a 6563 7427 7320 7061 636b 6167 6520  oject's package 
+0001a8b0: 6465 7065 6e64 656e 6369 6573 2061 6363  dependencies acc
+0001a8c0: 6f72 6469 6e67 2074 6f20 7468 6520 7072  ording to the pr
+0001a8d0: 6f6a 6563 7427 7320 6070 6f65 7472 792e  oject's `poetry.
+0001a8e0: 6c6f 636b 6020 6669 6c65 2e0a 0a59 6f75  lock` file...You
+0001a8f0: 2063 616e 2061 6464 2064 6966 6665 7265   can add differe
+0001a900: 6e74 2050 6f65 7472 7920 656e 7669 726f  nt Poetry enviro
+0001a910: 6e6d 656e 7473 2066 6f72 2064 6966 6665  nments for diffe
+0001a920: 7265 6e74 2050 7974 686f 6e20 7665 7273  rent Python vers
+0001a930: 696f 6e73 2c20 616e 6420 7377 6974 6368  ions, and switch
+0001a940: 0a62 6574 7765 656e 2074 6865 6d20 7573  .between them us
+0001a950: 696e 6720 7468 6520 2250 7974 686f 6e20  ing the "Python 
+0001a960: 496e 7465 7270 7265 7465 7222 2073 6574  Interpreter" set
+0001a970: 7469 6e67 7320 6f66 2050 7943 6861 726d  tings of PyCharm
+0001a980: 2e20 4966 2079 6f75 2077 616e 7420 746f  . If you want to
+0001a990: 2075 7365 0a61 2076 6572 7369 6f6e 206f   use.a version o
+0001a9a0: 6620 5079 7468 6f6e 2074 6861 7420 6973  f Python that is
+0001a9b0: 6e27 7420 696e 7374 616c 6c65 642c 2065  n't installed, e
+0001a9c0: 6974 6865 7220 7573 6520 796f 7572 2066  ither use your f
+0001a9d0: 6176 6f75 7269 7465 2070 6163 6b61 6765  avourite package
+0001a9e0: 206d 616e 6167 6572 2c0a 6f72 2069 6e73   manager,.or ins
+0001a9f0: 7461 6c6c 2050 7974 686f 6e20 6279 2064  tall Python by d
+0001aa00: 6f77 6e6c 6f61 6469 6e67 2061 6e20 696e  ownloading an in
+0001aa10: 7374 616c 6c65 7220 666f 7220 7265 6365  staller for rece
+0001aa20: 6e74 2076 6572 7369 6f6e 7320 6f66 2050  nt versions of P
+0001aa30: 7974 686f 6e20 6469 7265 6374 6c79 0a66  ython directly.f
+0001aa40: 726f 6d20 7468 6520 5b50 7974 686f 6e20  rom the [Python 
+0001aa50: 7765 6273 6974 655d 2868 7474 7073 3a2f  website](https:/
+0001aa60: 2f77 7777 2e70 7974 686f 6e2e 6f72 672f  /www.python.org/
+0001aa70: 646f 776e 6c6f 6164 732f 292e 0a0a 4f6e  downloads/)...On
+0001aa80: 6365 2070 726f 6a65 6374 2064 6570 656e  ce project depen
+0001aa90: 6465 6e63 6965 7320 6861 7665 2062 6565  dencies have bee
+0001aaa0: 6e20 696e 7374 616c 6c65 642c 2079 6f75  n installed, you
+0001aab0: 2073 686f 756c 6420 6265 2061 626c 6520   should be able 
+0001aac0: 746f 2072 756e 2074 6573 7473 0a66 726f  to run tests.fro
+0001aad0: 6d20 7769 7468 696e 2050 7943 6861 726d  m within PyCharm
+0001aae0: 2028 7269 6768 742d 636c 6963 6b20 6f6e   (right-click on
+0001aaf0: 2074 6865 2060 7465 7374 7360 2066 6f6c   the `tests` fol
+0001ab00: 6465 7220 616e 6420 7365 6c65 6374 2074  der and select t
+0001ab10: 6865 2027 5275 6e27 206f 7074 696f 6e29  he 'Run' option)
+0001ab20: 2e0a 0a42 6563 6175 7365 206f 6620 6120  ...Because of a 
+0001ab30: 636f 6e66 6c69 6374 2062 6574 7765 656e  conflict between
+0001ab40: 2070 7974 6573 7420 616e 6420 5079 4368   pytest and PyCh
+0001ab50: 6172 6d27 7320 6465 6275 6767 6572 2061  arm's debugger a
+0001ab60: 6e64 2074 6865 2063 6f76 6572 6167 6520  nd the coverage 
+0001ab70: 746f 6f6c 2c0a 796f 7520 6d61 7920 6e65  tool,.you may ne
+0001ab80: 6564 2074 6f20 6164 6420 6060 2d2d 6e6f  ed to add ``--no
+0001ab90: 2d63 6f76 6060 2061 7320 616e 206f 7074  -cov`` as an opt
+0001aba0: 696f 6e20 746f 2074 6865 2074 6573 7420  ion to the test 
+0001abb0: 7275 6e6e 6572 2074 656d 706c 6174 652e  runner template.
+0001abc0: 2041 6c74 6572 6e61 7469 7665 6c79 2c0a   Alternatively,.
+0001abd0: 6a75 7374 2075 7365 2074 6865 2050 7974  just use the Pyt
+0001abe0: 686f 6e20 5374 616e 6461 7264 204c 6962  hon Standard Lib
+0001abf0: 7261 7279 2773 2060 6075 6e69 7474 6573  rary's ``unittes
+0001ac00: 7460 6020 6d6f 6475 6c65 2e0a 0a59 6f75  t`` module...You
+0001ac10: 2073 686f 756c 6420 616c 736f 2062 6520   should also be 
+0001ac20: 6162 6c65 2074 6f20 6f70 656e 2061 2074  able to open a t
+0001ac30: 6572 6d69 6e61 6c20 7769 6e64 6f77 2069  erminal window i
+0001ac40: 6e20 5079 4368 6172 6d2c 2061 6e64 2072  n PyCharm, and r
+0001ac50: 756e 2074 6865 2070 726f 6a65 6374 2773  un the project's
+0001ac60: 0a4d 616b 6566 696c 6520 636f 6d6d 616e  .Makefile comman
+0001ac70: 6473 2066 726f 6d20 7468 6520 636f 6d6d  ds from the comm
+0001ac80: 616e 6420 6c69 6e65 2028 7365 6520 6265  and line (see be
+0001ac90: 6c6f 7729 2e0a 0a23 2323 2053 6574 7570  low)...### Setup
+0001aca0: 2066 726f 6d20 636f 6d6d 616e 6420 6c69   from command li
+0001acb0: 6e65 0a0a 4f62 7461 696e 2074 6865 2070  ne..Obtain the p
+0001acc0: 726f 6a65 6374 2066 696c 6573 2c20 7573  roject files, us
+0001acd0: 696e 6720 4769 7420 6f72 2073 7569 7461  ing Git or suita
+0001ace0: 626c 6520 616c 7465 726e 6174 6976 652e  ble alternative.
+0001acf0: 0a0a 496e 2061 2074 6572 6d69 6e61 6c20  ..In a terminal 
+0001ad00: 6170 706c 6963 6174 696f 6e2c 2063 6861  application, cha
+0001ad10: 6e67 6520 796f 7572 2063 7572 7265 6e74  nge your current
+0001ad20: 2077 6f72 6b69 6e67 2064 6972 6563 746f   working directo
+0001ad30: 7279 0a74 6f20 7468 6520 726f 6f74 2066  ry.to the root f
+0001ad40: 6f6c 6465 7220 6f66 2074 6865 2070 726f  older of the pro
+0001ad50: 6a65 6374 2066 696c 6573 2e20 5468 6572  ject files. Ther
+0001ad60: 6520 7368 6f75 6c64 2062 6520 6120 4d61  e should be a Ma
+0001ad70: 6b65 6669 6c65 0a69 6e20 7468 6973 2066  kefile.in this f
+0001ad80: 6f6c 6465 722e 0a0a 5573 6520 7468 6520  older...Use the 
+0001ad90: 4d61 6b65 6669 6c65 2074 6f20 6372 6561  Makefile to crea
+0001ada0: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
+0001adb0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+0001adc0: 656e 7420 666f 7220 7468 650a 7072 6f6a  ent for the.proj
+0001add0: 6563 7420 616e 6420 696e 7374 616c 6c20  ect and install 
+0001ade0: 7468 6520 7072 6f6a 6563 7427 7320 7061  the project's pa
+0001adf0: 636b 6167 6520 6465 7065 6e64 656e 6369  ckage dependenci
+0001ae00: 6573 2069 6e74 6f20 6974 2c0a 7573 696e  es into it,.usin
+0001ae10: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+0001ae20: 636f 6d6d 616e 642e 0a0a 2020 2020 2420  command...    $ 
+0001ae30: 6d61 6b65 2069 6e73 7461 6c6c 2d70 6163  make install-pac
+0001ae40: 6b61 6765 730a 0a49 7427 7320 616c 736f  kages..It's also
+0001ae50: 2070 6f73 7369 626c 6520 746f 2061 6c73   possible to als
+0001ae60: 6f20 696e 7374 616c 6c20 7468 6520 7072  o install the pr
+0001ae70: 6f6a 6563 7420 696e 2027 6564 6974 6162  oject in 'editab
+0001ae80: 6c65 206d 6f64 6527 2e0a 0a20 2020 2024  le mode'...    $
+0001ae90: 206d 616b 6520 696e 7374 616c 6c0a 0a50   make install..P
+0001aea0: 6c65 6173 6520 6e6f 7465 2c20 6966 2079  lease note, if y
+0001aeb0: 6f75 2063 7265 6174 6520 7468 6520 7669  ou create the vi
+0001aec0: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
+0001aed0: 7420 696e 2074 6869 7320 7761 792c 2061  t in this way, a
+0001aee0: 6e64 2074 6865 6e20 7472 7920 746f 0a6f  nd then try to.o
+0001aef0: 7065 6e20 7468 6520 7072 6f6a 6563 7420  pen the project 
+0001af00: 696e 2050 7943 6861 726d 2061 6e64 2063  in PyCharm and c
+0001af10: 6f6e 6669 6775 7265 2074 6865 2070 726f  onfigure the pro
+0001af20: 6a65 6374 2074 6f20 7573 6520 7468 6973  ject to use this
+0001af30: 2076 6972 7475 616c 0a65 6e76 6972 6f6e   virtual.environ
+0001af40: 6d65 6e74 2061 7320 616e 2022 4578 6973  ment as an "Exis
+0001af50: 7469 6e67 2050 6f65 7472 7920 456e 7669  ting Poetry Envi
+0001af60: 726f 6e6d 656e 7422 2c20 5079 4368 6172  ronment", PyChar
+0001af70: 6d20 736f 6d65 7469 6d65 7320 6861 7320  m sometimes has 
+0001af80: 736f 6d65 0a69 7373 7565 7320 2864 6f6e  some.issues (don
+0001af90: 2774 206b 6e6f 7720 7768 7929 2077 6869  't know why) whi
+0001afa0: 6368 206d 6967 6874 2062 6520 7072 6f62  ch might be prob
+0001afb0: 6c65 6d61 7469 632e 2049 6620 796f 7520  lematic. If you 
+0001afc0: 656e 636f 756e 7465 7220 7375 6368 0a69  encounter such.i
+0001afd0: 7373 7565 732c 2079 6f75 2063 616e 2072  ssues, you can r
+0001afe0: 6573 6f6c 7665 2074 6865 7365 2069 7373  esolve these iss
+0001aff0: 7565 7320 6279 2064 656c 6574 696e 6720  ues by deleting 
+0001b000: 7468 6520 7669 7274 7561 6c20 656e 7669  the virtual envi
+0001b010: 726f 6e6d 656e 740a 616e 6420 6372 6561  ronment.and crea
+0001b020: 7469 6e67 2074 6865 2050 6f65 7472 7920  ting the Poetry 
+0001b030: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+0001b040: 656e 7420 7573 696e 6720 5079 4368 6172  ent using PyChar
+0001b050: 6d20 2873 6565 2061 626f 7665 292e 0a0a  m (see above)...
+0001b060: 2323 2320 5072 6f6a 6563 7420 4d61 6b65  ### Project Make
+0001b070: 6669 6c65 2063 6f6d 6d61 6e64 730a 0a59  file commands..Y
+0001b080: 6f75 2063 616e 2073 7461 7274 2045 7665  ou can start Eve
+0001b090: 6e74 5374 6f72 6544 4220 7573 696e 6720  ntStoreDB using 
+0001b0a0: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+0001b0b0: 6d6d 616e 642e 0a0a 2020 2020 2420 6d61  mmand...    $ ma
+0001b0c0: 6b65 2073 7461 7274 2d65 7665 6e74 7374  ke start-eventst
+0001b0d0: 6f72 6564 620a 0a59 6f75 2063 616e 2072  oredb..You can r
+0001b0e0: 756e 2074 6573 7473 2075 7369 6e67 2074  un tests using t
+0001b0f0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
+0001b100: 6d61 6e64 2028 6e65 6564 7320 4576 656e  mand (needs Even
+0001b110: 7453 746f 7265 4442 2074 6f20 6265 2072  tStoreDB to be r
+0001b120: 756e 6e69 6e67 292e 0a0a 2020 2020 2420  unning)...    $ 
+0001b130: 6d61 6b65 2074 6573 740a 0a59 6f75 2063  make test..You c
+0001b140: 616e 2073 746f 7020 4576 656e 7453 746f  an stop EventSto
+0001b150: 7265 4442 2075 7369 6e67 2074 6865 2066  reDB using the f
+0001b160: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
+0001b170: 2e0a 0a20 2020 2024 206d 616b 6520 7374  ...    $ make st
+0001b180: 6f70 2d65 7665 6e74 7374 6f72 6564 620a  op-eventstoredb.
+0001b190: 0a59 6f75 2063 616e 2063 6865 636b 2074  .You can check t
+0001b1a0: 6865 2066 6f72 6d61 7474 696e 6720 6f66  he formatting of
+0001b1b0: 2074 6865 2063 6f64 6520 7573 696e 6720   the code using 
+0001b1c0: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+0001b1d0: 6d6d 616e 642e 0a0a 2020 2020 2420 6d61  mmand...    $ ma
+0001b1e0: 6b65 206c 696e 740a 0a59 6f75 2063 616e  ke lint..You can
+0001b1f0: 2072 6566 6f72 6d61 7420 7468 6520 636f   reformat the co
+0001b200: 6465 2075 7369 6e67 2074 6865 2066 6f6c  de using the fol
+0001b210: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e0a  lowing command..
+0001b220: 0a20 2020 2024 206d 616b 6520 666d 740a  .    $ make fmt.
+0001b230: 0a54 6573 7473 2062 656c 6f6e 6720 696e  .Tests belong in
+0001b240: 2060 2e2f 7465 7374 7360 2e20 436f 6465   `./tests`. Code
+0001b250: 2d75 6e64 6572 2d74 6573 7420 6265 6c6f  -under-test belo
+0001b260: 6e67 7320 696e 2060 2e2f 6573 6462 636c  ngs in `./esdbcl
+0001b270: 6965 6e74 602e 0a0a 4564 6974 2070 6163  ient`...Edit pac
+0001b280: 6b61 6765 2064 6570 656e 6465 6e63 6965  kage dependencie
+0001b290: 7320 696e 2060 7079 7072 6f6a 6563 742e  s in `pyproject.
+0001b2a0: 746f 6d6c 602e 2055 7064 6174 6520 696e  toml`. Update in
+0001b2b0: 7374 616c 6c65 6420 7061 636b 6167 6573  stalled packages
+0001b2c0: 2028 616e 6420 7468 650a 6070 6f65 7472   (and the.`poetr
+0001b2d0: 792e 6c6f 636b 6020 6669 6c65 2920 7573  y.lock` file) us
+0001b2e0: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+0001b2f0: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
+0001b300: 2420 6d61 6b65 2075 7064 6174 652d 7061  $ make update-pa
+0001b310: 636b 6167 6573 0a                        ckages.
```

