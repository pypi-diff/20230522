# Comparing `tmp/gdsfactory-6.97.0.tar.gz` & `tmp/gdsfactory-6.97.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "gdsfactory-6.97.0.tar", last modified: Fri Jan  1 00:00:00 2016, max compression
+gzip compressed data, was "gdsfactory-6.97.1.tar", last modified: Fri Jan  1 00:00:00 2016, max compression
```

## Comparing `gdsfactory-6.97.0.tar` & `gdsfactory-6.97.1.tar`

### file list

```diff
@@ -1,693 +1,693 @@
--rw-r--r--   0        0        0     1072 2023-05-19 23:05:02.442286 gdsfactory-6.97.0/LICENSE
--rw-r--r--   0        0        0    14319 2023-05-19 23:05:02.442286 gdsfactory-6.97.0/README.md
--rw-r--r--   0        0        0     3583 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/__init__.py
--rw-r--r--   0        0        0     2104 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_keepout.py
--rw-r--r--   0        0        0    12629 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_labels.py
--rw-r--r--   0        0        0     3711 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_loopback.py
--rw-r--r--   0        0        0     5054 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_padding.py
--rw-r--r--   0        0        0    15639 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_pins.py
--rw-r--r--   0        0        0    14700 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_ports.py
--rw-r--r--   0        0        0     2884 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_tapers.py
--rw-r--r--   0        0        0     2257 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_tapers_cross_section.py
--rw-r--r--   0        0        0     1831 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/add_termination.py
--rw-r--r--   0        0        0     1856 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/asserts.py
--rw-r--r--   0        0        0    12988 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/cell.py
--rw-r--r--   0        0        0    16040 2023-05-19 23:05:02.450286 gdsfactory-6.97.0/gdsfactory/circuitviz.py
--rw-r--r--   0        0        0     5718 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/cli.py
--rw-r--r--   0        0        0   101568 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/component.py
--rw-r--r--   0        0        0    23424 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/component_layout.py
--rw-r--r--   0        0        0    29879 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/component_reference.py
--rw-r--r--   0        0        0     1205 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/C.py
--rw-r--r--   0        0        0     1144 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/L.py
--rw-r--r--   0        0        0    20964 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/__init__.py
--rw-r--r--   0        0        0     2621 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/add_fiducials.py
--rw-r--r--   0        0        0    14087 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/add_grating_couplers.py
--rw-r--r--   0        0        0     2014 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/add_trenches.py
--rw-r--r--   0        0        0     3207 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/align.py
--rw-r--r--   0        0        0     2622 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/array_component.py
--rw-r--r--   0        0        0     4705 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/array_with_fanout.py
--rw-r--r--   0        0        0     4322 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/array_with_via.py
--rw-r--r--   0        0        0     4042 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/awg.py
--rw-r--r--   0        0        0     1269 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bbox.py
--rw-r--r--   0        0        0     2851 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bend_circular.py
--rw-r--r--   0        0        0     2649 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bend_circular_heater.py
--rw-r--r--   0        0        0     7903 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bend_euler.py
--rw-r--r--   0        0        0     2682 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bend_port.py
--rw-r--r--   0        0        0     3664 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bend_s.py
--rw-r--r--   0        0        0     5373 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/bezier.py
--rw-r--r--   0        0        0     1605 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cavity.py
--rw-r--r--   0        0        0     5766 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdc.py
--rw-r--r--   0        0        0     2929 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdsem_all.py
--rw-r--r--   0        0        0     1788 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdsem_bend180.py
--rw-r--r--   0        0        0     1631 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdsem_coupler.py
--rw-r--r--   0        0        0     1412 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdsem_straight.py
--rw-r--r--   0        0        0     1565 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cdsem_straight_density.py
--rw-r--r--   0        0        0      793 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/circle.py
--rw-r--r--   0        0        0     5722 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coh_rx_dual_pol.py
--rw-r--r--   0        0        0     8922 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coh_rx_single_pol.py
--rw-r--r--   0        0        0     5043 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coh_tx_dual_pol.py
--rw-r--r--   0        0        0     6118 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coh_tx_single_pol.py
--rw-r--r--   0        0        0     2548 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/compass.py
--rw-r--r--   0        0        0     9876 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/component_lattice.py
--rw-r--r--   0        0        0     7174 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/component_sequence.py
--rw-r--r--   0        0        0      812 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/copy_layers.py
--rw-r--r--   0        0        0     3460 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler.py
--rw-r--r--   0        0        0     2113 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler90.py
--rw-r--r--   0        0        0     1802 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler90bend.py
--rw-r--r--   0        0        0     4666 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_adiabatic.py
--rw-r--r--   0        0        0     1909 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_asymmetric.py
--rw-r--r--   0        0        0     3970 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_full.py
--rw-r--r--   0        0        0     3414 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_ring.py
--rw-r--r--   0        0        0     1060 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_straight.py
--rw-r--r--   0        0        0     1164 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_straight_asymmetric.py
--rw-r--r--   0        0        0     2192 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/coupler_symmetric.py
--rw-r--r--   0        0        0     1848 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cross.py
--rw-r--r--   0        0        0    12873 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/crossing_waveguide.py
--rw-r--r--   0        0        0      500 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/grating_coupler_1etch_h220_e70.csv
--rw-r--r--   0        0        0     1014 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/grating_coupler_2etch_h220_e70_e220.csv
--rw-r--r--   0        0        0    19749 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_100.csv
--rw-r--r--   0        0        0    19751 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_150.csv
--rw-r--r--   0        0        0    19749 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_200.csv
--rw-r--r--   0        0        0    19751 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_11_200.csv
--rw-r--r--   0        0        0    19775 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_12_200.csv
--rw-r--r--   0        0        0     3143 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_3_36.csv
--rw-r--r--   0        0        0     5272 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cutback_2x2.py
--rw-r--r--   0        0        0     6450 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cutback_bend.py
--rw-r--r--   0        0        0     3765 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cutback_component.py
--rw-r--r--   0        0        0     2721 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/cutback_splitter.py
--rw-r--r--   0        0        0     2971 2023-05-19 23:05:02.454286 gdsfactory-6.97.0/gdsfactory/components/dbr.py
--rw-r--r--   0        0        0     4288 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/dbr_tapered.py
--rw-r--r--   0        0        0     2486 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/delay_snake.py
--rw-r--r--   0        0        0     3177 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/delay_snake2.py
--rw-r--r--   0        0        0     3245 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/delay_snake3.py
--rw-r--r--   0        0        0     4319 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/delay_snake_sbend.py
--rw-r--r--   0        0        0     1226 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/dicing_lane.py
--rw-r--r--   0        0        0     3471 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/die.py
--rw-r--r--   0        0        0     2975 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/die_bbox.py
--rw-r--r--   0        0        0     2863 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/die_bbox_frame.py
--rw-r--r--   0        0        0     8015 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/disk.py
--rw-r--r--   0        0        0     4112 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/edge_coupler_array.py
--rw-r--r--   0        0        0     1214 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ellipse.py
--rw-r--r--   0        0        0     1800 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/extend_ports_list.py
--rw-r--r--   0        0        0     7988 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/extension.py
--rw-r--r--   0        0        0      981 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/fiber.py
--rw-r--r--   0        0        0     1432 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/fiber_array.py
--rw-r--r--   0        0        0      722 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/fiducial_squares.py
--rw-r--r--   0        0        0     3290 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ge_detector_straight_si_contacts.py
--rw-r--r--   0        0        0     1063 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_array.py
--rw-r--r--   0        0        0     4682 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_dual_pol.py
--rw-r--r--   0        0        0     7110 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical.py
--rw-r--r--   0        0        0     7222 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_arbitrary.py
--rw-r--r--   0        0        0     4961 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_lumerical.py
--rw-r--r--   0        0        0     4592 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_trenches.py
--rw-r--r--   0        0        0     1773 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_functions.py
--rw-r--r--   0        0        0     9058 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_loss.py
--rw-r--r--   0        0        0     1786 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_loss_fiber_single.py
--rw-r--r--   0        0        0     4142 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular.py
--rw-r--r--   0        0        0     4685 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular_arbitrary.py
--rw-r--r--   0        0        0     3887 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular_arbitrary_slab.py
--rw-r--r--   0        0        0     1579 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/grating_coupler_tree.py
--rw-r--r--   0        0        0     8811 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/greek_cross.py
--rw-r--r--   0        0        0     1019 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/hline.py
--rw-r--r--   0        0        0     3687 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/interdigital_capacitor.py
--rw-r--r--   0        0        0     1825 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/litho_calipers.py
--rw-r--r--   0        0        0     1244 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/litho_ruler.py
--rw-r--r--   0        0        0     1304 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/litho_steps.py
--rw-r--r--   0        0        0      650 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/logo.py
--rw-r--r--   0        0        0     1679 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/loop_mirror.py
--rw-r--r--   0        0        0     3873 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mmi1x2.py
--rw-r--r--   0        0        0     2814 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mmi1x2_with_sbend.py
--rw-r--r--   0        0        0     3858 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mmi2x2.py
--rw-r--r--   0        0        0     3299 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mmi2x2_with_sbend.py
--rw-r--r--   0        0        0     4947 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mmi_90degree_hybrid.py
--rw-r--r--   0        0        0     3265 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mode_converter.py
--rw-r--r--   0        0        0     7579 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi.py
--rw-r--r--   0        0        0     2499 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi_arm.py
--rw-r--r--   0        0        0     5835 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi_arms.py
--rw-r--r--   0        0        0    12214 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi_lattice.py
--rw-r--r--   0        0        0     4025 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi_pads_center.py
--rw-r--r--   0        0        0     1064 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzi_phase_shifter.py
--rw-r--r--   0        0        0     6342 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzit.py
--rw-r--r--   0        0        0     3502 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzit_lattice.py
--rw-r--r--   0        0        0     6047 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/mzm.py
--rw-r--r--   0        0        0     3518 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/nxn.py
--rw-r--r--   0        0        0     1940 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/optimal_90deg.py
--rw-r--r--   0        0        0     3876 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/optimal_hairpin.py
--rw-r--r--   0        0        0     6131 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/optimal_step.py
--rw-r--r--   0        0        0     6327 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/pack_doe.py
--rw-r--r--   0        0        0     3860 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/pad.py
--rw-r--r--   0        0        0     1890 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/pad_gsg.py
--rw-r--r--   0        0        0     1157 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/pads_shorted.py
--rw-r--r--   0        0        0     3833 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/polarization_splitter_rotator.py
--rw-r--r--   0        0        0     1147 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ramp.py
--rw-r--r--   0        0        0     1508 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/rectangle.py
--rw-r--r--   0        0        0     2972 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/rectangle_with_slits.py
--rw-r--r--   0        0        0     1508 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/regular_polygon.py
--rw-r--r--   0        0        0     3302 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/resistance_meander.py
--rw-r--r--   0        0        0     2642 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/resistance_sheet.py
--rw-r--r--   0        0        0     1273 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring.py
--rw-r--r--   0        0        0     4143 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_crow.py
--rw-r--r--   0        0        0     3272 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_crow_couplers.py
--rw-r--r--   0        0        0     2267 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_double.py
--rw-r--r--   0        0        0     2846 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_double_bend_coupler.py
--rw-r--r--   0        0        0     3846 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_double_heater.py
--rw-r--r--   0        0        0     7757 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_double_pn.py
--rw-r--r--   0        0        0    12137 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_section_based.py
--rw-r--r--   0        0        0     2740 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single.py
--rw-r--r--   0        0        0     1968 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single_array.py
--rw-r--r--   0        0        0     6868 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single_bend_coupler.py
--rw-r--r--   0        0        0     2714 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single_dut.py
--rw-r--r--   0        0        0     4018 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single_heater.py
--rw-r--r--   0        0        0     5267 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/ring_single_pn.py
--rw-r--r--   0        0        0     2282 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/seal_ring.py
--rw-r--r--   0        0        0     3758 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/snspd.py
--rw-r--r--   0        0        0     2059 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/spiral_double.py
--rw-r--r--   0        0        0     5871 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/spiral_external_io.py
--rw-r--r--   0        0        0    16692 2023-05-19 23:05:02.458286 gdsfactory-6.97.0/gdsfactory/components/spiral_heater.py
--rw-r--r--   0        0        0     9181 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/spiral_inner_io.py
--rw-r--r--   0        0        0     1733 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/splitter_chain.py
--rw-r--r--   0        0        0     5327 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/splitter_tree.py
--rw-r--r--   0        0        0     2526 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight.py
--rw-r--r--   0        0        0     1033 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_array.py
--rw-r--r--   0        0        0     7914 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_heater_doped_rib.py
--rw-r--r--   0        0        0     1922 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_heater_doped_strip.py
--rw-r--r--   0        0        0     7891 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_heater_meander.py
--rw-r--r--   0        0        0     8090 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_heater_meander_doped.py
--rw-r--r--   0        0        0     5686 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_heater_metal.py
--rw-r--r--   0        0        0     2809 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_pin.py
--rw-r--r--   0        0        0     3974 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_pin_slot.py
--rw-r--r--   0        0        0      655 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/straight_rib.py
--rw-r--r--   0        0        0      820 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/switch_tree.py
--rw-r--r--   0        0        0     7730 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/taper.py
--rw-r--r--   0        0        0     3530 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/taper_adiabatic.py
--rw-r--r--   0        0        0     2457 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/taper_cross_section.py
--rw-r--r--   0        0        0     2363 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/taper_from_csv.py
--rw-r--r--   0        0        0     1215 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/taper_parabolic.py
--rw-r--r--   0        0        0     1635 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/terminator.py
--rw-r--r--   0        0        0     2913 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/text.py
--rw-r--r--   0        0        0     3821 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/text_freetype.py
--rw-r--r--   0        0        0     3160 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/text_rectangular.py
--rw-r--r--   0        0        0     3943 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/text_rectangular_font.py
--rw-r--r--   0        0        0     2536 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/triangles.py
--rw-r--r--   0        0        0      715 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/verniers.py
--rw-r--r--   0        0        0     2468 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/version_stamp.py
--rw-r--r--   0        0        0     2436 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via.py
--rw-r--r--   0        0        0     3060 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via_corner.py
--rw-r--r--   0        0        0     5342 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via_cutback.py
--rw-r--r--   0        0        0    15612 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via_stack.py
--rw-r--r--   0        0        0     4430 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via_stack_slot.py
--rw-r--r--   0        0        0     4944 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/via_stack_with_offset.py
--rw-r--r--   0        0        0     1088 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/wafer.py
--rw-r--r--   0        0        0     2542 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/wire.py
--rw-r--r--   0        0        0      978 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/components/wire_sbend.py
--rw-r--r--   0        0        0     8145 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/config.py
--rw-r--r--   0        0        0      481 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/conftest.py
--rw-r--r--   0        0        0    38409 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/constants.py
--rw-r--r--   0        0        0     1476 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/containers.py
--rw-r--r--   0        0        0    82893 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/cross_section.py
--rw-r--r--   0        0        0     2982 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/decorators.py
--rw-r--r--   0        0        0     7312 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/difftest.py
--rw-r--r--   0        0        0     1020 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/events.py
--rw-r--r--   0        0        0      204 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/export/__init__.py
--rw-r--r--   0        0        0     3353 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/export/to_3d.py
--rw-r--r--   0        0        0     1940 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/export/to_np.py
--rw-r--r--   0        0        0     3058 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/export/to_stl.py
--rw-r--r--   0        0        0     7445 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/export/write_gerbers.py
--rw-r--r--   0        0        0     2976 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/filestorage.py
--rw-r--r--   0        0        0    11890 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/fill.py
--rw-r--r--   0        0        0     7799 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/font.py
--rw-r--r--   0        0        0     8073 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/functions.py
--rw-r--r--   0        0        0       20 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/.gitattributes
--rw-r--r--   0        0        0       83 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/.gitconfig
--rw-r--r--   0        0        0       72 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/__init__.py
--rw-r--r--   0        0        0     1069 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/gds_diff_git.py
--rw-r--r--   0        0        0     2935 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/gdsdiff.py
--rw-r--r--   0        0        0      708 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/install.py
--rw-r--r--   0        0        0      271 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/sample.py
--rw-r--r--   0        0        0     1059 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/gdsdiff/test_xor.py
--rw-r--r--   0        0        0     1100 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/README.md
--rw-r--r--   0        0        0     1722 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/__init__.py
--rw-r--r--   0        0        0      169 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/generic_tech.sh
--rw-r--r--   0        0        0     8142 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/get_klayout_pyxs.py
--rw-r--r--   0        0        0      161 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/README.md
--rw-r--r--   0        0        0      104 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/drc/Makefile
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/drc/__init__.py
--rw-r--r--   0        0        0     2842 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/drc/errors.py
--rw-r--r--   0        0        0     6193 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/grain.xml
--rw-r--r--   0        0        0    10140 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/icon_128x128.png
--rw-r--r--   0        0        0     4248 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/icon_64x64.png
--rw-r--r--   0        0        0       27 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/.gitignore
--rw-r--r--   0        0        0      494 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/Makefile
--rw-r--r--   0        0        0     4062 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/README.md
--rw-r--r--   0        0        0     2419 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/README.md
--rw-r--r--   0        0        0     9696 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/generic_tech_malformed.drc
--rw-r--r--   0        0        0    12379 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/run_drc.py
--rw-r--r--   0        0        0     7235 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/generic_tech.lvs
--rw-r--r--   0        0        0     3446 2023-05-19 23:05:02.462286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/custom_classes.lvs
--rw-r--r--   0        0        0      479 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/devices_connections.lvs
--rw-r--r--   0        0        0      582 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_connections.lvs
--rw-r--r--   0        0        0      108 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_derivations.lvs
--rw-r--r--   0        0        0      186 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_connections.lvs
--rw-r--r--   0        0        0      398 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_derivations.lvs
--rw-r--r--   0        0        0      574 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_extraction.lvs
--rw-r--r--   0        0        0     6034 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/layers_definitions.lvs
--rw-r--r--   0        0        0    10704 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/run_lvs.py
--rw-r--r--   0        0        0      477 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/testing/testcases/README.md
--rw-r--r--   0        0        0     4337 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/layout/straight_heater_metal.py
--rw-r--r--   0        0        0      926 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/netlist/straight_heater_metal.spice
--rw-r--r--   0        0        0    10945 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/import_generic_pcells.lym
--rw-r--r--   0        0        0      710 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym
--rw-r--r--   0        0        0      538 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/set_shortcuts.lym
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/python/__init__.py
--rw-r--r--   0        0        0      114 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/python/kgdsfactory/__init__.py
--rw-r--r--   0        0        0     4311 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/python/kgdsfactory/shortcuts.py
--rw-r--r--   0        0        0      269 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/Makefile
--rw-r--r--   0        0        0     1854 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/d25/generic.lyd25
--rw-r--r--   0        0        0     1519 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/generic.layerstack
--rw-r--r--   0        0        0    41073 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/generic_tech.lyp
--rw-r--r--   0        0        0    40616 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/layers.lyp
--rw-r--r--   0        0        0     5977 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/tech.lyt
--rw-r--r--   0        0        0     4258 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_generic.pyxs
--rw-r--r--   0        0        0     4537 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_generic.xs
--rw-r--r--   0        0        0     4690 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_planarized.pyxs
--rw-r--r--   0        0        0     5508 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_planarized.xs
--rw-r--r--   0        0        0     1883 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/layer_map.py
--rw-r--r--   0        0        0     6511 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/layer_stack.py
--rw-r--r--   0        0        0    10780 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/layer_views.yaml
--rw-r--r--   0        0        0      158 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/generic_tech/simulation_settings.py
--rw-r--r--   0        0        0     1431 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/__init__.py
--rw-r--r--   0        0        0     4917 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/boolean.py
--rw-r--r--   0        0        0     3814 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/boolean_klayout.py
--rw-r--r--   0        0        0     1904 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/boolean_polygons.py
--rw-r--r--   0        0        0      598 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/check_duplicated_cells.py
--rw-r--r--   0        0        0     2719 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/check_exclusion.py
--rw-r--r--   0        0        0     2829 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/check_inclusion.py
--rw-r--r--   0        0        0     3566 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/check_space.py
--rw-r--r--   0        0        0     1904 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/check_width.py
--rw-r--r--   0        0        0     5015 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/fill_klayout.py
--rw-r--r--   0        0        0     7084 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/fill_tiled.py
--rw-r--r--   0        0        0     1697 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/fillet.py
--rw-r--r--   0        0        0     6664 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/functions.py
--rw-r--r--   0        0        0     2167 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/invert.py
--rw-r--r--   0        0        0     3685 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/layer_priority.py
--rw-r--r--   0        0        0     3054 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/manhattanize.py
--rw-r--r--   0        0        0     4192 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/maskprep.py
--rw-r--r--   0        0        0     4812 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/maskprep_flat.py
--rw-r--r--   0        0        0     3250 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/offset.py
--rw-r--r--   0        0        0     3842 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/outline.py
--rw-r--r--   0        0        0     2510 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/trim.py
--rw-r--r--   0        0        0     2948 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/union.py
--rw-r--r--   0        0        0     3023 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/write_connectivity.py
--rw-r--r--   0        0        0    10532 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/write_drc.py
--rw-r--r--   0        0        0     1783 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/geometry/xor_diff.py
--rw-r--r--   0        0        0     1158 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/get_factories.py
--rw-r--r--   0        0        0    23569 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/get_netlist.py
--rw-r--r--   0        0        0    14446 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/get_netlist_flat.py
--rw-r--r--   0        0        0      682 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/get_netlist_klayout.py
--rw-r--r--   0        0        0     9745 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/grid.py
--rw-r--r--   0        0        0     4393 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/install.py
--rw-r--r--   0        0        0     1970 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/klive.py
--rw-r--r--   0        0        0      585 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/__init__.py
--rw-r--r--   0        0        0     3563 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/add_label_yaml.py
--rw-r--r--   0        0        0     3847 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/ehva.py
--rw-r--r--   0        0        0     3810 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/merge_test_metadata.py
--rw-r--r--   0        0        0     4668 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/siepic.py
--rw-r--r--   0        0        0     4847 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/labels/write_labels.py
--rw-r--r--   0        0        0     1149 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/materials.py
--rw-r--r--   0        0        0     5247 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/name.py
--rw-r--r--   0        0        0    11586 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/pack.py
--rw-r--r--   0        0        0    50930 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/path.py
--rw-r--r--   0        0        0    27294 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/pdk.py
--rw-r--r--   0        0        0     6220 2023-05-19 23:05:02.466286 gdsfactory-6.97.0/gdsfactory/picmodel.py
--rw-r--r--   0        0        0     5068 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/pixelate.py
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/dagster/__init__.py
--rw-r--r--   0        0        0      976 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/dagster/workflow.py
--rw-r--r--   0        0        0      566 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/database/README.md
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/database/__init__.py
--rw-r--r--   0        0        0     6216 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/database/db_upload.py
--rw-r--r--   0        0        0    16143 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/database/models.py
--rw-r--r--   0        0        0       32 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/Makefile
--rw-r--r--   0        0        0       23 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/__init__.py
--rw-r--r--   0        0        0     4080 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/main.py
--rwxr-xr-x   0        0        0     7511 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/server.py
--rwxr-xr-x   0        0        0      594 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/server_jupyter.py
--rw-r--r--   0        0        0     1299 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/plugins/web/static/client.css
--rw-r--r--   0        0        0    32235 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/port.py
--rw-r--r--   0        0        0    37817 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/quickplotter.py
--rw-r--r--   0        0        0      696 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/__init__.py
--rw-r--r--   0        0        0     1639 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_dphox.py
--rw-r--r--   0        0        0     1285 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_gdspaths.py
--rw-r--r--   0        0        0     1953 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_np.py
--rw-r--r--   0        0        0     2813 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_phidl.py
--rw-r--r--   0        0        0    38082 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_yaml.py
--rw-r--r--   0        0        0     5897 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/from_yaml_template.py
--rw-r--r--   0        0        0     5688 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/import_gds.py
--rw-r--r--   0        0        0     3407 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/read/labels.py
--rw-r--r--   0        0        0     3769 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/__init__.py
--rw-r--r--   0        0        0     2920 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_shortest.py
--rw-r--r--   0        0        0     3015 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_top.py
--rw-r--r--   0        0        0     3035 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_top_dc.py
--rw-r--r--   0        0        0     8715 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_fiber_array.py
--rw-r--r--   0        0        0    10624 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_fiber_single.py
--rw-r--r--   0        0        0     8967 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/add_pads.py
--rw-r--r--   0        0        0    38948 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/all_angle.py
--rw-r--r--   0        0        0     3916 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/auto_taper.py
--rw-r--r--   0        0        0      982 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/factories.py
--rw-r--r--   0        0        0     4415 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/fanout.py
--rw-r--r--   0        0        0     2800 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/fanout2x2.py
--rw-r--r--   0        0        0    24342 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle.py
--rw-r--r--   0        0        0     8652 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_corner.py
--rw-r--r--   0        0        0     6910 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_from_steps.py
--rw-r--r--   0        0        0    12949 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_from_waypoints.py
--rw-r--r--   0        0        0     5284 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_path_length_match.py
--rw-r--r--   0        0        0     1937 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_sbend.py
--rw-r--r--   0        0        0    17064 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_bundle_u.py
--rw-r--r--   0        0        0     1510 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_input_labels.py
--rw-r--r--   0        0        0     9233 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_route.py
--rw-r--r--   0        0        0    10872 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_route_astar.py
--rw-r--r--   0        0        0     6119 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_route_from_steps.py
--rw-r--r--   0        0        0     2766 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_route_sbend.py
--rw-r--r--   0        0        0     3311 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_routes_bend180.py
--rw-r--r--   0        0        0     1854 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/get_routes_straight.py
--rw-r--r--   0        0        0    34394 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/manhattan.py
--rw-r--r--   0        0        0    10081 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/path_length_matching.py
--rw-r--r--   0        0        0    22568 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_fiber_array.py
--rw-r--r--   0        0        0     8679 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_fiber_single.py
--rw-r--r--   0        0        0    18132 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_ports_to_side.py
--rw-r--r--   0        0        0     4379 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_quad.py
--rw-r--r--   0        0        0    14370 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_sharp.py
--rw-r--r--   0        0        0    10167 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/route_south.py
--rw-r--r--   0        0        0     5072 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/sort_ports.py
--rw-r--r--   0        0        0     2477 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/routing/utils.py
--rw-r--r--   0        0        0     2897 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell.py
--rw-r--r--   0        0        0      646 2023-05-19 23:05:02.470286 gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell/test_straight_wide.yml
--rw-r--r--   0        0        0     1109 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell_with_pins.py
--rw-r--r--   0        0        0      664 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell_with_pins/test_straight_narrow.yml
--rw-r--r--   0        0        0      347 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/02_component_autoname.py
--rw-r--r--   0        0        0      887 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/03_move.py
--rw-r--r--   0        0        0      881 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/04_connect.py
--rw-r--r--   0        0        0      710 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/05_remove_layers.py
--rw-r--r--   0        0        0      931 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/06_remapping_layers.py
--rw-r--r--   0        0        0     1082 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/07_flattening_device.py
--rw-r--r--   0        0        0      475 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/08_group.py
--rw-r--r--   0        0        0     1631 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/11_component_layout.py
--rw-r--r--   0        0        0     2245 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/12_component_refs.py
--rw-r--r--   0        0        0      955 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/13_component_netlist.py
--rw-r--r--   0        0        0     2592 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/14_component_connectivity.py
--rw-r--r--   0        0        0     1636 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/15_component_sequence1.py
--rw-r--r--   0        0        0     1680 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/16_component_sequence2.py
--rw-r--r--   0        0        0      965 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/17_ports.py
--rw-r--r--   0        0        0      489 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/18_port_markers.py
--rw-r--r--   0        0        0      361 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/19_references.py
--rw-r--r--   0        0        0      533 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/20_components.py
--rw-r--r--   0        0        0      507 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/21_add_fiber_array.py
--rw-r--r--   0        0        0      493 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/22_add_fiber_single.py
--rw-r--r--   0        0        0      569 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/22_add_pads.py
--rw-r--r--   0        0        0      848 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/23_reticle.py
--rw-r--r--   0        0        0     1588 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/23_reticle_passives.py
--rw-r--r--   0        0        0      457 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/24_doe.py
--rw-r--r--   0        0        0      687 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/24_doe_2.py
--rw-r--r--   0        0        0      692 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/24_doe_3.py
--rw-r--r--   0        0        0      306 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/25_slot_cross_section.py
--rw-r--r--   0        0        0     1363 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/30_lidar.py
--rw-r--r--   0        0        0     1412 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/30_lidar_pcell.py
--rw-r--r--   0        0        0     1943 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/30_lidar_with_pads.py
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/__init__.py
--rw-r--r--   0        0        0     1307 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing.py
--rw-r--r--   0        0        0      558 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_basic_01.pic.yml
--rw-r--r--   0        0        0     6062 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_bundles.pic.yml
--rw-r--r--   0        0        0      444 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_error_intermediate_180.pic.yml
--rw-r--r--   0        0        0      463 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_error_overconstrained.pic.yml
--rw-r--r--   0        0        0     1552 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_gone_wrong.pic.yml
--rw-r--r--   0        0        0     1315 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_implicit_final_angle.pic.yml
--rw-r--r--   0        0        0      602 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_slalom.pic.yml
--rw-r--r--   0        0        0     3317 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_start_end_customizations.pic.yml
--rw-r--r--   0        0        0     1484 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_step_definitions.pic.yml
--rw-r--r--   0        0        0     3045 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_tricky_connections.pic.yml
--rw-r--r--   0        0        0     3782 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/all_angle_routes.pic.yml
--rw-r--r--   0        0        0     1988 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/big_device.py
--rw-r--r--   0        0        0       19 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/Makefile
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/__init__.py
--rw-r--r--   0        0        0     1129 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/benchmark/fill_demo.py
--rw-r--r--   0        0        0      343 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/benchmark/snap_demo_phidl.py
--rw-r--r--   0        0        0      637 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mask.pic.yml
--rw-r--r--   0        0        0      622 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mzi_lattice_filter.pic.yml
--rw-r--r--   0        0        0      569 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mzi_ubcpdk.pic.yml
--rw-r--r--   0        0        0      453 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/pads.pic.yml
--rw-r--r--   0        0        0      287 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/rectangles.pic.yml
--rw-r--r--   0        0        0     2260 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/drc_errors.py
--rw-r--r--   0        0        0     1014 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/drc_write.py
--rw-r--r--   0        0        0     4530 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/layers.py
--rw-r--r--   0        0        0      158 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/layers_sky130.py
--rw-r--r--   0        0        0      364 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/layers_xsection.py
--rw-r--r--   0        0        0     1062 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/lvs.py
--rw-r--r--   0        0        0      574 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/demo/pcell.py
--rw-r--r--   0        0        0     4174 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/netlists/mzi.yml
--rw-r--r--   0        0        0     5840 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/netlists/mzi_full.yml
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/__init__.py
--rw-r--r--   0        0        0     4235 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/fab_c.py
--rw-r--r--   0        0        0      475 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/fab_d/__init__.py
--rw-r--r--   0        0        0     1880 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/fab_d/phase_shifters.py
--rw-r--r--   0        0        0     1715 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c.py
--rw-r--r--   0        0        0       50 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_bend_euler_c_.csv
--rw-r--r--   0        0        0       93 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_gc_nitride_c_.csv
--rw-r--r--   0        0        0       85 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_mmi1x2_nitride_c_.csv
--rw-r--r--   0        0        0      139 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_mmi1x2_nitride_o_.csv
--rw-r--r--   0        0        0       90 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_mzi_nitride_c_.csv
--rw-r--r--   0        0        0      126 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_mzi_nitride_o_.csv
--rw-r--r--   0        0        0       48 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_ports_straight_c_.csv
--rw-r--r--   0        0        0     1023 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_c_.yml
--rw-r--r--   0        0        0     2140 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_nc_.yml
--rw-r--r--   0        0        0     1879 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nc_.yml
--rw-r--r--   0        0        0     1283 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nitride_c_.yml
--rw-r--r--   0        0        0     1632 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nc_.yml
--rw-r--r--   0        0        0     1061 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_c_.yml
--rw-r--r--   0        0        0     1054 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_o_.yml
--rw-r--r--   0        0        0     1617 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_no_.yml
--rw-r--r--   0        0        0     4497 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nc_.yml
--rw-r--r--   0        0        0     3625 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_c_.yml
--rw-r--r--   0        0        0     3603 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_o_.yml
--rw-r--r--   0        0        0     4455 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_no_.yml
--rw-r--r--   0        0        0      840 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_c_.yml
--rw-r--r--   0        0        0     2231 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_nc_.yml
--rw-r--r--   0        0        0      316 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/schematic.py
--rw-r--r--   0        0        0    17862 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/schematic_editor.py
--rw-r--r--   0        0        0     4194 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/serialization.py
--rw-r--r--   0        0        0     1612 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/show.py
--rw-r--r--   0        0        0      724 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/__init__.py
--rw-r--r--   0        0        0     4369 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/add_simulation_markers.py
--rw-r--r--   0        0        0     2476 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/convert_sparameters.py
--rw-r--r--   0        0        0      547 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/__init__.py
--rw-r--r--   0        0        0     2559 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/doping.py
--rw-r--r--   0        0        0    11977 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_simulation.py
--rw-r--r--   0        0        0    23687 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_simulation_xsection.py
--rw-r--r--   0        0        0    19756 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_solver.py
--rw-r--r--   0        0        0     1644 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/devsim/test_devsim.py
--rw-r--r--   0        0        0      189 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/disable_print.py
--rw-r--r--   0        0        0       79 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/eme/__init__.py
--rw-r--r--   0        0        0    14784 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/eme/meow_eme.py
--rw-r--r--   0        0        0     1787 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/eme/test_meow_simulation.py
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/fem/__init__.py
--rw-r--r--   0        0        0     8968 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/fem/mode_solver.py
--rw-r--r--   0        0        0     2221 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/fem/test_mode_solver.py
--rw-r--r--   0        0        0     3455 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/get_effective_indices.py
--rw-r--r--   0        0        0     3109 2023-05-19 23:05:02.474286 gdsfactory-6.97.0/gdsfactory/simulation/get_modes_path.py
--rw-r--r--   0        0        0     3888 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/get_sparameters_path.py
--rw-r--r--   0        0        0     2003 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/__init__.py
--rw-r--r--   0        0        0     3194 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_material.py
--rw-r--r--   0        0        0     6137 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_meep_geometry.py
--rw-r--r--   0        0        0     6054 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_port_eigenmode.py
--rw-r--r--   0        0        0    11014 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation.py
--rw-r--r--   0        0        0    15915 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation_grating_farfield.py
--rw-r--r--   0        0        0    18182 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation_grating_fiber.py
--rw-r--r--   0        0        0    12312 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/meep_adjoint_optimization.py
--rw-r--r--   0        0        0    11914 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_eigenmode.py
--rw-r--r--   0        0        0      832 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_materials.py
--rw-r--r--   0        0        0    10128 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_crossing.csv
--rw-r--r--   0        0        0    10128 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_straight.csv
--rw-r--r--   0        0        0     6642 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep.py
--rw-r--r--   0        0        0    10128 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_crossing.csv
--rw-r--r--   0        0        0    10128 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_straight.csv
--rw-r--r--   0        0        0    10093 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_symmetries_straight.csv
--rw-r--r--   0        0        0    10085 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi.csv
--rw-r--r--   0        0        0    10085 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi_pool.csv
--rw-r--r--   0        0        0    34701 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_crossing_symmetric.csv
--rw-r--r--   0        0        0    10123 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight.csv
--rw-r--r--   0        0        0     9966 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_batch.csv
--rw-r--r--   0        0        0     9966 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi.csv
--rw-r--r--   0        0        0    10085 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi_pool.csv
--rw-r--r--   0        0        0    10129 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_symmetric.csv
--rw-r--r--   0        0        0    14053 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_grating.py
--rw-r--r--   0        0        0    21281 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep.py
--rw-r--r--   0        0        0     8143 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep_batch.py
--rw-r--r--   0        0        0     9577 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep_mpi.py
--rw-r--r--   0        0        0     1246 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/__init__.py
--rw-r--r--   0        0        0     6653 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/break_geometry.py
--rw-r--r--   0        0        0    11250 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/mesh.py
--rw-r--r--   0        0        0    11824 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/meshtracker.py
--rw-r--r--   0        0        0     7752 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_component.py
--rw-r--r--   0        0        0     3644 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_gds.py
--rw-r--r--   0        0        0     3605 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_layerstack.py
--rw-r--r--   0        0        0     2990 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/refine.py
--rw-r--r--   0        0        0    10851 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/scratch/mesh3D.py
--rw-r--r--   0        0        0     2513 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/tests/test_meshing.py
--rw-r--r--   0        0        0    14168 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/uz_xsection_mesh.py
--rw-r--r--   0        0        0     7441 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/xy_xsection_mesh.py
--rw-r--r--   0        0        0    16334 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gmsh/xyz_mesh.py
--rw-r--r--   0        0        0     1624 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/__init__.py
--rw-r--r--   0        0        0     4368 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_results.py
--rw-r--r--   0        0        0    20009 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_simulation.py
--rw-r--r--   0        0        0    21071 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_simulation_grating_coupler.py
--rw-r--r--   0        0        0     2821 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/materials.py
--rw-r--r--   0        0        0    27439 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/modes.py
--rw-r--r--   0        0        0     8941 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/sim_run.yaml
--rw-r--r--   0        0        0     8114 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/sim_ref.yaml
--rw-r--r--   0        0        0     8114 2023-05-19 23:05:02.478286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/sim_run.yaml
--rw-r--r--   0        0        0      744 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_modes.py
--rw-r--r--   0        0        0      262 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_modes/test_sweep_width.csv
--rw-r--r--   0        0        0      879 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_results.py
--rw-r--r--   0        0        0     1505 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_simulation.py
--rw-r--r--   0        0        0     1270 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters.py
--rw-r--r--   0        0        0     9297 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters/test_sparameters_straight.csv
--rw-r--r--   0        0        0     1732 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters_grating_coupler.py
--rw-r--r--   0        0        0     1224 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/utils.py
--rw-r--r--   0        0        0    10515 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/write_sparameters.py
--rw-r--r--   0        0        0     7695 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/write_sparameters_grating_coupler.py
--rw-r--r--   0        0        0      588 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/__init__.py
--rw-r--r--   0        0        0    16091 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/interconnect.py
--rw-r--r--   0        0        0     4286 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/read.py
--rw-r--r--   0        0        0     3569 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/settings.py
--rw-r--r--   0        0        0     2368 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/test_read_sparameters.py
--rw-r--r--   0        0        0    19865 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/write_sparameters_lumerical.py
--rw-r--r--   0        0        0     1504 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/lumerical/write_sparameters_lumerical_components.py
--rw-r--r--   0        0        0      932 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/__init__.py
--rw-r--r--   0        0        0     1618 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/coupler.py
--rw-r--r--   0        0        0     4166 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_coupling_vs_gap.py
--rw-r--r--   0        0        0     2773 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_mode_dispersion.py
--rw-r--r--   0        0        0     8924 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_modes.py
--rwxr-xr-x   0        0        0     7032 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_modes_cross_section.py
--rw-r--r--   0        0        0     4458 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_neff_ng_dw_dh.py
--rw-r--r--   0        0        0     2728 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/find_neff_vs_width.py
--rw-r--r--   0        0        0     7148 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_coupler.py
--rwxr-xr-x   0        0        0     4462 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_cross_section.py
--rw-r--r--   0        0        0     5411 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_rib.py
--rw-r--r--   0        0        0     1110 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_nitride.csv
--rw-r--r--   0        0        0     1102 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_rib.csv
--rw-r--r--   0        0        0     1110 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_strip.csv
--rw-r--r--   0        0        0     8023 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/neff_convergence_test.py
--rw-r--r--   0        0        0      267 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/neff_vs_width.csv
--rw-r--r--   0        0        0     2469 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/overlap.py
--rw-r--r--   0        0        0      418 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_dw_dh.py
--rw-r--r--   0        0        0       83 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh.csv
--rw-r--r--   0        0        0      548 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh_dispersion.csv
--rw-r--r--   0        0        0     1137 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_find_modes.py
--rw-r--r--   0        0        0      649 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_find_modes_dispersion.py
--rw-r--r--   0        0        0      354 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_neff_vs_width.py
--rw-r--r--   0        0        0      113 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_neff_vs_width/test_neff_vs_width.csv
--rw-r--r--   0        0        0    15492 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/types.py
--rw-r--r--   0        0        0     1169 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/modes/waveguide.py
--rw-r--r--   0        0        0     2013 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/__init__.py
--rw-r--r--   0        0        0      597 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/coupler.py
--rw-r--r--   0        0        0      377 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/fsr.py
--rw-r--r--   0        0        0      418 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/heater.py
--rw-r--r--   0        0        0     3069 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/mzi.py
--rw-r--r--   0        0        0     2616 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/ring.py
--rw-r--r--   0        0        0     7332 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/plot.py
--rw-r--r--   0        0        0     2480 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/plot_csv.py
--rw-r--r--   0        0        0      703 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/port_symmetries.py
--rw-r--r--   0        0        0     4685 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/diffusion.py
--rw-r--r--   0        0        0     5317 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/implant_tables.py
--rw-r--r--   0        0        0     6800 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/pysrim.py
--rw-r--r--   0        0        0     2182 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/silicon.py
--rw-r--r--   0        0        0     1861 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/skew/antimony_si_skew.csv
--rw-r--r--   0        0        0     1050 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/skew/arsenic_si_skew.csv
--rw-r--r--   0        0        0     1468 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/skew/boron_si_skew.csv
--rw-r--r--   0        0        0     1118 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/process/skew/phosphorus_si_skew.csv
--rw-r--r--   0        0        0      191 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/__init__.py
--rw-r--r--   0        0        0    14848 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/build_model.py
--rw-r--r--   0        0        0     7449 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/femwell_waveguide_model.py
--rw-r--r--   0        0        0     1571 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/interpolators.py
--rw-r--r--   0        0        0     6755 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/meep_FDTD_model.py
--rw-r--r--   0        0        0     4528 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/meow_eme_model.py
--rw-r--r--   0        0        0     5613 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/mlp.py
--rw-r--r--   0        0        0     7358 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/models.py
--rw-r--r--   0        0        0    13894 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/parameter.py
--rwxr-xr-x   0        0        0     2225 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/plot_model.py
--rw-r--r--   0        0        0     6805 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/read.py
--rw-r--r--   0        0        0     1350 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_mzi.py
--rw-r--r--   0        0        0     2220 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_mzi_lattice.py
--rw-r--r--   0        0        0     1405 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_parameters.py
--rw-r--r--   0        0        0     1357 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/__init__.py
--rw-r--r--   0        0        0     1573 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/add_gc.py
--rw-r--r--   0        0        0     3383 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/circuit.py
--rw-r--r--   0        0        0      891 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/__init__.py
--rw-r--r--   0        0        0     1295 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/bend_circular.py
--rw-r--r--   0        0        0     1388 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/bend_euler.py
--rw-r--r--   0        0        0     2560 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler.py
--rw-r--r--   0        0        0     1046 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_fdtd.py
--rw-r--r--   0        0        0     1848 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring.py
--rw-r--r--   0        0        0     1329 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring_fdtd.py
--rw-r--r--   0        0        0      589 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring_siepic.py
--rw-r--r--   0        0        0      913 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/gc.py
--rw-r--r--   0        0        0     2032 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mmi1x2.py
--rw-r--r--   0        0        0     1910 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mmi2x2.py
--rw-r--r--   0        0        0     2618 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mzi.py
--rw-r--r--   0        0        0     1759 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mzi_siepic.py
--rw-r--r--   0        0        0      487 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mzi_thermal.py
--rw-r--r--   0        0        0     2597 2023-05-19 23:05:02.482286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_double.py
--rw-r--r--   0        0        0     1665 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_double_siepic.py
--rw-r--r--   0        0        0     1782 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_single.py
--rw-r--r--   0        0        0     1416 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_single_siepic.py
--rw-r--r--   0        0        0     1099 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/straight.py
--rw-r--r--   0        0        0      800 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/get_transmission.py
--rw-r--r--   0        0        0     2516 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/model_from_gdsfactory.py
--rw-r--r--   0        0        0     3841 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/model_from_sparameters.py
--rw-r--r--   0        0        0     2438 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_circuit.py
--rw-r--r--   0        0        0     1798 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_circuit_montecarlo.py
--rw-r--r--   0        0        0     2773 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_model.py
--rw-r--r--   0        0        0     1261 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_circuit.py
--rw-r--r--   0        0        0       90 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_circuit/test_circuit_transmission.yml
--rw-r--r--   0        0        0     1109 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components.py
--rw-r--r--   0        0        0       66 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_circuits_mzi_.yml
--rw-r--r--   0        0        0       69 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_circuits_ring_double_.yml
--rw-r--r--   0        0        0       69 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_circuits_ring_single_.yml
--rw-r--r--   0        0        0       92 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_bend_circular_.yml
--rw-r--r--   0        0        0       92 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_bend_euler_.yml
--rw-r--r--   0        0        0      412 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_coupler_.yml
--rw-r--r--   0        0        0      412 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_coupler_ring_.yml
--rw-r--r--   0        0        0      114 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_gc1550te_.yml
--rw-r--r--   0        0        0      256 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_mmi1x2_.yml
--rw-r--r--   0        0        0      460 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_mmi2x2_.yml
--rw-r--r--   0        0        0      104 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components/test_elements_straight_.yml
--rw-r--r--   0        0        0      166 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/simphony/types.py
--rw-r--r--   0        0        0      471 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/__init__.py
--rw-r--r--   0        0        0     1376 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/bend_circular.py
--rw-r--r--   0        0        0     1465 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/bend_euler.py
--rw-r--r--   0        0        0     2508 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/coupler.py
--rw-r--r--   0        0        0     1892 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/coupler_ring.py
--rw-r--r--   0        0        0      736 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/sipann/straight.py
--rw-r--r--   0        0        0      100 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/thermal/__init__.py
--rw-r--r--   0        0        0     7789 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/simulation/thermal/heater.py
--rw-r--r--   0        0        0     1744 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/snap.py
--rw-r--r--   0        0        0     4245 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/symbols.py
--rw-r--r--   0        0        0      524 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/__init__.py
--rw-r--r--   0        0        0     7607 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/klayout_tech.py
--rw-r--r--   0        0        0     1078 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/layer_map.py
--rw-r--r--   0        0        0    16139 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/layer_stack.py
--rw-r--r--   0        0        0    42133 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/layer_views.py
--rw-r--r--   0        0        0     1984 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/technology/simulation_settings.py
--rw-r--r--   0        0        0     1635 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/types.py
--rw-r--r--   0        0        0    10008 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/typings.py
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/__init__.py
--rw-r--r--   0        0        0     1342 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/async_utils.py
--rw-r--r--   0        0        0      376 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/color_utils.py
--rw-r--r--   0        0        0      558 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/file_utils.py
--rw-r--r--   0        0        0      185 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/function_utils.py
--rw-r--r--   0        0        0      684 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/xml_utils.py
--rw-r--r--   0        0        0     1453 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/utils/yaml_utils.py
--rw-r--r--   0        0        0     4865 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/watch.py
--rw-r--r--   0        0        0        0 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/widgets/__init__.py
--rw-r--r--   0        0        0     7969 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/widgets/layout_viewer.py
--rw-r--r--   0        0        0     7480 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/gdsfactory/write_cells.py
--rw-r--r--   0        0        0     5687 2023-05-19 23:05:02.486286 gdsfactory-6.97.0/pyproject.toml
--rw-r--r--   0        0        0    18772 1970-01-01 00:00:00.000000 gdsfactory-6.97.0/PKG-INFO
+-rw-r--r--   0        0        0     1072 2023-05-22 15:57:46.231794 gdsfactory-6.97.1/LICENSE
+-rw-r--r--   0        0        0    14319 2023-05-22 15:57:46.231794 gdsfactory-6.97.1/README.md
+-rw-r--r--   0        0        0     3583 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/__init__.py
+-rw-r--r--   0        0        0     2104 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_keepout.py
+-rw-r--r--   0        0        0    12629 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_labels.py
+-rw-r--r--   0        0        0     3711 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_loopback.py
+-rw-r--r--   0        0        0     5054 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_padding.py
+-rw-r--r--   0        0        0    15639 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_pins.py
+-rw-r--r--   0        0        0    14700 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_ports.py
+-rw-r--r--   0        0        0     2884 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_tapers.py
+-rw-r--r--   0        0        0     2257 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_tapers_cross_section.py
+-rw-r--r--   0        0        0     1831 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/add_termination.py
+-rw-r--r--   0        0        0     1856 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/asserts.py
+-rw-r--r--   0        0        0    17589 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/cell.py
+-rw-r--r--   0        0        0    16040 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/circuitviz.py
+-rw-r--r--   0        0        0     5718 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/cli.py
+-rw-r--r--   0        0        0   101901 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/component.py
+-rw-r--r--   0        0        0    23424 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/component_layout.py
+-rw-r--r--   0        0        0    29879 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/component_reference.py
+-rw-r--r--   0        0        0     1205 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/C.py
+-rw-r--r--   0        0        0     1144 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/L.py
+-rw-r--r--   0        0        0    20964 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/__init__.py
+-rw-r--r--   0        0        0     2621 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/add_fiducials.py
+-rw-r--r--   0        0        0    14087 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/add_grating_couplers.py
+-rw-r--r--   0        0        0     2014 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/add_trenches.py
+-rw-r--r--   0        0        0     3207 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/align.py
+-rw-r--r--   0        0        0     2622 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/array_component.py
+-rw-r--r--   0        0        0     4705 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/array_with_fanout.py
+-rw-r--r--   0        0        0     4322 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/array_with_via.py
+-rw-r--r--   0        0        0     4042 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/awg.py
+-rw-r--r--   0        0        0     1269 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bbox.py
+-rw-r--r--   0        0        0     2851 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bend_circular.py
+-rw-r--r--   0        0        0     2649 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bend_circular_heater.py
+-rw-r--r--   0        0        0     7903 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bend_euler.py
+-rw-r--r--   0        0        0     2682 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bend_port.py
+-rw-r--r--   0        0        0     3787 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bend_s.py
+-rw-r--r--   0        0        0     5373 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/bezier.py
+-rw-r--r--   0        0        0     1605 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/cavity.py
+-rw-r--r--   0        0        0     5766 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/cdc.py
+-rw-r--r--   0        0        0     2929 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/cdsem_all.py
+-rw-r--r--   0        0        0     1788 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/cdsem_bend180.py
+-rw-r--r--   0        0        0     1631 2023-05-22 15:57:46.243795 gdsfactory-6.97.1/gdsfactory/components/cdsem_coupler.py
+-rw-r--r--   0        0        0     1412 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cdsem_straight.py
+-rw-r--r--   0        0        0     1565 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cdsem_straight_density.py
+-rw-r--r--   0        0        0      793 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/circle.py
+-rw-r--r--   0        0        0     5722 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coh_rx_dual_pol.py
+-rw-r--r--   0        0        0     8922 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coh_rx_single_pol.py
+-rw-r--r--   0        0        0     5043 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coh_tx_dual_pol.py
+-rw-r--r--   0        0        0     6118 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coh_tx_single_pol.py
+-rw-r--r--   0        0        0     2548 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/compass.py
+-rw-r--r--   0        0        0     9876 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/component_lattice.py
+-rw-r--r--   0        0        0     7174 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/component_sequence.py
+-rw-r--r--   0        0        0      812 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/copy_layers.py
+-rw-r--r--   0        0        0     3460 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler.py
+-rw-r--r--   0        0        0     2113 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler90.py
+-rw-r--r--   0        0        0     1802 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler90bend.py
+-rw-r--r--   0        0        0     4666 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_adiabatic.py
+-rw-r--r--   0        0        0     1909 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_asymmetric.py
+-rw-r--r--   0        0        0     3970 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_full.py
+-rw-r--r--   0        0        0     3414 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_ring.py
+-rw-r--r--   0        0        0     1060 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_straight.py
+-rw-r--r--   0        0        0     1164 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_straight_asymmetric.py
+-rw-r--r--   0        0        0     2192 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/coupler_symmetric.py
+-rw-r--r--   0        0        0     1848 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cross.py
+-rw-r--r--   0        0        0    12873 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/crossing_waveguide.py
+-rw-r--r--   0        0        0      500 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/grating_coupler_1etch_h220_e70.csv
+-rw-r--r--   0        0        0     1014 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/grating_coupler_2etch_h220_e70_e220.csv
+-rw-r--r--   0        0        0    19749 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_100.csv
+-rw-r--r--   0        0        0    19751 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_150.csv
+-rw-r--r--   0        0        0    19749 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_200.csv
+-rw-r--r--   0        0        0    19751 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_11_200.csv
+-rw-r--r--   0        0        0    19775 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_12_200.csv
+-rw-r--r--   0        0        0     3143 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_3_36.csv
+-rw-r--r--   0        0        0     5272 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cutback_2x2.py
+-rw-r--r--   0        0        0     6450 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cutback_bend.py
+-rw-r--r--   0        0        0     3765 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cutback_component.py
+-rw-r--r--   0        0        0     2721 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/cutback_splitter.py
+-rw-r--r--   0        0        0     2971 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/dbr.py
+-rw-r--r--   0        0        0     4288 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/dbr_tapered.py
+-rw-r--r--   0        0        0     2486 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/delay_snake.py
+-rw-r--r--   0        0        0     3177 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/delay_snake2.py
+-rw-r--r--   0        0        0     3245 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/delay_snake3.py
+-rw-r--r--   0        0        0     4319 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/delay_snake_sbend.py
+-rw-r--r--   0        0        0     1226 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/dicing_lane.py
+-rw-r--r--   0        0        0     3471 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/die.py
+-rw-r--r--   0        0        0     2975 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/die_bbox.py
+-rw-r--r--   0        0        0     2863 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/die_bbox_frame.py
+-rw-r--r--   0        0        0     8015 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/disk.py
+-rw-r--r--   0        0        0     4112 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/edge_coupler_array.py
+-rw-r--r--   0        0        0     1214 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/ellipse.py
+-rw-r--r--   0        0        0     1800 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/extend_ports_list.py
+-rw-r--r--   0        0        0     7988 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/extension.py
+-rw-r--r--   0        0        0      981 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/fiber.py
+-rw-r--r--   0        0        0     1432 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/fiber_array.py
+-rw-r--r--   0        0        0      722 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/fiducial_squares.py
+-rw-r--r--   0        0        0     3290 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/ge_detector_straight_si_contacts.py
+-rw-r--r--   0        0        0     1063 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_array.py
+-rw-r--r--   0        0        0     4682 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_dual_pol.py
+-rw-r--r--   0        0        0     7110 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical.py
+-rw-r--r--   0        0        0     7222 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_arbitrary.py
+-rw-r--r--   0        0        0     4961 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_lumerical.py
+-rw-r--r--   0        0        0     4592 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_trenches.py
+-rw-r--r--   0        0        0     1773 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_functions.py
+-rw-r--r--   0        0        0     9058 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_loss.py
+-rw-r--r--   0        0        0     1786 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_loss_fiber_single.py
+-rw-r--r--   0        0        0     4142 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular.py
+-rw-r--r--   0        0        0     4685 2023-05-22 15:57:46.247796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular_arbitrary.py
+-rw-r--r--   0        0        0     3887 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular_arbitrary_slab.py
+-rw-r--r--   0        0        0     1579 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/grating_coupler_tree.py
+-rw-r--r--   0        0        0     8811 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/greek_cross.py
+-rw-r--r--   0        0        0     1019 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/hline.py
+-rw-r--r--   0        0        0     3687 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/interdigital_capacitor.py
+-rw-r--r--   0        0        0     1825 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/litho_calipers.py
+-rw-r--r--   0        0        0     1244 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/litho_ruler.py
+-rw-r--r--   0        0        0     1304 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/litho_steps.py
+-rw-r--r--   0        0        0      650 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/logo.py
+-rw-r--r--   0        0        0     1679 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/loop_mirror.py
+-rw-r--r--   0        0        0     3873 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mmi1x2.py
+-rw-r--r--   0        0        0     2814 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mmi1x2_with_sbend.py
+-rw-r--r--   0        0        0     3858 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mmi2x2.py
+-rw-r--r--   0        0        0     3299 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mmi2x2_with_sbend.py
+-rw-r--r--   0        0        0     4947 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mmi_90degree_hybrid.py
+-rw-r--r--   0        0        0     3265 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mode_converter.py
+-rw-r--r--   0        0        0     7579 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi.py
+-rw-r--r--   0        0        0     2499 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi_arm.py
+-rw-r--r--   0        0        0     5835 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi_arms.py
+-rw-r--r--   0        0        0    12214 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi_lattice.py
+-rw-r--r--   0        0        0     4025 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi_pads_center.py
+-rw-r--r--   0        0        0     1064 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzi_phase_shifter.py
+-rw-r--r--   0        0        0     6342 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzit.py
+-rw-r--r--   0        0        0     3502 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzit_lattice.py
+-rw-r--r--   0        0        0     6047 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/mzm.py
+-rw-r--r--   0        0        0     3518 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/nxn.py
+-rw-r--r--   0        0        0     1940 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/optimal_90deg.py
+-rw-r--r--   0        0        0     3876 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/optimal_hairpin.py
+-rw-r--r--   0        0        0     6131 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/optimal_step.py
+-rw-r--r--   0        0        0     6327 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/pack_doe.py
+-rw-r--r--   0        0        0     3860 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/pad.py
+-rw-r--r--   0        0        0     1890 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/pad_gsg.py
+-rw-r--r--   0        0        0     1157 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/pads_shorted.py
+-rw-r--r--   0        0        0     3833 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/polarization_splitter_rotator.py
+-rw-r--r--   0        0        0     1147 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ramp.py
+-rw-r--r--   0        0        0     1508 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/rectangle.py
+-rw-r--r--   0        0        0     2972 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/rectangle_with_slits.py
+-rw-r--r--   0        0        0     1508 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/regular_polygon.py
+-rw-r--r--   0        0        0     3302 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/resistance_meander.py
+-rw-r--r--   0        0        0     2642 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/resistance_sheet.py
+-rw-r--r--   0        0        0     1273 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring.py
+-rw-r--r--   0        0        0     4143 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_crow.py
+-rw-r--r--   0        0        0     3272 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_crow_couplers.py
+-rw-r--r--   0        0        0     2267 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_double.py
+-rw-r--r--   0        0        0     2846 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_double_bend_coupler.py
+-rw-r--r--   0        0        0     3846 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_double_heater.py
+-rw-r--r--   0        0        0     7757 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_double_pn.py
+-rw-r--r--   0        0        0    12137 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_section_based.py
+-rw-r--r--   0        0        0     2740 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single.py
+-rw-r--r--   0        0        0     1968 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single_array.py
+-rw-r--r--   0        0        0     6868 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single_bend_coupler.py
+-rw-r--r--   0        0        0     2714 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single_dut.py
+-rw-r--r--   0        0        0     4018 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single_heater.py
+-rw-r--r--   0        0        0     5267 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/ring_single_pn.py
+-rw-r--r--   0        0        0     2282 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/seal_ring.py
+-rw-r--r--   0        0        0     3758 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/snspd.py
+-rw-r--r--   0        0        0     2059 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/spiral_double.py
+-rw-r--r--   0        0        0     5871 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/spiral_external_io.py
+-rw-r--r--   0        0        0    16692 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/spiral_heater.py
+-rw-r--r--   0        0        0     9181 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/spiral_inner_io.py
+-rw-r--r--   0        0        0     1733 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/splitter_chain.py
+-rw-r--r--   0        0        0     5327 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/splitter_tree.py
+-rw-r--r--   0        0        0     2451 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight.py
+-rw-r--r--   0        0        0     1033 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_array.py
+-rw-r--r--   0        0        0     7914 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_heater_doped_rib.py
+-rw-r--r--   0        0        0     1922 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_heater_doped_strip.py
+-rw-r--r--   0        0        0     7891 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_heater_meander.py
+-rw-r--r--   0        0        0     8090 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_heater_meander_doped.py
+-rw-r--r--   0        0        0     5686 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_heater_metal.py
+-rw-r--r--   0        0        0     2809 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_pin.py
+-rw-r--r--   0        0        0     3974 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_pin_slot.py
+-rw-r--r--   0        0        0      655 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/straight_rib.py
+-rw-r--r--   0        0        0      820 2023-05-22 15:57:46.251796 gdsfactory-6.97.1/gdsfactory/components/switch_tree.py
+-rw-r--r--   0        0        0     7730 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/taper.py
+-rw-r--r--   0        0        0     3530 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/taper_adiabatic.py
+-rw-r--r--   0        0        0     2457 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/taper_cross_section.py
+-rw-r--r--   0        0        0     2363 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/taper_from_csv.py
+-rw-r--r--   0        0        0     1215 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/taper_parabolic.py
+-rw-r--r--   0        0        0     1635 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/terminator.py
+-rw-r--r--   0        0        0     2913 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/text.py
+-rw-r--r--   0        0        0     3821 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/text_freetype.py
+-rw-r--r--   0        0        0     3160 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/text_rectangular.py
+-rw-r--r--   0        0        0     3943 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/text_rectangular_font.py
+-rw-r--r--   0        0        0     2536 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/triangles.py
+-rw-r--r--   0        0        0      715 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/verniers.py
+-rw-r--r--   0        0        0     2468 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/version_stamp.py
+-rw-r--r--   0        0        0     2436 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via.py
+-rw-r--r--   0        0        0     3060 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via_corner.py
+-rw-r--r--   0        0        0     5342 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via_cutback.py
+-rw-r--r--   0        0        0    15612 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via_stack.py
+-rw-r--r--   0        0        0     4430 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via_stack_slot.py
+-rw-r--r--   0        0        0     4944 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/via_stack_with_offset.py
+-rw-r--r--   0        0        0     1088 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/wafer.py
+-rw-r--r--   0        0        0     2542 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/wire.py
+-rw-r--r--   0        0        0      978 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/components/wire_sbend.py
+-rw-r--r--   0        0        0     8145 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/config.py
+-rw-r--r--   0        0        0      481 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/conftest.py
+-rw-r--r--   0        0        0    38409 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/constants.py
+-rw-r--r--   0        0        0     1476 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/containers.py
+-rw-r--r--   0        0        0    83060 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/cross_section.py
+-rw-r--r--   0        0        0     2982 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/decorators.py
+-rw-r--r--   0        0        0     7312 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/difftest.py
+-rw-r--r--   0        0        0     1020 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/events.py
+-rw-r--r--   0        0        0      267 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/export/__init__.py
+-rw-r--r--   0        0        0     3353 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/export/to_3d.py
+-rw-r--r--   0        0        0     7599 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/export/to_gerber.py
+-rw-r--r--   0        0        0     1940 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/export/to_np.py
+-rw-r--r--   0        0        0     3058 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/export/to_stl.py
+-rw-r--r--   0        0        0     2976 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/filestorage.py
+-rw-r--r--   0        0        0    11890 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/fill.py
+-rw-r--r--   0        0        0     7799 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/font.py
+-rw-r--r--   0        0        0     8073 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/functions.py
+-rw-r--r--   0        0        0       20 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/.gitattributes
+-rw-r--r--   0        0        0       83 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/.gitconfig
+-rw-r--r--   0        0        0       72 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/__init__.py
+-rw-r--r--   0        0        0     1069 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/gds_diff_git.py
+-rw-r--r--   0        0        0     2935 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/gdsdiff.py
+-rw-r--r--   0        0        0      708 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/install.py
+-rw-r--r--   0        0        0      271 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/sample.py
+-rw-r--r--   0        0        0     1059 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/gdsdiff/test_xor.py
+-rw-r--r--   0        0        0     1100 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/README.md
+-rw-r--r--   0        0        0     1722 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/__init__.py
+-rw-r--r--   0        0        0      169 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/generic_tech.sh
+-rw-r--r--   0        0        0     8142 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/get_klayout_pyxs.py
+-rw-r--r--   0        0        0      161 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/README.md
+-rw-r--r--   0        0        0      104 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/drc/Makefile
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/drc/__init__.py
+-rw-r--r--   0        0        0     2842 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/drc/errors.py
+-rw-r--r--   0        0        0     6193 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/grain.xml
+-rw-r--r--   0        0        0    10140 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/icon_128x128.png
+-rw-r--r--   0        0        0     4248 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/icon_64x64.png
+-rw-r--r--   0        0        0       27 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/.gitignore
+-rw-r--r--   0        0        0      494 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/Makefile
+-rw-r--r--   0        0        0     4062 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/README.md
+-rw-r--r--   0        0        0     2419 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/README.md
+-rw-r--r--   0        0        0     9696 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/generic_tech_malformed.drc
+-rw-r--r--   0        0        0    12379 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/run_drc.py
+-rw-r--r--   0        0        0     7235 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/generic_tech.lvs
+-rw-r--r--   0        0        0     3446 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/custom_classes.lvs
+-rw-r--r--   0        0        0      479 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/devices_connections.lvs
+-rw-r--r--   0        0        0      582 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_connections.lvs
+-rw-r--r--   0        0        0      108 2023-05-22 15:57:46.255796 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_derivations.lvs
+-rw-r--r--   0        0        0      186 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_connections.lvs
+-rw-r--r--   0        0        0      398 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_derivations.lvs
+-rw-r--r--   0        0        0      574 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_extraction.lvs
+-rw-r--r--   0        0        0     6034 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/layers_definitions.lvs
+-rw-r--r--   0        0        0    10704 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/run_lvs.py
+-rw-r--r--   0        0        0      477 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/testing/testcases/README.md
+-rw-r--r--   0        0        0     4337 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/layout/straight_heater_metal.py
+-rw-r--r--   0        0        0      926 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/netlist/straight_heater_metal.spice
+-rw-r--r--   0        0        0    10945 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/import_generic_pcells.lym
+-rw-r--r--   0        0        0      710 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym
+-rw-r--r--   0        0        0      538 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/set_shortcuts.lym
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/python/__init__.py
+-rw-r--r--   0        0        0      114 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/python/kgdsfactory/__init__.py
+-rw-r--r--   0        0        0     4311 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/python/kgdsfactory/shortcuts.py
+-rw-r--r--   0        0        0      269 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/Makefile
+-rw-r--r--   0        0        0     1854 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/d25/generic.lyd25
+-rw-r--r--   0        0        0     1519 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/generic.layerstack
+-rw-r--r--   0        0        0    41073 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/generic_tech.lyp
+-rw-r--r--   0        0        0    40616 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/layers.lyp
+-rw-r--r--   0        0        0     5977 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/tech.lyt
+-rw-r--r--   0        0        0     4258 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_generic.pyxs
+-rw-r--r--   0        0        0     4537 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_generic.xs
+-rw-r--r--   0        0        0     4690 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_planarized.pyxs
+-rw-r--r--   0        0        0     5508 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_planarized.xs
+-rw-r--r--   0        0        0     1883 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/layer_map.py
+-rw-r--r--   0        0        0     6511 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/layer_stack.py
+-rw-r--r--   0        0        0    10780 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/layer_views.yaml
+-rw-r--r--   0        0        0      158 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/generic_tech/simulation_settings.py
+-rw-r--r--   0        0        0     1431 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/__init__.py
+-rw-r--r--   0        0        0     4917 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/boolean.py
+-rw-r--r--   0        0        0     3814 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/boolean_klayout.py
+-rw-r--r--   0        0        0     1904 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/boolean_polygons.py
+-rw-r--r--   0        0        0      598 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/check_duplicated_cells.py
+-rw-r--r--   0        0        0     2719 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/check_exclusion.py
+-rw-r--r--   0        0        0     2829 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/check_inclusion.py
+-rw-r--r--   0        0        0     3566 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/check_space.py
+-rw-r--r--   0        0        0     1904 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/check_width.py
+-rw-r--r--   0        0        0     5015 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/fill_klayout.py
+-rw-r--r--   0        0        0     7084 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/fill_tiled.py
+-rw-r--r--   0        0        0     1697 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/fillet.py
+-rw-r--r--   0        0        0     6664 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/functions.py
+-rw-r--r--   0        0        0     2167 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/invert.py
+-rw-r--r--   0        0        0     3685 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/layer_priority.py
+-rw-r--r--   0        0        0     3054 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/manhattanize.py
+-rw-r--r--   0        0        0     4192 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/maskprep.py
+-rw-r--r--   0        0        0     4812 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/maskprep_flat.py
+-rw-r--r--   0        0        0     3250 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/offset.py
+-rw-r--r--   0        0        0     3842 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/outline.py
+-rw-r--r--   0        0        0     2510 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/trim.py
+-rw-r--r--   0        0        0     2948 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/union.py
+-rw-r--r--   0        0        0     3023 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/write_connectivity.py
+-rw-r--r--   0        0        0    10532 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/write_drc.py
+-rw-r--r--   0        0        0     1783 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/geometry/xor_diff.py
+-rw-r--r--   0        0        0     1158 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/get_factories.py
+-rw-r--r--   0        0        0    23569 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/get_netlist.py
+-rw-r--r--   0        0        0    14446 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/get_netlist_flat.py
+-rw-r--r--   0        0        0      682 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/get_netlist_klayout.py
+-rw-r--r--   0        0        0     9745 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/grid.py
+-rw-r--r--   0        0        0     4393 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/install.py
+-rw-r--r--   0        0        0     1970 2023-05-22 15:57:46.259797 gdsfactory-6.97.1/gdsfactory/klive.py
+-rw-r--r--   0        0        0      585 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/__init__.py
+-rw-r--r--   0        0        0     3563 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/add_label_yaml.py
+-rw-r--r--   0        0        0     3847 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/ehva.py
+-rw-r--r--   0        0        0     3810 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/merge_test_metadata.py
+-rw-r--r--   0        0        0     4668 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/siepic.py
+-rw-r--r--   0        0        0     4847 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/labels/write_labels.py
+-rw-r--r--   0        0        0     1149 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/materials.py
+-rw-r--r--   0        0        0     5247 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/name.py
+-rw-r--r--   0        0        0    11586 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/pack.py
+-rw-r--r--   0        0        0    50930 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/path.py
+-rw-r--r--   0        0        0    27294 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/pdk.py
+-rw-r--r--   0        0        0     6220 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/picmodel.py
+-rw-r--r--   0        0        0     5068 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/pixelate.py
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/dagster/__init__.py
+-rw-r--r--   0        0        0      976 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/dagster/workflow.py
+-rw-r--r--   0        0        0      566 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/database/README.md
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/database/__init__.py
+-rw-r--r--   0        0        0     6216 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/database/db_upload.py
+-rw-r--r--   0        0        0    16143 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/database/models.py
+-rw-r--r--   0        0        0       32 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/Makefile
+-rw-r--r--   0        0        0       23 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/__init__.py
+-rw-r--r--   0        0        0     4080 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/main.py
+-rwxr-xr-x   0        0        0     7511 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/server.py
+-rwxr-xr-x   0        0        0      594 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/server_jupyter.py
+-rw-r--r--   0        0        0     1299 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/plugins/web/static/client.css
+-rw-r--r--   0        0        0    32235 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/port.py
+-rw-r--r--   0        0        0    37817 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/quickplotter.py
+-rw-r--r--   0        0        0      696 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/__init__.py
+-rw-r--r--   0        0        0     1639 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_dphox.py
+-rw-r--r--   0        0        0     1285 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_gdspaths.py
+-rw-r--r--   0        0        0     1953 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_np.py
+-rw-r--r--   0        0        0     2813 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_phidl.py
+-rw-r--r--   0        0        0    38082 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_yaml.py
+-rw-r--r--   0        0        0     5897 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/from_yaml_template.py
+-rw-r--r--   0        0        0     5688 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/import_gds.py
+-rw-r--r--   0        0        0     3407 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/read/labels.py
+-rw-r--r--   0        0        0     3769 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/__init__.py
+-rw-r--r--   0        0        0     2920 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_shortest.py
+-rw-r--r--   0        0        0     3015 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_top.py
+-rw-r--r--   0        0        0     3035 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_top_dc.py
+-rw-r--r--   0        0        0     8715 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_fiber_array.py
+-rw-r--r--   0        0        0    10624 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_fiber_single.py
+-rw-r--r--   0        0        0     8967 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/add_pads.py
+-rw-r--r--   0        0        0    38948 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/all_angle.py
+-rw-r--r--   0        0        0     3916 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/auto_taper.py
+-rw-r--r--   0        0        0      982 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/factories.py
+-rw-r--r--   0        0        0     4415 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/fanout.py
+-rw-r--r--   0        0        0     2800 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/fanout2x2.py
+-rw-r--r--   0        0        0    24342 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/get_bundle.py
+-rw-r--r--   0        0        0     8652 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_corner.py
+-rw-r--r--   0        0        0     6910 2023-05-22 15:57:46.263797 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_from_steps.py
+-rw-r--r--   0        0        0    12949 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_from_waypoints.py
+-rw-r--r--   0        0        0     5284 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_path_length_match.py
+-rw-r--r--   0        0        0     1937 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_sbend.py
+-rw-r--r--   0        0        0    17064 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_bundle_u.py
+-rw-r--r--   0        0        0     1510 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_input_labels.py
+-rw-r--r--   0        0        0     9233 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_route.py
+-rw-r--r--   0        0        0    10872 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_route_astar.py
+-rw-r--r--   0        0        0     6119 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_route_from_steps.py
+-rw-r--r--   0        0        0     2766 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_route_sbend.py
+-rw-r--r--   0        0        0     3311 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_routes_bend180.py
+-rw-r--r--   0        0        0     1854 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/get_routes_straight.py
+-rw-r--r--   0        0        0    34394 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/manhattan.py
+-rw-r--r--   0        0        0    10081 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/path_length_matching.py
+-rw-r--r--   0        0        0    22568 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_fiber_array.py
+-rw-r--r--   0        0        0     8679 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_fiber_single.py
+-rw-r--r--   0        0        0    18132 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_ports_to_side.py
+-rw-r--r--   0        0        0     4379 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_quad.py
+-rw-r--r--   0        0        0    14370 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_sharp.py
+-rw-r--r--   0        0        0    10167 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/route_south.py
+-rw-r--r--   0        0        0     5072 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/sort_ports.py
+-rw-r--r--   0        0        0     2477 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/routing/utils.py
+-rw-r--r--   0        0        0     2897 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell.py
+-rw-r--r--   0        0        0      646 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell/test_straight_wide.yml
+-rw-r--r--   0        0        0     1109 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell_with_pins.py
+-rw-r--r--   0        0        0      664 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell_with_pins/test_straight_narrow.yml
+-rw-r--r--   0        0        0      347 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/02_component_autoname.py
+-rw-r--r--   0        0        0      887 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/03_move.py
+-rw-r--r--   0        0        0      881 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/04_connect.py
+-rw-r--r--   0        0        0      710 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/05_remove_layers.py
+-rw-r--r--   0        0        0      931 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/06_remapping_layers.py
+-rw-r--r--   0        0        0     1082 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/07_flattening_device.py
+-rw-r--r--   0        0        0      475 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/08_group.py
+-rw-r--r--   0        0        0     1631 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/11_component_layout.py
+-rw-r--r--   0        0        0     2245 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/12_component_refs.py
+-rw-r--r--   0        0        0      955 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/13_component_netlist.py
+-rw-r--r--   0        0        0     2592 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/14_component_connectivity.py
+-rw-r--r--   0        0        0     1636 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/15_component_sequence1.py
+-rw-r--r--   0        0        0     1680 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/16_component_sequence2.py
+-rw-r--r--   0        0        0      965 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/17_ports.py
+-rw-r--r--   0        0        0      489 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/18_port_markers.py
+-rw-r--r--   0        0        0      361 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/19_references.py
+-rw-r--r--   0        0        0      533 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/20_components.py
+-rw-r--r--   0        0        0      507 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/21_add_fiber_array.py
+-rw-r--r--   0        0        0      493 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/22_add_fiber_single.py
+-rw-r--r--   0        0        0      569 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/22_add_pads.py
+-rw-r--r--   0        0        0      848 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/23_reticle.py
+-rw-r--r--   0        0        0     1588 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/23_reticle_passives.py
+-rw-r--r--   0        0        0      457 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/24_doe.py
+-rw-r--r--   0        0        0      687 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/24_doe_2.py
+-rw-r--r--   0        0        0      692 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/24_doe_3.py
+-rw-r--r--   0        0        0      306 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/25_slot_cross_section.py
+-rw-r--r--   0        0        0     1363 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/30_lidar.py
+-rw-r--r--   0        0        0     1412 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/30_lidar_pcell.py
+-rw-r--r--   0        0        0     1943 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/30_lidar_with_pads.py
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/__init__.py
+-rw-r--r--   0        0        0     1307 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing.py
+-rw-r--r--   0        0        0      558 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_basic_01.pic.yml
+-rw-r--r--   0        0        0     6062 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_bundles.pic.yml
+-rw-r--r--   0        0        0      444 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_error_intermediate_180.pic.yml
+-rw-r--r--   0        0        0      463 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_error_overconstrained.pic.yml
+-rw-r--r--   0        0        0     1552 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_gone_wrong.pic.yml
+-rw-r--r--   0        0        0     1315 2023-05-22 15:57:46.267798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_implicit_final_angle.pic.yml
+-rw-r--r--   0        0        0      602 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_slalom.pic.yml
+-rw-r--r--   0        0        0     3317 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_start_end_customizations.pic.yml
+-rw-r--r--   0        0        0     1484 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_step_definitions.pic.yml
+-rw-r--r--   0        0        0     3045 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_tricky_connections.pic.yml
+-rw-r--r--   0        0        0     3782 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/all_angle_routes.pic.yml
+-rw-r--r--   0        0        0     1988 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/big_device.py
+-rw-r--r--   0        0        0       19 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/Makefile
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/__init__.py
+-rw-r--r--   0        0        0     1129 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/benchmark/fill_demo.py
+-rw-r--r--   0        0        0      343 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/benchmark/snap_demo_phidl.py
+-rw-r--r--   0        0        0      637 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mask.pic.yml
+-rw-r--r--   0        0        0      622 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mzi_lattice_filter.pic.yml
+-rw-r--r--   0        0        0      569 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mzi_ubcpdk.pic.yml
+-rw-r--r--   0        0        0      453 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/pads.pic.yml
+-rw-r--r--   0        0        0      287 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/rectangles.pic.yml
+-rw-r--r--   0        0        0     2260 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/drc_errors.py
+-rw-r--r--   0        0        0     1014 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/drc_write.py
+-rw-r--r--   0        0        0     4530 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/layers.py
+-rw-r--r--   0        0        0      158 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/layers_sky130.py
+-rw-r--r--   0        0        0      364 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/layers_xsection.py
+-rw-r--r--   0        0        0     1062 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/lvs.py
+-rw-r--r--   0        0        0      574 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/demo/pcell.py
+-rw-r--r--   0        0        0     4174 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/netlists/mzi.yml
+-rw-r--r--   0        0        0     5840 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/netlists/mzi_full.yml
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/__init__.py
+-rw-r--r--   0        0        0     4235 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/fab_c.py
+-rw-r--r--   0        0        0      475 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/fab_d/__init__.py
+-rw-r--r--   0        0        0     1880 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/fab_d/phase_shifters.py
+-rw-r--r--   0        0        0     1715 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c.py
+-rw-r--r--   0        0        0       50 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_bend_euler_c_.csv
+-rw-r--r--   0        0        0       93 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_gc_nitride_c_.csv
+-rw-r--r--   0        0        0       85 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_mmi1x2_nitride_c_.csv
+-rw-r--r--   0        0        0      139 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_mmi1x2_nitride_o_.csv
+-rw-r--r--   0        0        0       90 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_mzi_nitride_c_.csv
+-rw-r--r--   0        0        0      126 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_mzi_nitride_o_.csv
+-rw-r--r--   0        0        0       48 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_ports_straight_c_.csv
+-rw-r--r--   0        0        0     1023 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_c_.yml
+-rw-r--r--   0        0        0     2206 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_nc_.yml
+-rw-r--r--   0        0        0     1879 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nc_.yml
+-rw-r--r--   0        0        0     1283 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nitride_c_.yml
+-rw-r--r--   0        0        0     1632 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nc_.yml
+-rw-r--r--   0        0        0     1061 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_c_.yml
+-rw-r--r--   0        0        0     1054 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_o_.yml
+-rw-r--r--   0        0        0     1617 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_no_.yml
+-rw-r--r--   0        0        0     4497 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nc_.yml
+-rw-r--r--   0        0        0     3625 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_c_.yml
+-rw-r--r--   0        0        0     3603 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_o_.yml
+-rw-r--r--   0        0        0     4455 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_no_.yml
+-rw-r--r--   0        0        0      840 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_c_.yml
+-rw-r--r--   0        0        0     2297 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_nc_.yml
+-rw-r--r--   0        0        0      316 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/schematic.py
+-rw-r--r--   0        0        0    17862 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/schematic_editor.py
+-rw-r--r--   0        0        0     4194 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/serialization.py
+-rw-r--r--   0        0        0     1612 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/show.py
+-rw-r--r--   0        0        0      724 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/__init__.py
+-rw-r--r--   0        0        0     4369 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/add_simulation_markers.py
+-rw-r--r--   0        0        0     2476 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/convert_sparameters.py
+-rw-r--r--   0        0        0      547 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/__init__.py
+-rw-r--r--   0        0        0     2559 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/doping.py
+-rw-r--r--   0        0        0    11977 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_simulation.py
+-rw-r--r--   0        0        0    23687 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_simulation_xsection.py
+-rw-r--r--   0        0        0    19756 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_solver.py
+-rw-r--r--   0        0        0     1644 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/devsim/test_devsim.py
+-rw-r--r--   0        0        0      189 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/disable_print.py
+-rw-r--r--   0        0        0       79 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/eme/__init__.py
+-rw-r--r--   0        0        0    14784 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/eme/meow_eme.py
+-rw-r--r--   0        0        0     1787 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/eme/test_meow_simulation.py
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/fem/__init__.py
+-rw-r--r--   0        0        0     8968 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/fem/mode_solver.py
+-rw-r--r--   0        0        0     2221 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/fem/test_mode_solver.py
+-rw-r--r--   0        0        0     3455 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/get_effective_indices.py
+-rw-r--r--   0        0        0     3109 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/get_modes_path.py
+-rw-r--r--   0        0        0     3888 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/get_sparameters_path.py
+-rw-r--r--   0        0        0     2003 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/__init__.py
+-rw-r--r--   0        0        0     3194 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_material.py
+-rw-r--r--   0        0        0     6137 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_meep_geometry.py
+-rw-r--r--   0        0        0     6054 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_port_eigenmode.py
+-rw-r--r--   0        0        0    11014 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation.py
+-rw-r--r--   0        0        0    15915 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation_grating_farfield.py
+-rw-r--r--   0        0        0    18182 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation_grating_fiber.py
+-rw-r--r--   0        0        0    12312 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/meep_adjoint_optimization.py
+-rw-r--r--   0        0        0    11914 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_eigenmode.py
+-rw-r--r--   0        0        0      832 2023-05-22 15:57:46.271798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_materials.py
+-rw-r--r--   0        0        0    10128 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_crossing.csv
+-rw-r--r--   0        0        0    10128 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_straight.csv
+-rw-r--r--   0        0        0     6642 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep.py
+-rw-r--r--   0        0        0    10128 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_crossing.csv
+-rw-r--r--   0        0        0    10128 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_straight.csv
+-rw-r--r--   0        0        0    10093 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_symmetries_straight.csv
+-rw-r--r--   0        0        0    10085 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi.csv
+-rw-r--r--   0        0        0    10085 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi_pool.csv
+-rw-r--r--   0        0        0    34701 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_crossing_symmetric.csv
+-rw-r--r--   0        0        0    10123 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight.csv
+-rw-r--r--   0        0        0     9966 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_batch.csv
+-rw-r--r--   0        0        0     9966 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi.csv
+-rw-r--r--   0        0        0    10085 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi_pool.csv
+-rw-r--r--   0        0        0    10129 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_symmetric.csv
+-rw-r--r--   0        0        0    14053 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_grating.py
+-rw-r--r--   0        0        0    21281 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep.py
+-rw-r--r--   0        0        0     8143 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep_batch.py
+-rw-r--r--   0        0        0     9577 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep_mpi.py
+-rw-r--r--   0        0        0     1246 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/__init__.py
+-rw-r--r--   0        0        0     6653 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/break_geometry.py
+-rw-r--r--   0        0        0    11250 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/mesh.py
+-rw-r--r--   0        0        0    11824 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/meshtracker.py
+-rw-r--r--   0        0        0     7752 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_component.py
+-rw-r--r--   0        0        0     3644 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_gds.py
+-rw-r--r--   0        0        0     3605 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_layerstack.py
+-rw-r--r--   0        0        0     2990 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/refine.py
+-rw-r--r--   0        0        0    10851 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/scratch/mesh3D.py
+-rw-r--r--   0        0        0     2513 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/tests/test_meshing.py
+-rw-r--r--   0        0        0    14168 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/uz_xsection_mesh.py
+-rw-r--r--   0        0        0     7441 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/xy_xsection_mesh.py
+-rw-r--r--   0        0        0    16334 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gmsh/xyz_mesh.py
+-rw-r--r--   0        0        0     1624 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/__init__.py
+-rw-r--r--   0        0        0     4368 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_results.py
+-rw-r--r--   0        0        0    20009 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_simulation.py
+-rw-r--r--   0        0        0    21071 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_simulation_grating_coupler.py
+-rw-r--r--   0        0        0     2821 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/materials.py
+-rw-r--r--   0        0        0    27439 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/modes.py
+-rw-r--r--   0        0        0     8941 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/sim_run.yaml
+-rw-r--r--   0        0        0     8114 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/sim_ref.yaml
+-rw-r--r--   0        0        0     8114 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/sim_run.yaml
+-rw-r--r--   0        0        0      744 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_modes.py
+-rw-r--r--   0        0        0      262 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_modes/test_sweep_width.csv
+-rw-r--r--   0        0        0      879 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_results.py
+-rw-r--r--   0        0        0     1505 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_simulation.py
+-rw-r--r--   0        0        0     1270 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters.py
+-rw-r--r--   0        0        0     9297 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters/test_sparameters_straight.csv
+-rw-r--r--   0        0        0     1732 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters_grating_coupler.py
+-rw-r--r--   0        0        0     1224 2023-05-22 15:57:46.275798 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/utils.py
+-rw-r--r--   0        0        0    11034 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/write_sparameters.py
+-rw-r--r--   0        0        0     7695 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/write_sparameters_grating_coupler.py
+-rw-r--r--   0        0        0      588 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/__init__.py
+-rw-r--r--   0        0        0    16091 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/interconnect.py
+-rw-r--r--   0        0        0     4286 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/read.py
+-rw-r--r--   0        0        0     3569 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/settings.py
+-rw-r--r--   0        0        0     2368 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/test_read_sparameters.py
+-rw-r--r--   0        0        0    19865 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/write_sparameters_lumerical.py
+-rw-r--r--   0        0        0     1504 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/lumerical/write_sparameters_lumerical_components.py
+-rw-r--r--   0        0        0      932 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/__init__.py
+-rw-r--r--   0        0        0     1618 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/coupler.py
+-rw-r--r--   0        0        0     4166 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_coupling_vs_gap.py
+-rw-r--r--   0        0        0     2773 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_mode_dispersion.py
+-rw-r--r--   0        0        0     8924 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_modes.py
+-rwxr-xr-x   0        0        0     7032 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_modes_cross_section.py
+-rw-r--r--   0        0        0     4458 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_neff_ng_dw_dh.py
+-rw-r--r--   0        0        0     2728 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/find_neff_vs_width.py
+-rw-r--r--   0        0        0     7148 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_coupler.py
+-rwxr-xr-x   0        0        0     4462 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_cross_section.py
+-rw-r--r--   0        0        0     5411 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_rib.py
+-rw-r--r--   0        0        0     1110 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_nitride.csv
+-rw-r--r--   0        0        0     1102 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_rib.csv
+-rw-r--r--   0        0        0     1110 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_strip.csv
+-rw-r--r--   0        0        0     8023 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/neff_convergence_test.py
+-rw-r--r--   0        0        0      267 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/neff_vs_width.csv
+-rw-r--r--   0        0        0     2469 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/overlap.py
+-rw-r--r--   0        0        0      418 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_dw_dh.py
+-rw-r--r--   0        0        0       83 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh.csv
+-rw-r--r--   0        0        0      548 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh_dispersion.csv
+-rw-r--r--   0        0        0     1137 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_find_modes.py
+-rw-r--r--   0        0        0      649 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_find_modes_dispersion.py
+-rw-r--r--   0        0        0      354 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_neff_vs_width.py
+-rw-r--r--   0        0        0      113 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_neff_vs_width/test_neff_vs_width.csv
+-rw-r--r--   0        0        0    15492 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/types.py
+-rw-r--r--   0        0        0     1169 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/modes/waveguide.py
+-rw-r--r--   0        0        0     2013 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/__init__.py
+-rw-r--r--   0        0        0      597 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/coupler.py
+-rw-r--r--   0        0        0      377 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/fsr.py
+-rw-r--r--   0        0        0      418 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/heater.py
+-rw-r--r--   0        0        0     3069 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/mzi.py
+-rw-r--r--   0        0        0     2616 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/ring.py
+-rw-r--r--   0        0        0     7332 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/plot.py
+-rw-r--r--   0        0        0     2480 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/plot_csv.py
+-rw-r--r--   0        0        0      703 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/port_symmetries.py
+-rw-r--r--   0        0        0     4685 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/diffusion.py
+-rw-r--r--   0        0        0     5317 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/implant_tables.py
+-rw-r--r--   0        0        0     6800 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/pysrim.py
+-rw-r--r--   0        0        0     2182 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/silicon.py
+-rw-r--r--   0        0        0     1861 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/skew/antimony_si_skew.csv
+-rw-r--r--   0        0        0     1050 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/skew/arsenic_si_skew.csv
+-rw-r--r--   0        0        0     1468 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/skew/boron_si_skew.csv
+-rw-r--r--   0        0        0     1118 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/process/skew/phosphorus_si_skew.csv
+-rw-r--r--   0        0        0      191 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/__init__.py
+-rw-r--r--   0        0        0    14848 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/build_model.py
+-rw-r--r--   0        0        0     7449 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/femwell_waveguide_model.py
+-rw-r--r--   0        0        0     1571 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/interpolators.py
+-rw-r--r--   0        0        0     6755 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/meep_FDTD_model.py
+-rw-r--r--   0        0        0     4528 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/meow_eme_model.py
+-rw-r--r--   0        0        0     5613 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/mlp.py
+-rw-r--r--   0        0        0     7358 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/models.py
+-rw-r--r--   0        0        0    13894 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/parameter.py
+-rwxr-xr-x   0        0        0     2225 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/plot_model.py
+-rw-r--r--   0        0        0     6805 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/read.py
+-rw-r--r--   0        0        0     1350 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_mzi.py
+-rw-r--r--   0        0        0     2220 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_mzi_lattice.py
+-rw-r--r--   0        0        0     1405 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_parameters.py
+-rw-r--r--   0        0        0     1357 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/__init__.py
+-rw-r--r--   0        0        0     1573 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/add_gc.py
+-rw-r--r--   0        0        0     3383 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/circuit.py
+-rw-r--r--   0        0        0      891 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/__init__.py
+-rw-r--r--   0        0        0     1295 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/bend_circular.py
+-rw-r--r--   0        0        0     1388 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/bend_euler.py
+-rw-r--r--   0        0        0     2560 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler.py
+-rw-r--r--   0        0        0     1046 2023-05-22 15:57:46.279799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_fdtd.py
+-rw-r--r--   0        0        0     1848 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring.py
+-rw-r--r--   0        0        0     1329 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring_fdtd.py
+-rw-r--r--   0        0        0      589 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring_siepic.py
+-rw-r--r--   0        0        0      913 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/gc.py
+-rw-r--r--   0        0        0     2032 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mmi1x2.py
+-rw-r--r--   0        0        0     1910 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mmi2x2.py
+-rw-r--r--   0        0        0     2618 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mzi.py
+-rw-r--r--   0        0        0     1759 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mzi_siepic.py
+-rw-r--r--   0        0        0      487 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mzi_thermal.py
+-rw-r--r--   0        0        0     2597 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_double.py
+-rw-r--r--   0        0        0     1665 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_double_siepic.py
+-rw-r--r--   0        0        0     1782 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_single.py
+-rw-r--r--   0        0        0     1416 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_single_siepic.py
+-rw-r--r--   0        0        0     1099 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/straight.py
+-rw-r--r--   0        0        0      800 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/get_transmission.py
+-rw-r--r--   0        0        0     2516 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/model_from_gdsfactory.py
+-rw-r--r--   0        0        0     3841 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/model_from_sparameters.py
+-rw-r--r--   0        0        0     2438 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_circuit.py
+-rw-r--r--   0        0        0     1798 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_circuit_montecarlo.py
+-rw-r--r--   0        0        0     2773 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_model.py
+-rw-r--r--   0        0        0     1261 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_circuit.py
+-rw-r--r--   0        0        0       90 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_circuit/test_circuit_transmission.yml
+-rw-r--r--   0        0        0     1109 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components.py
+-rw-r--r--   0        0        0       66 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_circuits_mzi_.yml
+-rw-r--r--   0        0        0       69 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_circuits_ring_double_.yml
+-rw-r--r--   0        0        0       69 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_circuits_ring_single_.yml
+-rw-r--r--   0        0        0       92 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_bend_circular_.yml
+-rw-r--r--   0        0        0       92 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_bend_euler_.yml
+-rw-r--r--   0        0        0      412 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_coupler_.yml
+-rw-r--r--   0        0        0      412 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_coupler_ring_.yml
+-rw-r--r--   0        0        0      114 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_gc1550te_.yml
+-rw-r--r--   0        0        0      256 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_mmi1x2_.yml
+-rw-r--r--   0        0        0      460 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_mmi2x2_.yml
+-rw-r--r--   0        0        0      104 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components/test_elements_straight_.yml
+-rw-r--r--   0        0        0      166 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/simphony/types.py
+-rw-r--r--   0        0        0      471 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/__init__.py
+-rw-r--r--   0        0        0     1376 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/bend_circular.py
+-rw-r--r--   0        0        0     1465 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/bend_euler.py
+-rw-r--r--   0        0        0     2508 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/coupler.py
+-rw-r--r--   0        0        0     1892 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/coupler_ring.py
+-rw-r--r--   0        0        0      736 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/sipann/straight.py
+-rw-r--r--   0        0        0      100 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/thermal/__init__.py
+-rw-r--r--   0        0        0     7789 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/simulation/thermal/heater.py
+-rw-r--r--   0        0        0     1744 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/snap.py
+-rw-r--r--   0        0        0     4245 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/symbols.py
+-rw-r--r--   0        0        0      524 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/__init__.py
+-rw-r--r--   0        0        0     7607 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/klayout_tech.py
+-rw-r--r--   0        0        0     1078 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/layer_map.py
+-rw-r--r--   0        0        0    16139 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/layer_stack.py
+-rw-r--r--   0        0        0    42133 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/layer_views.py
+-rw-r--r--   0        0        0     1984 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/technology/simulation_settings.py
+-rw-r--r--   0        0        0     1635 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/types.py
+-rw-r--r--   0        0        0    10008 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/typings.py
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/__init__.py
+-rw-r--r--   0        0        0     1342 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/async_utils.py
+-rw-r--r--   0        0        0      376 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/color_utils.py
+-rw-r--r--   0        0        0      558 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/file_utils.py
+-rw-r--r--   0        0        0      185 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/function_utils.py
+-rw-r--r--   0        0        0      684 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/xml_utils.py
+-rw-r--r--   0        0        0     1453 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/utils/yaml_utils.py
+-rw-r--r--   0        0        0     4865 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/watch.py
+-rw-r--r--   0        0        0        0 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/widgets/__init__.py
+-rw-r--r--   0        0        0     7969 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/widgets/layout_viewer.py
+-rw-r--r--   0        0        0     7480 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/gdsfactory/write_cells.py
+-rw-r--r--   0        0        0     5687 2023-05-22 15:57:46.283799 gdsfactory-6.97.1/pyproject.toml
+-rw-r--r--   0        0        0    18772 1970-01-01 00:00:00.000000 gdsfactory-6.97.1/PKG-INFO
```

### Comparing `gdsfactory-6.97.0/LICENSE` & `gdsfactory-6.97.1/LICENSE`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/README.md` & `gdsfactory-6.97.1/README.md`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# gdsfactory 6.97.0
+# gdsfactory 6.97.1
 
 [![docs](https://github.com/gdsfactory/gdsfactory/actions/workflows/pages.yml/badge.svg)](https://gdsfactory.github.io/gdsfactory/)
 [![PyPI](https://img.shields.io/pypi/v/gdsfactory)](https://pypi.org/project/gdsfactory/)
 [![Conda Version](https://img.shields.io/conda/vn/conda-forge/gdsfactory.svg)](https://anaconda.org/conda-forge/gdsfactory)
 [![Dockerhub](https://img.shields.io/docker/pulls/joamatab/gdsfactory)](https://hub.docker.com/r/joamatab/gdsfactory)
 [![PyPI Python](https://img.shields.io/pypi/pyversions/gdsfactory.svg)](https://pypi.python.org/pypi/gdsfactory)
 [![issues](https://img.shields.io/github/issues/gdsfactory/gdsfactory)](https://github.com/gdsfactory/gdsfactory/issues)
```

### Comparing `gdsfactory-6.97.0/gdsfactory/__init__.py` & `gdsfactory-6.97.1/gdsfactory/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -148,8 +148,8 @@
     "snap",
     "typings",
     "technology",
     "write_cells",
     "xsection",
     "PATH",
 )
-__version__ = "6.97.0"
+__version__ = "6.97.1"
```

### Comparing `gdsfactory-6.97.0/gdsfactory/add_keepout.py` & `gdsfactory-6.97.1/gdsfactory/add_keepout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_labels.py` & `gdsfactory-6.97.1/gdsfactory/add_labels.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_loopback.py` & `gdsfactory-6.97.1/gdsfactory/add_loopback.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_padding.py` & `gdsfactory-6.97.1/gdsfactory/add_padding.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_pins.py` & `gdsfactory-6.97.1/gdsfactory/add_pins.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_ports.py` & `gdsfactory-6.97.1/gdsfactory/add_ports.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_tapers.py` & `gdsfactory-6.97.1/gdsfactory/add_tapers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_tapers_cross_section.py` & `gdsfactory-6.97.1/gdsfactory/add_tapers_cross_section.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/add_termination.py` & `gdsfactory-6.97.1/gdsfactory/add_termination.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/asserts.py` & `gdsfactory-6.97.1/gdsfactory/asserts.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/circuitviz.py` & `gdsfactory-6.97.1/gdsfactory/circuitviz.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/cli.py` & `gdsfactory-6.97.1/gdsfactory/cli.py`

 * *Files 0% similar despite different names*

```diff
@@ -19,15 +19,15 @@
 from gdsfactory.write_cells import write_cells as write_cells_to_separate_gds
 
 try:
     import rich_click as click
 except ImportError:
     import click
 
-VERSION = "6.97.0"
+VERSION = "6.97.1"
 LAYER_LABEL = LAYER.LABEL
 
 
 def print_version(ctx: Context, param: Option, value: bool) -> None:
     """Prints the version."""
     if not value or ctx.resilient_parsing:
         return
```

### Comparing `gdsfactory-6.97.0/gdsfactory/component.py` & `gdsfactory-6.97.1/gdsfactory/component.py`

 * *Files 1% similar despite different names*

```diff
@@ -1023,5326 +1023,5347 @@
 00003fe0: 6c69 7374 2873 656c 662c 2066 696c 6570  list(self, filep
 00003ff0: 6174 683a 2073 7472 2920 2d3e 204e 6f6e  ath: str) -> Non
 00004000: 653a 0a20 2020 2020 2020 2022 2222 5772  e:.        """Wr
 00004010: 6974 6520 6e65 746c 6973 7420 696e 2059  ite netlist in Y
 00004020: 414d 4c2e 2222 220a 2020 2020 2020 2020  AML.""".        
 00004030: 6e65 746c 6973 7420 3d20 7365 6c66 2e67  netlist = self.g
 00004040: 6574 5f6e 6574 6c69 7374 2829 0a20 2020  et_netlist().   
-00004050: 2020 2020 204f 6d65 6761 436f 6e66 2e73       OmegaConf.s
-00004060: 6176 6528 6e65 746c 6973 742c 2066 696c  ave(netlist, fil
-00004070: 6570 6174 6829 0a0a 2020 2020 6465 6620  epath)..    def 
-00004080: 7772 6974 655f 6e65 746c 6973 745f 646f  write_netlist_do
-00004090: 7428 7365 6c66 2c20 6669 6c65 7061 7468  t(self, filepath
-000040a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000040b0: 3d20 4e6f 6e65 2920 2d3e 204e 6f6e 653a  = None) -> None:
-000040c0: 0a20 2020 2020 2020 2022 2222 5772 6974  .        """Writ
-000040d0: 6520 6e65 746c 6973 7420 6772 6170 6820  e netlist graph 
-000040e0: 696e 2044 4f54 2066 6f72 6d61 742e 2222  in DOT format.""
-000040f0: 220a 2020 2020 2020 2020 6672 6f6d 206e  ".        from n
-00004100: 6574 776f 726b 782e 6472 6177 696e 672e  etworkx.drawing.
-00004110: 6e78 5f61 6772 6170 6820 696d 706f 7274  nx_agraph import
-00004120: 2077 7269 7465 5f64 6f74 0a0a 2020 2020   write_dot..    
-00004130: 2020 2020 6669 6c65 7061 7468 203d 2066      filepath = f
-00004140: 696c 6570 6174 6820 6f72 2066 227b 7365  ilepath or f"{se
-00004150: 6c66 2e6e 616d 657d 2e64 6f74 220a 0a20  lf.name}.dot".. 
-00004160: 2020 2020 2020 2047 203d 2073 656c 662e         G = self.
-00004170: 706c 6f74 5f6e 6574 6c69 7374 2829 0a20  plot_netlist(). 
-00004180: 2020 2020 2020 2077 7269 7465 5f64 6f74         write_dot
-00004190: 2847 2c20 6669 6c65 7061 7468 290a 0a20  (G, filepath).. 
-000041a0: 2020 2064 6566 2067 6574 5f6e 6574 6c69     def get_netli
-000041b0: 7374 2873 656c 662c 202a 2a6b 7761 7267  st(self, **kwarg
-000041c0: 7329 202d 3e20 4469 6374 5b73 7472 2c20  s) -> Dict[str, 
-000041d0: 416e 795d 3a0a 2020 2020 2020 2020 2222  Any]:.        ""
-000041e0: 2246 726f 6d20 436f 6d70 6f6e 656e 7420  "From Component 
-000041f0: 7265 7475 726e 7320 696e 7374 616e 6365  returns instance
-00004200: 732c 2063 6f6e 6e65 6374 696f 6e73 2061  s, connections a
-00004210: 6e64 2070 6c61 6365 6d65 6e74 7320 6469  nd placements di
-00004220: 6374 2e0a 0a20 2020 2020 2020 204b 6579  ct...        Key
-00004230: 776f 7264 2041 7267 733a 0a20 2020 2020  word Args:.     
-00004240: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
-00004250: 3a20 746f 2065 7874 7261 6374 206e 6574  : to extract net
-00004260: 6c69 7374 2e0a 2020 2020 2020 2020 2020  list..          
-00004270: 2020 6675 6c6c 5f73 6574 7469 6e67 733a    full_settings:
-00004280: 2054 7275 6520 7265 7475 726e 7320 616c   True returns al
-00004290: 6c2c 2066 616c 7365 2063 6861 6e67 6564  l, false changed
-000042a0: 2073 6574 7469 6e67 732e 0a20 2020 2020   settings..     
-000042b0: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
-000042c0: 3a20 746f 6c65 7261 6e63 6520 696e 206e  : tolerance in n
-000042d0: 6d20 746f 2063 6f6e 7369 6465 7220 7477  m to consider tw
-000042e0: 6f20 706f 7274 7320 636f 6e6e 6563 7465  o ports connecte
-000042f0: 642e 0a20 2020 2020 2020 2020 2020 2065  d..            e
-00004300: 7863 6c75 6465 5f70 6f72 745f 7479 7065  xclude_port_type
-00004310: 733a 206f 7074 696f 6e61 6c20 6c69 7374  s: optional list
-00004320: 206f 6620 706f 7274 2074 7970 6573 2074   of port types t
-00004330: 6f20 6578 636c 7564 6520 6672 6f6d 206e  o exclude from n
-00004340: 6574 6c69 7374 696e 672e 0a20 2020 2020  etlisting..     
-00004350: 2020 2020 2020 2067 6574 5f69 6e73 7461         get_insta
-00004360: 6e63 655f 6e61 6d65 3a20 6675 6e63 7469  nce_name: functi
-00004370: 6f6e 2074 6f20 6765 7420 696e 7374 616e  on to get instan
-00004380: 6365 206e 616d 652e 0a20 2020 2020 2020  ce name..       
-00004390: 2020 2020 2061 6c6c 6f77 5f6d 756c 7469       allow_multi
-000043a0: 706c 653a 2046 616c 7365 2074 6f20 7261  ple: False to ra
-000043b0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
-000043c0: 6d6f 7265 2074 6861 6e20 7477 6f20 706f  more than two po
-000043d0: 7274 7320 7368 6172 6520 7468 6520 7361  rts share the sa
-000043e0: 6d65 2063 6f6e 6e65 6374 696f 6e2e 0a20  me connection.. 
-000043f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00004400: 6620 5472 7565 2c20 7769 6c6c 2072 6574  f True, will ret
-00004410: 7572 6e20 6b65 793a 205b 7661 6c75 655d  urn key: [value]
-00004420: 2070 6169 7273 2077 6974 6820 5b76 616c   pairs with [val
-00004430: 7565 5d20 6120 6c69 7374 206f 6620 616c  ue] a list of al
-00004440: 6c20 636f 6e6e 6563 7465 6420 696e 7374  l connected inst
-00004450: 616e 6365 732e 0a0a 2020 2020 2020 2020  ances...        
-00004460: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00004470: 2020 2020 204e 6574 6c69 7374 2064 6963       Netlist dic
-00004480: 7420 2869 6e73 7461 6e63 6573 2c20 636f  t (instances, co
-00004490: 6e6e 6563 7469 6f6e 732c 2070 6c61 6365  nnections, place
-000044a0: 6d65 6e74 732c 2070 6f72 7473 290a 2020  ments, ports).  
-000044b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000044c0: 7374 616e 6365 733a 2044 6963 7420 6f66  stances: Dict of
-000044d0: 2069 6e73 7461 6e63 6520 6e61 6d65 2061   instance name a
-000044e0: 6e64 2073 6574 7469 6e67 732e 0a20 2020  nd settings..   
-000044f0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00004500: 6e65 6374 696f 6e73 3a20 4469 6374 206f  nections: Dict o
-00004510: 6620 496e 7374 616e 6365 314e 616d 652c  f Instance1Name,
-00004520: 706f 7274 4e61 6d65 3a20 496e 7374 616e  portName: Instan
-00004530: 6365 324e 616d 652c 706f 7274 4e61 6d65  ce2Name,portName
-00004540: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004550: 2020 706c 6163 656d 656e 7473 3a20 4469    placements: Di
-00004560: 6374 206f 6620 696e 7374 616e 6365 206e  ct of instance n
-00004570: 616d 6573 2061 6e64 2070 6c61 6365 6d65  ames and placeme
-00004580: 6e74 7320 2878 2c20 792c 2072 6f74 6174  nts (x, y, rotat
-00004590: 696f 6e29 2e0a 2020 2020 2020 2020 2020  ion)..          
-000045a0: 2020 2020 2020 706f 7274 733a 2044 6963        ports: Dic
-000045b0: 7420 706f 7274 4e61 6d65 3a20 436f 6d70  t portName: Comp
-000045c0: 6f6e 656e 744e 616d 652c 706f 7274 2e0a  onentName,port..
-000045d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000045e0: 6e61 6d65 3a20 6e61 6d65 206f 6620 636f  name: name of co
-000045f0: 6d70 6f6e 656e 742e 0a20 2020 2020 2020  mponent..       
-00004600: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00004610: 6d20 6764 7366 6163 746f 7279 2e67 6574  m gdsfactory.get
-00004620: 5f6e 6574 6c69 7374 2069 6d70 6f72 7420  _netlist import 
-00004630: 6765 745f 6e65 746c 6973 740a 0a20 2020  get_netlist..   
-00004640: 2020 2020 2072 6574 7572 6e20 6765 745f       return get_
-00004650: 6e65 746c 6973 7428 636f 6d70 6f6e 656e  netlist(componen
-00004660: 743d 7365 6c66 2c20 2a2a 6b77 6172 6773  t=self, **kwargs
-00004670: 290a 0a20 2020 2064 6566 2067 6574 5f6e  )..    def get_n
-00004680: 6574 6c69 7374 5f72 6563 7572 7369 7665  etlist_recursive
-00004690: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
-000046a0: 202d 3e20 4469 6374 5b73 7472 2c20 4469   -> Dict[str, Di
-000046b0: 6374 436f 6e66 6967 5d3a 0a20 2020 2020  ctConfig]:.     
-000046c0: 2020 2022 2222 5265 7475 726e 7320 7265     """Returns re
-000046d0: 6375 7273 6976 6520 6e65 746c 6973 7420  cursive netlist 
-000046e0: 666f 7220 6120 636f 6d70 6f6e 656e 7420  for a component 
-000046f0: 616e 6420 7375 6263 6f6d 706f 6e65 6e74  and subcomponent
-00004700: 732e 0a0a 2020 2020 2020 2020 4b65 7977  s...        Keyw
-00004710: 6f72 6420 4172 6773 3a0a 2020 2020 2020  ord Args:.      
-00004720: 2020 2020 2020 636f 6d70 6f6e 656e 743a        component:
-00004730: 2074 6f20 6578 7472 6163 7420 6e65 746c   to extract netl
-00004740: 6973 742e 0a20 2020 2020 2020 2020 2020  ist..           
-00004750: 2063 6f6d 706f 6e65 6e74 5f73 7566 6669   component_suffi
-00004760: 783a 2073 7566 6669 7820 746f 2061 7070  x: suffix to app
-00004770: 656e 6420 746f 2065 6163 6820 636f 6d70  end to each comp
-00004780: 6f6e 656e 7420 6e61 6d65 2e0a 2020 2020  onent name..    
-00004790: 2020 2020 2020 2020 2020 2020 7573 6566              usef
-000047a0: 756c 2069 6620 746f 2073 6176 6520 616e  ul if to save an
-000047b0: 6420 7265 6c6f 6164 2061 2062 6163 6b2d  d reload a back-
-000047c0: 616e 6e6f 7461 7465 6420 6e65 746c 6973  annotated netlis
-000047d0: 742e 0a20 2020 2020 2020 2020 2020 2067  t..            g
-000047e0: 6574 5f6e 6574 6c69 7374 5f66 756e 633a  et_netlist_func:
-000047f0: 2066 756e 6374 696f 6e20 746f 2065 7874   function to ext
-00004800: 7261 6374 2069 6e64 6976 6964 7561 6c20  ract individual 
-00004810: 6e65 746c 6973 7473 2e0a 2020 2020 2020  netlists..      
-00004820: 2020 2020 2020 6675 6c6c 5f73 6574 7469        full_setti
-00004830: 6e67 733a 2054 7275 6520 7265 7475 726e  ngs: True return
-00004840: 7320 616c 6c2c 2066 616c 7365 2063 6861  s all, false cha
-00004850: 6e67 6564 2073 6574 7469 6e67 732e 0a20  nged settings.. 
-00004860: 2020 2020 2020 2020 2020 2074 6f6c 6572             toler
-00004870: 616e 6365 3a20 746f 6c65 7261 6e63 6520  ance: tolerance 
-00004880: 696e 206e 6d20 746f 2063 6f6e 7369 6465  in nm to conside
-00004890: 7220 7477 6f20 706f 7274 7320 636f 6e6e  r two ports conn
-000048a0: 6563 7465 642e 0a20 2020 2020 2020 2020  ected..         
-000048b0: 2020 2065 7863 6c75 6465 5f70 6f72 745f     exclude_port_
-000048c0: 7479 7065 733a 206f 7074 696f 6e61 6c20  types: optional 
-000048d0: 6c69 7374 206f 6620 706f 7274 2074 7970  list of port typ
-000048e0: 6573 2074 6f20 6578 636c 7564 6520 6672  es to exclude fr
-000048f0: 6f6d 206e 6574 6c69 7374 696e 672e 0a20  om netlisting.. 
-00004900: 2020 2020 2020 2020 2020 2067 6574 5f69             get_i
-00004910: 6e73 7461 6e63 655f 6e61 6d65 3a20 6675  nstance_name: fu
-00004920: 6e63 7469 6f6e 2074 6f20 6765 7420 696e  nction to get in
-00004930: 7374 616e 6365 206e 616d 652e 0a20 2020  stance name..   
-00004940: 2020 2020 2020 2020 2061 6c6c 6f77 5f6d           allow_m
-00004950: 756c 7469 706c 653a 2046 616c 7365 2074  ultiple: False t
-00004960: 6f20 7261 6973 6520 616e 2065 7272 6f72  o raise an error
-00004970: 2069 6620 6d6f 7265 2074 6861 6e20 7477   if more than tw
-00004980: 6f20 706f 7274 7320 7368 6172 6520 7468  o ports share th
-00004990: 6520 7361 6d65 2063 6f6e 6e65 6374 696f  e same connectio
-000049a0: 6e2e 0a20 2020 2020 2020 2020 2020 2020  n..             
-000049b0: 2020 2069 6620 5472 7565 2c20 7769 6c6c     if True, will
-000049c0: 2072 6574 7572 6e20 6b65 793a 205b 7661   return key: [va
-000049d0: 6c75 655d 2070 6169 7273 2077 6974 6820  lue] pairs with 
-000049e0: 5b76 616c 7565 5d20 6120 6c69 7374 206f  [value] a list o
-000049f0: 6620 616c 6c20 636f 6e6e 6563 7465 6420  f all connected 
-00004a00: 696e 7374 616e 6365 732e 0a0a 2020 2020  instances...    
-00004a10: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00004a20: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
-00004a30: 6172 7920 6f66 206e 6574 6c69 7374 732c  ary of netlists,
-00004a40: 206b 6579 6564 2062 7920 7468 6520 6e61   keyed by the na
-00004a50: 6d65 206f 6620 6561 6368 2063 6f6d 706f  me of each compo
-00004a60: 6e65 6e74 2e0a 2020 2020 2020 2020 2222  nent..        ""
-00004a70: 220a 2020 2020 2020 2020 6672 6f6d 2067  ".        from g
-00004a80: 6473 6661 6374 6f72 792e 6765 745f 6e65  dsfactory.get_ne
-00004a90: 746c 6973 7420 696d 706f 7274 2067 6574  tlist import get
-00004aa0: 5f6e 6574 6c69 7374 5f72 6563 7572 7369  _netlist_recursi
-00004ab0: 7665 0a0a 2020 2020 2020 2020 7265 7475  ve..        retu
-00004ac0: 726e 2067 6574 5f6e 6574 6c69 7374 5f72  rn get_netlist_r
-00004ad0: 6563 7572 7369 7665 2863 6f6d 706f 6e65  ecursive(compone
-00004ae0: 6e74 3d73 656c 662c 202a 2a6b 7761 7267  nt=self, **kwarg
-00004af0: 7329 0a0a 2020 2020 6465 6620 6765 745f  s)..    def get_
-00004b00: 6e65 746c 6973 745f 666c 6174 2873 656c  netlist_flat(sel
-00004b10: 662c 202a 2a6b 7761 7267 7329 202d 3e20  f, **kwargs) -> 
-00004b20: 4469 6374 5b73 7472 2c20 4469 6374 436f  Dict[str, DictCo
-00004b30: 6e66 6967 5d3a 0a20 2020 2020 2020 2022  nfig]:.        "
-00004b40: 2222 5265 7475 726e 7320 6120 6e65 746c  ""Returns a netl
-00004b50: 6973 7420 7768 6572 6520 616c 6c20 7375  ist where all su
-00004b60: 6269 6e73 7461 6e63 6573 2061 7265 2065  binstances are e
-00004b70: 7870 6f73 6564 2061 6e64 2069 6e64 6570  xposed and indep
-00004b80: 656e 6465 6e74 6c79 206e 616d 6564 2e0a  endently named..
-00004b90: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
-00004ba0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00004bb0: 2020 2063 6f6d 706f 6e65 6e74 3a20 746f     component: to
-00004bc0: 2065 7874 7261 6374 206e 6574 6c69 7374   extract netlist
-00004bd0: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00004be0: 6d70 6f6e 656e 745f 7375 6666 6978 3a20  mponent_suffix: 
-00004bf0: 7375 6666 6978 2074 6f20 6170 7065 6e64  suffix to append
-00004c00: 2074 6f20 6561 6368 2063 6f6d 706f 6e65   to each compone
-00004c10: 6e74 206e 616d 652e 0a20 2020 2020 2020  nt name..       
-00004c20: 2020 2020 2020 2020 2075 7365 6675 6c20           useful 
-00004c30: 6966 2074 6f20 7361 7665 2061 6e64 2072  if to save and r
-00004c40: 656c 6f61 6420 6120 6261 636b 2d61 6e6e  eload a back-ann
-00004c50: 6f74 6174 6564 206e 6574 6c69 7374 2e0a  otated netlist..
-00004c60: 2020 2020 2020 2020 2020 2020 6765 745f              get_
-00004c70: 6e65 746c 6973 745f 6675 6e63 3a20 6675  netlist_func: fu
-00004c80: 6e63 7469 6f6e 2074 6f20 6578 7472 6163  nction to extrac
-00004c90: 7420 696e 6469 7669 6475 616c 206e 6574  t individual net
-00004ca0: 6c69 7374 732e 0a20 2020 2020 2020 2020  lists..         
-00004cb0: 2020 2066 756c 6c5f 7365 7474 696e 6773     full_settings
-00004cc0: 3a20 5472 7565 2072 6574 7572 6e73 2061  : True returns a
-00004cd0: 6c6c 2c20 6661 6c73 6520 6368 616e 6765  ll, false change
-00004ce0: 6420 7365 7474 696e 6773 2e0a 2020 2020  d settings..    
-00004cf0: 2020 2020 2020 2020 746f 6c65 7261 6e63          toleranc
-00004d00: 653a 2074 6f6c 6572 616e 6365 2069 6e20  e: tolerance in 
-00004d10: 6e6d 2074 6f20 636f 6e73 6964 6572 2074  nm to consider t
-00004d20: 776f 2070 6f72 7473 2063 6f6e 6e65 6374  wo ports connect
-00004d30: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-00004d40: 6578 636c 7564 655f 706f 7274 5f74 7970  exclude_port_typ
-00004d50: 6573 3a20 6f70 7469 6f6e 616c 206c 6973  es: optional lis
-00004d60: 7420 6f66 2070 6f72 7420 7479 7065 7320  t of port types 
-00004d70: 746f 2065 7863 6c75 6465 2066 726f 6d20  to exclude from 
-00004d80: 6e65 746c 6973 7469 6e67 2e0a 2020 2020  netlisting..    
-00004d90: 2020 2020 2020 2020 6765 745f 696e 7374          get_inst
-00004da0: 616e 6365 5f6e 616d 653a 2066 756e 6374  ance_name: funct
-00004db0: 696f 6e20 746f 2067 6574 2069 6e73 7461  ion to get insta
-00004dc0: 6e63 6520 6e61 6d65 2e0a 2020 2020 2020  nce name..      
-00004dd0: 2020 2020 2020 616c 6c6f 775f 6d75 6c74        allow_mult
-00004de0: 6970 6c65 3a20 4661 6c73 6520 746f 2072  iple: False to r
-00004df0: 6169 7365 2061 6e20 6572 726f 7220 6966  aise an error if
-00004e00: 206d 6f72 6520 7468 616e 2074 776f 2070   more than two p
-00004e10: 6f72 7473 2073 6861 7265 2074 6865 2073  orts share the s
-00004e20: 616d 6520 636f 6e6e 6563 7469 6f6e 2e0a  ame connection..
-00004e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e40: 6966 2054 7275 652c 2077 696c 6c20 7265  if True, will re
-00004e50: 7475 726e 206b 6579 3a20 5b76 616c 7565  turn key: [value
-00004e60: 5d20 7061 6972 7320 7769 7468 205b 7661  ] pairs with [va
-00004e70: 6c75 655d 2061 206c 6973 7420 6f66 2061  lue] a list of a
-00004e80: 6c6c 2063 6f6e 6e65 6374 6564 2069 6e73  ll connected ins
-00004e90: 7461 6e63 6573 2e0a 0a20 2020 2020 2020  tances...       
-00004ea0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00004eb0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-00004ec0: 206f 6620 6e65 746c 6973 7473 2c20 6b65   of netlists, ke
-00004ed0: 7965 6420 6279 2074 6865 206e 616d 6520  yed by the name 
-00004ee0: 6f66 2065 6163 6820 636f 6d70 6f6e 656e  of each componen
-00004ef0: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-00004f00: 2020 2020 2020 2066 726f 6d20 6764 7366         from gdsf
-00004f10: 6163 746f 7279 2e67 6574 5f6e 6574 6c69  actory.get_netli
-00004f20: 7374 5f66 6c61 7420 696d 706f 7274 2067  st_flat import g
-00004f30: 6574 5f6e 6574 6c69 7374 5f66 6c61 740a  et_netlist_flat.
-00004f40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004f50: 6765 745f 6e65 746c 6973 745f 666c 6174  get_netlist_flat
-00004f60: 2863 6f6d 706f 6e65 6e74 3d73 656c 662c  (component=self,
-00004f70: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00004f80: 6465 6620 6173 7365 7274 5f70 6f72 7473  def assert_ports
-00004f90: 5f6f 6e5f 6772 6964 2873 656c 662c 206e  _on_grid(self, n
-00004fa0: 6d3a 2069 6e74 203d 2031 2920 2d3e 204e  m: int = 1) -> N
-00004fb0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00004fc0: 4173 7365 7274 7320 7468 6174 2061 6c6c  Asserts that all
-00004fd0: 2070 6f72 7473 2061 7265 206f 6e20 6772   ports are on gr
-00004fe0: 6964 2e22 2222 0a20 2020 2020 2020 2066  id.""".        f
-00004ff0: 6f72 2070 6f72 7420 696e 2073 656c 662e  or port in self.
-00005000: 706f 7274 732e 7661 6c75 6573 2829 3a0a  ports.values():.
-00005010: 2020 2020 2020 2020 2020 2020 706f 7274              port
-00005020: 2e61 7373 6572 745f 6f6e 5f67 7269 6428  .assert_on_grid(
-00005030: 6e6d 3d6e 6d29 0a0a 2020 2020 6465 6620  nm=nm)..    def 
-00005040: 6765 745f 706f 7274 7328 7365 6c66 2c20  get_ports(self, 
-00005050: 6465 7074 683d 4e6f 6e65 293a 0a20 2020  depth=None):.   
-00005060: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
-00005070: 636f 7069 6573 206f 6620 616c 6c20 7468  copies of all th
-00005080: 6520 706f 7274 7320 6f66 2074 6865 2043  e ports of the C
-00005090: 6f6d 706f 6e65 6e74 2c20 726f 7461 7465  omponent, rotate
-000050a0: 6420 616e 6420 5c0a 2020 2020 2020 2020  d and \.        
-000050b0: 2020 2020 2020 2020 7472 616e 736c 6174          translat
-000050c0: 6564 2073 6f20 7468 6174 2074 6865 7927  ed so that they'
-000050d0: 7265 2069 6e20 7468 6569 7220 746f 702d  re in their top-
-000050e0: 6c65 7665 6c20 706f 7369 7469 6f6e 2e0a  level position..
-000050f0: 0a20 2020 2020 2020 2054 6865 2050 6f72  .        The Por
-00005100: 7473 2072 6574 7572 6e65 6420 6172 6520  ts returned are 
-00005110: 636f 7069 6573 206f 6620 7468 6520 6f72  copies of the or
-00005120: 6967 696e 616c 732c 2062 7574 2065 6163  iginals, but eac
-00005130: 6820 636f 7079 2068 6173 2074 6865 2073  h copy has the s
-00005140: 616d 650a 2020 2020 2020 2020 6060 7569  ame.        ``ui
-00005150: 6460 6020 6173 2074 6865 206f 7269 6769  d`` as the origi
-00005160: 6e61 6c20 736f 2074 6861 7420 7468 6579  nal so that they
-00005170: 2063 616e 2062 6520 7472 6163 6564 2062   can be traced b
-00005180: 6163 6b20 746f 2074 6865 206f 7269 6769  ack to the origi
-00005190: 6e61 6c20 6966 206e 6565 6465 642e 0a0a  nal if needed...
-000051a0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-000051b0: 2020 2020 2020 2020 2020 6465 7074 6820            depth 
-000051c0: 3a20 696e 7420 6f72 204e 6f6e 650a 2020  : int or None.  
-000051d0: 2020 2020 2020 2020 2020 2020 2020 4966                If
-000051e0: 206e 6f74 204e 6f6e 652c 2064 6566 696e   not None, defin
-000051f0: 6573 2066 726f 6d20 686f 7720 6d61 6e79  es from how many
-00005200: 2072 6566 6572 656e 6365 206c 6576 656c   reference level
-00005210: 7320 746f 0a20 2020 2020 2020 2020 2020  s to.           
-00005220: 2020 2020 2072 6574 7269 6576 6520 506f       retrieve Po
-00005230: 7274 7320 6672 6f6d 2e0a 0a20 2020 2020  rts from...     
-00005240: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-00005250: 2020 2020 2020 2020 706f 7274 5f6c 6973          port_lis
-00005260: 7420 3a20 6c69 7374 206f 6620 506f 7274  t : list of Port
-00005270: 204c 6973 7420 6f66 2061 6c6c 2050 6f72   List of all Por
-00005280: 7473 2069 6e20 7468 6520 436f 6d70 6f6e  ts in the Compon
-00005290: 656e 742e 0a20 2020 2020 2020 2022 2222  ent..        """
-000052a0: 0a20 2020 2020 2020 2070 6f72 745f 6c69  .        port_li
-000052b0: 7374 203d 205b 702e 5f63 6f70 7928 2920  st = [p._copy() 
-000052c0: 666f 7220 7020 696e 2073 656c 662e 706f  for p in self.po
-000052d0: 7274 732e 7661 6c75 6573 2829 5d0a 0a20  rts.values()].. 
-000052e0: 2020 2020 2020 2069 6620 6465 7074 6820         if depth 
-000052f0: 6973 204e 6f6e 6520 6f72 2064 6570 7468  is None or depth
-00005300: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00005310: 2020 666f 7220 7220 696e 2073 656c 662e    for r in self.
-00005320: 7265 6665 7265 6e63 6573 3a0a 2020 2020  references:.    
-00005330: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00005340: 6465 7074 6820 3d20 4e6f 6e65 2069 6620  depth = None if 
-00005350: 6465 7074 6820 6973 204e 6f6e 6520 656c  depth is None el
-00005360: 7365 2064 6570 7468 202d 2031 0a20 2020  se depth - 1.   
-00005370: 2020 2020 2020 2020 2020 2020 2072 6566               ref
-00005380: 5f70 6f72 7473 203d 2072 2e70 6172 656e  _ports = r.paren
-00005390: 742e 6765 745f 706f 7274 7328 6465 7074  t.get_ports(dept
-000053a0: 683d 6e65 775f 6465 7074 6829 0a0a 2020  h=new_depth)..  
-000053b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000053c0: 5472 616e 7366 6f72 6d20 706f 7274 7320  Transform ports 
-000053d0: 7468 6174 2063 616d 6520 6672 6f6d 2061  that came from a
-000053e0: 2072 6566 6572 656e 6365 0a20 2020 2020   reference.     
-000053f0: 2020 2020 2020 2020 2020 2072 6566 5f70             ref_p
-00005400: 6f72 7473 5f74 7261 6e73 666f 726d 6564  orts_transformed
-00005410: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00005420: 2020 2020 2020 666f 7220 7270 2069 6e20        for rp in 
-00005430: 7265 665f 706f 7274 733a 0a20 2020 2020  ref_ports:.     
-00005440: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00005450: 6577 5f70 6f72 7420 3d20 7270 2e5f 636f  ew_port = rp._co
-00005460: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
-00005470: 2020 2020 2020 2020 206e 6577 5f63 656e           new_cen
-00005480: 7465 722c 206e 6577 5f6f 7269 656e 7461  ter, new_orienta
-00005490: 7469 6f6e 203d 2072 2e5f 7472 616e 7366  tion = r._transf
-000054a0: 6f72 6d5f 706f 7274 280a 2020 2020 2020  orm_port(.      
-000054b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054c0: 2020 7270 2e63 656e 7465 722c 0a20 2020    rp.center,.   
+00004050: 2020 2020 206e 6574 6c69 7374 203d 2063       netlist = c
+00004060: 6c65 616e 5f64 6963 7428 6e65 746c 6973  lean_dict(netlis
+00004070: 7429 0a20 2020 2020 2020 204f 6d65 6761  t).        Omega
+00004080: 436f 6e66 2e73 6176 6528 6e65 746c 6973  Conf.save(netlis
+00004090: 742c 2066 696c 6570 6174 6829 0a0a 2020  t, filepath)..  
+000040a0: 2020 6465 6620 7772 6974 655f 6e65 746c    def write_netl
+000040b0: 6973 745f 646f 7428 7365 6c66 2c20 6669  ist_dot(self, fi
+000040c0: 6c65 7061 7468 3a20 4f70 7469 6f6e 616c  lepath: Optional
+000040d0: 5b73 7472 5d20 3d20 4e6f 6e65 2920 2d3e  [str] = None) ->
+000040e0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+000040f0: 2222 5772 6974 6520 6e65 746c 6973 7420  ""Write netlist 
+00004100: 6772 6170 6820 696e 2044 4f54 2066 6f72  graph in DOT for
+00004110: 6d61 742e 2222 220a 2020 2020 2020 2020  mat.""".        
+00004120: 6672 6f6d 206e 6574 776f 726b 782e 6472  from networkx.dr
+00004130: 6177 696e 672e 6e78 5f61 6772 6170 6820  awing.nx_agraph 
+00004140: 696d 706f 7274 2077 7269 7465 5f64 6f74  import write_dot
+00004150: 0a0a 2020 2020 2020 2020 6669 6c65 7061  ..        filepa
+00004160: 7468 203d 2066 696c 6570 6174 6820 6f72  th = filepath or
+00004170: 2066 227b 7365 6c66 2e6e 616d 657d 2e64   f"{self.name}.d
+00004180: 6f74 220a 0a20 2020 2020 2020 2047 203d  ot"..        G =
+00004190: 2073 656c 662e 706c 6f74 5f6e 6574 6c69   self.plot_netli
+000041a0: 7374 2829 0a20 2020 2020 2020 2077 7269  st().        wri
+000041b0: 7465 5f64 6f74 2847 2c20 6669 6c65 7061  te_dot(G, filepa
+000041c0: 7468 290a 0a20 2020 2064 6566 2067 6574  th)..    def get
+000041d0: 5f6e 6574 6c69 7374 2873 656c 662c 202a  _netlist(self, *
+000041e0: 2a6b 7761 7267 7329 202d 3e20 4469 6374  *kwargs) -> Dict
+000041f0: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
+00004200: 2020 2020 2222 2246 726f 6d20 436f 6d70      """From Comp
+00004210: 6f6e 656e 7420 7265 7475 726e 7320 696e  onent returns in
+00004220: 7374 616e 6365 732c 2063 6f6e 6e65 6374  stances, connect
+00004230: 696f 6e73 2061 6e64 2070 6c61 6365 6d65  ions and placeme
+00004240: 6e74 7320 6469 6374 2e0a 0a20 2020 2020  nts dict...     
+00004250: 2020 204b 6579 776f 7264 2041 7267 733a     Keyword Args:
+00004260: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+00004270: 706f 6e65 6e74 3a20 746f 2065 7874 7261  ponent: to extra
+00004280: 6374 206e 6574 6c69 7374 2e0a 2020 2020  ct netlist..    
+00004290: 2020 2020 2020 2020 6675 6c6c 5f73 6574          full_set
+000042a0: 7469 6e67 733a 2054 7275 6520 7265 7475  tings: True retu
+000042b0: 726e 7320 616c 6c2c 2066 616c 7365 2063  rns all, false c
+000042c0: 6861 6e67 6564 2073 6574 7469 6e67 732e  hanged settings.
+000042d0: 0a20 2020 2020 2020 2020 2020 2074 6f6c  .            tol
+000042e0: 6572 616e 6365 3a20 746f 6c65 7261 6e63  erance: toleranc
+000042f0: 6520 696e 206e 6d20 746f 2063 6f6e 7369  e in nm to consi
+00004300: 6465 7220 7477 6f20 706f 7274 7320 636f  der two ports co
+00004310: 6e6e 6563 7465 642e 0a20 2020 2020 2020  nnected..       
+00004320: 2020 2020 2065 7863 6c75 6465 5f70 6f72       exclude_por
+00004330: 745f 7479 7065 733a 206f 7074 696f 6e61  t_types: optiona
+00004340: 6c20 6c69 7374 206f 6620 706f 7274 2074  l list of port t
+00004350: 7970 6573 2074 6f20 6578 636c 7564 6520  ypes to exclude 
+00004360: 6672 6f6d 206e 6574 6c69 7374 696e 672e  from netlisting.
+00004370: 0a20 2020 2020 2020 2020 2020 2067 6574  .            get
+00004380: 5f69 6e73 7461 6e63 655f 6e61 6d65 3a20  _instance_name: 
+00004390: 6675 6e63 7469 6f6e 2074 6f20 6765 7420  function to get 
+000043a0: 696e 7374 616e 6365 206e 616d 652e 0a20  instance name.. 
+000043b0: 2020 2020 2020 2020 2020 2061 6c6c 6f77             allow
+000043c0: 5f6d 756c 7469 706c 653a 2046 616c 7365  _multiple: False
+000043d0: 2074 6f20 7261 6973 6520 616e 2065 7272   to raise an err
+000043e0: 6f72 2069 6620 6d6f 7265 2074 6861 6e20  or if more than 
+000043f0: 7477 6f20 706f 7274 7320 7368 6172 6520  two ports share 
+00004400: 7468 6520 7361 6d65 2063 6f6e 6e65 6374  the same connect
+00004410: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00004420: 2020 2020 2069 6620 5472 7565 2c20 7769       if True, wi
+00004430: 6c6c 2072 6574 7572 6e20 6b65 793a 205b  ll return key: [
+00004440: 7661 6c75 655d 2070 6169 7273 2077 6974  value] pairs wit
+00004450: 6820 5b76 616c 7565 5d20 6120 6c69 7374  h [value] a list
+00004460: 206f 6620 616c 6c20 636f 6e6e 6563 7465   of all connecte
+00004470: 6420 696e 7374 616e 6365 732e 0a0a 2020  d instances...  
+00004480: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+00004490: 2020 2020 2020 2020 2020 204e 6574 6c69             Netli
+000044a0: 7374 2064 6963 7420 2869 6e73 7461 6e63  st dict (instanc
+000044b0: 6573 2c20 636f 6e6e 6563 7469 6f6e 732c  es, connections,
+000044c0: 2070 6c61 6365 6d65 6e74 732c 2070 6f72   placements, por
+000044d0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+000044e0: 2020 2020 696e 7374 616e 6365 733a 2044      instances: D
+000044f0: 6963 7420 6f66 2069 6e73 7461 6e63 6520  ict of instance 
+00004500: 6e61 6d65 2061 6e64 2073 6574 7469 6e67  name and setting
+00004510: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00004520: 2020 2063 6f6e 6e65 6374 696f 6e73 3a20     connections: 
+00004530: 4469 6374 206f 6620 496e 7374 616e 6365  Dict of Instance
+00004540: 314e 616d 652c 706f 7274 4e61 6d65 3a20  1Name,portName: 
+00004550: 496e 7374 616e 6365 324e 616d 652c 706f  Instance2Name,po
+00004560: 7274 4e61 6d65 2e0a 2020 2020 2020 2020  rtName..        
+00004570: 2020 2020 2020 2020 706c 6163 656d 656e          placemen
+00004580: 7473 3a20 4469 6374 206f 6620 696e 7374  ts: Dict of inst
+00004590: 616e 6365 206e 616d 6573 2061 6e64 2070  ance names and p
+000045a0: 6c61 6365 6d65 6e74 7320 2878 2c20 792c  lacements (x, y,
+000045b0: 2072 6f74 6174 696f 6e29 2e0a 2020 2020   rotation)..    
+000045c0: 2020 2020 2020 2020 2020 2020 706f 7274              port
+000045d0: 733a 2044 6963 7420 706f 7274 4e61 6d65  s: Dict portName
+000045e0: 3a20 436f 6d70 6f6e 656e 744e 616d 652c  : ComponentName,
+000045f0: 706f 7274 2e0a 2020 2020 2020 2020 2020  port..          
+00004600: 2020 2020 2020 6e61 6d65 3a20 6e61 6d65        name: name
+00004610: 206f 6620 636f 6d70 6f6e 656e 742e 0a20   of component.. 
+00004620: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00004630: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
+00004640: 7279 2e67 6574 5f6e 6574 6c69 7374 2069  ry.get_netlist i
+00004650: 6d70 6f72 7420 6765 745f 6e65 746c 6973  mport get_netlis
+00004660: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+00004670: 6e20 6765 745f 6e65 746c 6973 7428 636f  n get_netlist(co
+00004680: 6d70 6f6e 656e 743d 7365 6c66 2c20 2a2a  mponent=self, **
+00004690: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+000046a0: 2067 6574 5f6e 6574 6c69 7374 5f72 6563   get_netlist_rec
+000046b0: 7572 7369 7665 2873 656c 662c 202a 2a6b  ursive(self, **k
+000046c0: 7761 7267 7329 202d 3e20 4469 6374 5b73  wargs) -> Dict[s
+000046d0: 7472 2c20 4469 6374 436f 6e66 6967 5d3a  tr, DictConfig]:
+000046e0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000046f0: 726e 7320 7265 6375 7273 6976 6520 6e65  rns recursive ne
+00004700: 746c 6973 7420 666f 7220 6120 636f 6d70  tlist for a comp
+00004710: 6f6e 656e 7420 616e 6420 7375 6263 6f6d  onent and subcom
+00004720: 706f 6e65 6e74 732e 0a0a 2020 2020 2020  ponents...      
+00004730: 2020 4b65 7977 6f72 6420 4172 6773 3a0a    Keyword Args:.
+00004740: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00004750: 6f6e 656e 743a 2074 6f20 6578 7472 6163  onent: to extrac
+00004760: 7420 6e65 746c 6973 742e 0a20 2020 2020  t netlist..     
+00004770: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00004780: 5f73 7566 6669 783a 2073 7566 6669 7820  _suffix: suffix 
+00004790: 746f 2061 7070 656e 6420 746f 2065 6163  to append to eac
+000047a0: 6820 636f 6d70 6f6e 656e 7420 6e61 6d65  h component name
+000047b0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000047c0: 2020 7573 6566 756c 2069 6620 746f 2073    useful if to s
+000047d0: 6176 6520 616e 6420 7265 6c6f 6164 2061  ave and reload a
+000047e0: 2062 6163 6b2d 616e 6e6f 7461 7465 6420   back-annotated 
+000047f0: 6e65 746c 6973 742e 0a20 2020 2020 2020  netlist..       
+00004800: 2020 2020 2067 6574 5f6e 6574 6c69 7374       get_netlist
+00004810: 5f66 756e 633a 2066 756e 6374 696f 6e20  _func: function 
+00004820: 746f 2065 7874 7261 6374 2069 6e64 6976  to extract indiv
+00004830: 6964 7561 6c20 6e65 746c 6973 7473 2e0a  idual netlists..
+00004840: 2020 2020 2020 2020 2020 2020 6675 6c6c              full
+00004850: 5f73 6574 7469 6e67 733a 2054 7275 6520  _settings: True 
+00004860: 7265 7475 726e 7320 616c 6c2c 2066 616c  returns all, fal
+00004870: 7365 2063 6861 6e67 6564 2073 6574 7469  se changed setti
+00004880: 6e67 732e 0a20 2020 2020 2020 2020 2020  ngs..           
+00004890: 2074 6f6c 6572 616e 6365 3a20 746f 6c65   tolerance: tole
+000048a0: 7261 6e63 6520 696e 206e 6d20 746f 2063  rance in nm to c
+000048b0: 6f6e 7369 6465 7220 7477 6f20 706f 7274  onsider two port
+000048c0: 7320 636f 6e6e 6563 7465 642e 0a20 2020  s connected..   
+000048d0: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
+000048e0: 5f70 6f72 745f 7479 7065 733a 206f 7074  _port_types: opt
+000048f0: 696f 6e61 6c20 6c69 7374 206f 6620 706f  ional list of po
+00004900: 7274 2074 7970 6573 2074 6f20 6578 636c  rt types to excl
+00004910: 7564 6520 6672 6f6d 206e 6574 6c69 7374  ude from netlist
+00004920: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+00004930: 2067 6574 5f69 6e73 7461 6e63 655f 6e61   get_instance_na
+00004940: 6d65 3a20 6675 6e63 7469 6f6e 2074 6f20  me: function to 
+00004950: 6765 7420 696e 7374 616e 6365 206e 616d  get instance nam
+00004960: 652e 0a20 2020 2020 2020 2020 2020 2061  e..            a
+00004970: 6c6c 6f77 5f6d 756c 7469 706c 653a 2046  llow_multiple: F
+00004980: 616c 7365 2074 6f20 7261 6973 6520 616e  alse to raise an
+00004990: 2065 7272 6f72 2069 6620 6d6f 7265 2074   error if more t
+000049a0: 6861 6e20 7477 6f20 706f 7274 7320 7368  han two ports sh
+000049b0: 6172 6520 7468 6520 7361 6d65 2063 6f6e  are the same con
+000049c0: 6e65 6374 696f 6e2e 0a20 2020 2020 2020  nection..       
+000049d0: 2020 2020 2020 2020 2069 6620 5472 7565           if True
+000049e0: 2c20 7769 6c6c 2072 6574 7572 6e20 6b65  , will return ke
+000049f0: 793a 205b 7661 6c75 655d 2070 6169 7273  y: [value] pairs
+00004a00: 2077 6974 6820 5b76 616c 7565 5d20 6120   with [value] a 
+00004a10: 6c69 7374 206f 6620 616c 6c20 636f 6e6e  list of all conn
+00004a20: 6563 7465 6420 696e 7374 616e 6365 732e  ected instances.
+00004a30: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00004a40: 733a 0a20 2020 2020 2020 2020 2020 2044  s:.            D
+00004a50: 6963 7469 6f6e 6172 7920 6f66 206e 6574  ictionary of net
+00004a60: 6c69 7374 732c 206b 6579 6564 2062 7920  lists, keyed by 
+00004a70: 7468 6520 6e61 6d65 206f 6620 6561 6368  the name of each
+00004a80: 2063 6f6d 706f 6e65 6e74 2e0a 2020 2020   component..    
+00004a90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00004aa0: 6672 6f6d 2067 6473 6661 6374 6f72 792e  from gdsfactory.
+00004ab0: 6765 745f 6e65 746c 6973 7420 696d 706f  get_netlist impo
+00004ac0: 7274 2067 6574 5f6e 6574 6c69 7374 5f72  rt get_netlist_r
+00004ad0: 6563 7572 7369 7665 0a0a 2020 2020 2020  ecursive..      
+00004ae0: 2020 7265 7475 726e 2067 6574 5f6e 6574    return get_net
+00004af0: 6c69 7374 5f72 6563 7572 7369 7665 2863  list_recursive(c
+00004b00: 6f6d 706f 6e65 6e74 3d73 656c 662c 202a  omponent=self, *
+00004b10: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+00004b20: 6620 6765 745f 6e65 746c 6973 745f 666c  f get_netlist_fl
+00004b30: 6174 2873 656c 662c 202a 2a6b 7761 7267  at(self, **kwarg
+00004b40: 7329 202d 3e20 4469 6374 5b73 7472 2c20  s) -> Dict[str, 
+00004b50: 4469 6374 436f 6e66 6967 5d3a 0a20 2020  DictConfig]:.   
+00004b60: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+00004b70: 6120 6e65 746c 6973 7420 7768 6572 6520  a netlist where 
+00004b80: 616c 6c20 7375 6269 6e73 7461 6e63 6573  all subinstances
+00004b90: 2061 7265 2065 7870 6f73 6564 2061 6e64   are exposed and
+00004ba0: 2069 6e64 6570 656e 6465 6e74 6c79 206e   independently n
+00004bb0: 616d 6564 2e0a 0a20 2020 2020 2020 204b  amed...        K
+00004bc0: 6579 776f 7264 2041 7267 733a 0a20 2020  eyword Args:.   
+00004bd0: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+00004be0: 6e74 3a20 746f 2065 7874 7261 6374 206e  nt: to extract n
+00004bf0: 6574 6c69 7374 2e0a 2020 2020 2020 2020  etlist..        
+00004c00: 2020 2020 636f 6d70 6f6e 656e 745f 7375      component_su
+00004c10: 6666 6978 3a20 7375 6666 6978 2074 6f20  ffix: suffix to 
+00004c20: 6170 7065 6e64 2074 6f20 6561 6368 2063  append to each c
+00004c30: 6f6d 706f 6e65 6e74 206e 616d 652e 0a20  omponent name.. 
+00004c40: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00004c50: 7365 6675 6c20 6966 2074 6f20 7361 7665  seful if to save
+00004c60: 2061 6e64 2072 656c 6f61 6420 6120 6261   and reload a ba
+00004c70: 636b 2d61 6e6e 6f74 6174 6564 206e 6574  ck-annotated net
+00004c80: 6c69 7374 2e0a 2020 2020 2020 2020 2020  list..          
+00004c90: 2020 6765 745f 6e65 746c 6973 745f 6675    get_netlist_fu
+00004ca0: 6e63 3a20 6675 6e63 7469 6f6e 2074 6f20  nc: function to 
+00004cb0: 6578 7472 6163 7420 696e 6469 7669 6475  extract individu
+00004cc0: 616c 206e 6574 6c69 7374 732e 0a20 2020  al netlists..   
+00004cd0: 2020 2020 2020 2020 2066 756c 6c5f 7365           full_se
+00004ce0: 7474 696e 6773 3a20 5472 7565 2072 6574  ttings: True ret
+00004cf0: 7572 6e73 2061 6c6c 2c20 6661 6c73 6520  urns all, false 
+00004d00: 6368 616e 6765 6420 7365 7474 696e 6773  changed settings
+00004d10: 2e0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00004d20: 6c65 7261 6e63 653a 2074 6f6c 6572 616e  lerance: toleran
+00004d30: 6365 2069 6e20 6e6d 2074 6f20 636f 6e73  ce in nm to cons
+00004d40: 6964 6572 2074 776f 2070 6f72 7473 2063  ider two ports c
+00004d50: 6f6e 6e65 6374 6564 2e0a 2020 2020 2020  onnected..      
+00004d60: 2020 2020 2020 6578 636c 7564 655f 706f        exclude_po
+00004d70: 7274 5f74 7970 6573 3a20 6f70 7469 6f6e  rt_types: option
+00004d80: 616c 206c 6973 7420 6f66 2070 6f72 7420  al list of port 
+00004d90: 7479 7065 7320 746f 2065 7863 6c75 6465  types to exclude
+00004da0: 2066 726f 6d20 6e65 746c 6973 7469 6e67   from netlisting
+00004db0: 2e0a 2020 2020 2020 2020 2020 2020 6765  ..            ge
+00004dc0: 745f 696e 7374 616e 6365 5f6e 616d 653a  t_instance_name:
+00004dd0: 2066 756e 6374 696f 6e20 746f 2067 6574   function to get
+00004de0: 2069 6e73 7461 6e63 6520 6e61 6d65 2e0a   instance name..
+00004df0: 2020 2020 2020 2020 2020 2020 616c 6c6f              allo
+00004e00: 775f 6d75 6c74 6970 6c65 3a20 4661 6c73  w_multiple: Fals
+00004e10: 6520 746f 2072 6169 7365 2061 6e20 6572  e to raise an er
+00004e20: 726f 7220 6966 206d 6f72 6520 7468 616e  ror if more than
+00004e30: 2074 776f 2070 6f72 7473 2073 6861 7265   two ports share
+00004e40: 2074 6865 2073 616d 6520 636f 6e6e 6563   the same connec
+00004e50: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+00004e60: 2020 2020 2020 6966 2054 7275 652c 2077        if True, w
+00004e70: 696c 6c20 7265 7475 726e 206b 6579 3a20  ill return key: 
+00004e80: 5b76 616c 7565 5d20 7061 6972 7320 7769  [value] pairs wi
+00004e90: 7468 205b 7661 6c75 655d 2061 206c 6973  th [value] a lis
+00004ea0: 7420 6f66 2061 6c6c 2063 6f6e 6e65 6374  t of all connect
+00004eb0: 6564 2069 6e73 7461 6e63 6573 2e0a 0a20  ed instances... 
+00004ec0: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00004ed0: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+00004ee0: 696f 6e61 7279 206f 6620 6e65 746c 6973  ionary of netlis
+00004ef0: 7473 2c20 6b65 7965 6420 6279 2074 6865  ts, keyed by the
+00004f00: 206e 616d 6520 6f66 2065 6163 6820 636f   name of each co
+00004f10: 6d70 6f6e 656e 742e 0a20 2020 2020 2020  mponent..       
+00004f20: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00004f30: 6d20 6764 7366 6163 746f 7279 2e67 6574  m gdsfactory.get
+00004f40: 5f6e 6574 6c69 7374 5f66 6c61 7420 696d  _netlist_flat im
+00004f50: 706f 7274 2067 6574 5f6e 6574 6c69 7374  port get_netlist
+00004f60: 5f66 6c61 740a 0a20 2020 2020 2020 2072  _flat..        r
+00004f70: 6574 7572 6e20 6765 745f 6e65 746c 6973  eturn get_netlis
+00004f80: 745f 666c 6174 2863 6f6d 706f 6e65 6e74  t_flat(component
+00004f90: 3d73 656c 662c 202a 2a6b 7761 7267 7329  =self, **kwargs)
+00004fa0: 0a0a 2020 2020 6465 6620 6173 7365 7274  ..    def assert
+00004fb0: 5f70 6f72 7473 5f6f 6e5f 6772 6964 2873  _ports_on_grid(s
+00004fc0: 656c 662c 206e 6d3a 2069 6e74 203d 2031  elf, nm: int = 1
+00004fd0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00004fe0: 2020 2022 2222 4173 7365 7274 7320 7468     """Asserts th
+00004ff0: 6174 2061 6c6c 2070 6f72 7473 2061 7265  at all ports are
+00005000: 206f 6e20 6772 6964 2e22 2222 0a20 2020   on grid.""".   
+00005010: 2020 2020 2066 6f72 2070 6f72 7420 696e       for port in
+00005020: 2073 656c 662e 706f 7274 732e 7661 6c75   self.ports.valu
+00005030: 6573 2829 3a0a 2020 2020 2020 2020 2020  es():.          
+00005040: 2020 706f 7274 2e61 7373 6572 745f 6f6e    port.assert_on
+00005050: 5f67 7269 6428 6e6d 3d6e 6d29 0a0a 2020  _grid(nm=nm)..  
+00005060: 2020 6465 6620 6765 745f 706f 7274 7328    def get_ports(
+00005070: 7365 6c66 2c20 6465 7074 683d 4e6f 6e65  self, depth=None
+00005080: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00005090: 7475 726e 7320 636f 7069 6573 206f 6620  turns copies of 
+000050a0: 616c 6c20 7468 6520 706f 7274 7320 6f66  all the ports of
+000050b0: 2074 6865 2043 6f6d 706f 6e65 6e74 2c20   the Component, 
+000050c0: 726f 7461 7465 6420 616e 6420 5c0a 2020  rotated and \.  
+000050d0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+000050e0: 616e 736c 6174 6564 2073 6f20 7468 6174  anslated so that
+000050f0: 2074 6865 7927 7265 2069 6e20 7468 6569   they're in thei
+00005100: 7220 746f 702d 6c65 7665 6c20 706f 7369  r top-level posi
+00005110: 7469 6f6e 2e0a 0a20 2020 2020 2020 2054  tion...        T
+00005120: 6865 2050 6f72 7473 2072 6574 7572 6e65  he Ports returne
+00005130: 6420 6172 6520 636f 7069 6573 206f 6620  d are copies of 
+00005140: 7468 6520 6f72 6967 696e 616c 732c 2062  the originals, b
+00005150: 7574 2065 6163 6820 636f 7079 2068 6173  ut each copy has
+00005160: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
+00005170: 2020 6060 7569 6460 6020 6173 2074 6865    ``uid`` as the
+00005180: 206f 7269 6769 6e61 6c20 736f 2074 6861   original so tha
+00005190: 7420 7468 6579 2063 616e 2062 6520 7472  t they can be tr
+000051a0: 6163 6564 2062 6163 6b20 746f 2074 6865  aced back to the
+000051b0: 206f 7269 6769 6e61 6c20 6966 206e 6565   original if nee
+000051c0: 6465 642e 0a0a 2020 2020 2020 2020 4172  ded...        Ar
+000051d0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000051e0: 6465 7074 6820 3a20 696e 7420 6f72 204e  depth : int or N
+000051f0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00005200: 2020 2020 4966 206e 6f74 204e 6f6e 652c      If not None,
+00005210: 2064 6566 696e 6573 2066 726f 6d20 686f   defines from ho
+00005220: 7720 6d61 6e79 2072 6566 6572 656e 6365  w many reference
+00005230: 206c 6576 656c 7320 746f 0a20 2020 2020   levels to.     
+00005240: 2020 2020 2020 2020 2020 2072 6574 7269             retri
+00005250: 6576 6520 506f 7274 7320 6672 6f6d 2e0a  eve Ports from..
+00005260: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00005270: 3a0a 2020 2020 2020 2020 2020 2020 706f  :.            po
+00005280: 7274 5f6c 6973 7420 3a20 6c69 7374 206f  rt_list : list o
+00005290: 6620 506f 7274 204c 6973 7420 6f66 2061  f Port List of a
+000052a0: 6c6c 2050 6f72 7473 2069 6e20 7468 6520  ll Ports in the 
+000052b0: 436f 6d70 6f6e 656e 742e 0a20 2020 2020  Component..     
+000052c0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
+000052d0: 6f72 745f 6c69 7374 203d 205b 702e 5f63  ort_list = [p._c
+000052e0: 6f70 7928 2920 666f 7220 7020 696e 2073  opy() for p in s
+000052f0: 656c 662e 706f 7274 732e 7661 6c75 6573  elf.ports.values
+00005300: 2829 5d0a 0a20 2020 2020 2020 2069 6620  ()]..        if 
+00005310: 6465 7074 6820 6973 204e 6f6e 6520 6f72  depth is None or
+00005320: 2064 6570 7468 203e 2030 3a0a 2020 2020   depth > 0:.    
+00005330: 2020 2020 2020 2020 666f 7220 7220 696e          for r in
+00005340: 2073 656c 662e 7265 6665 7265 6e63 6573   self.references
+00005350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00005360: 2020 6e65 775f 6465 7074 6820 3d20 4e6f    new_depth = No
+00005370: 6e65 2069 6620 6465 7074 6820 6973 204e  ne if depth is N
+00005380: 6f6e 6520 656c 7365 2064 6570 7468 202d  one else depth -
+00005390: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+000053a0: 2020 2072 6566 5f70 6f72 7473 203d 2072     ref_ports = r
+000053b0: 2e70 6172 656e 742e 6765 745f 706f 7274  .parent.get_port
+000053c0: 7328 6465 7074 683d 6e65 775f 6465 7074  s(depth=new_dept
+000053d0: 6829 0a0a 2020 2020 2020 2020 2020 2020  h)..            
+000053e0: 2020 2020 2320 5472 616e 7366 6f72 6d20      # Transform 
+000053f0: 706f 7274 7320 7468 6174 2063 616d 6520  ports that came 
+00005400: 6672 6f6d 2061 2072 6566 6572 656e 6365  from a reference
+00005410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005420: 2072 6566 5f70 6f72 7473 5f74 7261 6e73   ref_ports_trans
+00005430: 666f 726d 6564 203d 205b 5d0a 2020 2020  formed = [].    
+00005440: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00005450: 7270 2069 6e20 7265 665f 706f 7274 733a  rp in ref_ports:
+00005460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005470: 2020 2020 206e 6577 5f70 6f72 7420 3d20       new_port = 
+00005480: 7270 2e5f 636f 7079 2829 0a20 2020 2020  rp._copy().     
+00005490: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000054a0: 6577 5f63 656e 7465 722c 206e 6577 5f6f  ew_center, new_o
+000054b0: 7269 656e 7461 7469 6f6e 203d 2072 2e5f  rientation = r._
+000054c0: 7472 616e 7366 6f72 6d5f 706f 7274 280a  transform_port(.
 000054d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054e0: 2020 2020 2072 702e 6f72 6965 6e74 6174       rp.orientat
-000054f0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00005500: 2020 2020 2020 2020 2020 2020 2072 2e6f               r.o
-00005510: 7269 6769 6e2c 0a20 2020 2020 2020 2020  rigin,.         
-00005520: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005530: 2e72 6f74 6174 696f 6e2c 0a20 2020 2020  .rotation,.     
+000054e0: 2020 2020 2020 2020 7270 2e63 656e 7465          rp.cente
+000054f0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00005500: 2020 2020 2020 2020 2020 2072 702e 6f72             rp.or
+00005510: 6965 6e74 6174 696f 6e2c 0a20 2020 2020  ientation,.     
+00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005530: 2020 2072 2e6f 7269 6769 6e2c 0a20 2020     r.origin,.   
 00005540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005550: 2020 2072 2e78 5f72 6566 6c65 6374 696f     r.x_reflectio
-00005560: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00005570: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005580: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00005590: 5f70 6f72 742e 6365 6e74 6572 203d 206e  _port.center = n
-000055a0: 6577 5f63 656e 7465 720a 2020 2020 2020  ew_center.      
-000055b0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-000055c0: 775f 706f 7274 2e6e 6577 5f6f 7269 656e  w_port.new_orien
-000055d0: 7461 7469 6f6e 203d 206e 6577 5f6f 7269  tation = new_ori
-000055e0: 656e 7461 7469 6f6e 0a20 2020 2020 2020  entation.       
-000055f0: 2020 2020 2020 2020 2020 2020 2072 6566               ref
-00005600: 5f70 6f72 7473 5f74 7261 6e73 666f 726d  _ports_transform
-00005610: 6564 2e61 7070 656e 6428 6e65 775f 706f  ed.append(new_po
-00005620: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
-00005630: 2020 2020 706f 7274 5f6c 6973 7420 2b3d      port_list +=
-00005640: 2072 6566 5f70 6f72 7473 5f74 7261 6e73   ref_ports_trans
-00005650: 666f 726d 6564 0a0a 2020 2020 2020 2020  formed..        
-00005660: 7265 7475 726e 2070 6f72 745f 6c69 7374  return port_list
-00005670: 0a0a 2020 2020 6465 6620 6765 745f 706f  ..    def get_po
-00005680: 7274 735f 6469 6374 2873 656c 662c 202a  rts_dict(self, *
-00005690: 2a6b 7761 7267 7329 202d 3e20 4469 6374  *kwargs) -> Dict
-000056a0: 5b73 7472 2c20 506f 7274 5d3a 0a20 2020  [str, Port]:.   
-000056b0: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
-000056c0: 6120 6469 6374 206f 6620 706f 7274 732e  a dict of ports.
-000056d0: 0a0a 2020 2020 2020 2020 4b65 7977 6f72  ..        Keywor
-000056e0: 6420 4172 6773 3a0a 2020 2020 2020 2020  d Args:.        
-000056f0: 2020 2020 6c61 7965 723a 2070 6f72 7420      layer: port 
-00005700: 4744 5320 6c61 7965 722e 0a20 2020 2020  GDS layer..     
-00005710: 2020 2020 2020 2070 7265 6669 783a 2073         prefix: s
-00005720: 656c 6563 7420 706f 7274 7320 7769 7468  elect ports with
-00005730: 2070 7265 6669 7820 696e 2070 6f72 7420   prefix in port 
-00005740: 6e61 6d65 2e0a 2020 2020 2020 2020 2020  name..          
-00005750: 2020 7375 6666 6978 3a20 7365 6c65 6374    suffix: select
-00005760: 2070 6f72 7473 2077 6974 6820 706f 7274   ports with port
-00005770: 206e 616d 6520 7375 6666 6978 2e0a 2020   name suffix..  
-00005780: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
-00005790: 6174 696f 6e3a 2073 656c 6563 7420 706f  ation: select po
-000057a0: 7274 7320 7769 7468 206f 7269 656e 7461  rts with orienta
-000057b0: 7469 6f6e 2069 6e20 6465 6772 6565 732e  tion in degrees.
-000057c0: 0a20 2020 2020 2020 2020 2020 2077 6964  .            wid
-000057d0: 7468 3a20 7365 6c65 6374 2070 6f72 7473  th: select ports
-000057e0: 2077 6974 6820 706f 7274 2077 6964 7468   with port width
-000057f0: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-00005800: 7965 7273 5f65 7863 6c75 6465 643a 204c  yers_excluded: L
-00005810: 6973 7420 6f66 206c 6179 6572 7320 746f  ist of layers to
-00005820: 2065 7863 6c75 6465 2e0a 2020 2020 2020   exclude..      
-00005830: 2020 2020 2020 706f 7274 5f74 7970 653a        port_type:
-00005840: 2073 656c 6563 7420 706f 7274 7320 7769   select ports wi
-00005850: 7468 2070 6f72 745f 7479 7065 2028 6f70  th port_type (op
-00005860: 7469 6361 6c2c 2065 6c65 6374 7269 6361  tical, electrica
-00005870: 6c2c 2076 6572 7469 6361 6c5f 7465 292e  l, vertical_te).
-00005880: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
-00005890: 636b 7769 7365 3a20 6966 2054 7275 652c  ckwise: if True,
-000058a0: 2073 6f72 7420 706f 7274 7320 636c 6f63   sort ports cloc
-000058b0: 6b77 6973 652c 2046 616c 7365 3a20 636f  kwise, False: co
-000058c0: 756e 7465 722d 636c 6f63 6b77 6973 652e  unter-clockwise.
-000058d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000058e0: 2020 2020 2072 6574 7572 6e20 7365 6c65       return sele
-000058f0: 6374 5f70 6f72 7473 2873 656c 662e 706f  ct_ports(self.po
-00005900: 7274 732c 202a 2a6b 7761 7267 7329 0a0a  rts, **kwargs)..
-00005910: 2020 2020 6465 6620 6765 745f 706f 7274      def get_port
-00005920: 735f 6c69 7374 2873 656c 662c 202a 2a6b  s_list(self, **k
-00005930: 7761 7267 7329 202d 3e20 4c69 7374 5b50  wargs) -> List[P
-00005940: 6f72 745d 3a0a 2020 2020 2020 2020 2222  ort]:.        ""
-00005950: 2252 6574 7572 6e73 206c 6973 7420 6f66  "Returns list of
-00005960: 2070 6f72 7473 2e0a 0a20 2020 2020 2020   ports...       
-00005970: 204b 6579 776f 7264 2041 7267 733a 0a20   Keyword Args:. 
-00005980: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00005990: 3a20 7365 6c65 6374 2070 6f72 7473 2077  : select ports w
-000059a0: 6974 6820 4744 5320 6c61 7965 722e 0a20  ith GDS layer.. 
-000059b0: 2020 2020 2020 2020 2020 2070 7265 6669             prefi
-000059c0: 783a 2073 656c 6563 7420 706f 7274 7320  x: select ports 
-000059d0: 7769 7468 2070 7265 6669 7820 696e 2070  with prefix in p
-000059e0: 6f72 7420 6e61 6d65 2e0a 2020 2020 2020  ort name..      
-000059f0: 2020 2020 2020 7375 6666 6978 3a20 7365        suffix: se
-00005a00: 6c65 6374 2070 6f72 7473 2077 6974 6820  lect ports with 
-00005a10: 706f 7274 206e 616d 6520 7375 6666 6978  port name suffix
-00005a20: 2e0a 2020 2020 2020 2020 2020 2020 6f72  ..            or
-00005a30: 6965 6e74 6174 696f 6e3a 2073 656c 6563  ientation: selec
-00005a40: 7420 706f 7274 7320 7769 7468 206f 7269  t ports with ori
-00005a50: 656e 7461 7469 6f6e 2069 6e20 6465 6772  entation in degr
-00005a60: 6565 732e 0a20 2020 2020 2020 2020 2020  ees..           
-00005a70: 206f 7269 656e 7461 7469 6f6e 3a20 7365   orientation: se
-00005a80: 6c65 6374 2070 6f72 7473 2077 6974 6820  lect ports with 
-00005a90: 6f72 6965 6e74 6174 696f 6e20 696e 2064  orientation in d
-00005aa0: 6567 7265 6573 2e0a 2020 2020 2020 2020  egrees..        
-00005ab0: 2020 2020 7769 6474 683a 2073 656c 6563      width: selec
-00005ac0: 7420 706f 7274 7320 7769 7468 2070 6f72  t ports with por
-00005ad0: 7420 7769 6474 682e 0a20 2020 2020 2020  t width..       
-00005ae0: 2020 2020 206c 6179 6572 735f 6578 636c       layers_excl
-00005af0: 7564 6564 3a20 4c69 7374 206f 6620 6c61  uded: List of la
-00005b00: 7965 7273 2074 6f20 6578 636c 7564 652e  yers to exclude.
-00005b10: 0a20 2020 2020 2020 2020 2020 2070 6f72  .            por
-00005b20: 745f 7479 7065 3a20 7365 6c65 6374 2070  t_type: select p
-00005b30: 6f72 7473 2077 6974 6820 706f 7274 5f74  orts with port_t
-00005b40: 7970 6520 286f 7074 6963 616c 2c20 656c  ype (optical, el
-00005b50: 6563 7472 6963 616c 2c20 7665 7274 6963  ectrical, vertic
-00005b60: 616c 5f74 6529 2e0a 2020 2020 2020 2020  al_te)..        
-00005b70: 2020 2020 636c 6f63 6b77 6973 653a 2069      clockwise: i
-00005b80: 6620 5472 7565 2c20 736f 7274 2070 6f72  f True, sort por
-00005b90: 7473 2063 6c6f 636b 7769 7365 2c20 4661  ts clockwise, Fa
-00005ba0: 6c73 653a 2063 6f75 6e74 6572 2d63 6c6f  lse: counter-clo
-00005bb0: 636b 7769 7365 2e0a 2020 2020 2020 2020  ckwise..        
-00005bc0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00005bd0: 726e 206c 6973 7428 7365 6c65 6374 5f70  rn list(select_p
-00005be0: 6f72 7473 2873 656c 662e 706f 7274 732c  orts(self.ports,
-00005bf0: 202a 2a6b 7761 7267 7329 2e76 616c 7565   **kwargs).value
-00005c00: 7328 2929 0a0a 2020 2020 6465 6620 6765  s())..    def ge
-00005c10: 745f 706f 7274 735f 7061 6e64 6173 2873  t_ports_pandas(s
-00005c20: 656c 6629 3a0a 2020 2020 2020 2020 696d  elf):.        im
-00005c30: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-00005c40: 640a 0a20 2020 2020 2020 2063 6f6c 5f73  d..        col_s
-00005c50: 7065 6320 3d20 5b0a 2020 2020 2020 2020  pec = [.        
-00005c60: 2020 2020 226e 616d 6522 2c0a 2020 2020      "name",.    
-00005c70: 2020 2020 2020 2020 2277 6964 7468 222c          "width",
-00005c80: 0a20 2020 2020 2020 2020 2020 2022 6365  .            "ce
-00005c90: 6e74 6572 222c 0a20 2020 2020 2020 2020  nter",.         
-00005ca0: 2020 2022 6f72 6965 6e74 6174 696f 6e22     "orientation"
-00005cb0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-00005cc0: 6179 6572 222c 0a20 2020 2020 2020 2020  ayer",.         
-00005cd0: 2020 2022 706f 7274 5f74 7970 6522 2c0a     "port_type",.
-00005ce0: 2020 2020 2020 2020 2020 2020 2273 6865              "she
-00005cf0: 6172 5f61 6e67 6c65 222c 0a20 2020 2020  ar_angle",.     
-00005d00: 2020 205d 0a0a 2020 2020 2020 2020 7265     ]..        re
-00005d10: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
-00005d20: 6528 0a20 2020 2020 2020 2020 2020 205b  e(.            [
-00005d30: 706f 7274 2e74 6f5f 6469 6374 2829 2066  port.to_dict() f
-00005d40: 6f72 2070 6f72 7420 696e 2073 656c 662e  or port in self.
-00005d50: 6765 745f 706f 7274 735f 6c69 7374 2829  get_ports_list()
-00005d60: 5d2c 2063 6f6c 756d 6e73 3d63 6f6c 5f73  ], columns=col_s
-00005d70: 7065 630a 2020 2020 2020 2020 290a 0a20  pec.        ).. 
-00005d80: 2020 2064 6566 2067 6574 5f70 6f72 7473     def get_ports
-00005d90: 5f70 6f6c 6172 7328 7365 6c66 293a 0a20  _polars(self):. 
-00005da0: 2020 2020 2020 2069 6d70 6f72 7420 706f         import po
-00005db0: 6c61 7273 2061 7320 706c 0a0a 2020 2020  lars as pl..    
-00005dc0: 2020 2020 636f 6c5f 7370 6563 203d 207b      col_spec = {
-00005dd0: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
-00005de0: 6d65 223a 2070 6c2e 5574 6638 2c0a 2020  me": pl.Utf8,.  
-00005df0: 2020 2020 2020 2020 2020 2277 6964 7468            "width
-00005e00: 223a 2070 6c2e 466c 6f61 7436 342c 0a20  ": pl.Float64,. 
-00005e10: 2020 2020 2020 2020 2020 2022 6365 6e74             "cent
-00005e20: 6572 223a 2070 6c2e 4c69 7374 2870 6c2e  er": pl.List(pl.
-00005e30: 466c 6f61 7436 3429 2c0a 2020 2020 2020  Float64),.      
-00005e40: 2020 2020 2020 226f 7269 656e 7461 7469        "orientati
-00005e50: 6f6e 223a 2070 6c2e 466c 6f61 7436 342c  on": pl.Float64,
-00005e60: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-00005e70: 7965 7222 3a20 706c 2e4c 6973 7428 706c  yer": pl.List(pl
-00005e80: 2e55 496e 7431 3629 2c0a 2020 2020 2020  .UInt16),.      
-00005e90: 2020 2020 2020 2270 6f72 745f 7479 7065        "port_type
-00005ea0: 223a 2070 6c2e 5574 6638 2c0a 2020 2020  ": pl.Utf8,.    
-00005eb0: 2020 2020 2020 2020 2273 6865 6172 5f61          "shear_a
-00005ec0: 6e67 6c65 223a 2070 6c2e 466c 6f61 7436  ngle": pl.Float6
-00005ed0: 342c 0a20 2020 2020 2020 207d 0a0a 2020  4,.        }..  
-00005ee0: 2020 2020 2020 7265 7475 726e 2070 6c2e        return pl.
-00005ef0: 4461 7461 4672 616d 6528 0a20 2020 2020  DataFrame(.     
-00005f00: 2020 2020 2020 205b 706f 7274 2e74 6f5f         [port.to_
-00005f10: 6469 6374 2829 2066 6f72 2070 6f72 7420  dict() for port 
-00005f20: 696e 2073 656c 662e 6765 745f 706f 7274  in self.get_port
-00005f30: 735f 6c69 7374 2829 5d2c 2073 6368 656d  s_list()], schem
-00005f40: 613d 636f 6c5f 7370 6563 0a20 2020 2020  a=col_spec.     
-00005f50: 2020 2029 0a0a 2020 2020 6465 6620 7265     )..    def re
-00005f60: 6628 0a20 2020 2020 2020 2073 656c 662c  f(.        self,
-00005f70: 0a20 2020 2020 2020 2070 6f73 6974 696f  .        positio
-00005f80: 6e3a 2043 6f6f 7264 696e 6174 6520 3d20  n: Coordinate = 
-00005f90: 2830 2c20 3029 2c0a 2020 2020 2020 2020  (0, 0),.        
-00005fa0: 706f 7274 5f69 643a 204f 7074 696f 6e61  port_id: Optiona
-00005fb0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00005fc0: 2020 2020 2020 2072 6f74 6174 696f 6e3a         rotation:
-00005fd0: 2066 6c6f 6174 203d 2030 2c0a 2020 2020   float = 0,.    
-00005fe0: 2020 2020 685f 6d69 7272 6f72 3a20 626f      h_mirror: bo
-00005ff0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00006000: 2020 2020 765f 6d69 7272 6f72 3a20 626f      v_mirror: bo
-00006010: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00006020: 2920 2d3e 2043 6f6d 706f 6e65 6e74 5265  ) -> ComponentRe
-00006030: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
-00006040: 2022 2222 5265 7475 726e 7320 436f 6d70   """Returns Comp
-00006050: 6f6e 656e 7420 7265 6665 7265 6e63 652e  onent reference.
-00006060: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-00006070: 2020 2020 2020 2020 2020 2020 706f 7369              posi
-00006080: 7469 6f6e 3a20 782c 2079 2070 6f73 6974  tion: x, y posit
-00006090: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-000060a0: 2070 6f72 745f 6964 3a20 6e61 6d65 206f   port_id: name o
-000060b0: 6620 7468 6520 706f 7274 2e0a 2020 2020  f the port..    
-000060c0: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
-000060d0: 3a20 696e 2064 6567 7265 6573 2e0a 2020  : in degrees..  
-000060e0: 2020 2020 2020 2020 2020 685f 6d69 7272            h_mirr
-000060f0: 6f72 3a20 686f 7269 7a6f 6e74 616c 206d  or: horizontal m
-00006100: 6972 726f 7220 7573 696e 6720 7920 6178  irror using y ax
-00006110: 6973 2028 782c 2031 2920 2831 2c20 3029  is (x, 1) (1, 0)
-00006120: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006130: 2020 5468 6973 2069 7320 7468 6520 6d6f    This is the mo
-00006140: 7374 2063 6f6d 6d6f 6e20 6d69 7272 6f72  st common mirror
-00006150: 2e0a 2020 2020 2020 2020 2020 2020 765f  ..            v_
-00006160: 6d69 7272 6f72 3a20 7665 7274 6963 616c  mirror: vertical
-00006170: 206d 6972 726f 7220 7573 696e 6720 7820   mirror using x 
-00006180: 6178 6973 2028 312c 2079 2920 2830 2c20  axis (1, y) (0, 
-00006190: 7929 2e0a 2020 2020 2020 2020 2222 220a  y)..        """.
-000061a0: 2020 2020 2020 2020 5f72 6566 203d 2043          _ref = C
-000061b0: 6f6d 706f 6e65 6e74 5265 6665 7265 6e63  omponentReferenc
-000061c0: 6528 7365 6c66 290a 0a20 2020 2020 2020  e(self)..       
-000061d0: 2069 6620 706f 7274 5f69 6420 616e 6420   if port_id and 
-000061e0: 706f 7274 5f69 6420 6e6f 7420 696e 2073  port_id not in s
-000061f0: 656c 662e 706f 7274 733a 0a20 2020 2020  elf.ports:.     
-00006200: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00006210: 7565 4572 726f 7228 6622 706f 7274 207b  ueError(f"port {
-00006220: 706f 7274 5f69 647d 206e 6f74 2069 6e20  port_id} not in 
-00006230: 7b73 656c 662e 706f 7274 732e 6b65 7973  {self.ports.keys
-00006240: 2829 7d22 290a 0a20 2020 2020 2020 206f  ()}")..        o
-00006250: 7269 6769 6e20 3d20 7365 6c66 2e70 6f72  rigin = self.por
-00006260: 7473 5b70 6f72 745f 6964 5d2e 6365 6e74  ts[port_id].cent
-00006270: 6572 2069 6620 706f 7274 5f69 6420 656c  er if port_id el
-00006280: 7365 2028 302c 2030 290a 2020 2020 2020  se (0, 0).      
-00006290: 2020 6966 2068 5f6d 6972 726f 723a 0a20    if h_mirror:. 
-000062a0: 2020 2020 2020 2020 2020 205f 7265 662e             _ref.
-000062b0: 6d69 7272 6f72 5f78 2870 6f72 745f 6964  mirror_x(port_id
-000062c0: 290a 0a20 2020 2020 2020 2069 6620 765f  )..        if v_
-000062d0: 6d69 7272 6f72 3a0a 2020 2020 2020 2020  mirror:.        
-000062e0: 2020 2020 5f72 6566 2e6d 6972 726f 725f      _ref.mirror_
-000062f0: 7928 706f 7274 5f69 6429 0a0a 2020 2020  y(port_id)..    
-00006300: 2020 2020 6966 2072 6f74 6174 696f 6e20      if rotation 
-00006310: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
-00006320: 2020 5f72 6566 2e72 6f74 6174 6528 726f    _ref.rotate(ro
-00006330: 7461 7469 6f6e 2c20 6f72 6967 696e 290a  tation, origin).
-00006340: 2020 2020 2020 2020 5f72 6566 2e6d 6f76          _ref.mov
-00006350: 6528 6f72 6967 696e 2c20 706f 7369 7469  e(origin, positi
-00006360: 6f6e 290a 0a20 2020 2020 2020 2072 6574  on)..        ret
-00006370: 7572 6e20 5f72 6566 0a0a 2020 2020 6465  urn _ref..    de
-00006380: 6620 7265 665f 6365 6e74 6572 2873 656c  f ref_center(sel
-00006390: 662c 2070 6f73 6974 696f 6e3d 2830 2c20  f, position=(0, 
-000063a0: 3029 293a 0a20 2020 2020 2020 2022 2222  0)):.        """
-000063b0: 5265 7475 726e 7320 6120 7265 6665 7265  Returns a refere
-000063c0: 6e63 6520 6f66 2074 6865 2063 6f6d 706f  nce of the compo
-000063d0: 6e65 6e74 2063 656e 7465 7265 6420 6174  nent centered at
-000063e0: 2028 783d 302c 2079 3d30 292e 2222 220a   (x=0, y=0).""".
-000063f0: 2020 2020 2020 2020 7369 203d 2073 656c          si = sel
-00006400: 662e 7369 7a65 5f69 6e66 6f0a 2020 2020  f.size_info.    
-00006410: 2020 2020 7963 203d 2073 692e 736f 7574      yc = si.sout
-00006420: 6820 2b20 7369 2e68 6569 6768 7420 2f20  h + si.height / 
-00006430: 320a 2020 2020 2020 2020 7863 203d 2073  2.        xc = s
-00006440: 692e 7765 7374 202b 2073 692e 7769 6474  i.west + si.widt
-00006450: 6820 2f20 320a 2020 2020 2020 2020 6365  h / 2.        ce
-00006460: 6e74 6572 203d 2028 7863 2c20 7963 290a  nter = (xc, yc).
-00006470: 2020 2020 2020 2020 5f72 6566 203d 2043          _ref = C
-00006480: 6f6d 706f 6e65 6e74 5265 6665 7265 6e63  omponentReferenc
-00006490: 6528 7365 6c66 290a 2020 2020 2020 2020  e(self).        
-000064a0: 5f72 6566 2e6d 6f76 6528 6365 6e74 6572  _ref.move(center
-000064b0: 2c20 706f 7369 7469 6f6e 290a 2020 2020  , position).    
-000064c0: 2020 2020 7265 7475 726e 205f 7265 660a      return _ref.
-000064d0: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
-000064e0: 5f28 7365 6c66 2920 2d3e 2073 7472 3a0a  _(self) -> str:.
-000064f0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00006500: 6e20 6120 7374 7269 6e67 2072 6570 7265  n a string repre
-00006510: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
-00006520: 206f 626a 6563 742e 2222 220a 2020 2020   object.""".    
-00006530: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-00006540: 2020 2020 2020 2020 2066 227b 7365 6c66           f"{self
-00006550: 2e6e 616d 657d 3a20 7569 6420 7b73 656c  .name}: uid {sel
-00006560: 662e 7569 647d 2c20 220a 2020 2020 2020  f.uid}, ".      
-00006570: 2020 2020 2020 6622 706f 7274 7320 7b6c        f"ports {l
-00006580: 6973 7428 7365 6c66 2e70 6f72 7473 2e6b  ist(self.ports.k
-00006590: 6579 7328 2929 7d2c 2022 0a20 2020 2020  eys())}, ".     
-000065a0: 2020 2020 2020 2066 2272 6566 6572 656e         f"referen
-000065b0: 6365 7320 7b6c 6973 7428 7365 6c66 2e6e  ces {list(self.n
-000065c0: 616d 6564 5f72 6566 6572 656e 6365 732e  amed_references.
-000065d0: 6b65 7973 2829 297d 2c20 220a 2020 2020  keys())}, ".    
-000065e0: 2020 2020 2020 2020 6622 7b6c 656e 2873          f"{len(s
-000065f0: 656c 662e 706f 6c79 676f 6e73 297d 2070  elf.polygons)} p
-00006600: 6f6c 7967 6f6e 7322 0a20 2020 2020 2020  olygons".       
-00006610: 2029 0a0a 2020 2020 6465 6620 7070 7269   )..    def ppri
-00006620: 6e74 2873 656c 6629 202d 3e20 4e6f 6e65  nt(self) -> None
-00006630: 3a0a 2020 2020 2020 2020 2222 2250 7269  :.        """Pri
-00006640: 6e74 7320 636f 6d70 6f6e 656e 7420 696e  nts component in
-00006650: 666f 2e22 2222 0a20 2020 2020 2020 2074  fo.""".        t
-00006660: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00006670: 6672 6f6d 2072 6963 6820 696d 706f 7274  from rich import
-00006680: 2070 7265 7474 790a 0a20 2020 2020 2020   pretty..       
-00006690: 2020 2020 2070 7265 7474 792e 696e 7374       pretty.inst
-000066a0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-000066b0: 2020 7072 6574 7479 2e70 7072 696e 7428    pretty.pprint(
-000066c0: 7365 6c66 2e74 6f5f 6469 6374 2829 290a  self.to_dict()).
-000066d0: 2020 2020 2020 2020 6578 6365 7074 2049          except I
-000066e0: 6d70 6f72 7445 7272 6f72 3a0a 2020 2020  mportError:.    
-000066f0: 2020 2020 2020 2020 7072 696e 7428 7961          print(ya
-00006700: 6d6c 2e64 756d 7028 7365 6c66 2e74 6f5f  ml.dump(self.to_
-00006710: 6469 6374 2829 2929 0a0a 2020 2020 6465  dict()))..    de
-00006720: 6620 7070 7269 6e74 5f70 6f72 7473 2873  f pprint_ports(s
-00006730: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00006740: 2020 2020 2020 2222 2250 7269 6e74 7320        """Prints 
-00006750: 636f 6d70 6f6e 656e 7420 6e65 746c 6973  component netlis
-00006760: 7473 2e22 2222 0a20 2020 2020 2020 2070  ts.""".        p
-00006770: 6f72 7473 5f6c 6973 7420 3d20 7365 6c66  orts_list = self
-00006780: 2e67 6574 5f70 6f72 7473 5f6c 6973 7428  .get_ports_list(
-00006790: 290a 2020 2020 2020 2020 666f 7220 706f  ).        for po
-000067a0: 7274 2069 6e20 706f 7274 735f 6c69 7374  rt in ports_list
-000067b0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-000067c0: 696e 7428 706f 7274 290a 0a20 2020 2040  int(port)..    @
-000067d0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000067e0: 206d 6574 6164 6174 615f 6368 696c 6428   metadata_child(
-000067f0: 7365 6c66 2920 2d3e 2044 6963 743a 0a20  self) -> Dict:. 
-00006800: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00006810: 7320 6d65 7461 6461 7461 2066 726f 6d20  s metadata from 
-00006820: 6368 696c 6420 6966 2061 6e79 2c20 4f74  child if any, Ot
-00006830: 6865 7277 6973 6520 7265 7475 726e 7320  herwise returns 
-00006840: 636f 6d70 6f6e 656e 7420 6f77 6e2e 0a0a  component own...
-00006850: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00006860: 2047 7265 6174 2074 6f20 6163 6365 7373   Great to access
-00006870: 2074 6865 2063 6869 6c64 7265 6e20 6d65   the children me
-00006880: 7461 6461 7461 2061 7420 7468 6520 626f  tadata at the bo
-00006890: 7474 6f6d 206f 6620 7468 650a 2020 2020  ttom of the.    
-000068a0: 2020 2020 6869 6572 6172 6368 792e 0a20      hierarchy.. 
-000068b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000068c0: 2020 2073 6574 7469 6e67 7320 3d20 6469     settings = di
-000068d0: 6374 2873 656c 662e 7365 7474 696e 6773  ct(self.settings
-000068e0: 290a 0a20 2020 2020 2020 2077 6869 6c65  )..        while
-000068f0: 2073 6574 7469 6e67 732e 6765 7428 2263   settings.get("c
-00006900: 6869 6c64 2229 3a0a 2020 2020 2020 2020  hild"):.        
-00006910: 2020 2020 7365 7474 696e 6773 203d 2073      settings = s
-00006920: 6574 7469 6e67 732e 6765 7428 2263 6869  ettings.get("chi
-00006930: 6c64 2229 0a0a 2020 2020 2020 2020 7265  ld")..        re
-00006940: 7475 726e 2064 6963 7428 7365 7474 696e  turn dict(settin
-00006950: 6773 290a 0a20 2020 2040 7072 6f70 6572  gs)..    @proper
-00006960: 7479 0a20 2020 2064 6566 206d 6574 6164  ty.    def metad
-00006970: 6174 6128 7365 6c66 2920 2d3e 2044 6963  ata(self) -> Dic
-00006980: 743a 0a20 2020 2020 2020 2072 6574 7572  t:.        retur
-00006990: 6e20 6469 6374 2873 656c 662e 7365 7474  n dict(self.sett
-000069a0: 696e 6773 290a 0a20 2020 2064 6566 2061  ings)..    def a
-000069b0: 6464 5f70 6f72 7428 0a20 2020 2020 2020  dd_port(.       
-000069c0: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-000069d0: 616d 653a 204f 7074 696f 6e61 6c5b 556e  ame: Optional[Un
-000069e0: 696f 6e5b 7374 722c 206f 626a 6563 745d  ion[str, object]
-000069f0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00006a00: 2020 6365 6e74 6572 3a20 4f70 7469 6f6e    center: Option
-00006a10: 616c 5b54 7570 6c65 5b66 6c6f 6174 2c20  al[Tuple[float, 
-00006a20: 666c 6f61 745d 5d20 3d20 4e6f 6e65 2c0a  float]] = None,.
-00006a30: 2020 2020 2020 2020 7769 6474 683a 204f          width: O
-00006a40: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
-00006a50: 204e 6f6e 652c 0a20 2020 2020 2020 206f   None,.        o
-00006a60: 7269 656e 7461 7469 6f6e 3a20 4f70 7469  rientation: Opti
-00006a70: 6f6e 616c 5b66 6c6f 6174 5d20 3d20 4e6f  onal[float] = No
-00006a80: 6e65 2c0a 2020 2020 2020 2020 706f 7274  ne,.        port
-00006a90: 3a20 4f70 7469 6f6e 616c 5b50 6f72 745d  : Optional[Port]
-00006aa0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00006ab0: 206c 6179 6572 3a20 4f70 7469 6f6e 616c   layer: Optional
-00006ac0: 5b4c 6179 6572 5370 6563 5d20 3d20 4e6f  [LayerSpec] = No
-00006ad0: 6e65 2c0a 2020 2020 2020 2020 706f 7274  ne,.        port
-00006ae0: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
-00006af0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00006b00: 2020 2020 2063 726f 7373 5f73 6563 7469       cross_secti
-00006b10: 6f6e 3a20 4f70 7469 6f6e 616c 5b43 726f  on: Optional[Cro
-00006b20: 7373 5365 6374 696f 6e5d 203d 204e 6f6e  ssSection] = Non
-00006b30: 652c 0a20 2020 2029 202d 3e20 506f 7274  e,.    ) -> Port
-00006b40: 3a0a 2020 2020 2020 2020 2222 2241 6464  :.        """Add
-00006b50: 2070 6f72 7420 746f 2063 6f6d 706f 6e65   port to compone
-00006b60: 6e74 2e0a 0a20 2020 2020 2020 2059 6f75  nt...        You
-00006b70: 2063 616e 2063 6f70 7920 616e 2065 7869   can copy an exi
-00006b80: 7374 696e 6720 706f 7274 206c 696b 6520  sting port like 
-00006b90: 6164 645f 706f 7274 2870 6f72 7420 3d20  add_port(port = 
-00006ba0: 6578 6973 7469 6e67 5f70 6f72 7429 206f  existing_port) o
-00006bb0: 720a 2020 2020 2020 2020 6372 6561 7465  r.        create
-00006bc0: 2061 206e 6577 2070 6f72 7420 6164 645f   a new port add_
-00006bd0: 706f 7274 286d 796e 616d 652c 206d 7963  port(myname, myc
-00006be0: 656e 7465 722c 206d 7977 6964 7468 2c20  enter, mywidth, 
-00006bf0: 6d79 6f72 6965 6e74 6174 696f 6e29 2e0a  myorientation)..
-00006c00: 2020 2020 2020 2020 596f 7520 6361 6e20          You can 
-00006c10: 616c 736f 2063 6f70 7920 616e 2065 7869  also copy an exi
-00006c20: 7374 696e 6720 706f 7274 0a20 2020 2020  sting port.     
-00006c30: 2020 2077 6974 6820 6120 6e65 7720 6e61     with a new na
-00006c40: 6d65 2061 6464 5f70 6f72 7428 706f 7274  me add_port(port
-00006c50: 203d 2065 7869 7374 696e 675f 706f 7274   = existing_port
-00006c60: 2c20 6e61 6d65 203d 206e 6577 5f6e 616d  , name = new_nam
-00006c70: 6529 0a0a 2020 2020 2020 2020 4172 6773  e)..        Args
-00006c80: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
-00006c90: 6d65 3a20 706f 7274 206e 616d 652e 0a20  me: port name.. 
-00006ca0: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-00006cb0: 723a 2078 2c20 792e 0a20 2020 2020 2020  r: x, y..       
-00006cc0: 2020 2020 2077 6964 7468 3a20 696e 2075       width: in u
-00006cd0: 6d2e 0a20 2020 2020 2020 2020 2020 206f  m..            o
-00006ce0: 7269 656e 7461 7469 6f6e 3a20 696e 2064  rientation: in d
-00006cf0: 6567 2e0a 2020 2020 2020 2020 2020 2020  eg..            
-00006d00: 706f 7274 3a20 6f70 7469 6f6e 616c 2070  port: optional p
-00006d10: 6f72 742e 0a20 2020 2020 2020 2020 2020  ort..           
-00006d20: 206c 6179 6572 3a20 706f 7274 206c 6179   layer: port lay
-00006d30: 6572 2e0a 2020 2020 2020 2020 2020 2020  er..            
-00006d40: 706f 7274 5f74 7970 653a 206f 7074 6963  port_type: optic
-00006d50: 616c 2c20 656c 6563 7472 6963 616c 2c20  al, electrical, 
-00006d60: 7665 7274 6963 616c 5f64 632c 2076 6572  vertical_dc, ver
-00006d70: 7469 6361 6c5f 7465 2c20 7665 7274 6963  tical_te, vertic
-00006d80: 616c 5f74 6d2e 2044 6566 6175 6c74 7320  al_tm. Defaults 
-00006d90: 746f 206f 7074 6963 616c 2e0a 2020 2020  to optical..    
-00006da0: 2020 2020 2020 2020 6372 6f73 735f 7365          cross_se
-00006db0: 6374 696f 6e3a 2070 6f72 7420 6372 6f73  ction: port cros
-00006dc0: 735f 7365 6374 696f 6e2e 0a20 2020 2020  s_section..     
-00006dd0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00006de0: 726f 6d20 6764 7366 6163 746f 7279 2e70  rom gdsfactory.p
-00006df0: 646b 2069 6d70 6f72 7420 6765 745f 6c61  dk import get_la
-00006e00: 7965 720a 0a20 2020 2020 2020 206c 6179  yer..        lay
-00006e10: 6572 203d 2067 6574 5f6c 6179 6572 286c  er = get_layer(l
-00006e20: 6179 6572 290a 0a20 2020 2020 2020 2069  ayer)..        i
-00006e30: 6620 706f 7274 3a0a 2020 2020 2020 2020  f port:.        
-00006e40: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00006e50: 7461 6e63 6528 706f 7274 2c20 506f 7274  tance(port, Port
-00006e60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00006e70: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00006e80: 726f 7228 6622 6164 645f 706f 7274 2829  ror(f"add_port()
-00006e90: 206e 6565 6473 2061 2050 6f72 742c 2067   needs a Port, g
-00006ea0: 6f74 207b 7479 7065 2870 6f72 7429 7d22  ot {type(port)}"
-00006eb0: 290a 2020 2020 2020 2020 2020 2020 7020  ).            p 
-00006ec0: 3d20 706f 7274 2e63 6f70 7928 290a 2020  = port.copy().  
-00006ed0: 2020 2020 2020 2020 2020 6966 206e 616d            if nam
-00006ee0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-00006ef0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00006f00: 2e6e 616d 6520 3d20 6e61 6d65 0a20 2020  .name = name.   
-00006f10: 2020 2020 2020 2020 2069 6620 6365 6e74           if cent
-00006f20: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0a  er is not None:.
-00006f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f40: 702e 6365 6e74 6572 203d 2063 656e 7465  p.center = cente
-00006f50: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-00006f60: 2077 6964 7468 2069 7320 6e6f 7420 4e6f   width is not No
-00006f70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00006f80: 2020 2020 702e 7769 6474 6820 3d20 7769      p.width = wi
-00006f90: 6474 680a 2020 2020 2020 2020 2020 2020  dth.            
-00006fa0: 6966 206f 7269 656e 7461 7469 6f6e 2069  if orientation i
-00006fb0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00006fc0: 2020 2020 2020 2020 2020 2020 702e 6f72              p.or
-00006fd0: 6965 6e74 6174 696f 6e20 3d20 6f72 6965  ientation = orie
-00006fe0: 6e74 6174 696f 6e0a 2020 2020 2020 2020  ntation.        
-00006ff0: 2020 2020 6966 2070 6f72 745f 7479 7065      if port_type
-00007000: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00007010: 2020 2020 2020 2020 2020 2020 2020 702e                p.
-00007020: 706f 7274 5f74 7970 6520 3d20 706f 7274  port_type = port
-00007030: 5f74 7970 650a 2020 2020 2020 2020 2020  _type.          
-00007040: 2020 6966 206c 6179 6572 2069 7320 6e6f    if layer is no
-00007050: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00007060: 2020 2020 2020 2020 702e 6c61 7965 7220          p.layer 
-00007070: 3d20 6c61 7965 720a 2020 2020 2020 2020  = layer.        
-00007080: 2020 2020 702e 7061 7265 6e74 203d 2073      p.parent = s
-00007090: 656c 660a 0a20 2020 2020 2020 2065 6c69  elf..        eli
-000070a0: 6620 6973 696e 7374 616e 6365 286e 616d  f isinstance(nam
-000070b0: 652c 2050 6f72 7429 3a0a 2020 2020 2020  e, Port):.      
-000070c0: 2020 2020 2020 7020 3d20 6e61 6d65 2e63        p = name.c
-000070d0: 6f70 7928 290a 2020 2020 2020 2020 2020  opy().          
-000070e0: 2020 702e 7061 7265 6e74 203d 2073 656c    p.parent = sel
-000070f0: 660a 2020 2020 2020 2020 2020 2020 6e61  f.            na
-00007100: 6d65 203d 2070 2e6e 616d 650a 2020 2020  me = p.name.    
-00007110: 2020 2020 656c 6966 2063 656e 7465 7220      elif center 
-00007120: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00007130: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00007140: 4572 726f 7228 2250 6f72 7420 6e65 6564  Error("Port need
-00007150: 7320 6365 6e74 6572 2070 6172 616d 6574  s center paramet
-00007160: 6572 2028 782c 2079 2920 756d 2e22 290a  er (x, y) um.").
-00007170: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00007180: 2020 2020 2020 2020 2020 2070 203d 2050             p = P
-00007190: 6f72 7428 0a20 2020 2020 2020 2020 2020  ort(.           
-000071a0: 2020 2020 206e 616d 653d 6e61 6d65 2c0a       name=name,.
-000071b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000071c0: 6365 6e74 6572 3d63 656e 7465 722c 0a20  center=center,. 
-000071d0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-000071e0: 6964 7468 3d77 6964 7468 2c0a 2020 2020  idth=width,.    
-000071f0: 2020 2020 2020 2020 2020 2020 6f72 6965              orie
-00007200: 6e74 6174 696f 6e3d 6f72 6965 6e74 6174  ntation=orientat
-00007210: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00007220: 2020 2020 2070 6172 656e 743d 7365 6c66       parent=self
-00007230: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007240: 2020 6c61 7965 723d 6c61 7965 722c 0a20    layer=layer,. 
-00007250: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00007260: 6f72 745f 7479 7065 3d70 6f72 745f 7479  ort_type=port_ty
-00007270: 7065 206f 7220 226f 7074 6963 616c 222c  pe or "optical",
-00007280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007290: 2063 726f 7373 5f73 6563 7469 6f6e 3d63   cross_section=c
-000072a0: 726f 7373 5f73 6563 7469 6f6e 2c0a 2020  ross_section,.  
-000072b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000072c0: 2020 2020 6966 206e 616d 6520 6973 206e      if name is n
-000072d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000072e0: 2020 2020 2070 2e6e 616d 6520 3d20 6e61       p.name = na
-000072f0: 6d65 0a20 2020 2020 2020 2069 6620 702e  me.        if p.
-00007300: 6e61 6d65 2069 6e20 7365 6c66 2e70 6f72  name in self.por
-00007310: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00007320: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00007330: 2866 2261 6464 5f70 6f72 7428 2920 506f  (f"add_port() Po
-00007340: 7274 206e 616d 6520 7b70 2e6e 616d 6521  rt name {p.name!
-00007350: 727d 2065 7869 7374 7320 696e 207b 7365  r} exists in {se
-00007360: 6c66 2e6e 616d 6521 727d 2229 0a0a 2020  lf.name!r}")..  
-00007370: 2020 2020 2020 7365 6c66 2e70 6f72 7473        self.ports
-00007380: 5b70 2e6e 616d 655d 203d 2070 0a20 2020  [p.name] = p.   
-00007390: 2020 2020 2072 6574 7572 6e20 700a 0a20       return p.. 
-000073a0: 2020 2064 6566 2061 6464 5f70 6f72 7473     def add_ports
-000073b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000073c0: 2020 2020 2020 2020 706f 7274 733a 2055          ports: U
-000073d0: 6e69 6f6e 5b4c 6973 745b 506f 7274 5d2c  nion[List[Port],
-000073e0: 2044 6963 745b 7374 722c 2050 6f72 745d   Dict[str, Port]
-000073f0: 5d2c 0a20 2020 2020 2020 2070 7265 6669  ],.        prefi
-00007400: 783a 2073 7472 203d 2022 222c 0a20 2020  x: str = "",.   
-00007410: 2020 2020 2073 7566 6669 783a 2073 7472       suffix: str
-00007420: 203d 2022 222c 0a20 2020 2020 2020 202a   = "",.        *
-00007430: 2a6b 7761 7267 732c 0a20 2020 2029 202d  *kwargs,.    ) -
-00007440: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00007450: 2222 2241 6464 2061 206c 6973 7420 6f72  """Add a list or
-00007460: 2064 6963 7420 6f66 2070 6f72 7473 2e0a   dict of ports..
-00007470: 0a20 2020 2020 2020 2079 6f75 2063 616e  .        you can
-00007480: 2069 6e63 6c75 6465 2061 2070 7265 6669   include a prefi
-00007490: 7820 746f 2061 6464 2074 6f20 7468 6520  x to add to the 
-000074a0: 6e65 7720 706f 7274 206e 616d 6573 2074  new port names t
-000074b0: 6f20 6176 6f69 6420 6e61 6d65 2063 6f6e  o avoid name con
-000074c0: 666c 6963 7473 2e0a 0a20 2020 2020 2020  flicts...       
-000074d0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-000074e0: 2020 2070 6f72 7473 3a20 6c69 7374 206f     ports: list o
-000074f0: 7220 6469 6374 206f 6620 706f 7274 732e  r dict of ports.
-00007500: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
-00007510: 6669 783a 2074 6f20 7072 6570 656e 6420  fix: to prepend 
-00007520: 746f 2065 6163 6820 706f 7274 206e 616d  to each port nam
-00007530: 652e 0a20 2020 2020 2020 2020 2020 2073  e..            s
-00007540: 7566 6669 783a 2074 6f20 6170 7065 6e64  uffix: to append
-00007550: 2074 6f20 6561 6368 2070 6f72 7420 6e61   to each port na
-00007560: 6d65 2e0a 2020 2020 2020 2020 2222 220a  me..        """.
-00007570: 2020 2020 2020 2020 706f 7274 7320 3d20          ports = 
-00007580: 706f 7274 7320 6966 2069 7369 6e73 7461  ports if isinsta
-00007590: 6e63 6528 706f 7274 732c 206c 6973 7429  nce(ports, list)
-000075a0: 2065 6c73 6520 706f 7274 732e 7661 6c75   else ports.valu
-000075b0: 6573 2829 0a20 2020 2020 2020 2066 6f72  es().        for
-000075c0: 2070 6f72 7420 696e 206c 6973 7428 706f   port in list(po
-000075d0: 7274 7329 3a0a 2020 2020 2020 2020 2020  rts):.          
-000075e0: 2020 6e61 6d65 203d 2066 227b 7072 6566    name = f"{pref
-000075f0: 6978 7d7b 706f 7274 2e6e 616d 657d 7b73  ix}{port.name}{s
-00007600: 7566 6669 787d 220a 2020 2020 2020 2020  uffix}".        
-00007610: 2020 2020 7365 6c66 2e61 6464 5f70 6f72      self.add_por
-00007620: 7428 6e61 6d65 3d6e 616d 652c 2070 6f72  t(name=name, por
-00007630: 743d 706f 7274 2c20 2a2a 6b77 6172 6773  t=port, **kwargs
-00007640: 290a 0a20 2020 2064 6566 2073 6e61 705f  )..    def snap_
-00007650: 706f 7274 735f 746f 5f67 7269 6428 7365  ports_to_grid(se
-00007660: 6c66 2c20 6e6d 3a20 696e 7420 3d20 3129  lf, nm: int = 1)
-00007670: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00007680: 2020 666f 7220 706f 7274 2069 6e20 7365    for port in se
-00007690: 6c66 2e70 6f72 7473 2e76 616c 7565 7328  lf.ports.values(
-000076a0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-000076b0: 6f72 742e 736e 6170 5f74 6f5f 6772 6964  ort.snap_to_grid
-000076c0: 286e 6d3d 6e6d 290a 0a20 2020 2064 6566  (nm=nm)..    def
-000076d0: 2072 656d 6f76 655f 6c61 7965 7273 280a   remove_layers(.
-000076e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000076f0: 2020 2020 2020 6c61 7965 7273 3a20 4c69        layers: Li
-00007700: 7374 5b4c 6179 6572 5370 6563 5d2c 0a20  st[LayerSpec],. 
-00007710: 2020 2020 2020 2069 6e63 6c75 6465 5f6c         include_l
-00007720: 6162 656c 733a 2062 6f6f 6c20 3d20 5472  abels: bool = Tr
-00007730: 7565 2c0a 2020 2020 2020 2020 696e 7665  ue,.        inve
-00007740: 7274 5f73 656c 6563 7469 6f6e 3a20 626f  rt_selection: bo
-00007750: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00007760: 2020 2020 7265 6375 7273 6976 653a 2062      recursive: b
-00007770: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00007780: 2920 2d3e 2043 6f6d 706f 6e65 6e74 3a0a  ) -> Component:.
-00007790: 2020 2020 2020 2020 2222 2252 656d 6f76          """Remov
-000077a0: 6520 6120 6c69 7374 206f 6620 6c61 7965  e a list of laye
-000077b0: 7273 2061 6e64 2072 6574 7572 6e73 2074  rs and returns t
-000077c0: 6865 2073 616d 6520 436f 6d70 6f6e 656e  he same Componen
-000077d0: 742e 0a0a 2020 2020 2020 2020 4172 6773  t...        Args
-000077e0: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
-000077f0: 7965 7273 3a20 6c69 7374 206f 6620 6c61  yers: list of la
-00007800: 7965 7273 2074 6f20 7265 6d6f 7665 2e0a  yers to remove..
-00007810: 2020 2020 2020 2020 2020 2020 696e 636c              incl
-00007820: 7564 655f 6c61 6265 6c73 3a20 7265 6d6f  ude_labels: remo
-00007830: 7665 206c 6162 656c 7320 6f6e 2074 686f  ve labels on tho
-00007840: 7365 206c 6179 6572 732e 0a20 2020 2020  se layers..     
-00007850: 2020 2020 2020 2069 6e76 6572 745f 7365         invert_se
-00007860: 6c65 6374 696f 6e3a 2072 656d 6f76 6573  lection: removes
-00007870: 2061 6c6c 206c 6179 6572 7320 6578 6365   all layers exce
-00007880: 7074 206c 6179 6572 7320 7370 6563 6966  pt layers specif
-00007890: 6965 642e 0a20 2020 2020 2020 2020 2020  ied..           
-000078a0: 2072 6563 7572 7369 7665 3a20 6f70 6572   recursive: oper
-000078b0: 6174 6520 6f6e 2074 6865 2063 656c 6c73  ate on the cells
-000078c0: 2069 6e63 6c75 6465 6420 696e 2074 6869   included in thi
-000078d0: 7320 6365 6c6c 2e0a 2020 2020 2020 2020  s cell..        
-000078e0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-000078f0: 2067 6473 6661 6374 6f72 7920 696d 706f   gdsfactory impo
-00007900: 7274 2067 6574 5f6c 6179 6572 0a0a 2020  rt get_layer..  
-00007910: 2020 2020 2020 636f 6d70 6f6e 656e 7420        component 
-00007920: 3d20 7365 6c66 2e66 6c61 7474 656e 2829  = self.flatten()
-00007930: 2069 6620 7265 6375 7273 6976 6520 616e   if recursive an
-00007940: 6420 7365 6c66 2e72 6566 6572 656e 6365  d self.reference
-00007950: 7320 656c 7365 2073 656c 660a 2020 2020  s else self.    
-00007960: 2020 2020 6c61 7965 7273 203d 205b 6765      layers = [ge
-00007970: 745f 6c61 7965 7228 6c61 7965 7229 2066  t_layer(layer) f
-00007980: 6f72 206c 6179 6572 2069 6e20 6c61 7965  or layer in laye
-00007990: 7273 5d0a 0a20 2020 2020 2020 2073 686f  rs]..        sho
-000079a0: 756c 645f 7265 6d6f 7665 203d 206e 6f74  uld_remove = not
-000079b0: 2069 6e76 6572 745f 7365 6c65 6374 696f   invert_selectio
-000079c0: 6e0a 2020 2020 2020 2020 636f 6d70 6f6e  n.        compon
-000079d0: 656e 742e 5f63 656c 6c2e 6669 6c74 6572  ent._cell.filter
-000079e0: 280a 2020 2020 2020 2020 2020 2020 7370  (.            sp
-000079f0: 6563 3d6c 6179 6572 732c 0a20 2020 2020  ec=layers,.     
-00007a00: 2020 2020 2020 2072 656d 6f76 653d 7368         remove=sh
-00007a10: 6f75 6c64 5f72 656d 6f76 652c 0a20 2020  ould_remove,.   
-00007a20: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
-00007a30: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
-00007a40: 2020 2020 7061 7468 733d 5472 7565 2c0a      paths=True,.
-00007a50: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
-00007a60: 6c73 3d69 6e63 6c75 6465 5f6c 6162 656c  ls=include_label
-00007a70: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
-00007a80: 2020 2020 2072 6574 7572 6e20 636f 6d70       return comp
-00007a90: 6f6e 656e 740a 0a20 2020 2064 6566 2065  onent..    def e
-00007aa0: 7874 7261 6374 280a 2020 2020 2020 2020  xtract(.        
-00007ab0: 7365 6c66 2c0a 2020 2020 2020 2020 6c61  self,.        la
-00007ac0: 7965 7273 3a20 4c69 7374 5b55 6e69 6f6e  yers: List[Union
-00007ad0: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-00007ae0: 2c20 7374 725d 5d2c 0a20 2020 2029 202d  , str]],.    ) -
-00007af0: 3e20 436f 6d70 6f6e 656e 743a 0a20 2020  > Component:.   
-00007b00: 2020 2020 2022 2222 4578 7472 6163 7420       """Extract 
-00007b10: 706f 6c79 676f 6e73 2066 726f 6d20 6120  polygons from a 
-00007b20: 436f 6d70 6f6e 656e 7420 616e 6420 7265  Component and re
-00007b30: 7475 726e 7320 6120 6e65 7720 436f 6d70  turns a new Comp
-00007b40: 6f6e 656e 742e 2222 220a 2020 2020 2020  onent.""".      
-00007b50: 2020 6672 6f6d 2067 6473 6661 6374 6f72    from gdsfactor
-00007b60: 792e 7064 6b20 696d 706f 7274 2067 6574  y.pdk import get
-00007b70: 5f6c 6179 6572 0a0a 2020 2020 2020 2020  _layer..        
-00007b80: 6966 2074 7970 6528 6c61 7965 7273 2920  if type(layers) 
-00007b90: 6e6f 7420 696e 2028 6c69 7374 2c20 7475  not in (list, tu
-00007ba0: 706c 6529 3a0a 2020 2020 2020 2020 2020  ple):.          
-00007bb0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00007bc0: 6f72 2866 226c 6179 6572 7320 7b6c 6179  or(f"layers {lay
-00007bd0: 6572 7321 727d 206e 6565 6473 2074 6f20  ers!r} needs to 
-00007be0: 6265 2061 206c 6973 7420 6f72 2074 7570  be a list or tup
-00007bf0: 6c65 2229 0a0a 2020 2020 2020 2020 6c61  le")..        la
-00007c00: 7965 7273 203d 205b 6765 745f 6c61 7965  yers = [get_laye
-00007c10: 7228 6c61 7965 7229 2066 6f72 206c 6179  r(layer) for lay
-00007c20: 6572 2069 6e20 6c61 7965 7273 5d0a 2020  er in layers].  
-00007c30: 2020 2020 2020 2320 636f 6d70 6f6e 656e        # componen
-00007c40: 7420 3d20 7365 6c66 2e63 6f70 7928 290a  t = self.copy().
-00007c50: 2020 2020 2020 2020 2320 636f 6d70 6f6e          # compon
-00007c60: 656e 742e 5f63 656c 6c2e 6669 6c74 6572  ent._cell.filter
-00007c70: 2873 7065 633d 6c61 7965 7273 2c20 7265  (spec=layers, re
-00007c80: 6d6f 7665 3d46 616c 7365 290a 0a20 2020  move=False)..   
-00007c90: 2020 2020 2063 6f6d 706f 6e65 6e74 203d       component =
-00007ca0: 2043 6f6d 706f 6e65 6e74 2829 0a20 2020   Component().   
-00007cb0: 2020 2020 2070 6f6c 795f 6469 6374 203d       poly_dict =
-00007cc0: 2073 656c 662e 6765 745f 706f 6c79 676f   self.get_polygo
-00007cd0: 6e73 2862 795f 7370 6563 3d54 7275 652c  ns(by_spec=True,
-00007ce0: 2069 6e63 6c75 6465 5f70 6174 6873 3d46   include_paths=F
-00007cf0: 616c 7365 290a 0a20 2020 2020 2020 2066  alse)..        f
-00007d00: 6f72 206c 6179 6572 2069 6e20 6c61 7965  or layer in laye
-00007d10: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-00007d20: 6966 206c 6179 6572 2069 6e20 706f 6c79  if layer in poly
-00007d30: 5f64 6963 743a 0a20 2020 2020 2020 2020  _dict:.         
-00007d40: 2020 2020 2020 2070 6f6c 7967 6f6e 7320         polygons 
-00007d50: 3d20 706f 6c79 5f64 6963 745b 6c61 7965  = poly_dict[laye
-00007d60: 725d 0a20 2020 2020 2020 2020 2020 2020  r].             
-00007d70: 2020 2066 6f72 2070 6f6c 7967 6f6e 2069     for polygon i
-00007d80: 6e20 706f 6c79 676f 6e73 3a0a 2020 2020  n polygons:.    
-00007d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007da0: 636f 6d70 6f6e 656e 742e 6164 645f 706f  component.add_po
-00007db0: 6c79 676f 6e28 706f 6c79 676f 6e2c 206c  lygon(polygon, l
-00007dc0: 6179 6572 290a 0a20 2020 2020 2020 2066  ayer)..        f
-00007dd0: 6f72 206c 6179 6572 2069 6e20 6c61 7965  or layer in laye
-00007de0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-00007df0: 666f 7220 7061 7468 2069 6e20 7365 6c66  for path in self
-00007e00: 2e5f 6365 6c6c 2e67 6574 5f70 6174 6873  ._cell.get_paths
-00007e10: 286c 6179 6572 3d6c 6179 6572 293a 0a20  (layer=layer):. 
-00007e20: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00007e30: 6f6d 706f 6e65 6e74 2e61 6464 2870 6174  omponent.add(pat
-00007e40: 6829 0a0a 2020 2020 2020 2020 7265 7475  h)..        retu
-00007e50: 726e 2063 6f6d 706f 6e65 6e74 0a0a 2020  rn component..  
-00007e60: 2020 6465 6620 6164 645f 706f 6c79 676f    def add_polygo
-00007e70: 6e28 7365 6c66 2c20 706f 696e 7473 2c20  n(self, points, 
-00007e80: 6c61 7965 723d 6e70 2e6e 616e 293a 0a20  layer=np.nan):. 
-00007e90: 2020 2020 2020 2022 2222 4164 6473 2061         """Adds a
-00007ea0: 2050 6f6c 7967 6f6e 2074 6f20 7468 6520   Polygon to the 
-00007eb0: 436f 6d70 6f6e 656e 742e 0a0a 2020 2020  Component...    
-00007ec0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00007ed0: 2020 2020 2020 706f 696e 7473 3a20 436f        points: Co
-00007ee0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-00007ef0: 2076 6572 7469 6365 7320 6f66 2074 6865   vertices of the
-00007f00: 2050 6f6c 7967 6f6e 2e0a 2020 2020 2020   Polygon..      
-00007f10: 2020 2020 2020 6c61 7965 723a 206c 6179        layer: lay
-00007f20: 6572 2073 7065 6320 746f 2061 6464 2070  er spec to add p
-00007f30: 6f6c 7967 6f6e 206f 6e2e 0a20 2020 2020  olygon on..     
-00007f40: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00007f50: 726f 6d20 6764 7366 6163 746f 7279 2e70  rom gdsfactory.p
-00007f60: 646b 2069 6d70 6f72 7420 6765 745f 6c61  dk import get_la
-00007f70: 7965 720a 0a20 2020 2020 2020 206c 6179  yer..        lay
-00007f80: 6572 203d 2067 6574 5f6c 6179 6572 286c  er = get_layer(l
-00007f90: 6179 6572 290a 0a20 2020 2020 2020 2069  ayer)..        i
-00007fa0: 6620 6c61 7965 7220 6973 204e 6f6e 653a  f layer is None:
-00007fb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00007fc0: 7572 6e20 4e6f 6e65 0a0a 2020 2020 2020  urn None..      
-00007fd0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00007fe0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00007ff0: 286c 6179 6572 2c20 7365 7429 3a0a 2020  (layer, set):.  
-00008000: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00008010: 7475 726e 205b 7365 6c66 2e61 6464 5f70  turn [self.add_p
-00008020: 6f6c 7967 6f6e 2870 6f69 6e74 732c 206c  olygon(points, l
-00008030: 7929 2066 6f72 206c 7920 696e 206c 6179  y) for ly in lay
-00008040: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
-00008050: 656c 6966 2061 6c6c 2869 7369 6e73 7461  elif all(isinsta
-00008060: 6e63 6528 6c79 2c20 284c 6179 6572 2929  nce(ly, (Layer))
-00008070: 2066 6f72 206c 7920 696e 206c 6179 6572   for ly in layer
-00008080: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00008090: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
-000080a0: 6164 645f 706f 6c79 676f 6e28 706f 696e  add_polygon(poin
-000080b0: 7473 2c20 6c79 2920 666f 7220 6c79 2069  ts, ly) for ly i
-000080c0: 6e20 6c61 7965 725d 0a20 2020 2020 2020  n layer].       
-000080d0: 2020 2020 2065 6c69 6620 6c65 6e28 6c61       elif len(la
-000080e0: 7965 7229 203e 2032 3a20 2023 2053 6f6d  yer) > 2:  # Som
-000080f0: 656f 6e65 2077 726f 7465 2065 2e67 2e20  eone wrote e.g. 
-00008100: 6c61 7965 7220 3d20 5b31 2c34 2c35 5d0a  layer = [1,4,5].
-00008110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008120: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00008130: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008140: 2020 2020 2020 2222 2220 5b50 4849 444c        """ [PHIDL
-00008150: 5d20 4966 2073 7065 6369 6679 696e 6720  ] If specifying 
-00008160: 6d75 6c74 6970 6c65 206c 6179 6572 730a  multiple layers.
-00008170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008180: 796f 7520 6d75 7374 2075 7365 2073 6574  you must use set
-00008190: 206e 6f74 6174 696f 6e2c 2065 2e67 2e20   notation, e.g. 
-000081a0: 7b31 2c35 2c38 7d20 2222 220a 2020 2020  {1,5,8} """.    
-000081b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000081c0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-000081d0: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
-000081e0: 2020 2020 7061 7373 0a0a 2020 2020 2020      pass..      
-000081f0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00008200: 706f 696e 7473 2c20 6764 7374 6b2e 506f  points, gdstk.Po
-00008210: 6c79 676f 6e29 3a0a 2020 2020 2020 2020  lygon):.        
-00008220: 2020 2020 2320 6966 206c 6179 6572 2069      # if layer i
-00008230: 7320 756e 7370 6563 6966 6965 6420 6f72  s unspecified or
-00008240: 206d 6174 6368 6573 206f 7269 6769 6e61   matches origina
-00008250: 6c20 706f 6c79 676f 6e2c 206a 7573 7420  l polygon, just 
-00008260: 6164 6420 6974 2061 732d 6973 0a20 2020  add it as-is.   
-00008270: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
-00008280: 203d 2070 6f69 6e74 730a 2020 2020 2020   = points.      
-00008290: 2020 2020 2020 6966 206c 6179 6572 2069        if layer i
-000082a0: 7320 6e70 2e6e 616e 206f 7220 280a 2020  s np.nan or (.  
-000082b0: 2020 2020 2020 2020 2020 2020 2020 6973                is
-000082c0: 696e 7374 616e 6365 286c 6179 6572 2c20  instance(layer, 
-000082d0: 7475 706c 6529 2061 6e64 2028 706f 6c79  tuple) and (poly
-000082e0: 676f 6e2e 6c61 7965 722c 2070 6f6c 7967  gon.layer, polyg
-000082f0: 6f6e 2e64 6174 6174 7970 6529 203d 3d20  on.datatype) == 
-00008300: 6c61 7965 720a 2020 2020 2020 2020 2020  layer.          
-00008310: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00008320: 2020 2020 2070 6f6c 7967 6f6e 203d 2050       polygon = P
-00008330: 6f6c 7967 6f6e 2870 6f6c 7967 6f6e 2e70  olygon(polygon.p
-00008340: 6f69 6e74 732c 2070 6f6c 7967 6f6e 2e6c  oints, polygon.l
-00008350: 6179 6572 2c20 706f 6c79 676f 6e2e 6461  ayer, polygon.da
-00008360: 7461 7479 7065 290a 2020 2020 2020 2020  tatype).        
-00008370: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00008380: 2020 2020 2020 2020 2020 6c61 7965 722c            layer,
-00008390: 2064 6174 6174 7970 6520 3d20 5f70 6172   datatype = _par
-000083a0: 7365 5f6c 6179 6572 286c 6179 6572 290a  se_layer(layer).
-000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083c0: 706f 6c79 676f 6e20 3d20 506f 6c79 676f  polygon = Polygo
-000083d0: 6e28 706f 6c79 676f 6e2e 706f 696e 7473  n(polygon.points
-000083e0: 2c20 6c61 7965 722c 2064 6174 6174 7970  , layer, datatyp
-000083f0: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
-00008400: 6966 2068 6173 6174 7472 2870 6f69 6e74  if hasattr(point
-00008410: 732c 2022 7072 6f70 6572 7469 6573 2229  s, "properties")
-00008420: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00008430: 2020 706f 6c79 676f 6e2e 7072 6f70 6572    polygon.proper
-00008440: 7469 6573 203d 2064 6565 7063 6f70 7928  ties = deepcopy(
-00008450: 706f 696e 7473 2e70 726f 7065 7274 6965  points.propertie
-00008460: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00008470: 7365 6c66 2e5f 6164 645f 706f 6c79 676f  self._add_polygo
-00008480: 6e73 2870 6f6c 7967 6f6e 290a 2020 2020  ns(polygon).    
-00008490: 2020 2020 2020 2020 7265 7475 726e 2070          return p
-000084a0: 6f6c 7967 6f6e 0a0a 2020 2020 2020 2020  olygon..        
-000084b0: 656c 6966 2068 6173 6174 7472 2870 6f69  elif hasattr(poi
-000084c0: 6e74 732c 2022 6765 6f6d 7322 293a 0a20  nts, "geoms"):. 
-000084d0: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-000084e0: 656f 6d20 696e 2070 6f69 6e74 732e 6765  eom in points.ge
-000084f0: 6f6d 733a 0a20 2020 2020 2020 2020 2020  oms:.           
-00008500: 2020 2020 2070 6f6c 7967 6f6e 203d 2073       polygon = s
-00008510: 656c 662e 6164 645f 706f 6c79 676f 6e28  elf.add_polygon(
-00008520: 6765 6f6d 2c20 6c61 7965 723d 6c61 7965  geom, layer=laye
-00008530: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
-00008540: 6574 7572 6e20 706f 6c79 676f 6e0a 2020  eturn polygon.  
-00008550: 2020 2020 2020 656c 6966 2068 6173 6174        elif hasat
-00008560: 7472 2870 6f69 6e74 732c 2022 6578 7465  tr(points, "exte
-00008570: 7269 6f72 2229 3a20 2023 2070 6f69 6e74  rior"):  # point
-00008580: 7320 6973 2061 2073 6861 7065 6c79 2050  s is a shapely P
-00008590: 6f6c 7967 6f6e 0a20 2020 2020 2020 2020  olygon.         
-000085a0: 2020 206c 6179 6572 2c20 6461 7461 7479     layer, dataty
-000085b0: 7065 203d 205f 7061 7273 655f 6c61 7965  pe = _parse_laye
-000085c0: 7228 6c61 7965 7229 0a20 2020 2020 2020  r(layer).       
-000085d0: 2020 2020 2070 6f69 6e74 735f 6f6e 5f67       points_on_g
-000085e0: 7269 6420 3d20 6e70 2e72 6f75 6e64 2870  rid = np.round(p
-000085f0: 6f69 6e74 732e 6578 7465 7269 6f72 2e63  oints.exterior.c
-00008600: 6f6f 7264 732c 2033 290a 2020 2020 2020  oords, 3).      
-00008610: 2020 2020 2020 706f 6c79 676f 6e20 3d20        polygon = 
-00008620: 6764 7374 6b2e 506f 6c79 676f 6e28 706f  gdstk.Polygon(po
-00008630: 696e 7473 5f6f 6e5f 6772 6964 2c20 6c61  ints_on_grid, la
-00008640: 7965 722c 2064 6174 6174 7970 6529 0a0a  yer, datatype)..
-00008650: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00008660: 6f69 6e74 732e 696e 7465 7269 6f72 733a  oints.interiors:
-00008670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008680: 2066 726f 6d20 7368 6170 656c 7920 696d   from shapely im
-00008690: 706f 7274 2067 6574 5f63 6f6f 7264 696e  port get_coordin
-000086a0: 6174 6573 0a0a 2020 2020 2020 2020 2020  ates..          
-000086b0: 2020 2020 2020 706f 696e 7473 5f6f 6e5f        points_on_
-000086c0: 6772 6964 5f69 6e74 6572 696f 7220 3d20  grid_interior = 
-000086d0: 6e70 2e72 6f75 6e64 2867 6574 5f63 6f6f  np.round(get_coo
-000086e0: 7264 696e 6174 6573 2870 6f69 6e74 732e  rdinates(points.
-000086f0: 696e 7465 7269 6f72 7329 2c20 3329 0a20  interiors), 3). 
-00008700: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00008710: 6f6c 7967 6f6e 5f69 6e74 6572 696f 7220  olygon_interior 
-00008720: 3d20 6764 7374 6b2e 506f 6c79 676f 6e28  = gdstk.Polygon(
-00008730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008740: 2020 2020 2070 6f69 6e74 735f 6f6e 5f67       points_on_g
-00008750: 7269 645f 696e 7465 7269 6f72 2c20 6c61  rid_interior, la
-00008760: 7965 722c 2064 6174 6174 7970 650a 2020  yer, datatype.  
-00008770: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00008780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008790: 706f 6c79 676f 6e73 203d 2067 6473 746b  polygons = gdstk
-000087a0: 2e62 6f6f 6c65 616e 280a 2020 2020 2020  .boolean(.      
-000087b0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-000087c0: 6c79 676f 6e2c 0a20 2020 2020 2020 2020  lygon,.         
-000087d0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-000087e0: 6f6e 5f69 6e74 6572 696f 722c 0a20 2020  on_interior,.   
+00005550: 2020 2020 2072 2e72 6f74 6174 696f 6e2c       r.rotation,
+00005560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005570: 2020 2020 2020 2020 2072 2e78 5f72 6566           r.x_ref
+00005580: 6c65 6374 696f 6e2c 0a20 2020 2020 2020  lection,.       
+00005590: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000055a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055b0: 2020 206e 6577 5f70 6f72 742e 6365 6e74     new_port.cent
+000055c0: 6572 203d 206e 6577 5f63 656e 7465 720a  er = new_center.
+000055d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055e0: 2020 2020 6e65 775f 706f 7274 2e6e 6577      new_port.new
+000055f0: 5f6f 7269 656e 7461 7469 6f6e 203d 206e  _orientation = n
+00005600: 6577 5f6f 7269 656e 7461 7469 6f6e 0a20  ew_orientation. 
+00005610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005620: 2020 2072 6566 5f70 6f72 7473 5f74 7261     ref_ports_tra
+00005630: 6e73 666f 726d 6564 2e61 7070 656e 6428  nsformed.append(
+00005640: 6e65 775f 706f 7274 290a 2020 2020 2020  new_port).      
+00005650: 2020 2020 2020 2020 2020 706f 7274 5f6c            port_l
+00005660: 6973 7420 2b3d 2072 6566 5f70 6f72 7473  ist += ref_ports
+00005670: 5f74 7261 6e73 666f 726d 6564 0a0a 2020  _transformed..  
+00005680: 2020 2020 2020 7265 7475 726e 2070 6f72        return por
+00005690: 745f 6c69 7374 0a0a 2020 2020 6465 6620  t_list..    def 
+000056a0: 6765 745f 706f 7274 735f 6469 6374 2873  get_ports_dict(s
+000056b0: 656c 662c 202a 2a6b 7761 7267 7329 202d  elf, **kwargs) -
+000056c0: 3e20 4469 6374 5b73 7472 2c20 506f 7274  > Dict[str, Port
+000056d0: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+000056e0: 7475 726e 7320 6120 6469 6374 206f 6620  turns a dict of 
+000056f0: 706f 7274 732e 0a0a 2020 2020 2020 2020  ports...        
+00005700: 4b65 7977 6f72 6420 4172 6773 3a0a 2020  Keyword Args:.  
+00005710: 2020 2020 2020 2020 2020 6c61 7965 723a            layer:
+00005720: 2070 6f72 7420 4744 5320 6c61 7965 722e   port GDS layer.
+00005730: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00005740: 6669 783a 2073 656c 6563 7420 706f 7274  fix: select port
+00005750: 7320 7769 7468 2070 7265 6669 7820 696e  s with prefix in
+00005760: 2070 6f72 7420 6e61 6d65 2e0a 2020 2020   port name..    
+00005770: 2020 2020 2020 2020 7375 6666 6978 3a20          suffix: 
+00005780: 7365 6c65 6374 2070 6f72 7473 2077 6974  select ports wit
+00005790: 6820 706f 7274 206e 616d 6520 7375 6666  h port name suff
+000057a0: 6978 2e0a 2020 2020 2020 2020 2020 2020  ix..            
+000057b0: 6f72 6965 6e74 6174 696f 6e3a 2073 656c  orientation: sel
+000057c0: 6563 7420 706f 7274 7320 7769 7468 206f  ect ports with o
+000057d0: 7269 656e 7461 7469 6f6e 2069 6e20 6465  rientation in de
+000057e0: 6772 6565 732e 0a20 2020 2020 2020 2020  grees..         
+000057f0: 2020 2077 6964 7468 3a20 7365 6c65 6374     width: select
+00005800: 2070 6f72 7473 2077 6974 6820 706f 7274   ports with port
+00005810: 2077 6964 7468 2e0a 2020 2020 2020 2020   width..        
+00005820: 2020 2020 6c61 7965 7273 5f65 7863 6c75      layers_exclu
+00005830: 6465 643a 204c 6973 7420 6f66 206c 6179  ded: List of lay
+00005840: 6572 7320 746f 2065 7863 6c75 6465 2e0a  ers to exclude..
+00005850: 2020 2020 2020 2020 2020 2020 706f 7274              port
+00005860: 5f74 7970 653a 2073 656c 6563 7420 706f  _type: select po
+00005870: 7274 7320 7769 7468 2070 6f72 745f 7479  rts with port_ty
+00005880: 7065 2028 6f70 7469 6361 6c2c 2065 6c65  pe (optical, ele
+00005890: 6374 7269 6361 6c2c 2076 6572 7469 6361  ctrical, vertica
+000058a0: 6c5f 7465 292e 0a20 2020 2020 2020 2020  l_te)..         
+000058b0: 2020 2063 6c6f 636b 7769 7365 3a20 6966     clockwise: if
+000058c0: 2054 7275 652c 2073 6f72 7420 706f 7274   True, sort port
+000058d0: 7320 636c 6f63 6b77 6973 652c 2046 616c  s clockwise, Fal
+000058e0: 7365 3a20 636f 756e 7465 722d 636c 6f63  se: counter-cloc
+000058f0: 6b77 6973 652e 0a20 2020 2020 2020 2022  kwise..        "
+00005900: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00005910: 6e20 7365 6c65 6374 5f70 6f72 7473 2873  n select_ports(s
+00005920: 656c 662e 706f 7274 732c 202a 2a6b 7761  elf.ports, **kwa
+00005930: 7267 7329 0a0a 2020 2020 6465 6620 6765  rgs)..    def ge
+00005940: 745f 706f 7274 735f 6c69 7374 2873 656c  t_ports_list(sel
+00005950: 662c 202a 2a6b 7761 7267 7329 202d 3e20  f, **kwargs) -> 
+00005960: 4c69 7374 5b50 6f72 745d 3a0a 2020 2020  List[Port]:.    
+00005970: 2020 2020 2222 2252 6574 7572 6e73 206c      """Returns l
+00005980: 6973 7420 6f66 2070 6f72 7473 2e0a 0a20  ist of ports... 
+00005990: 2020 2020 2020 204b 6579 776f 7264 2041         Keyword A
+000059a0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+000059b0: 206c 6179 6572 3a20 7365 6c65 6374 2070   layer: select p
+000059c0: 6f72 7473 2077 6974 6820 4744 5320 6c61  orts with GDS la
+000059d0: 7965 722e 0a20 2020 2020 2020 2020 2020  yer..           
+000059e0: 2070 7265 6669 783a 2073 656c 6563 7420   prefix: select 
+000059f0: 706f 7274 7320 7769 7468 2070 7265 6669  ports with prefi
+00005a00: 7820 696e 2070 6f72 7420 6e61 6d65 2e0a  x in port name..
+00005a10: 2020 2020 2020 2020 2020 2020 7375 6666              suff
+00005a20: 6978 3a20 7365 6c65 6374 2070 6f72 7473  ix: select ports
+00005a30: 2077 6974 6820 706f 7274 206e 616d 6520   with port name 
+00005a40: 7375 6666 6978 2e0a 2020 2020 2020 2020  suffix..        
+00005a50: 2020 2020 6f72 6965 6e74 6174 696f 6e3a      orientation:
+00005a60: 2073 656c 6563 7420 706f 7274 7320 7769   select ports wi
+00005a70: 7468 206f 7269 656e 7461 7469 6f6e 2069  th orientation i
+00005a80: 6e20 6465 6772 6565 732e 0a20 2020 2020  n degrees..     
+00005a90: 2020 2020 2020 206f 7269 656e 7461 7469         orientati
+00005aa0: 6f6e 3a20 7365 6c65 6374 2070 6f72 7473  on: select ports
+00005ab0: 2077 6974 6820 6f72 6965 6e74 6174 696f   with orientatio
+00005ac0: 6e20 696e 2064 6567 7265 6573 2e0a 2020  n in degrees..  
+00005ad0: 2020 2020 2020 2020 2020 7769 6474 683a            width:
+00005ae0: 2073 656c 6563 7420 706f 7274 7320 7769   select ports wi
+00005af0: 7468 2070 6f72 7420 7769 6474 682e 0a20  th port width.. 
+00005b00: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00005b10: 735f 6578 636c 7564 6564 3a20 4c69 7374  s_excluded: List
+00005b20: 206f 6620 6c61 7965 7273 2074 6f20 6578   of layers to ex
+00005b30: 636c 7564 652e 0a20 2020 2020 2020 2020  clude..         
+00005b40: 2020 2070 6f72 745f 7479 7065 3a20 7365     port_type: se
+00005b50: 6c65 6374 2070 6f72 7473 2077 6974 6820  lect ports with 
+00005b60: 706f 7274 5f74 7970 6520 286f 7074 6963  port_type (optic
+00005b70: 616c 2c20 656c 6563 7472 6963 616c 2c20  al, electrical, 
+00005b80: 7665 7274 6963 616c 5f74 6529 2e0a 2020  vertical_te)..  
+00005b90: 2020 2020 2020 2020 2020 636c 6f63 6b77            clockw
+00005ba0: 6973 653a 2069 6620 5472 7565 2c20 736f  ise: if True, so
+00005bb0: 7274 2070 6f72 7473 2063 6c6f 636b 7769  rt ports clockwi
+00005bc0: 7365 2c20 4661 6c73 653a 2063 6f75 6e74  se, False: count
+00005bd0: 6572 2d63 6c6f 636b 7769 7365 2e0a 2020  er-clockwise..  
+00005be0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005bf0: 2020 7265 7475 726e 206c 6973 7428 7365    return list(se
+00005c00: 6c65 6374 5f70 6f72 7473 2873 656c 662e  lect_ports(self.
+00005c10: 706f 7274 732c 202a 2a6b 7761 7267 7329  ports, **kwargs)
+00005c20: 2e76 616c 7565 7328 2929 0a0a 2020 2020  .values())..    
+00005c30: 6465 6620 6765 745f 706f 7274 735f 7061  def get_ports_pa
+00005c40: 6e64 6173 2873 656c 6629 3a0a 2020 2020  ndas(self):.    
+00005c50: 2020 2020 696d 706f 7274 2070 616e 6461      import panda
+00005c60: 7320 6173 2070 640a 0a20 2020 2020 2020  s as pd..       
+00005c70: 2063 6f6c 5f73 7065 6320 3d20 5b0a 2020   col_spec = [.  
+00005c80: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00005c90: 2c0a 2020 2020 2020 2020 2020 2020 2277  ,.            "w
+00005ca0: 6964 7468 222c 0a20 2020 2020 2020 2020  idth",.         
+00005cb0: 2020 2022 6365 6e74 6572 222c 0a20 2020     "center",.   
+00005cc0: 2020 2020 2020 2020 2022 6f72 6965 6e74           "orient
+00005cd0: 6174 696f 6e22 2c0a 2020 2020 2020 2020  ation",.        
+00005ce0: 2020 2020 226c 6179 6572 222c 0a20 2020      "layer",.   
+00005cf0: 2020 2020 2020 2020 2022 706f 7274 5f74           "port_t
+00005d00: 7970 6522 2c0a 2020 2020 2020 2020 2020  ype",.          
+00005d10: 2020 2273 6865 6172 5f61 6e67 6c65 222c    "shear_angle",
+00005d20: 0a20 2020 2020 2020 205d 0a0a 2020 2020  .        ]..    
+00005d30: 2020 2020 7265 7475 726e 2070 642e 4461      return pd.Da
+00005d40: 7461 4672 616d 6528 0a20 2020 2020 2020  taFrame(.       
+00005d50: 2020 2020 205b 706f 7274 2e74 6f5f 6469       [port.to_di
+00005d60: 6374 2829 2066 6f72 2070 6f72 7420 696e  ct() for port in
+00005d70: 2073 656c 662e 6765 745f 706f 7274 735f   self.get_ports_
+00005d80: 6c69 7374 2829 5d2c 2063 6f6c 756d 6e73  list()], columns
+00005d90: 3d63 6f6c 5f73 7065 630a 2020 2020 2020  =col_spec.      
+00005da0: 2020 290a 0a20 2020 2064 6566 2067 6574    )..    def get
+00005db0: 5f70 6f72 7473 5f70 6f6c 6172 7328 7365  _ports_polars(se
+00005dc0: 6c66 293a 0a20 2020 2020 2020 2069 6d70  lf):.        imp
+00005dd0: 6f72 7420 706f 6c61 7273 2061 7320 706c  ort polars as pl
+00005de0: 0a0a 2020 2020 2020 2020 636f 6c5f 7370  ..        col_sp
+00005df0: 6563 203d 207b 0a20 2020 2020 2020 2020  ec = {.         
+00005e00: 2020 2022 6e61 6d65 223a 2070 6c2e 5574     "name": pl.Ut
+00005e10: 6638 2c0a 2020 2020 2020 2020 2020 2020  f8,.            
+00005e20: 2277 6964 7468 223a 2070 6c2e 466c 6f61  "width": pl.Floa
+00005e30: 7436 342c 0a20 2020 2020 2020 2020 2020  t64,.           
+00005e40: 2022 6365 6e74 6572 223a 2070 6c2e 4c69   "center": pl.Li
+00005e50: 7374 2870 6c2e 466c 6f61 7436 3429 2c0a  st(pl.Float64),.
+00005e60: 2020 2020 2020 2020 2020 2020 226f 7269              "ori
+00005e70: 656e 7461 7469 6f6e 223a 2070 6c2e 466c  entation": pl.Fl
+00005e80: 6f61 7436 342c 0a20 2020 2020 2020 2020  oat64,.         
+00005e90: 2020 2022 6c61 7965 7222 3a20 706c 2e4c     "layer": pl.L
+00005ea0: 6973 7428 706c 2e55 496e 7431 3629 2c0a  ist(pl.UInt16),.
+00005eb0: 2020 2020 2020 2020 2020 2020 2270 6f72              "por
+00005ec0: 745f 7479 7065 223a 2070 6c2e 5574 6638  t_type": pl.Utf8
+00005ed0: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+00005ee0: 6865 6172 5f61 6e67 6c65 223a 2070 6c2e  hear_angle": pl.
+00005ef0: 466c 6f61 7436 342c 0a20 2020 2020 2020  Float64,.       
+00005f00: 207d 0a0a 2020 2020 2020 2020 7265 7475   }..        retu
+00005f10: 726e 2070 6c2e 4461 7461 4672 616d 6528  rn pl.DataFrame(
+00005f20: 0a20 2020 2020 2020 2020 2020 205b 706f  .            [po
+00005f30: 7274 2e74 6f5f 6469 6374 2829 2066 6f72  rt.to_dict() for
+00005f40: 2070 6f72 7420 696e 2073 656c 662e 6765   port in self.ge
+00005f50: 745f 706f 7274 735f 6c69 7374 2829 5d2c  t_ports_list()],
+00005f60: 2073 6368 656d 613d 636f 6c5f 7370 6563   schema=col_spec
+00005f70: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00005f80: 6465 6620 7265 6628 0a20 2020 2020 2020  def ref(.       
+00005f90: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00005fa0: 6f73 6974 696f 6e3a 2043 6f6f 7264 696e  osition: Coordin
+00005fb0: 6174 6520 3d20 2830 2c20 3029 2c0a 2020  ate = (0, 0),.  
+00005fc0: 2020 2020 2020 706f 7274 5f69 643a 204f        port_id: O
+00005fd0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00005fe0: 6f6e 652c 0a20 2020 2020 2020 2072 6f74  one,.        rot
+00005ff0: 6174 696f 6e3a 2066 6c6f 6174 203d 2030  ation: float = 0
+00006000: 2c0a 2020 2020 2020 2020 685f 6d69 7272  ,.        h_mirr
+00006010: 6f72 3a20 626f 6f6c 203d 2046 616c 7365  or: bool = False
+00006020: 2c0a 2020 2020 2020 2020 765f 6d69 7272  ,.        v_mirr
+00006030: 6f72 3a20 626f 6f6c 203d 2046 616c 7365  or: bool = False
+00006040: 2c0a 2020 2020 2920 2d3e 2043 6f6d 706f  ,.    ) -> Compo
+00006050: 6e65 6e74 5265 6665 7265 6e63 653a 0a20  nentReference:. 
+00006060: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00006070: 7320 436f 6d70 6f6e 656e 7420 7265 6665  s Component refe
+00006080: 7265 6e63 652e 0a0a 2020 2020 2020 2020  rence...        
+00006090: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+000060a0: 2020 706f 7369 7469 6f6e 3a20 782c 2079    position: x, y
+000060b0: 2070 6f73 6974 696f 6e2e 0a20 2020 2020   position..     
+000060c0: 2020 2020 2020 2070 6f72 745f 6964 3a20         port_id: 
+000060d0: 6e61 6d65 206f 6620 7468 6520 706f 7274  name of the port
+000060e0: 2e0a 2020 2020 2020 2020 2020 2020 726f  ..            ro
+000060f0: 7461 7469 6f6e 3a20 696e 2064 6567 7265  tation: in degre
+00006100: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
+00006110: 685f 6d69 7272 6f72 3a20 686f 7269 7a6f  h_mirror: horizo
+00006120: 6e74 616c 206d 6972 726f 7220 7573 696e  ntal mirror usin
+00006130: 6720 7920 6178 6973 2028 782c 2031 2920  g y axis (x, 1) 
+00006140: 2831 2c20 3029 2e0a 2020 2020 2020 2020  (1, 0)..        
+00006150: 2020 2020 2020 2020 5468 6973 2069 7320          This is 
+00006160: 7468 6520 6d6f 7374 2063 6f6d 6d6f 6e20  the most common 
+00006170: 6d69 7272 6f72 2e0a 2020 2020 2020 2020  mirror..        
+00006180: 2020 2020 765f 6d69 7272 6f72 3a20 7665      v_mirror: ve
+00006190: 7274 6963 616c 206d 6972 726f 7220 7573  rtical mirror us
+000061a0: 696e 6720 7820 6178 6973 2028 312c 2079  ing x axis (1, y
+000061b0: 2920 2830 2c20 7929 2e0a 2020 2020 2020  ) (0, y)..      
+000061c0: 2020 2222 220a 2020 2020 2020 2020 5f72    """.        _r
+000061d0: 6566 203d 2043 6f6d 706f 6e65 6e74 5265  ef = ComponentRe
+000061e0: 6665 7265 6e63 6528 7365 6c66 290a 0a20  ference(self).. 
+000061f0: 2020 2020 2020 2069 6620 706f 7274 5f69         if port_i
+00006200: 6420 616e 6420 706f 7274 5f69 6420 6e6f  d and port_id no
+00006210: 7420 696e 2073 656c 662e 706f 7274 733a  t in self.ports:
+00006220: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00006230: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00006240: 706f 7274 207b 706f 7274 5f69 647d 206e  port {port_id} n
+00006250: 6f74 2069 6e20 7b73 656c 662e 706f 7274  ot in {self.port
+00006260: 732e 6b65 7973 2829 7d22 290a 0a20 2020  s.keys()}")..   
+00006270: 2020 2020 206f 7269 6769 6e20 3d20 7365       origin = se
+00006280: 6c66 2e70 6f72 7473 5b70 6f72 745f 6964  lf.ports[port_id
+00006290: 5d2e 6365 6e74 6572 2069 6620 706f 7274  ].center if port
+000062a0: 5f69 6420 656c 7365 2028 302c 2030 290a  _id else (0, 0).
+000062b0: 2020 2020 2020 2020 6966 2068 5f6d 6972          if h_mir
+000062c0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+000062d0: 205f 7265 662e 6d69 7272 6f72 5f78 2870   _ref.mirror_x(p
+000062e0: 6f72 745f 6964 290a 0a20 2020 2020 2020  ort_id)..       
+000062f0: 2069 6620 765f 6d69 7272 6f72 3a0a 2020   if v_mirror:.  
+00006300: 2020 2020 2020 2020 2020 5f72 6566 2e6d            _ref.m
+00006310: 6972 726f 725f 7928 706f 7274 5f69 6429  irror_y(port_id)
+00006320: 0a0a 2020 2020 2020 2020 6966 2072 6f74  ..        if rot
+00006330: 6174 696f 6e20 213d 2030 3a0a 2020 2020  ation != 0:.    
+00006340: 2020 2020 2020 2020 5f72 6566 2e72 6f74          _ref.rot
+00006350: 6174 6528 726f 7461 7469 6f6e 2c20 6f72  ate(rotation, or
+00006360: 6967 696e 290a 2020 2020 2020 2020 5f72  igin).        _r
+00006370: 6566 2e6d 6f76 6528 6f72 6967 696e 2c20  ef.move(origin, 
+00006380: 706f 7369 7469 6f6e 290a 0a20 2020 2020  position)..     
+00006390: 2020 2072 6574 7572 6e20 5f72 6566 0a0a     return _ref..
+000063a0: 2020 2020 6465 6620 7265 665f 6365 6e74      def ref_cent
+000063b0: 6572 2873 656c 662c 2070 6f73 6974 696f  er(self, positio
+000063c0: 6e3d 2830 2c20 3029 293a 0a20 2020 2020  n=(0, 0)):.     
+000063d0: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+000063e0: 7265 6665 7265 6e63 6520 6f66 2074 6865  reference of the
+000063f0: 2063 6f6d 706f 6e65 6e74 2063 656e 7465   component cente
+00006400: 7265 6420 6174 2028 783d 302c 2079 3d30  red at (x=0, y=0
+00006410: 292e 2222 220a 2020 2020 2020 2020 7369  ).""".        si
+00006420: 203d 2073 656c 662e 7369 7a65 5f69 6e66   = self.size_inf
+00006430: 6f0a 2020 2020 2020 2020 7963 203d 2073  o.        yc = s
+00006440: 692e 736f 7574 6820 2b20 7369 2e68 6569  i.south + si.hei
+00006450: 6768 7420 2f20 320a 2020 2020 2020 2020  ght / 2.        
+00006460: 7863 203d 2073 692e 7765 7374 202b 2073  xc = si.west + s
+00006470: 692e 7769 6474 6820 2f20 320a 2020 2020  i.width / 2.    
+00006480: 2020 2020 6365 6e74 6572 203d 2028 7863      center = (xc
+00006490: 2c20 7963 290a 2020 2020 2020 2020 5f72  , yc).        _r
+000064a0: 6566 203d 2043 6f6d 706f 6e65 6e74 5265  ef = ComponentRe
+000064b0: 6665 7265 6e63 6528 7365 6c66 290a 2020  ference(self).  
+000064c0: 2020 2020 2020 5f72 6566 2e6d 6f76 6528        _ref.move(
+000064d0: 6365 6e74 6572 2c20 706f 7369 7469 6f6e  center, position
+000064e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000064f0: 205f 7265 660a 0a20 2020 2064 6566 205f   _ref..    def _
+00006500: 5f72 6570 725f 5f28 7365 6c66 2920 2d3e  _repr__(self) ->
+00006510: 2073 7472 3a0a 2020 2020 2020 2020 2222   str:.        ""
+00006520: 2252 6574 7572 6e20 6120 7374 7269 6e67  "Return a string
+00006530: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
+00006540: 6f66 2074 6865 206f 626a 6563 742e 2222  of the object.""
+00006550: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00006560: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
+00006570: 227b 7365 6c66 2e6e 616d 657d 3a20 7569  "{self.name}: ui
+00006580: 6420 7b73 656c 662e 7569 647d 2c20 220a  d {self.uid}, ".
+00006590: 2020 2020 2020 2020 2020 2020 6622 706f              f"po
+000065a0: 7274 7320 7b6c 6973 7428 7365 6c66 2e70  rts {list(self.p
+000065b0: 6f72 7473 2e6b 6579 7328 2929 7d2c 2022  orts.keys())}, "
+000065c0: 0a20 2020 2020 2020 2020 2020 2066 2272  .            f"r
+000065d0: 6566 6572 656e 6365 7320 7b6c 6973 7428  eferences {list(
+000065e0: 7365 6c66 2e6e 616d 6564 5f72 6566 6572  self.named_refer
+000065f0: 656e 6365 732e 6b65 7973 2829 297d 2c20  ences.keys())}, 
+00006600: 220a 2020 2020 2020 2020 2020 2020 6622  ".            f"
+00006610: 7b6c 656e 2873 656c 662e 706f 6c79 676f  {len(self.polygo
+00006620: 6e73 297d 2070 6f6c 7967 6f6e 7322 0a20  ns)} polygons". 
+00006630: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00006640: 6620 7070 7269 6e74 2873 656c 6629 202d  f pprint(self) -
+00006650: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00006660: 2222 2250 7269 6e74 7320 636f 6d70 6f6e  """Prints compon
+00006670: 656e 7420 696e 666f 2e22 2222 0a20 2020  ent info.""".   
+00006680: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00006690: 2020 2020 2020 6672 6f6d 2072 6963 6820        from rich 
+000066a0: 696d 706f 7274 2070 7265 7474 790a 0a20  import pretty.. 
+000066b0: 2020 2020 2020 2020 2020 2070 7265 7474             prett
+000066c0: 792e 696e 7374 616c 6c28 290a 2020 2020  y.install().    
+000066d0: 2020 2020 2020 2020 7072 6574 7479 2e70          pretty.p
+000066e0: 7072 696e 7428 7365 6c66 2e74 6f5f 6469  print(self.to_di
+000066f0: 6374 2829 290a 2020 2020 2020 2020 6578  ct()).        ex
+00006700: 6365 7074 2049 6d70 6f72 7445 7272 6f72  cept ImportError
+00006710: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00006720: 696e 7428 7961 6d6c 2e64 756d 7028 7365  int(yaml.dump(se
+00006730: 6c66 2e74 6f5f 6469 6374 2829 2929 0a0a  lf.to_dict()))..
+00006740: 2020 2020 6465 6620 7070 7269 6e74 5f70      def pprint_p
+00006750: 6f72 7473 2873 656c 6629 202d 3e20 4e6f  orts(self) -> No
+00006760: 6e65 3a0a 2020 2020 2020 2020 2222 2250  ne:.        """P
+00006770: 7269 6e74 7320 636f 6d70 6f6e 656e 7420  rints component 
+00006780: 6e65 746c 6973 7473 2e22 2222 0a20 2020  netlists.""".   
+00006790: 2020 2020 2070 6f72 7473 5f6c 6973 7420       ports_list 
+000067a0: 3d20 7365 6c66 2e67 6574 5f70 6f72 7473  = self.get_ports
+000067b0: 5f6c 6973 7428 290a 2020 2020 2020 2020  _list().        
+000067c0: 666f 7220 706f 7274 2069 6e20 706f 7274  for port in port
+000067d0: 735f 6c69 7374 3a0a 2020 2020 2020 2020  s_list:.        
+000067e0: 2020 2020 7072 696e 7428 706f 7274 290a      print(port).
+000067f0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00006800: 2020 2064 6566 206d 6574 6164 6174 615f     def metadata_
+00006810: 6368 696c 6428 7365 6c66 2920 2d3e 2044  child(self) -> D
+00006820: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
+00006830: 5265 7475 726e 7320 6d65 7461 6461 7461  Returns metadata
+00006840: 2066 726f 6d20 6368 696c 6420 6966 2061   from child if a
+00006850: 6e79 2c20 4f74 6865 7277 6973 6520 7265  ny, Otherwise re
+00006860: 7475 726e 7320 636f 6d70 6f6e 656e 7420  turns component 
+00006870: 6f77 6e2e 0a0a 2020 2020 2020 2020 6d65  own...        me
+00006880: 7461 6461 7461 2047 7265 6174 2074 6f20  tadata Great to 
+00006890: 6163 6365 7373 2074 6865 2063 6869 6c64  access the child
+000068a0: 7265 6e20 6d65 7461 6461 7461 2061 7420  ren metadata at 
+000068b0: 7468 6520 626f 7474 6f6d 206f 6620 7468  the bottom of th
+000068c0: 650a 2020 2020 2020 2020 6869 6572 6172  e.        hierar
+000068d0: 6368 792e 0a20 2020 2020 2020 2022 2222  chy..        """
+000068e0: 0a20 2020 2020 2020 2073 6574 7469 6e67  .        setting
+000068f0: 7320 3d20 6469 6374 2873 656c 662e 7365  s = dict(self.se
+00006900: 7474 696e 6773 290a 0a20 2020 2020 2020  ttings)..       
+00006910: 2077 6869 6c65 2073 6574 7469 6e67 732e   while settings.
+00006920: 6765 7428 2263 6869 6c64 2229 3a0a 2020  get("child"):.  
+00006930: 2020 2020 2020 2020 2020 7365 7474 696e            settin
+00006940: 6773 203d 2073 6574 7469 6e67 732e 6765  gs = settings.ge
+00006950: 7428 2263 6869 6c64 2229 0a0a 2020 2020  t("child")..    
+00006960: 2020 2020 7265 7475 726e 2064 6963 7428      return dict(
+00006970: 7365 7474 696e 6773 290a 0a20 2020 2040  settings)..    @
+00006980: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00006990: 206d 6574 6164 6174 6128 7365 6c66 2920   metadata(self) 
+000069a0: 2d3e 2044 6963 743a 0a20 2020 2020 2020  -> Dict:.       
+000069b0: 2072 6574 7572 6e20 6469 6374 2873 656c   return dict(sel
+000069c0: 662e 7365 7474 696e 6773 290a 0a20 2020  f.settings)..   
+000069d0: 2064 6566 2061 6464 5f70 6f72 7428 0a20   def add_port(. 
+000069e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000069f0: 2020 2020 206e 616d 653a 204f 7074 696f       name: Optio
+00006a00: 6e61 6c5b 556e 696f 6e5b 7374 722c 206f  nal[Union[str, o
+00006a10: 626a 6563 745d 5d20 3d20 4e6f 6e65 2c0a  bject]] = None,.
+00006a20: 2020 2020 2020 2020 6365 6e74 6572 3a20          center: 
+00006a30: 4f70 7469 6f6e 616c 5b54 7570 6c65 5b66  Optional[Tuple[f
+00006a40: 6c6f 6174 2c20 666c 6f61 745d 5d20 3d20  loat, float]] = 
+00006a50: 4e6f 6e65 2c0a 2020 2020 2020 2020 7769  None,.        wi
+00006a60: 6474 683a 204f 7074 696f 6e61 6c5b 666c  dth: Optional[fl
+00006a70: 6f61 745d 203d 204e 6f6e 652c 0a20 2020  oat] = None,.   
+00006a80: 2020 2020 206f 7269 656e 7461 7469 6f6e       orientation
+00006a90: 3a20 4f70 7469 6f6e 616c 5b66 6c6f 6174  : Optional[float
+00006aa0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00006ab0: 2020 706f 7274 3a20 4f70 7469 6f6e 616c    port: Optional
+00006ac0: 5b50 6f72 745d 203d 204e 6f6e 652c 0a20  [Port] = None,. 
+00006ad0: 2020 2020 2020 206c 6179 6572 3a20 4f70         layer: Op
+00006ae0: 7469 6f6e 616c 5b4c 6179 6572 5370 6563  tional[LayerSpec
+00006af0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00006b00: 2020 706f 7274 5f74 7970 653a 204f 7074    port_type: Opt
+00006b10: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00006b20: 652c 0a20 2020 2020 2020 2063 726f 7373  e,.        cross
+00006b30: 5f73 6563 7469 6f6e 3a20 4f70 7469 6f6e  _section: Option
+00006b40: 616c 5b43 726f 7373 5365 6374 696f 6e5d  al[CrossSection]
+00006b50: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00006b60: 3e20 506f 7274 3a0a 2020 2020 2020 2020  > Port:.        
+00006b70: 2222 2241 6464 2070 6f72 7420 746f 2063  """Add port to c
+00006b80: 6f6d 706f 6e65 6e74 2e0a 0a20 2020 2020  omponent...     
+00006b90: 2020 2059 6f75 2063 616e 2063 6f70 7920     You can copy 
+00006ba0: 616e 2065 7869 7374 696e 6720 706f 7274  an existing port
+00006bb0: 206c 696b 6520 6164 645f 706f 7274 2870   like add_port(p
+00006bc0: 6f72 7420 3d20 6578 6973 7469 6e67 5f70  ort = existing_p
+00006bd0: 6f72 7429 206f 720a 2020 2020 2020 2020  ort) or.        
+00006be0: 6372 6561 7465 2061 206e 6577 2070 6f72  create a new por
+00006bf0: 7420 6164 645f 706f 7274 286d 796e 616d  t add_port(mynam
+00006c00: 652c 206d 7963 656e 7465 722c 206d 7977  e, mycenter, myw
+00006c10: 6964 7468 2c20 6d79 6f72 6965 6e74 6174  idth, myorientat
+00006c20: 696f 6e29 2e0a 2020 2020 2020 2020 596f  ion)..        Yo
+00006c30: 7520 6361 6e20 616c 736f 2063 6f70 7920  u can also copy 
+00006c40: 616e 2065 7869 7374 696e 6720 706f 7274  an existing port
+00006c50: 0a20 2020 2020 2020 2077 6974 6820 6120  .        with a 
+00006c60: 6e65 7720 6e61 6d65 2061 6464 5f70 6f72  new name add_por
+00006c70: 7428 706f 7274 203d 2065 7869 7374 696e  t(port = existin
+00006c80: 675f 706f 7274 2c20 6e61 6d65 203d 206e  g_port, name = n
+00006c90: 6577 5f6e 616d 6529 0a0a 2020 2020 2020  ew_name)..      
+00006ca0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00006cb0: 2020 2020 6e61 6d65 3a20 706f 7274 206e      name: port n
+00006cc0: 616d 652e 0a20 2020 2020 2020 2020 2020  ame..           
+00006cd0: 2063 656e 7465 723a 2078 2c20 792e 0a20   center: x, y.. 
+00006ce0: 2020 2020 2020 2020 2020 2077 6964 7468             width
+00006cf0: 3a20 696e 2075 6d2e 0a20 2020 2020 2020  : in um..       
+00006d00: 2020 2020 206f 7269 656e 7461 7469 6f6e       orientation
+00006d10: 3a20 696e 2064 6567 2e0a 2020 2020 2020  : in deg..      
+00006d20: 2020 2020 2020 706f 7274 3a20 6f70 7469        port: opti
+00006d30: 6f6e 616c 2070 6f72 742e 0a20 2020 2020  onal port..     
+00006d40: 2020 2020 2020 206c 6179 6572 3a20 706f         layer: po
+00006d50: 7274 206c 6179 6572 2e0a 2020 2020 2020  rt layer..      
+00006d60: 2020 2020 2020 706f 7274 5f74 7970 653a        port_type:
+00006d70: 206f 7074 6963 616c 2c20 656c 6563 7472   optical, electr
+00006d80: 6963 616c 2c20 7665 7274 6963 616c 5f64  ical, vertical_d
+00006d90: 632c 2076 6572 7469 6361 6c5f 7465 2c20  c, vertical_te, 
+00006da0: 7665 7274 6963 616c 5f74 6d2e 2044 6566  vertical_tm. Def
+00006db0: 6175 6c74 7320 746f 206f 7074 6963 616c  aults to optical
+00006dc0: 2e0a 2020 2020 2020 2020 2020 2020 6372  ..            cr
+00006dd0: 6f73 735f 7365 6374 696f 6e3a 2070 6f72  oss_section: por
+00006de0: 7420 6372 6f73 735f 7365 6374 696f 6e2e  t cross_section.
+00006df0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00006e00: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
+00006e10: 746f 7279 2e70 646b 2069 6d70 6f72 7420  tory.pdk import 
+00006e20: 6765 745f 6c61 7965 720a 0a20 2020 2020  get_layer..     
+00006e30: 2020 206c 6179 6572 203d 2067 6574 5f6c     layer = get_l
+00006e40: 6179 6572 286c 6179 6572 290a 0a20 2020  ayer(layer)..   
+00006e50: 2020 2020 2069 6620 706f 7274 3a0a 2020       if port:.  
+00006e60: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00006e70: 2069 7369 6e73 7461 6e63 6528 706f 7274   isinstance(port
+00006e80: 2c20 506f 7274 293a 0a20 2020 2020 2020  , Port):.       
+00006e90: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00006ea0: 616c 7565 4572 726f 7228 6622 6164 645f  alueError(f"add_
+00006eb0: 706f 7274 2829 206e 6565 6473 2061 2050  port() needs a P
+00006ec0: 6f72 742c 2067 6f74 207b 7479 7065 2870  ort, got {type(p
+00006ed0: 6f72 7429 7d22 290a 2020 2020 2020 2020  ort)}").        
+00006ee0: 2020 2020 7020 3d20 706f 7274 2e63 6f70      p = port.cop
+00006ef0: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
+00006f00: 6966 206e 616d 6520 6973 206e 6f74 204e  if name is not N
+00006f10: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00006f20: 2020 2020 2070 2e6e 616d 6520 3d20 6e61       p.name = na
+00006f30: 6d65 0a20 2020 2020 2020 2020 2020 2069  me.            i
+00006f40: 6620 6365 6e74 6572 2069 7320 6e6f 7420  f center is not 
+00006f50: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00006f60: 2020 2020 2020 702e 6365 6e74 6572 203d        p.center =
+00006f70: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
+00006f80: 2020 2020 6966 2077 6964 7468 2069 7320      if width is 
+00006f90: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00006fa0: 2020 2020 2020 2020 2020 702e 7769 6474            p.widt
+00006fb0: 6820 3d20 7769 6474 680a 2020 2020 2020  h = width.      
+00006fc0: 2020 2020 2020 6966 206f 7269 656e 7461        if orienta
+00006fd0: 7469 6f6e 2069 7320 6e6f 7420 4e6f 6e65  tion is not None
+00006fe0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006ff0: 2020 702e 6f72 6965 6e74 6174 696f 6e20    p.orientation 
+00007000: 3d20 6f72 6965 6e74 6174 696f 6e0a 2020  = orientation.  
+00007010: 2020 2020 2020 2020 2020 6966 2070 6f72            if por
+00007020: 745f 7479 7065 2069 7320 6e6f 7420 4e6f  t_type is not No
+00007030: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00007040: 2020 2020 702e 706f 7274 5f74 7970 6520      p.port_type 
+00007050: 3d20 706f 7274 5f74 7970 650a 2020 2020  = port_type.    
+00007060: 2020 2020 2020 2020 6966 206c 6179 6572          if layer
+00007070: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00007080: 2020 2020 2020 2020 2020 2020 2020 702e                p.
+00007090: 6c61 7965 7220 3d20 6c61 7965 720a 2020  layer = layer.  
+000070a0: 2020 2020 2020 2020 2020 702e 7061 7265            p.pare
+000070b0: 6e74 203d 2073 656c 660a 0a20 2020 2020  nt = self..     
+000070c0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000070d0: 6365 286e 616d 652c 2050 6f72 7429 3a0a  ce(name, Port):.
+000070e0: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
+000070f0: 6e61 6d65 2e63 6f70 7928 290a 2020 2020  name.copy().    
+00007100: 2020 2020 2020 2020 702e 7061 7265 6e74          p.parent
+00007110: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
+00007120: 2020 2020 6e61 6d65 203d 2070 2e6e 616d      name = p.nam
+00007130: 650a 2020 2020 2020 2020 656c 6966 2063  e.        elif c
+00007140: 656e 7465 7220 6973 204e 6f6e 653a 0a20  enter is None:. 
+00007150: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00007160: 2056 616c 7565 4572 726f 7228 2250 6f72   ValueError("Por
+00007170: 7420 6e65 6564 7320 6365 6e74 6572 2070  t needs center p
+00007180: 6172 616d 6574 6572 2028 782c 2079 2920  arameter (x, y) 
+00007190: 756d 2e22 290a 0a20 2020 2020 2020 2065  um.")..        e
+000071a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000071b0: 2070 203d 2050 6f72 7428 0a20 2020 2020   p = Port(.     
+000071c0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+000071d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+000071e0: 2020 2020 2020 6365 6e74 6572 3d63 656e        center=cen
+000071f0: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
+00007200: 2020 2020 2077 6964 7468 3d77 6964 7468       width=width
+00007210: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00007220: 2020 6f72 6965 6e74 6174 696f 6e3d 6f72    orientation=or
+00007230: 6965 6e74 6174 696f 6e2c 0a20 2020 2020  ientation,.     
+00007240: 2020 2020 2020 2020 2020 2070 6172 656e             paren
+00007250: 743d 7365 6c66 2c0a 2020 2020 2020 2020  t=self,.        
+00007260: 2020 2020 2020 2020 6c61 7965 723d 6c61          layer=la
+00007270: 7965 722c 0a20 2020 2020 2020 2020 2020  yer,.           
+00007280: 2020 2020 2070 6f72 745f 7479 7065 3d70       port_type=p
+00007290: 6f72 745f 7479 7065 206f 7220 226f 7074  ort_type or "opt
+000072a0: 6963 616c 222c 0a20 2020 2020 2020 2020  ical",.         
+000072b0: 2020 2020 2020 2063 726f 7373 5f73 6563         cross_sec
+000072c0: 7469 6f6e 3d63 726f 7373 5f73 6563 7469  tion=cross_secti
+000072d0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+000072e0: 290a 2020 2020 2020 2020 6966 206e 616d  ).        if nam
+000072f0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00007300: 2020 2020 2020 2020 2020 2070 2e6e 616d             p.nam
+00007310: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
+00007320: 2069 6620 702e 6e61 6d65 2069 6e20 7365   if p.name in se
+00007330: 6c66 2e70 6f72 7473 3a0a 2020 2020 2020  lf.ports:.      
+00007340: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00007350: 6545 7272 6f72 2866 2261 6464 5f70 6f72  eError(f"add_por
+00007360: 7428 2920 506f 7274 206e 616d 6520 7b70  t() Port name {p
+00007370: 2e6e 616d 6521 727d 2065 7869 7374 7320  .name!r} exists 
+00007380: 696e 207b 7365 6c66 2e6e 616d 6521 727d  in {self.name!r}
+00007390: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
+000073a0: 2e70 6f72 7473 5b70 2e6e 616d 655d 203d  .ports[p.name] =
+000073b0: 2070 0a20 2020 2020 2020 2072 6574 7572   p.        retur
+000073c0: 6e20 700a 0a20 2020 2064 6566 2061 6464  n p..    def add
+000073d0: 5f70 6f72 7473 280a 2020 2020 2020 2020  _ports(.        
+000073e0: 7365 6c66 2c0a 2020 2020 2020 2020 706f  self,.        po
+000073f0: 7274 733a 2055 6e69 6f6e 5b4c 6973 745b  rts: Union[List[
+00007400: 506f 7274 5d2c 2044 6963 745b 7374 722c  Port], Dict[str,
+00007410: 2050 6f72 745d 5d2c 0a20 2020 2020 2020   Port]],.       
+00007420: 2070 7265 6669 783a 2073 7472 203d 2022   prefix: str = "
+00007430: 222c 0a20 2020 2020 2020 2073 7566 6669  ",.        suffi
+00007440: 783a 2073 7472 203d 2022 222c 0a20 2020  x: str = "",.   
+00007450: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+00007460: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00007470: 2020 2020 2020 2222 2241 6464 2061 206c        """Add a l
+00007480: 6973 7420 6f72 2064 6963 7420 6f66 2070  ist or dict of p
+00007490: 6f72 7473 2e0a 0a20 2020 2020 2020 2079  orts...        y
+000074a0: 6f75 2063 616e 2069 6e63 6c75 6465 2061  ou can include a
+000074b0: 2070 7265 6669 7820 746f 2061 6464 2074   prefix to add t
+000074c0: 6f20 7468 6520 6e65 7720 706f 7274 206e  o the new port n
+000074d0: 616d 6573 2074 6f20 6176 6f69 6420 6e61  ames to avoid na
+000074e0: 6d65 2063 6f6e 666c 6963 7473 2e0a 0a20  me conflicts... 
+000074f0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00007500: 2020 2020 2020 2020 2070 6f72 7473 3a20           ports: 
+00007510: 6c69 7374 206f 7220 6469 6374 206f 6620  list or dict of 
+00007520: 706f 7274 732e 0a20 2020 2020 2020 2020  ports..         
+00007530: 2020 2070 7265 6669 783a 2074 6f20 7072     prefix: to pr
+00007540: 6570 656e 6420 746f 2065 6163 6820 706f  epend to each po
+00007550: 7274 206e 616d 652e 0a20 2020 2020 2020  rt name..       
+00007560: 2020 2020 2073 7566 6669 783a 2074 6f20       suffix: to 
+00007570: 6170 7065 6e64 2074 6f20 6561 6368 2070  append to each p
+00007580: 6f72 7420 6e61 6d65 2e0a 2020 2020 2020  ort name..      
+00007590: 2020 2222 220a 2020 2020 2020 2020 706f    """.        po
+000075a0: 7274 7320 3d20 706f 7274 7320 6966 2069  rts = ports if i
+000075b0: 7369 6e73 7461 6e63 6528 706f 7274 732c  sinstance(ports,
+000075c0: 206c 6973 7429 2065 6c73 6520 706f 7274   list) else port
+000075d0: 732e 7661 6c75 6573 2829 0a20 2020 2020  s.values().     
+000075e0: 2020 2066 6f72 2070 6f72 7420 696e 206c     for port in l
+000075f0: 6973 7428 706f 7274 7329 3a0a 2020 2020  ist(ports):.    
+00007600: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
+00007610: 227b 7072 6566 6978 7d7b 706f 7274 2e6e  "{prefix}{port.n
+00007620: 616d 657d 7b73 7566 6669 787d 220a 2020  ame}{suffix}".  
+00007630: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00007640: 6464 5f70 6f72 7428 6e61 6d65 3d6e 616d  dd_port(name=nam
+00007650: 652c 2070 6f72 743d 706f 7274 2c20 2a2a  e, port=port, **
+00007660: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00007670: 2073 6e61 705f 706f 7274 735f 746f 5f67   snap_ports_to_g
+00007680: 7269 6428 7365 6c66 2c20 6e6d 3a20 696e  rid(self, nm: in
+00007690: 7420 3d20 3129 202d 3e20 4e6f 6e65 3a0a  t = 1) -> None:.
+000076a0: 2020 2020 2020 2020 666f 7220 706f 7274          for port
+000076b0: 2069 6e20 7365 6c66 2e70 6f72 7473 2e76   in self.ports.v
+000076c0: 616c 7565 7328 293a 0a20 2020 2020 2020  alues():.       
+000076d0: 2020 2020 2070 6f72 742e 736e 6170 5f74       port.snap_t
+000076e0: 6f5f 6772 6964 286e 6d3d 6e6d 290a 0a20  o_grid(nm=nm).. 
+000076f0: 2020 2064 6566 2072 656d 6f76 655f 6c61     def remove_la
+00007700: 7965 7273 280a 2020 2020 2020 2020 7365  yers(.        se
+00007710: 6c66 2c0a 2020 2020 2020 2020 6c61 7965  lf,.        laye
+00007720: 7273 3a20 4c69 7374 5b4c 6179 6572 5370  rs: List[LayerSp
+00007730: 6563 5d2c 0a20 2020 2020 2020 2069 6e63  ec],.        inc
+00007740: 6c75 6465 5f6c 6162 656c 733a 2062 6f6f  lude_labels: boo
+00007750: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
+00007760: 2020 696e 7665 7274 5f73 656c 6563 7469    invert_selecti
+00007770: 6f6e 3a20 626f 6f6c 203d 2046 616c 7365  on: bool = False
+00007780: 2c0a 2020 2020 2020 2020 7265 6375 7273  ,.        recurs
+00007790: 6976 653a 2062 6f6f 6c20 3d20 5472 7565  ive: bool = True
+000077a0: 2c0a 2020 2020 2920 2d3e 2043 6f6d 706f  ,.    ) -> Compo
+000077b0: 6e65 6e74 3a0a 2020 2020 2020 2020 2222  nent:.        ""
+000077c0: 2252 656d 6f76 6520 6120 6c69 7374 206f  "Remove a list o
+000077d0: 6620 6c61 7965 7273 2061 6e64 2072 6574  f layers and ret
+000077e0: 7572 6e73 2074 6865 2073 616d 6520 436f  urns the same Co
+000077f0: 6d70 6f6e 656e 742e 0a0a 2020 2020 2020  mponent...      
+00007800: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00007810: 2020 2020 6c61 7965 7273 3a20 6c69 7374      layers: list
+00007820: 206f 6620 6c61 7965 7273 2074 6f20 7265   of layers to re
+00007830: 6d6f 7665 2e0a 2020 2020 2020 2020 2020  move..          
+00007840: 2020 696e 636c 7564 655f 6c61 6265 6c73    include_labels
+00007850: 3a20 7265 6d6f 7665 206c 6162 656c 7320  : remove labels 
+00007860: 6f6e 2074 686f 7365 206c 6179 6572 732e  on those layers.
+00007870: 0a20 2020 2020 2020 2020 2020 2069 6e76  .            inv
+00007880: 6572 745f 7365 6c65 6374 696f 6e3a 2072  ert_selection: r
+00007890: 656d 6f76 6573 2061 6c6c 206c 6179 6572  emoves all layer
+000078a0: 7320 6578 6365 7074 206c 6179 6572 7320  s except layers 
+000078b0: 7370 6563 6966 6965 642e 0a20 2020 2020  specified..     
+000078c0: 2020 2020 2020 2072 6563 7572 7369 7665         recursive
+000078d0: 3a20 6f70 6572 6174 6520 6f6e 2074 6865  : operate on the
+000078e0: 2063 656c 6c73 2069 6e63 6c75 6465 6420   cells included 
+000078f0: 696e 2074 6869 7320 6365 6c6c 2e0a 2020  in this cell..  
+00007900: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00007910: 2020 6672 6f6d 2067 6473 6661 6374 6f72    from gdsfactor
+00007920: 7920 696d 706f 7274 2067 6574 5f6c 6179  y import get_lay
+00007930: 6572 0a0a 2020 2020 2020 2020 636f 6d70  er..        comp
+00007940: 6f6e 656e 7420 3d20 7365 6c66 2e66 6c61  onent = self.fla
+00007950: 7474 656e 2829 2069 6620 7265 6375 7273  tten() if recurs
+00007960: 6976 6520 616e 6420 7365 6c66 2e72 6566  ive and self.ref
+00007970: 6572 656e 6365 7320 656c 7365 2073 656c  erences else sel
+00007980: 660a 2020 2020 2020 2020 6c61 7965 7273  f.        layers
+00007990: 203d 205b 6765 745f 6c61 7965 7228 6c61   = [get_layer(la
+000079a0: 7965 7229 2066 6f72 206c 6179 6572 2069  yer) for layer i
+000079b0: 6e20 6c61 7965 7273 5d0a 0a20 2020 2020  n layers]..     
+000079c0: 2020 2073 686f 756c 645f 7265 6d6f 7665     should_remove
+000079d0: 203d 206e 6f74 2069 6e76 6572 745f 7365   = not invert_se
+000079e0: 6c65 6374 696f 6e0a 2020 2020 2020 2020  lection.        
+000079f0: 636f 6d70 6f6e 656e 742e 5f63 656c 6c2e  component._cell.
+00007a00: 6669 6c74 6572 280a 2020 2020 2020 2020  filter(.        
+00007a10: 2020 2020 7370 6563 3d6c 6179 6572 732c      spec=layers,
+00007a20: 0a20 2020 2020 2020 2020 2020 2072 656d  .            rem
+00007a30: 6f76 653d 7368 6f75 6c64 5f72 656d 6f76  ove=should_remov
+00007a40: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
+00007a50: 6f6c 7967 6f6e 733d 5472 7565 2c0a 2020  olygons=True,.  
+00007a60: 2020 2020 2020 2020 2020 7061 7468 733d            paths=
+00007a70: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00007a80: 2020 6c61 6265 6c73 3d69 6e63 6c75 6465    labels=include
+00007a90: 5f6c 6162 656c 732c 0a20 2020 2020 2020  _labels,.       
+00007aa0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00007ab0: 6e20 636f 6d70 6f6e 656e 740a 0a20 2020  n component..   
+00007ac0: 2064 6566 2065 7874 7261 6374 280a 2020   def extract(.  
+00007ad0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00007ae0: 2020 2020 6c61 7965 7273 3a20 4c69 7374      layers: List
+00007af0: 5b55 6e69 6f6e 5b54 7570 6c65 5b69 6e74  [Union[Tuple[int
+00007b00: 2c20 696e 745d 2c20 7374 725d 5d2c 0a20  , int], str]],. 
+00007b10: 2020 2029 202d 3e20 436f 6d70 6f6e 656e     ) -> Componen
+00007b20: 743a 0a20 2020 2020 2020 2022 2222 4578  t:.        """Ex
+00007b30: 7472 6163 7420 706f 6c79 676f 6e73 2066  tract polygons f
+00007b40: 726f 6d20 6120 436f 6d70 6f6e 656e 7420  rom a Component 
+00007b50: 616e 6420 7265 7475 726e 7320 6120 6e65  and returns a ne
+00007b60: 7720 436f 6d70 6f6e 656e 742e 2222 220a  w Component.""".
+00007b70: 2020 2020 2020 2020 6672 6f6d 2067 6473          from gds
+00007b80: 6661 6374 6f72 792e 7064 6b20 696d 706f  factory.pdk impo
+00007b90: 7274 2067 6574 5f6c 6179 6572 0a0a 2020  rt get_layer..  
+00007ba0: 2020 2020 2020 6966 2074 7970 6528 6c61        if type(la
+00007bb0: 7965 7273 2920 6e6f 7420 696e 2028 6c69  yers) not in (li
+00007bc0: 7374 2c20 7475 706c 6529 3a0a 2020 2020  st, tuple):.    
+00007bd0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00007be0: 6c75 6545 7272 6f72 2866 226c 6179 6572  lueError(f"layer
+00007bf0: 7320 7b6c 6179 6572 7321 727d 206e 6565  s {layers!r} nee
+00007c00: 6473 2074 6f20 6265 2061 206c 6973 7420  ds to be a list 
+00007c10: 6f72 2074 7570 6c65 2229 0a0a 2020 2020  or tuple")..    
+00007c20: 2020 2020 6c61 7965 7273 203d 205b 6765      layers = [ge
+00007c30: 745f 6c61 7965 7228 6c61 7965 7229 2066  t_layer(layer) f
+00007c40: 6f72 206c 6179 6572 2069 6e20 6c61 7965  or layer in laye
+00007c50: 7273 5d0a 2020 2020 2020 2020 2320 636f  rs].        # co
+00007c60: 6d70 6f6e 656e 7420 3d20 7365 6c66 2e63  mponent = self.c
+00007c70: 6f70 7928 290a 2020 2020 2020 2020 2320  opy().        # 
+00007c80: 636f 6d70 6f6e 656e 742e 5f63 656c 6c2e  component._cell.
+00007c90: 6669 6c74 6572 2873 7065 633d 6c61 7965  filter(spec=laye
+00007ca0: 7273 2c20 7265 6d6f 7665 3d46 616c 7365  rs, remove=False
+00007cb0: 290a 0a20 2020 2020 2020 2063 6f6d 706f  )..        compo
+00007cc0: 6e65 6e74 203d 2043 6f6d 706f 6e65 6e74  nent = Component
+00007cd0: 2829 0a20 2020 2020 2020 2070 6f6c 795f  ().        poly_
+00007ce0: 6469 6374 203d 2073 656c 662e 6765 745f  dict = self.get_
+00007cf0: 706f 6c79 676f 6e73 2862 795f 7370 6563  polygons(by_spec
+00007d00: 3d54 7275 652c 2069 6e63 6c75 6465 5f70  =True, include_p
+00007d10: 6174 6873 3d46 616c 7365 290a 0a20 2020  aths=False)..   
+00007d20: 2020 2020 2066 6f72 206c 6179 6572 2069       for layer i
+00007d30: 6e20 6c61 7965 7273 3a0a 2020 2020 2020  n layers:.      
+00007d40: 2020 2020 2020 6966 206c 6179 6572 2069        if layer i
+00007d50: 6e20 706f 6c79 5f64 6963 743a 0a20 2020  n poly_dict:.   
+00007d60: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+00007d70: 7967 6f6e 7320 3d20 706f 6c79 5f64 6963  ygons = poly_dic
+00007d80: 745b 6c61 7965 725d 0a20 2020 2020 2020  t[layer].       
+00007d90: 2020 2020 2020 2020 2066 6f72 2070 6f6c           for pol
+00007da0: 7967 6f6e 2069 6e20 706f 6c79 676f 6e73  ygon in polygons
+00007db0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007dc0: 2020 2020 2020 636f 6d70 6f6e 656e 742e        component.
+00007dd0: 6164 645f 706f 6c79 676f 6e28 706f 6c79  add_polygon(poly
+00007de0: 676f 6e2c 206c 6179 6572 290a 0a20 2020  gon, layer)..   
+00007df0: 2020 2020 2066 6f72 206c 6179 6572 2069       for layer i
+00007e00: 6e20 6c61 7965 7273 3a0a 2020 2020 2020  n layers:.      
+00007e10: 2020 2020 2020 666f 7220 7061 7468 2069        for path i
+00007e20: 6e20 7365 6c66 2e5f 6365 6c6c 2e67 6574  n self._cell.get
+00007e30: 5f70 6174 6873 286c 6179 6572 3d6c 6179  _paths(layer=lay
+00007e40: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+00007e50: 2020 2020 2063 6f6d 706f 6e65 6e74 2e61       component.a
+00007e60: 6464 2870 6174 6829 0a0a 2020 2020 2020  dd(path)..      
+00007e70: 2020 7265 7475 726e 2063 6f6d 706f 6e65    return compone
+00007e80: 6e74 0a0a 2020 2020 6465 6620 6164 645f  nt..    def add_
+00007e90: 706f 6c79 676f 6e28 7365 6c66 2c20 706f  polygon(self, po
+00007ea0: 696e 7473 2c20 6c61 7965 723d 6e70 2e6e  ints, layer=np.n
+00007eb0: 616e 293a 0a20 2020 2020 2020 2022 2222  an):.        """
+00007ec0: 4164 6473 2061 2050 6f6c 7967 6f6e 2074  Adds a Polygon t
+00007ed0: 6f20 7468 6520 436f 6d70 6f6e 656e 742e  o the Component.
+00007ee0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00007ef0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00007f00: 7473 3a20 436f 6f72 6469 6e61 7465 7320  ts: Coordinates 
+00007f10: 6f66 2074 6865 2076 6572 7469 6365 7320  of the vertices 
+00007f20: 6f66 2074 6865 2050 6f6c 7967 6f6e 2e0a  of the Polygon..
+00007f30: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+00007f40: 723a 206c 6179 6572 2073 7065 6320 746f  r: layer spec to
+00007f50: 2061 6464 2070 6f6c 7967 6f6e 206f 6e2e   add polygon on.
+00007f60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00007f70: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
+00007f80: 746f 7279 2e70 646b 2069 6d70 6f72 7420  tory.pdk import 
+00007f90: 6765 745f 6c61 7965 720a 0a20 2020 2020  get_layer..     
+00007fa0: 2020 206c 6179 6572 203d 2067 6574 5f6c     layer = get_l
+00007fb0: 6179 6572 286c 6179 6572 290a 0a20 2020  ayer(layer)..   
+00007fc0: 2020 2020 2069 6620 6c61 7965 7220 6973       if layer is
+00007fd0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00007fe0: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+00007ff0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00008000: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00008010: 7374 616e 6365 286c 6179 6572 2c20 7365  stance(layer, se
+00008020: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00008030: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
+00008040: 2e61 6464 5f70 6f6c 7967 6f6e 2870 6f69  .add_polygon(poi
+00008050: 6e74 732c 206c 7929 2066 6f72 206c 7920  nts, ly) for ly 
+00008060: 696e 206c 6179 6572 5d0a 2020 2020 2020  in layer].      
+00008070: 2020 2020 2020 656c 6966 2061 6c6c 2869        elif all(i
+00008080: 7369 6e73 7461 6e63 6528 6c79 2c20 284c  sinstance(ly, (L
+00008090: 6179 6572 2929 2066 6f72 206c 7920 696e  ayer)) for ly in
+000080a0: 206c 6179 6572 293a 0a20 2020 2020 2020   layer):.       
+000080b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000080c0: 5b73 656c 662e 6164 645f 706f 6c79 676f  [self.add_polygo
+000080d0: 6e28 706f 696e 7473 2c20 6c79 2920 666f  n(points, ly) fo
+000080e0: 7220 6c79 2069 6e20 6c61 7965 725d 0a20  r ly in layer]. 
+000080f0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00008100: 6c65 6e28 6c61 7965 7229 203e 2032 3a20  len(layer) > 2: 
+00008110: 2023 2053 6f6d 656f 6e65 2077 726f 7465   # Someone wrote
+00008120: 2065 2e67 2e20 6c61 7965 7220 3d20 5b31   e.g. layer = [1
+00008130: 2c34 2c35 5d0a 2020 2020 2020 2020 2020  ,4,5].          
+00008140: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00008150: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00008160: 2020 2020 2020 2020 2020 2020 2222 2220              """ 
+00008170: 5b50 4849 444c 5d20 4966 2073 7065 6369  [PHIDL] If speci
+00008180: 6679 696e 6720 6d75 6c74 6970 6c65 206c  fying multiple l
+00008190: 6179 6572 730a 2020 2020 2020 2020 2020  ayers.          
+000081a0: 2020 2020 2020 796f 7520 6d75 7374 2075        you must u
+000081b0: 7365 2073 6574 206e 6f74 6174 696f 6e2c  se set notation,
+000081c0: 2065 2e67 2e20 7b31 2c35 2c38 7d20 2222   e.g. {1,5,8} ""
+000081d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000081e0: 2020 290a 2020 2020 2020 2020 6578 6365    ).        exce
+000081f0: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
+00008200: 2020 2020 2020 2020 2020 7061 7373 0a0a            pass..
+00008210: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00008220: 7461 6e63 6528 706f 696e 7473 2c20 6764  tance(points, gd
+00008230: 7374 6b2e 506f 6c79 676f 6e29 3a0a 2020  stk.Polygon):.  
+00008240: 2020 2020 2020 2020 2020 2320 6966 206c            # if l
+00008250: 6179 6572 2069 7320 756e 7370 6563 6966  ayer is unspecif
+00008260: 6965 6420 6f72 206d 6174 6368 6573 206f  ied or matches o
+00008270: 7269 6769 6e61 6c20 706f 6c79 676f 6e2c  riginal polygon,
+00008280: 206a 7573 7420 6164 6420 6974 2061 732d   just add it as-
+00008290: 6973 0a20 2020 2020 2020 2020 2020 2070  is.            p
+000082a0: 6f6c 7967 6f6e 203d 2070 6f69 6e74 730a  olygon = points.
+000082b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000082c0: 6179 6572 2069 7320 6e70 2e6e 616e 206f  ayer is np.nan o
+000082d0: 7220 280a 2020 2020 2020 2020 2020 2020  r (.            
+000082e0: 2020 2020 6973 696e 7374 616e 6365 286c      isinstance(l
+000082f0: 6179 6572 2c20 7475 706c 6529 2061 6e64  ayer, tuple) and
+00008300: 2028 706f 6c79 676f 6e2e 6c61 7965 722c   (polygon.layer,
+00008310: 2070 6f6c 7967 6f6e 2e64 6174 6174 7970   polygon.datatyp
+00008320: 6529 203d 3d20 6c61 7965 720a 2020 2020  e) == layer.    
+00008330: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00008340: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
+00008350: 6f6e 203d 2050 6f6c 7967 6f6e 2870 6f6c  on = Polygon(pol
+00008360: 7967 6f6e 2e70 6f69 6e74 732c 2070 6f6c  ygon.points, pol
+00008370: 7967 6f6e 2e6c 6179 6572 2c20 706f 6c79  ygon.layer, poly
+00008380: 676f 6e2e 6461 7461 7479 7065 290a 2020  gon.datatype).  
+00008390: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083b0: 6c61 7965 722c 2064 6174 6174 7970 6520  layer, datatype 
+000083c0: 3d20 5f70 6172 7365 5f6c 6179 6572 286c  = _parse_layer(l
+000083d0: 6179 6572 290a 2020 2020 2020 2020 2020  ayer).          
+000083e0: 2020 2020 2020 706f 6c79 676f 6e20 3d20        polygon = 
+000083f0: 506f 6c79 676f 6e28 706f 6c79 676f 6e2e  Polygon(polygon.
+00008400: 706f 696e 7473 2c20 6c61 7965 722c 2064  points, layer, d
+00008410: 6174 6174 7970 6529 0a0a 2020 2020 2020  atatype)..      
+00008420: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+00008430: 2870 6f69 6e74 732c 2022 7072 6f70 6572  (points, "proper
+00008440: 7469 6573 2229 3a0a 2020 2020 2020 2020  ties"):.        
+00008450: 2020 2020 2020 2020 706f 6c79 676f 6e2e          polygon.
+00008460: 7072 6f70 6572 7469 6573 203d 2064 6565  properties = dee
+00008470: 7063 6f70 7928 706f 696e 7473 2e70 726f  pcopy(points.pro
+00008480: 7065 7274 6965 7329 0a0a 2020 2020 2020  perties)..      
+00008490: 2020 2020 2020 7365 6c66 2e5f 6164 645f        self._add_
+000084a0: 706f 6c79 676f 6e73 2870 6f6c 7967 6f6e  polygons(polygon
+000084b0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000084c0: 7475 726e 2070 6f6c 7967 6f6e 0a0a 2020  turn polygon..  
+000084d0: 2020 2020 2020 656c 6966 2068 6173 6174        elif hasat
+000084e0: 7472 2870 6f69 6e74 732c 2022 6765 6f6d  tr(points, "geom
+000084f0: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
+00008500: 2066 6f72 2067 656f 6d20 696e 2070 6f69   for geom in poi
+00008510: 6e74 732e 6765 6f6d 733a 0a20 2020 2020  nts.geoms:.     
+00008520: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
+00008530: 6f6e 203d 2073 656c 662e 6164 645f 706f  on = self.add_po
+00008540: 6c79 676f 6e28 6765 6f6d 2c20 6c61 7965  lygon(geom, laye
+00008550: 723d 6c61 7965 7229 0a20 2020 2020 2020  r=layer).       
+00008560: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
+00008570: 676f 6e0a 2020 2020 2020 2020 656c 6966  gon.        elif
+00008580: 2068 6173 6174 7472 2870 6f69 6e74 732c   hasattr(points,
+00008590: 2022 6578 7465 7269 6f72 2229 3a20 2023   "exterior"):  #
+000085a0: 2070 6f69 6e74 7320 6973 2061 2073 6861   points is a sha
+000085b0: 7065 6c79 2050 6f6c 7967 6f6e 0a20 2020  pely Polygon.   
+000085c0: 2020 2020 2020 2020 206c 6179 6572 2c20           layer, 
+000085d0: 6461 7461 7479 7065 203d 205f 7061 7273  datatype = _pars
+000085e0: 655f 6c61 7965 7228 6c61 7965 7229 0a20  e_layer(layer). 
+000085f0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00008600: 735f 6f6e 5f67 7269 6420 3d20 6e70 2e72  s_on_grid = np.r
+00008610: 6f75 6e64 2870 6f69 6e74 732e 6578 7465  ound(points.exte
+00008620: 7269 6f72 2e63 6f6f 7264 732c 2033 290a  rior.coords, 3).
+00008630: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
+00008640: 676f 6e20 3d20 6764 7374 6b2e 506f 6c79  gon = gdstk.Poly
+00008650: 676f 6e28 706f 696e 7473 5f6f 6e5f 6772  gon(points_on_gr
+00008660: 6964 2c20 6c61 7965 722c 2064 6174 6174  id, layer, datat
+00008670: 7970 6529 0a0a 2020 2020 2020 2020 2020  ype)..          
+00008680: 2020 6966 2070 6f69 6e74 732e 696e 7465    if points.inte
+00008690: 7269 6f72 733a 0a20 2020 2020 2020 2020  riors:.         
+000086a0: 2020 2020 2020 2066 726f 6d20 7368 6170         from shap
+000086b0: 656c 7920 696d 706f 7274 2067 6574 5f63  ely import get_c
+000086c0: 6f6f 7264 696e 6174 6573 0a0a 2020 2020  oordinates..    
+000086d0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+000086e0: 7473 5f6f 6e5f 6772 6964 5f69 6e74 6572  ts_on_grid_inter
+000086f0: 696f 7220 3d20 6e70 2e72 6f75 6e64 2867  ior = np.round(g
+00008700: 6574 5f63 6f6f 7264 696e 6174 6573 2870  et_coordinates(p
+00008710: 6f69 6e74 732e 696e 7465 7269 6f72 7329  oints.interiors)
+00008720: 2c20 3329 0a20 2020 2020 2020 2020 2020  , 3).           
+00008730: 2020 2020 2070 6f6c 7967 6f6e 5f69 6e74       polygon_int
+00008740: 6572 696f 7220 3d20 6764 7374 6b2e 506f  erior = gdstk.Po
+00008750: 6c79 676f 6e28 0a20 2020 2020 2020 2020  lygon(.         
+00008760: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00008770: 735f 6f6e 5f67 7269 645f 696e 7465 7269  s_on_grid_interi
+00008780: 6f72 2c20 6c61 7965 722c 2064 6174 6174  or, layer, datat
+00008790: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+000087a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000087b0: 2020 2020 2020 706f 6c79 676f 6e73 203d        polygons =
+000087c0: 2067 6473 746b 2e62 6f6f 6c65 616e 280a   gdstk.boolean(.
+000087d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087e0: 2020 2020 706f 6c79 676f 6e2c 0a20 2020      polygon,.   
 000087f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008800: 206f 7065 7261 7469 6f6e 3d22 6e6f 7422   operation="not"
-00008810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00008820: 2020 2020 2020 6c61 7965 723d 6c61 7965        layer=laye
-00008830: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00008840: 2020 2020 2020 2064 6174 6174 7970 653d         datatype=
-00008850: 6461 7461 7479 7065 2c0a 2020 2020 2020  datatype,.      
-00008860: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00008870: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00008880: 706f 6c79 676f 6e20 696e 2070 6f6c 7967  polygon in polyg
-00008890: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-000088a0: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
-000088b0: 6464 5f70 6f6c 7967 6f6e 7328 706f 6c79  dd_polygons(poly
-000088c0: 676f 6e29 0a20 2020 2020 2020 2020 2020  gon).           
-000088d0: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
-000088e0: 676f 6e0a 0a20 2020 2020 2020 2020 2020  gon..           
-000088f0: 2073 656c 662e 5f61 6464 5f70 6f6c 7967   self._add_polyg
-00008900: 6f6e 7328 706f 6c79 676f 6e29 0a20 2020  ons(polygon).   
-00008910: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008920: 706f 6c79 676f 6e0a 0a20 2020 2020 2020  polygon..       
-00008930: 2070 6f69 6e74 7320 3d20 6e70 2e61 7361   points = np.asa
-00008940: 7272 6179 2870 6f69 6e74 7329 0a20 2020  rray(points).   
-00008950: 2020 2020 2069 6620 706f 696e 7473 2e6e       if points.n
-00008960: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
-00008970: 2020 2020 2020 7265 7475 726e 205b 7365        return [se
-00008980: 6c66 2e61 6464 5f70 6f6c 7967 6f6e 2870  lf.add_polygon(p
-00008990: 6f6c 792c 206c 6179 6572 3d6c 6179 6572  oly, layer=layer
-000089a0: 2920 666f 7220 706f 6c79 2069 6e20 706f  ) for poly in po
-000089b0: 696e 7473 5d0a 2020 2020 2020 2020 6966  ints].        if
-000089c0: 206c 6179 6572 2069 7320 6e70 2e6e 616e   layer is np.nan
-000089d0: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
-000089e0: 7965 7220 3d20 300a 0a20 2020 2020 2020  yer = 0..       
-000089f0: 2069 6620 706f 696e 7473 2e6e 6469 6d20   if points.ndim 
-00008a00: 3d3d 2032 3a0a 2020 2020 2020 2020 2020  == 2:.          
-00008a10: 2020 2320 6164 6420 7369 6e67 6c65 2070    # add single p
-00008a20: 6f6c 7967 6f6e 2066 726f 6d20 706f 696e  olygon from poin
-00008a30: 7473 0a20 2020 2020 2020 2020 2020 2069  ts.            i
-00008a40: 6620 6c65 6e28 706f 696e 7473 5b30 5d29  f len(points[0])
-00008a50: 203e 2032 3a0a 2020 2020 2020 2020 2020   > 2:.          
-00008a60: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
-00008a70: 746f 2066 6f72 6d20 5b5b 312c 325d 2c5b  to form [[1,2],[
-00008a80: 332c 345d 2c5b 352c 365d 5d0a 2020 2020  3,4],[5,6]].    
-00008a90: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00008aa0: 7473 203d 206e 702e 636f 6c75 6d6e 5f73  ts = np.column_s
-00008ab0: 7461 636b 2870 6f69 6e74 7329 0a20 2020  tack(points).   
-00008ac0: 2020 2020 2020 2020 206c 6179 6572 2c20           layer, 
-00008ad0: 6461 7461 7479 7065 203d 205f 7061 7273  datatype = _pars
-00008ae0: 655f 6c61 7965 7228 6c61 7965 7229 0a20  e_layer(layer). 
-00008af0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-00008b00: 6f6e 203d 2050 6f6c 7967 6f6e 2870 6f69  on = Polygon(poi
-00008b10: 6e74 732c 206c 6179 6572 3d6c 6179 6572  nts, layer=layer
-00008b20: 2c20 6461 7461 7479 7065 3d64 6174 6174  , datatype=datat
-00008b30: 7970 6529 0a20 2020 2020 2020 2020 2020  ype).           
-00008b40: 2073 656c 662e 5f61 6464 5f70 6f6c 7967   self._add_polyg
-00008b50: 6f6e 7328 706f 6c79 676f 6e29 0a20 2020  ons(polygon).   
-00008b60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008b70: 706f 6c79 676f 6e0a 2020 2020 2020 2020  polygon.        
-00008b80: 656c 6966 2070 6f69 6e74 732e 6e64 696d  elif points.ndim
-00008b90: 203d 3d20 333a 0a20 2020 2020 2020 2020   == 3:.         
-00008ba0: 2020 206c 6179 6572 2c20 6461 7461 7479     layer, dataty
-00008bb0: 7065 203d 205f 7061 7273 655f 6c61 7965  pe = _parse_laye
-00008bc0: 7228 6c61 7965 7229 0a20 2020 2020 2020  r(layer).       
-00008bd0: 2020 2020 2070 6f6c 7967 6f6e 7320 3d20       polygons = 
-00008be0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00008bf0: 2020 506f 6c79 676f 6e28 7070 6f69 6e74    Polygon(ppoint
-00008c00: 732c 206c 6179 6572 3d6c 6179 6572 2c20  s, layer=layer, 
-00008c10: 6461 7461 7479 7065 3d64 6174 6174 7970  datatype=datatyp
-00008c20: 6529 2066 6f72 2070 706f 696e 7473 2069  e) for ppoints i
-00008c30: 6e20 706f 696e 7473 0a20 2020 2020 2020  n points.       
-00008c40: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00008c50: 2020 2073 656c 662e 5f61 6464 5f70 6f6c     self._add_pol
-00008c60: 7967 6f6e 7328 2a70 6f6c 7967 6f6e 7329  ygons(*polygons)
-00008c70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00008c80: 7572 6e20 706f 6c79 676f 6e73 0a20 2020  urn polygons.   
-00008c90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008ca0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00008cb0: 7565 4572 726f 7228 6622 556e 6162 6c65  ueError(f"Unable
-00008cc0: 2074 6f20 6164 6420 7b70 6f69 6e74 732e   to add {points.
-00008cd0: 6e64 696d 7d2d 6469 6d65 6e73 696f 6e61  ndim}-dimensiona
-00008ce0: 6c20 706f 696e 7473 206f 626a 6563 7422  l points object"
-00008cf0: 290a 0a20 2020 2064 6566 205f 6164 645f  )..    def _add_
-00008d00: 706f 6c79 676f 6e73 2873 656c 662c 202a  polygons(self, *
-00008d10: 706f 6c79 676f 6e73 3a20 4c69 7374 5b50  polygons: List[P
-00008d20: 6f6c 7967 6f6e 5d29 202d 3e20 4e6f 6e65  olygon]) -> None
-00008d30: 3a0a 2020 2020 2020 2020 7365 6c66 2e69  :.        self.i
-00008d40: 735f 756e 6c6f 636b 6564 2829 0a20 2020  s_unlocked().   
-00008d50: 2020 2020 2073 656c 662e 5f63 656c 6c2e       self._cell.
-00008d60: 6164 6428 2a70 6f6c 7967 6f6e 7329 0a0a  add(*polygons)..
-00008d70: 2020 2020 6465 6620 636f 7079 2873 656c      def copy(sel
-00008d80: 6629 202d 3e20 436f 6d70 6f6e 656e 743a  f) -> Component:
-00008d90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008da0: 636f 7079 2873 656c 6629 0a0a 2020 2020  copy(self)..    
-00008db0: 6465 6620 6164 645f 7265 665f 636f 6e74  def add_ref_cont
-00008dc0: 6169 6e65 7228 7365 6c66 2c20 636f 6d70  ainer(self, comp
-00008dd0: 6f6e 656e 743a 2043 6f6d 706f 6e65 6e74  onent: Component
-00008de0: 2920 2d3e 2043 6f6d 706f 6e65 6e74 5265  ) -> ComponentRe
-00008df0: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
-00008e00: 2022 2222 4164 6420 7265 6665 7265 6e63   """Add referenc
-00008e10: 652c 2070 6f72 7473 2061 6e64 2063 6f70  e, ports and cop
-00008e20: 795f 6368 696c 645f 696e 666f 2e22 2222  y_child_info."""
-00008e30: 0a20 2020 2020 2020 2072 6566 203d 2073  .        ref = s
-00008e40: 656c 6620 3c3c 2063 6f6d 706f 6e65 6e74  elf << component
-00008e50: 0a20 2020 2020 2020 2073 656c 662e 6164  .        self.ad
-00008e60: 645f 706f 7274 7328 7265 662e 706f 7274  d_ports(ref.port
-00008e70: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-00008e80: 636f 7079 5f63 6869 6c64 5f69 6e66 6f28  copy_child_info(
-00008e90: 636f 6d70 6f6e 656e 7429 0a20 2020 2020  component).     
-00008ea0: 2020 2072 6574 7572 6e20 7265 660a 0a20     return ref.. 
-00008eb0: 2020 2064 6566 2063 6f70 795f 6368 696c     def copy_chil
-00008ec0: 645f 696e 666f 2873 656c 662c 2063 6f6d  d_info(self, com
-00008ed0: 706f 6e65 6e74 3a20 436f 6d70 6f6e 656e  ponent: Componen
-00008ee0: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
-00008ef0: 2020 2020 2222 2243 6f70 7920 616e 6420      """Copy and 
-00008f00: 7365 7474 696e 6773 2069 6e66 6f20 6672  settings info fr
-00008f10: 6f6d 2063 6869 6c64 2063 6f6d 706f 6e65  om child compone
-00008f20: 6e74 2069 6e74 6f20 7061 7265 6e74 2e0a  nt into parent..
-00008f30: 0a20 2020 2020 2020 2050 6172 656e 7420  .        Parent 
-00008f40: 636f 6d70 6f6e 656e 7473 2063 616e 2061  components can a
-00008f50: 6363 6573 7320 6368 696c 6420 6365 6c6c  ccess child cell
-00008f60: 7320 7365 7474 696e 6773 2e0a 2020 2020  s settings..    
-00008f70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00008f80: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00008f90: 6528 636f 6d70 6f6e 656e 742c 2028 436f  e(component, (Co
-00008fa0: 6d70 6f6e 656e 742c 2043 6f6d 706f 6e65  mponent, Compone
-00008fb0: 6e74 5265 6665 7265 6e63 6529 293a 0a20  ntReference)):. 
-00008fc0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00008fd0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00008fe0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00008ff0: 7479 7065 2863 6f6d 706f 6e65 6e74 297d  type(component)}
-00009000: 2220 2269 7320 6e6f 7420 6120 436f 6d70  " "is not a Comp
-00009010: 6f6e 656e 7420 6f72 2043 6f6d 706f 6e65  onent or Compone
-00009020: 6e74 5265 6665 7265 6e63 6522 0a20 2020  ntReference".   
-00009030: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00009040: 2020 2020 7365 6c66 2e67 6574 5f63 6869      self.get_chi
-00009050: 6c64 5f6e 616d 6520 3d20 5472 7565 0a20  ld_name = True. 
-00009060: 2020 2020 2020 2073 656c 662e 6368 696c         self.chil
-00009070: 6420 3d20 636f 6d70 6f6e 656e 740a 2020  d = component.  
-00009080: 2020 2020 2020 7365 6c66 2e69 6e66 6f2e        self.info.
-00009090: 7570 6461 7465 2863 6f6d 706f 6e65 6e74  update(component
-000090a0: 2e69 6e66 6f29 0a20 2020 2020 2020 2073  .info).        s
-000090b0: 656c 662e 7365 7474 696e 6773 2e75 7064  elf.settings.upd
-000090c0: 6174 6528 636f 6d70 6f6e 656e 742e 7365  ate(component.se
-000090d0: 7474 696e 6773 290a 0a20 2020 2040 7072  ttings)..    @pr
-000090e0: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
-000090f0: 697a 655f 696e 666f 2873 656c 6629 202d  ize_info(self) -
-00009100: 3e20 5369 7a65 496e 666f 3a0a 2020 2020  > SizeInfo:.    
-00009110: 2020 2020 2222 2253 697a 6520 696e 666f      """Size info
-00009120: 206f 6620 7468 6520 636f 6d70 6f6e 656e   of the componen
-00009130: 742e 2222 220a 2020 2020 2020 2020 7265  t.""".        re
-00009140: 7475 726e 2053 697a 6549 6e66 6f28 7365  turn SizeInfo(se
-00009150: 6c66 2e62 626f 7829 0a0a 2020 2020 6465  lf.bbox)..    de
-00009160: 6620 6765 745f 7365 7474 696e 6728 7365  f get_setting(se
-00009170: 6c66 2c20 7365 7474 696e 673a 2073 7472  lf, setting: str
-00009180: 2920 2d3e 2055 6e69 6f6e 5b73 7472 2c20  ) -> Union[str, 
-00009190: 696e 742c 2066 6c6f 6174 5d3a 0a20 2020  int, float]:.   
-000091a0: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
-000091b0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-000091c0: 6e66 6f2e 6765 7428 7365 7474 696e 6729  nfo.get(setting)
-000091d0: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-000091e0: 7365 6c66 2e73 6574 7469 6e67 732e 6675  self.settings.fu
-000091f0: 6c6c 2e67 6574 2873 6574 7469 6e67 290a  ll.get(setting).
-00009200: 2020 2020 2020 2020 2020 2020 6f72 2073              or s
-00009210: 656c 662e 6d65 7461 6461 7461 5f63 6869  elf.metadata_chi
-00009220: 6c64 2e67 6574 2873 6574 7469 6e67 290a  ld.get(setting).
-00009230: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00009240: 6566 2069 735f 756e 6c6f 636b 6564 2873  ef is_unlocked(s
-00009250: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00009260: 2020 2020 2020 2222 2252 6169 7365 7320        """Raises 
-00009270: 6572 726f 7220 6966 2043 6f6d 706f 6e65  error if Compone
-00009280: 6e74 2069 7320 6c6f 636b 6564 2e22 2222  nt is locked."""
-00009290: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000092a0: 2e5f 6c6f 636b 6564 3a0a 2020 2020 2020  ._locked:.      
-000092b0: 2020 2020 2020 7261 6973 6520 4d75 7461        raise Muta
-000092c0: 6269 6c69 7479 4572 726f 7228 0a20 2020  bilityError(.   
-000092d0: 2020 2020 2020 2020 2020 2020 2066 2243               f"C
-000092e0: 6f6d 706f 6e65 6e74 207b 7365 6c66 2e6e  omponent {self.n
-000092f0: 616d 6521 727d 2063 616e 6e6f 7420 6265  ame!r} cannot be
-00009300: 206d 6f64 6966 6965 6420 6173 2069 7427   modified as it'
-00009310: 7320 616c 7265 6164 7920 6f6e 2063 6163  s already on cac
-00009320: 6865 2e20 220a 2020 2020 2020 2020 2020  he. ".          
-00009330: 2020 2020 2020 2b20 6d75 7461 6269 6c69        + mutabili
-00009340: 7479 5f65 7272 6f72 5f6d 6573 7361 6765  ty_error_message
-00009350: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00009360: 2020 2020 6465 6620 5f61 6464 2873 656c      def _add(sel
-00009370: 662c 2065 6c65 6d65 6e74 2920 2d3e 204e  f, element) -> N
-00009380: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00009390: 4164 6420 6120 6e65 7720 656c 656d 656e  Add a new elemen
-000093a0: 7420 6f72 206c 6973 7420 6f66 2065 6c65  t or list of ele
-000093b0: 6d65 6e74 7320 746f 2074 6869 7320 436f  ments to this Co
-000093c0: 6d70 6f6e 656e 742e 0a0a 2020 2020 2020  mponent...      
-000093d0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-000093e0: 2020 2020 656c 656d 656e 743a 2050 6f6c      element: Pol
-000093f0: 7967 6f6e 2c20 436f 6d70 6f6e 656e 7452  ygon, ComponentR
-00009400: 6566 6572 656e 6365 206f 7220 6974 6572  eference or iter
-00009410: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
-00009420: 2020 2020 2054 6865 2065 6c65 6d65 6e74       The element
-00009430: 206f 7220 6974 6572 6162 6c65 206f 6620   or iterable of 
-00009440: 656c 656d 656e 7473 2074 6f20 6265 2069  elements to be i
-00009450: 6e73 6572 7465 6420 696e 2074 6869 7320  nserted in this 
-00009460: 6365 6c6c 2e0a 0a20 2020 2020 2020 2052  cell...        R
-00009470: 6169 7365 733a 0a20 2020 2020 2020 2020  aises:.         
-00009480: 2020 204d 7574 6162 696c 6974 7945 7272     MutabilityErr
-00009490: 6f72 3a20 6966 2063 6f6d 706f 6e65 6e74  or: if component
-000094a0: 2069 7320 6c6f 636b 6564 2e0a 2020 2020   is locked..    
-000094b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000094c0: 7365 6c66 2e69 735f 756e 6c6f 636b 6564  self.is_unlocked
-000094d0: 2829 0a20 2020 2020 2020 2069 6620 6973  ().        if is
-000094e0: 696e 7374 616e 6365 2865 6c65 6d65 6e74  instance(element
-000094f0: 2c20 436f 6d70 6f6e 656e 7452 6566 6572  , ComponentRefer
-00009500: 656e 6365 293a 0a20 2020 2020 2020 2020  ence):.         
-00009510: 2020 2073 656c 662e 5f63 656c 6c2e 6164     self._cell.ad
-00009520: 6428 656c 656d 656e 742e 5f72 6566 6572  d(element._refer
-00009530: 656e 6365 290a 2020 2020 2020 2020 2020  ence).          
-00009540: 2020 7365 6c66 2e5f 7265 6665 7265 6e63    self._referenc
-00009550: 6573 2e61 7070 656e 6428 656c 656d 656e  es.append(elemen
-00009560: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
-00009570: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009580: 662e 5f63 656c 6c2e 6164 6428 656c 656d  f._cell.add(elem
-00009590: 656e 7429 0a0a 2020 2020 6465 6620 6164  ent)..    def ad
-000095a0: 6428 7365 6c66 2c20 656c 656d 656e 7429  d(self, element)
-000095b0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000095c0: 2020 2222 2241 6464 2061 206e 6577 2065    """Add a new e
-000095d0: 6c65 6d65 6e74 206f 7220 6c69 7374 206f  lement or list o
-000095e0: 6620 656c 656d 656e 7473 2074 6f20 7468  f elements to th
-000095f0: 6973 2043 6f6d 706f 6e65 6e74 2e0a 0a20  is Component... 
-00009600: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00009610: 2020 2020 2020 2020 2065 6c65 6d65 6e74           element
-00009620: 3a20 506f 6c79 676f 6e2c 2043 6f6d 706f  : Polygon, Compo
-00009630: 6e65 6e74 5265 6665 7265 6e63 6520 6f72  nentReference or
-00009640: 2069 7465 7261 626c 650a 2020 2020 2020   iterable.      
-00009650: 2020 2020 2020 2020 2020 5468 6520 656c            The el
-00009660: 656d 656e 7420 6f72 2069 7465 7261 626c  ement or iterabl
-00009670: 6520 6f66 2065 6c65 6d65 6e74 7320 746f  e of elements to
-00009680: 2062 6520 696e 7365 7274 6564 2069 6e20   be inserted in 
-00009690: 7468 6973 2063 656c 6c2e 0a0a 2020 2020  this cell...    
-000096a0: 2020 2020 5261 6973 6573 3a0a 2020 2020      Raises:.    
-000096b0: 2020 2020 2020 2020 4d75 7461 6269 6c69          Mutabili
-000096c0: 7479 4572 726f 723a 2069 6620 636f 6d70  tyError: if comp
-000096d0: 6f6e 656e 7420 6973 206c 6f63 6b65 642e  onent is locked.
-000096e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000096f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00009700: 6365 2865 6c65 6d65 6e74 2c20 436f 6d70  ce(element, Comp
-00009710: 6f6e 656e 7452 6566 6572 656e 6365 293a  onentReference):
-00009720: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009730: 662e 5f72 6567 6973 7465 725f 7265 6665  f._register_refe
-00009740: 7265 6e63 6528 656c 656d 656e 7429 0a20  rence(element). 
-00009750: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009760: 5f61 6464 2865 6c65 6d65 6e74 290a 2020  _add(element).  
-00009770: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00009780: 7461 6e63 6528 656c 656d 656e 742c 2049  tance(element, I
-00009790: 7465 7261 626c 6529 3a0a 2020 2020 2020  terable):.      
-000097a0: 2020 2020 2020 666f 7220 7375 6265 6c65        for subele
-000097b0: 6d65 6e74 2069 6e20 656c 656d 656e 743a  ment in element:
-000097c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000097d0: 2073 656c 662e 6164 6428 7375 6265 6c65   self.add(subele
-000097e0: 6d65 6e74 290a 2020 2020 2020 2020 656c  ment).        el
-000097f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00009800: 7365 6c66 2e5f 6164 6428 656c 656d 656e  self._add(elemen
-00009810: 7429 0a0a 2020 2020 6465 6620 6164 645f  t)..    def add_
-00009820: 6172 7261 7928 0a20 2020 2020 2020 2073  array(.        s
-00009830: 656c 662c 0a20 2020 2020 2020 2063 6f6d  elf,.        com
-00009840: 706f 6e65 6e74 3a20 436f 6d70 6f6e 656e  ponent: Componen
-00009850: 742c 0a20 2020 2020 2020 2063 6f6c 756d  t,.        colum
-00009860: 6e73 3a20 696e 7420 3d20 322c 0a20 2020  ns: int = 2,.   
-00009870: 2020 2020 2072 6f77 733a 2069 6e74 203d       rows: int =
-00009880: 2032 2c0a 2020 2020 2020 2020 7370 6163   2,.        spac
-00009890: 696e 673a 2054 7570 6c65 5b66 6c6f 6174  ing: Tuple[float
-000098a0: 2c20 666c 6f61 745d 203d 2028 3130 302c  , float] = (100,
-000098b0: 2031 3030 292c 0a20 2020 2020 2020 2061   100),.        a
-000098c0: 6c69 6173 3a20 4f70 7469 6f6e 616c 5b73  lias: Optional[s
-000098d0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-000098e0: 2920 2d3e 2043 6f6d 706f 6e65 6e74 5265  ) -> ComponentRe
-000098f0: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
-00009900: 2022 2222 4372 6561 7465 7320 6120 436f   """Creates a Co
-00009910: 6d70 6f6e 656e 7452 6566 6572 656e 6365  mponentReference
-00009920: 2072 6566 6572 656e 6365 2074 6f20 6120   reference to a 
-00009930: 436f 6d70 6f6e 656e 742e 0a0a 2020 2020  Component...    
-00009940: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00009950: 2020 2020 2020 636f 6d70 6f6e 656e 743a        component:
-00009960: 2054 6865 2072 6566 6572 656e 6365 6420   The referenced 
-00009970: 636f 6d70 6f6e 656e 742e 0a20 2020 2020  component..     
-00009980: 2020 2020 2020 2063 6f6c 756d 6e73 3a20         columns: 
-00009990: 4e75 6d62 6572 206f 6620 636f 6c75 6d6e  Number of column
-000099a0: 7320 696e 2074 6865 2061 7272 6179 2e0a  s in the array..
-000099b0: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-000099c0: 3a20 4e75 6d62 6572 206f 6620 726f 7773  : Number of rows
-000099d0: 2069 6e20 7468 6520 6172 7261 792e 0a20   in the array.. 
-000099e0: 2020 2020 2020 2020 2020 2073 7061 6369             spaci
-000099f0: 6e67 3a20 6172 7261 792d 6c69 6b65 5b32  ng: array-like[2
-00009a00: 5d20 6f66 2069 6e74 206f 7220 666c 6f61  ] of int or floa
-00009a10: 742e 0a20 2020 2020 2020 2020 2020 2020  t..             
-00009a20: 2020 2044 6973 7461 6e63 6520 6265 7477     Distance betw
-00009a30: 6565 6e20 6164 6a61 6365 6e74 2063 6f6c  een adjacent col
-00009a40: 756d 6e73 2061 6e64 2061 646a 6163 656e  umns and adjacen
-00009a50: 7420 726f 7773 2e0a 2020 2020 2020 2020  t rows..        
-00009a60: 2020 2020 616c 6961 733a 2073 7472 206f      alias: str o
-00009a70: 7220 4e6f 6e65 2e20 416c 6961 7320 6f66  r None. Alias of
-00009a80: 2074 6865 2072 6566 6572 656e 6365 6420   the referenced 
-00009a90: 436f 6d70 6f6e 656e 742e 0a0a 2020 2020  Component...    
-00009aa0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00009ab0: 2020 2020 2020 2020 613a 2043 6f6d 706f          a: Compo
-00009ac0: 6e65 6e74 5265 6665 7265 6e63 6520 636f  nentReference co
-00009ad0: 6e74 6169 6e69 6e67 2072 6566 6572 656e  ntaining referen
-00009ae0: 6365 7320 746f 2074 6865 2043 6f6d 706f  ces to the Compo
-00009af0: 6e65 6e74 2e0a 2020 2020 2020 2020 2222  nent..        ""
-00009b00: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
-00009b10: 2069 7369 6e73 7461 6e63 6528 636f 6d70   isinstance(comp
-00009b20: 6f6e 656e 742c 2043 6f6d 706f 6e65 6e74  onent, Component
-00009b30: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00009b40: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-00009b50: 6164 645f 6172 7261 7928 2920 6e65 6564  add_array() need
-00009b60: 7320 6120 436f 6d70 6f6e 656e 7420 6f62  s a Component ob
-00009b70: 6a65 6374 2e22 290a 2020 2020 2020 2020  ject.").        
-00009b80: 7265 6620 3d20 436f 6d70 6f6e 656e 7452  ref = ComponentR
-00009b90: 6566 6572 656e 6365 280a 2020 2020 2020  eference(.      
-00009ba0: 2020 2020 2020 636f 6d70 6f6e 656e 743d        component=
-00009bb0: 636f 6d70 6f6e 656e 742c 0a20 2020 2020  component,.     
-00009bc0: 2020 2020 2020 2063 6f6c 756d 6e73 3d69         columns=i
-00009bd0: 6e74 2872 6f75 6e64 2863 6f6c 756d 6e73  nt(round(columns
-00009be0: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
-00009bf0: 726f 7773 3d69 6e74 2872 6f75 6e64 2872  rows=int(round(r
-00009c00: 6f77 7329 292c 0a20 2020 2020 2020 2020  ows)),.         
-00009c10: 2020 2073 7061 6369 6e67 3d73 7061 6369     spacing=spaci
-00009c20: 6e67 2c0a 2020 2020 2020 2020 290a 2020  ng,.        ).  
-00009c30: 2020 2020 2020 7265 662e 6e61 6d65 203d        ref.name =
-00009c40: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00009c50: 6c66 2e5f 6164 6428 7265 6629 0a20 2020  lf._add(ref).   
-00009c60: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-00009c70: 7465 725f 7265 6665 7265 6e63 6528 7265  ter_reference(re
-00009c80: 6665 7265 6e63 653d 7265 662c 2061 6c69  ference=ref, ali
-00009c90: 6173 3d61 6c69 6173 290a 2020 2020 2020  as=alias).      
-00009ca0: 2020 7265 7475 726e 2072 6566 0a0a 2020    return ref..  
-00009cb0: 2020 6465 6620 6469 7374 7269 6275 7465    def distribute
-00009cc0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00009cd0: 656c 656d 656e 7473 3d22 616c 6c22 2c20  elements="all", 
-00009ce0: 6469 7265 6374 696f 6e3d 2278 222c 2073  direction="x", s
-00009cf0: 7061 6369 6e67 3d31 3030 2c20 7365 7061  pacing=100, sepa
-00009d00: 7261 7469 6f6e 3d54 7275 652c 2065 6467  ration=True, edg
-00009d10: 653d 2263 656e 7465 7222 0a20 2020 2029  e="center".    )
-00009d20: 3a0a 2020 2020 2020 2020 2222 2244 6973  :.        """Dis
-00009d30: 7472 6962 7574 6573 2074 6865 2073 7065  tributes the spe
-00009d40: 6369 6669 6564 2065 6c65 6d65 6e74 7320  cified elements 
-00009d50: 696e 2074 6865 2043 6f6d 706f 6e65 6e74  in the Component
-00009d60: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00009d70: 0a20 2020 2020 2020 2020 2020 2065 6c65  .            ele
-00009d80: 6d65 6e74 7320 3a20 6172 7261 792d 6c69  ments : array-li
-00009d90: 6b65 206f 6620 6f62 6a65 6374 7320 6f72  ke of objects or
-00009da0: 2027 616c 6c27 0a20 2020 2020 2020 2020   'all'.         
-00009db0: 2020 2020 2020 2045 6c65 6d65 6e74 7320         Elements 
-00009dc0: 746f 2064 6973 7472 6962 7574 652e 0a20  to distribute.. 
-00009dd0: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-00009de0: 7469 6f6e 203a 207b 2778 272c 2027 7927  tion : {'x', 'y'
-00009df0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00009e00: 2020 4469 7265 6374 696f 6e20 6f66 2064    Direction of d
-00009e10: 6973 7472 6962 7574 696f 6e3b 2065 6974  istribution; eit
-00009e20: 6865 7220 6120 6c69 6e65 2069 6e20 7468  her a line in th
-00009e30: 6520 782d 6469 7265 6374 696f 6e20 6f72  e x-direction or
-00009e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009e50: 2079 2d64 6972 6563 7469 6f6e 2e0a 2020   y-direction..  
-00009e60: 2020 2020 2020 2020 2020 7370 6163 696e            spacin
-00009e70: 6720 3a20 696e 7420 6f72 2066 6c6f 6174  g : int or float
-00009e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009e90: 2044 6973 7461 6e63 6520 6265 7477 6565   Distance betwee
-00009ea0: 6e20 656c 656d 656e 7473 2e0a 2020 2020  n elements..    
-00009eb0: 2020 2020 2020 2020 7365 7061 7261 7469          separati
-00009ec0: 6f6e 203a 2062 6f6f 6c0a 2020 2020 2020  on : bool.      
-00009ed0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00009ee0: 652c 2067 7561 7261 6e74 6565 7320 656c  e, guarantees el
-00009ef0: 656d 656e 7473 2061 7265 2073 6570 6172  ements are separ
-00009f00: 6174 6564 2077 6974 6820 6120 6669 7865  ated with a fixe
-00009f10: 6420 7370 6163 696e 670a 2020 2020 2020  d spacing.      
-00009f20: 2020 2020 2020 2020 2020 6265 7477 6565            betwee
-00009f30: 6e3b 2069 6620 2046 616c 7365 2c20 656c  n; if  False, el
-00009f40: 656d 656e 7473 2061 7265 2073 7061 6365  ements are space
-00009f50: 6420 6576 656e 6c79 2061 6c6f 6e67 2061  d evenly along a
-00009f60: 2067 7269 642e 0a20 2020 2020 2020 2020   grid..         
-00009f70: 2020 2065 6467 6520 3a20 7b27 7827 2c20     edge : {'x', 
-00009f80: 2778 6d69 6e27 2c20 2778 6d61 7827 2c20  'xmin', 'xmax', 
-00009f90: 2779 272c 2027 796d 696e 272c 2027 796d  'y', 'ymin', 'ym
-00009fa0: 6178 277d 0a20 2020 2020 2020 2020 2020  ax'}.           
-00009fb0: 2020 2020 2057 6869 6368 2065 6467 6520       Which edge 
-00009fc0: 746f 2070 6572 666f 726d 2074 6865 2064  to perform the d
-00009fd0: 6973 7472 6962 7574 696f 6e20 616c 6f6e  istribution alon
-00009fe0: 6720 2875 6e75 7365 6420 6966 0a20 2020  g (unused if.   
-00009ff0: 2020 2020 2020 2020 2020 2020 2073 6570               sep
-0000a000: 6172 6174 696f 6e20 3d3d 2054 7275 6529  aration == True)
-0000a010: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000a020: 2020 2020 2020 6966 2065 6c65 6d65 6e74        if element
-0000a030: 7320 3d3d 2022 616c 6c22 3a0a 2020 2020  s == "all":.    
-0000a040: 2020 2020 2020 2020 656c 656d 656e 7473          elements
-0000a050: 203d 2073 656c 662e 706f 6c79 676f 6e73   = self.polygons
-0000a060: 202b 2073 656c 662e 7265 6665 7265 6e63   + self.referenc
-0000a070: 6573 0a20 2020 2020 2020 205f 6469 7374  es.        _dist
-0000a080: 7269 6275 7465 280a 2020 2020 2020 2020  ribute(.        
-0000a090: 2020 2020 656c 656d 656e 7473 3d65 6c65      elements=ele
-0000a0a0: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
-0000a0b0: 2020 2064 6972 6563 7469 6f6e 3d64 6972     direction=dir
-0000a0c0: 6563 7469 6f6e 2c0a 2020 2020 2020 2020  ection,.        
-0000a0d0: 2020 2020 7370 6163 696e 673d 7370 6163      spacing=spac
-0000a0e0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-0000a0f0: 2073 6570 6172 6174 696f 6e3d 7365 7061   separation=sepa
-0000a100: 7261 7469 6f6e 2c0a 2020 2020 2020 2020  ration,.        
-0000a110: 2020 2020 6564 6765 3d65 6467 652c 0a20      edge=edge,. 
-0000a120: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000a130: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-0000a140: 2020 6465 6620 616c 6967 6e28 7365 6c66    def align(self
-0000a150: 2c20 656c 656d 656e 7473 3d22 616c 6c22  , elements="all"
-0000a160: 2c20 616c 6967 6e6d 656e 743d 2279 6d61  , alignment="yma
-0000a170: 7822 293a 0a20 2020 2020 2020 2022 2222  x"):.        """
-0000a180: 416c 6967 6e20 656c 656d 656e 7473 2069  Align elements i
-0000a190: 6e20 7468 6520 436f 6d70 6f6e 656e 742e  n the Component.
-0000a1a0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-0000a1b0: 2020 2020 2020 2020 2020 2020 656c 656d              elem
-0000a1c0: 656e 7473 203a 2061 7272 6179 2d6c 696b  ents : array-lik
-0000a1d0: 6520 6f66 206f 626a 6563 7473 2c20 6f72  e of objects, or
-0000a1e0: 2027 616c 6c27 0a20 2020 2020 2020 2020   'all'.         
-0000a1f0: 2020 2020 2020 2045 6c65 6d65 6e74 7320         Elements 
-0000a200: 696e 2074 6865 2043 6f6d 706f 6e65 6e74  in the Component
-0000a210: 2074 6f20 616c 6967 6e2e 0a20 2020 2020   to align..     
-0000a220: 2020 2020 2020 2061 6c69 676e 6d65 6e74         alignment
-0000a230: 203a 207b 2778 272c 2027 7927 2c20 2778   : {'x', 'y', 'x
-0000a240: 6d69 6e27 2c20 2778 6d61 7827 2c20 2779  min', 'xmax', 'y
-0000a250: 6d69 6e27 2c20 2779 6d61 7827 7d0a 2020  min', 'ymax'}.  
-0000a260: 2020 2020 2020 2020 2020 2020 2020 5768                Wh
-0000a270: 6963 6820 6564 6765 2074 6f20 616c 6967  ich edge to alig
-0000a280: 6e20 616c 6f6e 6720 2865 2e67 2e20 2779  n along (e.g. 'y
-0000a290: 6d61 7827 2077 696c 6c20 6d6f 7665 2074  max' will move t
-0000a2a0: 6865 2065 6c65 6d65 6e74 7320 7375 6368  he elements such
-0000a2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a2c0: 2074 6861 7420 616c 6c20 6f66 2074 6865   that all of the
-0000a2d0: 6972 2074 6f70 6d6f 7374 2070 6f69 6e74  ir topmost point
-0000a2e0: 7320 6172 6520 616c 6967 6e65 6429 2e0a  s are aligned)..
-0000a2f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000a300: 2020 2020 6966 2065 6c65 6d65 6e74 7320      if elements 
-0000a310: 3d3d 2022 616c 6c22 3a0a 2020 2020 2020  == "all":.      
-0000a320: 2020 2020 2020 656c 656d 656e 7473 203d        elements =
-0000a330: 2073 656c 662e 706f 6c79 676f 6e73 202b   self.polygons +
-0000a340: 2073 656c 662e 7265 6665 7265 6e63 6573   self.references
-0000a350: 0a20 2020 2020 2020 205f 616c 6967 6e28  .        _align(
-0000a360: 656c 656d 656e 7473 2c20 616c 6967 6e6d  elements, alignm
-0000a370: 656e 743d 616c 6967 6e6d 656e 7429 0a20  ent=alignment). 
-0000a380: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000a390: 6c66 0a0a 2020 2020 6465 6620 666c 6174  lf..    def flat
-0000a3a0: 7465 6e28 7365 6c66 2c20 7369 6e67 6c65  ten(self, single
-0000a3b0: 5f6c 6179 6572 3a20 4f70 7469 6f6e 616c  _layer: Optional
-0000a3c0: 5b4c 6179 6572 5370 6563 5d20 3d20 4e6f  [LayerSpec] = No
-0000a3d0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0000a3e0: 5265 7475 726e 7320 6120 666c 6174 7465  Returns a flatte
-0000a3f0: 6e65 6420 636f 7079 206f 6620 7468 6520  ned copy of the 
-0000a400: 636f 6d70 6f6e 656e 742e 0a0a 2020 2020  component...    
-0000a410: 2020 2020 466c 6174 7465 6e73 2074 6865      Flattens the
-0000a420: 2068 6965 7261 7263 6879 206f 6620 7468   hierarchy of th
-0000a430: 6520 436f 6d70 6f6e 656e 7420 7375 6368  e Component such
-0000a440: 2074 6861 7420 7468 6572 6520 6172 6520   that there are 
-0000a450: 6e6f 206c 6f6e 6765 720a 2020 2020 2020  no longer.      
-0000a460: 2020 616e 7920 7265 6665 7265 6e63 6573    any references
-0000a470: 2074 6f20 6f74 6865 7220 436f 6d70 6f6e   to other Compon
-0000a480: 656e 7473 2e20 416c 6c20 706f 6c79 676f  ents. All polygo
-0000a490: 6e73 2061 6e64 206c 6162 656c 7320 6672  ns and labels fr
-0000a4a0: 6f6d 0a20 2020 2020 2020 2075 6e64 6572  om.        under
-0000a4b0: 6c79 696e 6720 7265 6665 7265 6e63 6573  lying references
-0000a4c0: 2061 7265 2063 6f70 6965 6420 616e 6420   are copied and 
-0000a4d0: 706c 6163 6564 2069 6e20 7468 6520 746f  placed in the to
-0000a4e0: 702d 6c65 7665 6c20 436f 6d70 6f6e 656e  p-level Componen
-0000a4f0: 742e 0a20 2020 2020 2020 2049 6620 7369  t..        If si
-0000a500: 6e67 6c65 5f6c 6179 6572 2069 7320 7370  ngle_layer is sp
-0000a510: 6563 6966 6965 642c 2061 6c6c 2070 6f6c  ecified, all pol
-0000a520: 7967 6f6e 7320 6172 6520 6d6f 7665 6420  ygons are moved 
-0000a530: 746f 2074 6861 7420 6c61 7965 722e 0a0a  to that layer...
-0000a540: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-0000a550: 2020 2020 2020 2020 2020 7369 6e67 6c65            single
-0000a560: 5f6c 6179 6572 3a20 6d6f 7665 2061 6c6c  _layer: move all
-0000a570: 2070 6f6c 7967 6f6e 7320 6172 6520 6d6f   polygons are mo
-0000a580: 7665 6420 746f 2074 6865 2073 7065 6369  ved to the speci
-0000a590: 6669 6564 2028 6f70 7469 6f6e 616c 292e  fied (optional).
-0000a5a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000a5b0: 2020 2020 2063 6f6d 706f 6e65 6e74 5f66       component_f
-0000a5c0: 6c61 7420 3d20 436f 6d70 6f6e 656e 7428  lat = Component(
-0000a5d0: 290a 0a20 2020 2020 2020 205f 6365 6c6c  )..        _cell
-0000a5e0: 203d 2073 656c 662e 5f63 656c 6c2e 636f   = self._cell.co
-0000a5f0: 7079 286e 616d 653d 636f 6d70 6f6e 656e  py(name=componen
-0000a600: 745f 666c 6174 2e6e 616d 6529 0a20 2020  t_flat.name).   
-0000a610: 2020 2020 205f 6365 6c6c 203d 205f 6365       _cell = _ce
-0000a620: 6c6c 2e66 6c61 7474 656e 2829 0a20 2020  ll.flatten().   
-0000a630: 2020 2020 2063 6f6d 706f 6e65 6e74 5f66       component_f
-0000a640: 6c61 742e 5f63 656c 6c20 3d20 5f63 656c  lat._cell = _cel
-0000a650: 6c0a 2020 2020 2020 2020 6966 2073 696e  l.        if sin
-0000a660: 676c 655f 6c61 7965 7220 6973 206e 6f74  gle_layer is not
-0000a670: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000a680: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
-0000a690: 7279 2069 6d70 6f72 7420 6765 745f 6c61  ry import get_la
-0000a6a0: 7965 720a 0a20 2020 2020 2020 2020 2020  yer..           
-0000a6b0: 206c 6179 6572 2c20 6461 7461 7479 7065   layer, datatype
-0000a6c0: 203d 2067 6574 5f6c 6179 6572 2873 696e   = get_layer(sin
-0000a6d0: 676c 655f 6c61 7965 7229 0a20 2020 2020  gle_layer).     
-0000a6e0: 2020 2020 2020 2066 6f72 2070 6f6c 7967         for polyg
-0000a6f0: 6f6e 2069 6e20 5f63 656c 6c2e 706f 6c79  on in _cell.poly
-0000a700: 676f 6e73 3a0a 2020 2020 2020 2020 2020  gons:.          
-0000a710: 2020 2020 2020 706f 6c79 676f 6e2e 6c61        polygon.la
-0000a720: 7965 7220 3d20 6c61 7965 720a 2020 2020  yer = layer.    
+00008800: 2070 6f6c 7967 6f6e 5f69 6e74 6572 696f   polygon_interio
+00008810: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00008820: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
+00008830: 3d22 6e6f 7422 2c0a 2020 2020 2020 2020  ="not",.        
+00008840: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+00008850: 723d 6c61 7965 722c 0a20 2020 2020 2020  r=layer,.       
+00008860: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00008870: 6174 7970 653d 6461 7461 7479 7065 2c0a  atype=datatype,.
+00008880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008890: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000088a0: 2020 666f 7220 706f 6c79 676f 6e20 696e    for polygon in
+000088b0: 2070 6f6c 7967 6f6e 733a 0a20 2020 2020   polygons:.     
+000088c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000088d0: 656c 662e 5f61 6464 5f70 6f6c 7967 6f6e  elf._add_polygon
+000088e0: 7328 706f 6c79 676f 6e29 0a20 2020 2020  s(polygon).     
+000088f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00008900: 6e20 706f 6c79 676f 6e0a 0a20 2020 2020  n polygon..     
+00008910: 2020 2020 2020 2073 656c 662e 5f61 6464         self._add
+00008920: 5f70 6f6c 7967 6f6e 7328 706f 6c79 676f  _polygons(polygo
+00008930: 6e29 0a20 2020 2020 2020 2020 2020 2072  n).            r
+00008940: 6574 7572 6e20 706f 6c79 676f 6e0a 0a20  eturn polygon.. 
+00008950: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
+00008960: 6e70 2e61 7361 7272 6179 2870 6f69 6e74  np.asarray(point
+00008970: 7329 0a20 2020 2020 2020 2069 6620 706f  s).        if po
+00008980: 696e 7473 2e6e 6469 6d20 3d3d 2031 3a0a  ints.ndim == 1:.
+00008990: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000089a0: 726e 205b 7365 6c66 2e61 6464 5f70 6f6c  rn [self.add_pol
+000089b0: 7967 6f6e 2870 6f6c 792c 206c 6179 6572  ygon(poly, layer
+000089c0: 3d6c 6179 6572 2920 666f 7220 706f 6c79  =layer) for poly
+000089d0: 2069 6e20 706f 696e 7473 5d0a 2020 2020   in points].    
+000089e0: 2020 2020 6966 206c 6179 6572 2069 7320      if layer is 
+000089f0: 6e70 2e6e 616e 3a0a 2020 2020 2020 2020  np.nan:.        
+00008a00: 2020 2020 6c61 7965 7220 3d20 300a 0a20      layer = 0.. 
+00008a10: 2020 2020 2020 2069 6620 706f 696e 7473         if points
+00008a20: 2e6e 6469 6d20 3d3d 2032 3a0a 2020 2020  .ndim == 2:.    
+00008a30: 2020 2020 2020 2020 2320 6164 6420 7369          # add si
+00008a40: 6e67 6c65 2070 6f6c 7967 6f6e 2066 726f  ngle polygon fro
+00008a50: 6d20 706f 696e 7473 0a20 2020 2020 2020  m points.       
+00008a60: 2020 2020 2069 6620 6c65 6e28 706f 696e       if len(poin
+00008a70: 7473 5b30 5d29 203e 2032 3a0a 2020 2020  ts[0]) > 2:.    
+00008a80: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
+00008a90: 6e76 6572 7420 746f 2066 6f72 6d20 5b5b  nvert to form [[
+00008aa0: 312c 325d 2c5b 332c 345d 2c5b 352c 365d  1,2],[3,4],[5,6]
+00008ab0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00008ac0: 2020 706f 696e 7473 203d 206e 702e 636f    points = np.co
+00008ad0: 6c75 6d6e 5f73 7461 636b 2870 6f69 6e74  lumn_stack(point
+00008ae0: 7329 0a20 2020 2020 2020 2020 2020 206c  s).            l
+00008af0: 6179 6572 2c20 6461 7461 7479 7065 203d  ayer, datatype =
+00008b00: 205f 7061 7273 655f 6c61 7965 7228 6c61   _parse_layer(la
+00008b10: 7965 7229 0a20 2020 2020 2020 2020 2020  yer).           
+00008b20: 2070 6f6c 7967 6f6e 203d 2050 6f6c 7967   polygon = Polyg
+00008b30: 6f6e 2870 6f69 6e74 732c 206c 6179 6572  on(points, layer
+00008b40: 3d6c 6179 6572 2c20 6461 7461 7479 7065  =layer, datatype
+00008b50: 3d64 6174 6174 7970 6529 0a20 2020 2020  =datatype).     
+00008b60: 2020 2020 2020 2073 656c 662e 5f61 6464         self._add
+00008b70: 5f70 6f6c 7967 6f6e 7328 706f 6c79 676f  _polygons(polygo
+00008b80: 6e29 0a20 2020 2020 2020 2020 2020 2072  n).            r
+00008b90: 6574 7572 6e20 706f 6c79 676f 6e0a 2020  eturn polygon.  
+00008ba0: 2020 2020 2020 656c 6966 2070 6f69 6e74        elif point
+00008bb0: 732e 6e64 696d 203d 3d20 333a 0a20 2020  s.ndim == 3:.   
+00008bc0: 2020 2020 2020 2020 206c 6179 6572 2c20           layer, 
+00008bd0: 6461 7461 7479 7065 203d 205f 7061 7273  datatype = _pars
+00008be0: 655f 6c61 7965 7228 6c61 7965 7229 0a20  e_layer(layer). 
+00008bf0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
+00008c00: 6f6e 7320 3d20 5b0a 2020 2020 2020 2020  ons = [.        
+00008c10: 2020 2020 2020 2020 506f 6c79 676f 6e28          Polygon(
+00008c20: 7070 6f69 6e74 732c 206c 6179 6572 3d6c  ppoints, layer=l
+00008c30: 6179 6572 2c20 6461 7461 7479 7065 3d64  ayer, datatype=d
+00008c40: 6174 6174 7970 6529 2066 6f72 2070 706f  atatype) for ppo
+00008c50: 696e 7473 2069 6e20 706f 696e 7473 0a20  ints in points. 
+00008c60: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00008c70: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+00008c80: 6464 5f70 6f6c 7967 6f6e 7328 2a70 6f6c  dd_polygons(*pol
+00008c90: 7967 6f6e 7329 0a20 2020 2020 2020 2020  ygons).         
+00008ca0: 2020 2072 6574 7572 6e20 706f 6c79 676f     return polygo
+00008cb0: 6e73 0a20 2020 2020 2020 2065 6c73 653a  ns.        else:
+00008cc0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00008cd0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00008ce0: 556e 6162 6c65 2074 6f20 6164 6420 7b70  Unable to add {p
+00008cf0: 6f69 6e74 732e 6e64 696d 7d2d 6469 6d65  oints.ndim}-dime
+00008d00: 6e73 696f 6e61 6c20 706f 696e 7473 206f  nsional points o
+00008d10: 626a 6563 7422 290a 0a20 2020 2064 6566  bject")..    def
+00008d20: 205f 6164 645f 706f 6c79 676f 6e73 2873   _add_polygons(s
+00008d30: 656c 662c 202a 706f 6c79 676f 6e73 3a20  elf, *polygons: 
+00008d40: 4c69 7374 5b50 6f6c 7967 6f6e 5d29 202d  List[Polygon]) -
+00008d50: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00008d60: 7365 6c66 2e69 735f 756e 6c6f 636b 6564  self.is_unlocked
+00008d70: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00008d80: 5f63 656c 6c2e 6164 6428 2a70 6f6c 7967  _cell.add(*polyg
+00008d90: 6f6e 7329 0a0a 2020 2020 6465 6620 636f  ons)..    def co
+00008da0: 7079 2873 656c 6629 202d 3e20 436f 6d70  py(self) -> Comp
+00008db0: 6f6e 656e 743a 0a20 2020 2020 2020 2072  onent:.        r
+00008dc0: 6574 7572 6e20 636f 7079 2873 656c 6629  eturn copy(self)
+00008dd0: 0a0a 2020 2020 6465 6620 6164 645f 7265  ..    def add_re
+00008de0: 665f 636f 6e74 6169 6e65 7228 7365 6c66  f_container(self
+00008df0: 2c20 636f 6d70 6f6e 656e 743a 2043 6f6d  , component: Com
+00008e00: 706f 6e65 6e74 2920 2d3e 2043 6f6d 706f  ponent) -> Compo
+00008e10: 6e65 6e74 5265 6665 7265 6e63 653a 0a20  nentReference:. 
+00008e20: 2020 2020 2020 2022 2222 4164 6420 7265         """Add re
+00008e30: 6665 7265 6e63 652c 2070 6f72 7473 2061  ference, ports a
+00008e40: 6e64 2063 6f70 795f 6368 696c 645f 696e  nd copy_child_in
+00008e50: 666f 2e22 2222 0a20 2020 2020 2020 2072  fo.""".        r
+00008e60: 6566 203d 2073 656c 6620 3c3c 2063 6f6d  ef = self << com
+00008e70: 706f 6e65 6e74 0a20 2020 2020 2020 2073  ponent.        s
+00008e80: 656c 662e 6164 645f 706f 7274 7328 7265  elf.add_ports(re
+00008e90: 662e 706f 7274 7329 0a20 2020 2020 2020  f.ports).       
+00008ea0: 2073 656c 662e 636f 7079 5f63 6869 6c64   self.copy_child
+00008eb0: 5f69 6e66 6f28 636f 6d70 6f6e 656e 7429  _info(component)
+00008ec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008ed0: 7265 660a 0a20 2020 2064 6566 2063 6f70  ref..    def cop
+00008ee0: 795f 6368 696c 645f 696e 666f 2873 656c  y_child_info(sel
+00008ef0: 662c 2063 6f6d 706f 6e65 6e74 3a20 436f  f, component: Co
+00008f00: 6d70 6f6e 656e 7429 202d 3e20 4e6f 6e65  mponent) -> None
+00008f10: 3a0a 2020 2020 2020 2020 2222 2243 6f70  :.        """Cop
+00008f20: 7920 616e 6420 7365 7474 696e 6773 2069  y and settings i
+00008f30: 6e66 6f20 6672 6f6d 2063 6869 6c64 2063  nfo from child c
+00008f40: 6f6d 706f 6e65 6e74 2069 6e74 6f20 7061  omponent into pa
+00008f50: 7265 6e74 2e0a 0a20 2020 2020 2020 2050  rent...        P
+00008f60: 6172 656e 7420 636f 6d70 6f6e 656e 7473  arent components
+00008f70: 2063 616e 2061 6363 6573 7320 6368 696c   can access chil
+00008f80: 6420 6365 6c6c 7320 7365 7474 696e 6773  d cells settings
+00008f90: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00008fa0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00008fb0: 6e73 7461 6e63 6528 636f 6d70 6f6e 656e  nstance(componen
+00008fc0: 742c 2028 436f 6d70 6f6e 656e 742c 2043  t, (Component, C
+00008fd0: 6f6d 706f 6e65 6e74 5265 6665 7265 6e63  omponentReferenc
+00008fe0: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+00008ff0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00009000: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00009010: 2020 2066 227b 7479 7065 2863 6f6d 706f     f"{type(compo
+00009020: 6e65 6e74 297d 2220 2269 7320 6e6f 7420  nent)}" "is not 
+00009030: 6120 436f 6d70 6f6e 656e 7420 6f72 2043  a Component or C
+00009040: 6f6d 706f 6e65 6e74 5265 6665 7265 6e63  omponentReferenc
+00009050: 6522 0a20 2020 2020 2020 2020 2020 2029  e".            )
+00009060: 0a0a 2020 2020 2020 2020 7365 6c66 2e67  ..        self.g
+00009070: 6574 5f63 6869 6c64 5f6e 616d 6520 3d20  et_child_name = 
+00009080: 5472 7565 0a20 2020 2020 2020 2073 656c  True.        sel
+00009090: 662e 6368 696c 6420 3d20 636f 6d70 6f6e  f.child = compon
+000090a0: 656e 740a 2020 2020 2020 2020 7365 6c66  ent.        self
+000090b0: 2e69 6e66 6f2e 7570 6461 7465 2863 6f6d  .info.update(com
+000090c0: 706f 6e65 6e74 2e69 6e66 6f29 0a20 2020  ponent.info).   
+000090d0: 2020 2020 2073 656c 662e 7365 7474 696e       self.settin
+000090e0: 6773 2e75 7064 6174 6528 636f 6d70 6f6e  gs.update(compon
+000090f0: 656e 742e 7365 7474 696e 6773 290a 0a20  ent.settings).. 
+00009100: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00009110: 2064 6566 2073 697a 655f 696e 666f 2873   def size_info(s
+00009120: 656c 6629 202d 3e20 5369 7a65 496e 666f  elf) -> SizeInfo
+00009130: 3a0a 2020 2020 2020 2020 2222 2253 697a  :.        """Siz
+00009140: 6520 696e 666f 206f 6620 7468 6520 636f  e info of the co
+00009150: 6d70 6f6e 656e 742e 2222 220a 2020 2020  mponent.""".    
+00009160: 2020 2020 7265 7475 726e 2053 697a 6549      return SizeI
+00009170: 6e66 6f28 7365 6c66 2e62 626f 7829 0a0a  nfo(self.bbox)..
+00009180: 2020 2020 6465 6620 6765 745f 7365 7474      def get_sett
+00009190: 696e 6728 7365 6c66 2c20 7365 7474 696e  ing(self, settin
+000091a0: 673a 2073 7472 2920 2d3e 2055 6e69 6f6e  g: str) -> Union
+000091b0: 5b73 7472 2c20 696e 742c 2066 6c6f 6174  [str, int, float
+000091c0: 5d3a 0a20 2020 2020 2020 2072 6574 7572  ]:.        retur
+000091d0: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
+000091e0: 7365 6c66 2e69 6e66 6f2e 6765 7428 7365  self.info.get(se
+000091f0: 7474 696e 6729 0a20 2020 2020 2020 2020  tting).         
+00009200: 2020 206f 7220 7365 6c66 2e73 6574 7469     or self.setti
+00009210: 6e67 732e 6675 6c6c 2e67 6574 2873 6574  ngs.full.get(set
+00009220: 7469 6e67 290a 2020 2020 2020 2020 2020  ting).          
+00009230: 2020 6f72 2073 656c 662e 6d65 7461 6461    or self.metada
+00009240: 7461 5f63 6869 6c64 2e67 6574 2873 6574  ta_child.get(set
+00009250: 7469 6e67 290a 2020 2020 2020 2020 290a  ting).        ).
+00009260: 0a20 2020 2064 6566 2069 735f 756e 6c6f  .    def is_unlo
+00009270: 636b 6564 2873 656c 6629 202d 3e20 4e6f  cked(self) -> No
+00009280: 6e65 3a0a 2020 2020 2020 2020 2222 2252  ne:.        """R
+00009290: 6169 7365 7320 6572 726f 7220 6966 2043  aises error if C
+000092a0: 6f6d 706f 6e65 6e74 2069 7320 6c6f 636b  omponent is lock
+000092b0: 6564 2e22 2222 0a20 2020 2020 2020 2069  ed.""".        i
+000092c0: 6620 7365 6c66 2e5f 6c6f 636b 6564 3a0a  f self._locked:.
+000092d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000092e0: 6520 4d75 7461 6269 6c69 7479 4572 726f  e MutabilityErro
+000092f0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00009300: 2020 2066 2243 6f6d 706f 6e65 6e74 207b     f"Component {
+00009310: 7365 6c66 2e6e 616d 6521 727d 2063 616e  self.name!r} can
+00009320: 6e6f 7420 6265 206d 6f64 6966 6965 6420  not be modified 
+00009330: 6173 2069 7427 7320 616c 7265 6164 7920  as it's already 
+00009340: 6f6e 2063 6163 6865 2e20 220a 2020 2020  on cache. ".    
+00009350: 2020 2020 2020 2020 2020 2020 2b20 6d75              + mu
+00009360: 7461 6269 6c69 7479 5f65 7272 6f72 5f6d  tability_error_m
+00009370: 6573 7361 6765 0a20 2020 2020 2020 2020  essage.         
+00009380: 2020 2029 0a0a 2020 2020 6465 6620 5f61     )..    def _a
+00009390: 6464 2873 656c 662c 2065 6c65 6d65 6e74  dd(self, element
+000093a0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000093b0: 2020 2022 2222 4164 6420 6120 6e65 7720     """Add a new 
+000093c0: 656c 656d 656e 7420 6f72 206c 6973 7420  element or list 
+000093d0: 6f66 2065 6c65 6d65 6e74 7320 746f 2074  of elements to t
+000093e0: 6869 7320 436f 6d70 6f6e 656e 742e 0a0a  his Component...
+000093f0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+00009400: 2020 2020 2020 2020 2020 656c 656d 656e            elemen
+00009410: 743a 2050 6f6c 7967 6f6e 2c20 436f 6d70  t: Polygon, Comp
+00009420: 6f6e 656e 7452 6566 6572 656e 6365 206f  onentReference o
+00009430: 7220 6974 6572 6162 6c65 0a20 2020 2020  r iterable.     
+00009440: 2020 2020 2020 2020 2020 2054 6865 2065             The e
+00009450: 6c65 6d65 6e74 206f 7220 6974 6572 6162  lement or iterab
+00009460: 6c65 206f 6620 656c 656d 656e 7473 2074  le of elements t
+00009470: 6f20 6265 2069 6e73 6572 7465 6420 696e  o be inserted in
+00009480: 2074 6869 7320 6365 6c6c 2e0a 0a20 2020   this cell...   
+00009490: 2020 2020 2052 6169 7365 733a 0a20 2020       Raises:.   
+000094a0: 2020 2020 2020 2020 204d 7574 6162 696c           Mutabil
+000094b0: 6974 7945 7272 6f72 3a20 6966 2063 6f6d  ityError: if com
+000094c0: 706f 6e65 6e74 2069 7320 6c6f 636b 6564  ponent is locked
+000094d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000094e0: 2020 2020 2020 7365 6c66 2e69 735f 756e        self.is_un
+000094f0: 6c6f 636b 6564 2829 0a20 2020 2020 2020  locked().       
+00009500: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
+00009510: 6c65 6d65 6e74 2c20 436f 6d70 6f6e 656e  lement, Componen
+00009520: 7452 6566 6572 656e 6365 293a 0a20 2020  tReference):.   
+00009530: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
+00009540: 656c 6c2e 6164 6428 656c 656d 656e 742e  ell.add(element.
+00009550: 5f72 6566 6572 656e 6365 290a 2020 2020  _reference).    
+00009560: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+00009570: 6665 7265 6e63 6573 2e61 7070 656e 6428  ferences.append(
+00009580: 656c 656d 656e 7429 0a20 2020 2020 2020  element).       
+00009590: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000095a0: 2020 2073 656c 662e 5f63 656c 6c2e 6164     self._cell.ad
+000095b0: 6428 656c 656d 656e 7429 0a0a 2020 2020  d(element)..    
+000095c0: 6465 6620 6164 6428 7365 6c66 2c20 656c  def add(self, el
+000095d0: 656d 656e 7429 202d 3e20 4e6f 6e65 3a0a  ement) -> None:.
+000095e0: 2020 2020 2020 2020 2222 2241 6464 2061          """Add a
+000095f0: 206e 6577 2065 6c65 6d65 6e74 206f 7220   new element or 
+00009600: 6c69 7374 206f 6620 656c 656d 656e 7473  list of elements
+00009610: 2074 6f20 7468 6973 2043 6f6d 706f 6e65   to this Compone
+00009620: 6e74 2e0a 0a20 2020 2020 2020 2041 7267  nt...        Arg
+00009630: 733a 0a20 2020 2020 2020 2020 2020 2065  s:.            e
+00009640: 6c65 6d65 6e74 3a20 506f 6c79 676f 6e2c  lement: Polygon,
+00009650: 2043 6f6d 706f 6e65 6e74 5265 6665 7265   ComponentRefere
+00009660: 6e63 6520 6f72 2069 7465 7261 626c 650a  nce or iterable.
+00009670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009680: 5468 6520 656c 656d 656e 7420 6f72 2069  The element or i
+00009690: 7465 7261 626c 6520 6f66 2065 6c65 6d65  terable of eleme
+000096a0: 6e74 7320 746f 2062 6520 696e 7365 7274  nts to be insert
+000096b0: 6564 2069 6e20 7468 6973 2063 656c 6c2e  ed in this cell.
+000096c0: 0a0a 2020 2020 2020 2020 5261 6973 6573  ..        Raises
+000096d0: 3a0a 2020 2020 2020 2020 2020 2020 4d75  :.            Mu
+000096e0: 7461 6269 6c69 7479 4572 726f 723a 2069  tabilityError: i
+000096f0: 6620 636f 6d70 6f6e 656e 7420 6973 206c  f component is l
+00009700: 6f63 6b65 642e 0a20 2020 2020 2020 2022  ocked..        "
+00009710: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+00009720: 696e 7374 616e 6365 2865 6c65 6d65 6e74  instance(element
+00009730: 2c20 436f 6d70 6f6e 656e 7452 6566 6572  , ComponentRefer
+00009740: 656e 6365 293a 0a20 2020 2020 2020 2020  ence):.         
+00009750: 2020 2073 656c 662e 5f72 6567 6973 7465     self._registe
+00009760: 725f 7265 6665 7265 6e63 6528 656c 656d  r_reference(elem
+00009770: 656e 7429 0a20 2020 2020 2020 2020 2020  ent).           
+00009780: 2073 656c 662e 5f61 6464 2865 6c65 6d65   self._add(eleme
+00009790: 6e74 290a 2020 2020 2020 2020 656c 6966  nt).        elif
+000097a0: 2069 7369 6e73 7461 6e63 6528 656c 656d   isinstance(elem
+000097b0: 656e 742c 2049 7465 7261 626c 6529 3a0a  ent, Iterable):.
+000097c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000097d0: 7375 6265 6c65 6d65 6e74 2069 6e20 656c  subelement in el
+000097e0: 656d 656e 743a 0a20 2020 2020 2020 2020  ement:.         
+000097f0: 2020 2020 2020 2073 656c 662e 6164 6428         self.add(
+00009800: 7375 6265 6c65 6d65 6e74 290a 2020 2020  subelement).    
+00009810: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00009820: 2020 2020 2020 7365 6c66 2e5f 6164 6428        self._add(
+00009830: 656c 656d 656e 7429 0a0a 2020 2020 6465  element)..    de
+00009840: 6620 6164 645f 6172 7261 7928 0a20 2020  f add_array(.   
+00009850: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00009860: 2020 2063 6f6d 706f 6e65 6e74 3a20 436f     component: Co
+00009870: 6d70 6f6e 656e 742c 0a20 2020 2020 2020  mponent,.       
+00009880: 2063 6f6c 756d 6e73 3a20 696e 7420 3d20   columns: int = 
+00009890: 322c 0a20 2020 2020 2020 2072 6f77 733a  2,.        rows:
+000098a0: 2069 6e74 203d 2032 2c0a 2020 2020 2020   int = 2,.      
+000098b0: 2020 7370 6163 696e 673a 2054 7570 6c65    spacing: Tuple
+000098c0: 5b66 6c6f 6174 2c20 666c 6f61 745d 203d  [float, float] =
+000098d0: 2028 3130 302c 2031 3030 292c 0a20 2020   (100, 100),.   
+000098e0: 2020 2020 2061 6c69 6173 3a20 4f70 7469       alias: Opti
+000098f0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+00009900: 2c0a 2020 2020 2920 2d3e 2043 6f6d 706f  ,.    ) -> Compo
+00009910: 6e65 6e74 5265 6665 7265 6e63 653a 0a20  nentReference:. 
+00009920: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
+00009930: 7320 6120 436f 6d70 6f6e 656e 7452 6566  s a ComponentRef
+00009940: 6572 656e 6365 2072 6566 6572 656e 6365  erence reference
+00009950: 2074 6f20 6120 436f 6d70 6f6e 656e 742e   to a Component.
+00009960: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00009970: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00009980: 6f6e 656e 743a 2054 6865 2072 6566 6572  onent: The refer
+00009990: 656e 6365 6420 636f 6d70 6f6e 656e 742e  enced component.
+000099a0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000099b0: 756d 6e73 3a20 4e75 6d62 6572 206f 6620  umns: Number of 
+000099c0: 636f 6c75 6d6e 7320 696e 2074 6865 2061  columns in the a
+000099d0: 7272 6179 2e0a 2020 2020 2020 2020 2020  rray..          
+000099e0: 2020 726f 7773 3a20 4e75 6d62 6572 206f    rows: Number o
+000099f0: 6620 726f 7773 2069 6e20 7468 6520 6172  f rows in the ar
+00009a00: 7261 792e 0a20 2020 2020 2020 2020 2020  ray..           
+00009a10: 2073 7061 6369 6e67 3a20 6172 7261 792d   spacing: array-
+00009a20: 6c69 6b65 5b32 5d20 6f66 2069 6e74 206f  like[2] of int o
+00009a30: 7220 666c 6f61 742e 0a20 2020 2020 2020  r float..       
+00009a40: 2020 2020 2020 2020 2044 6973 7461 6e63           Distanc
+00009a50: 6520 6265 7477 6565 6e20 6164 6a61 6365  e between adjace
+00009a60: 6e74 2063 6f6c 756d 6e73 2061 6e64 2061  nt columns and a
+00009a70: 646a 6163 656e 7420 726f 7773 2e0a 2020  djacent rows..  
+00009a80: 2020 2020 2020 2020 2020 616c 6961 733a            alias:
+00009a90: 2073 7472 206f 7220 4e6f 6e65 2e20 416c   str or None. Al
+00009aa0: 6961 7320 6f66 2074 6865 2072 6566 6572  ias of the refer
+00009ab0: 656e 6365 6420 436f 6d70 6f6e 656e 742e  enced Component.
+00009ac0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00009ad0: 730a 2020 2020 2020 2020 2020 2020 613a  s.            a:
+00009ae0: 2043 6f6d 706f 6e65 6e74 5265 6665 7265   ComponentRefere
+00009af0: 6e63 6520 636f 6e74 6169 6e69 6e67 2072  nce containing r
+00009b00: 6566 6572 656e 6365 7320 746f 2074 6865  eferences to the
+00009b10: 2043 6f6d 706f 6e65 6e74 2e0a 2020 2020   Component..    
+00009b20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00009b30: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00009b40: 6528 636f 6d70 6f6e 656e 742c 2043 6f6d  e(component, Com
+00009b50: 706f 6e65 6e74 293a 0a20 2020 2020 2020  ponent):.       
+00009b60: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00009b70: 7272 6f72 2822 6164 645f 6172 7261 7928  rror("add_array(
+00009b80: 2920 6e65 6564 7320 6120 436f 6d70 6f6e  ) needs a Compon
+00009b90: 656e 7420 6f62 6a65 6374 2e22 290a 2020  ent object.").  
+00009ba0: 2020 2020 2020 7265 6620 3d20 436f 6d70        ref = Comp
+00009bb0: 6f6e 656e 7452 6566 6572 656e 6365 280a  onentReference(.
+00009bc0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00009bd0: 6f6e 656e 743d 636f 6d70 6f6e 656e 742c  onent=component,
+00009be0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00009bf0: 756d 6e73 3d69 6e74 2872 6f75 6e64 2863  umns=int(round(c
+00009c00: 6f6c 756d 6e73 2929 2c0a 2020 2020 2020  olumns)),.      
+00009c10: 2020 2020 2020 726f 7773 3d69 6e74 2872        rows=int(r
+00009c20: 6f75 6e64 2872 6f77 7329 292c 0a20 2020  ound(rows)),.   
+00009c30: 2020 2020 2020 2020 2073 7061 6369 6e67           spacing
+00009c40: 3d73 7061 6369 6e67 2c0a 2020 2020 2020  =spacing,.      
+00009c50: 2020 290a 2020 2020 2020 2020 7265 662e    ).        ref.
+00009c60: 6e61 6d65 203d 204e 6f6e 650a 2020 2020  name = None.    
+00009c70: 2020 2020 7365 6c66 2e5f 6164 6428 7265      self._add(re
+00009c80: 6629 0a20 2020 2020 2020 2073 656c 662e  f).        self.
+00009c90: 5f72 6567 6973 7465 725f 7265 6665 7265  _register_refere
+00009ca0: 6e63 6528 7265 6665 7265 6e63 653d 7265  nce(reference=re
+00009cb0: 662c 2061 6c69 6173 3d61 6c69 6173 290a  f, alias=alias).
+00009cc0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00009cd0: 6566 0a0a 2020 2020 6465 6620 6469 7374  ef..    def dist
+00009ce0: 7269 6275 7465 280a 2020 2020 2020 2020  ribute(.        
+00009cf0: 7365 6c66 2c20 656c 656d 656e 7473 3d22  self, elements="
+00009d00: 616c 6c22 2c20 6469 7265 6374 696f 6e3d  all", direction=
+00009d10: 2278 222c 2073 7061 6369 6e67 3d31 3030  "x", spacing=100
+00009d20: 2c20 7365 7061 7261 7469 6f6e 3d54 7275  , separation=Tru
+00009d30: 652c 2065 6467 653d 2263 656e 7465 7222  e, edge="center"
+00009d40: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00009d50: 2222 2244 6973 7472 6962 7574 6573 2074  """Distributes t
+00009d60: 6865 2073 7065 6369 6669 6564 2065 6c65  he specified ele
+00009d70: 6d65 6e74 7320 696e 2074 6865 2043 6f6d  ments in the Com
+00009d80: 706f 6e65 6e74 2e0a 0a20 2020 2020 2020  ponent...       
+00009d90: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00009da0: 2020 2065 6c65 6d65 6e74 7320 3a20 6172     elements : ar
+00009db0: 7261 792d 6c69 6b65 206f 6620 6f62 6a65  ray-like of obje
+00009dc0: 6374 7320 6f72 2027 616c 6c27 0a20 2020  cts or 'all'.   
+00009dd0: 2020 2020 2020 2020 2020 2020 2045 6c65               Ele
+00009de0: 6d65 6e74 7320 746f 2064 6973 7472 6962  ments to distrib
+00009df0: 7574 652e 0a20 2020 2020 2020 2020 2020  ute..           
+00009e00: 2064 6972 6563 7469 6f6e 203a 207b 2778   direction : {'x
+00009e10: 272c 2027 7927 7d0a 2020 2020 2020 2020  ', 'y'}.        
+00009e20: 2020 2020 2020 2020 4469 7265 6374 696f          Directio
+00009e30: 6e20 6f66 2064 6973 7472 6962 7574 696f  n of distributio
+00009e40: 6e3b 2065 6974 6865 7220 6120 6c69 6e65  n; either a line
+00009e50: 2069 6e20 7468 6520 782d 6469 7265 6374   in the x-direct
+00009e60: 696f 6e20 6f72 0a20 2020 2020 2020 2020  ion or.         
+00009e70: 2020 2020 2020 2079 2d64 6972 6563 7469         y-directi
+00009e80: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00009e90: 7370 6163 696e 6720 3a20 696e 7420 6f72  spacing : int or
+00009ea0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
+00009eb0: 2020 2020 2020 2044 6973 7461 6e63 6520         Distance 
+00009ec0: 6265 7477 6565 6e20 656c 656d 656e 7473  between elements
+00009ed0: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00009ee0: 7061 7261 7469 6f6e 203a 2062 6f6f 6c0a  paration : bool.
+00009ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f00: 4966 2054 7275 652c 2067 7561 7261 6e74  If True, guarant
+00009f10: 6565 7320 656c 656d 656e 7473 2061 7265  ees elements are
+00009f20: 2073 6570 6172 6174 6564 2077 6974 6820   separated with 
+00009f30: 6120 6669 7865 6420 7370 6163 696e 670a  a fixed spacing.
+00009f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f50: 6265 7477 6565 6e3b 2069 6620 2046 616c  between; if  Fal
+00009f60: 7365 2c20 656c 656d 656e 7473 2061 7265  se, elements are
+00009f70: 2073 7061 6365 6420 6576 656e 6c79 2061   spaced evenly a
+00009f80: 6c6f 6e67 2061 2067 7269 642e 0a20 2020  long a grid..   
+00009f90: 2020 2020 2020 2020 2065 6467 6520 3a20           edge : 
+00009fa0: 7b27 7827 2c20 2778 6d69 6e27 2c20 2778  {'x', 'xmin', 'x
+00009fb0: 6d61 7827 2c20 2779 272c 2027 796d 696e  max', 'y', 'ymin
+00009fc0: 272c 2027 796d 6178 277d 0a20 2020 2020  ', 'ymax'}.     
+00009fd0: 2020 2020 2020 2020 2020 2057 6869 6368             Which
+00009fe0: 2065 6467 6520 746f 2070 6572 666f 726d   edge to perform
+00009ff0: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+0000a000: 6e20 616c 6f6e 6720 2875 6e75 7365 6420  n along (unused 
+0000a010: 6966 0a20 2020 2020 2020 2020 2020 2020  if.             
+0000a020: 2020 2073 6570 6172 6174 696f 6e20 3d3d     separation ==
+0000a030: 2054 7275 6529 0a0a 2020 2020 2020 2020   True)..        
+0000a040: 2222 220a 2020 2020 2020 2020 6966 2065  """.        if e
+0000a050: 6c65 6d65 6e74 7320 3d3d 2022 616c 6c22  lements == "all"
+0000a060: 3a0a 2020 2020 2020 2020 2020 2020 656c  :.            el
+0000a070: 656d 656e 7473 203d 2073 656c 662e 706f  ements = self.po
+0000a080: 6c79 676f 6e73 202b 2073 656c 662e 7265  lygons + self.re
+0000a090: 6665 7265 6e63 6573 0a20 2020 2020 2020  ferences.       
+0000a0a0: 205f 6469 7374 7269 6275 7465 280a 2020   _distribute(.  
+0000a0b0: 2020 2020 2020 2020 2020 656c 656d 656e            elemen
+0000a0c0: 7473 3d65 6c65 6d65 6e74 732c 0a20 2020  ts=elements,.   
+0000a0d0: 2020 2020 2020 2020 2064 6972 6563 7469           directi
+0000a0e0: 6f6e 3d64 6972 6563 7469 6f6e 2c0a 2020  on=direction,.  
+0000a0f0: 2020 2020 2020 2020 2020 7370 6163 696e            spacin
+0000a100: 673d 7370 6163 696e 672c 0a20 2020 2020  g=spacing,.     
+0000a110: 2020 2020 2020 2073 6570 6172 6174 696f         separatio
+0000a120: 6e3d 7365 7061 7261 7469 6f6e 2c0a 2020  n=separation,.  
+0000a130: 2020 2020 2020 2020 2020 6564 6765 3d65            edge=e
+0000a140: 6467 652c 0a20 2020 2020 2020 2029 0a20  dge,.        ). 
+0000a150: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000a160: 6c66 0a0a 2020 2020 6465 6620 616c 6967  lf..    def alig
+0000a170: 6e28 7365 6c66 2c20 656c 656d 656e 7473  n(self, elements
+0000a180: 3d22 616c 6c22 2c20 616c 6967 6e6d 656e  ="all", alignmen
+0000a190: 743d 2279 6d61 7822 293a 0a20 2020 2020  t="ymax"):.     
+0000a1a0: 2020 2022 2222 416c 6967 6e20 656c 656d     """Align elem
+0000a1b0: 656e 7473 2069 6e20 7468 6520 436f 6d70  ents in the Comp
+0000a1c0: 6f6e 656e 742e 0a0a 2020 2020 2020 2020  onent...        
+0000a1d0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+0000a1e0: 2020 656c 656d 656e 7473 203a 2061 7272    elements : arr
+0000a1f0: 6179 2d6c 696b 6520 6f66 206f 626a 6563  ay-like of objec
+0000a200: 7473 2c20 6f72 2027 616c 6c27 0a20 2020  ts, or 'all'.   
+0000a210: 2020 2020 2020 2020 2020 2020 2045 6c65               Ele
+0000a220: 6d65 6e74 7320 696e 2074 6865 2043 6f6d  ments in the Com
+0000a230: 706f 6e65 6e74 2074 6f20 616c 6967 6e2e  ponent to align.
+0000a240: 0a20 2020 2020 2020 2020 2020 2061 6c69  .            ali
+0000a250: 676e 6d65 6e74 203a 207b 2778 272c 2027  gnment : {'x', '
+0000a260: 7927 2c20 2778 6d69 6e27 2c20 2778 6d61  y', 'xmin', 'xma
+0000a270: 7827 2c20 2779 6d69 6e27 2c20 2779 6d61  x', 'ymin', 'yma
+0000a280: 7827 7d0a 2020 2020 2020 2020 2020 2020  x'}.            
+0000a290: 2020 2020 5768 6963 6820 6564 6765 2074      Which edge t
+0000a2a0: 6f20 616c 6967 6e20 616c 6f6e 6720 2865  o align along (e
+0000a2b0: 2e67 2e20 2779 6d61 7827 2077 696c 6c20  .g. 'ymax' will 
+0000a2c0: 6d6f 7665 2074 6865 2065 6c65 6d65 6e74  move the element
+0000a2d0: 7320 7375 6368 0a20 2020 2020 2020 2020  s such.         
+0000a2e0: 2020 2020 2020 2074 6861 7420 616c 6c20         that all 
+0000a2f0: 6f66 2074 6865 6972 2074 6f70 6d6f 7374  of their topmost
+0000a300: 2070 6f69 6e74 7320 6172 6520 616c 6967   points are alig
+0000a310: 6e65 6429 2e0a 2020 2020 2020 2020 2222  ned)..        ""
+0000a320: 220a 2020 2020 2020 2020 6966 2065 6c65  ".        if ele
+0000a330: 6d65 6e74 7320 3d3d 2022 616c 6c22 3a0a  ments == "all":.
+0000a340: 2020 2020 2020 2020 2020 2020 656c 656d              elem
+0000a350: 656e 7473 203d 2073 656c 662e 706f 6c79  ents = self.poly
+0000a360: 676f 6e73 202b 2073 656c 662e 7265 6665  gons + self.refe
+0000a370: 7265 6e63 6573 0a20 2020 2020 2020 205f  rences.        _
+0000a380: 616c 6967 6e28 656c 656d 656e 7473 2c20  align(elements, 
+0000a390: 616c 6967 6e6d 656e 743d 616c 6967 6e6d  alignment=alignm
+0000a3a0: 656e 7429 0a20 2020 2020 2020 2072 6574  ent).        ret
+0000a3b0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+0000a3c0: 6620 666c 6174 7465 6e28 7365 6c66 2c20  f flatten(self, 
+0000a3d0: 7369 6e67 6c65 5f6c 6179 6572 3a20 4f70  single_layer: Op
+0000a3e0: 7469 6f6e 616c 5b4c 6179 6572 5370 6563  tional[LayerSpec
+0000a3f0: 5d20 3d20 4e6f 6e65 293a 0a20 2020 2020  ] = None):.     
+0000a400: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+0000a410: 666c 6174 7465 6e65 6420 636f 7079 206f  flattened copy o
+0000a420: 6620 7468 6520 636f 6d70 6f6e 656e 742e  f the component.
+0000a430: 0a0a 2020 2020 2020 2020 466c 6174 7465  ..        Flatte
+0000a440: 6e73 2074 6865 2068 6965 7261 7263 6879  ns the hierarchy
+0000a450: 206f 6620 7468 6520 436f 6d70 6f6e 656e   of the Componen
+0000a460: 7420 7375 6368 2074 6861 7420 7468 6572  t such that ther
+0000a470: 6520 6172 6520 6e6f 206c 6f6e 6765 720a  e are no longer.
+0000a480: 2020 2020 2020 2020 616e 7920 7265 6665          any refe
+0000a490: 7265 6e63 6573 2074 6f20 6f74 6865 7220  rences to other 
+0000a4a0: 436f 6d70 6f6e 656e 7473 2e20 416c 6c20  Components. All 
+0000a4b0: 706f 6c79 676f 6e73 2061 6e64 206c 6162  polygons and lab
+0000a4c0: 656c 7320 6672 6f6d 0a20 2020 2020 2020  els from.       
+0000a4d0: 2075 6e64 6572 6c79 696e 6720 7265 6665   underlying refe
+0000a4e0: 7265 6e63 6573 2061 7265 2063 6f70 6965  rences are copie
+0000a4f0: 6420 616e 6420 706c 6163 6564 2069 6e20  d and placed in 
+0000a500: 7468 6520 746f 702d 6c65 7665 6c20 436f  the top-level Co
+0000a510: 6d70 6f6e 656e 742e 0a20 2020 2020 2020  mponent..       
+0000a520: 2049 6620 7369 6e67 6c65 5f6c 6179 6572   If single_layer
+0000a530: 2069 7320 7370 6563 6966 6965 642c 2061   is specified, a
+0000a540: 6c6c 2070 6f6c 7967 6f6e 7320 6172 6520  ll polygons are 
+0000a550: 6d6f 7665 6420 746f 2074 6861 7420 6c61  moved to that la
+0000a560: 7965 722e 0a0a 2020 2020 2020 2020 4172  yer...        Ar
+0000a570: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0000a580: 7369 6e67 6c65 5f6c 6179 6572 3a20 6d6f  single_layer: mo
+0000a590: 7665 2061 6c6c 2070 6f6c 7967 6f6e 7320  ve all polygons 
+0000a5a0: 6172 6520 6d6f 7665 6420 746f 2074 6865  are moved to the
+0000a5b0: 2073 7065 6369 6669 6564 2028 6f70 7469   specified (opti
+0000a5c0: 6f6e 616c 292e 0a20 2020 2020 2020 2022  onal)..        "
+0000a5d0: 2222 0a20 2020 2020 2020 2063 6f6d 706f  "".        compo
+0000a5e0: 6e65 6e74 5f66 6c61 7420 3d20 436f 6d70  nent_flat = Comp
+0000a5f0: 6f6e 656e 7428 290a 0a20 2020 2020 2020  onent()..       
+0000a600: 205f 6365 6c6c 203d 2073 656c 662e 5f63   _cell = self._c
+0000a610: 656c 6c2e 636f 7079 286e 616d 653d 636f  ell.copy(name=co
+0000a620: 6d70 6f6e 656e 745f 666c 6174 2e6e 616d  mponent_flat.nam
+0000a630: 6529 0a20 2020 2020 2020 205f 6365 6c6c  e).        _cell
+0000a640: 203d 205f 6365 6c6c 2e66 6c61 7474 656e   = _cell.flatten
+0000a650: 2829 0a20 2020 2020 2020 2063 6f6d 706f  ().        compo
+0000a660: 6e65 6e74 5f66 6c61 742e 5f63 656c 6c20  nent_flat._cell 
+0000a670: 3d20 5f63 656c 6c0a 2020 2020 2020 2020  = _cell.        
+0000a680: 6966 2073 696e 676c 655f 6c61 7965 7220  if single_layer 
+0000a690: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000a6a0: 2020 2020 2020 2020 2066 726f 6d20 6764           from gd
+0000a6b0: 7366 6163 746f 7279 2069 6d70 6f72 7420  sfactory import 
+0000a6c0: 6765 745f 6c61 7965 720a 0a20 2020 2020  get_layer..     
+0000a6d0: 2020 2020 2020 206c 6179 6572 2c20 6461         layer, da
+0000a6e0: 7461 7479 7065 203d 2067 6574 5f6c 6179  tatype = get_lay
+0000a6f0: 6572 2873 696e 676c 655f 6c61 7965 7229  er(single_layer)
+0000a700: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000a710: 2070 6f6c 7967 6f6e 2069 6e20 5f63 656c   polygon in _cel
+0000a720: 6c2e 706f 6c79 676f 6e73 3a0a 2020 2020  l.polygons:.    
 0000a730: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
-0000a740: 676f 6e2e 6461 7461 7479 7065 203d 2064  gon.datatype = d
-0000a750: 6174 6174 7970 650a 2020 2020 2020 2020  atatype.        
-0000a760: 2020 2020 666f 7220 7061 7468 2069 6e20      for path in 
-0000a770: 5f63 656c 6c2e 7061 7468 733a 0a20 2020  _cell.paths:.   
-0000a780: 2020 2020 2020 2020 2020 2020 2070 6174               pat
-0000a790: 682e 7365 745f 6c61 7965 7273 286c 6179  h.set_layers(lay
-0000a7a0: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-0000a7b0: 2020 2020 7061 7468 2e73 6574 5f64 6174      path.set_dat
-0000a7c0: 6174 7970 6573 2864 6174 6174 7970 6529  atypes(datatype)
-0000a7d0: 0a0a 2020 2020 2020 2020 636f 6d70 6f6e  ..        compon
-0000a7e0: 656e 745f 666c 6174 2e69 6e66 6f20 3d20  ent_flat.info = 
-0000a7f0: 7365 6c66 2e69 6e66 6f2e 636f 7079 2829  self.info.copy()
-0000a800: 0a20 2020 2020 2020 2063 6f6d 706f 6e65  .        compone
-0000a810: 6e74 5f66 6c61 742e 6164 645f 706f 7274  nt_flat.add_port
-0000a820: 7328 7365 6c66 2e70 6f72 7473 290a 2020  s(self.ports).  
-0000a830: 2020 2020 2020 7265 7475 726e 2063 6f6d        return com
-0000a840: 706f 6e65 6e74 5f66 6c61 740a 0a20 2020  ponent_flat..   
-0000a850: 2064 6566 2066 6c61 7474 656e 5f72 6566   def flatten_ref
-0000a860: 6572 656e 6365 2873 656c 662c 2072 6566  erence(self, ref
-0000a870: 3a20 436f 6d70 6f6e 656e 7452 6566 6572  : ComponentRefer
-0000a880: 656e 6365 2920 2d3e 204e 6f6e 653a 0a20  ence) -> None:. 
-0000a890: 2020 2020 2020 2022 2222 4672 6f6d 2065         """From e
-0000a8a0: 7869 7374 696e 6720 6365 6c6c 2072 6570  xisting cell rep
-0000a8b0: 6c61 6365 7320 7265 6665 7265 6e63 6520  laces reference 
-0000a8c0: 7769 7468 2061 2066 6c61 7474 656e 2072  with a flatten r
-0000a8d0: 6566 6572 656e 6365 205c 0a20 2020 2020  eference \.     
-0000a8e0: 2020 2077 6869 6368 2068 6173 2074 6865     which has the
-0000a8f0: 2074 7261 6e73 666f 726d 6174 696f 6e73   transformations
-0000a900: 2061 6c72 6561 6479 2061 7070 6c69 6564   already applied
-0000a910: 2e0a 0a20 2020 2020 2020 2054 7261 6e73  ...        Trans
-0000a920: 666f 726d 6564 2072 6566 6572 656e 6365  formed reference
-0000a930: 206b 6565 7073 2074 6865 206f 7269 6769   keeps the origi
-0000a940: 6e61 6c20 6e61 6d65 2e0a 0a20 2020 2020  nal name...     
-0000a950: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000a960: 2020 2020 2072 6566 3a20 7468 6520 7265       ref: the re
-0000a970: 6665 7265 6e63 6520 746f 2066 6c61 7474  ference to flatt
-0000a980: 656e 2069 6e74 6f20 6120 6e65 7720 6365  en into a new ce
-0000a990: 6c6c 2e0a 0a20 2020 2020 2020 2022 2222  ll...        """
-0000a9a0: 0a20 2020 2020 2020 2066 726f 6d20 6764  .        from gd
-0000a9b0: 7366 6163 746f 7279 2e66 756e 6374 696f  sfactory.functio
-0000a9c0: 6e73 2069 6d70 6f72 7420 7472 616e 7366  ns import transf
-0000a9d0: 6f72 6d65 640a 0a20 2020 2020 2020 2073  ormed..        s
-0000a9e0: 656c 662e 7265 6d6f 7665 2872 6566 290a  elf.remove(ref).
-0000a9f0: 2020 2020 2020 2020 6e65 775f 636f 6d70          new_comp
-0000aa00: 6f6e 656e 7420 3d20 7472 616e 7366 6f72  onent = transfor
-0000aa10: 6d65 6428 7265 662c 2064 6563 6f72 6174  med(ref, decorat
-0000aa20: 6f72 3d4e 6f6e 6529 0a20 2020 2020 2020  or=None).       
-0000aa30: 2073 656c 662e 6164 645f 7265 6628 6e65   self.add_ref(ne
-0000aa40: 775f 636f 6d70 6f6e 656e 742c 2061 6c69  w_component, ali
-0000aa50: 6173 3d72 6566 2e6e 616d 6529 0a0a 2020  as=ref.name)..  
-0000aa60: 2020 6465 6620 6164 645f 7265 6628 0a20    def add_ref(. 
-0000aa70: 2020 2020 2020 2073 656c 662c 2063 6f6d         self, com
-0000aa80: 706f 6e65 6e74 3a20 436f 6d70 6f6e 656e  ponent: Componen
-0000aa90: 742c 2061 6c69 6173 3a20 4f70 7469 6f6e  t, alias: Option
-0000aaa0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c20  al[str] = None, 
-0000aab0: 2a2a 6b77 6172 6773 0a20 2020 2029 202d  **kwargs.    ) -
-0000aac0: 3e20 436f 6d70 6f6e 656e 7452 6566 6572  > ComponentRefer
-0000aad0: 656e 6365 3a0a 2020 2020 2020 2020 2222  ence:.        ""
-0000aae0: 2241 6464 2043 6f6d 706f 6e65 6e74 5265  "Add ComponentRe
-0000aaf0: 6665 7265 6e63 6520 746f 2074 6865 2063  ference to the c
-0000ab00: 7572 7265 6e74 2043 6f6d 706f 6e65 6e74  urrent Component
-0000ab10: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0000ab20: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0000ab30: 706f 6e65 6e74 3a20 436f 6d70 6f6e 656e  ponent: Componen
-0000ab40: 742e 0a20 2020 2020 2020 2020 2020 2061  t..            a
-0000ab50: 6c69 6173 3a20 6e61 6d65 645f 7265 6665  lias: named_refe
-0000ab60: 7265 6e63 6573 2e0a 0a20 2020 2020 2020  rences...       
-0000ab70: 204b 6579 776f 7264 2041 7267 733a 0a20   Keyword Args:. 
-0000ab80: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0000ab90: 6e73 3a20 4e75 6d62 6572 206f 6620 636f  ns: Number of co
-0000aba0: 6c75 6d6e 7320 696e 2074 6865 2061 7272  lumns in the arr
-0000abb0: 6179 2e0a 2020 2020 2020 2020 2020 2020  ay..            
-0000abc0: 726f 7773 3a20 4e75 6d62 6572 206f 6620  rows: Number of 
-0000abd0: 726f 7773 2069 6e20 7468 6520 6172 7261  rows in the arra
-0000abe0: 792e 0a20 2020 2020 2020 2020 2020 2073  y..            s
-0000abf0: 7061 6369 6e67 3a20 4469 7374 616e 6365  pacing: Distance
-0000ac00: 7320 6265 7477 6565 6e20 6164 6a61 6365  s between adjace
-0000ac10: 6e74 2063 6f6c 756d 6e73 2061 6e64 2061  nt columns and a
-0000ac20: 646a 6163 656e 7420 726f 7773 2e0a 2020  djacent rows..  
-0000ac30: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-0000ac40: 3a20 6172 7261 792d 6c69 6b65 5b32 5d20  : array-like[2] 
-0000ac50: 6f66 2069 6e74 206f 7220 666c 6f61 740a  of int or float.
-0000ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac70: 506f 7369 7469 6f6e 2077 6865 7265 2074  Position where t
-0000ac80: 6865 2063 656c 6c20 6973 2069 6e73 6572  he cell is inser
-0000ac90: 7465 642e 0a20 2020 2020 2020 2020 2020  ted..           
-0000aca0: 2072 6f74 6174 696f 6e20 3a20 696e 7420   rotation : int 
-0000acb0: 6f72 2066 6c6f 6174 0a20 2020 2020 2020  or float.       
-0000acc0: 2020 2020 2020 2020 2041 6e67 6c65 206f           Angle o
-0000acd0: 6620 726f 7461 7469 6f6e 206f 6620 7468  f rotation of th
-0000ace0: 6520 7265 6665 7265 6e63 6520 2869 6e20  e reference (in 
-0000acf0: 6064 6567 7265 6573 6029 2e0a 2020 2020  `degrees`)..    
-0000ad00: 2020 2020 2020 2020 6d61 676e 6966 6963          magnific
-0000ad10: 6174 696f 6e20 3a20 696e 7420 6f72 2066  ation : int or f
-0000ad20: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-0000ad30: 2020 2020 204d 6167 6e69 6669 6361 7469       Magnificati
-0000ad40: 6f6e 2066 6163 746f 7220 666f 7220 7468  on factor for th
-0000ad50: 6520 7265 6665 7265 6e63 652e 0a20 2020  e reference..   
-0000ad60: 2020 2020 2020 2020 2078 5f72 6566 6c65           x_refle
-0000ad70: 6374 696f 6e20 3a20 626f 6f6c 0a20 2020  ction : bool.   
-0000ad80: 2020 2020 2020 2020 2020 2020 2049 6620               If 
-0000ad90: 5472 7565 2c20 7468 6520 7265 6665 7265  True, the refere
-0000ada0: 6e63 6520 6973 2072 6566 6c65 6374 6564  nce is reflected
-0000adb0: 2070 6172 616c 6c65 6c20 746f 2074 6865   parallel to the
-0000adc0: 2078 2064 6972 6563 7469 6f6e 0a20 2020   x direction.   
-0000add0: 2020 2020 2020 2020 2020 2020 2062 6566               bef
-0000ade0: 6f72 6520 6265 696e 6720 726f 7461 7465  ore being rotate
-0000adf0: 642e 0a20 2020 2020 2020 2020 2020 206e  d..            n
-0000ae00: 616d 6520 3a20 7374 7220 286f 7074 696f  ame : str (optio
-0000ae10: 6e61 6c29 0a20 2020 2020 2020 2020 2020  nal).           
-0000ae20: 2020 2020 2041 206e 616d 6520 666f 7220       A name for 
-0000ae30: 7468 6520 7265 6665 7265 6e63 6520 2869  the reference (i
-0000ae40: 6620 7072 6f76 6964 6564 292e 0a0a 2020  f provided)...  
-0000ae50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ae60: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0000ae70: 6e63 6528 636f 6d70 6f6e 656e 742c 2043  nce(component, C
-0000ae80: 6f6d 706f 6e65 6e74 293a 0a20 2020 2020  omponent):.     
-0000ae90: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000aea0: 6545 7272 6f72 2866 2274 7970 6520 3d20  eError(f"type = 
-0000aeb0: 7b74 7970 6528 436f 6d70 6f6e 656e 7429  {type(Component)
-0000aec0: 7d20 6e65 6564 7320 746f 2062 6520 6120  } needs to be a 
-0000aed0: 436f 6d70 6f6e 656e 742e 2229 0a20 2020  Component.").   
-0000aee0: 2020 2020 2072 6566 203d 2043 6f6d 706f       ref = Compo
-0000aef0: 6e65 6e74 5265 6665 7265 6e63 6528 636f  nentReference(co
-0000af00: 6d70 6f6e 656e 742c 202a 2a6b 7761 7267  mponent, **kwarg
-0000af10: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-0000af20: 5f61 6464 2872 6566 290a 2020 2020 2020  _add(ref).      
-0000af30: 2020 7365 6c66 2e5f 7265 6769 7374 6572    self._register
-0000af40: 5f72 6566 6572 656e 6365 2872 6566 6572  _reference(refer
-0000af50: 656e 6365 3d72 6566 2c20 616c 6961 733d  ence=ref, alias=
-0000af60: 616c 6961 7329 0a20 2020 2020 2020 2072  alias).        r
-0000af70: 6574 7572 6e20 7265 660a 0a20 2020 2064  eturn ref..    d
-0000af80: 6566 205f 7265 6769 7374 6572 5f72 6566  ef _register_ref
-0000af90: 6572 656e 6365 280a 2020 2020 2020 2020  erence(.        
-0000afa0: 7365 6c66 2c20 7265 6665 7265 6e63 653a  self, reference:
-0000afb0: 2043 6f6d 706f 6e65 6e74 5265 6665 7265   ComponentRefere
-0000afc0: 6e63 652c 2061 6c69 6173 3a20 4f70 7469  nce, alias: Opti
-0000afd0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-0000afe0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0000aff0: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
-0000b000: 7420 3d20 7265 6665 7265 6e63 652e 7061  t = reference.pa
-0000b010: 7265 6e74 0a20 2020 2020 2020 2072 6566  rent.        ref
-0000b020: 6572 656e 6365 2e6f 776e 6572 203d 2073  erence.owner = s
-0000b030: 656c 660a 0a20 2020 2020 2020 2069 6620  elf..        if 
-0000b040: 616c 6961 7320 6973 204e 6f6e 653a 0a20  alias is None:. 
-0000b050: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-0000b060: 6665 7265 6e63 652e 6e61 6d65 2069 7320  ference.name is 
-0000b070: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000b080: 2020 2020 2020 2020 2020 616c 6961 7320            alias 
-0000b090: 3d20 7265 6665 7265 6e63 652e 6e61 6d65  = reference.name
-0000b0a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0000b0b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000b0c0: 2020 2070 7265 6669 7820 3d20 280a 2020     prefix = (.  
-0000b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0e0: 2020 636f 6d70 6f6e 656e 742e 7365 7474    component.sett
-0000b0f0: 696e 6773 2e66 756e 6374 696f 6e5f 6e61  ings.function_na
-0000b100: 6d65 0a20 2020 2020 2020 2020 2020 2020  me.             
-0000b110: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-0000b120: 7228 636f 6d70 6f6e 656e 742c 2022 7365  r(component, "se
-0000b130: 7474 696e 6773 2229 0a20 2020 2020 2020  ttings").       
-0000b140: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-0000b150: 2068 6173 6174 7472 2863 6f6d 706f 6e65   hasattr(compone
-0000b160: 6e74 2e73 6574 7469 6e67 732c 2022 6675  nt.settings, "fu
-0000b170: 6e63 7469 6f6e 5f6e 616d 6522 290a 2020  nction_name").  
-0000b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b190: 2020 656c 7365 2063 6f6d 706f 6e65 6e74    else component
-0000b1a0: 2e6e 616d 650a 2020 2020 2020 2020 2020  .name.          
-0000b1b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000b1c0: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-0000b1d0: 6665 7265 6e63 655f 6e61 6d65 735f 636f  ference_names_co
-0000b1e0: 756e 7465 722e 7570 6461 7465 287b 7072  unter.update({pr
-0000b1f0: 6566 6978 3a20 317d 290a 2020 2020 2020  efix: 1}).      
-0000b200: 2020 2020 2020 2020 2020 616c 6961 7320            alias 
-0000b210: 3d20 6622 7b70 7265 6669 787d 5f7b 7365  = f"{prefix}_{se
-0000b220: 6c66 2e5f 7265 6665 7265 6e63 655f 6e61  lf._reference_na
-0000b230: 6d65 735f 636f 756e 7465 725b 7072 6566  mes_counter[pref
-0000b240: 6978 5d7d 220a 0a20 2020 2020 2020 2020  ix]}"..         
-0000b250: 2020 2020 2020 2077 6869 6c65 2061 6c69         while ali
-0000b260: 6173 2069 6e20 7365 6c66 2e5f 6e61 6d65  as in self._name
-0000b270: 645f 7265 6665 7265 6e63 6573 3a0a 2020  d_references:.  
-0000b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b290: 2020 7365 6c66 2e5f 7265 6665 7265 6e63    self._referenc
-0000b2a0: 655f 6e61 6d65 735f 636f 756e 7465 722e  e_names_counter.
-0000b2b0: 7570 6461 7465 287b 7072 6566 6978 3a20  update({prefix: 
-0000b2c0: 317d 290a 2020 2020 2020 2020 2020 2020  1}).            
-0000b2d0: 2020 2020 2020 2020 616c 6961 7320 3d20          alias = 
-0000b2e0: 6622 7b70 7265 6669 787d 5f7b 7365 6c66  f"{prefix}_{self
-0000b2f0: 2e5f 7265 6665 7265 6e63 655f 6e61 6d65  ._reference_name
-0000b300: 735f 636f 756e 7465 725b 7072 6566 6978  s_counter[prefix
-0000b310: 5d7d 220a 0a20 2020 2020 2020 2072 6566  ]}"..        ref
-0000b320: 6572 656e 6365 2e6e 616d 6520 3d20 616c  erence.name = al
-0000b330: 6961 730a 2020 2020 2020 2020 7365 6c66  ias.        self
-0000b340: 2e5f 6e61 6d65 645f 7265 6665 7265 6e63  ._named_referenc
-0000b350: 6573 5b61 6c69 6173 5d20 3d20 7265 6665  es[alias] = refe
-0000b360: 7265 6e63 650a 0a20 2020 2040 7072 6f70  rence..    @prop
-0000b370: 6572 7479 0a20 2020 2064 6566 206c 6179  erty.    def lay
-0000b380: 6572 7328 7365 6c66 2920 2d3e 2053 6574  ers(self) -> Set
-0000b390: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-0000b3a0: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-0000b3b0: 7475 726e 7320 6120 7365 7420 6f66 2074  turns a set of t
-0000b3c0: 6865 204c 6179 6572 7320 696e 2074 6865  he Layers in the
-0000b3d0: 2043 6f6d 706f 6e65 6e74 2e22 2222 0a20   Component.""". 
-0000b3e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000b3f0: 6c66 2e67 6574 5f6c 6179 6572 7328 290a  lf.get_layers().
-0000b400: 0a20 2020 2064 6566 2067 6574 5f6c 6179  .    def get_lay
-0000b410: 6572 7328 7365 6c66 2920 2d3e 2053 6574  ers(self) -> Set
-0000b420: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-0000b430: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-0000b440: 7475 726e 2061 2073 6574 206f 6620 286c  turn a set of (l
-0000b450: 6179 6572 2c20 6461 7461 7479 7065 292e  ayer, datatype).
-0000b460: 0a0a 2020 2020 2020 2020 2e2e 2063 6f64  ..        .. cod
-0000b470: 6520 3a3a 0a0a 2020 2020 2020 2020 2020  e ::..          
-0000b480: 2020 696d 706f 7274 2067 6473 6661 6374    import gdsfact
-0000b490: 6f72 7920 6173 2067 660a 2020 2020 2020  ory as gf.      
-0000b4a0: 2020 2020 2020 6766 2e63 6f6d 706f 6e65        gf.compone
-0000b4b0: 6e74 732e 7374 7261 6967 6874 2829 2e67  nts.straight().g
-0000b4c0: 6574 5f6c 6179 6572 7328 2920 3d3d 207b  et_layers() == {
-0000b4d0: 2831 2c20 3029 2c20 2831 3131 2c20 3029  (1, 0), (111, 0)
-0000b4e0: 7d0a 2020 2020 2020 2020 2222 220a 2020  }.        """.  
-0000b4f0: 2020 2020 2020 706f 6c79 676f 6e73 203d        polygons =
-0000b500: 2073 656c 662e 5f63 656c 6c2e 6765 745f   self._cell.get_
-0000b510: 706f 6c79 676f 6e73 2864 6570 7468 3d4e  polygons(depth=N
-0000b520: 6f6e 6529 0a20 2020 2020 2020 2072 6574  one).        ret
-0000b530: 7572 6e20 7b28 706f 6c79 676f 6e2e 6c61  urn {(polygon.la
-0000b540: 7965 722c 2070 6f6c 7967 6f6e 2e64 6174  yer, polygon.dat
-0000b550: 6174 7970 6529 2066 6f72 2070 6f6c 7967  atype) for polyg
-0000b560: 6f6e 2069 6e20 706f 6c79 676f 6e73 7d0a  on in polygons}.
-0000b570: 0a20 2020 2064 6566 2067 6574 5f6c 6179  .    def get_lay
-0000b580: 6572 5f6e 616d 6573 2873 656c 6629 202d  er_names(self) -
-0000b590: 3e20 4c69 7374 5b54 7570 6c65 5b69 6e74  > List[Tuple[int
-0000b5a0: 2c20 696e 745d 5d3a 0a20 2020 2020 2020  , int]]:.       
-0000b5b0: 2022 2222 5265 7475 726e 206c 6179 6572   """Return layer
-0000b5c0: 206e 616d 6573 2075 7365 6420 696e 2074   names used in t
-0000b5d0: 6865 2064 6573 6967 6e2e 0a0a 2020 2020  he design...    
-0000b5e0: 2020 2020 2e2e 2063 6f64 6520 3a3a 0a0a      .. code ::..
-0000b5f0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-0000b600: 7274 2067 6473 6661 6374 6f72 7920 6173  rt gdsfactory as
-0000b610: 2067 660a 2020 2020 2020 2020 2020 2020   gf.            
-0000b620: 6766 2e63 6f6d 706f 6e65 6e74 732e 7374  gf.components.st
-0000b630: 7261 6967 6874 2829 2e67 6574 5f6e 616d  raight().get_nam
-0000b640: 6573 2829 203d 3d20 5b27 5747 275d 0a20  es() == ['WG']. 
-0000b650: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000b660: 2020 2069 6d70 6f72 7420 6764 7366 6163     import gdsfac
-0000b670: 746f 7279 2061 7320 6766 0a0a 2020 2020  tory as gf..    
-0000b680: 2020 2020 5044 4b20 3d20 6766 2e67 6574      PDK = gf.get
-0000b690: 5f61 6374 6976 655f 7064 6b28 290a 2020  _active_pdk().  
-0000b6a0: 2020 2020 2020 4c41 5945 5253 203d 2050        LAYERS = P
-0000b6b0: 444b 2e6c 6179 6572 730a 2020 2020 2020  DK.layers.      
-0000b6c0: 2020 6e61 6d65 5f74 6f5f 6c61 7965 7220    name_to_layer 
-0000b6d0: 3d20 6469 6374 284c 4159 4552 5329 0a20  = dict(LAYERS). 
-0000b6e0: 2020 2020 2020 206c 6179 6572 5f74 6f5f         layer_to_
-0000b6f0: 6e61 6d65 203d 207b 763a 206b 2066 6f72  name = {v: k for
-0000b700: 206b 2c20 7620 696e 206e 616d 655f 746f   k, v in name_to
-0000b710: 5f6c 6179 6572 2e69 7465 6d73 2829 7d0a  _layer.items()}.
-0000b720: 2020 2020 2020 2020 6c61 7965 725f 6e61          layer_na
-0000b730: 6d65 7320 3d20 5b5d 0a0a 2020 2020 2020  mes = []..      
-0000b740: 2020 666f 7220 6c61 7965 7220 696e 2073    for layer in s
-0000b750: 656c 662e 6c61 7965 7273 3a0a 2020 2020  elf.layers:.    
-0000b760: 2020 2020 2020 2020 6966 206c 6179 6572          if layer
-0000b770: 206e 6f74 2069 6e20 6c61 7965 725f 746f   not in layer_to
-0000b780: 5f6e 616d 653a 0a20 2020 2020 2020 2020  _name:.         
-0000b790: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0000b7a0: 7761 726e 2866 227b 6c61 7965 727d 206e  warn(f"{layer} n
-0000b7b0: 6f74 2069 6e20 4c61 7965 724d 6170 2e22  ot in LayerMap."
-0000b7c0: 2c20 7374 6163 6b6c 6576 656c 3d33 290a  , stacklevel=3).
-0000b7d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000b7e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b7f0: 2020 6c61 7965 725f 6e61 6d65 732e 6170    layer_names.ap
-0000b800: 7065 6e64 286c 6179 6572 5f74 6f5f 6e61  pend(layer_to_na
-0000b810: 6d65 5b6c 6179 6572 5d29 0a20 2020 2020  me[layer]).     
-0000b820: 2020 2072 6574 7572 6e20 6c61 7965 725f     return layer_
-0000b830: 6e61 6d65 730a 0a20 2020 2064 6566 205f  names..    def _
-0000b840: 6970 7974 686f 6e5f 6469 7370 6c61 795f  ipython_display_
-0000b850: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-0000b860: 2020 2020 2020 2020 2222 2253 686f 7720          """Show 
-0000b870: 6765 6f6d 6574 7279 2069 6e20 4b4c 6179  geometry in KLay
-0000b880: 6f75 7420 616e 6420 696e 206d 6174 706c  out and in matpl
-0000b890: 6f74 6c69 6220 666f 7220 4a75 7079 7465  otlib for Jupyte
-0000b8a0: 7220 4e6f 7465 626f 6f6b 732e 2222 220a  r Notebooks.""".
-0000b8b0: 2020 2020 2020 2020 7365 6c66 2e73 686f          self.sho
-0000b8c0: 7728 7368 6f77 5f70 6f72 7473 3d54 7275  w(show_ports=Tru
-0000b8d0: 6529 2020 2320 7368 6f77 2069 6e20 6b6c  e)  # show in kl
-0000b8e0: 6179 6f75 740a 2020 2020 2020 2020 7365  ayout.        se
-0000b8f0: 6c66 2e70 6c6f 745f 6b6c 6179 6f75 7428  lf.plot_klayout(
-0000b900: 290a 2020 2020 2020 2020 7072 696e 7428  ).        print(
-0000b910: 7365 6c66 290a 0a20 2020 2064 6566 2061  self)..    def a
-0000b920: 6464 5f70 696e 735f 7472 6961 6e67 6c65  dd_pins_triangle
-0000b930: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000b940: 2020 2020 2020 2020 706f 7274 5f6d 6172          port_mar
-0000b950: 6b65 725f 6c61 7965 723a 204c 6179 6572  ker_layer: Layer
-0000b960: 203d 2028 312c 2031 3029 2c0a 2020 2020   = (1, 10),.    
-0000b970: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000b980: 7475 726e 7320 636f 6d70 6f6e 656e 7420  turns component 
-0000b990: 7769 7468 2074 7269 616e 6775 6c61 7220  with triangular 
-0000b9a0: 7069 6e73 2e22 2222 0a20 2020 2020 2020  pins.""".       
-0000b9b0: 2066 726f 6d20 6764 7366 6163 746f 7279   from gdsfactory
-0000b9c0: 2e61 6464 5f70 696e 7320 696d 706f 7274  .add_pins import
-0000b9d0: 2061 6464 5f70 696e 735f 7472 6961 6e67   add_pins_triang
-0000b9e0: 6c65 0a0a 2020 2020 2020 2020 636f 6d70  le..        comp
-0000b9f0: 6f6e 656e 7420 3d20 7365 6c66 2e63 6f70  onent = self.cop
-0000ba00: 7928 290a 2020 2020 2020 2020 636f 6d70  y().        comp
-0000ba10: 6f6e 656e 742e 6e61 6d65 203d 2073 656c  onent.name = sel
-0000ba20: 662e 6e61 6d65 0a20 2020 2020 2020 2061  f.name.        a
-0000ba30: 6464 5f70 696e 735f 7472 6961 6e67 6c65  dd_pins_triangle
-0000ba40: 2863 6f6d 706f 6e65 6e74 3d63 6f6d 706f  (component=compo
-0000ba50: 6e65 6e74 2c20 6c61 7965 723d 706f 7274  nent, layer=port
-0000ba60: 5f6d 6172 6b65 725f 6c61 7965 7229 0a20  _marker_layer). 
-0000ba70: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
-0000ba80: 6d70 6f6e 656e 740a 0a20 2020 2064 6566  mponent..    def
-0000ba90: 2070 6c6f 745f 7769 6467 6574 280a 2020   plot_widget(.  
-0000baa0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000bab0: 2020 2020 7368 6f77 5f70 6f72 7473 3a20      show_ports: 
-0000bac0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-0000bad0: 2020 2020 2070 6f72 745f 6d61 726b 6572       port_marker
-0000bae0: 5f6c 6179 6572 3a20 4c61 7965 7220 3d20  _layer: Layer = 
-0000baf0: 2831 2c20 3130 292c 0a20 2020 2029 202d  (1, 10),.    ) -
-0000bb00: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000bb10: 2222 2252 6574 7572 6e73 2069 7079 7468  """Returns ipyth
-0000bb20: 6f6e 2077 6964 6765 7420 666f 7220 6b6c  on widget for kl
-0000bb30: 6179 6f75 7420 7669 7375 616c 697a 6174  ayout visualizat
-0000bb40: 696f 6e2e 0a0a 2020 2020 2020 2020 4172  ion...        Ar
-0000bb50: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-0000bb60: 7368 6f77 5f70 6f72 7473 3a20 7368 6f77  show_ports: show
-0000bb70: 7320 636f 6d70 6f6e 656e 7420 7769 7468  s component with
-0000bb80: 2070 6f72 7420 6d61 726b 6572 7320 616e   port markers an
-0000bb90: 6420 6c61 6265 6c73 2e0a 2020 2020 2020  d labels..      
-0000bba0: 2020 2020 2020 706f 7274 5f6d 6172 6b65        port_marke
-0000bbb0: 725f 6c61 7965 723a 2066 6f72 2074 6865  r_layer: for the
-0000bbc0: 2070 6f72 7473 2e0a 2020 2020 2020 2020   ports..        
-0000bbd0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-0000bbe0: 2067 6473 6661 6374 6f72 792e 7064 6b20   gdsfactory.pdk 
-0000bbf0: 696d 706f 7274 2067 6574 5f6c 6179 6572  import get_layer
-0000bc00: 5f76 6965 7773 0a20 2020 2020 2020 2066  _views.        f
-0000bc10: 726f 6d20 6764 7366 6163 746f 7279 2e77  rom gdsfactory.w
-0000bc20: 6964 6765 7473 2e6c 6179 6f75 745f 7669  idgets.layout_vi
-0000bc30: 6577 6572 2069 6d70 6f72 7420 4c61 796f  ewer import Layo
-0000bc40: 7574 5669 6577 6572 0a20 2020 2020 2020  utViewer.       
-0000bc50: 2066 726f 6d20 4950 7974 686f 6e2e 6469   from IPython.di
-0000bc60: 7370 6c61 7920 696d 706f 7274 2064 6973  splay import dis
-0000bc70: 706c 6179 0a0a 2020 2020 2020 2020 636f  play..        co
-0000bc80: 6d70 6f6e 656e 7420 3d20 280a 2020 2020  mponent = (.    
-0000bc90: 2020 2020 2020 2020 7365 6c66 2e61 6464          self.add
-0000bca0: 5f70 696e 735f 7472 6961 6e67 6c65 2870  _pins_triangle(p
-0000bcb0: 6f72 745f 6d61 726b 6572 5f6c 6179 6572  ort_marker_layer
-0000bcc0: 3d70 6f72 745f 6d61 726b 6572 5f6c 6179  =port_marker_lay
-0000bcd0: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-0000bce0: 6966 2073 686f 775f 706f 7274 730a 2020  if show_ports.  
-0000bcf0: 2020 2020 2020 2020 2020 656c 7365 2073            else s
-0000bd00: 656c 660a 2020 2020 2020 2020 290a 0a20  elf.        ).. 
-0000bd10: 2020 2020 2020 2067 6473 7061 7468 203d         gdspath =
-0000bd20: 2063 6f6d 706f 6e65 6e74 2e77 7269 7465   component.write
-0000bd30: 5f67 6473 286c 6f67 6769 6e67 3d46 616c  _gds(logging=Fal
-0000bd40: 7365 290a 2020 2020 2020 2020 6c79 705f  se).        lyp_
-0000bd50: 7061 7468 203d 2067 6473 7061 7468 2e77  path = gdspath.w
-0000bd60: 6974 685f 7375 6666 6978 2822 2e6c 7970  ith_suffix(".lyp
-0000bd70: 2229 0a0a 2020 2020 2020 2020 6c61 7965  ")..        laye
-0000bd80: 725f 7669 6577 7320 3d20 6765 745f 6c61  r_views = get_la
-0000bd90: 7965 725f 7669 6577 7328 290a 2020 2020  yer_views().    
-0000bda0: 2020 2020 6c61 7965 725f 7669 6577 732e      layer_views.
-0000bdb0: 746f 5f6c 7970 2866 696c 6570 6174 683d  to_lyp(filepath=
-0000bdc0: 6c79 705f 7061 7468 290a 0a20 2020 2020  lyp_path)..     
-0000bdd0: 2020 206c 6179 6f75 7420 3d20 4c61 796f     layout = Layo
-0000bde0: 7574 5669 6577 6572 2867 6473 7061 7468  utViewer(gdspath
-0000bdf0: 2c20 6c79 705f 7061 7468 290a 2020 2020  , lyp_path).    
-0000be00: 2020 2020 6469 7370 6c61 7928 6c61 796f      display(layo
-0000be10: 7574 2e77 6964 6765 7429 0a0a 2020 2020  ut.widget)..    
-0000be20: 6465 6620 706c 6f74 5f6b 6c61 796f 7574  def plot_klayout
-0000be30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000be40: 2020 2020 2020 2020 7368 6f77 5f70 6f72          show_por
-0000be50: 7473 3a20 626f 6f6c 203d 2054 7275 652c  ts: bool = True,
-0000be60: 0a20 2020 2020 2020 2070 6f72 745f 6d61  .        port_ma
-0000be70: 726b 6572 5f6c 6179 6572 3a20 4c61 7965  rker_layer: Laye
-0000be80: 7220 3d20 2831 2c20 3130 292c 0a20 2020  r = (1, 10),.   
-0000be90: 2020 2020 2073 686f 775f 6c61 6265 6c73       show_labels
-0000bea0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0000beb0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-0000bec0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000bed0: 7320 6b6c 6179 6f75 7420 696d 6167 652e  s klayout image.
-0000bee0: 0a0a 2020 2020 2020 2020 4966 2069 7420  ..        If it 
-0000bef0: 6661 696c 7320 746f 2069 6d70 6f72 7420  fails to import 
-0000bf00: 6b6c 6179 6f75 7420 6465 6661 756c 7473  klayout defaults
-0000bf10: 2074 6f20 6d61 7470 6c6f 746c 6962 2e0a   to matplotlib..
-0000bf20: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-0000bf30: 2020 2020 2020 2020 2020 2073 686f 775f             show_
-0000bf40: 706f 7274 733a 2073 686f 7773 2063 6f6d  ports: shows com
-0000bf50: 706f 6e65 6e74 2077 6974 6820 706f 7274  ponent with port
-0000bf60: 206d 6172 6b65 7273 2061 6e64 206c 6162   markers and lab
-0000bf70: 656c 732e 0a20 2020 2020 2020 2020 2020  els..           
-0000bf80: 2070 6f72 745f 6d61 726b 6572 5f6c 6179   port_marker_lay
-0000bf90: 6572 3a20 666f 7220 7468 6520 706f 7274  er: for the port
-0000bfa0: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
-0000bfb0: 686f 775f 6c61 6265 6c73 3a20 7368 6f77  how_labels: show
-0000bfc0: 7320 6c61 6265 6c73 2e0a 2020 2020 2020  s labels..      
-0000bfd0: 2020 2222 220a 0a20 2020 2020 2020 2063    """..        c
-0000bfe0: 6f6d 706f 6e65 6e74 203d 2028 0a20 2020  omponent = (.   
-0000bff0: 2020 2020 2020 2020 2073 656c 662e 6164           self.ad
-0000c000: 645f 7069 6e73 5f74 7269 616e 676c 6528  d_pins_triangle(
-0000c010: 706f 7274 5f6d 6172 6b65 725f 6c61 7965  port_marker_laye
-0000c020: 723d 706f 7274 5f6d 6172 6b65 725f 6c61  r=port_marker_la
-0000c030: 7965 7229 0a20 2020 2020 2020 2020 2020  yer).           
-0000c040: 2069 6620 7368 6f77 5f70 6f72 7473 0a20   if show_ports. 
-0000c050: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-0000c060: 7365 6c66 0a20 2020 2020 2020 2029 0a0a  self.        )..
-0000c070: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000c080: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-0000c090: 6b6c 6179 6f75 742e 6462 2061 7320 6462  klayout.db as db
-0000c0a0: 2020 2320 6e6f 7161 3a20 4634 3031 0a20    # noqa: F401. 
-0000c0b0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-0000c0c0: 7420 6b6c 6179 6f75 742e 6c61 7920 6173  t klayout.lay as
-0000c0d0: 206c 6179 0a20 2020 2020 2020 2020 2020   lay.           
-0000c0e0: 2066 726f 6d20 6764 7366 6163 746f 7279   from gdsfactory
-0000c0f0: 2e70 646b 2069 6d70 6f72 7420 6765 745f  .pdk import get_
-0000c100: 6c61 7965 725f 7669 6577 730a 2020 2020  layer_views.    
-0000c110: 2020 2020 2020 2020 6672 6f6d 2049 5079          from IPy
-0000c120: 7468 6f6e 2e64 6973 706c 6179 2069 6d70  thon.display imp
-0000c130: 6f72 7420 6469 7370 6c61 790a 2020 2020  ort display.    
-0000c140: 2020 2020 2020 2020 6672 6f6d 2069 7079          from ipy
-0000c150: 7769 6467 6574 7320 696d 706f 7274 2049  widgets import I
-0000c160: 6d61 6765 0a0a 2020 2020 2020 2020 2020  mage..          
-0000c170: 2020 6764 7370 6174 6820 3d20 636f 6d70    gdspath = comp
-0000c180: 6f6e 656e 742e 7772 6974 655f 6764 7328  onent.write_gds(
-0000c190: 6c6f 6767 696e 673d 4661 6c73 6529 0a20  logging=False). 
-0000c1a0: 2020 2020 2020 2020 2020 206c 7970 5f70             lyp_p
-0000c1b0: 6174 6820 3d20 6764 7370 6174 682e 7769  ath = gdspath.wi
-0000c1c0: 7468 5f73 7566 6669 7828 222e 6c79 7022  th_suffix(".lyp"
-0000c1d0: 290a 0a20 2020 2020 2020 2020 2020 206c  )..            l
-0000c1e0: 6179 6572 5f76 6965 7773 203d 2067 6574  ayer_views = get
-0000c1f0: 5f6c 6179 6572 5f76 6965 7773 2829 0a20  _layer_views(). 
-0000c200: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-0000c210: 5f76 6965 7773 2e74 6f5f 6c79 7028 6669  _views.to_lyp(fi
-0000c220: 6c65 7061 7468 3d6c 7970 5f70 6174 6829  lepath=lyp_path)
-0000c230: 0a0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-0000c240: 796f 7574 5f76 6965 7720 3d20 6c61 792e  yout_view = lay.
-0000c250: 4c61 796f 7574 5669 6577 2829 0a20 2020  LayoutView().   
-0000c260: 2020 2020 2020 2020 206c 6179 6f75 745f           layout_
-0000c270: 7669 6577 2e6c 6f61 645f 6c61 796f 7574  view.load_layout
-0000c280: 2873 7472 2867 6473 7061 7468 2e61 6273  (str(gdspath.abs
-0000c290: 6f6c 7574 6528 2929 290a 2020 2020 2020  olute())).      
-0000c2a0: 2020 2020 2020 6c61 796f 7574 5f76 6965        layout_vie
-0000c2b0: 772e 6d61 785f 6869 6572 2829 0a20 2020  w.max_hier().   
-0000c2c0: 2020 2020 2020 2020 206c 6179 6f75 745f           layout_
-0000c2d0: 7669 6577 2e6c 6f61 645f 6c61 7965 725f  view.load_layer_
-0000c2e0: 7072 6f70 7328 7374 7228 6c79 705f 7061  props(str(lyp_pa
-0000c2f0: 7468 2929 0a0a 2020 2020 2020 2020 2020  th))..          
-0000c300: 2020 6c61 796f 7574 5f76 6965 772e 7365    layout_view.se
-0000c310: 745f 636f 6e66 6967 2822 7465 7874 2d76  t_config("text-v
-0000c320: 6973 6962 6c65 222c 2022 7472 7565 2220  isible", "true" 
-0000c330: 6966 2073 686f 775f 6c61 6265 6c73 2065  if show_labels e
-0000c340: 6c73 6520 2266 616c 7365 2229 0a0a 2020  lse "false")..  
-0000c350: 2020 2020 2020 2020 2020 7069 7865 6c5f            pixel_
-0000c360: 6275 6666 6572 203d 206c 6179 6f75 745f  buffer = layout_
-0000c370: 7669 6577 2e67 6574 5f70 6978 656c 735f  view.get_pixels_
-0000c380: 7769 7468 5f6f 7074 696f 6e73 2838 3030  with_options(800
-0000c390: 2c20 3630 3029 0a20 2020 2020 2020 2020  , 600).         
-0000c3a0: 2020 2070 6e67 5f64 6174 6120 3d20 7069     png_data = pi
-0000c3b0: 7865 6c5f 6275 6666 6572 2e74 6f5f 706e  xel_buffer.to_pn
-0000c3c0: 675f 6461 7461 2829 0a20 2020 2020 2020  g_data().       
-0000c3d0: 2020 2020 2069 6d61 6765 203d 2049 6d61       image = Ima
-0000c3e0: 6765 2876 616c 7565 3d70 6e67 5f64 6174  ge(value=png_dat
-0000c3f0: 612c 2066 6f72 6d61 743d 2270 6e67 2229  a, format="png")
-0000c400: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0000c410: 706c 6179 2869 6d61 6765 290a 0a20 2020  play(image)..   
-0000c420: 2020 2020 2065 7863 6570 7420 496d 706f       except Impo
-0000c430: 7274 4572 726f 723a 0a20 2020 2020 2020  rtError:.       
-0000c440: 2020 2020 2070 7269 6e74 280a 2020 2020       print(.    
-0000c450: 2020 2020 2020 2020 2020 2020 2259 6f75              "You
-0000c460: 2063 616e 2069 6e73 7461 6c6c 2060 7069   can install `pi
-0000c470: 7020 696e 7374 616c 6c20 6764 7366 6163  p install gdsfac
-0000c480: 746f 7279 5b66 756c 6c5d 6020 666f 7220  tory[full]` for 
-0000c490: 6265 7474 6572 2076 6973 7561 6c69 7a61  better visualiza
-0000c4a0: 7469 6f6e 220a 2020 2020 2020 2020 2020  tion".          
-0000c4b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000c4c0: 636f 6d70 6f6e 656e 742e 706c 6f74 2870  component.plot(p
-0000c4d0: 6c6f 7474 6572 3d22 6d61 7470 6c6f 746c  lotter="matplotl
-0000c4e0: 6962 2229 0a0a 2020 2020 6465 6620 706c  ib")..    def pl
-0000c4f0: 6f74 5f6a 7570 7974 6572 2873 656c 6629  ot_jupyter(self)
-0000c500: 3a0a 2020 2020 2020 2020 2222 2253 686f  :.        """Sho
-0000c510: 7773 2063 7572 7265 6e74 2067 6473 2069  ws current gds i
-0000c520: 6e20 6b6c 6179 6f75 742e 2055 7365 7320  n klayout. Uses 
-0000c530: 4b77 6562 2069 6620 7365 7276 6572 2072  Kweb if server r
-0000c540: 756e 6e69 6e67 2e0a 0a20 2020 2020 2020  unning...       
-0000c550: 2069 6620 6e6f 7420 7472 6965 7320 7573   if not tries us
-0000c560: 696e 6720 4b6c 6179 6f75 7420 7769 6467  ing Klayout widg
-0000c570: 6574 2061 6e64 2066 696e 616c 6c79 2064  et and finally d
-0000c580: 6566 6175 6c74 7320 746f 206d 6174 706c  efaults to matpl
-0000c590: 6f74 6c69 622e 0a20 2020 2020 2020 2022  otlib..        "
-0000c5a0: 2222 0a20 2020 2020 2020 2074 7279 3a0a  "".        try:.
-0000c5b0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-0000c5c0: 7274 206f 730a 2020 2020 2020 2020 2020  rt os.          
-0000c5d0: 2020 6672 6f6d 2067 6473 6661 6374 6f72    from gdsfactor
-0000c5e0: 792e 636f 6e66 6967 2069 6d70 6f72 7420  y.config import 
-0000c5f0: 5041 5448 0a20 2020 2020 2020 2020 2020  PATH.           
-0000c600: 2066 726f 6d20 6764 7366 6163 746f 7279   from gdsfactory
-0000c610: 2e70 646b 2069 6d70 6f72 7420 6765 745f  .pdk import get_
-0000c620: 6c61 7965 725f 7669 6577 730a 2020 2020  layer_views.    
-0000c630: 2020 2020 2020 2020 6672 6f6d 2049 5079          from IPy
-0000c640: 7468 6f6e 2e64 6973 706c 6179 2069 6d70  thon.display imp
-0000c650: 6f72 7420 4946 7261 6d65 0a20 2020 2020  ort IFrame.     
-0000c660: 2020 2020 2020 2069 6d70 6f72 7420 6b77         import kw
-0000c670: 6562 2e73 6572 7665 725f 6a75 7079 7465  eb.server_jupyte
-0000c680: 7220 6173 206b 6a0a 2020 2020 2020 2020  r as kj.        
-0000c690: 2020 2020 6672 6f6d 2068 746d 6c20 696d      from html im
-0000c6a0: 706f 7274 2065 7363 6170 650a 0a20 2020  port escape..   
-0000c6b0: 2020 2020 2020 2020 2067 6473 7061 7468           gdspath
-0000c6c0: 203d 2073 656c 662e 7772 6974 655f 6764   = self.write_gd
-0000c6d0: 7328 6764 7364 6972 3d50 4154 482e 6764  s(gdsdir=PATH.gd
-0000c6e0: 736c 6962 202f 2022 6578 7472 6122 2c20  slib / "extra", 
-0000c6f0: 6c6f 6767 696e 673d 4661 6c73 6529 0a0a  logging=False)..
-0000c700: 2020 2020 2020 2020 2020 2020 6469 7270              dirp
-0000c710: 6174 6820 3d20 4744 5344 4952 5f54 454d  ath = GDSDIR_TEM
-0000c720: 500a 2020 2020 2020 2020 2020 2020 6469  P.            di
-0000c730: 7270 6174 682e 6d6b 6469 7228 6578 6973  rpath.mkdir(exis
-0000c740: 745f 6f6b 3d54 7275 652c 2070 6172 656e  t_ok=True, paren
-0000c750: 7473 3d54 7275 6529 0a20 2020 2020 2020  ts=True).       
-0000c760: 2020 2020 206c 7970 5f70 6174 6820 3d20       lyp_path = 
-0000c770: 6469 7270 6174 6820 2f20 226c 6179 6572  dirpath / "layer
-0000c780: 732e 6c79 7022 0a0a 2020 2020 2020 2020  s.lyp"..        
-0000c790: 2020 2020 6c61 7965 725f 7072 6f70 7320      layer_props 
-0000c7a0: 3d20 6765 745f 6c61 7965 725f 7669 6577  = get_layer_view
-0000c7b0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-0000c7c0: 6c61 7965 725f 7072 6f70 732e 746f 5f6c  layer_props.to_l
-0000c7d0: 7970 2866 696c 6570 6174 683d 6c79 705f  yp(filepath=lyp_
-0000c7e0: 7061 7468 290a 0a20 2020 2020 2020 2020  path)..         
-0000c7f0: 2020 2070 6f72 7420 3d20 6b6a 2e70 6f72     port = kj.por
-0000c800: 7420 6966 2068 6173 6174 7472 286b 6a2c  t if hasattr(kj,
-0000c810: 2022 706f 7274 2229 2065 6c73 6520 3830   "port") else 80
-0000c820: 3030 0a0a 2020 2020 2020 2020 2020 2020  00..            
-0000c830: 7372 6320 3d20 6622 6874 7470 3a2f 2f31  src = f"http://1
-0000c840: 3237 2e30 2e30 2e31 3a7b 706f 7274 7d2f  27.0.0.1:{port}/
-0000c850: 6764 733f 6764 735f 6669 6c65 3d7b 6573  gds?gds_file={es
-0000c860: 6361 7065 2873 7472 2867 6473 7061 7468  cape(str(gdspath
-0000c870: 2929 7d26 6c61 7965 725f 7072 6f70 733d  ))}&layer_props=
-0000c880: 7b65 7363 6170 6528 7374 7228 6c79 705f  {escape(str(lyp_
-0000c890: 7061 7468 2929 7d22 0a20 2020 2020 2020  path))}".       
-0000c8a0: 2020 2020 206c 6f67 6765 722e 6465 6275       logger.debu
-0000c8b0: 6728 7372 6329 0a0a 2020 2020 2020 2020  g(src)..        
-0000c8c0: 2020 2020 6966 206b 6a2e 6a75 7079 7465      if kj.jupyte
-0000c8d0: 725f 7365 7276 6572 2061 6e64 206e 6f74  r_server and not
-0000c8e0: 206f 732e 656e 7669 726f 6e2e 6765 7428   os.environ.get(
-0000c8f0: 2244 4f43 5322 2c20 4661 6c73 6529 3a0a  "DOCS", False):.
-0000c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c910: 7265 7475 726e 2049 4672 616d 6528 0a20  return IFrame(. 
-0000c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c930: 2020 2073 7263 3d73 7263 2c0a 2020 2020     src=src,.    
-0000c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c950: 7769 6474 683d 3134 3030 2c0a 2020 2020  width=1400,.    
-0000c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c970: 6865 6967 6874 3d36 3030 2c0a 2020 2020  height=600,.    
-0000c980: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000c990: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c9b0: 7265 7475 726e 2073 656c 662e 706c 6f74  return self.plot
-0000c9c0: 5f6b 6c61 796f 7574 2829 0a20 2020 2020  _klayout().     
-0000c9d0: 2020 2065 7863 6570 7420 496d 706f 7274     except Import
-0000c9e0: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-0000c9f0: 2020 2070 7269 6e74 280a 2020 2020 2020     print(.      
-0000ca00: 2020 2020 2020 2020 2020 2259 6f75 2063            "You c
-0000ca10: 616e 2069 6e73 7461 6c6c 2060 7069 7020  an install `pip 
-0000ca20: 696e 7374 616c 6c20 6764 7366 6163 746f  install gdsfacto
-0000ca30: 7279 5b66 756c 6c5d 6020 666f 7220 6265  ry[full]` for be
-0000ca40: 7474 6572 2076 6973 7561 6c69 7a61 7469  tter visualizati
-0000ca50: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-0000ca60: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000ca70: 7475 726e 2073 656c 662e 706c 6f74 5f6b  turn self.plot_k
-0000ca80: 6c61 796f 7574 2829 0a0a 2020 2020 6465  layout()..    de
-0000ca90: 6620 706c 6f74 5f6d 6174 706c 6f74 6c69  f plot_matplotli
-0000caa0: 6228 7365 6c66 2c20 2a2a 6b77 6172 6773  b(self, **kwargs
-0000cab0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000cac0: 2020 2022 2222 506c 6f74 2063 6f6d 706f     """Plot compo
-0000cad0: 6e65 6e74 2075 7369 6e67 206d 6174 706c  nent using matpl
-0000cae0: 6f74 6c69 622e 0a0a 2020 2020 2020 2020  otlib...        
-0000caf0: 4b65 7977 6f72 6420 4172 6773 3a0a 2020  Keyword Args:.  
-0000cb00: 2020 2020 2020 2020 2020 7368 6f77 5f70            show_p
-0000cb10: 6f72 7473 3a20 5365 7473 2077 6865 7468  orts: Sets wheth
-0000cb20: 6572 2070 6f72 7473 2061 7265 2064 7261  er ports are dra
-0000cb30: 776e 2e0a 2020 2020 2020 2020 2020 2020  wn..            
-0000cb40: 7368 6f77 5f73 7562 706f 7274 733a 2053  show_subports: S
-0000cb50: 6574 7320 7768 6574 6865 7220 7375 6270  ets whether subp
-0000cb60: 6f72 7473 2028 706f 7274 7320 7468 6174  orts (ports that
-0000cb70: 2062 656c 6f6e 6720 746f 2072 6566 6572   belong to refer
-0000cb80: 656e 6365 7329 2061 7265 2064 7261 776e  ences) are drawn
-0000cb90: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-0000cba0: 6265 6c5f 616c 6961 7365 733a 2053 6574  bel_aliases: Set
-0000cbb0: 7320 7768 6574 6865 7220 616c 6961 7365  s whether aliase
-0000cbc0: 7320 6172 6520 6c61 6265 6c65 6420 7769  s are labeled wi
-0000cbd0: 7468 2061 2074 6578 7420 6e61 6d65 2e0a  th a text name..
-0000cbe0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0000cbf0: 7769 6e64 6f77 3a20 4966 2054 7275 652c  window: If True,
-0000cc00: 2065 6163 6820 6361 6c6c 2074 6f20 7175   each call to qu
-0000cc10: 6963 6b70 6c6f 7428 2920 7769 6c6c 2067  ickplot() will g
-0000cc20: 656e 6572 6174 6520 6120 7365 7061 7261  enerate a separa
-0000cc30: 7465 2077 696e 646f 772e 0a20 2020 2020  te window..     
-0000cc40: 2020 2020 2020 2062 6c6f 636b 696e 673a         blocking:
-0000cc50: 2049 6620 5472 7565 2c20 6361 6c6c 696e   If True, callin
-0000cc60: 6720 7175 6963 6b70 6c6f 7428 2920 7769  g quickplot() wi
-0000cc70: 6c6c 2070 6175 7365 2065 7865 6375 7469  ll pause executi
-0000cc80: 6f6e 206f 6620 2822 626c 6f63 6b22 2920  on of ("block") 
-0000cc90: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-0000cca0: 2020 2020 7265 6d61 696e 6465 7220 6f66      remainder of
-0000ccb0: 2074 6865 2070 7974 686f 6e20 636f 6465   the python code
-0000ccc0: 2075 6e74 696c 2074 6865 2071 7569 636b   until the quick
-0000ccd0: 706c 6f74 2829 2077 696e 646f 7720 6973  plot() window is
-0000cce0: 2063 6c6f 7365 642e 0a20 2020 2020 2020   closed..       
-0000ccf0: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
-0000cd00: 652c 2074 6865 2077 696e 646f 7720 7769  e, the window wi
-0000cd10: 6c6c 2062 6520 6f70 656e 6564 2061 6e64  ll be opened and
-0000cd20: 2063 6f64 6520 7769 6c6c 2063 6f6e 7469   code will conti
-0000cd30: 6e75 6520 746f 2072 756e 2e0a 2020 2020  nue to run..    
-0000cd40: 2020 2020 2020 2020 7a6f 6f6d 5f66 6163          zoom_fac
-0000cd50: 746f 723a 2053 6574 7320 7468 6520 7363  tor: Sets the sc
-0000cd60: 616c 696e 6720 6661 6374 6f72 2077 6865  aling factor whe
-0000cd70: 6e20 7a6f 6f6d 696e 6720 7468 6520 7175  n zooming the qu
-0000cd80: 6963 6b70 6c6f 7420 7769 6e64 6f77 2077  ickplot window w
-0000cd90: 6974 6820 7468 650a 2020 2020 2020 2020  ith the.        
-0000cda0: 2020 2020 2020 2020 6d6f 7573 6577 6865          mousewhe
-0000cdb0: 656c 2f74 7261 636b 7061 642e 0a20 2020  el/trackpad..   
-0000cdc0: 2020 2020 2020 2020 2069 6e74 6572 6163           interac
-0000cdd0: 7469 7665 5f7a 6f6f 6d3a 2045 6e61 626c  tive_zoom: Enabl
-0000cde0: 6573 2075 7369 6e67 206d 6f75 7365 7768  es using mousewh
-0000cdf0: 6565 6c2f 7472 6163 6b70 6164 2074 6f20  eel/trackpad to 
-0000ce00: 7a6f 6f6d 2e0a 2020 2020 2020 2020 2020  zoom..          
-0000ce10: 2020 666f 6e74 7369 7a65 3a20 666f 7220    fontsize: for 
-0000ce20: 6c61 6265 6c73 2e0a 2020 2020 2020 2020  labels..        
-0000ce30: 2020 2020 6c61 7965 7273 5f65 7863 6c75      layers_exclu
-0000ce40: 6465 643a 206c 6973 7420 6f66 206c 6179  ded: list of lay
-0000ce50: 6572 7320 746f 2065 7863 6c75 6465 2e0a  ers to exclude..
-0000ce60: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-0000ce70: 725f 7669 6577 733a 206c 6179 6572 5f76  r_views: layer_v
-0000ce80: 6965 7773 2063 6f6c 6f72 7320 6c6f 6164  iews colors load
-0000ce90: 6564 2066 726f 6d20 4b6c 6179 6f75 742e  ed from Klayout.
-0000cea0: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
-0000ceb0: 5f61 7370 6563 743a 206d 696e 696d 756d  _aspect: minimum
-0000cec0: 2061 7370 6563 7420 7261 7469 6f2e 0a20   aspect ratio.. 
-0000ced0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000cee0: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
-0000cef0: 7279 2e71 7569 636b 706c 6f74 7465 7220  ry.quickplotter 
-0000cf00: 696d 706f 7274 2071 7569 636b 706c 6f74  import quickplot
-0000cf10: 0a0a 2020 2020 2020 2020 7175 6963 6b70  ..        quickp
-0000cf20: 6c6f 7428 7365 6c66 2c20 2a2a 6b77 6172  lot(self, **kwar
-0000cf30: 6773 290a 0a20 2020 2064 6566 2070 6c6f  gs)..    def plo
-0000cf40: 7428 7365 6c66 2c20 706c 6f74 7465 723a  t(self, plotter:
-0000cf50: 204f 7074 696f 6e61 6c5b 506c 6f74 7465   Optional[Plotte
-0000cf60: 725d 203d 204e 6f6e 652c 202a 2a6b 7761  r] = None, **kwa
-0000cf70: 7267 7329 202d 3e20 4e6f 6e65 3a0a 2020  rgs) -> None:.  
-0000cf80: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-0000cf90: 2063 6f6d 706f 6e65 6e74 2070 6c6f 7420   component plot 
-0000cfa0: 7573 696e 6720 6b6c 6179 6f75 742c 206d  using klayout, m
-0000cfb0: 6174 706c 6f74 6c69 622c 2068 6f6c 6f76  atplotlib, holov
-0000cfc0: 6965 7773 206f 7220 7174 2e0a 0a20 2020  iews or qt...   
-0000cfd0: 2020 2020 2057 6520 7265 636f 6d6d 656e       We recommen
-0000cfe0: 6420 7573 696e 6720 6b6c 6179 6f75 742e  d using klayout.
-0000cff0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-0000d000: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-0000d010: 7465 723a 2070 6c6f 7420 6261 636b 656e  ter: plot backen
-0000d020: 6420 2827 686f 6c6f 7669 6577 7327 2c20  d ('holoviews', 
-0000d030: 276d 6174 706c 6f74 6c69 6227 2c20 2771  'matplotlib', 'q
-0000d040: 7427 2c20 276b 6c61 796f 7574 2729 2e0a  t', 'klayout')..
-0000d050: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000d060: 2020 2020 706c 6f74 7465 7220 3d20 706c      plotter = pl
-0000d070: 6f74 7465 7220 6f72 2043 4f4e 462e 6765  otter or CONF.ge
-0000d080: 7428 2270 6c6f 7474 6572 222c 2022 6d61  t("plotter", "ma
-0000d090: 7470 6c6f 746c 6962 2229 0a0a 2020 2020  tplotlib")..    
-0000d0a0: 2020 2020 6966 2070 6c6f 7474 6572 203d      if plotter =
-0000d0b0: 3d20 226b 6c61 796f 7574 223a 0a20 2020  = "klayout":.   
-0000d0c0: 2020 2020 2020 2020 2073 656c 662e 706c           self.pl
-0000d0d0: 6f74 5f6b 6c61 796f 7574 2829 0a20 2020  ot_klayout().   
-0000d0e0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0000d0f0: 0a20 2020 2020 2020 2065 6c69 6620 706c  .        elif pl
-0000d100: 6f74 7465 7220 3d3d 2022 6d61 7470 6c6f  otter == "matplo
-0000d110: 746c 6962 223a 0a20 2020 2020 2020 2020  tlib":.         
-0000d120: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
-0000d130: 7279 2e71 7569 636b 706c 6f74 7465 7220  ry.quickplotter 
-0000d140: 696d 706f 7274 2071 7569 636b 706c 6f74  import quickplot
-0000d150: 0a0a 2020 2020 2020 2020 2020 2020 7175  ..            qu
-0000d160: 6963 6b70 6c6f 7428 7365 6c66 2c20 2a2a  ickplot(self, **
-0000d170: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-0000d180: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-0000d190: 2020 2020 656c 6966 2070 6c6f 7474 6572      elif plotter
-0000d1a0: 203d 3d20 2268 6f6c 6f76 6965 7773 223a   == "holoviews":
-0000d1b0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0000d1c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d1d0: 2020 696d 706f 7274 2068 6f6c 6f76 6965    import holovie
-0000d1e0: 7773 2061 7320 6876 0a0a 2020 2020 2020  ws as hv..      
-0000d1f0: 2020 2020 2020 2020 2020 6876 2e65 7874            hv.ext
-0000d200: 656e 7369 6f6e 2822 626f 6b65 6822 290a  ension("bokeh").
-0000d210: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000d220: 7074 2049 6d70 6f72 7445 7272 6f72 2061  pt ImportError a
-0000d230: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-0000d240: 2020 2020 2070 7269 6e74 2822 796f 7520       print("you 
-0000d250: 6e65 6564 2074 6f20 6070 6970 2069 6e73  need to `pip ins
-0000d260: 7461 6c6c 2068 6f6c 6f76 6965 7773 6022  tall holoviews`"
-0000d270: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000d280: 2020 7261 6973 6520 650a 2020 2020 2020    raise e.      
-0000d290: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000d2a0: 662e 706c 6f74 5f68 6f6c 6f76 6965 7773  f.plot_holoviews
-0000d2b0: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-0000d2c0: 2020 2020 656c 6966 2070 6c6f 7474 6572      elif plotter
-0000d2d0: 203d 3d20 2271 7422 3a0a 2020 2020 2020   == "qt":.      
-0000d2e0: 2020 2020 2020 6672 6f6d 2067 6473 6661        from gdsfa
-0000d2f0: 6374 6f72 792e 7175 6963 6b70 6c6f 7474  ctory.quickplott
-0000d300: 6572 2069 6d70 6f72 7420 7175 6963 6b70  er import quickp
-0000d310: 6c6f 7432 0a0a 2020 2020 2020 2020 2020  lot2..          
-0000d320: 2020 7175 6963 6b70 6c6f 7432 2873 656c    quickplot2(sel
-0000d330: 6629 0a20 2020 2020 2020 2020 2020 2072  f).            r
-0000d340: 6574 7572 6e0a 2020 2020 2020 2020 656c  eturn.        el
-0000d350: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000d360: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000d370: 2866 227b 706c 6f74 7465 7221 727d 206e  (f"{plotter!r} n
-0000d380: 6f74 2069 6e20 7b50 6c6f 7474 6572 7d22  ot in {Plotter}"
-0000d390: 290a 0a20 2020 2064 6566 2070 6c6f 745f  )..    def plot_
-0000d3a0: 686f 6c6f 7669 6577 7328 0a20 2020 2020  holoviews(.     
-0000d3b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000d3c0: 206c 6179 6572 735f 6578 636c 7564 6564   layers_excluded
-0000d3d0: 3a20 4f70 7469 6f6e 616c 5b4c 6179 6572  : Optional[Layer
-0000d3e0: 735d 203d 204e 6f6e 652c 0a20 2020 2020  s] = None,.     
-0000d3f0: 2020 206c 6179 6572 5f76 6965 7773 3a20     layer_views: 
-0000d400: 4f70 7469 6f6e 616c 5b4c 6179 6572 5669  Optional[LayerVi
-0000d410: 6577 735d 203d 204e 6f6e 652c 0a20 2020  ews] = None,.   
-0000d420: 2020 2020 206d 696e 5f61 7370 6563 743a       min_aspect:
-0000d430: 2066 6c6f 6174 203d 2030 2e32 352c 0a20   float = 0.25,. 
-0000d440: 2020 2020 2020 2070 6164 6469 6e67 3a20         padding: 
-0000d450: 666c 6f61 7420 3d20 302e 352c 0a20 2020  float = 0.5,.   
-0000d460: 2029 3a0a 2020 2020 2020 2020 2222 2250   ):.        """P
-0000d470: 6c6f 7420 636f 6d70 6f6e 656e 7420 696e  lot component in
-0000d480: 2068 6f6c 6f76 6965 7773 2e0a 0a20 2020   holoviews...   
-0000d490: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-0000d4a0: 2020 2020 2020 206c 6179 6572 735f 6578         layers_ex
-0000d4b0: 636c 7564 6564 3a20 6c69 7374 206f 6620  cluded: list of 
-0000d4c0: 6c61 7965 7273 2074 6f20 6578 636c 7564  layers to exclud
-0000d4d0: 652e 0a20 2020 2020 2020 2020 2020 206c  e..            l
-0000d4e0: 6179 6572 5f76 6965 7773 3a20 6c61 7965  ayer_views: laye
-0000d4f0: 725f 7669 6577 7320 636f 6c6f 7273 206c  r_views colors l
-0000d500: 6f61 6465 6420 6672 6f6d 204b 6c61 796f  oaded from Klayo
-0000d510: 7574 2e0a 2020 2020 2020 2020 2020 2020  ut..            
-0000d520: 6d69 6e5f 6173 7065 6374 3a20 6d69 6e69  min_aspect: mini
-0000d530: 6d75 6d20 6173 7065 6374 2072 6174 696f  mum aspect ratio
-0000d540: 2e0a 2020 2020 2020 2020 2020 2020 7061  ..            pa
-0000d550: 6464 696e 673a 2061 726f 756e 6420 626f  dding: around bo
-0000d560: 756e 6469 6e67 2062 6f78 2e0a 0a20 2020  unding box...   
-0000d570: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-0000d580: 2020 2020 2020 2020 2020 486f 6c6f 7669            Holovi
-0000d590: 6577 7320 4f76 6572 6c61 7920 746f 2064  ews Overlay to d
-0000d5a0: 6973 706c 6179 2061 6c6c 2070 6f6c 7967  isplay all polyg
-0000d5b0: 6f6e 732e 0a20 2020 2020 2020 2022 2222  ons..        """
-0000d5c0: 0a20 2020 2020 2020 2066 726f 6d20 6764  .        from gd
-0000d5d0: 7366 6163 746f 7279 2e61 6464 5f70 696e  sfactory.add_pin
-0000d5e0: 7320 696d 706f 7274 2067 6574 5f70 696e  s import get_pin
-0000d5f0: 5f74 7269 616e 676c 655f 706f 6c79 676f  _triangle_polygo
-0000d600: 6e5f 7469 700a 2020 2020 2020 2020 6672  n_tip.        fr
-0000d610: 6f6d 2067 6473 6661 6374 6f72 792e 6765  om gdsfactory.ge
-0000d620: 6e65 7269 635f 7465 6368 2069 6d70 6f72  neric_tech impor
-0000d630: 7420 4c41 5945 525f 5649 4557 530a 0a20  t LAYER_VIEWS.. 
-0000d640: 2020 2020 2020 2069 6620 6c61 7965 725f         if layer_
-0000d650: 7669 6577 7320 6973 204e 6f6e 653a 0a20  views is None:. 
-0000d660: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-0000d670: 5f76 6965 7773 203d 204c 4159 4552 5f56  _views = LAYER_V
-0000d680: 4945 5753 0a0a 2020 2020 2020 2020 7472  IEWS..        tr
-0000d690: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
-0000d6a0: 6d70 6f72 7420 686f 6c6f 7669 6577 7320  mport holoviews 
-0000d6b0: 6173 2068 760a 0a20 2020 2020 2020 2020  as hv..         
-0000d6c0: 2020 2068 762e 6578 7465 6e73 696f 6e28     hv.extension(
-0000d6d0: 2262 6f6b 6568 2229 0a20 2020 2020 2020  "bokeh").       
-0000d6e0: 2065 7863 6570 7420 496d 706f 7274 4572   except ImportEr
-0000d6f0: 726f 7220 6173 2065 3a0a 2020 2020 2020  ror as e:.      
-0000d700: 2020 2020 2020 7072 696e 7428 2279 6f75        print("you
-0000d710: 206e 6565 6420 746f 2060 7069 7020 696e   need to `pip in
-0000d720: 7374 616c 6c20 686f 6c6f 7669 6577 7360  stall holoviews`
-0000d730: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000d740: 6169 7365 2065 0a0a 2020 2020 2020 2020  aise e..        
-0000d750: 7365 6c66 2e5f 6262 5f76 616c 6964 203d  self._bb_valid =
-0000d760: 2046 616c 7365 2020 2320 7265 636f 6d70   False  # recomp
-0000d770: 7574 6520 7468 6520 626f 756e 6469 6e67  ute the bounding
-0000d780: 2062 6f78 0a20 2020 2020 2020 2062 203d   box.        b =
-0000d790: 2073 656c 662e 6262 6f78 202b 2028 282d   self.bbox + ((-
-0000d7a0: 7061 6464 696e 672c 202d 7061 6464 696e  padding, -paddin
-0000d7b0: 6729 2c20 2870 6164 6469 6e67 2c20 7061  g), (padding, pa
-0000d7c0: 6464 696e 6729 290a 2020 2020 2020 2020  dding)).        
-0000d7d0: 6220 3d20 6e70 2e61 7272 6179 2862 2e66  b = np.array(b.f
-0000d7e0: 6c61 7429 0a20 2020 2020 2020 2063 656e  lat).        cen
-0000d7f0: 7465 7220 3d20 6e70 2e61 7272 6179 2828  ter = np.array((
-0000d800: 6e70 2e73 756d 2862 5b3a 3a32 5d29 202f  np.sum(b[::2]) /
-0000d810: 2032 2c20 6e70 2e73 756d 2862 5b31 3a3a   2, np.sum(b[1::
-0000d820: 325d 2920 2f20 3229 290a 2020 2020 2020  2]) / 2)).      
-0000d830: 2020 7369 7a65 203d 206e 702e 6172 7261    size = np.arra
-0000d840: 7928 286e 702e 6162 7328 625b 325d 202d  y((np.abs(b[2] -
-0000d850: 2062 5b30 5d29 2c20 6e70 2e61 6273 2862   b[0]), np.abs(b
-0000d860: 5b33 5d20 2d20 625b 315d 2929 290a 2020  [3] - b[1]))).  
-0000d870: 2020 2020 2020 6478 203d 206e 702e 6172        dx = np.ar
-0000d880: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-0000d890: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000d8a0: 2020 206e 702e 6d61 7869 6d75 6d28 6d69     np.maximum(mi
-0000d8b0: 6e5f 6173 7065 6374 202a 2073 697a 655b  n_aspect * size[
-0000d8c0: 315d 2c20 7369 7a65 5b30 5d29 202f 2032  1], size[0]) / 2
-0000d8d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d8e0: 2020 6e70 2e6d 6178 696d 756d 2873 697a    np.maximum(siz
-0000d8f0: 655b 315d 2c20 6d69 6e5f 6173 7065 6374  e[1], min_aspect
-0000d900: 202a 2073 697a 655b 305d 2920 2f20 322c   * size[0]) / 2,
-0000d910: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000d920: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000d930: 2062 203d 206e 702e 6873 7461 636b 2828   b = np.hstack((
-0000d940: 6365 6e74 6572 202d 2064 782c 2063 656e  center - dx, cen
-0000d950: 7465 7220 2b20 6478 2929 0a0a 2020 2020  ter + dx))..    
-0000d960: 2020 2020 706c 6f74 735f 746f 5f6f 7665      plots_to_ove
-0000d970: 726c 6179 203d 205b 5d0a 2020 2020 2020  rlay = [].      
-0000d980: 2020 6c61 7965 7273 5f65 7863 6c75 6465    layers_exclude
-0000d990: 6420 3d20 5b5d 2069 6620 6c61 7965 7273  d = [] if layers
-0000d9a0: 5f65 7863 6c75 6465 6420 6973 204e 6f6e  _excluded is Non
-0000d9b0: 6520 656c 7365 206c 6179 6572 735f 6578  e else layers_ex
-0000d9c0: 636c 7564 6564 0a0a 2020 2020 2020 2020  cluded..        
-0000d9d0: 666f 7220 6c61 7965 722c 2070 6f6c 7967  for layer, polyg
-0000d9e0: 6f6e 2069 6e20 7365 6c66 2e67 6574 5f70  on in self.get_p
-0000d9f0: 6f6c 7967 6f6e 7328 6279 5f73 7065 633d  olygons(by_spec=
-0000da00: 5472 7565 292e 6974 656d 7328 293a 0a20  True).items():. 
-0000da10: 2020 2020 2020 2020 2020 2069 6620 6c61             if la
-0000da20: 7965 7220 696e 206c 6179 6572 735f 6578  yer in layers_ex
-0000da30: 636c 7564 6564 3a0a 2020 2020 2020 2020  cluded:.        
-0000da40: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-0000da50: 0a0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-0000da60: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0000da70: 2020 206c 6179 6572 5f76 6965 7720 3d20     layer_view = 
-0000da80: 6c61 7965 725f 7669 6577 732e 6765 745f  layer_views.get_
-0000da90: 6672 6f6d 5f74 7570 6c65 286c 6179 6572  from_tuple(layer
-0000daa0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-0000dab0: 6365 7074 2056 616c 7565 4572 726f 723a  cept ValueError:
-0000dac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dad0: 206c 6179 6572 7320 3d20 6c69 7374 286c   layers = list(l
-0000dae0: 6179 6572 5f76 6965 7773 2e67 6574 5f6c  ayer_views.get_l
-0000daf0: 6179 6572 5f76 6965 7773 2829 2e6b 6579  ayer_views().key
-0000db00: 7328 2929 0a20 2020 2020 2020 2020 2020  s()).           
-0000db10: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-0000db20: 726e 2866 227b 6c61 7965 7221 727d 206e  rn(f"{layer!r} n
-0000db30: 6f74 2064 6566 696e 6564 2069 6e20 7b6c  ot defined in {l
-0000db40: 6179 6572 737d 222c 2073 7461 636b 6c65  ayers}", stackle
-0000db50: 7665 6c3d 3329 0a20 2020 2020 2020 2020  vel=3).         
-0000db60: 2020 2020 2020 206c 6179 6572 5f76 6965         layer_vie
-0000db70: 7720 3d20 4c61 7965 7256 6965 7728 6c61  w = LayerView(la
-0000db80: 7965 723d 6c61 7965 7229 0a20 2020 2020  yer=layer).     
-0000db90: 2020 2020 2020 2023 2054 4f44 4f3a 204d         # TODO: M
-0000dba0: 6174 6368 2075 7020 6f70 7469 6f6e 7320  atch up options 
-0000dbb0: 7769 7468 204c 6179 6572 5669 6577 730a  with LayerViews.
-0000dbc0: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-0000dbd0: 735f 746f 5f6f 7665 726c 6179 2e61 7070  s_to_overlay.app
-0000dbe0: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
-0000dbf0: 2020 2020 2068 762e 506f 6c79 676f 6e73       hv.Polygons
-0000dc00: 2870 6f6c 7967 6f6e 2c20 6c61 6265 6c3d  (polygon, label=
-0000dc10: 7374 7228 6c61 7965 725f 7669 6577 2e6e  str(layer_view.n
-0000dc20: 616d 6529 292e 6f70 7473 280a 2020 2020  ame)).opts(.    
-0000dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc40: 6461 7461 5f61 7370 6563 743d 312c 0a20  data_aspect=1,. 
-0000dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc60: 2020 2066 7261 6d65 5f77 6964 7468 3d35     frame_width=5
-0000dc70: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-0000dc80: 2020 2020 2020 2020 796c 696d 3d28 625b          ylim=(b[
-0000dc90: 315d 2c20 625b 335d 292c 0a20 2020 2020  1], b[3]),.     
-0000dca0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0000dcb0: 6c69 6d3d 2862 5b30 5d2c 2062 5b32 5d29  lim=(b[0], b[2])
-0000dcc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000dcd0: 2020 2020 2020 6669 6c6c 5f63 6f6c 6f72        fill_color
-0000dce0: 3d6c 6179 6572 5f76 6965 772e 6669 6c6c  =layer_view.fill
-0000dcf0: 5f63 6f6c 6f72 2e61 735f 7267 6228 2920  _color.as_rgb() 
-0000dd00: 6f72 2022 222c 0a20 2020 2020 2020 2020  or "",.         
-0000dd10: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-0000dd20: 636f 6c6f 723d 6c61 7965 725f 7669 6577  color=layer_view
-0000dd30: 2e66 7261 6d65 5f63 6f6c 6f72 2e61 735f  .frame_color.as_
-0000dd40: 7267 6228 2920 6f72 2022 222c 0a20 2020  rgb() or "",.   
-0000dd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd60: 2066 696c 6c5f 616c 7068 613d 6c61 7965   fill_alpha=laye
-0000dd70: 725f 7669 6577 2e67 6574 5f61 6c70 6861  r_view.get_alpha
-0000dd80: 2829 206f 7220 2222 2c0a 2020 2020 2020  () or "",.      
-0000dd90: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0000dda0: 6e65 5f61 6c70 6861 3d6c 6179 6572 5f76  ne_alpha=layer_v
-0000ddb0: 6965 772e 6765 745f 616c 7068 6128 2920  iew.get_alpha() 
-0000ddc0: 6f72 2022 222c 0a20 2020 2020 2020 2020  or "",.         
-0000ddd0: 2020 2020 2020 2020 2020 2074 6f6f 6c73             tools
-0000dde0: 3d5b 2268 6f76 6572 225d 2c0a 2020 2020  =["hover"],.    
-0000ddf0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000de00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000de10: 2020 2020 666f 7220 6e61 6d65 2c20 706f      for name, po
-0000de20: 7274 2069 6e20 7365 6c66 2e70 6f72 7473  rt in self.ports
-0000de30: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0000de40: 2020 2020 2020 6e61 6d65 203d 2073 7472        name = str
-0000de50: 286e 616d 6529 0a20 2020 2020 2020 2020  (name).         
-0000de60: 2020 2070 6f6c 7967 6f6e 2c20 7074 6970     polygon, ptip
-0000de70: 203d 2067 6574 5f70 696e 5f74 7269 616e   = get_pin_trian
-0000de80: 676c 655f 706f 6c79 676f 6e5f 7469 7028  gle_polygon_tip(
-0000de90: 706f 7274 3d70 6f72 7429 0a0a 2020 2020  port=port)..    
-0000dea0: 2020 2020 2020 2020 706c 6f74 735f 746f          plots_to
-0000deb0: 5f6f 7665 726c 6179 2e61 7070 656e 6428  _overlay.append(
-0000dec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ded0: 2068 762e 506f 6c79 676f 6e73 2870 6f6c   hv.Polygons(pol
-0000dee0: 7967 6f6e 2c20 6c61 6265 6c3d 6e61 6d65  ygon, label=name
-0000def0: 292e 6f70 7473 280a 2020 2020 2020 2020  ).opts(.        
-0000df00: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000df10: 5f61 7370 6563 743d 312c 0a20 2020 2020  _aspect=1,.     
-0000df20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000df30: 7261 6d65 5f77 6964 7468 3d35 3030 2c0a  rame_width=500,.
-0000df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df50: 2020 2020 6669 6c6c 5f61 6c70 6861 3d30      fill_alpha=0
-0000df60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000df70: 2020 2020 2020 796c 696d 3d28 625b 315d        ylim=(b[1]
-0000df80: 2c20 625b 335d 292c 0a20 2020 2020 2020  , b[3]),.       
-0000df90: 2020 2020 2020 2020 2020 2020 2078 6c69               xli
-0000dfa0: 6d3d 2862 5b30 5d2c 2062 5b32 5d29 2c0a  m=(b[0], b[2]),.
+0000a740: 676f 6e2e 6c61 7965 7220 3d20 6c61 7965  gon.layer = laye
+0000a750: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0000a760: 2020 706f 6c79 676f 6e2e 6461 7461 7479    polygon.dataty
+0000a770: 7065 203d 2064 6174 6174 7970 650a 2020  pe = datatype.  
+0000a780: 2020 2020 2020 2020 2020 666f 7220 7061            for pa
+0000a790: 7468 2069 6e20 5f63 656c 6c2e 7061 7468  th in _cell.path
+0000a7a0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0000a7b0: 2020 2070 6174 682e 7365 745f 6c61 7965     path.set_laye
+0000a7c0: 7273 286c 6179 6572 290a 2020 2020 2020  rs(layer).      
+0000a7d0: 2020 2020 2020 2020 2020 7061 7468 2e73            path.s
+0000a7e0: 6574 5f64 6174 6174 7970 6573 2864 6174  et_datatypes(dat
+0000a7f0: 6174 7970 6529 0a0a 2020 2020 2020 2020  atype)..        
+0000a800: 636f 6d70 6f6e 656e 745f 666c 6174 2e69  component_flat.i
+0000a810: 6e66 6f20 3d20 7365 6c66 2e69 6e66 6f2e  nfo = self.info.
+0000a820: 636f 7079 2829 0a20 2020 2020 2020 2063  copy().        c
+0000a830: 6f6d 706f 6e65 6e74 5f66 6c61 742e 6164  omponent_flat.ad
+0000a840: 645f 706f 7274 7328 7365 6c66 2e70 6f72  d_ports(self.por
+0000a850: 7473 290a 2020 2020 2020 2020 7265 7475  ts).        retu
+0000a860: 726e 2063 6f6d 706f 6e65 6e74 5f66 6c61  rn component_fla
+0000a870: 740a 0a20 2020 2064 6566 2066 6c61 7474  t..    def flatt
+0000a880: 656e 5f72 6566 6572 656e 6365 2873 656c  en_reference(sel
+0000a890: 662c 2072 6566 3a20 436f 6d70 6f6e 656e  f, ref: Componen
+0000a8a0: 7452 6566 6572 656e 6365 2920 2d3e 204e  tReference) -> N
+0000a8b0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+0000a8c0: 4672 6f6d 2065 7869 7374 696e 6720 6365  From existing ce
+0000a8d0: 6c6c 2072 6570 6c61 6365 7320 7265 6665  ll replaces refe
+0000a8e0: 7265 6e63 6520 7769 7468 2061 2066 6c61  rence with a fla
+0000a8f0: 7474 656e 2072 6566 6572 656e 6365 205c  tten reference \
+0000a900: 0a20 2020 2020 2020 2077 6869 6368 2068  .        which h
+0000a910: 6173 2074 6865 2074 7261 6e73 666f 726d  as the transform
+0000a920: 6174 696f 6e73 2061 6c72 6561 6479 2061  ations already a
+0000a930: 7070 6c69 6564 2e0a 0a20 2020 2020 2020  pplied...       
+0000a940: 2054 7261 6e73 666f 726d 6564 2072 6566   Transformed ref
+0000a950: 6572 656e 6365 206b 6565 7073 2074 6865  erence keeps the
+0000a960: 206f 7269 6769 6e61 6c20 6e61 6d65 2e0a   original name..
+0000a970: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+0000a980: 2020 2020 2020 2020 2020 2072 6566 3a20             ref: 
+0000a990: 7468 6520 7265 6665 7265 6e63 6520 746f  the reference to
+0000a9a0: 2066 6c61 7474 656e 2069 6e74 6f20 6120   flatten into a 
+0000a9b0: 6e65 7720 6365 6c6c 2e0a 0a20 2020 2020  new cell...     
+0000a9c0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0000a9d0: 726f 6d20 6764 7366 6163 746f 7279 2e66  rom gdsfactory.f
+0000a9e0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0000a9f0: 7472 616e 7366 6f72 6d65 640a 0a20 2020  transformed..   
+0000aa00: 2020 2020 2073 656c 662e 7265 6d6f 7665       self.remove
+0000aa10: 2872 6566 290a 2020 2020 2020 2020 6e65  (ref).        ne
+0000aa20: 775f 636f 6d70 6f6e 656e 7420 3d20 7472  w_component = tr
+0000aa30: 616e 7366 6f72 6d65 6428 7265 662c 2064  ansformed(ref, d
+0000aa40: 6563 6f72 6174 6f72 3d4e 6f6e 6529 0a20  ecorator=None). 
+0000aa50: 2020 2020 2020 2073 656c 662e 6164 645f         self.add_
+0000aa60: 7265 6628 6e65 775f 636f 6d70 6f6e 656e  ref(new_componen
+0000aa70: 742c 2061 6c69 6173 3d72 6566 2e6e 616d  t, alias=ref.nam
+0000aa80: 6529 0a0a 2020 2020 6465 6620 6164 645f  e)..    def add_
+0000aa90: 7265 6628 0a20 2020 2020 2020 2073 656c  ref(.        sel
+0000aaa0: 662c 2063 6f6d 706f 6e65 6e74 3a20 436f  f, component: Co
+0000aab0: 6d70 6f6e 656e 742c 2061 6c69 6173 3a20  mponent, alias: 
+0000aac0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000aad0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 0a20  None, **kwargs. 
+0000aae0: 2020 2029 202d 3e20 436f 6d70 6f6e 656e     ) -> Componen
+0000aaf0: 7452 6566 6572 656e 6365 3a0a 2020 2020  tReference:.    
+0000ab00: 2020 2020 2222 2241 6464 2043 6f6d 706f      """Add Compo
+0000ab10: 6e65 6e74 5265 6665 7265 6e63 6520 746f  nentReference to
+0000ab20: 2074 6865 2063 7572 7265 6e74 2043 6f6d   the current Com
+0000ab30: 706f 6e65 6e74 2e0a 0a20 2020 2020 2020  ponent...       
+0000ab40: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+0000ab50: 2020 2063 6f6d 706f 6e65 6e74 3a20 436f     component: Co
+0000ab60: 6d70 6f6e 656e 742e 0a20 2020 2020 2020  mponent..       
+0000ab70: 2020 2020 2061 6c69 6173 3a20 6e61 6d65       alias: name
+0000ab80: 645f 7265 6665 7265 6e63 6573 2e0a 0a20  d_references... 
+0000ab90: 2020 2020 2020 204b 6579 776f 7264 2041         Keyword A
+0000aba0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+0000abb0: 2063 6f6c 756d 6e73 3a20 4e75 6d62 6572   columns: Number
+0000abc0: 206f 6620 636f 6c75 6d6e 7320 696e 2074   of columns in t
+0000abd0: 6865 2061 7272 6179 2e0a 2020 2020 2020  he array..      
+0000abe0: 2020 2020 2020 726f 7773 3a20 4e75 6d62        rows: Numb
+0000abf0: 6572 206f 6620 726f 7773 2069 6e20 7468  er of rows in th
+0000ac00: 6520 6172 7261 792e 0a20 2020 2020 2020  e array..       
+0000ac10: 2020 2020 2073 7061 6369 6e67 3a20 4469       spacing: Di
+0000ac20: 7374 616e 6365 7320 6265 7477 6565 6e20  stances between 
+0000ac30: 6164 6a61 6365 6e74 2063 6f6c 756d 6e73  adjacent columns
+0000ac40: 2061 6e64 2061 646a 6163 656e 7420 726f   and adjacent ro
+0000ac50: 7773 2e0a 2020 2020 2020 2020 2020 2020  ws..            
+0000ac60: 6f72 6967 696e 3a20 6172 7261 792d 6c69  origin: array-li
+0000ac70: 6b65 5b32 5d20 6f66 2069 6e74 206f 7220  ke[2] of int or 
+0000ac80: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+0000ac90: 2020 2020 2020 506f 7369 7469 6f6e 2077        Position w
+0000aca0: 6865 7265 2074 6865 2063 656c 6c20 6973  here the cell is
+0000acb0: 2069 6e73 6572 7465 642e 0a20 2020 2020   inserted..     
+0000acc0: 2020 2020 2020 2072 6f74 6174 696f 6e20         rotation 
+0000acd0: 3a20 696e 7420 6f72 2066 6c6f 6174 0a20  : int or float. 
+0000ace0: 2020 2020 2020 2020 2020 2020 2020 2041                 A
+0000acf0: 6e67 6c65 206f 6620 726f 7461 7469 6f6e  ngle of rotation
+0000ad00: 206f 6620 7468 6520 7265 6665 7265 6e63   of the referenc
+0000ad10: 6520 2869 6e20 6064 6567 7265 6573 6029  e (in `degrees`)
+0000ad20: 2e0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+0000ad30: 676e 6966 6963 6174 696f 6e20 3a20 696e  gnification : in
+0000ad40: 7420 6f72 2066 6c6f 6174 0a20 2020 2020  t or float.     
+0000ad50: 2020 2020 2020 2020 2020 204d 6167 6e69             Magni
+0000ad60: 6669 6361 7469 6f6e 2066 6163 746f 7220  fication factor 
+0000ad70: 666f 7220 7468 6520 7265 6665 7265 6e63  for the referenc
+0000ad80: 652e 0a20 2020 2020 2020 2020 2020 2078  e..            x
+0000ad90: 5f72 6566 6c65 6374 696f 6e20 3a20 626f  _reflection : bo
+0000ada0: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
+0000adb0: 2020 2049 6620 5472 7565 2c20 7468 6520     If True, the 
+0000adc0: 7265 6665 7265 6e63 6520 6973 2072 6566  reference is ref
+0000add0: 6c65 6374 6564 2070 6172 616c 6c65 6c20  lected parallel 
+0000ade0: 746f 2074 6865 2078 2064 6972 6563 7469  to the x directi
+0000adf0: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+0000ae00: 2020 2062 6566 6f72 6520 6265 696e 6720     before being 
+0000ae10: 726f 7461 7465 642e 0a20 2020 2020 2020  rotated..       
+0000ae20: 2020 2020 206e 616d 6520 3a20 7374 7220       name : str 
+0000ae30: 286f 7074 696f 6e61 6c29 0a20 2020 2020  (optional).     
+0000ae40: 2020 2020 2020 2020 2020 2041 206e 616d             A nam
+0000ae50: 6520 666f 7220 7468 6520 7265 6665 7265  e for the refere
+0000ae60: 6e63 6520 2869 6620 7072 6f76 6964 6564  nce (if provided
+0000ae70: 292e 0a0a 2020 2020 2020 2020 2222 220a  )...        """.
+0000ae80: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+0000ae90: 7369 6e73 7461 6e63 6528 636f 6d70 6f6e  sinstance(compon
+0000aea0: 656e 742c 2043 6f6d 706f 6e65 6e74 293a  ent, Component):
+0000aeb0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000aec0: 7365 2054 7970 6545 7272 6f72 2866 2274  se TypeError(f"t
+0000aed0: 7970 6520 3d20 7b74 7970 6528 436f 6d70  ype = {type(Comp
+0000aee0: 6f6e 656e 7429 7d20 6e65 6564 7320 746f  onent)} needs to
+0000aef0: 2062 6520 6120 436f 6d70 6f6e 656e 742e   be a Component.
+0000af00: 2229 0a20 2020 2020 2020 2072 6566 203d  ").        ref =
+0000af10: 2043 6f6d 706f 6e65 6e74 5265 6665 7265   ComponentRefere
+0000af20: 6e63 6528 636f 6d70 6f6e 656e 742c 202a  nce(component, *
+0000af30: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+0000af40: 2073 656c 662e 5f61 6464 2872 6566 290a   self._add(ref).
+0000af50: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+0000af60: 6769 7374 6572 5f72 6566 6572 656e 6365  gister_reference
+0000af70: 2872 6566 6572 656e 6365 3d72 6566 2c20  (reference=ref, 
+0000af80: 616c 6961 733d 616c 6961 7329 0a20 2020  alias=alias).   
+0000af90: 2020 2020 2072 6574 7572 6e20 7265 660a       return ref.
+0000afa0: 0a20 2020 2064 6566 205f 7265 6769 7374  .    def _regist
+0000afb0: 6572 5f72 6566 6572 656e 6365 280a 2020  er_reference(.  
+0000afc0: 2020 2020 2020 7365 6c66 2c20 7265 6665        self, refe
+0000afd0: 7265 6e63 653a 2043 6f6d 706f 6e65 6e74  rence: Component
+0000afe0: 5265 6665 7265 6e63 652c 2061 6c69 6173  Reference, alias
+0000aff0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000b000: 3d20 4e6f 6e65 0a20 2020 2029 202d 3e20  = None.    ) -> 
+0000b010: 4e6f 6e65 3a0a 2020 2020 2020 2020 636f  None:.        co
+0000b020: 6d70 6f6e 656e 7420 3d20 7265 6665 7265  mponent = refere
+0000b030: 6e63 652e 7061 7265 6e74 0a20 2020 2020  nce.parent.     
+0000b040: 2020 2072 6566 6572 656e 6365 2e6f 776e     reference.own
+0000b050: 6572 203d 2073 656c 660a 0a20 2020 2020  er = self..     
+0000b060: 2020 2069 6620 616c 6961 7320 6973 204e     if alias is N
+0000b070: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000b080: 2069 6620 7265 6665 7265 6e63 652e 6e61   if reference.na
+0000b090: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
+0000b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0b0: 616c 6961 7320 3d20 7265 6665 7265 6e63  alias = referenc
+0000b0c0: 652e 6e61 6d65 0a20 2020 2020 2020 2020  e.name.         
+0000b0d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000b0e0: 2020 2020 2020 2020 2070 7265 6669 7820           prefix 
+0000b0f0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0000b100: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+0000b110: 742e 7365 7474 696e 6773 2e66 756e 6374  t.settings.funct
+0000b120: 696f 6e5f 6e61 6d65 0a20 2020 2020 2020  ion_name.       
+0000b130: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000b140: 6861 7361 7474 7228 636f 6d70 6f6e 656e  hasattr(componen
+0000b150: 742c 2022 7365 7474 696e 6773 2229 0a20  t, "settings"). 
+0000b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b170: 2020 2061 6e64 2068 6173 6174 7472 2863     and hasattr(c
+0000b180: 6f6d 706f 6e65 6e74 2e73 6574 7469 6e67  omponent.setting
+0000b190: 732c 2022 6675 6e63 7469 6f6e 5f6e 616d  s, "function_nam
+0000b1a0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+0000b1b0: 2020 2020 2020 2020 656c 7365 2063 6f6d          else com
+0000b1c0: 706f 6e65 6e74 2e6e 616d 650a 2020 2020  ponent.name.    
+0000b1d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000b1e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000b1f0: 6c66 2e5f 7265 6665 7265 6e63 655f 6e61  lf._reference_na
+0000b200: 6d65 735f 636f 756e 7465 722e 7570 6461  mes_counter.upda
+0000b210: 7465 287b 7072 6566 6978 3a20 317d 290a  te({prefix: 1}).
+0000b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b230: 616c 6961 7320 3d20 6622 7b70 7265 6669  alias = f"{prefi
+0000b240: 787d 5f7b 7365 6c66 2e5f 7265 6665 7265  x}_{self._refere
+0000b250: 6e63 655f 6e61 6d65 735f 636f 756e 7465  nce_names_counte
+0000b260: 725b 7072 6566 6978 5d7d 220a 0a20 2020  r[prefix]}"..   
+0000b270: 2020 2020 2020 2020 2020 2020 2077 6869               whi
+0000b280: 6c65 2061 6c69 6173 2069 6e20 7365 6c66  le alias in self
+0000b290: 2e5f 6e61 6d65 645f 7265 6665 7265 6e63  ._named_referenc
+0000b2a0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000b2b0: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+0000b2c0: 6665 7265 6e63 655f 6e61 6d65 735f 636f  ference_names_co
+0000b2d0: 756e 7465 722e 7570 6461 7465 287b 7072  unter.update({pr
+0000b2e0: 6566 6978 3a20 317d 290a 2020 2020 2020  efix: 1}).      
+0000b2f0: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0000b300: 6961 7320 3d20 6622 7b70 7265 6669 787d  ias = f"{prefix}
+0000b310: 5f7b 7365 6c66 2e5f 7265 6665 7265 6e63  _{self._referenc
+0000b320: 655f 6e61 6d65 735f 636f 756e 7465 725b  e_names_counter[
+0000b330: 7072 6566 6978 5d7d 220a 0a20 2020 2020  prefix]}"..     
+0000b340: 2020 2072 6566 6572 656e 6365 2e6e 616d     reference.nam
+0000b350: 6520 3d20 616c 6961 730a 2020 2020 2020  e = alias.      
+0000b360: 2020 7365 6c66 2e5f 6e61 6d65 645f 7265    self._named_re
+0000b370: 6665 7265 6e63 6573 5b61 6c69 6173 5d20  ferences[alias] 
+0000b380: 3d20 7265 6665 7265 6e63 650a 0a20 2020  = reference..   
+0000b390: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000b3a0: 6566 206c 6179 6572 7328 7365 6c66 2920  ef layers(self) 
+0000b3b0: 2d3e 2053 6574 5b54 7570 6c65 5b69 6e74  -> Set[Tuple[int
+0000b3c0: 2c20 696e 745d 5d3a 0a20 2020 2020 2020  , int]]:.       
+0000b3d0: 2022 2222 5265 7475 726e 7320 6120 7365   """Returns a se
+0000b3e0: 7420 6f66 2074 6865 204c 6179 6572 7320  t of the Layers 
+0000b3f0: 696e 2074 6865 2043 6f6d 706f 6e65 6e74  in the Component
+0000b400: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
+0000b410: 7572 6e20 7365 6c66 2e67 6574 5f6c 6179  urn self.get_lay
+0000b420: 6572 7328 290a 0a20 2020 2064 6566 2067  ers()..    def g
+0000b430: 6574 5f6c 6179 6572 7328 7365 6c66 2920  et_layers(self) 
+0000b440: 2d3e 2053 6574 5b54 7570 6c65 5b69 6e74  -> Set[Tuple[int
+0000b450: 2c20 696e 745d 5d3a 0a20 2020 2020 2020  , int]]:.       
+0000b460: 2022 2222 5265 7475 726e 2061 2073 6574   """Return a set
+0000b470: 206f 6620 286c 6179 6572 2c20 6461 7461   of (layer, data
+0000b480: 7479 7065 292e 0a0a 2020 2020 2020 2020  type)...        
+0000b490: 2e2e 2063 6f64 6520 3a3a 0a0a 2020 2020  .. code ::..    
+0000b4a0: 2020 2020 2020 2020 696d 706f 7274 2067          import g
+0000b4b0: 6473 6661 6374 6f72 7920 6173 2067 660a  dsfactory as gf.
+0000b4c0: 2020 2020 2020 2020 2020 2020 6766 2e63              gf.c
+0000b4d0: 6f6d 706f 6e65 6e74 732e 7374 7261 6967  omponents.straig
+0000b4e0: 6874 2829 2e67 6574 5f6c 6179 6572 7328  ht().get_layers(
+0000b4f0: 2920 3d3d 207b 2831 2c20 3029 2c20 2831  ) == {(1, 0), (1
+0000b500: 3131 2c20 3029 7d0a 2020 2020 2020 2020  11, 0)}.        
+0000b510: 2222 220a 2020 2020 2020 2020 706f 6c79  """.        poly
+0000b520: 676f 6e73 203d 2073 656c 662e 5f63 656c  gons = self._cel
+0000b530: 6c2e 6765 745f 706f 6c79 676f 6e73 2864  l.get_polygons(d
+0000b540: 6570 7468 3d4e 6f6e 6529 0a20 2020 2020  epth=None).     
+0000b550: 2020 2072 6574 7572 6e20 7b28 706f 6c79     return {(poly
+0000b560: 676f 6e2e 6c61 7965 722c 2070 6f6c 7967  gon.layer, polyg
+0000b570: 6f6e 2e64 6174 6174 7970 6529 2066 6f72  on.datatype) for
+0000b580: 2070 6f6c 7967 6f6e 2069 6e20 706f 6c79   polygon in poly
+0000b590: 676f 6e73 7d0a 0a20 2020 2064 6566 2067  gons}..    def g
+0000b5a0: 6574 5f6c 6179 6572 5f6e 616d 6573 2873  et_layer_names(s
+0000b5b0: 656c 6629 202d 3e20 4c69 7374 5b54 7570  elf) -> List[Tup
+0000b5c0: 6c65 5b69 6e74 2c20 696e 745d 5d3a 0a20  le[int, int]]:. 
+0000b5d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000b5e0: 206c 6179 6572 206e 616d 6573 2075 7365   layer names use
+0000b5f0: 6420 696e 2074 6865 2064 6573 6967 6e2e  d in the design.
+0000b600: 0a0a 2020 2020 2020 2020 2e2e 2063 6f64  ..        .. cod
+0000b610: 6520 3a3a 0a0a 2020 2020 2020 2020 2020  e ::..          
+0000b620: 2020 696d 706f 7274 2067 6473 6661 6374    import gdsfact
+0000b630: 6f72 7920 6173 2067 660a 2020 2020 2020  ory as gf.      
+0000b640: 2020 2020 2020 6766 2e63 6f6d 706f 6e65        gf.compone
+0000b650: 6e74 732e 7374 7261 6967 6874 2829 2e67  nts.straight().g
+0000b660: 6574 5f6e 616d 6573 2829 203d 3d20 5b27  et_names() == ['
+0000b670: 5747 275d 0a20 2020 2020 2020 2022 2222  WG'].        """
+0000b680: 0a20 2020 2020 2020 2069 6d70 6f72 7420  .        import 
+0000b690: 6764 7366 6163 746f 7279 2061 7320 6766  gdsfactory as gf
+0000b6a0: 0a0a 2020 2020 2020 2020 5044 4b20 3d20  ..        PDK = 
+0000b6b0: 6766 2e67 6574 5f61 6374 6976 655f 7064  gf.get_active_pd
+0000b6c0: 6b28 290a 2020 2020 2020 2020 4c41 5945  k().        LAYE
+0000b6d0: 5253 203d 2050 444b 2e6c 6179 6572 730a  RS = PDK.layers.
+0000b6e0: 2020 2020 2020 2020 6e61 6d65 5f74 6f5f          name_to_
+0000b6f0: 6c61 7965 7220 3d20 6469 6374 284c 4159  layer = dict(LAY
+0000b700: 4552 5329 0a20 2020 2020 2020 206c 6179  ERS).        lay
+0000b710: 6572 5f74 6f5f 6e61 6d65 203d 207b 763a  er_to_name = {v:
+0000b720: 206b 2066 6f72 206b 2c20 7620 696e 206e   k for k, v in n
+0000b730: 616d 655f 746f 5f6c 6179 6572 2e69 7465  ame_to_layer.ite
+0000b740: 6d73 2829 7d0a 2020 2020 2020 2020 6c61  ms()}.        la
+0000b750: 7965 725f 6e61 6d65 7320 3d20 5b5d 0a0a  yer_names = []..
+0000b760: 2020 2020 2020 2020 666f 7220 6c61 7965          for laye
+0000b770: 7220 696e 2073 656c 662e 6c61 7965 7273  r in self.layers
+0000b780: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000b790: 206c 6179 6572 206e 6f74 2069 6e20 6c61   layer not in la
+0000b7a0: 7965 725f 746f 5f6e 616d 653a 0a20 2020  yer_to_name:.   
+0000b7b0: 2020 2020 2020 2020 2020 2020 2077 6172               war
+0000b7c0: 6e69 6e67 732e 7761 726e 2866 227b 6c61  nings.warn(f"{la
+0000b7d0: 7965 727d 206e 6f74 2069 6e20 4c61 7965  yer} not in Laye
+0000b7e0: 724d 6170 2e22 2c20 7374 6163 6b6c 6576  rMap.", stacklev
+0000b7f0: 656c 3d33 290a 2020 2020 2020 2020 2020  el=3).          
+0000b800: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000b810: 2020 2020 2020 2020 6c61 7965 725f 6e61          layer_na
+0000b820: 6d65 732e 6170 7065 6e64 286c 6179 6572  mes.append(layer
+0000b830: 5f74 6f5f 6e61 6d65 5b6c 6179 6572 5d29  _to_name[layer])
+0000b840: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b850: 6c61 7965 725f 6e61 6d65 730a 0a20 2020  layer_names..   
+0000b860: 2064 6566 205f 6970 7974 686f 6e5f 6469   def _ipython_di
+0000b870: 7370 6c61 795f 2873 656c 6629 202d 3e20  splay_(self) -> 
+0000b880: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+0000b890: 2253 686f 7720 6765 6f6d 6574 7279 2069  "Show geometry i
+0000b8a0: 6e20 4b4c 6179 6f75 7420 616e 6420 696e  n KLayout and in
+0000b8b0: 206d 6174 706c 6f74 6c69 6220 666f 7220   matplotlib for 
+0000b8c0: 4a75 7079 7465 7220 4e6f 7465 626f 6f6b  Jupyter Notebook
+0000b8d0: 732e 2222 220a 2020 2020 2020 2020 7365  s.""".        se
+0000b8e0: 6c66 2e73 686f 7728 7368 6f77 5f70 6f72  lf.show(show_por
+0000b8f0: 7473 3d54 7275 6529 2020 2320 7368 6f77  ts=True)  # show
+0000b900: 2069 6e20 6b6c 6179 6f75 740a 2020 2020   in klayout.    
+0000b910: 2020 2020 7365 6c66 2e70 6c6f 745f 6b6c      self.plot_kl
+0000b920: 6179 6f75 7428 290a 2020 2020 2020 2020  ayout().        
+0000b930: 7072 696e 7428 7365 6c66 290a 0a20 2020  print(self)..   
+0000b940: 2064 6566 2061 6464 5f70 696e 735f 7472   def add_pins_tr
+0000b950: 6961 6e67 6c65 280a 2020 2020 2020 2020  iangle(.        
+0000b960: 7365 6c66 2c0a 2020 2020 2020 2020 706f  self,.        po
+0000b970: 7274 5f6d 6172 6b65 725f 6c61 7965 723a  rt_marker_layer:
+0000b980: 204c 6179 6572 203d 2028 312c 2031 3029   Layer = (1, 10)
+0000b990: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000b9a0: 2022 2222 5265 7475 726e 7320 636f 6d70   """Returns comp
+0000b9b0: 6f6e 656e 7420 7769 7468 2074 7269 616e  onent with trian
+0000b9c0: 6775 6c61 7220 7069 6e73 2e22 2222 0a20  gular pins.""". 
+0000b9d0: 2020 2020 2020 2066 726f 6d20 6764 7366         from gdsf
+0000b9e0: 6163 746f 7279 2e61 6464 5f70 696e 7320  actory.add_pins 
+0000b9f0: 696d 706f 7274 2061 6464 5f70 696e 735f  import add_pins_
+0000ba00: 7472 6961 6e67 6c65 0a0a 2020 2020 2020  triangle..      
+0000ba10: 2020 636f 6d70 6f6e 656e 7420 3d20 7365    component = se
+0000ba20: 6c66 2e63 6f70 7928 290a 2020 2020 2020  lf.copy().      
+0000ba30: 2020 636f 6d70 6f6e 656e 742e 6e61 6d65    component.name
+0000ba40: 203d 2073 656c 662e 6e61 6d65 0a20 2020   = self.name.   
+0000ba50: 2020 2020 2061 6464 5f70 696e 735f 7472       add_pins_tr
+0000ba60: 6961 6e67 6c65 2863 6f6d 706f 6e65 6e74  iangle(component
+0000ba70: 3d63 6f6d 706f 6e65 6e74 2c20 6c61 7965  =component, laye
+0000ba80: 723d 706f 7274 5f6d 6172 6b65 725f 6c61  r=port_marker_la
+0000ba90: 7965 7229 0a20 2020 2020 2020 2072 6574  yer).        ret
+0000baa0: 7572 6e20 636f 6d70 6f6e 656e 740a 0a20  urn component.. 
+0000bab0: 2020 2064 6566 2070 6c6f 745f 7769 6467     def plot_widg
+0000bac0: 6574 280a 2020 2020 2020 2020 7365 6c66  et(.        self
+0000bad0: 2c0a 2020 2020 2020 2020 7368 6f77 5f70  ,.        show_p
+0000bae0: 6f72 7473 3a20 626f 6f6c 203d 2054 7275  orts: bool = Tru
+0000baf0: 652c 0a20 2020 2020 2020 2070 6f72 745f  e,.        port_
+0000bb00: 6d61 726b 6572 5f6c 6179 6572 3a20 4c61  marker_layer: La
+0000bb10: 7965 7220 3d20 2831 2c20 3130 292c 0a20  yer = (1, 10),. 
+0000bb20: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0000bb30: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
+0000bb40: 2069 7079 7468 6f6e 2077 6964 6765 7420   ipython widget 
+0000bb50: 666f 7220 6b6c 6179 6f75 7420 7669 7375  for klayout visu
+0000bb60: 616c 697a 6174 696f 6e2e 0a0a 2020 2020  alization...    
+0000bb70: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0000bb80: 2020 2020 2020 7368 6f77 5f70 6f72 7473        show_ports
+0000bb90: 3a20 7368 6f77 7320 636f 6d70 6f6e 656e  : shows componen
+0000bba0: 7420 7769 7468 2070 6f72 7420 6d61 726b  t with port mark
+0000bbb0: 6572 7320 616e 6420 6c61 6265 6c73 2e0a  ers and labels..
+0000bbc0: 2020 2020 2020 2020 2020 2020 706f 7274              port
+0000bbd0: 5f6d 6172 6b65 725f 6c61 7965 723a 2066  _marker_layer: f
+0000bbe0: 6f72 2074 6865 2070 6f72 7473 2e0a 2020  or the ports..  
+0000bbf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000bc00: 2020 6672 6f6d 2067 6473 6661 6374 6f72    from gdsfactor
+0000bc10: 792e 7064 6b20 696d 706f 7274 2067 6574  y.pdk import get
+0000bc20: 5f6c 6179 6572 5f76 6965 7773 0a20 2020  _layer_views.   
+0000bc30: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
+0000bc40: 746f 7279 2e77 6964 6765 7473 2e6c 6179  tory.widgets.lay
+0000bc50: 6f75 745f 7669 6577 6572 2069 6d70 6f72  out_viewer impor
+0000bc60: 7420 4c61 796f 7574 5669 6577 6572 0a20  t LayoutViewer. 
+0000bc70: 2020 2020 2020 2066 726f 6d20 4950 7974         from IPyt
+0000bc80: 686f 6e2e 6469 7370 6c61 7920 696d 706f  hon.display impo
+0000bc90: 7274 2064 6973 706c 6179 0a0a 2020 2020  rt display..    
+0000bca0: 2020 2020 636f 6d70 6f6e 656e 7420 3d20      component = 
+0000bcb0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0000bcc0: 6c66 2e61 6464 5f70 696e 735f 7472 6961  lf.add_pins_tria
+0000bcd0: 6e67 6c65 2870 6f72 745f 6d61 726b 6572  ngle(port_marker
+0000bce0: 5f6c 6179 6572 3d70 6f72 745f 6d61 726b  _layer=port_mark
+0000bcf0: 6572 5f6c 6179 6572 290a 2020 2020 2020  er_layer).      
+0000bd00: 2020 2020 2020 6966 2073 686f 775f 706f        if show_po
+0000bd10: 7274 730a 2020 2020 2020 2020 2020 2020  rts.            
+0000bd20: 656c 7365 2073 656c 660a 2020 2020 2020  else self.      
+0000bd30: 2020 290a 0a20 2020 2020 2020 2067 6473    )..        gds
+0000bd40: 7061 7468 203d 2063 6f6d 706f 6e65 6e74  path = component
+0000bd50: 2e77 7269 7465 5f67 6473 286c 6f67 6769  .write_gds(loggi
+0000bd60: 6e67 3d46 616c 7365 290a 2020 2020 2020  ng=False).      
+0000bd70: 2020 6c79 705f 7061 7468 203d 2067 6473    lyp_path = gds
+0000bd80: 7061 7468 2e77 6974 685f 7375 6666 6978  path.with_suffix
+0000bd90: 2822 2e6c 7970 2229 0a0a 2020 2020 2020  (".lyp")..      
+0000bda0: 2020 6c61 7965 725f 7669 6577 7320 3d20    layer_views = 
+0000bdb0: 6765 745f 6c61 7965 725f 7669 6577 7328  get_layer_views(
+0000bdc0: 290a 2020 2020 2020 2020 6c61 7965 725f  ).        layer_
+0000bdd0: 7669 6577 732e 746f 5f6c 7970 2866 696c  views.to_lyp(fil
+0000bde0: 6570 6174 683d 6c79 705f 7061 7468 290a  epath=lyp_path).
+0000bdf0: 0a20 2020 2020 2020 206c 6179 6f75 7420  .        layout 
+0000be00: 3d20 4c61 796f 7574 5669 6577 6572 2867  = LayoutViewer(g
+0000be10: 6473 7061 7468 2c20 6c79 705f 7061 7468  dspath, lyp_path
+0000be20: 290a 2020 2020 2020 2020 6469 7370 6c61  ).        displa
+0000be30: 7928 6c61 796f 7574 2e77 6964 6765 7429  y(layout.widget)
+0000be40: 0a0a 2020 2020 6465 6620 706c 6f74 5f6b  ..    def plot_k
+0000be50: 6c61 796f 7574 280a 2020 2020 2020 2020  layout(.        
+0000be60: 7365 6c66 2c0a 2020 2020 2020 2020 7368  self,.        sh
+0000be70: 6f77 5f70 6f72 7473 3a20 626f 6f6c 203d  ow_ports: bool =
+0000be80: 2054 7275 652c 0a20 2020 2020 2020 2070   True,.        p
+0000be90: 6f72 745f 6d61 726b 6572 5f6c 6179 6572  ort_marker_layer
+0000bea0: 3a20 4c61 7965 7220 3d20 2831 2c20 3130  : Layer = (1, 10
+0000beb0: 292c 0a20 2020 2020 2020 2073 686f 775f  ),.        show_
+0000bec0: 6c61 6265 6c73 3a20 626f 6f6c 203d 2046  labels: bool = F
+0000bed0: 616c 7365 2c0a 2020 2020 2920 2d3e 204e  alse,.    ) -> N
+0000bee0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+0000bef0: 5265 7475 726e 7320 6b6c 6179 6f75 7420  Returns klayout 
+0000bf00: 696d 6167 652e 0a0a 2020 2020 2020 2020  image...        
+0000bf10: 4966 2069 7420 6661 696c 7320 746f 2069  If it fails to i
+0000bf20: 6d70 6f72 7420 6b6c 6179 6f75 7420 6465  mport klayout de
+0000bf30: 6661 756c 7473 2074 6f20 6d61 7470 6c6f  faults to matplo
+0000bf40: 746c 6962 2e0a 0a20 2020 2020 2020 2041  tlib...        A
+0000bf50: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+0000bf60: 2073 686f 775f 706f 7274 733a 2073 686f   show_ports: sho
+0000bf70: 7773 2063 6f6d 706f 6e65 6e74 2077 6974  ws component wit
+0000bf80: 6820 706f 7274 206d 6172 6b65 7273 2061  h port markers a
+0000bf90: 6e64 206c 6162 656c 732e 0a20 2020 2020  nd labels..     
+0000bfa0: 2020 2020 2020 2070 6f72 745f 6d61 726b         port_mark
+0000bfb0: 6572 5f6c 6179 6572 3a20 666f 7220 7468  er_layer: for th
+0000bfc0: 6520 706f 7274 732e 0a20 2020 2020 2020  e ports..       
+0000bfd0: 2020 2020 2073 686f 775f 6c61 6265 6c73       show_labels
+0000bfe0: 3a20 7368 6f77 7320 6c61 6265 6c73 2e0a  : shows labels..
+0000bff0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000c000: 2020 2020 2063 6f6d 706f 6e65 6e74 203d       component =
+0000c010: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
+0000c020: 656c 662e 6164 645f 7069 6e73 5f74 7269  elf.add_pins_tri
+0000c030: 616e 676c 6528 706f 7274 5f6d 6172 6b65  angle(port_marke
+0000c040: 725f 6c61 7965 723d 706f 7274 5f6d 6172  r_layer=port_mar
+0000c050: 6b65 725f 6c61 7965 7229 0a20 2020 2020  ker_layer).     
+0000c060: 2020 2020 2020 2069 6620 7368 6f77 5f70         if show_p
+0000c070: 6f72 7473 0a20 2020 2020 2020 2020 2020  orts.           
+0000c080: 2065 6c73 6520 7365 6c66 0a20 2020 2020   else self.     
+0000c090: 2020 2029 0a0a 2020 2020 2020 2020 7472     )..        tr
+0000c0a0: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
+0000c0b0: 6d70 6f72 7420 6b6c 6179 6f75 742e 6462  mport klayout.db
+0000c0c0: 2061 7320 6462 2020 2320 6e6f 7161 3a20   as db  # noqa: 
+0000c0d0: 4634 3031 0a20 2020 2020 2020 2020 2020  F401.           
+0000c0e0: 2069 6d70 6f72 7420 6b6c 6179 6f75 742e   import klayout.
+0000c0f0: 6c61 7920 6173 206c 6179 0a20 2020 2020  lay as lay.     
+0000c100: 2020 2020 2020 2066 726f 6d20 6764 7366         from gdsf
+0000c110: 6163 746f 7279 2e70 646b 2069 6d70 6f72  actory.pdk impor
+0000c120: 7420 6765 745f 6c61 7965 725f 7669 6577  t get_layer_view
+0000c130: 730a 2020 2020 2020 2020 2020 2020 6672  s.            fr
+0000c140: 6f6d 2049 5079 7468 6f6e 2e64 6973 706c  om IPython.displ
+0000c150: 6179 2069 6d70 6f72 7420 6469 7370 6c61  ay import displa
+0000c160: 790a 2020 2020 2020 2020 2020 2020 6672  y.            fr
+0000c170: 6f6d 2069 7079 7769 6467 6574 7320 696d  om ipywidgets im
+0000c180: 706f 7274 2049 6d61 6765 0a0a 2020 2020  port Image..    
+0000c190: 2020 2020 2020 2020 6764 7370 6174 6820          gdspath 
+0000c1a0: 3d20 636f 6d70 6f6e 656e 742e 7772 6974  = component.writ
+0000c1b0: 655f 6764 7328 6c6f 6767 696e 673d 4661  e_gds(logging=Fa
+0000c1c0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+0000c1d0: 206c 7970 5f70 6174 6820 3d20 6764 7370   lyp_path = gdsp
+0000c1e0: 6174 682e 7769 7468 5f73 7566 6669 7828  ath.with_suffix(
+0000c1f0: 222e 6c79 7022 290a 0a20 2020 2020 2020  ".lyp")..       
+0000c200: 2020 2020 206c 6179 6572 5f76 6965 7773       layer_views
+0000c210: 203d 2067 6574 5f6c 6179 6572 5f76 6965   = get_layer_vie
+0000c220: 7773 2829 0a20 2020 2020 2020 2020 2020  ws().           
+0000c230: 206c 6179 6572 5f76 6965 7773 2e74 6f5f   layer_views.to_
+0000c240: 6c79 7028 6669 6c65 7061 7468 3d6c 7970  lyp(filepath=lyp
+0000c250: 5f70 6174 6829 0a0a 2020 2020 2020 2020  _path)..        
+0000c260: 2020 2020 6c61 796f 7574 5f76 6965 7720      layout_view 
+0000c270: 3d20 6c61 792e 4c61 796f 7574 5669 6577  = lay.LayoutView
+0000c280: 2829 0a20 2020 2020 2020 2020 2020 206c  ().            l
+0000c290: 6179 6f75 745f 7669 6577 2e6c 6f61 645f  ayout_view.load_
+0000c2a0: 6c61 796f 7574 2873 7472 2867 6473 7061  layout(str(gdspa
+0000c2b0: 7468 2e61 6273 6f6c 7574 6528 2929 290a  th.absolute())).
+0000c2c0: 2020 2020 2020 2020 2020 2020 6c61 796f              layo
+0000c2d0: 7574 5f76 6965 772e 6d61 785f 6869 6572  ut_view.max_hier
+0000c2e0: 2829 0a20 2020 2020 2020 2020 2020 206c  ().            l
+0000c2f0: 6179 6f75 745f 7669 6577 2e6c 6f61 645f  ayout_view.load_
+0000c300: 6c61 7965 725f 7072 6f70 7328 7374 7228  layer_props(str(
+0000c310: 6c79 705f 7061 7468 2929 0a0a 2020 2020  lyp_path))..    
+0000c320: 2020 2020 2020 2020 6c61 796f 7574 5f76          layout_v
+0000c330: 6965 772e 7365 745f 636f 6e66 6967 2822  iew.set_config("
+0000c340: 7465 7874 2d76 6973 6962 6c65 222c 2022  text-visible", "
+0000c350: 7472 7565 2220 6966 2073 686f 775f 6c61  true" if show_la
+0000c360: 6265 6c73 2065 6c73 6520 2266 616c 7365  bels else "false
+0000c370: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+0000c380: 7069 7865 6c5f 6275 6666 6572 203d 206c  pixel_buffer = l
+0000c390: 6179 6f75 745f 7669 6577 2e67 6574 5f70  ayout_view.get_p
+0000c3a0: 6978 656c 735f 7769 7468 5f6f 7074 696f  ixels_with_optio
+0000c3b0: 6e73 2838 3030 2c20 3630 3029 0a20 2020  ns(800, 600).   
+0000c3c0: 2020 2020 2020 2020 2070 6e67 5f64 6174           png_dat
+0000c3d0: 6120 3d20 7069 7865 6c5f 6275 6666 6572  a = pixel_buffer
+0000c3e0: 2e74 6f5f 706e 675f 6461 7461 2829 0a20  .to_png_data(). 
+0000c3f0: 2020 2020 2020 2020 2020 2069 6d61 6765             image
+0000c400: 203d 2049 6d61 6765 2876 616c 7565 3d70   = Image(value=p
+0000c410: 6e67 5f64 6174 612c 2066 6f72 6d61 743d  ng_data, format=
+0000c420: 2270 6e67 2229 0a20 2020 2020 2020 2020  "png").         
+0000c430: 2020 2064 6973 706c 6179 2869 6d61 6765     display(image
+0000c440: 290a 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+0000c450: 7420 496d 706f 7274 4572 726f 723a 0a20  t ImportError:. 
+0000c460: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000c470: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000c480: 2020 2259 6f75 2063 616e 2069 6e73 7461    "You can insta
+0000c490: 6c6c 2060 7069 7020 696e 7374 616c 6c20  ll `pip install 
+0000c4a0: 6764 7366 6163 746f 7279 5b66 756c 6c5d  gdsfactory[full]
+0000c4b0: 6020 666f 7220 6265 7474 6572 2076 6973  ` for better vis
+0000c4c0: 7561 6c69 7a61 7469 6f6e 220a 2020 2020  ualization".    
+0000c4d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000c4e0: 2020 2020 2020 636f 6d70 6f6e 656e 742e        component.
+0000c4f0: 706c 6f74 2870 6c6f 7474 6572 3d22 6d61  plot(plotter="ma
+0000c500: 7470 6c6f 746c 6962 2229 0a0a 2020 2020  tplotlib")..    
+0000c510: 6465 6620 706c 6f74 5f6a 7570 7974 6572  def plot_jupyter
+0000c520: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000c530: 2222 2253 686f 7773 2063 7572 7265 6e74  """Shows current
+0000c540: 2067 6473 2069 6e20 6b6c 6179 6f75 742e   gds in klayout.
+0000c550: 2055 7365 7320 4b77 6562 2069 6620 7365   Uses Kweb if se
+0000c560: 7276 6572 2072 756e 6e69 6e67 2e0a 0a20  rver running... 
+0000c570: 2020 2020 2020 2069 6620 6e6f 7420 7472         if not tr
+0000c580: 6965 7320 7573 696e 6720 4b6c 6179 6f75  ies using Klayou
+0000c590: 7420 7769 6467 6574 2061 6e64 2066 696e  t widget and fin
+0000c5a0: 616c 6c79 2064 6566 6175 6c74 7320 746f  ally defaults to
+0000c5b0: 206d 6174 706c 6f74 6c69 622e 0a20 2020   matplotlib..   
+0000c5c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000c5d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000c5e0: 2020 696d 706f 7274 206f 730a 2020 2020    import os.    
+0000c5f0: 2020 2020 2020 2020 6672 6f6d 2067 6473          from gds
+0000c600: 6661 6374 6f72 792e 636f 6e66 6967 2069  factory.config i
+0000c610: 6d70 6f72 7420 5041 5448 0a20 2020 2020  mport PATH.     
+0000c620: 2020 2020 2020 2066 726f 6d20 6764 7366         from gdsf
+0000c630: 6163 746f 7279 2e70 646b 2069 6d70 6f72  actory.pdk impor
+0000c640: 7420 6765 745f 6c61 7965 725f 7669 6577  t get_layer_view
+0000c650: 730a 2020 2020 2020 2020 2020 2020 6672  s.            fr
+0000c660: 6f6d 2049 5079 7468 6f6e 2e64 6973 706c  om IPython.displ
+0000c670: 6179 2069 6d70 6f72 7420 4946 7261 6d65  ay import IFrame
+0000c680: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0000c690: 6f72 7420 6b77 6562 2e73 6572 7665 725f  ort kweb.server_
+0000c6a0: 6a75 7079 7465 7220 6173 206b 6a0a 2020  jupyter as kj.  
+0000c6b0: 2020 2020 2020 2020 2020 6672 6f6d 2068            from h
+0000c6c0: 746d 6c20 696d 706f 7274 2065 7363 6170  tml import escap
+0000c6d0: 650a 0a20 2020 2020 2020 2020 2020 2067  e..            g
+0000c6e0: 6473 7061 7468 203d 2073 656c 662e 7772  dspath = self.wr
+0000c6f0: 6974 655f 6764 7328 6764 7364 6972 3d50  ite_gds(gdsdir=P
+0000c700: 4154 482e 6764 736c 6962 202f 2022 6578  ATH.gdslib / "ex
+0000c710: 7472 6122 2c20 6c6f 6767 696e 673d 4661  tra", logging=Fa
+0000c720: 6c73 6529 0a0a 2020 2020 2020 2020 2020  lse)..          
+0000c730: 2020 6469 7270 6174 6820 3d20 4744 5344    dirpath = GDSD
+0000c740: 4952 5f54 454d 500a 2020 2020 2020 2020  IR_TEMP.        
+0000c750: 2020 2020 6469 7270 6174 682e 6d6b 6469      dirpath.mkdi
+0000c760: 7228 6578 6973 745f 6f6b 3d54 7275 652c  r(exist_ok=True,
+0000c770: 2070 6172 656e 7473 3d54 7275 6529 0a20   parents=True). 
+0000c780: 2020 2020 2020 2020 2020 206c 7970 5f70             lyp_p
+0000c790: 6174 6820 3d20 6469 7270 6174 6820 2f20  ath = dirpath / 
+0000c7a0: 226c 6179 6572 732e 6c79 7022 0a0a 2020  "layers.lyp"..  
+0000c7b0: 2020 2020 2020 2020 2020 6c61 7965 725f            layer_
+0000c7c0: 7072 6f70 7320 3d20 6765 745f 6c61 7965  props = get_laye
+0000c7d0: 725f 7669 6577 7328 290a 2020 2020 2020  r_views().      
+0000c7e0: 2020 2020 2020 6c61 7965 725f 7072 6f70        layer_prop
+0000c7f0: 732e 746f 5f6c 7970 2866 696c 6570 6174  s.to_lyp(filepat
+0000c800: 683d 6c79 705f 7061 7468 290a 0a20 2020  h=lyp_path)..   
+0000c810: 2020 2020 2020 2020 2070 6f72 7420 3d20           port = 
+0000c820: 6b6a 2e70 6f72 7420 6966 2068 6173 6174  kj.port if hasat
+0000c830: 7472 286b 6a2c 2022 706f 7274 2229 2065  tr(kj, "port") e
+0000c840: 6c73 6520 3830 3030 0a0a 2020 2020 2020  lse 8000..      
+0000c850: 2020 2020 2020 7372 6320 3d20 6622 6874        src = f"ht
+0000c860: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a7b  tp://127.0.0.1:{
+0000c870: 706f 7274 7d2f 6764 733f 6764 735f 6669  port}/gds?gds_fi
+0000c880: 6c65 3d7b 6573 6361 7065 2873 7472 2867  le={escape(str(g
+0000c890: 6473 7061 7468 2929 7d26 6c61 7965 725f  dspath))}&layer_
+0000c8a0: 7072 6f70 733d 7b65 7363 6170 6528 7374  props={escape(st
+0000c8b0: 7228 6c79 705f 7061 7468 2929 7d22 0a20  r(lyp_path))}". 
+0000c8c0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000c8d0: 722e 6465 6275 6728 7372 6329 0a0a 2020  r.debug(src)..  
+0000c8e0: 2020 2020 2020 2020 2020 6966 206b 6a2e            if kj.
+0000c8f0: 6a75 7079 7465 725f 7365 7276 6572 2061  jupyter_server a
+0000c900: 6e64 206e 6f74 206f 732e 656e 7669 726f  nd not os.enviro
+0000c910: 6e2e 6765 7428 2244 4f43 5322 2c20 4661  n.get("DOCS", Fa
+0000c920: 6c73 6529 3a0a 2020 2020 2020 2020 2020  lse):.          
+0000c930: 2020 2020 2020 7265 7475 726e 2049 4672        return IFr
+0000c940: 616d 6528 0a20 2020 2020 2020 2020 2020  ame(.           
+0000c950: 2020 2020 2020 2020 2073 7263 3d73 7263           src=src
+0000c960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c970: 2020 2020 2020 7769 6474 683d 3134 3030        width=1400
+0000c980: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c990: 2020 2020 2020 6865 6967 6874 3d36 3030        height=600
+0000c9a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c9b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000c9c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000c9d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000c9e0: 662e 706c 6f74 5f6b 6c61 796f 7574 2829  f.plot_klayout()
+0000c9f0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000ca00: 496d 706f 7274 4572 726f 723a 0a20 2020  ImportError:.   
+0000ca10: 2020 2020 2020 2020 2070 7269 6e74 280a           print(.
+0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca30: 2259 6f75 2063 616e 2069 6e73 7461 6c6c  "You can install
+0000ca40: 2060 7069 7020 696e 7374 616c 6c20 6764   `pip install gd
+0000ca50: 7366 6163 746f 7279 5b66 756c 6c5d 6020  sfactory[full]` 
+0000ca60: 666f 7220 6265 7474 6572 2076 6973 7561  for better visua
+0000ca70: 6c69 7a61 7469 6f6e 220a 2020 2020 2020  lization".      
+0000ca80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000ca90: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000caa0: 706c 6f74 5f6b 6c61 796f 7574 2829 0a0a  plot_klayout()..
+0000cab0: 2020 2020 6465 6620 706c 6f74 5f6d 6174      def plot_mat
+0000cac0: 706c 6f74 6c69 6228 7365 6c66 2c20 2a2a  plotlib(self, **
+0000cad0: 6b77 6172 6773 2920 2d3e 204e 6f6e 653a  kwargs) -> None:
+0000cae0: 0a20 2020 2020 2020 2022 2222 506c 6f74  .        """Plot
+0000caf0: 2063 6f6d 706f 6e65 6e74 2075 7369 6e67   component using
+0000cb00: 206d 6174 706c 6f74 6c69 622e 0a0a 2020   matplotlib...  
+0000cb10: 2020 2020 2020 4b65 7977 6f72 6420 4172        Keyword Ar
+0000cb20: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0000cb30: 7368 6f77 5f70 6f72 7473 3a20 5365 7473  show_ports: Sets
+0000cb40: 2077 6865 7468 6572 2070 6f72 7473 2061   whether ports a
+0000cb50: 7265 2064 7261 776e 2e0a 2020 2020 2020  re drawn..      
+0000cb60: 2020 2020 2020 7368 6f77 5f73 7562 706f        show_subpo
+0000cb70: 7274 733a 2053 6574 7320 7768 6574 6865  rts: Sets whethe
+0000cb80: 7220 7375 6270 6f72 7473 2028 706f 7274  r subports (port
+0000cb90: 7320 7468 6174 2062 656c 6f6e 6720 746f  s that belong to
+0000cba0: 2072 6566 6572 656e 6365 7329 2061 7265   references) are
+0000cbb0: 2064 7261 776e 2e0a 2020 2020 2020 2020   drawn..        
+0000cbc0: 2020 2020 6c61 6265 6c5f 616c 6961 7365      label_aliase
+0000cbd0: 733a 2053 6574 7320 7768 6574 6865 7220  s: Sets whether 
+0000cbe0: 616c 6961 7365 7320 6172 6520 6c61 6265  aliases are labe
+0000cbf0: 6c65 6420 7769 7468 2061 2074 6578 7420  led with a text 
+0000cc00: 6e61 6d65 2e0a 2020 2020 2020 2020 2020  name..          
+0000cc10: 2020 6e65 775f 7769 6e64 6f77 3a20 4966    new_window: If
+0000cc20: 2054 7275 652c 2065 6163 6820 6361 6c6c   True, each call
+0000cc30: 2074 6f20 7175 6963 6b70 6c6f 7428 2920   to quickplot() 
+0000cc40: 7769 6c6c 2067 656e 6572 6174 6520 6120  will generate a 
+0000cc50: 7365 7061 7261 7465 2077 696e 646f 772e  separate window.
+0000cc60: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
+0000cc70: 636b 696e 673a 2049 6620 5472 7565 2c20  cking: If True, 
+0000cc80: 6361 6c6c 696e 6720 7175 6963 6b70 6c6f  calling quickplo
+0000cc90: 7428 2920 7769 6c6c 2070 6175 7365 2065  t() will pause e
+0000cca0: 7865 6375 7469 6f6e 206f 6620 2822 626c  xecution of ("bl
+0000ccb0: 6f63 6b22 2920 7468 650a 2020 2020 2020  ock") the.      
+0000ccc0: 2020 2020 2020 2020 2020 7265 6d61 696e            remain
+0000ccd0: 6465 7220 6f66 2074 6865 2070 7974 686f  der of the pytho
+0000cce0: 6e20 636f 6465 2075 6e74 696c 2074 6865  n code until the
+0000ccf0: 2071 7569 636b 706c 6f74 2829 2077 696e   quickplot() win
+0000cd00: 646f 7720 6973 2063 6c6f 7365 642e 0a20  dow is closed.. 
+0000cd10: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+0000cd20: 6620 4661 6c73 652c 2074 6865 2077 696e  f False, the win
+0000cd30: 646f 7720 7769 6c6c 2062 6520 6f70 656e  dow will be open
+0000cd40: 6564 2061 6e64 2063 6f64 6520 7769 6c6c  ed and code will
+0000cd50: 2063 6f6e 7469 6e75 6520 746f 2072 756e   continue to run
+0000cd60: 2e0a 2020 2020 2020 2020 2020 2020 7a6f  ..            zo
+0000cd70: 6f6d 5f66 6163 746f 723a 2053 6574 7320  om_factor: Sets 
+0000cd80: 7468 6520 7363 616c 696e 6720 6661 6374  the scaling fact
+0000cd90: 6f72 2077 6865 6e20 7a6f 6f6d 696e 6720  or when zooming 
+0000cda0: 7468 6520 7175 6963 6b70 6c6f 7420 7769  the quickplot wi
+0000cdb0: 6e64 6f77 2077 6974 6820 7468 650a 2020  ndow with the.  
+0000cdc0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0000cdd0: 7573 6577 6865 656c 2f74 7261 636b 7061  usewheel/trackpa
+0000cde0: 642e 0a20 2020 2020 2020 2020 2020 2069  d..            i
+0000cdf0: 6e74 6572 6163 7469 7665 5f7a 6f6f 6d3a  nteractive_zoom:
+0000ce00: 2045 6e61 626c 6573 2075 7369 6e67 206d   Enables using m
+0000ce10: 6f75 7365 7768 6565 6c2f 7472 6163 6b70  ousewheel/trackp
+0000ce20: 6164 2074 6f20 7a6f 6f6d 2e0a 2020 2020  ad to zoom..    
+0000ce30: 2020 2020 2020 2020 666f 6e74 7369 7a65          fontsize
+0000ce40: 3a20 666f 7220 6c61 6265 6c73 2e0a 2020  : for labels..  
+0000ce50: 2020 2020 2020 2020 2020 6c61 7965 7273            layers
+0000ce60: 5f65 7863 6c75 6465 643a 206c 6973 7420  _excluded: list 
+0000ce70: 6f66 206c 6179 6572 7320 746f 2065 7863  of layers to exc
+0000ce80: 6c75 6465 2e0a 2020 2020 2020 2020 2020  lude..          
+0000ce90: 2020 6c61 7965 725f 7669 6577 733a 206c    layer_views: l
+0000cea0: 6179 6572 5f76 6965 7773 2063 6f6c 6f72  ayer_views color
+0000ceb0: 7320 6c6f 6164 6564 2066 726f 6d20 4b6c  s loaded from Kl
+0000cec0: 6179 6f75 742e 0a20 2020 2020 2020 2020  ayout..         
+0000ced0: 2020 206d 696e 5f61 7370 6563 743a 206d     min_aspect: m
+0000cee0: 696e 696d 756d 2061 7370 6563 7420 7261  inimum aspect ra
+0000cef0: 7469 6f2e 0a20 2020 2020 2020 2022 2222  tio..        """
+0000cf00: 0a20 2020 2020 2020 2066 726f 6d20 6764  .        from gd
+0000cf10: 7366 6163 746f 7279 2e71 7569 636b 706c  sfactory.quickpl
+0000cf20: 6f74 7465 7220 696d 706f 7274 2071 7569  otter import qui
+0000cf30: 636b 706c 6f74 0a0a 2020 2020 2020 2020  ckplot..        
+0000cf40: 7175 6963 6b70 6c6f 7428 7365 6c66 2c20  quickplot(self, 
+0000cf50: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+0000cf60: 6566 2070 6c6f 7428 7365 6c66 2c20 706c  ef plot(self, pl
+0000cf70: 6f74 7465 723a 204f 7074 696f 6e61 6c5b  otter: Optional[
+0000cf80: 506c 6f74 7465 725d 203d 204e 6f6e 652c  Plotter] = None,
+0000cf90: 202a 2a6b 7761 7267 7329 202d 3e20 4e6f   **kwargs) -> No
+0000cfa0: 6e65 3a0a 2020 2020 2020 2020 2222 2252  ne:.        """R
+0000cfb0: 6574 7572 6e73 2063 6f6d 706f 6e65 6e74  eturns component
+0000cfc0: 2070 6c6f 7420 7573 696e 6720 6b6c 6179   plot using klay
+0000cfd0: 6f75 742c 206d 6174 706c 6f74 6c69 622c  out, matplotlib,
+0000cfe0: 2068 6f6c 6f76 6965 7773 206f 7220 7174   holoviews or qt
+0000cff0: 2e0a 0a20 2020 2020 2020 2057 6520 7265  ...        We re
+0000d000: 636f 6d6d 656e 6420 7573 696e 6720 6b6c  commend using kl
+0000d010: 6179 6f75 742e 0a0a 2020 2020 2020 2020  ayout...        
+0000d020: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+0000d030: 2020 706c 6f74 7465 723a 2070 6c6f 7420    plotter: plot 
+0000d040: 6261 636b 656e 6420 2827 686f 6c6f 7669  backend ('holovi
+0000d050: 6577 7327 2c20 276d 6174 706c 6f74 6c69  ews', 'matplotli
+0000d060: 6227 2c20 2771 7427 2c20 276b 6c61 796f  b', 'qt', 'klayo
+0000d070: 7574 2729 2e0a 2020 2020 2020 2020 2222  ut')..        ""
+0000d080: 220a 2020 2020 2020 2020 706c 6f74 7465  ".        plotte
+0000d090: 7220 3d20 706c 6f74 7465 7220 6f72 2043  r = plotter or C
+0000d0a0: 4f4e 462e 6765 7428 2270 6c6f 7474 6572  ONF.get("plotter
+0000d0b0: 222c 2022 6d61 7470 6c6f 746c 6962 2229  ", "matplotlib")
+0000d0c0: 0a0a 2020 2020 2020 2020 6966 2070 6c6f  ..        if plo
+0000d0d0: 7474 6572 203d 3d20 226b 6c61 796f 7574  tter == "klayout
+0000d0e0: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+0000d0f0: 656c 662e 706c 6f74 5f6b 6c61 796f 7574  elf.plot_klayout
+0000d100: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
+0000d110: 6574 7572 6e0a 0a20 2020 2020 2020 2065  eturn..        e
+0000d120: 6c69 6620 706c 6f74 7465 7220 3d3d 2022  lif plotter == "
+0000d130: 6d61 7470 6c6f 746c 6962 223a 0a20 2020  matplotlib":.   
+0000d140: 2020 2020 2020 2020 2066 726f 6d20 6764           from gd
+0000d150: 7366 6163 746f 7279 2e71 7569 636b 706c  sfactory.quickpl
+0000d160: 6f74 7465 7220 696d 706f 7274 2071 7569  otter import qui
+0000d170: 636b 706c 6f74 0a0a 2020 2020 2020 2020  ckplot..        
+0000d180: 2020 2020 7175 6963 6b70 6c6f 7428 7365      quickplot(se
+0000d190: 6c66 2c20 2a2a 6b77 6172 6773 290a 2020  lf, **kwargs).  
+0000d1a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000d1b0: 0a0a 2020 2020 2020 2020 656c 6966 2070  ..        elif p
+0000d1c0: 6c6f 7474 6572 203d 3d20 2268 6f6c 6f76  lotter == "holov
+0000d1d0: 6965 7773 223a 0a20 2020 2020 2020 2020  iews":.         
+0000d1e0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000d1f0: 2020 2020 2020 2020 696d 706f 7274 2068          import h
+0000d200: 6f6c 6f76 6965 7773 2061 7320 6876 0a0a  oloviews as hv..
+0000d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d220: 6876 2e65 7874 656e 7369 6f6e 2822 626f  hv.extension("bo
+0000d230: 6b65 6822 290a 2020 2020 2020 2020 2020  keh").          
+0000d240: 2020 6578 6365 7074 2049 6d70 6f72 7445    except ImportE
+0000d250: 7272 6f72 2061 7320 653a 0a20 2020 2020  rror as e:.     
+0000d260: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000d270: 2822 796f 7520 6e65 6564 2074 6f20 6070  ("you need to `p
+0000d280: 6970 2069 6e73 7461 6c6c 2068 6f6c 6f76  ip install holov
+0000d290: 6965 7773 6022 290a 2020 2020 2020 2020  iews`").        
+0000d2a0: 2020 2020 2020 2020 7261 6973 6520 650a          raise e.
+0000d2b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000d2c0: 726e 2073 656c 662e 706c 6f74 5f68 6f6c  rn self.plot_hol
+0000d2d0: 6f76 6965 7773 282a 2a6b 7761 7267 7329  oviews(**kwargs)
+0000d2e0: 0a0a 2020 2020 2020 2020 656c 6966 2070  ..        elif p
+0000d2f0: 6c6f 7474 6572 203d 3d20 2271 7422 3a0a  lotter == "qt":.
+0000d300: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0000d310: 2067 6473 6661 6374 6f72 792e 7175 6963   gdsfactory.quic
+0000d320: 6b70 6c6f 7474 6572 2069 6d70 6f72 7420  kplotter import 
+0000d330: 7175 6963 6b70 6c6f 7432 0a0a 2020 2020  quickplot2..    
+0000d340: 2020 2020 2020 2020 7175 6963 6b70 6c6f          quickplo
+0000d350: 7432 2873 656c 6629 0a20 2020 2020 2020  t2(self).       
+0000d360: 2020 2020 2072 6574 7572 6e0a 2020 2020       return.    
+0000d370: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000d380: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000d390: 6545 7272 6f72 2866 227b 706c 6f74 7465  eError(f"{plotte
+0000d3a0: 7221 727d 206e 6f74 2069 6e20 7b50 6c6f  r!r} not in {Plo
+0000d3b0: 7474 6572 7d22 290a 0a20 2020 2064 6566  tter}")..    def
+0000d3c0: 2070 6c6f 745f 686f 6c6f 7669 6577 7328   plot_holoviews(
+0000d3d0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000d3e0: 2020 2020 2020 206c 6179 6572 735f 6578         layers_ex
+0000d3f0: 636c 7564 6564 3a20 4f70 7469 6f6e 616c  cluded: Optional
+0000d400: 5b4c 6179 6572 735d 203d 204e 6f6e 652c  [Layers] = None,
+0000d410: 0a20 2020 2020 2020 206c 6179 6572 5f76  .        layer_v
+0000d420: 6965 7773 3a20 4f70 7469 6f6e 616c 5b4c  iews: Optional[L
+0000d430: 6179 6572 5669 6577 735d 203d 204e 6f6e  ayerViews] = Non
+0000d440: 652c 0a20 2020 2020 2020 206d 696e 5f61  e,.        min_a
+0000d450: 7370 6563 743a 2066 6c6f 6174 203d 2030  spect: float = 0
+0000d460: 2e32 352c 0a20 2020 2020 2020 2070 6164  .25,.        pad
+0000d470: 6469 6e67 3a20 666c 6f61 7420 3d20 302e  ding: float = 0.
+0000d480: 352c 0a20 2020 2029 3a0a 2020 2020 2020  5,.    ):.      
+0000d490: 2020 2222 2250 6c6f 7420 636f 6d70 6f6e    """Plot compon
+0000d4a0: 656e 7420 696e 2068 6f6c 6f76 6965 7773  ent in holoviews
+0000d4b0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+0000d4c0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+0000d4d0: 6572 735f 6578 636c 7564 6564 3a20 6c69  ers_excluded: li
+0000d4e0: 7374 206f 6620 6c61 7965 7273 2074 6f20  st of layers to 
+0000d4f0: 6578 636c 7564 652e 0a20 2020 2020 2020  exclude..       
+0000d500: 2020 2020 206c 6179 6572 5f76 6965 7773       layer_views
+0000d510: 3a20 6c61 7965 725f 7669 6577 7320 636f  : layer_views co
+0000d520: 6c6f 7273 206c 6f61 6465 6420 6672 6f6d  lors loaded from
+0000d530: 204b 6c61 796f 7574 2e0a 2020 2020 2020   Klayout..      
+0000d540: 2020 2020 2020 6d69 6e5f 6173 7065 6374        min_aspect
+0000d550: 3a20 6d69 6e69 6d75 6d20 6173 7065 6374  : minimum aspect
+0000d560: 2072 6174 696f 2e0a 2020 2020 2020 2020   ratio..        
+0000d570: 2020 2020 7061 6464 696e 673a 2061 726f      padding: aro
+0000d580: 756e 6420 626f 756e 6469 6e67 2062 6f78  und bounding box
+0000d590: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000d5a0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0000d5b0: 486f 6c6f 7669 6577 7320 4f76 6572 6c61  Holoviews Overla
+0000d5c0: 7920 746f 2064 6973 706c 6179 2061 6c6c  y to display all
+0000d5d0: 2070 6f6c 7967 6f6e 732e 0a20 2020 2020   polygons..     
+0000d5e0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0000d5f0: 726f 6d20 6764 7366 6163 746f 7279 2e61  rom gdsfactory.a
+0000d600: 6464 5f70 696e 7320 696d 706f 7274 2067  dd_pins import g
+0000d610: 6574 5f70 696e 5f74 7269 616e 676c 655f  et_pin_triangle_
+0000d620: 706f 6c79 676f 6e5f 7469 700a 2020 2020  polygon_tip.    
+0000d630: 2020 2020 6672 6f6d 2067 6473 6661 6374      from gdsfact
+0000d640: 6f72 792e 6765 6e65 7269 635f 7465 6368  ory.generic_tech
+0000d650: 2069 6d70 6f72 7420 4c41 5945 525f 5649   import LAYER_VI
+0000d660: 4557 530a 0a20 2020 2020 2020 2069 6620  EWS..        if 
+0000d670: 6c61 7965 725f 7669 6577 7320 6973 204e  layer_views is N
+0000d680: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000d690: 206c 6179 6572 5f76 6965 7773 203d 204c   layer_views = L
+0000d6a0: 4159 4552 5f56 4945 5753 0a0a 2020 2020  AYER_VIEWS..    
+0000d6b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000d6c0: 2020 2020 2069 6d70 6f72 7420 686f 6c6f       import holo
+0000d6d0: 7669 6577 7320 6173 2068 760a 0a20 2020  views as hv..   
+0000d6e0: 2020 2020 2020 2020 2068 762e 6578 7465           hv.exte
+0000d6f0: 6e73 696f 6e28 2262 6f6b 6568 2229 0a20  nsion("bokeh"). 
+0000d700: 2020 2020 2020 2065 7863 6570 7420 496d         except Im
+0000d710: 706f 7274 4572 726f 7220 6173 2065 3a0a  portError as e:.
+0000d720: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000d730: 7428 2279 6f75 206e 6565 6420 746f 2060  t("you need to `
+0000d740: 7069 7020 696e 7374 616c 6c20 686f 6c6f  pip install holo
+0000d750: 7669 6577 7360 2229 0a20 2020 2020 2020  views`").       
+0000d760: 2020 2020 2072 6169 7365 2065 0a0a 2020       raise e..  
+0000d770: 2020 2020 2020 7365 6c66 2e5f 6262 5f76        self._bb_v
+0000d780: 616c 6964 203d 2046 616c 7365 2020 2320  alid = False  # 
+0000d790: 7265 636f 6d70 7574 6520 7468 6520 626f  recompute the bo
+0000d7a0: 756e 6469 6e67 2062 6f78 0a20 2020 2020  unding box.     
+0000d7b0: 2020 2062 203d 2073 656c 662e 6262 6f78     b = self.bbox
+0000d7c0: 202b 2028 282d 7061 6464 696e 672c 202d   + ((-padding, -
+0000d7d0: 7061 6464 696e 6729 2c20 2870 6164 6469  padding), (paddi
+0000d7e0: 6e67 2c20 7061 6464 696e 6729 290a 2020  ng, padding)).  
+0000d7f0: 2020 2020 2020 6220 3d20 6e70 2e61 7272        b = np.arr
+0000d800: 6179 2862 2e66 6c61 7429 0a20 2020 2020  ay(b.flat).     
+0000d810: 2020 2063 656e 7465 7220 3d20 6e70 2e61     center = np.a
+0000d820: 7272 6179 2828 6e70 2e73 756d 2862 5b3a  rray((np.sum(b[:
+0000d830: 3a32 5d29 202f 2032 2c20 6e70 2e73 756d  :2]) / 2, np.sum
+0000d840: 2862 5b31 3a3a 325d 2920 2f20 3229 290a  (b[1::2]) / 2)).
+0000d850: 2020 2020 2020 2020 7369 7a65 203d 206e          size = n
+0000d860: 702e 6172 7261 7928 286e 702e 6162 7328  p.array((np.abs(
+0000d870: 625b 325d 202d 2062 5b30 5d29 2c20 6e70  b[2] - b[0]), np
+0000d880: 2e61 6273 2862 5b33 5d20 2d20 625b 315d  .abs(b[3] - b[1]
+0000d890: 2929 290a 2020 2020 2020 2020 6478 203d  ))).        dx =
+0000d8a0: 206e 702e 6172 7261 7928 0a20 2020 2020   np.array(.     
+0000d8b0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0000d8c0: 2020 2020 2020 2020 206e 702e 6d61 7869           np.maxi
+0000d8d0: 6d75 6d28 6d69 6e5f 6173 7065 6374 202a  mum(min_aspect *
+0000d8e0: 2073 697a 655b 315d 2c20 7369 7a65 5b30   size[1], size[0
+0000d8f0: 5d29 202f 2032 2c0a 2020 2020 2020 2020  ]) / 2,.        
+0000d900: 2020 2020 2020 2020 6e70 2e6d 6178 696d          np.maxim
+0000d910: 756d 2873 697a 655b 315d 2c20 6d69 6e5f  um(size[1], min_
+0000d920: 6173 7065 6374 202a 2073 697a 655b 305d  aspect * size[0]
+0000d930: 2920 2f20 322c 0a20 2020 2020 2020 2020  ) / 2,.         
+0000d940: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
+0000d950: 2020 2020 2020 2062 203d 206e 702e 6873         b = np.hs
+0000d960: 7461 636b 2828 6365 6e74 6572 202d 2064  tack((center - d
+0000d970: 782c 2063 656e 7465 7220 2b20 6478 2929  x, center + dx))
+0000d980: 0a0a 2020 2020 2020 2020 706c 6f74 735f  ..        plots_
+0000d990: 746f 5f6f 7665 726c 6179 203d 205b 5d0a  to_overlay = [].
+0000d9a0: 2020 2020 2020 2020 6c61 7965 7273 5f65          layers_e
+0000d9b0: 7863 6c75 6465 6420 3d20 5b5d 2069 6620  xcluded = [] if 
+0000d9c0: 6c61 7965 7273 5f65 7863 6c75 6465 6420  layers_excluded 
+0000d9d0: 6973 204e 6f6e 6520 656c 7365 206c 6179  is None else lay
+0000d9e0: 6572 735f 6578 636c 7564 6564 0a0a 2020  ers_excluded..  
+0000d9f0: 2020 2020 2020 666f 7220 6c61 7965 722c        for layer,
+0000da00: 2070 6f6c 7967 6f6e 2069 6e20 7365 6c66   polygon in self
+0000da10: 2e67 6574 5f70 6f6c 7967 6f6e 7328 6279  .get_polygons(by
+0000da20: 5f73 7065 633d 5472 7565 292e 6974 656d  _spec=True).item
+0000da30: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0000da40: 2069 6620 6c61 7965 7220 696e 206c 6179   if layer in lay
+0000da50: 6572 735f 6578 636c 7564 6564 3a0a 2020  ers_excluded:.  
+0000da60: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000da70: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+0000da80: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000da90: 2020 2020 2020 2020 206c 6179 6572 5f76           layer_v
+0000daa0: 6965 7720 3d20 6c61 7965 725f 7669 6577  iew = layer_view
+0000dab0: 732e 6765 745f 6672 6f6d 5f74 7570 6c65  s.get_from_tuple
+0000dac0: 286c 6179 6572 290a 2020 2020 2020 2020  (layer).        
+0000dad0: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+0000dae0: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+0000daf0: 2020 2020 2020 206c 6179 6572 7320 3d20         layers = 
+0000db00: 6c69 7374 286c 6179 6572 5f76 6965 7773  list(layer_views
+0000db10: 2e67 6574 5f6c 6179 6572 5f76 6965 7773  .get_layer_views
+0000db20: 2829 2e6b 6579 7328 2929 0a20 2020 2020  ().keys()).     
+0000db30: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+0000db40: 6e67 732e 7761 726e 2866 227b 6c61 7965  ngs.warn(f"{laye
+0000db50: 7221 727d 206e 6f74 2064 6566 696e 6564  r!r} not defined
+0000db60: 2069 6e20 7b6c 6179 6572 737d 222c 2073   in {layers}", s
+0000db70: 7461 636b 6c65 7665 6c3d 3329 0a20 2020  tacklevel=3).   
+0000db80: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0000db90: 6572 5f76 6965 7720 3d20 4c61 7965 7256  er_view = LayerV
+0000dba0: 6965 7728 6c61 7965 723d 6c61 7965 7229  iew(layer=layer)
+0000dbb0: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+0000dbc0: 4f44 4f3a 204d 6174 6368 2075 7020 6f70  ODO: Match up op
+0000dbd0: 7469 6f6e 7320 7769 7468 204c 6179 6572  tions with Layer
+0000dbe0: 5669 6577 730a 2020 2020 2020 2020 2020  Views.          
+0000dbf0: 2020 706c 6f74 735f 746f 5f6f 7665 726c    plots_to_overl
+0000dc00: 6179 2e61 7070 656e 6428 0a20 2020 2020  ay.append(.     
+0000dc10: 2020 2020 2020 2020 2020 2068 762e 506f             hv.Po
+0000dc20: 6c79 676f 6e73 2870 6f6c 7967 6f6e 2c20  lygons(polygon, 
+0000dc30: 6c61 6265 6c3d 7374 7228 6c61 7965 725f  label=str(layer_
+0000dc40: 7669 6577 2e6e 616d 6529 292e 6f70 7473  view.name)).opts
+0000dc50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000dc60: 2020 2020 2020 6461 7461 5f61 7370 6563        data_aspec
+0000dc70: 743d 312c 0a20 2020 2020 2020 2020 2020  t=1,.           
+0000dc80: 2020 2020 2020 2020 2066 7261 6d65 5f77           frame_w
+0000dc90: 6964 7468 3d35 3030 2c0a 2020 2020 2020  idth=500,.      
+0000dca0: 2020 2020 2020 2020 2020 2020 2020 796c                yl
+0000dcb0: 696d 3d28 625b 315d 2c20 625b 335d 292c  im=(b[1], b[3]),
+0000dcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dcd0: 2020 2020 2078 6c69 6d3d 2862 5b30 5d2c       xlim=(b[0],
+0000dce0: 2062 5b32 5d29 2c0a 2020 2020 2020 2020   b[2]),.        
+0000dcf0: 2020 2020 2020 2020 2020 2020 6669 6c6c              fill
+0000dd00: 5f63 6f6c 6f72 3d6c 6179 6572 5f76 6965  _color=layer_vie
+0000dd10: 772e 6669 6c6c 5f63 6f6c 6f72 2e61 735f  w.fill_color.as_
+0000dd20: 7267 6228 2920 6f72 2022 222c 0a20 2020  rgb() or "",.   
+0000dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd40: 206c 696e 655f 636f 6c6f 723d 6c61 7965   line_color=laye
+0000dd50: 725f 7669 6577 2e66 7261 6d65 5f63 6f6c  r_view.frame_col
+0000dd60: 6f72 2e61 735f 7267 6228 2920 6f72 2022  or.as_rgb() or "
+0000dd70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000dd80: 2020 2020 2020 2066 696c 6c5f 616c 7068         fill_alph
+0000dd90: 613d 6c61 7965 725f 7669 6577 2e67 6574  a=layer_view.get
+0000dda0: 5f61 6c70 6861 2829 206f 7220 2222 2c0a  _alpha() or "",.
+0000ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ddc0: 2020 2020 6c69 6e65 5f61 6c70 6861 3d6c      line_alpha=l
+0000ddd0: 6179 6572 5f76 6965 772e 6765 745f 616c  ayer_view.get_al
+0000dde0: 7068 6128 2920 6f72 2022 222c 0a20 2020  pha() or "",.   
+0000ddf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de00: 2074 6f6f 6c73 3d5b 2268 6f76 6572 225d   tools=["hover"]
+0000de10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000de20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000de30: 290a 2020 2020 2020 2020 666f 7220 6e61  ).        for na
+0000de40: 6d65 2c20 706f 7274 2069 6e20 7365 6c66  me, port in self
+0000de50: 2e70 6f72 7473 2e69 7465 6d73 2829 3a0a  .ports.items():.
+0000de60: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0000de70: 203d 2073 7472 286e 616d 6529 0a20 2020   = str(name).   
+0000de80: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
+0000de90: 2c20 7074 6970 203d 2067 6574 5f70 696e  , ptip = get_pin
+0000dea0: 5f74 7269 616e 676c 655f 706f 6c79 676f  _triangle_polygo
+0000deb0: 6e5f 7469 7028 706f 7274 3d70 6f72 7429  n_tip(port=port)
+0000dec0: 0a0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+0000ded0: 6f74 735f 746f 5f6f 7665 726c 6179 2e61  ots_to_overlay.a
+0000dee0: 7070 656e 6428 0a20 2020 2020 2020 2020  ppend(.         
+0000def0: 2020 2020 2020 2068 762e 506f 6c79 676f         hv.Polygo
+0000df00: 6e73 2870 6f6c 7967 6f6e 2c20 6c61 6265  ns(polygon, labe
+0000df10: 6c3d 6e61 6d65 292e 6f70 7473 280a 2020  l=name).opts(.  
+0000df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df30: 2020 6461 7461 5f61 7370 6563 743d 312c    data_aspect=1,
+0000df40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000df50: 2020 2020 2066 7261 6d65 5f77 6964 7468       frame_width
+0000df60: 3d35 3030 2c0a 2020 2020 2020 2020 2020  =500,.          
+0000df70: 2020 2020 2020 2020 2020 6669 6c6c 5f61            fill_a
+0000df80: 6c70 6861 3d30 2c0a 2020 2020 2020 2020  lpha=0,.        
+0000df90: 2020 2020 2020 2020 2020 2020 796c 696d              ylim
+0000dfa0: 3d28 625b 315d 2c20 625b 335d 292c 0a20  =(b[1], b[3]),. 
 0000dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfc0: 2020 2020 636f 6c6f 723d 2272 6564 222c      color="red",
-0000dfd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dfe0: 2020 2020 206c 696e 655f 616c 7068 613d       line_alpha=
-0000dff0: 6c61 7965 725f 7669 6577 2e67 6574 5f61  layer_view.get_a
-0000e000: 6c70 6861 2829 206f 7220 2222 2c0a 2020  lpha() or "",.  
-0000e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e020: 2020 746f 6f6c 733d 5b22 686f 7665 7222    tools=["hover"
-0000e030: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0000e040: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000e050: 2020 2020 202a 2068 762e 5465 7874 2870       * hv.Text(p
-0000e060: 7469 705b 305d 2c20 7074 6970 5b31 5d2c  tip[0], ptip[1],
-0000e070: 206e 616d 6529 0a20 2020 2020 2020 2020   name).         
-0000e080: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0000e090: 7475 726e 2068 762e 4f76 6572 6c61 7928  turn hv.Overlay(
-0000e0a0: 706c 6f74 735f 746f 5f6f 7665 726c 6179  plots_to_overlay
-0000e0b0: 292e 6f70 7473 280a 2020 2020 2020 2020  ).opts(.        
-0000e0c0: 2020 2020 7368 6f77 5f6c 6567 656e 643d      show_legend=
-0000e0d0: 5472 7565 2c20 7368 6172 6564 5f61 7865  True, shared_axe
-0000e0e0: 733d 4661 6c73 652c 2079 6c69 6d3d 2862  s=False, ylim=(b
-0000e0f0: 5b31 5d2c 2062 5b33 5d29 2c20 786c 696d  [1], b[3]), xlim
-0000e100: 3d28 625b 305d 2c20 625b 325d 290a 2020  =(b[0], b[2]).  
-0000e110: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0000e120: 2073 686f 7728 0a20 2020 2020 2020 2073   show(.        s
-0000e130: 656c 662c 0a20 2020 2020 2020 2073 686f  elf,.        sho
-0000e140: 775f 706f 7274 733a 2062 6f6f 6c20 3d20  w_ports: bool = 
-0000e150: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
-0000e160: 686f 775f 7375 6270 6f72 7473 3a20 626f  how_subports: bo
-0000e170: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0000e180: 2020 2020 706f 7274 5f6d 6172 6b65 725f      port_marker_
-0000e190: 6c61 7965 723a 204c 6179 6572 203d 2028  layer: Layer = (
-0000e1a0: 312c 2031 3029 2c0a 2020 2020 2020 2020  1, 10),.        
-0000e1b0: 2a2a 6b77 6172 6773 2c0a 2020 2020 2920  **kwargs,.    ) 
-0000e1c0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000e1d0: 2022 2222 5368 6f77 2063 6f6d 706f 6e65   """Show compone
-0000e1e0: 6e74 2069 6e20 4b4c 6179 6f75 742e 0a0a  nt in KLayout...
-0000e1f0: 2020 2020 2020 2020 7265 7475 726e 7320          returns 
-0000e200: 6120 636f 7079 206f 6620 7468 6520 436f  a copy of the Co
-0000e210: 6d70 6f6e 656e 742c 2073 6f20 7468 6520  mponent, so the 
-0000e220: 6f72 6967 696e 616c 2063 6f6d 706f 6e65  original compone
-0000e230: 6e74 2072 656d 6169 6e73 2069 6e74 6163  nt remains intac
-0000e240: 742e 0a20 2020 2020 2020 2077 6974 6820  t..        with 
-0000e250: 7069 6e73 206d 6172 6b65 7273 206f 6e20  pins markers on 
-0000e260: 6561 6368 2070 6f72 7420 7368 6f77 5f70  each port show_p
-0000e270: 6f72 7473 203d 2054 7275 652c 2061 6e64  orts = True, and
-0000e280: 206f 7074 696f 6e61 6c6c 7920 616c 736f   optionally also
-0000e290: 0a20 2020 2020 2020 2074 6865 2070 6f72  .        the por
-0000e2a0: 7473 2066 726f 6d20 7468 6520 7265 6665  ts from the refe
-0000e2b0: 7265 6e63 6573 2028 7368 6f77 5f73 7562  rences (show_sub
-0000e2c0: 706f 7274 733d 5472 7565 290a 0a20 2020  ports=True)..   
-0000e2d0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-0000e2e0: 2020 2020 2020 2073 686f 775f 706f 7274         show_port
-0000e2f0: 733a 2073 686f 7773 2063 6f6d 706f 6e65  s: shows compone
-0000e300: 6e74 2077 6974 6820 706f 7274 206d 6172  nt with port mar
-0000e310: 6b65 7273 2061 6e64 206c 6162 656c 732e  kers and labels.
-0000e320: 0a20 2020 2020 2020 2020 2020 2073 686f  .            sho
-0000e330: 775f 7375 6270 6f72 7473 3a20 6164 6420  w_subports: add 
-0000e340: 706f 7274 7320 6d61 726b 6572 7320 616e  ports markers an
-0000e350: 6420 6c61 6265 6c73 2074 6f20 7265 6665  d labels to refe
-0000e360: 7265 6e63 6573 2e0a 2020 2020 2020 2020  rences..        
-0000e370: 2020 2020 706f 7274 5f6d 6172 6b65 725f      port_marker_
-0000e380: 6c61 7965 723a 2066 6f72 2074 6865 2070  layer: for the p
-0000e390: 6f72 7473 2e0a 0a20 2020 2020 2020 204b  orts...        K
-0000e3a0: 6579 776f 7264 2041 7267 733a 0a20 2020  eyword Args:.   
-0000e3b0: 2020 2020 2020 2020 2067 6473 7061 7468           gdspath
-0000e3c0: 3a20 4744 5320 6669 6c65 2070 6174 6820  : GDS file path 
-0000e3d0: 746f 2077 7269 7465 2074 6f2e 0a20 2020  to write to..   
-0000e3e0: 2020 2020 2020 2020 2067 6473 6469 723a           gdsdir:
-0000e3f0: 2064 6972 6563 746f 7279 2066 6f72 2074   directory for t
-0000e400: 6865 2047 4453 2066 696c 652e 2044 6566  he GDS file. Def
-0000e410: 6175 6c74 7320 746f 202f 746d 702f 2e0a  aults to /tmp/..
-0000e420: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0000e430: 3a20 756e 6974 2073 697a 6520 666f 7220  : unit size for 
-0000e440: 6f62 6a65 6374 7320 696e 206c 6962 7261  objects in libra
-0000e450: 7279 2e20 3175 6d20 6279 2064 6566 6175  ry. 1um by defau
-0000e460: 6c74 2e0a 2020 2020 2020 2020 2020 2020  lt..            
-0000e470: 7072 6563 6973 696f 6e3a 2066 6f72 206f  precision: for o
-0000e480: 626a 6563 7420 6469 6d65 6e73 696f 6e73  bject dimensions
-0000e490: 2069 6e20 7468 6520 6c69 6272 6172 7920   in the library 
-0000e4a0: 286d 292e 2031 6e6d 2062 7920 6465 6661  (m). 1nm by defa
-0000e4b0: 756c 742e 0a20 2020 2020 2020 2020 2020  ult..           
-0000e4c0: 2074 696d 6573 7461 6d70 3a20 4465 6661   timestamp: Defa
-0000e4d0: 756c 7473 2074 6f20 3230 3139 2d31 302d  ults to 2019-10-
-0000e4e0: 3235 2e20 4966 204e 6f6e 6520 7573 6573  25. If None uses
-0000e4f0: 2063 7572 7265 6e74 2074 696d 652e 0a20   current time.. 
-0000e500: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000e510: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
-0000e520: 7279 2e61 6464 5f70 696e 7320 696d 706f  ry.add_pins impo
-0000e530: 7274 2061 6464 5f70 696e 735f 7472 6961  rt add_pins_tria
-0000e540: 6e67 6c65 0a20 2020 2020 2020 2066 726f  ngle.        fro
-0000e550: 6d20 6764 7366 6163 746f 7279 2e73 686f  m gdsfactory.sho
-0000e560: 7720 696d 706f 7274 2073 686f 770a 0a20  w import show.. 
-0000e570: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
-0000e580: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000e590: 2073 656c 662e 6164 645f 7069 6e73 5f74   self.add_pins_t
-0000e5a0: 7269 616e 676c 6528 706f 7274 5f6d 6172  riangle(port_mar
-0000e5b0: 6b65 725f 6c61 7965 723d 706f 7274 5f6d  ker_layer=port_m
-0000e5c0: 6172 6b65 725f 6c61 7965 7229 0a20 2020  arker_layer).   
-0000e5d0: 2020 2020 2020 2020 2069 6620 7368 6f77           if show
-0000e5e0: 5f70 6f72 7473 0a20 2020 2020 2020 2020  _ports.         
-0000e5f0: 2020 2065 6c73 6520 7365 6c66 0a20 2020     else self.   
-0000e600: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000e610: 6966 2073 686f 775f 7375 6270 6f72 7473  if show_subports
-0000e620: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-0000e630: 6d70 6f6e 656e 7420 3d20 7365 6c66 2e63  mponent = self.c
-0000e640: 6f70 7928 290a 2020 2020 2020 2020 2020  opy().          
-0000e650: 2020 636f 6d70 6f6e 656e 742e 6e61 6d65    component.name
-0000e660: 203d 2073 656c 662e 6e61 6d65 0a20 2020   = self.name.   
-0000e670: 2020 2020 2020 2020 2066 6f72 2072 6566           for ref
-0000e680: 6572 656e 6365 2069 6e20 636f 6d70 6f6e  erence in compon
-0000e690: 656e 742e 7265 6665 7265 6e63 6573 3a0a  ent.references:.
-0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6b0: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-0000e6c0: 6d70 6f6e 656e 742c 2043 6f6d 706f 6e65  mponent, Compone
-0000e6d0: 6e74 5265 6665 7265 6e63 6529 3a0a 2020  ntReference):.  
-0000e6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6f0: 2020 6164 645f 7069 6e73 5f74 7269 616e    add_pins_trian
-0000e700: 676c 6528 0a20 2020 2020 2020 2020 2020  gle(.           
-0000e710: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0000e720: 706f 6e65 6e74 3d63 6f6d 706f 6e65 6e74  ponent=component
-0000e730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e740: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-0000e750: 6e63 653d 7265 6665 7265 6e63 652c 0a20  nce=reference,. 
+0000dfc0: 2020 2078 6c69 6d3d 2862 5b30 5d2c 2062     xlim=(b[0], b
+0000dfd0: 5b32 5d29 2c0a 2020 2020 2020 2020 2020  [2]),.          
+0000dfe0: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
+0000dff0: 2272 6564 222c 0a20 2020 2020 2020 2020  "red",.         
+0000e000: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+0000e010: 616c 7068 613d 6c61 7965 725f 7669 6577  alpha=layer_view
+0000e020: 2e67 6574 5f61 6c70 6861 2829 206f 7220  .get_alpha() or 
+0000e030: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0000e040: 2020 2020 2020 2020 746f 6f6c 733d 5b22          tools=["
+0000e050: 686f 7665 7222 5d2c 0a20 2020 2020 2020  hover"],.       
+0000e060: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000e070: 2020 2020 2020 2020 2020 202a 2068 762e             * hv.
+0000e080: 5465 7874 2870 7469 705b 305d 2c20 7074  Text(ptip[0], pt
+0000e090: 6970 5b31 5d2c 206e 616d 6529 0a20 2020  ip[1], name).   
+0000e0a0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000e0b0: 2020 2020 7265 7475 726e 2068 762e 4f76      return hv.Ov
+0000e0c0: 6572 6c61 7928 706c 6f74 735f 746f 5f6f  erlay(plots_to_o
+0000e0d0: 7665 726c 6179 292e 6f70 7473 280a 2020  verlay).opts(.  
+0000e0e0: 2020 2020 2020 2020 2020 7368 6f77 5f6c            show_l
+0000e0f0: 6567 656e 643d 5472 7565 2c20 7368 6172  egend=True, shar
+0000e100: 6564 5f61 7865 733d 4661 6c73 652c 2079  ed_axes=False, y
+0000e110: 6c69 6d3d 2862 5b31 5d2c 2062 5b33 5d29  lim=(b[1], b[3])
+0000e120: 2c20 786c 696d 3d28 625b 305d 2c20 625b  , xlim=(b[0], b[
+0000e130: 325d 290a 2020 2020 2020 2020 290a 0a20  2]).        ).. 
+0000e140: 2020 2064 6566 2073 686f 7728 0a20 2020     def show(.   
+0000e150: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000e160: 2020 2073 686f 775f 706f 7274 733a 2062     show_ports: b
+0000e170: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0000e180: 2020 2020 2073 686f 775f 7375 6270 6f72       show_subpor
+0000e190: 7473 3a20 626f 6f6c 203d 2046 616c 7365  ts: bool = False
+0000e1a0: 2c0a 2020 2020 2020 2020 706f 7274 5f6d  ,.        port_m
+0000e1b0: 6172 6b65 725f 6c61 7965 723a 204c 6179  arker_layer: Lay
+0000e1c0: 6572 203d 2028 312c 2031 3029 2c0a 2020  er = (1, 10),.  
+0000e1d0: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+0000e1e0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0000e1f0: 2020 2020 2020 2022 2222 5368 6f77 2063         """Show c
+0000e200: 6f6d 706f 6e65 6e74 2069 6e20 4b4c 6179  omponent in KLay
+0000e210: 6f75 742e 0a0a 2020 2020 2020 2020 7265  out...        re
+0000e220: 7475 726e 7320 6120 636f 7079 206f 6620  turns a copy of 
+0000e230: 7468 6520 436f 6d70 6f6e 656e 742c 2073  the Component, s
+0000e240: 6f20 7468 6520 6f72 6967 696e 616c 2063  o the original c
+0000e250: 6f6d 706f 6e65 6e74 2072 656d 6169 6e73  omponent remains
+0000e260: 2069 6e74 6163 742e 0a20 2020 2020 2020   intact..       
+0000e270: 2077 6974 6820 7069 6e73 206d 6172 6b65   with pins marke
+0000e280: 7273 206f 6e20 6561 6368 2070 6f72 7420  rs on each port 
+0000e290: 7368 6f77 5f70 6f72 7473 203d 2054 7275  show_ports = Tru
+0000e2a0: 652c 2061 6e64 206f 7074 696f 6e61 6c6c  e, and optionall
+0000e2b0: 7920 616c 736f 0a20 2020 2020 2020 2074  y also.        t
+0000e2c0: 6865 2070 6f72 7473 2066 726f 6d20 7468  he ports from th
+0000e2d0: 6520 7265 6665 7265 6e63 6573 2028 7368  e references (sh
+0000e2e0: 6f77 5f73 7562 706f 7274 733d 5472 7565  ow_subports=True
+0000e2f0: 290a 0a20 2020 2020 2020 2041 7267 733a  )..        Args:
+0000e300: 0a20 2020 2020 2020 2020 2020 2073 686f  .            sho
+0000e310: 775f 706f 7274 733a 2073 686f 7773 2063  w_ports: shows c
+0000e320: 6f6d 706f 6e65 6e74 2077 6974 6820 706f  omponent with po
+0000e330: 7274 206d 6172 6b65 7273 2061 6e64 206c  rt markers and l
+0000e340: 6162 656c 732e 0a20 2020 2020 2020 2020  abels..         
+0000e350: 2020 2073 686f 775f 7375 6270 6f72 7473     show_subports
+0000e360: 3a20 6164 6420 706f 7274 7320 6d61 726b  : add ports mark
+0000e370: 6572 7320 616e 6420 6c61 6265 6c73 2074  ers and labels t
+0000e380: 6f20 7265 6665 7265 6e63 6573 2e0a 2020  o references..  
+0000e390: 2020 2020 2020 2020 2020 706f 7274 5f6d            port_m
+0000e3a0: 6172 6b65 725f 6c61 7965 723a 2066 6f72  arker_layer: for
+0000e3b0: 2074 6865 2070 6f72 7473 2e0a 0a20 2020   the ports...   
+0000e3c0: 2020 2020 204b 6579 776f 7264 2041 7267       Keyword Arg
+0000e3d0: 733a 0a20 2020 2020 2020 2020 2020 2067  s:.            g
+0000e3e0: 6473 7061 7468 3a20 4744 5320 6669 6c65  dspath: GDS file
+0000e3f0: 2070 6174 6820 746f 2077 7269 7465 2074   path to write t
+0000e400: 6f2e 0a20 2020 2020 2020 2020 2020 2067  o..            g
+0000e410: 6473 6469 723a 2064 6972 6563 746f 7279  dsdir: directory
+0000e420: 2066 6f72 2074 6865 2047 4453 2066 696c   for the GDS fil
+0000e430: 652e 2044 6566 6175 6c74 7320 746f 202f  e. Defaults to /
+0000e440: 746d 702f 2e0a 2020 2020 2020 2020 2020  tmp/..          
+0000e450: 2020 756e 6974 3a20 756e 6974 2073 697a    unit: unit siz
+0000e460: 6520 666f 7220 6f62 6a65 6374 7320 696e  e for objects in
+0000e470: 206c 6962 7261 7279 2e20 3175 6d20 6279   library. 1um by
+0000e480: 2064 6566 6175 6c74 2e0a 2020 2020 2020   default..      
+0000e490: 2020 2020 2020 7072 6563 6973 696f 6e3a        precision:
+0000e4a0: 2066 6f72 206f 626a 6563 7420 6469 6d65   for object dime
+0000e4b0: 6e73 696f 6e73 2069 6e20 7468 6520 6c69  nsions in the li
+0000e4c0: 6272 6172 7920 286d 292e 2031 6e6d 2062  brary (m). 1nm b
+0000e4d0: 7920 6465 6661 756c 742e 0a20 2020 2020  y default..     
+0000e4e0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+0000e4f0: 3a20 4465 6661 756c 7473 2074 6f20 3230  : Defaults to 20
+0000e500: 3139 2d31 302d 3235 2e20 4966 204e 6f6e  19-10-25. If Non
+0000e510: 6520 7573 6573 2063 7572 7265 6e74 2074  e uses current t
+0000e520: 696d 652e 0a20 2020 2020 2020 2022 2222  ime..        """
+0000e530: 0a20 2020 2020 2020 2066 726f 6d20 6764  .        from gd
+0000e540: 7366 6163 746f 7279 2e61 6464 5f70 696e  sfactory.add_pin
+0000e550: 7320 696d 706f 7274 2061 6464 5f70 696e  s import add_pin
+0000e560: 735f 7472 6961 6e67 6c65 0a20 2020 2020  s_triangle.     
+0000e570: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
+0000e580: 7279 2e73 686f 7720 696d 706f 7274 2073  ry.show import s
+0000e590: 686f 770a 0a20 2020 2020 2020 2063 6f6d  how..        com
+0000e5a0: 706f 6e65 6e74 203d 2028 0a20 2020 2020  ponent = (.     
+0000e5b0: 2020 2020 2020 2073 656c 662e 6164 645f         self.add_
+0000e5c0: 7069 6e73 5f74 7269 616e 676c 6528 706f  pins_triangle(po
+0000e5d0: 7274 5f6d 6172 6b65 725f 6c61 7965 723d  rt_marker_layer=
+0000e5e0: 706f 7274 5f6d 6172 6b65 725f 6c61 7965  port_marker_laye
+0000e5f0: 7229 0a20 2020 2020 2020 2020 2020 2069  r).            i
+0000e600: 6620 7368 6f77 5f70 6f72 7473 0a20 2020  f show_ports.   
+0000e610: 2020 2020 2020 2020 2065 6c73 6520 7365           else se
+0000e620: 6c66 0a20 2020 2020 2020 2029 0a0a 2020  lf.        )..  
+0000e630: 2020 2020 2020 6966 2073 686f 775f 7375        if show_su
+0000e640: 6270 6f72 7473 3a0a 2020 2020 2020 2020  bports:.        
+0000e650: 2020 2020 636f 6d70 6f6e 656e 7420 3d20      component = 
+0000e660: 7365 6c66 2e63 6f70 7928 290a 2020 2020  self.copy().    
+0000e670: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+0000e680: 742e 6e61 6d65 203d 2073 656c 662e 6e61  t.name = self.na
+0000e690: 6d65 0a20 2020 2020 2020 2020 2020 2066  me.            f
+0000e6a0: 6f72 2072 6566 6572 656e 6365 2069 6e20  or reference in 
+0000e6b0: 636f 6d70 6f6e 656e 742e 7265 6665 7265  component.refere
+0000e6c0: 6e63 6573 3a0a 2020 2020 2020 2020 2020  nces:.          
+0000e6d0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0000e6e0: 6e63 6528 636f 6d70 6f6e 656e 742c 2043  nce(component, C
+0000e6f0: 6f6d 706f 6e65 6e74 5265 6665 7265 6e63  omponentReferenc
+0000e700: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0000e710: 2020 2020 2020 2020 6164 645f 7069 6e73          add_pins
+0000e720: 5f74 7269 616e 676c 6528 0a20 2020 2020  _triangle(.     
+0000e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e740: 2020 2063 6f6d 706f 6e65 6e74 3d63 6f6d     component=com
+0000e750: 706f 6e65 6e74 2c0a 2020 2020 2020 2020  ponent,.        
 0000e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e770: 2020 2020 2020 206c 6179 6572 3d70 6f72         layer=por
-0000e780: 745f 6d61 726b 6572 5f6c 6179 6572 2c0a  t_marker_layer,.
-0000e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7a0: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
-0000e7b0: 686f 7728 636f 6d70 6f6e 656e 742c 202a  how(component, *
-0000e7c0: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
-0000e7d0: 6620 5f77 7269 7465 5f6c 6962 7261 7279  f _write_library
-0000e7e0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000e7f0: 2020 2020 2020 2020 6764 7370 6174 683a          gdspath:
-0000e800: 204f 7074 696f 6e61 6c5b 5061 7468 5479   Optional[PathTy
-0000e810: 7065 5d20 3d20 4e6f 6e65 2c0a 2020 2020  pe] = None,.    
-0000e820: 2020 2020 6764 7364 6972 3a20 4f70 7469      gdsdir: Opti
-0000e830: 6f6e 616c 5b50 6174 6854 7970 655d 203d  onal[PathType] =
-0000e840: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-0000e850: 696d 6573 7461 6d70 3a20 4f70 7469 6f6e  imestamp: Option
-0000e860: 616c 5b64 6174 6574 696d 652e 6461 7465  al[datetime.date
-0000e870: 7469 6d65 5d20 3d20 5f74 696d 6573 7461  time] = _timesta
-0000e880: 6d70 3230 3139 2c0a 2020 2020 2020 2020  mp2019,.        
-0000e890: 6c6f 6767 696e 673a 2062 6f6f 6c20 3d20  logging: bool = 
-0000e8a0: 5472 7565 2c0a 2020 2020 2020 2020 7769  True,.        wi
-0000e8b0: 7468 5f6f 6173 6973 3a20 626f 6f6c 203d  th_oasis: bool =
-0000e8c0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0000e8d0: 7769 7468 5f6d 6574 6164 6174 613a 2062  with_metadata: b
-0000e8e0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0000e8f0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-0000e900: 2020 2029 202d 3e20 5061 7468 3a0a 2020     ) -> Path:.  
-0000e910: 2020 2020 2020 2222 2257 7269 7465 2063        """Write c
-0000e920: 6f6d 706f 6e65 6e74 2074 6f20 4744 5320  omponent to GDS 
-0000e930: 6f72 204f 4153 4953 2061 6e64 2072 6574  or OASIS and ret
-0000e940: 7572 6e73 2067 6473 7061 7468 2e0a 0a20  urns gdspath... 
-0000e950: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-0000e960: 2020 2020 2020 2020 2067 6473 7061 7468           gdspath
-0000e970: 3a20 4744 5320 6669 6c65 2070 6174 6820  : GDS file path 
-0000e980: 746f 2077 7269 7465 2074 6f2e 0a20 2020  to write to..   
-0000e990: 2020 2020 2020 2020 2067 6473 6469 723a           gdsdir:
-0000e9a0: 2064 6972 6563 746f 7279 2066 6f72 2074   directory for t
-0000e9b0: 6865 2047 4453 2066 696c 652e 2044 6566  he GDS file. Def
-0000e9c0: 6175 6c74 7320 746f 202f 746d 702f 7261  aults to /tmp/ra
-0000e9d0: 6e64 6f6d 4669 6c65 2f67 6473 6661 6374  ndomFile/gdsfact
-0000e9e0: 6f72 792e 0a20 2020 2020 2020 2020 2020  ory..           
-0000e9f0: 2074 696d 6573 7461 6d70 3a20 4465 6661   timestamp: Defa
-0000ea00: 756c 7473 2074 6f20 3230 3139 2d31 302d  ults to 2019-10-
-0000ea10: 3235 2066 6f72 2063 6f6e 7369 7374 656e  25 for consisten
-0000ea20: 7420 6861 7368 2e0a 2020 2020 2020 2020  t hash..        
-0000ea30: 2020 2020 2020 2020 4966 204e 6f6e 6520          If None 
-0000ea40: 7573 6573 2063 7572 7265 6e74 2074 696d  uses current tim
-0000ea50: 652e 0a20 2020 2020 2020 2020 2020 206c  e..            l
-0000ea60: 6f67 6769 6e67 3a20 6469 7361 626c 6520  ogging: disable 
-0000ea70: 4744 5320 7061 7468 206c 6f67 6769 6e67  GDS path logging
-0000ea80: 2c20 666f 7220 6578 616d 706c 6520 666f  , for example fo
-0000ea90: 7220 7368 6f77 696e 6720 6974 2069 6e20  r showing it in 
-0000eaa0: 4b4c 6179 6f75 742e 0a20 2020 2020 2020  KLayout..       
-0000eab0: 2020 2020 2077 6974 685f 6f61 7369 733a       with_oasis:
-0000eac0: 2049 6620 5472 7565 2c20 6669 6c65 2077   If True, file w
-0000ead0: 696c 6c20 6265 2077 7269 7474 656e 2074  ill be written t
-0000eae0: 6f20 4f41 5349 532e 204f 7468 6572 7769  o OASIS. Otherwi
-0000eaf0: 7365 2c20 6669 6c65 2077 696c 6c20 6265  se, file will be
-0000eb00: 2077 7269 7474 656e 2074 6f20 4744 532e   written to GDS.
-0000eb10: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-0000eb20: 685f 6d65 7461 6461 7461 3a20 7772 6974  h_metadata: writ
-0000eb30: 6573 206d 6574 6164 6174 6120 696e 2059  es metadata in Y
-0000eb40: 414d 4c20 666f 726d 6174 2e0a 0a20 2020  AML format...   
-0000eb50: 2020 2020 204b 6579 776f 7264 2041 7267       Keyword Arg
-0000eb60: 733a 0a20 2020 2020 2020 2020 2020 204b  s:.            K
-0000eb70: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-0000eb80: 2077 696c 6c20 6f76 6572 7269 6465 2074   will override t
-0000eb90: 6865 2061 6374 6976 6520 5044 4b27 7320  he active PDK's 
-0000eba0: 6465 6661 756c 7420 4764 7357 7269 7465  default GdsWrite
-0000ebb0: 5365 7474 696e 6773 2061 6e64 204f 6173  Settings and Oas
-0000ebc0: 6973 5772 6974 6553 6574 7469 6e67 732e  isWriteSettings.
-0000ebd0: 0a0a 2020 2020 2020 2020 2020 2020 4764  ..            Gd
-0000ebe0: 7320 7365 7474 696e 6773 3a0a 2020 2020  s settings:.    
-0000ebf0: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0000ec00: 3a20 756e 6974 2073 697a 6520 666f 7220  : unit size for 
-0000ec10: 6f62 6a65 6374 7320 696e 206c 6962 7261  objects in libra
-0000ec20: 7279 2e20 3175 6d20 6279 2064 6566 6175  ry. 1um by defau
-0000ec30: 6c74 2e0a 2020 2020 2020 2020 2020 2020  lt..            
-0000ec40: 2020 2020 7072 6563 6973 696f 6e3a 2066      precision: f
-0000ec50: 6f72 2064 696d 656e 7369 6f6e 7320 696e  or dimensions in
-0000ec60: 2074 6865 206c 6962 7261 7279 2028 6d29   the library (m)
-0000ec70: 2e20 316e 6d20 6279 2064 6566 6175 6c74  . 1nm by default
-0000ec80: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ec90: 2020 6f6e 5f64 7570 6c69 6361 7465 5f63    on_duplicate_c
-0000eca0: 656c 6c3a 2073 7065 6369 6679 2068 6f77  ell: specify how
-0000ecb0: 2074 6f20 7265 736f 6c76 6520 6475 706c   to resolve dupl
-0000ecc0: 6963 6174 652d 6e61 6d65 6420 6365 6c6c  icate-named cell
-0000ecd0: 732e 2043 686f 6f73 6520 6f6e 6520 6f66  s. Choose one of
-0000ece0: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a0a   the following:.
-0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed00: 2020 2020 2277 6172 6e22 2028 6465 6661      "warn" (defa
-0000ed10: 756c 7429 3a20 6f76 6572 7772 6974 6520  ult): overwrite 
-0000ed20: 616c 6c20 6475 706c 6963 6174 6520 6365  all duplicate ce
-0000ed30: 6c6c 7320 7769 7468 206f 6e65 206f 6620  lls with one of 
-0000ed40: 7468 6520 6475 706c 6963 6174 6573 2028  the duplicates (
-0000ed50: 6172 6269 7472 6172 696c 7929 2e0a 2020  arbitrarily)..  
-0000ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed70: 2020 2265 7272 6f72 223a 2074 6872 6f77    "error": throw
-0000ed80: 2061 2056 616c 7565 4572 726f 7220 7768   a ValueError wh
-0000ed90: 656e 2061 7474 656d 7074 696e 6720 746f  en attempting to
-0000eda0: 2077 7269 7465 2061 2067 6473 2077 6974   write a gds wit
-0000edb0: 6820 6475 706c 6963 6174 6520 6365 6c6c  h duplicate cell
-0000edc0: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000edd0: 2020 2020 2020 2022 6f76 6572 7772 6974         "overwrit
-0000ede0: 6522 3a20 6f76 6572 7772 6974 6520 616c  e": overwrite al
-0000edf0: 6c20 6475 706c 6963 6174 6520 6365 6c6c  l duplicate cell
-0000ee00: 7320 7769 7468 206f 6e65 206f 6620 7468  s with one of th
-0000ee10: 6520 6475 706c 6963 6174 6573 2c20 7769  e duplicates, wi
-0000ee20: 7468 6f75 7420 7761 726e 696e 672e 0a20  thout warning.. 
-0000ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee40: 2020 204e 6f6e 653a 2064 6f20 6e6f 7420     None: do not 
-0000ee50: 7472 7920 746f 2072 6573 6f6c 7665 2028  try to resolve (
-0000ee60: 6174 2079 6f75 7220 6f77 6e20 7269 736b  at your own risk
-0000ee70: 2129 0a20 2020 2020 2020 2020 2020 2020  !).             
-0000ee80: 2020 2066 6c61 7474 656e 5f69 6e76 616c     flatten_inval
-0000ee90: 6964 5f72 6566 733a 2066 6c61 7474 656e  id_refs: flatten
-0000eea0: 7320 636f 6d70 6f6e 656e 7420 7265 6665  s component refe
-0000eeb0: 7265 6e63 6573 2077 6869 6368 2068 6176  rences which hav
-0000eec0: 6520 696e 7661 6c69 6420 7472 616e 7366  e invalid transf
-0000eed0: 6f72 6d61 7469 6f6e 732e 0a20 2020 2020  ormations..     
-0000eee0: 2020 2020 2020 2020 2020 206d 6178 5f70             max_p
-0000eef0: 6f69 6e74 733a 204d 6178 696d 616c 206e  oints: Maximal n
-0000ef00: 756d 6265 7220 6f66 2076 6572 7469 6365  umber of vertice
-0000ef10: 7320 7065 7220 706f 6c79 676f 6e2e 2050  s per polygon. P
-0000ef20: 6f6c 7967 6f6e 7320 7769 7468 206d 6f72  olygons with mor
-0000ef30: 6520 7665 7274 6963 6573 2074 6861 7420  e vertices that 
-0000ef40: 7468 6973 2061 7265 2061 7574 6f6d 6174  this are automat
-0000ef50: 6963 616c 6c79 2066 7261 6374 7572 6564  ically fractured
-0000ef60: 2e0a 0a20 2020 2020 2020 2020 2020 204f  ...            O
-0000ef70: 6173 6973 2073 6574 7469 6e67 733a 0a20  asis settings:. 
-0000ef80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000ef90: 6f6d 7072 6573 7369 6f6e 5f6c 6576 656c  ompression_level
-0000efa0: 3a20 4c65 7665 6c20 6f66 2063 6f6d 7072  : Level of compr
-0000efb0: 6573 7369 6f6e 2066 6f72 2063 656c 6c73  ession for cells
-0000efc0: 2028 6265 7477 6565 6e20 3020 616e 6420   (between 0 and 
-0000efd0: 3929 2e0a 2020 2020 2020 2020 2020 2020  9)..            
-0000efe0: 2020 2020 2020 2020 5365 7474 696e 6720          Setting 
-0000eff0: 746f 2030 2077 696c 6c20 6469 7361 626c  to 0 will disabl
-0000f000: 6520 6365 6c6c 2063 6f6d 7072 6573 7369  e cell compressi
-0000f010: 6f6e 2c20 3120 6769 7665 7320 7468 6520  on, 1 gives the 
-0000f020: 6265 7374 2073 7065 6564 2061 6e64 2039  best speed and 9
-0000f030: 2c20 7468 6520 6265 7374 2063 6f6d 7072  , the best compr
-0000f040: 6573 7369 6f6e 2e0a 2020 2020 2020 2020  ession..        
-0000f050: 2020 2020 2020 2020 6465 7465 6374 5f72          detect_r
-0000f060: 6563 7461 6e67 6c65 733a 2053 746f 7265  ectangles: Store
-0000f070: 2072 6563 7461 6e67 6c65 7320 696e 2063   rectangles in c
-0000f080: 6f6d 7072 6573 7365 6420 666f 726d 6174  ompressed format
-0000f090: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f0a0: 2020 6465 7465 6374 5f74 7261 7065 7a6f    detect_trapezo
-0000f0b0: 6964 733a 2053 746f 7265 2074 7261 7065  ids: Store trape
-0000f0c0: 7a6f 6964 7320 696e 2063 6f6d 7072 6573  zoids in compres
-0000f0d0: 7365 6420 666f 726d 6174 2e0a 2020 2020  sed format..    
-0000f0e0: 2020 2020 2020 2020 2020 2020 6369 7263              circ
-0000f0f0: 6c65 5f74 6f6c 6572 616e 6365 3a20 546f  le_tolerance: To
-0000f100: 6c65 7261 6e63 6520 666f 7220 6465 7465  lerance for dete
-0000f110: 6374 696e 6720 6369 7263 6c65 732e 2049  cting circles. I
-0000f120: 6620 6c65 7373 206f 7220 6571 7561 6c20  f less or equal 
-0000f130: 746f 2030 2c20 6e6f 2064 6574 6563 7469  to 0, no detecti
-0000f140: 6f6e 2069 7320 7065 7266 6f72 6d65 642e  on is performed.
-0000f150: 2043 6972 636c 6573 2061 7265 2073 746f   Circles are sto
-0000f160: 7265 6420 696e 2063 6f6d 7072 6573 7365  red in compresse
-0000f170: 6420 666f 726d 6174 2e0a 2020 2020 2020  d format..      
-0000f180: 2020 2020 2020 2020 2020 7661 6c69 6461            valida
-0000f190: 7469 6f6e 2028 2263 7263 3332 222c 2022  tion ("crc32", "
-0000f1a0: 6368 6563 6b73 756d 3332 222c 204e 6f6e  checksum32", Non
-0000f1b0: 6529 3a20 7479 7065 206f 6620 7661 6c69  e): type of vali
-0000f1c0: 6461 7469 6f6e 2074 6f20 696e 636c 7564  dation to includ
-0000f1d0: 6520 696e 2074 6865 2073 6176 6564 2066  e in the saved f
-0000f1e0: 696c 652e 0a20 2020 2020 2020 2020 2020  ile..           
-0000f1f0: 2020 2020 2073 7461 6e64 6172 645f 7072       standard_pr
-0000f200: 6f70 6572 7469 6573 3a20 5374 6f72 6520  operties: Store 
-0000f210: 7374 616e 6461 7264 204f 4153 4953 2070  standard OASIS p
-0000f220: 726f 7065 7274 6965 7320 696e 2074 6865  roperties in the
-0000f230: 2066 696c 652e 0a0a 2020 2020 2020 2020   file...        
-0000f240: 2222 220a 0a20 2020 2020 2020 2066 726f  """..        fro
-0000f250: 6d20 6764 7366 6163 746f 7279 2e70 646b  m gdsfactory.pdk
-0000f260: 2069 6d70 6f72 7420 6765 745f 6163 7469   import get_acti
-0000f270: 7665 5f70 646b 0a0a 2020 2020 2020 2020  ve_pdk..        
-0000f280: 6966 2067 6473 7061 7468 2061 6e64 2067  if gdspath and g
-0000f290: 6473 6469 723a 0a20 2020 2020 2020 2020  dsdir:.         
-0000f2a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0000f2b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f2c0: 2020 2267 6473 7061 7468 2061 6e64 2067    "gdspath and g
-0000f2d0: 6473 6469 7220 6861 7665 2062 6f74 6820  dsdir have both 
-0000f2e0: 6265 656e 2073 7065 6369 6669 6564 2e20  been specified. 
-0000f2f0: 6764 7370 6174 6820 7769 6c6c 2074 616b  gdspath will tak
-0000f300: 6520 7072 6563 6564 656e 6365 2061 6e64  e precedence and
-0000f310: 2067 6473 6469 7220 7769 6c6c 2062 6520   gdsdir will be 
-0000f320: 6967 6e6f 7265 642e 222c 0a20 2020 2020  ignored.",.     
-0000f330: 2020 2020 2020 2020 2020 2073 7461 636b             stack
-0000f340: 6c65 7665 6c3d 332c 0a20 2020 2020 2020  level=3,.       
-0000f350: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000f360: 6465 6661 756c 745f 7365 7474 696e 6773  default_settings
-0000f370: 203d 2067 6574 5f61 6374 6976 655f 7064   = get_active_pd
-0000f380: 6b28 292e 6764 735f 7772 6974 655f 7365  k().gds_write_se
-0000f390: 7474 696e 6773 0a20 2020 2020 2020 2064  ttings.        d
-0000f3a0: 6566 6175 6c74 5f6f 6173 6973 5f73 6574  efault_oasis_set
-0000f3b0: 7469 6e67 7320 3d20 6765 745f 6163 7469  tings = get_acti
-0000f3c0: 7665 5f70 646b 2829 2e6f 6173 6973 5f73  ve_pdk().oasis_s
-0000f3d0: 6574 7469 6e67 730a 0a20 2020 2020 2020  ettings..       
-0000f3e0: 2065 7870 6c69 6369 745f 6764 735f 7365   explicit_gds_se
-0000f3f0: 7474 696e 6773 203d 207b 0a20 2020 2020  ttings = {.     
-0000f400: 2020 2020 2020 206b 3a20 760a 2020 2020         k: v.    
-0000f410: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-0000f420: 2069 6e20 6b77 6172 6773 2e69 7465 6d73   in kwargs.items
-0000f430: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-0000f440: 6620 7620 6973 206e 6f74 204e 6f6e 6520  f v is not None 
-0000f450: 616e 6420 6b20 696e 2064 6566 6175 6c74  and k in default
-0000f460: 5f73 6574 7469 6e67 732e 6469 6374 2829  _settings.dict()
-0000f470: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0000f480: 2020 2065 7870 6c69 6369 745f 6f61 735f     explicit_oas_
-0000f490: 7365 7474 696e 6773 203d 207b 0a20 2020  settings = {.   
-0000f4a0: 2020 2020 2020 2020 206b 3a20 760a 2020           k: v.  
-0000f4b0: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
-0000f4c0: 2076 2069 6e20 6b77 6172 6773 2e69 7465   v in kwargs.ite
-0000f4d0: 6d73 2829 0a20 2020 2020 2020 2020 2020  ms().           
-0000f4e0: 2069 6620 7620 6973 206e 6f74 204e 6f6e   if v is not Non
-0000f4f0: 6520 616e 6420 6b20 696e 2064 6566 6175  e and k in defau
-0000f500: 6c74 5f6f 6173 6973 5f73 6574 7469 6e67  lt_oasis_setting
-0000f510: 732e 6469 6374 2829 0a20 2020 2020 2020  s.dict().       
-0000f520: 207d 0a20 2020 2020 2020 2023 2075 7064   }.        # upd
-0000f530: 6174 6520 7468 6520 7772 6974 6520 7365  ate the write se
-0000f540: 7474 696e 6773 2077 6974 6820 616e 7920  ttings with any 
-0000f550: 7365 7474 696e 6773 2065 7870 6c69 6369  settings explici
-0000f560: 746c 7920 7061 7373 6564 0a20 2020 2020  tly passed.     
-0000f570: 2020 2077 7269 7465 5f73 6574 7469 6e67     write_setting
-0000f580: 7320 3d20 6465 6661 756c 745f 7365 7474  s = default_sett
-0000f590: 696e 6773 2e63 6f70 7928 7570 6461 7465  ings.copy(update
-0000f5a0: 3d65 7870 6c69 6369 745f 6764 735f 7365  =explicit_gds_se
-0000f5b0: 7474 696e 6773 290a 2020 2020 2020 2020  ttings).        
-0000f5c0: 6f61 7369 735f 7365 7474 696e 6773 203d  oasis_settings =
-0000f5d0: 2064 6566 6175 6c74 5f6f 6173 6973 5f73   default_oasis_s
-0000f5e0: 6574 7469 6e67 732e 636f 7079 2875 7064  ettings.copy(upd
-0000f5f0: 6174 653d 6578 706c 6963 6974 5f6f 6173  ate=explicit_oas
-0000f600: 5f73 6574 7469 6e67 7329 0a0a 2020 2020  _settings)..    
-0000f610: 2020 2020 5f63 6865 636b 5f75 6e63 6163      _check_uncac
-0000f620: 6865 645f 636f 6d70 6f6e 656e 7473 280a  hed_components(.
-0000f630: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0000f640: 6f6e 656e 743d 7365 6c66 2c20 6d6f 6465  onent=self, mode
-0000f650: 3d77 7269 7465 5f73 6574 7469 6e67 732e  =write_settings.
-0000f660: 6f6e 5f75 6e63 6163 6865 645f 636f 6d70  on_uncached_comp
-0000f670: 6f6e 656e 740a 2020 2020 2020 2020 290a  onent.        ).
-0000f680: 0a20 2020 2020 2020 2069 6620 7772 6974  .        if writ
-0000f690: 655f 7365 7474 696e 6773 2e66 6c61 7474  e_settings.flatt
-0000f6a0: 656e 5f69 6e76 616c 6964 5f72 6566 733a  en_invalid_refs:
-0000f6b0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-0000f6c0: 5f63 656c 6c20 3d20 666c 6174 7465 6e5f  _cell = flatten_
-0000f6d0: 696e 7661 6c69 645f 7265 6673 5f72 6563  invalid_refs_rec
-0000f6e0: 7572 7369 7665 2873 656c 6629 0a20 2020  ursive(self).   
-0000f6f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000f700: 2020 2020 2020 2074 6f70 5f63 656c 6c20         top_cell 
-0000f710: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
-0000f720: 6764 7364 6972 203d 2067 6473 6469 7220  gdsdir = gdsdir 
-0000f730: 6f72 2047 4453 4449 525f 5445 4d50 0a20  or GDSDIR_TEMP. 
-0000f740: 2020 2020 2020 2067 6473 6469 7220 3d20         gdsdir = 
-0000f750: 7061 7468 6c69 622e 5061 7468 2867 6473  pathlib.Path(gds
-0000f760: 6469 7229 0a20 2020 2020 2020 2069 6620  dir).        if 
-0000f770: 7769 7468 5f6f 6173 6973 3a0a 2020 2020  with_oasis:.    
-0000f780: 2020 2020 2020 2020 6764 7370 6174 6820          gdspath 
-0000f790: 3d20 6764 7370 6174 6820 6f72 2067 6473  = gdspath or gds
-0000f7a0: 6469 7220 2f20 6622 7b74 6f70 5f63 656c  dir / f"{top_cel
-0000f7b0: 6c2e 6e61 6d65 7d2e 6f61 7322 0a20 2020  l.name}.oas".   
-0000f7c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000f7d0: 2020 2020 2020 2067 6473 7061 7468 203d         gdspath =
-0000f7e0: 2067 6473 7061 7468 206f 7220 6764 7364   gdspath or gdsd
-0000f7f0: 6972 202f 2066 227b 746f 705f 6365 6c6c  ir / f"{top_cell
-0000f800: 2e6e 616d 657d 2e67 6473 220a 2020 2020  .name}.gds".    
-0000f810: 2020 2020 6764 7370 6174 6820 3d20 7061      gdspath = pa
-0000f820: 7468 6c69 622e 5061 7468 2867 6473 7061  thlib.Path(gdspa
-0000f830: 7468 290a 2020 2020 2020 2020 6764 7364  th).        gdsd
-0000f840: 6972 203d 2067 6473 7061 7468 2e70 6172  ir = gdspath.par
-0000f850: 656e 740a 2020 2020 2020 2020 6764 7364  ent.        gdsd
-0000f860: 6972 2e6d 6b64 6972 2865 7869 7374 5f6f  ir.mkdir(exist_o
-0000f870: 6b3d 5472 7565 2c20 7061 7265 6e74 733d  k=True, parents=
-0000f880: 5472 7565 290a 0a20 2020 2020 2020 2063  True)..        c
-0000f890: 656c 6c73 203d 2074 6f70 5f63 656c 6c2e  ells = top_cell.
-0000f8a0: 6765 745f 6465 7065 6e64 656e 6369 6573  get_dependencies
-0000f8b0: 2872 6563 7572 7369 7665 3d54 7275 6529  (recursive=True)
-0000f8c0: 0a20 2020 2020 2020 2063 656c 6c5f 6e61  .        cell_na
-0000f8d0: 6d65 7320 3d20 5b63 656c 6c2e 6e61 6d65  mes = [cell.name
-0000f8e0: 2066 6f72 2063 656c 6c20 696e 206c 6973   for cell in lis
-0000f8f0: 7428 6365 6c6c 7329 5d0a 2020 2020 2020  t(cells)].      
-0000f900: 2020 6365 6c6c 5f6e 616d 6573 5f75 6e69    cell_names_uni
-0000f910: 7175 6520 3d20 7365 7428 6365 6c6c 5f6e  que = set(cell_n
-0000f920: 616d 6573 290a 0a20 2020 2020 2020 2069  ames)..        i
-0000f930: 6620 6c65 6e28 6365 6c6c 5f6e 616d 6573  f len(cell_names
-0000f940: 2920 213d 206c 656e 2873 6574 2863 656c  ) != len(set(cel
-0000f950: 6c5f 6e61 6d65 7329 293a 0a20 2020 2020  l_names)):.     
-0000f960: 2020 2020 2020 2066 6f72 2063 656c 6c5f         for cell_
-0000f970: 6e61 6d65 2069 6e20 6365 6c6c 5f6e 616d  name in cell_nam
-0000f980: 6573 5f75 6e69 7175 653a 0a20 2020 2020  es_unique:.     
-0000f990: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
-0000f9a0: 6e61 6d65 732e 7265 6d6f 7665 2863 656c  names.remove(cel
-0000f9b0: 6c5f 6e61 6d65 290a 0a20 2020 2020 2020  l_name)..       
-0000f9c0: 2020 2020 2069 6620 7772 6974 655f 7365       if write_se
-0000f9d0: 7474 696e 6773 2e6f 6e5f 6475 706c 6963  ttings.on_duplic
-0000f9e0: 6174 655f 6365 6c6c 203d 3d20 2265 7272  ate_cell == "err
-0000f9f0: 6f72 223a 0a20 2020 2020 2020 2020 2020  or":.           
-0000fa00: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000fa10: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000fa20: 2020 2020 2020 2020 2020 2066 2244 7570             f"Dup
-0000fa30: 6c69 6361 7465 6420 6365 6c6c 206e 616d  licated cell nam
-0000fa40: 6573 2069 6e20 7b74 6f70 5f63 656c 6c2e  es in {top_cell.
-0000fa50: 6e61 6d65 2172 7d3a 207b 6365 6c6c 5f6e  name!r}: {cell_n
-0000fa60: 616d 6573 2172 7d22 0a20 2020 2020 2020  ames!r}".       
-0000fa70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000fa80: 2020 2020 2020 2065 6c69 6620 7772 6974         elif writ
-0000fa90: 655f 7365 7474 696e 6773 2e6f 6e5f 6475  e_settings.on_du
-0000faa0: 706c 6963 6174 655f 6365 6c6c 2069 6e20  plicate_cell in 
-0000fab0: 7b22 7761 726e 222c 2022 6f76 6572 7772  {"warn", "overwr
-0000fac0: 6974 6522 7d3a 0a20 2020 2020 2020 2020  ite"}:.         
-0000fad0: 2020 2020 2020 2069 6620 7772 6974 655f         if write_
-0000fae0: 7365 7474 696e 6773 2e6f 6e5f 6475 706c  settings.on_dupl
-0000faf0: 6963 6174 655f 6365 6c6c 203d 3d20 2277  icate_cell == "w
-0000fb00: 6172 6e22 3a0a 2020 2020 2020 2020 2020  arn":.          
-0000fb10: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0000fb20: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+0000e770: 7265 6665 7265 6e63 653d 7265 6665 7265  reference=refere
+0000e780: 6e63 652c 0a20 2020 2020 2020 2020 2020  nce,.           
+0000e790: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0000e7a0: 6572 3d70 6f72 745f 6d61 726b 6572 5f6c  er=port_marker_l
+0000e7b0: 6179 6572 2c0a 2020 2020 2020 2020 2020  ayer,.          
+0000e7c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000e7d0: 2020 2020 2073 686f 7728 636f 6d70 6f6e       show(compon
+0000e7e0: 656e 742c 202a 2a6b 7761 7267 7329 0a0a  ent, **kwargs)..
+0000e7f0: 2020 2020 6465 6620 5f77 7269 7465 5f6c      def _write_l
+0000e800: 6962 7261 7279 280a 2020 2020 2020 2020  ibrary(.        
+0000e810: 7365 6c66 2c0a 2020 2020 2020 2020 6764  self,.        gd
+0000e820: 7370 6174 683a 204f 7074 696f 6e61 6c5b  spath: Optional[
+0000e830: 5061 7468 5479 7065 5d20 3d20 4e6f 6e65  PathType] = None
+0000e840: 2c0a 2020 2020 2020 2020 6764 7364 6972  ,.        gdsdir
+0000e850: 3a20 4f70 7469 6f6e 616c 5b50 6174 6854  : Optional[PathT
+0000e860: 7970 655d 203d 204e 6f6e 652c 0a20 2020  ype] = None,.   
+0000e870: 2020 2020 2074 696d 6573 7461 6d70 3a20       timestamp: 
+0000e880: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
+0000e890: 652e 6461 7465 7469 6d65 5d20 3d20 5f74  e.datetime] = _t
+0000e8a0: 696d 6573 7461 6d70 3230 3139 2c0a 2020  imestamp2019,.  
+0000e8b0: 2020 2020 2020 6c6f 6767 696e 673a 2062        logging: b
+0000e8c0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+0000e8d0: 2020 2020 7769 7468 5f6f 6173 6973 3a20      with_oasis: 
+0000e8e0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0000e8f0: 2020 2020 2020 7769 7468 5f6d 6574 6164        with_metad
+0000e900: 6174 613a 2062 6f6f 6c20 3d20 4661 6c73  ata: bool = Fals
+0000e910: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
+0000e920: 7267 732c 0a20 2020 2029 202d 3e20 5061  rgs,.    ) -> Pa
+0000e930: 7468 3a0a 2020 2020 2020 2020 2222 2257  th:.        """W
+0000e940: 7269 7465 2063 6f6d 706f 6e65 6e74 2074  rite component t
+0000e950: 6f20 4744 5320 6f72 204f 4153 4953 2061  o GDS or OASIS a
+0000e960: 6e64 2072 6574 7572 6e73 2067 6473 7061  nd returns gdspa
+0000e970: 7468 2e0a 0a20 2020 2020 2020 2041 7267  th...        Arg
+0000e980: 733a 0a20 2020 2020 2020 2020 2020 2067  s:.            g
+0000e990: 6473 7061 7468 3a20 4744 5320 6669 6c65  dspath: GDS file
+0000e9a0: 2070 6174 6820 746f 2077 7269 7465 2074   path to write t
+0000e9b0: 6f2e 0a20 2020 2020 2020 2020 2020 2067  o..            g
+0000e9c0: 6473 6469 723a 2064 6972 6563 746f 7279  dsdir: directory
+0000e9d0: 2066 6f72 2074 6865 2047 4453 2066 696c   for the GDS fil
+0000e9e0: 652e 2044 6566 6175 6c74 7320 746f 202f  e. Defaults to /
+0000e9f0: 746d 702f 7261 6e64 6f6d 4669 6c65 2f67  tmp/randomFile/g
+0000ea00: 6473 6661 6374 6f72 792e 0a20 2020 2020  dsfactory..     
+0000ea10: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+0000ea20: 3a20 4465 6661 756c 7473 2074 6f20 3230  : Defaults to 20
+0000ea30: 3139 2d31 302d 3235 2066 6f72 2063 6f6e  19-10-25 for con
+0000ea40: 7369 7374 656e 7420 6861 7368 2e0a 2020  sistent hash..  
+0000ea50: 2020 2020 2020 2020 2020 2020 2020 4966                If
+0000ea60: 204e 6f6e 6520 7573 6573 2063 7572 7265   None uses curre
+0000ea70: 6e74 2074 696d 652e 0a20 2020 2020 2020  nt time..       
+0000ea80: 2020 2020 206c 6f67 6769 6e67 3a20 6469       logging: di
+0000ea90: 7361 626c 6520 4744 5320 7061 7468 206c  sable GDS path l
+0000eaa0: 6f67 6769 6e67 2c20 666f 7220 6578 616d  ogging, for exam
+0000eab0: 706c 6520 666f 7220 7368 6f77 696e 6720  ple for showing 
+0000eac0: 6974 2069 6e20 4b4c 6179 6f75 742e 0a20  it in KLayout.. 
+0000ead0: 2020 2020 2020 2020 2020 2077 6974 685f             with_
+0000eae0: 6f61 7369 733a 2049 6620 5472 7565 2c20  oasis: If True, 
+0000eaf0: 6669 6c65 2077 696c 6c20 6265 2077 7269  file will be wri
+0000eb00: 7474 656e 2074 6f20 4f41 5349 532e 204f  tten to OASIS. O
+0000eb10: 7468 6572 7769 7365 2c20 6669 6c65 2077  therwise, file w
+0000eb20: 696c 6c20 6265 2077 7269 7474 656e 2074  ill be written t
+0000eb30: 6f20 4744 532e 0a20 2020 2020 2020 2020  o GDS..         
+0000eb40: 2020 2077 6974 685f 6d65 7461 6461 7461     with_metadata
+0000eb50: 3a20 7772 6974 6573 206d 6574 6164 6174  : writes metadat
+0000eb60: 6120 696e 2059 414d 4c20 666f 726d 6174  a in YAML format
+0000eb70: 2e0a 0a20 2020 2020 2020 204b 6579 776f  ...        Keywo
+0000eb80: 7264 2041 7267 733a 0a20 2020 2020 2020  rd Args:.       
+0000eb90: 2020 2020 204b 6579 776f 7264 2061 7267       Keyword arg
+0000eba0: 756d 656e 7473 2077 696c 6c20 6f76 6572  uments will over
+0000ebb0: 7269 6465 2074 6865 2061 6374 6976 6520  ride the active 
+0000ebc0: 5044 4b27 7320 6465 6661 756c 7420 4764  PDK's default Gd
+0000ebd0: 7357 7269 7465 5365 7474 696e 6773 2061  sWriteSettings a
+0000ebe0: 6e64 204f 6173 6973 5772 6974 6553 6574  nd OasisWriteSet
+0000ebf0: 7469 6e67 732e 0a0a 2020 2020 2020 2020  tings...        
+0000ec00: 2020 2020 4764 7320 7365 7474 696e 6773      Gds settings
+0000ec10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000ec20: 2020 756e 6974 3a20 756e 6974 2073 697a    unit: unit siz
+0000ec30: 6520 666f 7220 6f62 6a65 6374 7320 696e  e for objects in
+0000ec40: 206c 6962 7261 7279 2e20 3175 6d20 6279   library. 1um by
+0000ec50: 2064 6566 6175 6c74 2e0a 2020 2020 2020   default..      
+0000ec60: 2020 2020 2020 2020 2020 7072 6563 6973            precis
+0000ec70: 696f 6e3a 2066 6f72 2064 696d 656e 7369  ion: for dimensi
+0000ec80: 6f6e 7320 696e 2074 6865 206c 6962 7261  ons in the libra
+0000ec90: 7279 2028 6d29 2e20 316e 6d20 6279 2064  ry (m). 1nm by d
+0000eca0: 6566 6175 6c74 2e0a 2020 2020 2020 2020  efault..        
+0000ecb0: 2020 2020 2020 2020 6f6e 5f64 7570 6c69          on_dupli
+0000ecc0: 6361 7465 5f63 656c 6c3a 2073 7065 6369  cate_cell: speci
+0000ecd0: 6679 2068 6f77 2074 6f20 7265 736f 6c76  fy how to resolv
+0000ece0: 6520 6475 706c 6963 6174 652d 6e61 6d65  e duplicate-name
+0000ecf0: 6420 6365 6c6c 732e 2043 686f 6f73 6520  d cells. Choose 
+0000ed00: 6f6e 6520 6f66 2074 6865 2066 6f6c 6c6f  one of the follo
+0000ed10: 7769 6e67 3a0a 2020 2020 2020 2020 2020  wing:.          
+0000ed20: 2020 2020 2020 2020 2020 2277 6172 6e22            "warn"
+0000ed30: 2028 6465 6661 756c 7429 3a20 6f76 6572   (default): over
+0000ed40: 7772 6974 6520 616c 6c20 6475 706c 6963  write all duplic
+0000ed50: 6174 6520 6365 6c6c 7320 7769 7468 206f  ate cells with o
+0000ed60: 6e65 206f 6620 7468 6520 6475 706c 6963  ne of the duplic
+0000ed70: 6174 6573 2028 6172 6269 7472 6172 696c  ates (arbitraril
+0000ed80: 7929 2e0a 2020 2020 2020 2020 2020 2020  y)..            
+0000ed90: 2020 2020 2020 2020 2265 7272 6f72 223a          "error":
+0000eda0: 2074 6872 6f77 2061 2056 616c 7565 4572   throw a ValueEr
+0000edb0: 726f 7220 7768 656e 2061 7474 656d 7074  ror when attempt
+0000edc0: 696e 6720 746f 2077 7269 7465 2061 2067  ing to write a g
+0000edd0: 6473 2077 6974 6820 6475 706c 6963 6174  ds with duplicat
+0000ede0: 6520 6365 6c6c 732e 0a20 2020 2020 2020  e cells..       
+0000edf0: 2020 2020 2020 2020 2020 2020 2022 6f76               "ov
+0000ee00: 6572 7772 6974 6522 3a20 6f76 6572 7772  erwrite": overwr
+0000ee10: 6974 6520 616c 6c20 6475 706c 6963 6174  ite all duplicat
+0000ee20: 6520 6365 6c6c 7320 7769 7468 206f 6e65  e cells with one
+0000ee30: 206f 6620 7468 6520 6475 706c 6963 6174   of the duplicat
+0000ee40: 6573 2c20 7769 7468 6f75 7420 7761 726e  es, without warn
+0000ee50: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+0000ee60: 2020 2020 2020 2020 204e 6f6e 653a 2064           None: d
+0000ee70: 6f20 6e6f 7420 7472 7920 746f 2072 6573  o not try to res
+0000ee80: 6f6c 7665 2028 6174 2079 6f75 7220 6f77  olve (at your ow
+0000ee90: 6e20 7269 736b 2129 0a20 2020 2020 2020  n risk!).       
+0000eea0: 2020 2020 2020 2020 2066 6c61 7474 656e           flatten
+0000eeb0: 5f69 6e76 616c 6964 5f72 6566 733a 2066  _invalid_refs: f
+0000eec0: 6c61 7474 656e 7320 636f 6d70 6f6e 656e  lattens componen
+0000eed0: 7420 7265 6665 7265 6e63 6573 2077 6869  t references whi
+0000eee0: 6368 2068 6176 6520 696e 7661 6c69 6420  ch have invalid 
+0000eef0: 7472 616e 7366 6f72 6d61 7469 6f6e 732e  transformations.
+0000ef00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ef10: 206d 6178 5f70 6f69 6e74 733a 204d 6178   max_points: Max
+0000ef20: 696d 616c 206e 756d 6265 7220 6f66 2076  imal number of v
+0000ef30: 6572 7469 6365 7320 7065 7220 706f 6c79  ertices per poly
+0000ef40: 676f 6e2e 2050 6f6c 7967 6f6e 7320 7769  gon. Polygons wi
+0000ef50: 7468 206d 6f72 6520 7665 7274 6963 6573  th more vertices
+0000ef60: 2074 6861 7420 7468 6973 2061 7265 2061   that this are a
+0000ef70: 7574 6f6d 6174 6963 616c 6c79 2066 7261  utomatically fra
+0000ef80: 6374 7572 6564 2e0a 0a20 2020 2020 2020  ctured...       
+0000ef90: 2020 2020 204f 6173 6973 2073 6574 7469       Oasis setti
+0000efa0: 6e67 733a 0a20 2020 2020 2020 2020 2020  ngs:.           
+0000efb0: 2020 2020 2063 6f6d 7072 6573 7369 6f6e       compression
+0000efc0: 5f6c 6576 656c 3a20 4c65 7665 6c20 6f66  _level: Level of
+0000efd0: 2063 6f6d 7072 6573 7369 6f6e 2066 6f72   compression for
+0000efe0: 2063 656c 6c73 2028 6265 7477 6565 6e20   cells (between 
+0000eff0: 3020 616e 6420 3929 2e0a 2020 2020 2020  0 and 9)..      
+0000f000: 2020 2020 2020 2020 2020 2020 2020 5365                Se
+0000f010: 7474 696e 6720 746f 2030 2077 696c 6c20  tting to 0 will 
+0000f020: 6469 7361 626c 6520 6365 6c6c 2063 6f6d  disable cell com
+0000f030: 7072 6573 7369 6f6e 2c20 3120 6769 7665  pression, 1 give
+0000f040: 7320 7468 6520 6265 7374 2073 7065 6564  s the best speed
+0000f050: 2061 6e64 2039 2c20 7468 6520 6265 7374   and 9, the best
+0000f060: 2063 6f6d 7072 6573 7369 6f6e 2e0a 2020   compression..  
+0000f070: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0000f080: 7465 6374 5f72 6563 7461 6e67 6c65 733a  tect_rectangles:
+0000f090: 2053 746f 7265 2072 6563 7461 6e67 6c65   Store rectangle
+0000f0a0: 7320 696e 2063 6f6d 7072 6573 7365 6420  s in compressed 
+0000f0b0: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
+0000f0c0: 2020 2020 2020 2020 6465 7465 6374 5f74          detect_t
+0000f0d0: 7261 7065 7a6f 6964 733a 2053 746f 7265  rapezoids: Store
+0000f0e0: 2074 7261 7065 7a6f 6964 7320 696e 2063   trapezoids in c
+0000f0f0: 6f6d 7072 6573 7365 6420 666f 726d 6174  ompressed format
+0000f100: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f110: 2020 6369 7263 6c65 5f74 6f6c 6572 616e    circle_toleran
+0000f120: 6365 3a20 546f 6c65 7261 6e63 6520 666f  ce: Tolerance fo
+0000f130: 7220 6465 7465 6374 696e 6720 6369 7263  r detecting circ
+0000f140: 6c65 732e 2049 6620 6c65 7373 206f 7220  les. If less or 
+0000f150: 6571 7561 6c20 746f 2030 2c20 6e6f 2064  equal to 0, no d
+0000f160: 6574 6563 7469 6f6e 2069 7320 7065 7266  etection is perf
+0000f170: 6f72 6d65 642e 2043 6972 636c 6573 2061  ormed. Circles a
+0000f180: 7265 2073 746f 7265 6420 696e 2063 6f6d  re stored in com
+0000f190: 7072 6573 7365 6420 666f 726d 6174 2e0a  pressed format..
+0000f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1b0: 7661 6c69 6461 7469 6f6e 2028 2263 7263  validation ("crc
+0000f1c0: 3332 222c 2022 6368 6563 6b73 756d 3332  32", "checksum32
+0000f1d0: 222c 204e 6f6e 6529 3a20 7479 7065 206f  ", None): type o
+0000f1e0: 6620 7661 6c69 6461 7469 6f6e 2074 6f20  f validation to 
+0000f1f0: 696e 636c 7564 6520 696e 2074 6865 2073  include in the s
+0000f200: 6176 6564 2066 696c 652e 0a20 2020 2020  aved file..     
+0000f210: 2020 2020 2020 2020 2020 2073 7461 6e64             stand
+0000f220: 6172 645f 7072 6f70 6572 7469 6573 3a20  ard_properties: 
+0000f230: 5374 6f72 6520 7374 616e 6461 7264 204f  Store standard O
+0000f240: 4153 4953 2070 726f 7065 7274 6965 7320  ASIS properties 
+0000f250: 696e 2074 6865 2066 696c 652e 0a0a 2020  in the file...  
+0000f260: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000f270: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
+0000f280: 7279 2e70 646b 2069 6d70 6f72 7420 6765  ry.pdk import ge
+0000f290: 745f 6163 7469 7665 5f70 646b 0a0a 2020  t_active_pdk..  
+0000f2a0: 2020 2020 2020 6966 2067 6473 7061 7468        if gdspath
+0000f2b0: 2061 6e64 2067 6473 6469 723a 0a20 2020   and gdsdir:.   
+0000f2c0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+0000f2d0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+0000f2e0: 2020 2020 2020 2020 2267 6473 7061 7468          "gdspath
+0000f2f0: 2061 6e64 2067 6473 6469 7220 6861 7665   and gdsdir have
+0000f300: 2062 6f74 6820 6265 656e 2073 7065 6369   both been speci
+0000f310: 6669 6564 2e20 6764 7370 6174 6820 7769  fied. gdspath wi
+0000f320: 6c6c 2074 616b 6520 7072 6563 6564 656e  ll take preceden
+0000f330: 6365 2061 6e64 2067 6473 6469 7220 7769  ce and gdsdir wi
+0000f340: 6c6c 2062 6520 6967 6e6f 7265 642e 222c  ll be ignored.",
+0000f350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f360: 2073 7461 636b 6c65 7665 6c3d 332c 0a20   stacklevel=3,. 
+0000f370: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000f380: 2020 2020 2020 6465 6661 756c 745f 7365        default_se
+0000f390: 7474 696e 6773 203d 2067 6574 5f61 6374  ttings = get_act
+0000f3a0: 6976 655f 7064 6b28 292e 6764 735f 7772  ive_pdk().gds_wr
+0000f3b0: 6974 655f 7365 7474 696e 6773 0a20 2020  ite_settings.   
+0000f3c0: 2020 2020 2064 6566 6175 6c74 5f6f 6173       default_oas
+0000f3d0: 6973 5f73 6574 7469 6e67 7320 3d20 6765  is_settings = ge
+0000f3e0: 745f 6163 7469 7665 5f70 646b 2829 2e6f  t_active_pdk().o
+0000f3f0: 6173 6973 5f73 6574 7469 6e67 730a 0a20  asis_settings.. 
+0000f400: 2020 2020 2020 2065 7870 6c69 6369 745f         explicit_
+0000f410: 6764 735f 7365 7474 696e 6773 203d 207b  gds_settings = {
+0000f420: 0a20 2020 2020 2020 2020 2020 206b 3a20  .            k: 
+0000f430: 760a 2020 2020 2020 2020 2020 2020 666f  v.            fo
+0000f440: 7220 6b2c 2076 2069 6e20 6b77 6172 6773  r k, v in kwargs
+0000f450: 2e69 7465 6d73 2829 0a20 2020 2020 2020  .items().       
+0000f460: 2020 2020 2069 6620 7620 6973 206e 6f74       if v is not
+0000f470: 204e 6f6e 6520 616e 6420 6b20 696e 2064   None and k in d
+0000f480: 6566 6175 6c74 5f73 6574 7469 6e67 732e  efault_settings.
+0000f490: 6469 6374 2829 0a20 2020 2020 2020 207d  dict().        }
+0000f4a0: 0a20 2020 2020 2020 2065 7870 6c69 6369  .        explici
+0000f4b0: 745f 6f61 735f 7365 7474 696e 6773 203d  t_oas_settings =
+0000f4c0: 207b 0a20 2020 2020 2020 2020 2020 206b   {.            k
+0000f4d0: 3a20 760a 2020 2020 2020 2020 2020 2020  : v.            
+0000f4e0: 666f 7220 6b2c 2076 2069 6e20 6b77 6172  for k, v in kwar
+0000f4f0: 6773 2e69 7465 6d73 2829 0a20 2020 2020  gs.items().     
+0000f500: 2020 2020 2020 2069 6620 7620 6973 206e         if v is n
+0000f510: 6f74 204e 6f6e 6520 616e 6420 6b20 696e  ot None and k in
+0000f520: 2064 6566 6175 6c74 5f6f 6173 6973 5f73   default_oasis_s
+0000f530: 6574 7469 6e67 732e 6469 6374 2829 0a20  ettings.dict(). 
+0000f540: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000f550: 2023 2075 7064 6174 6520 7468 6520 7772   # update the wr
+0000f560: 6974 6520 7365 7474 696e 6773 2077 6974  ite settings wit
+0000f570: 6820 616e 7920 7365 7474 696e 6773 2065  h any settings e
+0000f580: 7870 6c69 6369 746c 7920 7061 7373 6564  xplicitly passed
+0000f590: 0a20 2020 2020 2020 2077 7269 7465 5f73  .        write_s
+0000f5a0: 6574 7469 6e67 7320 3d20 6465 6661 756c  ettings = defaul
+0000f5b0: 745f 7365 7474 696e 6773 2e63 6f70 7928  t_settings.copy(
+0000f5c0: 7570 6461 7465 3d65 7870 6c69 6369 745f  update=explicit_
+0000f5d0: 6764 735f 7365 7474 696e 6773 290a 2020  gds_settings).  
+0000f5e0: 2020 2020 2020 6f61 7369 735f 7365 7474        oasis_sett
+0000f5f0: 696e 6773 203d 2064 6566 6175 6c74 5f6f  ings = default_o
+0000f600: 6173 6973 5f73 6574 7469 6e67 732e 636f  asis_settings.co
+0000f610: 7079 2875 7064 6174 653d 6578 706c 6963  py(update=explic
+0000f620: 6974 5f6f 6173 5f73 6574 7469 6e67 7329  it_oas_settings)
+0000f630: 0a0a 2020 2020 2020 2020 5f63 6865 636b  ..        _check
+0000f640: 5f75 6e63 6163 6865 645f 636f 6d70 6f6e  _uncached_compon
+0000f650: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
+0000f660: 2020 636f 6d70 6f6e 656e 743d 7365 6c66    component=self
+0000f670: 2c20 6d6f 6465 3d77 7269 7465 5f73 6574  , mode=write_set
+0000f680: 7469 6e67 732e 6f6e 5f75 6e63 6163 6865  tings.on_uncache
+0000f690: 645f 636f 6d70 6f6e 656e 740a 2020 2020  d_component.    
+0000f6a0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+0000f6b0: 6620 7772 6974 655f 7365 7474 696e 6773  f write_settings
+0000f6c0: 2e66 6c61 7474 656e 5f69 6e76 616c 6964  .flatten_invalid
+0000f6d0: 5f72 6566 733a 0a20 2020 2020 2020 2020  _refs:.         
+0000f6e0: 2020 2074 6f70 5f63 656c 6c20 3d20 666c     top_cell = fl
+0000f6f0: 6174 7465 6e5f 696e 7661 6c69 645f 7265  atten_invalid_re
+0000f700: 6673 5f72 6563 7572 7369 7665 2873 656c  fs_recursive(sel
+0000f710: 6629 0a20 2020 2020 2020 2065 6c73 653a  f).        else:
+0000f720: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+0000f730: 5f63 656c 6c20 3d20 7365 6c66 0a0a 2020  _cell = self..  
+0000f740: 2020 2020 2020 6764 7364 6972 203d 2067        gdsdir = g
+0000f750: 6473 6469 7220 6f72 2047 4453 4449 525f  dsdir or GDSDIR_
+0000f760: 5445 4d50 0a20 2020 2020 2020 2067 6473  TEMP.        gds
+0000f770: 6469 7220 3d20 7061 7468 6c69 622e 5061  dir = pathlib.Pa
+0000f780: 7468 2867 6473 6469 7229 0a20 2020 2020  th(gdsdir).     
+0000f790: 2020 2069 6620 7769 7468 5f6f 6173 6973     if with_oasis
+0000f7a0: 3a0a 2020 2020 2020 2020 2020 2020 6764  :.            gd
+0000f7b0: 7370 6174 6820 3d20 6764 7370 6174 6820  spath = gdspath 
+0000f7c0: 6f72 2067 6473 6469 7220 2f20 6622 7b74  or gdsdir / f"{t
+0000f7d0: 6f70 5f63 656c 6c2e 6e61 6d65 7d2e 6f61  op_cell.name}.oa
+0000f7e0: 7322 0a20 2020 2020 2020 2065 6c73 653a  s".        else:
+0000f7f0: 0a20 2020 2020 2020 2020 2020 2067 6473  .            gds
+0000f800: 7061 7468 203d 2067 6473 7061 7468 206f  path = gdspath o
+0000f810: 7220 6764 7364 6972 202f 2066 227b 746f  r gdsdir / f"{to
+0000f820: 705f 6365 6c6c 2e6e 616d 657d 2e67 6473  p_cell.name}.gds
+0000f830: 220a 2020 2020 2020 2020 6764 7370 6174  ".        gdspat
+0000f840: 6820 3d20 7061 7468 6c69 622e 5061 7468  h = pathlib.Path
+0000f850: 2867 6473 7061 7468 290a 2020 2020 2020  (gdspath).      
+0000f860: 2020 6764 7364 6972 203d 2067 6473 7061    gdsdir = gdspa
+0000f870: 7468 2e70 6172 656e 740a 2020 2020 2020  th.parent.      
+0000f880: 2020 6764 7364 6972 2e6d 6b64 6972 2865    gdsdir.mkdir(e
+0000f890: 7869 7374 5f6f 6b3d 5472 7565 2c20 7061  xist_ok=True, pa
+0000f8a0: 7265 6e74 733d 5472 7565 290a 0a20 2020  rents=True)..   
+0000f8b0: 2020 2020 2063 656c 6c73 203d 2074 6f70       cells = top
+0000f8c0: 5f63 656c 6c2e 6765 745f 6465 7065 6e64  _cell.get_depend
+0000f8d0: 656e 6369 6573 2872 6563 7572 7369 7665  encies(recursive
+0000f8e0: 3d54 7275 6529 0a20 2020 2020 2020 2063  =True).        c
+0000f8f0: 656c 6c5f 6e61 6d65 7320 3d20 5b63 656c  ell_names = [cel
+0000f900: 6c2e 6e61 6d65 2066 6f72 2063 656c 6c20  l.name for cell 
+0000f910: 696e 206c 6973 7428 6365 6c6c 7329 5d0a  in list(cells)].
+0000f920: 2020 2020 2020 2020 6365 6c6c 5f6e 616d          cell_nam
+0000f930: 6573 5f75 6e69 7175 6520 3d20 7365 7428  es_unique = set(
+0000f940: 6365 6c6c 5f6e 616d 6573 290a 0a20 2020  cell_names)..   
+0000f950: 2020 2020 2069 6620 6c65 6e28 6365 6c6c       if len(cell
+0000f960: 5f6e 616d 6573 2920 213d 206c 656e 2873  _names) != len(s
+0000f970: 6574 2863 656c 6c5f 6e61 6d65 7329 293a  et(cell_names)):
+0000f980: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000f990: 2063 656c 6c5f 6e61 6d65 2069 6e20 6365   cell_name in ce
+0000f9a0: 6c6c 5f6e 616d 6573 5f75 6e69 7175 653a  ll_names_unique:
+0000f9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f9c0: 2063 656c 6c5f 6e61 6d65 732e 7265 6d6f   cell_names.remo
+0000f9d0: 7665 2863 656c 6c5f 6e61 6d65 290a 0a20  ve(cell_name).. 
+0000f9e0: 2020 2020 2020 2020 2020 2069 6620 7772             if wr
+0000f9f0: 6974 655f 7365 7474 696e 6773 2e6f 6e5f  ite_settings.on_
+0000fa00: 6475 706c 6963 6174 655f 6365 6c6c 203d  duplicate_cell =
+0000fa10: 3d20 2265 7272 6f72 223a 0a20 2020 2020  = "error":.     
+0000fa20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000fa30: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0000fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa50: 2066 2244 7570 6c69 6361 7465 6420 6365   f"Duplicated ce
+0000fa60: 6c6c 206e 616d 6573 2069 6e20 7b74 6f70  ll names in {top
+0000fa70: 5f63 656c 6c2e 6e61 6d65 2172 7d3a 207b  _cell.name!r}: {
+0000fa80: 6365 6c6c 5f6e 616d 6573 2172 7d22 0a20  cell_names!r}". 
+0000fa90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000faa0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000fab0: 6620 7772 6974 655f 7365 7474 696e 6773  f write_settings
+0000fac0: 2e6f 6e5f 6475 706c 6963 6174 655f 6365  .on_duplicate_ce
+0000fad0: 6c6c 2069 6e20 7b22 7761 726e 222c 2022  ll in {"warn", "
+0000fae0: 6f76 6572 7772 6974 6522 7d3a 0a20 2020  overwrite"}:.   
+0000faf0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000fb00: 7772 6974 655f 7365 7474 696e 6773 2e6f  write_settings.o
+0000fb10: 6e5f 6475 706c 6963 6174 655f 6365 6c6c  n_duplicate_cell
+0000fb20: 203d 3d20 2277 6172 6e22 3a0a 2020 2020   == "warn":.    
 0000fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb40: 2066 2244 7570 6c69 6361 7465 6420 6365   f"Duplicated ce
-0000fb50: 6c6c 206e 616d 6573 2069 6e20 7b74 6f70  ll names in {top
-0000fb60: 5f63 656c 6c2e 6e61 6d65 2172 7d3a 2020  _cell.name!r}:  
-0000fb70: 7b63 656c 6c5f 6e61 6d65 737d 222c 0a20  {cell_names}",. 
-0000fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb90: 2020 2020 2020 2073 7461 636b 6c65 7665         stackleve
-0000fba0: 6c3d 332c 0a20 2020 2020 2020 2020 2020  l=3,.           
-0000fbb0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000fbc0: 2020 2020 2020 2020 2020 2063 656c 6c73             cells
-0000fbd0: 5f64 6963 7420 3d20 7b63 656c 6c2e 6e61  _dict = {cell.na
-0000fbe0: 6d65 3a20 6365 6c6c 2e5f 6365 6c6c 2066  me: cell._cell f
-0000fbf0: 6f72 2063 656c 6c20 696e 2063 656c 6c73  or cell in cells
-0000fc00: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0000fc10: 2020 6365 6c6c 7320 3d20 6365 6c6c 735f    cells = cells_
-0000fc20: 6469 6374 2e76 616c 7565 7328 290a 2020  dict.values().  
-0000fc30: 2020 2020 2020 2020 2020 656c 6966 2077            elif w
-0000fc40: 7269 7465 5f73 6574 7469 6e67 732e 6f6e  rite_settings.on
-0000fc50: 5f64 7570 6c69 6361 7465 5f63 656c 6c20  _duplicate_cell 
-0000fc60: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000fc70: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000fc80: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fca0: 2020 2066 226f 6e5f 6475 706c 6963 6174     f"on_duplicat
-0000fcb0: 655f 6365 6c6c 3a20 7b77 7269 7465 5f73  e_cell: {write_s
-0000fcc0: 6574 7469 6e67 732e 6f6e 5f64 7570 6c69  ettings.on_dupli
-0000fcd0: 6361 7465 5f63 656c 6c21 727d 206e 6f74  cate_cell!r} not
-0000fce0: 2069 6e20 284e 6f6e 652c 2077 6172 6e2c   in (None, warn,
-0000fcf0: 2065 7272 6f72 2c20 6f76 6572 7772 6974   error, overwrit
-0000fd00: 6529 220a 2020 2020 2020 2020 2020 2020  e)".            
-0000fd10: 2020 2020 290a 0a20 2020 2020 2020 2061      )..        a
-0000fd20: 6c6c 5f63 656c 6c73 203d 205b 746f 705f  ll_cells = [top_
-0000fd30: 6365 6c6c 2e5f 6365 6c6c 5d20 2b20 736f  cell._cell] + so
-0000fd40: 7274 6564 2863 656c 6c73 2c20 6b65 793d  rted(cells, key=
-0000fd50: 6c61 6d62 6461 2063 633a 2063 632e 6e61  lambda cc: cc.na
-0000fd60: 6d65 290a 0a20 2020 2020 2020 206e 6f5f  me)..        no_
-0000fd70: 6e61 6d65 5f63 656c 6c73 203d 205b 0a20  name_cells = [. 
-0000fd80: 2020 2020 2020 2020 2020 2063 656c 6c2e             cell.
-0000fd90: 6e61 6d65 2066 6f72 2063 656c 6c20 696e  name for cell in
-0000fda0: 2061 6c6c 5f63 656c 6c73 2069 6620 6365   all_cells if ce
-0000fdb0: 6c6c 2e6e 616d 652e 7374 6172 7473 7769  ll.name.startswi
-0000fdc0: 7468 2822 556e 6e61 6d65 6422 290a 2020  th("Unnamed").  
-0000fdd0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-0000fde0: 2069 6620 6e6f 5f6e 616d 655f 6365 6c6c   if no_name_cell
-0000fdf0: 733a 0a20 2020 2020 2020 2020 2020 2077  s:.            w
-0000fe00: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-0000fe10: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000fe20: 436f 6d70 6f6e 656e 7420 7b74 6f70 5f63  Component {top_c
-0000fe30: 656c 6c2e 6e61 6d65 2172 7d20 636f 6e74  ell.name!r} cont
-0000fe40: 6169 6e73 207b 6c65 6e28 6e6f 5f6e 616d  ains {len(no_nam
-0000fe50: 655f 6365 6c6c 7329 7d20 556e 6e61 6d65  e_cells)} Unname
-0000fe60: 6420 6365 6c6c 7322 2c0a 2020 2020 2020  d cells",.      
-0000fe70: 2020 2020 2020 2020 2020 7374 6163 6b6c            stackl
-0000fe80: 6576 656c 3d33 2c0a 2020 2020 2020 2020  evel=3,.        
-0000fe90: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-0000fea0: 2066 6f72 2063 656c 6c20 696e 2061 6c6c   for cell in all
-0000feb0: 5f63 656c 6c73 3a0a 2020 2020 2020 2020  _cells:.        
-0000fec0: 2320 2020 2020 7072 696e 7428 6365 6c6c  #     print(cell
-0000fed0: 2e6e 616d 652c 2074 7970 6528 6365 6c6c  .name, type(cell
-0000fee0: 2929 0a0a 2020 2020 2020 2020 6c69 6220  ))..        lib 
-0000fef0: 3d20 6764 7374 6b2e 4c69 6272 6172 7928  = gdstk.Library(
-0000ff00: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
-0000ff10: 743d 7772 6974 655f 7365 7474 696e 6773  t=write_settings
-0000ff20: 2e75 6e69 742c 2070 7265 6369 7369 6f6e  .unit, precision
-0000ff30: 3d77 7269 7465 5f73 6574 7469 6e67 732e  =write_settings.
-0000ff40: 7072 6563 6973 696f 6e0a 2020 2020 2020  precision.      
-0000ff50: 2020 290a 2020 2020 2020 2020 6c69 622e    ).        lib.
-0000ff60: 6164 6428 746f 705f 6365 6c6c 2e5f 6365  add(top_cell._ce
-0000ff70: 6c6c 290a 2020 2020 2020 2020 6c69 622e  ll).        lib.
-0000ff80: 6164 6428 2a74 6f70 5f63 656c 6c2e 5f63  add(*top_cell._c
-0000ff90: 656c 6c2e 6465 7065 6e64 656e 6369 6573  ell.dependencies
-0000ffa0: 2854 7275 6529 290a 0a20 2020 2020 2020  (True))..       
-0000ffb0: 2069 6620 7769 7468 5f6f 6173 6973 3a0a   if with_oasis:.
-0000ffc0: 2020 2020 2020 2020 2020 2020 6c69 622e              lib.
-0000ffd0: 7772 6974 655f 6f61 7328 6764 7370 6174  write_oas(gdspat
-0000ffe0: 682c 202a 2a6f 6173 6973 5f73 6574 7469  h, **oasis_setti
-0000fff0: 6e67 732e 6469 6374 2829 290a 2020 2020  ngs.dict()).    
-00010000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00010010: 2020 2020 2020 6c69 622e 7772 6974 655f        lib.write_
-00010020: 6764 7328 0a20 2020 2020 2020 2020 2020  gds(.           
-00010030: 2020 2020 2067 6473 7061 7468 2c20 7469       gdspath, ti
-00010040: 6d65 7374 616d 703d 7469 6d65 7374 616d  mestamp=timestam
-00010050: 702c 206d 6178 5f70 6f69 6e74 733d 7772  p, max_points=wr
-00010060: 6974 655f 7365 7474 696e 6773 2e6d 6178  ite_settings.max
-00010070: 5f70 6f69 6e74 730a 2020 2020 2020 2020  _points.        
-00010080: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-00010090: 206c 6f67 6769 6e67 3a0a 2020 2020 2020   logging:.      
-000100a0: 2020 2020 2020 6c6f 6767 6572 2e69 6e66        logger.inf
-000100b0: 6f28 6622 5772 6f74 6520 746f 207b 7374  o(f"Wrote to {st
-000100c0: 7228 6764 7370 6174 6829 2172 7d22 290a  r(gdspath)!r}").
-000100d0: 2020 2020 2020 2020 6966 2077 6974 685f          if with_
-000100e0: 6d65 7461 6461 7461 3a0a 2020 2020 2020  metadata:.      
-000100f0: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
-00010100: 2067 6473 7061 7468 2e77 6974 685f 7375   gdspath.with_su
-00010110: 6666 6978 2822 2e79 6d6c 2229 0a20 2020  ffix(".yml").   
-00010120: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00010130: 612e 7772 6974 655f 7465 7874 2873 656c  a.write_text(sel
-00010140: 662e 746f 5f79 616d 6c28 7769 7468 5f63  f.to_yaml(with_c
-00010150: 656c 6c73 3d54 7275 652c 2077 6974 685f  ells=True, with_
-00010160: 706f 7274 733d 5472 7565 2929 0a20 2020  ports=True)).   
-00010170: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-00010180: 696e 666f 2866 2257 7269 7465 2059 414d  info(f"Write YAM
-00010190: 4c20 6d65 7461 6461 7461 2074 6f20 7b73  L metadata to {s
-000101a0: 7472 286d 6574 6164 6174 6129 2172 7d22  tr(metadata)!r}"
-000101b0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000101c0: 6e20 6764 7370 6174 680a 0a20 2020 2064  n gdspath..    d
-000101d0: 6566 2077 7269 7465 5f67 6473 280a 2020  ef write_gds(.  
-000101e0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000101f0: 2020 2020 6764 7370 6174 683a 204f 7074      gdspath: Opt
-00010200: 696f 6e61 6c5b 5061 7468 5479 7065 5d20  ional[PathType] 
-00010210: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00010220: 6764 7364 6972 3a20 4f70 7469 6f6e 616c  gdsdir: Optional
-00010230: 5b50 6174 6854 7970 655d 203d 204e 6f6e  [PathType] = Non
-00010240: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-00010250: 7267 732c 0a20 2020 2029 202d 3e20 5061  rgs,.    ) -> Pa
-00010260: 7468 3a0a 2020 2020 2020 2020 2222 2257  th:.        """W
-00010270: 7269 7465 2063 6f6d 706f 6e65 6e74 2074  rite component t
-00010280: 6f20 4744 5320 616e 6420 7265 7475 726e  o GDS and return
-00010290: 7320 6764 7370 6174 682e 0a0a 2020 2020  s gdspath...    
-000102a0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-000102b0: 2020 2020 2020 6764 7370 6174 683a 2047        gdspath: G
-000102c0: 4453 2066 696c 6520 7061 7468 2074 6f20  DS file path to 
-000102d0: 7772 6974 6520 746f 2e0a 2020 2020 2020  write to..      
-000102e0: 2020 2020 2020 6764 7364 6972 3a20 6469        gdsdir: di
-000102f0: 7265 6374 6f72 7920 666f 7220 7468 6520  rectory for the 
-00010300: 4744 5320 6669 6c65 2e20 4465 6661 756c  GDS file. Defaul
-00010310: 7473 2074 6f20 2f74 6d70 2f72 616e 646f  ts to /tmp/rando
-00010320: 6d46 696c 652f 6764 7366 6163 746f 7279  mFile/gdsfactory
-00010330: 2e0a 0a20 2020 2020 2020 204b 6579 776f  ...        Keywo
-00010340: 7264 2041 7267 733a 0a20 2020 2020 2020  rd Args:.       
-00010350: 2020 2020 2075 6e69 743a 2075 6e69 7420       unit: unit 
-00010360: 7369 7a65 2066 6f72 206f 626a 6563 7473  size for objects
-00010370: 2069 6e20 6c69 6272 6172 792e 2031 756d   in library. 1um
-00010380: 2062 7920 6465 6661 756c 742e 0a20 2020   by default..   
-00010390: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
-000103a0: 6f6e 3a20 666f 7220 6469 6d65 6e73 696f  on: for dimensio
-000103b0: 6e73 2069 6e20 7468 6520 6c69 6272 6172  ns in the librar
-000103c0: 7920 286d 292e 2031 6e6d 2062 7920 6465  y (m). 1nm by de
-000103d0: 6661 756c 742e 0a20 2020 2020 2020 2020  fault..         
-000103e0: 2020 206c 6f67 6769 6e67 3a20 6469 7361     logging: disa
-000103f0: 626c 6520 4744 5320 7061 7468 206c 6f67  ble GDS path log
-00010400: 6769 6e67 2c20 666f 7220 6578 616d 706c  ging, for exampl
-00010410: 6520 666f 7220 7368 6f77 696e 6720 6974  e for showing it
-00010420: 2069 6e20 4b4c 6179 6f75 742e 0a20 2020   in KLayout..   
-00010430: 2020 2020 2020 2020 206f 6e5f 6475 706c           on_dupl
-00010440: 6963 6174 655f 6365 6c6c 3a20 7370 6563  icate_cell: spec
-00010450: 6966 7920 686f 7720 746f 2072 6573 6f6c  ify how to resol
-00010460: 7665 2064 7570 6c69 6361 7465 2d6e 616d  ve duplicate-nam
-00010470: 6564 2063 656c 6c73 2e20 4368 6f6f 7365  ed cells. Choose
-00010480: 206f 6e65 206f 6620 7468 6520 666f 6c6c   one of the foll
-00010490: 6f77 696e 673a 0a20 2020 2020 2020 2020  owing:.         
-000104a0: 2020 2020 2020 2022 7761 726e 2220 2864         "warn" (d
-000104b0: 6566 6175 6c74 293a 206f 7665 7277 7269  efault): overwri
-000104c0: 7465 2061 6c6c 2064 7570 6c69 6361 7465  te all duplicate
-000104d0: 2063 656c 6c73 2077 6974 6820 6f6e 6520   cells with one 
-000104e0: 6f66 2074 6865 2064 7570 6c69 6361 7465  of the duplicate
-000104f0: 7320 2861 7262 6974 7261 7269 6c79 292e  s (arbitrarily).
-00010500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010510: 2022 6572 726f 7222 3a20 7468 726f 7720   "error": throw 
-00010520: 6120 5661 6c75 6545 7272 6f72 2077 6865  a ValueError whe
-00010530: 6e20 6174 7465 6d70 7469 6e67 2074 6f20  n attempting to 
-00010540: 7772 6974 6520 6120 6764 7320 7769 7468  write a gds with
-00010550: 2064 7570 6c69 6361 7465 2063 656c 6c73   duplicate cells
-00010560: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010570: 2020 226f 7665 7277 7269 7465 223a 206f    "overwrite": o
-00010580: 7665 7277 7269 7465 2061 6c6c 2064 7570  verwrite all dup
-00010590: 6c69 6361 7465 2063 656c 6c73 2077 6974  licate cells wit
-000105a0: 6820 6f6e 6520 6f66 2074 6865 2064 7570  h one of the dup
-000105b0: 6c69 6361 7465 732c 2077 6974 686f 7574  licates, without
-000105c0: 2077 6172 6e69 6e67 2e0a 2020 2020 2020   warning..      
-000105d0: 2020 2020 2020 6f6e 5f75 6e63 6163 6865        on_uncache
-000105e0: 645f 636f 6d70 6f6e 656e 743a 204c 6974  d_component: Lit
-000105f0: 6572 616c 5b22 7761 726e 222c 2022 6572  eral["warn", "er
-00010600: 726f 7222 5d20 3d20 2277 6172 6e22 0a20  ror"] = "warn". 
-00010610: 2020 2020 2020 2020 2020 2066 6c61 7474             flatt
-00010620: 656e 5f69 6e76 616c 6964 5f72 6566 733a  en_invalid_refs:
-00010630: 2066 6c61 7474 656e 7320 636f 6d70 6f6e   flattens compon
-00010640: 656e 7420 7265 6665 7265 6e63 6573 2077  ent references w
-00010650: 6869 6368 2068 6176 6520 696e 7661 6c69  hich have invali
-00010660: 6420 7472 616e 7366 6f72 6d61 7469 6f6e  d transformation
-00010670: 732e 0a20 2020 2020 2020 2020 2020 206d  s..            m
-00010680: 6178 5f70 6f69 6e74 733a 204d 6178 696d  ax_points: Maxim
-00010690: 616c 206e 756d 6265 7220 6f66 2076 6572  al number of ver
-000106a0: 7469 6365 7320 7065 7220 706f 6c79 676f  tices per polygo
-000106b0: 6e2e 0a20 2020 2020 2020 2020 2020 2020  n..             
-000106c0: 2020 2050 6f6c 7967 6f6e 7320 7769 7468     Polygons with
-000106d0: 206d 6f72 6520 7665 7274 6963 6573 2074   more vertices t
-000106e0: 6861 7420 7468 6973 2061 7265 2061 7574  hat this are aut
-000106f0: 6f6d 6174 6963 616c 6c79 2066 7261 6374  omatically fract
-00010700: 7572 6564 2e0a 2020 2020 2020 2020 2020  ured..          
-00010710: 2020 7769 7468 5f6d 6574 6164 6174 613a    with_metadata:
-00010720: 2077 7269 7465 7320 6d65 7461 6461 7461   writes metadata
-00010730: 2069 6e20 5941 4d4c 2066 6f72 6d61 742e   in YAML format.
-00010740: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00010750: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00010760: 662e 5f77 7269 7465 5f6c 6962 7261 7279  f._write_library
-00010770: 280a 2020 2020 2020 2020 2020 2020 6764  (.            gd
-00010780: 7370 6174 683d 6764 7370 6174 682c 2067  spath=gdspath, g
-00010790: 6473 6469 723d 6764 7364 6972 2c20 7769  dsdir=gdsdir, wi
-000107a0: 7468 5f6f 6173 6973 3d46 616c 7365 2c20  th_oasis=False, 
-000107b0: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
-000107c0: 2029 0a0a 2020 2020 6465 6620 7772 6974   )..    def writ
-000107d0: 655f 6f61 7328 0a20 2020 2020 2020 2073  e_oas(.        s
-000107e0: 656c 662c 0a20 2020 2020 2020 2067 6473  elf,.        gds
-000107f0: 7061 7468 3a20 4f70 7469 6f6e 616c 5b50  path: Optional[P
-00010800: 6174 6854 7970 655d 203d 204e 6f6e 652c  athType] = None,
-00010810: 0a20 2020 2020 2020 2067 6473 6469 723a  .        gdsdir:
-00010820: 204f 7074 696f 6e61 6c5b 5061 7468 5479   Optional[PathTy
-00010830: 7065 5d20 3d20 4e6f 6e65 2c0a 2020 2020  pe] = None,.    
-00010840: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-00010850: 2020 2920 2d3e 2050 6174 683a 0a20 2020    ) -> Path:.   
-00010860: 2020 2020 2022 2222 5772 6974 6520 636f       """Write co
-00010870: 6d70 6f6e 656e 7420 746f 2047 4453 2061  mponent to GDS a
-00010880: 6e64 2072 6574 7572 6e73 2067 6473 7061  nd returns gdspa
-00010890: 7468 2e0a 0a20 2020 2020 2020 2041 7267  th...        Arg
-000108a0: 733a 0a20 2020 2020 2020 2020 2020 2067  s:.            g
-000108b0: 6473 7061 7468 3a20 4744 5320 6669 6c65  dspath: GDS file
-000108c0: 2070 6174 6820 746f 2077 7269 7465 2074   path to write t
-000108d0: 6f2e 0a20 2020 2020 2020 2020 2020 2067  o..            g
-000108e0: 6473 6469 723a 2064 6972 6563 746f 7279  dsdir: directory
-000108f0: 2066 6f72 2074 6865 2047 4453 2066 696c   for the GDS fil
-00010900: 652e 2044 6566 6175 6c74 7320 746f 202f  e. Defaults to /
-00010910: 746d 702f 7261 6e64 6f6d 4669 6c65 2f67  tmp/randomFile/g
-00010920: 6473 6661 6374 6f72 792e 0a0a 2020 2020  dsfactory...    
-00010930: 2020 2020 4b65 7977 6f72 6420 4172 6773      Keyword Args
-00010940: 3a0a 2020 2020 2020 2020 2020 2020 756e  :.            un
-00010950: 6974 3a20 756e 6974 2073 697a 6520 666f  it: unit size fo
-00010960: 7220 6f62 6a65 6374 7320 696e 206c 6962  r objects in lib
-00010970: 7261 7279 2e20 3175 6d20 6279 2064 6566  rary. 1um by def
-00010980: 6175 6c74 2e0a 2020 2020 2020 2020 2020  ault..          
-00010990: 2020 7072 6563 6973 696f 6e3a 2066 6f72    precision: for
-000109a0: 2064 696d 656e 7369 6f6e 7320 696e 2074   dimensions in t
-000109b0: 6865 206c 6962 7261 7279 2028 6d29 2e20  he library (m). 
-000109c0: 316e 6d20 6279 2064 6566 6175 6c74 2e0a  1nm by default..
-000109d0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-000109e0: 696e 673a 2064 6973 6162 6c65 2047 4453  ing: disable GDS
-000109f0: 2070 6174 6820 6c6f 6767 696e 672c 2066   path logging, f
-00010a00: 6f72 2065 7861 6d70 6c65 2066 6f72 2073  or example for s
-00010a10: 686f 7769 6e67 2069 7420 696e 204b 4c61  howing it in KLa
-00010a20: 796f 7574 2e0a 2020 2020 2020 2020 2020  yout..          
-00010a30: 2020 6f6e 5f64 7570 6c69 6361 7465 5f63    on_duplicate_c
-00010a40: 656c 6c3a 2073 7065 6369 6679 2068 6f77  ell: specify how
-00010a50: 2074 6f20 7265 736f 6c76 6520 6475 706c   to resolve dupl
-00010a60: 6963 6174 652d 6e61 6d65 6420 6365 6c6c  icate-named cell
-00010a70: 732e 2043 686f 6f73 6520 6f6e 6520 6f66  s. Choose one of
-00010a80: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a0a   the following:.
-00010a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010aa0: 2277 6172 6e22 2028 6465 6661 756c 7429  "warn" (default)
-00010ab0: 3a20 6f76 6572 7772 6974 6520 616c 6c20  : overwrite all 
-00010ac0: 6475 706c 6963 6174 6520 6365 6c6c 7320  duplicate cells 
-00010ad0: 7769 7468 206f 6e65 206f 6620 7468 6520  with one of the 
-00010ae0: 6475 706c 6963 6174 6573 2028 6172 6269  duplicates (arbi
-00010af0: 7472 6172 696c 7929 2e0a 2020 2020 2020  trarily)..      
-00010b00: 2020 2020 2020 2020 2020 2265 7272 6f72            "error
-00010b10: 223a 2074 6872 6f77 2061 2056 616c 7565  ": throw a Value
-00010b20: 4572 726f 7220 7768 656e 2061 7474 656d  Error when attem
-00010b30: 7074 696e 6720 746f 2077 7269 7465 2061  pting to write a
-00010b40: 2067 6473 2077 6974 6820 6475 706c 6963   gds with duplic
-00010b50: 6174 6520 6365 6c6c 732e 0a20 2020 2020  ate cells..     
-00010b60: 2020 2020 2020 2020 2020 2022 6f76 6572             "over
-00010b70: 7772 6974 6522 3a20 6f76 6572 7772 6974  write": overwrit
-00010b80: 6520 616c 6c20 6475 706c 6963 6174 6520  e all duplicate 
-00010b90: 6365 6c6c 7320 7769 7468 206f 6e65 206f  cells with one o
-00010ba0: 6620 7468 6520 6475 706c 6963 6174 6573  f the duplicates
-00010bb0: 2c20 7769 7468 6f75 7420 7761 726e 696e  , without warnin
-00010bc0: 672e 0a20 2020 2020 2020 2020 2020 2020  g..             
-00010bd0: 2020 204e 6f6e 653a 2064 6f20 6e6f 7420     None: do not 
-00010be0: 7472 7920 746f 2072 6573 6f6c 7665 2028  try to resolve (
-00010bf0: 6174 2079 6f75 7220 6f77 6e20 7269 736b  at your own risk
-00010c00: 2129 0a20 2020 2020 2020 2020 2020 206f  !).            o
-00010c10: 6e5f 756e 6361 6368 6564 5f63 6f6d 706f  n_uncached_compo
-00010c20: 6e65 6e74 3a20 4c69 7465 7261 6c5b 2277  nent: Literal["w
-00010c30: 6172 6e22 2c20 2265 7272 6f72 225d 203d  arn", "error"] =
-00010c40: 2022 7761 726e 220a 2020 2020 2020 2020   "warn".        
-00010c50: 2020 2020 666c 6174 7465 6e5f 696e 7661      flatten_inva
-00010c60: 6c69 645f 7265 6673 3a20 666c 6174 7465  lid_refs: flatte
-00010c70: 6e73 2063 6f6d 706f 6e65 6e74 2072 6566  ns component ref
-00010c80: 6572 656e 6365 7320 7768 6963 6820 6861  erences which ha
-00010c90: 7665 2069 6e76 616c 6964 2074 7261 6e73  ve invalid trans
-00010ca0: 666f 726d 6174 696f 6e73 2e0a 2020 2020  formations..    
-00010cb0: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
-00010cc0: 696f 6e5f 6c65 7665 6c3a 204c 6576 656c  ion_level: Level
-00010cd0: 206f 6620 636f 6d70 7265 7373 696f 6e20   of compression 
-00010ce0: 666f 7220 6365 6c6c 7320 2862 6574 7765  for cells (betwe
-00010cf0: 656e 2030 2061 6e64 2039 292e 0a20 2020  en 0 and 9)..   
-00010d00: 2020 2020 2020 2020 2020 2020 2053 6574               Set
-00010d10: 7469 6e67 2074 6f20 3020 7769 6c6c 2064  ting to 0 will d
-00010d20: 6973 6162 6c65 2063 656c 6c20 636f 6d70  isable cell comp
-00010d30: 7265 7373 696f 6e2c 2031 2067 6976 6573  ression, 1 gives
-00010d40: 2074 6865 2062 6573 7420 7370 6565 6420   the best speed 
-00010d50: 616e 6420 392c 2074 6865 2062 6573 7420  and 9, the best 
-00010d60: 636f 6d70 7265 7373 696f 6e2e 0a20 2020  compression..   
-00010d70: 2020 2020 2020 2020 2064 6574 6563 745f           detect_
-00010d80: 7265 6374 616e 676c 6573 3a20 5374 6f72  rectangles: Stor
-00010d90: 6520 7265 6374 616e 676c 6573 2069 6e20  e rectangles in 
-00010da0: 636f 6d70 7265 7373 6564 2066 6f72 6d61  compressed forma
-00010db0: 742e 0a20 2020 2020 2020 2020 2020 2064  t..            d
-00010dc0: 6574 6563 745f 7472 6170 657a 6f69 6473  etect_trapezoids
-00010dd0: 3a20 5374 6f72 6520 7472 6170 657a 6f69  : Store trapezoi
-00010de0: 6473 2069 6e20 636f 6d70 7265 7373 6564  ds in compressed
-00010df0: 2066 6f72 6d61 742e 0a20 2020 2020 2020   format..       
-00010e00: 2020 2020 2063 6972 636c 655f 746f 6c65       circle_tole
-00010e10: 7261 6e63 653a 2054 6f6c 6572 616e 6365  rance: Tolerance
-00010e20: 2066 6f72 2064 6574 6563 7469 6e67 2063   for detecting c
-00010e30: 6972 636c 6573 2e20 4966 206c 6573 7320  ircles. If less 
-00010e40: 6f72 2065 7175 616c 2074 6f20 302c 206e  or equal to 0, n
-00010e50: 6f20 6465 7465 6374 696f 6e20 6973 2070  o detection is p
-00010e60: 6572 666f 726d 6564 2e0a 2020 2020 2020  erformed..      
-00010e70: 2020 2020 2020 2020 2020 4369 7263 6c65            Circle
-00010e80: 7320 6172 6520 7374 6f72 6564 2069 6e20  s are stored in 
-00010e90: 636f 6d70 7265 7373 6564 2066 6f72 6d61  compressed forma
-00010ea0: 742e 0a20 2020 2020 2020 2020 2020 2076  t..            v
-00010eb0: 616c 6964 6174 696f 6e20 2822 6372 6333  alidation ("crc3
-00010ec0: 3222 2c20 2263 6865 636b 7375 6d33 3222  2", "checksum32"
-00010ed0: 2c20 4e6f 6e65 2920 e280 9320 7479 7065  , None) ... type
-00010ee0: 206f 6620 7661 6c69 6461 7469 6f6e 2074   of validation t
-00010ef0: 6f20 696e 636c 7564 6520 696e 2074 6865  o include in the
-00010f00: 2073 6176 6564 2066 696c 652e 0a20 2020   saved file..   
-00010f10: 2020 2020 2020 2020 2073 7461 6e64 6172           standar
-00010f20: 645f 7072 6f70 6572 7469 6573 3a20 5374  d_properties: St
-00010f30: 6f72 6520 7374 616e 6461 7264 204f 4153  ore standard OAS
-00010f40: 4953 2070 726f 7065 7274 6965 7320 696e  IS properties in
-00010f50: 2074 6865 2066 696c 652e 0a20 2020 2020   the file..     
-00010f60: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00010f70: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
-00010f80: 655f 6c69 6272 6172 7928 0a20 2020 2020  e_library(.     
-00010f90: 2020 2020 2020 2067 6473 7061 7468 3d67         gdspath=g
-00010fa0: 6473 7061 7468 2c0a 2020 2020 2020 2020  dspath,.        
-00010fb0: 2020 2020 6764 7364 6972 3d67 6473 6469      gdsdir=gdsdi
-00010fc0: 722c 0a20 2020 2020 2020 2020 2020 2077  r,.            w
-00010fd0: 6974 685f 6f61 7369 733d 5472 7565 2c0a  ith_oasis=True,.
-00010fe0: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
-00010ff0: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
-00011000: 0a20 2020 2064 6566 2077 7269 7465 5f67  .    def write_g
-00011010: 6473 5f77 6974 685f 6d65 7461 6461 7461  ds_with_metadata
-00011020: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-00011030: 6b77 6172 6773 2920 2d3e 2050 6174 683a  kwargs) -> Path:
-00011040: 0a20 2020 2020 2020 2022 2222 5772 6974  .        """Writ
-00011050: 6520 636f 6d70 6f6e 656e 7420 696e 2047  e component in G
-00011060: 4453 2061 6e64 206d 6574 6164 6174 6120  DS and metadata 
-00011070: 2863 6f6d 706f 6e65 6e74 2073 6574 7469  (component setti
-00011080: 6e67 7329 2069 6e20 5941 4d4c 2e22 2222  ngs) in YAML."""
-00011090: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
-000110a0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-000110b0: 2020 2020 2243 6f6d 706f 6e65 6e74 2e77      "Component.w
-000110c0: 7269 7465 5f67 6473 5f77 6974 685f 6d65  rite_gds_with_me
-000110d0: 7461 6461 7461 2829 2069 7320 6465 7072  tadata() is depr
-000110e0: 6563 6174 6564 2e20 220a 2020 2020 2020  ecated. ".      
-000110f0: 2020 2020 2020 2255 7365 2043 6f6d 706f        "Use Compo
-00011100: 6e65 6e74 2e77 7269 7465 5f67 6473 2877  nent.write_gds(w
-00011110: 6974 685f 6d65 7461 6461 7461 3d54 7275  ith_metadata=Tru
-00011120: 6529 206f 7220 436f 6d70 6f6e 656e 742e  e) or Component.
-00011130: 7772 6974 655f 6f61 7328 7769 7468 5f6d  write_oas(with_m
-00011140: 6574 6164 6174 613d 5472 7565 292e 222c  etadata=True).",
-00011150: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00011160: 636b 6c65 7665 6c3d 332c 0a20 2020 2020  cklevel=3,.     
-00011170: 2020 2029 0a20 2020 2020 2020 2067 6473     ).        gds
-00011180: 7061 7468 203d 2073 656c 662e 7772 6974  path = self.writ
-00011190: 655f 6764 7328 2a61 7267 732c 202a 2a6b  e_gds(*args, **k
-000111a0: 7761 7267 7329 0a20 2020 2020 2020 206d  wargs).        m
-000111b0: 6574 6164 6174 6120 3d20 6764 7370 6174  etadata = gdspat
-000111c0: 682e 7769 7468 5f73 7566 6669 7828 222e  h.with_suffix(".
-000111d0: 796d 6c22 290a 2020 2020 2020 2020 6d65  yml").        me
-000111e0: 7461 6461 7461 2e77 7269 7465 5f74 6578  tadata.write_tex
-000111f0: 7428 7365 6c66 2e74 6f5f 7961 6d6c 2877  t(self.to_yaml(w
-00011200: 6974 685f 6365 6c6c 733d 5472 7565 2c20  ith_cells=True, 
-00011210: 7769 7468 5f70 6f72 7473 3d54 7275 6529  with_ports=True)
-00011220: 290a 2020 2020 2020 2020 6c6f 6767 6572  ).        logger
-00011230: 2e69 6e66 6f28 6622 5772 6974 6520 5941  .info(f"Write YA
-00011240: 4d4c 206d 6574 6164 6174 6120 746f 207b  ML metadata to {
-00011250: 7374 7228 6d65 7461 6461 7461 2921 727d  str(metadata)!r}
-00011260: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-00011270: 6e20 6764 7370 6174 680a 0a20 2020 2064  n gdspath..    d
-00011280: 6566 2074 6f5f 6469 6374 280a 2020 2020  ef to_dict(.    
-00011290: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000112a0: 2020 6967 6e6f 7265 5f63 6f6d 706f 6e65    ignore_compone
-000112b0: 6e74 735f 7072 6566 6978 3a20 4f70 7469  nts_prefix: Opti
-000112c0: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
-000112d0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000112e0: 6967 6e6f 7265 5f66 756e 6374 696f 6e73  ignore_functions
-000112f0: 5f70 7265 6669 783a 204f 7074 696f 6e61  _prefix: Optiona
-00011300: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
-00011310: 6f6e 652c 0a20 2020 2020 2020 2077 6974  one,.        wit
-00011320: 685f 6365 6c6c 733a 2062 6f6f 6c20 3d20  h_cells: bool = 
-00011330: 4661 6c73 652c 0a20 2020 2020 2020 2077  False,.        w
-00011340: 6974 685f 706f 7274 733a 2062 6f6f 6c20  ith_ports: bool 
-00011350: 3d20 5472 7565 2c0a 2020 2020 2920 2d3e  = True,.    ) ->
-00011360: 2044 6963 745b 7374 722c 2041 6e79 5d3a   Dict[str, Any]:
-00011370: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00011380: 726e 7320 4469 6374 2072 6570 7265 7365  rns Dict represe
-00011390: 6e74 6174 696f 6e20 6f66 2061 2063 6f6d  ntation of a com
-000113a0: 706f 6e65 6e74 2e0a 0a20 2020 2020 2020  ponent...       
-000113b0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-000113c0: 2020 2069 676e 6f72 655f 636f 6d70 6f6e     ignore_compon
-000113d0: 656e 7473 5f70 7265 6669 783a 2066 6f72  ents_prefix: for
-000113e0: 2063 6f6d 706f 6e65 6e74 7320 746f 2069   components to i
-000113f0: 676e 6f72 6520 7768 656e 2065 7870 6f72  gnore when expor
-00011400: 7469 6e67 2e0a 2020 2020 2020 2020 2020  ting..          
-00011410: 2020 6967 6e6f 7265 5f66 756e 6374 696f    ignore_functio
-00011420: 6e73 5f70 7265 6669 783a 2066 6f72 2066  ns_prefix: for f
-00011430: 756e 6374 696f 6e73 2074 6f20 6967 6e6f  unctions to igno
-00011440: 7265 2077 6865 6e20 6578 706f 7274 696e  re when exportin
-00011450: 672e 0a20 2020 2020 2020 2020 2020 2077  g..            w
-00011460: 6974 685f 6365 6c6c 733a 2077 7269 7465  ith_cells: write
-00011470: 2063 656c 6c73 2072 6563 7572 7369 7665   cells recursive
-00011480: 6c79 2e0a 2020 2020 2020 2020 2020 2020  ly..            
-00011490: 7769 7468 5f70 6f72 7473 3a20 7772 6974  with_ports: writ
-000114a0: 6520 706f 7274 2069 6e66 6f72 6d61 7469  e port informati
-000114b0: 6f6e 2064 6963 742e 0a20 2020 2020 2020  on dict..       
-000114c0: 2022 2222 0a20 2020 2020 2020 2064 203d   """.        d =
-000114d0: 207b 7d0a 2020 2020 2020 2020 6966 2077   {}.        if w
-000114e0: 6974 685f 706f 7274 733a 0a20 2020 2020  ith_ports:.     
-000114f0: 2020 2020 2020 2070 6f72 7473 203d 207b         ports = {
-00011500: 706f 7274 2e6e 616d 653a 2070 6f72 742e  port.name: port.
-00011510: 746f 5f64 6963 7428 2920 666f 7220 706f  to_dict() for po
-00011520: 7274 2069 6e20 7365 6c66 2e67 6574 5f70  rt in self.get_p
-00011530: 6f72 7473 5f6c 6973 7428 297d 0a20 2020  orts_list()}.   
-00011540: 2020 2020 2020 2020 2064 5b22 706f 7274           d["port
-00011550: 7322 5d20 3d20 706f 7274 730a 0a20 2020  s"] = ports..   
-00011560: 2020 2020 2069 6620 7769 7468 5f63 656c       if with_cel
-00011570: 6c73 3a0a 2020 2020 2020 2020 2020 2020  ls:.            
-00011580: 6365 6c6c 7320 3d20 7265 6375 7273 655f  cells = recurse_
-00011590: 7374 7275 6374 7572 6573 280a 2020 2020  structures(.    
-000115a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000115b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000115c0: 2020 6967 6e6f 7265 5f66 756e 6374 696f    ignore_functio
-000115d0: 6e73 5f70 7265 6669 783d 6967 6e6f 7265  ns_prefix=ignore
-000115e0: 5f66 756e 6374 696f 6e73 5f70 7265 6669  _functions_prefi
-000115f0: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-00011600: 2020 2069 676e 6f72 655f 636f 6d70 6f6e     ignore_compon
-00011610: 656e 7473 5f70 7265 6669 783d 6967 6e6f  ents_prefix=igno
-00011620: 7265 5f63 6f6d 706f 6e65 6e74 735f 7072  re_components_pr
-00011630: 6566 6978 2c0a 2020 2020 2020 2020 2020  efix,.          
-00011640: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00011650: 645b 2263 656c 6c73 225d 203d 2063 6c65  d["cells"] = cle
-00011660: 616e 5f64 6963 7428 6365 6c6c 7329 0a0a  an_dict(cells)..
-00011670: 2020 2020 2020 2020 645b 226e 616d 6522          d["name"
-00011680: 5d20 3d20 7365 6c66 2e6e 616d 650a 2020  ] = self.name.  
-00011690: 2020 2020 2020 645b 2273 6574 7469 6e67        d["setting
-000116a0: 7322 5d20 3d20 636c 6561 6e5f 6469 6374  s"] = clean_dict
-000116b0: 2864 6963 7428 7365 6c66 2e73 6574 7469  (dict(self.setti
-000116c0: 6e67 7329 290a 2020 2020 2020 2020 7265  ngs)).        re
-000116d0: 7475 726e 2064 0a0a 2020 2020 6465 6620  turn d..    def 
-000116e0: 746f 5f79 616d 6c28 7365 6c66 2c20 2a2a  to_yaml(self, **
-000116f0: 6b77 6172 6773 2920 2d3e 2073 7472 3a0a  kwargs) -> str:.
-00011700: 2020 2020 2020 2020 2222 2257 7269 7465          """Write
-00011710: 2044 6963 7420 7265 7072 6573 656e 7461   Dict representa
-00011720: 7469 6f6e 206f 6620 6120 636f 6d70 6f6e  tion of a compon
-00011730: 656e 7420 696e 2059 414d 4c20 666f 726d  ent in YAML form
-00011740: 6174 2e0a 0a20 2020 2020 2020 2041 7267  at...        Arg
-00011750: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00011760: 676e 6f72 655f 636f 6d70 6f6e 656e 7473  gnore_components
-00011770: 5f70 7265 6669 783a 2066 6f72 2063 6f6d  _prefix: for com
-00011780: 706f 6e65 6e74 7320 746f 2069 676e 6f72  ponents to ignor
-00011790: 6520 7768 656e 2065 7870 6f72 7469 6e67  e when exporting
-000117a0: 2e0a 2020 2020 2020 2020 2020 2020 6967  ..            ig
-000117b0: 6e6f 7265 5f66 756e 6374 696f 6e73 5f70  nore_functions_p
-000117c0: 7265 6669 783a 2066 6f72 2066 756e 6374  refix: for funct
-000117d0: 696f 6e73 2074 6f20 6967 6e6f 7265 2077  ions to ignore w
-000117e0: 6865 6e20 6578 706f 7274 696e 672e 0a20  hen exporting.. 
-000117f0: 2020 2020 2020 2020 2020 2077 6974 685f             with_
-00011800: 6365 6c6c 733a 2077 7269 7465 2063 656c  cells: write cel
-00011810: 6c73 2072 6563 7572 7369 7665 6c79 2e0a  ls recursively..
-00011820: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00011830: 5f70 6f72 7473 3a20 7772 6974 6520 706f  _ports: write po
-00011840: 7274 2069 6e66 6f72 6d61 7469 6f6e 2e0a  rt information..
-00011850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00011860: 2020 2020 7265 7475 726e 204f 6d65 6761      return Omega
-00011870: 436f 6e66 2e74 6f5f 7961 6d6c 2863 6c65  Conf.to_yaml(cle
-00011880: 616e 5f64 6963 7428 7365 6c66 2e74 6f5f  an_dict(self.to_
-00011890: 6469 6374 282a 2a6b 7761 7267 7329 2929  dict(**kwargs)))
-000118a0: 0a0a 2020 2020 6465 6620 746f 5f64 6963  ..    def to_dic
-000118b0: 745f 706f 6c79 676f 6e73 2873 656c 6629  t_polygons(self)
-000118c0: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
-000118d0: 795d 3a0a 2020 2020 2020 2020 2222 2252  y]:.        """R
-000118e0: 6574 7572 6e73 2061 2064 6963 7420 7265  eturns a dict re
-000118f0: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-00011900: 7468 6520 666c 6174 7465 6e65 6420 636f  the flattened co
-00011910: 6d70 6f6e 656e 742e 2222 220a 2020 2020  mponent.""".    
-00011920: 2020 2020 6420 3d20 7b7d 0a20 2020 2020      d = {}.     
-00011930: 2020 2070 6f6c 7967 6f6e 7320 3d20 7b7d     polygons = {}
-00011940: 0a20 2020 2020 2020 206c 6179 6572 5f74  .        layer_t
-00011950: 6f5f 706f 6c79 676f 6e73 203d 2073 656c  o_polygons = sel
-00011960: 662e 6765 745f 706f 6c79 676f 6e73 2862  f.get_polygons(b
-00011970: 795f 7370 6563 3d54 7275 6529 0a0a 2020  y_spec=True)..  
-00011980: 2020 2020 2020 666f 7220 6c61 7965 722c        for layer,
-00011990: 2070 6f6c 7967 6f6e 735f 6c61 7965 7220   polygons_layer 
-000119a0: 696e 206c 6179 6572 5f74 6f5f 706f 6c79  in layer_to_poly
-000119b0: 676f 6e73 2e69 7465 6d73 2829 3a0a 2020  gons.items():.  
-000119c0: 2020 2020 2020 2020 2020 6c61 7965 725f            layer_
-000119d0: 6e61 6d65 203d 2066 227b 6c61 7965 725b  name = f"{layer[
-000119e0: 305d 7d5f 7b6c 6179 6572 5b31 5d7d 220a  0]}_{layer[1]}".
-000119f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00011a00: 706f 6c79 676f 6e20 696e 2070 6f6c 7967  polygon in polyg
-00011a10: 6f6e 735f 6c61 7965 723a 0a20 2020 2020  ons_layer:.     
-00011a20: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-00011a30: 6f6e 735b 6c61 7965 725f 6e61 6d65 5d20  ons[layer_name] 
-00011a40: 3d20 5b74 7570 6c65 2873 6e61 705f 746f  = [tuple(snap_to
-00011a50: 5f67 7269 6428 7629 2920 666f 7220 7620  _grid(v)) for v 
-00011a60: 696e 2070 6f6c 7967 6f6e 5d0a 0a20 2020  in polygon]..   
-00011a70: 2020 2020 2070 6f72 7473 203d 207b 706f       ports = {po
-00011a80: 7274 2e6e 616d 653a 2070 6f72 742e 7365  rt.name: port.se
-00011a90: 7474 696e 6773 2066 6f72 2070 6f72 7420  ttings for port 
-00011aa0: 696e 2073 656c 662e 6765 745f 706f 7274  in self.get_port
-00011ab0: 735f 6c69 7374 2829 7d0a 2020 2020 2020  s_list()}.      
-00011ac0: 2020 636c 6561 6e5f 6469 6374 2870 6f72    clean_dict(por
-00011ad0: 7473 290a 2020 2020 2020 2020 636c 6561  ts).        clea
-00011ae0: 6e5f 6469 6374 2870 6f6c 7967 6f6e 7329  n_dict(polygons)
-00011af0: 0a20 2020 2020 2020 2064 2e69 6e66 6f20  .        d.info 
-00011b00: 3d20 7365 6c66 2e69 6e66 6f0a 2020 2020  = self.info.    
-00011b10: 2020 2020 642e 706f 6c79 676f 6e73 203d      d.polygons =
-00011b20: 2070 6f6c 7967 6f6e 730a 2020 2020 2020   polygons.      
-00011b30: 2020 642e 706f 7274 7320 3d20 706f 7274    d.ports = port
-00011b40: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
-00011b50: 2064 0a0a 2020 2020 6465 6620 6175 746f   d..    def auto
-00011b60: 5f72 656e 616d 655f 706f 7274 7328 7365  _rename_ports(se
-00011b70: 6c66 2c20 2a2a 6b77 6172 6773 2920 2d3e  lf, **kwargs) ->
-00011b80: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-00011b90: 2222 5265 6e61 6d65 2070 6f72 7473 2062  ""Rename ports b
-00011ba0: 7920 6f72 6965 6e74 6174 696f 6e20 4e53  y orientation NS
-00011bb0: 4557 2028 6e6f 7274 682c 2073 6f75 7468  EW (north, south
-00011bc0: 2c20 6561 7374 2c20 7765 7374 292e 0a0a  , east, west)...
-00011bd0: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
-00011be0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00011bf0: 2020 6675 6e63 7469 6f6e 3a20 746f 2072    function: to r
-00011c00: 656e 616d 6520 706f 7274 732e 0a20 2020  ename ports..   
-00011c10: 2020 2020 2020 2020 2073 656c 6563 745f           select_
-00011c20: 706f 7274 735f 6f70 7469 6361 6c3a 2074  ports_optical: t
-00011c30: 6f20 7365 6c65 6374 206f 7074 6963 616c  o select optical
-00011c40: 2070 6f72 7473 2e0a 2020 2020 2020 2020   ports..        
-00011c50: 2020 2020 7365 6c65 6374 5f70 6f72 7473      select_ports
-00011c60: 5f65 6c65 6374 7269 6361 6c3a 2074 6f20  _electrical: to 
-00011c70: 7365 6c65 6374 2065 6c65 6374 7269 6361  select electrica
-00011c80: 6c20 706f 7274 732e 0a20 2020 2020 2020  l ports..       
-00011c90: 2020 2020 2070 7265 6669 785f 6f70 7469       prefix_opti
-00011ca0: 6361 6c3a 2070 7265 6669 782e 0a20 2020  cal: prefix..   
-00011cb0: 2020 2020 2020 2020 2070 7265 6669 785f           prefix_
-00011cc0: 656c 6563 7472 6963 616c 3a20 7072 6566  electrical: pref
-00011cd0: 6978 2e0a 0a20 2020 2020 2020 202e 2e20  ix...        .. 
-00011ce0: 636f 6465 3a3a 0a0a 2020 2020 2020 2020  code::..        
-00011cf0: 2020 2020 2020 2020 2020 3320 2034 0a20            3  4. 
-00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d10: 5f7c 5f5f 7c5f 0a20 2020 2020 2020 2020  _|__|_.         
-00011d20: 2020 2020 3220 2d7c 2020 2020 2020 7c2d      2 -|      |-
-00011d30: 2035 0a20 2020 2020 2020 2020 2020 2020   5.             
-00011d40: 2020 207c 2020 2020 2020 7c0a 2020 2020     |      |.    
-00011d50: 2020 2020 2020 2020 2031 202d 7c5f 5f5f           1 -|___
-00011d60: 5f5f 5f7c 2d20 360a 2020 2020 2020 2020  ___|- 6.        
-00011d70: 2020 2020 2020 2020 2020 7c20 207c 0a20            |  |. 
-00011d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d90: 2038 2020 370a 2020 2020 2020 2020 2222   8  7.        ""
-00011da0: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
-00011db0: 735f 756e 6c6f 636b 6564 2829 0a20 2020  s_unlocked().   
-00011dc0: 2020 2020 2061 7574 6f5f 7265 6e61 6d65       auto_rename
-00011dd0: 5f70 6f72 7473 2873 656c 662c 202a 2a6b  _ports(self, **k
-00011de0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-00011df0: 6175 746f 5f72 656e 616d 655f 706f 7274  auto_rename_port
-00011e00: 735f 636f 756e 7465 725f 636c 6f63 6b77  s_counter_clockw
-00011e10: 6973 6528 7365 6c66 2c20 2a2a 6b77 6172  ise(self, **kwar
-00011e20: 6773 2920 2d3e 204e 6f6e 653a 0a20 2020  gs) -> None:.   
-00011e30: 2020 2020 2073 656c 662e 6973 5f75 6e6c       self.is_unl
-00011e40: 6f63 6b65 6428 290a 2020 2020 2020 2020  ocked().        
-00011e50: 6175 746f 5f72 656e 616d 655f 706f 7274  auto_rename_port
-00011e60: 735f 636f 756e 7465 725f 636c 6f63 6b77  s_counter_clockw
-00011e70: 6973 6528 7365 6c66 2c20 2a2a 6b77 6172  ise(self, **kwar
-00011e80: 6773 290a 0a20 2020 2064 6566 2061 7574  gs)..    def aut
-00011e90: 6f5f 7265 6e61 6d65 5f70 6f72 7473 5f6c  o_rename_ports_l
-00011ea0: 6179 6572 5f6f 7269 656e 7461 7469 6f6e  ayer_orientation
-00011eb0: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
-00011ec0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00011ed0: 2020 7365 6c66 2e69 735f 756e 6c6f 636b    self.is_unlock
-00011ee0: 6564 2829 0a20 2020 2020 2020 2061 7574  ed().        aut
-00011ef0: 6f5f 7265 6e61 6d65 5f70 6f72 7473 5f6c  o_rename_ports_l
-00011f00: 6179 6572 5f6f 7269 656e 7461 7469 6f6e  ayer_orientation
-00011f10: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
-00011f20: 0a0a 2020 2020 6465 6620 6175 746f 5f72  ..    def auto_r
-00011f30: 656e 616d 655f 706f 7274 735f 6f72 6965  ename_ports_orie
-00011f40: 6e74 6174 696f 6e28 7365 6c66 2c20 2a2a  ntation(self, **
-00011f50: 6b77 6172 6773 2920 2d3e 204e 6f6e 653a  kwargs) -> None:
-00011f60: 0a20 2020 2020 2020 2022 2222 5265 6e61  .        """Rena
-00011f70: 6d65 2070 6f72 7473 2062 7920 6f72 6965  me ports by orie
-00011f80: 6e74 6174 696f 6e20 4e53 4557 2028 6e6f  ntation NSEW (no
-00011f90: 7274 682c 2073 6f75 7468 2c20 6561 7374  rth, south, east
-00011fa0: 2c20 7765 7374 292e 0a0a 2020 2020 2020  , west)...      
-00011fb0: 2020 4b65 7977 6f72 6420 4172 6773 3a0a    Keyword Args:.
-00011fc0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00011fd0: 7469 6f6e 3a20 746f 2072 656e 616d 6520  tion: to rename 
-00011fe0: 706f 7274 732e 0a20 2020 2020 2020 2020  ports..         
-00011ff0: 2020 2073 656c 6563 745f 706f 7274 735f     select_ports_
-00012000: 6f70 7469 6361 6c3a 2074 6f20 7365 6c65  optical: to sele
-00012010: 6374 2070 6f72 7473 2e0a 2020 2020 2020  ct ports..      
-00012020: 2020 2020 2020 7365 6c65 6374 5f70 6f72        select_por
-00012030: 7473 5f65 6c65 6374 7269 6361 6c3a 0a20  ts_electrical:. 
-00012040: 2020 2020 2020 2020 2020 2070 7265 6669             prefi
-00012050: 785f 6f70 7469 6361 6c3a 0a20 2020 2020  x_optical:.     
-00012060: 2020 2020 2020 2070 7265 6669 785f 656c         prefix_el
-00012070: 6563 7472 6963 616c 3a0a 0a20 2020 2020  ectrical:..     
-00012080: 2020 202e 2e20 636f 6465 3a3a 0a0a 2020     .. code::..  
-00012090: 2020 2020 2020 2020 2020 2020 2020 204e                 N
-000120a0: 3020 204e 310a 2020 2020 2020 2020 2020  0  N1.          
-000120b0: 2020 2020 2020 207c 5f5f 5f7c 5f0a 2020         |___|_.  
-000120c0: 2020 2020 2020 2020 2020 5731 202d 7c20            W1 -| 
-000120d0: 2020 2020 207c 2d20 4531 0a20 2020 2020       |- E1.     
-000120e0: 2020 2020 2020 2020 2020 207c 2020 2020             |    
-000120f0: 2020 7c0a 2020 2020 2020 2020 2020 2020    |.            
-00012100: 5730 202d 7c5f 5f5f 5f5f 5f7c 2d20 4530  W0 -|______|- E0
-00012110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012120: 2020 7c20 2020 7c0a 2020 2020 2020 2020    |   |.        
-00012130: 2020 2020 2020 2020 5330 2020 2053 310a          S0   S1.
-00012140: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012150: 2020 2020 7365 6c66 2e69 735f 756e 6c6f      self.is_unlo
-00012160: 636b 6564 2829 0a20 2020 2020 2020 2061  cked().        a
-00012170: 7574 6f5f 7265 6e61 6d65 5f70 6f72 7473  uto_rename_ports
-00012180: 5f6f 7269 656e 7461 7469 6f6e 2873 656c  _orientation(sel
-00012190: 662c 202a 2a6b 7761 7267 7329 0a0a 2020  f, **kwargs)..  
-000121a0: 2020 6465 6620 6d6f 7665 280a 2020 2020    def move(.    
-000121b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000121c0: 2020 6f72 6967 696e 3a20 466c 6f61 7432    origin: Float2
-000121d0: 203d 2028 302c 2030 292c 0a20 2020 2020   = (0, 0),.     
-000121e0: 2020 2064 6573 7469 6e61 7469 6f6e 3a20     destination: 
-000121f0: 4f70 7469 6f6e 616c 5b46 6c6f 6174 325d  Optional[Float2]
-00012200: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00012210: 2061 7869 733a 204f 7074 696f 6e61 6c5b   axis: Optional[
-00012220: 4178 6973 5d20 3d20 4e6f 6e65 2c0a 2020  Axis] = None,.  
-00012230: 2020 2920 2d3e 2043 6f6d 706f 6e65 6e74    ) -> Component
-00012240: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00012250: 7572 6e73 206e 6577 2043 6f6d 706f 6e65  urns new Compone
-00012260: 6e74 2077 6974 6820 6120 6d6f 7665 6420  nt with a moved 
-00012270: 7265 6665 7265 6e63 6520 746f 2074 6865  reference to the
-00012280: 206f 7269 6769 6e61 6c2e 0a0a 2020 2020   original...    
-00012290: 2020 2020 636f 6d70 6f6e 656e 742e 0a0a      component...
-000122a0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-000122b0: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-000122c0: 3a20 6f66 2063 6f6d 706f 6e65 6e74 2e0a  : of component..
-000122d0: 2020 2020 2020 2020 2020 2020 6465 7374              dest
-000122e0: 696e 6174 696f 6e3a 2078 2c20 792e 0a20  ination: x, y.. 
-000122f0: 2020 2020 2020 2020 2020 2061 7869 733a             axis:
-00012300: 2078 206f 7220 792e 0a20 2020 2020 2020   x or y..       
-00012310: 2022 2222 0a20 2020 2020 2020 2072 6169   """.        rai
-00012320: 7365 2056 616c 7565 4572 726f 7228 6d6f  se ValueError(mo
-00012330: 7665 5f65 7272 6f72 5f6d 6573 7361 6765  ve_error_message
-00012340: 290a 0a20 2020 2064 6566 206d 6972 726f  )..    def mirro
-00012350: 7228 7365 6c66 2c20 7031 3a20 466c 6f61  r(self, p1: Floa
-00012360: 7432 203d 2028 302c 2031 292c 2070 323a  t2 = (0, 1), p2:
-00012370: 2046 6c6f 6174 3220 3d20 2830 2c20 3029   Float2 = (0, 0)
-00012380: 2c20 2a2a 6b77 6172 6773 2920 2d3e 2043  , **kwargs) -> C
-00012390: 6f6d 706f 6e65 6e74 3a0a 2020 2020 2020  omponent:.      
-000123a0: 2020 2222 2252 6574 7572 6e73 206e 6577    """Returns new
-000123b0: 2043 6f6d 706f 6e65 6e74 2077 6974 6820   Component with 
-000123c0: 6120 6d69 7272 6f72 6564 2072 6566 6572  a mirrored refer
-000123d0: 656e 6365 2e0a 0a20 2020 2020 2020 2041  ence...        A
-000123e0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-000123f0: 2070 313a 2066 6972 7374 2070 6f69 6e74   p1: first point
-00012400: 2074 6f20 6465 6669 6e65 206d 6972 726f   to define mirro
-00012410: 7220 6178 6973 2e0a 2020 2020 2020 2020  r axis..        
-00012420: 2020 2020 7032 3a20 7365 636f 6e64 2070      p2: second p
-00012430: 6f69 6e74 2074 6f20 6465 6669 6e65 206d  oint to define m
-00012440: 6972 726f 7220 6178 6973 2e0a 2020 2020  irror axis..    
-00012450: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00012460: 6672 6f6d 2067 6473 6661 6374 6f72 792e  from gdsfactory.
-00012470: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00012480: 206d 6972 726f 720a 0a20 2020 2020 2020   mirror..       
-00012490: 2072 6574 7572 6e20 6d69 7272 6f72 2863   return mirror(c
-000124a0: 6f6d 706f 6e65 6e74 3d73 656c 662c 2070  omponent=self, p
-000124b0: 313d 7031 2c20 7032 3d70 322c 202a 2a6b  1=p1, p2=p2, **k
-000124c0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-000124d0: 726f 7461 7465 2873 656c 662c 2061 6e67  rotate(self, ang
-000124e0: 6c65 3a20 666c 6f61 7420 3d20 3930 2c20  le: float = 90, 
-000124f0: 2a2a 6b77 6172 6773 2920 2d3e 2043 6f6d  **kwargs) -> Com
-00012500: 706f 6e65 6e74 3a0a 2020 2020 2020 2020  ponent:.        
-00012510: 2222 2252 6574 7572 6e73 206e 6577 2063  """Returns new c
-00012520: 6f6d 706f 6e65 6e74 2077 6974 6820 6120  omponent with a 
-00012530: 726f 7461 7465 6420 7265 6665 7265 6e63  rotated referenc
-00012540: 6520 746f 2074 6865 206f 7269 6769 6e61  e to the origina
-00012550: 6c2e 0a0a 2020 2020 2020 2020 4172 6773  l...        Args
-00012560: 3a0a 2020 2020 2020 2020 2020 2020 616e  :.            an
-00012570: 676c 653a 2069 6e20 6465 6772 6565 732e  gle: in degrees.
-00012580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012590: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
-000125a0: 746f 7279 2e66 756e 6374 696f 6e73 2069  tory.functions i
-000125b0: 6d70 6f72 7420 726f 7461 7465 0a0a 2020  mport rotate..  
-000125c0: 2020 2020 2020 7265 7475 726e 2072 6f74        return rot
-000125d0: 6174 6528 636f 6d70 6f6e 656e 743d 7365  ate(component=se
-000125e0: 6c66 2c20 616e 676c 653d 616e 676c 652c  lf, angle=angle,
-000125f0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00012600: 6465 6620 6164 645f 7061 6464 696e 6728  def add_padding(
-00012610: 7365 6c66 2c20 2a2a 6b77 6172 6773 2920  self, **kwargs) 
-00012620: 2d3e 2043 6f6d 706f 6e65 6e74 3a0a 2020  -> Component:.  
-00012630: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-00012640: 2073 616d 6520 636f 6d70 6f6e 656e 7420   same component 
-00012650: 7769 7468 2070 6164 6469 6e67 2e0a 0a20  with padding... 
-00012660: 2020 2020 2020 204b 6579 776f 7264 2041         Keyword A
-00012670: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00012680: 2063 6f6d 706f 6e65 6e74 3a20 666f 7220   component: for 
-00012690: 7061 6464 696e 672e 0a20 2020 2020 2020  padding..       
-000126a0: 2020 2020 206c 6179 6572 733a 206c 6973       layers: lis
-000126b0: 7420 6f66 206c 6179 6572 732e 0a20 2020  t of layers..   
-000126c0: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
-000126d0: 666f 7220 6e61 6d65 2e0a 2020 2020 2020  for name..      
-000126e0: 2020 2020 2020 6465 6661 756c 743a 2064        default: d
-000126f0: 6566 6175 6c74 2070 6164 6469 6e67 2028  efault padding (
-00012700: 3530 756d 292e 0a20 2020 2020 2020 2020  50um)..         
-00012710: 2020 2074 6f70 3a20 6e6f 7274 6820 7061     top: north pa
-00012720: 6464 696e 672e 0a20 2020 2020 2020 2020  dding..         
-00012730: 2020 2062 6f74 746f 6d3a 2073 6f75 7468     bottom: south
-00012740: 2070 6164 6469 6e67 2e0a 2020 2020 2020   padding..      
-00012750: 2020 2020 2020 7269 6768 743a 2065 6173        right: eas
-00012760: 7420 7061 6464 696e 672e 0a20 2020 2020  t padding..     
-00012770: 2020 2020 2020 206c 6566 743a 2077 6573         left: wes
-00012780: 7420 7061 6464 696e 672e 0a20 2020 2020  t padding..     
-00012790: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-000127a0: 726f 6d20 6764 7366 6163 746f 7279 2e61  rom gdsfactory.a
-000127b0: 6464 5f70 6164 6469 6e67 2069 6d70 6f72  dd_padding impor
-000127c0: 7420 6164 645f 7061 6464 696e 670a 0a20  t add_padding.. 
-000127d0: 2020 2020 2020 2072 6574 7572 6e20 6164         return ad
-000127e0: 645f 7061 6464 696e 6728 636f 6d70 6f6e  d_padding(compon
-000127f0: 656e 743d 7365 6c66 2c20 2a2a 6b77 6172  ent=self, **kwar
-00012800: 6773 290a 0a20 2020 2064 6566 2061 6273  gs)..    def abs
-00012810: 6f72 6228 7365 6c66 2c20 7265 6665 7265  orb(self, refere
-00012820: 6e63 6529 202d 3e20 436f 6d70 6f6e 656e  nce) -> Componen
-00012830: 743a 0a20 2020 2020 2020 2022 2222 4162  t:.        """Ab
-00012840: 736f 7262 7320 706f 6c79 676f 6e73 2066  sorbs polygons f
-00012850: 726f 6d20 436f 6d70 6f6e 656e 7452 6566  rom ComponentRef
-00012860: 6572 656e 6365 2069 6e74 6f20 436f 6d70  erence into Comp
-00012870: 6f6e 656e 742e 0a0a 2020 2020 2020 2020  onent...        
-00012880: 4465 7374 726f 7973 2074 6865 2072 6566  Destroys the ref
-00012890: 6572 656e 6365 2069 6e20 7468 6520 7072  erence in the pr
-000128a0: 6f63 6573 7320 6275 7420 6b65 6570 696e  ocess but keepin
-000128b0: 6720 7468 6520 706f 6c79 676f 6e20 6765  g the polygon ge
-000128c0: 6f6d 6574 7279 2e0a 0a20 2020 2020 2020  ometry...       
-000128d0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-000128e0: 2020 2072 6566 6572 656e 6365 3a20 436f     reference: Co
-000128f0: 6d70 6f6e 656e 7452 6566 6572 656e 6365  mponentReference
-00012900: 2074 6f20 6265 2061 6273 6f72 6265 6420   to be absorbed 
-00012910: 696e 746f 2074 6865 2043 6f6d 706f 6e65  into the Compone
-00012920: 6e74 2e0a 2020 2020 2020 2020 2222 220a  nt..        """.
-00012930: 2020 2020 2020 2020 6966 2072 6566 6572          if refer
-00012940: 656e 6365 206e 6f74 2069 6e20 7365 6c66  ence not in self
-00012950: 2e72 6566 6572 656e 6365 733a 0a20 2020  .references:.   
-00012960: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00012970: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00012980: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-00012990: 7265 6665 7265 6e63 6520 796f 7520 6173  reference you as
-000129a0: 6b65 6420 746f 2061 6273 6f72 6220 646f  ked to absorb do
-000129b0: 6573 206e 6f74 2065 7869 7374 2069 6e20  es not exist in 
-000129c0: 7468 6973 2043 6f6d 706f 6e65 6e74 2e22  this Component."
-000129d0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000129e0: 2020 2020 2020 2072 6566 5f70 6f6c 7967         ref_polyg
-000129f0: 6f6e 7320 3d20 7265 6665 7265 6e63 652e  ons = reference.
-00012a00: 6765 745f 706f 6c79 676f 6e73 280a 2020  get_polygons(.  
-00012a10: 2020 2020 2020 2020 2020 6279 5f73 7065            by_spe
-00012a20: 633d 4661 6c73 652c 2069 6e63 6c75 6465  c=False, include
-00012a30: 5f70 6174 6873 3d46 616c 7365 2c20 6173  _paths=False, as
-00012a40: 5f61 7272 6179 3d46 616c 7365 0a20 2020  _array=False.   
-00012a50: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00012a60: 656c 662e 5f61 6464 5f70 6f6c 7967 6f6e  elf._add_polygon
-00012a70: 7328 2a72 6566 5f70 6f6c 7967 6f6e 7329  s(*ref_polygons)
-00012a80: 0a0a 2020 2020 2020 2020 7365 6c66 2e61  ..        self.a
-00012a90: 6464 2872 6566 6572 656e 6365 2e67 6574  dd(reference.get
-00012aa0: 5f6c 6162 656c 7328 2929 0a20 2020 2020  _labels()).     
-00012ab0: 2020 2073 656c 662e 6164 6428 7265 6665     self.add(refe
-00012ac0: 7265 6e63 652e 6765 745f 7061 7468 7328  rence.get_paths(
-00012ad0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00012ae0: 7265 6d6f 7665 2872 6566 6572 656e 6365  remove(reference
-00012af0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00012b00: 2073 656c 660a 0a20 2020 2064 6566 2072   self..    def r
-00012b10: 656d 6f76 6528 7365 6c66 2c20 6974 656d  emove(self, item
-00012b20: 7329 3a0a 2020 2020 2020 2020 2222 2252  s):.        """R
-00012b30: 656d 6f76 6573 2069 7465 6d73 2066 726f  emoves items fro
-00012b40: 6d20 6120 436f 6d70 6f6e 656e 742c 2077  m a Component, w
-00012b50: 6869 6368 2063 616e 2069 6e63 6c75 6465  hich can include
-00012b60: 2050 6f72 7473 2c20 506f 6c79 676f 6e53   Ports, PolygonS
-00012b70: 6574 7320 5c0a 2020 2020 2020 2020 4365  ets \.        Ce
-00012b80: 6c6c 5265 6665 7265 6e63 6573 2c20 436f  llReferences, Co
-00012b90: 6d70 6f6e 656e 7452 6566 6572 656e 6365  mponentReference
-00012ba0: 7320 616e 6420 4c61 6265 6c73 2e0a 0a20  s and Labels... 
-00012bb0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00012bc0: 2020 2020 2020 2020 2069 7465 6d73 3a20           items: 
-00012bd0: 6c69 7374 206f 6620 4974 656d 7320 746f  list of Items to
-00012be0: 2062 6520 7265 6d6f 7665 6420 6672 6f6d   be removed from
-00012bf0: 2074 6865 2043 6f6d 706f 6e65 6e74 2e0a   the Component..
-00012c00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012c10: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
-00012c20: 7472 2869 7465 6d73 2c20 225f 5f69 7465  tr(items, "__ite
-00012c30: 725f 5f22 293a 0a20 2020 2020 2020 2020  r__"):.         
-00012c40: 2020 2069 7465 6d73 203d 205b 6974 656d     items = [item
-00012c50: 735d 0a20 2020 2020 2020 2066 6f72 2069  s].        for i
-00012c60: 7465 6d20 696e 2069 7465 6d73 3a0a 2020  tem in items:.  
-00012c70: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00012c80: 6e73 7461 6e63 6528 6974 656d 2c20 506f  nstance(item, Po
-00012c90: 7274 293a 0a20 2020 2020 2020 2020 2020  rt):.           
-00012ca0: 2020 2020 2073 656c 662e 706f 7274 7320       self.ports 
-00012cb0: 3d20 7b6b 3a20 7620 666f 7220 6b2c 2076  = {k: v for k, v
-00012cc0: 2069 6e20 7365 6c66 2e70 6f72 7473 2e69   in self.ports.i
-00012cd0: 7465 6d73 2829 2069 6620 7620 213d 2069  tems() if v != i
-00012ce0: 7465 6d7d 0a20 2020 2020 2020 2020 2020  tem}.           
-00012cf0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00012d00: 2869 7465 6d2c 2067 6473 746b 2e52 6566  (item, gdstk.Ref
-00012d10: 6572 656e 6365 293a 0a20 2020 2020 2020  erence):.       
-00012d20: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
-00012d30: 656c 6c2e 7265 6d6f 7665 2869 7465 6d29  ell.remove(item)
-00012d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012d50: 2069 7465 6d2e 6f77 6e65 7220 3d20 4e6f   item.owner = No
-00012d60: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
-00012d70: 6c69 6620 6973 696e 7374 616e 6365 2869  lif isinstance(i
-00012d80: 7465 6d2c 2043 6f6d 706f 6e65 6e74 5265  tem, ComponentRe
-00012d90: 6665 7265 6e63 6529 3a0a 2020 2020 2020  ference):.      
-00012da0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-00012db0: 6566 6572 656e 6365 732e 7265 6d6f 7665  eferences.remove
-00012dc0: 2869 7465 6d29 0a20 2020 2020 2020 2020  (item).         
-00012dd0: 2020 2020 2020 2073 656c 662e 5f63 656c         self._cel
-00012de0: 6c2e 7265 6d6f 7665 2869 7465 6d2e 5f72  l.remove(item._r
-00012df0: 6566 6572 656e 6365 290a 2020 2020 2020  eference).      
-00012e00: 2020 2020 2020 2020 2020 6974 656d 2e6f            item.o
-00012e10: 776e 6572 203d 204e 6f6e 650a 2020 2020  wner = None.    
-00012e20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00012e30: 2e5f 6e61 6d65 645f 7265 6665 7265 6e63  ._named_referenc
-00012e40: 6573 2e70 6f70 2869 7465 6d2e 6e61 6d65  es.pop(item.name
-00012e50: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00012e60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00012e70: 2020 2020 7365 6c66 2e5f 6365 6c6c 2e72      self._cell.r
-00012e80: 656d 6f76 6528 6974 656d 290a 0a20 2020  emove(item)..   
-00012e90: 2020 2020 2073 656c 662e 5f62 625f 7661       self._bb_va
-00012ea0: 6c69 6420 3d20 4661 6c73 650a 2020 2020  lid = False.    
-00012eb0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00012ec0: 0a20 2020 2064 6566 2068 6173 685f 6765  .    def hash_ge
-00012ed0: 6f6d 6574 7279 2873 656c 662c 2070 7265  ometry(self, pre
-00012ee0: 6369 7369 6f6e 3a20 666c 6f61 7420 3d20  cision: float = 
-00012ef0: 3165 2d34 2920 2d3e 2073 7472 3a0a 2020  1e-4) -> str:.  
-00012f00: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-00012f10: 2061 6e20 5348 4131 2068 6173 6820 6f66   an SHA1 hash of
-00012f20: 2074 6865 2067 656f 6d65 7472 7920 696e   the geometry in
-00012f30: 2074 6865 2043 6f6d 706f 6e65 6e74 2e0a   the Component..
-00012f40: 0a20 2020 2020 2020 2046 6f72 2065 6163  .        For eac
-00012f50: 6820 6c61 7965 722c 2065 6163 6820 706f  h layer, each po
-00012f60: 6c79 676f 6e20 6973 2069 6e64 6976 6964  lygon is individ
-00012f70: 7561 6c6c 7920 6861 7368 6564 2061 6e64  ually hashed and
-00012f80: 2074 6865 6e20 7468 6520 706f 6c79 676f   then the polygo
-00012f90: 6e20 6861 7368 6573 0a20 2020 2020 2020  n hashes.       
-00012fa0: 2061 7265 2073 6f72 7465 642c 2074 6f20   are sorted, to 
-00012fb0: 656e 7375 7265 2074 6865 2068 6173 6820  ensure the hash 
-00012fc0: 7374 6179 7320 636f 6e73 7461 6e74 2072  stays constant r
-00012fd0: 6567 6172 646c 6573 7320 6f66 2074 6865  egardless of the
-00012fe0: 206f 7264 6572 696e 670a 2020 2020 2020   ordering.      
-00012ff0: 2020 7468 6520 706f 6c79 676f 6e73 2e20    the polygons. 
-00013000: 2053 696d 696c 6172 6c79 2c20 7468 6520   Similarly, the 
-00013010: 6c61 7965 7273 2061 7265 2073 6f72 7465  layers are sorte
-00013020: 6420 6279 2028 6c61 7965 722c 2064 6174  d by (layer, dat
-00013030: 6174 7970 6529 2e0a 0a20 2020 2020 2020  atype)...       
-00013040: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00013050: 2020 2070 7265 6369 7369 6f6e 3a20 526f     precision: Ro
-00013060: 756e 6469 6e67 2070 7265 6369 7369 6f6e  unding precision
-00013070: 2066 6f72 2074 6865 2074 6865 206f 626a   for the the obj
-00013080: 6563 7473 2069 6e20 7468 6520 436f 6d70  ects in the Comp
-00013090: 6f6e 656e 742e 0a20 2020 2020 2020 2020  onent..         
-000130a0: 2020 2020 2020 2046 6f72 2069 6e73 7461         For insta
-000130b0: 6e63 652c 2061 2070 7265 6369 7369 6f6e  nce, a precision
-000130c0: 206f 6620 3165 2d32 2077 696c 6c20 726f   of 1e-2 will ro
-000130d0: 756e 6420 6120 706f 696e 7420 6174 0a20  und a point at. 
-000130e0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000130f0: 302e 3132 342c 2031 2e37 3438 2920 746f  0.124, 1.748) to
-00013100: 2028 302e 3132 2c20 312e 3735 292e 0a0a   (0.12, 1.75)...
-00013110: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00013120: 2020 2020 706f 6c79 676f 6e73 5f62 795f      polygons_by_
-00013130: 7370 6563 203d 2073 656c 662e 6765 745f  spec = self.get_
-00013140: 706f 6c79 676f 6e73 2862 795f 7370 6563  polygons(by_spec
-00013150: 3d54 7275 652c 2061 735f 6172 7261 793d  =True, as_array=
-00013160: 4661 6c73 6529 0a20 2020 2020 2020 206c  False).        l
-00013170: 6179 6572 7320 3d20 6e70 2e61 7272 6179  ayers = np.array
-00013180: 286c 6973 7428 706f 6c79 676f 6e73 5f62  (list(polygons_b
-00013190: 795f 7370 6563 2e6b 6579 7328 2929 290a  y_spec.keys())).
-000131a0: 2020 2020 2020 2020 736f 7274 6564 5f6c          sorted_l
-000131b0: 6179 6572 7320 3d20 6c61 7965 7273 5b6e  ayers = layers[n
-000131c0: 702e 6c65 7873 6f72 7428 286c 6179 6572  p.lexsort((layer
-000131d0: 735b 3a2c 2030 5d2c 206c 6179 6572 735b  s[:, 0], layers[
-000131e0: 3a2c 2031 5d29 295d 0a0a 2020 2020 2020  :, 1]))]..      
-000131f0: 2020 6669 6e61 6c5f 6861 7368 203d 2068    final_hash = h
-00013200: 6173 686c 6962 2e73 6861 3128 290a 2020  ashlib.sha1().  
-00013210: 2020 2020 2020 666f 7220 6c61 7965 7220        for layer 
-00013220: 696e 2073 6f72 7465 645f 6c61 7965 7273  in sorted_layers
-00013230: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
-00013240: 7965 725f 6861 7368 203d 2068 6173 686c  yer_hash = hashl
-00013250: 6962 2e73 6861 3128 6c61 7965 722e 6173  ib.sha1(layer.as
-00013260: 7479 7065 286e 702e 696e 7436 3429 292e  type(np.int64)).
-00013270: 6469 6765 7374 2829 0a20 2020 2020 2020  digest().       
-00013280: 2020 2020 2070 6f6c 7967 6f6e 7320 3d20       polygons = 
-00013290: 706f 6c79 676f 6e73 5f62 795f 7370 6563  polygons_by_spec
-000132a0: 5b74 7570 6c65 286c 6179 6572 295d 0a20  [tuple(layer)]. 
-000132b0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-000132c0: 6f6e 7320 3d20 5b5f 726e 6428 702e 706f  ons = [_rnd(p.po
-000132d0: 696e 7473 2c20 7072 6563 6973 696f 6e29  ints, precision)
-000132e0: 2066 6f72 2070 2069 6e20 706f 6c79 676f   for p in polygo
-000132f0: 6e73 5d0a 2020 2020 2020 2020 2020 2020  ns].            
-00013300: 706f 6c79 676f 6e5f 6861 7368 6573 203d  polygon_hashes =
-00013310: 206e 702e 736f 7274 285b 6861 7368 6c69   np.sort([hashli
-00013320: 622e 7368 6131 2870 292e 6469 6765 7374  b.sha1(p).digest
-00013330: 2829 2066 6f72 2070 2069 6e20 706f 6c79  () for p in poly
-00013340: 676f 6e73 5d29 0a20 2020 2020 2020 2020  gons]).         
-00013350: 2020 2066 696e 616c 5f68 6173 682e 7570     final_hash.up
-00013360: 6461 7465 286c 6179 6572 5f68 6173 6829  date(layer_hash)
-00013370: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00013380: 2070 6820 696e 2070 6f6c 7967 6f6e 5f68   ph in polygon_h
-00013390: 6173 6865 733a 0a20 2020 2020 2020 2020  ashes:.         
-000133a0: 2020 2020 2020 2066 696e 616c 5f68 6173         final_has
-000133b0: 682e 7570 6461 7465 2870 6829 0a0a 2020  h.update(ph)..  
-000133c0: 2020 2020 2020 7265 7475 726e 2066 696e        return fin
-000133d0: 616c 5f68 6173 682e 6865 7864 6967 6573  al_hash.hexdiges
-000133e0: 7428 290a 0a20 2020 2064 6566 2067 6574  t()..    def get
-000133f0: 5f6c 6162 656c 7328 0a20 2020 2020 2020  _labels(.       
-00013400: 2073 656c 662c 2061 7070 6c79 5f72 6570   self, apply_rep
-00013410: 6574 6974 696f 6e73 3d54 7275 652c 2064  etitions=True, d
-00013420: 6570 7468 3a20 4f70 7469 6f6e 616c 5b69  epth: Optional[i
-00013430: 6e74 5d20 3d20 4e6f 6e65 2c20 6c61 7965  nt] = None, laye
-00013440: 723d 4e6f 6e65 0a20 2020 2029 202d 3e20  r=None.    ) -> 
-00013450: 4c69 7374 5b4c 6162 656c 5d3a 0a20 2020  List[Label]:.   
-00013460: 2020 2020 2022 2222 5265 7475 726e 206c       """Return l
-00013470: 6162 656c 732e 0a0a 2020 2020 2020 2020  abels...        
-00013480: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00013490: 2020 6170 706c 795f 7265 7065 7469 7469    apply_repetiti
-000134a0: 6f6e 733a 2e0a 2020 2020 2020 2020 2020  ons:..          
-000134b0: 2020 6465 7074 683a 204e 6f6e 6520 7265    depth: None re
-000134c0: 7475 726e 7320 616c 6c20 6c61 6265 6c73  turns all labels
-000134d0: 2061 6e64 2030 2074 6f70 206c 6576 656c   and 0 top level
-000134e0: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-000134f0: 7965 723a 206c 6179 6572 7370 6563 2e0a  yer: layerspec..
-00013500: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00013510: 2020 2020 6672 6f6d 2067 6473 6661 6374      from gdsfact
-00013520: 6f72 792e 7064 6b20 696d 706f 7274 2067  ory.pdk import g
-00013530: 6574 5f6c 6179 6572 0a0a 2020 2020 2020  et_layer..      
-00013540: 2020 6966 206c 6179 6572 3a0a 2020 2020    if layer:.    
-00013550: 2020 2020 2020 2020 6c61 7965 722c 2074          layer, t
-00013560: 6578 7474 7970 6520 3d20 6765 745f 6c61  exttype = get_la
-00013570: 7965 7228 6c61 7965 7229 0a20 2020 2020  yer(layer).     
-00013580: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013590: 2020 2020 2074 6578 7474 7970 6520 3d20       texttype = 
-000135a0: 4e6f 6e65 0a20 2020 2020 2020 2072 6574  None.        ret
-000135b0: 7572 6e20 7365 6c66 2e5f 6365 6c6c 2e67  urn self._cell.g
-000135c0: 6574 5f6c 6162 656c 7328 0a20 2020 2020  et_labels(.     
-000135d0: 2020 2020 2020 2061 7070 6c79 5f72 6570         apply_rep
-000135e0: 6574 6974 696f 6e73 3d61 7070 6c79 5f72  etitions=apply_r
-000135f0: 6570 6574 6974 696f 6e73 2c0a 2020 2020  epetitions,.    
-00013600: 2020 2020 2020 2020 6465 7074 683d 6465          depth=de
-00013610: 7074 682c 0a20 2020 2020 2020 2020 2020  pth,.           
-00013620: 206c 6179 6572 3d6c 6179 6572 2c0a 2020   layer=layer,.  
-00013630: 2020 2020 2020 2020 2020 7465 7874 7479            textty
-00013640: 7065 3d74 6578 7474 7970 652c 0a20 2020  pe=texttype,.   
-00013650: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00013660: 7265 6d6f 7665 5f6c 6162 656c 7328 7365  remove_labels(se
-00013670: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00013680: 2020 2020 2022 2222 5265 6d6f 7665 206c       """Remove l
-00013690: 6162 656c 732e 2222 220a 2020 2020 2020  abels.""".      
-000136a0: 2020 7365 6c66 2e5f 6365 6c6c 2e72 656d    self._cell.rem
-000136b0: 6f76 6528 2a73 656c 662e 6c61 6265 6c73  ove(*self.labels
-000136c0: 290a 0a20 2020 2023 2044 6570 7265 6361  )..    # Depreca
-000136d0: 7465 640a 2020 2020 6465 6620 6765 745f  ted.    def get_
-000136e0: 696e 666f 2873 656c 6629 3a0a 2020 2020  info(self):.    
-000136f0: 2020 2020 2222 2247 6174 6865 7273 2074      """Gathers t
-00013700: 6865 202e 696e 666f 2064 6963 7469 6f6e  he .info diction
-00013710: 6172 6965 7320 6672 6f6d 2065 7665 7279  aries from every
-00013720: 2073 7562 2d43 6f6d 706f 6e65 6e74 2061   sub-Component a
-00013730: 6e64 2072 6574 7572 6e73 2074 6865 6d20  nd returns them 
-00013740: 696e 2061 206c 6973 742e 0a0a 2020 2020  in a list...    
-00013750: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00013760: 2020 2020 2020 6465 7074 683a 2069 6e74        depth: int
-00013770: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
-00013780: 2020 2020 2020 2020 2049 6620 6e6f 7420           If not 
-00013790: 4e6f 6e65 2c20 6465 6669 6e65 7320 6672  None, defines fr
-000137a0: 6f6d 2068 6f77 206d 616e 7920 7265 6665  om how many refe
-000137b0: 7265 6e63 6520 6c65 7665 6c73 2074 6f0a  rence levels to.
-000137c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137d0: 7265 7472 6965 7665 2050 6f72 7473 2066  retrieve Ports f
-000137e0: 726f 6d2e 0a0a 2020 2020 2020 2020 5265  rom...        Re
-000137f0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-00013800: 2020 206c 6973 7420 6f66 2064 6963 7469     list of dicti
-00013810: 6f6e 6172 6965 730a 2020 2020 2020 2020  onaries.        
-00013820: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-00013830: 7468 6520 222e 696e 666f 2220 7072 6f70  the ".info" prop
-00013840: 6572 7479 2064 6963 7469 6f6e 6172 6965  erty dictionarie
-00013850: 7320 6672 6f6d 2061 6c6c 2073 7562 2d43  s from all sub-C
-00013860: 6f6d 706f 6e65 6e74 730a 2020 2020 2020  omponents.      
-00013870: 2020 2222 220a 2020 2020 2020 2020 445f    """.        D_
-00013880: 6c69 7374 203d 2073 656c 662e 6765 745f  list = self.get_
-00013890: 6465 7065 6e64 656e 6369 6573 2872 6563  dependencies(rec
-000138a0: 7572 7369 7665 3d54 7275 6529 0a20 2020  ursive=True).   
-000138b0: 2020 2020 2072 6574 7572 6e20 5b44 2e69       return [D.i
-000138c0: 6e66 6f2e 636f 7079 2829 2066 6f72 2044  nfo.copy() for D
-000138d0: 2069 6e20 445f 6c69 7374 5d0a 0a20 2020   in D_list]..   
-000138e0: 2064 6566 2072 656d 6170 5f6c 6179 6572   def remap_layer
-000138f0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00013900: 206c 6179 6572 6d61 702c 2069 6e63 6c75   layermap, inclu
-00013910: 6465 5f6c 6162 656c 733a 2062 6f6f 6c20  de_labels: bool 
-00013920: 3d20 5472 7565 2c20 696e 636c 7564 655f  = True, include_
-00013930: 7061 7468 733a 2062 6f6f 6c20 3d20 5472  paths: bool = Tr
-00013940: 7565 0a20 2020 2029 202d 3e20 436f 6d70  ue.    ) -> Comp
-00013950: 6f6e 656e 743a 0a20 2020 2020 2020 2022  onent:.        "
-00013960: 2222 5265 7475 726e 7320 6120 636f 7079  ""Returns a copy
-00013970: 206f 6620 7468 6520 636f 6d70 6f6e 656e   of the componen
-00013980: 7420 7769 7468 2072 656d 6170 7065 6420  t with remapped 
-00013990: 6c61 7965 7273 2e0a 0a20 2020 2020 2020  layers...       
-000139a0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-000139b0: 2020 206c 6179 6572 6d61 703a 2044 6963     layermap: Dic
-000139c0: 7469 6f6e 6172 7920 6f66 2076 616c 7565  tionary of value
-000139d0: 7320 696e 2066 6f72 6d61 7420 7b6c 6179  s in format {lay
-000139e0: 6572 5f66 726f 6d20 3a20 6c61 7965 725f  er_from : layer_
-000139f0: 746f 7d2e 0a20 2020 2020 2020 2020 2020  to}..           
-00013a00: 2069 6e63 6c75 6465 5f6c 6162 656c 733a   include_labels:
-00013a10: 2053 656c 6563 7473 2077 6865 7468 6572   Selects whether
-00013a20: 2074 6f20 6d6f 7665 204c 6162 656c 7320   to move Labels 
-00013a30: 616c 6f6e 6720 7769 7468 2070 6f6c 7967  along with polyg
-00013a40: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00013a50: 2069 6e63 6c75 6465 5f70 6174 6873 3a20   include_paths: 
-00013a60: 5365 6c65 6374 7320 7768 6574 6865 7220  Selects whether 
-00013a70: 746f 206d 6f76 6520 5061 7468 7320 616c  to move Paths al
-00013a80: 6f6e 6720 7769 7468 2070 6f6c 7967 6f6e  ong with polygon
-00013a90: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00013aa0: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
-00013ab0: 203d 2073 656c 662e 636f 7079 2829 0a20   = self.copy(). 
-00013ac0: 2020 2020 2020 206c 6179 6572 6d61 7020         layermap 
-00013ad0: 3d20 7b5f 7061 7273 655f 6c61 7965 7228  = {_parse_layer(
-00013ae0: 6b29 3a20 5f70 6172 7365 5f6c 6179 6572  k): _parse_layer
-00013af0: 2876 2920 666f 7220 6b2c 2076 2069 6e20  (v) for k, v in 
-00013b00: 6c61 7965 726d 6170 2e69 7465 6d73 2829  layermap.items()
-00013b10: 7d0a 0a20 2020 2020 2020 2061 6c6c 5f44  }..        all_D
-00013b20: 203d 206c 6973 7428 636f 6d70 6f6e 656e   = list(componen
-00013b30: 742e 6765 745f 6465 7065 6e64 656e 6369  t.get_dependenci
-00013b40: 6573 2854 7275 6529 290a 2020 2020 2020  es(True)).      
-00013b50: 2020 616c 6c5f 442e 6170 7065 6e64 2863    all_D.append(c
-00013b60: 6f6d 706f 6e65 6e74 290a 2020 2020 2020  omponent).      
-00013b70: 2020 666f 7220 4420 696e 2061 6c6c 5f44    for D in all_D
-00013b80: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-00013b90: 7220 7020 696e 2044 2e70 6f6c 7967 6f6e  r p in D.polygon
-00013ba0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00013bb0: 2020 206c 6179 6572 203d 2028 702e 6c61     layer = (p.la
-00013bc0: 7965 722c 2070 2e64 6174 6174 7970 6529  yer, p.datatype)
-00013bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013be0: 2069 6620 6c61 7965 7220 696e 206c 6179   if layer in lay
-00013bf0: 6572 6d61 703a 0a20 2020 2020 2020 2020  ermap:.         
-00013c00: 2020 2020 2020 2020 2020 206e 6577 5f6c             new_l
-00013c10: 6179 6572 203d 206c 6179 6572 6d61 705b  ayer = layermap[
-00013c20: 6c61 7965 725d 0a20 2020 2020 2020 2020  layer].         
-00013c30: 2020 2020 2020 2020 2020 2070 2e6c 6179             p.lay
-00013c40: 6572 203d 206e 6577 5f6c 6179 6572 5b30  er = new_layer[0
-00013c50: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00013c60: 2020 2020 2020 702e 6461 7461 7479 7065        p.datatype
-00013c70: 203d 206e 6577 5f6c 6179 6572 5b31 5d0a   = new_layer[1].
-00013c80: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00013c90: 6e63 6c75 6465 5f6c 6162 656c 733a 0a20  nclude_labels:. 
-00013ca0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00013cb0: 6f72 206c 6162 656c 2069 6e20 442e 6c61  or label in D.la
-00013cc0: 6265 6c73 3a0a 2020 2020 2020 2020 2020  bels:.          
-00013cd0: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-00013ce0: 616c 5f6c 6179 6572 203d 2028 6c61 6265  al_layer = (labe
-00013cf0: 6c2e 6c61 7965 722c 206c 6162 656c 2e74  l.layer, label.t
-00013d00: 6578 7474 7970 6529 0a20 2020 2020 2020  exttype).       
-00013d10: 2020 2020 2020 2020 2020 2020 206f 7269               ori
-00013d20: 6769 6e61 6c5f 6c61 7965 7220 3d20 5f70  ginal_layer = _p
-00013d30: 6172 7365 5f6c 6179 6572 286f 7269 6769  arse_layer(origi
-00013d40: 6e61 6c5f 6c61 7965 7229 0a20 2020 2020  nal_layer).     
-00013d50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00013d60: 6620 6f72 6967 696e 616c 5f6c 6179 6572  f original_layer
-00013d70: 2069 6e20 6c61 7965 726d 6170 3a0a 2020   in layermap:.  
-00013d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d90: 2020 2020 2020 6e65 775f 6c61 7965 7220        new_layer 
-00013da0: 3d20 6c61 7965 726d 6170 5b6f 7269 6769  = layermap[origi
-00013db0: 6e61 6c5f 6c61 7965 725d 0a20 2020 2020  nal_layer].     
-00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dd0: 2020 206c 6162 656c 2e6c 6179 6572 203d     label.layer =
-00013de0: 206e 6577 5f6c 6179 6572 5b30 5d0a 2020   new_layer[0].  
-00013df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e00: 2020 2020 2020 6c61 6265 6c2e 7465 7874        label.text
-00013e10: 7479 7065 203d 206e 6577 5f6c 6179 6572  type = new_layer
-00013e20: 5b31 5d0a 0a20 2020 2020 2020 2020 2020  [1]..           
-00013e30: 2069 6620 696e 636c 7564 655f 7061 7468   if include_path
-00013e40: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00013e50: 2020 2066 6f72 2070 6174 6820 696e 2044     for path in D
-00013e60: 2e70 6174 6873 3a0a 2020 2020 2020 2020  .paths:.        
-00013e70: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00013e80: 6c61 7965 7273 203d 206c 6973 7428 7061  layers = list(pa
-00013e90: 7468 2e6c 6179 6572 7329 0a20 2020 2020  th.layers).     
-00013ea0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00013eb0: 6577 5f64 6174 6174 7970 6573 203d 206c  ew_datatypes = l
-00013ec0: 6973 7428 7061 7468 2e64 6174 6174 7970  ist(path.datatyp
-00013ed0: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00013ee0: 2020 2020 2020 2020 666f 7220 6c61 7965          for laye
-00013ef0: 725f 6e75 6d62 6572 2069 6e20 7261 6e67  r_number in rang
-00013f00: 6528 6c65 6e28 6e65 775f 6c61 7965 7273  e(len(new_layers
-00013f10: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00013f20: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-00013f30: 696e 616c 5f6c 6179 6572 203d 205f 7061  inal_layer = _pa
-00013f40: 7273 655f 6c61 7965 7228 0a20 2020 2020  rse_layer(.     
-00013f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f60: 2020 2020 2020 2028 6e65 775f 6c61 7965         (new_laye
-00013f70: 7273 5b6c 6179 6572 5f6e 756d 6265 725d  rs[layer_number]
-00013f80: 2c20 6e65 775f 6461 7461 7479 7065 735b  , new_datatypes[
-00013f90: 6c61 7965 725f 6e75 6d62 6572 5d29 0a20  layer_number]). 
-00013fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fd0: 2069 6620 6f72 6967 696e 616c 5f6c 6179   if original_lay
-00013fe0: 6572 2069 6e20 6c61 7965 726d 6170 3a0a  er in layermap:.
-00013ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014000: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00014010: 6c61 7965 7220 3d20 6c61 7965 726d 6170  layer = layermap
-00014020: 5b6f 7269 6769 6e61 6c5f 6c61 7965 725d  [original_layer]
-00014030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014040: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00014050: 5f6c 6179 6572 735b 6c61 7965 725f 6e75  _layers[layer_nu
-00014060: 6d62 6572 5d20 3d20 6e65 775f 6c61 7965  mber] = new_laye
-00014070: 725b 305d 0a20 2020 2020 2020 2020 2020  r[0].           
-00014080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014090: 206e 6577 5f64 6174 6174 7970 6573 5b6c   new_datatypes[l
-000140a0: 6179 6572 5f6e 756d 6265 725d 203d 206e  ayer_number] = n
-000140b0: 6577 5f6c 6179 6572 5b31 5d0a 2020 2020  ew_layer[1].    
-000140c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140d0: 7061 7468 2e73 6574 5f6c 6179 6572 7328  path.set_layers(
-000140e0: 2a6e 6577 5f6c 6179 6572 7329 0a20 2020  *new_layers).   
-000140f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014100: 2070 6174 682e 7365 745f 6461 7461 7479   path.set_dataty
-00014110: 7065 7328 2a6e 6577 5f64 6174 6174 7970  pes(*new_datatyp
-00014120: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
-00014130: 726e 2063 6f6d 706f 6e65 6e74 0a0a 2020  rn component..  
-00014140: 2020 6465 6620 746f 5f33 6428 0a20 2020    def to_3d(.   
-00014150: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00014160: 2020 206c 6179 6572 5f76 6965 7773 3a20     layer_views: 
-00014170: 4f70 7469 6f6e 616c 5b4c 6179 6572 5669  Optional[LayerVi
-00014180: 6577 735d 203d 204e 6f6e 652c 0a20 2020  ews] = None,.   
-00014190: 2020 2020 206c 6179 6572 5f73 7461 636b       layer_stack
-000141a0: 3a20 4f70 7469 6f6e 616c 5b4c 6179 6572  : Optional[Layer
-000141b0: 5374 6163 6b5d 203d 204e 6f6e 652c 0a20  Stack] = None,. 
-000141c0: 2020 2020 2020 2065 7863 6c75 6465 5f6c         exclude_l
-000141d0: 6179 6572 733a 204f 7074 696f 6e61 6c5b  ayers: Optional[
-000141e0: 5475 706c 655b 4c61 7965 722c 202e 2e2e  Tuple[Layer, ...
-000141f0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-00014200: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00014210: 7572 6e20 436f 6d70 6f6e 656e 7420 3344  urn Component 3D
-00014220: 2074 7269 6d65 7368 2053 6365 6e65 2e0a   trimesh Scene..
-00014230: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00014240: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00014250: 6e65 6e74 3a20 746f 2065 7874 7275 6465  nent: to extrude
-00014260: 2069 6e20 3344 2e0a 2020 2020 2020 2020   in 3D..        
-00014270: 2020 2020 6c61 7965 725f 7669 6577 733a      layer_views:
-00014280: 206c 6179 6572 2063 6f6c 6f72 7320 6672   layer colors fr
-00014290: 6f6d 204b 6c61 796f 7574 204c 6179 6572  om Klayout Layer
-000142a0: 2050 726f 7065 7274 6965 7320 6669 6c65   Properties file
-000142b0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000142c0: 2020 4465 6661 756c 7473 2074 6f20 6163    Defaults to ac
-000142d0: 7469 7665 2050 444b 2e6c 6179 6572 5f76  tive PDK.layer_v
-000142e0: 6965 7773 2e0a 2020 2020 2020 2020 2020  iews..          
-000142f0: 2020 6c61 7965 725f 7374 6163 6b3a 2063    layer_stack: c
-00014300: 6f6e 7461 696e 7320 7468 6963 6b6e 6573  ontains thicknes
-00014310: 7320 616e 6420 7a6d 696e 2066 6f72 2065  s and zmin for e
-00014320: 6163 6820 6c61 7965 722e 0a20 2020 2020  ach layer..     
-00014330: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00014340: 6c74 7320 746f 2061 6374 6976 6520 5044  lts to active PD
-00014350: 4b2e 6c61 7965 725f 7374 6163 6b2e 0a20  K.layer_stack.. 
-00014360: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
-00014370: 6465 5f6c 6179 6572 733a 206c 6179 6572  de_layers: layer
-00014380: 7320 746f 2065 7863 6c75 6465 2e0a 0a20  s to exclude... 
-00014390: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000143a0: 2020 2066 726f 6d20 6764 7366 6163 746f     from gdsfacto
-000143b0: 7279 2e65 7870 6f72 742e 746f 5f33 6420  ry.export.to_3d 
-000143c0: 696d 706f 7274 2074 6f5f 3364 0a0a 2020  import to_3d..  
-000143d0: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-000143e0: 3364 280a 2020 2020 2020 2020 2020 2020  3d(.            
-000143f0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00014400: 2020 6c61 7965 725f 7669 6577 733d 6c61    layer_views=la
-00014410: 7965 725f 7669 6577 732c 0a20 2020 2020  yer_views,.     
-00014420: 2020 2020 2020 206c 6179 6572 5f73 7461         layer_sta
-00014430: 636b 3d6c 6179 6572 5f73 7461 636b 2c0a  ck=layer_stack,.
-00014440: 2020 2020 2020 2020 2020 2020 6578 636c              excl
-00014450: 7564 655f 6c61 7965 7273 3d65 7863 6c75  ude_layers=exclu
-00014460: 6465 5f6c 6179 6572 732c 0a20 2020 2020  de_layers,.     
-00014470: 2020 2029 0a0a 2020 2020 6465 6620 746f     )..    def to
-00014480: 5f6e 7028 0a20 2020 2020 2020 2073 656c  _np(.        sel
-00014490: 662c 0a20 2020 2020 2020 206e 6d5f 7065  f,.        nm_pe
-000144a0: 725f 7069 7865 6c3a 2069 6e74 203d 2032  r_pixel: int = 2
-000144b0: 302c 0a20 2020 2020 2020 206c 6179 6572  0,.        layer
-000144c0: 733a 204c 6179 6572 7320 3d20 2828 312c  s: Layers = ((1,
-000144d0: 2030 292c 292c 0a20 2020 2020 2020 2076   0),),.        v
-000144e0: 616c 7565 733a 204f 7074 696f 6e61 6c5b  alues: Optional[
-000144f0: 5475 706c 655b 666c 6f61 742c 202e 2e2e  Tuple[float, ...
-00014500: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-00014510: 2020 2070 6164 5f77 6964 7468 3a20 696e     pad_width: in
-00014520: 7420 3d20 312c 0a20 2020 2029 202d 3e20  t = 1,.    ) -> 
-00014530: 6e70 2e6e 6461 7272 6179 3a0a 2020 2020  np.ndarray:.    
-00014540: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-00014550: 2070 6978 656c 6174 6564 206e 756d 7079   pixelated numpy
-00014560: 2061 7272 6179 2066 726f 6d20 436f 6d70   array from Comp
-00014570: 6f6e 656e 7420 706f 6c79 676f 6e73 2e0a  onent polygons..
-00014580: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00014590: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-000145a0: 6e65 6e74 3a20 436f 6d70 6f6e 656e 742e  nent: Component.
-000145b0: 0a20 2020 2020 2020 2020 2020 206e 6d5f  .            nm_
-000145c0: 7065 725f 7069 7865 6c3a 2079 6f75 2063  per_pixel: you c
-000145d0: 616e 2067 6f20 6672 6f6d 2032 3020 2863  an go from 20 (c
-000145e0: 6f61 7273 6529 2074 6f20 3420 2866 696e  oarse) to 4 (fin
-000145f0: 6529 2e0a 2020 2020 2020 2020 2020 2020  e)..            
-00014600: 6c61 7965 7273 3a20 746f 2063 6f6e 7665  layers: to conve
-00014610: 7274 2e20 4f72 6465 7220 6d61 7474 6572  rt. Order matter
-00014620: 7320 286c 6174 7465 7220 6f76 6572 7772  s (latter overwr
-00014630: 6974 6520 666f 726d 6572 292e 0a20 2020  ite former)..   
-00014640: 2020 2020 2020 2020 2076 616c 7565 733a           values:
-00014650: 2061 7373 6f63 6961 7465 6420 746f 2065   associated to e
-00014660: 6163 6820 6c61 7965 7220 2864 6566 6175  ach layer (defau
-00014670: 6c74 7320 746f 2031 292e 0a20 2020 2020  lts to 1)..     
-00014680: 2020 2020 2020 2070 6164 5f77 6964 7468         pad_width
-00014690: 3a20 7061 6464 696e 6720 7069 7865 6c73  : padding pixels
-000146a0: 2061 726f 756e 6420 7468 6520 696d 6167   around the imag
-000146b0: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-000146c0: 2020 2020 2020 2020 6672 6f6d 2067 6473          from gds
-000146d0: 6661 6374 6f72 792e 6578 706f 7274 2e74  factory.export.t
-000146e0: 6f5f 6e70 2069 6d70 6f72 7420 746f 5f6e  o_np import to_n
-000146f0: 700a 0a20 2020 2020 2020 2072 6574 7572  p..        retur
-00014700: 6e20 746f 5f6e 7028 0a20 2020 2020 2020  n to_np(.       
-00014710: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00014720: 2020 2020 2020 206e 6d5f 7065 725f 7069         nm_per_pi
-00014730: 7865 6c3d 6e6d 5f70 6572 5f70 6978 656c  xel=nm_per_pixel
-00014740: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
-00014750: 7965 7273 3d6c 6179 6572 732c 0a20 2020  yers=layers,.   
-00014760: 2020 2020 2020 2020 2076 616c 7565 733d           values=
-00014770: 7661 6c75 6573 2c0a 2020 2020 2020 2020  values,.        
-00014780: 2020 2020 7061 645f 7769 6474 683d 7061      pad_width=pa
-00014790: 645f 7769 6474 682c 0a20 2020 2020 2020  d_width,.       
-000147a0: 2029 0a0a 2020 2020 6465 6620 7772 6974   )..    def writ
-000147b0: 655f 7374 6c28 0a20 2020 2020 2020 2073  e_stl(.        s
-000147c0: 656c 662c 0a20 2020 2020 2020 2066 696c  elf,.        fil
-000147d0: 6570 6174 683a 2073 7472 2c0a 2020 2020  epath: str,.    
-000147e0: 2020 2020 6c61 7965 725f 7374 6163 6b3a      layer_stack:
-000147f0: 204f 7074 696f 6e61 6c5b 4c61 7965 7253   Optional[LayerS
-00014800: 7461 636b 5d20 3d20 4e6f 6e65 2c0a 2020  tack] = None,.  
-00014810: 2020 2020 2020 6578 636c 7564 655f 6c61        exclude_la
-00014820: 7965 7273 3a20 4f70 7469 6f6e 616c 5b54  yers: Optional[T
-00014830: 7570 6c65 5b4c 6179 6572 2c20 2e2e 2e5d  uple[Layer, ...]
-00014840: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-00014850: 2d3e 206e 702e 6e64 6172 7261 793a 0a20  -> np.ndarray:. 
-00014860: 2020 2020 2020 2022 2222 5772 6974 6520         """Write 
-00014870: 6120 436f 6d70 6f6e 656e 7420 746f 2053  a Component to S
-00014880: 544c 2066 6f72 2033 4420 7072 696e 7469  TL for 3D printi
-00014890: 6e67 2e0a 0a20 2020 2020 2020 2041 7267  ng...        Arg
-000148a0: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
-000148b0: 696c 6570 6174 683a 2074 6f20 7772 6974  ilepath: to writ
-000148c0: 6520 5354 4c20 746f 2e0a 2020 2020 2020  e STL to..      
-000148d0: 2020 2020 2020 6c61 7965 725f 7374 6163        layer_stac
-000148e0: 6b3a 2063 6f6e 7461 696e 7320 7468 6963  k: contains thic
-000148f0: 6b6e 6573 7320 616e 6420 7a6d 696e 2066  kness and zmin f
-00014900: 6f72 2065 6163 6820 6c61 7965 722e 0a20  or each layer.. 
-00014910: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
-00014920: 6465 5f6c 6179 6572 733a 206c 6179 6572  de_layers: layer
-00014930: 7320 746f 2065 7863 6c75 6465 2e0a 2020  s to exclude..  
-00014940: 2020 2020 2020 2020 2020 7573 655f 6c61            use_la
-00014950: 7965 725f 6e61 6d65 3a20 4966 2054 7275  yer_name: If Tru
-00014960: 652c 2075 7365 7320 4c61 7965 724c 6576  e, uses LayerLev
-00014970: 656c 206e 616d 6573 2069 6e20 6f75 7470  el names in outp
-00014980: 7574 2066 696c 656e 616d 6573 2072 6174  ut filenames rat
-00014990: 6865 7220 7468 616e 2067 6473 5f6c 6179  her than gds_lay
-000149a0: 6572 2061 6e64 2067 6473 5f64 6174 6174  er and gds_datat
-000149b0: 7970 652e 0a20 2020 2020 2020 2020 2020  ype..           
-000149c0: 2068 756c 6c5f 696e 7661 6c69 645f 706f   hull_invalid_po
-000149d0: 6c79 676f 6e73 3a20 4966 2054 7275 652c  lygons: If True,
-000149e0: 2072 6570 6c61 6365 7320 696e 7661 6c69   replaces invali
-000149f0: 6420 706f 6c79 676f 6e73 2028 6465 7465  d polygons (dete
-00014a00: 726d 696e 6564 2062 7920 7368 6170 656c  rmined by shapel
-00014a10: 792e 506f 6c79 676f 6e2e 6973 5f76 616c  y.Polygon.is_val
-00014a20: 6964 2920 7769 7468 2069 7473 2063 6f6e  id) with its con
-00014a30: 7665 7820 6875 6c6c 2e0a 2020 2020 2020  vex hull..      
-00014a40: 2020 2020 2020 7363 616c 653a 204f 7074        scale: Opt
-00014a50: 696f 6e61 6c20 6661 6374 6f72 2062 7920  ional factor by 
-00014a60: 7768 6963 6820 746f 2073 6361 6c65 206d  which to scale m
-00014a70: 6573 6865 7320 6265 666f 7265 2077 7269  eshes before wri
-00014a80: 7469 6e67 2e0a 0a20 2020 2020 2020 2022  ting...        "
-00014a90: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00014aa0: 6764 7366 6163 746f 7279 2e65 7870 6f72  gdsfactory.expor
-00014ab0: 742e 746f 5f73 746c 2069 6d70 6f72 7420  t.to_stl import 
-00014ac0: 746f 5f73 746c 0a0a 2020 2020 2020 2020  to_stl..        
-00014ad0: 7265 7475 726e 2074 6f5f 7374 6c28 0a20  return to_stl(. 
-00014ae0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00014af0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-00014b00: 6570 6174 683d 6669 6c65 7061 7468 2c0a  epath=filepath,.
-00014b10: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00014b20: 725f 7374 6163 6b3d 6c61 7965 725f 7374  r_stack=layer_st
-00014b30: 6163 6b2c 0a20 2020 2020 2020 2020 2020  ack,.           
-00014b40: 2065 7863 6c75 6465 5f6c 6179 6572 733d   exclude_layers=
-00014b50: 6578 636c 7564 655f 6c61 7965 7273 2c0a  exclude_layers,.
-00014b60: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00014b70: 6566 2074 6f5f 676d 7368 280a 2020 2020  ef to_gmsh(.    
-00014b80: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00014b90: 2020 7479 7065 2c0a 2020 2020 2020 2020    type,.        
-00014ba0: 7a3d 4e6f 6e65 2c0a 2020 2020 2020 2020  z=None,.        
-00014bb0: 7873 6563 7469 6f6e 5f62 6f75 6e64 733d  xsection_bounds=
-00014bc0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00014bd0: 7965 725f 7374 6163 6b3d 4e6f 6e65 2c0a  yer_stack=None,.
-00014be0: 2020 2020 2020 2020 7761 6665 725f 7061          wafer_pa
-00014bf0: 6464 696e 673d 302e 302c 0a20 2020 2020  dding=0.0,.     
-00014c00: 2020 2077 6166 6572 5f6c 6179 6572 3d4c     wafer_layer=L
-00014c10: 4159 4552 2e57 4146 4552 2c0a 2020 2020  AYER.WAFER,.    
-00014c20: 2020 2020 2a61 7267 732c 0a20 2020 2020      *args,.     
-00014c30: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-00014c40: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
-00014c50: 6574 7572 6e73 2061 2067 6d73 6820 6d73  eturns a gmsh ms
-00014c60: 6820 6f66 2074 6865 2063 6f6d 706f 6e65  h of the compone
-00014c70: 6e74 2066 6f72 2066 696e 6974 6520 656c  nt for finite el
-00014c80: 656d 656e 7420 7369 6d75 6c61 7469 6f6e  ement simulation
-00014c90: 2e0a 0a20 2020 2020 2020 2041 7267 756d  ...        Argum
-00014ca0: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-00014cb0: 2020 7479 7065 3a20 6f6e 6520 6f66 2022    type: one of "
-00014cc0: 7879 222c 2022 757a 222c 206f 7220 2233  xy", "uz", or "3
-00014cd0: 4422 2e20 4465 7465 726d 696e 6573 2074  D". Determines t
-00014ce0: 6865 2074 7970 6520 6f66 206d 6573 6820  he type of mesh 
-00014cf0: 746f 2072 6574 7572 6e2e 0a20 2020 2020  to return..     
-00014d00: 2020 2020 2020 207a 3a20 7573 6564 2074         z: used t
-00014d10: 6f20 6465 6669 6e65 207a 2d73 6c69 6365  o define z-slice
-00014d20: 2066 6f72 2078 7920 6d65 7368 696e 670a   for xy meshing.
-00014d30: 2020 2020 2020 2020 2020 2020 7873 6563              xsec
-00014d40: 7469 6f6e 5f62 6f75 6e64 733a 2075 7365  tion_bounds: use
-00014d50: 6420 746f 2064 6566 696e 6520 696e 2d70  d to define in-p
-00014d60: 6c61 6e65 206c 696e 6520 666f 7220 757a  lane line for uz
-00014d70: 206d 6573 6869 6e67 0a20 2020 2020 2020   meshing.       
-00014d80: 2020 2020 2077 6166 6572 5f70 6164 6469       wafer_paddi
-00014d90: 6e67 3a20 7061 6464 696e 6720 6265 796f  ng: padding beyo
-00014da0: 6e64 2062 626f 7820 746f 2061 6464 2074  nd bbox to add t
-00014db0: 6f20 5741 4645 5220 6c61 7965 7273 2e0a  o WAFER layers..
-00014dc0: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
-00014dd0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00014de0: 2020 2041 7267 756d 656e 7473 2066 6f72     Arguments for
-00014df0: 2074 6865 2074 6172 6765 7420 6d65 7368   the target mesh
-00014e00: 696e 6720 6675 6e63 7469 6f6e 2069 6e20  ing function in 
-00014e10: 6764 7366 6163 746f 7279 2e73 696d 756c  gdsfactory.simul
-00014e20: 6174 696f 6e2e 676d 7368 0a20 2020 2020  ation.gmsh.     
-00014e30: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00014e40: 2041 6464 2057 4146 4552 206c 6179 6572   Add WAFER layer
-00014e50: 3a0a 2020 2020 2020 2020 7061 6464 6564  :.        padded
-00014e60: 5f63 6f6d 706f 6e65 6e74 203d 2043 6f6d  _component = Com
-00014e70: 706f 6e65 6e74 2829 0a20 2020 2020 2020  ponent().       
-00014e80: 2070 6164 6465 645f 636f 6d70 6f6e 656e   padded_componen
-00014e90: 7420 3c3c 2073 656c 660a 2020 2020 2020  t << self.      
-00014ea0: 2020 2878 6d69 6e2c 2079 6d69 6e29 2c20    (xmin, ymin), 
-00014eb0: 2878 6d61 782c 2079 6d61 7829 203d 2073  (xmax, ymax) = s
-00014ec0: 656c 662e 6262 6f78 0a20 2020 2020 2020  elf.bbox.       
-00014ed0: 2070 6f69 6e74 7320 3d20 5b0a 2020 2020   points = [.    
-00014ee0: 2020 2020 2020 2020 5b78 6d69 6e20 2d20          [xmin - 
-00014ef0: 7761 6665 725f 7061 6464 696e 672c 2079  wafer_padding, y
-00014f00: 6d69 6e20 2d20 7761 6665 725f 7061 6464  min - wafer_padd
-00014f10: 696e 675d 2c0a 2020 2020 2020 2020 2020  ing],.          
-00014f20: 2020 5b78 6d61 7820 2b20 7761 6665 725f    [xmax + wafer_
-00014f30: 7061 6464 696e 672c 2079 6d69 6e20 2d20  padding, ymin - 
-00014f40: 7761 6665 725f 7061 6464 696e 675d 2c0a  wafer_padding],.
-00014f50: 2020 2020 2020 2020 2020 2020 5b78 6d61              [xma
-00014f60: 7820 2b20 7761 6665 725f 7061 6464 696e  x + wafer_paddin
-00014f70: 672c 2079 6d61 7820 2b20 7761 6665 725f  g, ymax + wafer_
-00014f80: 7061 6464 696e 675d 2c0a 2020 2020 2020  padding],.      
-00014f90: 2020 2020 2020 5b78 6d69 6e20 2d20 7761        [xmin - wa
-00014fa0: 6665 725f 7061 6464 696e 672c 2079 6d61  fer_padding, yma
-00014fb0: 7820 2b20 7761 6665 725f 7061 6464 696e  x + wafer_paddin
-00014fc0: 675d 2c0a 2020 2020 2020 2020 5d0a 2020  g],.        ].  
-00014fd0: 2020 2020 2020 7061 6464 6564 5f63 6f6d        padded_com
-00014fe0: 706f 6e65 6e74 2e61 6464 5f70 6f6c 7967  ponent.add_polyg
-00014ff0: 6f6e 2870 6f69 6e74 732c 206c 6179 6572  on(points, layer
-00015000: 3d77 6166 6572 5f6c 6179 6572 290a 0a20  =wafer_layer).. 
-00015010: 2020 2020 2020 2069 6620 6c61 7965 725f         if layer_
-00015020: 7374 6163 6b20 6973 204e 6f6e 653a 0a20  stack is None:. 
-00015030: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00015040: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00015050: 2020 2020 2020 2020 2020 2020 2027 4120               'A 
-00015060: 4c61 7965 7253 7461 636b 206d 7573 7420  LayerStack must 
-00015070: 6265 2070 726f 7669 6465 6420 7468 726f  be provided thro
-00015080: 7567 6820 6172 6775 6d65 6e74 2022 6c61  ugh argument "la
-00015090: 7965 725f 7374 6163 6b22 2e27 0a20 2020  yer_stack".'.   
-000150a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000150b0: 2020 2069 6620 7479 7065 203d 3d20 2278     if type == "x
-000150c0: 7922 3a0a 2020 2020 2020 2020 2020 2020  y":.            
-000150d0: 6966 207a 2069 7320 4e6f 6e65 3a0a 2020  if z is None:.  
-000150e0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000150f0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00015100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015110: 2020 2020 2746 6f72 2078 792d 6d65 7368      'For xy-mesh
-00015120: 696e 672c 2061 207a 2d76 616c 7565 206d  ing, a z-value m
-00015130: 7573 7420 6265 2070 726f 7669 6465 6420  ust be provided 
-00015140: 7669 6120 7468 6520 666c 6f61 7420 6172  via the float ar
-00015150: 6775 6d65 6e74 2022 7a22 2e27 0a20 2020  gument "z".'.   
-00015160: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00015170: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00015180: 6764 7366 6163 746f 7279 2e73 696d 756c  gdsfactory.simul
-00015190: 6174 696f 6e2e 676d 7368 2e78 795f 7873  ation.gmsh.xy_xs
-000151a0: 6563 7469 6f6e 5f6d 6573 6820 696d 706f  ection_mesh impo
-000151b0: 7274 2078 795f 7873 6563 7469 6f6e 5f6d  rt xy_xsection_m
-000151c0: 6573 680a 0a20 2020 2020 2020 2020 2020  esh..           
-000151d0: 2072 6574 7572 6e20 7879 5f78 7365 6374   return xy_xsect
-000151e0: 696f 6e5f 6d65 7368 2870 6164 6465 645f  ion_mesh(padded_
-000151f0: 636f 6d70 6f6e 656e 742c 207a 2c20 6c61  component, z, la
-00015200: 7965 725f 7374 6163 6b2c 202a 2a6b 7761  yer_stack, **kwa
-00015210: 7267 7329 0a20 2020 2020 2020 2065 6c69  rgs).        eli
-00015220: 6620 7479 7065 203d 3d20 2275 7a22 3a0a  f type == "uz":.
-00015230: 2020 2020 2020 2020 2020 2020 6966 2078              if x
-00015240: 7365 6374 696f 6e5f 626f 756e 6473 2069  section_bounds i
-00015250: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00015260: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00015270: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00015280: 2020 2020 2020 2020 2020 2020 2020 2246                "F
-00015290: 6f72 2075 7a2d 6d65 7368 696e 672c 2079  or uz-meshing, y
-000152a0: 6f75 206d 7573 7420 7072 6f76 6964 6520  ou must provide 
-000152b0: 6120 6c69 6e65 2069 6e20 7468 6520 7879  a line in the xy
-000152c0: 2d70 6c61 6e65 2022 0a20 2020 2020 2020  -plane ".       
-000152d0: 2020 2020 2020 2020 2020 2020 2022 7669               "vi
-000152e0: 6120 7468 6520 5475 706c 6520 6172 6775  a the Tuple argu
-000152f0: 6d65 6e74 205b 5b78 312c 7931 5d2c 205b  ment [[x1,y1], [
-00015300: 7832 2c79 325d 5d20 7873 6563 7469 6f6e  x2,y2]] xsection
-00015310: 5f62 6f75 6e64 732e 220a 2020 2020 2020  _bounds.".      
-00015320: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00015330: 2020 2020 2020 2020 6672 6f6d 2067 6473          from gds
-00015340: 6661 6374 6f72 792e 7369 6d75 6c61 7469  factory.simulati
-00015350: 6f6e 2e67 6d73 682e 757a 5f78 7365 6374  on.gmsh.uz_xsect
-00015360: 696f 6e5f 6d65 7368 2069 6d70 6f72 7420  ion_mesh import 
-00015370: 757a 5f78 7365 6374 696f 6e5f 6d65 7368  uz_xsection_mesh
-00015380: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00015390: 7475 726e 2075 7a5f 7873 6563 7469 6f6e  turn uz_xsection
-000153a0: 5f6d 6573 6828 0a20 2020 2020 2020 2020  _mesh(.         
-000153b0: 2020 2020 2020 2070 6164 6465 645f 636f         padded_co
-000153c0: 6d70 6f6e 656e 742c 2078 7365 6374 696f  mponent, xsectio
-000153d0: 6e5f 626f 756e 6473 2c20 6c61 7965 725f  n_bounds, layer_
-000153e0: 7374 6163 6b2c 202a 2a6b 7761 7267 730a  stack, **kwargs.
-000153f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00015400: 2020 2020 2020 656c 6966 2074 7970 6520        elif type 
-00015410: 3d3d 2022 3344 223a 0a20 2020 2020 2020  == "3D":.       
-00015420: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
-00015430: 746f 7279 2e73 696d 756c 6174 696f 6e2e  tory.simulation.
-00015440: 676d 7368 2e78 797a 5f6d 6573 6820 696d  gmsh.xyz_mesh im
-00015450: 706f 7274 2078 797a 5f6d 6573 680a 0a20  port xyz_mesh.. 
-00015460: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00015470: 6e20 7879 7a5f 6d65 7368 2870 6164 6465  n xyz_mesh(padde
-00015480: 645f 636f 6d70 6f6e 656e 742c 206c 6179  d_component, lay
-00015490: 6572 5f73 7461 636b 2c20 2a2a 6b77 6172  er_stack, **kwar
-000154a0: 6773 290a 2020 2020 2020 2020 656c 7365  gs).        else
-000154b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000154c0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-000154d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154e0: 2752 6571 7569 7265 6420 6172 6775 6d65  'Required argume
-000154f0: 6e74 2022 7479 7065 2220 6d75 7374 2062  nt "type" must b
-00015500: 6520 6f6e 6520 6f66 2022 7879 222c 2022  e one of "xy", "
-00015510: 757a 222c 206f 7220 2233 4422 2e27 0a20  uz", or "3D".'. 
-00015520: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00015530: 2020 6465 6620 6f66 6673 6574 280a 2020    def offset(.  
-00015540: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00015550: 2020 2020 6469 7374 616e 6365 3a20 666c      distance: fl
-00015560: 6f61 7420 3d20 302e 312c 0a20 2020 2020  oat = 0.1,.     
-00015570: 2020 2070 6f6c 7967 6f6e 733d 4e6f 6e65     polygons=None
-00015580: 2c0a 2020 2020 2020 2020 7573 655f 756e  ,.        use_un
-00015590: 696f 6e3a 2062 6f6f 6c20 3d20 5472 7565  ion: bool = True
-000155a0: 2c0a 2020 2020 2020 2020 7072 6563 6973  ,.        precis
-000155b0: 696f 6e3a 2066 6c6f 6174 203d 2031 652d  ion: float = 1e-
-000155c0: 342c 0a20 2020 2020 2020 206a 6f69 6e3a  4,.        join:
-000155d0: 2073 7472 203d 2022 6d69 7465 7222 2c0a   str = "miter",.
-000155e0: 2020 2020 2020 2020 746f 6c65 7261 6e63          toleranc
-000155f0: 653a 2069 6e74 203d 2032 2c0a 2020 2020  e: int = 2,.    
-00015600: 2020 2020 6c61 7965 723a 204c 6179 6572      layer: Layer
-00015610: 5370 6563 203d 2022 5747 222c 0a20 2020  Spec = "WG",.   
-00015620: 2029 202d 3e20 436f 6d70 6f6e 656e 743a   ) -> Component:
-00015630: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00015640: 726e 7320 6e65 7720 436f 6d70 6f6e 656e  rns new Componen
-00015650: 7420 7769 7468 2070 6f6c 7967 6f6e 7320  t with polygons 
-00015660: 6572 6f64 6564 206f 7220 6469 6c61 7465  eroded or dilate
-00015670: 6420 6279 2061 6e20 6f66 6673 6574 2e0a  d by an offset..
-00015680: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00015690: 2020 2020 2020 2020 2020 2064 6973 7461             dista
-000156a0: 6e63 653a 2044 6973 7461 6e63 6520 746f  nce: Distance to
-000156b0: 206f 6666 7365 7420 706f 6c79 676f 6e73   offset polygons
-000156c0: 2e20 506f 7369 7469 7665 2076 616c 7565  . Positive value
-000156d0: 7320 6578 7061 6e64 2c20 6e65 6761 7469  s expand, negati
-000156e0: 7665 2073 6872 696e 6b2e 0a20 2020 2020  ve shrink..     
+0000fb40: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb60: 2020 2020 2020 2066 2244 7570 6c69 6361         f"Duplica
+0000fb70: 7465 6420 6365 6c6c 206e 616d 6573 2069  ted cell names i
+0000fb80: 6e20 7b74 6f70 5f63 656c 6c2e 6e61 6d65  n {top_cell.name
+0000fb90: 2172 7d3a 2020 7b63 656c 6c5f 6e61 6d65  !r}:  {cell_name
+0000fba0: 737d 222c 0a20 2020 2020 2020 2020 2020  s}",.           
+0000fbb0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0000fbc0: 636b 6c65 7665 6c3d 332c 0a20 2020 2020  cklevel=3,.     
+0000fbd0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000fbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fbf0: 2063 656c 6c73 5f64 6963 7420 3d20 7b63   cells_dict = {c
+0000fc00: 656c 6c2e 6e61 6d65 3a20 6365 6c6c 2e5f  ell.name: cell._
+0000fc10: 6365 6c6c 2066 6f72 2063 656c 6c20 696e  cell for cell in
+0000fc20: 2063 656c 6c73 7d0a 2020 2020 2020 2020   cells}.        
+0000fc30: 2020 2020 2020 2020 6365 6c6c 7320 3d20          cells = 
+0000fc40: 6365 6c6c 735f 6469 6374 2e76 616c 7565  cells_dict.value
+0000fc50: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0000fc60: 656c 6966 2077 7269 7465 5f73 6574 7469  elif write_setti
+0000fc70: 6e67 732e 6f6e 5f64 7570 6c69 6361 7465  ngs.on_duplicate
+0000fc80: 5f63 656c 6c20 6973 206e 6f74 204e 6f6e  _cell is not Non
+0000fc90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000fca0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000fcb0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000fcc0: 2020 2020 2020 2020 2066 226f 6e5f 6475           f"on_du
+0000fcd0: 706c 6963 6174 655f 6365 6c6c 3a20 7b77  plicate_cell: {w
+0000fce0: 7269 7465 5f73 6574 7469 6e67 732e 6f6e  rite_settings.on
+0000fcf0: 5f64 7570 6c69 6361 7465 5f63 656c 6c21  _duplicate_cell!
+0000fd00: 727d 206e 6f74 2069 6e20 284e 6f6e 652c  r} not in (None,
+0000fd10: 2077 6172 6e2c 2065 7272 6f72 2c20 6f76   warn, error, ov
+0000fd20: 6572 7772 6974 6529 220a 2020 2020 2020  erwrite)".      
+0000fd30: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000fd40: 2020 2020 2061 6c6c 5f63 656c 6c73 203d       all_cells =
+0000fd50: 205b 746f 705f 6365 6c6c 2e5f 6365 6c6c   [top_cell._cell
+0000fd60: 5d20 2b20 736f 7274 6564 2863 656c 6c73  ] + sorted(cells
+0000fd70: 2c20 6b65 793d 6c61 6d62 6461 2063 633a  , key=lambda cc:
+0000fd80: 2063 632e 6e61 6d65 290a 0a20 2020 2020   cc.name)..     
+0000fd90: 2020 206e 6f5f 6e61 6d65 5f63 656c 6c73     no_name_cells
+0000fda0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0000fdb0: 2063 656c 6c2e 6e61 6d65 2066 6f72 2063   cell.name for c
+0000fdc0: 656c 6c20 696e 2061 6c6c 5f63 656c 6c73  ell in all_cells
+0000fdd0: 2069 6620 6365 6c6c 2e6e 616d 652e 7374   if cell.name.st
+0000fde0: 6172 7473 7769 7468 2822 556e 6e61 6d65  artswith("Unname
+0000fdf0: 6422 290a 2020 2020 2020 2020 5d0a 0a20  d").        ].. 
+0000fe00: 2020 2020 2020 2069 6620 6e6f 5f6e 616d         if no_nam
+0000fe10: 655f 6365 6c6c 733a 0a20 2020 2020 2020  e_cells:.       
+0000fe20: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0000fe30: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+0000fe40: 2020 2020 6622 436f 6d70 6f6e 656e 7420      f"Component 
+0000fe50: 7b74 6f70 5f63 656c 6c2e 6e61 6d65 2172  {top_cell.name!r
+0000fe60: 7d20 636f 6e74 6169 6e73 207b 6c65 6e28  } contains {len(
+0000fe70: 6e6f 5f6e 616d 655f 6365 6c6c 7329 7d20  no_name_cells)} 
+0000fe80: 556e 6e61 6d65 6420 6365 6c6c 7322 2c0a  Unnamed cells",.
+0000fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fea0: 7374 6163 6b6c 6576 656c 3d33 2c0a 2020  stacklevel=3,.  
+0000feb0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000fec0: 2020 2020 2023 2066 6f72 2063 656c 6c20       # for cell 
+0000fed0: 696e 2061 6c6c 5f63 656c 6c73 3a0a 2020  in all_cells:.  
+0000fee0: 2020 2020 2020 2320 2020 2020 7072 696e        #     prin
+0000fef0: 7428 6365 6c6c 2e6e 616d 652c 2074 7970  t(cell.name, typ
+0000ff00: 6528 6365 6c6c 2929 0a0a 2020 2020 2020  e(cell))..      
+0000ff10: 2020 6c69 6220 3d20 6764 7374 6b2e 4c69    lib = gdstk.Li
+0000ff20: 6272 6172 7928 0a20 2020 2020 2020 2020  brary(.         
+0000ff30: 2020 2075 6e69 743d 7772 6974 655f 7365     unit=write_se
+0000ff40: 7474 696e 6773 2e75 6e69 742c 2070 7265  ttings.unit, pre
+0000ff50: 6369 7369 6f6e 3d77 7269 7465 5f73 6574  cision=write_set
+0000ff60: 7469 6e67 732e 7072 6563 6973 696f 6e0a  tings.precision.
+0000ff70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ff80: 2020 6c69 622e 6164 6428 746f 705f 6365    lib.add(top_ce
+0000ff90: 6c6c 2e5f 6365 6c6c 290a 2020 2020 2020  ll._cell).      
+0000ffa0: 2020 6c69 622e 6164 6428 2a74 6f70 5f63    lib.add(*top_c
+0000ffb0: 656c 6c2e 5f63 656c 6c2e 6465 7065 6e64  ell._cell.depend
+0000ffc0: 656e 6369 6573 2854 7275 6529 290a 0a20  encies(True)).. 
+0000ffd0: 2020 2020 2020 2069 6620 7769 7468 5f6f         if with_o
+0000ffe0: 6173 6973 3a0a 2020 2020 2020 2020 2020  asis:.          
+0000fff0: 2020 6c69 622e 7772 6974 655f 6f61 7328    lib.write_oas(
+00010000: 6764 7370 6174 682c 202a 2a6f 6173 6973  gdspath, **oasis
+00010010: 5f73 6574 7469 6e67 732e 6469 6374 2829  _settings.dict()
+00010020: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00010030: 2020 2020 2020 2020 2020 2020 6c69 622e              lib.
+00010040: 7772 6974 655f 6764 7328 0a20 2020 2020  write_gds(.     
+00010050: 2020 2020 2020 2020 2020 2067 6473 7061             gdspa
+00010060: 7468 2c20 7469 6d65 7374 616d 703d 7469  th, timestamp=ti
+00010070: 6d65 7374 616d 702c 206d 6178 5f70 6f69  mestamp, max_poi
+00010080: 6e74 733d 7772 6974 655f 7365 7474 696e  nts=write_settin
+00010090: 6773 2e6d 6178 5f70 6f69 6e74 730a 2020  gs.max_points.  
+000100a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000100b0: 2020 2020 6966 206c 6f67 6769 6e67 3a0a      if logging:.
+000100c0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+000100d0: 6572 2e69 6e66 6f28 6622 5772 6f74 6520  er.info(f"Wrote 
+000100e0: 746f 207b 7374 7228 6764 7370 6174 6829  to {str(gdspath)
+000100f0: 2172 7d22 290a 2020 2020 2020 2020 6966  !r}").        if
+00010100: 2077 6974 685f 6d65 7461 6461 7461 3a0a   with_metadata:.
+00010110: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00010120: 6461 7461 203d 2067 6473 7061 7468 2e77  data = gdspath.w
+00010130: 6974 685f 7375 6666 6978 2822 2e79 6d6c  ith_suffix(".yml
+00010140: 2229 0a20 2020 2020 2020 2020 2020 206d  ").            m
+00010150: 6574 6164 6174 612e 7772 6974 655f 7465  etadata.write_te
+00010160: 7874 2873 656c 662e 746f 5f79 616d 6c28  xt(self.to_yaml(
+00010170: 7769 7468 5f63 656c 6c73 3d54 7275 652c  with_cells=True,
+00010180: 2077 6974 685f 706f 7274 733d 5472 7565   with_ports=True
+00010190: 2929 0a20 2020 2020 2020 2020 2020 206c  )).            l
+000101a0: 6f67 6765 722e 696e 666f 2866 2257 7269  ogger.info(f"Wri
+000101b0: 7465 2059 414d 4c20 6d65 7461 6461 7461  te YAML metadata
+000101c0: 2074 6f20 7b73 7472 286d 6574 6164 6174   to {str(metadat
+000101d0: 6129 2172 7d22 290a 0a20 2020 2020 2020  a)!r}")..       
+000101e0: 2072 6574 7572 6e20 6764 7370 6174 680a   return gdspath.
+000101f0: 0a20 2020 2064 6566 2077 7269 7465 5f67  .    def write_g
+00010200: 6473 280a 2020 2020 2020 2020 7365 6c66  ds(.        self
+00010210: 2c0a 2020 2020 2020 2020 6764 7370 6174  ,.        gdspat
+00010220: 683a 204f 7074 696f 6e61 6c5b 5061 7468  h: Optional[Path
+00010230: 5479 7065 5d20 3d20 4e6f 6e65 2c0a 2020  Type] = None,.  
+00010240: 2020 2020 2020 6764 7364 6972 3a20 4f70        gdsdir: Op
+00010250: 7469 6f6e 616c 5b50 6174 6854 7970 655d  tional[PathType]
+00010260: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00010270: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
+00010280: 202d 3e20 5061 7468 3a0a 2020 2020 2020   -> Path:.      
+00010290: 2020 2222 2257 7269 7465 2063 6f6d 706f    """Write compo
+000102a0: 6e65 6e74 2074 6f20 4744 5320 616e 6420  nent to GDS and 
+000102b0: 7265 7475 726e 7320 6764 7370 6174 682e  returns gdspath.
+000102c0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+000102d0: 2020 2020 2020 2020 2020 2020 6764 7370              gdsp
+000102e0: 6174 683a 2047 4453 2066 696c 6520 7061  ath: GDS file pa
+000102f0: 7468 2074 6f20 7772 6974 6520 746f 2e0a  th to write to..
+00010300: 2020 2020 2020 2020 2020 2020 6764 7364              gdsd
+00010310: 6972 3a20 6469 7265 6374 6f72 7920 666f  ir: directory fo
+00010320: 7220 7468 6520 4744 5320 6669 6c65 2e20  r the GDS file. 
+00010330: 4465 6661 756c 7473 2074 6f20 2f74 6d70  Defaults to /tmp
+00010340: 2f72 616e 646f 6d46 696c 652f 6764 7366  /randomFile/gdsf
+00010350: 6163 746f 7279 2e0a 0a20 2020 2020 2020  actory...       
+00010360: 204b 6579 776f 7264 2041 7267 733a 0a20   Keyword Args:. 
+00010370: 2020 2020 2020 2020 2020 2075 6e69 743a             unit:
+00010380: 2075 6e69 7420 7369 7a65 2066 6f72 206f   unit size for o
+00010390: 626a 6563 7473 2069 6e20 6c69 6272 6172  bjects in librar
+000103a0: 792e 2031 756d 2062 7920 6465 6661 756c  y. 1um by defaul
+000103b0: 742e 0a20 2020 2020 2020 2020 2020 2070  t..            p
+000103c0: 7265 6369 7369 6f6e 3a20 666f 7220 6469  recision: for di
+000103d0: 6d65 6e73 696f 6e73 2069 6e20 7468 6520  mensions in the 
+000103e0: 6c69 6272 6172 7920 286d 292e 2031 6e6d  library (m). 1nm
+000103f0: 2062 7920 6465 6661 756c 742e 0a20 2020   by default..   
+00010400: 2020 2020 2020 2020 206c 6f67 6769 6e67           logging
+00010410: 3a20 6469 7361 626c 6520 4744 5320 7061  : disable GDS pa
+00010420: 7468 206c 6f67 6769 6e67 2c20 666f 7220  th logging, for 
+00010430: 6578 616d 706c 6520 666f 7220 7368 6f77  example for show
+00010440: 696e 6720 6974 2069 6e20 4b4c 6179 6f75  ing it in KLayou
+00010450: 742e 0a20 2020 2020 2020 2020 2020 206f  t..            o
+00010460: 6e5f 6475 706c 6963 6174 655f 6365 6c6c  n_duplicate_cell
+00010470: 3a20 7370 6563 6966 7920 686f 7720 746f  : specify how to
+00010480: 2072 6573 6f6c 7665 2064 7570 6c69 6361   resolve duplica
+00010490: 7465 2d6e 616d 6564 2063 656c 6c73 2e20  te-named cells. 
+000104a0: 4368 6f6f 7365 206f 6e65 206f 6620 7468  Choose one of th
+000104b0: 6520 666f 6c6c 6f77 696e 673a 0a20 2020  e following:.   
+000104c0: 2020 2020 2020 2020 2020 2020 2022 7761               "wa
+000104d0: 726e 2220 2864 6566 6175 6c74 293a 206f  rn" (default): o
+000104e0: 7665 7277 7269 7465 2061 6c6c 2064 7570  verwrite all dup
+000104f0: 6c69 6361 7465 2063 656c 6c73 2077 6974  licate cells wit
+00010500: 6820 6f6e 6520 6f66 2074 6865 2064 7570  h one of the dup
+00010510: 6c69 6361 7465 7320 2861 7262 6974 7261  licates (arbitra
+00010520: 7269 6c79 292e 0a20 2020 2020 2020 2020  rily)..         
+00010530: 2020 2020 2020 2022 6572 726f 7222 3a20         "error": 
+00010540: 7468 726f 7720 6120 5661 6c75 6545 7272  throw a ValueErr
+00010550: 6f72 2077 6865 6e20 6174 7465 6d70 7469  or when attempti
+00010560: 6e67 2074 6f20 7772 6974 6520 6120 6764  ng to write a gd
+00010570: 7320 7769 7468 2064 7570 6c69 6361 7465  s with duplicate
+00010580: 2063 656c 6c73 2e0a 2020 2020 2020 2020   cells..        
+00010590: 2020 2020 2020 2020 226f 7665 7277 7269          "overwri
+000105a0: 7465 223a 206f 7665 7277 7269 7465 2061  te": overwrite a
+000105b0: 6c6c 2064 7570 6c69 6361 7465 2063 656c  ll duplicate cel
+000105c0: 6c73 2077 6974 6820 6f6e 6520 6f66 2074  ls with one of t
+000105d0: 6865 2064 7570 6c69 6361 7465 732c 2077  he duplicates, w
+000105e0: 6974 686f 7574 2077 6172 6e69 6e67 2e0a  ithout warning..
+000105f0: 2020 2020 2020 2020 2020 2020 6f6e 5f75              on_u
+00010600: 6e63 6163 6865 645f 636f 6d70 6f6e 656e  ncached_componen
+00010610: 743a 204c 6974 6572 616c 5b22 7761 726e  t: Literal["warn
+00010620: 222c 2022 6572 726f 7222 5d20 3d20 2277  ", "error"] = "w
+00010630: 6172 6e22 0a20 2020 2020 2020 2020 2020  arn".           
+00010640: 2066 6c61 7474 656e 5f69 6e76 616c 6964   flatten_invalid
+00010650: 5f72 6566 733a 2066 6c61 7474 656e 7320  _refs: flattens 
+00010660: 636f 6d70 6f6e 656e 7420 7265 6665 7265  component refere
+00010670: 6e63 6573 2077 6869 6368 2068 6176 6520  nces which have 
+00010680: 696e 7661 6c69 6420 7472 616e 7366 6f72  invalid transfor
+00010690: 6d61 7469 6f6e 732e 0a20 2020 2020 2020  mations..       
+000106a0: 2020 2020 206d 6178 5f70 6f69 6e74 733a       max_points:
+000106b0: 204d 6178 696d 616c 206e 756d 6265 7220   Maximal number 
+000106c0: 6f66 2076 6572 7469 6365 7320 7065 7220  of vertices per 
+000106d0: 706f 6c79 676f 6e2e 0a20 2020 2020 2020  polygon..       
+000106e0: 2020 2020 2020 2020 2050 6f6c 7967 6f6e           Polygon
+000106f0: 7320 7769 7468 206d 6f72 6520 7665 7274  s with more vert
+00010700: 6963 6573 2074 6861 7420 7468 6973 2061  ices that this a
+00010710: 7265 2061 7574 6f6d 6174 6963 616c 6c79  re automatically
+00010720: 2066 7261 6374 7572 6564 2e0a 2020 2020   fractured..    
+00010730: 2020 2020 2020 2020 7769 7468 5f6d 6574          with_met
+00010740: 6164 6174 613a 2077 7269 7465 7320 6d65  adata: writes me
+00010750: 7461 6461 7461 2069 6e20 5941 4d4c 2066  tadata in YAML f
+00010760: 6f72 6d61 742e 0a20 2020 2020 2020 2022  ormat..        "
+00010770: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
+00010780: 726e 2073 656c 662e 5f77 7269 7465 5f6c  rn self._write_l
+00010790: 6962 7261 7279 280a 2020 2020 2020 2020  ibrary(.        
+000107a0: 2020 2020 6764 7370 6174 683d 6764 7370      gdspath=gdsp
+000107b0: 6174 682c 2067 6473 6469 723d 6764 7364  ath, gdsdir=gdsd
+000107c0: 6972 2c20 7769 7468 5f6f 6173 6973 3d46  ir, with_oasis=F
+000107d0: 616c 7365 2c20 2a2a 6b77 6172 6773 0a20  alse, **kwargs. 
+000107e0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000107f0: 6620 7772 6974 655f 6f61 7328 0a20 2020  f write_oas(.   
+00010800: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00010810: 2020 2067 6473 7061 7468 3a20 4f70 7469     gdspath: Opti
+00010820: 6f6e 616c 5b50 6174 6854 7970 655d 203d  onal[PathType] =
+00010830: 204e 6f6e 652c 0a20 2020 2020 2020 2067   None,.        g
+00010840: 6473 6469 723a 204f 7074 696f 6e61 6c5b  dsdir: Optional[
+00010850: 5061 7468 5479 7065 5d20 3d20 4e6f 6e65  PathType] = None
+00010860: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
+00010870: 6773 2c0a 2020 2020 2920 2d3e 2050 6174  gs,.    ) -> Pat
+00010880: 683a 0a20 2020 2020 2020 2022 2222 5772  h:.        """Wr
+00010890: 6974 6520 636f 6d70 6f6e 656e 7420 746f  ite component to
+000108a0: 2047 4453 2061 6e64 2072 6574 7572 6e73   GDS and returns
+000108b0: 2067 6473 7061 7468 2e0a 0a20 2020 2020   gdspath...     
+000108c0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000108d0: 2020 2020 2067 6473 7061 7468 3a20 4744       gdspath: GD
+000108e0: 5320 6669 6c65 2070 6174 6820 746f 2077  S file path to w
+000108f0: 7269 7465 2074 6f2e 0a20 2020 2020 2020  rite to..       
+00010900: 2020 2020 2067 6473 6469 723a 2064 6972       gdsdir: dir
+00010910: 6563 746f 7279 2066 6f72 2074 6865 2047  ectory for the G
+00010920: 4453 2066 696c 652e 2044 6566 6175 6c74  DS file. Default
+00010930: 7320 746f 202f 746d 702f 7261 6e64 6f6d  s to /tmp/random
+00010940: 4669 6c65 2f67 6473 6661 6374 6f72 792e  File/gdsfactory.
+00010950: 0a0a 2020 2020 2020 2020 4b65 7977 6f72  ..        Keywor
+00010960: 6420 4172 6773 3a0a 2020 2020 2020 2020  d Args:.        
+00010970: 2020 2020 756e 6974 3a20 756e 6974 2073      unit: unit s
+00010980: 697a 6520 666f 7220 6f62 6a65 6374 7320  ize for objects 
+00010990: 696e 206c 6962 7261 7279 2e20 3175 6d20  in library. 1um 
+000109a0: 6279 2064 6566 6175 6c74 2e0a 2020 2020  by default..    
+000109b0: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
+000109c0: 6e3a 2066 6f72 2064 696d 656e 7369 6f6e  n: for dimension
+000109d0: 7320 696e 2074 6865 206c 6962 7261 7279  s in the library
+000109e0: 2028 6d29 2e20 316e 6d20 6279 2064 6566   (m). 1nm by def
+000109f0: 6175 6c74 2e0a 2020 2020 2020 2020 2020  ault..          
+00010a00: 2020 6c6f 6767 696e 673a 2064 6973 6162    logging: disab
+00010a10: 6c65 2047 4453 2070 6174 6820 6c6f 6767  le GDS path logg
+00010a20: 696e 672c 2066 6f72 2065 7861 6d70 6c65  ing, for example
+00010a30: 2066 6f72 2073 686f 7769 6e67 2069 7420   for showing it 
+00010a40: 696e 204b 4c61 796f 7574 2e0a 2020 2020  in KLayout..    
+00010a50: 2020 2020 2020 2020 6f6e 5f64 7570 6c69          on_dupli
+00010a60: 6361 7465 5f63 656c 6c3a 2073 7065 6369  cate_cell: speci
+00010a70: 6679 2068 6f77 2074 6f20 7265 736f 6c76  fy how to resolv
+00010a80: 6520 6475 706c 6963 6174 652d 6e61 6d65  e duplicate-name
+00010a90: 6420 6365 6c6c 732e 2043 686f 6f73 6520  d cells. Choose 
+00010aa0: 6f6e 6520 6f66 2074 6865 2066 6f6c 6c6f  one of the follo
+00010ab0: 7769 6e67 3a0a 2020 2020 2020 2020 2020  wing:.          
+00010ac0: 2020 2020 2020 2277 6172 6e22 2028 6465        "warn" (de
+00010ad0: 6661 756c 7429 3a20 6f76 6572 7772 6974  fault): overwrit
+00010ae0: 6520 616c 6c20 6475 706c 6963 6174 6520  e all duplicate 
+00010af0: 6365 6c6c 7320 7769 7468 206f 6e65 206f  cells with one o
+00010b00: 6620 7468 6520 6475 706c 6963 6174 6573  f the duplicates
+00010b10: 2028 6172 6269 7472 6172 696c 7929 2e0a   (arbitrarily)..
+00010b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b30: 2265 7272 6f72 223a 2074 6872 6f77 2061  "error": throw a
+00010b40: 2056 616c 7565 4572 726f 7220 7768 656e   ValueError when
+00010b50: 2061 7474 656d 7074 696e 6720 746f 2077   attempting to w
+00010b60: 7269 7465 2061 2067 6473 2077 6974 6820  rite a gds with 
+00010b70: 6475 706c 6963 6174 6520 6365 6c6c 732e  duplicate cells.
+00010b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010b90: 2022 6f76 6572 7772 6974 6522 3a20 6f76   "overwrite": ov
+00010ba0: 6572 7772 6974 6520 616c 6c20 6475 706c  erwrite all dupl
+00010bb0: 6963 6174 6520 6365 6c6c 7320 7769 7468  icate cells with
+00010bc0: 206f 6e65 206f 6620 7468 6520 6475 706c   one of the dupl
+00010bd0: 6963 6174 6573 2c20 7769 7468 6f75 7420  icates, without 
+00010be0: 7761 726e 696e 672e 0a20 2020 2020 2020  warning..       
+00010bf0: 2020 2020 2020 2020 204e 6f6e 653a 2064           None: d
+00010c00: 6f20 6e6f 7420 7472 7920 746f 2072 6573  o not try to res
+00010c10: 6f6c 7665 2028 6174 2079 6f75 7220 6f77  olve (at your ow
+00010c20: 6e20 7269 736b 2129 0a20 2020 2020 2020  n risk!).       
+00010c30: 2020 2020 206f 6e5f 756e 6361 6368 6564       on_uncached
+00010c40: 5f63 6f6d 706f 6e65 6e74 3a20 4c69 7465  _component: Lite
+00010c50: 7261 6c5b 2277 6172 6e22 2c20 2265 7272  ral["warn", "err
+00010c60: 6f72 225d 203d 2022 7761 726e 220a 2020  or"] = "warn".  
+00010c70: 2020 2020 2020 2020 2020 666c 6174 7465            flatte
+00010c80: 6e5f 696e 7661 6c69 645f 7265 6673 3a20  n_invalid_refs: 
+00010c90: 666c 6174 7465 6e73 2063 6f6d 706f 6e65  flattens compone
+00010ca0: 6e74 2072 6566 6572 656e 6365 7320 7768  nt references wh
+00010cb0: 6963 6820 6861 7665 2069 6e76 616c 6964  ich have invalid
+00010cc0: 2074 7261 6e73 666f 726d 6174 696f 6e73   transformations
+00010cd0: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00010ce0: 6d70 7265 7373 696f 6e5f 6c65 7665 6c3a  mpression_level:
+00010cf0: 204c 6576 656c 206f 6620 636f 6d70 7265   Level of compre
+00010d00: 7373 696f 6e20 666f 7220 6365 6c6c 7320  ssion for cells 
+00010d10: 2862 6574 7765 656e 2030 2061 6e64 2039  (between 0 and 9
+00010d20: 292e 0a20 2020 2020 2020 2020 2020 2020  )..             
+00010d30: 2020 2053 6574 7469 6e67 2074 6f20 3020     Setting to 0 
+00010d40: 7769 6c6c 2064 6973 6162 6c65 2063 656c  will disable cel
+00010d50: 6c20 636f 6d70 7265 7373 696f 6e2c 2031  l compression, 1
+00010d60: 2067 6976 6573 2074 6865 2062 6573 7420   gives the best 
+00010d70: 7370 6565 6420 616e 6420 392c 2074 6865  speed and 9, the
+00010d80: 2062 6573 7420 636f 6d70 7265 7373 696f   best compressio
+00010d90: 6e2e 0a20 2020 2020 2020 2020 2020 2064  n..            d
+00010da0: 6574 6563 745f 7265 6374 616e 676c 6573  etect_rectangles
+00010db0: 3a20 5374 6f72 6520 7265 6374 616e 676c  : Store rectangl
+00010dc0: 6573 2069 6e20 636f 6d70 7265 7373 6564  es in compressed
+00010dd0: 2066 6f72 6d61 742e 0a20 2020 2020 2020   format..       
+00010de0: 2020 2020 2064 6574 6563 745f 7472 6170       detect_trap
+00010df0: 657a 6f69 6473 3a20 5374 6f72 6520 7472  ezoids: Store tr
+00010e00: 6170 657a 6f69 6473 2069 6e20 636f 6d70  apezoids in comp
+00010e10: 7265 7373 6564 2066 6f72 6d61 742e 0a20  ressed format.. 
+00010e20: 2020 2020 2020 2020 2020 2063 6972 636c             circl
+00010e30: 655f 746f 6c65 7261 6e63 653a 2054 6f6c  e_tolerance: Tol
+00010e40: 6572 616e 6365 2066 6f72 2064 6574 6563  erance for detec
+00010e50: 7469 6e67 2063 6972 636c 6573 2e20 4966  ting circles. If
+00010e60: 206c 6573 7320 6f72 2065 7175 616c 2074   less or equal t
+00010e70: 6f20 302c 206e 6f20 6465 7465 6374 696f  o 0, no detectio
+00010e80: 6e20 6973 2070 6572 666f 726d 6564 2e0a  n is performed..
+00010e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ea0: 4369 7263 6c65 7320 6172 6520 7374 6f72  Circles are stor
+00010eb0: 6564 2069 6e20 636f 6d70 7265 7373 6564  ed in compressed
+00010ec0: 2066 6f72 6d61 742e 0a20 2020 2020 2020   format..       
+00010ed0: 2020 2020 2076 616c 6964 6174 696f 6e20       validation 
+00010ee0: 2822 6372 6333 3222 2c20 2263 6865 636b  ("crc32", "check
+00010ef0: 7375 6d33 3222 2c20 4e6f 6e65 2920 e280  sum32", None) ..
+00010f00: 9320 7479 7065 206f 6620 7661 6c69 6461  . type of valida
+00010f10: 7469 6f6e 2074 6f20 696e 636c 7564 6520  tion to include 
+00010f20: 696e 2074 6865 2073 6176 6564 2066 696c  in the saved fil
+00010f30: 652e 0a20 2020 2020 2020 2020 2020 2073  e..            s
+00010f40: 7461 6e64 6172 645f 7072 6f70 6572 7469  tandard_properti
+00010f50: 6573 3a20 5374 6f72 6520 7374 616e 6461  es: Store standa
+00010f60: 7264 204f 4153 4953 2070 726f 7065 7274  rd OASIS propert
+00010f70: 6965 7320 696e 2074 6865 2066 696c 652e  ies in the file.
+00010f80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010f90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00010fa0: 2e5f 7772 6974 655f 6c69 6272 6172 7928  ._write_library(
+00010fb0: 0a20 2020 2020 2020 2020 2020 2067 6473  .            gds
+00010fc0: 7061 7468 3d67 6473 7061 7468 2c0a 2020  path=gdspath,.  
+00010fd0: 2020 2020 2020 2020 2020 6764 7364 6972            gdsdir
+00010fe0: 3d67 6473 6469 722c 0a20 2020 2020 2020  =gdsdir,.       
+00010ff0: 2020 2020 2077 6974 685f 6f61 7369 733d       with_oasis=
+00011000: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00011010: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+00011020: 2020 2020 290a 0a20 2020 2064 6566 2077      )..    def w
+00011030: 7269 7465 5f67 6473 5f77 6974 685f 6d65  rite_gds_with_me
+00011040: 7461 6461 7461 2873 656c 662c 202a 6172  tadata(self, *ar
+00011050: 6773 2c20 2a2a 6b77 6172 6773 2920 2d3e  gs, **kwargs) ->
+00011060: 2050 6174 683a 0a20 2020 2020 2020 2022   Path:.        "
+00011070: 2222 5772 6974 6520 636f 6d70 6f6e 656e  ""Write componen
+00011080: 7420 696e 2047 4453 2061 6e64 206d 6574  t in GDS and met
+00011090: 6164 6174 6120 2863 6f6d 706f 6e65 6e74  adata (component
+000110a0: 2073 6574 7469 6e67 7329 2069 6e20 5941   settings) in YA
+000110b0: 4d4c 2e22 2222 0a20 2020 2020 2020 2077  ML.""".        w
+000110c0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+000110d0: 2020 2020 2020 2020 2020 2243 6f6d 706f            "Compo
+000110e0: 6e65 6e74 2e77 7269 7465 5f67 6473 5f77  nent.write_gds_w
+000110f0: 6974 685f 6d65 7461 6461 7461 2829 2069  ith_metadata() i
+00011100: 7320 6465 7072 6563 6174 6564 2e20 220a  s deprecated. ".
+00011110: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
+00011120: 2043 6f6d 706f 6e65 6e74 2e77 7269 7465   Component.write
+00011130: 5f67 6473 2877 6974 685f 6d65 7461 6461  _gds(with_metada
+00011140: 7461 3d54 7275 6529 206f 7220 436f 6d70  ta=True) or Comp
+00011150: 6f6e 656e 742e 7772 6974 655f 6f61 7328  onent.write_oas(
+00011160: 7769 7468 5f6d 6574 6164 6174 613d 5472  with_metadata=Tr
+00011170: 7565 292e 222c 0a20 2020 2020 2020 2020  ue).",.         
+00011180: 2020 2073 7461 636b 6c65 7665 6c3d 332c     stacklevel=3,
+00011190: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000111a0: 2020 2067 6473 7061 7468 203d 2073 656c     gdspath = sel
+000111b0: 662e 7772 6974 655f 6764 7328 2a61 7267  f.write_gds(*arg
+000111c0: 732c 202a 2a6b 7761 7267 7329 0a20 2020  s, **kwargs).   
+000111d0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+000111e0: 6764 7370 6174 682e 7769 7468 5f73 7566  gdspath.with_suf
+000111f0: 6669 7828 222e 796d 6c22 290a 2020 2020  fix(".yml").    
+00011200: 2020 2020 6d65 7461 6461 7461 2e77 7269      metadata.wri
+00011210: 7465 5f74 6578 7428 7365 6c66 2e74 6f5f  te_text(self.to_
+00011220: 7961 6d6c 2877 6974 685f 6365 6c6c 733d  yaml(with_cells=
+00011230: 5472 7565 2c20 7769 7468 5f70 6f72 7473  True, with_ports
+00011240: 3d54 7275 6529 290a 2020 2020 2020 2020  =True)).        
+00011250: 6c6f 6767 6572 2e69 6e66 6f28 6622 5772  logger.info(f"Wr
+00011260: 6974 6520 5941 4d4c 206d 6574 6164 6174  ite YAML metadat
+00011270: 6120 746f 207b 7374 7228 6d65 7461 6461  a to {str(metada
+00011280: 7461 2921 727d 2229 0a20 2020 2020 2020  ta)!r}").       
+00011290: 2072 6574 7572 6e20 6764 7370 6174 680a   return gdspath.
+000112a0: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
+000112b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000112c0: 2020 2020 2020 2020 6967 6e6f 7265 5f63          ignore_c
+000112d0: 6f6d 706f 6e65 6e74 735f 7072 6566 6978  omponents_prefix
+000112e0: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+000112f0: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+00011300: 2020 2020 2020 6967 6e6f 7265 5f66 756e        ignore_fun
+00011310: 6374 696f 6e73 5f70 7265 6669 783a 204f  ctions_prefix: O
+00011320: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
+00011330: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
+00011340: 2020 2077 6974 685f 6365 6c6c 733a 2062     with_cells: b
+00011350: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00011360: 2020 2020 2077 6974 685f 706f 7274 733a       with_ports:
+00011370: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+00011380: 2020 2920 2d3e 2044 6963 745b 7374 722c    ) -> Dict[str,
+00011390: 2041 6e79 5d3a 0a20 2020 2020 2020 2022   Any]:.        "
+000113a0: 2222 5265 7475 726e 7320 4469 6374 2072  ""Returns Dict r
+000113b0: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+000113c0: 2061 2063 6f6d 706f 6e65 6e74 2e0a 0a20   a component... 
+000113d0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+000113e0: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
+000113f0: 636f 6d70 6f6e 656e 7473 5f70 7265 6669  components_prefi
+00011400: 783a 2066 6f72 2063 6f6d 706f 6e65 6e74  x: for component
+00011410: 7320 746f 2069 676e 6f72 6520 7768 656e  s to ignore when
+00011420: 2065 7870 6f72 7469 6e67 2e0a 2020 2020   exporting..    
+00011430: 2020 2020 2020 2020 6967 6e6f 7265 5f66          ignore_f
+00011440: 756e 6374 696f 6e73 5f70 7265 6669 783a  unctions_prefix:
+00011450: 2066 6f72 2066 756e 6374 696f 6e73 2074   for functions t
+00011460: 6f20 6967 6e6f 7265 2077 6865 6e20 6578  o ignore when ex
+00011470: 706f 7274 696e 672e 0a20 2020 2020 2020  porting..       
+00011480: 2020 2020 2077 6974 685f 6365 6c6c 733a       with_cells:
+00011490: 2077 7269 7465 2063 656c 6c73 2072 6563   write cells rec
+000114a0: 7572 7369 7665 6c79 2e0a 2020 2020 2020  ursively..      
+000114b0: 2020 2020 2020 7769 7468 5f70 6f72 7473        with_ports
+000114c0: 3a20 7772 6974 6520 706f 7274 2069 6e66  : write port inf
+000114d0: 6f72 6d61 7469 6f6e 2064 6963 742e 0a20  ormation dict.. 
+000114e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000114f0: 2020 2064 203d 207b 7d0a 2020 2020 2020     d = {}.      
+00011500: 2020 6966 2077 6974 685f 706f 7274 733a    if with_ports:
+00011510: 0a20 2020 2020 2020 2020 2020 2070 6f72  .            por
+00011520: 7473 203d 207b 706f 7274 2e6e 616d 653a  ts = {port.name:
+00011530: 2070 6f72 742e 746f 5f64 6963 7428 2920   port.to_dict() 
+00011540: 666f 7220 706f 7274 2069 6e20 7365 6c66  for port in self
+00011550: 2e67 6574 5f70 6f72 7473 5f6c 6973 7428  .get_ports_list(
+00011560: 297d 0a20 2020 2020 2020 2020 2020 2064  )}.            d
+00011570: 5b22 706f 7274 7322 5d20 3d20 706f 7274  ["ports"] = port
+00011580: 730a 0a20 2020 2020 2020 2069 6620 7769  s..        if wi
+00011590: 7468 5f63 656c 6c73 3a0a 2020 2020 2020  th_cells:.      
+000115a0: 2020 2020 2020 6365 6c6c 7320 3d20 7265        cells = re
+000115b0: 6375 7273 655f 7374 7275 6374 7572 6573  curse_structures
+000115c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000115d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000115e0: 2020 2020 2020 2020 6967 6e6f 7265 5f66          ignore_f
+000115f0: 756e 6374 696f 6e73 5f70 7265 6669 783d  unctions_prefix=
+00011600: 6967 6e6f 7265 5f66 756e 6374 696f 6e73  ignore_functions
+00011610: 5f70 7265 6669 782c 0a20 2020 2020 2020  _prefix,.       
+00011620: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
+00011630: 636f 6d70 6f6e 656e 7473 5f70 7265 6669  components_prefi
+00011640: 783d 6967 6e6f 7265 5f63 6f6d 706f 6e65  x=ignore_compone
+00011650: 6e74 735f 7072 6566 6978 2c0a 2020 2020  nts_prefix,.    
+00011660: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00011670: 2020 2020 2020 645b 2263 656c 6c73 225d        d["cells"]
+00011680: 203d 2063 6c65 616e 5f64 6963 7428 6365   = clean_dict(ce
+00011690: 6c6c 7329 0a0a 2020 2020 2020 2020 645b  lls)..        d[
+000116a0: 226e 616d 6522 5d20 3d20 7365 6c66 2e6e  "name"] = self.n
+000116b0: 616d 650a 2020 2020 2020 2020 645b 2273  ame.        d["s
+000116c0: 6574 7469 6e67 7322 5d20 3d20 636c 6561  ettings"] = clea
+000116d0: 6e5f 6469 6374 2864 6963 7428 7365 6c66  n_dict(dict(self
+000116e0: 2e73 6574 7469 6e67 7329 290a 2020 2020  .settings)).    
+000116f0: 2020 2020 7265 7475 726e 2064 0a0a 2020      return d..  
+00011700: 2020 6465 6620 746f 5f79 616d 6c28 7365    def to_yaml(se
+00011710: 6c66 2c20 2a2a 6b77 6172 6773 2920 2d3e  lf, **kwargs) ->
+00011720: 2073 7472 3a0a 2020 2020 2020 2020 2222   str:.        ""
+00011730: 2257 7269 7465 2044 6963 7420 7265 7072  "Write Dict repr
+00011740: 6573 656e 7461 7469 6f6e 206f 6620 6120  esentation of a 
+00011750: 636f 6d70 6f6e 656e 7420 696e 2059 414d  component in YAM
+00011760: 4c20 666f 726d 6174 2e0a 0a20 2020 2020  L format...     
+00011770: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00011780: 2020 2020 2069 676e 6f72 655f 636f 6d70       ignore_comp
+00011790: 6f6e 656e 7473 5f70 7265 6669 783a 2066  onents_prefix: f
+000117a0: 6f72 2063 6f6d 706f 6e65 6e74 7320 746f  or components to
+000117b0: 2069 676e 6f72 6520 7768 656e 2065 7870   ignore when exp
+000117c0: 6f72 7469 6e67 2e0a 2020 2020 2020 2020  orting..        
+000117d0: 2020 2020 6967 6e6f 7265 5f66 756e 6374      ignore_funct
+000117e0: 696f 6e73 5f70 7265 6669 783a 2066 6f72  ions_prefix: for
+000117f0: 2066 756e 6374 696f 6e73 2074 6f20 6967   functions to ig
+00011800: 6e6f 7265 2077 6865 6e20 6578 706f 7274  nore when export
+00011810: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+00011820: 2077 6974 685f 6365 6c6c 733a 2077 7269   with_cells: wri
+00011830: 7465 2063 656c 6c73 2072 6563 7572 7369  te cells recursi
+00011840: 7665 6c79 2e0a 2020 2020 2020 2020 2020  vely..          
+00011850: 2020 7769 7468 5f70 6f72 7473 3a20 7772    with_ports: wr
+00011860: 6974 6520 706f 7274 2069 6e66 6f72 6d61  ite port informa
+00011870: 7469 6f6e 2e0a 2020 2020 2020 2020 2222  tion..        ""
+00011880: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00011890: 204f 6d65 6761 436f 6e66 2e74 6f5f 7961   OmegaConf.to_ya
+000118a0: 6d6c 2863 6c65 616e 5f64 6963 7428 7365  ml(clean_dict(se
+000118b0: 6c66 2e74 6f5f 6469 6374 282a 2a6b 7761  lf.to_dict(**kwa
+000118c0: 7267 7329 2929 0a0a 2020 2020 6465 6620  rgs)))..    def 
+000118d0: 746f 5f64 6963 745f 706f 6c79 676f 6e73  to_dict_polygons
+000118e0: 2873 656c 6629 202d 3e20 4469 6374 5b73  (self) -> Dict[s
+000118f0: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
+00011900: 2020 2222 2252 6574 7572 6e73 2061 2064    """Returns a d
+00011910: 6963 7420 7265 7072 6573 656e 7461 7469  ict representati
+00011920: 6f6e 206f 6620 7468 6520 666c 6174 7465  on of the flatte
+00011930: 6e65 6420 636f 6d70 6f6e 656e 742e 2222  ned component.""
+00011940: 220a 2020 2020 2020 2020 6420 3d20 7b7d  ".        d = {}
+00011950: 0a20 2020 2020 2020 2070 6f6c 7967 6f6e  .        polygon
+00011960: 7320 3d20 7b7d 0a20 2020 2020 2020 206c  s = {}.        l
+00011970: 6179 6572 5f74 6f5f 706f 6c79 676f 6e73  ayer_to_polygons
+00011980: 203d 2073 656c 662e 6765 745f 706f 6c79   = self.get_poly
+00011990: 676f 6e73 2862 795f 7370 6563 3d54 7275  gons(by_spec=Tru
+000119a0: 6529 0a0a 2020 2020 2020 2020 666f 7220  e)..        for 
+000119b0: 6c61 7965 722c 2070 6f6c 7967 6f6e 735f  layer, polygons_
+000119c0: 6c61 7965 7220 696e 206c 6179 6572 5f74  layer in layer_t
+000119d0: 6f5f 706f 6c79 676f 6e73 2e69 7465 6d73  o_polygons.items
+000119e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+000119f0: 6c61 7965 725f 6e61 6d65 203d 2066 227b  layer_name = f"{
+00011a00: 6c61 7965 725b 305d 7d5f 7b6c 6179 6572  layer[0]}_{layer
+00011a10: 5b31 5d7d 220a 2020 2020 2020 2020 2020  [1]}".          
+00011a20: 2020 666f 7220 706f 6c79 676f 6e20 696e    for polygon in
+00011a30: 2070 6f6c 7967 6f6e 735f 6c61 7965 723a   polygons_layer:
+00011a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011a50: 2070 6f6c 7967 6f6e 735b 6c61 7965 725f   polygons[layer_
+00011a60: 6e61 6d65 5d20 3d20 5b74 7570 6c65 2873  name] = [tuple(s
+00011a70: 6e61 705f 746f 5f67 7269 6428 7629 2920  nap_to_grid(v)) 
+00011a80: 666f 7220 7620 696e 2070 6f6c 7967 6f6e  for v in polygon
+00011a90: 5d0a 0a20 2020 2020 2020 2070 6f72 7473  ]..        ports
+00011aa0: 203d 207b 706f 7274 2e6e 616d 653a 2070   = {port.name: p
+00011ab0: 6f72 742e 7365 7474 696e 6773 2066 6f72  ort.settings for
+00011ac0: 2070 6f72 7420 696e 2073 656c 662e 6765   port in self.ge
+00011ad0: 745f 706f 7274 735f 6c69 7374 2829 7d0a  t_ports_list()}.
+00011ae0: 2020 2020 2020 2020 636c 6561 6e5f 6469          clean_di
+00011af0: 6374 2870 6f72 7473 290a 2020 2020 2020  ct(ports).      
+00011b00: 2020 636c 6561 6e5f 6469 6374 2870 6f6c    clean_dict(pol
+00011b10: 7967 6f6e 7329 0a20 2020 2020 2020 2064  ygons).        d
+00011b20: 2e69 6e66 6f20 3d20 7365 6c66 2e69 6e66  .info = self.inf
+00011b30: 6f0a 2020 2020 2020 2020 642e 706f 6c79  o.        d.poly
+00011b40: 676f 6e73 203d 2070 6f6c 7967 6f6e 730a  gons = polygons.
+00011b50: 2020 2020 2020 2020 642e 706f 7274 7320          d.ports 
+00011b60: 3d20 706f 7274 730a 2020 2020 2020 2020  = ports.        
+00011b70: 7265 7475 726e 2064 0a0a 2020 2020 6465  return d..    de
+00011b80: 6620 6175 746f 5f72 656e 616d 655f 706f  f auto_rename_po
+00011b90: 7274 7328 7365 6c66 2c20 2a2a 6b77 6172  rts(self, **kwar
+00011ba0: 6773 2920 2d3e 204e 6f6e 653a 0a20 2020  gs) -> None:.   
+00011bb0: 2020 2020 2022 2222 5265 6e61 6d65 2070       """Rename p
+00011bc0: 6f72 7473 2062 7920 6f72 6965 6e74 6174  orts by orientat
+00011bd0: 696f 6e20 4e53 4557 2028 6e6f 7274 682c  ion NSEW (north,
+00011be0: 2073 6f75 7468 2c20 6561 7374 2c20 7765   south, east, we
+00011bf0: 7374 292e 0a0a 2020 2020 2020 2020 4b65  st)...        Ke
+00011c00: 7977 6f72 6420 4172 6773 3a0a 2020 2020  yword Args:.    
+00011c10: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
+00011c20: 3a20 746f 2072 656e 616d 6520 706f 7274  : to rename port
+00011c30: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
+00011c40: 656c 6563 745f 706f 7274 735f 6f70 7469  elect_ports_opti
+00011c50: 6361 6c3a 2074 6f20 7365 6c65 6374 206f  cal: to select o
+00011c60: 7074 6963 616c 2070 6f72 7473 2e0a 2020  ptical ports..  
+00011c70: 2020 2020 2020 2020 2020 7365 6c65 6374            select
+00011c80: 5f70 6f72 7473 5f65 6c65 6374 7269 6361  _ports_electrica
+00011c90: 6c3a 2074 6f20 7365 6c65 6374 2065 6c65  l: to select ele
+00011ca0: 6374 7269 6361 6c20 706f 7274 732e 0a20  ctrical ports.. 
+00011cb0: 2020 2020 2020 2020 2020 2070 7265 6669             prefi
+00011cc0: 785f 6f70 7469 6361 6c3a 2070 7265 6669  x_optical: prefi
+00011cd0: 782e 0a20 2020 2020 2020 2020 2020 2070  x..            p
+00011ce0: 7265 6669 785f 656c 6563 7472 6963 616c  refix_electrical
+00011cf0: 3a20 7072 6566 6978 2e0a 0a20 2020 2020  : prefix...     
+00011d00: 2020 202e 2e20 636f 6465 3a3a 0a0a 2020     .. code::..  
+00011d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d20: 3320 2034 0a20 2020 2020 2020 2020 2020  3  4.           
+00011d30: 2020 2020 2020 5f7c 5f5f 7c5f 0a20 2020        _|__|_.   
+00011d40: 2020 2020 2020 2020 2020 3220 2d7c 2020            2 -|  
+00011d50: 2020 2020 7c2d 2035 0a20 2020 2020 2020      |- 5.       
+00011d60: 2020 2020 2020 2020 207c 2020 2020 2020           |      
+00011d70: 7c0a 2020 2020 2020 2020 2020 2020 2031  |.             1
+00011d80: 202d 7c5f 5f5f 5f5f 5f7c 2d20 360a 2020   -|______|- 6.  
+00011d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011da0: 7c20 207c 0a20 2020 2020 2020 2020 2020  |  |.           
+00011db0: 2020 2020 2020 2038 2020 370a 2020 2020         8  7.    
+00011dc0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011dd0: 7365 6c66 2e69 735f 756e 6c6f 636b 6564  self.is_unlocked
+00011de0: 2829 0a20 2020 2020 2020 2061 7574 6f5f  ().        auto_
+00011df0: 7265 6e61 6d65 5f70 6f72 7473 2873 656c  rename_ports(sel
+00011e00: 662c 202a 2a6b 7761 7267 7329 0a0a 2020  f, **kwargs)..  
+00011e10: 2020 6465 6620 6175 746f 5f72 656e 616d    def auto_renam
+00011e20: 655f 706f 7274 735f 636f 756e 7465 725f  e_ports_counter_
+00011e30: 636c 6f63 6b77 6973 6528 7365 6c66 2c20  clockwise(self, 
+00011e40: 2a2a 6b77 6172 6773 2920 2d3e 204e 6f6e  **kwargs) -> Non
+00011e50: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
+00011e60: 6973 5f75 6e6c 6f63 6b65 6428 290a 2020  is_unlocked().  
+00011e70: 2020 2020 2020 6175 746f 5f72 656e 616d        auto_renam
+00011e80: 655f 706f 7274 735f 636f 756e 7465 725f  e_ports_counter_
+00011e90: 636c 6f63 6b77 6973 6528 7365 6c66 2c20  clockwise(self, 
+00011ea0: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+00011eb0: 6566 2061 7574 6f5f 7265 6e61 6d65 5f70  ef auto_rename_p
+00011ec0: 6f72 7473 5f6c 6179 6572 5f6f 7269 656e  orts_layer_orien
+00011ed0: 7461 7469 6f6e 2873 656c 662c 202a 2a6b  tation(self, **k
+00011ee0: 7761 7267 7329 202d 3e20 4e6f 6e65 3a0a  wargs) -> None:.
+00011ef0: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
+00011f00: 756e 6c6f 636b 6564 2829 0a20 2020 2020  unlocked().     
+00011f10: 2020 2061 7574 6f5f 7265 6e61 6d65 5f70     auto_rename_p
+00011f20: 6f72 7473 5f6c 6179 6572 5f6f 7269 656e  orts_layer_orien
+00011f30: 7461 7469 6f6e 2873 656c 662c 202a 2a6b  tation(self, **k
+00011f40: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
+00011f50: 6175 746f 5f72 656e 616d 655f 706f 7274  auto_rename_port
+00011f60: 735f 6f72 6965 6e74 6174 696f 6e28 7365  s_orientation(se
+00011f70: 6c66 2c20 2a2a 6b77 6172 6773 2920 2d3e  lf, **kwargs) ->
+00011f80: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00011f90: 2222 5265 6e61 6d65 2070 6f72 7473 2062  ""Rename ports b
+00011fa0: 7920 6f72 6965 6e74 6174 696f 6e20 4e53  y orientation NS
+00011fb0: 4557 2028 6e6f 7274 682c 2073 6f75 7468  EW (north, south
+00011fc0: 2c20 6561 7374 2c20 7765 7374 292e 0a0a  , east, west)...
+00011fd0: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
+00011fe0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00011ff0: 2020 6675 6e63 7469 6f6e 3a20 746f 2072    function: to r
+00012000: 656e 616d 6520 706f 7274 732e 0a20 2020  ename ports..   
+00012010: 2020 2020 2020 2020 2073 656c 6563 745f           select_
+00012020: 706f 7274 735f 6f70 7469 6361 6c3a 2074  ports_optical: t
+00012030: 6f20 7365 6c65 6374 2070 6f72 7473 2e0a  o select ports..
+00012040: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
+00012050: 6374 5f70 6f72 7473 5f65 6c65 6374 7269  ct_ports_electri
+00012060: 6361 6c3a 0a20 2020 2020 2020 2020 2020  cal:.           
+00012070: 2070 7265 6669 785f 6f70 7469 6361 6c3a   prefix_optical:
+00012080: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00012090: 6669 785f 656c 6563 7472 6963 616c 3a0a  fix_electrical:.
+000120a0: 0a20 2020 2020 2020 202e 2e20 636f 6465  .        .. code
+000120b0: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+000120c0: 2020 2020 204e 3020 204e 310a 2020 2020       N0  N1.    
+000120d0: 2020 2020 2020 2020 2020 2020 207c 5f5f               |__
+000120e0: 5f7c 5f0a 2020 2020 2020 2020 2020 2020  _|_.            
+000120f0: 5731 202d 7c20 2020 2020 207c 2d20 4531  W1 -|      |- E1
+00012100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012110: 207c 2020 2020 2020 7c0a 2020 2020 2020   |      |.      
+00012120: 2020 2020 2020 5730 202d 7c5f 5f5f 5f5f        W0 -|_____
+00012130: 5f7c 2d20 4530 0a20 2020 2020 2020 2020  _|- E0.         
+00012140: 2020 2020 2020 2020 7c20 2020 7c0a 2020          |   |.  
+00012150: 2020 2020 2020 2020 2020 2020 2020 5330                S0
+00012160: 2020 2053 310a 2020 2020 2020 2020 2222     S1.        ""
+00012170: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
+00012180: 735f 756e 6c6f 636b 6564 2829 0a20 2020  s_unlocked().   
+00012190: 2020 2020 2061 7574 6f5f 7265 6e61 6d65       auto_rename
+000121a0: 5f70 6f72 7473 5f6f 7269 656e 7461 7469  _ports_orientati
+000121b0: 6f6e 2873 656c 662c 202a 2a6b 7761 7267  on(self, **kwarg
+000121c0: 7329 0a0a 2020 2020 6465 6620 6d6f 7665  s)..    def move
+000121d0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000121e0: 2020 2020 2020 2020 6f72 6967 696e 3a20          origin: 
+000121f0: 466c 6f61 7432 203d 2028 302c 2030 292c  Float2 = (0, 0),
+00012200: 0a20 2020 2020 2020 2064 6573 7469 6e61  .        destina
+00012210: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b46  tion: Optional[F
+00012220: 6c6f 6174 325d 203d 204e 6f6e 652c 0a20  loat2] = None,. 
+00012230: 2020 2020 2020 2061 7869 733a 204f 7074         axis: Opt
+00012240: 696f 6e61 6c5b 4178 6973 5d20 3d20 4e6f  ional[Axis] = No
+00012250: 6e65 2c0a 2020 2020 2920 2d3e 2043 6f6d  ne,.    ) -> Com
+00012260: 706f 6e65 6e74 3a0a 2020 2020 2020 2020  ponent:.        
+00012270: 2222 2252 6574 7572 6e73 206e 6577 2043  """Returns new C
+00012280: 6f6d 706f 6e65 6e74 2077 6974 6820 6120  omponent with a 
+00012290: 6d6f 7665 6420 7265 6665 7265 6e63 6520  moved reference 
+000122a0: 746f 2074 6865 206f 7269 6769 6e61 6c2e  to the original.
+000122b0: 0a0a 2020 2020 2020 2020 636f 6d70 6f6e  ..        compon
+000122c0: 656e 742e 0a0a 2020 2020 2020 2020 4172  ent...        Ar
+000122d0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000122e0: 6f72 6967 696e 3a20 6f66 2063 6f6d 706f  origin: of compo
+000122f0: 6e65 6e74 2e0a 2020 2020 2020 2020 2020  nent..          
+00012300: 2020 6465 7374 696e 6174 696f 6e3a 2078    destination: x
+00012310: 2c20 792e 0a20 2020 2020 2020 2020 2020  , y..           
+00012320: 2061 7869 733a 2078 206f 7220 792e 0a20   axis: x or y.. 
+00012330: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00012340: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00012350: 726f 7228 6d6f 7665 5f65 7272 6f72 5f6d  ror(move_error_m
+00012360: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
+00012370: 206d 6972 726f 7228 7365 6c66 2c20 7031   mirror(self, p1
+00012380: 3a20 466c 6f61 7432 203d 2028 302c 2031  : Float2 = (0, 1
+00012390: 292c 2070 323a 2046 6c6f 6174 3220 3d20  ), p2: Float2 = 
+000123a0: 2830 2c20 3029 2c20 2a2a 6b77 6172 6773  (0, 0), **kwargs
+000123b0: 2920 2d3e 2043 6f6d 706f 6e65 6e74 3a0a  ) -> Component:.
+000123c0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000123d0: 6e73 206e 6577 2043 6f6d 706f 6e65 6e74  ns new Component
+000123e0: 2077 6974 6820 6120 6d69 7272 6f72 6564   with a mirrored
+000123f0: 2072 6566 6572 656e 6365 2e0a 0a20 2020   reference...   
+00012400: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00012410: 2020 2020 2020 2070 313a 2066 6972 7374         p1: first
+00012420: 2070 6f69 6e74 2074 6f20 6465 6669 6e65   point to define
+00012430: 206d 6972 726f 7220 6178 6973 2e0a 2020   mirror axis..  
+00012440: 2020 2020 2020 2020 2020 7032 3a20 7365            p2: se
+00012450: 636f 6e64 2070 6f69 6e74 2074 6f20 6465  cond point to de
+00012460: 6669 6e65 206d 6972 726f 7220 6178 6973  fine mirror axis
+00012470: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00012480: 2020 2020 2020 6672 6f6d 2067 6473 6661        from gdsfa
+00012490: 6374 6f72 792e 6675 6e63 7469 6f6e 7320  ctory.functions 
+000124a0: 696d 706f 7274 206d 6972 726f 720a 0a20  import mirror.. 
+000124b0: 2020 2020 2020 2072 6574 7572 6e20 6d69         return mi
+000124c0: 7272 6f72 2863 6f6d 706f 6e65 6e74 3d73  rror(component=s
+000124d0: 656c 662c 2070 313d 7031 2c20 7032 3d70  elf, p1=p1, p2=p
+000124e0: 322c 202a 2a6b 7761 7267 7329 0a0a 2020  2, **kwargs)..  
+000124f0: 2020 6465 6620 726f 7461 7465 2873 656c    def rotate(sel
+00012500: 662c 2061 6e67 6c65 3a20 666c 6f61 7420  f, angle: float 
+00012510: 3d20 3930 2c20 2a2a 6b77 6172 6773 2920  = 90, **kwargs) 
+00012520: 2d3e 2043 6f6d 706f 6e65 6e74 3a0a 2020  -> Component:.  
+00012530: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
+00012540: 206e 6577 2063 6f6d 706f 6e65 6e74 2077   new component w
+00012550: 6974 6820 6120 726f 7461 7465 6420 7265  ith a rotated re
+00012560: 6665 7265 6e63 6520 746f 2074 6865 206f  ference to the o
+00012570: 7269 6769 6e61 6c2e 0a0a 2020 2020 2020  riginal...      
+00012580: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00012590: 2020 2020 616e 676c 653a 2069 6e20 6465      angle: in de
+000125a0: 6772 6565 732e 0a20 2020 2020 2020 2022  grees..        "
+000125b0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+000125c0: 6764 7366 6163 746f 7279 2e66 756e 6374  gdsfactory.funct
+000125d0: 696f 6e73 2069 6d70 6f72 7420 726f 7461  ions import rota
+000125e0: 7465 0a0a 2020 2020 2020 2020 7265 7475  te..        retu
+000125f0: 726e 2072 6f74 6174 6528 636f 6d70 6f6e  rn rotate(compon
+00012600: 656e 743d 7365 6c66 2c20 616e 676c 653d  ent=self, angle=
+00012610: 616e 676c 652c 202a 2a6b 7761 7267 7329  angle, **kwargs)
+00012620: 0a0a 2020 2020 6465 6620 6164 645f 7061  ..    def add_pa
+00012630: 6464 696e 6728 7365 6c66 2c20 2a2a 6b77  dding(self, **kw
+00012640: 6172 6773 2920 2d3e 2043 6f6d 706f 6e65  args) -> Compone
+00012650: 6e74 3a0a 2020 2020 2020 2020 2222 2252  nt:.        """R
+00012660: 6574 7572 6e73 2073 616d 6520 636f 6d70  eturns same comp
+00012670: 6f6e 656e 7420 7769 7468 2070 6164 6469  onent with paddi
+00012680: 6e67 2e0a 0a20 2020 2020 2020 204b 6579  ng...        Key
+00012690: 776f 7264 2041 7267 733a 0a20 2020 2020  word Args:.     
+000126a0: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+000126b0: 3a20 666f 7220 7061 6464 696e 672e 0a20  : for padding.. 
+000126c0: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+000126d0: 733a 206c 6973 7420 6f66 206c 6179 6572  s: list of layer
+000126e0: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
+000126f0: 7566 6669 7820 666f 7220 6e61 6d65 2e0a  uffix for name..
+00012700: 2020 2020 2020 2020 2020 2020 6465 6661              defa
+00012710: 756c 743a 2064 6566 6175 6c74 2070 6164  ult: default pad
+00012720: 6469 6e67 2028 3530 756d 292e 0a20 2020  ding (50um)..   
+00012730: 2020 2020 2020 2020 2074 6f70 3a20 6e6f           top: no
+00012740: 7274 6820 7061 6464 696e 672e 0a20 2020  rth padding..   
+00012750: 2020 2020 2020 2020 2062 6f74 746f 6d3a           bottom:
+00012760: 2073 6f75 7468 2070 6164 6469 6e67 2e0a   south padding..
+00012770: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+00012780: 743a 2065 6173 7420 7061 6464 696e 672e  t: east padding.
+00012790: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
+000127a0: 743a 2077 6573 7420 7061 6464 696e 672e  t: west padding.
+000127b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000127c0: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
+000127d0: 746f 7279 2e61 6464 5f70 6164 6469 6e67  tory.add_padding
+000127e0: 2069 6d70 6f72 7420 6164 645f 7061 6464   import add_padd
+000127f0: 696e 670a 0a20 2020 2020 2020 2072 6574  ing..        ret
+00012800: 7572 6e20 6164 645f 7061 6464 696e 6728  urn add_padding(
+00012810: 636f 6d70 6f6e 656e 743d 7365 6c66 2c20  component=self, 
+00012820: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+00012830: 6566 2061 6273 6f72 6228 7365 6c66 2c20  ef absorb(self, 
+00012840: 7265 6665 7265 6e63 6529 202d 3e20 436f  reference) -> Co
+00012850: 6d70 6f6e 656e 743a 0a20 2020 2020 2020  mponent:.       
+00012860: 2022 2222 4162 736f 7262 7320 706f 6c79   """Absorbs poly
+00012870: 676f 6e73 2066 726f 6d20 436f 6d70 6f6e  gons from Compon
+00012880: 656e 7452 6566 6572 656e 6365 2069 6e74  entReference int
+00012890: 6f20 436f 6d70 6f6e 656e 742e 0a0a 2020  o Component...  
+000128a0: 2020 2020 2020 4465 7374 726f 7973 2074        Destroys t
+000128b0: 6865 2072 6566 6572 656e 6365 2069 6e20  he reference in 
+000128c0: 7468 6520 7072 6f63 6573 7320 6275 7420  the process but 
+000128d0: 6b65 6570 696e 6720 7468 6520 706f 6c79  keeping the poly
+000128e0: 676f 6e20 6765 6f6d 6574 7279 2e0a 0a20  gon geometry... 
+000128f0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00012900: 2020 2020 2020 2020 2072 6566 6572 656e           referen
+00012910: 6365 3a20 436f 6d70 6f6e 656e 7452 6566  ce: ComponentRef
+00012920: 6572 656e 6365 2074 6f20 6265 2061 6273  erence to be abs
+00012930: 6f72 6265 6420 696e 746f 2074 6865 2043  orbed into the C
+00012940: 6f6d 706f 6e65 6e74 2e0a 2020 2020 2020  omponent..      
+00012950: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00012960: 2072 6566 6572 656e 6365 206e 6f74 2069   reference not i
+00012970: 6e20 7365 6c66 2e72 6566 6572 656e 6365  n self.reference
+00012980: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00012990: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000129a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000129b0: 2022 5468 6520 7265 6665 7265 6e63 6520   "The reference 
+000129c0: 796f 7520 6173 6b65 6420 746f 2061 6273  you asked to abs
+000129d0: 6f72 6220 646f 6573 206e 6f74 2065 7869  orb does not exi
+000129e0: 7374 2069 6e20 7468 6973 2043 6f6d 706f  st in this Compo
+000129f0: 6e65 6e74 2e22 0a20 2020 2020 2020 2020  nent.".         
+00012a00: 2020 2029 0a20 2020 2020 2020 2072 6566     ).        ref
+00012a10: 5f70 6f6c 7967 6f6e 7320 3d20 7265 6665  _polygons = refe
+00012a20: 7265 6e63 652e 6765 745f 706f 6c79 676f  rence.get_polygo
+00012a30: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00012a40: 6279 5f73 7065 633d 4661 6c73 652c 2069  by_spec=False, i
+00012a50: 6e63 6c75 6465 5f70 6174 6873 3d46 616c  nclude_paths=Fal
+00012a60: 7365 2c20 6173 5f61 7272 6179 3d46 616c  se, as_array=Fal
+00012a70: 7365 0a20 2020 2020 2020 2029 0a20 2020  se.        ).   
+00012a80: 2020 2020 2073 656c 662e 5f61 6464 5f70       self._add_p
+00012a90: 6f6c 7967 6f6e 7328 2a72 6566 5f70 6f6c  olygons(*ref_pol
+00012aa0: 7967 6f6e 7329 0a0a 2020 2020 2020 2020  ygons)..        
+00012ab0: 7365 6c66 2e61 6464 2872 6566 6572 656e  self.add(referen
+00012ac0: 6365 2e67 6574 5f6c 6162 656c 7328 2929  ce.get_labels())
+00012ad0: 0a20 2020 2020 2020 2073 656c 662e 6164  .        self.ad
+00012ae0: 6428 7265 6665 7265 6e63 652e 6765 745f  d(reference.get_
+00012af0: 7061 7468 7328 2929 0a20 2020 2020 2020  paths()).       
+00012b00: 2073 656c 662e 7265 6d6f 7665 2872 6566   self.remove(ref
+00012b10: 6572 656e 6365 290a 2020 2020 2020 2020  erence).        
+00012b20: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+00012b30: 2064 6566 2072 656d 6f76 6528 7365 6c66   def remove(self
+00012b40: 2c20 6974 656d 7329 3a0a 2020 2020 2020  , items):.      
+00012b50: 2020 2222 2252 656d 6f76 6573 2069 7465    """Removes ite
+00012b60: 6d73 2066 726f 6d20 6120 436f 6d70 6f6e  ms from a Compon
+00012b70: 656e 742c 2077 6869 6368 2063 616e 2069  ent, which can i
+00012b80: 6e63 6c75 6465 2050 6f72 7473 2c20 506f  nclude Ports, Po
+00012b90: 6c79 676f 6e53 6574 7320 5c0a 2020 2020  lygonSets \.    
+00012ba0: 2020 2020 4365 6c6c 5265 6665 7265 6e63      CellReferenc
+00012bb0: 6573 2c20 436f 6d70 6f6e 656e 7452 6566  es, ComponentRef
+00012bc0: 6572 656e 6365 7320 616e 6420 4c61 6265  erences and Labe
+00012bd0: 6c73 2e0a 0a20 2020 2020 2020 2041 7267  ls...        Arg
+00012be0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
+00012bf0: 7465 6d73 3a20 6c69 7374 206f 6620 4974  tems: list of It
+00012c00: 656d 7320 746f 2062 6520 7265 6d6f 7665  ems to be remove
+00012c10: 6420 6672 6f6d 2074 6865 2043 6f6d 706f  d from the Compo
+00012c20: 6e65 6e74 2e0a 2020 2020 2020 2020 2222  nent..        ""
+00012c30: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+00012c40: 2068 6173 6174 7472 2869 7465 6d73 2c20   hasattr(items, 
+00012c50: 225f 5f69 7465 725f 5f22 293a 0a20 2020  "__iter__"):.   
+00012c60: 2020 2020 2020 2020 2069 7465 6d73 203d           items =
+00012c70: 205b 6974 656d 735d 0a20 2020 2020 2020   [items].       
+00012c80: 2066 6f72 2069 7465 6d20 696e 2069 7465   for item in ite
+00012c90: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
+00012ca0: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
+00012cb0: 656d 2c20 506f 7274 293a 0a20 2020 2020  em, Port):.     
+00012cc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012cd0: 706f 7274 7320 3d20 7b6b 3a20 7620 666f  ports = {k: v fo
+00012ce0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e70  r k, v in self.p
+00012cf0: 6f72 7473 2e69 7465 6d73 2829 2069 6620  orts.items() if 
+00012d00: 7620 213d 2069 7465 6d7d 0a20 2020 2020  v != item}.     
+00012d10: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00012d20: 7374 616e 6365 2869 7465 6d2c 2067 6473  stance(item, gds
+00012d30: 746b 2e52 6566 6572 656e 6365 293a 0a20  tk.Reference):. 
+00012d40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00012d50: 656c 662e 5f63 656c 6c2e 7265 6d6f 7665  elf._cell.remove
+00012d60: 2869 7465 6d29 0a20 2020 2020 2020 2020  (item).         
+00012d70: 2020 2020 2020 2069 7465 6d2e 6f77 6e65         item.owne
+00012d80: 7220 3d20 4e6f 6e65 0a20 2020 2020 2020  r = None.       
+00012d90: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00012da0: 616e 6365 2869 7465 6d2c 2043 6f6d 706f  ance(item, Compo
+00012db0: 6e65 6e74 5265 6665 7265 6e63 6529 3a0a  nentReference):.
+00012dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012dd0: 7365 6c66 2e72 6566 6572 656e 6365 732e  self.references.
+00012de0: 7265 6d6f 7665 2869 7465 6d29 0a20 2020  remove(item).   
+00012df0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012e00: 662e 5f63 656c 6c2e 7265 6d6f 7665 2869  f._cell.remove(i
+00012e10: 7465 6d2e 5f72 6566 6572 656e 6365 290a  tem._reference).
+00012e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e30: 6974 656d 2e6f 776e 6572 203d 204e 6f6e  item.owner = Non
+00012e40: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00012e50: 2020 7365 6c66 2e5f 6e61 6d65 645f 7265    self._named_re
+00012e60: 6665 7265 6e63 6573 2e70 6f70 2869 7465  ferences.pop(ite
+00012e70: 6d2e 6e61 6d65 290a 2020 2020 2020 2020  m.name).        
+00012e80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00012e90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00012ea0: 6365 6c6c 2e72 656d 6f76 6528 6974 656d  cell.remove(item
+00012eb0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00012ec0: 5f62 625f 7661 6c69 6420 3d20 4661 6c73  _bb_valid = Fals
+00012ed0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00012ee0: 2073 656c 660a 0a20 2020 2064 6566 2068   self..    def h
+00012ef0: 6173 685f 6765 6f6d 6574 7279 2873 656c  ash_geometry(sel
+00012f00: 662c 2070 7265 6369 7369 6f6e 3a20 666c  f, precision: fl
+00012f10: 6f61 7420 3d20 3165 2d34 2920 2d3e 2073  oat = 1e-4) -> s
+00012f20: 7472 3a0a 2020 2020 2020 2020 2222 2252  tr:.        """R
+00012f30: 6574 7572 6e73 2061 6e20 5348 4131 2068  eturns an SHA1 h
+00012f40: 6173 6820 6f66 2074 6865 2067 656f 6d65  ash of the geome
+00012f50: 7472 7920 696e 2074 6865 2043 6f6d 706f  try in the Compo
+00012f60: 6e65 6e74 2e0a 0a20 2020 2020 2020 2046  nent...        F
+00012f70: 6f72 2065 6163 6820 6c61 7965 722c 2065  or each layer, e
+00012f80: 6163 6820 706f 6c79 676f 6e20 6973 2069  ach polygon is i
+00012f90: 6e64 6976 6964 7561 6c6c 7920 6861 7368  ndividually hash
+00012fa0: 6564 2061 6e64 2074 6865 6e20 7468 6520  ed and then the 
+00012fb0: 706f 6c79 676f 6e20 6861 7368 6573 0a20  polygon hashes. 
+00012fc0: 2020 2020 2020 2061 7265 2073 6f72 7465         are sorte
+00012fd0: 642c 2074 6f20 656e 7375 7265 2074 6865  d, to ensure the
+00012fe0: 2068 6173 6820 7374 6179 7320 636f 6e73   hash stays cons
+00012ff0: 7461 6e74 2072 6567 6172 646c 6573 7320  tant regardless 
+00013000: 6f66 2074 6865 206f 7264 6572 696e 670a  of the ordering.
+00013010: 2020 2020 2020 2020 7468 6520 706f 6c79          the poly
+00013020: 676f 6e73 2e20 2053 696d 696c 6172 6c79  gons.  Similarly
+00013030: 2c20 7468 6520 6c61 7965 7273 2061 7265  , the layers are
+00013040: 2073 6f72 7465 6420 6279 2028 6c61 7965   sorted by (laye
+00013050: 722c 2064 6174 6174 7970 6529 2e0a 0a20  r, datatype)... 
+00013060: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00013070: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
+00013080: 6f6e 3a20 526f 756e 6469 6e67 2070 7265  on: Rounding pre
+00013090: 6369 7369 6f6e 2066 6f72 2074 6865 2074  cision for the t
+000130a0: 6865 206f 626a 6563 7473 2069 6e20 7468  he objects in th
+000130b0: 6520 436f 6d70 6f6e 656e 742e 0a20 2020  e Component..   
+000130c0: 2020 2020 2020 2020 2020 2020 2046 6f72               For
+000130d0: 2069 6e73 7461 6e63 652c 2061 2070 7265   instance, a pre
+000130e0: 6369 7369 6f6e 206f 6620 3165 2d32 2077  cision of 1e-2 w
+000130f0: 696c 6c20 726f 756e 6420 6120 706f 696e  ill round a poin
+00013100: 7420 6174 0a20 2020 2020 2020 2020 2020  t at.           
+00013110: 2020 2020 2028 302e 3132 342c 2031 2e37       (0.124, 1.7
+00013120: 3438 2920 746f 2028 302e 3132 2c20 312e  48) to (0.12, 1.
+00013130: 3735 292e 0a0a 2020 2020 2020 2020 2222  75)...        ""
+00013140: 220a 2020 2020 2020 2020 706f 6c79 676f  ".        polygo
+00013150: 6e73 5f62 795f 7370 6563 203d 2073 656c  ns_by_spec = sel
+00013160: 662e 6765 745f 706f 6c79 676f 6e73 2862  f.get_polygons(b
+00013170: 795f 7370 6563 3d54 7275 652c 2061 735f  y_spec=True, as_
+00013180: 6172 7261 793d 4661 6c73 6529 0a20 2020  array=False).   
+00013190: 2020 2020 206c 6179 6572 7320 3d20 6e70       layers = np
+000131a0: 2e61 7272 6179 286c 6973 7428 706f 6c79  .array(list(poly
+000131b0: 676f 6e73 5f62 795f 7370 6563 2e6b 6579  gons_by_spec.key
+000131c0: 7328 2929 290a 2020 2020 2020 2020 736f  s())).        so
+000131d0: 7274 6564 5f6c 6179 6572 7320 3d20 6c61  rted_layers = la
+000131e0: 7965 7273 5b6e 702e 6c65 7873 6f72 7428  yers[np.lexsort(
+000131f0: 286c 6179 6572 735b 3a2c 2030 5d2c 206c  (layers[:, 0], l
+00013200: 6179 6572 735b 3a2c 2031 5d29 295d 0a0a  ayers[:, 1]))]..
+00013210: 2020 2020 2020 2020 6669 6e61 6c5f 6861          final_ha
+00013220: 7368 203d 2068 6173 686c 6962 2e73 6861  sh = hashlib.sha
+00013230: 3128 290a 2020 2020 2020 2020 666f 7220  1().        for 
+00013240: 6c61 7965 7220 696e 2073 6f72 7465 645f  layer in sorted_
+00013250: 6c61 7965 7273 3a0a 2020 2020 2020 2020  layers:.        
+00013260: 2020 2020 6c61 7965 725f 6861 7368 203d      layer_hash =
+00013270: 2068 6173 686c 6962 2e73 6861 3128 6c61   hashlib.sha1(la
+00013280: 7965 722e 6173 7479 7065 286e 702e 696e  yer.astype(np.in
+00013290: 7436 3429 292e 6469 6765 7374 2829 0a20  t64)).digest(). 
+000132a0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
+000132b0: 6f6e 7320 3d20 706f 6c79 676f 6e73 5f62  ons = polygons_b
+000132c0: 795f 7370 6563 5b74 7570 6c65 286c 6179  y_spec[tuple(lay
+000132d0: 6572 295d 0a20 2020 2020 2020 2020 2020  er)].           
+000132e0: 2070 6f6c 7967 6f6e 7320 3d20 5b5f 726e   polygons = [_rn
+000132f0: 6428 702e 706f 696e 7473 2c20 7072 6563  d(p.points, prec
+00013300: 6973 696f 6e29 2066 6f72 2070 2069 6e20  ision) for p in 
+00013310: 706f 6c79 676f 6e73 5d0a 2020 2020 2020  polygons].      
+00013320: 2020 2020 2020 706f 6c79 676f 6e5f 6861        polygon_ha
+00013330: 7368 6573 203d 206e 702e 736f 7274 285b  shes = np.sort([
+00013340: 6861 7368 6c69 622e 7368 6131 2870 292e  hashlib.sha1(p).
+00013350: 6469 6765 7374 2829 2066 6f72 2070 2069  digest() for p i
+00013360: 6e20 706f 6c79 676f 6e73 5d29 0a20 2020  n polygons]).   
+00013370: 2020 2020 2020 2020 2066 696e 616c 5f68           final_h
+00013380: 6173 682e 7570 6461 7465 286c 6179 6572  ash.update(layer
+00013390: 5f68 6173 6829 0a20 2020 2020 2020 2020  _hash).         
+000133a0: 2020 2066 6f72 2070 6820 696e 2070 6f6c     for ph in pol
+000133b0: 7967 6f6e 5f68 6173 6865 733a 0a20 2020  ygon_hashes:.   
+000133c0: 2020 2020 2020 2020 2020 2020 2066 696e               fin
+000133d0: 616c 5f68 6173 682e 7570 6461 7465 2870  al_hash.update(p
+000133e0: 6829 0a0a 2020 2020 2020 2020 7265 7475  h)..        retu
+000133f0: 726e 2066 696e 616c 5f68 6173 682e 6865  rn final_hash.he
+00013400: 7864 6967 6573 7428 290a 0a20 2020 2064  xdigest()..    d
+00013410: 6566 2067 6574 5f6c 6162 656c 7328 0a20  ef get_labels(. 
+00013420: 2020 2020 2020 2073 656c 662c 2061 7070         self, app
+00013430: 6c79 5f72 6570 6574 6974 696f 6e73 3d54  ly_repetitions=T
+00013440: 7275 652c 2064 6570 7468 3a20 4f70 7469  rue, depth: Opti
+00013450: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+00013460: 2c20 6c61 7965 723d 4e6f 6e65 0a20 2020  , layer=None.   
+00013470: 2029 202d 3e20 4c69 7374 5b4c 6162 656c   ) -> List[Label
+00013480: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+00013490: 7475 726e 206c 6162 656c 732e 0a0a 2020  turn labels...  
+000134a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000134b0: 2020 2020 2020 2020 6170 706c 795f 7265          apply_re
+000134c0: 7065 7469 7469 6f6e 733a 2e0a 2020 2020  petitions:..    
+000134d0: 2020 2020 2020 2020 6465 7074 683a 204e          depth: N
+000134e0: 6f6e 6520 7265 7475 726e 7320 616c 6c20  one returns all 
+000134f0: 6c61 6265 6c73 2061 6e64 2030 2074 6f70  labels and 0 top
+00013500: 206c 6576 656c 2e0a 2020 2020 2020 2020   level..        
+00013510: 2020 2020 6c61 7965 723a 206c 6179 6572      layer: layer
+00013520: 7370 6563 2e0a 2020 2020 2020 2020 2222  spec..        ""
+00013530: 220a 2020 2020 2020 2020 6672 6f6d 2067  ".        from g
+00013540: 6473 6661 6374 6f72 792e 7064 6b20 696d  dsfactory.pdk im
+00013550: 706f 7274 2067 6574 5f6c 6179 6572 0a0a  port get_layer..
+00013560: 2020 2020 2020 2020 6966 206c 6179 6572          if layer
+00013570: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
+00013580: 7965 722c 2074 6578 7474 7970 6520 3d20  yer, texttype = 
+00013590: 6765 745f 6c61 7965 7228 6c61 7965 7229  get_layer(layer)
+000135a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000135b0: 2020 2020 2020 2020 2020 2074 6578 7474             textt
+000135c0: 7970 6520 3d20 4e6f 6e65 0a20 2020 2020  ype = None.     
+000135d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000135e0: 6365 6c6c 2e67 6574 5f6c 6162 656c 7328  cell.get_labels(
+000135f0: 0a20 2020 2020 2020 2020 2020 2061 7070  .            app
+00013600: 6c79 5f72 6570 6574 6974 696f 6e73 3d61  ly_repetitions=a
+00013610: 7070 6c79 5f72 6570 6574 6974 696f 6e73  pply_repetitions
+00013620: 2c0a 2020 2020 2020 2020 2020 2020 6465  ,.            de
+00013630: 7074 683d 6465 7074 682c 0a20 2020 2020  pth=depth,.     
+00013640: 2020 2020 2020 206c 6179 6572 3d6c 6179         layer=lay
+00013650: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00013660: 7465 7874 7479 7065 3d74 6578 7474 7970  texttype=texttyp
+00013670: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+00013680: 2020 6465 6620 7265 6d6f 7665 5f6c 6162    def remove_lab
+00013690: 656c 7328 7365 6c66 2920 2d3e 204e 6f6e  els(self) -> Non
+000136a0: 653a 0a20 2020 2020 2020 2022 2222 5265  e:.        """Re
+000136b0: 6d6f 7665 206c 6162 656c 732e 2222 220a  move labels.""".
+000136c0: 2020 2020 2020 2020 7365 6c66 2e5f 6365          self._ce
+000136d0: 6c6c 2e72 656d 6f76 6528 2a73 656c 662e  ll.remove(*self.
+000136e0: 6c61 6265 6c73 290a 0a20 2020 2023 2044  labels)..    # D
+000136f0: 6570 7265 6361 7465 640a 2020 2020 6465  eprecated.    de
+00013700: 6620 6765 745f 696e 666f 2873 656c 6629  f get_info(self)
+00013710: 3a0a 2020 2020 2020 2020 2222 2247 6174  :.        """Gat
+00013720: 6865 7273 2074 6865 202e 696e 666f 2064  hers the .info d
+00013730: 6963 7469 6f6e 6172 6965 7320 6672 6f6d  ictionaries from
+00013740: 2065 7665 7279 2073 7562 2d43 6f6d 706f   every sub-Compo
+00013750: 6e65 6e74 2061 6e64 2072 6574 7572 6e73  nent and returns
+00013760: 2074 6865 6d20 696e 2061 206c 6973 742e   them in a list.
+00013770: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00013780: 2020 2020 2020 2020 2020 2020 6465 7074              dept
+00013790: 683a 2069 6e74 206f 7220 4e6f 6e65 0a20  h: int or None. 
+000137a0: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+000137b0: 6620 6e6f 7420 4e6f 6e65 2c20 6465 6669  f not None, defi
+000137c0: 6e65 7320 6672 6f6d 2068 6f77 206d 616e  nes from how man
+000137d0: 7920 7265 6665 7265 6e63 6520 6c65 7665  y reference leve
+000137e0: 6c73 2074 6f0a 2020 2020 2020 2020 2020  ls to.          
+000137f0: 2020 2020 2020 7265 7472 6965 7665 2050        retrieve P
+00013800: 6f72 7473 2066 726f 6d2e 0a0a 2020 2020  orts from...    
+00013810: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+00013820: 2020 2020 2020 2020 206c 6973 7420 6f66           list of
+00013830: 2064 6963 7469 6f6e 6172 6965 730a 2020   dictionaries.  
+00013840: 2020 2020 2020 2020 2020 2020 2020 4c69                Li
+00013850: 7374 206f 6620 7468 6520 222e 696e 666f  st of the ".info
+00013860: 2220 7072 6f70 6572 7479 2064 6963 7469  " property dicti
+00013870: 6f6e 6172 6965 7320 6672 6f6d 2061 6c6c  onaries from all
+00013880: 2073 7562 2d43 6f6d 706f 6e65 6e74 730a   sub-Components.
+00013890: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000138a0: 2020 2020 445f 6c69 7374 203d 2073 656c      D_list = sel
+000138b0: 662e 6765 745f 6465 7065 6e64 656e 6369  f.get_dependenci
+000138c0: 6573 2872 6563 7572 7369 7665 3d54 7275  es(recursive=Tru
+000138d0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+000138e0: 6e20 5b44 2e69 6e66 6f2e 636f 7079 2829  n [D.info.copy()
+000138f0: 2066 6f72 2044 2069 6e20 445f 6c69 7374   for D in D_list
+00013900: 5d0a 0a20 2020 2064 6566 2072 656d 6170  ]..    def remap
+00013910: 5f6c 6179 6572 7328 0a20 2020 2020 2020  _layers(.       
+00013920: 2073 656c 662c 206c 6179 6572 6d61 702c   self, layermap,
+00013930: 2069 6e63 6c75 6465 5f6c 6162 656c 733a   include_labels:
+00013940: 2062 6f6f 6c20 3d20 5472 7565 2c20 696e   bool = True, in
+00013950: 636c 7564 655f 7061 7468 733a 2062 6f6f  clude_paths: boo
+00013960: 6c20 3d20 5472 7565 0a20 2020 2029 202d  l = True.    ) -
+00013970: 3e20 436f 6d70 6f6e 656e 743a 0a20 2020  > Component:.   
+00013980: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+00013990: 6120 636f 7079 206f 6620 7468 6520 636f  a copy of the co
+000139a0: 6d70 6f6e 656e 7420 7769 7468 2072 656d  mponent with rem
+000139b0: 6170 7065 6420 6c61 7965 7273 2e0a 0a20  apped layers... 
+000139c0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+000139d0: 2020 2020 2020 2020 206c 6179 6572 6d61           layerma
+000139e0: 703a 2044 6963 7469 6f6e 6172 7920 6f66  p: Dictionary of
+000139f0: 2076 616c 7565 7320 696e 2066 6f72 6d61   values in forma
+00013a00: 7420 7b6c 6179 6572 5f66 726f 6d20 3a20  t {layer_from : 
+00013a10: 6c61 7965 725f 746f 7d2e 0a20 2020 2020  layer_to}..     
+00013a20: 2020 2020 2020 2069 6e63 6c75 6465 5f6c         include_l
+00013a30: 6162 656c 733a 2053 656c 6563 7473 2077  abels: Selects w
+00013a40: 6865 7468 6572 2074 6f20 6d6f 7665 204c  hether to move L
+00013a50: 6162 656c 7320 616c 6f6e 6720 7769 7468  abels along with
+00013a60: 2070 6f6c 7967 6f6e 732e 0a20 2020 2020   polygons..     
+00013a70: 2020 2020 2020 2069 6e63 6c75 6465 5f70         include_p
+00013a80: 6174 6873 3a20 5365 6c65 6374 7320 7768  aths: Selects wh
+00013a90: 6574 6865 7220 746f 206d 6f76 6520 5061  ether to move Pa
+00013aa0: 7468 7320 616c 6f6e 6720 7769 7468 2070  ths along with p
+00013ab0: 6f6c 7967 6f6e 732e 0a20 2020 2020 2020  olygons..       
+00013ac0: 2022 2222 0a20 2020 2020 2020 2063 6f6d   """.        com
+00013ad0: 706f 6e65 6e74 203d 2073 656c 662e 636f  ponent = self.co
+00013ae0: 7079 2829 0a20 2020 2020 2020 206c 6179  py().        lay
+00013af0: 6572 6d61 7020 3d20 7b5f 7061 7273 655f  ermap = {_parse_
+00013b00: 6c61 7965 7228 6b29 3a20 5f70 6172 7365  layer(k): _parse
+00013b10: 5f6c 6179 6572 2876 2920 666f 7220 6b2c  _layer(v) for k,
+00013b20: 2076 2069 6e20 6c61 7965 726d 6170 2e69   v in layermap.i
+00013b30: 7465 6d73 2829 7d0a 0a20 2020 2020 2020  tems()}..       
+00013b40: 2061 6c6c 5f44 203d 206c 6973 7428 636f   all_D = list(co
+00013b50: 6d70 6f6e 656e 742e 6765 745f 6465 7065  mponent.get_depe
+00013b60: 6e64 656e 6369 6573 2854 7275 6529 290a  ndencies(True)).
+00013b70: 2020 2020 2020 2020 616c 6c5f 442e 6170          all_D.ap
+00013b80: 7065 6e64 2863 6f6d 706f 6e65 6e74 290a  pend(component).
+00013b90: 2020 2020 2020 2020 666f 7220 4420 696e          for D in
+00013ba0: 2061 6c6c 5f44 3a0a 2020 2020 2020 2020   all_D:.        
+00013bb0: 2020 2020 666f 7220 7020 696e 2044 2e70      for p in D.p
+00013bc0: 6f6c 7967 6f6e 733a 0a20 2020 2020 2020  olygons:.       
+00013bd0: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
+00013be0: 2028 702e 6c61 7965 722c 2070 2e64 6174   (p.layer, p.dat
+00013bf0: 6174 7970 6529 0a20 2020 2020 2020 2020  atype).         
+00013c00: 2020 2020 2020 2069 6620 6c61 7965 7220         if layer 
+00013c10: 696e 206c 6179 6572 6d61 703a 0a20 2020  in layermap:.   
+00013c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c30: 206e 6577 5f6c 6179 6572 203d 206c 6179   new_layer = lay
+00013c40: 6572 6d61 705b 6c61 7965 725d 0a20 2020  ermap[layer].   
+00013c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c60: 2070 2e6c 6179 6572 203d 206e 6577 5f6c   p.layer = new_l
+00013c70: 6179 6572 5b30 5d0a 2020 2020 2020 2020  ayer[0].        
+00013c80: 2020 2020 2020 2020 2020 2020 702e 6461              p.da
+00013c90: 7461 7479 7065 203d 206e 6577 5f6c 6179  tatype = new_lay
+00013ca0: 6572 5b31 5d0a 2020 2020 2020 2020 2020  er[1].          
+00013cb0: 2020 6966 2069 6e63 6c75 6465 5f6c 6162    if include_lab
+00013cc0: 656c 733a 0a20 2020 2020 2020 2020 2020  els:.           
+00013cd0: 2020 2020 2066 6f72 206c 6162 656c 2069       for label i
+00013ce0: 6e20 442e 6c61 6265 6c73 3a0a 2020 2020  n D.labels:.    
+00013cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d00: 6f72 6967 696e 616c 5f6c 6179 6572 203d  original_layer =
+00013d10: 2028 6c61 6265 6c2e 6c61 7965 722c 206c   (label.layer, l
+00013d20: 6162 656c 2e74 6578 7474 7970 6529 0a20  abel.texttype). 
+00013d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d40: 2020 206f 7269 6769 6e61 6c5f 6c61 7965     original_laye
+00013d50: 7220 3d20 5f70 6172 7365 5f6c 6179 6572  r = _parse_layer
+00013d60: 286f 7269 6769 6e61 6c5f 6c61 7965 7229  (original_layer)
+00013d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d80: 2020 2020 2069 6620 6f72 6967 696e 616c       if original
+00013d90: 5f6c 6179 6572 2069 6e20 6c61 7965 726d  _layer in layerm
+00013da0: 6170 3a0a 2020 2020 2020 2020 2020 2020  ap:.            
+00013db0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00013dc0: 6c61 7965 7220 3d20 6c61 7965 726d 6170  layer = layermap
+00013dd0: 5b6f 7269 6769 6e61 6c5f 6c61 7965 725d  [original_layer]
+00013de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013df0: 2020 2020 2020 2020 206c 6162 656c 2e6c           label.l
+00013e00: 6179 6572 203d 206e 6577 5f6c 6179 6572  ayer = new_layer
+00013e10: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00013e20: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+00013e30: 6c2e 7465 7874 7479 7065 203d 206e 6577  l.texttype = new
+00013e40: 5f6c 6179 6572 5b31 5d0a 0a20 2020 2020  _layer[1]..     
+00013e50: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
+00013e60: 655f 7061 7468 733a 0a20 2020 2020 2020  e_paths:.       
+00013e70: 2020 2020 2020 2020 2066 6f72 2070 6174           for pat
+00013e80: 6820 696e 2044 2e70 6174 6873 3a0a 2020  h in D.paths:.  
+00013e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ea0: 2020 6e65 775f 6c61 7965 7273 203d 206c    new_layers = l
+00013eb0: 6973 7428 7061 7468 2e6c 6179 6572 7329  ist(path.layers)
+00013ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013ed0: 2020 2020 206e 6577 5f64 6174 6174 7970       new_datatyp
+00013ee0: 6573 203d 206c 6973 7428 7061 7468 2e64  es = list(path.d
+00013ef0: 6174 6174 7970 6573 290a 2020 2020 2020  atatypes).      
+00013f00: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00013f10: 7220 6c61 7965 725f 6e75 6d62 6572 2069  r layer_number i
+00013f20: 6e20 7261 6e67 6528 6c65 6e28 6e65 775f  n range(len(new_
+00013f30: 6c61 7965 7273 2929 3a0a 2020 2020 2020  layers)):.      
+00013f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f50: 2020 6f72 6967 696e 616c 5f6c 6179 6572    original_layer
+00013f60: 203d 205f 7061 7273 655f 6c61 7965 7228   = _parse_layer(
+00013f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f80: 2020 2020 2020 2020 2020 2020 2028 6e65               (ne
+00013f90: 775f 6c61 7965 7273 5b6c 6179 6572 5f6e  w_layers[layer_n
+00013fa0: 756d 6265 725d 2c20 6e65 775f 6461 7461  umber], new_data
+00013fb0: 7479 7065 735b 6c61 7965 725f 6e75 6d62  types[layer_numb
+00013fc0: 6572 5d29 0a20 2020 2020 2020 2020 2020  er]).           
+00013fd0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00013fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ff0: 2020 2020 2020 2069 6620 6f72 6967 696e         if origin
+00014000: 616c 5f6c 6179 6572 2069 6e20 6c61 7965  al_layer in laye
+00014010: 726d 6170 3a0a 2020 2020 2020 2020 2020  rmap:.          
+00014020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014030: 2020 6e65 775f 6c61 7965 7220 3d20 6c61    new_layer = la
+00014040: 7965 726d 6170 5b6f 7269 6769 6e61 6c5f  yermap[original_
+00014050: 6c61 7965 725d 0a20 2020 2020 2020 2020  layer].         
+00014060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014070: 2020 206e 6577 5f6c 6179 6572 735b 6c61     new_layers[la
+00014080: 7965 725f 6e75 6d62 6572 5d20 3d20 6e65  yer_number] = ne
+00014090: 775f 6c61 7965 725b 305d 0a20 2020 2020  w_layer[0].     
+000140a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140b0: 2020 2020 2020 206e 6577 5f64 6174 6174         new_datat
+000140c0: 7970 6573 5b6c 6179 6572 5f6e 756d 6265  ypes[layer_numbe
+000140d0: 725d 203d 206e 6577 5f6c 6179 6572 5b31  r] = new_layer[1
+000140e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000140f0: 2020 2020 2020 7061 7468 2e73 6574 5f6c        path.set_l
+00014100: 6179 6572 7328 2a6e 6577 5f6c 6179 6572  ayers(*new_layer
+00014110: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00014120: 2020 2020 2020 2070 6174 682e 7365 745f         path.set_
+00014130: 6461 7461 7479 7065 7328 2a6e 6577 5f64  datatypes(*new_d
+00014140: 6174 6174 7970 6573 290a 2020 2020 2020  atatypes).      
+00014150: 2020 7265 7475 726e 2063 6f6d 706f 6e65    return compone
+00014160: 6e74 0a0a 2020 2020 6465 6620 746f 5f33  nt..    def to_3
+00014170: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
+00014180: 0a20 2020 2020 2020 206c 6179 6572 5f76  .        layer_v
+00014190: 6965 7773 3a20 4f70 7469 6f6e 616c 5b4c  iews: Optional[L
+000141a0: 6179 6572 5669 6577 735d 203d 204e 6f6e  ayerViews] = Non
+000141b0: 652c 0a20 2020 2020 2020 206c 6179 6572  e,.        layer
+000141c0: 5f73 7461 636b 3a20 4f70 7469 6f6e 616c  _stack: Optional
+000141d0: 5b4c 6179 6572 5374 6163 6b5d 203d 204e  [LayerStack] = N
+000141e0: 6f6e 652c 0a20 2020 2020 2020 2065 7863  one,.        exc
+000141f0: 6c75 6465 5f6c 6179 6572 733a 204f 7074  lude_layers: Opt
+00014200: 696f 6e61 6c5b 5475 706c 655b 4c61 7965  ional[Tuple[Laye
+00014210: 722c 202e 2e2e 5d5d 203d 204e 6f6e 652c  r, ...]] = None,
+00014220: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00014230: 2222 2252 6574 7572 6e20 436f 6d70 6f6e  """Return Compon
+00014240: 656e 7420 3344 2074 7269 6d65 7368 2053  ent 3D trimesh S
+00014250: 6365 6e65 2e0a 0a20 2020 2020 2020 2041  cene...        A
+00014260: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00014270: 2063 6f6d 706f 6e65 6e74 3a20 746f 2065   component: to e
+00014280: 7874 7275 6465 2069 6e20 3344 2e0a 2020  xtrude in 3D..  
+00014290: 2020 2020 2020 2020 2020 6c61 7965 725f            layer_
+000142a0: 7669 6577 733a 206c 6179 6572 2063 6f6c  views: layer col
+000142b0: 6f72 7320 6672 6f6d 204b 6c61 796f 7574  ors from Klayout
+000142c0: 204c 6179 6572 2050 726f 7065 7274 6965   Layer Propertie
+000142d0: 7320 6669 6c65 2e0a 2020 2020 2020 2020  s file..        
+000142e0: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
+000142f0: 2074 6f20 6163 7469 7665 2050 444b 2e6c   to active PDK.l
+00014300: 6179 6572 5f76 6965 7773 2e0a 2020 2020  ayer_views..    
+00014310: 2020 2020 2020 2020 6c61 7965 725f 7374          layer_st
+00014320: 6163 6b3a 2063 6f6e 7461 696e 7320 7468  ack: contains th
+00014330: 6963 6b6e 6573 7320 616e 6420 7a6d 696e  ickness and zmin
+00014340: 2066 6f72 2065 6163 6820 6c61 7965 722e   for each layer.
+00014350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014360: 2044 6566 6175 6c74 7320 746f 2061 6374   Defaults to act
+00014370: 6976 6520 5044 4b2e 6c61 7965 725f 7374  ive PDK.layer_st
+00014380: 6163 6b2e 0a20 2020 2020 2020 2020 2020  ack..           
+00014390: 2065 7863 6c75 6465 5f6c 6179 6572 733a   exclude_layers:
+000143a0: 206c 6179 6572 7320 746f 2065 7863 6c75   layers to exclu
+000143b0: 6465 2e0a 0a20 2020 2020 2020 2022 2222  de...        """
+000143c0: 0a20 2020 2020 2020 2066 726f 6d20 6764  .        from gd
+000143d0: 7366 6163 746f 7279 2e65 7870 6f72 742e  sfactory.export.
+000143e0: 746f 5f33 6420 696d 706f 7274 2074 6f5f  to_3d import to_
+000143f0: 3364 0a0a 2020 2020 2020 2020 7265 7475  3d..        retu
+00014400: 726e 2074 6f5f 3364 280a 2020 2020 2020  rn to_3d(.      
+00014410: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00014420: 2020 2020 2020 2020 6c61 7965 725f 7669          layer_vi
+00014430: 6577 733d 6c61 7965 725f 7669 6577 732c  ews=layer_views,
+00014440: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+00014450: 6572 5f73 7461 636b 3d6c 6179 6572 5f73  er_stack=layer_s
+00014460: 7461 636b 2c0a 2020 2020 2020 2020 2020  tack,.          
+00014470: 2020 6578 636c 7564 655f 6c61 7965 7273    exclude_layers
+00014480: 3d65 7863 6c75 6465 5f6c 6179 6572 732c  =exclude_layers,
+00014490: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000144a0: 6465 6620 746f 5f6e 7028 0a20 2020 2020  def to_np(.     
+000144b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000144c0: 206e 6d5f 7065 725f 7069 7865 6c3a 2069   nm_per_pixel: i
+000144d0: 6e74 203d 2032 302c 0a20 2020 2020 2020  nt = 20,.       
+000144e0: 206c 6179 6572 733a 204c 6179 6572 7320   layers: Layers 
+000144f0: 3d20 2828 312c 2030 292c 292c 0a20 2020  = ((1, 0),),.   
+00014500: 2020 2020 2076 616c 7565 733a 204f 7074       values: Opt
+00014510: 696f 6e61 6c5b 5475 706c 655b 666c 6f61  ional[Tuple[floa
+00014520: 742c 202e 2e2e 5d5d 203d 204e 6f6e 652c  t, ...]] = None,
+00014530: 0a20 2020 2020 2020 2070 6164 5f77 6964  .        pad_wid
+00014540: 7468 3a20 696e 7420 3d20 312c 0a20 2020  th: int = 1,.   
+00014550: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
+00014560: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00014570: 7572 6e73 2061 2070 6978 656c 6174 6564  urns a pixelated
+00014580: 206e 756d 7079 2061 7272 6179 2066 726f   numpy array fro
+00014590: 6d20 436f 6d70 6f6e 656e 7420 706f 6c79  m Component poly
+000145a0: 676f 6e73 2e0a 0a20 2020 2020 2020 2041  gons...        A
+000145b0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+000145c0: 2063 6f6d 706f 6e65 6e74 3a20 436f 6d70   component: Comp
+000145d0: 6f6e 656e 742e 0a20 2020 2020 2020 2020  onent..         
+000145e0: 2020 206e 6d5f 7065 725f 7069 7865 6c3a     nm_per_pixel:
+000145f0: 2079 6f75 2063 616e 2067 6f20 6672 6f6d   you can go from
+00014600: 2032 3020 2863 6f61 7273 6529 2074 6f20   20 (coarse) to 
+00014610: 3420 2866 696e 6529 2e0a 2020 2020 2020  4 (fine)..      
+00014620: 2020 2020 2020 6c61 7965 7273 3a20 746f        layers: to
+00014630: 2063 6f6e 7665 7274 2e20 4f72 6465 7220   convert. Order 
+00014640: 6d61 7474 6572 7320 286c 6174 7465 7220  matters (latter 
+00014650: 6f76 6572 7772 6974 6520 666f 726d 6572  overwrite former
+00014660: 292e 0a20 2020 2020 2020 2020 2020 2076  )..            v
+00014670: 616c 7565 733a 2061 7373 6f63 6961 7465  alues: associate
+00014680: 6420 746f 2065 6163 6820 6c61 7965 7220  d to each layer 
+00014690: 2864 6566 6175 6c74 7320 746f 2031 292e  (defaults to 1).
+000146a0: 0a20 2020 2020 2020 2020 2020 2070 6164  .            pad
+000146b0: 5f77 6964 7468 3a20 7061 6464 696e 6720  _width: padding 
+000146c0: 7069 7865 6c73 2061 726f 756e 6420 7468  pixels around th
+000146d0: 6520 696d 6167 652e 0a0a 2020 2020 2020  e image...      
+000146e0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+000146f0: 6f6d 2067 6473 6661 6374 6f72 792e 6578  om gdsfactory.ex
+00014700: 706f 7274 2e74 6f5f 6e70 2069 6d70 6f72  port.to_np impor
+00014710: 7420 746f 5f6e 700a 0a20 2020 2020 2020  t to_np..       
+00014720: 2072 6574 7572 6e20 746f 5f6e 7028 0a20   return to_np(. 
+00014730: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00014740: 0a20 2020 2020 2020 2020 2020 206e 6d5f  .            nm_
+00014750: 7065 725f 7069 7865 6c3d 6e6d 5f70 6572  per_pixel=nm_per
+00014760: 5f70 6978 656c 2c0a 2020 2020 2020 2020  _pixel,.        
+00014770: 2020 2020 6c61 7965 7273 3d6c 6179 6572      layers=layer
+00014780: 732c 0a20 2020 2020 2020 2020 2020 2076  s,.            v
+00014790: 616c 7565 733d 7661 6c75 6573 2c0a 2020  alues=values,.  
+000147a0: 2020 2020 2020 2020 2020 7061 645f 7769            pad_wi
+000147b0: 6474 683d 7061 645f 7769 6474 682c 0a20  dth=pad_width,. 
+000147c0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000147d0: 6620 7772 6974 655f 7374 6c28 0a20 2020  f write_stl(.   
+000147e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000147f0: 2020 2066 696c 6570 6174 683a 2073 7472     filepath: str
+00014800: 2c0a 2020 2020 2020 2020 6c61 7965 725f  ,.        layer_
+00014810: 7374 6163 6b3a 204f 7074 696f 6e61 6c5b  stack: Optional[
+00014820: 4c61 7965 7253 7461 636b 5d20 3d20 4e6f  LayerStack] = No
+00014830: 6e65 2c0a 2020 2020 2020 2020 6578 636c  ne,.        excl
+00014840: 7564 655f 6c61 7965 7273 3a20 4f70 7469  ude_layers: Opti
+00014850: 6f6e 616c 5b54 7570 6c65 5b4c 6179 6572  onal[Tuple[Layer
+00014860: 2c20 2e2e 2e5d 5d20 3d20 4e6f 6e65 2c0a  , ...]] = None,.
+00014870: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00014880: 2020 2020 2020 2022 2222 5772 6974 6520         """Write 
+00014890: 6120 436f 6d70 6f6e 656e 7420 746f 2053  a Component to S
+000148a0: 544c 2066 6f72 2033 4420 7072 696e 7469  TL for 3D printi
+000148b0: 6e67 2e0a 0a20 2020 2020 2020 2041 7267  ng...        Arg
+000148c0: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
+000148d0: 696c 6570 6174 683a 2074 6f20 7772 6974  ilepath: to writ
+000148e0: 6520 5354 4c20 746f 2e0a 2020 2020 2020  e STL to..      
+000148f0: 2020 2020 2020 6c61 7965 725f 7374 6163        layer_stac
+00014900: 6b3a 2063 6f6e 7461 696e 7320 7468 6963  k: contains thic
+00014910: 6b6e 6573 7320 616e 6420 7a6d 696e 2066  kness and zmin f
+00014920: 6f72 2065 6163 6820 6c61 7965 722e 0a20  or each layer.. 
+00014930: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
+00014940: 6465 5f6c 6179 6572 733a 206c 6179 6572  de_layers: layer
+00014950: 7320 746f 2065 7863 6c75 6465 2e0a 2020  s to exclude..  
+00014960: 2020 2020 2020 2020 2020 7573 655f 6c61            use_la
+00014970: 7965 725f 6e61 6d65 3a20 4966 2054 7275  yer_name: If Tru
+00014980: 652c 2075 7365 7320 4c61 7965 724c 6576  e, uses LayerLev
+00014990: 656c 206e 616d 6573 2069 6e20 6f75 7470  el names in outp
+000149a0: 7574 2066 696c 656e 616d 6573 2072 6174  ut filenames rat
+000149b0: 6865 7220 7468 616e 2067 6473 5f6c 6179  her than gds_lay
+000149c0: 6572 2061 6e64 2067 6473 5f64 6174 6174  er and gds_datat
+000149d0: 7970 652e 0a20 2020 2020 2020 2020 2020  ype..           
+000149e0: 2068 756c 6c5f 696e 7661 6c69 645f 706f   hull_invalid_po
+000149f0: 6c79 676f 6e73 3a20 4966 2054 7275 652c  lygons: If True,
+00014a00: 2072 6570 6c61 6365 7320 696e 7661 6c69   replaces invali
+00014a10: 6420 706f 6c79 676f 6e73 2028 6465 7465  d polygons (dete
+00014a20: 726d 696e 6564 2062 7920 7368 6170 656c  rmined by shapel
+00014a30: 792e 506f 6c79 676f 6e2e 6973 5f76 616c  y.Polygon.is_val
+00014a40: 6964 2920 7769 7468 2069 7473 2063 6f6e  id) with its con
+00014a50: 7665 7820 6875 6c6c 2e0a 2020 2020 2020  vex hull..      
+00014a60: 2020 2020 2020 7363 616c 653a 204f 7074        scale: Opt
+00014a70: 696f 6e61 6c20 6661 6374 6f72 2062 7920  ional factor by 
+00014a80: 7768 6963 6820 746f 2073 6361 6c65 206d  which to scale m
+00014a90: 6573 6865 7320 6265 666f 7265 2077 7269  eshes before wri
+00014aa0: 7469 6e67 2e0a 0a20 2020 2020 2020 2022  ting...        "
+00014ab0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00014ac0: 6764 7366 6163 746f 7279 2e65 7870 6f72  gdsfactory.expor
+00014ad0: 742e 746f 5f73 746c 2069 6d70 6f72 7420  t.to_stl import 
+00014ae0: 746f 5f73 746c 0a0a 2020 2020 2020 2020  to_stl..        
+00014af0: 746f 5f73 746c 280a 2020 2020 2020 2020  to_stl(.        
+00014b00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00014b10: 2020 2020 2020 6669 6c65 7061 7468 3d66        filepath=f
+00014b20: 696c 6570 6174 682c 0a20 2020 2020 2020  ilepath,.       
+00014b30: 2020 2020 206c 6179 6572 5f73 7461 636b       layer_stack
+00014b40: 3d6c 6179 6572 5f73 7461 636b 2c0a 2020  =layer_stack,.  
+00014b50: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
+00014b60: 655f 6c61 7965 7273 3d65 7863 6c75 6465  e_layers=exclude
+00014b70: 5f6c 6179 6572 732c 0a20 2020 2020 2020  _layers,.       
+00014b80: 2029 0a0a 2020 2020 6465 6620 7772 6974   )..    def writ
+00014b90: 655f 6765 7262 6572 2873 656c 662c 2064  e_gerber(self, d
+00014ba0: 6972 7061 7468 2c20 6c61 7965 726d 6170  irpath, layermap
+00014bb0: 5f74 6f5f 6765 7262 6572 5f6c 6179 6572  _to_gerber_layer
+00014bc0: 2c20 6f70 7469 6f6e 7329 202d 3e20 4e6f  , options) -> No
+00014bd0: 6e65 3a0a 2020 2020 2020 2020 6672 6f6d  ne:.        from
+00014be0: 2067 6473 6661 6374 6f72 792e 6578 706f   gdsfactory.expo
+00014bf0: 7274 2e74 6f5f 6765 7262 6572 2069 6d70  rt.to_gerber imp
+00014c00: 6f72 7420 746f 5f67 6572 6265 720a 0a20  ort to_gerber.. 
+00014c10: 2020 2020 2020 2074 6f5f 6765 7262 6572         to_gerber
+00014c20: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00014c30: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00014c40: 6469 7270 6174 683d 6469 7270 6174 682c  dirpath=dirpath,
+00014c50: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+00014c60: 6572 6d61 705f 746f 5f67 6572 6265 725f  ermap_to_gerber_
+00014c70: 6c61 7965 723d 6c61 7965 726d 6170 5f74  layer=layermap_t
+00014c80: 6f5f 6765 7262 6572 5f6c 6179 6572 2c0a  o_gerber_layer,.
+00014c90: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00014ca0: 6f6e 733d 6f70 7469 6f6e 732c 0a20 2020  ons=options,.   
+00014cb0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00014cc0: 746f 5f67 6d73 6828 0a20 2020 2020 2020  to_gmsh(.       
+00014cd0: 2073 656c 662c 0a20 2020 2020 2020 2074   self,.        t
+00014ce0: 7970 652c 0a20 2020 2020 2020 207a 3d4e  ype,.        z=N
+00014cf0: 6f6e 652c 0a20 2020 2020 2020 2078 7365  one,.        xse
+00014d00: 6374 696f 6e5f 626f 756e 6473 3d4e 6f6e  ction_bounds=Non
+00014d10: 652c 0a20 2020 2020 2020 206c 6179 6572  e,.        layer
+00014d20: 5f73 7461 636b 3d4e 6f6e 652c 0a20 2020  _stack=None,.   
+00014d30: 2020 2020 2077 6166 6572 5f70 6164 6469       wafer_paddi
+00014d40: 6e67 3d30 2e30 2c0a 2020 2020 2020 2020  ng=0.0,.        
+00014d50: 7761 6665 725f 6c61 7965 723d 4c41 5945  wafer_layer=LAYE
+00014d60: 522e 5741 4645 522c 0a20 2020 2020 2020  R.WAFER,.       
+00014d70: 202a 6172 6773 2c0a 2020 2020 2020 2020   *args,.        
+00014d80: 2a2a 6b77 6172 6773 2c0a 2020 2020 293a  **kwargs,.    ):
+00014d90: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00014da0: 726e 7320 6120 676d 7368 206d 7368 206f  rns a gmsh msh o
+00014db0: 6620 7468 6520 636f 6d70 6f6e 656e 7420  f the component 
+00014dc0: 666f 7220 6669 6e69 7465 2065 6c65 6d65  for finite eleme
+00014dd0: 6e74 2073 696d 756c 6174 696f 6e2e 0a0a  nt simulation...
+00014de0: 2020 2020 2020 2020 4172 6775 6d65 6e74          Argument
+00014df0: 733a 0a20 2020 2020 2020 2020 2020 2074  s:.            t
+00014e00: 7970 653a 206f 6e65 206f 6620 2278 7922  ype: one of "xy"
+00014e10: 2c20 2275 7a22 2c20 6f72 2022 3344 222e  , "uz", or "3D".
+00014e20: 2044 6574 6572 6d69 6e65 7320 7468 6520   Determines the 
+00014e30: 7479 7065 206f 6620 6d65 7368 2074 6f20  type of mesh to 
+00014e40: 7265 7475 726e 2e0a 2020 2020 2020 2020  return..        
+00014e50: 2020 2020 7a3a 2075 7365 6420 746f 2064      z: used to d
+00014e60: 6566 696e 6520 7a2d 736c 6963 6520 666f  efine z-slice fo
+00014e70: 7220 7879 206d 6573 6869 6e67 0a20 2020  r xy meshing.   
+00014e80: 2020 2020 2020 2020 2078 7365 6374 696f           xsectio
+00014e90: 6e5f 626f 756e 6473 3a20 7573 6564 2074  n_bounds: used t
+00014ea0: 6f20 6465 6669 6e65 2069 6e2d 706c 616e  o define in-plan
+00014eb0: 6520 6c69 6e65 2066 6f72 2075 7a20 6d65  e line for uz me
+00014ec0: 7368 696e 670a 2020 2020 2020 2020 2020  shing.          
+00014ed0: 2020 7761 6665 725f 7061 6464 696e 673a    wafer_padding:
+00014ee0: 2070 6164 6469 6e67 2062 6579 6f6e 6420   padding beyond 
+00014ef0: 6262 6f78 2074 6f20 6164 6420 746f 2057  bbox to add to W
+00014f00: 4146 4552 206c 6179 6572 732e 0a0a 2020  AFER layers...  
+00014f10: 2020 2020 2020 4b65 7977 6f72 6420 4172        Keyword Ar
+00014f20: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00014f30: 4172 6775 6d65 6e74 7320 666f 7220 7468  Arguments for th
+00014f40: 6520 7461 7267 6574 206d 6573 6869 6e67  e target meshing
+00014f50: 2066 756e 6374 696f 6e20 696e 2067 6473   function in gds
+00014f60: 6661 6374 6f72 792e 7369 6d75 6c61 7469  factory.simulati
+00014f70: 6f6e 2e67 6d73 680a 2020 2020 2020 2020  on.gmsh.        
+00014f80: 2222 220a 2020 2020 2020 2020 2320 4164  """.        # Ad
+00014f90: 6420 5741 4645 5220 6c61 7965 723a 0a20  d WAFER layer:. 
+00014fa0: 2020 2020 2020 2070 6164 6465 645f 636f         padded_co
+00014fb0: 6d70 6f6e 656e 7420 3d20 436f 6d70 6f6e  mponent = Compon
+00014fc0: 656e 7428 290a 2020 2020 2020 2020 7061  ent().        pa
+00014fd0: 6464 6564 5f63 6f6d 706f 6e65 6e74 203c  dded_component <
+00014fe0: 3c20 7365 6c66 0a20 2020 2020 2020 2028  < self.        (
+00014ff0: 786d 696e 2c20 796d 696e 292c 2028 786d  xmin, ymin), (xm
+00015000: 6178 2c20 796d 6178 2920 3d20 7365 6c66  ax, ymax) = self
+00015010: 2e62 626f 780a 2020 2020 2020 2020 706f  .bbox.        po
+00015020: 696e 7473 203d 205b 0a20 2020 2020 2020  ints = [.       
+00015030: 2020 2020 205b 786d 696e 202d 2077 6166       [xmin - waf
+00015040: 6572 5f70 6164 6469 6e67 2c20 796d 696e  er_padding, ymin
+00015050: 202d 2077 6166 6572 5f70 6164 6469 6e67   - wafer_padding
+00015060: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00015070: 786d 6178 202b 2077 6166 6572 5f70 6164  xmax + wafer_pad
+00015080: 6469 6e67 2c20 796d 696e 202d 2077 6166  ding, ymin - waf
+00015090: 6572 5f70 6164 6469 6e67 5d2c 0a20 2020  er_padding],.   
+000150a0: 2020 2020 2020 2020 205b 786d 6178 202b           [xmax +
+000150b0: 2077 6166 6572 5f70 6164 6469 6e67 2c20   wafer_padding, 
+000150c0: 796d 6178 202b 2077 6166 6572 5f70 6164  ymax + wafer_pad
+000150d0: 6469 6e67 5d2c 0a20 2020 2020 2020 2020  ding],.         
+000150e0: 2020 205b 786d 696e 202d 2077 6166 6572     [xmin - wafer
+000150f0: 5f70 6164 6469 6e67 2c20 796d 6178 202b  _padding, ymax +
+00015100: 2077 6166 6572 5f70 6164 6469 6e67 5d2c   wafer_padding],
+00015110: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
+00015120: 2020 2070 6164 6465 645f 636f 6d70 6f6e     padded_compon
+00015130: 656e 742e 6164 645f 706f 6c79 676f 6e28  ent.add_polygon(
+00015140: 706f 696e 7473 2c20 6c61 7965 723d 7761  points, layer=wa
+00015150: 6665 725f 6c61 7965 7229 0a0a 2020 2020  fer_layer)..    
+00015160: 2020 2020 6966 206c 6179 6572 5f73 7461      if layer_sta
+00015170: 636b 2069 7320 4e6f 6e65 3a0a 2020 2020  ck is None:.    
+00015180: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00015190: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+000151a0: 2020 2020 2020 2020 2020 2741 204c 6179            'A Lay
+000151b0: 6572 5374 6163 6b20 6d75 7374 2062 6520  erStack must be 
+000151c0: 7072 6f76 6964 6564 2074 6872 6f75 6768  provided through
+000151d0: 2061 7267 756d 656e 7420 226c 6179 6572   argument "layer
+000151e0: 5f73 7461 636b 222e 270a 2020 2020 2020  _stack".'.      
+000151f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015200: 6966 2074 7970 6520 3d3d 2022 7879 223a  if type == "xy":
+00015210: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00015220: 7a20 6973 204e 6f6e 653a 0a20 2020 2020  z is None:.     
+00015230: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00015240: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00015250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015260: 2027 466f 7220 7879 2d6d 6573 6869 6e67   'For xy-meshing
+00015270: 2c20 6120 7a2d 7661 6c75 6520 6d75 7374  , a z-value must
+00015280: 2062 6520 7072 6f76 6964 6564 2076 6961   be provided via
+00015290: 2074 6865 2066 6c6f 6174 2061 7267 756d   the float argum
+000152a0: 656e 7420 227a 222e 270a 2020 2020 2020  ent "z".'.      
+000152b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000152c0: 2020 2020 2020 2020 6672 6f6d 2067 6473          from gds
+000152d0: 6661 6374 6f72 792e 7369 6d75 6c61 7469  factory.simulati
+000152e0: 6f6e 2e67 6d73 682e 7879 5f78 7365 6374  on.gmsh.xy_xsect
+000152f0: 696f 6e5f 6d65 7368 2069 6d70 6f72 7420  ion_mesh import 
+00015300: 7879 5f78 7365 6374 696f 6e5f 6d65 7368  xy_xsection_mesh
+00015310: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00015320: 7475 726e 2078 795f 7873 6563 7469 6f6e  turn xy_xsection
+00015330: 5f6d 6573 6828 7061 6464 6564 5f63 6f6d  _mesh(padded_com
+00015340: 706f 6e65 6e74 2c20 7a2c 206c 6179 6572  ponent, z, layer
+00015350: 5f73 7461 636b 2c20 2a2a 6b77 6172 6773  _stack, **kwargs
+00015360: 290a 2020 2020 2020 2020 656c 6966 2074  ).        elif t
+00015370: 7970 6520 3d3d 2022 757a 223a 0a20 2020  ype == "uz":.   
+00015380: 2020 2020 2020 2020 2069 6620 7873 6563           if xsec
+00015390: 7469 6f6e 5f62 6f75 6e64 7320 6973 204e  tion_bounds is N
+000153a0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000153b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000153c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000153d0: 2020 2020 2020 2020 2020 2022 466f 7220             "For 
+000153e0: 757a 2d6d 6573 6869 6e67 2c20 796f 7520  uz-meshing, you 
+000153f0: 6d75 7374 2070 726f 7669 6465 2061 206c  must provide a l
+00015400: 696e 6520 696e 2074 6865 2078 792d 706c  ine in the xy-pl
+00015410: 616e 6520 220a 2020 2020 2020 2020 2020  ane ".          
+00015420: 2020 2020 2020 2020 2020 2276 6961 2074            "via t
+00015430: 6865 2054 7570 6c65 2061 7267 756d 656e  he Tuple argumen
+00015440: 7420 5b5b 7831 2c79 315d 2c20 5b78 322c  t [[x1,y1], [x2,
+00015450: 7932 5d5d 2078 7365 6374 696f 6e5f 626f  y2]] xsection_bo
+00015460: 756e 6473 2e22 0a20 2020 2020 2020 2020  unds.".         
+00015470: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00015480: 2020 2020 2066 726f 6d20 6764 7366 6163       from gdsfac
+00015490: 746f 7279 2e73 696d 756c 6174 696f 6e2e  tory.simulation.
+000154a0: 676d 7368 2e75 7a5f 7873 6563 7469 6f6e  gmsh.uz_xsection
+000154b0: 5f6d 6573 6820 696d 706f 7274 2075 7a5f  _mesh import uz_
+000154c0: 7873 6563 7469 6f6e 5f6d 6573 680a 0a20  xsection_mesh.. 
+000154d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000154e0: 6e20 757a 5f78 7365 6374 696f 6e5f 6d65  n uz_xsection_me
+000154f0: 7368 280a 2020 2020 2020 2020 2020 2020  sh(.            
+00015500: 2020 2020 7061 6464 6564 5f63 6f6d 706f      padded_compo
+00015510: 6e65 6e74 2c20 7873 6563 7469 6f6e 5f62  nent, xsection_b
+00015520: 6f75 6e64 732c 206c 6179 6572 5f73 7461  ounds, layer_sta
+00015530: 636b 2c20 2a2a 6b77 6172 6773 0a20 2020  ck, **kwargs.   
+00015540: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015550: 2020 2065 6c69 6620 7479 7065 203d 3d20     elif type == 
+00015560: 2233 4422 3a0a 2020 2020 2020 2020 2020  "3D":.          
+00015570: 2020 6672 6f6d 2067 6473 6661 6374 6f72    from gdsfactor
+00015580: 792e 7369 6d75 6c61 7469 6f6e 2e67 6d73  y.simulation.gms
+00015590: 682e 7879 7a5f 6d65 7368 2069 6d70 6f72  h.xyz_mesh impor
+000155a0: 7420 7879 7a5f 6d65 7368 0a0a 2020 2020  t xyz_mesh..    
+000155b0: 2020 2020 2020 2020 7265 7475 726e 2078          return x
+000155c0: 797a 5f6d 6573 6828 7061 6464 6564 5f63  yz_mesh(padded_c
+000155d0: 6f6d 706f 6e65 6e74 2c20 6c61 7965 725f  omponent, layer_
+000155e0: 7374 6163 6b2c 202a 2a6b 7761 7267 7329  stack, **kwargs)
+000155f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00015600: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00015610: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00015620: 2020 2020 2020 2020 2020 2020 2027 5265               'Re
+00015630: 7175 6972 6564 2061 7267 756d 656e 7420  quired argument 
+00015640: 2274 7970 6522 206d 7573 7420 6265 206f  "type" must be o
+00015650: 6e65 206f 6620 2278 7922 2c20 2275 7a22  ne of "xy", "uz"
+00015660: 2c20 6f72 2022 3344 222e 270a 2020 2020  , or "3D".'.    
+00015670: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00015680: 6566 206f 6666 7365 7428 0a20 2020 2020  ef offset(.     
+00015690: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000156a0: 2064 6973 7461 6e63 653a 2066 6c6f 6174   distance: float
+000156b0: 203d 2030 2e31 2c0a 2020 2020 2020 2020   = 0.1,.        
+000156c0: 706f 6c79 676f 6e73 3d4e 6f6e 652c 0a20  polygons=None,. 
+000156d0: 2020 2020 2020 2075 7365 5f75 6e69 6f6e         use_union
+000156e0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
 000156f0: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-00015700: 3a20 4465 7369 7265 6420 7072 6563 6973  : Desired precis
-00015710: 696f 6e20 666f 7220 726f 756e 6469 6e67  ion for rounding
-00015720: 2076 6572 7465 7820 636f 6f72 6469 6e61   vertex coordina
-00015730: 7465 732e 0a20 2020 2020 2020 2020 2020  tes..           
-00015740: 206a 6f69 6e3a 207b 276d 6974 6572 272c   join: {'miter',
-00015750: 2027 6265 7665 6c27 2c20 2772 6f75 6e64   'bevel', 'round
-00015760: 277d 2054 7970 6520 6f66 206a 6f69 6e20  '} Type of join 
-00015770: 7573 6564 2074 6f20 6372 6561 7465 2070  used to create p
-00015780: 6f6c 7967 6f6e 206f 6666 7365 740a 2020  olygon offset.  
-00015790: 2020 2020 2020 2020 2020 746f 6c65 7261            tolera
-000157a0: 6e63 653a 2046 6f72 206d 6974 6572 206a  nce: For miter j
-000157b0: 6f69 6e74 732c 2074 6869 7320 6e75 6d62  oints, this numb
-000157c0: 6572 206d 7573 7420 6265 2061 7420 6c65  er must be at le
-000157d0: 6173 7420 3220 7265 7072 6573 656e 7473  ast 2 represents
-000157e0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-000157f0: 2020 206d 6178 696d 616c 2064 6973 7461     maximal dista
-00015800: 6e63 6520 696e 206d 756c 7469 706c 6573  nce in multiples
-00015810: 206f 6620 6f66 6673 6574 2062 6574 7765   of offset betwe
-00015820: 656e 206e 6577 2076 6572 7469 6365 7320  en new vertices 
-00015830: 616e 6420 7468 6569 720a 2020 2020 2020  and their.      
-00015840: 2020 2020 2020 2020 6f72 6967 696e 616c          original
-00015850: 2070 6f73 6974 696f 6e20 6265 666f 7265   position before
-00015860: 2062 6576 656c 696e 6720 746f 2061 766f   beveling to avo
-00015870: 6964 2073 7069 6b65 7320 6174 2061 6375  id spikes at acu
-00015880: 7465 206a 6f69 6e74 732e 2046 6f72 0a20  te joints. For. 
-00015890: 2020 2020 2020 2020 2020 2020 2072 6f75               rou
-000158a0: 6e64 206a 6f69 6e74 732c 2069 7420 696e  nd joints, it in
-000158b0: 6469 6361 7465 7320 7468 6520 6375 7276  dicates the curv
-000158c0: 6174 7572 6520 7265 736f 6c75 7469 6f6e  ature resolution
-000158d0: 2069 6e20 6e75 6d62 6572 206f 660a 2020   in number of.  
-000158e0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-000158f0: 7473 2070 6572 2066 756c 6c20 6369 7263  ts per full circ
-00015900: 6c65 2e0a 2020 2020 2020 2020 2020 2020  le..            
-00015910: 6c61 7965 723a 2053 7065 6369 6669 6320  layer: Specific 
-00015920: 6c61 7965 7220 666f 7220 6e65 7720 706f  layer for new po
-00015930: 6c79 676f 6e73 2e0a 0a20 2020 2020 2020  lygons...       
-00015940: 2022 2222 0a20 2020 2020 2020 2069 6d70   """.        imp
-00015950: 6f72 7420 6764 7366 6163 746f 7279 2061  ort gdsfactory a
-00015960: 7320 6766 0a0a 2020 2020 2020 2020 6764  s gf..        gd
-00015970: 735f 6c61 7965 722c 2067 6473 5f64 6174  s_layer, gds_dat
-00015980: 6174 7970 6520 3d20 6766 2e67 6574 5f6c  atype = gf.get_l
-00015990: 6179 6572 286c 6179 6572 290a 2020 2020  ayer(layer).    
-000159a0: 2020 2020 7020 3d20 6764 7374 6b2e 6f66      p = gdstk.of
-000159b0: 6673 6574 280a 2020 2020 2020 2020 2020  fset(.          
-000159c0: 2020 706f 6c79 676f 6e73 206f 7220 7365    polygons or se
-000159d0: 6c66 2e67 6574 5f70 6f6c 7967 6f6e 7328  lf.get_polygons(
-000159e0: 292c 0a20 2020 2020 2020 2020 2020 2064  ),.            d
-000159f0: 6973 7461 6e63 653d 6469 7374 616e 6365  istance=distance
-00015a00: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
-00015a10: 696e 3d6a 6f69 6e2c 0a20 2020 2020 2020  in=join,.       
-00015a20: 2020 2020 2074 6f6c 6572 616e 6365 3d74       tolerance=t
-00015a30: 6f6c 6572 616e 6365 2c0a 2020 2020 2020  olerance,.      
-00015a40: 2020 2020 2020 7072 6563 6973 696f 6e3d        precision=
-00015a50: 7072 6563 6973 696f 6e2c 0a20 2020 2020  precision,.     
-00015a60: 2020 2020 2020 2075 7365 5f75 6e69 6f6e         use_union
-00015a70: 3d75 7365 5f75 6e69 6f6e 2c0a 2020 2020  =use_union,.    
-00015a80: 2020 2020 2020 2020 6c61 7965 723d 6764          layer=gd
-00015a90: 735f 6c61 7965 722c 0a20 2020 2020 2020  s_layer,.       
-00015aa0: 2020 2020 2064 6174 6174 7970 653d 6764       datatype=gd
-00015ab0: 735f 6461 7461 7479 7065 2c0a 2020 2020  s_datatype,.    
-00015ac0: 2020 2020 290a 0a20 2020 2020 2020 2063      )..        c
-00015ad0: 6f6d 706f 6e65 6e74 203d 2067 662e 436f  omponent = gf.Co
-00015ae0: 6d70 6f6e 656e 7428 290a 2020 2020 2020  mponent().      
-00015af0: 2020 636f 6d70 6f6e 656e 742e 6164 645f    component.add_
-00015b00: 706f 6c79 676f 6e28 702c 206c 6179 6572  polygon(p, layer
-00015b10: 3d6c 6179 6572 290a 2020 2020 2020 2020  =layer).        
-00015b20: 7265 7475 726e 2063 6f6d 706f 6e65 6e74  return component
-00015b30: 0a0a 0a64 6566 2063 6f70 7928 0a20 2020  ...def copy(.   
-00015b40: 2044 3a20 436f 6d70 6f6e 656e 742c 0a20   D: Component,. 
-00015b50: 2020 2072 6566 6572 656e 6365 733d 4e6f     references=No
-00015b60: 6e65 2c0a 2020 2020 706f 7274 733d 4e6f  ne,.    ports=No
-00015b70: 6e65 2c0a 2020 2020 706f 6c79 676f 6e73  ne,.    polygons
-00015b80: 3d4e 6f6e 652c 0a20 2020 2070 6174 6873  =None,.    paths
-00015b90: 3d4e 6f6e 652c 0a20 2020 206e 616d 653d  =None,.    name=
-00015ba0: 4e6f 6e65 2c0a 2020 2020 6c61 6265 6c73  None,.    labels
-00015bb0: 3d4e 6f6e 652c 0a29 202d 3e20 436f 6d70  =None,.) -> Comp
-00015bc0: 6f6e 656e 743a 0a20 2020 2022 2222 5265  onent:.    """Re
-00015bd0: 7475 726e 7320 6120 436f 6d70 6f6e 656e  turns a Componen
-00015be0: 7420 636f 7079 2e0a 0a20 2020 2041 7267  t copy...    Arg
-00015bf0: 733a 0a20 2020 2020 2020 2044 3a20 636f  s:.        D: co
-00015c00: 6d70 6f6e 656e 7420 746f 2063 6f70 792e  mponent to copy.
-00015c10: 0a20 2020 2022 2222 0a20 2020 2044 5f63  .    """.    D_c
-00015c20: 6f70 7920 3d20 436f 6d70 6f6e 656e 7428  opy = Component(
-00015c30: 290a 2020 2020 445f 636f 7079 2e69 6e66  ).    D_copy.inf
-00015c40: 6f20 3d20 442e 696e 666f 0a20 2020 2023  o = D.info.    #
-00015c50: 2044 5f63 6f70 792e 5f63 656c 6c20 3d20   D_copy._cell = 
-00015c60: 442e 5f63 656c 6c2e 636f 7079 286e 616d  D._cell.copy(nam
-00015c70: 653d 445f 636f 7079 2e6e 616d 6529 0a0a  e=D_copy.name)..
-00015c80: 2020 2020 666f 7220 7265 6620 696e 2072      for ref in r
-00015c90: 6566 6572 656e 6365 7320 6966 2072 6566  eferences if ref
-00015ca0: 6572 656e 6365 7320 6973 206e 6f74 204e  erences is not N
-00015cb0: 6f6e 6520 656c 7365 2044 2e72 6566 6572  one else D.refer
-00015cc0: 656e 6365 733a 0a20 2020 2020 2020 2044  ences:.        D
-00015cd0: 5f63 6f70 792e 6164 6428 636f 7079 5f72  _copy.add(copy_r
-00015ce0: 6566 6572 656e 6365 2872 6566 2929 0a20  eference(ref)). 
-00015cf0: 2020 2066 6f72 2070 6f72 7420 696e 2028     for port in (
-00015d00: 706f 7274 7320 6966 2070 6f72 7473 2069  ports if ports i
-00015d10: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00015d20: 442e 706f 7274 7329 2e76 616c 7565 7328  D.ports).values(
-00015d30: 293a 0a20 2020 2020 2020 2044 5f63 6f70  ):.        D_cop
-00015d40: 792e 6164 645f 706f 7274 2870 6f72 743d  y.add_port(port=
-00015d50: 706f 7274 290a 2020 2020 666f 7220 706f  port).    for po
-00015d60: 6c79 2069 6e20 706f 6c79 676f 6e73 2069  ly in polygons i
-00015d70: 6620 706f 6c79 676f 6e73 2069 7320 6e6f  f polygons is no
-00015d80: 7420 4e6f 6e65 2065 6c73 6520 442e 706f  t None else D.po
-00015d90: 6c79 676f 6e73 3a0a 2020 2020 2020 2020  lygons:.        
-00015da0: 445f 636f 7079 2e61 6464 5f70 6f6c 7967  D_copy.add_polyg
-00015db0: 6f6e 2870 6f6c 7929 0a20 2020 2066 6f72  on(poly).    for
-00015dc0: 2070 6174 6820 696e 2070 6174 6873 2069   path in paths i
-00015dd0: 6620 7061 7468 7320 6973 206e 6f74 204e  f paths is not N
-00015de0: 6f6e 6520 656c 7365 2044 2e70 6174 6873  one else D.paths
-00015df0: 3a0a 2020 2020 2020 2020 445f 636f 7079  :.        D_copy
-00015e00: 2e61 6464 2870 6174 6829 0a20 2020 2066  .add(path).    f
-00015e10: 6f72 206c 6162 656c 2069 6e20 6c61 6265  or label in labe
-00015e20: 6c73 2069 6620 6c61 6265 6c73 2069 7320  ls if labels is 
-00015e30: 6e6f 7420 4e6f 6e65 2065 6c73 6520 442e  not None else D.
-00015e40: 6c61 6265 6c73 3a0a 2020 2020 2020 2020  labels:.        
-00015e50: 445f 636f 7079 2e61 6464 5f6c 6162 656c  D_copy.add_label
-00015e60: 280a 2020 2020 2020 2020 2020 2020 7465  (.            te
-00015e70: 7874 3d6c 6162 656c 2e74 6578 742c 0a20  xt=label.text,. 
-00015e80: 2020 2020 2020 2020 2020 2070 6f73 6974             posit
-00015e90: 696f 6e3d 6c61 6265 6c2e 6f72 6967 696e  ion=label.origin
-00015ea0: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
-00015eb0: 7965 723d 286c 6162 656c 2e6c 6179 6572  yer=(label.layer
-00015ec0: 2c20 6c61 6265 6c2e 7465 7874 7479 7065  , label.texttype
-00015ed0: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
-00015ee0: 2020 6966 206e 616d 6520 6973 206e 6f74    if name is not
-00015ef0: 204e 6f6e 653a 0a20 2020 2020 2020 2044   None:.        D
-00015f00: 5f63 6f70 792e 6e61 6d65 203d 206e 616d  _copy.name = nam
-00015f10: 650a 0a20 2020 2072 6574 7572 6e20 445f  e..    return D_
-00015f20: 636f 7079 0a0a 0a64 6566 2063 6f70 795f  copy...def copy_
-00015f30: 7265 6665 7265 6e63 6528 0a20 2020 2072  reference(.    r
-00015f40: 6566 2c0a 2020 2020 7061 7265 6e74 3d4e  ef,.    parent=N
-00015f50: 6f6e 652c 0a20 2020 2063 6f6c 756d 6e73  one,.    columns
-00015f60: 3d4e 6f6e 652c 0a20 2020 2072 6f77 733d  =None,.    rows=
-00015f70: 4e6f 6e65 2c0a 2020 2020 7370 6163 696e  None,.    spacin
-00015f80: 673d 4e6f 6e65 2c0a 2020 2020 6f72 6967  g=None,.    orig
-00015f90: 696e 3d4e 6f6e 652c 0a20 2020 2072 6f74  in=None,.    rot
-00015fa0: 6174 696f 6e3d 4e6f 6e65 2c0a 2020 2020  ation=None,.    
-00015fb0: 6d61 676e 6966 6963 6174 696f 6e3d 4e6f  magnification=No
-00015fc0: 6e65 2c0a 2020 2020 785f 7265 666c 6563  ne,.    x_reflec
-00015fd0: 7469 6f6e 3d4e 6f6e 652c 0a20 2020 206e  tion=None,.    n
-00015fe0: 616d 653d 4e6f 6e65 2c0a 2020 2020 7631  ame=None,.    v1
-00015ff0: 3d4e 6f6e 652c 0a20 2020 2076 323d 4e6f  =None,.    v2=No
-00016000: 6e65 2c0a 2920 2d3e 2043 6f6d 706f 6e65  ne,.) -> Compone
-00016010: 6e74 5265 6665 7265 6e63 653a 0a20 2020  ntReference:.   
-00016020: 2072 6574 7572 6e20 436f 6d70 6f6e 656e   return Componen
-00016030: 7452 6566 6572 656e 6365 280a 2020 2020  tReference(.    
-00016040: 2020 2020 636f 6d70 6f6e 656e 743d 7061      component=pa
-00016050: 7265 6e74 206f 7220 7265 662e 7061 7265  rent or ref.pare
-00016060: 6e74 2c0a 2020 2020 2020 2020 636f 6c75  nt,.        colu
-00016070: 6d6e 733d 636f 6c75 6d6e 7320 6f72 2072  mns=columns or r
-00016080: 6566 2e63 6f6c 756d 6e73 2c0a 2020 2020  ef.columns,.    
-00016090: 2020 2020 726f 7773 3d72 6f77 7320 6f72      rows=rows or
-000160a0: 2072 6566 2e72 6f77 732c 0a20 2020 2020   ref.rows,.     
-000160b0: 2020 2073 7061 6369 6e67 3d73 7061 6369     spacing=spaci
-000160c0: 6e67 206f 7220 7265 662e 7370 6163 696e  ng or ref.spacin
-000160d0: 672c 0a20 2020 2020 2020 206f 7269 6769  g,.        origi
-000160e0: 6e3d 6f72 6967 696e 206f 7220 7265 662e  n=origin or ref.
-000160f0: 6f72 6967 696e 2c0a 2020 2020 2020 2020  origin,.        
-00016100: 726f 7461 7469 6f6e 3d72 6f74 6174 696f  rotation=rotatio
-00016110: 6e20 6f72 2072 6566 2e72 6f74 6174 696f  n or ref.rotatio
-00016120: 6e2c 0a20 2020 2020 2020 206d 6167 6e69  n,.        magni
-00016130: 6669 6361 7469 6f6e 3d6d 6167 6e69 6669  fication=magnifi
-00016140: 6361 7469 6f6e 206f 7220 7265 662e 6d61  cation or ref.ma
-00016150: 676e 6966 6963 6174 696f 6e2c 0a20 2020  gnification,.   
-00016160: 2020 2020 2078 5f72 6566 6c65 6374 696f       x_reflectio
-00016170: 6e3d 785f 7265 666c 6563 7469 6f6e 206f  n=x_reflection o
-00016180: 7220 7265 662e 785f 7265 666c 6563 7469  r ref.x_reflecti
-00016190: 6f6e 2c0a 2020 2020 2020 2020 6e61 6d65  on,.        name
-000161a0: 3d6e 616d 6520 6f72 2072 6566 2e6e 616d  =name or ref.nam
-000161b0: 652c 0a20 2020 2020 2020 2076 313d 7631  e,.        v1=v1
-000161c0: 206f 7220 7265 662e 7631 2c0a 2020 2020   or ref.v1,.    
-000161d0: 2020 2020 7632 3d76 3220 6f72 2072 6566      v2=v2 or ref
-000161e0: 2e76 322c 0a20 2020 2029 0a0a 0a64 6566  .v2,.    )...def
-000161f0: 2074 6573 745f 6765 745f 6c61 7965 7273   test_get_layers
-00016200: 2829 202d 3e20 436f 6d70 6f6e 656e 743a  () -> Component:
-00016210: 0a20 2020 2069 6d70 6f72 7420 6764 7366  .    import gdsf
-00016220: 6163 746f 7279 2061 7320 6766 0a0a 2020  actory as gf..  
-00016230: 2020 6331 203d 2067 662e 636f 6d70 6f6e    c1 = gf.compon
-00016240: 656e 7473 2e73 7472 6169 6768 7428 0a20  ents.straight(. 
-00016250: 2020 2020 2020 206c 656e 6774 683d 3130         length=10
-00016260: 2c0a 2020 2020 2020 2020 7769 6474 683d  ,.        width=
-00016270: 302e 352c 0a20 2020 2020 2020 206c 6179  0.5,.        lay
-00016280: 6572 3d28 322c 2030 292c 0a20 2020 2020  er=(2, 0),.     
-00016290: 2020 2062 626f 785f 6c61 7965 7273 3d5b     bbox_layers=[
-000162a0: 2831 3131 2c20 3029 5d2c 0a20 2020 2020  (111, 0)],.     
-000162b0: 2020 2062 626f 785f 6f66 6673 6574 733d     bbox_offsets=
-000162c0: 5b33 5d2c 0a20 2020 2020 2020 2077 6974  [3],.        wit
-000162d0: 685f 6262 6f78 3d54 7275 652c 0a20 2020  h_bbox=True,.   
-000162e0: 2020 2020 2063 6c61 6464 696e 675f 6c61       cladding_la
-000162f0: 7965 7273 3d4e 6f6e 652c 0a20 2020 2020  yers=None,.     
-00016300: 2020 2061 6464 5f70 696e 733d 4e6f 6e65     add_pins=None
-00016310: 2c0a 2020 2020 2020 2020 6164 645f 6262  ,.        add_bb
-00016320: 6f78 3d4e 6f6e 652c 0a20 2020 2029 0a20  ox=None,.    ). 
-00016330: 2020 2061 7373 6572 7420 6331 2e67 6574     assert c1.get
-00016340: 5f6c 6179 6572 7328 2920 3d3d 207b 2832  _layers() == {(2
-00016350: 2c20 3029 2c20 2831 3131 2c20 3029 7d2c  , 0), (111, 0)},
-00016360: 2063 312e 6765 745f 6c61 7965 7273 2829   c1.get_layers()
-00016370: 0a20 2020 2023 2072 6574 7572 6e20 6331  .    # return c1
-00016380: 0a20 2020 2063 3220 3d20 6331 2e72 656d  .    c2 = c1.rem
-00016390: 6f76 655f 6c61 7965 7273 285b 2831 3131  ove_layers([(111
-000163a0: 2c20 3029 5d29 0a20 2020 2061 7373 6572  , 0)]).    asser
-000163b0: 7420 6332 2e67 6574 5f6c 6179 6572 7328  t c2.get_layers(
-000163c0: 2920 3d3d 207b 2832 2c20 3029 7d2c 2063  ) == {(2, 0)}, c
-000163d0: 322e 6765 745f 6c61 7965 7273 2829 0a20  2.get_layers(). 
-000163e0: 2020 2072 6574 7572 6e20 6332 0a0a 0a64     return c2...d
-000163f0: 6566 205f 6669 6c74 6572 5f70 6f6c 7973  ef _filter_polys
-00016400: 2870 6f6c 7967 6f6e 732c 206c 6179 6572  (polygons, layer
-00016410: 735f 6578 636c 293a 0a20 2020 2072 6574  s_excl):.    ret
-00016420: 7572 6e20 5b0a 2020 2020 2020 2020 706f  urn [.        po
-00016430: 6c79 676f 6e0a 2020 2020 2020 2020 666f  lygon.        fo
-00016440: 7220 706f 6c79 676f 6e2c 206c 6179 6572  r polygon, layer
-00016450: 2c20 6461 7461 7479 7065 2069 6e20 7a69  , datatype in zi
-00016460: 7028 0a20 2020 2020 2020 2020 2020 2070  p(.            p
-00016470: 6f6c 7967 6f6e 732e 706f 6c79 676f 6e73  olygons.polygons
-00016480: 2c20 706f 6c79 676f 6e73 2e6c 6179 6572  , polygons.layer
-00016490: 732c 2070 6f6c 7967 6f6e 732e 6461 7461  s, polygons.data
-000164a0: 7479 7065 730a 2020 2020 2020 2020 290a  types.        ).
-000164b0: 2020 2020 2020 2020 6966 2028 6c61 7965          if (laye
-000164c0: 722c 2064 6174 6174 7970 6529 206e 6f74  r, datatype) not
-000164d0: 2069 6e20 6c61 7965 7273 5f65 7863 6c0a   in layers_excl.
-000164e0: 2020 2020 5d0a 0a0a 6465 6620 7265 6375      ]...def recu
-000164f0: 7273 655f 7374 7275 6374 7572 6573 280a  rse_structures(.
-00016500: 2020 2020 636f 6d70 6f6e 656e 743a 2043      component: C
-00016510: 6f6d 706f 6e65 6e74 2c0a 2020 2020 6967  omponent,.    ig
-00016520: 6e6f 7265 5f63 6f6d 706f 6e65 6e74 735f  nore_components_
-00016530: 7072 6566 6978 3a20 4f70 7469 6f6e 616c  prefix: Optional
-00016540: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-00016550: 6e65 2c0a 2020 2020 6967 6e6f 7265 5f66  ne,.    ignore_f
-00016560: 756e 6374 696f 6e73 5f70 7265 6669 783a  unctions_prefix:
-00016570: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-00016580: 7472 5d5d 203d 204e 6f6e 652c 0a29 202d  tr]] = None,.) -
-00016590: 3e20 4469 6374 5b73 7472 2c20 416e 795d  > Dict[str, Any]
-000165a0: 3a0a 2020 2020 2222 2252 6563 7572 7365  :.    """Recurse
-000165b0: 2063 6f6d 706f 6e65 6e74 2061 6e64 2063   component and c
-000165c0: 6f6d 706f 6e65 6e74 7320 7265 6665 7265  omponents refere
-000165d0: 6e63 6573 2072 6563 7572 7369 7665 6c79  nces recursively
-000165e0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-000165f0: 2020 2020 2063 6f6d 706f 6e65 6e74 3a20       component: 
-00016600: 636f 6d70 6f6e 656e 7420 746f 2072 6563  component to rec
-00016610: 7572 7365 2e0a 2020 2020 2020 2020 6967  urse..        ig
-00016620: 6e6f 7265 5f63 6f6d 706f 6e65 6e74 735f  nore_components_
-00016630: 7072 6566 6978 3a20 6c69 7374 206f 6620  prefix: list of 
-00016640: 7072 6566 6978 2074 6f20 6967 6e6f 7265  prefix to ignore
-00016650: 2e0a 2020 2020 2020 2020 6967 6e6f 7265  ..        ignore
-00016660: 5f66 756e 6374 696f 6e73 5f70 7265 6669  _functions_prefi
-00016670: 783a 206c 6973 7420 6f66 2070 7265 6669  x: list of prefi
-00016680: 7820 746f 2069 676e 6f72 652e 0a20 2020  x to ignore..   
-00016690: 2022 2222 0a20 2020 2069 676e 6f72 655f   """.    ignore_
-000166a0: 6675 6e63 7469 6f6e 735f 7072 6566 6978  functions_prefix
-000166b0: 203d 2069 676e 6f72 655f 6675 6e63 7469   = ignore_functi
-000166c0: 6f6e 735f 7072 6566 6978 206f 7220 5b5d  ons_prefix or []
-000166d0: 0a20 2020 2069 676e 6f72 655f 636f 6d70  .    ignore_comp
-000166e0: 6f6e 656e 7473 5f70 7265 6669 7820 3d20  onents_prefix = 
-000166f0: 6967 6e6f 7265 5f63 6f6d 706f 6e65 6e74  ignore_component
-00016700: 735f 7072 6566 6978 206f 7220 5b5d 0a0a  s_prefix or []..
-00016710: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-00016720: 2068 6173 6174 7472 2863 6f6d 706f 6e65   hasattr(compone
-00016730: 6e74 2c20 2266 756e 6374 696f 6e5f 6e61  nt, "function_na
-00016740: 6d65 2229 0a20 2020 2020 2020 2061 6e64  me").        and
-00016750: 2063 6f6d 706f 6e65 6e74 2e66 756e 6374   component.funct
-00016760: 696f 6e5f 6e61 6d65 2069 6e20 6967 6e6f  ion_name in igno
-00016770: 7265 5f66 756e 6374 696f 6e73 5f70 7265  re_functions_pre
-00016780: 6669 780a 2020 2020 293a 0a20 2020 2020  fix.    ):.     
-00016790: 2020 2072 6574 7572 6e20 7b7d 0a0a 2020     return {}..  
-000167a0: 2020 6966 2068 6173 6174 7472 2863 6f6d    if hasattr(com
-000167b0: 706f 6e65 6e74 2c20 226e 616d 6522 2920  ponent, "name") 
-000167c0: 616e 6420 616e 7928 0a20 2020 2020 2020  and any(.       
-000167d0: 2063 6f6d 706f 6e65 6e74 2e6e 616d 652e   component.name.
-000167e0: 7374 6172 7473 7769 7468 2869 2920 666f  startswith(i) fo
-000167f0: 7220 6920 696e 2069 676e 6f72 655f 636f  r i in ignore_co
-00016800: 6d70 6f6e 656e 7473 5f70 7265 6669 780a  mponents_prefix.
-00016810: 2020 2020 293a 0a20 2020 2020 2020 2072      ):.        r
-00016820: 6574 7572 6e20 7b7d 0a0a 2020 2020 6f75  eturn {}..    ou
-00016830: 7470 7574 203d 207b 636f 6d70 6f6e 656e  tput = {componen
-00016840: 742e 6e61 6d65 3a20 6469 6374 2863 6f6d  t.name: dict(com
-00016850: 706f 6e65 6e74 2e73 6574 7469 6e67 7329  ponent.settings)
-00016860: 7d0a 2020 2020 666f 7220 7265 6665 7265  }.    for refere
-00016870: 6e63 6520 696e 2063 6f6d 706f 6e65 6e74  nce in component
-00016880: 2e72 6566 6572 656e 6365 733a 0a20 2020  .references:.   
-00016890: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-000168a0: 2020 2020 2020 6973 696e 7374 616e 6365        isinstance
-000168b0: 2872 6566 6572 656e 6365 2c20 436f 6d70  (reference, Comp
-000168c0: 6f6e 656e 7452 6566 6572 656e 6365 290a  onentReference).
-000168d0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-000168e0: 7265 6665 7265 6e63 652e 7265 665f 6365  reference.ref_ce
-000168f0: 6c6c 2e6e 616d 6520 6e6f 7420 696e 206f  ll.name not in o
-00016900: 7574 7075 740a 2020 2020 2020 2020 293a  utput.        ):
-00016910: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00016920: 7075 742e 7570 6461 7465 2872 6563 7572  put.update(recur
-00016930: 7365 5f73 7472 7563 7475 7265 7328 7265  se_structures(re
-00016940: 6665 7265 6e63 652e 7265 665f 6365 6c6c  ference.ref_cell
-00016950: 2929 0a0a 2020 2020 7265 7475 726e 206f  ))..    return o
-00016960: 7574 7075 740a 0a0a 6465 6620 666c 6174  utput...def flat
-00016970: 7465 6e5f 696e 7661 6c69 645f 7265 6673  ten_invalid_refs
-00016980: 5f72 6563 7572 7369 7665 280a 2020 2020  _recursive(.    
-00016990: 636f 6d70 6f6e 656e 743a 2043 6f6d 706f  component: Compo
-000169a0: 6e65 6e74 2c0a 2020 2020 6772 6964 5f73  nent,.    grid_s
-000169b0: 697a 653a 204f 7074 696f 6e61 6c5b 666c  ize: Optional[fl
-000169c0: 6f61 745d 203d 204e 6f6e 652c 0a20 2020  oat] = None,.   
-000169d0: 2075 7064 6174 6564 5f63 6f6d 706f 6e65   updated_compone
-000169e0: 6e74 733d 4e6f 6e65 2c0a 2020 2020 7472  nts=None,.    tr
-000169f0: 6176 6572 7365 645f 636f 6d70 6f6e 656e  aversed_componen
-00016a00: 7473 3d4e 6f6e 652c 0a29 3a0a 2020 2020  ts=None,.):.    
-00016a10: 2222 2252 6563 7572 7369 7665 6c79 2066  """Recursively f
-00016a20: 6c61 7474 656e 7320 636f 6d70 6f6e 656e  lattens componen
-00016a30: 7420 7265 6665 7265 6e63 6573 2077 6869  t references whi
-00016a40: 6368 2068 6176 6520 696e 7661 6c69 6420  ch have invalid 
-00016a50: 7472 616e 7366 6f72 6d61 7469 6f6e 7320  transformations 
-00016a60: 2869 2e65 2e20 6e6f 6e2d 3930 2064 6567  (i.e. non-90 deg
-00016a70: 2072 6f74 6174 696f 6e73 206f 7220 7375   rotations or su
-00016a80: 622d 6772 6964 2074 7261 6e73 6c61 7469  b-grid translati
-00016a90: 6f6e 7329 2061 6e64 2072 6574 7572 6e73  ons) and returns
-00016aa0: 2061 2063 6f70 7920 6966 2061 6e79 2073   a copy if any s
-00016ab0: 7562 6365 6c6c 7320 6861 7665 2062 6565  ubcells have bee
-00016ac0: 6e20 6d6f 6469 6669 6564 2e0a 0a20 2020  n modified...   
-00016ad0: 2057 4152 4e49 4e47 3a20 7468 6973 2066   WARNING: this f
-00016ae0: 756e 6374 696f 6e20 7769 6c6c 2070 726f  unction will pro
-00016af0: 6475 6365 2073 616d 652d 6e61 6d65 2063  duce same-name c
-00016b00: 6f70 6965 7320 6f66 2063 656c 6c73 2e20  opies of cells. 
-00016b10: 4974 2069 7320 7374 7269 6374 6c79 206d  It is strictly m
-00016b20: 6561 6e74 2074 6f20 6265 2075 7365 6420  eant to be used 
-00016b30: 6f6e 2077 7269 7465 206f 6620 7468 6520  on write of the 
-00016b40: 4744 5320 6669 6c65 2061 6e64 0a20 2020  GDS file and.   
-00016b50: 2073 686f 756c 6420 6e6f 7420 6265 206d   should not be m
-00016b60: 6978 6564 2077 6974 6820 6f74 6865 7220  ixed with other 
-00016b70: 6365 6c6c 732c 206f 7220 796f 7520 7769  cells, or you wi
-00016b80: 6c6c 206c 696b 656c 7920 6578 7065 7269  ll likely experi
-00016b90: 656e 6365 2069 7373 7565 7320 7769 7468  ence issues with
-00016ba0: 2064 7570 6c69 6361 7465 2063 656c 6c73   duplicate cells
-00016bb0: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00016bc0: 2020 2020 636f 6d70 6f6e 656e 743a 2074      component: t
-00016bd0: 6865 2063 6f6d 706f 6e65 6e74 2074 6f20  he component to 
-00016be0: 6669 7820 2869 6e20 706c 6163 6529 2e0a  fix (in place)..
-00016bf0: 2020 2020 2020 2020 6772 6964 5f73 697a          grid_siz
-00016c00: 653a 2074 6865 2047 4453 2067 7269 6420  e: the GDS grid 
-00016c10: 7369 7a65 2c20 696e 2075 6d2c 2064 6566  size, in um, def
-00016c20: 6175 6c74 7320 746f 2061 6374 6976 6520  aults to active 
-00016c30: 5044 4b2e 6765 745f 6772 6964 5f73 697a  PDK.get_grid_siz
-00016c40: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00016c50: 616e 7920 7472 616e 736c 6174 696f 6e73  any translations
-00016c60: 2077 6974 6820 6869 6768 6572 2072 6573   with higher res
-00016c70: 6f6c 7574 696f 6e20 7468 616e 2074 6869  olution than thi
-00016c80: 7320 6172 6520 636f 6e73 6964 6572 6564  s are considered
-00016c90: 2069 6e76 616c 6964 2e0a 2020 2020 2020   invalid..      
-00016ca0: 2020 7570 6461 7465 645f 636f 6d70 6f6e    updated_compon
-00016cb0: 656e 7473 3a20 7468 6520 7275 6e6e 696e  ents: the runnin
-00016cc0: 6720 6469 6374 696f 6e61 7279 206f 6620  g dictionary of 
-00016cd0: 636f 6d70 6f6e 656e 7473 2077 6869 6368  components which
-00016ce0: 2068 6176 6520 6265 656e 206d 6f64 6966   have been modif
-00016cf0: 6965 6420 6279 2074 6869 7320 7472 616e  ied by this tran
-00016d00: 7366 6f72 6d61 7469 6f6e 2e20 5368 6f75  sformation. Shou
-00016d10: 6c64 2061 6c77 6179 7320 6265 204e 6f6e  ld always be Non
-00016d20: 652c 2065 7863 6570 7420 666f 7220 7265  e, except for re
-00016d30: 6375 7273 6976 6520 696e 766f 6361 7469  cursive invocati
-00016d40: 6f6e 732e 0a20 2020 2020 2020 2074 7261  ons..        tra
-00016d50: 7665 7273 6564 5f63 6f6d 706f 6e65 6e74  versed_component
-00016d60: 733a 2074 6865 2073 6574 206f 6620 636f  s: the set of co
-00016d70: 6d70 6f6e 656e 7420 6e61 6d65 7320 7768  mponent names wh
-00016d80: 6963 6820 6861 7665 2062 6565 6e20 7472  ich have been tr
-00016d90: 6176 6572 7365 642e 2053 686f 756c 6420  aversed. Should 
-00016da0: 616c 7761 7973 2062 6520 4e6f 6e65 2c20  always be None, 
-00016db0: 6578 6365 7074 2066 6f72 2072 6563 7572  except for recur
-00016dc0: 7369 7665 2069 6e76 6f63 6174 696f 6e73  sive invocations
-00016dd0: 2e0a 2020 2020 2222 220a 2020 2020 6672  ..    """.    fr
-00016de0: 6f6d 2067 6473 6661 6374 6f72 792e 6465  om gdsfactory.de
-00016df0: 636f 7261 746f 7273 2069 6d70 6f72 7420  corators import 
-00016e00: 6973 5f69 6e76 616c 6964 5f72 6566 0a0a  is_invalid_ref..
-00016e10: 2020 2020 696e 7661 6c69 645f 7265 6673      invalid_refs
-00016e20: 203d 205b 5d0a 2020 2020 7265 6673 203d   = [].    refs =
-00016e30: 2063 6f6d 706f 6e65 6e74 2e72 6566 6572   component.refer
-00016e40: 656e 6365 730a 2020 2020 7375 6263 656c  ences.    subcel
-00016e50: 6c5f 6d6f 6469 6669 6564 203d 2046 616c  l_modified = Fal
-00016e60: 7365 0a20 2020 2069 6620 7570 6461 7465  se.    if update
-00016e70: 645f 636f 6d70 6f6e 656e 7473 2069 7320  d_components is 
-00016e80: 4e6f 6e65 3a0a 2020 2020 2020 2020 7570  None:.        up
-00016e90: 6461 7465 645f 636f 6d70 6f6e 656e 7473  dated_components
-00016ea0: 203d 207b 7d0a 2020 2020 6966 2074 7261   = {}.    if tra
-00016eb0: 7665 7273 6564 5f63 6f6d 706f 6e65 6e74  versed_component
-00016ec0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-00016ed0: 2020 2074 7261 7665 7273 6564 5f63 6f6d     traversed_com
-00016ee0: 706f 6e65 6e74 7320 3d20 7365 7428 290a  ponents = set().
-00016ef0: 2020 2020 666f 7220 7265 6620 696e 2072      for ref in r
-00016f00: 6566 733a 0a20 2020 2020 2020 2023 206d  efs:.        # m
-00016f10: 6172 6b20 616e 7920 696e 7661 6c69 6420  ark any invalid 
-00016f20: 7265 6673 2066 6f72 2066 6c61 7474 656e  refs for flatten
-00016f30: 696e 670a 2020 2020 2020 2020 2320 6f74  ing.        # ot
-00016f40: 6865 7277 6973 652c 2063 6865 636b 2069  herwise, check i
-00016f50: 6620 7468 6572 6520 6172 6520 616e 7920  f there are any 
-00016f60: 6d6f 6469 6669 6564 2063 656c 6c73 2062  modified cells b
-00016f70: 656e 6561 7468 2028 7765 206e 6565 6420  eneath (we need 
-00016f80: 6e6f 7420 646f 2074 6869 7320 6966 2074  not do this if t
-00016f90: 6865 2072 6566 2077 696c 6c20 6265 2066  he ref will be f
-00016fa0: 6c61 7474 656e 6564 2061 6e79 7761 7973  lattened anyways
-00016fb0: 290a 2020 2020 2020 2020 6966 2069 735f  ).        if is_
-00016fc0: 696e 7661 6c69 645f 7265 6628 7265 662c  invalid_ref(ref,
-00016fd0: 2067 7269 645f 7369 7a65 293a 0a20 2020   grid_size):.   
-00016fe0: 2020 2020 2020 2020 2069 6e76 616c 6964           invalid
-00016ff0: 5f72 6566 732e 6170 7065 6e64 2872 6566  _refs.append(ref
-00017000: 2e6e 616d 6529 0a20 2020 2020 2020 2065  .name).        e
-00017010: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00017020: 2023 206f 7468 6572 7769 7365 2c20 7265   # otherwise, re
-00017030: 6375 7273 6976 656c 7920 666c 6174 7465  cursively flatte
-00017040: 6e20 7265 6673 2069 6620 7468 6520 7375  n refs if the su
-00017050: 6263 656c 6c20 6861 7320 6e6f 7420 616c  bcell has not al
-00017060: 7265 6164 7920 6265 656e 2074 7261 7665  ready been trave
-00017070: 7273 6564 0a20 2020 2020 2020 2020 2020  rsed.           
-00017080: 2069 6620 7265 662e 7061 7265 6e74 2e6e   if ref.parent.n
-00017090: 616d 6520 6e6f 7420 696e 2074 7261 7665  ame not in trave
-000170a0: 7273 6564 5f63 6f6d 706f 6e65 6e74 733a  rsed_components:
-000170b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000170c0: 2066 6c61 7474 656e 5f69 6e76 616c 6964   flatten_invalid
-000170d0: 5f72 6566 735f 7265 6375 7273 6976 6528  _refs_recursive(
-000170e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000170f0: 2020 2020 2072 6566 2e70 6172 656e 742c       ref.parent,
-00017100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017110: 2020 2020 2067 7269 645f 7369 7a65 3d67       grid_size=g
-00017120: 7269 645f 7369 7a65 2c0a 2020 2020 2020  rid_size,.      
-00017130: 2020 2020 2020 2020 2020 2020 2020 7570                up
-00017140: 6461 7465 645f 636f 6d70 6f6e 656e 7473  dated_components
-00017150: 3d75 7064 6174 6564 5f63 6f6d 706f 6e65  =updated_compone
-00017160: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-00017170: 2020 2020 2020 2020 2074 7261 7665 7273           travers
-00017180: 6564 5f63 6f6d 706f 6e65 6e74 733d 7472  ed_components=tr
-00017190: 6176 6572 7365 645f 636f 6d70 6f6e 656e  aversed_componen
-000171a0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-000171b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000171c0: 2020 2320 6e6f 772c 2069 6620 7468 6520    # now, if the 
-000171d0: 7265 6627 7320 6365 6c6c 2062 6565 6e20  ref's cell been 
-000171e0: 6d6f 6469 6669 6564 2c20 6d61 726b 2069  modified, mark i
-000171f0: 7420 6173 2073 7563 680a 2020 2020 2020  t as such.      
-00017200: 2020 2020 2020 6966 2072 6566 2e70 6172        if ref.par
-00017210: 656e 742e 6e61 6d65 2069 6e20 7570 6461  ent.name in upda
-00017220: 7465 645f 636f 6d70 6f6e 656e 7473 3a0a  ted_components:.
+00015700: 3a20 666c 6f61 7420 3d20 3165 2d34 2c0a  : float = 1e-4,.
+00015710: 2020 2020 2020 2020 6a6f 696e 3a20 7374          join: st
+00015720: 7220 3d20 226d 6974 6572 222c 0a20 2020  r = "miter",.   
+00015730: 2020 2020 2074 6f6c 6572 616e 6365 3a20       tolerance: 
+00015740: 696e 7420 3d20 322c 0a20 2020 2020 2020  int = 2,.       
+00015750: 206c 6179 6572 3a20 4c61 7965 7253 7065   layer: LayerSpe
+00015760: 6320 3d20 2257 4722 2c0a 2020 2020 2920  c = "WG",.    ) 
+00015770: 2d3e 2043 6f6d 706f 6e65 6e74 3a0a 2020  -> Component:.  
+00015780: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
+00015790: 206e 6577 2043 6f6d 706f 6e65 6e74 2077   new Component w
+000157a0: 6974 6820 706f 6c79 676f 6e73 2065 726f  ith polygons ero
+000157b0: 6465 6420 6f72 2064 696c 6174 6564 2062  ded or dilated b
+000157c0: 7920 616e 206f 6666 7365 742e 0a0a 2020  y an offset...  
+000157d0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000157e0: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+000157f0: 3a20 4469 7374 616e 6365 2074 6f20 6f66  : Distance to of
+00015800: 6673 6574 2070 6f6c 7967 6f6e 732e 2050  fset polygons. P
+00015810: 6f73 6974 6976 6520 7661 6c75 6573 2065  ositive values e
+00015820: 7870 616e 642c 206e 6567 6174 6976 6520  xpand, negative 
+00015830: 7368 7269 6e6b 2e0a 2020 2020 2020 2020  shrink..        
+00015840: 2020 2020 7072 6563 6973 696f 6e3a 2044      precision: D
+00015850: 6573 6972 6564 2070 7265 6369 7369 6f6e  esired precision
+00015860: 2066 6f72 2072 6f75 6e64 696e 6720 7665   for rounding ve
+00015870: 7274 6578 2063 6f6f 7264 696e 6174 6573  rtex coordinates
+00015880: 2e0a 2020 2020 2020 2020 2020 2020 6a6f  ..            jo
+00015890: 696e 3a20 7b27 6d69 7465 7227 2c20 2762  in: {'miter', 'b
+000158a0: 6576 656c 272c 2027 726f 756e 6427 7d20  evel', 'round'} 
+000158b0: 5479 7065 206f 6620 6a6f 696e 2075 7365  Type of join use
+000158c0: 6420 746f 2063 7265 6174 6520 706f 6c79  d to create poly
+000158d0: 676f 6e20 6f66 6673 6574 0a20 2020 2020  gon offset.     
+000158e0: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
+000158f0: 3a20 466f 7220 6d69 7465 7220 6a6f 696e  : For miter join
+00015900: 7473 2c20 7468 6973 206e 756d 6265 7220  ts, this number 
+00015910: 6d75 7374 2062 6520 6174 206c 6561 7374  must be at least
+00015920: 2032 2072 6570 7265 7365 6e74 7320 7468   2 represents th
+00015930: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00015940: 6d61 7869 6d61 6c20 6469 7374 616e 6365  maximal distance
+00015950: 2069 6e20 6d75 6c74 6970 6c65 7320 6f66   in multiples of
+00015960: 206f 6666 7365 7420 6265 7477 6565 6e20   offset between 
+00015970: 6e65 7720 7665 7274 6963 6573 2061 6e64  new vertices and
+00015980: 2074 6865 6972 0a20 2020 2020 2020 2020   their.         
+00015990: 2020 2020 206f 7269 6769 6e61 6c20 706f       original po
+000159a0: 7369 7469 6f6e 2062 6566 6f72 6520 6265  sition before be
+000159b0: 7665 6c69 6e67 2074 6f20 6176 6f69 6420  veling to avoid 
+000159c0: 7370 696b 6573 2061 7420 6163 7574 6520  spikes at acute 
+000159d0: 6a6f 696e 7473 2e20 466f 720a 2020 2020  joints. For.    
+000159e0: 2020 2020 2020 2020 2020 726f 756e 6420            round 
+000159f0: 6a6f 696e 7473 2c20 6974 2069 6e64 6963  joints, it indic
+00015a00: 6174 6573 2074 6865 2063 7572 7661 7475  ates the curvatu
+00015a10: 7265 2072 6573 6f6c 7574 696f 6e20 696e  re resolution in
+00015a20: 206e 756d 6265 7220 6f66 0a20 2020 2020   number of.     
+00015a30: 2020 2020 2020 2020 2070 6f69 6e74 7320           points 
+00015a40: 7065 7220 6675 6c6c 2063 6972 636c 652e  per full circle.
+00015a50: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+00015a60: 6572 3a20 5370 6563 6966 6963 206c 6179  er: Specific lay
+00015a70: 6572 2066 6f72 206e 6577 2070 6f6c 7967  er for new polyg
+00015a80: 6f6e 732e 0a0a 2020 2020 2020 2020 2222  ons...        ""
+00015a90: 220a 2020 2020 2020 2020 696d 706f 7274  ".        import
+00015aa0: 2067 6473 6661 6374 6f72 7920 6173 2067   gdsfactory as g
+00015ab0: 660a 0a20 2020 2020 2020 2067 6473 5f6c  f..        gds_l
+00015ac0: 6179 6572 2c20 6764 735f 6461 7461 7479  ayer, gds_dataty
+00015ad0: 7065 203d 2067 662e 6765 745f 6c61 7965  pe = gf.get_laye
+00015ae0: 7228 6c61 7965 7229 0a20 2020 2020 2020  r(layer).       
+00015af0: 2070 203d 2067 6473 746b 2e6f 6666 7365   p = gdstk.offse
+00015b00: 7428 0a20 2020 2020 2020 2020 2020 2070  t(.            p
+00015b10: 6f6c 7967 6f6e 7320 6f72 2073 656c 662e  olygons or self.
+00015b20: 6765 745f 706f 6c79 676f 6e73 2829 2c0a  get_polygons(),.
+00015b30: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00015b40: 616e 6365 3d64 6973 7461 6e63 652c 0a20  ance=distance,. 
+00015b50: 2020 2020 2020 2020 2020 206a 6f69 6e3d             join=
+00015b60: 6a6f 696e 2c0a 2020 2020 2020 2020 2020  join,.          
+00015b70: 2020 746f 6c65 7261 6e63 653d 746f 6c65    tolerance=tole
+00015b80: 7261 6e63 652c 0a20 2020 2020 2020 2020  rance,.         
+00015b90: 2020 2070 7265 6369 7369 6f6e 3d70 7265     precision=pre
+00015ba0: 6369 7369 6f6e 2c0a 2020 2020 2020 2020  cision,.        
+00015bb0: 2020 2020 7573 655f 756e 696f 6e3d 7573      use_union=us
+00015bc0: 655f 756e 696f 6e2c 0a20 2020 2020 2020  e_union,.       
+00015bd0: 2020 2020 206c 6179 6572 3d67 6473 5f6c       layer=gds_l
+00015be0: 6179 6572 2c0a 2020 2020 2020 2020 2020  ayer,.          
+00015bf0: 2020 6461 7461 7479 7065 3d67 6473 5f64    datatype=gds_d
+00015c00: 6174 6174 7970 652c 0a20 2020 2020 2020  atatype,.       
+00015c10: 2029 0a0a 2020 2020 2020 2020 636f 6d70   )..        comp
+00015c20: 6f6e 656e 7420 3d20 6766 2e43 6f6d 706f  onent = gf.Compo
+00015c30: 6e65 6e74 2829 0a20 2020 2020 2020 2063  nent().        c
+00015c40: 6f6d 706f 6e65 6e74 2e61 6464 5f70 6f6c  omponent.add_pol
+00015c50: 7967 6f6e 2870 2c20 6c61 7965 723d 6c61  ygon(p, layer=la
+00015c60: 7965 7229 0a20 2020 2020 2020 2072 6574  yer).        ret
+00015c70: 7572 6e20 636f 6d70 6f6e 656e 740a 0a0a  urn component...
+00015c80: 6465 6620 636f 7079 280a 2020 2020 443a  def copy(.    D:
+00015c90: 2043 6f6d 706f 6e65 6e74 2c0a 2020 2020   Component,.    
+00015ca0: 7265 6665 7265 6e63 6573 3d4e 6f6e 652c  references=None,
+00015cb0: 0a20 2020 2070 6f72 7473 3d4e 6f6e 652c  .    ports=None,
+00015cc0: 0a20 2020 2070 6f6c 7967 6f6e 733d 4e6f  .    polygons=No
+00015cd0: 6e65 2c0a 2020 2020 7061 7468 733d 4e6f  ne,.    paths=No
+00015ce0: 6e65 2c0a 2020 2020 6e61 6d65 3d4e 6f6e  ne,.    name=Non
+00015cf0: 652c 0a20 2020 206c 6162 656c 733d 4e6f  e,.    labels=No
+00015d00: 6e65 2c0a 2920 2d3e 2043 6f6d 706f 6e65  ne,.) -> Compone
+00015d10: 6e74 3a0a 2020 2020 2222 2252 6574 7572  nt:.    """Retur
+00015d20: 6e73 2061 2043 6f6d 706f 6e65 6e74 2063  ns a Component c
+00015d30: 6f70 792e 0a0a 2020 2020 4172 6773 3a0a  opy...    Args:.
+00015d40: 2020 2020 2020 2020 443a 2063 6f6d 706f          D: compo
+00015d50: 6e65 6e74 2074 6f20 636f 7079 2e0a 2020  nent to copy..  
+00015d60: 2020 2222 220a 2020 2020 445f 636f 7079    """.    D_copy
+00015d70: 203d 2043 6f6d 706f 6e65 6e74 2829 0a20   = Component(). 
+00015d80: 2020 2044 5f63 6f70 792e 696e 666f 203d     D_copy.info =
+00015d90: 2044 2e69 6e66 6f0a 2020 2020 2320 445f   D.info.    # D_
+00015da0: 636f 7079 2e5f 6365 6c6c 203d 2044 2e5f  copy._cell = D._
+00015db0: 6365 6c6c 2e63 6f70 7928 6e61 6d65 3d44  cell.copy(name=D
+00015dc0: 5f63 6f70 792e 6e61 6d65 290a 0a20 2020  _copy.name)..   
+00015dd0: 2066 6f72 2072 6566 2069 6e20 7265 6665   for ref in refe
+00015de0: 7265 6e63 6573 2069 6620 7265 6665 7265  rences if refere
+00015df0: 6e63 6573 2069 7320 6e6f 7420 4e6f 6e65  nces is not None
+00015e00: 2065 6c73 6520 442e 7265 6665 7265 6e63   else D.referenc
+00015e10: 6573 3a0a 2020 2020 2020 2020 445f 636f  es:.        D_co
+00015e20: 7079 2e61 6464 2863 6f70 795f 7265 6665  py.add(copy_refe
+00015e30: 7265 6e63 6528 7265 6629 290a 2020 2020  rence(ref)).    
+00015e40: 666f 7220 706f 7274 2069 6e20 2870 6f72  for port in (por
+00015e50: 7473 2069 6620 706f 7274 7320 6973 206e  ts if ports is n
+00015e60: 6f74 204e 6f6e 6520 656c 7365 2044 2e70  ot None else D.p
+00015e70: 6f72 7473 292e 7661 6c75 6573 2829 3a0a  orts).values():.
+00015e80: 2020 2020 2020 2020 445f 636f 7079 2e61          D_copy.a
+00015e90: 6464 5f70 6f72 7428 706f 7274 3d70 6f72  dd_port(port=por
+00015ea0: 7429 0a20 2020 2066 6f72 2070 6f6c 7920  t).    for poly 
+00015eb0: 696e 2070 6f6c 7967 6f6e 7320 6966 2070  in polygons if p
+00015ec0: 6f6c 7967 6f6e 7320 6973 206e 6f74 204e  olygons is not N
+00015ed0: 6f6e 6520 656c 7365 2044 2e70 6f6c 7967  one else D.polyg
+00015ee0: 6f6e 733a 0a20 2020 2020 2020 2044 5f63  ons:.        D_c
+00015ef0: 6f70 792e 6164 645f 706f 6c79 676f 6e28  opy.add_polygon(
+00015f00: 706f 6c79 290a 2020 2020 666f 7220 7061  poly).    for pa
+00015f10: 7468 2069 6e20 7061 7468 7320 6966 2070  th in paths if p
+00015f20: 6174 6873 2069 7320 6e6f 7420 4e6f 6e65  aths is not None
+00015f30: 2065 6c73 6520 442e 7061 7468 733a 0a20   else D.paths:. 
+00015f40: 2020 2020 2020 2044 5f63 6f70 792e 6164         D_copy.ad
+00015f50: 6428 7061 7468 290a 2020 2020 666f 7220  d(path).    for 
+00015f60: 6c61 6265 6c20 696e 206c 6162 656c 7320  label in labels 
+00015f70: 6966 206c 6162 656c 7320 6973 206e 6f74  if labels is not
+00015f80: 204e 6f6e 6520 656c 7365 2044 2e6c 6162   None else D.lab
+00015f90: 656c 733a 0a20 2020 2020 2020 2044 5f63  els:.        D_c
+00015fa0: 6f70 792e 6164 645f 6c61 6265 6c28 0a20  opy.add_label(. 
+00015fb0: 2020 2020 2020 2020 2020 2074 6578 743d             text=
+00015fc0: 6c61 6265 6c2e 7465 7874 2c0a 2020 2020  label.text,.    
+00015fd0: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00015fe0: 3d6c 6162 656c 2e6f 7269 6769 6e2c 0a20  =label.origin,. 
+00015ff0: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00016000: 3d28 6c61 6265 6c2e 6c61 7965 722c 206c  =(label.layer, l
+00016010: 6162 656c 2e74 6578 7474 7970 6529 2c0a  abel.texttype),.
+00016020: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+00016030: 6620 6e61 6d65 2069 7320 6e6f 7420 4e6f  f name is not No
+00016040: 6e65 3a0a 2020 2020 2020 2020 445f 636f  ne:.        D_co
+00016050: 7079 2e6e 616d 6520 3d20 6e61 6d65 0a0a  py.name = name..
+00016060: 2020 2020 7265 7475 726e 2044 5f63 6f70      return D_cop
+00016070: 790a 0a0a 6465 6620 636f 7079 5f72 6566  y...def copy_ref
+00016080: 6572 656e 6365 280a 2020 2020 7265 662c  erence(.    ref,
+00016090: 0a20 2020 2070 6172 656e 743d 4e6f 6e65  .    parent=None
+000160a0: 2c0a 2020 2020 636f 6c75 6d6e 733d 4e6f  ,.    columns=No
+000160b0: 6e65 2c0a 2020 2020 726f 7773 3d4e 6f6e  ne,.    rows=Non
+000160c0: 652c 0a20 2020 2073 7061 6369 6e67 3d4e  e,.    spacing=N
+000160d0: 6f6e 652c 0a20 2020 206f 7269 6769 6e3d  one,.    origin=
+000160e0: 4e6f 6e65 2c0a 2020 2020 726f 7461 7469  None,.    rotati
+000160f0: 6f6e 3d4e 6f6e 652c 0a20 2020 206d 6167  on=None,.    mag
+00016100: 6e69 6669 6361 7469 6f6e 3d4e 6f6e 652c  nification=None,
+00016110: 0a20 2020 2078 5f72 6566 6c65 6374 696f  .    x_reflectio
+00016120: 6e3d 4e6f 6e65 2c0a 2020 2020 6e61 6d65  n=None,.    name
+00016130: 3d4e 6f6e 652c 0a20 2020 2076 313d 4e6f  =None,.    v1=No
+00016140: 6e65 2c0a 2020 2020 7632 3d4e 6f6e 652c  ne,.    v2=None,
+00016150: 0a29 202d 3e20 436f 6d70 6f6e 656e 7452  .) -> ComponentR
+00016160: 6566 6572 656e 6365 3a0a 2020 2020 7265  eference:.    re
+00016170: 7475 726e 2043 6f6d 706f 6e65 6e74 5265  turn ComponentRe
+00016180: 6665 7265 6e63 6528 0a20 2020 2020 2020  ference(.       
+00016190: 2063 6f6d 706f 6e65 6e74 3d70 6172 656e   component=paren
+000161a0: 7420 6f72 2072 6566 2e70 6172 656e 742c  t or ref.parent,
+000161b0: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
+000161c0: 3d63 6f6c 756d 6e73 206f 7220 7265 662e  =columns or ref.
+000161d0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
+000161e0: 2072 6f77 733d 726f 7773 206f 7220 7265   rows=rows or re
+000161f0: 662e 726f 7773 2c0a 2020 2020 2020 2020  f.rows,.        
+00016200: 7370 6163 696e 673d 7370 6163 696e 6720  spacing=spacing 
+00016210: 6f72 2072 6566 2e73 7061 6369 6e67 2c0a  or ref.spacing,.
+00016220: 2020 2020 2020 2020 6f72 6967 696e 3d6f          origin=o
+00016230: 7269 6769 6e20 6f72 2072 6566 2e6f 7269  rigin or ref.ori
+00016240: 6769 6e2c 0a20 2020 2020 2020 2072 6f74  gin,.        rot
+00016250: 6174 696f 6e3d 726f 7461 7469 6f6e 206f  ation=rotation o
+00016260: 7220 7265 662e 726f 7461 7469 6f6e 2c0a  r ref.rotation,.
+00016270: 2020 2020 2020 2020 6d61 676e 6966 6963          magnific
+00016280: 6174 696f 6e3d 6d61 676e 6966 6963 6174  ation=magnificat
+00016290: 696f 6e20 6f72 2072 6566 2e6d 6167 6e69  ion or ref.magni
+000162a0: 6669 6361 7469 6f6e 2c0a 2020 2020 2020  fication,.      
+000162b0: 2020 785f 7265 666c 6563 7469 6f6e 3d78    x_reflection=x
+000162c0: 5f72 6566 6c65 6374 696f 6e20 6f72 2072  _reflection or r
+000162d0: 6566 2e78 5f72 6566 6c65 6374 696f 6e2c  ef.x_reflection,
+000162e0: 0a20 2020 2020 2020 206e 616d 653d 6e61  .        name=na
+000162f0: 6d65 206f 7220 7265 662e 6e61 6d65 2c0a  me or ref.name,.
+00016300: 2020 2020 2020 2020 7631 3d76 3120 6f72          v1=v1 or
+00016310: 2072 6566 2e76 312c 0a20 2020 2020 2020   ref.v1,.       
+00016320: 2076 323d 7632 206f 7220 7265 662e 7632   v2=v2 or ref.v2
+00016330: 2c0a 2020 2020 290a 0a0a 6465 6620 7465  ,.    )...def te
+00016340: 7374 5f67 6574 5f6c 6179 6572 7328 2920  st_get_layers() 
+00016350: 2d3e 2043 6f6d 706f 6e65 6e74 3a0a 2020  -> Component:.  
+00016360: 2020 696d 706f 7274 2067 6473 6661 6374    import gdsfact
+00016370: 6f72 7920 6173 2067 660a 0a20 2020 2063  ory as gf..    c
+00016380: 3120 3d20 6766 2e63 6f6d 706f 6e65 6e74  1 = gf.component
+00016390: 732e 7374 7261 6967 6874 280a 2020 2020  s.straight(.    
+000163a0: 2020 2020 6c65 6e67 7468 3d31 302c 0a20      length=10,. 
+000163b0: 2020 2020 2020 2077 6964 7468 3d30 2e35         width=0.5
+000163c0: 2c0a 2020 2020 2020 2020 6c61 7965 723d  ,.        layer=
+000163d0: 2832 2c20 3029 2c0a 2020 2020 2020 2020  (2, 0),.        
+000163e0: 6262 6f78 5f6c 6179 6572 733d 5b28 3131  bbox_layers=[(11
+000163f0: 312c 2030 295d 2c0a 2020 2020 2020 2020  1, 0)],.        
+00016400: 6262 6f78 5f6f 6666 7365 7473 3d5b 335d  bbox_offsets=[3]
+00016410: 2c0a 2020 2020 2020 2020 7769 7468 5f62  ,.        with_b
+00016420: 626f 783d 5472 7565 2c0a 2020 2020 2020  box=True,.      
+00016430: 2020 636c 6164 6469 6e67 5f6c 6179 6572    cladding_layer
+00016440: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00016450: 6164 645f 7069 6e73 3d4e 6f6e 652c 0a20  add_pins=None,. 
+00016460: 2020 2020 2020 2061 6464 5f62 626f 783d         add_bbox=
+00016470: 4e6f 6e65 2c0a 2020 2020 290a 2020 2020  None,.    ).    
+00016480: 6173 7365 7274 2063 312e 6765 745f 6c61  assert c1.get_la
+00016490: 7965 7273 2829 203d 3d20 7b28 322c 2030  yers() == {(2, 0
+000164a0: 292c 2028 3131 312c 2030 297d 2c20 6331  ), (111, 0)}, c1
+000164b0: 2e67 6574 5f6c 6179 6572 7328 290a 2020  .get_layers().  
+000164c0: 2020 2320 7265 7475 726e 2063 310a 2020    # return c1.  
+000164d0: 2020 6332 203d 2063 312e 7265 6d6f 7665    c2 = c1.remove
+000164e0: 5f6c 6179 6572 7328 5b28 3131 312c 2030  _layers([(111, 0
+000164f0: 295d 290a 2020 2020 6173 7365 7274 2063  )]).    assert c
+00016500: 322e 6765 745f 6c61 7965 7273 2829 203d  2.get_layers() =
+00016510: 3d20 7b28 322c 2030 297d 2c20 6332 2e67  = {(2, 0)}, c2.g
+00016520: 6574 5f6c 6179 6572 7328 290a 2020 2020  et_layers().    
+00016530: 7265 7475 726e 2063 320a 0a0a 6465 6620  return c2...def 
+00016540: 5f66 696c 7465 725f 706f 6c79 7328 706f  _filter_polys(po
+00016550: 6c79 676f 6e73 2c20 6c61 7965 7273 5f65  lygons, layers_e
+00016560: 7863 6c29 3a0a 2020 2020 7265 7475 726e  xcl):.    return
+00016570: 205b 0a20 2020 2020 2020 2070 6f6c 7967   [.        polyg
+00016580: 6f6e 0a20 2020 2020 2020 2066 6f72 2070  on.        for p
+00016590: 6f6c 7967 6f6e 2c20 6c61 7965 722c 2064  olygon, layer, d
+000165a0: 6174 6174 7970 6520 696e 207a 6970 280a  atatype in zip(.
+000165b0: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
+000165c0: 676f 6e73 2e70 6f6c 7967 6f6e 732c 2070  gons.polygons, p
+000165d0: 6f6c 7967 6f6e 732e 6c61 7965 7273 2c20  olygons.layers, 
+000165e0: 706f 6c79 676f 6e73 2e64 6174 6174 7970  polygons.datatyp
+000165f0: 6573 0a20 2020 2020 2020 2029 0a20 2020  es.        ).   
+00016600: 2020 2020 2069 6620 286c 6179 6572 2c20       if (layer, 
+00016610: 6461 7461 7479 7065 2920 6e6f 7420 696e  datatype) not in
+00016620: 206c 6179 6572 735f 6578 636c 0a20 2020   layers_excl.   
+00016630: 205d 0a0a 0a64 6566 2072 6563 7572 7365   ]...def recurse
+00016640: 5f73 7472 7563 7475 7265 7328 0a20 2020  _structures(.   
+00016650: 2063 6f6d 706f 6e65 6e74 3a20 436f 6d70   component: Comp
+00016660: 6f6e 656e 742c 0a20 2020 2069 676e 6f72  onent,.    ignor
+00016670: 655f 636f 6d70 6f6e 656e 7473 5f70 7265  e_components_pre
+00016680: 6669 783a 204f 7074 696f 6e61 6c5b 4c69  fix: Optional[Li
+00016690: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
+000166a0: 0a20 2020 2069 676e 6f72 655f 6675 6e63  .    ignore_func
+000166b0: 7469 6f6e 735f 7072 6566 6978 3a20 4f70  tions_prefix: Op
+000166c0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
+000166d0: 5d20 3d20 4e6f 6e65 2c0a 2920 2d3e 2044  ] = None,.) -> D
+000166e0: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
+000166f0: 2020 2022 2222 5265 6375 7273 6520 636f     """Recurse co
+00016700: 6d70 6f6e 656e 7420 616e 6420 636f 6d70  mponent and comp
+00016710: 6f6e 656e 7473 2072 6566 6572 656e 6365  onents reference
+00016720: 7320 7265 6375 7273 6976 656c 792e 0a0a  s recursively...
+00016730: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00016740: 2020 636f 6d70 6f6e 656e 743a 2063 6f6d    component: com
+00016750: 706f 6e65 6e74 2074 6f20 7265 6375 7273  ponent to recurs
+00016760: 652e 0a20 2020 2020 2020 2069 676e 6f72  e..        ignor
+00016770: 655f 636f 6d70 6f6e 656e 7473 5f70 7265  e_components_pre
+00016780: 6669 783a 206c 6973 7420 6f66 2070 7265  fix: list of pre
+00016790: 6669 7820 746f 2069 676e 6f72 652e 0a20  fix to ignore.. 
+000167a0: 2020 2020 2020 2069 676e 6f72 655f 6675         ignore_fu
+000167b0: 6e63 7469 6f6e 735f 7072 6566 6978 3a20  nctions_prefix: 
+000167c0: 6c69 7374 206f 6620 7072 6566 6978 2074  list of prefix t
+000167d0: 6f20 6967 6e6f 7265 2e0a 2020 2020 2222  o ignore..    ""
+000167e0: 220a 2020 2020 6967 6e6f 7265 5f66 756e  ".    ignore_fun
+000167f0: 6374 696f 6e73 5f70 7265 6669 7820 3d20  ctions_prefix = 
+00016800: 6967 6e6f 7265 5f66 756e 6374 696f 6e73  ignore_functions
+00016810: 5f70 7265 6669 7820 6f72 205b 5d0a 2020  _prefix or [].  
+00016820: 2020 6967 6e6f 7265 5f63 6f6d 706f 6e65    ignore_compone
+00016830: 6e74 735f 7072 6566 6978 203d 2069 676e  nts_prefix = ign
+00016840: 6f72 655f 636f 6d70 6f6e 656e 7473 5f70  ore_components_p
+00016850: 7265 6669 7820 6f72 205b 5d0a 0a20 2020  refix or []..   
+00016860: 2069 6620 280a 2020 2020 2020 2020 6861   if (.        ha
+00016870: 7361 7474 7228 636f 6d70 6f6e 656e 742c  sattr(component,
+00016880: 2022 6675 6e63 7469 6f6e 5f6e 616d 6522   "function_name"
+00016890: 290a 2020 2020 2020 2020 616e 6420 636f  ).        and co
+000168a0: 6d70 6f6e 656e 742e 6675 6e63 7469 6f6e  mponent.function
+000168b0: 5f6e 616d 6520 696e 2069 676e 6f72 655f  _name in ignore_
+000168c0: 6675 6e63 7469 6f6e 735f 7072 6566 6978  functions_prefix
+000168d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000168e0: 7265 7475 726e 207b 7d0a 0a20 2020 2069  return {}..    i
+000168f0: 6620 6861 7361 7474 7228 636f 6d70 6f6e  f hasattr(compon
+00016900: 656e 742c 2022 6e61 6d65 2229 2061 6e64  ent, "name") and
+00016910: 2061 6e79 280a 2020 2020 2020 2020 636f   any(.        co
+00016920: 6d70 6f6e 656e 742e 6e61 6d65 2e73 7461  mponent.name.sta
+00016930: 7274 7377 6974 6828 6929 2066 6f72 2069  rtswith(i) for i
+00016940: 2069 6e20 6967 6e6f 7265 5f63 6f6d 706f   in ignore_compo
+00016950: 6e65 6e74 735f 7072 6566 6978 0a20 2020  nents_prefix.   
+00016960: 2029 3a0a 2020 2020 2020 2020 7265 7475   ):.        retu
+00016970: 726e 207b 7d0a 0a20 2020 206f 7574 7075  rn {}..    outpu
+00016980: 7420 3d20 7b63 6f6d 706f 6e65 6e74 2e6e  t = {component.n
+00016990: 616d 653a 2064 6963 7428 636f 6d70 6f6e  ame: dict(compon
+000169a0: 656e 742e 7365 7474 696e 6773 297d 0a20  ent.settings)}. 
+000169b0: 2020 2066 6f72 2072 6566 6572 656e 6365     for reference
+000169c0: 2069 6e20 636f 6d70 6f6e 656e 742e 7265   in component.re
+000169d0: 6665 7265 6e63 6573 3a0a 2020 2020 2020  ferences:.      
+000169e0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+000169f0: 2020 2069 7369 6e73 7461 6e63 6528 7265     isinstance(re
+00016a00: 6665 7265 6e63 652c 2043 6f6d 706f 6e65  ference, Compone
+00016a10: 6e74 5265 6665 7265 6e63 6529 0a20 2020  ntReference).   
+00016a20: 2020 2020 2020 2020 2061 6e64 2072 6566           and ref
+00016a30: 6572 656e 6365 2e72 6566 5f63 656c 6c2e  erence.ref_cell.
+00016a40: 6e61 6d65 206e 6f74 2069 6e20 6f75 7470  name not in outp
+00016a50: 7574 0a20 2020 2020 2020 2029 3a0a 2020  ut.        ):.  
+00016a60: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00016a70: 2e75 7064 6174 6528 7265 6375 7273 655f  .update(recurse_
+00016a80: 7374 7275 6374 7572 6573 2872 6566 6572  structures(refer
+00016a90: 656e 6365 2e72 6566 5f63 656c 6c29 290a  ence.ref_cell)).
+00016aa0: 0a20 2020 2072 6574 7572 6e20 6f75 7470  .    return outp
+00016ab0: 7574 0a0a 0a64 6566 2066 6c61 7474 656e  ut...def flatten
+00016ac0: 5f69 6e76 616c 6964 5f72 6566 735f 7265  _invalid_refs_re
+00016ad0: 6375 7273 6976 6528 0a20 2020 2063 6f6d  cursive(.    com
+00016ae0: 706f 6e65 6e74 3a20 436f 6d70 6f6e 656e  ponent: Componen
+00016af0: 742c 0a20 2020 2067 7269 645f 7369 7a65  t,.    grid_size
+00016b00: 3a20 4f70 7469 6f6e 616c 5b66 6c6f 6174  : Optional[float
+00016b10: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 7570  ] = None,.    up
+00016b20: 6461 7465 645f 636f 6d70 6f6e 656e 7473  dated_components
+00016b30: 3d4e 6f6e 652c 0a20 2020 2074 7261 7665  =None,.    trave
+00016b40: 7273 6564 5f63 6f6d 706f 6e65 6e74 733d  rsed_components=
+00016b50: 4e6f 6e65 2c0a 293a 0a20 2020 2022 2222  None,.):.    """
+00016b60: 5265 6375 7273 6976 656c 7920 666c 6174  Recursively flat
+00016b70: 7465 6e73 2063 6f6d 706f 6e65 6e74 2072  tens component r
+00016b80: 6566 6572 656e 6365 7320 7768 6963 6820  eferences which 
+00016b90: 6861 7665 2069 6e76 616c 6964 2074 7261  have invalid tra
+00016ba0: 6e73 666f 726d 6174 696f 6e73 2028 692e  nsformations (i.
+00016bb0: 652e 206e 6f6e 2d39 3020 6465 6720 726f  e. non-90 deg ro
+00016bc0: 7461 7469 6f6e 7320 6f72 2073 7562 2d67  tations or sub-g
+00016bd0: 7269 6420 7472 616e 736c 6174 696f 6e73  rid translations
+00016be0: 2920 616e 6420 7265 7475 726e 7320 6120  ) and returns a 
+00016bf0: 636f 7079 2069 6620 616e 7920 7375 6263  copy if any subc
+00016c00: 656c 6c73 2068 6176 6520 6265 656e 206d  ells have been m
+00016c10: 6f64 6966 6965 642e 0a0a 2020 2020 5741  odified...    WA
+00016c20: 524e 494e 473a 2074 6869 7320 6675 6e63  RNING: this func
+00016c30: 7469 6f6e 2077 696c 6c20 7072 6f64 7563  tion will produc
+00016c40: 6520 7361 6d65 2d6e 616d 6520 636f 7069  e same-name copi
+00016c50: 6573 206f 6620 6365 6c6c 732e 2049 7420  es of cells. It 
+00016c60: 6973 2073 7472 6963 746c 7920 6d65 616e  is strictly mean
+00016c70: 7420 746f 2062 6520 7573 6564 206f 6e20  t to be used on 
+00016c80: 7772 6974 6520 6f66 2074 6865 2047 4453  write of the GDS
+00016c90: 2066 696c 6520 616e 640a 2020 2020 7368   file and.    sh
+00016ca0: 6f75 6c64 206e 6f74 2062 6520 6d69 7865  ould not be mixe
+00016cb0: 6420 7769 7468 206f 7468 6572 2063 656c  d with other cel
+00016cc0: 6c73 2c20 6f72 2079 6f75 2077 696c 6c20  ls, or you will 
+00016cd0: 6c69 6b65 6c79 2065 7870 6572 6965 6e63  likely experienc
+00016ce0: 6520 6973 7375 6573 2077 6974 6820 6475  e issues with du
+00016cf0: 706c 6963 6174 6520 6365 6c6c 730a 0a20  plicate cells.. 
+00016d00: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00016d10: 2063 6f6d 706f 6e65 6e74 3a20 7468 6520   component: the 
+00016d20: 636f 6d70 6f6e 656e 7420 746f 2066 6978  component to fix
+00016d30: 2028 696e 2070 6c61 6365 292e 0a20 2020   (in place)..   
+00016d40: 2020 2020 2067 7269 645f 7369 7a65 3a20       grid_size: 
+00016d50: 7468 6520 4744 5320 6772 6964 2073 697a  the GDS grid siz
+00016d60: 652c 2069 6e20 756d 2c20 6465 6661 756c  e, in um, defaul
+00016d70: 7473 2074 6f20 6163 7469 7665 2050 444b  ts to active PDK
+00016d80: 2e67 6574 5f67 7269 645f 7369 7a65 2829  .get_grid_size()
+00016d90: 0a20 2020 2020 2020 2020 2020 2061 6e79  .            any
+00016da0: 2074 7261 6e73 6c61 7469 6f6e 7320 7769   translations wi
+00016db0: 7468 2068 6967 6865 7220 7265 736f 6c75  th higher resolu
+00016dc0: 7469 6f6e 2074 6861 6e20 7468 6973 2061  tion than this a
+00016dd0: 7265 2063 6f6e 7369 6465 7265 6420 696e  re considered in
+00016de0: 7661 6c69 642e 0a20 2020 2020 2020 2075  valid..        u
+00016df0: 7064 6174 6564 5f63 6f6d 706f 6e65 6e74  pdated_component
+00016e00: 733a 2074 6865 2072 756e 6e69 6e67 2064  s: the running d
+00016e10: 6963 7469 6f6e 6172 7920 6f66 2063 6f6d  ictionary of com
+00016e20: 706f 6e65 6e74 7320 7768 6963 6820 6861  ponents which ha
+00016e30: 7665 2062 6565 6e20 6d6f 6469 6669 6564  ve been modified
+00016e40: 2062 7920 7468 6973 2074 7261 6e73 666f   by this transfo
+00016e50: 726d 6174 696f 6e2e 2053 686f 756c 6420  rmation. Should 
+00016e60: 616c 7761 7973 2062 6520 4e6f 6e65 2c20  always be None, 
+00016e70: 6578 6365 7074 2066 6f72 2072 6563 7572  except for recur
+00016e80: 7369 7665 2069 6e76 6f63 6174 696f 6e73  sive invocations
+00016e90: 2e0a 2020 2020 2020 2020 7472 6176 6572  ..        traver
+00016ea0: 7365 645f 636f 6d70 6f6e 656e 7473 3a20  sed_components: 
+00016eb0: 7468 6520 7365 7420 6f66 2063 6f6d 706f  the set of compo
+00016ec0: 6e65 6e74 206e 616d 6573 2077 6869 6368  nent names which
+00016ed0: 2068 6176 6520 6265 656e 2074 7261 7665   have been trave
+00016ee0: 7273 6564 2e20 5368 6f75 6c64 2061 6c77  rsed. Should alw
+00016ef0: 6179 7320 6265 204e 6f6e 652c 2065 7863  ays be None, exc
+00016f00: 6570 7420 666f 7220 7265 6375 7273 6976  ept for recursiv
+00016f10: 6520 696e 766f 6361 7469 6f6e 732e 0a20  e invocations.. 
+00016f20: 2020 2022 2222 0a20 2020 2066 726f 6d20     """.    from 
+00016f30: 6764 7366 6163 746f 7279 2e64 6563 6f72  gdsfactory.decor
+00016f40: 6174 6f72 7320 696d 706f 7274 2069 735f  ators import is_
+00016f50: 696e 7661 6c69 645f 7265 660a 0a20 2020  invalid_ref..   
+00016f60: 2069 6e76 616c 6964 5f72 6566 7320 3d20   invalid_refs = 
+00016f70: 5b5d 0a20 2020 2072 6566 7320 3d20 636f  [].    refs = co
+00016f80: 6d70 6f6e 656e 742e 7265 6665 7265 6e63  mponent.referenc
+00016f90: 6573 0a20 2020 2073 7562 6365 6c6c 5f6d  es.    subcell_m
+00016fa0: 6f64 6966 6965 6420 3d20 4661 6c73 650a  odified = False.
+00016fb0: 2020 2020 6966 2075 7064 6174 6564 5f63      if updated_c
+00016fc0: 6f6d 706f 6e65 6e74 7320 6973 204e 6f6e  omponents is Non
+00016fd0: 653a 0a20 2020 2020 2020 2075 7064 6174  e:.        updat
+00016fe0: 6564 5f63 6f6d 706f 6e65 6e74 7320 3d20  ed_components = 
+00016ff0: 7b7d 0a20 2020 2069 6620 7472 6176 6572  {}.    if traver
+00017000: 7365 645f 636f 6d70 6f6e 656e 7473 2069  sed_components i
+00017010: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00017020: 7472 6176 6572 7365 645f 636f 6d70 6f6e  traversed_compon
+00017030: 656e 7473 203d 2073 6574 2829 0a20 2020  ents = set().   
+00017040: 2066 6f72 2072 6566 2069 6e20 7265 6673   for ref in refs
+00017050: 3a0a 2020 2020 2020 2020 2320 6d61 726b  :.        # mark
+00017060: 2061 6e79 2069 6e76 616c 6964 2072 6566   any invalid ref
+00017070: 7320 666f 7220 666c 6174 7465 6e69 6e67  s for flattening
+00017080: 0a20 2020 2020 2020 2023 206f 7468 6572  .        # other
+00017090: 7769 7365 2c20 6368 6563 6b20 6966 2074  wise, check if t
+000170a0: 6865 7265 2061 7265 2061 6e79 206d 6f64  here are any mod
+000170b0: 6966 6965 6420 6365 6c6c 7320 6265 6e65  ified cells bene
+000170c0: 6174 6820 2877 6520 6e65 6564 206e 6f74  ath (we need not
+000170d0: 2064 6f20 7468 6973 2069 6620 7468 6520   do this if the 
+000170e0: 7265 6620 7769 6c6c 2062 6520 666c 6174  ref will be flat
+000170f0: 7465 6e65 6420 616e 7977 6179 7329 0a20  tened anyways). 
+00017100: 2020 2020 2020 2069 6620 6973 5f69 6e76         if is_inv
+00017110: 616c 6964 5f72 6566 2872 6566 2c20 6772  alid_ref(ref, gr
+00017120: 6964 5f73 697a 6529 3a0a 2020 2020 2020  id_size):.      
+00017130: 2020 2020 2020 696e 7661 6c69 645f 7265        invalid_re
+00017140: 6673 2e61 7070 656e 6428 7265 662e 6e61  fs.append(ref.na
+00017150: 6d65 290a 2020 2020 2020 2020 656c 7365  me).        else
+00017160: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00017170: 6f74 6865 7277 6973 652c 2072 6563 7572  otherwise, recur
+00017180: 7369 7665 6c79 2066 6c61 7474 656e 2072  sively flatten r
+00017190: 6566 7320 6966 2074 6865 2073 7562 6365  efs if the subce
+000171a0: 6c6c 2068 6173 206e 6f74 2061 6c72 6561  ll has not alrea
+000171b0: 6479 2062 6565 6e20 7472 6176 6572 7365  dy been traverse
+000171c0: 640a 2020 2020 2020 2020 2020 2020 6966  d.            if
+000171d0: 2072 6566 2e70 6172 656e 742e 6e61 6d65   ref.parent.name
+000171e0: 206e 6f74 2069 6e20 7472 6176 6572 7365   not in traverse
+000171f0: 645f 636f 6d70 6f6e 656e 7473 3a0a 2020  d_components:.  
+00017200: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+00017210: 6174 7465 6e5f 696e 7661 6c69 645f 7265  atten_invalid_re
+00017220: 6673 5f72 6563 7572 7369 7665 280a 2020  fs_recursive(.  
 00017230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017240: 7375 6263 656c 6c5f 6d6f 6469 6669 6564  subcell_modified
-00017250: 203d 2054 7275 650a 2020 2020 6966 2069   = True.    if i
-00017260: 6e76 616c 6964 5f72 6566 7320 6f72 2073  nvalid_refs or s
-00017270: 7562 6365 6c6c 5f6d 6f64 6966 6965 643a  ubcell_modified:
-00017280: 0a20 2020 2020 2020 206e 6577 5f63 6f6d  .        new_com
-00017290: 706f 6e65 6e74 203d 2063 6f6d 706f 6e65  ponent = compone
-000172a0: 6e74 2e63 6f70 7928 290a 2020 2020 2020  nt.copy().      
-000172b0: 2020 6e65 775f 636f 6d70 6f6e 656e 742e    new_component.
-000172c0: 6e61 6d65 203d 2063 6f6d 706f 6e65 6e74  name = component
-000172d0: 2e6e 616d 650a 2020 2020 2020 2020 2320  .name.        # 
-000172e0: 6d61 6b65 2073 7572 6520 616c 6c20 6d6f  make sure all mo
-000172f0: 6469 6669 6564 2063 656c 6c73 2068 6176  dified cells hav
-00017300: 6520 7468 6569 7220 7265 6665 7265 6e63  e their referenc
-00017310: 6573 2075 7064 6174 6564 0a20 2020 2020  es updated.     
-00017320: 2020 206e 6577 5f72 6566 7320 3d20 6e65     new_refs = ne
-00017330: 775f 636f 6d70 6f6e 656e 742e 7265 6665  w_component.refe
-00017340: 7265 6e63 6573 2e63 6f70 7928 290a 2020  rences.copy().  
-00017350: 2020 2020 2020 666f 7220 7265 6620 696e        for ref in
-00017360: 206e 6577 5f72 6566 733a 0a20 2020 2020   new_refs:.     
-00017370: 2020 2020 2020 2069 6620 7265 662e 6e61         if ref.na
-00017380: 6d65 2069 6e20 696e 7661 6c69 645f 7265  me in invalid_re
-00017390: 6673 3a0a 2020 2020 2020 2020 2020 2020  fs:.            
-000173a0: 2020 2020 6e65 775f 636f 6d70 6f6e 656e      new_componen
-000173b0: 742e 666c 6174 7465 6e5f 7265 6665 7265  t.flatten_refere
-000173c0: 6e63 6528 7265 6629 0a20 2020 2020 2020  nce(ref).       
-000173d0: 2020 2020 2065 6c69 6620 280a 2020 2020       elif (.    
-000173e0: 2020 2020 2020 2020 2020 2020 7265 662e              ref.
-000173f0: 7061 7265 6e74 2e6e 616d 6520 696e 2075  parent.name in u
-00017400: 7064 6174 6564 5f63 6f6d 706f 6e65 6e74  pdated_component
-00017410: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00017420: 2020 616e 6420 7265 662e 7061 7265 6e74    and ref.parent
-00017430: 2069 7320 6e6f 7420 7570 6461 7465 645f   is not updated_
-00017440: 636f 6d70 6f6e 656e 7473 5b72 6566 2e70  components[ref.p
-00017450: 6172 656e 742e 6e61 6d65 5d0a 2020 2020  arent.name].    
-00017460: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00017470: 2020 2020 2020 2020 2020 2072 6566 2e70             ref.p
-00017480: 6172 656e 7420 3d20 7570 6461 7465 645f  arent = updated_
-00017490: 636f 6d70 6f6e 656e 7473 5b72 6566 2e70  components[ref.p
-000174a0: 6172 656e 742e 6e61 6d65 5d0a 2020 2020  arent.name].    
-000174b0: 2020 2020 636f 6d70 6f6e 656e 7420 3d20      component = 
-000174c0: 6e65 775f 636f 6d70 6f6e 656e 740a 2020  new_component.  
-000174d0: 2020 2020 2020 7570 6461 7465 645f 636f        updated_co
-000174e0: 6d70 6f6e 656e 7473 5b63 6f6d 706f 6e65  mponents[compone
-000174f0: 6e74 2e6e 616d 655d 203d 206e 6577 5f63  nt.name] = new_c
-00017500: 6f6d 706f 6e65 6e74 0a20 2020 2074 7261  omponent.    tra
-00017510: 7665 7273 6564 5f63 6f6d 706f 6e65 6e74  versed_component
-00017520: 732e 6164 6428 636f 6d70 6f6e 656e 742e  s.add(component.
-00017530: 6e61 6d65 290a 2020 2020 7265 7475 726e  name).    return
-00017540: 2063 6f6d 706f 6e65 6e74 0a0a 0a64 6566   component...def
-00017550: 205f 6368 6563 6b5f 756e 6361 6368 6564   _check_uncached
-00017560: 5f63 6f6d 706f 6e65 6e74 7328 636f 6d70  _components(comp
-00017570: 6f6e 656e 742c 206d 6f64 6529 3a0a 2020  onent, mode):.  
-00017580: 2020 7661 6c69 645f 6d6f 6465 7320 3d20    valid_modes = 
-00017590: 5b22 7761 726e 222c 2022 6572 726f 7222  ["warn", "error"
-000175a0: 2c20 2269 676e 6f72 6522 5d0a 0a20 2020  , "ignore"]..   
-000175b0: 2069 6620 6d6f 6465 203d 3d20 2269 676e   if mode == "ign
-000175c0: 6f72 6522 3a0a 2020 2020 2020 2020 7265  ore":.        re
-000175d0: 7475 726e 0a20 2020 2065 6c69 6620 6d6f  turn.    elif mo
-000175e0: 6465 206e 6f74 2069 6e20 7661 6c69 645f  de not in valid_
-000175f0: 6d6f 6465 733a 0a20 2020 2020 2020 2072  modes:.        r
-00017600: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00017610: 0a20 2020 2020 2020 2020 2020 2066 227b  .            f"{
-00017620: 6d6f 6465 7d20 6973 206e 6f74 2061 2076  mode} is not a v
-00017630: 616c 6964 2076 616c 7565 2066 6f72 206f  alid value for o
-00017640: 6e5f 756e 6361 6368 6564 5f63 6f6d 706f  n_uncached_compo
-00017650: 6e65 6e74 2e20 5472 7920 6f6e 6520 6f66  nent. Try one of
-00017660: 2074 6865 7365 3a20 7b76 616c 6964 5f6d   these: {valid_m
-00017670: 6f64 6573 7d2e 220a 2020 2020 2020 2020  odes}.".        
-00017680: 290a 0a20 2020 2066 6f72 2073 7562 5f63  )..    for sub_c
-00017690: 6f6d 706f 6e65 6e74 2069 6e20 636f 6d70  omponent in comp
-000176a0: 6f6e 656e 742e 6765 745f 6465 7065 6e64  onent.get_depend
-000176b0: 656e 6369 6573 2872 6563 7572 7369 7665  encies(recursive
-000176c0: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
-000176d0: 6966 206e 6f74 2073 7562 5f63 6f6d 706f  if not sub_compo
-000176e0: 6e65 6e74 2e5f 6c6f 636b 6564 3a0a 2020  nent._locked:.  
-000176f0: 2020 2020 2020 2020 2020 6d65 7373 6167            messag
-00017700: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
-00017710: 2020 2020 2020 6622 436f 6d70 6f6e 656e        f"Componen
-00017720: 7420 7b73 7562 5f63 6f6d 706f 6e65 6e74  t {sub_component
-00017730: 2e6e 616d 6521 727d 2077 6173 204e 4f54  .name!r} was NOT
-00017740: 2070 726f 7065 726c 7920 6c6f 636b 6564   properly locked
-00017750: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00017760: 2020 2020 2259 6f75 206e 6565 6420 746f      "You need to
-00017770: 2077 7269 7465 2069 7420 696e 746f 2061   write it into a
-00017780: 2066 756e 6374 696f 6e20 7468 6174 2068   function that h
-00017790: 6173 2074 6865 2040 6365 6c6c 2064 6563  as the @cell dec
-000177a0: 6f72 6174 6f72 2e22 0a20 2020 2020 2020  orator.".       
-000177b0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000177c0: 2020 2069 6620 6d6f 6465 203d 3d20 2277     if mode == "w
-000177d0: 6172 6e22 3a0a 2020 2020 2020 2020 2020  arn":.          
-000177e0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-000177f0: 6172 6e28 6d65 7373 6167 652c 2055 6e63  arn(message, Unc
-00017800: 6163 6865 6443 6f6d 706f 6e65 6e74 5761  achedComponentWa
-00017810: 726e 696e 672c 2073 7461 636b 6c65 7665  rning, stackleve
-00017820: 6c3d 3329 0a0a 2020 2020 2020 2020 2020  l=3)..          
-00017830: 2020 656c 6966 206d 6f64 6520 3d3d 2022    elif mode == "
-00017840: 6572 726f 7222 3a0a 2020 2020 2020 2020  error":.        
-00017850: 2020 2020 2020 2020 7261 6973 6520 556e          raise Un
-00017860: 6361 6368 6564 436f 6d70 6f6e 656e 7445  cachedComponentE
-00017870: 7272 6f72 286d 6573 7361 6765 290a 0a0a  rror(message)...
-00017880: 6465 6620 7465 7374 5f73 616d 655f 7569  def test_same_ui
-00017890: 6428 2920 2d3e 204e 6f6e 653a 0a20 2020  d() -> None:.   
-000178a0: 2069 6d70 6f72 7420 6764 7366 6163 746f   import gdsfacto
-000178b0: 7279 2061 7320 6766 0a0a 2020 2020 6320  ry as gf..    c 
-000178c0: 3d20 436f 6d70 6f6e 656e 7428 290a 2020  = Component().  
-000178d0: 2020 6320 3c3c 2067 662e 636f 6d70 6f6e    c << gf.compon
-000178e0: 656e 7473 2e72 6563 7461 6e67 6c65 2829  ents.rectangle()
-000178f0: 0a20 2020 2063 203c 3c20 6766 2e63 6f6d  .    c << gf.com
-00017900: 706f 6e65 6e74 732e 7265 6374 616e 676c  ponents.rectangl
-00017910: 6528 290a 0a20 2020 2072 3120 3d20 632e  e()..    r1 = c.
-00017920: 7265 6665 7265 6e63 6573 5b30 5d2e 7061  references[0].pa
-00017930: 7265 6e74 0a20 2020 2072 3220 3d20 632e  rent.    r2 = c.
-00017940: 7265 6665 7265 6e63 6573 5b31 5d2e 7061  references[1].pa
-00017950: 7265 6e74 0a0a 2020 2020 6173 7365 7274  rent..    assert
-00017960: 2072 312e 7569 6420 3d3d 2072 322e 7569   r1.uid == r2.ui
-00017970: 642c 2066 227b 7231 2e75 6964 7d20 6d75  d, f"{r1.uid} mu
-00017980: 7374 2065 7175 616c 207b 7232 2e75 6964  st equal {r2.uid
-00017990: 7d22 0a0a 0a64 6566 2074 6573 745f 6e65  }"...def test_ne
-000179a0: 746c 6973 745f 7369 6d70 6c65 2829 202d  tlist_simple() -
-000179b0: 3e20 4e6f 6e65 3a0a 2020 2020 696d 706f  > None:.    impo
-000179c0: 7274 2067 6473 6661 6374 6f72 7920 6173  rt gdsfactory as
-000179d0: 2067 660a 0a20 2020 2063 203d 2067 662e   gf..    c = gf.
-000179e0: 436f 6d70 6f6e 656e 7428 290a 2020 2020  Component().    
-000179f0: 6331 203d 2063 203c 3c20 6766 2e63 6f6d  c1 = c << gf.com
-00017a00: 706f 6e65 6e74 732e 7374 7261 6967 6874  ponents.straight
-00017a10: 286c 656e 6774 683d 312c 2077 6964 7468  (length=1, width
-00017a20: 3d32 290a 2020 2020 6332 203d 2063 203c  =2).    c2 = c <
-00017a30: 3c20 6766 2e63 6f6d 706f 6e65 6e74 732e  < gf.components.
-00017a40: 7374 7261 6967 6874 286c 656e 6774 683d  straight(length=
-00017a50: 322c 2077 6964 7468 3d32 290a 2020 2020  2, width=2).    
-00017a60: 6332 2e63 6f6e 6e65 6374 2870 6f72 743d  c2.connect(port=
-00017a70: 226f 3122 2c20 6465 7374 696e 6174 696f  "o1", destinatio
-00017a80: 6e3d 6331 2e70 6f72 7473 5b22 6f32 225d  n=c1.ports["o2"]
-00017a90: 290a 2020 2020 632e 6164 645f 706f 7274  ).    c.add_port
-00017aa0: 2822 6f31 222c 2070 6f72 743d 6331 2e70  ("o1", port=c1.p
-00017ab0: 6f72 7473 5b22 6f31 225d 290a 2020 2020  orts["o1"]).    
-00017ac0: 632e 6164 645f 706f 7274 2822 6f32 222c  c.add_port("o2",
-00017ad0: 2070 6f72 743d 6332 2e70 6f72 7473 5b22   port=c2.ports["
-00017ae0: 6f32 225d 290a 2020 2020 6e65 746c 6973  o2"]).    netlis
-00017af0: 7420 3d20 632e 6765 745f 6e65 746c 6973  t = c.get_netlis
-00017b00: 7428 290a 2020 2020 2320 7072 696e 7428  t().    # print(
-00017b10: 6e65 746c 6973 742e 7072 6574 7479 2829  netlist.pretty()
-00017b20: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
-00017b30: 286e 6574 6c69 7374 5b22 696e 7374 616e  (netlist["instan
-00017b40: 6365 7322 5d29 203d 3d20 320a 0a0a 6465  ces"]) == 2...de
-00017b50: 6620 7465 7374 5f6e 6574 6c69 7374 5f73  f test_netlist_s
-00017b60: 696d 706c 655f 7769 6474 685f 6d69 736d  imple_width_mism
-00017b70: 6174 6368 5f74 6872 6f77 735f 6572 726f  atch_throws_erro
-00017b80: 7228 2920 2d3e 204e 6f6e 653a 0a20 2020  r() -> None:.   
-00017b90: 2069 6d70 6f72 7420 7079 7465 7374 0a0a   import pytest..
-00017ba0: 2020 2020 696d 706f 7274 2067 6473 6661      import gdsfa
-00017bb0: 6374 6f72 7920 6173 2067 660a 0a20 2020  ctory as gf..   
-00017bc0: 2063 203d 2067 662e 436f 6d70 6f6e 656e   c = gf.Componen
-00017bd0: 7428 290a 2020 2020 6331 203d 2063 203c  t().    c1 = c <
-00017be0: 3c20 6766 2e63 6f6d 706f 6e65 6e74 732e  < gf.components.
-00017bf0: 7374 7261 6967 6874 286c 656e 6774 683d  straight(length=
-00017c00: 312c 2077 6964 7468 3d31 290a 2020 2020  1, width=1).    
-00017c10: 6332 203d 2063 203c 3c20 6766 2e63 6f6d  c2 = c << gf.com
-00017c20: 706f 6e65 6e74 732e 7374 7261 6967 6874  ponents.straight
-00017c30: 286c 656e 6774 683d 322c 2077 6964 7468  (length=2, width
-00017c40: 3d32 290a 2020 2020 6332 2e63 6f6e 6e65  =2).    c2.conne
-00017c50: 6374 2870 6f72 743d 226f 3122 2c20 6465  ct(port="o1", de
-00017c60: 7374 696e 6174 696f 6e3d 6331 2e70 6f72  stination=c1.por
-00017c70: 7473 5b22 6f32 225d 290a 2020 2020 632e  ts["o2"]).    c.
-00017c80: 6164 645f 706f 7274 2822 6f31 222c 2070  add_port("o1", p
-00017c90: 6f72 743d 6331 2e70 6f72 7473 5b22 6f31  ort=c1.ports["o1
-00017ca0: 225d 290a 2020 2020 632e 6164 645f 706f  "]).    c.add_po
-00017cb0: 7274 2822 6f32 222c 2070 6f72 743d 6332  rt("o2", port=c2
-00017cc0: 2e70 6f72 7473 5b22 6f32 225d 290a 2020  .ports["o2"]).  
-00017cd0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00017ce0: 6973 6573 2856 616c 7565 4572 726f 7229  ises(ValueError)
-00017cf0: 3a0a 2020 2020 2020 2020 632e 6765 745f  :.        c.get_
-00017d00: 6e65 746c 6973 7428 290a 0a0a 6465 6620  netlist()...def 
-00017d10: 7465 7374 5f6e 6574 6c69 7374 5f63 6f6d  test_netlist_com
-00017d20: 706c 6578 2829 202d 3e20 4e6f 6e65 3a0a  plex() -> None:.
-00017d30: 2020 2020 696d 706f 7274 2067 6473 6661      import gdsfa
-00017d40: 6374 6f72 7920 6173 2067 660a 0a20 2020  ctory as gf..   
-00017d50: 2063 203d 2067 662e 636f 6d70 6f6e 656e   c = gf.componen
-00017d60: 7473 2e6d 7a69 5f61 726d 7328 290a 2020  ts.mzi_arms().  
-00017d70: 2020 6e65 746c 6973 7420 3d20 632e 6765    netlist = c.ge
-00017d80: 745f 6e65 746c 6973 7428 290a 2020 2020  t_netlist().    
-00017d90: 2320 7072 696e 7428 6e65 746c 6973 742e  # print(netlist.
-00017da0: 7072 6574 7479 2829 290a 2020 2020 6173  pretty()).    as
-00017db0: 7365 7274 206c 656e 286e 6574 6c69 7374  sert len(netlist
-00017dc0: 5b22 696e 7374 616e 6365 7322 5d29 203d  ["instances"]) =
-00017dd0: 3d20 342c 206c 656e 286e 6574 6c69 7374  = 4, len(netlist
-00017de0: 5b22 696e 7374 616e 6365 7322 5d29 0a0a  ["instances"])..
-00017df0: 0a64 6566 2074 6573 745f 6578 7472 6163  .def test_extrac
-00017e00: 7428 2920 2d3e 2043 6f6d 706f 6e65 6e74  t() -> Component
-00017e10: 3a0a 2020 2020 696d 706f 7274 2067 6473  :.    import gds
-00017e20: 6661 6374 6f72 7920 6173 2067 660a 0a20  factory as gf.. 
-00017e30: 2020 2063 203d 2067 662e 636f 6d70 6f6e     c = gf.compon
-00017e40: 656e 7473 2e73 7472 6169 6768 7428 0a20  ents.straight(. 
-00017e50: 2020 2020 2020 206c 656e 6774 683d 3130         length=10
-00017e60: 2c0a 2020 2020 2020 2020 7769 6474 683d  ,.        width=
-00017e70: 302e 352c 0a20 2020 2020 2020 2062 626f  0.5,.        bbo
-00017e80: 785f 6c61 7965 7273 3d5b 6766 2e4c 4159  x_layers=[gf.LAY
-00017e90: 4552 2e57 4743 4c41 445d 2c0a 2020 2020  ER.WGCLAD],.    
-00017ea0: 2020 2020 6262 6f78 5f6f 6666 7365 7473      bbox_offsets
-00017eb0: 3d5b 335d 2c0a 2020 2020 2020 2020 7769  =[3],.        wi
-00017ec0: 7468 5f62 626f 783d 5472 7565 2c0a 2020  th_bbox=True,.  
-00017ed0: 2020 2020 2020 636c 6164 6469 6e67 5f6c        cladding_l
-00017ee0: 6179 6572 733d 4e6f 6e65 2c0a 2020 2020  ayers=None,.    
-00017ef0: 2020 2020 6164 645f 7069 6e73 3d4e 6f6e      add_pins=Non
-00017f00: 652c 0a20 2020 2020 2020 2061 6464 5f62  e,.        add_b
-00017f10: 626f 783d 4e6f 6e65 2c0a 2020 2020 290a  box=None,.    ).
-00017f20: 2020 2020 6332 203d 2063 2e65 7874 7261      c2 = c.extra
-00017f30: 6374 286c 6179 6572 733d 5b67 662e 4c41  ct(layers=[gf.LA
-00017f40: 5945 522e 5747 434c 4144 5d29 0a0a 2020  YER.WGCLAD])..  
-00017f50: 2020 6173 7365 7274 206c 656e 2863 2e70    assert len(c.p
-00017f60: 6f6c 7967 6f6e 7329 203d 3d20 322c 206c  olygons) == 2, l
-00017f70: 656e 2863 2e70 6f6c 7967 6f6e 7329 0a20  en(c.polygons). 
-00017f80: 2020 2061 7373 6572 7420 6c65 6e28 6332     assert len(c2
-00017f90: 2e70 6f6c 7967 6f6e 7329 203d 3d20 312c  .polygons) == 1,
-00017fa0: 206c 656e 2863 322e 706f 6c79 676f 6e73   len(c2.polygons
-00017fb0: 290a 2020 2020 6173 7365 7274 2067 662e  ).    assert gf.
-00017fc0: 4c41 5945 522e 5747 434c 4144 2069 6e20  LAYER.WGCLAD in 
-00017fd0: 6332 2e6c 6179 6572 730a 2020 2020 7265  c2.layers.    re
-00017fe0: 7475 726e 2063 320a 0a0a 6465 6620 6861  turn c2...def ha
-00017ff0: 7368 5f66 696c 6528 6669 6c65 7061 7468  sh_file(filepath
-00018000: 293a 0a20 2020 206d 6435 203d 2068 6173  ):.    md5 = has
-00018010: 686c 6962 2e6d 6435 2829 0a20 2020 206d  hlib.md5().    m
-00018020: 6435 2e75 7064 6174 6528 6669 6c65 7061  d5.update(filepa
-00018030: 7468 2e72 6561 645f 6279 7465 7328 2929  th.read_bytes())
-00018040: 0a20 2020 2072 6574 7572 6e20 6d64 352e  .    return md5.
-00018050: 6865 7864 6967 6573 7428 290a 0a0a 6465  hexdigest()...de
-00018060: 6620 7465 7374 5f62 626f 785f 7265 6665  f test_bbox_refe
-00018070: 7265 6e63 6528 2920 2d3e 2043 6f6d 706f  rence() -> Compo
-00018080: 6e65 6e74 3a0a 2020 2020 696d 706f 7274  nent:.    import
-00018090: 2067 6473 6661 6374 6f72 7920 6173 2067   gdsfactory as g
-000180a0: 660a 0a20 2020 2063 203d 2067 662e 436f  f..    c = gf.Co
-000180b0: 6d70 6f6e 656e 7428 2263 6f6d 706f 6e65  mponent("compone
-000180c0: 6e74 5f77 6974 685f 6f66 6667 7269 645f  nt_with_offgrid_
-000180d0: 706f 6c79 676f 6e73 2229 0a20 2020 2063  polygons").    c
-000180e0: 3120 3d20 6320 3c3c 2067 662e 636f 6d70  1 = c << gf.comp
-000180f0: 6f6e 656e 7473 2e72 6563 7461 6e67 6c65  onents.rectangle
-00018100: 2873 697a 653d 2831 2e35 652d 332c 2031  (size=(1.5e-3, 1
-00018110: 2e35 652d 3329 2c20 706f 7274 5f74 7970  .5e-3), port_typ
-00018120: 653d 4e6f 6e65 290a 2020 2020 6332 203d  e=None).    c2 =
-00018130: 2063 203c 3c20 6766 2e63 6f6d 706f 6e65   c << gf.compone
-00018140: 6e74 732e 7265 6374 616e 676c 6528 7369  nts.rectangle(si
-00018150: 7a65 3d28 312e 3565 2d33 2c20 312e 3565  ze=(1.5e-3, 1.5e
-00018160: 2d33 292c 2070 6f72 745f 7479 7065 3d4e  -3), port_type=N
-00018170: 6f6e 6529 0a20 2020 2063 322e 786d 696e  one).    c2.xmin
-00018180: 203d 2063 312e 786d 6178 0a0a 2020 2020   = c1.xmax..    
-00018190: 6173 7365 7274 2063 322e 7873 697a 6520  assert c2.xsize 
-000181a0: 3d3d 2032 652d 330a 2020 2020 7265 7475  == 2e-3.    retu
-000181b0: 726e 2063 320a 0a0a 6465 6620 7465 7374  rn c2...def test
-000181c0: 5f62 626f 785f 636f 6d70 6f6e 656e 7428  _bbox_component(
-000181d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2069  ) -> None:.    i
-000181e0: 6d70 6f72 7420 6764 7366 6163 746f 7279  mport gdsfactory
-000181f0: 2061 7320 6766 0a0a 2020 2020 6320 3d20   as gf..    c = 
-00018200: 6766 2e63 6f6d 706f 6e65 6e74 732e 7265  gf.components.re
-00018210: 6374 616e 676c 6528 7369 7a65 3d28 312e  ctangle(size=(1.
-00018220: 3565 2d33 2c20 312e 3565 2d33 292c 2070  5e-3, 1.5e-3), p
-00018230: 6f72 745f 7479 7065 3d4e 6f6e 6529 0a20  ort_type=None). 
-00018240: 2020 2061 7373 6572 7420 632e 7873 697a     assert c.xsiz
-00018250: 6520 3d3d 2032 652d 330a 0a0a 6465 6620  e == 2e-3...def 
-00018260: 7465 7374 5f72 656d 6170 5f6c 6179 6572  test_remap_layer
-00018270: 7328 2920 2d3e 204e 6f6e 653a 0a20 2020  s() -> None:.   
-00018280: 2069 6d70 6f72 7420 6764 7366 6163 746f   import gdsfacto
-00018290: 7279 2061 7320 6766 0a0a 2020 2020 6320  ry as gf..    c 
-000182a0: 3d20 6766 2e63 6f6d 706f 6e65 6e74 732e  = gf.components.
-000182b0: 7374 7261 6967 6874 286c 6179 6572 3d28  straight(layer=(
-000182c0: 322c 2030 2929 0a20 2020 2072 656d 6170  2, 0)).    remap
-000182d0: 203d 2063 2e72 656d 6170 5f6c 6179 6572   = c.remap_layer
-000182e0: 7328 6c61 7965 726d 6170 3d7b 2832 2c20  s(layermap={(2, 
-000182f0: 3029 3a20 6766 2e4c 4159 4552 2e57 474e  0): gf.LAYER.WGN
-00018300: 7d29 0a20 2020 2068 6173 685f 6765 6f6d  }).    hash_geom
-00018310: 6574 7279 203d 2022 3332 6364 3134 6561  etry = "32cd14ea
-00018320: 3763 6531 3363 6631 6634 3330 3237 3762  7ce13cf1f430277b
-00018330: 3435 3035 3461 3061 3739 3039 6133 6334  45054a0a7909a3c4
-00018340: 220a 0a20 2020 2061 7373 6572 7420 280a  "..    assert (.
-00018350: 2020 2020 2020 2020 7265 6d61 702e 6861          remap.ha
-00018360: 7368 5f67 656f 6d65 7472 7928 2920 3d3d  sh_geometry() ==
-00018370: 2068 6173 685f 6765 6f6d 6574 7279 0a20   hash_geometry. 
-00018380: 2020 2029 2c20 6622 6861 7368 5f67 656f     ), f"hash_geo
-00018390: 6d65 7472 7920 3d20 7b72 656d 6170 2e68  metry = {remap.h
-000183a0: 6173 685f 6765 6f6d 6574 7279 2829 2172  ash_geometry()!r
-000183b0: 7d22 0a0a 0a64 6566 2074 6573 745f 7265  }"...def test_re
-000183c0: 6d6f 7665 5f6c 6162 656c 7328 2920 2d3e  move_labels() ->
-000183d0: 204e 6f6e 653a 0a20 2020 2069 6d70 6f72   None:.    impor
-000183e0: 7420 6764 7366 6163 746f 7279 2061 7320  t gdsfactory as 
-000183f0: 6766 0a0a 2020 2020 6320 3d20 6766 2e63  gf..    c = gf.c
-00018400: 2e73 7472 6169 6768 7428 290a 2020 2020  .straight().    
-00018410: 632e 7265 6d6f 7665 5f6c 6162 656c 7328  c.remove_labels(
-00018420: 290a 0a20 2020 2061 7373 6572 7420 6c65  )..    assert le
-00018430: 6e28 632e 6c61 6265 6c73 2920 3d3d 2030  n(c.labels) == 0
-00018440: 0a0a 0a64 6566 2074 6573 745f 696d 706f  ...def test_impo
-00018450: 7274 5f67 6473 5f73 6574 7469 6e67 7328  rt_gds_settings(
-00018460: 2920 2d3e 204e 6f6e 653a 0a20 2020 2069  ) -> None:.    i
-00018470: 6d70 6f72 7420 6764 7366 6163 746f 7279  mport gdsfactory
-00018480: 2061 7320 6766 0a0a 2020 2020 6320 3d20   as gf..    c = 
-00018490: 6766 2e63 6f6d 706f 6e65 6e74 732e 6d7a  gf.components.mz
-000184a0: 6928 290a 2020 2020 6764 7370 6174 6820  i().    gdspath 
-000184b0: 3d20 632e 7772 6974 655f 6764 735f 7769  = c.write_gds_wi
-000184c0: 7468 5f6d 6574 6164 6174 6128 290a 2020  th_metadata().  
-000184d0: 2020 6332 203d 2067 662e 696d 706f 7274    c2 = gf.import
-000184e0: 5f67 6473 2867 6473 7061 7468 2c20 6e61  _gds(gdspath, na
-000184f0: 6d65 3d22 6d7a 695f 7361 6d70 6c65 222c  me="mzi_sample",
-00018500: 2072 6561 645f 6d65 7461 6461 7461 3d54   read_metadata=T
-00018510: 7275 6529 0a20 2020 2063 3320 3d20 6766  rue).    c3 = gf
-00018520: 2e72 6f75 7469 6e67 2e61 6464 5f66 6962  .routing.add_fib
-00018530: 6572 5f73 696e 676c 6528 6332 290a 2020  er_single(c2).  
-00018540: 2020 6173 7365 7274 2063 330a 0a0a 6465    assert c3...de
-00018550: 6620 7465 7374 5f66 6c61 7474 656e 5f69  f test_flatten_i
-00018560: 6e76 616c 6964 5f72 6566 735f 7265 6375  nvalid_refs_recu
-00018570: 7273 6976 6528 2920 2d3e 204e 6f6e 653a  rsive() -> None:
-00018580: 0a20 2020 2069 6d70 6f72 7420 6764 7366  .    import gdsf
-00018590: 6163 746f 7279 2061 7320 6766 0a20 2020  actory as gf.   
-000185a0: 2066 726f 6d20 6764 7366 6163 746f 7279   from gdsfactory
-000185b0: 2e64 6966 6674 6573 7420 696d 706f 7274  .difftest import
-000185c0: 2072 756e 5f78 6f72 0a20 2020 2066 726f   run_xor.    fro
-000185d0: 6d20 6764 7366 6163 746f 7279 2e72 6f75  m gdsfactory.rou
-000185e0: 7469 6e67 2e61 6c6c 5f61 6e67 6c65 2069  ting.all_angle i
-000185f0: 6d70 6f72 7420 6765 745f 6275 6e64 6c65  mport get_bundle
-00018600: 5f61 6c6c 5f61 6e67 6c65 0a0a 2020 2020  _all_angle..    
-00018610: 4067 662e 6365 6c6c 0a20 2020 2064 6566  @gf.cell.    def
-00018620: 2066 6c61 7428 293a 0a20 2020 2020 2020   flat():.       
-00018630: 2063 203d 2067 662e 436f 6d70 6f6e 656e   c = gf.Componen
-00018640: 7428 290a 2020 2020 2020 2020 6d6d 6931  t().        mmi1
-00018650: 203d 2028 6320 3c3c 2067 662e 636f 6d70   = (c << gf.comp
-00018660: 6f6e 656e 7473 2e6d 6d69 3178 3228 2929  onents.mmi1x2())
-00018670: 2e6d 6f76 6528 2830 2c20 2d31 2e30 3030  .move((0, -1.000
-00018680: 3529 290a 2020 2020 2020 2020 6d6d 6932  5)).        mmi2
-00018690: 203d 2028 6320 3c3c 2067 662e 636f 6d70   = (c << gf.comp
-000186a0: 6f6e 656e 7473 2e6d 6d69 3178 3228 2929  onents.mmi1x2())
-000186b0: 2e72 6f74 6174 6528 3830 290a 2020 2020  .rotate(80).    
-000186c0: 2020 2020 6d6d 6932 2e6d 6f76 6528 2834      mmi2.move((4
-000186d0: 302c 2032 3029 290a 2020 2020 2020 2020  0, 20)).        
-000186e0: 6275 6e64 6c65 203d 2067 6574 5f62 756e  bundle = get_bun
-000186f0: 646c 655f 616c 6c5f 616e 676c 6528 5b6d  dle_all_angle([m
-00018700: 6d69 312e 706f 7274 735b 226f 3222 5d5d  mi1.ports["o2"]]
-00018710: 2c20 5b6d 6d69 322e 706f 7274 735b 226f  , [mmi2.ports["o
-00018720: 3122 5d5d 290a 2020 2020 2020 2020 666f  1"]]).        fo
-00018730: 7220 726f 7574 6520 696e 2062 756e 646c  r route in bundl
-00018740: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
-00018750: 2e61 6464 2872 6f75 7465 2e72 6566 6572  .add(route.refer
-00018760: 656e 6365 7329 0a20 2020 2020 2020 2072  ences).        r
-00018770: 6574 7572 6e20 630a 0a20 2020 2040 6766  eturn c..    @gf
-00018780: 2e63 656c 6c0a 2020 2020 6465 6620 6869  .cell.    def hi
-00018790: 6572 6172 6368 7928 293a 0a20 2020 2020  erarchy():.     
-000187a0: 2020 2063 203d 2067 662e 436f 6d70 6f6e     c = gf.Compon
-000187b0: 656e 7428 290a 2020 2020 2020 2020 2863  ent().        (c
-000187c0: 203c 3c20 666c 6174 2829 292e 726f 7461   << flat()).rota
-000187d0: 7465 2833 3329 0a20 2020 2020 2020 2028  te(33).        (
-000187e0: 6320 3c3c 2066 6c61 7428 2929 2e72 6f74  c << flat()).rot
-000187f0: 6174 6528 3333 292e 6d6f 7665 2828 302c  ate(33).move((0,
-00018800: 2031 3030 2929 0a20 2020 2020 2020 2028   100)).        (
-00018810: 6320 3c3c 2066 6c61 7428 2929 2e6d 6f76  c << flat()).mov
-00018820: 6528 2831 3030 2c20 3029 290a 2020 2020  e((100, 0)).    
-00018830: 2020 2020 7265 7475 726e 2063 0a0a 2020      return c..  
-00018840: 2020 635f 6f72 6967 203d 2068 6965 7261    c_orig = hiera
-00018850: 7263 6879 2829 0a20 2020 2063 5f6e 6577  rchy().    c_new
-00018860: 203d 2066 6c61 7474 656e 5f69 6e76 616c   = flatten_inval
-00018870: 6964 5f72 6566 735f 7265 6375 7273 6976  id_refs_recursiv
-00018880: 6528 635f 6f72 6967 290a 2020 2020 6173  e(c_orig).    as
-00018890: 7365 7274 2063 5f6e 6577 2069 7320 6e6f  sert c_new is no
-000188a0: 7420 635f 6f72 6967 0a20 2020 2069 6e76  t c_orig.    inv
-000188b0: 616c 6964 5f72 6566 735f 6669 6c65 6e61  alid_refs_filena
-000188c0: 6d65 203d 2022 696e 7661 6c69 645f 7265  me = "invalid_re
-000188d0: 6673 2e67 6473 220a 2020 2020 696e 7661  fs.gds".    inva
-000188e0: 6c69 645f 7265 6673 5f66 6978 6564 5f66  lid_refs_fixed_f
-000188f0: 696c 656e 616d 6520 3d20 2269 6e76 616c  ilename = "inval
-00018900: 6964 5f72 6566 735f 6669 7865 642e 6764  id_refs_fixed.gd
-00018910: 7322 0a20 2020 2023 2067 6473 2066 696c  s".    # gds fil
-00018920: 6573 2073 686f 756c 6420 7374 696c 6c20  es should still 
-00018930: 6265 2073 616d 6520 746f 2031 6e6d 2074  be same to 1nm t
-00018940: 6f6c 6572 616e 6365 0a20 2020 2063 5f6f  olerance.    c_o
-00018950: 7269 672e 7772 6974 655f 6764 7328 696e  rig.write_gds(in
-00018960: 7661 6c69 645f 7265 6673 5f66 696c 656e  valid_refs_filen
-00018970: 616d 6529 0a20 2020 2063 5f6e 6577 2e77  ame).    c_new.w
-00018980: 7269 7465 5f67 6473 2869 6e76 616c 6964  rite_gds(invalid
-00018990: 5f72 6566 735f 6669 7865 645f 6669 6c65  _refs_fixed_file
-000189a0: 6e61 6d65 290a 2020 2020 7275 6e5f 786f  name).    run_xo
-000189b0: 7228 696e 7661 6c69 645f 7265 6673 5f66  r(invalid_refs_f
-000189c0: 696c 656e 616d 652c 2069 6e76 616c 6964  ilename, invalid
-000189d0: 5f72 6566 735f 6669 7865 645f 6669 6c65  _refs_fixed_file
-000189e0: 6e61 6d65 290a 0a0a 6966 205f 5f6e 616d  name)...if __nam
-000189f0: 655f 5f20 3d3d 2022 5f5f 6d61 696e 5f5f  e__ == "__main__
-00018a00: 223a 0a20 2020 2023 2069 6d70 6f72 7420  ":.    # import 
-00018a10: 6764 7366 6163 746f 7279 2061 7320 6766  gdsfactory as gf
-00018a20: 0a0a 2020 2020 7465 7374 5f72 656d 6170  ..    test_remap
-00018a30: 5f6c 6179 6572 7328 290a 2020 2020 2320  _layers().    # 
-00018a40: 6320 3d20 6766 2e43 6f6d 706f 6e65 6e74  c = gf.Component
-00018a50: 2829 0a20 2020 2023 2070 203d 2063 2e61  ().    # p = c.a
-00018a60: 6464 5f70 6f6c 7967 6f6e 280a 2020 2020  dd_polygon(.    
-00018a70: 2320 2020 2020 5b28 2d38 2c20 362c 2037  #     [(-8, 6, 7
-00018a80: 2c20 3929 2c20 282d 362c 2038 2c20 3137  , 9), (-6, 8, 17
-00018a90: 2c20 3529 5d2c 206c 6179 6572 3d28 312c  , 5)], layer=(1,
-00018aa0: 2030 290a 2020 2020 2320 2920 2023 2047   0).    # )  # G
-00018ab0: 4453 206c 6179 6572 7320 6172 6520 7475  DS layers are tu
-00018ac0: 706c 6573 206f 6620 696e 7473 2028 6275  ples of ints (bu
-00018ad0: 7420 6966 2077 6520 7573 6520 6f6e 6c79  t if we use only
-00018ae0: 206f 6e65 206e 756d 6265 7220 6974 2061   one number it a
-00018af0: 7373 756d 6573 2074 6865 206f 7468 6572  ssumes the other
-00018b00: 206e 756d 6265 7220 6973 2030 290a 0a20   number is 0).. 
-00018b10: 2020 2023 2063 3220 3d20 6766 2e43 6f6d     # c2 = gf.Com
-00018b20: 706f 6e65 6e74 2829 0a20 2020 2023 2063  ponent().    # c
-00018b30: 203d 2067 662e 636f 6d70 6f6e 656e 7473   = gf.components
-00018b40: 2e6d 7a69 2829 0a20 2020 2023 2070 7269  .mzi().    # pri
-00018b50: 6e74 2863 2e67 6574 5f6c 6179 6572 5f6e  nt(c.get_layer_n
-00018b60: 616d 6573 2829 290a 2020 2020 2320 6320  ames()).    # c 
-00018b70: 3d20 6766 2e63 6f6d 706f 6e65 6e74 732e  = gf.components.
-00018b80: 6d7a 6928 290a 2020 2020 2320 7072 696e  mzi().    # prin
-00018b90: 7428 632e 6765 745f 6c61 7965 725f 6e61  t(c.get_layer_na
-00018ba0: 6d65 7328 2929 0a20 2020 2023 2072 203d  mes()).    # r =
-00018bb0: 2063 2e72 6566 2829 0a20 2020 2023 2063   c.ref().    # c
-00018bc0: 322e 636f 7079 5f63 6869 6c64 5f69 6e66  2.copy_child_inf
-00018bd0: 6f28 632e 6e61 6d65 645f 7265 6665 7265  o(c.named_refere
-00018be0: 6e63 6573 5b22 7378 7422 5d29 0a20 2020  nces["sxt"]).   
-00018bf0: 2023 2074 6573 745f 7265 6d61 705f 6c61   # test_remap_la
-00018c00: 7965 7273 2829 0a20 2020 2023 2063 203d  yers().    # c =
-00018c10: 2074 6573 745f 6765 745f 6c61 7965 7273   test_get_layers
-00018c20: 2829 0a20 2020 2023 2063 2e70 6c6f 745f  ().    # c.plot_
-00018c30: 7174 2829 0a20 2020 2023 2063 2e70 6c6f  qt().    # c.plo
-00018c40: 7468 2829 0a20 2020 2023 2063 203d 2074  th().    # c = t
-00018c50: 6573 745f 6578 7472 6163 7428 290a 2020  est_extract().  
-00018c60: 2020 2320 6764 7370 6174 6820 3d20 632e    # gdspath = c.
-00018c70: 7772 6974 655f 6764 7328 290a 2020 2020  write_gds().    
-00018c80: 2320 6766 2e73 686f 7728 6764 7370 6174  # gf.show(gdspat
-00018c90: 6829 0a20 2020 2023 2063 2e73 686f 7728  h).    # c.show(
-00018ca0: 7368 6f77 5f70 6f72 7473 3d54 7275 6529  show_ports=True)
-00018cb0: 0a20 2020 2023 2063 2e73 686f 7728 290a  .    # c.show().
+00017240: 2020 7265 662e 7061 7265 6e74 2c0a 2020    ref.parent,.  
+00017250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017260: 2020 6772 6964 5f73 697a 653d 6772 6964    grid_size=grid
+00017270: 5f73 697a 652c 0a20 2020 2020 2020 2020  _size,.         
+00017280: 2020 2020 2020 2020 2020 2075 7064 6174             updat
+00017290: 6564 5f63 6f6d 706f 6e65 6e74 733d 7570  ed_components=up
+000172a0: 6461 7465 645f 636f 6d70 6f6e 656e 7473  dated_components
+000172b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000172c0: 2020 2020 2020 7472 6176 6572 7365 645f        traversed_
+000172d0: 636f 6d70 6f6e 656e 7473 3d74 7261 7665  components=trave
+000172e0: 7273 6564 5f63 6f6d 706f 6e65 6e74 732c  rsed_components,
+000172f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017300: 2029 0a20 2020 2020 2020 2020 2020 2023   ).            #
+00017310: 206e 6f77 2c20 6966 2074 6865 2072 6566   now, if the ref
+00017320: 2773 2063 656c 6c20 6265 656e 206d 6f64  's cell been mod
+00017330: 6966 6965 642c 206d 6172 6b20 6974 2061  ified, mark it a
+00017340: 7320 7375 6368 0a20 2020 2020 2020 2020  s such.         
+00017350: 2020 2069 6620 7265 662e 7061 7265 6e74     if ref.parent
+00017360: 2e6e 616d 6520 696e 2075 7064 6174 6564  .name in updated
+00017370: 5f63 6f6d 706f 6e65 6e74 733a 0a20 2020  _components:.   
+00017380: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+00017390: 6365 6c6c 5f6d 6f64 6966 6965 6420 3d20  cell_modified = 
+000173a0: 5472 7565 0a20 2020 2069 6620 696e 7661  True.    if inva
+000173b0: 6c69 645f 7265 6673 206f 7220 7375 6263  lid_refs or subc
+000173c0: 656c 6c5f 6d6f 6469 6669 6564 3a0a 2020  ell_modified:.  
+000173d0: 2020 2020 2020 6e65 775f 636f 6d70 6f6e        new_compon
+000173e0: 656e 7420 3d20 636f 6d70 6f6e 656e 742e  ent = component.
+000173f0: 636f 7079 2829 0a20 2020 2020 2020 206e  copy().        n
+00017400: 6577 5f63 6f6d 706f 6e65 6e74 2e6e 616d  ew_component.nam
+00017410: 6520 3d20 636f 6d70 6f6e 656e 742e 6e61  e = component.na
+00017420: 6d65 0a20 2020 2020 2020 2023 206d 616b  me.        # mak
+00017430: 6520 7375 7265 2061 6c6c 206d 6f64 6966  e sure all modif
+00017440: 6965 6420 6365 6c6c 7320 6861 7665 2074  ied cells have t
+00017450: 6865 6972 2072 6566 6572 656e 6365 7320  heir references 
+00017460: 7570 6461 7465 640a 2020 2020 2020 2020  updated.        
+00017470: 6e65 775f 7265 6673 203d 206e 6577 5f63  new_refs = new_c
+00017480: 6f6d 706f 6e65 6e74 2e72 6566 6572 656e  omponent.referen
+00017490: 6365 732e 636f 7079 2829 0a20 2020 2020  ces.copy().     
+000174a0: 2020 2066 6f72 2072 6566 2069 6e20 6e65     for ref in ne
+000174b0: 775f 7265 6673 3a0a 2020 2020 2020 2020  w_refs:.        
+000174c0: 2020 2020 6966 2072 6566 2e6e 616d 6520      if ref.name 
+000174d0: 696e 2069 6e76 616c 6964 5f72 6566 733a  in invalid_refs:
+000174e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000174f0: 206e 6577 5f63 6f6d 706f 6e65 6e74 2e66   new_component.f
+00017500: 6c61 7474 656e 5f72 6566 6572 656e 6365  latten_reference
+00017510: 2872 6566 290a 2020 2020 2020 2020 2020  (ref).          
+00017520: 2020 656c 6966 2028 0a20 2020 2020 2020    elif (.       
+00017530: 2020 2020 2020 2020 2072 6566 2e70 6172           ref.par
+00017540: 656e 742e 6e61 6d65 2069 6e20 7570 6461  ent.name in upda
+00017550: 7465 645f 636f 6d70 6f6e 656e 7473 0a20  ted_components. 
+00017560: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00017570: 6e64 2072 6566 2e70 6172 656e 7420 6973  nd ref.parent is
+00017580: 206e 6f74 2075 7064 6174 6564 5f63 6f6d   not updated_com
+00017590: 706f 6e65 6e74 735b 7265 662e 7061 7265  ponents[ref.pare
+000175a0: 6e74 2e6e 616d 655d 0a20 2020 2020 2020  nt.name].       
+000175b0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+000175c0: 2020 2020 2020 2020 7265 662e 7061 7265          ref.pare
+000175d0: 6e74 203d 2075 7064 6174 6564 5f63 6f6d  nt = updated_com
+000175e0: 706f 6e65 6e74 735b 7265 662e 7061 7265  ponents[ref.pare
+000175f0: 6e74 2e6e 616d 655d 0a20 2020 2020 2020  nt.name].       
+00017600: 2063 6f6d 706f 6e65 6e74 203d 206e 6577   component = new
+00017610: 5f63 6f6d 706f 6e65 6e74 0a20 2020 2020  _component.     
+00017620: 2020 2075 7064 6174 6564 5f63 6f6d 706f     updated_compo
+00017630: 6e65 6e74 735b 636f 6d70 6f6e 656e 742e  nents[component.
+00017640: 6e61 6d65 5d20 3d20 6e65 775f 636f 6d70  name] = new_comp
+00017650: 6f6e 656e 740a 2020 2020 7472 6176 6572  onent.    traver
+00017660: 7365 645f 636f 6d70 6f6e 656e 7473 2e61  sed_components.a
+00017670: 6464 2863 6f6d 706f 6e65 6e74 2e6e 616d  dd(component.nam
+00017680: 6529 0a20 2020 2072 6574 7572 6e20 636f  e).    return co
+00017690: 6d70 6f6e 656e 740a 0a0a 6465 6620 5f63  mponent...def _c
+000176a0: 6865 636b 5f75 6e63 6163 6865 645f 636f  heck_uncached_co
+000176b0: 6d70 6f6e 656e 7473 2863 6f6d 706f 6e65  mponents(compone
+000176c0: 6e74 2c20 6d6f 6465 293a 0a20 2020 2076  nt, mode):.    v
+000176d0: 616c 6964 5f6d 6f64 6573 203d 205b 2277  alid_modes = ["w
+000176e0: 6172 6e22 2c20 2265 7272 6f72 222c 2022  arn", "error", "
+000176f0: 6967 6e6f 7265 225d 0a0a 2020 2020 6966  ignore"]..    if
+00017700: 206d 6f64 6520 3d3d 2022 6967 6e6f 7265   mode == "ignore
+00017710: 223a 0a20 2020 2020 2020 2072 6574 7572  ":.        retur
+00017720: 6e0a 2020 2020 656c 6966 206d 6f64 6520  n.    elif mode 
+00017730: 6e6f 7420 696e 2076 616c 6964 5f6d 6f64  not in valid_mod
+00017740: 6573 3a0a 2020 2020 2020 2020 7261 6973  es:.        rais
+00017750: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00017760: 2020 2020 2020 2020 2020 6622 7b6d 6f64            f"{mod
+00017770: 657d 2069 7320 6e6f 7420 6120 7661 6c69  e} is not a vali
+00017780: 6420 7661 6c75 6520 666f 7220 6f6e 5f75  d value for on_u
+00017790: 6e63 6163 6865 645f 636f 6d70 6f6e 656e  ncached_componen
+000177a0: 742e 2054 7279 206f 6e65 206f 6620 7468  t. Try one of th
+000177b0: 6573 653a 207b 7661 6c69 645f 6d6f 6465  ese: {valid_mode
+000177c0: 737d 2e22 0a20 2020 2020 2020 2029 0a0a  s}.".        )..
+000177d0: 2020 2020 666f 7220 7375 625f 636f 6d70      for sub_comp
+000177e0: 6f6e 656e 7420 696e 2063 6f6d 706f 6e65  onent in compone
+000177f0: 6e74 2e67 6574 5f64 6570 656e 6465 6e63  nt.get_dependenc
+00017800: 6965 7328 7265 6375 7273 6976 653d 5472  ies(recursive=Tr
+00017810: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
+00017820: 6e6f 7420 7375 625f 636f 6d70 6f6e 656e  not sub_componen
+00017830: 742e 5f6c 6f63 6b65 643a 0a20 2020 2020  t._locked:.     
+00017840: 2020 2020 2020 206d 6573 7361 6765 203d         message =
+00017850: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00017860: 2020 2066 2243 6f6d 706f 6e65 6e74 207b     f"Component {
+00017870: 7375 625f 636f 6d70 6f6e 656e 742e 6e61  sub_component.na
+00017880: 6d65 2172 7d20 7761 7320 4e4f 5420 7072  me!r} was NOT pr
+00017890: 6f70 6572 6c79 206c 6f63 6b65 642e 2022  operly locked. "
+000178a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000178b0: 2022 596f 7520 6e65 6564 2074 6f20 7772   "You need to wr
+000178c0: 6974 6520 6974 2069 6e74 6f20 6120 6675  ite it into a fu
+000178d0: 6e63 7469 6f6e 2074 6861 7420 6861 7320  nction that has 
+000178e0: 7468 6520 4063 656c 6c20 6465 636f 7261  the @cell decora
+000178f0: 746f 722e 220a 2020 2020 2020 2020 2020  tor.".          
+00017900: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00017910: 6966 206d 6f64 6520 3d3d 2022 7761 726e  if mode == "warn
+00017920: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00017930: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00017940: 286d 6573 7361 6765 2c20 556e 6361 6368  (message, Uncach
+00017950: 6564 436f 6d70 6f6e 656e 7457 6172 6e69  edComponentWarni
+00017960: 6e67 2c20 7374 6163 6b6c 6576 656c 3d33  ng, stacklevel=3
+00017970: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00017980: 6c69 6620 6d6f 6465 203d 3d20 2265 7272  lif mode == "err
+00017990: 6f72 223a 0a20 2020 2020 2020 2020 2020  or":.           
+000179a0: 2020 2020 2072 6169 7365 2055 6e63 6163       raise Uncac
+000179b0: 6865 6443 6f6d 706f 6e65 6e74 4572 726f  hedComponentErro
+000179c0: 7228 6d65 7373 6167 6529 0a0a 0a64 6566  r(message)...def
+000179d0: 2074 6573 745f 7361 6d65 5f75 6964 2829   test_same_uid()
+000179e0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 696d   -> None:.    im
+000179f0: 706f 7274 2067 6473 6661 6374 6f72 7920  port gdsfactory 
+00017a00: 6173 2067 660a 0a20 2020 2063 203d 2043  as gf..    c = C
+00017a10: 6f6d 706f 6e65 6e74 2829 0a20 2020 2063  omponent().    c
+00017a20: 203c 3c20 6766 2e63 6f6d 706f 6e65 6e74   << gf.component
+00017a30: 732e 7265 6374 616e 676c 6528 290a 2020  s.rectangle().  
+00017a40: 2020 6320 3c3c 2067 662e 636f 6d70 6f6e    c << gf.compon
+00017a50: 656e 7473 2e72 6563 7461 6e67 6c65 2829  ents.rectangle()
+00017a60: 0a0a 2020 2020 7231 203d 2063 2e72 6566  ..    r1 = c.ref
+00017a70: 6572 656e 6365 735b 305d 2e70 6172 656e  erences[0].paren
+00017a80: 740a 2020 2020 7232 203d 2063 2e72 6566  t.    r2 = c.ref
+00017a90: 6572 656e 6365 735b 315d 2e70 6172 656e  erences[1].paren
+00017aa0: 740a 0a20 2020 2061 7373 6572 7420 7231  t..    assert r1
+00017ab0: 2e75 6964 203d 3d20 7232 2e75 6964 2c20  .uid == r2.uid, 
+00017ac0: 6622 7b72 312e 7569 647d 206d 7573 7420  f"{r1.uid} must 
+00017ad0: 6571 7561 6c20 7b72 322e 7569 647d 220a  equal {r2.uid}".
+00017ae0: 0a0a 6465 6620 7465 7374 5f6e 6574 6c69  ..def test_netli
+00017af0: 7374 5f73 696d 706c 6528 2920 2d3e 204e  st_simple() -> N
+00017b00: 6f6e 653a 0a20 2020 2069 6d70 6f72 7420  one:.    import 
+00017b10: 6764 7366 6163 746f 7279 2061 7320 6766  gdsfactory as gf
+00017b20: 0a0a 2020 2020 6320 3d20 6766 2e43 6f6d  ..    c = gf.Com
+00017b30: 706f 6e65 6e74 2829 0a20 2020 2063 3120  ponent().    c1 
+00017b40: 3d20 6320 3c3c 2067 662e 636f 6d70 6f6e  = c << gf.compon
+00017b50: 656e 7473 2e73 7472 6169 6768 7428 6c65  ents.straight(le
+00017b60: 6e67 7468 3d31 2c20 7769 6474 683d 3229  ngth=1, width=2)
+00017b70: 0a20 2020 2063 3220 3d20 6320 3c3c 2067  .    c2 = c << g
+00017b80: 662e 636f 6d70 6f6e 656e 7473 2e73 7472  f.components.str
+00017b90: 6169 6768 7428 6c65 6e67 7468 3d32 2c20  aight(length=2, 
+00017ba0: 7769 6474 683d 3229 0a20 2020 2063 322e  width=2).    c2.
+00017bb0: 636f 6e6e 6563 7428 706f 7274 3d22 6f31  connect(port="o1
+00017bc0: 222c 2064 6573 7469 6e61 7469 6f6e 3d63  ", destination=c
+00017bd0: 312e 706f 7274 735b 226f 3222 5d29 0a20  1.ports["o2"]). 
+00017be0: 2020 2063 2e61 6464 5f70 6f72 7428 226f     c.add_port("o
+00017bf0: 3122 2c20 706f 7274 3d63 312e 706f 7274  1", port=c1.port
+00017c00: 735b 226f 3122 5d29 0a20 2020 2063 2e61  s["o1"]).    c.a
+00017c10: 6464 5f70 6f72 7428 226f 3222 2c20 706f  dd_port("o2", po
+00017c20: 7274 3d63 322e 706f 7274 735b 226f 3222  rt=c2.ports["o2"
+00017c30: 5d29 0a20 2020 206e 6574 6c69 7374 203d  ]).    netlist =
+00017c40: 2063 2e67 6574 5f6e 6574 6c69 7374 2829   c.get_netlist()
+00017c50: 0a20 2020 2023 2070 7269 6e74 286e 6574  .    # print(net
+00017c60: 6c69 7374 2e70 7265 7474 7928 2929 0a20  list.pretty()). 
+00017c70: 2020 2061 7373 6572 7420 6c65 6e28 6e65     assert len(ne
+00017c80: 746c 6973 745b 2269 6e73 7461 6e63 6573  tlist["instances
+00017c90: 225d 2920 3d3d 2032 0a0a 0a64 6566 2074  "]) == 2...def t
+00017ca0: 6573 745f 6e65 746c 6973 745f 7369 6d70  est_netlist_simp
+00017cb0: 6c65 5f77 6964 7468 5f6d 6973 6d61 7463  le_width_mismatc
+00017cc0: 685f 7468 726f 7773 5f65 7272 6f72 2829  h_throws_error()
+00017cd0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 696d   -> None:.    im
+00017ce0: 706f 7274 2070 7974 6573 740a 0a20 2020  port pytest..   
+00017cf0: 2069 6d70 6f72 7420 6764 7366 6163 746f   import gdsfacto
+00017d00: 7279 2061 7320 6766 0a0a 2020 2020 6320  ry as gf..    c 
+00017d10: 3d20 6766 2e43 6f6d 706f 6e65 6e74 2829  = gf.Component()
+00017d20: 0a20 2020 2063 3120 3d20 6320 3c3c 2067  .    c1 = c << g
+00017d30: 662e 636f 6d70 6f6e 656e 7473 2e73 7472  f.components.str
+00017d40: 6169 6768 7428 6c65 6e67 7468 3d31 2c20  aight(length=1, 
+00017d50: 7769 6474 683d 3129 0a20 2020 2063 3220  width=1).    c2 
+00017d60: 3d20 6320 3c3c 2067 662e 636f 6d70 6f6e  = c << gf.compon
+00017d70: 656e 7473 2e73 7472 6169 6768 7428 6c65  ents.straight(le
+00017d80: 6e67 7468 3d32 2c20 7769 6474 683d 3229  ngth=2, width=2)
+00017d90: 0a20 2020 2063 322e 636f 6e6e 6563 7428  .    c2.connect(
+00017da0: 706f 7274 3d22 6f31 222c 2064 6573 7469  port="o1", desti
+00017db0: 6e61 7469 6f6e 3d63 312e 706f 7274 735b  nation=c1.ports[
+00017dc0: 226f 3222 5d29 0a20 2020 2063 2e61 6464  "o2"]).    c.add
+00017dd0: 5f70 6f72 7428 226f 3122 2c20 706f 7274  _port("o1", port
+00017de0: 3d63 312e 706f 7274 735b 226f 3122 5d29  =c1.ports["o1"])
+00017df0: 0a20 2020 2063 2e61 6464 5f70 6f72 7428  .    c.add_port(
+00017e00: 226f 3222 2c20 706f 7274 3d63 322e 706f  "o2", port=c2.po
+00017e10: 7274 735b 226f 3222 5d29 0a20 2020 2077  rts["o2"]).    w
+00017e20: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00017e30: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
+00017e40: 2020 2020 2020 2063 2e67 6574 5f6e 6574         c.get_net
+00017e50: 6c69 7374 2829 0a0a 0a64 6566 2074 6573  list()...def tes
+00017e60: 745f 6e65 746c 6973 745f 636f 6d70 6c65  t_netlist_comple
+00017e70: 7828 2920 2d3e 204e 6f6e 653a 0a20 2020  x() -> None:.   
+00017e80: 2069 6d70 6f72 7420 6764 7366 6163 746f   import gdsfacto
+00017e90: 7279 2061 7320 6766 0a0a 2020 2020 6320  ry as gf..    c 
+00017ea0: 3d20 6766 2e63 6f6d 706f 6e65 6e74 732e  = gf.components.
+00017eb0: 6d7a 695f 6172 6d73 2829 0a20 2020 206e  mzi_arms().    n
+00017ec0: 6574 6c69 7374 203d 2063 2e67 6574 5f6e  etlist = c.get_n
+00017ed0: 6574 6c69 7374 2829 0a20 2020 2023 2070  etlist().    # p
+00017ee0: 7269 6e74 286e 6574 6c69 7374 2e70 7265  rint(netlist.pre
+00017ef0: 7474 7928 2929 0a20 2020 2061 7373 6572  tty()).    asser
+00017f00: 7420 6c65 6e28 6e65 746c 6973 745b 2269  t len(netlist["i
+00017f10: 6e73 7461 6e63 6573 225d 2920 3d3d 2034  nstances"]) == 4
+00017f20: 2c20 6c65 6e28 6e65 746c 6973 745b 2269  , len(netlist["i
+00017f30: 6e73 7461 6e63 6573 225d 290a 0a0a 6465  nstances"])...de
+00017f40: 6620 7465 7374 5f65 7874 7261 6374 2829  f test_extract()
+00017f50: 202d 3e20 436f 6d70 6f6e 656e 743a 0a20   -> Component:. 
+00017f60: 2020 2069 6d70 6f72 7420 6764 7366 6163     import gdsfac
+00017f70: 746f 7279 2061 7320 6766 0a0a 2020 2020  tory as gf..    
+00017f80: 6320 3d20 6766 2e63 6f6d 706f 6e65 6e74  c = gf.component
+00017f90: 732e 7374 7261 6967 6874 280a 2020 2020  s.straight(.    
+00017fa0: 2020 2020 6c65 6e67 7468 3d31 302c 0a20      length=10,. 
+00017fb0: 2020 2020 2020 2077 6964 7468 3d30 2e35         width=0.5
+00017fc0: 2c0a 2020 2020 2020 2020 6262 6f78 5f6c  ,.        bbox_l
+00017fd0: 6179 6572 733d 5b67 662e 4c41 5945 522e  ayers=[gf.LAYER.
+00017fe0: 5747 434c 4144 5d2c 0a20 2020 2020 2020  WGCLAD],.       
+00017ff0: 2062 626f 785f 6f66 6673 6574 733d 5b33   bbox_offsets=[3
+00018000: 5d2c 0a20 2020 2020 2020 2077 6974 685f  ],.        with_
+00018010: 6262 6f78 3d54 7275 652c 0a20 2020 2020  bbox=True,.     
+00018020: 2020 2063 6c61 6464 696e 675f 6c61 7965     cladding_laye
+00018030: 7273 3d4e 6f6e 652c 0a20 2020 2020 2020  rs=None,.       
+00018040: 2061 6464 5f70 696e 733d 4e6f 6e65 2c0a   add_pins=None,.
+00018050: 2020 2020 2020 2020 6164 645f 6262 6f78          add_bbox
+00018060: 3d4e 6f6e 652c 0a20 2020 2029 0a20 2020  =None,.    ).   
+00018070: 2063 3220 3d20 632e 6578 7472 6163 7428   c2 = c.extract(
+00018080: 6c61 7965 7273 3d5b 6766 2e4c 4159 4552  layers=[gf.LAYER
+00018090: 2e57 4743 4c41 445d 290a 0a20 2020 2061  .WGCLAD])..    a
+000180a0: 7373 6572 7420 6c65 6e28 632e 706f 6c79  ssert len(c.poly
+000180b0: 676f 6e73 2920 3d3d 2032 2c20 6c65 6e28  gons) == 2, len(
+000180c0: 632e 706f 6c79 676f 6e73 290a 2020 2020  c.polygons).    
+000180d0: 6173 7365 7274 206c 656e 2863 322e 706f  assert len(c2.po
+000180e0: 6c79 676f 6e73 2920 3d3d 2031 2c20 6c65  lygons) == 1, le
+000180f0: 6e28 6332 2e70 6f6c 7967 6f6e 7329 0a20  n(c2.polygons). 
+00018100: 2020 2061 7373 6572 7420 6766 2e4c 4159     assert gf.LAY
+00018110: 4552 2e57 4743 4c41 4420 696e 2063 322e  ER.WGCLAD in c2.
+00018120: 6c61 7965 7273 0a20 2020 2072 6574 7572  layers.    retur
+00018130: 6e20 6332 0a0a 0a64 6566 2068 6173 685f  n c2...def hash_
+00018140: 6669 6c65 2866 696c 6570 6174 6829 3a0a  file(filepath):.
+00018150: 2020 2020 6d64 3520 3d20 6861 7368 6c69      md5 = hashli
+00018160: 622e 6d64 3528 290a 2020 2020 6d64 352e  b.md5().    md5.
+00018170: 7570 6461 7465 2866 696c 6570 6174 682e  update(filepath.
+00018180: 7265 6164 5f62 7974 6573 2829 290a 2020  read_bytes()).  
+00018190: 2020 7265 7475 726e 206d 6435 2e68 6578    return md5.hex
+000181a0: 6469 6765 7374 2829 0a0a 0a64 6566 2074  digest()...def t
+000181b0: 6573 745f 6262 6f78 5f72 6566 6572 656e  est_bbox_referen
+000181c0: 6365 2829 202d 3e20 436f 6d70 6f6e 656e  ce() -> Componen
+000181d0: 743a 0a20 2020 2069 6d70 6f72 7420 6764  t:.    import gd
+000181e0: 7366 6163 746f 7279 2061 7320 6766 0a0a  sfactory as gf..
+000181f0: 2020 2020 6320 3d20 6766 2e43 6f6d 706f      c = gf.Compo
+00018200: 6e65 6e74 2822 636f 6d70 6f6e 656e 745f  nent("component_
+00018210: 7769 7468 5f6f 6666 6772 6964 5f70 6f6c  with_offgrid_pol
+00018220: 7967 6f6e 7322 290a 2020 2020 6331 203d  ygons").    c1 =
+00018230: 2063 203c 3c20 6766 2e63 6f6d 706f 6e65   c << gf.compone
+00018240: 6e74 732e 7265 6374 616e 676c 6528 7369  nts.rectangle(si
+00018250: 7a65 3d28 312e 3565 2d33 2c20 312e 3565  ze=(1.5e-3, 1.5e
+00018260: 2d33 292c 2070 6f72 745f 7479 7065 3d4e  -3), port_type=N
+00018270: 6f6e 6529 0a20 2020 2063 3220 3d20 6320  one).    c2 = c 
+00018280: 3c3c 2067 662e 636f 6d70 6f6e 656e 7473  << gf.components
+00018290: 2e72 6563 7461 6e67 6c65 2873 697a 653d  .rectangle(size=
+000182a0: 2831 2e35 652d 332c 2031 2e35 652d 3329  (1.5e-3, 1.5e-3)
+000182b0: 2c20 706f 7274 5f74 7970 653d 4e6f 6e65  , port_type=None
+000182c0: 290a 2020 2020 6332 2e78 6d69 6e20 3d20  ).    c2.xmin = 
+000182d0: 6331 2e78 6d61 780a 0a20 2020 2061 7373  c1.xmax..    ass
+000182e0: 6572 7420 6332 2e78 7369 7a65 203d 3d20  ert c2.xsize == 
+000182f0: 3265 2d33 0a20 2020 2072 6574 7572 6e20  2e-3.    return 
+00018300: 6332 0a0a 0a64 6566 2074 6573 745f 6262  c2...def test_bb
+00018310: 6f78 5f63 6f6d 706f 6e65 6e74 2829 202d  ox_component() -
+00018320: 3e20 4e6f 6e65 3a0a 2020 2020 696d 706f  > None:.    impo
+00018330: 7274 2067 6473 6661 6374 6f72 7920 6173  rt gdsfactory as
+00018340: 2067 660a 0a20 2020 2063 203d 2067 662e   gf..    c = gf.
+00018350: 636f 6d70 6f6e 656e 7473 2e72 6563 7461  components.recta
+00018360: 6e67 6c65 2873 697a 653d 2831 2e35 652d  ngle(size=(1.5e-
+00018370: 332c 2031 2e35 652d 3329 2c20 706f 7274  3, 1.5e-3), port
+00018380: 5f74 7970 653d 4e6f 6e65 290a 2020 2020  _type=None).    
+00018390: 6173 7365 7274 2063 2e78 7369 7a65 203d  assert c.xsize =
+000183a0: 3d20 3265 2d33 0a0a 0a64 6566 2074 6573  = 2e-3...def tes
+000183b0: 745f 7265 6d61 705f 6c61 7965 7273 2829  t_remap_layers()
+000183c0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 696d   -> None:.    im
+000183d0: 706f 7274 2067 6473 6661 6374 6f72 7920  port gdsfactory 
+000183e0: 6173 2067 660a 0a20 2020 2063 203d 2067  as gf..    c = g
+000183f0: 662e 636f 6d70 6f6e 656e 7473 2e73 7472  f.components.str
+00018400: 6169 6768 7428 6c61 7965 723d 2832 2c20  aight(layer=(2, 
+00018410: 3029 290a 2020 2020 7265 6d61 7020 3d20  0)).    remap = 
+00018420: 632e 7265 6d61 705f 6c61 7965 7273 286c  c.remap_layers(l
+00018430: 6179 6572 6d61 703d 7b28 322c 2030 293a  ayermap={(2, 0):
+00018440: 2067 662e 4c41 5945 522e 5747 4e7d 290a   gf.LAYER.WGN}).
+00018450: 2020 2020 6861 7368 5f67 656f 6d65 7472      hash_geometr
+00018460: 7920 3d20 2233 3263 6431 3465 6137 6365  y = "32cd14ea7ce
+00018470: 3133 6366 3166 3433 3032 3737 6234 3530  13cf1f430277b450
+00018480: 3534 6130 6137 3930 3961 3363 3422 0a0a  54a0a7909a3c4"..
+00018490: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
+000184a0: 2020 2020 2072 656d 6170 2e68 6173 685f       remap.hash_
+000184b0: 6765 6f6d 6574 7279 2829 203d 3d20 6861  geometry() == ha
+000184c0: 7368 5f67 656f 6d65 7472 790a 2020 2020  sh_geometry.    
+000184d0: 292c 2066 2268 6173 685f 6765 6f6d 6574  ), f"hash_geomet
+000184e0: 7279 203d 207b 7265 6d61 702e 6861 7368  ry = {remap.hash
+000184f0: 5f67 656f 6d65 7472 7928 2921 727d 220a  _geometry()!r}".
+00018500: 0a0a 6465 6620 7465 7374 5f72 656d 6f76  ..def test_remov
+00018510: 655f 6c61 6265 6c73 2829 202d 3e20 4e6f  e_labels() -> No
+00018520: 6e65 3a0a 2020 2020 696d 706f 7274 2067  ne:.    import g
+00018530: 6473 6661 6374 6f72 7920 6173 2067 660a  dsfactory as gf.
+00018540: 0a20 2020 2063 203d 2067 662e 632e 7374  .    c = gf.c.st
+00018550: 7261 6967 6874 2829 0a20 2020 2063 2e72  raight().    c.r
+00018560: 656d 6f76 655f 6c61 6265 6c73 2829 0a0a  emove_labels()..
+00018570: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00018580: 2e6c 6162 656c 7329 203d 3d20 300a 0a0a  .labels) == 0...
+00018590: 6465 6620 7465 7374 5f69 6d70 6f72 745f  def test_import_
+000185a0: 6764 735f 7365 7474 696e 6773 2829 202d  gds_settings() -
+000185b0: 3e20 4e6f 6e65 3a0a 2020 2020 696d 706f  > None:.    impo
+000185c0: 7274 2067 6473 6661 6374 6f72 7920 6173  rt gdsfactory as
+000185d0: 2067 660a 0a20 2020 2063 203d 2067 662e   gf..    c = gf.
+000185e0: 636f 6d70 6f6e 656e 7473 2e6d 7a69 2829  components.mzi()
+000185f0: 0a20 2020 2067 6473 7061 7468 203d 2063  .    gdspath = c
+00018600: 2e77 7269 7465 5f67 6473 5f77 6974 685f  .write_gds_with_
+00018610: 6d65 7461 6461 7461 2829 0a20 2020 2063  metadata().    c
+00018620: 3220 3d20 6766 2e69 6d70 6f72 745f 6764  2 = gf.import_gd
+00018630: 7328 6764 7370 6174 682c 206e 616d 653d  s(gdspath, name=
+00018640: 226d 7a69 5f73 616d 706c 6522 2c20 7265  "mzi_sample", re
+00018650: 6164 5f6d 6574 6164 6174 613d 5472 7565  ad_metadata=True
+00018660: 290a 2020 2020 6333 203d 2067 662e 726f  ).    c3 = gf.ro
+00018670: 7574 696e 672e 6164 645f 6669 6265 725f  uting.add_fiber_
+00018680: 7369 6e67 6c65 2863 3229 0a20 2020 2061  single(c2).    a
+00018690: 7373 6572 7420 6333 0a0a 0a64 6566 2074  ssert c3...def t
+000186a0: 6573 745f 666c 6174 7465 6e5f 696e 7661  est_flatten_inva
+000186b0: 6c69 645f 7265 6673 5f72 6563 7572 7369  lid_refs_recursi
+000186c0: 7665 2829 202d 3e20 4e6f 6e65 3a0a 2020  ve() -> None:.  
+000186d0: 2020 696d 706f 7274 2067 6473 6661 6374    import gdsfact
+000186e0: 6f72 7920 6173 2067 660a 2020 2020 6672  ory as gf.    fr
+000186f0: 6f6d 2067 6473 6661 6374 6f72 792e 6469  om gdsfactory.di
+00018700: 6666 7465 7374 2069 6d70 6f72 7420 7275  fftest import ru
+00018710: 6e5f 786f 720a 2020 2020 6672 6f6d 2067  n_xor.    from g
+00018720: 6473 6661 6374 6f72 792e 726f 7574 696e  dsfactory.routin
+00018730: 672e 616c 6c5f 616e 676c 6520 696d 706f  g.all_angle impo
+00018740: 7274 2067 6574 5f62 756e 646c 655f 616c  rt get_bundle_al
+00018750: 6c5f 616e 676c 650a 0a20 2020 2040 6766  l_angle..    @gf
+00018760: 2e63 656c 6c0a 2020 2020 6465 6620 666c  .cell.    def fl
+00018770: 6174 2829 3a0a 2020 2020 2020 2020 6320  at():.        c 
+00018780: 3d20 6766 2e43 6f6d 706f 6e65 6e74 2829  = gf.Component()
+00018790: 0a20 2020 2020 2020 206d 6d69 3120 3d20  .        mmi1 = 
+000187a0: 2863 203c 3c20 6766 2e63 6f6d 706f 6e65  (c << gf.compone
+000187b0: 6e74 732e 6d6d 6931 7832 2829 292e 6d6f  nts.mmi1x2()).mo
+000187c0: 7665 2828 302c 202d 312e 3030 3035 2929  ve((0, -1.0005))
+000187d0: 0a20 2020 2020 2020 206d 6d69 3220 3d20  .        mmi2 = 
+000187e0: 2863 203c 3c20 6766 2e63 6f6d 706f 6e65  (c << gf.compone
+000187f0: 6e74 732e 6d6d 6931 7832 2829 292e 726f  nts.mmi1x2()).ro
+00018800: 7461 7465 2838 3029 0a20 2020 2020 2020  tate(80).       
+00018810: 206d 6d69 322e 6d6f 7665 2828 3430 2c20   mmi2.move((40, 
+00018820: 3230 2929 0a20 2020 2020 2020 2062 756e  20)).        bun
+00018830: 646c 6520 3d20 6765 745f 6275 6e64 6c65  dle = get_bundle
+00018840: 5f61 6c6c 5f61 6e67 6c65 285b 6d6d 6931  _all_angle([mmi1
+00018850: 2e70 6f72 7473 5b22 6f32 225d 5d2c 205b  .ports["o2"]], [
+00018860: 6d6d 6932 2e70 6f72 7473 5b22 6f31 225d  mmi2.ports["o1"]
+00018870: 5d29 0a20 2020 2020 2020 2066 6f72 2072  ]).        for r
+00018880: 6f75 7465 2069 6e20 6275 6e64 6c65 3a0a  oute in bundle:.
+00018890: 2020 2020 2020 2020 2020 2020 632e 6164              c.ad
+000188a0: 6428 726f 7574 652e 7265 6665 7265 6e63  d(route.referenc
+000188b0: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
+000188c0: 726e 2063 0a0a 2020 2020 4067 662e 6365  rn c..    @gf.ce
+000188d0: 6c6c 0a20 2020 2064 6566 2068 6965 7261  ll.    def hiera
+000188e0: 7263 6879 2829 3a0a 2020 2020 2020 2020  rchy():.        
+000188f0: 6320 3d20 6766 2e43 6f6d 706f 6e65 6e74  c = gf.Component
+00018900: 2829 0a20 2020 2020 2020 2028 6320 3c3c  ().        (c <<
+00018910: 2066 6c61 7428 2929 2e72 6f74 6174 6528   flat()).rotate(
+00018920: 3333 290a 2020 2020 2020 2020 2863 203c  33).        (c <
+00018930: 3c20 666c 6174 2829 292e 726f 7461 7465  < flat()).rotate
+00018940: 2833 3329 2e6d 6f76 6528 2830 2c20 3130  (33).move((0, 10
+00018950: 3029 290a 2020 2020 2020 2020 2863 203c  0)).        (c <
+00018960: 3c20 666c 6174 2829 292e 6d6f 7665 2828  < flat()).move((
+00018970: 3130 302c 2030 2929 0a20 2020 2020 2020  100, 0)).       
+00018980: 2072 6574 7572 6e20 630a 0a20 2020 2063   return c..    c
+00018990: 5f6f 7269 6720 3d20 6869 6572 6172 6368  _orig = hierarch
+000189a0: 7928 290a 2020 2020 635f 6e65 7720 3d20  y().    c_new = 
+000189b0: 666c 6174 7465 6e5f 696e 7661 6c69 645f  flatten_invalid_
+000189c0: 7265 6673 5f72 6563 7572 7369 7665 2863  refs_recursive(c
+000189d0: 5f6f 7269 6729 0a20 2020 2061 7373 6572  _orig).    asser
+000189e0: 7420 635f 6e65 7720 6973 206e 6f74 2063  t c_new is not c
+000189f0: 5f6f 7269 670a 2020 2020 696e 7661 6c69  _orig.    invali
+00018a00: 645f 7265 6673 5f66 696c 656e 616d 6520  d_refs_filename 
+00018a10: 3d20 2269 6e76 616c 6964 5f72 6566 732e  = "invalid_refs.
+00018a20: 6764 7322 0a20 2020 2069 6e76 616c 6964  gds".    invalid
+00018a30: 5f72 6566 735f 6669 7865 645f 6669 6c65  _refs_fixed_file
+00018a40: 6e61 6d65 203d 2022 696e 7661 6c69 645f  name = "invalid_
+00018a50: 7265 6673 5f66 6978 6564 2e67 6473 220a  refs_fixed.gds".
+00018a60: 2020 2020 2320 6764 7320 6669 6c65 7320      # gds files 
+00018a70: 7368 6f75 6c64 2073 7469 6c6c 2062 6520  should still be 
+00018a80: 7361 6d65 2074 6f20 316e 6d20 746f 6c65  same to 1nm tole
+00018a90: 7261 6e63 650a 2020 2020 635f 6f72 6967  rance.    c_orig
+00018aa0: 2e77 7269 7465 5f67 6473 2869 6e76 616c  .write_gds(inval
+00018ab0: 6964 5f72 6566 735f 6669 6c65 6e61 6d65  id_refs_filename
+00018ac0: 290a 2020 2020 635f 6e65 772e 7772 6974  ).    c_new.writ
+00018ad0: 655f 6764 7328 696e 7661 6c69 645f 7265  e_gds(invalid_re
+00018ae0: 6673 5f66 6978 6564 5f66 696c 656e 616d  fs_fixed_filenam
+00018af0: 6529 0a20 2020 2072 756e 5f78 6f72 2869  e).    run_xor(i
+00018b00: 6e76 616c 6964 5f72 6566 735f 6669 6c65  nvalid_refs_file
+00018b10: 6e61 6d65 2c20 696e 7661 6c69 645f 7265  name, invalid_re
+00018b20: 6673 5f66 6978 6564 5f66 696c 656e 616d  fs_fixed_filenam
+00018b30: 6529 0a0a 0a69 6620 5f5f 6e61 6d65 5f5f  e)...if __name__
+00018b40: 203d 3d20 225f 5f6d 6169 6e5f 5f22 3a0a   == "__main__":.
+00018b50: 2020 2020 2320 696d 706f 7274 2067 6473      # import gds
+00018b60: 6661 6374 6f72 7920 6173 2067 660a 0a20  factory as gf.. 
+00018b70: 2020 2074 6573 745f 7265 6d61 705f 6c61     test_remap_la
+00018b80: 7965 7273 2829 0a20 2020 2023 2063 203d  yers().    # c =
+00018b90: 2067 662e 436f 6d70 6f6e 656e 7428 290a   gf.Component().
+00018ba0: 2020 2020 2320 7020 3d20 632e 6164 645f      # p = c.add_
+00018bb0: 706f 6c79 676f 6e28 0a20 2020 2023 2020  polygon(.    #  
+00018bc0: 2020 205b 282d 382c 2036 2c20 372c 2039     [(-8, 6, 7, 9
+00018bd0: 292c 2028 2d36 2c20 382c 2031 372c 2035  ), (-6, 8, 17, 5
+00018be0: 295d 2c20 6c61 7965 723d 2831 2c20 3029  )], layer=(1, 0)
+00018bf0: 0a20 2020 2023 2029 2020 2320 4744 5320  .    # )  # GDS 
+00018c00: 6c61 7965 7273 2061 7265 2074 7570 6c65  layers are tuple
+00018c10: 7320 6f66 2069 6e74 7320 2862 7574 2069  s of ints (but i
+00018c20: 6620 7765 2075 7365 206f 6e6c 7920 6f6e  f we use only on
+00018c30: 6520 6e75 6d62 6572 2069 7420 6173 7375  e number it assu
+00018c40: 6d65 7320 7468 6520 6f74 6865 7220 6e75  mes the other nu
+00018c50: 6d62 6572 2069 7320 3029 0a0a 2020 2020  mber is 0)..    
+00018c60: 2320 6332 203d 2067 662e 436f 6d70 6f6e  # c2 = gf.Compon
+00018c70: 656e 7428 290a 2020 2020 2320 6320 3d20  ent().    # c = 
+00018c80: 6766 2e63 6f6d 706f 6e65 6e74 732e 6d7a  gf.components.mz
+00018c90: 6928 290a 2020 2020 2320 7072 696e 7428  i().    # print(
+00018ca0: 632e 6765 745f 6c61 7965 725f 6e61 6d65  c.get_layer_name
+00018cb0: 7328 2929 0a20 2020 2023 2063 203d 2067  s()).    # c = g
+00018cc0: 662e 636f 6d70 6f6e 656e 7473 2e6d 7a69  f.components.mzi
+00018cd0: 2829 0a20 2020 2023 2070 7269 6e74 2863  ().    # print(c
+00018ce0: 2e67 6574 5f6c 6179 6572 5f6e 616d 6573  .get_layer_names
+00018cf0: 2829 290a 2020 2020 2320 7220 3d20 632e  ()).    # r = c.
+00018d00: 7265 6628 290a 2020 2020 2320 6332 2e63  ref().    # c2.c
+00018d10: 6f70 795f 6368 696c 645f 696e 666f 2863  opy_child_info(c
+00018d20: 2e6e 616d 6564 5f72 6566 6572 656e 6365  .named_reference
+00018d30: 735b 2273 7874 225d 290a 2020 2020 2320  s["sxt"]).    # 
+00018d40: 7465 7374 5f72 656d 6170 5f6c 6179 6572  test_remap_layer
+00018d50: 7328 290a 2020 2020 2320 6320 3d20 7465  s().    # c = te
+00018d60: 7374 5f67 6574 5f6c 6179 6572 7328 290a  st_get_layers().
+00018d70: 2020 2020 2320 632e 706c 6f74 5f71 7428      # c.plot_qt(
+00018d80: 290a 2020 2020 2320 632e 706c 6f74 6828  ).    # c.ploth(
+00018d90: 290a 2020 2020 2320 6320 3d20 7465 7374  ).    # c = test
+00018da0: 5f65 7874 7261 6374 2829 0a20 2020 2023  _extract().    #
+00018db0: 2067 6473 7061 7468 203d 2063 2e77 7269   gdspath = c.wri
+00018dc0: 7465 5f67 6473 2829 0a20 2020 2023 2067  te_gds().    # g
+00018dd0: 662e 7368 6f77 2867 6473 7061 7468 290a  f.show(gdspath).
+00018de0: 2020 2020 2320 632e 7368 6f77 2873 686f      # c.show(sho
+00018df0: 775f 706f 7274 733d 5472 7565 290a 2020  w_ports=True).  
+00018e00: 2020 2320 632e 7368 6f77 2829 0a           # c.show().
```

### Comparing `gdsfactory-6.97.0/gdsfactory/component_layout.py` & `gdsfactory-6.97.1/gdsfactory/component_layout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/component_reference.py` & `gdsfactory-6.97.1/gdsfactory/component_reference.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/C.py` & `gdsfactory-6.97.1/gdsfactory/components/C.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/L.py` & `gdsfactory-6.97.1/gdsfactory/components/L.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/__init__.py` & `gdsfactory-6.97.1/gdsfactory/components/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/add_fiducials.py` & `gdsfactory-6.97.1/gdsfactory/components/add_fiducials.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/add_grating_couplers.py` & `gdsfactory-6.97.1/gdsfactory/components/add_grating_couplers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/add_trenches.py` & `gdsfactory-6.97.1/gdsfactory/components/add_trenches.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/align.py` & `gdsfactory-6.97.1/gdsfactory/components/align.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/array_component.py` & `gdsfactory-6.97.1/gdsfactory/components/array_component.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/array_with_fanout.py` & `gdsfactory-6.97.1/gdsfactory/components/array_with_fanout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/array_with_via.py` & `gdsfactory-6.97.1/gdsfactory/components/array_with_via.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/awg.py` & `gdsfactory-6.97.1/gdsfactory/components/awg.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bbox.py` & `gdsfactory-6.97.1/gdsfactory/components/bbox.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bend_circular.py` & `gdsfactory-6.97.1/gdsfactory/components/bend_circular.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bend_circular_heater.py` & `gdsfactory-6.97.1/gdsfactory/components/bend_circular_heater.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bend_euler.py` & `gdsfactory-6.97.1/gdsfactory/components/bend_euler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bend_port.py` & `gdsfactory-6.97.1/gdsfactory/components/bend_port.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bend_s.py` & `gdsfactory-6.97.1/gdsfactory/components/bend_s.py`

 * *Files 6% similar despite different names*

```diff
@@ -61,22 +61,24 @@
 
     return c
 
 
 def get_min_sbend_size(
     size: Float2 = (None, 10.0),
     cross_section: CrossSectionSpec = "strip",
+    num_points: int = 100,
     **kwargs,
 ):
     """
     Returns the minimum sbend size to comply with bend radius requirements.
 
      Args:
         size: in x and y direction. One of them is None, which is the size we need to figure out.
         cross_section: spec.
+        num_points: number of points to iterate over between max_size and 0.1 * max_size
         kwargs: cross_section settings.
 
     """
 
     cross_section_f = gf.get_cross_section(cross_section, **kwargs)
 
     if size[0] is None:
@@ -95,15 +97,15 @@
 
     min_size = np.inf
 
     # Guess sizes, iterate over them until we cannot achieve the min radius
     # the max size corresponds to an ellipsoid
     max_size = 2.5 * np.sqrt(np.abs(min_radius * known_s))
 
-    sizes = np.linspace(max_size, 0.1 * max_size, 100)
+    sizes = np.linspace(max_size, 0.1 * max_size, num_points)
 
     for i, s in enumerate(sizes):
         sz = copy.deepcopy(size)
         sz[ind] = s
         # print(sz)
         try:
             bend_s(
```

### Comparing `gdsfactory-6.97.0/gdsfactory/components/bezier.py` & `gdsfactory-6.97.1/gdsfactory/components/bezier.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cavity.py` & `gdsfactory-6.97.1/gdsfactory/components/cavity.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdc.py` & `gdsfactory-6.97.1/gdsfactory/components/cdc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdsem_all.py` & `gdsfactory-6.97.1/gdsfactory/components/cdsem_all.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdsem_bend180.py` & `gdsfactory-6.97.1/gdsfactory/components/cdsem_bend180.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdsem_coupler.py` & `gdsfactory-6.97.1/gdsfactory/components/cdsem_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdsem_straight.py` & `gdsfactory-6.97.1/gdsfactory/components/cdsem_straight.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cdsem_straight_density.py` & `gdsfactory-6.97.1/gdsfactory/components/cdsem_straight_density.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/circle.py` & `gdsfactory-6.97.1/gdsfactory/components/circle.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coh_rx_dual_pol.py` & `gdsfactory-6.97.1/gdsfactory/components/coh_rx_dual_pol.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coh_rx_single_pol.py` & `gdsfactory-6.97.1/gdsfactory/components/coh_rx_single_pol.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coh_tx_dual_pol.py` & `gdsfactory-6.97.1/gdsfactory/components/coh_tx_dual_pol.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coh_tx_single_pol.py` & `gdsfactory-6.97.1/gdsfactory/components/coh_tx_single_pol.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/compass.py` & `gdsfactory-6.97.1/gdsfactory/components/compass.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/component_lattice.py` & `gdsfactory-6.97.1/gdsfactory/components/component_lattice.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/component_sequence.py` & `gdsfactory-6.97.1/gdsfactory/components/component_sequence.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/copy_layers.py` & `gdsfactory-6.97.1/gdsfactory/components/copy_layers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler90.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler90.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler90bend.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler90bend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_adiabatic.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_adiabatic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_asymmetric.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_asymmetric.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_full.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_full.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_ring.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_straight.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_straight.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_straight_asymmetric.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_straight_asymmetric.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/coupler_symmetric.py` & `gdsfactory-6.97.1/gdsfactory/components/coupler_symmetric.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cross.py` & `gdsfactory-6.97.1/gdsfactory/components/cross.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/crossing_waveguide.py` & `gdsfactory-6.97.1/gdsfactory/components/crossing_waveguide.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/grating_coupler_2etch_h220_e70_e220.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/grating_coupler_2etch_h220_e70_e220.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_100.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_100.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_150.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_150.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_10_200.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_10_200.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_11_200.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_11_200.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_12_200.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_12_200.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/csv_data/taper_strip_0p5_3_36.csv` & `gdsfactory-6.97.1/gdsfactory/components/csv_data/taper_strip_0p5_3_36.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cutback_2x2.py` & `gdsfactory-6.97.1/gdsfactory/components/cutback_2x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cutback_bend.py` & `gdsfactory-6.97.1/gdsfactory/components/cutback_bend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cutback_component.py` & `gdsfactory-6.97.1/gdsfactory/components/cutback_component.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/cutback_splitter.py` & `gdsfactory-6.97.1/gdsfactory/components/cutback_splitter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/dbr.py` & `gdsfactory-6.97.1/gdsfactory/components/dbr.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/dbr_tapered.py` & `gdsfactory-6.97.1/gdsfactory/components/dbr_tapered.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/delay_snake.py` & `gdsfactory-6.97.1/gdsfactory/components/delay_snake.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/delay_snake2.py` & `gdsfactory-6.97.1/gdsfactory/components/delay_snake2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/delay_snake3.py` & `gdsfactory-6.97.1/gdsfactory/components/delay_snake3.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/delay_snake_sbend.py` & `gdsfactory-6.97.1/gdsfactory/components/delay_snake_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/dicing_lane.py` & `gdsfactory-6.97.1/gdsfactory/components/dicing_lane.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/die.py` & `gdsfactory-6.97.1/gdsfactory/components/die.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/die_bbox.py` & `gdsfactory-6.97.1/gdsfactory/components/die_bbox.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/die_bbox_frame.py` & `gdsfactory-6.97.1/gdsfactory/components/die_bbox_frame.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/disk.py` & `gdsfactory-6.97.1/gdsfactory/components/disk.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/edge_coupler_array.py` & `gdsfactory-6.97.1/gdsfactory/components/edge_coupler_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ellipse.py` & `gdsfactory-6.97.1/gdsfactory/components/ellipse.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/extend_ports_list.py` & `gdsfactory-6.97.1/gdsfactory/components/extend_ports_list.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/extension.py` & `gdsfactory-6.97.1/gdsfactory/components/extension.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/fiber.py` & `gdsfactory-6.97.1/gdsfactory/components/fiber.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/fiber_array.py` & `gdsfactory-6.97.1/gdsfactory/components/fiber_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/fiducial_squares.py` & `gdsfactory-6.97.1/gdsfactory/components/fiducial_squares.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ge_detector_straight_si_contacts.py` & `gdsfactory-6.97.1/gdsfactory/components/ge_detector_straight_si_contacts.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_array.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_dual_pol.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_dual_pol.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_arbitrary.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_arbitrary.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_lumerical.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_lumerical.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_elliptical_trenches.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_elliptical_trenches.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_functions.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_functions.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_loss.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_loss.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_loss_fiber_single.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_loss_fiber_single.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular_arbitrary.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular_arbitrary.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_rectangular_arbitrary_slab.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_rectangular_arbitrary_slab.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/grating_coupler_tree.py` & `gdsfactory-6.97.1/gdsfactory/components/grating_coupler_tree.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/greek_cross.py` & `gdsfactory-6.97.1/gdsfactory/components/greek_cross.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/hline.py` & `gdsfactory-6.97.1/gdsfactory/components/hline.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/interdigital_capacitor.py` & `gdsfactory-6.97.1/gdsfactory/components/interdigital_capacitor.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/litho_calipers.py` & `gdsfactory-6.97.1/gdsfactory/components/litho_calipers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/litho_ruler.py` & `gdsfactory-6.97.1/gdsfactory/components/litho_ruler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/litho_steps.py` & `gdsfactory-6.97.1/gdsfactory/components/litho_steps.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/logo.py` & `gdsfactory-6.97.1/gdsfactory/components/logo.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/loop_mirror.py` & `gdsfactory-6.97.1/gdsfactory/components/loop_mirror.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mmi1x2.py` & `gdsfactory-6.97.1/gdsfactory/components/mmi1x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mmi1x2_with_sbend.py` & `gdsfactory-6.97.1/gdsfactory/components/mmi1x2_with_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mmi2x2.py` & `gdsfactory-6.97.1/gdsfactory/components/mmi2x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mmi2x2_with_sbend.py` & `gdsfactory-6.97.1/gdsfactory/components/mmi2x2_with_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mmi_90degree_hybrid.py` & `gdsfactory-6.97.1/gdsfactory/components/mmi_90degree_hybrid.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mode_converter.py` & `gdsfactory-6.97.1/gdsfactory/components/mode_converter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi_arm.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi_arm.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi_arms.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi_arms.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi_lattice.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi_lattice.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi_pads_center.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi_pads_center.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzi_phase_shifter.py` & `gdsfactory-6.97.1/gdsfactory/components/mzi_phase_shifter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzit.py` & `gdsfactory-6.97.1/gdsfactory/components/mzit.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzit_lattice.py` & `gdsfactory-6.97.1/gdsfactory/components/mzit_lattice.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/mzm.py` & `gdsfactory-6.97.1/gdsfactory/components/mzm.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/nxn.py` & `gdsfactory-6.97.1/gdsfactory/components/nxn.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/optimal_90deg.py` & `gdsfactory-6.97.1/gdsfactory/components/optimal_90deg.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/optimal_hairpin.py` & `gdsfactory-6.97.1/gdsfactory/components/optimal_hairpin.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/optimal_step.py` & `gdsfactory-6.97.1/gdsfactory/components/optimal_step.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/pack_doe.py` & `gdsfactory-6.97.1/gdsfactory/components/pack_doe.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/pad.py` & `gdsfactory-6.97.1/gdsfactory/components/pad.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/pad_gsg.py` & `gdsfactory-6.97.1/gdsfactory/components/pad_gsg.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/pads_shorted.py` & `gdsfactory-6.97.1/gdsfactory/components/pads_shorted.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/polarization_splitter_rotator.py` & `gdsfactory-6.97.1/gdsfactory/components/polarization_splitter_rotator.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ramp.py` & `gdsfactory-6.97.1/gdsfactory/components/ramp.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/rectangle.py` & `gdsfactory-6.97.1/gdsfactory/components/rectangle.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/rectangle_with_slits.py` & `gdsfactory-6.97.1/gdsfactory/components/rectangle_with_slits.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/regular_polygon.py` & `gdsfactory-6.97.1/gdsfactory/components/regular_polygon.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/resistance_meander.py` & `gdsfactory-6.97.1/gdsfactory/components/resistance_meander.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/resistance_sheet.py` & `gdsfactory-6.97.1/gdsfactory/components/resistance_sheet.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring.py` & `gdsfactory-6.97.1/gdsfactory/components/ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_crow.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_crow.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_crow_couplers.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_crow_couplers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_double.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_double.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_double_bend_coupler.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_double_bend_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_double_heater.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_double_heater.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_double_pn.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_double_pn.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_section_based.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_section_based.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single_array.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single_bend_coupler.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single_bend_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single_dut.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single_dut.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single_heater.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single_heater.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/ring_single_pn.py` & `gdsfactory-6.97.1/gdsfactory/components/ring_single_pn.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/seal_ring.py` & `gdsfactory-6.97.1/gdsfactory/components/seal_ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/snspd.py` & `gdsfactory-6.97.1/gdsfactory/components/snspd.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/spiral_double.py` & `gdsfactory-6.97.1/gdsfactory/components/spiral_double.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/spiral_external_io.py` & `gdsfactory-6.97.1/gdsfactory/components/spiral_external_io.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/spiral_heater.py` & `gdsfactory-6.97.1/gdsfactory/components/spiral_heater.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/spiral_inner_io.py` & `gdsfactory-6.97.1/gdsfactory/components/spiral_inner_io.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/splitter_chain.py` & `gdsfactory-6.97.1/gdsfactory/components/splitter_chain.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/splitter_tree.py` & `gdsfactory-6.97.1/gdsfactory/components/splitter_tree.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight.py` & `gdsfactory-6.97.1/gdsfactory/components/straight.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,14 +1,13 @@
 """Straight waveguide."""
 from __future__ import annotations
 
 import gdsfactory as gf
 from gdsfactory.add_padding import get_padding_points
 from gdsfactory.component import Component
-from gdsfactory.snap import snap_to_grid
 from gdsfactory.typings import CrossSectionSpec
 
 
 @gf.cell
 def straight(
     length: float = 10.0,
     npoints: int = 2,
@@ -26,15 +25,14 @@
         kwargs: cross_section settings.
 
     .. code::
 
         o1 -------------- o2
                 length
     """
-    length = snap_to_grid(length)
     p = gf.path.straight(length=length, npoints=npoints)
     x = gf.get_cross_section(cross_section, **kwargs)
 
     c = Component()
     path = p.extrude(x)
     ref = c << path
     c.add_ports(ref.ports)
```

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_array.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_heater_doped_rib.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_heater_doped_rib.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_heater_doped_strip.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_heater_doped_strip.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_heater_meander.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_heater_meander.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_heater_meander_doped.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_heater_meander_doped.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_heater_metal.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_heater_metal.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_pin.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_pin.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_pin_slot.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_pin_slot.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/straight_rib.py` & `gdsfactory-6.97.1/gdsfactory/components/straight_rib.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/switch_tree.py` & `gdsfactory-6.97.1/gdsfactory/components/switch_tree.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/taper.py` & `gdsfactory-6.97.1/gdsfactory/components/taper.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/taper_adiabatic.py` & `gdsfactory-6.97.1/gdsfactory/components/taper_adiabatic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/taper_cross_section.py` & `gdsfactory-6.97.1/gdsfactory/components/taper_cross_section.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/taper_from_csv.py` & `gdsfactory-6.97.1/gdsfactory/components/taper_from_csv.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/taper_parabolic.py` & `gdsfactory-6.97.1/gdsfactory/components/taper_parabolic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/terminator.py` & `gdsfactory-6.97.1/gdsfactory/components/terminator.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/text.py` & `gdsfactory-6.97.1/gdsfactory/components/text.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/text_freetype.py` & `gdsfactory-6.97.1/gdsfactory/components/text_freetype.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/text_rectangular.py` & `gdsfactory-6.97.1/gdsfactory/components/text_rectangular.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/text_rectangular_font.py` & `gdsfactory-6.97.1/gdsfactory/components/text_rectangular_font.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/triangles.py` & `gdsfactory-6.97.1/gdsfactory/components/triangles.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/verniers.py` & `gdsfactory-6.97.1/gdsfactory/components/verniers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/version_stamp.py` & `gdsfactory-6.97.1/gdsfactory/components/version_stamp.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via.py` & `gdsfactory-6.97.1/gdsfactory/components/via.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via_corner.py` & `gdsfactory-6.97.1/gdsfactory/components/via_corner.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via_cutback.py` & `gdsfactory-6.97.1/gdsfactory/components/via_cutback.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via_stack.py` & `gdsfactory-6.97.1/gdsfactory/components/via_stack.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via_stack_slot.py` & `gdsfactory-6.97.1/gdsfactory/components/via_stack_slot.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/via_stack_with_offset.py` & `gdsfactory-6.97.1/gdsfactory/components/via_stack_with_offset.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/wafer.py` & `gdsfactory-6.97.1/gdsfactory/components/wafer.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/wire.py` & `gdsfactory-6.97.1/gdsfactory/components/wire.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/components/wire_sbend.py` & `gdsfactory-6.97.1/gdsfactory/components/wire_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/config.py` & `gdsfactory-6.97.1/gdsfactory/config.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 from loguru import logger
 import omegaconf
 from omegaconf import OmegaConf
 
 from rich.console import Console
 from rich.table import Table
 
-__version__ = "6.97.0"
+__version__ = "6.97.1"
 PathType = Union[str, pathlib.Path]
 
 home = pathlib.Path.home()
 cwd = pathlib.Path.cwd()
 module_path = pathlib.Path(__file__).parent.absolute()
 repo_path = module_path.parent
 home_path = pathlib.Path.home() / ".gdsfactory"
```

### Comparing `gdsfactory-6.97.0/gdsfactory/constants.py` & `gdsfactory-6.97.1/gdsfactory/constants.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/containers.py` & `gdsfactory-6.97.1/gdsfactory/containers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/cross_section.py` & `gdsfactory-6.97.1/gdsfactory/cross_section.py`

 * *Files 0% similar despite different names*

```diff
@@ -140,15 +140,15 @@
     auto_widen: bool = False
     auto_widen_minimum_length: float = 200.0
     taper_length: float = 10.0
     bbox_layers: List[LayerSpec] = Field(default_factory=list)
     bbox_offsets: List[float] = Field(default_factory=list)
     cladding_layers: Optional[LayerSpecs] = None
     cladding_offsets: Optional[Floats] = None
-    cladding_simplify: Optional[Floats] = (cladding_simplify_optical,)
+    cladding_simplify: Optional[Floats] = cladding_simplify_optical
     sections: List[Section] = Field(default_factory=list)
     port_names: Tuple[Optional[str], Optional[str]] = ("o1", "o2")
     port_types: Tuple[Optional[str], Optional[str]] = ("optical", "optical")
     gap: float = 3.0
     min_length: float = 10e-3
     start_straight_length: float = 10e-3
     end_straight_length: float = 10e-3
@@ -319,32 +319,36 @@
     """
 
     @functools.wraps(func)
     def _xsection(*args, **kwargs):
         xs = func(*args, **kwargs)
 
         sig = inspect.signature(func)
+
+        # Collect args passed into function into dict
         args_as_kwargs = dict(zip(sig.parameters.keys(), args))
-        args_as_kwargs.update(kwargs)
 
-        default = {
+        # Get settings from default arguments in function signature
+        settings = {
             p.name: p.default
             for p in sig.parameters.values()
             if p.default != inspect._empty
         }
 
-        args_as_kwargs.update(**default)
+        # Update with args and kwargs, overriding defaults
+        settings.update(args_as_kwargs)
+        settings.update(kwargs)
 
         if not isinstance(xs, CrossSection):
             raise ValueError(
                 f"function {func.__name__!r} return type = {type(xs)}",
                 "make sure that functions with @xsection decorator return a CrossSection",
             )
 
-        xs.info.update(settings=args_as_kwargs, function_name=func.__name__)
+        xs.info.update(settings=settings, function_name=func.__name__)
         return xs
 
     return _xsection
 
 
 _F = TypeVar("_F", bound=Callable)
```

### Comparing `gdsfactory-6.97.0/gdsfactory/decorators.py` & `gdsfactory-6.97.1/gdsfactory/decorators.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/difftest.py` & `gdsfactory-6.97.1/gdsfactory/difftest.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/events.py` & `gdsfactory-6.97.1/gdsfactory/events.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/export/to_3d.py` & `gdsfactory-6.97.1/gdsfactory/export/to_3d.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/export/to_np.py` & `gdsfactory-6.97.1/gdsfactory/export/to_np.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/export/to_stl.py` & `gdsfactory-6.97.1/gdsfactory/export/to_stl.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/export/write_gerbers.py` & `gdsfactory-6.97.1/gdsfactory/export/to_gerber.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 """
 Based on Gerber file spec:
 https://www.ucamco.com/files/downloads/file_en/456/gerber-layer-format-specification-revision-2022-02_en.pdf
 
 See Also:
-    https://github.com/opiopan/pcb-tools-extension
-    https://github.com/jamesbowman/cuflow/blob/master/gerber.py
+- https://github.com/opiopan/pcb-tools-extension
+- https://github.com/jamesbowman/cuflow/blob/master/gerber.py
 """
 from typing_extensions import Literal
 from typing import Optional, List, Dict, Tuple
 from pathlib import Path
 
 from pydantic import BaseModel, Field
 
@@ -59,27 +59,31 @@
     return "D10*\n" + points(pp)
 
 
 def polygon(pp):
     return "G36*\n" + points(pp) + "G37*\n" + "\n"
 
 
-def write_gerbers(
+def to_gerber(
     component: Component,
     dirpath: Path,
     layermap_to_gerber_layer: Dict[Tuple[int, int], GerberLayer],
     options: GerberOptions = Field(default_factory=dict),
 ) -> None:
-    """Writes each layer to a different file.
+    """Writes each layer to a different Gerber file.
 
     Args:
         component: to export.
         dirpath: directory path.
         layermap_to_gerber_layer: map of GDS layer to GerberLayer.
         options: to save.
+            header: Optional[List[str]] = None
+            mode: Literal["mm", "in"] = "mm"
+            resolution: float = 1e-6
+            int_size: int = 4
     """
     for layer_tup, layer in layermap_to_gerber_layer.items():
         filename = (dirpath / layer.name.replace(" ", "_")).with_suffix(".gbr")
         with open(filename, "w+") as f:
             header = options.header or [
                 "Gerber file generated by gdsfactory",
                 f"Component: {component.name}",
@@ -247,13 +251,13 @@
     c = LAYER_VIEWS.preview_layerset()
 
     gerber_path = PATH.repo / "extra" / "gerber"
 
     # This requires that the PCB technology (commented-out code above) is installed
     c.show(technology="PCB")
 
-    write_gerbers(
+    to_gerber(
         c,
         dirpath=gerber_path,
         layermap_to_gerber_layer=layermap_to_gerber,
         options=GerberOptions(resolution=1e-6),
     )
```

### Comparing `gdsfactory-6.97.0/gdsfactory/filestorage.py` & `gdsfactory-6.97.1/gdsfactory/filestorage.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/fill.py` & `gdsfactory-6.97.1/gdsfactory/fill.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/font.py` & `gdsfactory-6.97.1/gdsfactory/font.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/functions.py` & `gdsfactory-6.97.1/gdsfactory/functions.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/gdsdiff/gds_diff_git.py` & `gdsfactory-6.97.1/gdsfactory/gdsdiff/gds_diff_git.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/gdsdiff/gdsdiff.py` & `gdsfactory-6.97.1/gdsfactory/gdsdiff/gdsdiff.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/gdsdiff/install.py` & `gdsfactory-6.97.1/gdsfactory/gdsdiff/install.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/gdsdiff/test_xor.py` & `gdsfactory-6.97.1/gdsfactory/gdsdiff/test_xor.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/README.md` & `gdsfactory-6.97.1/gdsfactory/generic_tech/README.md`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/__init__.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/get_klayout_pyxs.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/get_klayout_pyxs.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/drc/errors.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/drc/errors.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/grain.xml` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/grain.xml`

 * *Files 1% similar despite different names*

#### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/grain.xml` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/grain.xml`

```diff
@@ -1,13 +1,13 @@
 <?xml version="1.0" encoding="utf-8"?>
 <salt-grain>
   <name>gdsfactory</name>
   <token/>
   <hidden>false</hidden>
-  <version>6.97.0</version>
+  <version>6.97.1</version>
   <api-version/>
   <title>gdsfactory</title>
   <doc>EDA tool to layout integrated circuits</doc>
   <doc-url>https://gdsfactory.github.io/gdsfactory/</doc-url>
   <url>https://github.com/gdsfactory/gdsfactory</url>
   <license>MIT</license>
   <author>Joaquin Matres</author>
```

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/icon_128x128.png` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/icon_128x128.png`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/icon_64x64.png` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/icon_64x64.png`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/README.md` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/README.md`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/README.md` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/README.md`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/generic_tech_malformed.drc` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/generic_tech_malformed.drc`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/drc_malformed/run_drc.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/drc_malformed/run_drc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/generic_tech.lvs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/generic_tech.lvs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/custom_classes.lvs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/custom_classes.lvs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_connections.lvs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/general_connections.lvs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_extraction.lvs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/heater_extraction.lvs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/rule_decks/layers_definitions.lvs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/rule_decks/layers_definitions.lvs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/run_lvs.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/run_lvs.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/layout/straight_heater_metal.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/layout/straight_heater_metal.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/netlist/straight_heater_metal.spice` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/lvs/testing/testcases/unit/heater_devices/netlist/straight_heater_metal.spice`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/import_generic_pcells.lym` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/import_generic_pcells.lym`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym`

 * *Files 16% similar despite different names*

#### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/set_menus.lym`

```diff
@@ -12,15 +12,15 @@
   <show-in-menu>false</show-in-menu>
   <group-name/>
   <menu-path>gdsfactory.begin</menu-path>
   <interpreter>python</interpreter>
   <dsl-interpreter-name/>
   <text>import pya
 
-__version__ = &quot;6.97.0&quot;
+__version__ = &quot;6.97.1&quot;
 
 
 def set_menu():
     menu = pya.Application.instance().main_window().menu()
 
     s0 = &quot;gdsfactory&quot;
     if not (menu.is_menu(s0)):
```

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/pymacros/set_shortcuts.lym` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/pymacros/set_shortcuts.lym`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/python/kgdsfactory/shortcuts.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/python/kgdsfactory/shortcuts.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/d25/generic.lyd25` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/d25/generic.lyd25`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/generic.layerstack` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/generic.layerstack`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/generic_tech.lyp` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/generic_tech.lyp`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/layers.lyp` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/layers.lyp`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/tech.lyt` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/tech.lyt`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_generic.pyxs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_generic.pyxs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_generic.xs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_generic.xs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_planarized.pyxs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_planarized.pyxs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/klayout/tech/xsection_planarized.xs` & `gdsfactory-6.97.1/gdsfactory/generic_tech/klayout/tech/xsection_planarized.xs`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/layer_map.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/layer_map.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/layer_stack.py` & `gdsfactory-6.97.1/gdsfactory/generic_tech/layer_stack.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/generic_tech/layer_views.yaml` & `gdsfactory-6.97.1/gdsfactory/generic_tech/layer_views.yaml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/__init__.py` & `gdsfactory-6.97.1/gdsfactory/geometry/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/boolean.py` & `gdsfactory-6.97.1/gdsfactory/geometry/boolean.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/boolean_klayout.py` & `gdsfactory-6.97.1/gdsfactory/geometry/boolean_klayout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/boolean_polygons.py` & `gdsfactory-6.97.1/gdsfactory/geometry/boolean_polygons.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/check_duplicated_cells.py` & `gdsfactory-6.97.1/gdsfactory/geometry/check_duplicated_cells.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/check_exclusion.py` & `gdsfactory-6.97.1/gdsfactory/geometry/check_exclusion.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/check_inclusion.py` & `gdsfactory-6.97.1/gdsfactory/geometry/check_inclusion.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/check_space.py` & `gdsfactory-6.97.1/gdsfactory/geometry/check_space.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/check_width.py` & `gdsfactory-6.97.1/gdsfactory/geometry/check_width.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/fill_klayout.py` & `gdsfactory-6.97.1/gdsfactory/geometry/fill_klayout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/fill_tiled.py` & `gdsfactory-6.97.1/gdsfactory/geometry/fill_tiled.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/fillet.py` & `gdsfactory-6.97.1/gdsfactory/geometry/fillet.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/functions.py` & `gdsfactory-6.97.1/gdsfactory/geometry/functions.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/invert.py` & `gdsfactory-6.97.1/gdsfactory/geometry/invert.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/layer_priority.py` & `gdsfactory-6.97.1/gdsfactory/geometry/layer_priority.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/manhattanize.py` & `gdsfactory-6.97.1/gdsfactory/geometry/manhattanize.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/maskprep.py` & `gdsfactory-6.97.1/gdsfactory/geometry/maskprep.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/maskprep_flat.py` & `gdsfactory-6.97.1/gdsfactory/geometry/maskprep_flat.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/offset.py` & `gdsfactory-6.97.1/gdsfactory/geometry/offset.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/outline.py` & `gdsfactory-6.97.1/gdsfactory/geometry/outline.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/trim.py` & `gdsfactory-6.97.1/gdsfactory/geometry/trim.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/union.py` & `gdsfactory-6.97.1/gdsfactory/geometry/union.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/write_connectivity.py` & `gdsfactory-6.97.1/gdsfactory/geometry/write_connectivity.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/write_drc.py` & `gdsfactory-6.97.1/gdsfactory/geometry/write_drc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/geometry/xor_diff.py` & `gdsfactory-6.97.1/gdsfactory/geometry/xor_diff.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/get_factories.py` & `gdsfactory-6.97.1/gdsfactory/get_factories.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/get_netlist.py` & `gdsfactory-6.97.1/gdsfactory/get_netlist.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/get_netlist_flat.py` & `gdsfactory-6.97.1/gdsfactory/get_netlist_flat.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/get_netlist_klayout.py` & `gdsfactory-6.97.1/gdsfactory/get_netlist_klayout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/grid.py` & `gdsfactory-6.97.1/gdsfactory/grid.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/install.py` & `gdsfactory-6.97.1/gdsfactory/install.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/klive.py` & `gdsfactory-6.97.1/gdsfactory/klive.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/__init__.py` & `gdsfactory-6.97.1/gdsfactory/labels/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/add_label_yaml.py` & `gdsfactory-6.97.1/gdsfactory/labels/add_label_yaml.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/ehva.py` & `gdsfactory-6.97.1/gdsfactory/labels/ehva.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/merge_test_metadata.py` & `gdsfactory-6.97.1/gdsfactory/labels/merge_test_metadata.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/siepic.py` & `gdsfactory-6.97.1/gdsfactory/labels/siepic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/labels/write_labels.py` & `gdsfactory-6.97.1/gdsfactory/labels/write_labels.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/materials.py` & `gdsfactory-6.97.1/gdsfactory/materials.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/name.py` & `gdsfactory-6.97.1/gdsfactory/name.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/pack.py` & `gdsfactory-6.97.1/gdsfactory/pack.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/path.py` & `gdsfactory-6.97.1/gdsfactory/path.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/pdk.py` & `gdsfactory-6.97.1/gdsfactory/pdk.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/picmodel.py` & `gdsfactory-6.97.1/gdsfactory/picmodel.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/pixelate.py` & `gdsfactory-6.97.1/gdsfactory/pixelate.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/dagster/workflow.py` & `gdsfactory-6.97.1/gdsfactory/plugins/dagster/workflow.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/database/README.md` & `gdsfactory-6.97.1/gdsfactory/plugins/database/README.md`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/database/db_upload.py` & `gdsfactory-6.97.1/gdsfactory/plugins/database/db_upload.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/database/models.py` & `gdsfactory-6.97.1/gdsfactory/plugins/database/models.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/web/main.py` & `gdsfactory-6.97.1/gdsfactory/plugins/web/main.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/web/server.py` & `gdsfactory-6.97.1/gdsfactory/plugins/web/server.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/web/server_jupyter.py` & `gdsfactory-6.97.1/gdsfactory/plugins/web/server_jupyter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/plugins/web/static/client.css` & `gdsfactory-6.97.1/gdsfactory/plugins/web/static/client.css`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/port.py` & `gdsfactory-6.97.1/gdsfactory/port.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/quickplotter.py` & `gdsfactory-6.97.1/gdsfactory/quickplotter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/__init__.py` & `gdsfactory-6.97.1/gdsfactory/read/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_dphox.py` & `gdsfactory-6.97.1/gdsfactory/read/from_dphox.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_gdspaths.py` & `gdsfactory-6.97.1/gdsfactory/read/from_gdspaths.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_np.py` & `gdsfactory-6.97.1/gdsfactory/read/from_np.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_phidl.py` & `gdsfactory-6.97.1/gdsfactory/read/from_phidl.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_yaml.py` & `gdsfactory-6.97.1/gdsfactory/read/from_yaml.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/from_yaml_template.py` & `gdsfactory-6.97.1/gdsfactory/read/from_yaml_template.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/import_gds.py` & `gdsfactory-6.97.1/gdsfactory/read/import_gds.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/read/labels.py` & `gdsfactory-6.97.1/gdsfactory/read/labels.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/__init__.py` & `gdsfactory-6.97.1/gdsfactory/routing/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_shortest.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_shortest.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_top.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_top.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_electrical_pads_top_dc.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_electrical_pads_top_dc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_fiber_array.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_fiber_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_fiber_single.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_fiber_single.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/add_pads.py` & `gdsfactory-6.97.1/gdsfactory/routing/add_pads.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/all_angle.py` & `gdsfactory-6.97.1/gdsfactory/routing/all_angle.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/auto_taper.py` & `gdsfactory-6.97.1/gdsfactory/routing/auto_taper.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/factories.py` & `gdsfactory-6.97.1/gdsfactory/routing/factories.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/fanout.py` & `gdsfactory-6.97.1/gdsfactory/routing/fanout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/fanout2x2.py` & `gdsfactory-6.97.1/gdsfactory/routing/fanout2x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_corner.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_corner.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_from_steps.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_from_steps.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_from_waypoints.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_from_waypoints.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_path_length_match.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_path_length_match.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_sbend.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_bundle_u.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_bundle_u.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_input_labels.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_input_labels.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_route.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_route.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_route_astar.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_route_astar.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_route_from_steps.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_route_from_steps.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_route_sbend.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_route_sbend.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_routes_bend180.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_routes_bend180.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/get_routes_straight.py` & `gdsfactory-6.97.1/gdsfactory/routing/get_routes_straight.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/manhattan.py` & `gdsfactory-6.97.1/gdsfactory/routing/manhattan.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/path_length_matching.py` & `gdsfactory-6.97.1/gdsfactory/routing/path_length_matching.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_fiber_array.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_fiber_array.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_fiber_single.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_fiber_single.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_ports_to_side.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_ports_to_side.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_quad.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_quad.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_sharp.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_sharp.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/route_south.py` & `gdsfactory-6.97.1/gdsfactory/routing/route_south.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/sort_ports.py` & `gdsfactory-6.97.1/gdsfactory/routing/sort_ports.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/routing/utils.py` & `gdsfactory-6.97.1/gdsfactory/routing/utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell.py` & `gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell/test_straight_wide.yml` & `gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell/test_straight_wide.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell_with_pins.py` & `gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell_with_pins.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/01_component_pcell_with_pins/test_straight_narrow.yml` & `gdsfactory-6.97.1/gdsfactory/samples/01_component_pcell_with_pins/test_straight_narrow.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/03_move.py` & `gdsfactory-6.97.1/gdsfactory/samples/03_move.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/04_connect.py` & `gdsfactory-6.97.1/gdsfactory/samples/04_connect.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/05_remove_layers.py` & `gdsfactory-6.97.1/gdsfactory/samples/05_remove_layers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/06_remapping_layers.py` & `gdsfactory-6.97.1/gdsfactory/samples/06_remapping_layers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/07_flattening_device.py` & `gdsfactory-6.97.1/gdsfactory/samples/07_flattening_device.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/11_component_layout.py` & `gdsfactory-6.97.1/gdsfactory/samples/11_component_layout.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/12_component_refs.py` & `gdsfactory-6.97.1/gdsfactory/samples/12_component_refs.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/13_component_netlist.py` & `gdsfactory-6.97.1/gdsfactory/samples/13_component_netlist.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/14_component_connectivity.py` & `gdsfactory-6.97.1/gdsfactory/samples/14_component_connectivity.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/15_component_sequence1.py` & `gdsfactory-6.97.1/gdsfactory/samples/15_component_sequence1.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/16_component_sequence2.py` & `gdsfactory-6.97.1/gdsfactory/samples/16_component_sequence2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/17_ports.py` & `gdsfactory-6.97.1/gdsfactory/samples/17_ports.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/20_components.py` & `gdsfactory-6.97.1/gdsfactory/samples/20_components.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/22_add_pads.py` & `gdsfactory-6.97.1/gdsfactory/samples/22_add_pads.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/23_reticle.py` & `gdsfactory-6.97.1/gdsfactory/samples/23_reticle.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/23_reticle_passives.py` & `gdsfactory-6.97.1/gdsfactory/samples/23_reticle_passives.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/24_doe_2.py` & `gdsfactory-6.97.1/gdsfactory/samples/24_doe_2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/24_doe_3.py` & `gdsfactory-6.97.1/gdsfactory/samples/24_doe_3.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/30_lidar.py` & `gdsfactory-6.97.1/gdsfactory/samples/30_lidar.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/30_lidar_pcell.py` & `gdsfactory-6.97.1/gdsfactory/samples/30_lidar_pcell.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/30_lidar_with_pads.py` & `gdsfactory-6.97.1/gdsfactory/samples/30_lidar_with_pads.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing.py` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_basic_01.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_basic_01.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_bundles.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_bundles.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_gone_wrong.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_gone_wrong.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_implicit_final_angle.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_implicit_final_angle.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_slalom.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_slalom.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_start_end_customizations.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_start_end_customizations.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_step_definitions.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_step_definitions.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/aar_tricky_connections.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/aar_tricky_connections.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/all_angle_routing/all_angle_routes.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/all_angle_routing/all_angle_routes.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/big_device.py` & `gdsfactory-6.97.1/gdsfactory/samples/big_device.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/benchmark/fill_demo.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/benchmark/fill_demo.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mask.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mask.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mzi_lattice_filter.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mzi_lattice_filter.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/circuits/mzi_ubcpdk.pic.yml` & `gdsfactory-6.97.1/gdsfactory/samples/demo/circuits/mzi_ubcpdk.pic.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/drc_errors.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/drc_errors.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/drc_write.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/drc_write.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/layers.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/layers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/lvs.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/lvs.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/demo/pcell.py` & `gdsfactory-6.97.1/gdsfactory/samples/demo/pcell.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/netlists/mzi.yml` & `gdsfactory-6.97.1/gdsfactory/samples/netlists/mzi.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/netlists/mzi_full.yml` & `gdsfactory-6.97.1/gdsfactory/samples/netlists/mzi_full.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/fab_c.py` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/fab_c.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/fab_d/phase_shifters.py` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/fab_d/phase_shifters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c.py` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_c_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_c_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_nc_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_bend_euler_nc_.yml`

 * *Files 6% similar despite different names*

```diff
@@ -77,41 +77,47 @@
     dy: 10.0
     function_name: cross_section
     length: 16.637
     radius: 10.0
     radius_min: 7.061
     settings:
       add_bbox: null
-      add_pins: null
+      add_pins:
+        function: add_pins
       auto_widen: false
       auto_widen_minimum_length: 200.0
-      bbox_layers: null
-      bbox_offsets: null
+      bbox_layers:
+      - - 36
+        - 0
+      bbox_offsets:
+      - 3
       cladding_layers: null
       cladding_offsets: null
       cladding_simplify: null
       decorator: null
       end_straight_length: 0.01
       gap: 3.0
       info: null
-      layer: WG
+      layer:
+      - 34
+      - 0
       min_length: 0.01
       mirror: false
-      name: null
+      name: strip
       offset: 0
       port_names:
       - o1
       - o2
       port_types:
       - optical
       - optical
       radius: 10.0
       sections: null
       snap_to_grid: null
       start_straight_length: 0.01
       taper_length: 10.0
-      width: 0.5
+      width: 1.0
       width_wide: null
     width: 1.0
   info_version: 2
   module: gdsfactory.components.bend_euler
   name: bend_euler_af89db80
```

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nc_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nc_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nitride_c_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_gc_nitride_c_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nc_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nc_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_c_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_c_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_o_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_nitride_o_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_no_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mmi1x2_no_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nc_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nc_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_c_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_c_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_o_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_nitride_o_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_no_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_mzi_no_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_c_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_c_.yml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_nc_.yml` & `gdsfactory-6.97.1/gdsfactory/samples/pdk/test_fab_c/test_settings_straight_nc_.yml`

 * *Files 13% similar despite different names*

```diff
@@ -83,41 +83,47 @@
         - 0
         name: strip
         width: 1.0
     function_name: cross_section
     length: 10.0
     settings:
       add_bbox: null
-      add_pins: null
+      add_pins:
+        function: add_pins
       auto_widen: false
       auto_widen_minimum_length: 200.0
-      bbox_layers: null
-      bbox_offsets: null
+      bbox_layers:
+      - - 36
+        - 0
+      bbox_offsets:
+      - 3
       cladding_layers: null
       cladding_offsets: null
       cladding_simplify: null
       decorator: null
       end_straight_length: 0.01
       gap: 3.0
       info: null
-      layer: WG
+      layer:
+      - 34
+      - 0
       min_length: 0.01
       mirror: false
-      name: null
+      name: strip
       offset: 0
       port_names:
       - o1
       - o2
       port_types:
       - optical
       - optical
       radius: 10.0
       sections: null
       snap_to_grid: null
       start_straight_length: 0.01
       taper_length: 10.0
-      width: 0.5
+      width: 1.0
       width_wide: null
     width: 1.0
   info_version: 2
   module: gdsfactory.components.straight
   name: straight_af89db80
```

### Comparing `gdsfactory-6.97.0/gdsfactory/schematic_editor.py` & `gdsfactory-6.97.1/gdsfactory/schematic_editor.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/serialization.py` & `gdsfactory-6.97.1/gdsfactory/serialization.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/show.py` & `gdsfactory-6.97.1/gdsfactory/show.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/add_simulation_markers.py` & `gdsfactory-6.97.1/gdsfactory/simulation/add_simulation_markers.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/convert_sparameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/convert_sparameters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/doping.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/doping.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_simulation.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_simulation.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_simulation_xsection.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_simulation_xsection.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/get_solver.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/get_solver.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/devsim/test_devsim.py` & `gdsfactory-6.97.1/gdsfactory/simulation/devsim/test_devsim.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/eme/meow_eme.py` & `gdsfactory-6.97.1/gdsfactory/simulation/eme/meow_eme.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/eme/test_meow_simulation.py` & `gdsfactory-6.97.1/gdsfactory/simulation/eme/test_meow_simulation.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/fem/mode_solver.py` & `gdsfactory-6.97.1/gdsfactory/simulation/fem/mode_solver.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/fem/test_mode_solver.py` & `gdsfactory-6.97.1/gdsfactory/simulation/fem/test_mode_solver.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/get_effective_indices.py` & `gdsfactory-6.97.1/gdsfactory/simulation/get_effective_indices.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/get_modes_path.py` & `gdsfactory-6.97.1/gdsfactory/simulation/get_modes_path.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/get_sparameters_path.py` & `gdsfactory-6.97.1/gdsfactory/simulation/get_sparameters_path.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_material.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_material.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_meep_geometry.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_meep_geometry.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_port_eigenmode.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_port_eigenmode.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation_grating_farfield.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation_grating_farfield.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/get_simulation_grating_fiber.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/get_simulation_grating_fiber.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/meep_adjoint_optimization.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/meep_adjoint_optimization.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_eigenmode.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_eigenmode.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_materials.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_materials.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_crossing.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_crossing.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_straight.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_sparameterNxN/test_sparameterNxN_straight.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_crossing.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_crossing.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_straight.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_straight.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_symmetries_straight.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameterNxN_symmetries_straight.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi_pool.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameter_straight_mpi_pool.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_crossing_symmetric.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_crossing_symmetric.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_batch.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_batch.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi_pool.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_mpi_pool.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_symmetric.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/test_write_sparameters_meep/test_sparameters_straight_symmetric.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_grating.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_grating.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep_batch.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep_batch.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmeep/write_sparameters_meep_mpi.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmeep/write_sparameters_meep_mpi.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/break_geometry.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/break_geometry.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/mesh.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/mesh.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/meshtracker.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/meshtracker.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_component.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_component.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_gds.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_gds.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/parse_layerstack.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/parse_layerstack.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/refine.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/refine.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/scratch/mesh3D.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/scratch/mesh3D.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/tests/test_meshing.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/tests/test_meshing.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/uz_xsection_mesh.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/uz_xsection_mesh.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/xy_xsection_mesh.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/xy_xsection_mesh.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gmsh/xyz_mesh.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gmsh/xyz_mesh.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_results.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_results.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_simulation.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_simulation.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/get_simulation_grating_coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/get_simulation_grating_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/materials.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/materials.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/modes.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/modes.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/sim_run.yaml` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/sim_run.yaml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/sim_ref.yaml` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/sim_ref.yaml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/sim_run.yaml` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/sim_run.yaml`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_modes.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_modes.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_results.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_results.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_simulation.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_simulation.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters/test_sparameters_straight.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters/test_sparameters_straight.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters_grating_coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/tests/test_write_sparameters_grating_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/utils.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/write_sparameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/write_sparameters.py`

 * *Files 5% similar despite different names*

```diff
@@ -174,15 +174,15 @@
 
     sims = []
     sp = {}
 
     port_source_names = port_source_names or port_names
 
     for port_name in port_source_names:
-        if port_name not in port_symmetries:
+        if port_name in port_symmetries or not port_symmetries:
             sim = get_simulation(component, port_source_name=port_name, **kwargs)
             sims.append(sim)
 
     if not run:
         sim = sims[0]
         plot_simulation(sim)
         return sp
@@ -213,26 +213,41 @@
                 port_name=port_name, ports=ports, sim_data=sim_data
             )
             sij = monitor_exiting / source_entering
             key = f"{port_name}@0,{port_name_source}@0"
             sp[key] = sij
             sp["wavelengths"] = get_wavelengths(port_name=port_name, sim_data=sim_data)
 
+        def convert_old_fmt(s_name):
+            if len(s_name) == 3 and s_name[0] == "s":
+                s_name = (
+                    f"{port_names[int(s_name[1])-1]}@0,{port_names[int(s_name[2])-1]}@0"
+                )
+            return s_name
+
         if bool(port_symmetries):
             for key, symmetries in port_symmetries.items():
                 for sym in symmetries:
-                    if key in sp:
-                        sp[sym] = sp[key]
+                    n_key = convert_old_fmt(key)
+                    n_sym = convert_old_fmt(sym)
+                    if n_key in sp:
+                        sp[n_sym] = sp[n_key]
 
         return sp
 
     for port_source_name, (_sim_name, sim_data) in zip(
         port_source_names, batch_data.items()
     ):
-        sp.update(get_sparameter(port_source_name, sim_data))
+        sp.update(
+            get_sparameter(
+                port_source_name,
+                sim_data,
+                port_symmetries=port_symmetries.get(port_source_name, {}),
+            )
+        )
 
     end = time.time()
     np.savez_compressed(filepath, **sp)
     kwargs.update(compute_time_seconds=end - start)
     kwargs.update(compute_time_minutes=(end - start) / 60)
     filepath_sim_settings.write_text(OmegaConf.to_yaml(clean_value_json(kwargs)))
     logger.info(f"Write simulation results to {str(filepath)!r}")
```

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/gtidy3d/write_sparameters_grating_coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/gtidy3d/write_sparameters_grating_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/interconnect.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/interconnect.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/read.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/read.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/settings.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/settings.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/test_read_sparameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/test_read_sparameters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/write_sparameters_lumerical.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/write_sparameters_lumerical.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/lumerical/write_sparameters_lumerical_components.py` & `gdsfactory-6.97.1/gdsfactory/simulation/lumerical/write_sparameters_lumerical_components.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_coupling_vs_gap.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_coupling_vs_gap.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_mode_dispersion.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_mode_dispersion.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_modes.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_modes.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_modes_cross_section.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_modes_cross_section.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_neff_ng_dw_dh.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_neff_ng_dw_dh.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/find_neff_vs_width.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/find_neff_vs_width.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_cross_section.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_cross_section.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/get_mode_solver_rib.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/get_mode_solver_rib.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_nitride.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_nitride.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_rib.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_rib.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/modes/neff_vs_width_strip.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/modes/neff_vs_width_strip.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/neff_convergence_test.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/neff_convergence_test.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/overlap.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/overlap.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh_dispersion.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_dw_dh/test_dw_dh_dispersion.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_find_modes.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_find_modes.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/tests/test_find_modes_dispersion.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/tests/test_find_modes_dispersion.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/types.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/types.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/modes/waveguide.py` & `gdsfactory-6.97.1/gdsfactory/simulation/modes/waveguide.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/mzi.py` & `gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/mzi.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/photonic_circuit_models/ring.py` & `gdsfactory-6.97.1/gdsfactory/simulation/photonic_circuit_models/ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/plot.py` & `gdsfactory-6.97.1/gdsfactory/simulation/plot.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/plot_csv.py` & `gdsfactory-6.97.1/gdsfactory/simulation/plot_csv.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/port_symmetries.py` & `gdsfactory-6.97.1/gdsfactory/simulation/port_symmetries.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/diffusion.py` & `gdsfactory-6.97.1/gdsfactory/simulation/process/diffusion.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/implant_tables.py` & `gdsfactory-6.97.1/gdsfactory/simulation/process/implant_tables.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/pysrim.py` & `gdsfactory-6.97.1/gdsfactory/simulation/process/pysrim.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/silicon.py` & `gdsfactory-6.97.1/gdsfactory/simulation/process/silicon.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/skew/antimony_si_skew.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/process/skew/antimony_si_skew.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/skew/arsenic_si_skew.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/process/skew/arsenic_si_skew.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/skew/boron_si_skew.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/process/skew/boron_si_skew.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/process/skew/phosphorus_si_skew.csv` & `gdsfactory-6.97.1/gdsfactory/simulation/process/skew/phosphorus_si_skew.csv`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/build_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/build_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/femwell_waveguide_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/femwell_waveguide_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/interpolators.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/interpolators.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/meep_FDTD_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/meep_FDTD_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/meow_eme_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/meow_eme_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/mlp.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/mlp.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/models.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/models.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/parameter.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/parameter.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/plot_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/plot_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/read.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/read.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_mzi.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_mzi.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_mzi_lattice.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_mzi_lattice.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sax/tests/test_parameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sax/tests/test_parameters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/add_gc.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/add_gc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/circuit.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/circuit.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/__init__.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/bend_circular.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/bend_circular.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/bend_euler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/bend_euler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_fdtd.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_fdtd.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring_fdtd.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring_fdtd.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/coupler_ring_siepic.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/coupler_ring_siepic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/gc.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/gc.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mmi1x2.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mmi1x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mmi2x2.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mmi2x2.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mzi.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mzi.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/mzi_siepic.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/mzi_siepic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_double.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_double.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_double_siepic.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_double_siepic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_single.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_single.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/ring_single_siepic.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/ring_single_siepic.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/components/straight.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/components/straight.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/get_transmission.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/get_transmission.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/model_from_gdsfactory.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/model_from_gdsfactory.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/model_from_sparameters.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/model_from_sparameters.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_circuit.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_circuit.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_circuit_montecarlo.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_circuit_montecarlo.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/plot_model.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/plot_model.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_circuit.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_circuit.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/simphony/tests/test_components.py` & `gdsfactory-6.97.1/gdsfactory/simulation/simphony/tests/test_components.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sipann/bend_circular.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sipann/bend_circular.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sipann/bend_euler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sipann/bend_euler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sipann/coupler.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sipann/coupler.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sipann/coupler_ring.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sipann/coupler_ring.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/sipann/straight.py` & `gdsfactory-6.97.1/gdsfactory/simulation/sipann/straight.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/simulation/thermal/heater.py` & `gdsfactory-6.97.1/gdsfactory/simulation/thermal/heater.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/snap.py` & `gdsfactory-6.97.1/gdsfactory/snap.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/symbols.py` & `gdsfactory-6.97.1/gdsfactory/symbols.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/__init__.py` & `gdsfactory-6.97.1/gdsfactory/technology/__init__.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/klayout_tech.py` & `gdsfactory-6.97.1/gdsfactory/technology/klayout_tech.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/layer_map.py` & `gdsfactory-6.97.1/gdsfactory/technology/layer_map.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/layer_stack.py` & `gdsfactory-6.97.1/gdsfactory/technology/layer_stack.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/layer_views.py` & `gdsfactory-6.97.1/gdsfactory/technology/layer_views.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/technology/simulation_settings.py` & `gdsfactory-6.97.1/gdsfactory/technology/simulation_settings.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/types.py` & `gdsfactory-6.97.1/gdsfactory/types.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/typings.py` & `gdsfactory-6.97.1/gdsfactory/typings.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/utils/async_utils.py` & `gdsfactory-6.97.1/gdsfactory/utils/async_utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/utils/file_utils.py` & `gdsfactory-6.97.1/gdsfactory/utils/file_utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/utils/xml_utils.py` & `gdsfactory-6.97.1/gdsfactory/utils/xml_utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/utils/yaml_utils.py` & `gdsfactory-6.97.1/gdsfactory/utils/yaml_utils.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/watch.py` & `gdsfactory-6.97.1/gdsfactory/watch.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/widgets/layout_viewer.py` & `gdsfactory-6.97.1/gdsfactory/widgets/layout_viewer.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/gdsfactory/write_cells.py` & `gdsfactory-6.97.1/gdsfactory/write_cells.py`

 * *Files identical despite different names*

### Comparing `gdsfactory-6.97.0/pyproject.toml` & `gdsfactory-6.97.1/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -10,15 +10,15 @@
   "Programming Language :: Python :: 3.7",
   "Programming Language :: Python :: 3.8",
   "Programming Language :: Python :: 3.9",
   "Programming Language :: Python :: 3.10",
   "Programming Language :: Python :: 3.11",
   "Operating System :: OS Independent",
 ]
-version = "6.97.0"
+version = "6.97.1"
 authors = [
 {name = "gdsfactory community", email = "contact@gdsfactory.com"},
 ]
 keywords = ["eda", "photonics", "python"]
 license = {file = "LICENSE"}
 dependencies = [
   "click",
```

### Comparing `gdsfactory-6.97.0/PKG-INFO` & `gdsfactory-6.97.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: gdsfactory
-Version: 6.97.0
+Version: 6.97.1
 Summary: python library to generate GDS layouts
 Keywords: eda,photonics,python
 Author-email: gdsfactory community <contact@gdsfactory.com>
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
@@ -114,15 +114,15 @@
 Provides-Extra: full
 Provides-Extra: gmsh
 Provides-Extra: meow
 Provides-Extra: ray
 Provides-Extra: sax
 Provides-Extra: tidy3d
 
-# gdsfactory 6.97.0
+# gdsfactory 6.97.1
 
 [![docs](https://github.com/gdsfactory/gdsfactory/actions/workflows/pages.yml/badge.svg)](https://gdsfactory.github.io/gdsfactory/)
 [![PyPI](https://img.shields.io/pypi/v/gdsfactory)](https://pypi.org/project/gdsfactory/)
 [![Conda Version](https://img.shields.io/conda/vn/conda-forge/gdsfactory.svg)](https://anaconda.org/conda-forge/gdsfactory)
 [![Dockerhub](https://img.shields.io/docker/pulls/joamatab/gdsfactory)](https://hub.docker.com/r/joamatab/gdsfactory)
 [![PyPI Python](https://img.shields.io/pypi/pyversions/gdsfactory.svg)](https://pypi.python.org/pypi/gdsfactory)
 [![issues](https://img.shields.io/github/issues/gdsfactory/gdsfactory)](https://github.com/gdsfactory/gdsfactory/issues)
```

