# Comparing `tmp/mlrun-1.4.0rc5-py3-none-any.whl.zip` & `tmp/mlrun-1.4.0rc6-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,412 +1,412 @@
-Zip file size: 1189461 bytes, number of entries: 410
--rw-r--r--  2.0 unx     8727 b- defN 23-May-16 10:27 mlrun/__init__.py
--rw-r--r--  2.0 unx    49342 b- defN 23-May-16 10:27 mlrun/__main__.py
--rw-r--r--  2.0 unx    54803 b- defN 23-May-16 10:27 mlrun/config.py
--rw-r--r--  2.0 unx     6780 b- defN 23-May-16 10:27 mlrun/errors.py
--rw-r--r--  2.0 unx    39096 b- defN 23-May-16 10:27 mlrun/execution.py
--rw-r--r--  2.0 unx    15624 b- defN 23-May-16 10:27 mlrun/features.py
--rw-r--r--  2.0 unx     4880 b- defN 23-May-16 10:27 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    29645 b- defN 23-May-16 10:27 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8360 b- defN 23-May-16 10:27 mlrun/lists.py
--rw-r--r--  2.0 unx    53415 b- defN 23-May-16 10:27 mlrun/model.py
--rw-r--r--  2.0 unx    11828 b- defN 23-May-16 10:27 mlrun/render.py
--rw-r--r--  2.0 unx    64472 b- defN 23-May-16 10:27 mlrun/run.py
--rw-r--r--  2.0 unx     7783 b- defN 23-May-16 10:27 mlrun/secrets.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/__init__.py
--rw-r--r--  2.0 unx     2105 b- defN 23-May-16 10:27 mlrun/api/alembic.ini
--rw-r--r--  2.0 unx      685 b- defN 23-May-16 10:27 mlrun/api/constants.py
--rw-r--r--  2.0 unx    25068 b- defN 23-May-16 10:27 mlrun/api/initial_data.py
--rw-r--r--  2.0 unx     7067 b- defN 23-May-16 10:27 mlrun/api/launcher.py
--rw-r--r--  2.0 unx    26288 b- defN 23-May-16 10:27 mlrun/api/main.py
--rw-r--r--  2.0 unx     5247 b- defN 23-May-16 10:27 mlrun/api/middlewares.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/api/__init__.py
--rw-r--r--  2.0 unx     4243 b- defN 23-May-16 10:27 mlrun/api/api/api.py
--rw-r--r--  2.0 unx     3197 b- defN 23-May-16 10:27 mlrun/api/api/deps.py
--rw-r--r--  2.0 unx    36404 b- defN 23-May-16 10:27 mlrun/api/api/utils.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/__init__.py
--rw-r--r--  2.0 unx     9545 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/artifacts.py
--rw-r--r--  2.0 unx     1199 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/auth.py
--rw-r--r--  2.0 unx     3618 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/background_tasks.py
--rw-r--r--  2.0 unx     1214 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/client_spec.py
--rw-r--r--  2.0 unx     1175 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/clusterization_spec.py
--rw-r--r--  2.0 unx    29543 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/feature_store.py
--rw-r--r--  2.0 unx     6104 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/files.py
--rw-r--r--  2.0 unx     5749 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/frontend_spec.py
--rw-r--r--  2.0 unx    34542 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/functions.py
--rw-r--r--  2.0 unx     5986 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/grafana_proxy.py
--rw-r--r--  2.0 unx     1344 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/healthz.py
--rw-r--r--  2.0 unx    10399 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/hub.py
--rw-r--r--  2.0 unx     2450 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/logs.py
--rw-r--r--  2.0 unx    15817 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/model_endpoints.py
--rw-r--r--  2.0 unx     3756 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/operations.py
--rw-r--r--  2.0 unx     9220 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/pipelines.py
--rw-r--r--  2.0 unx    11494 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/projects.py
--rw-r--r--  2.0 unx     9078 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/runs.py
--rw-r--r--  2.0 unx     9063 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/runtime_resources.py
--rw-r--r--  2.0 unx    10731 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/schedules.py
--rw-r--r--  2.0 unx     6061 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/secrets.py
--rw-r--r--  2.0 unx     5298 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/submit.py
--rw-r--r--  2.0 unx     4894 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/tags.py
--rw-r--r--  2.0 unx     1203 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/internal/__init__.py
--rw-r--r--  2.0 unx     1043 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/internal/config.py
--rw-r--r--  2.0 unx     1724 b- defN 23-May-16 10:27 mlrun/api/api/endpoints/internal/memory_reports.py
--rw-r--r--  2.0 unx     1209 b- defN 23-May-16 10:27 mlrun/api/crud/__init__.py
--rw-r--r--  2.0 unx     5610 b- defN 23-May-16 10:27 mlrun/api/crud/artifacts.py
--rw-r--r--  2.0 unx     7331 b- defN 23-May-16 10:27 mlrun/api/crud/client_spec.py
--rw-r--r--  2.0 unx     1055 b- defN 23-May-16 10:27 mlrun/api/crud/clusterization_spec.py
--rw-r--r--  2.0 unx    18628 b- defN 23-May-16 10:27 mlrun/api/crud/feature_store.py
--rw-r--r--  2.0 unx     3556 b- defN 23-May-16 10:27 mlrun/api/crud/functions.py
--rw-r--r--  2.0 unx    12025 b- defN 23-May-16 10:27 mlrun/api/crud/hub.py
--rw-r--r--  2.0 unx     9729 b- defN 23-May-16 10:27 mlrun/api/crud/logs.py
--rw-r--r--  2.0 unx     2751 b- defN 23-May-16 10:27 mlrun/api/crud/notifications.py
--rw-r--r--  2.0 unx    14030 b- defN 23-May-16 10:27 mlrun/api/crud/pipelines.py
--rw-r--r--  2.0 unx    14269 b- defN 23-May-16 10:27 mlrun/api/crud/projects.py
--rw-r--r--  2.0 unx     5963 b- defN 23-May-16 10:27 mlrun/api/crud/runs.py
--rw-r--r--  2.0 unx     5575 b- defN 23-May-16 10:27 mlrun/api/crud/runtime_resources.py
--rw-r--r--  2.0 unx    20145 b- defN 23-May-16 10:27 mlrun/api/crud/secrets.py
--rw-r--r--  2.0 unx     3277 b- defN 23-May-16 10:27 mlrun/api/crud/tags.py
--rw-r--r--  2.0 unx      722 b- defN 23-May-16 10:27 mlrun/api/crud/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    15692 b- defN 23-May-16 10:27 mlrun/api/crud/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    43000 b- defN 23-May-16 10:27 mlrun/api/crud/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/crud/runtimes/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/crud/runtimes/nuclio/__init__.py
--rw-r--r--  2.0 unx    17168 b- defN 23-May-16 10:27 mlrun/api/crud/runtimes/nuclio/function.py
--rw-r--r--  2.0 unx    11398 b- defN 23-May-16 10:27 mlrun/api/crud/runtimes/nuclio/helpers.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/db/__init__.py
--rw-r--r--  2.0 unx    15056 b- defN 23-May-16 10:27 mlrun/api/db/base.py
--rw-r--r--  2.0 unx      870 b- defN 23-May-16 10:27 mlrun/api/db/init_db.py
--rw-r--r--  2.0 unx      993 b- defN 23-May-16 10:27 mlrun/api/db/session.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/__init__.py
--rw-r--r--  2.0 unx   144515 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/db.py
--rw-r--r--  2.0 unx     2340 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/helpers.py
--rw-r--r--  2.0 unx     2542 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/session.py
--rw-r--r--  2.0 unx     1063 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/models/__init__.py
--rw-r--r--  2.0 unx    20642 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/models/models_mysql.py
--rw-r--r--  2.0 unx    18304 b- defN 23-May-16 10:27 mlrun/api/db/sqldb/models/models_sqlite.py
--rw-r--r--  2.0 unx     2906 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/env.py
--rw-r--r--  2.0 unx     1203 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
--rw-r--r--  2.0 unx     4614 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
--rw-r--r--  2.0 unx     1936 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
--rw-r--r--  2.0 unx     1909 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1415 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
--rw-r--r--  2.0 unx     1504 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1649 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx    24057 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
--rw-r--r--  2.0 unx     2457 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
--rw-r--r--  2.0 unx     1351 b- defN 23-May-16 10:27 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     2906 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/env.py
--rw-r--r--  2.0 unx    11473 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
--rw-r--r--  2.0 unx     1348 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
--rw-r--r--  2.0 unx     5180 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
--rw-r--r--  2.0 unx     2595 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
--rw-r--r--  2.0 unx     1388 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     1767 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1360 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
--rw-r--r--  2.0 unx     1259 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
--rw-r--r--  2.0 unx     2147 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
--rw-r--r--  2.0 unx     1482 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1892 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
--rw-r--r--  2.0 unx     1882 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
--rw-r--r--  2.0 unx     1420 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
--rw-r--r--  2.0 unx     2034 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
--rw-r--r--  2.0 unx     1828 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
--rw-r--r--  2.0 unx     1380 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
--rw-r--r--  2.0 unx     1831 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx     3936 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
--rw-r--r--  2.0 unx     2588 b- defN 23-May-16 10:27 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
--rw-r--r--  2.0 unx    13338 b- defN 23-May-16 10:27 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/__init__.py
--rw-r--r--  2.0 unx     1092 b- defN 23-May-16 10:27 mlrun/api/utils/asyncio.py
--rw-r--r--  2.0 unx     7371 b- defN 23-May-16 10:27 mlrun/api/utils/background_tasks.py
--rw-r--r--  2.0 unx    25560 b- defN 23-May-16 10:27 mlrun/api/utils/builder.py
--rw-r--r--  2.0 unx     2431 b- defN 23-May-16 10:27 mlrun/api/utils/helpers.py
--rw-r--r--  2.0 unx     3728 b- defN 23-May-16 10:27 mlrun/api/utils/memory_reports.py
--rw-r--r--  2.0 unx     2599 b- defN 23-May-16 10:27 mlrun/api/utils/periodic.py
--rw-r--r--  2.0 unx    39305 b- defN 23-May-16 10:27 mlrun/api/utils/scheduler.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/auth/__init__.py
--rw-r--r--  2.0 unx    12383 b- defN 23-May-16 10:27 mlrun/api/utils/auth/verifier.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/auth/providers/__init__.py
--rw-r--r--  2.0 unx     1381 b- defN 23-May-16 10:27 mlrun/api/utils/auth/providers/base.py
--rw-r--r--  2.0 unx     1460 b- defN 23-May-16 10:27 mlrun/api/utils/auth/providers/nop.py
--rw-r--r--  2.0 unx    10883 b- defN 23-May-16 10:27 mlrun/api/utils/auth/providers/opa.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/clients/__init__.py
--rw-r--r--  2.0 unx    13271 b- defN 23-May-16 10:27 mlrun/api/utils/clients/chief.py
--rw-r--r--  2.0 unx    31249 b- defN 23-May-16 10:27 mlrun/api/utils/clients/iguazio.py
--rw-r--r--  2.0 unx    12109 b- defN 23-May-16 10:27 mlrun/api/utils/clients/log_collector.py
--rw-r--r--  2.0 unx     9916 b- defN 23-May-16 10:27 mlrun/api/utils/clients/nuclio.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/clients/protocols/__init__.py
--rw-r--r--  2.0 unx     2567 b- defN 23-May-16 10:27 mlrun/api/utils/clients/protocols/grpc.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/db/__init__.py
--rw-r--r--  2.0 unx     3305 b- defN 23-May-16 10:27 mlrun/api/utils/db/alembic.py
--rw-r--r--  2.0 unx     8214 b- defN 23-May-16 10:27 mlrun/api/utils/db/backup.py
--rw-r--r--  2.0 unx     3795 b- defN 23-May-16 10:27 mlrun/api/utils/db/mysql.py
--rw-r--r--  2.0 unx      992 b- defN 23-May-16 10:27 mlrun/api/utils/db/sql_collation.py
--rw-r--r--  2.0 unx     3855 b- defN 23-May-16 10:27 mlrun/api/utils/db/sqlite_migration.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/projects/__init__.py
--rw-r--r--  2.0 unx    17423 b- defN 23-May-16 10:27 mlrun/api/utils/projects/follower.py
--rw-r--r--  2.0 unx    19372 b- defN 23-May-16 10:27 mlrun/api/utils/projects/leader.py
--rw-r--r--  2.0 unx     7133 b- defN 23-May-16 10:27 mlrun/api/utils/projects/member.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/projects/remotes/__init__.py
--rw-r--r--  2.0 unx     2659 b- defN 23-May-16 10:27 mlrun/api/utils/projects/remotes/follower.py
--rw-r--r--  2.0 unx     2094 b- defN 23-May-16 10:27 mlrun/api/utils/projects/remotes/leader.py
--rw-r--r--  2.0 unx     5000 b- defN 23-May-16 10:27 mlrun/api/utils/projects/remotes/nop_follower.py
--rw-r--r--  2.0 unx     3861 b- defN 23-May-16 10:27 mlrun/api/utils/projects/remotes/nop_leader.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/__init__.py
--rw-r--r--  2.0 unx     1202 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/db.py
--rw-r--r--  2.0 unx    22630 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/k8s.py
--rw-r--r--  2.0 unx      840 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/logs_dir.py
--rw-r--r--  2.0 unx     1279 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/project_member.py
--rw-r--r--  2.0 unx     1063 b- defN 23-May-16 10:27 mlrun/api/utils/singletons/scheduler.py
--rw-r--r--  2.0 unx     1091 b- defN 23-May-16 10:27 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    30849 b- defN 23-May-16 10:27 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    20432 b- defN 23-May-16 10:27 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    12594 b- defN 23-May-16 10:27 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    23673 b- defN 23-May-16 10:27 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15383 b- defN 23-May-16 10:27 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-16 10:27 mlrun/common/__init__.py
--rw-r--r--  2.0 unx      660 b- defN 23-May-16 10:27 mlrun/common/constants.py
--rw-r--r--  2.0 unx     5670 b- defN 23-May-16 10:27 mlrun/common/model_monitoring.py
--rw-r--r--  2.0 unx      790 b- defN 23-May-16 10:27 mlrun/common/types.py
--rw-r--r--  2.0 unx     3973 b- defN 23-May-16 10:27 mlrun/common/schemas/__init__.py
--rw-r--r--  2.0 unx     1923 b- defN 23-May-16 10:27 mlrun/common/schemas/artifact.py
--rw-r--r--  2.0 unx     5251 b- defN 23-May-16 10:27 mlrun/common/schemas/auth.py
--rw-r--r--  2.0 unx     1553 b- defN 23-May-16 10:27 mlrun/common/schemas/background_task.py
--rw-r--r--  2.0 unx     2751 b- defN 23-May-16 10:27 mlrun/common/schemas/client_spec.py
--rw-r--r--  2.0 unx      888 b- defN 23-May-16 10:27 mlrun/common/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     6243 b- defN 23-May-16 10:27 mlrun/common/schemas/constants.py
--rw-r--r--  2.0 unx     3671 b- defN 23-May-16 10:27 mlrun/common/schemas/feature_store.py
--rw-r--r--  2.0 unx     2546 b- defN 23-May-16 10:27 mlrun/common/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     3971 b- defN 23-May-16 10:27 mlrun/common/schemas/function.py
--rw-r--r--  2.0 unx      705 b- defN 23-May-16 10:27 mlrun/common/schemas/http.py
--rw-r--r--  2.0 unx     4245 b- defN 23-May-16 10:27 mlrun/common/schemas/hub.py
--rw-r--r--  2.0 unx     1395 b- defN 23-May-16 10:27 mlrun/common/schemas/k8s.py
--rw-r--r--  2.0 unx      920 b- defN 23-May-16 10:27 mlrun/common/schemas/memory_reports.py
--rw-r--r--  2.0 unx    12593 b- defN 23-May-16 10:27 mlrun/common/schemas/model_endpoints.py
--rw-r--r--  2.0 unx      879 b- defN 23-May-16 10:27 mlrun/common/schemas/notification.py
--rw-r--r--  2.0 unx     1907 b- defN 23-May-16 10:27 mlrun/common/schemas/object.py
--rw-r--r--  2.0 unx     1184 b- defN 23-May-16 10:27 mlrun/common/schemas/pipeline.py
--rw-r--r--  2.0 unx     4094 b- defN 23-May-16 10:27 mlrun/common/schemas/project.py
--rw-r--r--  2.0 unx     1636 b- defN 23-May-16 10:27 mlrun/common/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4188 b- defN 23-May-16 10:27 mlrun/common/schemas/schedule.py
--rw-r--r--  2.0 unx     1484 b- defN 23-May-16 10:27 mlrun/common/schemas/secret.py
--rw-r--r--  2.0 unx      905 b- defN 23-May-16 10:27 mlrun/common/schemas/tag.py
--rw-r--r--  2.0 unx     1087 b- defN 23-May-16 10:27 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4647 b- defN 23-May-16 10:27 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     5813 b- defN 23-May-16 10:27 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9426 b- defN 23-May-16 10:27 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     3443 b- defN 23-May-16 10:27 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     6946 b- defN 23-May-16 10:27 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    18274 b- defN 23-May-16 10:27 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     7995 b- defN 23-May-16 10:27 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx     3791 b- defN 23-May-16 10:27 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     5114 b- defN 23-May-16 10:27 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx     2627 b- defN 23-May-16 10:27 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     4873 b- defN 23-May-16 10:27 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     7035 b- defN 23-May-16 10:27 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    34305 b- defN 23-May-16 10:27 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1410 b- defN 23-May-16 10:27 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     6895 b- defN 23-May-16 10:27 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    62060 b- defN 23-May-16 10:27 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     2900 b- defN 23-May-16 10:27 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     8097 b- defN 23-May-16 10:27 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 23-May-16 10:27 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6152 b- defN 23-May-16 10:27 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     2816 b- defN 23-May-16 10:27 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    15968 b- defN 23-May-16 10:27 mlrun/db/base.py
--rw-r--r--  2.0 unx   130800 b- defN 23-May-16 10:27 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    13197 b- defN 23-May-16 10:27 mlrun/db/nopdb.py
--rw-r--r--  2.0 unx    25577 b- defN 23-May-16 10:27 mlrun/db/sqldb.py
--rw-r--r--  2.0 unx     1501 b- defN 23-May-16 10:27 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    43820 b- defN 23-May-16 10:27 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12781 b- defN 23-May-16 10:27 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    47273 b- defN 23-May-16 10:27 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    21940 b- defN 23-May-16 10:27 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11681 b- defN 23-May-16 10:27 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    28635 b- defN 23-May-16 10:27 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1232 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    25911 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx     4261 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     7141 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4765 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx     3352 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/online.py
--rw-r--r--  2.0 unx     9661 b- defN 23-May-16 10:27 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx      743 b- defN 23-May-16 10:27 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11466 b- defN 23-May-16 10:27 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 23-May-16 10:27 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8515 b- defN 23-May-16 10:27 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    21018 b- defN 23-May-16 10:27 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55376 b- defN 23-May-16 10:27 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3469 b- defN 23-May-16 10:27 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5757 b- defN 23-May-16 10:27 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9209 b- defN 23-May-16 10:27 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11531 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14777 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    28414 b- defN 23-May-16 10:27 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3169 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16957 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2368 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4881 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10490 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5684 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6453 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     5212 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6078 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6658 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5318 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6993 b- defN 23-May-16 10:27 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 23-May-16 10:27 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    23796 b- defN 23-May-16 10:27 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 23-May-16 10:27 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6083 b- defN 23-May-16 10:27 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15883 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13891 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9189 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8278 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5156 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4137 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1624 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14256 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 23-May-16 10:27 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 23-May-16 10:27 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6098 b- defN 23-May-16 10:27 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2405 b- defN 23-May-16 10:27 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6203 b- defN 23-May-16 10:27 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7061 b- defN 23-May-16 10:27 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22056 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27904 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44639 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22465 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10136 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11524 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23166 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9310 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26661 b- defN 23-May-16 10:27 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10892 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5852 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7117 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12215 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14126 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4745 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 23-May-16 10:27 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10455 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16627 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28247 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9565 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21886 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8791 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28728 b- defN 23-May-16 10:27 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10287 b- defN 23-May-16 10:27 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 23-May-16 10:27 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11617 b- defN 23-May-16 10:27 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 23-May-16 10:27 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      577 b- defN 23-May-16 10:27 mlrun/launcher/__init__.py
--rw-r--r--  2.0 unx    14886 b- defN 23-May-16 10:27 mlrun/launcher/base.py
--rw-r--r--  2.0 unx     4791 b- defN 23-May-16 10:27 mlrun/launcher/client.py
--rw-r--r--  2.0 unx     1883 b- defN 23-May-16 10:27 mlrun/launcher/factory.py
--rw-r--r--  2.0 unx    10419 b- defN 23-May-16 10:27 mlrun/launcher/local.py
--rw-r--r--  2.0 unx     6875 b- defN 23-May-16 10:27 mlrun/launcher/remote.py
--rw-r--r--  2.0 unx      760 b- defN 23-May-16 10:27 mlrun/mlutils/__init__.py
--rw-r--r--  2.0 unx     5325 b- defN 23-May-16 10:27 mlrun/mlutils/data.py
--rw-r--r--  2.0 unx     2598 b- defN 23-May-16 10:27 mlrun/mlutils/models.py
--rw-r--r--  2.0 unx    30120 b- defN 23-May-16 10:27 mlrun/mlutils/plots.py
--rw-r--r--  2.0 unx     1208 b- defN 23-May-16 10:27 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    23948 b- defN 23-May-16 10:27 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     9756 b- defN 23-May-16 10:27 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     5196 b- defN 23-May-16 10:27 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx    36885 b- defN 23-May-16 10:27 mlrun/model_monitoring/model_monitoring_batch.py
--rw-r--r--  2.0 unx    43172 b- defN 23-May-16 10:27 mlrun/model_monitoring/stream_processing_fs.py
--rw-r--r--  2.0 unx     4240 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/__init__.py
--rw-r--r--  2.0 unx    17357 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
--rw-r--r--  2.0 unx     5695 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/model_endpoint_store.py
--rw-r--r--  2.0 unx    15706 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
--rw-r--r--  2.0 unx      884 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/models/__init__.py
--rw-r--r--  2.0 unx      655 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/models/base.py
--rw-r--r--  2.0 unx     3741 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/models/mysql.py
--rw-r--r--  2.0 unx     3658 b- defN 23-May-16 10:27 mlrun/model_monitoring/stores/models/sqlite.py
--rw-r--r--  2.0 unx     2400 b- defN 23-May-16 10:27 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    24102 b- defN 23-May-16 10:27 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11852 b- defN 23-May-16 10:27 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 23-May-16 10:27 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    17480 b- defN 23-May-16 10:27 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    38336 b- defN 23-May-16 10:27 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   105376 b- defN 23-May-16 10:27 mlrun/projects/project.py
--rw-r--r--  2.0 unx     8773 b- defN 23-May-16 10:27 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx    89589 b- defN 23-May-16 10:27 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     6689 b- defN 23-May-16 10:27 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    30520 b- defN 23-May-16 10:27 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx     9561 b- defN 23-May-16 10:27 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx    45205 b- defN 23-May-16 10:27 mlrun/runtimes/function.py
--rw-r--r--  2.0 unx     4911 b- defN 23-May-16 10:27 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     6530 b- defN 23-May-16 10:27 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    15140 b- defN 23-May-16 10:27 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    18982 b- defN 23-May-16 10:27 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx     2885 b- defN 23-May-16 10:27 mlrun/runtimes/nuclio.py
--rw-r--r--  2.0 unx    60808 b- defN 23-May-16 10:27 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7695 b- defN 23-May-16 10:27 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    29858 b- defN 23-May-16 10:27 mlrun/runtimes/serving.py
--rw-r--r--  2.0 unx    21222 b- defN 23-May-16 10:27 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      790 b- defN 23-May-16 10:27 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx    14713 b- defN 23-May-16 10:27 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx    13845 b- defN 23-May-16 10:27 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     8460 b- defN 23-May-16 10:27 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      673 b- defN 23-May-16 10:27 mlrun/runtimes/package/__init__.py
--rw-r--r--  2.0 unx    27068 b- defN 23-May-16 10:27 mlrun/runtimes/package/context_handler.py
--rw-r--r--  2.0 unx      751 b- defN 23-May-16 10:27 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    35028 b- defN 23-May-16 10:27 mlrun/runtimes/sparkjob/abstract.py
--rw-r--r--  2.0 unx    28746 b- defN 23-May-16 10:27 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 23-May-16 10:27 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 23-May-16 10:27 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18038 b- defN 23-May-16 10:27 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    55277 b- defN 23-May-16 10:27 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    20247 b- defN 23-May-16 10:27 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 23-May-16 10:27 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    53940 b- defN 23-May-16 10:27 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3902 b- defN 23-May-16 10:27 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11814 b- defN 23-May-16 10:27 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    21460 b- defN 23-May-16 10:27 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      826 b- defN 23-May-16 10:27 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    10397 b- defN 23-May-16 10:27 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3456 b- defN 23-May-16 10:27 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     6245 b- defN 23-May-16 10:27 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1662 b- defN 23-May-16 10:27 mlrun/utils/db.py
--rw-r--r--  2.0 unx    42577 b- defN 23-May-16 10:27 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     7093 b- defN 23-May-16 10:27 mlrun/utils/http.py
--rw-r--r--  2.0 unx     5637 b- defN 23-May-16 10:27 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     9969 b- defN 23-May-16 10:27 mlrun/utils/model_monitoring.py
--rw-r--r--  2.0 unx     3954 b- defN 23-May-16 10:27 mlrun/utils/regex.py
--rw-r--r--  2.0 unx      883 b- defN 23-May-16 10:27 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1319 b- defN 23-May-16 10:27 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx    10447 b- defN 23-May-16 10:27 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 23-May-16 10:27 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx    12331 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     1803 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2177 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     1971 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     4742 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     2021 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3751 b- defN 23-May-16 10:27 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx      614 b- defN 23-May-16 10:27 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 23-May-16 10:27 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1970 b- defN 23-May-16 10:27 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/LICENSE
--rw-r--r--  2.0 unx    16892 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    38487 b- defN 23-May-16 10:27 mlrun-1.4.0rc5.dist-info/RECORD
-410 files, 4429066 bytes uncompressed, 1128071 bytes compressed:  74.5%
+Zip file size: 1191283 bytes, number of entries: 410
+-rw-r--r--  2.0 unx     8727 b- defN 23-May-21 20:28 mlrun/__init__.py
+-rw-r--r--  2.0 unx    49342 b- defN 23-May-21 20:28 mlrun/__main__.py
+-rw-r--r--  2.0 unx    55437 b- defN 23-May-21 20:28 mlrun/config.py
+-rw-r--r--  2.0 unx     6780 b- defN 23-May-21 20:28 mlrun/errors.py
+-rw-r--r--  2.0 unx    39096 b- defN 23-May-21 20:28 mlrun/execution.py
+-rw-r--r--  2.0 unx    15624 b- defN 23-May-21 20:28 mlrun/features.py
+-rw-r--r--  2.0 unx     4876 b- defN 23-May-21 20:28 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    29646 b- defN 23-May-21 20:28 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8360 b- defN 23-May-21 20:28 mlrun/lists.py
+-rw-r--r--  2.0 unx    57166 b- defN 23-May-21 20:28 mlrun/model.py
+-rw-r--r--  2.0 unx    11828 b- defN 23-May-21 20:28 mlrun/render.py
+-rw-r--r--  2.0 unx    64519 b- defN 23-May-21 20:28 mlrun/run.py
+-rw-r--r--  2.0 unx     7783 b- defN 23-May-21 20:28 mlrun/secrets.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/__init__.py
+-rw-r--r--  2.0 unx     2105 b- defN 23-May-21 20:28 mlrun/api/alembic.ini
+-rw-r--r--  2.0 unx      685 b- defN 23-May-21 20:28 mlrun/api/constants.py
+-rw-r--r--  2.0 unx    25653 b- defN 23-May-21 20:28 mlrun/api/initial_data.py
+-rw-r--r--  2.0 unx     6999 b- defN 23-May-21 20:28 mlrun/api/launcher.py
+-rw-r--r--  2.0 unx    26443 b- defN 23-May-21 20:28 mlrun/api/main.py
+-rw-r--r--  2.0 unx     5247 b- defN 23-May-21 20:28 mlrun/api/middlewares.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/api/__init__.py
+-rw-r--r--  2.0 unx     4243 b- defN 23-May-21 20:28 mlrun/api/api/api.py
+-rw-r--r--  2.0 unx     3197 b- defN 23-May-21 20:28 mlrun/api/api/deps.py
+-rw-r--r--  2.0 unx    36404 b- defN 23-May-21 20:28 mlrun/api/api/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/__init__.py
+-rw-r--r--  2.0 unx    10394 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/artifacts.py
+-rw-r--r--  2.0 unx     1199 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/auth.py
+-rw-r--r--  2.0 unx     3618 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/background_tasks.py
+-rw-r--r--  2.0 unx     1214 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/client_spec.py
+-rw-r--r--  2.0 unx     1175 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/clusterization_spec.py
+-rw-r--r--  2.0 unx    29543 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/feature_store.py
+-rw-r--r--  2.0 unx     6104 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/files.py
+-rw-r--r--  2.0 unx     5468 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/frontend_spec.py
+-rw-r--r--  2.0 unx    35206 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/functions.py
+-rw-r--r--  2.0 unx     5986 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/grafana_proxy.py
+-rw-r--r--  2.0 unx     1344 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/healthz.py
+-rw-r--r--  2.0 unx    10399 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/hub.py
+-rw-r--r--  2.0 unx     2450 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/logs.py
+-rw-r--r--  2.0 unx    15817 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/model_endpoints.py
+-rw-r--r--  2.0 unx     3756 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/operations.py
+-rw-r--r--  2.0 unx     9220 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/pipelines.py
+-rw-r--r--  2.0 unx    11494 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/projects.py
+-rw-r--r--  2.0 unx     9078 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/runs.py
+-rw-r--r--  2.0 unx     9063 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/runtime_resources.py
+-rw-r--r--  2.0 unx    10731 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/schedules.py
+-rw-r--r--  2.0 unx     6061 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/secrets.py
+-rw-r--r--  2.0 unx     5298 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/submit.py
+-rw-r--r--  2.0 unx     4894 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/tags.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/internal/__init__.py
+-rw-r--r--  2.0 unx     1043 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/internal/config.py
+-rw-r--r--  2.0 unx     1724 b- defN 23-May-21 20:28 mlrun/api/api/endpoints/internal/memory_reports.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-May-21 20:28 mlrun/api/crud/__init__.py
+-rw-r--r--  2.0 unx     5610 b- defN 23-May-21 20:28 mlrun/api/crud/artifacts.py
+-rw-r--r--  2.0 unx     7331 b- defN 23-May-21 20:28 mlrun/api/crud/client_spec.py
+-rw-r--r--  2.0 unx     1055 b- defN 23-May-21 20:28 mlrun/api/crud/clusterization_spec.py
+-rw-r--r--  2.0 unx    18628 b- defN 23-May-21 20:28 mlrun/api/crud/feature_store.py
+-rw-r--r--  2.0 unx     3556 b- defN 23-May-21 20:28 mlrun/api/crud/functions.py
+-rw-r--r--  2.0 unx    12025 b- defN 23-May-21 20:28 mlrun/api/crud/hub.py
+-rw-r--r--  2.0 unx     9729 b- defN 23-May-21 20:28 mlrun/api/crud/logs.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-May-21 20:28 mlrun/api/crud/notifications.py
+-rw-r--r--  2.0 unx    14030 b- defN 23-May-21 20:28 mlrun/api/crud/pipelines.py
+-rw-r--r--  2.0 unx    14269 b- defN 23-May-21 20:28 mlrun/api/crud/projects.py
+-rw-r--r--  2.0 unx     5963 b- defN 23-May-21 20:28 mlrun/api/crud/runs.py
+-rw-r--r--  2.0 unx     5575 b- defN 23-May-21 20:28 mlrun/api/crud/runtime_resources.py
+-rw-r--r--  2.0 unx    20145 b- defN 23-May-21 20:28 mlrun/api/crud/secrets.py
+-rw-r--r--  2.0 unx     3277 b- defN 23-May-21 20:28 mlrun/api/crud/tags.py
+-rw-r--r--  2.0 unx      722 b- defN 23-May-21 20:28 mlrun/api/crud/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    15692 b- defN 23-May-21 20:28 mlrun/api/crud/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    43000 b- defN 23-May-21 20:28 mlrun/api/crud/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/crud/runtimes/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/crud/runtimes/nuclio/__init__.py
+-rw-r--r--  2.0 unx    17168 b- defN 23-May-21 20:28 mlrun/api/crud/runtimes/nuclio/function.py
+-rw-r--r--  2.0 unx    11398 b- defN 23-May-21 20:28 mlrun/api/crud/runtimes/nuclio/helpers.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/db/__init__.py
+-rw-r--r--  2.0 unx    15056 b- defN 23-May-21 20:28 mlrun/api/db/base.py
+-rw-r--r--  2.0 unx      816 b- defN 23-May-21 20:28 mlrun/api/db/init_db.py
+-rw-r--r--  2.0 unx      993 b- defN 23-May-21 20:28 mlrun/api/db/session.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/__init__.py
+-rw-r--r--  2.0 unx   144159 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/db.py
+-rw-r--r--  2.0 unx     2340 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/helpers.py
+-rw-r--r--  2.0 unx     2542 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/session.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx    20642 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/models/models_mysql.py
+-rw-r--r--  2.0 unx    18304 b- defN 23-May-21 20:28 mlrun/api/db/sqldb/models/models_sqlite.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/env.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
+-rw-r--r--  2.0 unx     4614 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
+-rw-r--r--  2.0 unx     1936 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
+-rw-r--r--  2.0 unx     1909 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1415 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
+-rw-r--r--  2.0 unx     1504 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1649 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx    24057 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
+-rw-r--r--  2.0 unx     2457 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
+-rw-r--r--  2.0 unx     1351 b- defN 23-May-21 20:28 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/env.py
+-rw-r--r--  2.0 unx    11473 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
+-rw-r--r--  2.0 unx     1348 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
+-rw-r--r--  2.0 unx     5180 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
+-rw-r--r--  2.0 unx     2595 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
+-rw-r--r--  2.0 unx     1388 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     1767 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1360 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
+-rw-r--r--  2.0 unx     1259 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
+-rw-r--r--  2.0 unx     2147 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
+-rw-r--r--  2.0 unx     1482 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1892 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
+-rw-r--r--  2.0 unx     1882 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
+-rw-r--r--  2.0 unx     1420 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
+-rw-r--r--  2.0 unx     2034 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
+-rw-r--r--  2.0 unx     1828 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
+-rw-r--r--  2.0 unx     1380 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
+-rw-r--r--  2.0 unx     1831 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx     3936 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
+-rw-r--r--  2.0 unx     2588 b- defN 23-May-21 20:28 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
+-rw-r--r--  2.0 unx    13338 b- defN 23-May-21 20:28 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/__init__.py
+-rw-r--r--  2.0 unx     1092 b- defN 23-May-21 20:28 mlrun/api/utils/asyncio.py
+-rw-r--r--  2.0 unx     7371 b- defN 23-May-21 20:28 mlrun/api/utils/background_tasks.py
+-rw-r--r--  2.0 unx    25560 b- defN 23-May-21 20:28 mlrun/api/utils/builder.py
+-rw-r--r--  2.0 unx     2431 b- defN 23-May-21 20:28 mlrun/api/utils/helpers.py
+-rw-r--r--  2.0 unx     3728 b- defN 23-May-21 20:28 mlrun/api/utils/memory_reports.py
+-rw-r--r--  2.0 unx     2599 b- defN 23-May-21 20:28 mlrun/api/utils/periodic.py
+-rw-r--r--  2.0 unx    39305 b- defN 23-May-21 20:28 mlrun/api/utils/scheduler.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/auth/__init__.py
+-rw-r--r--  2.0 unx    12383 b- defN 23-May-21 20:28 mlrun/api/utils/auth/verifier.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/auth/providers/__init__.py
+-rw-r--r--  2.0 unx     1381 b- defN 23-May-21 20:28 mlrun/api/utils/auth/providers/base.py
+-rw-r--r--  2.0 unx     1460 b- defN 23-May-21 20:28 mlrun/api/utils/auth/providers/nop.py
+-rw-r--r--  2.0 unx    10883 b- defN 23-May-21 20:28 mlrun/api/utils/auth/providers/opa.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/clients/__init__.py
+-rw-r--r--  2.0 unx    13271 b- defN 23-May-21 20:28 mlrun/api/utils/clients/chief.py
+-rw-r--r--  2.0 unx    31249 b- defN 23-May-21 20:28 mlrun/api/utils/clients/iguazio.py
+-rw-r--r--  2.0 unx    12109 b- defN 23-May-21 20:28 mlrun/api/utils/clients/log_collector.py
+-rw-r--r--  2.0 unx     9916 b- defN 23-May-21 20:28 mlrun/api/utils/clients/nuclio.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/clients/protocols/__init__.py
+-rw-r--r--  2.0 unx     2567 b- defN 23-May-21 20:28 mlrun/api/utils/clients/protocols/grpc.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/db/__init__.py
+-rw-r--r--  2.0 unx     3305 b- defN 23-May-21 20:28 mlrun/api/utils/db/alembic.py
+-rw-r--r--  2.0 unx     8214 b- defN 23-May-21 20:28 mlrun/api/utils/db/backup.py
+-rw-r--r--  2.0 unx     3787 b- defN 23-May-21 20:28 mlrun/api/utils/db/mysql.py
+-rw-r--r--  2.0 unx      992 b- defN 23-May-21 20:28 mlrun/api/utils/db/sql_collation.py
+-rw-r--r--  2.0 unx     3861 b- defN 23-May-21 20:28 mlrun/api/utils/db/sqlite_migration.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/projects/__init__.py
+-rw-r--r--  2.0 unx    17423 b- defN 23-May-21 20:28 mlrun/api/utils/projects/follower.py
+-rw-r--r--  2.0 unx    19372 b- defN 23-May-21 20:28 mlrun/api/utils/projects/leader.py
+-rw-r--r--  2.0 unx     7133 b- defN 23-May-21 20:28 mlrun/api/utils/projects/member.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/projects/remotes/__init__.py
+-rw-r--r--  2.0 unx     2659 b- defN 23-May-21 20:28 mlrun/api/utils/projects/remotes/follower.py
+-rw-r--r--  2.0 unx     2094 b- defN 23-May-21 20:28 mlrun/api/utils/projects/remotes/leader.py
+-rw-r--r--  2.0 unx     5000 b- defN 23-May-21 20:28 mlrun/api/utils/projects/remotes/nop_follower.py
+-rw-r--r--  2.0 unx     3861 b- defN 23-May-21 20:28 mlrun/api/utils/projects/remotes/nop_leader.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/__init__.py
+-rw-r--r--  2.0 unx     1202 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/db.py
+-rw-r--r--  2.0 unx    22651 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/k8s.py
+-rw-r--r--  2.0 unx      840 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/logs_dir.py
+-rw-r--r--  2.0 unx     1279 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/project_member.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-May-21 20:28 mlrun/api/utils/singletons/scheduler.py
+-rw-r--r--  2.0 unx     1091 b- defN 23-May-21 20:28 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    30849 b- defN 23-May-21 20:28 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    20432 b- defN 23-May-21 20:28 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    12594 b- defN 23-May-21 20:28 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    23673 b- defN 23-May-21 20:28 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15383 b- defN 23-May-21 20:28 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-21 20:28 mlrun/common/__init__.py
+-rw-r--r--  2.0 unx      660 b- defN 23-May-21 20:28 mlrun/common/constants.py
+-rw-r--r--  2.0 unx     5670 b- defN 23-May-21 20:28 mlrun/common/model_monitoring.py
+-rw-r--r--  2.0 unx      790 b- defN 23-May-21 20:28 mlrun/common/types.py
+-rw-r--r--  2.0 unx     3973 b- defN 23-May-21 20:28 mlrun/common/schemas/__init__.py
+-rw-r--r--  2.0 unx     1923 b- defN 23-May-21 20:28 mlrun/common/schemas/artifact.py
+-rw-r--r--  2.0 unx     5251 b- defN 23-May-21 20:28 mlrun/common/schemas/auth.py
+-rw-r--r--  2.0 unx     1553 b- defN 23-May-21 20:28 mlrun/common/schemas/background_task.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-May-21 20:28 mlrun/common/schemas/client_spec.py
+-rw-r--r--  2.0 unx      888 b- defN 23-May-21 20:28 mlrun/common/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     6243 b- defN 23-May-21 20:28 mlrun/common/schemas/constants.py
+-rw-r--r--  2.0 unx     3671 b- defN 23-May-21 20:28 mlrun/common/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2546 b- defN 23-May-21 20:28 mlrun/common/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     3971 b- defN 23-May-21 20:28 mlrun/common/schemas/function.py
+-rw-r--r--  2.0 unx      705 b- defN 23-May-21 20:28 mlrun/common/schemas/http.py
+-rw-r--r--  2.0 unx     4245 b- defN 23-May-21 20:28 mlrun/common/schemas/hub.py
+-rw-r--r--  2.0 unx     1395 b- defN 23-May-21 20:28 mlrun/common/schemas/k8s.py
+-rw-r--r--  2.0 unx      920 b- defN 23-May-21 20:28 mlrun/common/schemas/memory_reports.py
+-rw-r--r--  2.0 unx    12593 b- defN 23-May-21 20:28 mlrun/common/schemas/model_endpoints.py
+-rw-r--r--  2.0 unx      879 b- defN 23-May-21 20:28 mlrun/common/schemas/notification.py
+-rw-r--r--  2.0 unx     1907 b- defN 23-May-21 20:28 mlrun/common/schemas/object.py
+-rw-r--r--  2.0 unx     1184 b- defN 23-May-21 20:28 mlrun/common/schemas/pipeline.py
+-rw-r--r--  2.0 unx     4094 b- defN 23-May-21 20:28 mlrun/common/schemas/project.py
+-rw-r--r--  2.0 unx     1636 b- defN 23-May-21 20:28 mlrun/common/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4188 b- defN 23-May-21 20:28 mlrun/common/schemas/schedule.py
+-rw-r--r--  2.0 unx     1484 b- defN 23-May-21 20:28 mlrun/common/schemas/secret.py
+-rw-r--r--  2.0 unx      905 b- defN 23-May-21 20:28 mlrun/common/schemas/tag.py
+-rw-r--r--  2.0 unx     1087 b- defN 23-May-21 20:28 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4647 b- defN 23-May-21 20:28 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     5813 b- defN 23-May-21 20:28 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9426 b- defN 23-May-21 20:28 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     3443 b- defN 23-May-21 20:28 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     6946 b- defN 23-May-21 20:28 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    18274 b- defN 23-May-21 20:28 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     7995 b- defN 23-May-21 20:28 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx     3791 b- defN 23-May-21 20:28 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     5114 b- defN 23-May-21 20:28 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx     2627 b- defN 23-May-21 20:28 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     4873 b- defN 23-May-21 20:28 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-May-21 20:28 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx    34280 b- defN 23-May-21 20:28 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1410 b- defN 23-May-21 20:28 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     6895 b- defN 23-May-21 20:28 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    62060 b- defN 23-May-21 20:28 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     2900 b- defN 23-May-21 20:28 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     8097 b- defN 23-May-21 20:28 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 23-May-21 20:28 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6152 b- defN 23-May-21 20:28 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     2816 b- defN 23-May-21 20:28 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    15968 b- defN 23-May-21 20:28 mlrun/db/base.py
+-rw-r--r--  2.0 unx   130841 b- defN 23-May-21 20:28 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    13197 b- defN 23-May-21 20:28 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx    25577 b- defN 23-May-21 20:28 mlrun/db/sqldb.py
+-rw-r--r--  2.0 unx     1501 b- defN 23-May-21 20:28 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    43719 b- defN 23-May-21 20:28 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12781 b- defN 23-May-21 20:28 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    47683 b- defN 23-May-21 20:28 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    21940 b- defN 23-May-21 20:28 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11681 b- defN 23-May-21 20:28 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    28635 b- defN 23-May-21 20:28 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1232 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    25911 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx     4261 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     7141 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4765 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx     3352 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/online.py
+-rw-r--r--  2.0 unx     9661 b- defN 23-May-21 20:28 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 23-May-21 20:28 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11466 b- defN 23-May-21 20:28 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 23-May-21 20:28 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8515 b- defN 23-May-21 20:28 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    21018 b- defN 23-May-21 20:28 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55376 b- defN 23-May-21 20:28 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3469 b- defN 23-May-21 20:28 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5757 b- defN 23-May-21 20:28 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9209 b- defN 23-May-21 20:28 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11531 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14777 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    28414 b- defN 23-May-21 20:28 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3169 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16957 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2368 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4881 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10490 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5684 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6453 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     5212 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6078 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6658 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5318 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6993 b- defN 23-May-21 20:28 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 23-May-21 20:28 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    23796 b- defN 23-May-21 20:28 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 23-May-21 20:28 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6083 b- defN 23-May-21 20:28 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15883 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13891 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9189 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8278 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5156 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4137 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1624 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14256 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 23-May-21 20:28 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 23-May-21 20:28 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6098 b- defN 23-May-21 20:28 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2405 b- defN 23-May-21 20:28 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6203 b- defN 23-May-21 20:28 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7061 b- defN 23-May-21 20:28 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22056 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27904 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44639 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22465 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10136 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11524 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23166 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9310 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26661 b- defN 23-May-21 20:28 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10892 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5852 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7117 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12215 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14126 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4745 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-May-21 20:28 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10455 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16627 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28247 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9565 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21886 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8791 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28728 b- defN 23-May-21 20:28 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10287 b- defN 23-May-21 20:28 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 23-May-21 20:28 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11617 b- defN 23-May-21 20:28 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 23-May-21 20:28 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      577 b- defN 23-May-21 20:28 mlrun/launcher/__init__.py
+-rw-r--r--  2.0 unx    14923 b- defN 23-May-21 20:28 mlrun/launcher/base.py
+-rw-r--r--  2.0 unx     6051 b- defN 23-May-21 20:28 mlrun/launcher/client.py
+-rw-r--r--  2.0 unx     1883 b- defN 23-May-21 20:28 mlrun/launcher/factory.py
+-rw-r--r--  2.0 unx    10303 b- defN 23-May-21 20:28 mlrun/launcher/local.py
+-rw-r--r--  2.0 unx     6807 b- defN 23-May-21 20:28 mlrun/launcher/remote.py
+-rw-r--r--  2.0 unx      760 b- defN 23-May-21 20:28 mlrun/mlutils/__init__.py
+-rw-r--r--  2.0 unx     5325 b- defN 23-May-21 20:28 mlrun/mlutils/data.py
+-rw-r--r--  2.0 unx     2598 b- defN 23-May-21 20:28 mlrun/mlutils/models.py
+-rw-r--r--  2.0 unx    30120 b- defN 23-May-21 20:28 mlrun/mlutils/plots.py
+-rw-r--r--  2.0 unx     1208 b- defN 23-May-21 20:28 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    23948 b- defN 23-May-21 20:28 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     9756 b- defN 23-May-21 20:28 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     5196 b- defN 23-May-21 20:28 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx    36885 b- defN 23-May-21 20:28 mlrun/model_monitoring/model_monitoring_batch.py
+-rw-r--r--  2.0 unx    43172 b- defN 23-May-21 20:28 mlrun/model_monitoring/stream_processing_fs.py
+-rw-r--r--  2.0 unx     4240 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/__init__.py
+-rw-r--r--  2.0 unx    17357 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
+-rw-r--r--  2.0 unx     5695 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/model_endpoint_store.py
+-rw-r--r--  2.0 unx    15706 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
+-rw-r--r--  2.0 unx      884 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/models/__init__.py
+-rw-r--r--  2.0 unx      655 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/models/base.py
+-rw-r--r--  2.0 unx     3741 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/models/mysql.py
+-rw-r--r--  2.0 unx     3658 b- defN 23-May-21 20:28 mlrun/model_monitoring/stores/models/sqlite.py
+-rw-r--r--  2.0 unx     2400 b- defN 23-May-21 20:28 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    24102 b- defN 23-May-21 20:28 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11852 b- defN 23-May-21 20:28 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 23-May-21 20:28 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    17480 b- defN 23-May-21 20:28 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    38343 b- defN 23-May-21 20:28 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   111205 b- defN 23-May-21 20:28 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     8773 b- defN 23-May-21 20:28 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx    86765 b- defN 23-May-21 20:28 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     6689 b- defN 23-May-21 20:28 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    30353 b- defN 23-May-21 20:28 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx     9561 b- defN 23-May-21 20:28 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx    45205 b- defN 23-May-21 20:28 mlrun/runtimes/function.py
+-rw-r--r--  2.0 unx     4911 b- defN 23-May-21 20:28 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     6530 b- defN 23-May-21 20:28 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx    15213 b- defN 23-May-21 20:28 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    18982 b- defN 23-May-21 20:28 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx     2885 b- defN 23-May-21 20:28 mlrun/runtimes/nuclio.py
+-rw-r--r--  2.0 unx    60808 b- defN 23-May-21 20:28 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7695 b- defN 23-May-21 20:28 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    29858 b- defN 23-May-21 20:28 mlrun/runtimes/serving.py
+-rw-r--r--  2.0 unx    21048 b- defN 23-May-21 20:28 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      790 b- defN 23-May-21 20:28 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx    14713 b- defN 23-May-21 20:28 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx    13845 b- defN 23-May-21 20:28 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     8460 b- defN 23-May-21 20:28 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      673 b- defN 23-May-21 20:28 mlrun/runtimes/package/__init__.py
+-rw-r--r--  2.0 unx    27068 b- defN 23-May-21 20:28 mlrun/runtimes/package/context_handler.py
+-rw-r--r--  2.0 unx      751 b- defN 23-May-21 20:28 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    35028 b- defN 23-May-21 20:28 mlrun/runtimes/sparkjob/abstract.py
+-rw-r--r--  2.0 unx    28746 b- defN 23-May-21 20:28 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 23-May-21 20:28 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 23-May-21 20:28 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    18038 b- defN 23-May-21 20:28 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    55277 b- defN 23-May-21 20:28 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    20247 b- defN 23-May-21 20:28 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 23-May-21 20:28 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    54169 b- defN 23-May-21 20:28 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3902 b- defN 23-May-21 20:28 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11814 b- defN 23-May-21 20:28 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    21460 b- defN 23-May-21 20:28 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      826 b- defN 23-May-21 20:28 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    10397 b- defN 23-May-21 20:28 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3456 b- defN 23-May-21 20:28 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     6245 b- defN 23-May-21 20:28 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1662 b- defN 23-May-21 20:28 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    42577 b- defN 23-May-21 20:28 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     7093 b- defN 23-May-21 20:28 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-May-21 20:28 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     9969 b- defN 23-May-21 20:28 mlrun/utils/model_monitoring.py
+-rw-r--r--  2.0 unx     3954 b- defN 23-May-21 20:28 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx      883 b- defN 23-May-21 20:28 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1319 b- defN 23-May-21 20:28 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx    10447 b- defN 23-May-21 20:28 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 23-May-21 20:28 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    12331 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     1803 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2177 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     1971 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     4742 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     2021 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3751 b- defN 23-May-21 20:28 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx      614 b- defN 23-May-21 20:28 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 23-May-21 20:28 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1970 b- defN 23-May-21 20:28 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/LICENSE
+-rw-r--r--  2.0 unx    16892 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    38488 b- defN 23-May-21 20:28 mlrun-1.4.0rc6.dist-info/RECORD
+410 files, 4440818 bytes uncompressed, 1129893 bytes compressed:  74.6%
```

## zipnote {}

```diff
@@ -1206,26 +1206,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/LICENSE
+Filename: mlrun-1.4.0rc6.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/METADATA
+Filename: mlrun-1.4.0rc6.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/WHEEL
+Filename: mlrun-1.4.0rc6.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/entry_points.txt
+Filename: mlrun-1.4.0rc6.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/top_level.txt
+Filename: mlrun-1.4.0rc6.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.4.0rc5.dist-info/RECORD
+Filename: mlrun-1.4.0rc6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/config.py

```diff
@@ -44,14 +44,18 @@
 env_file_key = f"{env_prefix}CONFIG_FILE"
 _load_lock = Lock()
 _none_type = type(None)
 default_env_file = os.getenv("MLRUN_DEFAULT_ENV_FILE", "~/.mlrun.env")
 
 default_config = {
     "namespace": "",  # default kubernetes namespace
+    "kubernetes": {
+        "kubeconfig_path": "",  # local path to kubeconfig file (for development purposes),
+        # empty by default as the API already running inside k8s cluster
+    },
     "dbpath": "",  # db/api url
     # url to nuclio dashboard api (can be with user & token, e.g. https://username:password@dashboard-url.com)
     "nuclio_dashboard_url": "",
     "nuclio_version": "",
     "default_nuclio_runtime": "python:3.9",
     "nest_asyncio_enabled": "",  # enable import of nest_asyncio for corner cases with old jupyter, set "1"
     "ui_url": "",  # remote/external mlrun UI url (for hyperlinks) (This is deprecated in favor of the ui block)
@@ -73,14 +77,16 @@
     "spark_app_image": "",  # image to use for spark operator app runtime
     "spark_app_image_tag": "",  # image tag to use for spark operator app runtime
     "spark_history_server_path": "",  # spark logs directory for spark history server
     "spark_operator_version": "spark-3",  # the version of the spark operator in use
     "builder_alpine_image": "alpine:3.13.1",  # builder alpine image (as kaniko's initContainer)
     "package_path": "mlrun",  # mlrun pip package
     "default_base_image": "mlrun/mlrun",  # default base image when doing .deploy()
+    # template for project default image name. Parameter {name} will be replaced with project name
+    "default_project_image_name": ".mlrun-project-image-{name}",
     "default_project": "default",  # default project name
     "default_archive": "",  # default remote archive URL (for build tar.gz)
     "mpijob_crd_version": "",  # mpijob crd version (e.g: "v1alpha1". must be in: mlrun.runtime.MPIJobCRDVersions)
     "hub_url": "https://raw.githubusercontent.com/mlrun/functions/{tag}/{name}/function.yaml",
     "ipython_widget": True,
     "log_level": "INFO",
     # log formatter (options: human | json)
@@ -226,28 +232,36 @@
         "db": {
             "commit_retry_timeout": 30,
             "commit_retry_interval": 3,
             "conflict_retry_timeout": 15,
             "conflict_retry_interval": None,
             # Whether to perform data migrations on initialization. enabled or disabled
             "data_migrations_mode": "enabled",
-            # Whether or not to perform database migration from sqlite to mysql on initialization
+            # Whether to perform database migration from sqlite to mysql on initialization
             "database_migration_mode": "enabled",
             "backup": {
-                # Whether or not to use db backups on initialization
+                # Whether to use db backups on initialization
                 "mode": "enabled",
                 "file_format": "db_backup_%Y%m%d%H%M.db",
                 "use_rotation": True,
                 "rotation_limit": 3,
                 # default is 16MB, max 1G, for more info https://dev.mysql.com/doc/refman/8.0/en/packet-too-large.html
                 "max_allowed_packet": 64000000,  # 64MB
             },
             # None will set this to be equal to the httpdb.max_workers
             "connections_pool_size": None,
             "connections_pool_max_overflow": None,
+            # below is a db-specific configuration
+            "mysql": {
+                # comma separated mysql modes (globally) to set on runtime
+                # optional values (as per https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sql-mode-full):
+                #
+                # if set to "nil" or "none", nothing would be set
+                "modes": "STRICT_TRANS_TABLES",
+            },
         },
         "jobs": {
             # whether to allow to run local runtimes in the API - configurable to allow the scheduler testing to work
             "allow_local_run": False,
         },
         "authentication": {
             "mode": "none",  # one of none, basic, bearer, iguazio
@@ -533,16 +547,15 @@
 
 
 def is_running_as_api():
     # MLRUN_IS_API_SERVER is set when running the api server which is being done through the CLI command mlrun db
     global _is_running_as_api
 
     if _is_running_as_api is None:
-        # os.getenv will load the env var as string, and json.loads will convert it to a bool
-        _is_running_as_api = json.loads(os.getenv("MLRUN_IS_API_SERVER", "false"))
+        _is_running_as_api = os.getenv("MLRUN_IS_API_SERVER", "false").lower() == "true"
 
     return _is_running_as_api
 
 
 class Config:
     _missing = object()
 
@@ -1024,15 +1037,15 @@
     with _load_lock:
         _do_populate(skip_errors=skip_errors)
 
 
 def _do_populate(env=None, skip_errors=False):
     global config
 
-    if not os.environ.get("MLRUN_IGNORE_ENV_FILE") and not is_running_as_api():
+    if not os.environ.get("MLRUN_IGNORE_ENV_FILE"):
         if "MLRUN_ENV_FILE" in os.environ:
             env_file = os.path.expanduser(os.environ["MLRUN_ENV_FILE"])
             dotenv.load_dotenv(env_file, override=True)
         else:
             env_file = os.path.expanduser(default_env_file)
             if os.path.isfile(env_file):
                 dotenv.load_dotenv(env_file, override=True)
```

## mlrun/k8s_utils.py

```diff
@@ -21,15 +21,15 @@
 from .config import config as mlconfig
 
 _running_inside_kubernetes_cluster = None
 
 
 def is_running_inside_kubernetes_cluster():
     global _running_inside_kubernetes_cluster
-    if _running_inside_kubernetes_cluster is not None:
+    if _running_inside_kubernetes_cluster is None:
         try:
             kubernetes.config.load_incluster_config()
             _running_inside_kubernetes_cluster = True
         except kubernetes.config.ConfigException:
             _running_inside_kubernetes_cluster = False
     return _running_inside_kubernetes_cluster
```

## mlrun/kfpops.py

```diff
@@ -222,15 +222,15 @@
     :param param_file:  a csv/json file with parameter combinations, first csv row hold
                         the parameter names, following rows hold param values
     :param selector: selection criteria for hyperparams e.g. "max.accuracy"
     :param hyper_param_options: hyper param options class, see: :py:class:`~mlrun.model.HyperParamOptions`
     :param labels:   labels to tag the job/run with ({key:val, ..})
     :param inputs:   dictionary of input objects + optional paths (if path is
                      omitted the path will be the in_path/key.
-    :param outputs:  dictionary of input objects + optional paths (if path is
+    :param outputs:  dictionary of output objects + optional paths (if path is
                      omitted the path will be the out_path/key.
     :param in_path:  default input path/url (prefix) for inputs
     :param out_path: default output path/url (prefix) for artifacts
     :param rundb:    path for rundb (or use 'MLRUN_DBPATH' env instead)
     :param mode:     run mode, e.g. 'pass' for using the command without mlrun wrapper
     :param handler   code entry-point/handler name
     :param job_image name of the image user for the job
```

## mlrun/model.py

```diff
@@ -12,14 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import inspect
 import pathlib
 import re
 import time
+import typing
 from collections import OrderedDict
 from copy import deepcopy
 from datetime import datetime
 from os import environ
 from typing import Any, Dict, List, Optional, Tuple, Union
 
 import mlrun
@@ -373,14 +374,123 @@
             raise mlrun.errors.MLRunInvalidArgumentError(
                 f"source ({source}) must be a compressed (tar.gz / zip) file, a git repo, "
                 f"a file path or in the project's context (.)"
             )
 
         self._source = source
 
+    def build_config(
+        self,
+        image="",
+        base_image=None,
+        commands: list = None,
+        secret=None,
+        source=None,
+        extra=None,
+        load_source_on_run=None,
+        with_mlrun=None,
+        auto_build=None,
+        requirements=None,
+        overwrite=False,
+    ):
+        if image:
+            self.image = image
+        if base_image:
+            self.base_image = base_image
+        if commands:
+            self.with_commands(commands, overwrite=overwrite)
+        if requirements:
+            self.with_requirements(requirements, overwrite=overwrite)
+        if extra:
+            self.extra = extra
+        if secret is not None:
+            self.secret = secret
+        if source:
+            self.source = source
+        if load_source_on_run:
+            self.load_source_on_run = load_source_on_run
+        if with_mlrun is not None:
+            self.with_mlrun = with_mlrun
+        if auto_build:
+            self.auto_build = auto_build
+
+    def with_commands(
+        self,
+        commands: List[str],
+        overwrite: bool = False,
+    ):
+        """add commands to build spec.
+
+        :param commands:  list of commands to run during build
+        :param overwrite: whether to overwrite the existing commands or add to them (the default)
+
+        :return: function object
+        """
+        if not isinstance(commands, list) or not all(
+            isinstance(item, str) for item in commands
+        ):
+            raise ValueError("commands must be a string list")
+        if not self.commands or overwrite:
+            self.commands = commands
+        else:
+            # add commands to existing build commands
+            for command in commands:
+                if command not in self.commands:
+                    self.commands.append(command)
+            # using list(set(x)) won't retain order,
+            # solution inspired from https://stackoverflow.com/a/17016257/8116661
+            self.commands = list(dict.fromkeys(self.commands))
+
+    def with_requirements(
+        self,
+        requirements: Union[str, List[str]],
+        overwrite: bool = False,
+    ):
+        """add package requirements from file or list to build spec.
+
+        :param requirements:  python requirements file path or list of packages
+        :param overwrite:     overwrite existing requirements
+        :return: function object
+        """
+        resolved_requirements = self._resolve_requirements(requirements)
+        requirements = self.requirements or [] if not overwrite else []
+
+        # make sure we don't append the same line twice
+        for requirement in resolved_requirements:
+            if requirement not in requirements:
+                requirements.append(requirement)
+
+        self.requirements = requirements
+
+    @staticmethod
+    def _resolve_requirements(requirements_to_resolve: typing.Union[str, list]) -> list:
+        # if a string, read the file then encode
+        if isinstance(requirements_to_resolve, str):
+            with open(requirements_to_resolve, "r") as fp:
+                requirements_to_resolve = fp.read().splitlines()
+
+        requirements = []
+        for requirement in requirements_to_resolve:
+            # clean redundant leading and trailing whitespaces
+            requirement = requirement.strip()
+
+            # ignore empty lines
+            # ignore comments
+            if not requirement or requirement.startswith("#"):
+                continue
+
+            # ignore inline comments as well
+            inline_comment = requirement.split(" #")
+            if len(inline_comment) > 1:
+                requirement = inline_comment[0].strip()
+
+            requirements.append(requirement)
+
+        return requirements
+
 
 class Notification(ModelObj):
     """Notification specification"""
 
     def __init__(
         self,
         kind=None,
```

## mlrun/run.py

```diff
@@ -648,16 +648,17 @@
             )
         elif kind in RuntimeKinds.nuclio_runtimes():
             runner.spec.function_handler = handler
         else:
             runner.spec.default_handler = handler
 
     if requirements:
-        runner.with_requirements(requirements)
-    runner.verify_base_image()
+        runner.with_requirements(requirements, prepare_image_for_deploy=False)
+
+    runner.prepare_image_for_deploy()
     return runner
 
 
 def _process_runtime(command, runtime, kind):
     if runtime and hasattr(runtime, "to_dict"):
         runtime = runtime.to_dict()
     if runtime and isinstance(runtime, dict):
@@ -917,15 +918,15 @@
         if code_output:
             r.spec.command = code_output
         else:
             r.spec.command = filename
 
     build.image = get_in(spec, "spec.build.image")
     update_common(r, spec)
-    r.verify_base_image()
+    r.prepare_image_for_deploy()
 
     if with_doc:
         update_function_entry_points(r, code)
     r.spec.default_handler = handler
     return r
```

## mlrun/api/initial_data.py

```diff
@@ -40,15 +40,28 @@
 from mlrun.utils import is_legacy_artifact, logger
 
 
 def init_data(
     from_scratch: bool = False, perform_migrations_if_needed: bool = False
 ) -> None:
     logger.info("Initializing DB data")
-    mlrun.api.utils.db.mysql.MySQLUtil.wait_for_db_liveness(logger)
+
+    # create mysql util, and if mlrun is configured to use mysql, wait for it to be live and set its db modes
+    mysql_util = mlrun.api.utils.db.mysql.MySQLUtil(logger)
+    if mysql_util.get_mysql_dsn_data():
+        mysql_util.wait_for_db_liveness()
+        mysql_util.set_modes(mlrun.mlconf.httpdb.db.mysql.modes)
+    else:
+        dsn = mysql_util.get_dsn()
+        if "sqlite" in dsn:
+            logger.debug("SQLite DB is used, liveness check not needed")
+        else:
+            logger.warn(
+                f"Invalid mysql dsn: {dsn}, assuming live and skipping liveness verification"
+            )
 
     sqlite_migration_util = None
     if not from_scratch and config.httpdb.db.database_migration_mode == "enabled":
         sqlite_migration_util = (
             mlrun.api.utils.db.sqlite_migration.SQLiteMigrationUtil()
         )
     alembic_util = _create_alembic_util()
@@ -78,17 +91,17 @@
 
     if is_migration_from_scratch or is_migration_needed:
         try:
             _perform_schema_migrations(alembic_util)
 
             _perform_database_migration(sqlite_migration_util)
 
+            init_db()
             db_session = create_session()
             try:
-                init_db(db_session)
                 _add_initial_data(db_session)
                 _perform_data_migrations(db_session)
             finally:
                 close_session(db_session)
         except Exception:
             state = mlrun.common.schemas.APIStates.migrations_failed
             logger.warning("Migrations failed, changing API state", state=state)
@@ -101,17 +114,19 @@
         config.httpdb.state = mlrun.common.schemas.APIStates.migrations_completed
     else:
         config.httpdb.state = mlrun.common.schemas.APIStates.online
     logger.info("Initial data created")
 
 
 # If the data_table version doesn't exist, we can assume the data version is 1.
-# This is because data version 1 points to to a data migration which was added back in 0.6.0, and
+# This is because data version 1 points to a data migration which was added back in 0.6.0, and
 # upgrading from a version earlier than 0.6.0 to v>=0.8.0 is not supported.
 data_version_prior_to_table_addition = 1
+
+# NOTE: Bump this number when adding a new data migration
 latest_data_version = 3
 
 
 def _resolve_needed_operations(
     alembic_util: mlrun.api.utils.db.alembic.AlembicUtil,
     sqlite_migration_util: typing.Optional[
         mlrun.api.utils.db.sqlite_migration.SQLiteMigrationUtil
```

## mlrun/api/launcher.py

```diff
@@ -139,18 +139,14 @@
         self._save_or_push_notifications(run)
 
         runtime._post_run(result, execution)  # hook for runtime specific cleanup
 
         return self._wrap_run_result(runtime, result, run, err=last_err)
 
     @staticmethod
-    def verify_base_image(runtime):
-        pass
-
-    @staticmethod
     def _enrich_runtime(runtime):
         pass
 
     def _save_or_push_notifications(self, runobj):
         if not runobj.spec.notifications:
             mlrun.utils.logger.debug(
                 "No notifications to push for run", run_uid=runobj.metadata.uid
```

## mlrun/api/main.py

```diff
@@ -76,16 +76,17 @@
     openapi_url=f"{BASE_VERSIONED_API_PREFIX}/openapi.json",
     docs_url=f"{BASE_VERSIONED_API_PREFIX}/docs",
     redoc_url=f"{BASE_VERSIONED_API_PREFIX}/redoc",
     default_response_class=fastapi.responses.ORJSONResponse,
 )
 app.include_router(api_router, prefix=BASE_VERSIONED_API_PREFIX)
 # This is for backward compatibility, that is why we still leave it here but not include it in the schema
-# so new users won't use the old un-versioned api
-# TODO: remove in 1.4.0
+# so new users won't use the old un-versioned api.
+# /api points to /api/v1 since it is used externally, and we don't want to break it.
+# TODO: make sure UI and all relevant Iguazio versions uses /api/v1 and deprecate this
 app.include_router(api_router, prefix=API_PREFIX, include_in_schema=False)
 
 init_middlewares(app)
 
 
 @app.exception_handler(Exception)
 async def generic_error_handler(request: fastapi.Request, exc: Exception):
@@ -116,16 +117,16 @@
         fastapi.HTTPException(status_code=status_code, detail=error_message),
     )
 
 
 @app.on_event("startup")
 async def startup_event():
     logger.info(
-        "configuration dump",
-        dumped_config=config.dump_yaml(),
+        "On startup event handler called",
+        config=config.dump_yaml(),
         version=mlrun.utils.version.Version().get(),
     )
     loop = asyncio.get_running_loop()
     loop.set_default_executor(
         concurrent.futures.ThreadPoolExecutor(
             max_workers=int(config.httpdb.max_workers)
         )
```

## mlrun/api/api/endpoints/artifacts.py

```diff
@@ -28,16 +28,21 @@
 from mlrun.common.schemas.artifact import ArtifactsFormat
 from mlrun.config import config
 from mlrun.utils import is_legacy_artifact, logger
 
 router = APIRouter()
 
 
-# TODO /artifact/{project}/{uid}/{key:path} should be deprecated in 1.4
-@router.post("/artifact/{project}/{uid}/{key:path}")
+# TODO: remove /artifact/{project}/{uid}/{key:path} in 1.6.0
+@router.post(
+    "/artifact/{project}/{uid}/{key:path}",
+    deprecated=True,
+    description="/artifact/{project}/{uid}/{key:path} is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/artifacts/{uid}/{key:path} instead",
+)
 @router.post("/projects/{project}/artifacts/{uid}/{key:path}")
 async def store_artifact(
     request: Request,
     project: str,
     uid: str,
     key: str,
     tag: str = "",
@@ -112,16 +117,21 @@
     return {
         "project": project,
         # Remove duplicities
         "tags": list(set(tags)),
     }
 
 
-# TODO /projects/{project}/artifact/{key:path} should be deprecated in 1.4
-@router.get("/projects/{project}/artifact/{key:path}")
+# TODO: remove /projects/{project}/artifact/{key:path} in 1.6.0
+@router.get(
+    "/projects/{project}/artifact/{key:path}",
+    deprecated=True,
+    description="/projects/{project}/artifact/{key:path} is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/artifacts/{key:path} instead",
+)
 @router.get("/projects/{project}/artifacts/{key:path}")
 async def get_artifact(
     project: str,
     key: str,
     tag: str = "latest",
     iter: int = 0,
     format_: ArtifactsFormat = Query(ArtifactsFormat.full, alias="format"),
@@ -145,16 +155,21 @@
         auth_info,
     )
     return {
         "data": data,
     }
 
 
-# TODO /artifact/{project}/{uid} should be deprecated in 1.4
-@router.delete("/artifact/{project}/{uid}")
+# TODO: remove /artifact/{project}/{uid} in 1.6.0
+@router.delete(
+    "/artifact/{project}/{uid}",
+    deprecated=True,
+    description="/artifact/{project}/{uid} is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/artifacts/{uid} instead",
+)
 @router.delete("/projects/{project}/artifacts/{uid}")
 async def delete_artifact(
     project: str,
     uid: str,
     key: str,
     tag: str = "",
     auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
@@ -169,16 +184,21 @@
     )
     await run_in_threadpool(
         mlrun.api.crud.Artifacts().delete_artifact, db_session, key, tag, project
     )
     return {}
 
 
-# TODO /artifacts should be deprecated in 1.4
-@router.get("/artifacts")
+# TODO: remove /artifacts in 1.6.0
+@router.get(
+    "/artifacts",
+    deprecated=True,
+    description="/artifacts is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/artifacts instead",
+)
 @router.get("/projects/{project}/artifacts")
 async def list_artifacts(
     project: str = None,
     name: str = None,
     tag: str = None,
     kind: str = None,
     category: mlrun.common.schemas.ArtifactCategories = None,
@@ -218,16 +238,21 @@
         auth_info,
     )
     return {
         "artifacts": artifacts,
     }
 
 
-# TODO /artifacts should be deprecated in 1.4
-@router.delete("/artifacts")
+# TODO: remove /artifacts in 1.6.0
+@router.delete(
+    "/artifacts",
+    deprecated=True,
+    description="/artifacts is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/artifacts instead",
+)
 async def delete_artifacts_legacy(
     project: str = mlrun.mlconf.default_project,
     name: str = "",
     tag: str = "",
     labels: List[str] = Query([], alias="label"),
     auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
     db_session: Session = Depends(deps.get_db_session),
```

## mlrun/api/api/endpoints/frontend_spec.py

```diff
@@ -35,21 +35,17 @@
     "/frontend-spec",
     response_model=mlrun.common.schemas.FrontendSpec,
 )
 def get_frontend_spec(
     auth_info: mlrun.common.schemas.AuthInfo = fastapi.Depends(
         mlrun.api.api.deps.authenticate_request
     ),
-    # In Iguazio 3.0 auth is turned off, but for this endpoint specifically the session is a must, so getting it from
-    # the cookie like it was before
-    # TODO: remove when Iguazio 3.0 is no longer relevant
-    session: typing.Optional[str] = fastapi.Cookie(None),
 ):
     jobs_dashboard_url = None
-    session = auth_info.session or session
+    session = auth_info.session
     if session and is_iguazio_session_cookie(session):
         jobs_dashboard_url = _resolve_jobs_dashboard_url(session)
     feature_flags = _resolve_feature_flags()
     registry, repository = mlrun.utils.helpers.get_parsed_docker_registry()
     repository = mlrun.utils.helpers.get_docker_repository_or_default(repository)
     function_deployment_target_image_template = (
         mlrun.runtimes.utils.fill_function_image_name_template(
```

## mlrun/api/api/endpoints/functions.py

```diff
@@ -54,15 +54,21 @@
 from mlrun.runtimes.utils import get_item_name
 from mlrun.utils import get_in, logger, parse_versioned_object_uri, update_in
 from mlrun.utils.model_monitoring import parse_model_endpoint_store_prefix
 
 router = APIRouter()
 
 
-@router.post("/func/{project}/{name}")
+@router.post(
+    "/func/{project}/{name}",
+    deprecated=True,
+    description="/func/{project}/{name} is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/functions/{name} instead",
+)
+@router.post("/projects/{project}/functions/{name}")
 async def store_function(
     request: Request,
     project: str,
     name: str,
     tag: str = "",
     versioned: bool = False,
     auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
@@ -99,15 +105,21 @@
         auth_info=auth_info,
     )
     return {
         "hash_key": hash_key,
     }
 
 
-@router.get("/func/{project}/{name}")
+@router.get(
+    "/func/{project}/{name}",
+    deprecated=True,
+    description="/func/{project}/{name} is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/functions/{name} instead",
+)
+@router.get("/projects/{project}/functions/{name}")
 async def get_function(
     project: str,
     name: str,
     tag: str = "",
     hash_key="",
     auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
     db_session: Session = Depends(deps.get_db_session),
@@ -150,15 +162,21 @@
     )
     await run_in_threadpool(
         mlrun.api.crud.Functions().delete_function, db_session, project, name
     )
     return Response(status_code=HTTPStatus.NO_CONTENT.value)
 
 
-@router.get("/funcs")
+@router.get(
+    "/funcs",
+    deprecated=True,
+    description="/funcs is deprecated in 1.4.0 and will be removed in 1.6.0, "
+    "use /projects/{project}/functions instead",
+)
+@router.get("/projects/{project}/functions")
 async def list_functions(
     project: str = None,
     name: str = None,
     tag: str = None,
     labels: List[str] = Query([], alias="label"),
     hash_key: str = None,
     auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
```

## mlrun/api/db/init_db.py

```diff
@@ -8,17 +8,16 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
-from sqlalchemy.orm import Session
 
 from mlrun.api.db.sqldb.models import Base
 from mlrun.api.db.sqldb.session import get_engine
 from mlrun.config import config
 
 
-def init_db(db_session: Session) -> None:
+def init_db() -> None:
     if config.httpdb.db_type != "filedb":
         Base.metadata.create_all(bind=get_engine())
```

## mlrun/api/db/sqldb/db.py

```diff
@@ -2777,25 +2777,14 @@
             uids.append(self._query(session, cls).get(tag.obj_id).uid)
         return uids
 
     def _query(self, session, cls, **kw):
         kw = {k: v for k, v in kw.items() if v is not None}
         return session.query(cls).filter_by(**kw)
 
-    def _function_latest_uid(self, session, project, name):
-        # FIXME
-        query = (
-            self._query(session, Function.uid)
-            .filter(Function.project == project, Function.name == name)
-            .order_by(Function.updated.desc())
-        ).limit(1)
-        out = query.one_or_none()
-        if out:
-            return out[0]
-
     def _find_or_create_users(self, session, user_names):
         users = list(self._query(session, User).filter(User.name.in_(user_names)))
         new = set(user_names) - {user.name for user in users}
         if new:
             for name in new:
                 user = User(name=name)
                 session.add(user)
```

## mlrun/api/utils/db/mysql.py

```diff
@@ -28,45 +28,32 @@
     )
     check_tables = [
         "projects",
         # check functions as well just in case the previous version used a projects leader
         "functions",
     ]
 
-    def __init__(self):
-        mysql_dsn_data = self.get_mysql_dsn_data()
-        if not mysql_dsn_data:
-            raise RuntimeError(f"Invalid mysql dsn: {self.get_dsn()}")
-
-    @staticmethod
-    def wait_for_db_liveness(logger, retry_interval=3, timeout=2 * 60):
-        logger.debug("Waiting for database liveness")
-        mysql_dsn_data = MySQLUtil.get_mysql_dsn_data()
-        if not mysql_dsn_data:
-            dsn = MySQLUtil.get_dsn()
-            if "sqlite" in dsn:
-                logger.debug("SQLite DB is used, liveness check not needed")
-            else:
-                logger.warn(
-                    f"Invalid mysql dsn: {MySQLUtil.get_dsn()}, assuming live and skipping liveness verification"
-                )
-            return
+    def __init__(self, logger: mlrun.utils.Logger):
+        self._logger = logger
 
+    def wait_for_db_liveness(self, retry_interval=3, timeout=2 * 60):
+        self._logger.debug("Waiting for database liveness")
+        mysql_dsn_data = self.get_mysql_dsn_data()
         tmp_connection = mlrun.utils.retry_until_successful(
             retry_interval,
             timeout,
-            logger,
+            self._logger,
             True,
             pymysql.connect,
             host=mysql_dsn_data["host"],
             user=mysql_dsn_data["username"],
             port=int(mysql_dsn_data["port"]),
             database=mysql_dsn_data["database"],
         )
-        logger.debug("Database ready for connection")
+        self._logger.debug("Database ready for connection")
         tmp_connection.close()
 
     def check_db_has_tables(self):
         connection = self._create_connection()
         try:
             with connection.cursor() as cursor:
                 cursor.execute(
@@ -74,14 +61,26 @@
                 )
                 if cursor.fetchone()[0] > 0:
                     return True
             return False
         finally:
             connection.close()
 
+    def set_modes(self, modes):
+        if not modes or modes in ["nil", "none"]:
+            self._logger.debug("No sql modes were given, bailing", modes=modes)
+            return
+        connection = self._create_connection()
+        try:
+            self._logger.debug("Setting sql modes", modes=modes)
+            with connection.cursor() as cursor:
+                cursor.execute("SET GLOBAL sql_mode=%s;", (modes,))
+        finally:
+            connection.close()
+
     def check_db_has_data(self):
         connection = self._create_connection()
         try:
             with connection.cursor() as cursor:
                 for check_table in self.check_tables:
                     cursor.execute("SELECT COUNT(*) FROM %s;", (check_table,))
                     if cursor.fetchone()[0] > 0:
@@ -98,17 +97,17 @@
             host=mysql_dsn_data["host"],
             user=mysql_dsn_data["username"],
             port=int(mysql_dsn_data["port"]),
             database=mysql_dsn_data["database"],
         )
 
     @staticmethod
-    def get_dsn() -> str:
-        return os.environ.get(MySQLUtil.dsn_env_var, "")
-
-    @staticmethod
     def get_mysql_dsn_data() -> typing.Optional[dict]:
         match = re.match(MySQLUtil.dsn_regex, MySQLUtil.get_dsn())
         if not match:
             return None
 
         return match.groupdict()
+
+    @staticmethod
+    def get_dsn() -> str:
+        return os.environ.get(MySQLUtil.dsn_env_var, "")
```

## mlrun/api/utils/db/sqlite_migration.py

```diff
@@ -60,15 +60,15 @@
     ]
 
     def __init__(self):
         self._mysql_dsn_data = MySQLUtil.get_mysql_dsn_data()
         self._migrator = self._create_migrator()
         self._mysql_util = None
         if self._mysql_dsn_data:
-            self._mysql_util = MySQLUtil()
+            self._mysql_util = MySQLUtil(logger)
 
     def is_database_migration_needed(self) -> bool:
         # if some data is missing, don't transfer the data
         if not self._migrator:
             return False
 
         db_has_data = False
```

## mlrun/api/utils/singletons/k8s.py

```diff
@@ -44,17 +44,17 @@
 
 class SecretTypes:
     opaque = "Opaque"
     v3io_fuse = "v3io/fuse"
 
 
 class K8sHelper:
-    def __init__(self, namespace=None, config_file=None, silent=False, log=True):
+    def __init__(self, namespace=None, silent=False, log=True):
         self.namespace = namespace or mlconfig.config.namespace
-        self.config_file = config_file
+        self.config_file = mlconfig.config.kubernetes.kubeconfig_path or None
         self.running_inside_kubernetes_cluster = False
         try:
             self._init_k8s_config(log)
             self.v1api = client.CoreV1Api()
             self.crdapi = client.CustomObjectsApi()
         except Exception as exc:
             logger.warning(
```

## mlrun/datastore/sources.py

```diff
@@ -167,15 +167,14 @@
 
         parse_dates = self._parse_dates or []
         if time_field and time_field not in parse_dates:
             parse_dates.append(time_field)
 
         return storey.CSVSource(
             paths=self.path,
-            header=True,
             build_dict=True,
             key_field=self.key_field or key_field,
             storage_options=self._get_store().get_storage_options(),
             parse_dates=parse_dates,
             **attributes,
         )
```

## mlrun/db/httpdb.py

```diff
@@ -2266,5910 +2266,5913 @@
 00008d90: 7428 290a 0a20 2020 2020 2020 2070 6172  t()..        par
 00008da0: 616d 7320 3d20 7b22 7461 6722 3a20 7461  ams = {"tag": ta
 00008db0: 672c 2022 7665 7273 696f 6e65 6422 3a20  g, "versioned": 
 00008dc0: 7665 7273 696f 6e65 647d 0a20 2020 2020  versioned}.     
 00008dd0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
 00008de0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
 00008df0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-00008e00: 2020 2020 2020 2070 6174 6820 3d20 7365         path = se
-00008e10: 6c66 2e5f 7061 7468 5f6f 6628 2266 756e  lf._path_of("fun
-00008e20: 6322 2c20 7072 6f6a 6563 742c 206e 616d  c", project, nam
-00008e30: 6529 0a0a 2020 2020 2020 2020 6572 726f  e)..        erro
-00008e40: 7220 3d20 6622 7374 6f72 6520 6675 6e63  r = f"store func
-00008e50: 7469 6f6e 207b 7072 6f6a 6563 747d 2f7b  tion {project}/{
-00008e60: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-00008e70: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-00008e80: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00008e90: 2022 504f 5354 222c 2070 6174 682c 2065   "POST", path, e
-00008ea0: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
-00008eb0: 616d 732c 2062 6f64 793d 6469 6374 5f74  ams, body=dict_t
-00008ec0: 6f5f 6a73 6f6e 2866 756e 6374 696f 6e29  o_json(function)
-00008ed0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00008ee0: 2020 2020 2320 6861 7368 206b 6579 206f      # hash key o
-00008ef0: 7074 696f 6e61 6c20 746f 2062 6520 6261  ptional to be ba
-00008f00: 636b 7761 7264 7320 636f 6d70 6174 6962  ckwards compatib
-00008f10: 6c65 2074 6f20 4150 4920 763c 302e 342e  le to API v<0.4.
-00008f20: 3130 2069 6e20 7768 6963 6820 6974 2077  10 in which it w
-00008f30: 6173 6e27 7420 696e 2074 6865 2072 6573  asn't in the res
-00008f40: 706f 6e73 650a 2020 2020 2020 2020 7265  ponse.        re
-00008f50: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-00008f60: 2e67 6574 2822 6861 7368 5f6b 6579 2229  .get("hash_key")
-00008f70: 0a0a 2020 2020 6465 6620 6765 745f 6675  ..    def get_fu
-00008f80: 6e63 7469 6f6e 2873 656c 662c 206e 616d  nction(self, nam
-00008f90: 652c 2070 726f 6a65 6374 3d22 222c 2074  e, project="", t
-00008fa0: 6167 3d4e 6f6e 652c 2068 6173 685f 6b65  ag=None, hash_ke
-00008fb0: 793d 2222 293a 0a20 2020 2020 2020 2022  y=""):.        "
-00008fc0: 2222 5265 7472 6965 7665 2064 6574 6169  ""Retrieve detai
-00008fd0: 6c73 206f 6620 6120 7370 6563 6966 6963  ls of a specific
-00008fe0: 2066 756e 6374 696f 6e2c 2069 6465 6e74   function, ident
-00008ff0: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
-00009000: 6520 616e 6420 706f 7465 6e74 6961 6c6c  e and potentiall
-00009010: 7920 6120 7461 6720 6f72 2066 756e 6374  y a tag or funct
-00009020: 696f 6e20 6861 7368 2e22 2222 0a0a 2020  ion hash."""..  
-00009030: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00009040: 2274 6167 223a 2074 6167 2c20 2268 6173  "tag": tag, "has
-00009050: 685f 6b65 7922 3a20 6861 7368 5f6b 6579  h_key": hash_key
-00009060: 7d0a 2020 2020 2020 2020 7072 6f6a 6563  }.        projec
-00009070: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
-00009080: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-00009090: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
-000090a0: 7468 203d 2073 656c 662e 5f70 6174 685f  th = self._path_
-000090b0: 6f66 2822 6675 6e63 222c 2070 726f 6a65  of("func", proje
-000090c0: 6374 2c20 6e61 6d65 290a 2020 2020 2020  ct, name).      
-000090d0: 2020 6572 726f 7220 3d20 6622 6765 7420    error = f"get 
-000090e0: 6675 6e63 7469 6f6e 207b 7072 6f6a 6563  function {projec
-000090f0: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
-00009100: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
-00009110: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
-00009120: 6174 682c 2065 7272 6f72 2c20 7061 7261  ath, error, para
-00009130: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
-00009140: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
-00009150: 736f 6e28 295b 2266 756e 6322 5d0a 0a20  son()["func"].. 
-00009160: 2020 2064 6566 2064 656c 6574 655f 6675     def delete_fu
-00009170: 6e63 7469 6f6e 2873 656c 662c 206e 616d  nction(self, nam
-00009180: 653a 2073 7472 2c20 7072 6f6a 6563 743a  e: str, project:
-00009190: 2073 7472 203d 2022 2229 3a0a 2020 2020   str = ""):.    
-000091a0: 2020 2020 2222 2244 656c 6574 6520 6120      """Delete a 
-000091b0: 6675 6e63 7469 6f6e 2062 656c 6f6e 6769  function belongi
-000091c0: 6e67 2074 6f20 6120 7370 6563 6966 6963  ng to a specific
-000091d0: 2070 726f 6a65 6374 2e22 2222 0a0a 2020   project."""..  
-000091e0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-000091f0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00009200: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00009210: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
-00009220: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00009230: 6a65 6374 7d2f 6675 6e63 7469 6f6e 732f  ject}/functions/
-00009240: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-00009250: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00009260: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
-00009270: 6720 6675 6e63 7469 6f6e 207b 7072 6f6a  g function {proj
-00009280: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
-00009290: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-000092a0: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
-000092b0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
-000092c0: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
-000092d0: 6675 6e63 7469 6f6e 7328 7365 6c66 2c20  functions(self, 
-000092e0: 6e61 6d65 3d4e 6f6e 652c 2070 726f 6a65  name=None, proje
-000092f0: 6374 3d4e 6f6e 652c 2074 6167 3d4e 6f6e  ct=None, tag=Non
-00009300: 652c 206c 6162 656c 733d 4e6f 6e65 293a  e, labels=None):
-00009310: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-00009320: 6965 7665 2061 206c 6973 7420 6f66 2066  ieve a list of f
-00009330: 756e 6374 696f 6e73 2c20 6669 6c74 6572  unctions, filter
-00009340: 6564 2062 7920 7370 6563 6966 6963 2063  ed by specific c
-00009350: 7269 7465 7269 612e 0a0a 2020 2020 2020  riteria...      
-00009360: 2020 3a70 6172 616d 206e 616d 653a 2052    :param name: R
-00009370: 6574 7572 6e20 6f6e 6c79 2066 756e 6374  eturn only funct
-00009380: 696f 6e73 2077 6974 6820 6120 7370 6563  ions with a spec
-00009390: 6966 6963 206e 616d 652e 0a20 2020 2020  ific name..     
-000093a0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-000093b0: 743a 2052 6574 7572 6e20 6675 6e63 7469  t: Return functi
-000093c0: 6f6e 7320 6265 6c6f 6e67 696e 6720 746f  ons belonging to
-000093d0: 2074 6869 7320 7072 6f6a 6563 742e 2049   this project. I
-000093e0: 6620 6e6f 7420 7370 6563 6966 6965 642c  f not specified,
-000093f0: 2074 6865 2064 6566 6175 6c74 2070 726f   the default pro
-00009400: 6a65 6374 2069 7320 7573 6564 2e0a 2020  ject is used..  
-00009410: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00009420: 3a20 5265 7475 726e 2066 756e 6374 696f  : Return functio
-00009430: 6e20 7665 7273 696f 6e73 2077 6974 6820  n versions with 
-00009440: 7370 6563 6966 6963 2074 6167 732e 0a20  specific tags.. 
-00009450: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
-00009460: 6265 6c73 3a20 5265 7475 726e 2066 756e  bels: Return fun
-00009470: 6374 696f 6e73 2074 6861 7420 6861 7665  ctions that have
-00009480: 2073 7065 6369 6669 6320 6c61 6265 6c73   specific labels
-00009490: 2061 7373 6967 6e65 6420 746f 2074 6865   assigned to the
-000094a0: 6d2e 0a20 2020 2020 2020 203a 7265 7475  m..        :retu
-000094b0: 726e 733a 204c 6973 7420 6f66 2066 756e  rns: List of fun
-000094c0: 6374 696f 6e20 6f62 6a65 6374 7320 2861  ction objects (a
-000094d0: 7320 6469 6374 696f 6e61 7279 292e 0a20  s dictionary).. 
-000094e0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-000094f0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00009500: 2020 2020 2020 2020 2020 2022 7072 6f6a             "proj
-00009510: 6563 7422 3a20 7072 6f6a 6563 7420 6f72  ect": project or
-00009520: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00009530: 7072 6f6a 6563 742c 0a20 2020 2020 2020  project,.       
-00009540: 2020 2020 2022 6e61 6d65 223a 206e 616d       "name": nam
-00009550: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00009560: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
-00009570: 2020 2020 2020 2022 6c61 6265 6c22 3a20         "label": 
-00009580: 6c61 6265 6c73 206f 7220 5b5d 2c0a 2020  labels or [],.  
-00009590: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000095a0: 6572 726f 7220 3d20 226c 6973 7420 6675  error = "list fu
-000095b0: 6e63 7469 6f6e 7322 0a20 2020 2020 2020  nctions".       
-000095c0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-000095d0: 5f63 616c 6c28 2247 4554 222c 2022 6675  _call("GET", "fu
-000095e0: 6e63 7322 2c20 6572 726f 722c 2070 6172  ncs", error, par
-000095f0: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00009600: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-00009610: 6a73 6f6e 2829 5b22 6675 6e63 7322 5d0a  json()["funcs"].
-00009620: 0a20 2020 2064 6566 206c 6973 745f 7275  .    def list_ru
-00009630: 6e74 696d 655f 7265 736f 7572 6365 7328  ntime_resources(
-00009640: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00009650: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-00009660: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00009670: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00009680: 6265 6c5f 7365 6c65 6374 6f72 3a20 4f70  bel_selector: Op
-00009690: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-000096a0: 6e65 2c0a 2020 2020 2020 2020 6b69 6e64  ne,.        kind
-000096b0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000096c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000096d0: 6f62 6a65 6374 5f69 643a 204f 7074 696f  object_id: Optio
+00008e00: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00008e10: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00008e20: 747d 2f66 756e 6374 696f 6e73 2f7b 6e61  t}/functions/{na
+00008e30: 6d65 7d22 0a0a 2020 2020 2020 2020 6572  me}"..        er
+00008e40: 726f 7220 3d20 6622 7374 6f72 6520 6675  ror = f"store fu
+00008e50: 6e63 7469 6f6e 207b 7072 6f6a 6563 747d  nction {project}
+00008e60: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+00008e70: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+00008e80: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00008e90: 2020 2022 504f 5354 222c 2070 6174 682c     "POST", path,
+00008ea0: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
+00008eb0: 6172 616d 732c 2062 6f64 793d 6469 6374  arams, body=dict
+00008ec0: 5f74 6f5f 6a73 6f6e 2866 756e 6374 696f  _to_json(functio
+00008ed0: 6e29 0a20 2020 2020 2020 2029 0a0a 2020  n).        )..  
+00008ee0: 2020 2020 2020 2320 6861 7368 206b 6579        # hash key
+00008ef0: 206f 7074 696f 6e61 6c20 746f 2062 6520   optional to be 
+00008f00: 6261 636b 7761 7264 7320 636f 6d70 6174  backwards compat
+00008f10: 6962 6c65 2074 6f20 4150 4920 763c 302e  ible to API v<0.
+00008f20: 342e 3130 2069 6e20 7768 6963 6820 6974  4.10 in which it
+00008f30: 2077 6173 6e27 7420 696e 2074 6865 2072   wasn't in the r
+00008f40: 6573 706f 6e73 650a 2020 2020 2020 2020  esponse.        
+00008f50: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
+00008f60: 2829 2e67 6574 2822 6861 7368 5f6b 6579  ().get("hash_key
+00008f70: 2229 0a0a 2020 2020 6465 6620 6765 745f  ")..    def get_
+00008f80: 6675 6e63 7469 6f6e 2873 656c 662c 206e  function(self, n
+00008f90: 616d 652c 2070 726f 6a65 6374 3d22 222c  ame, project="",
+00008fa0: 2074 6167 3d4e 6f6e 652c 2068 6173 685f   tag=None, hash_
+00008fb0: 6b65 793d 2222 293a 0a20 2020 2020 2020  key=""):.       
+00008fc0: 2022 2222 5265 7472 6965 7665 2064 6574   """Retrieve det
+00008fd0: 6169 6c73 206f 6620 6120 7370 6563 6966  ails of a specif
+00008fe0: 6963 2066 756e 6374 696f 6e2c 2069 6465  ic function, ide
+00008ff0: 6e74 6966 6965 6420 6279 2069 7473 206e  ntified by its n
+00009000: 616d 6520 616e 6420 706f 7465 6e74 6961  ame and potentia
+00009010: 6c6c 7920 6120 7461 6720 6f72 2066 756e  lly a tag or fun
+00009020: 6374 696f 6e20 6861 7368 2e22 2222 0a0a  ction hash."""..
+00009030: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00009040: 207b 2274 6167 223a 2074 6167 2c20 2268   {"tag": tag, "h
+00009050: 6173 685f 6b65 7922 3a20 6861 7368 5f6b  ash_key": hash_k
+00009060: 6579 7d0a 2020 2020 2020 2020 7072 6f6a  ey}.        proj
+00009070: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+00009080: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00009090: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+000090a0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+000090b0: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
+000090c0: 7469 6f6e 732f 7b6e 616d 657d 220a 2020  tions/{name}".  
+000090d0: 2020 2020 2020 6572 726f 7220 3d20 6622        error = f"
+000090e0: 6765 7420 6675 6e63 7469 6f6e 207b 7072  get function {pr
+000090f0: 6f6a 6563 747d 2f7b 6e61 6d65 7d22 0a20  oject}/{name}". 
+00009100: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+00009110: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
+00009120: 222c 2070 6174 682c 2065 7272 6f72 2c20  ", path, error, 
+00009130: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
+00009140: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00009150: 7370 2e6a 736f 6e28 295b 2266 756e 6322  sp.json()["func"
+00009160: 5d0a 0a20 2020 2064 6566 2064 656c 6574  ]..    def delet
+00009170: 655f 6675 6e63 7469 6f6e 2873 656c 662c  e_function(self,
+00009180: 206e 616d 653a 2073 7472 2c20 7072 6f6a   name: str, proj
+00009190: 6563 743a 2073 7472 203d 2022 2229 3a0a  ect: str = ""):.
+000091a0: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
+000091b0: 6520 6120 6675 6e63 7469 6f6e 2062 656c  e a function bel
+000091c0: 6f6e 6769 6e67 2074 6f20 6120 7370 6563  onging to a spec
+000091d0: 6966 6963 2070 726f 6a65 6374 2e22 2222  ific project."""
+000091e0: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+000091f0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00009200: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00009210: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
+00009220: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00009230: 7b70 726f 6a65 6374 7d2f 6675 6e63 7469  {project}/functi
+00009240: 6f6e 732f 7b6e 616d 657d 220a 2020 2020  ons/{name}".    
+00009250: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00009260: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
+00009270: 6574 696e 6720 6675 6e63 7469 6f6e 207b  eting function {
+00009280: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
+00009290: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+000092a0: 695f 6361 6c6c 2822 4445 4c45 5445 222c  i_call("DELETE",
+000092b0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+000092c0: 7361 6765 290a 0a20 2020 2064 6566 206c  sage)..    def l
+000092d0: 6973 745f 6675 6e63 7469 6f6e 7328 7365  ist_functions(se
+000092e0: 6c66 2c20 6e61 6d65 3d4e 6f6e 652c 2070  lf, name=None, p
+000092f0: 726f 6a65 6374 3d4e 6f6e 652c 2074 6167  roject=None, tag
+00009300: 3d4e 6f6e 652c 206c 6162 656c 733d 4e6f  =None, labels=No
+00009310: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00009320: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
+00009330: 6f66 2066 756e 6374 696f 6e73 2c20 6669  of functions, fi
+00009340: 6c74 6572 6564 2062 7920 7370 6563 6966  ltered by specif
+00009350: 6963 2063 7269 7465 7269 612e 0a0a 2020  ic criteria...  
+00009360: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+00009370: 653a 2052 6574 7572 6e20 6f6e 6c79 2066  e: Return only f
+00009380: 756e 6374 696f 6e73 2077 6974 6820 6120  unctions with a 
+00009390: 7370 6563 6966 6963 206e 616d 652e 0a20  specific name.. 
+000093a0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+000093b0: 6f6a 6563 743a 2052 6574 7572 6e20 6675  oject: Return fu
+000093c0: 6e63 7469 6f6e 7320 6265 6c6f 6e67 696e  nctions belongin
+000093d0: 6720 746f 2074 6869 7320 7072 6f6a 6563  g to this projec
+000093e0: 742e 2049 6620 6e6f 7420 7370 6563 6966  t. If not specif
+000093f0: 6965 642c 2074 6865 2064 6566 6175 6c74  ied, the default
+00009400: 2070 726f 6a65 6374 2069 7320 7573 6564   project is used
+00009410: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00009420: 2074 6167 3a20 5265 7475 726e 2066 756e   tag: Return fun
+00009430: 6374 696f 6e20 7665 7273 696f 6e73 2077  ction versions w
+00009440: 6974 6820 7370 6563 6966 6963 2074 6167  ith specific tag
+00009450: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00009460: 6d20 6c61 6265 6c73 3a20 5265 7475 726e  m labels: Return
+00009470: 2066 756e 6374 696f 6e73 2074 6861 7420   functions that 
+00009480: 6861 7665 2073 7065 6369 6669 6320 6c61  have specific la
+00009490: 6265 6c73 2061 7373 6967 6e65 6420 746f  bels assigned to
+000094a0: 2074 6865 6d2e 0a20 2020 2020 2020 203a   them..        :
+000094b0: 7265 7475 726e 733a 204c 6973 7420 6f66  returns: List of
+000094c0: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
+000094d0: 7320 2861 7320 6469 6374 696f 6e61 7279  s (as dictionary
+000094e0: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+000094f0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00009500: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+00009510: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00009520: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
+00009530: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00009540: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
+00009550: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+00009560: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
+00009570: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+00009580: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+00009590: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
+000095a0: 6f72 203d 2022 6c69 7374 2066 756e 6374  or = "list funct
+000095b0: 696f 6e73 220a 2020 2020 2020 2020 7061  ions".        pa
+000095c0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+000095d0: 7b70 726f 6a65 6374 7d2f 6675 6e63 7469  {project}/functi
+000095e0: 6f6e 7322 0a20 2020 2020 2020 2072 6573  ons".        res
+000095f0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00009600: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+00009610: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
+00009620: 616d 7329 0a20 2020 2020 2020 2072 6574  ams).        ret
+00009630: 7572 6e20 7265 7370 2e6a 736f 6e28 295b  urn resp.json()[
+00009640: 2266 756e 6373 225d 0a0a 2020 2020 6465  "funcs"]..    de
+00009650: 6620 6c69 7374 5f72 756e 7469 6d65 5f72  f list_runtime_r
+00009660: 6573 6f75 7263 6573 280a 2020 2020 2020  esources(.      
+00009670: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00009680: 7072 6f6a 6563 743a 204f 7074 696f 6e61  project: Optiona
+00009690: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000096a0: 2020 2020 2020 206c 6162 656c 5f73 656c         label_sel
+000096b0: 6563 746f 723a 204f 7074 696f 6e61 6c5b  ector: Optional[
+000096c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+000096d0: 2020 2020 206b 696e 643a 204f 7074 696f       kind: Optio
 000096e0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-000096f0: 0a20 2020 2020 2020 2067 726f 7570 5f62  .        group_b
-00009700: 793a 204f 7074 696f 6e61 6c5b 0a20 2020  y: Optional[.   
-00009710: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
-00009720: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4c69  ommon.schemas.Li
-00009730: 7374 5275 6e74 696d 6552 6573 6f75 7263  stRuntimeResourc
-00009740: 6573 4772 6f75 7042 7946 6965 6c64 0a20  esGroupByField. 
-00009750: 2020 2020 2020 205d 203d 204e 6f6e 652c         ] = None,
-00009760: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
-00009770: 0a20 2020 2020 2020 206d 6c72 756e 2e63  .        mlrun.c
-00009780: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5275  ommon.schemas.Ru
-00009790: 6e74 696d 6552 6573 6f75 7263 6573 4f75  ntimeResourcesOu
-000097a0: 7470 7574 2c0a 2020 2020 2020 2020 6d6c  tput,.        ml
-000097b0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-000097c0: 6173 2e47 726f 7570 6564 4279 4a6f 6252  as.GroupedByJobR
-000097d0: 756e 7469 6d65 5265 736f 7572 6365 734f  untimeResourcesO
-000097e0: 7574 7075 742c 0a20 2020 2020 2020 206d  utput,.        m
-000097f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00009800: 6d61 732e 4772 6f75 7065 6442 7950 726f  mas.GroupedByPro
-00009810: 6a65 6374 5275 6e74 696d 6552 6573 6f75  jectRuntimeResou
-00009820: 7263 6573 4f75 7470 7574 2c0a 2020 2020  rcesOutput,.    
-00009830: 5d3a 0a20 2020 2020 2020 2022 2222 4c69  ]:.        """Li
-00009840: 7374 2063 7572 7265 6e74 2072 756e 7469  st current runti
-00009850: 6d65 2072 6573 6f75 7263 6573 2c20 7768  me resources, wh
-00009860: 6963 6820 6172 6520 7573 7561 6c6c 7920  ich are usually 
-00009870: 2862 7574 206e 6f74 206c 696d 6974 6564  (but not limited
-00009880: 2074 6f29 204b 7562 6572 6e65 7465 7320   to) Kubernetes 
-00009890: 706f 6473 206f 7220 4352 4473 2e0a 2020  pods or CRDs..  
-000098a0: 2020 2020 2020 4675 6e63 7469 6f6e 2061        Function a
-000098b0: 7070 6c69 6573 2066 6f72 2072 756e 7320  pplies for runs 
-000098c0: 6f66 2074 7970 6520 605b 2764 6173 6b27  of type `['dask'
-000098d0: 2c20 276a 6f62 272c 2027 7370 6172 6b27  , 'job', 'spark'
-000098e0: 2c20 2772 656d 6f74 652d 7370 6172 6b27  , 'remote-spark'
-000098f0: 2c20 276d 7069 6a6f 6227 5d60 2c20 616e  , 'mpijob']`, an
-00009900: 6420 7769 6c6c 2072 6574 7572 6e20 7065  d will return pe
-00009910: 720a 2020 2020 2020 2020 7275 6e74 696d  r.        runtim
-00009920: 6520 6b69 6e64 2061 206c 6973 7420 6f66  e kind a list of
-00009930: 2074 6865 2072 756e 7469 6d65 2072 6573   the runtime res
-00009940: 6f75 7263 6573 2028 7768 6963 6820 6d61  ources (which ma
-00009950: 7920 6861 7665 2061 6c72 6561 6479 2063  y have already c
-00009960: 6f6d 706c 6574 6564 2074 6865 6972 2065  ompleted their e
-00009970: 7865 6375 7469 6f6e 292e 0a0a 2020 2020  xecution)...    
-00009980: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00009990: 6374 3a20 4765 7420 6f6e 6c79 2072 756e  ct: Get only run
-000099a0: 7469 6d65 2072 6573 6f75 7263 6573 206f  time resources o
-000099b0: 6620 6120 7370 6563 6966 6963 2070 726f  f a specific pro
-000099c0: 6a65 6374 2c20 6279 2064 6566 6175 6c74  ject, by default
-000099d0: 204e 6f6e 652c 2077 6869 6368 2077 696c   None, which wil
-000099e0: 6c20 7265 7475 726e 206f 6e6c 7920 7468  l return only th
-000099f0: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
-00009a00: 6f6a 6563 7473 2079 6f75 2772 6520 6175  ojects you're au
-00009a10: 7468 6f72 697a 6564 2074 6f20 7365 652e  thorized to see.
-00009a20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00009a30: 6c61 6265 6c5f 7365 6c65 6374 6f72 3a20  label_selector: 
-00009a40: 4120 6c61 6265 6c20 6669 6c74 6572 2074  A label filter t
-00009a50: 6861 7420 7769 6c6c 2062 6520 7061 7373  hat will be pass
-00009a60: 6564 2074 6f20 4b75 6265 726e 6574 6573  ed to Kubernetes
-00009a70: 2066 6f72 2066 696c 7465 7269 6e67 2074   for filtering t
-00009a80: 6865 2072 6573 756c 7473 2061 6363 6f72  he results accor
-00009a90: 6469 6e67 0a20 2020 2020 2020 2020 2020  ding.           
-00009aa0: 2074 6f20 7468 6569 7220 6c61 6265 6c73   to their labels
-00009ab0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00009ac0: 206b 696e 643a 2054 6865 206b 696e 6420   kind: The kind 
-00009ad0: 6f66 2072 756e 7469 6d65 2074 6f20 7175  of runtime to qu
-00009ae0: 6572 792e 204d 6179 2062 6520 6f6e 6520  ery. May be one 
-00009af0: 6f66 2060 5b27 6461 736b 272c 2027 6a6f  of `['dask', 'jo
-00009b00: 6227 2c20 2773 7061 726b 272c 2027 7265  b', 'spark', 're
-00009b10: 6d6f 7465 2d73 7061 726b 272c 2027 6d70  mote-spark', 'mp
-00009b20: 696a 6f62 275d 600a 2020 2020 2020 2020  ijob']`.        
-00009b30: 3a70 6172 616d 206f 626a 6563 745f 6964  :param object_id
-00009b40: 3a20 5468 6520 6964 656e 7469 6669 6572  : The identifier
-00009b50: 206f 6620 7468 6520 6d6c 7275 6e20 6f62   of the mlrun ob
-00009b60: 6a65 6374 2074 6f20 7175 6572 7920 6974  ject to query it
-00009b70: 7320 7275 6e74 696d 6520 7265 736f 7572  s runtime resour
-00009b80: 6365 732e 2066 6f72 206d 6f73 7420 6675  ces. for most fu
-00009b90: 6e63 7469 6f6e 2072 756e 7469 6d65 732c  nction runtimes,
-00009ba0: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
-00009bb0: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
-00009bc0: 7265 2070 6572 2052 756e 2c20 666f 7220  re per Run, for 
-00009bd0: 7768 6963 6820 7468 6520 6964 656e 7469  which the identi
-00009be0: 6669 6572 2069 7320 7468 6520 5275 6e27  fier is the Run'
-00009bf0: 7320 5549 442e 2046 6f72 2064 6173 6b20  s UID. For dask 
-00009c00: 7275 6e74 696d 652c 2074 6865 2072 756e  runtime, the run
-00009c10: 7469 6d65 0a20 2020 2020 2020 2020 2020  time.           
-00009c20: 2072 6573 6f75 7263 6573 2061 7265 2070   resources are p
-00009c30: 6572 2046 756e 6374 696f 6e2c 2066 6f72  er Function, for
-00009c40: 2077 6869 6368 2074 6865 2069 6465 6e74   which the ident
-00009c50: 6966 6965 7220 6973 2074 6865 2046 756e  ifier is the Fun
-00009c60: 6374 696f 6e27 7320 6e61 6d65 2e0a 2020  ction's name..  
-00009c70: 2020 2020 2020 3a70 6172 616d 2067 726f        :param gro
-00009c80: 7570 5f62 793a 204f 626a 6563 7420 746f  up_by: Object to
-00009c90: 2067 726f 7570 2072 6573 756c 7473 2062   group results b
-00009ca0: 792e 2041 6c6c 6f77 6564 2076 616c 7565  y. Allowed value
-00009cb0: 7320 6172 6520 606a 6f62 6020 616e 6420  s are `job` and 
-00009cc0: 6070 726f 6a65 6374 602e 0a20 2020 2020  `project`..     
-00009cd0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-00009ce0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00009cf0: 2020 2020 2020 226c 6162 656c 5f73 656c        "label_sel
-00009d00: 6563 746f 7222 3a20 6c61 6265 6c5f 7365  ector": label_se
-00009d10: 6c65 6374 6f72 2c0a 2020 2020 2020 2020  lector,.        
-00009d20: 2020 2020 2267 726f 7570 2d62 7922 3a20      "group-by": 
-00009d30: 6772 6f75 705f 6279 2c0a 2020 2020 2020  group_by,.      
-00009d40: 2020 2020 2020 226b 696e 6422 3a20 6b69        "kind": ki
-00009d50: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
-00009d60: 226f 626a 6563 742d 6964 223a 206f 626a  "object-id": obj
-00009d70: 6563 745f 6964 2c0a 2020 2020 2020 2020  ect_id,.        
-00009d80: 7d0a 2020 2020 2020 2020 7072 6f6a 6563  }.        projec
-00009d90: 745f 7061 7468 203d 2070 726f 6a65 6374  t_path = project
-00009da0: 2069 6620 7072 6f6a 6563 7420 656c 7365   if project else
-00009db0: 2022 2a22 0a20 2020 2020 2020 2065 7272   "*".        err
-00009dc0: 6f72 203d 2022 4661 696c 6564 206c 6973  or = "Failed lis
-00009dd0: 7469 6e67 2072 756e 7469 6d65 2072 6573  ting runtime res
-00009de0: 6f75 7263 6573 220a 2020 2020 2020 2020  ources".        
-00009df0: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-00009e00: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00009e10: 2020 2020 2020 2247 4554 222c 2066 2270        "GET", f"p
-00009e20: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00009e30: 5f70 6174 687d 2f72 756e 7469 6d65 2d72  _path}/runtime-r
-00009e40: 6573 6f75 7263 6573 222c 2065 7272 6f72  esources", error
-00009e50: 2c20 7061 7261 6d73 3d70 6172 616d 730a  , params=params.
-00009e60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009e70: 2020 6966 2067 726f 7570 5f62 7920 6973    if group_by is
-00009e80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00009e90: 2020 2073 7472 7563 7475 7265 645f 6c69     structured_li
-00009ea0: 7374 203d 205b 0a20 2020 2020 2020 2020  st = [.         
-00009eb0: 2020 2020 2020 206d 6c72 756e 2e63 6f6d         mlrun.com
-00009ec0: 6d6f 6e2e 7363 6865 6d61 732e 4b69 6e64  mon.schemas.Kind
-00009ed0: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
-00009ee0: 282a 2a6b 696e 645f 7275 6e74 696d 655f  (**kind_runtime_
-00009ef0: 7265 736f 7572 6365 7329 0a20 2020 2020  resources).     
-00009f00: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00009f10: 696e 645f 7275 6e74 696d 655f 7265 736f  ind_runtime_reso
-00009f20: 7572 6365 7320 696e 2072 6573 706f 6e73  urces in respons
-00009f30: 652e 6a73 6f6e 2829 0a20 2020 2020 2020  e.json().       
-00009f40: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00009f50: 2020 2072 6574 7572 6e20 7374 7275 6374     return struct
-00009f60: 7572 6564 5f6c 6973 740a 2020 2020 2020  ured_list.      
-00009f70: 2020 656c 6966 2067 726f 7570 5f62 7920    elif group_by 
-00009f80: 3d3d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  == mlrun.common.
-00009f90: 7363 6865 6d61 732e 4c69 7374 5275 6e74  schemas.ListRunt
-00009fa0: 696d 6552 6573 6f75 7263 6573 4772 6f75  imeResourcesGrou
-00009fb0: 7042 7946 6965 6c64 2e6a 6f62 3a0a 2020  pByField.job:.  
-00009fc0: 2020 2020 2020 2020 2020 7374 7275 6374            struct
-00009fd0: 7572 6564 5f64 6963 7420 3d20 7b7d 0a20  ured_dict = {}. 
-00009fe0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-00009ff0: 726f 6a65 6374 2c20 6a6f 625f 7275 6e74  roject, job_runt
-0000a000: 696d 655f 7265 736f 7572 6365 735f 6d61  ime_resources_ma
-0000a010: 7020 696e 2072 6573 706f 6e73 652e 6a73  p in response.js
-0000a020: 6f6e 2829 2e69 7465 6d73 2829 3a0a 2020  on().items():.  
-0000a030: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000a040: 7220 6a6f 625f 6964 2c20 7275 6e74 696d  r job_id, runtim
-0000a050: 655f 7265 736f 7572 6365 7320 696e 206a  e_resources in j
-0000a060: 6f62 5f72 756e 7469 6d65 5f72 6573 6f75  ob_runtime_resou
-0000a070: 7263 6573 5f6d 6170 2e69 7465 6d73 2829  rces_map.items()
-0000a080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000a090: 2020 2020 2020 7374 7275 6374 7572 6564        structured
-0000a0a0: 5f64 6963 742e 7365 7464 6566 6175 6c74  _dict.setdefault
-0000a0b0: 2870 726f 6a65 6374 2c20 7b7d 295b 0a20  (project, {})[. 
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0d0: 2020 2020 2020 206a 6f62 5f69 640a 2020         job_id.  
-0000a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0f0: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
-0000a100: 6f6e 2e73 6368 656d 6173 2e52 756e 7469  on.schemas.Runti
-0000a110: 6d65 5265 736f 7572 6365 7328 2a2a 7275  meResources(**ru
-0000a120: 6e74 696d 655f 7265 736f 7572 6365 7329  ntime_resources)
-0000a130: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000a140: 7572 6e20 7374 7275 6374 7572 6564 5f64  urn structured_d
-0000a150: 6963 740a 2020 2020 2020 2020 656c 6966  ict.        elif
-0000a160: 2067 726f 7570 5f62 7920 3d3d 206d 6c72   group_by == mlr
-0000a170: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0000a180: 732e 4c69 7374 5275 6e74 696d 6552 6573  s.ListRuntimeRes
-0000a190: 6f75 7263 6573 4772 6f75 7042 7946 6965  ourcesGroupByFie
-0000a1a0: 6c64 2e70 726f 6a65 6374 3a0a 2020 2020  ld.project:.    
-0000a1b0: 2020 2020 2020 2020 7374 7275 6374 7572          structur
-0000a1c0: 6564 5f64 6963 7420 3d20 7b7d 0a20 2020  ed_dict = {}.   
-0000a1d0: 2020 2020 2020 2020 2066 6f72 2070 726f           for pro
-0000a1e0: 6a65 6374 2c20 6b69 6e64 5f72 756e 7469  ject, kind_runti
-0000a1f0: 6d65 5f72 6573 6f75 7263 6573 5f6d 6170  me_resources_map
-0000a200: 2069 6e20 7265 7370 6f6e 7365 2e6a 736f   in response.jso
-0000a210: 6e28 292e 6974 656d 7328 293a 0a20 2020  n().items():.   
-0000a220: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0000a230: 206b 696e 642c 2072 756e 7469 6d65 5f72   kind, runtime_r
-0000a240: 6573 6f75 7263 6573 2069 6e20 6b69 6e64  esources in kind
-0000a250: 5f72 756e 7469 6d65 5f72 6573 6f75 7263  _runtime_resourc
-0000a260: 6573 5f6d 6170 2e69 7465 6d73 2829 3a0a  es_map.items():.
-0000a270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a280: 2020 2020 7374 7275 6374 7572 6564 5f64      structured_d
-0000a290: 6963 742e 7365 7464 6566 6175 6c74 2870  ict.setdefault(p
-0000a2a0: 726f 6a65 6374 2c20 7b7d 295b 0a20 2020  roject, {})[.   
-0000a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2c0: 2020 2020 206b 696e 640a 2020 2020 2020       kind.      
-0000a2d0: 2020 2020 2020 2020 2020 2020 2020 5d20                ] 
-0000a2e0: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0000a2f0: 6368 656d 6173 2e52 756e 7469 6d65 5265  chemas.RuntimeRe
-0000a300: 736f 7572 6365 7328 2a2a 7275 6e74 696d  sources(**runtim
-0000a310: 655f 7265 736f 7572 6365 7329 0a20 2020  e_resources).   
-0000a320: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000a330: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
-0000a340: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000a350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000a360: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0000a370: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000a380: 2020 2020 2066 2250 726f 7669 6465 6420       f"Provided 
-0000a390: 6772 6f75 7020 6279 2066 6965 6c64 2069  group by field i
-0000a3a0: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
-0000a3b0: 2067 726f 7570 5f62 793d 7b67 726f 7570   group_by={group
-0000a3c0: 5f62 797d 220a 2020 2020 2020 2020 2020  _by}".          
-0000a3d0: 2020 290a 0a20 2020 2064 6566 2064 656c    )..    def del
-0000a3e0: 6574 655f 7275 6e74 696d 655f 7265 736f  ete_runtime_reso
-0000a3f0: 7572 6365 7328 0a20 2020 2020 2020 2073  urces(.        s
-0000a400: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-0000a410: 6a65 6374 3a20 4f70 7469 6f6e 616c 5b73  ject: Optional[s
-0000a420: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-0000a430: 2020 2020 6c61 6265 6c5f 7365 6c65 6374      label_select
-0000a440: 6f72 3a20 4f70 7469 6f6e 616c 5b73 7472  or: Optional[str
-0000a450: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0000a460: 2020 6b69 6e64 3a20 4f70 7469 6f6e 616c    kind: Optional
-0000a470: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0000a480: 2020 2020 2020 6f62 6a65 6374 5f69 643a        object_id:
+000096f0: 0a20 2020 2020 2020 206f 626a 6563 745f  .        object_
+00009700: 6964 3a20 4f70 7469 6f6e 616c 5b73 7472  id: Optional[str
+00009710: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00009720: 2020 6772 6f75 705f 6279 3a20 4f70 7469    group_by: Opti
+00009730: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
+00009740: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+00009750: 6368 656d 6173 2e4c 6973 7452 756e 7469  chemas.ListRunti
+00009760: 6d65 5265 736f 7572 6365 7347 726f 7570  meResourcesGroup
+00009770: 4279 4669 656c 640a 2020 2020 2020 2020  ByField.        
+00009780: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
+00009790: 2d3e 2055 6e69 6f6e 5b0a 2020 2020 2020  -> Union[.      
+000097a0: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+000097b0: 6368 656d 6173 2e52 756e 7469 6d65 5265  chemas.RuntimeRe
+000097c0: 736f 7572 6365 734f 7574 7075 742c 0a20  sourcesOutput,. 
+000097d0: 2020 2020 2020 206d 6c72 756e 2e63 6f6d         mlrun.com
+000097e0: 6d6f 6e2e 7363 6865 6d61 732e 4772 6f75  mon.schemas.Grou
+000097f0: 7065 6442 794a 6f62 5275 6e74 696d 6552  pedByJobRuntimeR
+00009800: 6573 6f75 7263 6573 4f75 7470 7574 2c0a  esourcesOutput,.
+00009810: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+00009820: 6d6d 6f6e 2e73 6368 656d 6173 2e47 726f  mmon.schemas.Gro
+00009830: 7570 6564 4279 5072 6f6a 6563 7452 756e  upedByProjectRun
+00009840: 7469 6d65 5265 736f 7572 6365 734f 7574  timeResourcesOut
+00009850: 7075 742c 0a20 2020 205d 3a0a 2020 2020  put,.    ]:.    
+00009860: 2020 2020 2222 224c 6973 7420 6375 7272      """List curr
+00009870: 656e 7420 7275 6e74 696d 6520 7265 736f  ent runtime reso
+00009880: 7572 6365 732c 2077 6869 6368 2061 7265  urces, which are
+00009890: 2075 7375 616c 6c79 2028 6275 7420 6e6f   usually (but no
+000098a0: 7420 6c69 6d69 7465 6420 746f 2920 4b75  t limited to) Ku
+000098b0: 6265 726e 6574 6573 2070 6f64 7320 6f72  bernetes pods or
+000098c0: 2043 5244 732e 0a20 2020 2020 2020 2046   CRDs..        F
+000098d0: 756e 6374 696f 6e20 6170 706c 6965 7320  unction applies 
+000098e0: 666f 7220 7275 6e73 206f 6620 7479 7065  for runs of type
+000098f0: 2060 5b27 6461 736b 272c 2027 6a6f 6227   `['dask', 'job'
+00009900: 2c20 2773 7061 726b 272c 2027 7265 6d6f  , 'spark', 'remo
+00009910: 7465 2d73 7061 726b 272c 2027 6d70 696a  te-spark', 'mpij
+00009920: 6f62 275d 602c 2061 6e64 2077 696c 6c20  ob']`, and will 
+00009930: 7265 7475 726e 2070 6572 0a20 2020 2020  return per.     
+00009940: 2020 2072 756e 7469 6d65 206b 696e 6420     runtime kind 
+00009950: 6120 6c69 7374 206f 6620 7468 6520 7275  a list of the ru
+00009960: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
+00009970: 2877 6869 6368 206d 6179 2068 6176 6520  (which may have 
+00009980: 616c 7265 6164 7920 636f 6d70 6c65 7465  already complete
+00009990: 6420 7468 6569 7220 6578 6563 7574 696f  d their executio
+000099a0: 6e29 2e0a 0a20 2020 2020 2020 203a 7061  n)...        :pa
+000099b0: 7261 6d20 7072 6f6a 6563 743a 2047 6574  ram project: Get
+000099c0: 206f 6e6c 7920 7275 6e74 696d 6520 7265   only runtime re
+000099d0: 736f 7572 6365 7320 6f66 2061 2073 7065  sources of a spe
+000099e0: 6369 6669 6320 7072 6f6a 6563 742c 2062  cific project, b
+000099f0: 7920 6465 6661 756c 7420 4e6f 6e65 2c20  y default None, 
+00009a00: 7768 6963 6820 7769 6c6c 2072 6574 7572  which will retur
+00009a10: 6e20 6f6e 6c79 2074 6865 0a20 2020 2020  n only the.     
+00009a20: 2020 2020 2020 2070 726f 6a65 6374 7320         projects 
+00009a30: 796f 7527 7265 2061 7574 686f 7269 7a65  you're authorize
+00009a40: 6420 746f 2073 6565 2e0a 2020 2020 2020  d to see..      
+00009a50: 2020 3a70 6172 616d 206c 6162 656c 5f73    :param label_s
+00009a60: 656c 6563 746f 723a 2041 206c 6162 656c  elector: A label
+00009a70: 2066 696c 7465 7220 7468 6174 2077 696c   filter that wil
+00009a80: 6c20 6265 2070 6173 7365 6420 746f 204b  l be passed to K
+00009a90: 7562 6572 6e65 7465 7320 666f 7220 6669  ubernetes for fi
+00009aa0: 6c74 6572 696e 6720 7468 6520 7265 7375  ltering the resu
+00009ab0: 6c74 7320 6163 636f 7264 696e 670a 2020  lts according.  
+00009ac0: 2020 2020 2020 2020 2020 746f 2074 6865            to the
+00009ad0: 6972 206c 6162 656c 732e 0a20 2020 2020  ir labels..     
+00009ae0: 2020 203a 7061 7261 6d20 6b69 6e64 3a20     :param kind: 
+00009af0: 5468 6520 6b69 6e64 206f 6620 7275 6e74  The kind of runt
+00009b00: 696d 6520 746f 2071 7565 7279 2e20 4d61  ime to query. Ma
+00009b10: 7920 6265 206f 6e65 206f 6620 605b 2764  y be one of `['d
+00009b20: 6173 6b27 2c20 276a 6f62 272c 2027 7370  ask', 'job', 'sp
+00009b30: 6172 6b27 2c20 2772 656d 6f74 652d 7370  ark', 'remote-sp
+00009b40: 6172 6b27 2c20 276d 7069 6a6f 6227 5d60  ark', 'mpijob']`
+00009b50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00009b60: 6f62 6a65 6374 5f69 643a 2054 6865 2069  object_id: The i
+00009b70: 6465 6e74 6966 6965 7220 6f66 2074 6865  dentifier of the
+00009b80: 206d 6c72 756e 206f 626a 6563 7420 746f   mlrun object to
+00009b90: 2071 7565 7279 2069 7473 2072 756e 7469   query its runti
+00009ba0: 6d65 2072 6573 6f75 7263 6573 2e20 666f  me resources. fo
+00009bb0: 7220 6d6f 7374 2066 756e 6374 696f 6e20  r most function 
+00009bc0: 7275 6e74 696d 6573 2c0a 2020 2020 2020  runtimes,.      
+00009bd0: 2020 2020 2020 7275 6e74 696d 6520 7265        runtime re
+00009be0: 736f 7572 6365 7320 6172 6520 7065 7220  sources are per 
+00009bf0: 5275 6e2c 2066 6f72 2077 6869 6368 2074  Run, for which t
+00009c00: 6865 2069 6465 6e74 6966 6965 7220 6973  he identifier is
+00009c10: 2074 6865 2052 756e 2773 2055 4944 2e20   the Run's UID. 
+00009c20: 466f 7220 6461 736b 2072 756e 7469 6d65  For dask runtime
+00009c30: 2c20 7468 6520 7275 6e74 696d 650a 2020  , the runtime.  
+00009c40: 2020 2020 2020 2020 2020 7265 736f 7572            resour
+00009c50: 6365 7320 6172 6520 7065 7220 4675 6e63  ces are per Func
+00009c60: 7469 6f6e 2c20 666f 7220 7768 6963 6820  tion, for which 
+00009c70: 7468 6520 6964 656e 7469 6669 6572 2069  the identifier i
+00009c80: 7320 7468 6520 4675 6e63 7469 6f6e 2773  s the Function's
+00009c90: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+00009ca0: 7061 7261 6d20 6772 6f75 705f 6279 3a20  param group_by: 
+00009cb0: 4f62 6a65 6374 2074 6f20 6772 6f75 7020  Object to group 
+00009cc0: 7265 7375 6c74 7320 6279 2e20 416c 6c6f  results by. Allo
+00009cd0: 7765 6420 7661 6c75 6573 2061 7265 2060  wed values are `
+00009ce0: 6a6f 6260 2061 6e64 2060 7072 6f6a 6563  job` and `projec
+00009cf0: 7460 2e0a 2020 2020 2020 2020 2222 220a  t`..        """.
+00009d00: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00009d10: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00009d20: 6c61 6265 6c5f 7365 6c65 6374 6f72 223a  label_selector":
+00009d30: 206c 6162 656c 5f73 656c 6563 746f 722c   label_selector,
+00009d40: 0a20 2020 2020 2020 2020 2020 2022 6772  .            "gr
+00009d50: 6f75 702d 6279 223a 2067 726f 7570 5f62  oup-by": group_b
+00009d60: 792c 0a20 2020 2020 2020 2020 2020 2022  y,.            "
+00009d70: 6b69 6e64 223a 206b 696e 642c 0a20 2020  kind": kind,.   
+00009d80: 2020 2020 2020 2020 2022 6f62 6a65 6374           "object
+00009d90: 2d69 6422 3a20 6f62 6a65 6374 5f69 642c  -id": object_id,
+00009da0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00009db0: 2020 2070 726f 6a65 6374 5f70 6174 6820     project_path 
+00009dc0: 3d20 7072 6f6a 6563 7420 6966 2070 726f  = project if pro
+00009dd0: 6a65 6374 2065 6c73 6520 222a 220a 2020  ject else "*".  
+00009de0: 2020 2020 2020 6572 726f 7220 3d20 2246        error = "F
+00009df0: 6169 6c65 6420 6c69 7374 696e 6720 7275  ailed listing ru
+00009e00: 6e74 696d 6520 7265 736f 7572 6365 7322  ntime resources"
+00009e10: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+00009e20: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+00009e30: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+00009e40: 4745 5422 2c20 6622 7072 6f6a 6563 7473  GET", f"projects
+00009e50: 2f7b 7072 6f6a 6563 745f 7061 7468 7d2f  /{project_path}/
+00009e60: 7275 6e74 696d 652d 7265 736f 7572 6365  runtime-resource
+00009e70: 7322 2c20 6572 726f 722c 2070 6172 616d  s", error, param
+00009e80: 733d 7061 7261 6d73 0a20 2020 2020 2020  s=params.       
+00009e90: 2029 0a20 2020 2020 2020 2069 6620 6772   ).        if gr
+00009ea0: 6f75 705f 6279 2069 7320 4e6f 6e65 3a0a  oup_by is None:.
+00009eb0: 2020 2020 2020 2020 2020 2020 7374 7275              stru
+00009ec0: 6374 7572 6564 5f6c 6973 7420 3d20 5b0a  ctured_list = [.
+00009ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ee0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00009ef0: 656d 6173 2e4b 696e 6452 756e 7469 6d65  emas.KindRuntime
+00009f00: 5265 736f 7572 6365 7328 2a2a 6b69 6e64  Resources(**kind
+00009f10: 5f72 756e 7469 6d65 5f72 6573 6f75 7263  _runtime_resourc
+00009f20: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00009f30: 2020 2020 666f 7220 6b69 6e64 5f72 756e      for kind_run
+00009f40: 7469 6d65 5f72 6573 6f75 7263 6573 2069  time_resources i
+00009f50: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
+00009f60: 290a 2020 2020 2020 2020 2020 2020 5d0a  ).            ].
+00009f70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00009f80: 726e 2073 7472 7563 7475 7265 645f 6c69  rn structured_li
+00009f90: 7374 0a20 2020 2020 2020 2065 6c69 6620  st.        elif 
+00009fa0: 6772 6f75 705f 6279 203d 3d20 6d6c 7275  group_by == mlru
+00009fb0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00009fc0: 2e4c 6973 7452 756e 7469 6d65 5265 736f  .ListRuntimeReso
+00009fd0: 7572 6365 7347 726f 7570 4279 4669 656c  urcesGroupByFiel
+00009fe0: 642e 6a6f 623a 0a20 2020 2020 2020 2020  d.job:.         
+00009ff0: 2020 2073 7472 7563 7475 7265 645f 6469     structured_di
+0000a000: 6374 203d 207b 7d0a 2020 2020 2020 2020  ct = {}.        
+0000a010: 2020 2020 666f 7220 7072 6f6a 6563 742c      for project,
+0000a020: 206a 6f62 5f72 756e 7469 6d65 5f72 6573   job_runtime_res
+0000a030: 6f75 7263 6573 5f6d 6170 2069 6e20 7265  ources_map in re
+0000a040: 7370 6f6e 7365 2e6a 736f 6e28 292e 6974  sponse.json().it
+0000a050: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+0000a060: 2020 2020 2020 2066 6f72 206a 6f62 5f69         for job_i
+0000a070: 642c 2072 756e 7469 6d65 5f72 6573 6f75  d, runtime_resou
+0000a080: 7263 6573 2069 6e20 6a6f 625f 7275 6e74  rces in job_runt
+0000a090: 696d 655f 7265 736f 7572 6365 735f 6d61  ime_resources_ma
+0000a0a0: 702e 6974 656d 7328 293a 0a20 2020 2020  p.items():.     
+0000a0b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a0c0: 7472 7563 7475 7265 645f 6469 6374 2e73  tructured_dict.s
+0000a0d0: 6574 6465 6661 756c 7428 7072 6f6a 6563  etdefault(projec
+0000a0e0: 742c 207b 7d29 5b0a 2020 2020 2020 2020  t, {})[.        
+0000a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a100: 6a6f 625f 6964 0a20 2020 2020 2020 2020  job_id.         
+0000a110: 2020 2020 2020 2020 2020 205d 203d 206d             ] = m
+0000a120: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000a130: 6d61 732e 5275 6e74 696d 6552 6573 6f75  mas.RuntimeResou
+0000a140: 7263 6573 282a 2a72 756e 7469 6d65 5f72  rces(**runtime_r
+0000a150: 6573 6f75 7263 6573 290a 2020 2020 2020  esources).      
+0000a160: 2020 2020 2020 7265 7475 726e 2073 7472        return str
+0000a170: 7563 7475 7265 645f 6469 6374 0a20 2020  uctured_dict.   
+0000a180: 2020 2020 2065 6c69 6620 6772 6f75 705f       elif group_
+0000a190: 6279 203d 3d20 6d6c 7275 6e2e 636f 6d6d  by == mlrun.comm
+0000a1a0: 6f6e 2e73 6368 656d 6173 2e4c 6973 7452  on.schemas.ListR
+0000a1b0: 756e 7469 6d65 5265 736f 7572 6365 7347  untimeResourcesG
+0000a1c0: 726f 7570 4279 4669 656c 642e 7072 6f6a  roupByField.proj
+0000a1d0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
+0000a1e0: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000a1f0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+0000a200: 2020 666f 7220 7072 6f6a 6563 742c 206b    for project, k
+0000a210: 696e 645f 7275 6e74 696d 655f 7265 736f  ind_runtime_reso
+0000a220: 7572 6365 735f 6d61 7020 696e 2072 6573  urces_map in res
+0000a230: 706f 6e73 652e 6a73 6f6e 2829 2e69 7465  ponse.json().ite
+0000a240: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+0000a250: 2020 2020 2020 666f 7220 6b69 6e64 2c20        for kind, 
+0000a260: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
+0000a270: 7320 696e 206b 696e 645f 7275 6e74 696d  s in kind_runtim
+0000a280: 655f 7265 736f 7572 6365 735f 6d61 702e  e_resources_map.
+0000a290: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0000a2a0: 2020 2020 2020 2020 2020 2020 2073 7472               str
+0000a2b0: 7563 7475 7265 645f 6469 6374 2e73 6574  uctured_dict.set
+0000a2c0: 6465 6661 756c 7428 7072 6f6a 6563 742c  default(project,
+0000a2d0: 207b 7d29 5b0a 2020 2020 2020 2020 2020   {})[.          
+0000a2e0: 2020 2020 2020 2020 2020 2020 2020 6b69                ki
+0000a2f0: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
+0000a300: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+0000a310: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000a320: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
+0000a330: 282a 2a72 756e 7469 6d65 5f72 6573 6f75  (**runtime_resou
+0000a340: 7263 6573 290a 2020 2020 2020 2020 2020  rces).          
+0000a350: 2020 7265 7475 726e 2073 7472 7563 7475    return structu
+0000a360: 7265 645f 6469 6374 0a20 2020 2020 2020  red_dict.       
+0000a370: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000a380: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0000a390: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000a3b0: 5072 6f76 6964 6564 2067 726f 7570 2062  Provided group b
+0000a3c0: 7920 6669 656c 6420 6973 206e 6f74 2073  y field is not s
+0000a3d0: 7570 706f 7274 6564 2e20 6772 6f75 705f  upported. group_
+0000a3e0: 6279 3d7b 6772 6f75 705f 6279 7d22 0a20  by={group_by}". 
+0000a3f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000a400: 2020 6465 6620 6465 6c65 7465 5f72 756e    def delete_run
+0000a410: 7469 6d65 5f72 6573 6f75 7263 6573 280a  time_resources(.
+0000a420: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000a430: 2020 2020 2020 7072 6f6a 6563 743a 204f        project: O
+0000a440: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0000a450: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
+0000a460: 656c 5f73 656c 6563 746f 723a 204f 7074  el_selector: Opt
+0000a470: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0000a480: 652c 0a20 2020 2020 2020 206b 696e 643a  e,.        kind:
 0000a490: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0000a4a0: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
-0000a4b0: 6f72 6365 3a20 626f 6f6c 203d 2046 616c  orce: bool = Fal
-0000a4c0: 7365 2c0a 2020 2020 2020 2020 6772 6163  se,.        grac
-0000a4d0: 655f 7065 7269 6f64 3a20 696e 7420 3d20  e_period: int = 
-0000a4e0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 206d  None,.    ) -> m
-0000a4f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000a500: 6d61 732e 4772 6f75 7065 6442 7950 726f  mas.GroupedByPro
-0000a510: 6a65 6374 5275 6e74 696d 6552 6573 6f75  jectRuntimeResou
-0000a520: 7263 6573 4f75 7470 7574 3a0a 2020 2020  rcesOutput:.    
-0000a530: 2020 2020 2222 2244 656c 6574 6520 616c      """Delete al
-0000a540: 6c20 7275 6e74 696d 6520 7265 736f 7572  l runtime resour
-0000a550: 6365 7320 7768 6963 6820 6172 6520 696e  ces which are in
-0000a560: 2074 6572 6d69 6e61 6c20 7374 6174 652e   terminal state.
-0000a570: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000a580: 2070 726f 6a65 6374 3a20 4465 6c65 7465   project: Delete
-0000a590: 206f 6e6c 7920 7275 6e74 696d 6520 7265   only runtime re
-0000a5a0: 736f 7572 6365 7320 6f66 2061 2073 7065  sources of a spe
-0000a5b0: 6369 6669 6320 7072 6f6a 6563 742c 2062  cific project, b
-0000a5c0: 7920 6465 6661 756c 7420 4e6f 6e65 2c20  y default None, 
-0000a5d0: 7768 6963 6820 7769 6c6c 2064 656c 6574  which will delet
-0000a5e0: 6520 6f6e 6c79 0a20 2020 2020 2020 2020  e only.         
-0000a5f0: 2020 2066 726f 6d20 7468 6520 7072 6f6a     from the proj
-0000a600: 6563 7473 2079 6f75 2772 6520 6175 7468  ects you're auth
-0000a610: 6f72 697a 6564 2074 6f20 6465 6c65 7465  orized to delete
-0000a620: 2066 726f 6d2e 0a20 2020 2020 2020 203a   from..        :
-0000a630: 7061 7261 6d20 6c61 6265 6c5f 7365 6c65  param label_sele
-0000a640: 6374 6f72 3a20 4465 6c65 7465 206f 6e6c  ctor: Delete onl
-0000a650: 7920 7275 6e74 696d 6520 7265 736f 7572  y runtime resour
-0000a660: 6365 7320 6d61 7463 6869 6e67 2074 6865  ces matching the
-0000a670: 206c 6162 656c 2073 656c 6563 746f 722e   label selector.
-0000a680: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000a690: 6b69 6e64 3a20 5468 6520 6b69 6e64 206f  kind: The kind o
-0000a6a0: 6620 7275 6e74 696d 6520 746f 2064 656c  f runtime to del
-0000a6b0: 6574 652e 204d 6179 2062 6520 6f6e 6520  ete. May be one 
-0000a6c0: 6f66 2060 5b27 6461 736b 272c 2027 6a6f  of `['dask', 'jo
-0000a6d0: 6227 2c20 2773 7061 726b 272c 2027 7265  b', 'spark', 're
-0000a6e0: 6d6f 7465 2d73 7061 726b 272c 2027 6d70  mote-spark', 'mp
-0000a6f0: 696a 6f62 275d 600a 2020 2020 2020 2020  ijob']`.        
-0000a700: 3a70 6172 616d 206f 626a 6563 745f 6964  :param object_id
-0000a710: 3a20 5468 6520 6964 656e 7469 6669 6572  : The identifier
-0000a720: 206f 6620 7468 6520 6d6c 7275 6e20 6f62   of the mlrun ob
-0000a730: 6a65 6374 2074 6f20 6465 6c65 7465 2069  ject to delete i
-0000a740: 7473 2072 756e 7469 6d65 2072 6573 6f75  ts runtime resou
-0000a750: 7263 6573 2e20 666f 7220 6d6f 7374 2066  rces. for most f
-0000a760: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-0000a770: 2020 2020 7275 6e74 696d 6573 2c20 7275      runtimes, ru
-0000a780: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
-0000a790: 6172 6520 7065 7220 5275 6e2c 2066 6f72  are per Run, for
-0000a7a0: 2077 6869 6368 2074 6865 2069 6465 6e74   which the ident
-0000a7b0: 6966 6965 7220 6973 2074 6865 2052 756e  ifier is the Run
-0000a7c0: 2773 2055 4944 2e20 466f 7220 6461 736b  's UID. For dask
-0000a7d0: 2072 756e 7469 6d65 2c20 7468 650a 2020   runtime, the.  
-0000a7e0: 2020 2020 2020 2020 2020 7275 6e74 696d            runtim
-0000a7f0: 6520 7265 736f 7572 6365 7320 6172 6520  e resources are 
-0000a800: 7065 7220 4675 6e63 7469 6f6e 2c20 666f  per Function, fo
-0000a810: 7220 7768 6963 6820 7468 6520 6964 656e  r which the iden
-0000a820: 7469 6669 6572 2069 7320 7468 6520 4675  tifier is the Fu
-0000a830: 6e63 7469 6f6e 2773 206e 616d 652e 0a20  nction's name.. 
-0000a840: 2020 2020 2020 203a 7061 7261 6d20 666f         :param fo
-0000a850: 7263 653a 2046 6f72 6365 2064 656c 6574  rce: Force delet
-0000a860: 696f 6e20 2d20 6465 6c65 7465 2074 6865  ion - delete the
-0000a870: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-0000a880: 6520 6576 656e 2069 6620 6974 2773 206e  e even if it's n
-0000a890: 6f74 2069 6e20 7465 726d 696e 616c 2073  ot in terminal s
-0000a8a0: 7461 7465 206f 7220 6966 2074 6865 2067  tate or if the g
-0000a8b0: 7261 6365 0a20 2020 2020 2020 2020 2020  race.           
-0000a8c0: 2070 6572 696f 6420 6469 646e 2774 2070   period didn't p
-0000a8d0: 6173 732e 0a20 2020 2020 2020 203a 7061  ass..        :pa
-0000a8e0: 7261 6d20 6772 6163 655f 7065 7269 6f64  ram grace_period
-0000a8f0: 3a20 4772 6163 6520 7065 7269 6f64 2067  : Grace period g
-0000a900: 6976 656e 2074 6f20 7468 6520 7275 6e74  iven to the runt
-0000a910: 696d 6520 7265 736f 7572 6365 2062 6566  ime resource bef
-0000a920: 6f72 6520 7468 6579 2061 7265 2061 6374  ore they are act
-0000a930: 7561 6c6c 7920 7265 6d6f 7665 642c 2063  ually removed, c
-0000a940: 6f75 6e74 6564 2066 726f 6d0a 2020 2020  ounted from.    
-0000a950: 2020 2020 2020 2020 7468 6520 6d6f 6d65          the mome
-0000a960: 6e74 2074 6865 7920 6d6f 7665 6420 746f  nt they moved to
-0000a970: 2074 6572 6d69 6e61 6c20 7374 6174 6520   terminal state 
-0000a980: 2864 6566 6175 6c74 7320 746f 206d 6c72  (defaults to mlr
-0000a990: 756e 2e6d 6c63 6f6e 662e 7275 6e74 696d  un.mlconf.runtim
-0000a9a0: 655f 7265 736f 7572 6365 735f 6465 6c65  e_resources_dele
-0000a9b0: 7469 6f6e 5f67 7261 6365 5f70 6572 696f  tion_grace_perio
-0000a9c0: 6429 2e0a 0a20 2020 2020 2020 203a 7265  d)...        :re
-0000a9d0: 7475 726e 733a 203a 7079 3a63 6c61 7373  turns: :py:class
-0000a9e0: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-0000a9f0: 7363 6865 6d61 732e 4772 6f75 7065 6442  schemas.GroupedB
-0000aa00: 7950 726f 6a65 6374 5275 6e74 696d 6552  yProjectRuntimeR
-0000aa10: 6573 6f75 7263 6573 4f75 7470 7574 6020  esourcesOutput` 
-0000aa20: 6c69 7374 696e 6720 7468 6520 7275 6e74  listing the runt
-0000aa30: 696d 6520 7265 736f 7572 6365 730a 2020  ime resources.  
-0000aa40: 2020 2020 2020 2020 2020 7468 6174 2077            that w
-0000aa50: 6572 6520 7265 6d6f 7665 642e 0a20 2020  ere removed..   
-0000aa60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000aa70: 2069 6620 6772 6163 655f 7065 7269 6f64   if grace_period
-0000aa80: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000aa90: 2020 2020 2020 6772 6163 655f 7065 7269        grace_peri
-0000aaa0: 6f64 203d 2063 6f6e 6669 672e 7275 6e74  od = config.runt
-0000aab0: 696d 655f 7265 736f 7572 6365 735f 6465  ime_resources_de
-0000aac0: 6c65 7469 6f6e 5f67 7261 6365 5f70 6572  letion_grace_per
-0000aad0: 696f 640a 2020 2020 2020 2020 2020 2020  iod.            
-0000aae0: 6c6f 6767 6572 2e69 6e66 6f28 0a20 2020  logger.info(.   
-0000aaf0: 2020 2020 2020 2020 2020 2020 2022 5573               "Us
-0000ab00: 696e 6720 6465 6661 756c 7420 6772 6163  ing default grac
-0000ab10: 6520 7065 7269 6f64 2066 6f72 2072 756e  e period for run
-0000ab20: 7469 6d65 2072 6573 6f75 7263 6573 2064  time resources d
-0000ab30: 656c 6574 696f 6e22 2c0a 2020 2020 2020  eletion",.      
-0000ab40: 2020 2020 2020 2020 2020 6772 6163 655f            grace_
-0000ab50: 7065 7269 6f64 3d67 7261 6365 5f70 6572  period=grace_per
-0000ab60: 696f 642c 0a20 2020 2020 2020 2020 2020  iod,.           
-0000ab70: 2029 0a0a 2020 2020 2020 2020 7061 7261   )..        para
-0000ab80: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0000ab90: 2020 2022 6c61 6265 6c2d 7365 6c65 6374     "label-select
-0000aba0: 6f72 223a 206c 6162 656c 5f73 656c 6563  or": label_selec
-0000abb0: 746f 722c 0a20 2020 2020 2020 2020 2020  tor,.           
-0000abc0: 2022 6b69 6e64 223a 206b 696e 642c 0a20   "kind": kind,. 
-0000abd0: 2020 2020 2020 2020 2020 2022 6f62 6a65             "obje
-0000abe0: 6374 2d69 6422 3a20 6f62 6a65 6374 5f69  ct-id": object_i
-0000abf0: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
-0000ac00: 666f 7263 6522 3a20 666f 7263 652c 0a20  force": force,. 
-0000ac10: 2020 2020 2020 2020 2020 2022 6772 6163             "grac
-0000ac20: 652d 7065 7269 6f64 223a 2067 7261 6365  e-period": grace
-0000ac30: 5f70 6572 696f 642c 0a20 2020 2020 2020  _period,.       
-0000ac40: 207d 0a20 2020 2020 2020 2065 7272 6f72   }.        error
-0000ac50: 203d 2022 4661 696c 6564 2064 656c 6574   = "Failed delet
-0000ac60: 696e 6720 7275 6e74 696d 6520 7265 736f  ing runtime reso
-0000ac70: 7572 6365 7322 0a20 2020 2020 2020 2070  urces".        p
-0000ac80: 726f 6a65 6374 5f70 6174 6820 3d20 7072  roject_path = pr
-0000ac90: 6f6a 6563 7420 6966 2070 726f 6a65 6374  oject if project
-0000aca0: 2065 6c73 6520 222a 220a 2020 2020 2020   else "*".      
-0000acb0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-0000acc0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-0000acd0: 2020 2020 2020 2020 2244 454c 4554 4522          "DELETE"
-0000ace0: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
-0000acf0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0000ad00: 745f 7061 7468 7d2f 7275 6e74 696d 652d  t_path}/runtime-
-0000ad10: 7265 736f 7572 6365 7322 2c0a 2020 2020  resources",.    
-0000ad20: 2020 2020 2020 2020 6572 726f 722c 0a20          error,. 
-0000ad30: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0000ad40: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
-0000ad50: 2020 290a 2020 2020 2020 2020 7374 7275    ).        stru
-0000ad60: 6374 7572 6564 5f64 6963 7420 3d20 7b7d  ctured_dict = {}
-0000ad70: 0a20 2020 2020 2020 2066 6f72 2070 726f  .        for pro
-0000ad80: 6a65 6374 2c20 6b69 6e64 5f72 756e 7469  ject, kind_runti
-0000ad90: 6d65 5f72 6573 6f75 7263 6573 5f6d 6170  me_resources_map
-0000ada0: 2069 6e20 7265 7370 6f6e 7365 2e6a 736f   in response.jso
-0000adb0: 6e28 292e 6974 656d 7328 293a 0a20 2020  n().items():.   
-0000adc0: 2020 2020 2020 2020 2066 6f72 206b 696e           for kin
-0000add0: 642c 2072 756e 7469 6d65 5f72 6573 6f75  d, runtime_resou
-0000ade0: 7263 6573 2069 6e20 6b69 6e64 5f72 756e  rces in kind_run
-0000adf0: 7469 6d65 5f72 6573 6f75 7263 6573 5f6d  time_resources_m
-0000ae00: 6170 2e69 7465 6d73 2829 3a0a 2020 2020  ap.items():.    
-0000ae10: 2020 2020 2020 2020 2020 2020 7374 7275              stru
-0000ae20: 6374 7572 6564 5f64 6963 742e 7365 7464  ctured_dict.setd
-0000ae30: 6566 6175 6c74 2870 726f 6a65 6374 2c20  efault(project, 
-0000ae40: 7b7d 295b 0a20 2020 2020 2020 2020 2020  {})[.           
-0000ae50: 2020 2020 2020 2020 206b 696e 640a 2020           kind.  
-0000ae60: 2020 2020 2020 2020 2020 2020 2020 5d20                ] 
-0000ae70: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0000ae80: 6368 656d 6173 2e52 756e 7469 6d65 5265  chemas.RuntimeRe
-0000ae90: 736f 7572 6365 7328 2a2a 7275 6e74 696d  sources(**runtim
-0000aea0: 655f 7265 736f 7572 6365 7329 0a20 2020  e_resources).   
-0000aeb0: 2020 2020 2072 6574 7572 6e20 7374 7275       return stru
-0000aec0: 6374 7572 6564 5f64 6963 740a 0a20 2020  ctured_dict..   
-0000aed0: 2064 6566 2063 7265 6174 655f 7363 6865   def create_sche
-0000aee0: 6475 6c65 280a 2020 2020 2020 2020 7365  dule(.        se
-0000aef0: 6c66 2c20 7072 6f6a 6563 743a 2073 7472  lf, project: str
-0000af00: 2c20 7363 6865 6475 6c65 3a20 6d6c 7275  , schedule: mlru
-0000af10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000af20: 2e53 6368 6564 756c 6549 6e70 7574 0a20  .ScheduleInput. 
-0000af30: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000af40: 2243 7265 6174 6520 6120 6e65 7720 7363  "Create a new sc
-0000af50: 6865 6475 6c65 206f 6e20 7468 6520 6769  hedule on the gi
-0000af60: 7665 6e20 7072 6f6a 6563 742e 2054 6865  ven project. The
-0000af70: 2064 6574 6169 6c73 206f 6e20 7468 6520   details on the 
-0000af80: 6163 7475 616c 206f 626a 6563 7420 746f  actual object to
-0000af90: 2073 6368 6564 756c 6520 6173 2077 656c   schedule as wel
-0000afa0: 6c20 6173 2074 6865 0a20 2020 2020 2020  l as the.       
-0000afb0: 2073 6368 6564 756c 6520 6974 7365 6c66   schedule itself
-0000afc0: 2061 7265 2077 6974 6869 6e20 7468 6520   are within the 
-0000afd0: 7363 6865 6475 6c65 206f 626a 6563 7420  schedule object 
-0000afe0: 7072 6f76 6964 6564 2e0a 2020 2020 2020  provided..      
-0000aff0: 2020 5468 6520 3a70 793a 636c 6173 733a    The :py:class:
-0000b000: 607e 5363 6865 6475 6c65 4372 6f6e 5472  `~ScheduleCronTr
-0000b010: 6967 6765 7260 2066 6f6c 6c6f 7773 2074  igger` follows t
-0000b020: 6865 2067 7569 6465 6c69 6e65 7320 696e  he guidelines in
-0000b030: 0a20 2020 2020 2020 2068 7474 7073 3a2f  .        https:/
-0000b040: 2f61 7073 6368 6564 756c 6572 2e72 6561  /apscheduler.rea
-0000b050: 6474 6865 646f 6373 2e69 6f2f 656e 2f33  dthedocs.io/en/3
-0000b060: 2e78 2f6d 6f64 756c 6573 2f74 7269 6767  .x/modules/trigg
-0000b070: 6572 732f 6372 6f6e 2e68 746d 6c2e 0a20  ers/cron.html.. 
-0000b080: 2020 2020 2020 2049 7420 616c 736f 2073         It also s
-0000b090: 7570 706f 7274 7320 6120 3a70 793a 6675  upports a :py:fu
-0000b0a0: 6e63 3a60 7e53 6368 6564 756c 6543 726f  nc:`~ScheduleCro
-0000b0b0: 6e54 7269 6767 6572 2e66 726f 6d5f 6372  nTrigger.from_cr
-0000b0c0: 6f6e 7461 6260 2066 756e 6374 696f 6e20  ontab` function 
-0000b0d0: 7468 6174 2061 6363 6570 7473 2061 0a20  that accepts a. 
-0000b0e0: 2020 2020 2020 2063 726f 6e74 6162 2d66         crontab-f
-0000b0f0: 6f72 6d61 7474 6564 2073 7472 696e 6720  ormatted string 
-0000b100: 2873 6565 2068 7474 7073 3a2f 2f65 6e2e  (see https://en.
-0000b110: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-0000b120: 6b69 2f43 726f 6e20 666f 7220 6d6f 7265  ki/Cron for more
-0000b130: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
-0000b140: 7468 6520 666f 726d 6174 2061 6e64 0a20  the format and. 
-0000b150: 2020 2020 2020 206e 6f74 6520 7468 6174         note that
-0000b160: 2074 6865 2030 2077 6565 6b64 6179 2069   the 0 weekday i
-0000b170: 7320 616c 7761 7973 206d 6f6e 6461 7929  s always monday)
-0000b180: 2e0a 0a0a 2020 2020 2020 2020 4578 616d  ....        Exam
-0000b190: 706c 653a 3a0a 0a20 2020 2020 2020 2020  ple::..         
-0000b1a0: 2020 2066 726f 6d20 6d6c 7275 6e2e 636f     from mlrun.co
-0000b1b0: 6d6d 6f6e 2069 6d70 6f72 7420 7363 6865  mmon import sche
-0000b1c0: 6d61 730a 0a20 2020 2020 2020 2020 2020  mas..           
-0000b1d0: 2023 2045 7865 6375 7465 2074 6865 2067   # Execute the g
-0000b1e0: 6574 5f64 6174 615f 6675 6e63 2066 756e  et_data_func fun
-0000b1f0: 6374 696f 6e20 6576 6572 7920 5475 6573  ction every Tues
-0000b200: 6461 7920 6174 2031 353a 3330 0a20 2020  day at 15:30.   
-0000b210: 2020 2020 2020 2020 2073 6368 6564 756c           schedul
-0000b220: 6520 3d20 7363 6865 6d61 732e 5363 6865  e = schemas.Sche
-0000b230: 6475 6c65 496e 7075 7428 0a20 2020 2020  duleInput(.     
-0000b240: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-0000b250: 2272 756e 5f66 756e 635f 6f6e 5f74 7565  "run_func_on_tue
-0000b260: 7364 6179 7322 2c0a 2020 2020 2020 2020  sdays",.        
-0000b270: 2020 2020 2020 2020 6b69 6e64 3d22 6a6f          kind="jo
-0000b280: 6222 2c0a 2020 2020 2020 2020 2020 2020  b",.            
-0000b290: 2020 2020 7363 6865 6475 6c65 645f 6f62      scheduled_ob
-0000b2a0: 6a65 6374 3d67 6574 5f64 6174 615f 6675  ject=get_data_fu
-0000b2b0: 6e63 2c0a 2020 2020 2020 2020 2020 2020  nc,.            
-0000b2c0: 2020 2020 6372 6f6e 5f74 7269 6767 6572      cron_trigger
-0000b2d0: 3d73 6368 656d 6173 2e53 6368 6564 756c  =schemas.Schedul
-0000b2e0: 6543 726f 6e54 7269 6767 6572 2864 6179  eCronTrigger(day
-0000b2f0: 5f6f 665f 7765 656b 3d27 7475 6527 2c20  _of_week='tue', 
-0000b300: 686f 7572 3d31 352c 206d 696e 7574 653d  hour=15, minute=
-0000b310: 3330 292c 0a20 2020 2020 2020 2020 2020  30),.           
-0000b320: 2029 0a20 2020 2020 2020 2020 2020 2064   ).            d
-0000b330: 622e 6372 6561 7465 5f73 6368 6564 756c  b.create_schedul
-0000b340: 6528 7072 6f6a 6563 745f 6e61 6d65 2c20  e(project_name, 
-0000b350: 7363 6865 6475 6c65 290a 2020 2020 2020  schedule).      
-0000b360: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-0000b370: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-0000b380: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-0000b390: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-0000b3a0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0000b3b0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
-0000b3c0: 6368 6564 756c 6573 220a 0a20 2020 2020  chedules"..     
-0000b3d0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0000b3e0: 203d 2066 2246 6169 6c65 6420 6372 6561   = f"Failed crea
-0000b3f0: 7469 6e67 2073 6368 6564 756c 6520 7b70  ting schedule {p
-0000b400: 726f 6a65 6374 7d2f 7b73 6368 6564 756c  roject}/{schedul
-0000b410: 652e 6e61 6d65 7d22 0a20 2020 2020 2020  e.name}".       
-0000b420: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-0000b430: 504f 5354 222c 2070 6174 682c 2065 7272  POST", path, err
-0000b440: 6f72 5f6d 6573 7361 6765 2c20 626f 6479  or_message, body
-0000b450: 3d64 6963 745f 746f 5f6a 736f 6e28 7363  =dict_to_json(sc
-0000b460: 6865 6475 6c65 2e64 6963 7428 2929 290a  hedule.dict())).
-0000b470: 0a20 2020 2064 6566 2075 7064 6174 655f  .    def update_
-0000b480: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
-0000b490: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
-0000b4a0: 2073 7472 2c20 6e61 6d65 3a20 7374 722c   str, name: str,
-0000b4b0: 2073 6368 6564 756c 653a 206d 6c72 756e   schedule: mlrun
-0000b4c0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0000b4d0: 5363 6865 6475 6c65 5570 6461 7465 0a20  ScheduleUpdate. 
-0000b4e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000b4f0: 2255 7064 6174 6520 616e 2065 7869 7374  "Update an exist
-0000b500: 696e 6720 7363 6865 6475 6c65 2c20 7265  ing schedule, re
-0000b510: 706c 6163 6520 6974 2077 6974 6820 7468  place it with th
-0000b520: 6520 6465 7461 696c 7320 636f 6e74 6169  e details contai
-0000b530: 6e65 6420 696e 2074 6865 2073 6368 6564  ned in the sched
-0000b540: 756c 6520 6f62 6a65 6374 2e22 2222 0a0a  ule object."""..
-0000b550: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-0000b560: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-0000b570: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-0000b580: 6563 740a 2020 2020 2020 2020 7061 7468  ect.        path
-0000b590: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0000b5a0: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
-0000b5b0: 732f 7b6e 616d 657d 220a 0a20 2020 2020  s/{name}"..     
-0000b5c0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0000b5d0: 203d 2066 2246 6169 6c65 6420 7570 6461   = f"Failed upda
-0000b5e0: 7469 6e67 2073 6368 6564 756c 6520 7b70  ting schedule {p
-0000b5f0: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
-0000b600: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-0000b610: 5f63 616c 6c28 2250 5554 222c 2070 6174  _call("PUT", pat
-0000b620: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
-0000b630: 2c20 626f 6479 3d64 6963 745f 746f 5f6a  , body=dict_to_j
-0000b640: 736f 6e28 7363 6865 6475 6c65 2e64 6963  son(schedule.dic
-0000b650: 7428 2929 290a 0a20 2020 2064 6566 2067  t()))..    def g
-0000b660: 6574 5f73 6368 6564 756c 6528 0a20 2020  et_schedule(.   
-0000b670: 2020 2020 2073 656c 662c 2070 726f 6a65       self, proje
-0000b680: 6374 3a20 7374 722c 206e 616d 653a 2073  ct: str, name: s
-0000b690: 7472 2c20 696e 636c 7564 655f 6c61 7374  tr, include_last
-0000b6a0: 5f72 756e 3a20 626f 6f6c 203d 2046 616c  _run: bool = Fal
-0000b6b0: 7365 0a20 2020 2029 202d 3e20 6d6c 7275  se.    ) -> mlru
-0000b6c0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000b6d0: 2e53 6368 6564 756c 654f 7574 7075 743a  .ScheduleOutput:
-0000b6e0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-0000b6f0: 6965 7665 2064 6574 6169 6c73 206f 6620  ieve details of 
-0000b700: 7468 6520 7363 6865 6475 6c65 2069 6e20  the schedule in 
-0000b710: 7175 6573 7469 6f6e 2e20 4265 7369 6465  question. Beside
-0000b720: 7320 7265 7475 726e 696e 6720 7468 6520  s returning the 
-0000b730: 6465 7461 696c 7320 6f66 2074 6865 2073  details of the s
-0000b740: 6368 6564 756c 6520 6f62 6a65 6374 2069  chedule object i
-0000b750: 7473 656c 662c 0a20 2020 2020 2020 2074  tself,.        t
-0000b760: 6869 7320 6675 6e63 7469 6f6e 2061 6c73  his function als
-0000b770: 6f20 7265 7475 726e 7320 7468 6520 6e65  o returns the ne
-0000b780: 7874 2073 6368 6564 756c 6564 2072 756e  xt scheduled run
-0000b790: 2066 6f72 2074 6869 7320 7370 6563 6966   for this specif
-0000b7a0: 6963 2073 6368 6564 756c 652c 2061 7320  ic schedule, as 
-0000b7b0: 7765 6c6c 2061 7320 706f 7465 6e74 6961  well as potentia
-0000b7c0: 6c6c 7920 7468 650a 2020 2020 2020 2020  lly the.        
-0000b7d0: 7265 7375 6c74 7320 6f66 2074 6865 206c  results of the l
-0000b7e0: 6173 7420 7275 6e20 6578 6563 7574 6564  ast run executed
-0000b7f0: 2074 6872 6f75 6768 2074 6869 7320 7363   through this sc
-0000b800: 6865 6475 6c65 2e0a 0a20 2020 2020 2020  hedule...       
-0000b810: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0000b820: 2050 726f 6a65 6374 206e 616d 652e 0a20   Project name.. 
-0000b830: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-0000b840: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-0000b850: 7363 6865 6475 6c65 206f 626a 6563 7420  schedule object 
-0000b860: 746f 2071 7565 7279 2e0a 2020 2020 2020  to query..      
-0000b870: 2020 3a70 6172 616d 2069 6e63 6c75 6465    :param include
-0000b880: 5f6c 6173 745f 7275 6e3a 2057 6865 7468  _last_run: Wheth
-0000b890: 6572 2074 6f20 696e 636c 7564 6520 7468  er to include th
-0000b8a0: 6520 7265 7375 6c74 7320 6f66 2074 6865  e results of the
-0000b8b0: 2073 6368 6564 756c 6527 7320 6c61 7374   schedule's last
-0000b8c0: 2072 756e 2069 6e20 7468 6520 7265 7370   run in the resp
-0000b8d0: 6f6e 7365 2e0a 2020 2020 2020 2020 2222  onse..        ""
-0000b8e0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-0000b8f0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-0000b900: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-0000b910: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-0000b920: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0000b930: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
-0000b940: 756c 6573 2f7b 6e61 6d65 7d22 0a20 2020  ules/{name}".   
-0000b950: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0000b960: 6765 203d 2066 2246 6169 6c65 6420 6765  ge = f"Failed ge
-0000b970: 7474 696e 6720 7363 6865 6475 6c65 2066  tting schedule f
-0000b980: 6f72 207b 7072 6f6a 6563 747d 2f7b 6e61  or {project}/{na
-0000b990: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-0000b9a0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000b9b0: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-0000b9c0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-0000b9d0: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
-0000b9e0: 733d 7b22 696e 636c 7564 655f 6c61 7374  s={"include_last
-0000b9f0: 5f72 756e 223a 2069 6e63 6c75 6465 5f6c  _run": include_l
-0000ba00: 6173 745f 7275 6e7d 0a20 2020 2020 2020  ast_run}.       
-0000ba10: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0000ba20: 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n mlrun.common.s
-0000ba30: 6368 656d 6173 2e53 6368 6564 756c 654f  chemas.ScheduleO
-0000ba40: 7574 7075 7428 2a2a 7265 7370 2e6a 736f  utput(**resp.jso
-0000ba50: 6e28 2929 0a0a 2020 2020 6465 6620 6c69  n())..    def li
-0000ba60: 7374 5f73 6368 6564 756c 6573 280a 2020  st_schedules(.  
-0000ba70: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000ba80: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-0000ba90: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-0000baa0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-0000bab0: 2020 2020 6b69 6e64 3a20 6d6c 7275 6e2e      kind: mlrun.
-0000bac0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0000bad0: 6368 6564 756c 654b 696e 6473 203d 204e  cheduleKinds = N
-0000bae0: 6f6e 652c 0a20 2020 2020 2020 2069 6e63  one,.        inc
-0000baf0: 6c75 6465 5f6c 6173 745f 7275 6e3a 2062  lude_last_run: b
-0000bb00: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0000bb10: 2029 202d 3e20 6d6c 7275 6e2e 636f 6d6d   ) -> mlrun.comm
-0000bb20: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
-0000bb30: 756c 6573 4f75 7470 7574 3a0a 2020 2020  ulesOutput:.    
-0000bb40: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0000bb50: 6c69 7374 206f 6620 7363 6865 6475 6c65  list of schedule
-0000bb60: 7320 6f66 2073 7065 6369 6669 6320 6e61  s of specific na
-0000bb70: 6d65 206f 7220 6b69 6e64 2e0a 0a20 2020  me or kind...   
-0000bb80: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0000bb90: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-0000bba0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000bbb0: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-0000bbc0: 7363 6865 6475 6c65 2074 6f20 7265 7472  schedule to retr
-0000bbd0: 6965 7665 2e20 4361 6e20 6265 206f 6d69  ieve. Can be omi
-0000bbe0: 7474 6564 2074 6f20 6c69 7374 2061 6c6c  tted to list all
-0000bbf0: 2073 6368 6564 756c 6573 2e0a 2020 2020   schedules..    
-0000bc00: 2020 2020 3a70 6172 616d 206b 696e 643a      :param kind:
-0000bc10: 204b 696e 6420 6f66 2073 6368 6564 756c   Kind of schedul
-0000bc20: 6520 6f62 6a65 6374 7320 746f 2072 6574  e objects to ret
-0000bc30: 7269 6576 652c 2063 616e 2062 6520 6569  rieve, can be ei
-0000bc40: 7468 6572 2060 606a 6f62 6060 206f 7220  ther ``job`` or 
-0000bc50: 6060 7069 7065 6c69 6e65 6060 2e0a 2020  ``pipeline``..  
-0000bc60: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
-0000bc70: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
-0000bc80: 6865 7468 6572 2074 6f20 7265 7475 726e  hether to return
-0000bc90: 2066 6f72 2065 6163 6820 7363 6865 6475   for each schedu
-0000bca0: 6c65 2072 6574 7572 6e65 6420 616c 736f  le returned also
-0000bcb0: 2074 6865 2072 6573 756c 7473 206f 6620   the results of 
-0000bcc0: 7468 6520 6c61 7374 2072 756e 206f 660a  the last run of.
-0000bcd0: 2020 2020 2020 2020 2020 2020 7468 6174              that
-0000bce0: 2073 6368 6564 756c 652e 0a20 2020 2020   schedule..     
-0000bcf0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000bd00: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-0000bd10: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-0000bd20: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-0000bd30: 2020 2020 7061 7261 6d73 203d 207b 226b      params = {"k
-0000bd40: 696e 6422 3a20 6b69 6e64 2c20 226e 616d  ind": kind, "nam
-0000bd50: 6522 3a20 6e61 6d65 2c20 2269 6e63 6c75  e": name, "inclu
-0000bd60: 6465 5f6c 6173 745f 7275 6e22 3a20 696e  de_last_run": in
-0000bd70: 636c 7564 655f 6c61 7374 5f72 756e 7d0a  clude_last_run}.
-0000bd80: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0000bd90: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0000bda0: 6374 7d2f 7363 6865 6475 6c65 7322 0a20  ct}/schedules". 
-0000bdb0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000bdc0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000bdd0: 6c69 7374 696e 6720 7363 6865 6475 6c65  listing schedule
-0000bde0: 7320 666f 7220 7b70 726f 6a65 6374 7d20  s for {project} 
-0000bdf0: 3f20 7b6b 696e 647d 207b 6e61 6d65 7d22  ? {kind} {name}"
-0000be00: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-0000be10: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-0000be20: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-0000be30: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-0000be40: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-0000be50: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-0000be60: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6368  mmon.schemas.Sch
-0000be70: 6564 756c 6573 4f75 7470 7574 282a 2a72  edulesOutput(**r
-0000be80: 6573 702e 6a73 6f6e 2829 290a 0a20 2020  esp.json())..   
-0000be90: 2064 6566 2064 656c 6574 655f 7363 6865   def delete_sche
-0000bea0: 6475 6c65 2873 656c 662c 2070 726f 6a65  dule(self, proje
-0000beb0: 6374 3a20 7374 722c 206e 616d 653a 2073  ct: str, name: s
-0000bec0: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0000bed0: 4465 6c65 7465 2061 2073 7065 6369 6669  Delete a specifi
-0000bee0: 6320 7363 6865 6475 6c65 2062 7920 6e61  c schedule by na
-0000bef0: 6d65 2e22 2222 0a0a 2020 2020 2020 2020  me."""..        
-0000bf00: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-0000bf10: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-0000bf20: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-0000bf30: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-0000bf40: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-0000bf50: 7363 6865 6475 6c65 732f 7b6e 616d 657d  schedules/{name}
-0000bf60: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-0000bf70: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0000bf80: 6564 2064 656c 6574 696e 6720 7363 6865  ed deleting sche
-0000bf90: 6475 6c65 207b 7072 6f6a 6563 747d 2f7b  dule {project}/{
-0000bfa0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-0000bfb0: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
-0000bfc0: 4c45 5445 222c 2070 6174 682c 2065 7272  LETE", path, err
-0000bfd0: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
-0000bfe0: 2064 6566 2069 6e76 6f6b 655f 7363 6865   def invoke_sche
-0000bff0: 6475 6c65 2873 656c 662c 2070 726f 6a65  dule(self, proje
-0000c000: 6374 3a20 7374 722c 206e 616d 653a 2073  ct: str, name: s
-0000c010: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0000c020: 4578 6563 7574 6520 7468 6520 6f62 6a65  Execute the obje
-0000c030: 6374 2072 6566 6572 656e 6365 6420 6279  ct referenced by
-0000c040: 2074 6865 2073 6368 6564 756c 6520 696d   the schedule im
-0000c050: 6d65 6469 6174 656c 792e 2222 220a 0a20  mediately.""".. 
-0000c060: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-0000c070: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-0000c080: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-0000c090: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
-0000c0a0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-0000c0b0: 6f6a 6563 747d 2f73 6368 6564 756c 6573  oject}/schedules
-0000c0c0: 2f7b 6e61 6d65 7d2f 696e 766f 6b65 220a  /{name}/invoke".
-0000c0d0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0000c0e0: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-0000c0f0: 2069 6e76 6f6b 696e 6720 7363 6865 6475   invoking schedu
-0000c100: 6c65 207b 7072 6f6a 6563 747d 2f7b 6e61  le {project}/{na
-0000c110: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
-0000c120: 662e 6170 695f 6361 6c6c 2822 504f 5354  f.api_call("POST
-0000c130: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0000c140: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-0000c150: 2072 656d 6f74 655f 6275 696c 6465 7228   remote_builder(
-0000c160: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000c170: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-0000c180: 2020 2020 2077 6974 685f 6d6c 7275 6e2c       with_mlrun,
-0000c190: 0a20 2020 2020 2020 206d 6c72 756e 5f76  .        mlrun_v
-0000c1a0: 6572 7369 6f6e 5f73 7065 6369 6669 6572  ersion_specifier
-0000c1b0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-0000c1c0: 6b69 705f 6465 706c 6f79 6564 3d46 616c  kip_deployed=Fal
-0000c1d0: 7365 2c0a 2020 2020 2020 2020 6275 696c  se,.        buil
-0000c1e0: 6465 725f 656e 763d 4e6f 6e65 2c0a 2020  der_env=None,.  
-0000c1f0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0000c200: 4275 696c 6420 7468 6520 706f 6420 696d  Build the pod im
-0000c210: 6167 6520 666f 7220 6120 6675 6e63 7469  age for a functi
-0000c220: 6f6e 2c20 666f 7220 6578 6563 7574 696f  on, for executio
-0000c230: 6e20 6f6e 2061 2072 656d 6f74 6520 636c  n on a remote cl
-0000c240: 7573 7465 722e 2054 6869 7320 6973 2065  uster. This is e
-0000c250: 7865 6375 7465 6420 6279 2074 6865 204d  xecuted by the M
-0000c260: 4c52 756e 0a20 2020 2020 2020 2041 5049  LRun.        API
-0000c270: 2073 6572 7665 722c 2061 6e64 2063 7265   server, and cre
-0000c280: 6174 6573 2061 2044 6f63 6b65 7220 696d  ates a Docker im
-0000c290: 6167 6520 6f75 7420 6f66 2074 6865 2066  age out of the f
-0000c2a0: 756e 6374 696f 6e20 7072 6f76 6964 6564  unction provided
-0000c2b0: 2061 6e64 2061 6e79 2073 7065 6369 6669   and any specifi
-0000c2c0: 6320 6275 696c 640a 2020 2020 2020 2020  c build.        
-0000c2d0: 696e 7374 7275 6374 696f 6e73 2070 726f  instructions pro
-0000c2e0: 7669 6465 6420 7769 7468 696e 2e20 5468  vided within. Th
-0000c2f0: 6973 2069 7320 6120 7072 652d 7265 7175  is is a pre-requ
-0000c300: 6973 6974 6520 666f 7220 7265 6d6f 7465  isite for remote
-0000c310: 6c79 2065 7865 6375 7469 6e67 2061 2066  ly executing a f
-0000c320: 756e 6374 696f 6e2c 2075 6e6c 6573 7320  unction, unless 
-0000c330: 7573 696e 670a 2020 2020 2020 2020 6120  using.        a 
-0000c340: 7072 652d 6465 706c 6f79 6564 2069 6d61  pre-deployed ima
-0000c350: 6765 2e0a 0a20 2020 2020 2020 203a 7061  ge...        :pa
-0000c360: 7261 6d20 6675 6e63 3a20 4675 6e63 7469  ram func: Functi
-0000c370: 6f6e 2074 6f20 6275 696c 642e 0a20 2020  on to build..   
-0000c380: 2020 2020 203a 7061 7261 6d20 7769 7468       :param with
-0000c390: 5f6d 6c72 756e 3a20 5768 6574 6865 7220  _mlrun: Whether 
-0000c3a0: 746f 2061 6464 204d 4c52 756e 2070 6163  to add MLRun pac
-0000c3b0: 6b61 6765 2074 6f20 7468 6520 6275 696c  kage to the buil
-0000c3c0: 7420 7061 636b 6167 652e 2054 6869 7320  t package. This 
-0000c3d0: 6973 206e 6f74 2072 6571 7569 7265 6420  is not required 
-0000c3e0: 6966 2075 7369 6e67 2061 2062 6173 650a  if using a base.
-0000c3f0: 2020 2020 2020 2020 2020 2020 696d 6167              imag
-0000c400: 6520 7468 6174 2061 6c72 6561 6479 2068  e that already h
-0000c410: 6173 204d 4c52 756e 2069 6e20 6974 2e0a  as MLRun in it..
-0000c420: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
-0000c430: 6c72 756e 5f76 6572 7369 6f6e 5f73 7065  lrun_version_spe
-0000c440: 6369 6669 6572 3a20 5665 7273 696f 6e20  cifier: Version 
-0000c450: 6f66 204d 4c52 756e 2074 6f20 696e 636c  of MLRun to incl
-0000c460: 7564 6520 696e 2074 6865 2062 7569 6c74  ude in the built
-0000c470: 2069 6d61 6765 2e0a 2020 2020 2020 2020   image..        
-0000c480: 3a70 6172 616d 2073 6b69 705f 6465 706c  :param skip_depl
-0000c490: 6f79 6564 3a20 536b 6970 2074 6865 2062  oyed: Skip the b
-0000c4a0: 7569 6c64 2069 6620 7765 2061 6c72 6561  uild if we alrea
-0000c4b0: 6479 2068 6176 6520 616e 2069 6d61 6765  dy have an image
-0000c4c0: 2066 6f72 2074 6865 2066 756e 6374 696f   for the functio
-0000c4d0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-0000c4e0: 6d20 6275 696c 6465 725f 656e 763a 2020  m builder_env:  
-0000c4f0: 204b 616e 696b 6f20 6275 696c 6465 7220   Kaniko builder 
-0000c500: 706f 6420 656e 7620 7661 7273 2064 6963  pod env vars dic
-0000c510: 7420 2866 6f72 2063 6f6e 6669 672f 6372  t (for config/cr
-0000c520: 6564 656e 7469 616c 7329 0a20 2020 2020  edentials).     
-0000c530: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000c540: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000c550: 2072 6571 203d 207b 0a20 2020 2020 2020   req = {.       
-0000c560: 2020 2020 2020 2020 2022 6675 6e63 7469           "functi
-0000c570: 6f6e 223a 2066 756e 632e 746f 5f64 6963  on": func.to_dic
-0000c580: 7428 292c 0a20 2020 2020 2020 2020 2020  t(),.           
-0000c590: 2020 2020 2022 7769 7468 5f6d 6c72 756e       "with_mlrun
-0000c5a0: 223a 2062 6f6f 6c32 7374 7228 7769 7468  ": bool2str(with
-0000c5b0: 5f6d 6c72 756e 292c 0a20 2020 2020 2020  _mlrun),.       
-0000c5c0: 2020 2020 2020 2020 2022 736b 6970 5f64           "skip_d
-0000c5d0: 6570 6c6f 7965 6422 3a20 736b 6970 5f64  eployed": skip_d
-0000c5e0: 6570 6c6f 7965 642c 0a20 2020 2020 2020  eployed,.       
-0000c5f0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0000c600: 2020 2069 6620 6d6c 7275 6e5f 7665 7273     if mlrun_vers
-0000c610: 696f 6e5f 7370 6563 6966 6965 723a 0a20  ion_specifier:. 
-0000c620: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c630: 6571 5b22 6d6c 7275 6e5f 7665 7273 696f  eq["mlrun_versio
-0000c640: 6e5f 7370 6563 6966 6965 7222 5d20 3d20  n_specifier"] = 
-0000c650: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000c660: 6563 6966 6965 720a 2020 2020 2020 2020  ecifier.        
-0000c670: 2020 2020 6966 2062 7569 6c64 6572 5f65      if builder_e
-0000c680: 6e76 3a0a 2020 2020 2020 2020 2020 2020  nv:.            
-0000c690: 2020 2020 7265 715b 2262 7569 6c64 6572      req["builder
-0000c6a0: 5f65 6e76 225d 203d 2062 7569 6c64 6572  _env"] = builder
-0000c6b0: 5f65 6e76 0a20 2020 2020 2020 2020 2020  _env.           
-0000c6c0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-0000c6d0: 5f63 616c 6c28 2250 4f53 5422 2c20 2262  _call("POST", "b
-0000c6e0: 7569 6c64 2f66 756e 6374 696f 6e22 2c20  uild/function", 
-0000c6f0: 6a73 6f6e 3d72 6571 290a 2020 2020 2020  json=req).      
-0000c700: 2020 6578 6365 7074 204f 5345 7272 6f72    except OSError
-0000c710: 2061 7320 6572 723a 0a20 2020 2020 2020   as err:.       
-0000c720: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
-0000c730: 7228 6622 6572 726f 7220 7375 626d 6974  r(f"error submit
-0000c740: 7469 6e67 2062 7569 6c64 2074 6173 6b3a  ting build task:
-0000c750: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000c760: 297d 2229 0a20 2020 2020 2020 2020 2020  )}").           
-0000c770: 2072 6169 7365 204f 5345 7272 6f72 2866   raise OSError(f
-0000c780: 2265 7272 6f72 3a20 6361 6e6e 6f74 2073  "error: cannot s
-0000c790: 7562 6d69 7420 6275 696c 642c 207b 6572  ubmit build, {er
-0000c7a0: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000c7b0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000c7c0: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
-0000c7d0: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
-0000c7e0: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
-0000c7f0: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
-0000c800: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000c810: 2056 616c 7565 4572 726f 7228 2262 6164   ValueError("bad
-0000c820: 2066 756e 6374 696f 6e20 7275 6e20 7265   function run re
-0000c830: 7370 6f6e 7365 2229 0a0a 2020 2020 2020  sponse")..      
-0000c840: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-0000c850: 6f6e 2829 0a0a 2020 2020 6465 6620 6765  on()..    def ge
-0000c860: 745f 6275 696c 6465 725f 7374 6174 7573  t_builder_status
-0000c870: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000c880: 2020 2020 2020 2020 6675 6e63 3a20 4261          func: Ba
-0000c890: 7365 5275 6e74 696d 652c 0a20 2020 2020  seRuntime,.     
-0000c8a0: 2020 206f 6666 7365 743a 2069 6e74 203d     offset: int =
-0000c8b0: 2030 2c0a 2020 2020 2020 2020 6c6f 6773   0,.        logs
-0000c8c0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-0000c8d0: 2020 2020 2020 206c 6173 745f 6c6f 675f         last_log_
-0000c8e0: 7469 6d65 7374 616d 703a 2066 6c6f 6174  timestamp: float
-0000c8f0: 203d 2030 2e30 2c0a 2020 2020 2020 2020   = 0.0,.        
-0000c900: 7665 7262 6f73 653a 2062 6f6f 6c20 3d20  verbose: bool = 
-0000c910: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
-0000c920: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
-0000c930: 6520 7468 6520 7374 6174 7573 206f 6620  e the status of 
-0000c940: 6120 6275 696c 6420 6f70 6572 6174 696f  a build operatio
-0000c950: 6e20 6375 7272 656e 746c 7920 696e 2070  n currently in p
-0000c960: 726f 6772 6573 732e 0a0a 2020 2020 2020  rogress...      
-0000c970: 2020 3a70 6172 616d 2066 756e 633a 2020    :param func:  
-0000c980: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
-0000c990: 6e63 7469 6f6e 206f 626a 6563 7420 7468  nction object th
-0000c9a0: 6174 2069 7320 6265 696e 6720 6275 696c  at is being buil
-0000c9b0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0000c9c0: 6d20 6f66 6673 6574 3a20 2020 2020 2020  m offset:       
-0000c9d0: 2020 2020 2020 204f 6666 7365 7420 696e         Offset in
-0000c9e0: 746f 2074 6865 2062 7569 6c64 206c 6f67  to the build log
-0000c9f0: 7320 746f 2072 6574 7269 6576 6520 6c6f  s to retrieve lo
-0000ca00: 6773 2066 726f 6d2e 0a20 2020 2020 2020  gs from..       
-0000ca10: 203a 7061 7261 6d20 6c6f 6773 3a20 2020   :param logs:   
-0000ca20: 2020 2020 2020 2020 2020 2020 2053 686f               Sho
-0000ca30: 756c 6420 6275 696c 6420 6c6f 6773 2062  uld build logs b
-0000ca40: 6520 7265 7472 6965 7665 642e 0a20 2020  e retrieved..   
-0000ca50: 2020 2020 203a 7061 7261 6d20 6c61 7374       :param last
-0000ca60: 5f6c 6f67 5f74 696d 6573 7461 6d70 3a20  _log_timestamp: 
-0000ca70: 204c 6173 7420 7469 6d65 7374 616d 7020   Last timestamp 
-0000ca80: 6f66 206c 6f67 7320 7468 6174 2077 6572  of logs that wer
-0000ca90: 6520 616c 7265 6164 7920 7265 7472 6965  e already retrie
-0000caa0: 7665 642e 2046 756e 6374 696f 6e20 7769  ved. Function wi
-0000cab0: 6c6c 2072 6574 7572 6e20 6f6e 6c79 206c  ll return only l
-0000cac0: 6f67 730a 2020 2020 2020 2020 2020 2020  ogs.            
-0000cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cae0: 2020 2020 2020 2020 6c61 7465 7220 7468          later th
-0000caf0: 616e 2074 6869 7320 7061 7261 6d65 7465  an this paramete
-0000cb00: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-0000cb10: 6d20 7665 7262 6f73 653a 2020 2020 2020  m verbose:      
-0000cb20: 2020 2020 2020 2041 6464 2076 6572 626f         Add verbo
-0000cb30: 7365 206c 6f67 7320 696e 746f 2074 6865  se logs into the
-0000cb40: 206f 7574 7075 742e 0a0a 2020 2020 2020   output...      
-0000cb50: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
-0000cb60: 666f 6c6c 6f77 696e 6720 7061 7261 6d65  following parame
-0000cb70: 7465 7273 3a0a 0a20 2020 2020 2020 2020  ters:..         
-0000cb80: 2020 202d 2054 6578 7420 6f66 2062 7569     - Text of bui
-0000cb90: 6c64 6572 206c 6f67 732e 0a20 2020 2020  lder logs..     
-0000cba0: 2020 2020 2020 202d 2054 696d 6573 7461         - Timesta
-0000cbb0: 6d70 206f 6620 6c61 7374 206c 6f67 2072  mp of last log r
-0000cbc0: 6574 7269 6576 6564 2c20 746f 2062 6520  etrieved, to be 
-0000cbd0: 7573 6564 2069 6e20 7375 6273 6571 7565  used in subseque
-0000cbe0: 6e74 2063 616c 6c73 2074 6f20 7468 6973  nt calls to this
-0000cbf0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
-0000cc00: 2020 2020 2020 2020 5468 6520 6675 6e63          The func
-0000cc10: 7469 6f6e 2061 6c73 6f20 7570 6461 7465  tion also update
-0000cc20: 7320 696e 7465 726e 616c 206d 656d 6265  s internal membe
-0000cc30: 7273 206f 6620 7468 6520 6060 6675 6e63  rs of the ``func
-0000cc40: 6060 206f 626a 6563 7420 746f 2072 6566  `` object to ref
-0000cc50: 6c65 6374 2062 7569 6c64 2070 726f 6365  lect build proce
-0000cc60: 7373 2069 6e66 6f2e 0a20 2020 2020 2020  ss info..       
-0000cc70: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-0000cc80: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
-0000cc90: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-0000cca0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-0000ccb0: 3a20 6e6f 726d 616c 697a 655f 6e61 6d65  : normalize_name
-0000ccc0: 2866 756e 632e 6d65 7461 6461 7461 2e6e  (func.metadata.n
-0000ccd0: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
-0000cce0: 2020 2020 2020 2270 726f 6a65 6374 223a        "project":
-0000ccf0: 2066 756e 632e 6d65 7461 6461 7461 2e70   func.metadata.p
-0000cd00: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
-0000cd10: 2020 2020 2020 2020 2274 6167 223a 2066          "tag": f
-0000cd20: 756e 632e 6d65 7461 6461 7461 2e74 6167  unc.metadata.tag
-0000cd30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000cd40: 2020 226c 6f67 7322 3a20 626f 6f6c 3273    "logs": bool2s
-0000cd50: 7472 286c 6f67 7329 2c0a 2020 2020 2020  tr(logs),.      
-0000cd60: 2020 2020 2020 2020 2020 226f 6666 7365            "offse
-0000cd70: 7422 3a20 7374 7228 6f66 6673 6574 292c  t": str(offset),
-0000cd80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cd90: 2022 6c61 7374 5f6c 6f67 5f74 696d 6573   "last_log_times
-0000cda0: 7461 6d70 223a 2073 7472 286c 6173 745f  tamp": str(last_
-0000cdb0: 6c6f 675f 7469 6d65 7374 616d 7029 2c0a  log_timestamp),.
-0000cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cdd0: 2276 6572 626f 7365 223a 2062 6f6f 6c32  "verbose": bool2
-0000cde0: 7374 7228 7665 7262 6f73 6529 2c0a 2020  str(verbose),.  
-0000cdf0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0000ce00: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-0000ce10: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-0000ce20: 5422 2c20 2262 7569 6c64 2f73 7461 7475  T", "build/statu
-0000ce30: 7322 2c20 7061 7261 6d73 3d70 6172 616d  s", params=param
-0000ce40: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
-0000ce50: 7420 4f53 4572 726f 7220 6173 2065 7272  t OSError as err
-0000ce60: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0000ce70: 6767 6572 2e65 7272 6f72 2866 2265 7272  gger.error(f"err
-0000ce80: 6f72 2067 6574 7469 6e67 2062 7569 6c64  or getting build
-0000ce90: 2073 7461 7475 733a 207b 6572 725f 746f   status: {err_to
-0000cea0: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
-0000ceb0: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
-0000cec0: 5345 7272 6f72 2866 2265 7272 6f72 3a20  SError(f"error: 
-0000ced0: 6361 6e6e 6f74 2067 6574 2062 7569 6c64  cannot get build
-0000cee0: 2073 7461 7475 732c 207b 6572 725f 746f   status, {err_to
-0000cef0: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
-0000cf00: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-0000cf10: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-0000cf20: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
-0000cf30: 2866 2266 6169 6c65 6420 7265 7370 2c20  (f"failed resp, 
-0000cf40: 7b72 6573 702e 7465 7874 7d22 290a 2020  {resp.text}").  
-0000cf50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000cf60: 5275 6e44 4245 7272 6f72 2822 6261 6420  RunDBError("bad 
-0000cf70: 6675 6e63 7469 6f6e 2062 7569 6c64 2072  function build r
-0000cf80: 6573 706f 6e73 6522 290a 0a20 2020 2020  esponse")..     
-0000cf90: 2020 2069 6620 7265 7370 2e68 6561 6465     if resp.heade
-0000cfa0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-0000cfb0: 6675 6e63 2e73 7461 7475 732e 7374 6174  func.status.stat
-0000cfc0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
-0000cfd0: 2e67 6574 2822 782d 6d6c 7275 6e2d 6675  .get("x-mlrun-fu
-0000cfe0: 6e63 7469 6f6e 2d73 7461 7475 7322 2c20  nction-status", 
-0000cff0: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
-0000d000: 6c61 7374 5f6c 6f67 5f74 696d 6573 7461  last_log_timesta
-0000d010: 6d70 203d 2066 6c6f 6174 280a 2020 2020  mp = float(.    
-0000d020: 2020 2020 2020 2020 2020 2020 7265 7370              resp
-0000d030: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
-0000d040: 6d6c 7275 6e2d 6c61 7374 2d74 696d 6573  mlrun-last-times
-0000d050: 7461 6d70 222c 2022 302e 3022 290a 2020  tamp", "0.0").  
-0000d060: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000d070: 2020 2020 2020 2020 6966 2066 756e 632e          if func.
-0000d080: 6b69 6e64 2069 6e20 6d6c 7275 6e2e 7275  kind in mlrun.ru
-0000d090: 6e74 696d 6573 2e52 756e 7469 6d65 4b69  ntimes.RuntimeKi
-0000d0a0: 6e64 732e 6e75 636c 696f 5f72 756e 7469  nds.nuclio_runti
-0000d0b0: 6d65 7328 293a 0a20 2020 2020 2020 2020  mes():.         
-0000d0c0: 2020 2020 2020 2066 756e 632e 7374 6174         func.stat
-0000d0d0: 7573 2e61 6464 7265 7373 203d 2072 6573  us.address = res
-0000d0e0: 702e 6865 6164 6572 732e 6765 7428 2278  p.headers.get("x
-0000d0f0: 2d6d 6c72 756e 2d61 6464 7265 7373 222c  -mlrun-address",
-0000d100: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
-0000d110: 2020 2020 2066 756e 632e 7374 6174 7573       func.status
-0000d120: 2e6e 7563 6c69 6f5f 6e61 6d65 203d 2072  .nuclio_name = r
-0000d130: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
-0000d140: 2278 2d6d 6c72 756e 2d6e 616d 6522 2c20  "x-mlrun-name", 
-0000d150: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
-0000d160: 2020 2020 6675 6e63 2e73 7461 7475 732e      func.status.
-0000d170: 696e 7465 726e 616c 5f69 6e76 6f63 6174  internal_invocat
-0000d180: 696f 6e5f 7572 6c73 203d 2072 6573 702e  ion_urls = resp.
-0000d190: 6865 6164 6572 732e 6765 7428 0a20 2020  headers.get(.   
-0000d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1b0: 2022 782d 6d6c 7275 6e2d 696e 7465 726e   "x-mlrun-intern
-0000d1c0: 616c 2d69 6e76 6f63 6174 696f 6e2d 7572  al-invocation-ur
-0000d1d0: 6c73 222c 2022 220a 2020 2020 2020 2020  ls", "".        
-0000d1e0: 2020 2020 2020 2020 292e 7370 6c69 7428          ).split(
-0000d1f0: 222c 2229 0a20 2020 2020 2020 2020 2020  ",").           
-0000d200: 2020 2020 2066 756e 632e 7374 6174 7573       func.status
-0000d210: 2e65 7874 6572 6e61 6c5f 696e 766f 6361  .external_invoca
-0000d220: 7469 6f6e 5f75 726c 7320 3d20 7265 7370  tion_urls = resp
-0000d230: 2e68 6561 6465 7273 2e67 6574 280a 2020  .headers.get(.  
-0000d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d250: 2020 2278 2d6d 6c72 756e 2d65 7874 6572    "x-mlrun-exter
-0000d260: 6e61 6c2d 696e 766f 6361 7469 6f6e 2d75  nal-invocation-u
-0000d270: 726c 7322 2c20 2222 0a20 2020 2020 2020  rls", "".       
-0000d280: 2020 2020 2020 2020 2029 2e73 706c 6974           ).split
-0000d290: 2822 2c22 290a 2020 2020 2020 2020 2020  (",").          
-0000d2a0: 2020 2020 2020 6675 6e63 2e73 7461 7475        func.statu
-0000d2b0: 732e 636f 6e74 6169 6e65 725f 696d 6167  s.container_imag
-0000d2c0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
-0000d2d0: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
-0000d2e0: 2020 2020 2020 2020 2020 2278 2d6d 6c72            "x-mlr
-0000d2f0: 756e 2d63 6f6e 7461 696e 6572 2d69 6d61  un-container-ima
-0000d300: 6765 222c 2022 220a 2020 2020 2020 2020  ge", "".        
-0000d310: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000d320: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000d330: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-0000d340: 2e73 7461 7475 732e 6275 696c 645f 706f  .status.build_po
-0000d350: 6420 3d20 7265 7370 2e68 6561 6465 7273  d = resp.headers
-0000d360: 2e67 6574 2822 6275 696c 6465 725f 706f  .get("builder_po
-0000d370: 6422 2c20 2222 290a 2020 2020 2020 2020  d", "").        
-0000d380: 2020 2020 2020 2020 6675 6e63 2e73 7065          func.spe
-0000d390: 632e 696d 6167 6520 3d20 7265 7370 2e68  c.image = resp.h
-0000d3a0: 6561 6465 7273 2e67 6574 2822 6675 6e63  eaders.get("func
-0000d3b0: 7469 6f6e 5f69 6d61 6765 222c 2022 2229  tion_image", "")
-0000d3c0: 0a0a 2020 2020 2020 2020 7465 7874 203d  ..        text =
-0000d3d0: 2022 220a 2020 2020 2020 2020 6966 2072   "".        if r
-0000d3e0: 6573 702e 636f 6e74 656e 743a 0a20 2020  esp.content:.   
-0000d3f0: 2020 2020 2020 2020 2074 6578 7420 3d20           text = 
-0000d400: 7265 7370 2e63 6f6e 7465 6e74 2e64 6563  resp.content.dec
-0000d410: 6f64 6528 290a 2020 2020 2020 2020 7265  ode().        re
-0000d420: 7475 726e 2074 6578 742c 206c 6173 745f  turn text, last_
-0000d430: 6c6f 675f 7469 6d65 7374 616d 700a 0a20  log_timestamp.. 
-0000d440: 2020 2064 6566 2072 656d 6f74 655f 7374     def remote_st
-0000d450: 6172 7428 7365 6c66 2c20 6675 6e63 5f75  art(self, func_u
-0000d460: 726c 2920 2d3e 206d 6c72 756e 2e63 6f6d  rl) -> mlrun.com
-0000d470: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
-0000d480: 6772 6f75 6e64 5461 736b 3a0a 2020 2020  groundTask:.    
-0000d490: 2020 2020 2222 2245 7865 6375 7465 2061      """Execute a
-0000d4a0: 2066 756e 6374 696f 6e20 7265 6d6f 7465   function remote
-0000d4b0: 6c79 2c20 5573 6564 2066 6f72 2060 6064  ly, Used for ``d
-0000d4c0: 6173 6b60 6020 6675 6e63 7469 6f6e 732e  ask`` functions.
-0000d4d0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000d4e0: 2066 756e 635f 7572 6c3a 2055 524c 2074   func_url: URL t
-0000d4f0: 6f20 7468 6520 6675 6e63 7469 6f6e 2074  o the function t
-0000d500: 6f20 6265 2065 7865 6375 7465 642e 0a20  o be executed.. 
-0000d510: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-0000d520: 2041 2042 6163 6b67 726f 756e 6454 6173   A BackgroundTas
-0000d530: 6b20 6f62 6a65 6374 2c20 7769 7468 2064  k object, with d
-0000d540: 6574 6169 6c73 206f 6e20 6578 6563 7574  etails on execut
-0000d550: 696f 6e20 7072 6f63 6573 7320 616e 6420  ion process and 
-0000d560: 6974 7320 7374 6174 7573 2e0a 2020 2020  its status..    
-0000d570: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000d580: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000d590: 2020 7265 7120 3d20 7b22 6675 6e63 7469    req = {"functi
-0000d5a0: 6f6e 5572 6c22 3a20 6675 6e63 5f75 726c  onUrl": func_url
-0000d5b0: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
-0000d5c0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-0000d5d0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0000d5e0: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-0000d5f0: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-0000d600: 7274 2f66 756e 6374 696f 6e22 2c0a 2020  rt/function",.  
-0000d610: 2020 2020 2020 2020 2020 2020 2020 6a73                js
-0000d620: 6f6e 3d72 6571 2c0a 2020 2020 2020 2020  on=req,.        
-0000d630: 2020 2020 2020 2020 7469 6d65 6f75 743d          timeout=
-0000d640: 696e 7428 636f 6e66 6967 2e73 7562 6d69  int(config.submi
-0000d650: 745f 7469 6d65 6f75 7429 206f 7220 3630  t_timeout) or 60
-0000d660: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000d670: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000d680: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000d690: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000d6a0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000d6b0: 7374 6172 7469 6e67 2066 756e 6374 696f  starting functio
-0000d6c0: 6e3a 207b 6572 725f 746f 5f73 7472 2865  n: {err_to_str(e
-0000d6d0: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
-0000d6e0: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
-0000d6f0: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
-0000d700: 2073 7461 7274 2066 756e 6374 696f 6e2c   start function,
-0000d710: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000d720: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
-0000d730: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
-0000d740: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0000d750: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
-0000d760: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
-0000d770: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000d780: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000d790: 2262 6164 2066 756e 6374 696f 6e20 7374  "bad function st
-0000d7a0: 6172 7420 7265 7370 6f6e 7365 2229 0a0a  art response")..
-0000d7b0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0000d7c0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000d7d0: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
-0000d7e0: 736b 282a 2a72 6573 702e 6a73 6f6e 2829  sk(**resp.json()
-0000d7f0: 290a 0a20 2020 2064 6566 2067 6574 5f70  )..    def get_p
-0000d800: 726f 6a65 6374 5f62 6163 6b67 726f 756e  roject_backgroun
-0000d810: 645f 7461 736b 280a 2020 2020 2020 2020  d_task(.        
-0000d820: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-0000d830: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-0000d840: 2020 2020 6e61 6d65 3a20 7374 722c 0a20      name: str,. 
-0000d850: 2020 2029 202d 3e20 6d6c 7275 6e2e 636f     ) -> mlrun.co
-0000d860: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-0000d870: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
-0000d880: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-0000d890: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
-0000d8a0: 7469 6f6e 206f 6e20 6120 7072 6f6a 6563  tion on a projec
-0000d8b0: 7420 6261 636b 6772 6f75 6e64 2074 6173  t background tas
-0000d8c0: 6b20 6265 696e 6720 6578 6563 7574 6564  k being executed
-0000d8d0: 2e22 2222 0a0a 2020 2020 2020 2020 7072  ."""..        pr
-0000d8e0: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-0000d8f0: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-0000d900: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-0000d910: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0000d920: 6374 732f 7b70 726f 6a65 6374 7d2f 6261  cts/{project}/ba
-0000d930: 636b 6772 6f75 6e64 2d74 6173 6b73 2f7b  ckground-tasks/{
-0000d940: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
-0000d950: 7272 6f72 5f6d 6573 7361 6765 203d 2028  rror_message = (
-0000d960: 0a20 2020 2020 2020 2020 2020 2066 2246  .            f"F
-0000d970: 6169 6c65 6420 6765 7474 696e 6720 7072  ailed getting pr
-0000d980: 6f6a 6563 7420 6261 636b 6772 6f75 6e64  oject background
-0000d990: 2074 6173 6b2e 2070 726f 6a65 6374 3d7b   task. project={
-0000d9a0: 7072 6f6a 6563 747d 2c20 6e61 6d65 3d7b  project}, name={
-0000d9b0: 6e61 6d65 7d22 0a20 2020 2020 2020 2029  name}".        )
-0000d9c0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-0000d9d0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-0000d9e0: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
-0000d9f0: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
-0000da00: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
-0000da10: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0000da20: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
-0000da30: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-0000da40: 2829 290a 0a20 2020 2064 6566 2067 6574  ())..    def get
-0000da50: 5f62 6163 6b67 726f 756e 645f 7461 736b  _background_task
-0000da60: 2873 656c 662c 206e 616d 653a 2073 7472  (self, name: str
-0000da70: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-0000da80: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0000da90: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
-0000daa0: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
-0000dab0: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
-0000dac0: 6e20 6f6e 2061 2062 6163 6b67 726f 756e  n on a backgroun
-0000dad0: 6420 7461 736b 2062 6569 6e67 2065 7865  d task being exe
-0000dae0: 6375 7465 642e 2222 220a 0a20 2020 2020  cuted."""..     
-0000daf0: 2020 2070 6174 6820 3d20 6622 6261 636b     path = f"back
-0000db00: 6772 6f75 6e64 2d74 6173 6b73 2f7b 6e61  ground-tasks/{na
-0000db10: 6d65 7d22 0a20 2020 2020 2020 2065 7272  me}".        err
-0000db20: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-0000db30: 6169 6c65 6420 6765 7474 696e 6720 6261  ailed getting ba
-0000db40: 636b 6772 6f75 6e64 2074 6173 6b2e 206e  ckground task. n
-0000db50: 616d 653d 7b6e 616d 657d 220a 2020 2020  ame={name}".    
-0000db60: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0000db70: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-0000db80: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
-0000db90: 6d65 7373 6167 6529 0a20 2020 2020 2020  message).       
-0000dba0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-0000dbb0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-0000dbc0: 6b67 726f 756e 6454 6173 6b28 2a2a 7265  kgroundTask(**re
-0000dbd0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-0000dbe0: 2020 2020 6465 6620 7265 6d6f 7465 5f73      def remote_s
-0000dbf0: 7461 7475 7328 7365 6c66 2c20 7072 6f6a  tatus(self, proj
-0000dc00: 6563 742c 206e 616d 652c 206b 696e 642c  ect, name, kind,
-0000dc10: 2073 656c 6563 746f 7229 3a0a 2020 2020   selector):.    
-0000dc20: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0000dc30: 7374 6174 7573 206f 6620 6120 6675 6e63  status of a func
-0000dc40: 7469 6f6e 2062 6569 6e67 2065 7865 6375  tion being execu
-0000dc50: 7465 6420 7265 6d6f 7465 6c79 2028 7265  ted remotely (re
-0000dc60: 6c65 7661 6e74 2074 6f20 6060 6461 736b  levant to ``dask
-0000dc70: 6060 2066 756e 6374 696f 6e73 292e 0a0a  `` functions)...
-0000dc80: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0000dc90: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
-0000dca0: 6563 7420 6f66 2074 6865 2066 756e 6374  ect of the funct
-0000dcb0: 696f 6e0a 2020 2020 2020 2020 3a70 6172  ion.        :par
-0000dcc0: 616d 206e 616d 653a 2054 6865 206e 616d  am name: The nam
-0000dcd0: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
-0000dce0: 6e0a 2020 2020 2020 2020 3a70 6172 616d  n.        :param
-0000dcf0: 206b 696e 643a 2054 6865 206b 696e 6420   kind: The kind 
-0000dd00: 6f66 2074 6865 2066 756e 6374 696f 6e2c  of the function,
-0000dd10: 2063 7572 7265 6e74 6c79 2060 6064 6173   currently ``das
-0000dd20: 6b60 6020 6973 2073 7570 706f 7274 6564  k`` is supported
-0000dd30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000dd40: 2073 656c 6563 746f 723a 2053 656c 6563   selector: Selec
-0000dd50: 746f 7220 636c 6175 7365 2074 6f20 6265  tor clause to be
-0000dd60: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
-0000dd70: 4b75 6265 726e 6574 6573 2073 7461 7475  Kubernetes statu
-0000dd80: 7320 7175 6572 7920 746f 2066 696c 7465  s query to filte
-0000dd90: 7220 7468 6520 7265 7375 6c74 732e 0a20  r the results.. 
-0000dda0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000ddb0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0000ddc0: 2020 2020 2072 6571 203d 207b 226b 696e       req = {"kin
-0000ddd0: 6422 3a20 6b69 6e64 2c20 2273 656c 6563  d": kind, "selec
-0000dde0: 746f 7222 3a20 7365 6c65 6374 6f72 2c20  tor": selector, 
-0000ddf0: 2270 726f 6a65 6374 223a 2070 726f 6a65  "project": proje
-0000de00: 6374 2c20 226e 616d 6522 3a20 6e61 6d65  ct, "name": name
-0000de10: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
-0000de20: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-0000de30: 6c6c 2822 504f 5354 222c 2022 7374 6174  ll("POST", "stat
-0000de40: 7573 2f66 756e 6374 696f 6e22 2c20 6a73  us/function", js
-0000de50: 6f6e 3d72 6571 290a 2020 2020 2020 2020  on=req).        
-0000de60: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
-0000de70: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
-0000de80: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000de90: 6622 6572 726f 7220 7374 6172 7469 6e67  f"error starting
-0000dea0: 2066 756e 6374 696f 6e3a 207b 6572 725f   function: {err_
-0000deb0: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
-0000dec0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ded0: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
-0000dee0: 3a20 6361 6e6e 6f74 2073 7461 7274 2066  : cannot start f
-0000def0: 756e 6374 696f 6e2c 207b 6572 725f 746f  unction, {err_to
-0000df00: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
-0000df10: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-0000df20: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-0000df30: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
-0000df40: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
-0000df50: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000df60: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000df70: 7565 4572 726f 7228 2262 6164 2066 756e  ueError("bad fun
-0000df80: 6374 696f 6e20 7374 6174 7573 2072 6573  ction status res
-0000df90: 706f 6e73 6522 290a 0a20 2020 2020 2020  ponse")..       
-0000dfa0: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-0000dfb0: 6e28 295b 2264 6174 6122 5d0a 0a20 2020  n()["data"]..   
-0000dfc0: 2064 6566 2073 7562 6d69 745f 6a6f 6228   def submit_job(
-0000dfd0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000dfe0: 2020 2020 2020 2072 756e 7370 6563 2c0a         runspec,.
-0000dff0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
-0000e000: 3a20 556e 696f 6e5b 7374 722c 206d 6c72  : Union[str, mlr
-0000e010: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0000e020: 732e 5363 6865 6475 6c65 4372 6f6e 5472  s.ScheduleCronTr
-0000e030: 6967 6765 725d 203d 204e 6f6e 652c 0a20  igger] = None,. 
-0000e040: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000e050: 2253 7562 6d69 7420 6120 6a6f 6220 666f  "Submit a job fo
-0000e060: 7220 7265 6d6f 7465 2065 7865 6375 7469  r remote executi
-0000e070: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-0000e080: 7261 6d20 7275 6e73 7065 633a 2054 6865  ram runspec: The
-0000e090: 2072 756e 7469 6d65 206f 626a 6563 7420   runtime object 
-0000e0a0: 7370 6563 2028 5461 736b 2920 746f 2065  spec (Task) to e
-0000e0b0: 7865 6375 7465 2e0a 2020 2020 2020 2020  xecute..        
-0000e0c0: 3a70 6172 616d 2073 6368 6564 756c 653a  :param schedule:
-0000e0d0: 2057 6865 7468 6572 2074 6f20 7363 6865   Whether to sche
-0000e0e0: 6475 6c65 2074 6869 7320 6a6f 6220 7573  dule this job us
-0000e0f0: 696e 6720 6120 4372 6f6e 2074 7269 6767  ing a Cron trigg
-0000e100: 6572 2e20 4966 206e 6f74 2073 7065 6369  er. If not speci
-0000e110: 6669 6564 2c20 7468 6520 6a6f 6220 7769  fied, the job wi
-0000e120: 6c6c 2062 6520 7375 626d 6974 7465 640a  ll be submitted.
-0000e130: 2020 2020 2020 2020 2020 2020 696d 6d65              imme
-0000e140: 6469 6174 656c 792e 0a20 2020 2020 2020  diately..       
-0000e150: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-0000e160: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000e170: 6571 203d 207b 2274 6173 6b22 3a20 7275  eq = {"task": ru
-0000e180: 6e73 7065 632e 746f 5f64 6963 7428 297d  nspec.to_dict()}
-0000e190: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000e1a0: 7363 6865 6475 6c65 3a0a 2020 2020 2020  schedule:.      
-0000e1b0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0000e1c0: 6e73 7461 6e63 6528 7363 6865 6475 6c65  nstance(schedule
-0000e1d0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-0000e1e0: 6368 656d 6173 2e53 6368 6564 756c 6543  chemas.ScheduleC
-0000e1f0: 726f 6e54 7269 6767 6572 293a 0a20 2020  ronTrigger):.   
-0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e210: 2073 6368 6564 756c 6520 3d20 7363 6865   schedule = sche
-0000e220: 6475 6c65 2e64 6963 7428 290a 2020 2020  dule.dict().    
-0000e230: 2020 2020 2020 2020 2020 2020 7265 715b              req[
-0000e240: 2273 6368 6564 756c 6522 5d20 3d20 7363  "schedule"] = sc
-0000e250: 6865 6475 6c65 0a20 2020 2020 2020 2020  hedule.         
-0000e260: 2020 2074 696d 656f 7574 203d 2028 696e     timeout = (in
-0000e270: 7428 636f 6e66 6967 2e73 7562 6d69 745f  t(config.submit_
-0000e280: 7469 6d65 6f75 7429 206f 7220 3132 3029  timeout) or 120)
-0000e290: 202b 2032 300a 2020 2020 2020 2020 2020   + 20.          
-0000e2a0: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
-0000e2b0: 695f 6361 6c6c 2822 504f 5354 222c 2022  i_call("POST", "
-0000e2c0: 7375 626d 6974 5f6a 6f62 222c 206a 736f  submit_job", jso
-0000e2d0: 6e3d 7265 712c 2074 696d 656f 7574 3d74  n=req, timeout=t
-0000e2e0: 696d 656f 7574 290a 0a20 2020 2020 2020  imeout)..       
-0000e2f0: 2065 7863 6570 7420 7265 7175 6573 7473   except requests
-0000e300: 2e48 5454 5045 7272 6f72 2061 7320 6572  .HTTPError as er
-0000e310: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-0000e320: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
-0000e330: 726f 7220 7375 626d 6974 7469 6e67 2074  ror submitting t
-0000e340: 6173 6b3a 207b 6572 725f 746f 5f73 7472  ask: {err_to_str
-0000e350: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
-0000e360: 2020 2020 2023 206e 6f74 2063 7265 6174       # not creat
-0000e370: 696e 6720 6120 6e65 7720 6578 6365 7074  ing a new except
-0000e380: 696f 6e20 6865 7265 2c20 696e 206f 7264  ion here, in ord
-0000e390: 6572 2074 6f20 6b65 6570 2074 6865 2072  er to keep the r
-0000e3a0: 6573 706f 6e73 6520 616e 6420 7374 6174  esponse and stat
-0000e3b0: 7573 2063 6f64 6520 696e 2074 6865 2065  us code in the e
-0000e3c0: 7863 6570 7469 6f6e 0a20 2020 2020 2020  xception.       
-0000e3d0: 2020 2020 2072 6169 7365 0a0a 2020 2020       raise..    
-0000e3e0: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
-0000e3f0: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
-0000e400: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000e410: 726f 7228 6622 6572 726f 7220 7375 626d  ror(f"error subm
-0000e420: 6974 7469 6e67 2074 6173 6b3a 207b 6572  itting task: {er
-0000e430: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000e440: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000e450: 7365 204f 5345 7272 6f72 2822 6572 726f  se OSError("erro
-0000e460: 723a 2063 616e 6e6f 7420 7375 626d 6974  r: cannot submit
-0000e470: 2074 6173 6b22 2920 6672 6f6d 2065 7272   task") from err
-0000e480: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000e490: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
-0000e4a0: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
-0000e4b0: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
-0000e4c0: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
-0000e4d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000e4e0: 2056 616c 7565 4572 726f 7228 6622 6261   ValueError(f"ba
-0000e4f0: 6420 6675 6e63 7469 6f6e 2072 756e 2072  d function run r
-0000e500: 6573 706f 6e73 652c 207b 7265 7370 2e74  esponse, {resp.t
-0000e510: 6578 747d 2229 0a0a 2020 2020 2020 2020  ext}")..        
-0000e520: 7265 7370 203d 2072 6573 702e 6a73 6f6e  resp = resp.json
-0000e530: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-0000e540: 6e20 7265 7370 5b22 6461 7461 225d 0a0a  n resp["data"]..
-0000e550: 2020 2020 6465 6620 7375 626d 6974 5f70      def submit_p
-0000e560: 6970 656c 696e 6528 0a20 2020 2020 2020  ipeline(.       
-0000e570: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-0000e580: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
-0000e590: 7069 7065 6c69 6e65 2c0a 2020 2020 2020  pipeline,.      
-0000e5a0: 2020 6172 6775 6d65 6e74 733d 4e6f 6e65    arguments=None
-0000e5b0: 2c0a 2020 2020 2020 2020 6578 7065 7269  ,.        experi
-0000e5c0: 6d65 6e74 3d4e 6f6e 652c 0a20 2020 2020  ment=None,.     
-0000e5d0: 2020 2072 756e 3d4e 6f6e 652c 0a20 2020     run=None,.   
-0000e5e0: 2020 2020 206e 616d 6573 7061 6365 3d4e       namespace=N
-0000e5f0: 6f6e 652c 0a20 2020 2020 2020 2061 7274  one,.        art
-0000e600: 6966 6163 745f 7061 7468 3d4e 6f6e 652c  ifact_path=None,
-0000e610: 0a20 2020 2020 2020 206f 7073 3d4e 6f6e  .        ops=Non
-0000e620: 652c 0a20 2020 2020 2020 2023 2054 4f44  e,.        # TOD
-0000e630: 4f3a 2064 6570 7265 6361 7465 642c 2072  O: deprecated, r
-0000e640: 656d 6f76 6520 696e 2031 2e35 2e30 0a20  emove in 1.5.0. 
-0000e650: 2020 2020 2020 2074 746c 3d4e 6f6e 652c         ttl=None,
-0000e660: 0a20 2020 2020 2020 2063 6c65 616e 7570  .        cleanup
-0000e670: 5f74 746c 3d4e 6f6e 652c 0a20 2020 2029  _ttl=None,.    )
-0000e680: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
-0000e690: 6d69 7420 6120 4b46 5020 7069 7065 6c69  mit a KFP pipeli
-0000e6a0: 6e65 2066 6f72 2065 7865 6375 7469 6f6e  ne for execution
-0000e6b0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000e6c0: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
-0000e6d0: 726f 6a65 6374 206f 6620 7468 6520 7069  roject of the pi
-0000e6e0: 7065 6c69 6e65 0a20 2020 2020 2020 203a  peline.        :
-0000e6f0: 7061 7261 6d20 7069 7065 6c69 6e65 3a20  param pipeline: 
-0000e700: 5069 7065 6c69 6e65 2066 756e 6374 696f  Pipeline functio
-0000e710: 6e20 6f72 2070 6174 6820 746f 202e 7961  n or path to .ya
-0000e720: 6d6c 2f2e 7a69 7020 7069 7065 6c69 6e65  ml/.zip pipeline
-0000e730: 2066 696c 652e 0a20 2020 2020 2020 203a   file..        :
-0000e740: 7061 7261 6d20 6172 6775 6d65 6e74 733a  param arguments:
-0000e750: 2041 2064 6963 7469 6f6e 6172 7920 6f66   A dictionary of
-0000e760: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-0000e770: 7373 2074 6f20 7468 6520 7069 7065 6c69  ss to the pipeli
-0000e780: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
-0000e790: 616d 2065 7870 6572 696d 656e 743a 2041  am experiment: A
-0000e7a0: 206e 616d 6520 746f 2061 7373 6967 6e20   name to assign 
-0000e7b0: 666f 7220 7468 6520 7370 6563 6966 6963  for the specific
-0000e7c0: 2065 7870 6572 696d 656e 742e 0a20 2020   experiment..   
-0000e7d0: 2020 2020 203a 7061 7261 6d20 7275 6e3a       :param run:
-0000e7e0: 2041 206e 616d 6520 666f 7220 7468 6973   A name for this
-0000e7f0: 2073 7065 6369 6669 6320 7275 6e2e 0a20   specific run.. 
-0000e800: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-0000e810: 6d65 7370 6163 653a 204b 7562 6572 6e65  mespace: Kuberne
-0000e820: 7465 7320 6e61 6d65 7370 6163 6520 746f  tes namespace to
-0000e830: 2065 7865 6375 7465 2074 6865 2070 6970   execute the pip
-0000e840: 656c 696e 6520 696e 2e0a 2020 2020 2020  eline in..      
-0000e850: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
-0000e860: 745f 7061 7468 3a20 4120 7061 7468 2074  t_path: A path t
-0000e870: 6f20 6172 7469 6661 6374 7320 7573 6564  o artifacts used
-0000e880: 2062 7920 7468 6973 2070 6970 656c 696e   by this pipelin
-0000e890: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000e8a0: 6d20 6f70 733a 2054 7261 6e73 666f 726d  m ops: Transform
-0000e8b0: 6572 7320 746f 2061 7070 6c79 206f 6e20  ers to apply on 
-0000e8c0: 616c 6c20 6f70 7320 696e 2074 6865 2070  all ops in the p
-0000e8d0: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
-0000e8e0: 203a 7061 7261 6d20 7474 6c3a 2070 6970   :param ttl: pip
-0000e8f0: 656c 696e 6520 636c 6561 6e75 7020 7474  eline cleanup tt
-0000e900: 6c20 696e 2073 6563 7320 2874 696d 6520  l in secs (time 
-0000e910: 746f 2077 6169 7420 6166 7465 7220 776f  to wait after wo
-0000e920: 726b 666c 6f77 2063 6f6d 706c 6574 696f  rkflow completio
-0000e930: 6e2c 2061 7420 7768 6963 6820 706f 696e  n, at which poin
-0000e940: 7420 7468 6520 776f 726b 666c 6f77 0a20  t the workflow. 
-0000e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e960: 2020 2061 6e64 2061 6c6c 2069 7473 2072     and all its r
-0000e970: 6573 6f75 7263 6573 2061 7265 2064 656c  esources are del
-0000e980: 6574 6564 2920 2864 6570 7265 6361 7465  eted) (deprecate
-0000e990: 642c 2075 7365 2063 6c65 616e 7570 5f74  d, use cleanup_t
-0000e9a0: 746c 2069 6e73 7465 6164 290a 2020 2020  tl instead).    
-0000e9b0: 2020 2020 3a70 6172 616d 2063 6c65 616e      :param clean
-0000e9c0: 7570 5f74 746c 3a20 7069 7065 6c69 6e65  up_ttl: pipeline
-0000e9d0: 2063 6c65 616e 7570 2074 746c 2069 6e20   cleanup ttl in 
-0000e9e0: 7365 6373 2028 7469 6d65 2074 6f20 7761  secs (time to wa
-0000e9f0: 6974 2061 6674 6572 2077 6f72 6b66 6c6f  it after workflo
-0000ea00: 7720 636f 6d70 6c65 7469 6f6e 2c20 6174  w completion, at
-0000ea10: 2077 6869 6368 2070 6f69 6e74 2074 6865   which point the
-0000ea20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ea30: 2020 2020 2020 2020 2020 2020 2077 6f72               wor
-0000ea40: 6b66 6c6f 7720 616e 6420 616c 6c20 6974  kflow and all it
-0000ea50: 7320 7265 736f 7572 6365 7320 6172 6520  s resources are 
-0000ea60: 6465 6c65 7465 6429 0a20 2020 2020 2020  deleted).       
-0000ea70: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-0000ea80: 2074 746c 3a0a 2020 2020 2020 2020 2020   ttl:.          
-0000ea90: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0000eaa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000eab0: 2022 2774 746c 2720 6973 2064 6570 7265   "'ttl' is depre
-0000eac0: 6361 7465 642c 2075 7365 2027 636c 6561  cated, use 'clea
-0000ead0: 6e75 705f 7474 6c27 2069 6e73 7465 6164  nup_ttl' instead
-0000eae0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0000eaf0: 2020 2020 2254 6869 7320 7769 6c6c 2062      "This will b
-0000eb00: 6520 7265 6d6f 7665 6420 696e 2031 2e35  e removed in 1.5
-0000eb10: 2e30 222c 0a20 2020 2020 2020 2020 2020  .0",.           
-0000eb20: 2020 2020 2023 2054 4f44 4f3a 2052 656d       # TODO: Rem
-0000eb30: 6f76 6520 7468 6973 2069 6e20 312e 352e  ove this in 1.5.
-0000eb40: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-0000eb50: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-0000eb60: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000eb70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000eb80: 7461 6e63 6528 7069 7065 6c69 6e65 2c20  tance(pipeline, 
-0000eb90: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-0000eba0: 2020 7069 7065 5f66 696c 6520 3d20 7069    pipe_file = pi
-0000ebb0: 7065 6c69 6e65 0a20 2020 2020 2020 2065  peline.        e
-0000ebc0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000ebd0: 2070 6970 655f 6669 6c65 203d 2074 656d   pipe_file = tem
-0000ebe0: 7066 696c 652e 4e61 6d65 6454 656d 706f  pfile.NamedTempo
-0000ebf0: 7261 7279 4669 6c65 2873 7566 6669 783d  raryFile(suffix=
-0000ec00: 222e 7961 6d6c 222c 2064 656c 6574 653d  ".yaml", delete=
-0000ec10: 4661 6c73 6529 2e6e 616d 650a 2020 2020  False).name.    
-0000ec20: 2020 2020 2020 2020 636f 6e66 203d 206e          conf = n
-0000ec30: 6577 5f70 6970 655f 6d65 7461 6461 7461  ew_pipe_metadata
-0000ec40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000ec50: 2020 6172 7469 6661 6374 5f70 6174 683d    artifact_path=
-0000ec60: 6172 7469 6661 6374 5f70 6174 682c 0a20  artifact_path,. 
-0000ec70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000ec80: 6c65 616e 7570 5f74 746c 3d63 6c65 616e  leanup_ttl=clean
-0000ec90: 7570 5f74 746c 206f 7220 7474 6c2c 0a20  up_ttl or ttl,. 
-0000eca0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0000ecb0: 705f 7472 616e 7366 6f72 6d65 7273 3d6f  p_transformers=o
-0000ecc0: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
-0000ecd0: 290a 2020 2020 2020 2020 2020 2020 6b66  ).            kf
-0000ece0: 702e 636f 6d70 696c 6572 2e43 6f6d 7069  p.compiler.Compi
-0000ecf0: 6c65 7228 292e 636f 6d70 696c 6528 0a20  ler().compile(. 
-0000ed00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000ed10: 6970 656c 696e 652c 2070 6970 655f 6669  ipeline, pipe_fi
-0000ed20: 6c65 2c20 7479 7065 5f63 6865 636b 3d46  le, type_check=F
-0000ed30: 616c 7365 2c20 7069 7065 6c69 6e65 5f63  alse, pipeline_c
-0000ed40: 6f6e 663d 636f 6e66 0a20 2020 2020 2020  onf=conf.       
-0000ed50: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000ed60: 6966 2070 6970 655f 6669 6c65 2e65 6e64  if pipe_file.end
-0000ed70: 7377 6974 6828 222e 7961 6d6c 2229 3a0a  swith(".yaml"):.
-0000ed80: 2020 2020 2020 2020 2020 2020 6865 6164              head
-0000ed90: 6572 7320 3d20 7b22 636f 6e74 656e 742d  ers = {"content-
-0000eda0: 7479 7065 223a 2022 6170 706c 6963 6174  type": "applicat
-0000edb0: 696f 6e2f 7961 6d6c 227d 0a20 2020 2020  ion/yaml"}.     
-0000edc0: 2020 2065 6c69 6620 7069 7065 5f66 696c     elif pipe_fil
-0000edd0: 652e 656e 6473 7769 7468 2822 2e7a 6970  e.endswith(".zip
-0000ede0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-0000edf0: 6865 6164 6572 7320 3d20 7b22 636f 6e74  headers = {"cont
-0000ee00: 656e 742d 7479 7065 223a 2022 6170 706c  ent-type": "appl
-0000ee10: 6963 6174 696f 6e2f 7a69 7022 7d0a 2020  ication/zip"}.  
-0000ee20: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000ee30: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000ee40: 6c75 6545 7272 6f72 2822 7069 7065 6c69  lueError("pipeli
-0000ee50: 6e65 2066 696c 6520 6d75 7374 2062 6520  ne file must be 
-0000ee60: 2e79 616d 6c20 6f72 202e 7a69 7022 290a  .yaml or .zip").
-0000ee70: 2020 2020 2020 2020 6966 2061 7267 756d          if argum
-0000ee80: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-0000ee90: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0000eea0: 6e63 6528 6172 6775 6d65 6e74 732c 2064  nce(arguments, d
-0000eeb0: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
-0000eec0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000eed0: 6545 7272 6f72 2822 6172 6775 6d65 6e74  eError("argument
-0000eee0: 7320 6d75 7374 2062 6520 6469 6374 2074  s must be dict t
-0000eef0: 7970 6522 290a 2020 2020 2020 2020 2020  ype").          
-0000ef00: 2020 6865 6164 6572 735b 6d6c 7275 6e2e    headers[mlrun.
-0000ef10: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-0000ef20: 6561 6465 724e 616d 6573 2e70 6970 656c  eaderNames.pipel
-0000ef30: 696e 655f 6172 6775 6d65 6e74 735d 203d  ine_arguments] =
-0000ef40: 2073 7472 280a 2020 2020 2020 2020 2020   str(.          
-0000ef50: 2020 2020 2020 6172 6775 6d65 6e74 730a        arguments.
-0000ef60: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000ef70: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
-0000ef80: 7468 2e69 7366 696c 6528 7069 7065 5f66  th.isfile(pipe_f
-0000ef90: 696c 6529 3a0a 2020 2020 2020 2020 2020  ile):.          
-0000efa0: 2020 7261 6973 6520 4f53 4572 726f 7228    raise OSError(
-0000efb0: 6622 6669 6c65 207b 7069 7065 5f66 696c  f"file {pipe_fil
-0000efc0: 657d 2064 6f65 736e 7420 6578 6973 7422  e} doesnt exist"
-0000efd0: 290a 2020 2020 2020 2020 7769 7468 206f  ).        with o
-0000efe0: 7065 6e28 7069 7065 5f66 696c 652c 2022  pen(pipe_file, "
-0000eff0: 7262 2229 2061 7320 6670 3a0a 2020 2020  rb") as fp:.    
-0000f000: 2020 2020 2020 2020 6461 7461 203d 2066          data = f
-0000f010: 702e 7265 6164 2829 0a20 2020 2020 2020  p.read().       
-0000f020: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0000f030: 6365 2870 6970 656c 696e 652c 2073 7472  ce(pipeline, str
-0000f040: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000f050: 656d 6f76 6528 7069 7065 5f66 696c 6529  emove(pipe_file)
-0000f060: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
-0000f070: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0000f080: 7320 3d20 7b22 6e61 6d65 7370 6163 6522  s = {"namespace"
-0000f090: 3a20 6e61 6d65 7370 6163 652c 2022 6578  : namespace, "ex
-0000f0a0: 7065 7269 6d65 6e74 223a 2065 7870 6572  periment": exper
-0000f0b0: 696d 656e 742c 2022 7275 6e22 3a20 7275  iment, "run": ru
-0000f0c0: 6e7d 0a20 2020 2020 2020 2020 2020 2072  n}.            r
-0000f0d0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-0000f0e0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0000f0f0: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
-0000f100: 2020 2020 2020 2020 2020 2020 2066 2270               f"p
-0000f110: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-0000f120: 7d2f 7069 7065 6c69 6e65 7322 2c0a 2020  }/pipelines",.  
-0000f130: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0000f140: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-0000f150: 2020 2020 2020 2020 2020 2020 2074 696d               tim
-0000f160: 656f 7574 3d32 302c 0a20 2020 2020 2020  eout=20,.       
-0000f170: 2020 2020 2020 2020 2062 6f64 793d 6461           body=da
-0000f180: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0000f190: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
-0000f1a0: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
-0000f1b0: 2029 0a20 2020 2020 2020 2065 7863 6570   ).        excep
-0000f1c0: 7420 4f53 4572 726f 7220 6173 2065 7272  t OSError as err
-0000f1d0: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0000f1e0: 6767 6572 2e65 7272 6f72 2866 2265 7272  gger.error(f"err
-0000f1f0: 6f72 2063 616e 6e6f 7420 7375 626d 6974  or cannot submit
-0000f200: 2070 6970 656c 696e 653a 207b 6572 725f   pipeline: {err_
-0000f210: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
-0000f220: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000f230: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
-0000f240: 3a20 6361 6e6e 6f74 2063 616e 6e6f 7420  : cannot cannot 
-0000f250: 7375 626d 6974 2070 6970 656c 696e 652c  submit pipeline,
-0000f260: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000f270: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
-0000f280: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
-0000f290: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0000f2a0: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
-0000f2b0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
-0000f2c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000f2d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000f2e0: 6622 6261 6420 7375 626d 6974 2070 6970  f"bad submit pip
-0000f2f0: 656c 696e 6520 7265 7370 6f6e 7365 2c20  eline response, 
-0000f300: 7b72 6573 702e 7465 7874 7d22 290a 0a20  {resp.text}").. 
-0000f310: 2020 2020 2020 2072 6573 7020 3d20 7265         resp = re
-0000f320: 7370 2e6a 736f 6e28 290a 2020 2020 2020  sp.json().      
-0000f330: 2020 6c6f 6767 6572 2e69 6e66 6f28 6622    logger.info(f"
-0000f340: 7375 626d 6974 7465 6420 7069 7065 6c69  submitted pipeli
-0000f350: 6e65 207b 7265 7370 5b27 6e61 6d65 275d  ne {resp['name']
-0000f360: 7d20 6964 3d7b 7265 7370 5b27 6964 275d  } id={resp['id']
-0000f370: 7d22 290a 2020 2020 2020 2020 7265 7475  }").        retu
-0000f380: 726e 2072 6573 705b 2269 6422 5d0a 0a20  rn resp["id"].. 
-0000f390: 2020 2064 6566 206c 6973 745f 7069 7065     def list_pipe
-0000f3a0: 6c69 6e65 7328 0a20 2020 2020 2020 2073  lines(.        s
-0000f3b0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-0000f3c0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-0000f3d0: 2020 206e 616d 6573 7061 6365 3a20 7374     namespace: st
-0000f3e0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-0000f3f0: 2020 736f 7274 5f62 793a 2073 7472 203d    sort_by: str =
-0000f400: 2022 222c 0a20 2020 2020 2020 2070 6167   "",.        pag
-0000f410: 655f 746f 6b65 6e3a 2073 7472 203d 2022  e_token: str = "
-0000f420: 222c 0a20 2020 2020 2020 2066 696c 7465  ",.        filte
-0000f430: 725f 3a20 7374 7220 3d20 2222 2c0a 2020  r_: str = "",.  
-0000f440: 2020 2020 2020 666f 726d 6174 5f3a 2055        format_: U
-0000f450: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-0000f460: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
-0000f470: 6d6f 6e2e 7363 6865 6d61 732e 5069 7065  mon.schemas.Pipe
-0000f480: 6c69 6e65 7346 6f72 6d61 740a 2020 2020  linesFormat.    
-0000f490: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
-0000f4a0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6970  mmon.schemas.Pip
-0000f4b0: 656c 696e 6573 466f 726d 6174 2e6d 6574  elinesFormat.met
-0000f4c0: 6164 6174 615f 6f6e 6c79 2c0a 2020 2020  adata_only,.    
-0000f4d0: 2020 2020 7061 6765 5f73 697a 653a 2069      page_size: i
-0000f4e0: 6e74 203d 204e 6f6e 652c 0a20 2020 2029  nt = None,.    )
-0000f4f0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
-0000f500: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
-0000f510: 6573 4f75 7470 7574 3a0a 2020 2020 2020  esOutput:.      
-0000f520: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
-0000f530: 6c69 7374 206f 6620 4b46 5020 7069 7065  list of KFP pipe
-0000f540: 6c69 6e65 732e 2054 6869 7320 6675 6e63  lines. This func
-0000f550: 7469 6f6e 2063 616e 2062 6520 696e 766f  tion can be invo
-0000f560: 6b65 6420 746f 2067 6574 2061 6c6c 2070  ked to get all p
-0000f570: 6970 656c 696e 6573 2066 726f 6d20 616c  ipelines from al
-0000f580: 6c20 7072 6f6a 6563 7473 2c0a 2020 2020  l projects,.    
-0000f590: 2020 2020 6279 2073 7065 6369 6679 696e      by specifyin
-0000f5a0: 6720 6060 7072 6f6a 6563 743d 2a60 602c  g ``project=*``,
-0000f5b0: 2069 6e20 7768 6963 6820 6361 7365 2070   in which case p
-0000f5c0: 6167 696e 6174 696f 6e20 6361 6e20 6265  agination can be
-0000f5d0: 2075 7365 6420 616e 6420 7468 6520 7661   used and the va
-0000f5e0: 7269 6f75 7320 736f 7274 696e 6720 616e  rious sorting an
-0000f5f0: 6420 7061 6769 6e61 7469 6f6e 0a20 2020  d pagination.   
-0000f600: 2020 2020 2070 726f 7065 7274 6965 7320       properties 
-0000f610: 6361 6e20 6265 2061 7070 6c69 6564 2e20  can be applied. 
-0000f620: 4966 2061 2073 7065 6369 6669 6320 7072  If a specific pr
-0000f630: 6f6a 6563 7420 6973 2072 6571 7565 7374  oject is request
-0000f640: 6564 2c20 7468 656e 2074 6865 2070 6167  ed, then the pag
-0000f650: 696e 6174 696f 6e20 6f70 7469 6f6e 7320  ination options 
-0000f660: 6361 6e6e 6f74 2062 650a 2020 2020 2020  cannot be.      
-0000f670: 2020 7573 6564 2061 6e64 2070 6167 696e    used and pagin
-0000f680: 6174 696f 6e20 6973 206e 6f74 2061 7070  ation is not app
-0000f690: 6c69 6564 2e0a 0a20 2020 2020 2020 203a  lied...        :
-0000f6a0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-0000f6b0: 726f 6a65 6374 206e 616d 652e 2043 616e  roject name. Can
-0000f6c0: 2062 6520 6060 2a60 6020 666f 7220 7175   be ``*`` for qu
-0000f6d0: 6572 7920 6163 726f 7373 2061 6c6c 2070  ery across all p
-0000f6e0: 726f 6a65 6374 732e 0a20 2020 2020 2020  rojects..       
-0000f6f0: 203a 7061 7261 6d20 6e61 6d65 7370 6163   :param namespac
-0000f700: 653a 204b 7562 6572 6e65 7465 7320 6e61  e: Kubernetes na
-0000f710: 6d65 7370 6163 6520 696e 2077 6869 6368  mespace in which
-0000f720: 2074 6865 2070 6970 656c 696e 6573 2061   the pipelines a
-0000f730: 7265 2065 7865 6375 7469 6e67 2e0a 2020  re executing..  
-0000f740: 2020 2020 2020 3a70 6172 616d 2073 6f72        :param sor
-0000f750: 745f 6279 3a20 4669 656c 6420 746f 2073  t_by: Field to s
-0000f760: 6f72 7420 7468 6520 7265 7375 6c74 7320  ort the results 
-0000f770: 6279 2e0a 2020 2020 2020 2020 3a70 6172  by..        :par
-0000f780: 616d 2070 6167 655f 746f 6b65 6e3a 2055  am page_token: U
-0000f790: 7365 2066 6f72 2070 6167 696e 6174 696f  se for paginatio
-0000f7a0: 6e2c 2074 6f20 7265 7472 6965 7665 206e  n, to retrieve n
-0000f7b0: 6578 7420 7061 6765 2e0a 2020 2020 2020  ext page..      
-0000f7c0: 2020 3a70 6172 616d 2066 696c 7465 725f    :param filter_
-0000f7d0: 3a20 4b75 6265 726e 6574 6573 2066 696c  : Kubernetes fil
-0000f7e0: 7465 7220 746f 2061 7070 6c79 2074 6f20  ter to apply to 
-0000f7f0: 7468 6520 7175 6572 792c 2063 616e 2062  the query, can b
-0000f800: 6520 7573 6564 2074 6f20 6669 6c74 6572  e used to filter
-0000f810: 206f 6e20 7370 6563 6966 6963 206f 626a   on specific obj
-0000f820: 6563 7420 6669 656c 6473 2e0a 2020 2020  ect fields..    
-0000f830: 2020 2020 3a70 6172 616d 2066 6f72 6d61      :param forma
-0000f840: 745f 3a20 5265 7375 6c74 2066 6f72 6d61  t_: Result forma
-0000f850: 742e 2043 616e 2062 6520 6f6e 6520 6f66  t. Can be one of
-0000f860: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-0000f870: 2060 6066 756c 6c60 6020 2d20 7265 7475   ``full`` - retu
-0000f880: 726e 2074 6865 2066 756c 6c20 6f62 6a65  rn the full obje
-0000f890: 6374 732e 0a20 2020 2020 2020 2020 2020  cts..           
-0000f8a0: 202d 2060 606d 6574 6164 6174 615f 6f6e   - ``metadata_on
-0000f8b0: 6c79 6060 2028 6465 6661 756c 7429 202d  ly`` (default) -
-0000f8c0: 2072 6574 7572 6e20 6a75 7374 206d 6574   return just met
-0000f8d0: 6164 6174 6120 6f66 2074 6865 2070 6970  adata of the pip
-0000f8e0: 656c 696e 6573 206f 626a 6563 7473 2e0a  elines objects..
-0000f8f0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-0000f900: 6e61 6d65 5f6f 6e6c 7960 6020 2d20 7265  name_only`` - re
-0000f910: 7475 726e 206a 7573 7420 7468 6520 6e61  turn just the na
-0000f920: 6d65 7320 6f66 2074 6865 2070 6970 656c  mes of the pipel
-0000f930: 696e 6520 6f62 6a65 6374 732e 0a20 2020  ine objects..   
-0000f940: 2020 2020 203a 7061 7261 6d20 7061 6765       :param page
-0000f950: 5f73 697a 653a 2053 697a 6520 6f66 2061  _size: Size of a
-0000f960: 2073 696e 676c 6520 7061 6765 2077 6865   single page whe
-0000f970: 6e20 6170 706c 7969 6e67 2070 6167 696e  n applying pagin
-0000f980: 6174 696f 6e2e 0a20 2020 2020 2020 2022  ation..        "
-0000f990: 2222 0a0a 2020 2020 2020 2020 6966 2070  ""..        if p
-0000f9a0: 726f 6a65 6374 2021 3d20 222a 2220 616e  roject != "*" an
-0000f9b0: 6420 2870 6167 655f 746f 6b65 6e20 6f72  d (page_token or
-0000f9c0: 2070 6167 655f 7369 7a65 293a 0a20 2020   page_size):.   
-0000f9d0: 2020 2020 2020 2020 2072 6169 7365 206d           raise m
-0000f9e0: 6c72 756e 2e65 7272 6f72 732e 4d4c 5275  lrun.errors.MLRu
-0000f9f0: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
-0000fa00: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000fa10: 2020 2020 2020 2022 4669 6c74 6572 696e         "Filterin
-0000fa20: 6720 6279 2070 726f 6a65 6374 2063 616e  g by project can
-0000fa30: 206e 6f74 2062 6520 7573 6564 2074 6f67   not be used tog
-0000fa40: 6574 6865 7220 7769 7468 2070 6167 696e  ether with pagin
-0000fa50: 6174 696f 6e22 0a20 2020 2020 2020 2020  ation".         
-0000fa60: 2020 2029 0a20 2020 2020 2020 2070 6172     ).        par
-0000fa70: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0000fa80: 2020 2020 226e 616d 6573 7061 6365 223a      "namespace":
-0000fa90: 206e 616d 6573 7061 6365 2c0a 2020 2020   namespace,.    
-0000faa0: 2020 2020 2020 2020 2273 6f72 745f 6279          "sort_by
-0000fab0: 223a 2073 6f72 745f 6279 2c0a 2020 2020  ": sort_by,.    
-0000fac0: 2020 2020 2020 2020 2270 6167 655f 746f          "page_to
-0000fad0: 6b65 6e22 3a20 7061 6765 5f74 6f6b 656e  ken": page_token
-0000fae0: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-0000faf0: 696c 7465 7222 3a20 6669 6c74 6572 5f2c  ilter": filter_,
-0000fb00: 0a20 2020 2020 2020 2020 2020 2022 666f  .            "fo
-0000fb10: 726d 6174 223a 2066 6f72 6d61 745f 2c0a  rmat": format_,.
-0000fb20: 2020 2020 2020 2020 2020 2020 2270 6167              "pag
-0000fb30: 655f 7369 7a65 223a 2070 6167 655f 7369  e_size": page_si
-0000fb40: 7a65 2c0a 2020 2020 2020 2020 7d0a 0a20  ze,.        }.. 
-0000fb50: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000fb60: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000fb70: 6c69 7374 696e 6720 7069 7065 6c69 6e65  listing pipeline
-0000fb80: 732c 2071 7565 7279 3a20 7b70 6172 616d  s, query: {param
-0000fb90: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
-0000fba0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0000fbb0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0000fbc0: 2020 2247 4554 222c 2066 2270 726f 6a65    "GET", f"proje
-0000fbd0: 6374 732f 7b70 726f 6a65 6374 7d2f 7069  cts/{project}/pi
-0000fbe0: 7065 6c69 6e65 7322 2c20 6572 726f 725f  pelines", error_
-0000fbf0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-0000fc00: 7061 7261 6d73 0a20 2020 2020 2020 2029  params.        )
-0000fc10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fc20: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0000fc30: 656d 6173 2e50 6970 656c 696e 6573 4f75  emas.PipelinesOu
-0000fc40: 7470 7574 282a 2a72 6573 706f 6e73 652e  tput(**response.
-0000fc50: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0000fc60: 2067 6574 5f70 6970 656c 696e 6528 0a20   get_pipeline(. 
-0000fc70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000fc80: 2020 2020 2072 756e 5f69 643a 2073 7472       run_id: str
-0000fc90: 2c0a 2020 2020 2020 2020 6e61 6d65 7370  ,.        namesp
-0000fca0: 6163 653a 2073 7472 203d 204e 6f6e 652c  ace: str = None,
-0000fcb0: 0a20 2020 2020 2020 2074 696d 656f 7574  .        timeout
-0000fcc0: 3a20 696e 7420 3d20 3130 2c0a 2020 2020  : int = 10,.    
-0000fcd0: 2020 2020 666f 726d 6174 5f3a 2055 6e69      format_: Uni
-0000fce0: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-0000fcf0: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
-0000fd00: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
-0000fd10: 6e65 7346 6f72 6d61 740a 2020 2020 2020  nesFormat.      
-0000fd20: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
-0000fd30: 6f6e 2e73 6368 656d 6173 2e50 6970 656c  on.schemas.Pipel
-0000fd40: 696e 6573 466f 726d 6174 2e73 756d 6d61  inesFormat.summa
-0000fd50: 7279 2c0a 2020 2020 2020 2020 7072 6f6a  ry,.        proj
-0000fd60: 6563 743a 2073 7472 203d 204e 6f6e 652c  ect: str = None,
-0000fd70: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000fd80: 2222 2252 6574 7269 6576 6520 6465 7461  """Retrieve deta
-0000fd90: 696c 7320 6f66 2061 2073 7065 6369 6669  ils of a specifi
-0000fda0: 6320 7069 7065 6c69 6e65 2075 7369 6e67  c pipeline using
-0000fdb0: 2069 7473 2072 756e 2049 4420 2861 7320   its run ID (as 
-0000fdc0: 7072 6f76 6964 6564 2077 6865 6e20 7468  provided when th
-0000fdd0: 6520 7069 7065 6c69 6e65 2077 6173 2065  e pipeline was e
-0000fde0: 7865 6375 7465 6429 2e22 2222 0a0a 2020  xecuted)."""..  
-0000fdf0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0000fe00: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-0000fe10: 7b7d 0a20 2020 2020 2020 2020 2020 2069  {}.            i
-0000fe20: 6620 6e61 6d65 7370 6163 653a 0a20 2020  f namespace:.   
-0000fe30: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0000fe40: 616d 735b 226e 616d 6573 7061 6365 225d  ams["namespace"]
-0000fe50: 203d 206e 616d 6573 7061 6365 0a20 2020   = namespace.   
-0000fe60: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-0000fe70: 2266 6f72 6d61 7422 5d20 3d20 666f 726d  "format"] = form
-0000fe80: 6174 5f0a 2020 2020 2020 2020 2020 2020  at_.            
-0000fe90: 7072 6f6a 6563 745f 7061 7468 203d 2070  project_path = p
-0000fea0: 726f 6a65 6374 2069 6620 7072 6f6a 6563  roject if projec
-0000feb0: 7420 656c 7365 2022 2a22 0a20 2020 2020  t else "*".     
-0000fec0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-0000fed0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-0000fee0: 2020 2020 2020 2020 2020 2020 2022 4745               "GE
-0000fef0: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-0000ff00: 2020 2020 6622 7072 6f6a 6563 7473 2f7b      f"projects/{
-0000ff10: 7072 6f6a 6563 745f 7061 7468 7d2f 7069  project_path}/pi
-0000ff20: 7065 6c69 6e65 732f 7b72 756e 5f69 647d  pelines/{run_id}
-0000ff30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0000ff40: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
-0000ff50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000ff60: 2020 7469 6d65 6f75 743d 7469 6d65 6f75    timeout=timeou
-0000ff70: 742c 0a20 2020 2020 2020 2020 2020 2029  t,.            )
-0000ff80: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000ff90: 4f53 4572 726f 7220 6173 2065 7272 3a0a  OSError as err:.
-0000ffa0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000ffb0: 6572 2e65 7272 6f72 2866 2265 7272 6f72  er.error(f"error
-0000ffc0: 2063 616e 6e6f 7420 6765 7420 7069 7065   cannot get pipe
-0000ffd0: 6c69 6e65 3a20 7b65 7272 5f74 6f5f 7374  line: {err_to_st
-0000ffe0: 7228 6572 7229 7d22 290a 2020 2020 2020  r(err)}").      
-0000fff0: 2020 2020 2020 7261 6973 6520 4f53 4572        raise OSEr
-00010000: 726f 7228 6622 6572 726f 723a 2063 616e  ror(f"error: can
-00010010: 6e6f 7420 6765 7420 7069 7065 6c69 6e65  not get pipeline
-00010020: 2c20 7b65 7272 5f74 6f5f 7374 7228 6572  , {err_to_str(er
-00010030: 7229 7d22 290a 0a20 2020 2020 2020 2069  r)}")..        i
-00010040: 6620 6e6f 7420 7265 7370 2e6f 6b3a 0a20  f not resp.ok:. 
-00010050: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-00010060: 722e 6572 726f 7228 6622 6261 6420 7265  r.error(f"bad re
-00010070: 7370 2121 5c6e 7b72 6573 702e 7465 7874  sp!!\n{resp.text
-00010080: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-00010090: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000100a0: 2866 2262 6164 2067 6574 2070 6970 656c  (f"bad get pipel
-000100b0: 696e 6520 7265 7370 6f6e 7365 2c20 7b72  ine response, {r
-000100c0: 6573 702e 7465 7874 7d22 290a 0a20 2020  esp.text}")..   
-000100d0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-000100e0: 2e6a 736f 6e28 290a 0a20 2020 2040 7374  .json()..    @st
-000100f0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-00010100: 6566 205f 7265 736f 6c76 655f 7265 6665  ef _resolve_refe
-00010110: 7265 6e63 6528 7461 672c 2075 6964 293a  rence(tag, uid):
-00010120: 0a20 2020 2020 2020 2069 6620 7569 6420  .        if uid 
-00010130: 616e 6420 7461 673a 0a20 2020 2020 2020  and tag:.       
-00010140: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
-00010150: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
-00010160: 7272 6f72 2822 626f 7468 2075 6964 2061  rror("both uid a
-00010170: 6e64 2074 6167 2077 6572 6520 7072 6f76  nd tag were prov
-00010180: 6964 6564 2229 0a20 2020 2020 2020 2072  ided").        r
-00010190: 6574 7572 6e20 7569 6420 6f72 2074 6167  eturn uid or tag
-000101a0: 206f 7220 226c 6174 6573 7422 0a0a 2020   or "latest"..  
-000101b0: 2020 6465 6620 6372 6561 7465 5f66 6561    def create_fea
-000101c0: 7475 7265 5f73 6574 280a 2020 2020 2020  ture_set(.      
-000101d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000101e0: 6665 6174 7572 655f 7365 743a 2055 6e69  feature_set: Uni
-000101f0: 6f6e 5b64 6963 742c 206d 6c72 756e 2e63  on[dict, mlrun.c
-00010200: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4665  ommon.schemas.Fe
-00010210: 6174 7572 6553 6574 2c20 4665 6174 7572  atureSet, Featur
-00010220: 6553 6574 5d2c 0a20 2020 2020 2020 2070  eSet],.        p
-00010230: 726f 6a65 6374 3d22 222c 0a20 2020 2020  roject="",.     
-00010240: 2020 2076 6572 7369 6f6e 6564 3d54 7275     versioned=Tru
-00010250: 652c 0a20 2020 2029 202d 3e20 6469 6374  e,.    ) -> dict
-00010260: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-00010270: 6174 6520 6120 6e65 7720 3a70 793a 636c  ate a new :py:cl
-00010280: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00010290: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-000102a0: 6553 6574 6020 616e 6420 7361 7665 2069  eSet` and save i
-000102b0: 6e20 7468 6520 3a70 793a 6d6f 643a 606d  n the :py:mod:`m
-000102c0: 6c72 756e 6020 4442 2e20 5468 650a 2020  lrun` DB. The.  
-000102d0: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
-000102e0: 7420 6d75 7374 206e 6f74 2070 7265 7669  t must not previ
-000102f0: 6f75 736c 7920 6578 6973 7420 696e 2074  ously exist in t
-00010300: 6865 2044 422e 0a0a 2020 2020 2020 2020  he DB...        
-00010310: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
-00010320: 6574 3a20 5468 6520 6e65 7720 3a70 793a  et: The new :py:
-00010330: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00010340: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00010350: 7572 6553 6574 6020 746f 2063 7265 6174  ureSet` to creat
-00010360: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00010370: 6d20 7072 6f6a 6563 743a 204e 616d 6520  m project: Name 
-00010380: 6f66 2070 726f 6a65 6374 2074 6869 7320  of project this 
-00010390: 6665 6174 7572 652d 7365 7420 6265 6c6f  feature-set belo
-000103a0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
-000103b0: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
-000103c0: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
-000103d0: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
-000103e0: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
-000103f0: 7365 742e 2041 6c6c 2076 6572 7369 6f6e  set. All version
-00010400: 7320 6f66 2061 2076 6572 7369 6f6e 6564  s of a versioned
-00010410: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
-00010420: 2020 2020 7769 6c6c 2062 6520 6b65 7074      will be kept
-00010430: 2069 6e20 7468 6520 4442 2061 6e64 2063   in the DB and c
-00010440: 616e 2062 6520 7265 7472 6965 7665 6420  an be retrieved 
-00010450: 756e 7469 6c20 6578 706c 6963 6974 6c79  until explicitly
-00010460: 2064 656c 6574 6564 2e0a 2020 2020 2020   deleted..      
-00010470: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
-00010480: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00010490: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
-000104a0: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
-000104b0: 6374 2028 6173 2064 6963 7429 2e0a 2020  ct (as dict)..  
-000104c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000104d0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000104e0: 6665 6174 7572 655f 7365 742c 206d 6c72  feature_set, mlr
-000104f0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00010500: 732e 4665 6174 7572 6553 6574 293a 0a20  s.FeatureSet):. 
-00010510: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00010520: 7265 5f73 6574 203d 2066 6561 7475 7265  re_set = feature
-00010530: 5f73 6574 2e64 6963 7428 290a 2020 2020  _set.dict().    
-00010540: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00010550: 6e63 6528 6665 6174 7572 655f 7365 742c  nce(feature_set,
-00010560: 2046 6561 7475 7265 5365 7429 3a0a 2020   FeatureSet):.  
-00010570: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00010580: 655f 7365 7420 3d20 6665 6174 7572 655f  e_set = feature_
-00010590: 7365 742e 746f 5f64 6963 7428 290a 0a20  set.to_dict().. 
-000105a0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-000105b0: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
-000105c0: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
-000105d0: 2020 206f 7220 6665 6174 7572 655f 7365     or feature_se
-000105e0: 745b 226d 6574 6164 6174 6122 5d2e 6765  t["metadata"].ge
-000105f0: 7428 2270 726f 6a65 6374 222c 204e 6f6e  t("project", Non
-00010600: 6529 0a20 2020 2020 2020 2020 2020 206f  e).            o
-00010610: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00010620: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00010630: 2029 0a20 2020 2020 2020 2070 6174 6820   ).        path 
-00010640: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00010650: 6f6a 6563 747d 2f66 6561 7475 7265 2d73  oject}/feature-s
-00010660: 6574 7322 0a20 2020 2020 2020 2070 6172  ets".        par
-00010670: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
-00010680: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
-00010690: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
-000106a0: 6561 7475 7265 5f73 6574 5b22 6d65 7461  eature_set["meta
-000106b0: 6461 7461 225d 5b22 6e61 6d65 225d 0a20  data"]["name"]. 
-000106c0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000106d0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-000106e0: 6372 6561 7469 6e67 2066 6561 7475 7265  creating feature
-000106f0: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
-00010700: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-00010710: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-00010720: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00010730: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-00010740: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-00010750: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00010760: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-00010770: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-00010780: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
-00010790: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2866  y=dict_to_json(f
-000107a0: 6561 7475 7265 5f73 6574 292c 0a20 2020  eature_set),.   
-000107b0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-000107c0: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
-000107d0: 290a 0a20 2020 2064 6566 2067 6574 5f66  )..    def get_f
-000107e0: 6561 7475 7265 5f73 6574 280a 2020 2020  eature_set(.    
-000107f0: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
-00010800: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
-00010810: 7220 3d20 2222 2c20 7461 673a 2073 7472  r = "", tag: str
-00010820: 203d 204e 6f6e 652c 2075 6964 3a20 7374   = None, uid: st
-00010830: 7220 3d20 4e6f 6e65 0a20 2020 2029 202d  r = None.    ) -
-00010840: 3e20 4665 6174 7572 6553 6574 3a0a 2020  > FeatureSet:.  
-00010850: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
-00010860: 6520 6120 7e6d 6c72 756e 2e66 6561 7475  e a ~mlrun.featu
-00010870: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00010880: 5365 7460 206f 626a 6563 742e 2049 6620  Set` object. If 
-00010890: 626f 7468 2060 6074 6167 6060 2061 6e64  both ``tag`` and
-000108a0: 2060 6075 6964 6060 2061 7265 206e 6f74   ``uid`` are not
-000108b0: 2073 7065 6369 6669 6564 2c20 7468 656e   specified, then
-000108c0: 0a20 2020 2020 2020 2074 6865 206f 626a  .        the obj
-000108d0: 6563 7420 7461 6767 6564 2060 606c 6174  ect tagged ``lat
-000108e0: 6573 7460 6020 7769 6c6c 2062 6520 7265  est`` will be re
-000108f0: 7472 6965 7665 642e 0a0a 2020 2020 2020  trieved...      
-00010900: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
-00010910: 616d 6520 6f66 206f 626a 6563 7420 746f  ame of object to
-00010920: 2072 6574 7269 6576 652e 0a20 2020 2020   retrieve..     
-00010930: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00010940: 743a 2050 726f 6a65 6374 2074 6865 2046  t: Project the F
-00010950: 6561 7475 7265 5365 7420 6265 6c6f 6e67  eatureSet belong
-00010960: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
-00010970: 6172 616d 2074 6167 3a20 5461 6720 6f66  aram tag: Tag of
-00010980: 2074 6865 2073 7065 6369 6669 6320 6f62   the specific ob
-00010990: 6a65 6374 2076 6572 7369 6f6e 2074 6f20  ject version to 
-000109a0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
-000109b0: 2020 3a70 6172 616d 2075 6964 3a20 7569    :param uid: ui
-000109c0: 6420 6f66 2074 6865 206f 626a 6563 7420  d of the object 
-000109d0: 746f 2072 6574 7269 6576 6520 2863 616e  to retrieve (can
-000109e0: 206f 6e6c 7920 6265 2075 7365 6420 666f   only be used fo
-000109f0: 7220 7665 7273 696f 6e65 6420 6f62 6a65  r versioned obje
-00010a00: 6374 7329 2e0a 2020 2020 2020 2020 2222  cts)..        ""
-00010a10: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00010a20: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00010a30: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00010a40: 726f 6a65 6374 0a20 2020 2020 2020 2072  roject.        r
-00010a50: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
-00010a60: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
-00010a70: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
-00010a80: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00010a90: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-00010aa0: 2f66 6561 7475 7265 2d73 6574 732f 7b6e  /feature-sets/{n
-00010ab0: 616d 657d 2f72 6566 6572 656e 6365 732f  ame}/references/
-00010ac0: 7b72 6566 6572 656e 6365 7d22 0a20 2020  {reference}".   
-00010ad0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00010ae0: 6765 203d 2066 2246 6169 6c65 6420 7265  ge = f"Failed re
-00010af0: 7472 6965 7669 6e67 2066 6561 7475 7265  trieving feature
-00010b00: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
-00010b10: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-00010b20: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-00010b30: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
-00010b40: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
-00010b50: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-00010b60: 6561 7475 7265 5365 742e 6672 6f6d 5f64  eatureSet.from_d
-00010b70: 6963 7428 7265 7370 2e6a 736f 6e28 2929  ict(resp.json())
-00010b80: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
-00010b90: 6561 7475 7265 7328 0a20 2020 2020 2020  eatures(.       
-00010ba0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00010bb0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-00010bc0: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
-00010bd0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-00010be0: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c0a  ag: str = None,.
-00010bf0: 2020 2020 2020 2020 656e 7469 7469 6573          entities
-00010c00: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
-00010c10: 6e65 2c0a 2020 2020 2020 2020 6c61 6265  ne,.        labe
-00010c20: 6c73 3a20 4c69 7374 5b73 7472 5d20 3d20  ls: List[str] = 
-00010c30: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 204c  None,.    ) -> L
-00010c40: 6973 745b 6469 6374 5d3a 0a20 2020 2020  ist[dict]:.     
-00010c50: 2020 2022 2222 4c69 7374 2066 6561 7475     """List featu
-00010c60: 7265 2d73 6574 7320 7768 6963 6820 636f  re-sets which co
-00010c70: 6e74 6169 6e20 7370 6563 6966 6963 2066  ntain specific f
-00010c80: 6561 7475 7265 732e 2054 6869 7320 6675  eatures. This fu
-00010c90: 6e63 7469 6f6e 206d 6179 2072 6574 7572  nction may retur
-00010ca0: 6e20 6d75 6c74 6970 6c65 2076 6572 7369  n multiple versi
-00010cb0: 6f6e 7320 6f66 2074 6865 2073 616d 650a  ons of the same.
-00010cc0: 2020 2020 2020 2020 6665 6174 7572 652d          feature-
-00010cd0: 7365 7420 6966 2061 2073 7065 6369 6669  set if a specifi
-00010ce0: 6320 7461 6720 6973 206e 6f74 2072 6571  c tag is not req
-00010cf0: 7565 7374 6564 2e20 4e6f 7465 2074 6861  uested. Note tha
-00010d00: 7420 7468 6520 7661 7269 6f75 7320 6669  t the various fi
-00010d10: 6c74 6572 7320 6f66 2074 6869 7320 6675  lters of this fu
-00010d20: 6e63 7469 6f6e 2061 6374 7561 6c6c 790a  nction actually.
-00010d30: 2020 2020 2020 2020 7265 6665 7220 746f          refer to
-00010d40: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
-00010d50: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
-00010d60: 6e67 2074 6865 2066 6561 7475 7265 732c  ng the features,
-00010d70: 206e 6f74 2074 6f20 7468 6520 6665 6174   not to the feat
-00010d80: 7572 6573 2074 6865 6d73 656c 7665 732e  ures themselves.
-00010d90: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00010da0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-00010db0: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
-00010dc0: 2074 6865 7365 2066 6561 7475 7265 732e   these features.
-00010dd0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00010de0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
-00010df0: 6520 6665 6174 7572 6520 746f 206c 6f6f  e feature to loo
-00010e00: 6b20 666f 722e 2054 6865 206e 616d 6520  k for. The name 
-00010e10: 6973 2075 7365 6420 696e 2061 206c 696b  is used in a lik
-00010e20: 6520 7175 6572 792c 2061 6e64 2069 7320  e query, and is 
-00010e30: 6e6f 7420 6361 7365 2d73 656e 7369 7469  not case-sensiti
-00010e40: 7665 2e20 466f 720a 2020 2020 2020 2020  ve. For.        
-00010e50: 2020 2020 6578 616d 706c 652c 206c 6f6f      example, loo
-00010e60: 6b69 6e67 2066 6f72 2060 6066 6561 7460  king for ``feat`
-00010e70: 6020 7769 6c6c 2072 6574 7572 6e20 6665  ` will return fe
-00010e80: 6174 7572 6573 2077 6869 6368 2061 7265  atures which are
-00010e90: 206e 616d 6564 2060 604d 7946 6561 7475   named ``MyFeatu
-00010ea0: 7265 6060 2061 7320 7765 6c6c 2061 7320  re`` as well as 
-00010eb0: 6060 6465 6665 6174 6060 2e0a 2020 2020  ``defeat``..    
-00010ec0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-00010ed0: 5265 7475 726e 2066 6561 7475 7265 2d73  Return feature-s
-00010ee0: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
-00010ef0: 6e20 7468 6520 6665 6174 7572 6573 206c  n the features l
-00010f00: 6f6f 6b65 6420 666f 722c 2061 6e64 2061  ooked for, and a
-00010f10: 7265 2074 6167 6765 6420 7769 7468 2074  re tagged with t
-00010f20: 6865 2073 7065 6369 6669 6320 7461 672e  he specific tag.
-00010f30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00010f40: 656e 7469 7469 6573 3a20 5265 7475 726e  entities: Return
-00010f50: 206f 6e6c 7920 6665 6174 7572 652d 7365   only feature-se
-00010f60: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
-00010f70: 2061 6e20 656e 7469 7479 2077 686f 7365   an entity whose
-00010f80: 206e 616d 6520 6973 2063 6f6e 7461 696e   name is contain
-00010f90: 6564 2069 6e20 7468 6973 206c 6973 742e  ed in this list.
-00010fa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00010fb0: 6c61 6265 6c73 3a20 5265 7475 726e 206f  labels: Return o
-00010fc0: 6e6c 7920 6665 6174 7572 652d 7365 7473  nly feature-sets
-00010fd0: 2077 6869 6368 2061 7265 206c 6162 656c   which are label
-00010fe0: 6564 2061 7320 7265 7175 6573 7465 642e  ed as requested.
-00010ff0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00011000: 733a 2041 206c 6973 7420 6f66 206d 6170  s: A list of map
-00011010: 7069 6e67 2066 726f 6d20 6665 6174 7572  ping from featur
-00011020: 6520 746f 2061 2064 6967 6573 7420 6f66  e to a digest of
-00011030: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
-00011040: 2c20 7768 6963 6820 636f 6e74 6169 6e73  , which contains
-00011050: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
-00011060: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00011070: 612d 6461 7461 2e20 4d75 6c74 6970 6c65  a-data. Multiple
-00011080: 2065 6e74 7269 6573 206d 6179 2062 6520   entries may be 
-00011090: 7265 7475 726e 6564 2066 6f72 2061 6e79  returned for any
-000110a0: 2073 7065 6369 6669 6320 6665 6174 7572   specific featur
-000110b0: 6520 6475 6520 746f 206d 756c 7469 706c  e due to multipl
-000110c0: 6520 7461 6773 206f 7220 7665 7273 696f  e tags or versio
-000110d0: 6e73 0a20 2020 2020 2020 2020 2020 206f  ns.            o
-000110e0: 6620 7468 6520 6665 6174 7572 652d 7365  f the feature-se
-000110f0: 742e 0a20 2020 2020 2020 2022 2222 0a0a  t..        """..
-00011100: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00011110: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00011120: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00011130: 6563 740a 2020 2020 2020 2020 7061 7261  ect.        para
-00011140: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00011150: 2020 2022 6e61 6d65 223a 206e 616d 652c     "name": name,
-00011160: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
-00011170: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
-00011180: 2020 2020 2022 656e 7469 7479 223a 2065       "entity": e
-00011190: 6e74 6974 6965 7320 6f72 205b 5d2c 0a20  ntities or [],. 
-000111a0: 2020 2020 2020 2020 2020 2022 6c61 6265             "labe
-000111b0: 6c22 3a20 6c61 6265 6c73 206f 7220 5b5d  l": labels or []
-000111c0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-000111d0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000111e0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000111f0: 2f66 6561 7475 7265 7322 0a0a 2020 2020  /features"..    
-00011200: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00011210: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-00011220: 7469 6e67 2066 6561 7475 7265 732c 2070  ting features, p
-00011230: 726f 6a65 6374 3a20 7b70 726f 6a65 6374  roject: {project
-00011240: 7d2c 2071 7565 7279 3a20 7b70 6172 616d  }, query: {param
-00011250: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
-00011260: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011270: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00011280: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00011290: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-000112a0: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-000112b0: 6a73 6f6e 2829 5b22 6665 6174 7572 6573  json()["features
-000112c0: 225d 0a0a 2020 2020 6465 6620 6c69 7374  "]..    def list
-000112d0: 5f65 6e74 6974 6965 7328 0a20 2020 2020  _entities(.     
-000112e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000112f0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-00011300: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
-00011310: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00011320: 2074 6167 3a20 7374 7220 3d20 4e6f 6e65   tag: str = None
-00011330: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
-00011340: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
-00011350: 6e65 2c0a 2020 2020 2920 2d3e 204c 6973  ne,.    ) -> Lis
-00011360: 745b 6469 6374 5d3a 0a20 2020 2020 2020  t[dict]:.       
-00011370: 2022 2222 5265 7472 6965 7665 2061 206c   """Retrieve a l
-00011380: 6973 7420 6f66 2065 6e74 6974 6965 7320  ist of entities 
-00011390: 616e 6420 7468 6569 7220 6d61 7070 696e  and their mappin
-000113a0: 6720 746f 2074 6865 2063 6f6e 7461 696e  g to the contain
-000113b0: 696e 6720 6665 6174 7572 652d 7365 7473  ing feature-sets
-000113c0: 2e20 5468 6973 2066 756e 6374 696f 6e20  . This function 
-000113d0: 6973 2073 696d 696c 6172 0a20 2020 2020  is similar.     
-000113e0: 2020 2074 6f20 7468 6520 3a70 793a 6675     to the :py:fu
-000113f0: 6e63 3a60 7e6c 6973 745f 6665 6174 7572  nc:`~list_featur
-00011400: 6573 6020 6675 6e63 7469 6f6e 2c20 616e  es` function, an
-00011410: 6420 7573 6573 2074 6865 2073 616d 6520  d uses the same 
-00011420: 6c6f 6769 632e 2048 6f77 6576 6572 2c20  logic. However, 
-00011430: 7468 6520 656e 7469 7469 6573 2061 7265  the entities are
-00011440: 206d 6174 6368 6564 0a20 2020 2020 2020   matched.       
-00011450: 2061 6761 696e 7374 2074 6865 206e 616d   against the nam
-00011460: 6520 7261 7468 6572 2074 6861 6e20 7468  e rather than th
-00011470: 6520 6665 6174 7572 6573 2e0a 2020 2020  e features..    
-00011480: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00011490: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-000114a0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-000114b0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-000114c0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-000114d0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-000114e0: 6522 3a20 6e61 6d65 2c0a 2020 2020 2020  e": name,.      
-000114f0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
-00011500: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-00011510: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
-00011520: 205b 5d2c 0a20 2020 2020 2020 207d 0a0a   [],.        }..
-00011530: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00011540: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00011550: 6374 7d2f 656e 7469 7469 6573 220a 0a20  ct}/entities".. 
-00011560: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00011570: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00011580: 6c69 7374 696e 6720 656e 7469 7469 6573  listing entities
-00011590: 2c20 7072 6f6a 6563 743a 207b 7072 6f6a  , project: {proj
-000115a0: 6563 747d 2c20 7175 6572 793a 207b 7061  ect}, query: {pa
-000115b0: 7261 6d73 7d22 0a20 2020 2020 2020 2072  rams}".        r
-000115c0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-000115d0: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
-000115e0: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
-000115f0: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
-00011600: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00011610: 7370 2e6a 736f 6e28 295b 2265 6e74 6974  sp.json()["entit
-00011620: 6965 7322 5d0a 0a20 2020 2040 7374 6174  ies"]..    @stat
-00011630: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-00011640: 205f 6765 6e65 7261 7465 5f70 6172 7469   _generate_parti
-00011650: 7469 6f6e 5f62 795f 7061 7261 6d73 280a  tion_by_params(.
-00011660: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00011670: 6e5f 6279 5f63 6c73 2c0a 2020 2020 2020  n_by_cls,.      
-00011680: 2020 7061 7274 6974 696f 6e5f 6279 2c0a    partition_by,.
-00011690: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
-000116a0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-000116b0: 2020 2020 736f 7274 5f62 792c 0a20 2020      sort_by,.   
-000116c0: 2020 2020 206f 7264 6572 2c0a 2020 2020       order,.    
-000116d0: 2020 2020 6d61 785f 7061 7274 6974 696f      max_partitio
-000116e0: 6e73 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ns=None,.    ):.
-000116f0: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
-00011700: 6f6e 5f70 6172 616d 7320 3d20 7b0a 2020  on_params = {.  
-00011710: 2020 2020 2020 2020 2020 2270 6172 7469            "parti
-00011720: 7469 6f6e 2d62 7922 3a20 7061 7274 6974  tion-by": partit
-00011730: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
-00011740: 2020 2020 2272 6f77 732d 7065 722d 7061      "rows-per-pa
-00011750: 7274 6974 696f 6e22 3a20 726f 7773 5f70  rtition": rows_p
-00011760: 6572 5f70 6172 7469 7469 6f6e 2c0a 2020  er_partition,.  
-00011770: 2020 2020 2020 2020 2020 2270 6172 7469            "parti
-00011780: 7469 6f6e 2d73 6f72 742d 6279 223a 2073  tion-sort-by": s
-00011790: 6f72 745f 6279 2c0a 2020 2020 2020 2020  ort_by,.        
-000117a0: 2020 2020 2270 6172 7469 7469 6f6e 2d6f      "partition-o
-000117b0: 7264 6572 223a 206f 7264 6572 2c0a 2020  rder": order,.  
-000117c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000117d0: 6966 206d 6178 5f70 6172 7469 7469 6f6e  if max_partition
-000117e0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-000117f0: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00011800: 7469 6f6e 5f70 6172 616d 735b 226d 6178  tion_params["max
-00011810: 2d70 6172 7469 7469 6f6e 7322 5d20 3d20  -partitions"] = 
-00011820: 6d61 785f 7061 7274 6974 696f 6e73 0a20  max_partitions. 
-00011830: 2020 2020 2020 2072 6574 7572 6e20 7061         return pa
-00011840: 7274 6974 696f 6e5f 7061 7261 6d73 0a0a  rtition_params..
-00011850: 2020 2020 6465 6620 6c69 7374 5f66 6561      def list_fea
-00011860: 7475 7265 5f73 6574 7328 0a20 2020 2020  ture_sets(.     
-00011870: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011880: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
-00011890: 2222 2c0a 2020 2020 2020 2020 6e61 6d65  "",.        name
-000118a0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-000118b0: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
-000118c0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-000118d0: 7461 7465 3a20 7374 7220 3d20 4e6f 6e65  tate: str = None
-000118e0: 2c0a 2020 2020 2020 2020 656e 7469 7469  ,.        entiti
-000118f0: 6573 3a20 4c69 7374 5b73 7472 5d20 3d20  es: List[str] = 
-00011900: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
-00011910: 6174 7572 6573 3a20 4c69 7374 5b73 7472  atures: List[str
-00011920: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00011930: 2020 6c61 6265 6c73 3a20 4c69 7374 5b73    labels: List[s
-00011940: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00011950: 2020 2020 7061 7274 6974 696f 6e5f 6279      partition_by
-00011960: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
-00011970: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
-00011980: 6e2e 7363 6865 6d61 732e 4665 6174 7572  n.schemas.Featur
-00011990: 6553 746f 7265 5061 7274 6974 696f 6e42  eStorePartitionB
-000119a0: 7946 6965 6c64 2c20 7374 720a 2020 2020  yField, str.    
-000119b0: 2020 2020 5d20 3d20 4e6f 6e65 2c0a 2020      ] = None,.  
-000119c0: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
-000119d0: 6172 7469 7469 6f6e 3a20 696e 7420 3d20  artition: int = 
-000119e0: 312c 0a20 2020 2020 2020 2070 6172 7469  1,.        parti
-000119f0: 7469 6f6e 5f73 6f72 745f 6279 3a20 556e  tion_sort_by: Un
-00011a00: 696f 6e5b 6d6c 7275 6e2e 636f 6d6d 6f6e  ion[mlrun.common
-00011a10: 2e73 6368 656d 6173 2e53 6f72 7446 6965  .schemas.SortFie
-00011a20: 6c64 2c20 7374 725d 203d 204e 6f6e 652c  ld, str] = None,
-00011a30: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
-00011a40: 6f6e 5f6f 7264 6572 3a20 556e 696f 6e5b  on_order: Union[
-00011a50: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
-00011a60: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00011a70: 732e 4f72 6465 7254 7970 652c 2073 7472  s.OrderType, str
-00011a80: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-00011a90: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00011aa0: 732e 4f72 6465 7254 7970 652e 6465 7363  s.OrderType.desc
-00011ab0: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
-00011ac0: 4665 6174 7572 6553 6574 5d3a 0a20 2020  FeatureSet]:.   
-00011ad0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00011ae0: 2061 206c 6973 7420 6f66 2066 6561 7475   a list of featu
-00011af0: 7265 2d73 6574 7320 6d61 7463 6869 6e67  re-sets matching
-00011b00: 2074 6865 2063 7269 7465 7269 6120 7072   the criteria pr
-00011b10: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
-00011b20: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00011b30: 2050 726f 6a65 6374 206e 616d 652e 0a20   Project name.. 
-00011b40: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-00011b50: 6d65 3a20 4e61 6d65 206f 6620 6665 6174  me: Name of feat
-00011b60: 7572 652d 7365 7420 746f 206d 6174 6368  ure-set to match
-00011b70: 2e20 5468 6973 2069 7320 6120 6c69 6b65  . This is a like
-00011b80: 2071 7565 7279 2c20 616e 6420 6973 2063   query, and is c
-00011b90: 6173 652d 696e 7365 6e73 6974 6976 652e  ase-insensitive.
-00011ba0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00011bb0: 7461 673a 204d 6174 6368 2066 6561 7475  tag: Match featu
-00011bc0: 7265 2d73 6574 7320 7769 7468 2073 7065  re-sets with spe
-00011bd0: 6369 6669 6320 7461 672e 0a20 2020 2020  cific tag..     
-00011be0: 2020 203a 7061 7261 6d20 7374 6174 653a     :param state:
-00011bf0: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
-00011c00: 6574 7320 7769 7468 2061 2073 7065 6369  ets with a speci
-00011c10: 6669 6320 7374 6174 652e 0a20 2020 2020  fic state..     
-00011c20: 2020 203a 7061 7261 6d20 656e 7469 7469     :param entiti
-00011c30: 6573 3a20 4d61 7463 6820 6665 6174 7572  es: Match featur
-00011c40: 652d 7365 7473 2077 6869 6368 2063 6f6e  e-sets which con
-00011c50: 7461 696e 2065 6e74 6974 6965 7320 7768  tain entities wh
-00011c60: 6f73 6520 6e61 6d65 2069 7320 696e 2074  ose name is in t
-00011c70: 6869 7320 6c69 7374 2e0a 2020 2020 2020  his list..      
-00011c80: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
-00011c90: 733a 204d 6174 6368 2066 6561 7475 7265  s: Match feature
-00011ca0: 2d73 6574 7320 7768 6963 6820 636f 6e74  -sets which cont
-00011cb0: 6169 6e20 6665 6174 7572 6573 2077 686f  ain features who
-00011cc0: 7365 206e 616d 6520 6973 2069 6e20 7468  se name is in th
-00011cd0: 6973 206c 6973 742e 0a20 2020 2020 2020  is list..       
-00011ce0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
-00011cf0: 4d61 7463 6820 6665 6174 7572 652d 7365  Match feature-se
-00011d00: 7473 2077 6869 6368 2068 6176 6520 7468  ts which have th
-00011d10: 6573 6520 6c61 6265 6c73 2e0a 2020 2020  ese labels..    
-00011d20: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
-00011d30: 7469 6f6e 5f62 793a 2046 6965 6c64 2074  tion_by: Field t
-00011d40: 6f20 6772 6f75 7020 7265 7375 6c74 7320  o group results 
-00011d50: 6279 2e20 4f6e 6c79 2061 6c6c 6f77 6564  by. Only allowed
-00011d60: 2076 616c 7565 2069 7320 606e 616d 6560   value is `name`
-00011d70: 2e20 5768 656e 2060 7061 7274 6974 696f  . When `partitio
-00011d80: 6e5f 6279 6020 6973 2073 7065 6369 6669  n_by` is specifi
-00011d90: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-00011da0: 7468 6520 6070 6172 7469 7469 6f6e 5f73  the `partition_s
-00011db0: 6f72 745f 6279 6020 7061 7261 6d65 7465  ort_by` paramete
-00011dc0: 7220 6d75 7374 2062 6520 7072 6f76 6964  r must be provid
-00011dd0: 6564 2061 7320 7765 6c6c 2e0a 2020 2020  ed as well..    
-00011de0: 2020 2020 3a70 6172 616d 2072 6f77 735f      :param rows_
-00011df0: 7065 725f 7061 7274 6974 696f 6e3a 2048  per_partition: H
-00011e00: 6f77 206d 616e 7920 746f 7020 726f 7773  ow many top rows
-00011e10: 2028 7065 7220 736f 7274 696e 6720 6465   (per sorting de
-00011e20: 6669 6e65 6420 6279 2060 7061 7274 6974  fined by `partit
-00011e30: 696f 6e5f 736f 7274 5f62 7960 2061 6e64  ion_sort_by` and
-00011e40: 2060 7061 7274 6974 696f 6e5f 6f72 6465   `partition_orde
-00011e50: 7260 290a 2020 2020 2020 2020 2020 2020  r`).            
-00011e60: 746f 2072 6574 7572 6e20 7065 7220 6772  to return per gr
-00011e70: 6f75 702e 2044 6566 6175 6c74 2076 616c  oup. Default val
-00011e80: 7565 2069 7320 312e 0a20 2020 2020 2020  ue is 1..       
-00011e90: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-00011ea0: 6e5f 736f 7274 5f62 793a 2057 6861 7420  n_sort_by: What 
-00011eb0: 6669 656c 6420 746f 2073 6f72 7420 7468  field to sort th
-00011ec0: 6520 7265 7375 6c74 7320 6279 2c20 7769  e results by, wi
-00011ed0: 7468 696e 2065 6163 6820 7061 7274 6974  thin each partit
-00011ee0: 696f 6e20 6465 6669 6e65 6420 6279 2060  ion defined by `
-00011ef0: 7061 7274 6974 696f 6e5f 6279 602e 0a20  partition_by`.. 
-00011f00: 2020 2020 2020 2020 2020 2043 7572 7265             Curre
-00011f10: 6e74 6c79 2074 6865 206f 6e6c 7920 616c  ntly the only al
-00011f20: 6c6f 7765 6420 7661 6c75 6520 6172 6520  lowed value are 
-00011f30: 6063 7265 6174 6564 6020 616e 6420 6075  `created` and `u
-00011f40: 7064 6174 6564 602e 0a20 2020 2020 2020  pdated`..       
-00011f50: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-00011f60: 6e5f 6f72 6465 723a 204f 7264 6572 206f  n_order: Order o
-00011f70: 6620 736f 7274 696e 6720 7769 7468 696e  f sorting within
-00011f80: 2070 6172 7469 7469 6f6e 7320 2d20 6061   partitions - `a
-00011f90: 7363 6020 6f72 2060 6465 7363 602e 2044  sc` or `desc`. D
-00011fa0: 6566 6175 6c74 2069 7320 6064 6573 6360  efault is `desc`
-00011fb0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00011fc0: 6e73 3a20 4c69 7374 206f 6620 6d61 7463  ns: List of matc
-00011fd0: 6869 6e67 203a 7079 3a63 6c61 7373 3a60  hing :py:class:`
-00011fe0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00011ff0: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
-00012000: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-00012010: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-00012020: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00012030: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00012040: 6c74 5f70 726f 6a65 6374 0a0a 2020 2020  lt_project..    
-00012050: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00012060: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-00012070: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
-00012080: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
-00012090: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-000120a0: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
-000120b0: 2020 2020 2020 2020 2022 656e 7469 7479           "entity
-000120c0: 223a 2065 6e74 6974 6965 7320 6f72 205b  ": entities or [
-000120d0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-000120e0: 6665 6174 7572 6522 3a20 6665 6174 7572  feature": featur
-000120f0: 6573 206f 7220 5b5d 2c0a 2020 2020 2020  es or [],.      
-00012100: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
-00012110: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
-00012120: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
-00012130: 6620 7061 7274 6974 696f 6e5f 6279 3a0a  f partition_by:.
-00012140: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00012150: 6d73 2e75 7064 6174 6528 0a20 2020 2020  ms.update(.     
-00012160: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012170: 5f67 656e 6572 6174 655f 7061 7274 6974  _generate_partit
-00012180: 696f 6e5f 6279 5f70 6172 616d 7328 0a20  ion_by_params(. 
-00012190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121a0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
-000121b0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-000121c0: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
-000121d0: 6965 6c64 2c0a 2020 2020 2020 2020 2020  ield,.          
-000121e0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-000121f0: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
-00012200: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-00012210: 5f70 6572 5f70 6172 7469 7469 6f6e 2c0a  _per_partition,.
-00012220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012230: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
-00012240: 7274 5f62 792c 0a20 2020 2020 2020 2020  rt_by,.         
-00012250: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00012260: 7469 6f6e 5f6f 7264 6572 2c0a 2020 2020  tion_order,.    
-00012270: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00012280: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00012290: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000122a0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000122b0: 2f66 6561 7475 7265 2d73 6574 7322 0a0a  /feature-sets"..
-000122c0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-000122d0: 7373 6167 6520 3d20 280a 2020 2020 2020  ssage = (.      
-000122e0: 2020 2020 2020 6622 4661 696c 6564 206c        f"Failed l
-000122f0: 6973 7469 6e67 2066 6561 7475 7265 2d73  isting feature-s
-00012300: 6574 732c 2070 726f 6a65 6374 3a20 7b70  ets, project: {p
-00012310: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
-00012320: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
-00012330: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
-00012340: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00012350: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00012360: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00012370: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00012380: 2020 2020 6665 6174 7572 655f 7365 7473      feature_sets
-00012390: 203d 2072 6573 702e 6a73 6f6e 2829 5b22   = resp.json()["
-000123a0: 6665 6174 7572 655f 7365 7473 225d 0a20  feature_sets"]. 
-000123b0: 2020 2020 2020 2069 6620 6665 6174 7572         if featur
-000123c0: 655f 7365 7473 3a0a 2020 2020 2020 2020  e_sets:.        
-000123d0: 2020 2020 7265 7475 726e 205b 4665 6174      return [Feat
-000123e0: 7572 6553 6574 2e66 726f 6d5f 6469 6374  ureSet.from_dict
-000123f0: 286f 626a 2920 666f 7220 6f62 6a20 696e  (obj) for obj in
-00012400: 2066 6561 7475 7265 5f73 6574 735d 0a0a   feature_sets]..
-00012410: 2020 2020 6465 6620 7374 6f72 655f 6665      def store_fe
-00012420: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
-00012430: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00012440: 2066 6561 7475 7265 5f73 6574 3a20 556e   feature_set: Un
-00012450: 696f 6e5b 6469 6374 2c20 6d6c 7275 6e2e  ion[dict, mlrun.
-00012460: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
-00012470: 6561 7475 7265 5365 742c 2046 6561 7475  eatureSet, Featu
-00012480: 7265 5365 745d 2c0a 2020 2020 2020 2020  reSet],.        
-00012490: 6e61 6d65 3d4e 6f6e 652c 0a20 2020 2020  name=None,.     
-000124a0: 2020 2070 726f 6a65 6374 3d22 222c 0a20     project="",. 
-000124b0: 2020 2020 2020 2074 6167 3d4e 6f6e 652c         tag=None,
-000124c0: 0a20 2020 2020 2020 2075 6964 3d4e 6f6e  .        uid=Non
-000124d0: 652c 0a20 2020 2020 2020 2076 6572 7369  e,.        versi
-000124e0: 6f6e 6564 3d54 7275 652c 0a20 2020 2029  oned=True,.    )
-000124f0: 202d 3e20 6469 6374 3a0a 2020 2020 2020   -> dict:.      
-00012500: 2020 2222 2253 6176 6520 6120 3a70 793a    """Save a :py:
-00012510: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00012520: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00012530: 7572 6553 6574 6020 6f62 6a65 6374 2069  ureSet` object i
-00012540: 6e20 7468 6520 3a70 793a 6d6f 643a 606d  n the :py:mod:`m
-00012550: 6c72 756e 6020 4442 2e20 5468 650a 2020  lrun` DB. The.  
-00012560: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
-00012570: 7420 6361 6e20 6265 2065 6974 6865 7220  t can be either 
-00012580: 6120 6e65 7720 6f62 6a65 6374 206f 7220  a new object or 
-00012590: 6120 6d6f 6469 6669 6361 7469 6f6e 2074  a modification t
-000125a0: 6f20 6578 6973 7469 6e67 206f 626a 6563  o existing objec
-000125b0: 7420 7265 6665 7265 6e63 6564 2062 7920  t referenced by 
-000125c0: 7468 6520 7061 7261 6d73 206f 660a 2020  the params of.  
-000125d0: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
-000125e0: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-000125f0: 7261 6d20 6665 6174 7572 655f 7365 743a  ram feature_set:
-00012600: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
-00012610: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00012620: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
-00012630: 2074 6f20 7374 6f72 652e 0a20 2020 2020   to store..     
-00012640: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00012650: 2020 204e 616d 6520 6f66 2066 6561 7475     Name of featu
-00012660: 7265 2073 6574 2e0a 2020 2020 2020 2020  re set..        
-00012670: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00012680: 4e61 6d65 206f 6620 7072 6f6a 6563 7420  Name of project 
-00012690: 7468 6973 2066 6561 7475 7265 2d73 6574  this feature-set
-000126a0: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
-000126b0: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
-000126c0: 2054 6865 2060 6074 6167 6060 206f 6620   The ``tag`` of 
-000126d0: 7468 6520 6f62 6a65 6374 2074 6f20 7265  the object to re
-000126e0: 706c 6163 6520 696e 2074 6865 2044 422c  place in the DB,
-000126f0: 2066 6f72 2065 7861 6d70 6c65 2060 606c   for example ``l
-00012700: 6174 6573 7460 602e 0a20 2020 2020 2020  atest``..       
-00012710: 203a 7061 7261 6d20 7569 643a 2054 6865   :param uid: The
-00012720: 2060 6075 6964 6060 206f 6620 7468 6520   ``uid`` of the 
-00012730: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
-00012740: 6520 696e 2074 6865 2044 422e 2049 6620  e in the DB. If 
-00012750: 7573 696e 6720 7468 6973 2070 6172 616d  using this param
-00012760: 6574 6572 2c20 7468 6520 6d6f 6469 6669  eter, the modifi
-00012770: 6564 206f 626a 6563 740a 2020 2020 2020  ed object.      
-00012780: 2020 2020 2020 6d75 7374 2068 6176 6520        must have 
-00012790: 7468 6520 7361 6d65 2060 6075 6964 6060  the same ``uid``
-000127a0: 206f 6620 7468 6520 7072 6576 696f 7573   of the previous
-000127b0: 6c79 2d65 7869 7374 696e 6720 6f62 6a65  ly-existing obje
-000127c0: 6374 2e20 5468 6973 2063 616e 6e6f 7420  ct. This cannot 
-000127d0: 6265 2075 7365 6420 666f 7220 6e6f 6e2d  be used for non-
-000127e0: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
-000127f0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00012800: 6d20 7665 7273 696f 6e65 643a 2057 6865  m versioned: Whe
-00012810: 7468 6572 2074 6f20 6d61 696e 7461 696e  ther to maintain
-00012820: 2076 6572 7369 6f6e 7320 666f 7220 7468   versions for th
-00012830: 6973 2066 6561 7475 7265 2d73 6574 2e20  is feature-set. 
-00012840: 416c 6c20 7665 7273 696f 6e73 206f 6620  All versions of 
-00012850: 6120 7665 7273 696f 6e65 6420 6f62 6a65  a versioned obje
-00012860: 6374 0a20 2020 2020 2020 2020 2020 2077  ct.            w
-00012870: 696c 6c20 6265 206b 6570 7420 696e 2074  ill be kept in t
-00012880: 6865 2044 4220 616e 6420 6361 6e20 6265  he DB and can be
-00012890: 2072 6574 7269 6576 6564 2075 6e74 696c   retrieved until
-000128a0: 2065 7870 6c69 6369 746c 7920 6465 6c65   explicitly dele
-000128b0: 7465 642e 0a20 2020 2020 2020 203a 7265  ted..        :re
-000128c0: 7475 726e 733a 2054 6865 203a 7079 3a63  turns: The :py:c
-000128d0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
-000128e0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
-000128f0: 7265 5365 7460 206f 626a 6563 7420 2861  reSet` object (a
-00012900: 7320 6469 6374 292e 0a20 2020 2020 2020  s dict)..       
-00012910: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-00012920: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
-00012930: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
-00012940: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
-00012950: 2020 2020 7061 7261 6d73 203d 207b 2276      params = {"v
-00012960: 6572 7369 6f6e 6564 223a 2076 6572 7369  ersioned": versi
-00012970: 6f6e 6564 7d0a 0a20 2020 2020 2020 2069  oned}..        i
-00012980: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-00012990: 7475 7265 5f73 6574 2c20 6d6c 7275 6e2e  ture_set, mlrun.
-000129a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
-000129b0: 6561 7475 7265 5365 7429 3a0a 2020 2020  eatureSet):.    
-000129c0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-000129d0: 7365 7420 3d20 6665 6174 7572 655f 7365  set = feature_se
-000129e0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
-000129f0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00012a00: 2866 6561 7475 7265 5f73 6574 2c20 4665  (feature_set, Fe
-00012a10: 6174 7572 6553 6574 293a 0a20 2020 2020  atureSet):.     
-00012a20: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-00012a30: 6574 203d 2066 6561 7475 7265 5f73 6574  et = feature_set
-00012a40: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
-00012a50: 2020 2020 6e61 6d65 203d 206e 616d 6520      name = name 
-00012a60: 6f72 2066 6561 7475 7265 5f73 6574 5b22  or feature_set["
-00012a70: 6d65 7461 6461 7461 225d 5b22 6e61 6d65  metadata"]["name
-00012a80: 225d 0a20 2020 2020 2020 2070 726f 6a65  "].        proje
-00012a90: 6374 203d 2028 0a20 2020 2020 2020 2020  ct = (.         
-00012aa0: 2020 2070 726f 6a65 6374 206f 7220 6665     project or fe
-00012ab0: 6174 7572 655f 7365 745b 226d 6574 6164  ature_set["metad
-00012ac0: 6174 6122 5d2e 6765 7428 2270 726f 6a65  ata"].get("proje
-00012ad0: 6374 2229 206f 7220 636f 6e66 6967 2e64  ct") or config.d
-00012ae0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-00012af0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012b00: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00012b10: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-00012b20: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
-00012b30: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-00012b40: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
-00012b50: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00012b60: 2066 2246 6169 6c65 6420 7374 6f72 696e   f"Failed storin
-00012b70: 6720 6665 6174 7572 652d 7365 7420 7b70  g feature-set {p
-00012b80: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
-00012b90: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00012ba0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00012bb0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
-00012bc0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-00012bd0: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-00012be0: 616d 732c 2062 6f64 793d 6469 6374 5f74  ams, body=dict_t
-00012bf0: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f73  o_json(feature_s
-00012c00: 6574 290a 2020 2020 2020 2020 290a 2020  et).        ).  
-00012c10: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00012c20: 702e 6a73 6f6e 2829 0a0a 2020 2020 6465  p.json()..    de
-00012c30: 6620 7061 7463 685f 6665 6174 7572 655f  f patch_feature_
-00012c40: 7365 7428 0a20 2020 2020 2020 2073 656c  set(.        sel
-00012c50: 662c 0a20 2020 2020 2020 206e 616d 652c  f,.        name,
-00012c60: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00012c70: 5f73 6574 5f75 7064 6174 653a 2064 6963  _set_update: dic
-00012c80: 742c 0a20 2020 2020 2020 2070 726f 6a65  t,.        proje
-00012c90: 6374 3d22 222c 0a20 2020 2020 2020 2074  ct="",.        t
-00012ca0: 6167 3d4e 6f6e 652c 0a20 2020 2020 2020  ag=None,.       
-00012cb0: 2075 6964 3d4e 6f6e 652c 0a20 2020 2020   uid=None,.     
-00012cc0: 2020 2070 6174 6368 5f6d 6f64 653a 2055     patch_mode: U
-00012cd0: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-00012ce0: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
-00012cf0: 6d6f 6e2e 7363 6865 6d61 732e 5061 7463  mon.schemas.Patc
-00012d00: 684d 6f64 650a 2020 2020 2020 2020 5d20  hMode.        ] 
-00012d10: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00012d20: 6368 656d 6173 2e50 6174 6368 4d6f 6465  chemas.PatchMode
-00012d30: 2e72 6570 6c61 6365 2c0a 2020 2020 293a  .replace,.    ):
-00012d40: 0a20 2020 2020 2020 2022 2222 4d6f 6469  .        """Modi
-00012d50: 6679 2028 7061 7463 6829 2061 6e20 6578  fy (patch) an ex
-00012d60: 6973 7469 6e67 203a 7079 3a63 6c61 7373  isting :py:class
-00012d70: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00012d80: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
-00012d90: 7460 206f 626a 6563 742e 0a20 2020 2020  t` object..     
-00012da0: 2020 2054 6865 206f 626a 6563 7420 6973     The object is
-00012db0: 2069 6465 6e74 6966 6965 6420 6279 2069   identified by i
-00012dc0: 7473 206e 616d 6520 2861 6e64 2070 726f  ts name (and pro
-00012dd0: 6a65 6374 2069 7420 6265 6c6f 6e67 7320  ject it belongs 
-00012de0: 746f 292c 2061 7320 7765 6c6c 2061 7320  to), as well as 
-00012df0: 6f70 7469 6f6e 616c 6c79 2061 2060 6074  optionally a ``t
-00012e00: 6167 6060 206f 7220 6974 730a 2020 2020  ag`` or its.    
-00012e10: 2020 2020 6060 7569 6460 6020 2866 6f72      ``uid`` (for
-00012e20: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
-00012e30: 7429 2e20 4966 2062 6f74 6820 6060 7461  t). If both ``ta
-00012e40: 6760 6020 616e 6420 6060 7569 6460 6020  g`` and ``uid`` 
-00012e50: 6172 6520 6f6d 6974 7465 6420 7468 656e  are omitted then
-00012e60: 2074 6865 206f 626a 6563 7420 7769 7468   the object with
-00012e70: 2074 6167 2060 606c 6174 6573 7460 600a   tag ``latest``.
-00012e80: 2020 2020 2020 2020 6973 206d 6f64 6966          is modif
-00012e90: 6965 642e 0a0a 2020 2020 2020 2020 3a70  ied...        :p
-00012ea0: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
-00012eb0: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
-00012ec0: 2070 6174 6368 2e0a 2020 2020 2020 2020   patch..        
-00012ed0: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
-00012ee0: 6574 5f75 7064 6174 653a 2054 6865 206d  et_update: The m
-00012ef0: 6f64 6966 6963 6174 696f 6e73 206e 6565  odifications nee
-00012f00: 6465 6420 696e 2074 6865 206f 626a 6563  ded in the objec
-00012f10: 742e 2054 6869 7320 7061 7261 6d65 7465  t. This paramete
-00012f20: 7220 6f6e 6c79 2068 6173 2074 6865 2063  r only has the c
-00012f30: 6861 6e67 6573 2069 6e20 6974 2c0a 2020  hanges in it,.  
-00012f40: 2020 2020 2020 2020 2020 6e6f 7420 6120            not a 
-00012f50: 6675 6c6c 206f 626a 6563 742e 0a20 2020  full object..   
-00012f60: 2020 2020 2020 2020 2045 7861 6d70 6c65           Example
-00012f70: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-00012f80: 2020 2020 6665 6174 7572 655f 7365 745f      feature_set_
-00012f90: 7570 6461 7465 203d 207b 2273 7461 7475  update = {"statu
-00012fa0: 7322 3a20 7b22 7072 6f63 6573 7365 6422  s": {"processed"
-00012fb0: 203a 2054 7275 657d 7d0a 0a20 2020 2020   : True}}..     
-00012fc0: 2020 2020 2020 2057 696c 6c20 6170 706c         Will appl
-00012fd0: 7920 7468 6520 6669 656c 6420 6060 7374  y the field ``st
-00012fe0: 6174 7573 2e70 726f 6365 7373 6564 6060  atus.processed``
-00012ff0: 2074 6f20 7468 6520 6578 6973 7469 6e67   to the existing
-00013000: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00013010: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00013020: 2050 726f 6a65 6374 2077 6869 6368 2063   Project which c
-00013030: 6f6e 7461 696e 7320 7468 6520 6d6f 6469  ontains the modi
-00013040: 6669 6564 206f 626a 6563 742e 0a20 2020  fied object..   
-00013050: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
-00013060: 2054 6865 2074 6167 206f 6620 7468 6520   The tag of the 
-00013070: 6f62 6a65 6374 2074 6f20 6d6f 6469 6679  object to modify
-00013080: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00013090: 2075 6964 3a20 7569 6420 6f66 2074 6865   uid: uid of the
-000130a0: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
-000130b0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
-000130c0: 6d20 7061 7463 685f 6d6f 6465 3a20 5468  m patch_mode: Th
-000130d0: 6520 7374 7261 7465 6779 2066 6f72 206d  e strategy for m
-000130e0: 6572 6769 6e67 2074 6865 2063 6861 6e67  erging the chang
-000130f0: 6573 2077 6974 6820 7468 6520 6578 6973  es with the exis
-00013100: 7469 6e67 206f 626a 6563 742e 2043 616e  ting object. Can
-00013110: 2062 6520 6569 7468 6572 2060 6072 6570   be either ``rep
-00013120: 6c61 6365 6060 0a20 2020 2020 2020 2020  lace``.         
-00013130: 2020 206f 7220 6060 6164 6469 7469 7665     or ``additive
-00013140: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
-00013150: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00013160: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00013170: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00013180: 6563 740a 2020 2020 2020 2020 7265 6665  ect.        refe
-00013190: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
-000131a0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-000131b0: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
-000131c0: 2020 6865 6164 6572 7320 3d20 7b6d 6c72    headers = {mlr
-000131d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000131e0: 732e 4865 6164 6572 4e61 6d65 732e 7061  s.HeaderNames.pa
-000131f0: 7463 685f 6d6f 6465 3a20 7061 7463 685f  tch_mode: patch_
-00013200: 6d6f 6465 7d0a 2020 2020 2020 2020 7061  mode}.        pa
-00013210: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00013220: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00013230: 652d 7365 7473 2f7b 6e61 6d65 7d2f 7265  e-sets/{name}/re
-00013240: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
-00013250: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
-00013260: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00013270: 4661 696c 6564 2075 7064 6174 696e 6720  Failed updating 
-00013280: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
-00013290: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
-000132a0: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-000132b0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-000132c0: 2022 5041 5443 4822 2c0a 2020 2020 2020   "PATCH",.      
-000132d0: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
-000132e0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-000132f0: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
-00013300: 2020 2062 6f64 793d 6469 6374 5f74 6f5f     body=dict_to_
-00013310: 6a73 6f6e 2866 6561 7475 7265 5f73 6574  json(feature_set
-00013320: 5f75 7064 6174 6529 2c0a 2020 2020 2020  _update),.      
-00013330: 2020 2020 2020 6865 6164 6572 733d 6865        headers=he
-00013340: 6164 6572 732c 0a20 2020 2020 2020 2029  aders,.        )
-00013350: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
-00013360: 5f66 6561 7475 7265 5f73 6574 2873 656c  _feature_set(sel
-00013370: 662c 206e 616d 652c 2070 726f 6a65 6374  f, name, project
-00013380: 3d22 222c 2074 6167 3d4e 6f6e 652c 2075  ="", tag=None, u
-00013390: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-000133a0: 2020 2222 2244 656c 6574 6520 6120 3a70    """Delete a :p
-000133b0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-000133c0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-000133d0: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
-000133e0: 2066 726f 6d20 7468 6520 4442 2e0a 2020   from the DB..  
-000133f0: 2020 2020 2020 4966 2060 6074 6167 6060        If ``tag``
-00013400: 206f 7220 6060 7569 6460 6020 6172 6520   or ``uid`` are 
-00013410: 7370 6563 6966 6965 642c 2074 6865 6e20  specified, then 
-00013420: 6a75 7374 2074 6865 2076 6572 7369 6f6e  just the version
-00013430: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
-00013440: 6865 6d20 7769 6c6c 2062 6520 6465 6c65  hem will be dele
-00013450: 7465 642e 2055 7369 6e67 2062 6f74 680a  ted. Using both.
-00013460: 2020 2020 2020 2020 6973 206e 6f74 2061          is not a
-00013470: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
-00013480: 4966 206e 6f6e 6520 6172 6520 7370 6563  If none are spec
-00013490: 6966 6965 642c 2074 6865 6e20 616c 6c20  ified, then all 
-000134a0: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-000134b0: 206f 626a 6563 7420 7768 6f73 6520 6e61   object whose na
-000134c0: 6d65 2069 7320 6060 6e61 6d65 6060 2077  me is ``name`` w
-000134d0: 696c 6c20 6265 2064 656c 6574 6564 2e0a  ill be deleted..
-000134e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000134f0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00013500: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00013510: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00013520: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00013530: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00013540: 6374 7d2f 6665 6174 7572 652d 7365 7473  ct}/feature-sets
-00013550: 2f7b 6e61 6d65 7d22 0a0a 2020 2020 2020  /{name}"..      
-00013560: 2020 6966 2074 6167 206f 7220 7569 643a    if tag or uid:
-00013570: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-00013580: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
-00013590: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
-000135a0: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
-000135b0: 2020 2020 2020 2070 6174 6820 3d20 7061         path = pa
-000135c0: 7468 202b 2066 222f 7265 6665 7265 6e63  th + f"/referenc
-000135d0: 6573 2f7b 7265 6665 7265 6e63 657d 220a  es/{reference}".
-000135e0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-000135f0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00013600: 6420 6465 6c65 7469 6e67 2066 6561 7475  d deleting featu
-00013610: 7265 2d73 6574 207b 6e61 6d65 7d22 0a20  re-set {name}". 
-00013620: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00013630: 6361 6c6c 2822 4445 4c45 5445 222c 2070  call("DELETE", p
-00013640: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00013650: 6765 290a 0a20 2020 2064 6566 2063 7265  ge)..    def cre
-00013660: 6174 655f 6665 6174 7572 655f 7665 6374  ate_feature_vect
-00013670: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
-00013680: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
-00013690: 655f 7665 6374 6f72 3a20 556e 696f 6e5b  e_vector: Union[
-000136a0: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
-000136b0: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-000136c0: 7265 5665 6374 6f72 2c20 4665 6174 7572  reVector, Featur
-000136d0: 6556 6563 746f 725d 2c0a 2020 2020 2020  eVector],.      
-000136e0: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
-000136f0: 2020 2020 2020 7665 7273 696f 6e65 643d        versioned=
-00013700: 5472 7565 2c0a 2020 2020 2920 2d3e 2064  True,.    ) -> d
-00013710: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
-00013720: 4372 6561 7465 2061 206e 6577 203a 7079  Create a new :py
-00013730: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-00013740: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00013750: 7475 7265 5665 6374 6f72 6020 616e 6420  tureVector` and 
-00013760: 7361 7665 2069 6e20 7468 6520 3a70 793a  save in the :py:
-00013770: 6d6f 643a 606d 6c72 756e 6020 4442 2e0a  mod:`mlrun` DB..
-00013780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00013790: 6665 6174 7572 655f 7665 6374 6f72 3a20  feature_vector: 
-000137a0: 5468 6520 6e65 7720 3a70 793a 636c 6173  The new :py:clas
-000137b0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-000137c0: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-000137d0: 6563 746f 7260 2074 6f20 6372 6561 7465  ector` to create
-000137e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000137f0: 2070 726f 6a65 6374 3a20 4e61 6d65 206f   project: Name o
-00013800: 6620 7072 6f6a 6563 7420 7468 6973 2066  f project this f
-00013810: 6561 7475 7265 2d76 6563 746f 7220 6265  eature-vector be
-00013820: 6c6f 6e67 7320 746f 2e0a 2020 2020 2020  longs to..      
-00013830: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
-00013840: 6564 3a20 5768 6574 6865 7220 746f 206d  ed: Whether to m
-00013850: 6169 6e74 6169 6e20 7665 7273 696f 6e73  aintain versions
-00013860: 2066 6f72 2074 6869 7320 6665 6174 7572   for this featur
-00013870: 652d 7665 6374 6f72 2e20 416c 6c20 7665  e-vector. All ve
-00013880: 7273 696f 6e73 206f 6620 6120 7665 7273  rsions of a vers
-00013890: 696f 6e65 6420 6f62 6a65 6374 0a20 2020  ioned object.   
-000138a0: 2020 2020 2020 2020 2077 696c 6c20 6265           will be
-000138b0: 206b 6570 7420 696e 2074 6865 2044 4220   kept in the DB 
-000138c0: 616e 6420 6361 6e20 6265 2072 6574 7269  and can be retri
-000138d0: 6576 6564 2075 6e74 696c 2065 7870 6c69  eved until expli
-000138e0: 6369 746c 7920 6465 6c65 7465 642e 0a20  citly deleted.. 
-000138f0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00013900: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
-00013910: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00013920: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
-00013930: 6f72 6020 6f62 6a65 6374 2028 6173 2064  or` object (as d
-00013940: 6963 7429 2e0a 2020 2020 2020 2020 2222  ict)..        ""
-00013950: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-00013960: 6e73 7461 6e63 6528 6665 6174 7572 655f  nstance(feature_
-00013970: 7665 6374 6f72 2c20 6d6c 7275 6e2e 636f  vector, mlrun.co
-00013980: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
-00013990: 7475 7265 5665 6374 6f72 293a 0a20 2020  tureVector):.   
-000139a0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-000139b0: 5f76 6563 746f 7220 3d20 6665 6174 7572  _vector = featur
-000139c0: 655f 7665 6374 6f72 2e64 6963 7428 290a  e_vector.dict().
-000139d0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-000139e0: 6e73 7461 6e63 6528 6665 6174 7572 655f  nstance(feature_
-000139f0: 7665 6374 6f72 2c20 4665 6174 7572 6556  vector, FeatureV
-00013a00: 6563 746f 7229 3a0a 2020 2020 2020 2020  ector):.        
-00013a10: 2020 2020 6665 6174 7572 655f 7665 6374      feature_vect
-00013a20: 6f72 203d 2066 6561 7475 7265 5f76 6563  or = feature_vec
-00013a30: 746f 722e 746f 5f64 6963 7428 290a 0a20  tor.to_dict().. 
-00013a40: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00013a50: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
-00013a60: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
-00013a70: 2020 206f 7220 6665 6174 7572 655f 7665     or feature_ve
-00013a80: 6374 6f72 5b22 6d65 7461 6461 7461 225d  ctor["metadata"]
-00013a90: 2e67 6574 2822 7072 6f6a 6563 7422 2c20  .get("project", 
-00013aa0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-00013ab0: 2020 6f72 2063 6f6e 6669 672e 6465 6661    or config.defa
-00013ac0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-00013ad0: 2020 2020 290a 2020 2020 2020 2020 7061      ).        pa
-00013ae0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00013af0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00013b00: 652d 7665 6374 6f72 7322 0a20 2020 2020  e-vectors".     
-00013b10: 2020 2070 6172 616d 7320 3d20 7b22 7665     params = {"ve
-00013b20: 7273 696f 6e65 6422 3a20 7665 7273 696f  rsioned": versio
-00013b30: 6e65 647d 0a0a 2020 2020 2020 2020 6e61  ned}..        na
-00013b40: 6d65 203d 2066 6561 7475 7265 5f76 6563  me = feature_vec
-00013b50: 746f 725b 226d 6574 6164 6174 6122 5d5b  tor["metadata"][
-00013b60: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
-00013b70: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00013b80: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
-00013b90: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
-00013ba0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00013bb0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-00013bc0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00013bd0: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
-00013be0: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-00013bf0: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-00013c00: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00013c10: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-00013c20: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-00013c30: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
-00013c40: 6374 5f74 6f5f 6a73 6f6e 2866 6561 7475  ct_to_json(featu
-00013c50: 7265 5f76 6563 746f 7229 2c0a 2020 2020  re_vector),.    
-00013c60: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00013c70: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-00013c80: 0a0a 2020 2020 6465 6620 6765 745f 6665  ..    def get_fe
-00013c90: 6174 7572 655f 7665 6374 6f72 280a 2020  ature_vector(.  
-00013ca0: 2020 2020 2020 7365 6c66 2c20 6e61 6d65        self, name
-00013cb0: 3a20 7374 722c 2070 726f 6a65 6374 3a20  : str, project: 
-00013cc0: 7374 7220 3d20 2222 2c20 7461 673a 2073  str = "", tag: s
-00013cd0: 7472 203d 204e 6f6e 652c 2075 6964 3a20  tr = None, uid: 
-00013ce0: 7374 7220 3d20 4e6f 6e65 0a20 2020 2029  str = None.    )
-00013cf0: 202d 3e20 4665 6174 7572 6556 6563 746f   -> FeatureVecto
-00013d00: 723a 0a20 2020 2020 2020 2022 2222 5265  r:.        """Re
-00013d10: 7475 726e 2061 2073 7065 6369 6669 6320  turn a specific 
-00013d20: 6665 6174 7572 652d 7665 6374 6f72 2072  feature-vector r
-00013d30: 6566 6572 656e 6365 6420 6279 2069 7473  eferenced by its
-00013d40: 2074 6167 206f 7220 7569 642e 2049 6620   tag or uid. If 
-00013d50: 6e6f 6e65 2061 7265 2070 726f 7669 6465  none are provide
-00013d60: 642c 2060 606c 6174 6573 7460 6020 7461  d, ``latest`` ta
-00013d70: 6720 7769 6c6c 0a20 2020 2020 2020 2062  g will.        b
-00013d80: 6520 7573 6564 2e22 2222 0a0a 2020 2020  e used."""..    
-00013d90: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00013da0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00013db0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00013dc0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-00013dd0: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
-00013de0: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
-00013df0: 2075 6964 290a 2020 2020 2020 2020 7061   uid).        pa
-00013e00: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00013e10: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00013e20: 652d 7665 6374 6f72 732f 7b6e 616d 657d  e-vectors/{name}
-00013e30: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-00013e40: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
-00013e50: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00013e60: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
-00013e70: 7669 6e67 2066 6561 7475 7265 2d76 6563  ving feature-vec
-00013e80: 746f 7220 7b70 726f 6a65 6374 7d2f 7b6e  tor {project}/{n
-00013e90: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
-00013ea0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-00013eb0: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
-00013ec0: 6572 726f 725f 6d65 7373 6167 6529 0a20  error_message). 
-00013ed0: 2020 2020 2020 2072 6574 7572 6e20 4665         return Fe
-00013ee0: 6174 7572 6556 6563 746f 722e 6672 6f6d  atureVector.from
-00013ef0: 5f64 6963 7428 7265 7370 2e6a 736f 6e28  _dict(resp.json(
-00013f00: 2929 0a0a 2020 2020 6465 6620 6c69 7374  ))..    def list
-00013f10: 5f66 6561 7475 7265 5f76 6563 746f 7273  _feature_vectors
-00013f20: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00013f30: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-00013f40: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
-00013f50: 2020 206e 616d 653a 2073 7472 203d 204e     name: str = N
-00013f60: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
-00013f70: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00013f80: 2020 2020 2020 7374 6174 653a 2073 7472        state: str
-00013f90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00013fa0: 206c 6162 656c 733a 204c 6973 745b 7374   labels: List[st
-00013fb0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-00013fc0: 2020 2070 6172 7469 7469 6f6e 5f62 793a     partition_by:
-00013fd0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00013fe0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
-00013ff0: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
-00014000: 5374 6f72 6550 6172 7469 7469 6f6e 4279  StorePartitionBy
-00014010: 4669 656c 642c 2073 7472 0a20 2020 2020  Field, str.     
-00014020: 2020 205d 203d 204e 6f6e 652c 0a20 2020     ] = None,.   
-00014030: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
-00014040: 7274 6974 696f 6e3a 2069 6e74 203d 2031  rtition: int = 1
-00014050: 2c0a 2020 2020 2020 2020 7061 7274 6974  ,.        partit
-00014060: 696f 6e5f 736f 7274 5f62 793a 2055 6e69  ion_sort_by: Uni
-00014070: 6f6e 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  on[mlrun.common.
-00014080: 7363 6865 6d61 732e 536f 7274 4669 656c  schemas.SortFiel
-00014090: 642c 2073 7472 5d20 3d20 4e6f 6e65 2c0a  d, str] = None,.
-000140a0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-000140b0: 6e5f 6f72 6465 723a 2055 6e69 6f6e 5b0a  n_order: Union[.
-000140c0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
-000140d0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-000140e0: 2e4f 7264 6572 5479 7065 2c20 7374 720a  .OrderType, str.
-000140f0: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
-00014100: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00014110: 2e4f 7264 6572 5479 7065 2e64 6573 632c  .OrderType.desc,
-00014120: 0a20 2020 2029 202d 3e20 4c69 7374 5b46  .    ) -> List[F
-00014130: 6561 7475 7265 5665 6374 6f72 5d3a 0a20  eatureVector]:. 
-00014140: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
-00014150: 7665 2061 206c 6973 7420 6f66 2066 6561  ve a list of fea
-00014160: 7475 7265 2d76 6563 746f 7273 206d 6174  ture-vectors mat
-00014170: 6368 696e 6720 7468 6520 6372 6974 6572  ching the criter
-00014180: 6961 2070 726f 7669 6465 642e 0a0a 2020  ia provided...  
-00014190: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-000141a0: 6a65 6374 3a20 5072 6f6a 6563 7420 6e61  ject: Project na
-000141b0: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
-000141c0: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
-000141d0: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
-000141e0: 746f 206d 6174 6368 2e20 5468 6973 2069  to match. This i
-000141f0: 7320 6120 6c69 6b65 2071 7565 7279 2c20  s a like query, 
-00014200: 616e 6420 6973 2063 6173 652d 696e 7365  and is case-inse
-00014210: 6e73 6974 6976 652e 0a20 2020 2020 2020  nsitive..       
-00014220: 203a 7061 7261 6d20 7461 673a 204d 6174   :param tag: Mat
-00014230: 6368 2066 6561 7475 7265 2d76 6563 746f  ch feature-vecto
-00014240: 7273 2077 6974 6820 7370 6563 6966 6963  rs with specific
-00014250: 2074 6167 2e0a 2020 2020 2020 2020 3a70   tag..        :p
-00014260: 6172 616d 2073 7461 7465 3a20 4d61 7463  aram state: Matc
-00014270: 6820 6665 6174 7572 652d 7665 6374 6f72  h feature-vector
-00014280: 7320 7769 7468 2061 2073 7065 6369 6669  s with a specifi
-00014290: 6320 7374 6174 652e 0a20 2020 2020 2020  c state..       
-000142a0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
-000142b0: 4d61 7463 6820 6665 6174 7572 652d 7665  Match feature-ve
-000142c0: 6374 6f72 7320 7768 6963 6820 6861 7665  ctors which have
-000142d0: 2074 6865 7365 206c 6162 656c 732e 0a20   these labels.. 
-000142e0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
-000142f0: 7274 6974 696f 6e5f 6279 3a20 4669 656c  rtition_by: Fiel
-00014300: 6420 746f 2067 726f 7570 2072 6573 756c  d to group resul
-00014310: 7473 2062 792e 204f 6e6c 7920 616c 6c6f  ts by. Only allo
-00014320: 7765 6420 7661 6c75 6520 6973 2060 6e61  wed value is `na
-00014330: 6d65 602e 2057 6865 6e20 6070 6172 7469  me`. When `parti
-00014340: 7469 6f6e 5f62 7960 2069 7320 7370 6563  tion_by` is spec
-00014350: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
-00014360: 2020 2074 6865 2060 7061 7274 6974 696f     the `partitio
-00014370: 6e5f 736f 7274 5f62 7960 2070 6172 616d  n_sort_by` param
-00014380: 6574 6572 206d 7573 7420 6265 2070 726f  eter must be pro
-00014390: 7669 6465 6420 6173 2077 656c 6c2e 0a20  vided as well.. 
-000143a0: 2020 2020 2020 203a 7061 7261 6d20 726f         :param ro
-000143b0: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
-000143c0: 3a20 486f 7720 6d61 6e79 2074 6f70 2072  : How many top r
-000143d0: 6f77 7320 2870 6572 2073 6f72 7469 6e67  ows (per sorting
-000143e0: 2064 6566 696e 6564 2062 7920 6070 6172   defined by `par
-000143f0: 7469 7469 6f6e 5f73 6f72 745f 6279 6020  tition_sort_by` 
-00014400: 616e 6420 6070 6172 7469 7469 6f6e 5f6f  and `partition_o
-00014410: 7264 6572 6029 0a20 2020 2020 2020 2020  rder`).         
-00014420: 2020 2074 6f20 7265 7475 726e 2070 6572     to return per
-00014430: 2067 726f 7570 2e20 4465 6661 756c 7420   group. Default 
-00014440: 7661 6c75 6520 6973 2031 2e0a 2020 2020  value is 1..    
-00014450: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
-00014460: 7469 6f6e 5f73 6f72 745f 6279 3a20 5768  tion_sort_by: Wh
-00014470: 6174 2066 6965 6c64 2074 6f20 736f 7274  at field to sort
-00014480: 2074 6865 2072 6573 756c 7473 2062 792c   the results by,
-00014490: 2077 6974 6869 6e20 6561 6368 2070 6172   within each par
-000144a0: 7469 7469 6f6e 2064 6566 696e 6564 2062  tition defined b
-000144b0: 7920 6070 6172 7469 7469 6f6e 5f62 7960  y `partition_by`
-000144c0: 2e0a 2020 2020 2020 2020 2020 2020 4375  ..            Cu
-000144d0: 7272 656e 746c 7920 7468 6520 6f6e 6c79  rrently the only
-000144e0: 2061 6c6c 6f77 6564 2076 616c 7565 7320   allowed values 
-000144f0: 6172 6520 6063 7265 6174 6564 6020 616e  are `created` an
-00014500: 6420 6075 7064 6174 6564 602e 0a20 2020  d `updated`..   
-00014510: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
-00014520: 6974 696f 6e5f 6f72 6465 723a 204f 7264  ition_order: Ord
-00014530: 6572 206f 6620 736f 7274 696e 6720 7769  er of sorting wi
-00014540: 7468 696e 2070 6172 7469 7469 6f6e 7320  thin partitions 
-00014550: 2d20 6061 7363 6020 6f72 2060 6465 7363  - `asc` or `desc
-00014560: 602e 2044 6566 6175 6c74 2069 7320 6064  `. Default is `d
-00014570: 6573 6360 2e0a 2020 2020 2020 2020 3a72  esc`..        :r
-00014580: 6574 7572 6e73 3a20 4c69 7374 206f 6620  eturns: List of 
-00014590: 6d61 7463 6869 6e67 203a 7079 3a63 6c61  matching :py:cla
-000145a0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-000145b0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-000145c0: 5665 6374 6f72 6020 6f62 6a65 6374 732e  Vector` objects.
-000145d0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000145e0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-000145f0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00014600: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00014610: 740a 0a20 2020 2020 2020 2070 6172 616d  t..        param
-00014620: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00014630: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
-00014640: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-00014650: 7465 223a 2073 7461 7465 2c0a 2020 2020  te": state,.    
-00014660: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
-00014670: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
-00014680: 226c 6162 656c 223a 206c 6162 656c 7320  "label": labels 
-00014690: 6f72 205b 5d2c 0a20 2020 2020 2020 207d  or [],.        }
-000146a0: 0a20 2020 2020 2020 2069 6620 7061 7274  .        if part
-000146b0: 6974 696f 6e5f 6279 3a0a 2020 2020 2020  ition_by:.      
-000146c0: 2020 2020 2020 7061 7261 6d73 2e75 7064        params.upd
-000146d0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-000146e0: 2020 2020 2073 656c 662e 5f67 656e 6572       self._gener
-000146f0: 6174 655f 7061 7274 6974 696f 6e5f 6279  ate_partition_by
-00014700: 5f70 6172 616d 7328 0a20 2020 2020 2020  _params(.       
-00014710: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
-00014720: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00014730: 732e 4665 6174 7572 6553 746f 7265 5061  s.FeatureStorePa
-00014740: 7274 6974 696f 6e42 7946 6965 6c64 2c0a  rtitionByField,.
-00014750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014760: 2020 2020 7061 7274 6974 696f 6e5f 6279      partition_by
-00014770: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014780: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
-00014790: 6172 7469 7469 6f6e 2c0a 2020 2020 2020  artition,.      
-000147a0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000147b0: 7274 6974 696f 6e5f 736f 7274 5f62 792c  rtition_sort_by,
-000147c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000147d0: 2020 2020 2070 6172 7469 7469 6f6e 5f6f       partition_o
-000147e0: 7264 6572 2c0a 2020 2020 2020 2020 2020  rder,.          
-000147f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00014800: 2020 2020 290a 0a20 2020 2020 2020 2070      )..        p
-00014810: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00014820: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
-00014830: 7265 2d76 6563 746f 7273 220a 0a20 2020  re-vectors"..   
-00014840: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00014850: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
-00014860: 2020 2066 2246 6169 6c65 6420 6c69 7374     f"Failed list
-00014870: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
-00014880: 6f72 732c 2070 726f 6a65 6374 3a20 7b70  ors, project: {p
-00014890: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
-000148a0: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
-000148b0: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
-000148c0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000148d0: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-000148e0: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-000148f0: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00014900: 2020 2020 6665 6174 7572 655f 7665 6374      feature_vect
-00014910: 6f72 7320 3d20 7265 7370 2e6a 736f 6e28  ors = resp.json(
-00014920: 295b 2266 6561 7475 7265 5f76 6563 746f  )["feature_vecto
-00014930: 7273 225d 0a20 2020 2020 2020 2069 6620  rs"].        if 
-00014940: 6665 6174 7572 655f 7665 6374 6f72 733a  feature_vectors:
-00014950: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00014960: 7572 6e20 5b46 6561 7475 7265 5665 6374  urn [FeatureVect
-00014970: 6f72 2e66 726f 6d5f 6469 6374 286f 626a  or.from_dict(obj
-00014980: 2920 666f 7220 6f62 6a20 696e 2066 6561  ) for obj in fea
-00014990: 7475 7265 5f76 6563 746f 7273 5d0a 0a20  ture_vectors].. 
-000149a0: 2020 2064 6566 2073 746f 7265 5f66 6561     def store_fea
-000149b0: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
-000149c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000149d0: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
-000149e0: 723a 2055 6e69 6f6e 5b64 6963 742c 206d  r: Union[dict, m
-000149f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00014a00: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
-00014a10: 722c 2046 6561 7475 7265 5665 6374 6f72  r, FeatureVector
-00014a20: 5d2c 0a20 2020 2020 2020 206e 616d 653d  ],.        name=
-00014a30: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
-00014a40: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
-00014a50: 2020 7461 673d 4e6f 6e65 2c0a 2020 2020    tag=None,.    
-00014a60: 2020 2020 7569 643d 4e6f 6e65 2c0a 2020      uid=None,.  
-00014a70: 2020 2020 2020 7665 7273 696f 6e65 643d        versioned=
-00014a80: 5472 7565 2c0a 2020 2020 2920 2d3e 2064  True,.    ) -> d
-00014a90: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
-00014aa0: 5374 6f72 6520 6120 3a70 793a 636c 6173  Store a :py:clas
-00014ab0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00014ac0: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00014ad0: 6563 746f 7260 206f 626a 6563 7420 696e  ector` object in
-00014ae0: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
-00014af0: 7275 6e60 2044 422e 2054 6865 0a20 2020  run` DB. The.   
-00014b00: 2020 2020 2066 6561 7475 7265 2d76 6563       feature-vec
-00014b10: 746f 7220 6361 6e20 6265 2065 6974 6865  tor can be eithe
-00014b20: 7220 6120 6e65 7720 6f62 6a65 6374 206f  r a new object o
-00014b30: 7220 6120 6d6f 6469 6669 6361 7469 6f6e  r a modification
-00014b40: 2074 6f20 6578 6973 7469 6e67 206f 626a   to existing obj
-00014b50: 6563 7420 7265 6665 7265 6e63 6564 2062  ect referenced b
-00014b60: 7920 7468 6520 7061 7261 6d73 0a20 2020  y the params.   
-00014b70: 2020 2020 206f 6620 7468 6520 6675 6e63       of the func
-00014b80: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
-00014b90: 7061 7261 6d20 6665 6174 7572 655f 7665  param feature_ve
-00014ba0: 6374 6f72 3a20 5468 6520 3a70 793a 636c  ctor: The :py:cl
-00014bb0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00014bc0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-00014bd0: 6556 6563 746f 7260 2074 6f20 7374 6f72  eVector` to stor
-00014be0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00014bf0: 6d20 6e61 6d65 3a20 2020 204e 616d 6520  m name:    Name 
-00014c00: 6f66 2066 6561 7475 7265 2076 6563 746f  of feature vecto
-00014c10: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-00014c20: 6d20 7072 6f6a 6563 743a 204e 616d 6520  m project: Name 
-00014c30: 6f66 2070 726f 6a65 6374 2074 6869 7320  of project this 
-00014c40: 6665 6174 7572 652d 7665 6374 6f72 2062  feature-vector b
-00014c50: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
-00014c60: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
-00014c70: 6865 2060 6074 6167 6060 206f 6620 7468  he ``tag`` of th
-00014c80: 6520 6f62 6a65 6374 2074 6f20 7265 706c  e object to repl
-00014c90: 6163 6520 696e 2074 6865 2044 422c 2066  ace in the DB, f
-00014ca0: 6f72 2065 7861 6d70 6c65 2060 606c 6174  or example ``lat
-00014cb0: 6573 7460 602e 0a20 2020 2020 2020 203a  est``..        :
-00014cc0: 7061 7261 6d20 7569 643a 2054 6865 2060  param uid: The `
-00014cd0: 6075 6964 6060 206f 6620 7468 6520 6f62  `uid`` of the ob
-00014ce0: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
-00014cf0: 696e 2074 6865 2044 422e 2049 6620 7573  in the DB. If us
-00014d00: 696e 6720 7468 6973 2070 6172 616d 6574  ing this paramet
-00014d10: 6572 2c20 7468 6520 6d6f 6469 6669 6564  er, the modified
-00014d20: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
-00014d30: 2020 2020 6d75 7374 2068 6176 6520 7468      must have th
-00014d40: 6520 7361 6d65 2060 6075 6964 6060 206f  e same ``uid`` o
-00014d50: 6620 7468 6520 7072 6576 696f 7573 6c79  f the previously
-00014d60: 2d65 7869 7374 696e 6720 6f62 6a65 6374  -existing object
-00014d70: 2e20 5468 6973 2063 616e 6e6f 7420 6265  . This cannot be
-00014d80: 2075 7365 6420 666f 7220 6e6f 6e2d 7665   used for non-ve
-00014d90: 7273 696f 6e65 6420 6f62 6a65 6374 732e  rsioned objects.
-00014da0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00014db0: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
-00014dc0: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
-00014dd0: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
-00014de0: 2066 6561 7475 7265 2d76 6563 746f 722e   feature-vector.
-00014df0: 2041 6c6c 2076 6572 7369 6f6e 7320 6f66   All versions of
-00014e00: 2061 2076 6572 7369 6f6e 6564 206f 626a   a versioned obj
-00014e10: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00014e20: 7769 6c6c 2062 6520 6b65 7074 2069 6e20  will be kept in 
-00014e30: 7468 6520 4442 2061 6e64 2063 616e 2062  the DB and can b
-00014e40: 6520 7265 7472 6965 7665 6420 756e 7469  e retrieved unti
-00014e50: 6c20 6578 706c 6963 6974 6c79 2064 656c  l explicitly del
-00014e60: 6574 6564 2e0a 2020 2020 2020 2020 3a72  eted..        :r
-00014e70: 6574 7572 6e73 3a20 5468 6520 3a70 793a  eturns: The :py:
-00014e80: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00014e90: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00014ea0: 7572 6556 6563 746f 7260 206f 626a 6563  ureVector` objec
-00014eb0: 7420 2861 7320 6469 6374 292e 0a20 2020  t (as dict)..   
-00014ec0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00014ed0: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
-00014ee0: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
-00014ef0: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
-00014f00: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00014f10: 207b 2276 6572 7369 6f6e 6564 223a 2076   {"versioned": v
-00014f20: 6572 7369 6f6e 6564 7d0a 0a20 2020 2020  ersioned}..     
-00014f30: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00014f40: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
-00014f50: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00014f60: 6865 6d61 732e 4665 6174 7572 6556 6563  hemas.FeatureVec
-00014f70: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
-00014f80: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
-00014f90: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
-00014fa0: 722e 6469 6374 2829 0a20 2020 2020 2020  r.dict().       
-00014fb0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00014fc0: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
-00014fd0: 2046 6561 7475 7265 5665 6374 6f72 293a   FeatureVector):
-00014fe0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
-00014ff0: 7475 7265 5f76 6563 746f 7220 3d20 6665  ture_vector = fe
-00015000: 6174 7572 655f 7665 6374 6f72 2e74 6f5f  ature_vector.to_
-00015010: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
-00015020: 6e61 6d65 203d 206e 616d 6520 6f72 2066  name = name or f
-00015030: 6561 7475 7265 5f76 6563 746f 725b 226d  eature_vector["m
-00015040: 6574 6164 6174 6122 5d5b 226e 616d 6522  etadata"]["name"
-00015050: 5d0a 2020 2020 2020 2020 7072 6f6a 6563  ].        projec
-00015060: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
-00015070: 2020 7072 6f6a 6563 740a 2020 2020 2020    project.      
-00015080: 2020 2020 2020 6f72 2066 6561 7475 7265        or feature
-00015090: 5f76 6563 746f 725b 226d 6574 6164 6174  _vector["metadat
-000150a0: 6122 5d2e 6765 7428 2270 726f 6a65 6374  a"].get("project
-000150b0: 2229 0a20 2020 2020 2020 2020 2020 206f  ").            o
-000150c0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-000150d0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-000150e0: 2029 0a20 2020 2020 2020 2070 6174 6820   ).        path 
-000150f0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00015100: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
-00015110: 6563 746f 7273 2f7b 6e61 6d65 7d2f 7265  ectors/{name}/re
-00015120: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
-00015130: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
-00015140: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00015150: 4661 696c 6564 2073 746f 7269 6e67 2066  Failed storing f
-00015160: 6561 7475 7265 2d76 6563 746f 7220 7b70  eature-vector {p
-00015170: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
-00015180: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00015190: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-000151a0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
-000151b0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-000151c0: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-000151d0: 616d 732c 2062 6f64 793d 6469 6374 5f74  ams, body=dict_t
-000151e0: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f76  o_json(feature_v
-000151f0: 6563 746f 7229 0a20 2020 2020 2020 2029  ector).        )
-00015200: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00015210: 7265 7370 2e6a 736f 6e28 290a 0a20 2020  resp.json()..   
-00015220: 2064 6566 2070 6174 6368 5f66 6561 7475   def patch_featu
-00015230: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
-00015240: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00015250: 206e 616d 652c 0a20 2020 2020 2020 2066   name,.        f
-00015260: 6561 7475 7265 5f76 6563 746f 725f 7570  eature_vector_up
-00015270: 6461 7465 3a20 6469 6374 2c0a 2020 2020  date: dict,.    
-00015280: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
-00015290: 2020 2020 2020 2020 7461 673d 4e6f 6e65          tag=None
-000152a0: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
-000152b0: 6e65 2c0a 2020 2020 2020 2020 7061 7463  ne,.        patc
-000152c0: 685f 6d6f 6465 3a20 556e 696f 6e5b 0a20  h_mode: Union[. 
-000152d0: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-000152e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000152f0: 656d 6173 2e50 6174 6368 4d6f 6465 0a20  emas.PatchMode. 
-00015300: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-00015310: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00015320: 5061 7463 684d 6f64 652e 7265 706c 6163  PatchMode.replac
-00015330: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00015340: 2020 2222 224d 6f64 6966 7920 2870 6174    """Modify (pat
-00015350: 6368 2920 616e 2065 7869 7374 696e 6720  ch) an existing 
-00015360: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00015370: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
-00015380: 4665 6174 7572 6556 6563 746f 7260 206f  FeatureVector` o
-00015390: 626a 6563 742e 0a20 2020 2020 2020 2054  bject..        T
-000153a0: 6865 206f 626a 6563 7420 6973 2069 6465  he object is ide
-000153b0: 6e74 6966 6965 6420 6279 2069 7473 206e  ntified by its n
-000153c0: 616d 6520 2861 6e64 2070 726f 6a65 6374  ame (and project
-000153d0: 2069 7420 6265 6c6f 6e67 7320 746f 292c   it belongs to),
-000153e0: 2061 7320 7765 6c6c 2061 7320 6f70 7469   as well as opti
-000153f0: 6f6e 616c 6c79 2061 2060 6074 6167 6060  onally a ``tag``
-00015400: 206f 7220 6974 730a 2020 2020 2020 2020   or its.        
-00015410: 6060 7569 6460 6020 2866 6f72 2076 6572  ``uid`` (for ver
-00015420: 7369 6f6e 6564 206f 626a 6563 7429 2e20  sioned object). 
-00015430: 4966 2062 6f74 6820 6060 7461 6760 6020  If both ``tag`` 
-00015440: 616e 6420 6060 7569 6460 6020 6172 6520  and ``uid`` are 
-00015450: 6f6d 6974 7465 6420 7468 656e 2074 6865  omitted then the
-00015460: 206f 626a 6563 7420 7769 7468 2074 6167   object with tag
-00015470: 2060 606c 6174 6573 7460 600a 2020 2020   ``latest``.    
-00015480: 2020 2020 6973 206d 6f64 6966 6965 642e      is modified.
-00015490: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000154a0: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
-000154b0: 6865 206f 626a 6563 7420 746f 2070 6174  he object to pat
-000154c0: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
-000154d0: 616d 2066 6561 7475 7265 5f76 6563 746f  am feature_vecto
-000154e0: 725f 7570 6461 7465 3a20 5468 6520 6d6f  r_update: The mo
-000154f0: 6469 6669 6361 7469 6f6e 7320 6e65 6564  difications need
-00015500: 6564 2069 6e20 7468 6520 6f62 6a65 6374  ed in the object
-00015510: 2e20 5468 6973 2070 6172 616d 6574 6572  . This parameter
-00015520: 206f 6e6c 7920 6861 7320 7468 6520 6368   only has the ch
-00015530: 616e 6765 7320 696e 2069 742c 0a20 2020  anges in it,.   
-00015540: 2020 2020 2020 2020 206e 6f74 2061 2066           not a f
-00015550: 756c 6c20 6f62 6a65 6374 2e0a 2020 2020  ull object..    
-00015560: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00015570: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-00015580: 6820 636f 6e74 6169 6e73 2074 6865 206d  h contains the m
-00015590: 6f64 6966 6965 6420 6f62 6a65 6374 2e0a  odified object..
-000155a0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-000155b0: 6167 3a20 5468 6520 7461 6720 6f66 2074  ag: The tag of t
-000155c0: 6865 206f 626a 6563 7420 746f 206d 6f64  he object to mod
-000155d0: 6966 792e 0a20 2020 2020 2020 203a 7061  ify..        :pa
-000155e0: 7261 6d20 7569 643a 2075 6964 206f 6620  ram uid: uid of 
-000155f0: 7468 6520 6f62 6a65 6374 2074 6f20 6d6f  the object to mo
-00015600: 6469 6679 2e0a 2020 2020 2020 2020 3a70  dify..        :p
-00015610: 6172 616d 2070 6174 6368 5f6d 6f64 653a  aram patch_mode:
-00015620: 2054 6865 2073 7472 6174 6567 7920 666f   The strategy fo
-00015630: 7220 6d65 7267 696e 6720 7468 6520 6368  r merging the ch
-00015640: 616e 6765 7320 7769 7468 2074 6865 2065  anges with the e
-00015650: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
-00015660: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
-00015670: 7265 706c 6163 6560 600a 2020 2020 2020  replace``.      
-00015680: 2020 2020 2020 6f72 2060 6061 6464 6974        or ``addit
-00015690: 6976 6560 602e 0a20 2020 2020 2020 2022  ive``..        "
-000156a0: 2222 0a20 2020 2020 2020 2072 6566 6572  "".        refer
-000156b0: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
-000156c0: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
-000156d0: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
-000156e0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-000156f0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00015700: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00015710: 2020 2020 2068 6561 6465 7273 203d 207b       headers = {
-00015720: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00015730: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
-00015740: 2e70 6174 6368 5f6d 6f64 653a 2070 6174  .patch_mode: pat
-00015750: 6368 5f6d 6f64 657d 0a20 2020 2020 2020  ch_mode}.       
-00015760: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00015770: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-00015780: 7475 7265 2d76 6563 746f 7273 2f7b 6e61  ture-vectors/{na
-00015790: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
-000157a0: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
-000157b0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000157c0: 6520 3d20 6622 4661 696c 6564 2075 7064  e = f"Failed upd
-000157d0: 6174 696e 6720 6665 6174 7572 652d 7665  ating feature-ve
-000157e0: 6374 6f72 207b 7072 6f6a 6563 747d 2f7b  ctor {project}/{
-000157f0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-00015800: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00015810: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
-00015820: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00015830: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00015840: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00015850: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00015860: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
-00015870: 6174 7572 655f 7665 6374 6f72 5f75 7064  ature_vector_upd
-00015880: 6174 6529 2c0a 2020 2020 2020 2020 2020  ate),.          
-00015890: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
-000158a0: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-000158b0: 2020 6465 6620 6465 6c65 7465 5f66 6561    def delete_fea
-000158c0: 7475 7265 5f76 6563 746f 7228 7365 6c66  ture_vector(self
-000158d0: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
-000158e0: 2222 2c20 7461 673d 4e6f 6e65 2c20 7569  "", tag=None, ui
-000158f0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
-00015900: 2022 2222 4465 6c65 7465 2061 203a 7079   """Delete a :py
-00015910: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-00015920: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00015930: 7475 7265 5665 6374 6f72 6020 6f62 6a65  tureVector` obje
-00015940: 6374 2066 726f 6d20 7468 6520 4442 2e0a  ct from the DB..
-00015950: 2020 2020 2020 2020 4966 2060 6074 6167          If ``tag
-00015960: 6060 206f 7220 6060 7569 6460 6020 6172  `` or ``uid`` ar
-00015970: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
-00015980: 6e20 6a75 7374 2074 6865 2076 6572 7369  n just the versi
-00015990: 6f6e 2072 6566 6572 656e 6365 6420 6279  on referenced by
-000159a0: 2074 6865 6d20 7769 6c6c 2062 6520 6465   them will be de
-000159b0: 6c65 7465 642e 2055 7369 6e67 2062 6f74  leted. Using bot
-000159c0: 680a 2020 2020 2020 2020 6973 206e 6f74  h.        is not
-000159d0: 2061 6c6c 6f77 6564 2e0a 2020 2020 2020   allowed..      
-000159e0: 2020 4966 206e 6f6e 6520 6172 6520 7370    If none are sp
-000159f0: 6563 6966 6965 642c 2074 6865 6e20 616c  ecified, then al
-00015a00: 6c20 696e 7374 616e 6365 7320 6f66 2074  l instances of t
-00015a10: 6865 206f 626a 6563 7420 7768 6f73 6520  he object whose 
-00015a20: 6e61 6d65 2069 7320 6060 6e61 6d65 6060  name is ``name``
-00015a30: 2077 696c 6c20 6265 2064 656c 6574 6564   will be deleted
-00015a40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00015a50: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00015a60: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00015a70: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00015a80: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
-00015a90: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00015aa0: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
-00015ab0: 6374 6f72 732f 7b6e 616d 657d 220a 2020  ctors/{name}".  
-00015ac0: 2020 2020 2020 6966 2074 6167 206f 7220        if tag or 
-00015ad0: 7569 643a 0a20 2020 2020 2020 2020 2020  uid:.           
-00015ae0: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
-00015af0: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
-00015b00: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
-00015b10: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-00015b20: 3d20 7061 7468 202b 2066 222f 7265 6665  = path + f"/refe
-00015b30: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
-00015b40: 657d 220a 0a20 2020 2020 2020 2065 7272  e}"..        err
-00015b50: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00015b60: 6169 6c65 6420 6465 6c65 7469 6e67 2066  ailed deleting f
-00015b70: 6561 7475 7265 2d76 6563 746f 7220 7b6e  eature-vector {n
-00015b80: 616d 657d 220a 2020 2020 2020 2020 7365  ame}".        se
-00015b90: 6c66 2e61 7069 5f63 616c 6c28 2244 454c  lf.api_call("DEL
-00015ba0: 4554 4522 2c20 7061 7468 2c20 6572 726f  ETE", path, erro
-00015bb0: 725f 6d65 7373 6167 6529 0a0a 2020 2020  r_message)..    
-00015bc0: 6465 6620 7461 675f 6f62 6a65 6374 7328  def tag_objects(
-00015bd0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00015be0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-00015bf0: 7374 722c 0a20 2020 2020 2020 2074 6167  str,.        tag
-00015c00: 5f6e 616d 653a 2073 7472 2c0a 2020 2020  _name: str,.    
-00015c10: 2020 2020 6f62 6a65 6374 733a 2055 6e69      objects: Uni
-00015c20: 6f6e 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  on[mlrun.common.
-00015c30: 7363 6865 6d61 732e 5461 674f 626a 6563  schemas.TagObjec
-00015c40: 7473 2c20 6469 6374 5d2c 0a20 2020 2020  ts, dict],.     
-00015c50: 2020 2072 6570 6c61 6365 3a20 626f 6f6c     replace: bool
-00015c60: 203d 2046 616c 7365 2c0a 2020 2020 293a   = False,.    ):
-00015c70: 0a20 2020 2020 2020 2022 2222 5461 6720  .        """Tag 
-00015c80: 6120 6c69 7374 206f 6620 6f62 6a65 6374  a list of object
-00015c90: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-00015ca0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-00015cb0: 6563 7420 7768 6963 6820 636f 6e74 6169  ect which contai
-00015cc0: 6e73 2074 6865 206f 626a 6563 7473 2e0a  ns the objects..
-00015cd0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-00015ce0: 6167 5f6e 616d 653a 2054 6865 2074 6167  ag_name: The tag
-00015cf0: 2074 6f20 7365 7420 6f6e 2074 6865 206f   to set on the o
-00015d00: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00015d10: 3a70 6172 616d 206f 626a 6563 7473 3a20  :param objects: 
-00015d20: 5468 6520 6f62 6a65 6374 7320 746f 2074  The objects to t
-00015d30: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
-00015d40: 616d 2072 6570 6c61 6365 3a20 5768 6574  am replace: Whet
-00015d50: 6865 7220 746f 2072 6570 6c61 6365 2074  her to replace t
-00015d60: 6865 2065 7869 7374 696e 6720 7461 6773  he existing tags
-00015d70: 206f 6620 7468 6520 6f62 6a65 6374 7320   of the objects 
-00015d80: 6f72 2074 6f20 6164 6420 7468 6520 6e65  or to add the ne
-00015d90: 7720 7461 6720 746f 2074 6865 6d2e 0a20  w tag to them.. 
-00015da0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00015db0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00015dc0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00015dd0: 7461 6773 2f7b 7461 675f 6e61 6d65 7d22  tags/{tag_name}"
-00015de0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00015df0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00015e00: 6420 746f 2074 6167 207b 7461 675f 6e61  d to tag {tag_na
-00015e10: 6d65 7d20 6f6e 206f 626a 6563 7473 207b  me} on objects {
-00015e20: 6f62 6a65 6374 737d 220a 2020 2020 2020  objects}".      
-00015e30: 2020 6d65 7468 6f64 203d 2022 504f 5354    method = "POST
-00015e40: 2220 6966 2072 6570 6c61 6365 2065 6c73  " if replace els
-00015e50: 6520 2250 5554 220a 2020 2020 2020 2020  e "PUT".        
-00015e60: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-00015e70: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-00015e80: 642c 0a20 2020 2020 2020 2020 2020 2070  d,.            p
-00015e90: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00015ea0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00015eb0: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00015ec0: 3d64 6963 745f 746f 5f6a 736f 6e28 0a20  =dict_to_json(. 
-00015ed0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00015ee0: 626a 6563 7473 2e64 6963 7428 290a 2020  bjects.dict().  
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00015f00: 2069 7369 6e73 7461 6e63 6528 6f62 6a65   isinstance(obje
-00015f10: 6374 732c 206d 6c72 756e 2e63 6f6d 6d6f  cts, mlrun.commo
-00015f20: 6e2e 7363 6865 6d61 732e 5461 674f 626a  n.schemas.TagObj
-00015f30: 6563 7473 290a 2020 2020 2020 2020 2020  ects).          
-00015f40: 2020 2020 2020 656c 7365 206f 626a 6563        else objec
-00015f50: 7473 0a20 2020 2020 2020 2020 2020 2029  ts.            )
-00015f60: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00015f70: 2064 6566 2064 656c 6574 655f 6f62 6a65   def delete_obje
-00015f80: 6374 735f 7461 6728 0a20 2020 2020 2020  cts_tag(.       
-00015f90: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00015fa0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-00015fb0: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
-00015fc0: 7472 2c0a 2020 2020 2020 2020 7461 675f  tr,.        tag_
-00015fd0: 6f62 6a65 6374 733a 2055 6e69 6f6e 5b6d  objects: Union[m
-00015fe0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00015ff0: 6d61 732e 5461 674f 626a 6563 7473 2c20  mas.TagObjects, 
-00016000: 6469 6374 5d2c 0a20 2020 2029 3a0a 2020  dict],.    ):.  
-00016010: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
-00016020: 6120 7461 6720 6672 6f6d 2061 206c 6973  a tag from a lis
-00016030: 7420 6f66 206f 626a 6563 7473 2e0a 0a20  t of objects... 
-00016040: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00016050: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
-00016060: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00016070: 6520 6f62 6a65 6374 732e 0a20 2020 2020  e objects..     
-00016080: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
-00016090: 6d65 3a20 5468 6520 7461 6720 746f 2064  me: The tag to d
-000160a0: 656c 6574 6520 6672 6f6d 2074 6865 206f  elete from the o
-000160b0: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-000160c0: 3a70 6172 616d 2074 6167 5f6f 626a 6563  :param tag_objec
-000160d0: 7473 3a20 5468 6520 6f62 6a65 6374 7320  ts: The objects 
-000160e0: 746f 2064 656c 6574 6520 7468 6520 7461  to delete the ta
-000160f0: 6720 6672 6f6d 2e0a 0a20 2020 2020 2020  g from...       
-00016100: 2022 2222 0a20 2020 2020 2020 2070 6174   """.        pat
-00016110: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00016120: 7072 6f6a 6563 747d 2f74 6167 732f 7b74  project}/tags/{t
-00016130: 6167 5f6e 616d 657d 220a 2020 2020 2020  ag_name}".      
-00016140: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00016150: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
-00016160: 696e 6720 7461 6720 6672 6f6d 207b 7461  ing tag from {ta
-00016170: 675f 6e61 6d65 7d22 0a20 2020 2020 2020  g_name}".       
-00016180: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00016190: 2020 2020 2020 2020 2020 2020 2244 454c              "DEL
-000161a0: 4554 4522 2c0a 2020 2020 2020 2020 2020  ETE",.          
-000161b0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-000161c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000161d0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
-000161e0: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
-000161f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00016200: 2020 7461 675f 6f62 6a65 6374 732e 6469    tag_objects.di
-00016210: 6374 2829 0a20 2020 2020 2020 2020 2020  ct().           
-00016220: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00016230: 6365 2874 6167 5f6f 626a 6563 7473 2c20  ce(tag_objects, 
-00016240: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00016250: 656d 6173 2e54 6167 4f62 6a65 6374 7329  emas.TagObjects)
-00016260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016270: 2065 6c73 6520 7461 675f 6f62 6a65 6374   else tag_object
-00016280: 730a 2020 2020 2020 2020 2020 2020 292c  s.            ),
-00016290: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000162a0: 6465 6620 7461 675f 6172 7469 6661 6374  def tag_artifact
-000162b0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-000162c0: 0a20 2020 2020 2020 2061 7274 6966 6163  .        artifac
-000162d0: 7473 3a20 556e 696f 6e5b 4c69 7374 5b41  ts: Union[List[A
-000162e0: 7274 6966 6163 745d 2c20 4c69 7374 5b64  rtifact], List[d
-000162f0: 6963 745d 2c20 4172 7469 6661 6374 2c20  ict], Artifact, 
-00016300: 6469 6374 5d2c 0a20 2020 2020 2020 2070  dict],.        p
-00016310: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-00016320: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
-00016330: 7472 2c0a 2020 2020 2020 2020 7265 706c  tr,.        repl
-00016340: 6163 653a 2062 6f6f 6c20 3d20 4661 6c73  ace: bool = Fals
-00016350: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00016360: 2020 2222 2254 6167 2061 206c 6973 7420    """Tag a list 
-00016370: 6f66 2061 7274 6966 6163 7473 2e0a 0a20  of artifacts... 
-00016380: 2020 2020 2020 203a 7061 7261 6d20 6172         :param ar
-00016390: 7469 6661 6374 733a 2054 6865 2061 7274  tifacts: The art
-000163a0: 6966 6163 7473 2074 6f20 7461 672e 2043  ifacts to tag. C
-000163b0: 616e 2062 6520 6120 6c69 7374 206f 6620  an be a list of 
-000163c0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-000163d0: 6e2e 6172 7469 6661 6374 732e 4172 7469  n.artifacts.Arti
-000163e0: 6661 6374 6020 6f62 6a65 6374 7320 6f72  fact` objects or
-000163f0: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
-00016400: 7469 6f6e 6172 6965 732c 206f 7220 6120  tionaries, or a 
-00016410: 7369 6e67 6c65 206f 626a 6563 742e 0a20  single object.. 
-00016420: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00016430: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
-00016440: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00016450: 6520 6172 7469 6661 6374 732e 0a20 2020  e artifacts..   
-00016460: 2020 2020 203a 7061 7261 6d20 7461 675f       :param tag_
-00016470: 6e61 6d65 3a20 5468 6520 7461 6720 746f  name: The tag to
-00016480: 2073 6574 206f 6e20 7468 6520 6172 7469   set on the arti
-00016490: 6661 6374 732e 0a20 2020 2020 2020 203a  facts..        :
-000164a0: 7061 7261 6d20 7265 706c 6163 653a 2049  param replace: I
-000164b0: 6620 5472 7565 2c20 7265 706c 6163 6520  f True, replace 
-000164c0: 6578 6973 7469 6e67 2074 6167 732c 206f  existing tags, o
-000164d0: 7468 6572 7769 7365 2061 7070 656e 6420  therwise append 
-000164e0: 746f 2065 7869 7374 696e 6720 7461 6773  to existing tags
-000164f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00016500: 2020 2020 2020 7461 675f 6f62 6a65 6374        tag_object
-00016510: 7320 3d20 7365 6c66 2e5f 7265 736f 6c76  s = self._resolv
-00016520: 655f 6172 7469 6661 6374 735f 746f 5f74  e_artifacts_to_t
-00016530: 6167 5f6f 626a 6563 7473 2861 7274 6966  ag_objects(artif
-00016540: 6163 7473 290a 2020 2020 2020 2020 7365  acts).        se
-00016550: 6c66 2e74 6167 5f6f 626a 6563 7473 2870  lf.tag_objects(p
-00016560: 726f 6a65 6374 2c20 7461 675f 6e61 6d65  roject, tag_name
-00016570: 2c20 6f62 6a65 6374 733d 7461 675f 6f62  , objects=tag_ob
-00016580: 6a65 6374 732c 2072 6570 6c61 6365 3d72  jects, replace=r
-00016590: 6570 6c61 6365 290a 0a20 2020 2064 6566  eplace)..    def
-000165a0: 2064 656c 6574 655f 6172 7469 6661 6374   delete_artifact
-000165b0: 735f 7461 6773 280a 2020 2020 2020 2020  s_tags(.        
-000165c0: 7365 6c66 2c0a 2020 2020 2020 2020 6172  self,.        ar
-000165d0: 7469 6661 6374 732c 0a20 2020 2020 2020  tifacts,.       
-000165e0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-000165f0: 2020 2020 2020 2074 6167 5f6e 616d 653a         tag_name:
-00016600: 2073 7472 2c0a 2020 2020 293a 0a20 2020   str,.    ):.   
-00016610: 2020 2020 2022 2222 4465 6c65 7465 2074       """Delete t
-00016620: 6167 2066 726f 6d20 6120 6c69 7374 206f  ag from a list o
-00016630: 6620 6172 7469 6661 6374 732e 0a0a 2020  f artifacts...  
-00016640: 2020 2020 2020 3a70 6172 616d 2061 7274        :param art
-00016650: 6966 6163 7473 3a20 5468 6520 6172 7469  ifacts: The arti
-00016660: 6661 6374 7320 746f 2064 656c 6574 6520  facts to delete 
-00016670: 7468 6520 7461 6720 6672 6f6d 2e20 4361  the tag from. Ca
-00016680: 6e20 6265 2061 206c 6973 7420 6f66 203a  n be a list of :
-00016690: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-000166a0: 2e61 7274 6966 6163 7473 2e41 7274 6966  .artifacts.Artif
-000166b0: 6163 7460 0a20 2020 2020 2020 2020 2020  act`.           
-000166c0: 206f 626a 6563 7473 206f 7220 6469 6374   objects or dict
-000166d0: 696f 6e61 7269 6573 2c20 6f72 2061 2073  ionaries, or a s
-000166e0: 696e 676c 6520 6f62 6a65 6374 2e0a 2020  ingle object..  
-000166f0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-00016700: 6a65 6374 3a20 5072 6f6a 6563 7420 7768  ject: Project wh
-00016710: 6963 6820 636f 6e74 6169 6e73 2074 6865  ich contains the
-00016720: 2061 7274 6966 6163 7473 2e0a 2020 2020   artifacts..    
-00016730: 2020 2020 3a70 6172 616d 2074 6167 5f6e      :param tag_n
-00016740: 616d 653a 2054 6865 2074 6167 2074 6f20  ame: The tag to 
-00016750: 7365 7420 6f6e 2074 6865 2061 7274 6966  set on the artif
-00016760: 6163 7473 2e0a 2020 2020 2020 2020 2222  acts..        ""
-00016770: 220a 2020 2020 2020 2020 7461 675f 6f62  ".        tag_ob
-00016780: 6a65 6374 7320 3d20 7365 6c66 2e5f 7265  jects = self._re
-00016790: 736f 6c76 655f 6172 7469 6661 6374 735f  solve_artifacts_
-000167a0: 746f 5f74 6167 5f6f 626a 6563 7473 2861  to_tag_objects(a
-000167b0: 7274 6966 6163 7473 290a 2020 2020 2020  rtifacts).      
-000167c0: 2020 7365 6c66 2e64 656c 6574 655f 6f62    self.delete_ob
-000167d0: 6a65 6374 735f 7461 6728 7072 6f6a 6563  jects_tag(projec
-000167e0: 742c 2074 6167 5f6e 616d 652c 2074 6167  t, tag_name, tag
-000167f0: 5f6f 626a 6563 7473 290a 0a20 2020 2064  _objects)..    d
-00016800: 6566 206c 6973 745f 7072 6f6a 6563 7473  ef list_projects
-00016810: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00016820: 2020 2020 2020 2020 6f77 6e65 723a 2073          owner: s
-00016830: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00016840: 2020 2066 6f72 6d61 745f 3a20 556e 696f     format_: Unio
-00016850: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-00016860: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-00016870: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
-00016880: 7346 6f72 6d61 740a 2020 2020 2020 2020  sFormat.        
-00016890: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-000168a0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
-000168b0: 7346 6f72 6d61 742e 6675 6c6c 2c0a 2020  sFormat.full,.  
-000168c0: 2020 2020 2020 6c61 6265 6c73 3a20 4c69        labels: Li
-000168d0: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-000168e0: 2020 2020 2020 2020 7374 6174 653a 2055          state: U
-000168f0: 6e69 6f6e 5b73 7472 2c20 6d6c 7275 6e2e  nion[str, mlrun.
-00016900: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
-00016910: 726f 6a65 6374 5374 6174 655d 203d 204e  rojectState] = N
-00016920: 6f6e 652c 0a20 2020 2029 202d 3e20 4c69  one,.    ) -> Li
-00016930: 7374 5b55 6e69 6f6e 5b6d 6c72 756e 2e70  st[Union[mlrun.p
-00016940: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
-00016950: 6a65 6374 2c20 7374 725d 5d3a 0a20 2020  ject, str]]:.   
-00016960: 2020 2020 2022 2222 5265 7475 726e 2061       """Return a
-00016970: 206c 6973 7420 6f66 2074 6865 2065 7869   list of the exi
-00016980: 7374 696e 6720 7072 6f6a 6563 7473 2c20  sting projects, 
-00016990: 706f 7465 6e74 6961 6c6c 7920 6669 6c74  potentially filt
-000169a0: 6572 6564 2062 7920 7370 6563 6966 6963  ered by specific
-000169b0: 2063 7269 7465 7269 612e 0a0a 2020 2020   criteria...    
-000169c0: 2020 2020 3a70 6172 616d 206f 776e 6572      :param owner
-000169d0: 3a20 4c69 7374 206f 6e6c 7920 7072 6f6a  : List only proj
-000169e0: 6563 7473 2062 656c 6f6e 6769 6e67 2074  ects belonging t
-000169f0: 6f20 7468 6973 2073 7065 6369 6669 6320  o this specific 
-00016a00: 6f77 6e65 722e 0a20 2020 2020 2020 203a  owner..        :
-00016a10: 7061 7261 6d20 666f 726d 6174 5f3a 2046  param format_: F
-00016a20: 6f72 6d61 7420 6f66 2074 6865 2072 6573  ormat of the res
-00016a30: 756c 7473 2e20 506f 7373 6962 6c65 2076  ults. Possible v
-00016a40: 616c 7565 7320 6172 653a 0a0a 2020 2020  alues are:..    
-00016a50: 2020 2020 2020 2020 2d20 6060 6675 6c6c          - ``full
-00016a60: 6060 2028 6465 6661 756c 7420 7661 6c75  `` (default valu
-00016a70: 6529 202d 2052 6574 7572 6e20 6675 6c6c  e) - Return full
-00016a80: 2070 726f 6a65 6374 206f 626a 6563 7473   project objects
-00016a90: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00016aa0: 6060 6d69 6e69 6d61 6c60 6020 2d20 5265  ``minimal`` - Re
-00016ab0: 7475 726e 206d 696e 696d 616c 2070 726f  turn minimal pro
-00016ac0: 6a65 6374 206f 626a 6563 7473 2028 6d69  ject objects (mi
-00016ad0: 6e69 6d69 7a61 7469 6f6e 2068 6170 7065  nimization happe
-00016ae0: 6e73 2069 6e20 7468 6520 4245 292e 0a20  ns in the BE).. 
-00016af0: 2020 2020 2020 2020 2020 202d 2060 606e             - ``n
-00016b00: 616d 655f 6f6e 6c79 6060 202d 2052 6574  ame_only`` - Ret
-00016b10: 7572 6e20 6a75 7374 2074 6865 206e 616d  urn just the nam
-00016b20: 6573 206f 6620 7468 6520 7072 6f6a 6563  es of the projec
-00016b30: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
-00016b40: 7261 6d20 6c61 6265 6c73 3a20 4669 6c74  ram labels: Filt
-00016b50: 6572 2062 7920 6c61 6265 6c73 2061 7474  er by labels att
-00016b60: 6163 6865 6420 746f 2074 6865 2070 726f  ached to the pro
-00016b70: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
-00016b80: 6172 616d 2073 7461 7465 3a20 4669 6c74  aram state: Filt
-00016b90: 6572 2062 7920 7072 6f6a 6563 7427 7320  er by project's 
-00016ba0: 7374 6174 652e 2043 616e 2062 6520 6569  state. Can be ei
-00016bb0: 7468 6572 2060 606f 6e6c 696e 6560 6020  ther ``online`` 
-00016bc0: 6f72 2060 6061 7263 6869 7665 6460 602e  or ``archived``.
-00016bd0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00016be0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00016bf0: 0a20 2020 2020 2020 2020 2020 2022 6f77  .            "ow
-00016c00: 6e65 7222 3a20 6f77 6e65 722c 0a20 2020  ner": owner,.   
-00016c10: 2020 2020 2020 2020 2022 7374 6174 6522           "state"
-00016c20: 3a20 7374 6174 652c 0a20 2020 2020 2020  : state,.       
-00016c30: 2020 2020 2022 666f 726d 6174 223a 2066       "format": f
-00016c40: 6f72 6d61 745f 2c0a 2020 2020 2020 2020  ormat_,.        
-00016c50: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
-00016c60: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
-00016c70: 2020 207d 0a0a 2020 2020 2020 2020 6572     }..        er
-00016c80: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00016c90: 4661 696c 6564 206c 6973 7469 6e67 2070  Failed listing p
-00016ca0: 726f 6a65 6374 732c 2071 7565 7279 3a20  rojects, query: 
-00016cb0: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
-00016cc0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00016cd0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-00016ce0: 2c20 2270 726f 6a65 6374 7322 2c20 6572  , "projects", er
-00016cf0: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00016d00: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00016d10: 2020 2020 6966 2066 6f72 6d61 745f 203d      if format_ =
-00016d20: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00016d30: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
-00016d40: 6f72 6d61 742e 6e61 6d65 5f6f 6e6c 793a  ormat.name_only:
-00016d50: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00016d60: 7072 6f6a 6563 7473 2069 7320 6a75 7374  projects is just
-00016d70: 2061 206c 6973 7420 6f66 2073 7472 696e   a list of strin
-00016d80: 6773 0a20 2020 2020 2020 2020 2020 2072  gs.            r
-00016d90: 6574 7572 6e20 7265 7370 6f6e 7365 2e6a  eturn response.j
-00016da0: 736f 6e28 295b 2270 726f 6a65 6374 7322  son()["projects"
-00016db0: 5d0a 0a20 2020 2020 2020 2023 2066 6f72  ]..        # for
-00016dc0: 7761 7264 7320 636f 6d70 6174 6962 696c  wards compatibil
-00016dd0: 6974 7920 2d20 7765 2077 616e 7420 746f  ity - we want to
-00016de0: 2062 6520 6162 6c65 2074 6f20 6861 6e64   be able to hand
-00016df0: 6c65 206e 6577 2066 6f72 6d61 7473 2074  le new formats t
-00016e00: 6861 7420 6d69 6768 7420 6265 2061 6464  hat might be add
-00016e10: 6564 2069 6e20 7468 6520 6675 7475 7265  ed in the future
-00016e20: 0a20 2020 2020 2020 2023 2069 6620 666f  .        # if fo
-00016e30: 726d 6174 2069 7320 6e6f 7420 6b6e 6f77  rmat is not know
-00016e40: 6e20 746f 2074 6865 2061 7069 2c20 6974  n to the api, it
-00016e50: 2069 7320 7570 2074 6f20 7468 6520 7365   is up to the se
-00016e60: 7276 6572 2074 6f20 7265 7475 726e 2065  rver to return e
-00016e70: 6974 6865 7220 616e 2065 7272 6f72 206f  ither an error o
-00016e80: 7220 6120 6465 6661 756c 7420 666f 726d  r a default form
-00016e90: 6174 0a20 2020 2020 2020 2072 6574 7572  at.        retur
-00016ea0: 6e20 5b0a 2020 2020 2020 2020 2020 2020  n [.            
-00016eb0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
-00016ec0: 6c72 756e 5072 6f6a 6563 742e 6672 6f6d  lrunProject.from
-00016ed0: 5f64 6963 7428 7072 6f6a 6563 745f 6469  _dict(project_di
-00016ee0: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
-00016ef0: 666f 7220 7072 6f6a 6563 745f 6469 6374  for project_dict
-00016f00: 2069 6e20 7265 7370 6f6e 7365 2e6a 736f   in response.jso
-00016f10: 6e28 295b 2270 726f 6a65 6374 7322 5d0a  n()["projects"].
-00016f20: 2020 2020 2020 2020 5d0a 0a20 2020 2064          ]..    d
-00016f30: 6566 2067 6574 5f70 726f 6a65 6374 2873  ef get_project(s
-00016f40: 656c 662c 206e 616d 653a 2073 7472 2920  elf, name: str) 
-00016f50: 2d3e 206d 6c72 756e 2e70 726f 6a65 6374  -> mlrun.project
-00016f60: 732e 4d6c 7275 6e50 726f 6a65 6374 3a0a  s.MlrunProject:.
-00016f70: 2020 2020 2020 2020 2222 2247 6574 2064          """Get d
-00016f80: 6574 6169 6c73 2066 6f72 2061 2073 7065  etails for a spe
-00016f90: 6369 6669 6320 7072 6f6a 6563 742e 2222  cific project.""
-00016fa0: 220a 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-00016fb0: 7420 6e61 6d65 3a0a 2020 2020 2020 2020  t name:.        
-00016fc0: 2020 2020 7261 6973 6520 4d4c 5275 6e49      raise MLRunI
-00016fd0: 6e76 616c 6964 4172 6775 6d65 6e74 4572  nvalidArgumentEr
-00016fe0: 726f 7228 224e 616d 6520 6d75 7374 2062  ror("Name must b
-00016ff0: 6520 7072 6f76 6964 6564 2229 0a0a 2020  e provided")..  
-00017000: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-00017010: 726f 6a65 6374 732f 7b6e 616d 657d 220a  rojects/{name}".
-00017020: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00017030: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-00017040: 2072 6574 7269 6576 696e 6720 7072 6f6a   retrieving proj
-00017050: 6563 7420 7b6e 616d 657d 220a 2020 2020  ect {name}".    
-00017060: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00017070: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-00017080: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
-00017090: 6d65 7373 6167 6529 0a20 2020 2020 2020  message).       
-000170a0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7072   return mlrun.pr
-000170b0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-000170c0: 6563 742e 6672 6f6d 5f64 6963 7428 7265  ect.from_dict(re
-000170d0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-000170e0: 2020 2020 6465 6620 6465 6c65 7465 5f70      def delete_p
-000170f0: 726f 6a65 6374 280a 2020 2020 2020 2020  roject(.        
-00017100: 7365 6c66 2c0a 2020 2020 2020 2020 6e61  self,.        na
-00017110: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00017120: 2064 656c 6574 696f 6e5f 7374 7261 7465   deletion_strate
-00017130: 6779 3a20 556e 696f 6e5b 0a20 2020 2020  gy: Union[.     
-00017140: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
-00017150: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00017160: 2e44 656c 6574 696f 6e53 7472 6174 6567  .DeletionStrateg
-00017170: 790a 2020 2020 2020 2020 5d20 3d20 6d6c  y.        ] = ml
-00017180: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00017190: 6173 2e44 656c 6574 696f 6e53 7472 6174  as.DeletionStrat
-000171a0: 6567 792e 6465 6661 756c 7428 292c 0a20  egy.default(),. 
-000171b0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-000171c0: 2244 656c 6574 6520 6120 7072 6f6a 6563  "Delete a projec
-000171d0: 742e 0a0a 2020 2020 2020 2020 3a70 6172  t...        :par
-000171e0: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
-000171f0: 2074 6865 2070 726f 6a65 6374 2074 6f20   the project to 
-00017200: 6465 6c65 7465 2e0a 2020 2020 2020 2020  delete..        
-00017210: 3a70 6172 616d 2064 656c 6574 696f 6e5f  :param deletion_
-00017220: 7374 7261 7465 6779 3a20 486f 7720 746f  strategy: How to
-00017230: 2074 7265 6174 2063 6869 6c64 206f 626a   treat child obj
-00017240: 6563 7473 206f 6620 7468 6520 7072 6f6a  ects of the proj
-00017250: 6563 742e 2050 6f73 7369 626c 6520 7661  ect. Possible va
-00017260: 6c75 6573 2061 7265 3a0a 0a20 2020 2020  lues are:..     
-00017270: 2020 2020 2020 202d 2060 6072 6573 7472         - ``restr
-00017280: 6963 7460 6020 2864 6566 6175 6c74 2920  ict`` (default) 
-00017290: 2d20 5072 6f6a 6563 7420 6d75 7374 206e  - Project must n
-000172a0: 6f74 2068 6176 6520 616e 7920 6368 696c  ot have any chil
-000172b0: 6420 6f62 6a65 6374 7320 7768 656e 2064  d objects when d
-000172c0: 656c 6574 6564 2e20 4966 2075 7369 6e67  eleted. If using
-000172d0: 2074 6869 7320 6d6f 6465 2077 6869 6c65   this mode while
-000172e0: 0a20 2020 2020 2020 2020 2020 2020 2063  .              c
-000172f0: 6869 6c64 206f 626a 6563 7473 2065 7869  hild objects exi
-00017300: 7374 2c20 7468 6520 6f70 6572 6174 696f  st, the operatio
-00017310: 6e20 7769 6c6c 2066 6169 6c2e 0a20 2020  n will fail..   
-00017320: 2020 2020 2020 2020 202d 2060 6063 6173           - ``cas
-00017330: 6361 6465 6060 202d 2041 7574 6f6d 6174  cade`` - Automat
-00017340: 6963 616c 6c79 2064 656c 6574 6520 616c  ically delete al
-00017350: 6c20 6368 696c 6420 6f62 6a65 6374 7320  l child objects 
-00017360: 7768 656e 2064 656c 6574 696e 6720 7468  when deleting th
-00017370: 6520 7072 6f6a 6563 742e 0a20 2020 2020  e project..     
-00017380: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00017390: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-000173a0: 732f 7b6e 616d 657d 220a 2020 2020 2020  s/{name}".      
-000173b0: 2020 6865 6164 6572 7320 3d20 7b0a 2020    headers = {.  
-000173c0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-000173d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-000173e0: 6561 6465 724e 616d 6573 2e64 656c 6574  eaderNames.delet
-000173f0: 696f 6e5f 7374 7261 7465 6779 3a20 6465  ion_strategy: de
-00017400: 6c65 7469 6f6e 5f73 7472 6174 6567 790a  letion_strategy.
-00017410: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00017420: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00017430: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
-00017440: 696e 6720 7072 6f6a 6563 7420 7b6e 616d  ing project {nam
-00017450: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-00017460: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-00017470: 6361 6c6c 2822 4445 4c45 5445 222c 2070  call("DELETE", p
-00017480: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00017490: 6765 2c20 6865 6164 6572 733d 6865 6164  ge, headers=head
-000174a0: 6572 7329 0a20 2020 2020 2020 2069 6620  ers).        if 
-000174b0: 7265 7370 6f6e 7365 2e73 7461 7475 735f  response.status_
-000174c0: 636f 6465 203d 3d20 6874 7470 2e48 5454  code == http.HTT
-000174d0: 5053 7461 7475 732e 4143 4345 5054 4544  PStatus.ACCEPTED
-000174e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000174f0: 7475 726e 2073 656c 662e 5f77 6169 745f  turn self._wait_
-00017500: 666f 725f 7072 6f6a 6563 745f 746f 5f62  for_project_to_b
-00017510: 655f 6465 6c65 7465 6428 6e61 6d65 290a  e_deleted(name).
-00017520: 0a20 2020 2064 6566 2073 746f 7265 5f70  .    def store_p
-00017530: 726f 6a65 6374 280a 2020 2020 2020 2020  roject(.        
-00017540: 7365 6c66 2c0a 2020 2020 2020 2020 6e61  self,.        na
-00017550: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00017560: 2070 726f 6a65 6374 3a20 556e 696f 6e5b   project: Union[
-00017570: 6469 6374 2c20 6d6c 7275 6e2e 7072 6f6a  dict, mlrun.proj
-00017580: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-00017590: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-000175a0: 7363 6865 6d61 732e 5072 6f6a 6563 745d  schemas.Project]
-000175b0: 2c0a 2020 2020 2920 2d3e 206d 6c72 756e  ,.    ) -> mlrun
-000175c0: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
-000175d0: 726f 6a65 6374 3a0a 2020 2020 2020 2020  roject:.        
-000175e0: 2222 2253 746f 7265 2061 2070 726f 6a65  """Store a proje
-000175f0: 6374 2069 6e20 7468 6520 4442 2e20 5468  ct in the DB. Th
-00017600: 6973 206f 7065 7261 7469 6f6e 2077 696c  is operation wil
-00017610: 6c20 6f76 6572 7772 6974 6520 6578 6973  l overwrite exis
-00017620: 7469 6e67 2070 726f 6a65 6374 206f 6620  ting project of 
-00017630: 7468 6520 7361 6d65 206e 616d 6520 6966  the same name if
-00017640: 2065 7869 7374 732e 2222 220a 0a20 2020   exists."""..   
-00017650: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00017660: 6f6a 6563 7473 2f7b 6e61 6d65 7d22 0a20  ojects/{name}". 
-00017670: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00017680: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00017690: 7374 6f72 696e 6720 7072 6f6a 6563 7420  storing project 
-000176a0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-000176b0: 6966 2069 7369 6e73 7461 6e63 6528 7072  if isinstance(pr
-000176c0: 6f6a 6563 742c 206d 6c72 756e 2e63 6f6d  oject, mlrun.com
-000176d0: 6d6f 6e2e 7363 6865 6d61 732e 5072 6f6a  mon.schemas.Proj
-000176e0: 6563 7429 3a0a 2020 2020 2020 2020 2020  ect):.          
-000176f0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00017700: 6563 742e 6469 6374 2829 0a20 2020 2020  ect.dict().     
-00017710: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00017720: 6365 2870 726f 6a65 6374 2c20 6d6c 7275  ce(project, mlru
-00017730: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-00017740: 5072 6f6a 6563 7429 3a0a 2020 2020 2020  Project):.      
-00017750: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00017760: 7072 6f6a 6563 742e 746f 5f64 6963 7428  project.to_dict(
-00017770: 290a 2020 2020 2020 2020 7265 7370 6f6e  ).        respon
-00017780: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
-00017790: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-000177a0: 2250 5554 222c 0a20 2020 2020 2020 2020  "PUT",.         
-000177b0: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
-000177c0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-000177d0: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-000177e0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-000177f0: 6e28 7072 6f6a 6563 7429 2c0a 2020 2020  n(project),.    
-00017800: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-00017810: 2072 6573 706f 6e73 652e 7374 6174 7573   response.status
-00017820: 5f63 6f64 6520 3d3d 2068 7474 702e 4854  _code == http.HT
-00017830: 5450 5374 6174 7573 2e41 4343 4550 5445  TPStatus.ACCEPTE
-00017840: 443a 0a20 2020 2020 2020 2020 2020 2072  D:.            r
-00017850: 6574 7572 6e20 7365 6c66 2e5f 7761 6974  eturn self._wait
-00017860: 5f66 6f72 5f70 726f 6a65 6374 5f74 6f5f  _for_project_to_
-00017870: 7265 6163 685f 7465 726d 696e 616c 5f73  reach_terminal_s
-00017880: 7461 7465 286e 616d 6529 0a20 2020 2020  tate(name).     
-00017890: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-000178a0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-000178b0: 6f6a 6563 742e 6672 6f6d 5f64 6963 7428  oject.from_dict(
-000178c0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-000178d0: 0a0a 2020 2020 6465 6620 7061 7463 685f  ..    def patch_
-000178e0: 7072 6f6a 6563 7428 0a20 2020 2020 2020  project(.       
-000178f0: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-00017900: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-00017910: 2020 7072 6f6a 6563 743a 2064 6963 742c    project: dict,
-00017920: 0a20 2020 2020 2020 2070 6174 6368 5f6d  .        patch_m
-00017930: 6f64 653a 2055 6e69 6f6e 5b0a 2020 2020  ode: Union[.    
-00017940: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
-00017950: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00017960: 732e 5061 7463 684d 6f64 650a 2020 2020  s.PatchMode.    
-00017970: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
-00017980: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6174  mmon.schemas.Pat
-00017990: 6368 4d6f 6465 2e72 6570 6c61 6365 2c0a  chMode.replace,.
-000179a0: 2020 2020 2920 2d3e 206d 6c72 756e 2e70      ) -> mlrun.p
-000179b0: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
-000179c0: 6a65 6374 3a0a 2020 2020 2020 2020 2222  ject:.        ""
-000179d0: 2250 6174 6368 2061 6e20 6578 6973 7469  "Patch an existi
-000179e0: 6e67 2070 726f 6a65 6374 206f 626a 6563  ng project objec
-000179f0: 742e 0a0a 2020 2020 2020 2020 3a70 6172  t...        :par
-00017a00: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
-00017a10: 2070 726f 6a65 6374 2074 6f20 7061 7463   project to patc
-00017a20: 682e 0a20 2020 2020 2020 203a 7061 7261  h..        :para
-00017a30: 6d20 7072 6f6a 6563 743a 2054 6865 2061  m project: The a
-00017a40: 6374 7561 6c20 6368 616e 6765 7320 746f  ctual changes to
-00017a50: 2074 6865 2070 726f 6a65 6374 206f 626a   the project obj
-00017a60: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
-00017a70: 7261 6d20 7061 7463 685f 6d6f 6465 3a20  ram patch_mode: 
-00017a80: 5468 6520 7374 7261 7465 6779 2066 6f72  The strategy for
-00017a90: 206d 6572 6769 6e67 2074 6865 2063 6861   merging the cha
-00017aa0: 6e67 6573 2077 6974 6820 7468 6520 6578  nges with the ex
-00017ab0: 6973 7469 6e67 206f 626a 6563 742e 2043  isting object. C
-00017ac0: 616e 2062 6520 6569 7468 6572 2060 6072  an be either ``r
-00017ad0: 6570 6c61 6365 6060 0a20 2020 2020 2020  eplace``.       
-00017ae0: 2020 2020 206f 7220 6060 6164 6469 7469       or ``additi
-00017af0: 7665 6060 2e0a 2020 2020 2020 2020 2222  ve``..        ""
-00017b00: 220a 0a20 2020 2020 2020 2070 6174 6820  "..        path 
-00017b10: 3d20 6622 7072 6f6a 6563 7473 2f7b 6e61  = f"projects/{na
-00017b20: 6d65 7d22 0a20 2020 2020 2020 2068 6561  me}".        hea
-00017b30: 6465 7273 203d 207b 6d6c 7275 6e2e 636f  ders = {mlrun.co
-00017b40: 6d6d 6f6e 2e73 6368 656d 6173 2e48 6561  mmon.schemas.Hea
-00017b50: 6465 724e 616d 6573 2e70 6174 6368 5f6d  derNames.patch_m
-00017b60: 6f64 653a 2070 6174 6368 5f6d 6f64 657d  ode: patch_mode}
-00017b70: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00017b80: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00017b90: 6420 7061 7463 6869 6e67 2070 726f 6a65  d patching proje
-00017ba0: 6374 207b 6e61 6d65 7d22 0a20 2020 2020  ct {name}".     
-00017bb0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-00017bc0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00017bd0: 2020 2020 2020 2020 2022 5041 5443 4822           "PATCH"
-00017be0: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-00017bf0: 7373 6167 652c 2062 6f64 793d 6469 6374  ssage, body=dict
-00017c00: 5f74 6f5f 6a73 6f6e 2870 726f 6a65 6374  _to_json(project
-00017c10: 292c 2068 6561 6465 7273 3d68 6561 6465  ), headers=heade
-00017c20: 7273 0a20 2020 2020 2020 2029 0a20 2020  rs.        ).   
-00017c30: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-00017c40: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-00017c50: 5072 6f6a 6563 742e 6672 6f6d 5f64 6963  Project.from_dic
-00017c60: 7428 7265 7370 6f6e 7365 2e6a 736f 6e28  t(response.json(
-00017c70: 2929 0a0a 2020 2020 6465 6620 6372 6561  ))..    def crea
-00017c80: 7465 5f70 726f 6a65 6374 280a 2020 2020  te_project(.    
-00017c90: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00017ca0: 2020 7072 6f6a 6563 743a 2055 6e69 6f6e    project: Union
-00017cb0: 5b64 6963 742c 206d 6c72 756e 2e70 726f  [dict, mlrun.pro
-00017cc0: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-00017cd0: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
-00017ce0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
-00017cf0: 5d2c 0a20 2020 2029 202d 3e20 6d6c 7275  ],.    ) -> mlru
-00017d00: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-00017d10: 5072 6f6a 6563 743a 0a20 2020 2020 2020  Project:.       
-00017d20: 2022 2222 4372 6561 7465 2061 206e 6577   """Create a new
-00017d30: 2070 726f 6a65 6374 2e20 4120 7072 6f6a   project. A proj
-00017d40: 6563 7420 7769 7468 2074 6865 2073 616d  ect with the sam
-00017d50: 6520 6e61 6d65 206d 7573 7420 6e6f 7420  e name must not 
-00017d60: 6578 6973 7420 7072 696f 7220 746f 2063  exist prior to c
-00017d70: 7265 6174 696f 6e2e 2222 220a 0a20 2020  reation."""..   
-00017d80: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00017d90: 6365 2870 726f 6a65 6374 2c20 6d6c 7275  ce(project, mlru
-00017da0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00017db0: 2e50 726f 6a65 6374 293a 0a20 2020 2020  .Project):.     
-00017dc0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00017dd0: 2070 726f 6a65 6374 2e64 6963 7428 290a   project.dict().
-00017de0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00017df0: 6e73 7461 6e63 6528 7072 6f6a 6563 742c  nstance(project,
-00017e00: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
-00017e10: 4d6c 7275 6e50 726f 6a65 6374 293a 0a20  MlrunProject):. 
-00017e20: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00017e30: 6374 203d 2070 726f 6a65 6374 2e74 6f5f  ct = project.to_
-00017e40: 6469 6374 2829 0a20 2020 2020 2020 2070  dict().        p
-00017e50: 726f 6a65 6374 5f6e 616d 6520 3d20 7072  roject_name = pr
-00017e60: 6f6a 6563 745b 226d 6574 6164 6174 6122  oject["metadata"
-00017e70: 5d5b 226e 616d 6522 5d0a 2020 2020 2020  ]["name"].      
-00017e80: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00017e90: 3d20 6622 4661 696c 6564 2063 7265 6174  = f"Failed creat
-00017ea0: 696e 6720 7072 6f6a 6563 7420 7b70 726f  ing project {pro
-00017eb0: 6a65 6374 5f6e 616d 657d 220a 2020 2020  ject_name}".    
-00017ec0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00017ed0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00017ee0: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
-00017ef0: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
-00017f00: 726f 6a65 6374 7322 2c0a 2020 2020 2020  rojects",.      
-00017f10: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00017f20: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-00017f30: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-00017f40: 6f6e 2870 726f 6a65 6374 292c 0a20 2020  on(project),.   
-00017f50: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00017f60: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
-00017f70: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
-00017f80: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
-00017f90: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
-00017fa0: 7265 7475 726e 2073 656c 662e 5f77 6169  return self._wai
-00017fb0: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
-00017fc0: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-00017fd0: 7374 6174 6528 7072 6f6a 6563 745f 6e61  state(project_na
-00017fe0: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
-00017ff0: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
-00018000: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
-00018010: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
-00018020: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
-00018030: 6566 205f 7761 6974 5f66 6f72 5f70 726f  ef _wait_for_pro
-00018040: 6a65 6374 5f74 6f5f 7265 6163 685f 7465  ject_to_reach_te
-00018050: 726d 696e 616c 5f73 7461 7465 280a 2020  rminal_state(.  
-00018060: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
-00018070: 6563 745f 6e61 6d65 3a20 7374 720a 2020  ect_name: str.  
-00018080: 2020 2920 2d3e 206d 6c72 756e 2e70 726f    ) -> mlrun.pro
-00018090: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-000180a0: 6374 3a0a 2020 2020 2020 2020 6465 6620  ct:.        def 
-000180b0: 5f76 6572 6966 795f 7072 6f6a 6563 745f  _verify_project_
-000180c0: 696e 5f74 6572 6d69 6e61 6c5f 7374 6174  in_terminal_stat
-000180d0: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
-000180e0: 2070 726f 6a65 6374 203d 2073 656c 662e   project = self.
-000180f0: 6765 745f 7072 6f6a 6563 7428 7072 6f6a  get_project(proj
-00018100: 6563 745f 6e61 6d65 290a 2020 2020 2020  ect_name).      
-00018110: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-00018120: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00018130: 6374 2e73 7461 7475 732e 7374 6174 650a  ct.status.state.
-00018140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018150: 6e6f 7420 696e 206d 6c72 756e 2e63 6f6d  not in mlrun.com
-00018160: 6d6f 6e2e 7363 6865 6d61 732e 5072 6f6a  mon.schemas.Proj
-00018170: 6563 7453 7461 7465 2e74 6572 6d69 6e61  ectState.termina
-00018180: 6c5f 7374 6174 6573 2829 0a20 2020 2020  l_states().     
-00018190: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-000181a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000181b0: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
-000181c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000181d0: 2250 726f 6a65 6374 206e 6f74 2069 6e20  "Project not in 
-000181e0: 7465 726d 696e 616c 2073 7461 7465 2e20  terminal state. 
-000181f0: 5374 6174 653a 207b 7072 6f6a 6563 742e  State: {project.
-00018200: 7374 6174 7573 2e73 7461 7465 7d22 0a20  status.state}". 
-00018210: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00018220: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00018230: 7572 6e20 7072 6f6a 6563 740a 0a20 2020  urn project..   
-00018240: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-00018250: 6e2e 7574 696c 732e 6865 6c70 6572 732e  n.utils.helpers.
-00018260: 7265 7472 795f 756e 7469 6c5f 7375 6363  retry_until_succ
-00018270: 6573 7366 756c 280a 2020 2020 2020 2020  essful(.        
-00018280: 2020 2020 7365 6c66 2e5f 7761 6974 5f66      self._wait_f
-00018290: 6f72 5f70 726f 6a65 6374 5f74 6572 6d69  or_project_termi
-000182a0: 6e61 6c5f 7374 6174 655f 7265 7472 795f  nal_state_retry_
-000182b0: 696e 7465 7276 616c 2c0a 2020 2020 2020  interval,.      
-000182c0: 2020 2020 2020 3132 302c 0a20 2020 2020        120,.     
-000182d0: 2020 2020 2020 206c 6f67 6765 722c 0a20         logger,. 
-000182e0: 2020 2020 2020 2020 2020 2046 616c 7365             False
-000182f0: 2c0a 2020 2020 2020 2020 2020 2020 5f76  ,.            _v
-00018300: 6572 6966 795f 7072 6f6a 6563 745f 696e  erify_project_in
-00018310: 5f74 6572 6d69 6e61 6c5f 7374 6174 652c  _terminal_state,
-00018320: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00018330: 6465 6620 5f77 6169 745f 666f 725f 6261  def _wait_for_ba
-00018340: 636b 6772 6f75 6e64 5f74 6173 6b5f 746f  ckground_task_to
-00018350: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-00018360: 7374 6174 6528 0a20 2020 2020 2020 2073  state(.        s
-00018370: 656c 662c 206e 616d 653a 2073 7472 0a20  elf, name: str. 
-00018380: 2020 2029 202d 3e20 6d6c 7275 6e2e 636f     ) -> mlrun.co
-00018390: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-000183a0: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
-000183b0: 2020 2020 2064 6566 205f 7665 7269 6679       def _verify
-000183c0: 5f62 6163 6b67 726f 756e 645f 7461 736b  _background_task
-000183d0: 5f69 6e5f 7465 726d 696e 616c 5f73 7461  _in_terminal_sta
-000183e0: 7465 2829 3a0a 2020 2020 2020 2020 2020  te():.          
-000183f0: 2020 6261 636b 6772 6f75 6e64 5f74 6173    background_tas
-00018400: 6b20 3d20 7365 6c66 2e67 6574 5f62 6163  k = self.get_bac
-00018410: 6b67 726f 756e 645f 7461 736b 286e 616d  kground_task(nam
-00018420: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-00018430: 7461 7465 203d 2062 6163 6b67 726f 756e  tate = backgroun
-00018440: 645f 7461 736b 2e73 7461 7475 732e 7374  d_task.status.st
-00018450: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
-00018460: 6966 2073 7461 7465 206e 6f74 2069 6e20  if state not in 
-00018470: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00018480: 656d 6173 2e42 6163 6b67 726f 756e 6454  emas.BackgroundT
-00018490: 6173 6b53 7461 7465 2e74 6572 6d69 6e61  askState.termina
-000184a0: 6c5f 7374 6174 6573 2829 3a0a 2020 2020  l_states():.    
-000184b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000184c0: 6520 4578 6365 7074 696f 6e28 0a20 2020  e Exception(.   
-000184d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184e0: 2066 2242 6163 6b67 726f 756e 6420 7461   f"Background ta
-000184f0: 736b 206e 6f74 2069 6e20 7465 726d 696e  sk not in termin
-00018500: 616c 2073 7461 7465 2e20 6e61 6d65 3d7b  al state. name={
-00018510: 6e61 6d65 7d2c 2073 7461 7465 3d7b 7374  name}, state={st
-00018520: 6174 657d 220a 2020 2020 2020 2020 2020  ate}".          
-00018530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00018540: 2020 2020 7265 7475 726e 2062 6163 6b67      return backg
-00018550: 726f 756e 645f 7461 736b 0a0a 2020 2020  round_task..    
-00018560: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00018570: 2e75 7469 6c73 2e68 656c 7065 7273 2e72  .utils.helpers.r
-00018580: 6574 7279 5f75 6e74 696c 5f73 7563 6365  etry_until_succe
-00018590: 7373 6675 6c28 0a20 2020 2020 2020 2020  ssful(.         
-000185a0: 2020 2073 656c 662e 5f77 6169 745f 666f     self._wait_fo
-000185b0: 725f 6261 636b 6772 6f75 6e64 5f74 6173  r_background_tas
-000185c0: 6b5f 7465 726d 696e 616c 5f73 7461 7465  k_terminal_state
-000185d0: 5f72 6574 7279 5f69 6e74 6572 7661 6c2c  _retry_interval,
-000185e0: 0a20 2020 2020 2020 2020 2020 2036 3020  .            60 
-000185f0: 2a20 3630 2c0a 2020 2020 2020 2020 2020  * 60,.          
-00018600: 2020 6c6f 6767 6572 2c0a 2020 2020 2020    logger,.      
-00018610: 2020 2020 2020 4661 6c73 652c 0a20 2020        False,.   
-00018620: 2020 2020 2020 2020 205f 7665 7269 6679           _verify
-00018630: 5f62 6163 6b67 726f 756e 645f 7461 736b  _background_task
-00018640: 5f69 6e5f 7465 726d 696e 616c 5f73 7461  _in_terminal_sta
-00018650: 7465 2c0a 2020 2020 2020 2020 290a 0a20  te,.        ).. 
-00018660: 2020 2064 6566 205f 7761 6974 5f66 6f72     def _wait_for
-00018670: 5f70 726f 6a65 6374 5f74 6f5f 6265 5f64  _project_to_be_d
-00018680: 656c 6574 6564 2873 656c 662c 2070 726f  eleted(self, pro
-00018690: 6a65 6374 5f6e 616d 653a 2073 7472 293a  ject_name: str):
-000186a0: 0a20 2020 2020 2020 2064 6566 205f 7665  .        def _ve
-000186b0: 7269 6679 5f70 726f 6a65 6374 5f64 656c  rify_project_del
-000186c0: 6574 6564 2829 3a0a 2020 2020 2020 2020  eted():.        
-000186d0: 2020 2020 7072 6f6a 6563 7473 203d 2073      projects = s
-000186e0: 656c 662e 6c69 7374 5f70 726f 6a65 6374  elf.list_project
-000186f0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00018700: 2020 2066 6f72 6d61 745f 3d6d 6c72 756e     format_=mlrun
-00018710: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00018720: 5072 6f6a 6563 7473 466f 726d 6174 2e6e  ProjectsFormat.n
-00018730: 616d 655f 6f6e 6c79 0a20 2020 2020 2020  ame_only.       
-00018740: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00018750: 2020 2069 6620 7072 6f6a 6563 745f 6e61     if project_na
-00018760: 6d65 2069 6e20 7072 6f6a 6563 7473 3a0a  me in projects:.
-00018770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018780: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-00018790: 6622 5072 6f6a 6563 7420 7b70 726f 6a65  f"Project {proje
-000187a0: 6374 5f6e 616d 657d 2073 7469 6c6c 2065  ct_name} still e
-000187b0: 7869 7374 7322 290a 0a20 2020 2020 2020  xists")..       
-000187c0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7574   return mlrun.ut
-000187d0: 696c 732e 6865 6c70 6572 732e 7265 7472  ils.helpers.retr
-000187e0: 795f 756e 7469 6c5f 7375 6363 6573 7366  y_until_successf
-000187f0: 756c 280a 2020 2020 2020 2020 2020 2020  ul(.            
-00018800: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
-00018810: 726f 6a65 6374 5f64 656c 6574 696f 6e5f  roject_deletion_
-00018820: 696e 7465 7276 616c 2c0a 2020 2020 2020  interval,.      
-00018830: 2020 2020 2020 3132 302c 0a20 2020 2020        120,.     
-00018840: 2020 2020 2020 206c 6f67 6765 722c 0a20         logger,. 
-00018850: 2020 2020 2020 2020 2020 2046 616c 7365             False
-00018860: 2c0a 2020 2020 2020 2020 2020 2020 5f76  ,.            _v
-00018870: 6572 6966 795f 7072 6f6a 6563 745f 6465  erify_project_de
-00018880: 6c65 7465 642c 0a20 2020 2020 2020 2029  leted,.        )
-00018890: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-000188a0: 5f70 726f 6a65 6374 5f73 6563 7265 7473  _project_secrets
-000188b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000188c0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-000188d0: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
-000188e0: 6f76 6964 6572 3a20 556e 696f 6e5b 0a20  ovider: Union[. 
-000188f0: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-00018900: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00018910: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-00018920: 6465 724e 616d 650a 2020 2020 2020 2020  derName.        
-00018930: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-00018940: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
-00018950: 726f 7669 6465 724e 616d 652e 6b75 6265  roviderName.kube
-00018960: 726e 6574 6573 2c0a 2020 2020 2020 2020  rnetes,.        
-00018970: 7365 6372 6574 733a 2064 6963 7420 3d20  secrets: dict = 
-00018980: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-00018990: 2020 2020 2022 2222 4372 6561 7465 2070       """Create p
-000189a0: 726f 6a65 6374 2d63 6f6e 7465 7874 2073  roject-context s
-000189b0: 6563 7265 7473 2075 7369 6e67 2065 6974  ecrets using eit
-000189c0: 6865 7220 6060 7661 756c 7460 6020 6f72  her ``vault`` or
-000189d0: 2060 606b 7562 6572 6e65 7465 7360 6020   ``kubernetes`` 
-000189e0: 7072 6f76 6964 6572 2e0a 2020 2020 2020  provider..      
-000189f0: 2020 5768 656e 2075 7369 6e67 2077 6974    When using wit
-00018a00: 6820 5661 756c 742c 2074 6869 7320 7769  h Vault, this wi
-00018a10: 6c6c 2063 7265 6174 6520 6e65 6564 6564  ll create needed
-00018a20: 2056 6175 6c74 2073 7472 7563 7475 7265   Vault structure
-00018a30: 7320 666f 7220 7374 6f72 696e 6720 7365  s for storing se
-00018a40: 6372 6574 7320 696e 2070 726f 6a65 6374  crets in project
-00018a50: 2d63 6f6e 7465 7874 2c20 616e 640a 2020  -context, and.  
-00018a60: 2020 2020 2020 7374 6f72 6520 6120 7365        store a se
-00018a70: 7420 6f66 2073 6563 7265 7420 7661 6c75  t of secret valu
-00018a80: 6573 2e20 5468 6520 6d65 7468 6f64 2067  es. The method g
-00018a90: 656e 6572 6174 6573 204b 7562 6572 6e65  enerates Kuberne
-00018aa0: 7465 7320 7365 7276 6963 652d 6163 636f  tes service-acco
-00018ab0: 756e 7420 616e 6420 7468 6520 5661 756c  unt and the Vaul
-00018ac0: 7420 6175 7468 656e 7469 6361 7469 6f6e  t authentication
-00018ad0: 0a20 2020 2020 2020 2073 7472 7563 7475  .        structu
-00018ae0: 7265 7320 7468 6174 2061 7265 2072 6571  res that are req
-00018af0: 7569 7265 6420 666f 7220 6675 6e63 7469  uired for functi
-00018b00: 6f6e 2050 6f64 7320 746f 2061 7574 6865  on Pods to authe
-00018b10: 6e74 6963 6174 6520 7769 7468 2056 6175  nticate with Vau
-00018b20: 6c74 2061 6e64 2062 6520 6162 6c65 2074  lt and be able t
-00018b30: 6f20 6578 7472 6163 7420 7365 6372 6574  o extract secret
-00018b40: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
-00018b50: 7061 7373 6564 2061 7320 7061 7274 206f  passed as part o
-00018b60: 6620 7468 6569 7220 636f 6e74 6578 742e  f their context.
-00018b70: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
-00018b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b90: 5468 6973 206d 6574 686f 6420 7573 6564  This method used
-00018ba0: 2077 6974 6820 5661 756c 7420 6973 2063   with Vault is c
-00018bb0: 7572 7265 6e74 6c79 2069 6e20 7465 6368  urrently in tech
-00018bc0: 6e69 6361 6c20 7072 6576 6965 772c 2061  nical preview, a
-00018bd0: 6e64 2072 6571 7569 7265 7320 6120 4861  nd requires a Ha
-00018be0: 7368 6943 6f72 7020 5661 756c 740a 2020  shiCorp Vault.  
-00018bf0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00018c00: 6672 6173 7472 7563 7475 7265 2070 726f  frastructure pro
-00018c10: 7065 726c 7920 7365 7420 7570 2061 6e64  perly set up and
-00018c20: 2063 6f6e 6e65 6374 6564 2074 6f20 7468   connected to th
-00018c30: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
-00018c40: 6572 2e0a 0a20 2020 2020 2020 2057 6865  er...        Whe
-00018c50: 6e20 7573 6564 2077 6974 6820 4b75 6265  n used with Kube
-00018c60: 726e 6574 6573 2c20 7468 6973 2077 696c  rnetes, this wil
-00018c70: 6c20 6d61 6b65 2073 7572 6520 7468 6174  l make sure that
-00018c80: 2074 6865 2070 726f 6a65 6374 2d73 7065   the project-spe
-00018c90: 6369 6669 6320 6b38 7320 7365 6372 6574  cific k8s secret
-00018ca0: 2069 7320 6372 6561 7465 642c 2061 6e64   is created, and
-00018cb0: 2077 696c 6c0a 2020 2020 2020 2020 706f   will.        po
-00018cc0: 7075 6c61 7465 2069 7420 7769 7468 2074  pulate it with t
-00018cd0: 6865 2073 6563 7265 7473 2070 726f 7669  he secrets provi
-00018ce0: 6465 642c 2072 6570 6c61 6369 6e67 2074  ded, replacing t
-00018cf0: 6865 6972 2076 616c 7565 7320 6966 2074  heir values if t
-00018d00: 6865 7920 6578 6973 742e 0a0a 2020 2020  hey exist...    
-00018d10: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00018d20: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
-00018d30: 636f 6e74 6578 7420 666f 7220 7768 6963  context for whic
-00018d40: 6820 746f 2067 656e 6572 6174 6520 7468  h to generate th
-00018d50: 6520 696e 6672 6120 616e 6420 7374 6f72  e infra and stor
-00018d60: 6520 7365 6372 6574 732e 0a20 2020 2020  e secrets..     
-00018d70: 2020 203a 7061 7261 6d20 7072 6f76 6964     :param provid
-00018d80: 6572 3a20 5468 6520 6e61 6d65 206f 6620  er: The name of 
-00018d90: 7468 6520 7365 6372 6574 732d 7072 6f76  the secrets-prov
-00018da0: 6964 6572 2074 6f20 776f 726b 2077 6974  ider to work wit
-00018db0: 682e 2041 6363 6570 7473 2061 0a20 2020  h. Accepts a.   
-00018dc0: 2020 2020 2020 2020 203a 7079 3a63 6c61           :py:cla
-00018dd0: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
-00018de0: 6e2e 7363 6865 6d61 732e 7365 6372 6574  n.schemas.secret
-00018df0: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-00018e00: 616d 6560 2065 6e75 6d2e 0a20 2020 2020  ame` enum..     
-00018e10: 2020 203a 7061 7261 6d20 7365 6372 6574     :param secret
-00018e20: 733a 2041 2073 6574 206f 6620 7365 6372  s: A set of secr
-00018e30: 6574 2076 616c 7565 7320 746f 2073 746f  et values to sto
-00018e40: 7265 2e0a 2020 2020 2020 2020 2020 2020  re..            
-00018e50: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00018e60: 2020 2020 2020 2020 2020 2073 6563 7265             secre
-00018e70: 7473 203d 207b 2770 6173 7377 6f72 6427  ts = {'password'
-00018e80: 3a20 276d 7950 6173 7377 3072 6427 2c20  : 'myPassw0rd', 
-00018e90: 2761 7773 5f6b 6579 273a 2027 3131 3132  'aws_key': '1112
-00018ea0: 3232 3333 3327 7d0a 2020 2020 2020 2020  22333'}.        
-00018eb0: 2020 2020 2020 2020 6462 2e63 7265 6174          db.creat
-00018ec0: 655f 7072 6f6a 6563 745f 7365 6372 6574  e_project_secret
-00018ed0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00018ee0: 2020 2020 2020 2022 7072 6f6a 6563 7431         "project1
-00018ef0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00018f00: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
-00018f10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00018f20: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-00018f30: 6465 724e 616d 652e 6b75 6265 726e 6574  derName.kubernet
-00018f40: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00018f50: 2020 2020 2020 2020 7365 6372 6574 733d          secrets=
-00018f60: 7365 6372 6574 730a 2020 2020 2020 2020  secrets.        
-00018f70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018f80: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-00018f90: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00018fa0: 7b70 726f 6a65 6374 7d2f 7365 6372 6574  {project}/secret
-00018fb0: 7322 0a20 2020 2020 2020 2073 6563 7265  s".        secre
-00018fc0: 7473 5f69 6e70 7574 203d 206d 6c72 756e  ts_input = mlrun
-00018fd0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00018fe0: 5365 6372 6574 7344 6174 6128 0a20 2020  SecretsData(.   
-00018ff0: 2020 2020 2020 2020 2073 6563 7265 7473           secrets
-00019000: 3d73 6563 7265 7473 2c20 7072 6f76 6964  =secrets, provid
-00019010: 6572 3d70 726f 7669 6465 720a 2020 2020  er=provider.    
-00019020: 2020 2020 290a 2020 2020 2020 2020 626f      ).        bo
-00019030: 6479 203d 2073 6563 7265 7473 5f69 6e70  dy = secrets_inp
-00019040: 7574 2e64 6963 7428 290a 2020 2020 2020  ut.dict().      
-00019050: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00019060: 3d20 6622 4661 696c 6564 2063 7265 6174  = f"Failed creat
-00019070: 696e 6720 7365 6372 6574 2070 726f 7669  ing secret provi
-00019080: 6465 7220 7b70 726f 6a65 6374 7d2f 7b70  der {project}/{p
-00019090: 726f 7669 6465 727d 220a 2020 2020 2020  rovider}".      
-000190a0: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-000190b0: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
-000190c0: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-000190d0: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-000190e0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-000190f0: 2c0a 2020 2020 2020 2020 2020 2020 626f  ,.            bo
-00019100: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00019110: 626f 6479 292c 0a20 2020 2020 2020 2029  body),.        )
-00019120: 0a0a 2020 2020 6465 6620 6c69 7374 5f70  ..    def list_p
-00019130: 726f 6a65 6374 5f73 6563 7265 7473 280a  roject_secrets(.
-00019140: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00019150: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-00019160: 7472 2c0a 2020 2020 2020 2020 746f 6b65  tr,.        toke
-00019170: 6e3a 2073 7472 203d 204e 6f6e 652c 0a20  n: str = None,. 
-00019180: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
-00019190: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-000191a0: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-000191b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-000191c0: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-000191d0: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-000191e0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000191f0: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
-00019200: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
-00019210: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-00019220: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
-00019230: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
-00019240: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00019250: 732e 5365 6372 6574 7344 6174 613a 0a20  s.SecretsData:. 
-00019260: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
-00019270: 7665 2070 726f 6a65 6374 2d63 6f6e 7465  ve project-conte
-00019280: 7874 2073 6563 7265 7473 2066 726f 6d20  xt secrets from 
-00019290: 5661 756c 742e 0a0a 2020 2020 2020 2020  Vault...        
-000192a0: 4e6f 7465 3a0a 2020 2020 2020 2020 2020  Note:.          
-000192b0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-000192c0: 6420 666f 7220 5661 756c 7420 6675 6e63  d for Vault func
-000192d0: 7469 6f6e 616c 6974 7920 6973 2063 7572  tionality is cur
-000192e0: 7265 6e74 6c79 2069 6e20 7465 6368 6e69  rently in techni
-000192f0: 6361 6c20 7072 6576 6965 772c 2061 6e64  cal preview, and
-00019300: 2072 6571 7569 7265 7320 6120 4861 7368   requires a Hash
-00019310: 6943 6f72 7020 5661 756c 740a 2020 2020  iCorp Vault.    
-00019320: 2020 2020 2020 2020 2020 2020 696e 6672              infr
-00019330: 6173 7472 7563 7475 7265 2070 726f 7065  astructure prope
-00019340: 726c 7920 7365 7420 7570 2061 6e64 2063  rly set up and c
-00019350: 6f6e 6e65 6374 6564 2074 6f20 7468 6520  onnected to the 
-00019360: 4d4c 5275 6e20 4150 4920 7365 7276 6572  MLRun API server
-00019370: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00019380: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
-00019390: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
-000193a0: 2020 2020 203a 7061 7261 6d20 746f 6b65       :param toke
-000193b0: 6e3a 2056 6175 6c74 2074 6f6b 656e 2074  n: Vault token t
-000193c0: 6f20 7573 6520 666f 7220 7265 7472 6965  o use for retrie
-000193d0: 7669 6e67 2073 6563 7265 7473 2e0a 2020  ving secrets..  
-000193e0: 2020 2020 2020 2020 2020 4d75 7374 2062            Must b
-000193f0: 6520 6120 7661 6c69 6420 5661 756c 7420  e a valid Vault 
-00019400: 746f 6b65 6e2c 2077 6974 6820 7065 726d  token, with perm
-00019410: 6973 7369 6f6e 7320 746f 2072 6574 7269  issions to retri
-00019420: 6576 6520 7365 6372 6574 7320 6f66 2074  eve secrets of t
-00019430: 6865 2070 726f 6a65 6374 2069 6e20 7175  he project in qu
-00019440: 6573 7469 6f6e 2e0a 2020 2020 2020 2020  estion..        
-00019450: 3a70 6172 616d 2070 726f 7669 6465 723a  :param provider:
-00019460: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-00019470: 2073 6563 7265 7473 2d70 726f 7669 6465   secrets-provide
-00019480: 7220 746f 2077 6f72 6b20 7769 7468 2e20  r to work with. 
-00019490: 4375 7272 656e 746c 7920 6f6e 6c79 2060  Currently only `
-000194a0: 6076 6175 6c74 6060 2069 7320 6163 6365  `vault`` is acce
-000194b0: 7074 6564 2e0a 2020 2020 2020 2020 3a70  pted..        :p
-000194c0: 6172 616d 2073 6563 7265 7473 3a20 4120  aram secrets: A 
-000194d0: 6c69 7374 206f 6620 7365 6372 6574 206e  list of secret n
-000194e0: 616d 6573 2074 6f20 7265 7472 6965 7665  ames to retrieve
-000194f0: 2e20 416e 2065 6d70 7479 206c 6973 7420  . An empty list 
-00019500: 6060 5b5d 6060 2077 696c 6c20 7265 7472  ``[]`` will retr
-00019510: 6965 7665 2061 6c6c 2073 6563 7265 7473  ieve all secrets
-00019520: 2061 7373 6967 6e65 640a 2020 2020 2020   assigned.      
-00019530: 2020 2020 2020 746f 2074 6869 7320 7370        to this sp
-00019540: 6563 6966 6963 2070 726f 6a65 6374 2e20  ecific project. 
-00019550: 6060 6b75 6265 726e 6574 6573 6060 2070  ``kubernetes`` p
-00019560: 726f 7669 6465 7220 6f6e 6c79 2073 7570  rovider only sup
-00019570: 706f 7274 7320 616e 2065 6d70 7479 206c  ports an empty l
-00019580: 6973 742e 0a20 2020 2020 2020 2022 2222  ist..        """
-00019590: 0a0a 2020 2020 2020 2020 6966 2028 0a20  ..        if (. 
-000195a0: 2020 2020 2020 2020 2020 2070 726f 7669             provi
-000195b0: 6465 7220 3d3d 206d 6c72 756e 2e63 6f6d  der == mlrun.com
-000195c0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-000195d0: 6574 5072 6f76 6964 6572 4e61 6d65 2e76  etProviderName.v
-000195e0: 6175 6c74 2e76 616c 7565 0a20 2020 2020  ault.value.     
-000195f0: 2020 2020 2020 2061 6e64 206e 6f74 2074         and not t
-00019600: 6f6b 656e 0a20 2020 2020 2020 2029 3a0a  oken.        ):.
-00019610: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019620: 6520 4d4c 5275 6e49 6e76 616c 6964 4172  e MLRunInvalidAr
-00019630: 6775 6d65 6e74 4572 726f 7228 0a20 2020  gumentError(.   
-00019640: 2020 2020 2020 2020 2020 2020 2022 4120               "A 
-00019650: 7661 756c 7420 746f 6b65 6e20 6d75 7374  vault token must
-00019660: 2062 6520 7072 6f76 6964 6564 2077 6865   be provided whe
-00019670: 6e20 6163 6365 7373 696e 6720 7661 756c  n accessing vaul
-00019680: 7420 7365 6372 6574 7322 0a20 2020 2020  t secrets".     
-00019690: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000196a0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-000196b0: 6374 732f 7b70 726f 6a65 6374 7d2f 7365  cts/{project}/se
-000196c0: 6372 6574 7322 0a20 2020 2020 2020 2070  crets".        p
-000196d0: 6172 616d 7320 3d20 7b22 7072 6f76 6964  arams = {"provid
-000196e0: 6572 223a 2070 726f 7669 6465 722c 2022  er": provider, "
-000196f0: 7365 6372 6574 223a 2073 6563 7265 7473  secret": secrets
-00019700: 7d0a 2020 2020 2020 2020 6865 6164 6572  }.        header
-00019710: 7320 3d20 7b6d 6c72 756e 2e63 6f6d 6d6f  s = {mlrun.commo
-00019720: 6e2e 7363 6865 6d61 732e 4865 6164 6572  n.schemas.Header
-00019730: 4e61 6d65 732e 7365 6372 6574 5f73 746f  Names.secret_sto
-00019740: 7265 5f74 6f6b 656e 3a20 746f 6b65 6e7d  re_token: token}
-00019750: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00019760: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00019770: 6420 7265 7472 6965 7669 6e67 2073 6563  d retrieving sec
-00019780: 7265 7473 207b 7072 6f6a 6563 747d 2f7b  rets {project}/{
-00019790: 7072 6f76 6964 6572 7d22 0a20 2020 2020  provider}".     
-000197a0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
-000197b0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-000197c0: 2020 2020 2020 2022 4745 5422 2c0a 2020         "GET",.  
-000197d0: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-000197e0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-000197f0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-00019800: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-00019810: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-00019820: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
-00019830: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
-00019840: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-00019850: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00019860: 2e53 6563 7265 7473 4461 7461 282a 2a72  .SecretsData(**r
-00019870: 6573 756c 742e 6a73 6f6e 2829 290a 0a20  esult.json()).. 
-00019880: 2020 2064 6566 206c 6973 745f 7072 6f6a     def list_proj
-00019890: 6563 745f 7365 6372 6574 5f6b 6579 7328  ect_secret_keys(
-000198a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-000198b0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-000198c0: 7374 722c 0a20 2020 2020 2020 2070 726f  str,.        pro
-000198d0: 7669 6465 723a 2055 6e69 6f6e 5b0a 2020  vider: Union[.  
-000198e0: 2020 2020 2020 2020 2020 7374 722c 206d            str, m
-000198f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00019900: 6d61 732e 5365 6372 6574 5072 6f76 6964  mas.SecretProvid
-00019910: 6572 4e61 6d65 0a20 2020 2020 2020 205d  erName.        ]
-00019920: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
-00019930: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-00019940: 6f76 6964 6572 4e61 6d65 2e6b 7562 6572  oviderName.kuber
-00019950: 6e65 7465 732c 0a20 2020 2020 2020 2074  netes,.        t
-00019960: 6f6b 656e 3a20 7374 7220 3d20 4e6f 6e65  oken: str = None
-00019970: 2c0a 2020 2020 2920 2d3e 206d 6c72 756e  ,.    ) -> mlrun
-00019980: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00019990: 5365 6372 6574 4b65 7973 4461 7461 3a0a  SecretKeysData:.
-000199a0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
-000199b0: 6576 6520 7072 6f6a 6563 742d 636f 6e74  eve project-cont
-000199c0: 6578 7420 7365 6372 6574 206b 6579 7320  ext secret keys 
-000199d0: 6672 6f6d 2056 6175 6c74 206f 7220 4b75  from Vault or Ku
-000199e0: 6265 726e 6574 6573 2e0a 0a20 2020 2020  bernetes...     
-000199f0: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
-00019a00: 2020 2020 2020 2020 2054 6869 7320 6d65           This me
-00019a10: 7468 6f64 2066 6f72 2056 6175 6c74 2066  thod for Vault f
-00019a20: 756e 6374 696f 6e61 6c69 7479 2069 7320  unctionality is 
-00019a30: 6375 7272 656e 746c 7920 696e 2074 6563  currently in tec
-00019a40: 686e 6963 616c 2070 7265 7669 6577 2c20  hnical preview, 
-00019a50: 616e 6420 7265 7175 6972 6573 2061 2048  and requires a H
-00019a60: 6173 6869 436f 7270 2056 6175 6c74 0a20  ashiCorp Vault. 
-00019a70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019a80: 6e66 7261 7374 7275 6374 7572 6520 7072  nfrastructure pr
-00019a90: 6f70 6572 6c79 2073 6574 2075 7020 616e  operly set up an
-00019aa0: 6420 636f 6e6e 6563 7465 6420 746f 2074  d connected to t
-00019ab0: 6865 204d 4c52 756e 2041 5049 2073 6572  he MLRun API ser
-00019ac0: 7665 722e 0a0a 2020 2020 2020 2020 3a70  ver...        :p
-00019ad0: 6172 616d 2070 726f 6a65 6374 3a20 5468  aram project: Th
-00019ae0: 6520 7072 6f6a 6563 7420 6e61 6d65 2e0a  e project name..
-00019af0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00019b00: 726f 7669 6465 723a 2054 6865 206e 616d  rovider: The nam
-00019b10: 6520 6f66 2074 6865 2073 6563 7265 7473  e of the secrets
-00019b20: 2d70 726f 7669 6465 7220 746f 2077 6f72  -provider to wor
-00019b30: 6b20 7769 7468 2e20 4163 6365 7074 7320  k with. Accepts 
-00019b40: 610a 2020 2020 2020 2020 2020 2020 3a70  a.            :p
-00019b50: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-00019b60: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e73  common.schemas.s
-00019b70: 6563 7265 742e 5365 6372 6574 5072 6f76  ecret.SecretProv
-00019b80: 6964 6572 4e61 6d65 6020 656e 756d 2e0a  iderName` enum..
-00019b90: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-00019ba0: 6f6b 656e 3a20 5661 756c 7420 746f 6b65  oken: Vault toke
-00019bb0: 6e20 746f 2075 7365 2066 6f72 2072 6574  n to use for ret
-00019bc0: 7269 6576 696e 6720 7365 6372 6574 732e  rieving secrets.
-00019bd0: 204f 6e6c 7920 696e 2075 7365 2069 6620   Only in use if 
-00019be0: 6060 7072 6f76 6964 6572 6060 2069 7320  ``provider`` is 
-00019bf0: 6060 7661 756c 7460 602e 0a20 2020 2020  ``vault``..     
-00019c00: 2020 2020 2020 204d 7573 7420 6265 2061         Must be a
-00019c10: 2076 616c 6964 2056 6175 6c74 2074 6f6b   valid Vault tok
-00019c20: 656e 2c20 7769 7468 2070 6572 6d69 7373  en, with permiss
-00019c30: 696f 6e73 2074 6f20 7265 7472 6965 7665  ions to retrieve
-00019c40: 2073 6563 7265 7473 206f 6620 7468 6520   secrets of the 
-00019c50: 7072 6f6a 6563 7420 696e 2071 7565 7374  project in quest
-00019c60: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
-00019c70: 0a0a 2020 2020 2020 2020 6966 2028 0a20  ..        if (. 
-00019c80: 2020 2020 2020 2020 2020 2070 726f 7669             provi
-00019c90: 6465 7220 3d3d 206d 6c72 756e 2e63 6f6d  der == mlrun.com
-00019ca0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-00019cb0: 6574 5072 6f76 6964 6572 4e61 6d65 2e76  etProviderName.v
-00019cc0: 6175 6c74 2e76 616c 7565 0a20 2020 2020  ault.value.     
-00019cd0: 2020 2020 2020 2061 6e64 206e 6f74 2074         and not t
-00019ce0: 6f6b 656e 0a20 2020 2020 2020 2029 3a0a  oken.        ):.
-00019cf0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019d00: 6520 4d4c 5275 6e49 6e76 616c 6964 4172  e MLRunInvalidAr
-00019d10: 6775 6d65 6e74 4572 726f 7228 0a20 2020  gumentError(.   
-00019d20: 2020 2020 2020 2020 2020 2020 2022 4120               "A 
-00019d30: 7661 756c 7420 746f 6b65 6e20 6d75 7374  vault token must
-00019d40: 2062 6520 7072 6f76 6964 6564 2077 6865   be provided whe
-00019d50: 6e20 6163 6365 7373 696e 6720 7661 756c  n accessing vaul
-00019d60: 7420 7365 6372 6574 7322 0a20 2020 2020  t secrets".     
-00019d70: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00019d80: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00019d90: 6374 732f 7b70 726f 6a65 6374 7d2f 7365  cts/{project}/se
-00019da0: 6372 6574 2d6b 6579 7322 0a20 2020 2020  cret-keys".     
-00019db0: 2020 2070 6172 616d 7320 3d20 7b22 7072     params = {"pr
-00019dc0: 6f76 6964 6572 223a 2070 726f 7669 6465  ovider": provide
-00019dd0: 727d 0a20 2020 2020 2020 2068 6561 6465  r}.        heade
-00019de0: 7273 203d 2028 0a20 2020 2020 2020 2020  rs = (.         
-00019df0: 2020 207b 6d6c 7275 6e2e 636f 6d6d 6f6e     {mlrun.common
-00019e00: 2e73 6368 656d 6173 2e48 6561 6465 724e  .schemas.HeaderN
-00019e10: 616d 6573 2e73 6563 7265 745f 7374 6f72  ames.secret_stor
-00019e20: 655f 746f 6b65 6e3a 2074 6f6b 656e 7d0a  e_token: token}.
-00019e30: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00019e40: 726f 7669 6465 7220 3d3d 206d 6c72 756e  rovider == mlrun
-00019e50: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00019e60: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-00019e70: 6d65 2e76 6175 6c74 2e76 616c 7565 0a20  me.vault.value. 
-00019e80: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00019e90: 4e6f 6e65 0a20 2020 2020 2020 2029 0a20  None.        ). 
-00019ea0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00019eb0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00019ec0: 7265 7472 6965 7669 6e67 2073 6563 7265  retrieving secre
-00019ed0: 7420 6b65 7973 207b 7072 6f6a 6563 747d  t keys {project}
-00019ee0: 2f7b 7072 6f76 6964 6572 7d22 0a20 2020  /{provider}".   
-00019ef0: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
-00019f00: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00019f10: 2020 2020 2020 2020 2022 4745 5422 2c0a           "GET",.
-00019f20: 2020 2020 2020 2020 2020 2020 7061 7468              path
-00019f30: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
-00019f40: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
-00019f50: 2020 2020 2020 2020 2070 6172 616d 733d           params=
-00019f60: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00019f70: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
-00019f80: 6572 732c 0a20 2020 2020 2020 2029 0a20  ers,.        ). 
-00019f90: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
-00019fa0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00019fb0: 6173 2e53 6563 7265 744b 6579 7344 6174  as.SecretKeysDat
-00019fc0: 6128 2a2a 7265 7375 6c74 2e6a 736f 6e28  a(**result.json(
-00019fd0: 2929 0a0a 2020 2020 6465 6620 6465 6c65  ))..    def dele
-00019fe0: 7465 5f70 726f 6a65 6374 5f73 6563 7265  te_project_secre
-00019ff0: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
-0001a000: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0001a010: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0001a020: 7072 6f76 6964 6572 3a20 556e 696f 6e5b  provider: Union[
-0001a030: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0001a040: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-0001a050: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-0001a060: 7669 6465 724e 616d 650a 2020 2020 2020  viderName.      
-0001a070: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
-0001a080: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
-0001a090: 7450 726f 7669 6465 724e 616d 652e 6b75  tProviderName.ku
-0001a0a0: 6265 726e 6574 6573 2c0a 2020 2020 2020  bernetes,.      
-0001a0b0: 2020 7365 6372 6574 733a 204c 6973 745b    secrets: List[
-0001a0c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0001a0d0: 2029 3a0a 2020 2020 2020 2020 2222 2244   ):.        """D
-0001a0e0: 656c 6574 6520 7072 6f6a 6563 742d 636f  elete project-co
-0001a0f0: 6e74 6578 7420 7365 6372 6574 7320 6672  ntext secrets fr
-0001a100: 6f6d 204b 7562 6572 6e65 7465 732e 0a0a  om Kubernetes...
-0001a110: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001a120: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
-0001a130: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
-0001a140: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
-0001a150: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
-0001a160: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
-0001a170: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
-0001a180: 2e20 4375 7272 656e 746c 7920 6f6e 6c79  . Currently only
-0001a190: 2060 606b 7562 6572 6e65 7465 7360 6020   ``kubernetes`` 
-0001a1a0: 6973 2073 7570 706f 7274 6564 2e0a 2020  is supported..  
-0001a1b0: 2020 2020 2020 3a70 6172 616d 2073 6563        :param sec
-0001a1c0: 7265 7473 3a20 4120 6c69 7374 206f 6620  rets: A list of 
-0001a1d0: 7365 6372 6574 206e 616d 6573 2074 6f20  secret names to 
-0001a1e0: 6465 6c65 7465 2e20 416e 2065 6d70 7479  delete. An empty
-0001a1f0: 206c 6973 7420 7769 6c6c 2064 656c 6574   list will delet
-0001a200: 6520 616c 6c20 7365 6372 6574 7320 6173  e all secrets as
-0001a210: 7369 676e 6564 0a20 2020 2020 2020 2020  signed.         
-0001a220: 2020 2074 6f20 7468 6973 2073 7065 6369     to this speci
-0001a230: 6669 6320 7072 6f6a 6563 742e 0a20 2020  fic project..   
-0001a240: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001a250: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0001a260: 6374 732f 7b70 726f 6a65 6374 7d2f 7365  cts/{project}/se
-0001a270: 6372 6574 7322 0a20 2020 2020 2020 2070  crets".        p
-0001a280: 6172 616d 7320 3d20 7b22 7072 6f76 6964  arams = {"provid
-0001a290: 6572 223a 2070 726f 7669 6465 722c 2022  er": provider, "
-0001a2a0: 7365 6372 6574 223a 2073 6563 7265 7473  secret": secrets
-0001a2b0: 7d0a 2020 2020 2020 2020 6572 726f 725f  }.        error_
-0001a2c0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0001a2d0: 6564 2064 656c 6574 696e 6720 7365 6372  ed deleting secr
-0001a2e0: 6574 7320 7b70 726f 6a65 6374 7d2f 7b70  ets {project}/{p
-0001a2f0: 726f 7669 6465 727d 220a 2020 2020 2020  rovider}".      
-0001a300: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-0001a310: 0a20 2020 2020 2020 2020 2020 2022 4445  .            "DE
-0001a320: 4c45 5445 222c 0a20 2020 2020 2020 2020  LETE",.         
-0001a330: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
-0001a340: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0001a350: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-0001a360: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
-0001a370: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0001a380: 6620 6372 6561 7465 5f75 7365 725f 7365  f create_user_se
-0001a390: 6372 6574 7328 0a20 2020 2020 2020 2073  crets(.        s
-0001a3a0: 656c 662c 0a20 2020 2020 2020 2075 7365  elf,.        use
-0001a3b0: 723a 2073 7472 2c0a 2020 2020 2020 2020  r: str,.        
-0001a3c0: 7072 6f76 6964 6572 3a20 556e 696f 6e5b  provider: Union[
-0001a3d0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0001a3e0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-0001a3f0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-0001a400: 7669 6465 724e 616d 650a 2020 2020 2020  viderName.      
-0001a410: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
-0001a420: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
-0001a430: 7450 726f 7669 6465 724e 616d 652e 7661  tProviderName.va
-0001a440: 756c 742c 0a20 2020 2020 2020 2073 6563  ult,.        sec
-0001a450: 7265 7473 3a20 6469 6374 203d 204e 6f6e  rets: dict = Non
-0001a460: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0001a470: 2020 2222 2243 7265 6174 6520 7573 6572    """Create user
-0001a480: 2d63 6f6e 7465 7874 2073 6563 7265 7420  -context secret 
-0001a490: 696e 2056 6175 6c74 2e20 506c 6561 7365  in Vault. Please
-0001a4a0: 2072 6566 6572 2074 6f20 3a70 793a 6675   refer to :py:fu
-0001a4b0: 6e63 3a60 6372 6561 7465 5f70 726f 6a65  nc:`create_proje
-0001a4c0: 6374 5f73 6563 7265 7473 6020 666f 7220  ct_secrets` for 
-0001a4d0: 6d6f 7265 2064 6574 6169 6c73 0a20 2020  more details.   
-0001a4e0: 2020 2020 2061 6e64 2073 7461 7475 7320       and status 
-0001a4f0: 6f66 2074 6869 7320 6675 6e63 7469 6f6e  of this function
-0001a500: 616c 6974 792e 0a0a 2020 2020 2020 2020  ality...        
-0001a510: 4e6f 7465 3a0a 2020 2020 2020 2020 2020  Note:.          
-0001a520: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-0001a530: 6420 6973 2063 7572 7265 6e74 6c79 2069  d is currently i
-0001a540: 6e20 7465 6368 6e69 6361 6c20 7072 6576  n technical prev
-0001a550: 6965 772c 2061 6e64 2072 6571 7569 7265  iew, and require
-0001a560: 7320 6120 4861 7368 6943 6f72 7020 5661  s a HashiCorp Va
-0001a570: 756c 7420 696e 6672 6173 7472 7563 7475  ult infrastructu
-0001a580: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
-0001a590: 2020 2070 726f 7065 726c 7920 7365 7420     properly set 
-0001a5a0: 7570 2061 6e64 2063 6f6e 6e65 6374 6564  up and connected
-0001a5b0: 2074 6f20 7468 6520 4d4c 5275 6e20 4150   to the MLRun AP
-0001a5c0: 4920 7365 7276 6572 2e0a 0a20 2020 2020  I server...     
-0001a5d0: 2020 203a 7061 7261 6d20 7573 6572 3a20     :param user: 
-0001a5e0: 5468 6520 7573 6572 2063 6f6e 7465 7874  The user context
-0001a5f0: 2066 6f72 2077 6869 6368 2074 6f20 6765   for which to ge
-0001a600: 6e65 7261 7465 2074 6865 2069 6e66 7261  nerate the infra
-0001a610: 2061 6e64 2073 746f 7265 2073 6563 7265   and store secre
-0001a620: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-0001a630: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
-0001a640: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
-0001a650: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
-0001a660: 2077 6f72 6b20 7769 7468 2e20 4375 7272   work with. Curr
-0001a670: 656e 746c 7920 6f6e 6c79 2060 6076 6175  ently only ``vau
-0001a680: 6c74 6060 2069 7320 7375 7070 6f72 7465  lt`` is supporte
-0001a690: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-0001a6a0: 6d20 7365 6372 6574 733a 2041 2073 6574  m secrets: A set
-0001a6b0: 206f 6620 7365 6372 6574 2076 616c 7565   of secret value
-0001a6c0: 7320 746f 2073 746f 7265 2077 6974 6869  s to store withi
-0001a6d0: 6e20 7468 6520 5661 756c 742e 0a20 2020  n the Vault..   
-0001a6e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001a6f0: 2070 6174 6820 3d20 2275 7365 722d 7365   path = "user-se
-0001a700: 6372 6574 7322 0a20 2020 2020 2020 2073  crets".        s
-0001a710: 6563 7265 7473 5f63 7265 6174 696f 6e5f  ecrets_creation_
-0001a720: 7265 7175 6573 7420 3d20 6d6c 7275 6e2e  request = mlrun.
-0001a730: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e55  common.schemas.U
-0001a740: 7365 7253 6563 7265 7443 7265 6174 696f  serSecretCreatio
-0001a750: 6e52 6571 7565 7374 280a 2020 2020 2020  nRequest(.      
-0001a760: 2020 2020 2020 7573 6572 3d75 7365 722c        user=user,
-0001a770: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-0001a780: 7669 6465 723d 7072 6f76 6964 6572 2c0a  vider=provider,.
-0001a790: 2020 2020 2020 2020 2020 2020 7365 6372              secr
-0001a7a0: 6574 733d 7365 6372 6574 732c 0a20 2020  ets=secrets,.   
-0001a7b0: 2020 2020 2029 0a20 2020 2020 2020 2062       ).        b
-0001a7c0: 6f64 7920 3d20 7365 6372 6574 735f 6372  ody = secrets_cr
-0001a7d0: 6561 7469 6f6e 5f72 6571 7565 7374 2e64  eation_request.d
-0001a7e0: 6963 7428 290a 2020 2020 2020 2020 6572  ict().        er
-0001a7f0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0001a800: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
-0001a810: 7573 6572 2073 6563 7265 7473 202d 207b  user secrets - {
-0001a820: 7573 6572 7d22 0a20 2020 2020 2020 2073  user}".        s
-0001a830: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0001a840: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
-0001a850: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001a860: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0001a870: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-0001a880: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
-0001a890: 6469 6374 5f74 6f5f 6a73 6f6e 2862 6f64  dict_to_json(bod
-0001a8a0: 7929 2c0a 2020 2020 2020 2020 290a 0a20  y),.        ).. 
-0001a8b0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-0001a8c0: 0a20 2020 2064 6566 205f 7661 6c69 6461  .    def _valida
-0001a8d0: 7465 5f76 6572 7369 6f6e 5f63 6f6d 7061  te_version_compa
-0001a8e0: 7469 6269 6c69 7479 2873 6572 7665 725f  tibility(server_
-0001a8f0: 7665 7273 696f 6e2c 2063 6c69 656e 745f  version, client_
-0001a900: 7665 7273 696f 6e29 202d 3e20 626f 6f6c  version) -> bool
-0001a910: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0001a920: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001a930: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001a940: 203d 2073 656d 7665 722e 5665 7273 696f   = semver.Versio
-0001a950: 6e49 6e66 6f2e 7061 7273 6528 7365 7276  nInfo.parse(serv
-0001a960: 6572 5f76 6572 7369 6f6e 290a 2020 2020  er_version).    
-0001a970: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
-0001a980: 6c69 656e 745f 7665 7273 696f 6e20 3d20  lient_version = 
-0001a990: 7365 6d76 6572 2e56 6572 7369 6f6e 496e  semver.VersionIn
-0001a9a0: 666f 2e70 6172 7365 2863 6c69 656e 745f  fo.parse(client_
-0001a9b0: 7665 7273 696f 6e29 0a20 2020 2020 2020  version).       
-0001a9c0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-0001a9d0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0001a9e0: 2320 5468 6973 2077 696c 6c20 6d6f 7374  # This will most
-0001a9f0: 6c79 2068 6170 7065 6e20 696e 2064 6576  ly happen in dev
-0001aa00: 2073 6365 6e61 7269 6f73 2077 6865 6e20   scenarios when 
-0001aa10: 7468 6520 7665 7273 696f 6e20 6973 2075  the version is u
-0001aa20: 6e73 7461 626c 6520 616e 6420 7375 6368  nstable and such
-0001aa30: 202d 2074 6865 7265 666f 7265 2077 6527   - therefore we'
-0001aa40: 7265 2069 676e 6f72 696e 670a 2020 2020  re ignoring.    
-0001aa50: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
-0001aa60: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
-0001aa70: 2020 2020 2020 2020 2255 6e61 626c 6520          "Unable 
-0001aa80: 746f 2070 6172 7365 2073 6572 7665 7220  to parse server 
-0001aa90: 6f72 2063 6c69 656e 7420 7665 7273 696f  or client versio
-0001aaa0: 6e2e 2041 7373 756d 696e 6720 636f 6d70  n. Assuming comp
-0001aab0: 6174 6962 6c65 222c 0a20 2020 2020 2020  atible",.       
-0001aac0: 2020 2020 2020 2020 2073 6572 7665 725f           server_
-0001aad0: 7665 7273 696f 6e3d 7365 7276 6572 5f76  version=server_v
-0001aae0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001aaf0: 2020 2020 2020 2020 636c 6965 6e74 5f76          client_v
-0001ab00: 6572 7369 6f6e 3d63 6c69 656e 745f 7665  ersion=client_ve
-0001ab10: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001ab20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001ab30: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
-0001ab40: 2020 2020 2069 6620 2870 6172 7365 645f       if (parsed_
-0001ab50: 7365 7276 6572 5f76 6572 7369 6f6e 2e6d  server_version.m
-0001ab60: 616a 6f72 203d 3d20 3020 616e 6420 7061  ajor == 0 and pa
-0001ab70: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
-0001ab80: 696f 6e2e 6d69 6e6f 7220 3d3d 2030 2920  ion.minor == 0) 
-0001ab90: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
-0001aba0: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
-0001abb0: 6572 7369 6f6e 2e6d 616a 6f72 203d 3d20  ersion.major == 
-0001abc0: 3020 616e 6420 7061 7273 6564 5f63 6c69  0 and parsed_cli
-0001abd0: 656e 745f 7665 7273 696f 6e2e 6d69 6e6f  ent_version.mino
-0001abe0: 7220 3d3d 2030 0a20 2020 2020 2020 2029  r == 0.        )
-0001abf0: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0001ac00: 6767 6572 2e77 6172 6e69 6e67 280a 2020  gger.warning(.  
-0001ac10: 2020 2020 2020 2020 2020 2020 2020 2253                "S
-0001ac20: 6572 7665 7220 6f72 2063 6c69 656e 7420  erver or client 
-0001ac30: 7665 7273 696f 6e20 6973 2075 6e73 7461  version is unsta
-0001ac40: 626c 652e 2041 7373 756d 696e 6720 636f  ble. Assuming co
-0001ac50: 6d70 6174 6962 6c65 222c 0a20 2020 2020  mpatible",.     
-0001ac60: 2020 2020 2020 2020 2020 2073 6572 7665             serve
-0001ac70: 725f 7665 7273 696f 6e3d 7365 7276 6572  r_version=server
-0001ac80: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
-0001ac90: 2020 2020 2020 2020 2020 636c 6965 6e74            client
-0001aca0: 5f76 6572 7369 6f6e 3d63 6c69 656e 745f  _version=client_
-0001acb0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-0001acc0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001acd0: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
-0001ace0: 2020 2020 2020 2069 6620 7061 7273 6564         if parsed
-0001acf0: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
-0001ad00: 6d61 6a6f 7220 213d 2070 6172 7365 645f  major != parsed_
-0001ad10: 636c 6965 6e74 5f76 6572 7369 6f6e 2e6d  client_version.m
-0001ad20: 616a 6f72 3a0a 2020 2020 2020 2020 2020  ajor:.          
-0001ad30: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
-0001ad40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001ad50: 2020 2253 6572 7665 7220 616e 6420 636c    "Server and cl
-0001ad60: 6965 6e74 2076 6572 7369 6f6e 7320 6172  ient versions ar
-0001ad70: 6520 696e 636f 6d70 6174 6962 6c65 222c  e incompatible",
-0001ad80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ad90: 2070 6172 7365 645f 7365 7276 6572 5f76   parsed_server_v
-0001ada0: 6572 7369 6f6e 3d70 6172 7365 645f 7365  ersion=parsed_se
-0001adb0: 7276 6572 5f76 6572 7369 6f6e 2c0a 2020  rver_version,.  
-0001adc0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0001add0: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001ade0: 696f 6e3d 7061 7273 6564 5f63 6c69 656e  ion=parsed_clien
-0001adf0: 745f 7665 7273 696f 6e2c 0a20 2020 2020  t_version,.     
-0001ae00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ae10: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
-0001ae20: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
-0001ae30: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
-0001ae40: 6f6e 2e6d 696e 6f72 203e 2070 6172 7365  on.minor > parse
-0001ae50: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001ae60: 2e6d 696e 6f72 202b 2032 3a0a 2020 2020  .minor + 2:.    
-0001ae70: 2020 2020 2020 2020 6c6f 6767 6572 2e69          logger.i
-0001ae80: 6e66 6f28 0a20 2020 2020 2020 2020 2020  nfo(.           
-0001ae90: 2020 2020 2022 4261 636b 7761 7264 7320       "Backwards 
-0001aea0: 636f 6d70 6174 6962 696c 6974 7920 6d69  compatibility mi
-0001aeb0: 6768 7420 6e6f 7420 6170 706c 7920 6265  ght not apply be
-0001aec0: 7477 6565 6e20 7468 6520 7365 7276 6572  tween the server
-0001aed0: 2061 6e64 2063 6c69 656e 7420 7665 7273   and client vers
-0001aee0: 696f 6e22 2c0a 2020 2020 2020 2020 2020  ion",.          
-0001aef0: 2020 2020 2020 7061 7273 6564 5f73 6572        parsed_ser
-0001af00: 7665 725f 7665 7273 696f 6e3d 7061 7273  ver_version=pars
-0001af10: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
-0001af20: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001af30: 2020 2070 6172 7365 645f 636c 6965 6e74     parsed_client
-0001af40: 5f76 6572 7369 6f6e 3d70 6172 7365 645f  _version=parsed_
-0001af50: 636c 6965 6e74 5f76 6572 7369 6f6e 2c0a  client_version,.
-0001af60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001af70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001af80: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-0001af90: 6620 7061 7273 6564 5f63 6c69 656e 745f  f parsed_client_
-0001afa0: 7665 7273 696f 6e2e 6d69 6e6f 7220 3e20  version.minor > 
-0001afb0: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001afc0: 7273 696f 6e2e 6d69 6e6f 723a 0a20 2020  rsion.minor:.   
-0001afd0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-0001afe0: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
-0001aff0: 2020 2020 2020 2020 2022 436c 6965 6e74           "Client
-0001b000: 2076 6572 7369 6f6e 2077 6974 6820 6869   version with hi
-0001b010: 6768 6572 2076 6572 7369 6f6e 2074 6861  gher version tha
-0001b020: 6e20 7365 7276 6572 2076 6572 7369 6f6e  n server version
-0001b030: 2069 736e 2774 2073 7570 706f 7274 6564   isn't supported
-0001b040: 2c22 0a20 2020 2020 2020 2020 2020 2020  ,".             
-0001b050: 2020 2022 2061 6c69 676e 2079 6f75 7220     " align your 
-0001b060: 636c 6965 6e74 2074 6f20 7468 6520 7365  client to the se
-0001b070: 7276 6572 2076 6572 7369 6f6e 222c 0a20  rver version",. 
-0001b080: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001b090: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
-0001b0a0: 7369 6f6e 3d70 6172 7365 645f 7365 7276  sion=parsed_serv
-0001b0b0: 6572 5f76 6572 7369 6f6e 2c0a 2020 2020  er_version,.    
-0001b0c0: 2020 2020 2020 2020 2020 2020 7061 7273              pars
-0001b0d0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
-0001b0e0: 6e3d 7061 7273 6564 5f63 6c69 656e 745f  n=parsed_client_
-0001b0f0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-0001b100: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001b110: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-0001b120: 2020 2020 2020 2020 6966 2070 6172 7365          if parse
-0001b130: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001b140: 2e6d 696e 6f72 2021 3d20 7061 7273 6564  .minor != parsed
-0001b150: 5f63 6c69 656e 745f 7665 7273 696f 6e2e  _client_version.
-0001b160: 6d69 6e6f 723a 0a20 2020 2020 2020 2020  minor:.         
-0001b170: 2020 206c 6f67 6765 722e 696e 666f 280a     logger.info(.
-0001b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b190: 2253 6572 7665 7220 616e 6420 636c 6965  "Server and clie
-0001b1a0: 6e74 2076 6572 7369 6f6e 7320 6172 6520  nt versions are 
-0001b1b0: 6e6f 7420 7468 6520 7361 6d65 2062 7574  not the same but
-0001b1c0: 2063 6f6d 7061 7469 626c 6522 2c0a 2020   compatible",.  
-0001b1d0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0001b1e0: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
-0001b1f0: 696f 6e3d 7061 7273 6564 5f73 6572 7665  ion=parsed_serve
-0001b200: 725f 7665 7273 696f 6e2c 0a20 2020 2020  r_version,.     
-0001b210: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001b220: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001b230: 3d70 6172 7365 645f 636c 6965 6e74 5f76  =parsed_client_v
-0001b240: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001b250: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0001b260: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
-0001b270: 6566 2063 7265 6174 655f 6d6f 6465 6c5f  ef create_model_
-0001b280: 656e 6470 6f69 6e74 280a 2020 2020 2020  endpoint(.      
-0001b290: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001b2a0: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-0001b2b0: 2020 2020 2020 656e 6470 6f69 6e74 5f69        endpoint_i
-0001b2c0: 643a 2073 7472 2c0a 2020 2020 2020 2020  d: str,.        
-0001b2d0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 3a20  model_endpoint: 
-0001b2e0: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
-0001b2f0: 2020 206d 6c72 756e 2e6d 6f64 656c 5f6d     mlrun.model_m
-0001b300: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
-0001b310: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
-0001b320: 6470 6f69 6e74 2c20 6469 6374 0a20 2020  dpoint, dict.   
-0001b330: 2020 2020 205d 2c0a 2020 2020 293a 0a20       ],.    ):. 
-0001b340: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001b350: 2020 2043 7265 6174 6573 2061 2044 4220     Creates a DB 
-0001b360: 7265 636f 7264 2077 6974 6820 7468 6520  record with the 
-0001b370: 6769 7665 6e20 6d6f 6465 6c5f 656e 6470  given model_endp
-0001b380: 6f69 6e74 2072 6563 6f72 642e 0a0a 2020  oint record...  
-0001b390: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0001b3a0: 6a65 6374 3a20 5468 6520 6e61 6d65 206f  ject: The name o
-0001b3b0: 6620 7468 6520 7072 6f6a 6563 742e 0a20  f the project.. 
-0001b3c0: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-0001b3d0: 6470 6f69 6e74 5f69 643a 2054 6865 2069  dpoint_id: The i
-0001b3e0: 6420 6f66 2074 6865 2065 6e64 706f 696e  d of the endpoin
-0001b3f0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0001b400: 6d20 6d6f 6465 6c5f 656e 6470 6f69 6e74  m model_endpoint
-0001b410: 3a20 416e 206f 626a 6563 7420 7265 7072  : An object repr
-0001b420: 6573 656e 7469 6e67 2074 6865 206d 6f64  esenting the mod
-0001b430: 656c 2065 6e64 706f 696e 742e 0a20 2020  el endpoint..   
-0001b440: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001b450: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001b460: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-0001b470: 656c 5f65 6e64 706f 696e 742c 206d 6c72  el_endpoint, mlr
-0001b480: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
-0001b490: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
-0001b4a0: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
-0001b4b0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0001b4c0: 2020 2020 2020 2020 6d6f 6465 6c5f 656e          model_en
-0001b4d0: 6470 6f69 6e74 203d 206d 6f64 656c 5f65  dpoint = model_e
-0001b4e0: 6e64 706f 696e 742e 746f 5f64 6963 7428  ndpoint.to_dict(
-0001b4f0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
-0001b500: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-0001b510: 6f6a 6563 747d 2f6d 6f64 656c 2d65 6e64  oject}/model-end
-0001b520: 706f 696e 7473 2f7b 656e 6470 6f69 6e74  points/{endpoint
-0001b530: 5f69 647d 220a 2020 2020 2020 2020 7365  _id}".        se
-0001b540: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-0001b550: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-0001b560: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
-0001b570: 2020 2020 7061 7468 3d70 6174 682c 0a20      path=path,. 
-0001b580: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
-0001b590: 6469 6374 5f74 6f5f 6a73 6f6e 286d 6f64  dict_to_json(mod
-0001b5a0: 656c 5f65 6e64 706f 696e 7429 2c0a 2020  el_endpoint),.  
-0001b5b0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0001b5c0: 2064 656c 6574 655f 6d6f 6465 6c5f 656e   delete_model_en
-0001b5d0: 6470 6f69 6e74 280a 2020 2020 2020 2020  dpoint(.        
-0001b5e0: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-0001b5f0: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-0001b600: 2020 2020 656e 6470 6f69 6e74 5f69 643a      endpoint_id:
-0001b610: 2073 7472 2c0a 2020 2020 293a 0a20 2020   str,.    ):.   
-0001b620: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001b630: 2044 656c 6574 6573 2074 6865 2044 4220   Deletes the DB 
-0001b640: 7265 636f 7264 206f 6620 6120 6769 7665  record of a give
-0001b650: 6e20 6d6f 6465 6c20 656e 6470 6f69 6e74  n model endpoint
-0001b660: 2c20 7072 6f6a 6563 7420 616e 6420 656e  , project and en
-0001b670: 6470 6f69 6e74 5f69 6420 6172 6520 7573  dpoint_id are us
-0001b680: 6564 2066 6f72 206c 6f6f 6b75 700a 0a20  ed for lookup.. 
-0001b690: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-0001b6a0: 6f6a 6563 743a 2054 6865 206e 616d 6520  oject: The name 
-0001b6b0: 6f66 2074 6865 2070 726f 6a65 6374 0a20  of the project. 
-0001b6c0: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-0001b6d0: 6470 6f69 6e74 5f69 643a 2054 6865 2069  dpoint_id: The i
-0001b6e0: 6420 6f66 2074 6865 2065 6e64 706f 696e  d of the endpoin
-0001b6f0: 740a 2020 2020 2020 2020 2222 220a 0a20  t.        """.. 
-0001b700: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001b710: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001b720: 747d 2f6d 6f64 656c 2d65 6e64 706f 696e  t}/model-endpoin
-0001b730: 7473 2f7b 656e 6470 6f69 6e74 5f69 647d  ts/{endpoint_id}
-0001b740: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0001b750: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001b760: 2020 2020 206d 6574 686f 643d 2244 454c       method="DEL
-0001b770: 4554 4522 2c0a 2020 2020 2020 2020 2020  ETE",.          
-0001b780: 2020 7061 7468 3d70 6174 682c 0a20 2020    path=path,.   
-0001b790: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001b7a0: 6c69 7374 5f6d 6f64 656c 5f65 6e64 706f  list_model_endpo
-0001b7b0: 696e 7473 280a 2020 2020 2020 2020 7365  ints(.        se
-0001b7c0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0001b7d0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-0001b7e0: 2020 6d6f 6465 6c3a 204f 7074 696f 6e61    model: Optiona
-0001b7f0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0001b800: 2020 2020 2020 2066 756e 6374 696f 6e3a         function:
-0001b810: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0001b820: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-0001b830: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
-0001b840: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001b850: 2073 7461 7274 3a20 7374 7220 3d20 226e   start: str = "n
-0001b860: 6f77 2d31 6822 2c0a 2020 2020 2020 2020  ow-1h",.        
-0001b870: 656e 643a 2073 7472 203d 2022 6e6f 7722  end: str = "now"
-0001b880: 2c0a 2020 2020 2020 2020 6d65 7472 6963  ,.        metric
-0001b890: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0001b8a0: 5b73 7472 5d5d 203d 204e 6f6e 652c 0a20  [str]] = None,. 
-0001b8b0: 2020 2020 2020 2074 6f70 5f6c 6576 656c         top_level
-0001b8c0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0001b8d0: 2020 2020 2020 2020 7569 6473 3a20 4f70          uids: Op
-0001b8e0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-0001b8f0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-0001b900: 2d3e 204c 6973 745b 6d6c 7275 6e2e 6d6f  -> List[mlrun.mo
-0001b910: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
-0001b920: 6f64 656c 5f65 6e64 706f 696e 742e 4d6f  odel_endpoint.Mo
-0001b930: 6465 6c45 6e64 706f 696e 745d 3a0a 2020  delEndpoint]:.  
-0001b940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001b950: 2020 5265 7475 726e 7320 6120 6c69 7374    Returns a list
-0001b960: 206f 6620 604d 6f64 656c 456e 6470 6f69   of `ModelEndpoi
-0001b970: 6e74 6020 6f62 6a65 6374 732e 2045 6163  nt` objects. Eac
-0001b980: 6820 604d 6f64 656c 456e 6470 6f69 6e74  h `ModelEndpoint
-0001b990: 6020 6f62 6a65 6374 2072 6570 7265 7365  ` object represe
-0001b9a0: 6e74 7320 7468 6520 6375 7272 656e 7420  nts the current 
-0001b9b0: 7374 6174 6520 6f66 2061 0a20 2020 2020  state of a.     
-0001b9c0: 2020 206d 6f64 656c 2065 6e64 706f 696e     model endpoin
-0001b9d0: 742e 2054 6869 7320 6675 6e63 7469 6f6e  t. This function
-0001b9e0: 7320 7375 7070 6f72 7473 2066 696c 7465  s supports filte
-0001b9f0: 7269 6e67 2062 7920 7468 6520 666f 6c6c  ring by the foll
-0001ba00: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
-0001ba10: 3a0a 2020 2020 2020 2020 3129 206d 6f64  :.        1) mod
-0001ba20: 656c 0a20 2020 2020 2020 2032 2920 6675  el.        2) fu
-0001ba30: 6e63 7469 6f6e 0a20 2020 2020 2020 2033  nction.        3
-0001ba40: 2920 6c61 6265 6c73 0a20 2020 2020 2020  ) labels.       
-0001ba50: 2034 2920 746f 7020 6c65 7665 6c0a 2020   4) top level.  
-0001ba60: 2020 2020 2020 3529 2075 6964 730a 2020        5) uids.  
-0001ba70: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
-0001ba80: 2c20 7768 656e 206e 6f20 6669 6c74 6572  , when no filter
-0001ba90: 7320 6172 6520 6170 706c 6965 642c 2061  s are applied, a
-0001baa0: 6c6c 2061 7661 696c 6162 6c65 2065 6e64  ll available end
-0001bab0: 706f 696e 7473 2066 6f72 2074 6865 2067  points for the g
-0001bac0: 6976 656e 2070 726f 6a65 6374 2077 696c  iven project wil
-0001bad0: 6c20 6265 206c 6973 7465 642e 0a0a 2020  l be listed...  
-0001bae0: 2020 2020 2020 496e 2061 6464 6974 696f        In additio
-0001baf0: 6e2c 2074 6869 7320 6675 6e63 7469 6f6e  n, this function
-0001bb00: 7320 7072 6f76 6964 6573 2061 2066 6163  s provides a fac
-0001bb10: 6164 6520 666f 7220 6c69 7374 696e 6720  ade for listing 
-0001bb20: 656e 6470 6f69 6e74 2072 656c 6174 6564  endpoint related
-0001bb30: 206d 6574 7269 6373 2e20 5468 6973 2066   metrics. This f
-0001bb40: 6163 6164 6520 6973 2074 696d 652d 6261  acade is time-ba
-0001bb50: 7365 640a 2020 2020 2020 2020 616e 6420  sed.        and 
-0001bb60: 6465 7065 6e64 7320 6f6e 2074 6865 2027  depends on the '
-0001bb70: 7374 6172 7427 2061 6e64 2027 656e 6427  start' and 'end'
-0001bb80: 2070 6172 616d 6574 6572 732e 2042 7920   parameters. By 
-0001bb90: 6465 6661 756c 742c 2077 6865 6e20 7468  default, when th
-0001bba0: 6520 6d65 7472 6963 7320 7061 7261 6d65  e metrics parame
-0001bbb0: 7465 7220 6973 204e 6f6e 652c 206e 6f20  ter is None, no 
-0001bbc0: 6d65 7472 6963 7320 6172 650a 2020 2020  metrics are.    
-0001bbd0: 2020 2020 6164 6465 6420 746f 2074 6865      added to the
-0001bbe0: 206f 7574 7075 7420 6f66 2074 6869 7320   output of this 
-0001bbf0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
-0001bc00: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-0001bc10: 743a 2054 6865 206e 616d 6520 6f66 2074  t: The name of t
-0001bc20: 6865 2070 726f 6a65 6374 0a20 2020 2020  he project.     
-0001bc30: 2020 203a 7061 7261 6d20 6d6f 6465 6c3a     :param model:
-0001bc40: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-0001bc50: 206d 6f64 656c 2074 6f20 6669 6c74 6572   model to filter
-0001bc60: 2062 790a 2020 2020 2020 2020 3a70 6172   by.        :par
-0001bc70: 616d 2066 756e 6374 696f 6e3a 2054 6865  am function: The
-0001bc80: 206e 616d 6520 6f66 2074 6865 2066 756e   name of the fun
-0001bc90: 6374 696f 6e20 746f 2066 696c 7465 7220  ction to filter 
-0001bca0: 6279 0a20 2020 2020 2020 203a 7061 7261  by.        :para
-0001bcb0: 6d20 6c61 6265 6c73 3a20 4120 6c69 7374  m labels: A list
-0001bcc0: 206f 6620 6c61 6265 6c73 2074 6f20 6669   of labels to fi
-0001bcd0: 6c74 6572 2062 792e 204c 6162 656c 2066  lter by. Label f
-0001bce0: 696c 7465 7273 2077 6f72 6b20 6279 2065  ilters work by e
-0001bcf0: 6974 6865 7220 6669 6c74 6572 696e 6720  ither filtering 
-0001bd00: 6120 7370 6563 6966 6963 2076 616c 7565  a specific value
-0001bd10: 206f 6620 610a 2020 2020 2020 2020 206c   of a.         l
-0001bd20: 6162 656c 2028 692e 652e 206c 6973 7428  abel (i.e. list(
-0001bd30: 226b 6579 3d76 616c 7565 2229 2920 6f72  "key=value")) or
-0001bd40: 2062 7920 6c6f 6f6b 696e 6720 666f 7220   by looking for 
-0001bd50: 7468 6520 6578 6973 7465 6e63 6520 6f66  the existence of
-0001bd60: 2061 2067 6976 656e 206b 6579 2028 692e   a given key (i.
-0001bd70: 652e 2022 6b65 7922 290a 2020 2020 2020  e. "key").      
-0001bd80: 2020 3a70 6172 616d 206d 6574 7269 6373    :param metrics
-0001bd90: 3a20 4120 6c69 7374 206f 6620 6d65 7472  : A list of metr
-0001bda0: 6963 7320 746f 2072 6574 7572 6e20 666f  ics to return fo
-0001bdb0: 7220 6561 6368 2065 6e64 706f 696e 742c  r each endpoint,
-0001bdc0: 2072 6561 6420 6d6f 7265 2069 6e20 2754   read more in 'T
-0001bdd0: 696d 654d 6574 7269 6327 0a20 2020 2020  imeMetric'.     
-0001bde0: 2020 203a 7061 7261 6d20 7374 6172 743a     :param start:
-0001bdf0: 2054 6865 2073 7461 7274 2074 696d 6520   The start time 
-0001be00: 6f66 2074 6865 206d 6574 7269 6373 2e20  of the metrics. 
-0001be10: 4361 6e20 6265 2072 6570 7265 7365 6e74  Can be represent
-0001be20: 6564 2062 7920 6120 7374 7269 6e67 2063  ed by a string c
-0001be30: 6f6e 7461 696e 696e 6720 616e 2052 4643  ontaining an RFC
-0001be40: 2033 3333 390a 2020 2020 2020 2020 2020   3339.          
-0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be60: 2020 2020 2020 2074 696d 652c 2061 2055         time, a U
-0001be70: 6e69 7820 7469 6d65 7374 616d 7020 696e  nix timestamp in
-0001be80: 206d 696c 6c69 7365 636f 6e64 732c 2061   milliseconds, a
-0001be90: 2072 656c 6174 6976 6520 7469 6d65 2028   relative time (
-0001bea0: 6027 6e6f 7727 6020 6f72 0a20 2020 2020  `'now'` or.     
-0001beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bec0: 2020 2020 2020 2020 2020 2020 6027 6e6f              `'no
-0001bed0: 772d 5b30 2d39 5d2b 5b6d 6864 5d27 602c  w-[0-9]+[mhd]'`,
-0001bee0: 2077 6865 7265 2060 6d60 203d 206d 696e   where `m` = min
-0001bef0: 7574 6573 2c20 6068 6020 3d20 686f 7572  utes, `h` = hour
-0001bf00: 732c 2061 6e64 2060 2764 2760 203d 0a20  s, and `'d'` =. 
-0001bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf30: 6461 7973 292c 206f 7220 3020 666f 7220  days), or 0 for 
-0001bf40: 7468 6520 6561 726c 6965 7374 2074 696d  the earliest tim
-0001bf50: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001bf60: 6d20 656e 643a 2054 6865 2065 6e64 2074  m end: The end t
-0001bf70: 696d 6520 6f66 2074 6865 206d 6574 7269  ime of the metri
-0001bf80: 6373 2e20 4361 6e20 6265 2072 6570 7265  cs. Can be repre
-0001bf90: 7365 6e74 6564 2062 7920 6120 7374 7269  sented by a stri
-0001bfa0: 6e67 2063 6f6e 7461 696e 696e 6720 616e  ng containing an
-0001bfb0: 2052 4643 2033 3333 390a 2020 2020 2020   RFC 3339.      
-0001bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfd0: 2020 2020 2020 2020 2020 2074 696d 652c             time,
-0001bfe0: 2061 2055 6e69 7820 7469 6d65 7374 616d   a Unix timestam
-0001bff0: 7020 696e 206d 696c 6c69 7365 636f 6e64  p in millisecond
-0001c000: 732c 2061 2072 656c 6174 6976 6520 7469  s, a relative ti
-0001c010: 6d65 2028 6027 6e6f 7727 6020 6f72 0a20  me (`'now'` or. 
-0001c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c040: 6027 6e6f 772d 5b30 2d39 5d2b 5b6d 6864  `'now-[0-9]+[mhd
-0001c050: 5d27 602c 2077 6865 7265 2060 6d60 203d  ]'`, where `m` =
-0001c060: 206d 696e 7574 6573 2c20 6068 6020 3d20   minutes, `h` = 
-0001c070: 686f 7572 732c 2061 6e64 2060 2764 2760  hours, and `'d'`
-0001c080: 203d 0a20 2020 2020 2020 2020 2020 2020   =.             
-0001c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0a0: 2020 2020 6461 7973 292c 206f 7220 3020      days), or 0 
-0001c0b0: 666f 7220 7468 6520 6561 726c 6965 7374  for the earliest
-0001c0c0: 2074 696d 652e 0a20 2020 2020 2020 203a   time..        :
-0001c0d0: 7061 7261 6d20 746f 705f 6c65 7665 6c3a  param top_level:
-0001c0e0: 2069 6620 7472 7565 2077 696c 6c20 7265   if true will re
-0001c0f0: 7475 726e 206f 6e6c 7920 726f 7574 6572  turn only router
-0001c100: 7320 616e 6420 656e 6470 6f69 6e74 2074  s and endpoint t
-0001c110: 6861 7420 6172 6520 4e4f 5420 6368 696c  hat are NOT chil
-0001c120: 6472 656e 206f 6620 616e 7920 726f 7574  dren of any rout
-0001c130: 6572 0a20 2020 2020 2020 203a 7061 7261  er.        :para
-0001c140: 6d20 7569 6473 3a20 6966 2070 6173 7365  m uids: if passe
-0001c150: 6420 7769 6c6c 2072 6574 7572 6e20 6120  d will return a 
-0001c160: 6c69 7374 2060 4d6f 6465 6c45 6e64 706f  list `ModelEndpo
-0001c170: 696e 7460 206f 626a 6563 7420 7769 7468  int` object with
-0001c180: 2075 6964 2069 6e20 7569 6473 0a20 2020   uid in uids.   
-0001c190: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001c1a0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0001c1b0: 6374 732f 7b70 726f 6a65 6374 7d2f 6d6f  cts/{project}/mo
-0001c1c0: 6465 6c2d 656e 6470 6f69 6e74 7322 0a0a  del-endpoints"..
-0001c1d0: 2020 2020 2020 2020 6966 206c 6162 656c          if label
-0001c1e0: 7320 616e 6420 6973 696e 7374 616e 6365  s and isinstance
-0001c1f0: 286c 6162 656c 732c 2064 6963 7429 3a0a  (labels, dict):.
-0001c200: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
-0001c210: 6c73 203d 205b 6622 7b6b 6579 7d3d 7b76  ls = [f"{key}={v
-0001c220: 616c 7565 7d22 2066 6f72 206b 6579 2c20  alue}" for key, 
-0001c230: 7661 6c75 6520 696e 206c 6162 656c 732e  value in labels.
-0001c240: 6974 656d 7328 295d 0a0a 2020 2020 2020  items()]..      
-0001c250: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-0001c260: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-0001c270: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-0001c280: 4745 5422 2c0a 2020 2020 2020 2020 2020  GET",.          
-0001c290: 2020 7061 7468 3d70 6174 682c 0a20 2020    path=path,.   
-0001c2a0: 2020 2020 2020 2020 2070 6172 616d 733d           params=
-0001c2b0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001c2c0: 2020 226d 6f64 656c 223a 206d 6f64 656c    "model": model
-0001c2d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c2e0: 2020 2266 756e 6374 696f 6e22 3a20 6675    "function": fu
-0001c2f0: 6e63 7469 6f6e 2c0a 2020 2020 2020 2020  nction,.        
-0001c300: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
-0001c310: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
-0001c320: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c330: 7374 6172 7422 3a20 7374 6172 742c 0a20  start": start,. 
-0001c340: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c350: 656e 6422 3a20 656e 642c 0a20 2020 2020  end": end,.     
-0001c360: 2020 2020 2020 2020 2020 2022 6d65 7472             "metr
-0001c370: 6963 223a 206d 6574 7269 6373 206f 7220  ic": metrics or 
-0001c380: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-0001c390: 2020 2020 2274 6f70 2d6c 6576 656c 223a      "top-level":
-0001c3a0: 2074 6f70 5f6c 6576 656c 2c0a 2020 2020   top_level,.    
-0001c3b0: 2020 2020 2020 2020 2020 2020 2275 6964              "uid
-0001c3c0: 223a 2075 6964 732c 0a20 2020 2020 2020  ": uids,.       
-0001c3d0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-0001c3e0: 290a 0a20 2020 2020 2020 2023 2047 656e  )..        # Gen
-0001c3f0: 6572 6174 6520 6120 6c69 7374 206f 6620  erate a list of 
-0001c400: 6120 6d6f 6465 6c20 656e 6470 6f69 6e74  a model endpoint
-0001c410: 2064 6963 7469 6f6e 6172 6965 730a 2020   dictionaries.  
-0001c420: 2020 2020 2020 6d6f 6465 6c5f 656e 6470        model_endp
-0001c430: 6f69 6e74 7320 3d20 7265 7370 6f6e 7365  oints = response
-0001c440: 2e6a 736f 6e28 295b 2265 6e64 706f 696e  .json()["endpoin
-0001c450: 7473 225d 0a20 2020 2020 2020 2069 6620  ts"].        if 
-0001c460: 6d6f 6465 6c5f 656e 6470 6f69 6e74 733a  model_endpoints:
-0001c470: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001c480: 7572 6e20 5b0a 2020 2020 2020 2020 2020  urn [.          
-0001c490: 2020 2020 2020 6d6c 7275 6e2e 6d6f 6465        mlrun.mode
-0001c4a0: 6c5f 6d6f 6e69 746f 7269 6e67 2e6d 6f64  l_monitoring.mod
-0001c4b0: 656c 5f65 6e64 706f 696e 742e 4d6f 6465  el_endpoint.Mode
-0001c4c0: 6c45 6e64 706f 696e 742e 6672 6f6d 5f64  lEndpoint.from_d
-0001c4d0: 6963 7428 6f62 6a29 0a20 2020 2020 2020  ict(obj).       
-0001c4e0: 2020 2020 2020 2020 2066 6f72 206f 626a           for obj
-0001c4f0: 2069 6e20 6d6f 6465 6c5f 656e 6470 6f69   in model_endpoi
-0001c500: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-0001c510: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-0001c520: 205b 5d0a 0a20 2020 2064 6566 2067 6574   []..    def get
-0001c530: 5f6d 6f64 656c 5f65 6e64 706f 696e 7428  _model_endpoint(
-0001c540: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001c550: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-0001c560: 7374 722c 0a20 2020 2020 2020 2065 6e64  str,.        end
-0001c570: 706f 696e 745f 6964 3a20 7374 722c 0a20  point_id: str,. 
-0001c580: 2020 2020 2020 2073 7461 7274 3a20 4f70         start: Op
-0001c590: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0001c5a0: 6e65 2c0a 2020 2020 2020 2020 656e 643a  ne,.        end:
-0001c5b0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0001c5c0: 204e 6f6e 652c 0a20 2020 2020 2020 206d   None,.        m
-0001c5d0: 6574 7269 6373 3a20 4f70 7469 6f6e 616c  etrics: Optional
-0001c5e0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-0001c5f0: 6e65 2c0a 2020 2020 2020 2020 6665 6174  ne,.        feat
-0001c600: 7572 655f 616e 616c 7973 6973 3a20 626f  ure_analysis: bo
-0001c610: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0001c620: 2920 2d3e 206d 6c72 756e 2e6d 6f64 656c  ) -> mlrun.model
-0001c630: 5f6d 6f6e 6974 6f72 696e 672e 6d6f 6465  _monitoring.mode
-0001c640: 6c5f 656e 6470 6f69 6e74 2e4d 6f64 656c  l_endpoint.Model
-0001c650: 456e 6470 6f69 6e74 3a0a 2020 2020 2020  Endpoint:.      
-0001c660: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0001c670: 7475 726e 7320 6120 7369 6e67 6c65 2060  turns a single `
-0001c680: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
-0001c690: 626a 6563 7420 7769 7468 2061 6464 6974  bject with addit
-0001c6a0: 696f 6e61 6c20 6d65 7472 6963 7320 616e  ional metrics an
-0001c6b0: 6420 6665 6174 7572 6520 7265 6c61 7465  d feature relate
-0001c6c0: 6420 6461 7461 2e0a 0a20 2020 2020 2020  d data...       
-0001c6d0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0001c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6f0: 2020 2020 5468 6520 6e61 6d65 206f 6620      The name of 
-0001c700: 7468 6520 7072 6f6a 6563 740a 2020 2020  the project.    
-0001c710: 2020 2020 3a70 6172 616d 2065 6e64 706f      :param endpo
-0001c720: 696e 745f 6964 3a20 2020 2020 2020 2020  int_id:         
-0001c730: 2020 2020 2020 2054 6865 2075 6e69 7175         The uniqu
-0001c740: 6520 6964 206f 6620 7468 6520 6d6f 6465  e id of the mode
-0001c750: 6c20 656e 6470 6f69 6e74 2e0a 2020 2020  l endpoint..    
-0001c760: 2020 2020 3a70 6172 616d 2073 7461 7274      :param start
-0001c770: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
-0001c780: 2020 2020 2020 2054 6865 2073 7461 7274         The start
-0001c790: 2074 696d 6520 6f66 2074 6865 206d 6574   time of the met
-0001c7a0: 7269 6373 2e20 4361 6e20 6265 2072 6570  rics. Can be rep
-0001c7b0: 7265 7365 6e74 6564 2062 7920 6120 7374  resented by a st
-0001c7c0: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
-0001c7d0: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
-0001c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7f0: 2020 2020 2020 2020 2020 2020 2020 5246                RF
-0001c800: 4320 3333 3339 2074 696d 652c 2061 2055  C 3339 time, a U
-0001c810: 6e69 7820 7469 6d65 7374 616d 7020 696e  nix timestamp in
-0001c820: 206d 696c 6c69 7365 636f 6e64 732c 2061   milliseconds, a
-0001c830: 2072 656c 6174 6976 6520 7469 6d65 2028   relative time (
-0001c840: 6027 6e6f 7727 6020 6f72 0a20 2020 2020  `'now'` or.     
-0001c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c870: 2020 2020 2020 6027 6e6f 772d 5b30 2d39        `'now-[0-9
-0001c880: 5d2b 5b6d 6864 5d27 602c 2077 6865 7265  ]+[mhd]'`, where
-0001c890: 2060 6d60 203d 206d 696e 7574 6573 2c20   `m` = minutes, 
-0001c8a0: 6068 6020 3d20 686f 7572 732c 2061 6e64  `h` = hours, and
-0001c8b0: 2060 2764 2760 203d 2064 6179 7329 2c20   `'d'` = days), 
-0001c8c0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-0001c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8e0: 2020 2020 2020 2020 2020 2020 2020 3020                0 
-0001c8f0: 666f 7220 7468 6520 6561 726c 6965 7374  for the earliest
-0001c900: 2074 696d 652e 0a20 2020 2020 2020 203a   time..        :
-0001c910: 7061 7261 6d20 656e 643a 2020 2020 2020  param end:      
-0001c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c930: 2020 5468 6520 656e 6420 7469 6d65 206f    The end time o
-0001c940: 6620 7468 6520 6d65 7472 6963 732e 2043  f the metrics. C
-0001c950: 616e 2062 6520 7265 7072 6573 656e 7465  an be represente
-0001c960: 6420 6279 2061 2073 7472 696e 6720 636f  d by a string co
-0001c970: 6e74 6169 6e69 6e67 2061 6e0a 2020 2020  ntaining an.    
-0001c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9a0: 2020 2020 2020 2052 4643 2033 3333 3920         RFC 3339 
-0001c9b0: 7469 6d65 2c20 6120 556e 6978 2074 696d  time, a Unix tim
-0001c9c0: 6573 7461 6d70 2069 6e20 6d69 6c6c 6973  estamp in millis
-0001c9d0: 6563 6f6e 6473 2c20 6120 7265 6c61 7469  econds, a relati
-0001c9e0: 7665 2074 696d 6520 2860 276e 6f77 2760  ve time (`'now'`
-0001c9f0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-0001ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca10: 2020 2020 2020 2020 2020 2020 2020 2060                 `
-0001ca20: 276e 6f77 2d5b 302d 395d 2b5b 6d68 645d  'now-[0-9]+[mhd]
-0001ca30: 2760 2c20 7768 6572 6520 606d 6020 3d20  '`, where `m` = 
-0001ca40: 6d69 6e75 7465 732c 2060 6860 203d 2068  minutes, `h` = h
-0001ca50: 6f75 7273 2c20 616e 6420 6027 6427 6020  ours, and `'d'` 
-0001ca60: 3d20 6461 7973 292c 206f 720a 2020 2020  = days), or.    
-0001ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca90: 2020 2020 2020 2030 2066 6f72 2074 6865         0 for the
-0001caa0: 2065 6172 6c69 6573 7420 7469 6d65 2e0a   earliest time..
-0001cab0: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
-0001cac0: 6574 7269 6373 3a20 2020 2020 2020 2020  etrics:         
-0001cad0: 2020 2020 2020 2020 2020 2041 206c 6973             A lis
-0001cae0: 7420 6f66 206d 6574 7269 6373 2074 6f20  t of metrics to 
-0001caf0: 7265 7475 726e 2066 6f72 2074 6865 206d  return for the m
-0001cb00: 6f64 656c 2065 6e64 706f 696e 742e 2054  odel endpoint. T
-0001cb10: 6865 7265 2061 7265 2070 7265 2d64 6566  here are pre-def
-0001cb20: 696e 6564 0a20 2020 2020 2020 2020 2020  ined.           
-0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb50: 6d65 7472 6963 7320 666f 7220 6d6f 6465  metrics for mode
-0001cb60: 6c20 656e 6470 6f69 6e74 7320 7375 6368  l endpoints such
-0001cb70: 2061 7320 7072 6564 6963 7469 6f6e 735f   as predictions_
-0001cb80: 7065 725f 7365 636f 6e64 2061 6e64 0a20  per_second and. 
-0001cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbb0: 2020 2020 2020 2020 2020 6c61 7465 6e63            latenc
-0001cbc0: 795f 6176 675f 356d 2062 7574 2061 6c73  y_avg_5m but als
-0001cbd0: 6f20 6375 7374 6f6d 206d 6574 7269 6373  o custom metrics
-0001cbe0: 2064 6566 696e 6564 2062 7920 7468 6520   defined by the 
-0001cbf0: 7573 6572 2e20 506c 6561 7365 206e 6f74  user. Please not
-0001cc00: 6520 7468 6174 0a20 2020 2020 2020 2020  e that.         
-0001cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc30: 2020 7468 6573 6520 6d65 7472 6963 7320    these metrics 
-0001cc40: 6172 6520 7374 6f72 6564 2069 6e20 7468  are stored in th
-0001cc50: 6520 7469 6d65 2073 6572 6965 7320 4442  e time series DB
-0001cc60: 2061 6e64 2074 6865 2072 6573 756c 7473   and the results
-0001cc70: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
-0001cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cca0: 2020 2020 6170 7065 6172 6564 2075 6e64      appeared und
-0001ccb0: 6572 206d 6f64 656c 5f65 6e64 706f 696e  er model_endpoin
-0001ccc0: 742e 7370 6563 2e6d 6574 7269 6373 2e0a  t.spec.metrics..
-0001ccd0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0001cce0: 6561 7475 7265 5f61 6e61 6c79 7369 733a  eature_analysis:
-0001ccf0: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
-0001cd00: 5472 7565 2c20 7468 6520 6261 7365 2066  True, the base f
-0001cd10: 6561 7475 7265 2073 7461 7469 7374 6963  eature statistic
-0001cd20: 7320 616e 6420 6375 7272 656e 7420 6665  s and current fe
-0001cd30: 6174 7572 6520 7374 6174 6973 7469 6373  ature statistics
-0001cd40: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
-0001cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd70: 2062 6520 6164 6465 6420 746f 2074 6865   be added to the
-0001cd80: 206f 7574 7075 7420 6f66 2074 6865 2072   output of the r
-0001cd90: 6573 756c 7469 6e67 206f 626a 6563 742e  esulting object.
-0001cda0: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0001cdb0: 6e3a 2041 2060 4d6f 6465 6c45 6e64 706f  n: A `ModelEndpo
-0001cdc0: 696e 7460 206f 626a 6563 742e 0a20 2020  int` object..   
-0001cdd0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001cde0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0001cdf0: 6374 732f 7b70 726f 6a65 6374 7d2f 6d6f  cts/{project}/mo
-0001ce00: 6465 6c2d 656e 6470 6f69 6e74 732f 7b65  del-endpoints/{e
-0001ce10: 6e64 706f 696e 745f 6964 7d22 0a20 2020  ndpoint_id}".   
-0001ce20: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-0001ce30: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-0001ce40: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0001ce50: 643d 2247 4554 222c 0a20 2020 2020 2020  d="GET",.       
-0001ce60: 2020 2020 2070 6174 683d 7061 7468 2c0a       path=path,.
-0001ce70: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001ce80: 6d73 3d7b 0a20 2020 2020 2020 2020 2020  ms={.           
-0001ce90: 2020 2020 2022 7374 6172 7422 3a20 7374       "start": st
-0001cea0: 6172 742c 0a20 2020 2020 2020 2020 2020  art,.           
-0001ceb0: 2020 2020 2022 656e 6422 3a20 656e 642c       "end": end,
-0001cec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ced0: 2022 6d65 7472 6963 223a 206d 6574 7269   "metric": metri
-0001cee0: 6373 206f 7220 5b5d 2c0a 2020 2020 2020  cs or [],.      
-0001cef0: 2020 2020 2020 2020 2020 2266 6561 7475            "featu
-0001cf00: 7265 5f61 6e61 6c79 7369 7322 3a20 6665  re_analysis": fe
-0001cf10: 6174 7572 655f 616e 616c 7973 6973 2c0a  ature_analysis,.
-0001cf20: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0001cf30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0001cf40: 2020 7265 7475 726e 206d 6c72 756e 2e6d    return mlrun.m
-0001cf50: 6f64 656c 5f6d 6f6e 6974 6f72 696e 672e  odel_monitoring.
-0001cf60: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2e4d  model_endpoint.M
-0001cf70: 6f64 656c 456e 6470 6f69 6e74 2e66 726f  odelEndpoint.fro
-0001cf80: 6d5f 6469 6374 280a 2020 2020 2020 2020  m_dict(.        
-0001cf90: 2020 2020 7265 7370 6f6e 7365 2e6a 736f      response.jso
-0001cfa0: 6e28 290a 2020 2020 2020 2020 290a 0a20  n().        ).. 
-0001cfb0: 2020 2064 6566 2070 6174 6368 5f6d 6f64     def patch_mod
-0001cfc0: 656c 5f65 6e64 706f 696e 7428 0a20 2020  el_endpoint(.   
-0001cfd0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001cfe0: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-0001cff0: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-0001d000: 745f 6964 3a20 7374 722c 0a20 2020 2020  t_id: str,.     
-0001d010: 2020 2061 7474 7269 6275 7465 733a 2064     attributes: d
-0001d020: 6963 742c 0a20 2020 2029 3a0a 2020 2020  ict,.    ):.    
-0001d030: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001d040: 5570 6461 7465 7320 6d6f 6465 6c20 656e  Updates model en
-0001d050: 6470 6f69 6e74 2077 6974 6820 7072 6f76  dpoint with prov
-0001d060: 6964 6564 2061 7474 7269 6275 7465 732e  ided attributes.
-0001d070: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001d080: 2070 726f 6a65 6374 3a20 5468 6520 6e61   project: The na
-0001d090: 6d65 206f 6620 7468 6520 7072 6f6a 6563  me of the projec
-0001d0a0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0001d0b0: 6d20 656e 6470 6f69 6e74 5f69 643a 2054  m endpoint_id: T
-0001d0c0: 6865 2069 6420 6f66 2074 6865 2065 6e64  he id of the end
-0001d0d0: 706f 696e 742e 0a20 2020 2020 2020 203a  point..        :
-0001d0e0: 7061 7261 6d20 6174 7472 6962 7574 6573  param attributes
-0001d0f0: 3a20 4469 6374 696f 6e61 7279 206f 6620  : Dictionary of 
-0001d100: 6174 7472 6962 7574 6573 2074 6861 7420  attributes that 
-0001d110: 7769 6c6c 2062 6520 7573 6564 2066 6f72  will be used for
-0001d120: 2075 7064 6174 6520 7468 6520 6d6f 6465   update the mode
-0001d130: 6c20 656e 6470 6f69 6e74 2e20 5468 6520  l endpoint. The 
-0001d140: 6b65 7973 0a20 2020 2020 2020 2020 2020  keys.           
-0001d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d160: 6f66 2074 6869 7320 6469 6374 696f 6e61  of this dictiona
-0001d170: 7279 2073 686f 756c 6420 6578 6973 7420  ry should exist 
-0001d180: 696e 2074 6865 2074 6172 6765 7420 7461  in the target ta
-0001d190: 626c 652e 204e 6f74 6520 7468 6174 2074  ble. Note that t
-0001d1a0: 6865 2076 616c 7565 7320 7368 6f75 6c64  he values should
-0001d1b0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001d1d0: 726f 6d20 7479 7065 2073 7472 696e 6720  rom type string 
-0001d1e0: 6f72 2066 726f 6d20 6120 7661 6c69 6420  or from a valid 
-0001d1f0: 6e75 6d65 7269 6361 6c20 7479 7065 2073  numerical type s
-0001d200: 7563 6820 6173 2069 6e74 206f 7220 666c  uch as int or fl
-0001d210: 6f61 742e 0a20 2020 2020 2020 2020 2020  oat..           
-0001d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d230: 204d 6f72 6520 6465 7461 696c 7320 6162   More details ab
-0001d240: 6f75 7420 7468 6520 6d6f 6465 6c20 656e  out the model en
-0001d250: 6470 6f69 6e74 2061 7661 696c 6162 6c65  dpoint available
-0001d260: 2061 7474 7269 6275 7465 7320 6361 6e20   attributes can 
-0001d270: 6265 2066 6f75 6e64 2075 6e64 6572 0a20  be found under. 
-0001d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d290: 2020 2020 2020 2020 2020 3a70 793a 636c            :py:cl
-0001d2a0: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
-0001d2b0: 6f6e 2e73 6368 656d 6173 2e4d 6f64 656c  on.schemas.Model
-0001d2c0: 456e 6470 6f69 6e74 602e 0a0a 2020 2020  Endpoint`...    
-0001d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2e0: 2020 2020 2020 2045 7861 6d70 6c65 3a3a         Example::
-0001d2f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a4a0: 204e 6f6e 652c 0a20 2020 2020 2020 206f   None,.        o
+0000a4b0: 626a 6563 745f 6964 3a20 4f70 7469 6f6e  bject_id: Option
+0000a4c0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0000a4d0: 2020 2020 2020 2020 666f 7263 653a 2062          force: b
+0000a4e0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0000a4f0: 2020 2020 2067 7261 6365 5f70 6572 696f       grace_perio
+0000a500: 643a 2069 6e74 203d 204e 6f6e 652c 0a20  d: int = None,. 
+0000a510: 2020 2029 202d 3e20 6d6c 7275 6e2e 636f     ) -> mlrun.co
+0000a520: 6d6d 6f6e 2e73 6368 656d 6173 2e47 726f  mmon.schemas.Gro
+0000a530: 7570 6564 4279 5072 6f6a 6563 7452 756e  upedByProjectRun
+0000a540: 7469 6d65 5265 736f 7572 6365 734f 7574  timeResourcesOut
+0000a550: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
+0000a560: 4465 6c65 7465 2061 6c6c 2072 756e 7469  Delete all runti
+0000a570: 6d65 2072 6573 6f75 7263 6573 2077 6869  me resources whi
+0000a580: 6368 2061 7265 2069 6e20 7465 726d 696e  ch are in termin
+0000a590: 616c 2073 7461 7465 2e0a 0a20 2020 2020  al state...     
+0000a5a0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+0000a5b0: 743a 2044 656c 6574 6520 6f6e 6c79 2072  t: Delete only r
+0000a5c0: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+0000a5d0: 206f 6620 6120 7370 6563 6966 6963 2070   of a specific p
+0000a5e0: 726f 6a65 6374 2c20 6279 2064 6566 6175  roject, by defau
+0000a5f0: 6c74 204e 6f6e 652c 2077 6869 6368 2077  lt None, which w
+0000a600: 696c 6c20 6465 6c65 7465 206f 6e6c 790a  ill delete only.
+0000a610: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0000a620: 2074 6865 2070 726f 6a65 6374 7320 796f   the projects yo
+0000a630: 7527 7265 2061 7574 686f 7269 7a65 6420  u're authorized 
+0000a640: 746f 2064 656c 6574 6520 6672 6f6d 2e0a  to delete from..
+0000a650: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+0000a660: 6162 656c 5f73 656c 6563 746f 723a 2044  abel_selector: D
+0000a670: 656c 6574 6520 6f6e 6c79 2072 756e 7469  elete only runti
+0000a680: 6d65 2072 6573 6f75 7263 6573 206d 6174  me resources mat
+0000a690: 6368 696e 6720 7468 6520 6c61 6265 6c20  ching the label 
+0000a6a0: 7365 6c65 6374 6f72 2e0a 2020 2020 2020  selector..      
+0000a6b0: 2020 3a70 6172 616d 206b 696e 643a 2054    :param kind: T
+0000a6c0: 6865 206b 696e 6420 6f66 2072 756e 7469  he kind of runti
+0000a6d0: 6d65 2074 6f20 6465 6c65 7465 2e20 4d61  me to delete. Ma
+0000a6e0: 7920 6265 206f 6e65 206f 6620 605b 2764  y be one of `['d
+0000a6f0: 6173 6b27 2c20 276a 6f62 272c 2027 7370  ask', 'job', 'sp
+0000a700: 6172 6b27 2c20 2772 656d 6f74 652d 7370  ark', 'remote-sp
+0000a710: 6172 6b27 2c20 276d 7069 6a6f 6227 5d60  ark', 'mpijob']`
+0000a720: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000a730: 6f62 6a65 6374 5f69 643a 2054 6865 2069  object_id: The i
+0000a740: 6465 6e74 6966 6965 7220 6f66 2074 6865  dentifier of the
+0000a750: 206d 6c72 756e 206f 626a 6563 7420 746f   mlrun object to
+0000a760: 2064 656c 6574 6520 6974 7320 7275 6e74   delete its runt
+0000a770: 696d 6520 7265 736f 7572 6365 732e 2066  ime resources. f
+0000a780: 6f72 206d 6f73 7420 6675 6e63 7469 6f6e  or most function
+0000a790: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
+0000a7a0: 7469 6d65 732c 2072 756e 7469 6d65 2072  times, runtime r
+0000a7b0: 6573 6f75 7263 6573 2061 7265 2070 6572  esources are per
+0000a7c0: 2052 756e 2c20 666f 7220 7768 6963 6820   Run, for which 
+0000a7d0: 7468 6520 6964 656e 7469 6669 6572 2069  the identifier i
+0000a7e0: 7320 7468 6520 5275 6e27 7320 5549 442e  s the Run's UID.
+0000a7f0: 2046 6f72 2064 6173 6b20 7275 6e74 696d   For dask runtim
+0000a800: 652c 2074 6865 0a20 2020 2020 2020 2020  e, the.         
+0000a810: 2020 2072 756e 7469 6d65 2072 6573 6f75     runtime resou
+0000a820: 7263 6573 2061 7265 2070 6572 2046 756e  rces are per Fun
+0000a830: 6374 696f 6e2c 2066 6f72 2077 6869 6368  ction, for which
+0000a840: 2074 6865 2069 6465 6e74 6966 6965 7220   the identifier 
+0000a850: 6973 2074 6865 2046 756e 6374 696f 6e27  is the Function'
+0000a860: 7320 6e61 6d65 2e0a 2020 2020 2020 2020  s name..        
+0000a870: 3a70 6172 616d 2066 6f72 6365 3a20 466f  :param force: Fo
+0000a880: 7263 6520 6465 6c65 7469 6f6e 202d 2064  rce deletion - d
+0000a890: 656c 6574 6520 7468 6520 7275 6e74 696d  elete the runtim
+0000a8a0: 6520 7265 736f 7572 6365 2065 7665 6e20  e resource even 
+0000a8b0: 6966 2069 7427 7320 6e6f 7420 696e 2074  if it's not in t
+0000a8c0: 6572 6d69 6e61 6c20 7374 6174 6520 6f72  erminal state or
+0000a8d0: 2069 6620 7468 6520 6772 6163 650a 2020   if the grace.  
+0000a8e0: 2020 2020 2020 2020 2020 7065 7269 6f64            period
+0000a8f0: 2064 6964 6e27 7420 7061 7373 2e0a 2020   didn't pass..  
+0000a900: 2020 2020 2020 3a70 6172 616d 2067 7261        :param gra
+0000a910: 6365 5f70 6572 696f 643a 2047 7261 6365  ce_period: Grace
+0000a920: 2070 6572 696f 6420 6769 7665 6e20 746f   period given to
+0000a930: 2074 6865 2072 756e 7469 6d65 2072 6573   the runtime res
+0000a940: 6f75 7263 6520 6265 666f 7265 2074 6865  ource before the
+0000a950: 7920 6172 6520 6163 7475 616c 6c79 2072  y are actually r
+0000a960: 656d 6f76 6564 2c20 636f 756e 7465 6420  emoved, counted 
+0000a970: 6672 6f6d 0a20 2020 2020 2020 2020 2020  from.           
+0000a980: 2074 6865 206d 6f6d 656e 7420 7468 6579   the moment they
+0000a990: 206d 6f76 6564 2074 6f20 7465 726d 696e   moved to termin
+0000a9a0: 616c 2073 7461 7465 2028 6465 6661 756c  al state (defaul
+0000a9b0: 7473 2074 6f20 6d6c 7275 6e2e 6d6c 636f  ts to mlrun.mlco
+0000a9c0: 6e66 2e72 756e 7469 6d65 5f72 6573 6f75  nf.runtime_resou
+0000a9d0: 7263 6573 5f64 656c 6574 696f 6e5f 6772  rces_deletion_gr
+0000a9e0: 6163 655f 7065 7269 6f64 292e 0a0a 2020  ace_period)...  
+0000a9f0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+0000aa00: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+0000aa10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000aa20: 2e47 726f 7570 6564 4279 5072 6f6a 6563  .GroupedByProjec
+0000aa30: 7452 756e 7469 6d65 5265 736f 7572 6365  tRuntimeResource
+0000aa40: 734f 7574 7075 7460 206c 6973 7469 6e67  sOutput` listing
+0000aa50: 2074 6865 2072 756e 7469 6d65 2072 6573   the runtime res
+0000aa60: 6f75 7263 6573 0a20 2020 2020 2020 2020  ources.         
+0000aa70: 2020 2074 6861 7420 7765 7265 2072 656d     that were rem
+0000aa80: 6f76 6564 2e0a 2020 2020 2020 2020 2222  oved..        ""
+0000aa90: 220a 2020 2020 2020 2020 6966 2067 7261  ".        if gra
+0000aaa0: 6365 5f70 6572 696f 6420 6973 204e 6f6e  ce_period is Non
+0000aab0: 653a 0a20 2020 2020 2020 2020 2020 2067  e:.            g
+0000aac0: 7261 6365 5f70 6572 696f 6420 3d20 636f  race_period = co
+0000aad0: 6e66 6967 2e72 756e 7469 6d65 5f72 6573  nfig.runtime_res
+0000aae0: 6f75 7263 6573 5f64 656c 6574 696f 6e5f  ources_deletion_
+0000aaf0: 6772 6163 655f 7065 7269 6f64 0a20 2020  grace_period.   
+0000ab00: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0000ab10: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
+0000ab20: 2020 2020 2020 2255 7369 6e67 2064 6566        "Using def
+0000ab30: 6175 6c74 2067 7261 6365 2070 6572 696f  ault grace perio
+0000ab40: 6420 666f 7220 7275 6e74 696d 6520 7265  d for runtime re
+0000ab50: 736f 7572 6365 7320 6465 6c65 7469 6f6e  sources deletion
+0000ab60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000ab70: 2020 2067 7261 6365 5f70 6572 696f 643d     grace_period=
+0000ab80: 6772 6163 655f 7065 7269 6f64 2c0a 2020  grace_period,.  
+0000ab90: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000aba0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+0000abb0: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
+0000abc0: 656c 2d73 656c 6563 746f 7222 3a20 6c61  el-selector": la
+0000abd0: 6265 6c5f 7365 6c65 6374 6f72 2c0a 2020  bel_selector,.  
+0000abe0: 2020 2020 2020 2020 2020 226b 696e 6422            "kind"
+0000abf0: 3a20 6b69 6e64 2c0a 2020 2020 2020 2020  : kind,.        
+0000ac00: 2020 2020 226f 626a 6563 742d 6964 223a      "object-id":
+0000ac10: 206f 626a 6563 745f 6964 2c0a 2020 2020   object_id,.    
+0000ac20: 2020 2020 2020 2020 2266 6f72 6365 223a          "force":
+0000ac30: 2066 6f72 6365 2c0a 2020 2020 2020 2020   force,.        
+0000ac40: 2020 2020 2267 7261 6365 2d70 6572 696f      "grace-perio
+0000ac50: 6422 3a20 6772 6163 655f 7065 7269 6f64  d": grace_period
+0000ac60: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0000ac70: 2020 2020 6572 726f 7220 3d20 2246 6169      error = "Fai
+0000ac80: 6c65 6420 6465 6c65 7469 6e67 2072 756e  led deleting run
+0000ac90: 7469 6d65 2072 6573 6f75 7263 6573 220a  time resources".
+0000aca0: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
+0000acb0: 7061 7468 203d 2070 726f 6a65 6374 2069  path = project i
+0000acc0: 6620 7072 6f6a 6563 7420 656c 7365 2022  f project else "
+0000acd0: 2a22 0a20 2020 2020 2020 2072 6573 706f  *".        respo
+0000ace0: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0000acf0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0000ad00: 2022 4445 4c45 5445 222c 0a20 2020 2020   "DELETE",.     
+0000ad10: 2020 2020 2020 2066 2270 726f 6a65 6374         f"project
+0000ad20: 732f 7b70 726f 6a65 6374 5f70 6174 687d  s/{project_path}
+0000ad30: 2f72 756e 7469 6d65 2d72 6573 6f75 7263  /runtime-resourc
+0000ad40: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
+0000ad50: 2065 7272 6f72 2c0a 2020 2020 2020 2020   error,.        
+0000ad60: 2020 2020 7061 7261 6d73 3d70 6172 616d      params=param
+0000ad70: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
+0000ad80: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
+0000ad90: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
+0000ada0: 2020 666f 7220 7072 6f6a 6563 742c 206b    for project, k
+0000adb0: 696e 645f 7275 6e74 696d 655f 7265 736f  ind_runtime_reso
+0000adc0: 7572 6365 735f 6d61 7020 696e 2072 6573  urces_map in res
+0000add0: 706f 6e73 652e 6a73 6f6e 2829 2e69 7465  ponse.json().ite
+0000ade0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+0000adf0: 2020 666f 7220 6b69 6e64 2c20 7275 6e74    for kind, runt
+0000ae00: 696d 655f 7265 736f 7572 6365 7320 696e  ime_resources in
+0000ae10: 206b 696e 645f 7275 6e74 696d 655f 7265   kind_runtime_re
+0000ae20: 736f 7572 6365 735f 6d61 702e 6974 656d  sources_map.item
+0000ae30: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0000ae40: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
+0000ae50: 6469 6374 2e73 6574 6465 6661 756c 7428  dict.setdefault(
+0000ae60: 7072 6f6a 6563 742c 207b 7d29 5b0a 2020  project, {})[.  
+0000ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae80: 2020 6b69 6e64 0a20 2020 2020 2020 2020    kind.         
+0000ae90: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+0000aea0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000aeb0: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
+0000aec0: 282a 2a72 756e 7469 6d65 5f72 6573 6f75  (**runtime_resou
+0000aed0: 7263 6573 290a 2020 2020 2020 2020 7265  rces).        re
+0000aee0: 7475 726e 2073 7472 7563 7475 7265 645f  turn structured_
+0000aef0: 6469 6374 0a0a 2020 2020 6465 6620 6372  dict..    def cr
+0000af00: 6561 7465 5f73 6368 6564 756c 6528 0a20  eate_schedule(. 
+0000af10: 2020 2020 2020 2073 656c 662c 2070 726f         self, pro
+0000af20: 6a65 6374 3a20 7374 722c 2073 6368 6564  ject: str, sched
+0000af30: 756c 653a 206d 6c72 756e 2e63 6f6d 6d6f  ule: mlrun.commo
+0000af40: 6e2e 7363 6865 6d61 732e 5363 6865 6475  n.schemas.Schedu
+0000af50: 6c65 496e 7075 740a 2020 2020 293a 0a20  leInput.    ):. 
+0000af60: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
+0000af70: 2061 206e 6577 2073 6368 6564 756c 6520   a new schedule 
+0000af80: 6f6e 2074 6865 2067 6976 656e 2070 726f  on the given pro
+0000af90: 6a65 6374 2e20 5468 6520 6465 7461 696c  ject. The detail
+0000afa0: 7320 6f6e 2074 6865 2061 6374 7561 6c20  s on the actual 
+0000afb0: 6f62 6a65 6374 2074 6f20 7363 6865 6475  object to schedu
+0000afc0: 6c65 2061 7320 7765 6c6c 2061 7320 7468  le as well as th
+0000afd0: 650a 2020 2020 2020 2020 7363 6865 6475  e.        schedu
+0000afe0: 6c65 2069 7473 656c 6620 6172 6520 7769  le itself are wi
+0000aff0: 7468 696e 2074 6865 2073 6368 6564 756c  thin the schedul
+0000b000: 6520 6f62 6a65 6374 2070 726f 7669 6465  e object provide
+0000b010: 642e 0a20 2020 2020 2020 2054 6865 203a  d..        The :
+0000b020: 7079 3a63 6c61 7373 3a60 7e53 6368 6564  py:class:`~Sched
+0000b030: 756c 6543 726f 6e54 7269 6767 6572 6020  uleCronTrigger` 
+0000b040: 666f 6c6c 6f77 7320 7468 6520 6775 6964  follows the guid
+0000b050: 656c 696e 6573 2069 6e0a 2020 2020 2020  elines in.      
+0000b060: 2020 6874 7470 733a 2f2f 6170 7363 6865    https://apsche
+0000b070: 6475 6c65 722e 7265 6164 7468 6564 6f63  duler.readthedoc
+0000b080: 732e 696f 2f65 6e2f 332e 782f 6d6f 6475  s.io/en/3.x/modu
+0000b090: 6c65 732f 7472 6967 6765 7273 2f63 726f  les/triggers/cro
+0000b0a0: 6e2e 6874 6d6c 2e0a 2020 2020 2020 2020  n.html..        
+0000b0b0: 4974 2061 6c73 6f20 7375 7070 6f72 7473  It also supports
+0000b0c0: 2061 203a 7079 3a66 756e 633a 607e 5363   a :py:func:`~Sc
+0000b0d0: 6865 6475 6c65 4372 6f6e 5472 6967 6765  heduleCronTrigge
+0000b0e0: 722e 6672 6f6d 5f63 726f 6e74 6162 6020  r.from_crontab` 
+0000b0f0: 6675 6e63 7469 6f6e 2074 6861 7420 6163  function that ac
+0000b100: 6365 7074 7320 610a 2020 2020 2020 2020  cepts a.        
+0000b110: 6372 6f6e 7461 622d 666f 726d 6174 7465  crontab-formatte
+0000b120: 6420 7374 7269 6e67 2028 7365 6520 6874  d string (see ht
+0000b130: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+0000b140: 6961 2e6f 7267 2f77 696b 692f 4372 6f6e  ia.org/wiki/Cron
+0000b150: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+0000b160: 6174 696f 6e20 6f6e 2074 6865 2066 6f72  ation on the for
+0000b170: 6d61 7420 616e 640a 2020 2020 2020 2020  mat and.        
+0000b180: 6e6f 7465 2074 6861 7420 7468 6520 3020  note that the 0 
+0000b190: 7765 656b 6461 7920 6973 2061 6c77 6179  weekday is alway
+0000b1a0: 7320 6d6f 6e64 6179 292e 0a0a 0a20 2020  s monday)....   
+0000b1b0: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
+0000b1c0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0000b1d0: 206d 6c72 756e 2e63 6f6d 6d6f 6e20 696d   mlrun.common im
+0000b1e0: 706f 7274 2073 6368 656d 6173 0a0a 2020  port schemas..  
+0000b1f0: 2020 2020 2020 2020 2020 2320 4578 6563            # Exec
+0000b200: 7574 6520 7468 6520 6765 745f 6461 7461  ute the get_data
+0000b210: 5f66 756e 6320 6675 6e63 7469 6f6e 2065  _func function e
+0000b220: 7665 7279 2054 7565 7364 6179 2061 7420  very Tuesday at 
+0000b230: 3135 3a33 300a 2020 2020 2020 2020 2020  15:30.          
+0000b240: 2020 7363 6865 6475 6c65 203d 2073 6368    schedule = sch
+0000b250: 656d 6173 2e53 6368 6564 756c 6549 6e70  emas.ScheduleInp
+0000b260: 7574 280a 2020 2020 2020 2020 2020 2020  ut(.            
+0000b270: 2020 2020 6e61 6d65 3d22 7275 6e5f 6675      name="run_fu
+0000b280: 6e63 5f6f 6e5f 7475 6573 6461 7973 222c  nc_on_tuesdays",
+0000b290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b2a0: 206b 696e 643d 226a 6f62 222c 0a20 2020   kind="job",.   
+0000b2b0: 2020 2020 2020 2020 2020 2020 2073 6368               sch
+0000b2c0: 6564 756c 6564 5f6f 626a 6563 743d 6765  eduled_object=ge
+0000b2d0: 745f 6461 7461 5f66 756e 632c 0a20 2020  t_data_func,.   
+0000b2e0: 2020 2020 2020 2020 2020 2020 2063 726f               cro
+0000b2f0: 6e5f 7472 6967 6765 723d 7363 6865 6d61  n_trigger=schema
+0000b300: 732e 5363 6865 6475 6c65 4372 6f6e 5472  s.ScheduleCronTr
+0000b310: 6967 6765 7228 6461 795f 6f66 5f77 6565  igger(day_of_wee
+0000b320: 6b3d 2774 7565 272c 2068 6f75 723d 3135  k='tue', hour=15
+0000b330: 2c20 6d69 6e75 7465 3d33 3029 2c0a 2020  , minute=30),.  
+0000b340: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000b350: 2020 2020 2020 2020 6462 2e63 7265 6174          db.creat
+0000b360: 655f 7363 6865 6475 6c65 2870 726f 6a65  e_schedule(proje
+0000b370: 6374 5f6e 616d 652c 2073 6368 6564 756c  ct_name, schedul
+0000b380: 6529 0a20 2020 2020 2020 2022 2222 0a0a  e).        """..
+0000b390: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+0000b3a0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+0000b3b0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+0000b3c0: 6563 740a 2020 2020 2020 2020 7061 7468  ect.        path
+0000b3d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0000b3e0: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
+0000b3f0: 7322 0a0a 2020 2020 2020 2020 6572 726f  s"..        erro
+0000b400: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0000b410: 696c 6564 2063 7265 6174 696e 6720 7363  iled creating sc
+0000b420: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
+0000b430: 2f7b 7363 6865 6475 6c65 2e6e 616d 657d  /{schedule.name}
+0000b440: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+0000b450: 7069 5f63 616c 6c28 2250 4f53 5422 2c20  pi_call("POST", 
+0000b460: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+0000b470: 6167 652c 2062 6f64 793d 6469 6374 5f74  age, body=dict_t
+0000b480: 6f5f 6a73 6f6e 2873 6368 6564 756c 652e  o_json(schedule.
+0000b490: 6469 6374 2829 2929 0a0a 2020 2020 6465  dict()))..    de
+0000b4a0: 6620 7570 6461 7465 5f73 6368 6564 756c  f update_schedul
+0000b4b0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0000b4c0: 2070 726f 6a65 6374 3a20 7374 722c 206e   project: str, n
+0000b4d0: 616d 653a 2073 7472 2c20 7363 6865 6475  ame: str, schedu
+0000b4e0: 6c65 3a20 6d6c 7275 6e2e 636f 6d6d 6f6e  le: mlrun.common
+0000b4f0: 2e73 6368 656d 6173 2e53 6368 6564 756c  .schemas.Schedul
+0000b500: 6555 7064 6174 650a 2020 2020 293a 0a20  eUpdate.    ):. 
+0000b510: 2020 2020 2020 2022 2222 5570 6461 7465         """Update
+0000b520: 2061 6e20 6578 6973 7469 6e67 2073 6368   an existing sch
+0000b530: 6564 756c 652c 2072 6570 6c61 6365 2069  edule, replace i
+0000b540: 7420 7769 7468 2074 6865 2064 6574 6169  t with the detai
+0000b550: 6c73 2063 6f6e 7461 696e 6564 2069 6e20  ls contained in 
+0000b560: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
+0000b570: 6563 742e 2222 220a 0a20 2020 2020 2020  ect."""..       
+0000b580: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+0000b590: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+0000b5a0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+0000b5b0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+0000b5c0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0000b5d0: 2f73 6368 6564 756c 6573 2f7b 6e61 6d65  /schedules/{name
+0000b5e0: 7d22 0a0a 2020 2020 2020 2020 6572 726f  }"..        erro
+0000b5f0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0000b600: 696c 6564 2075 7064 6174 696e 6720 7363  iled updating sc
+0000b610: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
+0000b620: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+0000b630: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+0000b640: 5055 5422 2c20 7061 7468 2c20 6572 726f  PUT", path, erro
+0000b650: 725f 6d65 7373 6167 652c 2062 6f64 793d  r_message, body=
+0000b660: 6469 6374 5f74 6f5f 6a73 6f6e 2873 6368  dict_to_json(sch
+0000b670: 6564 756c 652e 6469 6374 2829 2929 0a0a  edule.dict()))..
+0000b680: 2020 2020 6465 6620 6765 745f 7363 6865      def get_sche
+0000b690: 6475 6c65 280a 2020 2020 2020 2020 7365  dule(.        se
+0000b6a0: 6c66 2c20 7072 6f6a 6563 743a 2073 7472  lf, project: str
+0000b6b0: 2c20 6e61 6d65 3a20 7374 722c 2069 6e63  , name: str, inc
+0000b6c0: 6c75 6465 5f6c 6173 745f 7275 6e3a 2062  lude_last_run: b
+0000b6d0: 6f6f 6c20 3d20 4661 6c73 650a 2020 2020  ool = False.    
+0000b6e0: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+0000b6f0: 6e2e 7363 6865 6d61 732e 5363 6865 6475  n.schemas.Schedu
+0000b700: 6c65 4f75 7470 7574 3a0a 2020 2020 2020  leOutput:.      
+0000b710: 2020 2222 2252 6574 7269 6576 6520 6465    """Retrieve de
+0000b720: 7461 696c 7320 6f66 2074 6865 2073 6368  tails of the sch
+0000b730: 6564 756c 6520 696e 2071 7565 7374 696f  edule in questio
+0000b740: 6e2e 2042 6573 6964 6573 2072 6574 7572  n. Besides retur
+0000b750: 6e69 6e67 2074 6865 2064 6574 6169 6c73  ning the details
+0000b760: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
+0000b770: 206f 626a 6563 7420 6974 7365 6c66 2c0a   object itself,.
+0000b780: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
+0000b790: 6374 696f 6e20 616c 736f 2072 6574 7572  ction also retur
+0000b7a0: 6e73 2074 6865 206e 6578 7420 7363 6865  ns the next sche
+0000b7b0: 6475 6c65 6420 7275 6e20 666f 7220 7468  duled run for th
+0000b7c0: 6973 2073 7065 6369 6669 6320 7363 6865  is specific sche
+0000b7d0: 6475 6c65 2c20 6173 2077 656c 6c20 6173  dule, as well as
+0000b7e0: 2070 6f74 656e 7469 616c 6c79 2074 6865   potentially the
+0000b7f0: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
+0000b800: 206f 6620 7468 6520 6c61 7374 2072 756e   of the last run
+0000b810: 2065 7865 6375 7465 6420 7468 726f 7567   executed throug
+0000b820: 6820 7468 6973 2073 6368 6564 756c 652e  h this schedule.
+0000b830: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000b840: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+0000b850: 7420 6e61 6d65 2e0a 2020 2020 2020 2020  t name..        
+0000b860: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+0000b870: 6520 6f66 2074 6865 2073 6368 6564 756c  e of the schedul
+0000b880: 6520 6f62 6a65 6374 2074 6f20 7175 6572  e object to quer
+0000b890: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+0000b8a0: 6d20 696e 636c 7564 655f 6c61 7374 5f72  m include_last_r
+0000b8b0: 756e 3a20 5768 6574 6865 7220 746f 2069  un: Whether to i
+0000b8c0: 6e63 6c75 6465 2074 6865 2072 6573 756c  nclude the resul
+0000b8d0: 7473 206f 6620 7468 6520 7363 6865 6475  ts of the schedu
+0000b8e0: 6c65 2773 206c 6173 7420 7275 6e20 696e  le's last run in
+0000b8f0: 2074 6865 2072 6573 706f 6e73 652e 0a20   the response.. 
+0000b900: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000b910: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000b920: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000b930: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000b940: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0000b950: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0000b960: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
+0000b970: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
+0000b980: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+0000b990: 4661 696c 6564 2067 6574 7469 6e67 2073  Failed getting s
+0000b9a0: 6368 6564 756c 6520 666f 7220 7b70 726f  chedule for {pro
+0000b9b0: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+0000b9c0: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+0000b9d0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+0000b9e0: 2020 2020 2020 2020 2247 4554 222c 2070          "GET", p
+0000b9f0: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+0000ba00: 6765 2c20 7061 7261 6d73 3d7b 2269 6e63  ge, params={"inc
+0000ba10: 6c75 6465 5f6c 6173 745f 7275 6e22 3a20  lude_last_run": 
+0000ba20: 696e 636c 7564 655f 6c61 7374 5f72 756e  include_last_run
+0000ba30: 7d0a 2020 2020 2020 2020 290a 2020 2020  }.        ).    
+0000ba40: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+0000ba50: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000ba60: 5363 6865 6475 6c65 4f75 7470 7574 282a  ScheduleOutput(*
+0000ba70: 2a72 6573 702e 6a73 6f6e 2829 290a 0a20  *resp.json()).. 
+0000ba80: 2020 2064 6566 206c 6973 745f 7363 6865     def list_sche
+0000ba90: 6475 6c65 7328 0a20 2020 2020 2020 2073  dules(.        s
+0000baa0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+0000bab0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+0000bac0: 2020 206e 616d 653a 2073 7472 203d 204e     name: str = N
+0000bad0: 6f6e 652c 0a20 2020 2020 2020 206b 696e  one,.        kin
+0000bae0: 643a 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  d: mlrun.common.
+0000baf0: 7363 6865 6d61 732e 5363 6865 6475 6c65  schemas.Schedule
+0000bb00: 4b69 6e64 7320 3d20 4e6f 6e65 2c0a 2020  Kinds = None,.  
+0000bb10: 2020 2020 2020 696e 636c 7564 655f 6c61        include_la
+0000bb20: 7374 5f72 756e 3a20 626f 6f6c 203d 2046  st_run: bool = F
+0000bb30: 616c 7365 2c0a 2020 2020 2920 2d3e 206d  alse,.    ) -> m
+0000bb40: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000bb50: 6d61 732e 5363 6865 6475 6c65 734f 7574  mas.SchedulesOut
+0000bb60: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
+0000bb70: 5265 7472 6965 7665 206c 6973 7420 6f66  Retrieve list of
+0000bb80: 2073 6368 6564 756c 6573 206f 6620 7370   schedules of sp
+0000bb90: 6563 6966 6963 206e 616d 6520 6f72 206b  ecific name or k
+0000bba0: 696e 642e 0a0a 2020 2020 2020 2020 3a70  ind...        :p
+0000bbb0: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
+0000bbc0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
+0000bbd0: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+0000bbe0: 204e 616d 6520 6f66 2073 6368 6564 756c   Name of schedul
+0000bbf0: 6520 746f 2072 6574 7269 6576 652e 2043  e to retrieve. C
+0000bc00: 616e 2062 6520 6f6d 6974 7465 6420 746f  an be omitted to
+0000bc10: 206c 6973 7420 616c 6c20 7363 6865 6475   list all schedu
+0000bc20: 6c65 732e 0a20 2020 2020 2020 203a 7061  les..        :pa
+0000bc30: 7261 6d20 6b69 6e64 3a20 4b69 6e64 206f  ram kind: Kind o
+0000bc40: 6620 7363 6865 6475 6c65 206f 626a 6563  f schedule objec
+0000bc50: 7473 2074 6f20 7265 7472 6965 7665 2c20  ts to retrieve, 
+0000bc60: 6361 6e20 6265 2065 6974 6865 7220 6060  can be either ``
+0000bc70: 6a6f 6260 6020 6f72 2060 6070 6970 656c  job`` or ``pipel
+0000bc80: 696e 6560 602e 0a20 2020 2020 2020 203a  ine``..        :
+0000bc90: 7061 7261 6d20 696e 636c 7564 655f 6c61  param include_la
+0000bca0: 7374 5f72 756e 3a20 5768 6574 6865 7220  st_run: Whether 
+0000bcb0: 746f 2072 6574 7572 6e20 666f 7220 6561  to return for ea
+0000bcc0: 6368 2073 6368 6564 756c 6520 7265 7475  ch schedule retu
+0000bcd0: 726e 6564 2061 6c73 6f20 7468 6520 7265  rned also the re
+0000bce0: 7375 6c74 7320 6f66 2074 6865 206c 6173  sults of the las
+0000bcf0: 7420 7275 6e20 6f66 0a20 2020 2020 2020  t run of.       
+0000bd00: 2020 2020 2074 6861 7420 7363 6865 6475       that schedu
+0000bd10: 6c65 2e0a 2020 2020 2020 2020 2222 220a  le..        """.
+0000bd20: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000bd30: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+0000bd40: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+0000bd50: 6a65 6374 0a20 2020 2020 2020 2070 6172  ject.        par
+0000bd60: 616d 7320 3d20 7b22 6b69 6e64 223a 206b  ams = {"kind": k
+0000bd70: 696e 642c 2022 6e61 6d65 223a 206e 616d  ind, "name": nam
+0000bd80: 652c 2022 696e 636c 7564 655f 6c61 7374  e, "include_last
+0000bd90: 5f72 756e 223a 2069 6e63 6c75 6465 5f6c  _run": include_l
+0000bda0: 6173 745f 7275 6e7d 0a20 2020 2020 2020  ast_run}.       
+0000bdb0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0000bdc0: 7473 2f7b 7072 6f6a 6563 747d 2f73 6368  ts/{project}/sch
+0000bdd0: 6564 756c 6573 220a 2020 2020 2020 2020  edules".        
+0000bde0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0000bdf0: 6622 4661 696c 6564 206c 6973 7469 6e67  f"Failed listing
+0000be00: 2073 6368 6564 756c 6573 2066 6f72 207b   schedules for {
+0000be10: 7072 6f6a 6563 747d 203f 207b 6b69 6e64  project} ? {kind
+0000be20: 7d20 7b6e 616d 657d 220a 2020 2020 2020  } {name}".      
+0000be30: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+0000be40: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+0000be50: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+0000be60: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
+0000be70: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000be80: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000be90: 6865 6d61 732e 5363 6865 6475 6c65 734f  hemas.SchedulesO
+0000bea0: 7574 7075 7428 2a2a 7265 7370 2e6a 736f  utput(**resp.jso
+0000beb0: 6e28 2929 0a0a 2020 2020 6465 6620 6465  n())..    def de
+0000bec0: 6c65 7465 5f73 6368 6564 756c 6528 7365  lete_schedule(se
+0000bed0: 6c66 2c20 7072 6f6a 6563 743a 2073 7472  lf, project: str
+0000bee0: 2c20 6e61 6d65 3a20 7374 7229 3a0a 2020  , name: str):.  
+0000bef0: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+0000bf00: 6120 7370 6563 6966 6963 2073 6368 6564  a specific sched
+0000bf10: 756c 6520 6279 206e 616d 652e 2222 220a  ule by name.""".
+0000bf20: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000bf30: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+0000bf40: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+0000bf50: 6a65 6374 0a20 2020 2020 2020 2070 6174  ject.        pat
+0000bf60: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+0000bf70: 7072 6f6a 6563 747d 2f73 6368 6564 756c  project}/schedul
+0000bf80: 6573 2f7b 6e61 6d65 7d22 0a20 2020 2020  es/{name}".     
+0000bf90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0000bfa0: 203d 2066 2246 6169 6c65 6420 6465 6c65   = f"Failed dele
+0000bfb0: 7469 6e67 2073 6368 6564 756c 6520 7b70  ting schedule {p
+0000bfc0: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+0000bfd0: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+0000bfe0: 5f63 616c 6c28 2244 454c 4554 4522 2c20  _call("DELETE", 
+0000bff0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+0000c000: 6167 6529 0a0a 2020 2020 6465 6620 696e  age)..    def in
+0000c010: 766f 6b65 5f73 6368 6564 756c 6528 7365  voke_schedule(se
+0000c020: 6c66 2c20 7072 6f6a 6563 743a 2073 7472  lf, project: str
+0000c030: 2c20 6e61 6d65 3a20 7374 7229 3a0a 2020  , name: str):.  
+0000c040: 2020 2020 2020 2222 2245 7865 6375 7465        """Execute
+0000c050: 2074 6865 206f 626a 6563 7420 7265 6665   the object refe
+0000c060: 7265 6e63 6564 2062 7920 7468 6520 7363  renced by the sc
+0000c070: 6865 6475 6c65 2069 6d6d 6564 6961 7465  hedule immediate
+0000c080: 6c79 2e22 2222 0a0a 2020 2020 2020 2020  ly."""..        
+0000c090: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+0000c0a0: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
+0000c0b0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
+0000c0c0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0000c0d0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0000c0e0: 7363 6865 6475 6c65 732f 7b6e 616d 657d  schedules/{name}
+0000c0f0: 2f69 6e76 6f6b 6522 0a20 2020 2020 2020  /invoke".       
+0000c100: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+0000c110: 2066 2246 6169 6c65 6420 696e 766f 6b69   f"Failed invoki
+0000c120: 6e67 2073 6368 6564 756c 6520 7b70 726f  ng schedule {pro
+0000c130: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+0000c140: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
+0000c150: 616c 6c28 2250 4f53 5422 2c20 7061 7468  all("POST", path
+0000c160: 2c20 6572 726f 725f 6d65 7373 6167 6529  , error_message)
+0000c170: 0a0a 2020 2020 6465 6620 7265 6d6f 7465  ..    def remote
+0000c180: 5f62 7569 6c64 6572 280a 2020 2020 2020  _builder(.      
+0000c190: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000c1a0: 6675 6e63 2c0a 2020 2020 2020 2020 7769  func,.        wi
+0000c1b0: 7468 5f6d 6c72 756e 2c0a 2020 2020 2020  th_mlrun,.      
+0000c1c0: 2020 6d6c 7275 6e5f 7665 7273 696f 6e5f    mlrun_version_
+0000c1d0: 7370 6563 6966 6965 723d 4e6f 6e65 2c0a  specifier=None,.
+0000c1e0: 2020 2020 2020 2020 736b 6970 5f64 6570          skip_dep
+0000c1f0: 6c6f 7965 643d 4661 6c73 652c 0a20 2020  loyed=False,.   
+0000c200: 2020 2020 2062 7569 6c64 6572 5f65 6e76       builder_env
+0000c210: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+0000c220: 2020 2020 2020 2222 2242 7569 6c64 2074        """Build t
+0000c230: 6865 2070 6f64 2069 6d61 6765 2066 6f72  he pod image for
+0000c240: 2061 2066 756e 6374 696f 6e2c 2066 6f72   a function, for
+0000c250: 2065 7865 6375 7469 6f6e 206f 6e20 6120   execution on a 
+0000c260: 7265 6d6f 7465 2063 6c75 7374 6572 2e20  remote cluster. 
+0000c270: 5468 6973 2069 7320 6578 6563 7574 6564  This is executed
+0000c280: 2062 7920 7468 6520 4d4c 5275 6e0a 2020   by the MLRun.  
+0000c290: 2020 2020 2020 4150 4920 7365 7276 6572        API server
+0000c2a0: 2c20 616e 6420 6372 6561 7465 7320 6120  , and creates a 
+0000c2b0: 446f 636b 6572 2069 6d61 6765 206f 7574  Docker image out
+0000c2c0: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
+0000c2d0: 2070 726f 7669 6465 6420 616e 6420 616e   provided and an
+0000c2e0: 7920 7370 6563 6966 6963 2062 7569 6c64  y specific build
+0000c2f0: 0a20 2020 2020 2020 2069 6e73 7472 7563  .        instruc
+0000c300: 7469 6f6e 7320 7072 6f76 6964 6564 2077  tions provided w
+0000c310: 6974 6869 6e2e 2054 6869 7320 6973 2061  ithin. This is a
+0000c320: 2070 7265 2d72 6571 7569 7369 7465 2066   pre-requisite f
+0000c330: 6f72 2072 656d 6f74 656c 7920 6578 6563  or remotely exec
+0000c340: 7574 696e 6720 6120 6675 6e63 7469 6f6e  uting a function
+0000c350: 2c20 756e 6c65 7373 2075 7369 6e67 0a20  , unless using. 
+0000c360: 2020 2020 2020 2061 2070 7265 2d64 6570         a pre-dep
+0000c370: 6c6f 7965 6420 696d 6167 652e 0a0a 2020  loyed image...  
+0000c380: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0000c390: 633a 2046 756e 6374 696f 6e20 746f 2062  c: Function to b
+0000c3a0: 7569 6c64 2e0a 2020 2020 2020 2020 3a70  uild..        :p
+0000c3b0: 6172 616d 2077 6974 685f 6d6c 7275 6e3a  aram with_mlrun:
+0000c3c0: 2057 6865 7468 6572 2074 6f20 6164 6420   Whether to add 
+0000c3d0: 4d4c 5275 6e20 7061 636b 6167 6520 746f  MLRun package to
+0000c3e0: 2074 6865 2062 7569 6c74 2070 6163 6b61   the built packa
+0000c3f0: 6765 2e20 5468 6973 2069 7320 6e6f 7420  ge. This is not 
+0000c400: 7265 7175 6972 6564 2069 6620 7573 696e  required if usin
+0000c410: 6720 6120 6261 7365 0a20 2020 2020 2020  g a base.       
+0000c420: 2020 2020 2069 6d61 6765 2074 6861 7420       image that 
+0000c430: 616c 7265 6164 7920 6861 7320 4d4c 5275  already has MLRu
+0000c440: 6e20 696e 2069 742e 0a20 2020 2020 2020  n in it..       
+0000c450: 203a 7061 7261 6d20 6d6c 7275 6e5f 7665   :param mlrun_ve
+0000c460: 7273 696f 6e5f 7370 6563 6966 6965 723a  rsion_specifier:
+0000c470: 2056 6572 7369 6f6e 206f 6620 4d4c 5275   Version of MLRu
+0000c480: 6e20 746f 2069 6e63 6c75 6465 2069 6e20  n to include in 
+0000c490: 7468 6520 6275 696c 7420 696d 6167 652e  the built image.
+0000c4a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000c4b0: 736b 6970 5f64 6570 6c6f 7965 643a 2053  skip_deployed: S
+0000c4c0: 6b69 7020 7468 6520 6275 696c 6420 6966  kip the build if
+0000c4d0: 2077 6520 616c 7265 6164 7920 6861 7665   we already have
+0000c4e0: 2061 6e20 696d 6167 6520 666f 7220 7468   an image for th
+0000c4f0: 6520 6675 6e63 7469 6f6e 2e0a 2020 2020  e function..    
+0000c500: 2020 2020 3a70 6172 616d 2062 7569 6c64      :param build
+0000c510: 6572 5f65 6e76 3a20 2020 4b61 6e69 6b6f  er_env:   Kaniko
+0000c520: 2062 7569 6c64 6572 2070 6f64 2065 6e76   builder pod env
+0000c530: 2076 6172 7320 6469 6374 2028 666f 7220   vars dict (for 
+0000c540: 636f 6e66 6967 2f63 7265 6465 6e74 6961  config/credentia
+0000c550: 6c73 290a 2020 2020 2020 2020 2222 220a  ls).        """.
+0000c560: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0000c570: 2020 2020 2020 2020 2020 7265 7120 3d20            req = 
+0000c580: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000c590: 2020 2266 756e 6374 696f 6e22 3a20 6675    "function": fu
+0000c5a0: 6e63 2e74 6f5f 6469 6374 2829 2c0a 2020  nc.to_dict(),.  
+0000c5b0: 2020 2020 2020 2020 2020 2020 2020 2277                "w
+0000c5c0: 6974 685f 6d6c 7275 6e22 3a20 626f 6f6c  ith_mlrun": bool
+0000c5d0: 3273 7472 2877 6974 685f 6d6c 7275 6e29  2str(with_mlrun)
+0000c5e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c5f0: 2020 2273 6b69 705f 6465 706c 6f79 6564    "skip_deployed
+0000c600: 223a 2073 6b69 705f 6465 706c 6f79 6564  ": skip_deployed
+0000c610: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
+0000c620: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0000c630: 6c72 756e 5f76 6572 7369 6f6e 5f73 7065  lrun_version_spe
+0000c640: 6369 6669 6572 3a0a 2020 2020 2020 2020  cifier:.        
+0000c650: 2020 2020 2020 2020 7265 715b 226d 6c72          req["mlr
+0000c660: 756e 5f76 6572 7369 6f6e 5f73 7065 6369  un_version_speci
+0000c670: 6669 6572 225d 203d 206d 6c72 756e 5f76  fier"] = mlrun_v
+0000c680: 6572 7369 6f6e 5f73 7065 6369 6669 6572  ersion_specifier
+0000c690: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000c6a0: 6275 696c 6465 725f 656e 763a 0a20 2020  builder_env:.   
+0000c6b0: 2020 2020 2020 2020 2020 2020 2072 6571               req
+0000c6c0: 5b22 6275 696c 6465 725f 656e 7622 5d20  ["builder_env"] 
+0000c6d0: 3d20 6275 696c 6465 725f 656e 760a 2020  = builder_env.  
+0000c6e0: 2020 2020 2020 2020 2020 7265 7370 203d            resp =
+0000c6f0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+0000c700: 504f 5354 222c 2022 6275 696c 642f 6675  POST", "build/fu
+0000c710: 6e63 7469 6f6e 222c 206a 736f 6e3d 7265  nction", json=re
+0000c720: 7129 0a20 2020 2020 2020 2065 7863 6570  q).        excep
+0000c730: 7420 4f53 4572 726f 7220 6173 2065 7272  t OSError as err
+0000c740: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+0000c750: 6767 6572 2e65 7272 6f72 2866 2265 7272  gger.error(f"err
+0000c760: 6f72 2073 7562 6d69 7474 696e 6720 6275  or submitting bu
+0000c770: 696c 6420 7461 736b 3a20 7b65 7272 5f74  ild task: {err_t
+0000c780: 6f5f 7374 7228 6572 7229 7d22 290a 2020  o_str(err)}").  
+0000c790: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000c7a0: 4f53 4572 726f 7228 6622 6572 726f 723a  OSError(f"error:
+0000c7b0: 2063 616e 6e6f 7420 7375 626d 6974 2062   cannot submit b
+0000c7c0: 7569 6c64 2c20 7b65 7272 5f74 6f5f 7374  uild, {err_to_st
+0000c7d0: 7228 6572 7229 7d22 290a 0a20 2020 2020  r(err)}")..     
+0000c7e0: 2020 2069 6620 6e6f 7420 7265 7370 2e6f     if not resp.o
+0000c7f0: 6b3a 0a20 2020 2020 2020 2020 2020 206c  k:.            l
+0000c800: 6f67 6765 722e 6572 726f 7228 6622 6261  ogger.error(f"ba
+0000c810: 6420 7265 7370 2121 5c6e 7b72 6573 702e  d resp!!\n{resp.
+0000c820: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
+0000c830: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000c840: 7272 6f72 2822 6261 6420 6675 6e63 7469  rror("bad functi
+0000c850: 6f6e 2072 756e 2072 6573 706f 6e73 6522  on run response"
+0000c860: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000c870: 6e20 7265 7370 2e6a 736f 6e28 290a 0a20  n resp.json().. 
+0000c880: 2020 2064 6566 2067 6574 5f62 7569 6c64     def get_build
+0000c890: 6572 5f73 7461 7475 7328 0a20 2020 2020  er_status(.     
+0000c8a0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000c8b0: 2066 756e 633a 2042 6173 6552 756e 7469   func: BaseRunti
+0000c8c0: 6d65 2c0a 2020 2020 2020 2020 6f66 6673  me,.        offs
+0000c8d0: 6574 3a20 696e 7420 3d20 302c 0a20 2020  et: int = 0,.   
+0000c8e0: 2020 2020 206c 6f67 733a 2062 6f6f 6c20       logs: bool 
+0000c8f0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+0000c900: 6c61 7374 5f6c 6f67 5f74 696d 6573 7461  last_log_timesta
+0000c910: 6d70 3a20 666c 6f61 7420 3d20 302e 302c  mp: float = 0.0,
+0000c920: 0a20 2020 2020 2020 2076 6572 626f 7365  .        verbose
+0000c930: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0000c940: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0000c950: 2222 5265 7472 6965 7665 2074 6865 2073  ""Retrieve the s
+0000c960: 7461 7475 7320 6f66 2061 2062 7569 6c64  tatus of a build
+0000c970: 206f 7065 7261 7469 6f6e 2063 7572 7265   operation curre
+0000c980: 6e74 6c79 2069 6e20 7072 6f67 7265 7373  ntly in progress
+0000c990: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000c9a0: 6d20 6675 6e63 3a20 2020 2020 2020 2020  m func:         
+0000c9b0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0000c9c0: 6f62 6a65 6374 2074 6861 7420 6973 2062  object that is b
+0000c9d0: 6569 6e67 2062 7569 6c74 2e0a 2020 2020  eing built..    
+0000c9e0: 2020 2020 3a70 6172 616d 206f 6666 7365      :param offse
+0000c9f0: 743a 2020 2020 2020 2020 2020 2020 2020  t:              
+0000ca00: 4f66 6673 6574 2069 6e74 6f20 7468 6520  Offset into the 
+0000ca10: 6275 696c 6420 6c6f 6773 2074 6f20 7265  build logs to re
+0000ca20: 7472 6965 7665 206c 6f67 7320 6672 6f6d  trieve logs from
+0000ca30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000ca40: 206c 6f67 733a 2020 2020 2020 2020 2020   logs:          
+0000ca50: 2020 2020 2020 5368 6f75 6c64 2062 7569        Should bui
+0000ca60: 6c64 206c 6f67 7320 6265 2072 6574 7269  ld logs be retri
+0000ca70: 6576 6564 2e0a 2020 2020 2020 2020 3a70  eved..        :p
+0000ca80: 6172 616d 206c 6173 745f 6c6f 675f 7469  aram last_log_ti
+0000ca90: 6d65 7374 616d 703a 2020 4c61 7374 2074  mestamp:  Last t
+0000caa0: 696d 6573 7461 6d70 206f 6620 6c6f 6773  imestamp of logs
+0000cab0: 2074 6861 7420 7765 7265 2061 6c72 6561   that were alrea
+0000cac0: 6479 2072 6574 7269 6576 6564 2e20 4675  dy retrieved. Fu
+0000cad0: 6e63 7469 6f6e 2077 696c 6c20 7265 7475  nction will retu
+0000cae0: 726e 206f 6e6c 7920 6c6f 6773 0a20 2020  rn only logs.   
+0000caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb10: 206c 6174 6572 2074 6861 6e20 7468 6973   later than this
+0000cb20: 2070 6172 616d 6574 6572 2e0a 2020 2020   parameter..    
+0000cb30: 2020 2020 3a70 6172 616d 2076 6572 626f      :param verbo
+0000cb40: 7365 3a20 2020 2020 2020 2020 2020 2020  se:             
+0000cb50: 4164 6420 7665 7262 6f73 6520 6c6f 6773  Add verbose logs
+0000cb60: 2069 6e74 6f20 7468 6520 6f75 7470 7574   into the output
+0000cb70: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+0000cb80: 726e 733a 2054 6865 2066 6f6c 6c6f 7769  rns: The followi
+0000cb90: 6e67 2070 6172 616d 6574 6572 733a 0a0a  ng parameters:..
+0000cba0: 2020 2020 2020 2020 2020 2020 2d20 5465              - Te
+0000cbb0: 7874 206f 6620 6275 696c 6465 7220 6c6f  xt of builder lo
+0000cbc0: 6773 2e0a 2020 2020 2020 2020 2020 2020  gs..            
+0000cbd0: 2d20 5469 6d65 7374 616d 7020 6f66 206c  - Timestamp of l
+0000cbe0: 6173 7420 6c6f 6720 7265 7472 6965 7665  ast log retrieve
+0000cbf0: 642c 2074 6f20 6265 2075 7365 6420 696e  d, to be used in
+0000cc00: 2073 7562 7365 7175 656e 7420 6361 6c6c   subsequent call
+0000cc10: 7320 746f 2074 6869 7320 6675 6e63 7469  s to this functi
+0000cc20: 6f6e 2e0a 0a20 2020 2020 2020 2020 2020  on...           
+0000cc30: 2054 6865 2066 756e 6374 696f 6e20 616c   The function al
+0000cc40: 736f 2075 7064 6174 6573 2069 6e74 6572  so updates inter
+0000cc50: 6e61 6c20 6d65 6d62 6572 7320 6f66 2074  nal members of t
+0000cc60: 6865 2060 6066 756e 6360 6020 6f62 6a65  he ``func`` obje
+0000cc70: 6374 2074 6f20 7265 666c 6563 7420 6275  ct to reflect bu
+0000cc80: 696c 6420 7072 6f63 6573 7320 696e 666f  ild process info
+0000cc90: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+0000cca0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000ccb0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0000ccc0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0000ccd0: 2020 2022 6e61 6d65 223a 206e 6f72 6d61     "name": norma
+0000cce0: 6c69 7a65 5f6e 616d 6528 6675 6e63 2e6d  lize_name(func.m
+0000ccf0: 6574 6164 6174 612e 6e61 6d65 292c 0a20  etadata.name),. 
+0000cd00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000cd10: 7072 6f6a 6563 7422 3a20 6675 6e63 2e6d  project": func.m
+0000cd20: 6574 6164 6174 612e 7072 6f6a 6563 742c  etadata.project,
+0000cd30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd40: 2022 7461 6722 3a20 6675 6e63 2e6d 6574   "tag": func.met
+0000cd50: 6164 6174 612e 7461 672c 0a20 2020 2020  adata.tag,.     
+0000cd60: 2020 2020 2020 2020 2020 2022 6c6f 6773             "logs
+0000cd70: 223a 2062 6f6f 6c32 7374 7228 6c6f 6773  ": bool2str(logs
+0000cd80: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000cd90: 2020 2022 6f66 6673 6574 223a 2073 7472     "offset": str
+0000cda0: 286f 6666 7365 7429 2c0a 2020 2020 2020  (offset),.      
+0000cdb0: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
+0000cdc0: 6c6f 675f 7469 6d65 7374 616d 7022 3a20  log_timestamp": 
+0000cdd0: 7374 7228 6c61 7374 5f6c 6f67 5f74 696d  str(last_log_tim
+0000cde0: 6573 7461 6d70 292c 0a20 2020 2020 2020  estamp),.       
+0000cdf0: 2020 2020 2020 2020 2022 7665 7262 6f73           "verbos
+0000ce00: 6522 3a20 626f 6f6c 3273 7472 2876 6572  e": bool2str(ver
+0000ce10: 626f 7365 292c 0a20 2020 2020 2020 2020  bose),.         
+0000ce20: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0000ce30: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+0000ce40: 5f63 616c 6c28 2247 4554 222c 2022 6275  _call("GET", "bu
+0000ce50: 696c 642f 7374 6174 7573 222c 2070 6172  ild/status", par
+0000ce60: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+0000ce70: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
+0000ce80: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
+0000ce90: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+0000cea0: 726f 7228 6622 6572 726f 7220 6765 7474  ror(f"error gett
+0000ceb0: 696e 6720 6275 696c 6420 7374 6174 7573  ing build status
+0000cec0: 3a20 7b65 7272 5f74 6f5f 7374 7228 6572  : {err_to_str(er
+0000ced0: 7229 7d22 290a 2020 2020 2020 2020 2020  r)}").          
+0000cee0: 2020 7261 6973 6520 4f53 4572 726f 7228    raise OSError(
+0000cef0: 6622 6572 726f 723a 2063 616e 6e6f 7420  f"error: cannot 
+0000cf00: 6765 7420 6275 696c 6420 7374 6174 7573  get build status
+0000cf10: 2c20 7b65 7272 5f74 6f5f 7374 7228 6572  , {err_to_str(er
+0000cf20: 7229 7d22 290a 0a20 2020 2020 2020 2069  r)}")..        i
+0000cf30: 6620 6e6f 7420 7265 7370 2e6f 6b3a 0a20  f not resp.ok:. 
+0000cf40: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000cf50: 722e 7761 726e 696e 6728 6622 6661 696c  r.warning(f"fail
+0000cf60: 6564 2072 6573 702c 207b 7265 7370 2e74  ed resp, {resp.t
+0000cf70: 6578 747d 2229 0a20 2020 2020 2020 2020  ext}").         
+0000cf80: 2020 2072 6169 7365 2052 756e 4442 4572     raise RunDBEr
+0000cf90: 726f 7228 2262 6164 2066 756e 6374 696f  ror("bad functio
+0000cfa0: 6e20 6275 696c 6420 7265 7370 6f6e 7365  n build response
+0000cfb0: 2229 0a0a 2020 2020 2020 2020 6966 2072  ")..        if r
+0000cfc0: 6573 702e 6865 6164 6572 733a 0a20 2020  esp.headers:.   
+0000cfd0: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
+0000cfe0: 6174 7573 2e73 7461 7465 203d 2072 6573  atus.state = res
+0000cff0: 702e 6865 6164 6572 732e 6765 7428 2278  p.headers.get("x
+0000d000: 2d6d 6c72 756e 2d66 756e 6374 696f 6e2d  -mlrun-function-
+0000d010: 7374 6174 7573 222c 2022 2229 0a20 2020  status", "").   
+0000d020: 2020 2020 2020 2020 206c 6173 745f 6c6f           last_lo
+0000d030: 675f 7469 6d65 7374 616d 7020 3d20 666c  g_timestamp = fl
+0000d040: 6f61 7428 0a20 2020 2020 2020 2020 2020  oat(.           
+0000d050: 2020 2020 2072 6573 702e 6865 6164 6572       resp.header
+0000d060: 732e 6765 7428 2278 2d6d 6c72 756e 2d6c  s.get("x-mlrun-l
+0000d070: 6173 742d 7469 6d65 7374 616d 7022 2c20  ast-timestamp", 
+0000d080: 2230 2e30 2229 0a20 2020 2020 2020 2020  "0.0").         
+0000d090: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000d0a0: 2069 6620 6675 6e63 2e6b 696e 6420 696e   if func.kind in
+0000d0b0: 206d 6c72 756e 2e72 756e 7469 6d65 732e   mlrun.runtimes.
+0000d0c0: 5275 6e74 696d 654b 696e 6473 2e6e 7563  RuntimeKinds.nuc
+0000d0d0: 6c69 6f5f 7275 6e74 696d 6573 2829 3a0a  lio_runtimes():.
+0000d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0f0: 6675 6e63 2e73 7461 7475 732e 6164 6472  func.status.addr
+0000d100: 6573 7320 3d20 7265 7370 2e68 6561 6465  ess = resp.heade
+0000d110: 7273 2e67 6574 2822 782d 6d6c 7275 6e2d  rs.get("x-mlrun-
+0000d120: 6164 6472 6573 7322 2c20 2222 290a 2020  address", "").  
+0000d130: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0000d140: 6e63 2e73 7461 7475 732e 6e75 636c 696f  nc.status.nuclio
+0000d150: 5f6e 616d 6520 3d20 7265 7370 2e68 6561  _name = resp.hea
+0000d160: 6465 7273 2e67 6574 2822 782d 6d6c 7275  ders.get("x-mlru
+0000d170: 6e2d 6e61 6d65 222c 2022 2229 0a20 2020  n-name", "").   
+0000d180: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+0000d190: 632e 7374 6174 7573 2e69 6e74 6572 6e61  c.status.interna
+0000d1a0: 6c5f 696e 766f 6361 7469 6f6e 5f75 726c  l_invocation_url
+0000d1b0: 7320 3d20 7265 7370 2e68 6561 6465 7273  s = resp.headers
+0000d1c0: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+0000d1d0: 2020 2020 2020 2020 2020 2278 2d6d 6c72            "x-mlr
+0000d1e0: 756e 2d69 6e74 6572 6e61 6c2d 696e 766f  un-internal-invo
+0000d1f0: 6361 7469 6f6e 2d75 726c 7322 2c20 2222  cation-urls", ""
+0000d200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d210: 2029 2e73 706c 6974 2822 2c22 290a 2020   ).split(",").  
+0000d220: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0000d230: 6e63 2e73 7461 7475 732e 6578 7465 726e  nc.status.extern
+0000d240: 616c 5f69 6e76 6f63 6174 696f 6e5f 7572  al_invocation_ur
+0000d250: 6c73 203d 2072 6573 702e 6865 6164 6572  ls = resp.header
+0000d260: 732e 6765 7428 0a20 2020 2020 2020 2020  s.get(.         
+0000d270: 2020 2020 2020 2020 2020 2022 782d 6d6c             "x-ml
+0000d280: 7275 6e2d 6578 7465 726e 616c 2d69 6e76  run-external-inv
+0000d290: 6f63 6174 696f 6e2d 7572 6c73 222c 2022  ocation-urls", "
+0000d2a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000d2b0: 2020 292e 7370 6c69 7428 222c 2229 0a20    ).split(","). 
+0000d2c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d2d0: 756e 632e 7374 6174 7573 2e63 6f6e 7461  unc.status.conta
+0000d2e0: 696e 6572 5f69 6d61 6765 203d 2072 6573  iner_image = res
+0000d2f0: 702e 6865 6164 6572 732e 6765 7428 0a20  p.headers.get(. 
+0000d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d310: 2020 2022 782d 6d6c 7275 6e2d 636f 6e74     "x-mlrun-cont
+0000d320: 6169 6e65 722d 696d 6167 6522 2c20 2222  ainer-image", ""
+0000d330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d340: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
+0000d350: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000d360: 2020 2020 2066 756e 632e 7374 6174 7573       func.status
+0000d370: 2e62 7569 6c64 5f70 6f64 203d 2072 6573  .build_pod = res
+0000d380: 702e 6865 6164 6572 732e 6765 7428 2262  p.headers.get("b
+0000d390: 7569 6c64 6572 5f70 6f64 222c 2022 2229  uilder_pod", "")
+0000d3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d3b0: 2066 756e 632e 7370 6563 2e69 6d61 6765   func.spec.image
+0000d3c0: 203d 2072 6573 702e 6865 6164 6572 732e   = resp.headers.
+0000d3d0: 6765 7428 2266 756e 6374 696f 6e5f 696d  get("function_im
+0000d3e0: 6167 6522 2c20 2222 290a 0a20 2020 2020  age", "")..     
+0000d3f0: 2020 2074 6578 7420 3d20 2222 0a20 2020     text = "".   
+0000d400: 2020 2020 2069 6620 7265 7370 2e63 6f6e       if resp.con
+0000d410: 7465 6e74 3a0a 2020 2020 2020 2020 2020  tent:.          
+0000d420: 2020 7465 7874 203d 2072 6573 702e 636f    text = resp.co
+0000d430: 6e74 656e 742e 6465 636f 6465 2829 0a20  ntent.decode(). 
+0000d440: 2020 2020 2020 2072 6574 7572 6e20 7465         return te
+0000d450: 7874 2c20 6c61 7374 5f6c 6f67 5f74 696d  xt, last_log_tim
+0000d460: 6573 7461 6d70 0a0a 2020 2020 6465 6620  estamp..    def 
+0000d470: 7265 6d6f 7465 5f73 7461 7274 2873 656c  remote_start(sel
+0000d480: 662c 2066 756e 635f 7572 6c29 202d 3e20  f, func_url) -> 
+0000d490: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000d4a0: 656d 6173 2e42 6163 6b67 726f 756e 6454  emas.BackgroundT
+0000d4b0: 6173 6b3a 0a20 2020 2020 2020 2022 2222  ask:.        """
+0000d4c0: 4578 6563 7574 6520 6120 6675 6e63 7469  Execute a functi
+0000d4d0: 6f6e 2072 656d 6f74 656c 792c 2055 7365  on remotely, Use
+0000d4e0: 6420 666f 7220 6060 6461 736b 6060 2066  d for ``dask`` f
+0000d4f0: 756e 6374 696f 6e73 2e0a 0a20 2020 2020  unctions...     
+0000d500: 2020 203a 7061 7261 6d20 6675 6e63 5f75     :param func_u
+0000d510: 726c 3a20 5552 4c20 746f 2074 6865 2066  rl: URL to the f
+0000d520: 756e 6374 696f 6e20 746f 2062 6520 6578  unction to be ex
+0000d530: 6563 7574 6564 2e0a 2020 2020 2020 2020  ecuted..        
+0000d540: 3a72 6574 7572 6e73 3a20 4120 4261 636b  :returns: A Back
+0000d550: 6772 6f75 6e64 5461 736b 206f 626a 6563  groundTask objec
+0000d560: 742c 2077 6974 6820 6465 7461 696c 7320  t, with details 
+0000d570: 6f6e 2065 7865 6375 7469 6f6e 2070 726f  on execution pro
+0000d580: 6365 7373 2061 6e64 2069 7473 2073 7461  cess and its sta
+0000d590: 7475 732e 0a20 2020 2020 2020 2022 2222  tus..        """
+0000d5a0: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+0000d5b0: 2020 2020 2020 2020 2020 2072 6571 203d             req =
+0000d5c0: 207b 2266 756e 6374 696f 6e55 726c 223a   {"functionUrl":
+0000d5d0: 2066 756e 635f 7572 6c7d 0a20 2020 2020   func_url}.     
+0000d5e0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+0000d5f0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0000d600: 2020 2020 2020 2020 2020 2020 2022 504f               "PO
+0000d610: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
+0000d620: 2020 2020 2022 7374 6172 742f 6675 6e63       "start/func
+0000d630: 7469 6f6e 222c 0a20 2020 2020 2020 2020  tion",.         
+0000d640: 2020 2020 2020 206a 736f 6e3d 7265 712c         json=req,
+0000d650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d660: 2074 696d 656f 7574 3d69 6e74 2863 6f6e   timeout=int(con
+0000d670: 6669 672e 7375 626d 6974 5f74 696d 656f  fig.submit_timeo
+0000d680: 7574 2920 6f72 2036 302c 0a20 2020 2020  ut) or 60,.     
+0000d690: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000d6a0: 2065 7863 6570 7420 4f53 4572 726f 7220   except OSError 
+0000d6b0: 6173 2065 7272 3a0a 2020 2020 2020 2020  as err:.        
+0000d6c0: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
+0000d6d0: 2866 2265 7272 6f72 2073 7461 7274 696e  (f"error startin
+0000d6e0: 6720 6675 6e63 7469 6f6e 3a20 7b65 7272  g function: {err
+0000d6f0: 5f74 6f5f 7374 7228 6572 7229 7d22 290a  _to_str(err)}").
+0000d700: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000d710: 6520 4f53 4572 726f 7228 6622 6572 726f  e OSError(f"erro
+0000d720: 723a 2063 616e 6e6f 7420 7374 6172 7420  r: cannot start 
+0000d730: 6675 6e63 7469 6f6e 2c20 7b65 7272 5f74  function, {err_t
+0000d740: 6f5f 7374 7228 6572 7229 7d22 290a 0a20  o_str(err)}").. 
+0000d750: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
+0000d760: 7370 2e6f 6b3a 0a20 2020 2020 2020 2020  sp.ok:.         
+0000d770: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
+0000d780: 6622 6261 6420 7265 7370 2121 5c6e 7b72  f"bad resp!!\n{r
+0000d790: 6573 702e 7465 7874 7d22 290a 2020 2020  esp.text}").    
+0000d7a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000d7b0: 6c75 6545 7272 6f72 2822 6261 6420 6675  lueError("bad fu
+0000d7c0: 6e63 7469 6f6e 2073 7461 7274 2072 6573  nction start res
+0000d7d0: 706f 6e73 6522 290a 0a20 2020 2020 2020  ponse")..       
+0000d7e0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+0000d7f0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
+0000d800: 6b67 726f 756e 6454 6173 6b28 2a2a 7265  kgroundTask(**re
+0000d810: 7370 2e6a 736f 6e28 2929 0a0a 2020 2020  sp.json())..    
+0000d820: 6465 6620 6765 745f 7072 6f6a 6563 745f  def get_project_
+0000d830: 6261 636b 6772 6f75 6e64 5f74 6173 6b28  background_task(
+0000d840: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000d850: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+0000d860: 7374 722c 0a20 2020 2020 2020 206e 616d  str,.        nam
+0000d870: 653a 2073 7472 2c0a 2020 2020 2920 2d3e  e: str,.    ) ->
+0000d880: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000d890: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
+0000d8a0: 5461 736b 3a0a 2020 2020 2020 2020 2222  Task:.        ""
+0000d8b0: 2252 6574 7269 6576 6520 7570 6461 7465  "Retrieve update
+0000d8c0: 6420 696e 666f 726d 6174 696f 6e20 6f6e  d information on
+0000d8d0: 2061 2070 726f 6a65 6374 2062 6163 6b67   a project backg
+0000d8e0: 726f 756e 6420 7461 736b 2062 6569 6e67  round task being
+0000d8f0: 2065 7865 6375 7465 642e 2222 220a 0a20   executed.""".. 
+0000d900: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+0000d910: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+0000d920: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+0000d930: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
+0000d940: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+0000d950: 6f6a 6563 747d 2f62 6163 6b67 726f 756e  oject}/backgroun
+0000d960: 642d 7461 736b 732f 7b6e 616d 657d 220a  d-tasks/{name}".
+0000d970: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0000d980: 7373 6167 6520 3d20 280a 2020 2020 2020  ssage = (.      
+0000d990: 2020 2020 2020 6622 4661 696c 6564 2067        f"Failed g
+0000d9a0: 6574 7469 6e67 2070 726f 6a65 6374 2062  etting project b
+0000d9b0: 6163 6b67 726f 756e 6420 7461 736b 2e20  ackground task. 
+0000d9c0: 7072 6f6a 6563 743d 7b70 726f 6a65 6374  project={project
+0000d9d0: 7d2c 206e 616d 653d 7b6e 616d 657d 220a  }, name={name}".
+0000d9e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d9f0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+0000da00: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+0000da10: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+0000da20: 7373 6167 6529 0a20 2020 2020 2020 2072  ssage).        r
+0000da30: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0000da40: 6f6e 2e73 6368 656d 6173 2e42 6163 6b67  on.schemas.Backg
+0000da50: 726f 756e 6454 6173 6b28 2a2a 7265 7370  roundTask(**resp
+0000da60: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+0000da70: 2020 6465 6620 6765 745f 6261 636b 6772    def get_backgr
+0000da80: 6f75 6e64 5f74 6173 6b28 7365 6c66 2c20  ound_task(self, 
+0000da90: 6e61 6d65 3a20 7374 7229 202d 3e20 6d6c  name: str) -> ml
+0000daa0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000dab0: 6173 2e42 6163 6b67 726f 756e 6454 6173  as.BackgroundTas
+0000dac0: 6b3a 0a20 2020 2020 2020 2022 2222 5265  k:.        """Re
+0000dad0: 7472 6965 7665 2075 7064 6174 6564 2069  trieve updated i
+0000dae0: 6e66 6f72 6d61 7469 6f6e 206f 6e20 6120  nformation on a 
+0000daf0: 6261 636b 6772 6f75 6e64 2074 6173 6b20  background task 
+0000db00: 6265 696e 6720 6578 6563 7574 6564 2e22  being executed."
+0000db10: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0000db20: 203d 2066 2262 6163 6b67 726f 756e 642d   = f"background-
+0000db30: 7461 736b 732f 7b6e 616d 657d 220a 2020  tasks/{name}".  
+0000db40: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0000db50: 6167 6520 3d20 6622 4661 696c 6564 2067  age = f"Failed g
+0000db60: 6574 7469 6e67 2062 6163 6b67 726f 756e  etting backgroun
+0000db70: 6420 7461 736b 2e20 6e61 6d65 3d7b 6e61  d task. name={na
+0000db80: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+0000db90: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0000dba0: 5f63 616c 6c28 2247 4554 222c 2070 6174  _call("GET", pat
+0000dbb0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+0000dbc0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000dbd0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000dbe0: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
+0000dbf0: 5461 736b 282a 2a72 6573 706f 6e73 652e  Task(**response.
+0000dc00: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+0000dc10: 2072 656d 6f74 655f 7374 6174 7573 2873   remote_status(s
+0000dc20: 656c 662c 2070 726f 6a65 6374 2c20 6e61  elf, project, na
+0000dc30: 6d65 2c20 6b69 6e64 2c20 7365 6c65 6374  me, kind, select
+0000dc40: 6f72 293a 0a20 2020 2020 2020 2022 2222  or):.        """
+0000dc50: 5265 7472 6965 7665 2073 7461 7475 7320  Retrieve status 
+0000dc60: 6f66 2061 2066 756e 6374 696f 6e20 6265  of a function be
+0000dc70: 696e 6720 6578 6563 7574 6564 2072 656d  ing executed rem
+0000dc80: 6f74 656c 7920 2872 656c 6576 616e 7420  otely (relevant 
+0000dc90: 746f 2060 6064 6173 6b60 6020 6675 6e63  to ``dask`` func
+0000dca0: 7469 6f6e 7329 2e0a 0a20 2020 2020 2020  tions)...       
+0000dcb0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0000dcc0: 2054 6865 2070 726f 6a65 6374 206f 6620   The project of 
+0000dcd0: 7468 6520 6675 6e63 7469 6f6e 0a20 2020  the function.   
+0000dce0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+0000dcf0: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
+0000dd00: 6520 6675 6e63 7469 6f6e 0a20 2020 2020  e function.     
+0000dd10: 2020 203a 7061 7261 6d20 6b69 6e64 3a20     :param kind: 
+0000dd20: 5468 6520 6b69 6e64 206f 6620 7468 6520  The kind of the 
+0000dd30: 6675 6e63 7469 6f6e 2c20 6375 7272 656e  function, curren
+0000dd40: 746c 7920 6060 6461 736b 6060 2069 7320  tly ``dask`` is 
+0000dd50: 7375 7070 6f72 7465 642e 0a20 2020 2020  supported..     
+0000dd60: 2020 203a 7061 7261 6d20 7365 6c65 6374     :param select
+0000dd70: 6f72 3a20 5365 6c65 6374 6f72 2063 6c61  or: Selector cla
+0000dd80: 7573 6520 746f 2062 6520 6170 706c 6965  use to be applie
+0000dd90: 6420 746f 2074 6865 204b 7562 6572 6e65  d to the Kuberne
+0000dda0: 7465 7320 7374 6174 7573 2071 7565 7279  tes status query
+0000ddb0: 2074 6f20 6669 6c74 6572 2074 6865 2072   to filter the r
+0000ddc0: 6573 756c 7473 2e0a 2020 2020 2020 2020  esults..        
+0000ddd0: 2222 220a 0a20 2020 2020 2020 2074 7279  """..        try
+0000dde0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ddf0: 7120 3d20 7b22 6b69 6e64 223a 206b 696e  q = {"kind": kin
+0000de00: 642c 2022 7365 6c65 6374 6f72 223a 2073  d, "selector": s
+0000de10: 656c 6563 746f 722c 2022 7072 6f6a 6563  elector, "projec
+0000de20: 7422 3a20 7072 6f6a 6563 742c 2022 6e61  t": project, "na
+0000de30: 6d65 223a 206e 616d 657d 0a20 2020 2020  me": name}.     
+0000de40: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+0000de50: 6c66 2e61 7069 5f63 616c 6c28 2250 4f53  lf.api_call("POS
+0000de60: 5422 2c20 2273 7461 7475 732f 6675 6e63  T", "status/func
+0000de70: 7469 6f6e 222c 206a 736f 6e3d 7265 7129  tion", json=req)
+0000de80: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000de90: 4f53 4572 726f 7220 6173 2065 7272 3a0a  OSError as err:.
+0000dea0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0000deb0: 6572 2e65 7272 6f72 2866 2265 7272 6f72  er.error(f"error
+0000dec0: 2073 7461 7274 696e 6720 6675 6e63 7469   starting functi
+0000ded0: 6f6e 3a20 7b65 7272 5f74 6f5f 7374 7228  on: {err_to_str(
+0000dee0: 6572 7229 7d22 290a 2020 2020 2020 2020  err)}").        
+0000def0: 2020 2020 7261 6973 6520 4f53 4572 726f      raise OSErro
+0000df00: 7228 6622 6572 726f 723a 2063 616e 6e6f  r(f"error: canno
+0000df10: 7420 7374 6172 7420 6675 6e63 7469 6f6e  t start function
+0000df20: 2c20 7b65 7272 5f74 6f5f 7374 7228 6572  , {err_to_str(er
+0000df30: 7229 7d22 290a 0a20 2020 2020 2020 2069  r)}")..        i
+0000df40: 6620 6e6f 7420 7265 7370 2e6f 6b3a 0a20  f not resp.ok:. 
+0000df50: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000df60: 722e 6572 726f 7228 6622 6261 6420 7265  r.error(f"bad re
+0000df70: 7370 2121 5c6e 7b72 6573 702e 7465 7874  sp!!\n{resp.text
+0000df80: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0000df90: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000dfa0: 2822 6261 6420 6675 6e63 7469 6f6e 2073  ("bad function s
+0000dfb0: 7461 7475 7320 7265 7370 6f6e 7365 2229  tatus response")
+0000dfc0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000dfd0: 2072 6573 702e 6a73 6f6e 2829 5b22 6461   resp.json()["da
+0000dfe0: 7461 225d 0a0a 2020 2020 6465 6620 7375  ta"]..    def su
+0000dff0: 626d 6974 5f6a 6f62 280a 2020 2020 2020  bmit_job(.      
+0000e000: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000e010: 7275 6e73 7065 632c 0a20 2020 2020 2020  runspec,.       
+0000e020: 2073 6368 6564 756c 653a 2055 6e69 6f6e   schedule: Union
+0000e030: 5b73 7472 2c20 6d6c 7275 6e2e 636f 6d6d  [str, mlrun.comm
+0000e040: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
+0000e050: 756c 6543 726f 6e54 7269 6767 6572 5d20  uleCronTrigger] 
+0000e060: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0000e070: 2020 2020 2020 2022 2222 5375 626d 6974         """Submit
+0000e080: 2061 206a 6f62 2066 6f72 2072 656d 6f74   a job for remot
+0000e090: 6520 6578 6563 7574 696f 6e2e 0a0a 2020  e execution...  
+0000e0a0: 2020 2020 2020 3a70 6172 616d 2072 756e        :param run
+0000e0b0: 7370 6563 3a20 5468 6520 7275 6e74 696d  spec: The runtim
+0000e0c0: 6520 6f62 6a65 6374 2073 7065 6320 2854  e object spec (T
+0000e0d0: 6173 6b29 2074 6f20 6578 6563 7574 652e  ask) to execute.
+0000e0e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e0f0: 7363 6865 6475 6c65 3a20 5768 6574 6865  schedule: Whethe
+0000e100: 7220 746f 2073 6368 6564 756c 6520 7468  r to schedule th
+0000e110: 6973 206a 6f62 2075 7369 6e67 2061 2043  is job using a C
+0000e120: 726f 6e20 7472 6967 6765 722e 2049 6620  ron trigger. If 
+0000e130: 6e6f 7420 7370 6563 6966 6965 642c 2074  not specified, t
+0000e140: 6865 206a 6f62 2077 696c 6c20 6265 2073  he job will be s
+0000e150: 7562 6d69 7474 6564 0a20 2020 2020 2020  ubmitted.       
+0000e160: 2020 2020 2069 6d6d 6564 6961 7465 6c79       immediately
+0000e170: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+0000e180: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000e190: 2020 2020 2020 2020 7265 7120 3d20 7b22          req = {"
+0000e1a0: 7461 736b 223a 2072 756e 7370 6563 2e74  task": runspec.t
+0000e1b0: 6f5f 6469 6374 2829 7d0a 2020 2020 2020  o_dict()}.      
+0000e1c0: 2020 2020 2020 6966 2073 6368 6564 756c        if schedul
+0000e1d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000e1e0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000e1f0: 2873 6368 6564 756c 652c 206d 6c72 756e  (schedule, mlrun
+0000e200: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000e210: 5363 6865 6475 6c65 4372 6f6e 5472 6967  ScheduleCronTrig
+0000e220: 6765 7229 3a0a 2020 2020 2020 2020 2020  ger):.          
+0000e230: 2020 2020 2020 2020 2020 7363 6865 6475            schedu
+0000e240: 6c65 203d 2073 6368 6564 756c 652e 6469  le = schedule.di
+0000e250: 6374 2829 0a20 2020 2020 2020 2020 2020  ct().           
+0000e260: 2020 2020 2072 6571 5b22 7363 6865 6475       req["schedu
+0000e270: 6c65 225d 203d 2073 6368 6564 756c 650a  le"] = schedule.
+0000e280: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+0000e290: 6f75 7420 3d20 2869 6e74 2863 6f6e 6669  out = (int(confi
+0000e2a0: 672e 7375 626d 6974 5f74 696d 656f 7574  g.submit_timeout
+0000e2b0: 2920 6f72 2031 3230 2920 2b20 3230 0a20  ) or 120) + 20. 
+0000e2c0: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
+0000e2d0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000e2e0: 2250 4f53 5422 2c20 2273 7562 6d69 745f  "POST", "submit_
+0000e2f0: 6a6f 6222 2c20 6a73 6f6e 3d72 6571 2c20  job", json=req, 
+0000e300: 7469 6d65 6f75 743d 7469 6d65 6f75 7429  timeout=timeout)
+0000e310: 0a0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+0000e320: 2072 6571 7565 7374 732e 4854 5450 4572   requests.HTTPEr
+0000e330: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
+0000e340: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000e350: 7272 6f72 2866 2265 7272 6f72 2073 7562  rror(f"error sub
+0000e360: 6d69 7474 696e 6720 7461 736b 3a20 7b65  mitting task: {e
+0000e370: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
+0000e380: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0000e390: 6e6f 7420 6372 6561 7469 6e67 2061 206e  not creating a n
+0000e3a0: 6577 2065 7863 6570 7469 6f6e 2068 6572  ew exception her
+0000e3b0: 652c 2069 6e20 6f72 6465 7220 746f 206b  e, in order to k
+0000e3c0: 6565 7020 7468 6520 7265 7370 6f6e 7365  eep the response
+0000e3d0: 2061 6e64 2073 7461 7475 7320 636f 6465   and status code
+0000e3e0: 2069 6e20 7468 6520 6578 6365 7074 696f   in the exceptio
+0000e3f0: 6e0a 2020 2020 2020 2020 2020 2020 7261  n.            ra
+0000e400: 6973 650a 0a20 2020 2020 2020 2065 7863  ise..        exc
+0000e410: 6570 7420 4f53 4572 726f 7220 6173 2065  ept OSError as e
+0000e420: 7272 3a0a 2020 2020 2020 2020 2020 2020  rr:.            
+0000e430: 6c6f 6767 6572 2e65 7272 6f72 2866 2265  logger.error(f"e
+0000e440: 7272 6f72 2073 7562 6d69 7474 696e 6720  rror submitting 
+0000e450: 7461 736b 3a20 7b65 7272 5f74 6f5f 7374  task: {err_to_st
+0000e460: 7228 6572 7229 7d22 290a 2020 2020 2020  r(err)}").      
+0000e470: 2020 2020 2020 7261 6973 6520 4f53 4572        raise OSEr
+0000e480: 726f 7228 2265 7272 6f72 3a20 6361 6e6e  ror("error: cann
+0000e490: 6f74 2073 7562 6d69 7420 7461 736b 2229  ot submit task")
+0000e4a0: 2066 726f 6d20 6572 720a 0a20 2020 2020   from err..     
+0000e4b0: 2020 2069 6620 6e6f 7420 7265 7370 2e6f     if not resp.o
+0000e4c0: 6b3a 0a20 2020 2020 2020 2020 2020 206c  k:.            l
+0000e4d0: 6f67 6765 722e 6572 726f 7228 6622 6261  ogger.error(f"ba
+0000e4e0: 6420 7265 7370 2121 5c6e 7b72 6573 702e  d resp!!\n{resp.
+0000e4f0: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
+0000e500: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000e510: 7272 6f72 2866 2262 6164 2066 756e 6374  rror(f"bad funct
+0000e520: 696f 6e20 7275 6e20 7265 7370 6f6e 7365  ion run response
+0000e530: 2c20 7b72 6573 702e 7465 7874 7d22 290a  , {resp.text}").
+0000e540: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
+0000e550: 7265 7370 2e6a 736f 6e28 290a 2020 2020  resp.json().    
+0000e560: 2020 2020 7265 7475 726e 2072 6573 705b      return resp[
+0000e570: 2264 6174 6122 5d0a 0a20 2020 2064 6566  "data"]..    def
+0000e580: 2073 7562 6d69 745f 7069 7065 6c69 6e65   submit_pipeline
+0000e590: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000e5a0: 2020 2020 2020 2020 7072 6f6a 6563 742c          project,
+0000e5b0: 0a20 2020 2020 2020 2070 6970 656c 696e  .        pipelin
+0000e5c0: 652c 0a20 2020 2020 2020 2061 7267 756d  e,.        argum
+0000e5d0: 656e 7473 3d4e 6f6e 652c 0a20 2020 2020  ents=None,.     
+0000e5e0: 2020 2065 7870 6572 696d 656e 743d 4e6f     experiment=No
+0000e5f0: 6e65 2c0a 2020 2020 2020 2020 7275 6e3d  ne,.        run=
+0000e600: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e61  None,.        na
+0000e610: 6d65 7370 6163 653d 4e6f 6e65 2c0a 2020  mespace=None,.  
+0000e620: 2020 2020 2020 6172 7469 6661 6374 5f70        artifact_p
+0000e630: 6174 683d 4e6f 6e65 2c0a 2020 2020 2020  ath=None,.      
+0000e640: 2020 6f70 733d 4e6f 6e65 2c0a 2020 2020    ops=None,.    
+0000e650: 2020 2020 2320 544f 444f 3a20 6465 7072      # TODO: depr
+0000e660: 6563 6174 6564 2c20 7265 6d6f 7665 2069  ecated, remove i
+0000e670: 6e20 312e 352e 300a 2020 2020 2020 2020  n 1.5.0.        
+0000e680: 7474 6c3d 4e6f 6e65 2c0a 2020 2020 2020  ttl=None,.      
+0000e690: 2020 636c 6561 6e75 705f 7474 6c3d 4e6f    cleanup_ttl=No
+0000e6a0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+0000e6b0: 2020 2022 2222 5375 626d 6974 2061 204b     """Submit a K
+0000e6c0: 4650 2070 6970 656c 696e 6520 666f 7220  FP pipeline for 
+0000e6d0: 6578 6563 7574 696f 6e2e 0a0a 2020 2020  execution...    
+0000e6e0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+0000e6f0: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
+0000e700: 6f66 2074 6865 2070 6970 656c 696e 650a  of the pipeline.
+0000e710: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000e720: 6970 656c 696e 653a 2050 6970 656c 696e  ipeline: Pipelin
+0000e730: 6520 6675 6e63 7469 6f6e 206f 7220 7061  e function or pa
+0000e740: 7468 2074 6f20 2e79 616d 6c2f 2e7a 6970  th to .yaml/.zip
+0000e750: 2070 6970 656c 696e 6520 6669 6c65 2e0a   pipeline file..
+0000e760: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+0000e770: 7267 756d 656e 7473 3a20 4120 6469 6374  rguments: A dict
+0000e780: 696f 6e61 7279 206f 6620 6172 6775 6d65  ionary of argume
+0000e790: 6e74 7320 746f 2070 6173 7320 746f 2074  nts to pass to t
+0000e7a0: 6865 2070 6970 656c 696e 652e 0a20 2020  he pipeline..   
+0000e7b0: 2020 2020 203a 7061 7261 6d20 6578 7065       :param expe
+0000e7c0: 7269 6d65 6e74 3a20 4120 6e61 6d65 2074  riment: A name t
+0000e7d0: 6f20 6173 7369 676e 2066 6f72 2074 6865  o assign for the
+0000e7e0: 2073 7065 6369 6669 6320 6578 7065 7269   specific experi
+0000e7f0: 6d65 6e74 2e0a 2020 2020 2020 2020 3a70  ment..        :p
+0000e800: 6172 616d 2072 756e 3a20 4120 6e61 6d65  aram run: A name
+0000e810: 2066 6f72 2074 6869 7320 7370 6563 6966   for this specif
+0000e820: 6963 2072 756e 2e0a 2020 2020 2020 2020  ic run..        
+0000e830: 3a70 6172 616d 206e 616d 6573 7061 6365  :param namespace
+0000e840: 3a20 4b75 6265 726e 6574 6573 206e 616d  : Kubernetes nam
+0000e850: 6573 7061 6365 2074 6f20 6578 6563 7574  espace to execut
+0000e860: 6520 7468 6520 7069 7065 6c69 6e65 2069  e the pipeline i
+0000e870: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
+0000e880: 6d20 6172 7469 6661 6374 5f70 6174 683a  m artifact_path:
+0000e890: 2041 2070 6174 6820 746f 2061 7274 6966   A path to artif
+0000e8a0: 6163 7473 2075 7365 6420 6279 2074 6869  acts used by thi
+0000e8b0: 7320 7069 7065 6c69 6e65 2e0a 2020 2020  s pipeline..    
+0000e8c0: 2020 2020 3a70 6172 616d 206f 7073 3a20      :param ops: 
+0000e8d0: 5472 616e 7366 6f72 6d65 7273 2074 6f20  Transformers to 
+0000e8e0: 6170 706c 7920 6f6e 2061 6c6c 206f 7073  apply on all ops
+0000e8f0: 2069 6e20 7468 6520 7069 7065 6c69 6e65   in the pipeline
+0000e900: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000e910: 2074 746c 3a20 7069 7065 6c69 6e65 2063   ttl: pipeline c
+0000e920: 6c65 616e 7570 2074 746c 2069 6e20 7365  leanup ttl in se
+0000e930: 6373 2028 7469 6d65 2074 6f20 7761 6974  cs (time to wait
+0000e940: 2061 6674 6572 2077 6f72 6b66 6c6f 7720   after workflow 
+0000e950: 636f 6d70 6c65 7469 6f6e 2c20 6174 2077  completion, at w
+0000e960: 6869 6368 2070 6f69 6e74 2074 6865 2077  hich point the w
+0000e970: 6f72 6b66 6c6f 770a 2020 2020 2020 2020  orkflow.        
+0000e980: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0000e990: 616c 6c20 6974 7320 7265 736f 7572 6365  all its resource
+0000e9a0: 7320 6172 6520 6465 6c65 7465 6429 2028  s are deleted) (
+0000e9b0: 6465 7072 6563 6174 6564 2c20 7573 6520  deprecated, use 
+0000e9c0: 636c 6561 6e75 705f 7474 6c20 696e 7374  cleanup_ttl inst
+0000e9d0: 6561 6429 0a20 2020 2020 2020 203a 7061  ead).        :pa
+0000e9e0: 7261 6d20 636c 6561 6e75 705f 7474 6c3a  ram cleanup_ttl:
+0000e9f0: 2070 6970 656c 696e 6520 636c 6561 6e75   pipeline cleanu
+0000ea00: 7020 7474 6c20 696e 2073 6563 7320 2874  p ttl in secs (t
+0000ea10: 696d 6520 746f 2077 6169 7420 6166 7465  ime to wait afte
+0000ea20: 7220 776f 726b 666c 6f77 2063 6f6d 706c  r workflow compl
+0000ea30: 6574 696f 6e2c 2061 7420 7768 6963 6820  etion, at which 
+0000ea40: 706f 696e 7420 7468 650a 2020 2020 2020  point the.      
+0000ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea60: 2020 2020 2020 776f 726b 666c 6f77 2061        workflow a
+0000ea70: 6e64 2061 6c6c 2069 7473 2072 6573 6f75  nd all its resou
+0000ea80: 7263 6573 2061 7265 2064 656c 6574 6564  rces are deleted
+0000ea90: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+0000eaa0: 2020 2020 2020 2069 6620 7474 6c3a 0a20         if ttl:. 
+0000eab0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+0000eac0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+0000ead0: 2020 2020 2020 2020 2020 2227 7474 6c27            "'ttl'
+0000eae0: 2069 7320 6465 7072 6563 6174 6564 2c20   is deprecated, 
+0000eaf0: 7573 6520 2763 6c65 616e 7570 5f74 746c  use 'cleanup_ttl
+0000eb00: 2720 696e 7374 6561 642e 2022 0a20 2020  ' instead. ".   
+0000eb10: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+0000eb20: 6973 2077 696c 6c20 6265 2072 656d 6f76  is will be remov
+0000eb30: 6564 2069 6e20 312e 352e 3022 2c0a 2020  ed in 1.5.0",.  
+0000eb40: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000eb50: 544f 444f 3a20 5265 6d6f 7665 2074 6869  TODO: Remove thi
+0000eb60: 7320 696e 2031 2e35 2e30 0a20 2020 2020  s in 1.5.0.     
+0000eb70: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+0000eb80: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+0000eb90: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000eba0: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
+0000ebb0: 6970 656c 696e 652c 2073 7472 293a 0a20  ipeline, str):. 
+0000ebc0: 2020 2020 2020 2020 2020 2070 6970 655f             pipe_
+0000ebd0: 6669 6c65 203d 2070 6970 656c 696e 650a  file = pipeline.
+0000ebe0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000ebf0: 2020 2020 2020 2020 2020 7069 7065 5f66            pipe_f
+0000ec00: 696c 6520 3d20 7465 6d70 6669 6c65 2e4e  ile = tempfile.N
+0000ec10: 616d 6564 5465 6d70 6f72 6172 7946 696c  amedTemporaryFil
+0000ec20: 6528 7375 6666 6978 3d22 2e79 616d 6c22  e(suffix=".yaml"
+0000ec30: 2c20 6465 6c65 7465 3d46 616c 7365 292e  , delete=False).
+0000ec40: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+0000ec50: 2063 6f6e 6620 3d20 6e65 775f 7069 7065   conf = new_pipe
+0000ec60: 5f6d 6574 6164 6174 6128 0a20 2020 2020  _metadata(.     
+0000ec70: 2020 2020 2020 2020 2020 2061 7274 6966             artif
+0000ec80: 6163 745f 7061 7468 3d61 7274 6966 6163  act_path=artifac
+0000ec90: 745f 7061 7468 2c0a 2020 2020 2020 2020  t_path,.        
+0000eca0: 2020 2020 2020 2020 636c 6561 6e75 705f          cleanup_
+0000ecb0: 7474 6c3d 636c 6561 6e75 705f 7474 6c20  ttl=cleanup_ttl 
+0000ecc0: 6f72 2074 746c 2c0a 2020 2020 2020 2020  or ttl,.        
+0000ecd0: 2020 2020 2020 2020 6f70 5f74 7261 6e73          op_trans
+0000ece0: 666f 726d 6572 733d 6f70 732c 0a20 2020  formers=ops,.   
+0000ecf0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000ed00: 2020 2020 2020 206b 6670 2e63 6f6d 7069         kfp.compi
+0000ed10: 6c65 722e 436f 6d70 696c 6572 2829 2e63  ler.Compiler().c
+0000ed20: 6f6d 7069 6c65 280a 2020 2020 2020 2020  ompile(.        
+0000ed30: 2020 2020 2020 2020 7069 7065 6c69 6e65          pipeline
+0000ed40: 2c20 7069 7065 5f66 696c 652c 2074 7970  , pipe_file, typ
+0000ed50: 655f 6368 6563 6b3d 4661 6c73 652c 2070  e_check=False, p
+0000ed60: 6970 656c 696e 655f 636f 6e66 3d63 6f6e  ipeline_conf=con
+0000ed70: 660a 2020 2020 2020 2020 2020 2020 290a  f.            ).
+0000ed80: 0a20 2020 2020 2020 2069 6620 7069 7065  .        if pipe
+0000ed90: 5f66 696c 652e 656e 6473 7769 7468 2822  _file.endswith("
+0000eda0: 2e79 616d 6c22 293a 0a20 2020 2020 2020  .yaml"):.       
+0000edb0: 2020 2020 2068 6561 6465 7273 203d 207b       headers = {
+0000edc0: 2263 6f6e 7465 6e74 2d74 7970 6522 3a20  "content-type": 
+0000edd0: 2261 7070 6c69 6361 7469 6f6e 2f79 616d  "application/yam
+0000ede0: 6c22 7d0a 2020 2020 2020 2020 656c 6966  l"}.        elif
+0000edf0: 2070 6970 655f 6669 6c65 2e65 6e64 7377   pipe_file.endsw
+0000ee00: 6974 6828 222e 7a69 7022 293a 0a20 2020  ith(".zip"):.   
+0000ee10: 2020 2020 2020 2020 2068 6561 6465 7273           headers
+0000ee20: 203d 207b 2263 6f6e 7465 6e74 2d74 7970   = {"content-typ
+0000ee30: 6522 3a20 2261 7070 6c69 6361 7469 6f6e  e": "application
+0000ee40: 2f7a 6970 227d 0a20 2020 2020 2020 2065  /zip"}.        e
+0000ee50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000ee60: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000ee70: 7228 2270 6970 656c 696e 6520 6669 6c65  r("pipeline file
+0000ee80: 206d 7573 7420 6265 202e 7961 6d6c 206f   must be .yaml o
+0000ee90: 7220 2e7a 6970 2229 0a20 2020 2020 2020  r .zip").       
+0000eea0: 2069 6620 6172 6775 6d65 6e74 733a 0a20   if arguments:. 
+0000eeb0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000eec0: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
+0000eed0: 756d 656e 7473 2c20 6469 6374 293a 0a20  uments, dict):. 
+0000eee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000eef0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000ef00: 2261 7267 756d 656e 7473 206d 7573 7420  "arguments must 
+0000ef10: 6265 2064 6963 7420 7479 7065 2229 0a20  be dict type"). 
+0000ef20: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+0000ef30: 7273 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  rs[mlrun.common.
+0000ef40: 7363 6865 6d61 732e 4865 6164 6572 4e61  schemas.HeaderNa
+0000ef50: 6d65 732e 7069 7065 6c69 6e65 5f61 7267  mes.pipeline_arg
+0000ef60: 756d 656e 7473 5d20 3d20 7374 7228 0a20  uments] = str(. 
+0000ef70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000ef80: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+0000ef90: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000efa0: 6966 206e 6f74 2070 6174 682e 6973 6669  if not path.isfi
+0000efb0: 6c65 2870 6970 655f 6669 6c65 293a 0a20  le(pipe_file):. 
+0000efc0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000efd0: 204f 5345 7272 6f72 2866 2266 696c 6520   OSError(f"file 
+0000efe0: 7b70 6970 655f 6669 6c65 7d20 646f 6573  {pipe_file} does
+0000eff0: 6e74 2065 7869 7374 2229 0a20 2020 2020  nt exist").     
+0000f000: 2020 2077 6974 6820 6f70 656e 2870 6970     with open(pip
+0000f010: 655f 6669 6c65 2c20 2272 6222 2920 6173  e_file, "rb") as
+0000f020: 2066 703a 0a20 2020 2020 2020 2020 2020   fp:.           
+0000f030: 2064 6174 6120 3d20 6670 2e72 6561 6428   data = fp.read(
+0000f040: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+0000f050: 2069 7369 6e73 7461 6e63 6528 7069 7065   isinstance(pipe
+0000f060: 6c69 6e65 2c20 7374 7229 3a0a 2020 2020  line, str):.    
+0000f070: 2020 2020 2020 2020 7265 6d6f 7665 2870          remove(p
+0000f080: 6970 655f 6669 6c65 290a 0a20 2020 2020  ipe_file)..     
+0000f090: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000f0a0: 2020 2020 7061 7261 6d73 203d 207b 226e      params = {"n
+0000f0b0: 616d 6573 7061 6365 223a 206e 616d 6573  amespace": names
+0000f0c0: 7061 6365 2c20 2265 7870 6572 696d 656e  pace, "experimen
+0000f0d0: 7422 3a20 6578 7065 7269 6d65 6e74 2c20  t": experiment, 
+0000f0e0: 2272 756e 223a 2072 756e 7d0a 2020 2020  "run": run}.    
+0000f0f0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+0000f100: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0000f110: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+0000f120: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
+0000f130: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
+0000f140: 2f7b 7072 6f6a 6563 747d 2f70 6970 656c  /{project}/pipel
+0000f150: 696e 6573 222c 0a20 2020 2020 2020 2020  ines",.         
+0000f160: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
+0000f170: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+0000f180: 2020 2020 2020 7469 6d65 6f75 743d 3230        timeout=20
+0000f190: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f1a0: 2020 626f 6479 3d64 6174 612c 0a20 2020    body=data,.   
+0000f1b0: 2020 2020 2020 2020 2020 2020 2068 6561               hea
+0000f1c0: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
+0000f1d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000f1e0: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
+0000f1f0: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
+0000f200: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+0000f210: 726f 7228 6622 6572 726f 7220 6361 6e6e  ror(f"error cann
+0000f220: 6f74 2073 7562 6d69 7420 7069 7065 6c69  ot submit pipeli
+0000f230: 6e65 3a20 7b65 7272 5f74 6f5f 7374 7228  ne: {err_to_str(
+0000f240: 6572 7229 7d22 290a 2020 2020 2020 2020  err)}").        
+0000f250: 2020 2020 7261 6973 6520 4f53 4572 726f      raise OSErro
+0000f260: 7228 6622 6572 726f 723a 2063 616e 6e6f  r(f"error: canno
+0000f270: 7420 6361 6e6e 6f74 2073 7562 6d69 7420  t cannot submit 
+0000f280: 7069 7065 6c69 6e65 2c20 7b65 7272 5f74  pipeline, {err_t
+0000f290: 6f5f 7374 7228 6572 7229 7d22 290a 0a20  o_str(err)}").. 
+0000f2a0: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
+0000f2b0: 7370 2e6f 6b3a 0a20 2020 2020 2020 2020  sp.ok:.         
+0000f2c0: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
+0000f2d0: 6622 6261 6420 7265 7370 2121 5c6e 7b72  f"bad resp!!\n{r
+0000f2e0: 6573 702e 7465 7874 7d22 290a 2020 2020  esp.text}").    
+0000f2f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000f300: 6c75 6545 7272 6f72 2866 2262 6164 2073  lueError(f"bad s
+0000f310: 7562 6d69 7420 7069 7065 6c69 6e65 2072  ubmit pipeline r
+0000f320: 6573 706f 6e73 652c 207b 7265 7370 2e74  esponse, {resp.t
+0000f330: 6578 747d 2229 0a0a 2020 2020 2020 2020  ext}")..        
+0000f340: 7265 7370 203d 2072 6573 702e 6a73 6f6e  resp = resp.json
+0000f350: 2829 0a20 2020 2020 2020 206c 6f67 6765  ().        logge
+0000f360: 722e 696e 666f 2866 2273 7562 6d69 7474  r.info(f"submitt
+0000f370: 6564 2070 6970 656c 696e 6520 7b72 6573  ed pipeline {res
+0000f380: 705b 276e 616d 6527 5d7d 2069 643d 7b72  p['name']} id={r
+0000f390: 6573 705b 2769 6427 5d7d 2229 0a20 2020  esp['id']}").   
+0000f3a0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+0000f3b0: 5b22 6964 225d 0a0a 2020 2020 6465 6620  ["id"]..    def 
+0000f3c0: 6c69 7374 5f70 6970 656c 696e 6573 280a  list_pipelines(.
+0000f3d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000f3e0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+0000f3f0: 7472 2c0a 2020 2020 2020 2020 6e61 6d65  tr,.        name
+0000f400: 7370 6163 653a 2073 7472 203d 204e 6f6e  space: str = Non
+0000f410: 652c 0a20 2020 2020 2020 2073 6f72 745f  e,.        sort_
+0000f420: 6279 3a20 7374 7220 3d20 2222 2c0a 2020  by: str = "",.  
+0000f430: 2020 2020 2020 7061 6765 5f74 6f6b 656e        page_token
+0000f440: 3a20 7374 7220 3d20 2222 2c0a 2020 2020  : str = "",.    
+0000f450: 2020 2020 6669 6c74 6572 5f3a 2073 7472      filter_: str
+0000f460: 203d 2022 222c 0a20 2020 2020 2020 2066   = "",.        f
+0000f470: 6f72 6d61 745f 3a20 556e 696f 6e5b 0a20  ormat_: Union[. 
+0000f480: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
+0000f490: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000f4a0: 656d 6173 2e50 6970 656c 696e 6573 466f  emas.PipelinesFo
+0000f4b0: 726d 6174 0a20 2020 2020 2020 205d 203d  rmat.        ] =
+0000f4c0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000f4d0: 6865 6d61 732e 5069 7065 6c69 6e65 7346  hemas.PipelinesF
+0000f4e0: 6f72 6d61 742e 6d65 7461 6461 7461 5f6f  ormat.metadata_o
+0000f4f0: 6e6c 792c 0a20 2020 2020 2020 2070 6167  nly,.        pag
+0000f500: 655f 7369 7a65 3a20 696e 7420 3d20 4e6f  e_size: int = No
+0000f510: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
+0000f520: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000f530: 732e 5069 7065 6c69 6e65 734f 7574 7075  s.PipelinesOutpu
+0000f540: 743a 0a20 2020 2020 2020 2022 2222 5265  t:.        """Re
+0000f550: 7472 6965 7665 2061 206c 6973 7420 6f66  trieve a list of
+0000f560: 204b 4650 2070 6970 656c 696e 6573 2e20   KFP pipelines. 
+0000f570: 5468 6973 2066 756e 6374 696f 6e20 6361  This function ca
+0000f580: 6e20 6265 2069 6e76 6f6b 6564 2074 6f20  n be invoked to 
+0000f590: 6765 7420 616c 6c20 7069 7065 6c69 6e65  get all pipeline
+0000f5a0: 7320 6672 6f6d 2061 6c6c 2070 726f 6a65  s from all proje
+0000f5b0: 6374 732c 0a20 2020 2020 2020 2062 7920  cts,.        by 
+0000f5c0: 7370 6563 6966 7969 6e67 2060 6070 726f  specifying ``pro
+0000f5d0: 6a65 6374 3d2a 6060 2c20 696e 2077 6869  ject=*``, in whi
+0000f5e0: 6368 2063 6173 6520 7061 6769 6e61 7469  ch case paginati
+0000f5f0: 6f6e 2063 616e 2062 6520 7573 6564 2061  on can be used a
+0000f600: 6e64 2074 6865 2076 6172 696f 7573 2073  nd the various s
+0000f610: 6f72 7469 6e67 2061 6e64 2070 6167 696e  orting and pagin
+0000f620: 6174 696f 6e0a 2020 2020 2020 2020 7072  ation.        pr
+0000f630: 6f70 6572 7469 6573 2063 616e 2062 6520  operties can be 
+0000f640: 6170 706c 6965 642e 2049 6620 6120 7370  applied. If a sp
+0000f650: 6563 6966 6963 2070 726f 6a65 6374 2069  ecific project i
+0000f660: 7320 7265 7175 6573 7465 642c 2074 6865  s requested, the
+0000f670: 6e20 7468 6520 7061 6769 6e61 7469 6f6e  n the pagination
+0000f680: 206f 7074 696f 6e73 2063 616e 6e6f 7420   options cannot 
+0000f690: 6265 0a20 2020 2020 2020 2075 7365 6420  be.        used 
+0000f6a0: 616e 6420 7061 6769 6e61 7469 6f6e 2069  and pagination i
+0000f6b0: 7320 6e6f 7420 6170 706c 6965 642e 0a0a  s not applied...
+0000f6c0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000f6d0: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
+0000f6e0: 6e61 6d65 2e20 4361 6e20 6265 2060 602a  name. Can be ``*
+0000f6f0: 6060 2066 6f72 2071 7565 7279 2061 6372  `` for query acr
+0000f700: 6f73 7320 616c 6c20 7072 6f6a 6563 7473  oss all projects
+0000f710: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f720: 206e 616d 6573 7061 6365 3a20 4b75 6265   namespace: Kube
+0000f730: 726e 6574 6573 206e 616d 6573 7061 6365  rnetes namespace
+0000f740: 2069 6e20 7768 6963 6820 7468 6520 7069   in which the pi
+0000f750: 7065 6c69 6e65 7320 6172 6520 6578 6563  pelines are exec
+0000f760: 7574 696e 672e 0a20 2020 2020 2020 203a  uting..        :
+0000f770: 7061 7261 6d20 736f 7274 5f62 793a 2046  param sort_by: F
+0000f780: 6965 6c64 2074 6f20 736f 7274 2074 6865  ield to sort the
+0000f790: 2072 6573 756c 7473 2062 792e 0a20 2020   results by..   
+0000f7a0: 2020 2020 203a 7061 7261 6d20 7061 6765       :param page
+0000f7b0: 5f74 6f6b 656e 3a20 5573 6520 666f 7220  _token: Use for 
+0000f7c0: 7061 6769 6e61 7469 6f6e 2c20 746f 2072  pagination, to r
+0000f7d0: 6574 7269 6576 6520 6e65 7874 2070 6167  etrieve next pag
+0000f7e0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000f7f0: 6d20 6669 6c74 6572 5f3a 204b 7562 6572  m filter_: Kuber
+0000f800: 6e65 7465 7320 6669 6c74 6572 2074 6f20  netes filter to 
+0000f810: 6170 706c 7920 746f 2074 6865 2071 7565  apply to the que
+0000f820: 7279 2c20 6361 6e20 6265 2075 7365 6420  ry, can be used 
+0000f830: 746f 2066 696c 7465 7220 6f6e 2073 7065  to filter on spe
+0000f840: 6369 6669 6320 6f62 6a65 6374 2066 6965  cific object fie
+0000f850: 6c64 732e 0a20 2020 2020 2020 203a 7061  lds..        :pa
+0000f860: 7261 6d20 666f 726d 6174 5f3a 2052 6573  ram format_: Res
+0000f870: 756c 7420 666f 726d 6174 2e20 4361 6e20  ult format. Can 
+0000f880: 6265 206f 6e65 206f 663a 0a0a 2020 2020  be one of:..    
+0000f890: 2020 2020 2020 2020 2d20 6060 6675 6c6c          - ``full
+0000f8a0: 6060 202d 2072 6574 7572 6e20 7468 6520  `` - return the 
+0000f8b0: 6675 6c6c 206f 626a 6563 7473 2e0a 2020  full objects..  
+0000f8c0: 2020 2020 2020 2020 2020 2d20 6060 6d65            - ``me
+0000f8d0: 7461 6461 7461 5f6f 6e6c 7960 6020 2864  tadata_only`` (d
+0000f8e0: 6566 6175 6c74 2920 2d20 7265 7475 726e  efault) - return
+0000f8f0: 206a 7573 7420 6d65 7461 6461 7461 206f   just metadata o
+0000f900: 6620 7468 6520 7069 7065 6c69 6e65 7320  f the pipelines 
+0000f910: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+0000f920: 2020 2020 202d 2060 606e 616d 655f 6f6e       - ``name_on
+0000f930: 6c79 6060 202d 2072 6574 7572 6e20 6a75  ly`` - return ju
+0000f940: 7374 2074 6865 206e 616d 6573 206f 6620  st the names of 
+0000f950: 7468 6520 7069 7065 6c69 6e65 206f 626a  the pipeline obj
+0000f960: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+0000f970: 6172 616d 2070 6167 655f 7369 7a65 3a20  aram page_size: 
+0000f980: 5369 7a65 206f 6620 6120 7369 6e67 6c65  Size of a single
+0000f990: 2070 6167 6520 7768 656e 2061 7070 6c79   page when apply
+0000f9a0: 696e 6720 7061 6769 6e61 7469 6f6e 2e0a  ing pagination..
+0000f9b0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000f9c0: 2020 2020 2069 6620 7072 6f6a 6563 7420       if project 
+0000f9d0: 213d 2022 2a22 2061 6e64 2028 7061 6765  != "*" and (page
+0000f9e0: 5f74 6f6b 656e 206f 7220 7061 6765 5f73  _token or page_s
+0000f9f0: 697a 6529 3a0a 2020 2020 2020 2020 2020  ize):.          
+0000fa00: 2020 7261 6973 6520 6d6c 7275 6e2e 6572    raise mlrun.er
+0000fa10: 726f 7273 2e4d 4c52 756e 496e 7661 6c69  rors.MLRunInvali
+0000fa20: 6441 7267 756d 656e 7445 7272 6f72 280a  dArgumentError(.
+0000fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa40: 2246 696c 7465 7269 6e67 2062 7920 7072  "Filtering by pr
+0000fa50: 6f6a 6563 7420 6361 6e20 6e6f 7420 6265  oject can not be
+0000fa60: 2075 7365 6420 746f 6765 7468 6572 2077   used together w
+0000fa70: 6974 6820 7061 6769 6e61 7469 6f6e 220a  ith pagination".
+0000fa80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000fa90: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+0000faa0: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
+0000fab0: 6d65 7370 6163 6522 3a20 6e61 6d65 7370  mespace": namesp
+0000fac0: 6163 652c 0a20 2020 2020 2020 2020 2020  ace,.           
+0000fad0: 2022 736f 7274 5f62 7922 3a20 736f 7274   "sort_by": sort
+0000fae0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
+0000faf0: 2022 7061 6765 5f74 6f6b 656e 223a 2070   "page_token": p
+0000fb00: 6167 655f 746f 6b65 6e2c 0a20 2020 2020  age_token,.     
+0000fb10: 2020 2020 2020 2022 6669 6c74 6572 223a         "filter":
+0000fb20: 2066 696c 7465 725f 2c0a 2020 2020 2020   filter_,.      
+0000fb30: 2020 2020 2020 2266 6f72 6d61 7422 3a20        "format": 
+0000fb40: 666f 726d 6174 5f2c 0a20 2020 2020 2020  format_,.       
+0000fb50: 2020 2020 2022 7061 6765 5f73 697a 6522       "page_size"
+0000fb60: 3a20 7061 6765 5f73 697a 652c 0a20 2020  : page_size,.   
+0000fb70: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0000fb80: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0000fb90: 6622 4661 696c 6564 206c 6973 7469 6e67  f"Failed listing
+0000fba0: 2070 6970 656c 696e 6573 2c20 7175 6572   pipelines, quer
+0000fbb0: 793a 207b 7061 7261 6d73 7d22 0a20 2020  y: {params}".   
+0000fbc0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0000fbd0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0000fbe0: 2020 2020 2020 2020 2020 2022 4745 5422             "GET"
+0000fbf0: 2c20 6622 7072 6f6a 6563 7473 2f7b 7072  , f"projects/{pr
+0000fc00: 6f6a 6563 747d 2f70 6970 656c 696e 6573  oject}/pipelines
+0000fc10: 222c 2065 7272 6f72 5f6d 6573 7361 6765  ", error_message
+0000fc20: 2c20 7061 7261 6d73 3d70 6172 616d 730a  , params=params.
+0000fc30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000fc40: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
+0000fc50: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5069  ommon.schemas.Pi
+0000fc60: 7065 6c69 6e65 734f 7574 7075 7428 2a2a  pelinesOutput(**
+0000fc70: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+0000fc80: 0a0a 2020 2020 6465 6620 6765 745f 7069  ..    def get_pi
+0000fc90: 7065 6c69 6e65 280a 2020 2020 2020 2020  peline(.        
+0000fca0: 7365 6c66 2c0a 2020 2020 2020 2020 7275  self,.        ru
+0000fcb0: 6e5f 6964 3a20 7374 722c 0a20 2020 2020  n_id: str,.     
+0000fcc0: 2020 206e 616d 6573 7061 6365 3a20 7374     namespace: st
+0000fcd0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+0000fce0: 2020 7469 6d65 6f75 743a 2069 6e74 203d    timeout: int =
+0000fcf0: 2031 302c 0a20 2020 2020 2020 2066 6f72   10,.        for
+0000fd00: 6d61 745f 3a20 556e 696f 6e5b 0a20 2020  mat_: Union[.   
+0000fd10: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
+0000fd20: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000fd30: 6173 2e50 6970 656c 696e 6573 466f 726d  as.PipelinesForm
+0000fd40: 6174 0a20 2020 2020 2020 205d 203d 206d  at.        ] = m
+0000fd50: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000fd60: 6d61 732e 5069 7065 6c69 6e65 7346 6f72  mas.PipelinesFor
+0000fd70: 6d61 742e 7375 6d6d 6172 792c 0a20 2020  mat.summary,.   
+0000fd80: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0000fd90: 7220 3d20 4e6f 6e65 2c0a 2020 2020 293a  r = None,.    ):
+0000fda0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+0000fdb0: 6965 7665 2064 6574 6169 6c73 206f 6620  ieve details of 
+0000fdc0: 6120 7370 6563 6966 6963 2070 6970 656c  a specific pipel
+0000fdd0: 696e 6520 7573 696e 6720 6974 7320 7275  ine using its ru
+0000fde0: 6e20 4944 2028 6173 2070 726f 7669 6465  n ID (as provide
+0000fdf0: 6420 7768 656e 2074 6865 2070 6970 656c  d when the pipel
+0000fe00: 696e 6520 7761 7320 6578 6563 7574 6564  ine was executed
+0000fe10: 292e 2222 220a 0a20 2020 2020 2020 2074  )."""..        t
+0000fe20: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0000fe30: 7061 7261 6d73 203d 207b 7d0a 2020 2020  params = {}.    
+0000fe40: 2020 2020 2020 2020 6966 206e 616d 6573          if names
+0000fe50: 7061 6365 3a0a 2020 2020 2020 2020 2020  pace:.          
+0000fe60: 2020 2020 2020 7061 7261 6d73 5b22 6e61        params["na
+0000fe70: 6d65 7370 6163 6522 5d20 3d20 6e61 6d65  mespace"] = name
+0000fe80: 7370 6163 650a 2020 2020 2020 2020 2020  space.          
+0000fe90: 2020 7061 7261 6d73 5b22 666f 726d 6174    params["format
+0000fea0: 225d 203d 2066 6f72 6d61 745f 0a20 2020  "] = format_.   
+0000feb0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+0000fec0: 5f70 6174 6820 3d20 7072 6f6a 6563 7420  _path = project 
+0000fed0: 6966 2070 726f 6a65 6374 2065 6c73 6520  if project else 
+0000fee0: 222a 220a 2020 2020 2020 2020 2020 2020  "*".            
+0000fef0: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+0000ff00: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0000ff10: 2020 2020 2020 2247 4554 222c 0a20 2020        "GET",.   
+0000ff20: 2020 2020 2020 2020 2020 2020 2066 2270               f"p
+0000ff30: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+0000ff40: 5f70 6174 687d 2f70 6970 656c 696e 6573  _path}/pipelines
+0000ff50: 2f7b 7275 6e5f 6964 7d22 2c0a 2020 2020  /{run_id}",.    
+0000ff60: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0000ff70: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
+0000ff80: 2020 2020 2020 2020 2020 2074 696d 656f             timeo
+0000ff90: 7574 3d74 696d 656f 7574 2c0a 2020 2020  ut=timeout,.    
+0000ffa0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ffb0: 2020 6578 6365 7074 204f 5345 7272 6f72    except OSError
+0000ffc0: 2061 7320 6572 723a 0a20 2020 2020 2020   as err:.       
+0000ffd0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
+0000ffe0: 7228 6622 6572 726f 7220 6361 6e6e 6f74  r(f"error cannot
+0000fff0: 2067 6574 2070 6970 656c 696e 653a 207b   get pipeline: {
+00010000: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+00010010: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00010020: 6169 7365 204f 5345 7272 6f72 2866 2265  aise OSError(f"e
+00010030: 7272 6f72 3a20 6361 6e6e 6f74 2067 6574  rror: cannot get
+00010040: 2070 6970 656c 696e 652c 207b 6572 725f   pipeline, {err_
+00010050: 746f 5f73 7472 2865 7272 297d 2229 0a0a  to_str(err)}")..
+00010060: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+00010070: 6573 702e 6f6b 3a0a 2020 2020 2020 2020  esp.ok:.        
+00010080: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
+00010090: 2866 2262 6164 2072 6573 7021 215c 6e7b  (f"bad resp!!\n{
+000100a0: 7265 7370 2e74 6578 747d 2229 0a20 2020  resp.text}").   
+000100b0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000100c0: 616c 7565 4572 726f 7228 6622 6261 6420  alueError(f"bad 
+000100d0: 6765 7420 7069 7065 6c69 6e65 2072 6573  get pipeline res
+000100e0: 706f 6e73 652c 207b 7265 7370 2e74 6578  ponse, {resp.tex
+000100f0: 747d 2229 0a0a 2020 2020 2020 2020 7265  t}")..        re
+00010100: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
+00010110: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00010120: 686f 640a 2020 2020 6465 6620 5f72 6573  hod.    def _res
+00010130: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
+00010140: 6167 2c20 7569 6429 3a0a 2020 2020 2020  ag, uid):.      
+00010150: 2020 6966 2075 6964 2061 6e64 2074 6167    if uid and tag
+00010160: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00010170: 6973 6520 4d4c 5275 6e49 6e76 616c 6964  ise MLRunInvalid
+00010180: 4172 6775 6d65 6e74 4572 726f 7228 2262  ArgumentError("b
+00010190: 6f74 6820 7569 6420 616e 6420 7461 6720  oth uid and tag 
+000101a0: 7765 7265 2070 726f 7669 6465 6422 290a  were provided").
+000101b0: 2020 2020 2020 2020 7265 7475 726e 2075          return u
+000101c0: 6964 206f 7220 7461 6720 6f72 2022 6c61  id or tag or "la
+000101d0: 7465 7374 220a 0a20 2020 2064 6566 2063  test"..    def c
+000101e0: 7265 6174 655f 6665 6174 7572 655f 7365  reate_feature_se
+000101f0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00010200: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00010210: 5f73 6574 3a20 556e 696f 6e5b 6469 6374  _set: Union[dict
+00010220: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+00010230: 6368 656d 6173 2e46 6561 7475 7265 5365  chemas.FeatureSe
+00010240: 742c 2046 6561 7475 7265 5365 745d 2c0a  t, FeatureSet],.
+00010250: 2020 2020 2020 2020 7072 6f6a 6563 743d          project=
+00010260: 2222 2c0a 2020 2020 2020 2020 7665 7273  "",.        vers
+00010270: 696f 6e65 643d 5472 7565 2c0a 2020 2020  ioned=True,.    
+00010280: 2920 2d3e 2064 6963 743a 0a20 2020 2020  ) -> dict:.     
+00010290: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
+000102a0: 6577 203a 7079 3a63 6c61 7373 3a60 7e6d  ew :py:class:`~m
+000102b0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000102c0: 7265 2e46 6561 7475 7265 5365 7460 2061  re.FeatureSet` a
+000102d0: 6e64 2073 6176 6520 696e 2074 6865 203a  nd save in the :
+000102e0: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2044  py:mod:`mlrun` D
+000102f0: 422e 2054 6865 0a20 2020 2020 2020 2066  B. The.        f
+00010300: 6561 7475 7265 2d73 6574 206d 7573 7420  eature-set must 
+00010310: 6e6f 7420 7072 6576 696f 7573 6c79 2065  not previously e
+00010320: 7869 7374 2069 6e20 7468 6520 4442 2e0a  xist in the DB..
+00010330: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010340: 6665 6174 7572 655f 7365 743a 2054 6865  feature_set: The
+00010350: 206e 6577 203a 7079 3a63 6c61 7373 3a60   new :py:class:`
+00010360: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00010370: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00010380: 2074 6f20 6372 6561 7465 2e0a 2020 2020   to create..    
+00010390: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+000103a0: 6374 3a20 4e61 6d65 206f 6620 7072 6f6a  ct: Name of proj
+000103b0: 6563 7420 7468 6973 2066 6561 7475 7265  ect this feature
+000103c0: 2d73 6574 2062 656c 6f6e 6773 2074 6f2e  -set belongs to.
+000103d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000103e0: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
+000103f0: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
+00010400: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
+00010410: 2066 6561 7475 7265 2d73 6574 2e20 416c   feature-set. Al
+00010420: 6c20 7665 7273 696f 6e73 206f 6620 6120  l versions of a 
+00010430: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
+00010440: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00010450: 6c20 6265 206b 6570 7420 696e 2074 6865  l be kept in the
+00010460: 2044 4220 616e 6420 6361 6e20 6265 2072   DB and can be r
+00010470: 6574 7269 6576 6564 2075 6e74 696c 2065  etrieved until e
+00010480: 7870 6c69 6369 746c 7920 6465 6c65 7465  xplicitly delete
+00010490: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
+000104a0: 726e 733a 2054 6865 203a 7079 3a63 6c61  rns: The :py:cla
+000104b0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+000104c0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+000104d0: 5365 7460 206f 626a 6563 7420 2861 7320  Set` object (as 
+000104e0: 6469 6374 292e 0a20 2020 2020 2020 2022  dict)..        "
+000104f0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+00010500: 696e 7374 616e 6365 2866 6561 7475 7265  instance(feature
+00010510: 5f73 6574 2c20 6d6c 7275 6e2e 636f 6d6d  _set, mlrun.comm
+00010520: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
+00010530: 7265 5365 7429 3a0a 2020 2020 2020 2020  reSet):.        
+00010540: 2020 2020 6665 6174 7572 655f 7365 7420      feature_set 
+00010550: 3d20 6665 6174 7572 655f 7365 742e 6469  = feature_set.di
+00010560: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
+00010570: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+00010580: 7475 7265 5f73 6574 2c20 4665 6174 7572  ture_set, Featur
+00010590: 6553 6574 293a 0a20 2020 2020 2020 2020  eSet):.         
+000105a0: 2020 2066 6561 7475 7265 5f73 6574 203d     feature_set =
+000105b0: 2066 6561 7475 7265 5f73 6574 2e74 6f5f   feature_set.to_
+000105c0: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+000105d0: 7072 6f6a 6563 7420 3d20 280a 2020 2020  project = (.    
+000105e0: 2020 2020 2020 2020 7072 6f6a 6563 740a          project.
+000105f0: 2020 2020 2020 2020 2020 2020 6f72 2066              or f
+00010600: 6561 7475 7265 5f73 6574 5b22 6d65 7461  eature_set["meta
+00010610: 6461 7461 225d 2e67 6574 2822 7072 6f6a  data"].get("proj
+00010620: 6563 7422 2c20 4e6f 6e65 290a 2020 2020  ect", None).    
+00010630: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
+00010640: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00010650: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
+00010660: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00010670: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00010680: 6665 6174 7572 652d 7365 7473 220a 2020  feature-sets".  
+00010690: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+000106a0: 2276 6572 7369 6f6e 6564 223a 2076 6572  "versioned": ver
+000106b0: 7369 6f6e 6564 7d0a 0a20 2020 2020 2020  sioned}..       
+000106c0: 206e 616d 6520 3d20 6665 6174 7572 655f   name = feature_
+000106d0: 7365 745b 226d 6574 6164 6174 6122 5d5b  set["metadata"][
+000106e0: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
+000106f0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00010700: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+00010710: 6720 6665 6174 7572 652d 7365 7420 7b70  g feature-set {p
+00010720: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+00010730: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+00010740: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00010750: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
+00010760: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+00010770: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+00010780: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
+00010790: 2020 2020 2020 2020 2020 2070 6172 616d             param
+000107a0: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
+000107b0: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
+000107c0: 746f 5f6a 736f 6e28 6665 6174 7572 655f  to_json(feature_
+000107d0: 7365 7429 2c0a 2020 2020 2020 2020 290a  set),.        ).
+000107e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+000107f0: 6573 702e 6a73 6f6e 2829 0a0a 2020 2020  esp.json()..    
+00010800: 6465 6620 6765 745f 6665 6174 7572 655f  def get_feature_
+00010810: 7365 7428 0a20 2020 2020 2020 2073 656c  set(.        sel
+00010820: 662c 206e 616d 653a 2073 7472 2c20 7072  f, name: str, pr
+00010830: 6f6a 6563 743a 2073 7472 203d 2022 222c  oject: str = "",
+00010840: 2074 6167 3a20 7374 7220 3d20 4e6f 6e65   tag: str = None
+00010850: 2c20 7569 643a 2073 7472 203d 204e 6f6e  , uid: str = Non
+00010860: 650a 2020 2020 2920 2d3e 2046 6561 7475  e.    ) -> Featu
+00010870: 7265 5365 743a 0a20 2020 2020 2020 2022  reSet:.        "
+00010880: 2222 5265 7472 6965 7665 2061 207e 6d6c  ""Retrieve a ~ml
+00010890: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
+000108a0: 652e 4665 6174 7572 6553 6574 6020 6f62  e.FeatureSet` ob
+000108b0: 6a65 6374 2e20 4966 2062 6f74 6820 6060  ject. If both ``
+000108c0: 7461 6760 6020 616e 6420 6060 7569 6460  tag`` and ``uid`
+000108d0: 6020 6172 6520 6e6f 7420 7370 6563 6966  ` are not specif
+000108e0: 6965 642c 2074 6865 6e0a 2020 2020 2020  ied, then.      
+000108f0: 2020 7468 6520 6f62 6a65 6374 2074 6167    the object tag
+00010900: 6765 6420 6060 6c61 7465 7374 6060 2077  ged ``latest`` w
+00010910: 696c 6c20 6265 2072 6574 7269 6576 6564  ill be retrieved
+00010920: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00010930: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
+00010940: 6f62 6a65 6374 2074 6f20 7265 7472 6965  object to retrie
+00010950: 7665 2e0a 2020 2020 2020 2020 3a70 6172  ve..        :par
+00010960: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00010970: 6563 7420 7468 6520 4665 6174 7572 6553  ect the FeatureS
+00010980: 6574 2062 656c 6f6e 6773 2074 6f2e 0a20  et belongs to.. 
+00010990: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+000109a0: 673a 2054 6167 206f 6620 7468 6520 7370  g: Tag of the sp
+000109b0: 6563 6966 6963 206f 626a 6563 7420 7665  ecific object ve
+000109c0: 7273 696f 6e20 746f 2072 6574 7269 6576  rsion to retriev
+000109d0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000109e0: 6d20 7569 643a 2075 6964 206f 6620 7468  m uid: uid of th
+000109f0: 6520 6f62 6a65 6374 2074 6f20 7265 7472  e object to retr
+00010a00: 6965 7665 2028 6361 6e20 6f6e 6c79 2062  ieve (can only b
+00010a10: 6520 7573 6564 2066 6f72 2076 6572 7369  e used for versi
+00010a20: 6f6e 6564 206f 626a 6563 7473 292e 0a20  oned objects).. 
+00010a30: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00010a40: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00010a50: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00010a60: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00010a70: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00010a80: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
+00010a90: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
+00010aa0: 2075 6964 290a 2020 2020 2020 2020 7061   uid).        pa
+00010ab0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00010ac0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00010ad0: 652d 7365 7473 2f7b 6e61 6d65 7d2f 7265  e-sets/{name}/re
+00010ae0: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
+00010af0: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
+00010b00: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00010b10: 4661 696c 6564 2072 6574 7269 6576 696e  Failed retrievin
+00010b20: 6720 6665 6174 7572 652d 7365 7420 7b70  g feature-set {p
+00010b30: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+00010b40: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+00010b50: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+00010b60: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
+00010b70: 6d65 7373 6167 6529 0a20 2020 2020 2020  message).       
+00010b80: 2072 6574 7572 6e20 4665 6174 7572 6553   return FeatureS
+00010b90: 6574 2e66 726f 6d5f 6469 6374 2872 6573  et.from_dict(res
+00010ba0: 702e 6a73 6f6e 2829 290a 0a20 2020 2064  p.json())..    d
+00010bb0: 6566 206c 6973 745f 6665 6174 7572 6573  ef list_features
+00010bc0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00010bd0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00010be0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
+00010bf0: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
+00010c00: 2020 2020 2020 2020 7461 673a 2073 7472          tag: str
+00010c10: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00010c20: 2065 6e74 6974 6965 733a 204c 6973 745b   entities: List[
+00010c30: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00010c40: 2020 2020 206c 6162 656c 733a 204c 6973       labels: Lis
+00010c50: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
+00010c60: 2020 2029 202d 3e20 4c69 7374 5b64 6963     ) -> List[dic
+00010c70: 745d 3a0a 2020 2020 2020 2020 2222 224c  t]:.        """L
+00010c80: 6973 7420 6665 6174 7572 652d 7365 7473  ist feature-sets
+00010c90: 2077 6869 6368 2063 6f6e 7461 696e 2073   which contain s
+00010ca0: 7065 6369 6669 6320 6665 6174 7572 6573  pecific features
+00010cb0: 2e20 5468 6973 2066 756e 6374 696f 6e20  . This function 
+00010cc0: 6d61 7920 7265 7475 726e 206d 756c 7469  may return multi
+00010cd0: 706c 6520 7665 7273 696f 6e73 206f 6620  ple versions of 
+00010ce0: 7468 6520 7361 6d65 0a20 2020 2020 2020  the same.       
+00010cf0: 2066 6561 7475 7265 2d73 6574 2069 6620   feature-set if 
+00010d00: 6120 7370 6563 6966 6963 2074 6167 2069  a specific tag i
+00010d10: 7320 6e6f 7420 7265 7175 6573 7465 642e  s not requested.
+00010d20: 204e 6f74 6520 7468 6174 2074 6865 2076   Note that the v
+00010d30: 6172 696f 7573 2066 696c 7465 7273 206f  arious filters o
+00010d40: 6620 7468 6973 2066 756e 6374 696f 6e20  f this function 
+00010d50: 6163 7475 616c 6c79 0a20 2020 2020 2020  actually.       
+00010d60: 2072 6566 6572 2074 6f20 7468 6520 6665   refer to the fe
+00010d70: 6174 7572 652d 7365 7420 6f62 6a65 6374  ature-set object
+00010d80: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00010d90: 6665 6174 7572 6573 2c20 6e6f 7420 746f  features, not to
+00010da0: 2074 6865 2066 6561 7475 7265 7320 7468   the features th
+00010db0: 656d 7365 6c76 6573 2e0a 0a20 2020 2020  emselves...     
+00010dc0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00010dd0: 743a 2050 726f 6a65 6374 2077 6869 6368  t: Project which
+00010de0: 2063 6f6e 7461 696e 7320 7468 6573 6520   contains these 
+00010df0: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
+00010e00: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
+00010e10: 616d 6520 6f66 2074 6865 2066 6561 7475  ame of the featu
+00010e20: 7265 2074 6f20 6c6f 6f6b 2066 6f72 2e20  re to look for. 
+00010e30: 5468 6520 6e61 6d65 2069 7320 7573 6564  The name is used
+00010e40: 2069 6e20 6120 6c69 6b65 2071 7565 7279   in a like query
+00010e50: 2c20 616e 6420 6973 206e 6f74 2063 6173  , and is not cas
+00010e60: 652d 7365 6e73 6974 6976 652e 2046 6f72  e-sensitive. For
+00010e70: 0a20 2020 2020 2020 2020 2020 2065 7861  .            exa
+00010e80: 6d70 6c65 2c20 6c6f 6f6b 696e 6720 666f  mple, looking fo
+00010e90: 7220 6060 6665 6174 6060 2077 696c 6c20  r ``feat`` will 
+00010ea0: 7265 7475 726e 2066 6561 7475 7265 7320  return features 
+00010eb0: 7768 6963 6820 6172 6520 6e61 6d65 6420  which are named 
+00010ec0: 6060 4d79 4665 6174 7572 6560 6020 6173  ``MyFeature`` as
+00010ed0: 2077 656c 6c20 6173 2060 6064 6566 6561   well as ``defea
+00010ee0: 7460 602e 0a20 2020 2020 2020 203a 7061  t``..        :pa
+00010ef0: 7261 6d20 7461 673a 2052 6574 7572 6e20  ram tag: Return 
+00010f00: 6665 6174 7572 652d 7365 7473 2077 6869  feature-sets whi
+00010f10: 6368 2063 6f6e 7461 696e 2074 6865 2066  ch contain the f
+00010f20: 6561 7475 7265 7320 6c6f 6f6b 6564 2066  eatures looked f
+00010f30: 6f72 2c20 616e 6420 6172 6520 7461 6767  or, and are tagg
+00010f40: 6564 2077 6974 6820 7468 6520 7370 6563  ed with the spec
+00010f50: 6966 6963 2074 6167 2e0a 2020 2020 2020  ific tag..      
+00010f60: 2020 3a70 6172 616d 2065 6e74 6974 6965    :param entitie
+00010f70: 733a 2052 6574 7572 6e20 6f6e 6c79 2066  s: Return only f
+00010f80: 6561 7475 7265 2d73 6574 7320 7768 6963  eature-sets whic
+00010f90: 6820 636f 6e74 6169 6e20 616e 2065 6e74  h contain an ent
+00010fa0: 6974 7920 7768 6f73 6520 6e61 6d65 2069  ity whose name i
+00010fb0: 7320 636f 6e74 6169 6e65 6420 696e 2074  s contained in t
+00010fc0: 6869 7320 6c69 7374 2e0a 2020 2020 2020  his list..      
+00010fd0: 2020 3a70 6172 616d 206c 6162 656c 733a    :param labels:
+00010fe0: 2052 6574 7572 6e20 6f6e 6c79 2066 6561   Return only fea
+00010ff0: 7475 7265 2d73 6574 7320 7768 6963 6820  ture-sets which 
+00011000: 6172 6520 6c61 6265 6c65 6420 6173 2072  are labeled as r
+00011010: 6571 7565 7374 6564 2e0a 2020 2020 2020  equested..      
+00011020: 2020 3a72 6574 7572 6e73 3a20 4120 6c69    :returns: A li
+00011030: 7374 206f 6620 6d61 7070 696e 6720 6672  st of mapping fr
+00011040: 6f6d 2066 6561 7475 7265 2074 6f20 6120  om feature to a 
+00011050: 6469 6765 7374 206f 6620 7468 6520 6665  digest of the fe
+00011060: 6174 7572 652d 7365 742c 2077 6869 6368  ature-set, which
+00011070: 2063 6f6e 7461 696e 7320 7468 6520 6665   contains the fe
+00011080: 6174 7572 652d 7365 740a 2020 2020 2020  ature-set.      
+00011090: 2020 2020 2020 6d65 7461 2d64 6174 612e        meta-data.
+000110a0: 204d 756c 7469 706c 6520 656e 7472 6965   Multiple entrie
+000110b0: 7320 6d61 7920 6265 2072 6574 7572 6e65  s may be returne
+000110c0: 6420 666f 7220 616e 7920 7370 6563 6966  d for any specif
+000110d0: 6963 2066 6561 7475 7265 2064 7565 2074  ic feature due t
+000110e0: 6f20 6d75 6c74 6970 6c65 2074 6167 7320  o multiple tags 
+000110f0: 6f72 2076 6572 7369 6f6e 730a 2020 2020  or versions.    
+00011100: 2020 2020 2020 2020 6f66 2074 6865 2066          of the f
+00011110: 6561 7475 7265 2d73 6574 2e0a 2020 2020  eature-set..    
+00011120: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00011130: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00011140: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00011150: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00011160: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+00011170: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+00011180: 6522 3a20 6e61 6d65 2c0a 2020 2020 2020  e": name,.      
+00011190: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+000111a0: 2c0a 2020 2020 2020 2020 2020 2020 2265  ,.            "e
+000111b0: 6e74 6974 7922 3a20 656e 7469 7469 6573  ntity": entities
+000111c0: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+000111d0: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+000111e0: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+000111f0: 2020 207d 0a0a 2020 2020 2020 2020 7061     }..        pa
+00011200: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00011210: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00011220: 6573 220a 0a20 2020 2020 2020 2065 7272  es"..        err
+00011230: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+00011240: 6169 6c65 6420 6c69 7374 696e 6720 6665  ailed listing fe
+00011250: 6174 7572 6573 2c20 7072 6f6a 6563 743a  atures, project:
+00011260: 207b 7072 6f6a 6563 747d 2c20 7175 6572   {project}, quer
+00011270: 793a 207b 7061 7261 6d73 7d22 0a20 2020  y: {params}".   
+00011280: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+00011290: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
+000112a0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+000112b0: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+000112c0: 616d 7329 0a20 2020 2020 2020 2072 6574  ams).        ret
+000112d0: 7572 6e20 7265 7370 2e6a 736f 6e28 295b  urn resp.json()[
+000112e0: 2266 6561 7475 7265 7322 5d0a 0a20 2020  "features"]..   
+000112f0: 2064 6566 206c 6973 745f 656e 7469 7469   def list_entiti
+00011300: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
+00011310: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00011320: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00011330: 6e61 6d65 3a20 7374 7220 3d20 4e6f 6e65  name: str = None
+00011340: 2c0a 2020 2020 2020 2020 7461 673a 2073  ,.        tag: s
+00011350: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
+00011360: 2020 206c 6162 656c 733a 204c 6973 745b     labels: List[
+00011370: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00011380: 2029 202d 3e20 4c69 7374 5b64 6963 745d   ) -> List[dict]
+00011390: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+000113a0: 7269 6576 6520 6120 6c69 7374 206f 6620  rieve a list of 
+000113b0: 656e 7469 7469 6573 2061 6e64 2074 6865  entities and the
+000113c0: 6972 206d 6170 7069 6e67 2074 6f20 7468  ir mapping to th
+000113d0: 6520 636f 6e74 6169 6e69 6e67 2066 6561  e containing fea
+000113e0: 7475 7265 2d73 6574 732e 2054 6869 7320  ture-sets. This 
+000113f0: 6675 6e63 7469 6f6e 2069 7320 7369 6d69  function is simi
+00011400: 6c61 720a 2020 2020 2020 2020 746f 2074  lar.        to t
+00011410: 6865 203a 7079 3a66 756e 633a 607e 6c69  he :py:func:`~li
+00011420: 7374 5f66 6561 7475 7265 7360 2066 756e  st_features` fun
+00011430: 6374 696f 6e2c 2061 6e64 2075 7365 7320  ction, and uses 
+00011440: 7468 6520 7361 6d65 206c 6f67 6963 2e20  the same logic. 
+00011450: 486f 7765 7665 722c 2074 6865 2065 6e74  However, the ent
+00011460: 6974 6965 7320 6172 6520 6d61 7463 6865  ities are matche
+00011470: 640a 2020 2020 2020 2020 6167 6169 6e73  d.        agains
+00011480: 7420 7468 6520 6e61 6d65 2072 6174 6865  t the name rathe
+00011490: 7220 7468 616e 2074 6865 2066 6561 7475  r than the featu
+000114a0: 7265 732e 0a20 2020 2020 2020 2022 2222  res..        """
+000114b0: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+000114c0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+000114d0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+000114e0: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
+000114f0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00011500: 2020 2020 2022 6e61 6d65 223a 206e 616d       "name": nam
+00011510: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00011520: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+00011530: 2020 2020 2020 2022 6c61 6265 6c22 3a20         "label": 
+00011540: 6c61 6265 6c73 206f 7220 5b5d 2c0a 2020  labels or [],.  
+00011550: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+00011560: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+00011570: 7473 2f7b 7072 6f6a 6563 747d 2f65 6e74  ts/{project}/ent
+00011580: 6974 6965 7322 0a0a 2020 2020 2020 2020  ities"..        
+00011590: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+000115a0: 6622 4661 696c 6564 206c 6973 7469 6e67  f"Failed listing
+000115b0: 2065 6e74 6974 6965 732c 2070 726f 6a65   entities, proje
+000115c0: 6374 3a20 7b70 726f 6a65 6374 7d2c 2071  ct: {project}, q
+000115d0: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
+000115e0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+000115f0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+00011600: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
+00011610: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
+00011620: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00011630: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
+00011640: 2829 5b22 656e 7469 7469 6573 225d 0a0a  ()["entities"]..
+00011650: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00011660: 640a 2020 2020 6465 6620 5f67 656e 6572  d.    def _gener
+00011670: 6174 655f 7061 7274 6974 696f 6e5f 6279  ate_partition_by
+00011680: 5f70 6172 616d 7328 0a20 2020 2020 2020  _params(.       
+00011690: 2070 6172 7469 7469 6f6e 5f62 795f 636c   partition_by_cl
+000116a0: 732c 0a20 2020 2020 2020 2070 6172 7469  s,.        parti
+000116b0: 7469 6f6e 5f62 792c 0a20 2020 2020 2020  tion_by,.       
+000116c0: 2072 6f77 735f 7065 725f 7061 7274 6974   rows_per_partit
+000116d0: 696f 6e2c 0a20 2020 2020 2020 2073 6f72  ion,.        sor
+000116e0: 745f 6279 2c0a 2020 2020 2020 2020 6f72  t_by,.        or
+000116f0: 6465 722c 0a20 2020 2020 2020 206d 6178  der,.        max
+00011700: 5f70 6172 7469 7469 6f6e 733d 4e6f 6e65  _partitions=None
+00011710: 2c0a 2020 2020 293a 0a0a 2020 2020 2020  ,.    ):..      
+00011720: 2020 7061 7274 6974 696f 6e5f 7061 7261    partition_para
+00011730: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00011740: 2020 2022 7061 7274 6974 696f 6e2d 6279     "partition-by
+00011750: 223a 2070 6172 7469 7469 6f6e 5f62 792c  ": partition_by,
+00011760: 0a20 2020 2020 2020 2020 2020 2022 726f  .            "ro
+00011770: 7773 2d70 6572 2d70 6172 7469 7469 6f6e  ws-per-partition
+00011780: 223a 2072 6f77 735f 7065 725f 7061 7274  ": rows_per_part
+00011790: 6974 696f 6e2c 0a20 2020 2020 2020 2020  ition,.         
+000117a0: 2020 2022 7061 7274 6974 696f 6e2d 736f     "partition-so
+000117b0: 7274 2d62 7922 3a20 736f 7274 5f62 792c  rt-by": sort_by,
+000117c0: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
+000117d0: 7274 6974 696f 6e2d 6f72 6465 7222 3a20  rtition-order": 
+000117e0: 6f72 6465 722c 0a20 2020 2020 2020 207d  order,.        }
+000117f0: 0a20 2020 2020 2020 2069 6620 6d61 785f  .        if max_
+00011800: 7061 7274 6974 696f 6e73 2069 7320 6e6f  partitions is no
+00011810: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00011820: 2020 2020 7061 7274 6974 696f 6e5f 7061      partition_pa
+00011830: 7261 6d73 5b22 6d61 782d 7061 7274 6974  rams["max-partit
+00011840: 696f 6e73 225d 203d 206d 6178 5f70 6172  ions"] = max_par
+00011850: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+00011860: 7265 7475 726e 2070 6172 7469 7469 6f6e  return partition
+00011870: 5f70 6172 616d 730a 0a20 2020 2064 6566  _params..    def
+00011880: 206c 6973 745f 6665 6174 7572 655f 7365   list_feature_se
+00011890: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+000118a0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+000118b0: 743a 2073 7472 203d 2022 222c 0a20 2020  t: str = "",.   
+000118c0: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
+000118d0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+000118e0: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c0a  ag: str = None,.
+000118f0: 2020 2020 2020 2020 7374 6174 653a 2073          state: s
+00011900: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
+00011910: 2020 2065 6e74 6974 6965 733a 204c 6973     entities: Lis
+00011920: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
+00011930: 2020 2020 2020 2066 6561 7475 7265 733a         features:
+00011940: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
+00011950: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
+00011960: 733a 204c 6973 745b 7374 725d 203d 204e  s: List[str] = N
+00011970: 6f6e 652c 0a20 2020 2020 2020 2070 6172  one,.        par
+00011980: 7469 7469 6f6e 5f62 793a 2055 6e69 6f6e  tition_by: Union
+00011990: 5b0a 2020 2020 2020 2020 2020 2020 6d6c  [.            ml
+000119a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000119b0: 6173 2e46 6561 7475 7265 5374 6f72 6550  as.FeatureStoreP
+000119c0: 6172 7469 7469 6f6e 4279 4669 656c 642c  artitionByField,
+000119d0: 2073 7472 0a20 2020 2020 2020 205d 203d   str.        ] =
+000119e0: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
+000119f0: 6f77 735f 7065 725f 7061 7274 6974 696f  ows_per_partitio
+00011a00: 6e3a 2069 6e74 203d 2031 2c0a 2020 2020  n: int = 1,.    
+00011a10: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
+00011a20: 7274 5f62 793a 2055 6e69 6f6e 5b6d 6c72  rt_by: Union[mlr
+00011a30: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00011a40: 732e 536f 7274 4669 656c 642c 2073 7472  s.SortField, str
+00011a50: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00011a60: 2020 7061 7274 6974 696f 6e5f 6f72 6465    partition_orde
+00011a70: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
+00011a80: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
+00011a90: 6f6e 2e73 6368 656d 6173 2e4f 7264 6572  on.schemas.Order
+00011aa0: 5479 7065 2c20 7374 720a 2020 2020 2020  Type, str.      
+00011ab0: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+00011ac0: 6f6e 2e73 6368 656d 6173 2e4f 7264 6572  on.schemas.Order
+00011ad0: 5479 7065 2e64 6573 632c 0a20 2020 2029  Type.desc,.    )
+00011ae0: 202d 3e20 4c69 7374 5b46 6561 7475 7265   -> List[Feature
+00011af0: 5365 745d 3a0a 2020 2020 2020 2020 2222  Set]:.        ""
+00011b00: 2252 6574 7269 6576 6520 6120 6c69 7374  "Retrieve a list
+00011b10: 206f 6620 6665 6174 7572 652d 7365 7473   of feature-sets
+00011b20: 206d 6174 6368 696e 6720 7468 6520 6372   matching the cr
+00011b30: 6974 6572 6961 2070 726f 7669 6465 642e  iteria provided.
+00011b40: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011b50: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00011b60: 7420 6e61 6d65 2e0a 2020 2020 2020 2020  t name..        
+00011b70: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+00011b80: 6520 6f66 2066 6561 7475 7265 2d73 6574  e of feature-set
+00011b90: 2074 6f20 6d61 7463 682e 2054 6869 7320   to match. This 
+00011ba0: 6973 2061 206c 696b 6520 7175 6572 792c  is a like query,
+00011bb0: 2061 6e64 2069 7320 6361 7365 2d69 6e73   and is case-ins
+00011bc0: 656e 7369 7469 7665 2e0a 2020 2020 2020  ensitive..      
+00011bd0: 2020 3a70 6172 616d 2074 6167 3a20 4d61    :param tag: Ma
+00011be0: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
+00011bf0: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
+00011c00: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+00011c10: 616d 2073 7461 7465 3a20 4d61 7463 6820  am state: Match 
+00011c20: 6665 6174 7572 652d 7365 7473 2077 6974  feature-sets wit
+00011c30: 6820 6120 7370 6563 6966 6963 2073 7461  h a specific sta
+00011c40: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
+00011c50: 616d 2065 6e74 6974 6965 733a 204d 6174  am entities: Mat
+00011c60: 6368 2066 6561 7475 7265 2d73 6574 7320  ch feature-sets 
+00011c70: 7768 6963 6820 636f 6e74 6169 6e20 656e  which contain en
+00011c80: 7469 7469 6573 2077 686f 7365 206e 616d  tities whose nam
+00011c90: 6520 6973 2069 6e20 7468 6973 206c 6973  e is in this lis
+00011ca0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+00011cb0: 6d20 6665 6174 7572 6573 3a20 4d61 7463  m features: Matc
+00011cc0: 6820 6665 6174 7572 652d 7365 7473 2077  h feature-sets w
+00011cd0: 6869 6368 2063 6f6e 7461 696e 2066 6561  hich contain fea
+00011ce0: 7475 7265 7320 7768 6f73 6520 6e61 6d65  tures whose name
+00011cf0: 2069 7320 696e 2074 6869 7320 6c69 7374   is in this list
+00011d00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011d10: 206c 6162 656c 733a 204d 6174 6368 2066   labels: Match f
+00011d20: 6561 7475 7265 2d73 6574 7320 7768 6963  eature-sets whic
+00011d30: 6820 6861 7665 2074 6865 7365 206c 6162  h have these lab
+00011d40: 656c 732e 0a20 2020 2020 2020 203a 7061  els..        :pa
+00011d50: 7261 6d20 7061 7274 6974 696f 6e5f 6279  ram partition_by
+00011d60: 3a20 4669 656c 6420 746f 2067 726f 7570  : Field to group
+00011d70: 2072 6573 756c 7473 2062 792e 204f 6e6c   results by. Onl
+00011d80: 7920 616c 6c6f 7765 6420 7661 6c75 6520  y allowed value 
+00011d90: 6973 2060 6e61 6d65 602e 2057 6865 6e20  is `name`. When 
+00011da0: 6070 6172 7469 7469 6f6e 5f62 7960 2069  `partition_by` i
+00011db0: 7320 7370 6563 6966 6965 642c 0a20 2020  s specified,.   
+00011dc0: 2020 2020 2020 2020 2074 6865 2060 7061           the `pa
+00011dd0: 7274 6974 696f 6e5f 736f 7274 5f62 7960  rtition_sort_by`
+00011de0: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
+00011df0: 6265 2070 726f 7669 6465 6420 6173 2077  be provided as w
+00011e00: 656c 6c2e 0a20 2020 2020 2020 203a 7061  ell..        :pa
+00011e10: 7261 6d20 726f 7773 5f70 6572 5f70 6172  ram rows_per_par
+00011e20: 7469 7469 6f6e 3a20 486f 7720 6d61 6e79  tition: How many
+00011e30: 2074 6f70 2072 6f77 7320 2870 6572 2073   top rows (per s
+00011e40: 6f72 7469 6e67 2064 6566 696e 6564 2062  orting defined b
+00011e50: 7920 6070 6172 7469 7469 6f6e 5f73 6f72  y `partition_sor
+00011e60: 745f 6279 6020 616e 6420 6070 6172 7469  t_by` and `parti
+00011e70: 7469 6f6e 5f6f 7264 6572 6029 0a20 2020  tion_order`).   
+00011e80: 2020 2020 2020 2020 2074 6f20 7265 7475           to retu
+00011e90: 726e 2070 6572 2067 726f 7570 2e20 4465  rn per group. De
+00011ea0: 6661 756c 7420 7661 6c75 6520 6973 2031  fault value is 1
+00011eb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011ec0: 2070 6172 7469 7469 6f6e 5f73 6f72 745f   partition_sort_
+00011ed0: 6279 3a20 5768 6174 2066 6965 6c64 2074  by: What field t
+00011ee0: 6f20 736f 7274 2074 6865 2072 6573 756c  o sort the resul
+00011ef0: 7473 2062 792c 2077 6974 6869 6e20 6561  ts by, within ea
+00011f00: 6368 2070 6172 7469 7469 6f6e 2064 6566  ch partition def
+00011f10: 696e 6564 2062 7920 6070 6172 7469 7469  ined by `partiti
+00011f20: 6f6e 5f62 7960 2e0a 2020 2020 2020 2020  on_by`..        
+00011f30: 2020 2020 4375 7272 656e 746c 7920 7468      Currently th
+00011f40: 6520 6f6e 6c79 2061 6c6c 6f77 6564 2076  e only allowed v
+00011f50: 616c 7565 2061 7265 2060 6372 6561 7465  alue are `create
+00011f60: 6460 2061 6e64 2060 7570 6461 7465 6460  d` and `updated`
+00011f70: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011f80: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+00011f90: 3a20 4f72 6465 7220 6f66 2073 6f72 7469  : Order of sorti
+00011fa0: 6e67 2077 6974 6869 6e20 7061 7274 6974  ng within partit
+00011fb0: 696f 6e73 202d 2060 6173 6360 206f 7220  ions - `asc` or 
+00011fc0: 6064 6573 6360 2e20 4465 6661 756c 7420  `desc`. Default 
+00011fd0: 6973 2060 6465 7363 602e 0a20 2020 2020  is `desc`..     
+00011fe0: 2020 203a 7265 7475 726e 733a 204c 6973     :returns: Lis
+00011ff0: 7420 6f66 206d 6174 6368 696e 6720 3a70  t of matching :p
+00012000: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00012010: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00012020: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
+00012030: 732e 0a20 2020 2020 2020 2022 2222 0a0a  s..        """..
+00012040: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00012050: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00012060: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00012070: 6563 740a 0a20 2020 2020 2020 2070 6172  ect..        par
+00012080: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00012090: 2020 2020 226e 616d 6522 3a20 6e61 6d65      "name": name
+000120a0: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+000120b0: 7461 7465 223a 2073 7461 7465 2c0a 2020  tate": state,.  
+000120c0: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
+000120d0: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
+000120e0: 2020 2265 6e74 6974 7922 3a20 656e 7469    "entity": enti
+000120f0: 7469 6573 206f 7220 5b5d 2c0a 2020 2020  ties or [],.    
+00012100: 2020 2020 2020 2020 2266 6561 7475 7265          "feature
+00012110: 223a 2066 6561 7475 7265 7320 6f72 205b  ": features or [
+00012120: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+00012130: 6c61 6265 6c22 3a20 6c61 6265 6c73 206f  label": labels o
+00012140: 7220 5b5d 2c0a 2020 2020 2020 2020 7d0a  r [],.        }.
+00012150: 2020 2020 2020 2020 6966 2070 6172 7469          if parti
+00012160: 7469 6f6e 5f62 793a 0a20 2020 2020 2020  tion_by:.       
+00012170: 2020 2020 2070 6172 616d 732e 7570 6461       params.upda
+00012180: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00012190: 2020 2020 7365 6c66 2e5f 6765 6e65 7261      self._genera
+000121a0: 7465 5f70 6172 7469 7469 6f6e 5f62 795f  te_partition_by_
+000121b0: 7061 7261 6d73 280a 2020 2020 2020 2020  params(.        
+000121c0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+000121d0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000121e0: 2e46 6561 7475 7265 5374 6f72 6550 6172  .FeatureStorePar
+000121f0: 7469 7469 6f6e 4279 4669 656c 642c 0a20  titionByField,. 
+00012200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012210: 2020 2070 6172 7469 7469 6f6e 5f62 792c     partition_by,
+00012220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012230: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
+00012240: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
+00012250: 2020 2020 2020 2020 2020 2020 2070 6172               par
+00012260: 7469 7469 6f6e 5f73 6f72 745f 6279 2c0a  tition_sort_by,.
+00012270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012280: 2020 2020 7061 7274 6974 696f 6e5f 6f72      partition_or
+00012290: 6465 722c 0a20 2020 2020 2020 2020 2020  der,.           
+000122a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000122b0: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
+000122c0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+000122d0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+000122e0: 652d 7365 7473 220a 0a20 2020 2020 2020  e-sets"..       
+000122f0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00012300: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
+00012310: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
+00012320: 6665 6174 7572 652d 7365 7473 2c20 7072  feature-sets, pr
+00012330: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
+00012340: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
+00012350: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
+00012360: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+00012370: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
+00012380: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+00012390: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+000123a0: 616d 7329 0a20 2020 2020 2020 2066 6561  ams).        fea
+000123b0: 7475 7265 5f73 6574 7320 3d20 7265 7370  ture_sets = resp
+000123c0: 2e6a 736f 6e28 295b 2266 6561 7475 7265  .json()["feature
+000123d0: 5f73 6574 7322 5d0a 2020 2020 2020 2020  _sets"].        
+000123e0: 6966 2066 6561 7475 7265 5f73 6574 733a  if feature_sets:
+000123f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00012400: 7572 6e20 5b46 6561 7475 7265 5365 742e  urn [FeatureSet.
+00012410: 6672 6f6d 5f64 6963 7428 6f62 6a29 2066  from_dict(obj) f
+00012420: 6f72 206f 626a 2069 6e20 6665 6174 7572  or obj in featur
+00012430: 655f 7365 7473 5d0a 0a20 2020 2064 6566  e_sets]..    def
+00012440: 2073 746f 7265 5f66 6561 7475 7265 5f73   store_feature_s
+00012450: 6574 280a 2020 2020 2020 2020 7365 6c66  et(.        self
+00012460: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
+00012470: 655f 7365 743a 2055 6e69 6f6e 5b64 6963  e_set: Union[dic
+00012480: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
+00012490: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+000124a0: 6574 2c20 4665 6174 7572 6553 6574 5d2c  et, FeatureSet],
+000124b0: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
+000124c0: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
+000124d0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
+000124e0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
+000124f0: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
+00012500: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+00012510: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+00012520: 743a 0a20 2020 2020 2020 2022 2222 5361  t:.        """Sa
+00012530: 7665 2061 203a 7079 3a63 6c61 7373 3a60  ve a :py:class:`
+00012540: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00012550: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00012560: 206f 626a 6563 7420 696e 2074 6865 203a   object in the :
+00012570: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2044  py:mod:`mlrun` D
+00012580: 422e 2054 6865 0a20 2020 2020 2020 2066  B. The.        f
+00012590: 6561 7475 7265 2d73 6574 2063 616e 2062  eature-set can b
+000125a0: 6520 6569 7468 6572 2061 206e 6577 206f  e either a new o
+000125b0: 626a 6563 7420 6f72 2061 206d 6f64 6966  bject or a modif
+000125c0: 6963 6174 696f 6e20 746f 2065 7869 7374  ication to exist
+000125d0: 696e 6720 6f62 6a65 6374 2072 6566 6572  ing object refer
+000125e0: 656e 6365 6420 6279 2074 6865 2070 6172  enced by the par
+000125f0: 616d 7320 6f66 0a20 2020 2020 2020 2074  ams of.        t
+00012600: 6865 2066 756e 6374 696f 6e2e 0a0a 2020  he function...  
+00012610: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
+00012620: 7475 7265 5f73 6574 3a20 5468 6520 3a70  ture_set: The :p
+00012630: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00012640: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00012650: 6174 7572 6553 6574 6020 746f 2073 746f  atureSet` to sto
+00012660: 7265 2e0a 2020 2020 2020 2020 3a70 6172  re..        :par
+00012670: 616d 206e 616d 653a 2020 2020 4e61 6d65  am name:    Name
+00012680: 206f 6620 6665 6174 7572 6520 7365 742e   of feature set.
+00012690: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000126a0: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
+000126b0: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
+000126c0: 6174 7572 652d 7365 7420 6265 6c6f 6e67  ature-set belong
+000126d0: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
+000126e0: 6172 616d 2074 6167 3a20 5468 6520 6060  aram tag: The ``
+000126f0: 7461 6760 6020 6f66 2074 6865 206f 626a  tag`` of the obj
+00012700: 6563 7420 746f 2072 6570 6c61 6365 2069  ect to replace i
+00012710: 6e20 7468 6520 4442 2c20 666f 7220 6578  n the DB, for ex
+00012720: 616d 706c 6520 6060 6c61 7465 7374 6060  ample ``latest``
+00012730: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00012740: 2075 6964 3a20 5468 6520 6060 7569 6460   uid: The ``uid`
+00012750: 6020 6f66 2074 6865 206f 626a 6563 7420  ` of the object 
+00012760: 746f 2072 6570 6c61 6365 2069 6e20 7468  to replace in th
+00012770: 6520 4442 2e20 4966 2075 7369 6e67 2074  e DB. If using t
+00012780: 6869 7320 7061 7261 6d65 7465 722c 2074  his parameter, t
+00012790: 6865 206d 6f64 6966 6965 6420 6f62 6a65  he modified obje
+000127a0: 6374 0a20 2020 2020 2020 2020 2020 206d  ct.            m
+000127b0: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
+000127c0: 6520 6060 7569 6460 6020 6f66 2074 6865  e ``uid`` of the
+000127d0: 2070 7265 7669 6f75 736c 792d 6578 6973   previously-exis
+000127e0: 7469 6e67 206f 626a 6563 742e 2054 6869  ting object. Thi
+000127f0: 7320 6361 6e6e 6f74 2062 6520 7573 6564  s cannot be used
+00012800: 2066 6f72 206e 6f6e 2d76 6572 7369 6f6e   for non-version
+00012810: 6564 206f 626a 6563 7473 2e0a 2020 2020  ed objects..    
+00012820: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
+00012830: 6f6e 6564 3a20 5768 6574 6865 7220 746f  oned: Whether to
+00012840: 206d 6169 6e74 6169 6e20 7665 7273 696f   maintain versio
+00012850: 6e73 2066 6f72 2074 6869 7320 6665 6174  ns for this feat
+00012860: 7572 652d 7365 742e 2041 6c6c 2076 6572  ure-set. All ver
+00012870: 7369 6f6e 7320 6f66 2061 2076 6572 7369  sions of a versi
+00012880: 6f6e 6564 206f 626a 6563 740a 2020 2020  oned object.    
+00012890: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+000128a0: 6b65 7074 2069 6e20 7468 6520 4442 2061  kept in the DB a
+000128b0: 6e64 2063 616e 2062 6520 7265 7472 6965  nd can be retrie
+000128c0: 7665 6420 756e 7469 6c20 6578 706c 6963  ved until explic
+000128d0: 6974 6c79 2064 656c 6574 6564 2e0a 2020  itly deleted..  
+000128e0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+000128f0: 5468 6520 3a70 793a 636c 6173 733a 607e  The :py:class:`~
+00012900: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
+00012910: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
+00012920: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
+00012930: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00012940: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+00012950: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
+00012960: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
+00012970: 7569 6429 0a20 2020 2020 2020 2070 6172  uid).        par
+00012980: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
+00012990: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
+000129a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000129b0: 7461 6e63 6528 6665 6174 7572 655f 7365  tance(feature_se
+000129c0: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
+000129d0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+000129e0: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
+000129f0: 2066 6561 7475 7265 5f73 6574 203d 2066   feature_set = f
+00012a00: 6561 7475 7265 5f73 6574 2e64 6963 7428  eature_set.dict(
+00012a10: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+00012a20: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
+00012a30: 655f 7365 742c 2046 6561 7475 7265 5365  e_set, FeatureSe
+00012a40: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00012a50: 6665 6174 7572 655f 7365 7420 3d20 6665  feature_set = fe
+00012a60: 6174 7572 655f 7365 742e 746f 5f64 6963  ature_set.to_dic
+00012a70: 7428 290a 0a20 2020 2020 2020 206e 616d  t()..        nam
+00012a80: 6520 3d20 6e61 6d65 206f 7220 6665 6174  e = name or feat
+00012a90: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
+00012aa0: 6122 5d5b 226e 616d 6522 5d0a 2020 2020  a"]["name"].    
+00012ab0: 2020 2020 7072 6f6a 6563 7420 3d20 280a      project = (.
+00012ac0: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
+00012ad0: 6563 7420 6f72 2066 6561 7475 7265 5f73  ect or feature_s
+00012ae0: 6574 5b22 6d65 7461 6461 7461 225d 2e67  et["metadata"].g
+00012af0: 6574 2822 7072 6f6a 6563 7422 2920 6f72  et("project") or
+00012b00: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00012b10: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00012b20: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
+00012b30: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+00012b40: 6a65 6374 7d2f 6665 6174 7572 652d 7365  ject}/feature-se
+00012b50: 7473 2f7b 6e61 6d65 7d2f 7265 6665 7265  ts/{name}/refere
+00012b60: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
+00012b70: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+00012b80: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00012b90: 6564 2073 746f 7269 6e67 2066 6561 7475  ed storing featu
+00012ba0: 7265 2d73 6574 207b 7072 6f6a 6563 747d  re-set {project}
+00012bb0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+00012bc0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+00012bd0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00012be0: 2020 2022 5055 5422 2c20 7061 7468 2c20     "PUT", path, 
+00012bf0: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+00012c00: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
+00012c10: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+00012c20: 6665 6174 7572 655f 7365 7429 0a20 2020  feature_set).   
+00012c30: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00012c40: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+00012c50: 290a 0a20 2020 2064 6566 2070 6174 6368  )..    def patch
+00012c60: 5f66 6561 7475 7265 5f73 6574 280a 2020  _feature_set(.  
+00012c70: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00012c80: 2020 2020 6e61 6d65 2c0a 2020 2020 2020      name,.      
+00012c90: 2020 6665 6174 7572 655f 7365 745f 7570    feature_set_up
+00012ca0: 6461 7465 3a20 6469 6374 2c0a 2020 2020  date: dict,.    
+00012cb0: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
+00012cc0: 2020 2020 2020 2020 7461 673d 4e6f 6e65          tag=None
+00012cd0: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
+00012ce0: 6e65 2c0a 2020 2020 2020 2020 7061 7463  ne,.        patc
+00012cf0: 685f 6d6f 6465 3a20 556e 696f 6e5b 0a20  h_mode: Union[. 
+00012d00: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
+00012d10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00012d20: 656d 6173 2e50 6174 6368 4d6f 6465 0a20  emas.PatchMode. 
+00012d30: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00012d40: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00012d50: 5061 7463 684d 6f64 652e 7265 706c 6163  PatchMode.replac
+00012d60: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00012d70: 2020 2222 224d 6f64 6966 7920 2870 6174    """Modify (pat
+00012d80: 6368 2920 616e 2065 7869 7374 696e 6720  ch) an existing 
+00012d90: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00012da0: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+00012db0: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
+00012dc0: 6374 2e0a 2020 2020 2020 2020 5468 6520  ct..        The 
+00012dd0: 6f62 6a65 6374 2069 7320 6964 656e 7469  object is identi
+00012de0: 6669 6564 2062 7920 6974 7320 6e61 6d65  fied by its name
+00012df0: 2028 616e 6420 7072 6f6a 6563 7420 6974   (and project it
+00012e00: 2062 656c 6f6e 6773 2074 6f29 2c20 6173   belongs to), as
+00012e10: 2077 656c 6c20 6173 206f 7074 696f 6e61   well as optiona
+00012e20: 6c6c 7920 6120 6060 7461 6760 6020 6f72  lly a ``tag`` or
+00012e30: 2069 7473 0a20 2020 2020 2020 2060 6075   its.        ``u
+00012e40: 6964 6060 2028 666f 7220 7665 7273 696f  id`` (for versio
+00012e50: 6e65 6420 6f62 6a65 6374 292e 2049 6620  ned object). If 
+00012e60: 626f 7468 2060 6074 6167 6060 2061 6e64  both ``tag`` and
+00012e70: 2060 6075 6964 6060 2061 7265 206f 6d69   ``uid`` are omi
+00012e80: 7474 6564 2074 6865 6e20 7468 6520 6f62  tted then the ob
+00012e90: 6a65 6374 2077 6974 6820 7461 6720 6060  ject with tag ``
+00012ea0: 6c61 7465 7374 6060 0a20 2020 2020 2020  latest``.       
+00012eb0: 2069 7320 6d6f 6469 6669 6564 2e0a 0a20   is modified... 
+00012ec0: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+00012ed0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
+00012ee0: 6f62 6a65 6374 2074 6f20 7061 7463 682e  object to patch.
+00012ef0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00012f00: 6665 6174 7572 655f 7365 745f 7570 6461  feature_set_upda
+00012f10: 7465 3a20 5468 6520 6d6f 6469 6669 6361  te: The modifica
+00012f20: 7469 6f6e 7320 6e65 6564 6564 2069 6e20  tions needed in 
+00012f30: 7468 6520 6f62 6a65 6374 2e20 5468 6973  the object. This
+00012f40: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
+00012f50: 6861 7320 7468 6520 6368 616e 6765 7320  has the changes 
+00012f60: 696e 2069 742c 0a20 2020 2020 2020 2020  in it,.         
+00012f70: 2020 206e 6f74 2061 2066 756c 6c20 6f62     not a full ob
+00012f80: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
+00012f90: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00012fa0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00012fb0: 7475 7265 5f73 6574 5f75 7064 6174 6520  ture_set_update 
+00012fc0: 3d20 7b22 7374 6174 7573 223a 207b 2270  = {"status": {"p
+00012fd0: 726f 6365 7373 6564 2220 3a20 5472 7565  rocessed" : True
+00012fe0: 7d7d 0a0a 2020 2020 2020 2020 2020 2020  }}..            
+00012ff0: 5769 6c6c 2061 7070 6c79 2074 6865 2066  Will apply the f
+00013000: 6965 6c64 2060 6073 7461 7475 732e 7072  ield ``status.pr
+00013010: 6f63 6573 7365 6460 6020 746f 2074 6865  ocessed`` to the
+00013020: 2065 7869 7374 696e 6720 6f62 6a65 6374   existing object
+00013030: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00013040: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00013050: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00013060: 2074 6865 206d 6f64 6966 6965 6420 6f62   the modified ob
+00013070: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
+00013080: 6172 616d 2074 6167 3a20 5468 6520 7461  aram tag: The ta
+00013090: 6720 6f66 2074 6865 206f 626a 6563 7420  g of the object 
+000130a0: 746f 206d 6f64 6966 792e 0a20 2020 2020  to modify..     
+000130b0: 2020 203a 7061 7261 6d20 7569 643a 2075     :param uid: u
+000130c0: 6964 206f 6620 7468 6520 6f62 6a65 6374  id of the object
+000130d0: 2074 6f20 6d6f 6469 6679 2e0a 2020 2020   to modify..    
+000130e0: 2020 2020 3a70 6172 616d 2070 6174 6368      :param patch
+000130f0: 5f6d 6f64 653a 2054 6865 2073 7472 6174  _mode: The strat
+00013100: 6567 7920 666f 7220 6d65 7267 696e 6720  egy for merging 
+00013110: 7468 6520 6368 616e 6765 7320 7769 7468  the changes with
+00013120: 2074 6865 2065 7869 7374 696e 6720 6f62   the existing ob
+00013130: 6a65 6374 2e20 4361 6e20 6265 2065 6974  ject. Can be eit
+00013140: 6865 7220 6060 7265 706c 6163 6560 600a  her ``replace``.
+00013150: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
+00013160: 6061 6464 6974 6976 6560 602e 0a20 2020  `additive``..   
+00013170: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00013180: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00013190: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+000131a0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+000131b0: 2020 2020 2072 6566 6572 656e 6365 203d       reference =
+000131c0: 2073 656c 662e 5f72 6573 6f6c 7665 5f72   self._resolve_r
+000131d0: 6566 6572 656e 6365 2874 6167 2c20 7569  eference(tag, ui
+000131e0: 6429 0a20 2020 2020 2020 2068 6561 6465  d).        heade
+000131f0: 7273 203d 207b 6d6c 7275 6e2e 636f 6d6d  rs = {mlrun.comm
+00013200: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+00013210: 724e 616d 6573 2e70 6174 6368 5f6d 6f64  rNames.patch_mod
+00013220: 653a 2070 6174 6368 5f6d 6f64 657d 0a20  e: patch_mode}. 
+00013230: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00013240: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00013250: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
+00013260: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
+00013270: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
+00013280: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00013290: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+000132a0: 7570 6461 7469 6e67 2066 6561 7475 7265  updating feature
+000132b0: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
+000132c0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+000132d0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+000132e0: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
+000132f0: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00013300: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+00013310: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+00013320: 2020 2020 2020 2020 2020 2020 626f 6479              body
+00013330: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
+00013340: 6174 7572 655f 7365 745f 7570 6461 7465  ature_set_update
+00013350: 292c 0a20 2020 2020 2020 2020 2020 2068  ),.            h
+00013360: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
+00013370: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00013380: 6566 2064 656c 6574 655f 6665 6174 7572  ef delete_featur
+00013390: 655f 7365 7428 7365 6c66 2c20 6e61 6d65  e_set(self, name
+000133a0: 2c20 7072 6f6a 6563 743d 2222 2c20 7461  , project="", ta
+000133b0: 673d 4e6f 6e65 2c20 7569 643d 4e6f 6e65  g=None, uid=None
+000133c0: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
+000133d0: 6c65 7465 2061 203a 7079 3a63 6c61 7373  lete a :py:class
+000133e0: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+000133f0: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
+00013400: 7460 206f 626a 6563 7420 6672 6f6d 2074  t` object from t
+00013410: 6865 2044 422e 0a20 2020 2020 2020 2049  he DB..        I
+00013420: 6620 6060 7461 6760 6020 6f72 2060 6075  f ``tag`` or ``u
+00013430: 6964 6060 2061 7265 2073 7065 6369 6669  id`` are specifi
+00013440: 6564 2c20 7468 656e 206a 7573 7420 7468  ed, then just th
+00013450: 6520 7665 7273 696f 6e20 7265 6665 7265  e version refere
+00013460: 6e63 6564 2062 7920 7468 656d 2077 696c  nced by them wil
+00013470: 6c20 6265 2064 656c 6574 6564 2e20 5573  l be deleted. Us
+00013480: 696e 6720 626f 7468 0a20 2020 2020 2020  ing both.       
+00013490: 2069 7320 6e6f 7420 616c 6c6f 7765 642e   is not allowed.
+000134a0: 0a20 2020 2020 2020 2049 6620 6e6f 6e65  .        If none
+000134b0: 2061 7265 2073 7065 6369 6669 6564 2c20   are specified, 
+000134c0: 7468 656e 2061 6c6c 2069 6e73 7461 6e63  then all instanc
+000134d0: 6573 206f 6620 7468 6520 6f62 6a65 6374  es of the object
+000134e0: 2077 686f 7365 206e 616d 6520 6973 2060   whose name is `
+000134f0: 606e 616d 6560 6020 7769 6c6c 2062 6520  `name`` will be 
+00013500: 6465 6c65 7465 642e 0a20 2020 2020 2020  deleted..       
+00013510: 2022 2222 0a20 2020 2020 2020 2070 726f   """.        pro
+00013520: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+00013530: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00013540: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+00013550: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+00013560: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
+00013570: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
+00013580: 220a 0a20 2020 2020 2020 2069 6620 7461  "..        if ta
+00013590: 6720 6f72 2075 6964 3a0a 2020 2020 2020  g or uid:.      
+000135a0: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+000135b0: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+000135c0: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
+000135d0: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
+000135e0: 7061 7468 203d 2070 6174 6820 2b20 6622  path = path + f"
+000135f0: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
+00013600: 6572 656e 6365 7d22 0a0a 2020 2020 2020  erence}"..      
+00013610: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00013620: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
+00013630: 696e 6720 6665 6174 7572 652d 7365 7420  ing feature-set 
+00013640: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+00013650: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
+00013660: 454c 4554 4522 2c20 7061 7468 2c20 6572  ELETE", path, er
+00013670: 726f 725f 6d65 7373 6167 6529 0a0a 2020  ror_message)..  
+00013680: 2020 6465 6620 6372 6561 7465 5f66 6561    def create_fea
+00013690: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
+000136a0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000136b0: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
+000136c0: 723a 2055 6e69 6f6e 5b64 6963 742c 206d  r: Union[dict, m
+000136d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+000136e0: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
+000136f0: 722c 2046 6561 7475 7265 5665 6374 6f72  r, FeatureVector
+00013700: 5d2c 0a20 2020 2020 2020 2070 726f 6a65  ],.        proje
+00013710: 6374 3d22 222c 0a20 2020 2020 2020 2076  ct="",.        v
+00013720: 6572 7369 6f6e 6564 3d54 7275 652c 0a20  ersioned=True,. 
+00013730: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
+00013740: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
+00013750: 6120 6e65 7720 3a70 793a 636c 6173 733a  a new :py:class:
+00013760: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00013770: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+00013780: 746f 7260 2061 6e64 2073 6176 6520 696e  tor` and save in
+00013790: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
+000137a0: 7275 6e60 2044 422e 0a0a 2020 2020 2020  run` DB...      
+000137b0: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
+000137c0: 5f76 6563 746f 723a 2054 6865 206e 6577  _vector: The new
+000137d0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+000137e0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
+000137f0: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
+00013800: 746f 2063 7265 6174 652e 0a20 2020 2020  to create..     
+00013810: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00013820: 743a 204e 616d 6520 6f66 2070 726f 6a65  t: Name of proje
+00013830: 6374 2074 6869 7320 6665 6174 7572 652d  ct this feature-
+00013840: 7665 6374 6f72 2062 656c 6f6e 6773 2074  vector belongs t
+00013850: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+00013860: 6d20 7665 7273 696f 6e65 643a 2057 6865  m versioned: Whe
+00013870: 7468 6572 2074 6f20 6d61 696e 7461 696e  ther to maintain
+00013880: 2076 6572 7369 6f6e 7320 666f 7220 7468   versions for th
+00013890: 6973 2066 6561 7475 7265 2d76 6563 746f  is feature-vecto
+000138a0: 722e 2041 6c6c 2076 6572 7369 6f6e 7320  r. All versions 
+000138b0: 6f66 2061 2076 6572 7369 6f6e 6564 206f  of a versioned o
+000138c0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
+000138d0: 2020 7769 6c6c 2062 6520 6b65 7074 2069    will be kept i
+000138e0: 6e20 7468 6520 4442 2061 6e64 2063 616e  n the DB and can
+000138f0: 2062 6520 7265 7472 6965 7665 6420 756e   be retrieved un
+00013900: 7469 6c20 6578 706c 6963 6974 6c79 2064  til explicitly d
+00013910: 656c 6574 6564 2e0a 2020 2020 2020 2020  eleted..        
+00013920: 3a72 6574 7572 6e73 3a20 5468 6520 3a70  :returns: The :p
+00013930: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00013940: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00013950: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+00013960: 6563 7420 2861 7320 6469 6374 292e 0a20  ect (as dict).. 
+00013970: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013980: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00013990: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
+000139a0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000139b0: 6865 6d61 732e 4665 6174 7572 6556 6563  hemas.FeatureVec
+000139c0: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
+000139d0: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+000139e0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+000139f0: 722e 6469 6374 2829 0a20 2020 2020 2020  r.dict().       
+00013a00: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00013a10: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
+00013a20: 2046 6561 7475 7265 5665 6374 6f72 293a   FeatureVector):
+00013a30: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00013a40: 7475 7265 5f76 6563 746f 7220 3d20 6665  ture_vector = fe
+00013a50: 6174 7572 655f 7665 6374 6f72 2e74 6f5f  ature_vector.to_
+00013a60: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+00013a70: 7072 6f6a 6563 7420 3d20 280a 2020 2020  project = (.    
+00013a80: 2020 2020 2020 2020 7072 6f6a 6563 740a          project.
+00013a90: 2020 2020 2020 2020 2020 2020 6f72 2066              or f
+00013aa0: 6561 7475 7265 5f76 6563 746f 725b 226d  eature_vector["m
+00013ab0: 6574 6164 6174 6122 5d2e 6765 7428 2270  etadata"].get("p
+00013ac0: 726f 6a65 6374 222c 204e 6f6e 6529 0a20  roject", None). 
+00013ad0: 2020 2020 2020 2020 2020 206f 7220 636f             or co
+00013ae0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+00013af0: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
+00013b00: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00013b10: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00013b20: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
+00013b30: 7273 220a 2020 2020 2020 2020 7061 7261  rs".        para
+00013b40: 6d73 203d 207b 2276 6572 7369 6f6e 6564  ms = {"versioned
+00013b50: 223a 2076 6572 7369 6f6e 6564 7d0a 0a20  ": versioned}.. 
+00013b60: 2020 2020 2020 206e 616d 6520 3d20 6665         name = fe
+00013b70: 6174 7572 655f 7665 6374 6f72 5b22 6d65  ature_vector["me
+00013b80: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
+00013b90: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+00013ba0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+00013bb0: 6420 6372 6561 7469 6e67 2066 6561 7475  d creating featu
+00013bc0: 7265 2d76 6563 746f 7220 7b70 726f 6a65  re-vector {proje
+00013bd0: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00013be0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+00013bf0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+00013c00: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
+00013c10: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
+00013c20: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00013c30: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+00013c40: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
+00013c50: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+00013c60: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
+00013c70: 736f 6e28 6665 6174 7572 655f 7665 6374  son(feature_vect
+00013c80: 6f72 292c 0a20 2020 2020 2020 2029 0a20  or),.        ). 
+00013c90: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00013ca0: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
+00013cb0: 6566 2067 6574 5f66 6561 7475 7265 5f76  ef get_feature_v
+00013cc0: 6563 746f 7228 0a20 2020 2020 2020 2073  ector(.        s
+00013cd0: 656c 662c 206e 616d 653a 2073 7472 2c20  elf, name: str, 
+00013ce0: 7072 6f6a 6563 743a 2073 7472 203d 2022  project: str = "
+00013cf0: 222c 2074 6167 3a20 7374 7220 3d20 4e6f  ", tag: str = No
+00013d00: 6e65 2c20 7569 643a 2073 7472 203d 204e  ne, uid: str = N
+00013d10: 6f6e 650a 2020 2020 2920 2d3e 2046 6561  one.    ) -> Fea
+00013d20: 7475 7265 5665 6374 6f72 3a0a 2020 2020  tureVector:.    
+00013d30: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
+00013d40: 7370 6563 6966 6963 2066 6561 7475 7265  specific feature
+00013d50: 2d76 6563 746f 7220 7265 6665 7265 6e63  -vector referenc
+00013d60: 6564 2062 7920 6974 7320 7461 6720 6f72  ed by its tag or
+00013d70: 2075 6964 2e20 4966 206e 6f6e 6520 6172   uid. If none ar
+00013d80: 6520 7072 6f76 6964 6564 2c20 6060 6c61  e provided, ``la
+00013d90: 7465 7374 6060 2074 6167 2077 696c 6c0a  test`` tag will.
+00013da0: 2020 2020 2020 2020 6265 2075 7365 642e          be used.
+00013db0: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+00013dc0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+00013dd0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00013de0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+00013df0: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
+00013e00: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
+00013e10: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
+00013e20: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00013e30: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00013e40: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
+00013e50: 7273 2f7b 6e61 6d65 7d2f 7265 6665 7265  rs/{name}/refere
+00013e60: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
+00013e70: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+00013e80: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00013e90: 6564 2072 6574 7269 6576 696e 6720 6665  ed retrieving fe
+00013ea0: 6174 7572 652d 7665 6374 6f72 207b 7072  ature-vector {pr
+00013eb0: 6f6a 6563 747d 2f7b 6e61 6d65 7d22 0a20  oject}/{name}". 
+00013ec0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+00013ed0: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
+00013ee0: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
+00013ef0: 6573 7361 6765 290a 2020 2020 2020 2020  essage).        
+00013f00: 7265 7475 726e 2046 6561 7475 7265 5665  return FeatureVe
+00013f10: 6374 6f72 2e66 726f 6d5f 6469 6374 2872  ctor.from_dict(r
+00013f20: 6573 702e 6a73 6f6e 2829 290a 0a20 2020  esp.json())..   
+00013f30: 2064 6566 206c 6973 745f 6665 6174 7572   def list_featur
+00013f40: 655f 7665 6374 6f72 7328 0a20 2020 2020  e_vectors(.     
+00013f50: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00013f60: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
+00013f70: 2222 2c0a 2020 2020 2020 2020 6e61 6d65  "",.        name
+00013f80: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00013f90: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+00013fa0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+00013fb0: 7461 7465 3a20 7374 7220 3d20 4e6f 6e65  tate: str = None
+00013fc0: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
+00013fd0: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
+00013fe0: 6e65 2c0a 2020 2020 2020 2020 7061 7274  ne,.        part
+00013ff0: 6974 696f 6e5f 6279 3a20 556e 696f 6e5b  ition_by: Union[
+00014000: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+00014010: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00014020: 732e 4665 6174 7572 6553 746f 7265 5061  s.FeatureStorePa
+00014030: 7274 6974 696f 6e42 7946 6965 6c64 2c20  rtitionByField, 
+00014040: 7374 720a 2020 2020 2020 2020 5d20 3d20  str.        ] = 
+00014050: 4e6f 6e65 2c0a 2020 2020 2020 2020 726f  None,.        ro
+00014060: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
+00014070: 3a20 696e 7420 3d20 312c 0a20 2020 2020  : int = 1,.     
+00014080: 2020 2070 6172 7469 7469 6f6e 5f73 6f72     partition_sor
+00014090: 745f 6279 3a20 556e 696f 6e5b 6d6c 7275  t_by: Union[mlru
+000140a0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000140b0: 2e53 6f72 7446 6965 6c64 2c20 7374 725d  .SortField, str]
+000140c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+000140d0: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+000140e0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+000140f0: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
+00014100: 6e2e 7363 6865 6d61 732e 4f72 6465 7254  n.schemas.OrderT
+00014110: 7970 652c 2073 7472 0a20 2020 2020 2020  ype, str.       
+00014120: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
+00014130: 6e2e 7363 6865 6d61 732e 4f72 6465 7254  n.schemas.OrderT
+00014140: 7970 652e 6465 7363 2c0a 2020 2020 2920  ype.desc,.    ) 
+00014150: 2d3e 204c 6973 745b 4665 6174 7572 6556  -> List[FeatureV
+00014160: 6563 746f 725d 3a0a 2020 2020 2020 2020  ector]:.        
+00014170: 2222 2252 6574 7269 6576 6520 6120 6c69  """Retrieve a li
+00014180: 7374 206f 6620 6665 6174 7572 652d 7665  st of feature-ve
+00014190: 6374 6f72 7320 6d61 7463 6869 6e67 2074  ctors matching t
+000141a0: 6865 2063 7269 7465 7269 6120 7072 6f76  he criteria prov
+000141b0: 6964 6564 2e0a 0a20 2020 2020 2020 203a  ided...        :
+000141c0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+000141d0: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
+000141e0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+000141f0: 3a20 4e61 6d65 206f 6620 6665 6174 7572  : Name of featur
+00014200: 652d 7665 6374 6f72 2074 6f20 6d61 7463  e-vector to matc
+00014210: 682e 2054 6869 7320 6973 2061 206c 696b  h. This is a lik
+00014220: 6520 7175 6572 792c 2061 6e64 2069 7320  e query, and is 
+00014230: 6361 7365 2d69 6e73 656e 7369 7469 7665  case-insensitive
+00014240: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00014250: 2074 6167 3a20 4d61 7463 6820 6665 6174   tag: Match feat
+00014260: 7572 652d 7665 6374 6f72 7320 7769 7468  ure-vectors with
+00014270: 2073 7065 6369 6669 6320 7461 672e 0a20   specific tag.. 
+00014280: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
+00014290: 6174 653a 204d 6174 6368 2066 6561 7475  ate: Match featu
+000142a0: 7265 2d76 6563 746f 7273 2077 6974 6820  re-vectors with 
+000142b0: 6120 7370 6563 6966 6963 2073 7461 7465  a specific state
+000142c0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000142d0: 206c 6162 656c 733a 204d 6174 6368 2066   labels: Match f
+000142e0: 6561 7475 7265 2d76 6563 746f 7273 2077  eature-vectors w
+000142f0: 6869 6368 2068 6176 6520 7468 6573 6520  hich have these 
+00014300: 6c61 6265 6c73 2e0a 2020 2020 2020 2020  labels..        
+00014310: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
+00014320: 5f62 793a 2046 6965 6c64 2074 6f20 6772  _by: Field to gr
+00014330: 6f75 7020 7265 7375 6c74 7320 6279 2e20  oup results by. 
+00014340: 4f6e 6c79 2061 6c6c 6f77 6564 2076 616c  Only allowed val
+00014350: 7565 2069 7320 606e 616d 6560 2e20 5768  ue is `name`. Wh
+00014360: 656e 2060 7061 7274 6974 696f 6e5f 6279  en `partition_by
+00014370: 6020 6973 2073 7065 6369 6669 6564 2c0a  ` is specified,.
+00014380: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00014390: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
+000143a0: 6279 6020 7061 7261 6d65 7465 7220 6d75  by` parameter mu
+000143b0: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
+000143c0: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
+000143d0: 3a70 6172 616d 2072 6f77 735f 7065 725f  :param rows_per_
+000143e0: 7061 7274 6974 696f 6e3a 2048 6f77 206d  partition: How m
+000143f0: 616e 7920 746f 7020 726f 7773 2028 7065  any top rows (pe
+00014400: 7220 736f 7274 696e 6720 6465 6669 6e65  r sorting define
+00014410: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
+00014420: 736f 7274 5f62 7960 2061 6e64 2060 7061  sort_by` and `pa
+00014430: 7274 6974 696f 6e5f 6f72 6465 7260 290a  rtition_order`).
+00014440: 2020 2020 2020 2020 2020 2020 746f 2072              to r
+00014450: 6574 7572 6e20 7065 7220 6772 6f75 702e  eturn per group.
+00014460: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
+00014470: 7320 312e 0a20 2020 2020 2020 203a 7061  s 1..        :pa
+00014480: 7261 6d20 7061 7274 6974 696f 6e5f 736f  ram partition_so
+00014490: 7274 5f62 793a 2057 6861 7420 6669 656c  rt_by: What fiel
+000144a0: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
+000144b0: 7375 6c74 7320 6279 2c20 7769 7468 696e  sults by, within
+000144c0: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
+000144d0: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
+000144e0: 6974 696f 6e5f 6279 602e 0a20 2020 2020  ition_by`..     
+000144f0: 2020 2020 2020 2043 7572 7265 6e74 6c79         Currently
+00014500: 2074 6865 206f 6e6c 7920 616c 6c6f 7765   the only allowe
+00014510: 6420 7661 6c75 6573 2061 7265 2060 6372  d values are `cr
+00014520: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
+00014530: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
+00014540: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
+00014550: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
+00014560: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
+00014570: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
+00014580: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
+00014590: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
+000145a0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+000145b0: 204c 6973 7420 6f66 206d 6174 6368 696e   List of matchin
+000145c0: 6720 3a70 793a 636c 6173 733a 607e 6d6c  g :py:class:`~ml
+000145d0: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
+000145e0: 652e 4665 6174 7572 6556 6563 746f 7260  e.FeatureVector`
+000145f0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
+00014600: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00014610: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00014620: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00014630: 6c74 5f70 726f 6a65 6374 0a0a 2020 2020  lt_project..    
+00014640: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+00014650: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+00014660: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
+00014670: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
+00014680: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00014690: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
+000146a0: 2020 2020 2020 2020 2022 6c61 6265 6c22           "label"
+000146b0: 3a20 6c61 6265 6c73 206f 7220 5b5d 2c0a  : labels or [],.
+000146c0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000146d0: 2020 6966 2070 6172 7469 7469 6f6e 5f62    if partition_b
+000146e0: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
+000146f0: 6172 616d 732e 7570 6461 7465 280a 2020  arams.update(.  
+00014700: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00014710: 6c66 2e5f 6765 6e65 7261 7465 5f70 6172  lf._generate_par
+00014720: 7469 7469 6f6e 5f62 795f 7061 7261 6d73  tition_by_params
+00014730: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014740: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
+00014750: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
+00014760: 7265 5374 6f72 6550 6172 7469 7469 6f6e  reStorePartition
+00014770: 4279 4669 656c 642c 0a20 2020 2020 2020  ByField,.       
+00014780: 2020 2020 2020 2020 2020 2020 2070 6172               par
+00014790: 7469 7469 6f6e 5f62 792c 0a20 2020 2020  tition_by,.     
+000147a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000147b0: 6f77 735f 7065 725f 7061 7274 6974 696f  ows_per_partitio
+000147c0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+000147d0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+000147e0: 5f73 6f72 745f 6279 2c0a 2020 2020 2020  _sort_by,.      
+000147f0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00014800: 7274 6974 696f 6e5f 6f72 6465 722c 0a20  rtition_order,. 
+00014810: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00014820: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00014830: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00014840: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00014850: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
+00014860: 6f72 7322 0a0a 2020 2020 2020 2020 6572  ors"..        er
+00014870: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
+00014880: 2020 2020 2020 2020 2020 2020 6622 4661              f"Fa
+00014890: 696c 6564 206c 6973 7469 6e67 2066 6561  iled listing fea
+000148a0: 7475 7265 2d76 6563 746f 7273 2c20 7072  ture-vectors, pr
+000148b0: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
+000148c0: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
+000148d0: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
+000148e0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+000148f0: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
+00014900: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+00014910: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+00014920: 616d 7329 0a20 2020 2020 2020 2066 6561  ams).        fea
+00014930: 7475 7265 5f76 6563 746f 7273 203d 2072  ture_vectors = r
+00014940: 6573 702e 6a73 6f6e 2829 5b22 6665 6174  esp.json()["feat
+00014950: 7572 655f 7665 6374 6f72 7322 5d0a 2020  ure_vectors"].  
+00014960: 2020 2020 2020 6966 2066 6561 7475 7265        if feature
+00014970: 5f76 6563 746f 7273 3a0a 2020 2020 2020  _vectors:.      
+00014980: 2020 2020 2020 7265 7475 726e 205b 4665        return [Fe
+00014990: 6174 7572 6556 6563 746f 722e 6672 6f6d  atureVector.from
+000149a0: 5f64 6963 7428 6f62 6a29 2066 6f72 206f  _dict(obj) for o
+000149b0: 626a 2069 6e20 6665 6174 7572 655f 7665  bj in feature_ve
+000149c0: 6374 6f72 735d 0a0a 2020 2020 6465 6620  ctors]..    def 
+000149d0: 7374 6f72 655f 6665 6174 7572 655f 7665  store_feature_ve
+000149e0: 6374 6f72 280a 2020 2020 2020 2020 7365  ctor(.        se
+000149f0: 6c66 2c0a 2020 2020 2020 2020 6665 6174  lf,.        feat
+00014a00: 7572 655f 7665 6374 6f72 3a20 556e 696f  ure_vector: Unio
+00014a10: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+00014a20: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00014a30: 7475 7265 5665 6374 6f72 2c20 4665 6174  tureVector, Feat
+00014a40: 7572 6556 6563 746f 725d 2c0a 2020 2020  ureVector],.    
+00014a50: 2020 2020 6e61 6d65 3d4e 6f6e 652c 0a20      name=None,. 
+00014a60: 2020 2020 2020 2070 726f 6a65 6374 3d22         project="
+00014a70: 222c 0a20 2020 2020 2020 2074 6167 3d4e  ",.        tag=N
+00014a80: 6f6e 652c 0a20 2020 2020 2020 2075 6964  one,.        uid
+00014a90: 3d4e 6f6e 652c 0a20 2020 2020 2020 2076  =None,.        v
+00014aa0: 6572 7369 6f6e 6564 3d54 7275 652c 0a20  ersioned=True,. 
+00014ab0: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
+00014ac0: 2020 2020 2020 2222 2253 746f 7265 2061        """Store a
+00014ad0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+00014ae0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
+00014af0: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
+00014b00: 6f62 6a65 6374 2069 6e20 7468 6520 3a70  object in the :p
+00014b10: 793a 6d6f 643a 606d 6c72 756e 6020 4442  y:mod:`mlrun` DB
+00014b20: 2e20 5468 650a 2020 2020 2020 2020 6665  . The.        fe
+00014b30: 6174 7572 652d 7665 6374 6f72 2063 616e  ature-vector can
+00014b40: 2062 6520 6569 7468 6572 2061 206e 6577   be either a new
+00014b50: 206f 626a 6563 7420 6f72 2061 206d 6f64   object or a mod
+00014b60: 6966 6963 6174 696f 6e20 746f 2065 7869  ification to exi
+00014b70: 7374 696e 6720 6f62 6a65 6374 2072 6566  sting object ref
+00014b80: 6572 656e 6365 6420 6279 2074 6865 2070  erenced by the p
+00014b90: 6172 616d 730a 2020 2020 2020 2020 6f66  arams.        of
+00014ba0: 2074 6865 2066 756e 6374 696f 6e2e 0a0a   the function...
+00014bb0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+00014bc0: 6561 7475 7265 5f76 6563 746f 723a 2054  eature_vector: T
+00014bd0: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
+00014be0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00014bf0: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+00014c00: 6020 746f 2073 746f 7265 2e0a 2020 2020  ` to store..    
+00014c10: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+00014c20: 2020 2020 4e61 6d65 206f 6620 6665 6174      Name of feat
+00014c30: 7572 6520 7665 6374 6f72 2e0a 2020 2020  ure vector..    
+00014c40: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00014c50: 6374 3a20 4e61 6d65 206f 6620 7072 6f6a  ct: Name of proj
+00014c60: 6563 7420 7468 6973 2066 6561 7475 7265  ect this feature
+00014c70: 2d76 6563 746f 7220 6265 6c6f 6e67 7320  -vector belongs 
+00014c80: 746f 2e0a 2020 2020 2020 2020 3a70 6172  to..        :par
+00014c90: 616d 2074 6167 3a20 5468 6520 6060 7461  am tag: The ``ta
+00014ca0: 6760 6020 6f66 2074 6865 206f 626a 6563  g`` of the objec
+00014cb0: 7420 746f 2072 6570 6c61 6365 2069 6e20  t to replace in 
+00014cc0: 7468 6520 4442 2c20 666f 7220 6578 616d  the DB, for exam
+00014cd0: 706c 6520 6060 6c61 7465 7374 6060 2e0a  ple ``latest``..
+00014ce0: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+00014cf0: 6964 3a20 5468 6520 6060 7569 6460 6020  id: The ``uid`` 
+00014d00: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
+00014d10: 2072 6570 6c61 6365 2069 6e20 7468 6520   replace in the 
+00014d20: 4442 2e20 4966 2075 7369 6e67 2074 6869  DB. If using thi
+00014d30: 7320 7061 7261 6d65 7465 722c 2074 6865  s parameter, the
+00014d40: 206d 6f64 6966 6965 6420 6f62 6a65 6374   modified object
+00014d50: 0a20 2020 2020 2020 2020 2020 206d 7573  .            mus
+00014d60: 7420 6861 7665 2074 6865 2073 616d 6520  t have the same 
+00014d70: 6060 7569 6460 6020 6f66 2074 6865 2070  ``uid`` of the p
+00014d80: 7265 7669 6f75 736c 792d 6578 6973 7469  reviously-existi
+00014d90: 6e67 206f 626a 6563 742e 2054 6869 7320  ng object. This 
+00014da0: 6361 6e6e 6f74 2062 6520 7573 6564 2066  cannot be used f
+00014db0: 6f72 206e 6f6e 2d76 6572 7369 6f6e 6564  or non-versioned
+00014dc0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
+00014dd0: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
+00014de0: 6564 3a20 5768 6574 6865 7220 746f 206d  ed: Whether to m
+00014df0: 6169 6e74 6169 6e20 7665 7273 696f 6e73  aintain versions
+00014e00: 2066 6f72 2074 6869 7320 6665 6174 7572   for this featur
+00014e10: 652d 7665 6374 6f72 2e20 416c 6c20 7665  e-vector. All ve
+00014e20: 7273 696f 6e73 206f 6620 6120 7665 7273  rsions of a vers
+00014e30: 696f 6e65 6420 6f62 6a65 6374 0a20 2020  ioned object.   
+00014e40: 2020 2020 2020 2020 2077 696c 6c20 6265           will be
+00014e50: 206b 6570 7420 696e 2074 6865 2044 4220   kept in the DB 
+00014e60: 616e 6420 6361 6e20 6265 2072 6574 7269  and can be retri
+00014e70: 6576 6564 2075 6e74 696c 2065 7870 6c69  eved until expli
+00014e80: 6369 746c 7920 6465 6c65 7465 642e 0a20  citly deleted.. 
+00014e90: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+00014ea0: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
+00014eb0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00014ec0: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
+00014ed0: 6f72 6020 6f62 6a65 6374 2028 6173 2064  or` object (as d
+00014ee0: 6963 7429 2e0a 2020 2020 2020 2020 2222  ict)..        ""
+00014ef0: 220a 0a20 2020 2020 2020 2072 6566 6572  "..        refer
+00014f00: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
+00014f10: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
+00014f20: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
+00014f30: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
+00014f40: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
+00014f50: 647d 0a0a 2020 2020 2020 2020 6966 2069  d}..        if i
+00014f60: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
+00014f70: 655f 7665 6374 6f72 2c20 6d6c 7275 6e2e  e_vector, mlrun.
+00014f80: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
+00014f90: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
+00014fa0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00014fb0: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
+00014fc0: 7572 655f 7665 6374 6f72 2e64 6963 7428  ure_vector.dict(
+00014fd0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+00014fe0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
+00014ff0: 655f 7665 6374 6f72 2c20 4665 6174 7572  e_vector, Featur
+00015000: 6556 6563 746f 7229 3a0a 2020 2020 2020  eVector):.      
+00015010: 2020 2020 2020 6665 6174 7572 655f 7665        feature_ve
+00015020: 6374 6f72 203d 2066 6561 7475 7265 5f76  ctor = feature_v
+00015030: 6563 746f 722e 746f 5f64 6963 7428 290a  ector.to_dict().
+00015040: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+00015050: 6e61 6d65 206f 7220 6665 6174 7572 655f  name or feature_
+00015060: 7665 6374 6f72 5b22 6d65 7461 6461 7461  vector["metadata
+00015070: 225d 5b22 6e61 6d65 225d 0a20 2020 2020  "]["name"].     
+00015080: 2020 2070 726f 6a65 6374 203d 2028 0a20     project = (. 
+00015090: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+000150a0: 6374 0a20 2020 2020 2020 2020 2020 206f  ct.            o
+000150b0: 7220 6665 6174 7572 655f 7665 6374 6f72  r feature_vector
+000150c0: 5b22 6d65 7461 6461 7461 225d 2e67 6574  ["metadata"].get
+000150d0: 2822 7072 6f6a 6563 7422 290a 2020 2020  ("project").    
+000150e0: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
+000150f0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00015100: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
+00015110: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00015120: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00015130: 6665 6174 7572 652d 7665 6374 6f72 732f  feature-vectors/
+00015140: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
+00015150: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
+00015160: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00015170: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00015180: 7374 6f72 696e 6720 6665 6174 7572 652d  storing feature-
+00015190: 7665 6374 6f72 207b 7072 6f6a 6563 747d  vector {project}
+000151a0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+000151b0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+000151c0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+000151d0: 2020 2022 5055 5422 2c20 7061 7468 2c20     "PUT", path, 
+000151e0: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+000151f0: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
+00015200: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+00015210: 6665 6174 7572 655f 7665 6374 6f72 290a  feature_vector).
+00015220: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015230: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00015240: 6f6e 2829 0a0a 2020 2020 6465 6620 7061  on()..    def pa
+00015250: 7463 685f 6665 6174 7572 655f 7665 6374  tch_feature_vect
+00015260: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
+00015270: 2c0a 2020 2020 2020 2020 6e61 6d65 2c0a  ,.        name,.
+00015280: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00015290: 7665 6374 6f72 5f75 7064 6174 653a 2064  vector_update: d
+000152a0: 6963 742c 0a20 2020 2020 2020 2070 726f  ict,.        pro
+000152b0: 6a65 6374 3d22 222c 0a20 2020 2020 2020  ject="",.       
+000152c0: 2074 6167 3d4e 6f6e 652c 0a20 2020 2020   tag=None,.     
+000152d0: 2020 2075 6964 3d4e 6f6e 652c 0a20 2020     uid=None,.   
+000152e0: 2020 2020 2070 6174 6368 5f6d 6f64 653a       patch_mode:
+000152f0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+00015300: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
+00015310: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
+00015320: 7463 684d 6f64 650a 2020 2020 2020 2020  tchMode.        
+00015330: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
+00015340: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
+00015350: 6465 2e72 6570 6c61 6365 2c0a 2020 2020  de.replace,.    
+00015360: 293a 0a20 2020 2020 2020 2022 2222 4d6f  ):.        """Mo
+00015370: 6469 6679 2028 7061 7463 6829 2061 6e20  dify (patch) an 
+00015380: 6578 6973 7469 6e67 203a 7079 3a63 6c61  existing :py:cla
+00015390: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+000153a0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+000153b0: 5665 6374 6f72 6020 6f62 6a65 6374 2e0a  Vector` object..
+000153c0: 2020 2020 2020 2020 5468 6520 6f62 6a65          The obje
+000153d0: 6374 2069 7320 6964 656e 7469 6669 6564  ct is identified
+000153e0: 2062 7920 6974 7320 6e61 6d65 2028 616e   by its name (an
+000153f0: 6420 7072 6f6a 6563 7420 6974 2062 656c  d project it bel
+00015400: 6f6e 6773 2074 6f29 2c20 6173 2077 656c  ongs to), as wel
+00015410: 6c20 6173 206f 7074 696f 6e61 6c6c 7920  l as optionally 
+00015420: 6120 6060 7461 6760 6020 6f72 2069 7473  a ``tag`` or its
+00015430: 0a20 2020 2020 2020 2060 6075 6964 6060  .        ``uid``
+00015440: 2028 666f 7220 7665 7273 696f 6e65 6420   (for versioned 
+00015450: 6f62 6a65 6374 292e 2049 6620 626f 7468  object). If both
+00015460: 2060 6074 6167 6060 2061 6e64 2060 6075   ``tag`` and ``u
+00015470: 6964 6060 2061 7265 206f 6d69 7474 6564  id`` are omitted
+00015480: 2074 6865 6e20 7468 6520 6f62 6a65 6374   then the object
+00015490: 2077 6974 6820 7461 6720 6060 6c61 7465   with tag ``late
+000154a0: 7374 6060 0a20 2020 2020 2020 2069 7320  st``.        is 
+000154b0: 6d6f 6469 6669 6564 2e0a 0a20 2020 2020  modified...     
+000154c0: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+000154d0: 4e61 6d65 206f 6620 7468 6520 6f62 6a65  Name of the obje
+000154e0: 6374 2074 6f20 7061 7463 682e 0a20 2020  ct to patch..   
+000154f0: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
+00015500: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
+00015510: 653a 2054 6865 206d 6f64 6966 6963 6174  e: The modificat
+00015520: 696f 6e73 206e 6565 6465 6420 696e 2074  ions needed in t
+00015530: 6865 206f 626a 6563 742e 2054 6869 7320  he object. This 
+00015540: 7061 7261 6d65 7465 7220 6f6e 6c79 2068  parameter only h
+00015550: 6173 2074 6865 2063 6861 6e67 6573 2069  as the changes i
+00015560: 6e20 6974 2c0a 2020 2020 2020 2020 2020  n it,.          
+00015570: 2020 6e6f 7420 6120 6675 6c6c 206f 626a    not a full obj
+00015580: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+00015590: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+000155a0: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
+000155b0: 696e 7320 7468 6520 6d6f 6469 6669 6564  ins the modified
+000155c0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+000155d0: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
+000155e0: 2074 6167 206f 6620 7468 6520 6f62 6a65   tag of the obje
+000155f0: 6374 2074 6f20 6d6f 6469 6679 2e0a 2020  ct to modify..  
+00015600: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
+00015610: 3a20 7569 6420 6f66 2074 6865 206f 626a  : uid of the obj
+00015620: 6563 7420 746f 206d 6f64 6966 792e 0a20  ect to modify.. 
+00015630: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00015640: 7463 685f 6d6f 6465 3a20 5468 6520 7374  tch_mode: The st
+00015650: 7261 7465 6779 2066 6f72 206d 6572 6769  rategy for mergi
+00015660: 6e67 2074 6865 2063 6861 6e67 6573 2077  ng the changes w
+00015670: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
+00015680: 206f 626a 6563 742e 2043 616e 2062 6520   object. Can be 
+00015690: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
+000156a0: 6060 0a20 2020 2020 2020 2020 2020 206f  ``.            o
+000156b0: 7220 6060 6164 6469 7469 7665 6060 2e0a  r ``additive``..
+000156c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000156d0: 2020 2020 7265 6665 7265 6e63 6520 3d20      reference = 
+000156e0: 7365 6c66 2e5f 7265 736f 6c76 655f 7265  self._resolve_re
+000156f0: 6665 7265 6e63 6528 7461 672c 2075 6964  ference(tag, uid
+00015700: 290a 2020 2020 2020 2020 7072 6f6a 6563  ).        projec
+00015710: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00015720: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00015730: 6f6a 6563 740a 2020 2020 2020 2020 6865  oject.        he
+00015740: 6164 6572 7320 3d20 7b6d 6c72 756e 2e63  aders = {mlrun.c
+00015750: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
+00015760: 6164 6572 4e61 6d65 732e 7061 7463 685f  aderNames.patch_
+00015770: 6d6f 6465 3a20 7061 7463 685f 6d6f 6465  mode: patch_mode
+00015780: 7d0a 2020 2020 2020 2020 7061 7468 203d  }.        path =
+00015790: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+000157a0: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
+000157b0: 6374 6f72 732f 7b6e 616d 657d 2f72 6566  ctors/{name}/ref
+000157c0: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
+000157d0: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
+000157e0: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+000157f0: 6169 6c65 6420 7570 6461 7469 6e67 2066  ailed updating f
+00015800: 6561 7475 7265 2d76 6563 746f 7220 7b70  eature-vector {p
+00015810: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+00015820: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00015830: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00015840: 2020 2022 5041 5443 4822 2c0a 2020 2020     "PATCH",.    
+00015850: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+00015860: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00015870: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+00015880: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+00015890: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f76  o_json(feature_v
+000158a0: 6563 746f 725f 7570 6461 7465 292c 0a20  ector_update),. 
+000158b0: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+000158c0: 7273 3d68 6561 6465 7273 2c0a 2020 2020  rs=headers,.    
+000158d0: 2020 2020 290a 0a20 2020 2064 6566 2064      )..    def d
+000158e0: 656c 6574 655f 6665 6174 7572 655f 7665  elete_feature_ve
+000158f0: 6374 6f72 2873 656c 662c 206e 616d 652c  ctor(self, name,
+00015900: 2070 726f 6a65 6374 3d22 222c 2074 6167   project="", tag
+00015910: 3d4e 6f6e 652c 2075 6964 3d4e 6f6e 6529  =None, uid=None)
+00015920: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+00015930: 6574 6520 6120 3a70 793a 636c 6173 733a  ete a :py:class:
+00015940: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00015950: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+00015960: 746f 7260 206f 626a 6563 7420 6672 6f6d  tor` object from
+00015970: 2074 6865 2044 422e 0a20 2020 2020 2020   the DB..       
+00015980: 2049 6620 6060 7461 6760 6020 6f72 2060   If ``tag`` or `
+00015990: 6075 6964 6060 2061 7265 2073 7065 6369  `uid`` are speci
+000159a0: 6669 6564 2c20 7468 656e 206a 7573 7420  fied, then just 
+000159b0: 7468 6520 7665 7273 696f 6e20 7265 6665  the version refe
+000159c0: 7265 6e63 6564 2062 7920 7468 656d 2077  renced by them w
+000159d0: 696c 6c20 6265 2064 656c 6574 6564 2e20  ill be deleted. 
+000159e0: 5573 696e 6720 626f 7468 0a20 2020 2020  Using both.     
+000159f0: 2020 2069 7320 6e6f 7420 616c 6c6f 7765     is not allowe
+00015a00: 642e 0a20 2020 2020 2020 2049 6620 6e6f  d..        If no
+00015a10: 6e65 2061 7265 2073 7065 6369 6669 6564  ne are specified
+00015a20: 2c20 7468 656e 2061 6c6c 2069 6e73 7461  , then all insta
+00015a30: 6e63 6573 206f 6620 7468 6520 6f62 6a65  nces of the obje
+00015a40: 6374 2077 686f 7365 206e 616d 6520 6973  ct whose name is
+00015a50: 2060 606e 616d 6560 6020 7769 6c6c 2062   ``name`` will b
+00015a60: 6520 6465 6c65 7465 642e 0a20 2020 2020  e deleted..     
+00015a70: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
+00015a80: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00015a90: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00015aa0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00015ab0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00015ac0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00015ad0: 6561 7475 7265 2d76 6563 746f 7273 2f7b  eature-vectors/{
+00015ae0: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
+00015af0: 6620 7461 6720 6f72 2075 6964 3a0a 2020  f tag or uid:.  
+00015b00: 2020 2020 2020 2020 2020 7265 6665 7265            refere
+00015b10: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
+00015b20: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
+00015b30: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
+00015b40: 2020 2020 7061 7468 203d 2070 6174 6820      path = path 
+00015b50: 2b20 6622 2f72 6566 6572 656e 6365 732f  + f"/references/
+00015b60: 7b72 6566 6572 656e 6365 7d22 0a0a 2020  {reference}"..  
+00015b70: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00015b80: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
+00015b90: 656c 6574 696e 6720 6665 6174 7572 652d  eleting feature-
+00015ba0: 7665 6374 6f72 207b 6e61 6d65 7d22 0a20  vector {name}". 
+00015bb0: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+00015bc0: 6361 6c6c 2822 4445 4c45 5445 222c 2070  call("DELETE", p
+00015bd0: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00015be0: 6765 290a 0a20 2020 2064 6566 2074 6167  ge)..    def tag
+00015bf0: 5f6f 626a 6563 7473 280a 2020 2020 2020  _objects(.      
+00015c00: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00015c10: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+00015c20: 2020 2020 2020 7461 675f 6e61 6d65 3a20        tag_name: 
+00015c30: 7374 722c 0a20 2020 2020 2020 206f 626a  str,.        obj
+00015c40: 6563 7473 3a20 556e 696f 6e5b 6d6c 7275  ects: Union[mlru
+00015c50: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00015c60: 2e54 6167 4f62 6a65 6374 732c 2064 6963  .TagObjects, dic
+00015c70: 745d 2c0a 2020 2020 2020 2020 7265 706c  t],.        repl
+00015c80: 6163 653a 2062 6f6f 6c20 3d20 4661 6c73  ace: bool = Fals
+00015c90: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00015ca0: 2020 2222 2254 6167 2061 206c 6973 7420    """Tag a list 
+00015cb0: 6f66 206f 626a 6563 7473 2e0a 0a20 2020  of objects...   
+00015cc0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00015cd0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
+00015ce0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
+00015cf0: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+00015d00: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
+00015d10: 3a20 5468 6520 7461 6720 746f 2073 6574  : The tag to set
+00015d20: 206f 6e20 7468 6520 6f62 6a65 6374 732e   on the objects.
+00015d30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00015d40: 6f62 6a65 6374 733a 2054 6865 206f 626a  objects: The obj
+00015d50: 6563 7473 2074 6f20 7461 672e 0a20 2020  ects to tag..   
+00015d60: 2020 2020 203a 7061 7261 6d20 7265 706c       :param repl
+00015d70: 6163 653a 2057 6865 7468 6572 2074 6f20  ace: Whether to 
+00015d80: 7265 706c 6163 6520 7468 6520 6578 6973  replace the exis
+00015d90: 7469 6e67 2074 6167 7320 6f66 2074 6865  ting tags of the
+00015da0: 206f 626a 6563 7473 206f 7220 746f 2061   objects or to a
+00015db0: 6464 2074 6865 206e 6577 2074 6167 2074  dd the new tag t
+00015dc0: 6f20 7468 656d 2e0a 2020 2020 2020 2020  o them..        
+00015dd0: 2222 220a 0a20 2020 2020 2020 2070 6174  """..        pat
+00015de0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+00015df0: 7072 6f6a 6563 747d 2f74 6167 732f 7b74  project}/tags/{t
+00015e00: 6167 5f6e 616d 657d 220a 2020 2020 2020  ag_name}".      
+00015e10: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00015e20: 3d20 6622 4661 696c 6564 2074 6f20 7461  = f"Failed to ta
+00015e30: 6720 7b74 6167 5f6e 616d 657d 206f 6e20  g {tag_name} on 
+00015e40: 6f62 6a65 6374 7320 7b6f 626a 6563 7473  objects {objects
+00015e50: 7d22 0a20 2020 2020 2020 206d 6574 686f  }".        metho
+00015e60: 6420 3d20 2250 4f53 5422 2069 6620 7265  d = "POST" if re
+00015e70: 706c 6163 6520 656c 7365 2022 5055 5422  place else "PUT"
+00015e80: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+00015e90: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00015ea0: 2020 2020 6d65 7468 6f64 2c0a 2020 2020      method,.    
+00015eb0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+00015ec0: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00015ed0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+00015ee0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+00015ef0: 6f5f 6a73 6f6e 280a 2020 2020 2020 2020  o_json(.        
+00015f00: 2020 2020 2020 2020 6f62 6a65 6374 732e          objects.
+00015f10: 6469 6374 2829 0a20 2020 2020 2020 2020  dict().         
+00015f20: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00015f30: 616e 6365 286f 626a 6563 7473 2c20 6d6c  ance(objects, ml
+00015f40: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00015f50: 6173 2e54 6167 4f62 6a65 6374 7329 0a20  as.TagObjects). 
+00015f60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00015f70: 6c73 6520 6f62 6a65 6374 730a 2020 2020  lse objects.    
+00015f80: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00015f90: 2020 2029 0a0a 2020 2020 6465 6620 6465     )..    def de
+00015fa0: 6c65 7465 5f6f 626a 6563 7473 5f74 6167  lete_objects_tag
+00015fb0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00015fc0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00015fd0: 2073 7472 2c0a 2020 2020 2020 2020 7461   str,.        ta
+00015fe0: 675f 6e61 6d65 3a20 7374 722c 0a20 2020  g_name: str,.   
+00015ff0: 2020 2020 2074 6167 5f6f 626a 6563 7473       tag_objects
+00016000: 3a20 556e 696f 6e5b 6d6c 7275 6e2e 636f  : Union[mlrun.co
+00016010: 6d6d 6f6e 2e73 6368 656d 6173 2e54 6167  mmon.schemas.Tag
+00016020: 4f62 6a65 6374 732c 2064 6963 745d 2c0a  Objects, dict],.
+00016030: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00016040: 2222 4465 6c65 7465 2061 2074 6167 2066  ""Delete a tag f
+00016050: 726f 6d20 6120 6c69 7374 206f 6620 6f62  rom a list of ob
+00016060: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
+00016070: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00016080: 5072 6f6a 6563 7420 7768 6963 6820 636f  Project which co
+00016090: 6e74 6169 6e73 2074 6865 206f 626a 6563  ntains the objec
+000160a0: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
+000160b0: 616d 2074 6167 5f6e 616d 653a 2054 6865  am tag_name: The
+000160c0: 2074 6167 2074 6f20 6465 6c65 7465 2066   tag to delete f
+000160d0: 726f 6d20 7468 6520 6f62 6a65 6374 732e  rom the objects.
+000160e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000160f0: 7461 675f 6f62 6a65 6374 733a 2054 6865  tag_objects: The
+00016100: 206f 626a 6563 7473 2074 6f20 6465 6c65   objects to dele
+00016110: 7465 2074 6865 2074 6167 2066 726f 6d2e  te the tag from.
+00016120: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00016130: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+00016140: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00016150: 7d2f 7461 6773 2f7b 7461 675f 6e61 6d65  }/tags/{tag_name
+00016160: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+00016170: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00016180: 6c65 6420 6465 6c65 7469 6e67 2074 6167  led deleting tag
+00016190: 2066 726f 6d20 7b74 6167 5f6e 616d 657d   from {tag_name}
+000161a0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+000161b0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+000161c0: 2020 2020 2022 4445 4c45 5445 222c 0a20       "DELETE",. 
+000161d0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+000161e0: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+000161f0: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+00016200: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
+00016210: 745f 746f 5f6a 736f 6e28 0a20 2020 2020  t_to_json(.     
+00016220: 2020 2020 2020 2020 2020 2074 6167 5f6f             tag_o
+00016230: 626a 6563 7473 2e64 6963 7428 290a 2020  bjects.dict().  
+00016240: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016250: 2069 7369 6e73 7461 6e63 6528 7461 675f   isinstance(tag_
+00016260: 6f62 6a65 6374 732c 206d 6c72 756e 2e63  objects, mlrun.c
+00016270: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5461  ommon.schemas.Ta
+00016280: 674f 626a 6563 7473 290a 2020 2020 2020  gObjects).      
+00016290: 2020 2020 2020 2020 2020 656c 7365 2074            else t
+000162a0: 6167 5f6f 626a 6563 7473 0a20 2020 2020  ag_objects.     
+000162b0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+000162c0: 2020 290a 0a20 2020 2064 6566 2074 6167    )..    def tag
+000162d0: 5f61 7274 6966 6163 7473 280a 2020 2020  _artifacts(.    
+000162e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000162f0: 2020 6172 7469 6661 6374 733a 2055 6e69    artifacts: Uni
+00016300: 6f6e 5b4c 6973 745b 4172 7469 6661 6374  on[List[Artifact
+00016310: 5d2c 204c 6973 745b 6469 6374 5d2c 2041  ], List[dict], A
+00016320: 7274 6966 6163 742c 2064 6963 745d 2c0a  rtifact, dict],.
+00016330: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00016340: 2073 7472 2c0a 2020 2020 2020 2020 7461   str,.        ta
+00016350: 675f 6e61 6d65 3a20 7374 722c 0a20 2020  g_name: str,.   
+00016360: 2020 2020 2072 6570 6c61 6365 3a20 626f       replace: bo
+00016370: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00016380: 293a 0a20 2020 2020 2020 2022 2222 5461  ):.        """Ta
+00016390: 6720 6120 6c69 7374 206f 6620 6172 7469  g a list of arti
+000163a0: 6661 6374 732e 0a0a 2020 2020 2020 2020  facts...        
+000163b0: 3a70 6172 616d 2061 7274 6966 6163 7473  :param artifacts
+000163c0: 3a20 5468 6520 6172 7469 6661 6374 7320  : The artifacts 
+000163d0: 746f 2074 6167 2e20 4361 6e20 6265 2061  to tag. Can be a
+000163e0: 206c 6973 7420 6f66 203a 7079 3a63 6c61   list of :py:cla
+000163f0: 7373 3a60 7e6d 6c72 756e 2e61 7274 6966  ss:`~mlrun.artif
+00016400: 6163 7473 2e41 7274 6966 6163 7460 206f  acts.Artifact` o
+00016410: 626a 6563 7473 206f 720a 2020 2020 2020  bjects or.      
+00016420: 2020 2020 2020 6469 6374 696f 6e61 7269        dictionari
+00016430: 6573 2c20 6f72 2061 2073 696e 676c 6520  es, or a single 
+00016440: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
+00016450: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00016460: 5072 6f6a 6563 7420 7768 6963 6820 636f  Project which co
+00016470: 6e74 6169 6e73 2074 6865 2061 7274 6966  ntains the artif
+00016480: 6163 7473 2e0a 2020 2020 2020 2020 3a70  acts..        :p
+00016490: 6172 616d 2074 6167 5f6e 616d 653a 2054  aram tag_name: T
+000164a0: 6865 2074 6167 2074 6f20 7365 7420 6f6e  he tag to set on
+000164b0: 2074 6865 2061 7274 6966 6163 7473 2e0a   the artifacts..
+000164c0: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+000164d0: 6570 6c61 6365 3a20 4966 2054 7275 652c  eplace: If True,
+000164e0: 2072 6570 6c61 6365 2065 7869 7374 696e   replace existin
+000164f0: 6720 7461 6773 2c20 6f74 6865 7277 6973  g tags, otherwis
+00016500: 6520 6170 7065 6e64 2074 6f20 6578 6973  e append to exis
+00016510: 7469 6e67 2074 6167 732e 0a20 2020 2020  ting tags..     
+00016520: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
+00016530: 6167 5f6f 626a 6563 7473 203d 2073 656c  ag_objects = sel
+00016540: 662e 5f72 6573 6f6c 7665 5f61 7274 6966  f._resolve_artif
+00016550: 6163 7473 5f74 6f5f 7461 675f 6f62 6a65  acts_to_tag_obje
+00016560: 6374 7328 6172 7469 6661 6374 7329 0a20  cts(artifacts). 
+00016570: 2020 2020 2020 2073 656c 662e 7461 675f         self.tag_
+00016580: 6f62 6a65 6374 7328 7072 6f6a 6563 742c  objects(project,
+00016590: 2074 6167 5f6e 616d 652c 206f 626a 6563   tag_name, objec
+000165a0: 7473 3d74 6167 5f6f 626a 6563 7473 2c20  ts=tag_objects, 
+000165b0: 7265 706c 6163 653d 7265 706c 6163 6529  replace=replace)
+000165c0: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
+000165d0: 5f61 7274 6966 6163 7473 5f74 6167 7328  _artifacts_tags(
+000165e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000165f0: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
+00016600: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00016610: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00016620: 7461 675f 6e61 6d65 3a20 7374 722c 0a20  tag_name: str,. 
+00016630: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00016640: 2244 656c 6574 6520 7461 6720 6672 6f6d  "Delete tag from
+00016650: 2061 206c 6973 7420 6f66 2061 7274 6966   a list of artif
+00016660: 6163 7473 2e0a 0a20 2020 2020 2020 203a  acts...        :
+00016670: 7061 7261 6d20 6172 7469 6661 6374 733a  param artifacts:
+00016680: 2054 6865 2061 7274 6966 6163 7473 2074   The artifacts t
+00016690: 6f20 6465 6c65 7465 2074 6865 2074 6167  o delete the tag
+000166a0: 2066 726f 6d2e 2043 616e 2062 6520 6120   from. Can be a 
+000166b0: 6c69 7374 206f 6620 3a70 793a 636c 6173  list of :py:clas
+000166c0: 733a 607e 6d6c 7275 6e2e 6172 7469 6661  s:`~mlrun.artifa
+000166d0: 6374 732e 4172 7469 6661 6374 600a 2020  cts.Artifact`.  
+000166e0: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
+000166f0: 7320 6f72 2064 6963 7469 6f6e 6172 6965  s or dictionarie
+00016700: 732c 206f 7220 6120 7369 6e67 6c65 206f  s, or a single o
+00016710: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
+00016720: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+00016730: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
+00016740: 7461 696e 7320 7468 6520 6172 7469 6661  tains the artifa
+00016750: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
+00016760: 7261 6d20 7461 675f 6e61 6d65 3a20 5468  ram tag_name: Th
+00016770: 6520 7461 6720 746f 2073 6574 206f 6e20  e tag to set on 
+00016780: 7468 6520 6172 7469 6661 6374 732e 0a20  the artifacts.. 
+00016790: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000167a0: 2020 2074 6167 5f6f 626a 6563 7473 203d     tag_objects =
+000167b0: 2073 656c 662e 5f72 6573 6f6c 7665 5f61   self._resolve_a
+000167c0: 7274 6966 6163 7473 5f74 6f5f 7461 675f  rtifacts_to_tag_
+000167d0: 6f62 6a65 6374 7328 6172 7469 6661 6374  objects(artifact
+000167e0: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
+000167f0: 6465 6c65 7465 5f6f 626a 6563 7473 5f74  delete_objects_t
+00016800: 6167 2870 726f 6a65 6374 2c20 7461 675f  ag(project, tag_
+00016810: 6e61 6d65 2c20 7461 675f 6f62 6a65 6374  name, tag_object
+00016820: 7329 0a0a 2020 2020 6465 6620 6c69 7374  s)..    def list
+00016830: 5f70 726f 6a65 6374 7328 0a20 2020 2020  _projects(.     
+00016840: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00016850: 206f 776e 6572 3a20 7374 7220 3d20 4e6f   owner: str = No
+00016860: 6e65 2c0a 2020 2020 2020 2020 666f 726d  ne,.        form
+00016870: 6174 5f3a 2055 6e69 6f6e 5b0a 2020 2020  at_: Union[.    
+00016880: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
+00016890: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000168a0: 732e 5072 6f6a 6563 7473 466f 726d 6174  s.ProjectsFormat
+000168b0: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+000168c0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000168d0: 732e 5072 6f6a 6563 7473 466f 726d 6174  s.ProjectsFormat
+000168e0: 2e66 756c 6c2c 0a20 2020 2020 2020 206c  .full,.        l
+000168f0: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
+00016900: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00016910: 2073 7461 7465 3a20 556e 696f 6e5b 7374   state: Union[st
+00016920: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
+00016930: 7363 6865 6d61 732e 5072 6f6a 6563 7453  schemas.ProjectS
+00016940: 7461 7465 5d20 3d20 4e6f 6e65 2c0a 2020  tate] = None,.  
+00016950: 2020 2920 2d3e 204c 6973 745b 556e 696f    ) -> List[Unio
+00016960: 6e5b 6d6c 7275 6e2e 7072 6f6a 6563 7473  n[mlrun.projects
+00016970: 2e4d 6c72 756e 5072 6f6a 6563 742c 2073  .MlrunProject, s
+00016980: 7472 5d5d 3a0a 2020 2020 2020 2020 2222  tr]]:.        ""
+00016990: 2252 6574 7572 6e20 6120 6c69 7374 206f  "Return a list o
+000169a0: 6620 7468 6520 6578 6973 7469 6e67 2070  f the existing p
+000169b0: 726f 6a65 6374 732c 2070 6f74 656e 7469  rojects, potenti
+000169c0: 616c 6c79 2066 696c 7465 7265 6420 6279  ally filtered by
+000169d0: 2073 7065 6369 6669 6320 6372 6974 6572   specific criter
+000169e0: 6961 2e0a 0a20 2020 2020 2020 203a 7061  ia...        :pa
+000169f0: 7261 6d20 6f77 6e65 723a 204c 6973 7420  ram owner: List 
+00016a00: 6f6e 6c79 2070 726f 6a65 6374 7320 6265  only projects be
+00016a10: 6c6f 6e67 696e 6720 746f 2074 6869 7320  longing to this 
+00016a20: 7370 6563 6966 6963 206f 776e 6572 2e0a  specific owner..
+00016a30: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+00016a40: 6f72 6d61 745f 3a20 466f 726d 6174 206f  ormat_: Format o
+00016a50: 6620 7468 6520 7265 7375 6c74 732e 2050  f the results. P
+00016a60: 6f73 7369 626c 6520 7661 6c75 6573 2061  ossible values a
+00016a70: 7265 3a0a 0a20 2020 2020 2020 2020 2020  re:..           
+00016a80: 202d 2060 6066 756c 6c60 6020 2864 6566   - ``full`` (def
+00016a90: 6175 6c74 2076 616c 7565 2920 2d20 5265  ault value) - Re
+00016aa0: 7475 726e 2066 756c 6c20 7072 6f6a 6563  turn full projec
+00016ab0: 7420 6f62 6a65 6374 732e 0a20 2020 2020  t objects..     
+00016ac0: 2020 2020 2020 202d 2060 606d 696e 696d         - ``minim
+00016ad0: 616c 6060 202d 2052 6574 7572 6e20 6d69  al`` - Return mi
+00016ae0: 6e69 6d61 6c20 7072 6f6a 6563 7420 6f62  nimal project ob
+00016af0: 6a65 6374 7320 286d 696e 696d 697a 6174  jects (minimizat
+00016b00: 696f 6e20 6861 7070 656e 7320 696e 2074  ion happens in t
+00016b10: 6865 2042 4529 2e0a 2020 2020 2020 2020  he BE)..        
+00016b20: 2020 2020 2d20 6060 6e61 6d65 5f6f 6e6c      - ``name_onl
+00016b30: 7960 6020 2d20 5265 7475 726e 206a 7573  y`` - Return jus
+00016b40: 7420 7468 6520 6e61 6d65 7320 6f66 2074  t the names of t
+00016b50: 6865 2070 726f 6a65 6374 732e 0a0a 2020  he projects...  
+00016b60: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
+00016b70: 656c 733a 2046 696c 7465 7220 6279 206c  els: Filter by l
+00016b80: 6162 656c 7320 6174 7461 6368 6564 2074  abels attached t
+00016b90: 6f20 7468 6520 7072 6f6a 6563 742e 0a20  o the project.. 
+00016ba0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
+00016bb0: 6174 653a 2046 696c 7465 7220 6279 2070  ate: Filter by p
+00016bc0: 726f 6a65 6374 2773 2073 7461 7465 2e20  roject's state. 
+00016bd0: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
+00016be0: 6f6e 6c69 6e65 6060 206f 7220 6060 6172  online`` or ``ar
+00016bf0: 6368 6976 6564 6060 2e0a 2020 2020 2020  chived``..      
+00016c00: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00016c10: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00016c20: 2020 2020 2020 226f 776e 6572 223a 206f        "owner": o
+00016c30: 776e 6572 2c0a 2020 2020 2020 2020 2020  wner,.          
+00016c40: 2020 2273 7461 7465 223a 2073 7461 7465    "state": state
+00016c50: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
+00016c60: 6f72 6d61 7422 3a20 666f 726d 6174 5f2c  ormat": format_,
+00016c70: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+00016c80: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
+00016c90: 5b5d 2c0a 2020 2020 2020 2020 7d0a 0a20  [],.        }.. 
+00016ca0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00016cb0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00016cc0: 6c69 7374 696e 6720 7072 6f6a 6563 7473  listing projects
+00016cd0: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
+00016ce0: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
+00016cf0: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+00016d00: 616c 6c28 2247 4554 222c 2022 7072 6f6a  all("GET", "proj
+00016d10: 6563 7473 222c 2065 7272 6f72 5f6d 6573  ects", error_mes
+00016d20: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+00016d30: 616d 7329 0a20 2020 2020 2020 2069 6620  ams).        if 
+00016d40: 666f 726d 6174 5f20 3d3d 206d 6c72 756e  format_ == mlrun
+00016d50: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00016d60: 5072 6f6a 6563 7473 466f 726d 6174 2e6e  ProjectsFormat.n
+00016d70: 616d 655f 6f6e 6c79 3a0a 0a20 2020 2020  ame_only:..     
+00016d80: 2020 2020 2020 2023 2070 726f 6a65 6374         # project
+00016d90: 7320 6973 206a 7573 7420 6120 6c69 7374  s is just a list
+00016da0: 206f 6620 7374 7269 6e67 730a 2020 2020   of strings.    
+00016db0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00016dc0: 6573 706f 6e73 652e 6a73 6f6e 2829 5b22  esponse.json()["
+00016dd0: 7072 6f6a 6563 7473 225d 0a0a 2020 2020  projects"]..    
+00016de0: 2020 2020 2320 666f 7277 6172 6473 2063      # forwards c
+00016df0: 6f6d 7061 7469 6269 6c69 7479 202d 2077  ompatibility - w
+00016e00: 6520 7761 6e74 2074 6f20 6265 2061 626c  e want to be abl
+00016e10: 6520 746f 2068 616e 646c 6520 6e65 7720  e to handle new 
+00016e20: 666f 726d 6174 7320 7468 6174 206d 6967  formats that mig
+00016e30: 6874 2062 6520 6164 6465 6420 696e 2074  ht be added in t
+00016e40: 6865 2066 7574 7572 650a 2020 2020 2020  he future.      
+00016e50: 2020 2320 6966 2066 6f72 6d61 7420 6973    # if format is
+00016e60: 206e 6f74 206b 6e6f 776e 2074 6f20 7468   not known to th
+00016e70: 6520 6170 692c 2069 7420 6973 2075 7020  e api, it is up 
+00016e80: 746f 2074 6865 2073 6572 7665 7220 746f  to the server to
+00016e90: 2072 6574 7572 6e20 6569 7468 6572 2061   return either a
+00016ea0: 6e20 6572 726f 7220 6f72 2061 2064 6566  n error or a def
+00016eb0: 6175 6c74 2066 6f72 6d61 740a 2020 2020  ault format.    
+00016ec0: 2020 2020 7265 7475 726e 205b 0a20 2020      return [.   
+00016ed0: 2020 2020 2020 2020 206d 6c72 756e 2e70           mlrun.p
+00016ee0: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+00016ef0: 6a65 6374 2e66 726f 6d5f 6469 6374 2870  ject.from_dict(p
+00016f00: 726f 6a65 6374 5f64 6963 7429 0a20 2020  roject_dict).   
+00016f10: 2020 2020 2020 2020 2066 6f72 2070 726f           for pro
+00016f20: 6a65 6374 5f64 6963 7420 696e 2072 6573  ject_dict in res
+00016f30: 706f 6e73 652e 6a73 6f6e 2829 5b22 7072  ponse.json()["pr
+00016f40: 6f6a 6563 7473 225d 0a20 2020 2020 2020  ojects"].       
+00016f50: 205d 0a0a 2020 2020 6465 6620 6765 745f   ]..    def get_
+00016f60: 7072 6f6a 6563 7428 7365 6c66 2c20 6e61  project(self, na
+00016f70: 6d65 3a20 7374 7229 202d 3e20 6d6c 7275  me: str) -> mlru
+00016f80: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+00016f90: 5072 6f6a 6563 743a 0a20 2020 2020 2020  Project:.       
+00016fa0: 2022 2222 4765 7420 6465 7461 696c 7320   """Get details 
+00016fb0: 666f 7220 6120 7370 6563 6966 6963 2070  for a specific p
+00016fc0: 726f 6a65 6374 2e22 2222 0a0a 2020 2020  roject."""..    
+00016fd0: 2020 2020 6966 206e 6f74 206e 616d 653a      if not name:
+00016fe0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00016ff0: 7365 204d 4c52 756e 496e 7661 6c69 6441  se MLRunInvalidA
+00017000: 7267 756d 656e 7445 7272 6f72 2822 4e61  rgumentError("Na
+00017010: 6d65 206d 7573 7420 6265 2070 726f 7669  me must be provi
+00017020: 6465 6422 290a 0a20 2020 2020 2020 2070  ded")..        p
+00017030: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00017040: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+00017050: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00017060: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
+00017070: 7669 6e67 2070 726f 6a65 6374 207b 6e61  ving project {na
+00017080: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+00017090: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+000170a0: 5f63 616c 6c28 2247 4554 222c 2070 6174  _call("GET", pat
+000170b0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+000170c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000170d0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+000170e0: 4d6c 7275 6e50 726f 6a65 6374 2e66 726f  MlrunProject.fro
+000170f0: 6d5f 6469 6374 2872 6573 706f 6e73 652e  m_dict(response.
+00017100: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00017110: 2064 656c 6574 655f 7072 6f6a 6563 7428   delete_project(
+00017120: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017130: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+00017140: 2c0a 2020 2020 2020 2020 6465 6c65 7469  ,.        deleti
+00017150: 6f6e 5f73 7472 6174 6567 793a 2055 6e69  on_strategy: Uni
+00017160: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
+00017170: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
+00017180: 6e2e 7363 6865 6d61 732e 4465 6c65 7469  n.schemas.Deleti
+00017190: 6f6e 5374 7261 7465 6779 0a20 2020 2020  onStrategy.     
+000171a0: 2020 205d 203d 206d 6c72 756e 2e63 6f6d     ] = mlrun.com
+000171b0: 6d6f 6e2e 7363 6865 6d61 732e 4465 6c65  mon.schemas.Dele
+000171c0: 7469 6f6e 5374 7261 7465 6779 2e64 6566  tionStrategy.def
+000171d0: 6175 6c74 2829 2c0a 2020 2020 293a 0a20  ault(),.    ):. 
+000171e0: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
+000171f0: 2061 2070 726f 6a65 6374 2e0a 0a20 2020   a project...   
+00017200: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00017210: 3a20 4e61 6d65 206f 6620 7468 6520 7072  : Name of the pr
+00017220: 6f6a 6563 7420 746f 2064 656c 6574 652e  oject to delete.
+00017230: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00017240: 6465 6c65 7469 6f6e 5f73 7472 6174 6567  deletion_strateg
+00017250: 793a 2048 6f77 2074 6f20 7472 6561 7420  y: How to treat 
+00017260: 6368 696c 6420 6f62 6a65 6374 7320 6f66  child objects of
+00017270: 2074 6865 2070 726f 6a65 6374 2e20 506f   the project. Po
+00017280: 7373 6962 6c65 2076 616c 7565 7320 6172  ssible values ar
+00017290: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+000172a0: 2d20 6060 7265 7374 7269 6374 6060 2028  - ``restrict`` (
+000172b0: 6465 6661 756c 7429 202d 2050 726f 6a65  default) - Proje
+000172c0: 6374 206d 7573 7420 6e6f 7420 6861 7665  ct must not have
+000172d0: 2061 6e79 2063 6869 6c64 206f 626a 6563   any child objec
+000172e0: 7473 2077 6865 6e20 6465 6c65 7465 642e  ts when deleted.
+000172f0: 2049 6620 7573 696e 6720 7468 6973 206d   If using this m
+00017300: 6f64 6520 7768 696c 650a 2020 2020 2020  ode while.      
+00017310: 2020 2020 2020 2020 6368 696c 6420 6f62          child ob
+00017320: 6a65 6374 7320 6578 6973 742c 2074 6865  jects exist, the
+00017330: 206f 7065 7261 7469 6f6e 2077 696c 6c20   operation will 
+00017340: 6661 696c 2e0a 2020 2020 2020 2020 2020  fail..          
+00017350: 2020 2d20 6060 6361 7363 6164 6560 6020    - ``cascade`` 
+00017360: 2d20 4175 746f 6d61 7469 6361 6c6c 7920  - Automatically 
+00017370: 6465 6c65 7465 2061 6c6c 2063 6869 6c64  delete all child
+00017380: 206f 626a 6563 7473 2077 6865 6e20 6465   objects when de
+00017390: 6c65 7469 6e67 2074 6865 2070 726f 6a65  leting the proje
+000173a0: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
+000173b0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+000173c0: 6622 7072 6f6a 6563 7473 2f7b 6e61 6d65  f"projects/{name
+000173d0: 7d22 0a20 2020 2020 2020 2068 6561 6465  }".        heade
+000173e0: 7273 203d 207b 0a20 2020 2020 2020 2020  rs = {.         
+000173f0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00017400: 7363 6865 6d61 732e 4865 6164 6572 4e61  schemas.HeaderNa
+00017410: 6d65 732e 6465 6c65 7469 6f6e 5f73 7472  mes.deletion_str
+00017420: 6174 6567 793a 2064 656c 6574 696f 6e5f  ategy: deletion_
+00017430: 7374 7261 7465 6779 0a20 2020 2020 2020  strategy.       
+00017440: 207d 0a20 2020 2020 2020 2065 7272 6f72   }.        error
+00017450: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00017460: 6c65 6420 6465 6c65 7469 6e67 2070 726f  led deleting pro
+00017470: 6a65 6374 207b 6e61 6d65 7d22 0a20 2020  ject {name}".   
+00017480: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00017490: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
+000174a0: 454c 4554 4522 2c20 7061 7468 2c20 6572  ELETE", path, er
+000174b0: 726f 725f 6d65 7373 6167 652c 2068 6561  ror_message, hea
+000174c0: 6465 7273 3d68 6561 6465 7273 290a 2020  ders=headers).  
+000174d0: 2020 2020 2020 6966 2072 6573 706f 6e73        if respons
+000174e0: 652e 7374 6174 7573 5f63 6f64 6520 3d3d  e.status_code ==
+000174f0: 2068 7474 702e 4854 5450 5374 6174 7573   http.HTTPStatus
+00017500: 2e41 4343 4550 5445 443a 0a20 2020 2020  .ACCEPTED:.     
+00017510: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00017520: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
+00017530: 6a65 6374 5f74 6f5f 6265 5f64 656c 6574  ject_to_be_delet
+00017540: 6564 286e 616d 6529 0a0a 2020 2020 6465  ed(name)..    de
+00017550: 6620 7374 6f72 655f 7072 6f6a 6563 7428  f store_project(
+00017560: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017570: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+00017580: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00017590: 743a 2055 6e69 6f6e 5b64 6963 742c 206d  t: Union[dict, m
+000175a0: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
+000175b0: 7275 6e50 726f 6a65 6374 2c20 6d6c 7275  runProject, mlru
+000175c0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000175d0: 2e50 726f 6a65 6374 5d2c 0a20 2020 2029  .Project],.    )
+000175e0: 202d 3e20 6d6c 7275 6e2e 7072 6f6a 6563   -> mlrun.projec
+000175f0: 7473 2e4d 6c72 756e 5072 6f6a 6563 743a  ts.MlrunProject:
+00017600: 0a20 2020 2020 2020 2022 2222 5374 6f72  .        """Stor
+00017610: 6520 6120 7072 6f6a 6563 7420 696e 2074  e a project in t
+00017620: 6865 2044 422e 2054 6869 7320 6f70 6572  he DB. This oper
+00017630: 6174 696f 6e20 7769 6c6c 206f 7665 7277  ation will overw
+00017640: 7269 7465 2065 7869 7374 696e 6720 7072  rite existing pr
+00017650: 6f6a 6563 7420 6f66 2074 6865 2073 616d  oject of the sam
+00017660: 6520 6e61 6d65 2069 6620 6578 6973 7473  e name if exists
+00017670: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
+00017680: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00017690: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+000176a0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+000176b0: 6622 4661 696c 6564 2073 746f 7269 6e67  f"Failed storing
+000176c0: 2070 726f 6a65 6374 207b 6e61 6d65 7d22   project {name}"
+000176d0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+000176e0: 7374 616e 6365 2870 726f 6a65 6374 2c20  stance(project, 
+000176f0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00017700: 656d 6173 2e50 726f 6a65 6374 293a 0a20  emas.Project):. 
+00017710: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+00017720: 6374 203d 2070 726f 6a65 6374 2e64 6963  ct = project.dic
+00017730: 7428 290a 2020 2020 2020 2020 656c 6966  t().        elif
+00017740: 2069 7369 6e73 7461 6e63 6528 7072 6f6a   isinstance(proj
+00017750: 6563 742c 206d 6c72 756e 2e70 726f 6a65  ect, mlrun.proje
+00017760: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+00017770: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
+00017780: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00017790: 2e74 6f5f 6469 6374 2829 0a20 2020 2020  .to_dict().     
+000177a0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+000177b0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+000177c0: 2020 2020 2020 2020 2022 5055 5422 2c0a           "PUT",.
+000177d0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+000177e0: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+000177f0: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+00017800: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+00017810: 6374 5f74 6f5f 6a73 6f6e 2870 726f 6a65  ct_to_json(proje
+00017820: 6374 292c 0a20 2020 2020 2020 2029 0a20  ct),.        ). 
+00017830: 2020 2020 2020 2069 6620 7265 7370 6f6e         if respon
+00017840: 7365 2e73 7461 7475 735f 636f 6465 203d  se.status_code =
+00017850: 3d20 6874 7470 2e48 5454 5053 7461 7475  = http.HTTPStatu
+00017860: 732e 4143 4345 5054 4544 3a0a 2020 2020  s.ACCEPTED:.    
+00017870: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017880: 656c 662e 5f77 6169 745f 666f 725f 7072  elf._wait_for_pr
+00017890: 6f6a 6563 745f 746f 5f72 6561 6368 5f74  oject_to_reach_t
+000178a0: 6572 6d69 6e61 6c5f 7374 6174 6528 6e61  erminal_state(na
+000178b0: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
+000178c0: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
+000178d0: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
+000178e0: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
+000178f0: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+00017900: 6566 2070 6174 6368 5f70 726f 6a65 6374  ef patch_project
+00017910: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00017920: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00017930: 722c 0a20 2020 2020 2020 2070 726f 6a65  r,.        proje
+00017940: 6374 3a20 6469 6374 2c0a 2020 2020 2020  ct: dict,.      
+00017950: 2020 7061 7463 685f 6d6f 6465 3a20 556e    patch_mode: Un
+00017960: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+00017970: 2073 7472 2c20 6d6c 7275 6e2e 636f 6d6d   str, mlrun.comm
+00017980: 6f6e 2e73 6368 656d 6173 2e50 6174 6368  on.schemas.Patch
+00017990: 4d6f 6465 0a20 2020 2020 2020 205d 203d  Mode.        ] =
+000179a0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000179b0: 6865 6d61 732e 5061 7463 684d 6f64 652e  hemas.PatchMode.
+000179c0: 7265 706c 6163 652c 0a20 2020 2029 202d  replace,.    ) -
+000179d0: 3e20 6d6c 7275 6e2e 7072 6f6a 6563 7473  > mlrun.projects
+000179e0: 2e4d 6c72 756e 5072 6f6a 6563 743a 0a20  .MlrunProject:. 
+000179f0: 2020 2020 2020 2022 2222 5061 7463 6820         """Patch 
+00017a00: 616e 2065 7869 7374 696e 6720 7072 6f6a  an existing proj
+00017a10: 6563 7420 6f62 6a65 6374 2e0a 0a20 2020  ect object...   
+00017a20: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00017a30: 3a20 4e61 6d65 206f 6620 7072 6f6a 6563  : Name of projec
+00017a40: 7420 746f 2070 6174 6368 2e0a 2020 2020  t to patch..    
+00017a50: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00017a60: 6374 3a20 5468 6520 6163 7475 616c 2063  ct: The actual c
+00017a70: 6861 6e67 6573 2074 6f20 7468 6520 7072  hanges to the pr
+00017a80: 6f6a 6563 7420 6f62 6a65 6374 2e0a 2020  oject object..  
+00017a90: 2020 2020 2020 3a70 6172 616d 2070 6174        :param pat
+00017aa0: 6368 5f6d 6f64 653a 2054 6865 2073 7472  ch_mode: The str
+00017ab0: 6174 6567 7920 666f 7220 6d65 7267 696e  ategy for mergin
+00017ac0: 6720 7468 6520 6368 616e 6765 7320 7769  g the changes wi
+00017ad0: 7468 2074 6865 2065 7869 7374 696e 6720  th the existing 
+00017ae0: 6f62 6a65 6374 2e20 4361 6e20 6265 2065  object. Can be e
+00017af0: 6974 6865 7220 6060 7265 706c 6163 6560  ither ``replace`
+00017b00: 600a 2020 2020 2020 2020 2020 2020 6f72  `.            or
+00017b10: 2060 6061 6464 6974 6976 6560 602e 0a20   ``additive``.. 
+00017b20: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00017b30: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00017b40: 6a65 6374 732f 7b6e 616d 657d 220a 2020  jects/{name}".  
+00017b50: 2020 2020 2020 6865 6164 6572 7320 3d20        headers = 
+00017b60: 7b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  {mlrun.common.sc
+00017b70: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
+00017b80: 732e 7061 7463 685f 6d6f 6465 3a20 7061  s.patch_mode: pa
+00017b90: 7463 685f 6d6f 6465 7d0a 2020 2020 2020  tch_mode}.      
+00017ba0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00017bb0: 3d20 6622 4661 696c 6564 2070 6174 6368  = f"Failed patch
+00017bc0: 696e 6720 7072 6f6a 6563 7420 7b6e 616d  ing project {nam
+00017bd0: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+00017be0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00017bf0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00017c00: 2020 2250 4154 4348 222c 2070 6174 682c    "PATCH", path,
+00017c10: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+00017c20: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+00017c30: 6e28 7072 6f6a 6563 7429 2c20 6865 6164  n(project), head
+00017c40: 6572 733d 6865 6164 6572 730a 2020 2020  ers=headers.    
+00017c50: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00017c60: 7475 726e 206d 6c72 756e 2e70 726f 6a65  turn mlrun.proje
+00017c70: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+00017c80: 2e66 726f 6d5f 6469 6374 2872 6573 706f  .from_dict(respo
+00017c90: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
+00017ca0: 2064 6566 2063 7265 6174 655f 7072 6f6a   def create_proj
+00017cb0: 6563 7428 0a20 2020 2020 2020 2073 656c  ect(.        sel
+00017cc0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+00017cd0: 6374 3a20 556e 696f 6e5b 6469 6374 2c20  ct: Union[dict, 
+00017ce0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+00017cf0: 6c72 756e 5072 6f6a 6563 742c 206d 6c72  lrunProject, mlr
+00017d00: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00017d10: 732e 5072 6f6a 6563 745d 2c0a 2020 2020  s.Project],.    
+00017d20: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
+00017d30: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+00017d40: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+00017d50: 6174 6520 6120 6e65 7720 7072 6f6a 6563  ate a new projec
+00017d60: 742e 2041 2070 726f 6a65 6374 2077 6974  t. A project wit
+00017d70: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+00017d80: 6d75 7374 206e 6f74 2065 7869 7374 2070  must not exist p
+00017d90: 7269 6f72 2074 6f20 6372 6561 7469 6f6e  rior to creation
+00017da0: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
+00017db0: 2069 7369 6e73 7461 6e63 6528 7072 6f6a   isinstance(proj
+00017dc0: 6563 742c 206d 6c72 756e 2e63 6f6d 6d6f  ect, mlrun.commo
+00017dd0: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+00017de0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00017df0: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+00017e00: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
+00017e10: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00017e20: 2870 726f 6a65 6374 2c20 6d6c 7275 6e2e  (project, mlrun.
+00017e30: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+00017e40: 6f6a 6563 7429 3a0a 2020 2020 2020 2020  oject):.        
+00017e50: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00017e60: 6f6a 6563 742e 746f 5f64 6963 7428 290a  oject.to_dict().
+00017e70: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
+00017e80: 6e61 6d65 203d 2070 726f 6a65 6374 5b22  name = project["
+00017e90: 6d65 7461 6461 7461 225d 5b22 6e61 6d65  metadata"]["name
+00017ea0: 225d 0a20 2020 2020 2020 2065 7272 6f72  "].        error
+00017eb0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00017ec0: 6c65 6420 6372 6561 7469 6e67 2070 726f  led creating pro
+00017ed0: 6a65 6374 207b 7072 6f6a 6563 745f 6e61  ject {project_na
+00017ee0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+00017ef0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+00017f00: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00017f10: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
+00017f20: 2020 2020 2020 2022 7072 6f6a 6563 7473         "projects
+00017f30: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
+00017f40: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00017f50: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00017f60: 6963 745f 746f 5f6a 736f 6e28 7072 6f6a  ict_to_json(proj
+00017f70: 6563 7429 2c0a 2020 2020 2020 2020 290a  ect),.        ).
+00017f80: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
+00017f90: 6e73 652e 7374 6174 7573 5f63 6f64 6520  nse.status_code 
+00017fa0: 3d3d 2068 7474 702e 4854 5450 5374 6174  == http.HTTPStat
+00017fb0: 7573 2e41 4343 4550 5445 443a 0a20 2020  us.ACCEPTED:.   
+00017fc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017fd0: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
+00017fe0: 726f 6a65 6374 5f74 6f5f 7265 6163 685f  roject_to_reach_
+00017ff0: 7465 726d 696e 616c 5f73 7461 7465 2870  terminal_state(p
+00018000: 726f 6a65 6374 5f6e 616d 6529 0a20 2020  roject_name).   
+00018010: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+00018020: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+00018030: 5072 6f6a 6563 742e 6672 6f6d 5f64 6963  Project.from_dic
+00018040: 7428 7265 7370 6f6e 7365 2e6a 736f 6e28  t(response.json(
+00018050: 2929 0a0a 2020 2020 6465 6620 5f77 6169  ))..    def _wai
+00018060: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
+00018070: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
+00018080: 7374 6174 6528 0a20 2020 2020 2020 2073  state(.        s
+00018090: 656c 662c 2070 726f 6a65 6374 5f6e 616d  elf, project_nam
+000180a0: 653a 2073 7472 0a20 2020 2029 202d 3e20  e: str.    ) -> 
+000180b0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+000180c0: 6c72 756e 5072 6f6a 6563 743a 0a20 2020  lrunProject:.   
+000180d0: 2020 2020 2064 6566 205f 7665 7269 6679       def _verify
+000180e0: 5f70 726f 6a65 6374 5f69 6e5f 7465 726d  _project_in_term
+000180f0: 696e 616c 5f73 7461 7465 2829 3a0a 2020  inal_state():.  
+00018100: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+00018110: 7420 3d20 7365 6c66 2e67 6574 5f70 726f  t = self.get_pro
+00018120: 6a65 6374 2870 726f 6a65 6374 5f6e 616d  ject(project_nam
+00018130: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+00018140: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00018150: 2020 2020 7072 6f6a 6563 742e 7374 6174      project.stat
+00018160: 7573 2e73 7461 7465 0a20 2020 2020 2020  us.state.       
+00018170: 2020 2020 2020 2020 206e 6f74 2069 6e20           not in 
+00018180: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00018190: 656d 6173 2e50 726f 6a65 6374 5374 6174  emas.ProjectStat
+000181a0: 652e 7465 726d 696e 616c 5f73 7461 7465  e.terminal_state
+000181b0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+000181c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000181d0: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
+000181e0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+000181f0: 2020 2020 2020 2020 6622 5072 6f6a 6563          f"Projec
+00018200: 7420 6e6f 7420 696e 2074 6572 6d69 6e61  t not in termina
+00018210: 6c20 7374 6174 652e 2053 7461 7465 3a20  l state. State: 
+00018220: 7b70 726f 6a65 6374 2e73 7461 7475 732e  {project.status.
+00018230: 7374 6174 657d 220a 2020 2020 2020 2020  state}".        
+00018240: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018250: 2020 2020 2020 7265 7475 726e 2070 726f        return pro
+00018260: 6a65 6374 0a0a 2020 2020 2020 2020 7265  ject..        re
+00018270: 7475 726e 206d 6c72 756e 2e75 7469 6c73  turn mlrun.utils
+00018280: 2e68 656c 7065 7273 2e72 6574 7279 5f75  .helpers.retry_u
+00018290: 6e74 696c 5f73 7563 6365 7373 6675 6c28  ntil_successful(
+000182a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000182b0: 662e 5f77 6169 745f 666f 725f 7072 6f6a  f._wait_for_proj
+000182c0: 6563 745f 7465 726d 696e 616c 5f73 7461  ect_terminal_sta
+000182d0: 7465 5f72 6574 7279 5f69 6e74 6572 7661  te_retry_interva
+000182e0: 6c2c 0a20 2020 2020 2020 2020 2020 2031  l,.            1
+000182f0: 3230 2c0a 2020 2020 2020 2020 2020 2020  20,.            
+00018300: 6c6f 6767 6572 2c0a 2020 2020 2020 2020  logger,.        
+00018310: 2020 2020 4661 6c73 652c 0a20 2020 2020      False,.     
+00018320: 2020 2020 2020 205f 7665 7269 6679 5f70         _verify_p
+00018330: 726f 6a65 6374 5f69 6e5f 7465 726d 696e  roject_in_termin
+00018340: 616c 5f73 7461 7465 2c0a 2020 2020 2020  al_state,.      
+00018350: 2020 290a 0a20 2020 2064 6566 205f 7761    )..    def _wa
+00018360: 6974 5f66 6f72 5f62 6163 6b67 726f 756e  it_for_backgroun
+00018370: 645f 7461 736b 5f74 6f5f 7265 6163 685f  d_task_to_reach_
+00018380: 7465 726d 696e 616c 5f73 7461 7465 280a  terminal_state(.
+00018390: 2020 2020 2020 2020 7365 6c66 2c20 6e61          self, na
+000183a0: 6d65 3a20 7374 720a 2020 2020 2920 2d3e  me: str.    ) ->
+000183b0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000183c0: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
+000183d0: 5461 736b 3a0a 2020 2020 2020 2020 6465  Task:.        de
+000183e0: 6620 5f76 6572 6966 795f 6261 636b 6772  f _verify_backgr
+000183f0: 6f75 6e64 5f74 6173 6b5f 696e 5f74 6572  ound_task_in_ter
+00018400: 6d69 6e61 6c5f 7374 6174 6528 293a 0a20  minal_state():. 
+00018410: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
+00018420: 726f 756e 645f 7461 736b 203d 2073 656c  round_task = sel
+00018430: 662e 6765 745f 6261 636b 6772 6f75 6e64  f.get_background
+00018440: 5f74 6173 6b28 6e61 6d65 290a 2020 2020  _task(name).    
+00018450: 2020 2020 2020 2020 7374 6174 6520 3d20          state = 
+00018460: 6261 636b 6772 6f75 6e64 5f74 6173 6b2e  background_task.
+00018470: 7374 6174 7573 2e73 7461 7465 0a20 2020  status.state.   
+00018480: 2020 2020 2020 2020 2069 6620 7374 6174           if stat
+00018490: 6520 6e6f 7420 696e 206d 6c72 756e 2e63  e not in mlrun.c
+000184a0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4261  ommon.schemas.Ba
+000184b0: 636b 6772 6f75 6e64 5461 736b 5374 6174  ckgroundTaskStat
+000184c0: 652e 7465 726d 696e 616c 5f73 7461 7465  e.terminal_state
+000184d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000184e0: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
+000184f0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00018500: 2020 2020 2020 2020 2020 6622 4261 636b            f"Back
+00018510: 6772 6f75 6e64 2074 6173 6b20 6e6f 7420  ground task not 
+00018520: 696e 2074 6572 6d69 6e61 6c20 7374 6174  in terminal stat
+00018530: 652e 206e 616d 653d 7b6e 616d 657d 2c20  e. name={name}, 
+00018540: 7374 6174 653d 7b73 7461 7465 7d22 0a20  state={state}". 
+00018550: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00018560: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00018570: 7572 6e20 6261 636b 6772 6f75 6e64 5f74  urn background_t
+00018580: 6173 6b0a 0a20 2020 2020 2020 2072 6574  ask..        ret
+00018590: 7572 6e20 6d6c 7275 6e2e 7574 696c 732e  urn mlrun.utils.
+000185a0: 6865 6c70 6572 732e 7265 7472 795f 756e  helpers.retry_un
+000185b0: 7469 6c5f 7375 6363 6573 7366 756c 280a  til_successful(.
+000185c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000185d0: 2e5f 7761 6974 5f66 6f72 5f62 6163 6b67  ._wait_for_backg
+000185e0: 726f 756e 645f 7461 736b 5f74 6572 6d69  round_task_termi
+000185f0: 6e61 6c5f 7374 6174 655f 7265 7472 795f  nal_state_retry_
+00018600: 696e 7465 7276 616c 2c0a 2020 2020 2020  interval,.      
+00018610: 2020 2020 2020 3630 202a 2036 302c 0a20        60 * 60,. 
+00018620: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+00018630: 722c 0a20 2020 2020 2020 2020 2020 2046  r,.            F
+00018640: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00018650: 2020 5f76 6572 6966 795f 6261 636b 6772    _verify_backgr
+00018660: 6f75 6e64 5f74 6173 6b5f 696e 5f74 6572  ound_task_in_ter
+00018670: 6d69 6e61 6c5f 7374 6174 652c 0a20 2020  minal_state,.   
+00018680: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00018690: 5f77 6169 745f 666f 725f 7072 6f6a 6563  _wait_for_projec
+000186a0: 745f 746f 5f62 655f 6465 6c65 7465 6428  t_to_be_deleted(
+000186b0: 7365 6c66 2c20 7072 6f6a 6563 745f 6e61  self, project_na
+000186c0: 6d65 3a20 7374 7229 3a0a 2020 2020 2020  me: str):.      
+000186d0: 2020 6465 6620 5f76 6572 6966 795f 7072    def _verify_pr
+000186e0: 6f6a 6563 745f 6465 6c65 7465 6428 293a  oject_deleted():
+000186f0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00018700: 6a65 6374 7320 3d20 7365 6c66 2e6c 6973  jects = self.lis
+00018710: 745f 7072 6f6a 6563 7473 280a 2020 2020  t_projects(.    
+00018720: 2020 2020 2020 2020 2020 2020 666f 726d              form
+00018730: 6174 5f3d 6d6c 7275 6e2e 636f 6d6d 6f6e  at_=mlrun.common
+00018740: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
+00018750: 7346 6f72 6d61 742e 6e61 6d65 5f6f 6e6c  sFormat.name_onl
+00018760: 790a 2020 2020 2020 2020 2020 2020 290a  y.            ).
+00018770: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00018780: 726f 6a65 6374 5f6e 616d 6520 696e 2070  roject_name in p
+00018790: 726f 6a65 6374 733a 0a20 2020 2020 2020  rojects:.       
+000187a0: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+000187b0: 7863 6570 7469 6f6e 2866 2250 726f 6a65  xception(f"Proje
+000187c0: 6374 207b 7072 6f6a 6563 745f 6e61 6d65  ct {project_name
+000187d0: 7d20 7374 696c 6c20 6578 6973 7473 2229  } still exists")
+000187e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000187f0: 206d 6c72 756e 2e75 7469 6c73 2e68 656c   mlrun.utils.hel
+00018800: 7065 7273 2e72 6574 7279 5f75 6e74 696c  pers.retry_until
+00018810: 5f73 7563 6365 7373 6675 6c28 0a20 2020  _successful(.   
+00018820: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+00018830: 6169 745f 666f 725f 7072 6f6a 6563 745f  ait_for_project_
+00018840: 6465 6c65 7469 6f6e 5f69 6e74 6572 7661  deletion_interva
+00018850: 6c2c 0a20 2020 2020 2020 2020 2020 2031  l,.            1
+00018860: 3230 2c0a 2020 2020 2020 2020 2020 2020  20,.            
+00018870: 6c6f 6767 6572 2c0a 2020 2020 2020 2020  logger,.        
+00018880: 2020 2020 4661 6c73 652c 0a20 2020 2020      False,.     
+00018890: 2020 2020 2020 205f 7665 7269 6679 5f70         _verify_p
+000188a0: 726f 6a65 6374 5f64 656c 6574 6564 2c0a  roject_deleted,.
+000188b0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000188c0: 6566 2063 7265 6174 655f 7072 6f6a 6563  ef create_projec
+000188d0: 745f 7365 6372 6574 7328 0a20 2020 2020  t_secrets(.     
+000188e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000188f0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+00018900: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
+00018910: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+00018920: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
+00018930: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+00018940: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+00018950: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+00018960: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00018970: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+00018980: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
+00018990: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
+000189a0: 3a20 6469 6374 203d 204e 6f6e 652c 0a20  : dict = None,. 
+000189b0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000189c0: 2243 7265 6174 6520 7072 6f6a 6563 742d  "Create project-
+000189d0: 636f 6e74 6578 7420 7365 6372 6574 7320  context secrets 
+000189e0: 7573 696e 6720 6569 7468 6572 2060 6076  using either ``v
+000189f0: 6175 6c74 6060 206f 7220 6060 6b75 6265  ault`` or ``kube
+00018a00: 726e 6574 6573 6060 2070 726f 7669 6465  rnetes`` provide
+00018a10: 722e 0a20 2020 2020 2020 2057 6865 6e20  r..        When 
+00018a20: 7573 696e 6720 7769 7468 2056 6175 6c74  using with Vault
+00018a30: 2c20 7468 6973 2077 696c 6c20 6372 6561  , this will crea
+00018a40: 7465 206e 6565 6465 6420 5661 756c 7420  te needed Vault 
+00018a50: 7374 7275 6374 7572 6573 2066 6f72 2073  structures for s
+00018a60: 746f 7269 6e67 2073 6563 7265 7473 2069  toring secrets i
+00018a70: 6e20 7072 6f6a 6563 742d 636f 6e74 6578  n project-contex
+00018a80: 742c 2061 6e64 0a20 2020 2020 2020 2073  t, and.        s
+00018a90: 746f 7265 2061 2073 6574 206f 6620 7365  tore a set of se
+00018aa0: 6372 6574 2076 616c 7565 732e 2054 6865  cret values. The
+00018ab0: 206d 6574 686f 6420 6765 6e65 7261 7465   method generate
+00018ac0: 7320 4b75 6265 726e 6574 6573 2073 6572  s Kubernetes ser
+00018ad0: 7669 6365 2d61 6363 6f75 6e74 2061 6e64  vice-account and
+00018ae0: 2074 6865 2056 6175 6c74 2061 7574 6865   the Vault authe
+00018af0: 6e74 6963 6174 696f 6e0a 2020 2020 2020  ntication.      
+00018b00: 2020 7374 7275 6374 7572 6573 2074 6861    structures tha
+00018b10: 7420 6172 6520 7265 7175 6972 6564 2066  t are required f
+00018b20: 6f72 2066 756e 6374 696f 6e20 506f 6473  or function Pods
+00018b30: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
+00018b40: 2077 6974 6820 5661 756c 7420 616e 6420   with Vault and 
+00018b50: 6265 2061 626c 6520 746f 2065 7874 7261  be able to extra
+00018b60: 6374 2073 6563 7265 7420 7661 6c75 6573  ct secret values
+00018b70: 0a20 2020 2020 2020 2070 6173 7365 6420  .        passed 
+00018b80: 6173 2070 6172 7420 6f66 2074 6865 6972  as part of their
+00018b90: 2063 6f6e 7465 7874 2e0a 0a20 2020 2020   context...     
+00018ba0: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
+00018bb0: 2020 2020 2020 2020 2054 6869 7320 6d65           This me
+00018bc0: 7468 6f64 2075 7365 6420 7769 7468 2056  thod used with V
+00018bd0: 6175 6c74 2069 7320 6375 7272 656e 746c  ault is currentl
+00018be0: 7920 696e 2074 6563 686e 6963 616c 2070  y in technical p
+00018bf0: 7265 7669 6577 2c20 616e 6420 7265 7175  review, and requ
+00018c00: 6972 6573 2061 2048 6173 6869 436f 7270  ires a HashiCorp
+00018c10: 2056 6175 6c74 0a20 2020 2020 2020 2020   Vault.         
+00018c20: 2020 2020 2020 2069 6e66 7261 7374 7275         infrastru
+00018c30: 6374 7572 6520 7072 6f70 6572 6c79 2073  cture properly s
+00018c40: 6574 2075 7020 616e 6420 636f 6e6e 6563  et up and connec
+00018c50: 7465 6420 746f 2074 6865 204d 4c52 756e  ted to the MLRun
+00018c60: 2041 5049 2073 6572 7665 722e 0a0a 2020   API server...  
+00018c70: 2020 2020 2020 5768 656e 2075 7365 6420        When used 
+00018c80: 7769 7468 204b 7562 6572 6e65 7465 732c  with Kubernetes,
+00018c90: 2074 6869 7320 7769 6c6c 206d 616b 6520   this will make 
+00018ca0: 7375 7265 2074 6861 7420 7468 6520 7072  sure that the pr
+00018cb0: 6f6a 6563 742d 7370 6563 6966 6963 206b  oject-specific k
+00018cc0: 3873 2073 6563 7265 7420 6973 2063 7265  8s secret is cre
+00018cd0: 6174 6564 2c20 616e 6420 7769 6c6c 0a20  ated, and will. 
+00018ce0: 2020 2020 2020 2070 6f70 756c 6174 6520         populate 
+00018cf0: 6974 2077 6974 6820 7468 6520 7365 6372  it with the secr
+00018d00: 6574 7320 7072 6f76 6964 6564 2c20 7265  ets provided, re
+00018d10: 706c 6163 696e 6720 7468 6569 7220 7661  placing their va
+00018d20: 6c75 6573 2069 6620 7468 6579 2065 7869  lues if they exi
+00018d30: 7374 2e0a 0a20 2020 2020 2020 203a 7061  st...        :pa
+00018d40: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+00018d50: 2070 726f 6a65 6374 2063 6f6e 7465 7874   project context
+00018d60: 2066 6f72 2077 6869 6368 2074 6f20 6765   for which to ge
+00018d70: 6e65 7261 7465 2074 6865 2069 6e66 7261  nerate the infra
+00018d80: 2061 6e64 2073 746f 7265 2073 6563 7265   and store secre
+00018d90: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
+00018da0: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
+00018db0: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
+00018dc0: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
+00018dd0: 2077 6f72 6b20 7769 7468 2e20 4163 6365   work with. Acce
+00018de0: 7074 7320 610a 2020 2020 2020 2020 2020  pts a.          
+00018df0: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
+00018e00: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00018e10: 6173 2e73 6563 7265 742e 5365 6372 6574  as.secret.Secret
+00018e20: 5072 6f76 6964 6572 4e61 6d65 6020 656e  ProviderName` en
+00018e30: 756d 2e0a 2020 2020 2020 2020 3a70 6172  um..        :par
+00018e40: 616d 2073 6563 7265 7473 3a20 4120 7365  am secrets: A se
+00018e50: 7420 6f66 2073 6563 7265 7420 7661 6c75  t of secret valu
+00018e60: 6573 2074 6f20 7374 6f72 652e 0a20 2020  es to store..   
+00018e70: 2020 2020 2020 2020 2045 7861 6d70 6c65           Example
+00018e80: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+00018e90: 2020 2020 7365 6372 6574 7320 3d20 7b27      secrets = {'
+00018ea0: 7061 7373 776f 7264 273a 2027 6d79 5061  password': 'myPa
+00018eb0: 7373 7730 7264 272c 2027 6177 735f 6b65  ssw0rd', 'aws_ke
+00018ec0: 7927 3a20 2731 3131 3232 3233 3333 277d  y': '111222333'}
+00018ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018ee0: 2064 622e 6372 6561 7465 5f70 726f 6a65   db.create_proje
+00018ef0: 6374 5f73 6563 7265 7473 280a 2020 2020  ct_secrets(.    
+00018f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f10: 2270 726f 6a65 6374 3122 2c0a 2020 2020  "project1",.    
+00018f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f30: 7072 6f76 6964 6572 3d6d 6c72 756e 2e63  provider=mlrun.c
+00018f40: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+00018f50: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+00018f60: 2e6b 7562 6572 6e65 7465 732c 0a20 2020  .kubernetes,.   
+00018f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f80: 2073 6563 7265 7473 3d73 6563 7265 7473   secrets=secrets
+00018f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fa0: 2029 0a20 2020 2020 2020 2022 2222 0a20   ).        """. 
+00018fb0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00018fc0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00018fd0: 747d 2f73 6563 7265 7473 220a 2020 2020  t}/secrets".    
+00018fe0: 2020 2020 7365 6372 6574 735f 696e 7075      secrets_inpu
+00018ff0: 7420 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  t = mlrun.common
+00019000: 2e73 6368 656d 6173 2e53 6563 7265 7473  .schemas.Secrets
+00019010: 4461 7461 280a 2020 2020 2020 2020 2020  Data(.          
+00019020: 2020 7365 6372 6574 733d 7365 6372 6574    secrets=secret
+00019030: 732c 2070 726f 7669 6465 723d 7072 6f76  s, provider=prov
+00019040: 6964 6572 0a20 2020 2020 2020 2029 0a20  ider.        ). 
+00019050: 2020 2020 2020 2062 6f64 7920 3d20 7365         body = se
+00019060: 6372 6574 735f 696e 7075 742e 6469 6374  crets_input.dict
+00019070: 2829 0a20 2020 2020 2020 2065 7272 6f72  ().        error
+00019080: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00019090: 6c65 6420 6372 6561 7469 6e67 2073 6563  led creating sec
+000190a0: 7265 7420 7072 6f76 6964 6572 207b 7072  ret provider {pr
+000190b0: 6f6a 6563 747d 2f7b 7072 6f76 6964 6572  oject}/{provider
+000190c0: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
+000190d0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+000190e0: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
+000190f0: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
+00019100: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00019110: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+00019120: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
+00019130: 5f74 6f5f 6a73 6f6e 2862 6f64 7929 2c0a  _to_json(body),.
+00019140: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00019150: 6566 206c 6973 745f 7072 6f6a 6563 745f  ef list_project_
+00019160: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
+00019170: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00019180: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00019190: 2020 2020 2074 6f6b 656e 3a20 7374 7220       token: str 
+000191a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+000191b0: 7072 6f76 6964 6572 3a20 556e 696f 6e5b  provider: Union[
+000191c0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+000191d0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+000191e0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
+000191f0: 7669 6465 724e 616d 650a 2020 2020 2020  viderName.      
+00019200: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+00019210: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+00019220: 7450 726f 7669 6465 724e 616d 652e 6b75  tProviderName.ku
+00019230: 6265 726e 6574 6573 2c0a 2020 2020 2020  bernetes,.      
+00019240: 2020 7365 6372 6574 733a 204c 6973 745b    secrets: List[
+00019250: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00019260: 2029 202d 3e20 6d6c 7275 6e2e 636f 6d6d   ) -> mlrun.comm
+00019270: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+00019280: 7473 4461 7461 3a0a 2020 2020 2020 2020  tsData:.        
+00019290: 2222 2252 6574 7269 6576 6520 7072 6f6a  """Retrieve proj
+000192a0: 6563 742d 636f 6e74 6578 7420 7365 6372  ect-context secr
+000192b0: 6574 7320 6672 6f6d 2056 6175 6c74 2e0a  ets from Vault..
+000192c0: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
+000192d0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000192e0: 6869 7320 6d65 7468 6f64 2066 6f72 2056  his method for V
+000192f0: 6175 6c74 2066 756e 6374 696f 6e61 6c69  ault functionali
+00019300: 7479 2069 7320 6375 7272 656e 746c 7920  ty is currently 
+00019310: 696e 2074 6563 686e 6963 616c 2070 7265  in technical pre
+00019320: 7669 6577 2c20 616e 6420 7265 7175 6972  view, and requir
+00019330: 6573 2061 2048 6173 6869 436f 7270 2056  es a HashiCorp V
+00019340: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
+00019350: 2020 2020 2069 6e66 7261 7374 7275 6374       infrastruct
+00019360: 7572 6520 7072 6f70 6572 6c79 2073 6574  ure properly set
+00019370: 2075 7020 616e 6420 636f 6e6e 6563 7465   up and connecte
+00019380: 6420 746f 2074 6865 204d 4c52 756e 2041  d to the MLRun A
+00019390: 5049 2073 6572 7665 722e 0a0a 2020 2020  PI server...    
+000193a0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+000193b0: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
+000193c0: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
+000193d0: 6172 616d 2074 6f6b 656e 3a20 5661 756c  aram token: Vaul
+000193e0: 7420 746f 6b65 6e20 746f 2075 7365 2066  t token to use f
+000193f0: 6f72 2072 6574 7269 6576 696e 6720 7365  or retrieving se
+00019400: 6372 6574 732e 0a20 2020 2020 2020 2020  crets..         
+00019410: 2020 204d 7573 7420 6265 2061 2076 616c     Must be a val
+00019420: 6964 2056 6175 6c74 2074 6f6b 656e 2c20  id Vault token, 
+00019430: 7769 7468 2070 6572 6d69 7373 696f 6e73  with permissions
+00019440: 2074 6f20 7265 7472 6965 7665 2073 6563   to retrieve sec
+00019450: 7265 7473 206f 6620 7468 6520 7072 6f6a  rets of the proj
+00019460: 6563 7420 696e 2071 7565 7374 696f 6e2e  ect in question.
+00019470: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019480: 7072 6f76 6964 6572 3a20 5468 6520 6e61  provider: The na
+00019490: 6d65 206f 6620 7468 6520 7365 6372 6574  me of the secret
+000194a0: 732d 7072 6f76 6964 6572 2074 6f20 776f  s-provider to wo
+000194b0: 726b 2077 6974 682e 2043 7572 7265 6e74  rk with. Current
+000194c0: 6c79 206f 6e6c 7920 6060 7661 756c 7460  ly only ``vault`
+000194d0: 6020 6973 2061 6363 6570 7465 642e 0a20  ` is accepted.. 
+000194e0: 2020 2020 2020 203a 7061 7261 6d20 7365         :param se
+000194f0: 6372 6574 733a 2041 206c 6973 7420 6f66  crets: A list of
+00019500: 2073 6563 7265 7420 6e61 6d65 7320 746f   secret names to
+00019510: 2072 6574 7269 6576 652e 2041 6e20 656d   retrieve. An em
+00019520: 7074 7920 6c69 7374 2060 605b 5d60 6020  pty list ``[]`` 
+00019530: 7769 6c6c 2072 6574 7269 6576 6520 616c  will retrieve al
+00019540: 6c20 7365 6372 6574 7320 6173 7369 676e  l secrets assign
+00019550: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
+00019560: 6f20 7468 6973 2073 7065 6369 6669 6320  o this specific 
+00019570: 7072 6f6a 6563 742e 2060 606b 7562 6572  project. ``kuber
+00019580: 6e65 7465 7360 6020 7072 6f76 6964 6572  netes`` provider
+00019590: 206f 6e6c 7920 7375 7070 6f72 7473 2061   only supports a
+000195a0: 6e20 656d 7074 7920 6c69 7374 2e0a 2020  n empty list..  
+000195b0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+000195c0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+000195d0: 2020 2020 7072 6f76 6964 6572 203d 3d20      provider == 
+000195e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000195f0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+00019600: 6465 724e 616d 652e 7661 756c 742e 7661  derName.vault.va
+00019610: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+00019620: 616e 6420 6e6f 7420 746f 6b65 6e0a 2020  and not token.  
+00019630: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00019640: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
+00019650: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
+00019660: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00019670: 2020 2020 2020 2241 2076 6175 6c74 2074        "A vault t
+00019680: 6f6b 656e 206d 7573 7420 6265 2070 726f  oken must be pro
+00019690: 7669 6465 6420 7768 656e 2061 6363 6573  vided when acces
+000196a0: 7369 6e67 2076 6175 6c74 2073 6563 7265  sing vault secre
+000196b0: 7473 220a 2020 2020 2020 2020 2020 2020  ts".            
+000196c0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+000196d0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+000196e0: 6f6a 6563 747d 2f73 6563 7265 7473 220a  oject}/secrets".
+000196f0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00019700: 207b 2270 726f 7669 6465 7222 3a20 7072   {"provider": pr
+00019710: 6f76 6964 6572 2c20 2273 6563 7265 7422  ovider, "secret"
+00019720: 3a20 7365 6372 6574 737d 0a20 2020 2020  : secrets}.     
+00019730: 2020 2068 6561 6465 7273 203d 207b 6d6c     headers = {ml
+00019740: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00019750: 6173 2e48 6561 6465 724e 616d 6573 2e73  as.HeaderNames.s
+00019760: 6563 7265 745f 7374 6f72 655f 746f 6b65  ecret_store_toke
+00019770: 6e3a 2074 6f6b 656e 7d0a 2020 2020 2020  n: token}.      
+00019780: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00019790: 3d20 6622 4661 696c 6564 2072 6574 7269  = f"Failed retri
+000197a0: 6576 696e 6720 7365 6372 6574 7320 7b70  eving secrets {p
+000197b0: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
+000197c0: 727d 220a 2020 2020 2020 2020 7265 7375  r}".        resu
+000197d0: 6c74 203d 2073 656c 662e 6170 695f 6361  lt = self.api_ca
+000197e0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+000197f0: 2247 4554 222c 0a20 2020 2020 2020 2020  "GET",.         
+00019800: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
+00019810: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00019820: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+00019830: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
+00019840: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+00019850: 7273 3d68 6561 6465 7273 2c0a 2020 2020  rs=headers,.    
+00019860: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00019870: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+00019880: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+00019890: 7344 6174 6128 2a2a 7265 7375 6c74 2e6a  sData(**result.j
+000198a0: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+000198b0: 6c69 7374 5f70 726f 6a65 6374 5f73 6563  list_project_sec
+000198c0: 7265 745f 6b65 7973 280a 2020 2020 2020  ret_keys(.      
+000198d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000198e0: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+000198f0: 2020 2020 2020 7072 6f76 6964 6572 3a20        provider: 
+00019900: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+00019910: 2020 2073 7472 2c20 6d6c 7275 6e2e 636f     str, mlrun.co
+00019920: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
+00019930: 7265 7450 726f 7669 6465 724e 616d 650a  retProviderName.
+00019940: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
+00019950: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00019960: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+00019970: 616d 652e 6b75 6265 726e 6574 6573 2c0a  ame.kubernetes,.
+00019980: 2020 2020 2020 2020 746f 6b65 6e3a 2073          token: s
+00019990: 7472 203d 204e 6f6e 652c 0a20 2020 2029  tr = None,.    )
+000199a0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
+000199b0: 2e73 6368 656d 6173 2e53 6563 7265 744b  .schemas.SecretK
+000199c0: 6579 7344 6174 613a 0a20 2020 2020 2020  eysData:.       
+000199d0: 2022 2222 5265 7472 6965 7665 2070 726f   """Retrieve pro
+000199e0: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
+000199f0: 7265 7420 6b65 7973 2066 726f 6d20 5661  ret keys from Va
+00019a00: 756c 7420 6f72 204b 7562 6572 6e65 7465  ult or Kubernete
+00019a10: 732e 0a0a 2020 2020 2020 2020 4e6f 7465  s...        Note
+00019a20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019a30: 2020 5468 6973 206d 6574 686f 6420 666f    This method fo
+00019a40: 7220 5661 756c 7420 6675 6e63 7469 6f6e  r Vault function
+00019a50: 616c 6974 7920 6973 2063 7572 7265 6e74  ality is current
+00019a60: 6c79 2069 6e20 7465 6368 6e69 6361 6c20  ly in technical 
+00019a70: 7072 6576 6965 772c 2061 6e64 2072 6571  preview, and req
+00019a80: 7569 7265 7320 6120 4861 7368 6943 6f72  uires a HashiCor
+00019a90: 7020 5661 756c 740a 2020 2020 2020 2020  p Vault.        
+00019aa0: 2020 2020 2020 2020 696e 6672 6173 7472          infrastr
+00019ab0: 7563 7475 7265 2070 726f 7065 726c 7920  ucture properly 
+00019ac0: 7365 7420 7570 2061 6e64 2063 6f6e 6e65  set up and conne
+00019ad0: 6374 6564 2074 6f20 7468 6520 4d4c 5275  cted to the MLRu
+00019ae0: 6e20 4150 4920 7365 7276 6572 2e0a 0a20  n API server... 
+00019af0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00019b00: 6f6a 6563 743a 2054 6865 2070 726f 6a65  oject: The proje
+00019b10: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
+00019b20: 203a 7061 7261 6d20 7072 6f76 6964 6572   :param provider
+00019b30: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
+00019b40: 6520 7365 6372 6574 732d 7072 6f76 6964  e secrets-provid
+00019b50: 6572 2074 6f20 776f 726b 2077 6974 682e  er to work with.
+00019b60: 2041 6363 6570 7473 2061 0a20 2020 2020   Accepts a.     
+00019b70: 2020 2020 2020 203a 7079 3a63 6c61 7373         :py:class
+00019b80: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
+00019b90: 7363 6865 6d61 732e 7365 6372 6574 2e53  schemas.secret.S
+00019ba0: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+00019bb0: 6560 2065 6e75 6d2e 0a20 2020 2020 2020  e` enum..       
+00019bc0: 203a 7061 7261 6d20 746f 6b65 6e3a 2056   :param token: V
+00019bd0: 6175 6c74 2074 6f6b 656e 2074 6f20 7573  ault token to us
+00019be0: 6520 666f 7220 7265 7472 6965 7669 6e67  e for retrieving
+00019bf0: 2073 6563 7265 7473 2e20 4f6e 6c79 2069   secrets. Only i
+00019c00: 6e20 7573 6520 6966 2060 6070 726f 7669  n use if ``provi
+00019c10: 6465 7260 6020 6973 2060 6076 6175 6c74  der`` is ``vault
+00019c20: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+00019c30: 4d75 7374 2062 6520 6120 7661 6c69 6420  Must be a valid 
+00019c40: 5661 756c 7420 746f 6b65 6e2c 2077 6974  Vault token, wit
+00019c50: 6820 7065 726d 6973 7369 6f6e 7320 746f  h permissions to
+00019c60: 2072 6574 7269 6576 6520 7365 6372 6574   retrieve secret
+00019c70: 7320 6f66 2074 6865 2070 726f 6a65 6374  s of the project
+00019c80: 2069 6e20 7175 6573 7469 6f6e 2e0a 2020   in question..  
+00019c90: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00019ca0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00019cb0: 2020 2020 7072 6f76 6964 6572 203d 3d20      provider == 
+00019cc0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00019cd0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+00019ce0: 6465 724e 616d 652e 7661 756c 742e 7661  derName.vault.va
+00019cf0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+00019d00: 616e 6420 6e6f 7420 746f 6b65 6e0a 2020  and not token.  
+00019d10: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00019d20: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
+00019d30: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
+00019d40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00019d50: 2020 2020 2020 2241 2076 6175 6c74 2074        "A vault t
+00019d60: 6f6b 656e 206d 7573 7420 6265 2070 726f  oken must be pro
+00019d70: 7669 6465 6420 7768 656e 2061 6363 6573  vided when acces
+00019d80: 7369 6e67 2076 6175 6c74 2073 6563 7265  sing vault secre
+00019d90: 7473 220a 2020 2020 2020 2020 2020 2020  ts".            
+00019da0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+00019db0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00019dc0: 6f6a 6563 747d 2f73 6563 7265 742d 6b65  oject}/secret-ke
+00019dd0: 7973 220a 2020 2020 2020 2020 7061 7261  ys".        para
+00019de0: 6d73 203d 207b 2270 726f 7669 6465 7222  ms = {"provider"
+00019df0: 3a20 7072 6f76 6964 6572 7d0a 2020 2020  : provider}.    
+00019e00: 2020 2020 6865 6164 6572 7320 3d20 280a      headers = (.
+00019e10: 2020 2020 2020 2020 2020 2020 7b6d 6c72              {mlr
+00019e20: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00019e30: 732e 4865 6164 6572 4e61 6d65 732e 7365  s.HeaderNames.se
+00019e40: 6372 6574 5f73 746f 7265 5f74 6f6b 656e  cret_store_token
+00019e50: 3a20 746f 6b65 6e7d 0a20 2020 2020 2020  : token}.       
+00019e60: 2020 2020 2069 6620 7072 6f76 6964 6572       if provider
+00019e70: 203d 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e   == mlrun.common
+00019e80: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
+00019e90: 726f 7669 6465 724e 616d 652e 7661 756c  roviderName.vaul
+00019ea0: 742e 7661 6c75 650a 2020 2020 2020 2020  t.value.        
+00019eb0: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
+00019ec0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019ed0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00019ee0: 6622 4661 696c 6564 2072 6574 7269 6576  f"Failed retriev
+00019ef0: 696e 6720 7365 6372 6574 206b 6579 7320  ing secret keys 
+00019f00: 7b70 726f 6a65 6374 7d2f 7b70 726f 7669  {project}/{provi
+00019f10: 6465 727d 220a 2020 2020 2020 2020 7265  der}".        re
+00019f20: 7375 6c74 203d 2073 656c 662e 6170 695f  sult = self.api_
+00019f30: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00019f40: 2020 2247 4554 222c 0a20 2020 2020 2020    "GET",.       
+00019f50: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00019f60: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00019f70: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00019f80: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
+00019f90: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
+00019fa0: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
+00019fb0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019fc0: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
+00019fd0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+00019fe0: 6574 4b65 7973 4461 7461 282a 2a72 6573  etKeysData(**res
+00019ff0: 756c 742e 6a73 6f6e 2829 290a 0a20 2020  ult.json())..   
+0001a000: 2064 6566 2064 656c 6574 655f 7072 6f6a   def delete_proj
+0001a010: 6563 745f 7365 6372 6574 7328 0a20 2020  ect_secrets(.   
+0001a020: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001a030: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
+0001a040: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+0001a050: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
+0001a060: 2020 2020 2020 7374 722c 206d 6c72 756e        str, mlrun
+0001a070: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001a080: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+0001a090: 6d65 0a20 2020 2020 2020 205d 203d 206d  me.        ] = m
+0001a0a0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001a0b0: 6d61 732e 5365 6372 6574 5072 6f76 6964  mas.SecretProvid
+0001a0c0: 6572 4e61 6d65 2e6b 7562 6572 6e65 7465  erName.kubernete
+0001a0d0: 732c 0a20 2020 2020 2020 2073 6563 7265  s,.        secre
+0001a0e0: 7473 3a20 4c69 7374 5b73 7472 5d20 3d20  ts: List[str] = 
+0001a0f0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
+0001a100: 2020 2020 2022 2222 4465 6c65 7465 2070       """Delete p
+0001a110: 726f 6a65 6374 2d63 6f6e 7465 7874 2073  roject-context s
+0001a120: 6563 7265 7473 2066 726f 6d20 4b75 6265  ecrets from Kube
+0001a130: 726e 6574 6573 2e0a 0a20 2020 2020 2020  rnetes...       
+0001a140: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0001a150: 2054 6865 2070 726f 6a65 6374 206e 616d   The project nam
+0001a160: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0001a170: 6d20 7072 6f76 6964 6572 3a20 5468 6520  m provider: The 
+0001a180: 6e61 6d65 206f 6620 7468 6520 7365 6372  name of the secr
+0001a190: 6574 732d 7072 6f76 6964 6572 2074 6f20  ets-provider to 
+0001a1a0: 776f 726b 2077 6974 682e 2043 7572 7265  work with. Curre
+0001a1b0: 6e74 6c79 206f 6e6c 7920 6060 6b75 6265  ntly only ``kube
+0001a1c0: 726e 6574 6573 6060 2069 7320 7375 7070  rnetes`` is supp
+0001a1d0: 6f72 7465 642e 0a20 2020 2020 2020 203a  orted..        :
+0001a1e0: 7061 7261 6d20 7365 6372 6574 733a 2041  param secrets: A
+0001a1f0: 206c 6973 7420 6f66 2073 6563 7265 7420   list of secret 
+0001a200: 6e61 6d65 7320 746f 2064 656c 6574 652e  names to delete.
+0001a210: 2041 6e20 656d 7074 7920 6c69 7374 2077   An empty list w
+0001a220: 696c 6c20 6465 6c65 7465 2061 6c6c 2073  ill delete all s
+0001a230: 6563 7265 7473 2061 7373 6967 6e65 640a  ecrets assigned.
+0001a240: 2020 2020 2020 2020 2020 2020 746f 2074              to t
+0001a250: 6869 7320 7370 6563 6966 6963 2070 726f  his specific pro
+0001a260: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+0001a270: 220a 0a20 2020 2020 2020 2070 6174 6820  "..        path 
+0001a280: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+0001a290: 6f6a 6563 747d 2f73 6563 7265 7473 220a  oject}/secrets".
+0001a2a0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0001a2b0: 207b 2270 726f 7669 6465 7222 3a20 7072   {"provider": pr
+0001a2c0: 6f76 6964 6572 2c20 2273 6563 7265 7422  ovider, "secret"
+0001a2d0: 3a20 7365 6372 6574 737d 0a20 2020 2020  : secrets}.     
+0001a2e0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001a2f0: 203d 2066 2246 6169 6c65 6420 6465 6c65   = f"Failed dele
+0001a300: 7469 6e67 2073 6563 7265 7473 207b 7072  ting secrets {pr
+0001a310: 6f6a 6563 747d 2f7b 7072 6f76 6964 6572  oject}/{provider
+0001a320: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
+0001a330: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+0001a340: 2020 2020 2020 2244 454c 4554 4522 2c0a        "DELETE",.
+0001a350: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001a360: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+0001a370: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+0001a380: 2020 2020 2020 2020 2070 6172 616d 733d           params=
+0001a390: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+0001a3a0: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
+0001a3b0: 655f 7573 6572 5f73 6563 7265 7473 280a  e_user_secrets(.
+0001a3c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001a3d0: 2020 2020 2020 7573 6572 3a20 7374 722c        user: str,
+0001a3e0: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+0001a3f0: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
+0001a400: 2020 2020 2020 7374 722c 206d 6c72 756e        str, mlrun
+0001a410: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001a420: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+0001a430: 6d65 0a20 2020 2020 2020 205d 203d 206d  me.        ] = m
+0001a440: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001a450: 6d61 732e 5365 6372 6574 5072 6f76 6964  mas.SecretProvid
+0001a460: 6572 4e61 6d65 2e76 6175 6c74 2c0a 2020  erName.vault,.  
+0001a470: 2020 2020 2020 7365 6372 6574 733a 2064        secrets: d
+0001a480: 6963 7420 3d20 4e6f 6e65 2c0a 2020 2020  ict = None,.    
+0001a490: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
+0001a4a0: 6561 7465 2075 7365 722d 636f 6e74 6578  eate user-contex
+0001a4b0: 7420 7365 6372 6574 2069 6e20 5661 756c  t secret in Vaul
+0001a4c0: 742e 2050 6c65 6173 6520 7265 6665 7220  t. Please refer 
+0001a4d0: 746f 203a 7079 3a66 756e 633a 6063 7265  to :py:func:`cre
+0001a4e0: 6174 655f 7072 6f6a 6563 745f 7365 6372  ate_project_secr
+0001a4f0: 6574 7360 2066 6f72 206d 6f72 6520 6465  ets` for more de
+0001a500: 7461 696c 730a 2020 2020 2020 2020 616e  tails.        an
+0001a510: 6420 7374 6174 7573 206f 6620 7468 6973  d status of this
+0001a520: 2066 756e 6374 696f 6e61 6c69 7479 2e0a   functionality..
+0001a530: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
+0001a540: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0001a550: 6869 7320 6d65 7468 6f64 2069 7320 6375  his method is cu
+0001a560: 7272 656e 746c 7920 696e 2074 6563 686e  rrently in techn
+0001a570: 6963 616c 2070 7265 7669 6577 2c20 616e  ical preview, an
+0001a580: 6420 7265 7175 6972 6573 2061 2048 6173  d requires a Has
+0001a590: 6869 436f 7270 2056 6175 6c74 2069 6e66  hiCorp Vault inf
+0001a5a0: 7261 7374 7275 6374 7572 650a 2020 2020  rastructure.    
+0001a5b0: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
+0001a5c0: 6572 6c79 2073 6574 2075 7020 616e 6420  erly set up and 
+0001a5d0: 636f 6e6e 6563 7465 6420 746f 2074 6865  connected to the
+0001a5e0: 204d 4c52 756e 2041 5049 2073 6572 7665   MLRun API serve
+0001a5f0: 722e 0a0a 2020 2020 2020 2020 3a70 6172  r...        :par
+0001a600: 616d 2075 7365 723a 2054 6865 2075 7365  am user: The use
+0001a610: 7220 636f 6e74 6578 7420 666f 7220 7768  r context for wh
+0001a620: 6963 6820 746f 2067 656e 6572 6174 6520  ich to generate 
+0001a630: 7468 6520 696e 6672 6120 616e 6420 7374  the infra and st
+0001a640: 6f72 6520 7365 6372 6574 732e 0a20 2020  ore secrets..   
+0001a650: 2020 2020 203a 7061 7261 6d20 7072 6f76       :param prov
+0001a660: 6964 6572 3a20 5468 6520 6e61 6d65 206f  ider: The name o
+0001a670: 6620 7468 6520 7365 6372 6574 732d 7072  f the secrets-pr
+0001a680: 6f76 6964 6572 2074 6f20 776f 726b 2077  ovider to work w
+0001a690: 6974 682e 2043 7572 7265 6e74 6c79 206f  ith. Currently o
+0001a6a0: 6e6c 7920 6060 7661 756c 7460 6020 6973  nly ``vault`` is
+0001a6b0: 2073 7570 706f 7274 6564 2e0a 2020 2020   supported..    
+0001a6c0: 2020 2020 3a70 6172 616d 2073 6563 7265      :param secre
+0001a6d0: 7473 3a20 4120 7365 7420 6f66 2073 6563  ts: A set of sec
+0001a6e0: 7265 7420 7661 6c75 6573 2074 6f20 7374  ret values to st
+0001a6f0: 6f72 6520 7769 7468 696e 2074 6865 2056  ore within the V
+0001a700: 6175 6c74 2e0a 2020 2020 2020 2020 2222  ault..        ""
+0001a710: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
+0001a720: 2022 7573 6572 2d73 6563 7265 7473 220a   "user-secrets".
+0001a730: 2020 2020 2020 2020 7365 6372 6574 735f          secrets_
+0001a740: 6372 6561 7469 6f6e 5f72 6571 7565 7374  creation_request
+0001a750: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+0001a760: 7363 6865 6d61 732e 5573 6572 5365 6372  schemas.UserSecr
+0001a770: 6574 4372 6561 7469 6f6e 5265 7175 6573  etCreationReques
+0001a780: 7428 0a20 2020 2020 2020 2020 2020 2075  t(.            u
+0001a790: 7365 723d 7573 6572 2c0a 2020 2020 2020  ser=user,.      
+0001a7a0: 2020 2020 2020 7072 6f76 6964 6572 3d70        provider=p
+0001a7b0: 726f 7669 6465 722c 0a20 2020 2020 2020  rovider,.       
+0001a7c0: 2020 2020 2073 6563 7265 7473 3d73 6563       secrets=sec
+0001a7d0: 7265 7473 2c0a 2020 2020 2020 2020 290a  rets,.        ).
+0001a7e0: 2020 2020 2020 2020 626f 6479 203d 2073          body = s
+0001a7f0: 6563 7265 7473 5f63 7265 6174 696f 6e5f  ecrets_creation_
+0001a800: 7265 7175 6573 742e 6469 6374 2829 0a20  request.dict(). 
+0001a810: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0001a820: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0001a830: 6372 6561 7469 6e67 2075 7365 7220 7365  creating user se
+0001a840: 6372 6574 7320 2d20 7b75 7365 727d 220a  crets - {user}".
+0001a850: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+0001a860: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001a870: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
+0001a880: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
+0001a890: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+0001a8a0: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
+0001a8b0: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
+0001a8c0: 5f6a 736f 6e28 626f 6479 292c 0a20 2020  _json(body),.   
+0001a8d0: 2020 2020 2029 0a0a 2020 2020 4073 7461       )..    @sta
+0001a8e0: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+0001a8f0: 6620 5f76 616c 6964 6174 655f 7665 7273  f _validate_vers
+0001a900: 696f 6e5f 636f 6d70 6174 6962 696c 6974  ion_compatibilit
+0001a910: 7928 7365 7276 6572 5f76 6572 7369 6f6e  y(server_version
+0001a920: 2c20 636c 6965 6e74 5f76 6572 7369 6f6e  , client_version
+0001a930: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+0001a940: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0001a950: 2020 2020 7061 7273 6564 5f73 6572 7665      parsed_serve
+0001a960: 725f 7665 7273 696f 6e20 3d20 7365 6d76  r_version = semv
+0001a970: 6572 2e56 6572 7369 6f6e 496e 666f 2e70  er.VersionInfo.p
+0001a980: 6172 7365 2873 6572 7665 725f 7665 7273  arse(server_vers
+0001a990: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+0001a9a0: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
+0001a9b0: 6572 7369 6f6e 203d 2073 656d 7665 722e  ersion = semver.
+0001a9c0: 5665 7273 696f 6e49 6e66 6f2e 7061 7273  VersionInfo.pars
+0001a9d0: 6528 636c 6965 6e74 5f76 6572 7369 6f6e  e(client_version
+0001a9e0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0001a9f0: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
+0001aa00: 2020 2020 2020 2020 2023 2054 6869 7320           # This 
+0001aa10: 7769 6c6c 206d 6f73 746c 7920 6861 7070  will mostly happ
+0001aa20: 656e 2069 6e20 6465 7620 7363 656e 6172  en in dev scenar
+0001aa30: 696f 7320 7768 656e 2074 6865 2076 6572  ios when the ver
+0001aa40: 7369 6f6e 2069 7320 756e 7374 6162 6c65  sion is unstable
+0001aa50: 2061 6e64 2073 7563 6820 2d20 7468 6572   and such - ther
+0001aa60: 6566 6f72 6520 7765 2772 6520 6967 6e6f  efore we're igno
+0001aa70: 7269 6e67 0a20 2020 2020 2020 2020 2020  ring.           
+0001aa80: 206c 6f67 6765 722e 7761 726e 696e 6728   logger.warning(
+0001aa90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aaa0: 2022 556e 6162 6c65 2074 6f20 7061 7273   "Unable to pars
+0001aab0: 6520 7365 7276 6572 206f 7220 636c 6965  e server or clie
+0001aac0: 6e74 2076 6572 7369 6f6e 2e20 4173 7375  nt version. Assu
+0001aad0: 6d69 6e67 2063 6f6d 7061 7469 626c 6522  ming compatible"
+0001aae0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001aaf0: 2020 7365 7276 6572 5f76 6572 7369 6f6e    server_version
+0001ab00: 3d73 6572 7665 725f 7665 7273 696f 6e2c  =server_version,
+0001ab10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ab20: 2063 6c69 656e 745f 7665 7273 696f 6e3d   client_version=
+0001ab30: 636c 6965 6e74 5f76 6572 7369 6f6e 2c0a  client_version,.
+0001ab40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001ab50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001ab60: 2054 7275 650a 2020 2020 2020 2020 6966   True.        if
+0001ab70: 2028 7061 7273 6564 5f73 6572 7665 725f   (parsed_server_
+0001ab80: 7665 7273 696f 6e2e 6d61 6a6f 7220 3d3d  version.major ==
+0001ab90: 2030 2061 6e64 2070 6172 7365 645f 7365   0 and parsed_se
+0001aba0: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
+0001abb0: 6f72 203d 3d20 3029 206f 7220 280a 2020  or == 0) or (.  
+0001abc0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
+0001abd0: 5f63 6c69 656e 745f 7665 7273 696f 6e2e  _client_version.
+0001abe0: 6d61 6a6f 7220 3d3d 2030 2061 6e64 2070  major == 0 and p
+0001abf0: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
+0001ac00: 7369 6f6e 2e6d 696e 6f72 203d 3d20 300a  sion.minor == 0.
+0001ac10: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0001ac20: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
+0001ac30: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
+0001ac40: 2020 2020 2020 2022 5365 7276 6572 206f         "Server o
+0001ac50: 7220 636c 6965 6e74 2076 6572 7369 6f6e  r client version
+0001ac60: 2069 7320 756e 7374 6162 6c65 2e20 4173   is unstable. As
+0001ac70: 7375 6d69 6e67 2063 6f6d 7061 7469 626c  suming compatibl
+0001ac80: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0001ac90: 2020 2020 7365 7276 6572 5f76 6572 7369      server_versi
+0001aca0: 6f6e 3d73 6572 7665 725f 7665 7273 696f  on=server_versio
+0001acb0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+0001acc0: 2020 2063 6c69 656e 745f 7665 7273 696f     client_versio
+0001acd0: 6e3d 636c 6965 6e74 5f76 6572 7369 6f6e  n=client_version
+0001ace0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001acf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001ad00: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
+0001ad10: 6966 2070 6172 7365 645f 7365 7276 6572  if parsed_server
+0001ad20: 5f76 6572 7369 6f6e 2e6d 616a 6f72 2021  _version.major !
+0001ad30: 3d20 7061 7273 6564 5f63 6c69 656e 745f  = parsed_client_
+0001ad40: 7665 7273 696f 6e2e 6d61 6a6f 723a 0a20  version.major:. 
+0001ad50: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0001ad60: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
+0001ad70: 2020 2020 2020 2020 2020 2022 5365 7276             "Serv
+0001ad80: 6572 2061 6e64 2063 6c69 656e 7420 7665  er and client ve
+0001ad90: 7273 696f 6e73 2061 7265 2069 6e63 6f6d  rsions are incom
+0001ada0: 7061 7469 626c 6522 2c0a 2020 2020 2020  patible",.      
+0001adb0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
+0001adc0: 5f73 6572 7665 725f 7665 7273 696f 6e3d  _server_version=
+0001add0: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001ade0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+0001adf0: 2020 2020 2020 2070 6172 7365 645f 636c         parsed_cl
+0001ae00: 6965 6e74 5f76 6572 7369 6f6e 3d70 6172  ient_version=par
+0001ae10: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001ae20: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001ae30: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0001ae40: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+0001ae50: 2020 2069 6620 7061 7273 6564 5f73 6572     if parsed_ser
+0001ae60: 7665 725f 7665 7273 696f 6e2e 6d69 6e6f  ver_version.mino
+0001ae70: 7220 3e20 7061 7273 6564 5f63 6c69 656e  r > parsed_clien
+0001ae80: 745f 7665 7273 696f 6e2e 6d69 6e6f 7220  t_version.minor 
+0001ae90: 2b20 323a 0a20 2020 2020 2020 2020 2020  + 2:.           
+0001aea0: 206c 6f67 6765 722e 696e 666f 280a 2020   logger.info(.  
+0001aeb0: 2020 2020 2020 2020 2020 2020 2020 2242                "B
+0001aec0: 6163 6b77 6172 6473 2063 6f6d 7061 7469  ackwards compati
+0001aed0: 6269 6c69 7479 206d 6967 6874 206e 6f74  bility might not
+0001aee0: 2061 7070 6c79 2062 6574 7765 656e 2074   apply between t
+0001aef0: 6865 2073 6572 7665 7220 616e 6420 636c  he server and cl
+0001af00: 6965 6e74 2076 6572 7369 6f6e 222c 0a20  ient version",. 
+0001af10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001af20: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001af30: 7369 6f6e 3d70 6172 7365 645f 7365 7276  sion=parsed_serv
+0001af40: 6572 5f76 6572 7369 6f6e 2c0a 2020 2020  er_version,.    
+0001af50: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+0001af60: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001af70: 6e3d 7061 7273 6564 5f63 6c69 656e 745f  n=parsed_client_
+0001af80: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001af90: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001afa0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0001afb0: 2020 2020 2020 2020 6966 2070 6172 7365          if parse
+0001afc0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001afd0: 2e6d 696e 6f72 203e 2070 6172 7365 645f  .minor > parsed_
+0001afe0: 7365 7276 6572 5f76 6572 7369 6f6e 2e6d  server_version.m
+0001aff0: 696e 6f72 3a0a 2020 2020 2020 2020 2020  inor:.          
+0001b000: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+0001b010: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001b020: 2020 2243 6c69 656e 7420 7665 7273 696f    "Client versio
+0001b030: 6e20 7769 7468 2068 6967 6865 7220 7665  n with higher ve
+0001b040: 7273 696f 6e20 7468 616e 2073 6572 7665  rsion than serve
+0001b050: 7220 7665 7273 696f 6e20 6973 6e27 7420  r version isn't 
+0001b060: 7375 7070 6f72 7465 642c 220a 2020 2020  supported,".    
+0001b070: 2020 2020 2020 2020 2020 2020 2220 616c              " al
+0001b080: 6967 6e20 796f 7572 2063 6c69 656e 7420  ign your client 
+0001b090: 746f 2074 6865 2073 6572 7665 7220 7665  to the server ve
+0001b0a0: 7273 696f 6e22 2c0a 2020 2020 2020 2020  rsion",.        
+0001b0b0: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
+0001b0c0: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
+0001b0d0: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001b0e0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001b0f0: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
+0001b100: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
+0001b110: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001b120: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001b130: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b140: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
+0001b150: 2069 6620 7061 7273 6564 5f73 6572 7665   if parsed_serve
+0001b160: 725f 7665 7273 696f 6e2e 6d69 6e6f 7220  r_version.minor 
+0001b170: 213d 2070 6172 7365 645f 636c 6965 6e74  != parsed_client
+0001b180: 5f76 6572 7369 6f6e 2e6d 696e 6f72 3a0a  _version.minor:.
+0001b190: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001b1a0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
+0001b1b0: 2020 2020 2020 2020 2022 5365 7276 6572           "Server
+0001b1c0: 2061 6e64 2063 6c69 656e 7420 7665 7273   and client vers
+0001b1d0: 696f 6e73 2061 7265 206e 6f74 2074 6865  ions are not the
+0001b1e0: 2073 616d 6520 6275 7420 636f 6d70 6174   same but compat
+0001b1f0: 6962 6c65 222c 0a20 2020 2020 2020 2020  ible",.         
+0001b200: 2020 2020 2020 2070 6172 7365 645f 7365         parsed_se
+0001b210: 7276 6572 5f76 6572 7369 6f6e 3d70 6172  rver_version=par
+0001b220: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
+0001b230: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001b240: 2020 2020 7061 7273 6564 5f63 6c69 656e      parsed_clien
+0001b250: 745f 7665 7273 696f 6e3d 7061 7273 6564  t_version=parsed
+0001b260: 5f63 6c69 656e 745f 7665 7273 696f 6e2c  _client_version,
+0001b270: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001b280: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+0001b290: 7565 0a0a 2020 2020 6465 6620 6372 6561  ue..    def crea
+0001b2a0: 7465 5f6d 6f64 656c 5f65 6e64 706f 696e  te_model_endpoin
+0001b2b0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+0001b2c0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0001b2d0: 3a20 7374 722c 0a20 2020 2020 2020 2065  : str,.        e
+0001b2e0: 6e64 706f 696e 745f 6964 3a20 7374 722c  ndpoint_id: str,
+0001b2f0: 0a20 2020 2020 2020 206d 6f64 656c 5f65  .        model_e
+0001b300: 6e64 706f 696e 743a 2055 6e69 6f6e 5b0a  ndpoint: Union[.
+0001b310: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+0001b320: 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f 7269  n.model_monitori
+0001b330: 6e67 2e6d 6f64 656c 5f65 6e64 706f 696e  ng.model_endpoin
+0001b340: 742e 4d6f 6465 6c45 6e64 706f 696e 742c  t.ModelEndpoint,
+0001b350: 2064 6963 740a 2020 2020 2020 2020 5d2c   dict.        ],
+0001b360: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0001b370: 2222 220a 2020 2020 2020 2020 4372 6561  """.        Crea
+0001b380: 7465 7320 6120 4442 2072 6563 6f72 6420  tes a DB record 
+0001b390: 7769 7468 2074 6865 2067 6976 656e 206d  with the given m
+0001b3a0: 6f64 656c 5f65 6e64 706f 696e 7420 7265  odel_endpoint re
+0001b3b0: 636f 7264 2e0a 0a20 2020 2020 2020 203a  cord...        :
+0001b3c0: 7061 7261 6d20 7072 6f6a 6563 743a 2054  param project: T
+0001b3d0: 6865 206e 616d 6520 6f66 2074 6865 2070  he name of the p
+0001b3e0: 726f 6a65 6374 2e0a 2020 2020 2020 2020  roject..        
+0001b3f0: 3a70 6172 616d 2065 6e64 706f 696e 745f  :param endpoint_
+0001b400: 6964 3a20 5468 6520 6964 206f 6620 7468  id: The id of th
+0001b410: 6520 656e 6470 6f69 6e74 2e0a 2020 2020  e endpoint..    
+0001b420: 2020 2020 3a70 6172 616d 206d 6f64 656c      :param model
+0001b430: 5f65 6e64 706f 696e 743a 2041 6e20 6f62  _endpoint: An ob
+0001b440: 6a65 6374 2072 6570 7265 7365 6e74 696e  ject representin
+0001b450: 6720 7468 6520 6d6f 6465 6c20 656e 6470  g the model endp
+0001b460: 6f69 6e74 2e0a 2020 2020 2020 2020 2222  oint..        ""
+0001b470: 220a 0a20 2020 2020 2020 2069 6620 6973  "..        if is
+0001b480: 696e 7374 616e 6365 280a 2020 2020 2020  instance(.      
+0001b490: 2020 2020 2020 6d6f 6465 6c5f 656e 6470        model_endp
+0001b4a0: 6f69 6e74 2c20 6d6c 7275 6e2e 6d6f 6465  oint, mlrun.mode
+0001b4b0: 6c5f 6d6f 6e69 746f 7269 6e67 2e6d 6f64  l_monitoring.mod
+0001b4c0: 656c 5f65 6e64 706f 696e 742e 4d6f 6465  el_endpoint.Mode
+0001b4d0: 6c45 6e64 706f 696e 740a 2020 2020 2020  lEndpoint.      
+0001b4e0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0001b4f0: 206d 6f64 656c 5f65 6e64 706f 696e 7420   model_endpoint 
+0001b500: 3d20 6d6f 6465 6c5f 656e 6470 6f69 6e74  = model_endpoint
+0001b510: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
+0001b520: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001b530: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001b540: 6d6f 6465 6c2d 656e 6470 6f69 6e74 732f  model-endpoints/
+0001b550: 7b65 6e64 706f 696e 745f 6964 7d22 0a20  {endpoint_id}". 
+0001b560: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+0001b570: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0001b580: 2020 6d65 7468 6f64 3d22 504f 5354 222c    method="POST",
+0001b590: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0001b5a0: 683d 7061 7468 2c0a 2020 2020 2020 2020  h=path,.        
+0001b5b0: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
+0001b5c0: 5f6a 736f 6e28 6d6f 6465 6c5f 656e 6470  _json(model_endp
+0001b5d0: 6f69 6e74 292c 0a20 2020 2020 2020 2029  oint),.        )
+0001b5e0: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
+0001b5f0: 5f6d 6f64 656c 5f65 6e64 706f 696e 7428  _model_endpoint(
+0001b600: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001b610: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+0001b620: 7374 722c 0a20 2020 2020 2020 2065 6e64  str,.        end
+0001b630: 706f 696e 745f 6964 3a20 7374 722c 0a20  point_id: str,. 
+0001b640: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0001b650: 220a 2020 2020 2020 2020 4465 6c65 7465  ".        Delete
+0001b660: 7320 7468 6520 4442 2072 6563 6f72 6420  s the DB record 
+0001b670: 6f66 2061 2067 6976 656e 206d 6f64 656c  of a given model
+0001b680: 2065 6e64 706f 696e 742c 2070 726f 6a65   endpoint, proje
+0001b690: 6374 2061 6e64 2065 6e64 706f 696e 745f  ct and endpoint_
+0001b6a0: 6964 2061 7265 2075 7365 6420 666f 7220  id are used for 
+0001b6b0: 6c6f 6f6b 7570 0a0a 2020 2020 2020 2020  lookup..        
+0001b6c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+0001b6d0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+0001b6e0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+0001b6f0: 3a70 6172 616d 2065 6e64 706f 696e 745f  :param endpoint_
+0001b700: 6964 3a20 5468 6520 6964 206f 6620 7468  id: The id of th
+0001b710: 6520 656e 6470 6f69 6e74 0a20 2020 2020  e endpoint.     
+0001b720: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0001b730: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001b740: 732f 7b70 726f 6a65 6374 7d2f 6d6f 6465  s/{project}/mode
+0001b750: 6c2d 656e 6470 6f69 6e74 732f 7b65 6e64  l-endpoints/{end
+0001b760: 706f 696e 745f 6964 7d22 0a20 2020 2020  point_id}".     
+0001b770: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+0001b780: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+0001b790: 7468 6f64 3d22 4445 4c45 5445 222c 0a20  thod="DELETE",. 
+0001b7a0: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+0001b7b0: 7061 7468 2c0a 2020 2020 2020 2020 290a  path,.        ).
+0001b7c0: 0a20 2020 2064 6566 206c 6973 745f 6d6f  .    def list_mo
+0001b7d0: 6465 6c5f 656e 6470 6f69 6e74 7328 0a20  del_endpoints(. 
+0001b7e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001b7f0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0001b800: 722c 0a20 2020 2020 2020 206d 6f64 656c  r,.        model
+0001b810: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0001b820: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001b830: 6675 6e63 7469 6f6e 3a20 4f70 7469 6f6e  function: Option
+0001b840: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0001b850: 2020 2020 2020 2020 6c61 6265 6c73 3a20          labels: 
+0001b860: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
+0001b870: 2c0a 2020 2020 2020 2020 7374 6172 743a  ,.        start:
+0001b880: 2073 7472 203d 2022 6e6f 772d 3168 222c   str = "now-1h",
+0001b890: 0a20 2020 2020 2020 2065 6e64 3a20 7374  .        end: st
+0001b8a0: 7220 3d20 226e 6f77 222c 0a20 2020 2020  r = "now",.     
+0001b8b0: 2020 206d 6574 7269 6373 3a20 4f70 7469     metrics: Opti
+0001b8c0: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+0001b8d0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001b8e0: 746f 705f 6c65 7665 6c3a 2062 6f6f 6c20  top_level: bool 
+0001b8f0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+0001b900: 2075 6964 733a 204f 7074 696f 6e61 6c5b   uids: Optional[
+0001b910: 4c69 7374 5b73 7472 5d5d 203d 204e 6f6e  List[str]] = Non
+0001b920: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
+0001b930: 5b6d 6c72 756e 2e6d 6f64 656c 5f6d 6f6e  [mlrun.model_mon
+0001b940: 6974 6f72 696e 672e 6d6f 6465 6c5f 656e  itoring.model_en
+0001b950: 6470 6f69 6e74 2e4d 6f64 656c 456e 6470  dpoint.ModelEndp
+0001b960: 6f69 6e74 5d3a 0a20 2020 2020 2020 2022  oint]:.        "
+0001b970: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+0001b980: 6e73 2061 206c 6973 7420 6f66 2060 4d6f  ns a list of `Mo
+0001b990: 6465 6c45 6e64 706f 696e 7460 206f 626a  delEndpoint` obj
+0001b9a0: 6563 7473 2e20 4561 6368 2060 4d6f 6465  ects. Each `Mode
+0001b9b0: 6c45 6e64 706f 696e 7460 206f 626a 6563  lEndpoint` objec
+0001b9c0: 7420 7265 7072 6573 656e 7473 2074 6865  t represents the
+0001b9d0: 2063 7572 7265 6e74 2073 7461 7465 206f   current state o
+0001b9e0: 6620 610a 2020 2020 2020 2020 6d6f 6465  f a.        mode
+0001b9f0: 6c20 656e 6470 6f69 6e74 2e20 5468 6973  l endpoint. This
+0001ba00: 2066 756e 6374 696f 6e73 2073 7570 706f   functions suppo
+0001ba10: 7274 7320 6669 6c74 6572 696e 6720 6279  rts filtering by
+0001ba20: 2074 6865 2066 6f6c 6c6f 7769 6e67 2070   the following p
+0001ba30: 6172 616d 6574 6572 733a 0a20 2020 2020  arameters:.     
+0001ba40: 2020 2031 2920 6d6f 6465 6c0a 2020 2020     1) model.    
+0001ba50: 2020 2020 3229 2066 756e 6374 696f 6e0a      2) function.
+0001ba60: 2020 2020 2020 2020 3329 206c 6162 656c          3) label
+0001ba70: 730a 2020 2020 2020 2020 3429 2074 6f70  s.        4) top
+0001ba80: 206c 6576 656c 0a20 2020 2020 2020 2035   level.        5
+0001ba90: 2920 7569 6473 0a20 2020 2020 2020 2042  ) uids.        B
+0001baa0: 7920 6465 6661 756c 742c 2077 6865 6e20  y default, when 
+0001bab0: 6e6f 2066 696c 7465 7273 2061 7265 2061  no filters are a
+0001bac0: 7070 6c69 6564 2c20 616c 6c20 6176 6169  pplied, all avai
+0001bad0: 6c61 626c 6520 656e 6470 6f69 6e74 7320  lable endpoints 
+0001bae0: 666f 7220 7468 6520 6769 7665 6e20 7072  for the given pr
+0001baf0: 6f6a 6563 7420 7769 6c6c 2062 6520 6c69  oject will be li
+0001bb00: 7374 6564 2e0a 0a20 2020 2020 2020 2049  sted...        I
+0001bb10: 6e20 6164 6469 7469 6f6e 2c20 7468 6973  n addition, this
+0001bb20: 2066 756e 6374 696f 6e73 2070 726f 7669   functions provi
+0001bb30: 6465 7320 6120 6661 6361 6465 2066 6f72  des a facade for
+0001bb40: 206c 6973 7469 6e67 2065 6e64 706f 696e   listing endpoin
+0001bb50: 7420 7265 6c61 7465 6420 6d65 7472 6963  t related metric
+0001bb60: 732e 2054 6869 7320 6661 6361 6465 2069  s. This facade i
+0001bb70: 7320 7469 6d65 2d62 6173 6564 0a20 2020  s time-based.   
+0001bb80: 2020 2020 2061 6e64 2064 6570 656e 6473       and depends
+0001bb90: 206f 6e20 7468 6520 2773 7461 7274 2720   on the 'start' 
+0001bba0: 616e 6420 2765 6e64 2720 7061 7261 6d65  and 'end' parame
+0001bbb0: 7465 7273 2e20 4279 2064 6566 6175 6c74  ters. By default
+0001bbc0: 2c20 7768 656e 2074 6865 206d 6574 7269  , when the metri
+0001bbd0: 6373 2070 6172 616d 6574 6572 2069 7320  cs parameter is 
+0001bbe0: 4e6f 6e65 2c20 6e6f 206d 6574 7269 6373  None, no metrics
+0001bbf0: 2061 7265 0a20 2020 2020 2020 2061 6464   are.        add
+0001bc00: 6564 2074 6f20 7468 6520 6f75 7470 7574  ed to the output
+0001bc10: 206f 6620 7468 6973 2066 756e 6374 696f   of this functio
+0001bc20: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
+0001bc30: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
+0001bc40: 6e61 6d65 206f 6620 7468 6520 7072 6f6a  name of the proj
+0001bc50: 6563 740a 2020 2020 2020 2020 3a70 6172  ect.        :par
+0001bc60: 616d 206d 6f64 656c 3a20 5468 6520 6e61  am model: The na
+0001bc70: 6d65 206f 6620 7468 6520 6d6f 6465 6c20  me of the model 
+0001bc80: 746f 2066 696c 7465 7220 6279 0a20 2020  to filter by.   
+0001bc90: 2020 2020 203a 7061 7261 6d20 6675 6e63       :param func
+0001bca0: 7469 6f6e 3a20 5468 6520 6e61 6d65 206f  tion: The name o
+0001bcb0: 6620 7468 6520 6675 6e63 7469 6f6e 2074  f the function t
+0001bcc0: 6f20 6669 6c74 6572 2062 790a 2020 2020  o filter by.    
+0001bcd0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
+0001bce0: 733a 2041 206c 6973 7420 6f66 206c 6162  s: A list of lab
+0001bcf0: 656c 7320 746f 2066 696c 7465 7220 6279  els to filter by
+0001bd00: 2e20 4c61 6265 6c20 6669 6c74 6572 7320  . Label filters 
+0001bd10: 776f 726b 2062 7920 6569 7468 6572 2066  work by either f
+0001bd20: 696c 7465 7269 6e67 2061 2073 7065 6369  iltering a speci
+0001bd30: 6669 6320 7661 6c75 6520 6f66 2061 0a20  fic value of a. 
+0001bd40: 2020 2020 2020 2020 6c61 6265 6c20 2869          label (i
+0001bd50: 2e65 2e20 6c69 7374 2822 6b65 793d 7661  .e. list("key=va
+0001bd60: 6c75 6522 2929 206f 7220 6279 206c 6f6f  lue")) or by loo
+0001bd70: 6b69 6e67 2066 6f72 2074 6865 2065 7869  king for the exi
+0001bd80: 7374 656e 6365 206f 6620 6120 6769 7665  stence of a give
+0001bd90: 6e20 6b65 7920 2869 2e65 2e20 226b 6579  n key (i.e. "key
+0001bda0: 2229 0a20 2020 2020 2020 203a 7061 7261  ").        :para
+0001bdb0: 6d20 6d65 7472 6963 733a 2041 206c 6973  m metrics: A lis
+0001bdc0: 7420 6f66 206d 6574 7269 6373 2074 6f20  t of metrics to 
+0001bdd0: 7265 7475 726e 2066 6f72 2065 6163 6820  return for each 
+0001bde0: 656e 6470 6f69 6e74 2c20 7265 6164 206d  endpoint, read m
+0001bdf0: 6f72 6520 696e 2027 5469 6d65 4d65 7472  ore in 'TimeMetr
+0001be00: 6963 270a 2020 2020 2020 2020 3a70 6172  ic'.        :par
+0001be10: 616d 2073 7461 7274 3a20 5468 6520 7374  am start: The st
+0001be20: 6172 7420 7469 6d65 206f 6620 7468 6520  art time of the 
+0001be30: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
+0001be40: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
+0001be50: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
+0001be60: 6e67 2061 6e20 5246 4320 3333 3339 0a20  ng an RFC 3339. 
+0001be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be90: 7469 6d65 2c20 6120 556e 6978 2074 696d  time, a Unix tim
+0001bea0: 6573 7461 6d70 2069 6e20 6d69 6c6c 6973  estamp in millis
+0001beb0: 6563 6f6e 6473 2c20 6120 7265 6c61 7469  econds, a relati
+0001bec0: 7665 2074 696d 6520 2860 276e 6f77 2760  ve time (`'now'`
+0001bed0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0001bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bef0: 2020 2020 2060 276e 6f77 2d5b 302d 395d       `'now-[0-9]
+0001bf00: 2b5b 6d68 645d 2760 2c20 7768 6572 6520  +[mhd]'`, where 
+0001bf10: 606d 6020 3d20 6d69 6e75 7465 732c 2060  `m` = minutes, `
+0001bf20: 6860 203d 2068 6f75 7273 2c20 616e 6420  h` = hours, and 
+0001bf30: 6027 6427 6020 3d0a 2020 2020 2020 2020  `'d'` =.        
+0001bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf50: 2020 2020 2020 2020 2064 6179 7329 2c20           days), 
+0001bf60: 6f72 2030 2066 6f72 2074 6865 2065 6172  or 0 for the ear
+0001bf70: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
+0001bf80: 2020 2020 3a70 6172 616d 2065 6e64 3a20      :param end: 
+0001bf90: 5468 6520 656e 6420 7469 6d65 206f 6620  The end time of 
+0001bfa0: 7468 6520 6d65 7472 6963 732e 2043 616e  the metrics. Can
+0001bfb0: 2062 6520 7265 7072 6573 656e 7465 6420   be represented 
+0001bfc0: 6279 2061 2073 7472 696e 6720 636f 6e74  by a string cont
+0001bfd0: 6169 6e69 6e67 2061 6e20 5246 4320 3333  aining an RFC 33
+0001bfe0: 3339 0a20 2020 2020 2020 2020 2020 2020  39.             
+0001bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c000: 2020 2020 7469 6d65 2c20 6120 556e 6978      time, a Unix
+0001c010: 2074 696d 6573 7461 6d70 2069 6e20 6d69   timestamp in mi
+0001c020: 6c6c 6973 6563 6f6e 6473 2c20 6120 7265  lliseconds, a re
+0001c030: 6c61 7469 7665 2074 696d 6520 2860 276e  lative time (`'n
+0001c040: 6f77 2760 206f 720a 2020 2020 2020 2020  ow'` or.        
+0001c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c060: 2020 2020 2020 2020 2060 276e 6f77 2d5b           `'now-[
+0001c070: 302d 395d 2b5b 6d68 645d 2760 2c20 7768  0-9]+[mhd]'`, wh
+0001c080: 6572 6520 606d 6020 3d20 6d69 6e75 7465  ere `m` = minute
+0001c090: 732c 2060 6860 203d 2068 6f75 7273 2c20  s, `h` = hours, 
+0001c0a0: 616e 6420 6027 6427 6020 3d0a 2020 2020  and `'d'` =.    
+0001c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0c0: 2020 2020 2020 2020 2020 2020 2064 6179               day
+0001c0d0: 7329 2c20 6f72 2030 2066 6f72 2074 6865  s), or 0 for the
+0001c0e0: 2065 6172 6c69 6573 7420 7469 6d65 2e0a   earliest time..
+0001c0f0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+0001c100: 6f70 5f6c 6576 656c 3a20 6966 2074 7275  op_level: if tru
+0001c110: 6520 7769 6c6c 2072 6574 7572 6e20 6f6e  e will return on
+0001c120: 6c79 2072 6f75 7465 7273 2061 6e64 2065  ly routers and e
+0001c130: 6e64 706f 696e 7420 7468 6174 2061 7265  ndpoint that are
+0001c140: 204e 4f54 2063 6869 6c64 7265 6e20 6f66   NOT children of
+0001c150: 2061 6e79 2072 6f75 7465 720a 2020 2020   any router.    
+0001c160: 2020 2020 3a70 6172 616d 2075 6964 733a      :param uids:
+0001c170: 2069 6620 7061 7373 6564 2077 696c 6c20   if passed will 
+0001c180: 7265 7475 726e 2061 206c 6973 7420 604d  return a list `M
+0001c190: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
+0001c1a0: 6a65 6374 2077 6974 6820 7569 6420 696e  ject with uid in
+0001c1b0: 2075 6964 730a 2020 2020 2020 2020 2222   uids.        ""
+0001c1c0: 220a 0a20 2020 2020 2020 2070 6174 6820  "..        path 
+0001c1d0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+0001c1e0: 6f6a 6563 747d 2f6d 6f64 656c 2d65 6e64  oject}/model-end
+0001c1f0: 706f 696e 7473 220a 0a20 2020 2020 2020  points"..       
+0001c200: 2069 6620 6c61 6265 6c73 2061 6e64 2069   if labels and i
+0001c210: 7369 6e73 7461 6e63 6528 6c61 6265 6c73  sinstance(labels
+0001c220: 2c20 6469 6374 293a 0a20 2020 2020 2020  , dict):.       
+0001c230: 2020 2020 206c 6162 656c 7320 3d20 5b66       labels = [f
+0001c240: 227b 6b65 797d 3d7b 7661 6c75 657d 2220  "{key}={value}" 
+0001c250: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
+0001c260: 6e20 6c61 6265 6c73 2e69 7465 6d73 2829  n labels.items()
+0001c270: 5d0a 0a20 2020 2020 2020 2072 6573 706f  ]..        respo
+0001c280: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0001c290: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0001c2a0: 206d 6574 686f 643d 2247 4554 222c 0a20   method="GET",. 
+0001c2b0: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+0001c2c0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0001c2d0: 2020 7061 7261 6d73 3d7b 0a20 2020 2020    params={.     
+0001c2e0: 2020 2020 2020 2020 2020 2022 6d6f 6465             "mode
+0001c2f0: 6c22 3a20 6d6f 6465 6c2c 0a20 2020 2020  l": model,.     
+0001c300: 2020 2020 2020 2020 2020 2022 6675 6e63             "func
+0001c310: 7469 6f6e 223a 2066 756e 6374 696f 6e2c  tion": function,
+0001c320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c330: 2022 6c61 6265 6c22 3a20 6c61 6265 6c73   "label": labels
+0001c340: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+0001c350: 2020 2020 2020 2020 2273 7461 7274 223a          "start":
+0001c360: 2073 7461 7274 2c0a 2020 2020 2020 2020   start,.        
+0001c370: 2020 2020 2020 2020 2265 6e64 223a 2065          "end": e
+0001c380: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
+0001c390: 2020 2020 226d 6574 7269 6322 3a20 6d65      "metric": me
+0001c3a0: 7472 6963 7320 6f72 205b 5d2c 0a20 2020  trics or [],.   
+0001c3b0: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+0001c3c0: 702d 6c65 7665 6c22 3a20 746f 705f 6c65  p-level": top_le
+0001c3d0: 7665 6c2c 0a20 2020 2020 2020 2020 2020  vel,.           
+0001c3e0: 2020 2020 2022 7569 6422 3a20 7569 6473       "uid": uids
+0001c3f0: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+0001c400: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001c410: 2020 2020 2320 4765 6e65 7261 7465 2061      # Generate a
+0001c420: 206c 6973 7420 6f66 2061 206d 6f64 656c   list of a model
+0001c430: 2065 6e64 706f 696e 7420 6469 6374 696f   endpoint dictio
+0001c440: 6e61 7269 6573 0a20 2020 2020 2020 206d  naries.        m
+0001c450: 6f64 656c 5f65 6e64 706f 696e 7473 203d  odel_endpoints =
+0001c460: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
+0001c470: 5b22 656e 6470 6f69 6e74 7322 5d0a 2020  ["endpoints"].  
+0001c480: 2020 2020 2020 6966 206d 6f64 656c 5f65        if model_e
+0001c490: 6e64 706f 696e 7473 3a0a 2020 2020 2020  ndpoints:.      
+0001c4a0: 2020 2020 2020 7265 7475 726e 205b 0a20        return [. 
+0001c4b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001c4c0: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
+0001c4d0: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
+0001c4e0: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
+0001c4f0: 6e74 2e66 726f 6d5f 6469 6374 286f 626a  nt.from_dict(obj
+0001c500: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001c510: 2020 666f 7220 6f62 6a20 696e 206d 6f64    for obj in mod
+0001c520: 656c 5f65 6e64 706f 696e 7473 0a20 2020  el_endpoints.   
+0001c530: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0001c540: 2020 2072 6574 7572 6e20 5b5d 0a0a 2020     return []..  
+0001c550: 2020 6465 6620 6765 745f 6d6f 6465 6c5f    def get_model_
+0001c560: 656e 6470 6f69 6e74 280a 2020 2020 2020  endpoint(.      
+0001c570: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001c580: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+0001c590: 2020 2020 2020 656e 6470 6f69 6e74 5f69        endpoint_i
+0001c5a0: 643a 2073 7472 2c0a 2020 2020 2020 2020  d: str,.        
+0001c5b0: 7374 6172 743a 204f 7074 696f 6e61 6c5b  start: Optional[
+0001c5c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0001c5d0: 2020 2020 2065 6e64 3a20 4f70 7469 6f6e       end: Option
+0001c5e0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0001c5f0: 2020 2020 2020 2020 6d65 7472 6963 733a          metrics:
+0001c600: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
+0001c610: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+0001c620: 2020 2020 2066 6561 7475 7265 5f61 6e61       feature_ana
+0001c630: 6c79 7369 733a 2062 6f6f 6c20 3d20 4661  lysis: bool = Fa
+0001c640: 6c73 652c 0a20 2020 2029 202d 3e20 6d6c  lse,.    ) -> ml
+0001c650: 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f  run.model_monito
+0001c660: 7269 6e67 2e6d 6f64 656c 5f65 6e64 706f  ring.model_endpo
+0001c670: 696e 742e 4d6f 6465 6c45 6e64 706f 696e  int.ModelEndpoin
+0001c680: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
+0001c690: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+0001c6a0: 2073 696e 676c 6520 604d 6f64 656c 456e   single `ModelEn
+0001c6b0: 6470 6f69 6e74 6020 6f62 6a65 6374 2077  dpoint` object w
+0001c6c0: 6974 6820 6164 6469 7469 6f6e 616c 206d  ith additional m
+0001c6d0: 6574 7269 6373 2061 6e64 2066 6561 7475  etrics and featu
+0001c6e0: 7265 2072 656c 6174 6564 2064 6174 612e  re related data.
+0001c6f0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001c700: 2070 726f 6a65 6374 3a20 2020 2020 2020   project:       
+0001c710: 2020 2020 2020 2020 2020 2020 2054 6865               The
+0001c720: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
+0001c730: 6a65 6374 0a20 2020 2020 2020 203a 7061  ject.        :pa
+0001c740: 7261 6d20 656e 6470 6f69 6e74 5f69 643a  ram endpoint_id:
+0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c760: 5468 6520 756e 6971 7565 2069 6420 6f66  The unique id of
+0001c770: 2074 6865 206d 6f64 656c 2065 6e64 706f   the model endpo
+0001c780: 696e 742e 0a20 2020 2020 2020 203a 7061  int..        :pa
+0001c790: 7261 6d20 7374 6172 743a 2020 2020 2020  ram start:      
+0001c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c7b0: 5468 6520 7374 6172 7420 7469 6d65 206f  The start time o
+0001c7c0: 6620 7468 6520 6d65 7472 6963 732e 2043  f the metrics. C
+0001c7d0: 616e 2062 6520 7265 7072 6573 656e 7465  an be represente
+0001c7e0: 6420 6279 2061 2073 7472 696e 6720 636f  d by a string co
+0001c7f0: 6e74 6169 6e69 6e67 2061 6e0a 2020 2020  ntaining an.    
+0001c800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c820: 2020 2020 2020 2052 4643 2033 3333 3920         RFC 3339 
+0001c830: 7469 6d65 2c20 6120 556e 6978 2074 696d  time, a Unix tim
+0001c840: 6573 7461 6d70 2069 6e20 6d69 6c6c 6973  estamp in millis
+0001c850: 6563 6f6e 6473 2c20 6120 7265 6c61 7469  econds, a relati
+0001c860: 7665 2074 696d 6520 2860 276e 6f77 2760  ve time (`'now'`
+0001c870: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0001c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c890: 2020 2020 2020 2020 2020 2020 2020 2060                 `
+0001c8a0: 276e 6f77 2d5b 302d 395d 2b5b 6d68 645d  'now-[0-9]+[mhd]
+0001c8b0: 2760 2c20 7768 6572 6520 606d 6020 3d20  '`, where `m` = 
+0001c8c0: 6d69 6e75 7465 732c 2060 6860 203d 2068  minutes, `h` = h
+0001c8d0: 6f75 7273 2c20 616e 6420 6027 6427 6020  ours, and `'d'` 
+0001c8e0: 3d20 6461 7973 292c 206f 720a 2020 2020  = days), or.    
+0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c910: 2020 2020 2020 2030 2066 6f72 2074 6865         0 for the
+0001c920: 2065 6172 6c69 6573 7420 7469 6d65 2e0a   earliest time..
+0001c930: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+0001c940: 6e64 3a20 2020 2020 2020 2020 2020 2020  nd:             
+0001c950: 2020 2020 2020 2020 2020 2054 6865 2065             The e
+0001c960: 6e64 2074 696d 6520 6f66 2074 6865 206d  nd time of the m
+0001c970: 6574 7269 6373 2e20 4361 6e20 6265 2072  etrics. Can be r
+0001c980: 6570 7265 7365 6e74 6564 2062 7920 6120  epresented by a 
+0001c990: 7374 7269 6e67 2063 6f6e 7461 696e 696e  string containin
+0001c9a0: 6720 616e 0a20 2020 2020 2020 2020 2020  g an.           
+0001c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9d0: 5246 4320 3333 3339 2074 696d 652c 2061  RFC 3339 time, a
+0001c9e0: 2055 6e69 7820 7469 6d65 7374 616d 7020   Unix timestamp 
+0001c9f0: 696e 206d 696c 6c69 7365 636f 6e64 732c  in milliseconds,
+0001ca00: 2061 2072 656c 6174 6976 6520 7469 6d65   a relative time
+0001ca10: 2028 6027 6e6f 7727 6020 6f72 0a20 2020   (`'now'` or.   
+0001ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca40: 2020 2020 2020 2020 6027 6e6f 772d 5b30          `'now-[0
+0001ca50: 2d39 5d2b 5b6d 6864 5d27 602c 2077 6865  -9]+[mhd]'`, whe
+0001ca60: 7265 2060 6d60 203d 206d 696e 7574 6573  re `m` = minutes
+0001ca70: 2c20 6068 6020 3d20 686f 7572 732c 2061  , `h` = hours, a
+0001ca80: 6e64 2060 2764 2760 203d 2064 6179 7329  nd `'d'` = days)
+0001ca90: 2c20 6f72 0a20 2020 2020 2020 2020 2020  , or.           
+0001caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cac0: 3020 666f 7220 7468 6520 6561 726c 6965  0 for the earlie
+0001cad0: 7374 2074 696d 652e 0a20 2020 2020 2020  st time..       
+0001cae0: 203a 7061 7261 6d20 6d65 7472 6963 733a   :param metrics:
+0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 2020 2020 4120 6c69 7374 206f 6620 6d65      A list of me
+0001cb10: 7472 6963 7320 746f 2072 6574 7572 6e20  trics to return 
+0001cb20: 666f 7220 7468 6520 6d6f 6465 6c20 656e  for the model en
+0001cb30: 6470 6f69 6e74 2e20 5468 6572 6520 6172  dpoint. There ar
+0001cb40: 6520 7072 652d 6465 6669 6e65 640a 2020  e pre-defined.  
+0001cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb70: 2020 2020 2020 2020 206d 6574 7269 6373           metrics
+0001cb80: 2066 6f72 206d 6f64 656c 2065 6e64 706f   for model endpo
+0001cb90: 696e 7473 2073 7563 6820 6173 2070 7265  ints such as pre
+0001cba0: 6469 6374 696f 6e73 5f70 6572 5f73 6563  dictions_per_sec
+0001cbb0: 6f6e 6420 616e 640a 2020 2020 2020 2020  ond and.        
+0001cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbe0: 2020 206c 6174 656e 6379 5f61 7667 5f35     latency_avg_5
+0001cbf0: 6d20 6275 7420 616c 736f 2063 7573 746f  m but also custo
+0001cc00: 6d20 6d65 7472 6963 7320 6465 6669 6e65  m metrics define
+0001cc10: 6420 6279 2074 6865 2075 7365 722e 2050  d by the user. P
+0001cc20: 6c65 6173 6520 6e6f 7465 2074 6861 740a  lease note that.
+0001cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc50: 2020 2020 2020 2020 2020 2074 6865 7365             these
+0001cc60: 206d 6574 7269 6373 2061 7265 2073 746f   metrics are sto
+0001cc70: 7265 6420 696e 2074 6865 2074 696d 6520  red in the time 
+0001cc80: 7365 7269 6573 2044 4220 616e 6420 7468  series DB and th
+0001cc90: 6520 7265 7375 6c74 7320 7769 6c6c 2062  e results will b
+0001cca0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ccc0: 2020 2020 2020 2020 2020 2020 2061 7070               app
+0001ccd0: 6561 7265 6420 756e 6465 7220 6d6f 6465  eared under mode
+0001cce0: 6c5f 656e 6470 6f69 6e74 2e73 7065 632e  l_endpoint.spec.
+0001ccf0: 6d65 7472 6963 732e 0a20 2020 2020 2020  metrics..       
+0001cd00: 203a 7061 7261 6d20 6665 6174 7572 655f   :param feature_
+0001cd10: 616e 616c 7973 6973 3a20 2020 2020 2020  analysis:       
+0001cd20: 2020 2020 5768 656e 2054 7275 652c 2074      When True, t
+0001cd30: 6865 2062 6173 6520 6665 6174 7572 6520  he base feature 
+0001cd40: 7374 6174 6973 7469 6373 2061 6e64 2063  statistics and c
+0001cd50: 7572 7265 6e74 2066 6561 7475 7265 2073  urrent feature s
+0001cd60: 7461 7469 7374 6963 7320 7769 6c6c 0a20  tatistics will. 
+0001cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd90: 2020 2020 2020 2020 2020 6265 2061 6464            be add
+0001cda0: 6564 2074 6f20 7468 6520 6f75 7470 7574  ed to the output
+0001cdb0: 206f 6620 7468 6520 7265 7375 6c74 696e   of the resultin
+0001cdc0: 6720 6f62 6a65 6374 2e0a 0a20 2020 2020  g object...     
+0001cdd0: 2020 203a 7265 7475 726e 3a20 4120 604d     :return: A `M
+0001cde0: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
+0001cdf0: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+0001ce00: 220a 0a20 2020 2020 2020 2070 6174 6820  "..        path 
+0001ce10: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+0001ce20: 6f6a 6563 747d 2f6d 6f64 656c 2d65 6e64  oject}/model-end
+0001ce30: 706f 696e 7473 2f7b 656e 6470 6f69 6e74  points/{endpoint
+0001ce40: 5f69 647d 220a 2020 2020 2020 2020 7265  _id}".        re
+0001ce50: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+0001ce60: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+0001ce70: 2020 2020 6d65 7468 6f64 3d22 4745 5422      method="GET"
+0001ce80: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001ce90: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
+0001cea0: 2020 2020 2070 6172 616d 733d 7b0a 2020       params={.  
+0001ceb0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+0001cec0: 7461 7274 223a 2073 7461 7274 2c0a 2020  tart": start,.  
+0001ced0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0001cee0: 6e64 223a 2065 6e64 2c0a 2020 2020 2020  nd": end,.      
+0001cef0: 2020 2020 2020 2020 2020 226d 6574 7269            "metri
+0001cf00: 6322 3a20 6d65 7472 6963 7320 6f72 205b  c": metrics or [
+0001cf10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001cf20: 2020 2022 6665 6174 7572 655f 616e 616c     "feature_anal
+0001cf30: 7973 6973 223a 2066 6561 7475 7265 5f61  ysis": feature_a
+0001cf40: 6e61 6c79 7369 732c 0a20 2020 2020 2020  nalysis,.       
+0001cf50: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0001cf60: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0001cf70: 6e20 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f  n mlrun.model_mo
+0001cf80: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
+0001cf90: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
+0001cfa0: 706f 696e 742e 6672 6f6d 5f64 6963 7428  point.from_dict(
+0001cfb0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0001cfc0: 706f 6e73 652e 6a73 6f6e 2829 0a20 2020  ponse.json().   
+0001cfd0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0001cfe0: 7061 7463 685f 6d6f 6465 6c5f 656e 6470  patch_model_endp
+0001cff0: 6f69 6e74 280a 2020 2020 2020 2020 7365  oint(.        se
+0001d000: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+0001d010: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+0001d020: 2020 656e 6470 6f69 6e74 5f69 643a 2073    endpoint_id: s
+0001d030: 7472 2c0a 2020 2020 2020 2020 6174 7472  tr,.        attr
+0001d040: 6962 7574 6573 3a20 6469 6374 2c0a 2020  ibutes: dict,.  
+0001d050: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0001d060: 0a20 2020 2020 2020 2055 7064 6174 6573  .        Updates
+0001d070: 206d 6f64 656c 2065 6e64 706f 696e 7420   model endpoint 
+0001d080: 7769 7468 2070 726f 7669 6465 6420 6174  with provided at
+0001d090: 7472 6962 7574 6573 2e0a 0a20 2020 2020  tributes...     
+0001d0a0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+0001d0b0: 743a 2054 6865 206e 616d 6520 6f66 2074  t: The name of t
+0001d0c0: 6865 2070 726f 6a65 6374 2e0a 2020 2020  he project..    
+0001d0d0: 2020 2020 3a70 6172 616d 2065 6e64 706f      :param endpo
+0001d0e0: 696e 745f 6964 3a20 5468 6520 6964 206f  int_id: The id o
+0001d0f0: 6620 7468 6520 656e 6470 6f69 6e74 2e0a  f the endpoint..
+0001d100: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+0001d110: 7474 7269 6275 7465 733a 2044 6963 7469  ttributes: Dicti
+0001d120: 6f6e 6172 7920 6f66 2061 7474 7269 6275  onary of attribu
+0001d130: 7465 7320 7468 6174 2077 696c 6c20 6265  tes that will be
+0001d140: 2075 7365 6420 666f 7220 7570 6461 7465   used for update
+0001d150: 2074 6865 206d 6f64 656c 2065 6e64 706f   the model endpo
+0001d160: 696e 742e 2054 6865 206b 6579 730a 2020  int. The keys.  
+0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d180: 2020 2020 2020 2020 206f 6620 7468 6973           of this
+0001d190: 2064 6963 7469 6f6e 6172 7920 7368 6f75   dictionary shou
+0001d1a0: 6c64 2065 7869 7374 2069 6e20 7468 6520  ld exist in the 
+0001d1b0: 7461 7267 6574 2074 6162 6c65 2e20 4e6f  target table. No
+0001d1c0: 7465 2074 6861 7420 7468 6520 7661 6c75  te that the valu
+0001d1d0: 6573 2073 686f 756c 6420 6265 0a20 2020  es should be.   
+0001d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1f0: 2020 2020 2020 2020 6672 6f6d 2074 7970          from typ
+0001d200: 6520 7374 7269 6e67 206f 7220 6672 6f6d  e string or from
+0001d210: 2061 2076 616c 6964 206e 756d 6572 6963   a valid numeric
+0001d220: 616c 2074 7970 6520 7375 6368 2061 7320  al type such as 
+0001d230: 696e 7420 6f72 2066 6c6f 6174 2e0a 2020  int or float..  
+0001d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d250: 2020 2020 2020 2020 2020 4d6f 7265 2064            More d
+0001d260: 6574 6169 6c73 2061 626f 7574 2074 6865  etails about the
+0001d270: 206d 6f64 656c 2065 6e64 706f 696e 7420   model endpoint 
+0001d280: 6176 6169 6c61 626c 6520 6174 7472 6962  available attrib
+0001d290: 7574 6573 2063 616e 2062 6520 666f 756e  utes can be foun
+0001d2a0: 6420 756e 6465 720a 2020 2020 2020 2020  d under.        
+0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2c0: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
+0001d2d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001d2e0: 6d61 732e 4d6f 6465 6c45 6e64 706f 696e  mas.ModelEndpoin
+0001d2f0: 7460 2e0a 0a20 2020 2020 2020 2020 2020  t`...           
 0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d310: 2020 2320 4765 6e65 7261 7465 2063 7572    # Generate cur
-0001d320: 7265 6e74 2073 7461 7473 2066 6f72 2074  rent stats for t
-0001d330: 776f 2066 6561 7475 7265 730a 2020 2020  wo features.    
-0001d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d350: 2020 2020 2020 2020 2020 2020 6375 7272              curr
-0001d360: 656e 745f 7374 6174 7320 3d20 7b27 7476  ent_stats = {'tv
-0001d370: 645f 7375 6d27 3a20 322e 322c 0a20 2020  d_sum': 2.2,.   
-0001d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2774                't
-0001d3b0: 7664 5f6d 6561 6e27 3a20 302e 352c 0a20  vd_mean': 0.5,. 
+0001d310: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d330: 2020 2020 2020 2020 2020 2023 2047 656e             # Gen
+0001d340: 6572 6174 6520 6375 7272 656e 7420 7374  erate current st
+0001d350: 6174 7320 666f 7220 7477 6f20 6665 6174  ats for two feat
+0001d360: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
+0001d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d380: 2020 2020 2063 7572 7265 6e74 5f73 7461       current_sta
+0001d390: 7473 203d 207b 2774 7664 5f73 756d 273a  ts = {'tvd_sum':
+0001d3a0: 2032 2e32 2c0a 2020 2020 2020 2020 2020   2.2,.          
+0001d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3f0: 2768 656c 6c69 6e67 6572 5f73 756d 273a  'hellinger_sum':
-0001d400: 2033 2e36 2c0a 2020 2020 2020 2020 2020   3.6,.          
-0001d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d430: 2020 2020 2020 2027 6865 6c6c 696e 6765         'hellinge
-0001d440: 725f 6d65 616e 273a 2030 2e39 2c0a 2020  r_mean': 0.9,.  
+0001d3d0: 2020 2020 2020 2027 7476 645f 6d65 616e         'tvd_mean
+0001d3e0: 273a 2030 2e35 2c0a 2020 2020 2020 2020  ': 0.5,.        
+0001d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d410: 2020 2020 2020 2020 2027 6865 6c6c 696e           'hellin
+0001d420: 6765 725f 7375 6d27 3a20 332e 362c 0a20  ger_sum': 3.6,. 
+0001d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d470: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001d480: 6b6c 645f 7375 6d27 3a20 3234 2e32 2c0a  kld_sum': 24.2,.
+0001d460: 2768 656c 6c69 6e67 6572 5f6d 6561 6e27  'hellinger_mean'
+0001d470: 3a20 302e 392c 0a20 2020 2020 2020 2020  : 0.9,.         
+0001d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4c0: 2027 6b6c 645f 6d65 616e 273a 2036 2e30   'kld_mean': 6.0
-0001d4d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d500: 2020 2027 6631 273a 207b 2774 7664 273a     'f1': {'tvd':
-0001d510: 2030 2e35 2c20 2768 656c 6c69 6e67 6572   0.5, 'hellinger
-0001d520: 273a 2031 2e30 2c20 276b 6c64 273a 2036  ': 1.0, 'kld': 6
-0001d530: 2e34 7d2c 0a20 2020 2020 2020 2020 2020  .4},.           
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d560: 2020 2020 2020 2766 3227 3a20 7b27 7476        'f2': {'tv
-0001d570: 6427 3a20 302e 352c 2027 6865 6c6c 696e  d': 0.5, 'hellin
-0001d580: 6765 7227 3a20 312e 302c 2027 6b6c 6427  ger': 1.0, 'kld'
-0001d590: 3a20 362e 357d 7d0a 0a20 2020 2020 2020  : 6.5}}..       
-0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5b0: 2020 2020 2020 2020 2023 2043 7265 6174           # Creat
-0001d5c0: 6520 6174 7472 6962 7574 6573 2064 6963  e attributes dic
-0001d5d0: 7469 6f6e 6172 7920 6163 636f 7264 696e  tionary accordin
-0001d5e0: 6720 746f 2074 6865 2072 6571 7569 7265  g to the require
-0001d5f0: 6420 666f 726d 6174 0a20 2020 2020 2020  d format.       
-0001d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d610: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-0001d620: 7465 7320 3d20 7b60 6375 7272 656e 745f  tes = {`current_
-0001d630: 7374 6174 7360 3a20 6a73 6f6e 2e64 756d  stats`: json.dum
-0001d640: 7073 2863 7572 7265 6e74 5f73 7461 7473  ps(current_stats
-0001d650: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0001d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d680: 2060 6472 6966 745f 7374 6174 7573 603a   `drift_status`:
-0001d690: 2022 4452 4946 545f 4445 5445 4354 4544   "DRIFT_DETECTED
-0001d6a0: 227d 0a0a 2020 2020 2020 2020 2222 220a  "}..        """.
-0001d6b0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
-0001d6c0: 7465 7320 3d20 7b22 6174 7472 6962 7574  tes = {"attribut
-0001d6d0: 6573 223a 205f 6173 5f6a 736f 6e28 6174  es": _as_json(at
-0001d6e0: 7472 6962 7574 6573 297d 0a20 2020 2020  tributes)}.     
-0001d6f0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0001d700: 6563 7473 2f7b 7072 6f6a 6563 747d 2f6d  ects/{project}/m
-0001d710: 6f64 656c 2d65 6e64 706f 696e 7473 2f7b  odel-endpoints/{
-0001d720: 656e 6470 6f69 6e74 5f69 647d 220a 2020  endpoint_id}".  
-0001d730: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-0001d740: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0001d750: 206d 6574 686f 643d 2250 4154 4348 222c   method="PATCH",
-0001d760: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-0001d770: 683d 7061 7468 2c0a 2020 2020 2020 2020  h=path,.        
-0001d780: 2020 2020 7061 7261 6d73 3d61 7474 7269      params=attri
-0001d790: 6275 7465 732c 0a20 2020 2020 2020 2029  butes,.        )
-0001d7a0: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-0001d7b0: 5f68 7562 5f73 6f75 7263 6528 0a20 2020  _hub_source(.   
-0001d7c0: 2020 2020 2073 656c 662c 2073 6f75 7263       self, sourc
-0001d7d0: 653a 2055 6e69 6f6e 5b64 6963 742c 206d  e: Union[dict, m
-0001d7e0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001d7f0: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
-0001d800: 7572 6365 5d0a 2020 2020 293a 0a20 2020  urce].    ):.   
-0001d810: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001d820: 2041 6464 2061 206e 6577 2068 7562 2073   Add a new hub s
-0001d830: 6f75 7263 652e 0a0a 2020 2020 2020 2020  ource...        
-0001d840: 4d4c 5275 6e20 6d61 696e 7461 696e 7320  MLRun maintains 
-0001d850: 616e 206f 7264 6572 6564 206c 6973 7420  an ordered list 
-0001d860: 6f66 2068 7562 2073 6f75 7263 6573 2028  of hub sources (
-0001d870: e280 9c73 6f75 7263 6573 e280 9d29 2045  ...sources...) E
-0001d880: 6163 6820 736f 7572 6365 2068 6173 0a20  ach source has. 
-0001d890: 2020 2020 2020 2069 7473 2064 6574 6169         its detai
-0001d8a0: 6c73 2072 6567 6973 7465 7265 6420 616e  ls registered an
-0001d8b0: 6420 6974 7320 6f72 6465 7220 7769 7468  d its order with
-0001d8c0: 696e 2074 6865 206c 6973 742e 2057 6865  in the list. Whe
-0001d8d0: 6e20 6372 6561 7469 6e67 2061 206e 6577  n creating a new
-0001d8e0: 2073 6f75 7263 652c 2074 6865 2073 7065   source, the spe
-0001d8f0: 6369 616c 206f 7264 6572 2060 602d 3160  cial order ``-1`
-0001d900: 600a 2020 2020 2020 2020 6361 6e20 6265  `.        can be
-0001d910: 2075 7365 6420 746f 206d 6172 6b20 7468   used to mark th
-0001d920: 6973 2073 6f75 7263 6520 6173 206c 6173  is source as las
-0001d930: 7420 696e 2074 6865 206c 6973 742e 2048  t in the list. H
-0001d940: 6f77 6576 6572 2c20 6f6e 6365 2074 6865  owever, once the
-0001d950: 2073 6f75 7263 6520 6973 2069 6e20 7468   source is in th
-0001d960: 6520 4d4c 5275 6e20 6c69 7374 2c0a 2020  e MLRun list,.  
-0001d970: 2020 2020 2020 6974 7320 6f72 6465 7220        its order 
-0001d980: 7769 6c6c 2061 6c77 6179 7320 6265 2060  will always be `
-0001d990: 603e 3060 602e 0a0a 2020 2020 2020 2020  `>0``...        
-0001d9a0: 5468 6520 676c 6f62 616c 2068 7562 2073  The global hub s
-0001d9b0: 6f75 7263 6520 616c 7761 7973 2065 7869  ource always exi
-0001d9c0: 7374 7320 696e 2074 6865 206c 6973 742c  sts in the list,
-0001d9d0: 2061 6e64 2069 7320 616c 7761 7973 2074   and is always t
-0001d9e0: 6865 206c 6173 7420 736f 7572 6365 0a20  he last source. 
-0001d9f0: 2020 2020 2020 2028 6060 6f72 6465 7220         (``order 
-0001da00: 3d20 2d31 6060 292e 2049 7420 6361 6e6e  = -1``). It cann
-0001da10: 6f74 2062 6520 6d6f 6469 6669 6564 206e  ot be modified n
-0001da20: 6f72 2063 616e 2069 7420 6265 206d 6f76  or can it be mov
-0001da30: 6564 2074 6f20 616e 6f74 6865 7220 6f72  ed to another or
-0001da40: 6465 7220 696e 2074 6865 206c 6973 742e  der in the list.
-0001da50: 0a0a 2020 2020 2020 2020 5468 6520 736f  ..        The so
-0001da60: 7572 6365 206f 626a 6563 7420 6d61 7920  urce object may 
-0001da70: 636f 6e74 6169 6e20 6372 6564 656e 7469  contain credenti
-0001da80: 616c 7320 7768 6963 6820 6172 6520 6e65  als which are ne
-0001da90: 6564 6564 2074 6f20 6163 6365 7373 2074  eded to access t
-0001daa0: 6865 2064 6174 6173 746f 7265 2077 6865  he datastore whe
-0001dab0: 7265 2074 6865 2073 6f75 7263 6520 6973  re the source is
-0001dac0: 2073 746f 7265 642e 0a20 2020 2020 2020   stored..       
-0001dad0: 2054 6865 7365 2063 7265 6465 6e74 6961   These credentia
-0001dae0: 6c73 2061 7265 206e 6f74 206b 6570 7420  ls are not kept 
-0001daf0: 696e 2074 6865 204d 4c52 756e 2044 422c  in the MLRun DB,
-0001db00: 2062 7574 2061 7265 2073 746f 7265 6420   but are stored 
-0001db10: 696e 7369 6465 2061 206b 7562 6572 6e65  inside a kuberne
-0001db20: 7465 7320 7365 6372 6574 206f 626a 6563  tes secret objec
-0001db30: 7420 6d61 696e 7461 696e 6564 2062 790a  t maintained by.
-0001db40: 2020 2020 2020 2020 4d4c 5275 6e2e 2054          MLRun. T
-0001db50: 6865 7920 6172 6520 6e6f 7420 7265 7475  hey are not retu
-0001db60: 726e 6564 2074 6872 6f75 6768 2061 6e79  rned through any
-0001db70: 2041 5049 2066 726f 6d20 4d4c 5275 6e2e   API from MLRun.
-0001db80: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0001db90: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-0001dba0: 2069 6d70 6f72 7420 6d6c 7275 6e2e 636f   import mlrun.co
-0001dbb0: 6d6d 6f6e 2e73 6368 656d 6173 0a0a 2020  mmon.schemas..  
-0001dbc0: 2020 2020 2020 2020 2020 2320 4164 6420            # Add 
-0001dbd0: 6120 7072 6976 6174 6520 736f 7572 6365  a private source
-0001dbe0: 2061 7320 7468 6520 6c61 7374 206f 6e65   as the last one
-0001dbf0: 2028 7769 6c6c 2062 6520 2331 2069 6e20   (will be #1 in 
-0001dc00: 7468 6520 6c69 7374 290a 2020 2020 2020  the list).      
-0001dc10: 2020 2020 2020 7072 6976 6174 655f 736f        private_so
-0001dc20: 7572 6365 203d 206d 6c72 756e 2e63 6f6d  urce = mlrun.com
-0001dc30: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-0001dc40: 7865 6448 7562 6553 6f75 7263 6528 0a20  xedHubeSource(. 
-0001dc50: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001dc60: 7264 6572 3d2d 312c 0a20 2020 2020 2020  rder=-1,.       
-0001dc70: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-0001dc80: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001dc90: 656d 6173 2e48 7562 536f 7572 6365 280a  emas.HubSource(.
-0001dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcb0: 2020 2020 6d65 7461 6461 7461 3d6d 6c72      metadata=mlr
-0001dcc0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001dcd0: 732e 4875 624f 626a 6563 744d 6574 6164  s.HubObjectMetad
-0001dce0: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
-0001dcf0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-0001dd00: 653d 2270 7269 7622 2c20 6465 7363 7269  e="priv", descri
-0001dd10: 7074 696f 6e3d 2261 2070 7269 7661 7465  ption="a private
-0001dd20: 2073 6f75 7263 6522 0a20 2020 2020 2020   source".       
-0001dd30: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
-0001dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd50: 2020 2020 7370 6563 3d6d 6c72 756e 2e63      spec=mlrun.c
-0001dd60: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
-0001dd70: 6253 6f75 7263 6553 7065 6328 7061 7468  bSourceSpec(path
-0001dd80: 3d22 2f6c 6f63 616c 2f70 6174 682f 746f  ="/local/path/to
-0001dd90: 2f73 6f75 7263 6522 2c20 6368 616e 6e65  /source", channe
-0001dda0: 6c3d 2264 6576 656c 6f70 6d65 6e74 2229  l="development")
-0001ddb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ddc0: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-0001ddd0: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
-0001dde0: 6372 6561 7465 5f68 7562 5f73 6f75 7263  create_hub_sourc
-0001ddf0: 6528 7072 6976 6174 655f 736f 7572 6365  e(private_source
-0001de00: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
-0001de10: 2041 6464 2061 6e6f 7468 6572 2073 6f75   Add another sou
-0001de20: 7263 6520 6173 2031 7374 2069 6e20 7468  rce as 1st in th
-0001de30: 6520 6c69 7374 202d 2077 696c 6c20 7075  e list - will pu
-0001de40: 7368 2070 7265 7669 6f75 7320 6f6e 6520  sh previous one 
-0001de50: 746f 2062 6520 2332 0a20 2020 2020 2020  to be #2.       
-0001de60: 2020 2020 2061 6e6f 7468 6572 5f73 6f75       another_sou
-0001de70: 7263 6520 3d20 6d6c 7275 6e2e 636f 6d6d  rce = mlrun.comm
-0001de80: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-0001de90: 6564 4875 6253 6f75 7263 6528 0a20 2020  edHubSource(.   
-0001dea0: 2020 2020 2020 2020 2020 2020 206f 7264               ord
-0001deb0: 6572 3d31 2c0a 2020 2020 2020 2020 2020  er=1,.          
-0001dec0: 2020 2020 2020 736f 7572 6365 3d6d 6c72        source=mlr
-0001ded0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001dee0: 732e 4875 6253 6f75 7263 6528 0a20 2020  s.HubSource(.   
-0001def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df00: 206d 6574 6164 6174 613d 6d6c 7275 6e2e   metadata=mlrun.
-0001df10: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-0001df20: 7562 4f62 6a65 6374 4d65 7461 6461 7461  ubObjectMetadata
-0001df30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001df40: 2020 2020 2020 2020 2020 6e61 6d65 3d22            name="
-0001df50: 7072 6976 2d32 222c 2064 6573 6372 6970  priv-2", descrip
-0001df60: 7469 6f6e 3d22 616e 6f74 6865 7220 736f  tion="another so
-0001df70: 7572 6365 220a 2020 2020 2020 2020 2020  urce".          
-0001df80: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0001df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dfa0: 2073 7065 633d 6d6c 7275 6e2e 636f 6d6d   spec=mlrun.comm
-0001dfb0: 6f6e 2e73 6368 656d 6173 2e48 7562 536f  on.schemas.HubSo
-0001dfc0: 7572 6365 5370 6563 280a 2020 2020 2020  urceSpec(.      
-0001dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dfe0: 2020 7061 7468 3d22 2f6c 6f63 616c 2f70    path="/local/p
-0001dff0: 6174 682f 746f 2f73 6f75 7263 652f 3222  ath/to/source/2"
-0001e000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e010: 2020 2020 2020 2020 2020 6368 616e 6e65            channe
-0001e020: 6c3d 2264 6576 656c 6f70 6d65 6e74 222c  l="development",
-0001e030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e040: 2020 2020 2020 2020 2063 7265 6465 6e74           credent
-0001e050: 6961 6c73 3d7b 2e2e 2e7d 0a20 2020 2020  ials={...}.     
-0001e060: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001e070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e080: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-0001e090: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
-0001e0a0: 6372 6561 7465 5f68 7562 5f73 6f75 7263  create_hub_sourc
-0001e0b0: 6528 616e 6f74 6865 725f 736f 7572 6365  e(another_source
-0001e0c0: 290a 0a20 2020 2020 2020 203a 7061 7261  )..        :para
-0001e0d0: 6d20 736f 7572 6365 3a20 5468 6520 736f  m source: The so
-0001e0e0: 7572 6365 2061 6e64 2069 7473 206f 7264  urce and its ord
-0001e0f0: 6572 2c20 6f66 2074 7970 650a 2020 2020  er, of type.    
-0001e100: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
-0001e110: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-0001e120: 2e73 6368 656d 6173 2e68 7562 2e49 6e64  .schemas.hub.Ind
-0001e130: 6578 6564 4875 6253 6f75 7263 6560 2c20  exedHubSource`, 
-0001e140: 6f72 2069 6e20 6469 6374 696f 6e61 7279  or in dictionary
-0001e150: 2066 6f72 6d2e 0a20 2020 2020 2020 203a   form..        :
-0001e160: 7265 7475 726e 733a 2054 6865 2073 6f75  returns: The sou
-0001e170: 7263 6520 6f62 6a65 6374 2061 7320 696e  rce object as in
-0001e180: 7365 7274 6564 2069 6e74 6f20 7468 6520  serted into the 
-0001e190: 6461 7461 6261 7365 2c20 7769 7468 2063  database, with c
-0001e1a0: 7265 6465 6e74 6961 6c73 2073 7472 6970  redentials strip
-0001e1b0: 7065 642e 0a20 2020 2020 2020 2022 2222  ped..        """
-0001e1c0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0001e1d0: 2268 7562 2f73 6f75 7263 6573 220a 2020  "hub/sources".  
-0001e1e0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001e1f0: 6e63 6528 736f 7572 6365 2c20 6d6c 7275  nce(source, mlru
-0001e200: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001e210: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
-0001e220: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0001e230: 736f 7572 6365 203d 2073 6f75 7263 652e  source = source.
-0001e240: 6469 6374 2829 0a20 2020 2020 2020 2072  dict().        r
-0001e250: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-0001e260: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
-0001e270: 504f 5354 222c 2070 6174 683d 7061 7468  POST", path=path
-0001e280: 2c20 6a73 6f6e 3d73 6f75 7263 6529 0a20  , json=source). 
-0001e290: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
-0001e2a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001e2b0: 6173 2e49 6e64 6578 6564 4875 6253 6f75  as.IndexedHubSou
-0001e2c0: 7263 6528 2a2a 7265 7370 6f6e 7365 2e6a  rce(**response.j
-0001e2d0: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
-0001e2e0: 7374 6f72 655f 6875 625f 736f 7572 6365  store_hub_source
-0001e2f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001e300: 2020 2020 2020 2020 736f 7572 6365 5f6e          source_n
-0001e310: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-0001e320: 2020 736f 7572 6365 3a20 556e 696f 6e5b    source: Union[
-0001e330: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
-0001e340: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-0001e350: 6564 4875 6253 6f75 7263 655d 2c0a 2020  edHubSource],.  
-0001e360: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0001e370: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
-0001e380: 6f72 2072 6570 6c61 6365 2061 2068 7562  or replace a hub
-0001e390: 2073 6f75 7263 652e 0a20 2020 2020 2020   source..       
-0001e3a0: 2046 6f72 2061 6e20 6578 616d 706c 6520   For an example 
-0001e3b0: 6f66 2074 6865 2073 6f75 7263 6520 666f  of the source fo
-0001e3c0: 726d 6174 2061 6e64 2065 7870 6c61 6e61  rmat and explana
-0001e3d0: 7469 6f6e 206f 6620 7468 6520 736f 7572  tion of the sour
-0001e3e0: 6365 206f 7264 6572 206c 6f67 6963 2c0a  ce order logic,.
-0001e3f0: 2020 2020 2020 2020 706c 6561 7365 2073          please s
-0001e400: 6565 203a 7079 3a66 756e 633a 607e 6372  ee :py:func:`~cr
-0001e410: 6561 7465 5f68 7562 5f73 6f75 7263 6560  eate_hub_source`
-0001e420: 2e20 5468 6973 206d 6574 686f 6420 6361  . This method ca
-0001e430: 6e20 6265 2075 7365 6420 746f 206d 6f64  n be used to mod
-0001e440: 6966 7920 7468 6520 736f 7572 6365 2069  ify the source i
-0001e450: 7473 656c 6620 6f72 2069 7473 0a20 2020  tself or its.   
-0001e460: 2020 2020 206f 7264 6572 2069 6e20 7468       order in th
-0001e470: 6520 6c69 7374 206f 6620 736f 7572 6365  e list of source
-0001e480: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-0001e490: 616d 2073 6f75 7263 655f 6e61 6d65 3a20  am source_name: 
-0001e4a0: 4e61 6d65 206f 6620 7468 6520 736f 7572  Name of the sour
-0001e4b0: 6365 206f 626a 6563 7420 746f 206d 6f64  ce object to mod
-0001e4c0: 6966 792f 6372 6561 7465 2e20 4974 206d  ify/create. It m
-0001e4d0: 7573 7420 6d61 7463 6820 7468 6520 6060  ust match the ``
-0001e4e0: 736f 7572 6365 2e6d 6574 6164 6174 612e  source.metadata.
-0001e4f0: 6e61 6d65 6060 0a20 2020 2020 2020 2020  name``.         
-0001e500: 2020 2070 6172 616d 6574 6572 2069 6e20     parameter in 
-0001e510: 7468 6520 736f 7572 6365 2069 7473 656c  the source itsel
-0001e520: 662e 0a20 2020 2020 2020 203a 7061 7261  f..        :para
-0001e530: 6d20 736f 7572 6365 3a20 536f 7572 6365  m source: Source
-0001e540: 206f 626a 6563 7420 746f 2073 746f 7265   object to store
-0001e550: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-0001e560: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0001e570: 6e73 3a20 5468 6520 736f 7572 6365 206f  ns: The source o
-0001e580: 626a 6563 7420 6173 2073 746f 7265 6420  bject as stored 
-0001e590: 696e 2074 6865 2044 422e 0a20 2020 2020  in the DB..     
-0001e5a0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-0001e5b0: 6174 6820 3d20 6622 6875 622f 736f 7572  ath = f"hub/sour
-0001e5c0: 6365 732f 7b73 6f75 7263 655f 6e61 6d65  ces/{source_name
-0001e5d0: 7d22 0a20 2020 2020 2020 2069 6620 6973  }".        if is
-0001e5e0: 696e 7374 616e 6365 2873 6f75 7263 652c  instance(source,
-0001e5f0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001e600: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
-0001e610: 536f 7572 6365 293a 0a20 2020 2020 2020  Source):.       
-0001e620: 2020 2020 2073 6f75 7263 6520 3d20 736f       source = so
-0001e630: 7572 6365 2e64 6963 7428 290a 0a20 2020  urce.dict()..   
-0001e640: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-0001e650: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
-0001e660: 7468 6f64 3d22 5055 5422 2c20 7061 7468  thod="PUT", path
-0001e670: 3d70 6174 682c 206a 736f 6e3d 736f 7572  =path, json=sour
-0001e680: 6365 290a 2020 2020 2020 2020 7265 7475  ce).        retu
-0001e690: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
-0001e6a0: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
-0001e6b0: 7562 536f 7572 6365 282a 2a72 6573 706f  ubSource(**respo
-0001e6c0: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
-0001e6d0: 2064 6566 206c 6973 745f 6875 625f 736f   def list_hub_so
-0001e6e0: 7572 6365 7328 7365 6c66 293a 0a20 2020  urces(self):.   
-0001e6f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001e700: 204c 6973 7420 6875 6220 736f 7572 6365   List hub source
-0001e710: 7320 696e 2074 6865 204d 4c52 756e 2044  s in the MLRun D
-0001e720: 422e 0a20 2020 2020 2020 2022 2222 0a20  B..        """. 
-0001e730: 2020 2020 2020 2070 6174 6820 3d20 2268         path = "h
-0001e740: 7562 2f73 6f75 7263 6573 220a 2020 2020  ub/sources".    
-0001e750: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0001e760: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
-0001e770: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
-0001e780: 7061 7468 292e 6a73 6f6e 2829 0a20 2020  path).json().   
-0001e790: 2020 2020 2072 6573 756c 7473 203d 205b       results = [
-0001e7a0: 5d0a 2020 2020 2020 2020 666f 7220 6974  ].        for it
-0001e7b0: 656d 2069 6e20 7265 7370 6f6e 7365 3a0a  em in response:.
-0001e7c0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0001e7d0: 6c74 732e 6170 7065 6e64 286d 6c72 756e  lts.append(mlrun
-0001e7e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001e7f0: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
-0001e800: 282a 2a69 7465 6d29 290a 2020 2020 2020  (**item)).      
-0001e810: 2020 7265 7475 726e 2072 6573 756c 7473    return results
-0001e820: 0a0a 2020 2020 6465 6620 6765 745f 6875  ..    def get_hu
-0001e830: 625f 736f 7572 6365 2873 656c 662c 2073  b_source(self, s
-0001e840: 6f75 7263 655f 6e61 6d65 3a20 7374 7229  ource_name: str)
-0001e850: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001e860: 2020 2020 2020 5265 7472 6965 7665 2061        Retrieve a
-0001e870: 2068 7562 2073 6f75 7263 6520 6672 6f6d   hub source from
-0001e880: 2074 6865 2044 422e 0a0a 2020 2020 2020   the DB...      
-0001e890: 2020 3a70 6172 616d 2073 6f75 7263 655f    :param source_
-0001e8a0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
-0001e8b0: 6520 6875 6220 736f 7572 6365 2074 6f20  e hub source to 
-0001e8c0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
-0001e8d0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-0001e8e0: 7468 203d 2066 2268 7562 2f73 6f75 7263  th = f"hub/sourc
-0001e8f0: 6573 2f7b 736f 7572 6365 5f6e 616d 657d  es/{source_name}
-0001e900: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
-0001e910: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
-0001e920: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
-0001e930: 2070 6174 683d 7061 7468 290a 2020 2020   path=path).    
-0001e940: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-0001e950: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001e960: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
-0001e970: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-0001e980: 2829 290a 0a20 2020 2064 6566 2064 656c  ())..    def del
-0001e990: 6574 655f 6875 625f 736f 7572 6365 2873  ete_hub_source(s
-0001e9a0: 656c 662c 2073 6f75 7263 655f 6e61 6d65  elf, source_name
-0001e9b0: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
-0001e9c0: 2222 220a 2020 2020 2020 2020 4465 6c65  """.        Dele
-0001e9d0: 7465 2061 2068 7562 2073 6f75 7263 6520  te a hub source 
-0001e9e0: 6672 6f6d 2074 6865 2044 422e 0a20 2020  from the DB..   
-0001e9f0: 2020 2020 2054 6865 2073 6f75 7263 6520       The source 
-0001ea00: 7769 6c6c 2062 6520 6465 6c65 7465 6420  will be deleted 
-0001ea10: 6672 6f6d 2074 6865 206c 6973 742c 2061  from the list, a
-0001ea20: 6e64 2061 6e79 2066 6f6c 6c6f 7769 6e67  nd any following
-0001ea30: 2073 6f75 7263 6573 2077 696c 6c20 6265   sources will be
-0001ea40: 2070 726f 6d6f 7465 6420 2d20 666f 7220   promoted - for 
-0001ea50: 6578 616d 706c 652c 2069 6620 7468 650a  example, if the.
-0001ea60: 2020 2020 2020 2020 3173 7420 736f 7572          1st sour
-0001ea70: 6365 2069 7320 6465 6c65 7465 642c 2074  ce is deleted, t
-0001ea80: 6865 2032 6e64 2073 6f75 7263 6520 7769  he 2nd source wi
-0001ea90: 6c6c 2062 6563 6f6d 6520 2331 2069 6e20  ll become #1 in 
-0001eaa0: 7468 6520 6c69 7374 2e0a 2020 2020 2020  the list..      
-0001eab0: 2020 5468 6520 676c 6f62 616c 2068 7562    The global hub
-0001eac0: 2073 6f75 7263 6520 6361 6e6e 6f74 2062   source cannot b
-0001ead0: 6520 6465 6c65 7465 642e 0a0a 2020 2020  e deleted...    
-0001eae0: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
-0001eaf0: 655f 6e61 6d65 3a20 4e61 6d65 206f 6620  e_name: Name of 
-0001eb00: 7468 6520 6875 6220 736f 7572 6365 2074  the hub source t
-0001eb10: 6f20 6465 6c65 7465 2e0a 2020 2020 2020  o delete..      
-0001eb20: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-0001eb30: 7468 203d 2066 2268 7562 2f73 6f75 7263  th = f"hub/sourc
-0001eb40: 6573 2f7b 736f 7572 6365 5f6e 616d 657d  es/{source_name}
-0001eb50: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0001eb60: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
-0001eb70: 4445 4c45 5445 222c 2070 6174 683d 7061  DELETE", path=pa
-0001eb80: 7468 290a 0a20 2020 2064 6566 2067 6574  th)..    def get
-0001eb90: 5f68 7562 5f63 6174 616c 6f67 280a 2020  _hub_catalog(.  
-0001eba0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001ebb0: 2020 2020 736f 7572 6365 5f6e 616d 653a      source_name:
-0001ebc0: 2073 7472 2c0a 2020 2020 2020 2020 7665   str,.        ve
-0001ebd0: 7273 696f 6e3a 2073 7472 203d 204e 6f6e  rsion: str = Non
-0001ebe0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
-0001ebf0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-0001ec00: 2020 2020 666f 7263 655f 7265 6672 6573      force_refres
-0001ec10: 683a 2062 6f6f 6c20 3d20 4661 6c73 652c  h: bool = False,
-0001ec20: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001ec30: 2222 220a 2020 2020 2020 2020 5265 7472  """.        Retr
-0001ec40: 6965 7665 2074 6865 2069 7465 6d20 6361  ieve the item ca
-0001ec50: 7461 6c6f 6720 666f 7220 6120 7370 6563  talog for a spec
-0001ec60: 6966 6965 6420 6875 6220 736f 7572 6365  ified hub source
-0001ec70: 2e0a 2020 2020 2020 2020 5468 6520 6c69  ..        The li
-0001ec80: 7374 206f 6620 6974 656d 7320 6361 6e20  st of items can 
-0001ec90: 6265 2066 696c 7465 7265 6420 6163 636f  be filtered acco
-0001eca0: 7264 696e 6720 746f 2076 6172 696f 7573  rding to various
-0001ecb0: 2066 696c 7465 7273 2c20 7573 696e 6720   filters, using 
-0001ecc0: 6974 656d 2773 206d 6574 6164 6174 6120  item's metadata 
-0001ecd0: 746f 2066 696c 7465 722e 0a0a 2020 2020  to filter...    
-0001ece0: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
-0001ecf0: 655f 6e61 6d65 3a20 4e61 6d65 206f 6620  e_name: Name of 
-0001ed00: 7468 6520 736f 7572 6365 2e0a 2020 2020  the source..    
-0001ed10: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
-0001ed20: 6f6e 3a20 4669 6c74 6572 2069 7465 6d73  on: Filter items
-0001ed30: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-0001ed40: 6569 7220 7665 7273 696f 6e2e 0a20 2020  eir version..   
-0001ed50: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
-0001ed60: 2046 696c 7465 7220 6974 656d 7320 6261   Filter items ba
-0001ed70: 7365 6420 6f6e 2074 6167 2e0a 2020 2020  sed on tag..    
-0001ed80: 2020 2020 3a70 6172 616d 2066 6f72 6365      :param force
-0001ed90: 5f72 6566 7265 7368 3a20 4d61 6b65 2074  _refresh: Make t
-0001eda0: 6865 2073 6572 7665 7220 6665 7463 6820  he server fetch 
-0001edb0: 7468 6520 6361 7461 6c6f 6720 6672 6f6d  the catalog from
-0001edc0: 2074 6865 2061 6374 7561 6c20 6875 6220   the actual hub 
-0001edd0: 736f 7572 6365 2c0a 2020 2020 2020 2020  source,.        
-0001ede0: 2020 2020 7261 7468 6572 2074 6861 6e20      rather than 
-0001edf0: 7265 6c79 206f 6e20 6361 6368 6564 2069  rely on cached i
-0001ee00: 6e66 6f72 6d61 7469 6f6e 2077 6869 6368  nformation which
-0001ee10: 206d 6179 2065 7869 7374 2066 726f 6d20   may exist from 
-0001ee20: 7072 6576 696f 7573 2067 6574 2072 6571  previous get req
-0001ee30: 7565 7374 732e 2046 6f72 2065 7861 6d70  uests. For examp
-0001ee40: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0001ee50: 6966 2074 6865 2073 6f75 7263 6520 7761  if the source wa
-0001ee60: 7320 7265 2d62 7569 6c74 2c0a 2020 2020  s re-built,.    
-0001ee70: 2020 2020 2020 2020 7468 6973 2077 696c          this wil
-0001ee80: 6c20 6d61 6b65 2074 6865 2073 6572 7665  l make the serve
-0001ee90: 7220 6765 7420 7468 6520 7570 6461 7465  r get the update
-0001eea0: 6420 696e 666f 726d 6174 696f 6e2e 2044  d information. D
-0001eeb0: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
-0001eec0: 6560 602e 0a20 2020 2020 2020 203a 7265  e``..        :re
-0001eed0: 7475 726e 733a 203a 7079 3a63 6c61 7373  turns: :py:class
-0001eee0: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-0001eef0: 7363 6865 6d61 732e 6875 622e 4875 6243  schemas.hub.HubC
-0001ef00: 6174 616c 6f67 6020 6f62 6a65 6374 2c20  atalog` object, 
-0001ef10: 7768 6963 6820 6973 2065 7373 656e 7469  which is essenti
-0001ef20: 616c 6c79 2061 206c 6973 740a 2020 2020  ally a list.    
-0001ef30: 2020 2020 2020 2020 6f66 203a 7079 3a63          of :py:c
-0001ef40: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
-0001ef50: 6d6f 6e2e 7363 6865 6d61 732e 6875 622e  mon.schemas.hub.
-0001ef60: 4875 6249 7465 6d60 2065 6e74 7269 6573  HubItem` entries
-0001ef70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001ef80: 2020 2020 2020 7061 7468 203d 2028 6622        path = (f"
-0001ef90: 6875 622f 736f 7572 6365 732f 7b73 6f75  hub/sources/{sou
-0001efa0: 7263 655f 6e61 6d65 7d2f 6974 656d 7322  rce_name}/items"
-0001efb0: 2c29 0a20 2020 2020 2020 2070 6172 616d  ,).        param
-0001efc0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0001efd0: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
-0001efe0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001eff0: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
-0001f000: 2020 2020 2020 2020 2020 2266 6f72 6365            "force
-0001f010: 2d72 6566 7265 7368 223a 2066 6f72 6365  -refresh": force
-0001f020: 5f72 6566 7265 7368 2c0a 2020 2020 2020  _refresh,.      
-0001f030: 2020 7d0a 2020 2020 2020 2020 7265 7370    }.        resp
-0001f040: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0001f050: 6361 6c6c 286d 6574 686f 643d 2247 4554  call(method="GET
-0001f060: 222c 2070 6174 683d 7061 7468 2c20 7061  ", path=path, pa
-0001f070: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0001f080: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0001f090: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001f0a0: 2e48 7562 4361 7461 6c6f 6728 2a2a 7265  .HubCatalog(**re
-0001f0b0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-0001f0c0: 2020 2020 6465 6620 6765 745f 6875 625f      def get_hub_
-0001f0d0: 6974 656d 280a 2020 2020 2020 2020 7365  item(.        se
-0001f0e0: 6c66 2c0a 2020 2020 2020 2020 736f 7572  lf,.        sour
-0001f0f0: 6365 5f6e 616d 653a 2073 7472 2c0a 2020  ce_name: str,.  
-0001f100: 2020 2020 2020 6974 656d 5f6e 616d 653a        item_name:
-0001f110: 2073 7472 2c0a 2020 2020 2020 2020 7665   str,.        ve
-0001f120: 7273 696f 6e3a 2073 7472 203d 204e 6f6e  rsion: str = Non
-0001f130: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
-0001f140: 7374 7220 3d20 226c 6174 6573 7422 2c0a  str = "latest",.
-0001f150: 2020 2020 2020 2020 666f 7263 655f 7265          force_re
-0001f160: 6672 6573 683a 2062 6f6f 6c20 3d20 4661  fresh: bool = Fa
-0001f170: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-0001f180: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f190: 5265 7472 6965 7665 2061 2073 7065 6369  Retrieve a speci
-0001f1a0: 6669 6320 6875 6220 6974 656d 2e0a 0a20  fic hub item... 
-0001f1b0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
-0001f1c0: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
-0001f1d0: 6f66 2073 6f75 7263 652e 0a20 2020 2020  of source..     
-0001f1e0: 2020 203a 7061 7261 6d20 6974 656d 5f6e     :param item_n
-0001f1f0: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-0001f200: 2069 7465 6d20 746f 2072 6574 7269 6576   item to retriev
-0001f210: 652c 2061 7320 6974 2061 7070 6561 7273  e, as it appears
-0001f220: 2069 6e20 7468 6520 6361 7461 6c6f 672e   in the catalog.
-0001f230: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f240: 7665 7273 696f 6e3a 2047 6574 2061 2073  version: Get a s
-0001f250: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
-0001f260: 6f66 2074 6865 2069 7465 6d2e 2044 6566  of the item. Def
-0001f270: 6175 6c74 2069 7320 6060 4e6f 6e65 6060  ault is ``None``
-0001f280: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001f290: 2074 6167 3a20 4765 7420 6120 7370 6563   tag: Get a spec
-0001f2a0: 6966 6963 2076 6572 7369 6f6e 206f 6620  ific version of 
-0001f2b0: 7468 6520 6974 656d 2069 6465 6e74 6966  the item identif
-0001f2c0: 6965 6420 6279 2074 6167 2e20 4465 6661  ied by tag. Defa
-0001f2d0: 756c 7420 6973 2060 606c 6174 6573 7460  ult is ``latest`
-0001f2e0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-0001f2f0: 6d20 666f 7263 655f 7265 6672 6573 683a  m force_refresh:
-0001f300: 204d 616b 6520 7468 6520 7365 7276 6572   Make the server
-0001f310: 2066 6574 6368 2074 6865 2069 6e66 6f72   fetch the infor
-0001f320: 6d61 7469 6f6e 2066 726f 6d20 7468 6520  mation from the 
-0001f330: 6163 7475 616c 2068 7562 0a20 2020 2020  actual hub.     
-0001f340: 2020 2020 2020 2073 6f75 7263 652c 2072         source, r
-0001f350: 6174 6865 7220 7468 616e 0a20 2020 2020  ather than.     
-0001f360: 2020 2020 2020 2072 656c 7920 6f6e 2063         rely on c
-0001f370: 6163 6865 6420 696e 666f 726d 6174 696f  ached informatio
-0001f380: 6e2e 2044 6566 6175 6c74 2069 7320 6060  n. Default is ``
-0001f390: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
-0001f3a0: 203a 7265 7475 726e 733a 203a 7079 3a63   :returns: :py:c
-0001f3b0: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
-0001f3c0: 6d6f 6e2e 7363 6865 6d61 732e 6875 622e  mon.schemas.hub.
-0001f3d0: 4875 6249 7465 6d60 2e0a 2020 2020 2020  HubItem`..      
-0001f3e0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-0001f3f0: 7468 203d 2028 6622 6875 622f 736f 7572  th = (f"hub/sour
-0001f400: 6365 732f 7b73 6f75 7263 655f 6e61 6d65  ces/{source_name
-0001f410: 7d2f 6974 656d 732f 7b69 7465 6d5f 6e61  }/items/{item_na
-0001f420: 6d65 7d22 2c29 0a20 2020 2020 2020 2070  me}",).        p
-0001f430: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-0001f440: 2020 2020 2020 2276 6572 7369 6f6e 223a        "version":
-0001f450: 2076 6572 7369 6f6e 2c0a 2020 2020 2020   version,.      
-0001f460: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
-0001f470: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-0001f480: 6f72 6365 2d72 6566 7265 7368 223a 2066  orce-refresh": f
-0001f490: 6f72 6365 5f72 6566 7265 7368 2c0a 2020  orce_refresh,.  
-0001f4a0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001f4b0: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-0001f4c0: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
-0001f4d0: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
-0001f4e0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-0001f4f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001f500: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001f510: 656d 6173 2e48 7562 4974 656d 282a 2a72  emas.HubItem(**r
-0001f520: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-0001f530: 0a20 2020 2064 6566 2067 6574 5f68 7562  .    def get_hub
-0001f540: 5f61 7373 6574 280a 2020 2020 2020 2020  _asset(.        
-0001f550: 7365 6c66 2c0a 2020 2020 2020 2020 736f  self,.        so
-0001f560: 7572 6365 5f6e 616d 653a 2073 7472 2c0a  urce_name: str,.
-0001f570: 2020 2020 2020 2020 6974 656d 5f6e 616d          item_nam
-0001f580: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
-0001f590: 6173 7365 745f 6e61 6d65 3a20 7374 722c  asset_name: str,
-0001f5a0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-0001f5b0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0001f5c0: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
-0001f5d0: 2022 6c61 7465 7374 222c 0a20 2020 2029   "latest",.    )
-0001f5e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001f5f0: 2020 2020 2020 4765 7420 6875 6220 6173        Get hub as
-0001f600: 7365 7420 6672 6f6d 2069 7465 6d2e 0a0a  set from item...
-0001f610: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001f620: 6f75 7263 655f 6e61 6d65 3a20 4e61 6d65  ource_name: Name
-0001f630: 206f 6620 736f 7572 6365 2e0a 2020 2020   of source..    
-0001f640: 2020 2020 3a70 6172 616d 2069 7465 6d5f      :param item_
-0001f650: 6e61 6d65 3a20 2020 4e61 6d65 206f 6620  name:   Name of 
-0001f660: 7468 6520 6974 656d 2077 6869 6368 2068  the item which h
-0001f670: 6f6c 6473 2074 6865 2061 7373 6574 2e0a  olds the asset..
-0001f680: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-0001f690: 7373 6574 5f6e 616d 653a 2020 4e61 6d65  sset_name:  Name
-0001f6a0: 206f 6620 7468 6520 6173 7365 7420 746f   of the asset to
-0001f6b0: 2072 6574 7269 6576 652e 0a20 2020 2020   retrieve..     
-0001f6c0: 2020 203a 7061 7261 6d20 7665 7273 696f     :param versio
-0001f6d0: 6e3a 2047 6574 2061 2073 7065 6369 6669  n: Get a specifi
-0001f6e0: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
-0001f6f0: 2069 7465 6d2e 2044 6566 6175 6c74 2069   item. Default i
-0001f700: 7320 6060 4e6f 6e65 6060 2e0a 2020 2020  s ``None``..    
-0001f710: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-0001f720: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
-0001f730: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
-0001f740: 656d 2069 6465 6e74 6966 6965 6420 6279  em identified by
-0001f750: 2074 6167 2e20 4465 6661 756c 7420 6973   tag. Default is
-0001f760: 2060 606c 6174 6573 7460 602e 0a0a 2020   ``latest``...  
-0001f770: 2020 2020 2020 3a72 6574 7572 6e3a 2068        :return: h
-0001f780: 7474 7020 7265 7370 6f6e 7365 2077 6974  ttp response wit
-0001f790: 6820 7468 6520 6173 7365 7420 696e 2074  h the asset in t
-0001f7a0: 6865 2063 6f6e 7465 6e74 2061 7474 7269  he content attri
-0001f7b0: 6275 7465 0a20 2020 2020 2020 2022 2222  bute.        """
-0001f7c0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0001f7d0: 2866 2268 7562 2f73 6f75 7263 6573 2f7b  (f"hub/sources/{
-0001f7e0: 736f 7572 6365 5f6e 616d 657d 2f69 7465  source_name}/ite
-0001f7f0: 6d73 2f7b 6974 656d 5f6e 616d 657d 2f61  ms/{item_name}/a
-0001f800: 7373 6574 732f 7b61 7373 6574 5f6e 616d  ssets/{asset_nam
-0001f810: 657d 222c 290a 2020 2020 2020 2020 7061  e}",).        pa
-0001f820: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0001f830: 2020 2020 2022 7665 7273 696f 6e22 3a20       "version": 
-0001f840: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-0001f850: 2020 2020 2022 7461 6722 3a20 7461 672c       "tag": tag,
-0001f860: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001f870: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-0001f880: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-0001f890: 6f64 3d22 4745 5422 2c20 7061 7468 3d70  od="GET", path=p
-0001f8a0: 6174 682c 2070 6172 616d 733d 7061 7261  ath, params=para
-0001f8b0: 6d73 290a 2020 2020 2020 2020 7265 7475  ms).        retu
-0001f8c0: 726e 2072 6573 706f 6e73 650a 0a20 2020  rn response..   
-0001f8d0: 2064 6566 2076 6572 6966 795f 6175 7468   def verify_auth
-0001f8e0: 6f72 697a 6174 696f 6e28 0a20 2020 2020  orization(.     
-0001f8f0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001f900: 2061 7574 686f 7269 7a61 7469 6f6e 5f76   authorization_v
-0001f910: 6572 6966 6963 6174 696f 6e5f 696e 7075  erification_inpu
-0001f920: 743a 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t: mlrun.common.
-0001f930: 7363 6865 6d61 732e 4175 7468 6f72 697a  schemas.Authoriz
-0001f940: 6174 696f 6e56 6572 6966 6963 6174 696f  ationVerificatio
-0001f950: 6e49 6e70 7574 2c0a 2020 2020 293a 0a20  nInput,.    ):. 
-0001f960: 2020 2020 2020 2022 2222 5665 7269 6669         """Verifi
-0001f970: 6573 2061 7574 686f 7269 7a61 7469 6f6e  es authorization
-0001f980: 2066 6f72 2074 6865 2070 726f 7669 6465   for the provide
-0001f990: 6420 6163 7469 6f6e 206f 6e20 7468 6520  d action on the 
-0001f9a0: 7072 6f76 6964 6564 2072 6573 6f75 7263  provided resourc
-0001f9b0: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-0001f9c0: 616d 2061 7574 686f 7269 7a61 7469 6f6e  am authorization
-0001f9d0: 5f76 6572 6966 6963 6174 696f 6e5f 696e  _verification_in
-0001f9e0: 7075 743a 2049 6e73 7461 6e63 6520 6f66  put: Instance of
-0001f9f0: 0a20 2020 2020 2020 2020 2020 203a 7079  .            :py
-0001fa00: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
-0001fa10: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4175  ommon.schemas.Au
-0001fa20: 7468 6f72 697a 6174 696f 6e56 6572 6966  thorizationVerif
-0001fa30: 6963 6174 696f 6e49 6e70 7574 6020 7468  icationInput` th
-0001fa40: 6174 2069 6e63 6c75 6465 7320 616c 6c20  at includes all 
-0001fa50: 7468 6520 6e65 6564 6564 2070 6172 616d  the needed param
-0001fa60: 6574 6572 7320 666f 720a 2020 2020 2020  eters for.      
-0001fa70: 2020 2020 2020 7468 6520 6175 7468 2076        the auth v
-0001fa80: 6572 6966 6963 6174 696f 6e0a 2020 2020  erification.    
-0001fa90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001faa0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-0001fab0: 2241 7574 686f 7269 7a61 7469 6f6e 2063  "Authorization c
-0001fac0: 6865 636b 2066 6169 6c65 6422 0a20 2020  heck failed".   
-0001fad0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0001fae0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0001faf0: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
-0001fb00: 2020 2020 2261 7574 686f 7269 7a61 7469      "authorizati
-0001fb10: 6f6e 2f76 6572 6966 6963 6174 696f 6e73  on/verifications
-0001fb20: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
-0001fb30: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-0001fb40: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-0001fb50: 6963 745f 746f 5f6a 736f 6e28 6175 7468  ict_to_json(auth
-0001fb60: 6f72 697a 6174 696f 6e5f 7665 7269 6669  orization_verifi
-0001fb70: 6361 7469 6f6e 5f69 6e70 7574 2e64 6963  cation_input.dic
-0001fb80: 7428 2929 2c0a 2020 2020 2020 2020 290a  t()),.        ).
-0001fb90: 0a20 2020 2064 6566 2074 7269 6767 6572  .    def trigger
-0001fba0: 5f6d 6967 7261 7469 6f6e 7328 7365 6c66  _migrations(self
-0001fbb0: 2920 2d3e 204f 7074 696f 6e61 6c5b 6d6c  ) -> Optional[ml
-0001fbc0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001fbd0: 6173 2e42 6163 6b67 726f 756e 6454 6173  as.BackgroundTas
-0001fbe0: 6b5d 3a0a 2020 2020 2020 2020 2222 2254  k]:.        """T
-0001fbf0: 7269 6767 6572 206d 6967 7261 7469 6f6e  rigger migration
-0001fc00: 7320 2877 696c 6c20 646f 206e 6f74 6869  s (will do nothi
-0001fc10: 6e67 2069 6620 6e6f 206d 6967 7261 7469  ng if no migrati
-0001fc20: 6f6e 7320 6172 6520 6e65 6564 6564 2920  ons are needed) 
-0001fc30: 616e 6420 7761 6974 2066 6f72 2074 6865  and wait for the
-0001fc40: 6d20 746f 2066 696e 6973 6820 6966 2061  m to finish if a
-0001fc50: 6374 7561 6c6c 790a 2020 2020 2020 2020  ctually.        
-0001fc60: 7472 6967 6765 7265 640a 2020 2020 2020  triggered.      
-0001fc70: 2020 3a72 6574 7572 6e73 3a20 3a70 793a    :returns: :py:
-0001fc80: 636c 6173 733a 607e 6d6c 7275 6e2e 636f  class:`~mlrun.co
-0001fc90: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-0001fca0: 6b67 726f 756e 6454 6173 6b60 2e0a 2020  kgroundTask`..  
-0001fcb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001fcc0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-0001fcd0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-0001fce0: 2020 2020 2020 2020 2250 4f53 5422 2c0a          "POST",.
-0001fcf0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-0001fd00: 7261 7469 6f6e 732f 6d69 6772 6174 696f  rations/migratio
-0001fd10: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
-0001fd20: 2022 4661 696c 6564 2074 7269 6767 6572   "Failed trigger
-0001fd30: 696e 6720 6d69 6772 6174 696f 6e73 222c  ing migrations",
-0001fd40: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001fd50: 2020 2069 6620 7265 7370 6f6e 7365 2e73     if response.s
-0001fd60: 7461 7475 735f 636f 6465 203d 3d20 6874  tatus_code == ht
-0001fd70: 7470 2e48 5454 5053 7461 7475 732e 4143  tp.HTTPStatus.AC
-0001fd80: 4345 5054 4544 3a0a 2020 2020 2020 2020  CEPTED:.        
-0001fd90: 2020 2020 6261 636b 6772 6f75 6e64 5f74      background_t
-0001fda0: 6173 6b20 3d20 6d6c 7275 6e2e 636f 6d6d  ask = mlrun.comm
-0001fdb0: 6f6e 2e73 6368 656d 6173 2e42 6163 6b67  on.schemas.Backg
-0001fdc0: 726f 756e 6454 6173 6b28 2a2a 7265 7370  roundTask(**resp
-0001fdd0: 6f6e 7365 2e6a 736f 6e28 2929 0a20 2020  onse.json()).   
-0001fde0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001fdf0: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f62  self._wait_for_b
-0001fe00: 6163 6b67 726f 756e 645f 7461 736b 5f74  ackground_task_t
-0001fe10: 6f5f 7265 6163 685f 7465 726d 696e 616c  o_reach_terminal
-0001fe20: 5f73 7461 7465 280a 2020 2020 2020 2020  _state(.        
-0001fe30: 2020 2020 2020 2020 6261 636b 6772 6f75          backgrou
-0001fe40: 6e64 5f74 6173 6b2e 6d65 7461 6461 7461  nd_task.metadata
-0001fe50: 2e6e 616d 650a 2020 2020 2020 2020 2020  .name.          
-0001fe60: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0001fe70: 726e 204e 6f6e 650a 0a0a 6465 6620 5f61  rn None...def _a
-0001fe80: 735f 6a73 6f6e 286f 626a 293a 0a20 2020  s_json(obj):.   
-0001fe90: 2066 6e20 3d20 6765 7461 7474 7228 6f62   fn = getattr(ob
-0001fea0: 6a2c 2022 746f 5f6a 736f 6e22 2c20 4e6f  j, "to_json", No
-0001feb0: 6e65 290a 2020 2020 6966 2066 6e3a 0a20  ne).    if fn:. 
-0001fec0: 2020 2020 2020 2072 6574 7572 6e20 666e         return fn
-0001fed0: 2829 0a20 2020 2072 6574 7572 6e20 6469  ().    return di
-0001fee0: 6374 5f74 6f5f 6a73 6f6e 286f 626a 290a  ct_to_json(obj).
+0001d4a0: 2020 2020 2020 2020 276b 6c64 5f73 756d          'kld_sum
+0001d4b0: 273a 2032 342e 322c 0a20 2020 2020 2020  ': 24.2,.       
+0001d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4e0: 2020 2020 2020 2020 2020 276b 6c64 5f6d            'kld_m
+0001d4f0: 6561 6e27 3a20 362e 302c 0a20 2020 2020  ean': 6.0,.     
+0001d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d520: 2020 2020 2020 2020 2020 2020 2766 3127              'f1'
+0001d530: 3a20 7b27 7476 6427 3a20 302e 352c 2027  : {'tvd': 0.5, '
+0001d540: 6865 6c6c 696e 6765 7227 3a20 312e 302c  hellinger': 1.0,
+0001d550: 2027 6b6c 6427 3a20 362e 347d 2c0a 2020   'kld': 6.4},.  
+0001d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d580: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001d590: 6632 273a 207b 2774 7664 273a 2030 2e35  f2': {'tvd': 0.5
+0001d5a0: 2c20 2768 656c 6c69 6e67 6572 273a 2031  , 'hellinger': 1
+0001d5b0: 2e30 2c20 276b 6c64 273a 2036 2e35 7d7d  .0, 'kld': 6.5}}
+0001d5c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5e0: 2020 2320 4372 6561 7465 2061 7474 7269    # Create attri
+0001d5f0: 6275 7465 7320 6469 6374 696f 6e61 7279  butes dictionary
+0001d600: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+0001d610: 6520 7265 7175 6972 6564 2066 6f72 6d61  e required forma
+0001d620: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0001d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d640: 2020 6174 7472 6962 7574 6573 203d 207b    attributes = {
+0001d650: 6063 7572 7265 6e74 5f73 7461 7473 603a  `current_stats`:
+0001d660: 206a 736f 6e2e 6475 6d70 7328 6375 7272   json.dumps(curr
+0001d670: 656e 745f 7374 6174 7329 2c0a 2020 2020  ent_stats),.    
+0001d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6a0: 2020 2020 2020 2020 2020 6064 7269 6674            `drift
+0001d6b0: 5f73 7461 7475 7360 3a20 2244 5249 4654  _status`: "DRIFT
+0001d6c0: 5f44 4554 4543 5445 4422 7d0a 0a20 2020  _DETECTED"}..   
+0001d6d0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0001d6e0: 2020 6174 7472 6962 7574 6573 203d 207b    attributes = {
+0001d6f0: 2261 7474 7269 6275 7465 7322 3a20 5f61  "attributes": _a
+0001d700: 735f 6a73 6f6e 2861 7474 7269 6275 7465  s_json(attribute
+0001d710: 7329 7d0a 2020 2020 2020 2020 7061 7468  s)}.        path
+0001d720: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001d730: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001d740: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
+0001d750: 745f 6964 7d22 0a20 2020 2020 2020 2073  t_id}".        s
+0001d760: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001d770: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001d780: 3d22 5041 5443 4822 2c0a 2020 2020 2020  ="PATCH",.      
+0001d790: 2020 2020 2020 7061 7468 3d70 6174 682c        path=path,
+0001d7a0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0001d7b0: 616d 733d 6174 7472 6962 7574 6573 2c0a  ams=attributes,.
+0001d7c0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001d7d0: 6566 2063 7265 6174 655f 6875 625f 736f  ef create_hub_so
+0001d7e0: 7572 6365 280a 2020 2020 2020 2020 7365  urce(.        se
+0001d7f0: 6c66 2c20 736f 7572 6365 3a20 556e 696f  lf, source: Unio
+0001d800: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+0001d810: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
+0001d820: 6578 6564 4875 6253 6f75 7263 655d 0a20  exedHubSource]. 
+0001d830: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0001d840: 220a 2020 2020 2020 2020 4164 6420 6120  ".        Add a 
+0001d850: 6e65 7720 6875 6220 736f 7572 6365 2e0a  new hub source..
+0001d860: 0a20 2020 2020 2020 204d 4c52 756e 206d  .        MLRun m
+0001d870: 6169 6e74 6169 6e73 2061 6e20 6f72 6465  aintains an orde
+0001d880: 7265 6420 6c69 7374 206f 6620 6875 6220  red list of hub 
+0001d890: 736f 7572 6365 7320 28e2 809c 736f 7572  sources (...sour
+0001d8a0: 6365 73e2 809d 2920 4561 6368 2073 6f75  ces...) Each sou
+0001d8b0: 7263 6520 6861 730a 2020 2020 2020 2020  rce has.        
+0001d8c0: 6974 7320 6465 7461 696c 7320 7265 6769  its details regi
+0001d8d0: 7374 6572 6564 2061 6e64 2069 7473 206f  stered and its o
+0001d8e0: 7264 6572 2077 6974 6869 6e20 7468 6520  rder within the 
+0001d8f0: 6c69 7374 2e20 5768 656e 2063 7265 6174  list. When creat
+0001d900: 696e 6720 6120 6e65 7720 736f 7572 6365  ing a new source
+0001d910: 2c20 7468 6520 7370 6563 6961 6c20 6f72  , the special or
+0001d920: 6465 7220 6060 2d31 6060 0a20 2020 2020  der ``-1``.     
+0001d930: 2020 2063 616e 2062 6520 7573 6564 2074     can be used t
+0001d940: 6f20 6d61 726b 2074 6869 7320 736f 7572  o mark this sour
+0001d950: 6365 2061 7320 6c61 7374 2069 6e20 7468  ce as last in th
+0001d960: 6520 6c69 7374 2e20 486f 7765 7665 722c  e list. However,
+0001d970: 206f 6e63 6520 7468 6520 736f 7572 6365   once the source
+0001d980: 2069 7320 696e 2074 6865 204d 4c52 756e   is in the MLRun
+0001d990: 206c 6973 742c 0a20 2020 2020 2020 2069   list,.        i
+0001d9a0: 7473 206f 7264 6572 2077 696c 6c20 616c  ts order will al
+0001d9b0: 7761 7973 2062 6520 6060 3e30 6060 2e0a  ways be ``>0``..
+0001d9c0: 0a20 2020 2020 2020 2054 6865 2067 6c6f  .        The glo
+0001d9d0: 6261 6c20 6875 6220 736f 7572 6365 2061  bal hub source a
+0001d9e0: 6c77 6179 7320 6578 6973 7473 2069 6e20  lways exists in 
+0001d9f0: 7468 6520 6c69 7374 2c20 616e 6420 6973  the list, and is
+0001da00: 2061 6c77 6179 7320 7468 6520 6c61 7374   always the last
+0001da10: 2073 6f75 7263 650a 2020 2020 2020 2020   source.        
+0001da20: 2860 606f 7264 6572 203d 202d 3160 6029  (``order = -1``)
+0001da30: 2e20 4974 2063 616e 6e6f 7420 6265 206d  . It cannot be m
+0001da40: 6f64 6966 6965 6420 6e6f 7220 6361 6e20  odified nor can 
+0001da50: 6974 2062 6520 6d6f 7665 6420 746f 2061  it be moved to a
+0001da60: 6e6f 7468 6572 206f 7264 6572 2069 6e20  nother order in 
+0001da70: 7468 6520 6c69 7374 2e0a 0a20 2020 2020  the list...     
+0001da80: 2020 2054 6865 2073 6f75 7263 6520 6f62     The source ob
+0001da90: 6a65 6374 206d 6179 2063 6f6e 7461 696e  ject may contain
+0001daa0: 2063 7265 6465 6e74 6961 6c73 2077 6869   credentials whi
+0001dab0: 6368 2061 7265 206e 6565 6465 6420 746f  ch are needed to
+0001dac0: 2061 6363 6573 7320 7468 6520 6461 7461   access the data
+0001dad0: 7374 6f72 6520 7768 6572 6520 7468 6520  store where the 
+0001dae0: 736f 7572 6365 2069 7320 7374 6f72 6564  source is stored
+0001daf0: 2e0a 2020 2020 2020 2020 5468 6573 6520  ..        These 
+0001db00: 6372 6564 656e 7469 616c 7320 6172 6520  credentials are 
+0001db10: 6e6f 7420 6b65 7074 2069 6e20 7468 6520  not kept in the 
+0001db20: 4d4c 5275 6e20 4442 2c20 6275 7420 6172  MLRun DB, but ar
+0001db30: 6520 7374 6f72 6564 2069 6e73 6964 6520  e stored inside 
+0001db40: 6120 6b75 6265 726e 6574 6573 2073 6563  a kubernetes sec
+0001db50: 7265 7420 6f62 6a65 6374 206d 6169 6e74  ret object maint
+0001db60: 6169 6e65 6420 6279 0a20 2020 2020 2020  ained by.       
+0001db70: 204d 4c52 756e 2e20 5468 6579 2061 7265   MLRun. They are
+0001db80: 206e 6f74 2072 6574 7572 6e65 6420 7468   not returned th
+0001db90: 726f 7567 6820 616e 7920 4150 4920 6672  rough any API fr
+0001dba0: 6f6d 204d 4c52 756e 2e0a 0a20 2020 2020  om MLRun...     
+0001dbb0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0001dbc0: 2020 2020 2020 2020 2020 696d 706f 7274            import
+0001dbd0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001dbe0: 6865 6d61 730a 0a20 2020 2020 2020 2020  hemas..         
+0001dbf0: 2020 2023 2041 6464 2061 2070 7269 7661     # Add a priva
+0001dc00: 7465 2073 6f75 7263 6520 6173 2074 6865  te source as the
+0001dc10: 206c 6173 7420 6f6e 6520 2877 696c 6c20   last one (will 
+0001dc20: 6265 2023 3120 696e 2074 6865 206c 6973  be #1 in the lis
+0001dc30: 7429 0a20 2020 2020 2020 2020 2020 2070  t).            p
+0001dc40: 7269 7661 7465 5f73 6f75 7263 6520 3d20  rivate_source = 
+0001dc50: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001dc60: 656d 6173 2e49 6e64 6578 6564 4875 6265  emas.IndexedHube
+0001dc70: 536f 7572 6365 280a 2020 2020 2020 2020  Source(.        
+0001dc80: 2020 2020 2020 2020 6f72 6465 723d 2d31          order=-1
+0001dc90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001dca0: 2020 736f 7572 6365 3d6d 6c72 756e 2e63    source=mlrun.c
+0001dcb0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
+0001dcc0: 6253 6f75 7263 6528 0a20 2020 2020 2020  bSource(.       
+0001dcd0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0001dce0: 6164 6174 613d 6d6c 7275 6e2e 636f 6d6d  adata=mlrun.comm
+0001dcf0: 6f6e 2e73 6368 656d 6173 2e48 7562 4f62  on.schemas.HubOb
+0001dd00: 6a65 6374 4d65 7461 6461 7461 280a 2020  jectMetadata(.  
+0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd20: 2020 2020 2020 6e61 6d65 3d22 7072 6976        name="priv
+0001dd30: 222c 2064 6573 6372 6970 7469 6f6e 3d22  ", description="
+0001dd40: 6120 7072 6976 6174 6520 736f 7572 6365  a private source
+0001dd50: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001dd60: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001dd70: 2020 2020 2020 2020 2020 2020 2073 7065               spe
+0001dd80: 633d 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  c=mlrun.common.s
+0001dd90: 6368 656d 6173 2e48 7562 536f 7572 6365  chemas.HubSource
+0001dda0: 5370 6563 2870 6174 683d 222f 6c6f 6361  Spec(path="/loca
+0001ddb0: 6c2f 7061 7468 2f74 6f2f 736f 7572 6365  l/path/to/source
+0001ddc0: 222c 2063 6861 6e6e 656c 3d22 6465 7665  ", channel="deve
+0001ddd0: 6c6f 706d 656e 7422 290a 2020 2020 2020  lopment").      
+0001dde0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001ddf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001de00: 2020 2020 2020 6462 2e63 7265 6174 655f        db.create_
+0001de10: 6875 625f 736f 7572 6365 2870 7269 7661  hub_source(priva
+0001de20: 7465 5f73 6f75 7263 6529 0a0a 2020 2020  te_source)..    
+0001de30: 2020 2020 2020 2020 2320 4164 6420 616e          # Add an
+0001de40: 6f74 6865 7220 736f 7572 6365 2061 7320  other source as 
+0001de50: 3173 7420 696e 2074 6865 206c 6973 7420  1st in the list 
+0001de60: 2d20 7769 6c6c 2070 7573 6820 7072 6576  - will push prev
+0001de70: 696f 7573 206f 6e65 2074 6f20 6265 2023  ious one to be #
+0001de80: 320a 2020 2020 2020 2020 2020 2020 616e  2.            an
+0001de90: 6f74 6865 725f 736f 7572 6365 203d 206d  other_source = m
+0001dea0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001deb0: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
+0001dec0: 7572 6365 280a 2020 2020 2020 2020 2020  urce(.          
+0001ded0: 2020 2020 2020 6f72 6465 723d 312c 0a20        order=1,. 
+0001dee0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001def0: 6f75 7263 653d 6d6c 7275 6e2e 636f 6d6d  ource=mlrun.comm
+0001df00: 6f6e 2e73 6368 656d 6173 2e48 7562 536f  on.schemas.HubSo
+0001df10: 7572 6365 280a 2020 2020 2020 2020 2020  urce(.          
+0001df20: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+0001df30: 7461 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  ta=mlrun.common.
+0001df40: 7363 6865 6d61 732e 4875 624f 626a 6563  schemas.HubObjec
+0001df50: 744d 6574 6164 6174 6128 0a20 2020 2020  tMetadata(.     
+0001df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df70: 2020 206e 616d 653d 2270 7269 762d 3222     name="priv-2"
+0001df80: 2c20 6465 7363 7269 7074 696f 6e3d 2261  , description="a
+0001df90: 6e6f 7468 6572 2073 6f75 7263 6522 0a20  nother source". 
+0001dfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dfb0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0001dfc0: 2020 2020 2020 2020 2020 7370 6563 3d6d            spec=m
+0001dfd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001dfe0: 6d61 732e 4875 6253 6f75 7263 6553 7065  mas.HubSourceSpe
+0001dff0: 6328 0a20 2020 2020 2020 2020 2020 2020  c(.             
+0001e000: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+0001e010: 222f 6c6f 6361 6c2f 7061 7468 2f74 6f2f  "/local/path/to/
+0001e020: 736f 7572 6365 2f32 222c 0a20 2020 2020  source/2",.     
+0001e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e040: 2020 2063 6861 6e6e 656c 3d22 6465 7665     channel="deve
+0001e050: 6c6f 706d 656e 7422 2c0a 2020 2020 2020  lopment",.      
+0001e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e070: 2020 6372 6564 656e 7469 616c 733d 7b2e    credentials={.
+0001e080: 2e2e 7d0a 2020 2020 2020 2020 2020 2020  ..}.            
+0001e090: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e0a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001e0b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e0c0: 2020 2020 2020 6462 2e63 7265 6174 655f        db.create_
+0001e0d0: 6875 625f 736f 7572 6365 2861 6e6f 7468  hub_source(anoth
+0001e0e0: 6572 5f73 6f75 7263 6529 0a0a 2020 2020  er_source)..    
+0001e0f0: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
+0001e100: 653a 2054 6865 2073 6f75 7263 6520 616e  e: The source an
+0001e110: 6420 6974 7320 6f72 6465 722c 206f 6620  d its order, of 
+0001e120: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+0001e130: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+0001e140: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001e150: 732e 6875 622e 496e 6465 7865 6448 7562  s.hub.IndexedHub
+0001e160: 536f 7572 6365 602c 206f 7220 696e 2064  Source`, or in d
+0001e170: 6963 7469 6f6e 6172 7920 666f 726d 2e0a  ictionary form..
+0001e180: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+0001e190: 3a20 5468 6520 736f 7572 6365 206f 626a  : The source obj
+0001e1a0: 6563 7420 6173 2069 6e73 6572 7465 6420  ect as inserted 
+0001e1b0: 696e 746f 2074 6865 2064 6174 6162 6173  into the databas
+0001e1c0: 652c 2077 6974 6820 6372 6564 656e 7469  e, with credenti
+0001e1d0: 616c 7320 7374 7269 7070 6564 2e0a 2020  als stripped..  
+0001e1e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e1f0: 2020 7061 7468 203d 2022 6875 622f 736f    path = "hub/so
+0001e200: 7572 6365 7322 0a20 2020 2020 2020 2069  urces".        i
+0001e210: 6620 6973 696e 7374 616e 6365 2873 6f75  f isinstance(sou
+0001e220: 7263 652c 206d 6c72 756e 2e63 6f6d 6d6f  rce, mlrun.commo
+0001e230: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001e240: 6448 7562 536f 7572 6365 293a 0a20 2020  dHubSource):.   
+0001e250: 2020 2020 2020 2020 2073 6f75 7263 6520           source 
+0001e260: 3d20 736f 7572 6365 2e64 6963 7428 290a  = source.dict().
+0001e270: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+0001e280: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0001e290: 286d 6574 686f 643d 2250 4f53 5422 2c20  (method="POST", 
+0001e2a0: 7061 7468 3d70 6174 682c 206a 736f 6e3d  path=path, json=
+0001e2b0: 736f 7572 6365 290a 2020 2020 2020 2020  source).        
+0001e2c0: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
+0001e2d0: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
+0001e2e0: 7865 6448 7562 536f 7572 6365 282a 2a72  xedHubSource(**r
+0001e2f0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+0001e300: 0a20 2020 2064 6566 2073 746f 7265 5f68  .    def store_h
+0001e310: 7562 5f73 6f75 7263 6528 0a20 2020 2020  ub_source(.     
+0001e320: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001e330: 2073 6f75 7263 655f 6e61 6d65 3a20 7374   source_name: st
+0001e340: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
+0001e350: 653a 2055 6e69 6f6e 5b64 6963 742c 206d  e: Union[dict, m
+0001e360: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001e370: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
+0001e380: 7572 6365 5d2c 0a20 2020 2029 3a0a 2020  urce],.    ):.  
+0001e390: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e3a0: 2020 4372 6561 7465 206f 7220 7265 706c    Create or repl
+0001e3b0: 6163 6520 6120 6875 6220 736f 7572 6365  ace a hub source
+0001e3c0: 2e0a 2020 2020 2020 2020 466f 7220 616e  ..        For an
+0001e3d0: 2065 7861 6d70 6c65 206f 6620 7468 6520   example of the 
+0001e3e0: 736f 7572 6365 2066 6f72 6d61 7420 616e  source format an
+0001e3f0: 6420 6578 706c 616e 6174 696f 6e20 6f66  d explanation of
+0001e400: 2074 6865 2073 6f75 7263 6520 6f72 6465   the source orde
+0001e410: 7220 6c6f 6769 632c 0a20 2020 2020 2020  r logic,.       
+0001e420: 2070 6c65 6173 6520 7365 6520 3a70 793a   please see :py:
+0001e430: 6675 6e63 3a60 7e63 7265 6174 655f 6875  func:`~create_hu
+0001e440: 625f 736f 7572 6365 602e 2054 6869 7320  b_source`. This 
+0001e450: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+0001e460: 6564 2074 6f20 6d6f 6469 6679 2074 6865  ed to modify the
+0001e470: 2073 6f75 7263 6520 6974 7365 6c66 206f   source itself o
+0001e480: 7220 6974 730a 2020 2020 2020 2020 6f72  r its.        or
+0001e490: 6465 7220 696e 2074 6865 206c 6973 7420  der in the list 
+0001e4a0: 6f66 2073 6f75 7263 6573 2e0a 0a20 2020  of sources...   
+0001e4b0: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
+0001e4c0: 6365 5f6e 616d 653a 204e 616d 6520 6f66  ce_name: Name of
+0001e4d0: 2074 6865 2073 6f75 7263 6520 6f62 6a65   the source obje
+0001e4e0: 6374 2074 6f20 6d6f 6469 6679 2f63 7265  ct to modify/cre
+0001e4f0: 6174 652e 2049 7420 6d75 7374 206d 6174  ate. It must mat
+0001e500: 6368 2074 6865 2060 6073 6f75 7263 652e  ch the ``source.
+0001e510: 6d65 7461 6461 7461 2e6e 616d 6560 600a  metadata.name``.
+0001e520: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0001e530: 6d65 7465 7220 696e 2074 6865 2073 6f75  meter in the sou
+0001e540: 7263 6520 6974 7365 6c66 2e0a 2020 2020  rce itself..    
+0001e550: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
+0001e560: 653a 2053 6f75 7263 6520 6f62 6a65 6374  e: Source object
+0001e570: 2074 6f20 7374 6f72 6520 696e 2074 6865   to store in the
+0001e580: 2064 6174 6162 6173 652e 0a20 2020 2020   database..     
+0001e590: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
+0001e5a0: 2073 6f75 7263 6520 6f62 6a65 6374 2061   source object a
+0001e5b0: 7320 7374 6f72 6564 2069 6e20 7468 6520  s stored in the 
+0001e5c0: 4442 2e0a 2020 2020 2020 2020 2222 220a  DB..        """.
+0001e5d0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001e5e0: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001e5f0: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
+0001e600: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001e610: 6528 736f 7572 6365 2c20 6d6c 7275 6e2e  e(source, mlrun.
+0001e620: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e49  common.schemas.I
+0001e630: 6e64 6578 6564 4875 6253 6f75 7263 6529  ndexedHubSource)
+0001e640: 3a0a 2020 2020 2020 2020 2020 2020 736f  :.            so
+0001e650: 7572 6365 203d 2073 6f75 7263 652e 6469  urce = source.di
+0001e660: 6374 2829 0a0a 2020 2020 2020 2020 7265  ct()..        re
+0001e670: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+0001e680: 695f 6361 6c6c 286d 6574 686f 643d 2250  i_call(method="P
+0001e690: 5554 222c 2070 6174 683d 7061 7468 2c20  UT", path=path, 
+0001e6a0: 6a73 6f6e 3d73 6f75 7263 6529 0a20 2020  json=source).   
+0001e6b0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+0001e6c0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001e6d0: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
+0001e6e0: 6528 2a2a 7265 7370 6f6e 7365 2e6a 736f  e(**response.jso
+0001e6f0: 6e28 2929 0a0a 2020 2020 6465 6620 6c69  n())..    def li
+0001e700: 7374 5f68 7562 5f73 6f75 7263 6573 2873  st_hub_sources(s
+0001e710: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0001e720: 220a 2020 2020 2020 2020 4c69 7374 2068  ".        List h
+0001e730: 7562 2073 6f75 7263 6573 2069 6e20 7468  ub sources in th
+0001e740: 6520 4d4c 5275 6e20 4442 2e0a 2020 2020  e MLRun DB..    
+0001e750: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e760: 7061 7468 203d 2022 6875 622f 736f 7572  path = "hub/sour
+0001e770: 6365 7322 0a20 2020 2020 2020 2072 6573  ces".        res
+0001e780: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0001e790: 5f63 616c 6c28 6d65 7468 6f64 3d22 4745  _call(method="GE
+0001e7a0: 5422 2c20 7061 7468 3d70 6174 6829 2e6a  T", path=path).j
+0001e7b0: 736f 6e28 290a 2020 2020 2020 2020 7265  son().        re
+0001e7c0: 7375 6c74 7320 3d20 5b5d 0a20 2020 2020  sults = [].     
+0001e7d0: 2020 2066 6f72 2069 7465 6d20 696e 2072     for item in r
+0001e7e0: 6573 706f 6e73 653a 0a20 2020 2020 2020  esponse:.       
+0001e7f0: 2020 2020 2072 6573 756c 7473 2e61 7070       results.app
+0001e800: 656e 6428 6d6c 7275 6e2e 636f 6d6d 6f6e  end(mlrun.common
+0001e810: 2e73 6368 656d 6173 2e49 6e64 6578 6564  .schemas.Indexed
+0001e820: 4875 6253 6f75 7263 6528 2a2a 6974 656d  HubSource(**item
+0001e830: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+0001e840: 6e20 7265 7375 6c74 730a 0a20 2020 2064  n results..    d
+0001e850: 6566 2067 6574 5f68 7562 5f73 6f75 7263  ef get_hub_sourc
+0001e860: 6528 7365 6c66 2c20 736f 7572 6365 5f6e  e(self, source_n
+0001e870: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+0001e880: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0001e890: 6574 7269 6576 6520 6120 6875 6220 736f  etrieve a hub so
+0001e8a0: 7572 6365 2066 726f 6d20 7468 6520 4442  urce from the DB
+0001e8b0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001e8c0: 6d20 736f 7572 6365 5f6e 616d 653a 204e  m source_name: N
+0001e8d0: 616d 6520 6f66 2074 6865 2068 7562 2073  ame of the hub s
+0001e8e0: 6f75 7263 6520 746f 2072 6574 7269 6576  ource to retriev
+0001e8f0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0001e900: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0001e910: 6875 622f 736f 7572 6365 732f 7b73 6f75  hub/sources/{sou
+0001e920: 7263 655f 6e61 6d65 7d22 0a20 2020 2020  rce_name}".     
+0001e930: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+0001e940: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
+0001e950: 6f64 3d22 4745 5422 2c20 7061 7468 3d70  od="GET", path=p
+0001e960: 6174 6829 0a20 2020 2020 2020 2072 6574  ath).        ret
+0001e970: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
+0001e980: 2e73 6368 656d 6173 2e49 6e64 6578 6564  .schemas.Indexed
+0001e990: 4875 6253 6f75 7263 6528 2a2a 7265 7370  HubSource(**resp
+0001e9a0: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+0001e9b0: 2020 6465 6620 6465 6c65 7465 5f68 7562    def delete_hub
+0001e9c0: 5f73 6f75 7263 6528 7365 6c66 2c20 736f  _source(self, so
+0001e9d0: 7572 6365 5f6e 616d 653a 2073 7472 293a  urce_name: str):
+0001e9e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001e9f0: 2020 2020 2044 656c 6574 6520 6120 6875       Delete a hu
+0001ea00: 6220 736f 7572 6365 2066 726f 6d20 7468  b source from th
+0001ea10: 6520 4442 2e0a 2020 2020 2020 2020 5468  e DB..        Th
+0001ea20: 6520 736f 7572 6365 2077 696c 6c20 6265  e source will be
+0001ea30: 2064 656c 6574 6564 2066 726f 6d20 7468   deleted from th
+0001ea40: 6520 6c69 7374 2c20 616e 6420 616e 7920  e list, and any 
+0001ea50: 666f 6c6c 6f77 696e 6720 736f 7572 6365  following source
+0001ea60: 7320 7769 6c6c 2062 6520 7072 6f6d 6f74  s will be promot
+0001ea70: 6564 202d 2066 6f72 2065 7861 6d70 6c65  ed - for example
+0001ea80: 2c20 6966 2074 6865 0a20 2020 2020 2020  , if the.       
+0001ea90: 2031 7374 2073 6f75 7263 6520 6973 2064   1st source is d
+0001eaa0: 656c 6574 6564 2c20 7468 6520 326e 6420  eleted, the 2nd 
+0001eab0: 736f 7572 6365 2077 696c 6c20 6265 636f  source will beco
+0001eac0: 6d65 2023 3120 696e 2074 6865 206c 6973  me #1 in the lis
+0001ead0: 742e 0a20 2020 2020 2020 2054 6865 2067  t..        The g
+0001eae0: 6c6f 6261 6c20 6875 6220 736f 7572 6365  lobal hub source
+0001eaf0: 2063 616e 6e6f 7420 6265 2064 656c 6574   cannot be delet
+0001eb00: 6564 2e0a 0a20 2020 2020 2020 203a 7061  ed...        :pa
+0001eb10: 7261 6d20 736f 7572 6365 5f6e 616d 653a  ram source_name:
+0001eb20: 204e 616d 6520 6f66 2074 6865 2068 7562   Name of the hub
+0001eb30: 2073 6f75 7263 6520 746f 2064 656c 6574   source to delet
+0001eb40: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0001eb50: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0001eb60: 6875 622f 736f 7572 6365 732f 7b73 6f75  hub/sources/{sou
+0001eb70: 7263 655f 6e61 6d65 7d22 0a20 2020 2020  rce_name}".     
+0001eb80: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+0001eb90: 286d 6574 686f 643d 2244 454c 4554 4522  (method="DELETE"
+0001eba0: 2c20 7061 7468 3d70 6174 6829 0a0a 2020  , path=path)..  
+0001ebb0: 2020 6465 6620 6765 745f 6875 625f 6361    def get_hub_ca
+0001ebc0: 7461 6c6f 6728 0a20 2020 2020 2020 2073  talog(.        s
+0001ebd0: 656c 662c 0a20 2020 2020 2020 2073 6f75  elf,.        sou
+0001ebe0: 7263 655f 6e61 6d65 3a20 7374 722c 0a20  rce_name: str,. 
+0001ebf0: 2020 2020 2020 2076 6572 7369 6f6e 3a20         version: 
+0001ec00: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+0001ec10: 2020 2020 7461 673a 2073 7472 203d 204e      tag: str = N
+0001ec20: 6f6e 652c 0a20 2020 2020 2020 2066 6f72  one,.        for
+0001ec30: 6365 5f72 6566 7265 7368 3a20 626f 6f6c  ce_refresh: bool
+0001ec40: 203d 2046 616c 7365 2c0a 2020 2020 293a   = False,.    ):
+0001ec50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001ec60: 2020 2020 2052 6574 7269 6576 6520 7468       Retrieve th
+0001ec70: 6520 6974 656d 2063 6174 616c 6f67 2066  e item catalog f
+0001ec80: 6f72 2061 2073 7065 6369 6669 6564 2068  or a specified h
+0001ec90: 7562 2073 6f75 7263 652e 0a20 2020 2020  ub source..     
+0001eca0: 2020 2054 6865 206c 6973 7420 6f66 2069     The list of i
+0001ecb0: 7465 6d73 2063 616e 2062 6520 6669 6c74  tems can be filt
+0001ecc0: 6572 6564 2061 6363 6f72 6469 6e67 2074  ered according t
+0001ecd0: 6f20 7661 7269 6f75 7320 6669 6c74 6572  o various filter
+0001ece0: 732c 2075 7369 6e67 2069 7465 6d27 7320  s, using item's 
+0001ecf0: 6d65 7461 6461 7461 2074 6f20 6669 6c74  metadata to filt
+0001ed00: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
+0001ed10: 7261 6d20 736f 7572 6365 5f6e 616d 653a  ram source_name:
+0001ed20: 204e 616d 6520 6f66 2074 6865 2073 6f75   Name of the sou
+0001ed30: 7263 652e 0a20 2020 2020 2020 203a 7061  rce..        :pa
+0001ed40: 7261 6d20 7665 7273 696f 6e3a 2046 696c  ram version: Fil
+0001ed50: 7465 7220 6974 656d 7320 6163 636f 7264  ter items accord
+0001ed60: 696e 6720 746f 2074 6865 6972 2076 6572  ing to their ver
+0001ed70: 7369 6f6e 2e0a 2020 2020 2020 2020 3a70  sion..        :p
+0001ed80: 6172 616d 2074 6167 3a20 4669 6c74 6572  aram tag: Filter
+0001ed90: 2069 7465 6d73 2062 6173 6564 206f 6e20   items based on 
+0001eda0: 7461 672e 0a20 2020 2020 2020 203a 7061  tag..        :pa
+0001edb0: 7261 6d20 666f 7263 655f 7265 6672 6573  ram force_refres
+0001edc0: 683a 204d 616b 6520 7468 6520 7365 7276  h: Make the serv
+0001edd0: 6572 2066 6574 6368 2074 6865 2063 6174  er fetch the cat
+0001ede0: 616c 6f67 2066 726f 6d20 7468 6520 6163  alog from the ac
+0001edf0: 7475 616c 2068 7562 2073 6f75 7263 652c  tual hub source,
+0001ee00: 0a20 2020 2020 2020 2020 2020 2072 6174  .            rat
+0001ee10: 6865 7220 7468 616e 2072 656c 7920 6f6e  her than rely on
+0001ee20: 2063 6163 6865 6420 696e 666f 726d 6174   cached informat
+0001ee30: 696f 6e20 7768 6963 6820 6d61 7920 6578  ion which may ex
+0001ee40: 6973 7420 6672 6f6d 2070 7265 7669 6f75  ist from previou
+0001ee50: 7320 6765 7420 7265 7175 6573 7473 2e20  s get requests. 
+0001ee60: 466f 7220 6578 616d 706c 652c 0a20 2020  For example,.   
+0001ee70: 2020 2020 2020 2020 2069 6620 7468 6520           if the 
+0001ee80: 736f 7572 6365 2077 6173 2072 652d 6275  source was re-bu
+0001ee90: 696c 742c 0a20 2020 2020 2020 2020 2020  ilt,.           
+0001eea0: 2074 6869 7320 7769 6c6c 206d 616b 6520   this will make 
+0001eeb0: 7468 6520 7365 7276 6572 2067 6574 2074  the server get t
+0001eec0: 6865 2075 7064 6174 6564 2069 6e66 6f72  he updated infor
+0001eed0: 6d61 7469 6f6e 2e20 4465 6661 756c 7420  mation. Default 
+0001eee0: 6973 2060 6046 616c 7365 6060 2e0a 2020  is ``False``..  
+0001eef0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+0001ef00: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+0001ef10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001ef20: 2e68 7562 2e48 7562 4361 7461 6c6f 6760  .hub.HubCatalog`
+0001ef30: 206f 626a 6563 742c 2077 6869 6368 2069   object, which i
+0001ef40: 7320 6573 7365 6e74 6961 6c6c 7920 6120  s essentially a 
+0001ef50: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+0001ef60: 206f 6620 3a70 793a 636c 6173 733a 607e   of :py:class:`~
+0001ef70: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001ef80: 656d 6173 2e68 7562 2e48 7562 4974 656d  emas.hub.HubItem
+0001ef90: 6020 656e 7472 6965 732e 0a20 2020 2020  ` entries..     
+0001efa0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
+0001efb0: 6174 6820 3d20 2866 2268 7562 2f73 6f75  ath = (f"hub/sou
+0001efc0: 7263 6573 2f7b 736f 7572 6365 5f6e 616d  rces/{source_nam
+0001efd0: 657d 2f69 7465 6d73 222c 290a 2020 2020  e}/items",).    
+0001efe0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+0001eff0: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
+0001f000: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
+0001f010: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+0001f020: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
+0001f030: 2020 2022 666f 7263 652d 7265 6672 6573     "force-refres
+0001f040: 6822 3a20 666f 7263 655f 7265 6672 6573  h": force_refres
+0001f050: 682c 0a20 2020 2020 2020 207d 0a20 2020  h,.        }.   
+0001f060: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0001f070: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
+0001f080: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
+0001f090: 3d70 6174 682c 2070 6172 616d 733d 7061  =path, params=pa
+0001f0a0: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+0001f0b0: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+0001f0c0: 6e2e 7363 6865 6d61 732e 4875 6243 6174  n.schemas.HubCat
+0001f0d0: 616c 6f67 282a 2a72 6573 706f 6e73 652e  alog(**response.
+0001f0e0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+0001f0f0: 2067 6574 5f68 7562 5f69 7465 6d28 0a20   get_hub_item(. 
+0001f100: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001f110: 2020 2020 2073 6f75 7263 655f 6e61 6d65       source_name
+0001f120: 3a20 7374 722c 0a20 2020 2020 2020 2069  : str,.        i
+0001f130: 7465 6d5f 6e61 6d65 3a20 7374 722c 0a20  tem_name: str,. 
+0001f140: 2020 2020 2020 2076 6572 7369 6f6e 3a20         version: 
+0001f150: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+0001f160: 2020 2020 7461 673a 2073 7472 203d 2022      tag: str = "
+0001f170: 6c61 7465 7374 222c 0a20 2020 2020 2020  latest",.       
+0001f180: 2066 6f72 6365 5f72 6566 7265 7368 3a20   force_refresh: 
+0001f190: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001f1a0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0001f1b0: 0a20 2020 2020 2020 2052 6574 7269 6576  .        Retriev
+0001f1c0: 6520 6120 7370 6563 6966 6963 2068 7562  e a specific hub
+0001f1d0: 2069 7465 6d2e 0a0a 2020 2020 2020 2020   item...        
+0001f1e0: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
+0001f1f0: 6d65 3a20 4e61 6d65 206f 6620 736f 7572  me: Name of sour
+0001f200: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
+0001f210: 616d 2069 7465 6d5f 6e61 6d65 3a20 4e61  am item_name: Na
+0001f220: 6d65 206f 6620 7468 6520 6974 656d 2074  me of the item t
+0001f230: 6f20 7265 7472 6965 7665 2c20 6173 2069  o retrieve, as i
+0001f240: 7420 6170 7065 6172 7320 696e 2074 6865  t appears in the
+0001f250: 2063 6174 616c 6f67 2e0a 2020 2020 2020   catalog..      
+0001f260: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
+0001f270: 3a20 4765 7420 6120 7370 6563 6966 6963  : Get a specific
+0001f280: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+0001f290: 6974 656d 2e20 4465 6661 756c 7420 6973  item. Default is
+0001f2a0: 2060 604e 6f6e 6560 602e 0a20 2020 2020   ``None``..     
+0001f2b0: 2020 203a 7061 7261 6d20 7461 673a 2047     :param tag: G
+0001f2c0: 6574 2061 2073 7065 6369 6669 6320 7665  et a specific ve
+0001f2d0: 7273 696f 6e20 6f66 2074 6865 2069 7465  rsion of the ite
+0001f2e0: 6d20 6964 656e 7469 6669 6564 2062 7920  m identified by 
+0001f2f0: 7461 672e 2044 6566 6175 6c74 2069 7320  tag. Default is 
+0001f300: 6060 6c61 7465 7374 6060 2e0a 2020 2020  ``latest``..    
+0001f310: 2020 2020 3a70 6172 616d 2066 6f72 6365      :param force
+0001f320: 5f72 6566 7265 7368 3a20 4d61 6b65 2074  _refresh: Make t
+0001f330: 6865 2073 6572 7665 7220 6665 7463 6820  he server fetch 
+0001f340: 7468 6520 696e 666f 726d 6174 696f 6e20  the information 
+0001f350: 6672 6f6d 2074 6865 2061 6374 7561 6c20  from the actual 
+0001f360: 6875 620a 2020 2020 2020 2020 2020 2020  hub.            
+0001f370: 736f 7572 6365 2c20 7261 7468 6572 2074  source, rather t
+0001f380: 6861 6e0a 2020 2020 2020 2020 2020 2020  han.            
+0001f390: 7265 6c79 206f 6e20 6361 6368 6564 2069  rely on cached i
+0001f3a0: 6e66 6f72 6d61 7469 6f6e 2e20 4465 6661  nformation. Defa
+0001f3b0: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+0001f3c0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0001f3d0: 6e73 3a20 3a70 793a 636c 6173 733a 607e  ns: :py:class:`~
+0001f3e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001f3f0: 656d 6173 2e68 7562 2e48 7562 4974 656d  emas.hub.HubItem
+0001f400: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+0001f410: 2020 2020 2020 2070 6174 6820 3d20 2866         path = (f
+0001f420: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001f430: 7572 6365 5f6e 616d 657d 2f69 7465 6d73  urce_name}/items
+0001f440: 2f7b 6974 656d 5f6e 616d 657d 222c 290a  /{item_name}",).
+0001f450: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0001f460: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001f470: 7665 7273 696f 6e22 3a20 7665 7273 696f  version": versio
+0001f480: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
+0001f490: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+0001f4a0: 2020 2020 2020 2022 666f 7263 652d 7265         "force-re
+0001f4b0: 6672 6573 6822 3a20 666f 7263 655f 7265  fresh": force_re
+0001f4c0: 6672 6573 682c 0a20 2020 2020 2020 207d  fresh,.        }
+0001f4d0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0001f4e0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+0001f4f0: 6c28 6d65 7468 6f64 3d22 4745 5422 2c20  l(method="GET", 
+0001f500: 7061 7468 3d70 6174 682c 2070 6172 616d  path=path, param
+0001f510: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+0001f520: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
+0001f530: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
+0001f540: 6249 7465 6d28 2a2a 7265 7370 6f6e 7365  bItem(**response
+0001f550: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0001f560: 6620 6765 745f 6875 625f 6173 7365 7428  f get_hub_asset(
+0001f570: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001f580: 2020 2020 2020 2073 6f75 7263 655f 6e61         source_na
+0001f590: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+0001f5a0: 2069 7465 6d5f 6e61 6d65 3a20 7374 722c   item_name: str,
+0001f5b0: 0a20 2020 2020 2020 2061 7373 6574 5f6e  .        asset_n
+0001f5c0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+0001f5d0: 2020 7665 7273 696f 6e3a 2073 7472 203d    version: str =
+0001f5e0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+0001f5f0: 6167 3a20 7374 7220 3d20 226c 6174 6573  ag: str = "lates
+0001f600: 7422 2c0a 2020 2020 293a 0a20 2020 2020  t",.    ):.     
+0001f610: 2020 2022 2222 0a20 2020 2020 2020 2047     """.        G
+0001f620: 6574 2068 7562 2061 7373 6574 2066 726f  et hub asset fro
+0001f630: 6d20 6974 656d 2e0a 0a20 2020 2020 2020  m item...       
+0001f640: 203a 7061 7261 6d20 736f 7572 6365 5f6e   :param source_n
+0001f650: 616d 653a 204e 616d 6520 6f66 2073 6f75  ame: Name of sou
+0001f660: 7263 652e 0a20 2020 2020 2020 203a 7061  rce..        :pa
+0001f670: 7261 6d20 6974 656d 5f6e 616d 653a 2020  ram item_name:  
+0001f680: 204e 616d 6520 6f66 2074 6865 2069 7465   Name of the ite
+0001f690: 6d20 7768 6963 6820 686f 6c64 7320 7468  m which holds th
+0001f6a0: 6520 6173 7365 742e 0a20 2020 2020 2020  e asset..       
+0001f6b0: 203a 7061 7261 6d20 6173 7365 745f 6e61   :param asset_na
+0001f6c0: 6d65 3a20 204e 616d 6520 6f66 2074 6865  me:  Name of the
+0001f6d0: 2061 7373 6574 2074 6f20 7265 7472 6965   asset to retrie
+0001f6e0: 7665 2e0a 2020 2020 2020 2020 3a70 6172  ve..        :par
+0001f6f0: 616d 2076 6572 7369 6f6e 3a20 4765 7420  am version: Get 
+0001f700: 6120 7370 6563 6966 6963 2076 6572 7369  a specific versi
+0001f710: 6f6e 206f 6620 7468 6520 6974 656d 2e20  on of the item. 
+0001f720: 4465 6661 756c 7420 6973 2060 604e 6f6e  Default is ``Non
+0001f730: 6560 602e 0a20 2020 2020 2020 203a 7061  e``..        :pa
+0001f740: 7261 6d20 7461 673a 2047 6574 2061 2073  ram tag: Get a s
+0001f750: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
+0001f760: 6f66 2074 6865 2069 7465 6d20 6964 656e  of the item iden
+0001f770: 7469 6669 6564 2062 7920 7461 672e 2044  tified by tag. D
+0001f780: 6566 6175 6c74 2069 7320 6060 6c61 7465  efault is ``late
+0001f790: 7374 6060 2e0a 0a20 2020 2020 2020 203a  st``...        :
+0001f7a0: 7265 7475 726e 3a20 6874 7470 2072 6573  return: http res
+0001f7b0: 706f 6e73 6520 7769 7468 2074 6865 2061  ponse with the a
+0001f7c0: 7373 6574 2069 6e20 7468 6520 636f 6e74  sset in the cont
+0001f7d0: 656e 7420 6174 7472 6962 7574 650a 2020  ent attribute.  
+0001f7e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f7f0: 2020 7061 7468 203d 2028 6622 6875 622f    path = (f"hub/
+0001f800: 736f 7572 6365 732f 7b73 6f75 7263 655f  sources/{source_
+0001f810: 6e61 6d65 7d2f 6974 656d 732f 7b69 7465  name}/items/{ite
+0001f820: 6d5f 6e61 6d65 7d2f 6173 7365 7473 2f7b  m_name}/assets/{
+0001f830: 6173 7365 745f 6e61 6d65 7d22 2c29 0a20  asset_name}",). 
+0001f840: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0001f850: 7b0a 2020 2020 2020 2020 2020 2020 2276  {.            "v
+0001f860: 6572 7369 6f6e 223a 2076 6572 7369 6f6e  ersion": version
+0001f870: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0001f880: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
+0001f890: 2020 7d0a 2020 2020 2020 2020 7265 7370    }.        resp
+0001f8a0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0001f8b0: 6361 6c6c 286d 6574 686f 643d 2247 4554  call(method="GET
+0001f8c0: 222c 2070 6174 683d 7061 7468 2c20 7061  ", path=path, pa
+0001f8d0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+0001f8e0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+0001f8f0: 6f6e 7365 0a0a 2020 2020 6465 6620 7665  onse..    def ve
+0001f900: 7269 6679 5f61 7574 686f 7269 7a61 7469  rify_authorizati
+0001f910: 6f6e 280a 2020 2020 2020 2020 7365 6c66  on(.        self
+0001f920: 2c0a 2020 2020 2020 2020 6175 7468 6f72  ,.        author
+0001f930: 697a 6174 696f 6e5f 7665 7269 6669 6361  ization_verifica
+0001f940: 7469 6f6e 5f69 6e70 7574 3a20 6d6c 7275  tion_input: mlru
+0001f950: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001f960: 2e41 7574 686f 7269 7a61 7469 6f6e 5665  .AuthorizationVe
+0001f970: 7269 6669 6361 7469 6f6e 496e 7075 742c  rificationInput,
+0001f980: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0001f990: 2222 2256 6572 6966 6965 7320 6175 7468  """Verifies auth
+0001f9a0: 6f72 697a 6174 696f 6e20 666f 7220 7468  orization for th
+0001f9b0: 6520 7072 6f76 6964 6564 2061 6374 696f  e provided actio
+0001f9c0: 6e20 6f6e 2074 6865 2070 726f 7669 6465  n on the provide
+0001f9d0: 6420 7265 736f 7572 6365 2e0a 0a20 2020  d resource...   
+0001f9e0: 2020 2020 203a 7061 7261 6d20 6175 7468       :param auth
+0001f9f0: 6f72 697a 6174 696f 6e5f 7665 7269 6669  orization_verifi
+0001fa00: 6361 7469 6f6e 5f69 6e70 7574 3a20 496e  cation_input: In
+0001fa10: 7374 616e 6365 206f 660a 2020 2020 2020  stance of.      
+0001fa20: 2020 2020 2020 3a70 793a 636c 6173 733a        :py:class:
+0001fa30: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
+0001fa40: 6368 656d 6173 2e41 7574 686f 7269 7a61  chemas.Authoriza
+0001fa50: 7469 6f6e 5665 7269 6669 6361 7469 6f6e  tionVerification
+0001fa60: 496e 7075 7460 2074 6861 7420 696e 636c  Input` that incl
+0001fa70: 7564 6573 2061 6c6c 2074 6865 206e 6565  udes all the nee
+0001fa80: 6465 6420 7061 7261 6d65 7465 7273 2066  ded parameters f
+0001fa90: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
+0001faa0: 6865 2061 7574 6820 7665 7269 6669 6361  he auth verifica
+0001fab0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+0001fac0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+0001fad0: 6573 7361 6765 203d 2022 4175 7468 6f72  essage = "Author
+0001fae0: 697a 6174 696f 6e20 6368 6563 6b20 6661  ization check fa
+0001faf0: 696c 6564 220a 2020 2020 2020 2020 7365  iled".        se
+0001fb00: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0001fb10: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
+0001fb20: 0a20 2020 2020 2020 2020 2020 2022 6175  .            "au
+0001fb30: 7468 6f72 697a 6174 696f 6e2f 7665 7269  thorization/veri
+0001fb40: 6669 6361 7469 6f6e 7322 2c0a 2020 2020  fications",.    
+0001fb50: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001fb60: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+0001fb70: 2020 2062 6f64 793d 6469 6374 5f74 6f5f     body=dict_to_
+0001fb80: 6a73 6f6e 2861 7574 686f 7269 7a61 7469  json(authorizati
+0001fb90: 6f6e 5f76 6572 6966 6963 6174 696f 6e5f  on_verification_
+0001fba0: 696e 7075 742e 6469 6374 2829 292c 0a20  input.dict()),. 
+0001fbb0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+0001fbc0: 6620 7472 6967 6765 725f 6d69 6772 6174  f trigger_migrat
+0001fbd0: 696f 6e73 2873 656c 6629 202d 3e20 4f70  ions(self) -> Op
+0001fbe0: 7469 6f6e 616c 5b6d 6c72 756e 2e63 6f6d  tional[mlrun.com
+0001fbf0: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
+0001fc00: 6772 6f75 6e64 5461 736b 5d3a 0a20 2020  groundTask]:.   
+0001fc10: 2020 2020 2022 2222 5472 6967 6765 7220       """Trigger 
+0001fc20: 6d69 6772 6174 696f 6e73 2028 7769 6c6c  migrations (will
+0001fc30: 2064 6f20 6e6f 7468 696e 6720 6966 206e   do nothing if n
+0001fc40: 6f20 6d69 6772 6174 696f 6e73 2061 7265  o migrations are
+0001fc50: 206e 6565 6465 6429 2061 6e64 2077 6169   needed) and wai
+0001fc60: 7420 666f 7220 7468 656d 2074 6f20 6669  t for them to fi
+0001fc70: 6e69 7368 2069 6620 6163 7475 616c 6c79  nish if actually
+0001fc80: 0a20 2020 2020 2020 2074 7269 6767 6572  .        trigger
+0001fc90: 6564 0a20 2020 2020 2020 203a 7265 7475  ed.        :retu
+0001fca0: 726e 733a 203a 7079 3a63 6c61 7373 3a60  rns: :py:class:`
+0001fcb0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+0001fcc0: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
+0001fcd0: 5461 736b 602e 0a20 2020 2020 2020 2022  Task`..        "
+0001fce0: 2222 0a20 2020 2020 2020 2072 6573 706f  "".        respo
+0001fcf0: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0001fd00: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0001fd10: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
+0001fd20: 2020 2020 2022 6f70 6572 6174 696f 6e73       "operations
+0001fd30: 2f6d 6967 7261 7469 6f6e 7322 2c0a 2020  /migrations",.  
+0001fd40: 2020 2020 2020 2020 2020 2246 6169 6c65            "Faile
+0001fd50: 6420 7472 6967 6765 7269 6e67 206d 6967  d triggering mig
+0001fd60: 7261 7469 6f6e 7322 2c0a 2020 2020 2020  rations",.      
+0001fd70: 2020 290a 2020 2020 2020 2020 6966 2072    ).        if r
+0001fd80: 6573 706f 6e73 652e 7374 6174 7573 5f63  esponse.status_c
+0001fd90: 6f64 6520 3d3d 2068 7474 702e 4854 5450  ode == http.HTTP
+0001fda0: 5374 6174 7573 2e41 4343 4550 5445 443a  Status.ACCEPTED:
+0001fdb0: 0a20 2020 2020 2020 2020 2020 2062 6163  .            bac
+0001fdc0: 6b67 726f 756e 645f 7461 736b 203d 206d  kground_task = m
+0001fdd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001fde0: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+0001fdf0: 736b 282a 2a72 6573 706f 6e73 652e 6a73  sk(**response.js
+0001fe00: 6f6e 2829 290a 2020 2020 2020 2020 2020  on()).          
+0001fe10: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+0001fe20: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
+0001fe30: 6e64 5f74 6173 6b5f 746f 5f72 6561 6368  nd_task_to_reach
+0001fe40: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+0001fe50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fe60: 2062 6163 6b67 726f 756e 645f 7461 736b   background_task
+0001fe70: 2e6d 6574 6164 6174 612e 6e61 6d65 0a20  .metadata.name. 
+0001fe80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001fe90: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+0001fea0: 0a0a 0a64 6566 205f 6173 5f6a 736f 6e28  ...def _as_json(
+0001feb0: 6f62 6a29 3a0a 2020 2020 666e 203d 2067  obj):.    fn = g
+0001fec0: 6574 6174 7472 286f 626a 2c20 2274 6f5f  etattr(obj, "to_
+0001fed0: 6a73 6f6e 222c 204e 6f6e 6529 0a20 2020  json", None).   
+0001fee0: 2069 6620 666e 3a0a 2020 2020 2020 2020   if fn:.        
+0001fef0: 7265 7475 726e 2066 6e28 290a 2020 2020  return fn().    
+0001ff00: 7265 7475 726e 2064 6963 745f 746f 5f6a  return dict_to_j
+0001ff10: 736f 6e28 6f62 6a29 0a                   son(obj).
```

## mlrun/feature_store/api.py

```diff
@@ -26,15 +26,14 @@
 
 from ..data_types import InferOptions, get_infer_interface
 from ..datastore.sources import BaseSourceDriver, StreamSource
 from ..datastore.store_resources import parse_store_uri
 from ..datastore.targets import (
     BaseStoreTarget,
     get_default_prefix_for_source,
-    get_default_targets,
     get_target_driver,
     kind_to_driver,
     validate_target_list,
     validate_target_paths_for_engine,
 )
 from ..db import RunDBError
 from ..model import DataSource, DataTargetBase
@@ -427,18 +426,18 @@
         raise mlrun.errors.MLRunInvalidArgumentError(
             "feature set and source must be specified"
         )
     if (
         not mlrun_context
         and not targets
         and not (featureset.spec.targets or featureset.spec.with_default_targets)
+        and (run_config is not None and not run_config.local)
     ):
         raise mlrun.errors.MLRunInvalidArgumentError(
-            f"No targets provided to feature set {featureset.metadata.name} ingest, aborting.\n"
-            "(preview can be used as an alternative to local ingest when targets are not needed)"
+            f"Feature set {featureset.metadata.name} is remote ingested with no targets defined, aborting"
         )
 
     if featureset is not None:
         featureset.validate_steps(namespace=namespace)
     # This flow may happen both on client side (user provides run config) and server side (through the ingest API)
     if run_config and not run_config.local:
         if isinstance(source, pd.DataFrame):
@@ -518,15 +517,15 @@
     if featureset.spec.passthrough:
         featureset.spec.source = source
         featureset.spec.validate_no_processing_for_passthrough()
 
     if not namespace:
         namespace = _get_namespace(run_config)
 
-    targets_to_ingest = targets or featureset.spec.targets or get_default_targets()
+    targets_to_ingest = targets or featureset.spec.targets
     targets_to_ingest = copy.deepcopy(targets_to_ingest)
 
     validate_target_paths_for_engine(targets_to_ingest, featureset.spec.engine, source)
 
     if overwrite is None:
         if isinstance(source, BaseSourceDriver) and source.schedule:
             overwrite = False
@@ -801,15 +800,15 @@
     if isinstance(source, StreamSource) and not source.path:
         source.path = get_default_prefix_for_source(source.kind).format(
             project=featureset.metadata.project,
             kind=source.kind,
             name=featureset.metadata.name,
         )
 
-    targets_to_ingest = targets or featureset.spec.targets or get_default_targets()
+    targets_to_ingest = targets or featureset.spec.targets
     targets_to_ingest = copy.deepcopy(targets_to_ingest)
     featureset.update_targets_for_ingest(targets_to_ingest)
 
     source, run_config.parameters = set_task_params(
         featureset, source, targets_to_ingest, run_config.parameters
     )
```

## mlrun/feature_store/feature_set.py

```diff
@@ -372,14 +372,15 @@
                 "timestamp key can not be entity"
             )
 
         self.metadata = VersionedObjMetadata(name=name)
         self.status = None
         self._last_state = ""
         self._aggregations = {}
+        self.set_targets()
 
     @property
     def spec(self) -> FeatureSetSpec:
         return self._spec
 
     @spec.setter
     def spec(self, spec):
@@ -475,29 +476,39 @@
         targets = targets or []
         if with_defaults:
             self.spec.with_default_targets = True
             targets.extend(get_default_targets())
         else:
             self.spec.with_default_targets = False
 
-        validate_target_list(targets=targets)
+        self.spec.targets = []
+        self.__set_targets_add_targets_helper(targets)
+
+        if default_final_step:
+            self.spec.graph.final_step = default_final_step
+
+    def __set_targets_add_targets_helper(self, targets):
+        """
+        Add the desired target list
 
+        :param targets: list of target type names ('csv', 'nosql', ..) or target objects
+                         CSVTarget(), ParquetTarget(), NoSqlTarget(), StreamTarget(), ..
+        """
+        validate_target_list(targets=targets)
         for target in targets:
             kind = target.kind if hasattr(target, "kind") else target
             if kind not in TargetTypes.all():
                 raise mlrun.errors.MLRunInvalidArgumentError(
                     f"target kind is not supported, use one of: {','.join(TargetTypes.all())}"
                 )
             if not hasattr(target, "kind"):
                 target = DataTargetBase(
                     target, name=str(target), partitioned=(target == "parquet")
                 )
             self.spec.targets.update(target)
-        if default_final_step:
-            self.spec.graph.final_step = default_final_step
 
     def validate_steps(self, namespace):
         if not self.spec:
             return
         if not self.spec.graph:
             return
         for step in self.spec.graph.steps.values():
```

## mlrun/launcher/base.py

```diff
@@ -353,17 +353,16 @@
         return None
 
     @staticmethod
     def _refresh_function_metadata(runtime: "mlrun.runtimes.BaseRuntime"):
         pass
 
     @staticmethod
-    @abc.abstractmethod
-    def verify_base_image(runtime):
-        """resolves and sets the build base image if build is needed"""
+    def prepare_image_for_deploy(runtime: "mlrun.runtimes.BaseRuntime"):
+        """Check if the runtime requires to build the image and updates the spec accordingly"""
         pass
 
     @staticmethod
     @abc.abstractmethod
     def _enrich_runtime(runtime):
         pass
```

## mlrun/launcher/client.py

```diff
@@ -32,14 +32,44 @@
 
     @staticmethod
     def _enrich_runtime(runtime):
         runtime.try_auto_mount_based_on_config()
         runtime._fill_credentials()
 
     @staticmethod
+    def prepare_image_for_deploy(runtime: "mlrun.runtimes.BaseRuntime"):
+        """
+        Check if the runtime requires to build the image.
+        If build is needed, set the image as the base_image for the build.
+        If image is not given set the default one.
+        """
+        if runtime.kind in mlrun.runtimes.RuntimeKinds.nuclio_runtimes():
+            return
+
+        build = runtime.spec.build
+        require_build = (
+            build.commands
+            or build.requirements
+            or (build.source and not build.load_source_on_run)
+        )
+        image = runtime.spec.image
+        # we allow users to not set an image, in that case we'll use the default
+        if (
+            not image
+            and runtime.kind in mlrun.mlconf.function_defaults.image_by_kind.to_dict()
+        ):
+            image = mlrun.mlconf.function_defaults.image_by_kind.to_dict()[runtime.kind]
+
+        # TODO: need a better way to decide whether a function requires a build
+        if require_build and image and not runtime.spec.build.base_image:
+            # when the function require build use the image as the base_image for the build
+            runtime.spec.build.base_image = image
+            runtime.spec.image = ""
+
+    @staticmethod
     def _store_function(
         runtime: "mlrun.runtimes.BaseRuntime", run: "mlrun.run.RunObject"
     ):
         run.metadata.labels["kind"] = runtime.kind
         if "owner" not in run.metadata.labels:
             run.metadata.labels["owner"] = (
                 os.environ.get("V3IO_USERNAME") or getpass.getuser()
```

## mlrun/launcher/local.py

```diff
@@ -36,18 +36,14 @@
         Initialize a ClientLocalLauncher.
         :param local:   True if the job runs on the user's local machine,
                         False if it runs on a remote machine (e.g. a dedicated k8s pod).
         """
         super().__init__()
         self._is_run_local = local
 
-    @staticmethod
-    def verify_base_image(runtime):
-        pass
-
     def launch(
         self,
         runtime: "mlrun.runtimes.BaseRuntime",
         task: Optional[Union["mlrun.run.RunTemplate", "mlrun.run.RunObject"]] = None,
         handler: Optional[str] = None,
         name: Optional[str] = "",
         project: Optional[str] = "",
@@ -122,15 +118,14 @@
         )
         self._validate_runtime(runtime, run)
         result = self.execute(
             runtime=runtime,
             run=run,
         )
 
-        self._save_or_push_notifications(result)
         return result
 
     def execute(
         self,
         runtime: "mlrun.runtimes.BaseRuntime",
         run: Optional[Union["mlrun.run.RunTemplate", "mlrun.run.RunObject"]] = None,
     ):
@@ -188,14 +183,15 @@
                 resp = runtime._run(run, execution)
                 result = runtime._update_run_state(resp, task=run)
             except mlrun.runtimes.base.RunError as err:
                 last_err = err
                 result = runtime._update_run_state(task=run, err=err)
 
         self._save_or_push_notifications(run)
+
         # run post run hooks
         runtime._post_run(result, execution)  # hook for runtime specific cleanup
 
         return self._wrap_run_result(runtime, result, run, err=last_err)
 
     def _create_local_function_for_execution(
         self,
```

## mlrun/launcher/remote.py

```diff
@@ -25,18 +25,14 @@
 import mlrun.runtimes.generators
 import mlrun.utils.clones
 import mlrun.utils.notifications
 from mlrun.utils import logger
 
 
 class ClientRemoteLauncher(mlrun.launcher.client.ClientBaseLauncher):
-    @staticmethod
-    def verify_base_image(runtime):
-        pass
-
     def launch(
         self,
         runtime: "mlrun.runtimes.KubejobRuntime",
         task: Optional[Union["mlrun.run.RunTemplate", "mlrun.run.RunObject"]] = None,
         handler: Optional[str] = None,
         name: Optional[str] = "",
         project: Optional[str] = "",
```

## mlrun/projects/pipelines.py

```diff
@@ -407,15 +407,15 @@
         if project.spec.mountdir:
             f.spec.workdir = project.spec.mountdir
             f.spec.build.source = ""
         else:
             f.spec.build.source = project.spec.source
             f.spec.build.load_source_on_run = project.spec.load_source_on_run
             f.spec.workdir = project.spec.workdir or project.spec.subpath
-            f.verify_base_image()
+            f.prepare_image_for_deploy()
 
     if project.spec.default_requirements:
         f.with_requirements(project.spec.default_requirements)
     if decorator:
         decorator(f)
 
     if (
```

## mlrun/projects/project.py

```diff
@@ -40,15 +40,15 @@
 import mlrun.utils.regex
 from mlrun.runtimes import RuntimeKinds
 
 from ..artifacts import Artifact, ArtifactProducer, DatasetArtifact, ModelArtifact
 from ..artifacts.manager import ArtifactManager, dict_to_artifact, extend_artifact_path
 from ..datastore import store_manager
 from ..features import Feature
-from ..model import EntrypointParam, ModelObj
+from ..model import EntrypointParam, ImageBuilder, ModelObj
 from ..run import code_to_function, get_object, import_function, new_function
 from ..runtimes.utils import add_code_metadata
 from ..secrets import SecretsStore
 from ..utils import (
     is_ipython,
     is_legacy_artifact,
     is_relative_path,
@@ -539,14 +539,15 @@
         load_source_on_run=None,
         default_requirements: typing.Union[str, typing.List[str]] = None,
         desired_state=mlrun.common.schemas.ProjectState.online.value,
         owner=None,
         disable_auto_mount=None,
         workdir=None,
         default_image=None,
+        build=None,
     ):
         self.repo = None
 
         self.description = description
         self.context = ""
         self._mountdir = None
         self._source = None
@@ -572,14 +573,16 @@
 
         self._function_objects = {}
         self._function_definitions = {}
         self.functions = functions or []
         self.disable_auto_mount = disable_auto_mount
         self.default_image = default_image
 
+        self.build = build
+
     @property
     def source(self) -> str:
         """source url or git repo"""
         if not self._source:
             if self.repo:
                 url = get_repo_url(self.repo)
                 if url:
@@ -748,14 +751,22 @@
 
     def _need_repo(self):
         for f in self._function_objects.values():
             if f.spec.build.source in [".", "./"]:
                 return True
         return False
 
+    @property
+    def build(self) -> ImageBuilder:
+        return self._build
+
+    @build.setter
+    def build(self, build):
+        self._build = self._verify_dict(build, "build", ImageBuilder)
+
     def get_code_path(self):
         """Get the path to the code root/workdir"""
         return path.join(self.context, self.workdir or self.subpath or "")
 
     def _replace_default_image_in_enriched_functions(self, previous_image, new_image):
         """
         Set a new project-default-image in functions that were already enriched.
@@ -906,15 +917,14 @@
         :param pull_at_runtime: load the archive into the container at job runtime vs on build/deploy
         :param workdir:    the relative workdir path (under the context dir)
         """
         self.spec.load_source_on_run = pull_at_runtime
         self.spec.source = source or self.spec.source
 
         if self.spec.source.startswith("git://"):
-
             source, reference, branch = resolve_git_reference_from_source(source)
             if not branch and not reference:
                 logger.warn(
                     "Please add git branch or refs to the source e.g.: "
                     "'git://<url>/org/repo.git#<branch-name or refs/heads/..>'"
                 )
 
@@ -2292,20 +2302,20 @@
         )
 
     def build_function(
         self,
         function: typing.Union[str, mlrun.runtimes.BaseRuntime],
         with_mlrun: bool = None,
         skip_deployed: bool = False,
-        image=None,
-        base_image=None,
+        image: str = None,
+        base_image: str = None,
         commands: list = None,
-        secret_name=None,
+        secret_name: str = None,
         requirements: typing.Union[str, typing.List[str]] = None,
-        mlrun_version_specifier=None,
+        mlrun_version_specifier: str = None,
         builder_env: dict = None,
         overwrite_build_params: bool = False,
     ) -> typing.Union[BuildStatus, kfp.dsl.ContainerOp]:
         """deploy ML function, build container with its dependencies
 
         :param function:        name of the function (in the project) or function object
         :param with_mlrun:      add the current mlrun package to the container build
@@ -2332,14 +2342,136 @@
             requirements=requirements,
             mlrun_version_specifier=mlrun_version_specifier,
             builder_env=builder_env,
             project_object=self,
             overwrite_build_params=overwrite_build_params,
         )
 
+    def build_config(
+        self,
+        image: str = None,
+        set_as_default: bool = False,
+        with_mlrun: bool = None,
+        base_image: str = None,
+        commands: list = None,
+        secret_name: str = None,
+        requirements: typing.Union[str, typing.List[str]] = None,
+        overwrite_build_params: bool = False,
+    ):
+        """specify builder configuration for the project
+
+        :param image: target image name/path. If not specified the project's existing `default_image` name will be
+            used. If not set, the `mlconf.default_project_image_name` value will be used
+        :param set_as_default: set `image` to be the project's default image (default False)
+        :param with_mlrun: add the current mlrun package to the container build
+        :param base_image: base image name/path
+        :param commands:   list of docker build (RUN) commands e.g. ['pip install pandas']
+        :param secret_name:     k8s secret for accessing the docker registry
+        :param requirements: requirements.txt file to install or list of packages to install on the built image
+        :param overwrite_build_params:  overwrite existing build configuration (default False)
+
+           * False: the new params are merged with the existing (currently merge is applied to requirements and
+             commands)
+           * True: the existing params are replaced by the new ones
+        """
+        default_image_name = mlrun.mlconf.default_project_image_name.format(
+            name=self.name
+        )
+        image = image or self.default_image or default_image_name
+
+        self.spec.build.build_config(
+            image=image,
+            base_image=base_image,
+            commands=commands,
+            secret=secret_name,
+            with_mlrun=with_mlrun,
+            requirements=requirements,
+            overwrite=overwrite_build_params,
+        )
+
+        if set_as_default and image != self.default_image:
+            self.set_default_image(image)
+
+    def build_image(
+        self,
+        image: str = None,
+        set_as_default: bool = True,
+        with_mlrun: bool = None,
+        skip_deployed: bool = False,
+        base_image: str = None,
+        commands: list = None,
+        secret_name: str = None,
+        requirements: typing.Union[str, typing.List[str]] = None,
+        mlrun_version_specifier: str = None,
+        builder_env: dict = None,
+        overwrite_build_params: bool = False,
+    ) -> typing.Union[BuildStatus, kfp.dsl.ContainerOp]:
+        """Builder docker image for the project, based on the project's build config. Parameters allow to override
+        the build config.
+
+        :param image: target image name/path. If not specified the project's existing `default_image` name will be
+                        used. If not set, the `mlconf.default_project_image_name` value will be used
+        :param set_as_default: set `image` to be the project's default image (default False)
+        :param with_mlrun:      add the current mlrun package to the container build
+        :param skip_deployed:   skip the build if we already have the image specified built
+        :param base_image:      base image name/path (commands and source code will be added to it)
+        :param commands:        list of docker build (RUN) commands e.g. ['pip install pandas']
+        :param secret_name:     k8s secret for accessing the docker registry
+        :param requirements:    list of python packages or pip requirements file path, defaults to None
+        :param mlrun_version_specifier:  which mlrun package version to include (if not current)
+        :param builder_env:     Kaniko builder pod env vars dict (for config/credentials)
+                                e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
+        :param overwrite_build_params:  overwrite existing build configuration (default False)
+
+           * False: the new params are merged with the existing (currently merge is applied to requirements and
+             commands)
+           * True: the existing params are replaced by the new ones
+        """
+
+        self.build_config(
+            image=image,
+            set_as_default=set_as_default,
+            base_image=base_image,
+            commands=commands,
+            secret_name=secret_name,
+            with_mlrun=with_mlrun,
+            requirements=requirements,
+            overwrite_build_params=overwrite_build_params,
+        )
+
+        function = mlrun.new_function("mlrun--project--image--builder", kind="job")
+
+        build = self.spec.build
+        result = self.build_function(
+            function=function,
+            with_mlrun=build.with_mlrun,
+            image=build.image,
+            base_image=build.base_image,
+            commands=build.commands,
+            secret_name=build.secret,
+            requirements=build.requirements,
+            skip_deployed=skip_deployed,
+            overwrite_build_params=overwrite_build_params,
+            mlrun_version_specifier=mlrun_version_specifier,
+            builder_env=builder_env,
+        )
+
+        try:
+            mlrun.db.get_run_db(secrets=self._secrets).delete_function(
+                name=function.metadata.name
+            )
+        except Exception as exc:
+            logger.warning(
+                f"Image was successfully built, but failed to delete temporary function {function.metadata.name}."
+                " To remove the function, attempt to manually delete it.",
+                exc=repr(exc),
+            )
+
+        return result
+
     def deploy_function(
         self,
         function: typing.Union[str, mlrun.runtimes.BaseRuntime],
         dashboard: str = "",
         models: list = None,
         env: dict = None,
         tag: str = None,
```

## mlrun/runtimes/base.py

```diff
@@ -12,23 +12,25 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import enum
 import getpass
 import http
 import traceback
 import typing
+import warnings
 from abc import ABC, abstractmethod
 from ast import literal_eval
 from base64 import b64encode
 from copy import deepcopy
 from datetime import datetime, timedelta, timezone
 from os import environ
 from typing import Dict, List, Optional, Tuple, Union
 
 import requests.exceptions
+from deprecated import deprecated
 from kubernetes.client.rest import ApiException
 from nuclio.build import mlrun_footer
 from sqlalchemy.orm import Session
 
 import mlrun.api.db.sqldb.session
 import mlrun.api.utils.singletons.db
 import mlrun.common.schemas
@@ -37,15 +39,15 @@
 import mlrun.utils.helpers
 import mlrun.utils.notifications
 import mlrun.utils.regex
 from mlrun.api.constants import LogSources
 from mlrun.api.db.base import DBInterface
 from mlrun.utils.helpers import generate_object_uri, verify_field_regex
 
-from ..config import config, is_running_as_api
+from ..config import config
 from ..datastore import store_manager
 from ..db import RunDBError, get_or_set_dburl, get_run_db
 from ..errors import err_to_str
 from ..kfpops import mlrun_op
 from ..lists import RunList
 from ..model import (
     BaseMetadata,
@@ -617,55 +619,14 @@
         if self._get_db() and updates:
             project = get_in(resp, "metadata.project")
             iter = get_in(resp, "metadata.iteration", 0)
             self._get_db().update_run(updates, uid, project, iter=iter)
 
         return resp
 
-    def _save_or_push_notifications(self, runobj: RunObject, local: bool = False):
-
-        if not runobj.spec.notifications:
-            logger.debug(
-                "No notifications to push for run", run_uid=runobj.metadata.uid
-            )
-            return
-
-        # TODO: add support for other notifications per run iteration
-        if runobj.metadata.iteration and runobj.metadata.iteration > 0:
-            logger.debug(
-                "Notifications per iteration are not supported, skipping",
-                run_uid=runobj.metadata.uid,
-            )
-            return
-
-        # If the run is remote, and we are in the SDK, we let the api deal with the notifications
-        # so there's nothing to do here.
-        # Otherwise, we continue on.
-        if is_running_as_api():
-
-            # import here to avoid circular imports and to avoid importing api requirements
-            from mlrun.api.crud import Notifications
-
-            # If in the api server, we can assume that watch=False, so we save notification
-            # configs to the DB, for the run monitor to later pick up and push.
-            session = mlrun.api.db.sqldb.session.create_session()
-            Notifications().store_run_notifications(
-                session,
-                runobj.spec.notifications,
-                runobj.metadata.uid,
-                runobj.metadata.project,
-            )
-
-        elif local:
-            # If the run is local, we can assume that watch=True, therefore this code runs
-            # once the run is completed, and we can just push the notifications.
-            # TODO: add store_notifications API endpoint so we can store notifications pushed from the
-            #       SDK for documentation purposes.
-            mlrun.utils.notifications.NotificationPusher([runobj]).push()
-
     def _force_handler(self, handler):
         if not handler:
             raise RunError(f"handler must be provided for {self.kind} runtime")
 
     def full_image_path(
         self, image=None, client_version: str = None, client_python_version: str = None
     ):
@@ -820,104 +781,99 @@
             update_function_entry_points(self, body)
         return self
 
     def with_requirements(
         self,
         requirements: Union[str, List[str]],
         overwrite: bool = False,
-        verify_base_image: bool = True,
+        verify_base_image: bool = False,
+        prepare_image_for_deploy: bool = True,
     ):
         """add package requirements from file or list to build spec.
 
-        :param requirements:  python requirements file path or list of packages
-        :param overwrite:     overwrite existing requirements
-        :param verify_base_image:  verify that the base image is configured
+        :param requirements:                python requirements file path or list of packages
+        :param overwrite:                   overwrite existing requirements
+        :param verify_base_image:           verify that the base image is configured
+                                            (deprecated, use prepare_image_for_deploy)
+        :param prepare_image_for_deploy:    prepare the image/base_image spec for deployment
         :return: function object
         """
-        resolved_requirements = self._resolve_requirements(requirements)
-        requirements = self.spec.build.requirements or [] if not overwrite else []
-
-        # make sure we don't append the same line twice
-        for requirement in resolved_requirements:
-            if requirement not in requirements:
-                requirements.append(requirement)
+        self.spec.build.with_requirements(requirements, overwrite)
 
-        self.spec.build.requirements = requirements
-
-        if verify_base_image:
-            self.verify_base_image()
+        if verify_base_image or prepare_image_for_deploy:
+            # TODO: remove verify_base_image in 1.6.0
+            if verify_base_image:
+                warnings.warn(
+                    "verify_base_image is deprecated in 1.4.0 and will be removed in 1.6.0, "
+                    "use prepare_image_for_deploy",
+                    category=FutureWarning,
+                )
+            self.prepare_image_for_deploy()
 
         return self
 
     def with_commands(
         self,
         commands: List[str],
         overwrite: bool = False,
-        verify_base_image: bool = True,
+        verify_base_image: bool = False,
+        prepare_image_for_deploy: bool = True,
     ):
         """add commands to build spec.
 
-        :param commands:  list of commands to run during build
+        :param commands:                    list of commands to run during build
+        :param overwrite:                   overwrite existing commands
+        :param verify_base_image:           verify that the base image is configured
+                                            (deprecated, use prepare_image_for_deploy)
+        :param prepare_image_for_deploy:    prepare the image/base_image spec for deployment
 
         :return: function object
         """
-        if not isinstance(commands, list):
-            raise ValueError("commands must be a string list")
-        if not self.spec.build.commands or overwrite:
-            self.spec.build.commands = commands
-        else:
-            # add commands to existing build commands
-            for command in commands:
-                if command not in self.spec.build.commands:
-                    self.spec.build.commands.append(command)
-            # using list(set(x)) won't retain order,
-            # solution inspired from https://stackoverflow.com/a/17016257/8116661
-            self.spec.build.commands = list(dict.fromkeys(self.spec.build.commands))
-        if verify_base_image:
-            self.verify_base_image()
+        self.spec.build.with_commands(commands, overwrite)
+
+        if verify_base_image or prepare_image_for_deploy:
+            # TODO: remove verify_base_image in 1.6.0
+            if verify_base_image:
+                warnings.warn(
+                    "verify_base_image is deprecated in 1.4.0 and will be removed in 1.6.0, "
+                    "use prepare_image_for_deploy",
+                    category=FutureWarning,
+                )
+
+            self.prepare_image_for_deploy()
         return self
 
     def clean_build_params(self):
-        # when using `with_requirements` we also execute `verify_base_image` which adds the base image and cleans the
-        # spec.image, so we need to restore the image back
+        # when using `with_requirements` we also execute `prepare_image_for_deploy` which adds the base image
+        # and cleans the spec.image, so we need to restore the image back
         if self.spec.build.base_image and not self.spec.image:
             self.spec.image = self.spec.build.base_image
 
         self.spec.build = {}
         return self
 
+    # TODO: remove in 1.6.0
+    @deprecated(
+        version="1.4.0",
+        reason="'verify_base_image' will be removed in 1.6.0, use 'prepare_image_for_deploy' instead",
+        category=FutureWarning,
+    )
     def verify_base_image(self):
-        build = self.spec.build
-        require_build = (
-            build.commands
-            or build.requirements
-            or (build.source and not build.load_source_on_run)
-        )
-        image = self.spec.image
-        # we allow users to not set an image, in that case we'll use the default
-        if (
-            not image
-            and self.kind in mlrun.mlconf.function_defaults.image_by_kind.to_dict()
-        ):
-            image = mlrun.mlconf.function_defaults.image_by_kind.to_dict()[self.kind]
+        self.prepare_image_for_deploy()
 
-        if (
-            self.kind not in mlrun.runtimes.RuntimeKinds.nuclio_runtimes()
-            # TODO: need a better way to decide whether a function requires a build
-            and require_build
-            and image
-            and not self.spec.build.base_image
-            # when submitting a run we are loading the function from the db, and using new_function for it,
-            # this results reaching here, but we are already after deploy of the image, meaning we don't need to prepare
-            # the base image for deployment
-            and self._is_remote_api()
-        ):
-            # when the function require build use the image as the base_image for the build
-            self.spec.build.base_image = image
-            self.spec.image = ""
+    def prepare_image_for_deploy(self):
+        """
+        if a function has a 'spec.image' it is considered to be deployed,
+        but because we allow the user to set 'spec.image' for usability purposes,
+        we need to check whether this is a built image or it requires to be built on top.
+        """
+        launcher = mlrun.launcher.factory.LauncherFactory.create_launcher(
+            is_remote=self._is_remote
+        )
+        launcher.prepare_image_for_deploy(self)
 
     def export(self, target="", format=".yaml", secrets=None, strip=True):
         """save function spec to a local/remote path (default to./function.yaml)
 
         :param target:   target path/url
         :param format:   `.yaml` (default) or `.json`
         :param secrets:  optional secrets dict/object for target path (e.g. s3)
@@ -974,40 +930,14 @@
                         if "type" in p:
                             line += f"({p['type']})"
                         line += "  - " + p.get("doc", "")
                         if "default" in p:
                             line += f", default={p['default']}"
                         print("    " + line)
 
-    @staticmethod
-    def _resolve_requirements(requirements_to_resolve: typing.Union[str, list]) -> list:
-        # if a string, read the file then encode
-        if isinstance(requirements_to_resolve, str):
-            with open(requirements_to_resolve, "r") as fp:
-                requirements_to_resolve = fp.read().splitlines()
-
-        requirements = []
-        for requirement in requirements_to_resolve:
-            # clean redundant leading and trailing whitespaces
-            requirement = requirement.strip()
-
-            # ignore empty lines
-            # ignore comments
-            if not requirement or requirement.startswith("#"):
-                continue
-
-            # ignore inline comments as well
-            inline_comment = requirement.split(" #")
-            if len(inline_comment) > 1:
-                requirement = inline_comment[0].strip()
-
-            requirements.append(requirement)
-
-        return requirements
-
 
 class BaseRuntimeHandler(ABC):
     # setting here to allow tests to override
     kind = "base"
     class_modes: typing.Dict[RuntimeClassMode, str] = {}
     wait_for_deletion_interval = 10
```

## mlrun/runtimes/daskjob.py

```diff
@@ -348,18 +348,14 @@
             try:
                 client = Client(addr)
             except OSError as exc:
                 logger.warning(
                     f"remote scheduler at {addr} not ready, will try to restart {err_to_str(exc)}"
                 )
 
-                # todo: figure out if test is needed
-                # if self._is_remote_api():
-                #     raise Exception('no access to Kubernetes API')
-
                 status = self.get_status()
                 if status != "running":
                     self._start()
                 addr, dash = self._remote_addresses()
                 client = Client(addr)
 
             logger.info(
```

## mlrun/runtimes/kubejob.py

```diff
@@ -10,14 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
 import time
+import warnings
 
 from kubernetes import client
 from kubernetes.client.rest import ApiException
 
 import mlrun.common.schemas
 import mlrun.errors
 from mlrun.runtimes.base import BaseRuntimeHandler
@@ -106,15 +107,16 @@
         source=None,
         extra=None,
         load_source_on_run=None,
         with_mlrun=None,
         auto_build=None,
         requirements=None,
         overwrite=False,
-        verify_base_image=True,
+        verify_base_image=False,
+        prepare_image_for_deploy=True,
     ):
         """specify builder configuration for the deploy operation
 
         :param image:      target image name/path
         :param base_image: base image name/path
         :param commands:   list of docker build (RUN) commands e.g. ['pip install pandas']
         :param secret:     k8s secret for accessing the docker registry
@@ -127,41 +129,42 @@
                            function run, use only if you dont plan on changing the build config between runs
         :param requirements: requirements.txt file to install or list of packages to install
         :param overwrite:  overwrite existing build configuration
 
            * False: the new params are merged with the existing (currently merge is applied to requirements and
              commands)
            * True: the existing params are replaced by the new ones
-        :param verify_base_image: verify the base image is set
+        :param verify_base_image:           verify that the base image is configured
+                                            (deprecated, use prepare_image_for_deploy)
+        :param prepare_image_for_deploy:    prepare the image/base_image spec for deployment
         """
-        if image:
-            self.spec.build.image = image
-        if base_image:
-            self.spec.build.base_image = base_image
-        if commands:
-            self.with_commands(commands, overwrite=overwrite, verify_base_image=False)
-        if requirements:
-            self.with_requirements(
-                requirements, overwrite=overwrite, verify_base_image=False
-            )
-        if extra:
-            self.spec.build.extra = extra
-        if secret is not None:
-            self.spec.build.secret = secret
-        if source:
-            self.spec.build.source = source
-        if load_source_on_run:
-            self.spec.build.load_source_on_run = load_source_on_run
-        if with_mlrun is not None:
-            self.spec.build.with_mlrun = with_mlrun
-        if auto_build:
-            self.spec.build.auto_build = auto_build
 
-        if verify_base_image:
-            self.verify_base_image()
+        self.spec.build.build_config(
+            image,
+            base_image,
+            commands,
+            secret,
+            source,
+            extra,
+            load_source_on_run,
+            with_mlrun,
+            auto_build,
+            requirements,
+            overwrite,
+        )
+
+        if verify_base_image or prepare_image_for_deploy:
+            if verify_base_image:
+                # TODO: remove verify_base_image in 1.6.0
+                warnings.warn(
+                    "verify_base_image is deprecated in 1.4.0 and will be removed in 1.6.0, "
+                    "use prepare_image_for_deploy",
+                    category=FutureWarning,
+                )
+            self.prepare_image_for_deploy()
 
     def deploy(
         self,
         watch=True,
         with_mlrun=None,
         skip_deployed=False,
         is_kfp=False,
@@ -299,15 +302,14 @@
             commands=commands,
             secret_name=secret_name,
             with_mlrun=with_mlrun,
             skip_deployed=skip_deployed,
         )
 
     def _run(self, runobj: RunObject, execution):
-
         command, args, extra_env = self._get_cmd_args(runobj)
 
         if runobj.metadata.iteration:
             self.store_run(runobj)
         new_meta = self._get_meta(runobj)
 
         self._add_secrets_to_spec_before_running(runobj)
```

## mlrun/runtimes/utils.py

```diff
@@ -24,15 +24,14 @@
 from kubernetes import client
 
 import mlrun
 import mlrun.api.utils.builder
 import mlrun.common.constants
 import mlrun.utils.regex
 from mlrun.api.utils.clients import nuclio
-from mlrun.db import get_run_db
 from mlrun.errors import err_to_str
 from mlrun.frameworks.parallel_coordinates import gen_pcp_plot
 from mlrun.runtimes.constants import MPIJobCRDVersions
 
 from ..artifacts import TableArtifact
 from ..config import config, is_running_as_api
 from ..k8s_utils import is_running_inside_kubernetes_cluster
@@ -71,14 +70,15 @@
 # since this is a heavy operation (sending requests to k8s/API), and it's unlikely that the crd version
 # will change in any context - cache it
 def resolve_mpijob_crd_version():
     global cached_mpijob_crd_version
     if not cached_mpijob_crd_version:
 
         # config override everything
+        # on client side, expecting it to get enriched from the API through the client-spec
         mpijob_crd_version = config.mpijob_crd_version
 
         if not mpijob_crd_version:
             in_k8s_cluster = is_running_inside_kubernetes_cluster()
 
             if in_k8s_cluster and is_running_as_api():
                 import mlrun.api.utils.singletons.k8s
@@ -91,21 +91,16 @@
                     namespace=namespace, selector="component=mpi-operator"
                 )
                 if len(res) > 0:
                     mpi_operator_pod = res[0]
                     mpijob_crd_version = mpi_operator_pod.metadata.labels.get(
                         "crd-version"
                     )
-            elif not in_k8s_cluster:
-                # connect will populate the config from the server config
-                # TODO: something nicer
-                get_run_db()
-                mpijob_crd_version = config.mpijob_crd_version
 
-            # If resolution failed simply use default
+            # backoff to use default if wasn't resolved in API
             if not mpijob_crd_version:
                 mpijob_crd_version = MPIJobCRDVersions.default()
 
         if mpijob_crd_version not in MPIJobCRDVersions.all():
             raise ValueError(
                 f"unsupported mpijob crd version: {mpijob_crd_version}. "
                 f"supported versions: {MPIJobCRDVersions.all()}"
```

## mlrun/serving/states.py

```diff
@@ -1278,23 +1278,16 @@
     for child in step.get_children():
         kind = child.kind
         if kind == StepKinds.router:
             with graph.subgraph(name="cluster_" + child.fullname) as sg:
                 _add_graphviz_router(sg, child)
         else:
             graph.node(child.fullname, label=child.name, shape=child.get_shape())
-        after = child.after or []
-        for item in after:
-            previous_object = step[item]
-            kw = (
-                {"ltail": "cluster_" + previous_object.fullname}
-                if previous_object.kind == StepKinds.router
-                else {}
-            )
-            graph.edge(previous_object.fullname, child.fullname, **kw)
+        _add_edges(child.after or [], step, graph, child)
+        _add_edges(getattr(child, "before", []), step, graph, child, after=False)
         if child.on_error:
             graph.edge(child.fullname, child.on_error, style="dashed")
 
     # draw targets after the last step (if specified)
     if targets:
         for target in targets or []:
             target_kind, target_name = target.name.split("/", 1)
@@ -1306,14 +1299,26 @@
                 label = target_name
             graph.node(target.fullname, label=label, shape=target.get_shape())
             last_step = target.after or default_final_step
             if last_step:
                 graph.edge(last_step, target.fullname)
 
 
+def _add_edges(items, step, graph, child, after=True):
+    for item in items:
+        next_or_prev_object = step[item]
+        kw = {}
+        if next_or_prev_object.kind == StepKinds.router:
+            kw["ltail"] = f"cluster_{next_or_prev_object.fullname}"
+        if after:
+            graph.edge(next_or_prev_object.fullname, child.fullname, **kw)
+        else:
+            graph.edge(child.fullname, next_or_prev_object.fullname, **kw)
+
+
 def _generate_graphviz(
     step,
     renderer,
     filename=None,
     format=None,
     source=None,
     targets=None,
```

## mlrun/utils/logger.py

```diff
@@ -13,15 +13,15 @@
 # limitations under the License.
 
 import json
 import logging
 from enum import Enum
 from sys import stdout
 from traceback import format_exception
-from typing import IO, Union
+from typing import IO, Optional, Union
 
 from mlrun.config import config
 
 
 class JSONFormatter(logging.Formatter):
     def __init__(self):
         super(JSONFormatter, self).__init__()
@@ -38,28 +38,47 @@
             "with": record_with,
         }
 
         return self._json_encoder.encode(record_fields)
 
 
 class HumanReadableFormatter(logging.Formatter):
-    def __init__(self):
-        super(HumanReadableFormatter, self).__init__()
-
     def format(self, record):
+        record_with = self._record_with(record)
+        more = f": {record_with}" if record_with else ""
+        return f"> {self.formatTime(record, self.datefmt)} [{record.levelname.lower()}] {record.getMessage()}{more}"
+
+    def _record_with(self, record):
         record_with = getattr(record, "with", {})
         if record.exc_info:
             record_with.update(exc_info=format_exception(*record.exc_info))
+        return record_with
+
+
+class HumanReadableExtendedFormatter(HumanReadableFormatter):
+    def format(self, record):
+        record_with = self._record_with(record)
         more = f": {record_with}" if record_with else ""
-        return f"> {self.formatTime(record, self.datefmt)} [{record.levelname.lower()}] {record.getMessage()}{more}"
+        return (
+            "> "
+            f"{self.formatTime(record, self.datefmt)} "
+            f"[{record.name}:{record.levelname.lower()}] "
+            f"{record.getMessage()}{more}"
+        )
 
 
 class Logger(object):
-    def __init__(self, level, name="mlrun", propagate=True):
-        self._logger = logging.getLogger(name)
+    def __init__(
+        self,
+        level,
+        name="mlrun",
+        propagate=True,
+        logger: Optional[logging.Logger] = None,
+    ):
+        self._logger = logger or logging.getLogger(name)
         self._logger.propagate = propagate
         self._logger.setLevel(level)
         self._bound_variables = {}
 
         for log_level_func in [
             self.exception,
             self.error,
@@ -86,14 +105,33 @@
 
         # set the formatter
         stream_handler.setFormatter(formatter)
 
         # add the handler to the logger
         self._logger.addHandler(stream_handler)
 
+    def get_child(self, suffix):
+        """
+        Get a child logger with the given suffix.
+        This is useful for when you want to have a logger for a specific component.
+        Once the formatter will support logger name, it will be easier to understand
+        which component logged the message.
+
+        :param suffix: The suffix to add to the logger name.
+        """
+        return Logger(
+            self.level,
+            # name is not set as it is provided by the "getChild"
+            name="",
+            # allowing child to delegate events logged to ancestor logger
+            # not doing so, will leave log lines not being handled
+            propagate=True,
+            logger=self._logger.getChild(suffix),
+        )
+
     @property
     def level(self):
         return self._logger.level
 
     def set_logger_level(self, level: Union[str, int]):
         self._logger.setLevel(level)
 
@@ -139,20 +177,22 @@
             return
 
         self._logger.log(level, message, *args, exc_info=exc_info)
 
 
 class FormatterKinds(Enum):
     HUMAN = "human"
+    HUMAN_EXTENDED = "human_extended"
     JSON = "json"
 
 
 def _create_formatter_instance(formatter_kind: FormatterKinds) -> logging.Formatter:
     return {
         FormatterKinds.HUMAN: HumanReadableFormatter(),
+        FormatterKinds.HUMAN_EXTENDED: HumanReadableExtendedFormatter(),
         FormatterKinds.JSON: JSONFormatter(),
     }[formatter_kind]
 
 
 def create_logger(
     level: str = None,
     formatter_kind: str = FormatterKinds.HUMAN.name,
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'182623c0e5fc750bf3583dd33f4b37ea0ab8149a'", "'version'": "'1.4.0-rc6'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "85960a2a97c2d959f540d5909bb7de1381978fda",
-    "version": "1.4.0-rc5"
+    "git_commit": "182623c0e5fc750bf3583dd33f4b37ea0ab8149a",
+    "version": "1.4.0-rc6"
 }
```

## Comparing `mlrun-1.4.0rc5.dist-info/LICENSE` & `mlrun-1.4.0rc6.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.4.0rc5.dist-info/METADATA` & `mlrun-1.4.0rc6.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.4.0rc5
+Version: 1.4.0rc6
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 4 - Beta
@@ -27,15 +27,15 @@
 Requires-Dist: aiohttp (~=3.8)
 Requires-Dist: aiohttp-retry (~=2.8)
 Requires-Dist: click (~=8.0.0)
 Requires-Dist: protobuf (<3.20,>=3.13)
 Requires-Dist: kfp (<1.8.14,~=1.8.0)
 Requires-Dist: nest-asyncio (~=1.0)
 Requires-Dist: ipython (<9.0,>=7.0)
-Requires-Dist: nuclio-jupyter (~=0.9.9)
+Requires-Dist: nuclio-jupyter (~=0.9.10)
 Requires-Dist: numpy (<1.23.0,>=1.16.5)
 Requires-Dist: pandas (<1.5.0,~=1.2)
 Requires-Dist: pyarrow (<12,>=10.0)
 Requires-Dist: pyyaml (~=5.1)
 Requires-Dist: requests (~=2.22)
 Requires-Dist: sqlalchemy (~=1.4)
 Requires-Dist: tabulate (~=0.8.6)
@@ -49,15 +49,15 @@
 Requires-Dist: dask (~=2021.11.2)
 Requires-Dist: distributed (~=2021.11.2)
 Requires-Dist: kubernetes (~=12.0)
 Requires-Dist: humanfriendly (~=8.2)
 Requires-Dist: fastapi (~=0.92.0)
 Requires-Dist: fsspec (~=2023.1.0)
 Requires-Dist: v3iofs (~=0.1.15)
-Requires-Dist: storey (~=1.3.19)
+Requires-Dist: storey (~=1.4.0)
 Requires-Dist: deepdiff (~=5.0)
 Requires-Dist: pymysql (~=1.0)
 Requires-Dist: inflection (~=0.5.0)
 Requires-Dist: python-dotenv (~=0.17.0)
 Requires-Dist: setuptools (~=65.5)
 Requires-Dist: deprecated (~=1.2)
 Provides-Extra: all
```

## Comparing `mlrun-1.4.0rc5.dist-info/RECORD` & `mlrun-1.4.0rc6.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,41 +1,41 @@
 mlrun/__init__.py,sha256=cCTbgyTFsXvEdaq1Cvwz8s8FE75YGIJKX58um-fnfFs,8727
 mlrun/__main__.py,sha256=seoOeUtUyks_qBRFOAnbt0Ze8DsrdRkJALQVBC3j9Hc,49342
-mlrun/config.py,sha256=d61-Kq6OpTsNZoalbN_KHh1R9cXOGCtkRCEWWXeH90A,54803
+mlrun/config.py,sha256=5PPsvyOm_5wE16UXBUC9VoEBW0uRpp3Ybfey6MBqBUk,55437
 mlrun/errors.py,sha256=XEb1pxwy5Lzr9q0VT4z_SjP74jy37HFSmdd2hddWgvY,6780
 mlrun/execution.py,sha256=RMuw1D78GOWxDk3aQfFtFRZZ5maM4T7BiXaApoQA_6E,39096
 mlrun/features.py,sha256=pDUvV6HlkxZnUwW3lg7oq3vBwdcJQBprvdyGPNv57X8,15624
-mlrun/k8s_utils.py,sha256=n-RgP564I5R08WAruGirDEssXCcVTlibOlWRV5TjmfI,4880
-mlrun/kfpops.py,sha256=fCq9kqsIO5six8AmHkiRLngyDclRymd7V6U5YXnX_ek,29645
+mlrun/k8s_utils.py,sha256=bU5bIrk7YfrX0nEBTogpSZtTG7pVwD0X1rBZmcDlDX0,4876
+mlrun/kfpops.py,sha256=CGVXW22wmYJ_2Dl-eReFMw77mKVhtOgBnIiqRitX8WM,29646
 mlrun/lists.py,sha256=yOKwpS71Fua08sV825Anth8aaR9H5bHZyV544YbnXj4,8360
-mlrun/model.py,sha256=vZyeD1adOohG4E68wfQ1aDkerC7L-vvWY94kJ6CQNXQ,53415
+mlrun/model.py,sha256=T1Mj0y5SNnoW-HcWcwupbCUwN8xBjHEcdxeQLfgYjxc,57166
 mlrun/render.py,sha256=983QAYawKTFlwXLpUwGC1gWEjUQUFxl1lo8bPQuXIA0,11828
-mlrun/run.py,sha256=pBnu7Ca4Ct4cUmGPvGvG_EeybJGwsM-XGBqSYFEfQzY,64472
+mlrun/run.py,sha256=bo-ndqm1j7XBXH7ZucZJpksjxY00X_wWEpnUoTVYbKM,64519
 mlrun/secrets.py,sha256=xr-Omz0j5qjLGPCG_Gn2vsCP0CbqJldAAKpy5N1KAiM,7783
 mlrun/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/alembic.ini,sha256=oeSJRHwBbF3c3-N_RJilcZD-diq3F-oPv21gDIkrZGs,2105
 mlrun/api/constants.py,sha256=fyTQXJe4sx4GK8vZxklivgJgaSyOftk_NezGKA1J-mo,685
-mlrun/api/initial_data.py,sha256=h4tY0xmv_kLApkJVCB1Ic9lNydVuCDQAxxMvbMuQy1w,25068
-mlrun/api/launcher.py,sha256=F-hhWqXqQ3qMOUj4FKL_XUcmI2kzrtC_rIAuX7VHjVw,7067
-mlrun/api/main.py,sha256=4u9h_vaYWnAK3Mps2f-7xBs_AptPxWWPy7XoTtZBXPg,26288
+mlrun/api/initial_data.py,sha256=cr9mBSuVSO3zv6RbGXKvtewzqDJQoV_zu572050qkJ4,25653
+mlrun/api/launcher.py,sha256=nZMkn99KrSDu_auVZJrJJN1BJdTBw3h42azyVOd4HXo,6999
+mlrun/api/main.py,sha256=H8BSP38H_r11o1SveMC-elKBnISUIh3lV4hUaw6gSow,26443
 mlrun/api/middlewares.py,sha256=D9d-3XudnhyK_J1EGdWexCCswiS4QuSWvhDvCH1LEEU,5247
 mlrun/api/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/api/api.py,sha256=N5QgIWwnm-wgeW_8bUqVTtnRqgOUJGKDUGpScHHs78Y,4243
 mlrun/api/api/deps.py,sha256=OZt6UxT9Yg0O6egcB7a_YbZkKYkk5Vh9tTMKQKxW8nI,3197
 mlrun/api/api/utils.py,sha256=vUtih16e1zpijAzivWiXut70TC0Dh9a_ba1xB451rEE,36404
 mlrun/api/api/endpoints/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/api/endpoints/artifacts.py,sha256=FQOa8trbO53b4w864VFU5kyd4AlaRdU5LdUMUrchJhA,9545
+mlrun/api/api/endpoints/artifacts.py,sha256=LSOp8o8n30-tfoEFQ-T57i_mWKiSAElmM9x6Mh1k6t0,10394
 mlrun/api/api/endpoints/auth.py,sha256=YmcYs5pl8Il4jKDVjUGH_S5VXzam06kweO_xXpdSyeg,1199
 mlrun/api/api/endpoints/background_tasks.py,sha256=EQ5zvps1mXaVoNeoyOwMmRTAp0_nwpXtFAItvTA6uo4,3618
 mlrun/api/api/endpoints/client_spec.py,sha256=2hzm_Sq9JyPTfWgaKIjN_vGQX3xLnCScUpuoQjm3NU4,1214
 mlrun/api/api/endpoints/clusterization_spec.py,sha256=eBQya6jeYYBEe7WoCMNmXbkDxgmeDP5DCISGCZ4eAio,1175
 mlrun/api/api/endpoints/feature_store.py,sha256=CPISuRQeYuWyu0HiIQt35mOtJDQbDF6of7T7GGJsoiE,29543
 mlrun/api/api/endpoints/files.py,sha256=v_FwFb-29mqDlx2tI8D9VUHthyjnmUpGsWTnfVZR7cE,6104
-mlrun/api/api/endpoints/frontend_spec.py,sha256=5qVJF5T0A74zBi-7GOauPvylX4KGCTldItht3d0f2PE,5749
-mlrun/api/api/endpoints/functions.py,sha256=AHdrbYBH1PRT8F2Wze90bXpRtb4ZTMnRiYrl_ATSCN4,34542
+mlrun/api/api/endpoints/frontend_spec.py,sha256=iwXzTuTd5qcI-NQQagdOY_VBBXAJf8GS22V9N1SbgMo,5468
+mlrun/api/api/endpoints/functions.py,sha256=IUHh2zyoEXedkCK4H1c8XfloZ2E5f3dnUiGWkjwv_Q0,35206
 mlrun/api/api/endpoints/grafana_proxy.py,sha256=3tqafsudGF9Ru3VjZCRsXZuoLIEmIWnYJEQaIYWrqjg,5986
 mlrun/api/api/endpoints/healthz.py,sha256=rp_esZLesf92tiaFM_E50LR0m_EbsdZxuudYNMG9VVU,1344
 mlrun/api/api/endpoints/hub.py,sha256=D3hiBs4hYAjtqt6CTigM8kcQLT_Wkf0Gh_dAxTO8DEk,10399
 mlrun/api/api/endpoints/logs.py,sha256=CXKdbcQtEth2tqr8I6dEWVpb3kZjL7BNdlDHwNsDQ_s,2450
 mlrun/api/api/endpoints/model_endpoints.py,sha256=qeKxuocrubBARRu_EvHCIHly7WVgLrjMcHCjCpEmbi4,15817
 mlrun/api/api/endpoints/operations.py,sha256=lnfvQmZIcj1z6TgxCy5Tx5x7PiNls3DgE3Yzddvo-9Q,3756
 mlrun/api/api/endpoints/pipelines.py,sha256=eU0D_RFw6KYyL6hYuPjHfaIkXQ4_5u_ZTBxC3lSfJ1g,9220
@@ -69,18 +69,18 @@
 mlrun/api/crud/model_monitoring/model_endpoints.py,sha256=8W77_N0h-Uq130W7tlLtTkh4fMH9-ofOBcQiZTFXTpM,43000
 mlrun/api/crud/runtimes/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/crud/runtimes/nuclio/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/crud/runtimes/nuclio/function.py,sha256=fEqGrM0yyyq8urUxzFcG43-m3txF-Oyxdhm6e4DCB4w,17168
 mlrun/api/crud/runtimes/nuclio/helpers.py,sha256=E3ThgKBZyPa-VVWv3rTRtQAdR9lIVLkYz8_hfyntocA,11398
 mlrun/api/db/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/db/base.py,sha256=ETSlJ24N0s63dLpDS5yVo7vFg3ap-ySwhaKyCOcqUZo,15056
-mlrun/api/db/init_db.py,sha256=5WSrojwOh79O3guN_7IEi9wjqzKj3H74DU2xbGtrElk,870
+mlrun/api/db/init_db.py,sha256=bx7urn0e9VweQwtbsldK_mn63aTZhqHRHpyhwbM-W_4,816
 mlrun/api/db/session.py,sha256=_5DVL4YyGGFG9sbtHx_Bq2C1aHrZC5V8MS7TJfNeWIk,993
 mlrun/api/db/sqldb/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/db/sqldb/db.py,sha256=qhVBlTO-zmvgD0NVoEKNkz4pYzssDplGmEbZVu1bwtc,144515
+mlrun/api/db/sqldb/db.py,sha256=t-ZGaWbTbyVSfXpB17TEt99TDh9h7bjNqushfih3aok,144159
 mlrun/api/db/sqldb/helpers.py,sha256=j8VK-l_qZ5vLUjGkFK3D3fBgDgPmi-U8hU1MkMIAhC0,2340
 mlrun/api/db/sqldb/session.py,sha256=97QcZc7EOhypk3ZMl0F5k1ogsgK834S3SxCj3UNry-s,2542
 mlrun/api/db/sqldb/models/__init__.py,sha256=0cHZKMpzqkC6u3WGPEYE8zPcahY6KxBrK2pwkzTCCME,1063
 mlrun/api/db/sqldb/models/models_mysql.py,sha256=zyFuS_tj6legl1QvJ5QBrLIgilAnDcZHSvHC-bXMqdQ,20642
 mlrun/api/db/sqldb/models/models_sqlite.py,sha256=10IzVBZ79Yj1vqFbWCocZ5QNrz1H91HzlzUFe6iu31k,18304
 mlrun/api/migrations_mysql/env.py,sha256=U5Fu1WLV5vggRYy4sa7d1ItJr1H3-T71BnkOw4ZjWIs,2906
 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py,sha256=kcdNEMQHbTRGpzh4CfLlUJtClG_eHo-X0QNPOQEFBuI,1203
@@ -134,29 +134,29 @@
 mlrun/api/utils/clients/log_collector.py,sha256=d1Tj680X0QSC83re1vhX62z_0tt5WvNjHqKv1wMVNF4,12109
 mlrun/api/utils/clients/nuclio.py,sha256=yT8atthDWpvlDU4rQiyHXo1tCFDrx3-s1iLJadhJ3nk,9916
 mlrun/api/utils/clients/protocols/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/clients/protocols/grpc.py,sha256=P_He0oRyRvsCpTz7Pl2bZkqwA1W04Wl3BJMusM30pkY,2567
 mlrun/api/utils/db/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/db/alembic.py,sha256=sUVnWHXRzA_Yhn2GWiSqeQ8dcfpC4IPQpTFBjTta_iU,3305
 mlrun/api/utils/db/backup.py,sha256=LL4qL3YaLAbehS-KHn-Ieys333ZReEnmFIOoYV7BKzc,8214
-mlrun/api/utils/db/mysql.py,sha256=KWvD37V2_1hztu_g4-Jpe4aLmcc5Gl6x7-HzYWqkBOM,3795
+mlrun/api/utils/db/mysql.py,sha256=9FeqQpvOQjyuoxsRp8W1sv9mxUD43vJ4KAUitSX8gwk,3787
 mlrun/api/utils/db/sql_collation.py,sha256=t1pYJNPDwSP0PZwtlTqMAUgYhGZLRv0awbnEYy3Geis,992
-mlrun/api/utils/db/sqlite_migration.py,sha256=oPv2Knboe4vQGn9MDUfqbFrcIhvSuDoFji1Emj59MIA,3855
+mlrun/api/utils/db/sqlite_migration.py,sha256=Vg39fAox122MDEKCVAE7d87iW70_Y8g3bc08iUxYEDA,3861
 mlrun/api/utils/projects/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/projects/follower.py,sha256=htcIXP2BRtm3MUEfw5IFC-WHUwidCfHZArS-pfSfFyM,17423
 mlrun/api/utils/projects/leader.py,sha256=V636xbrvoTs5Bg-wtsNTWCAeB4I6hqMc5i43Hlgiizc,19372
 mlrun/api/utils/projects/member.py,sha256=hokfxVFnvWtQHeVQYSZTlv1GyOoRHUUoVRVG4MFxfhE,7133
 mlrun/api/utils/projects/remotes/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/projects/remotes/follower.py,sha256=4bjZRHWrY8CKB_y7Juj-aQZn0YnbLCqVsJ93Aj_MniQ,2659
 mlrun/api/utils/projects/remotes/leader.py,sha256=uRC_WbKe1UfghVfCXD0ZomsJztk2HydBdz9Y_XjTfkY,2094
 mlrun/api/utils/projects/remotes/nop_follower.py,sha256=sP8BDve6471PEHomEJYAYEUsAlHwpy1frEfKbU9nAlc,5000
 mlrun/api/utils/projects/remotes/nop_leader.py,sha256=hslYEvKbQ4TdMzYnvqvU_oGfCvfQ2lxAglQqEn12AQ0,3861
 mlrun/api/utils/singletons/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/singletons/db.py,sha256=y-v3JdLIHb_GtPvdzKH137jsflTav5TY9CafsSXfkN8,1202
-mlrun/api/utils/singletons/k8s.py,sha256=R62wVYe-kf9SOKOQJxo2qnIzWS8rOskA68QSK49BBGc,22630
+mlrun/api/utils/singletons/k8s.py,sha256=XmUXwaSHzed8AmDf25d0rKJ4XVcs9NN4k5efgzPxBhU,22651
 mlrun/api/utils/singletons/logs_dir.py,sha256=zCALZ1N8IylkfvATfsbWfBtEPvWKl2AEQ2-QF-J0VWs,840
 mlrun/api/utils/singletons/project_member.py,sha256=1xlvJjbY-HvQuUV5rsQg9rMt-Y9MKU77Az5f98v-D28,1279
 mlrun/api/utils/singletons/scheduler.py,sha256=LmauJTsB69P_gkx4xTMzQrW1kaaN050txZzrrl08i_k,1063
 mlrun/artifacts/__init__.py,sha256=b86JkwaOMjN9gPzeL-RlkAtiITaVmGS9viNlvGG1lrs,1091
 mlrun/artifacts/base.py,sha256=l-dRIaK89NOIiBqiSbo1vbPks8CeRv83wSKndybJt0U,30849
 mlrun/artifacts/dataset.py,sha256=d4ZrxECaJ-CJSbFvcWYrAK34IAOD0UPxLY0xrPc-04w,20432
 mlrun/artifacts/manager.py,sha256=P5y92csdyr9VgXlqitaKWWldg93KaCjGRAWLeZHIYHI,12594
@@ -198,31 +198,31 @@
 mlrun/datastore/base.py,sha256=wnad4Fie0zeq_CLxKGN02bKHIDBmrYYxIHVMuHEsGFo,18274
 mlrun/datastore/datastore.py,sha256=l6CfmIYn7rdPQyRZ8kZu45cfyDZcDXDH5CwLKvsFlI8,7995
 mlrun/datastore/filestore.py,sha256=v9-BTJMgamGN_neoXNkIbNNr56UpgOewMEX70P8MTbc,3791
 mlrun/datastore/google_cloud_storage.py,sha256=9dtZt7Opytrra45urj6ObYa1fxf7UIOHXSoog4G9l7I,5114
 mlrun/datastore/inmem.py,sha256=o6Svv12k5PxJNT24nMgV9FBYEPCzD3OQzuuvU6OeCYY,2627
 mlrun/datastore/redis.py,sha256=pywWgjGJ51pmvKuwX1MI3ILWqh6WtgDs9igOQAhmIhc,4873
 mlrun/datastore/s3.py,sha256=fn1Yg5Rs33ugHlwTKvBfu_jMKqkSZWgHNw0ocQ5nO7A,7035
-mlrun/datastore/sources.py,sha256=vmJ2rngL0NYz-_0uBDzQ3yByYZbYCPwWLxDUMuL2jZ8,34305
+mlrun/datastore/sources.py,sha256=3RsqPaAbuDXHGTdbG1-Qk6hvuGOfWsMp3-QS0RrgaVU,34280
 mlrun/datastore/spark_udf.py,sha256=xYw2EYO-jd7hKOlXXfJYH8dvRll4GktFM581K9m6ToE,1410
 mlrun/datastore/store_resources.py,sha256=Elvo33AVoDfOIFbTF_5NSf1VMzlgJTv5uzMgPkGTShw,6895
 mlrun/datastore/targets.py,sha256=IurALojY74ZaxiI3B3xMHEWeVM_blys6Dq1EGS9JOyc,62060
 mlrun/datastore/utils.py,sha256=nnHcC_XgUWZi70-aZ2y61aJcJttDQYiCDDTGqI_Y6V4,2900
 mlrun/datastore/v3io.py,sha256=ArEYq78irv5bwlRwcLeVfFJvcwtXEamGsZ2I0sVt7Qg,8097
 mlrun/datastore/wasbfs/__init__.py,sha256=4CK7vZeJmC4Ak9cJjG07cGnk7jlkBlpCxw-ANfbBmzk,1343
 mlrun/datastore/wasbfs/fs.py,sha256=DEZgwrmQSPeR93MNlC9OCwuU9wvTSmIM534p5ccQzAE,6152
 mlrun/db/__init__.py,sha256=HA6ahbEFrRd5I81eJQ1xrHmUch6JOy3JeEKMf7KrOTM,2816
 mlrun/db/base.py,sha256=7he8xfP09ZKLHjdWI2sZdgbfzV8Lw14kjYO-BJcp4VM,15968
-mlrun/db/httpdb.py,sha256=5FlzuFJxdML_W2PDeAyCtq8PORqv9tz-ufRVdkjpxQY,130800
+mlrun/db/httpdb.py,sha256=lmQdoDHAsrf591HblohzU7opJPmgUoJcmSzBLMXv-1E,130841
 mlrun/db/nopdb.py,sha256=mAEmOlxhnlk3DU8xTf2uWt_5QbDvo8YA9Jj-BKR_VtA,13197
 mlrun/db/sqldb.py,sha256=7scsyukK7k6AhU2z9pB0cHrq-mzmhdFgJmfnkn_dO2o,25577
 mlrun/feature_store/__init__.py,sha256=guoak0hQTMoE4YsWwyoyso0CYE9NSPoP0eUal4crfVA,1501
-mlrun/feature_store/api.py,sha256=oL6x8ehykb-FGhwJAFkTTPn2EyvDx6vRKV3g8Astz3I,43820
+mlrun/feature_store/api.py,sha256=yPmbQ7J353juaFEa4kCOsABYLn_h8R5_x_CfzOPCucc,43719
 mlrun/feature_store/common.py,sha256=WR01cTgrJ88qRLKRz0U4VDOTg2vNzhYdch-jylkyoJ8,12781
-mlrun/feature_store/feature_set.py,sha256=_k-FBI8a97aKCL3IS9fXehD7cXUCsbMSEAXm4sq47K0,47273
+mlrun/feature_store/feature_set.py,sha256=lScyviJOVowwzNvasJ-gwHwF7Ltqk2nZghU39atN2sk,47683
 mlrun/feature_store/feature_vector.py,sha256=31kHErOGU_OhVauMK5svW50TKIDwKgdcDzst87JyB2c,21940
 mlrun/feature_store/ingestion.py,sha256=YQafLdoQmoWsEHLE8lMBBhhPe974TNJ6Tnq_Q0Xhpus,11681
 mlrun/feature_store/steps.py,sha256=khDqxTusXDtBNfS7ESZh-QEsWu3_8FTR5ep_AY_Nvdo,28635
 mlrun/feature_store/retrieval/__init__.py,sha256=2b2WoPmH4TqcSSJ2OQYSjsDIcUe1KA5DnG7-wkrIayM,1232
 mlrun/feature_store/retrieval/base.py,sha256=38n5qY60V-wvn5vAVSd4qQlfkMMTMchX0c2TdZ8XqqE,25911
 mlrun/feature_store/retrieval/dask_merger.py,sha256=-xRgRPWUblu3KtVhEoL0YXEAcgkZrSUykDe31xnEzRI,4261
 mlrun/feature_store/retrieval/job.py,sha256=-b4AgG3D0jFduzBPmKrb6MjSRez-8-ocmbj9eWCPXaY,7141
@@ -310,19 +310,19 @@
 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py,sha256=N1_lNXSig6FwSUt1P8ZNKf1Hie-9pMo2feFjV7AoJzg,8791
 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py,sha256=YM7gNuryhioDrvVPBhpIUo9lH-bhE5JdE-xSo-kriP4,28728
 mlrun/frameworks/xgboost/__init__.py,sha256=2-q_HGIgwzZUoBpxMC5OBYpn29qh84HHwZpHRcOke_I,10287
 mlrun/frameworks/xgboost/mlrun_interface.py,sha256=JwbFkYz97gmkjLN1V_zu8nTG9zSey1RtUmUO6XfaZ54,878
 mlrun/frameworks/xgboost/model_handler.py,sha256=3KSLoL_uBBhRPkGEgRxJz1MPxQbcbvuIxJawQConfrQ,11617
 mlrun/frameworks/xgboost/utils.py,sha256=Yz7vIfnFMqa2A0k2GweXL912-tt7JnQdYsNX-pFs45I,1069
 mlrun/launcher/__init__.py,sha256=pZgS6ZN126aJme4z5spCX-RmdchShxMnQeCPya8AsQI,577
-mlrun/launcher/base.py,sha256=5okscCWLT6PFeUZMnbhqwGxOKqJ404kE9yVvc4I17-s,14886
-mlrun/launcher/client.py,sha256=6ojdL3dck2NoaS5yBaEhSh_UnUdseaXSYj6fSaVydPo,4791
+mlrun/launcher/base.py,sha256=VGFHBjHI2bOMxUdryw4_p8oUnoOcqYLRtEIqFBWvTNM,14923
+mlrun/launcher/client.py,sha256=GkqEVaKwb5E0LtYQY9VPRNq2lwG_sWVj37pFjaOuoBA,6051
 mlrun/launcher/factory.py,sha256=Co7Y9WI9_CCbr5slKTVDbTV0uO4XQZ9ysC8d2YlTG94,1883
-mlrun/launcher/local.py,sha256=DtbYnL4j17cULbh6hgOzCYZfVCRDsF3pcd_MqcBhamM,10419
-mlrun/launcher/remote.py,sha256=lLG55TOkLukSgK0b3wby-CbAIaE-BD0eWk_U2YkWxrg,6875
+mlrun/launcher/local.py,sha256=6IoBbAiU2fXapCJ8_hUt973Fzazfb3Q4fRgIJaVRItk,10303
+mlrun/launcher/remote.py,sha256=oY7zxQdcZFq3OSekUceAB0Ljd-9dOXnL0JRzchVKP9Q,6807
 mlrun/mlutils/__init__.py,sha256=enRhuXMjuev4xr-0l1zLxtoDp79FHc-HXbUoagYomvk,760
 mlrun/mlutils/data.py,sha256=uQ45eaKYx3Jy93l2TqosFW68Kj_ZtVI06ilxGxydaUY,5325
 mlrun/mlutils/models.py,sha256=_CijiNJkLnWdz0HU3DAU6P8TbobY7R2QVpuCOHTJD-4,2598
 mlrun/mlutils/plots.py,sha256=0-Rih6th9WkgzZRPIPZwz08lv4bVSX7YbyGNgA02xdA,30120
 mlrun/model_monitoring/__init__.py,sha256=YIUIQs1hwX-PWBu23dH-IY9gQYXW8HA0oFX3izaG9d0,1208
 mlrun/model_monitoring/features_drift_table.py,sha256=DlMkc-GwRhIALXB0OdCQkvOZQUVNI69RpJ1PAwLqK9Y,23948
 mlrun/model_monitoring/helpers.py,sha256=6e7yA4a3tErirdSCuC-BIH8OqISzkFcx-h9-5K38STU,9756
@@ -338,31 +338,31 @@
 mlrun/model_monitoring/stores/models/mysql.py,sha256=vVVSIssH_ZHMG-BbqwbFlaiPcN8DQtU3mM2vTySAPdY,3741
 mlrun/model_monitoring/stores/models/sqlite.py,sha256=jLWkY8srgal7_aCL2eDPZIoceNGsi4Dec1T2rHNd0BI,3658
 mlrun/platforms/__init__.py,sha256=NNh9MSxgjdi7QftO3DHp4axQnBeO5IjxD8oR13_jp3A,2400
 mlrun/platforms/iguazio.py,sha256=qKglLKYVOJqlDG9JEZ9b1kOvrVmk5exey-2eh6ejfdw,24102
 mlrun/platforms/other.py,sha256=DwqbdbMNlkC2nEl1yJ0jF9WZJzjVu2IVPTC3bQ_W9Y0,11852
 mlrun/projects/__init__.py,sha256=dsXSDyqBhLi8OOfpdjLJpYOwC2fy_Q_Ki95Bk6gVSwc,1153
 mlrun/projects/operations.py,sha256=ifZGJidODXsnbJt7wG94upzkNOU24NQNhbivGWYTHRs,17480
-mlrun/projects/pipelines.py,sha256=MVYNxdubl0RiuILSY9z2v0fszngMYEtV81YJ_uQD8oE,38336
-mlrun/projects/project.py,sha256=Lw0G_PB-6657S3fQdF-caErecu2FXAqQLNSfiZJg_5M,105376
+mlrun/projects/pipelines.py,sha256=YLdLNirIp_p9Mm3BoU-tjRLtygzeJtd-cnfTQFVd2Ng,38343
+mlrun/projects/project.py,sha256=Vwhdif1Q5xbt1ZGGFe6HMKP8eF2kwIIMEXnSe3bAM6c,111205
 mlrun/runtimes/__init__.py,sha256=NpPeD7XxDNxmeOqLSEmb7tUN59cYZlvw-DnJxla_peE,8773
-mlrun/runtimes/base.py,sha256=4D4pFQkdKJAzetppgSMn885fkrGgftxhqS2hxlfXqIU,89589
+mlrun/runtimes/base.py,sha256=f6MJJmaeagILyIHY-rFghRZOcuyw0o4ls-aVw_BpYZ4,86765
 mlrun/runtimes/constants.py,sha256=Os_6YpWE8WMhigm1h3RKvn9Uo4LXNaEbA2xNSEDDEao,6689
-mlrun/runtimes/daskjob.py,sha256=4D0BCCRAb-JsLijZ_2LHzwGcZnxhyZ4gnst3HKENqQg,30520
+mlrun/runtimes/daskjob.py,sha256=d7MRUptiR7fCTc-ClbGHzlWxqOw6xXLqyyXm0C42Fio,30353
 mlrun/runtimes/funcdoc.py,sha256=PAvbUFXLei7vFYPwlntJhnUgBqn38kMlaSbp_Y2Ice4,9561
 mlrun/runtimes/function.py,sha256=GH6XUVOAvnhARg_oV3BUyLEG5xaYZHtiwrBbZ2FwniE,45205
 mlrun/runtimes/function_reference.py,sha256=ikxeXeFPAn7PpfYR1DPBRFc9MSXXFM34uH5z6iRTz9M,4911
 mlrun/runtimes/generators.py,sha256=WvXzsfZZWqxLV1ncZ-lzFHZH2ITK6ICROgDv2vfQUs4,6530
-mlrun/runtimes/kubejob.py,sha256=1uCJAvs0FLxfAag4BykZEMzyHrefVELnZ9ht_Ctbzv0,15140
+mlrun/runtimes/kubejob.py,sha256=2YPBkTw-JAfTNF_rptPeIcmREbizXk9cgD20XpV9syY,15213
 mlrun/runtimes/local.py,sha256=R1QeKBkl0X9fCljdg3gBgvrpXv52Gbv6MOHbbDiq5qU,18982
 mlrun/runtimes/nuclio.py,sha256=ih2iwrJieeEom3iW0yU99QG4_u_Bdv7VWgs1CK4Q1P8,2885
 mlrun/runtimes/pod.py,sha256=foeea0tUMSWbH4_SS_biOIgEmUL3RP3NlQwNb62QGYk,60808
 mlrun/runtimes/remotesparkjob.py,sha256=Lp2EN32GQ1rY_34MEepdUzRTg-AP-OKyUM7xcy0Npb8,7695
 mlrun/runtimes/serving.py,sha256=jruUAxwi9PVHY-mlZkljMD7P5WGyfbSS8pJmzDqQI9E,29858
-mlrun/runtimes/utils.py,sha256=7RjhqZAfUnjnPk2shrR_pdpyaqu19q5ECCTmxJJv4MM,21222
+mlrun/runtimes/utils.py,sha256=4ufkD4i38EZnFMgTsMykDZpiEJ87I3ZeWxbZDNyWs6c,21048
 mlrun/runtimes/mpijob/__init__.py,sha256=E0oiOsSYsRBBR0HV6e_EGaL_j2_dYEJwAcICnF8mOYU,790
 mlrun/runtimes/mpijob/abstract.py,sha256=0BbIziHG5ITg3gNClLuBwL6-J4IXXPxjifppQciQwNU,14713
 mlrun/runtimes/mpijob/v1.py,sha256=o-ZDw3O0HOzTMZ3lI3gMjGG0NYY0Ux3RqL0Kz9K3eV4,13845
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=4rMpJk1C_gL6QtOmEFcgcmaCkHcor9mdKvIL46fEKFw,8460
 mlrun/runtimes/package/__init__.py,sha256=EHFvxDWnRkXqjmdv9Mj3O-nCYAFLbRsNgX5zR0ElwAk,673
 mlrun/runtimes/package/context_handler.py,sha256=Z33-nbg4h545n1gGgCSrb-0LiFbRsisST6w44oba22I,27068
 mlrun/runtimes/sparkjob/__init__.py,sha256=7damn-nBbM0unppemEuVwZxCAGwXq7EzXECMJ9AaRPY,751
@@ -370,41 +370,41 @@
 mlrun/runtimes/sparkjob/spark3job.py,sha256=mxHWVtT7hZeQsFklaFE5PeI9sSeGb3Pvr7mGfaPYgos,28746
 mlrun/serving/__init__.py,sha256=FOIyvEwEOH6QuJovcDrrP5VSdLeKoqummSlfhNMvFXg,1078
 mlrun/serving/merger.py,sha256=oRX6gJ3LUVeCJcTpJ1nwh4d1tk5FrSZshkXcH-y-dd4,6116
 mlrun/serving/remote.py,sha256=HJS9bz5_mUuaKGsNbqRKpo-eVHKbc1fIEOEsECPmnko,18038
 mlrun/serving/routers.py,sha256=Erod_gU6qnUk5ipNUsSZLrcPN_VHESN3W2dH5wwjQVY,55277
 mlrun/serving/server.py,sha256=5sR-XBEealOcFehQKZtIK4Gr7HJ63mPU7BtjcoUA3qw,20247
 mlrun/serving/serving_wrapper.py,sha256=ivoSlFNuC92plPHRfMzHr-hdN-jGqxneGiufJdgoxVc,836
-mlrun/serving/states.py,sha256=7ykG0Q66OQvRF32nQDQGwkmVYEyHczCvNrQxneVdUdM,53940
+mlrun/serving/states.py,sha256=2SpSOwCMXvJwk_3wYf_i3seD4nO9aJnQXlZTfL0iiAI,54169
 mlrun/serving/utils.py,sha256=HVePCgBKiQrIoBE8qcG0Qb57FRpZ_3CrUSBv2pPFlVk,3902
 mlrun/serving/v1_serving.py,sha256=UF6Ydgyo-DuHZ4DkrEdNMQl5oopVaZqm4EfBMBSvhDY,11814
 mlrun/serving/v2_serving.py,sha256=7g-FBPqyc8zgCY6Xi8SoS23VldDnOoL2G81m8qGbDOU,21460
 mlrun/utils/__init__.py,sha256=YnW6IErGUxc1mdd7a3eNvoYO_fy-mv4Uvu5Go8uT-kM,826
 mlrun/utils/async_http.py,sha256=AvI4a9D0frI6XxHvqnQ4AzEXopezo90zZHvsOAJJt6g,10397
 mlrun/utils/azure_vault.py,sha256=atz9fIu1vfgWAND1g6flRQDhrX-xBxZ_6MOWm34Onh0,3456
 mlrun/utils/clones.py,sha256=lKgQeibQ3xQ9LH5bZTZCoYCXoOx_2mYNGD5A-OOxwAQ,6245
 mlrun/utils/db.py,sha256=SqDrvIpGX_qHs0MNx_PWQNRcUhHaKLngoHFKLW3m5j0,1662
 mlrun/utils/helpers.py,sha256=yESXiZRPaDhwHN8RWtyF6GpfUyumInGm7GuxLOWwgZU,42577
 mlrun/utils/http.py,sha256=FVgdYV8Np3TKbqszEtXrlgwqNyjScTMLAjJhlsWLifo,7093
-mlrun/utils/logger.py,sha256=O4pH45kdz0cO-e4eKeRxbZUIRLGn2X0BJcjSY9cWB04,5637
+mlrun/utils/logger.py,sha256=yg3m2TAs4zgc0qJRtE6zvqkSHTr_rJSRfDqqEeHrh8c,7035
 mlrun/utils/model_monitoring.py,sha256=1y-E4AlR-yZ1qW2yfxcHvm3rHZoytDz4IbIju8cPOOU,9969
 mlrun/utils/regex.py,sha256=3hSOVEU5128xio_3BLBEmvvRGLipmGP2Sh7XgVAYs8w,3954
 mlrun/utils/singleton.py,sha256=kV9HhbzdmXo8gGKBPdbHWspRDutlkKX1ZEn96xs_LRs,883
 mlrun/utils/v3io_clients.py,sha256=ekxhjfcUnjV8cejQYTQUHnhYOKHA4KekIdSaywydTdM,1319
 mlrun/utils/vault.py,sha256=EgxGAfn-mxRCj8cKEzSrrZQ9SV7BFP8mIuSnbhJpNUQ,10447
 mlrun/utils/notifications/__init__.py,sha256=CgWLxslSqhTH-tExi_UR4AT-ipjkGUF4gwf9mKcNua8,990
 mlrun/utils/notifications/notification_pusher.py,sha256=fLNXJRuHeOeSMWro1rBs5Q91FIR5fJYCfWSKkGf6Mq0,12331
 mlrun/utils/notifications/notification/__init__.py,sha256=iNF31hiEkenkp1VmJ4keyjixS17-gZ0oGuWNO7tlnm4,1803
 mlrun/utils/notifications/notification/base.py,sha256=ddlf70Cd59bMvvWi2EFqzJQTXSRHw19E4r-oX2Tk8rk,2177
 mlrun/utils/notifications/notification/console.py,sha256=JggUV_Ql8lluvlONtkmQWk6SeSPY7gEhICAbkg0jYas,1971
 mlrun/utils/notifications/notification/git.py,sha256=gKBBb0_EZpv7PJFDi62hmxih9a8JoaU37i1IXUM46e0,4742
 mlrun/utils/notifications/notification/ipython.py,sha256=bYIUpzb2QnLPhacL8l20NU4suRjE0-lxeYYXpHuqiTw,2021
 mlrun/utils/notifications/notification/slack.py,sha256=hONSD43eLSxQ5n3x8HHqI-zhHc4ZxThR8lLcfkKoHfw,3751
 mlrun/utils/version/__init__.py,sha256=hwfJgGWYGWFpepVGI1GbuCPqqEFGRbgguJg5sC0v4TU,614
-mlrun/utils/version/version.json,sha256=cF_CTre-pPrRf1djzVFoC8JjKWsMgeR2ORIikl5t9Ds,88
+mlrun/utils/version/version.json,sha256=P6K3F73Bo2HTXBymA6cpOss8FZo1tFWSqR4qROtM5rw,88
 mlrun/utils/version/version.py,sha256=O4Q4kwtKlI73oK7oBPuz4SVkUI8BC11E9DJIKHT91kU,1970
-mlrun-1.4.0rc5.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.4.0rc5.dist-info/METADATA,sha256=zp637M2cvJ0q8RLuRRWDe0pSpWIIzxXiWU7fsxtwGDY,16892
-mlrun-1.4.0rc5.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-mlrun-1.4.0rc5.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
-mlrun-1.4.0rc5.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.4.0rc5.dist-info/RECORD,,
+mlrun-1.4.0rc6.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.4.0rc6.dist-info/METADATA,sha256=9wDPKABOgDz9N_TUac9Si0zzohX1fysmPPdShrtWECk,16892
+mlrun-1.4.0rc6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+mlrun-1.4.0rc6.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
+mlrun-1.4.0rc6.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.4.0rc6.dist-info/RECORD,,
```

